# StackOverflow 问答 13772000-13772999

# grails - 如何使用企业 Ivy 实例进行 Grails 依赖管理来解决内部工件

> ID：13772001
> 
> 赞同：2
> 
> 时间：2012-12-07T22:25:02.810
> 
> 标签：grails, ivy, dependency-management

全部，

我有一个直接开箱即用的 Grails 项目，没有任何自定义。我有一个简单的页面、简单的控制器、简单的服务；没问题。

问题：我想通过它的 API 与我们自己的软件平台进行交互。为此，我需要参考我们的内部 jar 工件。我们有自己的 Ivy 存储库，用于管理内部/外部依赖项。我无法将 BuildConfig.groovy 配置为指向内部存储库。这是我根据[这些说明尝试过的](http://grails.org/doc/latest/guide/conf.html)

```
/*
 * Configure our resolver.
 */
def libResolver = new org.apache.ivy.plugins.resolver.URLResolver()
['libraries', 'builds'].each {
    libResolver.addArtifactPattern(
            "http://my.repository/${it}/" +
            "[organisation]/[module]/[revision]/[type]s/[artifact].[ext]")

    libResolver.addIvyPattern(
            "http://my.repository/${it}/" +
            "[organisation]/[module]/[revision]/[type]s/[artifact].[ext]")
}

libResolver.name = "my-repository"
libResolver.settings = ivySettings

resolver libResolver 
```

这无法指向违规行

```
resolver libResolver 
```

研究我发现只有几篇关于这个的文章，删除了有问题的行，得到了更多的错误。删除了更多违规行，没有错误，但在“依赖项”部分中指定我的依赖项根本没有解决它们。

问题：

有没有人成功地使用他们的内部 ivy 存储库配置一个 grails 项目以进行依赖管理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T22:54:09.653

这里是。

```
 grails.project.dependency.resolution = {
     ...

        repositories {
            inherits true // Whether to inherit repository definitions from plugins
            resolver XXXLibResolver(dependencyManager)
            grailsPlugins()
            ...
        }

    ....

    def DependencyResolver XXXLibResolver(IvyDependencyManager dependencyManager) {
        DefaultRepositoryCacheManager nocache = new DefaultRepositoryCacheManager();
        nocache.setUseOrigin(true);
        nocache.name = "nocache";

        dependencyManager.ivySettings.addRepositoryCacheManager(nocache);

        def XXXHome = System.getenv("XXX_HOME")
        if (XXXHome) {
            XXXHome = new File(XXXHome).absolutePath
            def fileSystemResolver = new FileSystemResolver()
            fileSystemResolver.cache = nocache.name
            fileSystemResolver.local = true
            fileSystemResolver.name = 'XXX-lib-repo'
            fileSystemResolver.addIvyPattern("${XXXHome}/libraries/[organisation]/[module]/ivys/ivy-[revision].xml")
            fileSystemResolver.addArtifactPattern("${XXXHome}/libraries/[organisation]/[module]/[revision]/[artifact]-[revision](-[classifier]).[ext]")
            fileSystemResolver.settings = dependencyManager.ivySettings
            return fileSystemResolver
        }
} 
```

# javascript - 使用 jQuery 插件的代码可以在 Chrome 中运行，但不能在 Chrome 扩展程序中运行？

> ID：13772002
> 
> 赞同：2
> 
> 时间：2012-12-07T22:25:14.277
> 
> 标签：javascript, jquery, jquery-plugins, google-chrome-extension, content-script

我有一个基于 JS/jQuery 的小型 JavaScript 文件和一个附加库。它作为独立文件完美运行，但我在 Chrome 扩展程序中启动和运行时遇到问题。

该脚本检查 HTML 页面的每个图像的特定特征，并根据该特征在图像周围添加边框。

清单.json

```
{
    "name": "ImageId",
    "version": "0.1",
    "manifest_version": 2,
    "browser_action":  {
        "default_icon": "icon.png"
    },
    "content_scripts" : [
        {
            "matches" : [
                "http://*/*",
                "https://*/*"
            ],
            "js" : ["jquery-1.8.3.min.js","jquery.exif.js","content_script.js"],
            "run_at" : "document_start",
            "all_frames" : false
        }
    ],
    "icons":{
        "128":"icon.png"
    }
} 
```

content_script.js：

```
jQuery(window).load(function(){
    $('img').each(function() {

        var gpslo=0;
        var gpsla=0;
        if (typeof(gpslo) != "undefined" && gpslo != null) {
            var gpslo= $(this).exif("GPSLongitude");
            var gpsla = $(this).exif("GPSLatitude");
        }
        console.log(gpslo+"--"+ gpsla);

        if (gpslo!=0) {
            $(this).css('border', "solid 20px red");  
            $(this).click(function() {
                alert("Long: " + $(this).exif("GPSLongitude") + ", Lat: " + $(this).exif("GPSLatitude"));
            });
        }
        else {

            $(this).css('border', "solid 20px gray"); 
        };

    });
}); 
```

现在，当我在一个非常简单的只有一张图片的网站上在 Chrome 中运行它时，我根本没有收到任何错误，而只是一个白页。

在扩展系统之外运行脚本也一切正常。我不太确定如何更好地解释这一点。这些是我在教程之外的第一步，所以请善待:)

我将完整的测试和扩展文件上传到：[Working(Html).zip](http://www.pjh.org/se/Working%28Html%29.zip)和[NotWorking(Chrome).zip](http://www.pjh.org/se/NotWorking%28Chrome%29.zip)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T06:30:02.247

[正如 Sudarshan 回答](https://stackoverflow.com/a/13774515/331508)的那样，在 中注释掉该`document.write`代码`jquery.exif.js`。 `document.write`在内容脚本中删除以前的 DOM，并且 VBscript 在 Chrome 中无论如何都不起作用。

然而，这不是唯一的问题：

1.  当内容脚本设置为 时`"run_at" : "document_start"`，如问题所示，您必须使用`$(document).ready()`. `$(document).ready()`当有疑问时，无论如何使用它永远不会受到伤害。

2.  当内容脚本设置为 时`"run_at" : "document_idle"`，如在您链接的文件中， [脚本可能会在`document.load`事件](http://developer.chrome.com/extensions/content_scripts.html#run_at)发生后触发。所以，`$(window).load()`不会总是奏效。

3.  在 Chrome 中，至少在您提供的测试页面上，Exif 数据最多需要 6 秒才能进入！（在 Firefox 上几乎是即时的。）这意味着，您需要在延迟一段时间后检查图像。

其他不太重要的问题：

1.  使用 CSS 类来帮助进行上述定时检查并避免内联 CSS。
2.  使用[jQuery 的`.on()`](http://www.jqapi.com/#p=on), 而不是`.click()`, 以便处理程序只附加一次并优雅地补偿 AJAX 更改。

把它们放在一起，`content_script.js`变成（**更新，见下面这个脚本**）：

```
$(document).ready ( function () {
    $(window).load (CompForExifPluginInitDelay);

    //--- In a content script, the load event may have already fired.
    if (document.readyState == "complete") {
        CompForExifPluginInitDelay ();
    }

    $(document.head).append ( '                             \
        <style type="text/css">                             \
            img.myExt_HasExif {                             \
                border:     20px solid red !important;      \
            }                                               \
            img.myExt_WithoutExif {                         \
                border:     20px solid gray !important;     \
            }                                               \
        </style>                                            \
    ' );

    //-- Use jQuery .on(), not .click().
    $(document.body).on ("click", "img.myExt_HasExif", popupLatLong);
} );

function CompForExifPluginInitDelay () {
    //-- Exif Init takes somewhere between 1.6 and 6 seconds on Chrome!!!
    var numChecks       = 0;
    var checkInterval   = 444;  //-- 0.4 secs is plenty fast enough
    var maxChecks       = 6 * 1000 / checkInterval + 1;

    var imageCheckTimer = setInterval ( function() {
            numChecks++;

            findImagesWithLatLong (numChecks);

            if (numChecks >= maxChecks) {
                clearInterval (imageCheckTimer);

                //-- All remaining images don't have lat-long data.
                $("img").not(".myExt_HasExif").addClass("myExt_WithoutExif");

                console.log ("***** Passes complete! *****");
            }
        },
        checkInterval
    );
}

function findImagesWithLatLong (passNum) {
    console.log ("***** Pass: ", passNum);
    $("img").not (".myExt_HasExif").each ( function (J) {
        var jThis   = $(this);
        var gpslo   = jThis.exif ("GPSLongitude");
        var gpsla   = jThis.exif ("GPSLatitude");

        console.log (J + ": ", gpslo + "--" + gpsla);
        if (gpslo != 0) {
            jThis.addClass ("myExt_HasExif");
        }
    } );
}

function popupLatLong (zEvent) {
    var jThis   = $(this);
    alert (
        "Longitude: " + jThis.exif ("GPSLongitude")
        + ", Latitude: " + jThis.exif ("GPSLatitude")
    );
} 
```

到目前为止，它在我所有的测试中都有效，（与杀死`document.write()`.

* * *

* * *

* * *

# 更新：使用`.exifLoad()`：

[正如 PAEz在他的回答中](https://stackoverflow.com/a/13776668/331508)指出的那样，Chrome 计时问题似乎可以通过强制手动扫描图像来解决`.exifLoad()`。

这在我测试时有效，并且是使用计时器的更好方法。

因此，PAEz 的答案有效（与 Sudarshan 的答案一起），但我的代码版本（解决其他问题）将是：

```
$(document).ready ( function () {
    $(window).load (findImagesWithLatLong);

    //--- In a content script, the load event may have already fired.
    if (document.readyState == "complete") {
        findImagesWithLatLong ();
    }

    $(document.head).append ( '                             \
        <style type="text/css">                             \
            img.myExt_HasExif {                             \
                border:     20px solid red !important;      \
            }                                               \
            img.myExt_WithoutExif {                         \
                border:     20px solid gray !important;     \
            }                                               \
        </style>                                            \
    ' );

    //-- Use jQuery .on(), not .click().
    $(document.body).on ("click", "img.myExt_HasExif", popupLatLong);
} );

function findImagesWithLatLong (passNum) {
    $("img").not (".myExt_HasExif").each ( function (J) {
        $(this).exifLoad ( function () {
            var jThis   = $(this);
            var gpslo   = jThis.exif ("GPSLongitude");
            var gpsla   = jThis.exif ("GPSLatitude");

            console.log (J + ": ", gpslo + "--" + gpsla);
            if (gpslo != 0)
                jThis.addClass ("myExt_HasExif");
            else
                jThis.addClass ("myExt_WithoutExif");
        }.bind (this) );
    } );
}

function popupLatLong (zEvent) {
    var jThis   = $(this);
    alert (
        "Longitude: " + jThis.exif ("GPSLongitude")
        + ", Latitude: " + jThis.exif ("GPSLatitude")
    );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T04:34:39.733

它在消除 jquery.exif.js 中的以下代码后工作

```
/*document.write(
    "<script type='text/vbscript'>\r\n"
    + "Function IEBinary_getByteAt(strBinary, iOffset)\r\n"
    + " IEBinary_getByteAt = AscB(MidB(strBinary,iOffset+1,1))\r\n"
    + "End Function\r\n"
    + "Function IEBinary_getLength(strBinary)\r\n"
    + " IEBinary_getLength = LenB(strBinary)\r\n"
    + "End Function\r\n"
    + "</script>\r\n"
);*/ 
```

只需在 jquery.exif.js 中消除上面的代码就可以了

**输出**

![在此处输入图像描述](../Images/e4ce5c1061a0a1577b4acccf8f5265b0.png)

如果您需要更多信息，请与我们联系

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T10:37:32.123

这更像是评论而不是答案，但它涉及代码，所以我不得不将其作为答案......

当我尝试您的工作示例时，它几乎没有对我有用，因为您试图获取由于 xhr 调用尚未获得文件而尚未出现的值。
您可以通过将代码更改为以下来解决此问题。这可能会被纳入 Brock Adams 的答案中，以避免使用`CompForExifPluginInitDelay`可能会被击中和错过的答案。

```
jQuery(window).load(function() {
    $('img').each(function() {
        $(this).exifLoad(function() {
            var gpslo = 0;
            var gpsla = 0;
            if(typeof(gpslo) != "undefined" && gpslo !== null) {
                var gpslo = $(this).exif("GPSLongitude");
                var gpsla = $(this).exif("GPSLatitude");
            }
            console.log(gpslo + "--" + gpsla);
            if(gpslo != 0) {
                $(this).css('border', "solid 20px red");
                $(this).click(function() {
                    alert("Longitude: " + $(this).exif("GPSLongitude") + ", Latitude: " + $(this).exif("GPSLatitude"));
                });
            } else {

                $(this).css('border', "solid 20px gray");
            };

        }.bind($(this)));
    });
}); 
```

与往常一样，我并不真正了解 JQuery，所以如果这可以以更 JQ 的方式完成，那么请说。

# c# - 如何从 DataGridvView 获取数据并将其发送到 c# 上的父窗体？

> ID：13772004
> 
> 赞同：0
> 
> 时间：2012-12-07T22:25:20.407
> 
> 标签：c#, database, datagridview

我的程序中有搜索功能。当用户在主窗体中插入 ID 并单击搜索按钮时，数据将从数据库中获取并显示在新窗体的 Datagridview 上。我想从 Datagridview 中获取选定的行并将值返回给父表单（并在文本框、组合框等上设置值）而不创建新的父表单 感谢您的帮助

# grid - 算法 [最好是 fortran] 从 2D 非结构化网格中插入数据以形成笛卡尔网格

> ID：13772008
> 
> 赞同：5
> 
> 时间：2012-12-07T22:25:54.660
> 
> 标签：grid, fortran, interpolation, cartesian

我正在使用 2D 动态非结构化网格对裂缝扩展进行建模。随着裂缝随着时间的推移而扩展，元件也会相应地移动。对于给定的时间步，我想对我的非结构化网格 zi=f(xi,yi) 的数据进行插值（其中 (xi,yi) 是非结构化三角形的节点）以获得函数 z 在笛卡尔网格（x 和 y 规则间隔）。我的网格大小约为 100x100 个节点。有很多方法可以执行此插值方案，但我对该主题的了解不足，无法确定哪种方案足够健壮和简单。我正在使用 Fortran 90（不要问为什么......）。有没有可用的开源算法？我不想重新发明轮子。

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:38:31.367

您可能对地球系统建模框架 (ESMF) 感兴趣：

[http://www.earthsystemmodeling.org/](http://www.earthsystemmodeling.org/)

它带有 Fortran、C 和最近的 Python（功能有限）API 和出色的文档。它通常用于地球物理模型中的数据抽象对象及其耦合，但它也提供结构化和非结构化网格之间重新网格化的例程，可用于离线（独立命令行实用程序）或在线（通过子例程调用）插值权重一代。

上次我研究它时，ESMF 提供了双线性、双三次和数量守恒的重新网格化方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T17:23:08.787

尽管有些参考文献很棒（例如 ESMF），但我找不到一个容易获得的简单算法。所以有时更容易“重新发明”轮子！如果你们中的一些人感兴趣，这里是我推导出的简单方法：

1.  生成背景笛卡尔网格：节点 P 位于 l=j+Nbx(i-1)，i=1:Nbx 和 j=1:Nby。
2.  为每个背景方块设置节点编号。有 Nbx*Nby 个节点和 (Nbx-1) *(Nby-1) 个方格。对于 i=1:Nbx-1 和 j=1:Nby-1 ，正方形标记为 s=j+(i-1)* (Nby-1)。正方形 S 由 4 个节点组成：j+Nby(i-1)、j+1+Nby(i-1)、j+1+Nby*i 和 j+Nby*i
3.  对于非结构化网格的每个三角形，找到最小和最大 x 和 y 来描述包含三角形的框。然后，确定对应的imin,imax,jmin,jmax。
4.  对于给定的框，遍历该框中包含的笛卡尔节点 (i=imin:imax, j=jmin:jmax) 并执行“Point_Inclusion_in_Triangle”测试（使用重心方法）以查看该节点是否在感兴趣的三角形内. 这样做时，请进行额外测试以查看节点是否位于其中一个顶点上。
5.  如果测试是肯定的，则背景笛卡尔网格的相应节点从潜在节点列表中删除（一个节点不能是多个三角形的一部分）。这使得我们通过三角形列表的过程更快。
6.  然后，您可以使用三角形中的双线性插值法（使用重心法）在背景网格的每个节点处进行插值。

这种方法工作得很好并且非常快（出于工程目的）。

# matlab - 在具有约束的matlab中求解非凹二次函数

> ID：13772017
> 
> 赞同：2
> 
> 时间：2012-12-07T22:26:29.727
> 
> 标签：matlab, optimization, quadratic

如何在具有约束的matlab中求解非凹二次函数。我尝试使用 quadprog 但它不起作用

我必须优化一个函数 f=x'Ax，其约束条件是 xs 的总和等于 1 和 0<=x<=1。我的函数不是凹的。所以我只需要最大化。即使全局会更好，如果我找到局部最大值也没关系。

我尝试使用 matlab 的 quadprog 函数。但是，它的结果并不是那么好。我不知道它会终止，但结果并非如此。我想要一些只会迭代次数的东西，我告诉它并给我结果

我正在尝试实现这样的东西

[http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=68DD5FE71FCEB5629F1FA0F1E02CCFE8?doi=10.1.1.157.6789&rep=rep1&type=pdf](http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=68DD5FE71FCEB5629F1FA0F1E02CCFE8?doi=10.1.1.157.6789&rep=rep1&type=pdf)

好吧，我的问题场景是我有一组点和标签。所以工作是将点与标签匹配。我用所有可能的（节点，标签）对定义了一个图。并定义一个大小的亲和矩阵（number_node_label 对，number_node_label 对）

我想最大化函数 x'Ax 与 xs 之和 = 1 的约束。所有 xs >=0 即点位于单纯形中。

对于我的亲和力矩阵

A(u,v) 其中 u 和 v 是点之一，标签对即 u=point1,label1 v=point2, label2 假设

A(u,v) = exp(-abs(||point1-point2||-||label1-label2||)) / sigma A(u,v) = 0 如果 u==v

我想要类似复制器方程的东西

# mysql - SQL - 检查列是否自动递增

> ID：13772019
> 
> 赞同：25
> 
> 时间：2012-12-07T22:26:34.807
> 
> 标签：mysql, sql, sql-server, auto-increment

我正在尝试运行查询以检查列是否自动递增。我可以检查类型、默认值、它是否可以为空等，但我不知道如何测试它是否自动递增。以下是我测试其他内容的方式：

```
SELECT *
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'my_table'
AND COLUMN_NAME = 'my_column'
AND DATA_TYPE = 'int'
AND COLUMN_DEFAULT IS NULL
AND IS_NULLABLE = 'NO'
--AND AUTO_INCREMENTS = 'YES' 
```

不幸的是，没有`AUTO_INCREMENTS`可比较的列。那么如何测试列是否自动递增？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-12-07T22:31:01.217

对于 MySql，请检查`EXTRA`列：

```
SELECT *
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'my_table'
    AND COLUMN_NAME = 'my_column'
    AND DATA_TYPE = 'int'
    AND COLUMN_DEFAULT IS NULL
    AND IS_NULLABLE = 'NO'
    AND EXTRA like '%auto_increment%' 
```

对于 Sql Server，使用`sys.columns`和`is_identity`列：

```
SELECT 
    is_identity
FROM sys.columns
WHERE 
    object_id = object_id('my_table')
    AND name = 'my_column' 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-07T22:30:04.543

假设 MySQL，该`EXTRA`列将指示它是否为`AUTO_INCREMENT`.

```
| 表目录 | 表模式 | ... | 额外 | ... |
-------------------------------------------------- ------------
| 定义 | db_2_00314 | ... | 自动增量 | ... |
```

对于 MSSQL，[请参见此处](https://stackoverflow.com/questions/87747/how-do-you-determine-what-sql-tables-have-an-identity-column-programatically/679449)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-08-31T00:49:54.977

这适用于 sql server：

```
 Select COLUMN_NAME, TABLE_NAME
    from INFORMATION_SCHEMA.COLUMNS
    where TABLE_SCHEMA = 'dbo'
    and COLUMNPROPERTY(object_id(TABLE_NAME), COLUMN_NAME, 'IsIdentity') = 1
    order by TABLE_NAME 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-11-22T21:40:39.713

运行：描述'table_name'；在 EXTRA 列中，您正在寻找

# r - 构造一个向量，其中包含两个其他向量的值之间的间隔

> ID：13772024
> 
> 赞同：1
> 
> 时间：2012-12-07T22:27:04.570
> 
> 标签：r, vector, range, intervals, higher-order-functions

我有两个整数向量，如下所示：

```
c(1,5,14,24)
c(3,9,22,30) 
```

我需要从这些构造包含每个值之间的范围的向量，连接在一起，如下所示：

```
c(1:3,5:9,14:22,24:30) 
```

做这个的最好方式是什么？我在网站上找不到解决此问题的另一个问题。我尝试了一些使用高阶函数（地图、折叠等）的东西，但它们似乎都只采用一个列表参数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T22:29:40.283

你可以在这里使用 mapply 来获取你的范围。

```
mySeq <- mapply(seq, A, B)

dput(mySeq)
# list(1:3, 5:9, 14:22, 24:30) 
```

正如@señor 指出的那样，如果您希望将范围作为单个向量，`unlist`也可以使用：

```
unlist(mapply(seq, A, B))
# [1]  1  2  3  5  6  7  8  9 14 15 16 17 18 19 20 21 22 24 25 26 27 28 29 30 
```

# python - 使用 python 检测音频文件的完整性

> ID：13772025
> 
> 赞同：2
> 
> 时间：2012-12-07T22:27:12.220
> 
> 标签：python, audio

如果我从网上下载了一个音频文件并且下载过程中发生了一些不好的事情，那么如何使用 python 有效地检测到音频文件不完整？

有一些想法，比如[在linux中](https://stackoverflow.com/questions/6541639/what-is-a-good-audio-library-for-validating-files-in-python)[使用`file`](https://stackoverflow.com/questions/6541639/what-is-a-good-audio-library-for-validating-files-in-python)命令：

`file audio.mp4`

但它承认它是 mp4：

`audio.mp4: ISO Media, MPEG v4 system, version 2`

甚至 mplayer 也检测到 mp4 音频类型，但在尝试播放时失败。我不认为从 python 启动 mplayer 并检查它是否失败是一个可扩展的解决方案。

这是损坏文件的示例： [https ://www.dropbox.com/s/5rpscb9r1xrrx4t/They](https://www.dropbox.com/s/5rpscb9r1xrrx4t/They)

上面的示例使用诱变剂和 mp4file 失败，导致它们无限期挂起。它与 fileObject.tell() 有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:36:35.967

有许多不同的音频文件格式，以及可能是也可能不是音频文件的内容的容器格式。

幸运的是，有些库可以存储各种不同类型的文件。并且有 Python 包装器用于：

*   便携式命令行工具，如 ffmpeg 和 mplayer。
*   libavcodec 之类的可移植库（ffmpeg 使用什么）。
*   特定于平台的库，例如 Core Audio 或 QuickTime 或 Windows Media。

如果您愿意为单独的文件类型使用单独的包装器，那么还有更多选择（例如，libmp4v2 非常适合 MP4 文件，但对于其他任何文件都无用）。

当然，存在巨大的权衡——更强大的库通常会更复杂，或者有更多的先决条件。[在http://pypi.python.org/](http://pypi.python.org/)上进行一些搜索以查看结果；你应该能够找到做你想做的一切的东西。

举一个非常简单的例子，[mp4file](http://pypi.python.org/pypi/mp4file/0.2)将尝试解析任何 MPEG4 容器。如果它不完整，或者有任何无效的原子，你会得到一个异常。所以，检查只是一行，`mp4file.Mp4File(path)`. 如果成功，则完成；如果它抛出异常，它是不完整或无效的。但当然，这将接受完整的 MPEG4 视频文件，或其中没有音频或视频的 MPEG4，它会拒绝完整的 MP3，甚至是带有损坏的元数据标签的完整 M4A。

# performance - 使用实体框架获取整个数据库是否正常？

> ID：13772027
> 
> 赞同：0
> 
> 时间：2012-12-07T22:27:33.733
> 
> 标签：performance, entity-framework

在我们正在开发的应用程序中，我们有以下代码

```
 EntityContext entity = TransactionManager.GetEntityContext();
        int idType = entity.InfoSectnGess.Where(e => e.NoSeqInfoSecGes == noSeqInfoSecGes).Single().NoSeqTypeInfo;
        return entity.ListValues.Where(e => e.NoSeqTypeInfo == idType && e.NoSeqChoixValeur == noSeq).Single().DescChoixValeur; 
```

*EntityContext*基于**System.Data.Objects.ObjectContext**

当我运行调试器时，在第一行放置一个断点并查看包含的**实体**，我看到它包含数据库中的所有“*表*”（实体字段？），但它们都是空的（null）。

如果我进行下一步，那么我的“*表*”将充满……嗯……整个数据库。

当然，我关心的是性能。

该解决方案是否可行，还是会随着时间的推移变得太慢？

我问了*这个想法背后的人*，他告诉我不会有这样的麻烦。然而，当我看到*entity.InfoSectnGess*包含 380 个元素（开发人员的临时数据）并且它很快就会包含数千条（如果不是数百万条）记录时，这让我想知道......魔法在哪里，有什么魔力？

# node.js - 使用 Node.js 在 GridFS 中存储 Stream

> ID：13772028
> 
> 赞同：0
> 
> 时间：2012-12-07T22:27:38.863
> 
> 标签：node.js, stream, gridfs

我想将 Stream 存储在 GridFS 中。但是它没有按预期工作（即没有控制台日志）。

```
var mongo = require("mongodb");

var db = ...

db.open(function (err, db) {
    var stream = ...
    var name = 'foobar';

    var gs = new mongo.GridStore(db, new mongo.ObjectID, name, "w");
    gs.open(function (err, gs) {
        stream.on("data", function (data) {
            gs.write(data, function (err, gs) {
                if (err) {
                    // ...
                }
            });
        });
        stream.on("end", function () {
            gs.close(function (err, gs) {
                if (!err) {
                    console.log(name + " has been stored to database.");
                }
            });
        });
    });
}); 
```

有谁知道为什么它不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T19:35:18.350

我认为您忘记将流通过管道传输到 gridfs 文件中。您可以直接执行此操作，因为 gridfs 文件的行为类似于流（请参阅 db.open 回调中的最后一行）。此外，您忘记了 ObjectID 的构造函数调用的括号，并且在打开数据库或文件时不检查任何错误。我的代码在结构上看起来是相同的，并且确实有效。希望有帮助...

```
db.open(function (err, db) {
    var stream = ...
    var name = 'foobar';

    var gs = new mongo.GridStore(db, new mongo.ObjectID(), name, "w");
    gs.open(function (err, gs) {
            if(err) console.log(...)
            else{
        stream.on("data", function (data) {
            gs.write(data, function (err, gs) {
                if (err) {
                    // ...
                }
            });
        });
        stream.on("end", function () {
            gs.close(function (err, gs) {
                if (!err) {
                    console.log(name + " has been stored to database.");
                }
            });
        });
           stream.pipe(gs);
          }
    });
}); 
```

# asp.net-mvc - 我的一些 asp mvc 4 包停止工作

> ID：13772029
> 
> 赞同：2
> 
> 时间：2012-12-07T22:27:41.360
> 
> 标签：asp.net-mvc

所以突然我的asp mvc 4包停止工作:(

我被取消作为捆绑 URL 的 http 状态。

任何想法我下一步做什么？我在 _layout 中使用与工作时相同的虚拟路径

```
 @Styles.Render("~/foundation/stylesheets")
@Scripts.Render("~/foundation/javascripts")

public class BundleConfig
    {
        public static void RegisterBundles(BundleCollection bundles)
        {
           //JQUERY STUFF
            bundles.Add(new ScriptBundle("~/bundles/jquery").Include(
            "~/Scripts/jquery-1.*"));

        bundles.Add(new ScriptBundle("~/bundles/jqueryplugins").Include(
            "~/Scripts/plugins/jquery.placeholder.js"));

        bundles.Add(new ScriptBundle("~/bundles/jqueryui").Include(
            "~/Scripts/jquery-ui*"));

        bundles.Add(new ScriptBundle("~/bundles/jqueryval").Include(
            "~/Scripts/jquery.unobtrusive*",
            "~/Scripts/jquery.validate*"));

        bundles.Add(new StyleBundle("~/Content/themes/base/css").Include(
            "~/Content/themes/base/jquery.ui.core.css",
            "~/Content/themes/base/jquery.ui.resizable.css",
            "~/Content/themes/base/jquery.ui.selectable.css",
            "~/Content/themes/base/jquery.ui.accordion.css",
            "~/Content/themes/base/jquery.ui.autocomplete.css",
            "~/Content/themes/base/jquery.ui.button.css",
            "~/Content/themes/base/jquery.ui.dialog.css",
            "~/Content/themes/base/jquery.ui.slider.css",
            "~/Content/themes/base/jquery.ui.tabs.css",
            "~/Content/themes/base/jquery.ui.datepicker.css",
            "~/Content/themes/base/jquery.ui.progressbar.css",
            "~/Content/themes/base/jquery.ui.theme.css"));

        //FOUNDATION STUFF
        bundles.Add(new ScriptBundle("~/foundation/javascripts").Include(
           "~/foundation/javascripts/app.js",
           "~/foundation/javascripts/foundation.min.js",
           "~/foundation/javascripts/modernizr.foundation.js"));

        bundles.Add(new StyleBundle("~/foundation/stylesheets").Include(
            "~/foundation/stylesheets/app.css",
            "~/foundation/stylesheets/foundation*"));

    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-07-18T14:02:17.977

如果您的包路径与实际路径相同，则可能会发生这种情况。例如，您有您的 css`/Content/Css`并使用相同的路径构建您的包，因此：

```
bundles.Add(new StyleBundle("~/Content/Css").Include(
            "~/Content/Css/normalize.css",
            "~/Content/Css/main.css"
        )); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T22:32:54.423

如果所有的都被取消，听起来你的路由表被搞砸了。[使用http://nuget.org/packages/routedebugger](http://nuget.org/packages/routedebugger)检查它们

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T23:20:40.407

不要尝试缩小“.min”文件。从包中删除 .min 文件并使用开发文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-28T02:48:17.873

我遇到了同样的问题，经过几天的尝试，我注意到我的 jquery 版本现在是 2.x 并且我的包正在引用 jquery-1.*。上次使用 NuGet 更新我的网站时，我确实遇到了问题。我认为崩溃导致我的包得到更新，但它没有更新我在代码中的引用。希望这可以使某人免于试图弄清楚为什么会发生在他们身上。

这是我创建应用程序时为我生成的内容：

```
bundles.Add(new ScriptBundle("~/bundles/jquery").Include("~/Scripts/jquery-1.*")); 
```

# java - 图像未在 Applet 中加载

> ID：13772032
> 
> 赞同：-1
> 
> 时间：2012-12-07T22:27:58.133
> 
> 标签：java, image

> **可能重复：**
> [将 Java 游戏转换为 Applet；不会加载图片](https://stackoverflow.com/questions/13771352/converted-java-game-to-applet-wont-load-pictures)

我的所有地面纹理都有一个图像，就像一个精灵表，但只是垂直的，它每次都给我第一个块（草）。下面是加载和裁剪图像的代码：

```
for (int i = 0; i < Screen.tileset_ground.length; i++) {

    URL imgUrl = getClass().getResource("tileset_ground.png");
    Screen.tileset_ground[i] = getImage(imgUrl);

    ImageFilter imgF = new CropImageFilter(0, 26 * i, 26, 26);
    ImageProducer imgP = new FilteredImageSource(Screen.tileset_ground[i].getSource(), imgF);
    Screen.tileset_ground[i] = createImage(imgP);  

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:04:03.183

首先，您需要将 for 循环中的前两行移到它之外。您只需要执行该步骤一次。

其次，您需要弄清楚您的图块集中有多少图块，并且只迭代那么多次。

所以也许是这样的？

```
URL imgUrl = getClass().getResource("tileset_ground.png");
tileset_image = getImage(imgUrl);

num_images = HOWEVER MANY IMAGES ARE IN THE TILESET

for (int i = 0; i < num_images; i++) {

    ImageFilter imgF = new CropImageFilter(0, 26 * i, 26, 26);
    ImageProducer imgP = new FilteredImageSource(tileset_image.getSource(), imgF);
    Screen.tileset_ground[i] = createImage(imgP);  

} 
```

# ios - XCode 5.1 模拟器 - 无法实例化名为 UIStoryboardUnwindSegueTemplate 的类

> ID：13772033
> 
> 赞同：1
> 
> 时间：2012-12-07T22:28:11.977
> 
> 标签：ios, xcode

> **可能重复：**
> [Storyboard 无法实例化名为 UIStoryboardUnwindSegueTemplate 的类崩溃](https://stackoverflow.com/questions/13628383/storyboard-could-not-instantiate-class-named-uistoryboardunwindseguetemplate-cra)

与这个问题一样，[故事板无法实例化名为 UIStoryboardUnwindSegueTemplate 的类崩溃](https://stackoverflow.com/questions/13628383/storyboard-could-not-instantiate-class-named-uistoryboardunwindseguetemplate-cra)我刚刚完成了 iOS 开发人员库故事板教程并在 iPhone 5.1 模拟器上运行它。

在我点击添加按钮之前它工作正常，它只是因错误而崩溃：

> 由于未捕获的异常“NSInvalidUnarchiveOperationException”而终止应用程序，原因：“无法实例化名为 UIStoryboardUnwindSegueTemplate 的类”

当我切换到 iPhone 6.0 模拟器时，它按预期完美运行。

我引用的问题的答案是我从教程中复制的相同代码，所以我不知道**如何“降级”代码以使用 5.1，或者是否有可能。**

这是我第一次使用 Storyboard，据我所知，连接模态添加视图的唯一代码是 Storyboard “从添加到导航控制器的模态序列”。

（这也是我关于stackoverflow的第一个问题，所以如果我的问题不够清楚，我很抱歉）

完整的教程代码在这里：http: [//developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/CodeListings/CodeListings.html#//apple_ref/doc/uid/TP40011318-CH9-SW1](http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/CodeListings/CodeListings.html#//apple_ref/doc/uid/TP40011318-CH9-SW1)

我很感激任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T01:01:00.523

UIStoryboardUnwindSegue 类是从 iOS 6.0 开始引入的，你不能在 iOS 5 中使用它......你必须使用例如：delegate，用于执行展开操作。

# java - XSLT 使用 Java API 生成 HTML

> ID：13772036
> 
> 赞同：1
> 
> 时间：2012-12-07T22:28:47.320
> 
> 标签：java, xml, xslt

我有一个特定的要求，我必须开发 XSLT 脚本，这些脚本生成 HTML 文件，用于使用`javax.sql.rowset.WebRowSet.writeXml(ResultSet rs, OutputStream oStream)`.

有谁知道如何实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T10:25:43.597

给 writeXml 一个要写入的 ByteArrayOutputStream，然后将它封装在 StreamSource 中作为转换的输入。

如果您想避免为 XML 分配内存并直接对其进行流式传输，则可以使用两个线程来实现，但这会更复杂。

# mockito - 可以在运行时包装 mockito 模拟本身吗？

> ID：13772047
> 
> 赞同：1
> 
> 时间：2012-12-07T22:29:22.317
> 
> 标签：mockito, mule, cglib

如果我在运行时包装由 Mockito 创建的模拟，然后在包装器上调用一个方法，则不会调用包装的模拟。请看下面：

这是我运行的测试：

```
import static org.mockito.Mockito.verify;
import net.sf.cglib.proxy.Enhancer;
import net.sf.cglib.proxy.NoOp;
import org.junit.Test;
import org.mockito.Mockito;

public class MyTest {

    @Test
    public void mockIsCalled() {
        final Bar bar = Mockito.mock(Bar.class);
        final Bar wrapper = wrap(bar);
        wrapper.foo();
        verify(bar).foo();
    }

    @SuppressWarnings("unchecked")
    private <T> T wrap(final T objToWrap) {
        return (T) Enhancer.create(objToWrap.getClass(), NoOp.INSTANCE);
    }

} 
```

其中 Bar 是：

```
public interface Bar {
    String foo();
} 
```

测试失败，我得到的输出是：

```
java.lang.NoSuchMethodError: java.lang.Object.foo()Ljava/lang/String;
    at Bar$$EnhancerByMockitoWithCGLIB$$d2b59df8.foo(<generated>)
    at MyTest.mockIsCalled(MyTest.java:18)
... 
```

如果我将 Bar 变成一个类，如下所示：

```
public class Bar {

    public String foo() {
        System.out.println("foo");
        return null;
    }

} 
```

测试继续失败，`foo`打印在控制台上，我得到输出：

```
Wanted but not invoked:
bar.foo();
-> at MyTest.mockIsCalled(MyTest.java:20)
Actually, there were zero interactions with this mock.

    at MyTest.mockIsCalled(MyTest.java:20)
... 
```

我很困惑。

我要解决的真正问题是包装动态代理（由 Mule 通过组件绑定注入），以便记住对包装的动态代理的方法调用。我想让它足够通用，这样就足以包装动态代理对象而无需扩展任何接口。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T20:43:30.410

您在 Bar 类的情况下看到的问题，如果不是因为 cglib 古怪，您也会在接口版本中看到。您不是在包装模拟，而是在创建一个新对象。因此，原始模拟从未被执行过。

对于使用类版本，您是否尝试过`create()`接受[接口作为参数](http://cglib.sourceforge.net/apidocs/net/sf/cglib/proxy/Enhancer.html#create%28java.lang.Class,%20java.lang.Class%5B%5D,%20net.sf.cglib.proxy.Callback%29)的版本？

我不确定我是否完全了解您的使用场景，但是对于特定于 Mockito 的东西，您可以尝试使用 cglib 创建的代理，然后[`spy()`](http://mockito.googlecode.com/svn/branches/1.7/javadoc/org/mockito/Mockito.html#spy%28T%29)在其上使用，而不是模拟一个新对象。

坦率地说，我对 cglib 了解不多，但也许你可以实现你自己的`Callback`，它包含并委托给原始对象。你可以提供那个`Callback`来`Enhancer.create()`代替那个`NoOp`。

# java - Java Chat 应用程序带宽使用情况？

> ID：13772049
> 
> 赞同：0
> 
> 时间：2012-12-07T22:29:29.817
> 
> 标签：java, chat, bandwidth

我试图四处寻找有关聊天应用程序占用多少带宽的数据。

在这种情况下，可能使用 Java/AJAX 实现，或者只是 Java，使用服务器/客户端关系。

我想知道，这样的系统在用 Java 编写时会使用多少带宽。基准可能是来自世界各地的 15-20 个用户，并且一次最多连接 8 或 10 个用户。我知道这可能看起来很模糊，但我似乎根本无法找到有关这种特定情况的数据。

谁能指出我有关此的一些资源？或者如果可能的话加入？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T01:51:29.117

除非聊天应用程序正在发送照片或文件，否则它将使用少量数据。一次最多用户数为 10 人，您可以将消息包装在 xml 的带宽消耗中，我仍然会坚持我的答案：它将使用**微不足道的带宽**。

假设您的所有十个用户都是快速打字员并且非常健谈。他们以每分钟 100 个字的速度不停地打字。将其分解为每分钟 10 句话，并将其中的每一个都包装在一条消息中发送给服务器。添加一些 XML 数据来描述消息来自谁以及它是私有给另一个用户还是发送给一组用户，也许每条消息可以获得 1K。因此，每个用户每 6 秒向服务器发送 1K。对于 10 个用户，我们每 6 秒向服务器发送 10K。

所以根据我的估计，我们可以将你的服务器连接到 1995 年的 56K 调制解调器，你会没事的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T01:35:32.353

您找不到有关此数据的原因是因为这里没有特别与 Java 或 AJAX 相关的内容。带宽使用取决于您通过网络发送/接收的数据，因此取决于您设计用于传递数据的协议；它与您是仅使用 Java，还是结合 Java 使用 AJAX，或者 CGI 脚本、PL/I 或 Assembler 无关。

您可以在 Assembler 中编写聊天应用程序，这将比在 Java 中编写的聊天应用程序占用更严重的带宽。

为了了解您的带宽影响，您需要分析您的数据模型、数据流和您的整体通信协议：即发送什么数据、采用什么结构以及发送频率。

# android - 如何选择哪个 minSdkVersion？

> ID：13772052
> 
> 赞同：3
> 
> 时间：2012-12-07T22:29:44.620
> 
> 标签：android

我开发了一个应用程序并将其放在 Google Play 上，但问题是有时，有些人无法安装它，我不知道原因。
但是，我不确定原因是否是因为我的 minSdkVersion 设置为“8”。我正在使用 Android 2.2 API。

可以设置 minSdkVersion = "1" 吗？以及将其设置为“1”而不是“8”的缺点是什么。我应该如何选择它？这让我感到困惑，因为同时我希望每个人都安装我的应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T22:33:47.470

使用 API 1 作为最低 SDK 几乎没有什么好处。查看 Android 的活动设备[仪表板](http://developer.android.com/about/dashboards/index.html)。它表明仍有 3.1% 的用户使用 API 7 或以下，0.4% 的用户使用 API 6 以下。

如果可能的话，您还会发现在 API 1 中重新创建许多现代功能非常困难……甚至[支持库](http://developer.android.com/tools/extras/support-library.html)也仅适用于 API 4+。

**简而言之**，您的最低 SDK 版本不太可能是罪魁祸首。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T22:39:44.000

只需将 minSdkVersion 设置为您测试过的最低值。如果您使用特定于 API 级别 8（或更高级别）的功能，并且没有专门检查它们的存在，那么您在较低版本上的用户将无法运行。

运行 lint 还可以从较低版本中排除错误。

这个数字只会过滤掉市场上的用户。他们会收到一条消息，说该应用程序与他们的版本不兼容。在我看来，您遇到的问题是用户*无法*安装。我不相信改变 minSdkVersion 会帮助你。这很可能与他们使用的 Android Market 版本中的错误有关。

# c - 超出数组大小的数组元素值的C数组设置

> ID：13772057
> 
> 赞同：3
> 
> 时间：2012-12-07T22:30:11.390
> 
> 标签：c, arrays

我有这个 C 代码片段

```
int numbers[4]={1};

numbers[0]=1; numbers[1]=2; numbers[3]=3; numbers[10]=4;
printf("numbers: %d %d %d %d %d %d\n",numbers[0],numbers[1],numbers[3],numbers[6],numbers[10],  numbers[5]) ; 
```

此片段的输出产生：

```
 numbers: 1 2 3 963180397 4 0 
```

好吧，我有几个问题

1.  不会设置 numbers[10] 给出错误，因为数组的大小仅为 4，如果不是那么为什么（因为它没有给出任何错误）

2.  为什么打印 numbers[6] 给出垃圾值，而 numbers[5] 给出 0 值？它不应该也是一个垃圾值。

3.  设置 numbers[10] 有什么影响我知道它不会增加数组的大小但是它会做什么呢？

提前致谢 。PS我用GCC编译代码！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:38:42.163

1.  这不会产生错误，您的数组是在堆栈上声明的，因此 number[10] 所做的是写入地址编号 + (10*sizeof int) 并覆盖任何可能存在的内容。
2.  正如 Xymotech 所说，0 可能与 963180397 一样多。打印 numbers[6] 将打印存储在地址 numbers + (6*sizeof int) 的内容，因此这取决于您的程序的编译方式，如果您之前声明了局部变量后面的数字等
3.  见答案 1。

你可以做的是：

```
int empty[100];
int numbers[4]={1};
int empty2[100];

memset(empty, 0xCC, sizeof empty);
memset(empty2, 0xDD, sizeof empty2);

numbers[0]=1;numbers[1]=2;numbers[3]=3;numbers[10]=4;
printf("numbers: %d %d %d %d %d %d\n",numbers[0],numbers[1],numbers[3],numbers[6],numbers[10],  numbers[5]) ; 
```

现在您可以了解在访问 numbers 数组时要覆盖的内容

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T22:38:32.160

要回答您的问题：

1.  不必要。如果您静态声明数组，编译器*可以将*内存保留在更大的块中，或者您可能只是覆盖了堆栈上数组之后的任何其他内容。
2.  这取决于编译器并且属于“未定义的行为”。
3.  您将 (numbers + 10) 设置为等号后面的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T22:44:01.070

它不会导致任何错误，因为它已衰减为指针算术。

当你写的时候`numbers[10]`，它只是`numbers + 10 * sizeof(numbers)`，这是相当正确的。

访问您不打算访问的内存（未为您分配）是未定义的行为，因此您访问的每个越界索引都是垃圾，包括`0`.

正如您所说，访问大于 4 的索引不会增加数组的大小，此外，它也不会做任何事情。

# hibernate - Hibernate 是否优化了同一个孩子的几个懒惰的一对一关系？

> ID：13772058
> 
> 赞同：0
> 
> 时间：2012-12-07T22:30:15.157
> 
> 标签：hibernate, jpa, jpa-2.0

实体`A`有两个单向和惰性的一对一关系`B`（即没有反向关系）。

```
@OneToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL, optional = false)
@JoinColumn(name = "first_b_id")
private B firstB;

@OneToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL, optional = false)
@JoinColumn(name = "second_b_id")
private B secondB; 
```

延迟加载工作正常。但是如果我调用

```
myA.getSecondB() 
```

SQL 日志显示 Hibernate 发出类似的问题

```
select * from B where id in (value1, value2) 
```

因此，关系被懒惰地处理，但它们都是一次加载的。对此有何解释和解决方法？

哦，您可能会问，为什么这如此重要……嗯，`B`实体是 LOB。一个是5+MB的原版，另一个是200KB的“预览版”。当然，如果绝对必要，我只想加载原件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T19:09:16.443

解释可能是您为 B 类（或使用配置属性的每个实体）启用了[批量获取。](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#performance-fetching-batch)`hibernate.default_batch_fetch_size`

# jquery - 在蒙版 css/javascript 下显示图像

> ID：13772063
> 
> 赞同：2
> 
> 时间：2012-12-07T22:31:01.340
> 
> 标签：jquery, css

我确信答案正盯着我看，但我似乎无法弄清楚这一点。

**目标：**我正在尝试做的是动画填充杯子的液体。这不一定是超级现实的。我在想我可以有一个杯子图像作为一层，在它后面有液体的图像，慢慢地露出液体，给人一种被装满的错觉。这将与预加载器（我已经构建）一起使用。

**我尝试过的：** 我的第一个想法是尝试使用 CSS 掩码，所以我稍微修改了一下。虽然它确实有广泛的选项，但您不能只定义您的图像，并且您定义的蒙版之外的所有内容都会显示后面的图像。相反，它只显示你在面具中剪掉的地方，面具之外的一切都是白色的。使用`mask-position`and`mask-repeat: none`无法尝试解决此问题。

**我认为可行的方法：** 也许某种背景定位会变得动画？在调查这一点时，我似乎无法做到我想要的。我知道这将在动画能力中起作用，以缓慢移动遮罩层，使其产生杯子被装满的错觉。

**我的问题：** 我将如何缓慢地显示图像的某些部分，以通过使用杯子的图像作为顶层，将液体作为后面的图层，并在其之间设置一个蒙版，从而给它一种缓慢填满杯子的错觉显示液体？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T23:19:27.087

**2015 年 8 月 5 日**更新****

 **这是一个使用纯 CSS 的新示例！

[http://jsfiddle.net/SptRr/296/](http://jsfiddle.net/SptRr/296/)

**原始答案**

这是一个粗略的例子，但我希望你明白这一点:)

[**小提琴**](http://jsfiddle.net/videsignz/SptRr/)

这是一个带有悬停效果的小提琴来填充玻璃，只是为了好玩！

[**悬停小提琴**](http://jsfiddle.net/videsignz/SptRr/7/)

**HTML**

```
<img src='http://www.videsignz.com/testing/images/water-front.png' />
<div></div> 
```

**CSS**

```
img {position:absolute; left:0px; top:0px; z-index:5;}
div {position:absolute; left:0px; top:350px; background-color:blue; height:0px; display:block; width:350px;} 
```

**jQuery**

```
function animateit(){

$('div').animate({'height' : '350px', 'top' : 0 }, 2000, function(){
   $('div').animate({'height' : 0, 'top' : '350px' }, 2000, animateit);
});

}

animateit(); 
```**

# joomla - 如何在 PHP 中为 Joomla 设置 open_basedir

> ID：13772065
> 
> 赞同：0
> 
> 时间：2012-12-07T22:31:12.967
> 
> 标签：joomla, open-basedir

我正在尝试`open_basedir`在服务器上的 php.ini 文件上进行设置，但是我不确定如何设置。

我是否在服务器上的某处创建目录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T08:48:18.797

您可以在 Joomla!中**查看当前状态！**管理员，在站点 - 系统信息 - PHP 信息下（来自 2.5 的示例）

![截图 Joomla](../Images/5898baea0de4b89d3f3bdbf98e06d77a.png)

**找到你的 php.ini 文件**（在 PHP 信息页面中搜索 php.ini，它应该在 Loaded Configuration File 下），进行备份，然后**添加以下行**（适应你当前的需要；不要忘记删除`;`open_basedir 之前的注释符号）：

`open_basedir = /home/users/you/public_html`

**重新启动您的 Web 服务器（可能是 Apache）。**

现在在 Joomla！您应该看到 的 a 值`open_basedir`。

确保您测试您的 Joomla！通过尝试一些基本任务进行安装，包括更新扩展或安装新扩展。

* * *

**更多文档可以在这里找到：**

[Joomla！文档 - 考虑使用 PHP open_basedir](http://docs.joomla.org/Security_Checklist/Hosting_and_Server_Setup#Consider_Using_PHP_open_basedir)

[php.net 文档 - open_basedir](http://php.net/manual/en/ini.core.php#ini.open-basedir)

# javascript - 获取在 JavaScript 中加载的图像的宽度

> ID：13772066
> 
> 赞同：5
> 
> 时间：2012-12-07T22:31:16.663
> 
> 标签：javascript, jquery, height, width, image

我在我的 JavaScript 代码中附加了一个图像，但想要获得其正确的宽度和高度。这可能吗？我的代码如下所示：

```
$('body').append('<img src="path.jpg" width="'
        + w + '" height="' + h + '" alt="" />'); 
```

* * *

我知道如何在加载后获取图像宽度，但我正在加载`img`并想直接获取其相应的宽度和高度。有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:36:11.253

您可以在加载后获取图像的大小：

```
var imageWidth;
var imageHeight;
$('<img>').on('load', function(){ 
    imageWidth = this.width; 
    imageHeight = this.height; 
    $('body').append($(this));
}).attr('src', imageUrl); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:15:26.490

HTML 规范建议指定`height`和`width`for`<img>`作为视觉代理的提示，它*混合*了标记和样式规则来构建 HTML 文档的视觉表示。在 CSS 盒子模型中，图像尺寸是*固有*的，即它们隐含在二进制 blob 中。这意味着浏览器必须等待 HTTP 响应才能决定图像有多大，从而决定如何布局和定位兄弟姐妹和父母。在 HTML 页面中指定尺寸有助于浏览器快速呈现页面，因为它可以在从服务器下载图像之前分配宽度和高度。

此时应该清楚，在下载之前无法在客户端访问图像宽度。当 Javascript 知道它时，浏览器已经知道了，而您声明它对于您的要求来说为时已晚。

因此，提示浏览器的唯一选择是在服务器端测量图像。它可以在每个请求的基础上完成（但这会浪费资源），或者可以在第一次上传图像时完成一次（然后从数据库中检索），或者最终可以假设它是恒定的，例如如果它是您的服务将始终增长或缩小到完全`W x H`像素大的个人资料图片（这可能是一个配置参数）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T22:43:47.193

```
var image = new Image;
image.src = $('img').prop('src');
alert($(image).prop('height')) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T14:58:38.537

我决定在 wordpress 中创建一个新函数来输出图像尺寸，这样我就可以用 wordpress 检索

```
function wpsc_the_product_dimensions( $width='', $height='', $product_id='' ) {
    if ( empty( $product_id ) )
        $product_id = get_the_ID();

    $product = get_post( $product_id );

    if ( $product->post_parent > 0 )
        $product_id = $product->post_parent;

    $attached_images = (array)get_posts( array(
                'post_type' => 'attachment',
                'numberposts' => 1,
                'post_status' => null,
                'post_parent' => $product_id,
                'orderby' => 'menu_order',
                'order' => 'ASC'
            ) );

    $post_thumbnail_id = get_post_thumbnail_id( $product_id );

    $image_attributes = wp_get_attachment_image_src( $post_thumbnail_id, 'large' );

    $image_dimensions = 'product-link="'.$image_attributes[0].'" product-width="'.$image_attributes[1].'" product-height="'.$image_attributes[2].'"';

    return $image_dimensions;
} 
```

并将 image_dimensions 附加到 img 并使用 javascript 检索

```
w = $(this).attr('product-width');
h = $(this).attr('product-height'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-08T02:23:14.390

您可以提前加载图像，而不必立即显示。

```
var img = document.createElement('img');
img.src = 'your_image.jpg';
var imgHeight = img.height,
    imgWidth = img.width; 
```

您现在可以随时调用它以及正确的详细信息。

# c# - DB2DataReader 对象有数据但 HasRows 属性为 false

> ID：13772068
> 
> 赞同：0
> 
> 时间：2012-12-07T22:31:38.133
> 
> 标签：c#, visual-studio-2010, db2, datareader

我有一个使用从 C# 批处理作业调用的 DB2 存储过程的程序。调用 .ExecuteReader() 后，Visual Studio 2010 显示数据读取器对象的 FieldCount 为“0”，HasRows 属性为“False”。

然而..经过进一步检查，我发现隐藏在对象深处（这是通过在调试时筛选“Locals”读数发现的），存储过程实际上是在发回数据，而我需要的信息深埋在里面DB2DataReader 对象。

由于 HasRows 和 FieldCount 属性分别为“False”和“0”，我无法使用它的任何内置方法（即 .GetString(x)、.GetValue(x).ToString()、 ETC）。我无法遍历结果，因为 while(reader.Read()) 命令将始终为 false（由于 HasRows 属性）。

有没有人在使用任何类型的 DataReader 时遇到过这样的问题，或者一般有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T21:45:15.903

事实证明，DB2 DataReader 并不是最好的对象。相反，我们只是在 DB2Connection 对象（在 C# 中）上调用了一个 ExecuteNonQuery() 命令，以便能够使用此方法提取数据。

# c++ - 取消引用堆上的指针，mscvp.dll 错误？？- 崩溃。C++

> ID：13772069
> 
> 赞同：0
> 
> 时间：2012-12-07T22:31:42.030
> 
> 标签：c++, memory, heap-memory

这是针对计算机科学数据结构类的，我们正在制作一个“内存管理器”，也就是模仿堆工作的东西。基本上，如果用户想在堆上存储东西，他们会定义一些字节数。为了在堆上存储东西，它们传递他们需要的字节数，并返回一个指向堆上至少具有该大小的区域的指针。我得到了这个工作，但我们有一个名为 dump() 的方法，它打印出用户迄今为止创建的所有这些“块”，以及内存是否可用或已使用。这种方法一直有效，直到我达到给我一个错误的某个点。这是我的节点的结构。

```
struct Node
{
    Node* p_right;
    Node* p_left;
    int sizeOfBlock;
    bool isFree;
}; 
```

这是生成错误的代码：

```
void MemoryManager::dump()
{
      Node* p_dump = p_head;    //Stores pointer with which we will loop through nodes

       int block_num = 1;   //Stores the number of the block we are at

       while( true )
       {
         cout << "\tBlock " << block_num << ": "    //Crashes here
         << (p_dump->sizeOfBlock) << " bytes ";

          if( p_dump->isFree )
              cout << "(free)\n";
          else
              cout << "(used)\n";
          block_num++;      //Increase the block num

          if( p_dump->p_right->p_right == 0 ) //If we've found the second to last node
              break;
          else
               p_dump = p_dump->p_right;     //Or else, we move the pointer

         }
 }

Unhandled exception at 0x5c7cfb8a (msvcp100d.dll) in MemoryManager.exe: 0xC0000005: Access violation reading location 0x0000001c. 
```

我的 p_head 是在构造函数中创建的，如果有帮助的话……（p_mem 存在于我的 .h 文件中）

```
MemoryManager::MemoryManager(int numBytes)
{
//Constructor

p_mem = new char[sizeof(Node)*2 + numBytes];

p_head = (Node*)p_mem;      //Create the head node
p_tail = (Node*)(p_mem + sizeof(Node)+ numBytes); //Create the tail node

p_head->sizeOfBlock = numBytes; //Sets the size
p_tail->sizeOfBlock = 0;//Sets the size

p_head->p_right = p_tail; //Sets pointer
p_head->p_left = 0; //Sets pointer

p_tail->p_right = 0;    //Sets pointer
p_tail->p_left = p_head; //Sets pointer

p_head->isFree = true;      //Sets free to true
p_tail->isFree = false; //Sets free to false

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:15:36.800

Weel 显然在某些时候`p_dump->p_right`为空，这使得 p_dump 在下一次循环时为空。由于 p_dump 是地址 0，所以 p_dump->sizeOfBlock 是地址 001C。

在`while(true)`和之间`cout`，你应该有类似的东西：

```
 assert(p_dump != null); 
```

# javafx - javafx - 拖到文件系统 - 获取路径

> ID：13772071
> 
> 赞同：2
> 
> 时间：2012-12-07T22:31:53.770
> 
> 标签：javafx

我对 java 和 javafx 比较陌生。所以我的程序是我不断增长的 java 技能的产物:) 和“谢天谢地”从越来越多的 javafx howto 中复制东西。

好吧，现在我遇到了一个问题，在问你们之前，我已经花了很长时间寻找解决方案。基本上，我已经使用 apache 公共库为这个应用程序构建了一个非常简单的 ftp-client，它进行连接并将 ftpfiles 加载到 tablerow 中，并且可以浏览目录，因为我已经在单独的类上实现了一些 FTPCLient 功能。好吧，我已经设置了从操作系统的文件系统到 tableview 的拖动文件功能，它很好地完成了文件的上传部分。

*但是知道我想实现从 tableview 到文件系统的拖动/复制文件。如果有人能给我一个关于如何做到这一点的简短描述，我将非常感激。我想我可以做到这一点，如果我可以在拖动到它时获得目标目录的路径。可能设置在一个 row- 或 cellfactory 中。*

先谢谢各位了

# objective-c - UIImage Resize drawRect 用黑色填充背景

> ID：13772073
> 
> 赞同：2
> 
> 时间：2012-12-07T22:31:59.830
> 
> 标签：objective-c, ios, core-graphics, drawrect

我有一个名为 MNTRectangle 的类，它是 UIImage 的子类。我已经重写了此类的 drawRect 方法以在图像上绘制边框（使用它的框架）。我有它，所以当用户在名为 DocumentView 的类（UIView 的子类）上开始平移/拖动手势时，它会将 MNTRectangle 的实例作为子视图添加到 DocumentView 的实例中。随着用户继续拖动 MNTRectangle 被调整大小。问题是 MNTRectangle 最后显示为纯黑色，我尝试清除图形上下文以及在绘制边框之前保存上下文并在绘制边框后恢复上下文。无论我似乎尝试什么，我都无法清除 MNTRectangle 并仅在调整大小时显示边框。

这是我的 MNTRectangle 类的代码：

```
@implementation MNTRectangle

- (id)init
{
    self = [super init];

    if (self)
    {
        [self setup];
    }

    return self;
}

- (id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super initWithCoder:aDecoder];

    if (self)
    {
        [self setup];
    }

    return self;
}

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];

    if (self)
    {
        [self setup];
    }

    return self;
}

- (void)setup
{
    [self setBackgroundColor:[UIColor clearColor]];
}

- (void)drawRect:(CGRect)rect
{
    // Get graphics context
    CGContextRef context = UIGraphicsGetCurrentContext();

//    CGContextSaveGState(context);

//    CGContextClearRect(context, rect);

    // Draw border
    CGContextSetLineWidth(context, 4.0);
    [[UIColor blackColor] setStroke];
    CGContextStrokeRect(context, rect);

//    CGContextRestoreGState(context);
} 
```

这是 DocumentView 中用于 UIView 上的平移/拖动处理的代码：

```
-(id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];

    if (self)
    {
         _panGesture = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(handlePan:)];
    }

    return self;
}

- (void)handlePan:(UIPanGestureRecognizer *)sender
{
    if ([sender state] == UIGestureRecognizerStateBegan)
    {
        _startPanPoint = [sender locationInView:self];

        MNTRectangle *rectangle = [[MNTRectangle alloc] initWithFrame:CGRectMake(_startPanPoint.x, _startPanPoint.y, 1, 1)];
        [_objects addObject:rectangle];
        _currentPanObject = rectangle;
        [self addSubview:rectangle];
    }
    else if ([sender state] == UIGestureRecognizerStateChanged)
    {
        CGPoint endPanPoint = [sender locationInView:self];

        float height = fabsf(endPanPoint.y - _startPanPoint.y);
        float width = fabsf(endPanPoint.x - _startPanPoint.x);
        float x = MIN(_startPanPoint.x, endPanPoint.x);
        float y = MIN(_startPanPoint.y, endPanPoint.y);

        MNTRectangle *rectangle = (MNTRectangle *)_currentPanObject;
        [rectangle setFrame:CGRectMake(x, y, width, height)];
    }
    else if ([sender state] == UIGestureRecognizerStateEnded)
    {
        CGPoint endPanPoint = [sender locationInView:self];

        float height = fabsf(endPanPoint.y - _startPanPoint.y);
        float width = fabsf(endPanPoint.x - _startPanPoint.x);
        float x = MIN(_startPanPoint.x, endPanPoint.x);
        float y = MIN(_startPanPoint.y, endPanPoint.y);

        MNTRectangle *rectangle = (MNTRectangle *)_currentPanObject;
        [rectangle setFrame:CGRectMake(x, y, width, height)];
    }
} 
```

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T00:36:04.733

我终于弄明白了。在`handlePan:`我设置我丢失的矩形框架之后的方法中`[rectangle setNeedsDisplay];`。

现在我的 DocumentView 代码如下所示：

```
-(id)initWithFrame:(CGRect)frame
{
   self = [super initWithFrame:frame];

    if (self)
    {
         _panGesture = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(handlePan:)];
    }

    return self;
}

- (void)handlePan:(UIPanGestureRecognizer *)sender
{
   if ([sender state] == UIGestureRecognizerStateBegan)
   {
        _startPanPoint = [sender locationInView:self];

        MNTRectangle *rectangle = [[MNTRectangle alloc] initWithFrame:CGRectMake(_startPanPoint.x, _startPanPoint.y, 1, 1)];
        [_objects addObject:rectangle];
        _currentPanObject = rectangle;
        [self addSubview:rectangle];
    }
    else if ([sender state] == UIGestureRecognizerStateChanged)
    {
        CGPoint endPanPoint = [sender locationInView:self];

        float height = fabsf(endPanPoint.y - _startPanPoint.y);
        float width = fabsf(endPanPoint.x - _startPanPoint.x);
        float x = MIN(_startPanPoint.x, endPanPoint.x);
        float y = MIN(_startPanPoint.y, endPanPoint.y);

        MNTRectangle *rectangle = (MNTRectangle *)_currentPanObject;
        [rectangle setFrame:CGRectMake(x, y, width, height)];
        [rectangle setNeedsDisplay];
    }
    else if ([sender state] == UIGestureRecognizerStateEnded)
    {
        CGPoint endPanPoint = [sender locationInView:self];

        float height = fabsf(endPanPoint.y - _startPanPoint.y);
        float width = fabsf(endPanPoint.x - _startPanPoint.x);
        float x = MIN(_startPanPoint.x, endPanPoint.x);
        float y = MIN(_startPanPoint.y, endPanPoint.y);

        MNTRectangle *rectangle = (MNTRectangle *)_currentPanObject;
        [rectangle setFrame:CGRectMake(x, y, width, height)];
        [rectangle setNeedsDisplay];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T22:36:05.213

你会想打电话`[super drawRect:rect]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T01:03:29.823

为了向任何阅读的人澄清，调用`[rectangle setNeedsDisplay];`是必要的，因为您正在覆盖，因此需要告诉,`drawRect:`的这个子类在其内部变量已更改后手动重绘自身。`UIView``MNTRectangle`

此函数在继承自 的标准对象上自动调用`UIView`，但由于您创建了自定义对象，如果您有一些`MNTRectangle`需要重绘的特殊行为，则需要手动调用它。

更多文档[在这里](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSView_Class/Reference/NSView.html)。

# php - session_start() 需要很长时间

> ID：13772074
> 
> 赞同：27
> 
> 时间：2012-12-07T22:32:16.217
> 
> 标签：php, performance, zend-framework, session, profiling

我的网站运行得很慢（我不知道为什么）。它基于 Zend Application，我曾经制作过大约几十个这样的网站，所以我确信我的代码是可以的。

我在服务器上安装了 xdebugger，试图分析它，你猜怎么着？php::session_start() 耗时 48.675 秒。四十八秒半！这太不可思议了！这可能是什么原因？很普通的操作，为什么能执行这么久？如何解决这种行为，要编辑哪些配置？在谷歌上搜索，但没有找到好的答案（几乎到处都有问题，但没有答案）。之前谢谢！

![xdebugger 分析结果](../Images/04fa250562603822f5e3b6479393d59a.png)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-07T07:39:27.390

`session_start`（会话存储在文件中）在 PHP 中被阻塞，因此如果您尝试为同一个浏览器会话（AJAX 或多个浏览器选项卡/窗口）启动多个服务器会话，则会出现此问题。每个都`session_start`将等到其他会话关闭。

见这里： http: [//konrness.com/php5/how-to-prevent-blocking-php-requests/](http://konrness.com/php5/how-to-prevent-blocking-php-requests/)

尝试从文件更改为会话的数据库存储。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-12-07T22:38:22.643

我的猜测是垃圾收集例程，它在本机`session_start()`函数内部运行。也许您已经做了一些保留许多旧会话文件的操作，例如更改了最大生命周期？或者，也许您已经决定将它们存储在数据库中是个好主意，但忘记创建合适的索引？本机 GC 例程 stat() 的每个会话文件都用于检查是否过期。如果构建了很多文件，这将非常耗时。

**编辑**：仅帮助您**进行调试，通过临时设置**[session.gc-probability](http://php.net/manual/en/session.configuration.php#ini.session.gc-probability)禁用垃圾收集：

```
session.gc-probability = 0 
```

确保设置不变，我不知道 zend 框架在这里可能会做什么。

PS 在不知道原因的情况下很难提出修复建议。我的回答旨在指导您确定原因。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-08-31T03:27:19.647

我遇到了这个问题，很惊讶没有人发布这个具体的回复。可能不是，但值得检查。

PHP 在处理页面时锁定会话文件，以便该页面可以独占访问它。想想看，sess_184c9aciqoc文件不是数据库，所以同一个会话中的两个调用不能同时访问。因此，如果您有很多 ajax 调用，您可能会遇到“交通堵塞”。一旦你开始编写高级脚本，这是一个需要提防的问题。顺便说一句，这是一个存储时间戳数组的函数。我用它来确定会话开始是罪魁祸首：

```
//time function for benchmarking
if( function_exists('gmicrotime')){
    function gmicrotime($n=''){
        #version 1.1, 2007-05-09
        //store array of all calls
        global $mT;
        list($usec, $sec) = explode(' ',microtime());
        if(!isset($mT['_base_']))$mT['_base_']=$sec;
    $t=round((float)$usec + (float)(substr($sec,-4)),6);
    $mT['all'][]=$t;
    if($n){
        if(isset($mT['indexed'][$n])){
            //store repeated calls with same index.  If in a loop, add a $i if needed
            if(is_array($mT['indexed'][$n])){
                $mT['indexed'][$n][]=$t;
            }else{
                $mT['indexed'][$n]=array($mT['indexed'][$n],$t);
            }
        }else $mT['indexed'][$n]=$t;    
    }
    //return elapsed since last call (in the local array)
    $u=$mT['all'];
    if(count($u)>1){
        $mT['_total_']=$u[count($u)-1] - $u[0];
        return round(1000*($u[count($u)-1]-$u[count($u)-2]),6);
    }
}
gmicrotime('pageStart');
} 
```

然后我打电话如下：

```
gmicrotime('beforeSessionStart');
session_start();
gmicrotime('afterSessionStart');

do_something_slow();
gmicrotime('afterSlowProcess');
//etc..
echo '<pre>';
print_r($mT); 
```

希望这有帮助！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-09T19:22:03.067

另一种方法可能是你`memory_limit`在 PHP.ini 中设置了一个大的。

我这样做是为了将大量的 mysql 转储上传到 PHPMyAdmin 并增加加载时间，也许（如上所述）现在 PHP 有空余的空间堆积了很多会话文件。我认为默认是`128M`。我已经翻了两番。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-17T18:31:17.523

避免此问题的一种方法是要求 PHP 将会话存储在数据库表中而不是文件中。

首先，我会给你一些链接作为这个解决方案的真正功劳：

[http://www.tonymarston.net/php-mysql/session-handler.html](http://www.tonymarston.net/php-mysql/session-handler.html)

[http://shiflett.org/articles/storing-sessions-in-a-database](http://shiflett.org/articles/storing-sessions-in-a-database)

[http://culttt.com/2013/02/04/how-to-save-php-sessions-to-a-database/](http://culttt.com/2013/02/04/how-to-save-php-sessions-to-a-database/)

然后是我从这些读数中得出的代码实现：

```
<?php

class TLB_Sessions_in_Database
{
    private $debug;
    private $dbc;

    function __construct()
    {
        $this->debug = false;

        session_set_save_handler(
            array($this, '_open'),
            array($this, '_close'),
            array($this, '_read'),
            array($this, '_write'),
            array($this, '_destroy'),
            array($this, '_clean')
        );
    }

    function _open()
    {
        if( $this->debug ) echo '_open:'.PHP_EOL;

        if( ($this->dbc = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD)) !== false )
        {
            $select_db = mysql_select_db(DB_NAME, $this->dbc);
            $set_charset = mysql_set_charset(DB_CHARSET, $this->dbc);

            if( $this->debug ) echo '- return: '.(( $select_db && $set_charset ) ? 'true' : 'false').PHP_EOL;

            return( $select_db && $set_charset );
        }
        else
        {
            if( $this->debug ) echo '- error: '.mysql_error($this->dbc).PHP_EOL;
        }

        return( false );
    }

    function _close()
    {
        if( $this->debug ) echo '_close:'.PHP_EOL;

        return( mysql_close($this->dbc) );
    }

    function _read($session_id)
    {
        if( $this->debug ) echo '_read:'.PHP_EOL;

        $session_id = mysql_real_escape_string($session_id);

        $sql = "SELECT `session_data` FROM `".DB_NAME."`.`php_sessions` WHERE `session_id` = '".$session_id."'";

        if( $this->debug ) echo '- query: '.$sql.PHP_EOL;

        if( ($result = mysql_query($sql, $this->dbc)) !== false )
        {
            if( !in_array(mysql_num_rows($result), array(0, false), true) )
            {
                $record = mysql_fetch_assoc($result);

                return( $record['session_data'] );
            }
        }
        else
        {
            if( $this->debug ) echo '- error: '.mysql_error($this->dbc).PHP_EOL;
        }

        return( '' );
    }

    function _write($session_id, $session_data)
    {
        if( $this->debug ) echo '_write:'.PHP_EOL;

        $session_id = mysql_real_escape_string($session_id);
        $session_data = mysql_real_escape_string($session_data);

        //$sql = "REPLACE INTO `php_sessions` (`session_id`, `last_updated`, `session_data`) VALUES ('".$session_id."', '".time()."', '".$session_data."')";
        $sql = "INSERT INTO `".DB_NAME."`.`php_sessions` (`session_id`, `date_created`, `session_data`) VALUES ('".$session_id."', NOW(), '".$session_data."') ON DUPLICATE KEY UPDATE `last_updated` = NOW(), `session_data` = '".$session_data."'";

        if( ($result = mysql_query($sql, $this->dbc)) === false )
        {
            if( $this->debug ) echo '- error: '.mysql_error($this->dbc).PHP_EOL;
        }

        return( $result );
    }

    function _destroy($session_id)
    {
        if( $this->debug ) echo '_destroy:'.PHP_EOL;

        $session_id = mysql_real_escape_string($session_id);

        $sql = "DELETE FROM `".DB_NAME."`.`php_sessions` WHERE `session_id` = '".$session_id."'";

        if( ($result = mysql_query($sql, $this->dbc)) === false )
        {
            if( $this->debug ) echo '- error: '.mysql_error($this->dbc).PHP_EOL;
        }

        return( $result );
    }

    function _clean($max)
    {
        if( $this->debug ) echo '_clean:'.PHP_EOL;

        $sql = 'DELETE FROM `'.DB_NAME.'`.`php_sessions` WHERE `last_updated` < DATE_SUB(NOW(), INTERVAL '.$max.' SECOND)';

        if( ($result = mysql_query($sql, $this->dbc)) === false )
        {
            if( $this->debug ) echo '- error: '.mysql_error($this->dbc).PHP_EOL;
        }

        return( $result );
    }
}

new TLB_Sessions_in_Database(); 
```

结尾。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-21T07:21:47.047

我的页面在许多 <img src="download_image.php"> 标签中打开并发会话，其中 download_image.php 运行 session_start() 然后下载图像。

在 download_image.php 中插入 session_write_close() 解决了我的问题。

```
session_start();

session_write_close(); 

download_image(); 
```

我已经尝试过 memcached 和 session_start(['read_and_close'=>true])。但只有 session_write_close() 对我有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-05T18:39:03.017

如果您在同一页面上有多个并发 ajax 调用，这种情况可能会导致您的问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-12-22T15:41:06.490

我刚遇到这个问题。session_start 大约需要 5 秒。

我的问题是我在它上面声明了一些变量。

我将 session_start 移到顶部，现在需要几毫秒。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-10-05T10:56:49.167

在我的情况下，`/etc/php.d/memcached.ini` [这里](http://php.net/manual/en/memcached.configuration.php)是有关 memcache 属性的信息中的 memcache 服务器设置不正确，[这里](https://www.dotdeb.org/2008/08/25/storing-your-php-sessions-using-memcached/)是如何在 memcache 中设置存储。

# php - jQuery 和 PHP 远程上传

> ID：13772076
> 
> 赞同：1
> 
> 时间：2012-12-07T22:32:18.743
> 
> 标签：php, ajax, jquery, file-upload

我需要一个远程上传脚本的帮助，该脚本有一个名为“uploadHandler.php”的页面。我需要使用 jQuery PHP 文件上传（jQuery 文件上传）创建一个远程上传脚本。我想通过这个脚本上传一个来自不同服务器的文件，只输入 URL。如何才能做到这一点？

让我解释。我有一个表单，当用户从他的计算机上传文件时，它会向 uploadHandler.php 发送请求。问题是类型是“multipart/form-data”，所以我无法通过 URL 上传。我尝试输入 URL 但系统返回

```
[{"name":"","size":0,"type":null,"error":"File received has zero size."}] 
```

那么，我应该怎么做才能确保文件被uploadHandler.php处理然后正确存储呢？我曾想过从服务器下载文件然后上传它来做这样处理。但是怎么做？我附上了uploadHandler.php 的内容，供想阅读的人阅读。预先感谢您的帮助，对于语法和词汇错误，我深表歉意：我不是英语。

```
class uploadHandler
{    
    private $options;

function __construct($options = null)
{
    // get accepted file types
    $acceptedFileTypes = getAcceptedFileTypes();

    $this->options = array(
        'script_url' => $_SERVER['PHP_SELF'],
        'upload_dir' => _CONFIG_FILE_STORAGE_PATH,
        'upload_url' => dirname($_SERVER['PHP_SELF']) . '/files/',
        'param_name' => 'files',
        'delete_hash' => '',
        // The php.ini settings upload_max_filesize and post_max_size
        // take precedence over the following max_file_size setting:
        'max_file_size' => $this->get_max_upload_size(),
        'min_file_size' => 1,
        'accept_file_types' => COUNT($acceptedFileTypes) ? ('/(\.|\/)(' . str_replace(".", "", implode("|", $acceptedFileTypes)) . ')$/i') : '/.+$/i',
        'max_number_of_files' => null,
        'discard_aborted_uploads' => true,
        'image_versions' => array(
            'thumbnail' => array(
                'upload_dir' => dirname(__FILE__) . '/thumbnails/',
                'upload_url' => dirname($_SERVER['PHP_SELF']) . '/thumbnails/',
                'max_width' => 80,
                'max_height' => 80
            )
        )
    );
    if ($options)
    {
        $this->options = array_replace_recursive($this->options, $options);
    }
}

private function get_max_upload_size()
{
    // Initialize current user
    $Auth = Auth::getAuth();

    // max allowed upload size
    $maxUploadSize = SITE_CONFIG_FREE_USER_MAX_UPLOAD_FILESIZE;
    if ($Auth->loggedIn())
    {
        // check if user is a premium/paid user
        if ($Auth->level != 'free user')
        {
            $maxUploadSize = SITE_CONFIG_PREMIUM_USER_MAX_UPLOAD_FILESIZE;
        }
    }

    // if php restrictions are lower than permitted, override
    $phpMaxSize = getPHPMaxUpload();
    if ($phpMaxSize < $maxUploadSize)
    {
        $maxUploadSize = $phpMaxSize;
    }

    return $maxUploadSize;
}

private function get_file_object($file_name)
{
    $file_path = $this->options['upload_dir'] . $file_name;
    if (is_file($file_path) && $file_name[0] !== '.')
    {
        $file = new stdClass();
        $file->name = $file_name;
        $file->size = filesize($file_path);
        $file->url = $this->options['upload_url'] . rawurlencode($file->name);
        foreach ($this->options['image_versions'] as $version => $options)
        {
            if (is_file($options['upload_dir'] . $file_name))
            {
                $file->{$version . '_url'} = $options['upload_url']
                        . rawurlencode($file->name);
            }
        }
        $file->delete_url = '~d?' . $this->options['delete_hash'];
        $file->info_url = '~i?' . $this->options['delete_hash'];
        $file->delete_type = 'DELETE';
        return $file;
    }
    return null;
}

private function get_file_objects()
{
    return array_values(array_filter(array_map(
                                    array($this, 'get_file_object'), scandir($this->options['upload_dir'])
                            )));
}

private function create_scaled_image($file_name, $options)
{
    $file_path = $this->options['upload_dir'] . $file_name;
    $new_file_path = $options['upload_dir'] . $file_name;
    list($img_width, $img_height) = @getimagesize($file_path);
    if (!$img_width || !$img_height)
    {
        return false;
    }
    $scale = min(
            $options['max_width'] / $img_width, $options['max_height'] / $img_height
    );
    if ($scale > 1)
    {
        $scale = 1;
    }
    $new_width = $img_width * $scale;
    $new_height = $img_height * $scale;
    $new_img = @imagecreatetruecolor($new_width, $new_height);
    switch (strtolower(substr(strrchr($file_name, '.'), 1)))
    {
        case 'jpg':
        case 'jpeg':
            $src_img = @imagecreatefromjpeg($file_path);
            $write_image = 'imagejpeg';
            break;
        case 'gif':
            $src_img = @imagecreatefromgif($file_path);
            $write_image = 'imagegif';
            break;
        case 'png':
            $src_img = @imagecreatefrompng($file_path);
            $write_image = 'imagepng';
            break;
        default:
            $src_img = $image_method = null;
    }
    $success = $src_img && @imagecopyresampled(
                    $new_img, $src_img, 0, 0, 0, 0, $new_width, $new_height, $img_width, $img_height
            ) && $write_image($new_img, $new_file_path);
    // Free up memory (imagedestroy does not delete files):
    @imagedestroy($src_img);
    @imagedestroy($new_img);
    return $success;
}

private function has_error($uploaded_file, $file, $error)
{
    if ($error)
    {
        return $error;
    }
    if (!preg_match($this->options['accept_file_types'], $file->name))
    {
        return 'acceptFileTypes';
    }
    if ($uploaded_file && is_uploaded_file($uploaded_file))
    {
        $file_size = filesize($uploaded_file);
    } else
    {
        $file_size = $_SERVER['CONTENT_LENGTH'];
    }
    if ($this->options['max_file_size'] && (
            $file_size > $this->options['max_file_size'] ||
            $file->size > $this->options['max_file_size'])
    )
    {
        return 'maxFileSize';
    }
    if ($this->options['min_file_size'] &&
            $file_size < $this->options['min_file_size'])
    {
        return 'minFileSize';
    }
    if (is_int($this->options['max_number_of_files']) && (
            count($this->get_file_objects()) >= $this->options['max_number_of_files'])
    )
    {
        return 'maxNumberOfFiles';
    }
    return $error;
}

private function handle_file_upload($uploaded_file, $name, $size, $type, $error)
{
    $fileUpload = new stdClass();
    $fileUpload->name = basename(stripslashes($name));
    $fileUpload->size = intval($size);
    $fileUpload->type = $type;
    $fileUpload->error = null;

    $extension = end(explode(".", $fileUpload->name));
    $fileUpload->error = $this->has_error($uploaded_file, $fileUpload, $error);
    if (!$fileUpload->error)
    {
        if (strlen(trim($fileUpload->name)) == 0)
        {
            $fileUpload->error = 'Filename not found.';
        }
    }
    elseif (intval($size) == 0)
    {
        $fileUpload->error = 'File received has zero size.';
    }
    elseif (intval($size) > $this->options['max_file_size'])
    {
        $fileUpload->error = 'File received is larger than permitted.';
    }

    if (!$fileUpload->error && $fileUpload->name)
    {
        if ($fileUpload->name[0] === '.')
        {
            $fileUpload->name = substr($fileUpload->name, 1);
        }
        $newFilename = MD5(microtime());

        // figure out upload type
        $file_size = 0;

        // select server from pool
        $uploadServerId = getAvailableServerId();
        $db = Database::getDatabase(true);
        $uploadServerDetails = $db->getRow('SELECT * FROM file_server WHERE id = ' . $db->quote($uploadServerId));

        // override storage path
        if(strlen($uploadServerDetails['storagePath']))
        {
            $this->options['upload_dir'] = $uploadServerDetails['storagePath'];
            if (substr($this->options['upload_dir'], strlen($this->options['upload_dir']) - 1, 1) == '/')
            {
                $this->options['upload_dir'] = substr($this->options['upload_dir'], 0, strlen($this->options['upload_dir']) - 1);
            }
            $this->options['upload_dir'] .= '/';
        }

        // move remotely via ftp
        if($uploadServerDetails['serverType'] == 'remote')
        {
            // connect ftp
            $conn_id = ftp_connect($uploadServerDetails['ipAddress'], $uploadServerDetails['ftpPort'], 30);
            if($conn_id === false)
            {
                $fileUpload->error = 'Could not connect to file server '.$uploadServerDetails['ipAddress'];
            }

            // authenticate
            if(!$fileUpload->error)
            {
                $login_result = ftp_login($conn_id, $uploadServerDetails['ftpUsername'], $uploadServerDetails['ftpPassword']);
                if($login_result === false)
                {
                    $fileUpload->error = 'Could not authenticate with file server '.$uploadServerDetails['ipAddress'];
                }
            }

            // create the upload folder
            if(!$fileUpload->error)
            {
                $uploadPathDir = $this->options['upload_dir'] . substr($newFilename, 0, 2);
                if(!ftp_mkdir($conn_id, $uploadPathDir))
                {
                    // Error reporting removed for now as it causes issues with existing folders. Need to add a check in before here
                    // to see if the folder exists, then create if not.
                    // $fileUpload->error = 'There was a problem creating the storage folder on '.$uploadServerDetails['ipAddress'];
                }
            }

            // upload via ftp
            if(!$fileUpload->error)
            {
                $file_path = $uploadPathDir . '/' . $newFilename;
                clearstatcache();
                if ($uploaded_file && is_uploaded_file($uploaded_file))
                {
                    // initiate ftp
                    $ret = ftp_nb_put($conn_id, $file_path, $uploaded_file, 
                                        FTP_BINARY, FTP_AUTORESUME);
                    while ($ret == FTP_MOREDATA)
                    {
                        // continue uploading
                        $ret = ftp_nb_continue($conn_id);
                    }

                    if ($ret != FTP_FINISHED)
                    {
                        $fileUpload->error = 'There was a problem uploading the file to '.$uploadServerDetails['ipAddress'];
                    }
                    else
                    {
                        $file_size = filesize($uploaded_file);
                        @unlink($uploaded_file);
                    }
                }
            }

            // close ftp connection
            ftp_close($conn_id);
        }
        // move into local storage
        else
        {
            // create the upload folder
            $uploadPathDir = $this->options['upload_dir'] . substr($newFilename, 0, 2);
            @mkdir($uploadPathDir);

            $file_path = $uploadPathDir . '/' . $newFilename;
            clearstatcache();
            if ($uploaded_file && is_uploaded_file($uploaded_file))
            {
                move_uploaded_file($uploaded_file, $file_path);
            }
            $file_size = filesize($file_path);
        }

        // check filesize uploaded matches tmp uploaded
        if ($file_size === $fileUpload->size)
        {
            $fileUpload->url = $this->options['upload_url'] . rawurlencode($fileUpload->name);

            // insert into the db
            $fileUpload->size = $file_size;
            $fileUpload->delete_url = '~d?' . $this->options['delete_hash'];
            $fileUpload->info_url = '~i?' . $this->options['delete_hash'];
            $fileUpload->delete_type = 'DELETE';

            // create delete hash, make sure it's unique
            $deleteHash = md5($fileUpload->name . getUsersIPAddress() . microtime());
            $existingFile = file::loadByDeleteHash($deleteHash);
            while ($existingFile != false)
            {
                $deleteHash = md5($fileUpload->name . getUsersIPAddress() . microtime());
                $existingFile = file::loadByDeleteHash($deleteHash);
            }

            // store in db
            $db = Database::getDatabase(true);
            $dbInsert = new DBObject("file", array("originalFilename", "shortUrl", "fileType", "extension", "fileSize", "localFilePath", "userId", "totalDownload", "uploadedIP", "uploadedDate", "statusId", "deleteHash", "serverId"));

            $dbInsert->originalFilename = $fileUpload->name;
            $dbInsert->shortUrl = 'temp';
            $dbInsert->fileType = $fileUpload->type;
            $dbInsert->extension = $extension;
            $dbInsert->fileSize = $fileUpload->size;
            $dbInsert->localFilePath = str_replace($this->options['upload_dir'], "", $file_path);

            // add user id if user is logged in
            $dbInsert->userId = NULL;
            $Auth = Auth::getAuth();
            if ($Auth->loggedIn())
            {
                $dbInsert->userId = (int) $Auth->id;
            }

            $dbInsert->totalDownload = 0;
            $dbInsert->uploadedIP = getUsersIPAddress();
            $dbInsert->uploadedDate = sqlDateTime();
            $dbInsert->statusId = 1;
            $dbInsert->deleteHash = $deleteHash;
            $dbInsert->serverId = $uploadServerId;

            if (!$dbInsert->insert())
            {
                $fileUpload->error = 'abort';
            }

            // create short url
            $tracker = 1;
            $shortUrl = file::createShortUrlPart($tracker . $dbInsert->id);
            $fileTmp = file::loadByShortUrl($shortUrl);
            while ($fileTmp)
            {
                $shortUrl = file::createShortUrlPart($tracker . $dbInsert->id);
                $fileTmp = file::loadByShortUrl($shortUrl);
                $tracker++;
            }

            // update short url
            file::updateShortUrl($dbInsert->id, $shortUrl);

            // update fileUpload with file location
            $file = file::loadByShortUrl($shortUrl);
            $fileUpload->url = $file->getFullShortUrl();
            $fileUpload->delete_url = $file->getDeleteUrl();
            $fileUpload->info_url = $file->getInfoUrl();
            $fileUpload->stats_url = $file->getStatisticsUrl();
            $fileUpload->short_url = $shortUrl;
        }
        else if ($this->options['discard_aborted_uploads'])
        {
            //@TODO - made ftp compatible
            @unlink($file_path);
            @unlink($uploaded_file);
            if(!isset($fileUpload->error))
            {
                $fileUpload->error = 'maxFileSize';
            }
        }
    }

    return $fileUpload;
}

public function get()
{
    $file_name = isset($_REQUEST['file']) ?
            basename(stripslashes($_REQUEST['file'])) : null;
    if ($file_name)
    {
        $info = $this->get_file_object($file_name);
    } else
    {
        $info = $this->get_file_objects();
    }
    header('Content-type: application/json');
    echo json_encode($info);
}

public function post()
{
    $upload = isset($_FILES[$this->options['param_name']]) ?
            $_FILES[$this->options['param_name']] : array(
        'tmp_name' => null,
        'name' => null,
        'size' => null,
        'type' => null,
        'error' => null
            );
    $info = array();
    if (is_array($upload['tmp_name']))
    {
        foreach ($upload['tmp_name'] as $index => $value)
        {
            $info[] = $this->handle_file_upload($upload['tmp_name'][$index], 
                    isset($_SERVER['HTTP_X_FILE_NAME']) ? $_SERVER['HTTP_X_FILE_NAME'] : $upload['name'][$index], 
                    isset($_SERVER['HTTP_X_FILE_SIZE']) ? $_SERVER['HTTP_X_FILE_SIZE'] : $upload['size'][$index], 
                    isset($_SERVER['HTTP_X_FILE_TYPE']) ? $_SERVER['HTTP_X_FILE_TYPE'] : $upload['type'][$index], 
                    $upload['error'][$index]
            );
        }
    } else
    {
        $info[] = $this->handle_file_upload($upload['tmp_name'], 
                isset($_SERVER['HTTP_X_FILE_NAME']) ? $_SERVER['HTTP_X_FILE_NAME'] : $upload['name'],
                isset($_SERVER['HTTP_X_FILE_SIZE']) ? $_SERVER['HTTP_X_FILE_SIZE'] : $upload['size'],
                isset($_SERVER['HTTP_X_FILE_TYPE']) ? $_SERVER['HTTP_X_FILE_TYPE'] : $upload['type'],
                $upload['error']
        );
    }
    header('Vary: Accept');
    if (isset($_SERVER['HTTP_ACCEPT']) &&
            (strpos($_SERVER['HTTP_ACCEPT'], 'application/json') !== false))
    {
        header('Content-type: application/json');
    } else
    {
        header('Content-type: text/plain');
    }
    echo json_encode($info);
}
}

$upload_handler = new uploadHandler();

header('Pragma: no-cache');
header('Cache-Control: private, no-cache');
header('Content-Disposition: inline; filename="files.json"');

// check we are receiving the request from this script
if (!checkReferrer())
{
    // exit
    header('HTTP/1.0 400 Bad Request');
    exit();
}

switch ($_SERVER['REQUEST_METHOD'])
{
    case 'HEAD':
    case 'GET':
        $upload_handler->get();
        break;
    case 'POST':
        $upload_handler->post();
        break;
    default:
        header('HTTP/1.0 405 Method Not Allowed');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T22:42:25.840

你需要下载器。不是上传者。您想将文件从另一台服务器下载到您的服务器。要通过 PHP 实现这一点，您可以使用 cUrl 或 file_get_contents。在表单中，只需获取 URL，提交表单后，使用 cUrl 或 file_get_contents() 将文件从该 URL 下载到您的服务器。

# java - 根据窗口大小调整 JScrollPane 的大小

> ID：13772078
> 
> 赞同：1
> 
> 时间：2012-12-07T22:32:34.540
> 
> 标签：java, swing, jscrollpane, miglayout

经过大量搜索，我希望这会给我一个答案。

好的，我有一个 JFrame，它的顶部有一个 JPanel，底部有一个。它的侧面也有一个，其中包含一个 JScrollPane。顶部和底部面板应与窗口大小保持一致，但侧面板应垂直更改。不幸的是，当 JScrollPane 有太多项目时，根本不会显示滚动条。相反，整个窗口被放大，将底部面板和 JScrollPane 中的所有多余部分推到屏幕外。

我一直在使用 MigLayout，但如果我需要为侧面板使用其他布局，我可以。这是我最近**失败**的代码迭代。

这是我添加 JScrollPane 的地方：

```
public MenuPanel(){
    this.setLayout(new BorderLayout());
    innerPanel = new InnerPanel();
    jsp = new JScrollPane(innerPanel, 
            JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED, 
            JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
    this.add(jsp, BorderLayout.CENTER);
} 
```

这是在主窗口内：

```
private void addSideSelectionPane() {
    side = new SelectionPanel();
    this.add(side, "wmax 200, growy");
} 
```

这是我创建主窗口的代码：

```
public InsWindow(){
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    this.setExtendedState( this.getExtendedState()| java.awt.Frame.MAXIMIZED_BOTH );
    this.setLayout(new MigLayout("debug, nogrid, fill", "[grow, fill]", "[pref!]10[grow, fill]"));
    this.addTestLabel();
    this.addSideSelectionPane();
    this.addMainWindow();
    this.addBottomPanel();
    this.setVisible(true);
} 
```

# php - 显示组的 b3 表

> ID：13772079
> 
> 赞同：1
> 
> 时间：2012-12-07T22:32:38.413
> 
> 标签：php, mysql, b3

我正在这里做一个小而简单的（我敢肯定对你们中的大多数人来说）项目。简而言之，有一个名为 B3 的管理“工具”将数据存储在 mysql 中。我拼凑了一个小 php 来获取所有级别的管理员并显示简短的细节。该工具旨在轻松检查谁拥有管理员权限，以及他们的级别。诚然，这两个额外的细节是可能不会保留的绒毛（对我来说更像是一种概念证明。）

我所拥有的一切都很好，并且正如我上面概述的那样。但是，我想更进一步，让它更“用户友好”。还有第二个表，其中包含 group_bits 中列出的数字级别，并为其分配一个用户友好的名称，例如 16 可能是主持人。

我知道这对你们大多数人来说可能是学龄前水平，但我已经搜遍了，只是不知道我想做的正确措辞是什么..

本质上，在显示我的输出时，我希望它“我认为”在 group+bits 上执行一次 foreach 并显示正确的访问级别，而不仅仅是 group_bits id。理想情况下，它会从识别数字和名称的组表中提取该信息，但我会很高兴地对其进行硬编码，有点像“如果 $group_bits=16 then $group="Moderator") . 无论完成什么工作，大声笑.. 普遍会更好地从表本身获取它，对，所以如果它被改变了，那么这个文件就不必改变了，但我感觉可能会更多困难吗？以下是一些有用的细节，以及我所拥有的：

我的PHP：

```
//We connect to a   database using the mysql_connect command.
mysql_connect($dbhost, $dbuser, $dbpass) or die(mysql_error()); 

//We select the database we are  going to use.
mysql_select_db("$dbname") or die(mysql_error()); 

//$query="SELECT * FROM clients ORDER BY name DESC";
$query="SELECT * FROM `clients` WHERE group_bits >'1'";

$result=mysql_query($query);
$num=mysql_numrows($result);  //Counts the rows in the table
echo "" .$screweditup ;
mysql_close();

?>
<table border="0" cellspacing="2" cellpadding="2">
    <tr>
        <td><font face="Arial, Helvetica, sans-serif">Player Name</font></td>
        <td><font face="Arial, Helvetica, sans-serif">B3 Level</font></td>
        <td><font face="Arial, Helvetica, sans-serif">Times Connected</font></td>
        <td><font face="Arial, Helvetica, sans-serif">Greeting Msg</font></td>
        <td><font face="Arial, Helvetica, sans-serif"></font></td>
    </tr>

<?php
$i=0;
while ($i < $num) {
    for each($
    $f1=mysql_result($result,$i,"name");
    $f2=mysql_result($result,$i,"group_bits");
    $f3=mysql_result($result,$i,"connections");
    $f4=mysql_result($result,$i,"greeting");

    //$f5=mysql_result($result,$i,"greeting");
?>

<tr>
    <td><font face="Arial, Helvetica, sans-serif"><?php echo $f1; ?></font></td>
    <td><font face="Arial, Helvetica, sans-serif"><?php echo $f2; ?></font></td>
    <td><font face="Arial, Helvetica, sans-serif"><?php echo $f3; ?></font></td>
    <td><font face="Arial, Helvetica, sans-serif"><?php echo $f4; ?></font></td>
    <td><font face="Arial, Helvetica, sans-serif"><?php echo $f5; ?></font></td>
</tr> 
```

客户端是保存您看到正在使用的信息的表。groups 保存 group_bits 和实际组名称所在的表。它看起来像这样（表视图：）

```
id               name                keyword
16               Admin               admin
8                Moderator           mod
0                Guest               guest 
```

（groups 表中的数字称为 id，但在 clients 表中称为 group_bits - 它们是相同的，但名称不同。任何帮助将不胜感激！

151

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T02:53:03.557

```
$query="SELECT g.name
              ,c.* FROM clients c 
                   JOIN groups g 
        WHERE group_bits >'1' 
          AND c.group_bits=g.group_bits"; 
```

将 groups.name 列放在所有结果的前面。

我不确定您为什么要反引号，您可能需要再次添加这些内容。

# iphone - 在一个视图控制器中保存分数值并在另一个视图控制器上显示

> ID：13772080
> 
> 赞同：0
> 
> 时间：2012-12-07T22:32:42.613
> 
> 标签：iphone, objective-c, ios, xcode, ipad

我正在开发一款使用基本积分系统射击敌人的游戏，然后将该分数转换为硬币值以解锁游戏中的额外枪支。因此，当您玩游戏时，您的分数会上升，当您死亡时，屏幕会显示您的分数，以及您从该游戏中获得的硬币数量（目前分数 x 10）。

我正在寻找获得硬币价值的最佳方法，并将其显示在另一个屏幕上，即枪支选择屏幕上，在您第一次玩游戏时，从那时起，您从一次游戏中获得的硬币将添加到您拥有的总硬币中，枪选择画面上显示的数值。如果它很容易做到，一种加密硬币价值的方法。

这是我目前在玩游戏视图中使用 NSUserDefaults 的内容：

```
NSUserDefaults *coins = [NSUserDefaults standardUserDefaults];
    NSNumber *myCoins = [NSNumber numberWithInt:_killCount*9.4];
    _myCoinsInt = [myCoins integerValue];
    _totalCoinsInt = _myCoinsInt + _totalCoinsInt;
    [coins setObject:myCoins forKey:@"coins"];
    [coins synchronize];

    NSUserDefaults *totalCoins = [NSUserDefaults standardUserDefaults];
    NSNumber *theTotalCoins = [NSNumber numberWithInt:_totalCoinsInt];
    [totalCoins setObject:theTotalCoins forKey:@"totalCoins"];
    [totalCoins synchronize];
    NSLog(@"%@", theTotalCoins); 
```

在 Gun 选择屏幕中，在 viewDidLoad 方法下：

```
NSUserDefaults *totalCoins = [NSUserDefaults standardUserDefaults];
NSInteger _totalCoinsInt = [totalCoins objectForKey:@"totalCoins"];
NSString *intString = [NSString stringWithFormat:@"%d", _totalCoinsInt];
scoreField.text = intString; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T22:42:38.663

我认为最简单的方法是以`[NSUserDefaults standardUserDefaults]`任何一种方式存储硬币的数量，您可以按照提供的其他答案的方式进行操作，但是当您的应用程序关闭时您需要保存该数据。

我还会用你的服务器（如果你有的话）支持这个值，以跟踪不同的用户并保存这些值。如果您还没有 Web 服务，请查看 parse.com。

**例子**

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
//grab coins
int totalCoins = [defaults integerForKey:@"totalCoins"];

//add coins
totalCoins += coinsThisLevel;

//save
[defaults setInteger:totalCoins forKey:@"totalCoins"];
[defaults synchronize]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T22:40:04.447

您熟悉 MVC（模型-视图-控制器）设计模式吗？这就是你在这里所需要的。我会做一些事情，比如创建一个 Coins 类，在应用程序委托中创建它的一个实例，然后在各种视图控制器之间传递该实例。你可以在你的类中有添加更多硬币、保存硬币价值、必要时加密的方法。您可以使用 KVO（键值观察）来观察您的硬币实例以了解对 @property 的更改，以便感兴趣的各方可以执行诸如在硬币数量变化时更新其显示等操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T22:45:10.453

对于分数，我建议您将其保存为 NSUserDefault 并将其保存为标签。一些代码：

```
 //Saving
[[NSUserDefaults standardUserDefaults] setInteger:HighScore forKey:@"HighScore"];
    //Loading
    NSInteger highScore = [[NSUserDefaults standardUserDefaults] integerForKey:@"HighScore"]; 
```

查看文档：[https ://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)

# javascript - AngularJS 服务中的 JSDoc

> ID：13772084
> 
> 赞同：4
> 
> 时间：2012-12-07T22:33:07.500
> 
> 标签：javascript, angularjs, jsdoc

我正在创建一个 AngularJS 服务来验证表单输入，但我一生都无法弄清楚如何使用 JSDoc3 来创建合理的文档。

理想情况下，我需要导出验证器服务的文档以及每个验证器的文档（内部对象）

在谷歌搜索了一下之后，我能够通过使用命名空间来破解它，但我想知道是否有*正确*的方法来做到这一点。如果他们包含我的服务，则不会破坏其他人的 JSDoc 的方法。

例子：

```
angular.module('services.utility')
.factory('validator', [function () {
    var validators = {
        /**
         * Requires a field to have something in it.
         * @param  {String|Boolean} val    The value to be checked.
         * @return {Object}
         */
        'required': function(val){
            // check against validator
            return {'valid': true, 'msg': 'passed!'};
        },
        /**
         * Requires a field to be less than a number.
         * @param  {Number} val    The value to be checked.
         * @param  {Number} check  The value to be checked against.
         * @return {Object}
         */
        'lessThan': function(val){
            // check against validator
            return {'valid': true, 'msg': 'passed!'};
        }
    };
    return {
        /**
         * This is the main validation routine. 
         * @param  {Object} vObjs An object to be processed.
         * @return {Boolean}
         */
        'validate': function(thingsToValidate){
            // run some validations from the validators
                    // and return a bool.
        }
    };
}]); 
```

在一个完美的世界里，对上面的修改可以让我生成一个很好的、非全局的 JSDoc 层次结构，用户可以在其中阅读有关如何使用整个验证器的信息，或者深入了解每个需要传递的内容验证类型。

非常感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T01:56:40.660

我的团队的工作方式是我们实际上只记录实际的工厂功能，就好像用户要阅读它一样。你实际上已经跳过了那个人。无论哪种方式，您都可以将其视为文档的入口点，并将其与您的“方法”文档结合起来以获得完整的图片。您可以结合使用@namespace 文档。

```
/** Here is how you use my factory. @param @return */
my.validator.factory = function() { return { validate: function(){} }; }
/** Here are some validators. @enum {Function(*):ValidationResult} **/
my.validator.Validators = {}

module.factory('validator', my.validator.factory); 
```

根据您*真正*想要的，您可能更喜欢使用原型。这就是文档真正大放异彩的地方：

```
/** Here is how you use my factory. @param @return @constructor */
my.Validator = function() {}
/** My validation function. @param @return */
my.Validator.prototype.validate = function() {}
/** Here are some validators. @enum {Function(*):ValidationResult} **/
my.Validator.Validators = {}

module.service('validator', my.Validator); 
```

将原型与您的文档一起使用对我来说真的很重要。这就像将您的验证器记录为一个类实体，这对我来说最有意义。

# c# - OpenText DokuStar 采集中心提取增强

> ID：13772088
> 
> 赞同：0
> 
> 时间：2012-12-07T22:33:38.220
> 
> 标签：c#, extraction, image-capture, opentext

由于 OpenText Capture Center 内几乎没有关于编程的文档或代码片段。我需要有经验的人提供一些意见。

这里是我需要的关键... 在脚本管理器中，我需要能够访问 OCR 在文档中识别的所有 Phrase 对象，无论在提取过程中匹配或识别的字段如何。

只要我可以访问 OCR 短语，我就可以做两件事，这将大大提高我们在任何领域的匹配率。

1.  在匹配发生之前执行发票短语的清理和转换作为一种预处理（IE将公司变成CORP，删除撇号等）
2.  编写一个比原生 Generic SnapMatch 更了解我们数据的自定义匹配函数。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:33:29.967

好的，最终没有办法通过脚本管理器入口点来做到这一点。这样做的原因是所有图像数据在进入脚本管理器之前都被解析和提取。当您进入管理器的提取阶段时，您有一个 XML 运行时文档，该文档表示输出文档的元结构，其中包含在输入之前提取“认为可能有用”的数据。提取的所有其他可能的“短语”和其他不适合字段或替代的数据类型都被“丢弃”。这意味着供应商名称或 DoKuStar 不感兴趣的类似名称，仍然无法使用任何代码机制进行搜索。

我需要解决的问题非常具体到我的特定域，并且是由 Oracle 组的策略间接引起的。供应商的名称被去除特殊字符并连接起来。基本上，它们只是与发票上的内容不符，因此 snapmatch 几乎毫无用处。

我创建了一个中间解决方案，用户可以直接更新本地 SnapMatch 数据库，可以说是“重命名供应商”。因此，我们的本地 SnapMatch 数据库将在我们进行更正时匹配发票上的内容，即使 Oracle 数据库不匹配。总而言之，不是针对编码方面的特定解决方案，但事实证明它是解决域问题的有效解决方案。

# mysql - 选择第一列不匹配任何其他行的行

> ID：13772095
> 
> 赞同：1
> 
> 时间：2012-12-07T22:34:06.177
> 
> 标签：mysql, sql

我需要选择没有第一列匹配的行。例如，从下面的数据；

```
Person            | Room
---------------------------------------
ben               | 1
jake              | 3
jake              | 1
steven            | 2
james             | 1
james             | 2
james             | 3 
```

该查询将只返回这些行：

```
Person            | Room
---------------------------------------
ben               | 1
jake              | 3
steven            | 2
james             | 1 
```

房间列返回什么值并不重要。它需要能够处理越来越多的房间号和不同的名称。

我没有寻找答案，也不知道该怎么做，但这可能是我目前的心态，而且可能真的很容易做到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:35:24.717

```
SELECT Person, MIN(Room) AS Room
FROM YourTable
GROUP BY Person 
```

而如果你能保证[`ONLY_FULL_GROUP_BY`](http://dev.mysql.com/doc/refman/5.1/en/server-sql-mode.html#sqlmode_only_full_group_by)设置会一直关闭，那么在MySql中也可以做到以下几点：

```
SELECT Person, Room
FROM YourTable
GROUP BY Person 
```

但是为了安全起见，我会使用该`MIN()`功能...

# c# - 如何更改 radgridview 中的列类型

> ID：13772098
> 
> 赞同：0
> 
> 时间：2012-12-07T22:34:16.990
> 
> 标签：c#, winforms, telerik

我的意思是 - 我使用 RadMaskedEditBox 将数据写入数据库。但是我使用从`Add new data source`表适配器生成的数据库加载数据。所以来自 maskededitbox 的数据在第 5 列（我有 7 列）。我需要一个 GridViewMaskBoxColumn。但是新列只能作为最后一列添加。所以我从datagrid中删除列（包含来自radmaskededitbox的数据），将其数据复制到gridviewmaskboxcolumn并将其添加到datagrid。但是当我调用更新方法时 - 新列中的所有数据都消失了。

如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T07:57:35.567

您应该删除自动生成的列，并将新的 GridViewMaskBoxColumn 添加到所需位置。您可以使用 Columns 集合的 Insert 方法将列插入到所需位置。

为了显示来自数据库的数据，请确保指定正确的 GridViewMaskBoxColumn 的 FieldName，指向数据表中的字段。

这是一个示例：

```
radGridView1.Columns.Remove(radGridView1.Columns["theDefaultColumnName"]);
GridViewMaskBoxColumn maskCol = new GridViewMaskBoxColumn();
maskCol.FieldName = "dataTableFieldName";
radGridView1.Columns.Insert(4, maskCol); 
```

# javascript - 未捕获的 SyntaxError：意外的标识符

> ID：13772102
> 
> 赞同：1
> 
> 时间：2012-12-07T22:34:43.360
> 
> 标签：javascript, syntax-error

我收到一个语法错误：第 22 行的意外标识符。我一遍又一遍地重复这段代码，但我终其一生都无法弄清楚出了什么问题。这是确定从一个节点到另一个节点的最短路径的代码。

```
"use strict"
function findpath(G,si,di){
    //G is an array of nodes (with id, lat, lon)
    var cvi = si;
    var P=[si];
    var C=[0,P];
    var M=[C];
    var O=[];
    var ctr=0;
    var done = false;
    var reached = false;
    var best = undefined;

    while(!done){
        ctr++;
        if( ctr > 100 ){
            alert("Sorry, can't find the destination.");
            return P;
        }

        for (int i=0;i<M.length;++i){
            var last = M[i[1]].length;
            var v = M[i[1[last]]];

            //select a random neighbor...
            if( v.N.length === 0 ){
                alert("Wat?");
                return [];
            }
            else if( v.N.length === 1 ){
                break;
            }
            else if( v === di ){
                break;
            }
            else {
                for (int j=0;j<v.N.length;++j){
                    var temp = M[i];
                    O.push(temp[1].push(v.N[j]));
                    var dist = distance(v.lat,v.lon,v.N[j].lat,v.N[j].lon);
                    var temp2 = O.length-1;
                    O[temp2[0]]+=dist;
                    if (v.N[j]===di){
                        reached = true;
                        if (best === undefined){
                            console.log("ASSIGN");
                            best = O[temp2];
                        }
                        else {
                            if (O[temp2[0]]<best[0]) {
                                best = O[temp2];
                            }
                        }
                    }
                }
            }
        }
        M = O;
        var any = false;
        for (int i=0;i<M.length;++i) {
            if (M[i[0]]<best[0]) {
                any = true;
            }
        }
        if (!any) {
            done = true;
        }
    }

    //return the path
    return best[1];
}

function distance(x1,y1,x2,y2){
    return Math.sqrt(Math.pow((x2-x1),2)+Math.pow((y2-y1),2));
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T22:36:41.410

这：

```
 for (int i=0;i<M.length;++i){ 
```

不应该`int`。应该是`var`。

```
 for (var i=0;i<M.length;++i){ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T22:36:39.460

你有`for (int i=0;i<M.length;++i){`.

`int`是一个标识符，但不是 JavaScript 的一部分。

你可能的意思是`var`。

# google-app-engine - Google App Engine (GAE) - 如何控制由 JPA 加载并通过 JAX-RS 公开的对象图的深度？

> ID：13772116
> 
> 赞同：2
> 
> 时间：2012-12-07T22:36:00.027
> 
> 标签：google-app-engine, jpa, jaxb, jax-rs, google-cloud-sql

我很想通过 JPA 使用 GAE SQL 云，但如果出现问题，我将退回到使用 JPA 的数据存储。

我可以预见，如果我的域对象被注释为实体 A 拥有实体 B，然后实体 B 与实体 C、D 和 E 有关系，那么除非延迟加载，否则向 JPA 询问实体 A 可以加载实体 B 到 E。

因为我打算使用 JAX-RS，所以当 JAXB 编组器启动时，这不会导致延迟加载来水合整个对象图吗？

控制暴露内容的最佳做法是什么？

我目前正在考虑编写一个 DAO 层，明确表示“获取所有用户，但不获取他们的孩子”，或“获取所有具有登录历史记录的用户”。我是否可以使用 JPA / JAX-RS 进行这种级别的控制，或者我最好使用 SQL 查询和 JDBC 来编写它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T10:43:32.650

是的，当您将 A 实体提交给 JAXB 时，它将检查其关系，这将加载实体 B、C 和 E。

为了防止这种情况，您可以用 注释关系`@XmlTransient`，它们将不会被导航。

# javascript - JQuery .toggleClass() 一次两个类？

> ID：13772120
> 
> 赞同：1
> 
> 时间：2012-12-07T22:36:25.027
> 
> 标签：javascript, jquery, html, css

```
$('.button').click(function(){
     $(this).toggleClass('clicked')
     $('.clicked+span').toggleClass('choice');
}); 
```

我刚刚开始学习 jQuery，并且正在使用一些方法。因此，当单击带有类的链接时`.button`，`toggleClass`会同时添加两个类，但是当我再次单击它时，只会将`.clicked`其删除。`.choice`不管我怎么想，课程仍然存在。有人可以解释一下我在这里缺少什么，可能是如何实现这一点 - 在每次点击时切换两个类？

**编辑**

抱歉，这是[***代码***](http://jsfiddle.net/96GZB/) 我想要实现的事情是，例如，当您单击“a)”时，相应的行会以某种方式突出显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:39:55.333

第二次单击您的按钮..

```
$('.clicked+span').toggleClass('choice'); 
```

找不到您的元素，因为 .clicked 类刚刚被删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T22:44:56.550

如果您尝试一次添加/删除两个类，请执行以下操作：

```
$('.button').click(function(){
     $(this).toggleClass('clicked choice');

}); 
```

[http://jsfiddle.net/cAcJX/](http://jsfiddle.net/cAcJX/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T23:19:11.030

如果您尝试实施单选题，则需要以下内容：

```
$('.button').click(function(){
                var $this = $(this),
                    wasClicked = $this.hasClass("clicked");

                //remove another selected if any
                $('.clicked').removeClass('clicked')
                             .next().removeClass('choice');
                //mark current as selected if it wasn't
                !wasClicked && $this.addClass("clicked")
                                    .next().addClass('choice');
            }); 
```

[http://jsfiddle.net/tarabyte/96GZB/1/](http://jsfiddle.net/tarabyte/96GZB/1/)

对于多项选择题：

```
$('.button').click(function(){
                $(this).toggleClass('clicked')
                       .next().toggleClass('choice');
            }); 
```

[http://jsfiddle.net/tarabyte/96GZB/2/](http://jsfiddle.net/tarabyte/96GZB/2/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T23:23:06.230

啊，看到代码就更清楚了。

```
 $('.button').click(function(){
        $(this).toggleClass('clicked');
        $(this).next('span').toggleClass('choice');
    }); 
```

[http://jsfiddle.net/96GZB/3/](http://jsfiddle.net/96GZB/3/)

我认为您最好将跨度设置为 .button 的子项，这样您就可以在样式表中设置类似这样的内容；

```
.clicked span {
background: blue;
} 
```

然后你可以完全取消 .choice 类。

# c# - 模块化程序有问题。只运行一行（没有错误消息.____。）

> ID：13772121
> 
> 赞同：0
> 
> 时间：2012-12-07T22:36:24.670
> 
> 标签：c#, debugging, module

我正在开发一个计算应付所得税的模块化程序。在我看来这是有道理的，但我的程序只运行一行代码，然后就停止了……没有错误消息，什么也没有。我感觉这与我的 CalculateTaxDue 类中的 while 循环有关

程序必须： a) 从用户那里获得有效输入（在一个类中） b) 计算应纳税额（在另一个类中） c) 显示用户输入的应纳税所得额，按照统一税率缴纳应纳税额，根据可变百分比的应缴税款和应缴税款总额（在另一类中）

到目前为止，这是我的程序。我觉得它应该运行正常，但它没有。

```
class Program
{
    static void Main(string[] args)
    {
        // declare variables
        double taxableIncome, incomeTaxDue, flatRate, variablePercentage;

        // get user input
        taxableIncome = GetTaxableInput.GetDouble("Please enter your total income: ");

        // calculate tax due
        incomeTaxDue = CalculateTaxDue.GetTaxableIncome(taxableIncome);

        // display taxable income
        DisplayTaxRate.DisplayTaxableIncome("Your total income is: ", taxableIncome);

        // display flat rate
        flatRate = CalculateTaxDue.GetFlatRate(taxableIncome);
        DisplayTaxRate.DisplayFlatRate("Your tax rate is: ", flatRate);

        // display variable percentage
        variablePercentage = CalculateTaxDue.GetVariablePercentage(taxableIncome);
        DisplayTaxRate.DisplayVariablePercentage("Your variable percentage is: ", variablePercentage);

        // display total tax due
        DisplayTaxRate.DisplayTotalTaxDue("Your total income tax due is: ", incomeTaxDue);

        // keep console open
        Console.ReadLine();
    }
}

class GetTaxableInput
{
    public static double GetDouble(string message)
    {
        // declare variable
        double result;
        // ask for input
        Console.Write(message);
        // capture and validate the user input
        while (!double.TryParse(Console.ReadLine(), out result))
        {
            Console.WriteLine("Invalid input ");
            Console.Write(message);
        };
        return result;
    }
}

class CalculateTaxDue
{
    public static double GetTaxableIncome(double taxableIncome)
    {
        double incomeTaxDue;
        double flatRate;
        double variablePercentage;

        // calculate and return total income tax due.
        while (!double.TryParse(Console.ReadLine(), out incomeTaxDue))
        {

            if (taxableIncome < 0)
            {
                flatRate = 0;
                variablePercentage = 0;
                incomeTaxDue = taxableIncome * variablePercentage + flatRate;
            }
            else if (taxableIncome < 49999)
            {
                variablePercentage = 0.05;
                flatRate = 0;
                incomeTaxDue = taxableIncome * variablePercentage + flatRate;
            }
            else if (taxableIncome < 99999)
            {
                variablePercentage = 0.07;
                flatRate = 2500;
                incomeTaxDue = taxableIncome * variablePercentage + flatRate;
            }
            else if (taxableIncome > 100000)
            {
                variablePercentage = 0.09;
                flatRate = 6000;
                incomeTaxDue = taxableIncome * variablePercentage + flatRate;
            }
        }
        return incomeTaxDue;
    }

    // calculate and return the tax rate
    public static double GetFlatRate(double taxableIncome)
    {
        double incomeTaxDue;
        double flatRate;
        double variablePercentage;

        while (!double.TryParse(Console.ReadLine(), out flatRate))
        {

            if (taxableIncome < 0)
            {
                flatRate = 0;
                variablePercentage = 0;
                incomeTaxDue = taxableIncome * variablePercentage + flatRate;
            }
            else if (taxableIncome < 49999)
            {
                variablePercentage = 0.05;
                flatRate = 0;
                incomeTaxDue = taxableIncome * variablePercentage + flatRate;
            }
            else if (taxableIncome < 99999)
            {
                variablePercentage = 0.07;
                flatRate = 2500;
                incomeTaxDue = taxableIncome * variablePercentage + flatRate;
            }
            else if (taxableIncome > 100000)
            {
                variablePercentage = 0.09;
                flatRate = 6000;
                incomeTaxDue = taxableIncome * variablePercentage + flatRate;
            }
        }
        return flatRate;
    }

    // calculate and return the variable percentage ( tax rate )
    public static double GetVariablePercentage(double taxableIncome)
    {
        double incomeTaxDue;
        double flatRate;
        double variablePercentage;

        while (!double.TryParse(Console.ReadLine(), out variablePercentage))
        {

            if (taxableIncome < 0)
            {
                flatRate = 0;
                variablePercentage = 0;
                incomeTaxDue = taxableIncome * variablePercentage + flatRate;
            }
            else if (taxableIncome < 49999)
            {
                variablePercentage = 0.05;
                flatRate = 0;
                incomeTaxDue = taxableIncome * variablePercentage + flatRate;
            }
            else if (taxableIncome < 99999)
            {
                variablePercentage = 0.07;
                flatRate = 2500;
                incomeTaxDue = taxableIncome * variablePercentage + flatRate;
            }
            else if (taxableIncome > 100000)
            {
                variablePercentage = 0.09;
                flatRate = 6000;
                incomeTaxDue = taxableIncome * variablePercentage + flatRate;
            }
        }
        return variablePercentage;
    }
}

class DisplayTaxRate
{
    public static void DisplayTaxableIncome(string message, double numberValue)
    {
        Console.WriteLine("{0} {1:c}", message, numberValue);
    }
    public static void DisplayFlatRate(string message, double numberValue)
    {
        Console.WriteLine("{0} {1:c}", message, numberValue);
    }
    public static void DisplayVariablePercentage(string message, double numberValue)
    {
        Console.WriteLine("{0} {1:P}", message, numberValue);
    }
    public static void DisplayTotalTaxDue(string message, double numberValue)
    {
        Console.WriteLine("{0} {1:c}", message, numberValue);
    }
} 
```

它在那里。就像我之前说的，我没有收到任何错误消息，所以我不知道从哪里开始。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:47:24.887

我想到了。出于某种原因，我有一个 while 循环来获取我的计算类的输入：/ 感谢 Chris Dunaway！现在就像一个魅力。

# java - 如何在 Java 中解析这个输出文件

> ID：13772128
> 
> 赞同：-3
> 
> 时间：2012-12-07T22:36:51.220
> 
> 标签：java, file, parsing, testing, output

我从文本文件中输出以下内容：

================================================

```
guideMenuSuite.mts:
[monkeytalk:run] MonkeyTalk v1.0.11.beta5c_473 - 2012-07-18 11:38:51 MDT - Copyright 2012 Gorilla Logic, Inc. - www.gorillalogic.com
[monkeytalk:run] running suite guideMenuSuite.mts...
[monkeytalk:run] BCOKAS127271: -start suite (1 test)
[monkeytalk:run] BCOKAS127271:   1 : guide_menu.mt
[monkeytalk:run] BCOKAS127271:   -> OK
[monkeytalk:run] BCOKAS127271: -end suite
[monkeytalk:run] result: OK
[monkeytalk:run] ...done 
```

=================================================

在 Java 中，我需要： 1）解析设备序列号的输出（在这种情况下为 BCOKAS127271 ......它会根据正在测试的设备而变化）。2) 获取->（本例中为-> OK）之后的测试状态结果。

我尝试使用拆分，但数据一直为空...

任何建议将不胜感激。

这是我的代码：

代码

```
while ((strLine = br.readLine()) != null) 
                {
                    maintextarea.append(strLine + "\n");
                    System.out.println(strLine);
                    System.out.flush();
                    maintextarea.append(selectedSerial);
                    delims = "[ \\->]+";
                    //String[] tokens = strLine.split(delims);
                    //String[] tokens = strLine.substring(prefix.length()).split(delims);

                    String noprefixStr = strLine.substring(strLine.indexOf(prefix) + prefix.length());
                    String[] tokens = noprefixStr.split(delims);

                    //for (String t: tokens)
                    {
                        //System.out.println(t);

                            if (tokens.toString().contains("ERROR"))
                            {
                                testStatus = "ERROR";
                                maintextarea.append("\n" + selectedValue + " " + selectedSerial + " = " + testStatus + "\n");
                                System.out.println(selectedValue + " " + selectedSerial + " = " + testStatus);
                                System.out.flush();
                            }

                            else if (tokens.toString().contains("FAILURE"))
                            {
                                testStatus = "FAILED";
                                maintextarea.append("\n" + selectedValue + " " + selectedSerial + " = " + testStatus + "\n");
                                System.out.println(selectedValue + " " + selectedSerial + " = " + testStatus);
                                System.out.flush();
                            }

                            else if (tokens.toString().contains("OK"))
                            {
                                testStatus = "PASSED";
                                maintextarea.append("\n" + selectedValue + " " + selectedSerial + " = " + testStatus + "\n");
                                System.out.println(selectedValue + " " + selectedSerial + " = " + testStatus);
                                System.out.flush();
                            }

                            else
                            {
                                testStatus = "N/A";
                                maintextarea.append("\n" + selectedValue + " " + selectedSerial + " = " + testStatus + "\n");
                                System.out.println(selectedValue + " " + selectedSerial + " = " + testStatus);
                                System.out.flush();
                            }

                    }

                }

                br.close(); 
```

==================================================== ==========

更新：

我根据从这个小组收到的所有意见找到了我的解决方案！我最终使它变得非常简单并解析输出文件以获取表达式，然后基于该设置一个变量来传递或失败或错误。

这是我使用的基本代码：

```
try 
        {
            BufferedReader br = new BufferedReader(new InputStreamReader(new DataInputStream(new FileInputStream("/home/ironmantis7x/Documents/TWC_test/MT_test_runner_output.txt"))));
            String strLine;
            while ((strLine = br.readLine()) != null)
            {
                if (strLine.contains("-> OK"))
                {
                    testStatus = "Pass";
                    System.out.println("Test Result = " + testStatus);
                }

            }
        } 

        catch (FileNotFoundException ex) 
        {
            Logger.getLogger(parseFile.class.getName()).log(Level.SEVERE, null, ex);
        } 
```

对不起，我花了这么长时间才回复你们并说谢谢！

铁螳螂7x

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T22:54:04.480

您可以使用正则表达式：

```
import java.util.Pattern
import java.util.Matcher

Pattern status = Pattern.compile("\\[.*] \\w+:\\s+-> (\w+).*");

... 
```

[你可以在这里](http://docs.oracle.com/javase/tutorial/essential/regex/index.html)学习如何做

# javascript - Javascript 在 Internet Explorer 中的行为很有趣

> ID：13772129
> 
> 赞同：1
> 
> 时间：2012-12-07T22:37:01.070
> 
> 标签：javascript, url, redirect

我有一个网站，我希望人们能够在文本框中输入内容并根据他们输入的内容发送到该目录。

说客户编号，所以我们有客户＃155。他的发票在文件夹`/invoices/155`目录中。我希望他能够输入他的客户 # 并通过单击按钮定向到包含他所有发票的目录。

现在我已经编写了以下代码，但它仅在我用鼠标单击按钮时才有效。在 Internet Explorer 中，当我按下回车键时，它在地址栏中给了我一堆 gook，但什么也没做。在地址栏中看起来像这样：

`file:///C:/Users/My%20Name/Desktop/test.html?dir=%2Finvoices%2F&userinput=155`

而不是加载文件夹`/invoices/155/`。

```
<html>
<head>
<title>test</title>
</head>
<form name="goto" action="">
<input name="dir" type="hidden" value="/invoices/">
<input name="userinput" type="text"> <input type="button" value="try me" onclick="window.location=this.form.dir.value+userinput.value">

</form> 
```

谁能告诉我代码有什么问题以及我能做些什么来修复它？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:42:41.720

在某些浏览器中，即使没有提交按钮，当您按下回车时表单也会被发布。使用提交按钮，并抓住提交，然后你处理所有情况：

```
<form name="goto" action="" onsubmit="window.location=this.dir.value+this.userinput.value;return false;">
<input name="dir" type="hidden" value="/invoices/">
<input name="userinput" type="text"> <input type="submit" value="try me">
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T22:40:36.777

如果您使用文件协议，它将无法正常工作。尤其是在 IE 中。你需要一个真正的网络服务器。

让客户输入他的身份证是**非常** 不安全的。任何人都可以输入任何 id。使用登录。

清理**每个**用户输入以防止滥用是**非常重要的。**

 **这是一条很长的路要走。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T22:41:15.210

我认为你应该`onsubmit`继续`<form>`

```
<!DOCTYPE html>
<html>
<head>
    <title>test</title>
    <script>
        function handleFormSubmit(form)
        {
            window.location = form.dir.value + form.userinput.value;
            return false;
        }
    </script>
</head>
<body>
    <form onsubmit="return handleFormSubmit(this)">
            <input name="dir" type="hidden" value="/invoices/">
            <input name="userinput" type="text">
            <input type="submit" value="try me" >    
    </form>
</body>
</html>​​​​​​​ 
```

顺便说一句：
内联 javascript 不是很好。使用脚本标签或外部 .js 文件。

**编辑：**
哎呀！好的，错误是我写的`this.form.dir`，但它必须是`this.dir`因为`this`已经引用了表单，现在 javascript 处理程序位于`form`标记 ( `onsubmit="<handler-code>"`) 上。这有效 - [http://jsfiddle.net/Q875a/](http://jsfiddle.net/Q875a/)

**编辑2：**
**内联javascript**意味着您在属性中的html标签（，，**...**`form`）`input`中**编写**javascript代码-它**不可读**。将您的脚本放在处理函数（即）内的标记中使其更具可读性，特别是如果您的站点在其中包含越来越多的脚本 - 请参阅当前脚本和-attribute。`onXXX` ****`script``handleFormSubmit``onsubmit`****

 ****最后，如果你想更进一步**跨浏览器、强大的 javascript 开发**，你应该看看[**jQuery——**](http://www.jquery.com/)它是真正**专业和退出 javascript 编程**的大门！

JSFiddle 测试：http:
[//jsfiddle.net/yNTK5/](http://jsfiddle.net/yNTK5/)

有关该主题的 jQuery 链接：http: [//api.jquery.com/submit/](http://api.jquery.com/ready/)
[http://api.jquery.com/on/](http://api.jquery.com/submit/)
[http://api.jquery.com/ready/](http://api.jquery.com/on/)******

# java - 如何调用作为 jar 依赖项添加到另一个 Maven 项目的axis2 Web 服务项目？

> ID：13772133
> 
> 赞同：6
> 
> 时间：2012-12-07T22:37:12.910
> 
> 标签：java, maven, axis2, web.xml

我将`Axis2`Web 服务创建为 maven 项目`ProjectB`并将其打包为 jar。我将此`ProjectB`jar 作为依赖项添加到 pom.xml 中的另一个 maven 项目`ProjectA`。

我的 jar 文件`ProjectB`作为依赖项添加到`ProjectA` `pom.xml`.

```
<dependency>
    <groupId>axis2</groupId>
    <artifactId>Axis2WebService</artifactId>
    <version>0.1</version>
</dependency> 
```

在我添加到另一个项目的 Web 服务 jar 中不包含`Webcontent`文件夹。所以，我担心的是

1.  如何调用我在 jar 中的 web 服务`ProjectA`？

2.  为了找到我`web.xml`的网络服务，我需要添加任何东西吗？`ProjectA`

3.  如何在浏览器中访问我的网络服务（即`http://localserver:port/ProjectA/Myservice`）。这是访问我的网络服务的正确方法吗？

4.  我是否需要在`projectA`pom.xml 或`ProjectA`web.xml 中的 Axis 2 servlets 映射中再次指定所有axis2相关的jar？

我为此震惊了一天。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T14:58:35.487

我假设您正在调用您的 Web 服务项目 B，以及您的 Web 服务客户端项目 A。如果是这样的话，那么你有一点困惑。您需要在应用程序服务器中部署您的Web 服务（projectB）（即作为tomcat 服务器中的war 或jboss 或weblogic 中的ear 等）。然后，您需要使用“Maven2 WSDL2Code Plug-in”生成您的客户端存根，并将该客户端用作您的 projectA 中的依赖项。此 proyectA 将使用生成的依赖项中的存根来访问您的 Web 服务。抱歉，我无法格式化此答案，我开始使用阻止所有 java 脚本的代理（我什至无法发表评论）...

# c# - 使用单元测试和测试数据库

> ID：13772134
> 
> 赞同：5
> 
> 时间：2012-12-07T22:37:37.810
> 
> 标签：c#, unit-testing, .net-3.5, nunit, database-testing

我将如何使用 NUnit 和测试数据库来验证我的代码？理论上我会使用模拟（moq），但我的代码更多的是维护形状并修复它模式，我没有设置所有模拟的权限。

我是否只是创建一个测试项目，然后编写实际连接到我的测试数据库的测试并像在应用程序中那样执行代码？然后我用断言检查代码并确保我请求的是我正确返回的内容？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T22:51:31.877

> 我将如何使用 NUnit 和测试数据库来验证我的代码？理论上我会使用模拟（moq），但我的代码更多的是维护形状并修复它模式，我没有设置所有模拟的权限。

仅当您想测试类的确切实现行为时，使用模拟才有用。这意味着您实际上是在断言一个类调用另一个类的特定方法。例如：我想断言 Ninja.Attack() 调用了 Sword.Unsheath()。

> 我是否只是创建一个测试项目，然后编写实际连接到我的测试数据库的测试并像在应用程序中那样执行代码？然后我用断言检查代码并确保我请求的是我正确返回的内容？

这只是一个普通的旧单元测试。如果实现这一目标没有障碍，那就是一个很好的指标，表明这将是您最有效的测试方法。它实用且高效。

您没有提到另一种测试工具，称为存根。我强烈建议您阅读这篇经典文章以获取更多信息：

[http://martinfowler.com/articles/mocksArentStubs.html](http://martinfowler.com/articles/mocksArentStubs.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T22:58:58.007

由于我们不是在谈论理论案例，这就是我要做的 - 根据我的理解，您想要测试的是您的应用程序是否正确连接到数据库并获取所需的数据。

1.  创建具有相同架构的测试数据库
2.  在其中添加一些虚拟数据
3.  从代码打开到数据库的连接，请求所需的数据
4.  编写断言以测试您从数据库中获得的内容与您的预期是否相符

另外，我认为这些测试不应该被称为单元测试，因为它们不是自包含的，并且取决于其他因素，例如您的数据库是否启动和运行。我会说它们接近于集成测试，它将测试应用程序的不同组件在一起使用时是否按预期工作。

（丹的回答^^几乎概括了我想说的）

# delphi - 从 Delphi 应用程序发送 WM_COPY。到 Windows 7 中的另一个进程

> ID：13772136
> 
> 赞同：1
> 
> 时间：2012-12-07T22:37:40.230
> 
> 标签：delphi, windows-7, manifest, uac, sendinput

我有一个 Delphi (BDS 2006) 应用程序，它将击键发送到 QuickBooks 会计软件以遍历 QuickBooks 表单（发票），将文本从当前编辑控件复制到 Windows 剪贴板（以收集数据），根据收集的数据进行一些计算，最后通过发送击键将结果写在表单上。

这个应用程序已经开发了很多年，使用广泛的（至少对我而言）Windows API 技术来识别前景窗口、焦点窗口等，并被全球数十个用户使用......我只告诉你作为它在许多系统上工作的证据。

但不是所有的。最近我收到很多关于 Windows 7 系统的故障报告（QuickBooks 的版本似乎无关紧要）。发送给报告问题的客户的调试版本表明它没有将任何内容复制到剪贴板——尽管它似乎仍然能够执行其他所有操作（发送击键以遍历表单，并击键以粘贴计算结果...不幸的是，现在总是为零，因为没有收集到数据。）

这是我用来向 QuickBooks 中的编辑控制窗口发送 WM_COPY 消息的代码。（在 XP 或 Windows 7 系统上，我们不能让此代码在此处失败 - 但它不适用于多个用户。）

```
var
  iResult : DWORD;
begin
  ...
      //Edit control has the focus on the QB form, so try to copy its contents
  if SendMessageTimeout(Wnd, WM_COPY, 0, 0,
      SMTO_ABORTIFHUNG or SMTO_NORMAL,
      2000,
      iResult) = 0 then begin                 //0 = Failed or timed out

        //NOTE:  Users DO NOT get the following message--the 
        //SendMessageTimeout() simply returns without error, as if the 
        //WM_COPY is being sent correctly.

    ShowMessage('SendMessageTimeout FAILED');
    Abort;    
  end;

            //At this point, the clipboard has nothing on it, on users'
            //machines where it fails to work.
  ...   
end; 
```

不想消耗我们向其发送调试版本的最终用户的耐心，我正在寻找想法，然后再发送任何其他内容供他们尝试/测试......

**注释/问题：**

*   所有其他击键都是通过 SendInput 发送的，它们工作正常。我相信我们出于速度原因开始使用 SendMessageTimeout(WM_COPY) 而不是发送 Ctrl-C 作为击键 - 它允许我们在返回时立即访问剪贴板，而不是等待 Ctrl-C 的未知/无限时间由 QuickBooks 处理。

*   我相信我们已经要求用户在我们的应用程序上尝试 RunAs...Administrator，但这没有任何效果（我必须验证是否已完成）。

*   我想知道问题是否可能是由于 UAC 冲突引起的？我们的应用程序目前没有数字签名，也没有使用清单。我一直在阅读有关在其中添加带有 UIAccess=True 的清单的信息。但是，如果我们的应用程序已经可以毫无问题地向 QuickBooks 发送击键，那么设置 UIAccess=True 对允许 SendMessageTimeout() 成功有什么影响吗？我需要使用数字证书吗？让 UIAccess 设置有什么效果？

*   如果在清单中没有数字签名和 UIAccess 的情况下 SendMessage 将无法工作，我们是否可以退回到发送 Ctrl-C 作为击键？（我不这么认为；微软肯定不会允许围绕安全概念进行最终运行。）

我很感激任何评论以理清我的想法......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T22:44:16.850

这可能与“用户界面特权隔离”(UIPI) 而不是 UAC 有关。检查每个进程的完整性级别。不允许低完整性进程向高完整性进程发送窗口消息，除非高完整性进程通过调用明确允许它`ChangeWindowMessageFilter/Ex()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T08:54:00.410

你能检查这个系统的 Internet Explorer Skype 插件吗（IE-选项-程序-附加组件）。这个插件有一个错误版本，会在剪贴板上弄乱数据。如果安装了此插件，请删除并测试。

# xcode - Xcode - 过滤 NSFetchRequest 并选择每个对象

> ID：13772137
> 
> 赞同：0
> 
> 时间：2012-12-07T22:37:54.610
> 
> 标签：xcode, ios6, nsfetchrequest

我正在尝试过滤 fetchRequest。

我正在将结果加载到 NSArray 中。

但是，我需要解析数组以提取单个项目 - 现在，它们看起来好像是一个对象。

我用来达到这一点的代码是：

```
NSFetchRequest *request = [[NSFetchRequest alloc] init];
NSManagedObjectContext *moc = coreDataController.mainThreadContext;
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Category" inManagedObjectContext:moc];

[request setEntity:entity];

    // Order the events by name.
    NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"name" ascending:YES];

    [request setSortDescriptors:@[sortDescriptor]];

    // Execute the fetch -- create a mutable copy of the result.
    NSError *error = nil;
    NSArray *categories = [[moc executeFetchRequest:request error:&error] mutableCopy];

    if (categories == nil) {
        NSLog(@"bugger");
    }

    NSObject *value = nil;
    value = [categories valueForKeyPath:@"name"]; 
```

结果如下：

```
 value = (
)

[DetailViewController loadPickerArray]
[AppDelegate loadPickerArray]
 value = (
    "Cat Two",
    "Cat Three",
    "Cat One",
    "Cat Four"
) 
```

另外，请注意，第一次运行时，没有结果。我大约有 50% 的时间能做到这一点。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T03:00:32.620

有几种方法可以过滤数据。

首选方法是使用谓词进行搜索。这将为您提供最佳性能。

```
NSFetchRequest *request = [[NSFetchRequest alloc] init];
NSManagedObjectContext *moc = coreDataController.mainThreadContext;
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Category" inManagedObjectContext:moc];

[request setEntity:entity];

// Order the events by name.
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"name" ascending:YES];
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name CONTAINS[CD] %@", @"Cat"]; //This will return all objects that contain 'cat' in their name property.

[request setPredicate:predicate];
[request setSortDescriptors:@[sortDescriptor]];

// Execute the fetch -- create a mutable copy of the result.
NSError *error = nil;
NSArray *categories = [moc executeFetchRequest:request error:&error];

if (categories == nil) {
    NSLog(@"bugger");
}

//Here you have the objects you want in categories.

for(Category *category in categories)
{
    NSLog(@"Category name: %@", category.name);
} 
```

如果您希望使用数组进行过滤，也可以执行以下操作：

```
NSMutableArray *categories = [[moc executeFetchRequest:request error:&error] mutableCopy];

[categories filterUsingPredicate:[NSPredicate predicateWithFormat:[NSPredicate predicateWithFormat:@"name CONTAINS[CD] %@", @"Cat"]]

//Now, the only objects left in categories will be the ones with "cat" in their name property. 
```

我推荐阅读[Predicates Programming Guide](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/Predicates/Articles/pCreating.html)，因为 predicates 非常强大，而且在 store 中过滤你的结果更有效。

# android - Android：从 sd 卡读取任何特定图像并将其显示为位图

> ID：13772138
> 
> 赞同：2
> 
> 时间：2012-12-07T22:38:01.040
> 
> 标签：android, mediastore

我已经检索了保存在模拟器 SD 卡上的媒体中的第一张图像的名称。现在我想显示与之对应的图像..我该怎么做？

这是代码

```
import android.app.Activity;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.util.Log;
import android.widget.ImageView;
import android.widget.TextView;

public class ClientActivity extends Activity {

ImageView imageView;
TextView textView;

 /** Called when the activity is first created. */
 @Override
 public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.activity_client);

  imageView = (ImageView) findViewById(R.id.imageView1);
  textView = (TextView) findViewById(R.id.textview1);
  String[] projection = new String[]{
            MediaStore.Images.Media._ID,
            MediaStore.Images.Media.BUCKET_DISPLAY_NAME,
            MediaStore.Images.Media.DATE_TAKEN,
            MediaStore.Images.Media.TITLE,

    };

    // Get the base URI for the People table in the Contacts content provider.
    Uri images = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;
    Log.i("URI", images.toString());

            // Make the query.
    Cursor cur = managedQuery(
            MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI,
            projection, // Which columns to return
            null,         // Which rows to return (all rows)
            null,       // Selection arguments (none)
            MediaStore.Images.Thumbnails.IMAGE_ID          // Ordering
            );

    Log.i("ListingImages"," query count="+cur.getCount());

    if (cur.moveToFirst()) {
        String bucket;
        String date;
        String name;

        int bucketColumn = cur.getColumnIndex(
            MediaStore.Images.Media.BUCKET_DISPLAY_NAME);

        int dateColumn = cur.getColumnIndex(
            MediaStore.Images.Media.DATE_TAKEN);

        int nameColumn = cur.getColumnIndex(
                MediaStore.Images.Media.TITLE);

            // Get the field values
            bucket = cur.getString(bucketColumn);
            date = cur.getString(dateColumn);
            name = cur.getString(nameColumn);

            // Do something with the values.
            Log.i("ListingImages", " bucket=" + bucket 
                   + "  name_taken=" + name);

    }

 }
} 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T22:46:05.293

将代码更改为从 MediaStore 获取图像路径，然后将其设置为 ImageView：

```
//YOUR CODE HERE...
String[] projection = new String[]{
            MediaStore.Images.Media._ID,
             MediaStore.Images.Media.DATA, // add DATA column
            MediaStore.Images.Media.BUCKET_DISPLAY_NAME,
            MediaStore.Images.Media.DATE_TAKEN,
            MediaStore.Images.Media.TITLE,

    };

    // Get the base URI for the People table in the Contacts content provider.
    Uri images = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;
    Log.i("URI", images.toString());

            // Make the query.
    Cursor cur = managedQuery(
            MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI,
            projection, // Which columns to return
            null,         // Which rows to return (all rows)
            null,       // Selection arguments (none)
            MediaStore.Images.Thumbnails.IMAGE_ID          // Ordering
            );

    Log.i("ListingImages"," query count="+cur.getCount());

    if (cur.moveToFirst()) {
        String bucket;
        String date;
        String name;

        int bucketColumn = cur.getColumnIndex(
            MediaStore.Images.Media.BUCKET_DISPLAY_NAME);

        int dateColumn = cur.getColumnIndex(
            MediaStore.Images.Media.DATE_TAKEN);

        int nameColumn = cur.getColumnIndex(
                MediaStore.Images.Media.TITLE);

            // Get the field values
            bucket = cur.getString(bucketColumn);
            date = cur.getString(dateColumn);
            name = cur.getString(nameColumn);
          int columnIndex = cur.getColumnIndex(MediaStore.Images.Media.DATA);
          String picPath = cur.getString(columnIndex);

             imageView.setImageBitmap(BitmapFactory.decodeFile(picPath));
            // Do something with the values.
            Log.i("ListingImages", " bucket=" + bucket 
                   + "  name_taken=" + name);

    }

 } 
```

# javascript - 父级与 iframe 中的 createElement

> ID：13772140
> 
> 赞同：2
> 
> 时间：2012-12-07T22:38:13.180
> 
> 标签：javascript, iframe, appendchild, createelement

我有一个模块化网页，每个模块都是可以与父页面交互的 iframe。特别是 iframe 向父级添加新元素（导航、选项卡等）。所有页面都在同一个域中。

到目前为止，我一直在 iframe 中使用这种模式：

```
var newDiv=document.createElement("div");
// do stuff with newDiv
parent.document.body.appendChild(newDiv); 
```

我最近突然想到，因为 newDiv 将附加到父级，所以这样做更有意义：

```
var newDiv=parent.document.createElement("div");
// do stuff with newDiv
parent.document.body.appendChild(newDiv); 
```

我的问题：新元素是用 document.createElement 还是 parent.document.createElement 创建的有什么区别吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:38:51.127

这行得通吗？如果是这样，那么我认为（不是 100% 肯定）两者都是相同的，因为`createElement`它是一个`DOM`方法和一个`document`对象的成员，并且您可以同时访问两个文档（两个对象）并且都包含相同的成员函数（createElement 在两者），在这种情况下，一个在 the 中`iframe`，另一个在它的父级中。因此，看起来您正在从一个来源而不是另一个来源**IMO**调用方法。

就像我说的，这只是一个意见，所以等待专家的更多答案。

# python - 在 shell 中运行代码和从文件中运行代码之间的区别

> ID：13772142
> 
> 赞同：3
> 
> 时间：2012-12-07T22:38:12.537
> 
> 标签：python, csv

我是 csv 模块（以及一般的 Python）的新手。我正在运行一些测试代码来编写一个 CSV 文件，我意识到当我在 shell 中运行它时它会起作用，但当我从 IDLE 中的文件运行它时却不起作用。当我尝试后者时，它告诉我“打开”是无效的语法。这里发生了什么？

```
import csv
with open('csvtest.csv', 'w') as f:
    writer = csv.writer(f)
    writer.writerow('test1', 'test2', 'test3') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:46:30.987

引用[文档](http://docs.python.org/2/reference/compound_stmts.html#the-with-statement)

> *2.5 版中的新功能。*
> 
> with 语句用于使用上下文管理器定义的方法包装块的执行（请参阅 With Statement Context Managers 部分）。

您的 IDLE 可能正在运行 Python 2.4 或更早版本。

# xaml - Xaml，如何以不同的协调方式在图像上绑定按钮列表

> ID：13772143
> 
> 赞同：0
> 
> 时间：2012-12-07T22:38:17.790
> 
> 标签：xaml, data-binding, coordinates, winrt-xaml

对于 Windows 8 应用程序，我需要在图像上放置一个按钮列表。每个按钮都有 CoordinateX 和 CoordinateY 属性。我使用 gridView 绑定到按钮列表。我需要得到如下结果：

![在此处输入图像描述](../Images/bdf0401a3929c5dcf5c509e2cb5b11aa.png)

这是我的代码：

```
<Grid HorizontalAlignment="Left" VerticalAlignment="Top" >
     <Canvas>  
         <Image Source="ms-appx:///Assets/red.png" Stretch="None"  ></Image>

          <GridView ItemsSource="{Binding Buttons}" 
                    SelectionMode="None" IsSwipeEnabled="false"  IsItemClickEnabled="True" ItemClick="Button" Padding="0">                            
          <GridView.ItemTemplate>
                <DataTemplate>
                    <Button Width="194" Height="51" Background="Gray" Canvas.Left="{Binding CoordinateX}" Canvas.Top="{Binding CoordinateY}"></Button>                    
                </DataTemplate>
          </GridView.ItemTemplate>
          </GridView>                      
     </Canvas>
</Grid> 
```

但这是我运行应用程序后得到的：

![在此处输入图像描述](../Images/a14227562e4044ee91fcc546f4a3fc7a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T16:51:06.653

可能在运行时，在为 GridView 中的项目设置 X 和 Y 坐标之前，GridView 本身已应用其属性。由于 1) GridView 旨在用于组织控制和 2) 您没有强制 Grid 填充视图空间

你剩下的是一个 GridView ，它可以按照自己的意愿行事，并限制其项目符合您的样式的能力，如果样式试图强制项目集合位于控件的边界之外。

您可以尝试设置 GridView 的水平对齐属性，但即使它碰巧起作用，使用组织较少的内容控件（如更基本的 ItemsPresenter）可能是更好的选择。

您最终会使用哪个控件...确保检查/设置 Horizo​​ntalContentAlignment 和 VerticalContentAlignment 属性（如果存在）。

# java - AJAX JSON 发布到 Spring 控制器返回 HTTP 415

> ID：13772146
> 
> 赞同：0
> 
> 时间：2012-12-07T22:38:31.367
> 
> 标签：java, ajax, json, spring, spring-mvc

我已阅读 StackOverflow 上有关此问题的大多数帖子，并尝试了许多修复程序，但最终没有解决我的问题。春天抛出一个`HttpMediaTypeNotSupportedException: Content type 'application/json' not supported`

我有一个这样定义的控制器：

```
 @RequestMapping(method = RequestMethod.POST, value = "/update")
 public @ResponseBody JSONDomainResponse update(@RequestBody Model inModel) 
```

模型如下所示：

```
public class Model implements Serializable {

private static final long serialVersionUID = 2738522159847487651L;
private String id;
private BigDecimal offset;

@JsonCreator
public Model(@JsonProperty("id") String id, @JsonProperty("offset") BigDecimal offset) {
  this.id = id;
  this.offset = offset;
}

public String getID() {
  return id;
}

public BigDecimal getOffset() {
  return offset;
}

public void setID(String id) {
  this.id = id;
}

public void setOffset(BigDecimal offset) {
  this.offset = offset;
}
} 
```

我尝试使用的 AJAX 调用如下所示：

```
$.ajax({
  type : 'POST',
  url : '/update',
  contentType : "application/json",
  data : JSON.stringify({"id":"test", "offset":300})
 }); 
```

我的 context.xml 文件中有`<mvc:annotation-driven/>`配置，并且我已验证`MappingJacksonHttpMessageConverter`canRead() 方法为我的模型和 JSON 媒体类型返回 true。

我的类路径中也指定了 Jackson 核心和映射器 jar。

我注意到从控制器签名中删除模型参数使得我实际上通过我的帖子到达控制器，这让我相信我的模型存在一些问题。但是，由于记录的信息很少，我无法真正说出问题所在。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:15:10.757

我终于找到了解决问题的方法，这很简单，但完全不明显。

事实证明，我试图反序列化的模型对象位于一个命名不正确的包中，当 Spring 无法找到模型时，它只会吞下生成的异常并返回 false。我通过在 Spring-MVC 领域的深入调试发现了这一点，尤其是 StdDeserializerProvider 类。

对于其他收到此错误的人，我强烈建议编写一些代码来验证此类中发生的情况，例如：

```
@Test
public void testThatCanConvertUpdateModel() {
  MappingJacksonHttpMessageConverter conv = new MappingJacksonHttpMessageConverter();
  assertTrue(conv.canRead(YourModel.class, MediaType.APPLICATION_JSON));
} 
```

# php - 使用 PHP 进行表单验证的问题

> ID：13772154
> 
> 赞同：0
> 
> 时间：2012-12-07T22:38:52.557
> 
> 标签：php, forms

我有一个听起来相对简单的问题，希望能得到一个简单的答案。我目前正在开发一个向下滚动类型的网站；一切都在一页上，你知道那一页。我的“联系人”部分位于页面的最底部，当然我正在使用 PHP 进行表单验证。验证部分有效，我对此没有任何问题。但是，如果验证失败，浏览器会带我回到页面顶部；由于显而易见的原因，这很不方便。

我知道 'header()' 函数，如果发生错误，我可以使用该函数将我保持在页面底部。例如，在我的 HTML 页面顶部 DOCTYPE 之前，我可以这样写：

```
if ($errors) {
header(Location: 'somelocation.php#contact');
} 
```

这可行，但由于某种原因，它会阻止我嵌入到我的 html 中的 PHP 工作。如果出现一些错误，我想在页面上使用 PHP 显示它们：

```
<h2>Contact</h2>
<?php if($errors) { ?>
<p class="warning">Please fix the errors</p>
<?php } ?> 
```

没有出现“请修正错误”。但是，如果我从页面中删除标题功能，它确实会出现，所以我知道问题是相关的。所以基本上，如果我删除 header() 函数，页面会回到顶部，并显示错误；如果我保留 header() 函数，页面会正确地停留在原处，但不会显示错误。

或者，也可以在以下情况下询问这个问题：正确验证表单时会发生什么，调用“标题”函数，我想留在页面底部并显示一些 HTML 说“谢谢，您的表格已提交”？（我不想去“谢谢”页面或其他任何东西，只要呆在同一个地方并在页面上说“谢谢”）我想我会遇到同样的问题。有针对这个的解决方法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:43:02.073

在标头中指定位置将导致浏览器重定向到该 URI。这是在任何输出发送到浏览器之前调用的。

重置页面时`$errors == false`，不会显示该段落。

听起来您需要在此处集成 AJAX 或服务器端和客户端代码的混合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T06:14:24.607

验证表单的一种非常简单有效的方法是使用 jquery，一个完美的例子：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
 <script src="http://code.jquery.com/jquery-latest.js"></script>
  <script type="text/javascript" src="http://jzaefferer.github.com/jquery-validation/jquery.validate.js"></script>
 <style type="text/css">
* { font-family: Verdana; font-size: 96%; }
label { width: 10em; float: left; }
label.error { float: none; color: red; padding-left: .5em; vertical-align: top; }
p { clear: both; }
.submit { margin-left: 12em; }
 em { font-weight: bold; padding-right: 1em; vertical-align: top; }
 </style>
 <script>
  $(document).ready(function(){
    $("#commentForm").validate();
   });
   </script>

 </head>
 <body>

 <form class="cmxform" id="commentForm" method="get" action="">
 <fieldset>
  <legend>A simple comment form with submit validation and default messages</legend>
  <p>
 <label for="cname">Name</label>
 <em>*</em><input id="cname" name="name" size="25" class="required" minlength="2" />
  </p>
  <p>
 <label for="cemail">E-Mail</label>
 <em>*</em><input id="cemail" name="email" size="25"  class="required email" />
  </p>
  <p>
 <label for="curl">URL</label>
 <em>  </em><input id="curl" name="url" size="25"  class="url" value="" />
     </p>
   <p>
 <label for="ccomment">Your comment</label>
 <em>*</em><textarea id="ccomment" name="comment" cols="22"  class="required"></textarea>
  </p>
   <p>
 <input class="submit" type="submit" value="Submit"/>
  </p>
  </fieldset>
  </form>
 </body>
 </html> 
```

快乐编码.!!!

# android - setContentView 后堆在 30M

> ID：13772157
> 
> 赞同：2
> 
> 时间：2012-12-07T22:39:16.527
> 
> 标签：android, heap-memory, mat

启动我的应用程序时，堆大约为 15M。在跟注后`setContentView`，`MainActivity`它加注到大约 30M。这种布局没有太多内容。这就是为什么我想知道这是否正常。当开始另一个 Acticity 时，它再次上升到大约 40M 并且不会再次下降。

`main.xml`看起来是这样的：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/LinearLayout1"
    android:background="@drawable/background"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/LinLAdMain"
        android:layout_width="match_parent"
        android:layout_height="88dp"
        android:layout_weight="0.70"
        android:orientation="vertical" >
    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.70"
        android:orientation="vertical" >

        <ImageView
            android:id="@+id/imageView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="top"
            android:contentDescription="@string/logo_description"
            android:src="@drawable/logo" />

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:layout_weight="0.14"
        android:orientation="vertical" >

        <Button
            android:id="@+id/button1"
            style="@style/StartButton"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:onClick="onClick"
            android:layout_margin="8dp" />

        <Button
            android:id="@+id/button2"
            style="@style/HighscoreButton"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:onClick="onClick"
            android:layout_margin="8dp" />

        <Button
            android:id="@+id/button3"
            style="@style/SettingsButton"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:onClick="onClick"
            android:layout_margin="8dp" />

    </LinearLayout>
</LinearLayout> 
```

如您所见，我正在使用背景可绘制对象。但是文件大约有60K大..

这就是 MAT-default-report 紧随其后的样子`setContentView()`：

![截屏](../Images/4cd9e8b457ec32e7095751df0c8c7bda.png)

这就是 GC 的路径（不包括弱引用）：

![截屏](../Images/ddbd5dd9e4f99ab8cac33bec3cb352d6.png) ![截屏](../Images/b1101ca6fcc0cbbf1ea6b3f02f34383c.png)

这些“下一个”以头类 java.lang.ref.FinalizerReference 结尾，它什么也没告诉我。

正如我所说，每次活动都会变得更糟。例如，在 Main->Highscore->GlobalHighscore 之后，就不能再启动 Activity“游戏”了。希望你们能帮助我:)。

如果您需要更多信息/代码，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:31:54.767

PNG 和 JPG 等图像文件格式正在使用压缩算法来减少使用的磁盘空间。但是，当图像在 android 应用程序中加载时，这些文件会被解压缩，并且可能会比原始文件大得多。

解压后使用的空间类似于将 PNG 或 JPG 文件转换为 BMP 32 位颜色时使用的磁盘空间。

**一个例子**

一个非常简单的全白绘图，大小为 1024 x 1024 像素，另存为 PNG 将使用几个 Kb。

解压成 ARGB_8888 后，它变成一个 1024 x 1024 x 4 字节的数组（最后 4 个代表每个像素使用的 4 个字节，每个基本颜色 RGB 一个，一个用于 Alpha）

```
1024 x 1024 x 4 = 4,194,304 = 4 MB 
```

所以这个简单图像使用的内存为 4 MB。

**该怎么办**

减少图像使用的内存：

*   使用仍然满足您要支持的不同屏幕尺寸要求的最小尺寸（宽度和高度）
*   为不同的屏幕使用不同的尺寸（mdpi、hdpi 等）。但是，这会增加您的应用程序大小。
*   使用 Draw 9 Patch 创建小尺寸图像，这些图像将以可预测和可控的方式扩展到大屏幕。

找出导致内存分配增加的内存泄漏。

可能您正在使用对`Context`阻止 GC 收集内存的活动的引用。最可能的原因是引用了 Context/Activity 的对象：

*   线程
*   处理程序
*   意见

在不再需要时或在活动中尝试将它们归零`OnDestroy()`

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:00:17.407

获取`android:src="@drawable/logo"`并手动调整大小以适合您的屏幕，需要。我的意思是可绘制文件夹中的 logo.png。在 320x480 分辨率下，它不需要 2560x1600 像素！

# c# - 访问者模式可以用回调函数代替吗？

> ID：13772168
> 
> 赞同：5
> 
> 时间：2012-12-07T22:40:19.503
> 
> 标签：c#, design-patterns, delegates, visitor-pattern

使用这两种技术有什么显着的好处吗？如果有变化，我的意思是访问者模式：[http ://en.wikipedia.org/wiki/Visitor_pattern](http://en.wikipedia.org/wiki/Visitor_pattern)

而下面是一个使用delegate达到同样效果的例子（至少我觉得是一样的）

假设有一组嵌套元素：学校包含包含学生的部门

与其使用访问者模式对每个集合项执行某些操作，不如使用简单的回调（C# 中的操作委托）

说这样的话

```
class Department
{
    List Students;
}

class School
{
    List Departments;

    VisitStudents(Action<Student> actionDelegate)
    {
        foreach(var dep in this.Departments)
        {
            foreach(var stu in dep.Students)
            {
                actionDelegate(stu);
            }
        }
    }
}

School A = new School();
...//populate collections

A.Visit((student)=> { ...Do Something with student... }); 
```

*****编辑示例，代表接受多个参数****

 **假设我想通过学生和部门，我可以像这样修改动作定义：动作

```
class School
{
    List Departments;

    VisitStudents(Action<Student, Department> actionDelegate, Action<Department> d2)
    {
        foreach(var dep in this.Departments)
        {
            d2(dep); //This performs a different process.
            //Using Visitor pattern would avoid having to keep adding new delegates.
            //This looks like the main benefit so far 
            foreach(var stu in dep.Students)
            {
                actionDelegate(stu, dep);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T22:45:40.630

当访问不止一种类型的事物时，通常使用访问者模式。您只有一种类型（`Student`s ），因此您实际上并不需要访问者模式，只需传入一个委托实例即可。

假设您想同时访问`Department`s 和`Student`s。然后您的访客将如下所示：

```
interface ISchoolVisitor
{
    void Visit(Department department);
    void Visit(Student student);
} 
```

当然，你也可以在这里使用委托，但是传递多个委托实例会很麻烦——特别是如果你有超过 2 种类型的访问对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T22:50:45.917

当嵌套结构（如树）中的节点不知道其子节点的具体类型时，访问者模式更有用。然后，访问者用于根据每个子对象的真实类型来调度行为。

在您的示例中，学校确实知道它有一个子集合`Departments`，而该子集合又具有子集合`Student`。

如果您将示例扩展为包含另一个子元素，`School`那么您的代码可能如下所示：

```
public abstract class Manageable
{
    abstract void Accept(IManagebleVisitor visitor);
}

public interface IManageableVisitor
{
    void Visit(Department d);
    void Visit(Building b);
}

public class Department : Manageable { ... }
public class Building : Manageable { ... } 
```

现在您的`School`课程可能如下所示：

```
public class School
{
    private List<Manageable> manageables;
    public void Accept(IManageableVisitor visitor)
    {
        foreach(var m in this.manageables)
        {
            m.Accept(visitor);
        }
    }
} 
```

委托方法在这里不起作用，因为您需要为 的每个具体子类传递一个委托`Manageable`，因此向层次结构添加任何新子类都需要更改`School.Accpet`方法。**

# ssrs-2008 - 为 SSRS 报表服务器中的所有报表启用缓存

> ID：13772171
> 
> 赞同：3
> 
> 时间：2012-12-07T22:40:48.427
> 
> 标签：ssrs-2008, reporting-services, reportserver, ssrs-2012

我在 SSRS 报表服务器中有 100 多个报表。我需要为所有这些启用缓存。现在，我正在通过报表管理器为每个报表启用缓存。

**我们可以在任何报表服务器配置文件中添加缓存吗？**这样我们就可以在一个地方为所有报告启用缓存。

任何帮助将不胜感激

谢谢阿杰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-22T12:03:22.160

下面是我用来在几分钟内对报告列表启用缓存的脚本。

将其保存为 setreportscaching.rss，然后从命令行运行它：

```
rs.exe -i setreportscaching.rss -e Mgmt2010 -t -s http://mySsrsBox:8080/ReportServer -v ReportNamesList="OneReport,AnotherReport,YetAnotherOne" -v CacheTimeMinutes="333" -v TargetFolder="ReportsFolderOnServer" 
```

很容易修改它以循环浏览某个文件夹中的文件，而不是获取 csv 报告列表。它有一些愚蠢的诊断，可以注释掉以提高速度。

```
Public Sub Main()

    Dim reportNames As String() = Nothing
    Dim reportName As String
    Dim texp As TimeExpiration
    Dim reportPath As String

    Console.WriteLine("Looping through reports: {0}", ReportNamesList)

    reportNames = ReportNamesList.Split(","c)

    For Each reportName In reportNames

        texp = New TimeExpiration()
        texp.Minutes = CacheTimeMinutes

        reportPath = "/" + TargetFolder + "/" + reportName

        'feel free to comment out this diagnostics to speed things up
        Console.WriteLine("Current caching for " + reportName + DisplayReportCachingSettings(reportPath))

        'this call sets desired caching option
        rs.SetCacheOptions(reportPath, true, texp)

        'feel free to comment out this diagnostics to speed things up
        Console.WriteLine("New caching for " + reportName + DisplayReportCachingSettings(reportPath))

    Next

End Sub

Private Function DisplayReportCachingSettings(reportPath as string)

    Dim isCacheSet As Boolean
    Dim expItem As ExpirationDefinition = New ExpirationDefinition()
    Dim theResult As String

    isCacheSet = rs.GetCacheOptions(reportPath, expItem)

    If isCacheSet = false Or expItem is Nothing Then
        theResult = " is not defined."
    Else
        If expItem.GetType.Name = "TimeExpiration" Then
            theResult = " is " + (CType(expItem, TimeExpiration)).Minutes.ToString() + " minutes."
        ElseIf expItem.GetType.Name = "ScheduleExpiration" Then
            theResult = " is a schedule"
        Else
            theResult = " is " + expItem.GetType.Name
        End If
    End If

    DisplayReportCachingSettings = theResult

End Function 
```

# architecture - 在 DDD + 分层架构中实现 Automapper 的位置

> ID：13772177
> 
> 赞同：29
> 
> 时间：2012-12-07T22:41:53.013
> 
> 标签：architecture, domain-driven-design, automapper, layer

**背景**：为了我自己的清晰/自我教育，我正在尝试使用 TDD + DDD 实现一个简单的订单输入应用程序。我的主要目标是通过分离关注点来保持架构清洁。

我有四层（现在）......

1.  具有 CustomerRepository 类的持久性/DAL，该类可以对“聚合根”、客户及其相关的 Orders 和 OrderItems 执行 GetById、Save、操作。为了允许“穷人的依赖注入”

2.  域/BLL 层包含“业务实体”类，这些类执行细粒度操作以帮助创建新订单，根据订单大小和客户位置应用税收、折扣、运输逻辑。

3.  应用程序外观（应用程序服务/编排）包含厚实的、粗粒度的类来编排“业务实体”并减少与演示文稿（以及可能的 Web 服务层）的交流。

4.  表示层

此外，我想在关键层之间传递 POCO DTO ......特别是在 Persistence=>Domain 层和 ApplicationFacade=>Presentation 层之间。所以，我有 CustomerDto、OrderDto、OrderItemDto 以及在共享包中定义的适当关系。

我想使用构造函数注入将 ICustomerRepository 的实现注入到客户“业务实体”类中，然后在“业务实体”上调用 Customer.Save() 以启动创建/更新过程，最终调用 Save 方法客户存储库。毕竟，客户是“聚合根”，拥有保存所需的所有信息……它也是注入的客户存储库的“守护者”。

**问题：** 这是我遇到障碍的地方。我希望保持域/BLL 层尽可能纯净，并避免将其耦合到任何第三方框架和 API，**但**Customer.Save() 方法需要将客户“聚合根”及其所有订单和订单项转换为他们的 DTO 版本用于传输到注入的持久层 CustomerRepository ......这是 Automapper 的工作。

问题是......如果我不把 Automapper 放在 Domain/BLL 层，我不确定它应该放在哪里 **。**

即使它的工作是编排，将它放在 ApplicationFacade 中也感觉不对。

把它放在 Domain/BLL 层肯定感觉不对，因为我想保持它的原始状态。

因此，我觉得我错过了一些东西……我在接近这个问题时对工作部分应该如何组合在一起来完成这个任务有一个根本的误解。有什么建议么？（请温柔一点，我对这一切都很陌生，对 SO 也很陌生。让我知道是否需要展示我目前所拥有的一些代码。）

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-12-08T21:12:51.130

为了回答您的具体问题，我将更一般地谈论您的架构。您为项目设计的架构与 DDD 使用的典型架构略有不同。虽然划分职责的方式很典型，但在 DDD 中，域类不负责它们自己的持久性。事实上，DDD 的一个口头禅是[坚持无知](http://gorodinski.com/blog/2012/08/10/toward-persistence-ignorance-with-nhibernate-in-domain-driven-design/)。这基本上意味着域类对持久性无知——它们没有`Save`方法。相反，应用程序服务（架构中的应用程序外观层）与存储库协调以重构和持久化域实体。

接下来，在实现存储库时，通常不需要在底层持久性技术和域类之间建立显式 DTO。使用 NHibernate 和 EF 等 ORM，域类和关系表之间的映射可以用映射类或基于 XML 的配置来表示。结果，您的域类被隐式映射 - 不需要 DTO。有些情况确实需要 DTO，在这种情况下，DTO 和域类之间的映射应该由存储库实现封装。这是您可以调用 AutoMapper 的地方。

最后，使用 DTO 在表示层和应用程序/域层之间进行通信是一种常见的做法。要准确确定应该在哪里进行映射，您必须深入挖掘最适合您的项目的架构。大多数现代 DDD 架构都基于[Hexagonal 架构](http://alistair.cockburn.us/Hexagonal+architecture)。在六边形架构中，您的域位于中心，所有其他“层”使域适应特定技术。例如，可以将存储库视为[适配器](http://en.wikipedia.org/wiki/Adapter_pattern)域和特定的数据库技术之间。ASP.NET WebAPI 可以看作是域和 HTTP/REST 之间的适配器。同样，表示层可以看作是领域和特定领域之间的适配器。DTO 可以在这些适配器中的每一个中体现，并且适配器负责映射到这些 DTO 和从这些 DTO 映射。

一个典型的例子是使用应用程序服务在您的域上建立一个外观。还没有 DTO 在起作用。接下来，使用 ASP.NET WebAPI 创建一个服务层（DDD 中的开放主机服务） - 一个适配器。您创建 ASP.NET WebAPI 特定的 DTO，并由该适配器映射到这些 DTO 和从这些 DTO 映射。因此，如果您使用 AutoMapper，则应在该层调用它。这可以显式地完成，也可以使用操作过滤器[以面向方面的方式完成。](http://en.wikipedia.org/wiki/Aspect-oriented_programming)表示层也是如此。表示层可以直接耦合到应用程序服务或 ASP.NET WebAPI 开放主机服务。在任何一种情况下，表示层都有责任在域类（来自应用程序服务或来自 WebAPI 的 DTO）与其自己的原语（如 ViewModel）之间进行映射。

# javascript - DISQUS 和 Pushstate AJAX 或 Hashbang

> ID：13772178
> 
> 赞同：1
> 
> 时间：2012-12-07T22:41:55.010
> 
> 标签：javascript, disqus, pjax, singlepage

有没有人让 Disqus 与 PJAX 甚至常规的`#!`AJAX 一起正常工作。

让我们看一些这样做的人的例子：

1.  [http://donejs.com/](http://donejs.com/)
2.  [http://www.playmodules.net/demo/1](http://www.playmodules.net/demo/1)

第一个是使用 Hash bang 风格，第二个是 PJAX。现在单击这些站点，您会在 Disqus 中注意到您的 gravatar 图标消失了，如果您打开 javascript 控制台，您通常会收到错误和日志消息，因为该`DISQUS`对象无法解除绑定。

我已经尝试过自己的随机黑客（这很困难，因为我找不到没有通过缩小混淆的 DISQUS js）：

```
(function() {
    if ( document.getElementById('my_disqus_script') && document.getElementById('disqus_thread') ) {
        //var ds = document.getElementById('my_disqus_script');
        //(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).removeChild(ds);
        alert(window.location.href);
        DISQUS.reset({
            reload: true,
            config: function() {
                this.page.identifier = 'disqus_thread';
                this.page.url = window.location.href + '#!disqus_thread';
            }
        });
    }
    else if (document.getElementById('disqus_thread')){
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.id = 'my_disqus_script';
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }
    else {
        var ds = document.getElementById('my_disqus_script');
        if (ds)
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).removeChild(ds);
        if (window['DISQUS']) {
            alert('cleanup');
            DISQUS.reset();
            DISQUS.cleanup();
            DISQUS = null;
        }
    }
})(); 
```

基本上我尝试了一堆清理技术，以便当我的 PJAX 加载新页面时它应该清理但我总是得到一些必然`null`引发异常的事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T15:36:20.773

@JanHančič 是正确的，因为 iframe 是最好的路线（所以如果他回答我会标记他正确）。iframe 的高度和无缝可以通过以下方式处理：[https ://github.com/house9/jquery-iframe-auto-height](https://github.com/house9/jquery-iframe-auto-height)

我所做的是制作一个控制器（或任何你的框架调用它）来处理任何 url，例如：`http://my.com/page/disqus`它将加载`http://my.com/page`.

控制器只加载 DISQUS 小部件（包装在 a 中`html/body`）。然后在`http://my.com/page`模板中将 iframe 包含到`http://my.com/page/disqus`.

# c# - C#：通过数组搜索

> ID：13772181
> 
> 赞同：-2
> 
> 时间：2012-12-07T22:42:29.957
> 
> 标签：c#, arrays, search

我有一个存储 dvd 和蓝光的 dvd 应用程序，我想按导演搜索阵列。下面是库存类的代码，我见过许多不同的方法来做到这一点。似乎有一些争论是实现这一目标的最佳/最有效的方式，有什么建议吗？

块引用

```
 namespace MovieInventoryApplication
{
class Inventory
{
    public Bluray[] BlurayMovies;
    public DVD[] DVDMovies;

    private int blurayCount;
    private int dvdCount;

    public Inventory()
    {
        BlurayMovies = new Bluray[5];
        DVDMovies = new DVD[5];

        blurayCount = 0;
        dvdCount = 0;
    }

    public void AddBluray()
    {
        String strTitle;
        int intReleaseYear;
        int intRunningTimeMinutes;
        String strDirector;
        int intPrice;
        int intRegionCode;

        try
        {
            Console.Write("Enter a title: ");
            strTitle = Console.ReadLine();

            Console.Write("Enter a release year: ");
            intReleaseYear = Convert.ToInt32(Console.ReadLine());

            Console.Write("Enter the running time in minutes: ");
            intRunningTimeMinutes = Convert.ToInt32(Console.ReadLine());

            Console.Write("Enter the directors name: ");
            strDirector = Console.ReadLine();

            Console.Write("Enter a rental price: ");
            intPrice = Convert.ToInt32(Console.ReadLine());

            BlurayMovies[blurayCount] = new Bluray(strTitle, intReleaseYear, intRunningTimeMinutes, strDirector, intPrice);
            blurayCount++;

            Console.Write("Enter the DVD region code: ");
            intRegionCode = Convert.ToInt32(Console.ReadLine());

            DVDMovies[dvdCount] = new DVD(strTitle, intReleaseYear, intRunningTimeMinutes, strDirector, intPrice, intRegionCode);
            dvdCount++;
        }
        catch (FormatException FormatException)
        {
            Console.WriteLine(FormatException.Message);
            Console.WriteLine("Please enter a number in this field.");
        }
    }

    public void AddDVD()
    {
        String strTitle;
        int intReleaseYear;
        int intRunningTimeMinutes;
        String strDirector;
        int intPrice;
        int intRegionCode;

        try
        {
            Console.Write("Enter a title: ");
            strTitle = Console.ReadLine();

            Console.Write("Enter a release year: ");
            intReleaseYear = Convert.ToInt32(Console.ReadLine());

            Console.Write("Enter the running time in minutes: ");
            intRunningTimeMinutes = Convert.ToInt32(Console.ReadLine());

            Console.Write("Enter the directors name: ");
            strDirector = Console.ReadLine();

            Console.Write("Enter a rental price: ");
            intPrice = Convert.ToInt32(Console.ReadLine());

            Console.Write("Enter the region code: ");
            intRegionCode = Convert.ToInt32(Console.ReadLine());

            DVDMovies[dvdCount] = new DVD(strTitle, intReleaseYear, intRunningTimeMinutes, strDirector, intPrice, intRegionCode);
            dvdCount++;
        }

        catch (FormatException FormatException)
        {
            Console.WriteLine(FormatException.Message);
            Console.WriteLine("Please enter a number in this field.");
        }
    }

    public void ListAllBluray()
    {
        int position = 0;

        while (BlurayMovies[position] != null)
        {
            Console.WriteLine(position + " " + BlurayMovies[position].strTitle);

            position++;
        }
    }

    public void ListAllDVD()
    {
        int position = 0;

        while (DVDMovies[position] != null)
        {
            //position + 1 + " " + 
            Console.WriteLine(position + " " + DVDMovies[position].strTitle);

            position++;
        }
    }

    public void BlurayInfo(int position)
    {
        Console.WriteLine("Title: {0}", DVDMovies[position].strTitle);
        Console.WriteLine("Release Year: {0}", DVDMovies[position].intReleaseYear);
        Console.WriteLine("Running Time (Minutes): {0}", DVDMovies[position].intRunningTimeMinutes);
        Console.WriteLine("Director: {0}", DVDMovies[position].strDirector);
        Console.WriteLine("Price: {0}", DVDMovies[position].intPrice);
    }

    public void DVDInfo(int position)
    {
        Console.WriteLine("Title: {0}", DVDMovies[position].strTitle);
        Console.WriteLine("Release Year: {0}", DVDMovies[position].intReleaseYear);
        Console.WriteLine("Running Time (Minutes): {0}", DVDMovies[position].intRunningTimeMinutes);
        Console.WriteLine("Director: {0}", DVDMovies[position].strDirector);
        Console.WriteLine("Price: {0}", DVDMovies[position].intPrice);
        Console.WriteLine("Region Code: {0}", DVDMovies[position].intRegionCode);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T22:49:48.293

我认为你的设计有缺陷。

DVD 和 BluRay 类真的应该是：

1.  具有`Type`属性的单个类，可能是包含 DVD 和 BluRay 的枚举。这样，几年后，一旦您获得新媒体，您只需向 Enum 添加一个值，您的应用程序就会保持最新。
2.  实现自定义接口的两个不同的类，您可以调用它们，例如`IMedia`.

另外，我强烈建议您利用`List`C# 中的对象而不是数组。它非常快，您可以轻松添加/删除项目，而无需调整数组的大小。

这是关于 Linq 的一课：[http ://www.functionx.com/csharp/linq/Lesson09.htm](http://www.functionx.com/csharp/linq/Lesson09.htm)

以下是我将如何创建 Media 类：

```
public class Media
{
    public enum MediaType
    {
        DVD,
        Bluray
    }

    public MediaType TypeOfMedia { get; set; }
    public string Director { get; set; }
    public string Title { get; set; }

    public Media(string Title, string Director, MediaType TypeOfMedia)
    {
        this.TypeOfMedia = TypeOfMedia;
        this.Director = Director;
        this.Title = Title;
    }
} 
```

这是一个如何使用它的示例：

```
 List<Media> data = new List<Media>();

        results.Add(new Media("Movie 1", "John D", Media.MediaType.DVD));
        results.Add(new Media("Movie 2", "John D", Media.MediaType.DVD));
        results.Add(new Media("Movie 3", "SomeOtherDirector", Media.MediaType.Bluray));
        results.Add(new Media("Movie 4", "John D", Media.MediaType.Bluray));

        IEnumerable<Media> listDirectors = from media in data
                                           where media.Director == "John D"
                                           select media;

        foreach (Media media in listDirectors)
            Console.WriteLine(media.Title); 
```

另一个例子，您的“List DVD”和“List Bluray”函数实际上可能是一个函数：

```
 private void ListMediaByType(List<Media> data, Media.MediaType type)
    {
        foreach (Media media in data.Where(media => media.TypeOfMedia == type))
            Console.WriteLine(media.Title);
    } 
```

如您所见，这些技术大大简化了查询。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T22:49:25.547

最简单的（恕我直言）是使用 Linq：

```
string director = "Alfred Hitchcock";
IEnumerable<DVD> dvds = DVDMovies.Where(dvd => dvd.Director == director);
IEnumerable<DVD> blueRays = BlurayMovies.Where(br => br.Director == director);
List<DVD> allMatches = new List<DVD>();
allMatches.AddRange(dvds.Concat(blueRays)); 
```

# ruby-on-rails-3 - 在将应用程序中的 config.time_zone 设置为升级到 Rails 3 后，Time.zone 为零

> ID：13772185
> 
> 赞同：0
> 
> 时间：2012-12-07T22:42:40.800
> 
> 标签：ruby-on-rails-3, timezone

致力于将应用程序从 Ruby 1.8.6/Rails 2.3.5 升级到 Ruby 1.8.7/Rails3.0.11。

在 application.rb 中，配置语句已被（从 environment.rb）移动到：

```
module AppName
class Application < Rails::Application
...
end
end 
```

块，包括语句：

```
config.time_zone = 'Eastern Time (US & Canada)' 
```

在旧的 environment.rb 文件中，还有一些用于初始化一些常量的代码，我已将其移至 application.rb。我已经在模块/类块之后（就像以前一样）和它里面尝试过它，但是下面的语句：

```
Time.zone.parse(external_config_date) 
```

正在产生此错误：

> config/application.rb:49: nil:NilClass (NoMethodError) 的未定义方法“解析”

我对此有点困惑（Rails 日期/时间经常发生这种情况：-/）；大多数情况下，看起来 Time.zone 是访问默认时区的一种可接受的方式，但我也看到它说“zone”是 Time 的实例方法而不是类方法。

对此的任何见解（或有关如何进一步排除故障的想法）非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T22:39:49.237

看起来将额外的配置代码从 environment.rb 移动到 application.rb 是我的错误。'Time.zone.parse' 似乎是一个 Rails 插件，它还没有在 application.rb 中启用。将配置代码移回 environment.rb 的底部，在该行之后

```
AppName::Application.initialize! 
```

让它工作。

# c++ - 我如何编译这个因“'::main'必须返回'int'”而失败的C++代码？

> ID：13772193
> 
> 赞同：1
> 
> 时间：2012-12-07T21:03:01.207
> 
> 标签：c++

我试图找到一个解决方案，使批处理文件开始在任务栏上闪烁，唯一好的解决方案是[Stack Overflow 上的这篇文章](https://stackoverflow.com/questions/3560018/triggering-taskbar-button-flash-from-batch-file)。

但我无法使用 WinGW 或其他任何东西将代码编译为 EXE，只会收到此错误：

```
hello.cpp:6:32: error: '::main' must return 'int' 
```

现在，我正在使用[TDM-GCC](http://tdm-gcc.tdragon.net/)编译代码，因为它更好一些......

有人可以给我实际工作的代码，甚至可以更好地将其编译为 EXE 吗？

[PS 如果有人能编译这个 Delphi 代码](https://stackoverflow.com/questions/3560018/triggering-taskbar-button-flash-from-batch-file/3560079#3560079)就更好了，因为我找不到任何免费的软件。

编辑：我只是去见鬼，下载了 Delphi 试用版并编译了 delphi 代码，它工作了！抱歉，不必要地打扰您了：/您可以关闭它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T21:06:57.900

它实际上是`int main()`，并且结尾必须返回一个整数（因此将最后一行放在“}”之上`return 0;`（表示成功运行，否则为非零）。

```
#include <iostream>
using namespace std;
int errors;

int main(arg stuff) {
    std::cout << "C++!";

    if (errors > 0)
         return 1;

    return 0;
} 
```

# git - git-commit 在 emacs 中突出显示类似 vim 的语法

> ID：13772196
> 
> 赞同：5
> 
> 时间：2012-12-07T22:43:21.250
> 
> 标签：git, vim, emacs, syntax-highlighting

我最近选择了 emacs 作为通用编辑器来代替 gedit 和 vim。*我非常*想念vim 的一件事是 git 语法突出显示。我试过 git-el，显然没有运气。

vim git-commit 突出显示的特点是“主题行”突出显示提交消息的第一行的前 50 个字符，“错误”突出显示第二行、注释，以及添加或删除文件的红色和绿色突出显示（其中自己写在预先编写的注释中。）

是否有类似的功能语法突出显示 emacs，如果有，我将如何安装它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:23:01.877

我并没有真正做 emacs，但我做了一些快速搜索并找到了[git-modes](https://github.com/lunaryorn/git-modes)和[magit](http://magit.github.com/magit/)。我想这会让你走上正确的道路。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-06-02T00:58:33.467

**2019年更新：**

这里提供的答案是 5 岁和 7 岁，我花了一些时间才弄清楚如何在没有`magit`. 现在大多数链接都指向 magit 存储库，从那里并不清楚当前与 git 相关的软件包列表是什么，也不知道它们是否在 Melpa 上。

EmacsWiki[页面](https://www.emacswiki.org/emacs/GitCommitMode)确实提供了信息，但是由于这些不同包的移动历史及其名称的微小变化，要跟踪并查看它们现在的位置以及它们的名称并不完全容易。

所以我想我会发布这些包的摘要。

**它们都在 Melpa 上**，并且这些软件包中的任何一个都可以独立于其他软件包进行安装，因此您可以挑选您需要的软件包。

*   允许对提交消息进行语法突出显示的包被称为`git-commit`
*   对于 .gitignore 突出显示，它被称为`gitignore-mode`
*   对于.gitattributes，它被称为`gitattributes-mode`
*   对于.gitconfig，它被称为`gitconfig-mode`

因此，当前调用了回答问题的包，`git-commit`它位于 Melpa 上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-07T13:51:58.557

[EmacsWiki](http://www.emacswiki.org/emacs/GitCommitMode)上的“Git Commit Mode”主要是对历史兴趣的概述。（目前有些争论）页面似乎认为您应该使用 Magit。所有的道路最终都会导致[git-modes](https://github.com/magit/git-modes)据称现在也是 Magit 的默认设置。

（我的 Ubuntu 14.04`magit`似乎仍然没有包含它。`git-commit-mode`从[Marmalade](https://github.com/magit/git-modes#installation)安装很快就解决了这个问题。）

Google中的许多随机 dot.emacs 文件似乎都包含`diff-mode`. `COMMIT_EDITMSG`我真的不明白为什么——缓冲区不包含差异，差异模式禁用了一些有用的文本编辑功能。如果您没有其他开箱即用的东西，那么指定`log-edit-mode`会更有意义。

# tomcat - servlet 写入的可接受位置？

> ID：13772200
> 
> 赞同：0
> 
> 时间：2012-12-07T22:43:46.783
> 
> 标签：tomcat, servlets, filesystems, derby

我想在 Tomcat 上运行的基于 servlet 的应用程序中嵌入一个 Derby 数据库。

为此，我需要将数据库文件保存在磁盘上。我希望它们驻留在已部署的 Web 应用程序的子文件夹中（然后我可以使用 转换`getServletContext().getRealPath()`）。

servlet 可以安全写入的可接受的、与应用程序相关的位置是否存在良好实践？如果不存在这样的建议，那么特定于 tomcat 的良好做法是什么？

[这个讨论](https://stackoverflow.com/questions/13768735/write-to-file-in-class-instance-called-by-servlet-in-eclipse)似乎排除了写作`WebContent`；正如一些教程所指出的那样，我是否必须写一个`CATALINA_HOME`子文件夹（但感觉很hackish）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T22:56:27.293

当您安装应用程序时，您希望看到您的数据存储在`/usr/bin`（或`C:/Program Files`）中的某个位置，还是存储在其余数据所在的主目录中？

不要将您的应用程序二进制文件（永远不会改变）与它所操作的数据结合起来。您不想在删除应用程序时丢失数据，反之亦然。用户主目录甚至更好——安装过程中选择的文件夹——要好得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T04:24:00.730

您需要使文件系统持久性位置成为程序的显式参数，可能作为属性（即`-DdataStoreLocation=somepath`）。一般而言，Java 应用程序可能有权访问文件系统，也可能无法访问文件系统——它可能在 WAR 中运行，甚至可能已从网络加载，并且没有与类路径相关的文件系统。

让它成为一个明确的要求和你的应用程序与用户的合同的一部分是保证有一个文件系统可供使用的唯一方法，也是一种获取要使用的路径名的方法。

# intellij-idea - Play 2 的 scala 模板中 Intellij IDEA 12 中无法识别 Javascript 代码

> ID：13772202
> 
> 赞同：4
> 
> 时间：2012-12-07T22:43:56.493
> 
> 标签：intellij-idea, playframework-2.0

我刚刚安装了最近发布的 Intellij IDEA 12，它非常适合 Play Framework 2。

但是，我遇到了以下问题：在 HTML Scala 模板中，包含在`<script>`模板正文中的标记中的任何 JavaScript 代码都不会被 IDEA 识别为 JavaScript，因此不提供代码完成并错误地显示错误。吨。我怀疑它将代码解释为 Scala 代码，因此提供了不正确的代码完成，并且在模板中编写 JS 非常痛苦。

IDEA 11 中不存在此问题。

有任何想法吗？

**更新**

我`JavaScript Support`启用了插件。简单的代码完成工作正常。但是，如果我键入`function (){}`一个匿名函数并`Enter`用大括号之间的插入符号进行编码，IDEA 会执行以下操作：

![在此处输入图像描述](../Images/8daefa94f1363a131c55dd0363417071.png)

如果我手动修复错误添加的`}`，并为匿名函数编写代码，它会提供正确的变量建议，`console.log`尽管它仍然显示错误：

![在此处输入图像描述](../Images/18fe527b0f02b4d9bbc87baaa07bf737.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:57:20.553

我无法确认，我可以看到 Scala 和 JavaScript 完成都正常工作。

转到`Settings`>`Plugins`并确保您已`JavaScript Support`启用。之后关闭并重新打开所有视图，让 Idea 再次分析语法。

![在此处输入图像描述](../Images/165e28d267cbcc38976f3635de24cea5.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-04T17:58:47.883

您的函数语句似乎无效，因为您没有命名函数。[这篇文章](https://stackoverflow.com/questions/1634268/explain-javascripts-encapsulated-anonymous-function-syntax)回答了这里发生的事情的细节。我不确定您的特定需求的详细信息，但您可以尝试使用以下语法：

```
<script>
    (function() {

    })();
</script> 
```

# c++ - 全局 const char * 上的错误 LNK1169

> ID：13772206
> 
> 赞同：8
> 
> 时间：2012-12-07T22:44:13.920
> 
> 标签：c++, visual-studio-2010, visual-c++

我在使用 Visual Studio 2010 和 C++ 时遇到了一些奇怪的行为。我有一个头文件，我在其中声明了一些全局常量

```
#ifndef CONSTANTS_H
#define CONSTANTS_H

#define WIN32_LEAN_AND_MEAN

// Macros...
#define SAFE_RELEASE(ptr) { if (ptr) { ptr->Release(); ptr = NULL } }
#define SAFE_DELETE(ptr) { if (ptr) { delete ptr; ptr = NULL; } }

// Constants...
const char* CLASS_NAME = "WinMain";
const char GAME_TITLE[] = "DirectX Window";

const int GAME_WIDTH = 640;
const int GAME_HEIGHT = 480;

#endif 
```

我的问题来自以下行：

```
const char* CLASS_NAME = "WinMain"; 
```

当它是这样的，我构建我的解决方案时，我得到以下 2 个错误：

`error LNK1169: one or more multiply defined symbols found`， 和

`error LNK2005: "char const * const CLASS_NAME" (?CLASS_NAME@@3PBDB) already defined in graphics.obj`

现在很奇怪，因为运行了“在文件中查找”，我绝对不会在其他地方声明它，即没有重复声明。

我应该将其更改为：

```
const char* const CLASS_NAME = "WinMain"; 
```

或者

```
const char CLASS_NAME[] = "WinMain"; 
```

它编译得很好！但据我所知`char* x`，它等同于`char x[]`，并且我在指针和指向的值上都强制执行“常量”这一事实应该没有什么区别......或者是吗？

我对 Windows 平台上的 C++ 开发有点陌生，因此将不胜感激任何帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T23:35:33.497

您的错误是您没有将常量声明为*常量*。在 C++ 语法中（以及在 C 中）为了声明一个常量指针，你必须这样做

```
const char* const CLASS_NAME = "WinMain"; 
```

请注意，您的`GAME_TITLE`,`GAME_WIDTH`和`GAME_HEIGHT`被正确声明为常量，这就是它们不会给您带来麻烦的原因。只有`CLASS_NAME`被错误地声明，即作为非常量。

默认情况下，C++ 中的常量具有内部链接，这就是为什么您可以在头文件中定义它们而不会违反单一定义规则的原因。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-07T22:52:10.950

不要在标题中*定义变量。*当您在多个翻译单元中包含该标题时，您将拥有该定义的多个副本。

仅在此处*声明*变量（使用`extern`），并在一个翻译单元中精确定义它们。

也就是说......对于内置类型的常量，可以对这个规则进行例外处理，因为默认情况下它们具有内部链接。

也就是说，这两个程序在功能上是相同的：

```
const int x = 42;
int main() {} 
```

```
static const int x = 42;
int main() {} 
```

这可确保为*每个*翻译单元生成一份副本，从而完全避免该问题。

我*认为*数组也是如此。所以，当然，`const`它把自己击倒。

* * *

> 但据我所知 'char* x' 等价于 'char x[]',

仅在函数参数列表中。在一个成熟的声明中，`x`将采用由初始化程序确定维度的数组类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T22:52:42.437

您会收到错误消息，因为如果您将文件包含在多个编译单元中，您将在每个单元中声明该名称的变量。编译不是问题，但是当链接器尝试链接时，它会看到同一个变量的多个定义。你可以用`const int`变量来解决这个问题，`const char GAME_TITLE[]`因为它们有静态链接，但是对于字符串文字（本质上是`char`数组）你会得到这个错误。您应该能够使用`extern`

# ssl - LDAP SSL 访问

> ID：13772207
> 
> 赞同：0
> 
> 时间：2012-12-07T22:44:14.070
> 
> 标签：ssl, ldap, ssl-certificate

我有一个可以通过非 SSL 连接访问 LDAP 服务器的应用程序。现在，LDAP 服务器已配置为仅支持 SSL。那么，现在我必须做哪些新组件或现有组件的更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:06:40.413

如果您的应用程序确实不支持 SSL（顺便说一句，如果您告诉我们您要使用什么程序，事情会变得更容易），您可以尝试使用 SSL 包装器，例如可以配置为连接的[stunnel](https://www.stunnel.org/)每当您的程序连接到隧道的“入口”时，访问受 SSL 保护的 LDAP 服务。这样，您的程序不必支持 SSL，但您与 LDAP 服务器的连接仍受 SSL 保护（如果 SSL 包装器与您的程序在同一主机上运行）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:57:43.253

您只需在客户端中将 ldap: 更改为 ldaps: 即可。

# hibernate - 休眠查询导致 DB2 for Dates 上出现错误 181

> ID：13772210
> 
> 赞同：1
> 
> 时间：2012-12-07T22:44:27.943
> 
> 标签：hibernate, jpa, db2

我在 DB2 v9 上使用 Hibernate 4 和 JPA 2 的 CriteriaBuilder 来动态构建可以按日期过滤的查询。谓词的相关部分是...

```
criteriaBuilder.greaterThan(myRoot.get(MyEntity_.myDate), aDateValue) 
```

我的映射非常简单......

```
@Column(name="MY_DATE")
@Temporal(value = TemporalType.DATE)
public Date getMyDate() {
    return myDate;
} 
```

表上的列是类型`DATE`。当我运行具有此限制的查询时出现的错误是......

> org.hibernate.exception.DataException：DB2 SQL 错误：SQLCODE=-181，SQLSTATE=22007

如果我使用生成的 SQL 并在独立的 SQL 编辑器中运行它，它运行良好。我试过改变`TemporalType.TIMESTAMP`，但没有运气。我已经仔细检查了绑定输入在运行时是否有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T00:47:12.747

事实证明，如果`aDateValue`是类型`java.sql.Date`而不是`java.util.Date`错误消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-09T18:31:55.400

另一个对我有用的选择是添加

`@Type(type = "date")`

到实体中的 java.util.Date 字段。似乎 Hibernate 使用 Sql Timestamp 映射类型 java.util.Date 而当添加 Type 注释时，它被映射为 Date

# php - 由于 Ajax Shoutbox 导致 CPU 使用率高

> ID：13772212
> 
> 赞同：1
> 
> 时间：2012-12-07T22:44:35.183
> 
> 标签：php, javascript, ajax, cpu-usage

好的，所以我做了一个喊话框，我已经使用了一段时间，但是最近我注意到它因为对脚本的太多调用而消耗了 cpu 使用率，我想知道我怎么能去修复它的性能。

这是喊话框的 js 脚本。

```
var current_shouts = 0;
            function $shoutid(eleid) {
                return document.getElementById(eleid);
            }
            function urlencode(u) {
                u = u.toString();
                var matches = u.match(/[\x90-\xFF]/g);
                if (matches) {
                    for (var mid = 0; mid < matches.length; mid++) {
                        var char_code = matches[mid].charCodeAt(0);
                        u = u.replace(matches[mid], '%u00' + (char_code & 0xFF).toString(16).toUpperCase());
                    }
                }
                return escape(u).replace(/\+/g, "%2B");
            }
            function shouts() {
                clearTimeout(getshout);
                var xmlHttp = (window.XMLHttpRequest) ? new XMLHttpRequest : new ActiveXObject("Microsoft.XMLHTTP");
                xmlHttp.open("GET", "shoutbox/shouts.php?i=" + Math.random());
                xmlHttp.onreadystatechange = function() {
                    if (this.readyState == 4) {
                        if (parseInt(this.responseText) > current_shouts) {
                            getshouts();
                            current_shouts = parseInt(this.responseText);
                        }
                        getshout = setTimeout("shouts()", 1000);
                    }
                }
                xmlHttp.send(null);
            }
            function getshouts() {
                var xmlHttp = (window.XMLHttpRequest) ? new XMLHttpRequest : new ActiveXObject("Microsoft.XMLHTTP");
                xmlHttp.open("GET", "shoutbox/getshouts.php?i=" + Math.random());
                xmlHttp.onreadystatechange = function() {
                    if (this.readyState == 4) $shoutid("shoutbox").innerHTML = this.responseText;
$shoutid("shoutbox").scrollTop = $shoutid("shoutbox").scrollHeight;
                }
                xmlHttp.send(null);
            }
            function push_shout() {
                shout();
                return false;
            }
            function shout() {
                var xmlHttp = (window.XMLHttpRequest) ? new XMLHttpRequest : new ActiveXObject("Microsoft.XMLHTTP");
                xmlHttp.open("POST", "shoutbox/shout.php");
                var data = "user=" + urlencode($shoutid("user").value) + "&" + "shout=" + urlencode($shoutid("shout").value);
                xmlHttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                xmlHttp.setRequestHeader("Content-length", data.length);
                xmlHttp.onreadystatechange = function() {
                    if (this.readyState == 4) {
                        if (!this.responseText) $shoutid("shout").value = "";
                        else {
                            alert(this.responseText);
                        }
                        getshouts();
                    }
                }
                xmlHttp.send(data);
                return true;
            }
            var getshout = setTimeout("shouts()", 1000); 
```

当谈到 js 时，我并不是最聪明的蜡笔，所以我不确定如何解决这个问题。调用`shouts.php`是真正消耗我的 CPU 的东西。

这是脚本`shouts.php`

```
<?php
$db = new mysqli('localhost', 'username', 'pass', 'database');

if($db->connect_errno > 0){
   die('Unable to connect to database [' . $db->connect_error . ']');
}
    $stmt = $db->query("SELECT COUNT(id) FROM shout");
    while ($shout = $stmt->fetch_assoc()) {
    echo implode($shout);
    }
session_write_close();
?> 
```

我阅读了会话锁定问题，所以我添加了，`session_write_close();`但这似乎对我的问题没有帮助。

任何提示将非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:49:56.853

这是调整代码不一定会帮助一大堆的事情之一。您本质上是在 DDoS 攻击您自己的硬件。我在不久的将来的建议是将 javascript setTimeout 频率从`1000`to`2000`或更高。从长远来看：升级硬件，转向更快/更轻的存储解决方案（Redis 是我个人的最爱），两者都是明智的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:44:27.730

这是一些将缓存输出的基本代码，因此您无需进行太多处理。

```
$cachefile = 'mycache.txt';
$timeout = 5;

//if there is no cache, or the cache is older that the specified timeout
if( !file_exists($cachefile) || ( filemtime($cachefile) + $timeout < time() ) ) {
   //your existing code here!
   $shouttext = implode($shout);
   echo $shouttext;
   file_put_contents($cachefile, $shouttext);
} else {
   echo file_get_contents($cachefile);
} 
```

# c# - 如何在 C# 的 OpenFileDialog 中限制文件名修改

> ID：13772222
> 
> 赞同：3
> 
> 时间：2012-12-07T22:46:15.060
> 
> 标签：c#, openfiledialog

我有一个 C# .NET 3.5 程序，它使用`OpenFileDialog`检索要导入的文件。它有两个过滤器 (`*Domain*.*`和`*.*`)，并且`*Domain*.*`被选为`FilterIndex`。当在`OpenFileDialog`.

以下是用户将采取的重现问题的步骤：

1.  在程序中，打开`OpenFileDialog`. 确保过滤器设置为`*Domain*.*`。
2.  在与过滤器匹配的目录中查找文件并更改文件名，使其不再与过滤器匹配。*注意：该文件将消失。*
3.  更改过滤器以显示所有文件`*.*`。*注意：该文件未列出，即使您应该显示`*.*`.*

此时，您可以在 Windows 资源管理器中打开该文件夹，并看到更改名称的文件存在。但是，在 中`OpenFileDialog`，无论使用何种过滤器，它都不再可见。再次查看该文件的唯一方法是关闭`OpenFileDialog`然后重新打开它。

这是我创建`OpenFileDialog`.

```
using(OpenFileDialog domainFileDialog = new OpenFileDialog())
{
    domainFileDialog.CheckFileExists = true;
    domainFileDialog.CheckPathExists = true;
    domainFileDialog.Filter = "Domain Files (*Domain*.*)|*Domain*.*|All files (*.*)|*.*";
    domainFileDialog.FilterIndex = 1;
    domainFileDialog.Multiselect = false;
    domainFileDialog.RestoreDirectory = true;
    domainFileDialog.ShowReadOnly = true;
    domainFileDialog.SupportMultiDottedExtensions = true;
    domainFileDialog.Title = "Choose the Domain File to Import...";
    domainFileDialog.ValidateNames = true;

    \\ Perform Import functionality...
} 
```

似乎当您打开`OpenFileDialog`并修改与限制性更强的过滤器匹配的现有文件以使其不再匹配过滤器时，即使`*.*`显示所有文件，该文件也会从可见性中消失。

由于我不知道为什么会发生这种情况，（并且我愿意就如何修复它提出建议）有没有办法限制用户创建或修改任何文件以`OpenFileDialog`希望防止这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:24:34.783

首先，我建议您考虑是否值得关心用户可能会这样做。如果 FOD 这样做，则每个 Windows 应用程序都具有此功能，但您不会听到用户抱怨它。那么这真的是一个需要解决的问题吗？

如果问题与过滤器有关的不仅仅是文件扩展名，我不会感到惊讶 - 这样做是相当不寻常的。也许只尝试扩展，看看这是否是原因。

您是否尝试按 F5 刷新其缓存数据？我不知道这是否会像在资源管理器窗口中那样在 FOD 中工作，但尝试一下可能会很有趣。

说了这么多，过滤按键（F2）和鼠标点击（右键）将是微不足道的（使用某些形式，您可以从中派生，或者您可以放入 a `MessageFilter`）以使用户无法访问任何允许他们重命名 FOD 中的文件的 UI。作为用户，如果你以这种方式破坏了 FOD，这会让我很生气 - 无论如何，不​​仅仅是在极少数情况下重命名的文件“消失”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T22:57:31.130

[http://msdn.microsoft.com/en-us/library/microsoft.win32.openfiledialog.aspx](http://msdn.microsoft.com/en-us/library/microsoft.win32.openfiledialog.aspx)

OpenFileDialog 本身不支持任何此类功能。我认为此时最好的选择是编写自己的打开文件对话框窗口。通过这种方式，您将获得大量控制权，并且不会花费太长时间。

# c# - MonoDevelop 不显示 FluentNHibernate 的 dll 文档

> ID：13772223
> 
> 赞同：1
> 
> 时间：2012-12-07T22:46:20.850
> 
> 标签：c#, fluent-nhibernate, monodevelop, xmldocument

我遇到了一个让我完全困惑的问题，我已经尝试了我能想到的一切。

在 Linux 上使用来自 GitHub 上trunk 的 MonoDevelop，Xml 文档不起作用，但奇怪的是它适用于大多数 DLL，但不适用于 FluentNHibernate。

Ninject、Moq、NHibernate 和 MS 的 MVC 库工作正常，目前只是 FluentNHibernate。

我确实注意到 FluentNHibernate 的 Xml 文件有一个大写的扩展名，我更改了它，但它没有修复它。我还注意到我在目录中也有 pdb 文件，删除了它，仍然没有工作。

我不知道出了什么问题，因为所有其他人都在工作，只是那个，我找不到 xml 文件的问题。在程序集浏览器中查看 dll 后，我也看不出它们有什么不同。

欢迎任何想法，我会尝试任何东西。这也可能只是主干的一个错误，但我没有稳定的版本来尝试它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T22:55:32.740

我把它作为一个答案，这样我的步骤就在这里让所有人都能看到。

我不完全确定是什么解决了它，但这是我做的一些事情。

*   将文件扩展名重命名为小写
*   删除参考并重新输入
*   重新启动 MonoDevelop
*   重新启动机器

不知道他们中的哪一个修复了它...

# android - 安卓; 绘图+按钮

> ID：13772225
> 
> 赞同：0
> 
> 时间：2012-12-07T22:46:31.427
> 
> 标签：android

在这里很难解释我的目标，所以我会尽力而为。

假设我想在屏幕上画，四个正方形加起来一个大正方形，像这样；

```
 ____ ____
|    |    |
|____|____|
|    |    |
|____|____| 
```

一旦我得到这样的屏幕，我如何将这四个方块中的每一个都设置为按钮？多谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:02:10.457

这是表格布局的代码，可以帮助您：

```
<?xml version="1.0" encoding="utf-8"?>
    <TableLayout 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="center_horizontal"
    android:background="#FFFFFF" >

<TableRow
    android:id="@+id/tableRow1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >

    <ImageView
        android:id="@+id/button1"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/imageButton1 />

    <ImageView
        android:id="@+id/button1"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/imageButton2 />
  </TableRow>

<TableRow
    android:id="@+id/tableRow2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >

    <ImageView
        android:id="@+id/button3"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/imageButton3 />

    <ImageView
        android:id="@+id/button4"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/imageButton4 />
  </TableRow> 
```

您也可以使用 java 代码填充它

# python - 从 NumPy 数组排序 python 集

> ID：13772227
> 
> 赞同：3
> 
> 时间：2012-12-07T22:46:49.200
> 
> 标签：python, numpy, set

我无法弄清楚为什么我从 NumPy 数组中创建一个集合，Python 交换了元素的顺序：

```
import numpy as np
A = np.array([2])
B = np.array([2, 8])
setA = set(A)
setB = set(B)

In [6]: A
Out[6]: [2]

In [7]: B
Out[7]: [2, 8]

In [8]: setA
Out[8]: set([2])

In [9]: setB
Out[9]: set([8, 2])

In [10]: list(setA.union(setB))
Out[10]: [8, 2]

In [11]: np.union1d(A,B).tolist()
Out[11]: [2, 8] 
```

为什么我创建时不会维护订单`set(B)`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T22:49:43.300

`set`s 根据定义没有顺序 - 它们的创建是为了优化某些操作，例如那些测试遏制。因此，当您创建/添加元素到集合时，您永远不应该依赖订单保存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T22:51:01.550

集合[是唯一元素的无序集合](http://docs.python.org/library/sets.html)，因此 set([2,8]) 和 set([8, 2]) 完全相同。你为什么在乎？也许一套不是你需要的......

# css - Jquery-ajax 表单提交更改 css

> ID：13772230
> 
> 赞同：1
> 
> 时间：2012-12-07T22:47:01.140
> 
> 标签：css, jquery, coldfusion, coldfusion-9

我有一个带有几个 div 标签的 ColdFusion 页面。我正在执行 Ajax 提交以将 mxUnit 结果的结果集填充到另一个 div。

```
$.ajax({
    type: "POST",
    url: "myURL.cfm",
    data: $dataToPass,
    success: function(data) {
        $('#testResults').html(data);
    }
});
return false; 
```

当结果显示在我的#testResults div 中时，它会弄乱我左列中的所有 css。关于避免这种情况的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T19:10:02.030

这是返回的 html 页面的问题。我检查了返回的 html 页面并将其呈现在 jsFiddle 中。它有一些自己的 CSS 与我的冲突。

感谢所有的评论。

# winforms - 如何更改 DataGridView 中某些单元格的边框颜色？

> ID：13772239
> 
> 赞同：6
> 
> 时间：2012-12-07T22:48:01.417
> 
> 标签：winforms, datagridview

我需要编程更改 CellFormatting 事件中某些单元格的边框颜色。可以更改单个单元格的板颜色吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-02-10T19:49:42.823

你可以画一个矩形。在此示例中，我在选定的单元格上放置了一个红色边框。

```
private void dataGridView_CellPainting(object sender, DataGridViewCellPaintingEventArgs e)
{
    if (e.RowIndex >= 0 && e.ColumnIndex >= 0)
    {
        if (dataGridView.Rows[e.RowIndex].Cells[e.ColumnIndex].Selected == true)
        {
            e.Paint(e.CellBounds, DataGridViewPaintParts.All & ~DataGridViewPaintParts.Border);
            using (Pen p = new Pen(Color.Red, 1))
            {
                Rectangle rect = e.CellBounds;
                rect.Width -= 2;
                rect.Height -= 2;
                e.Graphics.DrawRectangle(p, rect);
            }
            e.Handled = true;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-23T01:56:59.510

MSDN 描述了一种可以从 DataGridView 继承来覆盖默认边框样式的方法：[DataGridViewAdvancedBorderStyle 类](https://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewadvancedborderstyle(v=vs.110).aspx)

不过，上面的绘画方法更简单。

# android - Android Camera PreviewCallback 未在 4.1 中调用

> ID：13772242
> 
> 赞同：5
> 
> 时间：2012-12-07T22:48:18.573
> 
> 标签：android, video, callback, camera, frame

我有一个应用程序来获取带有表面的相机预览帧。它在 Android 4.0.4 上运行，但在更新后不能在同一设备上与 Jelly Bean 4.1.2 一起运行。简单地说，回调永远不会被回调。这是代码： 剪掉一点：

```
public class Panel extends Activity {
    Camera myCamera;
    int cameraId = -1;
    MyCameraSurfaceView myCameraSurfaceView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_panel);

        myCamera = getCameraInstance();
        myCamera.setPreviewCallback(new Camera.PreviewCallback() {
            @Override
            public void onPreviewFrame(byte[] data, Camera camera) {
                Log.d("Camera Preview", data.length + "");
            }
        });

        myCameraSurfaceView = new MyCameraSurfaceView(this, myCamera);
        FrameLayout myCameraPreview = (FrameLayout) findViewById(R.id.videoview);
        myCameraPreview.addView(myCameraSurfaceView);
    }

    private Camera getCameraInstance() {
        Camera c = null;
        try {
            c = Camera.open();
        } catch (Exception e) {
            e.printStackTrace();
        }
        return c;
    }

    public class MyCameraSurfaceView extends SurfaceView implements
            SurfaceHolder.Callback {

        private SurfaceHolder mHolder;
        private Camera mCamera;

        public MyCameraSurfaceView(Context context, Camera camera) {
            super(context);
            mCamera = camera;
            mHolder = getHolder();
            mHolder.addCallback(this);
        }

        @Override
        public void surfaceCreated(SurfaceHolder holder) {
            try {
                mCamera.setPreviewDisplay(holder);
                mCamera.startPreview();
            } catch (IOException e) {
            }
        }
    }
} 
```

视频帧正在活动中显示，所以我无法弄清楚我做错了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T21:15:45.823

我已经使用另一个教程重写了代码。它工作，但现在更慢。我不知道确切的原因（可能是由于我使用的 N7000 ROM 泄漏，可能有错误或在 4.1 中实现方式不同，不确定）

CameraPreview.java

```
public class CameraPreview implements SurfaceHolder.Callback,
        Camera.PreviewCallback {
    int PreviewSizeWidth;
    int PreviewSizeHeight;
    SurfaceHolder mSurfHolder;
    Camera mCamera;

    public CameraPreview(int PreviewlayoutWidth, int PreviewlayoutHeight) {
        PreviewSizeWidth = PreviewlayoutWidth;
        PreviewSizeHeight = PreviewlayoutHeight;
    }

    @Override
    public void onPreviewFrame(byte[] data, Camera camera) {
        Parameters p = camera.getParameters();  
        int width = p.getPreviewSize().width;
        int height = p.getPreviewSize().height;

        ByteArrayOutputStream outstr = new ByteArrayOutputStream();
        Rect rect = new Rect(0, 0, width, height);
        YuvImage yuvimage = new YuvImage(data, ImageFormat.NV21, width,
                height, null);
        yuvimage.compressToJpeg(rect, 80, outstr); // outstr contains image in jpeg  
        String encodedImage = Base64.encodeToString(
                outstr.toByteArray(), Base64.DEFAULT); // this is base64 encoding of image

    }

    @Override
    public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3) {
        Parameters parameters;
        mSurfHolder = arg0;

        parameters = mCamera.getParameters();
        parameters.setPreviewSize(PreviewSizeWidth, PreviewSizeHeight);

        mCamera.setParameters(parameters);
        mCamera.startPreview();
    }

    public void surfaceCreated(SurfaceHolder arg0) {
        mCamera = Camera.open();
        try {
            // If did not set the SurfaceHolder, the preview area will be black.
            mCamera.setPreviewDisplay(arg0);
            mCamera.setPreviewCallback(this);
            Parameters p = mCamera.getParameters();
            p.setPreviewSize(PreviewSizeWidth, PreviewSizeHeight);
            mCamera.setParameters(p);
        } catch (IOException e) {
            mCamera.release();
            mCamera = null;
        }
    }

    @Override
    public void surfaceDestroyed(SurfaceHolder arg0) {
        mCamera.setPreviewCallback(null);
        mCamera.stopPreview();
        mCamera.release();
        mCamera = null;
    }
} 
```

PanelActivity.java

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_panel);

    SurfaceView camView = new SurfaceView(this);
    SurfaceHolder camHolder = camView.getHolder();
    int width = 352; // must set a compatible value, otherwise it gets the default width and height
    int height = 288;

    camPreview = new CameraPreview(width, height);

    camHolder.addCallback(camPreview);
    camHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

    mainLayout = (FrameLayout) findViewById(R.id.videoview);
    mainLayout.addView(camView, new LayoutParams(width, height));

} 
```

# android - Google Play 不包括设备

> ID：13772245
> 
> 赞同：2
> 
> 时间：2012-12-07T22:48:38.037
> 
> 标签：android, google-play, android-manifest

我有以下内容`AndroidManifest.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="my.app"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="7"
    android:targetSdkVersion="17" />

<supports-screens
    android:anyDensity="true"
    android:largeScreens="true"
    android:normalScreens="true"
    android:smallScreens="true"
    android:xlargeScreens="true" />

<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.WAKE_LOCK" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.GET_ACCOUNTS" />
<uses-permission android:name="android.permission.USE_CREDENTIALS" />
<uses-permission android:name="android.permission.CAMERA" />
<uses-permission android:name="android.permission.VIBRATE" />

    <activity
        android:name=".MainActivity"
        android:configChanges="orientation|keyboardHidden|screenSize"
        android:label="@string/app_name"
        android:theme="@style/Theme.Transparent" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name="my.app.layouts.Dashboard"
        android:configChanges="keyboardHidden"
        android:label="@string/app_name" >
    </activity>
    <activity
        android:name="com.google.zxing.client.android.CaptureActivity"
        android:configChanges="orientation|keyboardHidden"
        android:exported="false"
        android:screenOrientation="landscape"
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
        android:windowSoftInputMode="stateAlwaysHidden" >
        <intent-filter>
            <action android:name="com.google.zxing.client.android.SCAN" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
</application> 
```

如您所见，它使用 ZXing 库来读取条形码。但是，该应用程序并未在 Google Play 的某些设备（例如 Nexus 7）上显示。我如何包含所有设备，因为我在应用程序本身内部进行了错误处理（例如，如果相机不可用，则显示对话框等）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T22:54:13.663

最后使用`uses-feature`这个：`android:required="false"`

此外，我不确定您是否`any-density`需要`AndroidManifest`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T22:51:12.330

而不是`uses-permission`使用`uses-feature`并将标志设置为可选

使用权限将使用功能默认设置为必需

# emacs - 在 SLIME 调试器中检查局部变量的值？

> ID：13772246
> 
> 赞同：5
> 
> 时间：2012-12-07T22:48:46.233
> 
> 标签：emacs, common-lisp, slime

我正在寻找一种更好的技术来做到这一点。我的一般斗争是调试器进入太晚或太早而无法捕捉变量值的事实。

我首先尝试的是：

```
(loop for i from 0 to 10 do
  (break)) 
```

当调试器进入中断时，我无法访问`i`:(所以这是一种浪费的努力。我已经尝试过`e`调试器的选项（框架中的eval），但SLIME通常只是出错，我必须重新连接到SWANK。`v`或者`t`不要' t 帮助，因为变量只是“不存在”。

我最终做了什么：

```
(loop for i from 0 to 10 do
  (signal i)) 
```

这很愚蠢，但很有效，因为它放在`i`了我可以在调试器中检查的帧的堆栈上。但这只是……好吧，从最糟糕的意义上来说，这是骇人听闻的。是不是有某种方法可以“观察”一个变量，或者有一种更有意义的方式来放置断点，这样我就可以在输入断点的地方看到更多的变量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T21:28:11.607

你的第一个片段对我来说很好用 CCL（默认[`optimize`](http://www.lispworks.com/documentation/HyperSpec/Body/d_optimi.htm)设置）、Emacs 24 和最近提取的 Slime：

```
Break
   [Condition of type SIMPLE-CONDITION]

Restarts:
 0: [CONTINUE] Return from BREAK.
 1: [RETRY] Retry SLIME REPL evaluation request.
 2: [*ABORT] Return to SLIME's top level.
 3: [ABORT-BREAK] Reset this thread
 4: [ABORT] Kill this thread

Backtrace:
  0: (#<Anonymous Function #x186F9B7E>)
      Locals:
        I = 0
  1: (CCL::CHEAP-EVAL (LOOP FOR I FROM 0 TO 10 DO (BREAK)))

⋮ 
```

`sldb-eval-in-frame`对我也很好。也许你应该尝试不同的 Lisp 实现或不同版本的 Slime。

另外，请注意不同的[`optimize`](http://www.lispworks.com/documentation/HyperSpec/Body/d_optimi.htm)设置在这里可能很重要，并且某些实现为解释代码提供了更好的调试结果（如果有解释器可用）。尝试类似的东西`(declaim (optimize (debug 3) (speed 0) (space 0)))`。

# orchardcms - Orchard CMS-获取当前数据迁移记录版本号

> ID：13772247
> 
> 赞同：1
> 
> 时间：2012-12-07T22:48:56.930
> 
> 标签：orchardcms

给定 Migrations 类的名称作为字符串，如何获取存储在 Orchard_Framework_DataMigrationRecord 中的当前版本号？

我可以在 IExtensionManager 中看到版本，但这似乎只是 module.txt 中定义的模块版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T12:58:02.550

好的，所以我自己解决了这个问题-

我知道 Orchard 在触发迁移方法时一定已经在执行与我需要的代码类似的代码，因此我创建了一个新的迁移文件，并在 Create() 方法上放置了一个断点。当断点命中时，我通过调用堆栈查找 Orchard.Data.Migration 中的 DataMigrationManager。我需要的一切都在那里，如果其他人有类似的要求，我建议他们以该课程为起点。

这几乎是直接从该课程中提取出来的：

```
 string moduleName="Your.Module.Name";
        var migrations = GetDataMigrations(moduleName);

        // apply update methods to each migration class for the module
        var current = 0;
        foreach (var migration in migrations)
        {
            // copy the objet for the Linq query
            var tempMigration = migration;

            // get current version for this migration
            var dataMigrationRecord = GetDataMigrationRecord(tempMigration);

            if (dataMigrationRecord != null)
            {
                current = dataMigrationRecord.Version.Value;
            }

            // do we need to call Create() ?
            if (current == 0)
            {
                // try to resolve a Create method

                var createMethod = GetCreateMethod(migration);
                if (createMethod != null)
                {
                    //create method has been written, but not executed!
                    current = (int)createMethod.Invoke(migration, new object[0]);
                }
            }
        }
        Context.Output.WriteLine("Version: {0}", current); 
```

您可能需要的几种方法：

```
 private DataMigrationRecord GetDataMigrationRecord(IDataMigration tempMigration)
    {
        return _dataMigrationRepository.Table
            .Where(dm => dm.DataMigrationClass == tempMigration.GetType().FullName)
            .FirstOrDefault();
    }

    private static MethodInfo GetCreateMethod(IDataMigration dataMigration)
    {
        var methodInfo = dataMigration.GetType().GetMethod("Create", BindingFlags.Public | BindingFlags.Instance);
        if (methodInfo != null && methodInfo.ReturnType == typeof(int))
        {
            return methodInfo;
        }

        return null;
    } 
```

不要忘记注入您可能需要的任何依赖项。

# ruby-on-rails - Rails 部分不通过 ajax 调用呈现

> ID：13772248
> 
> 赞同：0
> 
> 时间：2012-12-07T22:48:59.860
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

当用户单击破坏两个产品之间关系的按钮时，我试图通过 ajax 呈现部分内容。破坏动作有效，但我无法使部分渲染工作。

部分呈现在产品的编辑页面上：

**编辑.html.erb**

```
<div id="relationship_form">
  <%= render "relationships", product: @product %>
</div> 
```

**_relationships.html.erb**

```
<%= render "unrelate", relationship: relationship %> 
```

**_unrelate.html.erb**

```
<%= form_for(relationship,html: { method: :delete },remote: true) do |f| %>
  <%= f.submit "Remove", class: "btn btn-small" %>
<% end %> 
```

**关系控制器.html.erb**

```
def destroy
...
 respond_to do |format|
  format.html { redirect_to edit_product_path }
  format.js
 end
end 
```

**销毁.js.erb**

```
$("#relationship_form").html("<%= escape_javascript(render :partial => 'products/relationships', :locals => {:product => @product}) %>"); 
```

我已经通过插入警报检查了ajax调用是否通过了destroy.js.erb，所以javascript中一定有错误吗？

**更新**：

我通过将 _unrelate 部分中的表单移动到 _relationship 部分来使其工作。仍然不清楚为什么它使它起作用。

**_relationships.html.erb**

```
<%= form_for(relationship,html: { method: :delete },remote: true) do |f| %>
  <%= f.submit "Remove", class: "btn btn-small" %>
<% end %> 
```

# javascript - paper.js union 的异同交集

> ID：13772258
> 
> 赞同：5
> 
> 时间：2012-12-07T22:49:50.740
> 
> 标签：javascript, canvas, svg, vector-graphics, inkscape

我正在 paper.js 中的一个项目上工作，我需要根据其他两个的交集、差异和联合创建新路径。我做了一些挖掘，发现了插入三次贝塞尔样条曲线的数学函数，但我想知道是否有任何 javascript 库可以进行类似 svg 的矢量算术。如果有的话，我会复制 inkscape 并将其转换为 javascript，但你永远不知道。无论如何，用于插值三次贝塞尔曲线的数学函数如下：

```
Pointx = (Ax * percent^3) + (Bx * 3 * (percent^2 * (1-percent))) + (Cx * 3 * (percent * (1-percent)^2)) + (Dx * (1-percent)^3)
Pointy = (Ay * percent^3) + (By * 3 * (percent^2 * (1-percent))) + (Cy * 3 * (percent * (1-percent)^2)) + (Dy * (1-percent)^3) 
```

其中 A、B、C 和 D 是曲线的点。A 是起点，D 是终点，B 和 C 是操纵 A 和 D 之间曲率的“控制点”。这`percent`是在从 0 到 1 的范围内沿曲线计算多远。

因此，想出一个插值函数来返回一个提供的贝塞尔曲线的点和沿着贝塞尔曲线的百分比是非常简单的。找到倒数 - 给定点（或 x 值或 y 值）的百分比将是困难的。或者更困难的是，两个贝塞尔曲线相交（我不太擅长数学）。我希望这就是inkscape的功能所提供的。

有没有可以快速进行这种矢量插值的 javascript 库？如果没有，我会在这里发布我提出的算法。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-18T10:12:58.053

您正在寻找的是所谓*[的多边形布尔运算](http://en.wikipedia.org/wiki/Boolean_operations_on_polygons)*

Paper.js 现在似乎使用了相当不错的 BoolOps，它们直接处理贝塞尔曲线。如果你问我，这应该是首选。这是一个很好的[例子](http://paperjs.org/examples/boolean-operations/)。

[在另一种情况下，您可以使用De-Casteljau 算法](https://gist.github.com/Phrogz/845901)对形状进行多边形化，并将它们输入到[Javascript Clipper](http://sourceforge.net/p/jsclipper/wiki/Home/)中。如果您使用高采样，则视觉结果与真实曲线相同，但您会失去路径的弯曲特性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T22:56:46.683

虽然我不会说这是一个重复的问题，但我相信您会从这个[问题](https://stackoverflow.com/questions/7008006/draw-good-looking-bezier-curve-through-random-points)的答案中找到深刻的见解，因为它非常相似。

我确实在这里找到了该问题的答案中未提及的另一种资源：http: [//13thparallel.com/archive/bezier-curves/](http://13thparallel.com/archive/bezier-curves/)

除此之外，该问题中提到的最佳资源在这里： [http ://blog.mackerron.com/2011/01/01/javascript-cubic-splines/](http://blog.mackerron.com/2011/01/01/javascript-cubic-splines/)

这两个资源都详细说明了可以满足您的需求的特定功能。虽然它们不是完全“库”，但代码将很容易地移植到您的项目中以供您使用。

# mips - 在 mips 中查找子字符串和索引

> ID：13772260
> 
> 赞同：0
> 
> 时间：2012-12-07T22:50:06.260
> 
> 标签：mips, mips32, spim

我试图找出子字符串和第一次出现的索引。但有些不对劲。我比较模式数组的每个元素和字符串数组的每个元素，直到指针到达'\ 0'。有什么问题。算法完全错误？

```
#Note: $v0 is a symbolic name used by the assember for $2.
#      $a0 is a symbolic name used by the assember for $4.

          .data

prompt_str:     .asciiz  "Please type a text string: "
prompt_ptr: .asciiz  "Please type a pattern string: "
print_yes:  .asciiz  "Yes, there is a match."
print_no:   .asciiz  "No, there is no match."
text_str:   .asciiz  "Text string : "
pattern_str:    .asciiz  "Pattern string : "
print_out:      .asciiz  "Output to be produced :"
print_dash:     .asciiz  "----------------------"
print_index:    .asciiz  "Starting index :"
print_msg :     .asciiz  "Length of longest partial match = "
nl:             .asciiz  "\n"
print_outer:    .asciiz  "please enter string"    
str :       .space  81
ptr :       .space  81
tmp :       .space  81
          .text

main:   la  $a0, prompt_str   
        li  $v0, 4          #print_string command.
        syscall

        la  $a0,str   #read string
    li  $a1,81
    li  $v0,8
    syscall

    la  $t0,str     #move string to $t0

    la  $a0,prompt_ptr
    li  $v0,4       #print pattern command
    syscall

    la  $a0,ptr     #read pattern
    li  $a1,81
    li  $v0,8
    syscall

    la  $t1,ptr     #move pattern to $t1    

    lb  $t2,0($t0)  #pointer first element array of string
    move    $t4,$t2     #address pointer of $t2
    lb  $t3,0($t1)  #pointer first element array of pattern

outer_loop :    beq $t2,$0,end_outer_loop
        j   inner_loop  

inner_loop :    beq $t2,$0,end_inner_loop
        beq $t3,$0,end_inner_loop
        beq $t2,$t3,end_inner_loop
        addiu   $t2,$t2,1
        addiu   $t3,$t3,1
        j   inner_loop

end_inner_loop :bne $t3,$0,inc_ptr
        j   print_match

inc_ptr :   add $t2,$t4,1   
        j   outer_loop

end_outer_loop :la  $a0,print_outer
        li  $v0,4
        syscall

print_match :   la  $a0,text_str    #print string
        li  $v0,4
        syscall
        move    $a0,$t0
        li  $v0,4
        syscall

        la  $a0,nl      #print newline character
        li  $v0,4
        syscall

        la  $a0,pattern_str #print pattern string
        li  $v0,4
        syscall
        move    $a0,$t1
        li  $v0,4
        syscall

        la  $a0,nl      #print newline character
        li  $v0,4
        syscall         

        la  $a0,print_out   #print output line and newline character
        li  $v0,4
        syscall
        la  $a0,nl
        li  $v0,4
        syscall

        la  $a0,print_dash
        li  $v0,4
        syscall
        la  $a0,print_yes
        li  $v0,4
        syscall
        la  $a0,print_index     #print starting index
        li  $v0,4
        syscall
        li  $v0,10
        syscall

end_loop :  li  $v0,10
        syscall 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-17T02:06:06.813

我将您的代码用于类似的项目，在inner_loop中您没有合适的代码，`bne` 我只放了一个`bne`，现在它只打印带有子字符串的字符串..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-20T13:31:06.020

```
.text
.globl main

main:
    li $v0, 4
    la $a0, msg1
    syscall

    li $v0, 8
    la $a0, strMain
    li $a1, 99
    syscall

    li $v0, 4
    la $a0, msg2
    syscall

    li $v0, 8
    la $a0, strSub
    li $a1, 99
    syscall

    la $a0,strMain
    jal findLengthString
    move $a2, $v0

    la $a0, strSub
    jal findLengthString
    move $a3, $v0 # M
    sub $a2, $a2, $a3 # N-M

    la $a0, strMain
    la $a1, strSub 

    jal subStringMatch
    move $t1, $v0

    li $v0, 1
    move $a0, $t1
    syscall

exit:
    li $v0, 10
    syscall

    lb $t9, endline

findLengthString:
    li $t0, -1
    move $s0, $a0

    loop_fls:
        lb $t1, 0($s0)
        beq $t1, $t9, foundLength

        addi $t0, $t0, 1
        addi $s0, $s0, 1
        j loop_fls

    foundLength:
        move $v0, $t0
        jr $ra

subStringMatch:
    li $t0, 0 #i
    loop1:
        bgt $t0,$a2, loop1done  
        li $t1, 0 #j
        loop2:
            bge $t1, $a3, loop2done
            add $t3, $t0, $t1
            add $t4, $a0, $t3
            lb $t3, 0($t4) # main[i+j] 

            add $t4, $a1, $t1
            lb $t4, 0($t4) # sub[j]
            # if a0[i + j] != a1[j]
            bne $t3, $t4, break1

            addi $t1, $t1, 1
            j loop2
        loop2done:
            beq $t1, $a3, yesReturn
            j break1
        yesReturn:
            move $v0, $t0
            jr $ra
    break1:
        addi $t0, $t0, 1
        j loop1
    loop1done:
        li $v0, -1
        jr $ra

.data

msg1: .asciiz "Enter Main String: "
msg2: .asciiz "Enter String to Check SubString: "

strMain: .space 100
strSub: .space 100
endline: .asciiz "\n" 
```

# matlab - 对向量进行排序并计算相同的出现次数

> ID：13772267
> 
> 赞同：3
> 
> 时间：2012-12-07T22:50:50.350
> 
> 标签：matlab, sorting, unique

什么是执行以下操作的 Matlab 高效方式（无循环）：将输入向量*输入*转换为输出向量*输出*，例如*输出*(i) 是输入中小于或等于*输入*(i)的整数个数.

例如：

```
input = [5 3 3 2 4 4 4] 
```

会给：

```
output = [7 3 3 1 6 6 6] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:38:58.613

我找到了一个可能的答案：

```
output = arrayfun(@(x) sum(x>=input),input) 
```

但它没有利用矢量化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T00:36:14.757

首先，不要[`input`](http://www.mathworks.com/help/matlab/ref/input.html)用于变量名，它是一个保留关键字。我将`X`在这里使用。

获得所需结果的另一种方法是：

```
[U, V] = meshgrid(1:numel(X), 1:numel(X));
Y = sum(X(U) >= X(V)) 
```

这是一个单行：

```
Y = sum(bsxfun(@ge, X, X')) 
```

**编辑：**
如果`X`有多行并且您想在每一行上应用此操作，这有点棘手。以下是您可以执行的操作：

```
[U, V] = meshgrid(1:numel(X), 1:size(X, 2));
V = V + size(X, 2) * idivide(U - 1, size(X, 2));
Xt = X';
Y = reshape(sum(Xt(U) >= Xt(V))', size(Xt))' 
```

例子：

```
X =  
   5   3   3   2   4   4   4
   3   9   7   7   1   2   2

Y = 
   7   3   3   1   6   6   6
   4   7   6   6   1   3   3 
```

# c - strcat() 不会退出

> ID：13772270
> 
> 赞同：0
> 
> 时间：2012-12-07T22:50:55.710
> 
> 标签：c, strcat

我正在尝试用 C 实现一个非常基本的服务器，其中一部分是构建 HTTP 标头。为此，我编写了一个名为 header_builder 的类，它基本上为我构建了标题。该类最基本的方法之一是append_header_line，如下所示：

```
void append_header_line( const char *line, char *hdr ) {
  printf("Adding header line\n");
  strcat( hdr, line );
  printf("Line added. Adding ending.\n");
  strcat( hdr, "\r\n" );  
  printf("Success\n");
} 
```

它应该做的就是将“line”参数添加到“hdr”参数的末尾，然后将“\r\n”添加到所有参数的末尾。问题是第一个 strcat 调用永远不会退出。当我运行这段代码时，它所做的只是说：

添加标题行

这意味着以下几行永远不会执行，我不知道为什么。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T22:53:30.010

`hdr`和/或未`line`正确归零，因此`strcat`一直运行到超出范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T22:54:27.330

`hdr`当函数被调用时，可能其中一个（或两个）`line`不是以 nul 结尾的 C 字符串。特别是不要忘记，在添加第一个标头之前，您需要`hdr`使用`hdr[0] = 0;`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T23:02:09.863

strcat 在目标中需要一个空字符，它将继续用源的第一个字符替换目标的第一个字符。检查 hdr 是否正确初始化。 [http://www.cplusplus.com/reference/cstring/strcat/](http://www.cplusplus.com/reference/cstring/strcat/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T22:53:44.573

我猜想其中一个字符串缺少它的空终止符。

# authentication - WebLogic (JAAS) 中的程序化登录（身份验证）

> ID：13772274
> 
> 赞同：3
> 
> 时间：2012-12-07T22:51:26.233
> 
> 标签：authentication, weblogic, jaas

我们有一个在 WebLogic 下运行的现有 Java EE 应用程序，我想以编程方式对用户进行身份验证，就好像用户通过现有的 Web 登录过程登录一样。也就是说，最后，我希望有一个有效的会话（cookie），可以返回给调用者，然后返回服务器而不需要重新认证。（这是为了启用 JAX-WS 有状态 Web 服务调用）。

我们有一个自定义的 LoginModule，当用户通过 Forms Authentication 登录时，最终会通过 j_security_check 调用它。我想我想做的是以某种方式让 WebLogic 代表我调用该 LoginModule，向我询问凭据，并产生一个经过身份验证的会话和一个有效的主题等（即所有 JAAS 优点）。

这是 JAAS 的事情吗？有 WebLogic 调用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:06:39.860

您可以使用[HttpServletRequest#login](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#login%28java.lang.String,%20java.lang.String%29)方法执行此操作。如果您使用访问受保护的资源，这将触发相同类型的登录链，否则将执行该登录链。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-30T14:13:28.537

WebLogic 安全性使用安全服务插件 (SSPI) 体系结构，允许您实施安全提供程序。容器（例如 servlet）身份验证由使用 SSPI 的身份验证提供程序处理。身份验证提供程序包装了一个 JAAS 登录模块。

编写和配置安全提供程序有[大量文档](http://docs.oracle.com/middleware/1213/wls/DEVSP/index.html)。

如果您实现一个身份验证提供程序来包装您的登录模块并为 WebLogic 域配置它，那么 WebLogic 安全框架将自动调用它来进行所有容器身份验证。

# c# - TransactionScope、EF DbContext 和脏读

> ID：13772276
> 
> 赞同：1
> 
> 时间：2012-12-07T22:51:35.113
> 
> 标签：c#, entity-framework-4, transactionscope

在过去的几个小时里，我一直在谷歌搜索答案，但还没有找到答案，所以我希望这里有人能指出我正确的方向。

我想知道如何在 TransactionScope 中使用 EF DbContext（代码优先）进行脏读。例如

```
DbContext context = new MyEntities();
using(TransactionScope scope = new TransactionScope())
{
    context.SomeTable.Add(someObject);
    context.SaveChanges();

    var objects = context.SomeTable.Where(...).Select(...); //times out here on the read, because the write above locks the tables
    //modify each object
    context.SaveChanges();

    scope.Complete(); //transaction is a success only if the entire batch succeeds
} 
```

我尝试使用以下内容包装读取调用：

```
using(TransactionScope scope2 = new TransactionScope(TransactionScopeOption.RequiresNew, new TransactionOptions{IsolationLEvel = IsolationLevel.ReadUncommitted}))
{
    var objects = context.SomeTable.Where(...).Select(...); //times out here on the 
} 
```

什么是正确的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T14:13:22.830

它终于让我明白了问题所在：EF 没有`TransactionScope`像 L2S 那样很好地集成。这意味着 EF 为需要服务器的每个操作打开和关闭连接（保存更改或查询）。

这为您提供分布式事务和分布式死锁。

要解决此问题，请手动打开和关闭 EF `StoreConnection`，以确保在事务期间只有一个连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T15:12:45.040

您可以像这样为 TransactionScope 设置 IsolationLevel ...

```
var transactionOptions = new System.Transactions.TransactionOptions();
transactionOptions.Timeout = new TimeSpan(0, 0, 30);
transactionOptions.IsolationLevel = System.Transactions.IsolationLevel.ReadUncommitted;
using (var transactionScope = new System.Transactions.TransactionScope(System.Transactions.TransactionScopeOption.Required, transactionOptions))
{
...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T23:20:40.077

您可以只`alter database your_db_name set READ_COMMITTED_SNAPSHOT on;`在服务器上执行（可从 SQLServer 2005 获得），并且读取器不会被写入程序阻塞（假设在`read committed`隔离级别读取事务）。

# java - 在 Tomcat 上部署应用程序

> ID：13772277
> 
> 赞同：0
> 
> 时间：2012-12-07T22:51:34.960
> 
> 标签：java, tomcat

我正在尝试从 RoseIndia 运行示例应用程序：

[http://www.roseindia.net/jsf/SimpleHelloByEnteringName.shtml](http://www.roseindia.net/jsf/SimpleHelloByEnteringName.shtml)

我下载了源代码，并将该文件夹放在 webapps 文件夹中，如图所示。我是否必须从应用程序创建一个 .war 或 .jar 并将其放在 webapps 文件夹中的某个位置才能运行应用程序？

# grails - Grails 项目在运行时不会从其自己的 lib 目录中的库中解析依赖关系

> ID：13772288
> 
> 赞同：0
> 
> 时间：2012-12-07T22:52:59.127
> 
> 标签：grails, ivy, dependency-management

女士们先生们，

我有一个非常简单的 grails 应用程序，我需要通过直接类依赖 API 调用来调用我们公司的平台 API。

我[在 Stack 上](http://goo.gl/UCJ1o)有一个悬而未决的问题。它与 Grails 项目的依赖管理有关。虽然我无法解决这个问题，但我将我们的内部工件转储到 grails 项目的 lib 目录中。我们的工件内置了 Ivy 依赖文件，所以我只指定了“根”jar，希望 Grails 依赖管理能够使用传递依赖解决其余的问题。我为依赖项指定了“运行时”。

该应用程序似乎很好地解决了依赖关系，但在一定程度上。例如，它解析 jar A 中的 A、B、C、D 等类。它解析 jar B 中的 A 类，但不解析 jar B 中的 B 类。B 类在 A 类中被引用，但我得到一个“ClassNotFoundException " B 类的消息。

问题：我在为项目指定依赖项时做错了什么？为什么 Grails 运行时资助 jar B 中的 A 类而不资助 B 类？我可以很容易地在 Eclipse 中查看 B 类，它在与 A 类完全相同的 jar 中找到它。什么给出了？

干杯，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:59:31.033

每当你把一个新罐子放进去`lib`时，你必须做

```
grails compile --refresh-dependencies 
```

让 Grails 看到它。

# java - 我如何依赖来自 maven 的一组版本中的所有工件？

> ID：13772290
> 
> 赞同：6
> 
> 时间：2012-12-07T22:53:01.243
> 
> 标签：java, maven, lucene

我是 Maven 新手，我正在尝试第一次构建一个项目。我想写一些依赖于 apache lucene 的代码。这是我正在尝试获取[的 Maven 中的工件列表。](http://mvnrepository.com/artifact/org.apache.lucene)

有什么方法可以简单地依赖给定版本的所有工件，而不是明确列出每个工件？我试过这个：

```
<dependency>
  <groupId>org.apache.lucene</groupId>
  <artifactId>*</artifactId>
  <version>3.6.1</version>
</dependency> 
```

这给了我错误

> org.apache.lucene: 的 'dependencies.dependency.artifactId'*值为 '* ' 的 jar 与有效的 id 模式不匹配。@ 第 19 行，第 19 列

当我明确声明依赖项时，我可以验证是否可以下载依赖项。IE 这工作正常：

```
<dependency>
  <groupId>org.apache.lucene</groupId>
  <artifactId>lucene-core</artifactId>
  <version>3.6.1</version>
</dependency> 
```

我意识到依赖于 lucene 中的所有内容可能不是最理想的，但是为了做一些快速而肮脏的事情，我讨厌不得不手动填充所有这些小 lucene 库。在 maven 中获取大量相关依赖项的典型做法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T22:59:36.323

简短的回答：**你不能**。请记住，您只需执行一次，然后您可以简单地复制粘贴依赖项（虽然不是很干燥）。还可以考虑创建一个原型，该原型将快速创建具有所有必需依赖项的骨架（用于快速和肮脏的项目）。

更长的答案：嗯，你可以解决这个问题。创建一个单独`pom.xml`的：

```
<packaging>pom</packaging> 
```

并在那里手动声明所有 Lucene 依赖项，一个接一个。一劳永逸。稍后您可以简单地向您的`pom.xml`（即在此处定义的`groupId`// `artifactId`）添加一个依赖项，该依赖`version`项将传递包含 that 的所有依赖项`pom.xml`。

谈到传递性：如果你在 maven 中依赖一个 JAR，并且这个 JAR 有其他依赖项，你就会隐式地得到传递依赖项。检查 Lucene `pom`，也许只导入少数几个并依赖传递依赖就足够了？

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2017-04-06T18:58:23.877

在 groupId 的单个依赖项中添加不同的 artifactId

```
<dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-beans</artifactId>
        <artifactId>spring-context</artifactId>
        <artifactId>spring-beans</artifactId>
        <version>4.3.7.RELEASE</version>
    </dependency> 
```

# java - 需要帮助找出为什么会发生此错误

> ID：13772300
> 
> 赞同：0
> 
> 时间：2012-12-07T22:53:58.563
> 
> 标签：java

我的代码是这样的：

```
 import javax.swing.*;
 import java.awt.*;
 import java.awt.event.*;
 import java.awt.Font;
 import java.awt.Graphics;
 import java.net.URL;
 import java.awt.event.KeyAdapter;
 import java.awt.event.KeyEvent;
 import java.io.*;
 import javax.swing.Timer;

 public class chromeNPlayerScreen extends JFrame implements ActionListener{
   DrawScreen dPnl = new DrawScreen(); 
   public void actionPerformed(ActionEvent e){
   }
   public void main(String[ ] args){
     this.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
     this.add(dPnl);
     this.setSize(600,600);;
     this.setVisible(true);
     this.setResizable(false);
     this.setLocation(200, 200);
   }  
 } 
```

但是当我运行它时......

```
 java.lang.NullPointerException
   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
   at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
   at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
   at java.lang.reflect.Method.invoke(Unknown Source)
   at edu.rice.cs.drjava.model.compiler.JavacCompiler.runCommand(JavacCompiler.java:272) 
```

有人可以向我解释为什么这不起作用吗？

DrawScreen 代码是

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.awt.Font;
import java.awt.Graphics;
import java.net.URL;

public class DrawScreen extends JPanel {
  String picPath = "pictures/";
  ClassLoader cl = pokemonChromeNewPlayerScreen.class.getClassLoader();
  URL imgURL = cl.getResource(picPath+"welcomeBG.png"),imgURL2 = cl.getResource(picPath+"dialogBox.png"),
    imgURL3 = cl.getResource(picPath+"Professor.png");
  Toolkit tk = Toolkit.getDefaultToolkit();
  Image imgBG, imgDialog, imgProfessor;

  public void imgImport(){
    imgBG = tk.createImage(imgURL);
    imgDialog = tk.createImage(imgURL2);
    imgProfessor = tk.createImage(imgURL3);
  }
  public void paintComponent(Graphics g) {
      g.setColor(Color.BLACK);
      Graphics2D g2 = (Graphics2D)g;
      for(int x=0;x<=600;x+=25){
        g2.drawLine(x,0,x,600);
        g2.drawString(""+x,x+5,20);
      }
      for(int y=0;y<=600;y+=25){
        g2.drawLine(0,y,600,y);
        g2.drawString(" "+y,0,y+20);
      }
  }
} 
```

这是DrawScreen的代码，它所做的一切都是拖动一个网格，但那是因为我刚刚启动它并想要不同位置的x，y值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T22:58:22.313

```
public void main(String[ ] args){ 
```

应该

```
public static void main(String[ ] args){ 
```

如果没有适当的`main`-method 声明，JVM 就没有入口点。

话虽如此，看起来你的“main”中的代码确实应该在你的类的构造函数中——看起来你可能打算在 - 方法中创建你的类的实例`main`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T22:58:32.130

您的`main`方法当前不作为入口方法。它应该被定义为`static`即

```
 public static void main(String[ ] args){ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T23:02:50.470

我假设这与您的 IDE 有关。具体来说，它正在寻找一个*非静态*版本的`main()`.

这：

```
public void main(String[ ] args){

} 
```

实际上应该是：

```
public static void main(String[ ] args){

} 
```

...当然，这意味着`this`引用不再有效 - 您需要实际创建`chromeNPlayerScreen`第一个：

```
public static void main(String[ ] args){
   chromeNPlayerScreen screen = new chromeNPlayerScreen();
   screen.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
   screen.add(dPnl);
   screen.setSize(600,600);;
   screen.setVisible(true);
   screen.setResizable(false);
   screen.setLocation(200, 200);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T23:04:43.580

你的 main 不是 static ，替换这个：

```
public void main(String[] args) 
```

这样 ：

```
public static void main(String[] args) 
```

# sql - 查找最近的日期，Firebird dBase

> ID：13772309
> 
> 赞同：2
> 
> 时间：2012-12-07T22:54:51.607
> 
> 标签：sql, date, firebird

我有两张包含数据的表格，虽然我已经看到了很多关于如何只用一张表格做我想做的事的例子（即使在 SO 上也是如此），但我不太清楚如何使用 Firebird 处理多个表格（这可能与大多数人认为的普通 SQL 并没有太大不同），但是，我对它的了解还不够，无法提出案例。

反正 -

我有以下代码：

```
select cqd.customer_price, cqd.entry_date, pnm.pn
  from cq_detail cqd, parts_master pnm
 where cqd.pnm_auto_key = pnm.pnm_auto_key
 order by cqd.entry_date desc 
```

它返回正确的数据，如下所示：

```
CUSTOMER_PRICE, ENTRY_DATE, PN
------------------------------
1,052.00        08.01.2012, 1938-12
1,054.00        08.02.2012, 1938-12
1,050.00        08.08.2012, 1938-12
1,051.00        08.04.2012, 1938-12
5,052.00        08.20.2012, 9999-19
7,054.00        08.07.2012, 9999-19
3,030.00        08.12.2012, 9999-19
6,021.00        08.04.2012, 9999-19 
```

其中，我非常满意。不幸的是，权力希望结果集只是：

```
CUSTOMER_PRICE, ENTRY_DATE, PN
------------------------------
1,050.00        08.08.2012, 1938-12
5,052.00        08.20.2012, 9999-19 
```

SQL 不是我正常的工作，我们正常的 SQL 人出去了，我正在尝试在他离开时处理一些更简单的项目。

所以，我想，简而言之，我需要返回每个特定 PN 的最新日期。我怀疑我需要一个嵌套的选择或某种形式的 JOIN，而这些天已经超出了我的范围。

提前致谢。

JB

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T05:48:53.727

```
select a.pn,b.entry_date,c.pn from
(select  pnm.pn as pn,max(cqd.entry_date) as max_entry_date
  from cq_detail as cqd, parts_master pnm
 where cqd.pnm_auto_key = pnm.pnm_auto_key
group by pnm.pn) a

inner join 

(select cqd.customer_price as customer_price, cqd.entry_date as entry_date, pnm.pn as pn
  from cq_detail cqd, parts_master pnm
 where cqd.pnm_auto_key = pnm.pnm_auto_key) as b 
on a.pn=b.pn and a.max_entry_date=b.entry_date
order by b.entry_date 
```

# sql - 删除sql视图中的重复记录

> ID：13772310
> 
> 赞同：3
> 
> 时间：2012-12-07T22:54:51.210
> 
> 标签：sql, view, duplicates

我有一个查询，它从具有第 1 列重复记录的表中返回数据，尽管其他列中可能有不同的值。我只想将第 1 列中的每个值的一条记录带入使用标准选择正确记录的视图中。

这是查询；

```
SELECT 
   PrimaryColumn1,
   Column2,
   Column3,
   Date1,
   Date2
FROM
   My_Table 
```

我希望在`PrimaryColumn1`我创建的基于最新日期的视图中只有不同的值`Date1`，如果这也是重复的，则在 Date2 中。

我尝试执行以下操作，但无法使其工作

```
SELECT 
   PrimaryColumn1,
   Column2,
   Column3,
   Date1,
   Date2
FROM    
   (SELECT  
        [PrimaryColumn1,
        Column2,
        Column3,
        Date1,
        Date2,
        ROW_NUMBER() OVER(PARTITION BY [Date1] ORDER BY Date2) AS RowNumber
    FROM    
        My_Table)
WHERE   
    RowNumber = 1 
```

任何帮助将不胜感激。

在下面的建议之后，最终的查询看起来像这样：

```
SELECT 
    PrimaryColumn1,
    Column2, 
    Column3,
    Date1,
    Date2
FROM    
    (SELECT  
         [PrimaryColumn1,
         Column2,
         Column3,
         Date1,
         Date2,
         ROW_NUMBER() OVER(PARTITION BY PrimaryColumn1
                           ORDER BY Date1 DESC, Date2 DESC) AS RowNumber) data
WHERE 
    RowNumber = 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:02:52.440

我认为你的`ROW_NUMBER()`陈述应该是这样的：

```
ROW_NUMBER() OVER(PARTITION BY PrimaryColumn1
                      ORDER BY Date1 DESC, Date2 DESC) AS RowNumber 
```

Since you're looking for the most recent record for each PrimaryColumn1 value, this should do what you want (as I understand it).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:19:08.907

CROSS APPLY is a great way to do something like this. For example, this pulls a record for each CategoryID in the Products table and shows the product data for the most expensive product in each category.

This effectively gives you a way to use a correlated subquery in a join. Pretty cool.

```
USE Northwind;
GO
--Get a distinct list of CategoryID values
--From the dbo.Products table, and show the
--Product details for the most expensive product
--in each of those categories....
SELECT DISTINCT 
  Prod.CategoryID,
  TopProd.ProductID,
  TopProd.ProductName,
  TopProd.UnitPrice
FROM dbo.Products AS Prod
CROSS APPLY 
(
  --Find the top 1 product in each category by unitprice
  SELECT TOP 1 
    ProductID,
    ProductName,
    UnitPrice
  FROM dbo.Products
  --This is the "correlated" part where 
  --we filter by the outer queries' CategoryID
  WHERE CategoryID = Prod.CategoryID
  --The ORDER BY determines which product
  --you see for each category.  In this
  --case I'll get the most expensive product
  ORDER BY UnitPrice DESC
) AS TopProd; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T23:07:29.013

```
SELECT 
   PrimaryColumn1,
   Column2,
   Column3,
   Date1,
   Date2
FROM My_Table
INNER JOIN  
   (SELECT  PrimaryColumn1,
        MAX(Date1) AS max_Date1,
        MAX(Date2) AS max_Date2,
        FROM My_Table
        GROUP BY PrimaryColumn1
    ) AS Maxes
ON Maxes.PrimaryColumn1 = My_Table.PrimaryColumn1
AND Maxes.max_Date1 = My_Table.Date1
AND Maxes.max_Date2 = My_Table.Date2 
```

# php - 在用户名字段中注入 mysql 并出现 THIS

> ID：13772311
> 
> 赞同：0
> 
> 时间：2012-12-07T22:54:52.403
> 
> 标签：php, mysql, sql-injection

这仅用于理解/教育目的。我没有试图做任何非法的事情或闯入未经授权的数据库。

我正在建立一个站点，因此请阅读一些有关 mysql 注入的信息，以了解安全问题。

我读到了一个 1=1 漏洞利用，您可以将用户值设置为 true。

出于好奇，我去了我大学的 wifi 网络（我已经可以访问它，然后输入：

```
' or '1'='1' --' 
```

我感到困惑并试图理解的是，当我按 Enter 键时，它用同一行填充了用户名字段，但添加了转义字符，即

```
\' or \'1\'=\'1\' --\' 
```

然后当我提交它时，它增加了四倍的转义字符，或者那里的东西。

从纯粹好奇的角度来看，sql这样做是什么意思？有漏洞吗？原因是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:02:27.023

这发生在 PHP 的应用程序级别。SQL 注入尝试中的引号被脚本转义。PHP 安装已`magic_quotes_gpc`启用或`addslashes`正在应用，或者正在发生其他一些转义。

这不是漏洞。

# c# - 在 SelectionChanged 上将标签更新为 XML 文件中的值

> ID：13772312
> 
> 赞同：0
> 
> 时间：2012-12-07T22:54:53.447
> 
> 标签：c#, wpf, xaml

我有一个看起来像的 XML 文件

```
<Items>
    <Item>
        <Name>Item 1</Name>
        <FirstProperty>42</FirstProperty>
        <SecondProperty>37</SecondProperty>
    </Item>
    <Item>
        <Name>Item 2</Name>
        <FirstProperty>11</FirstProperty>
        <SecondProperty>35</SecondProperty>
    </Item>
</Items> 
```

和一个看起来像的 XAML 文件

```
<Grid>
    <Grid.Resources>
        <XmlDataProvider x:Key="ItemsXml" XPath="Items/Item" Source="Items.xml"/>
    </Grid.Resources>
    <ListBox Name="itemList" HorizontalAlignment="Left"
                ItemsSource="{Binding Source={StaticResource ItemsXml}, XPath=//Name}"/>
    <TextBox HorizontalAlignment="Right" VerticalAlignment="Top" Margin="80,0" Width="30"/>
    <TextBox HorizontalAlignment="Right" VerticalAlignment="Top" Margin="80,50" Width="30"/>
    <Label HorizontalAlignment="Right" VerticalAlignment="Top"
           Content="{Binding ElementName=areaList, Path=SelectedValue}"/>
    <Label HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,50" Content="Bind me?"/>
</Grid> 
```

这显示了`ListBox`包含两个元素的 a`Item 1`和，以及包含 a和 a 的`Item 2`两行。是否可以将属性分别绑定到中的选定项目？上面的代码将一个绑定到所选项目的*值*，它可以正常工作，但那不是我想要显示的值。我猜我真正需要的是指定XPath 的来源并找到匹配值，但首先我不确定如何进行比较，其次我很想知道是否有更好的方法，假设有完全是一个。`TextBox``Label``Label.Content``FirstProperty``SecondProperty``ListBox``Label`*`itemList`*

 *如果这不可能，我能想到的唯一解决方案是在`SelectionChanged`事件处理程序中以编程方式进行。那会起作用，但我宁愿不必像那样拆分行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T03:04:32.930

像这样的东西应该可以解决问题，

`Items`将直接绑定到`ListBox`并用于`DisplayMemberpath`从`Item`节点显示您想要的属性。

然后通过将 设置`Label` `DataContext`为节点，`ListBox` `SelectedItem`您可以通过`XPath``Label` `Content`

```
<Grid>
    <Grid.Resources>
        <XmlDataProvider x:Key="ItemsXml" XPath="Items/Item" Source="Items.xml" />
    </Grid.Resources>
    <ListBox Name="itemList" Width="172" 
             ItemsSource="{Binding Source={StaticResource ItemsXml}}"
             DisplayMemberPath="Name" Margin="0,0,570,0" />

    <Label DataContext="{Binding SelectedItem, ElementName=itemList}" 
           Content="{Binding XPath=FirstProperty}" Width="160" Height="30" Margin="178,48,403,233" />

    <Label DataContext="{Binding SelectedItem, ElementName=itemList}" 
           Content="{Binding XPath=SecondProperty}" Width="160" Height="30" Margin="178,12,403,269" />
</Grid> 
```*

# delphi - 编译包后在哪里可以找到 bpl 文件？

> ID：13772313
> 
> 赞同：8
> 
> 时间：2012-12-07T22:54:56.337
> 
> 标签：delphi, package, delphi-xe3, jedi, jvcl

我想创建 *.bpl 文件，但我没有这样做。
具体来说，我正在尝试制作 JEDI 插件，但我也尝试了一个空的纯 Delphi 包。

如果我在 Delphi XE3 中创建一个新包，我会得到一个空单元 - 如果我“制作”这个名为“Package1.bpl”的项目，我会在“debug/win32/”中得到一个 .dcu 文件，但没有 .bpl 文件。
编译器不报告错误。

一个空的 JEDI 插件（bpl 样式）也只提供一个 .dcu，而一个空的 dll 样式的 JEDI 插件在“debug/win32/”中提供一个 .cdu**和一个 .dll 文件。**

这是我第一次尝试制作新包装，所以我完全迷路了。
我错过了什么？

法老

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-07T23:00:54.747

转到`Tools`菜单并导航到`Environment Options`-> `Delphi Options`-> `Library`。在那里你可以找到`Package Output Directory`和`DCP Output Directory`。这些目录是 BPL 和 DCP 的默认输出目录，因此如果您的包已编译，则将创建 bpl，但在与您期望的目录不同的目录中。

JEDI 插件可能在`Project`->中配置了它们的输出目录`Options`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-20T17:29:33.780

对于那些不想进入 Delphi IDE/选项等的人，最近在 Delphi XE 中是这样的：

“C:\Users\Public\Documents\Embarcadero\Studio\17.0\Bpl;”

根据 17.0，您的确切文件夹可能会有所不同

这些文件夹也最终出现在系统的路径环境变量中，有点危险并且可能导致一些强大的魔法加载混乱？！

“从我的本地项目文件夹中删除 BPL 后，它是如何加载的？” :)

另一种解决方案是添加“。” 到你的项目设置没有“”。防止您不得不修改您的 delphi 环境选项/设置，这是您可能永远不想做的事情，因为 JEDI 和其他项目可能依赖这些默认设置才能正常运行。仅当您知道自己在做什么以及如何正确使 JEDI 和其他人在更改后才能对其进行更改，这可能会变得棘手/多毛，可能需要添加搜索路径。

# php - ajax/php 文件下载不起作用？

> ID：13772316
> 
> 赞同：3
> 
> 时间：2012-12-07T22:55:14.960
> 
> 标签：php, javascript, ajax, download

我试图在单击按钮时强制下载 txt 文件。内容是动态生成的，并存储在 javascript 变量中。单击按钮时不会出现下载窗口，但是 ajax 调用成功。我究竟做错了什么？

php：

```
<?php
$Proof = $_REQUEST["Proof"];
$proof = stripslashes($Proof);
$file = 'savedproof.txt';
file_put_contents($file, $proof);
header('Content-disposition: attachment; filename="'.$file.'"');
header("Content-Type: application/octet-stream");
header("Content-Transfer-Encoding: binary");
header('Content-Description: File Transfer');

readfile($file);
?> 
```

的JavaScript：

```
$("#save").click(function () {

    var proof = $("#main").html();
     $.ajax({ 
             type: 'POST', 
             url: 'save-to-file.php',
             data: {Proof: Proof},
             dataType: "html"

            });
} 
```

或者，我尝试使用 window.location.href 但我无法将变量 Proof 传递给 php 文件。我试过这样的事情：

```
window.location.href ="download.php?Proof="+Proof; 
```

尽管确实出现了下载对话框，但文件中只有变量 Proof 的开始部分。我在 Firefox 和 chrome 上测试了两种方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:03:04.200

由于安全问题，Javascript 无法将文件下载到客户端计算机。

只需将按钮设为链接（根据需要设置样式）并执行以下操作：

```
<a id="save" href='/path/to/download.php' target="_blank"></a> 
```

然后有一个onready函数来改变`href`基于的值`#main`

```
$.ready(
   var proof = $('#main').html();
   var href = $('#save').attr('href') + '?Proof=' + encodeURIComponent(proof);
   $('#save').attr('href', $href); 
}); 
```

据我所知，这里根本没有使用 AJAX 的理由。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T02:26:38.337

您的 AJAX 请求不起作用，因为它没有触发浏览器导航。它只是提供对 Javascript 的响应，而忽略它。您可能需要构建一个假`<form>`元素并提交它以获取下载结果。

就`window.location.href`目前而言，URL 通常被限制在 2 到 4 KB 左右，因此您会被截断。所以这行不通。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-11T09:41:25.780

您可以通过 jquery 创建和发送表单来做到这一点（页面未重新加载）：

```
$(document).on('click', '#save', function () {
    var proof = $("#main").html();
    var form = $(document.createElement('form'));
    form.attr('action', 'save-to-file.php');
    form.attr('method', 'POST');
    var input = $('<input>').attr('type', 'hidden').attr('name', 'Proof').val(proof);
    form.append(input);
    form.appendTo(document.body);
    form.submit();
    form.remove();
}); 
```

# mysql - mysql 可选变量函数

> ID：13772319
> 
> 赞同：0
> 
> 时间：2012-12-07T22:55:37.190
> 
> 标签：mysql, function, parameters, optional

所以说我有一个用户定义的功能：

```
CREATE FUNCTION ADDRESS_EXISTS_FULL (
    line_1 VARCHAR(64),
    line_2 VARCHAR(64),
    city VARCHAR(64),
    state VARCHAR(32),
    zip VARCHAR(10),
    type INT(3)
)
RETURNS INT(1)
DETERMINISTIC
READS SQL DATA
BEGIN
    DECLARE aid INT;

    SET aid = NULL;

    SELECT addressid INTO aid FROM dlp.address as a
        WHERE a.line_1 = line_1
            AND a.line_2 = line_2
            AND a.city = city
            AND a.state = state
            AND a.zip = zip
            AND a.address_type = type
            LIMIT 1;

    RETURN IF(aid IS NOT NULL, 1, 0);

END$$ 
```

我如何做到这一点，以便其中一些是不必要的？就像说如果不需要类型，无论如何都可以调用

```
 SELECT ADDRESS_EXISTS_FULL(l1,l2,c, s, z) 
```

还是会失败？以及如何使该功能起作用？

谢谢。

注意：我不需要存储这个函数，它是一次性的，所以它在一个大的 mysql 脚本文件中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:05:52.900

您可以将存储函数体内的查询重写为类似

```
SELECT addressid INTO aid FROM dlp.address as a
    WHERE (a.line_1 = p_line_1 OR p_line_1 IS NULL)
        AND (a.line_2 = p_line_2 OR p_line_2 IS NULL)
         --.... etc
        LIMIT 1; 
```

因此，如果您传递`null`特定参数，它将被忽略。另外，我建议避免将参数命名为与表中的字段完全相同的名称——这可能会导致非常微妙的错误（在上面的查询中，我在每个参数前面加上了 'p_'）。最后，我不会`DETERMINISTIC`对本质上不确定的函数使用关键字。

# javascript - SVG 路径元素 .transition() - 在哪里添加？

> ID：13772325
> 
> 赞同：4
> 
> 时间：2012-12-07T22:56:42.413
> 
> 标签：javascript, svg, d3.js, transition

基本上，我希望我的图表从 x 轴开始，并在两秒内增长到实际数据值。这可能是一件简单的事情，但我似乎无法让它发挥作用。

我正在附加一个区域元素，其中 d="" 属性是由一个函数（区域）构建的，我不确定在哪里添加过渡。

首先我想在 area 函数中这样做，但是失败了。当添加区域元素但未成功时，我也尝试过这样做。

**这是我的代码：**

```
// Create the area element for each object - a function that will be passed to "path"
var area = d3.svg.area()
    .x(function(d) { return x(d.year); })
    .y0(height)
    //.y1(height)
    //.transition()
    //.duration(2000)
    .y1(function(d) { return y(d.average); });

// build the container SVG element
var svg = d3.select("#co2").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")

svg.append("path") 
    // pull in data to the path 
    .datum(data)
    .attr("class", "area")
    // passing in the area function, for each object
    .attr("d", area)
    // starts the graph opacity at 0 and fades to 1 over 2.5 seconds
    .style("fill-opacity", "0")
    .transition()
    .duration(2500)
    .style("fill-opacity", "1"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T10:41:08.140

与其尝试在区域图的形状上使用过渡，不如对要设置动画的整个 svg 元素应用 scale(x,y) 变换。这种方法的优点是它不限于特定的渲染实现（例如：不是 path/d3.area 特定的）。

不过，有几个问题需要注意：

*   为避免 transition() 行为，进行边距调整，请确保您有一个单独的 'g' 元素供 transition() 转换操作

*   SVG 的原点 (0,0) 在左上角，所以除了缩放 SVG 区域外，还需要设置图形的底部

这放在下面：

*“g”元素：*

```
var svg = d3.select("#co2").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
      .attr("transform", "translate(" + margin.left, "," + margin.top + ")")
    // define a new 'g' to scope the transition, and keep separate from the margin adjusting transform above
    .append("g"); 
```

*transition() 包括基础调整：*

```
svg
  .attr("transform", "translate(0," + height + ") scale(1, 0)")
.transition().duration(2000)
  .attr("transform", "translate(0,0) scale(1, 1)"); 
```

与以往一样，最好用完整的例子来说明这一点：http: [//bl.ocks.org/4239516](http://bl.ocks.org/4239516)

# perl - Perl - 网络 - 如何处理超过 128 个套接字的 SOMAXCONN？

> ID：13772330
> 
> 赞同：2
> 
> 时间：2012-12-07T22:57:02.350
> 
> 标签：perl, nonblocking

我讨厌这种情况（MACOSX）

```
$ perl -MSocket -le 'print SOMAXCONN'
128 
```

如何处理超过 128 个套接字？我正在使用 IO::Socket::INET （此时与 IO::Select 多路复用）但我有这个限制。

我在考虑 pre-fork N 进程（每个处理 128 使用 select 或 poll），但我不知道它是否可以工作。一些想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T00:01:26.830

这是 OS X 内核级别的可配置限制。幸运的是，它很容易修复，但前提是你有 root。这[是一篇解释如何调整内核配置的文章](https://rolande.wordpress.com/2010/12/30/performance-tuning-the-network-stack-on-mac-osx-10-6/)。相关条目是`kern.ipc.somaxconn`。

否则，您可以尝试使用线程，不确定每个线程是否获得自己的套接字分配，或者[CPAN 上的任意数量的预分叉服务器](https://metacpan.org/search?q=fork%20server)。

# ios - 是否可以使后台线程运行得更快？

> ID：13772331
> 
> 赞同：0
> 
> 时间：2012-12-07T22:57:07.580
> 
> 标签：ios, grand-central-dispatch, rubymotion

我正在使用 RubyMotion 并使用 CKCalendarView 实现了一个日历[，](https://github.com/jaykz52/CKCalendar)并且我有以下代码突出显示事件发生的日期。

从以下方法调用`layoutSubviews`

```
def calendarDidLayoutSubviews(calendar)
  _events_array = []
  if self.events
    self.events.reverse.each do |ev|
      mdy = ev.date.month_date_year
      _events_array <<  mdy unless _events_array.include?(mdy)
    end
  end

  Dispatch::Queue.main.async do
    today = NSDate.date.month_date_year

    if calendar.dateButtons && calendar.dateButtons.length > 0
      calendar.dateButtons.each do |db|
        db.backgroundColor = "f4f2ee".to_color
        if db.date && db.date >= calendar.minimumDate && db.date <= calendar.maximumDate
          if _events_array && _events_array.length > 0
            db.setTitleColor("c7c3bb".to_color, forState:UIControlStateNormal)
            db.backgroundColor = "f4f2ee".to_color
            if _events_array.include?(db.date.month_date_year)
              db.setTitleColor(UIColor.blackColor, forState:UIControlStateNormal)
              db.backgroundColor = "9ebf6c".to_color
              _events_array.delete(db.date.month_date_year)
            end
          end
        end
        if db.date && db.date.month_date_year == today
          if calendar.minimumDate <= db.date && calendar.maximumDate >= db.date
            db.setTitleColor(UIColor.blackColor, forState:UIControlStateNormal)
          else
            db.setTitleColor("f4f2ee".to_color, forState:UIControlStateNormal)
          end
        end
      end
    end
  end
end 
```

事实上，这会在绘制时将 UI 冻结 0.5 - 1.5 秒。如果我将它移到后台线程中，绘制时间会增加 4 到 5 倍，但不会冻结 UI。

**问题：**有没有办法给后台线程更高的优先级，或者有办法逐步绘制和突出显示 dateButtons，这样在绘制所需的六秒内看起来没有任何事情发生（当不在主线程）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T01:33:33.980

我发布的方法在主线程中被调用，所以我将它切换为在后台线程中调用，然后在我的循环中为所有绘图操作调用主线程。

```
def calendarDidLayoutSubviews(calendar)
   _events_array = []
  if self.events
    self.events.reverse.each do |ev|
      mdy = ev.date.month_date_year
      _events_array <<  mdy unless _events_array.include?(mdy)
    end
  end

  today = NSDate.date.month_date_year

  if calendar.dateButtons && calendar.dateButtons.length > 0
    calendar.dateButtons.each do |db|
      Dispatch::Queue.main.async do
        db.backgroundColor = "f4f2ee".to_color
      end
      if db.date && db.date >= calendar.minimumDate && db.date <= calendar.maximumDate
        if _events_array && _events_array.length > 0
          Dispatch::Queue.main.async do
            db.setTitleColor("c7c3bb".to_color, forState:UIControlStateNormal)
            db.backgroundColor = "f4f2ee".to_color
          end
          if _events_array.include?(db.date.month_date_year)
            Dispatch::Queue.main.async do
              db.setTitleColor(UIColor.blackColor, forState:UIControlStateNormal)
              db.backgroundColor = "9ebf6c".to_color
            end
            _events_array.delete(db.date.month_date_year)
          end
        end
      end
      if db.date && db.date.month_date_year == today
        if calendar.minimumDate <= db.date && calendar.maximumDate >= db.date
          Dispatch::Queue.main.async do
            db.setTitleColor(UIColor.blackColor, forState:UIControlStateNormal)
          end
        else
          Dispatch::Queue.main.async do
            db.setTitleColor("f4f2ee".to_color, forState:UIControlStateNormal)
          end
        end
      end
    end
  end
end 
```

# entity-framework - 实体框架：使用案例语句更新数据

> ID：13772332
> 
> 赞同：0
> 
> 时间：2012-12-07T22:57:12.987
> 
> 标签：entity-framework, dbcontext, entity-framework-4.3

想象一下，我有一个包含以下列和值的 SQL 表：

```
+----+---------+------------+---------+------------+
| ID | Status1 | Condition1 | Status2 | Condition2 |
+----+---------+------------+---------+------------+
|  1 |       1 |          1 |       1 |          1 |
|  2 |       1 |          0 |       1 |          1 |
|  3 |       1 |          1 |       1 |          0 |
|  4 |       1 |          0 |       1 |          0 |
+----+---------+------------+---------+------------+ 
```

我想分别根据 Condition1 和 Condition2 中的值更新 Status1 和 Status2 的值。

我的 SQL 语句如下所示：

```
UPDATE
    myTable
SET
    Status1 = CASE Condition1
                WHEN 1 THEN 3
                ELSE 4
            END,
    Status2  = CASE Condition2
                WHEN 1 THEN 3
                ELSE 4
            END
WHERE
    ID = @targetRowID 
```

如果我对每个 ID 的表单独运行上述 SQL 语句，我将得到以下值：

```
+----+---------+------------+---------+------------+
| ID | Status1 | Condition1 | Status2 | Condition2 |
+----+---------+------------+---------+------------+
|  1 |       3 |          1 |       3 |          1 |
|  2 |       4 |          0 |       3 |          1 |
|  3 |       3 |          1 |       4 |          0 |
|  4 |       4 |          0 |       4 |          0 |
+----+---------+------------+---------+------------+ 
```

在 Entity Framework 中，我通过执行以下操作进行相同类型的更新：

```
var  myRow = dbContext.myTable.Single(r => r.ID == 1);

myRow.Status1 = (myRow.Condition1 == 1) ? 3 : 4;
myRow.Status2 = (myRow.Condition2 == 1) ? 3 : 4;

dbContext.SaveChanges(); 
```

这可行，但它首先从数据库中获取数据，然后进行第二次查询以进行更新。是否可以像上面的普通 SQL 代码那样一次性完成更新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:02:43.407

LINQ 总是在更新之前进行查询。这是该技术众所周知的烦恼。

(nit-pick: "This works, but it first fetches the data from the database and then does a second query to do the update." The second thing send to the database is not a "query". A "query" is standard English is a question, hence a database query is a request for information, i.e., a SELECT statement. An UPDATE is a command.)

# android - 设置三角形的大小（Android）

> ID：13772336
> 
> 赞同：0
> 
> 时间：2012-12-07T22:57:25.380
> 
> 标签：android

因此，我创建了一个在画布上绘制三角形的 android 活动。我还在 VM 中添加了 4 个菜单（颜色、放大、缩小和重置）。颜色工作正常，但我不太确定一旦按下该菜单按钮后如何在 android 中调整三角形的大小。分配说只是固定三角形的顶点，然后更改底部两点的坐标三角形。谁能指出我在Android中如何做到这一点的正确方向？

这是我的代码，尽管放大、缩小和重置的实现设置为使用圆形（我之前做过的项目），而不是三角形。请注意，“颜色”菜单有效，因此无需这样做。

```
public class MainActivity extends Activity
{
    final Context context = this;
    private Graphics graphic;
    private Dialog radiusDialog; //Creates dialog box declaration
    private SeekBar red;
    private SeekBar green;
    private SeekBar blue;
    private Button radiusButton;

    private TextView progress1;
    private TextView progress2;
    private TextView progress3;
    private TextView tv;

    @Override
    protected void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);       
        graphic = new Graphics(this); //Create new instance of graphics view
        setContentView(graphic); //Associates customized view with current screen     
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) 
    {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) //This acts as a menu listener to override
    {
        switch(item.getItemId()) //returns menu item
        {
        case R.id.Color:
            showDialog();
            break;
        case R.id.Shrink:
            graphic.setRadius(graphic.getRadius() -1);
            graphic.invalidate();
            break;
        case R.id.Enlarge:
            graphic.setRadius(graphic.getRadius() +1);
            graphic.invalidate();
            break;
        case R.id.Reset:
            graphic.setColor(Color.CYAN);
            graphic.setRadius(75);
            graphic.invalidate();
            break;
        }
        return super.onOptionsItemSelected(item);
    }

    void showDialog() //creates memory for dialog
    {
        radiusDialog = new Dialog(context);
        radiusDialog.setContentView(R.layout.draw_layout);  //binds layout file (radius) with current dialog
        radiusDialog.setTitle("Select Color:");

        red = (SeekBar)radiusDialog.findViewById(R.id.seekBar1);
        green = (SeekBar)radiusDialog.findViewById(R.id.seekBar2);
        blue = (SeekBar)radiusDialog.findViewById(R.id.seekBar3);

        progress1 = (TextView)radiusDialog.findViewById(R.id.textView2);
        progress2 = (TextView)radiusDialog.findViewById(R.id.textView4);
        progress3 = (TextView)radiusDialog.findViewById(R.id.textView6);    

        mychange redC = new mychange();
        red.setOnSeekBarChangeListener(redC);

        mychange greenC = new mychange();
        green.setOnSeekBarChangeListener(greenC);

        tv = (TextView)radiusDialog.findViewById(R.id.textView7);
        mychange c = new mychange();
        blue.setOnSeekBarChangeListener(c);     
        radiusButton = (Button) radiusDialog.findViewById(R.id.button1);
        radiusButton.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                int color = Color.rgb(red.getProgress(), green.getProgress(), blue.getProgress());  
                radiusDialog.dismiss();
                setContentView(R.layout.activity_main);
                setContentView(graphic);
                graphic.setColor(color);//Create new instance of graphics view
                graphic.invalidate();
            }
        });
        radiusDialog.show(); //shows dialog on screen
    } 

    public class mychange implements OnSeekBarChangeListener{

        @Override
        public void onProgressChanged(SeekBar seekBar, int progress,
                boolean fromUser) {
            // TODO Auto-generated method stub
            int color = Color.rgb(red.getProgress(), green.getProgress(), blue.getProgress());  
            tv.setBackgroundColor(color);
            progress1.setText(String.valueOf(red.getProgress()));
            progress2.setText(String.valueOf(green.getProgress()));
            progress3.setText(String.valueOf(blue.getProgress()));

        }

        @Override
        public void onStartTrackingTouch(SeekBar seekBar) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onStopTrackingTouch(SeekBar seekBar) {
            // TODO Auto-generated method stub

        }
    }

} 
```

绘制三角形的图形类

```
public class Graphics extends View 
{

    private Paint paint;
    private int radius;
    private int color;

    public void setColor(int color)
    {
        this.color = color;
    }

    public Graphics(Context context) //creates custom view (constructor)
    {
        super(context);
        paint = new Paint(); //create instance of paint
        color = Color.CYAN;
        paint.setStyle(Paint.Style.FILL); //draw filled shape
        radius = 75;
    }

    @Override
    protected void onDraw(Canvas canvas) //override onDraw method
    {
        super.onDraw(canvas);
        paint.setColor(color);  
        paint.setStyle(Paint.Style.STROKE);
        Path path = new Path();
        path.moveTo(230, 200);
        path.lineTo(330, 300);
        path.lineTo(130, 300);
        path.close();
        canvas.drawPath(path, paint);
    }

    void setRadius(int radius)
    {
        this.radius = radius;
        invalidate(); //just like repaint method
    }
    public int getRadius()
    {
        return radius;
    }   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:40:24.420

如果顶部坐标保持固定，您可以更改三角形的高度以缩小/放大它。

假设三角形是等边的——所有 3 条边的长度都相同。在这种情况下：

![在此处输入图像描述](../Images/e9af7589d158ccb6d4c20862b392e150.png)

因此，如果顶部顶点坐标为 (x, y)，则底部坐标为：

```
(x - side / 2, y + h) 
```

和：

```
(x + side / 2, y + h) 
```

所以你的路径代码应该写成：

```
float side = Math.sqrt(3) / 2 * height;
Path path = new Path();
path.moveTo(x, y);
path.lineTo(x - side / 2, y + height);
path.lineTo(x + side / 2, y + height);
path.close(); 
```

# ruby-on-rails - 如何在一定时间后运行一次命令（RoR）？

> ID：13772341
> 
> 赞同：0
> 
> 时间：2012-12-07T22:57:42.607
> 
> 标签：ruby-on-rails, cron, whenever

我想在设置一些标志后 48 小时运行命令。例如，列得到更新，48 小时后命令被执行。我知道我可以使用“无论何时” gem 并安排每小时（每天等）检查，但如果我只想运行 1 个命令一次怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:25:35.217

延迟作业及其 run_at 选项对此非常有效。

[Zada 的笔记：Rails 技巧：使用delayed_job 在特定时间安排作业](http://zadasnotes.blogspot.com/2011/03/rails-tips-using-delayedjob-to-schedule.html)

# python - 用于猜测安装了哪个 ODBC 驱动程序管理器的 Python 脚本

> ID：13772342
> 
> 赞同：1
> 
> 时间：2012-12-07T22:57:49.447
> 
> 标签：python, distutils, unixodbc, iodbc

我正在使用 distutils 分发一个 python C 扩展库，该库需要链接到用户系统中可用的 ODBC 驱动程序管理器（如果有）。对于 Windows，可以假设系统提供的管理器是要使用的管理器。然而，对于其他操作系统，有几个驱动程序管理器可用（主要是 iODBC 或 unixODBC）。

您是否知道一种方法来检测用户操作系统中安装了哪些，以便 setup.py 脚本可以动态选择那个？理想情况下，它适用于 Mac 和主流 Linux 发行版。

# php - PHP Foreach 语句问题。返回多行

> ID：13772343
> 
> 赞同：3
> 
> 时间：2012-12-07T22:57:48.477
> 
> 标签：php, html, mysql

我是 PHP 初学者，最近我的源代码出现问题。

这里是：

```
 <html>
    <head>
        <title>
            Bot
        </title>
        <link type="text/css" rel="stylesheet" href="main.css" />
    </head>
    <body>
        <form action="bot.php "method="post">
            <lable>You:<input type="text" name="intrebare"></lable>
            <input type="submit" name="introdu" value="Send">
        </form>
    </body>
</html>
<?php
//error_reporting(E_ALL & ~E_NOTICE);
mysql_connect("localhost", "root", "") or die(mysql_error());
mysql_select_db("robo") or die(mysql_error());

$intrebare=$_POST['intrebare'];
$query = "SELECT * FROM dialog where intrebare like '%$intrebare%'"; 
$result = mysql_query($query) or die(mysql_error());
$row = mysql_fetch_array($result) or die(mysql_error());
?>
<div id="history">
<?php       
        foreach($row as $rows){ 
            echo "<b>The robot says: </b><br />";
            echo $row['raspuns'];
            }
?>
</div> 
```

它返回结果 6 次。

当我这样做时出现了这个问题，`foreach`因为我希望在每次 SQL 查询之后将结果一张一张地卡在页面上。

你能告诉我似乎是什么问题吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:03:28.880

`mysql_fetch_array`每次调用获取一行。你会想要这样做：

```
while ($row = mysql_fetch_array($result)) {
    echo "<b>The robot says:</b><br>";
    echo htmlentities($row['raspuns']);
} 
```

并首先摆脱它`mysql_fetch_array`。

（请注意，我正在对变量输出进行 HTML 转义。除非您知道自己在做什么，否则不应将原始数据输出到页面中。）

顺便说一句，`mysql_query`已被有效弃用。完全不推荐用于新代码。看看 mysqli（替代品）或 PDO（新热点）。使用新的 mysqli (objecty) 接口，PHP 部分看起来有点像这样：

```
<?php

//error_reporting(E_ALL & ~E_NOTICE);

$db = new mysqli('localhost', 'root', '', 'robo');

# turn into a wildcard
$intrebare='%' . $_POST['intrebare'] . '%';

$stmt = $db->prepare('SELECT * FROM dialog WHERE intrebare LIKE ?');
$stmt->bind_param('s', $intrebare);
$result = $stmt->execute();

echo '<div id="history">';
# 5.4 lets you do it like this; 
# older versions, try `while ($row = $result->fetch_assoc())`
foreach ($result as $row) {
    echo "<b>The robot says: </b><br />";
    echo htmlentities($row['raspuns']);
}

?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T23:03:54.027

你这样做是不对的。;-)

首先，您必须`mysql_fetch_array`在这样的循环中获取结果：

```
while (true == ($row = mysql_fetch_array($result))) {
    echo "<b>The robot says: </b><br />";
    echo $row['raspuns'];
} 
```

其次我想告诉你，所有的 mysql_* 函数都被标记为已弃用。如果你想学习 PHP，你应该尝试学习如何使用 PDO 连接到 mysql。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T23:01:43.937

您正在尝试相反的方式：

```
 <?php     

    while($row = mysql_fetch_array($result,MYSQL_ASSOC)){ 
        echo '<strong>The robot says: </strong><br />', $row['raspuns'];
        }
    ?> 
```

现在试试 ：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T23:02:08.677

使用 while 获取所有数据并检查变量名称

```
 while($row = mysql_fetch_array($result)){ 
        echo "<b>The robot says: </b><br />";
        echo $row['raspuns']; // Here
        } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-07T23:03:57.140

你只会得到一个结果（只有一次调用 mysql_fetch_array()）。我敢打赌，对话中有六列。

```
...
$result = mysql_query($query) or die(mysql_error());
?>
<div id="history">
<?php
while($row = mysql_fetch_array($result))
{
    echo "<b>The robot says: </b><br />";
    echo htmlentities($row['raspuns']);
}
?>
</div> 
```

此外，不推荐使用 mysql_* 函数。切换到 mysqli_* 或 PDO。

# java - @ManyToMany 连接的休眠实体建模

> ID：13772346
> 
> 赞同：0
> 
> 时间：2012-12-07T22:58:18.853
> 
> 标签：java, hibernate

![在此处输入图像描述](../Images/250e106e4547f90d0a0af9fb5a6e61d3.png)

我有 2 个表，View(viewId INTEGER) 和 Auth(login VARCHAR)。我想使用 hibernate 4 和注释从加入 View 和 Aut 创建另一个表，如下所示。请注意，我在该表中添加了另一个字段可见性。

```
@Entity
public class ViewAut {          

    @ManyToOne(fetch=FetchType.LAZY)
    @JoinColumn(name="VIEW_VIEWID")
    private Rview view;             

    @ManyToOne(fetch=FetchType.LAZY)
    @JoinColumn(name="AUT_USERID")  
    private Aut aut;                

    @Column                         
    private boolean visibile;       
    // Getter & setters
} 
```

View 对象有一组 ViewAut 对象

```
@Entity                                          
public class View {
    // DONT KNOW HOW TO WRITE ANNOTATION FOR THIS SCENARIO
    private Set<ViewAut> authorizations; 
```

同样，Auth 对象有一组 ViewAut 对象

```
@Entity                                          
public class Aut {
    // DONT KNOW HOW TO WRITE ANNOTATION FOR THIS SCENARIO
    private Set<ViewAut> authorizations; 
```

你能指导我如何在hibernate 4注释中编写那些加入吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:53:17.597

你试图完成的事情不能用`Embeddable`. JPA 定义`Embeddable`了一个类，其实例存储为拥有实体的固有部分并共享实体的身份。嵌入对象的每个持久属性或字段都映射到实体的数据库表，请参阅[Embeddable](http://docs.oracle.com/javaee/6/api/javax/persistence/Embeddable.html)

在这种情况下，您应该将其建模`ViewAut`为另一个`Entity`，并使用`OneToMany`来建立它们之间的关系。

# hadoop - Hadoop 排名列

> ID：13772353
> 
> 赞同：1
> 
> 时间：2012-12-07T22:58:44.863
> 
> 标签：hadoop, hive, hiveql

所以我有这些我正在使用的特定列： `customer_token`、`merchant_id`、`merchant_category_code`和`transaction_amount`。

我目前的查询是这样的：

```
SELECT customer_token, COUNT(transaction_amount), SUM(transaction_amount)
FROM transaction 
                     WHERE file_date>20121031 
                     and file_date<20121201
GROUP BY customer_token 
```

我想在上面的查询中添加一个部分，在结果中，merchant_category_code 根据每个特定的交易金额分为不同的列`merchant_category_code`。结果如下所示：

> customer_token、count(transaction_amount)、sum(transaction_amount)、count(merchant_category_code中的transaction_amount排名第1)、count(merchant_category_code中的transaction_amount排名第2)、count(merchant_category_code中的transaction_amount排名第3)等...

然后这个：

> customer_token、count(transaction_amount)、sum(transaction_amount)、sum(merchant_category_code中的transaction_amount排名第1)、sum(merchant_category_code中的transaction_amount排名第2)、sum(merchant_category_code中的transaction_amount排名第3)等...

但我不知道如何做到这一点，或者是否有可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T03:26:35.273

如果您事先知道可能的值`merchant_category_code`是什么，则可以使用`CASE`表达式：

```
SELECT customer_token,
       COUNT(transaction_amount),
       SUM(transaction_amount),
       COUNT(CASE WHEN merchant_category_code = 1 THEN transaction_amount END),
       COUNT(CASE WHEN merchant_category_code = 2 THEN transaction_amount END),
       COUNT(CASE WHEN merchant_category_code = 3 THEN transaction_amount END),
       ...
       SUM(CASE WHEN merchant_category_code = 1 THEN transaction_amount END),
       SUM(CASE WHEN merchant_category_code = 2 THEN transaction_amount END),
       SUM(CASE WHEN merchant_category_code = 3 THEN transaction_amount END),
       ...
  FROM transaction 
 WHERE file_date BETWEEN 20121101 AND 20121130
 GROUP
    BY customer_token
; 
```

（或`IF`表达式，如果您愿意；有关这两者的文档，请参阅[Hive wiki 中“LanguageManual+UDF”页面上标题为“条件函数”的部分](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF#LanguageManualUDF-ConditionalFunctions)）。

# php - Smarty 删除空格

> ID：13772355
> 
> 赞同：0
> 
> 时间：2012-12-07T22:58:55.660
> 
> 标签：php, codeigniter, templates, smarty

我正在使用 Smarty 和 CodeIgniter。

这是我的代码：

```
<!doctype html>
<html lang="en-gb">
    <head>
        <title>Frustrating as Hell</title>
        <meta charset="utf-8">
    </head>

    <body>
        {if $test == 'hello'}
            Hello!
        {/if}
    </body>
</html> 
```

如果我在 Chrome 上查看源代码，我会看到这个（删除了不必要的部分）：

```
<body>
                    Hello!
            </body> 
```

我希望它像这样正确嵌套：

```
<body>
    Hello!
</body> 
```

我该怎么做？请不要建议`<body>Hello!</body>`我不想要的输出 {strip}{/strip}。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:33:41.097

我真的不明白你为什么希望它在 chrome 的视图源中看起来不错，但如果我是你，我会玩弄源代码

```
<!doctype html>
<html lang="en-gb">
    <head>
        <title>Frustrating as Hell</title>
        <meta charset="utf-8">
    </head>

    <body>{if $test == 'hello'}
        Hello!{/if}
    </body>
</html> 
```

我不知道这是否可行，但无论哪种方式，您最终都会使您的工作代码不整洁或结果不整洁。如果我有选择，我会选择不整洁的代码，因为事实上没有人会看它（我猜）;-)

# python - 如何以字符串形式打印键？

> ID：13772357
> 
> 赞同：-3
> 
> 时间：2012-12-07T22:58:57.907
> 
> 标签：python

就像是

```
 d = {'a':1, 'b':2, 'c':3} 
```

我要打印

```
 'a'
 'b'
 'c' 
```

就像是

```
 for (key, value) in d.items():

    print d[key] 
```

将打印出来

```
 1
 2
 3 
```

但是如何在不使用任何其他程序（例如 itertools 或其他东西）的情况下以字符串形式制作键。这是一个简单的python程序。

我知道 d.keys() 将打印出键列表

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T23:01:22.360

既然您已经知道它`d.keys()`提供了键列表，并且您已经知道如何`for`使用列表，那么您为什么不这样做：

```
for k in d.keys():
    print k 
```

?

（或者`repr(k)`，如果您想要带有引号的字符串键）

# php - 使用 PHP 在对象中添加更多字符串

> ID：13772359
> 
> 赞同：0
> 
> 时间：2012-12-07T22:59:10.337
> 
> 标签：php, json

如何使用 PHP 向该对象添加更多字符串？我已经设法生成字符串，但我不能向对象添加更多字符串，也不能删除最后一个逗号。

像这样：

前，

```
{
    "themes":[
    {
        "name": "Amelia",
        "description": "Sweet and cheery.",
        "thumbnail": "http://bootswatch.com/amelia/thumbnail.png"
        }
    ]
} 
```

后，

```
{
    "themes":[
            {
        "name": "juan",
        "description": "esto es un ejemplo.",
        "thumbnail": "http://example.com"
        },
                {
        "name": "juan2",
        "description": "esto es un ejemplo2.",
        "thumbnail": "http://example2.com"
        },
    ]
} 
```

**更新代码：**

```
 // $_POST = Request::post
    if (Request::post('theme_title')) $theme_title = Request::post('theme_title'); else $theme_title = '';
    if (Request::post('theme_img')) $theme_img  = Request::post('theme_img'); else $theme_img = '';
    if (Request::post('theme_desc')) $theme_desc = Request::post('theme_desc'); else $theme_desc = '';

    $jsonfile = 'events.json';

    $data->themes[] = (object)array(
        "name"        => $theme_title,
        "description" => $theme_img,
        "thumbnail"   => $theme_desc

    );

    $json = str_replace('\/','/',json_encode( $data ));

    // $_POST = Request::post
    if (Request::post('Themes_add')){

          // file_put_contents
         File::setContent( $jsonfile, $json,$create_file = true, $append = true, );
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:01:15.357

我想这只是一个字典对象，所以你可以这样做：

```
obj["key1"] = [];
obj["key2"] = [];

{
    "themes":[
            {
        "name": "juan",
        "description": "esto es un ejemplo.",
        "thumbnail": "http://example.com"
        },
                {
        "name": "juan2",
        "description": "esto es un ejemplo2.",
        "thumbnail": "http://example2.com"
        },
    ],
    "key1":[],
    "key2":[]
} 
```

或者要将存储在 $person 中的另一个对象添加到主题键中，您可以：

```
obj["themes"][] = $person; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:02:14.327

“juan2”，这很有趣。像这样的东西：

```
$obj->themes[] = (object)array(
    "name"        => "juan2",
    "description" => "esto es un ejemplo2.",
    "thumbnail"   => "http://example2.com"
); 
```

干杯

# java - 测试结果的问题

> ID：13772370
> 
> 赞同：0
> 
> 时间：2012-12-07T22:59:49.770
> 
> 标签：java

我的任务：

Stix 的游戏——类似于前段时间在“泰国幸存者”中玩的游戏——在简化版本中看起来像这样：

它由两个玩家玩（在幸存者中超过两个，但这里我们只处理两个）。许多棍子（如火柴）放在桌子上。第一个玩家拿走 1、2 或 3 根棍子，前提是桌子上有那么多棍子。然后第二个玩家拿走 1、2 或 3 根棍子（如果可能的话），依此类推。谁拿了最后一根棍子，谁就输了。

这是我的课：

```
public class StixBoard
{
  public int number;

  public StixBoard(int number)
  {
    this.number = number;
  }

  public int getNumStix()
  {
    return number;
  }

  public boolean takeStix(int number)
  {
    int take = 0;

    while(take != number && number <= 3 && number > 0)
    {
      number = this.number - take;
      take++;
    }

    if(this.number >= 1 && this.number <= 3)
    {
      number = number - this.number;
      System.out.println("Number of sticks on board:" + number);
      return(true);
    }
    else
      System.out.println("Illegeal Move");
    return(false);
  }

  public boolean isGameOver()
  {
    if(number >=1)
    {
      return(true);
    }
    else
      return false;
  }

  public String toString()
  {
    return(getNumStix() + " Stix Remaining.");
  }
} 
```

这是我的测试仪：

```
public class StixGame
{

    public static void main(String[] args)
    {

    StixBoard game1 = new StixBoard(6);
    System.out.println(game1.getNumStix());
    System.out.println(game1.takeStix(1));
    System.out.println(game1.getNumStix());
    }

} 
```

我似乎无法回避这个输出：

```
6
Illegeal Move
false
6 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:27:07.993

您使用变量的`number`方式太多次，这将使您的代码非常混乱...使用 IDE 将您的类中的变量重命名为`totalStix`，问题立即变得明显。

*   您的`takeStix`方法不需要 while 循环。正在发生的一切都是一名球员正在拿走stix，对吧？所以删除该代码。
*   然后，很明显（现在变量命名不那么混乱了）您将剩余的棒数视为要带走的数量，因此切换所有这些变量。
*   另外，将方法的参数重命名为`take`，因为这就是你要带走的东西。

剩下以下代码（还有一些其他的小调整）：

```
public class StixBoard
{
  public int totalStix;

  public StixBoard(int number)
  {
    this.totalStix = number;
  }

  public int getNumStix()
  {
    return totalStix;
  }

  public boolean takeStix(int take)
  {
    if(take >= 1 && take <= 3)
    {
      totalStix -= take;
      System.out.println("Number of sticks on board:" + totalStix);
      return true;
    }

    System.out.println("Illegeal Move");
    return false ;
  }

  public boolean isGameOver()
  {
    if(totalStix >=1)
    {
      return(true);
    }
    else
      return false;
  }

  public String toString()
  {
    return(getNumStix() + " Stix Remaining.");
  }
} 
```

# iphone - 优化圆角性能

> ID：13772371
> 
> 赞同：2
> 
> 时间：2012-12-07T22:59:59.373
> 
> 标签：iphone, objective-c, ios, ipad

我的 UITableViewCell 中有以下代码：

```
 [self.layer setBorderColor:[UIColor blackColor].CGColor];
    [self.layer setShadowRadius:10.0];
    [self.layer setCornerRadius:5.0];
    UIBezierPath *path = [UIBezierPath bezierPathWithRoundedRect:self.bounds byRoundingCorners:UIRectCornerAllCorners cornerRadii:CGSizeMake(5.0, 5.0)];
    [self.layer setShadowPath:path.CGPath];
    [self.layer setShouldRasterize:YES];
    [self.layer setRasterizationScale:[UIScreen mainScreen].scale]; 
```

当我运行仪器并在屏幕外设置颜色时 - 呈现黄色，这会导致单元格为黄色。当我删除 shouldRasterize 时，它​​不会将单元格着色为黄色。有什么方法可以改善这种情况？这极大地损害了我的滚动性能。我只是想设置带有一些阴影的圆角。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T04:49:32.743

我正在做这样的圆角：

```
 self.layer.shadowColor = [UIColor grayColor].CGColor;
    self.layer.shadowOffset = CGSizeMake(0.05, 0.05);
    self.layer.shadowOpacity = 10;
    self.layer.shadowRadius = 1.5;
    self.layer.masksToBounds = NO;
    self.layer.shouldRasterize = YES;
    [self.layer setBorderColor: [[UIColor whiteColor] CGColor]];
    [self.layer setBorderWidth: 5.0]; 
```

# entity-framework - EnterpriseLibrary、EF 和事务范围：为什么我会看到不同的行为？

> ID：13772373
> 
> 赞同：0
> 
> 时间：2012-12-07T23:00:10.177
> 
> 标签：entity-framework, entity-framework-4.1, transactionscope

我有一个使用 EnterpriseLibrary 和 Unity 的应用程序，并且只在一个地方使用 TransactionScope。这很好用，尽管它是针对 SQL Server 2005 运行的：

```
// Execute a stored proc using a DbDatabase object inserted by Unity

using(TransactionScope scope = new TransactionScope(TransactionScopeOption.Required))
{
    // Update something using the same DbDatabase object
    // Run the stored proc above, again
    // Assert that the results are different than from the previous call.
} 
```

是的，这故意在没有`scope.Complete()`: 的情况下结束：示例来自测试。

我还有一个刚刚开始的应用程序。它使用实体框架 4.1。它访问同一服务器上的同一数据库。我尝试使用`TransactionScope`，并牢记相同的“进行更改，验证更改，回滚更改”的想法。

```
using(TransactionScope scope = new TransactionScope(TransactionScopeOption.Required))
{
    using(ProjectEntities db = new ProjectEntities())
    {
         Assert.IsFalse(db.tblEntities.Any(e=>e.X == desired_value));

         db.tblEntities.Add(new tblEntity() { X = desired_value });
         db.SaveChanges();

         Assert.IsTrue(db.tblEntities.Any(e=> e.X == desired_value));

    }
} 
```

这将失败，并出现非常熟悉的错误，即未启用 MSDTC 进行网络访问。

现在，这一分钟，第一个项目中的第一个测试成功，第二个测试失败。

所以我有两个问题：

1.  有没有办法重新调整我的第二个测试，以防止事务升级到 MSDTC？

2.  有人知道为什么我从这两个框架中得到不同的结果吗？EntLib 是否在整个使用期间保持分配和打开单个连接？EF做相反的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:02:51.300

我不了解 EnterpriseLibrary，但 EF 确实为每个查询创建并打开新连接，我认为这就是您看到这些不同结果的原因。

您可以通过手动打开两个 DbConnection 来验证这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-29T08:42:14.660

我对 EF、EntLib DAAB 和 TransactionScope 做了很多测试。

您必须考虑到几点。

*   SQL Server 版本
*   连接字符串
*   EF 和 EntLib 版本

我不记得其他组合了，但是使用 SQL Server 2008 或更高版本、EF5 和 Entlib 5，您可以在同一个中注册多个 DbContexts 和 DAAB 操作，`TransactionScope`而无需扩展到 MSDTC。**但是有一个非常棘手的部分：**

*   **连接字符串必须包括：MultipleActiveResultSets=true；**
*   **连接字符串必须具有 EF 使用的确切格式**

第二部分是最令人困惑的：当您使用 EF 的连接字符串时，它会更改其格式，但 EntLib 在配置文件的连接字符串中使用它。因此，您需要做的是调试代码，并记下 EF 使用的连接字符串的修改版本。您可以在 中找到它`ctx.Database.Connection.ConnectionString`，其中 ctx 是您正在使用的 DbContext。完成此操作后，只需将修改后的连接字符串版本复制并粘贴到配置文件中，EF 和 EntLib 都将使用相同的连接字符串，因此不会升级到 MSDTC。

对于 SQL Server 的早期版本（有时取决于 EF 版本），您可能会发现不同的问题，但本指南可以帮助您测试您的确切设置。

# javascript - 为什么此网站无法在 Android 上加载？

> ID：13772374
> 
> 赞同：0
> 
> 时间：2012-12-07T23:00:11.157
> 
> 标签：javascript, android, html, css, opera

我的网站[quizz.pl](http://quizz.pl/)在 FF、Chrome、IE 7-9（大部分）和 Opera 上运行良好。但在 Android 浏览器中，它只显示背景和标题。我无法弄清楚这种行为的根源是什么。你能帮我么？我知道这是一个广泛的问题，但我不知道从哪里开始。

编辑：我已经用 Jukka 建议修复了代码，但它在 Android 和 Opera 中仍然不起作用。在 Opera 中，尤其是在第二次加载之后。有人来帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:14:42.030

[从修复http://validator.w3.org](http://validator.w3.org)报告的 102 标记错误开始

# javascript - 使用 Jquery 和 Javascript 选择图片

> ID：13772377
> 
> 赞同：0
> 
> 时间：2012-12-07T23:00:24.187
> 
> 标签：javascript, jquery, image

我在这里使用 3 张图片测试网站上的布局：

Schechterbusiness.info

左按钮起作用，使其通过图片。但我不知道如何让正确的按钮工作，它应该以另一种方式滚动。我知道可能有一种方法可以用数组来做到这一点，但我无法将我的大脑包裹在它周围。哈！

滚动图片的代码：

```
$('#fryLink').click(function() {
        $('#hide').hide();
        $('#img').hide();

    count++;

        if(count == 1) {

        $('#img').attr("src","images/fry.png");

        }
        else if(count == 2) {

        $('#img').attr("src","images/bender.png");

        }
        else if(count == 3) {

        $('#img').attr("src","images/zoidberg.png");
        }

                $('#img').show("fade");

        if(count > 2) {

        count = 0;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:06:39.853

通常只使用相同的功能就足够了

```
count--; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:08:19.873

跟随第一个回答者

[将事件绑定到鼠标右键](https://stackoverflow.com/questions/706655/bind-event-to-right-mouse-click)

反转计数器；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T23:09:30.247

尝试这个

```
var count = 0;
var imgLength = 3;
$('#leftLink , #rightLink').click(function() {
    $('#hide').hide();
    $('#img').hide();
    if (this.id === 'leftLink') {
        count--;
        if (count < 0) {
            count = imgLength-1;
        }
    }
    else {
        count++;
        if (count > imgLength-1) {
            count = 0;
        }
    }
    var src = "images/fry.png";

    if (count == 1) {
        src = "images/bender.png";
    }
    else if (count == 2) {
        src = "images/zoidberg.png";
    }
    $('#img').attr('src',src).show("fade");
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T23:11:34.250

您有`count`四种状态循环：0、1、2 和 3。但您只为状态 1 - 3 设置图像。

`count`当您的变量为 0时，这会导致复制一张图像（以最后一张为准） 。

至于帮助你得到你想要的东西，不幸的是，这并不是很清楚。这三个按钮应该是一种“前进/某事/倒退”吗？单击中心按钮时，您希望发生什么？

此外，使按钮显示正确的指针/手形图标也很重要。现在他们改为显示文本选择栏，这让人感到困惑，因为它向用户传达了这些项目*不可*点击。

# ios - 从 xls 导入数据并以条形图显示

> ID：13772378
> 
> 赞同：0
> 
> 时间：2012-12-07T23:00:22.797
> 
> 标签：ios, graph, charts, ios6

有一个 xls 文件需要显示为条形图，单击该列需要显示 xls 文件中与 IPAD 上的该列表示有关的数据。我是新手，但我该如何从这里开始。由于它是 xls 格式，我能用它做什么，有一个内置函数可以将其转换为 csv 吗？它是一个离线项目。请帮助我。在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:04:18.350

查看[https://github.com/dhoerl/DHlibxls](https://github.com/dhoerl/DHlibxls) 它有一个很好的 libxls 包装器。没有将 xls 转换为 csv 的内置函数，但您可以使用此库轻松编写自己的函数。

我应该注意 libxls 是 LGPL，所以要小心。

# composer-php - Composer 找不到 vcs 存储库的依赖项

> ID：13772379
> 
> 赞同：1
> 
> 时间：2012-12-07T23:00:24.803
> 
> 标签：composer-php

我有一个奇怪的问题...

project-a 是我的主要项目。project-b 是我的库，已签入 subversion

project-b 的 composer.json

```
{
"name": "fragger/baseclasses",
"version" : "0.0.1-dev",
"description": "Baseclasses and Interfaces",
"require": {
    "silex/silex": "1.0.x-dev",
    "3rd-party/smarty": "3.*",
    "swiftmailer/swiftmailer": "4.2-dev"
},
"autoload": {
    "psr-0": { "baseclasses": "src/" }
}
} 
```

和 project-b 的 composer.json

```
{
"repositories" : [
    {
        "type": "vcs",
        "url" : "svn+ssh://....."
    }
],
"require": {
    "fragger/baseclasses": ">=0.0.1-dev"
}
} 
```

安装命令的输出

```
php composer.phar install
Loading composer repositories with package information
Installing dependencies                               
Your requirements could not be resolved to an installable set of packages.

  Problem 1
    - Installation request for fragger/baseclasses >=0.0.1-dev -> satisfiable by     fragger/baseclasses dev-trunk.
    - fragger/baseclasses dev-trunk requires silex/silex 1.0.x-dev -> no matching package     found. 
```

但是作曲家单独安装在项目a中，工作正常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T18:34:00.293

[您可以在packgist](https://packagist.org/)上找到有关软件包的详细信息，例如 for [`Silex`](https://packagist.org/packages/silex/silex)，但您的所有依赖项似乎都有无效的版本字符串。

取而代之的`"silex/silex": "1.0.x-dev"`是必须命名`"silex/silex": "1.0.*@dev"`。没有分支，`1.0.x`并且分支的正确版本字符串`dev-branchname`无论如何都是;）

# python - 将变量传递给 Python 中的函数

> ID：13772386
> 
> 赞同：0
> 
> 时间：2012-12-07T23:01:17.710
> 
> 标签：python, selenium, nose

我用 Python 编写用于 Selenium Web 测试的测试脚本。

如何通过 Python 函数传递参数以调用稍后的函数？我首先有一个登录测试功能。然后我有一个新的用户注册功能。我试图将我在注册函数中使用的用户名和密码传递给我在`testLogin()`函数内部调用的`testRegister()`函数。

这是我的python代码：

```
userName = "admin"
password = "admin"

#pass username and password variables to this function
def testLogin(userName,password):
  browser = webdriver.Firefox()
  browser.get("http://url/login")

  element = browser.find_element_by_name("userName")
  element.send_keys(userName)

  element = browser.find_element_by_name("userPassword")
  element.send_keys(password)

  element.send_keys(Keys.RETURN)

  browser.close()

# test registration
def testRegister():
  browser = webdriver.Firefox()
  browser.get("http://url/register")

  #new username variable
  newUserName = "test"
  element = browser.find_element_by_name("regUser")
  element.send_keys(newUserName)

  #new password variable
  newUserPassword = "test"
  element = browser.find_element_by_name("regPassword")
  element.send_keys(newUserPassword)

  #
  #now test if user is registered, I want to call testLogin with the test user name and pw.
  testLogin(newUserName,newUserPassword)

  browser.close() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:06:07.403

你周围的任何值——无论是作为函数参数获取，还是通过调用函数接收它们，或者只是动态定义它们——你都可以作为参数传递给任何其他函数。

因此，如果您想传递一些值`testRegister`以使其与 with 一起使用`testLogin`，只需执行以下操作：

```
# test registration
def testRegister(userName, password):
  browser = webdriver.Firefox()
  browser.get("http://url/register")

  element = browser.find_element_by_name("regUser")
  element.send_keys(userName)

  element = browser.find_element_by_name("regPassword")
  element.send_keys(password) 
```

你还有什么想要的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T01:34:49.470

您可以创建一个新函数来运行所有测试。

```
def run_tests(username, password):
    testLogin(username,password)
    testRegister(username, password) 
```

您将需要修改 testRegister 以便它接受用户名和密码参数。

然后你可以用 run_tests('admin', 'letmein') 开始你的脚本

# java - 字符串替换所有条件

> ID：13772399
> 
> 赞同：1
> 
> 时间：2012-12-07T23:02:12.990
> 
> 标签：java, regex, string, replaceall

我不擅长正则表达式，我需要帮助来替换字符串。

```
String str = "Name_XYZ_";
       str = "XYZ_NAME_"; 
```

那么如何用空字符串替换`"Name_"`或`"_NAME_"`从上面的两个字符串中替换？条件`"Name"`可以在任何情况下，并且可以在`index 0`或在任何索引处，但`preceded by "_"`.

到目前为止，我尝试过，

```
String replacedString = str.replaceAll("(?i)Name_", ""); // This is not correct. 
```

这不是家庭作业。我正在处理需要这种处理的 XML 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:04:17.777

```
String replacedString = str.replaceAll("(?i)(?:^|_)name_", ""); 
```

你很亲密。您需要做的是*锚* [定](http://www.regular-expressions.info/anchors.html) `name`到字符串的开头（带有`^`）*或*需要一个下划线。我也更改`Name`为`name`，因为如果您无论如何都对模式不区分大小写，为什么要混合小写和大写。请注意，这`?:`只是一种优化（也是一种很好的做法）。它会抑制在这种情况下不需要的[捕获。](http://www.regular-expressions.info/brackets.html)

如果你想提高你的正则表达式技能，我强烈推荐[这个教程](http://www.regular-expressions.info/tutorial.html)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-07T23:06:34.153

我正在使用 .NET 的正则表达式而不是 Java 的，但在这种情况下`(_?Name_)`应该可以工作。

# templates - 玩2、如何重用带有标签的HTML代码

> ID：13772404
> 
> 赞同：1
> 
> 时间：2012-12-07T23:02:38.537
> 
> 标签：templates, playframework-2.0

在玩！Framework v. 1.x 有类似“标签”之类的东西，可以重用一些 thml/模板代码。

在玩！Framework v 2.x，对我来说还不清楚它将如何使用（[这里](http://www.playframework.org/documentation/2.0/ScalaTemplateUseCases)）。

例如，我想使用标签为我的网站定义一个标题（为了不重复我自己，而只是在我需要的页面中包含标题）。

有人可以解释我/展示如何使用标签，或者我应该使用什么来包含标题或任何 html/模板代码块。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T23:14:23.677

你给我们看了一个样品，你要样品:)

这很简单，在包中创建一个通用视图`views.tags`（如果您不打算传递任何参数，请记住将第一行留空！还记得在标签名称后添加括号）：

**/app/views/tags/header.scala.html**

```
<div id="header">
    <h1>Hello World!</h1>
</div> 
```

因此，您可以将其“包含”在任何其他视图中，只需：

```
<body>
    @tags.header()
    Some other content
</body> 
```

# svn - IDE 中的源代码管理

> ID：13772406
> 
> 赞同：1
> 
> 时间：2012-12-07T23:02:45.137
> 
> 标签：svn, version-control

我在尝试使用它的任何 IDE 中使用 SVN 时遇到问题。它总是给出相同的错误：

> svn: E175002: 未知主机

我已经在[PHPStorm](http://www.jetbrains.com/phpstorm/)、[IntelliJ](http://www.jetbrains.com/idea/)和[Zend Studio](http://www.zend.com/en/products/studio/)中尝试过，它们都给了我完全相同的错误。我已经尝试过使用 IP 和普通地址。我正在为我的 SVN 托管使用[assembla](https://www.assembla.com/home)，尽管我也尝试过使用[beanstalkapp](http://beanstalkapp.com/)并得到相同的错误。这两个都是`https://`所以我也尝试过使用普通的`http://`SVN 主机，但同样的错误。

奇怪的是，同一台 PC 上的 Tortiose SVN 可以正常工作吗？我查看了整个互联网，找不到解决方案。

电脑详情：

*   视窗 8 32 位。
*   所有防病毒和防火墙软件均已关闭。

svn ls URL 的 CLI 客户端结果：

```
svn: E175002: Unable to connect to a repository at URL 'https://subversion.assem
bla.com/svn/ajacode'
svn: E175002: OPTIONS of 'https://subversion.assembla.com/svn/ajacode': Could no
t resolve hostname `https://subversion.assembla.com/svn/ajacode': No such host is
known.
 (https://subversion.assembla.com) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T16:10:46.453

这是网络问题，与DNS解析有关。为了快速解决问题，请尝试通过编辑操作系统的[hosts 文件](http://en.wikipedia.org/wiki/Hosts_%28file%29)手动解析您的主机，例如：

```
64.250.188.50 subversion.assembla.com  
50.31.156.75 ajacode.svn.beanstalkapp.com 
```

也请联系您的 ISP 或网络管理员了解此问题

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T02:11:25.830

我不知道如何仅发表评论而不是答案... xD

Web 浏览器可能正在使用 Web 代理，并且 svn 客户端无法访问主机名，因为没有直接的 Internet 连接。

# java - 将文件中的 WINDOWS-1252 编码文本显示为 html

> ID：13772413
> 
> 赞同：0
> 
> 时间：2012-12-07T23:03:10.353
> 
> 标签：java, utf

我有一个带有 WINDOWS-1252 字符（如 ø 和 ß）的文本文件。该文件正在通过表单提交上传到 servlet，在其中使用 opencsv 对其进行解析并作为 List 对象返回到显示它的 jsp 页面。utf-8 字符显示为？我正试图找出编码可能出错的地方。我尝试了很多东西：

*   我的页面有标签`<%@page contentType="text/html" pageEncoding="WINDOWS-1252"%>`

*   文件输入被编码 -`new FileInputStream(file), "WINDOWS-1252")`

*   每个字符串都经过编码 -`s = new String(s.getBytes("WINDOWS-1252"));`

编码还能在哪里失败？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:12:48.110

一些故障排除建议：

在各个阶段调试打印或以其他方式检查文本为十六进制，并验证编码是否确实是您所期望的。

确保没有 BOM（字节顺序标记），如果有，请查看此问题和其中的链接，并且您没有简单的方法来摆脱它：[Reading UTF-8 - BOM marker](https://stackoverflow.com/questions/4897876/reading-utf-8-bom-marker)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T09:24:18.103

OK 问题已解决。所以第一个问题是它根本不是 utf-8 文件，而是 WINDOWS-1252 文件。我确定使用 juniversalchardet 库（非常有用且易于使用）。然后我必须确保我正在使用 FileInputStream 读取具有正确字符集的文件：

```
new FileInputStream(file), "WINDOWS-1252") 
```

我只需要确保我使用标签在 jsp 文件中使用正确的字符集显示它 `<%@page contentType="text/html" pageEncoding="WINDOWS-1252"%>`

差不多就是这样-

(1) 确定字符集

(2) 确保您正在正确读取文件

(3) 确保显示正确

# android - 用户平均评论

> ID：13772422
> 
> 赞同：0
> 
> 时间：2012-12-07T23:04:08.773
> 
> 标签：android, rating

我需要我的评分栏来跟上用户的平均评分。我有一个主菜单，其中包含几个项目，每个项目都有自己的屏幕和描述。我在每个屏幕上添加了一个评分栏，以便用户可以提交他们的产品评分/查看其他人的平均评分/查看评分数量。有点像亚马逊应用程序上的客户评论，但没有条形图。我已经设置了 xml 文件，但需要有关 java.xml 的帮助。任何帮助，将不胜感激。这是其中一个屏幕的示例。

xml:

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<TextView
    android:id="@+id/tv1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:layout_marginTop="40dp"
    android:text="TextView"
    android:textSize="50dp" />

<TextView
    android:id="@+id/tv2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:text="TextView" />

<RatingBar
    android:id="@+id/ratingBar1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:layout_marginTop="40dp"
    android:layout_weight="50" />

<Button
    android:id="@+id/button1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:layout_marginBottom="150dp"
    android:text="Submit" />

</LinearLayout> 
```

爪哇

```
public class MainActivity extends Activity {

RatingBar ratings;
TextView tv1, tv2;
Button b; 

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    RatingBar rb = (RatingBar) findViewById(R.id.ratingbar);

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:25:55.327

为了实现类似的目标，您必须在您的应用程序上创建一个 SQLiteDatabase。

1.  将用户评分的每个产品的 ratingBar 值存储在数据库中。
2.  将本地 SQLiteDatabase 中的值发布到服务器。
3.  编辑您在服务器中获得的值。找到 max-min-middle 等并将它们存储在“全局”数据库中。
4.  将编辑后的结果发回您的应用程序。
5.  在您自己的 timeshift 上重复上述步骤，您将获得所需的结果！

# php - 验证码图像未加载？

> ID：13772426
> 
> 赞同：1
> 
> 时间：2012-12-07T23:04:18.430
> 
> 标签：php

我如何让它加载？现在，它根本没有显示任何图像......我不太擅长创建验证码，因为我通常从不这样做。

验证码.php：

```
<?php
$string = '';
for ($i = 0; $i < 5; $i++) {
    // this numbers refer to numbers of the ascii table (lower case)  
    $string .= chr(rand(97, 122));
}
$image = imagecreatetruecolor(170, 60);
$color = imagecolorallocate($image, 200, 100, 90); // red
$white = imagecolorallocate($image, 255, 255, 255);
imagefilledrectangle($image,0,0,399,99,$white);
imagettftext ($image, 30, 0, 10, 40, $color, ASSETPATH."arial.ttf", $string);
header("Content-type: image/png");
imagepng($image);
?> 
```

注册.php：

```
<?php echo '<img src="'.ASSETPATH.'img/captcha.php" />'; ?> 
```

我的资产路径是正确的，因为我在其他地方使用它并且加载得非常好。这个项目的 MVC 格式是否以某种方式搞砸了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:06:16.390

如何使用其中一种验证码服务，如 recaptcha？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T03:13:56.610

从您`ASSETPATH`对图像 URI 以及 imagettftext 中的**字体**[文件](http://php.net/imagettftext)路径的使用来看，我只能假设您的字体文件存储在与图像相同的路径中？

如果不是这种情况，或者无法在此处打开文件，PHP 将抛出`imagettftext(): Invalid font filename`. 如果在您的 php.ini 中将[display_errors](http://php.net/manual/en/errorfunc.configuration.php#ini.display-errors)设置为*On*（您可以检查[phpinfo](http://php.net/phpinfo)来验证这一点），这意味着错误消息将与您的图像数据一起发送到输出流（即损坏图像数据并导致您的浏览器不显示图片）。这也将防止标头被修改，因为错误会在您调用标头之前发生。

但是，如果 display_errors 没有打开并且 PHP 找不到您提供的字体文件，或者由于任何原因（例如*权限*）无法打开它，结果将是一个空白的 170x60 PNG 图像。

如果我在本地测试您的代码，它证明可以按预期工作，只要我为 PHP 提供我的 truetype 字体文件的正确绝对路径。

例如，我的系统上有一些 truetype 字体存储在`/usr/share/fonts/truetype/`，这绝对不在我的 webroot 中，因为我通常不会将我的字体文件保存在那里。另请注意，我的 PHP 用户有足够的*权限*从该路径读取。

现在，如果我为 PHP 提供我想使用的 truetype 字体文件的正确绝对路径，我会使用您的代码获得以下图像...

```
$string = '';
for ($i = 0; $i < 5; $i++) {
    // this numbers refer to numbers of the ascii table (lower case)
    $string .= chr(rand(97, 122));
}
$image = imagecreatetruecolor(170, 60);
$color = imagecolorallocate($image, 200, 100, 90); // red
$white = imagecolorallocate($image, 255, 255, 255);
imagefilledrectangle($image,0,0,399,99,$white);
imagettftext ($image, 30, 0, 10, 40, $color, '/usr/share/fonts/truetype/ttf-dejavu/DejaVuSans-ExtraLight.ttf', $string);
header("Content-type: image/png");
imagepng($image); 
```

![上述代码的图像输出](../Images/0d3c658038a87734ea47f4cfe1213478.png)

为了进一步调试，您应该尝试运行自行生成图像的 PHP 脚本，打开 display_errors 并将[error_reporting](http://php.net/error-reporting)设置为`-1`，如果确实是您的字体文件是问题，您将看到这个在您的 error_log 或在使用 display_errors 测试该脚本期间显示的错误输出中。

# shadow - 影子没有出现

> ID：13772427
> 
> 赞同：41
> 
> 时间：2012-12-07T23:04:22.270
> 
> 标签：shadow, css

我试图在其中一个 div 中放置阴影，但它没有出现。这是我试图实现阴影的一个 div：

```
#intro {
    padding: 0px;
    margin: 0px auto;
    width: 100%;
    float:inherit;
    overflow: hidden;
    height: 800px;
    position:inherit;
    background-color: #00b3e1;; 
    box-shadow: 0 0 50px rgba(0,0,0,0.8);
} 
```

这是网址：[http ://rachelchaikof.com/awareness/](http://rachelchaikof.com/awareness/)

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2012-12-07T23:16:25.890

看不到阴影的原因是下一个 div (#one) 就在它的正下方，而阴影在 #one 下方呈现。从#one 中删除背景图像，阴影变得可见。

将此添加到#intro 的 CSS 以使阴影可见：

```
position: relative;
z-index: 10; 
```

如果您希望阴影在其他文本区域上可见，您还需要调整它们的 z-index 值，顶部元素 (#intro) 具有最高值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-19T06:38:12.490

我今天遇到的另一种情况。尽管设置了相对于 div 的位置，但盒子阴影没有出现。显然，这个 div 旁边没有包含框阴影的内容。

一旦添加了内容，box-shadow 就会出现。

# bouncycastle - 同一密钥环中的多个密钥

> ID：13772428
> 
> 赞同：1
> 
> 时间：2012-12-07T23:04:29.583
> 
> 标签：bouncycastle, pgp

这可能是一个非常基本的问题，可能已经讨论过，但我想确保我理解正确，因此与问题一起说明

1.  我的公司要从 5 个不同的供应商处获取文件。他们每个人都会在发送给我之前加密文件。他们还提前将公钥发送给了我——所以我有来自 5 个供应商的 5 个公钥
2.  现在我的问题是我可以制作一个由这 5 个公钥组成的密钥环吗？
3.  如果 2 的答案是肯定的，那么在我的程序中，我可以使用 keyrong 来解密来自任何具有 KeyRing 的供应商的消息吗？

如果有帮助，我正在尝试使用 bouncycastle 进行操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T12:34:48.033

不幸的是，bouncycastle API 没有提供开箱即用的功能。

您将需要一些额外的编码来通过充气城堡类 PGPPublicKeyRingCollection 来实现它。

您还可以从提供此类功能的商业 BC 包装器中检查此示例： [http ://www.didisoft.com/java-openpgp/examples/import-keys/](http://www.didisoft.com/java-openpgp/examples/import-keys/)

# c# - 获取机器的网络属性

> ID：13772429
> 
> 赞同：1
> 
> 时间：2012-12-07T23:04:40.390
> 
> 标签：c#

我正在寻找可以显示机器所有网络属性的类：IP、默认网关、Mac 地址、默认网关、适配器速度等。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:07:27.347

[您可以使用NetworkInformation](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.networkinterface.aspx)类获取此信息 。

此处演示了获取有关 IP 地址的信息：[IPInterfaceProperties](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ipinterfaceproperties.aspx)

要获得链接速度，您可能需要使用[Windows 管理接口 (WMI)](http://code.msdn.microsoft.com/windowsdesktop/Using-WMI-with-C-4e5a9ee1)。作为研究的起点，您需要运行以下 WMI 查询：

```
SELECT NdisLinkSpeed FROM MSNdis_LinkSpeed 
```

然后将其转换为 MB/s：

```
SpeedInMbps = NdisLinkSpeed / 10000 
```

# iphone - 停止 UIGestureRecognizer 调用选择器

> ID：13772431
> 
> 赞同：0
> 
> 时间：2012-12-07T23:05:11.880
> 
> 标签：iphone, ios, uigesturerecognizer

我正在添加一些带有目标和选择器的 UIGestureRecognizers。我只谈一个，因为另一个我敢肯定。

我添加了一个 UIPinchGestureRecognizer

```
UIPinchGestureRecognizer *pinch = [UIPinchGestureRecognizer new];
[pinch addTarget:self action:@selector(pinchGestureDetected:)];
[self.view setMultipleTouchEnabled:YES];
[self.view addGestureRecognizer:pinch]; 
```

现在我的目标是在收到捏合手势时简单地调用此方法一次。但很明显，当人们捏捏它时，它会继续调用它。我将它用作页面导航的一部分，并在检测到捏合时更新视图。

所以在我的 -(void)pinchGestureDetected:(UIPinchGestureRecognizer)pinch 方法中，我将调用另一个方法。有点像……这有点 sudo

```
-(void)pinchGestureDetected:(UIPinchGestureRecognizer)pinch
{
if (pinch.scale > 1) layoutViewWithMoreDetail;
else layoutViewWithLessDetail;
} 
```

所以我不希望它一直调用这个方法或者layout方法会继续被调用。我想要一种布局/捏合手势。

一旦确定了比例，有什么方法可以停止检测夹点？一路上的东西...

```
-(void)pinchGestureDetected:(UIPinchGestureRecognizer)pinch
{
if (pinch.scale > 1)
{
layoutViewWithMoreDetail;
stop receiving pinch gestures till this.gesture is finished;
} 
```

我会暗示 GestureDelegate 吗？

```
-(void)pinchGestureDetected:(UIPinchGestureRecognizer)pinch
{
if (pinch.scale > 1 && pinching == NO )
{
layoutViewWithMoreDetail;
pinching = YES;
} 
```

然后在 Gesture 的代表中结束... pinching = NO;

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:08:52.047

`UPinchGestureRecognizer`是一个连续手势 - 用于`if(pinch.state == UIGestureRecognizerStateBegan)`检测事件是否刚刚开始。

但是，这会导致触发事件的阈值较低。另一种方法是在触发令您满意时快速禁用和启用手势，如下所示：

```
-(void)pinchGestureDetected:(UIPinchGestureRecognizer)pinch
{
    if (pinch.scale > 1)
    {
        //do your stuff here
        pinch.enabled = NO;
        pinch.enabled = YES;
    }
} 
```

这是因为如果您查看[文档](http://developer.apple.com/library/iOS/#documentation/UIKit/Reference/UIGestureRecognizer_Class/Reference/Reference.html)，它会指出：

> 启用
> 
> 一个布尔属性，指示是否启用手势识别器。@property(nonatomic, getter=isEnabled) BOOL 已启用
> 
> 讨论
> 
> 禁用手势识别器，使其不接收触摸。默认值为是。如果在手势识别器当前正在识别手势时将此属性更改为 NO，则手势识别器将转换为取消状态。

# caching - 将值存储在单独的 CPU 缓存组中

> ID：13772434
> 
> 赞同：1
> 
> 时间：2012-12-07T23:05:25.297
> 
> 标签：caching, mips, cpu-architecture, cpu-cache

作为课堂项目的一部分，我正在寻找提高 CPU 架构中寻路算法性能的方法。该算法是用 C++ 实现的。基本操作是读取 x,y 坐标并对它们执行一些操作。

我现在的想法是将 x 和 y 坐标分别存储在两个缓存组中（设置关联）。为一个位置输入的两个坐标应存储在不同的存储库中，以便能够并行读取它们，并对 x 和 y 坐标进行单独操作并存储组合结果。通过使用矢量运算，该过程可以进一步加快，同时读取多达 4 个 x 坐标和 4 个 y 坐标。

例如，为了计算到目标节点的欧几里得距离，必须在每个位置读取 x 和 y 坐标并从目标坐标中减去以找出距离。

我想知道是否有一种有效的方法（缓存放置策略）将 x 和 y 坐标保持在不同的缓存行/块中以利用并行性。是否有任何坐标操作/编码可以用来实现它？

PS：我不是在寻找软件优化，而是在寻找修改后的缓存设计（理论上）来加速算法。

参考：这篇[博文](http://igoro.com/archive/gallery-of-processor-cache-effects/)提到“如果 L1 缓存访问来自不同 bank 的缓存行，则它们可以并行处理两个访问，如果它们属于同一个 bank，则可以串行处理。”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T02:09:55.400

保存在如下结构中的坐标：

```
struct {
  int x;
  int y;
} coordinate; 
```

将适合单个缓存行。事实上，在具有 32 字节高速缓存行的典型 MIPS 处理器上，8 个实例`coordinate`将适合一个高速缓存行。*CPU 将从数据缓存中的单个存储体或路径*一次读取整行，并且所有 32 字节或所有 4 个坐标将从那时起在 32 字节*填充/存储缓冲区*(FSB) 中以零延迟到流水线可用. 具有高速缓存的 MIPS 处理器通常具有多个 FSB。

*具有分块或组关联*缓存的 MIPS 处理器通常使用[LRU](http://en.wikipedia.org/wiki/Cache_algorithms#Least_Recently_Used)算法来选择在缓存未命中时将新数据放入哪个库/路径。通常不可能确保来自某个位置的数据始终以特定*方式*放置在缓存中。

所有这一切都是说，您将 x 和 y 坐标存储在单独的缓存组中的方案不会比幼稚方案提高性能，因为 FSB 对幼稚方案的积极影响以及由于*方式*选择算法的不可预测的影响缓存。

# hibernate - 与 Grails 中同一域类的一对一和一对多关联

> ID：13772435
> 
> 赞同：0
> 
> 时间：2012-12-07T23:05:26.967
> 
> 标签：hibernate, grails, associations, one-to-many, one-to-one

我有两个域类 -`Account`和`Member`，并且我无法找到关联和`mappedBy`属性的正确组合来建模它们的关系。用简单的英语来说，an`Account`需要一个且只有一个主要成员。它也有 0 - 许多家属。我最初的尝试看起来像：

Account.groovy

```
class Account {
    String displayId

    Member primaryMember
    SortedSet<Member> dependents = new TreeSet<Member>()

    static belongsTo = [Member]
    static hasMany = [dependents: Member]
} 
```

成员.groovy

```
class Member implements Comparable<Member> {
    MemberType memberType = MemberType.PRIMARY
    String firstName
    String lastName

    static belongsTo = [account: Account]

    @Override
    int compareTo(Member m) {
        return (this.memberType <=> m?.memberType) * 100 + (this.lastName <=> m?.lastName) * 10 + (this.firstName <=> m?.firstName)
    }
} 
```

当我尝试实例化和持久化帐户和成员时，这会导致问题。例如，

AccountIntegrationTests.groovy

```
class AccountIntegrationTests extends GroovyTestCase {

    Account smiths
    Member john
    Member jane

    @Before
    void setup() {}

    @Test
    void testShouldLoadAccountWithNoDependents() {
        // Arrange
        smiths = new Account(displayId: "ABCDEFG")

        john = new Member(firstName: "John", lastName: "Smith", memberType: MemberType.PRIMARY)
        smiths.primaryMember = john
        smiths.save(flush: true, failOnError: true)

        def smithsId = smiths.id
        smiths.discard()

        // Act
        def loadedSmiths = Account.get(smithsId)

        // Assert
        assert loadedSmiths.members.size() == 1
        assert loadedSmiths.primaryMember == john
        assert loadedSmiths.dependents.size() == 0
    }

    @Test
    void testShouldLoadAccountWithOneDependent() {
        // Arrange
        smiths = new Account(displayId: "ABCDEFG")
        john = new Member(firstName: "John", lastName: "Smith", memberType: MemberType.PRIMARY)
        smiths.primaryMember = john
        smiths.addToDependents(new Member(firstName: "Jane", lastName: "Smith", memberType: MemberType.DEPENDENT))
        smiths.save(flush: true, failOnError: true)

        john = smiths.primaryMember
        jane = smiths.dependents.first()
        def smithsId = smiths.id
        smiths.discard()

        // Act
        def loadedSmiths = Account.get(smithsId)

        // Assert
        assert loadedSmiths.members.size() == 2
        assert loadedSmiths.primaryMember.firstName == "john"
        assert loadedSmiths.dependents.size() == 1
        assert loadedSmiths.dependents.first().firstName == "jane"
    }
} 
```

将抛出异常，因为第二个测试的数据库表看起来像

帐户

```
id | display_id
1  | ABCDEFG 
```

成员

```
id | first_name | last_name | member_type | account_id
1  | John       | Smith     | Primary     | 1
2  | Jane       | Smith     | Dependent   | 1 
```

显然我希望帐户检索 John 作为主要成员，Jane 作为依赖，但是当 GORM 尝试加载 account.primaryMember 时，它会抛出一个 Hibernate 异常，即有多个行（在成员中）匹配帐户 ID（1 ）。我需要一个`mappedBy`鉴别器来区分这两个关联，但是我尝试过的版本不起作用：

帐户

```
static mappedBy = [primaryMember: 'primaryMember', dependents: 'dependents']
- or -
static mappedBy = [dependents: 'account'] 
```

我已经阅读了关联的 GORM 文档[`mappedBy`](http://grails.org/doc/latest/ref/Domain%20Classes/mappedBy.html)，以及[网站上](https://stackoverflow.com/questions/7536669/multiple-hasmany-relationships-to-same-domain-class-in-grails)关于[同一模型](http://grails.1312388.n4.nabble.com/possible-bug-with-hasOne-td3394999.html)的[多个关联](https://stackoverflow.com/questions/1654277/multiple-associations-in-grails)的[各种](https://stackoverflow.com/questions/11640996/grails-hasone-and-hasmany-same-domain) [问题](https://stackoverflow.com/questions/7647584/hibernate-mapping-onetomany-and-onetoone-on-child-object-property)，不幸的是，它们似乎都在为多个关联建模。确实将一对多和一对一关系都引用到同一模型的那个将其说明为：`hasMany`

```
class Person {
    String name

    static belongsTo = [team: Team]
}

class Team {
    String name

    static belongsTo = [coach: Person]
    static hasMany = [players: Person]
} 
```

但是，我尝试使用这个简单的实现并得到：

```
--Output from testShouldLoadAccountWithNoDependents--
| Failure:  testShouldLoadAccountWithNoDependents(AccountIntegrationTests)
|  org.springframework.dao.InvalidDataAccessApiUsageException: object references an unsaved transient instance - save the transient instance before flushing: Account; nested exception is org.hibernate.TransientObjectException: object references an unsaved transient instance - save the transient instance before flushing: Account
    at AccountIntegrationTests.testShouldLoadAccountWithNoDependents(AccountIntegrationTests.groovy:26)
Caused by: org.hibernate.TransientObjectException: object references an unsaved transient instance - save the transient instance before flushing: Account
    ... 1 more 
```

`AccountIntegrationTests.groovy:26`是行`smiths.save(flush: true, failOnError: true)`。当我将`Team/Account`课程修改为：

```
class Team {
    String name
    Person coach

    static hasMany = [players: Person]
} 
```

我遇到了同样的异常，所以我相信某种`cascade`是必需的。我尝试添加`cascade`一个`Account`：

帐户

```
static mapping = {
    primaryMember cascade: 'all'
    dependents cascade: 'all-delete-orphan'
} 
```

然后我也尝试使用事件触发器：

帐户

```
def beforeInsert() {
    if (primaryMember?.isDirty()) {
        primaryMember.save()
    }
}

def beforeUpdate() {
    if (primaryMember?.isDirty()) {
        primaryMember.save()
    }
} 
```

不幸的是，这些方法都没有解决`transient instance`异常。非常感谢您对此的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:45:03.507

令人尴尬的简单解决方案是删除`static belongsTo = [account: Account]`from `Member`。双向关联导致了这些问题。

# sql - 更新 sql server 2008 中的 XML 字段

> ID：13772438
> 
> 赞同：-1
> 
> 时间：2012-12-07T23:05:56.387
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2008-r2

我在一张表中有 XML 字段。我想更新那个字段。这是 XML 格式：

```
<data><user>abcd</user></data> 
```

我想将值更改`abcd`为`efgh`. 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:18:47.897

以下是一些示例，展示如何更新常量、变量或使用现有列信息：

```
declare @x table(i bigint not null identity(1,1), x xml, y nvarchar(64))
declare @z nvarchar(64) = 'sql variable data'

insert @x select '<data><user>abcd</user></data>', 'sql column data 1'
insert @x select '<data><user>abcd</user></data>', 'sql column data 2'
insert @x select '<data><user>abcd</user></data>', 'sql column data 3'

update @x
set x.modify('replace value of (/data/user/text())[1] with ''efgh''')
where i=1

update @x
set x.modify('replace value of (/data/user/text())[1] with sql:column(''y'')')
where i=2

update @x
set x.modify('replace value of (/data/user/text())[1] with sql:variable(''@z'')')
where i=3

select * from @x 
```

输出：

```
i   x                                           y
1   <data><user>efgh</user></data>              sql column data 1
2   <data><user>sql column data 2</user></data> sql column data 2
3   <data><user>sql variable data</user></data> sql column data 3 
```

# javascript - 如何将自定义大小的图标放入 jQuery UI 按钮中？

> ID：13772439
> 
> 赞同：1
> 
> 时间：2012-12-07T23:05:56.260
> 
> 标签：javascript, html, css, jquery-ui

我正在尝试使用与标准图标大小不同的自定义图标创建 jQuery UI 按钮，但是在使这些自定义图标正确适合按钮时遇到了困难。下面的代码演示了我如何`<button>`用 50x17 像素的图标装饰所有元素，我还创建了一个相应的[fiddle](http://jsfiddle.net/rG89E/)。

Javascript：

```
$('button').button({icons: {primary: 'login-icon'}, text: false});​ 
```

CSS：

```
.ui-button .ui-icon.login-icon {
    background-image: url(http://i.imgur.com/qLgpl.png);
    width: 50px;
    height: 17px; 
}​ 
```

问题是如何使按钮与这种自定义大小的图标配合在一起，即使图标正确放置*在*（垂直/水平对齐）父按钮内？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T11:07:40.363

在研究了 jQuery UI 生成的 CSS 之后，我找到了一个解决方案。我发现诀窍在于`span`使用以下 CSS 规则将包含图标的图标定位在其父级（按钮）内：

```
position: absolute;
left: 50%;
top: 50%;
margin-left: -8px;
margin-top: -8px; 
```

定位规则 ( `position`, `left`, `top`) 的意思是，在没有边距的情况下，图标的左边缘应该是父级宽度的 50%，上边缘应该是父级高度的 50%，即图标的左上角将是smack 在按钮的中间，如图所示：

![居中的图标](../Images/a88eb37abe28f7a1ed39056cb5d0230a.png)

在负边距的帮助下，图标向左偏移一半长度，向上偏移一半高度，以便它有效地位于父元素的中心。8 像素的值是由于 jQuery 的图标是 16x16 像素。

然后我必须进行的调整是根据我的图标 (50x17) 的大小将边距修改为 25 和 8 像素：

```
position: absolute;
left: 50%;
top: 50%;
margin-left: -25px;
margin-top: -8px; 
```

[你可以在这个更新的小提琴](http://jsfiddle.net/wUU5B/1/)中看到我的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-18T16:50:50.337

在即将发布的 CSS 版本中，您可以使用`transform:scale(2,2);` [JSFiddled对其进行扩展](http://jsfiddle.net/4qQbB/1/)

# javascript - 在浏览器中流式传输音频的最佳选择，也适用于移动设备？

> ID：13772443
> 
> 赞同：4
> 
> 时间：2012-12-07T23:06:22.193
> 
> 标签：javascript, html, audio-streaming, shoutcast

我正在尝试为我的网站寻找一个迫切需要升级的解决方案。目前，我正在使用基于 Flash 的播放器从 Shoutcast 流式传输内容，这不是很有效，但不幸的是它让移动用户落后了。

理想情况下，我希望有一个可以在线播放 Shoutcast（或其他）流的 HTML5/Javascript 播放器。我试过 jPlayer，它似乎非常适合播放单个文件，但试图让它与 Shoutcast 和 Icecast 一起工作却没有成功。

有人对从哪里开始有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T05:58:13.310

您可以使用 jPlayer 使用 HTML5 原生播放器播放您的直播流 - 它在大多数浏览器/平台上运行良好，*除了*android。在这种情况下，jPlayer 提供 Flash 播放器备份。

您需要将音频类型指定为“mp3”（aac 流不起作用，因此请确保您指定的是直接冰冷的 mp3 流）我使用了“mp3”，但您也可以尝试输入“流”

您需要稍微更改流的 url：

正常：http: [//yourserver.com :8000/listen.pls](http://yourserver.com:8000/listen.pls)

jPlayer：http: [//yourserver.com](http://yourserver.com:8000/;listen.pls) :8000/;listen.pls （注意添加分号 - 这有助于直播服务器）

这是 jPlayer 网站上的文档，它也应该有所帮助。

[http://www.jplayer.org/latest/demo-08/](http://www.jplayer.org/latest/demo-08/)

快乐流媒体！

# php - 如何访问codeigniter中的数组字段？

> ID：13772444
> 
> 赞同：0
> 
> 时间：2012-12-07T23:06:24.223
> 
> 标签：php, mysql, codeigniter

我正在尝试将两个数组（$a_1 和 $a_2）从我的控制器传递到我的视图，如下所示：

```
$this->load->view('confirm_data_v', $a_1, $a_2); 
```

在我看来，我想打印其中一个这样做的价值：

```
<p><?php echo $name ?></p>
<p><?php echo $mail ?></p> 
```

当我打印每个数组时，我得到了这个：

```
Array
(
    [name] => jon
)
Array
(
    [mail] => blabla@server.com

) 
```

$name 是 $a_1 中的一个字段，$mail 是 $a_2 中的一个字段，但视图似乎不知道这些字段在哪里，我的意思是，它不知道数组中的 $name 和 $mail , 是 $a_1 还是 $a_2。我怎么做？。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:10:28.140

codeigniter wiki 是这样的

```
$data = array(
               'name' => $a_1['name'],
               'mail' => $a_2['mail'],
          );

$this->load->view('confirm_data_v', $data); 
```

[https://www.codeigniter.com/user_guide/general/views.html](https://www.codeigniter.com/user_guide/general/views.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:12:35.617

您以不正确的方式传递数组。加载视图时，您只能将一个数据数组作为第二个参数传递。

您可以改为将每个数组放入控制器的数据数组中：

```
$data['a_1'] = $a_1;
$data['a_2'] = $a_2;
$this->load->view('confirm_data_v', $data); 
```

然后在您的视图中，您可以随意访问 $a_1 和 $a_2

```
Name: <?php echo $a_1['name']; ?>
Email: <?php echo $a_2['mail']; ?> 
```

# c - 长长计算的问题

> ID：13772446
> 
> 赞同：1
> 
> 时间：2012-12-07T23:06:35.483
> 
> 标签：c

我有循环数字并创建该整数的字符数组表示的代码。所以对于像 1234 这样的数字，我得到一个看起来像 {'1', '2', '3', '4'}

部分代码如下所示：

```
do {
   //print here
     c[i++] = (char)(((int)'0')+(num - (num/10)*10 ));
} while ((num = num/10) != 0); 
```

当涉及大型数据类型（如 long long int）时，我遇到了问题：18446612134627563776

我在循环中打印的值是：

```
18446612134627563776
18446730879801352832
18446742754318731738
...
18446744073709551615 
```

值应该是

```
18446612134627563776
1844661213462756377
184466121346275637
...
18
1 
```

奇怪的是循环终止了。最后打印的值是`18446744073709551615 != 0`，所以不确定它为什么会在那里终止。我认为这是我做得不对的数据类型的一些问题。

这是打印语句：

```
printk("long=%llu sec=%llu , char=%c\n", num, (num/10)*10, (char)(((int)'0')+((num - (num/10)*10 )))); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:19:27.180

你的代码很好。问题是类型`num`是有符号的（即只是`long long`）。将其更改为 ( `unsigned long long`)，您应该一切顺利。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:20:01.640

> `long long int`: 18446612134627563776

`long long int`是有符号类型，通常为 64 位宽，具有最大可表示数

```
2^63-1 = 9223372036854775807 
```

您的值大于那个值，并且溢出，可能

```
2^63 - 18446612134627563776 = -131939081987840 
```

打印的值为

```
2^64 + (-131939081987840)/(10^k) 
```

将类型更改为`unsigned long long`以获得预期结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T23:11:25.713

为什么不使用模运算符来计算除法的余数以获得最后一位？

下面的整数

```
do {
    c[i++] = (char)(((int)'0')+(num %10 ));
} while ((num = (num/10)) != 0); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T23:25:36.950

不是溢出，我用这段代码测试过。

```
unsigned long long num = 18446612134627563776;
char c[100];
unsigned int i = 0;

do {
    //print here
    c[i++] = '0'+ (char)(num - (num/10)*10 );
} while ((num = num/10) != 0);

c[i] = '\0';
cout << c << endl; 
```

问题是编译器可能试图将 10 用作 int，并且在转换时遇到问题。放入铸件后，它确实有效。问题是算法是倒退的，因为它会引入 6，然后是 7，等等... 上面的代码的输出如下，除了强制转换外，它与他的完全相同。

这是实际代码和实际输出。

```
677365726431221664481 
```

希望这可以帮助 ：-）

# tcl - 解释 TCL 命令语法中使用的符号的文档在哪里

> ID：13772456
> 
> 赞同：0
> 
> 时间：2012-12-07T23:07:13.257
> 
> 标签：tcl

我在看网上的TCL命令文档，它使用诸如?argument?，...之类的东西和一些字体来指定一些特定的含义，符号不难理解，但我喜欢找到这个解释文档符号，令我惊讶的是，要找到它并不容易。

你能给我指点一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T00:00:23.077

我很惊讶我找不到有关 Tcl 概要约定的信息，但我会尽力解释。例如，概要`puts`是：

**放**？**-新线**？? *频道号*？*细绳*

在这种情况下，粗体表示您需要逐字输入（**puts**和**-nonewline**），而斜体是可变参数（例如，要打印的*字符串）。*

问号之间的参数（不是粗体或斜体，实际上并不构成参数的一部分），例如？*频道号*？是可选的。

`puts`因此， 的示例用法是：

```
puts "Hello, world"
puts $myChannel "Hello, world"
puts -nonewline "Please type your name: " 
```

我希望这有帮助。

# sql-server - Entity Framework 5 缺少关联

> ID：13772460
> 
> 赞同：1
> 
> 时间：2012-12-07T23:07:58.373
> 
> 标签：sql-server, visual-studio, entity-framework

我试图证明使用 EntityFramework 并在第一个障碍中落下。我正在使用数据库优先方法。下面是它在 SQL Server 2008 R2 中的样子：

![数据库图](../Images/715a9c3f553f27148bf2112b588937f2.png)

如您所见，非常简单的域。该关联是 User.Id 和 Blog.UserId 之间的一对多关系。

但是，即使使用这个非常简单的域，EF 也会失败。当我导入表格时，我得到了这个：

![英孚模型](../Images/05a8995582d78c91893cf97be7c7f276.png)

如您所见，没有关联。关系消失了，无论我删除多少次，重新生成，它都不会出现。选中“在模型中包含外键列”。

但是，如果我使用基于整数而不是 GUID 的键创建表，则会创建关系。

这是一个错误，一个限制还是我自己的愚蠢？

它不会激发我的信心。它到底将如何在具有一百个表和一千个关联的现实场景中执行？

*   对比 2012
*   SQL Server 2008 R2
*   英孚 5

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T22:04:11.897

我已经解决了这个问题。这个问题是由我不知道我在桌子上的一个流氓索引引起的。

如果在与主键相同的字段上存在 UNIQUE 索引，这将导致 EF 根本无法生成 PK-FK 关系。

简单地删除不必要的唯一索引（主要强制执行唯一索引），EF 设计器立即拾取关系。

# php - PHP MySQL - SELECT SUM 返回问题

> ID：13772461
> 
> 赞同：0
> 
> 时间：2012-12-07T23:08:01.947
> 
> 标签：php, mysql

我正在尝试执行以下查询：

```
SELECT SUM(cash) AS total_cash FROM users 
```

该查询应该`SUM()`以名为`total_cash`.

我的 HTML/PHP 如下：

```
<p class="cash_count">
$<? 
    $total_cash = $db->GetNumRows($db->Query("SELECT SUM(cash) AS total_cash FROM users"));
    echo number_format($total_cash);
?>
</p> paid out! 
```

我知道`GetNumRows`总是会显示`1`，因为只有`1`一行，但我不知道用什么代替，有人可以指导我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:12:07.727

您正在使用某个类连接到数据库 - 您没有指定有关该类的任何内容。如果 $db->Query() 返回实际的 mysql 资源，你可以这样做：

```
$res=$db->Query("...."); 
$r=mysql_fetch_object($res);
echo $r->total_cash; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:12:31.887

是的，只有 1 行，因为您的查询要求`SUM`, 并且只返回 1 行的总和。

您可以做 2 件事，或者退出`SUM`SQL 或退出`$db->GetNumRows`.

# java - 我可以手动/以编程方式生成 Eclipse 工作区和项目吗？

> ID：13772464
> 
> 赞同：1
> 
> 时间：2012-12-07T23:08:09.290
> 
> 标签：java, eclipse, eclipse-jdt

我需要测试 JDT/LTK 示例，为此我需要手动或以编程方式创建 eclipse 工作区和项目。

如何组织目录以便获得有效的工作区和项目对象？我的意思是，eclipse 工作区和项目有什么特别之处？

```
IWorkspaceRoot root = ResourcesPlugin.getWorkspace().getRoot();
// 1\. The name of the project in the workspace
IProject project = root.getProject("Hello");
project.open(null /* IProgressMonitor */);

IJavaProject javaProject = JavaCore.create(project);
// 2\. The name of the Type (including the namespace)
IType itype = javaProject.findType("smcho.A"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T01:49:40.900

下面的代码动态创建一个带有包和类的 Java 项目。也许它对你有用。

```
// create a project with name "TESTJDT"
IWorkspaceRoot root = ResourcesPlugin.getWorkspace().getRoot();
IProject project = root.getProject("TESTJDT");
project.create(null);
project.open(null);

//set the Java nature
IProjectDescription description = project.getDescription();
description.setNatureIds(new String[] { JavaCore.NATURE_ID });

//create the project
project.setDescription(description, null);
IJavaProject javaProject = JavaCore.create(project);

//set the build path
IClasspathEntry[] buildPath = {
        JavaCore.newSourceEntry(project.getFullPath().append("src")),
                JavaRuntime.getDefaultJREContainerEntry() };

javaProject.setRawClasspath(buildPath, project.getFullPath().append(
                "bin"), null);

//create folder by using resources package
IFolder folder = project.getFolder("src");
folder.create(true, true, null);

//Add folder to Java element
IPackageFragmentRoot srcFolder = javaProject
                .getPackageFragmentRoot(folder);

//create package fragment
IPackageFragment fragment = srcFolder.createPackageFragment(
        "com.programcreek", true, null);

//init code string and create compilation unit
String str = "package com.programcreek;" + "\n"
    + "public class Test  {" + "\n" + " private String name;"
    + "\n" + "}";

        ICompilationUnit cu = fragment.createCompilationUnit("Test.java", str,
                false, null);

//create a field
IType type = cu.getType("Test");

type.createField("private String age;", null, true, null); 
```

参考：[使用 Eclipse JDT 创建、访问、加载项目](http://www.programcreek.com/2011/05/eclipse-jdt-tutorial-java-model/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:13:21.500

我不确定您是否可以从正在运行的工作空间中创建新的 IWorkspace，但您应该能够创建一个目录和嵌套项目，当您重新启动 Eclipse 时可以将其用作工作空间。

另一种方法是启动 Eclipse 测试环境。有一个运行对话框，可让您指定工作区根目录。我相信，如果您足够多地探索，您可以推断出如何以编程方式启动该测试工作区（运行它）。

# sql-server - 将日期时间转换为 nvarchar 但保持格式

> ID：13772466
> 
> 赞同：12
> 
> 时间：2012-12-07T23:08:22.383
> 
> 标签：sql-server, sql-server-2005, datetime

我返回 DATETIME 或 NVARCHAR = 'MULTIPLE' 取决于是否已多次执行操作。

所以我试图将 DATETIME 存储为其正常格式“2012-10-23 13:59:47.000”，但作为 NVARCHAR。SQL 希望将其设为“2012 年 10 月 23 日下午 12:40” 我该怎么做？

现在我正在做：

```
CAST(r.Date_And_Time) AS NVARCHAR(30)) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-07T23:16:04.667

```
Declare @CreatedDate datetime
Select @CreatedDate='20121210'
Select CONVERT(VARCHAR,@createdDate, 21) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-07T23:12:59.470

使用`CONVERT`. 它有格式参数。

```
CONVERT ( data_type [ ( length ) ] , expression [ , style ] )

CONVERT(NVARCHAR(23), r.Date_And_Time, 121) 
```

[https://docs.microsoft.com/en-us/sql/t-sql/functions/cast-and-convert-transact-sql](https://docs.microsoft.com/en-us/sql/t-sql/functions/cast-and-convert-transact-sql)

# java - 如何在Java中的另一个方法中调用一个方法（同一个类）

> ID：13772470
> 
> 赞同：1
> 
> 时间：2012-12-07T23:08:55.613
> 
> 标签：java, arrays, methods

我试图从同一个类中的另一个方法调用一个方法，以检查用户输入的内容是否在 arrayList 中。如果它在arrayList中，我想将它的数量加1。如果它不在arrayList中，我将它添加到arrayList中。这是我所拥有的：

```
public Item searchForItem(String n){
  for(int i = 0; i < s.size(); i++){   
    Item y = s.get(i);  
    if(y.getName().equals(name)){  
      return y;    
    } 
  }
  return null;
}
public void addItem(Item f) {  
  s.add(f);    
} 
```

我知道我需要在`addItem`方法中使用 if 语句，但我不确定如何编写它。

有没有办法检查是否`y`已退回或是否`null`已退回？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:12:45.767

只需调用将名称作为参数传递的 searchForItem 方法。

```
public void addItem(Item f) {  
 if(searchForItem(f.getName())==null) {
  s.add(f);    // add's the item only if searchForItem returns null
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:17:17.250

使用 foreach 语法来编写更简单的代码，并尝试以下操作：

```
public Item searchForItem(String name){
  for(Item y : s) {   
    if(y.getName().equals(name)){  
      return y;    
    } 
  }
  s.add(new Item(name));
  return null;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T23:23:57.150

使用哈希映射！它将具有 O(1) 访问时间，因此您不必迭代数组列表。使用 containsKey 方法检查元素是否在地图中，并使用 get 方法获取它。

# javascript - 如何在javascript类中创建一个静态字段

> ID：13772471
> 
> 赞同：0
> 
> 时间：2012-12-07T23:09:08.133
> 
> 标签：javascript, oop, class, static

我可以像这样在 JavaScript 中定义一个类：

```
var appender = function (elements, func) {
    this.Prop = something;
    staticProp = something_else;
}; 
```

我对吗？那么，我怎样才能在这个类中创建一个静态字段呢？以及如何访问课堂内的该字段？我的意思是我想要一个在类的所有实例之间共享的字段。

```
var ap1 = new appender();
var ap2 = new appender();
ap1.Prop = something1;
ap2.Prop = something2;
var t = ap1.Prop == ap2.Prop; // true
ap1.staticProp = something_static;
var s = ap2.staticProp = something_static; // I want to this returns true. how can I? 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T23:12:35.693

这不是那么容易回答的。它不会像您从其他语言（如 Java 等）中知道的静态变量那样表现。

您可以做的是将其附加到函数中，如下所示：

```
appender.staticProp = 3 
```

这意味着在函数中，您必须使用函数名称来引用它：

```
var Person = function(name) {
   this.name = name;

   this.say = function() {
       console.log( Person.staticVar );
   }
}

Person.staticVar = 3; 
```

因此，它允许您附加一些静态的变量。但是您只能如上所示引用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:13:30.150

见评论：

```
var appender = function (elements, func) {
    this.Prop = something; // member variable, ok
    staticProp = something_else; // global var (no var keyword!)
}; 
```

试试这个：

```
var appender = function (elements, func) {
    this.Prop = something;

};
appender.staticProp = something_else; // static member 
```

# java - java中的Object.callGenericMethod()

> ID：13772473
> 
> 赞同：1
> 
> 时间：2012-12-07T23:09:24.840
> 
> 标签：java, actionscript-3

假设我有这 3 个课程

```
class Human
  public void eat()

class Lawyer extends Human
  public void beEvil()

class Murderer extends Human
  public void beEvil()
  public void kill() 
```

现在我有一个动作处理程序，我想在不知道我是什么的情况下处理动作。例如：

```
handleBeEvil(Human human)
{
    ..
    human.beEvil(); //wont obviously work
    ..
} 
```

例如，在 as3 中，我会使用

```
handleBeEvil(Object human)
{
   human.beEvil(); //would pass compiler, work or break runtime
} 
```

在 Java 中完成此任务的最佳方法是什么？我想避免将所有的声明都放在 Human 类中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:13:25.337

创建一个接口并同时拥有`Lawyer`并`Murderer`实现它（即`class Lawyer extends Human implements Evil`）：

```
interface Evil {
    void beEvil();
} 
```

那么你的方法是

```
... handleBeEvil(Evil human)
{
    ..
    human.beEvil();  // now this will work
    ..
} 
```

# c++ - 如何从向量中获取随机和唯一值？

> ID：13772475
> 
> 赞同：5
> 
> 时间：2012-12-07T23:09:32.063
> 
> 标签：c++

> **可能重复：**
> [O(1) 中的唯一随机数？](https://stackoverflow.com/questions/196017/unique-random-numbers-in-o1)
> [C编程语言中整数数组中的唯一随机数](https://stackoverflow.com/questions/1608181/unique-random-numbers-in-an-integer-array-in-the-c-programming-language)

我有`std::vector`一些未确定大小的独特元素。我想从此向量中获取 20 个唯一且随机的元素。“唯一”是指我不想多次获取同一个索引。目前我这样做的方式是调用`std::random_shuffle`. 但这需要我打乱整个向量（可能包含超过 1000 个元素）。我不介意改变向量（虽然我不想这样做，因为我不需要使用线程锁），但最重要的是我希望它高效。我不应该洗牌超过我需要的。

请注意，我已经考虑过将部分范围传递给，`std::random_shuffle`但它只会打乱该元素子集，这意味着该范围之外的元素永远不会被使用！

帮助表示赞赏。谢谢！

注意：我使用的是 Visual Studio 2005，因此无法访问 C++11 功能和库。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T23:13:22.240

您可以使用 Fisher Yates [http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)

> Fisher-Yates shuffle（以 Ronald Fisher 和 Frank Yates 命名），也称为 Knuth shuffle（以 Donald Knuth 命名），是一种用于生成有限集的随机排列的算法——简单来说，就是随机打乱集合。Fisher-Yates shuffle 的一种变体，称为 Sattolo 算法，可用于生成长度为 n 的随机循环。如果实施得当，Fisher-Yates shuffle 是无偏的，因此每个排列都是同样可能的。该算法的现代版本也相当有效，只需要与被洗牌的项目数量成正比的时间，并且不需要额外的存储空间。费雪-耶茨洗牌的基本过程类似于从帽子中随机挑选编号的票，或从一副牌中随机挑选一张牌，直到没有更多的牌。

我认为这个伪代码应该可以工作（有可能出现一个错误或其他问题，所以请仔细检查它！）：

```
std::list chosen; // you don't have to use this since the chosen ones will be in the back of the vector
for(int i = 0; i < num; ++i) {
  int index = rand_between(0, vec.size() - i - 1);
  chosen.push_back(vec[index]);
  swap(vec[index], vec[vec.size() - i - 1]);
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-07T23:15:24.897

你想要一个来自 n 向量的大小为 m 的随机样本：

让 rand(a) 返回 0..a-1 统一

```
for (int i = 0; i < m; i++)
    swap(X[i],X[i+rand(n-i)]); 
```

`X[0..m-1]`现在是随机样本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T23:11:39.783

使用循环将随机索引号放入 a并在达到 20`std::set`时停止。`size()`

```
std::set<int> indexes;
std::vector<my_vector::value_type> choices;
int max_index = my_vector.size();
while (indexes.size() < min(20, max_index))
{
    int random_index = rand() % max_index;
    if (indexes.find(random_index) == indexes.end())
    {
        choices.push_back(my_vector[random_index]);
        indexes.insert(random_index);
    }
} 
```

随机数生成是我脑海中浮现的第一件事，请随意使用更好的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T23:21:15.137

```
#include <iostream>
#include <vector>
#include <algorithm>

template<int N>
struct NIntegers {
  int values[N];
};
template<int N, int Max, typename RandomGenerator>
NIntegers<N> MakeNRandomIntegers( RandomGenerator func ) {
  NIntegers<N> result;
  for(int i = 0; i < N; ++i)
  {
    result.values[i] = func( Max-i );
  }
  std::sort(&result.values[0], &result.values[0]+N);
  for(int i = 0; i < N; ++i)
  {
    result.values[i] += i;
  }
  return result;
}; 
```

使用示例：

```
// use a better one:
int BadRandomNumberGenerator(int Max) {
  return Max>4?4:Max/2;
}
int main() {
  NIntegers<100> result = MakeNRandomIntegers<100, 500>( BadRandomNumberGenerator );
  for (int i = 0; i < 100; ++i) {
    std::cout << i << ":" << result.values[i] << "\n";
  }
} 
```

使每个数字 1 的最大值小于上一个。对它们进行排序，然后将每个值按其前面的整数个数递增。

模板的东西只是商业外观。

# php - 从出生日期显示年龄？

> ID：13772478
> 
> 赞同：0
> 
> 时间：2012-12-07T23:10:08.947
> 
> 标签：php, mysql, date

嗨，我有一个网站，首页上显示了用户。当用户注册该网站时，他们会使用出生日期进行注册。这存储在我的数据库中。

我已经从数据库中提取了用户并显示了他们的位置和名称。

我还试图添加他们的年龄，这是从他们的出生日期计算出来的。但目前它不起作用，用户年龄没有显示。

谁能帮我找出我哪里出错了？

代码：

```
 <?php
 $dob = $platinum['dob'];

function age_from_dob($dob) {

    list($y,$m,$d) = explode('-', $dob);

    if (($m = (date('m') - $m)) < 0) {
        $y++;
    } elseif ($m == 0 && date('d') - $d < 0) {
        $y++;
    }

    return date('Y') - $y;

}

$dob = age_from_dob($dob);

?>

<?

        $platinum_set = get_platinum_users();
        while ($platinum = mysql_fetch_array($platinum_set)) {
            echo"
            <div class=\"platinumcase\">
            <a href=\"profile.php?id={$platinum['id']}\"><img width=80px height= 80px src=\"data/photos/{$platinum['id']}/_default.jpg\" class=\"boxgrid\"/></a><h58> {$platinum['first_name']} {$platinum['last_name']}</h58><br/><br/><h52>{$platinum['$dob']}<br/><br/>{$platinum['location']}</h52>

            </div>";
        }
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:14:57.833

我不知道你使用哪个模板引擎，什么是允许的，什么是不允许的……但通常最简单的方法是最好的……所以试试这个

```
<?php
 $dob = $platinum['dob'];

function age_from_dob($dob) {

       $dob = '1999-12-03'; 
       $age = date_diff(date_create($dob), date_create('now'))->y;  
       return $age;
}

?>

<?

        $platinum_set = get_platinum_users();
        while ($platinum = mysql_fetch_array($platinum_set)) {
        $age = age_from_dob($platinum['dob']);
             echo "
            <div class=\"platinumcase\">
            <a href=\"profile.php?id={$platinum['id']}\"><img width=80px height= 80px src=\"data/photos/{$platinum['id']}/_default.jpg\" class=\"boxgrid\"/></a><h58> {$platinum['first_name']} {$platinum['last_name']}</h58><br/><br/><h52> ".$age." <br/><br/>{$platinum['location']}</h52>

            </div>";
        }
    ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:19:01.750

```
function age_from_dob($dob) {
    return DateTime::createFromFormat('Y-m-d',$dob, $tz)->diff(new DateTime('now', $tz))->y;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T01:32:34.963

我使用这个函数来返回我的用户的年龄。希望这可以帮助

```
function HowOld($DOB)
    {
            if($DOB)
                    {
                $birthday = strtotime($DOB);
                $date = strtotime(date("Y-m-d "));
                $difference = $date - $birthday;
                $years = $difference/(60 * 60 * 24 * 365);
                $value = floor($years);
                return $value;
            }
        return false;
    } 
```

# clojure - clojure, 活跃, 多站点

> ID：13772481
> 
> 赞同：4
> 
> 时间：2012-12-07T23:10:32.190
> 
> 标签：clojure, enlive

尝试根据 :server-name 在请求中返回的内容加载特定模板：

```
(ns rosay.views.common
  (:use noir.core)
  (:require [noir.request :as req]
            [clojure.string :as string]
            [net.cgrand.enlive-html :as html]))

(defn get-server-name
  "Pulls servername for template definition"
  []
  (or (:server-name (req/ring-request)) "localhost"))

(defn get-template
  "Grabs template name for current server"
  [tmpl]
  (string/join "" (concat [(get-server-name) tmpl])))

(html/deftemplate base (get-template "/base.html")
  []
  [:p] (html/content (get-template "/base.html"))) 
```

它适用于返回 /home/usr/rosay/resources/localhost/base.html 的 localhost，但是当我针对不同的主机进行测试时说“hostname2”，我看到 get-template 在哪里查看 /home/usr/rosay/resources /hostname2/base.html 但当它在浏览器中呈现时，它总是指向 ../resources/localhost/base.html。

是否有宏或不同的方式来处理这个用例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T12:12:43.050

正如评论中提到的，`deftemplate`是一个将模板定义为命名空间中的函数的宏 - 只有一次，当它第一次被评估时。您可以轻松编写一些代码来懒惰地创建模板，并通过在创建模板后缓存模板来消除一些开销：

```
(def templates (atom {}))

(defmacro defservertemplate [name source args & forms]
  `(defn ~name [& args#]
     (let [src# (get-template ~source)]
       (dosync
        (if-let [template# (get templates src#)]
          (apply template# args#)
          (let [template# (template src# ~args ~@forms)]
            (swap! templates assoc src# template#)
            (apply template# args#))))))) 
```

在您的情况下，您可以说`(defservertemplate base "/base.html"...`.

你可以稍微整理一下。您真正需要知道的`deftemplate`只是调用`template`，如果需要，您可以直接使用它。

# java - Android SoundPool：AudioFlinger 错误

> ID：13772483
> 
> 赞同：0
> 
> 时间：2012-12-07T23:10:40.490
> 
> 标签：java, android, multithreading, soundpool

我的 SoundManager 类使用 SoundPool 作为它的音频。我的声音会循环播放，开 1 秒，关 2 秒，直到被告知停止。问题是这将执行一次，然后我注意到 logcat 中有一个错误说“SoundPool：创建 AudioTrack 时出错”，然后是“AudioTrack：AudioFlinger 无法创建轨道，状态：-12”我的代码如下。知道为什么我会收到此错误吗？

```
public class SoundManager {

    public SoundManager(Context c) {
        mContext = c;
        sp = new SoundPool(1,AudioManager.STREAM_MUSIC,0);
        spSound = sp.load(mContext, R.raw.tone4402, 1);
    }
    public void Tone3(int timer) {
        (new Thread(t3)).start();
    }
    final Runnable t3 = new Runnable() {
        public void run() {
            if(isPlaying == false) {
                isPlaying = true;
                Tone3Run();
            }
        }
    };
    public static void Tone3Run() {
        //1 sec on, 2 sec off, repeat for 2 minute
        Log.d("Sound", "Tone3 Playing");
        long startTime = System.currentTimeMillis();
        long currentTime;
        do
        {
            currentTime = System.currentTimeMillis();
            Log.e("Sound Manager", "Time:" + (currentTime - startTime));
            temp = sp.play(spSound, currentVolume, currentVolume, 1, -1, (float)1.0);
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
            e.printStackTrace();
            }

            sp.pause(temp);
            try {
                Thread.sleep(2000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        } while( ((currentTime - startTime) < 120000) && (boolStop = false) );
        sp.release();
        sp = new SoundPool(1, 4, 0);
        spSound = sp.load(mContext, R.raw.tone4402, 1);
        isPlaying = false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-04T17:04:07.400

`Error : AudioTrack: AudioFlinger could not create track, status: -12`
属于活动轨道的总数为 32 并且您正在尝试创建另一个轨道。
Android 只能支持 32 个音轨名称。
您可以检查其他错误，例如`Obtain Buffer TimeOut`.
请在其他 Android 设备上尝试您的应用程序或检查并重启您的设备。

# java - 关于框架架构的思考

> ID：13772489
> 
> 赞同：0
> 
> 时间：2012-12-07T23:11:12.197
> 
> 标签：java, frameworks, cdi

现在这不是直接的编程问题，它更像是一个设计问题。

我目前正在开发一个 cdi 扩展。此扩展处理由配置的实例

1.  一个 VM 参数（-D 参数）
2.  来自类路径的属性文件
3.  实现类上的注释
4.  注入点的注释（例如 @MyAnnotation(value ="text") private Object obj;）

现在我无法决定如何优先考虑多个可用配置，例如哪个参数覆盖哪个..

（例如）当在类级别和注入点有一个带有值的注释时，应该使用哪个配置？“最小”（在注入点）注释总是获胜还是“最大”（vm参数）？

因为这应该成长为一个框架，所以我想把它做好。

对于“最小的总是获胜”的方法，我可以预见框架用户会因为类或成员级别的注释覆盖类路径中属性文件的配置而感到困惑的用例。有点相同的图片（仅反转）是由另一种方法绘制的..

所以这将是框架用户必须学习的规则。哪种方法更直观？

只是头脑风暴；）

来自德国的问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T07:01:11.777

在 DeltaSpike 和 CDI 1.1（在 Java EE 7 中可能更通用）中，最少的数字获胜，至少从这个角度来看它是一致的。

# wordpress - 如何提取 Wordpress 主题的核心并将其传输/重新编码以在 Modx 中使用？

> ID：13772496
> 
> 赞同：0
> 
> 时间：2012-12-07T23:11:41.113
> 
> 标签：wordpress, wordpress-theming, modx, modx-revolution, modx-templates

我已经购买了 WP Themes 来查看他们的代码，以便我可以将它们传输到 Modx，是否有我应该注意的特定文件夹？如果它有助于 Wordpress 主题（根）之一，请使用 HTML5 Boiler Point 和 Twitter 的 Bootstrap。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:53:55.660

查看 Wordpress 页面源代码对您的帮助很小。您将为与 MODx 无关的特性和功能获得渲染的 php 输出。

阅读 MOSx 自己的文档：**MODX College：移植 WordPress 主题** [http://modx.com/learn/modx-college/porting-wordpress-themes/](http://modx.com/learn/modx-college/porting-wordpress-themes/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-07T23:37:33.293

为此，请按照以下步骤操作：

1.  在 wordpress 中安装您的主题。
2.  查看安装了新主题的 wordpress。
3.  查看页面的源代码（Ctrl + u）。
4.  复制源。
5.  在 MODx 中创建新模板。
6.  将复制的源代码粘贴到您刚刚创建的新模板中。
7.  将模板分配给页面（即主页）并保存。
8.  查看页面（单击“查看”按钮）。

你会看到，所有的css、js、图片等文件都会丢失。只需在新创建的模板中链接所有这些文件。最好将它们放在服务器上的以下目录中：

*   /资产/css/
*   /资产/js/
*   /资产/图像/

链接所有文件后，从模板中选择并剪切内容并将其粘贴到其中一个资源（即主页）的“内容”区域，然后单击保存。在模板中而不是您刚刚剪切的内容中，放入 `[[*content]]`.

那是基础。您可以继续进行其他调整。一旦你掌握它，MODx 就会非常舒适。

# c# - MSDTC 和多个 EF ObjectContexts 来分隔 SQL Server 数据库

> ID：13772497
> 
> 赞同：1
> 
> 时间：2012-12-07T23:11:53.460
> 
> 标签：c#, sql-server, entity-framework, msdtc

我在使用 TransactionScope 时遇到问题，其中初始化了两个 Entity Framework ObjectContexts，一个用于数据库 X，一个用于**同一服务器**上的数据库 Y。

第一个上下文“cersCtx”创建了一个新的“Contact”对象。第二个上下文“coreCtx”试图找到一个帐户。

在第二个上下文中调用以查找帐户

```
account = coreCtx.Accounts.SingleOrDefault(p => p.Email == email && !p.Voided); 
```

我收到以下错误：

> 由于通信问题，MSDTC 事务管理器无法从源事务管理器中提取事务。可能的原因是：存在防火墙并且它对 MSDTC 进程没有异常，两台机器无法通过它们的 NetBIOS 名称找到彼此，或者两个事务管理器之一未启用对网络事务的支持。（来自 HRESULT 的异常：0x8004D02B）

奇怪的是，当我进入 MSDTC 时，我看到有已提交的事务，但大多数情况下它们正在中止。

有人对我如何解决这个问题有任何想法吗？

这是产生此问题的代码的缩写示例。

```
public void CreateContact(string email)
{
    using (TransactionScope scope = new TransactionScope(TransactionScopeOption.Required, new TransactionOptions { IsolationLevel = System.Transactions.IsolationLevel.ReadCommitted }))
    {
            using (CERSEntities cersCtx = new CERSEntities())
            {
                Contact contact = new Contact();
                contact.Email = email;
                cersCtx.Contacts.AddObject(contact);
                cersCtx.SaveChanges();
            }

            CoreModel.Account account = null;
            using (CoreModel.CoreEntities coreCtx = new CoreModel.CoreEntities())
            {
                account = coreCtx.Accounts.SingleOrDefault(p => p.Email == email && !p.Voided);
            }

            scope.Complete();
    }
} 
```

# ios - 多个目标，每个目标只有一个不同的定位

> ID：13772498
> 
> 赞同：3
> 
> 时间：2012-12-07T23:11:58.180
> 
> 标签：ios, xcode, localization, target

我的项目对一个源代码库有 6 个目标。由于预处理器语句不同，这 6 个目标是具有不同内容的不同程序。

我定义了 2 个本地化版本，即法语和英语。

但是，其中 4 个程序应该只有法语，2 个应该只有英语。

目前，我获得了所有 6 个程序的法语和英语。

请问如何从 4 个法语程序中删除英语并从 2 个英语程序中删除法语？

我尝试了目标成员资格，但选中的框对于 Localizable.strings（法语）和 localizable.strings（英语）都是相同的。此外，如果我尝试取消选中目标的本地化，它会尝试删除它......所以要么我做得不对，要么我只是不知道该怎么做

提前感谢您的帮助

干杯，吉比

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-05T14:10:39.527

我找到了答案；所以要在 main.m 文件中完成：

```
 // ---- target 1 app 1
#ifdef target1_VERSION

    [[NSUserDefaults standardUserDefaults] setObject:[NSArray arrayWithObjects:@"fr", nil]
                                              forKey:@"AppleLanguages"];
#endif

    // ---- target 2 app 2
#ifdef target2_VERSION

    [[NSUserDefaults standardUserDefaults] setObject:[NSArray arrayWithObjects:@"en", nil]
                                              forKey:@"AppleLanguages"];
#endif 
```

# string - 逐行分析由推文组成的 .txt 文件

> ID：13772499
> 
> 赞同：2
> 
> 时间：2012-12-07T23:12:00.653
> 
> 标签：string, matlab, file-io

我将如何使用多个 fgetl 操作让 Matlab 读取我的 30 行文本 .txt 文件。我不能只将所有行放入一个变量中，因为我需要使用 Matlab 分析文件中的信息。我需要检查的信息是文件中有多少行以及关于每行中有多少特定字母或符号的问题。

到目前为止，我已经开始使用此代码

```
clear all
close all
clc
%% Questions Two
% part a
fid = fopen('twitter_data.txt');
twitter = fread(fid,inf,'*char')';
fclose(fid); 
```

只是注意到上面不起作用，因为我需要它逐行，而不是一列行向量中的所有字符

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:19:11.563

你想用[`fgetl`](http://www.mathworks.com/help/matlab/ref/fgetl.html). 此外，您可以找到带有[`strfind`](http://www.mathworks.com/help/matlab/ref/strfind.html).

```
fid = fopen('twitter_data.txt');
twitter = fgetl(fid);
while ischar(twitter)
   %Process twitter here
   fprintf('Line contains %i # symbols',length(strfind(twitter,'#')));

   %get next line
   twitter = fgetl(fid);
end
fclose(fid); 
```

# php - Heroku 中的 PHP 错误日志

> ID：13772505
> 
> 赞同：19
> 
> 时间：2012-12-07T23:12:31.730
> 
> 标签：php, heroku, error-logging

我在 Heroku 上部署了一个 PHP 应用程序，但我似乎无法找到 apache 错误日志。使用该命令`$heroku logs`我似乎只获得了 apache 访问日志。所以一堆 GET 200 OK 等，但没有错误信息被放入本地的错误日志中，例如'PHP Fatal error: *blah blah* '

我在哪里可以访问 Heroku 上的这些错误日志，或者我如何告诉应用程序像写入本地错误日志一样写入 Heroku 的日志？

我觉得我忽略了一些明显的东西，但我似乎找不到解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T18:48:16.640

经过大量实验后，您似乎需要`error_log`在 php.ini 中注释掉并确保`log_errors = on`.. 这应该将您的错误输出到 stderr，heroku logplex 可以在其中接收流，然后使用`heroku logs --tail`.. 进行监视。我启动了 heroku facebook app 并查看了他们的 phpinfo() 并复制了设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T23:28:08.633

尝试添加：

```
error_reporting(E_ALL);
ini_set("display_errors", 1); 
```

到您的 PHP 页面/应用程序的最顶部

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T19:25:34.563

我们必须将它添加到 bin/compile 文件中的 buildpack 中：

```
cat >>boot.sh <<EOF
for var in \`env|cut -f1 -d=\`; do
  echo "PassEnv \$var" >> /app/apache/conf/httpd.conf;
done
touch /app/apache/logs/error_log
touch /app/apache/logs/access_log
touch /app/apache/logs/php_error.log
tail -F /app/apache/logs/error_log &
tail -F /app/apache/logs/access_log &
tail -F /app/apache/logs/php_error.log &
echo "Launching apache"
exec /app/apache/bin/httpd -DNO_DETACH
EOF 
```

我们将 php.ini 和 https.conf 设置保持原样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T08:45:49.813

这与 Heroku 的部署方式无关，而是与您的 PHP 配置有关。该[`error_log`](http://php.net/manual/en/function.error-log.php)指令管理它。

该`error_log`指令定义了应该记录脚本错误的文件的名称。该文件应该可由 Web 服务器的用户写入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-10T00:35:30.473

我实现了我的 laravel 项目，按问题查看错误

heroku 配置：设置 APP_DEBUG=true

再次访问应用程序，错误将显示在浏览器中

# ruby - db:migrate 静默退出

> ID：13772506
> 
> 赞同：0
> 
> 时间：2012-12-07T23:12:35.070
> 
> 标签：ruby, activerecord, rake

当我运行 db:migrate 任务时，迁移实际上并没有发生。这是我的 Rakefile 的代码：

```
namespace :db do
  desc "Migrate the database through scripts in lib/generators/facebook_event_fetcher/install/templates. Target specific version with VERSION=x"
  task :migrate => :environment do
    ActiveRecord::Migration.verbose = true
    #ActiveRecord::Migrator.migrate('db/migrate', ENV["VERSION"] ? ENV["VERSION"].to_i : nil )
    ActiveRecord::Migrator.migrate('lib/generators/facebook_event_fetcher/install/templates', nil)
  end

  task :environment do
    ActiveRecord::Base.establish_connection(YAML.load_file("config/database.yml"))
    ActiveRecord::Base.logger = Logger.new(File.open('db/database.log', 'a')) 
  end
end 
```

您可以仔细查看 Github 存储库： [https ://github.com/mabounassif/facebook_event_fetcher/blob/master/Rakefile#L42](https://github.com/mabounassif/facebook_event_fetcher/blob/master/Rakefile#L42)

为什么不会触发迁移？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:58:55.307

ActiveRecord::Migrator 需要迁移文件以数字或时间戳开头，以便跟踪版本。这是我为在您的存储库中运行迁移所做的工作：

```
facebook_event_fetcher/lib/generators/facebook_event_fetcher/install/templates$ mv create_delayed_jobs.rb 001_create_delayed_jobs.rb
facebook_event_fetcher/lib/generators/facebook_event_fetcher/install/templates$ cd ../../../../..
facebook_event_fetcher/lib$ cd ..
facebook_event_fetcher$ rake db:migrate
==  CreateDelayedJobs: migrating ==============================================
-- create_table(:delayed_jobs, {:force=>true})
   -> 0.0076s
-- add_index(:delayed_jobs, [:priority, :run_at], {:name=>"delayed_jobs_priority"})
   -> 0.0004s
==  CreateDelayedJobs: migrated (0.0081s) ===================================== 
```

# javascript - Paypal Express Checkout PHP，将其加载到fancybox而不是弹出窗口

> ID：13772509
> 
> 赞同：0
> 
> 时间：2012-12-07T23:12:42.343
> 
> 标签：javascript, paypal

我正在使用 PayPal Express 结账，专门用于数字商品，它的工作方式是，当您单击“立即付款”按钮时，它将弹出一个新窗口，该窗口加载贝宝，然后将用户重定向到该弹出窗口中的成功页面。

问题是我正在处理的网站是一个 HTML5 画布应用程序，所以我需要根据成功或失败在原始页面上触发一个 javascript 函数。

但是，我不知道是否可以通过不同的窗口，所以我的第一个想法是将贝宝加载到一个花哨的盒子里，这样我就可以使用类似的东西`top.foo();`

有没有人这样做过，或者可以告诉我这样做是否合乎逻辑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T06:25:18.880

你看过[PayPal Express Checkout for Digital Goods](https://www.x.com/developers/paypal/documentation-tools/express-checkout/digital-goods/IntroducingExpressCheckoutDG)吗？它为您提供了有关如何处理 PayPal 重定向内容的不同选项，并且包括在灯箱中完成所有操作的选项。

# php - 需要 PHP $_FILE 文件上传脚本的帮助

> ID：13772519
> 
> 赞同：0
> 
> 时间：2012-12-07T23:13:26.150
> 
> 标签：php, html, file-upload

我正在使用 PHP 和 HTML 创建一个上传脚本，可以上传任意数量的文件。我循环并回显任意数量的文件上传，并使用循环将每个文件命名为“fileField1”、“fileField2”等。

现在我想检索该字段中的文件名。我可以像这样在另一个循环中使用变量吗？

```
 $fileField = 'fileField'.$i;

    $fileName = $_FILES[$fileField]['name']; // Name of file 
```

这包含在循环中，这行得通吗？

我相信我遇到了一个错误...

变量 $i 每次加一 ($i++)

**编辑**

请注意我从未达到的评论...

这是整个循环：

```
$i = 1;
while ($i <= $numberOfFields) {
$fileField = 'fileField'.$i;
$titleId = 'title'.$i;
$genreId = 'genre'.$i;

    $fileName = $_FILES[$fileField]['name']; // Name of file 

    if($fileName !=""){
        $randNum = rand(1000000000,9999999999); //Generate random number

        $newFileName = $fileName."-".$randNum; //Rename file

            if (file_exists($baseUrl."images/".$newFileName)){
            echo $newFileName." already exists. ";
            }else{      
                if(isset($_POST[$titleId]) && !empty($_POST[$titleId])){
                    // Assign url, title, genre
                    $url = 'images/'.$newFileName;          
                    $title = $_POST[$titleId];          
                    $genre = $_POST[$genreId]; 
                    // Execute final query and upload
                    $sql = "INSERT INTO images (url,title,genre) VALUES (:url,:title,:genre)";
                    $q = $conn->prepare($sql);
                    $q->execute(array(':url'=>$url,
                                      ':title'=>$title,
                                      ':genre'=>$genre));       
                    if(copy($_FILES['fileField']['tmp_name'],'../images/'.$newFileName)) {
                        $NOTICE = 'File successfully uploaded!';
                        // I AM NEVER REACHING THIS NOTICE WHICH IS ECHOED LATER ON IN THE CODE
                    }
                }else{
                    $NOTICE = "Please fill out the title for picture ".$i;
                    break;                  
                }
            }
    }else{
        $NOTICE = "Please select a file to upload in slot ".$i;
        break;
    }
    $i++;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:23:46.847

```
if(copy($_FILES['fileField']['tmp_name'],'../images/'.$newFileName)) { 
```

我认为应该是：

```
if(move_uploaded_file($_FILES['fileField']['tmp_name'],'../images/'.$newFileName)) { 
```

是的，您可以像这样将变量放在 [] 中。只要它们有效并且不会导致未定义的偏移错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:23:57.557

不要使用`copy`. [`move_uploaded_file`](http://php.net/manual/en/function.move-uploaded-file.php)在对上传的文件执行任何操作之前，请先使用。文件被上传到一个特殊的临时位置。

# objective-c - 启用和禁用 UIBarButtonItem

> ID：13772524
> 
> 赞同：0
> 
> 时间：2012-12-07T23:13:37.100
> 
> 标签：objective-c, ios, ios6, uibarbuttonitem

我有一个带有 6 个 UITextFields 和 1 个 UIBarButtonItem 的屏幕，称为“完成”。只要用户在 6 个 UITextField 中的任何一个上键入任何内容，我就想启用名为“Done”的 UIBarButtonItem，并且如果用户删除内容，我想返回名为“done”的 UIBarByttonItem 以禁用模式。当您在 iphone 议程中添加新联系人时，我想应用 Apple 应用的相同规则。一旦您输入任何信息，您就可以点击“完成”。有什么聪明的方法吗？

非常感谢，马科斯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T23:18:29.847

您需要设置一个在文本字段更改时调用的方法。将相同的方法应用于所有文本字段。在该方法中，您检查文本字段是否有文本。根据该检查，您可以启用或禁用该按钮。

```
// Do this for each text field.
[textField addTarget:self action:@selector(textFieldChangedAction:) forControlEvents:UIControlEventEditingChanged];

- (void)textFieldChangedAction:(UITextField *)textField {
    if (textField.text.length) {
        // enable button
    } else {
        // In this method, check every text field for text. If any have text, enable button
        // If none have text, disable button.
    }
} 
```

编辑：

您将需要所有文本字段的实例变量，以便您可以访问所有这些字段以查看是否应禁用按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T00:20:25.553

要@rmaddy 回答。对于每次`textField`编辑，它将调用该方法并检查该**SPECIFIC** `textField`和`enable or disable barButtonItem`. 但问题是关于启用或禁用 UIBarButtonItem，**如果 6 个文本字段中的任何一个具有文本**，则应启用按钮。如果没有文本，那么只有它应该被禁用。`textFields`因此，除了在您的视图中迭代所有内容之外别无选择。而不是为每个`textField`您可以使用的目标编写目标`UITextFieldTextDidChangeNotification`

只需在 : 方法中添加该通知并在:`viewWillAppear`方法中删除它`viewWillDisappear`

看看这段代码..

```
-(void)viewWillAppear:(BOOL)animated {
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(validateFields) name:UITextFieldTextDidChangeNotification object:nil];

[super viewWillAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated {
    [[NSNotificationCenter defaultCenter] removeObserver:self name:UITextFieldTextDidChangeNotification object:nil];

    [super viewWillDisappear:animated];
}

- (void)validateFields {

    // I think you would have outlet for all textFields.So you can check the textfields having text or not ..
     if([textField1.text length] || [textField2.text length] || ....){
           [yourBarButton setEnabled:YES];
      }else{
           [yourBarButton setEnabled:NO];
      }
  } 
```

**更新：**

@rmaddy 答案也可以。不要忘记在他的答案的其他部分查看评论。现在这取决于一个用户选择的方法..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T23:17:13.170

实现委托方法`– textField:shouldChangeCharactersInRange:replacementString:`并检查是否`[textfield.text length] > 0`. 如果是，请`[self.navigationItem.rightBarButtonItem setEnabled:YES];`执行相同的操作来禁用，但您需要检查在这种情况下是否所有文本字段，以确保它们都没有任何文本。

```
- (BOOL) textField: (UITextField *)theTextField shouldChangeCharactersInRange: (NSRange)range replacementString: (NSString *)string { 

  NSString *text = [theTextField.text stringByReplacingCharactersInRange:range withString:string];   
  if ([text length] > 0){    
     [self.navigationItem.rightBarButtonItem setEnabled:YES];    
  } else {
//check for all textfields and then set [self.navigationItem.rightBarButtonItem setEnabled:NO]; In place of current textfield, you have to use `text`
  }
  return YES;
} 
```

这种方法的优点是您不必向所有 6 个文本字段添加操作或通知。由于已设置委托，因此您不必担心。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T23:20:06.510

查看控制器 M。

```
 if (text1.text.length > 0 || text2.text.length > 0 || text3.text.length > 0 || text4.text.length > 0 || text5.text.length > 0 || text6.text.length > 0)  {

    //btnBack is your UIBarButton   
    [btnBack setTitle:@""];
    [btnBack setStyle:UIBarButtonItemStylePlain];
    [btnBack setEnabled:FALSE];
 } else {

     //btnBack is your UIBarButton     
     [btnBack setTitle:@"Done"];
     [btnBack setStyle:UIBarButtonItemStyleBordered];
     [btnBack setEnabled:TRUE];
 } 
```

此代码检测文本字段的长度，并将启用或禁用 UIBarButton！

# java - Java工作线程，终止条件

> ID：13772525
> 
> 赞同：1
> 
> 时间：2012-12-07T23:13:45.907
> 
> 标签：java, multithreading

我有来自主线程的三个工作线程。主线程将对象放入**BlockingQueue**。如果队列没有足够的数据，可以说只有一个对象。其他两个线程保持等待状态。我如何通知其他两个等待线程（***因为调用 queue.take()***）终止？

一种方法是将队列中的最后一个脏对象传递给其他过时的线程来读取和终止。还有其他优雅的解决方案吗？

```
public void run() {
if (log.isInfoEnabled()) {
    log.info("Entering method 'run' " + this.getName());
}
try {
    while (!noMoreData || !queue.isEmpty()) {
        String data = queue.take();
        ...
        ...
        doSomething();
    }
    if (log.isInfoEnabled()) {
        log.info("noMoreData =" + noMoreData + ", queue empty=" + queue.isEmpty() + "....Terminating thread..." + this.getName());
    }
} catch (InterruptedException ie) {
    log.error(ie);
} finally {
    //DONE SIGNAL
    doneSignal.countDown();
    log.info(this.getName() + " finished.");
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:44:38.403

您应该使用配置的队列（大小和数据结构）来使用 ExecutorService。

然后，您将收到一条关闭消息 (Runnable)，将其提交给调用 #shutdown() 的 executorservice。只需在队列中最后提交该消息即可。

这种方法非常可扩展，因为您可以用真正的消息队列替换 executorservice。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:44:52.510

Thread.interrupt() 会满足您的需求吗？如果保留对三个线程的引用，则可以中断另外两个线程，从而导致 take() 方法抛出 InterruptedException。

# c# - 绑定数据后如何更改gridview宽度并重命名表头

> ID：13772529
> 
> 赞同：0
> 
> 时间：2012-12-07T23:14:05.813
> 
> 标签：c#, asp.net, data-binding, gridview

我尝试在绑定数据后更改gridview大小并重命名标题，但我收到错误“索引超出范围”，因为我的数据超过100px，如何解决？

```
 conn.Open();
                cmdString = "SQL";
                cmd = new SqlCommand(cmdString, conn);
                cmd.Parameters.AddWithValue("@courseID", CourseID);
                dtr = cmd.ExecuteReader();
                gvAssignment.DataSource = dtr;
                gvAssignment.Columns[7].ItemStyle.Width = Unit.Pixel(100);
                gvAssignment.DataBind();                  
                dtr.Close();
                conn.Close(); 
```

另一种方法没有错误，但大小不会更改为 100

```
 protected void gvAssignment_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        e.Row.Cells[7].Width = 100;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:20:29.200

尝试先设置 DataBind，如下所示：

```
 gvAssignment.DataBind();  
   gvAssignment.Columns[7].ItemStyle.Width = Unit.Pixel(100); 
```

您也可以尝试在数据绑定后更新列宽。为了确保这一点，我们可以在 gridview 绑定事件中设置它

```
protected void Page_Load(object sender, EventArgs e)
{
    gvAssignment.DataBound += new EventHandler(gvAssignment_DataBound);
}

void gvAssignment_DataBound(object sender, EventArgs e)
{       
    gvAssignment.Columns[7].ItemStyle.Width = Unit.Pixel(100); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:17:38.823

检查您的查询。“索引超出范围”可能指向列索引（如果您的查询中没有 8 列）

# php - 在 Debian 上更新到 PHP 5.4

> ID：13772530
> 
> 赞同：3
> 
> 时间：2012-12-07T23:14:13.357
> 
> 标签：php, linux, debian

认为在谷歌上会有一个简单的答案，但没有运气。大多数教程虽然与我需要的相似，但不适用于 Debian：

[http://chemicaloliver.net/internet/installing-php-5-4-in-ubuntu/](http://chemicaloliver.net/internet/installing-php-5-4-in-ubuntu/)

```
add-apt-repository ppa:ondrej/php5 
```

产量：

```
-bash: add-apt-repository: command not found 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T23:18:19.333

您是否尝试过[dotdeb 存储库](http://vjetnamnet.com/how-to-install-php-5-4-on-debian-using-dotdeb-repository/)？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-08T00:02:10.567

尝试编辑`dotdeb.list`文件；

```
nano /etc/apt/sources.list.d/dotdeb.list 
```

然后粘贴以下镜像：

```
deb http://packages.dotdeb.org squeeze all
deb-src http://packages.dotdeb.org squeeze all
deb http://packages.dotdeb.org squeeze-php54 all
deb-src http://packages.dotdeb.org squeeze-php54 all 
```

接下来应该有必要执行如下：

```
gpg --keyserver keys.gnupg.net --recv-key 89DF5277
gpg -a --export 89DF5277 | apt-key add - 
```

和

```
apt-get update
apt-get upgrade 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-07T23:27:31.130

如果您的系统是本地或开发机器，则使用 Xampp for Linux 可以更轻松地处理所有事情。

使用以下 URL 获取具有 PHP 版本 5.4.7 的最新版本

[http://www.apachefriends.org/en/xampp-linux.html](http://www.apachefriends.org/en/xampp-linux.html)

# node.js - 有http代理时node.js不会自动传递库JS

> ID：13772538
> 
> 赞同：0
> 
> 时间：2012-12-07T23:15:22.920
> 
> 标签：node.js, websocket, socket.io, node-http-proxy

我设置了一个 node-http-proxy 来将 site/n 请求转发到 node.js（在端口 9000），并将其他请求转发到 apache（端口 8000）。这是因为我大量使用 socket.io，并且我不希望 apache 为每个 websocket 请求创建一个线程。

以下代码效果很好，直到我想通过我的公共 IP 访问它。一切正常，**除了**一件事 - my_public_ip/n/socket.io/socket.io/js 返回“404 Not Found”。似乎这个请求并没有被 node.js 默默地吸收

```
httpProxy.createServer({
    router: {
        'localhost/n/': '127.0.0.1:9000',
        'localhost': '127.0.0.1:8000',
        'my_public_ip/n': '127.0.0.1:9000',
        'my_public_ip': '127.0.0.1:8000'
    }
}).listen(80);

function handler(req, res) {
    var pathName = url.parse(req.url).pathname;
    if(pathName.substr(0,2) == "//"){
        pathName = pathName.substr(1);
    }
    var pathSplit = pathName.split('/');
    nextURL = pathSplit.join('/').substr(8);
    if(pathSplit[1] == 'static'){
        fs.readFile(__dirname + '/static/' + nextURL, function(err, data) {
            if(err) {
                res.writeHead(404);
                return res.end('404 Not Found');
            }
            res.writeHead(200);
            res.end(data);
        });
    } else if(pathName !== '/'){
        fs.readFile(__dirname + '/index.html', function(err, data) {
            if(err) {
                res.writeHead(500);
                return res.end('Error loading file. Does it exist? (Reading ' + __dirname + ')');
            }
            res.writeHead(200);
            res.end(data);
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T22:54:00.530

节点 http 服务器正在为 socket.IO 提供客户端脚本。发生的事情是，因为您没有将 http 流量代理到 node.JS，所以您无法看到客户端 JS 脚本。（Socket.IO 不会通过 socket.IO 连接推送 JS 脚本。）

最基本的解决方法是在 Apache 服务器上创建 JS 脚本的副本。另一种方法是通过仅为脚本路径添加额外的路由指令来将请求路由到 Node.JS。我认为前者会给你更好的表现。

# phpmailer - 不能有一个变量作为 phpmailer 来寻址

> ID：13772548
> 
> 赞同：0
> 
> 时间：2012-12-07T23:16:20.267
> 
> 标签：phpmailer, php

我正在尝试使用 phpmailer 将电子邮件发送到存储在变量 $to 中的地址，就像这样

```
$mail->AddAddress($to); 
```

但我不断收到一条错误消息说这个

```
You must provide at least one recipient email address. 
```

我尝试打印 $to 并打印出我希望发送消息的正确电子邮件地址。如果我输入电子邮件地址（例如 test1@gmail.com）而不是 $to，邮件就会被发送。有人可以帮忙吗？谢谢！

这是上下文：

```
// if the email seller form is submitted
if ($_SERVER["REQUEST_METHOD"] == "POST")
{

// retreive the seller's email using his id
$seller_id = $_GET["sellerid"];

// query for the seller's email
$user_query = query("SELECT username FROM users WHERE id = ?", $seller_id);
$to = $user_query[0]["username"];   

// send an email to the seller
require_once("PHPMailer/class.phpmailer.php");

// instantiate mailer
$mail = new PHPMailer();

// use your ISP's SMTP server
$mail->IsSMTP();
$mail->Host = "smtp.fas.harvard.edu";

// set From:
$mail->SetFrom($_POST['buyer_email']);

// set To:
$mail->AddAddress($to);

// set Subject:
$mail->Subject = $_POST['subject'];

// set body
$mail->Body = $_POST['message'];

// set alternative body, in case user's mail client doesn't support HTML
$mail->AltBody = "Please view this message in an HTML-enabled browser.";

// send mail
if ($mail->Send() === false)
    die($mail->ErrorInfo . "\n"); 
```

这是查询功能

```
 /**
* Executes SQL statement, possibly with parameters, returning
* an array of all rows in result set or false on (non-fatal) error.
*/
function query(/* $sql [, ... ] */)
{
// SQL statement
$sql = func_get_arg(0);

// parameters, if any
$parameters = array_slice(func_get_args(), 1);

// try to connect to database
static $handle;
if (!isset($handle))
{
    try
    {
        // connect to database
        $handle = new PDO("mysql:dbname=" . DATABASE . ";host=" . SERVER, USERNAME, PASSWORD);

        // ensure that PDO::prepare returns false when passed invalid SQL
        $handle->setAttribute(PDO::ATTR_EMULATE_PREPARES, false); 
    }
    catch (Exception $e)
    {
        // trigger (big, orange) error
        trigger_error($e->getMessage(), E_USER_ERROR);
        exit;
    }
}

// prepare SQL statement
$statement = $handle->prepare($sql);
if ($statement === false)
{
    // trigger (big, orange) error
    trigger_error($handle->errorInfo()[2], E_USER_ERROR);
    exit;
}

// execute SQL statement
$results = $statement->execute($parameters);

// return result set's rows, if any
if ($results !== false)
{
    return $statement->fetchAll(PDO::FETCH_ASSOC);
}
else
{
    return false;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:46:56.797

你的问题是...

```
// if the email seller form is submitted
if ($_SERVER["REQUEST_METHOD"] == "POST")  //<--   POST HERE
{

// retreive the seller's email using his id
$seller_id = $_GET["sellerid"];            //<--   GET HERE 
```

# git - 在某个提交后删除分支中的所有提交

> ID：13772550
> 
> 赞同：22
> 
> 时间：2012-12-07T23:16:27.257
> 
> 标签：git, bitbucket

我很难掌握如何使用 rebase/revert 来实现这一点。

我在我的`master`分支上工作，在某个提交后我的软件停止工作。我不想放弃当时所做的更改，并且我迫于压力要按时达到里程碑，所以我返回了一些提交`git checkout`并创建了一个名为的新分支`working`并开始在那里推送我的所有更改。后来我意识到`master`不需要这些更改（在分支上进行）。现在我想回到我的主分支并删除我用来创建`working`分支的提交之后的所有提交，然后将我`working`的分支合并到`master`分支。

我用在线照片编辑器创建了一张图像，试图解释我想要做什么。我希望它有帮助：

![位桶的屏幕截图](../Images/06273e1455b5b8a1baa2aea6e8a5a4dc.png)

我想保留 5cb967f 之后的所有内容。摆脱 5cb967f 和 a0c1de2 之间的所有内容（不包括那些）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-08T06:30:57.123

你有两个选择：

**重写历史（破坏性）**

你可以`git-rebase`用来重写历史，省略这些提交。您可以运行交互式变基。根据您的描述，我不确定您在`master`and中到底有什么`working`，但我假设所有历史（想要的和不想要的）都在那里。

```
 git checkout master
  git rebase -i a0c1de2 
```

此时，您`$EDITOR`将弹出一个提交列表，其中包含`a0c1de2`从`master`. 您可以删除对应的行`c460070..a3cb10e`以将其从历史记录中删除。

您的历史将在本地重写。如果您尝试推送此更改，这将是一个非快进更新。

**还原、保存历史（非破坏性）**

如果您希望保留历史记录，则可以还原一系列提交：

```
git checkout master
git revert c460070..a3cb10e 
```

这将创建 7 个新提交，每个提交按顺序还原这些不需要的提交中的更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T16:34:47.413

关于历史图形的某些东西很古怪。通过其中的文本标记，您想要的只是

```
$ git branch -f master working 
```

因为在 master 上没有任何`working`你想保留的 post-base 提交。

# assembly - 在 MIPS 汇编中将最后一个二进制数字与 1 进行比较

> ID：13772552
> 
> 赞同：0
> 
> 时间：2012-12-07T23:17:04.160
> 
> 标签：assembly, mips

我必须检查一个数字是偶数还是奇数。

我的策略：

1.  一个数字即使以 0 结尾
2.  以 1 结尾的数字是奇数

如何将寄存器值的最后一位与 0 或 1 进行比较？

我试过了：

```
andi $t7, $t0, 0 # where $t0 = 3 in decimal so should be 0b11 
```

它不起作用:(有什么提示吗？

# oracle - 蟾蜍的评论问题

> ID：13772554
> 
> 赞同：8
> 
> 时间：2012-12-07T23:17:15.650
> 
> 标签：oracle, vpn, toad

我对 Toad 中的评论有疑问。

我从记事本复制了几行代码到 Toad 并生成了奇怪的字符。

**更新：**我在通过 VPN 从远程桌面工作时遇到了这个问题。

![在此处输入图像描述](../Images/010cb152192fff1c39d86226fd3b3290.png)

有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T14:44:04.480

从记事本文件的名称中，我了解到您的母语是法语。您只是将 txt 文件保存在 Encode 中，该文件不完全适合 Toad。只需将记事本保存在常规编码中，它就可以正常工作（这至少是我为解决该问题所做的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-13T13:45:23.177

与其他答案类似，这是通过 vpn 工作时语言的编码问题。显然改变键盘布局也应该解决这个问题。

[https://superuser.com/questions/1254070/encoding-problems-when-copy-pasting-from-a-remote-desktop-session](https://superuser.com/questions/1254070/encoding-problems-when-copy-pasting-from-a-remote-desktop-session)

# c++ - 我希望在对右值的引用上调用基于右值的函数......如果有这样的事情

> ID：13772557
> 
> 赞同：1
> 
> 时间：2012-12-07T23:17:39.690
> 
> 标签：c++, visual-studio-2010, visual-c++, c++11

我有一个字符串类。一些运算符返回引用，其他运算符返回值。只有返回值的才能利用右值复制构造函数或右值赋值运算符。

我希望在对右值的引用上调用右值运算符。

鉴于这些：

```
String(const TCHAR* sz);
String(const String& s);    
String& operator+=(const TCHAR* sz);    
String& operator=(String&& r); 
```

而这段代码：

```
String x;
x = (String("fred") += "foo"); 
```

它调用复制构造函数 += 运算符，然后再次调用 COPY CONSTRUCTER。我希望它调用右值赋值运算符！

我添加了这个：

```
String(String&& r) 
```

这没有什么区别。

**编辑：** 我确认如果我让我的 += 运算符返回一个值，将调用右值赋值运算符。我已经做了很多性能测试，这样做会使一切都变慢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:25:22.777

您无法轻松区分“真正的”右值和右值引用，但您似乎没有这样做的动机。你的过载很好。

问题是`+=`运算符丢失了右值性。有三种解决方案：

1.  手动使其成为右值：`x = std::move(String("fred") += "foo");`
2.  使用非成员重载。我通常更喜欢这个，因为它解决了其他问题，例如将转换函数应用于表达式的左侧`+=`。

    ```
    String& operator+=(String &lhs, const TCHAR* sz);
    String&& operator+=(String &&lhs, const TCHAR* sz); 
    ```

3.  使用引用限定符，以便`operator+=`在应用于右值时返回一个右值。很少有编译器支持这一点。

    ```
    String& operator+=(const TCHAR* sz) &;
    String&& operator+=(const TCHAR* sz) &&; 
    ```

# automapper - ValueInjecter - 将源的某些属性转换为目标中的列表

> ID：13772558
> 
> 赞同：1
> 
> 时间：2012-12-07T23:17:42.730
> 
> 标签：automapper, valueinjecter

刚开始使用 Value Injector： http: [//valueinjecter.codeplex.com/](http://valueinjecter.codeplex.com/)，我有一个问题：

我有一个具有许多属性的 Source 类。某些属性具有“配置文件”的通用后缀。这些属性并不总是字符串，但大部分都是。目标有 1 个属性，`Dictionary<string, string>`。我希望所有以“配置文件”结尾的属性都插入到`Dictionary<string, string>`key = PropertyName 和 value = Property 的值中。我认为可以做到，但文档对我来说不是很清楚。有人可以指出我正确的方向吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T04:44:48.097

抱歉，我没有使用 Value Injector 的经验，但如果您选择使用[AutoMapper](https://github.com/AutoMapper/AutoMapper/wiki)，您很可能会使用[自定义解析器](https://github.com/AutoMapper/AutoMapper/wiki/Custom-value-resolvers)：

```
Mapper.CreateMap<Source, Destination>()
    .ForMember(dest => dest.Profile, opt => opt.ResolveUsing<ProfileResolver>()); 
```

解析器看起来像这样：

```
public class ProfileResolver : ValueResolver<Source, Dictionary<string, string>>
{
    protected override int ResolveCore(Source source)
    {
        var rc = new Dictionary<string, string>();
        // Do some funky reflection stuff here
        return rc;
    } 
```

}

完整的详细信息可以在[自定义解析器文档](https://github.com/AutoMapper/AutoMapper/wiki/Custom-value-resolvers)中找到。

# ios - 带有日历值的 UITableview 中的 UITextfield

> ID：13772559
> 
> 赞同：1
> 
> 时间：2012-12-07T23:18:03.033
> 
> 标签：ios, xcode, ipad, uitableview, calendar

我有一个关于用日历中的选定值填充 UITableViewCell 的问题。所以我有这个tableview，它当然是在视图出现时创建的，正如我所说的，我也有这个日历视图控制器。主要思想是用户可以在日历上选择一个日期，然后该值应该出现在 tableview 的文本字段中。

我有一个函数将所选值从日历视图控制器返回到另一个视图控制器，但之后我无法使用该值填充 UITextField。

任何想法或以前的类似经验？

这是日历视图控制器中使用的代码

```
-(void)giveString:(NSString*)string{
GradesViewController *grades = [[GradesViewController alloc]init];
[grades getString:string];
NSLog(@"String : %@",string);} 
```

这是另一个视图中的类，我希望在位于 tableviewcell 中的文本字段中的日历中的这个字符串值

```
-(void)getString:(NSString*)string{
stringDate = string;
NSLog(@"String: %@",stringDate);} 
```

这两个值都出现在日志中...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T03:45:06.227

如果您`stringDate`在. 如果您使用的是自定义 tableviewcell，则需要将该值传递给您的自定义单元格类，就像您如何调用其他`cellForRowAtIndexpath``tableviewcell cellForRowAtIndexpath``tableView``CalendarViewController``ViewController`

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
static NSString *cellId = @"cellId";
    UITableViewCell *tableCell = [tableView dequeueReusableCellWithIdentifier:cellId];
     if (tableCell == nil) {
        tableCell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellId];
        UITextField *urlTxtFld = [[UITextField alloc] initWithFrame:CGRectMake(70, 10, 230, 120)];

        urlTxtFld.backgroundColor = [UIColor clearColor];
        urlTxtFld.text = stringDate // you need to set your text like this
        urlTxtFld.autocorrectionType = UITextAutocorrectionTypeNo;
        [qrCell addSubview:urlTxtView];
        [urlTxtFld release];
    }

 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T00:02:28.507

你永远不会保留“字符串”`[GradesViewController getString:string]`

```
-(void)getString:(NSString*)string {
    stringDate = string;
    [stringDate retain];
    NSLog(@"String: %@",stringDate);
} 
```

确保它也被释放，以确保垃圾收集会清理它。

# javascript - 点击 jquery 无法识别

> ID：13772561
> 
> 赞同：1
> 
> 时间：2012-12-07T23:18:14.167
> 
> 标签：javascript, jquery

我已经多次使用 jQuery 进行悬停和单击操作，但这让我感到困惑。我导入了 jQuery 库，并且有以下内容：

```
$(document).ready(function() {
    $('.content_main_left_bottom').bind("click", function(e) {
        alert('hi');

    });
}); 
```

由于某种原因，它永远不会达到警报！我什至把警报放在文档的正上方，它就显示在那里。我在代码中的某个地方有 div 标签，`content_main_left_bottom`我还应该对那个类做些什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:44:24.080

```
jQuery(document).ready(function($) {
    $('.content_main_left_bottom').bind("click", function(e) {
        alert('hi');
    });
}); 
```

首先，如果具有 CLASS 名称（不是 ID）的元素 content_main_left_bottom 存在，我会尝试这个，它应该可以正常工作...除了代码中有任何其他 javascript 错误，您可以通过在浏览器中按 f12 并转到控制台来查找部分

# c++ - 如何从 C++ 获取 x86_64 中的 CPU 周期数？

> ID：13772567
> 
> 赞同：47
> 
> 时间：2012-12-07T23:18:41.437
> 
> 标签：c++, c, performance, x86, rdtsc

我在 SO 上看到了这篇文章，其中包含用于获取最新 CPU 周期计数的 C 代码：

[C/C++ Linux x86_64 中基于 CPU 周期计数的分析](https://stackoverflow.com/questions/3830883/cpu-cycle-count-based-profiling-in-c-c-linux-x86-64)

有没有办法可以在 C++ 中使用此代码（欢迎使用 Windows 和 linux 解决方案）？虽然用 C 编写（并且 C 是 C++ 的子集），但我不太确定这段代码是否可以在 C++ 项目中工作，如果不能，如何翻译它？

我正在使用 x86-64

编辑2：

找到了这个函数，但是VS2010无法识别汇编程序。我需要包括任何东西吗？`uint64_t`（我相信我必须换成`long long`Windows ......？）

```
static inline uint64_t get_cycles()
{
  uint64_t t;
  __asm volatile ("rdtsc" : "=A"(t));
  return t;
} 
```

编辑3：

从上面的代码我得到错误：

> “错误 C2400：‘操作码’中的内联汇编语法错误；找到‘数据类型’”

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-12-07T23:42:59.393

从 GCC 4.5 及更高版本开始，**MSVC`__rdtsc()`**和 GCC 都支持**内部函数。**

但是需要的包含是不同的：

```
#ifdef _WIN32
#include <intrin.h>
#else
#include <x86intrin.h>
#endif 
```

* * *

这是 GCC 4.5 之前的原始答案。

直接从我的一个项目中拉出来：

```
#include <stdint.h>

//  Windows
#ifdef _WIN32

#include <intrin.h>
uint64_t rdtsc(){
    return __rdtsc();
}

//  Linux/GCC
#else

uint64_t rdtsc(){
    unsigned int lo,hi;
    __asm__ __volatile__ ("rdtsc" : "=a" (lo), "=d" (hi));
    return ((uint64_t)hi << 32) | lo;
}

#endif 
```

这个[GNU C Extended asm](https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html)告诉编译器：

*   `volatile`：输出不是输入的纯函数（因此每次都必须重新运行，而不是重用旧结果）。
*   `"=a"(lo)`和`"=d"(hi)`：输出操作数是固定寄存器：EAX 和 EDX。（[x86 机器限制](https://gcc.gnu.org/onlinedocs/gcc/Machine-Constraints.html)）。x86`rdtsc`指令将其 64 位结果放入 EDX:EAX，因此让编译器选择一个输出`"=r"`是行不通的：没有办法要求 CPU 将结果发送到其他任何地方。
*   `((uint64_t)hi << 32) | lo`- 将两个 32 位一半零扩展为 64 位（因为 lo 和 hi 是`unsigned`），并将它们逻辑移位 + OR 到一个 64 位 C 变量中。在 32 位代码中，这只是一种重新解释；这些值仍然只保留在一对 32 位寄存器中。在 64 位代码中，您通常会得到一个实际的 shift + OR asm 指令，除非高半部分被优化掉。

`unsigned long`（编者注：如果你使用而不是 ，这可能会更有效`unsigned int`。然后编译器会知道它`lo`已经被零扩展为 RAX。它不会知道上半部分是零，所以如果它想要，它是等价`|`的`+`以不同的方式合并。就让优化器做好工作而言，内在函数理论上应该为您提供两全其美的效果。）

[https://gcc.gnu.org/wiki/DontUseInlineAsm](https://gcc.gnu.org/wiki/DontUseInlineAsm)如果可以避免的话。但是，如果您需要了解使用内联 asm 的旧代码以便您可以用内在函数重写它，希望本节对您有所帮助。另请参阅[https://stackoverflow.com/tags/inline-assembly/info](https://stackoverflow.com/tags/inline-assembly/info)

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2018-08-18T10:29:05.203

对于 x86-64，您的内联汇编已损坏。 `"=A"`在 64 位模式下，编译器可以选择*RAX*或 RDX，而不是 EDX:EAX。有关更多信息，请参阅[此问答](https://stackoverflow.com/questions/19941588/negative-clock-cycle-measurements-with-back-to-back-rdtsc/51916030#51916030)

* * *

**你不需要内联汇编**。没有任何好处；编译器内置了`rdtsc`and `rdtscp`，并且（至少现在）`__rdtsc`如果您包含正确的标头，则它们都定义了一个内在函数。但与几乎所有其他情况（[https://gcc.gnu.org/wiki/DontUseInlineAsm](https://gcc.gnu.org/wiki/DontUseInlineAsm)）不同，asm 没有严重的缺点，*只要您使用像 @Mysticial's 这样的良好且安全的实现*。

（asm 的一个小优势是，如果您想计时一个肯定会小于 2^32 计数的小间隔，您可以忽略结果的高半部分。编译器*可以*`uint32_t time_low = __rdtsc()`使用内在函数为您进行优化，但在练习他们有时仍然会浪费指令做换档/或。）

* * *

不幸的是，MSVC 对于非 SIMD 内部函数使用哪个标头不同意其他所有人。

[英特尔的 intriniscs 指南](https://software.intel.com/sites/landingpage/IntrinsicsGuide/#expand=4067,602,2978,4071,4255&techs=SSE,SSE2,SSE3,SSSE3,SSE4_1,SSE4_2,AVX,AVX2,Other&text=rdtsc)说`_rdtsc`（带有一个下划线） in `<immintrin.h>`，但这不适用于 gcc 和 clang。他们只在 中定义 SIMD 内在函数`<immintrin.h>`，所以我们坚持使用`<intrin.h>`(MSVC) 与`<x86intrin.h>`（其他一切，包括最近的 ICC）。为了与 MSVC 和 Intel 的文档兼容，gcc 和 clang 定义了函数的单下划线和双下划线版本。

有趣的事实：双下划线版本返回一个无符号的 64 位整数，而 Intel 文档`_rdtsc()`返回 (signed) `__int64`。

```
// valid C99 and C++

#include <stdint.h>  // <cstdint> is preferred in C++, but stdint.h works.

#ifdef _MSC_VER
# include <intrin.h>
#else
# include <x86intrin.h>
#endif

// optional wrapper if you don't want to just use __rdtsc() everywhere
inline
uint64_t readTSC() {
    // _mm_lfence();  // optionally wait for earlier insns to retire before reading the clock
    uint64_t tsc = __rdtsc();
    // _mm_lfence();  // optionally block later instructions until rdtsc retires
    return tsc;
}

// requires a Nehalem or newer CPU.  Not Core2 or earlier.  IDK when AMD added it.
inline
uint64_t readTSCp() {
    unsigned dummy;
    return __rdtscp(&dummy);  // waits for earlier insns to retire, but allows later to start
} 
```

**使用所有 4 个主要编译器进行编译：gcc/clang/ICC/MSVC，用于 32 位或 64 位。**[在 Godbolt 编译器资源管理器上](https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:%27//+valid+C99+and+C%2B%2B.++Use+-xc+on+Godbolt+to+compile+as+C%0A%0A%23include+%3Cstdint.h%3E++//+%3Ccstdint%3E+also+works+in+C%2B%2B,+if+you+prefer+that%0A%0A%23ifdef+_MSC_VER%0A%23+include+%3Cintrin.h%3E%0A%23else%0A%23+include+%3Cx86intrin.h%3E%0A%23endif%0A%0A//+optional+wrapper+if+you+don!%27t+want+to+just+use+__rdtsc()+everywhere%0A//+inline%0Auint64_t+readTSC()+%7B%0A++++//+_mm_lfence()%3B++//+optionally+wait+for+earlier+insns+to+retire+before+reading+the+clock%0A++++uint64_t+tsc+%3D+__rdtsc()%3B%0A++++//+_mm_lfence()%3B++//+optionally+block+later+instructions+until+rdtsc+retires%0A++++return+tsc%3B%0A%7D%0A%0Ainline%0Auint64_t+readTSCp()+%7B%0A++++unsigned+dummy%3B%0A++++return+__rdtscp(%26dummy)%3B++//+waits+for+earlier+insns+to+retire,+but+allows+later+to+start%0A%7D%0A%0A%0A//+see+if+compilers+can+optimize+when+we+only+need+the+low+32+bits+of+the+subtraction%0A//+smart+compilers+will+not+even+save+the+high+half+and+only+do+a+32-bit+subtraction+(because+carry+only+propagates+from+low+to+high)%0A//+even+in+64-bit+mode.++(only+clang+sees+that+optimization)%0Auint32_t++time32()+%7B%0A++++uint64_t+start+%3D+readTSC()%3B++//+we+could+help+the+compiler+by+truncating+to+32+bits+here,+but+we+aren!%27t+going+to.%0A++++//+empty%0A++++return+readTSC()+-+start%3B%0A%7D%0A%0A%0Auint64_t+time_something()+%7B%0A++++uint64_t+start+%3D+readTSC()%3B%0A++++//+even+when+empty,+back-to-back+__rdtsc()+doesn!%27t+optimize+away%0A++++return+readTSC()+-+start%3B%0A%7D%0A%27),l:%275%27,n:%270%27,o:%27C%2B%2B+source+%231%27,t:%270%27)),k:41.40171689746253,l:%274%27,m:100,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((g:!((h:compiler,i:(compiler:g82,filters:(b:%270%27,binary:%271%27,commentOnly:%270%27,demangle:%270%27,directives:%270%27,execute:%271%27,intel:%270%27,trim:%271%27),lang:c%2B%2B,libs:!(),options:%27-xc+-O3+-Wall%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+gcc+8.2+(Editor+%231,+Compiler+%231)+C%2B%2B%27,t:%270%27)),k:23.491068847669467,l:%274%27,m:51.45145145145145,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((h:compiler,i:(compiler:icc18,filters:(b:%270%27,binary:%271%27,commentOnly:%270%27,demangle:%270%27,directives:%270%27,execute:%271%27,intel:%270%27,trim:%271%27),lang:c%2B%2B,libs:!(),options:%27-std%3Dgnu%2B%2B14+-O3+-Wall+-m32%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+icc+18.0.0+(Editor+%231,+Compiler+%232)+C%2B%2B%27,t:%270%27)),l:%274%27,m:48.54854854854855,n:%270%27,o:%27%27,s:0,t:%270%27)),k:28.847568200070576,l:%273%27,n:%270%27,o:%27%27,t:%270%27),(g:!((g:!((h:compiler,i:(compiler:cl19_64,filters:(b:%270%27,binary:%271%27,commentOnly:%270%27,demangle:%270%27,directives:%270%27,execute:%271%27,intel:%270%27,trim:%271%27),lang:c%2B%2B,libs:!(),options:%27-Ox%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+MSVC+19+2017+RTW+(Editor+%231,+Compiler+%233)+C%2B%2B%27,t:%270%27)),header:(),k:29.750714902466893,l:%274%27,m:54.154154154154156,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((h:compiler,i:(compiler:clang600,filters:(b:%270%27,binary:%271%27,commentOnly:%270%27,demangle:%270%27,directives:%270%27,execute:%271%27,intel:%270%27,trim:%271%27),lang:c%2B%2B,libs:!(),options:%27-O3+-Wall%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+clang+6.0.0+(Editor+%231,+Compiler+%234)+C%2B%2B%27,t:%270%27)),header:(),l:%274%27,m:45.845845845845844,n:%270%27,o:%27%27,s:0,t:%270%27)),k:29.750714902466893,l:%273%27,n:%270%27,o:%27%27,t:%270%27)),l:%272%27,n:%270%27,o:%27%27,t:%270%27)),version:4) 查看结果，包括几个测试调用者。

**这些内在函数在 gcc4.5（从 2010 年开始）和 clang3.5（从 2014 年开始）中是新的**。Godbolt 上的 gcc4.4 和 clang 3.4 不会编译这个，但 gcc4.5.3（2011 年 4 月）可以。您可能会在旧代码中看到内联 asm，但您可以并且应该将其替换为`__rdtsc()`. 十多年前的编译器通常生成的代码比 gcc6、gcc7 或 gcc8 慢，并且有用的错误消息较少。

MSVC 内在（我认为）存在的时间要长得多，因为 MSVC 从不支持 x86-64 的内联 asm。ICC13 有`__rdtsc`in `immintrin.h`，但根本没有 a `x86intrin.h`。最近的 ICC 有`x86intrin.h`，至少是 Godbolt 为 Linux 安装它们的方式。

**您可能希望将它们定义为有符号`long long`**，特别是如果您想减去它们并转换为浮点数。 `int64_t`-> float/double 比`uint64_t`没有 AVX512 的 x86 更有效。此外，如果 TSC 没有完全同步，由于 CPU 迁移，可能会出现小的负面结果，这可能比巨大的无符号数字更有意义。

* * *

顺便说一句，clang 还有一个`__builtin_readcyclecounter()`适用于任何架构的便携式设备。（在没有循环计数器的架构上总是返回零。）请参阅[clang/LLVM 语言扩展文档](https://clang.llvm.org/docs/LanguageExtensions.html#builtin-functions)

* * *

有关**使用`lfence`(or `cpuid`) 通过阻止乱序执行来提高可重复性`rdtsc`并准确控制哪些指令在定时间隔内/不在定时间隔内的更多信息**，请参阅@HadiBrais 对 clflush 的回答，[以通过 C 函数](https://stackoverflow.com/questions/51818655/clflush-to-invalidate-cache-line-via-c-function/51830976#51830976)和评论它所产生的差异的一个例子。

另请参阅[LFENCE 是否在 AMD 处理器上进行序列化？](https://stackoverflow.com/questions/51844886/is-lfence-serializing-on-amd-processors)（TL：DR 是的，启用 Spectre 缓解，否则内核会保留相关的 MSR 未设置，因此您应该使用`cpuid`它来进行序列化。）它一直被定义为 Intel 上的部分序列化。

**[如何在英特尔® IA-32 和 IA-64 指令集架构上对代码执行时间进行基准测试](https://www.intel.com/content/dam/www/public/us/en/documents/white-papers/ia-32-ia-64-benchmark-code-execution-paper.pdf)**，这是 2010 年的英特尔白皮书。

* * *

### `rdtsc`计算*参考*周期，而不是 CPU 核心时钟周期

无论涡轮/省电如何，它都以固定频率计数，因此如果您想要按时钟进行 uops-per-clock 分析，请使用性能计数器。 `rdtsc`与挂钟时间完全相关（不计算系统时钟调整，因此它是 的完美时间源`steady_clock`）。

TSC 频率过去总是等于 CPU 的额定频率，即标榜的标签频率。在某些 CPU 中，它只是接近，例如 i7-6700HQ 2.6 GHz Skylake 上的 2592 MHz，或 4000 MHz i7-6700k 上的 4008 MHz。在 i5-1035 Ice Lake 等更新的 CPU 上，TSC = 1.5 GHz，base = 1.1 GHz，因此禁用 turbo 甚至对于这些 CPU 上的 TSC = 核心周期几乎都不起作用。

如果您将其用于微基准测试，请先包含一个预热期，以确保您的 CPU 在开始计时之前已经处于最大时钟速度。（并且可以选择禁用 turbo 并告诉您的操作系统更喜欢最大时钟速度，以避免在您的微基准测试期间 CPU 频率偏移）。
微基准测试很难：见[惯用的性能评估方式？](https://stackoverflow.com/questions/60291987/idiomatic-way-of-performance-evaluation)对于其他陷阱。

除了 TSC 之外，您还可以使用一个库来访问硬件性能计数器。复杂但开销低的方法是编写 perf 计数器并`rdmsr`在用户空间中使用，或者更简单的方法包括[perf stat 之](https://stackoverflow.com/questions/26267588/perf-stat-for-part-of-program)类的技巧，如果您的定时区域足够长，您可以附加一个`perf stat -p PID`.

不过，您通常仍希望为微基准测试保持 CPU 时钟固定，除非您想了解不同的负载如何让 Skylake 在内存受限或其他情况下时钟下降。（请注意，内存带宽/延迟大部分是固定的，使用与内核不同的时钟。在空闲时钟速度下，L2 或 L3 缓存未命中需要的内核时钟周期要少得多。）

*   [使用背靠背 rdtsc 进行负时钟周期测量？](https://stackoverflow.com/questions/19941588/wrong-clock-cycle-measurements-with-rdtsc)RDTSC的历史：本来CPU不省电，所以TSC既是实时时钟又是核心时钟。然后，它通过各种几乎没有用的步骤演变为当前形式的有用的低开销时间源，与核心时钟周期（`constant_tsc`）分离，时钟停止时不会停止（`nonstop_tsc`）。还有一些技巧，例如不要取平均时间，取中间值（会有非常高的异常值）。
*   [std::chrono::clock，硬件时钟和周期计数](https://stackoverflow.com/questions/50883849/stdchronoclock-hardware-clock-and-cycle-count)
*   [使用 RDTSC 获取 cpu 周期 - 为什么 RDTSC 的值总是增加？](https://stackoverflow.com/questions/8602336/getting-cpu-cycles-using-rdtsc-why-does-the-value-of-rdtsc-always-increase/8605960#8605960)
*   [英特尔丢失周期？rdtsc 和 CPU_CLK_UNHALTED.REF_TSC 之间的不一致](https://stackoverflow.com/questions/45472147/lost-cycles-on-intel-an-inconsistency-between-rdtsc-and-cpu-clk-unhalted-ref-ts)
*   [使用 RDTSC 指令测量 C 中的代码执行时间](https://stackoverflow.com/questions/33470759/measuring-code-execution-times-in-c-using-rdtsc-instruction/33473175#33473175)列出了一些陷阱，包括即使在内核模式下也无法避免的 SMI（系统管理中断）`cli`，以及`rdtsc`VM 下的虚拟化。当然，诸如定期中断之类的基本内容也是可能的，因此请多次重复您的时间并丢弃异常值。
*   [确定 Linux 上的 TSC 频率](https://stackoverflow.com/questions/51919219/determine-tsc-frequency-on-linux)。 **以编程方式查询 TSC 频率很困难，而且可能是不可能的，尤其是在用户空间中，或者可能给出比校准更差的结果**。使用另一个已知的时间源校准它需要时间。有关将 TSC 转换为纳秒的难度的更多信息，请参阅该问题（如果您可以询问操作系统转换率是多少，那会很好，因为操作系统在启动时已经这样做了）。

**如果您出于调整目的使用 RDTSC 进行微基准测试，那么最好的选择是只使用滴答声并跳过甚至尝试转换为纳秒。** 否则，请使用高分辨率库时间函数，如`std::chrono`or `clock_gettime`。有关时间戳函数的一些讨论/比较，请参阅[gettimeofday 的更快等效项](https://stackoverflow.com/questions/6498972/faster-equivalent-of-gettimeofday)`rdtsc`，或者如果您的精度要求足够低以使计时器中断或线程更新它，则从内存中读取共享时间戳以完全避免。

另请参阅[使用 rdtsc 计算系统时间，](https://stackoverflow.com/questions/42189976/calculate-system-time-using-rdtsc/42190816#42190816)了解查找晶体频率和乘数。

[CPU TSC 获取操作，尤其是在多核-多处理器环境中](https://stackoverflow.com/questions/10921210/cpu-tsc-fetch-operation-especially-in-multicore-multi-processor-environment)表示**Nehalem 和更新的 TSC 为一个包中的所有内核同步并锁定在一起**（以及不变 = 恒定和不间断的 TSC 功能）。有关多套接字同步的一些有用信息，请参阅@amdn 的答案。

（显然，即使对于现代多插槽系统，只要它们具有该功能，它们通常也是可靠的，请参阅@amdn 对链接问题的回答，以及下面的更多详细信息。）

* * *

### 与 TSC 相关的 CPUID 功能

使用[Linux`/proc/cpuinfo`用于 CPU features](https://unix.stackexchange.com/questions/43539/what-do-the-flags-in-proc-cpuinfo-mean)的名称，以及您还将找到的相同功能的其他别名。

*   `tsc`- TSC 存在并`rdtsc`受支持。x86-64 的基线。
*   `rdtscp`-`rdtscp`支持。
*   `tsc_deadline_timer` `CPUID.01H:ECX.TSC_Deadline[bit 24] = 1`- 本地 APIC 可以编程为在 TSC 达到您输入的值时触发中断`IA32_TSC_DEADLINE`。我认为，启用“tickless”内核，直到下一件应该发生的事情发生。
*   `constant_tsc`：对恒定 TSC 功能的支持是通过检查 CPU 系列和型号来确定的。无论核心时钟速度如何变化，TSC 都以恒定频率滴答作响。没有这个，RDTSC*会*计算核心时钟周期。
*   `nonstop_tsc`：此功能在英特尔 SDM 手册中称为不变 TSC，并且在带有`CPUID.80000007H:EDX[8]`. 即使在深度睡眠 C 状态下，TSC 也会保持滴答作响。在所有 x86 处理器上，`nonstop_tsc`暗示`constant_tsc`但`constant_tsc`不一定暗示`nonstop_tsc`. 没有单独的 CPUID 功能位；在 Intel 和 AMD 上，相同的不变 TSC CPUID 位意味着两者`constant_tsc`和`nonstop_tsc`特性。请参阅[Linux 的 x86/kernel/cpu/intel.c 检测代码](https://elixir.bootlin.com/linux/v5.4.12/source/arch/x86/kernel/cpu/intel.c#L253)，并且`amd.c`类似。

一些基于 Saltwell/Silvermont/Airmont 的处理器（但不是全部）甚至在 ACPI S3 全系统睡眠中保持 TSC 滴答作响：`nonstop_tsc_s3`. 这称为永远在线 TSC。（尽管似乎基于 Airmont 的那些从未发布过。）

有关常数和不变 TSC 的更多详细信息，请参阅：[常数非不变 tsc 可以在 cpu 状态之间改变频率吗？](https://stackoverflow.com/questions/62492053/can-constant-non-invariant-tsc-change-frequency-across-cpu-states/63201400#63201400).

*   `tsc_adjust`：MSR 可用，允许操作系统设置偏移量，在读取或读取它时添加`CPUID.(EAX=07H, ECX=0H):EBX.TSC_ADJUST (bit 1)`到TSC 。这允许有效地更改某些/所有内核上的 TSC，而无需[在逻辑内核之间取消同步](https://software.intel.com/en-us/forums/software-tuning-performance-optimization-platform-monitoring/topic/388964)。（如果软件在每个内核上将 TSC 设置为新的绝对值，就会发生这种情况；很难在每个内核上以相同的周期执行相关的 WRMSR 指令。）`IA32_TSC_ADJUST``rdtsc``rdtscp`

`constant_tsc`并`nonstop_tsc`共同使 TSC 可用作`clock_gettime`用户空间等事物的时间源。（但像 Linux 这样的操作系统只使用 RDTSC 在由 NTP 维护的较慢时钟的滴答之间进行插值，更新定时器中断中的比例/偏移因子。请参阅[On a cpu with constant_tsc 和 nonstop_tsc，为什么我的时间会漂移？](https://stackoverflow.com/questions/39151049/on-a-cpu-with-constant-tsc-and-nonstop-tsc-why-does-my-time-drift/51919148#51919148)）在更旧的 CPU 上不支持深度睡眠状态或频率缩放，TSC 作为时间源可能仍然可用

**Linux 源代码中的[注释](https://elixir.bootlin.com/linux/v5.4.12/source/arch/x86/kernel/cpu/intel.c#L253)还表明`constant_tsc`/ `nonstop_tsc`features（在 Intel 上）意味着“*它在内核和套接字之间也是可靠的。（但不是跨机柜 - 在这种情况下我们明确将其关闭。）* ”**

“跨套接字”部分不准确。通常，不变的 TSC 仅保证 TSC 在同一插槽内的内核之间同步。在[英特尔论坛主题](http://BTW:%20TSC%20invariance%20does%20not%20imply%20cross-socket%20synchronization.%20That%20requires%20the%20platform%20vendor%20to%20distribute%20RESET%20synchronously%20to%20all%20sockets.)中，Martin Dixon（英特尔）指出*TSC 不变性并不意味着跨插槽同步。这需要平台供应商将 RESET 同步分发到所有套接字。*鉴于上述 Linux 内核评论， 显然平台供应商在实践中*会这样做。*关于 CPU TSC 获取操作的答案，[特别是在多核多处理器环境中](https://stackoverflow.com/questions/10921210/cpu-tsc-fetch-operation-especially-in-multicore-multi-processor-environment)，也同意单个主板上的所有插槽应该同步启动。

在多插槽共享内存系统上，没有直接的方法可以检查所有内核中的 TSC 是否同步。Linux 内核默认执行启动时和运行时检查以确保 TSC 可以用作时钟源。这些检查涉及确定 TSC 是否已同步。该命令的输出`dmesg | grep 'clocksource'`将告诉您内核是否使用 TSC 作为时钟源，只有在检查通过时才会发生这种情况。*但即便如此，这也不能明确证明 TSC 在系统的所有套接字之间是同步的。*内核参数`tsc=reliable`可以用来告诉内核它可以盲目地使用TSC作为时钟源而不做任何检查。

在某些情况下，跨插槽 TSC 可能不同步：(1) 热插拔 CPU，(2) 当插槽分布在由扩展节点控制器连接的不同板上时，(3) TSC 在唤醒后可能不会重新同步从某些处理器中 TSC 断电的 C 状态开始，并且 (4) 不同的插槽安装了不同的 CPU 型号。

直接更改 TSC 而不是使用 TSC_ADJUST 偏移量的操作系统或管理程序可以取消同步它们，因此在用户空间中，假设 CPU 迁移不会让您读取不同的时钟可能并不总是安全的。（这就是为什么`rdtscp`生成一个核心 ID 作为额外输出的原因，因此您可以检测开始/结束时间何时来自不同的时钟。它可能是在不变 TSC 功能之前引入的，或者他们只是想考虑所有可能性。 )

如果您`rdtsc`直接使用，您可能希望将您的程序或线程固定到核心，例如`taskset -c 0 ./myprogram`在 Linux 上。无论您是否需要 TSC，CPU 迁移通常会导致大量缓存未命中，并且无论如何都会弄乱您的测试，并且需要额外的时间。（尽管中断也会如此）。

* * *

## 使用内在函数的 asm 效率如何？

它与您从@Mysticial 的 GNU C 内联汇编中获得的一样好，或者更好，因为它知道 RAX 的高位被归零。您想要保留内联 asm 的主要原因是为了与顽固的旧编译器兼容。

函数本身的非内联版本`readTSC`使用 MSVC for x86-64 编译，如下所示：

```
unsigned __int64 readTSC(void) PROC                             ; readTSC
    rdtsc
    shl     rdx, 32                             ; 00000020H
    or      rax, rdx
    ret     0
  ; return in RAX 
```

对于在 中返回 64 位整数的 32 位调用约定`edx:eax`，它只是`rdtsc`/ `ret`。没关系，你总是希望它内联。

在使用它两次并减去时间间隔的测试调用者中：

```
uint64_t time_something() {
    uint64_t start = readTSC();
    // even when empty, back-to-back __rdtsc() don't optimize away
    return readTSC() - start;
} 
```

所有 4 个编译器都编写了非常相似的代码。这是 GCC 的 32 位输出：

```
# gcc8.2 -O3 -m32
time_something():
    push    ebx               # save a call-preserved reg: 32-bit only has 3 scratch regs
    rdtsc
    mov     ecx, eax
    mov     ebx, edx          # start in ebx:ecx
      # timed region (empty)

    rdtsc
    sub     eax, ecx
    sbb     edx, ebx          # edx:eax -= ebx:ecx

    pop     ebx
    ret                       # return value in edx:eax 
```

这是 MSVC 的 x86-64 输出（应用了名称分解）。gcc/clang/ICC 都发出相同的代码。

```
# MSVC 19  2017  -Ox
unsigned __int64 time_something(void) PROC                            ; time_something
    rdtsc
    shl     rdx, 32                  ; high <<= 32
    or      rax, rdx
    mov     rcx, rax                 ; missed optimization: lea rcx, [rdx+rax]
                                     ; rcx = start
     ;; timed region (empty)

    rdtsc
    shl     rdx, 32
    or      rax, rdx                 ; rax = end

    sub     rax, rcx                 ; end -= start
    ret     0
unsigned __int64 time_something(void) ENDP                            ; time_something 
```

所有 4 个编译器都使用`or`+`mov`而不是`lea`将低半部分和高半部分组合到不同的寄存器中。我猜这是他们未能优化的固定序列。

但是自己在 inline asm 中编写 shift/lea 也好不到哪里去。如果您的时间间隔如此之短以至于您只保留 32 位结果，那么您将剥夺编译器忽略 EDX 中结果的高 32 位的机会。或者如果编译器决定将开始时间存储到内存中，它可以只使用两个 32 位存储而不是 shift/或/mov。如果 1 个额外的 uop 作为计时的一部分让您感到困扰，您最好用纯 asm 编写整个微基准测试。

然而，我们也许可以通过 @Mysticial 代码的修改版本获得两全其美：

```
// More efficient than __rdtsc() in some case, but maybe worse in others
uint64_t rdtsc(){
    // long and uintptr_t are 32-bit on the x32 ABI (32-bit pointers in 64-bit mode), so #ifdef would be better if we care about this trick there.

    unsigned long lo,hi;  // let the compiler know that zero-extension to 64 bits isn't required
    __asm__ __volatile__ ("rdtsc" : "=a" (lo), "=d" (hi));
    return ((uint64_t)hi << 32) + lo;
    // + allows LEA or ADD instead of OR
} 
```

[在 Godbolt 上](https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:%27%23include+%3Cstdint.h%3E++//+%3Ccstdint%3E+also+works+in+C%2B%2B,+if+you+prefer+that%0A%0A%23ifdef+_MSC_VER%0A%23+include+%3Cintrin.h%3E%0A%23else%0A%23+include+%3Cx86intrin.h%3E%0A%23endif%0A%0A%23ifdef+__GNUC__%0Auint64_t+rdtsc()%7B%0A++++//+long+and+uintptr_t+are+32-bit+on+x32+(32-bit+pointers+in+long+mode),+so+%23ifdef+would+be+better+if+we+care+about+optimal+asm+there.%0A%0A++++unsigned+long+lo,hi%3B++//+let+the+compiler+know+that+zero-extension+to+64+bits+isn!%27t+required%0A++++__asm__+__volatile__+(%22rdtsc%22+:+%22%3Da%22+(lo),+%22%3Dd%22+(hi))%3B%0A++++return+((uint64_t)hi+%3C%3C+32)+%2B+lo%3B%0A++++//+%2B+allows+LEA+or+ADD+instead+of+OR%0A++++//+%7C+optimizes+much+better+than+%2B+for+gcc+-m32.++(Both+suck+with+gcc7+and+later+though)%0A%7D%0A%23else%0A%23define+rdtsc+__rdtsc%0A%23endif%0A%0A//+return+a+correctly+zero-extended+32-bit+result%0A//+just+to+give+the+compiler+a+bit+more+work+to+do%0Auint64_t++test32()+%7B%0A++++uint64_t++tsc+%3D+rdtsc()%3B%0A++++//return++rdtsc()+-+tsc%3B%0A%0A++++uint32_t++low32+%3D+tsc%3B%0A++++low32+-%3D+rdtsc()%3B%0A++++return+low32%3B%0A%7D%0A%0Avoid+ext(void)%3B%0Auint64_t++test64()+%7B%0A++++uint64_t++tsc+%3D+rdtsc()%3B%0A++++//+compilers+get+carried+away+optimizing,+and+save/restore+two+registers%0A++++//+instead+of+combining+lo+and+hi+to+one+reg.%0A++++ext()%3B%0A++++return++rdtsc()+-+tsc%3B%0A%7D%0A%27),l:%275%27,n:%270%27,o:%27C%2B%2B+source+%231%27,t:%270%27)),k:41.40171689746253,l:%274%27,m:100,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((g:!((h:compiler,i:(compiler:g63,filters:(b:%270%27,binary:%271%27,commentOnly:%270%27,demangle:%270%27,directives:%270%27,execute:%271%27,intel:%270%27,trim:%271%27),lang:c%2B%2B,libs:!(),options:%27-xc+-O3+-Wall%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+gcc+6.3+(Editor+%231,+Compiler+%231)+C%2B%2B%27,t:%270%27)),k:23.491068847669467,l:%274%27,m:51.45145145145145,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((h:compiler,i:(compiler:icc18,filters:(b:%270%27,binary:%271%27,commentOnly:%270%27,demangle:%270%27,directives:%270%27,execute:%271%27,intel:%270%27,trim:%271%27),lang:c%2B%2B,libs:!(),options:%27-std%3Dgnu%2B%2B14+-O3+-Wall%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+icc+18.0.0+(Editor+%231,+Compiler+%232)+C%2B%2B%27,t:%270%27)),l:%274%27,m:48.54854854854855,n:%270%27,o:%27%27,s:0,t:%270%27)),k:28.847568200070576,l:%273%27,n:%270%27,o:%27%27,t:%270%27),(g:!((g:!((h:compiler,i:(compiler:cl19_64,filters:(b:%270%27,binary:%271%27,commentOnly:%270%27,demangle:%270%27,directives:%270%27,execute:%271%27,intel:%270%27,trim:%271%27),lang:c%2B%2B,libs:!(),options:%27-Ox%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+MSVC+19+2017+RTW+(Editor+%231,+Compiler+%233)+C%2B%2B%27,t:%270%27)),header:(),k:29.750714902466893,l:%274%27,m:54.154154154154156,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((h:compiler,i:(compiler:clang600,filters:(b:%270%27,binary:%271%27,commentOnly:%270%27,demangle:%270%27,directives:%270%27,execute:%271%27,intel:%270%27,trim:%271%27),lang:c%2B%2B,libs:!(),options:%27-O3+-Wall%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+clang+6.0.0+(Editor+%231,+Compiler+%234)+C%2B%2B%27,t:%270%27)),header:(),l:%274%27,m:45.845845845845844,n:%270%27,o:%27%27,s:0,t:%270%27)),k:29.750714902466893,l:%273%27,n:%270%27,o:%27%27,t:%270%27)),l:%272%27,n:%270%27,o:%27%27,t:%270%27)),version:4)，这有时会提供比`__rdtsc()`gcc/clang/ICC 更好的 asm，但有时它会欺骗编译器使用额外的寄存器来分别保存 lo 和 hi，因此 clang 可以优化为`((end_hi-start_hi)<<32) + (end_lo-start_lo)`. 希望如果有真正的寄存器压力，编译器会更早地结合起来。（gcc 和 ICC 仍然分别保存 lo/hi，但也不要优化。）

但是 32 位 gcc8 把它弄得一团糟，甚至只用带有零`rdtsc()`的实际值编译函数本身，`add/adc`而不是像 clang 那样只在 edx:eax 中返回结果。（gcc6 和更早的版本可以使用`|`而不是，但如果您关心来自 gcc 的 32 位代码生成，则`+`绝对更喜欢内在的）。`__rdtsc()`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-12-07T23:45:36.457

VC++ 对内联汇编使用完全不同的语法——但仅限于 32 位版本。64 位编译器根本不支持内联汇编。

在这种情况下，这可能也一样——`rdtsc`在时序代码序列方面（至少）有两个主要问题。首先（像大多数指令一样）它可以乱序执行，所以如果你试图对一小段代码进行计时，那么`rdtsc`之前和之后的代码可能都在它之前执行，或者都在它之后执行，或者你有什么（我相当确定这两者将始终按顺序执行，因此至少差异永远不会是负面的）。

其次，在多核（或多处理器）系统上，一个 rdtsc 可能在一个内核/处理器上执行，而另一个在不同的内核/处理器上执行。在这种情况下，完全有可能得出否定的*结果*。

一般来说，如果你想在 Windows 下有一个精确的计时器，你最好使用`QueryPerformanceCounter`.

如果您真的坚持使用`rdtsc`，我相信您必须在完全用汇编语言（或使用编译器内部）编写的单独模块中执行此操作，然后与您的 C 或 C++ 链接。我从来没有为 64 位模式编写过该代码，但在 32 位模式下它看起来像这样：

```
 xor eax, eax
   cpuid
   xor eax, eax
   cpuid
   xor eax, eax
   cpuid
   rdtsc
   ; save eax, edx

   ; code you're going to time goes here

   xor eax, eax
   cpuid
   rdtsc 
```

我知道这看起来很奇怪，但实际上是对的。您执行 CPUID 因为它是一个序列化指令（不能乱序执行）并且在用户模式下可用。您在开始计时之前执行了三次，因为英特尔记录了第一次执行可以/将以与第二次不同的速度运行的事实（他们推荐的是三个，所以它是三个）。

然后你执行你的被测代码，另一个 cpuid 强制序列化，最后一个 rdtsc 来获取代码完成后的时间。

除此之外，您还想使用您的操作系统提供的任何方式来强制这一切在一个进程/核心上运行。在大多数情况下，您还想强制代码对齐——对齐的变化会导致执行速度的相当大的差异。

最后你想多次执行它——而且它总是有可能在中间被打断（例如，任务切换），所以你需要准备好执行可能需要相当长的时间比其他的更长——例如，5 次运行需要大约 40-43 个时钟周期，而第六次运行需要 10000 多个时钟周期。显然，在后一种情况下，您只需丢弃异常值——它不是来自您的代码。

摘要：管理执行 rdtsc 指令本身（几乎）是您最不担心的事情。在获得结果之前，您*还需*要做很多事情`rdtsc`，这实际上意味着任何事情。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-07T23:41:59.943

对于 Windows，Visual Studio 提供了一个方便的“编译器内在函数”（即编译器理解的特殊函数），它为您执行 RDTSC 指令并返回结果：

```
unsigned __int64 __rdtsc(void); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-11-18T17:19:52.547

**Linux[`perf_event_open`](https://man7.org/linux/man-pages/man2/perf_event_open.2.html)系统调用与`config = PERF_COUNT_HW_CPU_CYCLES`**

这个 Linux 系统调用似乎是性能事件的跨体系结构包装器。

这个答案类似：[快速计算在 C 程序中执行的指令数量](https://stackoverflow.com/questions/13313510/quick-way-to-count-number-of-instructions-executed-in-a-c-program/64863392#64863392)但使用`PERF_COUNT_HW_CPU_CYCLES`而不是`PERF_COUNT_HW_INSTRUCTIONS`. 该答案将侧重于`PERF_COUNT_HW_CPU_CYCLES`细节，请参阅其他答案以获取更多通用信息。

这是一个基于手册页末尾提供的示例。

perf_event_open.c

```
#define _GNU_SOURCE
#include <asm/unistd.h>
#include <linux/perf_event.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/ioctl.h>
#include <unistd.h>

#include <inttypes.h>
#include <sys/types.h>

static long
perf_event_open(struct perf_event_attr *hw_event, pid_t pid,
                int cpu, int group_fd, unsigned long flags)
{
    int ret;

    ret = syscall(__NR_perf_event_open, hw_event, pid, cpu,
                    group_fd, flags);
    return ret;
}

int
main(int argc, char **argv)
{
    struct perf_event_attr pe;
    long long count;
    int fd;

    uint64_t n;
    if (argc > 1) {
        n = strtoll(argv[1], NULL, 0);
    } else {
        n = 10000;
    }

    memset(&pe, 0, sizeof(struct perf_event_attr));
    pe.type = PERF_TYPE_HARDWARE;
    pe.size = sizeof(struct perf_event_attr);
    pe.config = PERF_COUNT_HW_CPU_CYCLES;
    pe.disabled = 1;
    pe.exclude_kernel = 1;
    // Don't count hypervisor events.
    pe.exclude_hv = 1;

    fd = perf_event_open(&pe, 0, -1, -1, 0);
    if (fd == -1) {
        fprintf(stderr, "Error opening leader %llx\n", pe.config);
        exit(EXIT_FAILURE);
    }

    ioctl(fd, PERF_EVENT_IOC_RESET, 0);
    ioctl(fd, PERF_EVENT_IOC_ENABLE, 0);

    /* Loop n times, should be good enough for -O0\. */
    __asm__ (
        "1:;\n"
        "sub $1, %[n];\n"
        "jne 1b;\n"
        : [n] "+r" (n)
        :
        :
    );

    ioctl(fd, PERF_EVENT_IOC_DISABLE, 0);
    read(fd, &count, sizeof(long long));

    printf("%lld\n", count);

    close(fd);
} 
```

结果似乎是合理的，例如，如果我打印周期然后重新编译指令计数，我们每次迭代得到大约 1 个周期（在一个周期中完成 2 条指令）可能是由于诸如超标量执行之类的影响，每次运行的结果略有不同可能是由于随机内存访问延迟。

您可能还对`PERF_COUNT_HW_REF_CPU_CYCLES`手册页中的文档感兴趣：

> 总周期；不受 CPU 频率缩放的影响。

因此，如果您的频率缩放打开，这将提供更接近真实墙上时间的东西。这些比我的快速实验大 2/3 倍`PERF_COUNT_HW_INSTRUCTIONS`，大概是因为我的非压力机器现在是频率缩放的。

# jquery - TypeError: $("#view_map").fancybox 不是函数

> ID：13772570
> 
> 赞同：0
> 
> 时间：2012-12-07T23:18:53.447
> 
> 标签：jquery, fancybox

我的一个页面在 Firebug 中出现以下错误...

```
TypeError: $("#view_map").fancybox is not a function
    'overlayColor': '#333' 
```

这是抛出它的代码......

```
 <script type="text/javascript">
        $(document).ready(function(){
            $('#view_map').fancybox({
                'autoDimensions': false,
                'width': 750,
                'height': 550,
                'padding': 0,
                'easingIn': 'swing',
                'easingOut': 'swing',
                'overlayOpacity': 0.75,
                'overlayColor': '#333'
            });
        });
    </script> 
```

不管函数中的最后一个选项是什么，它都会将该选项放入错误中。那里有语法错误还是什么？我可以看出它有什么问题。

编辑：

这是对脚本的调用...

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
<script type="text/javascript" src="http://www.triadbarspecials.com/fancybox/fancybox/jquery.easing-1.3.pack.js"></script> 
```

（缓动包是 1.3.4；在某些时候我不小心从名称中删除了 .4。IDK 为什么）

这是函数中引用的 ID 的锚点......

```
<a id="view_map" href="#map" style="color: #fcb60e; text-decoration: none;">View Map</a> 
```

# map 是包含地图的 div，这就是我的幻想箱的全部内容

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:55:33.830

您不是在加载fancybox 脚本，而是在加载jQuery 和缓动脚本（用于平滑动画）。

在缓动脚本之前调用您的 fancybox 脚本。

*`Edit: Dont forget the CSS file either.`*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T16:45:30.383

自从我在此发表原始帖子以来，我已经从我的网站上删除了 fancybox。从来没有想出一个解决方案，但感谢您的帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T23:56:15.080

您是否包含了 fancybox 函数的脚本？例如

```
<script type="text/javascript" src="/fancybox/source/jquery.fancybox.pack.js?v=2.1.3"></script> 
```

（如下所述，更改路径和文件名以反映您的文件结构和fancybox 版本。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-24T06:54:18.797

在我将 jquery 升级到 1.10 后，我遇到了和你一样的问题。

所以我将我的 jquery 降级到 1.8 并且它再次工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-17T07:39:23.740

如果您使用新版本的 jQuery，您必须添加 jQuery 迁移插件[http://code.jquery.com/jquery-migrate-1.2.1.min.js](http://code.jquery.com/jquery-migrate-1.2.1.min.js)

# asp.net - 使用列表名称获取列表计数

> ID：13772580
> 
> 赞同：0
> 
> 时间：2012-12-07T23:19:57.630
> 
> 标签：asp.net, vb.net, visual-studio-2008

我有 2 个列表（字符串）。让我们称它们为 myList1 和 myList2。这些列表（字符串）中的每一个都根据用户操作添加和删除项目。在代码的其他地方，我用这两个 List(of String) 之一的名称填充了一个字符串变量。让我们称之为 myString。

所以让我们说`myString = "myList2"`。我将如何仅从该字符串值中获取 myList2 中的项目数？我是否必须在 myString 上使用某种`DirectCast()`或？`CType()`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:30:14.843

有几个选择。

1：

```
Select Case myString
  Case "myList1"
    Return myList1.Count
  Case "myList2"
    Return myList2.Count
End Select 
```

2：将列表存储在字典中：

```
Dim myDictionary As Dictionary(Of String, List(Of String)) = New Dictionary(Of String, List(Of String))

myDictionary.Add("myList1", New List(Of String))
myDictionary.Add("myList2", New List(Of String))
...
Return myDictionary(myString).Count 
```

在这种情况下避免反射。它是不必要的，会导致糟糕的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:30:45.440

如果没有大量的反思，你将无法做到这一点。最好保存一个计数变量：

```
Dim listCount = myList2.Count 
```

# javascript - 将桌面拖放到浏览器 HTML5 Javascript

> ID：13772583
> 
> 赞同：2
> 
> 时间：2012-12-07T23:20:05.957
> 
> 标签：javascript, html, drag-and-drop

寻找一些指导，仍然是一个代码学习者，并且在使用 HTML5 DnD/File Api 时遇到了一些困难......玩了一些演示来尝试了解它们是如何工作的，我有点问题。

大多数似乎都使用内联 css/js 方法，我试图在单独的文件中使用它们，但似乎无法正确使用。

有人可以为我做一个非常快速的演示，使用带有从桌面拖放的 HTML 画布，一个从桌面拖放的简单画布元素吗？我似乎无法理解它。

使用 chrome，因此无需担心跨浏览器支持。

非常感谢阿尔多。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T23:27:53.050

我总是担心那些说“使用 chrome 所以无需担心跨浏览器支持”之类的话的人——因为这有点像 IE6 的开始，看看它把我们引向何方。

然而，好消息是大多数现代浏览器都支持 HTML5 File API，因此我们不需要做任何特定于浏览器的事情。

Mozilla 网站是一个很好的参考，他们有一个关于如何使用 File API 的优秀教程。在这里阅读：[https ://developer.mozilla.org/en-US/docs/Using_files_from_web_applications](https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications)

本教程涵盖的内容不仅仅是拖放，而且您需要先完成一些更基本的项目，然后才能了解拖放部分，但它很透彻，并详细解释了所有内容。

希望有帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-07T23:25:02.940

试试这个 -

[http://www.w3schools.com/html/html5_draganddrop.asp](http://www.w3schools.com/html/html5_draganddrop.asp)

[https://www.ibm.com/developerworks/mydeveloperworks/blogs/bobleah/entry/html5_an_example_of_drag_and_drop26?lang=en](https://www.ibm.com/developerworks/mydeveloperworks/blogs/bobleah/entry/html5_an_example_of_drag_and_drop26?lang=en)

[http://blog.exadel.com/a-simple-html5-drag-and-drop-example/](http://blog.exadel.com/a-simple-html5-drag-and-drop-example/)

用谷歌搜索一下，有很多简单的例子

# entity-framework - MVC 4 独特的字段模型

> ID：13772587
> 
> 赞同：0
> 
> 时间：2012-12-07T23:20:30.017
> 
> 标签：entity-framework, ef-code-first

我一直在谷歌上搜索，但并不高兴。

如何在 mvc4 .net 中以代码优先方法向字段添加唯一性

```
 public class Religion
    {
        public int ReligionId { get; set; }
        [Required]
        [StringLength(200)]
        public string Description { get; set; }
    } 
```

我需要在描述中添加什么才能使其正常工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T10:27:59.867

您可以使用链接[http://msdn.microsoft.com/en-us/library/gg508808(v=vs.98).aspx](http://msdn.microsoft.com/en-us/library/gg508808(v=vs.98).aspx) 简单快速的远程验证审核

# java - 查找字符串中的下一个字符？

> ID：13772593
> 
> 赞同：1
> 
> 时间：2012-12-07T23:21:06.863
> 
> 标签：java, date, char

我有一个 java 编程任务，你必须在一行中输入一个日期，它会根据日期为你提供一个命理（类似星座）的报告。假设用户将输入格式化的日期，用空格分隔。

我可以使用 in.nextInt() 检索输入的月、日和年。但是，我还必须检查用户是否为日期的每个部分使用了正确的分隔字符，这意味着我只需要检查用户是否使用了正斜杠。

在查看下面的代码时，我目前使用 charAt() 来查找分隔字符。问题是日期并不总是 14 个字符长。所以 10 / 17 / 2004 形式的日期有 14 个字符长，但 4 / 7 / 1992 的日期只有 12 个字符长，这意味着“slash1”不会总是在.charAt(3) 中，在后一种情况是 in.charAt(2)。

java 是否有允许类似 in.nextChar() 的方法？我知道它没有，但我怎么能在日期中找到下一个字符？

**编辑：我最初忘记反映这一点，但我的教授说我们不允许使用 String.split() 方法，出于某种原因。问题是，我完全可以得到月份、日期和年份。我只需要检查该人是否使用正斜杠来分隔日期。如果输入破折号，则日期无效。**

```
public void getDate()
{
    char slash1, slash2;

    do
    {
        System.out.print("Please enter your birth date (mm / dd / yyyy): ");
        Scanner in = new Scanner(System.in);
        String date = in.nextLine();

        month = in.nextInt();
        day = in.nextInt();
        year = in.nextInt();

        slash1 = date.charAt(3);
        slash2 = date.charAt(8);
    } while (validDate(slash1, slash2) == false);

    calcNum();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:32:30.477

你可以考虑用 分割输入日期字符串`" / "`，然后你得到一个字符串数组。下一步是将该数组中的每个字符串转换为 int。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:59:40.817

与其考虑使用什么字符作为分隔符，不如关注你想要的内容，也就是数字。

*此代码在非*数字上拆分，每组中有多少数字或使用哪些字符作为分隔符都无关紧要：

```
String[] parts = input.split("\\D+"); 
```

它也几乎没有任何代码，因此出现错误的可能性要小得多。

现在您在 String[] 中有了数字部分，您可以继续进行计算。

以下是您可以在上述拆分之后使用的一些代码：

```
if (parts.length != 3) {
    // bad input
}

// assuming date entered in standard format of dd/mm/yyyy
// and not in retarded American format, but it's up to you
int day = Integer.parseInt(parts[0];
int month = Integer.parseInt(parts[1];
int year = Integer.parseInt(parts[2]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T00:17:55.533

在流中向前看，以确保它包含您期望的内容。

```
private static final Pattern SLASH = Pattern.compile("\\s*/\\s*");

static SomeTypeYouMadeToHoldCalendarDate getDate() {
  while (true) { /* Might want to give user a way to quit. */
    String line = 
      System.console().readLine("Please enter your birth date (mm / dd / yyyy): ");
    Scanner in = new Scanner(line);
    if (!in.hasNextInt())
      continue;
    int month = in.nextInt();
    if (!in.hasNext(SLASH)
      continue;
    in.next(SLASH);
    ...
    if (!validDate(month, day, year))
      continue;
    return new SomeTypeYouMadeToHoldCalendarDate(month, day, year);
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-08T00:36:04.227

我会使用扫描仪只是为了得到一条线。然后 split() 空白处的行并检查字段：

```
import java.util.Scanner;
import java.util.regex.Pattern;

public class GetDate {

   int month, day, year;

   public static void main(String[] args)
   {
      GetDate theApp = new GetDate();
      theApp.getDate();

   }

   public void getDate()
   {
      String date;
      do
      {
         System.out.print("Please enter your birth date (mm / dd / yyyy): ");
         Scanner in = new Scanner(System.in);
         date = in.nextLine();
      } while (validDate(date) == false);

      calcNum();
   }

   boolean validDate(String date)
   {
      // split the string based on white space
      String [] fields = date.split("\\s");

      // must have five fields
      if ( fields.length != 5 )
      {
         return false;
      }

      // must have '/' separators
      if ( ! ( fields[1].equals("/") && fields[3].equals("/") ) )
         return false;

      // must have integer strings
      if ( ! ( Pattern.matches("^\\d*$", fields[0]) && 
               Pattern.matches("^\\d*$", fields[2]) &&
               Pattern.matches("^\\d*$", fields[4]) ) )
         return false;

      // data was good, convert strings to integer 
      // should also check for integer within range at this point
      month = Integer.parseInt(fields[0]);
      day = Integer.parseInt(fields[2]);
      year = Integer.parseInt(fields[4]);

      return true;
   }

   void calcNum() {}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-08T07:56:39.100

这使用 Scanner 方法来解析：

```
import java.util.Scanner;
import java.util.InputMismatchException;

public class TestScanner {

   int month, day, year;
   public static void main(String[] args)
   {
      TestScanner theApp = new TestScanner();   
      theApp.getDate();
      theApp.calcNum();
   }

   public void getDate()
   {
      int fields = 0;
      String delim1 = "";
      String delim2 = "";
      Scanner in = new Scanner(System.in);

      do
      {
         fields = 0;
         System.out.print("Please enter your birth date (mm / dd / yyyy): ");
         while ( fields < 5 && in.hasNext() )
         {
            try {
               fields++;
               switch (fields)
               {
                  case 1:
                     month = in.nextInt();
                     break;
                  case 3:
                     day = in.nextInt();
                     break;
                  case 5:
                     year = in.nextInt();
                     break;
                  case 2:
                     delim1 = in.next();
                     break;
                  case 4:
                     delim2 = in.next();
                     break;
               }
            }
            catch (InputMismatchException e)
            {
               System.out.println("ERROR: Field " + fields + " must be an integer");
               String temp = in.nextLine();
               fields = 6;
               break;
            }
         }
      } while ( fields != 5 || validDate(delim1, delim2) == false);
      in.close();
      System.out.println("Input date: " + month + "/" + day + "/" + year);
   }   

   boolean validDate(String delim1, String delim2)
   {
      if ( ( !  delim1.equals("/") ) || ( ! delim2.equals("/") ) ) 
      {
         System.out.println("ERROR: use '/' as the date delimiter");
         return false;
      }
      if ( month < 1 || month > 12 )  
      {
         System.out.println("Invalid month value: " + month);
         return false;
      }
      if (  day < 1 || day > 31 ) 
      {
         System.out.println("Invalid day value: " + day);
         return false;  
      }
      if (  year < 1 || year > 3000 ) 
      {
         System.out.println("Invalid year: " + year);
         return false;  
      }
      return true;
   }

   void calcNum()
   {

   }

} 
```

# java - 多维 String[][] 数组 java

> ID：13772596
> 
> 赞同：0
> 
> 时间：2012-12-07T23:21:16.180
> 
> 标签：java, arrays

我有一个来自 .split 命令的数组，想将它放入一个名为 String[][] datatabvars 的数组中，我不知道如何将 datatabvars 转换为二维数组并将数据放入其中。

```
public String[] getList() {
    String file_name = "path";
    String[] links = null;
    String[][] datatabvars = null; // this var
    int numberOfDatatabs = 0;
    try {
        ReadFile file = new ReadFile(file_name); 
        String[] aryLines = file.OpenFile();

            int i;
        for(i=0; i < aryLines.length; i++) { //aryLines.length
            if (aryLines[i].substring(0, 7).equals("datatab")) {
                aryLines[i] = aryLines[i].replace("datatab["+Integer.toString(numberOfDatatabs)+"] = new Array(", "");
                aryLines[i] = aryLines[i].replace(");", "");
                datatabvars = aryLines[i].split(","); // this split array
                numberOfDatatabs++;
            }
        }
        System.out.println(datatabvars[0]);
    }catch (IOException e) {
        System.out.println( e.getMessage() );
    }
    return links;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:26:06.683

如下更新两行（我添加了评论）：（我假设您的其余代码正在运行）

```
String[][] datatabvars = null; // this var
int numberOfDatatabs = 0;
try {
    ReadFile file = new ReadFile(file_name); 
    String[] aryLines = file.OpenFile();
    datatabvars = new String[aryLines.length][]; // INITIALIZED

    int i;
    for(i=0; i < aryLines.length; i++) { //aryLines.length
        if (aryLines[i].substring(0, 7).equals("datatab")) {
            aryLines[i] = aryLines[i].
                        replace("datatab["+Integer.toString(numberOfDatatabs)+"] = 
                                               new Array(", "");
            aryLines[i] = aryLines[i].replace(");", "");
            datatabvars[i] = aryLines[i].split(","); // this split array: ASSIGNED
            numberOfDatatabs++;
        }
    }
    System.out.println(datatabvars[0]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:43:32.307

通常，要避免像瘟疫一样避免使用数组-如果可能的话，请使用集合：。在这种情况下，`split()`返回 a `String[]`，所以使用它，但用于`List<String[]>`存储多个`String[]`：

```
List<String[]> datatabvars = new ArrayList<String[]>();
...
String[] array = input.split(",");
datatabvars.add(array); 
```

你会发现使用集合比使用数组更容易。

# python - 按键时跳转到功能

> ID：13772598
> 
> 赞同：3
> 
> 时间：2012-12-07T23:21:24.183
> 
> 标签：python, raspberry-pi, gpio

我为我想要测试的 Raspberry Pi 的 GPIO 制作了一些硬件。我发现了一些简洁的 python 代码，它为 8 个输出创建了 8 个按钮，并让您切换它们的状态。我对 python 几乎一无所知，但我希望能够通过键盘切换 8 个输出（例如数字 1-8）。我不知道如何在不暂停程序流程的情况下要求键盘输入，然后在响应后继续。

如何让数字 1-8 “中断”我的程序并跳转到 8 个相应函数中的 1 个？

我的代码：

```
from Tkinter import *
import RPi.GPIO as GPIO
import time

GPIO.setmode( GPIO.BCM )
GPIO.setup( 4, GPIO.OUT)
GPIO.setup(17, GPIO.OUT)
GPIO.setup(18, GPIO.OUT)
GPIO.setup(21, GPIO.OUT)
GPIO.setup(22, GPIO.OUT)
GPIO.setup(23, GPIO.OUT)
GPIO.setup(24, GPIO.OUT)
GPIO.setup(25, GPIO.OUT)

class App:
    io4=0
    io17=0
    io18=0
    io21=0
    io22=0
    io23=0
    io24=0
    io25=0

    def __init__(self, master):

        frame = Frame(master)
        frame.pack()

        self.p1 = Button(frame, text="GPIO 25",fg="green", command=self.gpio25)
        self.p1.pack(side=LEFT)
        self.p1.grid(row=0,column=0)

        self.p2 = Button(frame, text="GPIO 24",fg="red", command=self.gpio24)
        self.p2.pack(side=LEFT)
        self.p2.grid(row=0,column=1)

        self.p3 = Button(frame, text="GPIO 23",fg="red", command=self.gpio23)
        self.p3.pack(side=LEFT)
        self.p3.grid(row=0,column=2)

        self.p4 = Button(frame, text="GPIO 22",fg="red", command=self.gpio22)
        self.p4.pack(side=LEFT)
        self.p4.grid(row=0,column=3)

        self.p5 = Button(frame, text="GPIO 21",fg="red", command=self.gpio21)
        self.p5.pack(side=LEFT)
        self.p5.grid(row=0,column=4)

        self.p6 = Button(frame, text="GPIO 18",fg="red", command=self.gpio18)
        self.p6.pack(side=LEFT)
        self.p6.grid(row=0,column=5)

        self.p7 = Button(frame, text="GPIO 17",fg="red", command=self.gpio17)
        self.p7.pack(side=LEFT)
        self.p7.grid(row=0,column=6)

        self.p8 = Button(frame, text="GPIO 4", fg="red",command=self.gpio4)
        self.p8.pack(side=LEFT)
        self.p8.grid(row=0,column=7)

    def gpio4(self):
        if self.io4==0:
          GPIO.output(4, GPIO.HIGH)
          self.io4=1
        else:
          GPIO.output(4, GPIO.LOW)
          self.io4=0
        return

    def gpio17(self):
        if self.io17==0:
          GPIO.output(17, GPIO.HIGH)
          self.io17=1
        else:
          GPIO.output(17, GPIO.LOW)
          self.io17=0
        return

    def gpio18(self):
        if self.io18==0:
          GPIO.output(18, GPIO.HIGH)
          self.io18=1
        else:
          GPIO.output(18, GPIO.LOW)
          self.io18=0
        return

    def gpio21(self):
        if self.io21==0:
          GPIO.output(21, GPIO.HIGH)
          self.io21=1
        else:
          GPIO.output(21, GPIO.LOW)
          self.io21=0
        return

    def gpio22(self):
        if self.io22==0:
          GPIO.output(22, GPIO.HIGH)
          self.io22=1
        else:
          GPIO.output(22, GPIO.LOW)
          self.io22=0
        return

    def gpio23(self):
        if self.io23==0:
          GPIO.output(23, GPIO.HIGH)
          self.io23=1
        else:
          GPIO.output(23, GPIO.LOW)
          self.io23=0
        return

    def gpio24(self):
        if self.io24==0:
          GPIO.output(24, GPIO.HIGH)
          self.io24=1
        else:
          GPIO.output(24, GPIO.LOW)
          self.io24=0
        return

    def gpio25(self):
        if self.io25==0:
          GPIO.output(25, GPIO.HIGH)
          self.io25=1
        else:
          GPIO.output(25, GPIO.LOW)
          self.io25=0
        return

    def reserved(self):
        return

root = Tk()
app = App(root)
root.mainloop() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:29:48.380

在方法中添加`master.bind(...)`命令`__init__`：

```
def __init__(self, master):

    frame = Frame(master)
    frame.pack()
    master.bind('1', self.gpio25)
    master.bind('2', self.gpio24)
    master.bind('3', self.gpio23)
    ... 
```

* * *

`master.bind('1', self.gpio25)`将按键`1`事件绑定到方法调用`self.gpio25(event)`。您还需要 7 次`master.bind`调用——每个键调用一次。

接下来，修改回调函数的定义。您需要为`event`每个参数添加第二个参数 , 。改变，例如，

```
def gpio25(self): 
```

至

```
def gpio25(self, event = None): 
```

* * *

**解释：**

当您使用该`bind`方法时，您将 an 绑定`Event`到一个回调函数（例如`self.gpio25`）。按下一个键是一个 KeyPress 事件。有关事件的信息将发送到 Event 对象中的回调。因此回调函数必须接受一个参数。有关更多信息，请参阅[Tkinter 事件和绑定](http://effbot.org/tkinterbook/tkinter-events-and-bindings.htm)。

`Buttons`以不同的方式工作。他们的回调函数用零参数调用。

由于我们使用相同的回调函数，`self.gpio25`作为 Keypress 事件回调和 Button 回调，它必须是一个可以接受零个或一个参数的函数。

在 Python 中，这样做的方法是`gpio25`使用如下调用签名进行定义：

```
def gpio25(self, event = None): 
```

`self`是类的一个实例`App`。`self.gpio25`是一个以`self`bound 作为其第一个参数的绑定方法。所以调用`self.gpio25()`将调用`gpio25`函数`self`作为第一个参数（并且局部变量`event`将被赋值`None`）。调用`self.gpio25(foo)`将`gpio25`with`self`作为第一个参数调用，并`foo`作为第二个参数调用（并且局部变量`event`将被赋值`foo`）。

在您的情况下，分配给的值`event`并不重要，因为`event`没有在`gpio25`. 我们只需要设置`self.gpio25`好接受零个或一个参数。

# c# - 更改按钮单击事件创建指数增加的事件

> ID：13772602
> 
> 赞同：1
> 
> 时间：2012-12-07T23:22:33.140
> 
> 标签：c#, button, onclick

有一个带有开始/停止按钮的简单应用程序，我想根据它的当前状态做不同的事情。如果按钮处于 Start 状态，则执行代码然后更改为停止状态并将 OnClick 事件更改为 StopButton_Click ，反之亦然。

似乎无法更改按钮的单击属性，因此使用下面的代码可以工作，但会不断添加事件的实例。第一次点击执行一次，第二次点击执行两次，第三次执行四次，无限循环。

```
StartButton.Click += new System.EventHandler(StartButton_Click); 
```

交替使用

```
StartButton.Click += new System.EventHandler(StopButton_Click); 
```

有没有办法替换 OnClick 处理程序而不是添加到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:24:34.360

在添加新事件处理程序之前尝试删除事件处理程序：

StartButton.Click -= StartButton_Click;

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T01:33:18.117

一种选择是在添加另一个事件处理程序之前删除以前的事件处理程序，但更简单的选择是只使用单个事件处理程序。事件处理程序可以查看一些内部状态字段来确定要做什么；这可能比不断添加/删除事件处理程序更容易。

它可能看起来像这样：

```
private void buttonClick(object sender, EventArgs args)
{
    if(buttonState == MyStateEnum.Start)
        PerformStartAction();
    else if(buttonState == MyStateEnum.Stop)
        PerformStopAction();
} 
```

然后，无需添加/删除事件处理程序，您只需为`buttonState`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T23:25:58.853

`+=`与事件一起工作，就像它做其他事情一样。它增加了已经存在的东西。

尝试使用 -= 删除现有的事件处理程序，然后添加新的事件处理程序。

# ruby-on-rails - Rails 3] 关于需要一个 Gem

> ID：13772604
> 
> 赞同：0
> 
> 时间：2012-12-07T23:22:39.343
> 
> 标签：ruby-on-rails, require

一个简单的问题：什么时候必须将“require gem_name”放入控制器中？当我探索了很多宝石时，其中一些让我设置了“要求”，而另一些则没有。我需要澄清一下。所有那些告诉我需要宝石的说明都过时了吗？

您能否确认：`gem gem_name`在 Gemfile 中并运行`bundle install`是我需要为所有 gem 做的所有事情，并且`require gem_name`不需要放置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:26:46.873

如果您将所需的 Gem 添加到 Gemfile 并运行`bundle install`，那么您不应该添加`require gem_name`到控制器文件中，Gem 将为您提供。

# java - Java JLabel 数组使用后删除元素

> ID：13772607
> 
> 赞同：1
> 
> 时间：2012-12-07T23:23:28.960
> 
> 标签：java, arrays, netbeans, jlabel

所以我在 Netbeans 中有一个 JFrame，它包含 20 个数学方程式标签。

`mathLabel1`是“2 + 2”

`mathLabel2`是“4 * 4”

ETC...

如果显示了 mathLabel1 并且用户猜到了正确的答案 (4)，那么我想`setVisible(false)`从我的数组中删除该元素，因此它不会再次作为问题出现。

基本上没有重复。

这是我的代码的简短版本：

```
//declare variables
String strUserAnswer;
int i;
Random r = new Random();
int randvalue = r.nextInt(19);
JLabel[] math = {mathLabel1, mathLabel2, mathLabel3, mathLabel4, mathLabel5, mathLabel6, mathLabel7, mathLabel8, mathLabel9, mathLabel10, 
    mathLabel11, mathLabel12, mathLabel13, mathLabel14, mathLabel15, mathLabel16, mathLabel17, mathLabel18, mathLabel19, mathLabel20}; 
JLabel test;    

//method that chooses random math equation
public void random(JLabel test) {
    r = new Random();
    randvalue = r.nextInt(19);
    test = math[randvalue];

    if (test == math[0]) {
        mathLabel1.setVisible(true);
    }
    else if (test == math[1]){
        mathLabel2.setVisible (true);
    }
    else if (test == math[2]){
        mathLabel3.setVisible (true);
    }
    else if (test == math[3]){
        mathLabel4.setVisible (true);
    }
    else if (test == math[4]){
        mathLabel5.setVisible (true);
    }
    else if (test == math[5]){
        mathLabel6.setVisible (true);
    }
    else if (test == math[6]){
        mathLabel7.setVisible (true);
    }
    else if (test == math[7]){
        mathLabel8.setVisible (true);
    }
    else if (test == math[8]){
        mathLabel9.setVisible (true);
    }
    else if (test == math[9]){
        mathLabel10.setVisible (true);
    }
    else if (test == math[10]){
        mathLabel11.setVisible (true);
    }
    else if (test == math[11]){
        mathLabel12.setVisible (true);
    }
    else if (test == math[12]){
        mathLabel13.setVisible (true);
    }
    else if (test == math[13]){
        mathLabel14.setVisible (true);
    }
    else if (test == math[14]){
        mathLabel15.setVisible (true);
    }
    else if (test == math[15]){
        mathLabel16.setVisible (true);
    }
    else if (test == math[16]){
        mathLabel17.setVisible (true);
    }
    else if (test == math[17]){
        mathLabel18.setVisible (true);
    }
    else if (test == math[18]){
        mathLabel19.setVisible (true);
    }
    else if (test == math[19]){
        mathLabel20.setVisible (true);
}
}                                          

private void guessButtonActionPerformed(java.awt.event.ActionEvent evt) {                                            
    // User clicks guess to enter answer, if correct part of puzzle appears

    strUserAnswer = answerText.getText();
    test = math[randvalue];

    //if the math equation chosen is 2+2...
    if (test == math[0]) {

        //show math equation
        mathLabel1.setVisible(true);

        //if answer is right...
        if (strUserAnswer.equals("4")) {
            JOptionPane.showMessageDialog(null, "Yay!! That is right!");
            //show puzzle piece, hide equation, and choose a new one
            label1.setVisible(true);
            mathLabel1.setVisible(false);
            //test.remove(math[0]);
            test = math[randvalue];
            answerText.setText(null);
            random(test);

        //if answer is wrong...
        } else {
            JOptionPane.showMessageDialog(null, " Sorry, try again!");
            answerText.setRequestFocusEnabled(true);
        }
    } 
```

`math[1]`, `math[2]`, , 等重复`math[3]`...

那么我该怎么做呢？我尝试了 remove() 方法，但那是在黑暗中拍摄...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T00:15:47.607

好的，所以这可能会让你开心或伤心，但你用 random() 方法做的事情比你需要做的要多。首先，您似乎不需要接受参数，因为看起来您在使用之前手动更改了该值。另外，因为数组中的每个值实际上都是一个 JLabel，所以你可以只说 math[randValue].setVisible(true) 而不是遍历整个 if 语句。为了解决你删除东西的问题，有一种快速而肮脏的方法可以做到，我将向你展示，但你最好使用 ArrayList 而不是 Array。

```
public void random() {
  Random r = new Random();
  randValue = r.nextInt(math.length);  //make sure the index is always within the array
  JLabel[] temp = new JLabel[math.length - 1];  //this will do the trick
  math[randValue].setVisible(true);
  for (int i = 0; i < randvalue; i++) {
    temp[i] = math[i];  //fill the new array up to the chosen label
  }
  for (int i = randValue; i < temp.length; i++) {
    temp[i] = math[i + 1];  //fill the rest, omitting the chosen label
  }
  math = new JLabel[temp.length];  //math is now shorter
  math = temp;  //put everything back in the original array
} 
```

这应该作为使用数组的解决方案。希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:30:45.823

如果您的数据结构会不断变化，请尝试使用 List 而不是 Array：

```
List<JLabel> labels = new ArrayList<JLabel>();
int numLabels = 20;
for (int i = 0; i < numLabels; i++) {
    labels.add(new JLabel(i + " " + i));
} 
```

从那里您可以随时致电：

```
labels.get(4).setVisible(false); 
```

或者

```
labels.remove(4); 
```

然后重新验证您的 JPanel。

编辑2：

我可能误解了您的问题 - 似乎您想删除一个数字并且不再为它创建标签。这是正确的方法：

```
int numIntegers = 20;
Set<Integer> possibleNumbers = new HashSet<Integer>();
for (int i = 0; i < numIntegers; i++) {
    possibleNumbers.add(i);
} 
```

当您要删除项目时，请使用：

```
possibleNumbers.remove(14); 
```

然后当你想呈现这些数据时，你可以使用：

```
panel.clear();
for (Integer number : possibleNumbers) {
    panel.add(new JLabel(number + "  " + number));
} 
```

（请注意，我不正确地调用 JLabels 数据 - 它们是演示文稿的一部分。）

# java - 第 5 次迭代后，阶乘循环结果不正确

> ID：13772608
> 
> 赞同：4
> 
> 时间：2012-12-07T23:23:34.887
> 
> 标签：java

我目前正在学习预微积分，并认为我会制作一个快速程序，该程序会给我阶乘 10 的结果。在测试它时，我注意到在第 5 次迭代后我得到了不正确的结果。但是，前 4 次迭代是正确的。

```
public class Factorial
{
    public static void main(String[] args)
    {

        int x = 1;
        int factorial;

        for(int n = 10; n!=1; n--)
        {

            factorial = n*(n-1);
            x = x * factorial;
            System.out.printf("%d ", x);

        }

    }//end of class main
}//end of class factorial 
```

![为什么我得到负值](../Images/df30d7f33376a7d278b245eab8d6e7c4.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T23:25:49.163

那是一个[整数溢出](http://en.wikipedia.org/wiki/Integer_overflow)问题。使用`long`or`unsigned long`代替`int`. （正如@Dunes 建议的那样，你最好的选择是`BigInteger`在处理非常大的数字时，因为理论上它永远不会溢出）

基本思想是signed int 存储 之间的数字`-2,147,483,648 to 2,147,483,647`，存储为二进制位（计算机中的所有信息都存储为`1`'s和`0`'s）

正数存储`0`在最高有效位中，负数存储`1`在最高有效位中。如果您的正数在二进制表示中变得太大，则数字将转移到有符号位并将您的正数转换为负数的二进制表示。

然后，当阶乘变得比 an`unsigned int`可以存储的更大时，它将“环绕”并丢失其最高有效（有符号）位的结转 - 这就是为什么您会看到有时在您的输出。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-07T23:26:07.057

您超出了`int`类型 (2,147,483,647) 的容量，因此您的结果将返回到最小值`int`。尝试`long`改用。

话虽如此，您当前使用的方法不会得出正确的答案：*实际上*，您当前正在计算`10! ^ 2`。

为什么要把事情复杂化？你可以很容易地做这样的事情：

```
long x = 1L;

for(int n = 1; n < 10; n++)
{
    x *= n;
    System.out.println(x);
} 
```

```
1
2
6
24
120
720
5040
40320
362880

```

它显示了连续的阶乘，直到`10!`达到。

此外，正如其他人所提到的，如果您需要的值大于`long`可以支持的值，则应该使用[`BigInteger`](http://docs.oracle.com/javase/1.5.0/docs/api/java/math/BigInteger.html)支持任意精度的值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T23:27:28.277

您的阶乘公式不正确。你将拥有的是：

1.  第 1 步：n*(n-1) = 10 * 9 = 90 => x = 1*90 = 90
2.  第 2 步：n*(n-1) = 9 * 8 = 72 => x = 90*72 = 6480 或者，它应该是：10 * 9 * 8 => 720

但是错误的结果来自您达到了其他人指出的 int 类型的最大值这一事实

你的代码应该是

```
public class Factorial
{
    public static void main(String[] args)
    {
        double factorial = 1;

        for(int n = factorial; n>=1; n--)
        {
            factorial = factorial * n;
            System.out.printf("%d ", factorial );

        }
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-07T23:31:36.557

除了其他答案提到的溢出之外，您的阶乘算法也是不正确的。10！应该计算`10*9*8*7*6*5*4*3*2*1`，你在做`(10*9)*(9*8)*(8*7)*(7*6)*...`

尝试将循环更改为以下内容：

```
int x = 1;
for(int n = 10; n > 1 ; n--)
{
    x = x * n;
    System.out.printf("%d ", x);
} 
```

如果您尝试计算更高数字的阶乘，您最终会溢出，但`int`足够大以计算 10 的阶乘。

# scilab - exec 命令的 Scilab 问题

> ID：13772610
> 
> 赞同：5
> 
> 时间：2012-12-07T23:23:44.357
> 
> 标签：scilab

我正在使用 Scinote 5.4.0 和 OSX 10.7.4。我无法使用`exec("path")`命令从控制台执行脚本文件；当我这样做时，只会读取脚本文件的第一行。

例子：

```
-->exec("plot1.sce") 
-->x=[0:.1:10]'; //(the first line of my code) 
```

但是，如果我从编辑器 Scinote 中“使用 echo 执行”，则脚本将运行得很好。

有人知道发生了什么吗？（我试图运行的脚本文件在我当前的工作目录中）。

谢谢！

更新：我刚刚在同一台机器上安装了 Scilab，同样的事情正在发生。

更新：根据 Scilab 的 bugtracker，它似乎是由 Mac 上的 Scinote 默认为 cr eol 引起的。我真的不知道这意味着什么或如何解决它，但冒险仍在继续！

更新：我找到了解决方案！： http: [//comments.gmane.org/gmane.comp.mathematics.scilab.user/6184](http://comments.gmane.org/gmane.comp.mathematics.scilab.user/6184)

在首选项中，我将 eol 更改为 Unix，并将默认文件编码更改为 iso-8859-1。我重新启动并且 exec 现在正在工作！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-28T10:01:30.490

该链接不容易遵循，因此这是答案（已粘贴）

> 问题实际上是 scinote 的，而不是 scilab 的。我没有 Lion 机器来检查我是否正确，但似乎 scinote 的文件编码在 ML 中不再兼容。我发现当我使用不同的文本编辑器 (vi) 打开 scinote 生成的文件时，新行的编码不适合我的机器。另一个好处是执行升级之前编写的脚本运行良好。
> 
> 转到首选项并在 scinotes 选项卡中，将默认文件编码切换为 iso-8859-1。我还将行尾切换到 Unix。

# java - 如何在 Java 类中维护指向 List 的指针？

> ID：13772614
> 
> 赞同：0
> 
> 时间：2012-12-07T23:24:26.350
> 
> 标签：java, list

我有一个非常简单的 Java 类：

```
public class Party {
    private List<String> hosts = new ArrayList<String>();
    private String headHost = null;

    public void addHost(String name) {
        hosts.add(name);
        headHost = name;
    }
} 
```

但是维护一个跟踪列表指针的字符串似乎有点愚蠢......

**1\. 有没有更好的方法来追踪谁是“主播”？**

它也不会总是最后一个添加的人：

```
public void setHost(int i) {
    headHost = hosts.get(i); // potentially throws an exception based on i
}

public void setHost(String name) {
    headHost = name;
} 
```

**2\. 改变当前的“头部宿主”最好的方法是什么？这两种方法都可能采用不正确的参数。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:36:09.107

当前版本刚刚好。如果您担心异常，可以对代码应用一些防御性编程：

```
public void setHost(int i) {
    if(i < 0 || i > hosts.size()-1){
         throw new IllegalArgumentException("Index is out of range!");
    }
    headHost = hosts.get(i);
}

public void setHost(String name) {
    if(!hosts.contains(name){
         throw new IllegalArgumentException("The specified host does not exist.");
    }
    headHost = name;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:32:47.243

`List` **没有 current 的概念**，至少在 Java 中没有。如果您想知道第一个元素是什么，只需使用`List.get(0)`

要获取最后一个元素，请使用`hosts.get(hosts.size()-1)`.

您可能还对该类感兴趣，[`Stack`](http://docs.oracle.com/javase/6/docs/api/java/util/Stack.html)该类具有**LIFO**（后进先出）方法，可以更轻松地获取最近输入的元素。

如果出于某种原因您希望能够查找 a `host`by `String name`，请不要使用 a `List`，使用 a `Map`（最好是 a [`HashMap`](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T23:39:34.043

您所在的区域已经只持有一个指针。字符串是java中的对象。

当你这样做时：

```
public void addHost(String name) {
    hosts.add(name);
    headHost = name;
} 
```

只有一个字符串带有两个指向它的指针，一个在列表中，一个在实例变量 headHost 中。实际数据没有两个副本。

# python - 构建 LLVM 失败并显示空错误消息

> ID：13772617
> 
> 赞同：4
> 
> 时间：2012-12-07T23:24:54.373
> 
> 标签：python, windows, cmake, llvm, clang

我正在尝试构建 LLVM 3.1 和 Clang 3.1。[我遵循了Clang 网站上](http://clang.llvm.org/get_started.html)的入门指南——在必要的地方查看存储库，获取 Python 等。

如果我安装了 Python 3.3，它会给出 Python 语义错误`from main import main`-，没有调用模块`main`。如果我安装了 Python 2.7，它会给

```
CMake Error at CMakeLists.txt:307 (message):
  Unexpected failure executing llvm-build:
Configuring incomplete, errors occurred! 
```

这是最无益的。关于我可以在 Windows 上构建 LLVM 和 Clang 的任何建议，或者至少尝试确定问题所在？

请注意，我正在尝试使用 Visual Studio 2012 进行构建，它由 CMake 正式支持，但在创建 LLVM 3.1 和 Clang 3.1 时并未发布。

编辑：以下是 CMakeLists.txt 中的必要行

```
message(STATUS "Constructing LLVMBuild project information")
execute_process(
  COMMAND ${PYTHON_EXECUTABLE} ${LLVMBUILDTOOL}
            --native-target "${LLVM_NATIVE_ARCH}"
            --enable-targets "${LLVM_TARGETS_TO_BUILD}"
            --enable-optional-components "${LLVMOPTIONALCOMPONENTS}"
            --write-library-table ${LLVMCONFIGLIBRARYDEPENDENCIESINC}
            --write-cmake-fragment ${LLVMBUILDCMAKEFRAG}
            ERROR_VARIABLE LLVMBUILDOUTPUT
            ERROR_VARIABLE LLVMBUILDERRORS
            OUTPUT_STRIP_TRAILING_WHITESPACE
            ERROR_STRIP_TRAILING_WHITESPACE
  RESULT_VARIABLE LLVMBUILDRESULT)

# On Win32, CMake doesn't properly handle piping the default output/error
# streams into the GUI console. So, we explicitly catch and report them.
if( NOT "${LLVMBUILDOUTPUT}" STREQUAL "")
  message(STATUS "llvm-build output: ${LLVMBUILDOUTPUT}")
endif()
if( NOT "${LLVMBUILDRESULT}" STREQUAL "0" )
  message(FATAL_ERROR
    "Unexpected failure executing llvm-build: ${LLVMBUILDERRORS}")
endif() 
```

在这里，您可以看到`${LLVMBUILDRESULT}`并不好，但`${LLVMBUILDERRORS}`显然应该包含构建错误不包含任何内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-10T00:43:50.497

问题有两个方面：

首先，LLVM 需要 Python 2.x。如果你试图强制它使用 3.3，它会失败。文档可能应该对此有所说明（当我查看时找不到任何参考），但在这个阶段，项目只说“Python”或“Python 2.6+”仍然很常见它们的意思是“2.6-2.7 但不是 3.x”。

其次，与大多数配置/构建工具一样，CMake 仅检测代码中的依赖项更改，而不是您的系统配置中的更改。因此，如果您尝试构建，然后更改系统，然后再次尝试构建，它不会注意到更改并相应地调整其配置。它已经配置为使用 Python 3.3，但它没有注意到您已将其替换为 Python 2.7，因此出现了问题。你必须强制它重新配置——你可以通过清除缓存来做到这一点，但最简单和最干净的答案是解压/git/whatever你自己一个干净的目录并重新开始。（或者，如果您可以像许多项目一样在树外构建，只需清除构建目录并重新开始。）

最后，根据文档，你真的不需要 Python 来构建 llvm 和 clang，除非你想运行测试。所以，除非文档是错误的（这当然是可能的），如果你刚刚完成了一个完全没有 Python 的干净构建，它会工作的。试了没用的原因和你安装2.7后没用的原因是一样的：你是部分配置的状态，它以为有Python，所以坚持用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-28T21:42:06.520

我用过类似的东西

```
"c:\Program Files (x86)\CMake\bin\cmake.exe" -G "Visual Studio 12 2013" -DPYTHON_EXECUTABLE="C:\Python27\python27.exe" -DLLVM_TARGETS_TO_BUILD="X86" ..\llvm-3.5.0.src 
```

它对我有用。在我的情况下，cmake 没有找到 python，所以我不得不使用

```
-DPYTHON_EXECUTABLE="C:\Python27\python27.exe" 
```

请注意，我没有覆盖我的系统文件夹，那么遇到相同问题的人应该为命令的每个文件夹使用不同的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T19:06:43.937

显然，这主要是 CMake 失败，如果我在安装 Python 2.7 后清除缓存，它会成功

# sql - 具有 14 天间隔的日期过滤器的 SQL 查询

> ID：13772621
> 
> 赞同：1
> 
> 时间：2012-12-07T23:25:10.647
> 
> 标签：sql, intervals

我正在尝试过滤`payroll dates`结果将在哪里显示“2011-12-25”以及之后每 14 天`up until today`。

我的查询是：

```
 SELECT trxbegdt FROM UPR30300
    WHERE TRXBEGDT <= getdate() and trxbegdt >= DATEADD( DAY ,14, '2011-12-25')
    group by trxbegdt
    order by TRXBEGDT desc 
```

我遇到的问题是结果显示的日期超出了 14 天的间隔，这不是正常的工资单交易开始日期。有人有解决方案来遵守我的条件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:38:36.007

这个怎么样？这使用递归 CTE 创建有效工资单日期列表，然后将其连接到真实表......

```
WITH PayrollDates AS
(
  SELECT CONVERT(datetime,'2011-12-25') AS PayrollDate
  UNION ALL
  SELECT DATEADD(DAY,14,PayrollDate) AS PayrollDate
  FROM PayrollDates
  WHERE DATEADD(DAY,14,PayrollDate) <= GETDATE()
)
SELECT 
  UPR30300.trxbegdt 
FROM UPR30300
INNER JOIN PayrollDates
ON UPR30300.trxbegdt = PayrollDates.PayrollDate 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:30:50.417

~~SELECT trxbegdt FROM UPR30300 as a where trxbegdt + 间隔 14 天 = b.trxbegdt (SELECT trxbegdt FROM UPR30300 WHERE TRXBEGDT <= sysdate() and trxbegdt >= '2011-12-25' ) 由 TRXBEGDT desc 订购~~

 ~~您可以使用一些变体来获得具有此恒定间隔的滚动日期。例如

*   `Datediff(day,a.trxbegdt,b.trxbegdt) = 14`
*   `dateadd(b.trxbegdt,14,day)= a.trbegdt`

~~PS：在手机中格式化答案非常痛苦。此外，代码是基于逻辑的，因此请在您的最后运行以查看结果并评论进一步更新。~~

*   # 使用嵌套查询生成具有恒定间隔的日期列表的替代答案。

    *   [MYSQL 的 SQLFIDDLE 演示](http://sqlfiddle.com/#!2/1e031/5)

**查询以生成从今天到您指定日期之间的日期列表，间隔为 14 天**

```
set @i:= 0;

SELECT date_format(DATE(ADDDATE('2012-10-05', 
INTERVAL @i:=@i+14 DAY)),'%Y-%m-%d')
AS dateP, @i
FROM payroll
HAVING @i < datediff(now(), date '2012-10-05')
; 
```

**以上查询输出**

```
DATEP         @IntervalDays
2012-10-19    14
2012-11-02    28
2012-11-16    42
2012-11-30    56
2012-12-14    70 
```

***应该获取*记录的最终查询**

```
set @i:= 0;

SELECT distinct datestamp FROM payroll
WHERE date(datestamp) in (
SELECT DATE(ADDDATE('2012-10-05', 
INTERVAL @i:=@i+14 DAY) ) AS dateP
FROM payroll
where @i < DATEDIFF(now(), date '2012-10-05') 
)
; 
```

*然而，由于某些 MYSQL 引擎*的行为，它没有获取记录，迄今为止比较无知。所以我想现在，你最好用上面的答案。我想用信息更新这篇文章，以分享知识。

随意评论:)

* * *

*   ## 解决上述变量范围后的更新。

至于调查结果，**在安装了 mysql 的本地机器上，**通过将`in`子句替换为`inner join`. 但是它仍然不能在 SQLFIDDLE 中使用。所以解决方法是在嵌套`select`查询中删除变量。进一步`IN`的条款似乎也不能很好地工作。无论如何，`inner join`胜过`in`条款。所以最终的解决方案如下。:)

*   [SQL 演示参考](http://sqlfiddle.com/#!2/80dff/1)- 已更新。

询问：

```
select p.id, p.datestamp, s.datep from
Payroll as p
inner join 
(
SELECT DATE(DATE_ADD('2012-10-05', 
INTERVAL @i:=@i+14 DAY) ) AS dateP
FROM Payroll, (SELECT @i:=0) r
where @i < DATEDIFF(now(), date '2012-10-05') 
) as s 
on p.datestamp = s.dateP
; 
```

结果：

```
ID  DATESTAMP                           DATEP
7   October, 19 2012 00:00:00+0000      October, 19 2012 00:00:00+0000
8   November, 02 2012 00:00:00+0000     November, 02 2012 00:00:00+0000
10  November, 16 2012 00:00:00+0000     November, 16 2012 00:00:00+0000
12  November, 30 2012 00:00:00+0000     November, 30 2012 00:00:00+0000 
```~~

# excel - 使用 PROC IMPORT 创建 SAS 数据集后对其进行修改

> ID：13772622
> 
> 赞同：1
> 
> 时间：2012-12-07T23:25:12.317
> 
> 标签：excel, input, dataset, sas

我有一个这样的数据集

```
Obs MinNo EurNo MinLav EurLav 
1   103    15.9    92    21.9 
2    68    18.5   126    18.5 
3    79    15.9   114    22.3 
```

我的目标是从上面的数据集中创建一个这样的数据集：

```
Obs Min    Eur     Lav 
1   103    15.9    No    
2    92    21.9    Yes     
3    68    18.5    No    
4   126    18.5    Yes
5    79    15.9    No
6   114    22.3    Yes 
```

基本上，我将 4 列附加到 2 列中 + 一个分类，指示它们来自哪一组 2 列

这是我到目前为止所拥有的

```
PROC IMPORT DATAFILE='f:\data\order_effect.xls' DBMS=XLS OUT=orderEffect;
RUN;

DATA temp;
INFILE orderEffect;
INPUT minutes euros @@;
IF MOD(_N_,2)^=0 THEN lav='Yes';
ELSE lav='No';
RUN; 
```

我的问题是如何导入 Excel 表，然后修改它创建的 SAS 数据集，以便我可以将后两列推到前两列下方，并根据其中的列添加第三列？

我知道如何通过将数据集分成两个数据集然后将一个附加到另一个数据集来做到这一点，但是使用上面的模式功能会快得多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:02:31.247

你非常接近，但误解了什么`PROC IMPORT`。

完成`PROC EXPORT`后，它将创建一个名为 SAS 数据集`orderEffect`，其中包含来自工作表中列的 SAS 变量。你只需要做一个小数据步骤程序就可以得到你想要的结果。试试这个：

```
data want;

   /* Define the SAS variables you want to keep */
   format Min 8\. Eur 8.1;
   length Lav $3;
   keep Min Eur Lav;

   set orderEffect;

   Min = MinNo;
   Eur = EurNo;
   Lav = 'No';
   output;

   Min = MinLav;
   Eur = EurLav;
   Lav = 'Yes';
   output;
run; 
```

这假定该`PROC IMPORT`步骤创建了具有这些名称的数据集。首先运行该步骤以确保并在必要时修改程序。

# arraylist - 从 Jtextfield 将数字添加到数组列表

> ID：13772628
> 
> 赞同：0
> 
> 时间：2012-12-07T23:25:42.393
> 
> 标签：arraylist, jtextfield

我确信它非常简单，但这是我的第一个 java 类。用户在输入 Jtextfield 中输入一个数字。添加按钮应该将该数字添加到数组列表中。我很难弄清楚如何做到这一点。你能给我的任何帮助都会很棒

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.util.ArrayList;

public class ArrayExercise extends JFrame
{

private final int WINDOW_WIDTH = 300;
private final int WINDOW_HEIGHT = 300;

private JPanel panel1;
private JPanel panel2;

private JLabel messageLabel;

private JTextField input;
private JTextArea output;

private JButton addButton;
private JButton list;
private JButton rlist;
private JButton clear;

public ArrayExercise()
{
setTitle("Array Exercise");

setSize(WINDOW_WIDTH, WINDOW_HEIGHT);

setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

setLayout(new BorderLayout());

panel1();
panel2();

add(panel1, BorderLayout.EAST);
add(panel2, BorderLayout.WEST);

setVisible(true);
input.requestFocus();
}
private void panel1()
{
messageLabel = new JLabel("Input");
input = new JTextField(5);
addButton = new JButton("Add");
list = new JButton("List");
rlist = new JButton("R-List");
clear = new JButton("Clear");

addButton.addActionListener(new ButtonListener());
list.addActionListener(new ButtonListener());
rlist.addActionListener(new ButtonListener());
clear.addActionListener(new ButtonListener());

    panel1 = new JPanel();
    panel1.setLayout(new GridLayout(6,1));

panel1.add(messageLabel);
panel1.add(input);
panel1.add(addButton);
panel1.add(list);
panel1.add(rlist);
panel1.add(clear);
}
private void panel2()
{
output = new JTextArea(12, 10);

panel2 = new JPanel();

panel2.add(output);
}
    private class ButtonListener implements ActionListener
{

    public void actionPerformed(ActionEvent e)
    {   
    String in;
    int number;
    int index = 0;
    ArrayList<String> list = new ArrayList<>();             

    String actionCommand = e.getActionCommand();

    if (actionCommand.equals("Add"))
    {
    index++;
    in = addButton.getText();
    list.add(addButton.getText());
    if (index == 9)
            {
            input.setEditable(false);
            addButton.setEnabled(false); 
            }

    output.setText(in + " added.");
    input.setText(null);
    input.requestFocus();

    }       
    if (actionCommand.equals("List"))
    {
    for(int x = 0; x <= list.size(); x++)
    {
    output.setText((x+1)+ ".  " + list.get(x) + "\n");
    }
    }
}
}
public static void main(String[] args)
{
new ArrayExercise();
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:56:26.473

您有 ArrayList 列表，它没有向该列表添加任何字符串值，并且您正在尝试运行该循环以获取值。如果您没有在列表中添加任何内容，那么您如何从中提取任何内容。

```
 ArrayList<String> list = new ArrayList<String>(); 
```

对于每个按钮附加不同的动作侦听器，因为所有按钮不应该以相同的方式运行。

要在 ArrayList 中添加元素，请使用此

```
 list.add(input.getText()); // adding text entered into input textfield. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-08T19:59:26.957

*   做一个列表
*   项目清单
*   制作一个文本字段
*   使按钮添加侦听器到按钮
*   从文本字段或文本区域获取文本添加到数组列表对象

这是您需要做的所有工作：

```
ArrayList<String> arrayObject= new ArrayList<String>();
JButton button = new JButton();
JtextField textBox = new JtextField ();

  button.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent e) {
          //inside your action listener:
             String add_item_to_array = textBox.getText().trim();
             arrayObject.add(add_item_to_array);

        }
    }); 
```

# c# - 如何使用 C# 读取另一个程序的输出？

> ID：13772633
> 
> 赞同：-2
> 
> 时间：2012-12-07T23:25:56.917
> 
> 标签：c#, console

我想从一个名为 Testing.exe 的程序中获取输出，然后使用另一个程序打印它。

Testing.exe 的输出如下。

> 印刷数量：7
> 
> 印刷数量：7

代码如下：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Testing
{
    class Program
    {
        static int printNumber(int numberToPrint)
        {
            numberToPrint = 7;
            Console.WriteLine("Printing number: " + numberToPrint.ToString());
            return numberToPrint;
        }

        static void Main(string[] args)
        {
            int number = 5;
            number = printNumber(number);
            Console.WriteLine("Printing number: " + number.ToString());
            Console.ReadKey();
        }
    }
} 
```

据说我可以使用 Process 类和 RedirectStandardOutput，但我不知道如何使用它们......

如何获取上面的输出，并从另一个应用程序打印它？我正在尝试从控制台应用程序中获取输入并将其放入另一个应用程序中。

我刚开始学习编程，所以我迷路了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:28:53.707

```
 // Start the child process.
 Process p = new Process();
 // Redirect the output stream of the child process.
 p.StartInfo.UseShellExecute = false;
 p.StartInfo.RedirectStandardOutput = true;
 p.StartInfo.FileName = "Write500Lines.exe";
 p.Start();
 // Do not wait for the child process to exit before
 // reading to the end of its redirected stream.
 // p.WaitForExit();
 // Read the output stream first and then wait.
 string output = p.StandardOutput.ReadToEnd();
 p.WaitForExit(); 
```

[http://msdn.microsoft.com/en-us/library/system.diagnostics.process.standardoutput.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.standardoutput.aspx)

# javascript - jQuery旋转在ie中不起作用

> ID：13772640
> 
> 赞同：1
> 
> 时间：2012-12-07T23:26:47.247
> 
> 标签：javascript, jquery, internet-explorer, rotation

大家好，我有一些代码可以旋转 div 并使其向上移动。它适用于除 IE 之外的所有浏览器。任何帮助都会很棒。

```
 function rotate(degree) {
    $elie.css({
        '-webkit-transform': 'rotate(' + degree + 'deg)',
        '-moz-transform': 'rotate(' + degree + 'deg)',
        '-o-transform': 'rotate(' + degree + 'deg)',
        '-ms-transform': 'rotate(' + degree + 'deg)',
        'transform': 'rotate(' + degree + 'deg)'
    });
    console.log(degree);
    if (degree < 55) {
        timer = setTimeout(function() {
            rotate(++degree)
        }, 10)
}; 
```

};

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:06:20.743

您在问题中提供的代码*应该*在 IE9 中工作。

我能想到它不起作用的唯一原因是您的 IE9 实际上是在 IE8 兼容模式下呈现的。

这实际上是一个很常见的问题（特别是对于开发人员，因为 IE 默认为本地网络上的站点提供兼容模式，这通常包括您的开发服务器）。

要检查，请打开开发工具菜单 (F12)，然后查看右上角；它应该向您显示浏览器模式。如果它说的不是“IE9 标准”，那么你需要更正它。这个恼人的默认设置可以如下关闭：

*   选择“工具”菜单，
*   选择兼容性视图设置。
*   取消勾选激活兼容模式的选项。

您可能还想在页面中添加元标记以强制 IE 对其他用户使用标准模式：

```
<meta http-equiv="X-UA-Compatible" content="IE=Edge"/> 
```

有了这些措施，您的页面应该以 IE9 标准模式呈现，然后您应该能够使用标准 CSS 旋转。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:32:36.683

你能告诉你使用的是什么IE浏览器版本吗？您的代码应该适用于 IE9，尝试在您的 css 中为其他版本的 IE 添加此代码：

```
filter: progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', M11=0.7071067811865476, M12=-0.7071067811865475, M21=0.7071067811865475, M22=0.7071067811865476); /* IE6,IE7 */
-ms-filter: "progid:DXImageTransform.Microsoft.Matrix(SizingMethod='auto expand', M11=0.7071067811865476, M12=-0.7071067811865475, M21=0.7071067811865475, M22=0.7071067811865476)"; /* IE8 */ 
```

所以你的代码应该如下所示：

```
 function rotate(degree) {
    $elie.css({
        '-webkit-transform': 'rotate(' + degree + 'deg)',
        '-moz-transform': 'rotate(' + degree + 'deg)',
        '-o-transform': 'rotate(' + degree + 'deg)',
        '-ms-transform': 'rotate(' + degree + 'deg)',
        'transform': 'rotate(' + degree + 'deg)',
        'filter': 'progid:DXImageTransform.Microsoft.Matrix(sizingMethod="auto expand", M11=0.7071067811865476, M12=-0.7071067811865475, M21=0.7071067811865475, M22=0.7071067811865476)', /* IE7  Note this is the code for 45 degree */
        '-ms-filter': "progid:DXImageTransform.Microsoft.Matrix(SizingMethod='auto expand', M11=0.7071067811865476, M12=-0.7071067811865475, M21=0.7071067811865475, M22=0.7071067811865476)"; /* IE8  Note this is the code for 45 degree  */
    });
    console.log(degree);
    if (degree < 55) {
        timer = setTimeout(function() {
            rotate(++degree)
        }, 10)
}; 
```

参考 ：

[CSS3 变换：旋转；在 IE9 中](https://stackoverflow.com/questions/4865167/css3-transform-rotate-in-ie9)

[IE中的CSS旋转属性](https://stackoverflow.com/questions/4617220/css-rotate-property-in-ie)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T23:32:51.727

尝试

```
if($.browser.msie){
    $elie.css({ msTransform: 'rotate(' + degree + 'deg)' });
}else{
    $elie.css({
        '-webkit-transform': 'rotate(' + degree + 'deg)',
        '-moz-transform': 'rotate(' + degree + 'deg)',
        '-o-transform': 'rotate(' + degree + 'deg)',
        '-ms-transform': 'rotate(' + degree + 'deg)'
    });
} 
```

# java - 一个 JPanel 中的单击事件会更新另一个 JPanel

> ID：13772641
> 
> 赞同：2
> 
> 时间：2012-12-07T23:26:49.243
> 
> 标签：java, swing

我有 2 `JPanels`，每个都有自己的类扩展`Jpanel`每个都在一个`jDialog`. 我在其中一个类中放置了一个点击事件，然后在点击发生的位置获取颜色。现在我怎么能告诉第二个`JPanel`重新粉刷自己？

我的 jDialog 中的构造函数：

```
public ColorPickerDialog(java.awt.Frame parent, boolean modal){
    super(parent, modal);
    initComponents();

    cpp = new ColorPicker();
    cpp.setBounds(5, 5, 300, 300);
    cpp.setVisible(true);
    cpp.setOpaque(true);
    cpp.setBorder(BorderFactory.createBevelBorder(BevelBorder.LOWERED));
    add(cpp);

    // Click event is in this class:
    ColorSlider colorSlide = new ColorSlider();
    colorSlide.setBounds(315, 5, 20, 300);
    colorSlide.setVisible(true);
    colorSlide.setOpaque(true);
    colorSlide.setBorder(BorderFactory.createBevelBorder(BevelBorder.LOWERED));
    add(colorSlide);
} 
```

我的点击事件：

```
public void mouseClick(MouseEvent evt){
    Point pt = evt.getPoint();

    BufferedImage img = (BufferedImage)this.createImage(getWidth(), getHeight());
    int[] colors = new int[3];
    img.getRaster().getPixel(evt.getX(), evt.getY(), colors);
    ColorPickerDialog.sldColor = new Color(colors[0], colors[1], colors[2]);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:34:04.840

其中一个 JPanel 可以是 Observer，另一个可以是 Observable。然后，当您需要更新时，您只需调用：

```
setChanged();
notifyObservers(); 
```

在您的 Observable JPanel 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T23:31:55.480

为您的项目使用工厂模式。创建或启动 2nd`JPanel`时，将其添加到包含对象实例的工厂。进入 `mouseClick`，从工厂调用您的第二个面板并实施：`panel.repaint();`

一些例子：

```
 public void mouseClick(MouseEvent evt){
....
 SecondPanel panel = PanelFactory.loadPanel(2);

    panel.revalidate();
    panel.repaint();    
    ....

}

public class PanelFactory{

  private static PanelFactory instance = new PanelFactory();  

  private JPanel mSomePanel = null;

  public static void storePanel(JPanel panel){
     instance.mSomePanel = panel;
  }

   public static JPanel loadPanel(int index){
     ......
     return instance.mSomePanel;

    }
} 
```

# javascript - 通过 Javascript (KeywordScript) 设置 ID

> ID：13772643
> 
> 赞同：0
> 
> 时间：2012-12-07T23:26:59.117
> 
> 标签：javascript, html, search, keyword

我正在为学校做这项作业，但在我找不到的地方有一个逻辑。我几乎 100% 确定它`setElemId()`是应该设置和返回元素 id 的函数，但它一直没有返回任何内容，当我`href`为快速链接设置时，它只是设置`#`而不是`ID`.

**HTML**

```
<body>
   <div id="page">
      <div id="logo"><img src="hlogo.jpg" alt="Historic Documents" /></div>
      <div id="logosub">Department of History<br />Midwest University</div>

      <div id="doc">
         <h1 id="doctitle">The Federalist Papers <br />No. 10</h1>
         <p id="docsubtitle">The Union as a Safeguard Against 
            Domestic Faction and Insurrection<br />From the New York Packet. Friday, 
            November 23, 1787.</p>

         <p id="intro">To the people of the state of New York:</p>

         <p id="firstp">Among the numerous advantages promised by a well-constructed 
            Union, none deserves to be more accurately developed than its 
            tendency to break and control the violence of faction. The friend of 
            distresses under which we labor have been erroneously charged on the 
         </p>

         <p>By a <dfn id="firstkey">faction</dfn>, I understand a number of 
            citizens, whether amounting to a majority or a minority of the whole, 
            interest, adversed to the rights of other citizens, or to the permanent 
            and aggregate interests of the community.</p>

         <p>The other point of difference is, the greater number of citizens and 
            extent of territory which may be brought within the compass of 
            the former than in the latter. The smaller the society, the fewer 
         </p>

      </div>
   </div>
</body>
</html> 
```

**Javascript**

```
function addEvent(object, evName, fnName, cap) {
   if (object.attachEvent)
       object.attachEvent("on" + evName, fnName);
   else if (object.addEventListener)
       object.addEventListener(evName, fnName, cap);
}

addEvent(window, "load", makeKeyWordBox, false);

// Returns an array of Text
function makeElemList(elem)
{
    var elemList = document.getElementsByTagName('dfn');
    var elemTextArr = new Array();

    for(var i = 0; i < elemList.length; i++)
        elemTextArr[i] = elemList[i].innerText.toLowerCase();

    elemTextArr.sort();
    return elemTextArr;
}

// Searches for and returns a single ID
function setElemId(elem, elemText)
{
    var elemList = document.getElementsByTagName(elem);
    var elemTextArr = new Array();
    var elemId;

    for(var i = 0; i < elemList.length; i++)
    {
        elemTextArr[i] = elemList[i].innerText.toLowerCase();

        if(elemTextArr[i] == elemText)
        {
            if(elemList[i].id = null)
            {
                elemId = elemText + i;
                elemList[i].setAttribute('id', elemId);
                return elemId;
            }
            else
            {
                alert(elemList[i].id);
                elemId = elemList[i].id;
                return elemId;
            }
        }
    }
}

function makeKeyWordBox()
{
    var keywords = makeElemList('dfn');
    var historyDoc = document.getElementById('doc');
    var keywordBoxTitle = document.createElement('h1');
        keywordBoxTitle.innerText = "Keywords";
    var keywordBox = document.createElement('div');
        keywordBox.id = "keywords";
        keywordBox.appendChild(keywordBoxTitle);
    var ulList = document.createElement('ul');
        keywordBox.appendChild(ulList);

    for(var i = 0; i < keywords.length; i++)
    {
        var linkId = setElemId('dfn', keywords[i]);
        var newListItem = document.createElement('li');
        var newLink = document.createElement('a');
            newLink.innerText = keywords[i];
            newLink.href = "#" + linkId;
        newListItem.appendChild(newLink);
        ulList.appendChild(newListItem);
    }

    historyDoc.insertBefore(keywordBox, historyDoc.firstChild);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:37:02.433

您似乎正在搜索关键字的完全匹配。由于您的所有元素都不包含您要查找的关键字（而是包含文本），因此没有匹配项。

相反，尝试`if( elemTextArr[i].indexOf(elemText) > -1)`

所以请注意，您似乎没有将搜索词转换为小写，所以如果我输入大写字母，我将不会得到任何匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T05:36:33.227

> *“它会命中 if 语句，但它要么 a) 总是为 false (就像它已经设置了一个 ID)”*

尝试改变：

```
if(elemList[i].id = null) 
```

到：

```
if(!elemList[i].id) 
```

您正在分配`id`to`null`而不是将其与`null`（您在使用or`=`时使用）进行比较，然后 the会将其评估为（falsy）并每次都进入案例。`==``===``if``null``else`

`null`另外，我认为您无论如何都不想与之进行比较，因为`id`未设置的将不会`null`（当我尝试时，未设置`id`的是空字符串，`""`）。更容易使用`!`运算符来测试是否`id`“虚假”。

# asp.net-mvc - 在 asp.net mvc razor 循环中为行替换颜色

> ID：13772652
> 
> 赞同：0
> 
> 时间：2012-12-07T23:28:08.433
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, html-table

我正在尝试使用 asp.net Mvc3 razor 列表填充数据表，并且我还尝试添加具有交替行颜色的 CSS。有人可以在这部分帮助我吗？只是帮助我在循环中应用 d0 类和 d1 类。

```
<style>
    tr.d0 td {
        background-color: #CC9999;
        color: black;
    }

    tr.d1 td {
        background-color: #9999CC;
        color: black;
    }
</style>

 <table width="100%">
        <tr>
            <th>Name</th>
            <th>Address</th>
            <th>Phone</th>
            <th>Details</th>
        </tr>

        @foreach (var item in Model.Info)
        {     
            <tr>

                <td><span>@item.Name</span></td>
                <td><span>@item.Address</span></td>
                <td><span>@item.Phone</span></td>
                <td><span>@item.Details</span></td>

             </tr>
        }
    </table> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T06:16:43.123

使用普通的 for 循环 -

（未经测试）

```
@for (int i = 0; i < Model.Info.Count; i++) {
  <tr class= @(i%2 ==0 ? "d0" : "d1")>
      <td><span>@Model.Info[i].Name</span></td>
       .....
  </tr>
} 
```

由于这是一个样式问题而不是渲染内容，那么在奇偶行上使用 jquery 怎么样？

```
$(document).ready(function () {
    $("table tr:odd").addClass("className"); //make use of more specific css selector
   //likewise for even rows
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-07T06:36:24.903

尝试这个

**CSS**

```
.generalAltRow {
    background-color:#EFF8FF;
}

.generalRow {
    background-color:white;
}

    @{
        int i=0;
    }
    @foreach (var item in Model.Info)
    {     
        i = i+1;
        string rowColor;
        if (i % 2 == 0)
        {
            rowColor = "generalAltRow";
        }
        else {
            rowColor = "generalRow";
        }

         <tr class="@rowColor">
            <td><span>@item.Name</span></td>
            <td><span>@item.Address</span></td>
            <td><span>@item.Phone</span></td>
            <td><span>@item.Details</span></td>

         </tr>
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T11:15:56.063

```
$(document).ready(function () {
    $('table tr:not(.Header):even').addClass('d0');

    $('table tr:not(.Header):odd').addClass("d1");
}); 
```

用于[演示](http://jsfiddle.net/nanoquantumtech/MS3b5/)

# redirect - Ubuntu 上的 KVM：端口转发到来宾 VM

> ID：13772653
> 
> 赞同：4
> 
> 时间：2012-12-07T23:28:10.010
> 
> 标签：redirect, ssh, ubuntu-12.04, kvm

我安装了 kvm 并使用 vmbuilder 在服务器上设置了几个客人。这是以下配置：

```
server host1 (xxx.xxx.xxx.xxx) ->  guest vm1 (192.168.122.203)
                               ->  guest vm2 (192.168.122.204) 
```

其中 xxx.xxx.xxx.xxx 是 host1 的固定 IP 地址。

我想使用以下命令连接到 vm1：

```
ssh username@host1 -p 2222 
```

我试图通过在 iptables 中添加以下规则来做到这一点：

```
sudo iptables --table nat --append PREROUTING --protocol tcp --destination xxx.xxx.xxx.xxx --destination-port 2222 --jump DNAT --to-destination 192.168.122.203:22 
```

但是我在跑步时超时：

```
ssh username@host1 -p 2222 
```

这是我的 iptables 规则：

```
sudo iptables -nL -v --line-numbers -t nat
Chain PREROUTING (policy ACCEPT 32446 packets, 3695K bytes)
num   pkts bytes target     prot opt in     out     source               destination         
1        7   420 DNAT       tcp  --  *      *       0.0.0.0/0            xxx.xxx.xxx.xxx        tcp dpt:2222 to:192.168.122.203:22

Chain INPUT (policy ACCEPT 8961 packets, 968K bytes)
num   pkts bytes target     prot opt in     out     source               destination         

Chain OUTPUT (policy ACCEPT 350 packets, 23485 bytes)
num   pkts bytes target     prot opt in     out     source               destination         

Chain POSTROUTING (policy ACCEPT 357 packets, 23905 bytes)
num   pkts bytes target     prot opt in     out     source               destination         
1      151  9060 MASQUERADE  tcp  --  *      *       192.168.122.0/24    !192.168.122.0/24     masq ports: 1024-65535
2       99  7524 MASQUERADE  udp  --  *      *       192.168.122.0/24    !192.168.122.0/24     masq ports: 1024-65535
3        3   252 MASQUERADE  all  --  *      *       192.168.122.0/24    !192.168.122.0/24

sudo iptables -nL -v --line-numbers 
Chain INPUT (policy ACCEPT 14 packets, 1147 bytes)
num   pkts bytes target     prot opt in     out     source               destination         
1      454 30229 ACCEPT     udp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            udp dpt:53
2        0     0 ACCEPT     tcp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            tcp dpt:53
3        0     0 ACCEPT     udp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            udp dpt:67
4        0     0 ACCEPT     tcp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            tcp dpt:67

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         
1     589K 2304M ACCEPT     all  --  *      virbr0  0.0.0.0/0            192.168.122.0/24     state RELATED,ESTABLISHED
2     403K   24M ACCEPT     all  --  virbr0 *       192.168.122.0/24     0.0.0.0/0           
3        0     0 ACCEPT     all  --  virbr0 virbr0  0.0.0.0/0            0.0.0.0/0           
4        1    60 REJECT     all  --  *      virbr0  0.0.0.0/0            0.0.0.0/0            reject-with icmp-port-unreachable
5        0     0 REJECT     all  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            reject-with icmp-port-unreachable

Chain OUTPUT (policy ACCEPT 4 packets, 480 bytes)
num   pkts bytes target     prot opt in     out     source               destination 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-11T21:57:57.603

好的，我找到了答案：

我将这两条规则添加到 nat 表中：

```
$sudo iptables -t nat -A PREROUTING -p tcp --dport 2222 -j DNAT --to-destination 192.168.122.203:22
$sudo iptables -t nat -A POSTROUTING -p tcp --dport 22 -d 192.168.122.203 -j SNAT --to 192.168.122.1 
```

然后我删除了table filter的chain FORWARD的rule 4 et 5

```
$sudo iptables -nL -v --line-numbers -t filter

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
(...)        
4        7   420 REJECT     all  --  *      virbr0  0.0.0.0/0            0.0.0.0/0            reject-with icmp-port-unreachable
5        0     0 REJECT     all  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            reject-with icmp-port-unreachable

$sudo iptables -D FORWARD 5 -t filter
$sudo iptables -D FORWARD 4 -t filter 
```

现在我通过执行以下操作连接到 vm1：

```
$ssh user1@host -p 2222
user1@vm1:~$ 
```

# c - 如何在 mac 10.7 和/或 10.8 上编译 pam_radius

> ID：13772655
> 
> 赞同：1
> 
> 时间：2012-12-07T23:28:22.580
> 
> 标签：c

如何在 macports=2.1.2 xcode-4.5.2 gcc47 的现代 mac osx 10.7 或 10.8 系统上编译 pam_radius_auth (http://freeradius.org/pam_radius_auth/)。

我收到很多错误，包括但不限于：

pam_radius_auth.c:358:23: 错误: 变量的类型不完整 'struct timezone' struct timezone tz;

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T04:35:34.010

该代码相当旧（最新修改为 2007 年）。就其本身而言，这不一定是个问题。

[`gettimeofday()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/gettimeofday.html)通过包含`#include <sys/time.h>`每个 POSIX来解决“结构时区”问题。

`pam_get_item()`通过注释掉周围的`#ifdef sun`和`#endif`保护来解决未声明 etc的问题`#include <security/pam_appl.h>`。

```
pam_radius_auth.c:886:24: warning: passing 'int *' to parameter of type 'socklen_t *' (aka 'unsigned int *') converts
      between pointers to integer types with different sign [-Wpointer-sign]
                                     0, &saremote, &salen)) < 0) {
                                                   ^~~~~~
/usr/include/sys/socket.h:615:25: note: passing argument to parameter here
                socklen_t * __restrict) __DARWIN_ALIAS_C(recvfrom); 
```

这可以通过更改来解决：

```
int salen, total_length; 
```

到：

```
int total_length;
socklen_t salen; 
```

问题：

```
pam_radius_auth.c:1104:12: warning: incompatible pointer types assigning to 'const char *' from
      'const char **'dereference with * [-Wincompatible-pointer-types]
      user = userinfo; 
```

这可以通过将行更改为：

```
user = *userinfo; 
```

问题：

```
md5.c:176:27: warning: 'memset' call operates on objects of type 'struct MD5Context' while the size is based on a
      different type 'struct MD5Context *' [-Wsizeof-pointer-memaccess]
    memset(ctx, 0, sizeof(ctx));        /* In case it's sensitive */
           ~~~            ^~~
md5.c:176:27: note: did you mean to dereference the argument to 'sizeof' (and multiply it by the number of elements)?
    memset(ctx, 0, sizeof(ctx));        /* In case it's sensitive */ 
```

可以通过将行更改为：

```
 memset(ctx, 0, sizeof(*ctx));        /* In case it's sensitive */ 
```

（这是一个令人印象深刻的警告！）

随着这些变化的到位：

```
$ make
cc -Wall -fPIC -c pam_radius_auth.c -o pam_radius_auth.o
cc -Wall -fPIC   -c -o md5.o md5.c
ld -Bshareable pam_radius_auth.o md5.o -lpam -o pam_radius_auth.so
ld: unknown option: -Bshareable
make: *** [pam_radius_auth.so] Error 1
$ 
```

makefile 指出，更现代的 GCC 版本支持`-shared`（但猜测`ld -Bshareable`大多数地方都适用）。所以，让我们试试：

```
$ cc -shared -o pam_radius_auth.so *.o -lpam
$ 
```

* * *

### 修补

```
--- pam_radius-1.3.17/Makefile  2007-03-25 21:22:11.000000000 -0700
+++ pam_radius-1.3.17.fixed/Makefile    2012-12-07 20:26:17.000000000 -0800
@@ -55,7 +55,8 @@
 #  gcc -shared pam_radius_auth.o md5.o -lpam -lc -o pam_radius_auth.so
 #
 pam_radius_auth.so: pam_radius_auth.o md5.o
-   ld -Bshareable pam_radius_auth.o md5.o -lpam -o pam_radius_auth.so
+   gcc -shared pam_radius_auth.o md5.o -lpam -lc -o pam_radius_auth.so
+#  ld -Bshareable pam_radius_auth.o md5.o -lpam -o pam_radius_auth.so

 ######################################################################
 #
--- pam_radius-1.3.17/md5.c 2007-03-25 21:21:07.000000000 -0700
+++ pam_radius-1.3.17.fixed/md5.c   2012-12-07 20:11:17.000000000 -0800
@@ -173,7 +173,8 @@
     MD5Transform(ctx->buf, (uint32_t *) ctx->in);
     byteReverse((unsigned char *) ctx->buf, 4);
     memcpy(digest, ctx->buf, 16);
-    memset(ctx, 0, sizeof(ctx));   /* In case it's sensitive */
+    //memset(ctx, 0, sizeof(ctx)); /* In case it's sensitive */
+    memset(ctx, 0, sizeof(*ctx));  /* In case it's sensitive */
 }

 #ifndef ASM_MD5
--- pam_radius-1.3.17/pam_radius_auth.c 2007-03-26 02:36:13.000000000 -0700
+++ pam_radius-1.3.17.fixed/pam_radius_auth.c   2012-12-07 20:13:21.000000000 -0800
@@ -57,9 +57,9 @@
 #include <limits.h>
 #include <errno.h>

-#ifdef sun
+//#ifdef sun
 #include <security/pam_appl.h>
-#endif
+//#endif
 #include <security/pam_modules.h>

 #include "pam_radius_auth.h"
@@ -766,7 +766,9 @@
 talk_radius(radius_conf_t *conf, AUTH_HDR *request, AUTH_HDR *response,
             char *password, char *old_password, int tries)
 {
-  int salen, total_length;
+  //int salen, total_length;
+  socklen_t salen;
+  int total_length;
   fd_set set;
   struct timeval tv;
   time_t now, end;
@@ -1099,7 +1101,7 @@
     DPRINT(LOG_DEBUG, "Got PAM_RUSER name %s", userinfo);

     if (!strcmp("root", user)) {
-      user = userinfo;
+      user = *userinfo;
       DPRINT(LOG_DEBUG, "Username now %s from ruser", user);
     } else {
       DPRINT(LOG_DEBUG, "Skipping ruser for non-root auth");
--- pam_radius-1.3.17/pam_radius_auth.h 2007-03-25 22:35:31.000000000 -0700
+++ pam_radius-1.3.17.fixed/pam_radius_auth.h   2012-12-07 20:07:34.000000000 -0800
@@ -15,6 +15,7 @@
 #include <stdarg.h>
 #include <utmp.h>
 #include <time.h>
+#include <sys/time.h>
 #include <netinet/in.h>
 #include <netdb.h>
 #include <fcntl.h> 
```

* * *

将补丁另存为`pam_radius.patch`. 将源提取到子目录中`pam_radius-1.3.17`。使用以下方法应用补丁：

```
$ cd pam_radius-1.3.17
$ patch -p1 --dry-run -i ../pam_radius.patch --verbose
Hmm...  Looks like a unified diff to me...
The text leading up to this was:
--------------------------
|--- pam_radius-1.3.17/Makefile 2007-03-25 21:22:11.000000000 -0700
|+++ pam_radius-1.3.17.fixed/Makefile   2012-12-07 20:26:17.000000000 -0800
--------------------------
Patching file Makefile using Plan A...
Hunk #1 succeeded at 55.
Hmm...  The next patch looks like a unified diff to me...
The text leading up to this was:
--------------------------
|--- pam_radius-1.3.17/md5.c    2007-03-25 21:21:07.000000000 -0700
|+++ pam_radius-1.3.17.fixed/md5.c  2012-12-07 20:11:17.000000000 -0800
--------------------------
Patching file md5.c using Plan A...
Hunk #1 succeeded at 173.
Hmm...  The next patch looks like a unified diff to me...
The text leading up to this was:
--------------------------
|--- pam_radius-1.3.17/pam_radius_auth.c    2007-03-26 02:36:13.000000000 -0700
|+++ pam_radius-1.3.17.fixed/pam_radius_auth.c  2012-12-07 20:13:21.000000000 -0800
--------------------------
Patching file pam_radius_auth.c using Plan A...
Hunk #1 succeeded at 57.
Hunk #2 succeeded at 766.
Hunk #3 succeeded at 1101.
Hmm...  The next patch looks like a unified diff to me...
The text leading up to this was:
--------------------------
|--- pam_radius-1.3.17/pam_radius_auth.h    2007-03-25 22:35:31.000000000 -0700
|+++ pam_radius-1.3.17.fixed/pam_radius_auth.h  2012-12-07 20:07:34.000000000 -0800
--------------------------
Patching file pam_radius_auth.h using Plan A...
Hunk #1 succeeded at 15.
done
$ 
```

那是试运行；删除该选项以实际应用补丁。

在 Mac OS X 10.7.5 上测试，使用：

```
$ cc --version
Apple clang version 4.1 (tags/Apple/clang-421.11.65) (based on LLVM 3.1svn)
Target: x86_64-apple-darwin11.4.2
Thread model: posix
$ 
```

使用 GCC 4.7.1 编译时，我收到一个残留警告：

```
$ make CC=gcc
gcc -Wall -fPIC -c pam_radius_auth.c -o pam_radius_auth.o
pam_radius_auth.c: In function ‘pam_private_session’:
pam_radius_auth.c:1290:7: warning: variable ‘ctrl’ set but not used [-Wunused-but-set-variable]
gcc -Wall -fPIC   -c -o md5.o md5.c
gcc -shared pam_radius_auth.o md5.o -lpam -lc -o pam_radius_auth.so
$ gcc --version
gcc (GCC) 4.7.1
Copyright (C) 2012 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
$ 
```

### 警告

我只有要编译的代码；我没有测试它！

# java - 只有当屏幕处于 ACTION_DOWN 或 ACTIONMOVE 需要在被触摸时移动时，播放器才会移动

> ID：13772657
> 
> 赞同：0
> 
> 时间：2012-12-07T23:28:38.277
> 
> 标签：java, android, ontouchlistener, motionevent

好的，我创建了一个 ontouchlistener 类：

```
package drop.out.Game;

import android.view.MotionEvent;

import android.view.View;

import drop.out.Game.Model.Player;

public final class TrackingTouchListener 

 implements View.OnTouchListener{

//player class
private final Player mplayer;
Player plyr;

//constructor bringing in the player
TrackingTouchListener(Player plyr){mplayer = plyr;}

    //on touch stuff
     public boolean onTouch(View v, MotionEvent evt) {

         /**@if touching/moving on the left side of screen */
         if(MotionEvent.ACTION_DOWN== evt.getAction() && evt.getX() < (v.getWidth()/2) || MotionEvent.ACTION_MOVE== evt.getAction() && evt.getX() <(v.getWidth()/2)){
             moveL(mplayer);
         }
         /**@if touching/moving on the right side of the screen */
         if(MotionEvent.ACTION_DOWN== evt.getAction() && evt.getX() > (v.getWidth()/2) || MotionEvent.ACTION_MOVE== evt.getAction() && evt.getX() >(v.getWidth()/2)){
             moveR(mplayer);
         } 

         return true; 
     }

     //call functions in the player class that moves the player x by -1
     private void moveL(Player player){
         player.moveL();
         //e.g. player_x -=10;
     }

     private void moveR(Player player){
         player.moveR();  
         //e.g.player_x +=10;
     }

} 
```

不幸的是 player_x 仅在屏幕被按下或拖过时才会更新，我希望当手指在屏幕的以太一侧时它会移动。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:33:18.280

如果您不移动手指，您将停止获取更新。

`move`您应该设置一个布尔标志，而不是从 TouchListener调用`shouldMove`，然后在固定间隔发出移动命令（如果`shouldMove`为真）。

然后，即使您停止接收触摸事件，您的角色也会继续移动。当您抬起手指或移出某个区域时，只需清除此布尔值即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:39:30.580

您也可以在触摸侦听器上设置一个 x 值，然后检查其位置以确定主循环中的左侧或右侧（就像您在触摸侦听器中一样）并在手指抬起时将其设置为 0

编辑：所以

```
if(MotionEvent.ACTION_DOWN== evt.getAction()  || MotionEvent.ACTION_MOVE== evt.getAction()) 
{
    moveX = evt.getX();
} 
```

然后稍后检查moveX并将moveX设置为0；在 MotionEvent.ACTION_UP

# kendo-ui - 网格列 ClientTemplate 不起作用

> ID：13772658
> 
> 赞同：2
> 
> 时间：2012-12-07T23:28:47.730
> 
> 标签：kendo-ui

我有一个层次风格的剑道网格，内部网格似乎不接受客户端模板。（我剥离了代码无关的网格配置列）
我真的希望客户端模板类似于 `<a title="#=AlarmStatusDescription#">#=AlarmStatus#</a>` 但每当我在 ClientTemplate 中放置除简单字符串之外的任何内容时，整个网格都无法加载。

我试过了

*   `.ClientTemplate("#:AlarmStatus#")`
*   `.ClientTemplate("#=AlarmStatus#")`
*   `.ClientTemplate("<div class="myclass"></div>")`用一个单独的`<script type="text/html" id="myclass">#=AlarmStatus#</script>`

    `@(Html.Kendo().Grid<AccountModel>()`

    ```
     .Name("Accounts_#=Id#")
                .Columns(columns =>
                             {

    columns.Command(command => command.Custom("Details").Click("showDetails")).Width(75);
    columns.Bound(o => o.AccountName).Width(150);                  
    columns.Bound(o => o.AlarmStatus).Width(100).ClientTemplate("#:AlarmStatus#");`

                                 })
                    .DataSource(dataSource => dataSource
                        .Ajax()
                        .Model(model =>{model.Id(p => p.AccountId);})
                        .Read(read => read.Action("DetailRead", "Csr", new { personId = #=Id#" }))
                    )
                    .Editable(editable => editable.Mode(GridEditMode.PopUp))
                    .ToClientTemplate()
            ) 
    ```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-09T18:09:03.917

您需要转义尖锐符号 - 外部网格将尝试评估此**“#:AlarmStatus#”**表达式的其他方式。并且由于外部网格很可能没有诸如 AlarmStatus 之类的字段（它是内部网格的属性），所以会有一个例外。如果您像这样转义它，则外部网格应跳过客户端模板，并由内部网格正确评估。

```
.ClientTemplate("\\#= AlarmStatus \\#") 
```

我希望你有这个想法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T00:17:38.047

你应该使用：`.ClientTemplate("#= AlarmStatus #")`。我认为你错过了引号`"`。

# c# - 复制公式——并将其应用于新的单元格区域

> ID：13772659
> 
> 赞同：1
> 
> 时间：2012-12-07T23:28:51.297
> 
> 标签：c#, excel

这就是我正在经历的。我正在将 Excel dll 与 c# 一起使用，以便进入一个又大又讨厌的 excel 工作表，这样其他人就不必这样做了。

我们在一个相当大的单元格中有一个公式，因此我们不想将它复制到每一行。此公式在其所在的行上使用多个值。如果它在第 1 行，它会使用该行中的许多单元格。

当人们在 excel 中正常复制此公式时，单元格的新范围会被修改以反映新的起始位置。

问题是，当我像这样复制公式时，它仍然给我所有与第一行有关的值，而不是我粘贴它的行.....这是我的代码：

```
 sheet.Cells[77][row].Formula = sheet.Cells[77][1].Formula; 
```

有人可以让我知道如何使公式实际应用于新行而不是第 1 行吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-07T23:56:39.007

这可能会起作用，因为它适用于 VBA ......在大多数情况下。

```
sheet.Cells[77][row].FormulaR1C1 = sheet.Cells[77][1].FormulaR1C1; 
```

这会起作用，因为[FormulaR1C1](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.range.formular1c1.aspx)（不是一个信息量很大的链接）使用 R1C1 表示法，它描述了与当前单元格相关的引用单元格的位置，而不是说明要使用哪些单元格。这意味着实际引用取决于带有公式的单元格。当您只使用`Formula`时，您正在复制`Formula`包含硬编码单元格引用的字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T00:22:07.420

你可以使用`Application.ConvertFormula`

所以，假设我的 Cell = Cells [77](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel._application.convertformula.aspx)有一个公式，上面写着`=Sum(B77,C77)`（来自同一行的单元格）。
如果要将其复制到其正下方的单元格中，您可以执行以下操作：

```
string formula = Sheet1.Cells[77][2].Formula;
Sheet1.Cells[77][2].Formula = app.ConvertFormula(formula, XlReferenceStyle.xlA1, XlReferenceStyle.xlR1C1, XlReferenceType.xlRelative, Sheet1.Cells[77][3]); 
```

可以运行的完整控制台应用程序（尽管您需要修改单元格）。

```
 static void Main(string[] args)
        {
           var app = new Microsoft.Office.Interop.Excel.Application();

                var workbook = app.Workbooks.Open(@"C:\Users\user\Desktop\Book1.xlsx");
                Microsoft.Office.Interop.Excel.Worksheet Sheet1 = (Microsoft.Office.Interop.Excel.Worksheet)workbook.Worksheets.get_Item("Sheet1");
                string formula = Sheet1.Cells[5][3].Formula;
                Sheet1.Cells[5][4].Formula = app.ConvertFormula(formula, XlReferenceStyle.xlA1, XlReferenceStyle.xlR1C1, XlReferenceType.xlRelative, Sheet1.Cells[5][3]);
                workbook.SaveAs(@"C:\Users\user\desktop\test.xlsx");
                workbook.Close();
        } 
```

`ConvertFormula`您可以根据自己的喜好修改方法的第三个和第四个参数。在此处阅读有关该方法的更多信息：[ConvertFormula](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel._application.convertformula.aspx)。
如果要跨多行拉伸公式，可以尝试使用[range.AutoFill()](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.range.autofill%28v=office.11%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-14T07:30:24.033

大家好，我发布此代码是因为此代码用于复制 Excel 中单元格后面的公式：

```
public void copy_Formula_behind_cell()
{
    Excel.Application xlapp;
    Excel.Workbook xlworkbook;
    Excel.Worksheet xlworksheet;
    Excel.Range xlrng;
    object misValue = System.Reflection.Missing.Value;

    xlapp = new Excel.Application();
    xlworkbook =xlapp.Workbooks.Open("YOUR_FILE", 0, true, 5, "", 
    "",true,Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, "\t", 
    false, 
    false, 0, true, 1, 0);

    xlworksheet = (Excel.Worksheet)xlworkbook.Worksheets.get_Item(1);

    string sp = xlworksheet.Cells[3,2].Formula;//It will Select Formula using Fromula method//

    xlworksheet.Cells[8,2].Formula = 
    xlapp.ConvertFormula(sp,XlReferenceStyle.xlA1, 
    XlReferenceStyle.xlR1C1, XlReferenceType.xlAbsolute,
    xlworksheet.Cells[8][2]);
    //This is used to Copy the exact formula to where you want//

    xlapp.Visible = true;
    xlworkbook.Close(true, misValue, misValue);
    xlapp.Quit();

    releaseObject(xlworksheet);
    releaseObject(xlworkbook);
    releaseObject(xlapp);
}

private void releaseObject(object obj)
{
    try
    {
        System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);
        obj = null;
    }
    catch (Exception ex)
    {
        obj = null;
        MessageBox.Show("Unable to release the Object " + ex.ToString());
    }
    finally
    {
        GC.Collect();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-22T15:19:41.797

我正在使用 c# 代码和 Microsoft.Office.Interop.Excel 库发布此代码以用于范围 excel 公式：

```
class Program
{
    static void Main(string[] args)
    {
        Program p = new Program();
        p.Excel();
    }

    public void Excel()
    {
        Application xlApp = new Application();
        Workbook xlWorkBook;
        Worksheet xlWorkSheet;
        object misValue = Missing.Value;

        xlWorkBook = xlApp.Workbooks.Add(misValue);
        xlWorkSheet = (Worksheet)xlWorkBook.Worksheets.get_Item(1);

        for (int r = 1; r < 5; r++) //r stands for ExcelRow and c for ExcelColumn
        {
            // Its a my sample example: Excel row and column start positions for writing Row=1 and Col=1
            for (int c = 1; c < 3; c++)
            {
                if (c == 2)
                {
                    if (r == 1)
                    {
                        xlWorkSheet.Cells[r, c].Formula = "=SUM(A1+200)";
                    }
                    continue;
                }
                xlWorkSheet.Cells[r, c] = r;
            }
        }
        Range rng = xlWorkSheet.get_Range("B1");
        //  This is the main code we can range our excel sheet formulas
        rng.AutoFill(xlWorkSheet.get_Range("B1", "B4"), XlAutoFillType.xlLinearTrend);

        xlWorkBook.Worksheets[1].Name = "MySheetData";//Renaming the Sheet1 to MySheet

        xlWorkBook.SaveAs(@"E:\test.xlsx");

        xlWorkBook.Close();

        Marshal.ReleaseComObject(xlWorkSheet);
        Marshal.ReleaseComObject(xlWorkBook);
        Marshal.ReleaseComObject(xlApp);

    }
} 
```

# ruby-on-rails-3 - Rails 数据库 ID 号未通过销毁调用更新

> ID：13772661
> 
> 赞同：1
> 
> 时间：2012-12-07T23:29:03.673
> 
> 标签：ruby-on-rails-3, sqlite3-ruby

我是 Rails 的新手，所以记录 ID 可能不会在销毁时更新。

我使用 rails 脚手架为产品页面生成 MVC。当我通过我的产品/新页面向我的数据库添加一个条目时，它会向该条目添加一个 ID 号。在浏览器中，如果我滚动索引视图上的显示/编辑/销毁链接，它会给我一个 localhost:3000/products/1 的 url 链接。现在，如果我使用破坏链接删除条目，它会正确删除条目，但是现在当我添加另一个条目时，它显示 id 为 2 而不是 1。为什么它从数据库中删除条目但没有将 id 重置回 1 .

这是用于 Rails 应用程序 sqlite3 中的内置服务器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T23:53:50.450

Sqlite 使用一个序列来确定下一个用于主 ID 的可用整数。即使您用最新的记录破坏了序列，序列也不会“返回”。他们不断增加。有些数据库一旦达到最大值就会从零重新启动，有些会出错。

一些数据库将序列与表联系起来。但是在某些情况下，序列是它们自己的东西。您可以（如果您愿意）使用序列来获取多个不同表的唯一 ID。

查看 sqlite 的文档以获取详细信息...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-30T09:04:19.703

该命令`rake db:schema:dump`将当前环境的模式转储到 db/schema.rb。要将其重置或全部删除并再次迁移，您应该使用`rake db:setup`运行命令`rake db:schema:load`和`rake db:seed`.

其他一些重要的命令是；

`rake db:schema:load`此命令将模式加载到当前环境的数据库中。

`rake db:schema:dump`此命令将当前环境的模式转储到`db/schema.rb`.

`rake db:setup`此命令运行`rake db:schema:load`并且`rake db:seed`.

`rake db:reset`此命令运行`rake db:drop`并且`rake db:setup`.

`rake db:migrate:reset`此命令运行`rake db:drop`然后.`rake db:create``rake db:migrate`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T03:53:07.880

你必须 rake db:drop 你的数据库（删除它）然后 rake db:migrate 再次创建你的表。

# html - 使用 CSS 的 HTML 页面格式不正确

> ID：13772662
> 
> 赞同：0
> 
> 时间：2012-12-07T23:29:28.040
> 
> 标签：html, css

我正在设计一个基本站点，您可以在其中对计算机玩石头剪刀布。该功能运行良好，现在我只需要调整页面的格式。

我喜欢玩游戏的想法，然后在游戏结束后下方会出现一条消息和重启按钮，并且应该在页面下方居中。目前，这些显示在我的包装器右侧，其中包含实际游戏。

这是我的 htm：div 和按钮位于底部：

```
<div id="wrapper">
        <div id="left" class="column">
                <h2>User</h2>
                <div id="userchoice">
                </div>
        </div>
        <div id="middle" class="column">
                <h2>VS.</h2>

        </div>
        <div id="right" class="column">
                <h2>Rock Paper Scissors</h2>
                <div id="computerchoice">
                </div>
        </div>
</div>

</br></br>

<div>
        <p id="result"></p>
</div>
</br>
<button  onclick="playAgain()" id="playagain" class="ui-button ui-widget ui-state-default ui-corner-all">Play Again?</button>
</br>
</br> 
```

和我的CSS：

```
 body
    {
            text-align: center;
            font-family: Verdana, Arial, sans-serif;
            font-size: 1em;
    }
     #wrapper {
                /*border: 2px solid black;*/
                width: 1015px;
                margin-left: auto;
                margin-right: auto;
        }
        #header {
                text-align: center;
        }

        /* 300px content + 20px = 320px physical width per column */
        .column {
                float: left;
                width: 325px;
                margin: 5px;
                text-align: center;
                min-height: 250px;
        }
        /* The middle column adds 4px of border to its physical width */
        #middle {
                /*border-left: 2px solid black;
                border-right: 2px solid black;*/
                margin-left: 0;
                margin-right: 0;
                padding-left: 10px;
                padding-right: 10px;
        }

        /* CSS Clear Hack: apply this to the containing element. */
        .group:before,
        .group:after {
                content:"";
                display:table;
        }
        .group:after {
                clear:both;
        }
        .group {
                zoom:1; /* For IE 6/7 (trigger hasLayout) */
        } 
```

我在另一个页面上使用了这个 css，它的功能与我想要的按钮和底部的消息一样，所以我很困惑它是如何不起作用的。如果您发现错误或有其他问题，我可能会尝试，请告诉我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:44:14.617

添加一个清晰的 div 以清除高度，因为您有浮动元素。

```
 <div id="wrapper">
            <div id="left" class="column">
                    <h2>User</h2>
                    <div id="userchoice">
                    </div>
        </div>
        <div id="middle" class="column">
                <h2>VS.</h2>

        </div>
        <div id="right" class="column">
                <h2>Rock Paper Scissors</h2>
                <div id="computerchoice">
                </div>
            </div>
    <!-- clear here -->
    <div class="clear" style="clear:both;"></div>
    </div> 
```

# hash - 哈希函数混淆

> ID：13772663
> 
> 赞同：0
> 
> 时间：2012-12-07T23:29:35.247
> 
> 标签：hash

![在此处输入图像描述](../Images/70a1c9adf40729c05d32717aeabfa753.png)

任何人都知道如何开始这个问题？我的意思是，我了解哈希的作用，但我不知道这个问题在说什么。

关于如何解决这个问题的任何想法？

鉴于：

*   哈希函数：h(x) = | 2x + 5 | 模式 M
*   容量为 N 的桶数组
*   一组带有键的对象：12、44、13、88、23、94、11、39、20、16、5（从左到右输入）

**4.a *** [5 pts]***** 编写哈希表，其中 M=N=11 并且使用单独的链接处理冲突。

**4.b *** [5 pts]***** 编写 M=N=11 的哈希表，并使用线性探测处理冲突。

**4.c *** [5 pts]***** 如果 M=11，你能找到一个 N 值，它不会产生散列这些键的冲突吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:35:55.193

使用等式 h(x) 找到每个键的哈希值。这是数组中存储值的位置。因为，这显然是家庭作业，我不会解释线性探测或分离链接或 4c。

M 是您将值放入的数组的大小。

N 是您要散列的对象数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:51:09.557

*   你有一个函数，它给定一个数字 (x) 确定应该在表中的位置。
*   该表具有给定的大小 N。对于本题的 a 和 b 部分，N 为 11。
*   对于问题 a、b 和 c，M 为 11。M 只是一个插入给定公式的值`h(x) = (2x + 5) mod M`
*   所以给定数字 12，`h(12) = (2 * 12 + 5) mod 11`=> 7。所以第一个结果进入存储桶 7。
*   然后你依次处理其余的数字，计算出每个数字的 h(x) 是什么。
*   但是，当您遇到冲突时（即数字应该进入的桶已经被之前的数字填充的场景），您需要为其选择不同的桶。您选择哪个反冲将取决于您的溢出策略。
*   有问题 A 你的溢出策略是单独的链接
*   在问题 B 中，您的溢出策略是线性探测
*   如果您不熟悉这些方法，请观看：
    *   单独的链接：[http ://www.youtube.com/watch?v=IDqTof09ufg](http://www.youtube.com/watch?v=IDqTof09ufg)
    *   线性探测：[http ://www.youtube.com/watch?v=g0n0Ep18DJc](http://www.youtube.com/watch?v=g0n0Ep18DJc)
*   如果 C 被视为已读，我认为这意味着从列表的开头获取数字，直到您遇到第一次碰撞；但是，您的存储桶中已有的许多数字是 N 的值。
*   但是，我认为 CI 认为问题是印刷错误。我认为它希望您为 M 找到一个值，该值将允许将给定的数字列表全部分配给一个唯一的存储桶（即没有冲突/没有溢出策略）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T23:35:43.507

首先计算每个键的哈希值。

# python - pyPEG2：'f(x)' 的 PEG 语法有什么问题？

> ID：13772669
> 
> 赞同：0
> 
> 时间：2012-12-07T23:30:29.023
> 
> 标签：python, peg

*这个语法*问题还有另一个问题：

我正在玩 Volker Birk 的[pyPEG2](http://pypi.python.org/pypi/pyPEG2/2.4.3)，但我遇到了一个非常微不足道的案例：

```
from pypeg2 import *

text = 'f(x)'
grammar = name, '(' , word,')'
print parse(text, grammar) 
```

我得到的异常看起来像：

> Traceback（最近一次调用最后）：文件“test.py”，第 5 行，打印解析（文本，语法）文件“/home/yy/dev/python/len/len/lang/pypeg2/ **init** .py”，第 539 行，在解析 t 中，r = parser.parse(text, thing) 文件“/home/yy/dev/python/len/len/lang/pypeg2/ **init** .py”，第 644 行，在解析 t 中，r = self._parse(t, thing, pos) 文件“/home/yy/dev/python/len/len/lang/pypeg2/ **init** .py”，第 814 行，在 _parse t2 中，r = self._parse(t, e , pos) 文件“/home/yy/dev/python/len/len/lang/pypeg2/ **init** .py”，第 962 行，在 _parse 中引发 GrammarTypeError("in grammar:" + repr(thing)) pypeg2.GrammarTypeError:在语法中：'（'

*parse()*在解析应该是 Symbol() 的左圆括号时失败。当然，我遗漏了一些明显的东西，但是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:37:36.370

```
from __future__ import unicode_literals, print_function
from pypeg2 import *

text = 'f(x)'
grammar = name(), '(' , attr('Param',word),')'
print(parse(text, grammar)) 
```

输出

```
[Attribute(name=u'name', thing=Symbol(u'f'), subtype=None), Attribute(name=u'Param', thing=u'x', subtype=None)] 
```

**为什么？** [实时调频](http://fdik.org/pyPEG2/)！！

> 警告：pyPEG 2.x 是为 Python 3 编写的。您可以通过以下导入将它与 Python 2.7 一起使用（Python 3 不需要它）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-08T06:13:23.290

由于人们遇到此类问题，我更新了文档。pyPEG2 是为 Python 3 编写的。这意味着，它一直使用 Unicode 字符串。对于 Python 2.7，这将需要 ie 形式的字符串`u'f(x)'`。因为我不想拥有两次文档，所以我推荐`from __future__ import unicode_literals, print_function`

VB。

# python - Matplotlib - imshow twiny() 问题

> ID：13772673
> 
> 赞同：3
> 
> 时间：2012-12-07T23:31:01.103
> 
> 标签：python, matplotlib

我试图在 matplotlib imshow() 图中有两个相互依赖的 x 轴。我将底部 x 轴作为半径的平方，我希望顶部作为半径。到目前为止我已经尝试过：

```
ax8 = ax7.twiny()
ax8._sharex = ax7
fmtr = FuncFormatter(lambda x,pos: np.sqrt(x) )
ax8.xaxis.set_major_formatter(fmtr)
ax8.set_xlabel("Radius [m]") 
```

其中 ax7 是 y 轴和底部 x 轴（或半径平方）。我没有将 sqrt (x_bottom) 作为顶部的刻度，而是得到一个从 0 到 1 的范围。我该如何解决这个问题？

提前非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T19:56:22.177

你误解了什么`twiny`。它形成了一个*完全独立*的 x 轴和一个共享的 y 轴。

您想要做的是使用带有链接轴的不同格式化程序（即共享轴限制但仅此而已）。

执行此操作的简单方法是手动设置孪生轴的轴限制：

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.ticker import FuncFormatter

fig, ax1 = plt.subplots()
ax1.plot(range(10))

ax2 = ax1.twiny()
formatter = FuncFormatter(lambda x, pos: '{:0.2f}'.format(np.sqrt(x)))
ax2.xaxis.set_major_formatter(formatter)

ax2.set_xlim(ax1.get_xlim())

plt.show() 
```

![在此处输入图像描述](../Images/61c24176a989bcdc28604be5a496c6fe.png)

但是，一旦您缩放或与绘图交互，您就会注意到轴未链接。

您可以使用共享的 x 和 y 轴在相同位置添加一个轴，但是刻度格式化程序也被共享。

因此，最简单的方法是使用寄生轴。

举个简单的例子：

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.ticker import FuncFormatter
from mpl_toolkits.axes_grid1.parasite_axes import SubplotHost

fig = plt.figure()
ax1 = SubplotHost(fig, 1,1,1)
fig.add_subplot(ax1)

ax2 = ax1.twin()

ax1.plot(range(10))

formatter = FuncFormatter(lambda x, pos: '{:0.2f}'.format(np.sqrt(x)))
ax2.xaxis.set_major_formatter(formatter)

plt.show() 
```

这和之前的情节一开始看起来都是一样的。当您与绘图交互（例如缩放/平移）时，差异将变得明显。

# python - 嵌入式 if 语句

> ID：13772680
> 
> 赞同：2
> 
> 时间：2012-12-07T23:32:14.017
> 
> 标签：python, if-statement

假设我有如下功能：

```
bigrams=[(k,v) for (k,v) in dict_bigrams.items()
         if k[:pos_qu]==selection[:pos_qu]
         and (k[pos_qu+1:]==selection[pos_qu+1:] if pos_qu!=1)
         and k[pos_qu] not in alphabet.values()] 
```

我想制作第二个条件，即`k[pos_qu+1:]==selection[pos_qu+1:]`依赖于另一个 if 语句`if pos_qu!=1`。我尝试（如上所示）将两者一起包含在括号中，但python在括号中标记了语法错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:36:42.537

如果我正确理解您的要求，您只想检查`k[pos_qu+1:]==selection[pos_qu+1:]`条件`pos_qu!=1`是否也满足。您可以将其改写为以下条件：

```
pos_qu==1 or k[pos_qu+1:]==selection[pos_qu+1:] 
```

把它放在你的理解中：

```
bigrams=[(k,v) for (k,v) in dict_bigrams.items()
         if k[:pos_qu]==selection[:pos_qu]
         and (pos_qu==1 or k[pos_qu+1:]==selection[pos_qu+1:])
         and k[pos_qu] not in alphabet.values()] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T23:57:17.257

每当你发现自己有一个复杂的列表理解，试图弄清楚如何做一些复杂的事情却不知道如何做时，答案通常是把事情分解。表达式语法本质上比 Python 中的完整语句（或多语句套件）语法更受限制，以防止您编写以后无法阅读的内容。通常，这是一件好事——即使不是，你最好还是顺其自然，而不是试图与之抗争。

`if`在这种情况下，除了不知道如何将其写成表达式的子句之外，您的理解力很简单。所以，我会把条件变成一个单独的函数：

```
def isMyKindOfKey(k):
    … condition here
[(k,v) for (k,v) in dict_bigrams.items() if isMyKindOfKey(k)] 
```

这使您可以对条件使用完整的多语句语法。它还允许您为条件命名（希望比 更好`isMyKindOfKey`）；使闭包捕获的参数、局部值等更加明确；允许您单独测试该功能或重复使用它；等等

在循环本身是不平凡的部分（或者只有很多嵌套）的情况下，将整个理解分解为显式的 for 循环并附加通常更有意义，但我认为这里没有必要。

值得注意的是，在这种情况下——与一般情况一样——这并不能神奇地解决您的问题，它只是为您提供了更大的灵活性。例如，您可以使用FJ 建议的从后缀`if`到中缀的相同转换，但您也可以将其保留为，例如，像这样：`or``if`

```
def isMyKindOfKey(k):
    retval = k[:pos_qu]==selection[:pos_qu]
    if pos_qu!=1:
        retval = retval and (k[pos_qu+1:]==selection[pos_qu+1:])
    retval = retval and (k[pos_qu] not in alphabet.values())
    return retval 
```

这实际上可能不是我写这个的方式，但你可以看到这是一种将你头脑中的东西转换为代码的简单方法，这在表达式中很难做到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T23:35:42.553

只需更改顺序

```
bigrams=[(k,v) for (k,v) in dict_bigrams.items()
     if k[:pos_qu]==selection[:pos_qu] #evaluated first
     and  pos_qu!=1 #if true continue and evaluate this next
     and (k[pos_qu+1:]==selection[pos_qu+1:]) #if pos_qu != 1 lastly eval this 
```

正如评论所提到的，这不是一个非常pythonic的列表理解，并且作为循环的标准更具可读性..

# javascript - jQuery Twitter Feed 未显示在静态网站上

> ID：13772685
> 
> 赞同：0
> 
> 时间：2012-12-07T23:32:37.527
> 
> 标签：javascript, jquery, twitter

我正在尝试在我的网站上集成 Twitter 提要，但是通过以下设置，我的提要卡在显示“正在加载推文...”

这是直接在索引页面上加载的脚本：

```
<script src="js/libs/jquery.twitter.js" type="text/javascript"></script>

<script src="http://twitter.com/javascripts/blogger.js" type="text/javascript"></script>

<script type="text/javascript">
$(document).ready(function() {
        $("#twitter").getTwitter({
            userName: "username",
            numTweets: 3,
            loaderText: "Loading tweets...",
            slideIn: true,
            slideDuration: 750,
            showHeading: true,
            headingText: "Latest Tweets",
            showProfileLink: false,
            showTimestamp: false,
            target: "_top"
    });
});
</script>
<script>
if ($) {    //check if $ is defined - but this check results in an error!
$("#twitter").click (function () {});    //my jQuery code here
}
</script> 
```

这是 jquery.twitter.js 文件中的代码：

```
 (function($) {
    /*
        jquery.twitter.js v1.5
        Last updated: 08 July 2009

        Created by Damien du Toit
        http://coda.co.za/blog/2008/10/26/jquery-plugin-for-twitter

        Licensed under a Creative Commons Attribution-Non-Commercial 3.0 Unported License
        http://creativecommons.org/licenses/by-nc/3.0/

        This code is modified by http://plugidea.com/iweb/
        Updated date: Mar 10, 2011
    */

    $.fn.getTwitter = function(options) {

        $.fn.getTwitter.defaults = {
            userName: null,
            numTweets: 5,
            loaderText: "Loading tweets...",
            slideIn: true,
            slideDuration: 750,
            showHeading: true,
            headingText: "Latest Tweets",
            showProfileLink: true,
            showTimestamp: true,
            target: "_blank"
        };

        var o = $.extend({}, $.fn.getTwitter.defaults, options);

        return this.each(function() {
            var c = $(this);

            // hide container element, remove alternative content, and add class
            c.hide().empty().addClass("twitted");

            // add heading to container element
            if (o.showHeading) {
                c.append("<h2>"+o.headingText+"</h2>");
            }

            // add twitter list to container element
            var twitterListHTML = "<ul id=\"twitter_update_list\"><li></li></ul>";
            c.append(twitterListHTML);

            var tl = $("#twitter_update_list");

            // hide twitter list
            tl.hide();

            // add preLoader to container element
            var preLoaderHTML = $("<p class=\"preLoader\">"+o.loaderText+"</p>");
            c.append(preLoaderHTML);

            // add Twitter profile link to container element
            if (o.showProfileLink) {
                var profileLinkHTML = "<p class=\"profileLink\"><a href=\"http://twitter.com/"+o.userName+"\">http://twitter.com/"+o.userName+"</a></p>";
                c.append(profileLinkHTML);
            }

            // show container element
            c.show();

            //$.getScript("http://twitter.com/javascripts/blogger.js");
            $.getScript("http://twitter.com/statuses/user_timeline/"+o.userName+".json?callback=twitterCallback2&count="+o.numTweets, function() {
                // remove preLoader from container element
                $(preLoaderHTML).remove();

                // remove timestamp and move to title of list item
                tl.find("li").each(function() {
                    var timestampHTML = $(this).children("a");
                    var timestamp = timestampHTML.html();
                    if (!o.showTimestamp) {
                        timestampHTML.remove();
                        $(this).attr("title", timestamp);
                    }
                    $('a',this).attr("target", o.target);
                });

                // show twitter list
                if (o.slideIn) {
                    // a fix for the jQuery slide effect
                    // Hat-tip: http://blog.pengoworks.com/index.cfm/2009/4/21/Fixing-jQuerys-slideDown-effect-ie-Jumpy-Animation
                    var tlHeight = tl.data("originalHeight");

                    // get the original height
                    if (!tlHeight) {
                        tlHeight = tl.show().height();
                        tl.data("originalHeight", tlHeight);
                        tl.hide().css({height: 0});
                    }

                    tl.show().animate({height: tlHeight}, o.slideDuration);
                }
                else {
                    tl.show();
                }

                // add unique class to first list item
                tl.find("li:first").addClass("firstTweet");

                // add unique class to last list item
                tl.find("li:last").addClass("lastTweet");
            });
        });
    };
})(jQuery); 
```

我使用了一个开箱即用的解决方案，因为我对 Javascript 和 jQuery 还很陌生。为了安全起见，我用“用户名”替换了 Twitter 用户名。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:36:46.197

确保在 jQuery 脚本/调用之前加载 jQuery 库。

据我所知，你不应该需要

```
<script>
if ($) {    //check if $ is defined - but this check results in an error!
$("#twitter").click (function () {});    //my jQuery code here
}
</script> 
```

我相信`username: "username", is where you actually input your account handle.`

确保你的 div 也有一个`ID`twitter。

```
<div id="twitter"></div><!--end twitter --> 
```

# autohotkey - 在特定显示器上自动热键启动应用程序

> ID：13772688
> 
> 赞同：0
> 
> 时间：2012-12-07T23:33:02.257
> 
> 标签：autohotkey, multiple-monitors

我对 AHK 还很陌生，但已经对此进行了一些研究，但还没有找到好的答案。我希望能够在特定显示器上启动最大化的应用程序。我认为当前的最佳做法是运行应用程序，然后使用 WinMove 进行定位。

目前，我有以下配置的三个面板：左侧 (1680x1050)、中间 (1920x1080)、右侧 (1920x1080)。

Run 和 WinMove 的逻辑似乎很简单，但由于我有不同的分辨率，并且我想最大化地运行应用程序，我不知道如何编写脚本。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T14:56:45.717

是的，差不多就是这样。

我要做的是`Run`，然后`WinMove`水平到正确的显示器，然后`WinMaximize`

# gps - 给定所有纬度/经度坐标，如何确定点是否在矩形内？

> ID：13772690
> 
> 赞同：3
> 
> 时间：2012-12-07T23:33:14.267
> 
> 标签：gps, latitude-longitude, rectangles

如果给定矩形的所有 4 个角的 x/y 坐标，然后是另一个 x/y，则如果左上角为 0,0，则很容易确定该点是否在矩形内。

但是，如果坐标是纬度/经度，它们可能是负数（请参阅附件）。有没有可以在这种情况下工作的公式？

![在此处输入图像描述](../Images/4768db6cf864507f142f4a0b4492fde6.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:43:08.470

在数学上，您可以使用不等式来确定这一点。

编辑：在做这个例子时，我注意到你把坐标用逆格式（y，x）而不是（x，y）。在我的示例中，我使用 (x,y) 格式，所以我只是颠倒了顺序以便于解释。

假设 A = (-130,10) B = (-100,20) C = (-125,-5) D = (-100,5)

你从你的矩形边缘建立一个不等式：

```
if( (x,y) < AB && (x,y) > AC && (x,y) > CD && (x,y) < BD) then
    (x,y) belongs to rectangle ABCD
end if 
```

如果所有不等式都为真，那么您的点属于矩形

* * *

具体例子：

AB 表示段，但可以用公式表示：y = ax + b

确定 a （公式的斜率，而不是点 A）你得到的差异

```
(Ay - By) / (Ax - Bx) 
```

Ay 表示 A 点的 Y 分量，在这种情况下为 10

这个公式给了我们

```
(10 - 20) / (-130 - -100) = -10 / -30 = 1/3 
```

现在我们有

```
y = x/3 + b 
```

我们现在确定 b。我们现在 A 点和 B 点都属于该公式。所以我们用它们中的任何一个来替换公式中的 x,y 值。让我们以 B 点为例：

```
20 = -100/3 + b 
```

我们隔离 b 给我们：

```
b = -100 / 60 = -10/6 
```

我们现在有

```
y = x/3 - (6/10) 
```

因此，如果我们想确定点 Z (10, 15) 是否属于您的矩形，您首先检查是否

```
y > x/3 - (10/6) 
```

然后在 Z(10, 15) 的情况下：

```
15 > 10/3 - (10/6)

15 > 10/6

15 > 1.66 is true 
```

因此，该边缘满足条件。您需要对每个边使用相同的逻辑。

请注意，要确定是使用 > 还是 <，您需要判断在某个 x 值处，我们的点是否具有比矩形边缘更大或更小的 y 值。

如果您希望点严格位于矩形内，则可以使用 < 和 >；<= 和 >= 如果矩形边缘上的点也属于矩形。你决定。

我希望我的解释是清楚的。如果某些点不清楚，请随时询问更多。

# ruby-on-rails - 有没有办法删除 Rails 中的方法调用？

> ID：13772693
> 
> 赞同：1
> 
> 时间：2012-12-07T23:33:47.013
> 
> 标签：ruby-on-rails, ruby

在某些情况下，我想在我的 Rails 模型中捕获和删除方法调用。

我想要类似的东西`remove_method`，但这会删除方法调用。

例如，如果我`before_save`在模型中有回调，我可能想使用扩展到类中的模块来捕获它，并删除或阻止`before_save`触发。

这可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T23:43:29.923

**编辑：**

我发布的先前答案不起作用 - 不确定它是否曾经做过，但我隐约记得过去使用过。例如，要跳过回调，在子类的上下文中，您应该使用`skip_callback`. 用法示例：

```
skip_callback :save, :before, :callback_method_name 
```

或者，如果您想在特定条件下跳过回调：

```
skip_callback :save, :before, :callback_method_name, if: :some_condition_true? 
```

还有一种`reset_callbacks`方法，将回调类型作为参数。例如，`reset_callbacks :save`。回调可以通过类方法 ,`_save_callbacks`等访问`_create_callbacks`。我在使用时要小心，`reset_callbacks`因为 Rails 本身似乎正在为关联定义回调，即`:before_save_collection_association`.

如果您只是在谈论常规的 Ruby 对象，则可以覆盖子类中的方法。只需定义一个与超类同名的方法。您还可以通过包含一个定义与基类相同的实例方法的模块来覆盖子类中的基类方法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-07T23:38:28.067

您是否尝试过`before_save`像这样清除：

```
before_save ->{} 
```

# perl - 在perl中对哈希值进行排序

> ID：13772696
> 
> 赞同：-4
> 
> 时间：2012-12-07T23:34:13.917
> 
> 标签：perl, sorting, hash

> **可能重复：**
> [Perl 按散列中的值对散​​列进行排序](https://stackoverflow.com/questions/12790891/perl-sorting-hash-by-values-in-the-hash)

我已经在网上浏览了很多解决方案，但我找不到任何满足我需求的东西。

我有一个大的单词列表，每个单词都附加了值

例子：

```
my %list = (
  word => 10,
  xword => 15,
  yword => 1
) 
```

该列表一直在继续，但我希望能够返回具有最高对应值的前 5 个哈希元素

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:45:19.280

```
use strict;
use warnings;

sub topN {
  my ($N, %list) = (shift, @_);
  $N = keys %list if $N > keys %list;
  return (sort { $list{$b} <=> $list{$a} } keys %list)[0..$N-1];
}

my %list = ( word => 10, xword => 15, yword => 1, zword => 4);     
print join (",", topN(5, %list)), "\n"; 
```

输出：

```
xword,word,zword,yword 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:48:57.183

这可以满足您的需要。`Use of uninitialized value`请注意，如果您的散列元素少于五个，它将引发警告，您可能需要添加代码来满足这一要求。它也是低效的，因为它对整个散列进行排序，而不是只查找前五个值。这是否是一个问题取决于你的情况。

```
use strict;
use warnings;

my %list = (
  word => 10,
  xword => 15,
  yword => 1,
);

my @top5 = (sort { $list{$b} <=> $list{$a} } keys %list)[0..4];

print "$_\n" for @top5; 
```

**输出**

```
xword
word
yword 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T01:48:23.087

```
use strict;
use warnings;

my %list = (
   word => 10,
   xword => 15,
   yword => 1,
);

my @top5 = sort { $list{$b} <=> $list{$a} } keys %list;
splice(@top5, 5) if @top5 > 5;

print "$_\n" for @top5; 
```

# php - 从异步任务动态生成的EditText，Checkbox，Radiobutton将数据保存在数据库中？

> ID：13772697
> 
> 赞同：0
> 
> 时间：2012-12-07T23:34:18.027
> 
> 标签：php, android, mysql, mobile, survey

我有一个数字调查的 Android 应用程序，我的应用程序从服务器（mysql-php）获取数据并显示在 Activity 中。我的疑问是如何将数据保存到数据库，因为我动态生成了问题和答案选项。

这是活动类的代码

```
 public void onPostExecute(String  result) {

       pDialog.dismiss();//ocultamos progess dialog.

       //paring data
       String id_preg;
        String preg;
        String tipopreg;
        String tipo_opc;
        String descri_op;
        String id_pregunta = null;
        String pregunta = null;
        String tipo_pregunta = null;
        String tipo_opcion = null;
        String descrip_opc;

        try{
            JSONArray jArray = new JSONArray(result);
        JSONObject json_data=null;
     String[] tipopregu=new String[jArray.length()];
      String[] tipopcion=new String[jArray.length()];
      String[] id_preguntas=new String[jArray.length()];
      String[] descripcion_opc=new String[jArray.length()];     
    String aux1="";
    String aux2="";
    String aux3="";
    String aux4="";
    String auxtipoopc;
    int cont=1;
    int cont2=0;
    //validate the values not repeteated because 
      for(int i=0;i<jArray.length();i++){

                json_data = jArray.getJSONObject(i);
                //Get DAta
                id_preg =json_data.getString("ID_PREGUNTA");//IS QUESTION ID
                preg = json_data.getString("DESCRIPCION");//DESCRIPTION
               tipopreg=json_data.getString("TIPO_PREGUNTA");   //TYPE OF                               QUESTION
               tipo_opc=json_data.getString("ID_TIPOOPC");//VALUE OF ID TYPE OPTION
               auxtipoopc=tipo_opc;
                descrip_opc=json_data.getString("DESCRIP_OPC");//DESCRIPTION OF VALUES USED IN MULTIPLES VALUES
         if((!aux1.equals(id_preg))||(!aux2.equals(preg))||(!aux3.equals(tipopreg))||(!aux4.equals(tipo_opc)) ){
                id_pregunta=id_preg;
                pregunta=preg;
                tipo_pregunta=tipopreg;
                tipo_opcion=tipo_opc;
                nameValuePairs.add(new list<String, String>(id_pregunta, pregunta));
                id_preguntas[cont2]=id_pregunta;
                tipopregu[cont2]=tipo_pregunta;
                tipopcion[cont2]=tipo_opcion;
                Log.e("id_pregunta", id_pregunta);

                Log.e("pregunta",pregunta);
                    Log.e("id_preg-pregunta", id_pregunta+" "+pregunta);
                    Log.e("tipo_pregunta",tipo_pregunta);

                Log.e("tipo_opc",tipo_opcion);

                cont2=cont2+1;
                Log.e("contador2",String.valueOf(cont2));
         }

                descripcion_opc[i]=descrip_opc;
             nameValuePairs2.add(new list<String, String>(auxtipoopc, descrip_opc));   
             Log.e("Id_tipo_opc--Opcion", auxtipoopc+" "+descrip_opc);  
             aux1=id_preg;
                aux1=preg;
                aux3=tipopreg;
                aux4=tipo_opc;

             cont=cont+1;
          Log.e("contador1",String.valueOf(cont));
        }
     List<NameValuePair> datos = new ArrayList<NameValuePair>();
        datos=nameValuePairs;

    List<EditText> allEds = new ArrayList<EditText>();

    llinear=(LinearLayout) findViewById(R.id.preg);

    final int N=cont2+1;
    final TextView[] tx = new TextView[N];
            int j=0;        
    for (NameValuePair i:nameValuePairs) {

        String id_preguntastr=i.getName();
        String preguntastr=i.getValue();
        String tipopregun=tipopregu[j];
        String id_opcion=tipopcion[j];
        String id_preguntaaux=id_preguntas[j];

        final  TextView rowTextView = new TextView(getBaseContext());
        rowTextView.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
        rowTextView.setText(id_preguntastr+"   "+preguntastr);

        llinear.addView(rowTextView);
        tx[j] = rowTextView;

        if(tipopregun.equals("SI-NO"))// IF QUESTION IS YES/NO
        {
             RadioGroup radiogroup1 = new RadioGroup(getBaseContext());
            final  RadioButton rowradiobuttsi = new RadioButton(getBaseContext());
            rowradiobuttsi.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
            rowradiobuttsi.setText("SI");
            radiogroup1.addView(rowradiobuttsi);
            final  RadioButton rowradiobuttno = new RadioButton(getBaseContext());
            rowradiobuttno.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
            rowradiobuttno.setText("NO");

               radiogroup1.addView(rowradiobuttno);
             llinear.addView(radiogroup1) ; 

        }
        if(tipopregun.equals("Verdadero-Falso"))//IF QUESTION IS TYPE TRUE/FALSE    
        {   
             RadioGroup radiogroup2 = new RadioGroup(getBaseContext());
                final  RadioButton rowradiobuttv = new RadioButton(getBaseContext());
                rowradiobuttv.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
                rowradiobuttv.setText("VERDADERO");
                radiogroup2.addView(rowradiobuttv);
                final  RadioButton rowradiobuttf = new RadioButton(getBaseContext());
                rowradiobuttf.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
                rowradiobuttf.setText("FALSO");

                   radiogroup2.addView(rowradiobuttf);
                 llinear.addView(radiogroup2) ; 
        }

        if(tipopregun.equals("Valor"))  //IF QUESTION IS A VALUE(EDITTEXT)
        {

           //count is number of edittext fields
            final EditText ed = new EditText(getBaseContext());
        ed.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
        allEds.add(ed);

        llinear.addView(ed);

        }

        if(tipopregun.equals("opcionmultiple"))//MULTIPLE OPTIONS (CHECKBOXs)
        {

            for (NameValuePair k:nameValuePairs2) {
                String tipoopcion=k.getName();
                String opcion=k.getValue();

                if(tipoopcion.equalsIgnoreCase("3")){

                final  CheckBox checkboxoptionsm = new CheckBox(getBaseContext());
                checkboxoptionsm.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
                checkboxoptionsm.setText(opcion);
                allChbx.add(checkboxoptionsm);
                llinear.addView(checkboxoptionsm);
                }
            }

                }

        j=j+1;
    }

        }catch(JSONException e4){
            Toast.makeText(getBaseContext(), "Preguntas no Encontrada"+e4, Toast.LENGTH_LONG).show();
             Log.e("fallo", "fallo", e4);
         // Log.e("pairs",nameValuePairs);
        }
        catch(Exception e9){
            Log.e("error", String.valueOf(e9));
        }

   } 
```

对不起，我的英语不好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:54:13.867

您可以重新捕获从用户那里收集的答案，并将它们发送回服务器以使用您在此处使用的 Http 客户端请求和名称值对进行数据库处理。

# iphone - 如何对应用程序进行编程以重新说话？

> ID：13772699
> 
> 赞同：0
> 
> 时间：2012-12-07T23:34:27.530
> 
> 标签：iphone, ios

如何编程应用程序以不同的方式重新说话（音频）

在专家的帮助和指导下可能吗？构建此应用程序的基础是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T04:28:08.307

[在 maniacdev 中](http://maniacdev.com/2011/08/tutorials-how-to-change-pitch-instantenously-without-changing-tempo-like-the-talking-tom-app/)查看本教程。它也有示例项目。可能这就是您要实现的目标。

# android - ACTION_IMAGE_CAPTURE 不调用 onActivityResult？

> ID：13772700
> 
> 赞同：0
> 
> 时间：2012-12-07T23:34:28.733
> 
> 标签：android, android-intent, android-activity

我的 onCreate():

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

         Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);

            imageFile = new File(Environment.getExternalStorageDirectory(),
                    "/image.jpg");

            System.out.println(imageFile +" is the path with extentions");
            outputFileUri = Uri.fromFile(imageFile);
            intent.putExtra(MediaStore.EXTRA_OUTPUT, outputFileUri);
            startActivityForResult(intent, TAKE_PICTURE);

        setContentView(R.layout.activity_head_size);

System.out.println("OnCreate");
    } 
```

显然，这会启动相机并等待它完成并返回图像。完成后，它应该调用

```
 protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        } 
```

但是，在我在相机中点击保存后，它会加载 onCreate 并重新运行相机。然后，如果您重新拍摄图像并点击保存，它将进入活动；但是，不运行 onActivityResult 吗？到底是怎么回事？

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
            if(resultCode == 1){
            myImage = (ImageView) findViewById(R.id.imageView1);

            myBitmap = BitmapFactory.decodeFile( Environment.getExternalStorageDirectory() +
                   "/image.jpg");

             myBitmap = Bitmap.createScaledBitmap(myBitmap, 256, 256, false);
                myImage.setImageBitmap(myBitmap);

                width = myBitmap.getWidth();
                height = myBitmap.getHeight();

                orig = new int[width*height];

                myBitmap.getPixels(orig, 0, width, 0, 0, width, height);

                System.out.println("ready for processing");
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:37:20.993

使用枚举值，而不仅仅是硬编码的 int。

```
if(resultCode == RESULT_OK){ 
```

从文档中，RESULT_OK=-1，您正在寻找 1。此外，我看不到您在哪里检查`requestCode==TAKE_PICTURE`，这也应该是一个预先请求，以确保您响应正确的意图。

# android - OpenCV nMatToBitmap 断言失败

> ID：13772704
> 
> 赞同：10
> 
> 时间：2012-12-07T23:35:12.227
> 
> 标签：android, opencv, android-ndk, java-native-interface

我在使用 OpenCV for Android 中的一些通用函数时遇到以下错误

```
12-05 21:08:55.486: E/cv::error()(6658): OpenCV Error: Assertion failed (src.dims == 2 && info.height == (uint32_t)src.rows && info.width == (uint32_t)src.cols) in void Java_org_opencv_android_Utils_nMatToBitmap2(JNIEnv*, jclass, jlong, jobject, jboolean), file /home/oleg/sources/opencv/modules/java/generator/src/cpp/utils.cpp, line 107
12-05 21:08:55.486: E/org.opencv.android.Utils(6658): nMatToBitmap catched cv::Exception: /home/oleg/sources/opencv/modules/java/generator/src/cpp/utils.cpp:107: error: (-215) src.dims == 2 && info.height == (uint32_t)src.rows && info.width == (uint32_t)src.cols in function void Java_org_opencv_android_Utils_nMatToBitmap2(JNIEnv*, jclass, jlong, jobject, jboolean)
12-05 21:08:55.486: E/CameraBridge(6658): Mat type: Mat [ 144*192*CV_8UC3, isCont=true, isSubmat=false, nativeObj=0x1024c0, dataAddr=0x44783010 ]
12-05 21:08:55.486: E/CameraBridge(6658): Bitmap type: 384*288
12-05 21:08:55.486: E/CameraBridge(6658): Utils.matToBitmap() throws an exception: /home/oleg/sources/opencv/modules/java/generator/src/cpp/utils.cpp:107: error: (-215) src.dims == 2 && info.height == (uint32_t)src.rows && info.width == (uint32_t)src.cols in function void Java_org_opencv_android_Utils_nMatToBitmap2(JNIEnv*, jclass, jlong, jobject, jboolean) 
```

我不确定这是错误本身还是由其他问题引起的。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-08T00:11:03.840

断言错误告诉您以下一项或多项测试失败：

```
src.dims == 2
info.height == (uint32_t)src.rows
info.width == (uint32_t)src.cols 
```

我猜`info`包含目标位图的尺寸。在这种情况下，您的源 Mat 不是二维或目标位图的尺寸与源 Mat 的尺寸不匹配。

这两行

```
12-05 21:08:55.486: E/CameraBridge(6658): Mat type: Mat [ 144*192*CV_8UC3, isCont=true, isSubmat=false, nativeObj=0x1024c0, dataAddr=0x44783010 ]
12-05 21:08:55.486: E/CameraBridge(6658): Bitmap type: 384*288 
```

建议您的 Mat 是 144x192，而您的位图是 384x288。看起来一个是纵向的，另一个是横向的，加上您的位图是 Mat 分辨率的两倍。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-07-12T08:45:25.360

我没有足够的代表发表评论，所以我将提供一个答案：

使用 'onCameraFrame' 方法时 - 如果您返回的 'mat' 与用于显示输出的帧的大小不匹配，则会引发此断言。

换句话说 - 如果您正在调整大小以进行某种处理，请确保在将其放回显示器之前将其恢复为原始大小。

```
@Override
public Mat onCameraFrame(CameraBridgeViewBase.CvCameraViewFrame 
inputFrame) {
    mRgba = inputFrame.rgba();

    Mat resizeImage = new Mat();
    Size sz = new Size(800, 600); // Scale up to 800x600
    Imgproc.resize(mRgba, resizeImage, sz);

    // Do some sort of processing here on resized image.

    Mat afterResize = new Mat();
    Size szAfter = new Size(640, 480); // Scale back down to 640x480 (original dim.)
    Imgproc.resize(resizeImage, afterResize, szAfter);

    return afterResize;
} 
```

# iphone - 目标 C 中不常用的符号

> ID：13772705
> 
> 赞同：1
> 
> 时间：2012-12-07T23:35:26.317
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我最近在一个 Xcode 项目中遇到了一些我以前没有注意到的符号。

什么是

> `@{some_value}`和
> 
> `@[some_value]`

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:37:02.510

这些是 ObjC 集合文字。文档在这里：[http ://clang.llvm.org/docs/ObjectiveCLiterals.html](http://clang.llvm.org/docs/ObjectiveCLiterals.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:48:14.780

它应该是`@{key:value}`表示具有键和值的字典。`@[some_value]`应该是一个数组。如另一个答案中所述，请查看[Objective C Literals](http://clang.llvm.org/docs/ObjectiveCLiterals.html)以获取更多详细信息。

从那个链接一个例子是，

```
NSDictionary *dictionary = @{
    @"name" : @"some name",
    @"date" : [NSDate date],
    @"processInfo" : [NSProcessInfo processInfo]
};

NSArray *array = @[ @"Hello", NSApp, @42]]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T03:01:13.660

这些是 Objective-C 的“快捷方式”，可让您快速创建 NSArray 或 NSDictionary。

我可以说

```
NSArray *myArray = @[@"My Object", @"My Second Object", @"My Third Object"]; 
```

事实上，@"" 表示法是相同的，因为它允许您快速创建一个 NSString。

@{}：

```
NSDictionary *myDict = @{@"My Object" : @"My Key", @"My Second Object", @"My Second Key"}; 
```

对于懒惰的开发人员来说，这是一种快速的方法，可以避免实际打字这一明显艰巨的任务`[[... alloc] init...]`

# mongodb - 如何从 ObjectID 中获取字符串以用作 URL slug？

> ID：13772706
> 
> 赞同：0
> 
> 时间：2012-12-07T23:35:30.987
> 
> 标签：mongodb, tornado, pymongo

新手来了 我正在使用 Tornado 和 PyMongo，我试图从 ObjectId 中取出字符串，以便我可以这样做：

```
<p><a href="/edit/{{ **object ID string** }}">Edit</a></p> 
```

从

```
"_id": {
        "$oid": "50c26c91efbdd2ebb88da37c"
    }, 
```

另外，这是一个好/坏主意吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:11:05.773

Python`str`函数将 an 转换`ObjectId`为字符串：

```
o = ObjectId()
print(str(o)) 
```

输出

```
50c2852fa6165435b11ed7d7 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T21:29:26.243

在阅读了 Mongoengine 文档后，我发现对于他们的`{_id: {$oid: ''}}`方案，他们有一个名为“id”的字段。所以我需要：

```
<a href="/edit/{{ doc['id'] }}"> 
```

# php - 如何使用 JavaScript 输出大的 HTML 块？

> ID：13772709
> 
> 赞同：0
> 
> 时间：2012-12-07T23:35:32.463
> 
> 标签：php, javascript, html, jwplayer

大家好，我正在尝试输出一个包含打开和关闭 javascript 标签的大型 html 块。包含的 javascript 是一个 jw 播放器脚本，它与 javascript 动态变量**+url**和 php 变量**$Title**混合。我尝试了 document.write 但播放器没有出现在浏览器中！而是输出了 document.write 语句的一部分！你们能帮我解决这个问题吗？提前致谢。

```
document.write("<html>");
document.write("<head>");
document.write("<meta http-equiv="Content-Type" content="text/html; charset=utf-8">");
document.write("</head>");
document.write("<br>");

document.write("Title:<?php echo $Title;?> <script type='text/javascript' src='./jwplayer.js'></script>");

document.write("<div id='mediaspace'>This text will be replaced</div>");
document.write("<script type='text/javascript'>");
document.write(" jwplayer('mediaspace').setup({");
document.write("'flashplayer': './player.swf',");

document.write("'file': + url,");

document.write("'autostart': 'true',");
document.write("'controlbar': 'bottom',");
document.write("'width': '470',");
document.write("'height': '320'");
document.write("});");
document.write("</script>");
document.write("</html>"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:39:38.687

用 JavaScript 写入文档的 PHP 将无法运行。PHP在浏览器接收文档*之前进行评估。*JavaScript*在*.

至于在`<script>`不破坏当前脚本的情况下动态写出元素，一种选择是转义正斜杠，即

```
document.write("<\/script>"); 
```

但是，JS 是否有理由输出这段代码？除了上面的问题，`document.write`有点过时了，写脚本的时候可能会出问题。托管一个 PHP 页面会更干净，例如：

```
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  </head>
  <body>
    Title: <?php echo $Title;?>

    <script type='text/javascript' src='./jwplayer.js'></script>

    <div id='mediaspace'>This text will be replaced</div>

    <script type='text/javascript'>

      jwplayer('mediaspace').setup({
        'flashplayer': './player.swf',
        'file': url,// assumes 'url' exists in the global namespace!
        'autostart': 'true',
        'controlbar': 'bottom',
        'width': '470',
        'height': '320'
       });

    </script>

  </body>
</html> 
```

添加了注释`<body>`标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T00:01:53.267

不确定您要做什么，但`document.getElementById("idtag").innerHTML = "Data";`会用所选 id 填充元素标签之间的内容。

例子：

```
<div id="dataplaceholder"></div>
<script type="text/javascript">
    document.getElementById("dataplaceholder").innerHTML = "<h2>Hello World!</h2>";
</script> 
```

# r - 使用 ctree 显示每个节点的体积，在 R 中绘图

> ID：13772715
> 
> 赞同：2
> 
> 时间：2012-12-07T23:36:07.827
> 
> 标签：r, model, data-mining

谁能告诉我如何在每个节点中添加音量，而不是最终节点音量

```
t <- ctree(is_return ~ a + b + c)    
plot(t, type="simple") 
```

我的树看起来像

![在此处输入图像描述](../Images/63e35d83fd70c9af4ba1b2378743f7c8.png)

我如何修改该图，它将在每个圆形节点上显示 N= ，而不仅仅是黑色或最终节点。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T03:24:06.593

![在此处输入图像描述](../Images/786b786a8b245fec659306f94ba92a1d.png)

这个想法是指定一个面板函数来绘制内部节点。

我生成了一些数据，然后树

```
lls <- data.frame(N = gl(3, 50, labels = c("A", "B", "C")), 
                  a = rnorm(150) + rep(c(1, 0,150)),
                  b = runif(150))
pond= sample(1:5,150,replace=TRUE)
tt <- ctree(formula=N~a+b, data=lls,weights = pond) 
```

自定义内部绘图功能。我画了一个圆圈，我写了一些权重。

```
innerWeights <- function(node){
  grid.circle(gp = gpar(fill = "White", col = 1))
  mainlab <- paste( node$psplit$variableName, "\n(n = ")
  mainlab <- paste(mainlab, sum(node$weights),")" , sep = "")
  grid.text(mainlab,gp = gpar(col='red'))
} 
```

我画树

```
plot(tt, type='simple', inner_panel = innerWeights) 
```

PS：结果取决于随机生成的数据，因此您可能不会得到相同的图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-05T13:37:43.373

导出决策树时，更改图像的尺寸。对于具有 200 个终端节点的决策树，宽度应约为 30.000。

# php - 意外的“静态”（T_STATIC），需要标识符（T_STRING）

> ID：13772717
> 
> 赞同：-2
> 
> 时间：2012-12-07T23:36:10.860
> 
> 标签：php, parent

我尝试将一个函数作为父函数，但出现此错误：

```
unexpected 'static' (T_STATIC), expecting identifier (T_STRING) 
```

我有 PHP v5.4.7 这是代码

```
public function static tableExist($table, $db)
    {
        $tables = mysql_exists($db);
            while(list($temp) = mysql_fetch_array($name, $pass))
            {
                if($temp = $table)
                {
                    return TRUE;
                }
                else
                {
                    return FALSE;
                }
            }

    } 
```

和用法

```
if(register::tableExist(users, webshop));
                {
                    echo "succes";
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:38:03.260

尝试`public static function tableExist`

编辑：你有具体的线路参考吗？

# jquery - 核心五实验室 Filemanager 添加延迟加载

> ID：13772722
> 
> 赞同：1
> 
> 时间：2012-12-07T23:36:42.163
> 
> 标签：jquery, image-processing, coldfusion, file-manager

我们已经成功使用[Core 5 文件管理器](http://labs.corefive.com/projects/filemanager/)实用程序有一段时间了，但是一旦我们的目录开始积累 100 张图像，它就开始变慢，这对我们的 IE 用户来说非常严重。我现在正在尝试破解延迟加载，但非常不成功。

这是有问题的块：

```
// Retrieve the data and generate the markup.
$.getJSON(fileConnector + '?path=' + path + '&mode=getfolder&getsizes=false&showThumbs=' + showThumbs, function(data){      
    var result = '';

    if(data){
        if(data['Code'] && data['Code'] != 0)
        {
            result = "<div style='text-align:center;color:red;'>An error occured:<br \/>" + data['Error'] + "<\/div>";
            // $.prompt(data['Error']);
        } else
        {
            var key = '';
            if($('#fileinfo').data('view') == 'grid'){
                result += '<ul id="contents" class="grid">';

                for(key in data){
                    var props = data[key]['Properties'];
                    if (props)
                    {
                        var scaledWidth = 64;
                        var actualWidth = props['Width'];
                        if(actualWidth > 1 && actualWidth < scaledWidth) scaledWidth = actualWidth;

                        result += '<li class="' + (data[key]["File Type"] == 'dir' ? 'directory':'file') + '">'+
                         '<div class="clip"><img src="' + data[key]['Preview'] + '" width="' + scaledWidth + '" alt="' + data[key]['VisiblePath'] + '" /></div><p>' + data[key]['Filename'] + '</p>';
                        if(props['Width'] && props['Width'] != '') result += '<span class="meta dimensions">' + props['Width'] + 'x' + props['Height'] + '</span>';
                        if(props['Size'] && props['Size'] != '') result += '<span class="meta size">' + props['Size'] + '</span>';
                        if(props['Date Created'] && props['Date Created'] != '') result += '<span class="meta created">' + props['Date Created'] + '</span>';
                        if(props['Date Modified'] && props['Date Modified'] != '') result += '<span class="meta modified">' + props['Date Modified'] + '</span>';
                        result += '</li>';
                    }
                }
                result += '</ul>';
                if (key=='')
                {
                    result = '<div style="margin-top:40px;text-align:center;"><em>No files found</em></div>';
                }
            } else {
                result += '<table id="contents" class="list">';
                result += '<thead><tr><th class="headerSortDown"><span>Name</span></th><th><span>Dimensions</span></th><th><span>Size</span></th><th><span>Modified</span></th></tr></thead>';
                result += '<tbody>';

                for(key in data){
                    var path = data[key]['VisiblePath'];
                    var props = data[key]['Properties'];
                    if (props)
                    {
                        result += '<tr class="' + (data[key]["File Type"] == 'dir' ? 'directory':'file') + '">';
                        result += '<td title="' + path + '">' + data[key]['Filename'] + '</td>';

                        if(props['Width'] && props['Width'] != ''){
                            result += ('<td>' + props['Width'] + 'x' + props['Height'] + '</td>');
                        } else {
                            result += '<td></td>';
                        }

                        if(props['Size'] && props['Size'] != ''){
                            result += '<td><abbr title="' + props['Size'] + '">' + formatBytes(props['Size']) + '</abbr></td>';
                        } else {
                            result += '<td></td>';
                        }

                        if(props['Date Modified'] && props['Date Modified'] != ''){
                            result += '<td>' + props['Date Modified'] + '</td>';
                        } else {
                            result += '<td></td>';
                        }

                        result += '</tr>';
                    }
                }
                if (key=='')
                {
                    result += '<tr><td colspan="4" style="text-align:center"><em>No files found</em></td></tr>';
                }

                result += '</tbody>';
                result += '</table>';
            }
        }
    } else {
        result += '<h1>Could not retrieve folder contents.</h1>';
    }

    // Add the new markup to the DOM.
    $('#fileinfo').html(result); 
```

json 请求命中一个coldfusion 函数，该函数使用cfdirectory 标记构建返回给调用者的数据结构

```
<cffunction name="_getDirectoryInfo" returntype="array" access="private">
    <cfargument name="path" type="string" required="yes" />
    <cfargument name="getsizes" type="boolean" required="yes" />
    <cfargument name="filter" type="string" required="no" default="" />
    <cfset var dirlist_qry = "" />
    <cfset var data_arr = arrayNew(1) />
    <cfset var currData_struct = "" />
    <cfset var imageData_struct = "" />
    <cfset var dirPath = (arguments.path) />
    <cfset var webDirPath = _getWebPath(dirPath) />
    <cfset var displayWebPath = _getWebPath(path=dirPath, includeUploadRoot=false) />

    <cfif not DirectoryExists(dirPath)>
        <cfdirectory action="create" directory="#dirPath#"> 
        <!--- no longer required, we will auto create the directory
        <cfset returnError(translate('DIRECTORY_NOT_EXIST', dirPath)) />
        --->
    </cfif>

    <cftry>
        <cfdirectory action="list" directory="#dirPath#" name="dirlist_qry" sort="type,name" filter="#arguments.filter#" />
        <cfcatch>
            <cfset returnError(translate('UNABLE_TO_OPEN_DIRECTORY', arguments.path, cfcatch.message & " - " & cfcatch.detail)) />
        </cfcatch>
    </cftry>

    <cfloop query="dirlist_qry"><cfif find('.', dirlist_qry.name) neq 1>
        <cfset currData_struct = structNew() />
        <cfset arrayAppend(data_arr, currData_struct) />

        <cfset structInsert(currData_struct, "Filename", dirlist_qry.name) />
        <cfset structInsert(currData_struct, "Error", "") />
        <cfset structInsert(currData_struct, "Code", 0) />
        <cfset structInsert(currData_struct, "Properties", structNew()) />
            <cfset structInsert(currData_struct.Properties, "Date Created", "") />
            <cfset structInsert(currData_struct.Properties, "Date Modified", "#lsdateformat(dateLastModified, 'medium')# #timeformat(dateLastModified, 'HH:mm:ss')#") />
            <cfset structInsert(currData_struct.Properties, "Height", "") />
            <cfset structInsert(currData_struct.Properties, "Width", "") />
        <cfif dirlist_qry.type eq "DIR">
            <cfset structInsert(currData_struct, "Path", webDirPath & dirlist_qry.name & "/") />
            <cfset structInsert(currData_struct, "VisiblePath", displayWebPath & dirlist_qry.name & "/") />
            <cfset structInsert(currData_struct, "File Type", "dir") />
            <cfset structInsert(currData_struct, "Preview", request.directoryIcon) />
            <cfset structInsert(currData_struct.Properties, "Size", "") />
        <cfelse>
            <cfset structInsert(currData_struct, "Path", webDirPath & dirlist_qry.name) />
            <cfset structInsert(currData_struct, "VisiblePath", displayWebPath & dirlist_qry.name) />
            <cfset structInsert(currData_struct, "File Type", lCase(listlast(dirlist_qry.name, '.'))) />
            <cfset structInsert(currData_struct.Properties, "Size", dirlist_qry.size) />
            <cfif _isImage(dirlist_qry.name)>
                <cfset structInsert(currData_struct, "Preview", webDirPath & dirlist_qry.name) />
                <cfif arguments.getsizes>
                    <cfset imageData_struct = _getImageInfo(dirlist_qry.directory & variables.separator & dirlist_qry.name) />
                    <cfset structInsert(currData_struct.Properties, "Height", imageData_struct.height, true) />
                    <cfset structInsert(currData_struct.Properties, "Width", imageData_struct.width, true) />
                </cfif>
            <cfelse>
                <cfset structInsert(currData_struct, "Preview", request.defaultIcon) />
            </cfif>
        </cfif>
    </cfif></cfloop>

    <cfreturn data_arr />
</cffunction> 
```

经过广泛的研究，我找不到一种方法来设置开始/结束呼叫而不会导致更慢。我知道我不能成为唯一处理过这个问题的人，所以我想发布这个想法。我尝试的每个分页插件都无法正常工作，因为 core5 是如何设置的，即使这样，cfdi​​rectory 结构过程也可能需要很长时间。祝大家节日快乐。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:12:34.347

您的文件是否存储在 Windows 操作系统中？如果是这样，您是嵌套目录还是所有图像都存储在中央目录中？我发现当它只是一个包含所有文件的单独目录时，速度会随着时间的推移而蔓延。

以基于日期的约定存储文件，例如。/年月日

# java - 如何减慢人工智能的速度？

> ID：13772733
> 
> 赞同：1
> 
> 时间：2012-12-07T23:38:20.930
> 
> 标签：java, android, artificial-intelligence, slowdown

因此，我正在为 android 编写一个应用程序，您可以在其中玩类似于 Dutch Blitz 的游戏。这是一个非常简单的游戏，我已经基本完成了，我主要是在寻找如何处理我的 AI 对手的建议，现在他们在大约 2 秒内赢得了比赛，我想知道我应该怎么做才能让他们“暂停”中间循环或如何减慢它们的速度，以便用户有机会真正获胜。

我只是不希望我的方式根据所用手机的处理器速度减慢它们的速度......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:47:06.483

我不熟悉游戏荷兰闪电战，但这个逻辑应该适用。您可以创建由[倒数计时器](http://developer.android.com/reference/android/os/CountDownTimer.html)触发的转弯功能。重复该功能（将其视为一个回合）最终将等同于获胜条件。导致你的人工智能最终流行，但不是马上。然后，您可以设置转弯发生的频率，从而控制您的 AI 获胜的频率。此外，这可以通过增加 AI 完成转弯所需的时间来轻松设置难度级别。

您的游戏可能使用不同的规则，但每回合的某种间隔可能是控制 AI 速度的简单方法。

# unix - 文件系统挂载内部

> ID：13772744
> 
> 赞同：0
> 
> 时间：2012-12-07T23:39:24.993
> 
> 标签：unix, filesystems, mount

当我使用以下命令在 UNIX 上挂载文件系统时，内部会发生什么：

```
mount -t ext3 /dev/sda1 /home/users 
```

请提供参考资料（文章、书籍等）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T01:39:05.890

考虑你的立场：你想读这个吗？你能读懂这个吗？ [http://freebsd.active-venture.com/FreeBSD-srctree/newsrc/ufs/ffs/ffs_softdep.c.html](http://freebsd.active-venture.com/FreeBSD-srctree/newsrc/ufs/ffs/ffs_softdep.c.html)

它是 McKusick 的 ffs 文件系统的基本代码，通常被认为是现代 UNIX 文件系统的父代。没有比阅读源代码更详细的了。

我发帖的原因：很久以前我教这个东西的时候，有一段文字，然后我给出了示例代码。学生们似乎从中得到了很多……更准确地说，是那些真正研究过这些材料的人。

在这种情况下，ffs.c 代码是一种事实上的模型。因此，它提供了我们如何从那里到这里的方式。

现在你需要做的就是得到这个： [http ://www.amazon.com/Linux-Device-Drivers-Jonathan-Corbet/dp/0596005903/ref=sr_1_1?s=books&ie=UTF8&qid=1354930353&sr=1-1&keywords= linux+驱动](https://rads.stackoverflow.com/amzn/click/com/0596005903)

然后最终下载 ext3 的代码。并阅读它。

# assembly - 错误 1 错误 A1000：无法打开文件：\masm32\includes\masm32rt.inc

> ID：13772748
> 
> 赞同：1
> 
> 时间：2012-12-07T23:39:47.437
> 
> 标签：assembly, visual-studio-2012, masm, masm32

我正在尝试在 VS2012 中设置一个汇编程序，但每当`include masm32\includes\masm32rt.inc`被调用时，它都会返回该错误。

如果我使用绝对路径，它可以工作，但所有包含都`masm32\includes\`用作它们的 incudepath。

有没有办法在环境变量上设置 \masm32 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T16:26:51.350

MASM32**不是**Visual Studio 的一部分，MASM 是。

如果您在一个驱动器上安装了 MASM32，但您的项目/源在另一个驱动器上，那么相对路径如何工作？？？？即`include masm32\includes` 如果是这种情况，那么你必须使用绝对路径，即`D:\masm32\includes\masm32rt.inc`

我不使用VS，但它应该有一个设置包含路径的选项，然后它将这个路径传递给ml的命令行以搜索包含。

# c# - OneWayToSource 绑定重置目标值

> ID：13772749
> 
> 赞同：3
> 
> 时间：2012-12-07T23:39:48.490
> 
> 标签：c#, wpf, binding

为什么 OneWayToSource 绑定会重置我的目标值？这是绑定代码：

```
SolidColorBrush brush = GetTemplateChild("PART_PreviewBrush") as SolidColorBrush;
            if (brush != null)
            {
                Binding binding = new Binding("Color");
                binding.Source = brush;
                binding.Mode = BindingMode.OneWayToSource;
                this.SetBinding(ColorPicker.ColorProperty, binding);
            } 
```

我在 xaml 中设置了“颜色”依赖属性。但它会被绑定覆盖。之后绑定工作正常。所以，基本上我的问题是：我不能给“颜色”属性一个起始值，因为它被绑定覆盖了。

编辑：

我做了一个解决问题的解决方法，但仍然不明白为什么 OneWayToSource 会这样：

```
System.Windows.Media.Color CurrentColor = this.Color;
                this.SetBinding(ColorPicker.ColorProperty, binding);
                this.Color = CurrentColor; 
```

编辑2：

找到了一个可能的解决方案：我必须设置：

```
binding.FallbackValue = this.Color; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T12:49:41.820

您可以使用[BindingOperations](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingoperations.aspx)类来设置绑定：

```
BindingOperations.SetBinding(
    brush, SolidColorBrush.ColorProperty, new Binding("Color") { Source = this }); 
```

# python - 当没有更多对象附加到它们时，如何删除 django-taggit 标签？

> ID：13772750
> 
> 赞同：2
> 
> 时间：2012-12-07T23:39:55.363
> 
> 标签：python, django, django-taggit

我认为标题说明了这一点。许多标签被创建和删除，但即使没有更多对象使用它们，它们仍然存在。

有没有办法让它检查保存和删除未使用的标签？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:55:21.133

我能想到的唯一技术是将自定义`pre_delete`信号处理程序附加到每个可标记模型，以检查它是否是具有任何特定标记的最后一个模型。如果是，请删除该标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T00:08:45.297

如果您愿意编辑包代码，则可以使用此处答案中定义的 post_delete 信号处理程序：

[删除未被任何其他对象使用的标签](https://stackoverflow.com/questions/13795878/deleting-the-tags-that-are-not-used?answertab=oldest#tab-top)

# gem - JRuby + Warbler：每当需要 bson gem 时，jar 文件就会爆炸

> ID：13772752
> 
> 赞同：6
> 
> 时间：2012-12-07T23:40:20.847
> 
> 标签：gem, jruby, bson, warbler

我想我可能在 Warbler 中发现了一个错误，但我想在这里发布这个问题，以防我做错了什么。简而言之，任何尝试将需要“bson”gem 的 jruby 应用程序打包成带有 warbler 的 .jar 文件的尝试都会失败。这是我每次得到的错误：

```
LoadError: no such file to load -- jar:file:/Users/jstokes/Local/Repositories/wartest/wartest.jar!/gems/bson-1.8.0-java/lib/../ext/java/jar/mongo-2.6.5 ... 
```

这是在 OS X 或 Linux 上重现问题的一组非常简单的步骤：

制作一个 'wartest' 目录并 cd 进入它

使用 bundler，制作一个名为 'wartest' 的新 jruby-1.6.7.2 gemset。然后做'rvm使用jruby-1.6.7.2@wartest'

安装莺和捆绑器：

```
jruby --1.9 -S gem install warbler
jruby --1.9 -S gem install bundler 
```

只是为了确认它有效：

```
which warble
#=> /Users/jstokes/.rvm/gems/jruby-1.6.7.2@wartest/bin/warble 
```

现在创建以下两行 Gemfile：

```
#Gemfile
source 'http://rubygems.org'
gem 'bson' 
```

现在'捆绑安装'

现在创建一个 bin 目录并创建文件 bin/main.rb。然后粘贴以下内容：

```
#bin/main.rb
require 'bson'
puts 'It worked!' 
```

此时，我们已准备好创建 jar 文件。也一样

```
jruby --1.9 -S warble jar
#=> rm -f wartest.jar
#=> Creating wartest.jar 
```

现在是关键时刻：

```
java -jar wartest.jar
#=> It worked! 
```

所以有什么问题？问题是，如果您更改为另一个 gemset，或使用系统 ruby​​，它会爆炸。观察：

```
rvm use system
#=> Now using system ruby.
java -jar wartest.jar 
```

```
LoadError：没有要加载的文件--jar:file:/Users/jstokes/Local/Repositories/wartest/wartest.jar!/gems/bson-1.8.0-java/lib/../ext/java/jar/ mongo-2.6.5
  需要在 org/jruby/RubyKernel.java:1027
  需要在 jar:file:/var/folders/xr/nmvhn6x566v6xkw9l7pgpkj40000gn/T/jruby5567740032767770706extract/jruby-stdlib-1.7.1.jar!/META-INF/jruby.home/lib/ruby/shared/rubygems/custom_require.rb: 36
   （根）在 jar:file:/Users/jstokes/Local/Repositories/wartest/wartest.jar!/gems/bson-1.8.0-java/lib/bson.rb:53
  需要在 org/jruby/RubyKernel.java:1027
   （根）在 jar:file:/var/folders/xr/nmvhn6x566v6xkw9l7pgpkj40000gn/T/jruby5567740032767770706extract/jruby-stdlib-1.7.1.jar!/META-INF/jruby.home/lib/ruby/shared/rubygems/custom_require。 RB:1
  需要在 jar:file:/var/folders/xr/nmvhn6x566v6xkw9l7pgpkj40000gn/T/jruby5567740032767770706extract/jruby-stdlib-1.7.1.jar!/META-INF/jruby.home/lib/ruby/shared/rubygems/custom_require.rb: 60
     在 org/jruby/RubyKernel.java:1046 加载
   （根）在文件：/Users/jstokes/Local/Repositories/wartest/wartest.jar！/wartest/bin/main.rb:1
  需要在 org/jruby/RubyKernel.java:1027
   （根）在文件：/Users/jstokes/Local/Repositories/wartest/wartest.jar！/META-INF/main.rb:1
   （根）在文件：/Users/jstokes/Local/Repositories/wartest/wartest.jar！/META-INF/main.rb:1

```

如果我回去 jar xf wartest.jar，并进入 gems/bson-1.8.0-java 目录，mongo-2.6.5.jar 文件存在并且在正确的位置。但由于某种疯狂的原因，它就是找不到。在 Ubuntu 和 OS X 上每次都会发生这种情况。如果有人知道我做错了什么，请告诉我。否则我会提交错误报告。

如果我提交错误报告，这是谁的错误？我认为这是一个莺虫错误，但除了 bson（和依赖于 bson 的 mongo）之外，我没有看到它与任何其他 gem 一起出现。

# objective-c - 将地图居中到可见区域

> ID：13772767
> 
> 赞同：1
> 
> 时间：2012-12-07T23:42:41.620
> 
> 标签：objective-c, ios, uitableview, mkmapview, mapkit

在我的应用程序中，我将 MKMapView 添加为 UITableView 之上的视图。MapView 的高度为 250，可见区域为 80。每当找到一个位置时，我想将该位置（注释）居中在可见区域中，即 MapView 的底部 80px。

这是我到目前为止所拥有的：[https ://dl.dropbox.com/u/3077127/MapViewDemo.mov](https://dl.dropbox.com/u/3077127/MapViewDemo.mov)

我尝试了很多不同的东西，但我找不到解决方案。我删除了我现在测试过的东西。这是我的代码：

```
float kMapHeaderHeight = 250.0f;
float kMapContentInset = 80.0f;
BOOL favFirstPositionFound = NO;

- (void)viewDidLoad {
    [super viewDidLoad];
    [self setTitle:NSLocalizedString(@"Favorites", @"FavoritesViewController")];

    // Set up the edit and add buttons.
    self.navigationItem.leftBarButtonItem = self.editButtonItem;

    self.mapView = [[MKMapView alloc] initWithFrame:CGRectMake(0, -kMapHeaderHeight, self.tableView.frame.size.width, kMapHeaderHeight)];
    [self.mapView setShowsUserLocation:YES];
    [self.mapView setDelegate:self];
    [self.mapView setUserInteractionEnabled:NO];

    [self.tableView addSubview:self.mapView];

    self.tableView.contentInset = UIEdgeInsetsMake(kMapContentInset, 0.0f, 0.0f, 0.0f);
}
- (void)scrollViewDidScroll:(UIScrollView *)scrollView{
    if (scrollView.isDragging) {
        if (self.tableView.contentOffset.y < kMapContentInset-((self.view.bounds.size.height/3)*2))
        {
            NSLog(@"Far enough!");
        }
    }
}
[...]
- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation{
    location=newLocation.coordinate;

    MKCoordinateRegion region;
    region.center=location;

    MKCoordinateSpan span;

    if (!favFirstPositionFound)
    {
        span.latitudeDelta=.010;
        span.longitudeDelta=.010;
    }
    else {
        span.latitudeDelta = self.mapView.region.span.latitudeDelta;
        span.longitudeDelta = self.mapView.region.span.longitudeDelta;
    }

    region.span=span;

    favFirstPositionFound = YES;
    [self.mapView setRegion:region animated:YES];

    [self.locationManager stopUpdatingLocation];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T17:59:38.160

好吧，这需要一段时间......但我自己想通了。

我现在要做的是使用当前位置，`CLLocationCoordinate2D`并从中获取相应的地图点。然后我使用地图可见矩形的宽度和高度来调整定位。

[https://dl.dropbox.com/u/3077127/MapViewDemoResult.mov](https://dl.dropbox.com/u/3077127/MapViewDemoResult.mov)

代码还没有重构，因为我刚刚找到了解决方案……但你可以自己做；）

最终结果：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView{
    float offset = fabs(self.tableView.contentOffset.y);
    float diff = (1.0 - ((offset/2) / kMapHeaderHeight));

    MKMapRect r = [self.mapView visibleMapRect];
    MKMapPoint pt = MKMapPointForCoordinate(location);

    r.origin.x = pt.x - r.size.width * 0.50;
    r.origin.y = pt.y - r.size.height * diff;
    [self.mapView setVisibleMapRect:r animated:NO];

    MKCoordinateRegion region = self.mapView.region;

    MKCoordinateSpan span;
    span.latitudeDelta=.010;
    span.longitudeDelta=.010;

    region.span=span;

    [self.mapView setRegion:region animated:NO];

    if (scrollView.isDragging) {
        if (self.tableView.contentOffset.y < kMapContentInset-((self.view.bounds.size.height/3)*2))
        {
            NSLog(@"Halfway there!");
        }
    }
} 
```

# iphone - 随机敌人生成

> ID：13772768
> 
> 赞同：0
> 
> 时间：2012-12-07T23:42:51.137
> 
> 标签：iphone, objective-c, ios, xcode, ipad

我有一个使用相机视图的游戏，并且有敌人在屏幕上飞来飞去。然后，您使用您选择的武器射击敌人。目前我有 4 个 UIImageView，其中的敌人是动画的。我想在屏幕上显示每个敌人的多个实例（有 4 个），并且随着时间的推移产生更多。做这个的最好方式是什么？

这是使用陀螺仪移动一个敌人的代码的一部分：（enemyCyborg 是 UIImageView）

```
valueX4 = gyroData.rotationRate.y* 30;
         valueY4 = gyroData.rotationRate.x* 40;

         int newX4 = (int)(enemyCyborg.center.x +valueY4);
         int newY4 = (int)(enemyCyborg.center.y -valueX4);

         CGPoint newCenter4 = CGPointMake(newX4, newY4);

         enemyCyborg.center = newCenter4; 
```

他们在其中随机移动：

```
- (void) moveCyborg {

[UIView animateWithDuration:1.0f animations:^{
    int fromNumber = -30;
    int toNumber = 60;
    int randomNumber = (arc4random()%(toNumber-fromNumber))+fromNumber;
    //Move the image view to 100, 100 over 10 seconds.
    enemyCyborg.frame = CGRectMake((int)(enemyCyborg.center.x -randomNumber), (int)(enemyCyborg.center.y -randomNumber), enemyCyborg.frame.size.width, enemyCyborg.frame.size.height);
}];
} 
```

这再次显示了 UIImageView，在它被隐藏后拍摄它：

```
- (void) showCyborg {

enemyCyborg.hidden = NO;
enemyCyborg.center = CGPointMake((arc4random()%SCREEN_HEIGHT),(arc4random()%SCREEN_WIDTH));
enemyCyborg.animationImages  = cyborganim;
enemyCyborg.animationDuration = 0.6;
enemyCyborg.animationRepeatCount = 0;
[enemyCyborg startAnimating];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:50:43.230

您需要创建封装敌人模型的对象，并使用某种敌人生成器函数生成这些对象。这个生成器函数可以写成一个类函数。

以下是一些一般性建议：

1）您正在使用基于块的动画方法。块是一个很好的方法，但取决于你的表现和敌人的数量以及你计划添加的其他视觉元素，你可能想要考虑使用[Cocos2d](http://www.cocos2d-iphone.org/)，它为你提供了各种功能。Ray Wenderlich 发表了一篇很棒的 cocos2d 教程介绍，可以帮助您快速上手。链接到[这里](http://www.raywenderlich.com/25736/how-to-make-a-simple-iphone-game-with-cocos2d-2-x-tutorial)。许多 iPhone 游戏都是使用 cocos2d 或 Unity 编写的。

2)如果您还没有这样做，请查看[https://gamedev.stackexchange.com/以获取更多基本示例。](https://gamedev.stackexchange.com/)

# mysql - SQL更新具有相同值的多行

> ID：13772770
> 
> 赞同：11
> 
> 时间：2012-12-07T23:42:58.180
> 
> 标签：mysql, sql

我用它来更新（添加点）`mgroup`行`15`

```
UPDATE ibf_members SET points = points + 500 WHERE mgroup = 15 
```

`id`对于具有as `5`、`7`、`10`、`11`、*和*as的行`16`，我可以使用什么来更新（加分 + 500）？`25` *`mgroup``15`*

 ** * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-07T23:44:22.020

您可以为此使用该`IN`子句，这比构建一个巨大的`OR`列表更容易阅读（并且可能更有效？）。尝试类似：

```
UPDATE ibf_members
SET points = points + 500
WHERE mgroup = 15
AND id IN (5, 7, 10, 11, 16, 25); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:45:10.530

只需在 WHERE 子句中添加另一个条件：

```
UPDATE ibf_members SET points = points + 500 WHERE mgroup = 15 AND id IN (5, 7, 10, 11, 16, 25) 
```*

# php - 在 Yii 中使用 GetText

> ID：13772779
> 
> 赞同：1
> 
> 时间：2012-12-07T23:43:40.167
> 
> 标签：php, yii, internationalization, gettext

我使用 Yii 的*CPhpMessageSource*进行消息翻译。但是我不想将它用于我的新项目。因为我会将源文件提供给翻译人员，而我不想给他.php 文件进行翻译。他不是开发人员，可能会破坏文件的语法:)

因此，我可以将*gettext*用于翻译消息。所以，我可以给*.mo*，*.po*文件，他可以用*PoEdit*应用程序翻译它们。这种方式对他来说更容易。

我第一次使用 gettext 。对于*CPhpMessageSource*，我基本上是在执行`yiic message`命令并且它正在生成`protected/messages/lang/category.php`文件。但是对于 gettext，我如何创建*.po*文件？我如何指出 Yii 使用该*.po*文件？

有一个“gettext”扩展名，但我不明白。没有内置的 gettext 支持吗？我为什么要安装那个扩展？如果可能的话，我不想使用第 3 方扩展。

**额外的**

我阅读[了这个](https://stackoverflow.com/questions/6735670/how-can-i-configure-yii-i18n-feature-to-use-gettext)问题和答案，但我对下一步没有任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T16:04:10.943

Yii 有[CGettextMessageSource](http://www.yiiframework.com/doc/api/1.1/CGettextMessageSource)来处理 GetText，但`yiic message`它只针对 CPhpMessageSource。

该扩展不使用 CGettextMessageSource，而是使用 php 内置的[gettext](http://php.net/gettext)，因此使用内置函数如[_() / gettext()](http://php.net/manual/en/function.gettext.php)，像[poedit](http://www.poedit.net/)这样的软件可以扫描 php 文件并生成 MO 或 PO 文件你。

# java - 多线程的空指针异常

> ID：13772780
> 
> 赞同：1
> 
> 时间：2012-12-07T23:43:41.820
> 
> 标签：java, multithreading

我的程序是使用多线程来完成康威的人生游戏。我不断收到错误`Exception in thread "main" java.lang.NullPointerException at life.main(life.java:51)`

异常在其执行的不同部分被抛出，从未真正完整地完成第一个线程。任何帮助，将不胜感激。

```
import java.util.Arrays;
import java.util.Random;
import java.util.Scanner;

public class life {

final static int rowBound = 9;
final static int colBound = 9;
static int numThreads;
static boolean matrix[][];
static boolean prevMatrix[][];
static boolean newMatrix[][];
static boolean stable;

public static void main(String[] args) {

    matrix = new boolean[rowBound+1][colBound+1];
    prevMatrix = new boolean[rowBound+1][colBound+1];
    newMatrix = new boolean[rowBound+1][colBound+1];
    stable = false;

    Scanner in = new Scanner (System.in);
    numThreads = 8;

    matrix = fillMatrix(matrix);
    Random r = new Random();
    matrix = initializeMatrix(matrix, r);
    printMatrix(matrix);

    Thread[] threads = new Thread[numThreads];

    while (!stable){

        for (int i = 1; i < numThreads; ++i) {
            Runnable prod = new update(i, newMatrix);
            threads[i] = new Thread(prod);
            threads[i].start();
        }
        for (Thread t : threads) {
            try {
                t.join();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }   
        }   

        stable = compare(prevMatrix, newMatrix);
        printMatrix(newMatrix);

        if (!stable){
            prevMatrix = give(prevMatrix, matrix);
            matrix = give(matrix, newMatrix);
        }
    }

}

// fill matrix with false
public static boolean[][] fillMatrix(boolean[][] mat) {
    for (int x = 0; x < rowBound; x++) {
        for (int y = 0; y < colBound; y++) {
            mat[x][y] = false;
        }
    }
    return mat;
}

// initializes the matrix
public static boolean[][] initializeMatrix(boolean[][] mat, Random r) {
    for (int x = 1; x < rowBound; x++) {
    for (int y = 1; y < colBound; y++)
            mat[x][y] = r.nextBoolean();
    }
    return mat;
}

// print matrix
public static void printMatrix(boolean[][] matrix) {
    System.out.println("Dead cell --> '-'   Live cell --> '+'");
    for (int x = 0; x <= rowBound; x++) {
        for (int y = 0; y <= colBound; y++) {
            if (!matrix[x][y])
                System.out.print(" -");
            else
                System.out.print(" #");
        }
        System.out.println();
    }
}

public static boolean compare(boolean[][] prevM, boolean[][] newM) {
    for (int a = 1; a < rowBound-1; a++){
        for (int b = 1; b < colBound-1; b++){
            if (prevM[a][b] != newM[a][b])
                return false;
        }
    }
    return true;
}

static class update implements Runnable {
    int counter;
    int numRows;
    int firstRow;
    int lastRow;
    int thread;

    public update(int i, boolean[][] newMatrix) {
        thread = i;
    }

    @Override
    public void run() {

        numRows = 1;
        firstRow = thread * numRows;
        lastRow = numRows + firstRow;
        counter = 0;
        for (int a = firstRow; a < lastRow; a++) {
            for (int b = 1; b < colBound; b++) {
                for (int c = a - 1; c <= a + 1; c++) {
                    for (int d = b - 1; d <= b + 1; d++) {
                        if (matrix[c][d] == true)
                            counter++;
                    }
                }

                if (matrix[a][b]) {
                    counter--;
                    if (counter < 4) {
                        if (counter > 1)
                            newMatrix[a][b] = true;
                        else
                            newMatrix[a][b] = false;
                    } else
                        newMatrix[a][b] = false;
                } else {
                    if (counter == 3)
                        newMatrix[a][b] = true;
                    else
                        newMatrix[a][b] = false;
                }

            }
        }

    }
}

// gives the values from the newMatrix and puts them into matrix
public static boolean[][] give(boolean[][] matrix, boolean[][] newMatrix) {
    for (int x = 0; x < rowBound; x++) {
        for (int y = 0; y < colBound; y++) {
            matrix[x][y] = newMatrix[x][y];
        }
    }
    return matrix;
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T00:00:39.130

你得到一个，因为你从来没有在索引位置`NPE`分配一个：`Thread``0`

```
for (int i = 1; i < numThreads; ++i) { 
```

因此尝试在此处访问它时会引发异常：

```
for (Thread t : threads) {
  ...
  t.join(); // NPE 
```

# javascript - 在 jquery 插件中调用函数

> ID：13772782
> 
> 赞同：2
> 
> 时间：2012-12-07T23:43:53.177
> 
> 标签：javascript, jquery

我正在尝试获取我正在使用的 jquery 插件的对象。我希望最终能够为插件添加功能以满足我的需求。我目前在调用我在插件中定义的函数时遇到问题。这是我拥有的代码框架：

```
;(function($) {
      $.fn.myPlugin = function(o) {
                    .//Implementations here
                    .
                    .
            var Ex =  function(e){
                    //implementations here
            };

      }; 

})(jQuery); 
```

我想要这个函数的原因是因为我想访问一些定义的变量。我希望能够从我的 html 文件中调用函数 Ex，但是到目前为止我尝试的任何方法都没有奏效。我尝试过的一个例子是：

```
$.fn.myPlugin.Ex("x"); 
```

任何地方都没有退货声明。我不擅长 javascript 或 jquery，但我正在努力学习。感谢您解释我做错了什么的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:56:11.663

你的插件设计模式是错误的。

为了实现你想要的，你可以使用这个常见的：

```
;(function($){
  var methods = {
     init: function() {
       //stuff
     },
     function1: function() {
       //stuff
     },
     function2: function(opt) {
       //stuff
     }
  };
  $.fn.myPlugin= function(method) {
    if (methods[method]) {
      return methods[method].apply(this, Array.prototype.slice.call(arguments,1));
    } else if (typeof method === 'object' || ! method) {
      return methods.init.apply(this, arguments);
    } 
  };
})(jQuery); 
```

使用这种结构：

`$.fn.myPlugin();`将会通知`init()`

`$.fn.myPlugin("function1");`将会通知`function1()`

`$.fn.myPlugin("function2",option_exemple);`将会通知`function2(opt)`

免责声明：我经常使用它，但它不是我的。不记得我在哪里找到的*。

*   编辑：[http](http://docs.jquery.com/Plugins/Authoring) ://docs.jquery.com/Plugins/Authoring ，感谢 Beetroot-Beetroot 的提醒！

# jquery - jQuery：将元素 ID 作为函数的一部分传递

> ID：13772783
> 
> 赞同：3
> 
> 时间：2012-12-07T23:43:55.053
> 
> 标签：jquery, function

希望我的措辞正确......

我正在尝试将元素 id 作为 jquery 函数中的选项传递：

```
 $('.carousel').createcarousel({
        theid: $(this).attr('id'), // this is the part I am trying to get working
        delay: 150,
        fade:300,
        slide: 700,
        effect:'slide',                   
        orientation:'horizontal',
        loop: false,
        autoplay: false     }); 
```

在函数本身中，选项定义为`o`，所以我可以执行以下操作：

```
alert(o.fade); 
```

它将显示一个显示“300”的警报。但是，如果我这样做：

```
alert(o.theid); 
```

它说未定义。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:49:59.623

`this`不是你的对象。我猜你的`.carousel`每个班级都有一个 Id 并且你想将它分配给 theid 参数。但是，在您创建的对象中，上下文（`this`参数）与您的 jQuery 元素不匹配，它与您创建汽车的函数匹配。因此，您正在创建的 jQUery 对象包装了一个空的 HTML 元素并且没有 id。因此它被设置为未定义。

我认为这将完成您正在尝试做的事情：

```
$('.carousel').each(function() {
    $(this).createcarousel({
            //theid: $(this).attr('id'),                 
            theid: this.id,  //thanks jtheman
            delay: 150,
            fade:300,
            slide: 700,
            effect:'slide',                   
            orientation:'horizontal',
            loop: false,
            autoplay: false     });
}); 
```

这将遍历所有轮播类，`this`正确设置上下文并应用`createcarousel`函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:50:54.533

```
theid: $(this).attr('id') 
```

在这种情况下，$(this) 是指轮播对象，它不是 html 对象。

查看 jquery 应用功能。您可以指定函数调用的上下文

[http://api.jquery.com/Types/?rdfrom=http%3A%2F%2Fdocs.jquery.com%2Fmw%2Findex.php%3Ftitle%3DTypes%26redirect%3Dno#Context.2C_Call_and_Apply](http://api.jquery.com/Types/?rdfrom=http%3A%2F%2Fdocs.jquery.com%2Fmw%2Findex.php%3Ftitle%3DTypes%26redirect%3Dno#Context.2C_Call_and_Apply)

滚动到“上下文、调用和应用”

希望这会有所帮助

* * *

考虑到您对另一个答案的评论：

那你就不需要传递id了！试试这个 ：

```
$(".carousel").click(function(event){ 
    alert(event.target.attr("id")); 
}); 
```

event.target 代表被点击的html对象

这应该可以解决

# php - 带有从数据库中获取的标题和副标题的动态表

> ID：13772785
> 
> 赞同：-1
> 
> 时间：2012-12-07T23:43:59.580
> 
> 标签：php, mysql

我正在呼应从数据库中获取的超文本链接所涵盖的区域列表，

```
$area_shire = '';
$area_district = '';
$area_name = '';

while($rows = mysql_fetch_assoc($query)) {

    if ($rows['area_shire'] != $area_shire) {
        $area_shire = $rows['area_shire'];
        $area_shire_url = str_replace(' ', '_', $area_shire);
        echo '<h2><a href=Driveway_Cleaning_'.$area_shire_url.'>'.$area_shire.'</a></h2><br>';
    }  

    if ($rows['area_district'] != $area_district) {
        $area_district = $rows['area_district'];
        $area_district_url = str_replace(' ', '_', $area_district);
        echo '<h3><a href=Driveway_Cleaning_'.$area_district_url.'>'.$area_district.'</a></h3><br>';

    }  

    if ($rows['area_name'] != $area_name) {
        $area_name = $rows['area_name'];
        $area_name_url = str_replace(' ', '_', $area_name);
        echo '<a href=Driveway_Cleaning_'.$area_name_url.'>'.$area_name.'</a><br>';
    }  
    }
?> 
```

这是给我一个线性输出

## 西米德兰兹郡

### 伯明翰

哈伯恩·
埃德巴斯顿
·莫斯利

### 达德利

哈勒索
文·塞格利

## 沃里克郡

我正在尝试将输出放入一个动态表中，以便每个 area_district（例如）Dudley 都从一个新列开始，因此位于伯明翰的右侧而不是下方。我尝试的一切都会影响输出的顺序。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:48:06.103

那你为什么不尝试使用 HTML 表格呢？或者将每个分组放在一个浮动的 div 中，以便它们可以并排放置？我的主要建议是先制定您的 HTML 模板，然后再制定如何将动态数据注入其中。

# javascript - TypeError document.getElementByID() ... 为空？

> ID：13772788
> 
> 赞同：0
> 
> 时间：2012-12-07T23:44:17.953
> 
> 标签：javascript, html, getelementbyid

谁能告诉我为什么我会收到这个错误？

> “TypeError: document.getElementById(...) is null @ line:25”

我正在使用 JavaScript，这就是我迄今为止在我的`<script>`标签中所拥有的......

```
var initBoard = new Array(new Array(0, 0, 0, 1),
                      new Array(0, 0, 0, 0),
                      new Array(3, 0, 0, 0),
                      new Array(0, 0, 2, 0)
);

function insertData(){
for(var i = 0; i < 4; i++){
    for(var j = 0; j <4; j++){
        document.getElementById(i.j).innerHTML = initBoard[i][j];

    }
}
} 
```

在我的 HTML 里面的下面`<body>`我有这个....

```
<table border="2" >
<tr align="center">
<td><div id="00">0</div></td>
<td><div id="01">0</div></td>
<td><div id="02">0</div></td>
<td><div id="03">0</div></td>
</tr>

<tr align="center">
<td><div id="10">0</div></td>
<td><div id="11">0</div></td>
<td><div id="12">0</div></td>
<td><div id="13">0</div></td>
</tr>

<tr align="center">
<td><div id="20">0</div></td>
<td><div id="21">0</div></td>
<td><div id="22">0</div></td>
<td><div id="23">0</div></td>
</tr>

<tr align="center">
<td><div id="30">0</div></td>
<td><div id="31">0</div></td>
<td><div id="32">0</div></td>
<td><div id="33">0</div></td>
</tr> 
```

当我尝试运行它时，我从上面得到了那个错误。

我也尝试将“ID”硬编码为`'00'`or `'01'`，它仍然给我同样的错误信息。

有谁知道我做错了什么？我到处看了看，到处都说基本相同的事情，应该很容易，但我无法克服这一点。

编辑：第 25 行是`document.getElementById(i.j).innerHTML = initBoard[i][j];`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:46:30.887

您想将数字转换为字符串并将它们连接起来。

```
document.getElementById(i + "" + j).innerHTML = ... 
```

* * *

您有`i.j`，它将获取 引用的数字`i`，并要求它提供其`j`属性，该属性将返回`undefined`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T00:15:29.893

确保代码在文档完全加载后执行。就像是

```
window.addEventListener("load", function() {
     <your current code>
},0); 
```

正如其他海报所说，使用类似“cell”+i+“_”+j 的东西也是一个好主意。我会加上下划线，这样“111”就不会模棱两可了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T23:49:02.837

是的-同样的问题曾经发生在我身上。问题是：

ID 和 NAME 标记必须以字母 ([A-Za-z]) 开头，后跟任意数量的字母、数字 ([0-9])、连字符 ("-")、下划线 ("_") , 冒号 (":") 和句点 (".")。

所以你必须改变分配 ID 的方式

另外-您的 ij 方法不正确

# php - 无法从 wordpress 上的数据库中获取值

> ID：13772791
> 
> 赞同：2
> 
> 时间：2012-12-07T23:44:22.537
> 
> 标签：php, mysql, wordpress

嘿伙计们，所以我试图从我的数据库中获取一个值，但由于某种原因，它并没有达到应有的方式。我通过 wordpress $wpdb 调用所有内容。

代码：

```
/***GET USERNAME***/
            global $current_user, $wpdb;
            get_currentuserinfo();
            $accusername = $current_user->user_login ;
            /******SEE IF FIRST TIME DISCOUNT CODE BEEN USED*******/
            $checkFTDiscount = $wpdb->get_var( $wpdb->prepare( 
                "
                    SELECT firsttime_discount 
                    FROM $wpdb->users 
                    WHERE user-login = %d
                ", 
                $accusername
            ) );
            echo $checkFTDiscount; 
```

所以从技术上讲，我应该从中获得值 1，因为在数据字段中，它的绘图来自 - 这是一个 int(2) - 为这个用户设置为 1。

如果您需要任何其他信息，请告诉我。

谢谢您的帮助！

已编辑

一旦获得价值，它就会设置这些 -

```
if ($checkFTDiscount == 1){
                $validFTDiscount = 1;

            }
            else if ($checkFTDiscount == 0){
                $validFTDiscount = 0;

            } 
```

这不会发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:57:42.500

在你的例子中

```
WHERE user-login = %d // %d for integers 
```

应该

```
WHERE user_login = %s // %s for string and it's a string value and _ instead of - 
```

# java - 数组中的方法有问题

> ID：13772794
> 
> 赞同：0
> 
> 时间：2012-12-07T23:44:31.167
> 
> 标签：java, arrays, methods

我正在尝试将球添加和删除到数组中，我只被允许使用数组（而不是数组列表）。我在添加和删除球方法时遇到问题，并且在添加和删除球方法的长度上不断收到“插入”赋值运算符表达式“”错误。不知道如何解决问题。帮助表示赞赏。

```
private final int DIAMETER = 60;
private java.awt.Color _currentColor;
//private SmartEllipse _ball;

SmartEllipse [] myBalls = new SmartEllipse [25];

public BallPanel () {

    super();
    this.setBackground(java.awt.Color.white);

    myBalls = new SmartEllipse[0];

    _currentColor = java.awt.Color.red;

    this.addMouseListener(new MyMouseListener());

}

//translate the click coordinates to a grid coordinate
     public java.awt.Point translatePoint(java.awt.Point aPoint)
     {

         int x = aPoint.x;
         int y = aPoint.y;

         aPoint.x = x / 20;
         aPoint.y = y / 20;

         return aPoint;

     }

    //find a ball in the array
     public int findBall(java.awt.Point p)
     {
         for (SmartEllipse se : myBalls )
         {       
             java.awt.Point translatedPoint = translatePoint(se.getLocation());

             if (translatedPoint.x == p.x && translatedPoint.y == p.y)
                 return myBalls.length;
         }

         return -1;

     }

     // remove a ball from the array
     public void removeBall(SmartEllipse p)
     { 
         myBalls.length-1;
         this.repaint();
         this.revalidate();
     }

     //add a peg to the array
     public void addBall(SmartEllipse p)
     {
         myBalls.length;
         this.repaint();
         this.revalidate();
     }

 public void paintComponent(java.awt.Graphics aBrush)
 {
        super.paintComponent(aBrush);
        java.awt.Graphics2D betterBrush = (java.awt.Graphics2D) aBrush;

        for (SmartEllipse se : myBalls )
        {
            se.draw(betterBrush);
            se.fill(betterBrush);
        }
 }

 private class MyMouseListener extends javax.swing.event.MouseInputAdapter
 {
     public void mouseClicked(MouseEvent e) 
     {
         // get X and Y of click
         // translate X and Y to grid
         // check peg array for duplicate
         // if duplicate, remove ball
         // else add ball to ball array

         java.awt.Point p = translatePoint(e.getPoint());

         // Adjust the coordinates

         int index = findBall(p);

         for (int i = 0; i< myBalls.length; i++)
         {

            myBalls[i] = null;

         if ( index != -1)
             remove(myBalls.length);
         else
             addBall(new SmartEllipse(_currentColor, p.x, p.y));

         }

     }
 } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:03:38.523

我不确定我是否理解你的问题，因为你没有很好地指定你在哪里得到错误，但它看起来好像你将 myBalls 声明为 25 个元素的数组，但是在构造函数中你正在分配它一个新的零元素数组。您不能向零元素数组添加任何内容。

# java - java.lang.OutOfMemoryError 即使有很多

> ID：13772802
> 
> 赞同：7
> 
> 时间：2012-12-07T23:45:27.160
> 
> 标签：java, out-of-memory

我正在尝试将 2.5GB 的 txt 文件读入我的应用程序。我正在运行 Win7 x64 并且有 43GB 的可用内存（超过 64GB）。我尝试使用 -Xmx -XX:MaxParmSize -XX:ParmSize 等。这些都不会影响错误。我还能尝试什么？这个错误看起来很奇怪，因为我当然有足够的可用堆空间。

```
Exception in thread "main" java.lang.OutOfMemoryError: Requested array size exceeds VM limit
    at java.util.Arrays.copyOf(Unknown Source)
    at java.lang.AbstractStringBuilder.expandCapacity(Unknown Source)
    at java.lang.AbstractStringBuilder.ensureCapacityInternal(Unknown Source)
    at java.lang.AbstractStringBuilder.append(Unknown Source)
    at java.lang.StringBuilder.append(Unknown Source)
    at j.utilities.IO.loadString(IO.java:187)
    at j.utilities.IO.loadString(IO.java:169)
    at city.PreProcess.main(PreProcess.java:78) 
```

我在跑步

```
java version "1.7.0_09"
Java(TM) SE Runtime Environment (build 1.7.0_09-b05)
Java HotSpot(TM) 64-Bit Server VM (build 23.5-b02, mixed mode) 
```

提前非常感谢。

============== 答案===============

好的，我刚刚测试过

```
StringBuilder sb = new StringBuilder();
for ( int i=1; i<Integer.MAX_VALUE; i++ )
    sb.append("x"); 
```

并得到

```
Exception in thread "main" java.lang.OutOfMemoryError: Requested array size exceeds VM limit
at java.util.Arrays.copyOf(Unknown Source)
... 
```

因此，实际上是 StringBuilder 试图构建一个大于 Integer.MAX_VALUE 的数组。

如有兴趣

```
StringBuilder sb = new StringBuilder();
int i=1;
try {
    for ( ; i<Integer.MAX_VALUE; i++ )
        sb.append("x");
} catch ( OutOfMemoryError e ) {
    System.out.println(i); // OUTPUT: 1207959551
    System.out.println(Integer.MAX_VALUE); // OUTPUT: 2147483647
} 
```

使用 StringBuilder，您可以累积 1,207,959,550 个字符 - 远远少于 Integer.MAX_VALUE。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-07T23:50:22.273

您正在尝试分配一个太大的数组。这是因为您正在尝试创建一个非常长的字符串。由于数组由整数索引，因此数组不能有多个`Integer.MAX_VALUE`元素。即使您的堆大小非常大，您也无法分配包含多个`Integer.MAX_VALUE`元素的数组，因为您无法使用`Integer`. 请参阅[Java 数组是否有最大大小？](https://stackoverflow.com/q/3038392/130224)更多细节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-08T00:42:19.160

您可以创建一个新的 StringBuilder 大小，例如

```
 StringBuilder sb = new StringBuilder(Integer.MAX_VALUE); 
```

问题是您试图读取的文件比 StringBuilder 数组中的文件大。您有多种选择，例如：

1）你真的需要一次将整个文件读入内存吗？如果是这样，您必须将其读入多个 StringBuilders。

2) 按顺序处理文件。

3) 将其读入压缩结构，在需要的时候解压需要的部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T23:53:05.007

您应该查看 java 命令的 -Xmsn 选项。

它指定内存分配池的初始大小。

编辑：我看到你已经这样做了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-31T22:11:01.553

您可以将字符串缓冲区中的数据保存`List<String>`在定义间隔中并清除`StringBuffer`.

# html - 如果在页面加载时选中 RadioButton，如何触发 onClick 事件

> ID：13772807
> 
> 赞同：0
> 
> 时间：2012-12-07T23:46:34.270
> 
> 标签：html, onclick, radio-button, pageload

我有一个单选按钮组，其中一个按钮在页面加载时被选中，如果选中，是否可以在页面加载时从该单选按钮触发某种 onClick 事件？

我不想使用某种 onLoad JavaScript 来检查它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:10:06.190

```
$('.radioButton:checked').live('click', function(){
// do something

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:51:12.477

如果我了解您的需求，您可以尝试这样的事情（jQuery）：

```
if($('.radioButton').is(':checked')) { $('.whatever_must_be_clicked).click(); } 
```

对于第一个选择器，您还可以使用 :radio 选择器 $(':radio') 或 $('input:radio')

# c# - 如何在特定事件期间阻止单个按钮隐藏我的文本框？

> ID：13772808
> 
> 赞同：1
> 
> 时间：2012-12-07T23:46:35.987
> 
> 标签：c#, winforms

我有两个问题：

1）这是使变量的默认值= 0，然后将用户给定的值传递给该变量的正确方法吗？

```
protected void btnCheck_Click(object sender, EventArgs e)
    {
        lblYesNo.Text = "";
        //default int values are set to 0
        int remainder = 0;
        int guess = 0;

        remainder = int.Parse(txtRemainder.Text);

        guess = int.Parse(txtAnswer.Text);
        answer = (int)Session["answer"];
        if (guess == answer)
        {
            lblYesNo.Text = lblYesNo.Text + "Correct!";
        }
        else
        {
            lblYesNo.Text = lblYesNo.Text + "Try Again..";
        }
    }//END Check Answer 
```

2）如何阻止 Check_Click（提交按钮）隐藏 txtRemainder（文本框）？它现在“自动隐藏”的原因是因为我将默认值设置为“txtRemainder.Visible = false;” 在 Page_Load 中，除非数学问题是除法，否则它将使其隐藏。当我单击 btnDiv_Click(divide button) 时，它会将其重置为“txtRemainder.Visible = true;”，因为这提供了一个待解决的除法问题。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class BasicMath : System.Web.UI.Page
{
    int number1;
    int number2;
    int answer;

    protected void Page_Load(object sender, EventArgs e)
    {
        txtRemainder.Visible = false;
    }

    protected void GetRandom()
    {
        Random rand = new Random();
        number1 = rand.Next(0, 10);
        number2 = rand.Next(0, 10);
        txtAnswer.Text = "";
        txtRemainder.Text = "";
        lblYesNo.Text = "";
    }//END Get Random Number

    protected void btnAdd_Click(object sender, EventArgs e)
    {
        GetRandom();
        lblEquation.Text = number1.ToString() + " + " + number2.ToString();
        answer = number1 + number2;
        Session["answer"] = answer;
    }//END Addition Button

    protected void btnSub_Click(object sender, EventArgs e)
    {
        GetRandom();
        if (number2 > number1)
        {
            answer = number2 - number1;
            lblEquation.Text = number2.ToString() + " - " + number1.ToString();
        }
        else
        {
            answer = number1 - number2;
            lblEquation.Text = number1.ToString() + " - " + number2.ToString();
        }
        Session["answer"] = answer;

    }//END Subtraction Button

    protected void btnMult_Click(object sender, EventArgs e)
    {
        GetRandom();
        lblEquation.Text = number1.ToString() + " x " + number2.ToString();
        answer = number1 * number2;
        Session["answer"] = answer;
    }//END Multiplication Button

    protected void btnDiv_Click(object sender, EventArgs e)
    {

        Random rand = new Random();
        number1 = rand.Next(1, 10);
        number2 = rand.Next(1, 10);
        /*will only display the txtRemainder(textbox) while using the Divide button,
           txtRemainder will auto-hide when using another button because
           it's default setting of '.Visible = false' is placed in the Page_Load*/
        txtRemainder.Visible = true;
        lblEquation.Text = number1.ToString() + " / " + number2.ToString(); 
        answer = number1 / number2;
        Session["answer"] = answer;

    }//END Division Button

    protected void btnCheck_Click(object sender, EventArgs e)
    {
        lblYesNo.Text = "";
        //default int values are set to 0
        int remainder = 0;
        int guess = 0;

        remainder = int.Parse(txtRemainder.Text);

        guess = int.Parse(txtAnswer.Text);
        answer = (int)Session["answer"];
        if (guess == answer)
        {
            lblYesNo.Text = lblYesNo.Text + "Correct!";
        }
        else
        {
            lblYesNo.Text = lblYesNo.Text + "Try Again..";
        }
    }//END Check Answer
} 
```

如果这个问题没有意义，请要求澄清。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:01:10.160

问题一：

是的，这是将变量初始化为零默认值的正确方法，尽管`int`变量默认初始化为零，因此即使您省略了赋值，它们仍将默认为零。

您用于接受用户输入的方法是正确的，但如果用户输入的值不是 Int32 值（想想 3.2），则可能会引发异常。就目前而言，您没有 try..catch 块来处理这些异常。您可以添加这些 try..catch 块，也可以使用 TryParse() 方法检查这些值是否有效。例如：

```
protected void btnCheck_Click(object sender, EventArgs e)
{
    lblYesNo.Text = "";
    //default int values are set to 0
    int remainder = 0;
    int guess = 0;

    if (!Int32.TryParse(txtRemainder.Text, out remainder))
    {
        // do something here to inform the user that remainder is invalid
        return;
    }

    if (!Int32.TryParse(txtAnswer.Text, out remainder))
    {
        // do something here to inform the user that answer is invalid
        return;
    }

    answer = (int)Session["answer"];
    if (guess > answer)
    {
        lblYesNo.Text = lblYesNo.Text + "Try Again..";
    }
    else if (guess < answer)
    {
        lblYesNo.Text = lblYesNo.Text + "Try Again..";
    }
    else
    {
        lblYesNo.Text = lblYesNo.Text + "Correct!";
    }
}//END Check Answer 
```

TryParse() 会将值转换为输出变量，如果它是有效值并返回以指示成功，否则如果无法执行转换`true`，它将返回。`false`

问题2：

为了`txtRemainder`在页面首次加载时隐藏，然后在单击除 之外的任何按钮时使其隐藏`btnDiv`，这是一个建议的解决方案。首先，代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack) {
        lblTest.Visible = false;
    } else {
        foreach (string ctrl in Request.Form) {
            Control c = FindControl(ctrl);
            if (c is Button) {
                txtRemainder.Visible = c.ID == "btnDiv";
                return;
            }
        }
    }
} 
```

现在进行一些解释。当页面最初加载时，标签是隐藏的（通过`!IsPostBack`检查）。如果请求确实是回发，我们会检查返回的表单控件集合（包含在`Request.Form`集合中）并检查是否存在可能导致回发的按钮。按钮在 HTML 中作为元素呈现，并且在回发时，即使页面上有多个提交，也`<input type="submit" .. />`只有被单击的按钮会被发送回集合中。`Form`更详细的解释可以在[这里找到](http://ryanfarley.com/blog/archive/2005/03/11/1886.aspx)

现在，如果一个按钮确实导致了回发，那么我们检查这个按钮是否是`btnDiv`. 如果是，则比较返回`true`&`txtRemainder`并显示。如果没有，它是隐藏的。

这样，就不需要`txtRemainder`在每个事件处理程序中显示或隐藏。您甚至不需要在`btnDiv`.

**编辑**

根据评论中列出的要求，我更改了对问题 2 的回答，以便提供一种替代方法，无需在每个按钮事件中显示或隐藏标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T00:01:19.973

**问题1：** 如果您使用.Net 4.0 及更高版本，请考虑使用该`TryParse`方法，并检查结果是否成功，这样您可以更好地控制解析值和捕获异常，例如

```
int number = 0;
bool result = false;

result = int.TryParse("123", out number);

if (!result)
{
    throw new InvalidCastException("Error converting number");
} 
```

**问题2：** 看起来您正在使用Asp.Net，所以尝试`Page.IsPostBack`在Page_Load 事件中进行测试，这样您就可以确定页面加载是因为初始加载，还是因为您向服务器发送了数据，即单击了一个按钮。

希望这可以帮助！

# sql - 获取 RID 查找而不是表扫描？

> ID：13772809
> 
> 赞同：1
> 
> 时间：2012-12-07T23:46:39.153
> 
> 标签：sql, sql-server, performance, sql-server-2008, tsql

SQL 小提琴：[http ://sqlfiddle.com/#!3/23cf8](http://sqlfiddle.com/#!3/23cf8)

在此查询中，当我`In`在 Id 上有一个子句，然后还选择其他列时，首先评估 In，然后通过 RID 查找拉入 Details 列和其他列：

```
--In production and in SQL Fiddle, Details is grabbed via a RID Lookup after the In clause is evaluated
    SELECT [Id]
      ,[ForeignId]    
     ,Details    
      --Generate a numbering(starting at 1) 
      --,Row_Number() Over(Partition By ForeignId Order By Id Desc) as ContactNumber --Desc because older posts should be numbered last
  FROM SupportContacts
  Where foreignId In (1,2,3,5) 
```

使用此查询，将通过表扫描获取详细信息。

```
With NumberedContacts AS 
(
    SELECT [Id]
      ,[ForeignId]
      --Generate a numbering(starting at 1) 
      ,Row_Number() Over(Partition By ForeignId Order By Id Desc) as ContactNumber --Desc because older posts should be numbered last
  FROM SupportContacts
  Where ForeignId In (1,2,3,5) 
)
Select nc.[Id]
      ,nc.[ForeignId]   
      ,sc.[Details]
From NumberedContacts nc
Inner Join SupportContacts sc on nc.Id = sc.Id
Where nc.ContactNumber <= 2 --Only grab the last 2 contacts per ForeignId
; 
```

在 SqlFiddle 中，第二个查询实际上获得了 RID 查找，而在具有一百万条记录的生产环境中，它产生了表扫描（该`IN`子句消除了 99% 的行）

否则，SQL Fiddle 中显示的查询计划是相同的，唯一的区别是对于第二个查询，SQL Fiddle 中的 RID 查找是生产中的表扫描:(

1.  我想了解导致这种行为的可能性？你会看什么样的东西来帮助确定它在这里使用表扫描的原因？

2.  我如何影响它在那里使用 RID 查找？

从实际执行计划中的操作成本来看，如果我可以使用 RID 查找，我相信我可以让第二个查询在性能上非常接近第一个查询。如果我不选择该`Detail`列，那么这两个查询的性能在生产中非常接近。只有在添加其他列之后`Detail`，第二个查询的性能才会显着下降。当我把它放在 SQL Fiddle 中，看到执行计划使用了 RID Lookup 时，我很惊讶，但有点困惑......

它没有聚集索引，因为在使用不同聚集索引进行测试时，此查询和其他查询的性能稍差。那是在我开始添加其他列之前`Details`，我可以尝试更多，但是想在我开始在黑暗中使用随机索引拍摄之前了解现在发生了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T08:34:51.610

如果您要更改主索引以包含该`Details`列怎么办？

如果您使用：

```
CREATE NONCLUSTERED INDEX [IX_SupportContacts_ForeignIdAsc_IdDesc] 
ON SupportContacts ([ForeignId] ASC, [Id] DESC)
INCLUDE (Details); 
```

那么既不需要 RID 查找也不需要表扫描，因为您的查询可以仅从索引本身得到满足......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T20:56:08.447

如果确实在使用相关索引 + RID 执行查询时会省略 99% 的行，那么您的生产环境中最可能的问题是您的统计信息已过时并且优化器没有意识到 ( 1,2,3,5) 会将结果集限制为总数据的 1%。

这是从 Pinal Dave 发现更多关于统计信息的好链接：http: [//blog.sqlauthority.com/2010/01/25/sql-server-find-statistics-update-date-update-statistics/](http://blog.sqlauthority.com/2010/01/25/sql-server-find-statistics-update-date-update-statistics/)

至于在不更新统计信息的情况下强制优化器遵循正确的路径，您可以使用表提示 - 如果您知道您的计划应该使用的包含 ID 和 ForeignID 列的索引，然后将其粘贴在您的查询中作为提示和强制 SQL 优化器使用索引：

[http://msdn.microsoft.com/en-us/library/ms187373.aspx](http://msdn.microsoft.com/en-us/library/ms187373.aspx)

仅供参考，如果您想从第二个查询中获得最佳性能，请使用此索引并完全避免您遇到的头痛：

```
create index ix1 on SupportContacts(ForeignID, Id DESC) include (Details); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T00:03:52.113

查询计划的差异将取决于存在的索引类型以及不同环境中这些表的数据统计信息。

优化器使用统计数据（主要是数据频率的直方图）和可用索引来决定哪个执行计划将是最快的。

因此，例如，您注意到包含“详细信息”列时性能会下降。这是一个几乎可以肯定的迹象，表明“详细信息”列不是索引的一部分，或者如果它是索引的一部分，则该列中的数据大多是唯一的，因此索引访问将是等效的（或几乎等效的）到表扫描。

通常当这种情况出现时，优化器会选择表扫描而不是索引访问，因为它可以利用块读取之类的东西来比索引的碎片读取更快地访问表记录。

为了影响优化器将选择的路径，您需要查看可以添加/修改以使索引访问更有效的可能索引，但这应该小心完成，因为它也会对其他查询产生不利影响可能会降低插入性能。

您可以帮助优化器执行的另一项重要活动是确保表统计信息保持最新并以适合表数据中频率分布的变化率的频率刷新

# .htaccess - 自定义网站上的 htaccess url 别名

> ID：13772815
> 
> 赞同：0
> 
> 时间：2012-12-07T23:47:01.260
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

您好，我正在开发一个有 5-6 个页面的网站，例如 main.php（主页）、event.php（事件的登录页面）、article.php（另一个新闻登录页面）等等等等...

我想知道如何将诸如“http://www.domain.com/event.php?eid=145”之类的网址重写为“http://www.domain.com/event/title-事件”

我已经阅读了几篇关于 .htaccess 的文章，但没有运气，目前我正在搞砸这个，但这不是我想要的

```
Options +FollowSymlinks
RewriteEngine on
rewriterule ^event.php(.*)$ http://evented.localhost/event/$1 [r=301,nc] 
```

任何帮助将不胜感激，或者如果您知道 .htaccess 的任何体面的 url 别名教程。

谢谢。

编辑：

这似乎适用于 event.php 页面，它将链接转换为[http://domain.com/event/145](http://domain.com/event/145)（根据上面的示例）

```
RewriteEngine on

#EVENT REWRITE

RewriteRule ^event/([^/\.]+)/?$ /event.php?eid=$1 [L]
RewriteRule ^event/(.*) /$1 [L] 
```

我怎么能用它的标题替换事件ID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T04:17:37.633

您必须将干净的标题与 other.data 一起存储，然后使用干净的 url 来查找文章。

# python - numpy中带有导数的三次插值

> ID：13772817
> 
> 赞同：5
> 
> 时间：2012-12-07T23:47:05.240
> 
> 标签：python, numpy, scipy, interpolation

最近移民到 Python 和使用 Python 进行科学计算。这是一个避免任何可能已经存在的代码重复的问题。

我有一个字段在常规网格中作为 x 和 y 的函数进行采样。我想对数据进行插值，不仅可以获得网格上任意点的字段值，还可以获得一阶和二阶导数。如果我使用 interp2d 对它进行双三次插值，我可以获得该字段的值。

有没有人建议如何使用现有的 numpy 或 scipy 函数获得该字段的一阶和二阶导数？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-04-02T14:49:22.223

该[`scipy.interpolate.interp2d.__call__`](https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp2d.__call__.html)方法具有选项`dx`并`dy`可以在点评估更高的导数（至少从版本 0.14.0 开始）。

# javascript - File API，以编程方式从服务器下载文件并将其存储在沙盒文件系统中

> ID：13772821
> 
> 赞同：2
> 
> 时间：2012-12-07T23:47:33.627
> 
> 标签：javascript, html, fileapi

有没有办法以编程方式从服务器下载文件（用户单击 Web 应用程序中的保存按钮）和浏览器（支持文件 API）或设备将下载文件并将其保存在其沙盒文件系统中？我正在查看 HTML5 文件 API。我可以创建或修改文件并存储它，但首先我需要从服务器获取文件。简单地说，我想避免另存为弹出窗口，我希望文件保留在 Web 应用程序的沙盒文件系统中。欢迎任何我可以查看的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T07:06:19.523

您希望 XMLHttpRequest()，尽管它的名字，可以处理下载所有类型的数据，包括二进制。如果将 responseType 设置为“arraybuffer”，则可以将其转换为 blob 并非常轻松地将其保存到文件系统中。

HTML5Rocks 有一个很棒的教程，应该涵盖你需要的一切： [XMLHttpRequest 中的新技巧](http://www.html5rocks.com/en/tutorials/file/xhr2/)

（我知道这个问题有点老了，但我只是在寻找如何做同样的事情，这是弹出的第一个结果，所以我想我会分享）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T00:06:27.307

下载文件最简单的方法就是`window.open`访问它的 URL。这将提示用户选择某个地方来保存文件。

除此之外，您无能为力。浏览器会非常小心地保护其用户的文件系统。

# kendo-ui - 如何动态更改 kendo.mobile.Application 的加载属性？

> ID：13772822
> 
> 赞同：2
> 
> 时间：2012-12-07T23:48:04.590
> 
> 标签：kendo-ui

我正在使用 Kendo UI Mobile 开发一个移动网络应用程序。每当我们进行任何 AJAX 调用，或者我们`DataSource`的 s 调用它们时，我们都会调用`app.startLoading()`以向用户显示加载图标。这很好用。

但是，根据调用的上下文，我们希望更改与加载图标一起显示的文本。我知道你可以在我创建`kendo.mobile.Application`实例时定义它。以后怎么改？

该[文档](http://docs.kendoui.com/api/mobile/application)没有建议这样做的方法，并且浏览源代码也没有帮助我。这真的不可能吗？

**编辑：**这是使用 Kendo UI Mobile v.2012.3.1114

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T00:57:48.853

我通常会创建一个“实用程序”函数来执行此操作：

```
 var _kendoApp = new kendo.mobile.Application(document.body, {});

    var showLoading = function (message) {
        _kendoApp.loading = "<h1>" + (message ? message : "Loading...") + "</h1>";
        _kendoApp.showLoading();
    }; 
```

如果未传入，我还将设置默认消息“正在加载...”。

* * *

**编辑：**

我本可以发誓在我过去的应用程序中对我有用，但从来源来看，我认为你是对的，我上面的答案不应该奏效。我最好的建议是向消息元素添加一个类，以便您可以定位它，并使用 jQuery 来更改文本。

```
var _kendoApp;

var showLoading = function (message) {
    $(".loading-message").text(message ? message : "Loading...");
    _kendoApp.showLoading();
};

_kendoApp = new kendo.mobile.Application(document.body, {
    loading: '<h1 class="loading-message">Loading...</h1>'
}); 
```

# java - 静态和最终的区别？

> ID：13772827
> 
> 赞同：189
> 
> 时间：2012-12-07T23:48:34.000
> 
> 标签：java

我总是对***java***`static`中的and`final`关键字感到困惑。

 *它们有何不同？

* * *

## 回答 #1

> 赞同：258
> 
> 时间：2012-12-07T23:59:02.690

## static关键字可用于4种场景

*   静态变量
*   静态方法
*   静态代码块
*   静态嵌套类

我们先来看看静态变量和静态方法。

## 静态变量

*   它是一个属于类而不属于对象（实例）的变量。
*   静态变量仅在执行开始时初始化一次。这些变量将在初始化任何实例变量之前首先被初始化。
*   由类的所有实例共享的单个副本。
*   静态变量可以通过类名直接访问，不需要任何对象。
*   句法：`Class.variable`

## 静态方法

*   它是属于类而不属于对象（实例）的方法。
*   静态方法只能访问静态数据。除非它拥有/创建类的实例，否则它不能访问非静态数据（实例变量）。
*   静态方法只能调用其他静态方法，并且不能从中调用非静态方法，除非它具有/创建类的实例。
*   静态方法可以通过类名直接访问，不需要任何对象。
*   句法：`Class.methodName()`
*   静态方法无论如何都不能引用`this`或`super`关键字。

## 静态类

Java 也有“静态嵌套类”。静态嵌套类只是一个没有隐式引用外部类实例的类。

静态嵌套类可以有实例方法和静态方法。

Java 中没有顶级静态类。

### 边注：

> main 方法是`static`因为在任何实例化发生之前，应用程序必须可以访问它才能运行。

## `final`关键字在几个不同的上下文中用于定义以后不能更改的实体。

*   一个`final`类不能被子类化。这样做是出于安全和效率的原因。因此，许多 Java 标准库类是`final`，例如`java.lang.System`和`java.lang.String`。一个类中的所有方法`final`都是隐式的`final`。

*   方法`final`不能被子类覆盖。这用于防止子类更改可能对类的功能或一致性至关重要的方法的意外行为。

*   `final`变量只能通过初始化程序或赋值语句初始化一次。它不需要在声明时初始化：这称为`blank final`变量。必须在声明它的类的每个构造函数的末尾明确分配一个类的空白最终实例变量；类似地，一个空白的 final 静态变量必须在声明它的类的静态初始化器中明确赋值；否则，在这两种情况下都会发生编译时错误。

### 注意：如果变量是一个引用，这意味着该变量不能被重新绑定以引用另一个对象。但是它引用的对象仍然是可变的，如果它最初是可变的。

当在方法体中定义匿名内部类时，在该`final`方法范围内声明的所有变量都可以从内部类中访问。一旦它被赋值，最终变量的值就不能改变。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-12-07T23:52:22.273

**static意味着它属于类而不是实例，这意味着在特定****Class**的所有实例之间只有该变量/方法的一个副本共享。

```
public class MyClass {
    public static int myVariable = 0; 
}

//Now in some other code creating two instances of MyClass
//and altering the variable will affect all instances

MyClass instance1 = new MyClass();
MyClass instance2 = new MyClass();

MyClass.myVariable = 5;  //This change is reflected in both instances 
```

**final**是完全不相关的，它是一种定义一次初始化的方式。您可以在定义变量时或在构造函数中进行初始化，别无他法。

**note**关于最终方法和最终类的注释，这是一种明确说明方法或类不能分别被覆盖/扩展的方式。

**额外阅读** 所以关于静态的话题，我们讨论了它可能有的其他用途，它有时用于静态块。当使用静态变量时，有时需要在使用类之前设置这些变量，但不幸的是你没有得到构造函数。这就是 static 关键字的用武之地。

```
public class MyClass {

    public static List<String> cars = new ArrayList<String>();

    static {
        cars.add("Ferrari");
        cars.add("Scoda");
    }

}

public class TestClass {

    public static void main(String args[]) {
        System.out.println(MyClass.cars.get(0));  //This will print Ferrari
    }
} 
```

*您不能将此与在每个*实例的构造函数之前调用的实例初始化程序块混淆。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-12-07T23:54:27.643

两者真的不一样。`static`字段是*不属于任何特定类实例的*字段。

```
class C {
    public static int n = 42;
} 
```

在这里，该`static`字段`n`不与任何特定实例相关联，`C`而是与整个类相关联（这就是为什么`C.n`可以用来访问它的原因）。您仍然可以使用的实例`C`来访问`n`吗？是的 - 但这并不是特别好的做法。

`final`另一方面表示特定变量在初始化后无法更改。

```
class C {
    public final int n = 42;
} 
```

在这里，`n`不能重新分配，因为它是`final`. 另一个区别是可以声明任何变量`final`，而不是每个变量都可以声明为静态变量。

此外，可以声明类`final`，表明它们不能扩展：

```
final class C {}

class B extends C {}  // error! 
```

类似地，方法可以声明为 final 以表明它们不能被扩展类*覆盖：*

```
class C {
    public final void foo() {}
}

class B extends C {
    public void foo() {}  // error!
} 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2016-10-16T21:26:08.100

`static`表示该类的所有实例共享的内存中只有一个变量副本。

`final`关键字只是意味着无法更改值。如果没有`final`，任何对象都可以更改变量的值。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2014-04-07T23:17:26.230

**最终的 -**

1）当我们将“ **final** ”关键字应用于**变量**时，该变量的值保持不变。（或）一旦我们将一个**变量**声明为**final**，该变量的值就无法更改。

2）当**变量**值在程序的生命周期内不改变时很有用

**静止的 -**

1）当我们将“**静态**”关键字应用于**变量**时，它表示它属于类。
2）当我们将“ **static** ”关键字应用于**方法**时，意味着可以访问该**方法而无需创建类的任何实例**

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-01-28T22:14:52.183

想象一个像扬声器这样的物体。如果 Speaker 是一个类，它将具有不同的变量，例如音量、高音、低音、颜色等。您在定义 Speaker 类时定义所有这些字段。例如，您使用 static 修饰符声明颜色字段，这意味着您告诉编译器该变量仅存在一个副本，无论该类已被实例化多少次。

声明

```
static final String color = "Black"; 
```

将确保每当实例化此类时，颜色字段的值将是“黑色”，除非它没有更改。

```
public class Speaker {

static String color = "Black";

}

public class Sample {

public static void main(String args[]) {
    System.out.println(Speaker.color); //will provide output as "Black"
            Speaker.color = "white";
    System.out.println(Speaker.color);  //will provide output as "White"
}} 
```

***注意：现在，一旦您将扬声器的颜色更改为 final，此代码将不会执行，因为 final 关键字确保该字段的值永远不会改变。***

```
public class Speaker {

static final String color = "Black";

}

public class Sample {

public static void main(String args[]) {
    System.out.println(Speaker.color); //should provide output as "Black"
            Speaker.color = "white"; //Error because the value of color is fixed.  
    System.out.println(Speaker.color); //Code won't execute.
}} 
```

您可以将此代码直接复制/粘贴到您的模拟器中并尝试。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-04-01T18:34:23.193

容易区分，

**Final**：表示变量的值是 Final 并且不会在任何地方改变。如果你说 final x = 5 这意味着 x 不能改变，它的值对每个人都是最终的。

**静止的**: 表示它只有一个对象。假设您有 x = 5，在内存中有 x = 5 并且它存在于一个类中。如果您创建类的对象或实例，这意味着有一个表示该类及其变量和方法的特定框。如果您创建该类的其他对象或实例，则意味着同一类的两个盒子在内存中具有不同的 x。如果您在不同的位置调用两个 x 并更改它们的值，那么它们的值将会不同。框 1 有 x，其中 x = 5，框 2 有 x = 6。但如果你将 x 设为静态，则意味着它不能再次创建。您可以创建类对象，但该对象中不会有不同的 x。如果 x 是静态的，那么框 1 和框 2 都将具有相同的 x，其值为 5。是的，我可以在任何地方更改静态的值，因为它不是最终的。因此，如果我说框 1 有 x，我将其值更改为 x = 5，然后我制作另一个框，即框 2，我将框 2 x 的值更改为 x = 6。那么因为 X 是静态的，所以两个盒子都有相同的 x。并且两个框都会将框的值设为 6，因为框 2 将 5 的值覆盖为 6。

Both final and static are totally different. Final which is final can not be changed. static which will remain as one but can be changed.

"This is an example. remember static variable are always called by their class name. because they are only one for all of the objects of that class. so Class A has x =5, i can call and change it by A.x=6; "

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-12-07T23:56:41.500

static 和 final 有一些很大的区别：

静态变量或类总是可以从（几乎）任何地方获得。final 只是一个关键字，表示不能更改变量。所以如果有：

```
public class Test{    
   public final int first = 10;
   public static int second = 20;

   public Test(){
     second = second + 1
     first = first + 1;
   }
} 
```

该程序将一直运行，直到它尝试更改“第一个”整数，这将导致错误。在这个类之外，如果你已经实例化了这个类，你将只能访问“first”变量。这与始终可用的“秒”相反。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-12-07T23:50:16.157

静态是类中的任何对象都可以调用的东西，它本质上属于对象类型。

一个变量可以是整个类的最终变量，这仅仅意味着它不能再更改。它只能设置一次，再次尝试设置将导致抛出错误。出于多种原因，它很有用，也许您想声明一个无法更改的常量。

一些示例代码：

```
class someClass
{
   public static int count=0;
   public final String mName;

   someClass(String name)
   {
     mname=name;
     count=count+1;
   }

  public static void main(String args[])
  {
    someClass obj1=new someClass("obj1");
    System.out.println("count="+count+" name="+obj1.mName);
    someClass obj2=new someClass("obj2");
    System.out.println("count="+count+" name="+obj2.mName);
  }
} 
```

Wikipedia 包含[java 关键字](http://en.wikipedia.org/wiki/List_of_Java_keywords)的完整列表。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-12-08T00:03:24.093

我不会尝试在这里给出完整的答案。我的建议是专注于了解它们每个人的作用，然后应该清楚地看到它们的效果是完全不同的，以及为什么有时它们会一起使用。

`static`用于类的成员（属性和方法），并且必须与实例（非静态）成员对比来理解。我建议阅读Java 教程中的[“了解实例和类成员”](http://docs.oracle.com/javase/tutorial/java/javaOO/classvars.html)。我也可以在`static`块中使用，但一开始我不会担心它。

`final`如果应用于变量、方法、类或其他一些情况，则具有不同的含义。在这里，我更喜欢[维基百科的解释](http://en.wikipedia.org/wiki/Final_%28Java%29)。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2018-11-21T16:26:22.013

尽管变量的一个副本遍历应用程序，但静态变量值可以更改，而最终变量值可以初始化一次，并且不能在整个应用程序中更改。*

# security - 编译前保护 SWF

> ID：13772828
> 
> 赞同：4
> 
> 时间：2012-12-07T23:48:50.757
> 
> 标签：security, flash, data-protection

GOOGLE 充满了所谓的 SWF 加密器/混淆器/储物柜。但其中 99% 会导致复杂应用程序中的错误。在具有导入 3D 库或使用外部文件的应用程序中。或者在内部包含数千行代码并且内部包含许多动画的复杂应用程序中。

我一直在使用 KINDISOFT 软件，我的团队使用 ADOBE FLASH CS5 和 CS6 以及 FLEX 开发了 200 多个游戏。从 FLEX 生成的 SWF 能够被 KINDISOFT 和其他 SWF 保护程序编码，而由 ADOBE FLASH 导出的其他 SWF 文件非常混乱，以至于从一开始就开始出现错误。

所以我有两个问题：

a) 当使用 SWFENCRYPT 或 secureSWF 等软件或其他类似产品作为 SWF 文件的输入时，他们实际上反编译了您的文件，插入混淆和一些安全性，然后重新编译？或者他们只是改变字节码？

b) 有没有办法在原始源文件中插入保护，这样可以大大降低出现错误的风险？

这个问题的目的是在编译之前找出如果您有源代码，如何保护您的 FLASH 应用程序，以便在编译后，代码将 100% 正常运行，而不是在编译后保护您的 SWF 并冒着生成的风险错误。

感谢您的时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T11:28:28.053

我认为混淆软件正在改变字节码。例如，过去添加了用于破坏反编译器的无效字节码，而 Flash Player 仍然可以正确播放 swf。这是无休止的剑与盾之战（但似乎混淆器处于更好的位置。）
更具体地说，如果您的应用程序在混淆后中断 - 您可以做什么：

*   从混淆中排除动画剪辑等脆弱资源。如果您绝对需要保护它们，您可以使用 RC4 之类的简单算法对它们进行加密（速度很快）并在受混淆器保护的部分进行解密（请参阅[as3crypto](http://code.google.com/p/as3crypto/)）。
*   与 KindiSoft 合作，向他们发送错误报告以及损坏的 swf 示例。
*   添加您自己的混淆方法，例如在图片/其他资源中隐藏逻辑。

# c - 我将如何从命令行扫描短语？

> ID：13772829
> 
> 赞同：1
> 
> 时间：2012-12-07T23:48:52.800
> 
> 标签：c, syntax, if-statement

我目前正试图让我的程序以我想要的方式工作。我目前可以从命令行（无限量）打开任何文本文件并显示它们。我想对此进行扩展，让用户输入格式化显示文本的短语。我之前发布了一个类似的问题，我得到了一些很好的答案，但我不能使用 getopt()。否则如何扫描命令行以查找“-w”和数字，因此“-w5”和没有数字的“-s”。这是我唯一希望能够检测到的两件事。我不介意 if 语句，我希望我的朋友中的程序最短，但在这一点上，我只想完成它。有任何想法吗？多个 if 语句是我朋友的想法，我个人认为这是不需要的，但如果那样的话 这是我必须做的……如果其他人有任何想法，那将非常有用。我只想让我的程序从命令行检测这两个字符。我对 C 还很陌生（我只编写了几个程序），但我学习起来比较熟练，我尝试过谷歌搜索并自己尝试，但对 C 很陌生，试图通过它找到我需要的东西所有其他文字和行话都很困难。

任何东西都会有用的，谢谢。

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char **argv)
{

int l = 1;
    while(l != argc)
{
        FILE *fp; 

    fp = fopen(argv[l], "rb");
    l++; 

if (fp != NULL) 
{
    int i = 1;
    do
    {
        i = fgetc(fp);   
        printf("%c",i);
        printf(" ");
    }
    while(i!=-1);
    fclose(fp);
}
else
{
    printf("Error.\n");

}
    }
}
void scanningForWS(int argc, char **argv)
{

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:38:16.073

您应该在他们的[libc.h](http://swtch.com/usr/local/plan9/include/libc.h)文件（文件的最后）中查看 plan9 的 ARGBEGIN 和 ARGEND 宏，以了解它是如何完成的（有关其用法的示例，请参见[arg(3)](http://swtch.com/plan9port/man/man3/arg.html)）。

或者，您可以检查此机制的[完美](http://git.suckless.org/tabbed/tree/arg.h)实现，这非常好（我重新实现了它的一个版本，即使在找到不正确的标志后也可以解析参数，但它没有在任何地方发布。如果您需要，我可以发布它那）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T05:39:40.503

命令行参数在 argv 中，由于 argv 是一个数组，因此在其中找到特定元素的唯一方法是遍历，检查每个元素，直到获得所需的元素。如果您不想自己编写所有内容，那么看起来 C 在 search.h 中有一个名为 'lfind' 的方法可以执行此操作。[这是一个](http://www.codecogs.com/reference/computing/c/search.h/lsearch.php?alias=lfind)如何使用它的示例。希望有帮助：3。

此外，它的[GNU 文档](http://www.gnu.org/software/libc/manual/html_node/Array-Search-Function.html)

# android - WiFi 连接 Android 应用程序

> ID：13772835
> 
> 赞同：0
> 
> 时间：2012-12-07T23:49:49.573
> 
> 标签：android, wifi

我是一名安卓开发者。我在使用 WiFi 配置时遇到问题。当有人打开我的应用程序时，我需要连接到 WiFi。用户必须配置 WiFi，并且只有在该应用程序继续之后。我提供最近的网络列表，用户必须选择他已知的网络。用户必须输入所选网络的密码。我如何检查用户是否输入了有效/正确的密码以启用 WiFi 连接。

请指导我。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:54:03.463

您可以为[WIFI_STATE_CHANGED_ACTION](https://developer.android.com/reference/android/net/wifi/WifiManager.html#WIFI_STATE_CHANGED_ACTION)的`BroadcastReceiver`操作注册一个。然后，当 Wifi 状态发生变化时，您的接收器将被调用，因此当用户将他的手机连接到 wifi 网络时。`WifiManager`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:58:06.977

好问题。只需尝试连接到定义的 AP 并验证结果：

```
WifiConfiguration wc = new WifiConfiguration();
...
   // If password is empty, it should be left untouched
        if (!TextUtils.isEmpty(pswd)) {
            if (pswd.length() == 64) {
                // Goes unquoted as hex
                wc.preSharedKey = pswd;
            } else {
                // Goes quoted as ASCII
                wc.preSharedKey = TextUtil.convertToQuotedString(pswd);
            }
        }

int res = -1;

res = m_WifiManager.addNetwork(wc);

boolean b = m_WifiManager.enableNetwork(res, true);      

        if(b == true){

            fixSupplicant();

            m_WifiManager.saveConfiguration();

            //success
        }
        else{           
            //failed
 ....

 private void fixSupplicant() {
    final SupplicantState state = m_WifiManager.getConnectionInfo().getSupplicantState();
    boolean isReconnectDone = false;

    if ((state == SupplicantState.SCANNING)
            || (state == SupplicantState.DISCONNECTED) 
            || (state == SupplicantState.DORMANT)) {
        isReconnectDone = m_WifiManager.reconnect();;

    }

} 
```

# php - $_FILES['input']['type'] 不工作？

> ID：13772843
> 
> 赞同：0
> 
> 时间：2012-12-07T23:51:06.173
> 
> 标签：php, file-upload, jpeg

这是我的代码：

```
if ( $_FILES['photo']['type'] != "image/jpeg" )
    echo "You attempted to upload a file of type: " . $_FILES['photo']['type'] . " ... The file must be a JPEG."; 
```

如您所见......我的代码正在检查文件类型是否为JPEG......如果是，它会继续，否则，它不会。

但即使类型是 JPEG，我也不断得到它不是的回声：

“您试图上传文件类型：image/jpeg ...该文件必须是 JPEG。”

除非文件不是 JPEG，否则无法执行该 echo 语句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:02:25.450

不要相信哑剧类型。如果您想非常确定，请打开文件，读取前几个字节，然后检查它是否是 JPEG 文件头。

如果您想真正确定，请使用[`imagecreatefromjpeg`](http://php.net/manual/en/function.imagecreatefromjpeg.php)实际加载 jpeg 文件。如果这失败了，那么它显然不是一个真正的 jpeg 文件，不管 mime 类型和文件头告诉你什么。请注意，您需要有[`GD`](http://php.net/manual/en/book.image.php)可用的权限才能使用此功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T01:05:28.843

我使用一个简单的代码进行文件上传。它实际上检查文件扩展名，而不是 mime 类型。代码如下 -

```
function getFileExtention($name) {
    $split = explode('.',$name);
    $splitCount = count($split) - 1;
    return strtolower($split[$splitCount]);
}

if(getFileExtention($_FILES['input']['name'] != "jpg" && getFileExtention($_FILES['input']['name'] != "jpeg") {
  echo "You attempted to upload a file of type: " . $_FILES['photo']['type'] . " ... The file must be a JPEG.";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-29T15:38:07.760

利用`$ext = pathinfo($_FILES["$key"]['name'], PATHINFO_EXTENSION);`

信息直接来自 PHP 的 api。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-08T01:24:28.497

依赖`$_FILES`数组中给出的 mime 类型或文件名是不安全的，因为它们是由浏览器给出的。

改为使用`finfo_file`，它将根据文件的标题/内容在服务器端检查：

```
$finfo = finfo_open(FILEINFO_MIME_TYPE);
$mimeType = finfo_file($finfo, $_FILES['input']['tmp_name']);
if ($mimeType != "image/jpeg") {
    echo "You attempted to upload a file of type: " . $mimeType . " ... The file must be a JPEG.";
}
finfo_close($finfo); 
```

有关文档，请参阅[http://php.net/manual/en/function.finfo-file.php](http://php.net/manual/en/function.finfo-file.php)。

# extjs - ExtJS4.0中如何将网格导出到XLS

> ID：13772849
> 
> 赞同：1
> 
> 时间：2012-12-07T23:51:34.743
> 
> 标签：extjs

有没有一种简单的方法可以将网格数据导出到 ExtJS 中的 XLS。

如果没有，我正在尝试以下方式。

我正在尝试读取控制器内的数据存储。数据存储已被网格使用。我想通过单击按钮读取数据并通过 AJAX 将其发送到服务器。稍后在服务器内部，我将检索数据并写入 XLS。在这种情况下，我可以通过什么方式读取控制器内的数据？

在这里输入代码

```
Ext.define("MyApp.controller.GridController", {
extend : 'Ext.app.Controller',
views: ['performance.grid.PerformanceGrid'],
models: ['GridModel'],
stores: ['GridStore'],
refs : [{
    ref : 'mainTabPanel',
    selector : 'portal > tabpanel'
}],
init : function() {
     this.control({
         'portal toolbar > button[itemId=xls]' : {
             click : this.onAddTab
         },

         'portal toolbar > button[itemId=pdf]' : {
             click : this.onAddPortlet
         }
     });
},
onAddTab : function(btn, e) {
   // I want to read the datastore here and make an AJAX call
 },

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T03:34:44.890

```
onAddTab: function(btn, e){
   var store = // get the store reference probably doing Ext.getStore('the store');
   var records = store.data.items.map(function(r){ return r.data });

   // send it all to your server as you want to
   // Ext.ajax.Request({
   //    url: 'the url',
   //    data: records,
   //    method: 'POST'
   // });
}); 
```

我没有测试它，但它必须工作。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-12T01:45:45.133

我认为该过程不是最好的，因为您将拥有 3 个有效负载（没有任何意义的数据往返）

1.  您调用服务器方法来获取将填充到网格中的数据。

2.  JSON 对象（包含服务器数据）然后将再次传送到服务器

    > > （**这对我来说没有意义......为什么当服务器是源时你想向服务器发送数据？？**）

3.  服务器将从 JSON 响应中处理您的对象，然后动态创建文档并将其发送回服务器。

> 我认为你应该做的是以下几点：

1.  从服务器获取数据并绑定您的网格。
2.  获取`store proxy URL`并解析方法，`extraParams`这样您就知道谁为网格提供服务以及您向服务器提出了什么要求。
3.  `common method`在服务器上创建一个接收 a`method`和一个`array of parameters`. 然后在此方法中根据方法创建逻辑，调用您的数据存储库（您的第一个请求获取数据的相同存储库），处理文档并将文件发送回服务器。

这样你应该有这样的东西：

```
webmethod(string method, object[] params) {

   switch(method){
      case "GetTestGridData":
           // here you call your Repository in order to get the same data 
           GeneralRepo repo = new GeneralRepo();
           var data = repo.GetTestGridData(object[0],object[1]); 

         break;
   }

   byte[] fileStream = Reports.Common.Generate(data, ExportType.PDF);
   // response the stream to client...

} 
```

# java - 在超类表中使用类的方法（Java）

> ID：13772850
> 
> 赞同：0
> 
> 时间：2012-12-07T23:51:43.350
> 
> 标签：java, class

我正在处理一个java项目，我有两个类（对于这个主题，不在项目中）：类“Objet”和类“Cle extends Objet”，方法“getNumero（）”只在Cle。在我的主要，我写了这段代码：

```
Objet[] objets = Scenario.objets;
for (int i=0;i<objets.length;i++)
{
    if(objets[i].getClass() == modele.Cle.class 
    && objets[i].getNumero() == salle.getPorte(direction).getNumero()){}
} 
```

问题出在“if”的第二部分，类 Objet 没有方法“getNumero()”，所以我检查 Objet 是否是 Cle，但 java 不明白，如果我的第一部分“如果”为真，则第二部分是可能的。有人可以说是否可以从对象中提取 Cle，以及如何？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:54:37.160

使用显式强制转换，常见的成语是：

```
if (objets[i] instanceof Cle) {
   Cle aCle = (Cle) objets[i];
   aCle.getNumero(); // works
} else {
   ... // fail?
} 
```

进一步观察并根据具体情况，您可以将`getNumero()`其作为抽象方法添加到`Objet`，而不是强制转换。如果您不能这样做，也许您可​​以研究泛型以使您的`Objet`实例供应商能够提供`Cle`实例。这又取决于具体情况。

# objective-c - Objective-C：__block 不工作

> ID：13772851
> 
> 赞同：0
> 
> 时间：2012-12-07T23:51:45.880
> 
> 标签：objective-c, afnetworking

我不知道如何更改`results`成功块内部的值。我`__block`像一些帖子建议的那样使用，但`results`永远为零。我在块内设置断点并确保它`JSON`不是零，它按我的预期下载数据。

如果相关，我正在使用 AFNetworking 库。

```
+(NSArray *)eventsByCityID:(NSString *)cityID startIndex:(NSUInteger)start count:(NSUInteger)count
{
    __block NSArray *results = nil;

    [[DoubanHTTPClient sharedClient] getPath:@"event/list" parameters:@{@"loc":dataSingleton.cityID} success:^(AFHTTPRequestOperation *operation, id JSON) {
        results = [JSON valueForKey:@"events"];
    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {
        NSLog(@"download events error: %@ \n\n",error);
    }];

    return results;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:55:34.307

更有可能的是，[名称非常糟糕的]方法`getPath:parameters:success:failure:`是异步的。

因此，您需要告诉成功块中的某些内容该值已更改。IE

```
^{
     [something yoManGotEvents:[JSON valueForKey:@"events"]];
 } 
```

（方法不应该`get`在非常特殊的情况下使用前缀。具有大量 API 的第三方库在上述情况之外使用该前缀提出了他们可能不遵循的其他系统特定模式的问题。）

# google-apps-script - 时间预订示例 Google Apps 脚本教程失败，出现错误“无法调用 null 的方法“getColumnWidth”。第 327 行

> ID：13772852
> 
> 赞同：0
> 
> 时间：2012-12-07T23:51:58.857
> 
> 标签：google-apps-script, google-sheets, google-spreadsheet-api, google-sites

在此处遵循教程时：[https ://developers.google.com/apps-script/articles/building-sites-app-part1](https://developers.google.com/apps-script/articles/building-sites-app-part1)

我复制并修改了示例代码等。当我尝试运行它时，出现错误：

TypeError：无法调用 null 的方法“getLastRow”。（第 327 行）

错误。

这是该页面的第 326、327 行：

326) var sheet = SpreadsheetApp.openById(SPREADSHEET_ID).getSheetByName("TimeBooking"); 第327章

如果我故意编辑 .getSheetByName 的字符串以使其出错，那么我会在第 326 行收到错误消息，告诉我找不到工作表。很好，它应该无法通过该测试。如果我确保第 326 行是正确的，它会静默运行而没有错误，但第 327 行会输出空错误。

如果工作表对象无效，为什么第 326 行没有警告我呢？

请注意，无论是直接在应用程序编辑器中运行此代码，还是发布 URL 并从我的站点页面将其作为 google Apps 小部件运行，我都会收到相同的空错误。

有任何想法吗？我正在尝试学习基础知识，但在我的第一个“复制和粘贴”示例中遇到了困难（哈哈！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T02:13:31.913

好吧，我想通了——我的编辑破坏了这个例子。我迷失了语义，确实重命名电子表格是问题所在。

我将整个电子表格的名称与所述电子表格中单个工作表的名称混淆了。

整个电子表格的名称无关紧要，因为您使用电子表格 ID 来打开它（这是电子表格 URL 中的一个键）。

电子表格中第一个“工作表”的名称是相关的，并且必须与源代码中的 ascii 名称匹配。

不幸的是，我将电子表格命名为 TimeBookingExample，但没有注意到电子表格中的第一张表格名为 TimeBooking。

因此 getSheetByName() 函数需要电子表格中第一张工作表的名称，而不是整个电子表格文档的名称。

326) var sheet = SpreadsheetApp.openById(SPREADSHEET_ID).getSheetByName("TimeBooking");

为什么第 326 行失败时不报错？那会让我立即找到我的错误..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T01:35:39.907

当一条错误消息说有关`getColumnWidth`您的信息时，应查找使用的代码行`getColumnWidth()`（使用命令 F 或控制 F 来帮助您）并查看该语句适用于哪个对象。

另外：您检查过工作表名称吗？您在问题中提到了工作表名称（“TimeBookingExample”），但您显示的代码谈到了另一个工作表名称（“TimeBooking”）......我有点困惑。

**编辑：** *这个答案的第一部分不再有意义，因为问题已被编辑*

# python - 使用 Flot 和 MySQL 绘制数据

> ID：13772857
> 
> 赞同：0
> 
> 时间：2012-12-07T23:52:45.663
> 
> 标签：python, mysql, flot

所以我正在尝试创建一个实时的数据图，这些数据正在记录到 SQL 服务器中。格式如下：

数据库：testDB 表：sensors 第一条记录包含 3 条记录。第一列是从 1 开始的自动递增 ID。第二列是纪元格式的时间。第三列是我的传感器数据。它采用以下格式：

23432.32 112343.3 53454.322 34563.32 76653.44 000.000 333.2123

我完全不知道如何完成这个项目。我已经阅读了许多页面显示示例并没有真正理解它们。他们提供源代码，但我不确定该代码的去向。我在我的服务器上安装了 httpd，这就是我的立场。有谁知道我可以遵循的从头到尾的好方法？或者有人可以逐步发布一个好的步骤让我遵循吗？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T03:40:05.487

1.  安装 httpd 服务器
2.  安装 php
3.  编写一个 php 脚本从数据库中获取数据并将其呈现为网页。

这是一个相当复杂的请求，给出的细节相对较少。更多信息将使我们能够给出更好的答案。

# iphone - Xcode / Simulator iPhone 弄乱了显示

> ID：13772858
> 
> 赞同：0
> 
> 时间：2012-12-07T23:52:49.090
> 
> 标签：iphone, xcode, ios-simulator

![在此处输入图像描述](../Images/48b88473d3d25926225f2b74ebe6f0e3.png)

如您所见，模拟器缺少某些按钮上的文本。在 YouTube 上的 TapCounter 演示中，我也看到了同样的行为。

另一个问题（屏幕截图中未显示）是，如果您按下 TapCounter 上的任何键，NSString stringWithFormat（见下文）

```
- (IBAction)add {
       count++;
       number.text = [NSString stringWithFormat:@"%i", count];
   } 
```

执行 stringWithFormat 行的行为会破坏标签上的格式并将其恢复为默认值。

如您所见，我确实确保了模拟器大小和开发大小相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:03:45.047

这个问题在这个网站上出现了几次。一旦我能够解释说明，[这个相关问题](https://stackoverflow.com/questions/13452566)的答案对我有用。包括获得崩溃并修复它。

稍后：关闭自动布局的修复似乎足以让 6.0 模拟器工作 - 您可能想先尝试一下，看看是否所有其他的东西真的是必要的......

# visual-studio-2012 - 如何在 InstallShield Limited Edition 中的产品输出上使用非广告快捷方式

> ID：13772859
> 
> 赞同：1
> 
> 时间：2012-12-07T23:53:00.980
> 
> 标签：visual-studio-2012, installshield-le

我已将 Visual Studio 安装项目 (MSI / vdproj) 导入 InstallShield Limited Edition (ISLE) 并从中构建了一个 setup.exe 安装程序。在“配置目标系统”下的“快捷方式/文件夹”页面中，它显示我的其他项目的“主要输出”的快捷方式都是广告快捷方式。我需要非广告快捷方式。

我可以右键单击快捷方式的包含文件夹并选择新建快捷方式并指向一个不是项目输出的 EXE，它会将其创建为普通快捷方式。如果我对我的项目中的“主要输出”目标之一执行相同操作，它会显示为广告快捷方式。

当我使用 Visual Studio 2005 的内置安装项目创建输出 MSI 时，我会针对它运行查询以禁用广告快捷方式。我已经阅读了一些意见，认为缺乏对此功能的控制是 MS 将这些安装程序交给第三方的原因之一，但在这里我似乎对所创建的快捷方式类型的控制较少。

如何强制从我的解决方案的其他项目中指向“主要输出”目标的快捷方式为非广告快捷方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T09:02:07.553

使所有广告快捷方式不被广告的最简单方法是设置 DISABLEADVERTISEDSHORTCUTS 属性。这是非 IS 特定的。（http://msdn.microsoft.com/en-us/library/windows/desktop/aa368297%28v=vs.85%29.aspx）。

您可以在安装时在属性表、转换或命令行中设置该属性。

否则，您可以在快捷方式表中单独更改每个快捷方式的目标列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T18:56:16.220

限量版似乎没有办法。我在他们的论坛上问过，但没有得到答复，一个多月以来没有人在这里回答。我刚刚学会了接受广告中的捷径。

答案似乎是从限量版升级到可以让您进一步操作 MSI 的版本，或者使用其他一些软件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T13:25:33.990

InstallShield Limited Edition 的设计（遗憾的是恕我直言）完全匹配安装和部署项目中的功能。所有快捷方式之前都在旧工具中进行了宣传，因此它们在新工具中也是如此。

明智地选择你的工具。

# youtube-api - 如何从 youtube 视频的控制栏中删除暂停？

> ID：13772860
> 
> 赞同：0
> 
> 时间：2012-12-07T23:53:01.963
> 
> 标签：youtube-api

我有一个嵌入了 youtube 视频的页面。我想保留控制栏的一部分——显示进度并且用户可以来回拖动的部分。但我不想保留控制栏的暂停/播放功能。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:02:52.367

如果你是一个 Youtube Javascript API，如果你可以在你想要的事件中播放、停止和视频！请参阅文档...

# ruby-on-rails - 如何在选择标签中硬编码键值选项对

> ID：13772862
> 
> 赞同：3
> 
> 时间：2012-12-07T23:53:06.733
> 
> 标签：ruby-on-rails

我在任何地方都找不到有关如何在 select 标记中硬编码 HTML 的教程。

我只需要这个：

```
<select name="cron[day]">
 <option value='0'>Sunday</option>
 <option value='1'>Monday</option>
 <option value='2'>Tuesday</option>
 <option value='3'>Wednesday</option>
 ...
</select> 
```

不想为此制作一张特殊的桌子。还是我应该？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T23:59:56.413

不，不需要创建表。它看起来像：

```
select "cron", "day", [[ "Sunday", 0 ], [ "Monday", 1 ], ["Tuesday", 2], [etc..]] 
```

将选项粘贴在助手中可能会更好，而不是让它们出现在您的视图中。

# android - 申请使用/获取短信短码

> ID：13772864
> 
> 赞同：0
> 
> 时间：2012-12-07T23:53:21.777
> 
> 标签：android, iphone, sms

我已经搜索了谷歌，但没有找到我正在寻找的答案。我想创建一个应用程序，用户可以在其中发送带有特定文本字符串“示例：`IN`”的 SMS 短代码号码，然后如果它与特定关键字匹配，它将在服务器上运行命令。基本上它会更新数据库，然后将消息发送回用户。我的问题是如何获得 SMS 短代码号码？我如何将它与服务器链接？哪种编程语言对于完成任务最有效和最有效？我在“HTML、JavaScript、PHP 和 C”方面有一点编程经验，如果需要，我愿意学习更多的语言。如果有人可以为我回答这些问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:56:24.633

[Twilio](http://www.twilio.com/sms/shortcodes)将其与其他电话服务一起提供。我实际上并没有使用过他们的短信服务，但我听说过关于公司的好消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T23:14:21.683

只需不到专用短代码价格的 1/100，您就可以从[TextMarks 之类的“共享短代码”提供程序](http://www.TextMarks.com/api/)开始。TextMarks 拥有“41411”短代码，您可以在其上租用关键字以用于您自己的应用程序。

您配置一个回调 URL，任何以您的关键字开头的传入 SMS 消息都会作为 HTTP 请求路由到您自己的 Web 服务器。如果您回复任何内容，您的消息甚至会作为另一个 SMS 回复返回给用户。

更多信息：

*   [TextMarks SMS 自动回复 API 概述](http://www.TextMarks.com/api/sms-auto-response/)

[披露：我构建了大部分 TextMarks API！问我什么。]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T23:59:11.063

您将需要一个不常见的 SMS 服务器。所以你应该寻找像[SMSMode](http://www.smsmode.com/ms/index.jsp?lang=en)或[Essendex](http://www.esendex.us/)这样的供应商。但是您必须付费才能接收和发送短信。

# actionbarsherlock - 谷歌播放 ActionBarSherlock 中的 NoClassDefFoundError

> ID：13772866
> 
> 赞同：1
> 
> 时间：2012-12-07T23:53:36.333
> 
> 标签：actionbarsherlock

我在我的项目中使用 ActionBarSherlock。当我在模拟器中打开我的项目时，它运行良好。但是，当我在 google play 上上传 apk 文件时，它给了我以下错误

```
java.lang.NoClassDefFoundError: com.actionbarsherlock.R$styleable
at com.actionbarsherlock.view.MenuInflater$MenuState.readItem(MenuInflater.java:343)
at com.actionbarsherlock.view.MenuInflater.parseMenu(MenuInflater.java:162)
at com.actionbarsherlock.view.MenuInflater.inflate(MenuInflater.java:112)
at com.parkMe.ParkMyCarActivity.onCreateOptionsMenu(ParkMyCarActivity.java:180)
at com.actionbarsherlock.app.SherlockActivity.onCreatePanelMenu(SherlockActivity.java:184)
at com.actionbarsherlock.ActionBarSherlock.callbackCreateOptionsMenu(ActionBarSherlock.java:559)
at com.actionbarsherlock.internal.ActionBarSherlockNative.dispatchCreateOptionsMenu(ActionBarSherlockNative.java:60)
at com.actionbarsherlock.app.SherlockActivity.onCreateOptionsMenu(SherlockActivity.java:149)
at android.app.Activity.onCreatePanelMenu(Activity.java:2559)
at com.android.internal.policy.impl.PhoneWindow.preparePanel(PhoneWindow.java:443)
at com.android.internal.policy.impl.PhoneWindow.invalidatePanelMenu(PhoneWindow.java:813)
at com.android.internal.policy.impl.PhoneWindow$1.run(PhoneWindow.java:3128)
at android.os.Handler.handleCallback(Handler.java:615)
at android.os.Handler.dispatchMessage(Handler.java:92)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4898)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1008)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:775)
at dalvik.system.NativeStart.main(Native Method) 
```

我试图得到4天的答案。请帮忙！

谢谢 Cem Kacmaz

# jquery-mobile - pageinit 上的 jQuery 移动弹出窗口

> ID：13772868
> 
> 赞同：4
> 
> 时间：2012-12-07T23:53:41.557
> 
> 标签：jquery-mobile, page-init

我希望在页面加载后立即打开一个弹出窗口，但似乎被旋转轮卡住了。

这是一个提琴手来演示这个问题，任何帮助都将不胜感激。

[http://jsfiddle.net/Ohpyx/UGfXG/](http://jsfiddle.net/Ohpyx/UGfXG/)

我正在使用的代码是：

```
$(document).live('pageinit',function(event){
    $('#popupBasic').popup('open');
})​ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T00:12:13.277

这对我有用：

```
$(document).on('pageinit', '.ui-page',function(event){
    setTimeout(function () {
        $('#popupBasic').popup('open');
    }, 0);//Note the comment below from @Taifun.
})​ 
```

您有一个竞争条件，这会将弹出代码放在队列的末尾。

这是一个演示：http: [//jsfiddle.net/UGfXG/6/](http://jsfiddle.net/UGfXG/6/)

注意：我替换`.live()`为`.on()`（委托风格），因为从 jQuery 1.7 开始，前者已被贬低。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-05T08:35:37.080

`.popup('open')`需要，在事件`$.mobile.activePage`之后设置。`pageinit`该`pagechange`事件似乎更适合弹出窗口。

这对我有用：

```
$(document).on('pagechange',function(event){
    $('#popupBasic').popup('open');
})​ 
```

如果您只想在第一次加载时使用它，请使用`.one`：

```
$(document).one('pagechange',function(event){
    $('#popupBasic').popup('open');
})​ 
```

见[https://github.com/jquery/jquery-mobile/issues/3384](https://github.com/jquery/jquery-mobile/issues/3384)

# firefox - 强制 Firefox 为修改的 HTML 文件重用现有选项卡

> ID：13772869
> 
> 赞同：3
> 
> 时间：2012-12-07T23:53:47.890
> 
> 标签：firefox, windows-7

如果 Firefox 已经在我的 PC 上的选项卡中显示本地 HTML 文件（地址 = "file:///..."），并且我使用我最喜欢的外部编辑器修改文件，将文件发送到 FF 以显示编辑结果在 FF 中使用原始文件的新实例打开一个*新*选项卡，而不是搜索文件是否已经打开它并重新使用该选项卡。

当然，在编辑完文件后，我可以重新打开 Firefox，沿着标签栏导航到该文件的现有标签，然后单击刷新。但 IMO FF 应该能够为我做到这一点。在我的工作中，当我需要刷新FF的时候，当前打开的选项卡不太可能是我正在编辑的文件的选项卡，所以我需要不断地回到原来的页面来刷新它。

我为解决这个问题所做的努力包括：

1) 在 about:config 中，*将 browser.link.open_newwindow* 从 3 设置为 1。

2) 运行 Firefox 并将文件名或 URL 传递给文件名（作为*-url*参数）。

3）寻找合适的插件。

我不喜欢 Firebug 或 Aurora，而是更喜欢我自己的编辑器 (EditPlus)，我更喜欢用它来编辑网页。但是，它的内置浏览器无法在我的屏幕上正确显示，所以我需要在 Firefox 中查看编辑结果。

任何人都可以提出解决这个问题的方法吗？我在这里搜索没有成功。最好的解决方案是另一个 about:config 设置。提前致谢。

（添加）毕竟，在 EditPlus 中，如果我向它发送一个已经打开的文件（以文档为中心的模式），它只会将焦点更改为现有选项卡。为什么FF不能这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T12:31:32.837

感谢您推荐“Restore Open_External”插件。

我试过了，但在这里对我没有帮助。它的作用是：

（引用）

"browser.link.open_external (Integer)。此选项指定 Firefox 如何打开外部启动的链接，例如电子邮件或 Microsoft Word。有 3 个选项可用；

```
1\. Selecting this option launches the link in a new tab in the most recently active Firefox window. This would be recommended if you don’t wish launching such links to affect your most recently active webpage and you aren’t concerned about the links content.

2\. Selecting this option launches a new Firefox window to view the link. This would perhaps be the safest option to select (In that if you launch something questionable you may be able to end the process without affecting other windows).

3\. Selecting this option (default) launches the link in the most recently active Firefox window/tab. This would be recommended if you aren’t concerned about launching links is the most recently active window/tab (You can always use the back button to view the previous page if you need)." 
```

[TechSpot - Firefox 2 调整指南](http://www.techspot.com/guides/44-firefox2-tweak-guide/page17.html)

我相信很多人都觉得这很有用。如果选项 1 不坚持打开重复选项卡，那么选项 1 对我的目的来说会很好。此附加组件无法防止打开重复的选项卡。因此，我开始寻找一些插件，以防止创建新标签以响应外部应用程序向 Firefox 发送文件。*Tab Mix Plus*应该可以做到这一点，但我在选项的迷宫中迷失了方向。然后是防止重复选项卡，它创建一个不允许重复的所有页面的白名单。这远非自动，对我来说似乎很蹩脚，就像*重复选项卡关闭*器一样，它不会阻止创建重复的选项卡；相反，您必须按 Ctrl+Alt+D 删除现有的重复选项卡 - 同样蹩脚。*去重标签*类似，但提供了一个删除重复选项卡的按钮。

也许我没有抓住重点，但我不明白为什么有人会想要同一页面的重复选项卡，一个比另一个更新的版本。事实上，FF 应该能够在重新选择选项卡时自动刷新选项卡，而无需使用“刷新”按钮。但这只是我的咆哮。

如果阅读本文的人能想到将 FF 与修改网页的外部应用程序集成的更好方法，我将不胜感激。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T00:34:20.437

安装该插件： [https ://addons.mozilla.org/en-us/firefox/addon/restore-open_external/](https://addons.mozilla.org/en-us/firefox/addon/restore-open_external/)

转到插件首选项并设置：'在当前窗口的当前选项卡中'

下次您从外部程序打开一个新 url 时，它会在同一个选项卡中打开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-21T14:50:00.063

您还可以安装 [重复选项卡更接近 Firefox 插件](https://addons.mozilla.org/fr/firefox/addon/duplicate-tabs-closer/)，顾名思义，它允许您自动关闭重复的选项卡

您可以将其配置为：

*   关闭旧标签并保留新标签
*   选择新标签

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-25T04:30:02.857

试试[这个](http://%20https://addons.mozilla.org/en-US/firefox/addon/smart-prevent-duplicate-tabs/?src=search)插件。我在 Gatsby 和 Create React App 中将其用于开发模式。

# pdf - 将PDF刮成更友好的东西

> ID：13772874
> 
> 赞同：0
> 
> 时间：2012-12-07T23:54:18.263
> 
> 标签：pdf, text

我有几份 PDF 格式的文件，几乎都是抄本。我正在寻找一种方法来搜索这些成绩单（并使其自动化）并从本质上刮掉对话/标题/等。到原始数据（例如“X 说了多少次 Y？”）

有没有一种方法可以将 PDF 转换为更友好的格式（例如 HTML 或伪 HTML），这样我可以准确地看到发生了什么？

我目前正在使用一个刮刀，它将所有包含的文本转换为一个 txt 文件，这很有用，除了它会抛出格式（粗体语句等），这会使生活变得更轻松。

任何使用 Python 以这种方式浏览 PDF 的方法都将受到赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-08T03:46:25.383

您可以查看我们的开源库 PDF2JSON。它将所有文本数据转换为 JSON 或 XML，以便您更轻松地检查它

[http://code.google.com/p/pdf2json](http://code.google.com/p/pdf2json)

# python - 无法使用 pygame.image.load() 看到图像

> ID：13772875
> 
> 赞同：0
> 
> 时间：2012-12-07T23:54:25.583
> 
> 标签：python, pygame

启动程序时看不到图像。我有一个名为“game”和“mygame.py”的文件夹，其中包含一个“background.png”。我尝试使用 PATH "/game/background.png" 而不是 "background.png" 但它似乎不起作用。有任何想法吗？

我的代码：

```
import pygame , sys 

pygame.init()

#screen start
def screen():
    screen = [1024,768]
    screen = pygame.display.set_mode(screen,0,32)
    pygame.display.set_caption("Testing Caption")
    background = pygame.image.load("background.png")
    screen.blit(background, (0,0))

    while True:
      screen.blit(background, (0,0))
      #keyboard commands
      for event in pygame.event.get():
          if event.type == pygame.QUIT:
              pygame.quit()   

screen() 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T19:35:39.637

您错过了翻转/更新电话：

```
clock = pygame.time.Clock()

while True:

  #keyboard commands
  for event in pygame.event.get():
      if event.type == pygame.QUIT:
          pygame.quit()

  screen.blit(background, (0,0))

  pygame.display.flip()

  clock.tick(40)  # keep program running at given FPS 
```

每个 blit 都发生在内部缓冲区中，您需要每帧调用一次翻转或更新来更新真实屏幕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T00:30:26.773

据我所知，您可以使这项工作成为两种方式之一。

您可以使用文件的绝对路径，例如：

```
"C:\path_to_game_folder\game\background.png" 
```

或者您可以使用相对路径。为此，将以下代码添加到您的程序中：

```
import os
dir = os.path.dirname(__file__)
backgroundFile = os.path.join(dir, "background.png") 
```

并改变：

```
pygame.image.load("background.png") 
```

至

```
pygame.image.load(backgroundFile) 
```

我建议尽可能使用相对路径，它可以保持代码的可移植性，并使其更易于维护和分发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T04:20:43.757

我知道了！使用 pygame 重要的是`pygame.display.update()`在`while True:`screen.flip 中使用“”来刷新或更新屏幕。感谢之前回复的用户。

完整代码：

```
import pygame , sys

pygame.init()

#screen start
def screen():
    width , height = 1280,768
    screen = pygame.display.set_mode((width,height))
    pygame.display.set_caption("Testing Caption")
    background = pygame.image.load("background.jpg")
    screen.blit(background, (0,0))

    while True:
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                pygame.quit()

        screen.blit(background, (0,0))
        pygame.display.update()

screen() 
```

# android - Phonegap Android 内联 SVG

> ID：13772878
> 
> 赞同：3
> 
> 时间：2012-12-07T23:54:43.133
> 
> 标签：android, cordova, svg, svg-filters

我正在使用 Phonegap 开发一个只能在 Nexus 7 上使用的 Android 应用程序。

在 index.html 中，我有一个内联 svg，它绘制了一些漂亮的圆圈并产生了脉冲效果。

它在计算机上的 Chrome 和 Nexus 7 上的 Chrome 中运行良好。但是，当我编译 .apk 或让 Eclipse 将应用程序的调试版本推送到设备时，svg 不会显示。

应用程序的背景图像和所有其他菜单元素也会显示，只是中间 svg 区域中的项目不显示。

这是svg代码段：

```
<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events" width="100%" height="100%" viewBox="0 0 800 1205">

<radialGradient id = "blipPulse" cx = "50%" cy = "50%" r = "50%">

    <stop stop-color = "#3ddeed" offset = "0%" stop-opacity = "0.2">
        <animate attributeName="stop-opacity" begin="0s" dur="3s" values="1;0;1" repeatCount="indefinite" />
    </stop>
    <stop stop-color = "#3ddeed" offset = "0%" stop-opacity = "1">
        <animate attributeName="offset" begin="0s" dur="3s" values="0;1;1;0" repeatCount="indefinite" />
        <animate attributeName="stop-opacity" begin="0s" dur="3s" values="0;1;0;0" repeatCount="indefinite" />
    </stop>

    <stop stop-color = "#3ddeed" offset = "2" stop-opacity = "0">
</radialGradient>
<defs>
    <g id="blip">
    <circle cx = "0" cy = "0" r = "20" fill = "url(#blipPulse)" stroke = "#3ddeed" stroke-width = "2" opacity="0.3"/>
    <circle cx = "0" cy = "0" r = "7" fill = "#3ddeed" stroke = "none" stroke-width = "0"/>
    </g>
    <path id="hex" d="m 0 -60 L 52 -30 L 52 30 L 0 60 L -52 30 L -52 -30 L 0 -60" fill="rgba(255,255,255,0.15)" />
</defs>

<radialGradient id = "g1" cx = "50%" cy = "50%" r = "50%">
    <stop stop-color = "#3ddeed" offset = "0%"  stop-opacity = "0"/>
    <stop stop-color = "#3ddeed" offset = "60%" stop-opacity = "0"/>
    <stop stop-color = "#3ddeed" offset = "86%" stop-opacity = "0.1"/>
    <stop stop-color = "#3ddeed" offset = "100%" stop-opacity = "0.25"/>
</radialGradient>
<filter id = "fearth" x = "0%" y = "0%" width = "100%" height = "100%">
    <feImage xlink:href = "assets/earth.png"/>
</filter>
<filter id = "fasteroid1" x = "0%" y = "0%" width = "100%" height = "100%">
    <feImage xlink:href = "assets/Asteroids/ice1.png"/>
</filter>
<filter id = "fasteroid2" x = "0%" y = "0%" width = "100%" height = "100%">
    <feImage xlink:href = "assets/Asteroids/ice2.png"/>
</filter>
<filter id = "fasteroid3" x = "0%" y = "0%" width = "100%" height = "100%">
    <feImage xlink:href = "assets/Asteroids/iron1.png"/>
</filter>
<filter id = "fasteroid4" x = "0%" y = "0%" width = "100%" height = "100%">
    <feImage xlink:href = "assets/Asteroids/iron2.png"/>
</filter>
<filter id = "ffleetcolor" x = "0%" y = "0%" width = "100%" height = "100%">
    <feImage xlink:href = "assets/Asteroids/fleeticoncolor.png"/>
</filter>
<filter id = "ffleetgray" x = "0%" y = "0%" width = "100%" height = "100%">
    <feImage xlink:href = "assets/Asteroids/fleeticongray.png"/>
</filter>
<filter id = "fdeployarrow" x = "0%" y = "0%" width = "100%" height = "100%">
    <feImage xlink:href = "assets/Asteroids/deployarrow.png"/>
</filter>

<g id="mapcenter" transform="translate(400,600)">
<g id="map" transform="scale(1) translate(0,0)">
<circle cx="-800" cy="0" r="800" id="orbit" />
<circle id="rangering" cx="0" cy="0" r="400" fill="url(#g1)" transform="scale(0)" />
<g id="blips">
    <use id="loc0" x = "100" y = "150" xlink:href = "#blip" opacity="0" />
    <use id="loc1" x = "-180" y = "110" xlink:href = "#blip" opacity="0" />
    <use id="loc2" x = "230" y = "-70" xlink:href = "#blip" opacity="0" />
</g>
<circle cx="0" cy="0" r="17" fill="blue" filter="url(#fearth)" id="earth" />
<g id="asteroidfield" transform="translate(100,150) scale(0.05)">
    <circle cx="48" cy="-146" r="25" fill="grey" filter="url(#fasteroid1)" id="asteroid1" />
    <circle cx="-120" cy="-230" r="25" fill="grey" filter="url(#fasteroid2)" id="asteroid2" />
    <circle cx="190" cy="90" r="25" fill="grey" filter="url(#fasteroid3)" id="asteroid3" />
    <circle cx="-277" cy="270" r="25" fill="grey" filter="url(#fasteroid4)" id="asteroid4" />
</g>
<g id="asteroidinfo">
    <rect x="-30" y="-105" width="60" height="45" fill="red" filter="url(#fdeployarrow)" id="deployarrow" />
    <circle cx="0" cy="-125" r="45" fill="blue" filter="url(#ffleetcolor)" id="fleetcolor" />
    <circle cx="0" cy="0" r="45" fill="blue" filter="url(#ffleetgray)" id="fleetgray" />
    <g id="h2ohex" transform="translate(108,-125)">
        <use id="h2ohex" xlink:href = "#hex" opacity="1" />
        <text x = "0" y = "0" class="hexValue">60</text>
        <text x = "0" y = "30"  class="hexLabel">H<tspan baseline-shift = "sub" font-size="0.7em">2</tspan>O</text>
    </g>
    <g id="fehex" transform="translate(180,0)">
        <use xlink:href = "#hex" opacity="1" />
        <text x = "0" y = "0" class="hexValue">50</text>
        <text x = "0" y = "30"  class="hexLabel">Fe</text>
    </g>
    <g id="pthex" transform="translate(108,125)">
        <use xlink:href = "#hex" opacity="1" />
        <text x = "0" y = "0" class="hexValue">10</text>
        <text x = "0" y = "30"  class="hexLabel">Pt</text>
    </g>
</g>

</g>
</svg> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T05:10:38.343

Nexus 7 的嵌入式 webview 仍然是 Android 4x 浏览引擎 - 它不支持过滤器。

# iphone - 如何在方向更改时切换视图

> ID：13772880
> 
> 赞同：0
> 
> 时间：2012-12-07T23:54:56.780
> 
> 标签：iphone, ios, ipad, optimization, screen-orientation

我目前正在创建一个具有六个视图的应用程序，每个视图都专用于*设备类型*和*方向*的组合。如果您不明白我的意思，我将标记所有六种组合：

*   iPhone4_(320x480) & 肖像
*   iPhone4_(320x480) & 横向
*   iPhone5_(320x568) & 肖像
*   iPhone5_(320x568) & 横向
*   iPad_(768x1024) & 肖像
*   iPad_(768x1024) & 横向

我知道经历所有这些麻烦似乎有点愚蠢，但在这种情况下这是必需的。无论如何，我一直在尝试将 Apple 的[编程指南中的解决方案与](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/RespondingtoDeviceOrientationChanges/RespondingtoDeviceOrientationChanges.html)[TheAppCodeBlog](http://www.theappcodeblog.com/2011/03/30/orientation-change-tutorial-change-the-view-when-the-orientation-changes/)上的在线教程中给出的方法结合起来。

`ViewController.m`-->`ViewDidLoad`方法

```
[[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(orientationChanged:) name:@"UIDeviceOrientationDidChangeNotification" object:nil]; 
```

`ViewController.m`-->`orientationChanged`方法

```
- (void) orientationChanged:(NSNotification *)object
{
    UIDeviceOrientation deviceOrientation = [[object object] orientation];
    if (deviceOrientation == UIInterfaceOrientationPortrait && [UIScreen mainScreen].bounds.size.height == 480.0)
    {
        self.view = self.portrait4View;
    }
    else if ((deviceOrientation == UIInterfaceOrientationLandscapeLeft) || (deviceOrientation == UIInterfaceOrientationLandscapeRight)) && [UIScreen mainScreen].bounds.size.height == 480.0)
    {
        self.view = self.landscape4View;
    }
    else if (deviceOrientation == UIInterfaceOrientationPortrait && [UIScreen mainScreen].bounds.size.height == 568.0)
    {
        self.view = self.portrait5View;
    }
    else if ((deviceOrientation == UIInterfaceOrientationLandscapeLeft) || (deviceOrientation == UIInterfaceOrientationLandscapeRight)) && [UIScreen mainScreen].bounds.size.height == 568.0)
    {
        self.view = self.landscape5View;
    }
    else if (deviceOrientation == UIInterfaceOrientationPortrait && [UIScreen mainScreen].bounds.size.height == 1024.0)
    {
        self.view = self.portraitPadView;
    }
    else
    {
        self.view = self.landscapePadView;
    }

} 
```

每个视图的界面生成器设置：

![界面生成器](../Images/1c0939e13921c65d2522a6d3d70591fb.png)

我也收到一些错误`Expected identifier`：

![迷你橱窗](../Images/2c347632fd7c561990a5e4ecbc046b4b.png)

## 更新

每当我启动应用程序时，我都会得到一个黑屏。这是我的`AppDelegate.m`样子：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone && [UIScreen mainScreen].bounds.size.height == 568.0) {
        self.viewController = [[ViewController alloc] initWithNibName:@"ViewController_Portrait5" bundle:nil];
    }

    else if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone && [UIScreen mainScreen].bounds.size.height == 480.0) {
        self.viewController = [[ViewController alloc] initWithNibName:@"ViewController_Portrait4" bundle:nil];
    }

    else {
        self.viewController = [[ViewController alloc] initWithNibName:@"ViewController_PortraitPad" bundle:nil];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:58:43.550

你的错误`Expected Identifier`是因为你的括号是错误的。您的`if`情况应该是（我在其他几个情况下也看到相同的错误）：

```
else if (((deviceOrientation == UIInterfaceOrientationLandscapeLeft) || (deviceOrientation == UIInterfaceOrientationLandscapeRight)) && [UIScreen mainScreen].bounds.size.height == 480.0) 
```

# python - Flask Web 应用程序的 CSS 问题

> ID：13772884
> 
> 赞同：60
> 
> 时间：2012-12-07T23:55:18.270
> 
> 标签：python, css, flask

我无法让 CSS 正确输出 - 我的网页都没有样式。

这是我所有模板中的链接。我究竟做错了什么？

```
<link type="text/css" rel="stylesheet" href="/stylesheets/style.css"/> 
```

Flask 有什么特别的地方可以让它工作吗？

我已经尝试和改变了大约半个小时，但似乎无法做到正确。

总结一下：你如何用 Flask 做 CSS - 我必须有任何特殊的 python 代码吗？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-12-08T00:50:42.050

你不需要对 Flask 做任何特别的事情来让 CSS 工作。也许你正在`style.css`投入`flask_project/stylesheets/`？除非正确配置，否则您的应用程序不会提供此类目录。查看[Flask 快速入门的](http://flask.pocoo.org/docs/quickstart/)[静态文件](http://flask.pocoo.org/docs/quickstart/#static-files)部分了解更多信息。但是，总而言之，这就是您想要做的：

1.  移动您需要的静态文件`project_root/static/`。假设您搬进`stylesheets/style.css`了`project_root/static/stylesheets/style.css`.

2.  改变

    ```
    <link ... href="/stylesheets/style.css" /> 
    ```

    至

    ```
    <link ... href="{{ url_for('static', filename='stylesheets/style.css') }}" /> 
    ```

    这告诉模板解析器（Jinja2）告诉 Flask 在你的项目目录中找到配置的静态目录（默认情况下，`static/`）并返回文件的路径。

    *   如果你*真的*想要，你可以将路径设置为`/static/stylesheets/style.css`. 但是你真的不应该那样做 - using`url_for`允许你切换你的静态目录并且仍然有工作，以及其他优点。

而且，正如@RachelSanders 在她的回答中所说：

> 在生产环境中，您最好通过 apache 或 nginx 提供静态文件，但这对开发人员来说已经足够了。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2019-12-14T04:22:44.653

尝试使用重新加载 chrome

ctrl + shift + R

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2016-06-22T06:59:49.740

**执行此操作的 4 个步骤**（在此处建立了很多其他答案，假设您已正确设置 Flask）：

1）在您的文件夹中创建一个静态文件`app`夹：`[root_folder]/app/static/`

2) 将所有静态内容（图像、JavaScript、CSS 等）移动到这些文件夹中。将内容保存在各自的文件夹中（不是强制性的，只是更整洁、更有条理）。

3）修改`__init__.py`文件`app`夹中的文件以具有此行：

```
app.static_folder = 'static' 
```

这将允许您的应用程序识别您的`static`文件夹并相应地读取它。

4) 在您的 HTML 中，设置您的文件链接，如下所示：

```
<link ... href="{{ url_for('static', filename='[css_folder]/[css-file].css') }}" /> 
```

例如，如果您将 CSS 文件夹称为“样式表”并将文件称为“样式”：

```
<link ... href="{{ url_for('static', filename='stylesheets/styles.css') }}" /> 
```

那应该正确设置所有内容。祝你好运！

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-12-08T00:43:27.913

您需要在 Flask 应用程序中创建一个名为“static”的文件夹，然后将所有 CSS 文件放在那里。

[http://flask.pocoo.org/docs/quickstart/#static-files](http://flask.pocoo.org/docs/quickstart/#static-files)

在生产环境中，您最好通过 apache 或 nginx 提供静态文件，但这对开发人员来说已经足够了。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-04-03T08:44:49.923

就我而言 - macOS 10.13 上的 safari - 清除缓存就可以了。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-08-10T17:21:24.683

ctrl + shift + R 技巧有效，尤其是在第一次运行期间加载 css 时（这意味着所有路径都很好）；但是，如果对 css 进行了更改，则无法重新加载。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-07-27T21:11:14.213

使用（mac OS）简单地硬刷新：

```
command + shift + R 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-02-11T16:11:24.180

尝试在浏览器中进行硬刷新。您可能正在查看缓存版本。在Firefox中按住CTRL并按F5。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-04-29T12:05:16.337

我创建了静态文件夹，将我的 CSS 放入其中并正确链接它，但它不起作用。我清除了浏览器的缓存，它工作。或者，您可以通过在 chrome 上按`Ctrl`+来硬刷新浏览器。`F5`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-05-01T19:59:01.860

“如果您更改静态文件，请刷新浏览器页面。如果更改未显示，请尝试清除浏览器的缓存。” -Flask 文档

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-10-09T16:31:31.920

处理程序的顺序可能会导致问题：

*   url: /stylesheets static_dir: 样式表
*   网址：/.* 脚本：helloworld.application

将工作而不是

*   网址：/.* 脚本：helloworld.application
*   url: /stylesheets static_dir: 样式表

# javascript - contenteditable 和 emberjs

> ID：13772885
> 
> 赞同：5
> 
> 时间：2012-12-07T23:55:19.067
> 
> 标签：javascript, ember.js

我有一个 contentEditable 视图，当我 focusOut 时，我输入了 html 并保存它。

但是当我从 contenteditable 中删除所有文本然后集中注意力时，我得到了错误

```
Uncaught Error: Cannot perform operations on a Metamorph that is not in the DOM. 
```

请查看此 jsfiddle 并删除 value1 文本并重点关注。

[http://jsfiddle.net/rmossuk/Q2kAe/8/](http://jsfiddle.net/rmossuk/Q2kAe/8/)

有人能帮忙吗 ？

最好的问候瑞克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T13:29:42.723

您`EditableView`设置了一个显示绑定到它的`content.value`：

```
<script type="text/x-handlebars" data-template-name="editable"> 
   {{view.content.value}}
</script> 
```

Ember 通过使用标记脚本标签包装相关部分来执行其绑定更新魔法。查看生成的 DOM：

![Ember 显示绑定脚本标签](../Images/9d6a9e59057890968cc766a47c9e02e7.png)

现在您使视图可编辑。一旦用户完全删除视图的内容，您会注意到周围的脚本标签也被删除（由浏览器）。在 Ember 尝试更新显示的那一刻，它找不到必要的脚本标签，因此会抱怨。

我不认为你可以使这种方法可靠地工作`contenteditable`，因为你将无法控制浏览器而保持 Ember 环境完好无损。我想您需要自己更新视图：删除绑定，创建`content.value`观察者并显式更新 DOM：

```
App.EditableView = Em.View.extend({
    contenteditable: "true",
    attributeBindings: ["contenteditable"],

    _observeContent: (function() {
        this._displayContent();
    }).observes('content.value'),

    didInsertElement: function() {
        this._displayContent();
    },
    _displayContent: function() {
        this.$().html(this.get('content.value'));
    },
    ... 
```

这是一个带有此解决方案演示的 JSFiddle：http: [//jsfiddle.net/green/BEtzb/2/](http://jsfiddle.net/green/BEtzb/2/)。

（当然，您也可以使用`Ember.TextField`使用常规输入字段并提供所有绑定魔法的 an，如果这就是您所需要的。）

# visual-studio - Visual Studio 活动日志 - 时间是任务的开始还是结束？

> ID：13772886
> 
> 赞同：0
> 
> 时间：2012-12-07T23:55:18.870
> 
> 标签：visual-studio, visual-studio-2012

我正在尝试解决我的 Visual Studio 2012 加载时的巨大延迟问题。我似乎无法为“时间”列找到一个好的描述。那是活动**开始**或**结束**的时间吗？这在确定哪个事件导致问题时产生了巨大的差异。

```
 <entry>
    <record>24</record>
    <time>2012/12/07 23:41:25.360</time> <!-- This line -->
    <type>Information</type>
    <source>VisualStudio</source>
    <description>Entering function CVsPackageInfo::HrInstantiatePackage</description>
    <guid>{DA9FB551-C724-11D0-AE1F-00A0C90FFFC3}</guid>
  </entry> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:07:17.433

事件记录是同步完成的——日志条目发生在某个瞬间，它与启动和完成的长时间运行的进程无关。时间是条目被记录到活动日志中的任何时间。

您引用的日志条目是在输入`CVsPackageInfo::HrInstantiatePackage`函数时记录的。但是，任何组件都可以在任何时候向活动日志写入条目，因此*一般*不能说相对于它所引用的操作何时发生日志条目。但是，每个日志条目的文本应该提供一些指示。

# facebook-javascript-sdk - 在哪里获得 Facebook 登录按钮

> ID：13772888
> 
> 赞同：4
> 
> 时间：2012-12-07T23:55:25.023
> 
> 标签：facebook-javascript-sdk

我已经使用 facebook-omniauth gem 为我的网站实现了 facebook 身份验证。我只是在寻找“从 Facebook 登录”按钮。似乎 facebook 只提倡通过 XFBML JS 或 iframe 使用登录按钮。

我发现 facebook 在他们的网站上确实有各种可用的图片： [https://www.facebook.com/images/facebook_logo.gif](https://www.facebook.com/images/facebook_logo.gif) https://www.facebook.com/images/fbconnect/login-buttons/connect_light_medium_short.gif

但是我怎样才能访问他们所有可用的图像？（我知道我可以从第 3 方的 facebook 图片登录，但我想直接从 facebook 获取 - 只是没想到如果不使用他们的 javascript 库或 iframe，fb 会变得如此困难）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:57:36.353

[http://developers.facebook.com/docs/reference/plugins/login/](http://developers.facebook.com/docs/reference/plugins/login/)

在这里你可以生成一个按钮......而不是附加属性并使用它们来获得不同的大小fe

大小按钮：小、中、大、超大（默认：中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-11T11:08:32.633

现在 facebook 有自己的 .png 按钮，您可以在登录流程中使用它们。下载并按照说明 [https://developers.facebook.com/docs/facebook-login/checklist/#brandlogin](https://developers.facebook.com/docs/facebook-login/checklist/#brandedlogin)

# java - 如何从 Eclipse 插件提供 Flash 策略文件？

> ID：13772889
> 
> 赞同：0
> 
> 时间：2012-12-07T23:55:29.890
> 
> 标签：java, flash, actionscript, eclipse-plugin, cross-domain-policy

我有一个 Eclipse 插件，它需要为在本地机器上运行的 flash 应用程序打开一对套接字。Flash 需要一个策略文件（XML 块）来授予访问相关端口的权限。Flash 更喜欢通过端口 843 获取此策略文件，Java 将端口 < 1024 视为特权端口，Mac OS X 和 Linux 同样限制对端口 < 1024 的访问。我不想以 root 权限运行我的 Eclipse 插件，所以提供端口 843 上的策略文件不是一个选项。根据 Adob​​e 文档，如果 Flash 无法在端口 843 上获取策略文件，它会回退到在它尝试连接的端口上请求策略文件。ActionScript 代码如下所示：

```
/**
  * Connecting to some port to communicate with the debugger. We initiate the
  * connection because Flex doesn't allow us to listen to any ports.
  */
private function initSockets():void
{
    requestSocket = new Socket();
    requestSocket.addEventListener(Event.CONNECT, requestConnected);
    requestSocket.addEventListener(Event.CLOSE, closed);
    requestSocket.addEventListener(ProgressEvent.SOCKET_DATA, processRequestData);
    requestSocket.addEventListener(IOErrorEvent.IO_ERROR, ioError);
    requestSocket.addEventListener(SecurityErrorEvent.SECURITY_ERROR, securityError);
    requestSocket.connect("localhost", SCConstants.DEBUG_LESSON_REQUEST_PORT);

    eventSocket = new Socket();
    eventSocket.addEventListener(Event.CONNECT, eventConnected);
    eventSocket.addEventListener(Event.CLOSE, closed);
    eventSocket.addEventListener(ProgressEvent.SOCKET_DATA, processEventData);
    eventSocket.addEventListener(IOErrorEvent.IO_ERROR, ioError);
    eventSocket.addEventListener(SecurityErrorEvent.SECURITY_ERROR, securityError);
    eventSocket.connect("localhost", SCConstants.DEBUG_LESSON_EVENT_PORT);
} 
```

在 Eclipse 插件方面，我继承了一些大部分时间在 OS X 上工作的代码，但有时在 Windows 上会失败。在 Wi-Fi 而不是有线以太网上运行也往往会失败，尽管我不知道为什么这很重要。

```
public Boolean connect() throws DebugException {
    try {
        try {
            // connection code
            fRequestServerSocket = new ServerSocket(requestPort);
            fRequestServerSocket.setSoTimeout(ACCEPT_TIMEOUT);
            fEventServerSocket = new ServerSocket(eventPort);
            fEventServerSocket.setSoTimeout(ACCEPT_TIMEOUT);

            TWBLogger.logInfo("Open socket request server:" + fRequestServerSocket);
            TWBLogger.logInfo("Open socket event server:" + fEventServerSocket);

            String policy = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
                "<cross-domain-policy>\n" +
                "<allow-access-from domain=\"*\" to-ports=\"5000,5001\" secure=\"false\" />\n" +
                "</cross-domain-policy>\0";

            // Because of the Flash security policy the first thing
            // that will accept on the socket will be the Flash Player 
            // trying to verify us. The Flash player will request security 
            // policy file with the following string: <policy-file-request/>\0
            // We will serve back the above policy file and then close the socket
            // The next thing to accept is our process in the VM.
            fRequestSocket = fRequestServerSocket.accept();

            fRequestWriter = new PrintWriter(fRequestSocket.getOutputStream());
            fRequestReader = new BufferedReader(new InputStreamReader(fRequestSocket.getInputStream()));

            // Wait some time before giving flash the policy file. Otherwise they don't get it. ;(
            // 3 is too much ... ;(
            Thread.sleep(100);

            fRequestWriter.print(policy);
            fRequestWriter.flush();
            fRequestSocket.close();

            // this should be the real connection
            fRequestSocket = fRequestServerSocket.accept();
            TWBLogger.logInfo("Open socket request:" + fRequestSocket);

            fRequestWriter = new PrintWriter(fRequestSocket.getOutputStream());
            fRequestReader = new BufferedReader(new InputStreamReader(fRequestSocket.getInputStream()));

            // the same situation for the EventSocket 
            fEventSocket = fEventServerSocket.accept();
            fEventReader = new BufferedReader(new InputStreamReader(fEventSocket.getInputStream()));
            TWBLogger.logInfo("Open socket event:" + fEventSocket);
        } catch (SocketTimeoutException e) {
            TWBLogger.logWaring("Connection to the Client Timed out.");
            cleanSockets();
            return false;
            requestFailed("Connection to the VM timed out. Please close any other running lessons that you debug and try again", e);
        } catch (SocketSecurityException e) {
            requestFailed("Security error occured when connecting to the VM", e);
        } catch (Exception e) {
            if (!fTerminated)
            requestFailed("Error occured when connecting to the VM. Please close any other running lessons that you debug.", e);
        } 
    } catch (DebugException e) {
        // close the sockets so that we can debug another application
        cleanSockets();
        throw e;
    }

    // our VM is single threaded
    fThread = new TWBThread(this);
    fThreads = new IThread[] {fThread};

    // start listening for events from the VM
    fEventDispatch = new EventDispatchJob();
    fEventDispatch.schedule();

    // start listening for breakpoints
    IBreakpointManager breakpointManager = getBreakpointManager();
    breakpointManager.addBreakpointListener(this);

    breakpointManager.addBreakpointManagerListener(this);
    return true;
} 
```

这段代码看起来不对。它不等待来自 Flash 的消息，而只是将策略响应塞入端口。正如我所说，它大部分时间都有效，但有时会失败，并且似乎不符合 Adob​​e 的文档。

我尝试在每个端口上侦听请求数据包并发送特定于端口的响应。我在环回接口 (Mac OS X) 上使用 WireShark 观察了套接字流量。我看到了进来的策略请求和发送的响应，但是 Flash 仍然在两个端口上给了我安全沙箱违规。

我还尝试在上面显示的 initSockets 开头添加这一行：

```
Security.loadPolicyFile("xmlsocket://localhost:5002"); 
```

然后我在我的插件中添加了代码来监听端口 5002 并发送以下主策略文件内容：

```
private final static String FLASH_POLICY_RESPONSE = 
    "<?xml version=\"1.0\"?>\n" +
    "<!DOCTYPE cross-domain-policy SYSTEM \"/xml/dtds/cross-domain-policy.dtd\">\n" +
    "<cross-domain-policy>\n" +
    "<site-control permitted-cross-domain-policies=\"master-only\"/>\n" +
    "<allow-access-from domain=\"*\" to-ports=\"5000,5001\"/>\n" +
    "</cross-domain-policy>\0"; 
```

我再次看到请求进来，响应出去了，但 Flash 似乎没有响应它。我没有收到 Security Sandbox Violation 错误，但端口上也没有流量。

谁能告诉我在 Java 和 Flash 之间打开套接字的正确方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:42:17.407

我找到了解决方案。我很早就犯了一个错误，过去常常`BufferedReader.readLine`阅读保单请求。这是不合适的，因为策略请求是空终止的，而不是新行终止的。这很令人困惑，因为它会在底层流关闭时返回。因此，我收到了请求并发送了响应，但是在 ActionScript 代码已经确定请求失败之后才发送响应。

在 Java 端，我使用以下代码在端口上建立通信：

```
// Create server sockets.
fRequestServerSocket = new ServerSocket(REQUEST_PORT);
fRequestServerSocket.setSoTimeout(ACCEPT_TIMEOUT);
TWBLogger.logInfo("Open socket request server:" + fRequestServerSocket);

fEventServerSocket = new ServerSocket(EVENT_PORT);
fEventServerSocket.setSoTimeout(ACCEPT_TIMEOUT);
TWBLogger.logInfo("Open socket event server:" + fEventServerSocket);

// Serve up the Flash policy file.
serveFlashPolicy();

// Connect request socket.
fRequestSocket = fRequestServerSocket.accept();
TWBLogger.logInfo("Open socket request:" + fRequestSocket);

fRequestWriter = new PrintWriter(fRequestSocket.getOutputStream());
fRequestReader = new BufferedReader(new InputStreamReader(fRequestSocket.getInputStream()));

// Connect event socket.
fEventSocket = fEventServerSocket.accept();
TWBLogger.logInfo("Open socket event:" + fEventSocket);

fEventReader = new BufferedReader(new InputStreamReader(fEventSocket.getInputStream())); 
```

提供策略文件的处理如下：

```
private void serveFlashPolicy() {
    ServerSocket serverSocket = null;
    Socket socket = null;
    TWBLogger.logInfo("Waiting for flash policy request on port " + FLASH_POLICY_PORT);
    try {
        serverSocket = new ServerSocket(FLASH_POLICY_PORT);
        serverSocket.setSoTimeout(ACCEPT_TIMEOUT);

        socket = serverSocket.accept();

        PrintWriter writer = new PrintWriter(socket.getOutputStream());
        BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));

        StringBuilder request = new StringBuilder();
        int c;
        while (0 < (c = reader.read())) {
            request.append((char) c);
        }

        String policyRequest = request.toString();
        if (policyRequest.startsWith(FLASH_POLICY_REQUEST)) {
            writer.print(FLASH_POLICY_RESPONSE);
            writer.print("\0");
            writer.flush();
        }
    } catch (IOException e) {
        TWBLogger.logWaring("IOException on port " + FLASH_POLICY_PORT + ": " + e.toString());
        e.printStackTrace();
    } finally {
        if (null != socket) {
            try {
                socket.close();
            } catch (Exception e) {
                // Ignore
            }
        }

        if (null != serverSocket) {
            try {
                serverSocket.close();
            } catch (Exception e) {
                // Ignore
            }
        }
    }

    TWBLogger.logInfo("Flash policy complete on port " + FLASH_POLICY_PORT);
} 
```

Flash 策略响应如下所示：

```
private final static String FLASH_POLICY_RESPONSE = 
    "<?xml version=\"1.0\"?>\n" +
    "<!DOCTYPE cross-domain-policy SYSTEM \"/xml/dtds/cross-domain-policy.dtd\">\n" +
    "<cross-domain-policy>\n" +
    "<allow-access-from domain=\"*\" to-ports=\"5000,5001\"/>\n" +
    "</cross-domain-policy>"; 
```

`site-control`我之前发送的标签只允许在从端口 843 提供的主策略文件中使用。

# vba - 以编程方式将格式应用于 Excel 文件

> ID：13772893
> 
> 赞同：2
> 
> 时间：2012-12-07T23:56:06.060
> 
> 标签：vba, excel, excel-2010

我想格式化现有的 Excel 文件 (xls) 单元格，使列中的单元格值仅在小数点后显示两位数。

所以，而不是`0.090919729581319146%`，我想展示`0.09%`。

我需要跨多个文档执行此操作，因此我需要一些可重复的方式来应用转换。我正在考虑一个宏 - 并使用 Excel 2010 中的集成宏记录器进行了尝试，但不幸的是无法让它工作。

我只需从 C3 格式化一个范围 --> C5000。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T18:21:13.750

我在网上找到了一些东西。看看这段代码。它做了我所说的：

```
Sub NurZumUeben()
With Range("C2:C5000")
    .Replace What:="%", Replacement:="", LookAt:=xlPart, SearchOrder:=xlByRows
        Range ("K1") = 100
        Range ("K1").Copy
    .PasteSpecial Paste :=xlPasteAll, Operation:= xlDivide
    .NumberFormat = "0.00%"
        Range("K1").Clear
End With
End Sub 
```

![在此处输入图像描述](../Images/56df0eb2858dcd3574220405a1be75ea.png)

# c++ - 这种数组操作在 C++ 中是如何工作的？

> ID：13772899
> 
> 赞同：0
> 
> 时间：2012-12-07T23:56:28.583
> 
> 标签：c++

```
void revalue(int r, int ar[], int n)
{
    for(int i=0; i<n;i++)
    {
        ar[i]*=r;
    }
} 
```

所以我真的很困惑这段代码是如何工作的，以及它为什么会改变 ar[]。问题是我认为每次您将不是引用或指针的变量传递给函数时，都会制作变量的副本，然后在超出函数范围后将副本删除。然而这个函数改变了数组的值。

这怎么可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:58:49.820

真的很简单：当您在 C 或 C++ 中对参数使用数组表示法时，编译器会默默地调整它以实际传递指针。

IOW，你的功能真的是：

```
void revalue(int r, int *ar, int n) 
```

...从那里开始，大部分内容都很清楚。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T23:59:21.703

`int ar[]`我想，在这种情况下，混淆是等同于写作的`int* ar`：在 C++ 中，您不能按值传递内置数组。但是，它们很容易衰减为指针，上面是另一种表示法。请注意，您可以使用`int ar[10]`or`int ar[20]`并且它也将是相同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T23:58:35.273

默认情况下，在 c++ 中，数组通过引用传递，被调整为指向数组第一个元素的指针。

# matrix - 基本高斯消除求解器产生错误的结果

> ID：13772904
> 
> 赞同：2
> 
> 时间：2012-12-07T23:56:57.413
> 
> 标签：matrix, fortran, gaussian, solver

我是 Fortran 的新手，我需要编写高斯消除代码来求解 4x4 矩阵。我下面的代码返回错误的结果，我无法调试问题。如果你能帮助我，我将不胜感激。

```
 common /grid/ A(100,100), NEQ, C(100), X(100)

      open(10, file="NEQ.txt", status='unknown')
      read(10,*) NEQ
      close (10)

      open(12, file="C1.txt", status='unknown')
        do i=1,NEQ
        read(12,*) C(i)
        enddo
      close (12)

      open(11, file="A1.txt", status='unknown')
        do i=1,NEQ
        read(11,*) (A(i,k), k=1,NEQ)
        enddo
      close (11)

      call SOL

      open(13, file="X.txt", status='unknown')
        do i=1,NEQ
        write(13,*) X(i)
        enddo
      close (13)

      stop
      end

      subroutine SOL
      common /grid/ A(100,100), NEQ, C(100), X(100)

c     Forward Reduction Phase:

      do 10 K=2,NEQ
      do 10 I=K,NEQ
      R=A(I,K-1)/A(K-1,K-1)

      C(I)=C(I)-R*C(K-1)

      do 10 J=K-1,NEQ
10    A(I,J)=A(I,J)-R*A(K-1,J)

c     Back Substitution Phase:

      X(NEQ)=C(NEQ)/A(NEQ,NEQ)
      do 30 K=NEQ-1,1,-1
      X(K)=C(K)
      do 20 J=K+1,NEQ

20    X(K)=X(K)-A(K,J)*X(J)
30    X(K)=X(K)/A(K,K)

      return
      end 
```

* * *

对于我的情况，NEQ 从文本文件中读取为 4 而我的 A1.txt 是：

```
18, -6, -6, 0
-6, 12, 0, -6
-6, 0, 12, -6
0, -6, -6, 18 
```

C1.txt 是：

```
60
0
20
0 
```

结果 X 矩阵为：

```
8.3333330    
6.6666665    
8.3333321    
4.9999995 
```

代替：

```
13.13
14.17
15.83
15.00 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T17:52:25.600

正如 Vladimir F 所评论的，如果您必须编写任何新代码，至少使用 Fortran 90 非常有帮助。它提供了比 Fortran 77 更好的选项来保持代码的结构化和组织性（和可读性）。我想补充一点，这`implicit none`也是减少错误的宝贵声明。

也就是说，下面是一个例子，说明您的算法在 Fortran 90 中的样子（我已将其编写为函数）：

```
function gaussian_elimination(A, C) result(X)
  implicit none
  real, intent(inout) :: C(:), A(size(C), size(C))
  real :: X(size(C))

  real    :: R(size(C))
  integer :: i, j, neq

  neq = size(C)

  ! Forward reduction, only two loops since reduction is now row by row
  do i = 1, neq
    R = A(:,i)/A(i,i)

    do j = i+1, neq
      A(j,:) = A(j,:) - R(j)*A(i,:)
      C(j) = C(j) - R(j)*C(i)
    enddo
  enddo

  ! Back substitution, only one loop
  do i = neq, 1, -1
    x(i) = (C(i) - sum(A(i, i+1:) * x(i+1:))) / A(i,i)
  enddo
end function gaussian_elimination 
```

这只会让我想知道为什么您认为您的结果`X = [8.33, 6.67, 8.33, 5.00]`不正确？这是正确的解决方案，您可以通过将矩阵 A 与它相乘来验证：`matmul(A, X)`应该（几乎）等于`C`。

# java - 什么原因导致Android系统上多线程Java程序的性能变化？

> ID：13772906
> 
> 赞同：0
> 
> 时间：2012-12-07T23:57:12.113
> 
> 标签：java, android, multithreading, dalvik, tegra

我尝试在 Google Nexus 7 上运行多线程 Java 程序（MapReduce 风格），并用

```
System.currentMillis(); 
```

我发现性能变化很大（Tegra 3 w/4 cores 上有 4 个线程），如下所示：

`704 872 729 729 1086 778 1214 1045 749 768`

但是，当我使用顺序版本时，我得到了这样的稳定​​数据：

`928 851 850 842 863 917 873 905 853 870`

我认为垃圾收集器是并发的，所以它也需要一个核心，这是造成大变化的原因吗？

为什么有时性能甚至比顺序版本差很多？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:13:09.217

> 我认为垃圾收集器也是多线程的，这是造成大变化的原因吗？

IMO，GC 不太可能是变异的原因。

> 为什么有时性能甚至比顺序版本差很多？

我们需要查看您的代码或 SSCE。不过，我猜原因是：

*   这是一个不适合 Java 线程的性能特征的问题（例如创建线程的高成本），或者
*   您的多线程解决方案存在严重的并发瓶颈和/或负载平衡。

# javascript - 尝试打印一些 JSON 数据时出现错误“null or not an object”

> ID：13772907
> 
> 赞同：0
> 
> 时间：2012-12-07T23:57:12.543
> 
> 标签：javascript, json, jquery, jsonp

[我在http://jsfiddle.net/sPCw6/](http://jsfiddle.net/sPCw6/)保存了一个 jsFiddle

这是代码，

```
<!DOCTYPE html>
<html>
<head>
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script >
$(document).ready(function($) {
 // First link out of three
 var url = 'https://www.sciencebase.gov/catalog
/items?parentId=504108e5e4b07a90c5ec62d4&max=60&offset=0&format=jsonp';

$.ajax({
    type: 'GET',
    url: url,
    jsonpCallback: 'getSBJSON',
    contentType: "application/json",
    dataType: 'jsonp',
    success: function(json) {

                 for (var i = 0; i < json.items.length; i++) {
                     var urlId = json.items[i].id;
             }

                 var linkBase = "http://www.sciencebase.gov/catalog/item/";
                 var link = "";
                 $.each(json.items, function(i,item){
                     link = linkBase + this.id
                     $('#sbItems').append('<li><b><a href="' + link + '">' +   
this.title + '</a> - </b>' + this.summary + '</li>');         
                 });

                 // devHack, loop being used to extract the exact id to use in url of 
next ajax request
                 for (var i = 23; i < 24; i++) {
                     var urlId = json.items[i].id;
             }

                 var itemLnkId =  urlId;

                 $.ajax({
                     type: 'GET',
                     //url: 'https://www.sciencebase.gov/catalog/itemLink/' + 
itemLnkId + '?format=jsonp',
                     //url: 'https://www.sciencebase.gov/catalog
/item/504216b6e4b04b508bfd333b?format=jsonp&fields=relationships,title,body,contacts',
                     url: 'https://www.sciencebase.gov/catalog/item/' + itemLnkId + 
'?format=jsonp&fields=relationships,title,body,contacts',
                     jsonpCallback: 'getSBJSON',
                     contentType: "application/json",
                     dataType: 'jsonp',
                     success: function(json) {
                                  // devHack, setup for all links
                                  var linkBase = "http://www.sciencebase.gov/catalog
/item/";

                                  // devHack, will be used along with linkbase to get 
to a specific link
                                  var link = "";

                                  $(function() {
                                      $('#sbItems a').live('click',function(e) {
                                          e.preventDefault();

                                          $.each(json, function(i,item){
                                              // devHack, will be used along with 
linkbase to get to a specific link
                                              link = "";

                                              $('#sbItems').append('<li><a href="' + 
link + '">' + json.relationships.links[0].title + '</a></li>');            
                                          }); 

                                          //alert();
                                          //$('#article').load( this.href );
                                      });
                                  });

                                 /* $.each(json, function(i,item){
                                      link = linkBase + this.relatedItemId
                                      $('#sbItems').append('<li><a href="' + link + 
'">' + this.title + '</a></li>');            
                                  }); */

                     },
                     error: function(e) {
                         console.log(e.message);
                     }
                 });

    },
    error: function(e) {
        console.log(e.message);
    }
});
});
</script>
</head>
<body>
<p><em>This is a simple example of a basic HTML page that uses JQuery to call items    
from ScienceBase in JSON format and output them on the page. It serves to show how a 
basic web application can interact with dynamic ScienceBase services. The code points 
out the one critical feature of such an application, the use of a callback method in  
the Javascript to allow web pages on one domain to call and render JSON from another  
domain (www.sciencebase.gov). The listing below comes from a query for items under a 
particular ScienceBase parent item - a set of project records from the USGS National 
Research Program. The listing shows title with a link to the full project record in 
ScienceBase and summary (first part of a full abstract). View source for code examples 
and inline comments.</em></p>

<h3>Projects of the USGS Water National Research Program</h3>

<div class='wrapper'>
<ul id='sbItems'></ul>
</div>
</body>
</html> 
```

由于“json.relationships.links[0].title”，我的第二个 .ajax() 请求无法正常工作，但我已经尝试了所有可能的方式来访问我知道的标题。

我试图访问的信息位于此处：

[https://www.sciencebase.gov/catalog/item/504216b6e4b04b508bfd333b?format=json&fields=relationships,title,body,contacts](https://www.sciencebase.gov/catalog/item/504216b6e4b04b508bfd333b?format=json&fields=relationships,title,body,contacts)。

我究竟做错了什么？？该代码应该在单击一个链接后打印第一个标题（尽管我确实需要打印所有标题）10 次或更多次。

另外，我是否需要在 $.each 中使用另一个循环来打印所有标题？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T05:05:25.337

虽然我不**知道为什么**会发生这种情况，但发生的**事情**很清楚。简而言之，[json API](https://www.sciencebase.gov/catalog/item/504216b6e4b04b508bfd333b?format=json&fields=relationships,title,body,contacts)返回的数据与[jsonp API](https://www.sciencebase.gov/catalog/item/504216b6e4b04b508bfd333b?format=jsonp&fields=relationships,title,body,contacts)不同。

从[json API](https://www.sciencebase.gov/catalog/item/504216b6e4b04b508bfd333b?format=json&fields=relationships,title,body,contacts)（漂亮）返回的数据包含您的预期`json.relationships.links[0].title`：

```
{
    "link": {
        "rel": "self",
        "url": "https://www.sciencebase.gov/catalog/item/504216b6e4b04b508bfd333b"
    },
    "relatedItems": {
        "link": {
            "url": "https://www.sciencebase.gov/catalog/itemLinks?itemId=504216b6e4b04b508bfd333b",
            "rel": "related"
        }
    },
    "relationships": {
        "total": 59,
        "links": [{
            "url": "https://www.sciencebase.gov/catalog/item/4f4e4b19e4b07f02db6a7f04",
            "rel": "related",
            "title": "Computation and analysis of the instantaneous-discharge record for the Colorado River at Lees Ferry, Arizona : May 8, 1921, through September 30, 2000",
            "annotation": null
        }, {
            "url": "https://www.sciencebase.gov/catalog/item/5047afb7e4b067bd38f7f63d",
            "rel": "related",
            "title": "Multi-scale measurements and modeling of denitrification in streams with varying flow and nitrate concentration in the upper Mississippi River basin, USA",
            "annotation": null
        }, {
            "url": "https://www.sciencebase.gov/catalog/item/5047afb8e4b067bd38f7f66f",
            "rel": "related",
            "title": "Characterization of microtopography and its influence on vegetation patterns in created wetlands",
            "annotation": null
        }, {
            "url": "https://www.sciencebase.gov/catalog/item/5047afb8e4b067bd38f7f64f",
            "rel": "related",
            "title": "Fractal Topography and Subsurface Water Flows from Fluvial Bedforms to the Continental Shield",
            "annotation": null
        }, {
            "url": "https://www.sciencebase.gov/catalog/item/4f4e4af1e4b07f02db691820",
            "rel": "related",
            "title": "Surface-Water and Ground-Water Interactions in the Central Everglades, Florida",
            "annotation": null
        }, {
            "url": "https://www.sciencebase.gov/catalog/item/5047afb8e4b067bd38f7f67b",
            "rel": "related",
            "title": "Morphologic and Transport Properties of Natural Organic Floc",
            "annotation": null
        }, {
            "url": "https://www.sciencebase.gov/catalog/item/5047afb8e4b067bd38f7f673",
            "rel": "related",
            "title": "Volunteer Monitoring Demonstrates Tree Planting Help Stream Ecosystems: Northern Virginia Soil and Water Conservation District",
            "annotation": null
        }, {
            "url": "https://www.sciencebase.gov/catalog/item/5047afb8e4b067bd38f7f653",
            "rel": "related",
            "title": "Ground-based thermography of fluvial systems at low and high discharge reveals potential complex thermal heterogeneity driven by flow variation and bioroughness",
            "annotation": null
        }, {
            "url": "https://www.sciencebase.gov/catalog/item/5047afb7e4b067bd38f7f641",
            "rel": "related",
            "title": "A complex-systems approach to predicting effects of sea level rise and nitrogen loading on nitrogen cycling in coastal wetland ecosystems",
            "annotation": null
        }, {
            "url": "https://www.sciencebase.gov/catalog/item/5047afb8e4b067bd38f7f659",
            "rel": "related",
            "title": "Drag coefficients for modeling flow through emergent vegetation in the Florida Everglades",
            "annotation": null
        }]
    },
    "id": "504216b6e4b04b508bfd333b",
    "title": "Hydrologic, Ecological, and Biogeochemical Processes in Flowing Waters",
    "body": "<p> &nbsp;<\/p> \n<p style=\"color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: small; line-height: normal; \"> There is increasing recognition that the ecological function of rivers, streams, and wetlands are inseparable from the physics of flowing water and its interactions with the aquatic, terrestrial, and subsurface components that delineate the “river and wetland corridor”.&nbsp; It is the interplay between ecological, geomorphic, hydrologic, and biogeochemical processes that determines ecosystem function.&nbsp; These factors strongly influence how water quality and quality of aquatic and riparian habitat respond to human disturbances and changing climate.&nbsp; Improved conservation and restoration of river and wetland corridors requires an integrated approach that recognizes 1) linkages between surface and subsurface flows moving through terrestrial, riparian and aquatic components, and 2) feedbacks between flowing water and the geomorphic and ecological components that together modulate fluid flow, roughness, sediment entrainment and channel morphology in ways that further affect mass transfer of solutes and sediments between zones with different capacities for biogeochemical reactions.&nbsp; Many of the critical hydrologic and biogeochemical processes occur in complex aquatic environments at close proximity to the sediment interface, within periphyton layers, and on leaves of aquatic and emergent plants where processes are hidden from detection by standard sampling protocols.&nbsp; Our project addresses the profound need for new concepts, field methods, and cross-disciplinary models to address both the fundamental processes and their cumulative effects on basin-scale water quality and habitat value.<\/p> \n<p style=\"color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: small; line-height: normal; \"> Our project follows four main lines of investigation: (1) developing new concepts and tools to detect and quantify hydrologic fluxes, biogeochemical transformations, and interactions with ecological components within flowing surface waters, including highly episodic flows across floodplains and difficult to detect subsurface flows through hyporheic flow paths beneath stream channels, (2) estimating cumulative effects of those processes at larger (stream-reach and drainage basin) scales using natural and introduced tracers as well as improved and increasingly available data sets from airborne and satellite remote sensing to help integrate across the small-scale variability, (3) improving and advancing the use of numerical modeling codes for analyzing coupled terrestrial and aquatic ecological processes with surface and subsurface flow and transport phenomena, and 4) synthesizing a national-scale understanding of transport conditions in river and wetland corridors across gradients in climate, surficial geology, and human disturbance in the United States that influence residence time of water and fate of dissolved and fine particulate materials in the nation’s flowing waters. For additional information about this project,&nbsp;<i>see<\/i>&nbsp;<a href=\"http://water.usgs.gov/nrp/jharvey/\">project home page<\/a>.<\/p>",
    "contacts": [{
        "type": "Contact",
        "name": "Office of the Chief Scientist for Water",
        "highlighted": true,
        "oldPartyId": 17096,
        "email": null,
        "phone": null,
        "sourceId": null,
        "title": null,
        "address": null,
        "addressType": null,
        "city": null,
        "state": null,
        "zip": null,
        "country": null,
        "ttyPhone": null,
        "faxPhone": null,
        "hours": null,
        "instructions": null,
        "personsOrganization": null,
        "organizationsPerson": null
    }, {
        "type": "Principal Investigator",
        "name": "Judson W Harvey",
        "highlighted": false,
        "oldPartyId": 4306,
        "email": "jwharvey@usgs.gov",
        "phone": "703-648-5876",
        "sourceId": null,
        "title": null,
        "address": null,
        "addressType": null,
        "city": null,
        "state": null,
        "zip": null,
        "country": null,
        "ttyPhone": null,
        "faxPhone": null,
        "hours": null,
        "instructions": null,
        "personsOrganization": null,
        "organizationsPerson": null
    }, {
        "type": "Principal Investigator",
        "name": "Laurel Larsen",
        "highlighted": false,
        "oldPartyId": 11859,
        "email": "lglarsen@usgs.gov",
        "phone": "703-648-5891",
        "sourceId": null,
        "title": null,
        "address": null,
        "addressType": null,
        "city": null,
        "state": null,
        "zip": null,
        "country": null,
        "ttyPhone": null,
        "faxPhone": null,
        "hours": null,
        "instructions": null,
        "personsOrganization": null,
        "organizationsPerson": null
    }, {
        "type": "Principal Investigator",
        "name": "Harry L Jenter",
        "highlighted": false,
        "oldPartyId": 5071,
        "email": "hjenter@usgs.gov",
        "phone": "703-648-5916",
        "sourceId": null,
        "title": null,
        "address": null,
        "addressType": null,
        "city": null,
        "state": null,
        "zip": null,
        "country": null,
        "ttyPhone": null,
        "faxPhone": null,
        "hours": null,
        "instructions": null,
        "personsOrganization": null,
        "organizationsPerson": null
    }]
} 
```

而从[jsonp API](https://www.sciencebase.gov/catalog/item/504216b6e4b04b508bfd333b?format=jsonp&fields=relationships,title,body,contacts)（漂亮）返回的数据不会：

```
{
    "link": {
        "rel": "self",
        "url": "https://www.sciencebase.gov/catalog/item/504216b6e4b04b508bfd333b"
    },
    "relatedItems": {
        "link": {
            "url": "https://www.sciencebase.gov/catalog/itemLinks?itemId=504216b6e4b04b508bfd333b",
            "rel": "related"
        }
    },
    "id": "504216b6e4b04b508bfd333b",
    "title": "Hydrologic, Ecological, and Biogeochemical Processes in Flowing Waters",
    "summary": "   There is increasing recognition that the ecological function of rivers, streams, and wetlands are inseparable from the physics of flowing water and its interactions with the aquatic, terrestrial, and subsurface components that delineate the “river and wetland corridor”.  It is the interplay between ecological, geomorphic, hydrologic, and biogeochemical processes that determines ecosystem function.  These factors strongly influence how water quality and quality of aquatic and riparian habitat respond to human disturbances and changing climate.  Improved conservation and restoration of river and wetland corridors requires an integrated approach that recognizes 1) linkages between surface and subsurface flows moving through terrestrial, [...]",
    "body": "<p> &nbsp;<\/p> \n<p style=\"color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: small; line-height: normal; \"> There is increasing recognition that the ecological function of rivers, streams, and wetlands are inseparable from the physics of flowing water and its interactions with the aquatic, terrestrial, and subsurface components that delineate the “river and wetland corridor”.&nbsp; It is the interplay between ecological, geomorphic, hydrologic, and biogeochemical processes that determines ecosystem function.&nbsp; These factors strongly influence how water quality and quality of aquatic and riparian habitat respond to human disturbances and changing climate.&nbsp; Improved conservation and restoration of river and wetland corridors requires an integrated approach that recognizes 1) linkages between surface and subsurface flows moving through terrestrial, riparian and aquatic components, and 2) feedbacks between flowing water and the geomorphic and ecological components that together modulate fluid flow, roughness, sediment entrainment and channel morphology in ways that further affect mass transfer of solutes and sediments between zones with different capacities for biogeochemical reactions.&nbsp; Many of the critical hydrologic and biogeochemical processes occur in complex aquatic environments at close proximity to the sediment interface, within periphyton layers, and on leaves of aquatic and emergent plants where processes are hidden from detection by standard sampling protocols.&nbsp; Our project addresses the profound need for new concepts, field methods, and cross-disciplinary models to address both the fundamental processes and their cumulative effects on basin-scale water quality and habitat value.<\/p> \n<p style=\"color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: small; line-height: normal; \"> Our project follows four main lines of investigation: (1) developing new concepts and tools to detect and quantify hydrologic fluxes, biogeochemical transformations, and interactions with ecological components within flowing surface waters, including highly episodic flows across floodplains and difficult to detect subsurface flows through hyporheic flow paths beneath stream channels, (2) estimating cumulative effects of those processes at larger (stream-reach and drainage basin) scales using natural and introduced tracers as well as improved and increasingly available data sets from airborne and satellite remote sensing to help integrate across the small-scale variability, (3) improving and advancing the use of numerical modeling codes for analyzing coupled terrestrial and aquatic ecological processes with surface and subsurface flow and transport phenomena, and 4) synthesizing a national-scale understanding of transport conditions in river and wetland corridors across gradients in climate, surficial geology, and human disturbance in the United States that influence residence time of water and fate of dissolved and fine particulate materials in the nation’s flowing waters. For additional information about this project,&nbsp;<i>see<\/i>&nbsp;<a href=\"http://water.usgs.gov/nrp/jharvey/\">project home page<\/a>.<\/p>",
    "provenance": {
        "html": "Record was created from original web page content (see link)."
    },
    "dateCreated": "2012-09-01T08:07:51-06:00",
    "lastUpdated": "2012-11-29T08:28:36-07:00",
    "hasChildren": false,
    "parentId": "504108e5e4b07a90c5ec62d4",
    "contacts": [{
        "type": "Contact",
        "name": "Office of the Chief Scientist for Water",
        "highlighted": true,
        "oldPartyId": 17096,
        "email": null,
        "phone": null,
        "sourceId": null,
        "title": null,
        "address": null,
        "addressType": null,
        "city": null,
        "state": null,
        "zip": null,
        "country": null,
        "ttyPhone": null,
        "faxPhone": null,
        "hours": null,
        "instructions": null,
        "personsOrganization": null,
        "organizationsPerson": null
    }, {
        "type": "Principal Investigator",
        "name": "Judson W Harvey",
        "highlighted": false,
        "oldPartyId": 4306,
        "email": "jwharvey@usgs.gov",
        "phone": "703-648-5876",
        "sourceId": null,
        "title": null,
        "address": null,
        "addressType": null,
        "city": null,
        "state": null,
        "zip": null,
        "country": null,
        "ttyPhone": null,
        "faxPhone": null,
        "hours": null,
        "instructions": null,
        "personsOrganization": null,
        "organizationsPerson": null
    }, {
        "type": "Principal Investigator",
        "name": "Laurel Larsen",
        "highlighted": false,
        "oldPartyId": 11859,
        "email": "lglarsen@usgs.gov",
        "phone": "703-648-5891",
        "sourceId": null,
        "title": null,
        "address": null,
        "addressType": null,
        "city": null,
        "state": null,
        "zip": null,
        "country": null,
        "ttyPhone": null,
        "faxPhone": null,
        "hours": null,
        "instructions": null,
        "personsOrganization": null,
        "organizationsPerson": null
    }, {
        "type": "Principal Investigator",
        "name": "Harry L Jenter",
        "highlighted": false,
        "oldPartyId": 5071,
        "email": "hjenter@usgs.gov",
        "phone": "703-648-5916",
        "sourceId": null,
        "title": null,
        "address": null,
        "addressType": null,
        "city": null,
        "state": null,
        "zip": null,
        "country": null,
        "ttyPhone": null,
        "faxPhone": null,
        "hours": null,
        "instructions": null,
        "personsOrganization": null,
        "organizationsPerson": null
    }],
    "webLinks": [{
        "type": "webLink",
        "typeLabel": "Web Link",
        "uri": "http://water.usgs.gov/nrp/proj.bib/jharvey.html",
        "title": "Original Web Page",
        "hidden": false
    }, {
        "type": "webLink",
        "typeLabel": "Web Link",
        "uri": "http://water.usgs.gov/nrp/jharvey/",
        "title": "Project Home Page",
        "hidden": false
    }],
    "systemTypes": ["Folder"],
    "tags": [{
        "name": "Acid Mine Drainage"
    }, {
        "name": "Aquatic Habitat"
    }, {
        "name": "Contaminant Reactions and Transport"
    }, {
        "name": "Rivers and Streams"
    }, {
        "name": "Surface-water - Ground-water Interactions"
    }, {
        "name": "Wetlands"
    }],
    "spatial": {
        "boundingBox": {
            "maxY": 27.5605773925781,
            "maxX": -80.0313568115234,
            "minX": -81.3108444213867,
            "minY": 25.1152248382568
        }
    },
    "extents": [470376],
    "permissions": {
        "read": {
            "acl": ["PUBLIC"],
            "inherited": true,
            "inheritsFromId": "504108e5e4b07a90c5ec62d4"
        },
        "write": {
            "acl": ["USER:sbristol@usgs.gov"],
            "inherited": true,
            "inheritsFromId": "4f4f863be4b0c2aeb78a9e3f"
        }
    }
} 
```

要回答您的第二个问题，如果 USGS 输出一致的数据并且您的预期`json.relationships.links[0].title`可用，您应该能够替换提供的`i`参数 for`0`循环遍历每个返回`relationships.links`，而无需在内部进行第二次循环`.each()`（像这样）。

```
$.each(data, function (i, item) {
    var link = data.relationships.links[i].url,
        title = data.relationships.links[i].title,
        a = $('<a />').attr('href', url).text(title),
        li = $('<li />').append(a);
    $('#sbItems').append(li);
}); 
```

# php - 带有 PHP 变量的自动图像下载器

> ID：13772912
> 
> 赞同：-2
> 
> 时间：2012-12-07T23:57:43.637
> 
> 标签：php

我当前的代码如下。

```
<?php
header('Content-Type: image/png');
header('Content-Disposition: attachment; filename="Skin"');
echo file_get_contents("http://domain.tld/script/skins/' . $_GET["m"] . '.png");
?> 
```

我知道问题出在...
(' . $_GET["m"] . ')
...但是如何解决呢？

我收到以下错误。
解析错误：语法错误，意外的 '"'，期待 T_STRING 或 T_VARIABLE 或 T_NUM_STRING 在 ...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:59:48.933

您的字符串分隔符不匹配。尝试这个：

```
echo file_get_contents("http://domain.tld/script/skins/" . $_GET["m"] . ".png"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T00:00:10.207

试试这个：

```
echo file_get_contents("http://domain.tld/script/skins/$_GET[m].png"); 
```

您正在混合单引号和双引号：

```
 "http://domain.tld/script/skins/' . $_GET["m"] . '.png"
^^^                             ^^^              ^^^  ^^^
open                           close             open close 
```

干杯

# android - RuntimeException：无法启动活动（Android）

> ID：13772916
> 
> 赞同：0
> 
> 时间：2012-12-07T23:58:35.277
> 
> 标签：android, runtimeexception, start-activity

我正在开发一个应用程序并遇到一个奇怪的错误。当点击登录按钮并启动新活动时，迄今为止用于测试应用程序的三台设备中有两台可以完美运行。可以工作的两部手机都在 Ice Cream Sandwhich 上运行，而第三部手机（给我带来麻烦的那部）在 JellyBean 上运行。

当使用 JellyBean 手机点击登录按钮时，会发生这种情况。

**Java（注册页面）**

```
 // Register button
            TextView main_body_register_button = new TextView(this);
             main_body_register_button.setBackgroundResource(R.drawable.register_btn);
             main_body_register_button.setOnClickListener(new View.OnClickListener() {
                    public void onClick(View v) {
                        // Post to the MySQL database
                        class sendtask extends AsyncTask<String, Void, String> {
                            protected String doInBackground(String... url) {
                                HttpClient httpClient = new DefaultHttpClient();
                                    HttpPost httpPost = new HttpPost("http://website.com/register.php");  
                                        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();  
                                            nameValuePairs.add(new BasicNameValuePair("number", ""+main_body_phone_input.getText().toString()));

                                            try {
                                                httpPost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                                            } catch (UnsupportedEncodingException e) {
                                                e.printStackTrace();
                                            } 
                                            try {
                                                httpClient.execute(httpPost);
                                            } catch (ClientProtocolException e) {
                                                e.printStackTrace();
                                            } catch (IOException e) {
                                                e.printStackTrace();
                                            }
                                                return "";
                            }
                                protected void onPostExecute(String result) {
                                    if (main_body_phone_input.getText().toString().compareTo("012-345-6789")==0) {
                                        // Phone number: Empty
                                        Intent base_account_register = new Intent(base_account_register.this,base_account_register.class);
                                        startActivity(base_account_register);
                                    } else if (main_body_phone_input.getText().toString().compareTo("012-345-6789")!=0) {
                                        // Switch to main page
                                        Intent TellATextActivity = new Intent(base_account_register.this,TellATextActivity.class);
                                         ownAddress  = ""+main_body_phone_input.getText().toString();
                                        startActivity(TellATextActivity);
                                    }
                                }
                        }
                            new sendtask().execute("Registration form");
                        // End
                    }
             });
           // END 
```

**Java (OnCreate TellATextActivity)**

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // Global variables
    Bundle bundle = getIntent().getExtras();
    final String ownAddress  = bundle.getString("session_number");

       // MAIN
       TextView main_message = new TextView(this);
            // Select and parse the most recent message
            Uri uriSMS = Uri.parse("content://sms/");
            Cursor cur = getContentResolver().query(uriSMS, null, null, null, null);

            // EDIT IN          
            if (cur != null && cur.moveToFirst()) {
             do {
              // Inflate your data
             } while (cur.moveToNext());
            }
             cur.close()
            // END

            // EDIT OUT
            cur.moveToNext();
            cur.moveToNext();
            // END

            String body = cur.getString(cur.getColumnIndex("body"));
            String add = cur.getString(cur.getColumnIndex("address"));
             reply_address = "" +add;
            String time = cur.getString(cur.getColumnIndex("date"));
            String protocol = cur.getString(cur.getColumnIndex("protocol"));
            String contactName = "";

            Uri personUri = Uri.withAppendedPath( ContactsContract.PhoneLookup.CONTENT_FILTER_URI, Uri.encode(add));
                Cursor c = getContentResolver().query(personUri, new String[] { PhoneLookup.DISPLAY_NAME }, null, null, null );  
                    if( c.moveToFirst() ) {
                        int nameIndex = c.getColumnIndex(PhoneLookup.DISPLAY_NAME);  
                        contactName = c.getString(nameIndex);
                    }
                    c.close();
                    cur.close();
            String out = "";
            Date d = new Date(Long.valueOf(time));
            // End

            // Determine status of message
            if (protocol == null)
                out = ""+body;
            else 
                out = ""+body;
            // End

            // Create output
            main_message.setHeight(400);
            main_message.setWidth(510);
            main_message.setPadding(10,15,10,0);
            main_message.setTextSize(23);
            main_message.setTextColor(Color.rgb(100,100,100));
            main_message.setText(out);
            // End
        // END

        TextView bottom_reply = new TextView(this);
         bottom_reply.setBackgroundResource(R.drawable.reply);
         bottom_reply.setOnClickListener(new View.OnClickListener() {
             public void onClick(View v) {
                 // Compose a reply
                 Intent intent = new Intent(Intent.ACTION_SENDTO);
                 intent.setData(Uri.parse("smsto:" +reply_address));
                 intent.putExtra("compose_mode", true);
                 startActivity(intent);
             }
         });
        // END

     } 
```

**AndroidManifest.xml**

```
 <activity
        android:name=".TellATextActivity"
        android:label="@string/app_name"
        android:configChanges="orientation|keyboardHidden"
        android:screenOrientation="portrait" >
         <intent-filter>
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <data android:mimeType="vnd.android-dir/mms-sms" />
        </intent-filter>
        <intent-filter>
            <action android:name="android.intent.action.VIEW" />
            <action android:name="android.intent.action.SENDTO" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="sms" />
            <data android:scheme="smsto" />
        </intent-filter>
        <intent-filter>
            <action android:name="android.intent.action.SEND" />
            <category android:name="android.intent.category.DEFAULT" />
            <data android:mimeType="text/plain" />
        </intent-filter>
    </activity> 
```

**崩溃报告**

```
java.lang.RuntimeException: Unable to start activity 
ComponentInfo{tellatext.sms.app/tellatext.sms.app.TellATextActivity}: 
android.database.CursorIndexOutOfBoundsException: Index 1 requested, with a size of 1
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2049)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2083)
at android.app.ActivityThread.access$600(ActivityThread.java:134)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1233)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4697)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
at dalvik.system.NativeStart.main(Native Method)
Caused by: android.database.CursorIndexOutOfBoundsException: Index 1 requested, with a size of 1
at android.database.AbstractCursor.checkPosition(AbstractCursor.java:407)
at android.database.AbstractWindowedCursor.checkPosition(AbstractWindowedCursor.java:136)
at android.database.AbstractWindowedCursor.getString(AbstractWindowedCursor.java:50)
at android.database.CursorWrapper.getString(CursorWrapper.java:114)
at tellatext.sms.app.TellATextActivity.onCreate(TellATextActivity.java:82)
at android.app.Activity.performCreate(Activity.java:4539)
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2013)
... 11 more 
```

有人能在这里指出我正确的方向吗？我已经用尽了所有选择，需要其他人对这个问题的看法。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:01:45.300

在您的代码中的某处，您正在从插槽 1 请求一个光标项，认为它是第一个插槽。不正确。游标是 0 索引的，因此，0 是第一个插槽。尝试将起始索引更改为 0。

编辑示例：

```
Cursor cur = null; // Your query not null

if (cur != null && cur.moveToFirst()) {
    do {
        // Inflate your data
    } while (cur.moveToNext());
}
cur.close() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T01:36:39.550

不在这部分。这实际上是您的 onCreate 方法，在第 82 行。如果您按照 Aedon 的建议去那里将 1 更改为 0，那么一切都会奏效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T18:56:21.913

当有人使用收件箱中少于 3 条短信的应用程序时，就会出现此问题。通过将收件箱光标移动到没有文本消息的位置，应用程序崩溃，因为该位置不存在。

# c# - 如何根据值从字典中随机删除一个键？

> ID：13772917
> 
> 赞同：2
> 
> 时间：2012-12-07T23:58:34.767
> 
> 标签：c#, random, dictionary

如何有效地随机删除值为 0 的键？

```
Dictionary<string, int> dict = new Dictionary<Edge, int>();
dict.add("a",0);
dict.add("b",0);
dict.add("c",0);
dict.add("d",1); 
```

字典大小为 10000。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:03:51.440

这样的事情应该这样做：

```
IEnumerable<string, int> pairsToRemove = dictionary.Where(pair => pair.Value == 0); 
```

要生成随机索引，您可以使用：

```
int indexToRemove = [RandomNumber] % pairsToRemove.Length() -1; 
```

从pairToRemove 中找到第indexToRemove 元素并将其从字典中删除。

至于效率：假设随机数生成为恒定的时间。

问题是，没有办法在 O(n) 时间内对字典执行值查找。所以这将是你的瓶颈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T00:04:26.407

这将删除第一个具有零值的项目。它不是完全“随机”的，而是不确定的。

```
Dictionary<string, int> dict = new Dictionary<string, int>();
string keyToRemove = null;
foreach (var kvp in dict)
{
    if (kvp.Value == 0)
    {
        keyToRemove = kvp.Key;
        break;
    }
}
if (keyToRemove != null)
{
    dict.Remove(keyToRemove);
} 
```

# mysql - 如何按月做日历报表

> ID：13772921
> 
> 赞同：0
> 
> 时间：2012-12-07T23:58:52.983
> 
> 标签：mysql, jasper-reports

我有一个客户想要一份年终报告，该报告在其各自的月份列中显示数据，如下所示：

```
Income               Jan    Feb    Mar   ..... Dec
   Rent              10.00  10.00  10.00       10.00

Expenses
   Landscape         5.00   3.00   2.00        5.00

Net Income           5.00   7.00   8.00        5.00 
```

所有的交易数据都存储在一个这样的表中

```
Create Table transaction(
   id int,
   date DATE,
   amount DECIMAL 10,2,
   account_type INT) 
```

我不太确定如何开始。我使用 iReport 作为报表设计器，使用 mysql 作为数据库。有没有一种有效的方法使用 SQL 来获得这样的东西？做这样的事情`SELECT date FROM transaction WHERE date between 1-01-2012 and 12-31-2012`给我结果，然后使用我的 iReport 以某种方式将数据拆分为客户想要的列，对我来说更好吗？

我想知道最好的方法是什么，以及我如何才能做到这一点。

感谢您的帮助和想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T18:06:28.047

您可以使用pivot ...或...在sql中创建该输出

```
create table tmp ([date] date, amount decimal(10,2), accounttype int)

insert into tmp values ('1/1/2012', 10, 1)
insert into tmp values ('2/1/2012', 10, 1)
insert into tmp values ('3/1/2012', 10, 1)

select
  'RENT' title,
  sum(case when [date] = '1/1/2012' then amount else null end) Jan,
  sum(case when [date] = '2/1/2012' then amount else null end) Feb
from tmp
where accounttype = 1 
```

哦，你必须用一些日期部分函数替换 "[date] = '1/1/2012'" 以确定它是哪个月份。

如果您必须在其中添加其他费用类型...使用“联合”将其添加到同一数据集..确保费用为负值...并且应使用 jasper 变量计算总数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T00:45:20.787

如果我正确理解了您的问题，那么这段代码可能会对您有所帮助。

```
 SELECT (DATE_FORMAT(date_col,'%m/%d/%Y')) as datecol  FROM transaction ; 
```

如果这不是您想要的，请告诉我们。祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T16:46:17.520

Smit 和 Sam，感谢您的回复，我最终使用了您的两个 SQL 示例的一部分，但是，我最终采用了这些示例并最终在 iReport 中输出了报告。由于要求，我必须为每个月创建一个列，然后使用月（日期）来分隔每个月。因此，当报告运行时，它将每笔交易放在它所属的月份列下。

# php - PHP：$_SERVER 变量：$_SERVER['HTTP_HOST'] 与 $_SERVER['SERVER_NAME']

> ID：13772934
> 
> 赞同：22
> 
> 时间：2012-12-08T00:00:15.340
> 
> 标签：php

> **可能重复：**
> [HTTP_HOST 与 SERVER_NAME](https://stackoverflow.com/questions/2297403/http-host-vs-server-name)

`$_SERVER['HTTP_HOST']`和有什么区别`$_SERVER['SERVER_NAME']`？？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-12-08T00:24:43.143

`$_SERVER['SERVER_NAME']`给出在主机配置中定义的服务器名称的值（即对于 Apache 的 Apache .conf 文件）。

`$_SERVER['HTTP_HOST']`为您提供满足当前请求的域名，并且与请求更直接相关。

`HTTP_HOST`通常在大多数应用程序中更有用，因为它直接与请求相关，而`SERVER_NAME`可以返回 conf 文件中的任何值，并且根本不会告诉您有关请求的任何信息。

我将举一个例子说明`HTTP_HOST`与`SERVER_NAME`. 假设您在 Apache 中定义了一个主机，其服务器名称为`domain.com` ，IP 地址为`1.2.3.4`.

让我们看一下两个传入的请求 URL，并显示这些变量之间的区别：

```
http://www.domain.com
HTTP_HOST = www.domain.com
SERVER_NAME = domain.com

http://1.2.3.4
HTTP_HOST = 1.2.3.4
SERVER_NAME = domain.com 
```

同样，HTTP_HOST 更多地与请求相关联，而 SERVER_NAME 由服务器配置决定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T00:02:21.637

`HTTP_HOST`是`Host:`客户端发送的标头。因此，它可能不太值得信赖。 `SERVER_NAME`由您的服务器配置决定~~，与用户输入无关。~~

行为上的差异是微妙的。这里展示了一些很好的例子：http: [//shiflett.org/blog/2006/mar/server-name-versus-http-host](http://shiflett.org/blog/2006/mar/server-name-versus-http-host)

[文档很好地解释了这一点](http://php.net/manual/en/reserved.variables.server.php)

> 'SERVER_NAME' 当前脚本在其下执行的服务器主机的名称。如果脚本在虚拟主机上运行，​​这将是为该虚拟主机定义的值。
> 
> 'HTTP_HOST' 主机的内容：当前请求的标头，如果有的话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T00:03:49.313

**`HTTP_HOST`**

> 主机内容：当前请求的标头（如果有）。

**`SERVER_NAME`**

> 当前脚本在其下执行的服务器主机的名称。如果脚本在虚拟主机上运行，​​这将是为该虚拟主机定义的值。

[http://php.net/manual/en/reserved.variables.server.php](http://php.net/manual/en/reserved.variables.server.php)

# c# - C# 设置文件 - 如何加载？

> ID：13772936
> 
> 赞同：0
> 
> 时间：2012-12-08T00:00:26.057
> 
> 标签：c#, settings.settings

我有一个应用程序，我需要存储 3 组字符串集合（用户书签和其他一些东西）。我在我的 C# 项目中添加了一个“设置文件”，创建了 3 个专用字符串集合类型的设置变量。一切似乎都很好，因为我可以向每个集合添加字符串并调用 Settings.Default 的 .Save() 方法。我可以在生成的“user.config”文件中看到我漂亮的字符串集合。

但是，这些值何时加载？Settings 没有 .Load() 方法。尝试访问 Settings.-setting variable-name 会引发空异常错误，因此显然这些值不会在启动时自行加载。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T01:11:01.790

也许您在使用不同版本的应用程序和设置文件时遇到问题？尝试调用[`ApplicationSettingsBase.Upgrade`](http://msdn.microsoft.com/en-us/library/system.configuration.applicationsettingsbase.upgrade.aspx)将以前的设置迁移到新版本。

请注意，您应该只调用`Upgrade`一次，并且仅在您实际更新设置时调用。创建一个`NeedsUpgrade`默认值为 true 的设置属性，并在应用程序加载时执行以下操作：

```
if (Settings.Default.NeedsUpgrade)
{
    Settings.Default.Upgrade();
    Settings.Default.NeedsUpgrade = false;
    Settings.Default.Save();
} 
```

有了这个，`Upgrade`只会在创建新版本的设置文件时调用。

# c# - HttpClient 的自定义用户代理？

> ID：13772937
> 
> 赞同：27
> 
> 时间：2012-12-08T00:00:30.680
> 
> 标签：c#, dotnet-httpclient

我可以为 a 设置自定义用户代理`HttpClient`吗？

我需要以移动形式查看网站。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-01-08T08:48:48.743

```
var client = new HttpClient();
client.DefaultRequestHeaders.UserAgent.ParseAdd("MyAgent/1.0"); 
```

还有一个 TryParseAdd 如果你想捕捉添加它的错误尝试，如果你想自己创建带有名称和版本号的 ProductInfoHeaderValue ，还有一个 Add 。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-12-08T01:39:43.270

干得好

```
var client = new HttpClient();
client.DefaultRequestHeaders.Add("User-Agent",
                                 "Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; 
                                  WOW64; Trident/6.0)"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-08T00:20:46.530

怎么样

```
 HttpClient client = new HttpClient();
    client.DefaultRequestHeaders.Add("User-Agent", "my-user-agent-name"); 
```

# c++ - 'operator=' 不匹配

> ID：13772942
> 
> 赞同：2
> 
> 时间：2012-12-08T00:00:58.047
> 
> 标签：c++, stack, structure

我已经构建了一个静态的结构堆栈，并且一切正常 - 包括创建一个结构数组。但是，由于某种原因，我无法将数组的顶部设置为结构。

在我的`.cpp`文件中，在我的`push`函数中，我一直在以下行出错：

```
stackArray[top] = newStudent; 
```

我收到的错误是：

> "51: 'operator=' 不匹配' *(((studentstack* )this)->studentstack::stackArray + (+(((unsigned int)((studentstack*)this)->studentstack::top) * 24u ))) = ((studentstack*)this)->studentstack::newStudent'"

我在下面包括我的代码。

头文件：

```
#ifndef studentstack_H
#define studentstack_H

#include <iostream>
#include <string>

using namespace std;

class studentstack {
    private:
        int size;         // Stack size
        int top;          // Top of the Stack

        struct student {
            int ID;
            string Name;
            string Address;
            double GPA; 
        };
        student * stackArray;  // Pointer to the stack
        student * newStudent; // Pointer to the new student

    public: //Constructor
        studentstack(int);

        // Copy Constructor
        studentstack(const studentstack &);

        //Destructor
        ~studentstack();

        //Stack Operaations
        void push(string, int, double, string);
        void pop(int &);
        bool isFull() const;
        bool isEmpty() const;
    };

#endif 
```

学生栈.cpp

```
#include <iostream>
#include "studentstack.h"

using namespace std;

studentstack::studentstack(int SIZE) {
    stackArray = new student[SIZE];
    size = SIZE;
    top = -1;
    int ID = 0;
    double GPA = 0;
}

studentstack::studentstack(const studentstack &obj) {
    if (obj.size > 0)
        stackArray = new student[obj.size];
    else
        stackArray = NULL;

    size = obj.size;

    for (int count = 0; count < size; count++)
        stackArray[count] = obj.stackArray[count];

    top = obj.top;
}

studentstack::~studentstack() {
    delete [] stackArray;
}

void studentstack::push(string name, int id, double gpa, string address) {
    if (isFull()) {
        cout << "The stack is full.\n";
    } else {
        top++;
        newStudent = new student;
        newStudent-> Name = name;
        newStudent-> ID = id;
        newStudent-> Address = address;
        newStudent-> GPA = gpa;
        stackArray[top] = newStudent;
    }
}   

void studentstack::pop(int &id) {
    if (isEmpty()) {
        cout << "The stack is empty.\n";
    } else {
        id = stackArray[top].ID;
        top--;
    }
}

bool studentstack::isFull() const {
    bool status;

    if (top == size - 1)
        status = true;
    else
        status = false;

    return status;
}

bool studentstack::isEmpty() const {
    bool status;

    if (top == -1)
        status = true;
    else
        status = false;

    return status;
} 
```

主文件

```
#include "studentstack.h"
#include <iostream>
#include <string>
using namespace std;

int main() {
    string name;
    int id, var;
    string address;
    double gpa;
    studentstack s[20];

    for(int x =0; x<20; x++) {
        cout << "New Student Name: " << endl;
        cin >> name;

        cout << "ID: " << endl;
        cin >> id;

        cout << "GPA: " << endl;
        cin >> gpa;

        cout << "Address: " << endl;
        cin >> address;

        s.push(name, id, gpa, address)
    }

    cout << "Popping: "
    for(int x = 0; x < 5; x++) {
        s.pop(var);
        cout <<var;
    }

    return(0);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T00:08:20.800

您可能希望将示例缩减为显示问题的最小代码段。归结为您尝试将 a 分配给对象`student*`数组中的元素。`student`指向对象的指针与对象不同：

```
stackArray[0] = new student(); // does NOT work
stackArray[0] = student(); 
```

请注意，该对象是由构造函数在 C++ 中创建的，不一定涉及`new`. 当您使用构造和对象时，`new`您仍然会创建一个对象，但您也会在堆上为其分配空间。默认情况下，对象在任何定义的地方创建。例如，`student()`在堆栈上创建一个对象，然后将其分配给`stackArray[0]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T00:11:17.747

与您的问题没有直接关系，但请注意您的 main() 无法工作。`studentstack`您声明一个包含 20 个元素的数组：

```
studentstack s[20]; 
```

后来你正在做：

```
s.push(/* ... */);
s.pop(/* ... */); 
```

这没有多大意义。`s`不是一个`studentstack`。它是一个s*数组*。`studentstack`C++ 中的数组没有成员函数。

# google-plus - 通过 API 创建 Google Plus 事件

> ID：13772944
> 
> 赞同：0
> 
> 时间：2012-12-08T00:01:08.400
> 
> 标签：google-plus

是否可以通过 API 为 Google Plus 社区创建活动？

我能找到的唯一相关帖子是：[Is there an API for the Google Plus Events](https://stackoverflow.com/questions/11382956/is-there-an-api-for-the-google-plus-events)但它只考虑请求事件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T00:03:50.850

不，G+ API 目前是[只读的](https://developers.google.com/+/api/)。

> ***注意***：Google+ API 目前提供对公共数据的只读访问权限。所有 API 调用都需要 OAuth 2.0 令牌或 API 密钥。

干杯

# java - 如何使用会话工厂提高批量插入的性能

> ID：13772953
> 
> 赞同：2
> 
> 时间：2012-12-08T00:01:32.737
> 
> 标签：java, hibernate, session, seam

我正在使用 jpa 和使用 seam 的休眠。一次需要插入 200,000 条记录。

这是我的代码：

休眠.cfg.xml

```
<hibernate-configuration>
 <session-factory name="java:/mobeeSessionFactory">
  <property name="hibernate.connection.pool_size">10</property>
  <property name="hibernate.connection.driver_class">oracle.jdbc.OracleDriver</property>
  <property name="hibernate.connection.url">jdbc:oracle:thin:@localhost:1521:mobee</property>
  <property name="hibernate.connection.username">mobeemigrate</property>
  <property name="hibernate.connection.password">mobeemigrate</property>
  <property name="hibernate.show_sql">false</property>
  <property name="hibernate.dialect">org.hibernate.dialect.OracleDialect</property>
  <property name="hibernate.format_sql">false</property>
  <property name="hibernate.hbm2ddl.auto">update</property>
  <property name="hibernate.session_factory_name">java:/mobeeSessionFactory</property>
  <property name="hibernate.connection.datasource">mobeeadminDataSource</property>
  <property name="hibernate.jdbc.batch_size">10000</property>
  <property name="hibernate.cache.use_first_level_cache">true</property>
  <property name="hibernate.cache.use_second_level_cache">false</property>
  <property name="hibernate.transaction.manager_lookup_class">org.hibernate.transaction.JBossTransactionManagerLookup</property>
  <property name="hibernate.transaction.factory_class">org.hibernate.transaction.JTATransactionFactory</property>
  <property name="hibernate.transaction.auto_close_session">false</property>
  <property name="hibernate.cache.provider_class">org.hibernate.cache.HashtableCacheProvider</property>
  <property name="hibernate.transaction.flush_before_completion">true</property>

  <!-- Here are the mappings -->
  <mapping package="com.manam.mobee.persist.entity"/>
  <mapping class="com.manam.mobee.persist.entity.TempCustomers"/>
  <mapping class="com.manam.mobee.persist.entity.TempAccounts"/>
 </session-factory> 
```

组件.xml

```
<persistence:hibernate-session-factory name="hibernateSessionFactory" cfg-resource-name="hibernate.cfg.xml"/>
    <persistence:managed-hibernate-session name="session" 
                 auto-create="true"
     session-factory-jndi-name="java:/mobeeSessionFactory"/> 
```

示例代码：

```
 Session session =hibernateSessionFactory.openSession();
             Transaction tx = session.beginTransaction();

   for(int i=0;i<doTempAccounts.size();i++){

     try {
    TempAccounts temp=new TempAccounts();

    BeanUtils.copyProperties(temp, doTempAccounts.get(i));

    session.save(temp);

    if ( i % 10000 == 0 ) { //10000, same as the JDBC batch size
     //flush a batch of inserts and release memory:
    log.info("********** Batch Updates**********");
    session.flush();
    session.clear();
     }
     }
     }
    tx.commit();
    session.close(); 
```

上面的代码可以运行，但是插入 200,000 条记录大约需要 10 分钟。我的代码中是否有任何配置可以提高批量插入的性能？

在上面的代码中，我每 10000 条记录执行一次 session.flush()，但不是每次都插入数据库。你能解释一下如何对数据库执行批量插入吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:24:47.777

> 在上面的代码中，我每 10000 条记录执行一次 session.flush()，但不是每次都插入数据库。

我想您的意思是，直到您到达终点，记录才出现在那里；即它们不会出现在不同事务中的查询中。

如果这就是你的意思，那么解释很简单。您正在单个事务中进行插入，并且记录仅在事务提交时才可见......在最后。如果您需要更快地看到插入，请尝试将插入拆分为多个*事务。*

* * *

您还应该阅读有关批处理操作的 Hibernate 文档 - [http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/batch.html](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/batch.html)。我注意到它说*合理*的批量大小是 20 到 50 ...而不是 10000。它还提到了直接使用 SQL 进行批量数据操作的方法和`StatelessSession`.

这是另一个特定于插入的资源，包括插入：http `StatelessSession`: [//javainnovations.blogspot.com.au/2008/07/batch-insertion-in-hibernate.html](http://javainnovations.blogspot.com.au/2008/07/batch-insertion-in-hibernate.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T00:49:46.010

查看 StatelessSession 以及如何使用它将项目插入数据库。当被问到这个问题时，这似乎是答案，我个人只是用它在大约 15 秒内完成了 15 分钟的工作。它并不适合所有场景，但如果适合，它会很好用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-18T13:24:44.420

您可以使用几乎与 SQL 中相同的方式来执行此操作。请看以下 HQL 示例：

```
insert into DelinquentAccount (id, name) select c.id, c.name from Customer c where ... 
```

参考：[http ://docs.jboss.org/hibernate/orm/4.0/devguide/en-US/html/ch04.html#d0e2184](http://docs.jboss.org/hibernate/orm/4.0/devguide/en-US/html/ch04.html#d0e2184)

# c# - Windows 商店应用程序中的计时器在哪里？

> ID：13772955
> 
> 赞同：17
> 
> 时间：2012-12-08T00:01:45.723
> 
> 标签：c#, timer, windows-store-apps

在 c# 中开发 Windows 应用商店应用程序时找不到计时器。它的替代/新名称/使用方式是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-08T01:31:46.413

[`DispatcherTimer`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.dispatchertimer.aspx)是你要找的

```
var timer = new DispatcherTimer();
timer.Tick += DispatcherTimerEventHandler;
timer.Interval = new TimeSpan(0,0,0,1);
timer.Start(); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-09-17T21:27:22.370

不同的定时器满足不同的需求。大致...

[DispatcherTimer](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.dispatchertimer) - 当您希望在**UI 线程**上执行工作时。

[ThreadPoolTimer](http://msdn.microsoft.com/en-us/library/windows/apps/windows.system.threading.threadpooltimer.aspx) - 当您希望在**后台线程**上执行工作时。

# c# - 当存储在数据结构或长字符串中时，在键值对的键中搜索子字符串更有效？

> ID：13772957
> 
> 赞同：1
> 
> 时间：2012-12-08T00:01:55.053
> 
> 标签：c#, asp.net, data-structures, key-value

我有一个字符串搜索问题，关于如何实现它，我想到了两个想法。我想知道人们是否可以指出哪种方法会给我带来更高效的性能，或者甚至可以提出更好的方法？

问题是我有一个大约 450kb 的文本文件，其中包含以下格式的数据：

```
description1, code1\n
description2, code2\n
description3, code3\n
... 
```

它是由逗号分隔的两列数据，每条记录由*描述*和*代码*组成。

*代码*是一个简短的三字符文本，对用户没有直接意义，这就是为什么有与代码配对的描述数据。

*描述*数据是一个简短的句子，向用户描述*代码*的含义。

我正在尝试创建一个 GUI，用户可以在其中在可编辑的文本字段中输入搜索关键字，然后用于搜索描述数据。然后系统将返回所有过滤的记录，即所有具有关键字作为子字符串的描述数据以及与之配对的代码供用户选择。这发生在用户键入的每个字符上。

关于如何实现此功能，首先想到的想法是使用描述数据作为键创建键值对集合，例如 a `NameValueCollection`，然后使用 foreach 循环遍历每条记录并搜索键以查找匹配子串。

第二种思路是把整个文本文件读成一个长字符串，用这个`String.IndexOf()`方法搜索关键字，只要搜索到了，我就提取那部分记录返回给用户。

想到第二个想法是因为我担心第一个想法可能对性能产生影响。我已经读到使用的`IndexOf`方法`StringComparison.Ordinal`比 Boyer–Moore 字符串搜索算法执行得更好，所以我认为以这种方式实现它会有更好的性能？

因此，当在键中搜索子字符串时，它是否提供更快的检索以将整个文件存储为字符串或 NameValueCollection，或者有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T00:06:08.930

如果您有大量字符串并计划搜索完全相同的子字符串，那么您有很多可用的选项。

一种选择是使用[Aho-Corasick 字符串匹配算法](http://en.wikipedia.org/wiki/Aho%E2%80%93Corasick_string_matching_algorithm)在文件的每一行中搜索搜索查询。执行此操作的总运行时间为 O(m + n + z)，其中 m 是查询的长度，z 是总匹配数，n 是文件中所有字符串的字符总数.

一个更好但更复杂的选择是从文件的所有行中构建一个[通用的后缀树。](http://en.wikipedia.org/wiki/Suffix_tree#Generalized_suffix_tree)然后，您可以在 O(n + z) 时间内找到所有匹配行，其中 n 是要搜索的模式的长度，z 是文件中的总行数。这需要 O(m) 预处理时间，其中 m 是文件中的字符总数。这比第一个选项快得多，但是您可能必须找到一个好的后缀树库，因为后缀树构造算法相当复杂。

希望这可以帮助！

# node.js - 表达错误中间件不处理从 promise.done() 抛出的错误

> ID：13772981
> 
> 赞同：2
> 
> 时间：2012-12-08T00:04:27.577
> 
> 标签：node.js, error-handling, express, connect

如果我抛出一个错误，express 会使用 connect errorHandler 中间件很好地呈现它。

```
exports.list = function(req, res){
  throw new Error('asdf');
  res.send("doesn't get here because Error is thrown synchronously");
}; 
```

当我在承诺中抛出错误时，它将被忽略（这对我来说很有意义）。

```
exports.list = function(req, res){
  Q = require('q');
  Q.fcall(function(){
    throw new Error('asdf');
  });
  res.send("we get here because our exception was thrown async");
}; 
```

但是，如果我在承诺中抛出错误并调用“完成”节点崩溃，因为中间件没有捕获到异常。

```
exports.list = function(req, res){
  Q = require('q');
  Q.fcall(function(){
    throw new Error('asdf');
  }).done();
  res.send("This prints. done() must not be throwing.");
}; 
```

运行上述内容后，节点崩溃并显示以下输出：

```
node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: asdf
    at /path/to/demo/routes/user.js:9:11 
```

所以我的结论是 done() 不会抛出异常，而是会导致在其他地方抛出异常。是对的吗？有没有办法完成我正在尝试的事情 - 承诺中的错误将由中间件处理？

仅供参考：这个 hack 将在顶层捕获异常，但它超出了中间件的范围，所以不适合我的需要（很好地呈现错误）。

```
//in app.js #configure
process.on('uncaughtException', function(error) {
  console.log('uncaught expection: ' + error);
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T00:52:22.003

也许您会发现[连接域](https://github.com/baryshev/connect-domain)中间件对处理异步错误很有用。该中间件允许您像处理常规错误一样处理异步错误。

```
var
    connect = require('connect'),
    connectDomain = require('connect-domain');

var app = connect()
    .use(connectDomain())
    .use(function(req, res){
        process.nextTick(function() {
            // This async error will be handled by connect-domain middleware
            throw new Error('Async error');
            res.end('Hello world!');
        });
    })
    .use(function(err, req, res, next) {
        res.end(err.message);
    });

app.listen(3131); 
```

# html - 我的 Textarea 不会输入文本

> ID：13772983
> 
> 赞同：1
> 
> 时间：2012-12-08T00:04:42.017
> 
> 标签：html, css, textarea

我已经编写 Web 代码几年了，我很困惑。我正在编写基本的 CSS/HTML，而我的 textarea 不会输入文本。我的标题在那里，双击它后，我的光标应该表明它可以输入了。

有任何想法吗？

**我的 CSS**

```
.postForm {
    float: right;
    width: 580px;
    height: 80px;
    position:relative;
    margin-top:-30px;
    padding-top:30px;
    left:-30px;
} 
```

**我的 HTML**

```
<div class="postForm">
<form action="profile.php?id=<? echo $_GET['id']; ?>" method="POST">
<textarea style="resize:none;font-family:Comic Sans MS; font-size:12pt;overflow: hidden;" id="post" name="post" class="auto-clear" rows="1" cols="60" title="Publish your thoughts...">     
</textarea>
<input style="position:relative;margin-left:450px;margin-top:-66px;" type="image" name="send" value="Post" src="post.png" />
 </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:10:55.633

它正在接受输入。将光标放在文本区域并按住任意键几秒钟。它最终会结束。问题是由于溢出被隐藏引起的。同样`postForm`浮动元素也无济于事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T00:06:19.290

您不要在 textareas 上使用 value 参数，而是这样做： `<textarea>example text</textarea>`

# asp.net-mvc - 使用 Microsoft.AspNet.SignalR 时站点永远不会加载；

> ID：13772985
> 
> 赞同：1
> 
> 时间：2012-12-08T00:05:02.910
> 
> 标签：asp.net-mvc, signalr

我正在尝试使用 SignalR，但我似乎碰壁了。尝试加载站点时，浏览器似乎只是坐在那里等待响应。当我附加调试器时，我看到下面的代码已执行，但`MapHubs`从未返回（我让它在午餐时运行，当我回来时它仍在运行）

```
public static class RegisterHubs
{
    public static void Start()
    {
        // Register the default hubs route: ~/signalr/hubs
        RouteTable.Routes.MapHubs();            
    }
} 
```

我的设置是一个基本的 MVC4 Internet 应用程序，然后添加 Microsoft.AspNet.Signalr Nuget 包（当前版本 1.1.1-alpha2）

我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T07:37:12.380

这是 1.0alpha2 中的一个已知问题。请参阅：[SignalR 似乎正在减慢我的 MVC / Azure 应用程序的启动速度](https://stackoverflow.com/questions/13612970/signalr-seems-to-be-slowing-startup-of-my-mvc-azure-application)

此后已通过[https://github.com/SignalR/SignalR/commit/fda3aa41a9250a072e8487882ae806ffe547f2bb修复](https://github.com/SignalR/SignalR/commit/fda3aa41a9250a072e8487882ae806ffe547f2bb)

# r - R中多行文本的奇怪行为

> ID：13772986
> 
> 赞同：0
> 
> 时间：2012-12-08T00:05:15.810
> 
> 标签：r

我正在尝试在 R 中设计一个相当定制的情节。

我想做的一件事是添加与标签不同的刻度线 - 也就是说，只有每 5 个刻度线才会被标记。我没有看到一个简单的方法来做到这一点，所以我这样做了：

```
plot(x = Freq_, y = Mean_ipsi, 
     pch = 20,
     ylim = c(-0.5, .9),
     col = 1 + (ProbF < .05) + (ProbF < .01),
     xaxt = 'n',
     xlab = "Frequency (MHz)", ylab = "z-in minus z-out",
     main = "Temporal, Engle 1, Epi, subjectwise",
     yaxt = 'n')
mtext(text = seq(1.56, 35.1, by = 1.95),
      side = 1, at = seq(1.56, 35.1, by = 1.95), cex = .5,line = 0.25)
axis(1, at = Freq_, tick = TRUE, labels = NA) 
```

它就像我想要的那样工作。

但是当我更改 mtext 之前的一些代码时，我得到了意想不到的结果

```
plot(x = Freq_, y = Mean_ipsi, 
     pch = 20,
     ylim = c(-0.5, .9),
     col = "red",
     xlab = "Frequency (MHz)", ylab = "z-in minus z-out",
     main = "Temporal, Engle 1, Epi, subjectwise 
     \n p values for difference between ipsi and contra",
     yaxt = 'n', type = 'o')
mtext(text = seq(1.56, 35.1, by = 1.95),
      side = 1, at = seq(1.56, 35.1, by = 1.95),
      cex = .5,line = 0.25)
axis(1, at = Freq_, tick = TRUE, labels = NA) 
```

现在，除了用每个数字 1.56、3.51 等标记的 x 轴之外，我在 5、10 等处得​​到大数字（我认为 cex = 1）。我不要这些。

我不知道这里发生了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T01:06:53.223

您`xaxt="n"`在第二个版本中丢失了。

```
Freq_ <- seq(1.56, 35.1, by = 1.95)
Mean_ipsi <- (0.01 * Freq_)
ProbF <- 0.0

#First Version  
plot(x = Freq_, y = Mean_ipsi, 
     pch = 20,
     ylim = c(-0.5, .9),
     col = 1 + (ProbF < .05) + (ProbF < .01),
     xaxt = 'n',
     xlab = "Frequency (MHz)", ylab = "z-in minus z-out",
     main = "Temporal, Engle 1, Epi, subjectwise",
     yaxt = 'n')
mtext(text = seq(1.56, 35.1, by = 1.95),
      side = 1, at = seq(1.56, 35.1, by = 1.95), cex = .5,line = 0.25)
axis(1, at = Freq_, tick = TRUE, labels = NA)

#=============================================

#Second Version
plot(x = Freq_, y = Mean_ipsi, 
     pch = 20,
     ylim = c(-0.5, .9),
     col = "red",
     xlab = "Frequency (MHz)", ylab = "z-in minus z-out",
     main = "Temporal, Engle 1, Epi, subjectwise 
     \n p values for difference between ipsi and contra",
     yaxt = 'n', type = 'o')  ##### <----- add xaxt="n" here #####
mtext(text = seq(1.56, 35.1, by = 1.95),
      side = 1, at = seq(1.56, 35.1, by = 1.95),
      cex = .5,line = 0.25)
axis(1, at = Freq_, tick = TRUE, labels = NA) 
```

# php - 当 php 文件不在根文件夹中时，使用 .htaccess 创建虚 URL 时出现问题

> ID：13772987
> 
> 赞同：1
> 
> 时间：2012-12-08T00:05:14.043
> 
> 标签：php, .htaccess, get, subdirectory, vanity-url

我在使用 .htaccess 文件创建虚 URL 时遇到问题。

我的 .htaccess 文件当前保存在我站点的根文件夹 (mysite/.htaccess) 中。我正在为其编写虚荣 URL 的页面位于下一层（mysite/jobs/job.php）。

我的 .htaccess 文件中的代码是：

```
Options +FollowSymLinks
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /mysite/jobs/job.php?job_id=$1 
```

在 mysite/jobs/job.php 文件中，我包含了以下代码：

```
if(isset($_GET['job_id']) == true && empty($_GET['job_id']) == false) {
    $job_id = $_GET['job_id'];
    echo $job_id; 
```

}

我的问题是这样的：当我在浏览器中输入“http://localhost/mysite/jobs/1”时，这会回显jobs/1，而我希望它回显1（即没有“jobs/”的实际工作ID开头）。有谁知道我如何更改 .htaccess 文件来实现这一点，而不必将 php 文件上移一级？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:08:25.103

那是因为您的 RewriteRule 正在捕获整个 REQUEST_URI（因为您的正则表达式）。请尝试以下操作：

`RewriteRule ^jobs/(\d+)$ /mysite/jobs/job.php?job_id=$1`

（不记得前导斜线是否需要存在......两种方式都尝试）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T00:09:21.633

这是因为您传递了 url 的整个上下文`mysite/`

试试这个：

```
Options +FollowSymLinks
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^/jobs/(.*)$ /mysite/jobs/job.php?job_id=$1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:56:06.953

该视频清楚地解释了如何创建虚 URL 以及如何克服存在的问题。但是，您的代码对我来说似乎很好。看看这个视频是否有帮助，这是我学习制作的地方。

[虚 URL 示例](https://www.youtube.com/watch?v=zrc4p-J_x9s)

PS：还有一个视频继续，别忘了检查

# c++ - 在模板化类之外定义运算符重载

> ID：13772994
> 
> 赞同：1
> 
> 时间：2012-12-08T00:06:14.143
> 
> 标签：c++, class, templates, operator-overloading

当我编译以下内容时，

 ````
#include <boost/numeric/ublas/vector.hpp>
#include <iomanip>
#include <stdio.h>

namespace ublas = boost::numeric::ublas;

template <class T> class Vector
{
    private:

       ublas::vector<T> m_ublas_vec;
       unsigned m_size;

    public:

       Vector(unsigned s){
          m_size = s;
          m_ublas_vec.resize(m_size);
       }

       T &operator () (unsigned idx) {
          if(idx >= m_size){
             perror("ERROR: Index out of bounds!\n");
             exit(1);
          }
          return m_ublas_vec(idx);
       }

       // Right-multiply by scalar.
       template <class TT, class S>
       friend Vector<TT> operator * (const Vector<TT> &, S);

       // Left multiply by scalar.
       template <class TT, class S>
       friend Vector<TT> operator * (S, const Vector<TT> &);
};

template <class T, class S>
Vector<T> Vector<T>::operator * (const Vector<T> &v_in, S scalar){
   Vector<T> v_out (v_in.m_size);
   v_out.m_ublas_vec = v_in.m_ublas_vec*static_cast<T>(scalar);
   return v_out;
}

template <class T, class S>
Vector<T> Vector<T>::operator * (S scalar, const Vector<T> &v_in){
   Vector<T> v_out (v_in.m_size);
   v_out.m_ublas_vec = v_in.m_ublas_vec*static_cast<T>(scalar);
   return v_out;
} 
```

我收到此错误：

> vector_test.cpp:49:95：错误：无效使用不完整类型“类向量”
> 
> vector_test.cpp:7:26: 错误: 'class Vector' 的声明

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T00:14:02.367

您`friend`的函数不声明成员函数。因此，您想将它们定义为

```
template <class T, class S>
Vector<T> operator * (const Vector<T> &v_in, S scalar){
   Vector<T> v_out (v_in.m_size);
   v_out.m_ublas_vec = v_in.m_ublas_vec*static_cast<T>(scalar);
   return v_out;
}

template <class T, class S>
Vector<T> operator * (S scalar, const Vector<T> &v_in){
   Vector<T> v_out (v_in.m_size);
   v_out.m_ublas_vec = v_in.m_ublas_vec*static_cast<T>(scalar);
   return v_out;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T00:15:36.967

`friend`函数不是类的一部分。您不应该通过`Vector<T>::`说明符定义它。正确的一种是：

```
template <class T, class S>
Vector<T> operator * (const Vector<T> &v_in, S scalar){
   Vector<T> v_out (v_in.m_size);
   v_out.m_ublas_vec = v_in.m_ublas_vec*static_cast<T>(scalar);
   return v_out;
}

template <class T, class S>
Vector<T> operator * (S scalar, const Vector<T> &v_in){
   Vector<T> v_out (v_in.m_size);
   v_out.m_ublas_vec = v_in.m_ublas_vec*static_cast<T>(scalar);
   return v_out;
} 
```

检查：http: [//ideone.com/8n9UO1](http://ideone.com/8n9UO1)`