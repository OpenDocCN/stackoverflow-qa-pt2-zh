# StackOverflow 问答 14967000-14967999

# ruby - 将小的按位 XOR perl 函数移植到 Ruby

> ID：14967000
> 
> 赞同：1
> 
> 时间：2013-02-19T20:43:07.223
> 
> 标签：ruby, perl, xor

我有以下 Perl 脚本，它使用 HEX 键对字符串进行按位异或：

```
#!/usr/bin/perl

$key = pack("H*","3cb37efae7f4f376ebbd76cd");

print "Enter string to decode: ";
$str=<STDIN>;chomp $str; $str =~ s/\\//g;
$dec = decode($str);
print "Decoded string value: $dec\n";

sub decode{ #Sub to decode
    @subvar=@_;
    my $sqlstr = $subvar[0];
    $cipher = unpack("u", $sqlstr);
    $plain = $cipher^$key;
    return substr($plain, 0, length($cipher));
} 
```

运行它的示例输出：

```
$ perl deXOR.pl
Enter string to decode: (?LM-D\=^5DB$ \n
Decoded string value: Bx3k8aaW 
```

我试图将它移植到 Ruby 但我做错了，结果不一样：

```
#!/usr/bin/env ruby

key = ['3cb37efae7f4f376ebbd76cd'].pack('H*')

print "Enter string to decode: "
STDOUT.flush
a_string = gets
a_string.chomp!
a_string = a_string.gsub(/\//, "")
dec = String(key)
puts "Decoded string value: "+dec

class String
  def xor(key)
    text = dup
    text.length.times {|n| text[n] = (text[n].ord ^ key[n.modulo key.size].ord).chr }
    text
  end
end 
```

样本输出：

```
$ ruby deXOR.rb
Enter string to decode: (?LM-D\=^5DB$ \n
Decoded string value: <³~úçôóvë½vÍ 
```

我究竟做错了什么？有什么想法吗？谢谢！

变了，还是乱七八糟

```
key = ['3cb37efae7f4f376ebbd76cd'].pack('H*')

def xor(text, key)
  text.length.times {|n| text[n] = (text[n].ord ^ key[n.modulo key.size].ord).chr}
  text
end

print "Enter string to decode: "
STDOUT.flush
a_string = gets
a_string.chomp!
a_string = a_string.gsub(/\//, "")
dec = xor(a_string, key)
puts "Decoded string value: "+dec 
```

输出：

```
$ ruby deXOR.rb
Enter string to decode: (?LM-D\=^5DB$ \n
Decoded string value: 2·Ê°¯Kµ2" 
```

在 Digitaka 的帮助下工作的版本：

```
key = ['3cb37efae7f4f376ebbd76cd'].pack('H*')

def decode(str, key)
  text = str.dup
  text.length.times { |n| text[n] = (text[n].ord ^ key[n.modulo key.size].ord).chr }
  text
end

print "Enter string to decode: "
STDOUT.flush
a_string = gets
a_string.chomp!
a_string = a_string.gsub(/\\n/, "")
a_string = a_string.gsub(/\\/, "")
a_string = a_string.unpack('u')[0]
dec = decode(a_string,key)
puts "Decoded string value: "+dec 
```

输出：

```
$ ruby deXOR.rb
Enter string to decode: (?LM-D=^5DB$ \n
Decoded string value: Bx3k8aaW 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T07:42:26.187

在 perl 中，您的代码正在对输入的字符串进行 uudecode，而在 ruby​​ 中没有发生等价的情况。这个片段 uudecodes 和像 perl 代码一样解码：

```
key = ['3cb37efae7f4f376ebbd76cd'].pack('H*')

# took some liberties to simplify the input text code
istr = "(?LM-D=^5DB$ ".unpack('u')[0]

def decode(str, key)
  text = str.dup
  text.length.times { |n| text[n] = (text[n].ord ^ key[n.modulo key.size].ord).chr }
  text
end

puts decode(istr,key) 
# => Bx3k8aaW 
```

# java - 从java中的网页中提取图像

> ID：14967001
> 
> 赞同：0
> 
> 时间：2013-02-19T20:43:09.487
> 
> 标签：java, html, jsoup, image-extraction

我刚刚开始从事内容提取项目。首先，我尝试访问网页中的图像 URL。在某些情况下，“img”的“src”属性具有相对 URL。但我需要获取完整的 URL。

我一直在寻找一些 Java 库来实现这一点，并认为**Jsoup**会很有用。有没有其他图书馆可以轻松实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T08:49:33.960

如果您只需要从相对 URL 获取完整的 URL，Java 中的解决方案很简单：

```
URL pageUrl = base_url_of_the_html_page;
String src = src_attribute_value; //relative or absolute URL
URL imgUrl = new URL(pageUrl, src); 
```

HTML 页面的基本 URL 通常只是您从中获取 HTML 代码的 URL。但是，文档标题中使用的 <base> 标记可用于指定不同的基本 URL（但不经常使用）。

您可以使用 Jsoup 或仅使用 DOM 解析器来获取 src 属性值并查找最终的基本标记。

# ios - 如何为 UIpicker 行分配 ID 和值？

> ID：14967002
> 
> 赞同：-1
> 
> 时间：2013-02-19T20:43:09.867
> 
> 标签：ios, objective-c, json, uipickerview

这是我使用 JSON 填充 UIPicker 的场景。

这是我的 JSON

```
{"id":["232","432"],"contact":["Administrator","Main"]} 
```

我将数据存储到一个 NSdictionary 中，然后在转换为对象后，我创建了一个 NSarray 来存储联系人。

我可以`contact`使用 NSJSONserialization 将值显示到下拉列表中。

我想在我的 JSON 发布请求中发送`id`所选联系人的对应信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:51:47.677

您错误地填充了数据源。你应该有一个这样的模型：

联系人：[{ id：“12”，姓名：“管理员”}，{ id：“13”，姓名：“Dude”}]

将其解析为数组后，`-pickerView:titleForRow:forComponent:`您必须从中选择一个 NSDictionary 值。从方法中从数据源获取的字典中获取 id 值`-pickerView:didSelectRow:inComponent:`。

编辑

```
- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{
  NSNumber *idNumber = _contacts[row][@"id"];
  //perform whatever action you need to with selected contact id
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-19T20:45:37.457

尝试使用这样的标签将 id 设置为 UIPicker，

选择器.tag = 232;

# php - 在 Symfony2 中设置字段默认选项

> ID：14967004
> 
> 赞同：0
> 
> 时间：2013-02-19T20:43:15.413
> 
> 标签：php, symfony, symfony-forms

在我使用 Symfony2 框架的 PHP 项目中，我使用的是 Symfony2 表单组件。例如，在 FormType 类中添加一个文本字段看起来像这样：

```
$options = array('error_bubbling' => true, 'required' => false);
$builder->add('username', 'text', $options); 
```

现在默认情况下，所有文本字段类型都将选项“error_bubbling”设置为 false，并将“required”设置为 true。因为我总是将 error_bubbling 设置为 true 并且 required 设置为 false，所以我想更改所有字段类型的默认选项。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:45:18.303

通过实现您自己的字段类型。没有办法影响 Symfony 的标准字段类型。

# c# - C# 对象看起来像动态类型

> ID：14967010
> 
> 赞同：5
> 
> 时间：2013-02-19T20:43:24.913
> 
> 标签：c#, .net, dynamic

一直在玩 4.0 DLR 并将动态与对象进行比较并遇到了这个问题：

代码：

```
object x = 10;
            Console.WriteLine("x = {0} and is a {1}.\n", x, x.GetType());
            x = (int)x + 3;
            Console.WriteLine("x = {0} and is a {1}.\n", x, x.GetType());
            x = x + "a";
            Console.WriteLine("x = {0} and is a {1}.\n", x, x.GetType()); 
```

结果：

> x = 10 并且是 System.Int32。
> 
> x = 13 并且是 System.Int32。
> 
> x = 13a 并且是 System.String。

对我来说，看起来对象试图在运行时（动态）使对象适应类型。但是，如果我不在第 3 行将 x 转换为 int，它会给我一个编译器区域，这对于静态类型来说似乎是正确的。但随后它允许我向 x 添加一个“a”，现在它将它识别为一个字符串。

我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T20:45:38.720

您错过了这样一个事实，即`+`运算符在应用于字符串时会进行自动转换（通过调用`.ToString()`不是该`String`类型实例的操作数上的方法）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T20:50:30.517

From the [C# Language Specification](http://msdn.microsoft.com/en-us/library/ms228593.aspx):

> **7.8.4 Addition operator**
> 
> When one or both operands are of type string, the predefined addition operators concatenate the string representation of the operands.
> 
> *   String concatenation:
>     
>     
>     
>     ```
>     string operator +(string x, string y);
>     string operator +(string x, object y);
>     string operator +(object x, string y); 
>     ```
>     
>     
>     
>     These overloads of the binary + operator perform string concatenation. If an operand of string concatenation is `null`, an empty string is substituted. Otherwise, any non-string argument is converted to its string representation by invoking the virtual `ToString` method inherited from type object. If `ToString` returns `null`, an empty string is substituted.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T20:48:15.337

请记住，*变量*的类型（即`object`）和它引用的对象的类型是有区别的。

允许最后一次转换，因为该`System.String`类型定义了一个运算符，该运算符接受 an`object`作为值之一并对其执行自动`ToString()`操作。

运行时或动态操作没有什么好玩的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T20:46:51.340

> 对我来说，看起来对象试图在运行时（动态）使对象适应类型。

并非如此：它只是锻炼了 .NET`object`存储任何类型对象的能力。

为了成为`dynamic`，一个变量应该允许你在没有强制转换的情况下调用任何东西，例如

```
dynamic x = "hello";
dynamic y = x.Substring(0, 2); // The compiler does not complain 
```

如果您尝试使用 "plain" 来完成上述技巧`object`，您会收到来自编译器的愤怒消息。但是，使用`dynamic`将抱怨推迟到运行时，此时它可能会发生，也可能根本不会发生。

> 但随后它允许我向 x 添加一个“a”，现在它将它识别为一个字符串。

那是编译器所做的“一件魔术”：它知道`object`有 a `ToString`，并自动为您插入调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-19T20:52:40.243

由于 C# 中的所有类型都派生自[对象](http://msdn.microsoft.com/en-us/library/system.object.aspx)类型，因此它可以存储*任何类型*。

```
object x = 10;
x = x + "a"; 
```

那就是编译器实际上所做的。由于`object`has `.ToString()`，当你使用时`+`，编译器会自动调用它。

即使当我们查看这个的*IL*代码时；

```
 .locals init ([0] object x)
  IL_0000:  nop
  IL_0001:  ldc.i4.s   10
  IL_0003:  box        [mscorlib]System.Int32
  IL_0008:  stloc.0
  IL_0009:  ldloc.0
  IL_000a:  ldstr      "a"
  IL_000f:  call       string [mscorlib]System.String::Concat(object,
                                                              object) 
```

`String.Concat`此方法的返回值是值的`string`表示。

来自**[C# 5.0 规范](http://msdn.microsoft.com/en-us/library/ms228593.aspx)**：

> *   字符串连接：
>     
>     
>     
>     ```
>     string operator +(string x, string y);
>     string operator +(string x, object y);
>     string operator +(object x, string y); 
>     ```
>     
>     
>     
>     二元 + 运算符的这些重载执行字符串连接。如果字符串连接的操作数是`null`，则替换为空字符串。`ToString`否则，通过调用从类型 object 继承的虚拟方法，将任何非字符串参数转换为其字符串表示形式。如果`ToString`返回`null`，则替换为空字符串。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-19T20:50:03.723

all data types on c# inherited from "object" so the basic behaviour on any operation depends on the operator & the other object

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-19T20:46:21.913

C# 中的所有内容都继承自`object`. `int`, `string`, `char`, 等等都可以。

当你这样做时：

```
object x = 10; 
```

您正在创建一个变量 ，`x`然后将其初始化为整数值 10。该值是`int`，它只是`boxed`放入一个对象中。

当您转换为时`x`，`int`您就是`unboxing`它的实际类型。

查看本指南以了解[装箱和拆箱](http://msdn.microsoft.com/en-us/library/yz2be5wk.aspx)

# c# - 返回字典 >

> ID：14967015
> 
> 赞同：1
> 
> 时间：2013-02-19T20:44:00.717
> 
> 标签：c#, collections

我正在尝试返回接口`IDictionary`（带有字符串键和列表值），例如：

```
IDictionary<string, ICollection<ValueSet>> method( ...) {

} 
```

从方法内部创建 Dictionary 对象：

```
var dic = new Dictionary <string, List <ValueSet> >(); 
```

一切正常，但我不能在`dic`这里返回对象。我不能隐式转换。

我怎样才能使这件事起作用？

```
public IDictionary < string, ICollection < ValueSet > > GetValueSets(ICollection < string > contentSetGuids)

{
    var dic = new Dictionary < string, List < ValueSet > > ();

    using (SqlCommand command = new SqlCommand())
    {
        StringBuilder sb = new StringBuilder(ValueSet.ValueSetQueryText);
        sb.Append(" where contentsetguid ");
        sb.Append(CreateInClause(contentSetGuids));

        command.CommandText = sb.ToString();

        dic = GetObjects(command).GroupBy(vs => vs.ContentSetGuid).ToDictionary(grp => grp.Key, grp => grp.ToList());

    }

    return dic;
} 
```

错误：错误 46 无法将类型“System.Collections.Generic.IDictionary>”隐式转换为“System.Collections.Generic.IDictionary>”。存在显式转换（您是否缺少演员表？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:04:59.037

您不能将 a`IDictionary<String, List<ValueSet>>`转换为 a`IDictionary<String, ICollection<ValueSet>>`因为`IDictionary<TKey, TValue>`不是[*协变*](https://blogs.msdn.com/b/csharpfaq/archive/2010/02/16/covariance-and-contravariance-faq.aspx?Redirected=true)的。例如，`IEnumerable<T>`接口*是*协变的，因此您可以根据需要`IEnumerable<List<ValueSet>>`转换为。`IEnumerable<ICollection<ValueSet>>`

但是，您可以通过在方法中创建正确类型的字典来解决您的问题。例如：

```
public IDictionary<string, ICollection<ValueSet>> GetValueSets(
    ICollection<ValueSet> contentSetGuids)
{
    var dic = new Dictionary<string, ICollection<ValueSet>>();   // <--

    using (SqlCommand command = new SqlCommand())
    {
        // ...
        dic = GetObjects(command)
              .GroupBy(vs => vs.ContentSetGuid)
              .ToDictionary(
                  grp => grp.Key,
                  grp => (ICollection<ValueSet>)grp.ToList());   // <--
    }

    return dic;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:15:35.427

我会考虑将界面更改为更灵活一些：

```
IEnumerable<KeyValuePair<string, IEnumerable<ValueSet>> GetValueSets(
    IEnumerable<ValueSet> contentSetGuids)

{
    // ....
    return GetObjects(command)
        .GroupBy(vs => vs.ContentSetGuid)
        .Select(new KeyValuePair<string, IEnumerable<ValueSet>>(grp.Key, grp.ToArray())
} 
```

让调用者创建一个字典，它需要一个。

*通常*我会将字符串（键）作为参数传递，一次只返回一个元素。但是在该方法中，您一次获得了全部数据，因此这没有多大意义。

# node.js - node.js - 无法使用 express3 加载我的文件

> ID：14967018
> 
> 赞同：1
> 
> 时间：2013-02-19T20:44:14.343
> 
> 标签：node.js, express

我正在使用 express3，当我尝试加载我的 html/javascript/css 文件时，它会加载没有 css 的 html。

我正在使用此代码加载文件 -

```
express.get('/', function (req, res) {
    res.sendfile("index.html");
    res.sendfile("style.css");
    res.sendfile("script.js");
}); 
```

那么我能做什么呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:48:21.113

首先，通过 HTML 标头中的标签将 css 和 javascript 链接到页面

```
<link rel='stylesheet' href='/path/to/style.css' />
<script src='/path/to/javascript.js'></script> 
```

确保您在 app.use() 部分中使用了静态中间件，这将告诉 Express 在哪里可以找到您的静态文件。

```
app.use(express.static(__dirname + '/public')); 
```

现在，您的 Express 应用程序应该为您的静态 css 和 js 文件提供服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T20:46:25.077

您从 html 页面链接到 css 和 javascript...

尝试查看 express github repo 中的静态文件示例应用程序：[https ://github.com/visionmedia/express/tree/master/examples/static-files](https://github.com/visionmedia/express/tree/master/examples/static-files)

基本上你对静态文件（.js，.css）发出另一个http请求

# ruby - 在 Ruby 中保存洗牌数组的顺序

> ID：14967022
> 
> 赞同：0
> 
> 时间：2013-02-19T20:44:17.777
> 
> 标签：ruby, arrays, shuffle

如果我说...

```
a = [1,2,3]
a.shuffle
puts a 
```

...它给出 [1,2,3]。如果相反我说...

```
a=[1,2,3]
a.shuffle!
puts a 
```

...每次我说 puts a 时，它都会给我一个新订单。所以我的问题是如何保存乱序数组的顺序？如果它第一次返回 [3,1,2] 它应该保持这个顺序。这有意义吗？

这是我正在谈论的一个例子。每次我打电话给 b 我都会得到不同的结果。

```
> a=[1,2,3]
=> [1, 2, 3]
> b=a.shuffl­e!
=> [1, 3, 2]
> b
=> [1, 2, 3]
> b
=> [2, 1, 3]
> b
=> [1, 3, 2]
> b
=> [3, 2, 1] 
```

“b”似乎指的是函数 a.shuffle 而不是 shuffle 本身的结果。

**答案：**

在 TryRuby.org 上使用在线解释器时出现问题。在我的 PC 上使用交互式 Ruby 解释器可以得到正确的结果。感谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T10:50:55.160

The problem occured when using the online interpreter on TryRuby.org. Using the interactive Ruby interpreter on my PC gives the correct result. Thanks to everyone for their help!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T20:50:42.013

Do you need somethinglike this:

```
a = [1,2,3]

b = a.shuffle

puts b 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T20:53:59.137

`a.shuffle`返回 的改组`a`，但不会改变`a`自身，因此您需要将结果分配给不同的变量（或者`a`如果这是您想要的）。`a.shuffle!`如果要直接更改方法，则需要调用`a`。

请参阅[为什么在 Ruby 方法中使用感叹号？](https://stackoverflow.com/questions/612189/why-are-exclamation-marks-used-in-ruby-methods)

# facebook - Facebook访问令牌过期如何延长？perl 桌面应用程序

> ID：14967031
> 
> 赞同：1
> 
> 时间：2013-02-19T20:44:38.200
> 
> 标签：facebook, perl, facebook-graph-api, oauth-2.0, facebook-oauth

我为 Facebook 制作了一个 Perl 脚本，但它在一段时间后不起作用，或者如果我注销。我认为这是由于访问令牌到期。

有人可以帮我延长令牌的有效期吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T20:58:20.553

[首先，看这里](https://developers.facebook.com/docs/howtos/login/extending-tokens/)

你可以找到类似的东西：

```
 https://graph.facebook.com/oauth/access_token?
     client_id=APP_ID&
     client_secret=APP_SECRET&
     grant_type=fb_exchange_token&
     fb_exchange_token=EXISTING_ACCESS_TOKEN 
```

它将返回令牌。

但！可以肯定的是，你调用了这个方法两次。第一次返回`2h expiring`令牌。
现在不知道他们用这个做什么。

# python - 安装 python settuptools 时出错 - 没有这样的文件或目录：'/usr/local/lib/python2.7/site-packages/test-easy-install-8811.pth'

> ID：14967032
> 
> 赞同：7
> 
> 时间：2013-02-19T20:44:41.400
> 
> 标签：python

我正在尝试在我没有 root 访问权限的 linux 机器上安装 settuptools。我已经创建了虚拟 python。

```
dgomez:~/download> which python
/home/dgomez/bin/python 
```

当我执行以下操作时，出现错误：

```
/home/dgomez/bin/python ez_setup.py 

Downloading http://pypi.python.org/packages/2.7/s/setuptools/setuptools-0.6c11-py2.7.egg
error: can't create or remove files in install directory

The following error occurred while trying to add or remove files in the
installation directory:

[Errno 2] No such file or directory: '/usr/local/lib/python2.7/site-packages/test-easy-install-8816.pth'

The installation directory you specified (via --install-dir, --prefix, or
the distutils default setting) was:

/usr/local/lib/python2.7/site-packages/

This directory does not currently exist.  Please create it and try again, or
choose a different installation directory (using the -d or --install-dir 
```

选项）。

我想知道如何解决这个问题。我在其他论坛中看到用户通过创建目录来修复它，但在我的情况下，我没有 root 访问权限，因为我无法创建目录。谢谢

## 更新

我跑了蟒蛇

```
ez_setup.py --install-dir=/home/dgomez/lib/python2.7/site-packages/ 
```

卜仍然得到一个错误：

```
You are attempting to install a package to a directory that is not
on PYTHONPATH and which Python does not read ".pth" files from.  The
installation directory you specified (via --install-dir, --prefix, or
the distutils default setting) was:

/home/dgomez/lib/python2.7/site-packages/

and your PYTHONPATH environment variable currently contains:

'' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T20:52:05.900

错误消息会告诉您确切的操作，使用`--install-dir`or`--prefix`选项，以便将包安装到您的虚拟 Python 安装而不是默认位置。

这可能看起来像这样：

```
/home/dgomez/bin/python ez_setup.py --prefix=/home/dgomez 
```

或与`--install-dir`：

```
/home/dgomez/bin/python ez_setup.py --install-dir=/home/dgomez/lib/python2.7/site-packages 
```

请注意，您可能需要根据 Python 安装的 site-packages 目录的实际位置修改上述选项中使用的目录。

**编辑：**要修复您看到的新错误，您需要将该目录添加到`PYTHONPATH`环境变量中，您可以使用以下命令执行此操作：

```
export PYTHONPATH=$PYTHONPATH:/home/dgomez/lib/python2.7/site-packages/ 
```

如果您在 Mac 或 GNU/Linux 发行版上使用 bash，您可以将该行添加到您的`~/.bashrc`文件中，这样您就不需要手动运行它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-19T19:06:54.140

我遇到了同样的问题。这个目录不知何故被删除了，所以我没有 pip 和 setuptools。我解决的方法是直接从[pip website](https://pip.pypa.io/en/latest/installing/)下载 pip 。我通过从[get-pip.py](https://bootstrap.pypa.io/get-pip.py)下载 pip 文件解决了这个问题。下载后，在你的python方向运行这个文件，你就可以再次使用这个setuptools了。

# php - PHP INSERT ON DUPLICATE KEY IGNORE 添加空值？

> ID：14967036
> 
> 赞同：0
> 
> 时间：2013-02-19T20:44:59.317
> 
> 标签：php, insert

我正在使用以下代码从 xml 文件更新数据库，一切都按预期工作，但现在我必须向表中添加 2 倍以上的字段并通过 html 表单手动更新数据。

当我运行表单时，我可以将数据插入“afk”和“remarks”字段，但在运行以下查询时，它会清空字段。

```
$insert = "INSERT INTO `ecmt_memberlist` (characterID,name,startDateTime,baseID,base,title,logonDateTime,logoffDateTime,locationID,location,shipTypeID,shipType,roles,grantableRoles, last_modified) VALUES('$characterID','$name','$startDateTime','$baseID','$base','$title','$logonDateTime','$logoffDateTime','$locationID','$location','$shipTypeID','$shipType','$roles','$grantableRoles','$modifiedTS') ON DUPLICATE KEY UPDATE 
name='$name',
startDateTime='$startDateTime',
baseID='$baseID',
base='$base',
title='$title',
logonDateTime='$logonDateTime',
logoffDateTime='$logoffDateTime',
locationID='$locationID',
location='$location',
shipTypeID='$shipTypeID',
shipType='$shipType',
roles='$roles',
grantableRoles='$grantableRoles',
last_modified = '$modifiedTS'"; 
```

是否可以告诉查询忽略已经存储在额外 2x 手动字段中的值并保持数据完整？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:05:24.070

如果你告诉 mysql 用空值更新一个字段，它会，据我所知，你有三个选项（按我的偏好排列......）：

1.  确保表单中的所有值在呈现时都与数据库中的值一起加载。如果您不想显示所有值，则可以使用隐藏输入；
2.  动态构建 sql 语句的第二部分（之后`ON DUPLICATE KEY UPDATE`）；仅当变量不为空时才添加字段；
3.  调整 sql 语句的第二部分（在 之后`ON DUPLICATE KEY UPDATE`）以仅更新特定数量的字段。我真的不会推荐这个。

顺便说一句，我还建议使用带有绑定变量的准备好的语句来避免 sql 注入问题。

**编辑：**第二个选项看起来像：

```
$insert = "INSERT INTO `ecmt_memberlist` (characterID,name,startDateTime,baseID,base,title,logonDateTime,logoffDateTime,locationID,location,shipTypeID,shipType,roles,grantableRoles, last_modified) VALUES('$characterID','$name','$startDateTime','$baseID','$base','$title','$logonDateTime','$logoffDateTime','$locationID','$location','$shipTypeID','$shipType','$roles','$grantableRoles','$modifiedTS') ON DUPLICATE KEY UPDATE
             name='$name'";
if (!empty($startDateTime))
{
  $insert .= ", startDateTime='$startDateTime'";
}
// etc. 
```

或者，如果您将所有字段都放在一个数组中，您可以循环，将字符串添加到一个新数组并内爆。

# jquery - 如何从评估方法返回值数组

> ID：14967038
> 
> 赞同：3
> 
> 时间：2013-02-19T20:45:04.837
> 
> 标签：jquery, casperjs

我正在使用 casper.evaluate() 从页面中获取数据数组。然而，它似乎无法返回一个数组（而返回的字符串可以完美地工作）。可能是什么问题？

为了澄清：评估中的代码是：

```
function(){ 
    return $('#id a').map(function(i, e) { 
        return $(e).attr('href'); 
    }).get(); 
} 
```

`.get()`调用结束时的意思是获取一个数组而不是一个 jQuery 对象。顺便说一句，我确定页面中提供了 jQuery。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T23:33:12.483

你在这里不需要 jQuery：

```
casper.evaluate(function() {
    return [].map.call(__utils__.findAll('#id a'), function(node) {
        return node.getAttribute('href');
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T23:39:58.603

我相信 .get() 是不必要的。

没有 .get() 的返回确实形成了一个非常好的数组，看看这个 jsfiddle 示例 [http://jsfiddle.net/YFsRw/](http://jsfiddle.net/YFsRw/)

```
r = function(){ 
    return $('#id a').map(function(i, e) { 
        return $(e).attr('href'); 
    }); 
}

var p = r();

// p servers as a nice array :)
for (i = 0; i < p.length; i++) {
    document.write(p[i] + "<br/>");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-13T07:28:37.267

## [**.toArray()**](http://api.jquery.com/toarray/)是您正在寻找的。

> **.toArray()** [返回：数组]
> 
> 描述：检索包含在 jQuery 集中的所有元素，作为一个数组。

```
function(){ 
    return $('#id a').map(function(i, e) { 
        return $(e).attr('href'); 
    }).toArray(); 
} 
```

* * *

**或者**，还有[`$.makeArray()`](http://api.jquery.com/jquery.makearray/)，它在更广泛的层面上工作，不仅仅是*jQuery 元素集*，并且以静态方式调用。

```
function(){ 
    return $.makeArray(
        $('#id a').map(function(i, e) { 
            return $(e).attr('href'); 
        })
    ); 
} 
```

（但**`.toArray()`**在这种情况下似乎更合适和更清晰。）

* * *

有关两者的比较，请参阅[此 SO 答案](https://stackoverflow.com/questions/16434145/difference-between-toarray-and-makearray-in-jquery)。

# c# - 在 3D 中随时间旋转

> ID：14967045
> 
> 赞同：0
> 
> 时间：2013-02-19T20:45:24.820
> 
> 标签：c#, xna, rotation

我正在使用 Xna 4，做一个游戏，我有一个游戏对象（宇宙飞船），它在 Y 轴 = 0 平面上的 3D 世界中移动.. 又名 2.5D..

到目前为止，我使用非常复杂的角度计算来创建 2 个向量之间的旋转，但该算法缺乏考虑对象已经旋转的能力。所以结果变得很有趣..因此我希望有人可以向我展示一种使用矩阵和矢量数学的智能且易于实现的方法，随着时间的推移进行这样的旋转。

我在之前的搜索中注意到，人们在他们的对象类中有以下变量： - 位置向量 3 - 右向量 3 - 上向量 3 - 旋转矩阵 - 变换矩阵矩阵 - 速度向量 3 - 等等。

我经常问自己，为什么对于一个简单的当前位置需要有这么多变量..或者我可能不理解..无论如何..

我目前有位置、旋转和变换矩阵，想知道我还需要什么以及如何计算它，然后你将如何随着时间的推移实现旋转。

我的右键单击移动命令 trig 调用的方法在单击发生位置的 Y = 0 平面上发送 vector3 位置。

```
public void MoveCommand(Vector3 pos){ } 
```

我对此进行了测试，给出的“pos”是准确的。任何帮助将不胜感激..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:01:19.097

您应该根据您想要的旋转检查 Matrix.CreateRotationX Y 或 Z。X、Y 或 Z 是旋转轴，如果选择 Y，您将看到“2D”旋转（偏航），因为这是您用作深度的轴。如果您选择 X 或 Z 轴，您将看到“3D”旋转（俯仰和滚动）

代码应如下所示：

```
WorldMatrix = Rotations * Translation 
```

其中 Rotations = Matrix.CreateRotationX(angleRadians) 和 Translation = Matrix.CreateTranslation(Position);

世界矩阵是影响模型的矩阵，视图和投影取决于相机

现在，如果您想知道向量之间的角度，您应该检查点积或 atan2 函数，因为您在 2D 中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T11:40:03.037

```
Vector3 Position;
float Rotation;

Matrix World
{
    get
    {
        return Matrix.CreateRotationZ(Rotation) * Matrix.CreateTranslation(Position);
    }
}

public void RotateInstantly(Vector3 position)
{
    Rotation = Math.Atan2(Position.Y - position.Y, Position.x - position.x);
}

public void RotateIncremently(Vector3 position, float maxStep)
{
    float targetRotation = Math.Atan2(Position.Y - position.Y, Position.x - position.x);
    float diff = targetRotation - Rotation;

    if (Math.Abs(diff) > maxStep)
    {
        if (targetRotation > Rotation)
            Rotation += maxStep;
        else
            Rotation -= maxStep;
    }
    else
        Rotation = targetRotation;
} 
```

您可以像这样使用 RotateIncremently：* float dt = (float)gameTime.ElapsedGameTime.TotalSeconds;

浮动 maxRotationVelocity = Math.TwoPi; //2* Pi 是一圈。

RotateIncremently(target.Position, maxRotationVelocity * dt);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T14:41:06.853

感谢 Stig-Rune Skansgård 的回复（如果你是丹麦语*hi5*），我修复了我的旧角度计算并让它在每种情况下都能正常工作。所以我想我会用适合我的解决方案来回答我自己的问题，这样未来访问者可以从中受益。这是一个非常大的 Ship 类的片段 + 一个计算角度的辅助方法：

```
public static float CalculateAngleFromVectors(Vector3 v1, Vector3 v2) {
        float x = 0;
        float X = v2.X - v1.X,
              Z = v2.Z - v1.Z;
        if (Z == 0) {
            x = (X < 0 ? 90 : 270);
        } else if (X == 0) {
            x = (Z < 0 ? 180 : -180);
        } else {
            float temp = MathHelper.ToDegrees((float)Math.Atan(X / Z));
            if (X < 0) {
                x = (Z < 0 ? Math.Abs(temp) : 180 - Math.Abs(temp));
            } else {
                x = (Z < 0 ? 360 - Math.Abs(temp) : Math.Abs(temp) + 180);
            }
        }
        return x;
    } 
```

此方法为您提供浮动角度（以度为单位）以旋转您的船（从标准 0 度起点）..

要使用它，只需在您的类中创建一些更新/动画方法，执行如下操作：

```
float desiredRotation = 0, currentRotation = 0, totalElapsed = 0, timePerFrame = 0.05f;
        if (desiredRotation != 0) {
            totalElapsed += elapsed;
            if (totalElapsed > timePerFrame) {
                if (isRotationComplete()) {
                    rotX += MathHelper.ToRadians(desiredRotation);
                    currentRotation = desiredRotation = 0;
                } else if (desiredRotation > currentRotation) {
                    currentRotation += shipTurnSpeed;
                } else if (desiredRotation < currentRotation) {
                    currentRotation -= shipTurnSpeed;
                }
                totalElapsed -= timePerFrame;
            }
        } 
```

编辑：和完成检查：

```
private bool isRotationComplete() {
        bool b = false;
        if (desiredRotation > currentRotation && currentRotation + shipTurnSpeed > desiredRotation) {
            b = true;
        } else if (desiredRotation < currentRotation && currentRotation - shipTurnSpeed < desiredRotation) {
            b = true;
        }
        return b;
    } 
```

本质上，它的作用是始终检查 DesiredRotation 是否大于 0.. 如果是，则意味着玩家已发出旋转命令（或 AI）.. 在我的示例中，CurrentRotation 是 ofc 多少自上次给出旋转命令以来已旋转，并在旋转完成后设置为 0。你应该有一个旋转矩阵，它使用不同的变量来显示旋转。我的是这样的：

```
public float rotX { get; set; }
    public float rotY { get; set; }
    public Vector3 position { get; set; }
    public Matrix Transform {
        get {
            return (Matrix.Identity *
                    Matrix.CreateScale(scale) *
                    Matrix.CreateRotationY(MathHelper.Pi) *
                    Rotation *
                    Matrix.CreateTranslation(position));
        }
    }
    public float ShipCurRotation { get { return (rotX + MathHelper.ToRadians(currentRotation)); } }
    public Matrix Rotation { get { return (Matrix.CreateRotationY(ShipCurRotation) * Matrix.CreateRotationX(rotY)); } } 
```

rotX 变量在旋转完成时在我的动画中设置，也在 Init 处设置。这是我如何使用我的第一个代码片段为我生成的旋转角度：

```
public void MoveToPosition(Vector3 pos) {
        desiredRotation = (CalculateAngleFromVectors(position, pos) - MathHelper.ToDegrees(rotX));
        isMoving = true;
    } 
```

..这使得一个平滑的可定制的旋转、变换和移动设置..在一个XZ平面ofc..Y轴是UP并且总是0..

如果您有任何建议或更改或想法以使事情变得更好，请随时对此发表评论。我总是乐于改进。感谢您的回复，并希望这对很多新开发人员有所帮助，我花了很长时间来收集这些东西来自网络..

PS。旋转可以直接应用到 rotX 进行即时旋转，绕过动画和旋转速度。

WithRegards MatriXz

# c# - 从其他用户控件加载用户控件 (ascx)

> ID：14967046
> 
> 赞同：2
> 
> 时间：2013-02-19T20:45:29.540
> 
> 标签：c#, asp.net, controls, ascx, webusercontrols

我有一个 UserControl (ascx)，根据用户的凭据，它将加载另一个 UserControl (ascx)。当前要加载的控件包含一个特殊的导航菜单。

我正在使用这段代码：

```
UserControl jmNav = 
    (UserControl)Page.LoadControl("~/controls/client/jmNavigation.ascx"); 
```

然后，在更多的代码之后，我告诉它加载，如下所示：

```
 SBarTopWelcome.Controls.Add(jmNav); 
```

问题是，我收到“对象引用未设置为对象实例”错误。

是的，路径是正确的——我也这样尝试过（在所有变体中）：

```
UserControl jmNav = (UserControl)Page.LoadControl("/client/jmNavigation.ascx"); 
```

这个（及其变体）告诉我它不存在。

所以！有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:04:39.513

一种有用的解决方案是添加`<%@ Register %>`到您的父控件。是的，我知道它在您的父页面中，但它也应该在您的控制范围内。

如果你这样做，你应该能够[强类型](http://en.wikipedia.org/wiki/Strong_typing)你的控件。例如，类名称为的控件`MyControl`将是：

```
MyControl controlVar = (MyControl)this.LoadControl("MyControl.aspx"); 
```

如果您能够获得 stronly 定义的变量，那么您应该没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:24:35.507

哈！我真是个笨蛋！我在这样的控件中声明了“SideBarWelcome”：

```
public Control sideBarTopWelcome
{
    get { return Page.FindControl("SideBarTopWelcome"); }
} 
```

当我应该这样做时：

```
public Control sideBarTopWelcome
{
    get { return FindControl("SideBarTopWelcome"); }
} 
```

没有`Page`. 无论如何，谢谢你们。我很感激。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T21:06:58.997

在**SideBar.ascx 中**添加一个名为**SideBarTopWelcomePlaceHolder**的占位符。

```
<asp:PlaceHolder ID="SideBarTopWelcomePlaceHolder" runat="server"/> 
```

然后像这样将**jmNavigation** UserControl 加载到**SideBarTopWelcomePlaceHolder**。

```
Control jmNav = 
    Control Page.LoadControl("~/controls/client/jmNavigation.ascx");
SideBarTopWelcomePlaceHolder.Add(jmNav); 
```

# mysql - mysql - 磁盘使用优化

> ID：14967051
> 
> 赞同：0
> 
> 时间：2013-02-19T20:45:40.460
> 
> 标签：mysql

我在 mysql 数据库服务器上有 23 个表。我听说 db server 中的磁盘使用量很大（3GB），但是当我执行以下 sql 以查看占用最多空间的内容时，它看起来不像占用 3GB。

```
SELECT TABLE_NAME, table_rows, data_length, index_length, 
round(((data_length + index_length) / 1024 / 1024),2) "Size in MB"
FROM information_schema.TABLES WHERE table_schema = "prod_schema"; 
```

有人知道为什么来自上述 sql 的数据与 db 中的实际空间使用情况不同吗？

或者是否有任何东西占用了数据库服务器中的空间？

我对数据库服务器的磁盘使用细节不太熟悉。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:10:32.187

If you are using MyIsam table engine, then this is the disk space you are using. BUT if you are using InnoDB then binlog and other log files might increase space utilization.

Plus if this "big disk usage (3GB)" was counted by simply looking at the total size of the MySQL library then this also includes the server exec files and different database log files.

# mediawiki - 将参数从动态页面列表传递到 Semantic Mediawiki

> ID：14967053
> 
> 赞同：3
> 
> 时间：2013-02-19T20:45:41.927
> 
> 标签：mediawiki, mediawiki-templates, semantic-mediawiki, dynamic-pages

我正在尝试创建一个模板，该模板将通过使用动态页面列表生成页面列表来输出动态报告，然后使用 Semantic Mediawiki 在每个页面上运行查询，在表格中输出整个混乱。模板的结构如下所示：

```
{| class="wikitable sortable collapsible collapsed" width="100%"
|- valign="bottom"
! width="15%" | Compound ID
! width="15%" | Generic name
! width="15%" | Trade name
! width="15%" | Developer
! width="10%" | Phase of development
! width="30%" | Target
{{#dpl:
 | category=compounds
 | linksto={{PAGENAME}}{{#dpl: linksto={{PAGENAME}} | redirects=only | mode=userformat | format=,{{!}},%TITLE%, | suppresserrors=true }}
 | ignorecase=true
 | distinct=strict
 | format=,{{!}}- valign="top"\n{{indication-based compound list/row|%TITLE%}}\n
 | noresultsheader={{!}}-\n{{!}} colspan="6" align="center" {{!}} ''No compounds have yet been studied for this indication.''
}}
|} 
```

`{{indication-based compound list/row}}`包括以下内容：

```
<includeonly>{{!}} {{#show: {{{1}}} | ?compound id }}
{{!}}{{!}} {{#show: {{{1}}} | ?compound generic name }}
{{!}}{{!}} {{#show: {{{1}}} | ?compound trade name }}
{{!}}{{!}} {{#show: {{{1}}} | ?developer }}
{{!}}{{!}} {{#ask: [[category:clinical studies]][[compound number::{{{1|}}}]] | ?Study phase=| limit=1| mainlabel=-| searchlabel=| sort=Study phase| order=descending }}
{{!}}{{!}} {{#show: {{{1|}}} | ?target }}</includeonly> 
```

查询是为什么这`{{#ask}}`不仅仅是一个直接的 DPL 表的原因：因为针对特定适应症的特定化合物的当前临床开发阶段是一个经常变化的动态数据，唯一的选择似乎是使用查询以`{{#ask}}`找出符合参数的临床试验中研究阶段的最高值。但是这个模板将调查自动生成的页面，我没有办法为每个化合物自动加载指示列表（应用语义标记），所以它是根据本身的指示链接列表生成的由`{{#dpl}}`每个复合页面上的函数生成。

我一步一步地完成了这一步，以下都不是问题：

1.  模板代码是健全的，并生成正确的结构。
2.  表格行模板是合理的，如果我删除该`{{#dpl}}`函数并将其替换为模板和复合页面名称作为参数，例如`{{indication-based compound list/row|infliximab}}`，它会创建我正在寻找的输出。
3.  使用默认输出格式时，该`{{#dpl}}`函数会生成正确的页面列表。
4.  当与简单的虚拟模板（只是一个无序列表）一起使用时，该`{{#dpl}}`函数会正确地将列表作为顺序参数传递。`format = ,{{template}}`

但是，当我将所有部分放在一起时，我只会得到空的表格单元格。`{{#show}}`and`{{#ask}}`函数似乎无法接受 DPL 输入作为参数。是否有我跳过的额外参数或中间步骤可以清理输入并使整个工作正常？还是DPL和SMW在这种方式上根本不兼容？

*   动态页面列表 2.01
*   语义媒体维基 1.8
*   媒体维基 1.20.2
*   PHP 5.3.19 (apache2handler)
*   MySQL 5.1.30

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T14:32:39.070

看起来问题是 Semantic Mediawiki在您使用参数时无法解析动态页面列表生成的`PAGE%`和变量，并且没有办法解决这个问题，因为 DPL 在函数完成之前不会将它们呈现为真实数据。`%TITLE%``format`

# sql - 使用交叉应用左连接查询

> ID：14967058
> 
> 赞同：36
> 
> 时间：2013-02-19T20:45:53.057
> 
> 标签：sql, sql-server, tsql

不太确定我是否可以离开加入从交叉应用函数获得的结果：

```
select
iv.invoiceno
,w.warehouse
,iv.invoicedate
,iv.invoicedesc
,iv.status
,iv.billingstart as [BillingFrom]
,iv.billingend as [BillingTo]
,CAST((iv.invoicesubtotal) as NUMERIC(38,2))as [Sub-Total] 
,CAST((((iv.invoicesubtotal+iv.invoicetax)-iv.invoicetotal)) as NUMERIC(38,2)) as [Discount]
,CAST((iv.invoicetax) as NUMERIC(38,2)) as [SalesTax]
,CAST((iv.invoicetotal) as NUMERIC(38,2)) as [Total]
,d.deal
,d.dealno
,ivt.orderno 
,ivt.rectype    
,ivt.rectypedisplay                                
,RTRIM(ivt.masterno) as [ICode]                               
,ivt.description as [ICodeDesc]                            
,ivt.fromdate as [From]                                
,ivt.todate as [To]                                  
,CAST((ivt.days ) as NUMERIC(38,2)) as [days]                                  
,CAST(ivt.qty as NUMERIC(38,0)) as [qty]                                  
,CAST((ivt.cost) as NUMERIC(38,2)) as [UnitCost]                                   
,CAST((ivt.rate) as NUMERIC(38,2)) as [rate]                                      
,CAST((ivt.daysinwk)as NUMERIC(38,2)) as [D/W]                              
,CAST((ivt.discountamt)as NUMERIC(38,2)) as [Discount]                             
,CAST((ivt.extended)as NUMERIC(38,2)) as [extended]                               
,(CASE WHEN ivt.taxable='T' then 'YES' else 'NO' END)as [Taxable]
,ivt.category
,(CASE WHEN (ivt.cost > 0 and ivt.rectype='R') THEN CAST((ivt.revenuebase) as NUMERIC (38,2)) ELSE 0 END) as [subrevenue]  from invoice iv
inner join deal d                                   on d.dealid=iv.dealid
inner join invoiceitemview ivt                      on iv.invoiceid=ivt.invoiceid and iv.invoiceno=ivt.invoiceno
inner join warehouse w                              on w.locationid=iv.locationid and w.inactive<>'T'
left join category c                                on c.categoryid=ivt.categoryid 
left join ordernoteview n                           on ivt.orderid=n.orderid and n.billing ='T'  where iv.locationid='00009V5H' and iv.invoiceno='H513369' and iv.status in ('CLOSED', 'PROCESSED') and iv.nocharge<>'T'         order by iv.invoiceno, iv.invoicedate,c.category,ivt.masterno 
```

我想用这个查询添加一个左连接：

```
select  tot.gldate, tot.glno, tot.glacctdesc,                  
   tot.debit,tot.credit,tot.glaccountid                       from invoice ivt cross apply dbo.funcglforinvoice(ivt.invoiceid, null, null) as tot where ivt.invoiceno='H513369' 
```

但是当我这样做时，它给了我更多的记录，然后应该有。

这已经执行了一段时间。基本上，内部交叉应用查询生成 204 个项目，我希望它与主查询中的项目保持连接；但我做错了什么不知道到底是什么。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-02-19T20:57:00.050

使用外部应用。另外我不确定是否真的需要 OUTER APPLY 之后的 ON 子句。如果 invoiceid 出来的和进去的一样，那么可能不会。

```
Select iv.invoiceno, iv.invoiceitem,iv.invoiceno
   from invoice iv
inner join deal d
        on d.dealid=iv.dealid
inner join invoiceitemview ivt
        on iv.invoiceid=ivt.invoiceid and iv.invoiceno=ivt.invoiceno
inner join warehouse w
        on w.locationid=iv.locationid and w.inactive<>'T'
left join category c
        on c.categoryid=ivt.categoryid 
left join ordernoteview n
        on ivt.orderid=n.orderid and n.billing ='T'
OUTER APPLY dbo.funcglforinvoice(iv.invoiceid, null, null) as tot 
```

# html - jPane 在两个 div 上滚动 - 问题

> ID：14967061
> 
> 赞同：0
> 
> 时间：2013-02-19T20:45:59.577
> 
> 标签：html, jpanel

我在我的网络中添加 jpanel 时遇到问题。

我有两个具有相同类的 div，我想在其中添加滚动，但是在第一次访问网络时，它只显示 1 个带滚动的 div。

当我刷新网页时，它会同时显示两者。（除了在 Chrome 中，它从不显示）

添加了所有需要的库，并且 div 具有类标记。

代码如下：

```
$(function()
{
    $('.scrollCh').jScrollPane();
}); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:56:09.970

这很奇怪，但是您是否尝试添加重新初始化选项？像

```
 var settings = {
      autoReinitialise: true
    };

    $('.scrollCh').jScrollPane(settings); 
```

# iphone - sqlite数据库中的另一个表用于附件 - iPhone Xcode 4.6

> ID：14967064
> 
> 赞同：0
> 
> 时间：2013-02-19T20:46:05.410
> 
> 标签：iphone, sqlite, xcode4.6

当我创建一个名为“X”的新表（取自现有的“Y”数据库）时，我无法将其附加到我的电子邮件中。我知道它在我的 iPhone 中（就像我一样

> ["SELECT * FROM sqlite_master where type='table'"]

第一的）。提前致谢。这是我的代码：

```
-(void)displayComposerSheet
{
    MFMailComposeViewController *picker = [[MFMailComposeViewController alloc] init];
    picker.mailComposeDelegate = self;

    //FileManager - Object allows easy access to the File System.
    NSFileManager *FileManager = [NSFileManager defaultManager];

    //Get the complete users document directory path.
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

    //Get the fist path in the array.
    NSString *documentsDirectory = [paths objectAtIndex:0];

    //Create the complete path to the database file.
    NSString *databasePath = [documentsDirectory stringByAppendingPathComponent:@"X.sqlite"];

    NSData *data = [NSData dataWithContentsOfFile:databasePath];
    [picker addAttachmentData:data mimeType:@"application/x-sqlite3" fileName:@"X.sqlite"];

    [picker setMessageBody:emailBody isHTML:NO];
    [self presentViewController:picker animated:YES completion:nil];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T23:04:48.043

基本上，我做了以下事情：

```
 //Delete Output file if it exists
if(sqlite3_open([databasePath UTF8String], &database) == SQLITE_OK)
{
    if(insertStmt == nil)
    {
        sqlite3_stmt *selectStatement;
        const char *sqlStatement=[[NSString stringWithFormat:
                                   @"DROP TABLE IF EXISTS fileOutput"]UTF8String];
        if(sqlite3_open([databasePath UTF8String], &database) == SQLITE_OK)
        {
            if (sqlite3_prepare_v2(database, sqlStatement, -1, &selectStatement, NULL) != SQLITE_OK)
            {
                NSAssert1(0, @"Error: failed to prepare statement with message '%s'.", sqlite3_errmsg(database));
            }
            while (sqlite3_step(selectStatement) == SQLITE_ROW)
            {

            }
            sqlite3_reset(selectStatement);
            sqlite3_finalize(selectStatement);
        }
    }
}
sqlite3_close(database);

//Add Output file
if(sqlite3_open([databasePath UTF8String], &database) == SQLITE_OK)
{
    if(insertStmt == nil)
    {
        sqlite3_stmt *selectStatement;
        const char *sqlStatement=[[NSString stringWithFormat:
                                   @"CREATE TABLE fileOutput AS SELECT * FROM Y WHERE 0"]UTF8String];
        if(sqlite3_open([databasePath UTF8String], &database) == SQLITE_OK)
        {
            if (sqlite3_prepare_v2(database, sqlStatement, -1, &selectStatement, NULL) != SQLITE_OK)
            {
                NSAssert1(0, @"Error: failed to prepare statement with message '%s'.", sqlite3_errmsg(database));
            }
            while (sqlite3_step(selectStatement) == SQLITE_ROW)
            {

            }
            sqlite3_reset(selectStatement);
            sqlite3_finalize(selectStatement);
        }
    }
}
sqlite3_close(database);

//Copy into table
if(sqlite3_open([databasePath UTF8String], &database) == SQLITE_OK)
{
    if(insertStmt == nil)
    {
        sqlite3_stmt *selectStatement;
        const char *sqlStatement=[[NSString stringWithFormat:
                                   @"INSERT INTO fileOutput SELECT * FROM Y WHERE file IN ('%@')",pickerField]UTF8String];
        if(sqlite3_open([databasePath UTF8String], &database) == SQLITE_OK)
        {
            if (sqlite3_prepare_v2(database, sqlStatement, -1, &selectStatement, NULL) != SQLITE_OK)
            {
                NSAssert1(0, @"Error: failed to prepare statement with message '%s'.", sqlite3_errmsg(database));
            }
            while (sqlite3_step(selectStatement) == SQLITE_ROW)
            {

            }
            sqlite3_reset(selectStatement);
            sqlite3_finalize(selectStatement);
        }
    }
}
sqlite3_close(database);

//Make the OUTPUT sqlite file
[self deleteEditableCopyOfDatabaseIfNeeded];

//ATTACH OUTPUT file to Y
const char *outputDBPath = [[documentsDirectory stringByAppendingPathComponent:@"X.sqlite"] UTF8String];

if (sqlite3_open([databasePath UTF8String], &database) == SQLITE_OK) {
    NSString *attach = [NSString stringWithFormat: @"ATTACH DATABASE \'%s\' AS X", outputDBPath];
    const char *attachSQL = [attach UTF8String];
    char *errorMessage;

    if (sqlite3_exec(database, attachSQL, NULL, NULL, &errorMessage) == SQLITE_OK) {

//Copy the table into sqlite file
            sqlite3_stmt *selectstmt;
            const char *sqlStatement1 = "INSERT OR REPLACE INTO X (all the fields go here ) SELECT * FROM fileOutput";
            if (sqlite3_prepare_v2(database,sqlStatement1, -1, &selectstmt, NULL) == SQLITE_OK) {
                while (sqlite3_step(selectstmt) == SQLITE_ROW) {
                //if(sqlite3_step(selectstmt)==SQLITE_DONE)
            //{
                    NSLog(@"insert successfully");
                }
            }
            else
            {
                NSLog(@"insert not successfully");

            }
            sqlite3_finalize(selectstmt);
        }
    }
    sqlite3_close(database);

[self sendEmailWithFile]; 
```

# javascript - 生产中的主干模板

> ID：14967065
> 
> 赞同：2
> 
> 时间：2013-02-19T20:46:11.747
> 
> 标签：javascript, backbone.js, underscore.js, templating

来自[https://github.com/ccoenraets/backbone-jax-cellar/blob/master/WebContent/js/utils.js](https://github.com/ccoenraets/backbone-jax-cellar/blob/master/WebContent/js/utils.js)：

```
tpl = {

// Hash of preloaded templates for the app
templates: {},

// Recursively pre-load all the templates for the app.
// This implementation should be changed in a production environment. All the template files should be
// concatenated in a single file.
loadTemplates: function(names, callback) {

    var that = this;

    var loadTemplate = function(index) {
        var name = names[index];
        console.log('Loading template: ' + name);
        $.get('tpl/' + name + '.html', function(data) {
            that.templates[name] = data;
            index++;
            if (index < names.length) {
                loadTemplate(index);
            } else {
                callback();
            }
        });
    }

    loadTemplate(0);
},

// Get template by name from hash of preloaded templates
get: function(name) {
    return this.templates[name];
}
}; 
```

我应该做类似的事情吗

```
$.get('tpl/all-tpls.html', function(data) { } 
```

获取所有的 html 模板？这不是不必要地获取一堆 html 吗？我们的应用程序是用 Java 构建的，我们正在使用[https://github.com/samaxes/minify-maven-plugin](https://github.com/samaxes/minify-maven-plugin)来缩小和合并我们的 js 和 css 文件。任何方向将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T01:39:59.003

**简短的回答**：是的。您应该首先在应用程序加载时加载所有模板，以便它们可用。在生产中，这可以与提供正确的远期到期标头相结合，以便在用户访问之间（即 1 年）为用户缓存模板。然后，您可以使用查询字符串破坏缓存，例如`tpl/all-tpls.html?v=001`

**更长的答案**：

出于性能原因，您很可能希望尽可能减少加载时间和请求数量。如果在模板已经可用的情况下加载新部分时延迟更少，这也将有助于应用程序感觉更灵敏。

在您的应用程序变得非常大之前，组合您的模板并缓存它们将是有效的。此时，您可能希望分解加载 - 例如基于应用程序部分的组。但是，将其视为生命周期性能优化 - 不要仅仅为了它而进行预优化。

# linq - 当不使用 .Distinct() 时，Linq 查询返回重复的结果 - 为什么？

> ID：14967070
> 
> 赞同：0
> 
> 时间：2013-02-19T20:46:25.950
> 
> 标签：linq

当我在 LinqPad 中使用以下 Linq 查询时，会返回 25 个结果：

```
var result = (from l in LandlordPreferences
          where l.Name == "Wants Student" && l.IsSelected == true
          join t in Tenants on l.IsSelected equals t.IsStudent
          select new { Tenant = t});
result.Dump(); 
```

当我添加`.Distinct()`到最后时，我只返回 5 个结果，所以，我猜当使用上述方法时，我会得到每个结果的 5 个实例。

我是 Linq 的新手，所以我想知道这是否是因为查询构建不佳？还是这是 Linq 一直以来的行为方式？当然不是 - 如果我返回 500 行`.Distinct()`，这是否意味着没有它返回 2,500？这会影响性能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T20:51:26.870

这是一个构建不佳的查询。
您正在加入布尔值`LandlordPreferences`而`Tenants`不是外键。因此，最有可能的是，您有 5 个选定的地主和 5 个学生租户。每个学生将针对每个地主返回：5 x 5 = 25。这是一个[笛卡尔积](http://en.wikipedia.org/wiki/Cartesian_product)，与 LINQ 无关。SQL 中的类似查询的行为相同。

如果您将地主添加到您的结果 ( `select new { Tenant = t, Landlord = l }`) 中，您会发现没有两个结果实际上是相同的。

如果您无法以某种方式修复查询，`Distinct`这是您唯一的选择。

# php - 包括从一个网站到另一个网站的脚本

> ID：14967072
> 
> 赞同：0
> 
> 时间：2013-02-19T20:46:29.977
> 
> 标签：php, include

我已经构建了一个脚本，用于在他们的网站上为人们购买简单的卡片。

我想要它，这样代码就不需要在他们的服务器上，这样他们就可以看到它并复制它并停止向我支付代码费用。我需要知道如何做到这一点！

进一步解释：
1）我有一个网站（我的）是前。www.website1.com/script/index.php （这是卡片脚本）
2）我想将它实施到客户网站前。www.website-client.com/buy-a-card.php（这是我希望我的脚本显示在他们网站上的地方）

PS。我试过php包含函数，它不起作用。

如何在不让他们看到代码并访问它来更改它、停止向我支付代码等的情况下做到这一点。

谢谢，乍得。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:53:14.353

您可以让他们包含一个指向您的脚本的 iframe，让他们从他们的站点重定向到您的脚本，或者让他们发布到您的脚本进行处理。

iframe 将是最容易上手的，但如果您传递的数据超出查询字符串允许的范围，您将需要一种方法让他们将数据传输到您的脚本。

# php - php - 合并数组保持键和递增

> ID：14967073
> 
> 赞同：0
> 
> 时间：2013-02-19T20:46:30.670
> 
> 标签：php, arrays, multidimensional-array, merge

我整天都在试图弄清楚这一点，但似乎无法解释或理解我想要实现的目标。假设我有 2 个数组：

```
Array
(
    [1] => Array
        (
            [2] => Dashboard
        )

) 
```

和

```
Array
(
    [1] => Array
        (
            [3] => Toasts
        )

) 
```

我想要做的是合并2个数组，如下所示：

```
Array
(
    [1] => Array
        (
            [2] => Dashboard,
            [3] => Toasts
        )

) 
```

但是，如果我有这样的事情：

```
Array
(
    [1] => Array
        (
            [2] => Dashboard
        )

)
Array
(
    [1] => Array
        (
            [2] => Toasts
        )

) 
```

我不想失去覆盖元素的值，而是像这样增加它

```
Array
(
    [1] => Array
        (
            [2] => Dashboard,
            [3] => Toasts
        )

) 
```

我已经尝试了从数组合并、递归合并甚至 eval 的所有方法，但我只是可以理解它。有没有人遇到过这个？我还没有找到的功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:04:24.420

你应该使用`$array['indexname'] = 'value';`. `array_merge()`或者`array_push()`在合并时不维护具有相同/关联键的值，因为无法确定下一个键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:05:00.403

也许不是一个真正的答案，而只是一种逃避覆盖的方法；

```
$a1 = array(array(2 => 'Dashboard'));
$a2 = array(array(3 => 'Toasts'));
$a3 = array(array(3 => 'Foo'));
$array = array();
foreach (array_merge($a1, $a2, $a3) as $a) {
    foreach ($a as $i => $value) {
        if (!isset($array[$i])) {
            $array[$i] = $value;
        } else {
            $array[] = $value;
        }
    }
}
print_r($array); 
```

```
大批
(
    [2] => 仪表板
    [3] => 祝酒词
    [4] => 富
)

```

# android - Android“自然地”关闭键盘

> ID：14967075
> 
> 赞同：2
> 
> 时间：2013-02-19T20:46:34.523
> 
> 标签：android, keyboard, android-edittext

在我的应用程序中，我有一个 edittext 来输入 url，然后 edittext 有：

```
android:imeOptions="actionDone" 
```

因此，当有人按下键盘的 Enter 按钮时，应用程序会连接并关闭键盘。但是，我还有一个可以单击而不是使用 enter 命令的按钮，在这种情况下，我将模拟按下软键盘的完成按钮，而不是使用其他线程中建议的典型方法来关闭键盘。这是我的做法：

```
v.findViewById(R.id.button1)
    .setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            edit.dispatchKeyEvent(new KeyEvent(0, 0, KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_ENTER, 0));

        edit.dispatchKeyEvent(new KeyEvent(0, 0, KeyEvent.ACTION_UP, KeyEvent.KEYCODE_ENTER, 0));
        }
    }); 
```

我有一个动作监听器，它捕获事件：

```
public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
    Log.e(TAG, "Key event received "+actionId);
    if (actionId == EditorInfo.IME_ACTION_DONE || 
            (event.getKeyCode() == KeyEvent.KEYCODE_ENTER && event.getAction() == KeyEvent.ACTION_UP)  ){
        Log.e(TAG, "Key event received  will connect");
        onConnectToServer(null);
        return true;
    }else if(event.getKeyCode() == KeyEvent.KEYCODE_ENTER) return true;
    return false;
} 
```

但我收到错误，似乎键事件被发送了 100 次，并且键码未被识别为输入按钮。我不想用其他方法关闭键盘的原因：

```
InputMethodManager imm = InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
imm.hideSoftInputFromWindow(mFilterEditText.getWindowToken(), 0); 
```

是因为在该代码之后，当我需要它在另一个片段中显示时，键盘不会再次自动显示（+我只有一个活动和许多片段，所以无法在清单中设置）有什么想法吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T14:59:04.147

不敢相信这很容易：

```
edi3.onEditorAction(EditorInfo.IME_ACTION_DONE); 
```

# java - 如何使使用 IKVM com 创建的 .dll 可见？

> ID：14967080
> 
> 赞同：7
> 
> 时间：2013-02-19T20:46:45.800
> 
> 标签：java, .net, excel, ikvm, vba

我已经看到了一些关于此的帖子，但到目前为止我还没有看到任何解决方案。我有一个 .jar 文件，我正在通过[IKVM](http://www.ikvm.net/)将其转换为 .NET DLL 。我试图弄清楚如何使 DLL 中的方法在 excel VBA 环境中可用。这是详细信息。

1.) 安装 IKVM 并将其 DLL 注册到 GAC

2.) 运行 IKVM 创建一个 .net .dll (mytest.dll)

```
ikvmc mytest.jar 
```

3.) 注册新的.dll

```
regasm mytest.dll 
```

4.) 从这里我创建了一个 VB.NET 项目并添加了 mytest.dll 和 IKVM.OpenJDK.Core.dll 作为对项目的引用。然后我可以访问 .NET 中的 .dll 中的方法。这很棒！

5.) 我真正想做的是能够在 VBA 中使用 .dll。最初 vba 不会直接接受 .dll，因为它是一个 .net 库。我试图创建一个类型库：

```
regasm /codebase /tlb mytest.dll 
```

这创建了一个很好的 .tlb 文件，但它确实引发了关于库没有被强命名的警告。

6.) 然后我在我的 vba 编辑器中加载了 .tlb 作为参考。这可行，但是当我尝试访问这些方法时，什么也没有出现。同样，如果我在对象查看器中查看我的库，我可以看到我的两个类，但看不到这些类的成员。

此外，我想我可能还需要以某种方式在 VBA 中引用 IKVM.OpenJDK.Core.dll。但是我也不能这样做，因为它是一个 .NET .dll。

有没有人成功地将 .jar 文件转换为可用于 VBA 的文件？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-20T09:04:44.627

我认为你总是需要明确标记一个类可以通过 COM 互操作使用。下面是一个可从 VBA 使用的 Java 类的示例：

```
import cli.System.Runtime.InteropServices.*;

@ClassInterfaceAttribute.Annotation(ClassInterfaceType.__Enum.AutoDual)
public class SampleWidget {
  public int Add(int x, int y) {
    return x + y;
  }
} 
```

以下是编译步骤：

1.  将 IKVM.Runtime.dll 和所有 IKVM.OpenJDK.*.dll 复制到当前目录或 GAC 中。
2.  运行“ikvmstub mscorlib”生成mscorlib.jar。
3.  创建一个名为 SampleWidget.java 的 Java 源代码，其中包含上面的代码。
4.  javac -cp mscorlib.jar;。SampleWidget.java
5.  ikvmc -out:SampleLibrary.dll SampleWidget.class -r:mscorlib.dll
6.  tlbexp SampleLibrary.dll
7.  regasm /codebase SampleLibrary.dll（此步骤需要管理员权限）

现在您可以从 VBA 添加对 SampleLibrary.tlb 的引用并使用 SampleWidget 类。

# php - 当我的 XAJAX 调用通过 PHP 返回 NULL - 它显示在 IE 上（但它应该什么也不显示），如何纠正这个问题？

> ID：14967082
> 
> 赞同：0
> 
> 时间：2013-02-19T20:46:49.730
> 
> 标签：php, internet-explorer, xajax

请查看以下代码片段：

首先，Javascript调用：

```
function getNewSelect(property_id){
  xajax_getSelectDropDown(unique_id);
  $(".chzn-select").chosen();
} 
```

接下来，PHP XAJAX 函数：

```
function getSelectDropDown($unique_id){
    //CODE ABOVE THIS POINT HAS BEEN REMOVED, IT IS IRRELEVENT FOR THIS EXAMPLE

        //Code for if no matches were found:
        $html2 = NULL;

        $objResponse = new xajaxResponse();
        if(mysql_num_rows($result) > 0){
            $objResponse->assign('subDiv', 'innerHTML', $html);
        }else{
            $objResponse->assign('subDiv', 'innerHTML', $html2);
        }

        $objResponse->script("$('.chzn-select-ajax').chosen();");

    return $objResponse;
} 
```

最后是 HTML 代码：

```
<div id="subDiv"></div> 
```

现在，当上面的 PHP 函数进入`else`并分配时`$html2`- 我希望不会向用户显示任何内容。在大多数浏览器上，这很好，而且效果很好。不幸的是，在 Internet Explorer 上（我可以确认 IE 9，我无法测试其他版本），它实际上在 DIV 调用处显示以下内容：

> 空值

如果找到结果并且它不处理`else`，那么它在所有浏览器上都能正常工作，并按预期显示一个新的下拉列表。

我能做些什么来解决这个问题？这是 IE 的已知问题吗？谢谢。

我想添加所以没有混淆，CHZN 调用只是为下拉列表添加样式，如下所示：http: [//harvesthq.github.com/chosen/](http://harvesthq.github.com/chosen/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:18:05.930

更好地使用这个：

```
 if(mysql_num_rows($result) > 0){
        $objResponse->assign('subDiv', 'innerHTML', $html);
    }else{
        $objResponse->assign('subDiv', 'innerHTML', '');
    } 
```

IE 显示 null 因为 $html2 = NULL ......最好用 $html2 = " " 或类似的东西试试；）

萨卢多斯。

# iphone - 如何在 ZBarReaderView 上放置方括号？

> ID：14967085
> 
> 赞同：-1
> 
> 时间：2013-02-19T20:46:55.270
> 
> 标签：iphone, ios, zbar-sdk

我正在开发一个二维码扫描仪，为此我正在使用 ZBarSdk。我能够成功读取所有二维码并将它们解析为有意义的信息。在观看一些示例时，我发现 ZBarReaderViewController 可以在模拟扫描区域的扫描时放置图像。他们正在使用相同的 cameraOverlay 功能，但是我发现 ZBarReaderView 没有相同的功能。如何在扫描表面上放置图像？

我本可以使用 ZBarReaderViewController，但是我的应用程序的设计方式是，如果我使用 ZBarReaderViewController，我将面临 modalviewcontroller 存在的问题，因此我非常需要带有 ZBarReaderView 的 cameraoverlay。下面是我了解 ZBarReaderViewController 的 cameraOverlayView 功能的链接。

[ZBar SDK中出现摄像头时，是否可以为焦点放置方括号？](https://stackoverflow.com/questions/8291299/is-it-possible-to-put-a-square-bracket-for-the-focus-when-the-camera-appears-in)

![我想要我的长相像这样](../Images/8f29b610afe4c3b76b0c457c95dd9e49.png)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-19T21:30:29.477

在初始化 ZBarReaderView 之后，我使用以下代码完成了它：

```
UIImage *ivg = [UIImage imageNamed:@"green.png"];
UIImageView *bh = [[UIImageView alloc]initWithFrame:CGRectMake(x, y, height, width)];
bh.image = ivg;
[self.view addSubview:bh]; 
```

# c++ - c ++将宏变量转换为wchar字符串文字的简单方法

> ID：14967086
> 
> 赞同：4
> 
> 时间：2013-02-19T20:47:05.663
> 
> 标签：c++, macros

在下面的示例中，我想删除该`std::wstring(std::widen(...))`部分，但“#”宏只返回一个 char 字符串文字——有没有办法容纳一个 wchar？

```
#define FOO_MACRO(className)\
struct className##Factory : public OtherClass {\
// does some stuff here\
} className##Factory;\
someMap->add(std::wstring(std::widen(#className), className##Factory))) 
```

我将如何使用 wchar 做同样的事情？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-19T21:38:37.777

您在字符串文字上使用`L`前缀来制作 wchar 字符串文字：

```
#define CAT(A, B)   A##B
#define WSTRING(A)  CAT(L, #A) 
```

# php - $_FILES 和 $_POST 使用 ajax

> ID：14967087
> 
> 赞同：0
> 
> 时间：2013-02-19T20:47:11.030
> 
> 标签：php, jquery, mysql, ajax

在我的表单中，我添加了输入文件。

```
<input name="uploadedFile" type="file" size="50" accept="application/pdf" /> 
```

我有这个ajax：

```
$("#submit").click(function() {
  $.ajax({
    type: "POST",
    url: "submit.php",
    data: $("form").serialize(),
    success: function(result){
       alert(result);
    });
    return false;
}); 
```

如何将文件数据传递给 submit.php 并使用 submit.php 中的代码上传。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T20:49:45.753

jQuery serialize doesn't support file type inputs. From the docs:

> Data from file select elements is not serialized.

You will need to roll your own solution using the [HTML5 FileReader API](http://www.html5rocks.com/en/tutorials/file/dndfiles/), to read the contents of the input as a base64-encoded string.

More likely, you will want to use traditional HTML form submission and avoid AJAX altogether for this.

# shell - 使用命令行拆分文件

> ID：14967088
> 
> 赞同：0
> 
> 时间：2013-02-19T20:47:15.393
> 
> 标签：shell, command-line, ssh, command

这是我目前用来分割文件的方法：

```
split -l 500 myfile.txt file_ 
```

它会自动创建像 file_aa、file_ab 等文件。

有没有办法使用数字而不是字母，以便它是 file_1、file_2 等等？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:52:22.670

人分裂 说：

```
split -d -n 4 -l 500 myfile.txt file_ 
```

或者

```
split --numeric-suffixes --digits=4 --lines=500 myfile.txt file_ 
```

# ember.js - 同一类型的 hasMany 关联字段上的 pushObject 不会弄脏对象

> ID：14967102
> 
> 赞同：0
> 
> 时间：2013-02-19T20:48:20.563
> 
> 标签：ember.js

在我的应用程序中有`hasMany`其他视频的视频（App.Video）。

```
App.Video = DS.Model.extend({
    responses: DS.hasMany('App.Video')
}); 
```

我想为视频添加回复，所以我正在做

```
var video = App.Video.find('1');
var response = App.Video.find('2');
video.get('responses').pushObject(response); 
```

但是，`v.get('isDirty')`返回`false`.

知道为什么吗？知道如何将这种新关系发送到服务器吗？

谢谢。

# php - 带有标头代码的 PHP 警告

> ID：14967116
> 
> 赞同：0
> 
> 时间：2013-02-19T20:48:55.377
> 
> 标签：php, header, warnings

我编写了这段代码并在我的本地主机上完美运行，但上传后我收到以下错误代码：

```
<?php
require ('config.php');
$dblink = new PDO("mysql:host=$host;dbname=$db",$user,$pass);
session_start();
    $user = $_POST["user"];
    $pass = md5($_POST["pass"]);
    $mysql_login = "SELECT * FROM admins WHERE username='$user' AND password='$pass'";
    $query_login = $dblink->query($mysql_login) or die("failed!");
    $total = $query_login->rowCount();
    if($total==1){
    $_SESSION["loggedIn"] = true;
    header("Location:admin.php");
    }else{
    header("Location:admin.php");
    }
?> 
```

这是错误

> 警告：无法修改标头信息 - 标头已由第 12 行 /home/voiceiq/public_html/login.php 中的（输出开始于 /home/voiceiq/public_html/config.php:8）发送

正如我在我的本地主机“Xampp Server”中告诉你的那样，它运行良好，但在上传警告剧照后显示。

请问有什么帮助吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T20:51:25.393

`?>`从 config.php 的底部删除。您不需要它，它之后的空间可能会导致您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T20:50:13.940

只要确保您的文件不包含任何空格并且脚本不回显任何内容。使用`header();` 前同样关于`require ('config.php');`

另外，尝试将您的文件编码为`UTF-8 without BOM`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T20:51:18.157

在重定向发生之前发送、“回显”或“显示”某些内容。

阅读此页面上的“描述”块，里面的灰色块。

[http://www.php.net/manual/en/function.header.php](http://www.php.net/manual/en/function.header.php)

弄清楚它是什么，解决它，您将不再收到该警告。

# css - 如何结合背景图像和 CSS 渐变

> ID：14967120
> 
> 赞同：1
> 
> 时间：2013-02-19T20:49:06.673
> 
> 标签：css, background-image

不知道我在这里出了什么问题。渐变显示很好，但图像不是。

页面位于此处（wordpress 网站）：

[http://philfaranda.staging.spatialmatch.com/](http://philfaranda.staging.spatialmatch.com/)

```
body {  
    background-color: #FFF !important; /* fallback color if gradients are not supported */
    background: #fff url(/wp-content/uploads/2013/01/body-bg2.png) repeat-x !important;
    background-image: -webkit-linear-gradient(top, #fff, #A9A9A9) !important; /* For Chrome and Safari */
    background-image:    -moz-linear-gradient(top, #fff, #A9A9A9) !important; /* For old Fx (3.6 to 15) */
    background-image:     -ms-linear-gradient(top, #fff, #A9A9A9) !important; /* For pre-releases of IE 10 */
    background-image:      -o-linear-gradient(top, #fff, #A9A9A9) !important; /* For old Opera (11.1 to 12.0) */
    background-image:         linear-gradient(to bottom, #fff, #A9A9A9) !important; /* Standard syntax; must be last */
} 
```

编辑：似乎渐变效果没有显示在 IE 中，图像是......

在此先感谢您的帮助，肯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:54:44.797

`background-image`覆盖`backgorund`。为了使其正常工作，还需要单独指定后台重复。在 FF 中测试

```
body{
    background-color: #fcfcf0;
    background-repeat:repeat-x;
    background-image: url(../img/abdul.jpg), -moz-linear-gradient(top, #fff, #A9A9A9);
    /* And the same with other ugly prefixes */
    /* For older IE*/
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffff', endColorstr='#A9A9A9');
} 
```

从 Ken 的评论看来，IE 9 会出现问题。它不能处理渐变和图像。

现在，为了让它在 IE 中工作，你应该添加类似于上面代码片段的渐变，而不是包装`div`你应该添加图像 css 的整个内容。

```
<body style="gradients styles...">
<div style="background-image styles">
Your content
</div>
</body> 
```

# jquery - div元素的html到textarea

> ID：14967121
> 
> 赞同：1
> 
> 时间：2013-02-19T20:49:07.360
> 
> 标签：jquery, html, markitup

我在我的网页中使用 markItUp 编辑器，我想对授权用户进行动态编辑。当用户双击发布 Jquery 将 div 变成 textarea 和

```
#textarea.markItUp(); 
```

将 textarea 转换为标记编辑器。但是我的问题是 post 有太多 < p> 标签，当我将 div 转换为 textarea 时，结果如下：http: [//jsfiddle.net/D3v7F/](http://jsfiddle.net/D3v7F/)（单击更改）

但我想将 < p> 显示为新段落。如何做到这一点？和 <strong> 标记到 [b]strong 的内部文本中[/b]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T20:59:25.010

试试这个：

```
$('#submit').click(function(e){
    var html = $('.change p').html();

    $('.change').replaceWith('<textarea>'+html + '\r\nNew paragraph</textarea>').html().focus();
}); 
```

JSFiddle：http: [//jsfiddle.net/D3v7F/3/](http://jsfiddle.net/D3v7F/3/)

# c# - Allow objects to pass through an object while also detecting the collision in Unity3D

> ID：14967122
> 
> 赞同：0
> 
> 时间：2013-02-19T20:49:14.180
> 
> 标签：c#, unity3d

I am trying to get a ball to pass trough an empty object but also send back a message to debug window. But I don't have a clue how to do this or where to start, so any help on this would be greatly appreciated. I am sorry I have no code to show as an example, however I have been able to get a collision detection or to allow the object pass through the empty object one at a time but never both. I have used `OnTriggerEnter` and `OnCollionEnter`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:54:23.200

在您的空对象上放置一个`Collider`（例如 a `SphereCollider`），并将其设置`Is Trigger`为`true`. 现在您可以`OnTriggerEnter`按预期在脚本中使用（附加到空对象）。

```
public class MyBehaviour : MonoBehaviour
{
    private void OnTriggerEnter(Collider other)
    {
        var collider = other.gameObject;
        // Do something...
        Debug.Log(collider);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T00:41:35.700

你想让你的游戏对象的对撞机成为编辑器上的触发器。转到编辑器并将对撞机添加到您的游戏对象，然后将其设为触发器。

C# 代码

```
void OnTriggerEnter(Collider other)
{
    Debug.Log("I hit something: " + other.gameObject);
} 
```

Javascript

```
function OnTriggerEnter (other : Collider) 
{
    Debug.Log("Hey I hit you: " + other.gameObject);
} 
```

# java - Drop incoming call

> ID：14967124
> 
> 赞同：2
> 
> 时间：2013-02-19T20:49:24.257
> 
> 标签：java, android, android-broadcast

I'm trying to block incoming call in android. I have this BroadcastReceiver but it handles the incoming call but does not block incoming call on my android 2.3.6 phone(didn't try on other versions). here is my receiver:

```
public class PhoneCallReceiver extends BroadcastReceiver {
    Context context = null;
    private static final String TAG = "Phone call";
    private ITelephony telephonyService;

    @Override
    public void onReceive(Context context, Intent intent) {
        Log.v(TAG, "Receving....");

        TelephonyManager telephony = (TelephonyManager) context
                .getSystemService(Context.TELEPHONY_SERVICE);
        try {
            Class c = Class.forName(telephony.getClass().getName());
            Method m = c.getDeclaredMethod("getITelephony");
            m.setAccessible(true);
            telephonyService = (ITelephony) m.invoke(telephony);
            // telephonyService.silenceRinger();

            telephonyService.endCall();
        } catch (Exception e) {
            Log.v(TAG, "failed....");
            e.printStackTrace();
        }    
    }    
} 
```

and the ITelephony

```
package com.callblocker.mk;

interface ITelephony {

  boolean endCall();

  void answerRingingCall();

  void silenceRinger();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-01T13:24:15.483

在广播接收器中调用此方法

```
 public static void disconnectPhoneItelephony(Context context) {
     ITelephony telephonyService;
     Log.v(TAG, "Now disconnecting using ITelephony....");
      TelephonyManager telephony = (TelephonyManager) 
      context.getSystemService(Context.TELEPHONY_SERVICE);  
      try {
          Log.v(TAG, "Get getTeleService...");
          Class c = Class.forName(telephony.getClass().getName());
          Method m = c.getDeclaredMethod("getITelephony");
          m.setAccessible(true);
          telephonyService = (ITelephony) m.invoke(telephony);
            telephonyService.endCall();
      } catch (Exception e) {
       e.printStackTrace();
       Log.e(TAG,
               "FATAL ERROR: could not connect to telephony subsystem");
       Log.e(TAG, "Exception object: " + e);
      }
 } 
```

//广播接收器

```
 @Override
public void onReceive(Context context, Intent intent) {

    if (!intent.getAction().equals("android.intent.action.PHONE_STATE")) 
         return;
     else {

         disconnectPhoneItelephony(context);
}} 
```

//显现

```
 <!-- BLOCK CALL -->
 <uses-permission android:name="android.permission.READ_PHONE_STATE" />
 <uses-permission android:name="android.permission.CALL_PHONE" />
 <uses-permission android:name="android.permission.PROCESS_INCOMING_CALLS" />

<receiver android:name="receiver.CallReceiver" >
        <intent-filter android:priority="999" >
            <action android:name="android.intent.action.PHONE_STATE" />
        </intent-filter>
     </receiver> 
```

# iphone - 如何在uitableview中禁用用户与单元格的交互

> ID：14967125
> 
> 赞同：2
> 
> 时间：2013-02-19T20:49:25.597
> 
> 标签：iphone, objective-c, uitableview

我有用于 youtube 电影的简单 UITableView。单元格从数组加载，当我从 youtube API 获取前 10 部电影时，最后一个单元格是“加载更多”单元格。当用户点击“加载更多”单元格时，它将获取并加载接下来的 10 部电影。一切都很好，除非我在“负载单元”上快速点击两次或更多次，然后它会用新数组刷新我的表格，而不是我有奇怪的行为（所有单元格的电影都消失了，我有很多“负载更多”单元格分布在表格行中）所以我的表格完全乱了。如果我轻按一下“加载更多”单元格，则不存在问题。

在点击我的单元格后，我已将 userInteractionEnabled 设置为 NO，但它没有帮助。有人可以告诉我我做错了什么吗？这是我的代码：

```
 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
 {
   //Load more json data if loadmore cell tapped
    if (indexPath.row == self.videos.count) {
       self.loadCell.userInteractionEnabled = NO;
       self.loadCell.title.text = @"loading...";

    //Activity indicators for loadmore cell
      [self.loadCell.loadMoreActivityIndicator startAnimating];
      [UIApplication sharedApplication].networkActivityIndicatorVisible = YES;

      [self performSelectorInBackground:@selector(youtubeFeedMore) withObject:nil];
  }

 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:07:57.030

设置 UserinteractionEnabled 不会阻止委托方法 tableView: didSelectRowAtIndexPath: 被调用，因此您需要跟踪为包含 tableViewCell 的行调用 didSelectRowAtIndexPath 的次数，在这种情况下是一次，然后运行

`[self performSelectorInBackground:@selector(youtubeFeedMore) withObject:nil];`

如果该行仅被点击一次。

例如：

```
@property (assign) BOOL enableLoadMoreCell;

 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
 {
   //Load more json data if loadmore cell tapped
if (indexPath.row == self.videos.count && self.enableLoadMoreCell == YES) {
   self.enableLoadMoreCell = NO;

   self.loadCell.userInteractionEnabled = NO;
   self.loadCell.title.text = @"loading...";

//Activity indicators for loadmore cell
  [self.loadCell.loadMoreActivityIndicator startAnimating];
  [UIApplication sharedApplication].networkActivityIndicatorVisible = YES;

  [self performSelectorInBackground:@selector(youtubeFeedMore) withObject:nil];
}

}

-(void)youtubeFeedMoreSelectorEnded {
  ....
Your Code
   self.enableLoadMoreCell = YES; 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:02:40.973

放

```
[self.view setUserInteractionEnabled:NO]; 
```

加载时，然后将其更改为

```
 [self.view setUserInteractionEnabled:YES]; 
```

加载完成后

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:06:15.520

如何确保任何时候只有一个 loadMore 请求在运行？然后您不需要阻止双击 - 只需记住已发送加载更多请求，并在请求返回或超时后重置标记。

# java - 操作栏溢出中的单元测试菜单项

> ID：14967127
> 
> 赞同：1
> 
> 时间：2013-02-19T20:49:35.760
> 
> 标签：java, android, unit-testing, junit, android-actionbar

我在 Junit 中编写了一个简单的单元测试，试图测试我的 2 个操作栏溢出菜单项是否打开了正确的活动。我的测试回来时遇到问题

```
junit.framework.AssertionFailedError: expected:<true> but was:<false>  (**FIXED**) 
```

我还试图弄清楚如何验证活动是否已成功打开并且它是预期的活动启动。

非常感谢任何帮助、示例和/或评论。

```
public void testThatMenuWillOpenSettings() {
    // Will be sending Key Event to open Menu then select something
    ActivityMonitor am = getInstrumentation().addMonitor(
            Settings.class.getName(), null, false);

    // Click the menu option
    getInstrumentation().sendKeyDownUpSync(KeyEvent.KEYCODE_MENU);
    getInstrumentation().invokeMenuActionSync(mActivity,
            com.example.app.R.id.menu_settings, 0);

    // If you want to see the simulation on emulator or device:
    try {
        Thread.sleep(1000);
      } catch (InterruptedException e) {
        e.printStackTrace();
      }

    Activity a = getInstrumentation().waitForMonitorWithTimeout(am, 1000);
    assertEquals(true, getInstrumentation().checkMonitorHit(am, 1)); 

      // Check type of returned Activity:
      assertNotNull(a);
      assertTrue(a instanceof Settings);

      a.finish();

} 
```

我也在为这个单元测试使用 (ActivityInstrumentationTestCase2)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:59:45.157

您的测试代码非常好。AssertionFailedError 表明通过菜单点击模拟打开的 Activity 不是 ActivityMonitor 正在监控的。根据名称`menu_settings`，我猜这是您应用程序的首选 Activity，而您正在监视不同的 WebView Main Activity，这就是 ActivityMonitor 未命中的原因。要修复这种不一致，要么将 ActivityMonitor 更改为监视 Activity_Pref_Settings，要么将菜单单击模拟更改为打开 R.id.menu_webview_main。

> 我还试图弄清楚如何验证活动是否已成功打开并且它是预期的活动启动。

您可以使用`instanceof`检查返回活动的类型：

```
public void testThatMenuWillOpenSettings() {
  // Use false otherwise monitor will block the activity start and resulting waitForMonitorWithTimeout() return null: 
  ActivityMonitor am = getInstrumentation().addMonitor(Activity_Webview_Main.class.getName(), null, false);

  ... ...

  // If you want to see the simulation on emulator or device:
  try {
    Thread.sleep(1000);
  } catch (InterruptedException e) {
    e.printStackTrace();
  }

  Activity a = getInstrumentation().waitForMonitorWithTimeout(am, 1000);
  assertEquals(true, getInstrumentation().checkMonitorHit(am, 1));

  // Check type of returned Activity:
  assertNotNull(a);
  assertTrue(a instanceof Activity_Webview_Main);

  a.finish();

} 
```

请注意，不需要对返回的活动进行进一步检查，但可以进行检查，例如检查标题、标签文本等。

# google-chrome-extension - How do I use YUI3 in a Chrome extension?

> ID：14967130
> 
> 赞同：2
> 
> 时间：2013-02-19T20:49:49.310
> 
> 标签：google-chrome-extension, yui

If I download the minified YUI3 loader and include it in my background.html I get the following error:

Uncaught EvalError: Refused to evaluate a string as JavaScript because 'unsafe-eval' is not an allowed source of script in the following Content Security Policy directive: "script-src 'self' chrome-extension-resource:".

Can YUI3 be used in an extension?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-27T02:35:11.993

看起来它阻止您使用 eval()。确保清单中有以下行。

`"content_security_policy": "script-src 'self' 'unsafe-eval'; object-src 'self'"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:25:38.893

这就是我能够做到的。从 git 克隆 yui3 和 yui3-gallery，在我的扩展树中添加我需要的模块。然后从 popup.html 和 background.html 加载 config.js。该文件如下所示：

```
YUI_config = {
    filter: "raw",
    base: "yui3/build/",
    root: "yui3/build/",
    comboBase: "/combo?",
    combine: false,
    groups: {
        gallery: {
            base: "yui3-gallery/build/",
            root: "yui3-gallery/build/",
            comboBase: "/combo?",
            combine: false,
            patterns: {
                "gallery-": {},
                "gallerycss-": { type: "css" }
            }
        }
    }
}; 
```

现在一切正常！

# asp.net - 重定向到页面时是否可以不重新加载用户控件？

> ID：14967132
> 
> 赞同：0
> 
> 时间：2013-02-19T20:49:55.110
> 
> 标签：asp.net

我为侧边菜单导航创建了一个用户控件，当用户单击菜单上的一项时，它会显示公司和信息的详细信息。现在它使用传递参数（例如 company.aspx?ID=10）重定向到每个公司的不同页面，并且每次单击时，它都会刷新整个页面。我想保持侧面菜单用户控制而不刷新，因为有一个实时搜索选项。

这可能吗？还是我应该改变相反的方式来做到这一点？应该是页面中的侧边菜单和用户控件中的公司信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:11:16.230

我认为你在谈论的是部分页面更新，而不是发布和重新加载整个页面，你只重新加载它的一部分。

这是一篇好文章： [使用 ASP.NET AJAX 理解部分页面更新](http://www.asp.net/web-forms/tutorials/aspnet-ajax/understanding-partial-page-updates-with-asp-net-ajax)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T00:56:06.070

如果您想以正确的方式使用 Ajax，则需要更改整个站点结构。这是使用 jQuery 的一种快速而肮脏的方法。

```
<script>
    $(document).ready(function () {

        $("#left-pane a").click(function (e) {
            e.preventDefault();            
            loadUrl($(this).attr("href"));
        });
    });

    function loadUrl(url) {        
        $("#right-pane").load(url);
    }
</script> 
```

# c# - Why does this bundle not work?

> ID：14967136
> 
> 赞同：1
> 
> 时间：2013-02-19T20:50:15.040
> 
> 标签：c#, asp.net-mvc-4, bundling-and-minification

I have an mvc style bundle configured.

It has two css files to include. Here is the bundle in question:

```
bundles.Add(new StyleBundle("~/Content/css").Include("~/Content/site.css", "~/Content/jasmine.css")); 
```

There is literally no difference between these files.

Here is my usage of the bundle in my layout:

```
@Styles.Render("~/Content/css") 
```

Opening the chrome inspector I find this:

```
<link href="/Content/site.css" rel="stylesheet"> 
```

But no jasmine.css.

What is the problem ? Why isn't my file included ?

**EDIT**

Here is the screenshot of the folder :

![enter image description here](../Images/e087839f90a1c76f916a86f6cd7271f5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:25:23.007

我已经看到当文件丢失或我指定了错误的路径时会发生这种情况。验证路径`"~/Content/jasmine.css"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-14T07:47:38.217

您可以使用`.Include("~/ContentAddress")`要添加到捆绑包中的每个内容或脚本。

```
bundles.Add(new StyleBundle("~/Content/css")
.Include("~/Content/site.css")
.Include("~/Content/jasmine.css")); 
```

# symfony - symfony2.1 EventSubscriber接口错误

> ID：14967137
> 
> 赞同：0
> 
> 时间：2013-02-19T20:50:21.760
> 
> 标签：symfony, symfony-2.1

我刚刚按照[http://symfony.com/doc/current/cookbook/form/dynamic_form_modification.html](http://symfony.com/doc/current/cookbook/form/dynamic_form_modification.html)来信，以使我的文件上传字段仅显示在“新”表单上，而不是“编辑”表单上.

```
 $form->add($this->factory->createNamed('file', 'file', array('required' => true))); 
```

我在“新”表单上收到此错误，但“编辑”表单很好。这对有经验的人来说可能很明显，但这是我的第一个 SF 项目，我不确定为什么食谱教程会导致我出错。

```
The form's view data is expected to be an instance of class Symfony\Component\HttpFoundation\File\File, but is a(n) array. You can avoid this error by setting the "data_class" option to null or by adding a view transformer that transforms a(n) array to an instance of Symfony\Component\HttpFoundation\File\File. 
```

有人可以澄清这个问题吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:11:55.603

改变

```
$form->add($this->factory->createNamed('file', 'file', array('required' => true))); 
```

到

```
$form->add($this->factory->createNamed('file', 'file')); 
```

修复。

# google-app-engine - How to store videos on Google App Engine, without forms?

> ID：14967146
> 
> 赞同：0
> 
> 时间：2013-02-19T20:50:42.913
> 
> 标签：google-app-engine, video, store

Having recently stumbled across GAE, I understand that videos are usually uploaded using a form, and then stored as a blob.

Is there a way to do this without forms?

I want to use GAE as a back end for an android application, where videos from the android are uploaded to the GAE.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T20:53:49.487

只要您有任何方式将字节从移动客户端传输到服务器，就可以使用[Blobstore 写入 API](https://developers.google.com/appengine/docs/java/blobstore/overview#Writing_Files_to_the_Blobstore)将字节写入 Blobstore。

# php - Email filled PDF with PHP or PHPMailer

> ID：14967147
> 
> 赞同：1
> 
> 时间：2013-02-19T20:50:42.673
> 
> 标签：php, pdf, phpmailer, pdf-manipulation

My company is currently trying to streamline our process for submitting forms. I have read that what we are trying to do can be done with PHP or PHPMailer but I seem to have hit a roadblock.

What we are trying to do is open a fillable PDF in browser, complete it, and then click a button at the bottom to email it to a designated recipient.

I currently have a PHP script that allows me to email the blank document using PHPMailer and our server email service.

I have tried using the "AddStringAttachment" feature of PHPMailer:

```
<?php

require("../PHPMailer_5.2.3/class.phpmailer.php");

$mail = new PHPMailer();

$mail->IsSMTP();  // telling the class to use SMTP
$mail->Host     = "xxx.xxx.org"; // SMTP server

$mail->From     = "xxx@xxx.org";
$mail->AddAddress("xxx@xxx.org");

$mail->Subject  = "Attachment Test";
$mail->Body     = "Hi! \n\n This is my first e-mail sent through PHPMailer.";
$mail->WordWrap = 50;
$mail->AddStringAttachment($string,'filename.pdf');

if(!$mail->Send()) {
  echo 'Message was not sent.';
  echo 'Mailer error: ' . $mail->ErrorInfo;
} else {
  echo 'Message has been sent.';
}
?> 
```

...but I was unable to find a way to define the string in a way that would send the completed form. Currently, if I put any data into the "$string" field the email fails.

Is this even possible? Or am I just spinning my wheels?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:03:46.503

问题可能出在您的邮件服务器上。许多服务器不喜欢发送损坏的 PDF，这将是任何看起来不像普通 PDF 的 PDF - 例如，一串英文文本。

在我开始讨论如何在 PHP 中生成 PDF 之前，您是否可以发送任何其他类型的附件？

# php - PHP: Reading first character of exploded string in while loop. Empty characters causing issues

> ID：14967152
> 
> 赞同：0
> 
> 时间：2013-02-19T20:51:08.067
> 
> 标签：php

Probably a simple problem here, but I cannot find it.

I am exploding a string that was input and stored from a textarea. I use **nl2br()** so that I can explode the string by the `<br />` tag.

The string explodes properly, but when I try to get the first character of the string in a while loop, it only returns on the first line.

**Note:** The concept here is greentexting, so if you are familiar with that then you will see what I am trying to do. If you are not, I put a brief description below the code sample.

**Code:**

```
while($row = mysqli_fetch_array($r, MYSQLI_ASSOC)) {
$comment = nl2br($row['comment']);
$sepcomment = explode("<br />", $comment);
$countcomment = count($sepcomment);
$i = 0;

//BEGIN GREENTEXT COLORING LOOP
while($i < $countcomment) {

$fb = $sepcomment[$i];
$z = $fb[0]; // Check to see if first character is >

if ($z == ">") {
$tcolor = "#789922";
}
else {
$tcolor = "#000000";
}

echo '<font color="' . $tcolor . '">' . $sepcomment[$i] . '</font><br>';

$i++;
}
//END GREENTEXT COLORING LOOP

} 
```

**Greentext:** If the first character of the line is '>' then the color of that entire line becomes green. If not, then the color is black.

**Picture**: ![Picture of output](../Images/7ee4fd309a4d9e9e79dfd8e7d69dee99.png)

**What I have tried:**

1.  strip_tags() - Thinking that possibly the
    tags were acting as the first characters.
2.  `$fb = preg_replace("/(<br\s*\/?>\s*)+/", "", $sepcomment[$i]);`
3.  str_replace()
4.  echo $z //Shows the correct character on first line, blank on following lines.
5.  $z = substr($fb, 0, 1);

Here is a test I just did where I returned the first 5 characters of the string. ![first 5 characters](../Images/cad8d6b1d02bdbc6804dd5419fe2733e.png)

Any ideas for getting rid of those empty characters?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T20:54:45.263

尝试“修剪”功能

```
$fb = trim($sepcomment[$i]); 
```

[http://php.net/manual/en/function.trim.php](http://php.net/manual/en/function.trim.php)

（可能是换行符，标签后面有 \n\r 个字符）

# dll - Unable to Register .dll Windows 7 Professional x64

> ID：14967154
> 
> 赞同：1
> 
> 时间：2013-02-19T20:51:25.117
> 
> 标签：dll, windows-7-x64, regsvr32

I've run regsvr32 "name.dll" from system32 and SysWOW64 and both say it was able to load .dll but return error code 0X80004005 (access denied). I've tried running it in an elevated command prompt (right click, run as administrator) and that still returns the same error code. I've repaired the registry and restarted the computer, same error code. Any other suggestions?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T17:33:47.097

问题是它是一个 Visual Fox Pro .dll 并且在注册 .dll 之前必须将 VFP 运行时文件移动到 SysWOW64 文件夹中。

# mysql - Left join, sum and count group by

> ID：14967160
> 
> 赞同：17
> 
> 时间：2013-02-19T20:51:33.480
> 
> 标签：mysql, sql

I have 3 tables: goods, store and pics. In the first table goods titles are stored. In the second - balance of goods in different stocks, in the third - links to goods pictures. So goods has one-to-many connection with store and pics. Now, I need to get a list of goods with sum of stock rests and count of pictures by one query. I did it like this:

```
SELECT good.id, good.title, sum(store.rest) AS storerest, count(pics.id) AS picscount 
FROM goods 
LEFT JOIN store ON (goods.id = store.goodid) 
LEFT JOIN pics ON (goods.id = pics.goodid) 
GROUP BY goods.id` 
```

All seems ok while good has 0 or 1 picture. But when it has 2 - storerest doubles, and I can't understand why. What's wrong?

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-19T20:56:26.730

您的问题是，当您有两行（或更多）`store`行和两行（或更多）`pics`行时`goods`，您最终会得到所有行组合的乘积。

要解决此问题，请在加入之前进行聚合：

```
SELECT 
  good.id, 
  good.title, 
  IFNULL(s.storerest, 0) AS storerest, 
  IFNULL(p.picscount, 0) AS picscount
FROM goods 
LEFT JOIN (
  SELECT goodid, sum(rest) AS storerest
  FROM store
  GROUP BY goodid
) s ON (goods.id = s.goodid) 
LEFT JOIN (
  SELECT goodid, count(id) AS picscount
  FROM pics
  GROUP BY goodid
) p ON (goods.id = p.goodid) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T21:01:57.280

您正在将表“商品”与其他两个表连接在一起，其中这两个其他表与“商品”表具有一对多的关系。当它们加入时，将产生行组合 - 因此，如果有 2 张图片，则商店项目会列出两次。

如果您首先计算子表的统计信息，然后加入它们并在计算唯一项目时使用不同的计数，那么解决此问题的最简单方法，例如，您的查询应该是：

```
SELECT good.id, good.title, sum_rest AS storerest, count(distinct pics.id) AS picscount 
FROM goods 
LEFT JOIN (select goodid, sum(rest) as sum_rest from store) s ON (goods.id = s.goodid) 
LEFT JOIN pics ON (goods.id = pics.goodid) 
GROUP BY goods.id 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T20:58:07.133

首先考虑连接的大小。如果一个商品有两张图片，那么该商品的行数将是原来的两倍。实际上，行将被复制，但对于图片部分。因此，store.rest 的总和将拾取所有内容两次。使用三张图片，您将获得三倍的输出。

# c++ - 究竟是什么错误以及错误地调用可移动和不可复制成员的复制构造函数有什么解决方法

> ID：14967167
> 
> 赞同：2
> 
> 时间：2013-02-19T20:51:49.580
> 
> 标签：c++, visual-c++, c++11, compiler-errors, move-semantics

请考虑下面的代码，它在 VS2012 中编译但在 VS2010 中失败并出现错误

```
 1>------ Build started: Project: testconstinit, Configuration: Debug Win32 ------
1>  testconstinit.cpp
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\xmemory(48): error C2248: 'std::unique_ptr<_Ty>::unique_ptr' : cannot access private member declared in class 'std::unique_ptr<_Ty>'
1>          with
1>          [
1>              _Ty=int
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\memory(2347) : see declaration of 'std::unique_ptr<_Ty>::unique_ptr'
1>          with
1>          [
1>              _Ty=int
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\xmemory(197) : see reference to function template instantiation 'void std::_Construct<std::unique_ptr<_Ty>,const std::unique_ptr<_Ty>&>(_Ty1 *,_Ty2)' being compiled
1>          with
1>          [
1>              _Ty=int,
1>              _Ty1=std::unique_ptr<int>,
1>              _Ty2=const Movable &
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\xmemory(196) : while compiling class template member function 'void std::allocator<_Ty>::construct(std::unique_ptr<int> *,const _Ty &)'
1>          with
1>          [
1>              _Ty=Movable
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\vector(421) : see reference to class template instantiation 'std::allocator<_Ty>' being compiled
1>          with
1>          [
1>              _Ty=Movable
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\vector(481) : see reference to class template instantiation 'std::_Vector_val<_Ty,_Alloc>' being compiled
1>          with
1>          [
1>              _Ty=Movable,
1>              _Alloc=std::allocator<Movable>
1>          ]
1>          c:\users\zadirion\documents\visual studio 2010\projects\testconstinit\testconstinit\testconstinit.cpp(34) : see reference to class template instantiation 'std::vector<_Ty>' being compiled
1>          with
1>          [
1>              _Ty=Movable
1>          ]
1>          c:\users\zadirion\documents\visual studio 2010\projects\testconstinit\testconstinit\testconstinit.cpp(81) : see reference to class template instantiation 'LazyValue<T>' being compiled
1>          with
1>          [
1>              T=Container
1>          ]
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

编码：

```
#include "stdafx.h"
#include <vector>
#include <memory>
#include <functional>
#include <deque>

using namespace std;

typedef std::unique_ptr<int> Movable;
typedef vector<Movable> Container;

typedef vector<Movable> (*MakeType)();

template <class T, class Initializer = function<T(void)> >
struct LazyValue
{
  LazyValue(Initializer aInit) : mInit(aInit) {}

  void Init() const
  {
    m = mInit();
  }

private:

  mutable T m; // <-- compiler error at this line
  Initializer mInit;

  LazyValue operator=(const LazyValue & aOther)
  {

  }
};

template <class T>
struct GenericList
{
    std::deque<T> mValues;

    GenericList(){}

    GenericList & operator()(T && aValue)
    {
        mValues.push_back(std::move(aValue));
        return *this;
    }

    template <class Container>
    operator Container()
    {
        auto it = mValues.begin();
        auto endIt = mValues.end();

        Container c;

        for ( ; it != endIt; it++ )
        {
            c.push_back(std::move(*it));
        }
        return std::move(c);
    }
};

template <class T>
GenericList<T> ListOfRValues()
{
    return GenericList<T>();
}

int _tmain(int argc, _TCHAR* argv[])
{

  const LazyValue<Container> s = []()->Container{
      return ListOfRValues<Movable>()
        (Movable(new int) )
        (Movable(new int) )
        (Movable(new int) );
  };

  return 0;
} 
```

任何人都可以指出提交给微软的错误的链接，或者解释编译器错误实际上是什么，我试图了解代码的哪一部分到底是困扰编译器。另外，我们有什么解决方法？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T21:08:15.867

**此代码不应编译。**

问题在于您正在使用*copy-initialization*，这可能需要（如果编译器没有省略它）构造一个临时对象 type `LazyValue<Container>`，然后将其移动到初始化 object`s`中。

来自 C++11 标准的第 8.5/14 段：

> 表单中发生的初始化
> 
> T x = a;
> 
> 以及在参数传递、函数返回、抛出异常 (15.1)、处理异常 (15.3) 和聚合成员初始化 (8.5.1) 中称为*复制初始化*。[注意：复制初始化可能会调用移动（12.8）。——尾注]

此外，根据第 8.5/16 段：

> [...] 否则（即，对于剩余的**复制初始化**情况），**枚举**可以从源类型转换为目标类型或（当使用转换函数时）转换为其派生类的**用户定义转换序列****如 13.3.1.4 中所述，通过重载决议 (13.3) 选择最佳的**。如果转换无法完成或不明确，则初始化格式错误。以初始化表达式作为参数调用所选函数；**如果函数是构造函数，则调用初始化目标类型的 cv 非限定版本的临时版本**。临时是prvalue。**然后根据上述规则，调用的结果（对于构造函数的情况是临时的）用于直接初始化作为复制初始化目标的对象**。在某些情况下，**允许**实现通过将中间结果直接构造到正在初始化的对象中来消除这种直接初始化中固有的复制；见 12.2、12.8。

让我们暂时假设您的编译器*没有*忽略复制/移动（编译器是允许的，但不是必需的）。

您的类模板没有定义任何移动构造函数，并且隐式生成的复制构造函数将被选择用于`s`从初始化右侧的 lambda 构造的临时构造对象。

不幸的是，您的类有一个 type 的成员变量`Container`，它是*不可复制*元素的容器。因此，隐式生成的复制构造的实例化将失败，这解释了您遇到的错误。

您应该改用*直接初始化*：

```
const LazyValue<Container> s([]() -> Container {
  return ListOfRValues<Movable>()
    (Movable(new int) )
    (Movable(new int) )
    (Movable(new int) );
}); 
```

现在让我们考虑编译器*确实*选择省略复制/移动的情况。C++11 标准对此行为有要求，来自第 12.8/32 段：

> 当满足或将满足复制操作的省略标准时，除了源对象是函数参数，并且要复制的对象由左值指定之外，选择复制的构造函数的重载决策是首先执行好像对象是由右值指定的。如果重载决议失败，或者如果所选构造函数的第一个参数的类型不是对对象类型的右值引用（可能是 cv 限定的），则再次执行重载决议，将对象视为左值。[注意：**无论是否会发生复制省略，都必须执行此两阶段重载解析。它确定如果不执行省略则调用的构造函数，并且选择的构造函数必须是*可访问的*即使呼叫被省略。**——尾注]

这里的关键术语是*可访问*的。隐式生成的复制构造函数的实例化无法成功，因为要复制的对象包含不可复制的子对象；这必然使复制构造函数不可访问，因为它永远不能被实例化。因此，符合标准的编译器将拒绝编译代码，我相信这符合 VS2012 中的错误。

* * *

PS：另外，请注意您违反了所谓**[的三法则](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)**（除了有一个重载的复制赋值运算符不返回任何内容，而它可能应该返回`*this`）。

# php - 在不使用库的情况下从 php 中的 rest 调用获取 twilio 中的队列大小

> ID：14967169
> 
> 赞同：2
> 
> 时间：2013-02-19T20:51:57.147
> 
> 标签：php, rest, curl, yii, twilio

我的 php/Yii 应用程序与 twilio 交互。我知道队列的 sid。我想获取该队列的当前大小。问题是我不能使用 twilio php 库（我不想了解细节）。我正在使用 curl，但我不断收到 401 错误。

这是我的代码：

```
$curl = curl_init();
curl_setopt_array($curl,array(
    CURLOPT_RETURNTRANSFER => 1,
    CURLOPT_URL => 'https://api.twilio.com/2010-04-01/Accounts/AccountId/Queues/QUeueID.json',
    CURLOPT_USERPWD => 'token:{AuthToken}'));
curl_exec($curl); 
```

我不知道我做错了什么。我正在尝试遵循文档：

[http://www.twilio.com/docs/api/rest/queue](http://www.twilio.com/docs/api/rest/queue)

编辑：我把它变成了一个获取请求，来自一个发布请求。

另外，我收到了 401 未经授权的错误，而不是 411。对此感到抱歉。错字。

第二次编辑：

所以，我在与凯文的谈话中发现了这一点。原来我需要：

```
CURLOPT_USERPWD => 'AccountID:Token' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:21:13.300

如果您只是尝试检索队列的大小，则需要发出 GET 请求，而不是 POST。看起来您在 curl 请求中设置了 CURLOPT_POST 。

# jquery-autocomplete - JQuery-UI 复制粘贴问题在第二次尝试时有效

> ID：14967170
> 
> 赞同：1
> 
> 时间：2013-02-19T20:51:59.077
> 
> 标签：jquery-autocomplete

我们正在使用以下 JQuery 代码（在 JSF 中）来调用自动完成功能。当用户键入数据时，一切似乎都正常，但是当用户复制和粘贴时，自动完成将在第二次尝试时被调用。我正在 IE 8 中测试以下代码。感谢任何输入

```
<pre>
   <code>
      <script type="text/javascript">
$(function () { 
    $(document).on('keyup.autocomplete','##{resp.workItemResponse.wiResponseId}', function() {
        $('##{resp.workItemResponse.wiResponseId}').autocomplete({
            minLength: 3,
            source: function( request, response){
                $.ajax({
                    type: 'GET',
                    url: "/iaportal/autoCompleteServlet",
                    cache: false,
                    delay: 200,
                    data: {
                        'respId':'#{resp.workItemResponse.wiResponseId}',
                        'type': '#{autoCompleteType}',
                        'term':request.term
                    },
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function(data){
                        response($.map(data.acctNum, function (item) {
                            return {                                
                                label: item.label,
                                value: item.label
                            }
                        }));
                    },
                    error: function(message){
                        alert("error "+message);
                    }
                });
            },
            select: function( event, ui ) {
                var selectedObj = ui.item;
                var text = selectedObj.value;
                $('.autoComplete#{resp.workItemResponse.wiResponseId}').attr('value', text);
                $('.autoComplete#{resp.workItemResponse.wiResponseId}').trigger('change'); 
            }
        });
        $('##{resp.workItemResponse.wiResponseId}').keyup(function(){
            var text = this.value;
            if(text == '' || text.length == 0){
                $('.autoComplete#{resp.workItemResponse.wiResponseId}').attr('value', "");
                $('.autoComplete#{resp.workItemResponse.wiResponseId}').trigger('change');
            }
        });
    }); // on Ends

    var textElem;
    $(document).on('paste','##{resp.workItemResponse.wiResponseId}',function() {
        textElem = this;
        setTimeout(invokeOnPaste , 100); 
    });  

    function invokeOnPaste(){
        var text = $(textElem).val();
        if(text.length == 14){ 
            $('.autoComplete#{resp.workItemResponse.wiResponseId}').attr('value', text);
            $('.autoComplete#{resp.workItemResponse.wiResponseId}').trigger('change'); 
        } else if(text.length != 0){
            $('##{resp.workItemResponse.wiResponseId}').trigger('search','autocomplete');
        } 
    }
});
</script>
   </code>
</pre> 
```

# android - 为 Android 活动使用容器

> ID：14967174
> 
> 赞同：0
> 
> 时间：2013-02-19T20:52:08.450
> 
> 标签：android, slidingmenu

我想知道 Android 是否支持使用一些静态组件制作容器并将我的活动包含在其中的可能性。
我有一个带有一些 onClickListener 事件的滑动菜单，我不想为每个活动设置这些事件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:09:09.897

如果我对您的理解正确，您有一些活动共有的一些功能，并且您不想在所有活动中重复相同的代码。相反，您想在一个地方执行此操作。

实现这一点的一种方法是创建一个超类活动，将您的公共代码放在该活动中，然后将其与您的其他活动一起扩展。例如，

```
public class BaseActivity extends Activity implements OnClickListener {
private Button button;

@Override
public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.main);
  button = (Button) findViewById(R.id.my_button);
  button.setOnClickListener(this);
}

  ...

@Override
public void onClick(View view) {
   int id = view.getId();
   switch(id) {
     case R.id.my_button:
     // perform action
     break;
   }
} 
```

}

然后你将它扩展为

```
public class Activity1 extends BaseActivity {
  /...
}

public class Activity2 extends BaseActivity {
  /...
}

public class Activity3 extends BaseActivity {
  /...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T20:55:36.200

我不确定我是否理解您的问题，您能否再详细说明一下？甚至可能发布一些您当前正在使用的示例代码。

据我所知，您应该能够通过制作自己的 CustomActivity 来实现您想要的

```
public class CustomActivity extends Activity {
  //put your slidingmenu stuff here
} 
```

然后在您想要使用该共享部分的所有其他活动中执行以下操作：

```
public class AnotherActivity extends CustomActivity {
  //...
} 
```

用`extends CustomActivity`而不是通常的`extends Activity`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:33:20.793

这就是我解决问题的方法：

我做的第一件事是创建我的主类，它将托管公共代码。例如 ：

```
public abstract class main extends activity(){
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(getLayoutResourceId());
        // Your common code here
    }
    protected abstract int getLayoutResourceId();
} 
```

那么你需要做的就是在你的活动中扩展这个类：

```
public class HelloActivity extends main{
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        setContentView(R.layout.activity_hello);
        super.onCreate(savedInstanceState);
        //make sure to put setcontentview before super.oncreate
    }
    @Override
    protected int getLayoutResourceId() {
        return R.layout.activity_hello;
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-19T20:55:54.387

所有活动都需要在 Manifest 中注册。对于常见的东西，例如幻灯片菜单，您可以使用 Fragment 作为幻灯片菜单。

# jquery - jQuery在提交表单之前将选择字段值与数组进行比较

> ID：14967176
> 
> 赞同：0
> 
> 时间：2013-02-19T20:52:16.833
> 
> 标签：jquery, arrays, if-statement, validation, multi-select

我是 jQuery 的新手，但这就是我想要做的。

我有一个名为 City 和 Zip 的多选字段的表单，

我正在尝试获取此选择字段的值并将其与我拥有的城市列表进行比较，如果发现任何匹配项，jQuery 将使用这些值更新名为 city 的隐藏文本字段的值，然后提交表单。如果没有找到匹配项，他们将被重定向到不同的网站。

与邮政编码相同，它将从同一字段中获取邮政编码，并查看它是否与列表中的任何邮政编码匹配。如果是，则更新邮政编码隐藏字段，如果不是，则将它们重定向到另一个网站。

这是我现在的代码，它不工作。

```
$("#front-form").submit(function(event) {
 // Getting the values from the HTML select field
 var CityandZip = $("#citynzip").val();

 //Comparing the values with the cities list
 if (CityandZip === "City 1" || "City 2" || "City 3") {
    //Updaing the hidden field and submitting
    $("#HiddenCityField").val(CityandZip);
 //Comparing the values with the ZIP code list
 } else if (CityandZip === "11111" || "11112" || "11113") {
    //Updating the hidden ZIP code field
    $("#HiddenZipField").val(CityandZip);

 } else {
    //Redircting to a new site
    window.location.href = "http://www. redirecttowebsite.com"; 

 }

 }); 
```

任何帮助将不胜感激，并在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:38:19.333

我检查了这一点。我只为城市检查而不是邮政编码检查这样做，但它只是在现有实现的基础上构建。

```
$(function () {
    var arrCities = [ "Philadelphia", "Pittsburgh", "NYC" ];
    $("#front-form").submit(function (event) {
        $("#citynzip :selected").each(function (i, selected) {
            if ($.inArray($(selected).text().trim(), arrCities) > -1) {
                $("#HiddenCityField").val($(selected).text());
            }
            else {
                window.location.href = "http://www. redirecttowebsite.com";
            }
        });
    });
}); 
```

回顾我所做的。首先，我有基本的城市数组。我只是在这里扔了一些。然后我像你一样附加到表单提交事件。然后我使用我的 jquery 选择器来选择 citynzip 元素的所有被选择的元素，并对每个被选择的元素执行[.each()](http://api.jquery.com/jQuery.each/ "。每个（）")。该条件使用 jquery 的[.inArray()](http://api.jquery.com/jQuery.inArray/ ".inArray()")函数检查所选项目是否在数组中，以检查所选项目是否在要比较的基本数组 arrCities 中。如果是，请将其添加到隐藏字段。

如果选择不在数组中，我不知道您想如何处理。现在看起来如果任何选择不在数组中，即使有些是，您希望页面重定向并且仅当用户所做的所有选择都存在于数组中时才继续。这应该提供一个起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:40:10.983

这就是我让它工作的方式，在代码下面将选择输入字段与数组进行比较，然后将值分配给隐藏字段。

```
$(function () {
var arrCities = [ "City 1", "City 2", "City 3" ];

var arrZip = [ "11111", "22222", "33333" ];

$("#front-form").submit(function (event) {
        $("#citynzip :selected").each(function (i, selected) {
            if ($.inArray($(selected).val(), arrCities) > -1) {
                $(selected).each(function(i, selected) {
                    $("#front-form").append("<input type='hidden' name='City[]' id='City' value='" + $(selected).val() + "' />")
                });
            } else if ($.inArray($(selected).val(), arrZip) > -1) {
                $(selected).each(function(i, selected) {
                    $("#front-form").append("<input type='hidden' name='Zip[]' id='Zip' value='" + $(selected).val() + "' />")
                });
            } else {
                event.preventDefault();
                window.location.href = "http://www.website.com/"
            }
        });
    });
}); 
```

感谢这里的每个人，通过一些研究，我能够弄清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T20:56:21.503

```
$("#HiddenCityField").val() = CityandZip; 
```

那是行不通的。你需要做：

```
$("#HiddenCityField").val(CityandZip); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T20:55:06.353

你有一个错字

```
window.location.herf 
```

此外，您的 OR 应如下所示：

```
if (CityandZip === "City 1" || CityandZip === "City 2" || CityandZip === "City 3") 
```

最后，您将值应用于 HiddenZipField 的方式也不正确。val() 函数将您希望设置的值作为参数，例如`val(CityAndZip)`

# google-chrome - 使用 Silverlight 时 Chrome 中的“Aw Snap”消息

> ID：14967178
> 
> 赞同：1
> 
> 时间：2013-02-19T20:52:23.723
> 
> 标签：google-chrome, silverlight-5.0

执行以下操作时，我在 Chrome 中始终收到“Aw Snap”消息：

1.  加载显示 Silverlight 渲染的页面
2.  单击一个按钮，该按钮会触发一个包含 iFrame 的 fancybox，该 iFrame 包含相同的 Silverlight 渲染
3.  关闭花式框
4.  收到可怕的“Aw Snap”消息
5.  重新加载页面并再次加载页面

笔记：

*   这在 IE 中不会发生
*   这在 Firefox 中不会发生
*   当我去**chrome://crashes/**没有崩溃的记录

* * *

铬版本：24.0.1312.57

Silverlight 版本：Silverlight 5 (5.1.10411.0)

* * *

通过谷歌的 Chrome 问题板搜索几乎没有结果，任何报告的类似问题要么已经存在多年，要么没有得到回应。希望有人遇到同样的问题并有解决方法。

# c++ - 类析构函数

> ID：14967180
> 
> 赞同：-1
> 
> 时间：2013-02-19T20:52:31.290
> 
> 标签：c++, class, destructor

在一个类中，如果我像下面这样声明一个析构函数和一个运算符，那么就会调用一个析构函数。例如

```
#include <iostream>
using namespace std;

class CRectangle {
    int width, height;
  public:
    static int n;
    CRectangle (int,int);
    ~CRectangle ();
    int area () {return (width * height);}
    CRectangle operator + (CRectangle);
};
CRectangle CRectangle::operator+ (CRectangle param){
    x+=param.x;
    y+=param.y;
}
CRectangle::CRectangle (int a, int b) {
  width = a;
  height = b;
  n++;
}

CRectangle::~CRectangle () {
    n--;
}
CRectangle::n=0;
int main () {
  CRectangle rect (3,4), rectb (5,6);
  cout << "rect area: " << rect.area() << endl;
  cout << "rectb area: " << rectb.area() << endl;
  rect=rect+rectb;
  return 0;
} 
```

为什么在我执行操作时会调用析构函数 +?? 程序终止后 n 的最终值变为-1....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:57:22.210

析构函数就像一个普通的 void 函数，你可以在技术上做任何你想做的事情。这包括修改即将被销毁的成员变量（毫无意义）。通常，您使用此函数来清理动态分配的内存或释放对象持有的资源。

当对象超出范围时，通常会为您调用析构函数。将对象的宽度和高度强制为 0 会使区域为 0，但无论如何您都无法调用`area()`它。它已经消失了。

**更新：**

在看到更多代码后，我明白为什么您的最终值`n`是错误的。您缺少一个复制构造函数。如果您不提供它，编译器会为您生成一个，并且它不知道要递增`n`。你的`operator+`看起来也不正确（复制和粘贴错误？），但我只能假设那里的某个地方正在进行一些复制，否则它不会编译。尝试添加这个：

```
CRectangle::CRectangle(const CRectangle &rhs) : width(rhs.width), height(rhs.height)
{
    ++n;
} 
```

这是[三法则的](https://stackoverflow.com/q/4172722/46821)经典例子。需要复制构造函数、赋值或析构函数的类通常需要这三个。如果你使用的是 C++11，它就变成了[三、四或五](https://stackoverflow.com/q/4782757/46821)的规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:03:12.423

```
width=height=0; 
```

这会将`width`and的值设置`height`为 0，但在析构函数完成后就没用了，因为您不应该再使用该对象或尝试访问其内部变量。也许您可以在析构函数的其他地方使用这些变量，但我不确定您要做什么，但基于示例。你为什么要尝试这个或者你想要解决的“真正”问题是什么并不明显。

如果您稍后需要这些值，请使用析构函数设置的一些全局变量。然后每个对象的析构函数都会改变全局变量。

您可以设置变量值，但在析构函数完成后，您无论如何都不应该使用它们，因此这个示例几乎没有实际用途。

# xml - xsl 用于一个 xml 中的多个 xml 行，使用分组和键

> ID：14967181
> 
> 赞同：0
> 
> 时间：2013-02-19T20:52:33.170
> 
> 标签：xml, xslt, key, grouping

请有人协助创建密钥以便使用 xsl 正确分组 xml 文件？使用收到的 xml，我需要能够将数据带入我的 ERP 系统，从而为每个新供应商以及每个目标仓库创建一个新的采购订单。换句话说，从下面我需要为 LIY0001 创建并转到 A4 的采购订单（这必须包括与供应商和仓库相关的所有行）。同样，需要为 WOR0001 创建一个新的采购订单到 A4，另一个为 WOR0001 创建一个到 A5（同样与这两个键相关的所有行都转到必要的采购订单分组）。对于下面的示例，应该创建 3 个单独的采购订单。

这是xml的示例：

```
<rows>
<row>
<SUPPLIER>LIY0001</SUPPLIER>
<DESTWHS>A4</DESTWHS>
<RELEASE_DATE>2013-02-14</RELEASE_DATE>
<DUE_DATE>2013-05-13</DUE_DATE>
<ITEM>5021616</ITEM>
<QTY>528</QTY>
<LINE_ITEM_NO>1</LINE_ITEM_NO>
<CUST_PO_NO>LIY0001-2013-02-14</CUST_PO_NO>
<PURCHASEPRICE>5.25</PURCHASEPRICE>
</row>
<row>
<SUPPLIER>LIY0001</SUPPLIER>
<DESTWHS>A4</DESTWHS>
<RELEASE_DATE>2013-02-14</RELEASE_DATE>
<DUE_DATE>2013-05-13</DUE_DATE>
<ITEM>5021816</ITEM>
<QTY>222</QTY>
<LINE_ITEM_NO>2</LINE_ITEM_NO>
<CUST_PO_NO>LIY0001-2013-02-14</CUST_PO_NO>
<PURCHASEPRICE>5.90</PURCHASEPRICE>
</row>
<row>
<SUPPLIER>WOR0001</SUPPLIER>
<DESTWHS>A4</DESTWHS>
<RELEASE_DATE>2013-02-14</RELEASE_DATE>
<DUE_DATE>2013-05-13</DUE_DATE>
<ITEM>650616</ITEM>
<QTY>129</QTY>
<LINE_ITEM_NO>9</LINE_ITEM_NO>
<CUST_PO_NO>WOR0001-2013-02-14</CUST_PO_NO>
<PURCHASEPRICE>4.46</PURCHASEPRICE>
</row>
<row>
<row>
<SUPPLIER>WOR0001</SUPPLIER>
<DESTWHS>A5</DESTWHS>
<RELEASE_DATE>2013-02-14</RELEASE_DATE>
<DUE_DATE>2013-05-13</DUE_DATE>
<ITEM>650610</ITEM>
<QTY>129</QTY>
<LINE_ITEM_NO>1</LINE_ITEM_NO>
<CUST_PO_NO>WOR0001-2013-02-14</CUST_PO_NO>
<PURCHASEPRICE>3.5</PURCHASEPRICE>
</row>
<row>
</rows> 
```

这是我创建的翻译文件：

```
<?xml version="1.0" ?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
<xsl:output method="xml" encoding="Windows-1252" omit-xml-declaration="yes" />
<xsl:template match="/">
<PostPurchaseOrders>
    <Orders>
      <OrderHeader> 
      <xsl:for-each select = "rows/row">
      <CustomerPoNumber><xsl:value-of select="CUST_PO_NO"/></CustomerPoNumber> 
      <Supplier><xsl:value-of select="SUPPLIER"/></Supplier>
          <OrderDate><xsl:value-of select="RELEASE_DATE"/></OrderDate>
          <DueDate><xsl:value-of select="DUE_DATE"/></DueDate>
         <Warehouse><xsl:value-of select="DESTWHS"/></Warehouse>
     </xsl:for-each>
     </OrderHeader> 
      <OrderDetails>
     <xsl:for-each select = "rows/row">
       <StockLine>
         <PurchaseOrderLine><xsl:value-of select="LINE_ITEM_NO"/></PurchaseOrderLine>
            <StockCode><xsl:value-of select="ITEM"/></StockCode>
            <Warehouse><xsl:value-of select="DESTWHS"/></Warehouse>
           <OrderQty><xsl:value-of select="QTY"/></OrderQty>
           <Price><xsl:value-of select="PURCHASEPRICE"/></Price>
          </StockLine>
         </xsl:for-each>
       </OrderDetails>       
       </Orders>
<PostPurchaseOrders>
</xsl:template>
</xsl:stylesheet> 
```

这是我需要为我们的 ERP 系统转换为 xml 的内容：

```
<PostPurchaseOrder>
<Orders>
    <OrderHeader>
        <Supplier>LIY0001</Supplier>
        <CustomerPoNumber>example po</CustomerPoNumber>
        <OrderDate>2013-02-03</OrderDate>
        <Warehouse>A1</Warehouse>
    </OrderHeader>
    <OrderDetails>
        <StockLine>
            <PurchaseOrderLine>1</PurchaseOrderLine>
            <StockCode>12022</StockCode>
            <OrderQty>10</OrderQty>
        </StockLine>
        <StockLine>
            <PurchaseOrderLine>2</PurchaseOrderLine>
            <StockCode>15014</StockCode>
            <OrderQty>15</OrderQty>
        </StockLine>
    </OrderDetails>
</Orders>
</PostPurchaseOrders> 
```

任何关于如何将我的翻译文件更改为 2 个键的分组以便为每个供应商以及每个目标仓库将多行带入一个采购订单的帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:30:11.593

您的 XSLT 和示例输出之间存在一些不一致，因此我将模拟示例输出。这应该实现您正在寻找的分组：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>
  <xsl:key name="kOrder" match="row" use="concat(SUPPLIER, '+', DESTWHS)"/>

  <xsl:template match="/*">
    <PostPurchaseOrder>
      <xsl:apply-templates
        select="row[generate-id() = 
                    generate-id(key('kOrder', concat(SUPPLIER, '+', DESTWHS))[1])]"
        mode="group"/>
    </PostPurchaseOrder>
  </xsl:template>

  <xsl:template match="row" mode="group">
    <OrderHeader>
      <Supplier>
        <xsl:value-of select="SUPPLIER" />
      </Supplier>
      <CustomerPoNumber>
        <xsl:value-of select="CUST_PO_NO" />
      </CustomerPoNumber>
      <OrderDate>
        <xsl:value-of select="RELEASE_DATE" />
      </OrderDate>
      <Warehouse>
        <xsl:value-of select="DESTWHS" />
      </Warehouse>
    </OrderHeader>
    <OrderDetails>
      <xsl:apply-templates select="key('kOrder', concat(SUPPLIER, '+', DESTWHS))" />
    </OrderDetails>
  </xsl:template>

  <xsl:template match="row">
    <StockLine>
      <PurchaseOrderLine>
        <xsl:value-of select="LINE_ITEM_NO" />
      </PurchaseOrderLine>
      <StockCode>
        <xsl:value-of select="ITEM" />
      </StockCode>
      <OrderQty>
        <xsl:value-of select="QTY" />
      </OrderQty>
    </StockLine>
  </xsl:template>

</xsl:stylesheet> 
```

在您的示例输入上运行时，这会产生：

```
<PostPurchaseOrder>
  <OrderHeader>
    <Supplier>LIY0001</Supplier>
    <CustomerPoNumber>LIY0001-2013-02-14</CustomerPoNumber>
    <OrderDate>2013-02-14</OrderDate>
    <Warehouse>A4</Warehouse>
  </OrderHeader>
  <OrderDetails>
    <StockLine>
      <PurchaseOrderLine>1</PurchaseOrderLine>
      <StockCode>5021616</StockCode>
      <OrderQty>528</OrderQty>
    </StockLine>
    <StockLine>
      <PurchaseOrderLine>2</PurchaseOrderLine>
      <StockCode>5021816</StockCode>
      <OrderQty>222</OrderQty>
    </StockLine>
  </OrderDetails>
  <OrderHeader>
    <Supplier>WOR0001</Supplier>
    <CustomerPoNumber>WOR0001-2013-02-14</CustomerPoNumber>
    <OrderDate>2013-02-14</OrderDate>
    <Warehouse>A4</Warehouse>
  </OrderHeader>
  <OrderDetails>
    <StockLine>
      <PurchaseOrderLine>9</PurchaseOrderLine>
      <StockCode>650616</StockCode>
      <OrderQty>129</OrderQty>
    </StockLine>
  </OrderDetails>
  <OrderHeader>
    <Supplier>WOR0001</Supplier>
    <CustomerPoNumber>WOR0001-2013-02-14</CustomerPoNumber>
    <OrderDate>2013-02-14</OrderDate>
    <Warehouse>A5</Warehouse>
  </OrderHeader>
  <OrderDetails>
    <StockLine>
      <PurchaseOrderLine>1</PurchaseOrderLine>
      <StockCode>650610</StockCode>
      <OrderQty>129</OrderQty>
    </StockLine>
  </OrderDetails>
</PostPurchaseOrder> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:42:06.453

您可以使用 XSLT 2.0 实现此目的，如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:fn="http://www.w3.org/2005/xpath-functions" exclude-result-prefixes="xs fn">
    <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>

    <xsl:template match="rows">
        <PostPurchaseOrder>
            <!-- Generate Orders with OrderHeader -->
            <xsl:for-each-group select="row" group-by="SUPPLIER">
                <Orders>
                    <OrderHeader>
                        <Supplier><xsl:value-of select="SUPPLIER" /></Supplier>
                        <CustomerPoNumber><xsl:value-of select="CUST_PO_NO" /></CustomerPoNumber>
                        <OrderDate><xsl:value-of select="RELEASE_DATE" /></OrderDate>
                        <Warehouse><xsl:value-of select="DESTWHS" /></Warehouse>
                    </OrderHeader>
                    <!-- Generate OrderDetails -->
                    <OrderDetails>
                        <!-- Generate StockLine -->
                        <xsl:for-each select="current-group()">
                            <StockLine>
                                <PurchaseOrderLine><xsl:value-of select="LINE_ITEM_NO" /></PurchaseOrderLine>
                                <StockCode><xsl:value-of select="ITEM" /></StockCode>
                                <OrderQty><xsl:value-of select="QTY" /></OrderQty>
                            </StockLine>
                        </xsl:for-each>
                    </OrderDetails>
                </Orders>
            </xsl:for-each-group>
        </PostPurchaseOrder>
    </xsl:template>
</xsl:stylesheet> 
```

# jquery - 设置“动态”变量时遇到问题

> ID：14967184
> 
> 赞同：0
> 
> 时间：2013-02-19T20:52:50.867
> 
> 标签：jquery, variables

我想动态设置变量名称，我一直在尝试：

```
var iframes = $('iframe').filter(function (index) {
                return index == 0 || $(this).attr("current") == "no";
              })
        if(iframes.length >0){ //if one of the iframes hasnt got current set as current, use it
            var theSuffix = iframes.attr('id').split('_').pop();
            window['thisPreview'+theSuffix] = $fi.prev(".image-preview");
            $hidden.closest(".file-upload-form").find(".variable-hidden").attr('value',theSuffix);
        } 
```

我想要一个名为“thisPreview”的变量，然后是一个数字，这将是匹配的 div 的 id，或变量“theSuffix”（变量也需要是全局的）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:55:37.090

不要使变量末尾有共同的前缀和数字。只需使用一个对象：

```
var thisPreview = {};

...

thisPreview[theSuffix] = $fi.prev(".image-preview"); 
```

# php - 移动新 html 页面的渲染元素

> ID：14967186
> 
> 赞同：1
> 
> 时间：2013-02-19T20:53:00.470
> 
> 标签：php, javascript, jquery, ajax

我有一个 Javascript 函数，我在用户可以单击列表元素的页面上呈现，它会将他们带到一个新页面，显示有关该列表元素的更多信息。原始页面是#index，第二个页面是#index2，它是使用一个多页HTML 页面编码的。但是我希望我可以将 index2 页面移动到它自己的 html 文件 - index2.html 但我不确定如何在函数中引用新的 index.html 文件，以便元素可以移动到新文件。

我的代码如下：

```
 <script type="text/javascript">
    $(document).on('pagebeforeshow', '#index', function(){
        $("#list").empty();
        var url="http://localhost/tmp/json4.php";
        $.getJSON(url,function(json){
            //loop through deals
            $.each(json.deals,function(i,dat){
                $("#list").append("<li><a id='"+dat.dealid+"' data-restaurantid=" + dat.restaurantid + " data-image=" + dat.image + "><h1>"+dat.name+"</h1><h6>"+dat.dname+"</h6><h5>"+dat.description+"</h5></a></li>");
                $(document).on('click', '#'+dat.dealid, function(event){  
                    if(event.handled !== true) 
                    {
                        dealObject.dealID = $(this).attr('id'); 
                        dealObject.restaurantid = $(this).attr('data-restaurantid');
                        dealObject.shortName = $(this).find('h1').html(); 
                        dealObject.image = $(this).attr('data-image');
                        dealObject.dealName = $(this).find('h6').html();
                        dealObject.description = $(this).find('h5').html(); 

                        $.mobile.changePage( "#index2", { transition: "slide"} );
                        event.handled = true;
                    }
                });            
            });
            $("#list").listview('refresh');
        });
    });

    $(document).on('pagebeforeshow', '#index2', function(){       
        $('#index2 [data-role="content"]').find('#deal-img').attr('src',dealObject.dealObject);
        $('#index2 [data-role="content"]').find('#title').html(dealObject.name);
                $('#index2 [data-role="content"]').find('input#desc').val(dealObject.description);
                $('#index2 [data-role="content"]').find('input#tname').val(dealObject.dealName);
                $('#index2 [data-role="content"]').find('input#dealid').val(dealObject.dealID);

    });

    var dealObject = {
        dealID : null,
        restaurantid : null,
        shortName : null,
        image : null,
        dealName : null,
        description: null
    }    
</script> 
```

如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T14:38:29.590

您需要将页面分成两个 php 文件，一个称为 view.php，第二个称为 offer.php。

创建 2 个附加目录，一个名为 amend，第二个名为 del。它们都将有一个 js 文件，其中包含与修改或删除功能相关的逻辑以及一个 php 文件，该文件将作为所需功能的 php/ajax 代理服务器。

还要注意您的 2 个 ajax 调用必须查看正确的位置，并且 ajax 响应也必须声明女巫操作已经完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T20:59:03.567

我的猜测是您需要向服务器发出 Ajax 请求以获取 index2.html，因为它不再与 index1.html 位于同一页面上。这是一个例子

```
$.ajax({
   url : '/pages/index2.html',
   type: 'get',
   success: function (html) {
     // here , you can use jquery to manipulate
     // the HTML in index2\. Maybe pop up a lightbox, etc..
   }
}); 
```

我不确定您要做什么，但 Ajax 是一种在幕后请求新 HTML / 数据的相当标准的方式。使用 JQuery ajax 可以做很多事情。这是文档

[jQuery 阿贾克斯](http://api.jquery.com/jQuery.ajax/)

# itext - iText 矩形 - 无法删除边框

> ID：14967188
> 
> 赞同：3
> 
> 时间：2013-02-19T20:53:04.417
> 
> 标签：itext

我似乎无法删除矩形上的边框！请参阅下面的代码，我正在使用 PDFannotation 创建一个链接。链接都有效，但每个矩形都有一个边框。

```
PdfAnnotation annotation;
Rectangle rect = new Rectangle(xOffset, yOffset, xOffset + tab.getScaledWidth(),      yOffset+tab.getScaledHeight());

rect.setBorder(Rectangle.NO_BORDER);

annotation = PdfAnnotation.createLink(writer, rect, PdfAnnotation.HIGHLIGHT_NONE,      PdfAction.gotoLocalPage(section.GetStartPageIndex() + 1,destination, writer));

stamper.addAnnotation(annotation,i); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T21:07:18.450

我已经意识到这是有边框的注释，删除使用

```
annotation.setBorder(new PdfBorderArray(0f, 0f, 0f)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-27T00:24:42.863

Or you can use:

```
annotation.BorderStyle = new PdfBorderDictionary(0f, 0); 
```

# actionscript-3 - 使用代码创建符号并将图像从库附加到符号

> ID：14967189
> 
> 赞同：0
> 
> 时间：2013-02-19T20:53:06.850
> 
> 标签：actionscript-3, flash-cs6

我为库中的图像分配了一个 bgMountain 类。我如何（以编程方式）创建一个新符号，并将该图像附加到新创建的符号上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:10:56.293

```
[Embed(source="path_to_hero.png")] //or .jpeg
public class Hero extends Bitmap {
  public function Hero(){

  }
}

public class Main extends Sprite(){
  public function Main():void {
    var hero:Hero = new Hero() ;
    hero.x = 50 ;
    hero.y = 50 ;
    stage.addChild(hero) ;
  }
} 
```

Here is the [tutorial](http://blog.framethrower.de/content/how-embed-assets-fonts-images-or-sounds-compile-time-your-as3-swf)

Also, [using SWF library](http://summitprojectsflashblog.wordpress.com/2008/04/11/creating-instances-of-library-items-from-loaded-swfs/)

# perl - Perl - 增强代码以递归计算文件

> ID：14967190
> 
> 赞同：2
> 
> 时间：2013-02-19T20:53:09.043
> 
> 标签：perl

我是 Perl 的新手，正在尝试学习这门语言，但在做一些我认为可能很简单的事情时遇到了困难。

我已经能够使脚本正常工作，该脚本将仅计算目录中的文件数。我想增强脚本以递归计算任何子目录中的所有文件。我已经搜索并找到了一些用于 GLOB 和 File::Find 的不同选项，但无法让它们工作。

我当前的代码：

```
#!/usr/bin/perl
use strict;
use warnings;

use Path::Class;

# Set variables

my $count = 0;  # Set count to start at 0
my $dir = dir('p:'); # p/

# Iterate over the content of p:pepid content db/pepid ed
while (my $file = $dir->next) {   

    next if $file->is_dir();    # See if it is a directory and skip

    print $file->stringify . "\n";   # Print out the file name and path
    $count++   # increment count by 1 for every file counted

}

print "Number of files counted " . $count . "\n"; 
```

任何人都可以帮助我增强此代码以递归搜索任何子目录吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:05:04.753

[File::Find](http://perldoc.perl.org/File/Find.html)模块是递归操作的朋友。这是一个计算文件的简单脚本：

```
#!/usr/bin/perl
use strict;
use warnings;
use Cwd;
use File::Find;

my $dir = getcwd; # Get the current working directory

my $counter = 0;
find(\&wanted, $dir);
print "Found $counter files at and below $dir\n";

sub wanted {
    -f && $counter++; # Only count files
} 
```

# javascript - 如何在切换框中捕获 div 的 id

> ID：14967197
> 
> 赞同：0
> 
> 时间：2013-02-19T20:53:37.703
> 
> 标签：javascript, html, jquery

我正在使用 jQuery 切换功能来创建一个包含三个项目的框。当用户选择其中一个选项时，该框应在页面底部的总框中显示该选项的价格，并在选中框的内容区域中添加与复选框相关的成本。我正在尝试以 php 表单执行此操作，该表单具有从该站点修改的切换框：

```
<div class="toggle-box">
  <div id="opt1" class="toggle-title">"Snorkel and Serve" Trek in the Florida Keys ($395).</div>
  <div class="toggle-content">
    <input id="opt1_1" name="opt1_1" type="checkbox" value="0- I will arrive to campus by 8:00 a.m. on June 25, 2013 ready for departure for the Florida Keys." />
    <label id="opt1_1_label" for="opt1_1" class="normal">I will arrive to campus by 8:00 a.m. on June 25, 2013 ready for departure for the Florida Keys. (No Additional Cost)</label><br /><br />
  </div>
  <div id="opt2" class="toggle-title">Toggle 2</div>
  <div class="toggle-content">
    <p>Ut orci lorem, malesuada sed rhoncus quis, dignissim eget erat. Sed accumsan lorem sed libero posuere vitae blandit mi varius. Vestibulum eu dui leo, eget molestie quam. Integer non velit arcu, non tempor nulla.</p>
  </div>
  <div id="opt3" class="toggle-title">Toggle 3</div>
  <div class="toggle-content">
    <p>Ut orci lorem, malesuada sed rhoncus quis, dignissim eget erat. Sed accumsan lorem sed libero posuere vitae blandit mi varius. Vestibulum eu dui leo, eget molestie quam. Integer non velit arcu, non tempor nulla.</p>
  </div>
<div> 
```

选择标题时，如何捕获所选标题框的 id？

我将 id 用于以下计算函数：

```
$(document).ready(function(){
    $(".toggle-content").hide();
    $(".toggle-title").click(function(){
        $(this).next(".toggle-content").slideToggle("normal");
        $("#optionselected").val($(this).prop("id"));
        $("#toggle-box input[type='checkbox']").prop("checked", false);
        calculate( );
    });
});
$("#toggle-title div").click(function() {
    console.log("click function");
    $("#optionselected").val($(this).prop("id"));
    $("#toggle-box input[type='checkbox']").prop("checked", false);
    calculate();
});
function calculate() {
    console.log("balance : " + balance.value);
    var subtotal = 0;
    var optid = $("#optionselected").val();
    var opt1_baseprice = new String($("#opt1").text());
    var opt2_baseprice = new String($("#opt2").text());
    var opt3_baseprice = new String($("#opt3").text());
    opt1_baseprice = opt1_baseprice.substr($("#opt1").text().indexOf("$") + 1, 3);
    opt2_baseprice = opt2_baseprice.substr($("#opt2").text().indexOf("$") + 1, 3);
    opt3_baseprice = opt3_baseprice.substr($("#opt3").text().indexOf("$") + 1, 3);
    opt1_baseprice = parseFloat(opt1_baseprice);
    opt2_baseprice = parseFloat(opt2_baseprice);
    opt3_baseprice = parseFloat(opt3_baseprice);
    subtotal += (optid == "opt1") ? opt1_baseprice : 0;
    subtotal += (optid == "opt2") ? opt2_baseprice : 0;
    subtotal += (optid == "opt3") ? opt3_baseprice : 0;
    $("#toggle-box input[type='checkbox']").each(function(i) {
        subtotal += ($(this).prop("checked")) ? parseFloat($(this).val()) : 0;
    });
    $("#balance").val((($("#needbased").val() == "Yes") ? (subtotal - 50) : 0).toFixed(2));
    subtotal = ($("#needbased").val() == "Yes") ? 50 : subtotal;
    $("#amount").val(subtotal.toFixed(2));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T15:27:54.407

我不确定我是否完全理解你的问题 - 这是你想要做的吗？

> 选择标题后，如何捕获所选标题框的 id。

当一个标题被选中时，你可以`ID`使用 jQuery 获取当前选中标题的`$(this)`

```
$(".toggle-title").click(function(){
    var ID = $(this).attr("id");
    alert(ID);
}); 
```

# asp.net-mvc - 将分组的 linq 对象传递给查看

> ID：14967201
> 
> 赞同：3
> 
> 时间：2013-02-19T20:53:47.697
> 
> 标签：asp.net-mvc, linq, razor

我试图将 linq 列表对象从我的控制器传递到我的视图。linq 对象包含一个引发某种错误的分组。我只想在视图中显示分组的对象。linq 语句完美运行，但显示语句却不行！任何帮助将不胜感激！

控制器

```
 public ViewResult StudentAttendanceForYear(int id)
    {

        DateTime finDate = System.DateTime.Today;
        DateTime strtDate = DateTime.Today.AddMonths(-6);

        var chosenStudent = (from t in db.ClassInstanceDetails.Include("Student")
                                 where (t.Attendance == false) && (t.StudentID == id)
                                 && (t.ClassInstance.Date > strtDate) && (t.ClassInstance.Date < finDate)
                                 group t by new { t.ClassInstance.Date.Year, t.ClassInstance.Date.Month, t.ClassInstance.Date.Day } into grp
                                 select new
                                 {

                                     absentDate = grp.Key,
                                     numAbsences = grp.Count(t => t.Attendance == false)

                                 }).ToList();

        return View(chosenStudent.ToList());
    } 
```

看法

我试着改变我的看法

```
@model IEnumerable<System.Linq.IGrouping<object, FYPSchoolApp.DAL.ClassInstanceDetail>> 
```

但仍然没有运气，我不断收到以下错误：

传入字典的模型项的类型为“System.Collections.Generic.List `1[<>f__AnonymousType7`2[<>f__AnonymousType6 `3[System.Int32,System.Int32,System.Int32],System.Int32]]', but this dictionary requires a model item of type 'System.Collections.Generic.IEnumerable`1[System.Linq.IGrouping`2[System.Object,FYPSchoolApp.DAL.ClassInstanceDetail]]”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:02:57.777

不要尝试将匿名类型作为模型传递到视图中。

你需要的是一个 ViewModel：

```
public class AbsentCountViewModel
{
   public DateTime absentDate { get; set; }
   public int numAbsences { get; set; }
} 
```

然后更改您的查询以选择到您的视图模型中

```
var chosenStudent = 
   (from t in ...
   group t by new 
   { 
           t.ClassInstance.Date.Year, 
           t.ClassInstance.Date.Month, 
           t.ClassInstance.Date.Day 
   } into grp
   select new
   {
       absentDate = grp.Key,
       numAbsences = grp.Count(t => t.Attendance == false)
   }).ToList()
   // you need to do the select in two steps 
   // because EF cannot translate the new DateTime
   .Select(item => new AbsenctCountViewModel
   {
       absentDate = new DateTime(item.absentDate.Year, 
                                 item.absentDate.Month, 
                                 item.absentDate.Day)
       numAbsences = item.numAbsences
   }).ToList();

return View(chosenStudent); 
```

最后，您可以使用@model 在视图中访问您的结果：

```
@model List<AbsenctCountViewModel> 
```

# jquery - 始终选择“选择”下拉菜单的第一个选项

> ID：14967210
> 
> 赞同：1
> 
> 时间：2013-02-19T20:54:09.607
> 
> 标签：jquery, drop-down-menu, jquery-selectors

我的一些下拉菜单有问题。我正在使用 jQuery 1.8.2 和 jQm 1.1.0。

基本上，我有 PHP 生成我的下拉列表，虽然我将“selected='selected'”设置为仅占位符，但生成的下拉列表总是突出显示第一个选项。我曾尝试使用“multiple='multiple'”，但这不起作用，因为我使用的是 onchange='this.form.submit()'，并且不会通过多选下拉菜单激活。

```
<form action="" method="post" data-ajax="false" id="adminForm" onkeypress="return event.keyCode != 13;">
<select name="adminEvent" id="adminEvent" data-native-menu="false" tabindex="-1" onchange="this.form.submit()">
    <option value="" selected="selected" id="placeholder" data-placeholder="true">Events</option>
        <?php 
            while($index = mysql_fetch_row($eventAdminList)) {
                echo "<option value=\"" . $index[0] . "\" id=\"" . $index[0] . "\">" . $index[0] . "</option>";
            }
        ?>
</select>
</form> 
```

请帮助解决这个问题，我不确定为什么会这样！

谢谢！

# git - 推送整个项目，而不仅仅是使用 ftploy 进行更改

> ID：14967223
> 
> 赞同：3
> 
> 时间：2013-02-19T20:55:13.123
> 
> 标签：git, ftp, bitbucket

我正在尝试使用[ftploy](http://ftploy.com)服务将 git repo 从[bitbucket](https://bitbucket.org/)部署到我的 ftp 托管帐户。它工作正常，但它只部署已更改的文件。有什么方法可以让我部署完整的项目。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T21:04:14.640

我通过删除 ftploy 中的项目，再次创建它，这次勾选“部署”按钮，让它工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-06T03:40:41.307

谢谢你的提示。对我来说，它甚至没有开始部署更改的文件，直到我删除并重新创建了项目并勾选了部署按钮。令人困惑的东西。

# silverlight - Windows Phone 7 按钮上的 TextWrapping

> ID：14967234
> 
> 赞同：1
> 
> 时间：2013-02-19T20:55:53.437
> 
> 标签：silverlight, windows-phone-7, xaml

我在尝试将文本包裹在 Windows Phone 按钮上时遇到问题。问题是文本被截断了！我几乎尝试了所有方法，但问题仍然存在。我已经搜索了这个问题，但我还没有找到有效的解决方案。

这是我的代码：

```
 <Button Height="127" HorizontalAlignment="Left" Margin="12,548,0,0" Name="button1" VerticalAlignment="Top" Width="224" Click="button1_Click" Foreground="#FFEBF362" FontFamily="Segoe WP" BorderBrush="#FFEDF0F1" Background="#FF1BA1E2" >
        <Button.Content>
            <TextBlock Text="Button" TextWrapping="Wrap" Height="84"  TextAlignment="Center" VerticalAlignment="Stretch" HorizontalAlignment="Center" Padding="0" FontSize="36" Width="186" FontFamily="Segoe WP" />
        </Button.Content>
    </Button> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T00:53:34.663

您可以使用 ContentTemplate，而不是像您一样设置内容：

```
<Button Name="button1" Content="Hello Cakes">
    <Button.ContentTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding}" TextWrapping="Wrap"/>
        </DataTemplate>
    </Button.ContentTemplate>
</Button> 
```

`button1.Content`如果您想从代码中设置，这将起作用。此外，您可以将 DataTemplate 提取到资源中并在按钮之间重用它。

这也是更好的做法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T21:32:40.117

我尝试了代码，它似乎可以工作，你有没有机会将按钮嵌套在一个大小受限的元素中？您还设置了一些大小，因此使用字体大小和字体系列可以看到多少文本会有一些限制。使用文本 'Button Button Button Button' 只有两个第一个按钮将显示，第二个在新行上，具有相同的字体和字体大小（当我尝试代码时 - 我只将其中一个边距从 499 更改为 99屏幕截图）

![在此处输入图像描述](../Images/2249970475f18408ceea74c9738d55a7.png)

也许如果您分享更多代码，我们可以帮助您找到罪魁祸首，但请检查大小、边距和元素。很容易错过一些东西！

# php - 摘要记录

> ID：14967236
> 
> 赞同：0
> 
> 时间：2013-02-19T20:55:56.037
> 
> 标签：php, constructor, abstract

我正在尝试创建自动机制，该机制将使用抽象类将数据从数据库加载到对象中，该抽象类将在必要时进行扩展。

这是我的简化想法，目前不起作用，所以如果有人能解释我为什么以及我做错了什么：

抽象类：

```
abstract class abstractRecord{

    public $data = array();

    public function __constructor($id = null){
        global $db; // eg. PDO
        $this->db = $db;

        if(!is_null($id) && intval($id) > 0)
            $this->fillData($id);

    }

    public function fillData($id){

        $this->data = $db->getAll("SELECT * FROM ".self::$table." WHERE ".self::$id."='$id'");

    }

} 
```

现在一些将扩展abstratRecord的类，如果提供了有效的ID，则应该在启动时使用抽象的构造函数来填充数据

```
class User extends abstractRecord{

    public static $id = "`id`";
    public static $table = "`users`";

    // some other functions for controlling user...

} 
```

并在最后使用

```
$user = new User(15);  // so user data from db with id=15 should be loaded into object data property by abstractRecord class 
```

所以这只是简单的版本，应该有更多的验证，getter setter 接口....

现在只想知道这里出了什么问题以及为什么，是否可以在不调用 parent::__constructor() 的情况下使用此流程，据我所知，在这种情况下类应该扩展抽象 __constructor，或者我错了?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:02:24.817

您的抽象类的构造方法拼写错误。需要`__construct()`。然后您需要在扩展类中调用该构造函数，如下所示：

```
class User extends abstractRecord{
    public function __construct() {
        // call to abstractRecore construct
        parent::__construct();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T00:35:30.963

好的，我设法解决了问题并建立了工作机制，所以它看起来像这样：

抽象类 abstractRecord{

```
protected $data = array();
public static $table;
public static $pK;

public function __construct($id = null, $table = false, $pK = false){

if($table == false || $pK == false)
    return false;

self::$table = $table;
self::$pK = $pK;

if (!is_null($id) && intval($id) > 0)
        $this->fillData($id);

}

protected function fillData($id){
    global $db; // db solution

    $this->data = $db->("SELECT * FROM ".self::$table." WHERE ".self::$pK."='$id' LIMIT 1");

}

// some other useful functions 
```

}

一些类

类用户扩展 abstractRecord{

```
public static $table =  " `users` ";
public static $pK = " `userID` ";

public function __construct($id = null){

    parent::__construct($id, self::$table, self::$pK);
}

// some other functions ... 
```

}

对不起，如果有什么拼写错误...

感谢您的帮助！

# ruby-on-rails - 我可以在没有 Capistrano 的情况下使用 Rails When gem 吗？

> ID：14967237
> 
> 赞同：4
> 
> 时间：2013-02-19T20:55:57.933
> 
> 标签：ruby-on-rails, capistrano, whenever

我有一个在 Amazon 的 Elastic Beanstalk 上托管的 Rails 应用程序。我想使用[Whenever gem](https://github.com/javan/whenever)来安排任务，但是Whenever gem 文档和[这个Railscast](http://railscasts.com/episodes/164-cron-in-ruby-revised)都提到了与Capistrano 的集成。我没有使用 Capistrano 来管理我的服务器，所以我不确定它是否会扰乱我的服务器现在的运行方式，如果我安装它只是为了使用时。

也许问我问题的另一种方式是在 Capistrano 的 deploy.rb 文件中包含此命令有什么作用，如果我不使用 Capistrano，是否有替代方法：

```
set :whenever_command, "bundle exec whenever"
require "whenever/capistrano" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-03T21:32:46.080

[我在Whenever gem Google Group 中](https://groups.google.com/forum/?fromgroups=#!searchin/whenever-gem/%22whenever%2420-i%22/whenever-gem/sW5ppMpQlZ0/4CetvBIfEaUJ)阅读了这个帖子，发现您可以在没有 Capistrano 的情况下使用Whenever，但这意味着您需要手动触发 Crontab 而不是 Capistrano 触发更改。为此，请在您的服务器上使用此命令：

`whenever -i`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:01:27.413

根据文档，不，您不必使用 Capistrano。

每当 Capistrano 执行以下操作时，它会注册几个挂钩，以便在部署期间的任何任务时运行

```
Capistrano::Configuration.instance(:must_exist).load do
  # Write the new cron jobs near the end.
  before "deploy:finalize_update", "whenever:update_crontab"
  # If anything goes wrong, undo.
  after "deploy:rollback", "whenever:update_crontab"
end 
```

# php - Paypal Ipn 取消撤销

> ID：14967249
> 
> 赞同：4
> 
> 时间：2013-02-19T20:56:36.523
> 
> 标签：php, paypal-ipn, payment-processing

我试图在这里和 x.com 上搜索我的问题，但找不到任何东西，然后我想问一下。

问题是 Canceled_Reversal 状态。

1.  当我得到这个状态时，我如何检查我们是赢了还是输了？因为我发现这意味着赢/输

2.  当我得到这个状态之后会有一个完整的状态吗？

**我认为我应该做什么**

我需要它是因为我需要查明该成员是输了争议还是我们赢了。因为那时用户不应该有权访问用户获胜的内容，但如果我们获胜，他仍然可以访问

**我现在如何使用它 ** if(Compelete) aspaid if(Pending) as waiting if($payment_status == "Voided" || $payment_status == "Expired") as Rejected if($payment_status == "Reversed" || $payment_status == "已退款" || $payment_status == "Canceled_Reversal") 已退款

1.  但是当我有一个待处理的时候，贝宝会在正确的之后完成吗？

**如果您有任何建议，我想听听**

**希望有人可以在这里帮助我:)**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-01-21T23:48:54.033

我也许能够解释原始问题中的发现以及 user4416494 运行的实验。

关键是要了解 PayPal 费用是一个固定金额加上购买价格的百分比。退款后，客户将获得全额*退款*。但 PayPal 始终保留费用。这意味着商家实际上是赔钱的。他们失去了完整的原始购买价格（因为该价格已返还给客户）并且他们必须提供 PayPal 保留的费用。

因此，例如，如果我向一个组织捐款 5.00 美元，然后该组织将这 5.00 美元退还给我，我将获得全部 5.00 美元。但该组织甚至没有出来。他们实际上失去了 PayPal 为交易保留的费用。（我在 PayPal 文档中没有找到此详细信息，但我已通过我自己的 IPN 进行了验证。）

Canceled-Reversal 看似尴尬的使用——即使是因为商家输掉的争议——是 PayPal 如何“简化”这种费用处理的方式。

考虑购买 5.00 美元。如果 PayPal 收取 2.2% + 30 美分，那么商家将获得 4.59 美元的报酬，而 PayPal 则保留 41 美分。

（请参阅以下堆栈溢出问题以及 PayPal 提供的示例消息： [PayPal IPN Example: Completed, Reversed, Canceled_Reversed 和 Refunded](https://stackoverflow.com/questions/31451449/paypal-ipn-example-completed-reversed-canceled-reversed-and-refunded)）

商户获胜的争议顺序是这样的（原购买：$5.00）：

*   已完成：4.59 美元
*   反转：-4.59 美元
*   取消反转：4.59
*   **总和：4.59 美元**

因此，当一切都说完了，商家帐户最终会得到如果从未提出争议他们将收到的金额：4.59 美元。

以下是商家因纠纷败诉而以 5.00 美元购买的顺序：

*   已完成：4.59 美元
*   逆转：-4.59 美元
*   Canceled_Reversal：4.59 美元
*   退款：-5.00 美元
*   **总和：-0.41**

所以你可以看到客户拿回了所有的钱，而商家赔钱来支付 PayPal 保留的费用。

*   如果客户赢得争议，他们将获得全额退款。
*   商家支付全额退款的费用，包括 PayPal 保留的费用。
*   PayPal 不会同时向客户发出撤销和退款。这意味着商家将被收取两次费用，而客户将获得两倍的原始购买价格。
*   所以“逆转”可以看作是暂时的。 *它将以一种或另一种方式被取消*。
*   如果商家获胜，则取消逆转，这就是结束。
*   但如果发生争议，客户获胜，则撤销撤销，**并由**全额退款取代。
*   这就是 PayPal 实际确保账面余额的方式（请参阅 EJP 答案末尾附近的 EJP 评论）。

编辑这是一个更详细的答复，其中包括费用。（这些数字来自[此](https://stackoverflow.com/questions/31451449/paypal-ipn-example-completed-reversed-canceled-reversed-and-refunded)Stack Overflow 页面上报告的 IPN。）

商户胜诉：

```
Status            mc_gross  mc_fee 
==================================      
Completed             5.00    0.45 
Reversed             -4.55   -0.45 
Canceled_Reversal     4.55    0.45
===================================
SUM                   5.00    0.45 
```

客户赢得的争议：

```
Status            mc_gross  mc_fee 
==================================      
Completed             5.00    0.45 
Reversed             -4.55   -0.45 
Canceled_Reversal     4.55    0.45
Refunded             -5.00   -0.15 
===================================
SUM                      0    0.30 
```

有趣的是，这表明 PayPal 只保留固定部分的退款费用，而不是按购买价格的百分比计算的部分费用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T23:49:45.073

撤销意味着 Paypal 撤销了交易。他们有钱。Canceled_reversal 表示他们取消了冲销。你有钱。你赢了官司。

> 因为我发现这意味着赢/输

我不知道你从哪里得到这个想法。来自 IPN 指南：

> Canceled_Reversal：已取消冲销。例如，您赢得了与客户的纠纷，而被撤销的交易的资金已退还给您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-03T13:55:04.887

我今天测试了这个。我收到的欺诈撤销案件的 IPN payment_status 如下：

已完成（购买时） 已
撤销（关于“欺诈”争议）

卖家赢了：
Canceled_Reversal

买家赢得：
Canceled_Reversal Reversed

# jquery - jQuery更改占位符文本颜色

> ID：14967250
> 
> 赞同：27
> 
> 时间：2013-02-19T20:56:40.323
> 
> 标签：jquery, input, colors, placeholder

是否可以在 jQuery 中使用“::-webkit-input-placeholder”来设置占位符文本的颜色？

像这样的东西：

```
$("input::-webkit-input-placeholder").css({"color" : "#b2cde0"}); 
```

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2013-02-19T21:00:08.830

您不能真正使用 JavaScript 修改伪选择器。您必须修改现有的 a[`<style>`元素](https://stackoverflow.com/questions/311052/setting-css-pseudo-class-rules-from-javascript)。

如果可能的话，做一个类：

```
.your-class::-webkit-input-placeholder {
    color: #b2cde0
} 
```

并将其添加到元素中：

```
 $('input').addClass('your-class'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-07-16T16:16:12.160

如果您**没有样式表**，并且想要**动态**注入 CSS ，您可以使用以下内容：

```
$('body').append('<style>.my_class::placeholder{color:red}</style>') 
```

只需使用**my_class**和占位符的**颜色。**

有一个通用功能很方便：

```
function change_placeholder_color(target_class, color_choice) {
    $("body").append("<style>" + target_class + "::placeholder{color:" +  color_choice + "}</style>")
} 
```

**用法**：

```
change_placeholder_color('.my_input', 'red') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-22T02:42:51.370

只需添加这个。它将继承 input[type=text]:focus new color 中的颜色

```
.your-class ::placeholder{ color: inherit;} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-24T21:54:42.563

这是一个使用 jQuery 动态设置伪元素样式的示例——它是创建一个`<style>`元素，将其文本内容设置为所需的样式声明，并将其附加到文档的问题。

这是一个简单的单页示例：

```
<!doctype html>                                                                                                                                                                 
<html>
    <head>
        <title>Dynamic Pseudo-element Styles</title>
        <script src="https://code.jquery.com/jquery-3.2.1.js"></script>
        <script> 
$(document).ready(function() {                      
    createStyles();
    $('#slider-font-size').on('change', createStyles);

    function createStyles() {
        // remove previous styles
        $('#ph-styles').remove();

        // create a new <style> element, set its ID
        var $style = $('<style>').attr('id', 'ph-styles');

        // get the value of the font-size control
        var fontSize = parseInt($('#slider-font-size').val(), 10);

        // create the style string: it's the text node
        // of our <style> element
        $style.text(
            '::placeholder { ' +
                'font-family: "Times New Roman", serif;' +
                'font-size: ' + fontSize + 'px;' +
            '}');

        // append it to the <head> of our document
        $style.appendTo('head');
    }   
});     
        </script>
    </head>      

    <body>       
        <form>
            <!-- uses the ::placeholder pseudo-element style in modern Chrome/Firefox -->   
            <input type="text" placeholder="Placeholder text..."><br>

            <!-- add a bit of dynamism: set the placeholder font size -->
            <input id="slider-font-size" type="range" min="10" max="24">
        </form>
    </body>      
</html> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-06-28T10:31:52.883

我正在使用 MaterializeCSS；我使用 Jquery 为这样的输入字段更新 CSS

```
 $(".input-field").css("color", themeColor);
  $(".input-field>.material-icons").css("color", themeColor);
  $(".input-field>label").css("color", themeColor); 
```

查看结果：

[https://codepen.io/hiteshsahu/pen/EXoPRq?editors=1000](https://codepen.io/hiteshsahu/pen/EXoPRq?editors=1000)

# java - 字符串的子字符串部分

> ID：14967261
> 
> 赞同：0
> 
> 时间：2013-02-19T20:57:19.807
> 
> 标签：java, android, string

首先，我想原谅这个问题是否已经讨论过，如果你指出我已经回答的问题，我会很高兴！我找不到可以帮助我的人。

我必须只提取这样一个字符串中最后一个“/”之后的最后一部分：/test/test2/test3

我只需要提取“test3”。但我自己无法解决，所以我请求你的帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-19T20:58:49.330

您只需要找到 的[最后一个索引](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#lastIndexOf%28int%29) `/`，然后在之后获取[子字符串](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#substring%28int%29)：

```
int lastIndex = text.lastIndexOf('/');
String lastPart = text.substring(lastIndex + 1); 
```

（当然存在其他选项 - 正则表达式和拆分`/`例如......但以上是我要做的。）

请注意，因为我们必须使用`+ 1`过去的 last `/`，所以即使*没有*任何斜线，它仍然可以工作的方便属性：

```
String text = "no slashes here";
int lastIndex = text.lastIndexOf('/'); // Returns -1
String lastPart = text.substring(lastIndex + 1); // x.substring(0).equals(x) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-19T20:58:35.297

使用[**String#lastIndexOf()**](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#lastIndexOf%28java.lang.String%29)

```
"/test/test2/test3".substring("/test/test2/test3".lastIndexOf("/")+1) 
```

还假设它是一个文件路径。你也可以使用[**File#getname()**](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#getName%28%29)

```
File f = new File("/test/test2/test3");
System.out.println(f.getName()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T23:05:23.333

如果您还需要隔离字符串的其他部分，这将是最简单的方法。

```
String s="a/b/c"; //Works also for "a b c" and "a/b/c/"
String[] parts=s.split("/");
System.out.println(parts[parts.length-1]); 
```

# jquery - AJAX 和 Javascript：程序在提交表单时离开主页

> ID：14967262
> 
> 赞同：0
> 
> 时间：2013-02-19T20:57:19.377
> 
> 标签：jquery, ajax, jquery-validate

我只是在学习 AJAX，所以请耐心等待。我正在编写一个使用 AJAX 的小程序，该程序使用 HTML/Javascript 文件和 PHP 文件在数据库中添加和检索信息。我已经尝试了几次再现，但没有任何运气让页面留在主页上，只是用指示错误或成功的消息重置表单。PHP 文件是使用 mysqli 设置的，以处理文本字段和文件的提交，然后回显该消息。我使用 JQuery Cookbook 作为我最新版本的指南，但主页仍然离开并在浏览器中打开 PHP 文件，这当然是空白的。但是，它正在向数据库中添加一个新行，所以至少这是有效的。

我正在使用 PHPStorm 和 Firebug。关于我的代码为什么不起作用的任何想法？

```
<!DOCTYPE html>
<html>
<head>
    <script src="jquery.min.js"></script>
    <script src="jquery.validate.js"></script>
    <script>
        $('addForm').validate();
        $('addForm').submit(function(event){
            event.preventDefault();

            $('input[name="usingAJAX"]', this).val('true');
            var $this=$(this);
            var url=$this.prop('action');
            var dataToSend = $this.serialize();
            var callback = function(dataReceived) {
                $this.hide();
                //result message
                $('body').append(dataReceived)
            };
            var typeOfDataToReceive = 'html';
            $.get(url, dataToSend, callback, typeOfDataToReceive)
        });
    </script>
</head>
<body>
    <form id="addForm" action="addActorInfo.php" enctype="multipart/form-data">
        <input type="hidden" name="usingAJAX" value="false"/>
        <label for="aname">Actor Name: </label>
        <input type="text" name="aname" id="aname" class=required/>
        <br>
        <br>
        <label for="aimage">Actor Photo: </label>
        <input id="aimage" type="file" name="aimage" class="required">
        <br>
        <br>
        <input type="submit" value="ADD"/>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:41:02.853

几个问题。

*   正如每个人都指出的那样，您的表单选择器`$('addForm')`缺少。`#`

*   您缺少该`$(document).ready()`功能，因为在`form`调用 JavaScript 时您的功能尚不存在，这是必需的。

*   您不需要其他`submit`处理程序，因为 jQuery Validate 插件具有内置 的[`submitHandler`回调函数。](http://docs.jquery.com/Plugins/Validation/validate#toptions)[根据文档](http://docs.jquery.com/Plugins/Validation/validate#toptions)，*“验证后通过 Ajax 提交表单的正确位置。”*

像这样的东西：

（假设OP的`.ajax`功能已经正确。）

```
<script src="jquery.min.js"></script>
<script src="jquery.validate.js"></script>
<script>
$(document).ready(function() {
    $('#addForm').validate({
        //other options,
        submitHandler: function (form) {

            // your ajax code

            return false;  // <-- stop form redirection since you used ajax
        }
    });
});
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:47:55.323

有几个问题，大多数已经在评论中讨论过：

*   设置“提交”处理程序时的选择器错误。应该是`$('#addForm')`

*   您正在尝试使用`$.get()`来处理包含“文件”`<input>`元素的表单。那是做不到的。

要上传文件，您可以：

1.  发布您的表单（必须是 POST，而不是 GET）并为其提供`<iframe>`页面上隐藏元素的“目标”属性。来自服务器的响应应该包括 JavaScript 以适当地更新父页面（上面有表单的页面）。

2.  使用 HTML5 File API 获取文件内容，然后通过 XHR 上传。我从来没有尝试过这样做，但这[是一个较旧的 SO question about it](https://stackoverflow.com/questions/12515494)。

# rspec2 - 为什么我的测试失败

> ID：14967265
> 
> 赞同：0
> 
> 时间：2013-02-19T20:57:32.057
> 
> 标签：rspec2

模型/question_spec.rb

```
context "title" do
 subject { Question.new(title: 'is it valid question ?') }

  it { should be_valid }
end 
```

模型/问题.rb

```
validates :title , presence: true , :length => { :minimum   => 15, :maximum   => 160 }
validates_length_of :body, :minimum => 250 
```

结果

```
Question title 
 Failure/Error: it { should be_valid }
 expected valid? to return true, got false 
```

为什么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T10:04:19.173

测试失败，因为`Question` `body`设置为零。要接受 nil 和可数性验证，我们必须使用`allow_nil: true`. 所以最终的验证声明将是

```
validates_length_of :body, :minimum => 250, :allow_nil => true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:00:17.010

第一：切换最小值和最大值。

第二：你没有为这个问题指定一个正文。

# matlab - 将向量视为其索引上的函数/将此函数应用于另一个向量（索引）

> ID：14967269
> 
> 赞同：0
> 
> 时间：2013-02-19T20:57:41.977
> 
> 标签：matlab

设`y=[4;6;2;9;5;1]`为列向量，设`i=[4,2,1]`为索引向量。我想以某种方式“应用” i 到 y 并获得`[9,6,4]`. 或者至少`[4;2;0;9;0;0]`。

显然有一种方法可以使用 for 循环来做到这一点。这个网站上有人建议我不要在 MATLAB 中使用 for 循环。我可以在这里使用一些逻辑运算符吗？理想情况下，可以将 y 视为其索引上的函数，并将 y 作为函数应用于*i*。这可能吗，还是我应该使用旧的可靠 for 循环？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:01:04.760

简单的：

```
y(i) 
```

返回你的结果`[9 6 4]`。

要将不属于索引列表的所有元素设置为零，您可以复制指定的元素：

```
out = zeros(size(y));
out(i) = y(i); 
```

# jquery - 滑块下一个按钮问题

> ID：14967270
> 
> 赞同：0
> 
> 时间：2013-02-19T20:57:46.040
> 
> 标签：jquery, slider

我有一个简单的滑块，我想在其中添加“下一个”按钮，它将带我进入下一张幻灯片。一旦用户到达最后一张幻灯片，我还需要做的是返回第一张幻灯片。

到目前为止，我所拥有的是：

```
jQuery('#next_test').click(function(e){

showSlide = 0;

slidesLength = jQuery('#page-slider .slides-image img').length;
active_slide = jQuery('#page-slider .slides-image img:first');

next = showSlide+1;
showSlide = next;

jQuery('#page-slider .slides-image img').eq(showSlide).fadeIn(700);

return false
}); 
```

滑块的构建方式是我可以通过提供其编号 (showSlide) 来显示幻灯片。所以我试图将初始数字设置为 0，这将是第一张幻灯片，然后，每次用户点击时，它都会将他带到下一张幻灯片，即下一个数字。最后，它将再次从第一个数字开始。

上面的代码增加了目标幻灯片的数量，但只增加了一次。我该怎么做？是否需要 foreach 循环？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T09:24:24.857

该解决方案需要获取活动幻灯片及其索引。然后通过将幻灯片索引增加一，按钮将转到下一张幻灯片。由于第一张幻灯片的索引为 0，因此必须创建条件语句以确保幻灯片索引不大于幻灯片的数量并防止其到达不存在的幻灯片。

jQuery('.slides-image').click(function(e){ var active_slide = jQuery('#page-slider .slides-image img:visible');
var active_index = active_slide.index(); var showSlide = 0 ;

```
 var slidesLength = jQuery('#page-slider .slides-image img').length;

    var showSlide = active_index+1;
    if(showSlide > slidesLength-1){
        showSlide = 0;
    }
    jQuery('#page-slider .slides-nav a').eq(showSlide).addClass('active');
    jQuery('#page-slider .slides-nav a').eq(showSlide-1).removeClass('active');
    jQuery('#page-slider .slides-image img').eq(showSlide).fadeIn(700);
    jQuery('#page-slider .slides-image img').eq(showSlide-1).hide();

return false
}); 
```

# python - 我有我的应用程序的“授权码”。但是如何使用 gdata-python-client 在博客中发帖呢？

> ID：14967274
> 
> 赞同：4
> 
> 时间：2013-02-19T20:57:58.427
> 
> 标签：python, oauth-2.0, blogger, gdata-api, gdata-python-client

我正在使用 gdata-pyton-client。我有我的应用程序的“授权码”。但现在呢？如何使用它在博客中发帖？

我使用了以下代码并获得了授权码，

> ```
> CLIENT_ID = 'my-client-id'
> CLIENT_SECRET = 'my-secret'
> 
> SCOPES = ['https://www.googleapis.com/auth/blogger']  
> USER_AGENT = 'my-app'
> 
> token = gdata.gauth.OAuth2Token(
>                                 client_id=CLIENT_ID, client_secret=CLIENT_SECRET, scope=' '.join(SCOPES),
>                                 user_agent=USER_AGENT)
> 
> print token.generate_authorize_url(redirect_url='urn:ietf:wg:oauth:2.0:oob')
> print token.get_access_token(TOKEN-THAT-I-GOT-FROM-ABOVE-URL) 
> ```

但现在我该如何使用它？

我如何授权博主将其发布给博主？我一直在使用此示例进行测试： [https ://code.google.com/p/gdata-python-client/source/browse/samples/blogger/BloggerExampleV1.py](https://code.google.com/p/gdata-python-client/source/browse/samples/blogger/BloggerExampleV1.py)

但这是使用电子邮件和密码登录。如何使用访问令牌？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:58:09.610

请参阅[此文档页面](https://code.google.com/p/gdata-python-client/wiki/HTTPRequestRefactoring)，指导您如何使用您的令牌，尤其是最后的示例：

```
# Find a token to set the Authorization header as the request is being made
token = self.token_store.find_token(url)
# Tell the token to perform the request using the http_client object
# By default, the http_client is an instance of atom.http.HttpClient which uses httplib to         make requests
token.perform_request(self.http_client, 'GET', url, data=None, headers) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T10:08:49.743

您可以尝试以下解决方案。

请确保所有以下导入都在那里。

```
from apiclient.discovery import build
from oauth2client.file import Storage
from oauth2client.client import AccessTokenRefreshError
from oauth2client.client import flow_from_clientsecrets
from oauth2client.tools import run 
```

像这样设置你的 client_secrets.JSON

像这样设置 client_secrets.json

```
{
  "web": {
    "client_id": "[[INSERT CLIENT ID HERE]]",
    "client_secret": "[[INSERT CLIENT SECRET HERE]]",
    "redirect_uris": [],
    "auth_uri": "https://accounts.google.com/o/oauth2/auth",
    "token_uri": "https://accounts.google.com/o/oauth2/token"
  }
} 
```

为了将来参考，您可以将凭据存储在文件`blogger.dat`中以便更快地处理

```
FLOW = flow_from_clientsecrets(Path_to_client_secrets.json,scope='https://www.googleapis.com/auth/blogger',message=MISSING_CLIENT_SECRETS_MESSAGE)

storage = Storage('blogger.dat')
credentials = storage.get()
if credentials is None or credentials.invalid:
    credentials = run(FLOW, storage) 
```

一旦凭据都设置好了。是时候发帖了！因此我们创建了一个 httplib2.Http 对象来处理我们的 HTTP 请求并使用我们良好的凭据对其进行授权。

```
http = httplib2.Http()
http = credentials.authorize(http)

service = build("blogger", "v2", http=http) 
```

完成后，我们构建博客正文并发布

```
try:
    body = {
        "kind": "blogger#post",
        "id": "6814573853229626501",
        "title": "posted via python",
        "content":"<div>hello world test</div>"
        }

    request = service.posts().insert(your_blogId_ID,body)

    response = request.execute()
    print response

  except AccessTokenRefreshError:
    print ("The credentials have been revoked or expired, please re-run the application to re-authorize") 
```

希望这可以帮助。

# c - CFString 内存泄漏

> ID：14967275
> 
> 赞同：2
> 
> 时间：2013-02-19T20:58:01.290
> 
> 标签：c, memory-leaks, core-foundation

我已将内存泄漏范围缩小到以下代码

```
CFStringRef CFDataToString(CFDataRef data)
{
    UInt8* buf = malloc(CFDataGetLength(data));

    CFDataGetBytes(data, CFRangeMake(0, CFDataGetLength(data)), buf);

    CFMutableStringRef output = CFStringCreateMutable(kCFAllocatorDefault, CFDataGetLength(data) * 2);

    for(int i = 0; i < CFDataGetLength(data); i++) {
        CFStringAppendFormat(output, NULL, CFSTR("%02x"), buf[i]);
    }

    free(buf);
    CFRelease(data);

    return output;
} 
```

下面是上下文中使用的代码，为了演示，已经简化了一些方法。Instruments 报告**CFStringCreateMutable**和**CFStringAppendFormat**的内存泄漏。

```
CFStringRef CFDataToString(CFDataRef data)
{
    UInt8* buf = malloc(CFDataGetLength(data));

    CFDataGetBytes(data, CFRangeMake(0, CFDataGetLength(data)), buf);

    CFMutableStringRef output = CFStringCreateMutable(kCFAllocatorDefault, CFDataGetLength(data) * 2);

    for(int i = 0; i < CFDataGetLength(data); i++) {
        CFStringAppendFormat(output, NULL, CFSTR("%02x"), buf[i]);
    }

    free(buf);
    CFRelease(data);

    return output;
}    

CFDataRef hmac(CFStringRef key, CFStringRef data)
{
    const char *cKey  = CFStringGetCStringPtr(key, CFStringGetSystemEncoding());
    const char *cData = CFStringGetCStringPtr(data, CFStringGetSystemEncoding());
    unsigned char cHMAC[CC_SHA256_DIGEST_LENGTH];

    CCHmac(kCCHmacAlgSHA256, cKey, strlen(cKey), cData, strlen(cData), cHMAC);
    CFDataRef HMAC = CFDataCreate(kCFAllocatorDefault, cHMAC, sizeof(cHMAC));

    return HMAC;
}

CFDictionaryRef buildRequest(CFMutableDictionaryRef params)
{
    CFMutableStringRef signature = CFStringCreateMutable(NULL, 0);
    CFStringAppend(signature, CFDataToString(hmac(CFSTR("mykey"), CFSTR("mydata"))));

    CFDictionarySetValue(params, CFSTR("signature"), signature);

    // ....
    // ....       

    return params;
}

void request(CFMutableDictionaryRef params)
{
    params = buildRequest(params);

    // ... Run request

    CFRelease(params);
} 
```

仪器输出...

![在此处输入图像描述](../Images/411d7feac4bfc1fea5492f0204a0bd3c.png)

![在此处输入图像描述](../Images/c49e1e708640649fb4d9e6856dedc458.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:44:58.477

再一次作为答案。

使用方法分配的所有数据都将`Create`释放数据的责任交给程序员。在这方面，它与调用相同`malloc`。除非在文档中明确说明，否则任何方法都不会发布此数据。

要解决您的问题，请在接收它的方法中保存对“已创建”（已分配）数据的引用，并在完成后在方法结束时释放它。

# c# - 从内部访问 VM WPF 用户控件

> ID：14967276
> 
> 赞同：0
> 
> 时间：2013-02-19T20:58:06.263
> 
> 标签：c#, wpf, xaml, user-interface, mvvm

我正在尝试使用 ViewModel 中的属性来为[WPF Extended ToolKit](http://wpftoolkit.codeplex.com/wikipage?title=BusyIndicator&referringTitle=Home)中的控件 BusyIndi​​cator 分配文本值。提供的控件示例使用 DataTemplate 分配进度文本。静态分配文本很好，但是当尝试从 VM 访问值以分配值时会导致绑定错误。

在 app.xaml.cs 中处理的 VM 分配：

```
public partial class App : Application {

        private void OnStartup(object sender, StartupEventArgs seArgs) {
            MainWindowView mwv = new MainWindowView();
            mwv.DataContext = new DataSetViewModel(new DataSetModel());
            mwv.Show();
        }
} 
```

除了从 VM 获得的内容字符串之外，视图控件都可以工作：

```
<kit:BusyIndicator IsBusy="{Binding Path=ProcessingData,Converter={StaticResource busyIndicator}}"
                               DisplayAfter="0"
                                           >

    <kit:BusyIndicator.BusyContentTemplate>
        <DataTemplate>
            <StackPanel Margin="4">

                <!-- Output Error is 'WaitProgressUploadTitle' property not found on 'object' ''String' (HashCode=-775806441)'... -->
                <!-- Output Error is  'WaitProgressUploadContent' property not found on 'object' ''String' (HashCode=-775806441)'... -->
                <TextBlock Text="{Binding Path=WaitProgressUploadTitle}" FontWeight="Bold" HorizontalAlignment="Center"/>  
                <StackPanel Margin="4">
                    <TextBlock Text="{Binding Path=WaitProgressUploadContent}" />
                    <ProgressBar Value="40" Height="15"/>
                </StackPanel>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Button Grid.Column="0" Content="Pause" HorizontalAlignment="Right" Margin="0 0 2 0"/>
                    <Button Grid.Column="1" Content="Cancel" HorizontalAlignment="Left" Margin="2 0 0 0"/>
                </Grid>
            </StackPanel>
        </DataTemplate>
    </kit:BusyIndicator.BusyContentTemplate>
    <kit:BusyIndicator.OverlayStyle>
        <Style TargetType="Rectangle">
            <Setter Property="Fill" Value="#ffffeeee"/>
        </Style>
    </kit:BusyIndicator.OverlayStyle>
    <kit:BusyIndicator.ProgressBarStyle>
        <Style TargetType="ProgressBar">
            <Setter Property="Visibility" Value="Collapsed"/>
        </Style>
    </kit:BusyIndicator.ProgressBarStyle>

        <TextBlock Text="CONTENTCONTENTCONTENTCONTENT" Margin="0,100,0,0" HorizontalAlignment="Center" MaxWidth="675" TextAlignment="Center" FontSize="20" Visibility="{Binding Path=FileOpenGood,Converter={StaticResource errorVisibility}}" Background="Cornsilk" />

    </kit:BusyIndicator> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:13:28.080

当您使用`ContentTemplate`绑定时，内部`DataTemplate`是针对`Content`的属性`ContentControl`而不是它的`DataContext`

刚设置

```
BusyContent={Binding} 
```

顺便提一句。正如您从错误中看到的，绑定对象的类型是`string`.

# eclipse - 在 Eclipse CDT Paths&Symbols 中添加大量包含

> ID：14967285
> 
> 赞同：2
> 
> 时间：2013-02-19T20:58:37.600
> 
> 标签：eclipse, eclipse-cdt, include-path

我正在尝试在 Eclipse CDT 3.8 中使用[Soclib](http://www.soclib.fr) (www.soclib.fr)，但是代码错误突出显示器（分析器，无论是什么名字）都看不到一大堆包含文件。编译不是问题，因为 Makefile 调用了一个处理依赖项等的 python 脚本，但我希望 Eclipse CDT 有用，如果我做错了什么，可以告诉我。

我尝试将所有包含的根文件夹添加为工作台中的单独文件夹，然后将其添加到右键单击项目-> 属性-> C/C++ 常规-> 路径和符号作为工作区中的文件夹。它不起作用。如果我尝试在同一个地方访问它的根文件夹，它就不起作用（Eclipse 不会递归地处理这个文件夹，所以这里的条目需要是树的叶子）。

它可以工作的一种方法是制作一个 python/bash 脚本，该脚本将遍历树并创建一个包含 .h 或 .hpp 文件的所有端叶列表，然后将该列表导入 Eclipse。有没有更聪明/更简单的方法来做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-04-03T13:20:49.243

根据前面的答案，我制作了一个方便的 Python 脚本来为 Eclipse for C and C++ 生成 XML 文件。随意使用它。

[CDT XML 生成器 GitHub](https://github.com/hornmich/cdt_includes_gen/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T11:03:23.237

最后，我制作了一个 python 脚本，它创建了一个我导入到 Eclipse 的 XML 文件：

```
import os

list = os.popen('find . -type d').read()
fd = list.split('\n')
fd.pop()

d = '/home/milos/soclib'

OutputFile = open('symbols.xml', 'w')
OutputFile.write('<?xml version="1.0" encoding="UTF-8"?>')
OutputFile.write ('<cdtprojectproperties>\n')
OutputFile.write ('<section name="org.eclipse.cdt.internal.ui.wizards.settingswizards.IncludePaths">\n')
OutputFile.write ('<language name="C++ Source File">\n')

for f in fd:
    if 'include' in f:
        if not '.svn' in f:
            if not 'platform' in f:
                OutputFile.write('<includepath>' + d + f[1:] + '</includepath>' + '\n')
OutputFile.write('</language>\n')
OutputFile.write('<section>\n')
OutputFile.write('<cdtprojectproperties>\n')
OutputFile.close() 
```

我只是在模拟器的根文件夹中运行此脚本并获取我需要的所有包含文件夹，然后将其导入到 Eclipse

# hibernate - 读取 xml 时出错 - 一对多关系的映射错误

> ID：14967287
> 
> 赞同：0
> 
> 时间：2013-02-19T20:58:42.133
> 
> 标签：hibernate, jakarta-ee, intellij-idea

我正在使用 intellij idea 开发 javaEE 应用程序。

我创建了一个包含 3 个表（客户、产品、类别）的 mysql 数据库。然后我使用向导生成了休眠配置。

我有以下问题：

```
févr. 19, 2013 9:40:53 PM org.hibernate.cfg.Configuration addResource
INFO: HHH000221: Reading mappings from resource: smdatabase/SMCategoryEntity.hbm.xml
Exception in thread "main" org.hibernate.InvalidMappingException: Unable to read XML
    at org.hibernate.internal.util.xml.MappingReader.readMappingDocument(MappingReader.java:106)
    at org.hibernate.cfg.Configuration.add(Configuration.java:477)
    at org.hibernate.cfg.Configuration.add(Configuration.java:473)
    at org.hibernate.cfg.Configuration.add(Configuration.java:646)
    at org.hibernate.cfg.Configuration.addResource(Configuration.java:729)
    at org.hibernate.cfg.Configuration.parseMappingElement(Configuration.java:2105)
    at org.hibernate.cfg.Configuration.parseSessionFactory(Configuration.java:2077)
    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2057)
    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2010)
    at org.hibernate.cfg.Configuration.configure(Configuration.java:1925)
    at org.hibernate.cfg.Configuration.configure(Configuration.java:1904)
    at Main.getSession(Main.java:39)
    at Main.main(Main.java:49)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120)
Caused by: org.dom4j.DocumentException: null Nested exception: null
    at org.dom4j.io.SAXReader.read(SAXReader.java:484)
    at org.hibernate.internal.util.xml.MappingReader.readMappingDocument(MappingReader.java:76)
    ... 17 more

Process finished with exit code 1 
```

这是我的表定义：

```
CREATE TABLE customer (
    id INT NOT NULL PRIMARY KEY,
    email VARCHAR(500),
    password VARCHAR(500),
    shipping_address VARCHAR(500),
    shipping_postal_code VARCHAR(500),
    shipping_country VARCHAR(500),
    when_created TIMESTAMP DEFAULT CURRENT_TIMESTAMP 
) ENGINE=INNODB;

CREATE TABLE category(
   id INT NOT NULL auto_increment PRIMARY KEY,
   name VARCHAR(500) NOT NULL, 
    when_created TIMESTAMP DEFAULT CURRENT_TIMESTAMP 
) ENGINE=INNODB;

CREATE TABLE product (
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    price DECIMAL,
    name VARCHAR(500) NOT NULL, 
    category_id INT NOT NULL,
    product_index INT NOT NULL default 0,
    when_created TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (category_id) REFERENCES category(id)
) ENGINE=INNODB; 
```

并生成了 hbm.xmls（3 个不同的文件）：

```
<?xml version='1.0' encoding='utf-8'?>
<hibernate-mapping xmlns="http://www.hibernate.org/xsd/hibernate-mapping"
        xsi:schemaLocation="http://www.hibernate.org/xsd/hibernate-mapping http://www.hibernate.org/xsd/hibernate-mapping/hibernate-mapping-4.0.xsd" 
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <class name="smdatabase.SMProductEntity" table="product" catalog="supmarket">
        <id name="id">
            <column name="id" sql-type="int" length="10" not-null="true"/>
        </id>
        <property name="price">
            <column name="price" sql-type="decimal" length="10"/>
        </property>
        <property name="name">
            <column name="name" sql-type="varchar" length="500" not-null="true"/>
        </property>
        <property name="categoryId">
            <column name="category_id" sql-type="int" length="10" not-null="true"/>
        </property>
        <property name="whenCreated">
            <column name="when_created" sql-type="timestamp" length="19" not-null="true"/>
        </property>
        <many-to-one name="Category" class="smdatabase.SMCategoryEntity"/>
    </class>
</hibernate-mapping>

<!-- file 2 -->
<?xml version='1.0' encoding='utf-8'?>

<hibernate-mapping xmlns="http://www.hibernate.org/xsd/hibernate-mapping"
        xsi:schemaLocation="http://www.hibernate.org/xsd/hibernate-mapping http://www.hibernate.org/xsd/hibernate-mapping/hibernate-mapping-4.0.xsd"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <class name="smdatabase.SMCategoryEntity" table="category" >
        <id name="id">
            <column name="id" sql-type="int" length="10" not-null="true"/>
        </id>
        <property name="name">
            <column name="name" sql-type="varchar" length="500" not-null="true"/>
        </property>
        <property name="whenCreated">
            <column name="when_created" sql-type="timestamp" length="19" not-null="true"/>
        </property>
        <list name="CategoryProducts" inverse="true" table="product">
            <key column="category_id" />
            <list-index column="product_index" base="1"/>
            <one-to-many not-found="ignore" class="smdatabase.SMProductEntity"/>
        </list>
    </class>
</hibernate-mapping>

<!-- file 3 -->
<?xml version='1.0' encoding='utf-8'?>
<hibernate-mapping xmlns="http://www.hibernate.org/xsd/hibernate-mapping"
        xsi:schemaLocation="http://www.hibernate.org/xsd/hibernate-mapping http://www.hibernate.org/xsd/hibernate-mapping/hibernate-mapping-4.0.xsd" 
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <class name="smdatabase.SMCustomerEntity" table="customer" schema="" catalog="supmarket">
        <id name="id">
            <column name="id" sql-type="int" length="10" not-null="true"/>
        </id>
        <property name="email">
            <column name="email" sql-type="varchar" length="500"/>
        </property>
        <property name="password">
            <column name="password" sql-type="varchar" length="500"/>
        </property>
        <property name="shippingAddress">
            <column name="shipping_address" sql-type="varchar" length="500"/>
        </property>
        <property name="shippingPostalCode">
            <column name="shipping_postal_code" sql-type="varchar" length="500"/>
        </property>
        <property name="shippingCountry">
            <column name="shipping_country" sql-type="varchar" length="500"/>
        </property>
        <property name="whenCreated">
            <column name="when_created" sql-type="timestamp" length="19" not-null="true"/>
        </property>
    </class>
</hibernate-mapping> 
```

我已更改类别表中的属性。生成后是：

```
<list name="CategoryProducts" inverse="true">
   <key />
   <one-to-many not-found="ignore" class="smdatabase.SMProductEntity"/>
</list> 
```

我完全迷路了。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T09:24:29.623

我不确定您提到的 XSD 是否有效：

```
http://www.hibernate.org/xsd/hibernate-mapping/hibernate-mapping-4.0.xsd 
```

即使您使用的是 Hibernate 4，您也应该坚持以下几点：

```
<!DOCTYPE hibernate-mapping PUBLIC
    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
    "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    ...
</hibernate-mapping> 
```

# php - php/mysql 插入设置

> ID：14967288
> 
> 赞同：-2
> 
> 时间：2013-02-19T20:58:44.237
> 
> 标签：php, mysql

`INSERT INTO SET`我上班有困难。我知道它不是传统的，并且应该使用 VALUE 。但是 SET 命令在视觉上确实使插入字段更容易。第一个插入没有问题，但在我添加变量`m_pos`时没有发布。`$pos1`如果我删除`$pos1`变量并输入一个像“1”这样的字符串，它就可以工作。

```
$pos1 = "1";
mysql_query("INSERT INTO social_info SET 
    m_id = '.intval($id).', 
    m_pos = '.$pos1.'"
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:01:55.943

```
 $pos1 = "1";
 mysql_query("INSERT INTO social_info SET 
 m_id = '.intval($id).', 
 m_pos = '.$pos1.'"
 ); 
```

你把你的语法弄乱了一点。应该：

```
$pos1 = "1";
mysql_query("INSERT INTO social_info SET 
m_id = ".intval($id).", 
m_pos = ".$pos1
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:25:05.167

@@seanbreeden 是正确的，你错过了“”，它应该是这样的。

$pos1 = "1"; mysql_query("INSERT INTO social_info SET m_id = '".intval($id)."', m_pos = '".$pos1.'");

# c++ - OpenCV：基于特征检测的目标检测和跟踪

> ID：14967291
> 
> 赞同：0
> 
> 时间：2013-02-19T20:58:49.783
> 
> 标签：c++, opencv, implementation, tracking, video-processing

我刚刚涉足计算机视觉并试图揭开它的各种复杂性。我正在尝试使用冲浪特征检测器来增强卡尔曼滤波器。但是我不明白在使用冲浪特征在检测到的帧上构造单应性和有界矩形后如何调用和使用卡尔曼方法。在与传入帧进行比较后，我已经检测到特征并使用参考图像提取了关键点。然后我使用了flann matcher。

现在，使用卡尔曼滤波器是否可行，因为我想跟踪运动并获得预测的运动。我搜索了很多，但没有发现冲浪功能可以与卡尔曼滤波器一起使用。我得到的只是使用 cvBlobs 进行跟踪的建议。但是，理论上卡尔曼滤波器用于跟踪目的。但是，我很困惑，因为使用 surf 的基于视频的跟踪的几种实现表明 surf 本身可以用于跟踪。但我的问题是

*   如果卡尔曼滤波器不能与 surf 一起使用，那么我如何实现矩来获取坐标测量值，因为我需要运动预测的信息。

*   可以将 surf 与卡尔曼滤波器一起使用以进行跟踪，如果可以，在检测到对象并使用以下代码以矩形为边界后如何实现它。

    示例：要跟踪的对象![book1.png](../Images/ad4b5a4c203b011652f1127b4f53ea05.png)。一些帧![框架1](../Images/925b4038c2fad60f68e8bde4402d2a97.png) ![框架2](../Images/3f5dd161f8d0887680f67ac24cf55929.png)

    /* 视频中的目标检测和识别*/

    int main() { Mat object = imread( "book1.png",CV_LOAD_IMAGE_GRAYSCALE );

    ```
    if( !object.data )
    {
        std::cout<< "Error reading object " << std::endl;
        return -1;
    }

    //Detect the keypoints using SURF Detector
    int minHessian = 500;

    SurfFeatureDetector detector( minHessian );
    std::vector<KeyPoint> kp_object;

    detector.detect( object, kp_object );

    //Calculate descriptors (feature vectors)
    SurfDescriptorExtractor extractor;
    Mat des_object;

    extractor.compute( object, kp_object, des_object );

    FlannBasedMatcher matcher;        

    namedWindow("Good Matches");
    namedWindow("Tracking");

    std::vector<Point2f> obj_corners(4);

    //Get the corners from the object
    obj_corners[0] = cvPoint(0,0);
    obj_corners[1] = cvPoint( object.cols, 0 );
    obj_corners[2] = cvPoint( object.cols, object.rows );
    obj_corners[3] = cvPoint( 0, object.rows );

    char key = 'a';
    int framecount = 0;
    VideoCapture cap("booksvideo.avi");

    for(; ;)
    {
        Mat frame;
        cap >> frame;
        imshow("Good Matches", frame);

        Mat des_image, img_matches;
        std::vector<KeyPoint> kp_image;
        std::vector<vector<DMatch > > matches;
        std::vector<DMatch > good_matches;
        std::vector<Point2f> obj;
        std::vector<Point2f> scene;
        std::vector<Point2f> scene_corners(4);
        Mat H;
        Mat image;

        //cvtColor(frame, image, CV_RGB2GRAY);

        detector.detect( image, kp_image );
        extractor.compute( image, kp_image, des_image );

        matcher.knnMatch(des_object, des_image, matches, 2);

        //THIS  LOOP IS SENSITIVE TO SEGFAULTS
        for(int i = 0; i < min(des_image.rows-1,(int) matches.size()); i++) 
        {
            if((matches[i][0].distance < 0.6*(matches[i][4].distance)) && ((int) matches[i].size()<=2 && (int) matches[i].size()>0))
            {
                good_matches.push_back(matches[i][0]);
            }
        }

        //Draw only "good" matches
        drawMatches( object, kp_object, image, kp_image, good_matches, img_matches, Scalar::all(-1), Scalar::all(-1), vector<char>(), DrawMatchesFlags::NOT_DRAW_SINGLE_POINTS );

        if (good_matches.size() >= 4)
        {
            for( int i = 0; i < good_matches.size(); i++ )
            {
                //Get the keypoints from the good matches
                obj.push_back( kp_object[ good_matches[i].queryIdx ].pt );
                scene.push_back( kp_image[ good_matches[i].trainIdx ].pt );
            }

            H = findHomography( obj, scene, CV_RANSAC );

            perspectiveTransform( obj_corners, scene_corners, H);

            //Draw lines between the corners (the mapped object in the scene image )
            line( img_matches, scene_corners[0] + Point2f( object.cols, 0), scene_corners[1] + Point2f( object.cols, 0), Scalar(0, 255, 0), 4 );
            line( img_matches, scene_corners[1] + Point2f( object.cols, 0), scene_corners[2] + Point2f( object.cols, 0), Scalar( 0, 255, 0), 4 );
            line( img_matches, scene_corners[2] + Point2f( object.cols, 0), scene_corners[3] + Point2f( object.cols, 0), Scalar( 0, 255, 0), 4 );
            line( img_matches, scene_corners[3] + Point2f( object.cols, 0), scene_corners[0] + Point2f( object.cols, 0), Scalar( 0, 255, 0), 4 );

        }

        //Show detected matches
        imshow( "Good Matches", img_matches );
        for( int i = 0; i < good_matches.size(); i++ )
        { 
            printf( "-- Good Match [%d] Keypoint 1: %d  -- Keypoint 2: %d  \n", i,    good_matches[i].queryIdx, good_matches[i].trainIdx ); 
        }

        waitKey(0); 
    ```

    }

    返回0；

    }

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T00:17:28.953

我还没有看到您描述的特征匹配和过滤的组合。我的一个想法是使用卡尔曼滤波器跟踪质心（和大小），并在下一帧运行特征匹配之前使用该信息屏蔽外部区域。我不确定你的约束是什么，但你可能会考虑模板匹配或 camshift 类型的跟踪，它也可以使用卡尔曼滤波器来帮助搜索。

# c# - 删除没有子节点的父节点

> ID：14967293
> 
> 赞同：6
> 
> 时间：2013-02-19T20:58:59.987
> 
> 标签：c#, xml, xpath, xml-parsing, linq-to-xml

我有一个关于从 xml 文件中删除特定节点的问题。

这是我的 XML 示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<root>
  <nodeA attribute="1">
    <nodeB attribute="table">
      <nodeC attribute="500"></nodeC>
      <nodeC attribute="5"></nodeC>
    </nodeB>
    <nodeB attribute="3">
      <nodeC attribute="4"></nodeC>
      <nodeC attribute="5"></nodeC>
      <nodeC attribute="5"></nodeC>
    </nodeB>
    <nodeB attribute="placeHolder">
    <nodeB attribute="toRemove">
      <nodeB attribute="glass"></nodeB>
        <nodeE attribute="7"></nodeE>
      <nodeB attribute="glass"></nodeB>
      <nodeB attribute="glass"></nodeB>
    </nodeB>
    </nodeB>
    <nodeB attribute="3">
      <nodeC attribute="4"></nodeC>
      <nodeC attribute="5"></nodeC>
      <nodeC attribtue="5"></nodeC>
     </nodeB>
    <nodeB attribute="placeHolder">
    <nodeB attribute="toRemove">
      <nodeB attribute="glass"></nodeB>
        <nodeE attribute="7"></nodeE>
      <nodeB attribute="glass"></nodeB>
      <nodeB attribute="glass"></nodeB>
    </nodeB>
    </nodeB>
  </nodeA>
</root> 
```

我想删除节点`nodeB="toRemove"`而不删除该节点的子节点。之后，我需要对`nodeB attribute="placeHolder"`. 部分结果如下所示：

```
 <nodeB attribute="3">
      <nodeC attribute="4"></nodeC>
      <nodeC attribute="5"></nodeC>
      <nodeC attribtue="5"></nodeC>
     </nodeB>
     <nodeB attribute="glass"></nodeB>
        <nodeE attribute="7"></nodeE>
     <nodeB attribute="glass"></nodeB>
     <nodeB attribute="glass"></nodeB> 
```

我一直在尝试这样的代码来实现：

```
 XmlNodeList nodeList = doc.SelectNodes("//nodeB[@attribute=\"toRemove\"]");

        foreach (XmlNode node in nodeList)
        {
            foreach (XmlNode child in node.ChildNodes)
            {
                node.ParentNode.AppendChild(child);
            }
            node.ParentNode.RemoveChild(node);
        }
        doc.Save(XmlFilePathSource); 
```

我能够找到具有所需属性 toRemove 或 placeHolder 的节点，但是我无法将此节点的子节点上移一级。在这种情况下你能帮我吗？它可以是 Linq、XDocument、XmlReader 的解决方案，但我更喜欢使用 XmlDocument。感谢您提前为我提供的任何帮助。

编辑：

在这种情况下，我使用了 Chuck Savage 在下面编写的稍微修改过的代码（以保持顺序）。一次删除

```
 <nodeB attribute="toRemove"> </nodeB> 
```

然后做同样的事情

```
 <nodeB attribute="placeHolder"></nodeB> 
```

这是稍微修改的代码

```
 XElement root = XElement.Load(XmlFilePathSource); 
  var removes = root.XPathSelectElements("//nodeB[@attribute=\"toRemove\"]");
  foreach (XElement node in removes.ToArray())
  {
    node.Parent.AddAfterSelf(node.Elements());
    node.Remove();
  }
  root.Save(XmlFilePathSource); 
```

@MiMo 提供的 xslt 方法在这种情况下也非常有用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T23:19:06.767

问题是您无法在枚举其子节点时修改文档节点 - 您应该创建新节点而不是尝试修改现有节点，使用`XmlDocument`.

进行这种转换的最简单方法是使用 XSLT，即应用此 XSLT：

```
<xsl:stylesheet 
  version="1.0" 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="nodeB[@attribute='toRemove' or @attribute='placeHolder']">
    <xsl:apply-templates/>
  </xsl:template>

  <xsl:template match="text()">
  </xsl:template>

  <xsl:template match="@* | *">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

</xsl:stylesheet> 
```

到输入文件的输出是：

```
<root>
  <nodeA attribute="1">
    <nodeB attribute="table">
      <nodeC attribute="500" />
      <nodeC attribute="5" />
    </nodeB>
    <nodeB attribute="3">
      <nodeC attribute="4" />
      <nodeC attribute="5" />
      <nodeC attribute="5" />
    </nodeB>
    <nodeB attribute="glass" />
    <nodeE attribute="7" />
    <nodeB attribute="glass" />
    <nodeB attribute="glass" />
    <nodeB attribute="3">
      <nodeC attribute="4" />
      <nodeC attribute="5" />
      <nodeC attribtue="5" />
    </nodeB>
    <nodeB attribute="glass" />
    <nodeE attribute="7" />
    <nodeB attribute="glass" />
    <nodeB attribute="glass" />
  </nodeA>
</root> 
```

应用 XSLT 的代码很简单：

```
 XslCompiledTransform transform = new XslCompiledTransform();
  transform.Load(@"c:\temp\nodes.xslt");
  transform.Transform(@"c:\temp\nodes.xml", @"c:\temp\nodes-cleaned.xml"); 
```

如果不可能（或不希望）为 XSLT 使用外部文件，则可以从字符串中读取它：

```
 string xsltString =
    @"<xsl:stylesheet 
      version='1.0' 
      xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>

      <xsl:output method=""xml"" indent=""yes""/>

      <xsl:template match=""nodeB[@attribute='toRemove' or @attribute='placeHolder']"">
        <xsl:apply-templates/>
      </xsl:template>

      <xsl:template match=""text()"">
      </xsl:template>

      <xsl:template match=""@* | *"">
        <xsl:copy>
          <xsl:apply-templates select=""@* | node()""/>
        </xsl:copy>
      </xsl:template>

    </xsl:stylesheet>";
  XslCompiledTransform transform = new XslCompiledTransform();
  using (StringReader stringReader = new StringReader(xsltString))
  using (XmlReader reader = XmlReader.Create(stringReader)) {
    transform.Load(reader);
  }
  transform.Transform(@"c:\temp\nodes.xml", @"c:\temp\nodes-cleaned.xml"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T23:43:53.027

使用 Linq-to-XML 和您的 XPath，

```
XElement root = XElement.Load(XmlFilePathSource); // or .Parse(string)
var removes = root.XPathSelectElements("//nodeB[@attribute=\"toRemove\"]");
foreach (XElement node in removes.ToArray())
{
    node.AddBeforeSelf(node.Elements());
    node.Remove();
}
root.Save(XmlFilePathSource); 
```

注意：XPath 可用于`System.Xml.XPath`

[注意 2：您可以使用这些扩展名](https://gist.github.com/ChuckSavage/4991478)与 XmlDocument 进行转换，因为您更喜欢 XmlDocument。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-01T09:27:27.310

我知道这是一个老问题，但我直接使用 XmlDocument 编写了这个问题。

如果有人喜欢这样做，请添加它：

```
XmlNode child_to_remove = parent.ChildNodes[i]; // get the child to remove

// move all the children of "child_to_remove" to be the child of their grandfather (== parent)
while(child_to_remove.HasChildNodes)
    parent.InsertBefore(child_to_remove.ChildNodes[0], child_to_remove);

parent.RemoveChild(child_to_remove); 
```

就是这样:-)，希望它会帮助任何人。

# java - 在 Android 上使用 mp4parser 组合 Mp4

> ID：14967298
> 
> 赞同：5
> 
> 时间：2013-02-19T20:59:26.947
> 
> 标签：java, android, audio, mp4, mp4parser

我只是想知道是否有人知道如何获取 mp4 音频文件并将其覆盖到`mp4parser`在 Android 上使用的 mp4 视频文件上。我已经能够将一个视频附加到另一个视频，现在我只需要将我拥有的原始 mp4 覆盖在组合文件上。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-30T21:33:49.097

以下代码混合了两种音频语言和一个视频。它应该很容易满足您的需求：

```
public static void main(String[] args) throws IOException {

    String audioDeutsch = MuxMp4SourcesExample.class.getProtectionDomain().getCodeSource().getLocation().getFile() + "/count-deutsch-audio.mp4";
    String audioEnglish = MuxMp4SourcesExample.class.getProtectionDomain().getCodeSource().getLocation().getFile() + "/count-english-audio.mp4";
    String video = MuxMp4SourcesExample.class.getProtectionDomain().getCodeSource().getLocation().getFile() + "/count-video.mp4";

    Movie countVideo = MovieCreator.build(new FileInputStream(video).getChannel());
    Movie countAudioDeutsch = MovieCreator.build(new FileInputStream(audioDeutsch).getChannel());
    Movie countAudioEnglish = MovieCreator.build(new FileInputStream(audioEnglish).getChannel());

    Track audioTrackDeutsch = countAudioDeutsch.getTracks().get(0);
    audioTrackDeutsch.getTrackMetaData().setLanguage("deu");
    Track audioTrackEnglish = countAudioEnglish.getTracks().get(0);
    audioTrackEnglish.getTrackMetaData().setLanguage("eng");

    countVideo.addTrack(audioTrackDeutsch);
    countVideo.addTrack(audioTrackEnglish);

    Container out = new DefaultMp4Builder().build(countVideo);
    FileOutputStream fos = new FileOutputStream(new File("output.mp4"));
    out.writeContainer(fos.getChannel());
    fos.close();

} 
```

# bash - 大型数据集的参数扩展缓慢

> ID：14967299
> 
> 赞同：1
> 
> 时间：2013-02-19T20:59:28.300
> 
> 标签：bash

如果我从文件中取出前 1,000 个字节，Bash 可以很快替换一些字符

```
$ cut -b-1000 get_video_info
muted=0&status=ok&length_seconds=24&endscreen_module=http%3A%2F%2Fs.ytimg.com%2F
yts%2Fswfbin%2Fendscreen-vfl4_CAIR.swf&plid=AATWGZfL-Ysy64Mp&sendtmp=1&view_coun
t=3587&author=hye+jeong+Jeong&pltype=contentugc&threed_layout=1&storyboard_spec=
http%3A%2F%2Fi1.ytimg.com%2Fsb%2FLHelEIJVxiE%2Fstoryboard3_L%24L%2F%24N.jpg%7C48
%2327%23100%2310%2310%230%23default%23cTWfBXjxZMDvzL5cyCgHdDJ3s_A%7C80%2345%2324
%2310%2310%231000%23M%24M%23m1lhUvkKk6sTnuyKXnPBojTIqeM%7C160%2390%2324%235%235%
231000%23M%24M%23r-fWFZpjrP1oq2uq_Y_1im4iu2I%7C320%23180%2324%233%233%231000%23M
%24M%23uGg7bth0q6XSYb8odKLRqkNe7ao&approx_threed_layout=1&allow_embed=1&allow_ra
tings=1&url_encoded_fmt_stream_map=fallback_host%3Dtc.v11.cache2.c.youtube.com%2
6quality%3Dhd1080%26sig%3D610EACBDE06623717B1DC2265696B473C47BD28F.98097DEC78411
95A074D6D6EBFF8B277F9C071AE%26url%3Dhttp%253A%252F%252Fr9---sn-q4f7dney.c.youtub
e.com%252Fvideoplayback%253Fms%253Dau%2526ratebypass%253Dyes%2526ipbits%253D8%25
26key%253Dyt1%2526ip%253D99.109.97.214%2

$ read aa < <(cut -b-1000 get_video_info)

$ time set "${aa//%/\x}"

real    0m0.025s
user    0m0.031s
sys     0m0.000s 
```

但是，如果我占用 10,000 个字节，它会显着减慢

```
$ read aa < <(cut -b-10000 get_video_info)

$ time set "${aa//%/\x}"

real    0m8.125s
user    0m8.127s
sys     0m0.000s 
```

我阅读了[Greg Wooledge 的帖子](http://mywiki.wooledge.org/BashFAQ/021)，但没有解释为什么 Bash 参数扩展缓慢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-19T23:02:04.547

至于*为什么*`pat_subst`，你可以在`subst.c`bash 源代码中看到这段代码的实现。

对于字符串中的每个匹配项，字符串的长度都会被计算多次（在`pat_subst`和`match_pattern`中`match_upattern`），既作为 C 字符串，也作为多字节字符串更昂贵。这使得函数比必要的慢，更重要的是，复杂度呈二次方。

这就是为什么较大的输入速度很慢，这是一个漂亮的图表：

![shell 替换中的二次运行时](../Images/65dceff2ad64cfd2fa3eb377eb079b58.png)

至于解决方法，只需使用`sed`. 它更有可能针对字符串替换操作进行优化（尽管您应该知道 POSIX 仅保证每行 8192 个字节，即使 GNU sed 处理任意大的字节）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:42:46.640

最初，由于这种原因，较旧的 shell 和其他实用程序对文件输入施加 LINE_MAX = 2048。对于巨大的变量，bash 将它们停在内存中没有问题。但是替换需要至少两个并发副本。还有很多颠簸：当字符组被删除时，整个字符串都会被重写。一遍一遍又一遍。

有一些工具适用于此 - sed 是首选。bash 是一个遥远的第二选择。sed 适用于流，bash 适用于内存块。

另一种选择：bash 是可扩展的——当 bash 不打算这样做时，您可以编写自定义 C 代码来很好地填充东西。

CFA Johnson 有关于如何做到这一点的好文章：

一些准备加载内置函数：

[http://cfajohnson.com/shell/bash/loadables/](http://cfajohnson.com/shell/bash/loadables/)

DIY内置解释：

[http://cfajohnson.com/shell/articles/dynamically-loadable/](http://cfajohnson.com/shell/articles/dynamically-loadable/)

# xcode - XCode 重命名 Outlet 标签方向

> ID：14967300
> 
> 赞同：0
> 
> 时间：2013-02-19T20:59:28.303
> 
> 标签：xcode, xcode4, xcode4.5

从我创建的字符串（使用 xcode 4.5.2）

```
 - (void)viewDidLoad{ 
      myList = [[NSArray alloc] initWithObjects:@"x",@"y",@"z", nil];
      } 
```

当然还有：

```
@property (strong, nonatomic) IBOutlet UILabel *labelField_x;
@property (strong, nonatomic) IBOutlet UILabel *labelField_y;
@property (strong, nonatomic) IBOutlet UILabel *labelField_z; 
```

我希望能够在 IBAction 中通过从数组中选择正确的键来从字符串中选择要使用的标签。而不是做 if 或 BOOL 语句并重复我自己。表单示例我有这个：

```
- (IBAction)buttonPressed:(UIButton *)sender;
{
    if (is_x){

        NSString *digit = sender.currentTitle;
            if (!pressedDecimal){
                labelField_x.text = [labelField_x.text stringByAppendingString:digit];
            }else if (count <= 1){
                labelField_x.text = [labelField_x.text stringByAppendingString:digit];
            }
                                      .
                                      .
                                      .
    }
    else if (is_y){

        NSString *digit = sender.currentTitle;     
            if (!pressedDecimal){
                labelField_y.text = [labelField_y.text stringByAppendingString:digit];
            }else if (count <= 1){
                labelField_y.text = [labelField_y.text stringByAppendingString:digit];
            }
                                      .
                                      .
                                      .

    }
    else if (is_z){

        NSString *digit = sender.currentTitle;
            if (!pressedDecimal){
                labelField_z.text = [labelField_z.text stringByAppendingString:digit];
            }else if (count <= 1){
                labelField_z.text = [labelField_z.text stringByAppendingString:digit];
            }
                                      .
                                      .
                                      .
    }
} 
```

如您所见，我每次都使用相同的代码重复我自己，而不是仅更改位置或 UILabel 方向或它指向标签的任何内容（ labelField_x, labelField_y, labelField_z ）。我的问题是是否有办法只更改最后一个字符串 (x, y, z) 并从我创建的一组数组中调用它并告诉使用哪个标签。

我已经尝试过了，但当然它不起作用，并且与正确答案没有什么关系，但希望这可以更好地解释我想要的东西（提前抱歉编码不好）：

```
labelField_@"%@".text,[myList 0]  = [labelField_@"%@".text,[myList 0] stringByAppendingString:digit]; 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T23:37:25.657

我不完全确定您在做什么，但是如果您想节省一些打字时间，为什么不这样做：

```
// assign the label you want to use to a local variable

UILabel *selectedLabel;
selectedLabel = nil;
if (is_x) {
    selectedLabel = labelField_x;
} else if (is_y) {
    selectedLabel = labelField_y;
} else if (is_z) {
    selectedLabel = labelField_z;
}

// now work with selectedLabel so you don't have to repeat yourself

if (!pressedDecimal){
    selectedLabel.text = ... 
```

或者您甚至可以将 IBOutlet 属性中的标签直接粘贴到字典中，以便您可以快速获取任何给定字符（字符串）的正确标签：

```
// create a lookup dictionary (once, e.g. in awakeFromNib)

NSDictionary *labelForCharacter;
labelForCharacter = @{
    @"x" : labelField_x,
    @"y" : labelField_y,
    @"z" : labelField_z
};

 // get the label for "z"

UILabel *selectedLabel;
selectedLabel = labelForCharacter[@"z"]; 
```

# php - 在提交到 MySQL 数据库之前清理文本输入

> ID：14967301
> 
> 赞同：3
> 
> 时间：2013-02-19T20:59:32.867
> 
> 标签：php, database, pdo, ckeditor, sanitization

我目前正在努力确保为我正在处理的 web 应用程序提交到数据库中的文本在提交到数据库之前被正确清理，然后正确检索和显示。

忽略当前正在使用的杂乱无章的清理功能（它目前是一团糟并且破坏了东西），这就是我打算做的事情：

1.  使用 CKEditor 进行文本输入。它会自动将 HTML 标记/符号转换为它们的 HTML 实体。

2.  利用 PDO 准备语句将文本提交到数据库。

这足以正确清理输入吗？我一直在阅读这方面的内容，很多人说要使用魔术引号，但是我读到魔术引号很旧并且大多数人建议不要使用它。

提前感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:02:28.220

不要使用魔术引号。[http://php.net/manual/en/security.magicquotes.php](http://php.net/manual/en/security.magicquotes.php)

> 此功能自 PHP 5.3.0 起已弃用，自 PHP 5.4.0 起已移除。

如果您使用的是准备好的语句，那么您应该可以避免 sql 注入。`htmlspecialchars()`记得在前端显示时运行用户输入的数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T21:10:44.837

好吧，PDO 仅适用于初学者手册中的基本案例。
任何复杂的问题都会给 PDO 以及任何其他 API 带来麻烦。

但是，只要您准备好浪费时间编写大量插入语句，在所有这些答案之后重复每个变量六到十次 - PDO 就可以了。

但只是让您知道，没有针对标识符的准备好的声明。

至于 CKEditor - 它不是客户端应用程序吗？如果是这样，它不会保护任何东西。
因此，最好遵循另一个答案的建议 - 在 HTML 页面上显示时通过 htmlspecialchars() 传递不受信任的用户输入

# java - Hibernate flush() 方法混淆

> ID：14967302
> 
> 赞同：0
> 
> 时间：2013-02-19T20:59:35.410
> 
> 标签：java, spring, hibernate

我了解 Hibernate 的 Session.flush() 方法将内存中的当前数据状态写入数据库。我使用它，它工作正常。但我的问题是：使用 Session.flush() 是强制性的吗？

如果我删除 Session.flush() 则不会在数据库中插入/更新任何内容。而且我在我的日志文件中看不到任何错误。

我在我的应用程序中使用 Spring + Hibernate。我还使用了我在 web.xml 中定义的 OpenSessionInViewFilter，如下所示：

```
<filter>
  <filter-name>hibernateFilter</filter-name>
  <filter-class>org.springframework.orm.hibernate3.support.OpenSessionInViewFilter</filter-class>
  <init-param>     
         <param-name>flushMode</param-name>       
         <param-value>AUTO</param-value> 
    </init-param>     
</filter>

<filter-mapping>
  <filter-name>hibernateFilter</filter-name>
  <url-pattern>/*</url-pattern> 
</filter-mapping> 
```

我曾尝试使用 flushMode 作为 COMMIT 但它仍然没有帮助。

我的 Spring applicationContext.xml 具有以下数据源行：

```
<bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
    <property name="jndiName" value="${jdbc.jndiName}" />
    <property name="resourceRef" value="true" />
</bean>

<bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <property name="dataSource" ref="dataSource"></property>
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.show_sql">${hibernate.show_sql}</prop>
            <prop key="hibernate.dialect">${hibernate.dialect}</prop>
        </props>
    </property>
    <property name="annotatedClasses">
        <list>
            <value>...</value>
        </list>
    </property>
</bean> 
```

最后我的代码片段如下所示：

```
public String saveRegistration (final Registration registration) {

    getHibernateTemplate().saveOrUpdate(registration);
    getSession().flush(); // If I remove this, no records would be inserted/updated!!
    String id = registration.getId();

    return id;
} 
```

如您所见，我在 Spring 和 Hibernate 中使用了非常基本的配置。

有人可以帮助我理解为什么应该调用 getSession.flush() 吗？为什么没有它没有记录在数据库中保存/更新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T05:28:46.687

刷新只是与数据库同步，然后您需要提交或清除会话以查看更改。

如果你只是提交。它会自动刷新，你也可以从另一个会话中看到你的更改。

## **Commit 将使数据库提交**

**刷新是将底层持久存储与内存中保存的持久状态同步的过程。**

IE。它会在正在运行的事务中更新或插入到您的表中，但它*可能*不会提交这些更改（这取决于您的刷新模式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T23:00:09.377

您确定没有在数据库中创建记录吗？如果您这么说是因为返回的 id 为空，那么我认为您误解了。当您调用 saveOrUpdate 时，该对象将存储在 Hibernate 会话中，并且运行查询的其他代码可以检索它，但**它不一定会立即持久化到数据库**中。在您运行提示 Hibernate 将对象持久保存到数据库的查询或手动调用 flush() 之前，当前对象实例不会有 id。

如果您编写第二种方法来查询对象，我建议您检查行为是什么。我想你会发现这会导致 Hibernate 将对象刷新到数据库中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T23:29:25.393

一旦从数据库加载或保存参数“registration”可能不会更改。当缓存对象和数据库数据之间存在差异时，Hibernate 将保存/更新实体。

修改“注册”实例中的字段之一后尝试。

此外，最好打开 Hibernate/Spring 调试日志并查看引擎盖下发生了什么。

# css - Internet Explorer 中不显示下拉菜单

> ID：14967305
> 
> 赞同：0
> 
> 时间：2013-02-19T20:59:45.137
> 
> 标签：css, drop-down-menu, menu

我需要帮助弄清楚为什么我创建的菜单在 IE 中无法正常工作。我目前在 HTML/CSS 课程中，所以我的经验水平有限。我只是在谷歌上搜索东西并在我去的时候检查我的书。

我从谷歌搜索“css 下拉菜单”后找到的教程创建了这个菜单。我对此感到非常自豪，但我不明白为什么它在 Internet Explorer 中无法正确显示。它似乎在 Firefox 和 Chrome 中运行良好，更重要的是，在 ipad 上运行。我的公司目前使用 java 菜单，我想用它来替换它。

链接在这里：

[http://net.saddleback.edu/hyosafi0/CIM271A/random/menutest/menu.htm](http://net.saddleback.edu/hyosafi0/CIM271A/random/menutest/menu.htm)

对于为什么它在 IE 中不起作用或我应该从哪里开始在我的代码中查找错误的任何建议，我将不胜感激。我认为这与声明文档类型有关，但我不确定。

提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:11:27.840

You are missing an `<li>` tag on the second Home link.

Also, try inserting `<!DOCTYPE html>` at the top of your html file. This will get IE out of Quirks mode, which can solve some problems in the future.

# excel-dna - 无法更改 Excel 功能区上的标签

> ID：14967306
> 
> 赞同：6
> 
> 时间：2013-02-19T20:59:46.447
> 
> 标签：excel-dna

我在尝试使用 Excel-DNA 使用功能区设置自定义标签时遇到问题。

如果我没有包含注释“getLabel='GetLabel'”，那么插件加载正常。即功能区选项卡显示有 2 个按钮，按钮回调工作正常。

如果我确实包含属性“getLabel='GetLabel'”，则插件甚至不会加载，即不会调用 onLoad，并且功能区选项卡不会显示在 excel 中。

谁能看到我在这里做错了什么。在调试器中运行时我没有看到任何错误。

这是我的 DNA 文件。我试图以其中一个样本为基础，以便更容易理解。

```
<DnaLibrary Name="Emsx Addin" RuntimeVersion="v2.0">
<ExternalLibrary Path="EmsxExcelTech1.dll" />
<Reference AssemblyPath="System.Windows.Forms.dll" />

<!-- Some images that can be used in the Ribbon ui -->
<Image Name="M" Path="M.png" Pack="true" />

<CustomUI>
<customUI xmlns='http://schemas.microsoft.com/office/2009/07/customui' loadImage='LoadImage' onLoad='OnLoad'>
  <ribbon>
    <tabs>
      <tab id='CustomTab' label='K2 Emsx' insertAfterMso='View'>
        <group id='SampleGroup' label='Global Sheet Status'>
          <button id='LoginCmd' label='Logon' image='M' onAction='OnLogonPressed' getLabel='GetLabel' />
          <button id='BetaCmd' label='Use Beta Route' image='M' size='normal' onAction='RunTagMacro' tag='OnUseBetaRoutes' />
        </group >
      </tab>
    </tabs>
  </ribbon>
</customUI>
</CustomUI>
</DnaLibrary> 
```

这是我的 Ribbon 派生的 C# 文件。

```
[ComVisible(true)]
public class EmsxRibbon : ExcelRibbon
{
    private IRibbonUI ribbon = null;

    public void OnLogonPressed(IRibbonControl control)
    {
        EmsxIntegration.Instance.Login();
        MessageBox.Show("Hello from control " + control.Id);
        if (ribbon != null)
        {
            ribbon.InvalidateControl(control.Id);
        }

    }

    string GetLabel(IRibbonControl control)
    {
        if (control.Tag == "Logon")
        {
            return "Logon";
        }
        else
        {
            return "Logoff";
        }
    }

    public static void OnUseBetaRoutes()
    {
        MessageBox.Show("Hello from 'ShowHelloMessage'.");
    }

    public void OnLoad(IRibbonUI ribbon)
    {
        this.ribbon = ribbon;
    }

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-21T17:58:31.137

当你使用 getLabel 事件时，你不应该使用 label 属性，所以改变

```
<button id='LoginCmd' label='Logon' image='M' onAction='OnLogonPressed' getLabel='GetLabel' /> 
```

至

```
<button id='LoginCmd' image='M' onAction='OnLogonPressed' getLabel='GetLabel' /> 
```

希望这可以帮助。

# windows - 如果文件不以 .jpg 结尾，则批量删除文件的最后 4 个字符？

> ID：14967307
> 
> 赞同：1
> 
> 时间：2013-02-19T20:59:46.477
> 
> 标签：windows, batch-file, directory, rename

由于 After Effects 中的错误，我得到单帧输出，最后有 4 个数字，命名如下：

```
Test.jpg0001
Another.jpg0345
AndAnother.jpg0033 
```

如果文件不以 .jpg 结尾，我可以编写一个批处理脚本在 Windows 文件夹中运行以删除最后 4 个字符吗？因此，当我添加新文件时，我可以继续运行脚本，但不会影响已更正的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:31:18.167

这是一个 VB 脚本，它将搜索以 JPG 开头的所有扩展名，如果超过 3 个字符，则将文件重命名为仅以 jpg 结尾。像我用几个文件一样创建一个测试目录并尝试一下。它在代码中有一个硬编码目录，您必须在运行它之前对其进行更改（除非您的目录名为 c:\testdat）。注意以斜杠结束文件夹名称（惰性编程）：

```
 set fs = createobject("Scripting.Filesystemobject")

   dirWithFiles = "C:\TestDat\"   ' End with a slash

   set folder = fs.getfolder(dirWithFiles)

   set filescollection = folder.files
   for each file in filescollection
      oldname = dirWithFiles & file.name
      basename = fs.getbasename(file.name)
      extension = fs.getExtensionName(file.name)

      if ucase(mid(extension,1,3)) = "JPG" then
         if len(extension) > 3 then
            newname = dirWithFiles & basename & ".jpg"

            'msgbox "Rename " & oldname  & " to " & newname
            fs.movefile oldname,newname
         end if
      end if
   next 
```

将其复制到以 .vbs 结尾的文件中（我叫我的 jpgrename.vbs），修改 c:\testdat\ 目录名称，然后将其放在桌面上。双击它（在 Windows 下）它应该运行。这是之前和之后的图像：

![在此处输入图像描述](../Images/531df0a6153c0a7061877bedc9c110b8.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T01:28:33.170

我的天哪，不需要任何类型的脚本。您只需要一个简单的重命名命令。

这会将扩展名设置`.jpg`为包含`.jpg`.

```
ren *.jpg* *.jpg 
```

以上内容并不完美，因为它会不正确地重命名类似`test.jpg.txt`to 的内容`test.jpg.jpg`。它还会将文件`test2.jpgXYZ`（例如后面的​​数字`.jpg`除外）重命名为`test2.jpg`. 我怀疑这些限制不会成为问题。

如果您想更有选择性并且只重命名扩展名开头的`.jpg`文件（忽略`.jpg`名称中后跟其他扩展名的文件），那么您可以使用 FINDSTR 正则表达式来过滤文件：

```
for /f "eol=: delims=" %F in ('dir /b *.jpg*^|findstr /re "\.jpg[^.][^.]*"') do ren "%F" *.jpg 
```

如果您想更有选择性并且只重命名`.jpg`以 1 个或多个数字结尾的文件，那么：

```
for /f "eol=: delims=" %F in ('dir /b *.jpg*^|findstr /re "\.jpg[0-9][0-9]*"') do ren "%F" *.jpg 
```

如果在批处理文件中使用 FOR /F 语句，则需要将百分比加倍（`%%F`而不是`%F`）。

# css - 如何在 CSS 边框顶部设置阴影？

> ID：14967309
> 
> 赞同：2
> 
> 时间：2013-02-19T20:59:53.323
> 
> 标签：css

```
<div class="row">
   some content

   <div class="info-box">
      some other content
   </div>
</div>

.row {
    float: left;
    margin-bottom: 1.5%;
    border: 1px solid #e3e3e3;
    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    -ms-border-radius: 4px;
    -o-border-radius: 4px;
    border-radius: 4px;
    background-color: rgb(250, 250, 250);
    width: 685px;
    -webkit-box-shadow:rgb(153,153,153) 0px 1px 2px 0px;
    -moz-box-shadow:rgb(153,153,153) 0px 1px 2px 0px;
    -ms-box-shadow:rgb(153,153,153) 0px 1px 2px 0px;
    -o-border-box-shadow:rgb(153,153,153) 0px 1px 2px 0px;
    box-shadow:rgb(153,153,153) 0px 1px 2px 0px;
}

.row:hover {
    background-color: rgb(240, 245, 245);
    -moz-box-shadow:    inset 0 0 5px #4d4d4d;
   -webkit-box-shadow: inset 0 0 5px #4d4d4d;
   box-shadow:         inset 0 0 5px #4d4d4d;

}

.info-box {
    position: relative; 
    border-left: 1px solid #e3e3e3;
    padding: 15px;
    width: 170px;
    font-size: 0.93em;
    color: #363636;
    float: left;
} 
```

好的，我在行中有这个信息框。从 .row:hover 开始，我正在创建一个内部阴影。当您将鼠标悬停在行上时，信息框的左边框似乎显示在阴影顶部。

我的问题是你是否可以在边框顶部制作阴影。提前致谢。

注意：z-index 对我不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:23:33.117

当然它在最上面：孩子必须出现在父母之上，否则它会被它隐藏。要达到预期的效果，您必须将阴影应用到上方的元素，即`.info-box`. 您可以通过使用`:after` [伪元素](http://css-tricks.com/pseudo-element-roundup/)来实现这一点，而无需额外的标记。

如果你看一下[这个小提琴](http://jsfiddle.net/barney/Na7tZ/)，我已经实现了基本命题——尽管你可能想要将边框移动到伪元素或调整尺寸以使其定位正确。

我所做的基本指南：

1.  给出`.row`CSS `position: relative`，以便我们可以放置与其相关的子级。
2.  将规则中除背景属性之外的所有内容移至`.row:hover`新`.row:hover:after`规则。
3.  添加`content: ' '`以强制显示伪元素。
4.  添加定位、高度和宽度、顶部和左侧以使伪元素覆盖可用宽度。

**编辑：** Felipe在评论中*指出*，任何点击进入对象的尝试都`.row`将被`:after`元素拦截，但建议您可以使用[指针事件](https://developer.mozilla.org/en-US/docs/CSS/pointer-events)设置`pointer-events: none`来缓解问题（在[IE 和 Opera 以外的所有内容](http://caniuse.com/#feat=pointer-events)中）。我已经[更新了我的示例以显示这一点](http://jsfiddle.net/barney/Na7tZ/)。

# c# - 接收 LINQ IGrouping 作为参数的方法

> ID：14967311
> 
> 赞同：0
> 
> 时间：2013-02-19T20:59:59.417
> 
> 标签：c#, linq, linq-to-entities

**编辑 3：改进的问题措辞和示例**

我有以下使用分组的 linq 查询。分组和选择操作很复杂，因此我将其中一个选择抽象为一种方法，该方法对如何呈现数据做出一些选择。

我的查询在匿名组定义中可以正常工作，但是一旦我将其键入一个类以便将其作为 IGrouping 对象传递给一个方法，它就会停止对结果进行分组。

```
public class TestController : Controller
{
    public JsonResult ThisWorks()
    {
        var valueList = DataMocker.GetTestValues();

        var group = from v in valueList.AsEnumerable()
                    where (v.Data != 0)
                    group v by new 
                                   {
                                       Year = v.Fecha.Value.Year,
                                       Trimester = string.Empty,
                                       Month = v.Fecha.Value.Month,
                                       Day = 0,
                                   }
                        into g
                        select new SeriesDataPoint
                                                     {
                                                         y = g.OrderByDescending(obd => obd.Fecha)
                                                                  .Select(obd => obd.Data.Value)
                                                                  .FirstOrDefault(),

                                                         color = "black",
                                                         month = g.Key.Month,
                                                         year = g.Key.Year,
                                                         seriesName = "Test Series",
                                                     };

        return Json(group, JsonRequestBehavior.AllowGet);
    }

    public JsonResult ThisDoesnt()
    {
        var valueList = DataMocker.GetTestValues();

        var group = from v in valueList.AsEnumerable()
                    where (v.Data != 0)
                    group v by new Models.SeriesResultGroup
                    {
                        Year = v.Fecha.Value.Year,
                        Trimester = string.Empty,
                        Month = v.Fecha.Value.Month,
                        Day = 0,
                    }
                        into g
                        select new SeriesDataPoint
                        {
                            y = RenderDataPoint(valueList, g),
                            color = "black",
                            month = g.Key.Month,
                            year = g.Key.Year,
                            seriesName = "Test Series",
                        };

        return Json(group, JsonRequestBehavior.AllowGet);
    }

    public static decimal? RenderDataPoint(List<Models.ValoresResultSet> valores, IGrouping<Models.SeriesResultGroup, Models.ValoresResultSet> group)
    {
        return group.OrderByDescending(obd => obd.Fecha)
                    .Select(obd => obd.Data.Value)
                    .FirstOrDefault();
    }
} 
```

*   这是正确的输出：[https ://dl.dropbox.com/u/9764/Thisworks.txt](https://dl.dropbox.com/u/9764/Thisworks.txt)
*   这是错误的输出：[https ://dl.dropbox.com/u/9764/ThisDoesnt.txt](https://dl.dropbox.com/u/9764/ThisDoesnt.txt)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T00:14:17.527

在第一种情况下，您按匿名类型分组，由编译器生成。这种类型还生成了 Equals 和 HashCode 覆盖（您可以通过 ildasm 检查它）。匿名类型的默认 Equals 为每个字段运行相等比较器。我认为这是为在这种情况下使用而设计的。

在第二种情况下，您按自定义类型分组。由于它是引用类型，默认相等比较器通过引用比较对象。因为在分组之前你会产生一系列对象，每个对象都是独一无二的。所以默认相等检查认为它们不同。

解决方案是（选择任何一个）：

1.  覆盖 Equals 和 HashCode。
2.  制作类型`struct`而不是`class`

小心不要忘记实现 HashCode。

# java - java File.listFiles() 顺序无法保证并导致 JUnit 测试失败

> ID：14967314
> 
> 赞同：0
> 
> 时间：2013-02-19T21:00:19.410
> 
> 标签：java, junit

我遇到了一个有趣的情况，因为 java 的 File.listFiles() 方法返回目录中的文件列表，而对顺序没有任何保证。一个类使用此 listFiles() 方法从目录中的所有文件中读取一些信息并写入 OutputStream。相应的 JUnit 测试用例尝试将写入输出流的数据与一些预期的 byteArray 进行比较。测试在我的开发机器和生产堆栈上通过，但在开发服务器上失败，因为它使用不同的操作系统和不同版本的 Java。

在[File.listFiles 中如何按字母顺序排列？](https://stackoverflow.com/questions/7199911/how-to-file-listfiles-in-alphabetical-order)解决方案是强制对从 File.listFiles() 返回的数组进行排序。但我对这个解决方案并不满意，因为它正在做一些额外的工作，只是为了让 JUnit 测试能够通过。

所以我只是想知道是否有更好的方法。有什么建议吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:15:27.200

我看不出总是对列表进行排序有问题。您不仅是为了单元测试而这样做：减少系统中的随机性通常是一个好主意（它使测试更容易，当问题发生时，它更容易重现）。确实，您正在做额外的工作，但除非您正在阅读成千上万的文件，否则排序不太可能成为瓶颈（当然，定期分析）。

所以在我看来，排序是最好的选择。

如果您不想/不能这样做，另一种选择是使单元测试更智能；例如，不要一次比较整个 byteArray，而是检查总大小以及每个文件的结果是否存在于数组中。或者在测试中解析和排序数组（尽管这可能很复杂）。

# html - 无法在 IE10 上获得相同来源的 iframe 正文？

> ID：14967316
> 
> 赞同：2
> 
> 时间：2013-02-19T21:00:20.200
> 
> 标签：html, iframe, internet-explorer-10, specifications

我创建了一个带有空 iframe 的页面。然后我可以选择 iframe 文档并导航到它的正文：

```
var iframe = document.getElementsByTagName('iframe')[0];
var doc = iframe.contentDocument || iframe.contentWindow.document;
var body = doc.body;
console.log("Body is", body); 
```

在 Firefox 和 chrome 中，这给了我 body 对象。在 IE10 中它给了我空值。

[这是一个演示该问题的 Jsbin。](http://jsbin.com/odabeq/1/edit)打开 JS、控制台、输出面板，然后单击“使用 JS 运行”。

两个问题：

1.  如何以跨浏览器的方式访问 iframe 的主体？
2.  哪个是正确的“符合规范”的行为？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T00:50:18.353

我今天早些时候遇到了类似的问题。似乎 IE，至少 9 和 10，没有正确创建 iframe 主体（当我使用开发人员工具时，我能够在 iframe 中看到一个主体标签，但就像你无法调用它一样），当没有指定的src。它给你 null 因为它不存在。

对于是否有跨浏览器方式访问 iframe 的正文，答案是否定的。但是，您可以使用解决方法。首先，检查 iframe body 是否存在，如果不存在，则创建它。

您的代码如下所示：

```
var iframe = document.getElementsByTagName('iframe')[0];
var doc = iframe.contentDocument || iframe.contentWindow.document;

// The workaround
if (doc.body == null) {       // null in IE
    doc.write("<body></body>");
}

var body = doc.body;
console.log("Body is", body); 
```

来源：[http ://forums.asp.net/t/1686774.aspx/1](http://forums.asp.net/t/1686774.aspx/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T01:15:53.193

此代码适用于我的跨浏览器：

```
var doc=ifr.contentWindow||ifr.contentDocument;
if (doc.document) doc=doc.document;
var body=doc.getElementByTagName("body")[0]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-28T19:34:33.447

一年多后，但我相信解决方案是致电

```
doc.open()
//make any modifications
doc.close()
//at this point doc.body will not be null 
```

这使得事情以相当一致的方式跨浏览器工作

# android - 删除保存的列表视图中的所有内容，并在每次新更新时加一

> ID：14967317
> 
> 赞同：1
> 
> 时间：2013-02-19T21:00:19.600
> 
> 标签：android, listview, increment

我正在尝试编写一组名称并将它们保存在列表视图中，但是我需要每次可以更新列表时清除其中的所有内容并添加所有新更新，并且列表动态具有增量每次更新都会增加一。

我该怎么做，因为我被保存的列表卡住了，无法删除任何旧的编队，非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:17:55.510

You should create an Adapter, it will contain the info displayed in the ListView. If you want to remove all the info displayed in the ListView, just remove the info contained in the Adapter, set a new one and notifyDataChanged().

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:46:02.170

使用 sqlite 存储列表数据并使用 CursorAdapter 填充列表。当您将项目添加到表中时，它将显示在您的列表视图中。[在这里](http://developer.android.com/training/basics/data-storage/databases.html)查看有关在 android 中使用 sqlite 数据库的更多信息。

# javascript - 如何更改第一个孩子的属性

> ID：14967321
> 
> 赞同：0
> 
> 时间：2013-02-19T21:00:42.527
> 
> 标签：javascript, css, parent-child

我可以更改此元素的背景颜色：

```
<div onmouseover="this.style.backgroundColor='blue'" onmouseout="this.style.backgroundColor='red'" style="background-color:green; width:100px; height:40px;">
</div> 
```

但我想改变第一个孩子的颜色，我认为它应该像这样工作：

```
<div onmouseover="this.firstChild.style.backgroundColor='blue'" onmouseout="this.firstChild.style.backgroundColor='red'" style="background-color:green; width:100px; height:40px;">

  <div style="background-color:white; height:10px; width:10px; margin:20px;">This is the first child, I think.</div>

</div> 
```

但它不起作用。怎么了？如何更改 firstChild 的样式？

PS：我稍后想为孩子使用 display=block 和 none 以及其他一些属性（不仅仅是样式）。颜色只是为了测试。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T21:07:44.513

正如“系统”所提到的，您的目标是文本节点而不是元素节点。尝试使用`children[0]`而不是`firstChild`.

[jFiddle在这里](http://jsfiddle.net/rfpLS/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T21:04:02.457

您需要使用`.firstElementChild`，或者您需要摆脱格式化空格。该空白成为文本节点，即`.firstChild`.

某些较旧的浏览器不支持该`.firstElementChild`属性，因此如果您支持这些，则需要使用函数对其进行填充。

* * *

```
<div onmouseover="changeColor(this, 'blue')" onmouseout="changeColor(this, 'red')" style="background-color:green; width:100px; height:40px;">

  <div style="background-color:white; height:10px; width:10px; margin:20px;">This is the first child, I think.</div>

</div> 
```

* * *

```
function changeColor(el, color) {
    firstElemChild(el).style.backgroundColor=color;
}
function firstElemChild(el) {
    if (el.firstElementChild)
        return el.firstElementChild;

    el = el.firstChild

    while (el && el.nodeType !== 1)
        el = el.nextSibling;

    return el;
} 
```

# c - 为什么我的子进程被父进程等待而没有完成任何工作？

> ID：14967326
> 
> 赞同：0
> 
> 时间：2013-02-19T21:01:11.963
> 
> 标签：c, process, pipe, children, fork

我确信这是相当简单的事情，但对于我的生活，我无法弄清楚为什么我的子进程没有工作，等待，然后最后一个正在暂停（就像我没有正确关闭管道）。无论如何，我会发布一堆代码，但这就是它正在做的事情：

1.  该程序解析一个 txt 文档并获取所有单个单词，并将它们沿管道循环样式发送到指定数量的子进程。我有一个一维数组，它保存管道 FD，每个偶数索引都是读取，每个奇数索引都是写入管道。

2.  解析完成后，程序在分叉子级之前关闭读/写管道（关闭与父级的管道）。然后，在一个 for 循环中，产生指定数量的子进程，并在子进程中关闭相应管道的写入端，并打开读取端。fgets 必须用于从管道获取输入（我知道，烦人，但这是一个要求）。

3.  子进程完成后，它会被父进程等待。有一些我试图帮助我的注释和调试器行，从它们看来，子进程似乎被分叉并正确输入，写管道关闭，读管道打开，但是当我这样做时fgets() 函数，它立即退出并由父级等待。有趣的是，并不是所有的孩子都得到等待。如果我希望孩子的数量为 3，则等待 2 个进程，第 3 个进程挂断。如果我想要 10 个进程，则等待 5 个进程，而第 6 个进程挂断。

所以，我很确定它与 fgets() 有关，但我不知道为什么！我有一种预感，这可能与换行符在沿管道发送时出现在错误的位置有关（fgets 一直读取到换行符，对吗？）但基于编写的代码和一些额外的调试语句，输入到来自父进程的管道似乎已正确终止换行符。

无论如何，这里是解析器的代码，然后是创建孩子的代码——

解析器：

```
char buf[PIPE_BUF];     
int wordCount;

char buffer[PIPE_BUF];
char *temp;
char word[50];
FILE* inputFile = fopen(fileName,  "r"); //OPENS file
//Parsing and distributing words round robin to pipes
while(fgets(buffer, (sizeof buffer), inputFile)){
    //remove all non-alpha chars in buffer and converts to lowercase
    int i;
    for(i = 0; i < strlen(buffer); i++){
        if(isalpha(buffer[i]) == 0){ //0 means it is not a letter
            buffer[i] = ' ';
        }
        else{
            buffer[i] = tolower(buffer[i]); //turn the current word to lower case
        }
    }
    //parse words and sends them to the sort processes in a round-robin fashion
    temp = strtok(buffer, " "); //splits along spaces
    if(temp != NULL){
        strcpy(word, temp);
        strcat(word, "\n"); //puts newline at the end
    }
    int j = 0;
    while(temp != NULL){
        FILE *input = fdopen(pipefds[(j*2)+1], "w");
        //close(pipefds[j*2]); //closing read pipes in parent
        fputs(word, input); //puts into write pipe
        printf("fputs done successfully with pipe %d with contents: %s\n", pipefds[(j*2)+1], word);
        //close(pipefds[(j*2)+1]); //closing write pipe after write is done
        temp = strtok(NULL, " ");
        if(temp != NULL){
            strcpy(word, temp);
            strcat(word, "\n");
        }
        if(j == (numChildren - 1)){
            j = 0;
        }
        else{
            j++;
        }
    }
}
//need to close all parent writes, and parent reads (it's done with everything)
for(i = 0; i < numChildren; i++){
    close(pipefds[i]);
} 
```

父分叉和获取管道数据：

```
//Collection of children need to be created specified by numChildren
int count;
for(count = 0; count < numChildren; count++){
    printf("Count: %d\n", count);

    switch((p = fork())){

    case -1:
        perror("Could not create child");
        exit(-1);

    case 0:
        printf("Entering child\n");
        //child case, GET INPUT FROM PARENT TO SORT!!! SEND TO SUPPRESSOR (Uses both input and output)
        //count[0] = read, count[1] = write
        close(pipefds[(count*2)+1]); //closing write pipes in child
        printf("write pipe closed in child\n");
        FILE *output = fdopen(pipefds[count*2], "r"); //opening the read pipe from the parent write pipe
        printf("read pipe opened in child\n");
        fgets(buf, PIPE_BUF, output); //gets data from read pipe
        printf("child read pipe contents read (fgets) with buf contents: %s\n", buf);
        printf("child read pipe closed (%d)\n", getpid());
        //execlp("sort", "sort", sortStuff,(char*)NULL);
        close(pipefds[count*2]); //closing read pipe after reading is done
        count = numChildren;
        break;

    default:
        //parent case -- p holds pid of child

        printf("I am the parent, PID: %d\n", getpid());
        child = wait(&status);
        printf("Waited on child %d\n", child);

        break;
    }

} 
```

我提前为代码道歉，我不是最好的 C 程序员，所以事情往往会变得有点混乱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T23:12:16.513

主要问题在于这段代码：

```
// need to close all parent writes, 
// and parent reads (it's done with everything)

for(i = 0; i < numChildren; i++){
  close(pipefds[i]); 
```

您在创建子进程之前执行此操作（它出现），通过这样做，您基本上删除了管道。他们走了。它们不再存在。子进程没有什么可以读取的。我的猜测是这一行：

```
FILE *output = fdopen(pipefds[count*2], "r"); 
```

失败（输出为 NULL），因为文件描述符已经关闭，因此，就系统而言，它是一个无效的描述符。

另一个问题是您的步骤顺序。通常，您创建一个管道，然后创建一个子进程，并且只有在子进程完成后您才会关闭该管道。我认为我从未见过写入管道，*然后*创建子进程以从中读取的实现，因为这样做存在一个大问题：管道的大小有限，并且父进程可以阻止写入到管道（我怀疑您有一个要测试的小文件，因此没有达到管道的大小限制）。

我建议的步骤顺序是：

```
create the pipes
create the child processes
in the parent process
    close the read end of each pipe (only the read end)
    read the text file
    write words to the pipes
    when done reading text file, close the write end of each pipe
    wait for each child 
in the child process(es)
    close the write end of the pipe its using
    while there is input from the pipe
      read the input
      do whatever
    close the read end of the pipe
    _exit() 
```

这样，您实际上获得了多处理的好处，并且您不必担心父进程在写入时会无限期地阻塞（因为总是有一个子进程在读取）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:24:55.007

当您使用此函数将 FILE* 与描述符关联时：

文件 *input = fdopen(pipefds[(j*2)+1], "w");

那么除了管道中*进行的任何缓冲之外，*您对 *input 所做的任何事情都将被缓冲。因此，有可能您*认为*您正在写入管道的任何内容实际上只是位于 FILE* 的缓冲区中而从未真正到达管道。如果您使用 fclose(input) 缓冲区将在最后被刷新，但我认为您正在关闭底层文件描述符，而不是 FILE*，这意味着 FILE* 的所有缓冲区管理都不知道它应该完成向上。

调用 fflush(input) 可能会有所帮助。

另外，更深层次的是，如果您在开始读取之前将*所有*数据写入管道，您应该知道管道在不再接受任何输入之前可以缓冲的内容是有限的（直到从另一端读出一些东西。）

编辑：总结，我认为您的数据卡在 FILE* 缓冲区中，甚至从未到达管道。没有脸红。此外，您可能应该在某个地方调用 fclose(input)，这将影响您对 close() 底层文件描述符的需要。

# javascript - 获得更准确的浮点计算

> ID：14967327
> 
> 赞同：0
> 
> 时间：2013-02-19T21:01:12.817
> 
> 标签：javascript, floating-accuracy

我正在使用由 JavaScript 提供支持的 canvas 元素构建游戏。我的播放器类的一部分包括一个`update()`每滴答声调用一次的方法。在这种方法中，我正在做一些数学运算来根据键盘输入更新玩家的速度并移动玩家。这是该代码的一部分：

```
// Gradually make the players velocity 0
if(this.xv > 0) {
    this.xv -= 0.1;
} else if(this.xv < 0) {
    this.xv += 0.1;
}
if(this.yv > 0) {
    this.yv -= 0.1;
} else if(this.yv < 0) {
    this.yv += 0.1;
}

// Update player position based on velocity
this.x += this.xv;
this.y += this.yv;

// Update velocity based on keyboard inputs
if(keyState[87]) {
    this.yv -= 0.5;
}
if(keyState[65]) {
    this.xv -= 0.5;
}
if(keyState[83]) {
    this.yv += 0.5;
}
if(keyState[68]) {
    this.xv += 0.5;
} 
```

现在理论上这一切都可以正常工作，如果玩家按住 W 键 4 刻，他们的速度将是`2`，然后再过 40 刻之后，他们的速度将降低到`0`。

但这在实践中不起作用，因为 JavaScript 在处理浮点数时似乎并不完全准确。如果我`console.log()`每场比赛的速度变量我得到这种输出：

```
x: -1.0241807402167069e-14           y: -1.379452108096757e-14
x: 0.09999999999998976           y: 0.09999999999998621
x: -1.0241807402167069e-14           y: -1.379452108096757e-14
x: 0.09999999999998976           y: 0.09999999999998621 
```

所以这里有两件事看起来不对，一是 JavaScript 从来没有以良好的精度计算速度，另一个是当速度为负时，它总是至少`-1`，这是一个问题，因为玩家精灵现在将以 1 个像素的速度移动打钩。

我怎样才能为这项任务获得更准确的计算？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:31:52.287

我建议使用“指数衰减”方法来平滑您的速度过渡。而不是您当前用于将速度降低到零的条件块，我将使用以下内容：

```
this.xv *= 0.9;
this.yv *= 0.9; 
```

请注意，这会将您的最大速度限制为恒定加速度的十倍，并且改变衰减率将改变该乘数。这可能没问题，但如果不是，您可以调整方程以简化为目标速度：

```
var p = 0.9;
var q = 1.0 - p;
this.xv = this.xv * p + this.txv * q;
this.yv = this.yv * p + this.tyv * q; 
```

**免责声明：** 这在牛顿物理学中没有真正的基础；这只是我想出的帮助平滑机器人状态转换的方法。但这对我很有用，希望对你也有用。

# java - 测量视频流质量

> ID：14967332
> 
> 赞同：1
> 
> 时间：2013-02-19T21:01:28.253
> 
> 标签：java, video-streaming

我正在开发一个应用程序来测量来自网站的视频流质量，并且我正在使用 Java。我在网上搜索了一下，但找不到任何指针或资源。我需要做什么来测量视频流质量？非常感谢任何编写 Java 代码来实现这一点的提示/指针。

# c# - 在 64 位计算机上扫描 C# byte[] 两个字节并返回位置的最快方法是什么？

> ID：14967333
> 
> 赞同：3
> 
> 时间：2013-02-19T21:01:30.243
> 
> 标签：c#, bytearray, micro-optimization

我有一个内存`byte[]`，需要找到偏移的位置`13`和`10`位置。然后，我将使用以下内容提取该行：

```
 String oneLine = Encoding.ASCII.GetString(bytes, 0, max); 
```

在 x64 位计算机上搜索两个字节的最快方法是什么？..并将其转换为字符串？

除了遍历每个字节，扫描`13`然后扫描之外，我还能做些什么`10`吗？

```
// Disclaimer: 
// This is just for my curiosity.  Perhaps I'll gain a better understanding of
// how .NET interfaces with RAM, the CPU instructions related to comparisons, etc.
//  
// I don't suspect a performance problem, but I do suspect a lack of understanding
// (on my part) on how C# does low-level operations. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:46:52.160

不确定它是否是“最快的方式”，但您可以查看 Boyer-Moore 算法来查找所需值的索引。

看看这个 SO 线程[在 C# 中的字节数组中搜索最长模式](https://stackoverflow.com/questions/9889427/search-longest-pattern-in-byte-array-in-c-sharp)

Boyer-Moore 会比线性数组遍历更好，因为它可以根据“针”的长度跳过元素，并且随着“干草堆”变大它会变得更好。HTH。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T23:04:03.983

由于您正在寻找一个两个字节的序列，因此您不必扫描每个字节，只需每隔一个字节即可。如果目标索引包含 13，则查看下一个字节是否为 10。如果目标索引包含 10，则查看前一个字节是否为 13。与线性搜索相比，这应该将您的扫描时间减少大约一半。

# java - Java EE 中的双工流式传输

> ID：14967335
> 
> 赞同：1
> 
> 时间：2013-02-19T21:01:33.343
> 
> 标签：java, performance, jakarta-ee, scalability, ejb-3.1

我正在寻找一个带有 Java EE 的全双工流解决方案。

情况：客户端应用程序 (JavaFX) 从外围设备读取数据。这些数据需要近乎实时地传输到服务器进行处理，并且还需要异步返回响应，同时不断发送新数据进行处理。

与服务器的通信需要有尽可能低的开销。传入的数据基本上是一些传感器数据，经过处理后，它们被转入可以描述为一组命令的内容。

我调查的内容：

1.  TCP/IP 服务器（这是一种非 Java EE 方法）。这将是显而易见的解决方案。从每个客户端应用程序并行打开两个连接：一个用于上游数据，一个用于下游数据。
2.  远程和无状态 EJB。这意味着不涉及流式传输，并且我将传感器数据打包在较小的窗口中（价值 1-2 秒的传感器数据），然后我将其发送到服务器进行处理并获取处理结果作为响应。对于这种方法，虽然它是可扩展的，但考虑到我必须每 1-2 秒发出一个请求，我不确定它的速度有多快。我仍然需要对此进行测试，但我对此表示怀疑。
3.  RMI。从技术上讲，这与 EJB 有什么不同吗？
4.  两个带有长轮询的 servlet（上/下）。我以前没有这样做过，所以有待测试。

现在我想测试我的方法 #2 的性能。第一个解决方案肯定会起作用，但我不太喜欢拥有一个单独的服务器（在 Tomcat 旁边，我已经在其中运行了一些东西）。

但是，与此同时，值得了解是否有任何其他 Java 特定（EE 或非 EE）技术可以轻松解决这个问题。如果有人有想法，请分享。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T06:49:45.880

这看起来是使用[JMS](http://docs.oracle.com/javaee/6/tutorial/doc/bncdq.html)的好地方。您可能会使用[消息驱动 Bean](http://docs.oracle.com/javaee/6/tutorial/doc/bnbpk.html) ，而不是无状态 EJB 。

这为您提供了一种类似于您的第一个解决方案的方法，使用两个消息队列而不是 TCP/IP 连接。JMS 使您的通信完全异步并且开销很低，因为无论您的服务器可以多快地使用它们，您的客户端都可以尽可能快地发送消息。您还可以获得交付保证和其他 JMS 优点。

然而，Tomcat 不附带 JMS。您可以尝试[使用 TomEE](http://tomee.apache.org/tomcat-jms.html)或将现有的 Tomcat 与[ActiveMQ](http://activemq.apache.org/tomcat.html#Tomcat-ManuallyintegratingTomcatandActiveMQ)等 JMS 实现集成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T07:05:30.843

您可以尝试多种选择。适当的解决方案取决于您的应用程序的性质、通信协议、数据传输类型、您对客户端和服务器的控制以及对客户端服务器路由的防火墙限制。

您的问题中没有太多关于此的信息，但鉴于您提供的内容，您可能希望查看[netty](https://github.com/netty/netty)，因为它非常通用且灵活，并且似乎符合您的要求。Netty 还包括一个双工 websocket 实现。请注意，与其他一些解决方案（例如 jms）相比，基于 netty 的解决方案实施起来可能更复杂，并且需要更多的背景研究。

[GraniteDS](http://www.graniteds.org/public/docs/3.0.0/docs/reference/java/en-US/html/graniteds.messaging.html#messaging.configuration)中的另一种可能的解决方案，它宣传 JavaFX 客户端集成和多服务器集成以实现全双工客户端/服务器通信，尽管我没有使用它。GraniteDS 使用 Comet（您的两个具有长轮询模型的异步 servlet）和 Active Message Format 来处理您可能熟悉的来自 Flex/Flash 的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T06:21:21.937

您是否将 websockets 视为解决方案？众所周知，它们会保持持久连接，因此异步响应会很快。

# ruby-on-rails - Rails 3 - ActiveRecord::ConnectionNotEstablished

> ID：14967336
> 
> 赞同：1
> 
> 时间：2013-02-19T21:01:45.103
> 
> 标签：ruby-on-rails, rails-activerecord, jrubyonrails

我收到以下错误

> ActiveRecord::ConnectionNotEstablished

在我像这样更改我的 database.yml 文件后，在新创建的项目上：

```
development:
  adapter: jdbc
  driver: com.ibm.db2.jcc.DB2Driver
  url: localhost:50000/devdb
  host: localhost
  port: 50000
  database: devdb
  username: db2inst1
  password: mypass 
```

这是框架跟踪：

```
activerecord (3.2.12) lib/active_record/connection_adapters/abstract/connection_pool.rb:410:in `retrieve_connection'
activerecord (3.2.12) lib/active_record/connection_adapters/abstract/connection_specification.rb:171:in `retrieve_connection'
activerecord (3.2.12) lib/active_record/connection_adapters/abstract/connection_specification.rb:145:in `connection'
activerecord (3.2.12) lib/active_record/query_cache.rb:67:in `call'
activerecord (3.2.12) lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
actionpack (3.2.12) lib/action_dispatch/middleware/callbacks.rb:28:in `call'
activesupport (3.2.12) lib/active_support/callbacks.rb:408:in `_run__850430336__call__306646959__callbacks'
org/jruby/RubyBasicObject.java:1659:in `__send__'
org/jruby/RubyKernel.java:2086:in `send'
activesupport (3.2.12) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.12) lib/active_support/callbacks.rb:390:in `_run_call_callbacks'
org/jruby/RubyBasicObject.java:1659:in `__send__'
org/jruby/RubyKernel.java:2086:in `send'
activesupport (3.2.12) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.12) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.12) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.12) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.12) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.12) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.12) lib/rails/rack/logger.rb:32:in `call_app'
railties (3.2.12) lib/rails/rack/logger.rb:16:in `call'
activesupport (3.2.12) lib/active_support/tagged_logging.rb:22:in `tagged'
railties (3.2.12) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.12) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.5) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.5) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.12) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.5) lib/rack/lock.rb:15:in `call'
actionpack (3.2.12) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.12) lib/rails/engine.rb:479:in `call'
railties (3.2.12) lib/rails/application.rb:223:in `call'
rack (1.4.5) lib/rack/content_length.rb:14:in `call'
railties (3.2.12) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.5) lib/rack/handler/webrick.rb:59:in `service'
/home/gotqn/.rvm/rubies/jruby-1.7.2/lib/ruby/1.9/webrick/httpserver.rb:138:in `service'
/home/gotqn/.rvm/rubies/jruby-1.7.2/lib/ruby/1.9/webrick/httpserver.rb:94:in `run'
/home/gotqn/.rvm/rubies/jruby-1.7.2/lib/ruby/1.9/webrick/server.rb:191:in `start_thread' 
```

你能告诉我我可以尝试什么来解决这个问题或帮助理解这个痕迹吗？我将不胜感激一些有关理解跟踪的文档或教程，因为我是 Rails 新手。

我在用：

1.  Ubuntu 12.04 LTC
2.  JRuby 1.7.2
3.  导轨 3.2.12
4.  DB2 C 速成版 10.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T17:59:45.337

The error was due to incorrect syntax when the url was specified in the **database.yml** file. This is the correct way:

```
development:
  adapter: jdbc
  driver: com.ibm.db2.jcc.DB2Driver
  url: jdbc:db2://localhost:50000/devdb
  host: localhost
  port: 50000
  database: devdb
  username: db2inst1
  password: mypass 
```

# java - 为什么 javax.servlet 包仅作为应用服务器的一部分分发？

> ID：14967338
> 
> 赞同：1
> 
> 时间：2013-02-19T21:01:54.180
> 
> 标签：java, jakarta-ee, servlets

我对 servlet 并不陌生。但我仍然很好奇：为什么`javax.servlet`包不是自己分发的？为什么在编译代码之前需要安装一些应用程序服务器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T21:09:39.487

简短的回答，它是单独分发的。

Servlet 是一个规范和一个 API。如果您需要 JAR，请从规范站点[Servlet Spec 3.0](http://download.oracle.com/otndocs/jcp/servlet-3.0-fr-eval-oth-JSpec/)下载它。

显然，如果您想实际部署您的应用程序，您仍然需要一个实现（即服务器）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T21:10:05.980

servlet API 可通过一些 jar 获得，您可以随心所欲地使用它。在 Maven 上它就在[这里](http://mvnrepository.com/artifact/javax.servlet/servlet-api)。您可以在没有任何应用程序服务器的情况下编译代码，但它可能无法满足您的要求。毕竟只是一个界面

Servlet 仅在 Web 应用程序的上下文中真正相关，这就是存在 Servlet 容器的原因。他们是执行。看看容器在请求到达 servlet 之前所做的所有工作：[Tomcat 序列图](http://tomcat.apache.org/tomcat-7.0-doc/architecture/requestProcess/requestProcess.pdf)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T01:43:00.340

Servlet 与 EJB 等其他 Java EE 技术一样，是来自[Java Community Process Program的](http://www.jcp.org/)[JSR](http://en.wikipedia.org/wiki/JSR)（Java 规范请求）规范

应用服务器供应商有责任根据发布的规范提供实施。在这种情况下 - 对于[Servlet 2.5](http://jcp.org/aboutJava/communityprocess/mrel/jsr154/index.html) - 对于[Servlet 3.0](http://jcp.org/aboutJava/communityprocess/final/jsr315/index.html)

Sun / now Oracle 确实`javax.servlet`单独发布了该软件包，您可以从[Maven Repository](http://mvnrepository.com/artifact/javax.servlet/servlet-api)下载它，它也可以在任何 J2ee 投诉应用程序服务器/Web 容器的 lib 文件夹中找到。即对于 Tomcat，它在**TOMCAT_HOMEDIR/lib/servlet-api中可用**

所以对于`developing and compiling , this jar is sufficient`，你只会`need the Application server only when you want to actually deploy your application`。

# asp.net-mvc - 在 MVC 中的耗时操作中如何使用 AsyncController 或 Task 或 Thread？

> ID：14967344
> 
> 赞同：5
> 
> 时间：2013-02-19T21:02:07.823
> 
> 标签：asp.net-mvc, asp.net-mvc-4, async-await

我有一个简单但耗时的操作：当用户单击一个按钮时，它会执行数据库密集型操作，将导入表中的记录处理到其他多个表中，一次导入一条记录。我有一个带有触发操作的按钮的视图，并在操作结束时显示报告。

我正在寻找通知用户正在处理操作的方法。[这是](http://msdn.microsoft.com/en-us/library/ee728598%28v=vs.100%29.aspx)我喜欢的解决方案。

我一直在网上阅读有关 MVC 中的异步操作的信息。我发现许多链接说如果您的进程受 CPU 限制，请坚持使用同步操作。数据库相关进程是否被视为 CPU 受限？

[此外，如果我得到了异步操作路线，我应该使用此处](http://msdn.microsoft.com/en-us/library/ee728598%28v=vs.100%29.aspx)描述的 AsyncController还是仅使用我提到的示例中的 Task 以及[此处](http://www.asp.net/mvc/tutorials/mvc-4/using-asynchronous-methods-in-aspnet-mvc-4)的示例。还是它们都一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T02:35:25.997

假设 C# 5.0，我会做这样的事情如下：

```
// A method to get your intensive dataset
public async Task<IntensiveDataSet> GetIntensiveDataSet() {
   //in here you'll want to use any of the newer await Async calls you find 
   // available for your operations. This prevents thread blocking.

    var intensiveDataSet = new IntensiveData();
    using (var sqlCommand = new SqlCommand(SqlStatement, sqlConnection))
        {
            using (var sqlDataReader = await sqlCommand.ExecuteReaderAsync())
            {
                while (await sqlDataReader.ReadAsync())
                {
                    //build out your intensive data set.
                }
            }
        }
    return intensiveDataSet;
}

// Then in your controller, some method that uses that:
public async Task<JsonResult> Intense() {
    return Json(await GetIntensiveDataSet());
} 
```

在您的 JS 中，您可以这样称呼它（使用 JQuery）：

```
$.get('/ControllerName/Intense').success(function(data) {
   console.log(data);
}); 
```

老实说，我只是在它运行时展示某种微调器。

如果您确实需要向用户提供某种反馈，则必须在整个异步调用期间对用户的 Session 进行更新......并且为了做到这一点，您需要传递对该 Session 的引用。然后，您只需添加另一个简单的 JsonResult 操作，该操作检查 Session 变量中的消息并使用 JQuery 定期轮询它。不过好像有点矫枉过正。在大多数情况下，简单的“这可能需要一段时间”对人们来说就足够了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T03:43:24.513

您需要知道的第一件事是它[`async`不会改变 HTTP 协议](http://blog.stephencleary.com/2012/08/async-doesnt-change-http-protocol.html)。正如我在博客中所描述的，HTTP 协议为每个请求提供一个响应。因此，您不能在说它“正在进行中”后再次返回说它“已完成”。

简单的解决方案是仅在完成时返回，并使用 AJAX 在客户端抛出一些“正在进行中......”通知，在请求完成时更新页面。如果您想变得更复杂，您可以使用 SignalR 之类的东西让服务器在请求完成时通知客户端。

特别是，`async`MVC 操作不会返回“早期”；ASP.NET 将等待所有异步操作完成，*然后*发送响应。`async`服务器端的代码都是关于可伸缩性的，而不是响应能力。

也就是说，我通常建议在服务器端使用异步代码。一个例外是如果您只有一个数据库后端（[在这篇博](http://blogs.msdn.com/b/rickandy/archive/2009/11/14/should-my-database-calls-be-asynchronous.aspx)文中进行了很好的讨论）。如果您的后端是数据库集群或分布式/NoSQL/SQL Azure DB，那么您应该考虑使其异步。

如果你决定让你的服务器异步，只需 return `Task`s; `AsyncController`这些天只是为了向后兼容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T02:13:44.050

您应该考虑使用 AJAX 实现异步的选项。您可以直接在您的视图中处理客户端“...处理”消息，而且麻烦最少，

```
$.ajax({
    url: @Url.Action("ActionName"),
    data: data
}).done(function(data) {
    alert('Operation Complete!');
});

alert('Operation Started');

// Display processing animation 
```

在服务器端处理异步调用可能是昂贵、复杂和不必要的。

# jquery - JQuery UI 选项卡 - 我想在单击按钮后将其从页面中删除

> ID：14967346
> 
> 赞同：0
> 
> 时间：2013-02-19T21:02:11.313
> 
> 标签：jquery, asp.net, jquery-ui, jquery-ui-tabs

我希望包含这些选项卡的面板完全隐藏：

我有这段代码：

```
<asp:Button ID="Button2" runat="server" Text="Hide Tree" onclick="Button2_Click1"   onclientclick="hideTabs()" />

<script type="text/javascript">
function hideTabs() {
        $("#tabs").hide();
    }
</script>

//C#
protected void Button2_Click1(object sender, EventArgs e)
{
              TreeView1.Visible = false;
} 
```

我的标签设置

*   树
*   搜索

..废话

我究竟做错了什么？按下按钮后 TreeView 会消失，但 JQuery UI 选项卡不会消失。我在 jQuery 语法上做错了吗？

页面看起来正在刷新，这可能是一个线索。

# php - 显示存储在数据库中的图像而不使用标题

> ID：14967351
> 
> 赞同：2
> 
> 时间：2013-02-19T21:02:25.187
> 
> 标签：php, mime-types, content-type

我喜欢使用以下代码保存在视图中的照片，但问题是我无法播放，因为我需要`header('Content-Type: image/jpeg');`实现然后显示。，但我有订单之前`header('Content-Type: image/jpeg');`我应该​​怎么做才能显示没有标题的图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:04:43.397

如果您只输出图像，那么在它之前是否有其他 PHP 指令也没关系，因为唯一的输出应该是图像。

如果您尝试将图像直接输出到 HTML 文档中，请考虑使用数据 URI：

```
<img src="data:image/jpeg;base64,<?php echo base64_encode($imagedata); ?>" /> 
```

# python - Python TypeError：“类型”对象不可下标

> ID：14967357
> 
> 赞同：0
> 
> 时间：2013-02-19T21:02:41.393
> 
> 标签：python

我编写了一个简单的 for 循环来提取目录中的所有 mps 文件。

```
for root, dirs, files in os.walk(rootDir, topdown='true'):
    # filter the file names
    for filename in files:
        print(filename);  # this prints out filenames as expected
    print([file for filename in files if file[-4:] == '.mp3']) 
```

我得到：

```
TypeError: 'type' object is not subscriptable 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:04:55.903

```
print([filename for filename in files if filename[-4:] == '.mp3']) 
```

# .net - 如何提取允许编辑 Word 文档以在 SharePoint 工作流中使用的编辑器？

> ID：14967359
> 
> 赞同：1
> 
> 时间：2013-02-19T21:02:53.937
> 
> 标签：.net, api, ms-word, extract

我正在尝试确定以编程方式从 Microsoft Word 文档 (docx) 中提取“编辑器”的最佳方法 - 特别是当您通过“审阅”选项卡->“保护”部分，“限制编辑”选项->“2.编辑限制”部分->“个人”列表框。如果这可能在没有代码的情况下以某种方式实现，我提到 SharePoint 将用于在工作流期间提取此信息。

我相信我可以通过解压缩文件并在 document.xml 文件中搜索“w:permStart”节点来做到这一点，我不愿诉诸这种黑客攻击，因为如果微软决定它可能会在某个时候中断改变事情。

Office API 似乎提供了一种可能性（[编辑器界面](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.editor(v=office.14).aspx)），但我现在无法测试它，我不肯定它甚至处于 api 的正确级别，因为它是一个接口而不是文档对象的实际属性或类似的。

* * *

## 编辑

Word 2010 UI 通过打开面板的按钮（或Word 2007 中的按钮）列出了我要在`Review`选项卡下、`Protect`功能区区域中提取的名称。`Restrict Editing``Protect Document``Restrict Formatting and Editing`

在此面板的第二部分（标记为`2\. Editing restrictions`）中，*如果没有标记为`Individuals`(Underneath `Exceptions (optional)`)*的框，请选中该`Allow only this type of editing in the document`复选框（在其后的下拉列表中选择什么并不重要）。

这将允许在该`Exceptions (optional)`部分下添加用户，这是通过单击`More users...`链接打开一个对话框来完成的，在该对话框中键入电子邮件地址（连接到 Microsoft 身份验证服务器）或域用户帐户（如果 Word 在域系统上运行时间）用分号隔开。这些用户将被添加到标有标签的列表中`Individuals`- 这是我想从 word 文档中提取的列表（如下图所示）。

此列表用于对下拉列表中指定的一般文档规则进行“例外”，并且只会保存与给定例外范围关联的名称 - 通过将电子邮件或名称添加到列表中来创建范围，选择一个块文本（或整个文档），然后选中该名称旁边的复选框以将其与所选范围相关联。保存文档时，对该名称的引用将作为`w:ed`一个或多个`w:permStart`元素的属性添加到基础 document.xml 文件（每个文本范围一个元素）

我*可以*解压缩 docx 文件，解析 document.xml 文档并提取这些元素中这些属性中的所有名称，但如果有 Microsoft Word API 替代方法，那将非常不雅 - 我更喜欢通过 API因为它几乎肯定会更易于维护和稳定。

![审查->保护->限制编辑->限制->个人](../Images/fa5d8367d138b0f1c86a7d3b806fd917.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T03:19:19.700

好的，我知道 Word 将这些数据隐藏在哪里了 :)

我所做的是记录一个我在文档中添加编辑器的宏，并从那里对其进行逆向工程。

似乎编辑器被分配给范围。如果该部分不是太复杂，那么这应该可以帮助您完成大部分工作：

```
Dim wordApp As New Word.Application
Dim wordDocument As Word.Document = wordApp.Documents.Open("C:\MyDoc.docx")

Dim allEditors As Word.Editors = wordDocument.Range(0, 0).Editors
For i As Integer = 1 To allEditors.Count
    Debug.Print(allEditors.Item(i).Name)
Next

wordDocument.Close() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:28:09.590

这将为您提供在当前文档中有修订的所有作者的列表。它并不漂亮，但它演示了一种提取它们的方法。

您没有指定 VB.Net 或 C#，但我认为如果这是您的首选语言，您可以将其转换为 C#。

```
Imports Microsoft.Office.Interop
Public Class Form1
    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load

        Dim wordApp As New Word.Application
        Dim wordDocument As Word.Document = wordApp.Documents.Open("c:\MyDoc.docx")
        Dim editors As New Dictionary(Of String, String)

        ' Iterate through all the revisions
        For Each r As Word.Revision In wordDocument.Revisions()
            If Not editors.ContainsKey(r.Author.ToString) Then
                editors.Add(r.Author.ToString(), r.Author)
            End If
        Next

        ' List all the unique authors
        For Each s As String In editors.Values
            Debug.Print(s)
        Next
        wordDocument.Close()
    End Sub
End Class 
```

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-01T12:26:43.357

你可以试试这个：

> ```
>  for (int j = 1; j <= wordDocument.Sections.Count; j++)
> 
>             {
>                 for (int i = 1; i <= wordDocument.Sections[j].Range.Editors.Count; i++)
>                 {
>                       //your code here
>                     wordDocument.Sections[j].Range.Editors.Item(i)....
>                 }
>             } 
> ```

# blackberry - 黑莓 - GPS 与地理定位 - 如何选择最好的？

> ID：14967361
> 
> 赞同：0
> 
> 时间：2013-02-19T21:02:54.933
> 
> 标签：blackberry, geolocation, gps, location

Blackberry API 是否提供任何方法来确定哪一个，`GPS`或者`Geolocation`在当前情况下更好（根据信号级别、网络带宽和任何其他环境属性）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T02:18:01.810

*您可以*使用许多不同的算法来确定要使用的最佳定位模式。

一个经过良好调整的算法必须考虑到诸如

*   您的用户需要多快进行位置修复？
*   修复需要多准确？它只是用于查找附近的电影院，还是用于导航的修复（需要**非常**准确）？
*   你在哪个移动运营商上？GPS 结果可能与运营商无关，但其他地理定位技术将取决于运营商及其基础设施（假设您使用的是蜂窝网络，而不是 Wi-Fi）
*   是否有任何理由需要限制网络传输（例如，对于计量数据计划，您经常更新位置）？
*   电池使用有多重要？
*   您的目标是哪个 BlackBerry OS 版本？

我确定我遗漏了一些其他因素，但希望您能看到这不是一个简单的问题，可以在不了解您的应用程序和网络部署的情况下解决。

此外，这种用于 BlackBerry (Java) 应用程序的算法传统上需要大量工作来优化。因此，许多开发人员（或客户）会认为这是一个严密保护的商业机密。因此，可能很难找到有人发布他们的算法（但问一下也无妨，对吧？）。

也就是说，您至少可以看看[BlackBerry Simple Location API](https://github.com/blackberry/Samples-for-Java/tree/master/Simple%20Location%20API)，它是一种基本算法的开源实现，可以在 GPS 和地理定位模式之间进行选择（如果您允许它同时使用这两种模式）。来自 Javadocs（对于 Optimal 模式）：

> 根据可用性在地理定位和 GPS 模式下运行。第一个修复在地理定位模式下计算，后续修复在独立模式下计算。但是，如果独立模式失败，则暂时回退到地理定位模式，直到经过一定的等待期后在独立模式下尝试重试。见`setRetryFactor(int)`。
> 
> 对于对 的单个修复调用`getLocation(int)`，首先使用地理定位模式，如果地理定位模式失败，则回退到独立模式。

我看到你在白俄罗斯，但我不知道你的客户或用户在哪里。如果他们在美国，如果您的应用支持 Verizon 网络，您可能还需要考虑使用[Nav Builder Inside之类的地理定位工具。](http://developer.verizon.com/content/vdc/en/verizon-tools-apis/verizon_apis/navbuilder-inside-sdk.html)

无论如何，我知道这可能不是您想要的答案，但也许这是一个开始？

# asp.net - 构建 Windows 搜索查询

> ID：14967363
> 
> 赞同：1
> 
> 时间：2013-02-19T21:02:58.003
> 
> 标签：asp.net, windows-search

我们有一个网站，我们将在其中使用 Windows 搜索功能来允许用户搜索该网站的页面和文档。鉴于大多数用户已经熟悉 google 风格的搜索语法，我想让搜索尽可能直观。但是，使用 Windows 搜索似乎存在两个问题。

1.  如果我使用`FREETEXT()`谓词，那么用户可以输入某些 google 样式的语法选项，例如用于精确短语匹配的双引号或使用减号排除某个单词。这些是我认为必要的功能。但是，`FREETEXT()`谓词似乎要求每个搜索词都出现在页面/文档中的某个位置，以便在结果中返回。

2.  如果我使用`CONTAINS()`谓词，那么用户可以使用布尔运算符输入搜索词，他们可以使用该`*`字符执行通配符搜索。但是，所有搜索词必须由逻辑运算符之一连接或用双引号括起来。

我想要的是两者的结合。用户应该能够使用双引号搜索确切的短语，使用减号排除单词，但也可以让未包含在引号中的任何内容进行通配符匹配（例如，搜索 civ 将返回包含单词 Civil 或 Civility 或文明）。

我该如何实施呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T14:41:10.563

我按照[http://www.codeproject.com/Articles/21142/How-to-Use-Windows-Vista-Search-API-from-a-WPF-App](http://www.codeproject.com/Articles/21142/How-to-Use-Windows-Vista-Search-API-from-a-WPF-App)上的一些说明创建了 Interop.SearchAPI.dll .NET 程序集。然后我使用该`ISearchQueryHelper.GenerateSQLFromUserQuery()`方法构建 SQL 命令。

生成的 SQL 使用`CONTAINS()`谓词，但它`CONTAINS()`使用搜索词的不同组合（包括通配符）多次构建谓词。这允许用户使用双引号输入准确的短语，使用减号排除单词，并执行我在原始问题中提到的自动通配符匹配。

# ios - 在同一故事板上的 2 个视图控制器之间切换，使用 willAutorotateTo 进行旋转...不起作用，

> ID：14967366
> 
> 赞同：5
> 
> 时间：2013-02-19T21:03:04.450
> 
> 标签：ios, objective-c, uiviewcontroller, interface-builder, screen-orientation

我在这里有一个小问题。我在同一个故事板上有两个视图控制器（MainStoryboard -> 纵向模式下的 Calc 视图控制器和横向模式下的 Calc 视图控制器）。当我最初创建一个`bool`for时，`shouldAutoRotate`它确实旋转了，但是“并且仍然存在”渲染问题，因为某些按钮等不在您期望的位置，换句话说，它们在横向模式下到处都是. 所以现在我在横向模式和主要纵向模式下创建了 2 个视图控制器。所以现在的关键是在这两个控制器之间切换。

在 CalculatorViewController.mi 中有
**更新**
我注意到一些方法已从 iOS 6 中删除（这就是我现在正在使用的方法）经过一些研究后我发现在 iOS 6 中“正确的方法”是这样的

```
@synthesize portraitView, landscapeView;

-(BOOL)shouldAutorotate
{
    return YES;
}
-(NSUInteger)supportedInterfaceOrientations:toInterfaceOrientation
{
    if(UIInterfaceOrientationMaskAllButUpsideDown)
    {
        if ( UIInterfaceOrientationPortrait )
        {
            self.view = portraitView;
        }
        else if ( UIInterfaceOrientationLandscapeLeft )
        {
            self.view = landscapeView;
        }

    }
    return YES;

} 
```

然而，尽管我认为我在 iOS 6 中使用了正确的方法，但我仍然无法在旋转时调用正确的视图控制器

并在 CalculatorViewController.h

```
@interface CalculatorViewController : UIViewController {

    IBOutlet UIView *portraitView; // declaring view - portrait
    IBOutlet UIView *landscapeView; // declaring view - landscape
    //rest of irrelevant code below

}
@property (nonatomic, retain) UIView *portraitView;
@property (nonatomic, retain) UIView *landscapeView; 
```

![在此处输入图像描述](../Images/6711a5aea079b2f9929f016696207389.png) 只需忽略他们现在无关紧要的那 2 个白色控制器。提交图片以显示这 2 个视图控制器

感谢您的时间

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:16:19.273

我已经做过几次这样的事情，而且让你的 ViewController 有一个空白视图通常更容易。然后只需将横向视图添加为横向的主要子视图，然后在旋转到纵向时将其删除，依此类推。如果您尝试拥有单独的 VC，那么您将拥有一团乱麻的状态保存代码，只是为了顺利过渡。

您甚至可以通过同时拥有子视图并在适当时显示/隐藏它们来摆弄这种设计。这会占用更多内存，但您可以制作一些不错的过渡动画。

这样，您的所有连接和逻辑都将位于单个 VC 中，而只是界面会发生变化。

# python - 如何在一组班级平均值中显示最大和最小平均值

> ID：14967369
> 
> 赞同：0
> 
> 时间：2013-02-19T21:03:14.663
> 
> 标签：python

我正在用python编写一个程序，允许用户输入班级学生人数，然后为每个学生输入3个测试成绩。它还需要显示学生的考试平均成绩、班级平均成绩以及班级中的最高和最低平均成绩。现在，在打印每个学生的成绩和平均水平后，我无法让它不打印班级平均水平。我也真的无法使最大值和最小值起作用，因为它随着每个学生的变化而变化为该学生的平均值。

```
students=int(input('Please enter the number of students in the class: '))

for number in range(students):

    class_average == 0 

    first_grade=int(input("Enter student's first grade: "))
    second_grade=int(input("Enter student's second grade: "))
    third_grade=int(input("Enter student's third grade: "))

    StudentAverage=(first_grade + second_grade + third_grade)/3
    print("The student's average is", round(StudentAverage,2))

    class_average= class_average + StudentAverage
    print("The class average is", round(class_average/students,2))

maximum_num = 0

if StudentAverage > maximum_num:
    maximum= StudentAverage
    print("The maxiumum average is", round(maximum,2))

minimum_num = 100

if StudentAverage < minimum_num:
    minimum= StudentAverage
    print("The minimum average is", round(minimum,2)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:20:32.093

我将您的初始化程序移到了循环之外，因此在每次迭代期间该值不会重置。我将最大和最小比较移到循环中，并替换了最大和最小变量。每个新值分别小于和大于这些值，因此需要使用 maximum_num 和 minimum_num 来代替。运行班级平均值太低，因为它使用学生总数而不是当前计算的人数。我用数字+1代替了学生的使用。我认为这是您想要的代码。

```
students=int(input('Please enter the number of students in the class: '))
class_average = 0 
maximum_num = 0
minimum_num = 100
for number in range(students):

  first_grade=int(input("Enter student's first grade: "))
  second_grade=int(input("Enter student's second grade: "))
  third_grade=int(input("Enter student's third grade: "))

  StudentAverage=(first_grade + second_grade + third_grade)/3
  print("The student's average is", round(StudentAverage,2))

  class_average= class_average + StudentAverage
  print("The class average is", round(class_average/(number+1),2))

  if StudentAverage > maximum_num:
    maximum_num = StudentAverage

  if StudentAverage < minimum_num:
    minimum_num = StudentAverage
print("The minimum average is", round(minimum_num,2))
print("The maxiumum average is", round(maximum_num,2)) 
```

# ruby-on-rails - 链接多个查询以生成实例变量

> ID：14967371
> 
> 赞同：0
> 
> 时间：2013-02-19T21:03:16.700
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我希望能够通过饮品名称或饮品成分来搜索我的饮品。

```
def index
  @drinks2 = Drink.where(:ingredients => {:name => params[:search]}).joins(:ingredients)
  @drinks = @drinks2 + Drink.where(:name => params[:search])
end 
```

我的上述解决方案有效，但我正在寻找改进。这似乎有点骇人听闻。

我的问题：有没有办法将这两个查询组合成一行？这是正确的做法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:06:42.603

你想要的既可能而且相当简单，但它确实需要编写一些实际的 SQL - 你不能依赖基于哈希的条件。假设您有一个包含列的`ingredients`表`name`：

```
@drinks = Drink.joins(:ingredients).where('drinks.name = :search OR ingredients.name = :search', :search => params[:search]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:06:43.343

这不行吗？

```
Drink.where(:ingredients => {:name => params[:search]}, :name => params[:search] ).joins(:ingredients) 
```

# java - 吉利德替代品将 GWT 和 Hibernate 粘合在一起

> ID：14967373
> 
> 赞同：9
> 
> 时间：2013-02-19T21:03:24.147
> 
> 标签：java, hibernate, gwt, gilead

直到最近，Gilead 看起来像是将 GWT 和 Hibernate 粘合在一起的最佳解决方案。不幸的是，Gilead 项目似乎被放弃了，并且没有升级到新的 GWT 2.5，这让我们寻找替代品。

您是否知道任何新项目与 Gilead 为旧版本的 GWT 所做的事情基本相同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T00:45:16.193

这是一个稍微不同的编程模型（使用代理对象而不是真正的实际数据模型对象），但我建议使用官方 GWT requestfactory 作为替代：[https ://developers.google.com/web-toolkit/doc/latest /DevGuideRequestFactory](https://developers.google.com/web-toolkit/doc/latest/DevGuideRequestFactory)

我们发现它是一个更好的编程模型，因为它不会强迫您保持模型类不包含任何服务器端代码。我相信它还具有许多性能优势，因为它会自动将更改作为 delta 进行管理，而不是重新序列化整个对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-21T00:39:29.760

在我的开发团队中，我们使用[dehibernator](https://code.google.com/p/dehibernator/)在将实体发送到客户端之前摆脱 Hibernate 代理和惰性集合。它简单有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-02T09:27:50.930

这似乎值得一试：[Gilead fork for GWT 2.7.0](https://github.com/emsouza/gilead)

# splash-screen - 用于剧本的 Splash Qt

> ID：14967376
> 
> 赞同：1
> 
> 时间：2013-02-19T21:03:26.270
> 
> 标签：splash-screen, blackberry-playbook

我正在为 Playbook 开发 QtCreator。在 bar-descriptor.xml 中，我将启动的路径设置如下：

```
<asset path="splash.jpg">splash.jpg</asset> 
```

为了设置启动画面，我试过：

```
<splashscreen>splash.jpg</splashscreen>
<splashScreen>splash.jpg</splashScreen>
<splash>splash.jpg</splash>
<splashscreen><image>splash.jpg</image></splashscreen>
<splashScreen><image>splash.jpg</image></splashScreen>
<splash><image>splash.jpg</image></splash> 
```

但闪屏显示为带有 BB 标志的默认黑色图像。有人知道怎么改吗？

不管怎样，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T21:11:56.923

Qt 需要横向和纵向启动图像。所以，就我而言，横向和纵向是相同的，编辑方式如下：

```
<splashscreen>splash.jpg:splash.jpg</splashscreen> 
```

在其他情况下，当两个图像都存在时，编辑方式如下：

```
<splashscreen>splash_landscape.jpg:splash_portrait.jpg</splashscreen> 
```

# drop-down-menu - Joomla 中的下拉菜单

> ID：14967377
> 
> 赞同：0
> 
> 时间：2013-02-19T21:03:32.033
> 
> 标签：drop-down-menu, joomla, joomla2.5

我对下拉菜单有一些问题。我已经为菜单项“test 1”分配了一个下拉菜单。但是当我在默认页面上时，当我悬停该项目时，它不会显示下拉菜单。它仅在单击菜单项“test 1”时有效。

无论您正在观看哪个女巫页面，我都需要显示下拉菜单。有人能帮我吗？我想这是一个简单的造型，但似乎无法弄清楚。

你可以在[这里查看网站](http://test2.helbografisk.dk)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-19T21:10:42.187

您在菜单系统中使用什么模块？

您可以尝试使用与当前使用的不同的菜单扩展。可能是 CSS 问题。

# javascript - 在 d3js 布局中使用 XML 作为数据源在 firefox 中不起作用

> ID：14967381
> 
> 赞同：1
> 
> 时间：2013-02-19T21:03:39.203
> 
> 标签：javascript, xml, d3.js, circle-pack

我正在尝试使用 XML 文件作为我的 d3js 可视化的数据源。它适用于基于 webkit 的浏览器，但不适用于 firefox。我相信错误来自一个 DOM 元素没有 forEach 函数的事实。3djs 似乎期望在它接收 DOM 对象的地方有一个数组。但我不知道在哪里

我的孩子功能看起来像这样。

```
var bubble = d3.layout.pack()
    .sort(null)
    .children(function(d){
        var c = $("system",d);
        if (c.length<=0) c = $("planet",d);
        return c;
    }) 
```

[这](https://github.com/hannorein/oec_iphone/blob/master/data_iphone_9.1/systems.xml)是 XML 文档。我通过直接将它传递给 d3js

```
node = viz.selectAll(".node")
        .data(bubble.nodes(xmldata))
        .enter().append("g")
        .attr("class", "node") 
```

[这](http://openexoplanetcatalogue.com/bubblechart.html)是代码的现场演示（在 webkit 中有效，但在 Firefox 中无效）。这是完整的源代码[。](https://github.com/hannorein/oec_web/blob/master/bubblechart.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T23:48:43.447

请参阅[此处](https://github.com/hannorein/oec_web/pull/1)进行修复。

问题是 jQuery 查询结果直接作为节点传递给 D3 布局。D3 将各种属性，例如“children”，直接写入每个节点。如果存在同名的现有属性用于其他目的，例如本例中的 jQuery 的“子项”，这可能会导致问题。

# jquery - jquery mobile Panel Swipe功能导致错误

> ID：14967382
> 
> 赞同：4
> 
> 时间：2013-02-19T21:03:44.017
> 
> 标签：jquery, jquery-mobile, initialization, panel, swipe

我很难过，我有一个使用 mootools 的翻转时钟，然后是一个使用 Yahoo API 的天气小部件，现在我不知道是什么原因造成的

> “在初始化之前无法调用面板上的方法；试图调用方法‘打开’”

所以我跟着这个演示， http: [//view.jquerymobile.com/master/docs/examples/panels/panel-swipe-open.php#demo-page](http://view.jquerymobile.com/master/docs/examples/panels/panel-swipe-open.php#demo-page)现在我得到了错误。

```
$( document ).on( "pageinit", "#demo-page", function() {
$( document ).on( "swipeleft swiperight", "#demo-page", function( e ) {
    // We check if there is no open panel on the page because otherwise
    // a swipe to close the left panel would also open the right panel (and v.v.).
    // We do this by checking the data that the framework stores on the page element (panel: open).
    if ( $.mobile.activePage.jqmData( "panel" ) !== "open" ) {
        if ( e.type === "swipeleft"  ) {
            $( "#right-panel" ).panel( "open" );
        } else if ( e.type === "swiperight" ) {
            $( "#left-panel" ).panel( "open" );
        }
    }
}); 
```

});

我有点走投无路，因为我已经成功了，请随意查看我的代码， http: [//yaasko.com/gra423/project-4.3/](http://yaasko.com/gra423/project-4.3/)如果您尝试向左或向右滑动控制台将输出错误.

如果您可以帮助，请让我知道，第一次使用 jquery 移动用户！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-19T22:06:11.920

在这个消息的情况下：

> “在初始化之前无法调用面板上的方法；试图调用方法‘打开’”

像这样打开面板：

```
$( "#left-panel" ).panel().panel("open"); 
```

第一个 panel() 调用将初始化它，第二个将打开它。

**编辑 ：**

```
$(document).on('pagebeforeshow', '#index', function(){        
    $( document ).on( "swipeleft swiperight", "#index", function( e ) {
        if ($.mobile.activePage.find('#left-panel').hasClass('ui-panel-closed') && e.type === "swipeleft") {
            $( "#right-panel" ).panel( "open" ); 
        }    

        if ($.mobile.activePage.find('#right-panel').hasClass('ui-panel-closed') &&  e.type === "swiperight") {
            $( "#left-panel" ).panel( "open" );           
        }        
    });
}); 
```

# sql-server - 计算列表达式

> ID：14967384
> 
> 赞同：0
> 
> 时间：2013-02-19T21:03:46.767
> 
> 标签：sql-server, tsql, calculated-columns

我特别需要一个名为**ProductCode的计算列**

```
ProductId | SellerId | ProductCode
1           1           000001
2           1           000002
3           2           000001       
4           1           000003 
```

**ProductId**是身份，以 1 递增 **。SellerId**是外键。

所以我的计算列**ProductCode**必须查看卖家有多少产品，格式为 000000。这里的问题是如何知道要查找哪些卖家产品？

我写了一个 TSQL，它不看卖家有多少产品

```
ALTER TABLE dbo.Product
ADD ProductCode AS  RIGHT('000000' + CAST(ProductId AS VARCHAR(6)) , 6) PERSISTED 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T01:15:54.143

您不能拥有基于正在更新的当前行之外的数据的计算列。您可以做的最好的事情是创建一个后触发器来查询整个表以查找产品代码的下一个值。但是为了完成这项工作，您必须使用排他表锁，这将彻底破坏并发性，所以这不是一个好主意。

我也不建议使用视图，因为每次阅读表格时它都必须计算 ProductCode。这也将是一个巨大的性能杀手。通过不将值保存在数据库中以使其不再被触摸，您的产品代码将受到虚假更改（例如可能删除错误输入且从未使用过的产品的情况）。

这是我推荐的。创建一个新表：

**dbo.SellerProductCode**

```
SellerID  LastProductCode
--------  ---------------
  1        3
  2        1 
```

该表可靠地记录了每个卖家最后使用的产品代码。在`INSERT`您的`Product`表上，触发器将`LastProductCode`针对所有受影响`SellerID`的 s 适当地更新此表中的 ，然后`Product`使用适当的值更新表中所有新插入的行。它可能看起来像下面这样。

[查看此触发器在 Sql Fiddle 中工作](http://sqlfiddle.com/#!3/801e3/1)

```
CREATE TRIGGER TR_Product_I ON dbo.Product FOR INSERT
AS
SET NOCOUNT ON;
SET XACT_ABORT ON;
DECLARE @LastProductCode TABLE (
   SellerID int NOT NULL PRIMARY KEY CLUSTERED,
   LastProductCode int NOT NULL
);

WITH ItemCounts AS (
   SELECT
      I.SellerID,
      ItemCount = Count(*)
   FROM
      Inserted I
   GROUP BY
      I.SellerID
)
MERGE dbo.SellerProductCode C
USING ItemCounts I
   ON C.SellerID = I.SellerID
WHEN NOT MATCHED BY TARGET THEN
   INSERT (SellerID, LastProductCode)
   VALUES (I.SellerID, I.ItemCount)
WHEN MATCHED THEN
   UPDATE SET C.LastProductCode = C.LastProductCode + I.ItemCount
OUTPUT
   Inserted.SellerID,
   Inserted.LastProductCode
INTO @LastProductCode;

WITH P AS (
   SELECT
      NewProductCode =
         L.LastProductCode + 1
         - Row_Number() OVER (PARTITION BY I.SellerID ORDER BY P.ProductID DESC),
      P.*
   FROM
      Inserted I
      INNER JOIN dbo.Product P
            ON I.ProductID = P.ProductID
      INNER JOIN @LastProductCode L
         ON P.SellerID = L.SellerID
)
UPDATE P
SET P.ProductCode = Right('00000' + Convert(varchar(6), P.NewProductCode), 6); 
```

请注意，即使插入了多行，此触发器也有效。也不需要预加载`SellerProductCode`表格，新卖家会自动添加。这将处理并发问题。如果遇到并发问题，可以添加适当的锁定提示而不会产生有害影响，因为表将保持非常小并且可以使用 ROWLOCK（除了需要范围锁定的 INSERT）。

请[查看 Sql Fiddle](http://sqlfiddle.com/#!3/801e3/1)以了解演示该技术的工作、测试代码。现在您拥有无需更改且可靠的*真实产品代码。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:38:06.520

# ios - UIScroll 动画被 NSFetchedResultsControllerDelegate 处理打断

> ID：14967386
> 
> 赞同：0
> 
> 时间：2013-02-19T21:04:01.133
> 
> 标签：ios, uitableview, nsfetchedresultscontroller

当keyboardWillHide 时，我将tableView 滚动到指定点。代码如下。这很好用。

现在，我实现了 NSFetchedResultsControllerDelegate。我通过设置将其设置为“开启”`fetchedResultsController.delegate = self;`滚动动画被中断。NSFetchedResultsControllerDelegate 正在调用`[tableView beginUpdates]`，我认为这会导致 tableView 动画中断。

如何防止滚动动画被中断并仍然实现 NSFetchedResultsControllerDelegate？

```
- (void)keyboardWillHide:(NSNotification *)notification {
    [screen setHidden:YES];
    [suggestView setHidden:YES];

    [_tableView setContentOffset:origin animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T22:49:59.813

我发现你不能在keyboardWillHide 中做动画。你不应该在任何“WILL”事件中做任何动画。

# jsp - 关于 HTTP 请求生命周期的流行解释的困惑

> ID：14967390
> 
> 赞同：1
> 
> 时间：2013-02-19T21:04:09.763
> 
> 标签：jsp, http, servlets

> 一旦服务器完成请求并将响应返回给客户端，请求及其属性就不再可供客户端使用，并且可以由 JVM 进行垃圾收集。

来自：编程 Jakarta Struts，Chuck Cavaness 第二版

问题：

1.  作者的意思不是说“请求及其属性不再对服务器可用吗？” 客户端是发起端点。

2.  垃圾收集器清理服务器 JVM 可用的堆内存。浏览器（客户端）不使用堆。

3.  请求属性由 Web 容器集成到 HttpServletRequest 对象中。

4.  HttpServletRequest 和 HttpServletResponse 对象何时进行垃圾收集？

5.  在将 HTTP 响应发送回客户端的那一刻，HTTP 请求的生命周期不是已经结束了吗？生命周期不包括客户端对响应的处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:51:17.193

> 作者的意思不是说“请求及其属性不再对服务器可用吗？” 客户端是发起端点。

作为 Java 对象的请求（及其属性）在服务器中处理，但客户端是发送请求的人。这就是为什么作者可能会提到请求属于客户端而不是服务器的原因。处理完请求后，它没有任何用处，因此被丢弃（HTTP 概念），但在 Java Web Server 中，驻留在服务器中的`ServletRequest`对象（通常处理为`HttpServletRequest`）将不再可用，因此将被垃圾回收。

> 垃圾收集器清理服务器 JVM 可用的堆内存。浏览器（客户端）不使用堆。

在第一个答案的最后部分回答。

> 请求属性由 Web 容器集成到 HttpServletRequest 对象中。

您混淆了来自 HTTP 请求（GET、POST 等）的`HttpServletRequest`属性和可以通过[`HttpServletRequest#getAttribute(String)`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getAttribute%28java.lang.String%29). 您可以通过提供的链接中的函数访问HTTP请求的属性，如[字符编码](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getCharacterEncoding%28%29)、[内容类型](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getContentType%28%29)和[请求参数](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getParameter%28java.lang.String%29)，您也可以通过`HttpServletRequest`界面中的其他函数了解其他HTTP属性。

> HttpServletRequest 和 HttpServletResponse 对象何时进行垃圾收集？

在 HTTP 响应提交并完成之后。请参阅[servlet 是如何工作的？实例化、会话变量和多线程](https://stackoverflow.com/a/3106909/1065197)

> 在将 HTTP 响应发送回客户端的那一刻，HTTP 请求的生命周期不是已经结束了吗？生命周期不包括客户端对响应的处理？

一旦响应到达客户端，由客户端决定如何处理它。请注意，您可以拥有：ajax 请求、完整的 HTTP 请求、资源请求（例如，用于 JS、CSS 和图像）、[portlet 请求](http://www.novell.com/documentation/extend52/Docs/help/Director/books/pgPortletsAbout.html)......

# sql - IF 在 WHERE 内，带有存储过程

> ID：14967397
> 
> 赞同：2
> 
> 时间：2013-02-19T21:04:28.227
> 
> 标签：sql, if-statement, null, where

我有一个看起来像这样的 WHERE 语句：

```
WHERE 
    ((@Value1 IS NULL AND [value1_id] IS NULL) OR [value1_id] = ISNULL(@Value1, [value1_id]))
    AND
    ((@Value2 IS NULL AND [value2_id] IS NULL) OR [value2_id] = ISNULL(@Value2, [value2_id]))
    AND
    ((@Value3 IS NULL AND [value3_id] IS NULL) OR [value3_id] = ISNULL(@Value3, [value3_id]))
    AND
    ((@Value4 IS NULL AND [value4_id] IS NULL) OR [value4_id] = ISNULL(@Value4, [value4_id]))
    AND
    ((@Value5 IS NULL AND [value5_id] IS NULL) OR [value5_id] = ISNULL(@Value5, [value5_id]))
    AND 
    ((@Value6 IS NULL AND [value6_id] IS NULL) OR [value6_id] = ISNULL(@Value5, [value6_id])) 
```

我需要在 WHERE 中添加一些条件逻辑，以便我可以使用 Value5 和 Value6 做一些特殊的事情。基本上，如果 Value5、Value6 或其他值为 null，我想按原样使用 Value 5 和 Value 6 行。如果所有三个值都不为 NULL，我需要对这些值进行一些计算。

关于最佳行动的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T21:09:49.573

使用案例

"CASE 可用于任何允许有效表达式的语句或子句。例如，您可以在 SELECT、UPDATE、DELETE 和 SET 等语句中以及在 select_list、IN、WHERE、ORDER BY 和有。”

[http://msdn.microsoft.com/en-us/library/ms181765.aspx](http://msdn.microsoft.com/en-us/library/ms181765.aspx)

您可以在这样的内部执行计算`SELECT`：

```
SELECT
    CASE
        WHEN @Value7 is not null THEN @Value7 * 100
        ELSE Value7 * 100
    END
FROM #T
WHERE   (@Value1 is null and Value1 is null)
    AND (@Value2 is null and Value2 is null) 
```

目前还不是很清楚你到底想要完成什么。不是在`WHERE`里面`SELECT`吗？如果上述内容不正确，请提供一个清晰、简洁的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:11:56.650

> 基本上，如果 Value5、Value6 或其他值为 null，我想按原样使用 Value 5 和 Value 6 行。如果所有三个值都不为 NULL，我需要对这些值进行一些计算。

我认为这很难做到，例如`CASE`在`WHERE`子句内部。在语句`IF`之外进行构造可能会更好：`SELECT`

```
IF (@Value5 IS NULL OR @Value6 IS NULL OR @OtherValue IS NULL)
  BEGIN
    <Statement1AsIs>
  END
ELSE
  BEGIN
    <Statement2WithComputations>
  END 
```

**重写 WHERE 子句**

在一个简短的旁注中，我知道你没有要求它，但我觉得必须有一种“更清晰”的方式来写这些

```
((@Value1 IS NULL AND [value1_id] IS NULL) OR [value1_id] = ISNULL(@Value1, [value1_id])) 
```

我一直在玩，这是一种说法：

```
COALESCE(@Value1, [value1_id], 1001) = COALESCE([value1_id], 1001) 
```

这是另一个，等效且更短：

```
@Value1 IS NULL OR [value1_id] = ISNULL(@Value1, [value1_id]) 
```

查看此**[SQL Fiddle](http://sqlfiddle.com/#!3/06381/1)**以查看等价性。

# c - 正确使用泛型函数指针

> ID：14967398
> 
> 赞同：1
> 
> 时间：2013-02-19T21:04:38.243
> 
> 标签：c, function-pointers

给定用于更新双向链表中节点的函数的以下声明：

```
uint8 dl_update(DL_LIST **node, uint16 new_tag, void *new_object,
    uint32 new_size, void (*destructor)(void*)) 
```

以及对该函数的以下调用：

```
dl_update(&dlt_list, _TAG, zulu, sizeof(*zulu),
    (void(*)(void*)) &_free_dlt_object(delta)); 
```

最后一个参数会导致编译器发出错误消息“lvalue required as unary '&' operator”怎么办？我传递的析构函数（及其操作的结构）定义如下：

```
typedef struct DLT_OBJECT {
    char *word;
    uint8 number;
} DLT_OBJECT;

void _free_dlt_object(DLT_OBJECT *object) {
    free(object->word);
    free(object);
} 
```

以下[问题](https://stackoverflow.com/questions/188839/function-pointer-cast-to-different-signature)似乎暗示可以转换函数指针，所以我不相信我这样做会导致问题，尽管考虑到我的代码在裸​​机嵌入式系统上运行（在[问题](https://stackoverflow.com/questions/188839/function-pointer-cast-to-different-signature)）我不确定。

这是一个简单的语法错误，还是更多的结构问题？我一直认为用 void 指针参数声明函数指针是将通用函数指针传递给其他函数的好方法......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:06:40.620

使用函数指针时，您只是在传递一个函数，因此您可以像这样进行调用

```
dl_update(&dlt_list, _TAG, zulu, sizeof(*zulu), _free_dlt_object); 
```

# java - 位图到大错误是抱怨图像大小的两倍

> ID：14967408
> 
> 赞同：5
> 
> 时间：2013-02-19T21:05:11.840
> 
> 标签：java, android, opengl-es, bitmap

我收到了臭名昭著的`OpenGLRenderer`错误，`"Bitmap too large to be uploaded into a texture."` 我熟悉该错误并且知道我需要将图像保留在下方`2048 pixels`以避免它。

但是，在一款特定的手机三星 Galaxy Nexus 上，它报告的图像大小是实际图像大小的两倍。

我的图像在`drawable`文件夹中，大小为`2048x95`. 当我运行应用程序并尝试将该图像添加到显示器时，我收到了臭名昭著的错误：

> 位图太大，无法上传到纹理中（4096x190，最大值=2048x2048）

是什么赋予了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T21:09:04.420

如果您的图像位于可绘制文件夹中，则它将根据设备缩放到适当的密度。这意味着对于 mdpi 设备，您的图像将具有适当的尺寸，但对于 hdpi、xhdpi 和 xxhdpi，您的图像将比您想象的要大得多，而 ldpi 设备的图像会更小。

如果您不希望图像在 Galaxy Nexus 上那样缩放，请将其放在 drawable-xhdpi 文件夹中。

# css - DIV 不显示背景颜色

> ID：14967413
> 
> 赞同：5
> 
> 时间：2013-02-19T21:05:41.553
> 
> 标签：css

我不确定自己做错了什么，但无法为#content 应用背景颜色。但是如果我将高度值设置为 800 像素，它就可以正常工作。但我希望它是自动或 100%，因为此模板将在整个站点中使用。任何建议将不胜感激。

```
<div class="content_bg">
    <div id="content">
        <div id="contentLeft">   
        </div>
        <div id="contentRight"> 
            <div id="ContentPane" runat="server" />           
        </div>
    </div>
</div>
<div class="footer_bg">
    <div id="footer">
        <div id="footerLeft">            
        </div>
        <div id="footerRight">           
        </div>
    </div>
</div>

/*
====================================================================
Content Area
====================================================================
*/

.content_bg
{
    background:#dadad9 url(images/interior_content_bg_top.jpg) repeat-x center top;
    overflow:hidden;
}

#content
{
    width:980px;
    margin:auto; 
    height:auto; 
    background:#fff; 

}

#contentLeft
{
    float:left;
    width:209px; 
    margin-top:50px;   
}

#contentRight
{
    float:right;
    width:770px; 
    margin:20px 0 0 0;
}

/*
====================================================================
Footer
====================================================================
*/

.footer_bg
{
    background:#dadad9 url(images/interior_footer_bg.jpg) repeat-x center top;
    clear:both;
}

#footer 
{
    width:980px;
    height:258px;
    margin:auto;
    background:#dadad9 url(images/interior_footer.jpg) no-repeat center top;
}
#footerLeft
{
    width:400px;
    height:50px;       
    float:left;
    padding: 20px 0 0 25px;    
}

#footerRight
{
    width:100px;
    height:50px;       
    float:right;
    padding: 20px 0 0 0;
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-19T21:12:05.023

Set the overflow to auto for #content.

```
#content {
    width:980px;
    margin:auto; 
    height:auto; 
    background:#fff; 
    overflow:auto;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T21:11:58.913

The problem is that `#content` has no content. Since you are using `height:100%` for the div's height, it will expand to the full height of its parent div (i.e. `.content_bg`). However, `.content_bg` has no content either; therefore it is expanding to 100% of zero.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:18:41.720

尝试将课程添加到您的 id`<div id="content" class="content_bg">`并删除课程。并给你的班级这些属性

```
.content_bg
{
    background-color: white;
    width: 100%;
    height: 100%;
} 
```

然后你的 id "content" 中的内容将定义宽度和高度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T21:18:43.903

您在应用背景时遇到问题，`#content`因为您没有清除浮动。添加

```
<div style="clear:both"></div> 
```

后

```
 <div id="contentLeft">   
    </div>
    <div id="contentRight"> 
        <div id="ContentPane" runat="server" />           
    </div> 
```

# vtd-xml - VTD-XML 创建 XML 文档

> ID：14967414
> 
> 赞同：2
> 
> 时间：2013-02-19T21:05:43.473
> 
> 标签：vtd-xml

我对如何做到这一点有点困惑，所有文档/示例都显示了如何阅读和编辑 xml 文档，但似乎没有任何明确的方法可以从头开始创建 xml，我宁愿不必发货我的程序带有一个虚拟 xml 文件，以便对其进行编辑。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T19:09:13.000

你可以做的只是硬编码一个空文档，如下所示：

```
byte[] emptyDoc = "<?xml version='1.0' encoding='UTF-8'?><root></root>".getBytes("UTF-8"); 
```

然后使用它来创建您的 VTDGen 和 XMLModifier，并开始添加元素：

```
VTDGen vg = new VTDGen();
vg.setDoc(emptyDoc);
vg.parse(true);

VTDNav vn = vg.getNav();
XMLModifier xm = new XMLModifier(vn);

// Cursor is at root, update Root Element Name
xm.updateElementName("employee");

xm.insertAttribute(" id='6'");
xm.insertAfterHead("<name>Bob Smith</name>");
vn = xm.outputAndReparse();

// etc... 
```

# css - 如何将这些输入元素相对于它们的标签向下移动？

> ID：14967415
> 
> 赞同：1
> 
> 时间：2013-02-19T21:05:46.970
> 
> 标签：css

[小提琴](http://jsfiddle.net/3YUTM/)

我想将输入元素相对于它们的标签向下移动（只有大约 3 个像素）。我遇到的主要问题是输入`display: block;`会破坏整个布局。我需要代码文本出现在标签下方并输入与之关联的内容，就像现在一样。

HTML：

```
<label for="inputSize"><p>Size</p><input id="inputSize" class="char2" type="text"><br><code>font-size: 17px;</code></label>
<label for="inputWeight"><p>Weight</p><input id="inputWeight" class="char3" type="text"><br><code>font-weight: 400;</code></label>
<label for="inputSpacing"><p>Letter-spacing</p><input id="inputSpacing" class="char2" type="text"><br><code>letter-spacing: 0;</code></label>
<label for="inputWSpacing"><p>Word-spacing</p><input id="inputWSpacing" class="char2" type="text"><br><code>word-spacing: 0;</code></label> 
```

CSS：

```
label {
    white-space: nowrap;
    display: inline-block;
}
label p {
    background: aqua;
    display: inline-block;
    color: @gray1;
    padding: 1px 10px;
    font-size: 16px;
    line-height: 24px;
}
input {
    font-family: monospace;
    height: 14px;
    box-shadow: 0px 0px 7px 0px #b8b8b8;
    border: 0;
} 
```

谢谢！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T21:09:40.347

您可以相对于`position: relative`它应该在的位置移动一个元素（在您的情况下使用`top: 3px`.

[http://jsfiddle.net/ExplosionPIlls/3YUTM/1/](http://jsfiddle.net/ExplosionPIlls/3YUTM/1/)

# angularjs - AngularJS：带有自定义 ng-options 的下拉指令

> ID：14967416
> 
> 赞同：4
> 
> 时间：2013-02-19T21:05:55.543
> 
> 标签：angularjs, angularjs-directive

我正在尝试创建一个下拉指令，我想通过使用指令属性指定选择 ng-options“选项值”和“选项描述”属性。请参阅代码以更好地理解...

这是我的指令。这显然行不通，但我认为它会描述我正在尝试做的事情......

```
app.directive('dropdown', function(){
return {
    restrict: 'E',
    scope: {
        array: '='
    },
    template:   '<label>{{label}}</label>' +
                '<select ng-model="ngModel" ng-options="a[{{optValue}}] as a[{{optDescription}}] for a in array">' +
                    '<option style="display: none" value="">-- {{title}} --</option>' +
                '</select>',
    link: function (scope, element, attrs) {
        scope.label = attrs.label;  
        scope.title = attrs.title;
        scope.optValue = attrs.optValue;
        scope.optDescription = attrs.Description;
    }
}; 
```

});

...这就是我想使用它的方式

```
<dropdown title="Choose ferry" label="Ferries" array="ferries" opt-value="Id" opt-description="Description"></dropdown>
<dropdown title="Choose route" label="Routes" array="routes"  opt-value="Code" opt-description="Name"></dropdown> 
```

**和小提琴：http: [//jsfiddle.net/wXV6Z/1/](http://jsfiddle.net/wXV6Z/1/)**

如果您对这个问题有解决方案，或者更有可能对如何解决它有不同的看法，请告诉我！

谢谢/安德烈亚斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:12:23.483

实际上，这可以工作。`a[{{optValue}}]`您需要做的唯一更改是删除and周围的花括号`a[{{optDescription}}]`，因为您不需要在那里插值。

`optValue`and`optDescription`已经是范围内的字符串，因此`a[optValue]`and`a[optDescription]`将使您的代码工作得很好，因为它们是在您的指令范围内评估的表达式。

[这是您的 fiddle 的更新版本](http://jsfiddle.net/wXV6Z/4/)。

# css - CSS calc() 不工作

> ID：14967421
> 
> 赞同：29
> 
> 时间：2013-02-19T21:06:21.637
> 
> 标签：css

`calc()`CSS函数中可以有多少个操作数有限制吗？

这有效：

```
div {
    left:calc((100%/54)*26);
    left:-webkit-calc((100%/54)*26);
} 
```

这不起作用：

```
div {
    left:calc(((100%/54)*14)-140px);
    left:-webkit-calc(((100%/54)*14)-140px);
} 
```

当然，后者是我需要的，因为我需要偏移几个像素，但是一旦我尝试这样做，值似乎就变为零了。任何见解表示赞赏！

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2013-02-19T21:09:44.907

引用[MDN](https://developer.mozilla.org/en-US/docs/CSS/calc)

> `+`and运算符必须始终被`-`空格包围。例如的操作数`calc(50% -8px)`将被解析为百分比后跟负长度、无效表达式，而 的操作数`calc(50% - 8px)`是百分比后跟减号和长度。`*`and`/`运算符不需要空格，但允许并建议添加空格以保持一致性。

把你的东西分开，它可能会起作用。

# arrays - VB.NET 数组中的灵活索引

> ID：14967422
> 
> 赞同：1
> 
> 时间：2013-02-19T21:06:26.743
> 
> 标签：arrays, vb.net

我想知道如何在 vB.NET 中为数组中的索引设置无限索引（限制）我通常必须指定数组每个维度中的最大项目数，但是当我不知道有多少时（假设是一个ID字段），会在那里，我不想浪费数据。

所以我想而不是写

```
Dim storage(0 To 1000, 0 To 3, 0 To 5) As String 
```

写这样的东西（其中*表示无限），分别保持其他限制：

```
Dim storage(*, 0 To 3, 0 To 5) As String 
```

那么我可以添加这样的项目：

```
storage(123456,3,5) = "abcdefgh" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T21:12:23.030

请不要这样做 :) 根据需要动态调整数组大小会造成不必要的混乱。多维数组也不必要地令人困惑。因此，动态地重新调整多维数组的大小是不必要的痛苦。

当数组的大小是动态的时，不要使用数组。使用 a`Collection`代替，例如`List(Of T)`类。与其使用多个维度，不如创建一个自定义类来定义列表包含的对象，例如：

```
Public Class Person
    Public Property ID As String
    Public Property PhoneNumbers As New List(Of PhoneNumber) 
End Class

Public Class PhoneNumber
    Public Property Number As String
    Public Property Description As String
End Class 
```

然后，您可以定义动态人员列表，如下所示：

```
Dim people As New List(Of Person) 
```

您可以向一个人添加任意数量的电话号码，如下所示：

```
Dim person As New Person()
Dim phone As New PhoneNumber()
phone.Number = "123-123-1234"
person.PhoneNumbers.Add(phone)

Dim phone2 = New PhoneNumber()
phone2.Number = "123-123-4567"
person.PhoneNumbers.Add(phone2) 
```

同样，您可以添加多个人，如下所示：

```
Dim person2 As New Person()
' ...
people.Add(person)

Dim person2 As New Person()
' ...
people.Add(person2) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T02:13:21.650

正如另一个答案所暗示的那样，这不是首选解决方案，但要回答您的问题，您可以`ReDim Preserve`根据需要使用来增加第一等级的大小：

```
If UBound(storage, 1) < currentIndex Then
    ReDim Preserve storage(currentIndex, 3, 5)
End If

storage(currentIndex, 3, 5) = "abcdefgh" 
```

# eclipse-plugin - 如何为 Eclipse - Kepler 安装 Papyrus？

> ID：14967430
> 
> 赞同：7
> 
> 时间：2013-02-19T21:06:48.560
> 
> 标签：eclipse-plugin, papyrus

我想为 eclipse 4.2.1 安装纸莎草开普勒版本 0.10.x，但我总是在下面出现相同的错误消息：

无法完成安装，因为找不到一项或多项所需项目。正在安装的软件：Papyrus UML (Incubation) 0.10.0.v201302191641 (org.eclipse.papyrus.sdk.feature.feature.group 0.10.0.v2013021916

我需要安装这个版本的纸莎草纸，但我没有找到解决方案，所以请你帮帮我。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-07-02T05:49:10.950

从 Eclipse.org 安装 eclipse-standard-kepler-R-win32 后，我尝试了以下步骤在 Kepler 上安装 Papyrus

1.  点击 Help->Install new software 并选择更新站点 Kepler - [http://download.eclipse.org/releases/kepler](http://download.eclipse.org/releases/kepler)
2.  选择建模并单击下一步。先安装它。
3.  安装 Modeling 后重新启动 Eclipse 后，您会看到帮助菜单中有一个菜单项，其中包含文本“Install Modeling components”选择它
4.  您可以看到 Papyrus 将显示在下一个对话框中。选择并安装它。

# ninject - 是否有可靠的方法将 Ninject 绑定服务范围限定为 NServicebus 消息处理程序？

> ID：14967432
> 
> 赞同：1
> 
> 时间：2013-02-19T21:07:03.897
> 
> 标签：ninject, nservicebus

我想将我的实体框架上下文绑定到每个 NServicebus 消息的范围内。下面的代码会成功地做到这一点吗？

```
Bind<IDbContext>().To<MyContext>()
    .InScope(x => x.Kernel.Get<IBus>().CurrentMessageContext.Id); 
```

**背景**

我有一个 NServicebus 服务，它有几个 IMessageHandlers 从 MSMQ 队列中读取 IEvents。

每个处理程序通过位于实体框架上下文上的特定 IRepository 转换消息并将其保存到 MS SQL 数据库。

每个处理程序所需的存储库通过 ninject 使用 NServicebus.ObjectBuilder.Ninject 注入

```
public class Product
{
    public string Code { get; set; }
    public Category Category { get; set; }
}

public class Category
{
    public string Code { get; set; }
}

public class SampleContext : IDbContext
{
    IDbSet<Product> Products { get; }
    IDbSet<Category> Categories{ get; }
}

public class ProductRepository : IProductRepository
{
    private IDbContext _context;
    public ProductRepository(IDbContext ctx) { _context = ctx; }

    public void Add(Product p)
    {
        _context.Products.Add(p);
        _context.SaveChanges();
    }
}

public class CategoryRepository : ICategoryRepository
{
    private IDbContext _context;
    public CategoryRepository (IDbContext ctx) { _context = ctx; }

    public Category GetByCode(string code)
    {
        return _context.Categories.FirstOrDefault(x => x.Code == code);
    }
}

public class AddProductMessageHandler : IMessageHandler<IAddProductEvent>
{
    private IProductRepository _products;
    private ICategoryRepository _categories;
    public AddProductMessageHandler(IProductRepository p, ICategoryRepository c)
    {
        _products = p;
        _categories = c;
    }

    public void Handle(IAddProductEvent e)
    {
        var p = new Product();
        p.Code = e.ProductCode;
        p.Category = _categories.GetByCode(e.CategoryCode);
        _products.Add(p);
    }
} 
```

**问题**

如果 EF 上下文绑定在瞬态范围内（默认），则处理程序中的每个绑定存储库都有它自己的上下文实例。

```
Bind<IDbContext>().To<SampleContext>(); 
```

如果我从一个存储库加载一个对象然后通过另一个存储库保存它，这会导致问题。

同样，如果它绑定在 Singleton 范围内，则所有存储库都使用相同的上下文，但随后它会慢慢填满跟踪的更改并占用我所有的 ram（并且启动速度越来越慢）。

```
Bind<IDbContext>().To<SampleContext>().InSingletonScope(); 
```

**问题**

理想情况下，我希望每个消息处理程序都有 1 个 EF 上下文，所有必需的存储库（该处理程序的）都使用它来加载和保存实体。

将上下文限定为当前消息 Id 属性是一种安全/可靠/好方法吗？

```
Bind<IDbContext>().To<SampleContext>()
    .InScope(x => x.Kernel.Get<IBus>().CurrentMessageContext.Id); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T11:23:35.740

请参阅我的博文，其中描述了 NSB 4.0 之外的范围

[http://www.planetgeek.ch/2013/01/16/nservicebus-unitofworkscope-with-ninject/](http://www.planetgeek.ch/2013/01/16/nservicebus-unitofworkscope-with-ninject/)

如果您有 3.0，您可以查看当前的开发分支并将扩展方法移植到您的代码中。您只需更改范围名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:34:07.143

我不熟悉 EF Context，所以如果下面的答案没有任何意义，请忽略。

[如果 EF Context 类似于 NH ISession，那么我认为更好的选择是使用与NH implementation](https://github.com/NServiceBus/NServiceBus/blob/master/src/nhibernate/UnitOfWork/NServiceBus.UnitOfWork.NHibernate/UnitOfWorkManager.cs)相同的 UoW 。[您可以在此处](http://support.nservicebus.com/customer/portal/articles/860275-unit-of-work-in-nservicebus)
阅读有关 UoW的更多信息。

# python - 如何在 Xcode 中将 Python 函数导入 C？

> ID：14967435
> 
> 赞同：1
> 
> 时间：2013-02-19T21:07:15.863
> 
> 标签：python, c, xcode

出于研究原因，我正在尝试将 C 和 Python 结合起来，但我的代码中遇到了问题。我使用了教程中的代码，但似乎获取 python 文件的代码不起作用。这是代码：

你好类.py

```
def sayHello(name):
return "Hello " + name + "!" 
```

主程序

```
int main(int argc, const char * argv[]) {
char name[50];
printf("What's your name?\n");
fgets(name, 64, stdin);
char *answer = NULL;
PyObject *modname, *mod, *mdict, *func, *stringarg, *args, *rslt;
Py_Initialize();
PySys_SetPath(Py_GetPath()); 
modname = PyString_FromString("helloClass");
mod = PyImport_Import(modname);// Here mod = null because it can´t find it.
if (mod){
    mdict = PyModule_GetDict(mod);
    func = PyDict_GetItemString(mdict, "sayHello");
    if (func){
        if (PyCallable_Check(func)) {
            stringarg = PyString_FromString(name);
            args = PyTuple_New(1);
            PyTuple_SetItem(args, 0, stringarg);
            rslt = PyObject_CallObject(func, args);
            if (rslt) {
                answer = PyString_AsString(rslt);
                Py_XDECREF(rslt);
            }
            Py_XDECREF(stringarg);
            Py_XDECREF(args);
        }
        Py_XDECREF(mdict);
        Py_XDECREF(func);
    }
    Py_XDECREF(modname);
    Py_XDECREF(mod);
}
printf("%s", answer);
answer = NULL; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:22:07.227

这里没有足够的信息给你完整的答案，但基本问题几乎可以肯定是`helloClass.py`它不会在模块搜索路径的任何地方结束，所以`PyImport_Import`找不到它。

例如，也许您正在将`main`可执行文件构建到类似的位置`~/Library/Developer/Xcode/DerivedData/Hello/Build/Products/Release/hello`，但不在那里复制`helloClass.py`。或者，也许您*正在*将其复制到那里，但等效的`dirname $0`不在您的模块路径中。或者……嗯，有一百万种可能性，但在每种情况下答案都是一样的：

1.  找出可执行文件和 Python 文件的安装位置。

2.  从这些知识中建立一条适当的（可能是相对的）路径。

3.  确保该路径被添加到模块路径中。

关于 Python 如何搜索模块的确切细节在不同版本之间有所不同，但基本思想在[The `import`statement](http://docs.python.org/2/reference/simple_stmts.html#import)（或[3.3 版本](http://docs.python.org/3/reference/simple_stmts.html#import)，它遵循[导入系统](http://docs.python.org/3/reference/import.html#importsystem)）中进行了解释，并且通常只是在[`sys.path`](http://docs.python.org/2/library/sys.html#sys.path).

（请注意，如果您正在构建 .app 包而不仅仅是 Unix 命令行可执行文件，则有一个标准答案——您将 .py 文件放在标准位置，使用 Cocoa 或 CoreFoundation API 获取路径，并且然后使用它。但这似乎与这里无关。）

* * *

查看您在[https://github.com/Eduardof0nt/help.git](https://github.com/Eduardof0nt/help.git)上传的项目：

你不是`helloClass.py`在任何地方复制。您必须决定要将它复制到*哪里*，这完全取决于您要如何部署事物。但是出于调试目的，只是为了获得可测试的东西，您可以将它放在`Hello Python!`可执行文件旁边（in`build/Debug`或`build/Release`）。要做到这一点：

*   在项目导航器中选择项目。
*   在出现的项目视图的左侧栏中选择目标。
*   选择构建阶段选项卡。
*   单击添加构建阶段按钮。
*   添加复制文件阶段。
*   将其目标设置为产品目录。
*   `helloClass.py`从 Project Navigator 拖入构建阶段。

现在，当您构建时，如果您查看输出（打开“All”和“All Messages”），您将在“Link build/Debug/Hello Python”之后看到“Copy build/Debug/helloClass.py” ！”。而且，如果您查看该目录内部，您会并排看到这两个文件。

但这并不能解决您的全部问题。因为`/wherever/you/started/build/Debug`不会出现在`sys.path`Python 使用的那个上。解决此问题的最快方法是在`Py_SetProgramName(argv[0])`之前`Py_Initialize()`和`PySys_SetArgvEx(argc, argv, 1)`之后调用。对于您的用例，这可能不是正确的做法，但是您将阅读文档并了解所有这些内容，因为我无法解释在 SO 中嵌入 Python 的所有细节回答。

当您尝试学习这些东西时，您可能想要进行一些调试。例如，您可以`printf(path=%s\n", Py_GetPath())`查看`sys.path`等价物是什么，以及`PyObject_Print(mod, stdout, 0)`查看 中的内容`mod`等等。但实际上，您会想要使用 Xcode 调试器——添加断点并尝试在运行时执行这些操作。

大部分内容[在 Python 解释器的扩展和嵌入中进行了解释](http://docs.python.org/2/extending/index.html#extending-index)，您确实需要阅读它；没有替代品。（您不需要阅读整个[Python/C API 参考手册](http://docs.python.org/2/c-api/index.html)，但在完成之前，您最终会阅读大量内容，并擅长搜索它。）但是，因为嵌入 Python 的次数要少得多比扩展它更常见，文档实际上并不包含您需要的所有内容，所以……如果您使用的任何教程都没有涵盖诸如`PySys_*`and之类的内容`Py_GetPath`，您可能需要先找到一个更好的教程。

# matlab - matlab中的相关性没有按预期工作

> ID：14967436
> 
> 赞同：0
> 
> 时间：2013-02-19T21:07:15.860
> 
> 标签：matlab, ocr, correlation

我正在使用 matlab 来实现一个执行 OCR 的程序我为每个英文字母 + 数字构建了一个模板。

现在我正在尝试打开一个图像并识别其中的字母，对于基本的开始，我尝试加载一个作为字母模板之一的图像，输入图像和模板图像在所有参数中都是相同的。现在我传递了模板数组并将每个字母\数字模板与输入图像进行比较（使用 corr2 函数），我希望得到正确的结果，因为图像相同，但发现其他字母匹配得更好。可能是什么问题？

*我正在使用 bwlabel 来查找字母本身，然后在它周围切割图像，我正在处理二进制图像

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:17:16.197

也许您需要在计算相关性之前进行一些预处理？建议：转换为黑白，提高对比度，拉直图像，甚至调整大小以匹配模板的大小

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-19T21:34:12.123

如果您的图像是二进制的，唯一的值是零和一，则相关性可能没有达到您的预期。那是因为相关性涉及乘法，任何乘以零都会得到零。要使相关性按您的预期工作，请尝试将所有零更改为负数。

# python - 如何初始化一个python对象并在其他模块之间共享？

> ID：14967439
> 
> 赞同：2
> 
> 时间：2013-02-19T21:07:25.950
> 
> 标签：python, namespaces, python-module

对于我的一生，我发现我的 python 过渡非常令人沮丧。我正在尝试做的一件事是从配置字典中初始化一个类的单个实例，然后在其他模块中访问该类。

我面临的问题/我采取的方法没有解决，我希望有人可以引导正确的“pythonic”方法。

首先，我的应用程序可以作为一个 twistd 插件的一部分进行初始化，也可以作为一个独立的脚本进行初始化。

```
import resource
class App(object):
  _config = None
  _someotherobject = None
  def __init__(self, config):
    self._config = config
    ....

def main():
  global myapp
  myapp = App({}) # Could use help here, how to pass config to it

myapp = None #Global doesnt work as I expect, it doesnt modify this instance, stays as None
if __name__ == '__main__':
  main()

#-----------resource.py
class Foo(object):
  def foo(self):
    app.myapp.somefunction() #NoneType object has no attribute 
```

我已经验证了 app 对象是在另一个模块中的代码启动之前创建的。我只是无法弄清楚为什么模块中的“全局”实例实际上并没有达到我的预期，也对如何从另一个模块引用该实例感到困惑。

----- 编辑 ------ 为了澄清几点，调用脚本时`python app.py` app.py 引用了一个名为的模块，该模块`resources.py`是一堆类定义。在某些类中，当执行时，它们引用 app.myapp 的“单例”实例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:10:04.013

Your `main` will only ever be called as a standalone script not when imported from another module.

```
if __name__ == '__main__':
  main() 
```

Is the trick to make your modules runnable from the command line.

To prove it

```
import app
app.main() 
```

Then run your piece of code.

Once you've initialised it `app` becomes like a singleton, any other module importing it will get that initialised version.

I had a similar problem where I didn't want to access `app` but wanted modules to be able to say `app = MyApp()` and still share the same data ( I forget why I wanted it but it might have had to do with wanting it initialised on first use)

I ended up using a [Borg](https://stackoverflow.com/questions/1318406/why-is-the-borg-pattern-better-than-the-singleton-pattern-in-python) instead of a Singleton.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:34:36.213

您最大的问题是 sotapme 提到的问题。如果您实际上没有`app.py`作为顶级脚本运行，则没有任何代码调用`app.main()`，因此没有初始化全局。

除此之外，如果您知道一件简单的事情，“如何从另一个模块引用实例”非常容易：

在 Python 中，全局变量是命名空间的。

更具体地说，在您的其他模块中，只需`import app`，然后访问全局 as `app.myapp`。

正如 sotapme 解释的那样，使用该`__name__ == '__main__'`技巧意味着您可以`import app`根据需要多次运行，而无需`main()`每次都运行该功能。

特别是，当您运行此命令时：

```
python app.py 
```

Python 解释器将加载`app.py`其`__name__`设置为`'__main__'`，因此该`if`语句将触发，这将导致（模块级）全局变量`myapp`设置为`App({})`。

现在，什么`resource.py`时候 an `import app`，`__name__`它将被设置为`app`，因此该`if`语句*不会*触发，因此您将构造一个 new`App`并替换全局。从 中的代码`resource.py`，您可以使用`app.myapp`，并且您将访问与 中的代码相同的`app.py`对象`myapp`。

* * *

您还要求帮助将配置传递给`App`构造函数。我不确定你的问题是什么。您将一个空`dict`的作为配置传递。如果您有不同`dict`的要通过，请使用它。而不是这个：

```
myapp = App({}) # Could use help here, how to pass config to it 
```

做这个：

```
myapp = App(configdict) 
```

如果您的问题是知道如何获得它`configdict`，那取决于信息的来源。

如果您尝试解析用户可编辑的配置文件，则该[`configparser`](http://docs.python.org/2/library/configparser.html)模块适用于传统的 .ini 样式文件，并且文档具有解释如何处理其他一些流行格式的链接。

如果您尝试从命令行构建配置信息，请参阅[`argparse`](http://docs.python.org/2/library/argparse.html).

如果您想允许环境变量与上述任何一个交互（例如，a`MYAPP_CONFIG`可能会告诉您的`configparser`代码加载与正常情况不同的配置文件，或者 a可能为 的命令行参数`MYAPP_CACHE_DIR`提供不同的默认值），您将获得中的值，但必须编写自己的代码才能对它们执行任何操作。`--cachedir``argparse`[`os.environ`](http://docs.python.org/2/library/os.html#os.environ)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:46:08.787

为了稍微清理一下，这里有一个例子：

```
class App:
    _config = None
    _someotherobject = None

def __init__(self, config):
    self._config = config

def main():
  myapp = App(config) # pass a config object to App

if  __name__ =='__main__':main() 
```

在另一个应用程序中，您必须执行以下操作：

```
from first_app import App

myapp = App(config) 
```

# java - 使用模拟来检查每个对象是否在迭代期间都被分析过

> ID：14967440
> 
> 赞同：0
> 
> 时间：2013-02-19T21:07:33.440
> 
> 标签：java, unit-testing, mocking, mockito

我不知道如何使用模拟来检查我的方法是否每次都被调用。我真的不知道如何描述这个问题，所以我会继续并显示我的代码：

我有两个交互类：`Filter`和`Filtrable`（一个接口）。`Filter`类能够过滤过滤器 - 它返回过滤器（因此可以在必要时应用其他过滤器）。过滤方法只是遍历每个可过滤的行并检查该行是否被过滤 - 如果是，则添加到结果可过滤。我想测试是否真的检查了每个输入行。

这是`Filter`课堂上的代码：

```
public Filtrable filter(Filtrable input) {
    Filtrable result = input.createEmptyFiltrable();
    while(input.hasNextLine()){
        Line line = input.nextLine();
        if(isLineFiltered(line)){
            result.addLine(line);
        }
    }
    return result;
} 
```

这是我的（失败的）尝试测试它：

```
@Test
public void testFilter(){
    Filtrable mockedFiltrable = mock(Filtrable.class);
    when(mockedFiltrable.createEmptyFiltrable()).thenReturn(new StringArrayFiltrable());
    when(mockedFiltrable.hasNextLine()).thenReturn(true,true,true,false);
    when(mockedFiltrable.nextLine()).thenReturn(dummyLine);
    Filter mockedFilter = mock(Filter.class);
    mockedFilter.filter(mockedFiltrable);        
    verify(mockedFilter, times(3)).isLineFiltered(dummyLine);
} 
```

这里的想法是制作一个 stubbed filtrable，它由三个相同的虚拟线组成。然后将它们传递给 Filter 类并检查是否`isLineFiltered`每次都使用相同的 dummyLine 准确地调用了 3 次方法。

在阅读了 Martin Fowler 的[Mocks Aren't Stubs](http://martinfowler.com/articles/mocksArentStubs.html "模拟不是存根")之后，我明白这是完全错误的，因为我没有在`Filter`任何地方测试实际系统（）！

那么如何验证“被测系统”中的方法是否使用模拟调用了 3 次呢？这是至关重要的，因为我正在尝试学习这种方法。我可以轻松地创建一个继承自 Filter 的测试类并计算`isLineFiltered`调用的次数，然后检查它。我只是觉得这可以用模拟很好地完成。

我在这里使用 Mockito，如果有任何建议也可以使用它会很好（但任何其他 java 模拟框架当然会这样做）。

附言

在我运行测试后，抛出了 Mockito`Wanted but not invoked: filter.isLineFiltered`的异常。

**编辑：**

过滤界面如下：

```
public interface Filtrable {
  public Filtrable createEmptyFiltrable();
  public boolean hasNextLine();
  public void addLine(Line line);
  public Line nextLine() throws FiltrableException;
} 
```

**解决方案：**

以下是我最终的做法：

```
@Test
public void testFilter(){
    Filtrable mockedFiltrable = mock(Filtrable.class);
    Filtrable mockedFiltrableResult = mock(Filtrable.class);
    when(mockedFiltrable.createEmptyFiltrable()).thenReturn(mockedFiltrableResult);
    Iterator<Line> mockedIterator = mock(Iterator.class);
    when(mockedFiltrable.iterator()).thenReturn(mockedIterator);
    when(mockedIterator.hasNext()).thenReturn(true,true,true,false);
    when(mockedIterator.next()).thenReturn(dummyLine);
    Filter filterUnderTest = new TestFilter(true);
    filterUnderTest.filter(mockedFiltrable);        
    verify(mockedFiltrableResult,times(3)).addLine(dummyLine);
} 
```

我已将 Filtrable 接口更改为扩展 Iterable，这就是为什么最终解决方案与我最初的尝试略有不同的原因。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:42:16.500

您的测试的问题之一是您实际上并没有测试您的过滤器类，因为您也被嘲笑了。

该错误也是意料之中的。您指定`isLineFiltered`要调用 3 次，但您还模拟了正在测试的类。这会导致过滤器方法也被模拟，因此`isLineFilter`不会调用您的方法。

如何使用模拟进行测试的一个简单示例：

```
@Controller
public class KajmanController {
    @Autowired
    private KajmanInfoService kajmanInfoService;

    @RequestMapping(method = RequestMethod.GET)
    public String getInfo(@RequestParam(value="myParam[]") String[] myParams){
        //some logic
        for (String param : myParams) {
            Info info = kajmanInfoService.getInfo(param);
            //some logic
        }
        //some logic
    }
} 
```

那么你唯一需要模拟的是kajmanInfoService。

因此，您的测试可能类似于以下内容：

```
 @RunWith(MockitoJUnitRunner.class)
    public class KajmanControllerTest {

        @Mock
        private KajmanInfoService kajmanInfoService ;

        @InjectMocks
        private KajmanController controller;

        @Test
        public void customerInfoRetrieved() {
            //some logic
            when(kajmanInfoService.getInfo(anyString()).thenReturn(expectedInfo);
            //some logic
            String[] expectedInfoArguments = {"A1","B1","C1"};
            controller.getInfo(expectedInfoArguments);
            verify(kajmanInfoService, times(3)).getInfo(anyString);
        }
    } 
```

我确实这样做了，所以它可能包含一些小错误。

# jquery - 我需要在 jquery 中循环简单的延迟动画

> ID：14967441
> 
> 赞同：0
> 
> 时间：2013-02-19T21:07:33.673
> 
> 标签：jquery, loops, infinite-loop

嗨，我有一组图像，一旦我需要无限循环，它们就会以不同的速度淡入。有人可以帮我写代码。这确实是基本的动画，但我发现的代码以相同的速度循环所有内容。谁能帮我把这个动画放到一个循环中，它会产生同样的淡入淡出效果，但会无限循环。谢谢

* * *

谢谢您的帮助。

```
<script>
$(document).ready(function anim() {
// fade in initial
$('#img-1').delay(0).fadeIn(500);;
$('#img-2').delay(0).fadeIn(500);
$('#txt-1').delay(0).fadeIn(500)
$('#txt-2').delay(0).fadeIn(500);
// move to set 2
$('#txt-1').delay(2000).fadeOut(500);
$('#txt-2').delay(2000).fadeOut(500);
$('#txt-3').delay(2000).fadeIn(500);
$('#txt-4').delay(2000).fadeIn(500);
$('#img-1').delay(5000).fadeOut(500);
$('#img-2').delay(5000).fadeOut(500);
$('#img-3').delay(5000).fadeIn(500);
$('#img-4').delay(5000).fadeIn(500);
// move to set 3
$('#txt-3').delay(8000).fadeOut(500);
$('#txt-4').delay(8000).fadeOut(500);
$('#txt-5').delay(8000).fadeIn(500);
$('#txt-6').delay(8000).fadeIn(500);
$('#img-3').delay(11000).fadeOut(500);
$('#img-4').delay(11000).fadeOut(500);
$('#img-5').delay(11000).fadeIn(500);
$('#img-6').delay(11000).fadeIn(500);
// move to set 4
$('#txt-5').delay(14000).fadeOut(500);
$('#txt-6').delay(14000).fadeOut(500);
$('#txt-7').delay(14000).fadeIn(500);
$('#txt-8').delay(14000).fadeIn(500);
$('#img-5').delay(17000).fadeOut(500);
$('#img-6').delay(17000).fadeOut(500);
$('#img-7').delay(17000).fadeIn(500);
$('#img-8').delay(17000).fadeIn(500);
});
</script>

<body>

<div id="home-right"> 
```

图片

```
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:42:20.140

使用 setTimeout 进行一点递归应该可以工作。

```
$.fn.loopFadeAnimation = function (delay, fadeType, duration) {
    var that = $(this);

    delay = delay || 0;
    duration = duration || 0;

    // call animation
    $(this).delay(delay)[fadeType](duration);

    // call loopFadeAnimation again with a setTimeout
    setTimeout(function () {
        var newFadeType = ('fadeIn' === fadeType)
            ? 'fadeOut'
            : 'fadeIn';
        $(that).loopFadeAnimation(delay, newFadeType, duration);
    }, delay + duration);

    return $(this); // for chaining
};

$('#img-1').loopFadeAnimation(0, 'fadeIn', 500); // etc. 
```

# ios - 具有多对多关系的 NSPredicate

> ID：14967442
> 
> 赞同：0
> 
> 时间：2013-02-19T21:07:38.260
> 
> 标签：ios, cocoa-touch, core-data, nspredicate

我在两个模型之间有一对多的关系`user <-->> followers`，关注者表由`userId`s 组成。我想发出 fetch 请求以将关联的用户带到 theese `userId`。我的谓词目前看起来像这样：

```
predicate = [NSPredicate predicateWithFormat:@"ANY userId IN %@", self.user.followers]; 
```

这导致 0 个结果。我想知道这个谓词应该是什么样子？

**更新**

我用于将追随者对象添加到用户的代码（来自 JSON 数据）：

```
+ (void)insertFollowersFromDict:(NSDictionary *)dictionary forUser:(User *)user  inManagedObjectContext:(NSManagedObjectContext*)moc
{
    NSArray *followers = [dictionary objectForKey:@"data"];

    if (followers.count != 0) {
        NSEntityDescription *entityDescription = [NSEntityDescription entityForName:@"Follower" inManagedObjectContext:moc];
        for (NSString *followerId in followers) {
            Follower *newFollower = [[Follower alloc] initWithEntity:entityDescription insertIntoManagedObjectContext:moc];
            NSNumberFormatter * numberFormatter = [[NSNumberFormatter alloc] init];
            newFollower.user = [User findUser:[numberFormatter  numberFromString:followingId] inManagedObjectContext:moc];
            [user addFollowersObject:newFollower];
        }
    }
} 
```

我用来在表格视图中配置单元格的代码：

```
// This for some reason always result in the same user. 
Follower *follower = [self.fetchedResultsController objectAtIndexPath:indexPath];
User *cellUser = follower.user;

// Always self.user
cell.text = cellUser.name

------------------------
I Anders               I
------------------------
------------------------
I Anders               I 
------------------------ 
```

我不确定为什么会这样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:18:03.300

您应该在对象之间建立关系。您不必将 存储`userID`在`Follower`对象中。这样你就可以简单地写：

```
predicate = [NSPredicate predicateWithFormat:@"user = %@", self.user]; 
```

这将返回所有`Followers`与`self.user`. 希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T11:59:53.200

安德斯，

我将尝试提供一些关于我认为非常适合让您的应用运行的模型的详细信息。

首先，您的模型应如下所示（如您所见，我跳过了属性）。

![在此处输入图像描述](../Images/5cf1a2593ae7565ada4416e368893d77.png)

An`User`链接到零个或多个`Follower`s。

让我知道讨论关系。

`followers``Follower`是与实体的一对多关系。它是这样设置的。

![在此处输入图像描述](../Images/3a5d1c32bc6cf9a5c692b83f8464c366.png)

如您所见，rel 是**可选**的，因为用户不能有任何关注者。删除规则是**级联**的，因为如果您删除用户，其关注者也将被删除。

`user`相反，对用户来说是一对一的关系。它看起来像这样。

![在此处输入图像描述](../Images/7755c00c847b110321d3682064b3fdf7.png)

这不是**可选**的，因为追随者只能与用户一起存在。这是**无效**的，因为如果您删除关注者，更改将不会对关联用户产生影响。

**注意**我根据您提供的规格创建了模型，但我认为它也可以扩展以适应多对多关系。这意味着：不同的用户可以拥有相同的关注者。

现在，如果您创建一个 fetch 请求`Follower`，您可以通过以下方式检索属于特定用户的所有关注者。

```
NSFetchRequest* request = [NSFetchRequest fetchRequestWithEntityName:@"Follower"]
[request setPredicate:[NSPredicate predicateWithFormat:@"user == %@", self.user]];
NSArray* results = // execute the request here

// results will contain the followers for a specific user (i.e. the one you used in the predicate) 
```

希望有帮助。

**编辑**

```
NSManagedObject* follower = [followerResults objectAtIndex:[indexPath row]]; // this gives you a follower, put some error control if followerResults has no elements
NSManagedObject* user = [follower objectForKey:@"user"]; // this gives you the user associated to that follower 
```

**编辑 2**

我不清楚你的意思，但行为是正确的，因为你正在使用

```
cell.text = cellUser.name 
```

通过这种方式，您可以检索与用户关联的名称。**只有一个用户与该组关注者相关联**。

例如，用户 Andrew 有零个或多个关注者（Mike、Bob、Todd）。

您使用的获取请求执行以下操作：**将用户为 Andrew 的所有关注者提供给我。**

如果要显示关注者更改，例如

```
cell.text = follower.name; // if Follower entity has a name attribute 
```

**非常非常非常重要**

`Follower`向您的实体添加新属性（不是关系） 。调用它`name`并使其成为 type `NSString`。正如你对`User`实体所做的那样（我想）。

然后，当您创建一个新`Follower`对象时，您将其设置为

```
 newFollower.user = // set the user
 newFollower.name = // set the name 
```

我真的建议了解**ATTRIBUTES**和**RELATIONSHIPS**之间的区别。

前者是特定实体的属性（例如姓名、年龄、性别）。后者是实体之间的链接。

# jquery - Facebook Connect 的实现 - 登录/注销按钮

> ID：14967444
> 
> 赞同：0
> 
> 时间：2013-02-19T21:07:44.317
> 
> 标签：jquery, facebook, login, onclick, facebook-javascript-sdk

第一次为我实现 Facebook 登录，但我无法让它正常工作。

我正在实现 Facebook Javascript SDK，我所做的是将 Facebooks 指南中提供的 js 代码放在一个单独的 js 文件中，以防止我的 index.html 文件变得混乱，这似乎工作正常。

**但是，我有两个问题需要帮助：**

1.  下面的代码触发了 login() 和 logout() 函数（取决于用户是否登录）给了我一个丑陋的通用按钮。我想要 Facebook 自己的按钮。我该如何使用它？

2.  注销并单击登录按钮时，登录弹出窗口会打开两次而不是一次。这样做的原因是 js 文件（facebook.js）被加载了两次，（由于某种原因）这意味着点击事件被绑定了两次。我该如何防止这种情况发生？

我需要在自己下面编写代码，因为我在 Facebook 的指南中找不到任何关于此的内容。如果有，我在哪里可以找到它？

```
function showLoginButton() {
      $('#FBButton').html('Log in Facebook');
      $('#FBButton').on('click', function(){
          login();
      });
    }

function showLogoutButton() {
  $('#FBButton').html('Log out Facebook');
  $('#FBButton').on('click', function(){
      logout();
  });
}

showLoginButton();
showLogoutButton(); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T13:45:29.740

使用 Facebook 自己的[登录按钮](http://developers.facebook.com/docs/reference/plugins/login/)将解决您的问题。

```
<div class="fb-login-button" autologoutlink="true" data-show-faces="true" data-width="200"
        data-max-rows="2" size="medium"> 
```

当用户连接时，按钮的文本和功能将自动变为“注销”，反之亦然。

# java - 从与 .jar 文件位于同一文件夹中的文件读取

> ID：14967449
> 
> 赞同：21
> 
> 时间：2013-02-19T21:08:05.460
> 
> 标签：java, file, jar

有没有办法从与 .jar 文件位于同一文件夹中的文件中读取？我正在尝试创建一个在提交作业时必须从文件中读取的 java 程序。一旦我把文件或程序翻过来，我不知道文件或程序将保存在哪里，所以我认为我不能对保存文件的目录进行编码。这可能吗？问题是我必须将文件上传到作为 linux 服务器的 CSX 主机服务器并从那里运行它。如果我没有在文件之前放置路径，它只会搜索其当前文件夹位置吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-20T09:24:30.983

您可以通过以下方式获取包含任何特定类的 JAR 文件的位置：

```
URL url = thisClass.getProtectionDomain().getCodeSource().getLocation(); 
```

从那里很容易将 URL 相对化到所需的文件。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-02-19T21:47:09.870

**如评论中所述，这仅在您从 jar 所在的目录运行命令时才有效。**

*（在桌面应用程序的上下文中）*
要访问当前目录中的文件`jar`，您`path`的文件前面应该有一个点。例子：

```
String path = "./properties.txt";
FileInputStream fis = new FileInputStream(path);
BufferedReader in = new BufferedReader(new InputStreamReader(fis));
// Read the file contents... 
```

在此示例中，`properties.txt`在与`jar`.
该文件将被包含在`jar`.

**编辑：**您说文件名不会改变，并且这个答案适用于您事先知道名称，当然，如果您更喜欢硬编码它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-19T22:30:57.923

如果输入文件名可以被硬编码，并且您知道它将始终与包含您的代码的 jar 位于同一目录中，那么这应该可以工作：

```
public static void main(String[] args) {

    try {
        // Determine where the input file is; assuming it's in the same directory as the jar
        String fileName = "input.txt";
        File jarFile = new File(Main.class.getProtectionDomain().getCodeSource().getLocation().toURI().getPath());
        String inputFilePath = jarFile.getParent() + File.separator + fileName;         
        FileInputStream inStream = new FileInputStream(new File(inputFilePath));

        try {

            // Read in the contents of the input file in a single gulp
            FileChannel fc = inStream.getChannel();
            MappedByteBuffer bb = fc.map(FileChannel.MapMode.READ_ONLY, 0,
                    fc.size());

            // Do something with the read in data
            System.out.println(Charset.defaultCharset().decode(bb)
                    .toString());
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            inStream.close();
        }

    } catch (IOException | URISyntaxException e) {
        e.printStackTrace();
    }

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-03-06T06:57:01.390

@kcpr - 感谢您提供的解决方案。下面一个对我有用。

```
private static String CONFIG_FILE_LOCATION = "lib"+ File.separator + "Config.properties";

static {
    File jarFile = new File(Main.class.getProtectionDomain().getCodeSource().getLocation().toURI().getPath());
    String inputFilePath = jarFile.getParent() + File.separator + CONFIG_FILE_LOCATION; 
    propConfig = new PropertiesConfiguration(new File(inputFilePath));
    propConfig.load();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-20T01:14:52.963

要使其“自包含”，请将资源*放在*Jar 中。然后它成为一个（只读）[嵌入式资源](https://stackoverflow.com/tags/embedded-resource/info)，我们可以使用以下内容获取它的 URL：

```
URL url = this.getClass().getResource("/path/to/the.resource"); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-03-09T13:16:33.600

以下是获取 jar 文件的干净目录路径的方法（基于 EJP 的回答）：

```
URL url = IssueInfoController.class.getProtectionDomain().getCodeSource().getLocation();
String urlString = url.toString();
int firstSlash =  urlString.indexOf("/");
int targetSlash = urlString.lastIndexOf("/", urlString.length() - 2) + 1;

return urlString.substring(firstSlash, targetSlash) + YOUR_FILE; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-19T21:14:38.703

根据您的评论，我认为您最好的解决方案是将上传文件的绝对路径传递到 jar 中。

您可以将路径作为命令行参数传递到 jar 中。由于路径和文件名没有改变，并且您从 linux 运行它，您可以创建一个 .sh 脚本来运行它。

```
#!/bin/bash    
java -jar myjar.jar /path/to/file/filename.txt 
```

这也使您无需在文件路径中进行硬编码，或将文件名放入 jar 中。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-02-19T22:03:42.417

```
public class TestClassLoaderAccess {
    public static void main(String[] argv) {
        TestClassLoaderAccess me = new TestClassLoaderAccess();
        ClassLoader myLoader = me.getClass().getClassLoader();
        System.out.println(myLoader.getClass().getSuperclass().getName());
        java.net.URLClassLoader myUrlLoader = (java.net.URLClassLoader) myLoader;
        java.net.URL resource = myUrlLoader.findResource("TestClassLoaderAccess.class");
        System.out.println(resource.toString());
    }
} 
```

运行它：

```
C:\JavaTools>javac TestClassLoaderAccess.java

C:\JavaTools>java TestClassLoaderAccess
java.net.URLClassLoader
file:/C:/JavaTools/TestClassLoaderAccess.class

C:\JavaTools> 
```

（第一个 println 只是为了证明类加载器是 URLClassLoader 的子类。）

# c# - Ninject.Extensions.Conventions Inject Singletons in Lists binding on Interface 和 BaseClass

> ID：14967453
> 
> 赞同：2
> 
> 时间：2013-02-19T21:08:19.453
> 
> 标签：c#, binding, singleton, ninject

我得到了以下将失败的测试用例：

> 预期：与 ArxScriptsTests.Engines.Ioc.Examples+A 相同但为：ArxScriptsTests.Engines.Ioc.Examples+A

问题是，如何做到正确？

```
[TestFixture]
public class Examples
{
    public interface IInterface
    {

    }

    public abstract class BaseClass : IInterface
    {

    }

    public class A : BaseClass
    {

    }

    public class B : BaseClass
    {

    }

    [Test]
    public void TestMethod1()
    {
        IKernel kernel = new StandardKernel();

        // Bind to self
        kernel.Bind(x => x
            .FromThisAssembly()
            .SelectAllClasses().InheritedFrom<BaseClass>()
            .BindToSelf()
            .Configure(b => b.InSingletonScope())
            );

        // Bind to IInterface
        kernel.Bind(x => x
            .FromThisAssembly()
            .SelectAllClasses().InheritedFrom<IInterface>()
            .BindSelection((type, baseTypes) => new List<Type> { typeof(IInterface) })
            .Configure(b => b.InSingletonScope())
            );

        // Bind to BaseClass
        kernel.Bind(x => x
            .FromThisAssembly()
            .SelectAllClasses().InheritedFrom<BaseClass>()
            .BindSelection((type, baseTypes) => new List<Type> { typeof(BaseClass) })
            .Configure(b => b.InSingletonScope())
            );

        List<IInterface> byInterface = new List<IInterface>(kernel.GetAll<IInterface>());
        List<BaseClass> byBaseClass = new List<BaseClass>(kernel.GetAll<BaseClass>());

        Assert.AreSame(byInterface[0], byBaseClass[0]);
    }
} 
```

**一种解决方案是**

```
[Test]
public void TestMethod1()
{
    IKernel kernel = new StandardKernel();

    // Bind to Both
    kernel.Bind(x => x
        .FromThisAssembly()
        .SelectAllClasses().InheritedFrom<IInterface>()
        .BindSelection((type, baseTypes) => new List<Type> { typeof(IInterface), typeof(BaseClass) })
        .Configure(b => b.InSingletonScope())
        );

    List<IInterface> byInterface = new List<IInterface>(kernel.GetAll<IInterface>());
    List<BaseClass> byBaseClass = new List<BaseClass>(kernel.GetAll<BaseClass>());

    Assert.AreSame(byInterface[0], byBaseClass[0]);
} 
```

**但是**当我尝试将两个绑定放在不同的模块中时，这将无济于事。或者这是一个坏主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T12:01:08.860

范围是为绑定定义的。两个绑定无法共享范围。

你应该做什么：

1.  使用接口而不是`BaseClass`
2.  找到一个编码约定来定义什么类型的类是单例。例如特殊命名，如以 Service 结尾
3.  使用 BindAllInterfaces 绑定它们

当使用约定时，这不应该从消费者的角度来做，而应该从服务提供者的角度来做。所以不需要在不同的模块中对不同的接口类型进行绑定。

# android - 如何检查 Android 2.x 中是否设置了窗口功能

> ID：14967454
> 
> 赞同：2
> 
> 时间：2013-02-19T21:08:20.110
> 
> 标签：android

我想检查是否设置了功能。我可以使用[hasFeature](http://developer.android.com/reference/android/view/Window.html#hasFeature%28int%29)，但它适用于 API 11 及更高版本，令我困惑的是[getFeatures](http://developer.android.com/reference/android/view/Window.html#getFeatures%28%29)受到保护。这意味着我不能在不使用反射黑客的情况下调用我的活动代码。

有没有标准的方法来检查 Android 2.x 上的窗口功能？

# wpf - 根据其他控件动态更改控件属性

> ID：14967456
> 
> 赞同：0
> 
> 时间：2013-02-19T21:08:38.523
> 
> 标签：wpf, xaml, wpf-controls

在 WPF 中，我有一个一行两列的网格。

```
<Grid>
 <Textbox Grid.Column=0>
  <Validation.ErrorTemplate>
   <DockPanel>
    <Image DockPanel.Dock="Right" Margin="20,0,0,0"/>
   </DockPanel>
  </Validation.ErrorTemplate>
 </Textbox>
<Button Grid.Column=1>
</Button> 
```

我希望图像（错误图标）保留在按钮的右侧，该按钮的大小可以根据其文本而变化。有没有办法根据按钮的宽度动态设置图像的边距？现在它只是固定在文本框右侧的 20 像素处。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:24:22.720

验证错误模板显示在一个特殊的装饰层中。如果您需要相对于装饰元素定位元素，只需在 XAML 中使用[AdornedElementPlaceholder类。](http://msdn.microsoft.com/ru-ru/library/system.windows.controls.adornedelementplaceholder.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T17:59:43.920

我认为不可能完成您想要做的事情，除非在该模板或样式中定义了引用的元素，否则您无法从数据模板中引用元素。您可以通过其他方式进行操作，[请参见此处](https://stackoverflow.com/questions/1615631/listing-all-validation-errors-in-a-single-wpf-control)。

# c# - 如何在 Web API 消息处理程序中提取自定义标头值？

> ID：14967457
> 
> 赞同：172
> 
> 时间：2013-02-19T21:08:38.677
> 
> 标签：c#, asp.net-web-api, httprequest

我目前在我的 Web API 服务中有一个消息处理程序，它覆盖了“SendAsync”，如下所示：

```
protected override Task<HttpResponseMessage> SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
{
  //implementation
} 
```

在此代码中，我需要检查一个自定义添加的请求标头值，名为`MyCustomID`. 问题是当我执行以下操作时：

```
if (request.Headers.Contains("MyCustomID"))  //OK
    var id = request.Headers["MyCustomID"];  //build error - not OK 
```

...我收到以下错误消息：

> 无法使用 [] 将索引应用于“System.Net.Http.Headers.HttpRequestHeaders”类型的表达式

如何通过传递给此重写方法的（[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.net.http.headers.httprequestheaders.aspx)）实例访问*单个*自定义请求标头？`HttpRequestMessage`

* * *

## 回答 #1

> 赞同：283
> 
> 时间：2013-02-19T21:14:06.347

尝试这样的事情：

```
IEnumerable<string> headerValues = request.Headers.GetValues("MyCustomID");
var id = headerValues.FirstOrDefault(); 
```

如果您不能始终保证可以访问标头，则可以使用标头上的**TryGetValues方法。**

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2014-09-03T09:01:05.067

`throws exception`如果密钥不存在，则在下面的行。

```
IEnumerable<string> headerValues = request.Headers.GetValues("MyCustomID"); 
```

**使用 TryGetValues 的安全解决方案：**

包括 System.Linq；

```
IEnumerable<string> headerValues;
var userId = string.Empty;

     if (request.Headers.TryGetValues("MyCustomID", out headerValues))
     {
         userId = headerValues.FirstOrDefault();
     } 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-07-24T22:25:30.203

为了扩展优素福的回答，我基于 Drew 对不存在标头的担忧编写了此方法，因为我在单元测试期间遇到了这种情况。

```
private T GetFirstHeaderValueOrDefault<T>(string headerKey, 
   Func<HttpRequestMessage, string> defaultValue, 
   Func<string,T> valueTransform)
    {
        IEnumerable<string> headerValues;
        HttpRequestMessage message = Request ?? new HttpRequestMessage();
        if (!message.Headers.TryGetValues(headerKey, out headerValues))
            return valueTransform(defaultValue(message));
        string firstHeaderValue = headerValues.FirstOrDefault() ?? defaultValue(message);
        return valueTransform(firstHeaderValue);
    } 
```

这是一个示例用法：

```
GetFirstHeaderValueOrDefault("X-MyGuid", h => Guid.NewGuid().ToString(), Guid.Parse); 
```

另请查看@doguhan-uluca 的答案以获得更通用的解决方案。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2016-04-05T17:39:31.897

创建一个新方法 - '**返回一个单独的 HTTP Header 值**'，并在每次需要从 HttpRequestMessage 访问多个键值时使用键值调用此方法。

```
public static string GetHeader(this HttpRequestMessage request, string key)
        {
            IEnumerable<string> keys = null;
            if (!request.Headers.TryGetValues(key, out keys))
                return null;

            return keys.First();
        } 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2016-02-17T15:50:08.220

为了进一步扩展@neontapir 的解决方案，这里有一个更通用的解决方案，可以同样适用于 HttpRequestMessage 或 HttpResponseMessage 并且不需要手动编码的表达式或函数。

```
using System.Net.Http;
using System.Collections.Generic;
using System.Linq;

public static class HttpResponseMessageExtensions
{
    public static T GetFirstHeaderValueOrDefault<T>(
        this HttpResponseMessage response,
        string headerKey)
    {
        var toReturn = default(T);

        IEnumerable<string> headerValues;

        if (response.Content.Headers.TryGetValues(headerKey, out headerValues))
        {
            var valueString = headerValues.FirstOrDefault();
            if (valueString != null)
            {
                return (T)Convert.ChangeType(valueString, typeof(T));
            }
        }

        return toReturn;
    }
} 
```

示例用法：

```
var myValue = response.GetFirstHeaderValueOrDefault<int>("MyValue"); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-11-05T09:17:31.377

[对于 ASP.NET，您可以使用这个简单的 library/package](https://www.nuget.org/packages/Raz.HeaderAttribute/)直接从控制器方法中的参数获取标头。它提供了一个`[FromHeader]`属性，就像您在 ASP.NET Core 中一样:)。例如：

```
 ...
    using RazHeaderAttribute.Attributes;

    [Route("api/{controller}")]
    public class RandomController : ApiController 
    {
        ...
        // GET api/random
        [HttpGet]
        public IEnumerable<string> Get([FromHeader("pages")] int page, [FromHeader] string rows)
        {
            // Print in the debug window to be sure our bound stuff are passed :)
            Debug.WriteLine($"Rows {rows}, Page {page}");
            ...
        }
    } 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-06-22T23:10:11.003

一行解决方案（假设表头存在）

```
var id = request.Headers.GetValues("MyCustomID").FirstOrDefault(); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-05-24T08:46:44.477

对于 ASP.Net Core，如果想直接在控制器方法中使用参数，有一个简单的解决方案：使用 [FromHeader] 注释。

```
 public JsonResult SendAsync([FromHeader] string myParam)
        {
        if(myParam == null)  //Param not set in request header
        {
           return null;
        }
        return doSomething();
    } 
```

附加信息：在我的情况下，“myParam”必须是一个字符串，int 总是 0。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-06-02T06:42:11.137

```
request.Headers.FirstOrDefault( x => x.Key == "MyCustomID" ).Value.FirstOrDefault() 
```

现代变体:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-09-16T13:04:56.110

这听起来很明显，但请确保您正在读取标头的控制器是请求通过的**第一个控制器。**

我有两个相互通信的 WebAPI 项目。第一个是代理，第二个包含逻辑。愚蠢的我，我尝试阅读第二个控制器中的自定义标题，而不是第一个。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-03T06:36:34.720

```
var token = string.Empty;
if (Request.Headers.TryGetValue("MyKey",  out headerValues))
{
    token = headerValues.FirstOrDefault();
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-10-15T18:55:39.837

另一种方法

```
 string customHeader = string.Empty;
        if (Request.Headers.TryGetValue("x-date", out var xdateValue))
        {
            customHeader = xdateValue;
        }; 
```

# javascript - setTimeout(callback) 后跟 while 循环永远不会触发

> ID：14967459
> 
> 赞同：1
> 
> 时间：2013-02-19T21:08:48.303
> 
> 标签：javascript, callback, settimeout

我在下面有以下代码（请注意，稍后我将在循环中添加更多代码，但我需要首先使用它）：

```
var calls_on = true;
function hunt(max, ext, duration){
    if(duration != '0' || duration != false || duration != 0){
        duration = duration * 1000; // milliseconds to delay before stopping calls
        var t=setTimeout(function(){calls_on=false;}, duration);
    }
    while(calls_on){
        alert('reached');
    }
    alert('test');
} 
```

我已经确认“持续时间”条件正在执行，并且正在设置超时句柄。然而，这个循环永远不会结束，而且我从来没有看到 setTimeout 回调被执行。当我完全删除循环时，它工作正常（因为这使它成为函数中的唯一代码）。

任何帮助，将不胜感激。setTimeout 是否超出范围？循环如何使超时脱轨？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T21:11:34.027

JavaScript 是单线程的。只要代码卡在循环中，超时就永远不会运行。

任何依赖超时完成的事情都应该在超时范围内。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-19T21:14:55.010

来自[基于事件的编程：异步有什么超过同步](http://net.tutsplus.com/tutorials/javascript-ajax/event-based-programming-what-async-has-over-sync/)

> 有趣的是，直到块中的所有剩余代码都执行完毕后才会执行超时。因此，如果设置了超时，然后执行了某个长时间运行的函数，那么在该长时间运行的函数完成之前，超时甚至不会开始。实际上，像 setTimeout 和 setInterval 这样的异步函数被推送到称为事件循环的队列中

因此，由于您有一个无限循环，因此您`setTimeout`永远不会执行。

# c# - 字符串比较和单个字符的字母顺序

> ID：14967462
> 
> 赞同：19
> 
> 时间：2013-02-19T21:08:57.130
> 
> 标签：c#, string, string-comparison

我有一个关于字符串比较与字符比较的问题。

字符`>`和`0`（零）相应地具有以下十进制`62`值`48`。

当我比较以下代码中的两个字符时，我得到了值`True`（这是正确的）

```
Console.WriteLine('>' > '0'); 
```

当我比较以下代码中的两个单字符字符串时，我得到的值`-1`表明*“>”小于“0”*（默认文化是英语）

```
Console.WriteLine(string.Compare(">", "0")); 
```

而以下代码中“3”和“1”（`51`和`49`代码值）的比较返回`1`（如预期的那样）

```
Console.WriteLine(string.Compare("3", "1")); 
```

此外，`string.Compare(string str1, string str2)`文档说：

> 比较使用当前文化来获取特定于文化的信息，例如大小写规则和单个字符的字母顺序

您能否解释（或提供对某些文档的参考）如何实现字符串比较，例如如何计算*单个字符的字母顺序*等？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-19T21:25:05.067

字符串的排序顺序取决于您使用的文化。

[StringComparer.CurrentCulture](http://msdn.microsoft.com/en-us/library/system.stringcomparer.currentculture.aspx)在我的机器上对以下 1 个字符的字符串进行如下排序：

```
' -   ! " # $ % & (  ) * , . / : ; ? @ [
\ ] ^ _ ` { | } ~ +  < = > 0 1 2 3 4 5 6
7 8 9 a A b B c C d  D e E f F g G h H i
I j J k K l L m M n  N o O p P q Q r R s
S t T u U v V w W x  X y Y z Z 
```

[StringComparer.Ordinal](http://msdn.microsoft.com/en-us/library/system.stringcomparer.ordinal.aspx)对相同的字符串进行如下排序：

```
 ! " # $ % & ' ( )  * + , - . / 0 1 2 3
4 5 6 7 8 9 : ; < =  > ? @ A B C D E F G
H I J K L M N O P Q  R S T U V W X Y Z [
\ ] ^ _ ` a b c d e  f g h i j k l m n o
p q r s t u v w x y  z { | } ~ 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-02-19T21:23:41.320

当您比较字符`'>'`和`'0'`时，您是在比较它们的序数值。

要从字符串比较中获得相同的行为，请提供序数字符串比较类型：

```
 Console.WriteLine(string.Compare(">", "0", StringComparison.Ordinal));
  Console.WriteLine(string.Compare(">", "0", StringComparison.InvariantCulture));
  Console.WriteLine(string.Compare(">", "0", StringComparison.CurrentCulture)); 
```

默认情况下使用当前的文化，它有一个排序顺序，旨在按“字母顺序”而不是严格的词汇顺序对字符串进行排序，对于一些字母顺序的定义。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-19T21:26:19.603

听起来您想要的是不使用特定于文化的规则的比较。您是否尝试过 StringComparison.Ordinal：

```
Console.WriteLine( string.Compare( ">", "0", StringComparison.Ordinal ) ); // returns a positive number 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T21:12:01.983

it returns `-1` because it is comparing `str2` to `str1`, not the other way around. Eg, "is 48 equal to 62". No, it's less than 62 so it returns -1\. It's semantically a little confusing when you read the parameter order

# php - 可使用 AJAX 排序的 jQuery 只能每隔一段时间使用一次

> ID：14967464
> 
> 赞同：1
> 
> 时间：2013-02-19T21:09:03.923
> 
> 标签：php, jquery, mysql, ajax, jquery-ui-sortable

我有一个字段表，其中包含使用 jQuery 的可排序插件的拖动排序句柄，该插件反过来通过 AJAX 触发 PHP 脚本，以在单击提交按钮后保存更改。但是，它实际上仅平均每隔一次有效。每隔一段时间，我就会连续两次成功运行，但这种情况非常罕见。

这是我的 HTML，动态生成：

```
<div class="foldertable">
  <table class="data" id="sortable">
    <tr class="odd" id="field_21">
      <td class="handle"><a href="/admin/database/customfields/edit?cfid=21">Occupant Name</a></td>
    </tr>
    <tr class="even" id="field_22">
      <td class="handle"><a href="/admin/database/customfields/edit?cfid=22">DBA</a></td>
    </tr>
    <tr class="odd" id="field_23">
      <td class="handle"><a href="/admin/database/customfields/edit?cfid=23">Tenant Contact</a></td>
    </tr>
  </table>
  <a href="" id="button" class="textbutton">Update Order</a>
</div> 
```

还有我的 jQuery：

```
 <script type="text/javascript">
    var fixHelper = function(e, ui) {
        ui.children().each(function() {
            $(this).width($(this).width());
        });
        return ui;
    };
    $(document).ready(function(){
        $("#sortable tbody").sortable({ 
            helper: fixHelper,
            opacity: 0.6, 
            update: function(){
                $('#savemessage').html('<p>Click <em>update order</em> to save</p>');
                $('#button').show();
                }
        });
        $('#button').click(function(event){
            var order = $("#sortable tbody").sortable("serialize");
            order += "&crudtype=order";
            $('#savemessage').html('<p>Saving changes...</p>');
            $.post("/admin/database/customfields/crud",order,function(theResponse){
                    $('#savemessage').html(theResponse);
                });
        });
    });
    </script> 
```

以及生成的 PHP 页面 /admin/database/customfields/crud

```
$fields = $_POST['field'];
$counter = 1;
foreach ($fields as $field) {
  $params = array(array('value' => $counter, 'type' => 'i'), array('value' => $field, 'type' => 'i'));
  db_query('UPDATE customfields SET sortorder = ? WHERE cfid = ?', $params, false);
  $counter++;
}
print '<p>Changes saved</p>';
exit(); // Exit necessary for AJAX call
break; // End reorder 
```

我基于这个网站[http://www.simonbattersby.com/blog/drag-and-drop-with-jquery-ui/](http://www.simonbattersby.com/blog/drag-and-drop-with-jquery-ui/)，它确实有效 - 只是不是每次都有效。谁能告诉我我做错了什么？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:56:33.143

我拿走了你的代码并重新创建了你的模块，每次都能正常工作。基于此，我唯一可以得出的结论是 PHP 页面可能是从缓存中提供的？你能检查一下“生成的 PHP 页面”的标题吗？最简单的方法是使用 Firefox 的 Firebug 或 Chrome 的开发者工具来监控网络流量并检查 ajax 调用和 PHP 响应。

编辑：我意识到您的问题是 UPDATE ORDER 文本是一个 HREF 链接，因此当用户单击它时会指示浏览器重新加载页面 - 所以有时它会在触发 AJAX 调用之前重新加载它。只需将您的 A HREF 更改为 DIV 或 SPAN 即可。

所以而不是

```
<a href="" id="button" class="textbutton">Update Order</a> 
```

有

```
<div id="button" class="textbutton">Update Order</div> 
```

或者

```
<span id="button" class="textbutton">Update Order</span> 
```

# objective-c - 使用 UICollectionViewFlowLayout 时在 UICollectionViewCell 的边界之外绘制

> ID：14967470
> 
> 赞同：6
> 
> 时间：2013-02-19T21:09:24.357
> 
> 标签：objective-c, uicollectionview, uicollectionviewcell, uicollectionviewlayout

有没有人能够在`UICollectionViewCell`没有单元格剪裁到其边界的情况下在 a 的边界之外绘制？我有一个使用`UICollectionViewFlowLayout`（水平）的香草集合视图，我希望能够在`UICollectionViewCell`不破坏`UICollectionViewFlowLayout`. 设置`clipsToBounds`为`NO`似乎没有奏效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:17:40.790

我通过将单元格图层的 maskToBounds 属性设置为 NO 来使其工作。（您需要引入 QuartzCore 框架并将其导入视图控制器……）

如果这不起作用，请尝试将单元格的 contentView 图层的 maskToBounds 属性设置为 NO。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-11-14T13:39:35.173

对我来说，使用 maskToBounds 完成了这项工作

```
 override func awakeFromNib() {
    super.awakeFromNib()       
    self.layer.masksToBounds = false
   } 
```

# sql - hide redundant tuple if it is contained in another tuple in oracle

> ID：14967478
> 
> 赞同：1
> 
> 时间：2013-02-19T21:10:00.800
> 
> 标签：sql, oracle

I have a holidays table for a person, say 'M109'. for a particular date he taken vacation for 1 hour lunch and 4 hour meeting.

eg.

*   11 am to 3 pm - meeting
*   12pm to 1pm - lunch.

now I need to hide this 1 hour lunch tuple and get only the meeting tuple. how can i do that ?

`table(Person(varchar), StartTime, EndTime, Date, Desciption)` is the schema.

My query so far:

```
select "Provider", sum(b."EndTime" - b."StartTime")/60 as Non
from VACATION b
where b."StartDate" = '18-FEB-13'
and b."StartTime" IN (select p."StartTime"
                      from axium.VACATION p
                      where Exists (select q."StartTime"
                                    from axium.VACATION q
                                    where p."Provider" = q."Provider"
                                    and q."StartTime" <> p."StartTime"
                                    and q."StartTime" between p."StartTime"
                                                      and p."EndTime"
                                   )
                     )
and b."Provider" = 'M1009'
group by b."Provider"
order by b."Provider"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:30:28.817

您可以使用`where`子句和相关子查询来做到这一点：

```
select *
from t
where not exists (select 1 from t t2 where t2.person = t.person and t2.starttime < t.starttime and t2.endtime > t.endtime) 
```

# android - Why is my service not being started in Fragments onActivityResult?

> ID：14967481
> 
> 赞同：1
> 
> 时间：2013-02-19T21:10:10.877
> 
> 标签：android

In my fragment after a user signs in the onActivityResult callback is called. I have logging in the onActivityResult and it is in fact being called but the service is not starting... The service is registered in the Manifest and it gets executed in my onResume fine. The getActivity is not returning NULL as well. I do not know what the issue is... Can anyone give some advice.

```
@Override
    public void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        switch (requestCode) {
        case REQUEST_1:
            if (resultCode == Activity.RESULT_OK) {
                Intent intent = new Intent(getActivity(), MyService.class);
                intent.setData(Uri.parse("http://www.google.com");
                getActivity().startService(intent);
            }
            break;
        default:

            super.onActivityResult(requestCode, resultCode, data);
            break;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:37:24.380

我有类似的问题。

正如@Justin 在回复我时指出的那样，问题可以在清单文件中**正确注册服务。**

如果您不注册应用程序将崩溃。除非您使用**IntentService**，默认情况下它在另一个线程中，因此它不会使您的应用程序崩溃，但服务本身会..只是我们无法注意到它，因为主要活动 UI 将保留..

最后，我在声明我的 IntentService 类的清单中有错字..

希望有人会发现这很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:24:01.917

您很可能没有在清单中为您的服务注册正确的标签。

要验证这一点，请查看`ComponentName`从`startService`. 如果它为空，则没有服务符合您的意图。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-19T21:30:39.307

我认为你没有在 android manifest 中声明你的活动名称来声明活动名称在 android menifest.xml 文件中编写以下代码，如下所示

```
<activity 
        android:name=".YourActivityName">   
</activity> 
```

# linux - Using Sed to replace old timestamp with current one

> ID：14967483
> 
> 赞同：2
> 
> 时间：2013-02-19T21:10:20.443
> 
> 标签：linux, bash, sed

I'd like to use Sed to find within a template.php file the unix timestamp portion of the name of a JS file and replace it with a current timestamp. The old timestamp will vary so I need a regex to match a number.

Here's what I have so far:

```
TimPeterson$ current_timestamp=date +%s
TimPeterson$ sed -i "" "s/myJS-[0-9]*\([0-9]\+\).js/myJS-$current_timestamp.js/" template.php 
```

Just to be clear on the problem, what I need to match in the JS file name looks something like this (where the number part is variable):

```
myJS-1361297970.js 
```

However, `[0-9]*\([0-9]\+\)` isn't correct.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:16:37.940

由于多种原因，目前的代码无法正常工作。将其与：

```
current_timestamp=`date +%s`
sed -ie "s/myJS-[0-9]\+\.js/myJS-${current_timestamp}.js/g" template.php 
```

注释：

1.  `date +%s`必须在反引号内才能将程序执行的输出放入`current_timestamp`变量中
2.  该模式`[0-9]\+`足以捕获具有一系列数字的所有名称。
3.  我添加了大括号来分隔变量名
4.  保护`.js`部分的点不要与元字符混淆`.`，它匹配除回车之外的任何字符。
5.  我在替换中添加了一个“g”修饰符以在同一行中生成多个替换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T21:20:35.880

*   你需要`$(..)`执行命令。`current_timestamp=$(date +%s)`

*   你不必分组，只要简单`myJs-[0-9]\+\.js`就足够了。

*   如果您的 sed 支持`-r`，它可以节省一些转义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T21:20:50.783

一种使用方式`perl`。我评估替换部分以`date +%s`从外壳中获取结果。最后一个`tr`命令删除该命令添加的附加换行符`qx<...>`。

```
perl -i.bak -lpe 's/(myJS-)\d+(\.js)/$1 . qx<date +%s> . $2/eg && tr/\n//d' infile 
```

# ios - 在 UITableView 滚动时播放滴答声（有点像 UIPickerView）

> ID：14967484
> 
> 赞同：7
> 
> 时间：2013-02-19T21:10:25.343
> 
> 标签：ios, uitableview, audio

我正在寻找一种方法来实现每次单元格通过屏幕上的特定点（中心）时播放的滴答声。

我一直在网上倾诉，但不知道从哪里开始？任何方向都会很棒（不找人为我解决，只是一些见解或建议）

谢谢！

更新：

这是我使用您的方法实现的代码，但它不能正常工作。它似乎从未调用过“Tick”nslog，这意味着参数中的某些内容不正确。我的 tableview 单元格高 100 像素。有什么建议吗？

```
- (void) scrollViewDidScroll:(UIScrollView *)scrollView {

}

- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView
{
    self.myTimer = [NSTimer scheduledTimerWithTimeInterval:1/30.0 target:self selector:@selector(checkTableViewScrollPosition) userInfo:nil repeats:YES];
}

- (void)scrollViewDidEndScrollingAnimation:(UIScrollView *)scrollView
{
    if (self.myTimer)
        [self.myTimer invalidate];
    self.myTimer = nil;
}

int currentContentOffset = 0;
int tableviewCellHeight = 100;
int thresholdValue = 50;

- (void) checkTableViewScrollPosition {

    int contentOffsetValue = _contentTableView.contentOffset.y;

     NSLog(@"%d", contentOffsetValue);

    if ((contentOffsetValue + tableviewCellHeight / 2) % tableviewCellHeight <= thresholdValue && currentContentOffset != contentOffsetValue ) {
        NSLog(@"Tick!");
        NSLog(@"%d", contentOffsetValue);

        currentContentOffset = _contentTableView.contentOffset.y;

    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T03:08:54.020

首先向视图控制器添加一个属性，以存储表格中心单元格的索引路径：

```
@property (nonatomic, strong) NSIndexPath *currentIndexPath; 
```

然后，确保您的视图控制器采用该`UIScrollViewDelegate`协议，并且您的 tableView 可以通过 self.tableview 属性访问（或将下面的代码更改为 tableView 的适当属性）。

然后，从 中实现以下方法`UIScrollViewDelegate`：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
    // Find the indexPath of the cell at the center of the tableview
    CGPoint tableViewCenter = self.tableview.center;
    tableViewCenter = [self.tableview convertPoint:tableViewCenter fromView:self.tableview.superview];
    NSIndexPath *centerCellIndexPath = [self.tableview indexPathForRowAtPoint:tableViewCenter];

    // "Tick" if the cell at the center of the table has changed
    if ([centerCellIndexPath compare:self.currentIndexPath] != NSOrderedSame)
    {
        NSLog(@"Tick");
        self.currentIndexPath = centerCellIndexPath;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:16:33.010

该`UITableViewDelegate`协议符合`UIScrollViewDelegate`，因此如果您采用此协议，您可以实现`UIScrollViewDelegate` `- scrollViewWillBeginDragging`和`- scrollViewDidScroll`来检测滚动

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T21:21:11.207

实施

`- (void)scrollViewDidScroll:(UIScrollView *)scrollView`

UITableViewDelegate 协议符合的 UIScrollViewDelegate 协议的一部分的方法。在您的实现`contentOffset`中检查滚动视图，每当内容偏移单元格的高度（向上或向下）时，播放您的声音。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T21:13:46.337

您可以首先在tableView 委托`contentOffset`的方法中检查 TableView 的属性`scrollViewDidScroll:`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-19T21:39:10.753

设置一个计时器以在 tableViewDelegate 方法返回后以每秒 30 帧的速度运行

```
- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView
{
    self.myTickTimer = [NSTimer scheduledTimerWithTimeInterval:1/30.0 target:self selector:@selector(checkTableViewScrollPosition) userInfo:nil repeats:YES];
} 
```

tableViewDidBeginScroller，然后在到达委托方法后停止计时器

```
- (void)scrollViewDidEndScrollingAnimation:(UIScrollView *)scrollView
{
    if (myTickTimer)
        [myTickTimer invalidate];
    self.myTickTimer = nil;
} 
```

然后获取 tableview.contentOffset 并将其打印出来以向您显示所有内容偏移量，因为它在您滚动时会发生变化......

```
- (void) checkTableViewScrollPosition
{
    NSLog(@"tableview.contentOffset = %@", tableview.contentOffset);
} 
```

现在你有内容偏移量发出正确的数字....根据表格视图单元格高度对 contentOffset 进行模数，然后你将能够在它改变时播放声音....回想内容偏移量将从0 - tableViewCellHeight*numberOfCells + headerHeight + footerHeight... 这是完成的方法：

```
int currentContentOffset = 0;
int tableviewCellHeight = 44;
int thresholdValue = 5;
void checkTableViewScrollPosition
{
    NSLog(@"tableview.contentOffset = %@", tableview.contentOffset);
    if ((tableview.contentOffset+tableviewCellHeight/2.0) % tableviewCellHeight <= threshHoldValue &&
        currentContentOffset != tableview.contentOffset)
        NSLog(@"Tink");
        [[NSSound soundNamed:@"Tink"] play];

        currentContentOffset = tableview.contentOffset;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-17T02:39:18.567

在 UITableViewDelegate 方法 tableView:willDisplayCell:forRowAtIndexPath: 中播放声音。每次有新单元格即将出现时，都会调用此方法。

# php - php preg_match 非贪婪？

> ID：14967485
> 
> 赞同：28
> 
> 时间：2013-02-19T21:10:29.510
> 
> 标签：php, regex

我有一个字符串（来自文件）：

```
ILX (New for 2013!)

Overview: The least expensive route to Honda's premium-label goodness

Drivetrain: Two four-cylinder engines to choose from as well as a gas-electric hybrid; front-wheel-drive only. 
```

我如何得到字符串：

```
$writeup = file_get_contents($car_files_path . $manufacture . '/Stories/'.$story); 
```

我想匹配概述行（`Overview: The least expensive route to Honda's premium-label goodness)`。实现这一目标的最佳方法是什么。

我尝试了 .*\n，但这将匹配所有内容，然后是一个新行。有没有办法让正则表达式不贪婪？

我试过了： `preg_match('/^Overview:\s.*$/im', $writeup, $overall_matches)`我没有得到任何匹配

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-02-19T21:13:44.477

在量词之后添加`?`使其不贪婪。在这种情况下，您的正则表达式将是`.*?\n`.

要专门匹配以“Overview:”开头的行，请使用此正则表达式：

```
/^Overview:\s.*$/im 
```

`m`修饰符允许`^`并匹配行的`$`开头和结尾，而不是整个搜索字符串。请注意，没有必要让它变得不贪婪，因为`.`除非你使用修饰符，否则它不会匹配换行符`s`- 事实上，在这里让它变得不贪婪会对性能不利。

# azure - 将数据从 WP8 插入 Azure 数据库后 MoveNext() 异常（移动服务）

> ID：14967490
> 
> 赞同：1
> 
> 时间：2013-02-19T21:10:33.527
> 
> 标签：azure, windows-phone-8, azure-mobile-services

我有与`Windows Azure`/有关的问题`Windows Phone 8 services`

在我点击按钮后，使用 refresh_button_Tap 事件我收到了带有 MessageBox 的消息：

> “System.NullReferenceException：对象引用未设置为对象的实例。在 pic.MainPage.d__0.MoveNext()”

然后我点击确定，新记录出现在`Azure Database`.

```
public class UsersTableItem
    {
        public int Id { get; set; }

        [DataMember(Name = "Login")]
        public string Login { get; set; }

        [DataMember(Name = "Password")]
        public string Password { get; set; }

    }

    public partial class MainPage : PhoneApplicationPage
    {
        // MobileServiceCollectionView implements ICollectionView (useful for databinding to lists) and 
        // is integrated with your Mobile Service to make it easy to bind your data to the ListView
        //private MobileServiceCollectionView<PicturesTableItem> items;

        private IMobileServiceTable<PicturesTableItem> picturesTable = App.MobileService.GetTable<PicturesTableItem>();

        private MobileServiceCollectionView<UsersTableItem> items;

        private IMobileServiceTable<UsersTableItem> usersTable = App.MobileService.GetTable<UsersTableItem>();

        // Constructor
        public MainPage()
        {
            InitializeComponent();

        }

        private async void InsertUsersTableItem(UsersTableItem UsersTableItem)
        {
            // This code inserts a new PicturesTableItem into the database. When the operation completes
            // and Mobile Services has assigned an Id, the item is added to the CollectionView
            try
            {

                await usersTable.InsertAsync(UsersTableItem);
                items.Add(UsersTableItem);
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
            }
        }

        private void refresh_button_Tap(object sender, System.Windows.Input.GestureEventArgs e)
        {
            var usersTableItem = new UsersTableItem {Login = "LOL", Password = "9E32581C5C0D680FFC7D95C370D3260B" };
            InsertUsersTableItem(usersTableItem);
        }
    } 
```

**Azure SQL**

```
USE [pic_db]
GO

/**** Object:  Table [pic].[UsersTableItem]    Script Date: 2013-02-19 22:02:47 ****/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [pic].[UsersTableItem](
       [Id] [int] IDENTITY(1,1) NOT NULL,
       [Login] [nvarchar](max) NOT NULL,
       [Password] [nvarchar](max) NOT NULL,
CONSTRAINT [PK_UsersTableItem] PRIMARY KEY CLUSTERED
(
       [Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON)
)

GO 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T06:05:25.350

从您的代码中，我看不到您正在初始化`items`集合，因此`items.Add(UsersTableItem);`似乎是罪魁祸首，并且它发生在 之后`InsertAsync`，因此您的数据确实可以很好地到达数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T11:22:11.387

首先，感谢吉姆·奥尼尔。

但还有更多。这是 Hyper-V 和我的 Wifi 的网络连接问题。我的 Hyper-V 模拟器延迟 1 分钟连接到互联网。首先应用程序刚刚运行，一段时间后同步时钟。但仍然没有任何联系。一分钟后连接真的可用。

由于：[相关主题](http://social.msdn.microsoft.com/forums/it-it/azuremobile/thread/751e414b-c00d-4818-97a3-dc6b0081c43a)

今天我再次从我的 Azure 下载示例 TodoItems 项目。他们使用类似的东西来初始化**项目**集合。

```
private void RefreshTodoItems()
        {
            // This code refreshes the entries in the list view be querying the TodoItems table.
            // REMOVED the filter on completed items, so they're all dislpayed
            items = todoTable
                //.Where(todoItem => todoItem.Complete == false)
                .ToCollectionView();
            ListItems.ItemsSource = items;
        }

protected override async void OnNavigatedTo(NavigationEventArgs e)
        {
            RefreshTodoItems();
        } 
```

如果模拟器无法连接，RefreshTodoItems 将无法正常工作。所以我的问题也出现在 Azure 的测试示例项目中。我不仅是遇到 Wifi / Hyper-V 模拟器问题的人。我应该购买 Windows Phone 8 设备，或者微软应该解决这个问题。

# foxpro - Foxpro 编译器

> ID：14967493
> 
> 赞同：0
> 
> 时间：2013-02-19T21:10:49.503
> 
> 标签：foxpro, visual-foxpro

我有一个旧版 Foxpro 2.6 应用程序，我想使用更新的 Foxpro 版本编译它，这样我就可以在 Win 7 x64 系统上运行它（通过 x32 兼容性）并进行商业分发。有没有什么方法可以在不购买 500 美元以上的许可证的情况下以合法的方式做到这一点？

我只是在谈论编译它，因为开发是在获得许可的 FoxPro 2.6 上完成的......

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:28:39.213

不，您需要一份 Visual FoxPro。但是无论如何您都需要它，因为您必须至少进行一些代码更改才能使其看起来可以接受。至少，您需要：

_SCREEN.Themes = .F。

在代码的最顶部。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T08:43:20.797

正如您所说，如果它是用于 DOS 的 FoxPro 或用于 Windows 的 FoxPro，那么它们是 16 位的，不会在 64 位操作系统上运行，任何其他 16 位可执行文件也不会。

如果您想将它迁移到 Visual FoxPro，那么您需要一个合法的副本。也许您已经通过 MSDN 或其他方式获得了它。

即使您有 Visual FoxPro，也不一定只是重新编译它，这取决于所涉及的复杂性。还有其他线程处理这个主题。

您可以在 Windows 7 上以“XP 模式”运行它，这实际上是一个 XP 虚拟机，或者如果它实际上是 FoxPro for DOS（不是 FoxPro for Windows），那么您也可以在 DosBox 中成功运行它，但可能会遇到打印问题.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-17T09:02:14.170

另一种方式是这样。您仍然可以在 64 位平台上运行它。

1.  安装 VMWare 工作站 7.1
2.  安装windows XP
3.  运行您的 Foxpro Dos/Windows。

这得到了证实，我最近使用这种方法运行了 Borland C++ 3.0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-14T07:50:38.257

是的，正如 Alan 所回答的，FoxPro Legacy 是 16 位应用程序，不能在任何 64 位操作系统下直接运行。选项之一是使用 FoxPro 2.6 下的 Create Standalone Executable 选项编译它（如果您有编译器）。然后将此可执行文件分发给可以使用 vDo 运行可执行文件的客户端。如果您的程序也需要打印，那么您应该使用同样支持打印的 DosBox。

第一次执行程序时，它可能不会执行。您必须右键单击 Dos 窗口的左上角，右键单击属性并启用旧控制台，然后重新启动应用程序。

# java - Error while starting the tomcat 7 in eclipse

> ID：14967495
> 
> 赞同：2
> 
> 时间：2013-02-19T21:10:51.700
> 
> 标签：java, tomcat, classnotfoundexception

I am getting this error, when i start the tomcat in eclipse, please tell me how to fix it, i tried removing and adding server again and again..

And i am new to tomcat server, Please i need help to fix this.

```
Feb 20, 2013 1:54:11 AM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\Program Files\Java\jdk1.7.0\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;c:/Program Files/java/jdk1.7.0/bin/../jre/bin/server;c:/Program Files/java/jdk1.7.0/bin/../jre/bin;c:/Program Files/java/jdk1.7.0/bin/../jre/lib/amd64;c:\Program Files\java\jdk1.7.0\bin;c:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\;c:\Program Files\Microsoft SQL Server\100\Tools\Binn\;c:\Program Files\Microsoft SQL Server\100\DTS\Binn\;c:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE\;c:\Program Files (x86)\Microsoft SQL Server\100\DTS\Binn\;D:\android\eclipse;;.
Feb 20, 2013 1:54:11 AM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:Tester' did not find a matching property.
Feb 20, 2013 1:54:11 AM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:RestAutomationAdmin' did not find a matching property.
Feb 20, 2013 1:54:11 AM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:RestAutomationMobile' did not find a matching property.
Feb 20, 2013 1:54:11 AM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-8080"]
Feb 20, 2013 1:54:11 AM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["ajp-bio-8009"]
Feb 20, 2013 1:54:11 AM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 871 ms
Feb 20, 2013 1:54:11 AM org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
Feb 20, 2013 1:54:11 AM org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.35
Feb 20, 2013 1:54:12 AM org.apache.catalina.core.ContainerBase startInternal
SEVERE: A child container failed during start
java.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/RestAutomationAdmin]]
    at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:252)
    at java.util.concurrent.FutureTask.get(FutureTask.java:111)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1123)
    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:800)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/RestAutomationAdmin]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    ... 7 more
Caused by: java.lang.NoClassDefFoundError: FilterConfig
    at java.lang.Class.getDeclaredMethods0(Native Method)
    at java.lang.Class.privateGetDeclaredMethods(Class.java:2442)
    at java.lang.Class.getDeclaredMethods(Class.java:1808)
    at org.apache.catalina.util.Introspection.getDeclaredMethods(Introspection.java:127)
    at org.apache.catalina.startup.WebAnnotationSet.loadMethodsAnnotation(WebAnnotationSet.java:279)
    at org.apache.catalina.startup.WebAnnotationSet.loadApplicationFilterAnnotations(WebAnnotationSet.java:111)
    at org.apache.catalina.startup.WebAnnotationSet.loadApplicationAnnotations(WebAnnotationSet.java:66)
    at org.apache.catalina.startup.ContextConfig.applicationAnnotationsConfig(ContextConfig.java:405)
    at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:881)
    at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:369)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5179)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more
Caused by: java.lang.ClassNotFoundException: FilterConfig
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1714)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1559)
    ... 21 more

Feb 20, 2013 1:54:12 AM org.apache.catalina.core.ContainerBase startInternal
SEVERE: A child container failed during start
java.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost]]
    at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:252)
    at java.util.concurrent.FutureTask.get(FutureTask.java:111)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1123)
    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:732)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:684)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:456)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: org.apache.catalina.LifecycleException: A child container failed during start
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1131)
    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:800)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more

Feb 20, 2013 1:54:12 AM org.apache.catalina.startup.Catalina start
SEVERE: Catalina.start: 
org.apache.catalina.LifecycleException: Failed to start component [StandardServer[8005]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:684)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:456)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardService[Catalina]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:732)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 9 more
Caused by: org.apache.catalina.LifecycleException: A child container failed during start
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1131)
    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 11 more

Feb 20, 2013 1:54:12 AM org.apache.catalina.startup.Catalina start
INFO: Server startup in 1011 ms 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-03T03:38:28.923

检查类路径，确保它包含 servlet-api.jar 包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T12:48:14.687

检查您在映射 url 的主 servlet 文件或 web.xml 文件中的注释。我的意思是检查您的 servlet 页面或 web.xml 中的以下代码。可能是您错过了在您的任何 urlPatterns 前面放置一个“/”符号。

```
@WebServlet(name = "AkterHossainBookLibrary", urlPatterns = {
    "/", "/login", "/logout", "/add-book", 
    "/edit-book", "/delete-book", "/book-list", "/search", 
    "/order-book", "/refund-book" })
public class BookLibraryServlet extends HttpServlet {

...
...

} 
```

如果它有效，请告诉我。

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-23T08:55:37.840

少 servlet-api.jar

java构建路径-》添加库-》eclipse服务器库-》eclipse tomcat运行库

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-28T22:46:13.467

我多次遇到这个问题。通常发生在我在 VS Code 中查看我的代码然后返回 Eclipse 时。一旦我清理项目并再次构建它，它就可以正常工作。

# php - Redirect if Browser and OS headers are blank

> ID：14967498
> 
> 赞同：-1
> 
> 时间：2013-02-19T21:10:58.163
> 
> 标签：php, http-headers

A particular page is getting hit by someone using a block of IPs. Interestingly their headers are showing no information on their operating system or browser. How would I go about redirecting users that do not have browser or OS information in their http headers?

Is there an easy way to do this with some php?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:14:34.100

我同意 Colin Morelli 的评论：

> 馊主意。许多人有隐藏`User-Agent`标题的浏览器扩展，因为他们担心隐私。

但是，如果您想这样做，这很容易：

```
if (!isset($_SERVER['HTTP_USER_AGENT']) {
    // Redirect here.
    header('Location: http://example.com');
    exit;
} 
```

# .net - 防止反射访问 .NET 中的内部字段

> ID：14967503
> 
> 赞同：1
> 
> 时间：2013-02-19T21:11:19.957
> 
> 标签：.net, security, reflection

是否可以阻止某人使用反射来获取内部类变量的值？

我有一个内部（VB 中的朋友）类级别变量，只有在调用者知道密码时才应该可以访问该变量。有一种方法可以公开此变量，该变量需要密码，但可以使用反射直接访问该变量。我可以防止这种情况发生吗？

更多详细信息，可能会破解此变量的代码作为插件加载到主应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:14:44.470

[您可以通过混淆](https://en.wikipedia.org/wiki/Obfuscation_%28software%29)源代码使反射更难（但并非不可能） 。这主要将代码中使用的名称更改为难以猜测的难以辨认的名称。但是，它不提供任何保证，任何坚定的程序员都可以找出这些名称并反映他/她想要的一切。

或者，您可以通过用非 .NET 语言（例如非托管 C++）实现该部分代码（整个类）来使反射变得不可能。例如，[在托管代码中没有实现](https://stackoverflow.com/a/720196/146622)`mscorlib`该`InternalGetHashCode`方法，因此无法反映到它以查看它是如何工作的。

您可以使用 PInvoke 从托管代码中调用非托管功能。

# c - Segmentation fault in multithreaded program

> ID：14967509
> 
> 赞同：0
> 
> 时间：2013-02-19T21:11:44.433
> 
> 标签：c, multithreading, pthreads

I have declared a struct and tried to use the elements of that struct in the main program . I am not sure if it is the right approach. what can be an alternative approach . Could it be declaring new matrices and variables in main and then assigning those values to the values of struct . I am getting all 0s in first row of resultant matrix but second row is computed correctly.Also , should I create threads dynamically.

```
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>

struct v {
int i; /* row */
 int j; /* column */
  int M, N, K;
float** A;
float** B;
float** C;
};

 void *runner(void *param); /* the thread */

  int main(int argc, char *argv[]) {

  int c, d, k, sum = 0;
 pthread_t tid[50];       //Thread ID
  int i,j, count = 0,thread_identifier,ret=5, count_dimension=0;
   char ch;
    struct v *data = (struct v *) malloc(sizeof(struct v));

    printf("Enter the number of rows and columns of first matrix\n");
    scanf("%d%d", &(data->M), &(data->K));
     (data->A) = malloc((data->M)*sizeof(float*));
     for ( i =0;i < data->M; i++)
 (data->A[i]) =malloc((data->K)*sizeof(float));

   printf("Enter the number of rows and columns of second matrix\n");
   (data->B) = malloc((data->K)*sizeof(float*));
   scanf("%d%d", &(data->K), &(data->N));
    for( i=0;i<(data->K);i++)
 (data->B[i]) = malloc((data->N)*sizeof(float));

     printf("Allocate memory for result matrix \n\n");
    (data->C) = malloc((data->M)*sizeof(float*));
     for( i=0;i<(data->M);i++)
     (data->C[i]) = malloc((data->N)*sizeof(float));

      printf("Enter the elements of first matrix\n");
      for( i = 0 ; i < data->M ; i++ )
       for ( j = 0 ; j < data->K ; j++ )
       scanf("%f", &(data->A[i][j]));

        printf("Enter the elements of second matrix\n");
        for( i = 0 ; i < data->K ; i++ )
         for ( j = 0 ; j < data->N ; j++ )
          scanf("%f", &(data->B[i][j]));

         for(i = 0; i < data->M; i++) 
  {
     j=0;

     data->i = i;
     data->j = j;
     /* Now create the thread passing it data as a parameter */

     pthread_attr_t attr; //Set of thread attributes
     //Get the default attributes
     pthread_attr_init(&attr);
     //Create the thread
     pthread_create(&tid[i],&attr,runner,data);
 //printf("create worker thread %u for row %d",(unsigned int)pthread_self(),i);
 printf("%lu",tid[i]);   
 printf("\n");
     count++;
 }  

   for(i=0;i< data->M;i++)
  {         

//Make sure the parent waits for all threads to complete
     pthread_join(tid[i], NULL);
   }      

   //Print out the resulting matrix
    for(i = 0; i < data->M; i++) {
    for(j = 0; j < data->N; j++) {
     printf("%.2e ", data->C[i][j]);
  }
printf("\n");

  }
  printf("\n"); 
  printf("%d",count);
 }

  //The thread will begin control in this function
   void *runner(void *param) {
   struct v *data = param; // the structure that holds our data
   int n,x=0, j=0; //the counter and sum
  float sum = 0.00;
   for(x=0;x<data->N;x++)
  {
for(j=0;j<data->N;j++)
{
    sum += data->A[data->i][j] * data->B[j][x];
}
data->C[data->i][x] = sum;
sum=0.00;
   }

  //Exit the thread
  //pthread_exit(0);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:15:52.807

```
*(data->A) = malloc((data->M)*sizeof(float*)); 
```

应该

```
data->A = malloc((data->M)*sizeof(float*)); 
```

`data->A`此时未初始化，因此取消引用它会调用未定义的行为。此外，它是 a `float**`，所以你想让它指向`float*`s 的数组。

当然，这同样适用`data->B`。而且您还需要为`data->C`.

# python - Python - make script loop until condition met and use a different proxy address for each loop

> ID：14967510
> 
> 赞同：2
> 
> 时间：2013-02-19T21:11:47.523
> 
> 标签：python, loops, proxy, proxies

I'm the definition of a noob. I know next to nothing about python and am looking for help. I can read just enough code to alter variables to suit my wants/needs but I when it comes to doing something the original code didn't call for... I'm lost.

So here is the deal, I found a craigslist(CL) flagging script that originally searched ALL CL sites and flagged posts that contained a specific keyword (it was written to flag all posts that mentioned scientology).

I altered it to only search CL sites in my general area (15 sites instead of 437) but it still looks for specific keywords that have have changed. I want to automatically flag people that continuously spam CL and make it hard to sort through as I do a lot of business on CL from sorting through postings.

What I want the script to do is loop until it can no longer find posts that meet the criteria changing proxy servers after each loop. And a place inside the script where I would put in the proxy/s ip adress

I look forward to your replies.

Here is the altered code I have:

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import urllib
from twill.commands import * # gives us go()

areas = ['sfbay', 'chico', 'fresno', 'goldcountry', 'humboldt', 'mendocino', 'modesto', 'monterey', 'redding', 'reno', 'sacramento', 'siskiyou', 'stockton', 'yubasutter', 'reno']

def expunge(url, area):
    page = urllib.urlopen(url).read() # <-- and v and vv gets you urls of ind. postings
    page = page[page.index('<hr>'):].split('\n')[0]
    page = [i[:i.index('">')] for i in page.split('href="')[1:-1] if '<font size="-1">' in i]

    for u in page:
        num = u[u.rfind('/')+1:u.index('.html')] # the number of the posting (like 34235235252)
        spam = 'https://post.craigslist.org/flag?flagCode=15&amppostingID='+num # url for flagging as spam
        go(spam) # flag it

print 'Checking ' + str(len(areas)) + ' areas...'

for area in ['http://' + a + '.craigslist.org/' for a in areas]:
    ujam = area + 'search/?query=james+"916+821+0590"+&catAbb=hhh'
    udre = area + 'search/?query="DRE+%23+01902542+"&catAbb=hhh'
    try:
        jam = urllib.urlopen(ujam).read()
        dre = urllib.urlopen(udre).read()
    except:
        print 'tl;dr error for ' + area

    if 'Found: ' in jam:
        print 'Found results for "James 916 821 0590" in ' + area
        expunge(ujam, area)
        print 'All "James 916 821 0590" listings marked as spam for area'

    if 'Found: ' in dre:
        print 'Found results for "DRE # 01902542" in ' + area
        expunge(udre, area)
        print 'All "DRE # 01902542" listings marked as spam for area' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:18:51.547

你可以像这样创建一个常量循环：

```
while True:
    if condition :
        break 
```

Itertools 有一些迭代技巧[http://docs.python.org/2/library/itertools.html](http://docs.python.org/2/library/itertools.html)

值得注意的是，退房`itertools.cycle`

（这些是指向正确方向的指针。您可以用一个、另一个甚至两者来制定解决方案）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:11:38.113

我做了一些改变......不确定它们的工作情况如何，但我没有收到任何错误。如果您发现任何错误/丢失的东西，请告诉我。- 谢谢

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import urllib, urllib2
from twill.commands import go

proxy = urllib2.ProxyHandler({'https': '108.60.219.136:8080'})
opener = urllib2.build_opener(proxy)
urllib2.install_opener(opener)
proxy2 = urllib2.ProxyHandler({'https': '198.144.186.98:3128'})
opener2 = urllib2.build_opener(proxy2)
urllib2.install_opener(opener2)
proxy3 = urllib2.ProxyHandler({'https': '66.55.153.226:8080'})
opener3 = urllib2.build_opener(proxy3)
urllib2.install_opener(opener3)
proxy4 = urllib2.ProxyHandler({'https': '173.213.113.111:8080'})
opener4 = urllib2.build_opener(proxy4)
urllib2.install_opener(opener4)
proxy5 = urllib2.ProxyHandler({'https': '198.154.114.118:3128'})
opener5 = urllib2.build_opener(proxy5)
urllib2.install_opener(opener5)

    areas = ['sfbay', 'chico', 'fresno', 'goldcountry', 'humboldt',
    'mendocino', 'modesto', 'monterey', 'redding', 'reno',
    'sacramento', 'siskiyou', 'stockton', 'yubasutter']
queries = ['james+"916+821+0590"','"DRE+%23+01902542"']

    def expunge(url, area):
page = urllib.urlopen(url).read() # <-- and v and vv gets you urls of ind. postings
page = page[page.index('<hr>'):].split('\n')[0]
page = [i[:i.index('">')] for i in page.split('href="')[1:-1] if '<font size="-1">' in i]

    for u in page:
    num = u[u.rfind('/')+1:u.index('.html')] # the number of the posting (like 34235235252)
    spam = urllib2.urlopen('https://post.craigslist.org/flag?flagCode=15&amppostingID='+num )
    spam2 = urllib2.urlopen('https://post.craigslist.org/flag?flagCode=28&amppostingID='+num )
    spam3 = urllib2.urlopen('https://post.craigslist.org/flag?flagCode=16&amppostingID='+num )
    go(spam) # flag it
    go(spam2) # flag it
    go(spam3) # flag it

print 'Checking ' + str(len(areas)) + ' areas...'

    for area in areas:
for query in queries:
    qurl = 'http://' + area + '.craigslist.org/search/?query=' + query + '+&catAbb=hhh'
    try:
        q = urllib.urlopen(qurl).read()
    except:
        print 'tl;dr error for {} in {}'.format(query, area)
        break

    if 'Found: ' in q:
        print 'Found results for {} in {}'.format(query, area)
        expunge(qurl, area)
        print 'All {} listings marked as spam for {}'.format(query, area)
        print ''
        print ''
    elif 'Nothing found for that search' in q:
        print 'No results for {} in {}'.format(query, area)
        print ''
        print ''
        break
    else:
        break 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T23:31:43.660

我对您的代码进行了一些更改。在我看来，该函数`expunge`已经循环遍历页面中的所有结果，所以我不确定您需要进行什么循环，但有一个示例说明如何检查最后是否找到结果，但是没有循环可以打破。

不知道如何更改代理/ ip。

顺便说一句，你有`'reno'`两次。

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import urllib
from twill.commands import go

areas = ['sfbay', 'chico', 'fresno', 'goldcountry', 'humboldt',
        'mendocino', 'modesto', 'monterey', 'redding', 'reno',
        'sacramento', 'siskiyou', 'stockton', 'yubasutter']
queries = ['james+"916+821+0590"','"DRE+%23+01902542"']

def expunge(url, area):
    page = urllib.urlopen(url).read() # <-- and v and vv gets you urls of ind. postings
    page = page[page.index('<hr>'):].split('\n')[0]
    page = [i[:i.index('">')] for i in page.split('href="')[1:-1] if '<font size="-1">' in i]

    for u in page:
        num = u[u.rfind('/')+1:u.index('.html')] # the number of the posting (like 34235235252)
        spam = 'https://post.craigslist.org/flag?flagCode=15&amppostingID='+num # url for flagging as spam
        go(spam) # flag it

print 'Checking ' + str(len(areas)) + ' areas...'

for area in areas:
    for query in queries:
        qurl = 'http://' + area + '.craigslist.org/search/?query=' + query + '+&catAbb=hhh'
        try:
            q = urllib.urlopen(qurl).read()
        except:
            print 'tl;dr error for {} in {}'.format(query, area)
            break

        if 'Found: ' in q:
            print 'Found results for {} in {}'.format(query, area)
            expunge(qurl, area)
            print 'All {} listings marked as spam for area'.format(query)
        elif 'Nothing found for that search' in q:
            print 'No results for {} in {}'.format(query, area)
            break
        else:
            break 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-17T18:26:54.927

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import urllib, urllib2
from twill.commands import go

proxy = urllib2.ProxyHandler({'https': '108.60.219.136:8080'})
opener = urllib2.build_opener(proxy)
urllib2.install_opener(opener)
proxy2 = urllib2.ProxyHandler({'https': '198.144.186.98:3128'})
opener2 = urllib2.build_opener(proxy2)
urllib2.install_opener(opener2)
proxy3 = urllib2.ProxyHandler({'https': '66.55.153.226:8080'})
opener3 = urllib2.build_opener(proxy3)
urllib2.install_opener(opener3)
proxy4 = urllib2.ProxyHandler({'https': '173.213.113.111:8080'})
opener4 = urllib2.build_opener(proxy4)
urllib2.install_opener(opener4)
proxy5 = urllib2.ProxyHandler({'https': '198.154.114.118:3128'})
opener5 = urllib2.build_opener(proxy5)
urllib2.install_opener(opener5)

areas = ['capecod']
queries = ['rent','rental','home','year','falmouth','lease','credit','tenant','apartment','bedroom','bed','bath']

    def expunge(url, area):
page = urllib.urlopen(url).read() # <-- and v and vv gets you urls of ind. postings
page = page[page.index('<hr>'):].split('\n')[0]
page = [i[:i.index('">')] for i in page.split('href="')[1:-1] if '<font size="-1">' in i]

    for u in page:
    num = u[u.rfind('/')+1:u.index('.html')] # the number of the posting (like 34235235252)
    spam = urllib2.urlopen('https://post.craigslist.org/flag?flagCode=15&amppostingID='+num )
    spam2 = urllib2.urlopen('https://post.craigslist.org/flag?flagCode=28&amppostingID='+num )
    spam3 = urllib2.urlopen('https://post.craigslist.org/flag?flagCode=16&amppostingID='+num )
    go(spam) # flag it
    go(spam2) # flag it
    go(spam3) # flag it

print 'Checking ' + str(len(areas)) + ' areas...'

    for area in areas:
for query in queries:
    qurl = 'http://' + area + '.craigslist.org/search/?query=' + query + '+&catAbb=hhh'
    try:
        q = urllib.urlopen(qurl).read()
    except:
        print 'tl;dr error for {} in {}'.format(query, area)
        break

    if 'Found: ' in q:
        print 'Found results for {} in {}'.format(query, area)
        expunge(qurl, area)
        print 'All {} listings marked as spam for {}'.format(query, area)
        print ''
        print ''
    elif 'Nothing found for that search' in q:
        print 'No results for {} in {}'.format(query, area)
        print ''
        print ''
        break
    else:
        break 
```

# jquery - 如何将所有列设置为相同的高度？

> ID：14967511
> 
> 赞同：1
> 
> 时间：2013-02-19T21:11:48.863
> 
> 标签：jquery, html, css

我有一些列（`div`s），我想一直保持相同的高度。

我用的是Zurb Foundation所以布局是这样的，我不能把`div`s放在别人里面来拉伸它们。

```
<div class="row equalheight">
    <div class="three columns"> ... </div>
    <div class="three columns"> ... </div>
    <div class="three columns"> ... </div>
    <div class="three columns"> ... </div>
</div> 
```

使用 CSS 可能并不容易，但我怎样才能使所有列自动等于相同的高度？

设法使用jquery解决了这个问题，解决方案如下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:11:48.863

片刻之后自己设法想出了答案`eureka!`，并认为我会为了社区的利益而分享。

我使用[jquery](/questions/tagged/jquery "显示标记为“jquery”的问题")循环遍历每个`children`元素，将最大大小保存在变量中，然后将该大小设置为所有子元素。

我将函数绑定到窗口`load`和`resize`事件。

```
<script>
function equalheight() {    
    $('.equalheight').each(function(index) {
        var maxHeight = 0;
        $(this).children().each(function(index) {
            if($(this).height() > maxHeight) 
                maxHeight = $(this).height();
        });
        $(this).children().height(maxHeight);
    });    
}

$(window).bind("load", equalheight);
$(window).bind("resize", equalheight);
</script> 
```

完美运行！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:20:44.177

查看以下网站：

[http://css-tricks.com/fluid-width-equal-height-columns/](http://css-tricks.com/fluid-width-equal-height-columns/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:39:57.643

在不修改标记的情况下，这将是创建等高列的最简单方法：

[http://jsfiddle.net/Nu5KN/](http://jsfiddle.net/Nu5KN/)

```
div.equalheight {
    display: table;
    width: 100%; /* optional */
}

div.equalheight .columns {
    display: table-cell;
} 
```

# android - 如何在 Android 应用程序中传递引用？

> ID：14967512
> 
> 赞同：2
> 
> 时间：2013-02-19T21:11:49.617
> 
> 标签：android, bundle, pass-by-reference

我知道有一种简单的机制可以在活动之间传递对象。我通常使用`Bundle`and`putParcelable()`或 put `Serializable()`，但我知道它实际上是通过打包和解包对象来传递原始数据，而不保留引用。

但现在我的问题不同了——我需要传递对一些服务和其他活动的引用。有没有办法做到这一点？

* * *

也许我在实际问题上解释了我的问题：

1.  我有一个简单的类`City`，其中存储天气数据等。
2.  我把它放在`ListFragment`里面并在那里展示。
3.  我还有带有 的片段`GoogleMap`，它显示了带有天气的列表中的城市。

我应该如何存储`cities: List<City>`在我的应用程序中？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-19T21:16:17.653

> 我需要传递对某些服务和其他活动的引用

你不可以。您需要允许“某些服务和其他活动”访问相同的数据。通过引用传递将是实现此目的的一种方法，但它是一种在 Android 中不常用的方法，就像它不常用在 Web 应用程序中一样（例如，页面不会将 JavaScript 对象传递给其他页面）。

典型的方法是有一个中央数据模型，例如一个管理一堆 POJO 的单例，由数据库支持。然后，您在 Android 中传递*标识符*，这些标识符通常是简单的值（整数、字符串等）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T21:15:13.507

由于有问题的对象是一个简单的列表，您可以扩展 Application 并将列表存储在其中：

```
public class MyApp extends Application {

    List<City> cityList.....

    //onCreate()

    public List<City> getList() {}

    public List<City> setList()
} 
```

然后只需调用：

```
MyApp app = getApplication(); //getActivity().getApplication() in the Fragment
List<City> mylist = app.getList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:08:28.210

请参见：

[在 Intent 中传递对象引用而不实现 Serializable 或 Parcelable](https://stackoverflow.com/questions/14917029/pass-object-reference-within-intent-without-implementing-serializable-or-parcela/14917265#14917265)

您不能跨进程传递对对象的引用。正如马克指出的那样，你可以做很多功能相似的事情。但是，您的问题的答案是“不”

# php - htaccess rule to redirect to a dynamic subdomain

> ID：14967513
> 
> 赞同：0
> 
> 时间：2013-02-19T21:11:49.923
> 
> 标签：php, .htaccess, codeigniter

we manage over 70 properties and each of their websites runs from the same php code with a database controlling the differences. I need to write a redirect for a specific occasion and I don't know how to create variables in .htaccess.

for example: [http://www.firstproperty.com/banquet](http://www.firstproperty.com/banquet) becomes [http://banquet.firstproperty.com](http://banquet.firstproperty.com) and [http://www.secondproperty.com/banquet](http://www.secondproperty.com/banquet) becomes [http://banquet.secondproperty.com](http://banquet.secondproperty.com)

I am not sure if I should do this as a "redirect" or a "RewriteCond/RewriteRule"

This is my .htaccess now ( it removes index.php from codeigniter friendly urls )

```
DirectoryIndex index.php

redirect /joinTeam.php /index.php/prop/join_team

RewriteEngine on
RewriteCond $1 !^(index\.php|images|css|js|robots\.txt|favicon\.ico)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ ./index.php/$1 [L,QSA]

RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule (.*) http://www.%{HTTP_HOST}/$1 [R=301,L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-27T10:26:15.683

不是子域吗？在我看来，你应该进入 httpd.conf 而不是 htaccess 来管理它。还是我错了？在这里稍等一下以获得更多的专业意见。已经在这里完成了一些工作，它可能会对您有所帮助：[如何在 apache(xampp) 服务器中创建子域？](https://stackoverflow.com/questions/14086408/how-to-create-subdomains-in-apachexampp-server)希望能帮助到你。

```
NameVirtualHost 127.0.0.1:80
<VirtualHost *:80>
<Directory /banquet>
    Options FollowSymLinks Indexes
    AllowOverride All
    Order deny,allow
    allow from All
</Directory>
ServerName banquet.firstproperty.com/
ServerAlias www.banquet.firstproperty.com/
DocumentRoot /banquet
</VirtualHost> 
```

# components - What is the difference between component and bower?

> ID：14967521
> 
> 赞同：26
> 
> 时间：2013-02-19T21:12:04.700
> 
> 标签：components, bower, package-managers

I had a hard time finding an overview of the differences between [component](http://component.io) and [bower](http://bower.io). Which one is better, what is the better package manager to use? Are there any alternatives to these two I should consider?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-21T07:29:48.877

“组件”是系统的一部分。Bower 是包管理器。

哪一个更好？阅读[Bower 常见问题解答](https://github.com/bower/bower/wiki/FAQ)以了解差异。

Bower 似乎做得更好，它的目标是网络包管理器。

还有 Jam、Volo 或 Ender。当然，NPM。

对于受欢迎程度和采用率检查，您可以[检查 Ohloh](https://www.ohloh.net/p/compare?project_0=Twitter+Bower&project_1=volo&project_2=isaacs%27s+npm)

更新：

组件包管理器[https://github.com/component/component](https://github.com/component/component)也是 Web 的包管理器。它使用 GitHub 作为模块的后端数据库，因此不在 GitHub 上的模块将不会被列出。然而，这种方法使事情变得更容易，因为不需要额外的凭据；作者只使用 GitHub。

就个人而言，我认为 Component 应该采用一个独特的名称，以免与通用词“组件”混淆。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-15T20:28:41.993

组件背后的团队现在已经写了他们自己的固执己见的答案：[https ://github.com/component/guide/blob/master/component/vs.md#component-vs-bower](https://github.com/component/guide/blob/master/component/vs.md#component-vs-bower)

复制截至今天的内容：

> Bower 更类似于`npm`Component。就像`npm`，鲍尔的`bower.json`清单是包容性的，除了相关`.ignore`文件中的所有内容。另一方面，组件是独占的，只下载`component.json`.
> 
> 但是，Bower 和 Component 之间的主要区别在于`component.json`s 更加严格和固执己见：所有列出的文件`component.json`都被**假定为强制**的。另一方面，a 中列出的文件`bower.json`通常是可选的。
> 
> 严格的清单规范允许组件轻松集成构建过程。然而，这对于 Bower 来说是不可能的，因为人们发布了不同类型的模块（全局、插件、AMD 和 CommonJS），以及如这个[react-bower 问题](https://github.com/reactjs/react-bower/issues/1)中所示的可选文件，使得集成构建过程非常困难。
> 
> Component 的集成构建系统允许您在页面中简单地包含一个脚本和一个样式表。没有杂耍`<script src="bower_components/jquery"><script>`电话之类的。
> 
> Like `npm`，`bower`在安装时比 Component 慢，有不必要的发布步骤，不支持多个版本的依赖项，并且不缓存安装。

# c# - 用于检测 DDL（创建、更改、删 除）.sql 脚本中隐藏的 DML（插入、更新、删除）语句的正则表达式

> ID：14967525
> 
> 赞同：1
> 
> 时间：2013-02-19T21:12:35.007
> 
> 标签：c#, .net, regex, sql-parser, tsql-parser

> 更新：为了让这个问题更容易。我已经更改了字符串，现在您根本不必担心 BEGIN END。相反，我现在只有 GO 语句作为终止符。我希望我现在能从其他人那里得到一些答案

我需要编写一个正则表达式，它可以检测隐藏的 DML 语句，如 DDL 脚本（CREATE、ALTER、DROP）中的 INSERT、UPDATE、DELETE。

例子。在下面的脚本中，它应该捕获 2 个**delete table5**语句和最后一个**insert into** table3语句。但它应该忽略实际上在存储过程本身的主体中的插入语句。

如果你在这里运行这个 RegEx：[http](http://regexr.com?33rf3) ://regexr.com?33rf3 ，你会看到我已经完成了 90%。唯一不起作用的部分是它正在进行贪婪匹配，直到最后一个 GO。我需要它在第一次 GO 时停止。我试过使用 +? 操作员使其不贪婪，但它不想工作。

```
delete table5 /*Regex should find this*/

GO

create proc abc
begin
    insert into table1  /*Regex should IGNORE this*/
    begin
        fake nesting here
        insert into table2 /*Regex should IGNORE this*/
    end
end

GO

delete table5 /*Regex should find this*/

GO

alter proc abc2
begin
  --no statements in this proc
end

GO

insert into table3 /*Regex should find this*/ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T23:11:24.947

不需要 GO 语句。

```
 var regex1 = new Regex(@"
          (?s)
          (create|alter|drop).+?
          begin
            (?:
               (?> (?! begin | end ) .
                  | begin (?<counter>)
                  | end  (?<-counter>)
                )*
            )
            (?(counter)(?!))
          end
          "
        , RegexOptions.IgnorePatternWhitespace
        );

        var regex2 = new Regex(@"(?:insert|update|delete).+");

        var result = regex2.Matches(regex1.Replace(your_input, ""))
            .Cast<Match>()
            .Select(m => m.Value); 
```

此代码删除所有 create/alter/drop 语句，然后查找 delete/alter/drop。我认为它可以只使用一个正则表达式来完成，但这是我现在可以建议的全部，抱歉:)

# ios - UIDevice CFDictionaryGetValue 在后台出错

> ID：14967528
> 
> 赞同：3
> 
> 时间：2013-02-19T21:12:41.093
> 
> 标签：ios, objective-c, multitasking, uidevice

我正在查：

```
[[UIDevice currentDevice] systemName] 
```

在 applicationDidEnterBackground 中。它导致 EXC_BAD_ACCESS (SIGSEGV) 信号。堆栈跟踪显示这发生在 UIDevice 内部，它正在调用 CFDictionaryGetValue。

实验，调用：

```
CFDictionaryGetValue(NULL, "key"); 
```

导致相同的错误。

有任何想法吗？我搜索了有关在后台访问 UIDevice 的文档，但没有发现任何迹象表明它应该是一个问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:24:12.743

在 applicationDidEnterBackground: 中调用（和记录） [[UIDevice currentDevice] systemName] 在我的测试中工作正常。CFDictionaryGetValue(NULL, "key") 总是会崩溃，和你遇到的问题无关。

```
- (void)applicationDidEnterBackground:(UIApplication *)application
{
    NSString *systemName = [[UIDevice currentDevice] systemName];
    if ( systemName )
        NSLog(@"%@", systemName);
    else
        NSLog(@"null systemName");
} 
```

# shell - 为所有文件中的所有行添加前缀和后缀？

> ID：14967529
> 
> 赞同：0
> 
> 时间：2013-02-19T21:12:43.640
> 
> 标签：shell, command-line, ssh, command

我的一个文件夹中有大量文本文件 - 每个文本文件中都有一个域名列表。

我需要在每一行之前添加这个：

```
<url><loc>http://www.mysite.com/review/ 
```

这在每一行的末尾：

```
</url></loc> 
```

有没有办法通过命令行一次对所有文件和所有行进行大规模执行？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:18:09.317

尝试这样做：

```
sed 's@^@<url><loc>http://www.mysite.com/review/@; s@$@</url></loc>@' files*.html 
```

如果要替换文件，请添加`-i`开关。`sed`

# linux - Tomcat 正在启动但无法访问 localhost:8080

> ID：14967533
> 
> 赞同：1
> 
> 时间：2013-02-19T21:13:13.993
> 
> 标签：linux, tomcat, localhost

我花了整整几天时间`tomcat 5.5.36`在我的服务器上启动。我确定tomcat正在启动，因为我使用下面的命令

```
netstat -anp |grep 8080 
```

结果显示 Java 正在侦听端口 8080。

```
tcp        0      0 0.0.0.0:8080                0.0.0.0:*                   LISTEN      7615/java 
```

在我使用命令主机名获取我的本地主机名称并在浏览器中键入它之后

```
http://my.domain.com:8080 
```

铬说`Error 101`( `net::ERR_CONNECTION_RESET`): `The connection was reset`。

任何人都可以给我一些帮助。谢谢。

* * *

**更新**

日志说：

```
Feb 19, 2013 2:10:56 PM org.apache.coyote.http11.Http11BaseProtocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
Feb 19, 2013 2:10:56 PM org.apache.jk.common.ChannelSocket init
INFO: JK: ajp13 listening on /0.0.0.0:8009
Feb 19, 2013 2:10:56 PM org.apache.jk.server.JkMain start
INFO: Jk running ID=0 time=0/11  config=null
Feb 19, 2013 2:10:56 PM org.apache.catalina.storeconfig.StoreLoader load
INFO: Find registry server-registry.xml at classpath resource
Feb 19, 2013 2:10:56 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 923 ms 
```

* * *

**2月20日更新**

我的问题得到解决，它是由防火墙问题引起的。我尝试使用另一台笔记本电脑并远程登录我的服务器。服务器说连接被拒绝，我意识到端口 8080 没有对外开放。

希望它会帮助别人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:18:09.573

> Tomcat 5.5.36

你应该升级。那是一个严重的旧版本，不再受支持。

> 连接重置

查看 server.xml。HTTP（不是 HTTPS 也不是 AJP）连接器是侦听端口 8080 的连接器吗？

无论如何，我建议从 Tomcat7 的 vanilla 下载开始。

# database-design - 没有度量时，什么 dw 模型是合适的？

> ID：14967534
> 
> 赞同：0
> 
> 时间：2013-02-19T21:13:16.810
> 
> 标签：database-design, ssas, data-modeling, data-warehouse

那里的所有演示都在他们的示例中使用销售/订单模型作为衡量标准。但我的数据库不是事务性的。这是一个以客户为中心的模型，其中有一个客户表，该表连接到多个属性表。

由于模型不同，这甚至不符合构建多维数据集的条件，还是尽管它不是事务性的，但仍有某种方法可以构建多维数据集？

我听说过无事实的事实表，但还没有真正理解这个概念。这是你会用的地方吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:16:51.133

对于此类问题，您可以获得的最佳读物来自 Kimball：[http ://www.kimballgroup.com/2008/11/05/fact-tables/](http://www.kimballgroup.com/2008/11/05/fact-tables/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:39:03.747

你要分析什么样的指标？

如果您只想汇总具有特定属性的客户数量，则可以使用如下事实表：

```
Customer_FK, Attribute_FK 
```

我更喜欢使用固定值为“1”的额外列来简化聚合

```
Customer_FK, Attribute_FK, Attribute_count
    1000,      23,             1
    1001,      23,             1 
```

这样，您可以在第三列上使用简单的总和聚合来找出您有 2 个具有属性 #23 的客户。

我假设您将使用单个（平面）属性维度表并使用以客户为中心的数据库中的几个属性表填充它。

[http://www.kimballgroup.com/1996/09/02/factless-fact-tables/](http://www.kimballgroup.com/1996/09/02/factless-fact-tables/)

# javascript - 删除 ax vs ax = undefined

> ID：14967535
> 
> 赞同：171
> 
> 时间：2013-02-19T21:13:25.100
> 
> 标签：javascript

做这些有什么实质性的区别吗？

```
delete a.x; 
```

对比

```
a.x = undefined; 
```

在哪里

```
a = {
    x: 'boo'
}; 
```

可以说它们是等价的吗？

（我没有考虑[“V8 不喜欢使用`delete`更好”之](http://coding.smashingmagazine.com/2012/11/05/writing-fast-memory-efficient-javascript/)类的东西）

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2013-02-19T21:15:20.513

它们不是等价的。主要区别在于设置

```
a.x = undefined 
```

意味着它`a.hasOwnProperty("x")`仍然会返回 true，因此，它仍然会出现在一个`for in`循环中，并且在`Object.keys()`

```
delete a.x 
```

表示`a.hasOwnProperty("x")`将返回 false

它们相同的方式是您无法通过测试来判断属性是否存在

```
if (a.x === undefined) 
```

如果您试图确定一个属性是否存在，您不应该这样做，您应该始终使用

```
// If you want inherited properties
if ('x' in a)

// If you don't want inherited properties
if (a.hasOwnProperty('x')) 
```

**遵循原型链**（由[zzzzBov](https://stackoverflow.com/questions/14967535/delete-a-x-vs-a-x-undefined/14967568#answer-14967572)提到）调用`delete`将允许它沿着原型链向上，而将值设置为 undefined 将不会在链式原型[http://jsfiddle.net/NEEw4/1/中查找属性](http://jsfiddle.net/NEEw4/1/)

```
var obj = {x: "fromPrototype"};
var extended = Object.create(obj);
extended.x = "overriding";
console.log(extended.x); // overriding
extended.x  = undefined;
console.log(extended.x); // undefined
delete extended.x;
console.log(extended.x); // fromPrototype 
```

**删除继承**的属性 如果您尝试删除的属性是继承的，`delete`则不会影响它。也就是说，`delete`只删除对象本身的属性，而不是继承的属性。

```
var obj = {x: "fromPrototype"};
var extended = Object.create(obj);
delete extended.x;
console.log(extended.x); // Still fromPrototype 
```

因此，如果您需要确保一个对象的值是未定义的，`delete`在继承该属性时将不起作用，您必须`undefined`在这种情况下将其设置（覆盖）为。除非检查它的地方会使用`hasOwnProperty`，但假设检查它的地方将使用它可能是不安全的`hasOwnProperty`

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-02-19T21:15:29.187

解释这个问题：

> 是`delete a.x`和`a.x = undefined`等价的吗？

# 不。

前者从变量中删除键，后者将键设置为`undefined`。这在迭代对象的属性以及何时`hasOwnProperty`使用时会有所不同。

```
a = {
    x: true
};
a.x = undefined;
a.hasOwnProperty('x'); //true
delete a.x;
a.hasOwnProperty('x'); //false 
```

此外，当涉及原型链时，这将产生重大影响。

```
function Foo() {
    this.x = 'instance';
}
Foo.prototype = {
    x: 'prototype'
};
a = new Foo();
console.log(a.x); //'instance'

a.x = undefined;
console.log(a.x); //undefined

delete a.x;
console.log(a.x); //'prototype' 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-10-31T13:42:27.993

如果`a.x`是一个setter函数，`a.x = undefined`将调用该函数而`delete a.x`不会调用该函数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-19T21:24:33.243

是，有一点不同。如果你使用`delete a.x`x 不再是 a 的属性，但如果你使用`a.x=undefined`它是一个属性但它的值是未定义的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-19T21:16:46.110

名字有点混乱。`a.x = undefined`只是将属性设置为`undefined`，但属性仍然存在：

```
> var a = {x: 3};
> a.x = undefined;
> a.constructor.keys(a)
["x"] 
```

`delete`实际上删除它：

```
> var a = {x: 3};
> delete a.x;
> a.constructor.keys(a)
[] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-19T21:16:36.640

来自节点的这个 REPL 应该说明差异。

```
> a={ x: 'foo' };
{ x: 'foo' }
> for (var i in a) { console.log(i); };
x
undefined
> a.x=undefined;
undefined
> for (var i in a) { console.log(i); };
x
undefined
> delete a.x;
true
> for (var i in a) { console.log(i); };
undefined 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-19T21:26:40.213

我相信您可以看到 和 之间的`var o1 = {p:undefined};`区别`var o2 = {};`。

在这两种情况下，`o.p`都会，`undefined`但在第一种情况下，这是因为那是*价值*，而在第二种情况下，因为*没有价值*。

`delete`是允许您从`o1`（或另一个为其`p`属性分配了值的对象）以`o2`这种方式获取的运算符：`delete o1.p;`.

通过简单地`undefined`为属性分配一个值（在此示例中，但它可以是其他值）来进行反向操作`o1.p = undefined;`。

所以**不**，它们不等价。

* * *

`delete o.p;`将要

*   `p`如果对象有属性，则从对象中删除该属性

*   否则什么都不做

`o.p = undefined;`将要

*   `p`如果对象还没有属性，则向对象添加属性并将其值设置为`undefined`

*   如果对象已经拥有它，只需更改属性的值

* * *

从性能的角度来看，这`delete`是*不好*的，因为它*修改了对象的结构*（就像添加一个新属性，如果你没有在构造函数中初始化它）。

而将值设置`undefined`为也会释放内容，但不会强制修改结构。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-04-13T08:22:57.690

对象只是一个树表示，这意味着在内存中，根指向存储该对象的键的各个内存位置。并且该位置指向存储该键的实际值的另一个位置，或存储子键的位置或存储数组值的位置。

当您使用 delete 从对象中删除任何键时，实际上它会删除该键与其父对象之间的链接，并且释放键及其值的内存位置以存储其他信息。

当您尝试通过将 undefined 设置为其值来删除任何键时，您只是在设置其值，而不是删除该键。这意味着键的内存位置仍与其父对象和未定义键的值相关联。

使用 undefined 而不是 delete 关键字是一种不好的做法，因为它不会释放该键的内存位置。

即使该键不存在，并且您将其设置为未定义，那么该键也将使用 value 创建`undefined`。

例如

```
var a = {};
a.d = undefined;
console.log(a); // this will print { d: undefined } 
```

delete 不能与继承的属性一起使用，因为该属性不是该子对象的一部分。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-09-03T22:36:04.890

使用数组而不是对象，我可以展示 delete 使用的堆内存比 undefined 少。

例如，此代码不会完成：

```
let y = 1;
let ary = [];
console.log("Fatal Error Coming Soon");
while (y < 4294967295)
{
    ary.push(y);
    ary[y] = undefined;
    y += 1;
}
console(ary.length); 
```

它会产生此错误：

```
FATAL ERROR: CALL_AND_RETRY_LAST Allocation failed - JavaScript heap out of memory. 
```

因此，正如您所看到的，`undefined`实际上占用了堆内存。

但是，如果您还`delete`使用了 ary-item（而不仅仅是将其设置为`undefined`），代码将慢慢完成：

```
let x = 1;
let ary = [];
console.log("This will take a while, but it will eventually finish successfully.");
while (x < 4294967295)
{
    ary.push(x);
    ary[x] = undefined;
    delete ary[x];
    x += 1;
}
console.log(`Success, array-length: ${ary.length}.`); 
```

这些是极端的例子，但它们`delete`说明了我在任何地方都没有看到任何人提到的一点。

# javascript - flatiron.js：如何关闭静态文件的缓存？

> ID：14967549
> 
> 赞同：0
> 
> 时间：2013-02-19T21:14:16.993
> 
> 标签：javascript, node.js, flatiron.js

我正在使用这样的 flatiron 静态插件：

```
app.use(flatiron.plugins.static, {
    dir: './app/assets',
    cache: false
}); 
```

st 模块具有缓存选项，例如 cache: false。但它不是那样工作的。我不知道 flatiron 插件是否不接受缓存选项。对此有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T23:07:03.323

我不得不像这样插入插件：

```
app.use(flatiron.plugins.static, {dir: './app/assets', url: '/assets'}); 
```

否则，所有根 (/) 路由都将被缓存并提供静态服务。

# arrays - 如何在空格之间（在 bash 中）为 var 添加前缀，然后将连接的字符串返回到变量数组？

> ID：14967552
> 
> 赞同：1
> 
> 时间：2013-02-19T21:14:21.220
> 
> 标签：arrays, bash, variables, loops

例如

```
var=${foo}

somecommand=${fofo -b -a -r}

for i in "${somecommand}" ; do
            echo   $i
        done 
```

说这个这会返回一个完整的行

```
/bar /bar /bar 
```

我如何将每个实例添加到单独的变量数组中？

```
newVar1=${foo}/bar
newVar2${foo}/bar
newVar3${foo}/bar 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:04:17.777

如果您有一个`fofo -b -a -r`输出空格分隔标记的命令，例如`/foo /bar /baz`，您可以使用以下命令将其分配给数组：

```
myArray=( $(fofo -b -a -r) ) 
```

如果你有一个变量`foo=test`，你可以使用它为每个元素添加前缀

```
myPrefixedArray=( "${myArray[@]/#/$foo}" ) 
```

以机智：

```
foo=myprefix
myCmd() {
  echo /foo /bar /baz
}

myArray=( $(myCmd) )
myPrefixedArray=( "${myArray[@]/#/$foo}" )

echo "Values:"
for var in "${myPrefixedArray[@]}"
do
  echo "$var"
done 
```

哪个打印

```
Values:
myprefix/foo
myprefix/bar
myprefix/baz 
```

# jquery - 单击时更改锚点中的文本（Twitter Bootstrap 主题）

> ID：14967554
> 
> 赞同：0
> 
> 时间：2013-02-19T16:31:05.527
> 
> 标签：jquery, twitter-bootstrap

尝试了这么多不同的脚本来试图让这个工作不得不认输并问。我的 JQuery 设置是一个在 head 部分引用的外部 JS 文件，我将 JQuery 代码添加到该文件中。还有一个 Twitter Bootstrap 主题，它有自己的类和脚本。在这篇文章[http://skipology.com/iphoneography-applications-most-used/](http://skipology.com/iphoneography-applications-most-used/)上，我使用内置代码/类的 Twitter Bootstrap 创建了一些可扩展的 div。触发扩展和关闭的锚的html是：

```
<ul class="nav nav-tabs"><li class="active expandable"><a role="button" tabindex="0" 
data-toggle="collapse" data-target="#snapseed"><i class="icon-sort icon-large"></i> 
More...</a></li><ul> 
```

我要做的是在 div 展开时将“更多...”文本更改为“更少...”。我尝试了各种脚本，包括添加跨度和使用 click 或 onclick 触发的 toggle() 但似乎没有任何效果。Twitter Bootstrap 有各种我可以使用的事件，而不是我认为的 click 或 onclick，例如 show: shown: hide: 和 hidden:

我认为 JQuery、Wordpress 和 Bootstrap 的组合完全让我感到困惑。我知道我可以在静态网站上做到这一点。任何人都可以想出一个脚本吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T16:35:20.107

这对我有用

```
 $('[data-toggle="collapse"]').click(function() {
       $(this).text($(this).text() == 'More' ? 'Less' : 'More');
 }); 
```

谷歌把我带到了这个[来源](http://www.sitepoint.com/forums/showthread.php?554851-Changing-text-on-click-with-jquery)

注意：我使用的是 jQuery + Bootstrap，但不是 Wordpress，所以可能会有所不同

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:26:47.850

尝试这个：

```
$('li.expandable a[data-toggle="collapse"]').on('click',function(){
    if ($($(this).data('target')).hasClass('in')){
        $(this).val(($(this).val()).replace(/More/,'Less'));
    }
    else{
        $(this).val(($(this).val()).replace(/Less/,'More'));
    }
}) 
```

# iphone - 使用移动 Safari 上传图片时丢失 GPS 元数据

> ID：14967559
> 
> 赞同：1
> 
> 时间：2013-02-19T21:14:45.737
> 
> 标签：iphone, file-upload, gps, mobile-safari

我有输入“文件”类型的表单。目标是让用户上传我从中提取 GPS 数据的图片。我在服务器端进行了一些验证，以检查元数据是否存在，如果存在，我接受该文件。

当我从桌面上传图片时，一切正常。

当我通过移动 safari (iOS 6.1) 上传同一张图片时，我的验证失败。

我能找到的唯一解释是，野生动物园在上传图片之前会从图片中删除元数据，但这对我来说没有意义，所以我愿意接受建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T02:52:01.410

Mobile Safari 会通过文件输入框删除您上传的图片的 GPS 数据，但它会保留其他 EXIF 数据。无论您的隐私设置是什么，这都会发生。

# css - 设计后用 CSS 创建虚线对象

> ID：14967565
> 
> 赞同：3
> 
> 时间：2013-02-19T15:30:21.157
> 
> 标签：css, html

我正在尝试使用 HTML5 和 CSS3 编写更多我的设计，但我很想知道有些人为他们的对象做了什么。我想知道如何使用所有 CSS 复制此图像，最好是在一个类中，如果可以的话。这样做的**最佳**方法是什么？

![在此处输入图像描述](../Images/e9dd5ba1d4eff9f33391606bb1509a32.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T21:56:12.697

这将是获得该效果的css：

```
div{
  width: 200px;
  height: 200px; 
  border: 2px dashed black;
  margin: 100px;
  border-radius: 50%;
  }
  div:after{
  content: ' ';
  display: block;
  margin: -10px;
    width: 215px;  height: 215px; 
  border: 2px dashed black;
  transform:rotate(16deg);
  border-radius: 50%;

  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T20:52:19.793

您应该为此使用图像。gif、png 或 svg。

虽然使用 css 在*技术上*可以通过使用border: dashed 和高border-radius 我不推荐它，因为不同的浏览器以不同的方式实现虚线边框。没有关于浏览器渲染引擎应该如何渲染它的[w3 标准。](http://www.w3.org/TR/css3-background/)您还需要两个 div 并旋转其中一个。

值得注意的是 Firefox 和 android 浏览器将完全无法正确显示这一点。例如，Firefox 将在使用圆角半径时在圆角上显示一条实线（不是虚线）。

[我最近制作了一个可视化 css 构建器，它可以在这里](http://timswiss.net/playground/maker.php)很快地显示出来——尝试在不同的浏览器中使用不同的设置。

# c# - 获取列表的最小值

> ID：14967569
> 
> 赞同：-1
> 
> 时间：2013-02-19T21:15:21.577
> 
> 标签：c#, algorithm, search, a-star

我有一个`struct`包含几个`int`和`bool`成员的，我希望从列表中获得最低值（实际上是在制作一个基于 A* 搜索的路径查找器）。

基本上，我的对象如下所示：

```
 public struct Tile
    {
        public int id;
        public int x;
        public int y;
        public int cost;
        public bool walkable;
        public int distanceLeft;
        public int parentid;
    } 
```

我想得到距离最小的项目。列表声明如下：

```
 List<Structs.Tile> openList = new List<Structs.Tile>(); 
```

并以这种方式分配值：

```
 while (pathFound == null)
        {
            foreach (Structs.Tile tile in map)
            {
                foreach (Structs.Tile tile1 in getSurroundingTiles(Current))
                {
                    if (tile1.x == tile.x && tile1.y == tile.y)
                    {
                        Structs.Tile curTile = tile1;
                        curTile.parentid = Current.id;
                        curTile.distanceLeft = (Math.Abs(tile.x - goalx) + Math.Abs(tile.y - goaly));
                        if (curTile.distanceLeft == 0)
                        {
                            pathFound = true;
                        }
                        openList.Add(curTile);
                    }
                }
            }
            foreach (Structs.Tile tile in openList)
            {

            }
        } 
```

如果我不得不猜测，我会说这要么非常困难，要么比我说的要复杂得多，或者非常简单，我只是感到困惑。

我确实考虑过滚动列表并将每个项目与其较低的对应项进行比较，但考虑到我们所处的时代，这似乎不合理，似乎会有更简单的方法。我不关心列表的顺序，因为我为每个项目分配了一个索引，我可以从中调用它。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T21:40:52.987

其他答案解释了如何使用 LINQ 执行此操作 - 但是，它们全部`O(n)`或速度较慢。使用其中一种方法会*显着*减慢您的寻路算法。

相反，您**应该使用正确的数据结构**。您应该将节点存储在**优先队列**中，而不是列表，以获取*（并删除*）`O(log n)`.

请参阅[此问题](https://stackoverflow.com/questions/102398/priority-queue-in-net)以获取 .Net 中的优先级队列列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T21:22:26.360

没有一种 LINQ 扩展方法可以返回具有最小值的对象，但您可以自己编写一个。以下类对任何非空可枚举执行您想要的操作：

```
public static class MyExtensions
{
    public static TSource MinOf<TSource>(
        this IEnumerable<TSource> source,
        Func<TSource, int> selector)
    {
        // Get the enumerator.
        var enumerator = source.GetEnumerator();
        if (!enumerator.MoveNext())
            throw new InvalidOperationException("The source sequence is empty.");

        // Take the first value as a minimum.
        int minimum = selector(enumerator.Current);
        TSource current = enumerator.Current;

        // Go through all other values...
        while (enumerator.MoveNext())
        {
            int value = selector(enumerator.Current);
            if (value < minimum)
            {
                // A new minimum was found. Store it.
                minimum = value;
                current = enumerator.Current;
            }
        }

        // Return the minimum value.
        return current;
    }
} 
```

把它放在你的项目中的一个文件中，然后像这样调用它：

```
openList.MinOf(tile => tile.distanceLeft); 
```

这比排序整个序列（使用`OrderBy`）然后取第一个值（使用`First`）更有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T21:33:17.230

要获得`Tile`最低的`distanceLeft`，请尝试以下操作：

```
Tile tile = openList.OrderByAscending(t => t.distanceLeft).First(); 
```

**编辑：**

这样做将返回一个`IEnumerable<Tile>`按升序排序的 -`openList`它本身不会被修改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T21:40:14.883

或者，如果由于某种原因您不能使用 LINQ：

```
int lowest = 0;
for (int i = 1; i < openList.Count; ++i)
{
    if (openList[i].distanceLeft < openList[lowest].distanceLeft)
    {
        lowest = i;
    }
}
// lowest contains the index of the item with the lowest 'distanceLeft' value.
// You can return the item itself by indexing into the list.
var lowestItem = openList[lowest]; 
```

# javascript - 追加和删除元素

> ID：14967573
> 
> 赞同：1
> 
> 时间：2013-02-19T16:42:02.667
> 
> 标签：javascript, jquery, html

我目前正在使用 javascript、html 和 css 设计网页。该页面是一个座位预订座位，允许用户选择和取消选择座位。当用户选择座位时，我设法让页面显示座位的 id，但是如果用户取消选择座位，我在尝试从显示中删除 id 时遇到问题。

下面是javascript代码

```
 $('.available, .unavailable, .selected').click(function(){
        var ID = $(this).attr('class');
        if (ID == 'n unavailable' || ID == 'p unavailable') {
            alert ('Seat is already booked. Please select another seat.');
        }
        else if (ID == 'n selected' || ID == 'p selected') {
            alert ('You have now unselected this seat.');
            $(this).html('<img src = "free.gif"/>');
            $(this).removeClass('selected').addClass('available');
            y--;
            $("#seats").html("Number of seats selected: " + y);
            $("#list").remove($(this).attr('id'));
        }
        else {
            alert ('You have now reserved this seat. You can unselect it by clicking the seat again.');
            $(this).html('<img src = "selected.gif"/>');
            $(this).removeClass('available').addClass('selected');
            y++;
            $("#seats").html("Number of seats selected: " + y);
            $("#list").append($(this).attr('id') + "</br>");
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:24:34.540

`remove()`删除 dom 元素，而不是属性。只需将属性设置为空字符串：`$("#list").attr('id', '')`

# 编辑

在查看您的问题后，我想我误解了。您想删除显示 ID 的文本，而不是实际的 id 属性，对吗？

在这种情况下，最简单的方法是将文本节点包装在某种元素中，以便更容易选择删除。

在附加字符串 ( `$("#list").append($(this).attr('id') + "</br>");`) 的地方，将输出包装在一个跨度中，如下所示：

```
$("#list").append('<div class="id">' + $(this).attr('id') + "</div>"); 
```

这样，您可以将其删除：

```
$('#list').remove('#id'); 
```

# signalr - EnableAutoRejoiningGroups 在 SignalR 1.0 中消失了

> ID：14967575
> 
> 赞同：2
> 
> 时间：2013-02-19T21:15:31.873
> 
> 标签：signalr

看起来 GlobalHost.HubPipeline.EnableAutoRejoiningGroups() 在 SignalR 的 1.0 最终版本中消失了。

但是，在发行说明中没有提及它的去向，也不知道如何恢复此功能。

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T21:27:07.603

在源代码树中找到注释：

*EnableAutoRejoining 已从 HubPipeline 中删除。此功能默认开启。*

# javascript - jQuery mouseover 函数一直闪烁

> ID：14967578
> 
> 赞同：0
> 
> 时间：2013-02-19T21:15:36.867
> 
> 标签：javascript, jquery, html

我在使用鼠标悬停功能时遇到问题，我有一个 div，当悬停在它上面时，它的子 div 淡入并在 mouseleave 上淡出。子 div 显示得很好，但是当您将鼠标移到上方时，它会不断淡入淡出，这很烦人。
这是一个小提琴： http: [//jsfiddle.net/NK2mt/1/](http://jsfiddle.net/NK2mt/1/)和我的 jQuery 函数也在这里：

```
jQuery(document).ready(function(){

jQuery(".hover").hide();

    jQuery('.grid-block').mouseover(function() {
        jQuery(this).children('.hover').stop(true, true).fadeIn();
        });

    jQuery('.grid-block').mouseout(function() {
        jQuery(this).children('.hover').stop(true, true).fadeOut();
        });   
        return false; 
}); 
```

当您将鼠标移到`.block-text-sub`div 上淡出并再次淡入时，我似乎无法找到解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:19:08.360

使用'mouseenter'代替'mouseover'和'mouseleave'代替'mouseout'，当你使用'mouseout'时，每次'mouseout'出现在主div的任何内部元素上时都会触发，'mouseover'也是如此：

```
 jQuery(document).ready(function(){

    jQuery(".hover").hide();

        jQuery('.grid-block').mouseenter(function() {
            jQuery(this).children('.hover').stop(true, true).fadeIn();
            });

        jQuery('.grid-block').mouseleave(function() {
            jQuery(this).children('.hover').stop(true, true).fadeOut();
            });   
            return false; 
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:16:33.433

你可以用 CSS3 做同样的事情`transition`（FADE 效果）

```
.grid-block:hover .hover {
    opacity: 1;
}
.grid-block .hover {
    transition: opacity .5s ease-in-out;
    -moz-transition: opacity .5s ease-in-out;
    -webkit-transition: opacity .5s ease-in-out;
    opacity: 0;
} 
```

**演示：http:** [//jsfiddle.net/NK2mt/3/](http://jsfiddle.net/NK2mt/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:16:51.967

您应该使用`hover`而不是`mouseover`. `mouseenter`它将和`mouseleave`事件的处理程序绑定在一起。

基本上，调用`hover`

`$(selector).hover(handlerIn, handlerOut)`

是以下的简写：

```
$(selector).mouseenter(handlerIn).mouseleave(handlerOut); 
```

它应该摆脱你的闪烁。

# php - MYSQL - 如何按时间查询数据库

> ID：14967579
> 
> 赞同：1
> 
> 时间：2013-02-19T21:15:47.983
> 
> 标签：php, mysql, pdo

我说数据库中有 12 个结果，其列名为

```
thread

message

time_posted 
```

有 12 个结果，它们都有相同的`thread`女巫是 1002。

我正在努力获得所有结果`time_posted` `"2013-03-19 17:36:08"`。两边至少有 4 个条目，所以我应该在这段时间之后得到 4 个条目。

到目前为止，在我尝试过的所有内容中，我要么收到了一个空数组，要么得到了除了`2013-03-19 17:36:08`时间戳记的行之外的所有内容。

这是我尝试过的：

```
 public function get_messages($thread){

        $time = '2013-03-19 17:36:08';

        $statement = $this->database->prepare("SELECT * FROM chat WHERE thread = ? AND time_posted > '$time'");

        $statement->bindParam(1, $thread);

        $statement->execute();

        $this->result = $statement->fetchAll(PDO::FETCH_ASSOC);

        return $this->result;

    } 
```

我用 < AND > 都试过了

提前感谢您的帮助。

一切顺利。

康纳

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:21:59.020

尝试这个：

```
 $time = '2013-03-19 17:36:08';

    $statement = $this->database->prepare("SELECT * FROM chat WHERE thread = ? AND time_posted >= STR_TO_DATE(?, '%Y-%m-%d %H:%i:%s')");

    $statement->bindParam(1, $thread);
    $statement->bindParam(2, $time );

    $statement->execute(); 
```

# c# - NLog - 数据库目标的运行时参数

> ID：14967581
> 
> 赞同：3
> 
> 时间：2013-02-19T21:15:55.363
> 
> 标签：c#, .net, c#-4.0, nlog

我正在尝试向我的数据库日志目标添加一些自定义。在我的 NLog.config 中，我有这个：

```
<target name="DatabaseExample1" xsi:type="Database"
 dbProvider="System.Data.SqlClient"
 dbDatabase="${event-context:item=dbDatabase}"
 dbUserName="${event-context:item=dbUserName}"
 dbPassword="${event-context:item=dbPassword}"
 dbHost="${event-context:item=dbHost}"
 commandText="${event-context:item=commandText}">
</target> 
```

在我的 C# 代码中，我有这个：

```
protected override void updateBeforeLog(LogEventInfo info)
{
    info.Properties["dbDatabase"] = "TempDB";
    info.Properties["dbUserName"] = "username";
    info.Properties["dbPassword"] = "password";
    info.Properties["dbHost"] = "SERVER\\SQLSERVER";
    info.Properties["commandText"] = "exec InsertLog @LogDate, @LogLevel, @Location, @Message";

    info.Parameters = new DatabaseParameterInfo[] {
        new DatabaseParameterInfo("@LogDate", Layout.FromString("${date:format=yyyy\\-MM\\-dd HH\\:mm\\:ss.fff}")), 
        new DatabaseParameterInfo("@LogLevel", Layout.FromString("${level}")),
        new DatabaseParameterInfo("@Location", Layout.FromString("${event-context:item=location}")),
        new DatabaseParameterInfo("@Message", Layout.FromString("${event-context:item=shortmessage}"))
    };

    log.Log(info);
} 
```

但是我收到一条 SQL 错误，上面写着“必须声明标量变量“@LogDate””。

这些属性正在工作，因为连接成功。但是由于某种原因，参数没有“绑定”到命令中的标量变量。

如果我在 NLog.config 文件中手动创建参数，它会完美运行：

```
<target name="DatabaseExample1" xsi:type="Database"
 dbProvider="System.Data.SqlClient"
 dbDatabase="${event-context:item=dbDatabase}"
 dbUserName="${event-context:item=dbUserName}"
 dbPassword="${event-context:item=dbPassword}"
 dbHost="${event-context:item=dbHost}"
 commandText="${event-context:item=commandText}">
   <parameter name="@LogDate" layout="${date:format=yyyy\-MM\-dd HH\:mm\:ss.fff}" />
   <parameter name="@LogLevel" layout="${level}" />
   <parameter name="@Location" layout="${event-context:item=location}" />
   <parameter name="@Message" layout="${event-context:item=shortmessage}" />
</target> 
```

但这违背了能够在运行时自定义 commandText 和参数值的整个目的。

我需要做什么才能使目标正确获取参数值？

**更新**

总的来说，我希望有一种方法可以通过 C# 代码自定义目标。我想依赖的 NLog.config 文件只有需要的东西。但似乎 NLog 与配置文件设置非常相关，我正在尝试在该约束内工作，但要尽可能灵活。有了这个数据库目标，如果我能弄清楚如何以编程方式更新参数，那么我可以在配置文件中有一个相当通用的目标，然后更新 LogEventInfo 属性和参数以适应要连接或存储的任何数据库的需要要执行的程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T17:15:52.983

**更新**

事实证明，该`LogEventInfo.Parameters`集合用于该`LogEventInfo.FormattedMessage`属性。如果你想使用`LogEventInfo.FormatProvider`或什至设置`LogEventInfo.Message`等于一个`string.format`字符串，那么`Parameters`object[] 数组用于提供字符串中的替换。[请参阅此处获取代码](https://github.com/NLog/NLog/blob/master/src/NLog/LogEventInfo.cs#L435)。

尽管命名相似，在 NLog.config 文件`LogEventInfo.Parameters`中并不对应。`<target ><parameter /></target>`而且似乎没有办法通过`LogEventInfo`对象获取数据库参数。（感谢 NLog 项目论坛上的 Kim Christensen 提供该链接）

* * *

我能够使用自定义目标来完成这项工作。~~但我仍然质疑为什么我以前的方法不起作用。看起来如果`Parameters`数组是可访问的，NLog 应该尊重分配给它的参数。~~

也就是说，这是我最终使用的代码：

首先，我必须创建自定义目标并将其设置为将数据发送到数据库：

```
[Target("DatabaseLog")]
public sealed class DatabaseLogTarget : TargetWithLayout
{
  public DatabaseLogTarget()
  {
  }

  protected override void Write(AsyncLogEventInfo logEvent)
  {
    //base.Write(logEvent);
    this.SaveToDatabase(logEvent.LogEvent);
  }

  protected override void Write(AsyncLogEventInfo[] logEvents)
  {
    //base.Write(logEvents);
    foreach (AsyncLogEventInfo info in logEvents)
    {
      this.SaveToDatabase(info.LogEvent);
    }
  }

  protected override void Write(LogEventInfo logEvent)
  {
    //string logMessage = this.Layout.Render(logEvent);
    this.SaveToDatabase(logEvent);
  }

  private void SaveToDatabase(LogEventInfo logInfo)
  {
    if (logInfo.Properties.ContainsKey("commandText") &&
      logInfo.Properties["commandText"] != null)
    {
      //Build the new connection
      SqlConnectionStringBuilder builder = new SqlConnectionStringBuilder();

      //use the connection string if it's present
      if (logInfo.Properties.ContainsKey("connectionString") && 
        logInfo.Properties["connectionString"] != null)
        builder.ConnectionString = logInfo.Properties["connectionString"].ToString();

      //set the host
      if (logInfo.Properties.ContainsKey("dbHost") &&
        logInfo.Properties["dbHost"] != null)
        builder.DataSource = logInfo.Properties["dbHost"].ToString();

      //set the database to use
      if (logInfo.Properties.ContainsKey("dbDatabase") &&
        logInfo.Properties["dbDatabase"] != null)
        builder.InitialCatalog = logInfo.Properties["dbDatabase"].ToString();

      //if a user name and password are present, then we're not using integrated security
      if (logInfo.Properties.ContainsKey("dbUserName") && logInfo.Properties["dbUserName"] != null &&
        logInfo.Properties.ContainsKey("dbPassword") && logInfo.Properties["dbPassword"] != null)
      {
        builder.IntegratedSecurity = false;
        builder.UserID = logInfo.Properties["dbUserName"].ToString();
        builder.Password = logInfo.Properties["dbPassword"].ToString();
      }
      else
      {
        builder.IntegratedSecurity = true;
      }

      //Create the connection
      using (SqlConnection conn = new SqlConnection(builder.ToString()))
      {
        //Create the command
        using (SqlCommand com = new SqlCommand(logInfo.Properties["commandText"].ToString(), conn))
        {
          foreach (DatabaseParameterInfo dbi in logInfo.Parameters)
          {
            //Add the parameter info, using Layout.Render() to get the actual value
            com.Parameters.AddWithValue(dbi.Name, dbi.Layout.Render(logInfo));
          }

          //open the connection
          com.Connection.Open();

          //Execute the sql command
          com.ExecuteNonQuery();
        }
      }
    }
  }
} 
```

接下来，我更新了我的 NLog.config 文件以包含新目标的规则：

```
<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <targets async="true">
    <target name="DatabaseLog1" xsi:type="DatabaseLog" />
  </targets>
  <rules>
    <logger name="LogDB"  minlevel="Trace" writeTo="DatabaseLog1" />
  </rules>
</nlog> 
```

然后我创建了一个类来包装我的数据库日志调用。它还提供了一个将 an`Exception`转换为 NLog`LogEventInfo`对象的函数：

```
public class DatabaseLogger
{
  public Logger log = null;

  public DatabaseLogger()
  {
    //Make sure the custom target is registered for use BEFORE using it
    ConfigurationItemFactory.Default.Targets.RegisterDefinition("DatabaseLog", typeof(DatabaseLogTarget));

    //initialize the log
    this.log = NLog.LogManager.GetLogger("LogDB");
  }

  /// <summary>
  /// Logs a trace level NLog message</summary>
  public void T(LogEventInfo info)
  {
    info.Level = LogLevel.Trace;
    this.Log(info);
  }

  /// <summary>
  /// Allows for logging a trace exception message to multiple log sources.
  /// </summary>
  public void T(Exception e)
  {
    this.T(FormatError(e));
  }

  //I also have overloads for all of the other log levels...

  /// <summary>
  /// Attaches the database connection information and parameter names and layouts
  /// to the outgoing LogEventInfo object. The custom database target uses
  /// this to log the data.
  /// </summary>
  /// <param name="info"></param>
  /// <returns></returns>
  public virtual void Log(LogEventInfo info)
  {
    info.Properties["dbHost"] = "SQLServer";
    info.Properties["dbDatabase"] = "TempLogDB";
    info.Properties["dbUserName"] = "username";
    info.Properties["dbPassword"] = "password";
    info.Properties["commandText"] = "exec InsertLog @LogDate, @LogLevel, @Location, @Message";

    info.Parameters = new DatabaseParameterInfo[] {
      new DatabaseParameterInfo("@LogDate", Layout.FromString("${date:format=yyyy\\-MM\\-dd HH\\:mm\\:ss.fff}")), 
      new DatabaseParameterInfo("@LogLevel", Layout.FromString("${level}")),
      new DatabaseParameterInfo("@Location", Layout.FromString("${event-context:item=location}")),
      new DatabaseParameterInfo("@Message", Layout.FromString("${event-context:item=shortmessage}"))
    };

    this.log.Log(info);
  }

  /// <summary>
  /// Creates a LogEventInfo object with a formatted message and 
  /// the location of the error.
  /// </summary>
  protected LogEventInfo FormatError(Exception e)
  {
    LogEventInfo info = new LogEventInfo();

    try
    {
      info.TimeStamp = DateTime.Now;

      //Create the message
      string message = e.Message;
      string location = "Unknown";

      if (e.TargetSite != null)
        location = string.Format("[{0}] {1}", e.TargetSite.DeclaringType, e.TargetSite);
      else if (e.Source != null && e.Source.Length > 0)
        location = e.Source;

      if (e.InnerException != null && e.InnerException.Message.Length > 0)
        message += "\nInnerException: " + e.InnerException.Message;

      info.Properties["location"] = location;

      info.Properties["shortmessage"] = message;

      info.Message = string.Format("{0} | {1}", location, message);
    }
    catch (Exception exp)
    {
      info.Properties["location"] = "SystemLogger.FormatError(Exception e)";
      info.Properties["shortmessage"] = "Error creating error message";
      info.Message = string.Format("{0} | {1}", "SystemLogger.FormatError(Exception e)", "Error creating error message");
    }

    return info;
  }
} 
```

所以当我启动我的应用程序时，我可以轻松地开始记录：

```
DatabaseLogger dblog = new DatabaseLogger();
dblog.T(new Exception("Error message", new Exception("Inner message"))); 
```

稍加努力，我就可以从`DatabaseLogger`该类继承并覆盖该`Log`方法以创建任意数量的不同数据库日志。如果需要，我可以动态更新连接信息。我可以更改`commandText`and`Parameters`以适应每个数据库调用。我只需要有一个目标。

如果我想为多种数据库类型提供功能，我可以添加一个`info.Properties["dbProvider"]`在方法中读取的属性，`SaveToDatabase`然后可以生成不同的连接类型。

# sockets - 什么是时钟恢复？

> ID：14967582
> 
> 赞同：-1
> 
> 时间：2013-02-19T21:16:06.850
> 
> 标签：sockets, networking, encoding

在谷歌上找不到太多相关信息..所以如果有人愿意向我解释以下问题，我们将不胜感激！
时钟恢复到底是什么（它是如何工作的），为什么 NRZ 在时钟恢复方面遇到问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:28:40.773

> 在google上找不到太多相关信息

你有多努力？

以下是一些起点：

*   [http://en.wikipedia.org/wiki/Clock_recovery](http://en.wikipedia.org/wiki/Clock_recovery)
*   [http://en.wikipedia.org/wiki/Non-return-to-zero](http://en.wikipedia.org/wiki/Non-return-to-zero)

有很多方法可以进行时钟恢复。NRZ 在时钟恢复方面“遇到问题”的原因是，如果存在长串 1 或 0，则信号上没有转换。

# highcharts - 如何在 HIGHCHARTS 的一个系列中包含两个数据？

> ID：14967585
> 
> 赞同：5
> 
> 时间：2013-02-19T21:16:23.740
> 
> 标签：highcharts

我正在使用 highcharts 堆叠和分组列来制作以下图表：

[图片](http://i.stack.imgur.com/yPmou.png)

我无法让它工作，我有以下代码：

```
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'column'
            },
            title: {
                text: 'Types of answer'
            },
            subtitle: {
                text: 'SORT BY: Ages'
            },
            xAxis: {
                categories: ['First Test','Second Test','Third Test']
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Numero de pacientes'
                },
                stackLabels: {
                    enabled: true,
                    style: {
                        fontWeight: 'bold',
                        color: (Highcharts.theme && Highcharts.theme.textColor) || 'gray'
                    }
                }
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'top',
                x: -150,
                y: -13,
                floating: true,
                backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColorSolid) || 'white',
                borderColor: '#CCC',
                borderWidth: 1,
                shadow: false
            },
            tooltip: {
                formatter: function() {
                    return '<b>'+ this.x +'</b><br/>'+
                        this.series.name +': '+ this.y +'<br/>'+
                        'Total: '+ this.point.stackTotal;
                }
            },
            plotOptions: {
                column: {
                    stacking: 'normal',
                    dataLabels: {
                        enabled: true,
                        color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white'
                    }
                }
            },
            series: [{
                name: 'Answer 1',
                data: [variable1, variable7, variable13],
                stack: 'Less than 18',
                data: [variable19, variable25, variable31],
                stack: 'More than 18'
            },{
                name: 'Answer 2',
                data: [variable2, variable8, variable14],
                stack: 'Less than 18',
                data: [variable20, variable26, variable32],
                stack: 'More than 18'
            },{
                name: 'Answer 3',
                data: [variable3, variable9, variable15],
                stack: 'Less than 18',
                data: [variable21, variable27, variable33],
                stack: 'More than 18'
            }]
        });
    });

}); 
```

我不想使用另一个系列，因为我不希望它们出现在图例中，我希望图例只列出

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-04T18:44:35.807

您可以将多个系列链接到一个图例项中以进行隐藏和显示，以及不使用系列中的 linkedTo 属性的内容 -

[http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/demo/arearange-line/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/demo/arearange-line/)

```
series: [{
    name: 'Temperature',
    data: averages,
    zIndex: 1,
    marker: {
        fillColor: 'white',
        lineWidth: 2,
        lineColor: Highcharts.getOptions().colors[0]
    }
}, {
    name: 'Range',
    data: ranges,
    type: 'arearange',
    lineWidth: 0,
    linkedTo: ':previous',
    color: Highcharts.getOptions().colors[0],
    fillOpacity: 0.3,
    zIndex: 0
}] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:37:17.277

您需要分离系列中的堆栈组。您的系列应该与此类似：

```
series: [ {
            name: 'Answer 1',
            data: [variable1, variable7, variable13],
            stack: 'Less than 18'
        },
        {
            name: 'Answer 1',
            data: [variable19, variable25, variable31],
            stack: 'More than 18'
        },
        {
            name: 'Answer 2',
            data: [variable2, variable8, variable14],
            stack: 'Less than 18'
        },
        {
            name: 'Answer 2',
            data: [variable20, variable26, variable32],
            stack: 'More than 18'
        },
        {
            name: 'Answer 3',
            data: [variable3, variable9, variable15],
            stack: 'Less than 18'
        },
        {
            name: 'Answer 3',
            data: [variable21, variable27, variable33],
            stack: 'More than 18'
        }
        ] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T11:50:10.390

在这里您可以找到示例，如何使用`legendItemClick`将两个系列连接成一个图例项：http: [//jsfiddle.net/5m9JW/326/](http://jsfiddle.net/5m9JW/326/)

# java - java.lang.String 中的 NullPointerException

> ID：14967592
> 
> 赞同：0
> 
> 时间：2013-02-19T21:16:49.867
> 
> 标签：java, jpa, glassfish, mysql-connector

堆栈跟踪：

```
[#|2013-02-19T16:05:25.596-0500|WARNING|glassfish3.1.2|org.eclipse.persistence.session.file:/opt/glassfish3/glassfish/domains/domain1/applications/PulseEngine/PulseEngine-ejb_jar/_PulsePU|    _ThreadID=103;_Th
readName=Thread-2;|java.lang.NullPointerException
at java.lang.String.checkBounds(String.java:374)
at java.lang.String.<init>(String.java:415)
at com.mysql.jdbc.SingleByteCharsetConverter.<init>(SingleByteCharsetConverter.java:153)
at com.mysql.jdbc.SingleByteCharsetConverter.initCharset(SingleByteCharsetConverter.java:108)
at com.mysql.jdbc.SingleByteCharsetConverter.getInstance(SingleByteCharsetConverter.java:86)
at com.mysql.jdbc.Connection.getCharsetConverter(Connection.java:3505)
at com.mysql.jdbc.ResultSet.getStringInternal(ResultSet.java:5667)
at com.mysql.jdbc.ResultSet.getString(ResultSet.java:5544)
at com.mysql.jdbc.ResultSet.getFloat(ResultSet.java:2523)
at com.sun.gjc.spi.base.ResultSetWrapper.getFloat(ResultSetWrapper.java:239)
at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.getObjectThroughOptimizedDataConversion(DatabaseAccessor.java:1267)
at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.getObject(DatabaseAccessor.java:1170)
at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.fetchRow(DatabaseAccessor.java:999)
at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.processResultSet(DatabaseAccessor.java:723)
at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.basicExecuteCall(DatabaseAccessor.java:621)
at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeCall(DatabaseAccessor.java:535)
at org.eclipse.persistence.internal.sessions.AbstractSession.basicExecuteCall(AbstractSession.java:1717)
at org.eclipse.persistence.sessions.server.ClientSession.executeCall(ClientSession.java:253)
at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:207)
at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:193)
at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeSelectCall(DatasourceCallQueryMechanism.java:264)
at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.selectAllRows(DatasourceCallQueryMechanism.java:646)
at org.eclipse.persistence.internal.queries.ExpressionQueryMechanism.selectAllRowsFromTable(ExpressionQueryMechanism.java:2611)
at org.eclipse.persistence.internal.queries.ExpressionQueryMechanism.selectAllRows(ExpressionQueryMechanism.java:2570)
at org.eclipse.persistence.queries.ReadAllQuery.executeObjectLevelReadQuery(ReadAllQuery.java:420)
at org.eclipse.persistence.queries.ObjectLevelReadQuery.executeDatabaseQuery(ObjectLevelReadQuery.java:1081)
at org.eclipse.persistence.queries.DatabaseQuery.execute(DatabaseQuery.java:844)
at org.eclipse.persistence.queries.ObjectLevelReadQuery.execute(ObjectLevelReadQuery.java:1040)
at org.eclipse.persistence.queries.ReadAllQuery.execute(ReadAllQuery.java:392)
at org.eclipse.persistence.queries.ObjectLevelReadQuery.executeInUnitOfWork(ObjectLevelReadQuery.java:1128)
at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.internalExecuteQuery(UnitOfWorkImpl.java:2871)
at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1516)
at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1498)
at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1463)
at org.eclipse.persistence.internal.jpa.EJBQueryImpl.executeReadQuery(EJBQueryImpl.java:485)
at org.eclipse.persistence.internal.jpa.EJBQueryImpl.getSingleResult(EJBQueryImpl.java:773)
at enkia.pulse.indexing.SentimentAnalysisIndexer.insertSentiment(SentimentAnalysisIndexer.java:376)
at enkia.pulse.indexing.SentimentAnalysisIndexer.insertSentiments(SentimentAnalysisIndexer.java:355)
at enkia.pulse.indexing.SentimentAnalysisIndexer.clusterCategorySentiments(SentimentAnalysisIndexer.java:530)
at enkia.pulse.indexing.beans.SAIBean.ejbTimeout(SAIBean.java:120)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.glassfish.ejb.security.application.EJBSecurityManager.runMethod(EJBSecurityManager.java:1052)
at org.glassfish.ejb.security.application.EJBSecurityManager.invoke(EJBSecurityManager.java:1124)
at com.sun.ejb.containers.BaseContainer.invokeBeanMethod(BaseContainer.java:5388)
at com.sun.ejb.EjbInvocation.invokeBeanMethod(EjbInvocation.java:619)
at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.doAround(SystemInterceptorProxy.java:162)
at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.aroundTimeout(SystemInterceptorProxy.java:149)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
at com.sun.ejb.containers.interceptors.InterceptorManager.intercept(InterceptorManager.java:370)
at com.sun.ejb.containers.BaseContainer.__intercept(BaseContainer.java:5360)
at com.sun.ejb.containers.BaseContainer.intercept(BaseContainer.java:5348)
at com.sun.ejb.containers.BaseContainer.callEJBTimeout(BaseContainer.java:4058)
at com.sun.ejb.containers.EJBTimerService.deliverTimeout(EJBTimerService.java:1832)
at com.sun.ejb.containers.EJBTimerService.access$100(EJBTimerService.java:108)
at com.sun.ejb.containers.EJBTimerService$TaskExpiredWork.run(EJBTimerService.java:2646)
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
at java.util.concurrent.FutureTask.run(FutureTask.java:166)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
at java.lang.Thread.run(Thread.java:722) 
```

我完全不知所措。我尝试在 OpenJDK 和 Oracle JDK 之间来回切换。我在 Ubuntu 12.10 上。该项目使用 mysql-connector-java-5.1.13 作为 jdbc 驱动程序。

任何线索表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T21:20:40.643

如果您查看字符串的来源：

```
private static void checkBounds(byte[] bytes, int offset, int length) {
    if (length < 0)
        throw new StringIndexOutOfBoundsException(length);
    if (offset < 0)
        throw new StringIndexOutOfBoundsException(offset);
    if (offset > bytes.length - length)
        throw new StringIndexOutOfBoundsException(offset + length);
} 
```

似乎表明您可能正在传递一个为空的字节数组。第三个 if 语句是抛出 NPE 的地方。

也许您的结果集有一个空值 (byte[])，您正试图将其转换为字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:30:02.283

这与结果集中的字符串无关；它是关于构造函数中的代码`SingleByteCharsetConverter`，它试图`String`用`null`字节数组进行实例化。这可能是由于 MySQL JDBC 驱动程序配置错误造成的。检查是否有系统属性可以设置为 MySQL 数据库的默认字符编码。如果编码名称应该来自数据库，那么它可能是驱动程序中的错误或数据库端缺少配置。

# php - MySQL INNER JOIN 在一列中有多个值

> ID：14967599
> 
> 赞同：0
> 
> 时间：2013-02-19T21:17:17.490
> 
> 标签：php, mysql

有谁知道如何使用列中表中的多个值进行 mysql 内部连接，我的意思是：

t_1： **`id_t1 | name`**
           `001 | name_value`

t_2： **`id_t2 | value`**
           `020 | value1`
           `030 | value2`
           `040 | value3`
           `050 | value4`

t1_t2： **`id_t1 | id_t2`**
              `001 | 020`
              `001 | 030`
              `001 | 050`

然后，一个返回我的查询，例如：

**`id_t1 | name`**           **`| values_t_2`**
    `001 | name_value | value1, value2, value4`

如果有人能告诉我这样做的方法，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T21:19:22.373

```
SELECT
    t1.id_t1,
    t1.name,
    GROUP_CONCAT(t2.value SEPARATOR ', ') AS values_t_2
FROM
    t_1 t1
    INNER JOIN t1_t2 t1t2 ON (t1.id_t1 = t1t2.id_t1)
    INNER JOIN t_2 t2 ON (t1t2.id_t2 = t2.id_t2)
GROUP BY
    t1.id_t1 
```

# sas - 读取 sas 字符串中的特定单词

> ID：14967601
> 
> 赞同：-2
> 
> 时间：2013-02-19T21:17:30.093
> 
> 标签：sas

给定下面的一列，我试图使用 sas 9.1 分隔联系人、地址、邮编、电话、传真和网站地址

第 1 列：公司地址

> 联系人：Sean Collins 地址：6301 NW 5th Way Suite1700 Fort Lauderdale, FL 33309 电话：(954) 689-3984 传真：(954) 689-3985 [http://www.aajtech.com](http://www.aajtech.com)

输出应该是这样的

```
column 2 : Contact - Sean Collins
column 3 : address - 6301 NW 5th Way   Suite1700   Fort Lauderdale, FL
column 4 : zip - 33309 
column 5 : phone - (954) 689-3984
column 6 : fax - (954) 689-3985
column 7 : website - http://www.aajtech.com 
```

这就是我正在尝试的。

```
proc sort data=Ex2 out=Ex3 nodup dupout=b_out; 
 by city;
run;

data Final;
set Ex2;
a=find(Company_Address,"http");
website=substr(Company_Address,a,50);
b=find(Company_Address,"Phone:");
phone=substr(Company_Address,b,21);
c=find(Company_Address,"Fax");
Fax=substr(Company_Address,c,19);
Add=substr(Company_Address,1,b-1);
Z=find(Add,"http");
Address=substr(Add,1,z-1);
if Address=website then Address=" ";
drop a b c z Add;
run; 
```

非常感谢一些帮助解决这个问题。

注意：这里发布的问题不是我的工作/工作的一部分，我是一个试图弄清楚事情的新手（这些是我自己的场景），原因是好奇..语法在一定程度上得到了解决，但是程序无法区分公司名称和联系人姓名，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T02:29:03.267

这个问题对于 StackOverflow 来说可能过于“本地化”，但我发现它很有趣，并且无论如何都会给出一个解决方案。编码技术也可能对其他人有用。

```
data Final;
   set Ex2;
   /* Define the variables you want to keep */
   length Contact $30
          Address $60
          Zip     $5
          Phone   $20
          Fax     $20
          Website $60;
   keep Contact Address Zip Phone Fax Website;

   length tmp_addr var value $200;
   tmp_addr = company_address;
   do while(not last_var);
      var = scan(tmp_addr,1,':');
      substr(tmp_addr,1,length(var)+1) = '';
      if index(tmp_addr,':') > 0 then do;
         value = scan(tmp_addr,1,':');
         value = substr(value,1,length(value) - length(scan(value,-1,' '))-1);
         substr(tmp_addr,1,length(value)+1) = '';
         end;
      else do;
         value = tmp_addr;
         last_var = 1;
         end;
      var = left(var);
      value = left(value);
      select(var);
         when ('Contact') do;
            Contact = value;
            end;
         when ('Address') do;
            Zip = scan(value,-1,' ');
            if zipstate(zip) = ' ' 
               then do;
                  Zip = ' ';
                  Address = value;
                  end;
               else do;
                  Address = substr(value,1,length(value) - length(scan(value,-1,' '))-1);;
                  end;
            end;
         when ('Phone') do;
            Phone = value;
            end;
         when ('Fax') do;
            Fax = value;
            end;
         when ('http') do;
            Website = 'http:' || value;
            end;
         otherwise do;
            putlog 'Unknown variable: ' var;
            end;
         end;

      end;
run; 
```

这是一个老式的解决方案，我相信有一种更现代的方式使用正则表达式。它使用循环单步执行 Company_Address 变量，解析由冒号前缀标识的列。它适用于提供的示例字符串。

我还添加了对有效邮政编码的检查，但请注意，这仅适用于 5 位邮政编码，并且会在日志中针对无效代码生成错误消息（您可以忽略）。

# javascript - IE7 中未定义 event.pageX 和 event.pageY

> ID：14967603
> 
> 赞同：0
> 
> 时间：2013-02-19T21:17:40.750
> 
> 标签：javascript, jquery

这是 a 标签内的 onclick 监听器

```
onclick="showMap('change-img-box',event); return false;" 
```

这是jquery

```
function showMap(id,e){
var hpos = e.pageX, ypos = e.pageY; alert(hpos+'----'+ypos);
if($("#"+id).is(":visible")){
    $("#"+id).hide();
}else{
    $("#"+id).css({"top": ypos+10, "left": hpos+10}).hide().fadeIn(300);
}
} 
```

不知道为什么，但是 IE 7 说 hpos 和 ypos 都是未定义的。我怎样才能解决这个问题。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:20:43.097

旧版本的 IE 使用`clientX`and`clientY`代替。这是我用于跨浏览器兼容性的函数：

```
window.getMouseCoords = function(e) {
    if( !e) return {x:0,y:0};
    if( e.pageX || e.pageY) {
        return {x:e.pageX,y:e.pageY};
    }
    if( e.clientX || e.clientY) {
        return {
            x:e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,
            y:e.clientY+document.body.scrollTop+document.documentElement.scrollTop
        };
    }
    return {x:0,y:0};
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T21:26:24.163

由于您已经在使用 jquery，您可以使用 jquery 而不是内联 onclick 来初始化 click 事件。jQuery 根据 W3C 标准规范化事件对象（[http://api.jquery.com/category/events/event-object/](http://api.jquery.com/category/events/event-object/)）

```
$('#thing-you-are-clicking').click( function(e) {
    var hpos = e.pageX, ypos = e.pageY;
    // Do your stuff here...
}); 
```

如果您需要“id”数据，可以使用 data-* 属性将其放入按钮的 dom 中，例如

```
<a href="#" id="thing-you-are-clicking" data-id="change-img-box">Hi</a> 
```

然后您可以使用 .data('id') 访问数据

```
$('#thing-you-are-clicking').click( function(e) {
    var hpos = e.pageX, ypos = e.pageY;
    var id = $(this).data('id');
    // Do your stuff here...
}); 
```

# cocoa-touch - 从 UIProgressView 中删除阴影？

> ID：14967606
> 
> 赞同：0
> 
> 时间：2013-02-19T21:17:45.650
> 
> 标签：cocoa-touch, uiprogressview

我有一个带有自定义颜色的简单 UIProgressView，我想失去 Apple 阴影，可以这样做吗？

```
[[UIProgressView appearance] setProgressTintColor:[UIColor colorWithRed:5/255 green:72/255 blue:255/255 alpha:1.0]];
[[UIProgressView appearance] setTrackTintColor:[UIColor colorWithRed:0.0 green:0.0 blue:0.0 alpha:1.000]]; 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:46:38.160

不是你想的那样。你将不得不使用几个非常基本的图像。

您可以查看[这篇](https://stackoverflow.com/questions/7980891/uiprogressview-and-custom-track-and-progress-images-ios-5-properties)文章以获得一些不错的图片来获得很好的解释。但基本上你将不得不使用：

```
[[UIProgressView appearance] setProgressImage:[[UIImage imageNamed:@"ProgressImage"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 1, 0, 1)]];
[[UIProgressView appearance] setTrackImage:[[UIImage imageNamed:@"TrackImage"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 1, 0, 1)]]; 
```

使用您希望使用的任何彩色图像。如果你只想要纯色，那么只需制作一些简单的小单色块或疯狂地使用一些渐变色。

# function - 在没有 if-else / switch-case 语句的情况下控制程序流程

> ID：14967609
> 
> 赞同：3
> 
> 时间：2013-02-19T21:17:55.977
> 
> 标签：function, programming-languages, function-pointers, program-flow

假设我有 1000 个函数定义如下

```
void func dummy1(int a);
void func dummy2(int a, int aa);
void func dummy3(int a, int aa, int aaa);
.
.
.
void func dummy1000(int a, int aa, int aaa, ...); 
```

我想编写一个函数，它需要一个整数 n (n < 1000) 并根据需要调用 nth 个虚拟函数（如果是 10，则为 dummy10），并带有恰好 n 个参数（参数可以是任何整数，比如说 0）。我知道这可以通过编写一个包含 1000 个案例的 switch case 语句来实现，这是不合理的。

在我看来，如果不在运行时重新编译，这是无法实现的，所以像 java、c、c++ 这样的语言永远不会让这样的事情发生。

希望有办法做到这一点。如果是这样我很好奇。

注意：这不是我永远不会使用的东西，我只是出于好奇而提出问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T22:05:21.047

在现代函数式语言中，您可以制作一个将列表作为参数的函数列表。这可以说可以解决您的问题，但也可以说是作弊，因为它不是您的问题似乎暗示的静态类型实现。然而，当使用“手动”参数处理时，这几乎是 Python、Ruby 或 Perl 等动态语言所做的......

无论如何，以下是在 Haskell 中：它为`n`第 th 函数（从它的第一个参数）提供第二个参数（）的副本`fs`列表，并返回结果。当然，您需要以某种方式将函数列表放在一起，但与 switch 语句不同，此列表将可作为一等参数重用。`n``x`

```
selectApplyFunction :: [ [Int] -> a ] -> Int -> Int -> a
selectApplyFunction fs x n = (fs !! (n-1)) (replicate n x)

dummy1 [a] = 5 * a
dummy2 [a, b] = (a + 3) * b
dummy3 [a, b, c] = (a*b*c) / (a*b + b*c + c*a)
...
myFunctionList = [ dummy1, dummy2, dummy3, ... ]

-- (myfunction n) provides n copies of the number 42 to the n'th function
myFunction = selectApplyFunction myFunctionList 42

-- call the 666'th function with 666 copies of 42
result = myFunction 666 
```

当然，如果`n`大于函数的数量，或者如果函数无法处理给定的列表，则会出现异常。还要注意，它是糟糕的 Haskell 风格——主要是因为它滥用列表来（滥用）解决你的问题的方式......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:20:35.840

不，你不正确。大多数现代语言都支持某种形式的反射，它允许您按名称调用函数并将参数传递给它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:22:02.447

您可以使用大多数现代语言创建一系列函数。在伪代码中，

```
var dummy = new Array();
dummy[1] = function(int a);
dummy[2] = function(int a, int aa);
...

var result = dummy[whateveryoucall](1,2,3,...,whateveryoucall); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T10:53:26.290

在函数式语言中，你可以做这样的事情，在强类型语言中，比如 Haskell，函数必须具有相同的类型，但是：

```
funs = [reverse, tail, init]   -- 3 functions of type [a]->[a]

run fn arg = (funs !! fn) $ args  -- applies function at index fn to args 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-20T11:06:07.247

在面向对象的语言中，您可以一起使用[函数对象](http://en.wikipedia.org/wiki/Function_object)和反射来实现您想要的。通过将适当的 POJO（调用 C 结构）传递给函数对象来解决参数数量可变的问题。

```
interface Functor<A,B> {
    public B compute(A input);
}

class SumInput {
    private int x, y;
    // getters and setters
}

class Sum implements Functor<SumInput, Integer> {

    @Override
    public Integer compute(SumInput input) {
       return input.getX() + input.getY();
    }

} 
```

现在想象你有大量的这些“函子”。您将它们收集在一个配置文件中（可能是一个 XML 文件，其中包含有关每个仿函数、使用场景、说明等的元数据）并将列表返回给用户。
用户选择其中之一。通过使用反射，您可以看到所需的输入和预期的输出。用户填写输入，并通过使用反射实例化函子类（`newInstance()`），调用`compute()`函数并获得输出。
当你添加一个新的仿函数时，你只需要改变配置文件中的仿函数列表。

# objective-c - Objective-C 块使用强变量

> ID：14967616
> 
> 赞同：0
> 
> 时间：2013-02-19T21:18:09.243
> 
> 标签：objective-c, objective-c-blocks

我想了解哪个函数是正确的，希望有人能在 func1 和 func2 之间给我建议。

现在我用func1，有人告诉我func2有内存问题。

```
@property (nonatomic) NSDictionary *NameAndIdDictionary;
 - (void) func1 
 {
    __weak NSDictionary *NameAndIdDictionary = self.NameAndIdDictionary;
     self.Keys = [[NameAndIdDictionary allKeys] sortedArrayUsingComparator: ^NSComparisonResult(id obj1, id obj2) {
        NSString *name1 = (NSString *)NameAndIdDictionary[obj1];
        NSString *name2 = (NSString *)NameAndIdDictionary[obj2];
        return [[name1 uppercaseString] compare:[name2 uppercaseString]];
    }];
 }

 - (void) func2
 {
     self.Keys = [[self.NameAndIdDictionary allKeys] sortedArrayUsingComparator: ^NSComparisonResult(id obj1, id obj2) {
        NSString *name1 = (NSString *)self.NameAndIdDictionary[obj1];
        NSString *name2 = (NSString *)self.NameAndIdDictionary[obj2];
        return [[name1 uppercaseString] compare:[name2 uppercaseString]];
    }];
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T23:59:37.583

`func2`很好。`sortedArrayUsingComparator`不存储块供以后使用或类似的东西，因此不存在保留周期问题。

# c# - 将 json 反序列化为类（手动使用反射）

> ID：14967618
> 
> 赞同：1
> 
> 时间：2013-02-19T21:18:20.413
> 
> 标签：c#, json, reflection

我正在一个不具备使用第三方库的灵活性的平台上使用 C# 3.5 的精简版本。

虽然我可以解析 JSON（使用 json 流阅读器），但我不确定如何将它实际变成一个类。（也无法访问通常的 json 到类反序列化器）。

有谁知道如何使用反射手动（但动态地）将 JSON 字符串转换为类？

示例 Json：

`{"items":[ {"firstName":"bob", "lastName":"smith", "id":1001, "foods": [{"name":"fish", "name":"bacon", "name":"cereal"}]}, {"firstName":"sarah", "lastName":"smith", "id":1002, "foods": [{"name":"bacon", "name":"apples", "name":"chocolate"}]}, {"firstName":"tom", "lastName":"waffle", "id":1003, "foods": [{"name":"waffles", "name":"sticks", "name":"stones"}]}, {"firstName":"reginald", "lastName":"hamtuft", "id":1003, "foods": [{"name":"ham", "name":"cigars", "name":"noisy children"}]} ]}`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-05-23T16:01:17.493

感谢皮特和其他人让我走上了正确的轨道。在我的情况下，我还必须将 JSON 字符串反序列化为 SQL CLR 函数中的强类型对象，因此我受限于可以“安全”使用的库（[更多信息在这里](https://docs.microsoft.com/en-us/sql/relational-databases/clr-integration/database-objects/supported-net-framework-libraries?view=sql-server-2017)）。

我修改[了 ParseJSON 的代码](https://stackoverflow.com/a/13192508/602447)，它反序列化为 a`Dictionary<string, object>`以便能够反序列化数组的数组，这是它无法做到的，我还开发了一些方法来将生成的 Dictionary 转换为强类型对象而不使用`JavaScriptConverter`或`System.Runtime.Serialization`库，这段代码我们可以做到以下几点：

```
//we have a foo and bar classes with a variety of fields and properties
private class foo
{
    public List<double[][]> data;
    public IEnumerable<object> DataObj;
    public int integerField;
    public long longProperty { get; set; }
    public string stringValue;
    public int? nullableInt;
    public DateTime dateTimeValue;
    public List<bar> classValues;
}

private class bar
{
    public string stringValue;
    public DateTimeOffset dateTimeOffsetValue;
}

static void Main(string[] args)
{
    //lets deserialize the following JSON string into our foo object, 
    //the dictionary is optional, and not necessary if our JSON property names are the same as in our object.
    //in this case it's used to map the "jdata" property on the JSON string to the "data" property of our object,
    //in the case of the "dataObj", we are mapping to the uppercase field of our object
    string JSONstring = "{\"jdata\":[[[1526518800000,7.0],[1526518834200,7.0]],[[1526549272200,25.0],[1526549306400,25.0]]],\"dataObj\":[[[1526518800000,7.0],[1526518834200,7.0]],\"abc\",123],\"integerField\":623,\"longProperty\":456789,\"stringValue\":\"foo\",\"nullableInt\":\"\",\"dateTimeValue\":\"2018-05-17T01:00:00.0000000\", \"classValues\": [{\"stringValue\":\"test\",\"dateTimeOffsetValue\":\"2018-05-17T05:00:00.0000000\"},{\"stringValue\":\"test2\",\"dateTimeOffsetValue\":\"2018-05-17T06:00:00.0000000\"}]}";
    var mappingDict = new Dictionary<string, string>() { { "jdata", "data" }, { "dataObj", "DataObj" } };
    foo myObject = ParseJSON<foo>(JSONstring, mappingDict);
} 
```

ParseJSON 方法将 JSON 字符串和可选的 a 作为输入，`Dictionary<string, string>`并将尝试将其转换为 Type`T`字典用于将 JSON 字符串上的任何属性映射到对象的属性（例如，“jdata”/“数据”上面声明的字典）。

```
public static T ParseJSON<T>(string jsonString, Dictionary<string, string> mappingTable = null)
{
    Dictionary<string, object> jsonDictionary = ParseJSON(jsonString);
    T castedObj = CastAs<T>(jsonDictionary, mappingTable);
    return castedObj;
} 
```

以下是我修改后的JSON解析方法（可以解析数组的数组）：

```
public static Dictionary<string, object> ParseJSON(string json)
{
    int end;
    return ParseJSON(json, 0, out end);
}

private static Dictionary<string, object> ParseJSON(string json, int start, out int end)
{
    Dictionary<string, object> dict = new Dictionary<string, object>();
    bool escbegin = false;
    bool escend = false;
    bool inquotes = false;
    string key = null;
    int cend;
    StringBuilder sb = new StringBuilder();
    Dictionary<string, object> child = null;
    List<object> arraylist = null;
    Regex regex = new Regex(@"\\u([0-9a-z]{4})", RegexOptions.IgnoreCase);
    int autoKey = 0;
    int subArrayCount = 0;
    List<int> arrayIndexes = new List<int>();
    bool inSingleQuotes = false;
    bool inDoubleQuotes = false;
    for (int i = start; i < json.Length; i++)
    {
        char c = json[i];
        if (c == '\\') escbegin = !escbegin;
        if (!escbegin)
        {
            if (c == '"' && !inSingleQuotes)
            {
                inDoubleQuotes = !inDoubleQuotes;
                inquotes = !inquotes;
                if (!inquotes && arraylist != null)
                {
                    arraylist.Add(DecodeString(regex, sb.ToString()));
                    sb.Length = 0;
                }
                continue;
            }
            else if (c == '\'' && !inDoubleQuotes)
            {
                inSingleQuotes = !inSingleQuotes;
                inquotes = !inquotes;
                if (!inquotes && arraylist != null)
                {
                    arraylist.Add(DecodeString(regex, sb.ToString()));
                    sb.Length = 0;
                }
                continue;
            }
            if (!inquotes)
            {
                switch (c)
                {
                    case '{':
                        if (i != start)
                        {
                            child = ParseJSON(json, i, out cend);
                            if (arraylist != null)
                            {
                                arraylist.Add(child);
                            }
                            else
                            {
                                dict.Add(key.Trim(), child);
                                key = null;
                            }
                            i = cend;
                        }
                        continue;
                    case '}':
                        end = i;
                        if (key != null)
                        {
                            if (arraylist != null) dict.Add(key.Trim(), arraylist);
                            else dict.Add(key.Trim(), DecodeString(regex, sb.ToString().Trim()));
                        }
                        return dict;
                    case '[':
                        if (arraylist != null)
                        {
                            List<object> _tempArrayList = arraylist;
                            for (int l = 0; l < subArrayCount; l++)
                            {
                                if (l == subArrayCount - 1)
                                {
                                    _tempArrayList.Add(new List<object>());
                                }
                                else
                                {
                                    _tempArrayList = (List<object>)_tempArrayList[arrayIndexes[l]];
                                }
                            }

                            if (arrayIndexes.Count < subArrayCount)
                            {
                                arrayIndexes.Add(0);
                            }
                            subArrayCount++;
                        }
                        else
                        {
                            arraylist = new List<object>();
                            subArrayCount++;
                        }
                        continue;
                    case ']':
                        if (key == null)
                        {
                            key = "array" + autoKey.ToString();
                            autoKey++;
                        }
                        if (arraylist != null)
                        {
                            List<object> _tempArrayList = arraylist;
                            for (int l = 0; l < subArrayCount; l++)
                            {
                                if (l == subArrayCount - 1)
                                {
                                    if (sb.Length > 0)
                                    {
                                        _tempArrayList.Add(sb.ToString());
                                    }
                                    subArrayCount--;
                                    if (subArrayCount == arrayIndexes.Count)
                                    {
                                        if (arrayIndexes.Count > 0)
                                        {
                                            arrayIndexes[arrayIndexes.Count - 1]++;
                                        }
                                    }
                                    else if (subArrayCount == arrayIndexes.Count - 1)
                                    {
                                        arrayIndexes.RemoveAt(arrayIndexes.Count - 1);
                                        if (arrayIndexes.Count > 0)
                                        {
                                            arrayIndexes[arrayIndexes.Count - 1]++;
                                        }
                                    }
                                }
                                else
                                {
                                    _tempArrayList = (List<object>)_tempArrayList[arrayIndexes[l]];
                                }
                            }
                            sb.Length = 0;
                        }
                        if (subArrayCount == 0)
                        {
                            dict.Add(key.Trim(), arraylist);
                            arraylist = null;
                            key = null;
                        }
                        continue;
                    case ',':
                        if (arraylist == null && key != null)
                        {
                            dict.Add(key.Trim(), DecodeString(regex, sb.ToString().Trim()));
                            key = null;
                            sb.Length = 0;
                        }
                        if (arraylist != null && sb.Length > 0)
                        {
                            List<object> _tempArrayList = arraylist;
                            for (int l = 0; l < subArrayCount; l++)
                            {
                                if (l == subArrayCount - 1)
                                {
                                    _tempArrayList.Add(sb.ToString());
                                }
                                else
                                {
                                    _tempArrayList = (List<object>)_tempArrayList[arrayIndexes[l]];
                                }
                            }
                            sb.Length = 0;
                        }
                        continue;
                    case ':':
                        key = DecodeString(regex, sb.ToString());
                        sb.Length = 0;
                        continue;
                }
            }
        }
        sb.Append(c);
        if (escend) escbegin = false;
        if (escbegin) escend = true;
        else escend = false;
    }
    end = json.Length - 1;
    return dict; //shouldn't ever get here unless the JSON is malformed
}

private static string DecodeString(Regex regex, string str)
{
    return Regex.Unescape(regex.Replace(str, match => char.ConvertFromUtf32(Int32.Parse(match.Groups[1].Value, System.Globalization.NumberStyles.HexNumber))));
} 
```

以下方法尝试将返回的字典从前一个方法转换为强类型对象，我知道这很长，但它可以完成工作：

```
private static T CastAs<T>(Dictionary<string, object> source, Dictionary<string, string> mappingTable = null)
{
    T outputData = (T)Activator.CreateInstance(typeof(T));
    TrySet(outputData, source, mappingTable);
    return outputData;
}

private static void TrySet(object target, Dictionary<string, object> source, Dictionary<string, string> mappingTable = null)
{
    if (target == null)
    {
        throw new ArgumentNullException("target");
    }
    bool useMappingTable = mappingTable != null && mappingTable.Count > 0;
    foreach (KeyValuePair<string, object> kv in source)
    {
        string propertyName = null;
        if (useMappingTable && mappingTable.ContainsKey(kv.Key))
        {
            propertyName = mappingTable[kv.Key];
        }
        else
        {
            propertyName = kv.Key;
        }

        if (!string.IsNullOrEmpty(propertyName))
        {
            UpdateMember(target, propertyName, kv.Value, mappingTable);
        }
    }
}

private static void UpdateMember(object target, string propertyName, object value, Dictionary<string, string> mappingTable)
{
    try
    {
        FieldInfo fieldInfo = target.GetType().GetField(propertyName);

        if (fieldInfo != null)
        {
            value = ConvertTo(value, fieldInfo.FieldType, mappingTable);
            fieldInfo.SetValue(target, value);
        }
        else
        {
            PropertyInfo propInfo = target.GetType().GetProperty(propertyName);

            if (propInfo != null)
            {
                value = ConvertTo(value, propInfo.PropertyType, mappingTable);
                propInfo.SetValue(target, value);
            }
        }
    }
    catch (Exception ex)
    {
        throw ex;
    }
}

private static object ConvertTo(object value, Type targetType, Dictionary<string, string> mappingTable)
{
    try
    {
        bool isNullable = false;
        Type sourceType = value.GetType();

        //Obtain actual type to convert to (this is necessary in case of Nullable types)
        if (targetType.IsGenericType && targetType.GetGenericTypeDefinition() == typeof(Nullable<>))
        {
            isNullable = true;
            targetType = targetType.GetGenericArguments()[0];
        }

        if (isNullable && string.IsNullOrWhiteSpace(Convert.ToString(value)))
        {
            return null;
        }
        //if we are converting from a dictionary to a class, call the TrySet method to convert its members
        else if (targetType.IsClass && sourceType.IsGenericType && sourceType.GetGenericTypeDefinition() == typeof(Dictionary<,>))
        {
            //make sure our value is actually a Dictionary<string, object> in order to be able to cast
            if (sourceType.GetGenericArguments()[0] == typeof(string))
            {
                object convertedValue = Activator.CreateInstance(targetType);
                TrySet(convertedValue, (Dictionary<string, object>)value, mappingTable);
                return convertedValue;
            }
            return null;
        }
        else if (IsCollection(value))
        {
            Type elementType = GetCollectionElementType(targetType);

            if (elementType != null)
            {
                if (targetType.BaseType == typeof(Array))
                {
                    return ConvertToArray(elementType, value, mappingTable);
                }
                else
                {
                    return ConvertToList(elementType, value, mappingTable);
                }
            }
            else
            {
                throw new NullReferenceException();
            }
        }
        else if (targetType == typeof(DateTimeOffset))
        {
            return new DateTimeOffset((DateTime)ChangeType(value, typeof(DateTime)));
        }
        else if (targetType == typeof(object))
        {
            return value;
        }
        else
        {
            return ChangeType(value, targetType);
        }
    }
    catch (Exception ex)
    {
        if (targetType.IsValueType)
        {
            return Activator.CreateInstance(targetType);
        }
        return null;
    }
}

private static Array ConvertToArray(Type elementType, object value, Dictionary<string, string> mappingTable)
{
    Array collection = Array.CreateInstance(elementType, ((ICollection)value).Count);

    int i = 0;
    foreach (object item in (IEnumerable)value)
    {
        try
        {
            collection.SetValue(ConvertTo(item, elementType, mappingTable), i);
            i++;
        }
        catch (Exception ex)
        {
            //nothing here, just skip the item
        }
    }

    return collection;
}

private static IList ConvertToList(Type elementType, object value, Dictionary<string, string> mappingTable)
{
    Type listType = typeof(List<>);
    Type constructedListType = listType.MakeGenericType(elementType);
    IList collection = (IList)Activator.CreateInstance(constructedListType);

    foreach (object item in (IEnumerable)value)
    {
        try
        {
            collection.Add(ConvertTo(item, elementType, mappingTable));
        }
        catch (Exception ex)
        {
            //nothing here, just skip the item
        }
    }

    return collection;
}

private static bool IsCollection(object obj)
{
    bool isCollection = false;

    Type objType = obj.GetType();
    if (!typeof(string).IsAssignableFrom(objType) && typeof(IEnumerable).IsAssignableFrom(objType))
    {
        isCollection = true;
    }

    return isCollection;
}

private static Type GetCollectionElementType(Type objType)
{
    Type elementType;
    Type[] genericArgs = objType.GenericTypeArguments;
    if (genericArgs.Length > 0)
    {
        elementType = genericArgs[0];
    }
    else
    {
        elementType = objType.GetElementType();
    }

    return elementType;
}

private static object ChangeType(object value, Type castTo)
{
    try
    {
        return Convert.ChangeType(value, castTo);
    }
    catch (Exception ex)
    {
        //if the conversion failed, just return the original value
        return value;
    }
} 
```

我希望这对仍在寻找方法的人有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:22:06.677

好的，我正在根据反馈重做我的答案。动态对象生成器代码仍然来自这个：

[将 JSON 反序列化为 C# 动态对象？](https://stackoverflow.com/questions/3142495/deserialize-json-into-c-sharp-dynamic-object)

这使用 RegEx、Generic 集合并且它确实使用了 Linq，但仅在 2 行中，并且可以很容易地重写为不使用 Linq（末尾的两个 'result =' 行`DynamicJsonObject.TryGetMember()`）。如有必要，也可以用哈希表替换通用字典。

json 解析器改编自[How can I deserialize JSON to a simple Dictionary<string,string> in ASP.NET?](https://stackoverflow.com/questions/1207731/how-can-i-deserialize-json-to-a-simple-dictionarystring-string-in-asp-net)

```
class Program
{
    static void Main(string[] args)
    {
        string data = "{ 'test': 42, 'test2': 'test2\"', 'structure' : { 'field1': 'field1', 'field2': 44 } }";

        dynamic x = new DynamicJsonObject(JsonMaker.ParseJSON(data));
        Console.WriteLine(x.test2);
        Console.WriteLine(x.structure.field1);
        Console.ReadLine();
    }
}

public class DynamicJsonObject : DynamicObject
{
    private readonly IDictionary<string, object> _dictionary;

    public DynamicJsonObject(IDictionary<string, object> dictionary)
    {
        if (dictionary == null)
            throw new ArgumentNullException("dictionary");
        _dictionary = dictionary;
    }

    public override string ToString()
    {
        var sb = new StringBuilder();
        ToString(sb);
        return sb.ToString();
    }

    private void ToString(StringBuilder sb)
    {
        sb.Append("{");
        var firstInDictionary = true;
        foreach (var pair in _dictionary)
        {
            if (!firstInDictionary)
                sb.Append(",");
            firstInDictionary = false;
            var value = pair.Value;
            var name = pair.Key;
            if (value is string)
            {
                sb.AppendFormat("\"{0}\":\"{1}\"", name, value);
            }
            else if (value is IDictionary<string, object>)
            {
                sb.AppendFormat("\"{0}\":", name);
                new DynamicJsonObject((IDictionary<string, object>)value).ToString(sb);
            }
            else if (value is ArrayList)
            {
                sb.Append("\"");
                sb.Append(name);
                sb.Append("\":[");
                var firstInArray = true;
                foreach (var arrayValue in (ArrayList)value)
                {
                    if (!firstInArray)
                        sb.Append(",");
                    firstInArray = false;
                    if (arrayValue is IDictionary<string, object>)
                        new DynamicJsonObject((IDictionary<string, object>)arrayValue).ToString(sb);
                    else if (arrayValue is string)
                        sb.AppendFormat("\"{0}\"", arrayValue);
                    else
                        sb.AppendFormat("{0}", arrayValue);

                }
                sb.Append("]");
            }
            else
            {
                sb.AppendFormat("\"{0}\":{1}", name, value);
            }
        }
        sb.Append("}");
    }

    public override bool TryGetMember(GetMemberBinder binder, out object result)
    {
        if (!_dictionary.TryGetValue(binder.Name, out result))
        {
            // return null to avoid exception.  caller can check for null this way...
            result = null;
            return true;
        }

        var dictionary = result as IDictionary<string, object>;
        if (dictionary != null)
        {
            result = new DynamicJsonObject(dictionary);
            return true;
        }

        var arrayList = result as ArrayList;
        if (arrayList != null && arrayList.Count > 0)
        {
            if (arrayList[0] is IDictionary<string, object>)
                result = new List<object>(arrayList.Cast<IDictionary<string, object>>().Select(x => new DynamicJsonObject(x)));
            else
                result = new List<object>(arrayList.Cast<object>());
        }

        return true;
    }
}

public static class JsonMaker
{
    public static Dictionary<string, object> ParseJSON(string json)
    {
        int end;
        return ParseJSON(json, 0, out end);
    }
    private static Dictionary<string, object> ParseJSON(string json, int start, out int end)
    {
        Dictionary<string, object> dict = new Dictionary<string, object>();
        bool escbegin = false;
        bool escend = false;
        bool inquotes = false;
        string key = null;
        int cend;
        StringBuilder sb = new StringBuilder();
        Dictionary<string, object> child = null;
        List<object> arraylist = null;
        Regex regex = new Regex(@"\\u([0-9a-z]{4})", RegexOptions.IgnoreCase);
        int autoKey = 0;
        bool inSingleQuotes = false;
        bool inDoubleQuotes = false;
        for (int i = start; i < json.Length; i++)
        {
            char c = json[i];
            if (c == '\\') escbegin = !escbegin;
            if (!escbegin)
            {
                if (c == '"' && !inSingleQuotes)
                {
                    inDoubleQuotes = !inDoubleQuotes;
                    inquotes = !inquotes;
                    if (!inquotes && arraylist != null)
                    {
                        arraylist.Add(DecodeString(regex, sb.ToString()));
                        sb.Length = 0;
                    }
                    continue;
                }
                else if (c == '\'' && !inDoubleQuotes)
                {
                    inSingleQuotes = !inSingleQuotes;
                    inquotes = !inquotes;
                    if (!inquotes && arraylist != null)
                    {
                        arraylist.Add(DecodeString(regex, sb.ToString()));
                        sb.Length = 0;
                    }
                    continue;
                }
                if (!inquotes)
                {
                    switch (c)
                    {
                        case '{':
                            if (i != start)
                            {
                                child = ParseJSON(json, i, out cend);
                                if (arraylist != null) arraylist.Add(child);
                                else
                                {
                                    dict.Add(key.Trim(), child);
                                    key = null;
                                }
                                i = cend;
                            }
                            continue;
                        case '}':
                            end = i;
                            if (key != null)
                            {
                                if (arraylist != null) dict.Add(key.Trim(), arraylist);
                                else dict.Add(key.Trim(), DecodeString(regex, sb.ToString().Trim()));
                            }
                            return dict;
                        case '[':
                            arraylist = new List<object>();
                            continue;
                        case ']':
                            if (key == null)
                            {
                                key = "array" + autoKey.ToString();
                                autoKey++;
                            }
                            if (arraylist != null && sb.Length > 0)
                            {
                                arraylist.Add(sb.ToString());
                                sb.Length = 0;
                            }
                            dict.Add(key.Trim(), arraylist);
                            arraylist = null;
                            key = null;
                            continue;
                        case ',':
                            if (arraylist == null && key != null)
                            {
                                dict.Add(key.Trim(), DecodeString(regex, sb.ToString().Trim()));
                                key = null;
                                sb.Length = 0;
                            }
                            if (arraylist != null && sb.Length > 0)
                            {
                                arraylist.Add(sb.ToString());
                                sb.Length = 0;
                            }
                            continue;
                        case ':':
                            key = DecodeString(regex, sb.ToString());
                            sb.Length = 0;
                            continue;
                    }
                }
            }
            sb.Append(c);
            if (escend) escbegin = false;
            if (escbegin) escend = true;
            else escend = false;
        }
        end = json.Length - 1;
        return dict; //theoretically shouldn't ever get here
    }

    private static string DecodeString(Regex regex, string str)
    {
        return Regex.Unescape(regex.Replace(str, match => char.ConvertFromUtf32(Int32.Parse(match.Groups[1].Value, System.Globalization.NumberStyles.HexNumber))));
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-10T07:50:22.883

再次感谢皮特和其他人的精彩帖子。我用一个 SQL Server CLR 标量函数包装了我的，它在查询存储在关系表中的 JSON 时非常有用（我知道有些人会说只使用 MongoDB！）。

请看下面：

```
 public class JsonHelper
{
    /// <summary>
    /// Parses the JSON.
    /// Thanks to http://stackoverflow.com/questions/14967618/deserialize-json-to-class-manually-with-reflection
    /// </summary>
    /// <param name="json">The json.</param>
    /// <returns></returns>
    public static Dictionary<string, object> DeserializeJson(string json)
    {
        int end;

        return DeserializeJson(json, 0, out end);
    }

    /// <summary>
    /// Parses the JSON.
    /// </summary>
    /// <param name="json">The json.</param>
    /// <param name="start">The start.</param>
    /// <param name="end">The end.</param>
    /// <returns></returns>
    private static Dictionary<string, object> DeserializeJson(string json, int start, out int end)
    {
        var dict = new Dictionary<string, object>();
        var escbegin = false;
        var escend = false;
        var inquotes = false;
        string key = null;
        var sb = new StringBuilder();
        List<object> arraylist = null;
        var regex = new Regex(@"\\u([0-9a-z]{4})", RegexOptions.IgnoreCase);
        var autoKey = 0;
        var inSingleQuotes = false;
        var inDoubleQuotes = false;

        for (var i = start; i < json.Length; i++)
        {
            var c = json[i];
            if (c == '\\') escbegin = !escbegin;
            if (!escbegin)
            {
                if (c == '"' && !inSingleQuotes)
                {
                    inDoubleQuotes = !inDoubleQuotes;
                    inquotes = !inquotes;
                    if (!inquotes && arraylist != null)
                    {
                        arraylist.Add(DecodeString(regex, sb.ToString()));
                        sb.Length = 0;
                    }

                    continue;
                }

                if (c == '\'' && !inDoubleQuotes)
                {
                    inSingleQuotes = !inSingleQuotes;
                    inquotes = !inquotes;
                    if (!inquotes && arraylist != null)
                    {
                        arraylist.Add(DecodeString(regex, sb.ToString()));
                        sb.Length = 0;
                    }

                    continue;
                }

                if (!inquotes)
                {
                    switch (c)
                    {
                        case '{':
                            if (i != start)
                            {
                                int cend;
                                var child = DeserializeJson(json, i, out cend);
                                if (arraylist != null)
                                {
                                    arraylist.Add(child);
                                }
                                else
                                {
                                    dict.Add(key.Trim(), child);
                                    key = null;
                                }

                                i = cend;
                            }

                            continue;

                        case '}':
                            end = i;

                            if (key != null)
                            {
                                if (arraylist != null) dict.Add(key.Trim(), arraylist);
                                else dict.Add(key.Trim(), DecodeString(regex, sb.ToString().Trim()));
                            }

                            return dict;

                        case '[':
                            arraylist = new List<object>();
                            continue;

                        case ']':
                            if (key == null)
                            {
                                key = "array" + autoKey;
                                autoKey++;
                            }

                            if (arraylist != null && sb.Length > 0)
                            {
                                arraylist.Add(sb.ToString());
                                sb.Length = 0;
                            }

                            dict.Add(key.Trim(), arraylist);
                            arraylist = null;
                            key = null;
                            continue;

                        case ',':
                            if (arraylist == null && key != null)
                            {
                                dict.Add(key.Trim(), DecodeString(regex, sb.ToString().Trim()));
                                key = null;
                                sb.Length = 0;
                            }

                            if (arraylist != null && sb.Length > 0)
                            {
                                arraylist.Add(sb.ToString());
                                sb.Length = 0;
                            }

                            continue;

                        case ':':
                            key = DecodeString(regex, sb.ToString());
                            sb.Length = 0;

                            continue;
                    }
                }
            }

            sb.Append(c);

            if (escend) escbegin = false;
            escend = escbegin;
        }

        end = json.Length - 1;
        return dict; // theoretically shouldn't ever get here
    }

    /// <summary>
    /// Decodes the string.
    /// </summary>
    /// <param name="regex">The regex.</param>
    /// <param name="str">The STR.</param>
    /// <returns></returns>
    private static string DecodeString(Regex regex, string str)
    {
        return
            Regex.Unescape(regex.Replace(str,
                match =>
                    char.ConvertFromUtf32(Int32.Parse(match.Groups[1].Value,
                        System.Globalization.NumberStyles
                            .HexNumber))));
    }

    /// <summary>
    /// Returns true if string has an "appearance" of being JSON-like
    /// </summary>
    /// <param name="input"></param>
    /// <returns></returns>
    public static bool IsJson(string input)
    {
        input = input.Trim();
        return input.StartsWith("{") && input.EndsWith("}")
               || input.StartsWith("[") && input.EndsWith("]");
    }
} 
```

CLR 函数如下：

```
/// <summary>
/// Json "extractor" capable of extracting a value of a key using the object notation.
/// </summary>
/// <param name="json"></param>
/// <param name="key"></param>
/// <returns></returns>
[Microsoft.SqlServer.Server.SqlFunction]
public static SqlString fn_GetKeyValue(SqlString json, SqlString key)
{
    var jsonString = json.ToString();

    // Return if N/A
    if (string.IsNullOrEmpty(jsonString) || !JsonHelper.IsJson(jsonString))
    {
        return json;
    }

    var keyString = key.ToString();

    var jsonDictionary = JsonHelper.DeserializeJson(jsonString);
    var lastNode = string.Empty;

    foreach (var node in keyString.Split('.'))
    {
        if (!jsonDictionary.ContainsKey(node)) continue;

        var childDictionary = jsonDictionary[node] as Dictionary<string, object>;

        if (childDictionary != null)
        {
            jsonDictionary = childDictionary;
        }

        lastNode = node;
    }

    if (!jsonDictionary.ContainsKey(lastNode))
    {
        return null;
    }

    var keyValueString = jsonDictionary[lastNode].ToString();

    return keyValueString == "null" ? null : new SqlString(keyValueString);
} 
```

用法是：

```
-- Example 1 (querying a parent node)
SELECT  dbo.fn_GetKeyValue('{
    "ExchangeRates": {
        "GBP": "1.2",
        "USD": "2.0"
    },
    "Timestamp": "2015-04-10"
}', 'Timestamp');

-- Example 2 (querying a child node using a dot notation)
SELECT  dbo.fn_GetKeyValue('{
    "ExchangeRates": {
        "GBP": "1.2",
        "USD": "2.0"
    },
    "Timestamp": "2015-04-10"
}', 'ExchangeRates.GBP'); 
```

# ruby-on-rails - 在 Rails 应用程序中发送自动邮件

> ID：14967620
> 
> 赞同：4
> 
> 时间：2013-02-19T21:18:28.690
> 
> 标签：ruby-on-rails, email, cron

在我的 rails 应用程序中，用户可以订阅一些事件。我想在活动开始前 24 小时向用户发送邮件。

我不确定如何实现。耙子任务？是否有一些宝石或一些最佳实践可以遵循？

谢谢！

编辑：

我想我的 cron 必须每分钟运行一次才能让每个事件在 24 小时内开始。但是如果 cron 停止，或者需要超过一分钟，我就不能跳过一些电子邮件。另一方面，我怎么能确定我不会两次发送相同的电子邮件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T21:22:30.557

查看：

[http://railscasts.com/episodes/206-action-mailer-in-rails-3](http://railscasts.com/episodes/206-action-mailer-in-rails-3)

用于发送邮件和

[http://railscasts.com/episodes/164-cron-in-ruby-revised](http://railscasts.com/episodes/164-cron-in-ruby-revised)

用于随时设置 cron 来调用您的邮件程序

编辑：刚刚看到你的评论。在那种情况下，我会考虑使用类似 resque-scheduler 或与 sidekiq 等效的东西：

[https://github.com/bvandenbos/resque-scheduler](https://github.com/bvandenbos/resque-scheduler)

然后你可以做这样的事情：

```
Resque.enqueue_at(24.hours.from_now, SendFollowUpEmail, :user_id => current_user.id) 
```

sidekiq 示例：

```
FollowUpEmailer.perform_in(24.hours.from_now, current_user.id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T07:47:31.107

[https://github.com/mperham/sidekiq/pull/257](https://github.com/mperham/sidekiq/pull/257)

这将帮助您在预定时间内解决自动邮寄系统！

# git - 致命：远端意外挂断

> ID：14967621
> 
> 赞同：2
> 
> 时间：2013-02-19T21:18:31.783
> 
> 标签：git, github

我正在完成[“试用 Git”](http://try.github.com)教程。

当我到达“1.11 远程推送”一章时，尝试运行：

```
$ git push -u orgin master 
```

我收到此错误：

```
Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:20:14.240

您可能尚未向 SSH 密钥添加公共密钥。去做：

```
$ ssh-keygen -t rsa 
```

将创建的公钥 ( `id_rsa.pub`) 复制到您帐户的[SSH 密钥列表中](https://github.com/settings/ssh)，然后再次尝试推送。

* * *

请参阅相关帮助页面：[生成 SSH 密钥](https://help.github.com/articles/generating-ssh-keys)以获得更深入的响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-06T01:30:52.353

您可以使用以下命令获取默认帐户的密钥。

```
$ ssh-keygen -t rsa 
```

更多信息：[不同 github 帐户的多个 SSH 密钥设置](https://gist.github.com/jexchan/2351996)

# jsf - JSF csv 下载

> ID：14967624
> 
> 赞同：0
> 
> 时间：2013-02-19T21:18:41.673
> 
> 标签：jsf, csv, backing-beans

使用 JSF1.2，我在页面上有一组复选框，用户将检查这些复选框以指定他们希望在 csv 文件中返回的数据。单击提交按钮时，我想获取复选框值并使用它们来查询数据库并仅在 csv 文件中返回这些值。最好的选择是什么？

使用 commandExButton 调用支持 bean 并设置值并生成 csv，但是如何将响应返回给浏览器？

使用 outputLink 调用另一个将生成响应的 servlet，但是如何将复选框参数传递给 servlet？

如果我使用 commandLink 调用 servlet，它将使用 doPost，但我如何执行导航规则以不转到其他页面？

非常感谢

# jquery - 响应式 jquery 验证问题

> ID：14967636
> 
> 赞同：0
> 
> 时间：2013-02-19T21:19:07.690
> 
> 标签：jquery, jquery-validate

我正在构建一个响应式表单并使用 css 媒体查询来根据屏幕宽度更新布局。

在桌面视图和移动和平板电脑视图之间，表单的设计发生了变化，标签元素位于桌面宽度的输入字段顶部，但当屏幕缩小到移动宽度时，它成为默认输入字段值。

我正在运行以下函数将标签中的文本作为输入字段的值：HTML：

```
 <div class="sectionHeader" id="updateDetails">My details <span class="sectionEdit">Edit</span></div>
        <div class="sectionWrapper" id="myDetails">
            <div class="formSection clearfix">
                <fieldset>
                    <legend>Personal</legend>
                        <div class="ctrlHolder">
                            <div class="ctrlHolder">
                                <label class="hiddenLabel" for="givenName">Given name</label>
                                <input name="givenName" id="givenName" type="text" class="text long required"/>
                            </div>
                            <div class="ctrlHolder">
                                <label class="hiddenLabel" for="familyName">Family name</label>
                                <input name="familyName" id="familyName" type="text" class="text long required"/>
                            </div>
                        </div>
                </fieldset>
            </div>
        </div>
<div class="formSectionFooter clearfix">
    <input data-target="myInvestment" class="sectionNavigator button secondary" id="sectionDetailsNext" name="sectionDetailsNext" type="button" value="Continue"/>
            </div>

$('#details .formSection fieldset .ctrlHolder label').each(function(){
   //console.log($(this).text());
   $(this).addClass('hiddenLabel');
   $(this).next('input').val($(this).text());
});
} 
```

这对我的客户端验证造成严重破坏，因为正在测试字段是否为空，并且它们已满并且默认值错误。除其他外，验证检查空字段或默认值（例如“选择”、“名字”等）

```
$('.sectionNavigator').click(function(event){
    //$(this).closest('.formSection').validate();
    validateMy.form();
    event.preventDefault();

    // check for any empty fields in the preceding section
var $thisFormSection = $(this).closest('.formSection');
var $elementsWithErros = $thisFormSection.find('input[value=""]:visible, input[class="error"]:visible, select[value="Day"]:visible, select[value="Month"]:visible, select[value="Year"]:visible, select[value="Select"]:visible, select[value="Please select"]:visible, select[value="Given name"]:visible, select[value="Family name"]:visible');
var target = $(this).attr('data-target'); 
```

有人对如何解决这个问题有任何建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:33:50.267

因此，基本上，如果该字段具有默认值并且未被用户编辑，则基本上您希望该字段被视为“空”。

首先，您可以使用`placeholder`属性而不是设置`val`. 现在[大多数移动浏览器都支持](http://caniuse.com/input-placeholder)它，并且不应该反对您的验证。对于不受支持的情况——如果你打算走这条路，请确保你只[在不受支持的浏览器中](http://davidwalsh.name/html5-placeholder)执行此操作——你可以跟踪哪些字段已被编辑。在执行验证时，如果某个字段*已*被编辑并且是默认值，那么这是一个错误。否则你可以假设它是空的。

只想说，我认为验证（'无默认值'）是不必要的，特别是因为您正在谈论移动设备并且执行此逻辑的额外成本可能只是不值得。

# css - 位置：仅在高度上固定

> ID：14967641
> 
> 赞同：0
> 
> 时间：2013-02-19T21:19:24.600
> 
> 标签：css, css-position

我正在处理这个页面：http: [//jsfiddle.net/Saturnix/4RzyG/embedded/result/](http://jsfiddle.net/Saturnix/4RzyG/embedded/result/)

代码在这里：http: [//jsfiddle.net/Saturnix/4RzyG/](http://jsfiddle.net/Saturnix/4RzyG/)

它在 Safari/Firefox/Chrome 和其他不错的浏览器中运行良好。但是，当使用 Safari Mobile 打开它并捏合（放大）时，会发生一些奇怪的事情。

如您所见，文本在页面底部逐渐消失：这是由于在中央 div 底部应用了具有透明度的 png 图像。它们都占用相同的空间并处理窗口大小调整，但不能处理 Safari Mobile 缩放。

如果您阅读代码，这是有道理的：底部渐变（png 图像）用于`position: fixed`始终保持在页面的中心，但是一旦您使用 Safari Mobile “捏合”，它将始终保持在中心。

我希望仅针对元素的高度固定位置（否则在滚动 png 图像时会从底部分离），而不是宽度。这可能吗？您将如何更改代码以使其在 iO 上运行？

这是通过放置 png 图像来控制文本淡出的 css 代码

```
.bottom_fade_center {
            position: fixed;
            bottom: 0;

            width: 80%;
            left: 10%;

            background: url("bottom-fade.png");
            background-repeat:repeat-x;
            height: 400px;
            pointer-events:none;
            z-index: 3;

            } 
```

提前致谢！

![在此处输入图像描述](../Images/cb4d48946d717eababc8eabdd1286e01.png)

# ios - TableView 添加一个自动更改的新标签

> ID：14967643
> 
> 赞同：-2
> 
> 时间：2013-02-19T21:19:34.450
> 
> 标签：ios, automation, label, tableview

好的，最近 Darren 帮助我解决了我的 tableview 数据没有显示的问题。我将在此处留下我将要参考的文件。

[下载文件 (3.12mb)](http://www.mediafire.com/?0wpabao3ij3xklo)

在情节提要中，最后有 3 个对象，其中 2 个根据在 tableView 上选择的项目自动更改。我想添加另一个标签（已经在项目中）并设置它，以便根据在表格视图中选择的项目，此处会显示一些信息。就像其他2一样。

我怎样才能做到这一点？

* * *

对于那些不信任下载文件的人，我得到了一些可能有帮助的代码。我希望在带有标签#3 的标签中显示“myData2”。我怎样才能做到这一点？

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    // Define our test data
    myData = [NSMutableArray arrayWithObjects:
              @"Chasing Amy", 
              @"Mallrats", 
              @"Dogma", 
              @"Clerks", 
              @"Jay & Silent Bob Strike Back",
              @"Red State",
              @"Cop Out",
              @"Jersey Girl",
              nil];

    //test for 2nd data
    myData2 = [NSMutableArray arrayWithObjects:
              @"Info for Chasing Amy item",
              @"Info for Mallrats",
              @"Info for Dogma",
              @"Info for Clerks",
              @"Info for Jay & Silent Bob Strike Back",
              @"Info for Red State",
              @"Info for Cop Out",
              @"Info for Jersey Girl",
              nil];
}

// Return number of sections in table (always 1 for this demo!)
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

// Return the amount of items in our table (the total items in our array above)
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [myData count];
    return [myData2 count];
}

// Return a cell for the table
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    // A cell identifier which matches our identifier in IB
    static NSString *CellIdentifier = @"CellIdentifier";

    // Create or reuse a cell
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    // Get the cell label using it's tag and set it
    UILabel *cellLabel = (UILabel *)[cell viewWithTag:1];
    [cellLabel setText:[myData objectAtIndex:indexPath.row]];

    // get the cell imageview using it's tag and set it
    UIImageView *cellImage = (UIImageView *)[cell viewWithTag:2];
    [cellImage setImage:[UIImage imageNamed:[NSString stringWithFormat:@"%d.jpg", indexPath.row]]];

    return cell;
}

// Do some customisation of our new view when a table item has been selected
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    // Make sure we're referring to the correct segue
    if ([[segue identifier] isEqualToString:@"ShowSelectedMovie"]) {

        // Get reference to the destination view controller
        Tab2_ItemViewController *vc = [segue destinationViewController];

        // get the selected index
        NSInteger selectedIndex = [[self.tableView indexPathForSelectedRow] row];

        // Pass the name and index of our film
        [vc setSelectedItem:[NSString stringWithFormat:@"%@", [myData objectAtIndex:selectedIndex]]];
        [vc setSelectedIndex:selectedIndex];

        //
        [vc setSelectedItem:[NSString stringWithFormat:@"%@", [myData2 objectAtIndex:selectedIndex]]];
        [vc setSelectedIndex:selectedIndex];
    }
}

@end 
```

* * *

现在我得到一个断点：

[下载文件 (3.12mb)](http://www.mediafire.com/?415fwprd58pwf70)

```
#import "Tab2_TableViewController.h"
#import "Tab2_ItemViewController.h"

@implementation Tab2_TableViewController

// When the view loads, define our data
- (void)viewDidLoad
{
    [super viewDidLoad];

    // Define our test data
    myData = [NSMutableArray arrayWithObjects:
              @"Chasing Amy",
              @"Mallrats",
              @"Dogma",
              @"Clerks",
              @"Jay &amp; Silent Bob Strike Back",
              @"Red State",
              @"Cop Out",
              @"Jersey Girl",
              nil];

    // Define our test data2
    myData2 = [NSMutableArray arrayWithObjects:
              @"info Chasing Amy",
              @"info Mallrats",
              @"info Dogma",
              @"info Clerks",
              @"info Jay &amp; Silent Bob Strike Back",
              @"info Red State",
              @"info Cop Out",
              @"info Jersey Girl",
              nil];
}

// Return the amount of items in our table (the total items in our array above)
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [myData count];
    return [myData2 count];
}

// Return number of sections in table (always 1 for this demo!)
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

// Return a cell for the table
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    // A cell identifier which matches our identifier in IB
    static NSString *CellIdentifier = @"CellIdentifier";

    // Create or reuse a cell
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    // Get the cell label using its tag and set it
    UILabel *cellLabel = (UILabel *)[cell viewWithTag:1];
    [cellLabel setText:[myData objectAtIndex:indexPath.row]];

    // Get the cell label2 using its tag and set it
    UILabel *cellLabelInfo = (UILabel *)[cell viewWithTag:3];
    [cellLabelInfo setText:[myData2 objectAtIndex:indexPath.row]];

    // get the cell imageview using its tag and set it
    UIImageView *cellImage = (UIImageView *)[cell viewWithTag:2];
    [cellImage setImage:[UIImage imageNamed:[NSString stringWithFormat:@"%d.jpg", indexPath.row]]];

    return cell;
}

// Do some customisation of our new view when a table item has been selected
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    // Make sure we're referring to the correct segue
    if ([[segue identifier] isEqualToString:@"ShowSelectedMovie"]) {

        // Get reference to the destination view controller
        Tab2_ItemViewController *vc = [segue destinationViewController];

        // get the selected index
        NSInteger selectedIndex = [[self.tableView indexPathForSelectedRow] row];

        // Pass the name and index of our film
        [vc setSelectedItem:[NSString stringWithFormat:@"%@", [myData objectAtIndex:selectedIndex]]];
        [vc setSelectedIndex:selectedIndex];
        [vc setSelectedItemInfo:[NSString stringWithFormat:@"%@", [myData2 objectAtIndex:selectedIndex]]];
    }
}

@end 
```

断点在最少行“[vc setSelectedItemInfo:[NSString stringWithFormat:@"%@", [myData2 objectAtIndex:selectedIndex]]];"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T05:32:56.867

您需要在 Tab2_ItemViewController 中创建一个新属性（而不是 selectedItem，使用 selectedItemInfo）。您还需要一个连接到要更新的标签的新 IBOutlet。然后在使用中传递数据：

```
[vc setSelectedItemInfo:[NSString stringWithFormat:@"%@", [myData2 objectAtIndex:selectedIndex]]]; 
```

这与您为您拥有的其他标签传递数据的方式完全相似。

* * *

我从您的链接下载了代码，但对我来说并没有崩溃。它正确设置了您创建的新属性。outputLabelInfo UILabel 的 IBOutlet 并没有连接到情节提要。你需要把它挂起来。然后，您需要通过更改来修复此标签中文本的设置方式：

```
 [outputLabel setText:selectedItemInfo]; 
```

到

```
[outputLabelInfo setText:selectedItemInfo]; 
```

在 Tab2_ItemViewController.m 代码中。尝试这样做，清理您的项目并再次运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T06:10:29.767

顺便说一句，看看你的`cellForRowAtIndexPath`，你这里有一些奇怪的结构。

如果您没有使用单元原型，而是使用自己的控件，则必须在创建单元时创建它们，例如：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    // A cell identifier which matches our identifier in IB
    static NSString *CellIdentifier = @"CellIdentifier";

    // Create or reuse a cell
    UILabel *cellLabel;
    UILabel *cellLabelInfo;
    UIImageView *cellImage;

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
        cellLabel = [[UILabel alloc] init...];
        cellLabel.tag = 1;
        cellLabelInfo = [[UILabel alloc] init...];
        cellLabelInfo.tag = 3; 
        cellImage = [[UIImageView alloc] init...];
        cellImage.tag = 2;
    }
    else
    {
        cellLabel = (UILabel *)[cell viewWithTag:1];
        cellLabelInfo = (UILabel *)[cell viewWithTag:3];
        cellImage = (UIImageView *)[cell viewWithTag:2];
    }

    // Get the cell label using its tag and set it
    [cellLabel setText:[myData objectAtIndex:indexPath.row]];

    // Get the cell label2 using its tag and set it
    [cellLabelInfo setText:[myData2 objectAtIndex:indexPath.row]];

    // get the cell imageview using its tag and set it
    [cellImage setImage:[UIImage imageNamed:[NSString stringWithFormat:@"%d.jpg", indexPath.row]]];

    return cell;
} 
```

我将把如何以编程方式创建这三个控件的细节留给您自己决定，但希望您能明白这一点。您在创建单元格时创建任何自定义控件（并设置它们各自的`tag`属性），如果您成功地使单元格出列，则只需获取这些子视图的引用即可。

老实说，如果你只是处理图像、标题和副标题，我会倾向于使用标准`UITableViewCell`样式并使用它的`textLabel`,`detailTextLabel`和`imageView`属性，而不是对单元格进行任何自定义。如果我确实执行了自定义，我会使用单元原型和自定义子类，这样就无需手动创建控件和/或使用`viewWithTag`.

# c# - WCF 服务依赖项

> ID：14967644
> 
> 赞同：3
> 
> 时间：2013-02-19T21:19:37.717
> 
> 标签：c#, wcf, soa

我分别有三个 wcf 服务 A、B 和 C，因为我希望它是 SOA（面向服务的体系结构），我的设置工作方式是当我从客户端向服务器发送请求时。

1.  所有服务都是自托管的 Windows 服务。
2.  **客户端向服务 A**发送请求（客户端不知道其他服务 B 和 C）；
3.  服务 A 最终将该请求发送到服务 B 和服务 C。
4.  服务 B 和 C 将响应发送回服务 A，该响应将由服务 A 发送回客户端。

**我面临的问题**：如果我对服务 B 的代码进行任何更改并重建并重新启动服务，我在获取响应时遇到问题，但是当我重新启动所有剩余的服务时它工作正常。

换句话说，我的客户不会得到响应，除非我重新启动所有服务（A、B 和 C），即使我只更改了一个服务中的代码并重新构建它。我知道如果我重新启动所有服务，事情就会起作用三个服务，但我想知道这是我设计方式中的问题，还是我必须处理自托管的 Windows 服务。所有服务（A、B、C）都是独立的，因为没有一个相互依赖。

有人曾在 SOA 中看到过这样的事情吗？如果有人能指导我找到适当的解决方案，我会很高兴吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T13:31:36.217

1.  用任何类型的队列替换服务之间的 WCF（一个服务发布某些内容，另一个可以在它们准备好时读取）。可以是任何东西。可以是一个简单的表格，如果有新内容，您可以从中读取。可以是 RabbitMQ、NServiceBus 等，任何适合你的。

2.  定义放入队列的消息：命令和事件。两者都是具有属性的简单类，没有逻辑。命令代表系统被要求执行的操作（RegisterUser、PlaceOrder 等），事件代表系统已完成的操作（UserRegistered、OrderApproved、PaymentReceived 等）。*动作*要明确，不要做类似“我已经更改了客户端上用户的所有属性，现在我调用 SaveUser(user)”之类的事情。*您的服务*应该知道*如何*更改对象，客户端应该只命令做*什么*。

3.  永远不要破坏你的合同。这很简单，比听起来更容易：您可以*将*内容添加到您的消息合同中，但不能删除。换句话说，你只是保持你的合约向后兼容。

现在你有了一个更好的设计：服务只通过队列中的消息进行通信，消息是向后兼容的。这意味着您可以随时停止任何服务而不会影响其他服务：它们将继续将消息发送到队列中，并且当停止的服务再次返回时，它将赶上处理队列中的所有内容。

然后，如果您愿意，您可以对客户端交互使用相同的方法：如果客户端不调用 WCF，而只是将它们的*命令*放在某种队列中，那么服务升级或其他停机时间不会影响用户体验。

示例：如果我使用 WCF 下订单或将商品放入购物卡，那么如果出现问题或服务因维护而停止，我将无法执行此操作。我会单击一个按钮并遇到一个令人讨厌的错误。更重要的是我的订单不会进入系统。相反，如果中间有队列，我只将我的命令放入队列中。现在，即使我的服务目前处于关闭状态，或者遇到高负载（因此很慢），我的用户体验仍然是相同的并且不会降低。只是我的命令稍后会处理，但作为客户我并不在意。在这种情况下，我的订单不会丢失。系统变得容错和自平衡。

如果您只是将队列放在中间而不是遇到 WCF 带来的空间和时间耦合问题，那么您可以做各种奇妙的技巧 :) 而我所描述的只是开始...... :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T05:57:25.393

您可能需要考虑使用服务总线（例如[NServiceBus）](http://www.nservicebus.com)来帮助您完成功能。

它将帮助您解决的第一个问题是通过发布/订阅消息模式解耦您的服务。与其在一个或另一个服务中调用 Web 服务，不如发布事件以在发生某些事情时通知相应的服务。在您的情况下，这看起来像这样：

1.  客户端调用服务 A 中的 Web 服务。
2.  服务 A 发布消息“收到客户端命令”，服务 B 和 C 订阅该消息。
3.  服务 B 和 C 处理此事件，然后发布自己的事件。
4.  服务 A 订阅事件并回复客户端。

使用 NServiceBus 的第一个和直接的好处是可靠性。最重要的是，您可以轻松地对消息进行版本控制，而不会影响您的客户或您各自的服务。NServiceBus 具有完整的 WCF 集成，因此您的客户端可以像以前一样继续向您的服务发送消息。

使您的场景有趣的一件事是您无法保证服务 B 和 C 何时将其响应发送回您。在服务收到他们的响应之前，您是否保持与客户端的连接打开？在向客户端发送其响应之前，您是否需要两个响应？如果其中一项或一项服务崩溃会发生什么？如果在服务 A 收到响应之前您可以等待多长时间有时间限制怎么办？所有这些问题以及更多问题都可以通过 NServiceBus 中称为 Sagas 的功能来回答。一探究竟。

如果无法使用 NServiceBus，那么事情就会变得更加困难。WCF 不支持开箱即用的发布/订阅，因此您必须自己烘焙。至少我会建议使用它来解耦您的服务。如何管理服务中的状态和时间耦合是另一回事。为自己省去麻烦。

还有其他框架，但如果您想要以开发人员为中心、经济高效的方式来创建基于 .NET 的解决方案，那么建议使用 NServiceBus。

# r - !is.na 在其他列中创建 NA

> ID：14967645
> 
> 赞同：1
> 
> 时间：2013-02-19T21:19:40.533
> 
> 标签：r, dataframe, na

在合并几个数据集的过程中，我试图删除一个数据帧中对于一个特定变量具有缺失值的所有行（我想暂时将 NA 保留在其他一些列中）。我使用了以下行：

```
data.frame <- data.frame[!is.na(data.frame$year),] 
```

这成功地删除了所有具有 NA 的行`year`（并且没有其他行），但是以前有数据的其他列现在完全是 NA。换句话说，非缺失值正在转换为 NA。关于这里发生了什么的任何想法？我尝试了这些替代方案并得到了相同的结果：

```
data.frame <- subset(data.frame, !is.na(year))

data.frame$x <- ifelse(is.na(data.frame$year) == T, 1, 0);
data.frame <- subset(data.frame, x == 0) 
```

我使用`is.na`不正确吗？`is.na`在这种情况下有其他选择吗？任何帮助将不胜感激！

***编辑***这里是应该重现问题的代码：

```
#data
tc <- read.csv("http://dl.dropbox.com/u/4115584/tc2008.csv")
frame <- read.csv("http://dl.dropbox.com/u/4115584/frame.csv")

#standardize NA codes
tc[tc == "."] <- NA
tc[tc == -9] <- NA

#standardize spatial units
colnames(frame)[1] <- "loser"
colnames(frame)[2] <- "gainer"
frame$dyad <- paste(frame$loser,frame$gainer,sep="")
tc$dyad <- paste(tc$loser,tc$gainer,sep="")
drops <- c("loser","gainer")
tc <- tc[,!names(tc) %in% drops]
frame <- frame[,!names(frame) %in% drops]
rm(drops)

#merge tc into frame
data <- merge(tc, frame, by.x = "year", by.y = "dyad", all.x=T, all.y=T) #year column is duplicated in       this process. I haven't had this problem with nearly identical code using other data.

rm(tc,frame)

#the first column in the new data frame is the duplicate year, which does not actually contain years.   I'll rename it.
colnames(data)[1] <- "double"

summary(data$year) #shows 833 NA's

summary(data$procedur) #note that at this point there are non-NA values

#later, I want to create 20 year windows following the events in the tc data. For simplicity, I want to remove cases with NA in the year column.

new.data <- data[!is.na(data$year),]

#now let's see what the above operation did
summary(new.data$year) #missing years were successfully removed
summary(new.data$procedur) #this variable is now entirely NA's 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:29:31.313

我认为实际问题出在您的`merge`.

合并并将数据放入 后`data`，如果您这样做：

```
# > table(data$procedur, useNA="always")

#   1      2      3      4      5      6   <NA> 
# 122    112    356     59     39     19 192258 
```

您会看到 有许多 ( `122+112...+19`) 值`data$procedur`。但是，所有这些值都对应于`data$year = NA`。

```
> all(is.na(data$year[!is.na(data$procedur)]))
# [1] TRUE # every value of procedur occurs where year = NA 
```

所以，基本上，所有的值`procedur`也被删除了，因为你删除了那些检查`NA`in的行`year`。

为了解决这个问题，我认为你应该使用`merge`：

```
merge(tc, frame, all=T) # it'll automatically calculate common columns
# also this will not result in duplicated year column. 
```

检查此合并是否为您提供所需的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:52:13.000

尝试`complete.cases`：

```
data.frame.clean <- data.frame[complete.cases(data.frame$year),] 
```

...不过，如上所述，您可能想要选择一个更具描述性的名称。

# javascript - 使用 base64 对图像进行编码/解码会破坏图像

> ID：14967647
> 
> 赞同：8
> 
> 时间：2013-02-19T21:19:46.413
> 
> 标签：javascript, fileapi

我正在尝试对图像进行编码和解码。我正在使用 FileReader 的 readAsDataURL 方法将图像转换为 base64。然后将其转换回来，我尝试使用 `readAsBinaryString()`但`atob()`没有运气。是否有另一种方法可以在没有 base64 编码的情况下保留图像？

> **readAsBinaryString()**
> 
> 开始读取指定 Blob 的内容，该 Blob 可能是一个文件。当读取操作完成时，readyState 将变为 DONE，并且将调用 onloadend 回调（如果有）。那时，结果属性包含文件中的原始二进制数据。

知道我在这里做错了什么吗？

**示例代码** [http://jsfiddle.net/qL86Z/3/](http://jsfiddle.net/qL86Z/3/)

```
$("#base64Button").on("click", function () {
    var file = $("#base64File")[0].files[0]
    var reader = new FileReader();

    // callback for readAsDataURL
    reader.onload = function (encodedFile) {
        console.log("reader.onload");
        var base64Image = encodedFile.srcElement.result.split("data:image/jpeg;base64,")[1];
        var blob = new Blob([base64Image],{type:"image/jpeg"});
        var reader2 = new FileReader();

        // callback for readAsBinaryString
        reader2.onloadend = function(decoded) {
            console.log("reader2.onloadend");
            console.log(decoded); // this should contain binary format of the image

            // console.log(URL.createObjectURL(decoded.binary)); // Doesn't work
        };
        reader2.readAsBinaryString(blob);

        // console.log(URL.createObjectURL(atob(base64Image))); // Doesn't work

    };
    reader.readAsDataURL(file);
    console.log(URL.createObjectURL(file)); // Works
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-20T19:17:09.550

经过更多研究后，我从[这里](https://www.evernote.com/shard/s18/sh/50ea8199-3f8c-4061-8c90-82e264380412/2c92f01382e0b35e1a48fd8e173ac8b2?noteKey=2c92f01382e0b35e1a48fd8e173ac8b2&noteGuid=50ea8199-3f8c-4061-8c90-82e264380412)找到了答案， 我基本上需要将原始二进制文件包装在数组缓冲区中并将二进制字符转换为 Unicode。

这是缺少的代码，

```
 var binaryImg = atob(base64Image);
    var length = binaryImg.length;
    var ab = new ArrayBuffer(length);
    var ua = new Uint8Array(ab);
    for (var i = 0; i < length; i++) {
        ua[i] = binaryImg.charCodeAt(i);
    } 
```

完整的示例代码在[这里](http://jsfiddle.net/qL86Z/8/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T00:24:13.363

[`URL.createObjectURL`](https://developer.mozilla.org/en-US/docs/DOM/window.URL.createObjectURL)期望 a [`Blob`](https://developer.mozilla.org/en-US/docs/DOM/Blob)（可以是 a [`File`](https://developer.mozilla.org/en-US/docs/DOM/File)）作为它的参数。不是字符串。这就是为什么`URL.createObjectURL(file)`有效。

相反，您正在创建一个读取为*数据 url*的数据，然后使用该数据 url 创建另一个（具有相同内容）。然后你甚至创建一个从*刚刚*构造的. 但是，url 字符串部分（即使-decoded 为更大的字符串）和字符串都不是!的有效参数。[`FileReader`](https://developer.mozilla.org/en-US/docs/DOM/FileReader) `reader``file`*`Blob``reader2`*`blob``base64Image``btoa``decoded.binary``URL.createObjectURL`**

# php - 如何在 PHP 或 JavaScript 中立即返回搜索结果建议？

> ID：14967649
> 
> 赞同：-1
> 
> 时间：2013-02-19T21:19:54.143
> 
> 标签：php, javascript, html

我有一个正在处理的网页，我希望有一个文本/搜索框，用户可以在其中输入并立即获得搜索建议。

例如，如果用户输入“San”，他们可能会得到一个可供选择的列表，如下所示：

```
San Francisco
San Bernardino
San Diego 
```

等等

有人可以为我指出如何快速有效地做到这一点的正确方向吗？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:21:28.983

有很多 Javascript 自动完成解决方案，这里是 jQuery UI 的版本：http: [//jqueryui.com/autocomplete/](http://jqueryui.com/autocomplete/)

# c# - 覆盖字典 的 ContainsKey

> ID：14967653
> 
> 赞同：2
> 
> 时间：2013-02-19T21:20:08.507
> 
> 标签：c#, containskey

我有一个`Dictionary<DateTime, int>`这样的定义：

```
public Dictionary<DateTime, int> Days; 
```

每个`DateTime`都与一个`int`. 我想要一个函数来指示`DateTime`我的字典中是否已经存在同一天：

```
public int GetIntFromDate(DateTime date)
{
    int i = -1;
    if (Days.ContainsKey(date))
    {
        i= CorrespondanceJoursMatchs[date];
    }

    return i;
} 
```

这是完美的，但如果已经有相同的日+月+年（不查看小时/分钟/秒），我希望`ContainsKey`返回。`true``DateTime`

事实上，我的字典不应该允许 2 个`DateTime`索引具有相同的日/月/年。

一个解决方案可能是创建一个只有一个`DateTime`属性并覆盖`GetHashCode`and的类`Equals`，但也许有更好的解决方案？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-19T21:21:39.577

这很简单：只需`IEqualityComparer<DateTime>`以仅使用的方式实现`DateTime.Date`，并将该实现的实例传递给`Dictionary<,>`构造函数。示例代码：

```
using System;
using System.Collections.Generic;

class DateEqualityComparer : IEqualityComparer<DateTime>
{
    public bool Equals(DateTime x, DateTime y)
    {
        return x.Date == y.Date;
    }

    public int GetHashCode(DateTime obj)
    {
        return obj.Date.GetHashCode();
    }
}

class Test
{
    static void Main()
    {
        var key1 = new DateTime(2013, 2, 19, 5, 13, 10);
        var key2 = new DateTime(2013, 2, 19, 21, 23, 30);

        var comparer = new DateEqualityComparer();
        var dictionary = new Dictionary<DateTime, string>(comparer);
        dictionary[key1] = "Foo";
        Console.WriteLine(dictionary[key2]); // Prints Foo
    }

} 
```

# .net - WPF .Net 4 - OneWayToSource 绑定到只写属性适用于某些机器！如何？

> ID：14967667
> 
> 赞同：3
> 
> 时间：2013-02-19T21:20:45.133
> 
> 标签：.net, wpf, binding

我最近在我们的代码中添加了一个 OneWayToSource 绑定到视图模型中的只读属性。当时我不知道.Net 4的变化，当没有getter时这会导致异常：

```
<Popup IsOpen="{Binding IsPopupOpen, Mode=OneWayToSource}" />
...
public bool IsPopupOpen
{
    set
    {
        // do something with value
    }
} 
```

问题是，这段代码**可以**在我的电脑上运行而不会引发异常。完全相同的可执行文件在其他机器上不起作用 - 弹出窗口没有打开，并且引发了预期的异常。我无法弄清楚这怎么可能？该项目针对.Net FW 4。

我确保清除我的 bin 文件夹并重建，但它仍然在我的机器上毫无例外地工作，而不是在其他机器上。

我知道如何“解决”这个问题——只需在属性中添加一个吸气剂。但是我需要弄清楚程序在不同机器上的运行方式有何不同，因为这可能会导致其他严重问题......

编辑：

这让我发疯！我使用 Snoop WPF 实用程序查看我的弹出窗口，似乎根本没有绑定到 IsOpen（绑定是 XAML 的新增功能）。但是，如果我将调试器附加到应用程序并在绑定属性的设置器内设置断点，它会命中我的断点！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:47:59.830

有点猜测。

有可能在 net 4.0 中进行此更改后，他们决定在 .net 4.5 中使其更加一致：如果 getter 存在，则将属性重新读回 UI，否则不会发生任何可怕的事情并且不会引发异常。

如果是这样并且您安装了 .net 4.5，您可以获得这种行为而不是预期的行为。
我们遇到过 4.5 的更新以静默方式传播到 4.0 的情况。

# ios - iOS - UITableView 检测当手指在滚动时越过键盘时

> ID：14967675
> 
> 赞同：0
> 
> 时间：2013-02-19T21:21:20.413
> 
> 标签：ios, uitableview, scroll, touch, detect

我的应用程序中有一个与原生消息应用程序非常相似的功能。我喜欢当滚动消息表并且您的手指穿过键盘 UI 时键盘隐藏的方式。

我想模仿这种行为，并想知道是否有一种简单的方法可以检测到这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T00:12:13.763

我发现了一个很棒的库来为你处理这个问题。它完全模仿 Messages 应用程序并且易于设置和使用： http: [//www.cocoacontrols.com/platforms/ios/controls/dakeyboardcontrol](http://www.cocoacontrols.com/platforms/ios/controls/dakeyboardcontrol)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:31:13.660

查看消息应用程序，当键盘向下动画时的逻辑似乎没有链接到表格视图中的部分。在我的一个消息线程中，当键盘顶部位于其中一个消息气泡的中间时，它开始向下动画。我认为`contentOffset`tableview 只是被跟踪，当它超过一定数量时，键盘开始在屏幕上显示动画。您可以通过实现来跟踪`contentOffset`用户每次开始拖动 tableview

```
- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView 
```

和

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView 
```

UIScrollViewDelegate 协议中的方法。

# spring - Spring Security：jdbc-user-query、PreparedStatementCallback

> ID：14967676
> 
> 赞同：1
> 
> 时间：2013-02-19T21:21:26.030
> 
> 标签：spring, jsp, spring-security, hql, security-context

我的查询有问题，但我不知道是什么原因造成的，所以我需要你的帮助 =)

我得到以下异常：

PreparedStatementCallback; 错误的 SQL 语法 [选择 USERNAME 作为用户名，密码作为密码，来自 ams.user where USERNAME=?]; 嵌套异常是 com.mysql.jdbc.exceptions.MySQLSyntaxErrorException: You have an error in your SQL syntax; 检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“from ams.user where USERNAME='admin'”附近使用正确的语法

这是我的 login.jsp：

```
<div class="box">

    <h1><spring:message code="login.description" /></h1>
    <br/>

    <form name='f' action="<c:url value='j_spring_security_check' />" method='POST'>                    
        <ol>
            <li>
                <label><spring:message code="user.user" />:</label>
                <em><img src="images/star_red.png" alt="required"></img></em>   
                <input type='text' name='j_username'>
            </li>
            <li>
                <label><spring:message code="user.password" />:</label>
                <em><img src="images/star_red.png" alt="required"></img></em>   
                <input type='password' name='j_password' />
            </li>
            <li>
                <label>&ensp;</label>
                <input type='hidden' name='remember_me' id="remember_hidden" value="false"/>
                <input type='checkbox' id='remember_checkbox' onchange="toggleRememberMe()" class="checkbox"/>
                <spring:message code="login.remember" />
            </li>
            <li>
                <label>&ensp;</label>
                <input type="submit" value="<spring:message code="login"/>"/>
            </li>
        </ol>

        <br />
        <br />

    </form>

    <c:if test="${not empty param.login_error}">
        <div class="error">
            <br />
            <spring:message code="login.error" />
            <br />
            <spring:message code="login.errorReason" />:
            <c:out value="${SPRING_SECURITY_LAST_EXCEPTION.message}" />
        </div>
    </c:if>
</div> 
```

这是我的安全上下文代码：

```
 <?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:security="http://www.springframework.org/schema/security"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
              http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
              http://www.springframework.org/schema/security 
              http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <!-- <security:http auto-config="true" access-decision-manager-ref="accessDecisionManager"> -->
    <security:http auto-config="true">
        <security:intercept-url pattern="/login/login.do" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/login/doLogin.do" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/lib/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/css/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/images/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/resources/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/**" access="IS_AUTHENTICATED_REMEMBERED" />
        <security:form-login login-page="/login/login.do" authentication-failure-url="/login/login.do?login_error=true" default-target-url="/test/showTest.do"/>
        <security:logout logout-success-url="/login/login.do" invalidate-session="true" />
        <security:remember-me key="rememberMe"/>
    </security:http>    

    <security:authentication-manager>
        <security:authentication-provider>
            <security:jdbc-user-service data-source-ref="dataSource" 
            users-by-username-query="select USERNAME as username, PASSWORD as password, from ams.user where USERNAME=?"
            authorities-by-username-query="
                select distinct user.USERNAME as username, permission.NAME as authority 
                from ams.user, ams.user_role, ams.role, ams.role_permission, ams.permission
                where user.ID=user_role.USER_ID AND user_role.ROLE_ID=role_permission.ROLE_ID AND role_permission.PERMISSION_ID=permission.ID AND user.EMAIL=?"/>
            <security:password-encoder ref="passwordEncoder" />
        </security:authentication-provider>
    </security:authentication-manager>

    <bean id="passwordEncoder"
        class="org.springframework.security.authentication.encoding.ShaPasswordEncoder">
        <constructor-arg value="256" />
    </bean>
</beans> 
```

有谁知道可能导致此错误的原因？非常感谢您对此的帮助=）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T04:05:57.400

密码后面的sql中有一个逗号，去掉那个

更改 sql 从

```
select USERNAME as username, PASSWORD as password, from ams.user where USERNAME=? 
```

到

`select USERNAME as username, PASSWORD as password from ams.user where USERNAME=?`

# php - 对象未使用 AJAX 正确发布

> ID：14967683
> 
> 赞同：2
> 
> 时间：2013-02-19T21:21:53.697
> 
> 标签：php, jquery, ajax, object, post

我有一个简单的函数，它将多个输入的值和 id 编译到一个对象中，然后将它们传递给 AJAX 函数。不幸的是，我无法正确发布数据。处理页面肯定被调用并且变量使它成为js（对象在控制台中看起来是正确的），但是所有变量在处理页面上似乎都是空白的。

脚本：

```
$("#" + buttonId).find(".submitValue").each(function() {
    inputId = $(this).attr("id").replace(buttonId + "-", "");
    inputValue = $(this).val();

    var data = {}; 
    data[inputId] = inputValue;
    dataObject.push(data);
});

$.post(
    'ajax/' + buttonId + '.php', 
    {
        'nextForm': formNumber,
        dataObject: dataObject
    },
    function (response) {
        $("#" + buttonId).append(response);

    }
); 
```

相关的 php 处理页面（变量比这多得多，但看起来都一样 - 本示例中的 id 为“timeBlockLocation”、“appointmentAddress1”、“appointmentAddress2”） - 已创建连接

```
$nextForm = $connection->real_escape_string($_POST["nextForm"]);
$timeBlockLocation = $connection->real_escape_string($_POST["timeBlockLocation"]);
$appointmentAddress1 = $connection->real_escape_string($_POST["appointmentAddress1"]);
$appointmentAddress2 = $connection->real_escape_string($_POST["appointmentAddress2"]); 
```

这是 $_POST 处理页面上的 var_dump：

```
array(2) {
  ["nextForm"]=&gt;
  string(1) "6"
  ["dataObject"]=&gt;
  array(3) {
    [0]=&gt;
    array(1) {
      ["timeBlockLocation"]=&gt;
      string(1) "1"
    }
    [1]=&gt;
    array(1) {
      ["appointmentAddress1"]=&gt;
      string(4) "TEST"
    }
    [2]=&gt;
    array(1) {
      ["appointmentAddress1"]=&gt;
      string(5) "TEST2"
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T18:40:16.600

正如 Mahn 指出的那样，我在数组中导航错误。我最终成功地使用了如下符号：

```
$timeBlockLocation = $connection->real_escape_string($_POST["dataObject"][0]["timeBlockLocation"]); 
```

# opengl - 堆栈中的推送和弹出矩阵（openGL）

> ID：14967685
> 
> 赞同：0
> 
> 时间：2013-02-19T21:21:59.947
> 
> 标签：opengl

我知道这段代码中存在一些问题，就好像我运行它没有绘制一样。

错误位于此代码中的程序部分

```
void display(void)
{
  glClear (GL_COLOR_BUFFER_BIT);
  glColor3f (1.0, 1.0, 1.0);

  glLoadIdentity ();         

  glPushMatrix();
  glRotated((GLdouble) Vangle,1.0,0.0,0.0);
  gluLookAt (0.0, 0.0, 5.0,   0.0, 0.0, 0.0,    0.0, 1.0, 0.0);
  glPopMatrix();

  glutWireCube (1.0);

  glFlush ();
} 
```

你能说出什么是错的吗？

我认为在矩阵堆栈方法（推送和弹出）中，我不知道如何使用它

注意： 的值 `Vangle` 为零。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:39:27.923

正如 pst 指出的那样：将`glutWireCube()`呼叫移到`glPush/PopMatrix()`对内。

试一试：

```
#include <GL/glut.h>

void display()
{
    glEnable( GL_DEPTH_TEST );
    glClear( GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT );

    // projection
    glMatrixMode( GL_PROJECTION );
    glLoadIdentity();
    double w = glutGet( GLUT_WINDOW_WIDTH );
    double h = glutGet( GLUT_WINDOW_HEIGHT );
    double ar = w / h;
    gluPerspective( 60, ar, 0.1, 100 );

    // "camera" transform
    glMatrixMode( GL_MODELVIEW );
    glLoadIdentity();
    gluLookAt (0.0, 0.0, 5.0,   0.0, 0.0, 0.0,    0.0, 1.0, 0.0);

    // draw cube
    glPushMatrix();
    float Vangle = 0.0f;
    glRotated((GLdouble) Vangle,1.0,0.0,0.0);
    glutWireCube (1.0);    
    glPopMatrix();

    glutSwapBuffers();
}

int main( int argc, char **argv )
{
    glutInit( &argc, argv );
    glutInitDisplayMode( GLUT_RGBA | GLUT_DEPTH | GLUT_DOUBLE );
    glutInitWindowSize( 640, 480 );
    glutCreateWindow( "GLUT" );
    glutDisplayFunc( display );
    glutMainLoop();
    return 0;
} 
```

# php - .htaccess：防止 php 脚本访问父/兄弟目录

> ID：14967687
> 
> 赞同：3
> 
> 时间：2013-02-19T21:22:02.617
> 
> 标签：php, .htaccess, security

我对 .htaccess 不是特别有经验（除了简单的 mod_rewrite 和基本的拒绝/访问），并且不确定如何解决以下问题：

我的目录结构如下：

```
/parentDirectory
    /childDirectoryOne
    /childDirectoryTwo 
```

我有一个指向 /parentDirectory 的域（我们将其称为 parent.com），并为每个子目录分配单独的子域（我们将分别称为 one.parent.com 和 two.parent.com）。

这些都位于共享主机上。我需要能够授予对子目录的 ftp 访问权限，但问题是现在，有人可以将 php 文件上传到 childDirectoryOne 扫描父目录，从而发现其兄弟目录，然后可以移动到兄弟目录和从文件（如 dbConfig 文件）中获取敏感信息。

我一直在尝试做的（到目前为止没有成功）是开发一组 .htaccess 文件，以防止子目录中的脚本访问父目录或兄弟目录。我什至不确定这是否可能。不幸的是，我的共享主机不支持设置 chroot 监狱，所以这是我寻找解决方案的最后选择（除了为每个 ftp 用户购买主机，这样他们就无法访问其他信息）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:43:58.340

将文件夹的读取、写入和执行权限授予您不完全信任的人被认为是不好的做法。

上传任意脚本并在服务器上执行它的能力非常重要（他们访问另一个文件夹是您最不必担心的）。人们可以完全破坏您的服务器及其上的所有站点，访问您的数据库，覆盖任何站点中的其他页面，并且列表还在继续。

我建议对上传的文件完全禁用 php。你可以把它放在你的`.htaccess`.

```
php_flag engine off 
```

话虽这么说，如果你真的想这样做，你可以使用[`open_basedir`](http://php.net/manual/en/ini.core.php#ini.open-basedir).

```
<Directory /parentDirectory/childDirectoryOne>
  php_admin_value open_basedir "/parentDirectory/childDirectoryOne"
</Directory> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-27T19:27:05.623

# NOTE!

You need to utilize `safe_mode` too, otherwise with `shell(),exec()...` you will be hacked.... BUT!! that's not enough. Read here fully - [https://puvox.software/blog/restrict-php-access-upper-directory/](https://puvox.software/blog/restrict-php-access-upper-directory/)

# java - 在 JAX-WS 中更改 SOAPRequest 前缀

> ID：14967691
> 
> 赞同：2
> 
> 时间：2013-02-19T21:22:07.560
> 
> 标签：java, web-services, jax-ws, soap-client

如何在 JAX-WS 中更改 SOAP 请求前缀。我在句柄消息中更新了 setprofix 方法

```
 SOAPMessage msgs = ctx.getMessage();

        SOAPMessage sm = MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL).createMessage();
         sm.getSOAPPart().getEnvelope().setPrefix("soap");
         sm.getSOAPPart().getEnvelope().removeNamespaceDeclaration("env");
         sm.getSOAPHeader().setPrefix("soap");
         sm.getSOAPBody().setPrefix("soap");*/ 
```

但我仍然收到相同的请求

```
 <?xml version="1.0"?>
       <S:Envelope xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
```

我需要

```
 <Soap:Envelope xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
```

请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-19T11:06:42.843

我需要将默认前缀从 S 更改为 soapenv。这是我所做的：

1.  创建设置前缀的 SOAPHandler 的实现。

    ```
    public class SoapNamespaceHandler implements SOAPHandler<SOAPMessageContext>{
        private final static String SOAP_PREFIX = "soapenv";

        @Override
        public boolean handleMessage(final SOAPMessageContext context){
    //only update the namespace prefix for outbound messages (requests)
            final Boolean isSoapRequest = (Boolean)context.get(MessageContext.MESSAGE_OUTBOUND_PROPERTY);
            if (isSoapRequest){
                try{
                    //get the soap message and envelope
                    SOAPMessage soapMsg = context.getMessage();
                    SOAPEnvelope env = soapMsg.getSOAPPart().getEnvelope();
                    //set the prefix
                    env.setPrefix(SOAP_PREFIX);        
                    // **** apply the changes to the message
                    soapMsg.saveChanges();
                } 
                catch (SOAPException e) {
                    e.printStackTrace();
                }
            }
        return true;
    } 
    ```

2.  执行以下操作之一：

    *   创建一个用作 HandlerResolver 的 XML 文件（请参阅[更改 JAX-WS 默认 XML 命名空间前缀](https://stackoverflow.com/questions/10678723/changing-jax-ws-default-xml-namespace-prefix)），然后使用 @HandlerChain(file = "handler.xml") 注释您的 Web 服务客户端类

        ```
        <?xml version="1.0" encoding="UTF-8"?>
        <handler-chains xmlns="http://java.sun.com/xml/ns/javaee">
            <handler-chain>
                <handler>
                    <handler-name>mypackage.SoapNamespaceHandler</handler-name>
                    <handler-class>mypackage.SoapNamespaceHandler</handler-class>
                </handler>
            </handler-chain>
        </handler-chains> 
        ```

    *   创建 HandlerResolver 的实现 ...

        ```
         public class SoapNamespaceHandlerResolver implements HandlerResolver {
            @SuppressWarnings({ "rawtypes" })
            @Override
            public List<Handler> getHandlerChain(PortInfo portInfo) {
                List<Handler> handlerChain = new ArrayList<Handler>();
                Handler handler = (SOAPHandler<SOAPMessageContext>) new SoapNamespaceHandler();
                String bindingID = portInfo.getBindingID();
                if (bindingID.equals("http://schemas.xmlsoap.org/wsdl/soap/http")) {
                    handlerChain.add(handler);
                } else if (bindingID.equals("http://java.sun.com/xml/ns/jaxws/2003/05/soap/bindings/HTTP/")) {
                    handlerChain.add(handler);
                }
                return handlerChain;
            }
        } 
        ```

        ...然后通过调用以编程方式将您的 HandlerResolver 实现附加到您的 Web 服务客户端

        ```
         webServiceClient.setHandlerResolver(new SoapNamespaceHandlerResolver()); 
        ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T20:29:50.840

```
 final SOAPMessage soapMsg = context.getMessage();
    soapMsg.getSOAPPart().getEnvelope().setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:soap", "http://schemas.xmlsoap.org/soap/envelope/");
    soapMsg.getSOAPPart().getEnvelope().removeAttributeNS("http://schemas.xmlsoap.org/soap/envelope/", "env");
    soapMsg.getSOAPPart().getEnvelope().removeAttribute("xmlns:env");
    soapMsg.getSOAPPart().getEnvelope().setPrefix("soap");
    soapMsg.getSOAPBody().setPrefix("soap");
    soapMsg.getSOAPPart().getEnvelope().getHeader().detachNode(); 
```

# c++ - C++：各种编码获取器，如 Python

> ID：14967692
> 
> 赞同：0
> 
> 时间：2013-02-19T21:22:15.110
> 
> 标签：c++, python, encoding, icu

我的问题是关于 C++ 下的编码。当我使用 Python 时，有时我不得不使用这样的编码来满足各种需求：

```
sys.stdin.encoding
sys.stdout.encoding
sys.stderr.encoding
sys.getfilesystemencoding()
sys.getdefaultencoding()
locale.getdefaultlocale()[0] 
```

现在有一个问题：在 C++ 中是否有一种跨平台的方式来实现类似的东西？我知道我可以看到 Python 的源代码，但可能有一些解决方案对使用 C++ 的人来说很有名，而无需查看 Python 的源代码。我认为对于语言环境，我可以使用`#include <locale>`or `#include <clocale>`; 在 Linux 下我也可以使用`getenv("LANG")`from `<cstdlib>`。还有别的事吗？

如果有帮助，我有工作`ICU`图书馆。

# ios - ios - 像 Twitter 应用一样展开表格视图单元格

> ID：14967696
> 
> 赞同：5
> 
> 时间：2013-02-19T21:22:56.547
> 
> 标签：ios, animation, twitter, uitableview

在选择一条推文时，我希望具有与 Twitter 应用程序相同的行为：扩展行并添加补充内容。

所以这不仅仅是一个基本的行大小调整。我想我需要 2 个不同的自定义单元格，所以我做了类似的事情：

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    if ([indexPath compare:self.selectedIndexPath] != NSOrderedSame) {
        FirstCell *cell = [tableView dequeueReusableCellWithIdentifier:@"FirstCell"];
        if (!cell) {
            cell = [[FirstCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"FirstCell"];
        }

        cell.firstnameLabel.text = [[self.items objectAtIndex:indexPath.row] objectForKey:@"firstname"];

        return cell;
    }
    else {
        SecondCell *cell = [tableView dequeueReusableCellWithIdentifier:@"SecondCell"];
        if (!cell) {
            cell = [[SecondCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"SecondCell"];
        }

        cell.firstnameLabel.text = [[self.items objectAtIndex:indexPath.row] objectForKey:@"firstname"];
        cell.lastnameLabel.text = [[self.items objectAtIndex:indexPath.row] objectForKey:@"lastname"];

        return cell;
    }

}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    if ([indexPath compare:self.selectedIndexPath] == NSOrderedSame) {
        return 80.0;
    } else {
        return 44.0;
    }
}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    self.selectedIndexPath = indexPath;

    [tableView reloadData];
} 
```

我的问题是我想保持像 Twitter 应用程序这样的流畅动画，这不是我的情况，因为`[tableView reloadData]`（我认为这是强制性的，因为我有 2 个不同的自定义单元格）。

所以有人知道我需要的解决方法，或者有人知道 Twitter 应用程序是如何处理这个动画的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T21:30:30.353

您想用动画重新加载该单元格：

```
[tableView beginUpdates];
[tableView reloadRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
[tableView endUpdates]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T21:26:14.503

```
[tableView beginUpdates];
[tableView endUpdates]; 
```

这会触发整个 tableView 的单元格行大小的更新......引用自：[iPhone - UITableViewCell 高度变化的平滑动画，包括内容更新](https://stackoverflow.com/questions/5047390/iphone-smooth-animation-for-uitableviewcell-height-change-including-content-up)

快乐编码！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-29T03:58:13.417

实际上，只需将原始代码与 rooster117 的解决方案相结合，就可以使用两个自定义单元来实现这一点，就像您最初想要的那样。替换`[tableView reloadData]`为`tableView:didSelectRowAtIndexPath:`：

```
[tableView beginUpdates];
[tableView reloadRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];
[tableView endUpdates]; 
```

你应该有你的解决方案。

# sql - 在 System.Data.Linq.DataContext 对象上重新编译查询提示

> ID：14967699
> 
> 赞同：4
> 
> 时间：2013-02-19T21:23:26.320
> 
> 标签：sql, sql-server, linq, linq-to-sql, datacontext

我有一个由 DataContext 对象调用的查询，该对象正在创建一个效率极低的执行计划。我想在查询中添加“OPTION(RECOMPILE)”查询提示，但我不知道如何将此查询提示添加到 DataContext 对象的查询中。

我运行 SQL 跟踪以捕获查询。我按原样手动运行它，花了将近四分钟，通过将“OPTION（RECOMPILE）”添加到查询中，它将运行时间减少到一秒。该查询包含许多变量、一对表值函数和一个带有嵌入式表值函数的视图。所有输入变量都是数字。两次执行之间的查询计划非常不同。

我不需要帮助优化代码来避免糟糕的执行计划；如果我需要走这条路，我可以自己做。我只需要知道是否有办法将 OPTION(RECOMPILE) 查询提示添加到我的 Linq 查询中。我不会发布代码，这与我的问题无关。

如果可以添加重新编译查询提示，请让我知道如何，如果不可能，请提供指向某些文档的链接，表明这是这种情况，我将不胜感激。

我使用 SQL Server 2012 作为我的 rdbms。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:54:35.747

EF 请求在未来添加提示存在问题 - [http://entityframework.codeplex.com/workitem/261](http://entityframework.codeplex.com/workitem/261)。

如果幸运的话，它将进入 EF 6。

# jquery - Wordpress 钩子被调用两次。可能的解决方案？

> ID：14967704
> 
> 赞同：1
> 
> 时间：2013-02-19T21:23:40.903
> 
> 标签：jquery, wordpress, duplicates, hook

我有一个 Wordpress 商店设置，并且有一个钩子被调用来显示客户选择的产品选项。

钩子是：

```
wpsc_after_cart_widget_item_name
<?php echo wpsc_cart_item_name(); ?></a>

<span style="font-size: 10px; line-height: 0.06em;">

<?php do_action ( "wpsc_after_cart_widget_item_name" ); ?></td>

<td><?php echo wpsc_cart_item_quantity(); ?></td>
<td><?php echo wpsc_cart_item_price(); ?></td>
<td class="cart-widget-remove"><form action="" method="post" class="adjustform">
    <input type="hidden" name="quantity" value="0" />
    <input type="hidden" name="key" 
           value="<?php echo wpsc_the_cart_item_key(); ?>" />
    <input type="hidden" name="wpsc_update_quantity" value="true" />
    <input class="remove_button" type="submit" /> 
```

我无法弄清楚为什么它在购物车小部件中显示两次。我在网络上彻底搜索了过滤器挂钩、故障排除，甚至是用 jQuery 删除重复文本的丑陋方法，但一无所获。

任何帮助，将不胜感激。我的网站是[http://www.a1decals.com/products-page](http://www.a1decals.com/products-page)。

我还不能发布图片，但这里有一个链接：http: [//i134.photobucket.com/albums/q87/mad_stallion_2006/screen001-3_zpsa94e087b.jpg](http://i134.photobucket.com/albums/q87/mad_stallion_2006/screen001-3_zpsa94e087b.jpg)

* * *

更新：这是购物车的代码，您的代码插入到您告诉我它依赖的动作挂钩的上方和下方。

不知道是不是把代码放错地方了还是怎么了，我会继续挪动看看，但还是一头雾水。

很抱歉提出所有代码，但我不知道什么可能相关。

```
<?php global $wpsc_cart, $wpdb, $wpsc_checkout, $wpsc_gateway, $wpsc_coupons,     $wpsc_registration_error_messages;
$wpsc_checkout = new wpsc_checkout();
$wpsc_gateway = new wpsc_gateways();
$alt = 0;
$coupon_num = wpsc_get_customer_meta( 'coupon' );
if( $coupon_num )
   $wpsc_coupons = new wpsc_coupons( $coupon_num );

if(wpsc_cart_item_count() < 1) :
   _e('Oops, there is nothing in your cart.', 'wpsc') . "<a href=" . esc_url( get_option( "product_list_url" ) ) . ">" . __('Please visit our shop', 'wpsc') . "</a>";
   return;
endif;
?>
<div id="checkout_page_container"><br>
<h3><?php _e('', 'wpsc'); ?></h3></span>
<table class="checkout_cart">
   <tr class=" header">

<p style="font-family: Verdana, Arial, Helvetica, sans-serif; line-height: normal; text-align: center;"><span style="text-decoration: underline; color: #f4f4f4;"><span style="font-size: 18px;">Cart Records "Product Options" Like Color And Mirror Twice For Us  </p>

<tr style="background-color: #000078;">

      <th colspan="2"><?php _e('Product', 'wpsc'); ?></th>
      <th><?php _e('Quantity', 'wpsc'); ?></th>
      <th><?php _e('Price', 'wpsc'); ?></th>
      <th><?php _e('Total', 'wpsc'); ?></th>
        <th>&nbsp;</th>
   </tr>
   <?php while (wpsc_have_cart_items()) : wpsc_the_cart_item(); ?>
      <?php
       $alt++;
       if ($alt %2 == 1)
         $alt_class = 'alt';
       else
         $alt_class = '';
       ?>
      <?php  //this displays the confirm your order html ?>

<?php // This is used to fix the hook being called twice incorrectly ?>
<?php global $receivedItemHooks ?>
<?php if (!$receivedItemHooks) $receivedItemHooks = array() ?>

<?php if (!isset($receivedItemHooks[wpsc_the_cart_item_key()]): ?>

      <?php do_action ( "wpsc_before_checkout_cart_row" ); ?>
      <tr class="product_row product_row_<?php echo wpsc_the_cart_item_key(); ?> <?php echo $alt_class;?>">

         <td class="firstcol wpsc_product_image wpsc_product_image_<?php echo wpsc_the_cart_item_key(); ?>">
         <?php if('' != wpsc_cart_item_image()): ?>
            <?php do_action ( "wpsc_before_checkout_cart_item_image" ); ?>
            <img src="<?php echo wpsc_cart_item_image(); ?>" alt="<?php echo wpsc_cart_item_name(); ?>" title="<?php echo wpsc_cart_item_name(); ?>" class="product_image" />
            <?php do_action ( "wpsc_after_checkout_cart_item_image" ); ?>
         <?php else:
         /* I dont think this gets used anymore,, but left in for backwards compatibility */
         ?>
            <div class="item_no_image">
                <?php do_action ( "wpsc_before_checkout_cart_item_image" ); ?>
               <a href="<?php echo esc_url( wpsc_the_product_permalink() ); ?>">
               <span><?php _e('No Image','wpsc'); ?></span>

               </a>
                <?php do_action ( "wpsc_after_checkout_cart_item_image" ); ?>
            </div>
         <?php endif; ?>
         </td>

         <td class="wpsc_product_name wpsc_product_name_<?php echo wpsc_the_cart_item_key(); ?>">
            <?php do_action ( "wpsc_before_checkout_cart_item_name" ); ?>
            <a href="<?php echo esc_url( wpsc_cart_item_url() );?>">

<span style="font-size: 12px;">
<?php echo wpsc_cart_item_name(); ?></a>
<span style="font-size: 12px;">

            <?php do_action ( "wpsc_after_checkout_cart_item_name" ); ?>
         </td>

         <td class="wpsc_product_quantity wpsc_product_quantity_<?php echo wpsc_the_cart_item_key(); ?>">
            <form action="<?php echo esc_url( get_option( 'shopping_cart_url' ) ); ?>" method="post" class="adjustform qty">
               <input type="text" name="quantity" size="2" value="<?php echo wpsc_cart_item_quantity(); ?>" />
               <input type="hidden" name="key" value="<?php echo wpsc_the_cart_item_key(); ?>" />
               <input type="hidden" name="wpsc_update_quantity" value="true" />
               <input type="submit" value="<?php _e('Update', 'wpsc'); ?>" name="submit" />
            </form>
         </td>

            <td><?php echo wpsc_cart_single_item_price(); ?></td>
         <td class="wpsc_product_price wpsc_product_price_<?php echo wpsc_the_cart_item_key(); ?>"><span class="pricedisplay"><?php echo wpsc_cart_item_price(); ?></span></td>

         <td class="wpsc_product_remove wpsc_product_remove_<?php echo wpsc_the_cart_item_key(); ?>">
            <form action="<?php echo esc_url( get_option( 'shopping_cart_url' ) ); ?>" method="post" class="adjustform remove">
               <input type="hidden" name="quantity" value="0" />
               <input type="hidden" name="key" value="<?php echo wpsc_the_cart_item_key(); ?>" />
               <input type="hidden" name="wpsc_update_quantity" value="true" />
               <input type="submit" value="<?php _e('Remove', 'wpsc'); ?>" name="submit" />

<?php // Mark the item as rendered ?>
    <?php $receivedItemHooks[wpsc_the_cart_item_key()] = true ?>
<?php endif ?>

 </form>
         </td>
      </tr>
      <?php do_action ( "wpsc_after_checkout_cart_row" ); ?>
   <?php endwhile; ?>
   <?php //this HTML displays coupons if there are any active coupons to use ?>

   <?php

   if(wpsc_uses_coupons()): ?>

      <?php if(wpsc_coupons_error()): ?>
         <tr class="wpsc_coupon_row wpsc_coupon_error_row"><td colspan="6"><?php _e('Coupon is not valid.', 'wpsc'); ?></td></tr>
      <?php endif; ?>
      <tr class="wpsc_coupon_row">
         <td colspan="2"><?php _e('Enter coupon code :', 'wpsc'); ?></td>
         <td  colspan="4" class="coupon_code">
            <form  method="post" action="<?php echo esc_url( get_option( 'shopping_cart_url' ) ); ?>">
               <input type="text" name="coupon_num" id="coupon_num" value="<?php echo $wpsc_cart->coupons_name; ?>" />
               <input type="submit" value="<?php _e('Update', 'wpsc') ?>" />
            </form>
         </td>
      </tr>
      <tr class="wpsc_total_before_shipping">
          <td colspan="3"><?php _e('Cost before shipping:','wpsc'); ?></td>
          <td colspan="3" class="wpsc_total_amount_before_shipping"><?php echo wpsc_cart_total_widget(false,false,false);?></td>
      </tr>
   <?php endif; ?>
   </table>
   <!-- cart contents table close -->
  <?php if(wpsc_uses_shipping()): ?>
       <p class="wpsc_cost_before"></p>
   <?php endif; ?>
   <?php  //this HTML dispalys the calculate your order HTML   ?>

   <?php if(wpsc_has_category_and_country_conflict()): ?>
      <p class='validation-error'><?php echo esc_html( wpsc_get_customer_meta( 'category_shipping_conflict' ) ); ?></p>
   <?php endif; ?>

   <?php if(isset($_SESSION['WpscGatewayErrorMessage']) && $_SESSION['WpscGatewayErrorMessage'] != '') :?>
      <p class="validation-error"><?php echo $_SESSION['WpscGatewayErrorMessage']; ?></p>
   <?php
   endif;
   ?>

   <?php do_action('wpsc_before_shipping_of_shopping_cart'); ?>

   <div id="wpsc_shopping_cart_container">
   <?php if(wpsc_uses_shipping()) : ?>
      <h2><font color="#1956cf"><?php _e('Calculate Shipping Price', 'wpsc'); ?></font></h2>
      <table class="productcart">
         <tr class="wpsc_shipping_info">
            <td colspan="5">
               <?php _e('Please specify shipping location below to calculate your shipping costs', 'wpsc'); ?>
            </td>
         </tr>

         <?php if (!wpsc_have_shipping_quote()) : // No valid shipping quotes ?>
            <?php if (wpsc_have_valid_shipping_zipcode()) : ?>
                  <tr class='wpsc_update_location'>
                     <td colspan='5' class='shipping_error' >
                        <?php _e('Please provide a Zipcode and click Calculate in order to continue.', 'wpsc'); ?>
                     </td>
                  </tr>
            <?php else: ?>
               <tr class='wpsc_update_location_error'>
                  <td colspan='5' class='shipping_error' >
                     <?php _e('Sorry, online ordering is unavailable to this destination and/or weight. Please double check your destination details.', 'wpsc'); ?>
                  </td>
               </tr>
            <?php endif; ?>
         <?php endif; ?>
         <tr class='wpsc_change_country'>
            <td colspan='5'>
               <form name='change_country' id='change_country' action='' method='post'>
                  <?php echo wpsc_shipping_country_list();?>
                  <input type='hidden' name='wpsc_update_location' value='true' />
                  <input type='submit' name='wpsc_submit_zipcode' value='<?php esc_attr_e( 'Calculate', 'wpsc' ); ?>' />
               </form>
            </td>
         </tr>
         <?php if (wpsc_have_morethanone_shipping_quote()) :?>
            <?php while (wpsc_have_shipping_methods()) : wpsc_the_shipping_method(); ?>
                  <?php    if (!wpsc_have_shipping_quotes()) { continue; } // Don't display shipping method if it doesn't have at least one quote ?>
                  <tr class='wpsc_shipping_header'><td class='shipping_header' colspan='5'><?php echo wpsc_shipping_method_name().__(' - Choose a Shipping Rate', 'wpsc'); ?> </td></tr>
                  <?php while (wpsc_have_shipping_quotes()) : wpsc_the_shipping_quote();  ?>
                     <tr class='<?php echo wpsc_shipping_quote_html_id(); ?>'>
                        <td class='wpsc_shipping_quote_name wpsc_shipping_quote_name_<?php echo wpsc_shipping_quote_html_id(); ?>' colspan='3'>
                           <label for='<?php echo wpsc_shipping_quote_html_id(); ?>'><?php echo wpsc_shipping_quote_name(); ?></label>
                        </td>
                        <td class='wpsc_shipping_quote_price wpsc_shipping_quote_price_<?php echo wpsc_shipping_quote_html_id(); ?>' style='text-align:center;'>
                           <label for='<?php echo wpsc_shipping_quote_html_id(); ?>'><?php echo wpsc_shipping_quote_value(); ?></label>
                        </td>
                        <td class='wpsc_shipping_quote_radio wpsc_shipping_quote_radio_<?php echo wpsc_shipping_quote_html_id(); ?>' style='text-align:center;'>
                           <?php if(wpsc_have_morethanone_shipping_methods_and_quotes()): ?>
                              <input type='radio' id='<?php echo wpsc_shipping_quote_html_id(); ?>' <?php echo wpsc_shipping_quote_selected_state(); ?>  onclick='switchmethod("<?php echo wpsc_shipping_quote_name(); ?>", "<?php echo wpsc_shipping_method_internal_name(); ?>")' value='<?php echo wpsc_shipping_quote_value(true); ?>' name='shipping_method' />
                           <?php else: ?>
                              <input <?php echo wpsc_shipping_quote_selected_state(); ?> disabled='disabled' type='radio' id='<?php echo wpsc_shipping_quote_html_id(); ?>'  value='<?php echo wpsc_shipping_quote_value(true); ?>' name='shipping_method' />
                                 <?php wpsc_update_shipping_single_method(); ?>
                           <?php endif; ?>
                        </td>
                     </tr>
                  <?php endwhile; ?>
            <?php endwhile; ?>
         <?php endif; ?>

         <?php wpsc_update_shipping_multiple_methods(); ?>

         <?php if (!wpsc_have_shipping_quote()) : // No valid shipping quotes ?>
               </table>
               </div>
            </div>
            <?php return; ?>
         <?php endif; ?>
      </table>
   <?php endif;  ?>

   <?php
      $wpec_taxes_controller = new wpec_taxes_controller();
      if($wpec_taxes_controller->wpec_taxes_isenabled()):
   ?>
      <table class="productcart">
         <tr class="total_price total_tax">
            <td colspan="3">
               <?php echo wpsc_display_tax_label(true); ?>
            </td>
            <td colspan="2">
               <span id="checkout_tax" class="pricedisplay checkout-tax"><?php echo wpsc_cart_tax(); ?></span>
            </td>
         </tr>
      </table>

   <?php endif; ?>
   <?php do_action('wpsc_before_form_of_shopping_cart'); ?>

    <?php if( ! empty( $wpsc_registration_error_messages ) ): ?>
        <p class="validation-error">
        <?php
        foreach( $wpsc_registration_error_messages as $user_error )
         echo $user_error."<br />\n";
        ?>
    <?php endif; ?>

    <?php if ( wpsc_show_user_login_form() && !is_user_logged_in() ): ?>
            <p><?php _e('You must sign in or register with us to continue with your purchase', 'wpsc');?></p>

<!--SOCIAL MEDIA CONNECT BUTTONS-->
<div>
<br>Make It Easy With Facebook and Twitter Connect. <br>
<a href="http://a1decals.com/wp-login.php?loginFacebook=1&redirect=http://a1decals.com" onclick="window.location = 'http://a1decals.com/wp-login.php?loginFacebook=1&redirect='+window.location.href; return false;"> <img src="http://a1decals.com/wp-content/uploads/2013/02/facebook_connect1.png" /> </a>
<a href="http://a1decals.com/wp-login.php?loginTwitter=1&redirect=http://a1decals.com" onclick="window.location = 'http://a1decals.com/wp-login.php?loginTwitter=1&redirect='+window.location.href; return false;"> <img src="http://a1decals.com/wp-content/uploads/2013/02/twitter_connect_button.gif" /> </a></div>

            <div class="wpsc_registration_form">

                <fieldset class='wpsc_registration_form'>
                    <h2><?php _e( 'Sign in', 'wpsc' ); ?></h2>
                    <?php
                    $args = array(
                        'remember' => false,
                        'redirect' => home_url( $_SERVER['REQUEST_URI'] )
                    );
                    wp_login_form( $args );
                    ?>
                    <div class="wpsc_signup_text"><?php _e('If you have bought from us before please sign in here to purchase', 'wpsc');?></div>
                </fieldset>
            </div>
    <?php endif; ?>
   <table class='wpsc_checkout_table wpsc_checkout_table_totals'>
      <?php if(wpsc_uses_shipping()) : ?>
          <tr class="total_price total_shipping">
             <td class='wpsc_totals'>
                <?php _e('Total Shipping:', 'wpsc'); ?>
             </td>
             <td class='wpsc_totals'>
                <span id="checkout_shipping" class="pricedisplay checkout-shipping"><?php echo wpsc_cart_shipping(); ?></span>
             </td>
          </tr>
      <?php endif; ?>

     <?php if(wpsc_uses_coupons() && (wpsc_coupon_amount(false) > 0)): ?>
      <tr class="total_price">
         <td class='wpsc_totals'>
            <?php _e('Discount:', 'wpsc'); ?>
         </td>
         <td class='wpsc_totals'>
            <span id="coupons_amount" class="pricedisplay"><?php echo wpsc_coupon_amount(); ?></span>
          </td>
         </tr>
     <?php endif ?>

   <tr class='total_price'>
      <td class='wpsc_totals'>
      <?php _e('Total Price:', 'wpsc'); ?>
      </td>
      <td class='wpsc_totals'>
         <span id='checkout_total' class="pricedisplay checkout-total"><?php echo wpsc_cart_total(); ?></span>
      </td>
   </tr>
   </table>

    <form class='wpsc_checkout_forms' action='<?php echo esc_url( get_option( 'shopping_cart_url' ) ); ?>' method='post' enctype="multipart/form-data">
      <?php
      /**
       * Both the registration forms and the checkout details forms must be in the same form element as they are submitted together, you cannot have two form elements submit together without the use of JavaScript.
      */
      ?>

    <?php if(wpsc_show_user_login_form()):
          global $current_user;
          get_currentuserinfo();   ?>

        <div class="wpsc_registration_form">

            <fieldset class='wpsc_registration_form wpsc_right_registration'>
                <h2><?php _e('Join up now', 'wpsc');?></h2>

                <label><?php _e('Username:', 'wpsc'); ?></label>
                <input type="text" name="log" id="log" value="" size="20"/><br/>

                <label><?php _e('Password:', 'wpsc'); ?></label>
                <input type="password" name="pwd" id="pwd" value="" size="20" /><br />

                <label><?php _e('E-mail', 'wpsc'); ?>:</label>
                <input type="text" name="user_email" id="user_email" value="" size="20" /><br />
                <div class="wpsc_signup_text"><?php _e('Signing up is free and easy! please fill out your details your registration will happen automatically as you checkout. Don\'t forget to use your details to login with next time!', 'wpsc');?></div>
            </fieldset>

        </div>
        <div class="clear"></div>
   <?php endif; // closes user login form
      $misc_error_messages = wpsc_get_customer_meta( 'checkout_misc_error_messages' );
      if( ! empty( $misc_error_messages ) ): ?>
         <div class='login_error'>
            <?php foreach( $misc_error_messages as $user_error ){?>
               <p class='validation-error'><?php echo $user_error; ?></p>
               <?php } ?>
         </div>

      <?php
      endif;
      ?>
<?php ob_start(); ?>
   <table class='wpsc_checkout_table table-1'>
      <?php $i = 0;
      while (wpsc_have_checkout_items()) : wpsc_the_checkout_item(); ?>

        <?php if(wpsc_checkout_form_is_header() == true){
               $i++;
               //display headers for form fields ?>
               <?php if($i > 1):?>
                  </table>
                  <table class='wpsc_checkout_table table-<?php echo $i; ?>'>
               <?php endif; ?>

               <tr <?php echo wpsc_the_checkout_item_error_class();?>>
                  <td <?php wpsc_the_checkout_details_class(); ?> colspan='2'>
                     <h4><font color="#1956cf"><?php echo wpsc_checkout_form_name();?></h4>
                  </td>
               </tr>
               <?php if(wpsc_is_shipping_details()):?>
               <tr class='same_as_shipping_row'>
                  <td colspan ='2'>
                  <?php $checked = '';
                  $shipping_same_as_billing = wpsc_get_customer_meta( 'shipping_same_as_billing' );
                  if(isset($_POST['shippingSameBilling']) && $_POST['shippingSameBilling'])
                     $shipping_same_as_billing = true;
                  elseif(isset($_POST['submit']) && !isset($_POST['shippingSameBilling']))
                    $shipping_same_as_billing = false;
                  wpsc_update_customer_meta( 'shipping_same_as_billing', $shipping_same_as_billing );
                    if( $shipping_same_as_billing )
                        $checked = 'checked="checked"';
                   ?>
                    <label for='shippingSameBilling'><?php _e('Same as billing address:','wpsc'); ?></label>
                    <input type='checkbox' value='true' name='shippingSameBilling' id='shippingSameBilling' <?php echo $checked; ?> />
                    <br/><span id="shippingsameasbillingmessage"><?php _e('Your order will be shipped to the billing address', 'wpsc'); ?></span>
                  </td>
               </tr>
               <?php endif;

            // Not a header so start display form fields
            }elseif(wpsc_disregard_shipping_state_fields()){
            ?>
               <tr class='wpsc_hidden'>
                  <td class='<?php echo wpsc_checkout_form_element_id(); ?>'>
                     <label for='<?php echo wpsc_checkout_form_element_id(); ?>'>
                     <?php echo wpsc_checkout_form_name();?>
                     </label>
                  </td>
                  <td>
                     <?php echo wpsc_checkout_form_field();?>
                      <?php if(wpsc_the_checkout_item_error() != ''): ?>
                             <p class='validation-error'><?php echo wpsc_the_checkout_item_error(); ?></p>
                     <?php endif; ?>
                  </td>
               </tr>
            <?php
            }elseif(wpsc_disregard_billing_state_fields()){
            ?>
               <tr class='wpsc_hidden'>
                  <td class='<?php echo wpsc_checkout_form_element_id(); ?>'>
                     <label for='<?php echo wpsc_checkout_form_element_id(); ?>'>
                     <?php echo wpsc_checkout_form_name();?>
                     </label>
                  </td>
                  <td>
                     <?php echo wpsc_checkout_form_field();?>
                      <?php if(wpsc_the_checkout_item_error() != ''): ?>
                             <p class='validation-error'><?php echo wpsc_the_checkout_item_error(); ?></p>
                     <?php endif; ?>
                  </td>
               </tr>
            <?php
            }elseif( $wpsc_checkout->checkout_item->unique_name == 'billingemail'){ ?>
               <?php $email_markup =
               "<div class='wpsc_email_address'>
                  <p class='" . wpsc_checkout_form_element_id() . "'>
                     <label class='wpsc_email_address' for='" . wpsc_checkout_form_element_id() . "'>
                     " . __('Enter your email address', 'wpsc') . "
                     </label>
                  <p class='wpsc_email_address_p'>
                  <img src='https://secure.gravatar.com/avatar/empty?s=60&amp;d=mm' id='wpsc_checkout_gravatar' />
                  " . wpsc_checkout_form_field();

                   if(wpsc_the_checkout_item_error() != '')
                      $email_markup .= "<p class='validation-error'>" . wpsc_the_checkout_item_error() . "</p>";
               $email_markup .= "</div>";
             }else{ ?>
            <tr>
               <td class='<?php echo wpsc_checkout_form_element_id(); ?>'>
                  <label for='<?php echo wpsc_checkout_form_element_id(); ?>'>
                  <?php echo wpsc_checkout_form_name();?>
                  </label>
               </td>
               <td>
                  <?php echo wpsc_checkout_form_field();?>
                   <?php if(wpsc_the_checkout_item_error() != ''): ?>
                          <p class='validation-error'><?php echo wpsc_the_checkout_item_error(); ?></p>
                  <?php endif; ?>
               </td>
            </tr>

         <?php }//endif; ?>

      <?php endwhile; ?>

<?php
    $buffer_contents = ob_get_contents();
    ob_end_clean();
    if(isset($email_markup))
        echo $email_markup;
    echo $buffer_contents;
?>

      <?php if (wpsc_show_find_us()) : ?>
      <tr>
         <td><label for='how_find_us'><?php _e('How did you find us' , 'wpsc'); ?></label></td>
         <td>
            <select name='how_find_us'>
               <option value='Word of Mouth'><?php _e('Word of mouth' , 'wpsc'); ?></option>
               <option value='Advertisement'><?php _e('Advertising' , 'wpsc'); ?></option>
               <option value='Internet'><?php _e('Internet' , 'wpsc'); ?></option>
               <option value='Customer'><?php _e('Existing Customer' , 'wpsc'); ?></option>
            </select>
         </td>
      </tr>
      <?php endif; ?>
      <?php do_action('wpsc_inside_shopping_cart'); ?>

      <?php  //this HTML displays activated payment gateways   ?>
      <?php if(wpsc_gateway_count() > 1): // if we have more than one gateway enabled, offer the user a choice ?>
         <tr>
         <td colspan='2' class='wpsc_gateway_container'>
            <h3><font color="#1956cf"><?php _e('Payment Type', 'wpsc');?></font></h3>
            <?php while (wpsc_have_gateways()) : wpsc_the_gateway(); ?>
               <div class="custom_gateway">
                     <label><input type="radio" value="<?php echo wpsc_gateway_internal_name();?>" <?php echo wpsc_gateway_is_checked(); ?> name="custom_gateway" class="custom_gateway"/><?php echo wpsc_gateway_name(); ?>
                        <?php if( wpsc_show_gateway_image() ): ?>
                        <img src="<?php echo wpsc_gateway_image_url(); ?>" alt="<?php echo wpsc_gateway_name(); ?>" style="position:relative; top:5px;" />
                        <?php endif; ?>
                     </label> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-23T19:20:20.457

我有一个类似的问题，wordpres 不断向数据库添加两次并发送两次电子邮件，在数周内找不到解决方案后，我终于找到了一些与不正确的 html 有关的答案，最终结果是围绕 php 的表就是这样，我不知道为什么，但是一旦我**用 div 替换了表格，**它就完全正常了。尽管我检查了表格，并且它似乎构造正确，但我猜这可能是由于表格而发生的某种 wordpress 缺陷。我知道这没有意义，但就我而言，这是解决方案，所以我强烈建议你用 div 替换表格，希望这对你有用。祝你好运，希望能解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-03T00:03:51.133

你可以通过会话绕过它

```
<?php
add_action('init','my');
function my()
{

    session_start();

    if( ! isset( $_SESSION['okay'] ) )
    {
        $obj = new Hasan;

        $obj->title = "we will we will rock you";

        $obj->save();

        $_SESSION['okay'] = 'okay';
    }

    else
    {
    unset($_SESSION['okay']);
    }

 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T12:51:17.650

未测试：

```
<?php // This is used to fix the hook being called twice incorrectly ?>
<?php global $receivedItemHooks ?>
<?php if (!$receivedItemHooks) $receivedItemHooks = array() ?>

<?php if (!isset($receivedItemHooks[wpsc_the_cart_item_key()]): ?>

    <!-- Your HTML goes here -->

    <?php // Mark the item as rendered ?>
    <?php $receivedItemHooks[wpsc_the_cart_item_key()] = true ?>
<?php endif ?> 
```

这依赖于`wpsc_the_cart_item_key()`为每个购物篮项目返回唯一引用的函数（不是产品代码，因为如果将产品作为两个单独的项目而不是数量为 2 的一个项目添加到购物篮中，这将不是唯一的）。

这应该是一个好的开始，但不要害怕修改和调试！

# node.js - MongoDB：将引用文档的集合复制为子文档

> ID：14967705
> 
> 赞同：0
> 
> 时间：2013-02-19T21:23:49.043
> 
> 标签：node.js, mongodb, mongoose, mongohq

我在设计方案时犯了一个错误，因此我有两个集合，其中一个的文档包含对另一个的手动引用。我现在意识到我应该创建它，以便父集合包含另一个集合作为子文档。

问题是，我已经把这个方案放到了一个已经创建了数百个条目的生产环境中。我想做的是以某种方式扫描所有现有数据，并将这些项目复制到它们引用的 parent_id 作为子文档。

这是我的架构示例：

**集合 1 - 用户**

```
_id
Name 
```

**收藏 2 - 照片**

```
_id
url
user_id 
```

有没有一种快速的方法可以将现有文档更改为这样的一个集合：

**集合 - 用户**

```
_id
Name
Photos: [...] 
```

正确设置数据库后，我可以轻松修改代码以使用新代码，但我遇到的问题是弄清楚如何快速/按程序将文档复制到其父级。

更多细节 - 我正在使用 MongoHQ.com 来托管我的 MongoDB。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:20:59.397

我不知道您的环境的具体情况，但这种更改通常涉及以下几种步骤：

1.  `Photos`如果User 对象中有一个数组，请确保您的旧代码不会报错。
2.  “冻结”应用程序，以便不创建新文件`User`和文档`Photo`
3.  `Photo`运行将文档复制到 User的迁移脚本`documents`。这应该很容易在 javaScript 或使用驱动程序的应用程序代码中创建（参见下面的示例）
4.  部署期望`Photos`嵌入到阵列中的应用程序的新版本
5.  “解冻”应用程序以开始创建新文档

如果您无法“冻结/解冻”，则需要在第 4 步之后运行一个增量脚本，该脚本将`Photo`在部署新应用程序后迁移新创建的文档。

该脚本将如下所示（未经测试）：

```
db.User.find().forEach(function (u) {
    u.Photos = new Array();
    db.Photo.find({user_id : u._id}).forEach(function (p) {
        u.Photos.push(p);
    }
    db.User.Save(u);
} 
```

# c# - 发送到备用电子邮件地址的通知

> ID：14967712
> 
> 赞同：2
> 
> 时间：2013-02-19T21:24:19.187
> 
> 标签：c#, asp.net, asp.net-mvc-3, smtp

我正在尝试编写一个简单的表单，它将通过 SMTP 将系统电子邮件发送给他们从 ASP.NET MVC3 Web 应用程序中的通用电子邮件帐户中选择的各种用户。此帐户目前是 gmail 帐户，但一旦我们发布此项目，可能会更改为另一个域。

除了用于发送 ASP.NET 中可用的电子邮件的通用电子邮件帐户之外，有没有办法将传递失败通知电子邮件发送到任何电子邮件地址？

这是我使用的代码。我已经尝试了一些涉及标头的解决方案，但没有取得太大的成功。例如，我尝试发送传递失败通知电子邮件的电子邮件地址是 test@email.com（要使用的实际地址将从用户登录中提取）

```
MailMessage mail = new MailMessage();
mail.From = new MailAddress(ConfigurationManager.AppSettings["Mailer.Smtp.User"], "Mailer");

mail.To.Add(to);
mail.Subject = Subject;
mail.Body = Body;
mail.IsBodyHtml = true; // to incorporate the editor into it
mail.ReplyToList.Add(new MailAddress(From));
mail.ReplyTo = new MailAddress(From);
mail.DeliveryNotificationOptions = DeliveryNotificationOptions.OnFailure;
mail.Headers.Add("Read-Receipt-To", "test@email.com");
mail.Headers.Add("Disposition-Notification-To", "test@email.com");

SmtpServer.Send(mail); 
```

# objective-c - Graph 不适用于 CorePlot

> ID：14967714
> 
> 赞同：1
> 
> 时间：2013-02-19T21:24:27.827
> 
> 标签：objective-c, plot, core-plot

我从示例“CPTTestApp-iPhone”中获取了代码。应通过调用一种方法来绘制完整的图。我刚刚更改了 HostingView 的实现。它通过“addSubview”添加到另一个视图。

轴工作完美，但没有显示图表。

与财产

```
@property (nonatomic, strong) CPTGraphHostingView *HostingView; 
```

绘制情节的方法

```
 -(void)createPlot{

CGRect frame = CGRectMake(0,0,500,500);
self.HostingView = [(CPTGraphHostingView *) [CPTGraphHostingView alloc] initWithFrame:frame];

CPTXYGraph *graph = [[CPTXYGraph alloc] initWithFrame:CGRectZero];
CPTTheme *theme = [CPTTheme themeNamed:kCPTDarkGradientTheme];
[graph applyTheme:theme];

self.HostingView.hostedGraph   = graph;

[self.AnotherView addSubview:self.HostingView];

// Create graph from theme
graph.paddingLeft   = 10.0;
graph.paddingTop    = 10.0;
graph.paddingRight  = 10.0;
graph.paddingBottom = 10.0;

// Setup plot space
CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *)graph.defaultPlotSpace;
plotSpace.allowsUserInteraction = YES;
plotSpace.xRange                = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(1.0) length:CPTDecimalFromFloat(2.0)];
plotSpace.yRange                = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(1.0) length:CPTDecimalFromFloat(3.0)];

// Axes
CPTXYAxisSet *axisSet = (CPTXYAxisSet *)graph.axisSet;
CPTXYAxis *x          = axisSet.xAxis;
x.majorIntervalLength         = CPTDecimalFromString(@"0.5");
x.orthogonalCoordinateDecimal = CPTDecimalFromString(@"2");
x.minorTicksPerInterval       = 2;
NSArray *exclusionRanges = [NSArray arrayWithObjects:
                            [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(1.99) length:CPTDecimalFromFloat(0.02)],
                            [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0.99) length:CPTDecimalFromFloat(0.02)],
                            [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(2.99) length:CPTDecimalFromFloat(0.02)],
                            nil];
x.labelExclusionRanges = exclusionRanges;

CPTXYAxis *y = axisSet.yAxis;
y.majorIntervalLength         = CPTDecimalFromString(@"0.5");
y.minorTicksPerInterval       = 5;
y.orthogonalCoordinateDecimal = CPTDecimalFromString(@"2");
exclusionRanges               = [NSArray arrayWithObjects:
                                 [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(1.99) length:CPTDecimalFromFloat(0.02)],
                                 [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0.99) length:CPTDecimalFromFloat(0.02)],
                                 [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(3.99) length:CPTDecimalFromFloat(0.02)],
                                 nil];
y.labelExclusionRanges = exclusionRanges;
y.delegate             = self;

// Create a blue plot area
CPTScatterPlot *boundLinePlot  = [[CPTScatterPlot alloc] init];
CPTMutableLineStyle *lineStyle = [CPTMutableLineStyle lineStyle];
lineStyle.miterLimit        = 1.0f;
lineStyle.lineWidth         = 3.0f;
lineStyle.lineColor         = [CPTColor blueColor];
boundLinePlot.dataLineStyle = lineStyle;
boundLinePlot.identifier    = @"Blue Plot";
boundLinePlot.dataSource    = self;
[graph addPlot:boundLinePlot];

// Do a blue gradient
CPTColor *areaColor1       = [CPTColor colorWithComponentRed:0.3 green:0.3 blue:1.0 alpha:0.8];
CPTGradient *areaGradient1 = [CPTGradient gradientWithBeginningColor:areaColor1 endingColor:[CPTColor clearColor]];
areaGradient1.angle = -90.0f;
CPTFill *areaGradientFill = [CPTFill fillWithGradient:areaGradient1];
boundLinePlot.areaFill      = areaGradientFill;
boundLinePlot.areaBaseValue = [[NSDecimalNumber zero] decimalValue];

// Add plot symbols
CPTMutableLineStyle *symbolLineStyle = [CPTMutableLineStyle lineStyle];
symbolLineStyle.lineColor = [CPTColor blackColor];
CPTPlotSymbol *plotSymbol = [CPTPlotSymbol ellipsePlotSymbol];
plotSymbol.fill          = [CPTFill fillWithColor:[CPTColor blueColor]];
plotSymbol.lineStyle     = symbolLineStyle;
plotSymbol.size          = CGSizeMake(10.0, 10.0);
boundLinePlot.plotSymbol = plotSymbol;

// Create a green plot area
CPTScatterPlot *dataSourceLinePlot = [[CPTScatterPlot alloc] init];
lineStyle                        = [CPTMutableLineStyle lineStyle];
lineStyle.lineWidth              = 3.f;
lineStyle.lineColor              = [CPTColor greenColor];
lineStyle.dashPattern            = [NSArray arrayWithObjects:[NSNumber numberWithFloat:5.0f], [NSNumber numberWithFloat:5.0f], nil];
dataSourceLinePlot.dataLineStyle = lineStyle;
dataSourceLinePlot.identifier    = @"Green Plot";
dataSourceLinePlot.dataSource    = self;

// Put an area gradient under the plot above
CPTColor *areaColor       = [CPTColor colorWithComponentRed:0.3 green:1.0 blue:0.3 alpha:0.8];
CPTGradient *areaGradient = [CPTGradient gradientWithBeginningColor:areaColor endingColor:[CPTColor clearColor]];
areaGradient.angle               = -90.0f;
areaGradientFill                 = [CPTFill fillWithGradient:areaGradient];
dataSourceLinePlot.areaFill      = areaGradientFill;
dataSourceLinePlot.areaBaseValue = CPTDecimalFromString(@"1.75");

// Animate in the new plot, as an example
dataSourceLinePlot.opacity = 0.0f;
[graph addPlot:dataSourceLinePlot];

CABasicAnimation *fadeInAnimation = [CABasicAnimation animationWithKeyPath:@"opacity"];
fadeInAnimation.duration            = 1.0f;
fadeInAnimation.removedOnCompletion = NO;
fadeInAnimation.fillMode            = kCAFillModeForwards;
fadeInAnimation.toValue             = [NSNumber numberWithFloat:1.0];
[dataSourceLinePlot addAnimation:fadeInAnimation forKey:@"animateOpacity"];

// Add some initial data
NSMutableArray *contentArray = [NSMutableArray arrayWithCapacity:100];
NSUInteger i;
for ( i = 0; i < 60; i++ ) {
    id x = [NSNumber numberWithFloat:1 + i * 0.05];
    id y = [NSNumber numberWithFloat:1.2 * rand() / (float)RAND_MAX + 1.2];
    [contentArray addObject:[NSMutableDictionary dictionaryWithObjectsAndKeys:x, @"x", y, @"y", nil]];
}
self.dataForPlot = contentArray;

#ifdef PERFORMANCE_TEST
[NSTimer scheduledTimerWithTimeInterval:2.0 target:self selector:@selector(changePlotRange) userInfo:nil repeats:YES];

#endif
} 
```

和方法

```
-(NSUInteger)numberOfRecordsForPlot:(CPTPlot *)plot
{
return [dataForPlot count];
}

-(NSNumber *)numberForPlot:(CPTPlot *)plot field:(NSUInteger)fieldEnum recordIndex:    (NSUInteger)index
{
...
}

-(BOOL)axis:(CPTAxis *)axis shouldUpdateAxisLabelsAtLocations:(NSSet *)locations
{
....
} 
```

# objective-c - if-else 条件 - 如何“返回”到外部分支？

> ID：14967723
> 
> 赞同：-3
> 
> 时间：2013-02-19T21:25:13.487
> 
> 标签：objective-c, if-statement, syntax

我有以下代码：

```
if (condition1)
{
   if (condition2)
   {
      Do sth.
   }
   else if (condition3)
   {
      Do sth.
   }
   else
   {
      // get back to check condition4.
   }
}
else if (condition4)
{
   Do sth.
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:26:55.677

```
if (condition1 && (condition2 || condition3))
{
    if (condition2)
    {
        Do sth.
    }
    else if (condition3)
    {
        Do sth.
    }
}
else if (condition4)
{
   Do sth.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:27:49.880

```
BOOL someCondition;
if (condition1)
{
   if (condition2)
   {
      //Do sth.
   }
   else if (condition3)
   {
      //Do sth.
   }
   else
   {
      // get back to check condition4.
      someCondition = YES;
   }
}
if (condition4 && someCondition)
{
   //Do sth.
} 
```

# c - c中的日历与最后一行的总和

> ID：14967728
> 
> 赞同：-1
> 
> 时间：2013-02-19T21:25:32.583
> 
> 标签：c, arrays, calendar, sum

我正在尝试制作一个一个月的日历来打印最后一行天的总和。

这个输出对于日历是正确的，但是总和不断打印出它是 0。对于 3=day_of_week 和 30=days_in_month 的输入，总和应该是 26+27+28+29+30 = 140

谢谢。

```
int main() {

int day_of_week, days_in_month, i, row=1, array[31], sum=0, a;

printf("Enter the day of the week 1=sun, 2=mon, 3=tue, 4=wed, 5=thurs, 6=fri, 7=sat\n");
scanf("%d", &day_of_week);

printf("Enter the number of days in this month:\n");
scanf("%d", &days_in_month);

for (i=0; i<3*day_of_week; i++)
    printf(" ");

for (i=1; i<=days_in_month; i++) {

    printf("%3d", i);
    array[i] = i;

    day_of_week++;

    if (day_of_week%7==0){
        printf("\n");
    }

}
    printf("\n");
    for (a=days_in_month; a>=(days_in_month-(7-day_of_week)); a--)
        sum+=array[a];

printf("sum of last row is %d\n", sum);

return 0; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:30:34.563

你有

```
for (a=days_in_month; a>=(days_in_month-(7-day_of_week)); a--) 
```

但`day_of_week`不会在您的程序中保持不变，并且在此语句之前会发生更改：

`day_of_week++;`

使用第二个变量来增加并且不要修改`day_of_week`after `scanf`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:35:35.080

这里有一个问题：

```
for (i=1; i<=days_in_month; i++) {

    printf("%3d", i);
    array[i] = i;

    day_of_week++;

    if (day_of_week%7==0){
        printf("\n");
    }

} 
```

您允许`day_of_week`超出范围。您的代码期望该值不超过 7。此循环将导致该变量设置为用户输入的值加 ( `days_in_month`- 1)。在您的最后一个`for`循环中，该语句`7 - day_of_week`可能是否定的，这将丢弃您的其余代码。

当您测试变量模 7 并打印换行符时，您是在检查溢出。当你这样做时，也要设置`day_of_week = 0`。

此外，`(days_in_month-(7-day_of_week))`一旦您从用户那里获得输入，就立即计算并将其存储在一个临时变量中。由于您在代码中操作这些变量，因此您的最终`for`循环可能没有使用您认为它正在使用的值。或者，不要修改用于用户输入的变量并创建其他变量以用作临时变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T21:35:37.783

我不明白你为什么要这样做**++day_of_week**，

这样的事情应该会更好：

```
int main()
{
    int day_of_week, days_in_month, i, row=1, array[31], sum=0, a;

    printf("Enter the day of the week 1=sun, 2=mon, 3=tue, 4=wed, 5=thurs, 6=fri,     7=sat\n");
    scanf("%d", &day_of_week);

    printf("Enter the number of days in this month:\n");
    scanf("%d", &days_in_month);

    for (i = 0; i < 3 * day_of_week; i++)
        printf(" ");
    for (i = 1; i <= days_in_month; i++)
    {
        printf("%3d", i);
        array[i] = i;
        if (i % 7 == 0)
            printf("\n");
    }
    printf("\n");
    for (a=days_in_month; a>=(days_in_month-(7-day_of_week)); a--)
        sum+=array[a];
    printf("sum of last row is %d\n", sum);
    return 0;
} 
```

# asp.net - 带有网格视图的 InvalidOperationException

> ID：14967729
> 
> 赞同：0
> 
> 时间：2013-02-19T21:25:37.590
> 
> 标签：asp.net

我想要完成的事情非常简单。我在 Web 表单上有一个下拉列表。该列表显示可用的作业编号。在此之下，我有一个网格视图，它显示基于当前下拉列表值的查询结果。

这是 aspx.cs 的形式

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace SHCInvoiceEntry
{
    public partial class WebForm1 : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
           MasterDataDataContext db = new  MasterDataDataContext();

            var query = from m in db.MasterData2s 
                        select m;

            GridView1.DataSource = query;

        }
    } 
```

这是错误消息：

## “/”应用程序中的服务器错误。

DataSource 和 DataSourceID 都在“GridView1”上定义。删除一个定义。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.InvalidOperationException：DataSource 和 DataSourceID 均在“GridView1”上定义。删除一个定义。

```
Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace: 

[InvalidOperationException: Both DataSource and DataSourceID are defined on 'GridView1'.  Remove one definition.]
   System.Web.UI.WebControls.DataBoundControl.ConnectToDataSourceView() +8575525
   System.Web.UI.WebControls.DataBoundControl.OnLoad(EventArgs e) +19
   System.Web.UI.Control.LoadRecursive() +50
   System.Web.UI.Control.LoadRecursive() +141
   System.Web.UI.Control.LoadRecursive() +141
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +627

--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:2.0.50727.5466; ASP.NET Version:2.0.50727.5456 
```

我不确定如何删除数据源或数据源 ID。我对下拉列表和网格视图使用相同的数据源。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:40:35.530

试试下面的代码

```
GridView1.DataSourceID = string.Empty; 
```

或者从属性窗口中删除 DatasourceId。

让我知道它是否对您有帮助。

# c# - 得到；设置；使用 DateTime 验证 .TryParse？

> ID：14967731
> 
> 赞同：1
> 
> 时间：2013-02-19T21:25:39.963
> 
> 标签：c#, properties, get, set

我正在尝试将输入数据的验证移至 get;set; 一个类结构。

```
public void PlotFiles()
    {

     List<DTVitem.item> dataitems;
        DTVitem.item i;
        DateTime.TryParse("2012/01/01", out i.dt);
        DateTime.TryParse("04:04:04", out i.t);
        int.TryParse("455", out i.v);
        dataitems.Add(i);

    } 
```

该结构在一个单独的类中声明（可能没有必要）：

```
public partial class DTVitem
{
    public struct item
    {
        public DateTime dt;
        public DateTime t;
        public int v;
    }
} 
```

每次我设置`DTVitem.item.dt`, `DTVitem.item.t`, 或`DTVitem.item.v`时，我希望它执行相关`.TryParse()`来验证属性内容。

但是，当我尝试按如下方式使用 TryParse() 时（试图[从 MSDN 中绕过这个示例](http://msdn.microsoft.com/en-us/library/x9fsa0sw.aspx)）：

```
public partial class DTVitem
{
    private DateTime _datevalue;

    public string dt
    {
        get { return _datevalue; }
        set { DateTime.TryParse(value, out _datevalue) ;}
    }
} 
```

我收到错误消息`_datevalue is a DateTime and cannot be converted to a string`。原因显然是返回路径必须返回`dt`此实例中的类型 (a `string`)。但是，我尝试了几种不同的方式来按摩它，但无法破解它。

在将值设置为结构实例的属性时，如何实现将`string`值验证为 a 的目标？`DateTime`

正在使用`set`我正在尝试的最佳方式吗？

我可以看到使用 get;set; 有很多价值。进行验证，并且真的很想了解它。

非常感谢，

马特

**[编辑]**

感谢下面的[Jon Skeet](https://stackoverflow.com/users/22656/jon-skeet)指出了我的错误。

[这是关于可变结构问题的另一个线程](https://stackoverflow.com/questions/441309/why-are-mutable-structs-evil)，[另一个关于实例化结构的讨论](https://stackoverflow.com/questions/7767669/why-is-it-possible-to-instantiate-a-struct-without-the-new-keyword)。注意[结构是值类型](http://msdn.microsoft.com/en-us/library/s1ax56ch.aspx)。

我相信他所指出的其余部分只是同意将结构埋得很远是没有必要的，我应该回顾一下我为什么要这样做。

**[解决方案]**

我考虑了以下一些建议并提出以下建议：

```
public partial class DTVitem
{
    private DateTime _dtvalue, _tvalue;
    private int _vvalue;

    public string dt
    {
        get { return _dtvalue.ToString(); }
        set { DateTime.TryParse(value, out _dtvalue); }
    }

    public string t
    {
        get { return _tvalue.ToString(); }
        set { DateTime.TryParse(value, out _tvalue); }
    }

    public string v
    {
        get { return _vvalue.ToString(); }
        set { int.TryParse(value, out _vvalue); }
    }
} 
```

在我的程序类中，我已经实例化并设置了以下内容：

```
DTVitem item = new DTVitem();
item.dt = "2012/01/01";
item.t = "04:04:04";
item.v = "455"; 
```

所以我选择不使用结构，而是使用类；或者真的是类的一个实例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:30:23.200

一个属性只能有一种类型。如果你希望属性是字符串类型，那么你可以这样实现它：

```
public partial class DTVitem
{
    private DateTime _datevalue;

    public string dt
    {
        get { return _datevalue.ToString(); }
        set { DateTime.TryParse(value, out _datevalue) ;}
    }
} 
```

但是，使用 TryParse() 意味着如果 DateTime 无效，setter 将不会抛出异常。如果您希望它这样做，请改用 DateTime.Parse()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:30:34.433

```
public partial class DTVitem
{
    private DateTime _datevalue;

    public string dt
    {
        get { return _datevalue.ToString(); }
        set { DateTime.TryParse(value, out _datevalue) ;}
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T21:32:18.983

您只是缺少 get 中的类型转换。_datevalue 是 DateTime 但您的属性是字符串。

```
get { return _datevalue.ToString(); } //or .toShortDateString() or ToShorttimeString() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T21:32:04.037

得到；设置；必须具有相同的类型。您的 get 在它需要一个字符串时返回一个日期时间，因此会出现错误。

只需使用显式方法 bool setDate(String datestring) 并将您的代码放在那里。你可以从 tryparse 返回一个布尔值，让你知道它是否成功。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-19T21:34:17.007

除了其他（主要是设计）问题，只是解决以字符串形式返回的问题`_datevalue`，您可以简单地执行以下操作：

```
public string dt
{
    get { return _datevalue.ToString(); }
    set { if(!DateTime.TryParse(value, out _datevalue)) /* Error recovery!! */ ;}
} 
```

**>>>**您可能还想查看文档`DateTime.ToString()`并查看在访问属性时要获取字符串的格式。

# python - 使用 Geany 进行 Django 调试

> ID：14967732
> 
> 赞同：1
> 
> 时间：2013-02-19T21:25:50.203
> 
> 标签：python, django, debugging, geany

今天我将 IDE 从 Gedit 更改为 Geany。
我想调试我的 django 项目，但不知道如何。
我在调试选项卡中的设置：
**目标：** /path/to/manage.py
**命令行参数：** runserver --noreload
**环境变量：**
DJANGO_SETTINGS_MODULE = settings
PYTHONPATH = *print sys.path*

当我尝试运行服务器时，出现错误：**加载错误文件**

谷歌没有帮助......

在此先感谢:)

# sharpsvn - SharpSvn：为什么跳过了从 Empty Depth Checkout 更新子文件夹？

> ID：14967735
> 
> 赞同：1
> 
> 时间：2013-02-19T21:26:09.900
> 
> 标签：sharpsvn

我在使用 SharpSvn（来自 C#）从 repo 中挑选一些文件夹时遇到了一些麻烦。我这样做了：

```
client.CheckOut( uri, dir, new SvnCheckOutArgs() { Depth = SvnDepth.Empty } );
foreach( var folder in folders )
{
   client.Update( folder );
} 
```

但我的第二个电话`Update`没有奏效。它报告该操作是**SvnNotifyAction.Skip**并且没有任何内容写入工作副本。

*uri*本质上类似于:`svn://myserver/myrepo/mysdk`和*dir*类似于`C:\Test\mysdk`. （出于这个问题的目的，我已经更改了确切的名称，但在结构上它是相同的。）

然后第一个文件夹是`C:\Test\mysdk\include`（这个工作）

然后是第二个文件夹`C:\Test\mysdk\bin\v100\x86`（这个不更新）

为什么第一个可以工作，但是当我得到第二个文件夹（嵌套子文件夹）时它没有更新？它报告它被跳过？但我不知道如何找出原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T14:09:25.977

事实证明，更新嵌套子目录不起作用，因为父目录尚不存在，因此跳过了嵌套子目录更新。为了解决这个问题，我需要向 Update 添加一个参数以指示它应该创建父目录。

（等效的 svn 命令行选项是`--parents`）。

```
client.Update( folder, new SvnUpdateArgs() { UpdateParents = true } ); 
```

我通过尝试从 svn 命令行手动执行它发现了这一点（并且遇到了同样的问题。） `svn help co`提供了这个小线索： *--parents ：制作中间目录* 我假设 UpdateParents 和 --parents 是等价的。到目前为止，一切都很好。

# clojure - 为什么 LET 不适用于 VECTOR？

> ID：14967743
> 
> 赞同：3
> 
> 时间：2013-02-19T21:26:41.250
> 
> 标签：clojure

代替

```
(let [x 1] (my-expression)) 
```

我正在尝试使用：

```
(let (vector x 1) (my-expression)) 
```

不要问为什么，我只是更喜欢普通的括号。但是 Clojure 说：

```
let requires a vector for its binding in ... 
```

怎么了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T21:33:29.920

[let 特殊形式](http://clojure.org/special_forms#Special%20Forms--%28let%20%5bbindings%2a%20%5d%20exprs%2a%29) 的[绑定形式](http://clojure.org/special_forms#binding-forms)需要是一个向量*字面*量，而不仅仅是一个将评估为向量的表达式。

为什么？粗略地说，必须先编译表达式，然后才能对其求值。在编译时`(vector x 1)`不会被评估为 a `vector`，它只是一个列表。实际上，如果要对其进行评估，则将评估 的论点，必须解决`vector`含义。`x`但是，你不想`x`被解决，你希望它被绑定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T21:39:07.493

查看宏的[来源](http://clojuredocs.org/clojure_core/clojure.core/let#source)`let`

```
(defmacro let
  "binding => binding-form init-expr

  Evaluates the exprs in a lexical context in which the symbols in
  the binding-forms are bound to their respective init-exprs or parts
  therein."
  {:added "1.0", :special-form true, :forms '[(let [bindings*] exprs*)]}
  [bindings & body]
  (assert-args let
     (vector? bindings) "a vector for its binding"
     (even? (count bindings)) "an even number of forms in binding vector")
  `(let* ~(destructure bindings) ~@body)) 
```

您会注意到，`bindings`当宏试图确保通过`assert-args`.

在 clojure 计算时`(vector? bindings)`，`bindings`是一个表单 ( `list`)，其中包含 a`fn`作为第一个元素，后跟它的参数，因此此时不是 a `vector`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-20T03:16:35.060

`let`它的绑定需要一个向量（在编译时），因此试图将向量函数调用放在它的位置是行不通的（因为这只会在运行时产生一个向量）。

但是，您可以使用一些宏来制作自己的 let：

```
(defmacro mylet [bindings & exprs]
  `(let ~(vec bindings) ~@exprs))

(mylet (x 1) (inc x))
=> 2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T21:57:28.873

例如，此代码确实有效：

```
(eval `(let ~(vector 'a 1) (println ~'a))) 
```

这意味着您可以编写自己的 let 宏来接受列表而不是向量。这对您的整体 Clojure 体验非常不利，我不建议这样做。

# java - setContentView 抛出错误 NoClassDefFoundError

> ID：14967746
> 
> 赞同：1
> 
> 时间：2013-02-19T21:26:51.553
> 
> 标签：java, android, eclipse

我在很多方面都是 Java 新手，我一生都无法弄清楚为什么在编译时找不到我的“imageactivity”布局时在运行时找不到它。该文件位于“penguinplugin/rez/layout/imageactivity.xml”...我需要在 Eclipse 或我的清单中设置什么才能找到它吗？

**注意：如果我提取我构建的 .jar 文件，它不包含“R$layout.class”。这是一个图书馆顺便说一句，不兴奋......**

我的布局 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/imageactivityID"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <SurfaceView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.86" />

    <Button
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:text="Take Picture!" />

</LinearLayout> 
```

我的活动：

```
import com.penguin.penguinplugin.R;
public class PhotoPickerActivity extends Activity implements OnClickListener
{
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        this.setContentView(R.layout.imageactivity);
    }
} 
```

抛出的异常：

```
E/AndroidRuntime( 1285): FATAL EXCEPTION: main
E/AndroidRuntime( 1285): java.lang.NoClassDefFoundError: com.penguin.penguinplugin.R$layout
E/AndroidRuntime( 1285):    at penguinplugin.PhotoPickerActivity.onCreate(PhotoPickerActivity.java:47)
E/AndroidRuntime( 1285):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
E/AndroidRuntime( 1285):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1617)
E/AndroidRuntime( 1285):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1669)
E/AndroidRuntime( 1285):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
E/AndroidRuntime( 1285):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:937)
E/AndroidRuntime( 1285):    at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime( 1285):    at android.os.Looper.loop(Looper.java:130)
E/AndroidRuntime( 1285):    at android.app.ActivityThread.main(ActivityThread.java:3692)
E/AndroidRuntime( 1285):    at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime( 1285):    at java.lang.reflect.Method.invoke(Method.java:507)
E/AndroidRuntime( 1285):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
E/AndroidRuntime( 1285):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
E/AndroidRuntime( 1285):    at dalvik.system.NativeStart.main(Native Method) 
```

**编辑：所以我认为它可能不起作用的原因是因为 Eclipse 没有将资源构建到库对象中（如果是这样，手掌）......只有一个 exe。但是因为这是一个统一插件，我只是以编程方式创建了我需要的简单视图，而不加载任何资源。所以我的问题就解决了。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:29:56.390

您需要将单个父对象添加到布局文件

这样的事情应该做：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".YourActivity" >

    <SurfaceView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="0.86" />

    <Button
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center_horizontal"
    android:text="Take Picture!" />
</LinearLayout> 
```

# ruby - 在其父类中定义子类是否非常规？

> ID：14967751
> 
> 赞同：8
> 
> 时间：2013-02-19T21:27:09.940
> 
> 标签：ruby

像下面这样在其父类下定义一个子类是惯例吗？

```
class Element

  class Div < Element

  end

  class Paragraph < Element

  end

end 
```

还是让模块包含子类更合适？

```
class Element

end

module Elements

  class Div < Element

  end

  class Paragraph < Element

  end

end 
```

或者在一个模块中创建一个“基”类并在同一个模块中定义子类？

```
module Element

  class Base

  end

  class Div < Base

  end

  class Paragraph < Base

  end

end 
```

还是强制命名约定更好？

```
class Element

end

class DivElement < Element

end

class ParagraphElement < Element

end 
```

似乎每个库都选择了不同的命名空间/命名约定。

哪个最好用？
各自的优缺点是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T16:12:59.030

**TL;DR**：最常规和最好的方法是使用包含基类及其子类的模块。但让我们回顾一下一切。

这方面的官方消息并不多。然而，使用模块来包含库、代码和类组是一种风格。

# 超类中的子类

**优点**：

*   自成一体：整个班级系统都包含在一个名称之下

**缺点：**

*   不自然：谁会想到在超类内部寻找子类？

在超类中包含子类实际上取决于情况。但是，这种方法的任何好处也可以通过模块方法来实现。但在实践中，这还没有完成。类在这里包含方法、实例变量、类方法等。但是类可以被认为是嵌套的最后一层——除非是非常特殊的情况，否则类中没有类。

我认为这是有意义的一种情况是，使用子类的唯一方法是通过超类，例如`Formatter`具有内部子类的类`XML`，如`PDF`, 等。假设您仅通过做事来使用这些类喜欢`Formatter.new(:xml)`。但是如果我们这样做，子类应该是私有的，并且无论如何都不能被外部世界访问。在这一点上，继承是一种非常 C++y 的方式，而不是 Rubyish。

# 模块外的基类，模块内的子类

**优点：**

*   我想不出任何

**缺点：**

*   暗示未连接：如果 Element 与其子项不在同一个命名空间中，那么除了名称之外，还有什么告诉我它甚至是相关的？

这种方法非常不自然。它使它看起来好像`Element`与它的子级无关，或者如果换个角度看，它的子级是不需要处理的内部实现细节。无论哪种方式，它看起来都像是破旧、草率的命名和糟糕的代码结构规划。如果我正在使用它来阅读代码，我必须查看`Elements`模块的内容以查看它`Element`是否被子类化——这不是最自然的事情。

# 模块中的类和子类（最佳解决方案）

**优点：**

*   包含：超类和所有元素类都包含在一个命名空间中，允许它们轻松导入、需要、迭代等。也有助于元编程。
*   可包含性：这些类可以很容易地`include`编辑到任何代码中。
*   清晰：与子类之间有明显的关联`Element`。它们显然是一组功能。

**缺点：**

*   鼓励懒惰的命名：这确实鼓励你给类命名，这样的东西`Base`非常模棱两可。

这是最好的方法。它使类成为一个整洁的捆绑包，同时仍然显示出明显的关联和明显的“在这里，使用我的`Div`类”（与类中的子类策略相反）。此外，这对元编程非常有帮助，在元编程中，将所有东西都放在一个模块中对于使事情正常进行至关重要。最后，这适用于 , , 等结构`autoload`。`require_relative`这些`include`表明这是该语言的设计使用方式。

# 强制命名约定

**优点：**

*   简单：这里没有复杂性。
*   消除歧义：从短名称中消除歧义，例如`Div`或`Para`通过将它们转换为`DivElement`and `ParaElement`。

**缺点：**

*   陈旧的：分组类或方法的命名约定应该只存在于没有更好方法的语言中，例如 C 或 Objective-C。C++ 在获得命名空间后立即将其删除。
*   没有程序分组：这些命名约定虽然对人类来说很清楚，但使类结构对元编程代码非常模糊，并且使程序无法将类作为一个组来处理
*   污染全局命名空间：这会在全局命名空间中创建很多很多名称，这总是一个坏主意。

这是一个*非常***非常**糟糕的解决方案。它鼓励编写草率的、缺乏组织和意义的 C 风格代码。这些命名约定只能用在没有更好解决方案的语言中，而 Ruby 有很多更好的解决方案。即使在数组中定义所有类也比命名约定要好。

注意：但是，如果你真的想要，你可以为短名称定义一个命名约定，`Div`只要`Para`你仍然将它们保留在一个模块中，这样它就是`Elements::DivElement`. 但是，这违反了 DRY，我不建议这样做。

# 结论

所以，你真的有两个选择。只需将所有内容放在一个模块中：

```
module Elements
  class Element; end
  class Div < Element; end
  #etc...
end 
```

或者，将所有内容放在具有命名约定的模块中：

```
module Elements
  class Element; end
  class DivElement < Element; end
  #etc...
end 
```

出于清晰、使用标准方法和元编程的原因，我建议使用前者。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T15:00:08.723

这是我多次遇到的问题——你有一些共享功能和几个不同的实现类使用它——共享功能和实现类的命名空间具有相同的名称是很自然的。

在您的第一个示例中，我从来没有遇到过在其父类下定义子类的问题 -*除了*它有时会混淆我团队中的其他开发人员的事实。因此，取决于您与谁一起工作以及他们的偏好是什么，我认为这种方法没有任何问题。

如果有一个有意义的名称，我仍然更喜欢第二种方法，命名空间使用不同的名称。如果没有，我会使用第一种方法。

`Base`我会避免使用像它真的属于那里。

而且我真的不喜欢您的命名约定示例中的复合名称，我用一种模糊的感觉向自己证明它就像数据库规范化 - 每个字段（或类名）应该只包含一条信息。

无论如何，我希望这对你有帮助。除了我自己的经验之外，我无法真正从任何来源中汲取经验（由您决定是否认为这是“可信的”），因为我确实认为这个问题没有绝对的答案。这在很大程度上是主观的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T21:55:45.973

命名空间和继承用于不同的目的。使用名称空间将一个模块封装在另一个模块中。使用继承来定义一个模块，使用另一个的方法/变量/常量作为默认值。

原则上，您可能希望一个模块既位于同一个模块的名称空间内又继承自同一个模块，但这取决于您的用例。如果不讨论特定的用例，就无法确定您提供的方法中哪种方法是最好的。

# ruby-on-rails - Rails：如何从 Twitter 中检索头像？

> ID：14967753
> 
> 赞同：0
> 
> 时间：2013-02-19T21:27:15.497
> 
> 标签：ruby-on-rails, ruby, twitter, avatar

在一个应用程序中，我通过 Twitter 使用身份验证，并在我存储 Twitter UID 的表中。有什么办法可以通过 Twitter UID 用户头像来显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:43:34.270

您可以使用他们的 UID 来获取他们的个人资料信息，其中包含他们图像的 URL。您可以在此处查看文档：[https ://dev.twitter.com/docs/api/1.1/get/users/show](https://dev.twitter.com/docs/api/1.1/get/users/show)

# dojo - 增强网格滚动（具有大量数据）

> ID：14967755
> 
> 赞同：1
> 
> 时间：2013-02-19T21:27:24.350
> 
> 标签：dojo, dojox.grid

我使用`dojox.grid.EnhancedGrid`的是由类创建的`MyGrid`，如下所述。

```
var MyGrid = declare(null, {
    constructor: function (app, id, opts) {
       this.id = id;
       this.app = app;
       this.core_id = app.getCoreId();

       var myStore;

       var jquery = {
         scope: 'core',
         command: 'rest',
         args: {
           resource: this.id,
           serve: 'cooked'
         },
         core_id: this.core_id
       };

       this.jsonStore = new custom.store.JsonRest({
         target: app.get_dispatcher_url(),
         jquery: jquery,
         // setstruct is an object to provide a method that sets a new
         // grid structure as soon as data arrives.
         set_structure: dojo.hitch(this, this.set_structure),
         app: this.app
       });

       // avoid closures from holding a reference
       // to jquery and preventing its GCing
       jquery = null;

       this.memoryStore = new Memory();
       myStore = new Cache(this.jsonStore, this.memoryStore);

       this.dataStore = new ObjectStore({
         objectStore: myStore,
         onSet: onEdited,
         onNew: onEdited,
         onDelete: onEdited
       });

       myStore = null;

       // create grid
       this.grid = new EnhancedGrid({
         store: this.dataStore,
         height: '100%',
         structure: [
           { name: 'Waiting for data...', field: 'no-field', width: '10em' }
         ],
         plugins: {
           menus: { rowMenu: this._create_menu() },
           nestedSorting: true,
           selector: { row: 'disabled', col: 'disabled', cell: 'multi' }
         }
       });

       // start grid
       this.grid.startup();
    }
}); 
```

请注意，我省略了代码以仅关注“网格/存储”的创建。`MyGrid`在 ContentPane 上显示网格。

所以我创建了一个对象来显示网格（有大量数据）并滚动到底部，它只会正确请求可见的行。然而，碰巧当我创建第二个网格时，它会请求第二个网格的内容**和**第一个网格的所有数据！！

这怎么可能发生？知道是什么原因造成的吗？

**已编辑（22/02/13）：**

我创建了一个 jsfiddle 来演示我遇到的问题：[请参阅 jsfiddle](http://jsfiddle.net/knokit/mYZyU/22/embedded/result/)

如何重现问题：

1.  单击*新选项卡*按钮，打开控制台并检查获取了多少行。
2.  转到网格底部（快速）并再次检查控制台。
3.  再次单击*新选项卡*，转到控制台，您可以看到之前网格中尚未加载的所有行都已获取。

**注意：**我发现这只发生在*Google Chrome*上。我用*Firefox*进行了测试，一切正常。

# c++ - 使用带有类错误的地图，编译错误

> ID：14967757
> 
> 赞同：0
> 
> 时间：2013-02-19T21:27:40.770
> 
> 标签：c++, class, map, compilation

我有以下编译器错误，我该如何解决？

```
error:  instantiated from `_Tp& std::map<_Key, _Tp, _Compare, _Alloc>::operator[](const _Key&) [with _Key = ar, _Tp = int, _Compare = std::less<ar>, _Alloc = std::allocator<std::pair<const ar, int> >]' 
```

这是代码：

```
#include <map>
#include <cstdio>
#include <iostream>
#include <algorithm>
#include <cstdlib>

using namespace std; 

class ar { 
  public:
  int a;
  int b;
  int c;
public:
  ar() : a(0), b(0), c(0) {}
};

int main() {
   map<ar, int> mapa;
   ar k;
   k.a = 6;
   k.b = 1;
   k.c = 0;
   mapa[k] = 1;

   //system("pause");
   return 0;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:33:32.353

你需要一个比较函数`map`。您可以创建`operator<`比较 的两个实例`ar`，也可以创建自定义函数并将其作为第三个模板参数传递。

前者的一个例子可能是：

```
class ar {
  ...
  bool operator<(const ar& rhs) const {
    return std::tie(a,b,c) < std::tie(rhs.a, rhs.b, rhs.c);
  }
  ...
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:33:59.817

对于[`std::map`](http://en.cppreference.com/w/cpp/container/map)您需要重载`operator<`地图的 Key 类型，因为这就是地图将元素插入其底层容器的方式。

```
class ar { 
  public:
  int a;
  int b;
  int c;
  public:
  ar() : a(0), b(0), c(0) {}
  bool operator<(const ar& other) const;
  };

bool ar::operator< (const ar& other) const // note the function has to be const!!!
{
   return (other.a < a) && (other.b < b) && (other.c < c); // or some such ordering
} 
```

重载时`operator<`，最好以类似的方式重载`operator>`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:35:48.933

`operator <`必须可用于键类型，或者您应该为映射构造函数提供比较函子。

# javascript - 类似于亚马逊的文本摘要的淡化效果？

> ID：14967758
> 
> 赞同：0
> 
> 时间：2013-02-19T21:27:46.687
> 
> 标签：javascript, jquery, html, css

例如，如果你在亚马逊上看一本书，你会看到一个相当不错的（并且比省略号更直观）的文本摘要缩写效果： ![在此处输入图像描述](../Images/0a011828642793d6ed6dae3c98a69d27.png)

是否有一个有据可查的方法来做这件事，或者有一个图书馆可以促进这样的文本摘要？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:21:17.727

使用以下规则隐藏额外的内容：`height: 200px;`和`overflow: hidden;`; 您可以看到它们应用于`#outer_postBodyPS`. 但是淡入淡出效果是在`#psGradient`：

```
background: -moz-linear-gradient(bottom, rgb(255, 255, 255) 15%, rgba(255, 255, 255, 0) 100% );
background: -webkit-gradient(linear, bottom, top, color-stop(15%, rgb(255, 255, 255)), color-stop(100%, rgba(255, 255, 255, 0)) );
background: -webkit-linear-gradient(bottom, rgb(255,255,255) 15%, rgba(255, 255, 255, 0) 100% );
background: -o-linear-gradient(bottom, rgb(255,255,255) 15%, rgba(255, 255, 255, 0) 100% );
background: -ms-linear-gradient(bottom, rgb(255,255,255) 15%, rgba(255, 255, 255, 0) 100% ); 
filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#03ffffff', endColorstr='#ffffff', GradientType=0 ); 
background: linear-gradient(bottom, rgb(255, 255, 255) 15%, rgba(255, 255, 255, 0) 100% ); 
```

不同的前缀规则（和过滤器）仅适用于特定于浏览器的实例。

[您可以在http://z-ecx.images-amazon.com/images/G/01/browser-scripts/dpMergedOverallCSS/dpMergedOverallCSS-12049068973](http://z-ecx.images-amazon.com/images/G/01/browser-scripts/dpMergedOverallCSS/dpMergedOverallCSS-12049068973._V1_.css)*上使用这些规则检查整个样式表。[*V1*](http://z-ecx.images-amazon.com/images/G/01/browser-scripts/dpMergedOverallCSS/dpMergedOverallCSS-12049068973._V1_.css) [.css](http://z-ecx.images-amazon.com/images/G/01/browser-scripts/dpMergedOverallCSS/dpMergedOverallCSS-12049068973._V1_.css)。*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:36:26.053

视觉效果只是 CSS。有一个渐变图像固定在底部的 div 增加了“淡入淡出”的错觉。将覆盖设置为`position:fixed;bottom:0`添加该视觉效果。

就实际截断文本而言，有很多方法可以做到这一点。最简单的方法是使用 substring 函数，例如 PHP 的 substr。[http://php.net/manual/en/function.substr.php](http://php.net/manual/en/function.substr.php)并在 X 字符后简单地切断。

或者，您可以分解[http://php.net/manual/en/function.explode.php](http://php.net/manual/en/function.explode.php) [空格] 字符上的字符串，这将返回一个单词数组。然后，您可以轻松地遍历该数组并在达到 X 个单词时停止...*

# javascript - 只允许选中 2 个复选框

> ID：14967763
> 
> 赞同：0
> 
> 时间：2013-02-19T21:28:00.723
> 
> 标签：javascript

我想说我很少使用 javascript。这从来不是我的事，也可能永远不会，所以我很抱歉我对这种语言缺乏了解。这就是为什么我的问题如此羞辱。

我在网上找到了这段代码：

```
function checkboxlimit(checkgroup, limit){
    var checkgroup=checkgroup
    var limit=limit
    for (var i=0; i<checkgroup.length; i++){
        checkgroup[i].onclick=function(){
        var checkedcount=0
        for (var i=0; i<checkgroup.length; i++)
            checkedcount+=(checkgroup[i].checked)? 1 : 0
        if (checkedcount>limit){
            alert("You can check a maximum of "+limit+" boxes.")
            this.checked=false
            }
        }
    }
}

<script type="text/javascript">
    checkboxlimit(document.forms.checkform.weapon[], 2)
</script> 
```

它对我来说看起来很基本。这里没有什么特别的。但是，我的问题是我试图通过名称武器 [] 找到复选框，因为我正在输出多个复选框作为数组的武器 []，因此我需要这样做。现在我的问题是，我将如何解决这个愚蠢的小错误。

总结一下：我的问题是我的复选框被命名为武器[]（name="weapon[]"）而不是（name="weapon"），作为一个数组，因此js不会识别它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:41:15.627

你在寻找这样的东西吗？

```
$(':checkbox[name=weapon]').on('click',function(){

    var checkedBoxlength=$(':checkbox[name=weapon]:checked').length;
    if(checkedBoxlength>2){
        alert('You can check a maximum of 2 boxes.');
        return false;
    }
}); 
```

[http://jsfiddle.net/umqL3/2/](http://jsfiddle.net/umqL3/2/)

- - 编辑

刚刚制作了一个 jquery 插件，仅用于限制您检查的复选框数量。

```
(function( $ ){

  $.fn.LimitCheckableNumber = function( options ) {     
    var settings = $.extend( {
      'nr'         : 1,    
    }, options);
    return this.each(function() {        
         var $this=$(this),
             thisName=$this.attr('name');
        $this.on('click',function(){            
            var count=$(":checked[name='"+thisName+"']").length;           
            if(count>settings.nr){
            alert('You can check a maximum of '+settings.nr+' boxes. ');
                return false;
            };            
        });
    });
  };
})( jQuery ); 
```

[关联](http://jsfiddle.net/umqL3/9/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:35:35.030

`[]`使用点表示法时不能使用。切换到将其视为关联数组。

```
checkboxlimit(document.forms.checkform['weapon[]'], 2) 
```

[http://jsfiddle.net/4mYbD/3/](http://jsfiddle.net/4mYbD/3/)

工作得很好。

此外，您不需要重新定义`checkgroup`and `limit`。您可以将它们用作参数。

# perl - Windows和linux下使用未初始化的值变化

> ID：14967766
> 
> 赞同：0
> 
> 时间：2013-02-19T21:28:06.453
> 
> 标签：perl

我正在开发一个小的 Perl 脚本来自动化一些服务器任务，当我在我的 Windows 机器上测试它时一切正常，但是当我将它上传到我的 Linux 服务器时，脚本返回多个：

```
Use of uninitialized value $line in chomp at CreateEntity.pl line 52, <HANDLE> line 5.
Use of uninitialized value $line in string ne at CreateEntity.pl line 52, <HANDLE> line 5.
Use of uninitialized value $string in substitution (s///) at CreateEntity.pl line 67, <HANDLE>
Use of uninitialized value $string in substitution (s///) at CreateEntity.pl line 68, <HANDLE>
Use of uninitialized value $string in substitution (s///) at CreateEntity.pl line 67, <HANDLE>
Use of uninitialized value $string in substitution (s///) at CreateEntity.pl line 68, <HANDLE> 
```

这是代码本身：

```
#!/usr/bin/env perl

# This fils SHOULD go in the root of Symfony... put it anywhere else AT YOUR OWN RISK !!!

use warnings;

# Declare the subroutines
sub trim;

if(!defined $ARGV[0])
{
    die( "No FilePath Specified!\n" );

}

my $entityFile = $ARGV[0];

open( HANDLE, $entityFile ) or die( "The file could not be open!" );

my $entityCmd = "php app/console doctrine:generate:entity --entity=\"rapliqBundle:";
my $entityName = "";

chomp( my $line = ( <HANDLE> ) );
$line = trim( $line );
while( $line ne "END" )
{
    if( trim( $line ) ~~ "NAME:" )
    {
        chomp( $line = ( <HANDLE> ) );
        $entityName = trim( $line );
        $entityCmd = $entityCmd . $entityName;
        $entityCmd = $entityCmd . "\" --fields=\"";
    }
    elsif( trim( $line) ~~ "FIELDS:" )
    {
        chomp( $line = ( <HANDLE> ) );
        my @data = split( '=', $line );
        foreach my $val (@data) 
        {
            $val = trim( $val );
            if( $val ~~ lc "string" )
            {
                $entityCmd = $entityCmd . $val . "(255) ";
            }
            else
            {
                $entityCmd = $entityCmd . $val . ":";
            }
        }
    }

    52: chomp( $line = ( <HANDLE> ) );
}

close( HANDLE );
$entityCmd = $entityCmd . "\"";

#print $entityCmd;

system( $entityCmd );
system( "php app/console doctrine:generate:entities rapliqBundle:" . $entityName );
system( "php app/console doctrine:schema:update --force");

sub trim
{
    my $string = $_[0];
    67:$string =~ s/^\s+//;
    68:$string =~ s/\s+$//;
    return $string;
} 
```

感谢您的任何想法或评论:)

编辑：我将相关行的行号放在代码行的前面。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T21:37:55.593

这一切都归结为更好地处理输入文件的结尾。

1.  在 CreateEntity.pl 第 52 行第 5 行的 chomp 中使用未初始化的值 $line。

    `<HANDLE>`返回 undef 以指示您已到达文件末尾。您忽略这一点，并尝试对返回的值进行 chomp。

2.  在 CreateEntity.pl 第 52 行第 5 行的字符串 ne 中使用未初始化的值 $line。

    误报的行号。警告实际上来自`$line ne "END"`.

    `$line`到达文件末尾后仍未定义。

3.  在 CreateEntity.pl 第 67 行使用未初始化的值 $string 替换 (s///)，

4.  在 CreateEntity.pl 第 68 行使用未初始化的值 $string 替换 (s///)，

    `trim( $line ) ~~ "NAME:"`

    `$line`到达文件末尾后仍未定义。

5.  在 CreateEntity.pl 第 67 行使用未初始化的值 $string 替换 (s///)，

6.  在 CreateEntity.pl 第 68 行使用未初始化的值 $string 替换 (s///)，

    `trim( $line) ~~ "FIELDS:"`

    `$line`到达文件末尾后仍未定义。

您应该只修剪一次线条，如果您要修剪，则无需咀嚼。

* * *

一闪而过，我想我知道你的根本问题是:)

您的数据文件有 Windows 行结尾。你扼杀了这条线，留下你`"END\r"`而不是`"END"`. 命令行工具可以解决这个`dos2unix`问题，`trim`ming 也可以。

```
while (my $line = <HANDLE>) {
   $line = trim( $line );
   last if $line eq "END";
   ...
} 
```

# java - 用于不同文件的自定义微调器的自定义 ArrayAdapter

> ID：14967769
> 
> 赞同：1
> 
> 时间：2013-02-19T21:28:23.853
> 
> 标签：java, android, android-arrayadapter, android-spinner

我正在为自定义微调器制作自定义 ArrayAdapter。我在不同的文件中制作了我的自定义 ArrayAdapter（以保持井井有条），但出现错误。

这是我的 Activity，它有 Spinner：

```
public class AddEditIncome extends Activity
{
private long rowID; // id of income being edited, if any

String[] income_names_array,income_description_array,strings;

//called when the Activity is first started
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState); // call super's onCreate
    setContentView(R.layout.add_income);

    // --- setting spinner for income type ---
    Spinner s1=(Spinner)findViewById(R.id.spinnerInCategory);
    ArrayAdapter<String> adapter = new MySpinnerAdapterM(AddEditIncome.this, R.layout.spinner_row, strings);
    s1.setAdapter(adapter);
    s1.setOnItemSelectedListener(new OnItemSelectedListener()
    {
        @Override
        public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2, long arg3){
            int index = arg0.getSelectedItemPosition();
            inCategory=income_names_array[index];
        }
    @Override
    public void onNothingSelected(AdapterView<?> arg0) { }
    });
    // --- End of setting spinner--- 
```

这是我在另一个文件中的自定义 ArrayAdapter：

```
public class MySpinnerAdapterM extends ArrayAdapter<String> {
Context mContext;
int mResource;
String[] list;

String[] strings = {"Salary","Gift","Rent","Freelancer"};
    String[] subs = {"Your monthly salary","Its nice to get such gifts..",
        "Money from renting house", "Thats a difficult job"};
int arr_images[] = 
    { R.drawable.salary,R.drawable.gift, R.drawable.rent,R.drawable.freelancer};

public MySpinnerAdapterM(Context context, int textViewResourceId, String[] objects) {
    super(context, textViewResourceId, objects);
    this.mContext=context;
    this.mResource=textViewResourceId;
    this.list=objects;
}

@Override
public View getDropDownView(int position, View convertView,ViewGroup parent) {
    return getCustomView(position, convertView, parent);
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    return getCustomView(position, convertView, parent);
}

public View getCustomView(int position, View convertView, ViewGroup parent) {

    LayoutInflater inflater = ((Activity)mContext).getLayoutInflater();
    View row=inflater.inflate(R.layout.spinner_row, parent, false);
    TextView label=(TextView)row.findViewById(R.id.company);
    label.setText(strings[position]);

    TextView sub=(TextView)row.findViewById(R.id.sub);
    sub.setText(subs[position]);

    ImageView icon=(ImageView)row.findViewById(R.id.spinner_image);
    icon.setImageResource(arr_images[position]);

    return row;
    }
} 
```

我得到那个错误日志：

```
02-19 23:24:45.212: E/AndroidRuntime(25529): FATAL EXCEPTION: main
02-19 23:24:45.212: E/AndroidRuntime(25529): java.lang.RuntimeException: Unable to start activity ComponentInfo{development.nk.esoda/development.nk.esoda.AddEditIncome}: java.lang.NullPointerException
02-19 23:24:45.212: E/AndroidRuntime(25529):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at android.app.ActivityThread.access$2300(ActivityThread.java:125)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at android.os.Looper.loop(Looper.java:123)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at android.app.ActivityThread.main(ActivityThread.java:4627)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at java.lang.reflect.Method.invokeNative(Native Method)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at java.lang.reflect.Method.invoke(Method.java:521)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at dalvik.system.NativeStart.main(Native Method)
02-19 23:24:45.212: E/AndroidRuntime(25529): Caused by: java.lang.NullPointerException
02-19 23:24:45.212: E/AndroidRuntime(25529):    at java.util.Arrays$ArrayList.<init>(Arrays.java:49)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at java.util.Arrays.asList(Arrays.java:171)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at android.widget.ArrayAdapter.<init>(ArrayAdapter.java:125)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at development.nk.esoda.MySpinnerAdapterM.<init>(MySpinnerAdapterM.java:24)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at development.nk.esoda.AddEditIncome.onCreate(AddEditIncome.java:57)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
02-19 23:24:45.212: E/AndroidRuntime(25529):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
02-19 23:24:45.212: E/AndroidRuntime(25529):    ... 11 more 
```

预先感谢您的努力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:31:24.180

在`AddEditIncome`您声明数组时：

```
String[] income_names_array,income_description_array,strings; 
```

但它们为空，因为您*实际上*还没有制作数组。如果您需要使用它们，请正确制作它们。

确实，这个问题是因为您使用`null`数组（`AddEditIncome`的`strings`数组变量）调用超类构造函数。

我注意到您根本没有使用`AddEditIncome.strings`in `MySpinnerAdapterM`，因此您应该传递`MySpinnerAdapterM`'s`strings`变量，而不是考虑到已初始化：

```
public MySpinnerAdapterM(Context context, int textViewResourceId, String[] objects) {
    super(context, textViewResourceId, strings);
    //rest of code 
```

这也意味着您可以缩短 down`MySpinnerAdapterM`的构造函数定义，前提是您将始终使用这些字符串。

# c - Doxygen 有没有办法在函数原型中使用宏？

> ID：14967772
> 
> 赞同：0
> 
> 时间：2013-02-19T21:28:31.690
> 
> 标签：c, doxygen

说我有这个代码：

```
#ifndef DOXYGEN
#define _at(var) @##var
#else
#define _at(var)
#endif

void _at(near) main (void)
{
return 0;
} 
```

Doxygen 将该函数作为“_at()”。有没有办法在函数声明中解析宏（_at（near）在这种情况下为“”）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:56:38.870

您可以`MACRO_EXPANSION=yes`在 Doxyfile 中设置，如此[处所述](http://www.doxygen.nl/manual/preprocessing.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T10:46:48.883

您可能希望按如下方式配置 doxygen：

```
ENABLE_PREPROCESSING   = YES
MACRO_EXPANSION        = YES
EXPAND_ONLY_PREDEF     = YES
PREDEFINED             = _at(x)= 
```

# javascript - setInterval 函数调用问题

> ID：14967776
> 
> 赞同：0
> 
> 时间：2013-02-19T21:28:44.207
> 
> 标签：javascript, setinterval

我试图在我的弹出窗口中调用 setInterval 函数来每秒更新一次时间，但是当它被调用时，我的 HTML 页面根本不更新，只显示加载时的初始时间。我看不出我对这段代码做错了什么。

```
 var currentTime = new Date();

window.self.setInterval(
    function()
    { 
        window.self.document.getElementById("Time").innerHTML = currentTime.toTimeString();
    }, 1000 ); 
```

为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:31:53.947

`currentTime`被设置一次且仅一次。您需要在每个时间间隔创建一个新的 Date 对象。像这样的东西：

```
setInterval(
  function()
  { 
    document.getElementById("Time").innerHTML = (new Date()).toTimeString();
  },
  1000
); 
```

# ios - 如何在 xcode 4.5 上从命令行运行 IOS 单元测试

> ID：14967777
> 
> 赞同：2
> 
> 时间：2013-02-19T21:28:46.217
> 
> 标签：ios, unit-testing, ios-simulator, xcode4.5

我一直在试图弄清楚如何从命令行运行我们的单元测试，以便我们可以自动化它们。我正在使用 XCode 4.5.2，并构建一个 IOS 应用程序。

首先我尝试使用这个：

> ```
> xcodebuild  -target "Unit Tests" -configuration "Debug (test syncserver)" -sdk iphonesimulator6.0 clean build TEST_AFTER_BUILD=YES 
> ```

那将运行编译，但测试没有运行。因此，在阅读了此处的其他解决方案之后，我安装了 ios-sim 并设置了我的目标以在之后运行此脚本：（请注意，我必须将出现的“TEST_HOST”替换为“CODESIGNING_FOLDER_PATH”，因为 TEST_HOST 似乎不存在于我的构建。）

```
#!/bin/bash

if [ "$RUN_UNIT_TEST_WITH_IOS_SIM" = "YES" ]; then
    test_bundle_path="$BUILT_PRODUCTS_DIR/$PRODUCT_NAME.$WRAPPER_EXTENSION"
    echo ios-sim launch "$(dirname "$CODESIGNING_FOLDER_PATH")" --setenv DYLD_INSERT_LIBRARIES=/../../Library/PrivateFrameworks/IDEBundleInjection.framework/IDEBundleInjection --setenv XCInjectBundle="$test_bundle_path" --setenv XCInjectBundleInto="$CODESIGNING_FOLDER_PATH" --args -SenTest All "$test_bundle_path"
    ios-sim launch "$(dirname "$CODESIGNING_FOLDER_PATH")" --setenv DYLD_INSERT_LIBRARIES=/../../Library/PrivateFrameworks/IDEBundleInjection.framework/IDEBundleInjection --setenv XCInjectBundle="$test_bundle_path" --setenv XCInjectBundleInto="$CODESIGNING_FOLDER_PATH" --args -SenTest All "$test_bundle_path"
    echo "Finished running tests with ios-sim"
else
    "${SYSTEM_DEVELOPER_DIR}/Tools/RunUnitTests"
fi 
```

现在，当我像以前一样运行相同的 xcodebuild 命令时，我得到了这个：

> 错误域=DTiPhoneSimulatorErrorDomain 代码=1“未知错误。” UserInfo=0x7fcf04b03190 {NSLocalizedDescription=Unknown error., DTiPhoneSimulatorUnderlyingErrorCodeKey=-1} 使用 ios-sim 完成运行测试

关于下一步尝试什么的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T08:16:38.787

从日志中，您似乎有几个错误的设置。正确的语法是：

```
ios-sim launch YourApp.app 
--setenv DYLD_INSERT_LIBRARIES=/../../Library/PrivateFrameworks/IDEBundleInjection.framework/IDEBundleInjection 
--setenv XCInjectBundle=YourTest.octest 
--setenv XCInjectBundleInto=YourApp.app/YourApp 
--args -SenTest All YourTest.octest 
```

你可以看到

1.  启动命令后应用路径不正确
2.  XCInjectBundle 应该是你的 octest 而不是 app
3.  XCInjectBundleInto 应该是您的应用程序二进制路径而不是应用程序文件夹
4.  最后一个参数也应该是你的 octest

如果您在环境变量中看不到 TEST_HOST，您可能需要通过它们找到一些正确的，以使您的 bash 脚本正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-11T08:45:41.237

一个有点老的问题..但我在这里遇到了一些类似的问题。

我的 OSX/iOS 两分钱（在 iOS13/Catalina/Xcode 11 下测试）。（希望它可以帮助某人..）

```
func underXCTest()->Bool{
    let environment = ProcessInfo.processInfo.environment
    if let _ = environment["XCInjectBundleInto"]{
        return true
    }
    return false
} 
```

正在测试中返回 false。

# c# - 检查MySQL数据库中是否已经存在一行？

> ID：14967780
> 
> 赞同：0
> 
> 时间：2013-02-19T21:28:56.027
> 
> 标签：c#, mysql, .net

我正在编写一个连接到 Oracle MySQL 以检查特定行的函数，但它似乎不起作用！有人可以告诉我如何检查数据库中是否已经存在一行

```
 private bool groupAlreadyHasAdmin(string grp) {
 try
        {
            myConn.Open();
            strCmd = "SELECT * FROM users WHERE usergroup=@groupname AND privelege=2 LIMIT 1";
            MySqlCommand myCmd = new MySqlCommand(strCmd, myConn);
            myCmd.Parameters.AddWithValue("groupname", grp);
            if (myCmd.ExecuteNonQuery() > 0)
            {                    
                return true;
            }
            else 
            {                    
                return false;
            } 
        }
        catch (Exception E) { MessageBox.Show(E.Message); }
        return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-10T21:59:16.287

上面的答案是使用 ExecuteReader 和 ExecuteNonQuery。您可能更喜欢使用简单的 Exists 查询，然后执行 ExecuteScalar，以使事情变得简单。您可以在您的情况下使用以下命令：

```
using (MySqlCommand cmd = new MySqlCommand()){
    cmd.Connection = con;
    cmd.CommandText = @"SELECT EXISTS(SELECT 1 FROM users WHERE usergroup=@groupname AND privelege=2 LIMIT 1)";
    cmd.Parameters.AddWithValue("groupName", groupName);
    var result = cmd.ExecuteScalar();
    //result will be 1 if it exists, and 0 if it does not..
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:33:38.733

我终于找到了使用这些代码行的解决方法：

```
...
return myCmd.ExecuteReader().Read();
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:44:25.893

一种可能性是正确的英文拼写是“privilege”。也许这个查询会起作用：

```
strCmd = "SELECT * FROM users WHERE usergroup=@groupname AND privilege=2 LIMIT 1"; 
```

此外，您可以这样做，`SELECT 1`而不是`SELECT *`- 没有理由带回您不打算使用的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T21:47:31.227

试一试：先获取行数。

```
...
return myCommand.ExecuteNonQuery() > 0; 
```

# javascript - JavaScript/CoffeeScript 等效于 Ruby Timeout 模块

> ID：14967781
> 
> 赞同：2
> 
> 时间：2013-02-19T21:29:01.440
> 
> 标签：javascript, ruby, coffeescript, settimeout

在 JavaScript 中实现 Ruby Timeout 模块功能的最佳方法是什么？

[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/timeout/rdoc/Timeout.html](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/timeout/rdoc/Timeout.html)

例如取消（异步）完成时间比给定时间长的请求？

**编辑：**

为了明确我想要实现的目标：

例如，如果我在 node.js 中执行 HTTP 请求，例如

```
http.request(options, callback).end(); 
```

如果请求的时间超过给定的超时时间，我想取消请求。因此，取消绑定回调或确保请求没有进一步影响所需的一切。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T07:39:57.337

如果要取消（到）长时间运行的进程，请创建一个可在您使用 setTimeout 创建的闭包（函数）中访问的变量

```
someLongRunningHttpRequest = new HttpRequest("point://some/where")

#cancel the request after 5 seconds
setTimeout -> 
    someLongRunningHttpRequest.cancel()
, 5000 
```

显然你需要一个“cancable”的对象，或者你可以简单地忽略结果？

# javascript - 数组索引成本高吗？

> ID：14967783
> 
> 赞同：3
> 
> 时间：2013-02-19T21:29:15.530
> 
> 标签：javascript, backbone.js

在下面来自[主干](http://backbonejs.org/)的片段中，这一行

```
(ev = events[i]).callback.call(ev.ctx); 
```

不清楚。我想假设`ev = events[i]`之前解释过`ev.ctx`，因为该变量似乎没有其他目的，除了减少数组索引。

假设这是正确的，这样做是因为数组索引成本高吗？我知道在嵌入式工程中，当您使用有限的资源时，数组索引的成本很高。但我认为这在 JavaScript 中不是一个问题。

**主干片段**

```
triggerEvents = function(events, args) {
    var ev, 
        i = -1, 
        l = events.length;
    switch (args.length) {
        case 0: 
            while (++i < l) {
                (ev = events[i]).callback.call(ev.ctx);
            }
            return;
        case 1: 
            while (++i < l) {
               (ev = events[i]).callback.call(ev.ctx, args[0]);
            }
            return;
        case 2: 
            while (++i < l) { 
                (ev = events[i]).callback.call(ev.ctx, args[0], args[1]);
            }
            return;
        case 3: 
            while (++i < l) { 
                (ev = events[i]).callback.call(ev.ctx, args[0], args[1], args[2]);
            }
            return;
        default: 
            while (++i < l) {
                (ev = events[i]).callback.apply(ev.ctx, args);
            }
    }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:52:47.733

好的，使用[treehugger.js 演示](http://ajaxorg.github.com/treehugger/test.html)通过以下简化代码生成一个主干.js 方法的[AST ：](http://en.wikipedia.org/wiki/Abstract_syntax_tree)

```
var ev, i = -1, l = 3;
while (++i < l) { 
  (ev = events[i]).callback.call(ev.ctx, args[0], args[1], args[2]);
} 
```

产生这个 AST：

```
[
  VarDecls(
      [
        VarDecl("ev"),
        VarDeclInit(
            "i",
            PrefixOp(
                "-",
                Num("1")
            )
        ),
        VarDeclInit(
            "l",
            Num("3")
        )
      ]
  ),
  While(
      Op(
          "<",
          PrefixOp(
              "++",
              Var("i")
          ),
          Var("l")
      ),
      Block(
          [
            Call(
                PropAccess(
                    PropAccess(
                        Assign(
                            Var("ev"),
                            Index(
                                Var("events"),
                                Var("i")
                            )
                        ),
                        "callback"
                    ),
                    "call"
                ),
                [
                  PropAccess(
                      Var("ev"),
                      "ctx"
                  ),
                  Index(
                      Var("args"),
                      Num("0")
                  ),
                  Index(
                      Var("args"),
                      Num("1")
                  ),
                  Index(
                      Var("args"),
                      Num("2")
                  )
                ]
            )
          ]
      )
  )
] 
```

虽然隐含的“更清洁”方法：

```
var ev, i = -1, l = 3;
while (++i < l) {
  ev = events[i];
  ev.callback.call(ev.ctx, args[0], args[1], args[2]);
} 
```

产生这个 AST：

```
[
  VarDecls(
      [
        VarDecl("ev"),
        VarDeclInit(
            "i",
            PrefixOp(
                "-",
                Num("1")
            )
        ),
        VarDeclInit(
            "l",
            Num("3")
        )
      ]
  ),
  While(
      Op(
          "<",
          PrefixOp(
              "++",
              Var("i")
          ),
          Var("l")
      ),
      Block(
          [
            Assign(
                Var("ev"),
                Index(
                    Var("events"),
                    Var("i")
                )
            ),
            Call(
                PropAccess(
                    PropAccess(
                        Var("ev"),
                        "callback"
                    ),
                    "call"
                ),
                [
                  PropAccess(
                      Var("ev"),
                      "ctx"
                  ),
                  Index(
                      Var("args"),
                      Num("0")
                  ),
                  Index(
                      Var("args"),
                      Num("1")
                  ),
                  Index(
                      Var("args"),
                      Num("2")
                  )
                ]
            )
          ]
      )
  )
] 
```

这两者之间的唯一区别是`Assign()`发生在内部，`PropAccess()`而在“更清洁”的方法中却发生在外部。它们的步数相同。您可以避免`Assign`所有这些并用第二个交换它`Index`。恐怕我对 JS 内部的了解不够，不知道这是否更快。我猜它取决于平台。

# jquery - 如何在具有相同类名的多个类中选择一个类？

> ID：14967787
> 
> 赞同：0
> 
> 时间：2013-02-19T21:29:44.240
> 
> 标签：jquery, html, css

这是结构：

```
<div class="features-image">
</div>
<div class="features-image">
</div>
<div class="features-image">
</div> 
```

我制作了一个 jQuery 函数，如果特征图像处于悬停状态，就会发生某些事情。

我的问题是我有 3 个特色图片，当我的鼠标悬停在第一个特色图片上时，第二个和第三个也会得到相同的效果。

我希望如果第一张特征图像处于悬停状态，则第二张和第三张不会复制第一张图像的效果。

编码：

```
jQuery(document).ready(function() { 
    jQuery('.features-image').hover(function(){ 
        jQuery(this).animate({
            top:'95px',
            h‌​eight:'135px'
        },500); 
    },function(){ 
        jQuery('.features-content').animate({
            top:'170px',
            height:'60px'
        },500);
    }); 
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:35:02.913

当您定义类似悬停的内容时，您可以使用*它*来引用当前元素 -

```
$('.features-image').hover(function() {
    $(this) // mouseover do stuff
}, function {
    $(this) // mouseout do stuff
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:35:15.463

使用`this`指向当前 div 的指针：

```
$(function(){

   $('.features-image').hover(function(){

         //do something with $(this), for example:

         $(this).stop(true, true).fadeIn(); //mouseover

   }, function(){

        $(this).stop(true, true).fadeOut(); //mouseout

   });

}); 
```

# sql - row_number() 如何工作？

> ID：14967788
> 
> 赞同：2
> 
> 时间：2013-02-19T21:29:45.857
> 
> 标签：sql, sql-server

我正在搜索删除表上的重复条目，我看到了如下示例：

```
CREATE TABLE Suppliers
(
  Id int identity (1,1),
  CompanyTitle nvarchar(1000),
  ContactName nvarchar(100),
  LastContactDate datetime
)

INSERT Suppliers VALUES (N'Melody Music Instruments',N'James Manning', '20090623 10:15')
INSERT Suppliers VALUES (N'Blue Jazz',N'Mike Clark', '20090720 15:40')
INSERT Suppliers VALUES (N'Top Music',N'Katy Swan', '20090827 18:00')
INSERT Suppliers VALUES (N'Blue Jazz',N'Mike Clark', '20090806 10:00')
INSERT Suppliers VALUES (N'Melody Music Instruments',N'James Brown', '20080121 11:20')
INSERT Suppliers VALUES (N'Top Music',N'Katy Perry', '20090825 14:00')
INSERT Suppliers VALUES (N'Top Music',N'Katy Perry', '20090825 14:00')

WITH Duplicate AS 
(
SELECT
  RN = ROW_NUMBER() OVER (PARTITION BY CompanyTitle ORDER BY LastContactDate DESC)
FROM Suppliers
)
delete from Duplicate where RN > 1 
```

CTE 返回类似的东西，然后如果值大于 1 则删除。

```
RN
--
1
2
1
2
1
2
3 
```

我不明白的是它如何理解哪个条目将被删除。它只是通过这个例子返回重复的条目计数。

现场示例：[http ://www.sqlfiddle.com/#!3/d84b6/20](http://www.sqlfiddle.com/#!3/d84b6/20)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T23:15:11.390

您的示例表是一个堆（意味着它没有聚集索引）。

如果您查看示例的执行计划，您将看到它`Bmk1000`位于叶级表扫描的输出列列表中，并且该列在计划中的所有操作符之间传递，直到`DELETE`操作符为止。

`Bmk1000`是一个书签，用于唯一标识行的位置（堆的行标识符包含行的 File:Page:Slot 的位置），因此`DELETE`操作员可以使用它来定位所需的行。

如果您的表有一个聚集索引，您可能会看到聚集索引键列是以这种方式而不是书签传递的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:32:25.227

你的问题是什么？它正在删除行号大于 1 的任何内容。. . 代码非常明确`RN > 1`。

它将行号分配给行，从每个 CompanyTitle 开始。具有最近联系日期的行的值为 1。

因此，此代码将删除比每个 CompanyTitle 的最近联系人更旧的所有内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T22:46:45.107

PARTITION BY 和 ORDER BY 子句控制将删除哪些行。如果稍微扩展 CTE，它的工作原理会更加明显。（PostgreSQL 语法）

```
WITH Duplicate AS 
(
  SELECT
    ROW_NUMBER() OVER (PARTITION BY CompanyTitle ORDER BY LastContactDate DESC),
    CompanyTitle, 
    LastContactDate 
  FROM Suppliers
)
select * 
from Duplicate 
```

（为了便于阅读，下面添加了空行。）

```
1  Blue Jazz                    2009-08-06 10:00:00
2  Blue Jazz                    2009-07-20 15:40:00

1  Melody Music Instruments     2009-06-23 10:15:00
2  Melody Music Instruments     2008-01-21 11:20:00

1  Top Music                    2009-08-27 18:00:00
2  Top Music                    2009-08-25 14:00:00
3  Top Music                    2009-08-25 14:00:00 
```

PARTITION 子句将相同的 CompanyTitle 值保持在一起。ORDER BY 子句按 LastContactDate 对具有*相同CompanyTitle 值的行进行排序。*由于它按降序排序，因此每个 CompanyTitle 的最新行将始终编号为 1。

因此，要删除除每个 CompanyTitle 的最新行*之外*的所有行，您需要删除行号大于 1 的所有行。

# javascript - 将 Javascript 变量传递给 ' 正如标题所示，我想用javascript传递一个变量，但在一个框架中过去我有这个代码： [问问题 问问题 2013-02-19T21:29:54.050 1405 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 正如标题所示，我想用javascript传递一个变量，但在一个框架中过去我有这个代码：](page.php) [现在我想传递一个变量，下面的代码可以传递变量，但在另一个窗口中，但我希望它在同一个框架中。](page.php) [在 Internet Explorer 上的 drupal 7 中使用开放图层地图时出错 该地图适用于 firefox 和 chrome，但在 IE9 中出现错误。我正在使用视图来创建图层。问题与图层有关，当我禁用所有图层时，地图在 IE 中显示良好。但是，一旦我将其中一个图层标记为已激活并启用，我就会收到该错误：“地图渲染期间出错：TypeError：无法获取属性'transform'的值：对象为空或未定义” javascriptjqueryhtmlhref 4 1 回答 1 This answer is useful 2 我想你也许可以使用： document.getElementById('frame').contentWindow.location.href... 更改框架的href（并传递您的变量），但我很确定如果您使用的是查询字符串，它将需要刷新。 也许如果您附加一个哈希 ( #var=something) 而不是一个无需刷新就可以工作的查询字符串？ 请注意，如果您跨域做框架内容，这可能根本不起作用。 于 2013-02-19T21:37:16.693 回答 Related 1 perl - 如何在 OSX 上通过 XAMPP 运行 Selenium Perl 脚本 3 jsf - PrimeFaces，如何避免 p:selectOneMenu 选定值中 p:column 的串联 2 vba - 仅当 B 列中的 ID 重复时，如何计算 C 列中“是”的数量 1 c# - 如何为 ICollection Childs 提供已删除/原始项目的“列表” 2 servicestack - 有没有人有一个使用 ServiceStack.net 和 asp.net 网站的例子，而不是 web 应用程序 1 perl - 有没有办法在使用严格时从 Perl 中的字符串/变量创建变量？ 4 python - 如何检查特定整数是否在列表中 1 service - 每个用户的终端服务器内存使用情况 1 salesforce - LMA 和私人上市问题 2 r - 在 R 调试器中显示上下文？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641](page.php)

 [> ID：14967789
> 
> 赞同：1
> 
> 时间：
> 
> 标签：javascript, jquery, html, href

正如标题所示，我想用javascript传递一个变量，但在一个框架中过去我有这个代码：

```
 <a href="page.php" target="frame" onClick="$('#frame').show()"> 
```

现在我想传递一个变量，下面的代码可以传递变量，但在另一个窗口中，但我希望它在同一个框架中。

```
 <a href="page.php" target="frame" onClick="location.href=this.href+'?var='+X;"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:37:16.693

我想你也许可以使用：

```
document.getElementById('frame').contentWindow.location.href... 
```

更改框架的href（并传递您的变量），但我很确定如果您使用的是查询字符串，它将需要刷新。

也许如果您附加一个哈希 ( `#var=something`) 而不是一个无需刷新就可以工作的查询字符串？

*请注意，如果您跨域做框架内容，这可能根本不起作用。*](page.php)

# drupal-7 - 在 Internet Explorer 上的 drupal 7 中使用开放图层地图时出错

> ID：14967790
> 
> 赞同：0
> 
> 时间：2013-02-19T21:29:55.123
> 
> 标签：drupal-7, internet-explorer-9, openlayers

该地图适用于 firefox 和 chrome，但在 IE9 中出现错误。我正在使用视图来创建图层。问题与图层有关，当我禁用所有图层时，地图在 IE 中显示良好。但是，一旦我将其中一个图层标记为已激活并启用，我就会收到该错误：“地图渲染期间出错：TypeError：无法获取属性'transform'的值：对象为空或未定义”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T14:57:08.577

通过禁用自适应图像样式模块解决了我的问题，现在地图在 IE9 中工作

# .net - 使用 google drive 访问公共文件

> ID：14967801
> 
> 赞同：0
> 
> 时间：2013-02-19T21:30:33.857
> 
> 标签：.net, google-drive-api

我的 Google Drive 帐户中有公开文件。我想为其他用户制作一个桌面应用程序 (.NET)，并且该应用程序需要对我帐户中的那些公共文件具有只读访问权限。这可能与谷歌驱动器？

我检查了文档，但只发现以下内容：

1.  OAuth2 身份验证，但如果我是正确的，这用于让应用程序访问用户自己的帐户而不是我的帐户
2.  服务帐户，但这仅在程序在我控制的服务器上运行时才可用。不适合桌面应用程序

有人能把我引向正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:58:05.333

您将对您的帐户使用 OAuth 2.0 身份验证，[范围](https://developers.google.com/drive/scopes)为：

[https://www.googleapis.com/auth/drive.readonly](https://www.googleapis.com/auth/drive.readonly)

以便您的应用对您的云端硬盘文件具有只读访问权限。

# mysql - SUM - 为什么我在使用 sum 和使用计算器时得到不同的总和）？

> ID：14967803
> 
> 赞同：3
> 
> 时间：2013-02-19T21:30:35.093
> 
> 标签：mysql, sql

下午好。

注意到在现场计算金额的奇怪之处。

价值表：

![价值表](../Images/8c6a2bedcd524a49dbb3505d69d189a2.png)

类型字段 - 浮动。

我选择总和：

```
SELECT SUM(cost) as cost FROM Table 
```

结果我得到`sum`= 20.47497010231018;

![求和结果](../Images/278f33c01275ed921a31670a89effaf4.png)

我使用计算器），我得到`sum`= 20,47497

请告诉我为什么我会得到不同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:37:56.293

在这里，阅读：http: [//floating-point-gui.de/](http://floating-point-gui.de/)

所以，问题是浮点数——硬件中十进制数的内部实现，被大多数语言和应用程序使用，不会像我们使用的那样将 1 到 1 映射到以 10 为底的数字。基础值以 2 为基数表示，并且具有有限的精度。一些可以用十进制表示法中的几个数字表示的数字实际上可能需要更多的原生格式的数字 - 导致舍入错误。

上面链接的文章详细解释了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:39:21.487

在大多数情况下，这些差异不足以让人担心。

由于位数和浮点数如何以二进制形式存储，浮点数因与预期值略有偏差而臭名昭著。例如，如此处所示[，](http://www.h-schmidt.net/FloatConverter/IEEE754.html)十进制值`0.1`的实际`double`值为`0.10000000149011612`。接近，但不准确。

我在一些需要绝对准确的纬度和经度数字的应用程序中看到的一种技术是，它们会将值保留在整数数据类型中，这些值相当于浮点数乘以 10 的某个幂。例如，[GeoPoint 在Android 上的 Google Maps API v1](https://developers.google.com/maps/documentation/android/v1/reference/com/google/android/maps/GeoPoint)以微度为单位。而不是像纬度和经度那样`54.123428, 60.809234`精确地保留值，它们将是 ints: `54123428, 60809234`。为了描述这一点，他们会调用变量`latitudeE6`并`longitudeE6`表示它是真正的纬度或经度乘以 1E6（科学记数法 10^6）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T22:15:39.943

使用`DECIMAL(16, 4)`（例如）类型作为您的货币列，其中`4`是后面的位数`.`

不过，您将不得不修剪尾随零，因为例如`10`会出现`10.0000`. 然而，这很容易做到。

# php - 在codeigniter中显示来自mysql的图像

> ID：14967806
> 
> 赞同：0
> 
> 时间：2013-02-19T21:30:52.423
> 
> 标签：php, mysql, codeigniter

我想从 mysql 路径在我的视图上显示图像。在我的 mysql 表中，我有一个名为 imgpath 的行，文件位置是 assets/images/acura_1.jpg 它从表中正确显示汽车信息，但实际图像没有显示？谢谢！

这是我在视图中的代码

```
 <h1>Our Current Cars:</h1>
                    <?php foreach($images as $row)
                    {

                        echo "<br/>";
                    ?> <img src = <?php echo $row->imgpath; ?> >
                    <?php "<br/> ";
echo "<br/>";
echo "<font color = 'red'>";

echo $row->car_year . " " . $row->car_make . " " . $row->car_model . "<br/>";
echo "Lease Term: " . $row->car_lease . " Months" . "<br/>";
echo "Base Payment: " . "$" . $row->car_payment . "<br/>" ;
echo "</font>";
}

                ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:34:13.393

我的猜测是您不在网站的根目录中，而`/assets`文件夹在。

您可以为图像使用绝对路径：

```
<img src = "/<?php echo $row->imgpath; ?>" >
            ^ here 
```

如果某些图像可能以斜线开头，您可以使用`ltrim`来摆脱它们：

```
<img src = "/<?php echo ltrim($row->imgpath, '/'); ?>" > 
```

# javascript - jquery load() 的问题

> ID：14967807
> 
> 赞同：0
> 
> 时间：2013-02-19T21:30:53.933
> 
> 标签：javascript, jquery

我需要每 3 秒刷新一次页面上的某个 div。此 div 包含其中的其他 div。

```
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script>
setInterval(function()
{
    $('#gamewrapper2').load('find.php #gamewrapper2');
}, 3000);
; 
```

此代码有效，但仅当访问的页面是 domain/find.php 并且它不适用于 domain/find.php?id=1000001

也许我不明白，但这个函数不应该从 find.php 中获取块 #gamewrapper2 并将其粘贴到当前页面的块 #gamewrapper2 中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:55:03.180

您可以尝试以下方法将变量传递到 php 文档中：

```
setInterval(function()
{
    $('#gamewrapper2').load('find.php #gamewrapper2', {id: 1000001});
}, 3000);
} 
```

此外，您可以在完成加载以执行某些任务时提供函数回调...

```
setInterval(function()
{
    $('#gamewrapper2').load('find.php #gamewrapper2', {id: 1000001}, function(){
        alert("find.php has been loaded.");
    });
}, 3000);
} 
```

[.load() 方法](http://api.jquery.com/load/)

您可能应该使用`$_POST['id']`从 find.php 中获取值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:57:39.450

您只需要在 find.php 上保留查询字符串吗？就像是：

```
    设置间隔（函数（）{
        $('#gamewrapper2').load(window.location.pathname + window.location.search + '#gamewrapper2');
    }, 3000);

```

# javascript - 使用 Grunt 启动 Express 服务器

> ID：14967808
> 
> 赞同：1
> 
> 时间：2013-02-19T21:30:56.557
> 
> 标签：javascript, node.js, express, gruntjs

我想在我的 Gruntfile 中添加一个任务，以便启动我的 Express 服务器而不是默认服务器。我试图有一个任务并要求（“server.js”），但我认为这不是正确的方法：运行“grunt mytask”没有错误，但命令立即返回......并且快速服务器' 不听 谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-08T00:23:29.597

您可以使用[grunt-shell](https://github.com/sindresorhus/grunt-shell)在终端中执行命令：

例如，如果您有一个配置快速应用程序的 app.js 文件，您可以使用“node app.js”从命令行启动它

要使用 grunt shell 进行配置，您可以使用以下内容：

```
grunt.initConfig({
  shell: {
    launchExpress: {
      options: {
        stdout: true
      },
      command: 'node app.js'
    }
  }
}); 
```

# mysql - 返回数据是 Max Datetime 和不同身份的不同行 - MYSQL

> ID：14967809
> 
> 赞同：1
> 
> 时间：2013-02-19T21:30:57.587
> 
> 标签：mysql, sql

```
delimiter $$

CREATE TABLE `tbl_locate` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `Locating` bit(1) DEFAULT NULL,
  `MainPower` bit(1) DEFAULT NULL,
  `Acc` bit(1) DEFAULT NULL,
  `PowerOff` bit(1) DEFAULT NULL,
  `Alarm` int(11) DEFAULT NULL,
  `Speed` int(11) DEFAULT NULL,
  `Direction` int(11) DEFAULT NULL,
  `Latitude` double DEFAULT NULL,
  `Longitude` double DEFAULT NULL,
  `DateTime` datetime DEFAULT NULL,
  `MainID` int(11) DEFAULT NULL,
  `IOState` int(11) DEFAULT NULL,
  `OilState` int(11) DEFAULT NULL,
  PRIMARY KEY (`ID`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=latin1$$ 
```

## SQL 字符串

```
SELECT * FROM tbl_locate WHERE DateTime=(SELECT MAX(`DateTime`) FROM tbl_locate WHERE MainID=1,2,3) 
```

我想返回主 ID 为 1 或 2 或 3 的最新行的数据，
因此，需要返回 3 行最新的日期时间。
第一行是 id 1 最新日期时间
第二行是 id 2 最新日期时间
第三行是 id 3 最新日期时间

怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:41:09.933

```
SELECT        *
FROM          tbl_locate AS a
INNER JOIN     
(
    SELECT    MainID, Max(DateTime) AS DateTime
    FROM      tbl_locate
    GROUP BY  MainID
) AS b
ON            a.MainID = b.MainID
AND           a.DateTime = b.DateTime
WHERE b.MainID in(1,2,3) 
```

试试这个

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:36:41.507

按日期时间排序，并获得前 3 行：
SELECT * FROM `tbl_locate`ORDER BY DateTime LIMIT 3

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:37:14.600

这应该有效：

```
SELECT * 
FROM tbl_locate t
  JOIN (SELECT Max(DateTime) MaxDateTime, MainId
        FROM tbl_Locate
        WHERE MainId IN (1,2,3)
        GROUP BY MainId) t2 
   ON t.MainId = t2.MainId AND t.DateTime = t2.MaxDateTime 
```

这应该会返回 3 行，主 ID 1、2、3 各一行及其对应的 Max(DateTime)。但是，如果存在多个具有相同 DateTime 的行，则它将返回多条记录。

这是小提琴的示例：[http ://sqlfiddle.com/#!2/f2c49/1](http://sqlfiddle.com/#!2/f2c49/1)

如果多个记录存在相同的日期，您需要引入一个 RANK 以确保您只为每个 MainId 返回一条记录：

```
SELECT *
FROM (
SELECT 
   @rowNumber:= IF(@prevRow=t.MainId, @rowNumber:=@rowNumber+1, 1) rank,
  t.* , 
  @prevRow:=t.MainId
FROM tbl_locate t
  JOIN (SELECT 
        Max(DateTime) MaxDateTime, MainId
        FROM tbl_Locate
        WHERE MainId IN (1,2,3)
        GROUP BY MainId) t2 
   ON t.MainId = t2.MainId AND t.DateTime = t2.MaxDateTime
JOIN (SELECT @rowNumber:= 0) t3

 ) t
WHERE rank = 1; 
```

[http://sqlfiddle.com/#!2/dce87/2](http://sqlfiddle.com/#!2/dce87/2)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T21:40:30.727

试试这个：

```
SELECT
    T1.*
FROM tbl_locate T1
    LEFT JOIN tbl_locate T2
        ON T1.MainID = T2.MainID
          AND T1.`DateTime` < T2.`DateTime` 
WHERE T2.Id IS NULL
  AND MainID IN (1,2,3) 
```

# hibernate - hibernate jpa 不删除表

> ID：14967810
> 
> 赞同：1
> 
> 时间：2013-02-19T21:30:58.193
> 
> 标签：hibernate, jpa

我在我的应用程序中使用hibernate jpa，它可以自动创建表但不能删除它，我已经将“hibernate.hbm2ddl.auto”设置为“create-drop”。这是我的设置：

```
 <persistence-unit name="jobs-postgres">
    <properties>
      <property name="javax.persistence.jdbc.driver" value="org.postgresql.Driver" />
      <property name="hibernate.dialect" value="org.hibernate.dialect.PostgreSQLDialect" />
      <property name="hibernate.connection.provider_class" value="org.hibernate.connection.C3P0ConnectionProvider" />
      <property name="hibernate.hbm2ddl.auto" value="create-drop" />

      <!-- Connection provider properties. -->
      <property name="hibernate.c3p0.max_size" value="100" />
      <property name="hibernate.c3p0.min_size" value="1" />
      <property name="hibernate.c3p0.acquire_increment" value="1" />
      <property name="hibernate.c3p0.idle_test_period" value="60" />
      <property name="hibernate.c3p0.max_statements" value="0" />
      <property name="hibernate.c3p0.timeout" value="30" />

      <!-- Miscellaneous Hibernate properties. --> 
      <property name="hibernate.max_fetch_depth" value="3" />
      <property name="hibernate.cache.use_query_cache" value="false" />
      <property name="hibernate.cache.use_second_level_cache" value="false" />
      <property name="hibernate.search.autoregister_listeners" value="false" />
      <property name="hibernate.jdbc.batch_size" value="1000"/>
      <property name="hibernate.generate_statistics" value="false" />
      <property name="hibernate.show_sql" value="false" />        
    </properties>    
  </persistence-unit> 
```

存储库.java

```
public class JPATagsRepository {
    private static final Logger LOGGER = LoggerFactory.getLogger(JPATagsRepository.class);

    private final EntityManagerFactory _emf;

    public JPATagsRepository(EntityManagerFactory emf) {
        if (emf == null) {
            throw new IllegalArgumentException("Entity manager cannot be null.");
        }
        this._emf = emf;
    }

public void store(Set<String> tagStr, int type) {
    if (tagStr.size() == 0) {
        throw new IllegalArgumentException("Tags are empty.");
    }

    EntityManager em = null;
    EntityTransaction tx = null;

    try {
        em = _emf.createEntityManager();
        tx = em.getTransaction();
        tx.begin();

        int i = 0;
        for (String s : tagStr) {
            Tag tag = new Tag(s, type);

            if (getByName(tag.getName()) == null) {
                em.persist(tag);
            }

            if (++i % 1000 == 0) {
                em.flush();
                em.clear();
            }
        }

        tx.commit();
    }
    finally {
        if (tx != null && tx.isActive()) {
            tx.rollback();
        }
        if (em != null) {
            em.close();
            em = null;
        }
    }
}
} 
```

应用程序.java

```
Properties config = new Properties();
FileInputStream in = new FileInputStream(DEFAULT_OP_CONFIG_LOCATION);
config.load(in);
in.close();

Map<String, String> properties = Maps.newHashMap();
properties.put("javax.persistence.jdbc.url", config.getProperty("db_url"));
properties.put("javax.persistence.jdbc.user", config.getProperty("db_user"));
properties.put("javax.persistence.jdbc.password", config.getProperty("db_password"));

EntityManagerFactory emf = Persistence.createEntityManagerFactory("jobs-postgres", properties);         

JPATagsRepository tagRepository = new JPATagsRepository(emf); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T08:55:00.360

当`create-drop`您关闭表时，表会被删除，`EntityManagerFactory`但您似乎永远不会在代码中关闭它。

# sql - 在 SalesForce 中跨多个表的 SQL 查询

> ID：14967811
> 
> 赞同：1
> 
> 时间：2013-02-19T21:31:00.057
> 
> 标签：sql, sql-server, salesforce

我试图获取数据的问题是 -

“我想知道受营销活动影响的商机何时与客户相关联。帐户可能有多个联系人
因此，如果任何联系人与活动（活动成员）相关联 - 请告诉我该（或那些）联系人连接到的帐户，以及是否有与该活动相关联的机会帐户，如果有与该帐户相关联的机会，则该机会是在联系人与活动相关联之后创建的”</p>

我想不通其中的逻辑。我是 SQL 新手。任何帮助将不胜感激。

我正在使用 SQL Server 2012

我有 5 个来自 SalesForce 数据库的相关表 –</p>

Account 表（PK ID、OpportunityID）、Opportunity 表（PK ID、AccountID）、Contact 表（PK ID、AccountID）、Campaign 表（PK ID、ContactID、ParentID）、CampaignMember 表（PK ID、ContactID、CampaignID）

此链接提供了 SalesForce 数据模型 [http://www.salesforce.com/us/developer/docs/api/Content/sforce_api_erd_majors.htm](http://www.salesforce.com/us/developer/docs/api/Content/sforce_api_erd_majors.htm)

这是我想出的，但它不返回任何行。

```
SELECT O.CreatedDate OppCreatedDate
,o.Name as OpportunityName
,a.Name AccountName
,c.Name as ContactName
,ca.Name as CampaignName
,o.Amount_Software
,o.CreatedDate
FROM Opportunity o
INNER JOIN Account a on a.Id = o.AccountID 
LEFT JOIN  Contact c ON c.AccountId = a.Id
INNER JOIN CampaignMember cm ON cm.CampaignID  = c.ID
INNER JOIN Campaign ca ON ca.ID = cm.CampaignID
LEFT JOIN Campaign ca2 ON ca2.ID = ca.ParentID
WHERE o.CreatedDate > cm.CreatedDate
ORDER BY AccountName DESC; 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:03:31.593

您正在对 LEFT JOIN 运行 INNER JOIN，这是不明确的。

Opportunity <--> Account
Account --> Contact
**Campaign Member <--> Contact**（这应该是左连接，因为上面的行）
**Campaign Member <--> Campaign**（这应该是左连接，因为行上二)
活动 --> 活动

视觉效果在这里（您不能将新表内连接到左连接表）：

好：
内连接 <--> 内连接--> 左连接--> 左连接

错误：
内连接 <--> 内连接--> 左连接--> 内连接

# r - 是否有一个函数或包可以模拟从 lm() 返回的对象的预测？

> ID：14967813
> 
> 赞同：9
> 
> 时间：2013-02-19T21:26:38.730
> 
> 标签：r, regression, lm

是否有一个类似于“runif”、“rnorm”等的函数可以产生线性模型的模拟预测？我可以自己编写代码，但是代码很难看，我认为这是以前有人做过的事情。

```
slope = 1.5
intercept = 0
x = as.numeric(1:10)
e = rnorm(10, mean=0, sd = 1)
y = slope * x + intercept + e
fit = lm(y ~ x, data = df)
newX = data.frame(x = as.numeric(11:15)) 
```

我感兴趣的是一个看起来像下面一行的函数：

```
sims = rlm(1000, fit, newX) 
```

该函数将根据新的 x 变量返回 1000 个 y 值模拟。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-19T21:40:44.627

表明 Gavin Simpson 的修改建议`stats:::simulate.lm`是可行的。

```
## Modify stats:::simulate.lm by inserting some tracing code immediately
## following the line that reads "ftd <- fitted(object)" 
trace(what = stats:::simulate.lm,
      tracer = quote(ftd <- list(...)[["XX"]]),
      at = list(6))

## Prepare the data and 'fit' object 
df <- data.frame(x =x<-1:10, y = 1.5*x + rnorm(length(x)))
fit <- lm(y ~ x, data = df)

## Define new covariate values and compute their predicted/fitted values
newX <- 8:1
newFitted <- predict(fit, newdata = data.frame(x = newX))

## Pass in fitted via the argument 'XX'
simulate(fit, nsim = 4, XX = newFitted)
#        sim_1     sim_2       sim_3     sim_4
# 1 11.0910257 11.018211 10.95988582 13.398902
# 2 12.3802903 10.589807 10.54324607 11.728212
# 3  8.0546746  9.925670  8.14115433  9.039556
# 4  6.4511230  8.136040  7.59675948  7.892622
# 5  6.2333459  3.131931  5.63671024  7.645412
# 6  3.7449859  4.686575  3.45079655  5.324567
# 7  2.9204519  3.417646  2.05988078  4.453807
# 8 -0.5781599 -1.799643 -0.06848592  0.926204 
```

这行得通，但这是一种更清洁（并且可能更好）的方法：

```
## A function for simulating at new x-values
simulateX <- function(object, nsim = 1, seed = NULL, X, ...) {
    object$fitted.values <- predict(object, X)
    simulate(object = object, nsim = nsim, seed = seed, ...)
}

## Prepare example data and a fit object
df <- data.frame(x =x<-1:10, y = 1.5*x + rnorm(length(x)))
fit <- lm(y ~ x, data = df)

## Supply new x-values in a data.frame of the form expected by
## the newdata= argument of predict.lm()
newX <- data.frame(x = 8:1)

## Try it out
simulateX(fit,  nsim = 4, X = newX)
#       sim_1     sim_2     sim_3     sim_4
# 1 11.485024 11.901787 10.483908 10.818793
# 2 10.990132 11.053870  9.181760 10.599413
# 3  7.899568  9.495389 10.097445  8.544523
# 4  8.259909  7.195572  6.882878  7.580064
# 5  5.542428  6.574177  4.986223  6.289376
# 6  5.622131  6.341748  4.929637  4.545572
# 7  3.277023  2.868446  4.119017  2.609147
# 8  1.296182  1.607852  1.999305  2.598428 
```

# configuration - requirejs配置问题

> ID：14967821
> 
> 赞同：1
> 
> 时间：2013-02-19T21:31:41.487
> 
> 标签：configuration, requirejs, config

由于项目中的 FUBAR 目录组织，我花了一些时间在所述项目上重新组织 JS 脚本。该项目使用 requirejs 并且在重组之前运行良好。但是，现在在运行时调用或编译（我们使用 r.js 优化器）时不会加载任何内容——尽管编译完成时没有抱怨。我已经检查，仔细检查，三重检查，现在屈服于在 Stack Overflow 上寻求另一双眼睛。

使用 RequireJS：2.1.4 和 r.js 2.1.4

以下是我的配置：

build-js.js（用于优化器）

```
var requirejs = require('requirejs');

var config = {
    baseUrl: './public/js',
    mainConfigFile: './public/js/config/config.js',
    paths: {
        'requireLib': 'library/require'
    },
    out: ".public/js/minified/main.js",
    name: "minified/main",
    wrap: false,
    preserveLicenseComments: false,
    deps: ["app/main","modules/movie","modules/theatre"]
};

requirejs.optimize(config); 
```

配置.js

```
// Set the require.js configuration for your application.
require.config({
    paths: {
        // JavaScript folders
        libs: "library",
        plugins: "plugin",
        app: "app",
        adminlibs: "../adminassets/js/plugins/ui",

        // Libraries
        jquery: "library/jquery",
        jqcookie: "library/jquery.cookie",
        jqui: "../adminassets/js/plugins/ui/jquery-ui-1.10.0.custom.min",
        jqezmark: "library/jquery.ezmark",
        jqcolor: "library/jquery.color",
        underscore: "library/underscore-amdjs",
        backbone: "library/backbone-amdjs",
        chosen: "library/chosen.jquery", 
        moment: "library/moment",

        // Site Components 
        site: "app/site",
        sitediscussion: "app/site-discussion",
        namespace: "app/namespace",

        // Plugins
        text: "plugin/text", 
        async: "plugin/async", 
        use: "plugin/use",
        datetimepicker: "../adminassets/js/plugins/ui/jquery.datetimepicker",
        ajaxfileupload: "../adminassets/js/plugins/uploader/jquery.ajaxfileupload"
    },

    shim: {
        'chosen': ['jquery'],
        'jqcookie': ['jquery'],
        'jqui': ['jquery'],
        'jqezmark': ['jquery'],
        'jqcolor': ['jquery'],
        'site': {
            deps: ['jquery','jqezmark','chosen','underscore','namespace','jqui','jqcookie'],
            exports: 'site'
        },
        'sitediscussion': {
            deps: ['jquery', 'underscore'],
            exports: 'sitediscussion'
        },
        'jquifull' : ['jquery'],
        'datetimepicker' : ['jqui'],
        'ajaxfileupload' : ['jquery'],
        'backbone': ['underscore','jquery']
    },

    // Initialize the application with the main application file
    deps: ["app/main"]
}); 
```

文件结构如下：

{站点根}/public/js

其中包含目录：

应用配置库缩小模块插件模板

上面在 build-js 和 config.js 中列出的所有文件都被确认在预期的文件夹中。

requirejs 调用如下：

在开发机器上（我目前正在测试设置）：
data-main="/js/config/config" src="/js/library/require.js"

在生产中（当前甚至没有创建缩小/主文件，尽管应该创建）
data-main="/js/minified/main" src="/js/library/require.js"

谁能看到我可能做错了什么？同样，除了上面列出的两个文件（build-js.js 和 config.js）之外，站点本身、javascript 等都没有更改。唯一的变化是文件已在目录结构中物理移动。结果，我几乎可以肯定我在某个地方遇到了路径问题，但我似乎找不到它。帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:24:18.907

已找到解决方案。我通过“/js/config/config”的requirejs包含脚本标签中的data-main属性引用了我的配置文件。尽管我声明了 /public/js 的基本路径，但系统仍在尝试使用 /js/config/ 作为我的基本路径（如 requirejs 文档中所述，如果基本路径未另行声明）。我将 config.js 文件移动到 /js 并将 data-main 更改为 /js/config，现在所有路径都可以正常工作，引用基本路径 /js。

附带说明一下，由于我使用 Zend Framework 和错误处理，我没有注意到文件加载失败。没有 404 错误，我的开发工具的网络选项卡显示成功加载所有 .js 文件......只有当我查看这些文件的响应内容时，我才发现它们吐出 PHP 错误日志而不是比 .js 内容。

# html - 居中的 2x2 网格

> ID：14967822
> 
> 赞同：2
> 
> 时间：2013-02-19T21:31:45.660
> 
> 标签：html, css, position

我正在尝试将一个页面放在一起，该页面的中心有一个由四个方形 div 组成的网格。这就是我所拥有的，我想你将能够看到我打算发生的事情。我在这里缺少什么来使定位正常工作？

[http://jsfiddle.net/LKfd4/](http://jsfiddle.net/LKfd4/)

**HTML**

```
<div id='main-container'>
 <div class='box' id='topleft'></div>
 <div class='box' id='topright'></div>
 <div class='box' id='bottomleft'></div>
 <div class='box' id='bottomright'></div>

</div> 
```

**CSS**

```
#main-container{
    border:1px solid black;
    width:980px;
    height:700px;
    margin:0 auto;
    position:relative;
    top:20px;
}

.box {
    width:100px;
    height:100px;
    background:gray;
    border:2px solid #696969;
    -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
    -moz-box-sizing: border-box;    /* Firefox, other Gecko */
    box-sizing: border-box;  
}

#topleft{
    position:relative;
    margin:0 auto;
    top:50%;
    left:50%;
    margin-top:-110px;
    margin-left:-110px;
}
#topright{
    position:relative;
    margin:0 auto;
    top:50%;
    left:50%;
    margin-top:-110px;
    margin-left:10px;
}
#bottomleft{
    position:relative;
    margin:0 auto;
    top:50%;
    left:50%;
    margin-top:10px;
    margin-left:10px;
}
#bottomright{
    position:relative;
    margin:0 auto;
    top:50%;
    left:50%;
    margin-top:10px;
    margin-left:-110px;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T21:36:06.547

`position: relative;`从`#topleft`, `#topright`, `#bottomleft`,中删除`#bottomright`。并添加`position: absolute;`到`.box`.

jsfiddle： [//jsfiddle.net/G85fM/](http://jsfiddle.net/G85fM/)

更新的 jsfiddle（关于@Neils 评论）：http: [//jsfiddle.net/G85fM/1/](http://jsfiddle.net/G85fM/1/)

# java - 渲染光照

> ID：14967827
> 
> 赞同：1
> 
> 时间：2013-02-19T21:31:59.087
> 
> 标签：java, opengl, lwjgl, lighting

我有一个小型块引擎，类似于使用 LWJGL 的早期版本的 Minecraft。我现在想实际实现照明。我了解它是**如何**工作的，我只是对应该如何渲染照明感到困惑。我应该改变纹理的“亮度”来模拟明亮的地形吗？我在问如何实际更改四边形的光值，也许那里有一些教程？我希望它是逐块的，没有平滑的照明。我发现方块需要有一个光值，并且对于它旁边的每个方块，你将光值降低一点，直到它“变黑”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T06:50:09.157

（至少）两个选项，假设一个固定功能的渲染器：

1.  使用单个纹理（您的基本纹理图集，使用默认的`GL_MODULATE`texenv。）并设置每个顶点的灰度颜色以使纹理与光照水平成比例地变暗。使用`GL_MODULATE`纹理 RGB 通道乘以顶点颜色 RGB 通道。因此 RGB(255,255,255) 的顶点颜色将完全亮起，RGB(0,0,0) 将是纯黑色，而 RGB(128,128,128) 将位于中间的某个位置。

2.  使用两个纹理（外观图集和光照图图集）和多纹理。通过提供选择适当光照贴图正方形的纹理坐标，为给定面设置光照级别。如果您对光照贴图进行动画处理，您可以“免费”获得昼/夜循环，而无需像 #1 中那样遍历整个体积来修复顶点颜色。

# android - 在android中处理多点触控事件

> ID：14967832
> 
> 赞同：0
> 
> 时间：2013-02-19T21:32:38.067
> 
> 标签：android, event-handling

我正在尝试实现乒乓游戏，我有两个类作为“PongGameView”和“GameState”

我实现了在“PongGameView”中实现的多点触控事件，并将垫的 x 坐标传递给“GameState”。

我想实现当用户触摸底部垫时垫应该独立移动，只有底部垫应该移动，如果用户触摸，顶部垫，只有顶部垫应该移动。但是如果我尝试移动其中一个垫，我会遇到两个垫都在移动的问题。我将如何实现这一目标？

```
 public class PongGameView extends SurfaceView  implements SurfaceHolder.Callback{

private GameThread _thread;

public PongGameView(Context context, AttributeSet attrs) {
    super(context, attrs);

    //So we can listen for events...
    SurfaceHolder holder = getHolder();
    holder.addCallback(this);
    setFocusable(true); 

    //and instantiate the thread
    _thread = new GameThread(holder, context, new Handler());
}  

@Override
public boolean onKeyDown(int keyCode, KeyEvent msg) {
    return _thread.getGameState().keyPressed(keyCode, msg);
}

//Implemented as part of the SurfaceHolder.Callback interface
@Override
public void surfaceChanged(SurfaceHolder holder, int format, int width,
        int height) {
    //Mandatory, just swallowing it for this example

}

//Implemented as part of the SurfaceHolder.Callback interface
@Override
public void surfaceCreated(SurfaceHolder holder) {
    _thread.start();
}

//Implemented as part of the SurfaceHolder.Callback interface
@Override
public void surfaceDestroyed(SurfaceHolder holder) {
    _thread.stop();
}

private float _x = 0;
private float _y = 0;

private int mActivePointerId;

public boolean onTouchEvent(MotionEvent event) {

    int action = MotionEventCompat.getActionMasked(event);
    // Get the index of the pointer associated with the action.
    int index = MotionEventCompat.getActionIndex(event);
    int xPos = -1;
    int yPos = -1;
    boolean flag=false;

    if (event.getPointerCount() > 1) {

        // The coordinates of the current screen contact, relative to 
        // the responding View or Activity.  
        xPos = (int)MotionEventCompat.getX(event, index);
        yPos = (int)MotionEventCompat.getY(event, index);
        flag=true;

    } else {
        // Single touch event

        xPos = (int)MotionEventCompat.getX(event, index);
        yPos = (int)MotionEventCompat.getY(event, index);
    }

    _thread.getGameState().surfaceTouched(xPos, yPos, flag );
    return true;
}

 } 
```

具有 sufaceThouched 方法的第二类

```
 public class GameState {

//screen width and height
final int _screenWidth = 300;
final int _screenHeight = 420;

//The ball
final int _ballSize = 10;
int _ballX = 100;   int _ballY = 100;
int _ballVelocityX = 3;     int _ballVelocityY = 3;

//The bats
final int _batLength = 75;  final int _batHeight = 10;
int _topBatX = (_screenWidth/2) - (_batLength / 2);
final int _topBatY = 20;
int _bottomBatX = (_screenWidth/2) - (_batLength / 2);  
final int _bottomBatY = 400;
final int _batSpeed = 3;
boolean flag =false;

public GameState()
{
}

//The update method
public void update() {

_ballX += _ballVelocityX;
_ballY += _ballVelocityY;

//DEATH!
if(_ballY > _screenHeight || _ballY < 0)        
{_ballX = 100;  _ballY = 100;}      //Collisions with the sides

if(_ballX > _screenWidth || _ballX < 0)
            _ballVelocityX *= -1;   //Collisions with the bats      

if(_ballX > _topBatX && _ballX < _topBatX+_batLength && _ballY < _topBatY)      
                 _ballVelocityY *= -1;  //Collisions with the bats      

if(_ballX > _bottomBatX && _ballX < _bottomBatX+_batLength 
                && _ballY > _bottomBatY)
                       _ballVelocityY *= -1;
}

public boolean keyPressed(int keyCode, KeyEvent msg)
{
if(keyCode == KeyEvent.KEYCODE_DPAD_LEFT) //left
{
_topBatX += _batSpeed; _bottomBatX -= _batSpeed;
}

if(keyCode == KeyEvent.KEYCODE_DPAD_RIGHT) //right
{
_topBatX -= _batSpeed; _bottomBatX += _batSpeed;
}

return true;
}

//the draw method
public void draw(Canvas canvas, Paint paint) {

//Clear the screen
canvas.drawRGB(20, 20, 20);

//set the colour
paint.setARGB(200, 0, 200, 0);

//draw the ball
canvas.drawRect(new Rect(_ballX,_ballY,_ballX + _ballSize,_ballY + _ballSize),
                             paint);

paint.setARGB(200, 200,0, 0);
//draw the bats
canvas.drawRect(new Rect(_topBatX, _topBatY, _topBatX + _batLength,
                                  _topBatY + _batHeight), paint); //top bat

flag = true ;
paint.setARGB(200,0,0,200);

canvas.drawRect(new Rect(_bottomBatX, _bottomBatY, _bottomBatX + _batLength, 
                                      _bottomBatY + _batHeight), paint); //bottom bat
flag = false ;

}

public boolean surfaceTouched(float posX, float posY, boolean flag) {

    if (flag= true)
    {
    _bottomBatX = (int) posX;
    }
    else
    {
        _topBatX = (int) posX;
    }

    return true;
    } 
```

}

# php - 使用 CodeIgniter 的 back_url() 问题

> ID：14967833
> 
> 赞同：0
> 
> 时间：2013-02-19T21:32:38.797
> 
> 标签：php, codeigniter

我的一段代码贯穿整个数组，并为每个元素创建了一个可点击的链接

```
foreach($query as $news_item)
{
?>
   <li>
       <a href= <?php echo base_url("pages/view/"); echo $news_item['game_id']; ?> >test</a>
   </li>        
<?php
} 
```

我正在尝试使用 baseurl() 返回站点 url，然后定向到 pages/view/，然后是数组中元素的 game_id 的变量。

上面的例子给了我链接的follow url；

[http://helios.hud.ac.uk/u0862025/CodeIgniter/index.php/pages/view1](http://helios.hud.ac.uk/u0862025/CodeIgniter/index.php/pages/view1)

即使，显然有一个/后视图，它完全忽略了它，而且我对为什么我仍然是 php 新手一无所知。

任何帮助都会很可爱！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:37:19.670

听起来像是将它作为 base_url 函数的一部分剥离出来。试试这个

`<a href="<?php echo base_url("pages/view/{$news_item['game_id']}"); ?>">test</a>`

# xcode - xcode 4.6 目标构建设置缺少“Apple LLVM 编译器 4.2 - ...”部分

> ID：14967836
> 
> 赞同：3
> 
> 时间：2013-02-19T21:32:42.813
> 
> 标签：xcode, xcode4.6

在 xcode 4.6 中，我创建了一个具有多个目标的新项目。我的目标之一是一个空的 iOS 应用程序，它缺少 Target Build Settings 中的所有“Apple LLVM compiler 4.2 - ...”部分。还有人看到这个吗？关于如何让它们显示的任何想法？

我能够通过六个步骤一致地复制这种情况：

1.  启动 xcode 4.6
2.  文件 --> 新建 --> 项目...
3.  选择一个 OS X 框架和库 --> 捆绑包（接受所有默认值）
4.  在该项目中，文件 --> 新建 --> 目标...
5.  选择一个 iOS 应用程序 --> 空应用程序（接受所有默认值）
6.  转到 iOS 应用程序目标的“构建设置”，注意没有“Apple LLVM 编译器 4.2 - ...”部分

**使用“Apple LLVM 编译器 4.2 - ...”部分** ![和](../Images/41b2653c94f945c673a238e9773677ed.png)

**没有“Apple LLVM 编译器 4.2 - ...”部分** ![在此处输入图像描述](../Images/c86678ca6f7efcdae4f00081dc780d2f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T19:03:59.480

当我创建一个初始目标为 OS X Bundle 的新项目时（有关如何复制问题中的情况，请参阅第 3 步），所有添加的目标的默认设置都会继承项目设置，在这种情况下是针对 OS X . 当我添加 iOS 空应用程序目标时，“构建设置”是正确的，但“Apple LLVM 编译器 4.2 - ...”部分丢失了。

我能够通过更改**项目***（不是任何目标）的*“构建设置”“构建设置”中的“Apple LLVM 编译器 4.2 - ...”部分来显示 iOS 空应用程序目标架构”部分在以下庄园：

`Base SDK`从：`Latest OS X (OS X 10.8)`到：`Latest iOS (iOS 6.1)`

`Architectures`从：`64-bit Intel`到：`Standard (armv7, armv7s)`

然后点击 iOS Empty Application 目标的 Build Settings”，出现“Apple LLVM compiler 4.2 - ...”部分。

# android - Intellij Idea 不允许在真实设备上运行应用程序

> ID：14967839
> 
> 赞同：3
> 
> 时间：2013-02-19T21:32:51.853
> 
> 标签：android, intellij-idea

我有配置 Oracle SDK 1.6 和 Android SDK 的 Idea 12，

```
$ ./adb devices
List of devices attached 
S5830c10eb068   device 
```

此外，Eclipse 允许我直接在物理设备上运行项目，但 Idea 只能`S5830c10eb068`在某些窗口中看到该设备 - (Samsung gt-s5830, android 2.3.6)：

![在此处输入图像描述](../Images/666643e100e3a2349aeac3cbe1fdf7e1.png)

但即使我在“运行配置”中选择“USB 设备” - 也没有任何反应：

![在此处输入图像描述](../Images/d68b7a25072974a896a4e90b8f9eecf8.png)

我应该怎么办？

另外，设备插入后logcat中存在错误：

```
02-20 03:59:35.419: ERROR/RingtoneManager(158): getActualDefaultRingtoneUri : content://media/internal/audio/media/9
02-20 03:59:35.419: ERROR/RingtoneManager(158): Uri.parse(uriString) : content://media/internal/audio/media/9
02-20 03:59:35.439: ERROR/RingtoneManager(158): getActualDefaultRingtoneUri : content://media/internal/audio/media/9
02-20 03:59:35.439: ERROR/RingtoneManager(158): Uri.parse(uriString) : content://media/internal/audio/media/9
02-20 03:59:35.539: ERROR/MountService(158): ### notifyShareAvailabilityChange :: method = ums, avail = false
02-20 03:59:35.549: ERROR/MountService(158): notifyShareAvailabilityChange :: send ACTION_UMS_CONNECTED
02-20 03:59:38.609: ERROR/MountService(158): ### notifyShareAvailabilityChange :: method = ums, avail = true
02-20 03:59:38.619: ERROR/MountService(158): notifyShareAvailabilityChange :: send ACTION_UMS_CONNECTED
02-20 03:59:39.639: ERROR/RingtoneManager(158): getActualDefaultRingtoneUri : content://media/internal/audio/media/42
02-20 03:59:39.639: ERROR/RingtoneManager(158): Uri.parse(uriString) : content://media/internal/audio/media/42
02-20 03:59:39.919: ERROR/RingtoneManager(158): getActualDefaultRingtoneUri : content://media/internal/audio/media/42
02-20 03:59:39.919: ERROR/RingtoneManager(158): Uri.parse(uriString) : content://media/internal/audio/media/42
02-20 03:59:40.219: ERROR/RingtoneManager(158): getActualDefaultRingtoneUri : content://media/internal/audio/media/42
02-20 03:59:40.219: ERROR/RingtoneManager(158): Uri.parse(uriString) : content://media/internal/audio/media/42
02-20 04:00:12.689: ERROR/RingtoneManager(158): getActualDefaultRingtoneUri : content://media/internal/audio/media/9
02-20 04:00:12.689: ERROR/RingtoneManager(158): Uri.parse(uriString) : content://media/internal/audio/media/9
02-20 04:00:12.699: ERROR/RingtoneManager(158): getActualDefaultRingtoneUri : content://media/internal/audio/media/9
02-20 04:00:12.699: ERROR/RingtoneManager(158): Uri.parse(uriString) : content://media/internal/audio/media/9
02-20 04:00:12.809: ERROR/MountService(158): ### notifyShareAvailabilityChange :: method = ums, avail = false
02-20 04:00:12.819: ERROR/MountService(158): notifyShareAvailabilityChange :: send ACTION_UMS_CONNECTED
02-20 04:00:22.859: ERROR/MountService(158): ### notifyShareAvailabilityChange :: method = ums, avail = true
02-20 04:00:22.889: ERROR/MountService(158): notifyShareAvailabilityChange :: send ACTION_UMS_CONNECTED
02-20 04:03:52.719: ERROR/MountService(158): ### notifyShareAvailabilityChange :: method = ums, avail = false
02-20 04:03:52.729: ERROR/MountService(158): notifyShareAvailabilityChange :: send ACTION_UMS_CONNECTED
02-20 04:04:25.659: ERROR/MountService(158): ### notifyShareAvailabilityChange :: method = ums, avail = true
02-20 04:04:25.669: ERROR/MountService(158): notifyShareAvailabilityChange :: send ACTION_UMS_CONNECTED
02-20 04:59:09.369: ERROR/RingtoneManager(158): getActualDefaultRingtoneUri : content://media/internal/audio/media/9
02-20 04:59:09.369: ERROR/RingtoneManager(158): Uri.parse(uriString) : content://media/internal/audio/media/9
02-20 04:59:09.389: ERROR/RingtoneManager(158): getActualDefaultRingtoneUri : content://media/internal/audio/media/9
02-20 04:59:09.399: ERROR/RingtoneManager(158): Uri.parse(uriString) : content://media/internal/audio/media/9 
```

此外，如果我选择“显示选择器对话框”，然后从“运行”菜单中选择“运行” - 将打开与第二张图片相同的窗口。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T02:29:33.070

您正在尝试编辑**Defaults**，但您需要创建一个**新**的运行配置。

有关详细信息，请参阅[此文档部分](http://www.jetbrains.com/idea/webhelp/creating-and-editing-run-debug-configurations.html)。

创建配置后，您将能够在工具栏的下拉列表中选择它，并且运行/调试按钮将变为可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-07T01:02:36.727

`Run --> Edit Configurations... --> General --> Show Chooser Dialog --> OK`

然后再次运行它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-12T16:38:03.553

可能与在选择器中查看设备有关：在我的机器上，设备仅在我手动终止 ADB 进程后才在列表中（任务管理器 - >“adb.exe *32”）。在此之前，列表中没有设备或“确定”按钮灰显。（IntelliJ IDEA 13.0.2 社区）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-14T07:57:00.137

关于idea 13，在运行配置-> 常规-> 目标设备-> USB 设备中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-19T21:37:41.147

选择“显示选择对话框”并显示带有设备 ID 的对话框

# ios - 呈现模态 UIViewController 时出现奇怪的崩溃

> ID：14967840
> 
> 赞同：6
> 
> 时间：2013-02-19T21:32:57.703
> 
> 标签：ios, uiviewcontroller, modalviewcontroller, segmentation-fault

我已经看过几次这个崩溃报告了。这是极其随机和罕见的，我无法理解。我所做的只是使用以下代码呈现一个模态视图控制器

```
ComposeController *newcontrol = [[ComposeController alloc]initWithMode:1 withNIB:@"ComposeController"];
newcontrol.delegate = self;

UINavigationController  *holder = [[UINavigationController alloc] initWithRootViewController:newcontrol];
[self presentViewController:holder animated:YES completion:NULL]; 
```

不知何故，这完全随机地导致了这一点：

```
OS Version:      iPhone OS 6.1 (10B143)
Report Version:  104

Exception Type:  SIGSEGV
Exception Codes: SEGV_ACCERR at 0x9
Crashed Thread:  0

Thread 0 Crashed:
0   libobjc.A.dylib                     0x3b25c5d0 objc_msgSend + 16
1   CoreFoundation                      0x334ba73f -[__NSPlaceholderArray initWithObjects:count:] + 271
2   CoreFoundation                      0x334bae09 +[NSArray arrayWithObject:] + 45
3   UIKit                               0x353e80ab -[UIWindow _rotationViewControllers] + 51
4   UIKit                               0x353e7fe3 -[UIViewController viewControllerForRotation] + 91
5   UIKit                               0x353e7f39 -[UIViewController _visibleView] + 97
6   UIKit                               0x3546c05b -[UIWindowController transition:fromViewController:toViewController:target:didEndSelector:] + 2483
7   UIKit                               0x3546afab -[UIViewController presentViewController:withTransition:completion:] + 3399
8   MyApp                               0x00046e97 -[Inbox composeHit] (Inbox.m:207) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T03:31:47.663

我一直有同样的问题。这似乎是由于我正在从弹出窗口中呈现模态视图控制器这一事实引起的，该控制器没有经过很好的测试并触发了 Apple 代码中的错误。错误是 UIKit 保留了对我的 View Controller 的未保留引用，该引用已经被解除和释放，因此稍后会命中该引用。我的解决方法是要么避免从弹出窗口呈现模态 VC，要么自己无限期地保留所有此类 VC（在成员变量或类似的变量中）。

**下面是血淋淋的细节。**

这是我用来触发问题的代码。

```
-(void) handlePinchFromCell:(AMPSupportingPhotoCell*) cell
{
    UIViewController * vc = [[UIViewController alloc] init]; // UIViewController #0
    [self presentViewController:vc animated:YES completion:nil];
    [self performSelector:@selector(dismiss:) withObject:vc afterDelay:2];
}

-(void) dismiss:(UIViewController*)vc
{
    [self dismissViewControllerAnimated:YES completion:^(){NSLog(@"-------");}];
} 
```

这段代码是 UIViewController #1 的一部分，它位于 UIPopoverController 内部，它是从另一个 UIViewController #2 弹出的，它本身是从另一个视图 UIViewController #3 呈现的。崩溃发生在 popover 关闭后，控制器 #2 id 被解雇。

如果我启用 Zombies，我会得到相同的堆栈跟踪，但会显示一条消息：

```
2013-03-13 20:04:24.681 Mercury[16698:19d03] handlePinchFromCell: a225710
2013-03-13 20:04:27.083 Mercury[16698:19d03] -------
2013-03-13 20:04:31.606 Mercury[16698:19d03] *** -[UIViewController retain]: message sent to deallocated instance 0xa225710 
```

因此，请注意 VC #0 在 2 秒后被分配、呈现、关闭、解除分配，但在 Apple 代码中的某处仍然存在对它的悬空引用。当弹出窗口关闭并且 VC#2 被关闭时，整个事情都崩溃了，试图访问已释放的 VC。我相当肯定这是Apple的错误。我还猜想这与从弹出窗口中展示 VC 有关，所以如果你远离它，或者自己保留 VC，你应该没问题。

同一问题的另一个堆栈跟踪是这个。如果上面的代码运行两次，就会发生这种情况：

```
2013-03-13 20:12:53.883 Mercury[16735:19d03] handlePinchFromCell: 16d54da0
2013-03-13 20:12:56.285 Mercury[16735:19d03] -------
2013-03-13 20:13:03.481 Mercury[16735:19d03] handlePinchFromCell: a2565f0
2013-03-13 20:13:03.481 Mercury[16735:19d03] *** -[UIViewController isKindOfClass:]: message sent to deallocated instance 0x16d54da0
(lldb) bt
* thread #1: tid = 0x1f03, 0x017f8a97 CoreFoundation`___forwarding___ + 295, stop reason = EXC_BREAKPOINT (code=EXC_I386_BPT, subcode=0x0)
    frame #0: 0x017f8a97 CoreFoundation`___forwarding___ + 295
    frame #1: 0x017f894e CoreFoundation`_CF_forwarding_prep_0 + 14
    frame #2: 0x00c42f90 UIKit`-[UIWindowController transition:fromViewController:toViewController:target:didEndSelector:] + 907
    frame #3: 0x00a40ee3 UIKit`-[UIViewController presentViewController:withTransition:completion:] + 4521
    frame #4: 0x00a41167 UIKit`-[UIViewController presentViewController:animated:completion:] + 112
    frame #5: 0x0006c32d Mercury`-[AMPSupportingPhotosViewController handlePinchFromCell:](self=0x16d55360, _cmd=0x0007a64a, cell=0x0a22a2a0) + 205 at AMPSupportingPhotosViewController.m:184
    frame #6: 0x015336b0 libobjc.A.dylib`-[NSObject performSelector:withObject:] + 70
    frame #7: 0x0006f317 Mercury`-[AMPSupportingPhotoCell handlePinch:](self=0x0a22a2a0, _cmd=0x00efb0db, sender=0x0a2504a0) + 215 at AMPSupportingPhotoCell.m:53
    frame #8: 0x00c2185a UIKit`_UIGestureRecognizerSendActions + 139 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-02-19T21:40:34.450

尝试这样做

[持有人pushViewController：newcontrol动画：YES完成：NULL]；

# shell - 在每个文本文件的顶部和底部添加新行

> ID：14967842
> 
> 赞同：1
> 
> 时间：2013-02-19T21:32:59.520
> 
> 标签：shell, command-line, ssh, command

我有一个文件夹，其中包含大约 2000 个文本文件。

在每个文件的顶部，我需要添加这两行：

```
<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"> 
```

在每个文件的底部，我需要添加：

```
</urlset> 
```

有没有办法通过命令行一次在所有文件中大规模执行此操作？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T21:46:27.373

```
$ cat header 
<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">

$ cat footer 
</urlset>

$ cat header file footer
<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
one line
</urlset> 
```

要将上述内容包装在 bash 循环中：

```
for f in *.xml; do cat header $f footer > tmp && mv tmp $f; done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:54:46.833

使用单线：

```
sed -i -e '1 i <?xml version="1.0" encoding="UTF-8"?>\n<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">' -e '$s@$@\n</urlset>@'  *.xml 
```

# c - 从其他源文件访问结构

> ID：14967847
> 
> 赞同：0
> 
> 时间：2013-02-19T21:33:27.857
> 
> 标签：c, struct

我有两个文件：`getParams.c`和`tree.c`.

我想要做的是`tnode`从`tree.c`我的`getParams.c`.

我不记得如何正确包含来自其他源文件的代码。

## 获取参数.c

```
#include <stdlib.h>

int main(int argc, char *argv[]) {

tnode *doublyLinked;

addtree(doublyLinked, argv[1]);

return 0;
} 
```

## 树.c

```
/*
 *  Tree routines from Kernighan and Ritchie
 *  Chapter 6.
 */
#include <stdio.h>
#include <string.h>

#define EOS '\0'
#define LETTER 'a'
#define DIGIT '0'

#define MAXWORD 20

struct tnode{         /* the basic node */
     char *word;      /* points to the text */
     int count;           /* number of occurrences */
     struct tnode *left;  /* left child */
     struct tnode *right; /* right child */
};

main(){           /* word frequency count */
     struct tnode *root, *addtree();
     char word[MAXWORD];
     int t;

 root = NULL;
 while((t=getword(word, MAXWORD)) != EOF)
 if (t == LETTER)
     root = addtree(root,word);
 treeprint(root);
} 

... more code 
```

## 我得到的错误

```
gcc getParams.c tree.c -o getParams

getParams.c: In function ‘main’:

getParams.c:5:2: error: unknown type name ‘tnode’ 
```

我可以得到你的帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:36:34.243

I. 您应该`tnode`在单独的头文件中定义结构类型，并将该头文件包含在两个实现文件中。

二、这是 C，不是 C++。`struct tnode { };`不会自动定义类型名称`tnode`- 您必须手动执行此操作：

```
typedef struct tnode {
    /* foo */
} tnode; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:36:13.550

您需要`tnode`在共享标头中声明，然后使用以下内容包含它：

```
#include "myheader.h" 
```

# vb.net - vb.net 中的石头、纸、剪刀

> ID：14967850
> 
> 赞同：2
> 
> 时间：2013-02-19T21:33:35.040
> 
> 标签：vb.net, boolean

我在完成 RPS 游戏的代码时遇到了一些困难。说明如下： c．主按钮单击代码。一世。您需要像我们之前所做的那样使用输入框提示用户输入三个字母之一。ii. 从您的自定义方法中获取随机字母。iii. 将用户的信件和随机的计算机信件都传递给您的其他方法。iv. 如果返回 true，则告诉用户他们在您添加到表单的标签中获胜，否则告诉他们他们在该标签中失败。

我认为我正确地执行了 1 和 2，但我遇到了 3 和 4 的问题。有人可以帮忙！

到目前为止，这是我的代码

```
Public Class Form1

    Dim randomObject As New Random()

    Private Property user As String

    Private Property computer As Random

    Function GetRandomRPSLetter() As String
        randomObject.Next(1, 4)
        Dim computer As Integer = randomObject.Next(1, 4)
        If computer = 1 Then
            Return "r"
        ElseIf computer = 2 Then
            Return "p"
        Else
            Return "s"
        End If

    End Function
    Function GetRPSRoundWinner(ByVal user As String, ByVal computer As String) As String
        If user = "r" Then
            If computer = "r" Then
                Return False
            ElseIf computer = "p" Then
                Return False
            Else
                Return True
            End If
        ElseIf user = "p" Then
            If computer = "r" Then
                Return True
            ElseIf computer = "p" Then
                Return False
            Else
                Return False
            End If
        Else
            If computer = "r" Then
                Return False
            ElseIf computer = "p" Then
                Return True
            Else
                Return False
            End If
        End If
    End Function

    Private Sub Button1_click(ByVal sender As System.Object,
                                    ByVal e As System.EventArgs) Handles Button1.Click

        user = InputBox("Please input r, p, or s to play")

        GetRandomRPSLetter()

    End Sub
    Sub GetRPSRoundWinner()
        If GetRPSRoundWinner(True) Then Return
        Label1.Text = "You win"

    End Sub

    Private Function GetRPSRoundWinner(p1 As Boolean) As Boolean
        Throw New NotImplementedException
    End Function

End Class 
```

现在我打电话给 GetRPSRoundWinner

```
Private Sub Button1_click(ByVal sender As System.Object,
                                ByVal e As System.EventArgs) Handles Button1.Click

    user = InputBox("Please input r, p, or s to play")

    GetRandomRPSLetter()

    GetRPSRoundWinner()

End Sub 
```

谁能帮助我如何比较它们？

非常感谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:42:23.147

*   您的`GetRPSRoundWinner`方法应该返回 a`Boolean`而不是 a `String`。车削`Option Strict On`将减轻这些类型的错误。
*   您在按钮单击事件处理程序中调用您的`GetRandomRPSLetter`方法，但是您永远不会从中获取返回值并使用它来将用户的输入与随机生成的计算机移动进行比较。
*   你永远不会`GetRPSRoundWinner`从任何地方打电话。
*   您的`GetRPSRoundWinner`方法有三个重载，但实际上只有一个是有用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T23:14:21.293

我做了一些改变，它对我有用。我没有测试你的函数是否得到了正确的赢家，但我认为它是：

```
Public Class Form1

    Dim randomObject As New Random()

    Private Property user As String

    Private Property computer As Random

    Function GetRandomRPSLetter() As String
        randomObject.Next(1, 4)
        Dim computer As Integer = randomObject.Next(1, 4)
        If computer = 1 Then
            Return "r"
        ElseIf computer = 2 Then
            Return "p"
        Else
            Return "s"
        End If

    End Function
    Function ComputeWinner(ByVal user As String, ByVal computer As String) As String
        If user = "r" Then
            If computer = "r" Then
                Return False
            ElseIf computer = "p" Then
                Return False
            Else
                Return True
            End If
        ElseIf user = "p" Then
            If computer = "r" Then
                Return True
            ElseIf computer = "p" Then
                Return False
            Else
                Return False
            End If
        Else
            If computer = "r" Then
                Return False
            ElseIf computer = "p" Then
                Return True
            Else
                Return False
            End If
        End If
    End Function

    Private Sub Button1_click(ByVal sender As System.Object,
                                    ByVal e As System.EventArgs) Handles Button1.Click

        user = InputBox("Please input r, p, or s to play")

        Dim ComputerLetter = GetRandomRPSLetter()

        GetRPSRoundWinner(user, ComputerLetter)

    End Sub
    Sub GetRPSRoundWinner(userLetter As String, computerLetter As String)
        If ComputeWinner(userLetter, computerLetter) Then
            Label1.Text = "You win"
        Else
            Label1.Text = "You loose! "
        End If

    End Sub
End Class 
```

不要简单地复制和粘贴代码。请仔细阅读它，以便您可以看到差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:29:57.867

我想向您展示如何使用 an`Enum`并利用`Integer`对它的隐式转换。

这是我的示例代码的结果：

![桌面](../Images/1c3cfba8c990626375518e208a507033.png)

以及带有注释的主模块的来源：

```
Private rnd As New Random()
''' <summary>
''' Contain values for rock, paper, scissors in a specific
''' numeric order for simplifying with win/loss table
''' </summary>
Public Enum GameHand
    None = -1
    Paper = 0
    Scissors = 1
    Rock = 2
End Enum
''' <summary>
''' Contain values for the result of the game
''' </summary>
Public Enum GameResult
    None = -1
    Loss = 2
    Draw = 0
    Win = 1
End Enum

''' <summary>
''' Compares two RPS hands and returns a win or a loss.
''' If the two hands are the same, or either one is None then the function returns 0
''' </summary>
''' <param name="hand">The human hand (input value)</param>
''' <param name="cpu">The computer hand (output value)</param>
''' <returns>Win, Loss or Draw</returns>
Public Function Play(ByVal hand As GameHand, ByRef cpu As GameHand) As GameResult
    ' Shall we play?
    If hand = GameHand.None Then Return GameResult.None
    ' Pick a random hand
    cpu = rnd.Next(0, 2)
    ' Is it a draw?
    If hand = cpu Then Return GameResult.Draw
    ' win/loss table
    '
    '      P   S   R    
    ' P |      L   W |  
    ' S |  W       L |  
    ' R |  L   W     |  
    '
    ' count how many step away is one hand from the other
    ' in the sequence P S R P S R P S ...
    Dim diff As Integer = (hand + 3 - cpu) Mod 3
    ' two steps is a loss, and one step is a win
    ' Return win or loss
    Return diff
End Function

Sub Main()

    Dim usr As String, win As Integer = 0
    Dim hand As GameHand, cpu As GameHand
    Do
        usr = InputBox("Enter game hand (r/p/s) or quit (q)", "Rock Paper Scissors").ToLower()
        ' Interpret user input 
        Select Case usr
            Case "r"
                hand = GameHand.Rock
            Case "p"
                hand = GameHand.Paper
            Case "s"
                hand = GameHand.Scissors
            Case Else
                hand = GameHand.None
        End Select
        'Play against computer and report back results.
        'Also report computer hand with `ByRef` parameter
        Dim result As GameResult = Play(hand, cpu)
        Console.WriteLine(String.Format("Play {0} against {1} with result {2}", hand, cpu, result))
        'Add wins and subtract losses
        If result = GameResult.Win Then
            win += 1
        ElseIf result = GameResult.Loss Then
            win -= 1
        End If
        ' Check for quit.
    Loop Until usr.Equals("q")
    Console.WriteLine("Player win-loss = " & win)

End Sub 
```

# mediaelement.js - 播放/音频图标未显示

> ID：14967851
> 
> 赞同：1
> 
> 时间：2013-02-19T21:33:37.783
> 
> 标签：mediaelement.js

播放和音频图标未显示在音频栏中。我可以将鼠标悬停在播放按钮应该在的位置，工具提示会显示“播放/暂停”。点击那里开始播放音频。但播放图标（箭头）未显示。

我阅读了另一篇文章中的回复并尝试了它们：

*   我没有将 CSS 样式应用于按钮
*   我已经仔细检查了图像路径是否正确，并且图形文件“controls.svg”和“controls.png”都在服务器上。
*   我将完全相同的一组 mediaelement 测试文件上传到 2 台不同的服务器——在一台服务器上，图标显示正常，而在另一台服务器上则不显示。

我不确定下一步该尝试什么。

# xaml - WinRT - 手指/鼠标位置

> ID：14967853
> 
> 赞同：0
> 
> 时间：2013-02-19T21:33:41.020
> 
> 标签：xaml, windows-runtime, position, winrt-xaml

我`Canvas`从外部框架获得了一个带有 XAML 元素的东西，所以它对`Canvas`我来说就像一个黑盒子。如果我按下一个控件，则会引发一个事件`EventHandler(object sender, EventArgs e)`......我确实需要`Popup`在我点击的位置显示一个控件......

现在我在质疑自己从哪里可以得到我点击的位置？！？？有没有简单的方法来获得职位？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:48:10.497

您的问题似乎有很多未知数 - 例如，您没有提到引发了什么事件，但是您可以获取事件的发送者并将其转换为某个`UIElement`或其他预期类型，然后您可以调用某事像这样提取元素的位置。

```
var position = element
    .TransformToVisual(Window.Current.Content)
    .TransformPoint(new Point()); 
```

要获取触摸或鼠标按键的实际位置 - 您可以尝试订阅`PointerPressed`基本画布上的事件，然后`new Point()`在上面的代码中替换为您获得的位置，或者如果事件没有冒泡（您的处理程序没有'不被调用）-您可以导航可视化树（使用`VisualTreeHelper`）并尝试在 that 的子元素上订阅该事件`Canvas`。

# jquery - 更改 jQuery AJAX 成功的类和文本

> ID：14967855
> 
> 赞同：1
> 
> 时间：2013-02-19T21:33:45.153
> 
> 标签：jquery, ajax

我有一个链接：

```
<a href="#" class="confirmed" data-ev="1">
  <i class="icon-pencil"></i>
  <span class="text-warning">confirm this!</span>
</a> 
```

我在这段代码的注释部分尝试了所有内容：

```
$(".confirmed").on("click", function(e){
   e.preventDefault();
   var that  = this;
   $.ajax({
    url: '/confirmed/',
    type: 'POST',
    data: {
      event_type: $(that).data('ev')
    },
        success: function(result) {
          $(that).data('ev',"10");
          // here I want to change the class of i tag to "icon-ok"
          // and span.class to "text-success"
          // and span.text to "confirmed"
        }
  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:39:18.627

你已经有了父`<a>`元素。你只需要做一个[find](http://api.jquery.com/find/)：

```
$(that).find('i').addClass('icon-ok');
$(that).find('span').text('blah'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:37:02.870

添加类[`jQuery.addClass()`](http://api.jquery.com/addClass/)

删除类[`jQuery.removeClass()`](http://api.jquery.com/removeClass/)

设置文本内容[`jQuery.text()`](http://api.jquery.com/text/)

这是非常简单的 jQuery 任务，您很容易使用[Google](https://www.google.com/search?q=jquery+add+class)找到它们。这也是为什么我的帖子不包含任何代码的原因。

# php - 合并 PHP 购物车中的值

> ID：14967857
> 
> 赞同：2
> 
> 时间：2013-02-19T21:33:50.147
> 
> 标签：php, cart, shopping

我有以下问题。

我将购物车存储在 PHP 会话中，然后加载它以显示购物车中的项目。

问题是目前，我看到每个项目都没有合并，这意味着如果一个项目在购物车中添加了 2 次，它将显示两次。

如何按 itemId 合并结果？

```
 if(is_array($_SESSION['cart']))
            {
    $max=count($_SESSION['cart']);
    for($i=0;$i<$max;$i++)
{
    $pid=$_SESSION['cart'][$i]['itemId'];
    $q=$_SESSION['cart'][$i]['qty'];
    if($q==0) continue;
    $query2 = $con -> prepare("SELECT * FROM item_descr WHERE id_item = :idItem");
    $query2-> bindValue (':idItem',$pid);
    $query2->execute();
    $row2 = $query2->fetch(PDO::FETCH_ASSOC);
                    ?>
            <div class="checkoutItems">     
            <span class='itemNameChck'><?php echo $row2['name']; ?> </a></span>
            <span class="itemQtyChck"><?php echo $row2['price']; ?> </span>
            <span class="itemQtyChck"><?php echo $q; ?> </span>
            <span class="itemQtyChck"><?php $totalPerItem = $q * $row2['price']; echo $totalPerItem; ?> </span>
            </div>
            <?php 
            }
            } 
```

以下是我将商品添加到购物车的方法：

```
function addtocart($pid,$q)
    {

        if($pid<1 or $q<1) return;
        if(is_array($_SESSION['cart']))
            {

                $max=count($_SESSION['cart']);
                $_SESSION['cart'][$max]['itemId']=$pid;
                $_SESSION['cart'][$max]['qty']=$q;
                $max=count($_SESSION['cart']);
            }
            else
            {
                $_SESSION['cart']=array();
                $_SESSION['cart'][0]['itemId']=$pid;
                $_SESSION['cart'][0]['qty']=$q;
                $max=count($_SESSION['cart']);

            }
        //}
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:59:33.333

在我看来 - 你必须摆脱包含购物车项目索引的那个 ID。

```
//             I mean this
//                 ||
//                 ||
//                \  /
//                 \/
$_SESSION['cart'][$max]['qty']=$q; 
```

放在`itemId`那里，然后在添加项目之前 - 检查是否设置了这个数组元素。

您编写了这段代码，每次都向数组添加新元素，现在您想要合并。这对我来说毫无意义。仅在必要时添加新元素。否则，只需更新数量。

在我看来，您的购物车应如下所示：

```
$_SESSION['cart'][$itemid]['qty']=$q;

// example how to store other attributes
$_SESSION['cart'][$itemid]['name']="Rubber duck";
$_SESSION['cart'][$itemid]['color']="Yellow";
$_SESSION['cart'][$itemid]['size']="XXL";
$_SESSION['cart'][$itemid]['price']="1000"; 
```

然后，在添加项目时，您可以检查具有该 itemid 的购物车项目是否包含任何元素。

```
if isarray($_SESSION['cart'][$itemid]) // when exists - add to previous quantity
    $_SESSION['cart'][$itemid]['qty']= $_SESSION['cart'][$itemid]['qty'] + $q;
else                                   // else - set quantity
    $_SESSION['cart'][$itemid]['qty'] = $q; 
```

这只是一个草案/想法，但我希望它会对你有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:06:46.290

像这样的东西应该可以解决问题

```
function addtocart($pid,$q)
{
if($pid<1 or $q<1) return;

for($i=0;$i> count($_SESSION['cart']);$i++)
{
    if($_SESSION['cart'][$i]["item_id"] == $pid)
    {   
        $_SESSION['cart'][$i]['qty'] += $q
        return;
    }
}

if(is_array($_SESSION['cart']))
{

    $max=count($_SESSION['cart']);
    $_SESSION['cart'][$max]['itemId']=$pid;
    $_SESSION['cart'][$max]['qty']=$q;
    $max=count($_SESSION['cart']);
}
else
{
    $_SESSION['cart']=array();
    $_SESSION['cart'][0]['itemId']=$pid;
    $_SESSION['cart'][0]['qty']=$q;
    $max=count($_SESSION['cart']);

} 
```

}

# extjs - 如何在 ExtJS 网格中显示模型关联的值？

> ID：14967858
> 
> 赞同：0
> 
> 时间：2013-02-19T21:33:49.920
> 
> 标签：extjs, model, associations, grid-layout

我正在尝试绘制一个网格，其中每条线都是股票一天的表现。在我的数据结构中，我有一个`Date`、一个`Stock`和一个`Stock Price`资源。连接到我的网格的商店就是`Stock Price`商店。

所以，据我所知，我最大的问题是，当网格单元渲染时，我需要已经有了值，或者我需要有一个阻塞函数来*获取*一个值。

当我使用`getStore()`魔法功能时，我被告知记录不知道它（未定义的方法）。我假设这是因为该记录没有与独立模型相同的功能。

我看到了一些方法：

1.  自定义网格和/或存储，以便在发生加载时，同时加载所有相关行。
2.  在渲染器中创建回调，然后更改单元格值，但我不确定如何执行此操作。我实际上不想更改单元格值 ( `StockId`)，只是更改可见输出 ( `Symbol`)。
3.  更改我的 API 以匹配我的视图。

总结一下：#1 对于一个看似简单的结果似乎需要做很多工作。我一直在尝试使用这些关联，但我发现它们除了对这里和那里的小事之外没有任何用处，当然也对大量数据没有用。#2 我现在不知道从哪里开始；并且#3 似乎是巨大的矫枉过正，并且通常会破坏我的服务器端，因为我的意思是更多的连接，并且在保存记录时也更加复杂。

所以，两部分问题：

1.  有谁知道如何从网格中的关联模型加载值？
2.  如果不是，为了激起我的好奇心，在屏幕上有大量数据需要处理的任何情况下，关联是用来做什么的？大量数据似乎是使用 Ext vs jQueryUI 或其他一些 UI 框架的原因，所以我想知道这些关联是做什么用的。

**模型 - 股票价格**

```
Ext.define('MyApp.model.StockPrice', {
    extend : 'Ext.data.Model',
    idProperty : 'StockPriceId',
    fields : [ {
        name : 'StockId',
        type : 'int'
    }, {
        name : 'Open',
        type : 'float'
    }, {
        name : 'Close',
        type : 'float'
    }, {
        name : 'DateId',
        type : 'date'
    }],
    proxy : {
        type : 'rest',
        url : '/api/stock.price'
    },
    reader : {
        type : 'json'
    },
    associations : [ {
            type : 'hasOne',
            model : 'MyApp.model.Date',
            primaryKey : 'DateId',
            foreignKey: 'DateId'
    },{
        type : 'hasOne',
        model : 'MyApp.model.Stock',
        primaryKey : 'StockId',
        foreignKey : 'StockId'
    } ]
}); 
```

**型号 - 库存**

```
Ext.define('MyApp.model.Stock', {
    extend : 'Ext.data.Model',
    idProperty : 'StockId',
    fields : [ {
        name : 'StockId',
        type : 'int'
    }, {
        name : 'Symbol',
        type : 'string'
    } ],
    proxy : {
        type : 'rest',
        url : '/api/stock'
    },
    reader : {
        type : 'json'
    },
    associations : [ {
        type : 'hasMany',
        model : 'MyApp.model.StockPick',
        primaryKey : 'StockId',
        foreignKey : 'StockId'
    }]
}); 
```

**型号 - 日期**

```
Ext.define('MyApp.model.Date', {
    extend : 'Ext.data.Model',
    fields : [ 'DateId', 'Date' ]
}); 
```

**商店 - 股票价格**

```
Ext.define('MyApp.store.StockPrice', {
    extend : 'Ext.data.Store',
    model : 'MyApp.model.StockPrice',
    remoteSort : true,
    remoteFilter : true,
    pageSize : 5,
    autoLoad : true
}); 
```

**查看 - 股票价格**

```
Ext.define('MyApp.panel.StockData', {
    extend : 'Ext.grid.Panel',
    store : 'MyApp.store.StockPrice', 
    columns : [
            {
                text : 'Symbol',
                flex : 1,
                sortable : false,
                hideable : false,
                dataIndex : 'StockId',
                renderer : function(stockId, metadata, stockPriceRecord) {
                     // What goes in here? PROBLEM POINT
                     MyApp.model.Stock.load(stockId, function() {
                         // ... some callback
                     });
                     // OR
                     return stockPriceRecord.getStock().get('Symbol');
                }
            },
            {
                text : 'Open',
                flex : 1,
                dataIndex : 'Open',
                renderer : 'usMoney'
            },
            {
                text : 'Close',
                flex : 1,
                dataIndex : 'Close',
                renderer : 'usMoney'
            },
            {
                text : 'Volume',
                flex : 1,
                dataIndex : 'Volume'
            }]
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:56:39.893

在网格中显示来自关联模型的数据的唯一真正选择是在列上使用自定义渲染器函数。这不会改变任何值；它只会将所需的输出渲染到单元格中。

现在，至于实现该渲染器功能：我将从模型中删除代理开始，而是为每个模型创建商店并允许商店管理代理 - 然后，将商店`Stock`作为监听器附加到商店`StockPrice`上听`datachanged`事件。当`StockPrice`store 的数据发生变化时，您应该获取每个唯一引用`Stock`的 id，然后告诉`Stock`store 请求具有这些 id 的股票有效负载。

这可能意味着稍微改变您的 API 以支持`IN(...)`幕后的 SQL，但是通过将连接留给客户端，您将减轻服务器端的压力。

简而言之，您需要使用您提出的所有三个想法中的一点点，以最好地实现您的目标。

# ruby-on-rails - 将 .dup 与多条记录一起使用

> ID：14967860
> 
> 赞同：0
> 
> 时间：2013-02-19T21:33:57.057
> 
> 标签：ruby-on-rails

我正在为 Catarse 项目创建一个 Stripe 支付引擎。我需要将三条记录从我的用户（项目所有者）复制到我的用户项目。但是因为我是初学者，所以代码看起来像 S&%#te!

```
#project_controller.rb

def create
  ...
  check_for_stripe_keys
  ....
end

def show
  ...
  check_for_stripe_keys
  ....
end

....

def check_for_stripe_keys
  if @project.stripe_userid.nil?
    @project.reload
    @project.stripe_access_token = @project.user.stripe_access_token.dup
    @project.stripe_key = @project.user.stripe_key.dup
    @project.stripe_userid = @project.user.stripe_userid.dup
  elsif @project.stripe_userid != @project.user.userid
    @project.stripe_access_token = @project.user.stripe_access_token.dup
    @project.stripe_key = @project.user.stripe_key.dup
    @project.stripe_userid = @project.user.stripe_userid.dup
  end
  @project.save
end

.... 
```

我只需要这三个记录，因为我的条带代码是一个引擎。三件事：

1）最初我想用户 update_attributes 但我不知道是否可以在该方法中使用 .dup 。

2）是否可以将它放在位于 main_app 可访问的引擎中的帮助程序中，这样用户就不必编辑 main_app project_controller 代码？

3) 是否有更简洁的方式来显示上述 .dup 代码？因为太丑了！

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:48:53.577

也许是这样的：

宝石文件：

```
 gem 'deep_cloneable' 
```

代码：

```
 @user.dup :include => [:stripe_userid, :stripe_access_token, :stripe_key] 
```

我不太了解你们的关系。但是看看这个答案：[复制活动记录记录的最简单方法是什么？](https://stackoverflow.com/questions/60033/what-is-the-easiest-way-to-duplicate-an-activerecord-record)

这是 deep_cloneable： [https ://github.com/moiristo/deep_cloneable](https://github.com/moiristo/deep_cloneable)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:41:39.257

这是一种更紧凑的方式来编写您已有的内容：

```
[:stripe_access_token, :stripe_key, :stripe_userid].each do |field|
  @project.send("#{field.to_s}=", @project.user.send(field).dup)
end 
```

# c# - 字典比可以返回 DependencyProperty.UnsetValue

> ID：14967863
> 
> 赞同：0
> 
> 时间：2013-02-19T21:34:03.027
> 
> 标签：c#, .net, wpf, xaml

我的代码中有很多字典绑定。它们中的大多数都没有找到并使用 FallBackValue。

这对用户来说都非常有用。

但是，当我在调试器中运行它时，需要很长时间才能在输出窗口中显示所有这些错误。

我问了这个问题[WPF Dictionary Binding failure is very slow](https://stackoverflow.com/q/13610137/16241)并被告知我应该返回 DependencyProperty.UnsetValue。

我已经尝试过了，它可以编译。但是当我运行它时，我得到了一个例外。

**有没有办法定义一个也可以返回 DependencyProperty.UnsetValue 的字典？** （或其他更快失败的方法。）

更新：这是我尝试过的迭代：

```
public class NullTolerantDictionary<TKey, TValue> 
           : Dictionary<TKey, TValue> where TValue : class
{
    public new TValue this[TKey key]
    {
        get
        {
            TValue value;
            bool success = TryGetValue(key, out value);
            if (success)
                return value;

            var errorResult = DependencyProperty.UnsetValue as TValue;

            if (errorResult != null)
                return errorResult;

            return default(TValue);
        }
    }        
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T01:35:04.393

[UnsetValue](http://msdn.microsoft.com/en-us/library/system.windows.dependencyproperty.unsetvalue.aspx)具有 Object 的运行时类型，因此对于任何其他 TValue 类型，errorResult 将为 null，并且`default(TValue)`也是 null。因此，最后，您通常会在缺少键时返回 null，而不是抛出适当的异常。这与 IDictionary 合同相违背，这就是为什么事情不成功的原因。从本质上讲，您的类看起来像一个真正的 IDictionary（即它实现了 IDictionary），但它并不是真正的一个（即它的行为不像一个）。你没有说你在运行时得到了什么异常，但我认为它是来自客户端代码的 NullReferenceException，它不期望你的方法调用返回 null。

您实际上是在尝试`dict[key]`像`dict.TryGetValue(key)`现有代码一样重写。我可以同情这些动机，但这行不通。它必须从调用方修复，听起来你无法控制它。

# iphone - Facebook sharekit 2.0 的麻烦

> ID：14967864
> 
> 赞同：0
> 
> 时间：2013-02-19T21:34:05.003
> 
> 标签：iphone, objective-c, facebook, sharekit

```
- (void)authorize:(NSArray *)permissions {
self.permissions = permissions;

[self authorizeWithFBAppAuth:NO safariAuth:NO];

} 
```

好的，上面的代码就是我要实现的。但是这段代码给了我两个错误。第一个是在 Facebook 中找不到的属性权限，第二个是实例授权 authorizeWithFBAppAuth: 未找到。这是共享工具包 2.0，所以也许这对它不起作用，但我需要阻止 Facebook 应用程序弹出。PS我是一个Sharekit菜鸟。

```
 - (void)authorize:(NSArray *)permissions {

// if we already have a session, git rid of it
[self.session close];
self.session = nil;
[self.tokenCaching clearToken];

self.session = [[[FBSession alloc] initWithAppID:_appId
                                     permissions:permissions
                                 urlSchemeSuffix:_urlSchemeSuffix
                              tokenCacheStrategy:self.tokenCaching]
                autorelease];

[self.session openWithCompletionHandler:^(FBSession *session, FBSessionState status, NSError *error) {
    switch (status) {
        case FBSessionStateOpen:
            // call the legacy session delegate
            [self fbDialogLogin:session.accessToken expirationDate:session.expirationDate];
            break;
        case FBSessionStateClosedLoginFailed:
            { // prefer to keep decls near to their use

                // unpack the error code and reason in order to compute cancel bool
                NSString *errorCode = [[error userInfo] objectForKey:FBErrorLoginFailedOriginalErrorCode];
                NSString *errorReason = [[error userInfo] objectForKey:FBErrorLoginFailedReason];
                BOOL userDidCancel = !errorCode && (!errorReason ||
                                                    [errorReason isEqualToString:FBErrorLoginFailedReasonInlineCancelledValue]);

                // call the legacy session delegate
                [self fbDialogNotLogin:userDidCancel];
            }
            break;
        // presently extension, log-out and invalidation are being implemented in the Facebook class 
        default:
            break; // so we do nothing in response to those state transitions
    }
}];
 } 
```

上面的代码是共享工具包 2.0 附带的原始代码，如果有办法阻止 Facebook 应用程序在上面的代码中弹出，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T02:50:20.307

使用如下：

```
- (void)authorize:(NSArray *)permissions 
{
self.permissions = permissions;

[self authorizeWithFBAppAuth:NO safariAuth:YES];

} 
```

然后检查。

# javascript - 搜索后清除输入

> ID：14967868
> 
> 赞同：0
> 
> 时间：2013-02-19T21:34:15.513
> 
> 标签：javascript, ruby-on-rails-3

我的网站上有一个搜索框。搜索效果很好。我希望在您提交搜索后清除搜索字段。我可以清除 onclick，但 onsubmit 不起作用。它肯定是在提交搜索，因为我可以看到结果。

**js**

```
<script type="text/javascript">
function clearDefault(el) {
if (el.defaultValue==el.value) el.value = ""
}
function clearText(thefield){
if (thefield.defaultValue==thefield.value)
thefield.value = ""
}
</script> 
```

**看法**

```
<%= form_tag guidelines_path, :class => 'navbar-search pull-right', :onSubmit=>"clearText(this)",:method => :get do %>  

<%= text_field_tag :search, params[:search], :class => 'search-query', :placeholder=>"Search", :ONFOCUS=>"clearDefault(this)" %> <% end % 
```

>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:41:37.557

Th`onsubmit`不是文本字段的事件，而是它所属的表单。如果您将`onsubmit`属性移动到表单，它应该清除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T10:57:16.140

与其将字段作为参数传递，不如直接按其类获取字段？所以使用jquery：

```
function clearText(){
    search = $('.search-query');
    if (search.defaultValue==search.value)
    search.value = ""
} 
```

如果由于某种原因您不能使用 jQuery，您可以尝试为表单字段分配一个 ID 并改用 document.getElementById() 吗？

# java - 如何从用户那里获取数组

> ID：14967872
> 
> 赞同：-2
> 
> 时间：2013-02-19T21:34:25.070
> 
> 标签：java

该程序正在运行，但我想从用户那里获取 A[] 数组输入。请有人告诉我如何从用户那里获取输入并将该输入用作程序中的数组。

```
 public class rough1{
 public static int arrMajority1(int A[]){
 int n = A.length;

 for(int i=0;i<A.length;i++){
 int c = 1;
 for(int j=i+1;j<A.length;j++)
 if (A[i]==A[j])
  c=c+1;
  if (c>(A.length/2)){
  return A[i];
  }
  }

   return -1;
  }

   public static void main(String[] args){
    int A[] = new int [] {1,1,7,5};
   // int arrMajority1 = A[0];
     if (arrMajority1(A) != -1)

    System.out.println("The majority element is " + arrMajority1(A));

    else 
    System.out.println("There is no majority element.");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:40:28.457

我不会给你代码，因为为了你自己的利益，你需要做一些研究。但这里有一些指针：

1.  使用 Scanner 获取用户的输入。
2.  将输入放入 ArrayList。
3.  找到产生数组的 List 方法。

# c++ - boost::spirit 附加一个向量

> ID：14967878
> 
> 赞同：2
> 
> 时间：2013-02-19T21:34:39.737
> 
> 标签：c++, boost, boost-spirit, boost-spirit-qi

我在使用`phoenix::insert`. 代码应将诸如“(move xyz - loc r -robot item)”之类的输入解析为`struct Predicate`名称为“move”的 3 个类型`loc`变量、1 个类型变量`robot`和 1 个默认类型变量`object`。所有这些符号都只是与问题无关的字符串（我相信）。问题是`phoenix::insert`在规则的定义中使用`predicate`.

这是我的代码：

```
#include <boost/config/warning_disable.hpp>
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix.hpp>
#include <boost/spirit/include/phoenix_core.hpp>
#include <boost/spirit/include/phoenix_operator.hpp>
#include <boost/spirit/include/phoenix_fusion.hpp>
#include <boost/spirit/include/phoenix_stl.hpp>
#include <boost/spirit/include/phoenix_object.hpp>
#include <boost/spirit/home/phoenix/container.hpp>
#include <boost/fusion/include/adapt_struct.hpp>

namespace client {

  namespace fusion = boost::fusion;
  namespace phoenix = boost::phoenix;
  namespace qi = boost::spirit::qi;
  namespace ascii = boost::spirit::ascii;

  struct Variable {
    std::string name;
    std::string type;
  };

  struct Predicate {
    std::string name;
    std::vector<Variable> vars;
  };

  struct TermList {
    std::vector<Variable> vars;

    TermList() = default;
    TermList(std::vector<std::string> names, std::string type)
    {
      for (auto& n : names)
      {
        Variable t;
        t.name = n;
        t.type = type;
        vars.push_back(t);
      }
    }

    TermList& operator=(const TermList& rhs) = default;
    TermList(const TermList& from) = default;
    TermList(TermList&& from) = default;
  };

}

BOOST_FUSION_ADAPT_STRUCT(
  client::Variable,
  (std::string, name)
  (std::string, type)
)

BOOST_FUSION_ADAPT_STRUCT(
  client::Predicate,
  (std::string, name)
  (std::vector<client::Variable>, vars)
)

BOOST_FUSION_ADAPT_STRUCT(
  client::TermList,
  (std::vector<client::Variable>, vars)
)

namespace client {

  template <typename Iterator, typename Skipper = ascii::space_type>
  struct strips_domain_grammar
  : qi::grammar<Iterator, Predicate(),
                qi::locals<std::vector<Variable>>, Skipper>
  {
    strips_domain_grammar()
    : strips_domain_grammar::base_type(predicate, "predicate")
    {

      using qi::eps;
      using qi::lit;
      using qi::lexeme;
      using qi::raw;

      using qi::on_error;
      using qi::fail;

      using phoenix::at_c;
      using phoenix::push_back;
      using phoenix::insert;
      using phoenix::begin;
      using phoenix::end;
      using phoenix::construct;
      using phoenix::val;

      using ascii::char_;
      using ascii::string;
      using ascii::alpha;
      using ascii::alnum;
      using namespace qi::labels;

      // identifier such as move or ?from
      identifier %= raw[lexeme[((alpha | char_('_') | char_('?'))
                                >> *(alnum | char_('_') | char_('-')))]];

      // x | x y | x - type | x y z - type
      term_list =
      +(identifier          [push_back(_a, _1)])
      >>
      (
       ('-' >
       identifier [qi::_val = phoenix::construct<TermList>(qi::_a, qi::_1)])
       |
       eps        [qi::_val = phoenix::construct<TermList>(qi::_a, "object")]
       )
      ;

      // (move x y z - loc r - robot item) // item is detault type - object
      predicate =
      char_('(')
      > identifier       [at_c<0>(_val) = _1]
      > +(term_list      [insert(at_c<1>(_val), end(at_c<1>(_val)),   // <- ERROR
                                 begin(at_c<0>(_1)), end(at_c<0>(_1)))])
      > ')'
      ;

      predicate.name("predicate");
      term_list.name("term list");
      identifier.name("id");

      // on_error is called only when an expectation fails (> instead of >>)
      on_error<fail>
      (
       predicate
       , std::cout
       << val("Error! Expecting ")
       << _4                               // what failed?
       << val(" here: \"")
       << construct<std::string>(_3, _2)   // iterators to error-pos, end
       << val("\"")
       << std::endl
       );
    }

    qi::rule<Iterator, std::string(), Skipper> identifier;

    qi::rule<Iterator, TermList(),
             qi::locals<std::vector<std::string>>, Skipper> term_list;

    qi::rule<Iterator, Predicate(),
             qi::locals<std::vector<Variable>>, Skipper> predicate;

  };
} // namespace client

int main(int argc, const char** argv)
{
  typedef std::string::const_iterator iterator_type;
  typedef client::strips_domain_grammar<iterator_type> domain_grammar;

  domain_grammar g;

  std::string str;
  while (std::getline(std::cin, str))
  {
    if (str.empty() || str[0] == 'q' || str[0] == 'Q')
      break;

    using boost::spirit::ascii::space;

    client::Predicate predicate;
    std::string::const_iterator iter = str.begin();
    std::string::const_iterator end = str.end();
    bool r = phrase_parse(iter, end, g, space, predicate);

    if (r && iter == end)
    {
      std::cout << "-------------------------\n";
      std::cout << "Parsing succeeded\n";
      std::cout << "got: " << predicate.name;
      std::cout << "\n-------------------------\n";
    }
    else
    {
      std::cout << "-------------------------\n";
      std::cout << "Parsing failed\n";
      std::cout << "-------------------------\n";
    }
  }
} 
```

但代码导致以下错误（clang3.3 with libc++ and c++11; mac os x 10.8）：

```
boost/spirit/home/phoenix/stl/container/container.hpp:416:16: error: void function 'operator()' should not return a value [-Wreturn-type]
           return c.insert(arg1, arg2, arg3); 
```

如上所述，我认为错误是在规则`phoenix::insert`中的操作中使用的结果。`predicate`

我通过编辑 boost 标头并删除 return 语句“修复”了这个问题，但鉴于我对这个库的了解有限，我想避免这种情况......

有人可以解释问题或提出不同的解决方案吗？

# sql - 带有多部分标识符错误的日期排序列表

> ID：14967879
> 
> 赞同：1
> 
> 时间：2013-02-19T21:34:44.133
> 
> 标签：sql

```
"Project nr"    "Task"                "Task deadline"  "Task Type Production"

456             packed                1 april 2013      Packed
456             Leave production      3 april 2013      Leave Production
456             Flight date           9 april 2013      Flight Date
123             packed                1 april 2013      Packed
123             Leave production      6 april 2013      Leave Production
123             Flight date           9 april 2013      Flight Date
789             packed                1 april 2013      Packed
789             Leave production      9 april 2013      Leave Production
789             Flight date           9 april 2013      Flight Date 
```

我需要一个像上面这样的列表 我想按“停止生产”的日期排序项目 nr 必须像上面的列表一样保持在 3 组内。

我已经有了这个 SQL。该列表有效，但排序无效。错误是：无法绑定多部分标识符“任务。[任务期限]”。我如何得到排序？

```
 SELECT  [Project nr], Task, TaskDate
    FROM    (
    SELECT   MSP_EpmProject_UserView.[Project nr]
            ,MAX(CASE   WHEN [Task Type Production] = 'Packed' 
                        THEN [Task deadline] 
                    END) AS Packed
            ,MAX(CASE   WHEN [Task Type Production] = 'Leave Production' 
                        THEN [Task deadline]
                    END) AS [Leave Production]
            ,MAX(CASE   WHEN [Task Type Production] = 'Flight Date' 
                        THEN [Task deadline]
                    END) AS [Flight Date]
    FROM    MSP_EpmProject_UserView 
            LEFT JOIN MSP_EpmTask_UserView 
                ON MSP_EpmProject_UserView.ProjectUID = MSP_EpmTask_UserView.ProjectUID 
            LEFT JOIN MSP_EpmAssignment_UserView 
                ON MSP_EpmTask_UserView.TaskUID = MSP_EpmAssignment_UserView.TaskUID 
            LEFT JOIN MSP_EpmResource_UserView 
                ON MSP_EpmAssignment_UserView.ResourceUID = MSP_EpmResource_UserView.ResourceUID 
    WHERE (MSP_EpmTask_UserView.TaskIsProjectSummary = 0) 
    GROUP BY MSP_EpmProject_UserView.[Project nr]
    ) data
    UNPIVOT
    (
      TaskDate
      for [Task] in ([Pack],[Leave Production],[Flight Date])
    ) piv
    ORDER BY    data.[Task deadline] 
```

这是 ORDER BY 注释掉的结果。我也想要一个没有日期的字段的结果。

```
Project Nr     Task             TaskDate
0053           Packed           2013-02-05 17:00:00.000
0053           Leave Production 2011-04-26 17:00:00.000
0053           Flight Date      2011-04-22 17:00:00.000
0071           Leave Production 2011-06-24 17:00:00.000
0081           Leave Production 2012-03-09 17:00:00.000
0081-01        Leave Production 2012-03-09 17:00:00.000 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:41:00.173

我假设您有一个看起来像您问题中的初始表的表/视图/CTE。使用窗口函数获取所有相同“Project nr”的值，然后进行排序：

```
select "Project nr", "Task", "Task deadline", "Task Type Production"
from (select t.*,
             MAX(case when task = 'Leave Production' then "Task deadline" end) over (partition by "Project nr") as lpdl
      from t
     ) t
order by lpdl, 1 
```

# python - 跨函数共享 MySQLdb 事务

> ID：14967880
> 
> 赞同：3
> 
> 时间：2013-02-19T21:34:49.797
> 
> 标签：python, mysql, mysql-python

我正在使用 MySQLdb 使用 python 连接到 MySQL。我的表都是 InnoDB 并且我正在使用事务。

我正在努力想出一种跨职能“共享”交易的方法。考虑以下伪代码：

```
def foo():
    db = connect()
    cur = db.cursor()
    try:
        cur.execute(...)
        conn.commit()
    except:
        conn.rollback()

def bar():
    db = connect()
    cur = db.cursor()
    try:
        cur.execute(...)
        foo()  # note this call
        conn.commit()
    except:
        conn.rollback() 
```

在我的代码中的某些时候，我需要调用`foo()`并且在某些时候我需要调用`bar()`. 这里的最佳做法是什么？如果在外部而不是内部调用，我将如何告诉调用`foo()`到？如果有多个线程调用并且调用不返回相同的连接对象，这显然会更复杂。`commit()``bar()``bar()``foo()``bar()``connect()`

**更新**

我找到了一个适合我的解决方案。我已经包装`connect()`好在调用时增加一个值。调用`commit()`会减少该值。如果`commit()`被调用并且该计数器的 > 0，则不会发生提交并且值会递减。因此，您会得到：

```
def foo():
    db = connect()  # internal counter = 1
    ...
    db.commit()  # internal counter = 0, so commit

def bar():
    db = connect()  # internal counter = 1
    ...
    foo()  # internal counter goes to 2, then to 1 when commit() is called, so no commit happens
    db.commit() # internal counter = 0, so commit 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:37:13.347

IMO 最干净的方法是将连接对象传递给`foo`和`bar`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:38:10.823

声明函数外部的连接并将它们作为参数传递给函数

```
foo(cur, conn)
bar(cur, conn) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T02:18:33.250

在这种情况下，您可以利用 Python 的默认函数参数：

```
def foo(cur=None):
    inside_larger_transaction = False
    if cursor is None:
        db = connect()
        cur = db.cursor()
        inside_larger_transaction = True
    try:
        cur.execute(...)
        if not inside_larger_transaction:
             conn.commit()
    except:

        conn.rollback() 
```

因此，如果`bar`正在调用`foo`，它只是将游标对象作为参数传入。

并不是说我认为为每个小函数创建不同的光标对象没有多大意义——您应该将几个函数编写为对象的方法，并具有光标属性——或者始终显式传递光标（在这种情况下，使用另一个命名参数来指示当前函数是否是主要事务的一部分）

另一种选择是创建一个[上下文管理器](http://docs.python.org/2/reference/datamodel.html#with-statement-context-managers)类来进行提交，并在其中封装所有事务-因此，您的任何函数都不应该进行事务提交-您将保留对`__exit__`this 方法的transaction.commit 和 transaction.rollback 调用目的。

```
class Transaction(object):
    def __enter__(self):
       self.db = connect()
       cursor = self.db.cursor()
       return cursor
   def __exit__(self, exc_type, exc_value, traceback):
       if exc_type is None:
           self.db.commit()
       else:
           self.db.rollback() 
```

就像这样使用它：

```
def foo(cursor):
    ...

def foo(cur):
        cur.execute(...)

def bar(cur):
    cur.execute(...)
    foo(cur)

with Transaction() as cursor:
    foo(cursor)

with Transaction() as cursor:
    bar(cursor) 
```

# javascript - 任何人都准备好一些可用的脚本来将 xml 属性转换为 xml 标签？

> ID：14967882
> 
> 赞同：1
> 
> 时间：2013-02-19T21:35:03.637
> 
> 标签：javascript, xml, converter

例如，我有以下内容：

```
<Menu>
  <Item name="Favorite" type="Eats">
    <Item name = "Food" type="Tasty">
      <Item name="pizza" type="cheese">
      <Item name="Chicken" type="fried">
    </Item>
  </Item>
</Menu> 
```

进入以下：

```
<Menu>
  <Item>
    <name>Favorite</name>
    <type>Eats</type>
    <Item>
      <name>Food</name>
      <type>Tasty</type>
      <Item> <name>Pizza</name>   <type>Cheese</type> </Item>
      <Item> <name>Chicken</name> <type>Crispy</type> </Item>
    </Item>
  </Item>
</Menu> 
```

# c# - 如何在C#中获取元素的第一个和最后一个子节点内所有节点的值

> ID：14967885
> 
> 赞同：0
> 
> 时间：2013-02-19T21:35:11.767
> 
> 标签：c#, regex, linq, xml-parsing

我有一个具有以下结构的 XML 节点：

```
<package>package <name>com</name>.<name>sample</name>.<name>app1</name>;</package> 
```

*名称*标签可以出现随机次数，我想要的是获取元素列表中第一个和最后一个子节点之间的所有子节点的值，以获得这样的值：**com.sample.app1**。

我想我可以将某种类型的正则表达式应用于始终以“package”开头并以“;”结尾的*包节点的值。*或者也许是一些`LINQ`或`lambda`表达？

既然我正在处理一个大型 XML 文件并且该节点是其中的一部分，那么最有效的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:36:52.167

那么在这种情况下，我只会使用：

```
var package = string.Join(".", element.Elements("name").Select(x => x.Value)); 
```

（代表`element`在哪里`XElement``<package>`。）

或者，如果有不同的命名空间：

```
XNamespace ns = "http://some.namespace/here";
var package = string.Join(".", element.Elements(ns + "name")
                                      .Select(x => x.Value)); 
```

（代表在哪里`element`，并将a与 an组合以赋予权利。）`XElement``<package>``ns + "name"``string``XNamespace``XName`

# jquery - 为什么我的 if/else 不起作用

> ID：14967886
> 
> 赞同：0
> 
> 时间：2013-02-19T21:35:11.530
> 
> 标签：jquery, iframe

我试图在我的页面上搜索一个没有将“当前”属性设置为“当前”的 iframe。

（当前属性在使用 iframe 时设置，并在加载后重置）。

我正在尝试编写代码，以便如果有 1 个或多个 iframe 未设置为当前，则使用其中一个，否则，创建一个新的 iframe，做一些其他的事情并使用新的 iframe，

但是这段代码不太好用，我从不触发“警报”，所以即使我知道我没有未设置“当前”属性的 iframe，我也永远不会进入 ELSE 部分：

```
var $fi = $visible.find(".file-info");
        thisPreview = {};
        var iframes = $('iframe').filter(function (index) {
                return index == 0 || $('iframe').attr("current") == "no";
              })
        if(iframes.length >0){ //if one of the iframes hasnt got current set as current, use it
            var theSuffix = iframes.attr('id').split('_').pop();
            thisPreview[theSuffix] = $fi.prev(".image-preview");
            $(this).closest(".file-upload-form").children(".variable-hidden").attr('value',theSuffix);
            iframes.attr('current','current');
            $(this).closest('.file-upload-form').attr('target','upload_target_'+theSuffix);
        }
        else{//else, create a new iframe, quick!
            var count = $('[id^="upload_target_"]').length();
            alert(count);
            var countPlus1 = count+1;
            iframe = $('<frame>').attr({'id':'upload_target_'+countPlus1,'name':'upload_target_'+countPlus1,'current':'current'}).addClass('upload-target');
            iframe.appendTo($('#container'));
            thisPreview[countPlus1] = $fi.prev(".image-preview");
            $(this).closest(".file-upload-form").children(".variable-hidden").attr('value',countPlus1);
            $(this).closest('.file-upload-form').attr('target','upload_target_'+countPlus1);

        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:38:07.193

`index == 0`将返回`true`第一个 iframe，无论它是否具有该属性。

此外，`$('iframe').attr("current") == "no";`选择*所有*iframe。你想要当前的：

```
$(this).attr("current") == "no"; 
```

最后，不要编造自己的属性。使用`data-`前缀：

```
<div data-stuff="foo"></div> 
```

和`.data()`方法：

```
$('div').data('stuff') // "foo" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:41:27.233

您可以使用[属性不等于选择器](http://api.jquery.com/attribute-not-equal-selector/)

```
var iframes = $('iframe[current != "current"]')
if (iframes.length > 0) {
    // use old one
} else {
    // create new one
} 
```

[JSFiddle](http://jsfiddle.net/aYtWb/)用于测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:44:01.327

你确定这段代码给出了正确的结果吗？

```
return index == 0 || $('iframe').attr("current") == "no"; 
```

我对退货的使用感到困惑。它会返回“index == 0”的评估还是评估“index == 0”，如果它是假的，那么评估“$('iframe').attr("current") == "no"" ？我认为你希望它做后者，但它似乎模棱两可，它可能不会给你你期望的结果。

# shell - 如何在 zsh 提示符中添加最后一个命令？

> ID：14967888
> 
> 赞同：0
> 
> 时间：2013-02-19T21:35:16.733
> 
> 标签：shell, zsh, prompt

我不想要命令号或退出状态，我希望命令显示在我的 zsh 提示符中。有谁知道这是否可能，以及如何做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:42:38.467

您可能需要更多格式，但是：

```
 preexec() { PS1="$2\$ "; } 
```

# c++ - 从现有的一次创建新的类实例？

> ID：14967890
> 
> 赞同：1
> 
> 时间：2013-02-19T21:35:17.663
> 
> 标签：c++, vector

我有一个指向基类*foo*的指针向量，它有几个子类，我想做的是基于它是哪个子类，创建一个相同实例的新类。

我之前通过一个巨大的 for 循环解决了这个问题，它使用 typeid 来找出它是什么类，但是没有办法以更一般的方式解决它吗？

基本上，我正在寻找这样的东西：

```
std::vector<foo*> a;
std::vector<foo*> b;

//Store a couple of classes in a and b

b[0] = new typeid(a[0]).name(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T21:40:09.787

一种方法是使用一个虚拟`clone()`方法，该方法返回一个指向正确类型对象的指针：

```
struct base 
{
  virtual base* clone()=0;
  virtual ~base() {}
};

struct foo : public base
{
  virtual base* clone() { return new foo(*this); }
};

struct bar : public base
{
  virtual base* clone() { return new bar(*this); }
}; 
```

那么你的代码将是

```
b[0] = a[0].clone(); 
```

在现实生活中的代码中，您将返回一个智能指针，例如`std::unique_ptr<base>`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T21:48:55.300

每当你有一个基于类型的巨大开关时，你可能应该使用虚函数来代替。

您应该引入某种虚`clone()`函数：

```
#include <iostream>
#include <memory>

struct base
{
    virtual ~base() {};

    virtual void do_stuff() = 0;

    // cloning interface
    std::unique_ptr<base> clone() const
    {
        return std::unique_ptr<base>(do_clone());
    }

private:
    // actual clone implementation; uses a raw pointer to support covariance
    virtual base* do_clone() const = 0;
};

struct derived_A : base
{
    void do_stuff() override { std::cout << "stuff in derived_A" << std::endl; }

    // purposefully hide the base implementation,
    // since we know we'll be returning a derived_A
    std::unique_ptr<derived_A> clone() const
    {
        return std::unique_ptr<derived_A>(do_clone());
    }

private:
    derived_A* do_clone() const override
    {
        return new derived_A(*this);
    }
};

struct derived_B : base
{
    void do_stuff() override { std::cout << "stuff in derived_B" << std::endl; }

    // purposefully hide the base implementation,
    // since we know we'll be returning a derived_B
    std::unique_ptr<derived_B> clone() const
    {
        return std::unique_ptr<derived_B>(do_clone());
    }

private:
    derived_B* do_clone() const override
    {
        return new derived_B(*this);
    }
};

#include <vector>

int main()
{
    std::vector<std::unique_ptr<base>> v1;
    std::vector<std::unique_ptr<base>> v2;

    std::unique_ptr<base> x(new derived_A);
    v1.push_back(std::move(x));

    std::unique_ptr<base> y(new derived_B);
    v1.push_back(std::move(y));

    v1[0]->do_stuff();
    v1[1]->do_stuff();

    // clone
    v2.push_back(v1[0]->clone());
    v2.push_back(v1[1]->clone());

    v2[0]->do_stuff();
    v2[1]->do_stuff();
} 
```

我们希望返回类型的协变（如果您持有指向静态类型的指针`derived_A`，则克隆它应该产生 a`derived_A`以避免冗余强制转换），这就是克隆接口被分成两部分的原因。如果`std::unique_ptr<base>`与 协变，则可以一次性完成`std::unique_ptr<derived>`，但这仅适用于原始指针。

我确信有一种方法可以隐藏重复的样板文件，这对读者来说是一个练习。

* * *

编辑：实际上，给你；不是太难：

```
#include <memory>

// Note: leaves with a public: access specifier
#define DEFINE_ABSTRACT_CLONEABLE(selfType)         \
        DEFINE_CLONEABLE_DETAIL(selfType)           \
        private:                                    \
            virtual selfType* do_clone() const = 0; \
                                                    \
        public:

// Note: leaves with a public: access specifier
#define DEFINE_CLONEABLE(selfType)              \
        DEFINE_CLONEABLE_DETAIL(selfType)       \
        private:                                \
            selfType* do_clone() const override \
            {                                   \
                return new selfType(*this);     \
            }                                   \
                                                \
        public:

#define DEFINE_CLONEABLE_DETAIL(selfType)                                   \
        public:                                                             \
            std::unique_ptr<selfType> clone() const                         \
            {                                                               \
                static_assert(std::is_same<selfType,                        \
                                          std::decay<decltype(*this)>::type \
                                          >::value,                         \
                             "Must specify current class name.");           \
                                                                            \
                return std::unique_ptr<selfType>(do_clone());               \
            }                                                               \ 
```

和测试（注意较小的尺寸）：

```
#include <iostream>

#include "cloneable.hpp" // or whatever 

struct base
{
    // readable error: DEFINE_ABSTRACT_CLONEABLE(int);
    DEFINE_ABSTRACT_CLONEABLE(base);

    virtual ~base() {};

    virtual void do_stuff() = 0;
};

struct derived_A : base
{
    DEFINE_CLONEABLE(derived_A);

    void do_stuff() override { std::cout << "stuff in derived_A" << std::endl; }
};

struct derived_B : base
{
    // error: DEFINE_CLONEABLE(derived_B);
    DEFINE_ABSTRACT_CLONEABLE(derived_B);

    void do_stuff() override { std::cout << "stuff in derived_B" << std::endl; }
    virtual void do_thing() = 0; // abstract again
};

struct derived_AA : derived_A
{
    DEFINE_CLONEABLE(derived_AA);

    void do_stuff() override { std::cout << "stuff in derived_AA" << std::endl; }
};

struct derived_BB : derived_B
{
    DEFINE_CLONEABLE(derived_BB);

    void do_stuff() override { std::cout << "doing stuff in derived_BB" << std::endl; }
    void do_thing() override { std::cout << "doing thing" << std::endl; }
};

int main()
{
    std::unique_ptr<derived_AA> x(new derived_AA());
    x->do_stuff();

    auto xx = x->clone();
    xx->do_stuff();

    std::unique_ptr<derived_A> xxx = xx->clone();
    xxx->do_stuff();

    std::unique_ptr<base> xxxx = xxx->clone();
    xxxx->do_stuff();

    xxxx->clone()->do_stuff();

    std::unique_ptr<derived_BB> y(new derived_BB());
    y->do_stuff();
    y->do_thing();

    auto yy = y->clone();
    yy->do_stuff();
    yy->do_thing();

    std::unique_ptr<derived_B> yyy = yy->clone();
    yyy->do_stuff();
    yyy->do_thing();

    std::unique_ptr<base> yyyy = yyy->clone();
    yyyy->do_stuff();
    // error, lost derived information: yyyy->do_thing(); 

    yyyy->clone()->do_stuff();
} 
```

另一个改进是使每个新的`do_clone`纯虚拟声明都强制进一步派生类来实现它，但这*留给*读者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:41:42.117

更好的方法是使用`dynamic_cast`. 您可以尝试`dynamic_cast`ing 然后调用适当的复制构造函数。话虽如此，我会选择`clone`解决方案或尝试重新设计解决问题的方法。

例如，

```
child *c = dynamic_cast<child*>(base);
if(c != NULL) {
    return new child(c);
} 
```

# php - 访问 Lemonstand 配置工具

> ID：14967891
> 
> 赞同：0
> 
> 时间：2013-02-19T21:35:21.157
> 
> 标签：php

我在一个基于 Lemonstand 的站点上工作，我已经为其提供了代码和 mysql 数据库，但不幸的是，如果没有访问 Lemonstand 配置工具，我似乎无法在我的站点工作副本中配置 mysql 登录详细信息。客户不记得他们的登录详细信息，而且他们似乎与他们每天用于管理站点的登录详细信息不匹配，所以我想知道是否有：

*   一种重置配置工具登录详细信息的方法？
*   设置mysql连接配置变量的不同方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:48:39.457

请向 LemonStand 提交支持票。我们将帮助您重置设置并访问配置工具。

# c# - 按周拆分数据

> ID：14967902
> 
> 赞同：2
> 
> 时间：2013-02-19T21:36:00.233
> 
> 标签：c#, .net

我有一个具有时间戳的数据对象：

```
class MyDataObject
{
    public DateTime timestamp { get; set; }
    public int value { get; set; }

    public MyDataObject(DateTime timestamp, int value)
    {
        this.timestamp = timestamp;
        this.value = value;
    }
} 
```

在主要方法中，我在 18 天（2.5 周）的时间跨度内创建了很多这些数据对象：

```
 static void Main(string[] args)
    {
        List<MyDataObject> data = new List<MyDataObject>();

        data.Add(new MyDataObject(DateTime.Now, 1));
        data.Add(new MyDataObject(DateTime.Now.AddDays(2), 1));
        data.Add(new MyDataObject(DateTime.Now.AddDays(4), 1));
        data.Add(new MyDataObject(DateTime.Now.AddDays(6), 1));
        data.Add(new MyDataObject(DateTime.Now.AddDays(8), 1));
        data.Add(new MyDataObject(DateTime.Now.AddDays(10), 1));
        data.Add(new MyDataObject(DateTime.Now.AddDays(12), 1));
        data.Add(new MyDataObject(DateTime.Now.AddDays(14), 1));
        data.Add(new MyDataObject(DateTime.Now.AddDays(18), 1));
    } 
```

我需要将这些数据按周划分，以便将第 1 天到第 6 天之间的数据放在一个数组中，将第 8 天到第 14 天之间的数据放在另一个数组中，而第 18 天的数据单独放在另一个数组中。

我需要创建某种二维列表，并以某种方式将数据划分为“数组数组”，但我很难过。我怀疑我需要使用 List.FindAll 但我以前从未使用过它，也不知道在这种情况下如何使用它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T21:41:29.573

假设您可以使用 LINQ，您只需要以下内容：

```
var groupedByWeek = data.GroupBy(item => GetStartOfWeek(item.timestamp)); 
```

... where将在给定周开始时`GetStartOfWeek`返回 a ，例如`DateTime`

```
public static DateTime GetStartOfWeek(DateTime value)
{
    // Get rid of the time part first...
    value = value.Date;
    int daysIntoWeek = (int) value.DayOfWeek;
    return value.AddDays(-daysIntoWeek);
} 
```

这会给你一个以星期日为基础的一周。您需要对其进行一些调整，以考虑从周六、周一或其他任何时间开始的一周。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T21:41:36.410

您要做的第一件事是获取给定时间戳的周数。好吧，该[`GetWeekOfYear`](http://msdn.microsoft.com/en-us/library/system.globalization.calendar.getweekofyear.aspx)方法旨在做到这一点。并且使用 LINQ 的[`GroupBy`](http://msdn.microsoft.com/en-us/library/bb534501.aspx)扩展方法，将列表划分为不同的周非常容易。

```
using System.Globalization; // for Calendar
using System.Linq; // for GroupBy

...

DateTimeFormatInfo dfi = DateTimeFormatInfo.CurrentInfo;
Calendar cal = dfi.Calendar
var groups = data.GroupBy(x => cal.GetWeekOfYear(
    x.timestamp, dfi.CalendarWeekRule, dfi.FirstDayOfWeek)); 
```

# javascript - JS return's undefined when check and I change select option selected

> ID：14967908
> 
> 赞同：0
> 
> 时间：2013-02-19T21:36:08.480
> 
> 标签：javascript, select, checkbox, undefined, option

我有一个 HTML JS 代码：

```
<form action="/resize" method="GET" name="resolutionForm">
 <select name="res" id="res" onchange="checkzoom(this.value); checkcut('centercropcheck')">
  <option value="original"> Original</option><option value="800x600">800x600</option>
 </select>
 <input type="checkbox" id="stretchcheck" name="stretch" onclick="verificastretch(this.id);">Esticar
 <div id="results">
  <span>original: </span>
  <span>200x200</span>
  <span>zoom: </span>
  <span>0x</span>
  <span id="zoom">0x</span></span>
 </div>
</form>
<script type="text/javascript">
 function elembyid(id){
    return document.getElementById(id);
 }
 function checkzoom(v){
    if(v == '200x200' || v == 'original'){
        var zoom = '0x';
    }else{
        if(elembyid('stretchcheck').checked){
            verificastretch('stretchcheck');
        }else{
            var novow = Number(v.substr(0,v.lastIndexOf("x")));
            var novoh = Number(v.substr(v.lastIndexOf("x") +1, v.length));
            //alert('novow'+novow+'novoh'+novoh);
            var tamzoomw = novow / 200;
            var tamzoomh = novoh / 200;
            if(tamzoomw < tamzoomh){
                var zoom = (tamzoomw.length > 3? tamzoomw.toFixed(2) : tamzoomw)+'x';
            }else{
                var zoom = (tamzoomh.length > 3? tamzoomh.toFixed(2) : tamzoomh)+'x';
            }
        }
        elembyid('zoom').innerHTML = zoom;
    }
 }
 function verificastretch(id){
    var v = elembyid('res').value;
    if(v == '200x200' || v == 'original'){
        checkzoom(v);
    }else{
        if(elembyid(id).checked){
            //alert('aqui');
            var novow = Number(v.substr(0,v.lastIndexOf("x")));
            var novoh = Number(v.substr(v.lastIndexOf("x") +1, v.length));
            //alert('novow'+novow+'novoh'+novoh);
            var tamzoomw = novow / 200;
            var tamzoomh = novoh / 200;
            var zoom = (tamzoomw.length > 3? tamzoomw.toFixed(2) : tamzoomw)+'x '+(tamzoomh.length > 3? tamzoomh.toFixed(2) : tamzoomh)+'x';
            alert(zoom);
            elembyid('zoom').innerHTML = zoom;
        }else{
            checkzoom(v);
        }
    }
 }
</script> 
```

当拉伸的复选框被选中，并且我更改了 select res 的选定选项时，我在 div id = "result" 中得到未定义，我该如何解决这个问题？在文件中，代码没有这样的';' 因为复制时出错。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:59:53.637

在 if 条件之后

```
 if(elembyid('stretchcheck').checked){
            verificastretch('stretchcheck');
        }else{
            …
        } 
```

已完成并`verificastretch`已将 span 正确设置`zoom`为`4x 3x`， span`zoom`被`undefined`变量覆盖`zoom`：

```
 elembyid('zoom').innerHTML = zoom; 
```

我认为您希望在 else 子句中使用该行。

您可以通过使用调试器并从函数`checkzoom`开始单步执行代码来发现这一点。

# powershell-3.0 - PowerShell 3 PSCustomObject 通过变量以愚蠢的模式显示

> ID：14967920
> 
> 赞同：1
> 
> 时间：2013-02-19T21:36:53.477
> 
> 标签：powershell-3.0

PowerShell 3.0 为我们提供了 PSCustomObject 作为允许正确表格格式的类型，如下所示：

```
> [PSCustomObject]@{ Day = "Monday"; Task = "Wash car" }

Day     Task
---     ----
Monday   Wash car 
```

（见[http://blogs.microsoft.co.il/blogs/scriptfanatic/archive/2012/04/13/Custom-objects-default-display-in-PowerShell-3-0.aspx](http://blogs.microsoft.co.il/blogs/scriptfanatic/archive/2012/04/13/Custom-objects-default-display-in-PowerShell-3-0.aspx)）

但是如果我通过一个变量，它会恢复到愚蠢的模式。

```
> [PSCustomObject]$row = @{ Day = "Monday"; Task = "Wash car" }
> $row

Name    Value
---     ----
Task    Wash car
Day     Monday 
```

为什么？（谢谢）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:40:57.863

几乎立刻就解决了。

```
[PSCustomObject]$row = [PSCustomObject]@{ Day = "Monday"; Task = "Wash car" } 
```

实际上，我正在创建一个哈希表并将其转换为 PSCustomObject。仍然不完全确定为什么哈希表键没有变成像 .NET 4.0 DLR ExpandoObject 这样的属性。

用 C# 编写 CmdLets 要好得多。

# c# - 如何在 iTestSharp 中向 PdfCell 添加一个复选框？

> ID：14967922
> 
> 赞同：2
> 
> 时间：2013-02-19T21:37:07.870
> 
> 标签：c#, asp.net, .net, pdf, itextsharp

我正在生成一个 PDF，并希望添加带有标签的锁定复选框（选中和未选中，取决于收到的数据）。我不知道该怎么做。

```
cell.Phrase = new Phrase("Photos", boldFont);
table.AddCell(cell); 
```

该复选框应位于“照片”标签之前。我做了一些研究，但我找不到任何我想要的东西。有人可以帮忙吗？！

提前致谢！

# asp.net - 即使在 ASP.NET 中，也不会在页面加载后维护私有变量的值

> ID：14967925
> 
> 赞同：2
> 
> 时间：2013-02-19T21:37:12.207
> 
> 标签：asp.net, pageload, findcontrol

我有两页。first.aspx 和 second.aspx。为了从 first.aspx 中获取所有控制值，我在 second.aspx 中添加了指令

```
<%@ PreviousPageType VirtualPath="~/PR.aspx" %> 
```

我可以毫无问题地获取所有以前的页面控件并将其设置为标签，但我有一个大问题是将这些值保存到私有变量，并在页面加载事件完成后重用它。这是代码示例。当我尝试以另一种方法从输入中获取值时，它没有添加任何内容。为什么？

```
 public partial class Second : System.Web.UI.Page
        {        
            List<string> input = new List<string>();
            protected void Page_Load(object sender, EventArgs e)
            {
                    if (Page.PreviousPage != null&&PreviousPage.IsCrossPagePostBack == true)
                    {
                        TextBox SourceTextBox11 (TextBox)Page.PreviousPage.FindControl("TextBox11");
                        if (SourceTextBox11 != null)
                        {
                            Label1.Text = SourceTextBox11.Text;
                            input.Add(SourceTextBox11.Text);
                        }
                     }
              }

            protected void SubmitBT_Click(object sender, EventArgs e)
        {
                  //do sth with input list<string>
                  //input has nothing in it here.
         }
       } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:43:11.210

`SubmitBT_Click`-click 事件发生在回发中。但是所有变量（和控件）都在页面生命周期结束时处理。所以你需要一种方法来坚持你的`List`，例如在`ViewState`or`Session`中。

```
public List<String> Input
{
    get
    {
        if (Session["Input"] == null)
        {
           Session["Input"] = new List<String>();
        }
        return (List<String>)Session["Input"]; 
    }
    set { Session["Input"] = value; }
} 
```

[**在 ASP.NET 应用程序中管理持久用户状态的九个选项**](http://msdn.microsoft.com/en-us/magazine/cc300437.aspx)

# java - 下载facebook页面源代码

> ID：14967929
> 
> 赞同：0
> 
> 时间：2013-02-19T21:37:14.470
> 
> 标签：java, facebook

我需要下载某个 facebook 页面的源代码。所以我想我会登录到facebook，然后下载源代码。但是关于我登录的信息完全丢失了，当我尝试从另一个 url 下载源代码时，似乎我仍然为我的应用程序注销。

所以这是我的代码：

```
public class App 
{
    public static void main( String[] args ) throws IOException
    {
        System.out.println( "Hello World!" );

        final WebClient webClient = new WebClient();
        final HtmlPage page1 = webClient.getPage("http://www.facebook.com");
        final HtmlForm form = (HtmlForm) page1.getElementById("login_form");

        final HtmlSubmitInput button = (HtmlSubmitInput) form.getInputsByValue("Log In").get(0);
        final HtmlTextInput textField = form.getInputByName("email");
        textField.setValueAttribute("email");
        final HtmlPasswordInput textField2 = form.getInputByName("pass");
        textField2.setValueAttribute("password");
        final HtmlPage page2 = button.click();

        HtmlPage weread = webClient.getPage("http://apps.facebook.com/ireadit/?fb_source=bookmark_apps&ref=bookmarks&count=0&fb_bmpos=2_0");

                  System.out.println(weread.asXml());

    } 
```

我希望你能理解我的想法……有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:30:55.040

似乎您正在使用[HtmlUnit](http://htmlunit.sourceforge.net/)，您没有在问题中指定。

身份验证适用于 cookie。您尚未将其合并到您的代码中。当您第一次登录时，服务器会向您发送 cookie，您需要捕获这些 cookie 并在后续请求中重新发送。我对 HtmlUnit 不是很熟悉，但它看起来有一个 CookieManager 类，您可以使用它来获取这样的 cookie：

```
webClient.getCookieManager().getCookies(); 
```

您可能还想看看[这个问题](https://stackoverflow.com/questions/9609474/html-unit-login-to-secure-website-using-form-cant-connect-to-page-after-for)。

# flash - Stage3D 仿射纹理与正确的透视划分

> ID：14967932
> 
> 赞同：0
> 
> 时间：2013-02-19T21:37:18.727
> 
> 标签：flash, stage3d

在使用透视矩阵时，Stage3D 究竟如何能够做出正确的纹理映射？

除了 UV 之外，没有其他信息从顶点传输到片段程序，所以我只能假设它是幕后的东西。

我正在使用 20x20 三角形网格扭曲纹理以规避仿射贴图效果，但是否可以使用内置的透视分割来获得相同的效果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-02T16:44:09.117

当您的顶点坐标转换到裁剪空间时，顶点的 W 分量将为以正确透视方式插入纹理坐标提供系数。据我所知，这是 OpenGL 截锥矩阵提供给您的“魔法”，3D 硬件应该在插值期间使用这个值。Stage3D 库不保证如何为 UV 坐标的片段着色器执行插值。

还值得注意的是，据报道，一些 OpenGL ES 1.1 规范的 Android 手机不支持透视正确纹理。因此，即使 Stage3D 确实支持它，它也会因设备而异。

# .htaccess - 使用 htaccess 屏蔽域和文件夹名称

> ID：14967934
> 
> 赞同：2
> 
> 时间：2013-02-19T21:37:37.550
> 
> 标签：.htaccess, mod-rewrite

我正在尝试使用 htaccess 和 mod_rewrite 将一个域及其两个子文件夹与另一个域屏蔽。例如：`http://example.com/sub/sub-sub/`to`http://example-2.com/`所以`http://example-2.com/`浏览器地址栏中显示的是内容，`http://example.com/sub/sub-sub/`而页面中显示的是内容。

我发现[这个](https://stackoverflow.com/questions/3983391/use-htaccess-to-mask-folder-name)问题/答案应该可以做到这一点，但是当我实现它时它不起作用。

当前的htaccess：

```
Options +FollowSymlinks
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^/(.+) [NC]
RewriteRule .*   http://example.com/sub/sub-sub/%1 [L]

Options -Multiviews 
```

这是我的目录的视图：

![http://i.imgur.com/nihz1al.png](../Images/9d25b2ff9ab83f6ba8d628d3709fde46.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T23:28:43.433

您不需要 escape `-`，除非在字符类中。即使在那里，您也可以将其作为第一个或最后一个字符不转义。

在[RewriteRule](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriterule)中，模式是针对 URL 路径而不是域进行测试的。如果需要针对域进行测试，可以使用[RewriteCond](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond)

```
RewriteCond %{HTTP_HOST} !example-2.com
RewriteRule ^/?sub/sub-sub/(.*) http://example-2.com/$0 [R,L]

RewriteCond %{HTTP_HOST} example-2.com
RewriteCond %{REQUEST_URI} !^/?sub/sub-sub
RewriteRule .* sub/sub-sub/$0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T23:33:39.230

你可以试试这个：

```
Options +FollowSymlinks
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI}  !^/sub/sub-sub         [NC]
RewriteCond %{REQUEST_URI}  ^/(.*)                 [NC]
RewriteRule .*   http://example.com/sub/sub-sub/%1 [L] 
```

永久重定向

`http://example-2.com/anything`

到：

`http://example.com/sub/sub-sub/anything`

假定所有字符串都是固定的，除了段路径`anything`。

对于永久可见重定向，请替换`[L]`为`[R=301,L]`.

上述规则集必须包含在`http://example-2.com`根目录下的一个 .htaccess 文件中。

### 更新：

要跳过任何没有路径的传入 URL 的规则，例如`http://example-2.com/`，替换此行：

`RewriteCond %{REQUEST_URI} ^/(.*) [NC]`

有了这个：

`RewriteCond %{REQUEST_URI} ^/(.+) [NC]`

# apache - 是否有类似于静默安装 SQL Server 2008 R2 Express 的 Apache Tomcat 7.0.34 批量静默安装的指南？

> ID：14967936
> 
> 赞同：2
> 
> 时间：2013-02-19T21:37:45.303
> 
> 标签：apache, tomcat, batch-file, installation, silent

我尝试搜索并且很多链接都没有给我我正在寻找的答案。SQL 静默安装使用他们的 config.ini 文件很方便。Apache Tomcat 7.0.34 是否有类似的操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-01-26T13:45:21.707

我现在发现的只是一个例子：

```
apache-tomcat-7.0.35.exe /S /D=INSTALLDIR 
```

请注意，两个参数`/S`和`/D`都是**大写**的。在大多数 Windows 安装程序中，您可以使用`/?`dosplay 帮助，例如`-h`或`--help`在 linux 中

# java - MongoDB 中的事务

> ID：14967940
> 
> 赞同：10
> 
> 时间：2013-02-19T21:37:59.907
> 
> 标签：java, spring, mongodb, transactions

我正在使用带有 Java 和 Spring Data 的 NoSQL 数据库 MongoDB。我知道 MongoDB 只支持单个文档的事务。

我正在使用 Spring Transactions 来执行 MongoDB 事务。我正在使用事务模板。使用 TransactionTemplate 时我应该在 TransactionManager 中设置什么？

编辑

我有这样的事情：

```
<bean id=”txtTemplateBean” class=”org.springframework.transaction.support.TransactionTemplate”&gt;
<property name=”transactionManager” ref=”txnManagerBean”&gt;</property> 
```

我需要定义 txnManagerBean 来指向 MongoDB 数据库的 DataSourceTransactionManager 之类的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2018-02-18T17:07:41.587

MongoDB 4.0 现在支持多文档 ACID 事务！见[https://www.mongodb.com/blog/post/mongodb-multi-document-acid-transactions-general-availability](https://www.mongodb.com/blog/post/mongodb-multi-document-acid-transactions-general-availability)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-22T18:00:12.697

[MongoDB 确实支持使用两阶段提交的](http://docs.mongodb.org/manual/tutorial/perform-two-phase-commits/)*类似*事务的语义。

还有另一个[独立的工作](https://stackoverflow.com/a/12757751/1733060)是使用乐观锁定来支持 mongodb 中的事务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T10:35:19.297

MongoDB 不支持事务，它只支持原子操作。

[http://docs.mongodb.org/manual/tutorial/model-data-for-atomic-operations/](http://docs.mongodb.org/manual/tutorial/model-data-for-atomic-operations/)

这是使用乐观锁定为 MongoDB 实现事务的人的帖子： [https ://stackoverflow.com/a/12757751/1173560](https://stackoverflow.com/a/12757751/1173560)

# javascript - HTML5 可在边界内拖动

> ID：14967944
> 
> 赞同：1
> 
> 时间：2013-02-19T21:38:10.447
> 
> 标签：javascript, html

Html5 元素有一个新的属性，draggable，并像这样使用它。

[http://www.w3.org/TR/2011/WD-html5-20110405/dnd.html](http://www.w3.org/TR/2011/WD-html5-20110405/dnd.html)

```
 <div draggable="true">foo</div> 
```

它还接受带有鼠标事件参数的事件 ondrag。

```
 <div draggable="true" ondrag="drag(event)">foo</div> 
```

我的问题是；有没有办法设置拖动边界，以便我只能水平拖动，就像在 JQuery 中一样，[http://jqueryui.com/draggable/#constrain-movement](http://jqueryui.com/draggable/#constrain-movement)。

不使用 JQuery.. 仅使用 Javascript..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T22:33:46.203

HTML5 的可拖动界面与 jQuery UI 的可拖动界面有很大的不同。它的目的不是让您在沙箱中移动元素，而是让您通过视觉反馈移动数据。

当您使用 jQuery draggable 拖动某些东西时，它会影响屏幕上的视觉变化。它会更改元素的偏移量，使其出现在新位置，并且有许多选项可让您控制其移动的位置和方式。html draggable 属性的存在是为了让您对现有的拖放机制有更多的控制。例如，您可以突出显示文本并将其拖动到任何可让您输入文本的地方，它会复制文本。此外，您可以将图像从浏览器拖到文件夹中，它会复制图像。

就像如果用户将图像从浏览器屏幕拖到桌面上，您无法限制用户的鼠标移动一样，我不相信您对用户使用 html 属性将某些内容拖到哪里有任何权力。相反，该机制允许您扩展可以拖放的内容，超出文本和图像。在某些情况下，您可以完全禁用该机制，但它不允许对用户决定如何处理数据进行细粒度控制。这是一种非常高级的机制，它允许在完全不同的应用程序之间传输数据，并且给你太多的权力来控制它的行为可能会破坏它在不同情况下工作的能力。

# sql - SQL 部分主键、复合键

> ID：14967945
> 
> 赞同：1
> 
> 时间：2013-02-19T21:38:14.163
> 
> 标签：sql

在作者/标题实体中，两个“主”键应该一起作为主键，我怎么能在 sql 中做到这一点。我需要创建一个保存这些值的新密钥吗？我知道你不允许两个实体中有两个主键，但我不知道如何写它们是组合键/部分主键。我正在使用 sql server 2008

这是 er 图的链接 ( [http://img69.imageshack.us/img69/3048/68810818.png](http://img69.imageshack.us/img69/3048/68810818.png) )

![在此处输入图像描述](../Images/e34925bad25c81cb488b603c127862a6.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T21:49:08.800

在不考虑模型的正确性的情况下，可以像这样创建复合（又名复合）主键：

```
CREATE TABLE "Author/Title" (
    author_name VARCHAR(50),
    isbn VARCHAR(13) REFERENCES "Item Details",
    PRIMARY KEY (author_name, isbn)
) 
```

这将允许相同`author_name`的具有不同的`isbn`并且仍然被认为是唯一的（反之亦然）。

通过将这两个字段标记为 PK 的一部分，可以从 SQL Server Management Studio 实现类似的效果。

# jquery - 在 Fancybox 中打开静态谷歌地图？

> ID：14967948
> 
> 赞同：0
> 
> 时间：2013-02-19T21:38:28.013
> 
> 标签：jquery, google-maps, fancybox

单击链接时，我正在尝试将静态谷歌地图加载到花式框/灯箱中。我的代码是

```
<a href="http://maps.googleapis.com/maps/api/staticmap?
 zoom=13&size=400x400&markers=color:blue|32,50&sensor=true"><img src="icon.png" /></a> 
```

但它不会显示，iframe 保持为空。我想这是因为地图应该作为 IMG 元素的 src 加载，对吧？

知道如何解决这个问题吗？

另一种方法是在 viframe 中打开一个普通的谷歌地图，但它总是显示两个标记，一个在该位置，一个是谷歌的“最佳猜测” - 有没有办法删除那个“最佳猜测”标记？有关示例，请参见[http://blog.felixsalomon.net](http://blog.felixsalomon.net)，单击第一篇文章标题旁边的小地图图标。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T04:00:27.587

静态地图（使用 Google [Static Map API](http://code.google.com/apis/maps/documentation/staticmaps/)）可以呈现为常规图像。

由于您的链接：

```
<a class="fancybox" href="http://maps.googleapis.com/maps/api/staticmap?zoom=13&size=400x400&markers=color:blue|32,50&sensor=true"><img src="icon.png" /></a> 
```

...不告诉fancybox这是一个`image`（因为它没有图像扩展名），您必须强制`type`fancybox需要处理的内容如下：

```
$(".fancybox").fancybox({
    "type":"image"
}); 
```

**请注意**，我添加`class="fancybox"`了锚点，因此可以将 fancybox 绑定到该选择器。

参见**[JSFIDDLE](http://jsfiddle.net/eeZFb/)**（使用 fancybox v1.3.4）

**编辑**：由于您使用的是 fancybox WP 插件，或者您可以将`image`扩展名添加到 URL 末尾的锚点，`&filename=image.jpg`例如添加 ... 这样您的完整 URL 将如下所示：

```
href="http://maps.googleapis.com/maps/api/staticmap?zoom=13&size=400x400&markers=color:blue|32,50&sensor=true&filename=image.jpg" 
```

如果您这样做，则不必编辑 Easyfancybox 脚本。检查**[更新的 JSFIDDLE](http://jsfiddle.net/eeZFb/3/)**

# xamarin.ios - 如何发起/触发你自己的事件？（就像一个 UIButton）

> ID：14967957
> 
> 赞同：4
> 
> 时间：2013-02-19T21:39:20.680
> 
> 标签：xamarin.ios

我找到了很多关于如何对事件（或委托）做出反应的资源。例如：

```
Control.ValueChanged += (sender, e) =>
        {
            //do something
        }; 
```

但是，我不知道如何创建自己的事件？基本上我有一个类需要“触发”一个事件，并且在创建这个对象的类中你可以对这个事件做出反应。

任何的想法？

如果我要使用 Delegate 来代替，我应该怎么做（创建我自己的可以由另一个类实现的 Delegate 对象）？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-19T21:42:01.480

你的意思是这样的？

```
class Foo
{
    public event EventHandler MyEvent;

    public void DoSomething()
    {
        // do stuff

        // raise the MyEvent event
        var handler = MyEvent;
        if (handler != null)
        {
            handler(this, EventArgs.Empty);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T22:45:30.883

我个人使用`Action`s。

```
public abstract class ServiceClient
{
    public Action OnNetworkActivityStarted { get; set; }

    private void StartNetworkActivity()
    {
        if (OnNetworkActivityStarted != null)
            OnNetworkActivityStarted();
    }
} 
```

任何继承类都将/可以使用您在上面提供的逻辑。

```
public class MyClient : ServiceClient
{
    public MyClient()
    {
        this.OnNetworkActivityStarted += () => 
        {
            //do whatever the subclass needs to do when the event is fired
        };    
    }
} 
```

我已经在我计划用于跨平台移动应用程序的类库中实现了这个。这允许每个设备实施自己的策略，让用户知道网络已经启动。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T23:21:43.357

根据您的需要，您可以做两种不同的事情：

*   您可以创建一个包含委托的变量（变量类型将是所述委托的）。当您希望能够在对象之外实现功能时，您通常会这样做。你也可以使用这个东西返回一个值，这样你就可以用它来改变对象的状态。

*   您可以创建一个事件。当您希望能够防止某些对象在您的对象中发生某些事情时，您会这样做：您触发一个事件。您的对象根本不应该知道之后发生的事情。这通常是您在实现 View 时所做的，您会触发一些事件，以便 Controller 可以知道 View 中发生了什么。然后他可以决定之后如何处理视图。

第一个例子，名称检索没有在控制器中定义，它必须由外部设置。控制器不知道它是如何工作的，但它想检索一个整数 id 的名称。它的工作方式与接口相同：

```
public class MyController {
    private NameForIDFetcher NameFetcher { get; set; }
    private List<int> _ids = new List<int>();

    public delegate string NameForIDFetcher(int id);

    public void showNames() {
        if (this.NameFetcher == null) {
            throw new Exception("No NameFetcher set.");
        }

        foreach (int id in this._ids) {
            Console.WriteLine(id + ": " + this.NameFetcher(id));
        }
    }
} 
```

第二个例子，当视图出现和消失时，视图可以阻止所有可能连接到事件的监听器。如果没有人连接，视图不应该改变它的行为（如果有人知道它应该的情况，请告诉我）。你可以注意到我第二次使用了 Action，它是一个通用的委托，它返回 void 并采用你在参数中提供的模板。您最多可以有 16 个模板参数，这意味着委托将采用 16 个参数，但这将是一个非常讨厌的委托，不是吗？

```
public class MyView {

    public event ViewAction onViewAppeared;
    public event Action<MyView> onViewDisappeared;

    public delegate void ViewAction(MyView view);

    public void show() {
        // Stuffs

        if (this.onViewAppeared != null) {
            this.onViewAppeared(this);
        }
    }

    public void hide() {
        // Stufs

        if (this.onViewDisappeared != null) {
            this.onViewDisappeared(this);
        }
    }
} 
```

# php - wpsc 购买按钮在 IE 的结帐页面上不起作用

> ID：14967958
> 
> 赞同：0
> 
> 时间：2013-02-19T21:39:20.263
> 
> 标签：php, wordpress, e-commerce

不太确定从哪里开始，该网站在除 Internet Explorer 之外的所有浏览器中都能正常运行

这是网址[https://bonaccord.co.nz/shop/checkout/](https://bonaccord.co.nz/shop/checkout/)

我一直在到处寻找答案，但还没有找到解决方案，大多数论坛都没有答案。

看起来按钮在单击时什么都不做？我不确定为什么会这样，因为我有另一个网站，其按钮完全相同。

有效购买按钮的 URL [http://www.odarid.co.nz/dev/checkout/](http://www.odarid.co.nz/dev/checkout/)

我认为这可能与最近安装的 SSL 有关，但禁用时按钮仍然不起作用

此外，在 IE 中使用开发人员工具时，我会收到此消息

对象不支持此属性或方法

它引用的代码是

```
jQuery("form.product_form").livequery(function(){
    product_id = jQuery('input[name="product_id"]',this).val();
    image_element_id = 'product_image_'+product_id;
    jQuery("#"+image_element_id).data("product_id", product_id);
    parent_container = jQuery(this).parents('div.product_view_'+product_id);
    jQuery("div.item_no_image", parent_container).data("product_id", product_id);
}); 
```

然后我尝试禁用我编写的脚本，看看它们是否导致 wp-ecommerce js 出现问题，但仍然遇到同样的问题......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T00:41:54.467

最后，我将 wpsc-shopping_cart_page.php 重新复制到我的主题中，并注意到它与我最初的 wpsc-shopping_cart_page.php 不同。

看起来更新 wpsc 插件后，一些模板文件发生了变化，所以我不得不重新设置新模板的样式。

# java - 在 Crouton 库中滚动文本

> ID：14967963
> 
> 赞同：3
> 
> 时间：2013-02-19T21:39:51.443
> 
> 标签：java, android, marquee, crouton

crouton 库可以[在 Github](https://github.com/keyboardsurfer/Crouton)上找到， 我的问题是，是否可以让 Crouton 中显示的文本水平滚动。在 TextView 中可以这样做：

```
android:singleLine="true" 
android:ellipsize="marquee"
android:marqueeRepeatLimit ="marquee_forever"
android:scrollHorizontally="true"
android:focusable="true"
android:focusableInTouchMode="true" 
```

但这在面包丁中也可以吗？我感谢每一个帮助/答案！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T09:41:03.270

`Crouton.show(Activity, View)`您可以通过及其等效`Crouton.make(...)`方法向 Crouton 提供自定义视图。

您自定义的 View 也可以是一个可以永远选择框的 View。

# ruby-on-rails - 在 Rails 应用程序中编辑文件并保存回来

> ID：14967966
> 
> 赞同：0
> 
> 时间：2013-02-19T21:40:03.367
> 
> 标签：ruby-on-rails, git, markdown

我想添加此功能，但对实现它的方法有点不确定。基本上希望我能够做的是：

在 /admin 访问我网站的管理区域 单击链接以编辑主页内容 在文本区域中显示 /app/views/pages/_home.md 的内容 对其进行更改并将其保存回来

基本上，只是不确定这是否可行，如果可以，这将如何适合我的 Github 存储库？

亲切的问候，尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:53:36.940

您会遇到几个问题。

第一个是您的应用程序服务器不会接收这些更改，因为它们都是在应用程序服务器启动时加载和缓存的。如果您使用像 unicorn 这样的应用服务器，那么您需要向它发送一个重启信号，这将需要几秒钟的时间让新的主进程启动并且您的更改生效。

您已经指出的另一个问题是，如果您使用 capistrano 进行自动部署，那么您的更改将在下一次部署时恢复，除非您随后以正常方式手动提交相同的更改，这会违背目的。

通常，处理此问题的方法是将模板移动到数据库表中，这可以解决这两个问题，但意味着您唯一的编辑方式是通过 UI。

如果您仍然打算完成这项工作，那么第一个问题很容易开始工作。只需外壳并执行适当的命令即可重新启动应用程序服务器。在我的部署中，我在脚本/独角兽中有一个独角兽控制脚本，它将被触发`system('script/unicorn restart')`. 第二个问题更加棘手，因为您需要为服务器运行的用户提供 ssh 密钥，并且能够以该用户的身份推送到您的存储库。一旦你有了它，你就可以进行更改，git add，git commit，最后推送。这将变得有点肮脏的地方是必须处理一个在部署之前的分支，并且必须在能够推送之前拉/合并。一个可能的解决方案是在 github 上有一个特定的分支（即生产分支），它始终与部署的内容同步。在推送和部署的人与在 UI 上进行编辑的人之间仍然会有一个小窗口，推送会失败。如果当前部署的 HEAD 与 github 生产分支不匹配，也可以通过锁定 UI 编辑器来缓解这种情况，当部署同步它们时解锁它。

# google-bigquery - 创建公共数据集（或：跨两个项目拆分存储成本和计算成本）

> ID：14967967
> 
> 赞同：6
> 
> 时间：2013-02-19T21:40:04.713
> 
> 标签：google-bigquery

我想使用 BigQuery 托管其他人可以查询的数据集，而不会对我的项目产生处理费用。我了解当我将数据集上传到项目时，存储成本与项目相关。我希望其他人能够发现我的数据集，通过**他们的**项目/帐户访问它（最好没有我的干预），并在他们选择付费的情况下运行尽可能多的查询。因此，存储成本将归我所有，但计算成本将归运行查询的人所有。

有没有办法在 BigQuery 中做到这一点？我通过 Google Cloud 企业销售[网络表单](https://cloud.google.com/contact)提出了这个问题，但没有得到回复。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T22:56:44.410

绝对地！您当然可以公开数据集以供其他项目查询，甚至可以仅与特定域、组或用户共享您的数据集。

在此模型中，用户需要为查询他们自己的项目 ID 付费，而您的项目将承担数据集的存储成本。请注意，如果在不同项目中运行查询的用户想要存储其查询结果中的结果表，他们当然会自己为此存储付费。

BigQuery 目前不提供公共数据集发现机制。您必须自己共享项目公共数据集的详细信息。[GitHub Archive](http://www.githubarchive.org/)项目就是一个很好的例子。

# django - 会话问题 - 但它是会话问题吗？

> ID：14967968
> 
> 赞同：-1
> 
> 时间：2013-02-19T21:40:07.233
> 
> 标签：django, http, session, http-post, httprequest

我被困在这个小问题上。我有一个用户需要登录的页面。登录后一切都很好。但是一旦用户登录，如果他点击地址栏`enter`，这个错误 -`Key 'username' not found in <QueryDict: {}>`即将出现并在页面上显示错误。
这是我的登录代码：

```
if request.path == '/cms/':
    request.session['username'] = request.POST['username']
    request.session['password'] = request.POST['password']
    #check for login
    if User.objects.exists():
        u=User.objects.get(id=1)
        if u.username==request.session['username'] and u.password==request.session['password']:
            #do some stuff here, cos i am logged in 
```

现在，如果我重新加载页面，那很好，但`enter`没有。我应该将 POST 数据保存到会话中吗？这里到底发生了什么？

多谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:43:41.507

包含什么`request.POST`？它不包含用户名。要找出它包含的内容，您可以打印 request.POST 它应该显示在您的开发服务器上，或者您可以在某处记录该值，或者您可以输入调试器并使用检查`import pdb; pdb.set_trace()`

python字典有[`get`](http://docs.python.org/2/library/stdtypes.html#dict.get)这种情况的方法

`request.POST.get('username')`

如果未找到密钥，则`None`默认返回而不是`KeyError`

您是否正在向您的视图发出发布请求？

```
<form method="post" action="/yoururlhere/">
  <input type="text" name="username" />
  <input type="text" name="password" />
  <input type="submit" value="submit" />
</form> 
```

上面的表格将发布`username`and`password`字段。我认为完整阅读[https://docs.djangoproject.com/en/dev/topics/auth/](https://docs.djangoproject.com/en/dev/topics/auth/)并学习如何使用用户管理中内置的 django 非常重要。Django 提供了 User 对象（看起来你正在使用）并提供所有必要的功能来管理他们的身份验证。

这很重要，因为：

1.  一旦你学会了，它比手动做更容易
2.  因为它更容易，所以它很可能比自己管理身份验证更快
3.  与手动操作相比，它更不容易出错。DJango 源代码有很多人关注它，并且有很多测试覆盖它。请使用内置工具来确保您的站点安全。

# c - 使用 SSE 的高效 4x4 矩阵向量乘法：水平加法和点积 - 有什么意义？

> ID：14967969
> 
> 赞同：16
> 
> 时间：2013-02-19T21:40:08.000
> 
> 标签：c, performance, optimization, sse, matrix-multiplication

我正在尝试使用 SSE 找到 4x4 矩阵 (M) 与向量 (u) 乘法的最有效实现。我的意思是 Mu = v。

据我了解，有两种主要方法可以解决此问题：

```
 method 1) v1 = dot(row1, u), v2 = dot(row2, u), v3 = dot(row3, u), v4 = dot(row4, u)
    method 2) v = u1 col1 + u2 col2 + u3 col3 + u4 col4. 
```

方法 2 在 SSE2 中很容易实现。方法 1 可以使用 SSE3 中的水平加指令或 SSE4 中的点积指令来实现。但是，在我所有的测试中，方法 2 总是优于方法 1。

我认为方法 1 具有优势的一个地方是 3x4 矩阵，例如仿射变换。在这种情况下，最后一个点积是不必要的。但即使在这种情况下，4x4 矩阵上的方法 2 也比 3x4 矩阵上的方法 1 更快。我发现在 4x4 矩阵上比方法 2 更快的唯一方法是在 4x3 矩阵上的方法 2。

那么水平加法和点积指令有什么意义呢？事实上，在这种情况下，点生成指令的性能最差。也许它与数据的格式有关？如果无法定义矩阵的排序方式，那么转置是必要的，在这种情况下，方法 1 可能会更好？

请参阅下面的一些代码。

```
__m128 m4x4v_colSSE(const __m128 cols[4], const __m128 v) {
  __m128 u1 = _mm_shuffle_ps(v,v, _MM_SHUFFLE(0,0,0,0));
  __m128 u2 = _mm_shuffle_ps(v,v, _MM_SHUFFLE(1,1,1,1));
  __m128 u3 = _mm_shuffle_ps(v,v, _MM_SHUFFLE(2,2,2,2));
  __m128 u4 = _mm_shuffle_ps(v,v, _MM_SHUFFLE(3,3,3,3));

  __m128 prod1 = _mm_mul_ps(u1, cols[0]);
  __m128 prod2 = _mm_mul_ps(u2, cols[1]);
  __m128 prod3 = _mm_mul_ps(u3, cols[2]);
  __m128 prod4 = _mm_mul_ps(u4, cols[3]);

  return _mm_add_ps(_mm_add_ps(prod1, prod2), _mm_add_ps(prod3, prod4));
}

__m128 m4x4v_rowSSE3(const __m128 rows[4], const __m128 v) {
  __m128 prod1 = _mm_mul_ps(rows[0], v);
  __m128 prod2 = _mm_mul_ps(rows[1], v);
  __m128 prod3 = _mm_mul_ps(rows[2], v);
  __m128 prod4 = _mm_mul_ps(rows[3], v);

  return _mm_hadd_ps(_mm_hadd_ps(prod1, prod2), _mm_hadd_ps(prod3, prod4));
}

__m128 m4x4v_rowSSE4(const __m128 rows[4], const __m128 v) {
  __m128 prod1 = _mm_dp_ps (rows[0], v, 0xFF);
  __m128 prod2 = _mm_dp_ps (rows[1], v, 0xFF);
  __m128 prod3 = _mm_dp_ps (rows[2], v, 0xFF);
  __m128 prod4 = _mm_dp_ps (rows[3], v, 0xFF);

  return _mm_shuffle_ps(_mm_movelh_ps(prod1, prod2), _mm_movelh_ps(prod3, prod4),  _MM_SHUFFLE(2, 0, 2, 0));
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-20T02:50:09.067

水平加法和点积指令很复杂：它们被分解为多个更简单的微操作，这些微操作就像简单的指令一样由处理器执行。将水平加法和点积指令精确分解为微操作是特定于处理器的，但对于最近的英特尔处理器，水平加法被分解为 2 个 SHUFFLE + 1 个 ADD 微操作，而点积被分解为 1 个 MUL + 1 个 SHUFFLE + 2 个 ADD 微操作。除了大量的微操作之外，这些指令还强调了处理器流水线中的指令解码器：英特尔处理器每个周期只能解码一条这样的复杂指令（与 4 条简单指令相比）。在 AMD Bulldozer 上，这些复杂指令的相对成本甚至更高。

# mongodb - 用于 grails 1.3.7 的 Mongodb 聚合框架

> ID：14967971
> 
> 赞同：0
> 
> 时间：2013-02-19T21:40:09.797
> 
> 标签：mongodb, grails, grails-plugin

如何在 Grails 1.3.7 中使用聚合框架。目前我无法迁移到新版本的 grails。我已经尝试过 grails mongodb 插件 1.0.0.GA，但它使用的是旧的 java 驱动程序和 gmongo 库。我还尝试在 build-config.groovy 中为新的 libs/jars 添加依赖项，但它仍然在运行时给我聚合方法的错误。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T04:05:45.250

在你的 BuildConfig.groovy 中放这个

依赖{

```
 compile "org.mongodb:mongo-java-driver:2.10.1"
    runtime "com.gmongo:gmongo:1.1"
} 
```

然后在插件部分

插件{

```
 compile (":mongodb:1.1.0.GA"){
        excludes 'mongo-java-driver', 'gmongo'
    }
} 
```

这将更新您的 mongodb 插件以使用最新的 java 驱动程序和 gmongo。

然后使用聚合框架。例子

```
 DBObject match = new BasicDBObject('$match', new BasicDBObject("adPostId", 50) );

    // build the $projection operation
    DBObject fields = new BasicDBObject("adPostId", 1);
    fields.put("shopperId", 1);
    fields.put("_id", 0);
    DBObject project = new BasicDBObject('$project', fields );

    // Now the $group operation
    DBObject groupFields = new BasicDBObject( "_id", '$karmaType');
    groupFields.put("average", new BasicDBObject( '$sum', '$rating'));
    DBObject group = new BasicDBObject('$group', groupFields);

    // run aggregation
    AggregationOutput output = db.karma.aggregate( match, project, group ); 
```

返回 [model:[avgkarma:output.getCommandResult()]]

# java - 用 LWJGL 理解 openGL 的一个小抽象

> ID：14967975
> 
> 赞同：4
> 
> 时间：2013-02-19T21:40:29.327
> 
> 标签：java, opengl, buffer, lwjgl

LWJGL API 不是直接的 openGL 调用，我所看到的任何地方都有一个小的抽象层，我想这就是为什么它被称为轻量级。

许多抽象是相似的，例如，这个例子中的代码在整个源代码中都是通用的

```
public static void glBufferSubData(int target, long offset, FloatBuffer data) {
    ContextCapabilities caps = GLContext.getCapabilities();
    long function_pointer = caps.glBufferSubData;
    BufferChecks.checkFunctionAddress(function_pointer);
    BufferChecks.checkDirect(data);
    nglBufferSubData(target, offset, (data.remaining() << 2), MemoryUtil.getAddress(data), function_pointer);
} 
```

如您所见，LWJGL 用户将调用此函数，然后此函数将调用真正的 GL 函数。我假设 nglBufferSubData 中的“n”代表本地。

所以我的问题是，这段代码是什么意思？我知道这个函数的作用，它将数据提交到 openGL 缓冲区对象中。我只是不明白代码中发生的事情。有人可以帮我分解吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T12:06:40.223

一些 OpenGL 功能可通过扩展获得。不同的平台支持 OpenGL 规范的不同扩展甚至特性。

`ContextCapabilities`类知道支持哪些功能。

`long function_pointer = caps.glBufferSubData;`获取指向原生 OpenGL 方法[glBufferSubData](http://www.opengl.org/wiki/GLAPI/glBufferSubData)的指针。

`BufferChecks.checkFunctionAddress(function_pointer);`检查该指针是否不为空，如果不支持 null - 功能并引发异常。

`BufferChecks.checkDirect(data);`确保缓冲区[是否是直接](http://download.java.net/jdk7/archive/b123/docs/api/java/nio/ByteBuffer.html)的（并且隐含地，非空）。

`nglBufferSubData(target, offset, (data.remaining() << 2), MemoryUtil.getAddress(data), function_pointer);`现在我们有了正确的数据和指向[glBufferSubData](http://www.opengl.org/wiki/GLAPI/glBufferSubData)的正确指针，在这里我们使用指定的目标、偏移量和字节大小来调用它。

# python - 从 os.walk 创建字典理解

> ID：14967977
> 
> 赞同：4
> 
> 时间：2013-02-19T21:40:31.793
> 
> 标签：python, python-3.x

我正在尝试创建所有 mp3 文件的字典，其中键是 mp3 文件名，值是该文件的文件路径。

我愿意：

```
for root, dirs, files in os.walk(rootDir, topdown='true'):
    source_files_now = {filename:root for filename in files if filename[-4] == '.mp3'}
    print(source_files_now); 
```

但是字典 source_files_now 最终是空的。

目录中肯定有mp3文件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T21:41:39.590

`filename[-4] == '.mp3'`检查倒数第三个字符是否为`'.mp3'`. 这真的没有意义。

只需使用`.endswith()`：

```
filename.endswith('.mp3') 
```

如果要修复代码，请对字符串进行切片，以便切片包含其他字符：

```
filename[-4:] == '.mp3' 
```

在比较之前，我还将文件名转换为小写。您最终可能会跳过全部大写的文件名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T21:55:54.867

除了已经提到的 [-4] 问题之外，您还在 for 循环中不断覆盖 source_files_now。在循环上方初始化它并添加到它而不是使用 dict 理解。

```
source_files_now = {}
for root, dirs, files in os.walk(rootDir):
    for filename in files:
        if filename.endswith('.mp3'):
            source_files_now[filename] = os.path.join(root, filename) 
```

它不会破坏你的脚本，但它应该是 topdown=True，而不是 topdown='true'。我删除了它，因为 True 是默认值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:42:58.323

您索引字符串略有错误：

```
>>> s = 'buddyholly.mp3'
>>> s[-4]
'.'
>>> s[-4:]
'.mp3' 
```

# python - python smtplib sendmail 失败

> ID：14967984
> 
> 赞同：-1
> 
> 时间：2013-02-19T21:40:55.893
> 
> 标签：python, email, smtp, cgi, smtplib

```
import smtplib

fromaddress = 'me@example.com'
toaddress = [fromaddress]
message = """
From: %s
To: %s
Subject: test

Hello

Goodbye
""" % ( fromaddress, toaddress)

server = smtplib.SMTP('mydomain.com') 
server.set_debuglevel(1) 
server.sendmail(fromaddress, toaddress, message) 
```

此代码可以打开一个套接字，但随后在 sendmail 上失败，并出现“连接意外关闭”错误。通过查看[smtplib 源](http://hg.python.org/cpython/file/2.7/Lib/smtplib.py)，当 smtp 服务器返回一个空响应时，就会发生这种情况。

我从上面的代码中遗漏了什么？我在一个便宜的虚拟主机上运行它作为一个 cgi 脚本，作为他们服务的一部分，他们安装了 sendmail 和 python 服务。在他们的文档中，他们有标准的“在 php 中发送电子邮件”代码示例，不需要身份验证，所以我认为同样适用于 python。

任何人有任何见解？如果有帮助，主机是hostgator。

编辑：

根本错误是 smtp 服务器发出硬重置，即 TCP 'Connection reset by peer'。电子邮件服务器在什么情况下会这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:21:06.840

您正在尝试通过 SMTP 发送，这通常是通过某种身份验证（用户名 + 密码）实现的。如果您不进行身份验证（或者您的 IP 地址在给定时间间隔内身份验证失败次数过多），大多数 SMTP 服务器将立即终止连接。

通过调用`smtplib.SMTP([host[, port[, local_hostname[, timeout]]]])`，您正在尝试打开与 的连接`mydomain.com`。大多数 webhosts 将有一个集中的邮件系统（ SMTP / IMAP ），它也与 shell 系统分开。

我已经有一段时间没有调试过 SMTP 的东西了（或者在 Python 下使用过 SMTP），但是你可以通过跳转到 webhost 并做`telnet mydomain.com 25`这件事来看看 SMTP 服务器是否愿意接受你的连接......或者是刚离开。

您还可以尝试在您的网络主机上执行 phpinfo() 并查看它们是否内置了任何特殊的 SMTP 身份验证内容。

除此之外，我建议您尝试将消息传送到 sendmail(compatible) 二进制文件中，并让服务器处理 SMTP。

它看起来像这样......

```
p= os.popen( "/usr/sbin/sendmail -t -i -f" , "w" )
p.write(message)
status = p.close()
if status :
    raise RuntimeError("Could not excecute sendmail properly") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T21:44:40.757

我相信 toaddress 应该是一个列表。

```
fromaddress = 'me@example.com'
toaddress = [fromaddress] 
```

# node.js - NodeJS Passport：通过两种策略进行多重登录 - 序列化问题

> ID：14967989
> 
> 赞同：4
> 
> 时间：2013-02-19T21:41:04.413
> 
> 标签：node.js, authentication, passport.js

我想为用户提供使用以下两种策略之一登录的能力：通过 Instagram 和通常的本地策略。对于本地，我编写了简单的函数来在数据库中查找用户并提供它的用户信息。这是它的工作原理：

```
passport.use(new InstagramStrategy({
    clientID: global.INSTAGRAM_CLIENT_ID,
    clientSecret: global.INSTAGRAM_CLIENT_SECRET,
    callbackURL: "http://**.**.**.**:3000/auth/instagram/callback"
  },
  function(accessToken, refreshToken, profile, done) {
    process.nextTick(function () {
        console.log('Access token: ' + accessToken);
        global.access_token = accessToken;
      return done(null, profile);
    });
  }
));

passport.use(new LocalStrategy(
    function(email, password, done) {
    console.log('chec user');
    process.nextTick(function() {
        db.findByEmail(email, function(err, user) {
            if (!user) {
                console.log('Unknown user ' + email);
                return done(null, false, {
                    message: 'Unknown user ' + email
                });
            }
            if (user.password != crypt.getMD5fromString(password)) {
                console.log('Invalid password');
                return done(null, false, {
                    message: 'Invalid password'
                });
            }
            return done(null, user);
        })
    });
})); 
```

但是我的自定义序列化和反序列化功能不适用于 Instagram 策略：

```
 /* THESE FUNCTIONS WORK WITH INSTAGRAM STRATEGY
passport.serializeUser(function(user, done) {
  done(null, user);
});

passport.deserializeUser(function(obj, done) {
  done(null, obj);
});*/

    /*THESE ARE FOR LOCAL STRATEGY*/
passport.serializeUser(function(user, done) {done(null, user._id);});
passport.deserializeUser(function(id, done) {db.findById(id, function(err, user) {done(err, user);});}); 
```

如何避免这个错误？我的目标 - 提供 Instagram 登录，并在成功登录检查后 - 如果用户有本地帐户（通过电子邮件或 Instagram 昵称），则从 DB 获取数据。尽管用户应该能够通过本地策略在没有 Instagram 的情况下登录。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T23:19:24.623

简短的回答是：对本地和第三方验证回调使用相同的用户对象类型。您可能希望在 Instagram 验证回调中进行设置：`done(null,profile)`您可能希望创建一个新的 User 对象、assign`myUser.instagram = profile`和 callback`done(null, myUser)`或类似的东西，而不是调用。

我有一些示例代码演示了设置多个身份验证系统的一种方法。你可以在这里找到它：[https ://github.com/therealplato/passport-multiauth-demo/blob/master/app.js](https://github.com/therealplato/passport-multiauth-demo/blob/master/app.js)

几个警告：这是为 Express 2.x 编写的，它处理服务器的方式与 3 不同，并且发送响应的语法也不同。*编辑，为 express 3.x 更新了演示代码*

此外，这里的 Google 方法是 Oauth 1。我无法让 Oauth 1 google auth 在本地主机上工作，它给出了一个错误`...has no method 'CharChodeAt'...`

有趣的是，我今天花了很多时间让 Oauth 2 与我的本地用户玩得很好。因此，如果我能找到时间，我将尝试更新 Express 3 和 Oauth 2 的演示代码，但没有任何承诺:)

# java - 如何保存你的高分

> ID：14967990
> 
> 赞同：-5
> 
> 时间：2013-02-19T21:41:05.587
> 
> 标签：java, android, preferences, shared, save

我想保存我最好的，只有一个高分存档，然后如果游戏开始在菜单屏幕上显示它。

像这样：

> 最佳：积分。

我有我的积分，直到你死为止，但我不知道如何保存它们。我听说过共享首选项。但是有人可以给我举个例子，最好的方法。我有代码检查你的分数是否不如最好的高分，但不知道如何正确保存它们。任何建议或帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:44:18.450

这是一篇关于不同存储选项的文章：http: [//developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)它还详细描述了 SharedPreferences。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:51:58.217

这是一个非常快速的示例，假设您要从`Activity`.

要将您的值存储在首选项中：

```
SharedPreferences sharedPreferences = getPreferences(MODE_PRIVATE);
SharedPreferences.Editor editor = sharedPreferences.edit();
editor.putInt("best_score", numberOfPoints);
editor.commit(); 
```

要加载值：

```
SharedPreferences sharedPreferences = getPreferences(MODE_PRIVATE);
if (sharedPreferences.contains("best_score")) {
    // we have a high score saved, load it...
    int numberOfPoints = sharedPreferences.getInt("best_score", -1);
    // here you'd like to do something with the value, for example display it.
} else {
    // there is no high score value - you should probably hide the "best score" TextView
} 
```

这`"best_score"`只是您告诉 Android 存储该值的一个键 - 它可以是任何东西，但重要的是每次您想要访问/操作相同的值时该键都相同 - 在您的情况下为“最佳分数”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:20:53.023

理想情况下，您应该将高分存储在 SQLite DB 中。但是 SharedPrefs 选项也是可行的。

# actionscript-3 - 防止应用程序规模切断 Flex 3 中的按钮标签

> ID：14967994
> 
> 赞同：0
> 
> 时间：2013-02-19T21:41:10.143
> 
> 标签：actionscript-3, flash, apache-flex, flex3

我遇到了一个让我发疯的问题。显然按钮标签在 flex 中不能适当地缩放，或者我只是没有正确地处理它。下面是一个简单的可运行测试用例。

问题：![问题](../Images/fcbf22636a2b10b68efa50352b8ecfd9.png)

在测试用例中，您可以看到按钮标签在多个不同的窗口大小处被截断，但有时它会“弹出”到一个新的字体级别，看起来是否正确？为什么是这样？

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute"> 
    <mx:Script>
        <![CDATA[               
            import mx.events.ResizeEvent;

            public var minScale:Number = 0.5;
            public var baseWidth:Number = 1000;
            public var baseHeight:Number = 800;

            override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void {
                super.updateDisplayList(unscaledWidth,unscaledHeight);

                if(width < baseWidth || height < baseHeight) {
                    var sx:Number = Math.max(minScale, width / baseWidth);
                    var sy:Number = Math.max(minScale, height / baseHeight);

                    var s:Number = Math.min( sx, sy );

                    getChildAt(0).scaleX = s;
                    getChildAt(0).scaleY = s;
                }
                else{
                    getChildAt(0).scaleX = 1;
                    getChildAt(0).scaleY = 1;
                }   
            }

        ]]>
    </mx:Script>

    <mx:Canvas>
        <mx:Button label="WWWWWWW" fontSize="12"/>
    </mx:Canvas>
</mx:Application> 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T09:20:58.130

经过代码审查，检测到缩放画布时，按钮不更新显示列表，并且按钮调用了textField的有趣方法：truncateToFit(); 为了修复错误，创建自定义 Button 类，并覆盖 updateDisplayList 方法：

```
package classes
{
    import mx.controls.Button;
    import mx.core.IUITextField;
    import mx.core.UITextField;
    import mx.core.mx_internal;

    public class ButtonScale extends Button
    {
        public function ButtonScale()
        {
            super();
        }

        override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
        {
            super.updateDisplayList(unscaledWidth, unscaledHeight);

            var tf:IUITextField = mx_internal::getTextField() as IUITextField;
            tf.width = tf.textWidth + UITextField.mx_internal::TEXT_WIDTH_PADDING;
        }
    }
} 
```

当您要缩放时，调用 button.invalidateDisplayList()，或创建自定义 Canvas：

```
package classes
{
    import mx.containers.Canvas;
    import mx.core.UIComponent;

    public class CanvasScale extends Canvas
    {
        public function CanvasScale()
        {
            super();
        }

        override public function set scaleX(value:Number):void
        {
            super.scaleX = value;

            for (var i:uint = 0; i<numChildren; i++)
            {
                UIComponent(getChildAt(i)).invalidateDisplayList();
            }
        }
    }
} 
```

主类：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" xmlns:classes="classes.*"> 
    <mx:Script>
        <![CDATA[               
            import mx.events.ResizeEvent;
            import mx.core.IUITextField;
            import mx.core.UIComponent;

            public var minScale:Number = 0.5;
            public var baseWidth:Number = 900;
            public var baseHeight:Number = 700;

            override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void {
                super.updateDisplayList(unscaledWidth,unscaledHeight);

                var child:UIComponent = getChildAt(0) as UIComponent;

                if(width < baseWidth || height < baseHeight) 
                {
                    var sx:Number = Math.max(minScale, width / baseWidth);
                    var sy:Number = Math.max(minScale, height / baseHeight);

                    var s:Number = Math.min( sx, sy );

                    child.scaleX = s;
                    child.scaleY = s;
                }
                else
                {

                    child.scaleX = 1;
                    child.scaleY = 1;
                }   
            }

        ]]>
    </mx:Script>

    <classes:CanvasScale>
        <classes:ButtonScale label="WWWWWWW" fontSize="12" paddingLeft="10" paddingRight="10"/>
    </classes:CanvasScale>
</mx:Application> 
```

# c++ - 无法在 Linux 中使用自定义头文件编译 C++ 程序

> ID：14967998
> 
> 赞同：0
> 
> 时间：2013-02-19T21:41:16.083
> 
> 标签：c++, linux

我是 C++ 新手，在尝试编译我的程序时遇到了一些麻烦。我有一个`Driver.cpp`包含`main()`, 和 2 个头文件的文件，每个头文件都有相应的`.cpp`文件。它们都在同一个目录中。该`Driver.cpp`文件仅调用其他头文件之一中的函数，该函数完成其余工作。我的问题是我无法编译代码，因为我不断收到“文件中首先引用的未定义符号”错误。我尝试了许多不同的方法来编写编译代码，但没有一个有效。这是我试过的一个：

```
"g++ -lm -o outputfile headerOne.cpp headerTwo.cpp Driver.cpp" 
```

如果有人可以帮助我，我将不胜感激。谢谢！

编辑：顺便说一句，我在将它放入 Linux 之前在 Visual Studio 中尝试了此代码并且它有效。不确定这是否意味着什么，但我想我会在这里添加。让我知道是否需要附加一些代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:59:45.210

我想到了！事实证明，我的 .cpp 文件中没有将一些变量定义为 .h 文件中的“extern”，而且我的函数定义中缺少“内联”。无论如何，感谢您的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:50:58.740

由于您的代码在视觉工作室中工作，我将假设您的包含正确阅读此链接它可能会给您一些关于 linux 环境的指导

[http://gcc.gnu.org/onlinedocs/cpp/Search-Path.html](http://gcc.gnu.org/onlinedocs/cpp/Search-Path.html)