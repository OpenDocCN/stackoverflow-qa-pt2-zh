# StackOverflow 问答 13767000-13767999

# javascript - 带有cordova/phonegap的数据库状态

> ID：13767000
> 
> 赞同：0
> 
> 时间：2012-12-07T16:24:47.000
> 
> 标签：javascript, cordova

如果我像这样使用科尔多瓦创建数据库`var db = window.openDatabase("Database", "1.0", "Cordova Demo", 200000);`

当我的应用程序关闭时，这个数据库会保存吗？我如何防止每次启动我的应用程序时创建它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:49:59.283

> 当我的应用程序关闭时这个数据库会保存吗

是的，当您关闭应用程序时，您仍然可以在重新启动后访问数据库中的数据（数据将被持久化）。

> 以及如何防止每次启动我的应用程序时创建它

openDatabase 方法使用现有数据库或创建新数据库创建数据库对象（如果已经有一个名为“Cordova Demo”的数据库，您将获得它而不是创建新数据库）。

# android - cordova-android ./create $( which android ) 以 1 退出

> ID：13767007
> 
> 赞同：1
> 
> 时间：2012-12-07T16:24:58.567
> 
> 标签：android, cordova, android-2.2-froyo

执行命令创建项目后...

```
./create <PATH_TO_PROJECT_DIR> <COM_PATH> <PROJECT_NAME> 
```

我收到错误消息：

```
An unexpected error occurred: ANDROID_BIN="${ANDROID_BIN:=$( which android )}" exited with 1
Deleting project... 
```

故障排除响应：（acconrad[在此处](https://stackoverflow.com/questions/13475687/cordova-2-1-0-phonegap-create-script-for-android-says-project-already-exists)提供了一个智能清单，用于解决 Cordova 错误...）

> 您是否从正确的位置下载了正确版本的 PhoneGap？似乎有些版本的 PhoneGap 没有与 Cordova-2.x.0.jar 一起打包，这是运行脚本所必需的。在此处下载以获取具有正确 JAR 文件的 PhoneGap。

我已按照[官方 Apache Cordova API 文档](http://docs.phonegap.com/en/2.2.0/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android)站点上的说明进行操作，并[从 github 下载了 cordova-android 存储库](https://github.com/apache/incubator-cordova-android)。官方文档没有说明这个 jar 文件，因此我没有执行它。

> 您是否已经创建了文件夹？文档声称只要新文件夹为空白，您就可以使用此命令。这不是真的。在尝试创建项目之前，请确保该文件夹不存在。

全新的文件夹路径，从未创建。

> 你有最新版本的 Ant 吗？您需要 Ant 1.8.0 或更高版本才能在 Android 上运行 PhoneGap。使用 ant -v 来验证您的版本。

Ant 版本 1.8.2，虽然运行 -v 标志会弹出以下输出...

```
Apache Ant(TM) version 1.8.2 compiled on June 3 2011
Trying the default build file: build.xml
Buildfile: build.xml does not exist!
Build failed 
```

...好像它正在尝试构建。我假设 -v 表示详细，并且`ant`正在尝试构建当前的 director，其中没有 build.xml 文件，因为我不是用 ant 构建项目，只是找到版本，即 1.8.2。

> 您的 .bash_profile/Environment Varibles PATH 设置是否正确？官方文档已更新以反映这一点，但您绝对需要正确设置这些变量才能创建项目。

两个 SDK 路径都已设置 & `source`d。

> 您是否更新了终端以反映您的新路径？源 .bash_profile 或 . .bash_profile 在您当前打开的终端窗口中，以便在运行 create 命令时更新您的路径。

尚未重新启动，但 $PATH 输出正确的 android-sdk-macosx 路径（平台工具 && 工具）。

> 你有正确的公共编解码器吗？您可能会收到一个伴随的错误，涉及缺少的 commons-codec 文件，您可以在此处下载该文件。

没有`commons-codec`显示伴随的错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T16:24:58.567

问题确实是PATH变量......

`/PATH/TO/android-sdk-maxosx/platform-tools`

`/PATH/TO/android-sdk-maxosx/tools`

从路径名中删除了 macosx。

在 ~/.bash_profile 中更正这些环境变量解决了这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T09:29:42.190

您应该修改 PATH 环境变量：

**对于 Ubuntu：** $ nano ~/.bashrc

您现在将在终端上启用 Nano 文本编辑器。现在，在文件的最顶部，输入以下内容：

```
#AndroidDev PATH
export PATH=${PATH}:~/android-sdk-linux/tools
export PATH=${PATH}:~/android-sdk-linux/platform-tools 
```

[https://help.ubuntu.com/community/AndroidSDK](https://help.ubuntu.com/community/AndroidSDK)

**对于 Mac 操作系统：**

在您的主目录中查找 .bash_profile。如果没有，请创建 .bash_profile 文件。查找 PATH 环境变量并将 tools/ 目录的完整路径添加到 PATH。如果您没有看到设置 PATH 的行，您可以添加一个：export PATH=${PATH}:/tools

[https://sites.google.com/site/richgossweiler/home/android-development-notes/installing-the-android-sdk-on-the-mac-os-x](https://sites.google.com/site/richgossweiler/home/android-development-notes/installing-the-android-sdk-on-the-mac-os-x)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-09T20:27:50.337

如果 COM_PATH 的名称包含无效字符或没有 3 个命名空间，例如：

com.example.project

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-05T08:53:38.023

这可能是因为路径错误。您应该在 ~/.bash_profile 中编辑环境变量。有关详细说明，请参阅此[博客文章](http://mythoughtsandexperiments.blogspot.in/2013/12/an-unexpected-error-occurred.html) 。

# .net - 我在哪里可以找到 CorFlags 值的每一位含义的参考？

> ID：13767010
> 
> 赞同：12
> 
> 时间：2012-12-07T16:25:14.050
> 
> 标签：.net, low-level, portable-executable, bit-fields, corflags

我正在处理一些相当低级的事情，并试图确定为什么我使用 CorFlags.exe 实用程序得到不同的输出。作为参考，输出如下：

```
$ corflags test2.exe
Microsoft (R) .NET Framework CorFlags 转换工具。版本 4.0.30319.17929
版权所有 (c) 微软公司。版权所有。

版本：v4.0.30319
CLR 标头：2.5
聚乙烯：PE32
CorFlags：0x1
仅 : 1
32 位请求：0
32BITPREF：0
签名：0

$ corflags test.exe
Microsoft (R) .NET Framework CorFlags 转换工具。版本 4.0.30319.17929
版权所有 (c) 微软公司。版权所有。

版本：v4.0.30319
CLR 标头：2.5
聚乙烯：PE32
CorFlags：0x20003
仅 : 1
32 位请求：0
32BITPREF : 1
签名：0

```

我试图弄清楚 CorFlags 值中未在 CorFlags 实用程序中公开的其他位的含义。这个参考在哪里？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-07T16:57:34.313

您实际上看到了来自 PE32 标头（PE 字段）和嵌入在程序集中的清单标头（其余部分）的混合信息。这在 Windows SDK 中都有描述，您需要版本 8 才能获得新的 32BITPREF 标志。使用 C:\Program Files (x86)\Windows Kits\8.0\Include\um\CorHdr.h，该文件中有很多描述声明的注释。

我将复制描述 IMAGE_COR20_HEADER.Flags 值的部分：

```
COMIMAGE_FLAGS_ILONLY               =0x00000001,
COMIMAGE_FLAGS_32BITREQUIRED        =0x00000002,
COMIMAGE_FLAGS_IL_LIBRARY           =0x00000004,
COMIMAGE_FLAGS_STRONGNAMESIGNED     =0x00000008,
COMIMAGE_FLAGS_NATIVE_ENTRYPOINT    =0x00000010,
COMIMAGE_FLAGS_TRACKDEBUGDATA       =0x00010000,
COMIMAGE_FLAGS_32BITPREFERRED       =0x00020000, 
```

因此显示的 0x20003 值分解为 32BITPREFERRED (0x20000) 加上 32BITREQUIRED (0x00002) 加上 ILONLY (0x00001)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-04T08:02:45.027

标志解释：

任何 CPU：PE = PE32 和 32BIT = 0

x86：PE = PE32 和 32BIT = 1

64 位：PE = PE32+ 和 32BIT = 0

# android - 将表单身份验证 cookie 从 HttpClient（webapi 调用）传送到 WebView

> ID：13767011
> 
> 赞同：0
> 
> 时间：2012-12-07T16:25:19.753
> 
> 标签：android, asp.net-web-api, forms-authentication, android-webview, httpclient

我通过使用 HttpClient 调用 Web 服务（.net mvc 4 上的 webapi）创建了一个使用自定义滚动身份验证方法的 android 应用程序。当用户通过身份验证时，服务器上的操作方法正在设置表单身份验证 cookie，然后将用户模型返回给 android 客户端。该用户模型包含内部用户 ID 和一些其他属性。

用户通过身份验证后，我将在 android 上打开一个 WebView 来为一些简单的导航元素提供视口。该 WebView 需要从上一步中的 webapi 调用中获得身份验证 cookie。我假设表单身份验证 cookie 保存在 HttpClient 中（尽管我无法确认），如果是这样，有没有办法将该 cookie 传递给 WebView 以便在 WebView 中提供的网页知道第一步是基于谁的用户？

如果这不可能，有人可以指导我采取一些步骤来完成这项工作。

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T09:27:59.713

这看起来是一个非常相似的问题。[在 Android 中将 cookie 设置为 webView](https://stackoverflow.com/questions/5716898/set-a-cookie-to-a-webview-in-android)。

希望这可以帮助你。

# android - Android 4.2 9-patch 背景绘制与旧操作系统版本不同

> ID：13767012
> 
> 赞同：1
> 
> 时间：2012-12-07T16:25:20.913
> 
> 标签：android, nine-patch, android-4.2-jelly-bean, android-drawable

我有一个带有 Android 4.2.1 的 Nexus 7，我注意到在我的应用程序中，我用于某些线性布局的背景图像绘制不正确。对于具有旧版本 Android 操作系统的其他设备，可以正确绘制 9-patch 背景，但对于此设备，边界线在不应拉伸时被拉伸。

正确（Evo 4G v2.3.5）：http: [//i.imgur.com/WDTNr.png](http://i.imgur.com/WDTNr.png)

不正确（N7 v4.2.1）：http: [//i.imgur.com/HntMY.png](http://i.imgur.com/HntMY.png)

知道是什么原因造成的吗？如果没有，是否有任何其他方法可以在不使用 9-patch 图像的情况下在这些视图上获得黑色边框？

*编辑*

9 补丁文件：http: [//i.imgur.com/LDoBE.png](http://i.imgur.com/LDoBE.png)

编辑工具中的 9 补丁：http: [//i.imgur.com/UoydG.png](http://i.imgur.com/UoydG.png)

使用它的布局 xml 部分（leftbordergraybkg）：

```
<LinearLayout
 android:id="@+id/Measurements"
 android:layout_width="0px"
 android:layout_height="match_parent"
 android:layout_weight="50"
 android:background="@drawable/leftbordergraybkg"
 android:orientation="vertical"> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T16:32:25.473

这是因为显示可缩放区域的黑色像素太靠近图像的边界。这就是为什么在更高的像素密度中，9-patch 文件会放大并缩放边框。

请参阅不会出现此类问题的示例。

![在此处输入图像描述](../Images/de8b0633d17a349a5dd88cd14c56daa4.png)

# regex - 解析特定参数值的 url

> ID：13767014
> 
> 赞同：1
> 
> 时间：2012-12-07T16:25:46.127
> 
> 标签：regex

我希望使用正则表达式来解析 URL 以获取 url 的特定部分，如果我找不到模式则什么都没有。
一个网址示例是

`/te/file/value/jifle?uil=testing-cdas-feaw:jilk:&jklfe=https://value-value.jifels/temp.html/topic?id=`**e997aad4-92e0-j30e-a3c8-jfkaliejs5**`#c452fds-634d-f424fds-cdsa&bf_action=jildape`

我希望得到粗体字。

目前我正在使用正则表达式“ `d=([^#]*)`”但问题是我也在这种模式的 url 上运行：我得到了它的粗体部分

`/te/file/value/jifle?uil=testing-cdas-feaw:jilk:&jklfe=https://value-value.jifels/temp.html/topic?id=`**e997aad4-92e0-j30e-a3c8-jfkaliejs5&bf_action=jildape**

我希望它没有与此 url 匹配的内容，因为它不包含 #

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T18:16:05.723

```
regex = "id=([\\w-])+?#" 
```

假设 'id=' 和 '#' 之间的所有内容都在该字符类中（即如果一个 '&'在那里，正则表达式将失败）。

```
id= 
```

-自我解释，这寻找'id ='的完全匹配

```
([\\w-]) 
```

- 这定义了字符类并将其分组。\w 是转义的 \w。'\w' 是来自 java 的预定义字符类，等于 [a-zA-Z_0-9]。由于您示例中的假定模式，我在此类中添加了“-”。

```
+? 
```

- 这是一个不情愿的量词，它寻找正则表达式的最短匹配。

```
# 
```

- 正则表达式的结尾，我们正在寻找匹配模式的最后一个字符。

* * *

如果您希望获取 'id=' 和它后面的第一个 '#' 之间的每个字符，以下将起作用，它使用与上面相同的逻辑，但将字符类替换为`[\\w-]`匹配`.`任何内容。

```
regex = "id=(.+?)#" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T16:31:23.057

正则表达式不是一个神奇的工具，你应该总是因为问题涉及字符串而使用它。在这种情况下，您的语言可能有一个工具可以为您分解 URL。在 PHP 中，这是`parse_url()`. 在 Perl 中，它是 URI::URL 模块。

对于这样的常见问题，您几乎应该总是更喜欢现有的、经过充分测试的解决方案，而不是自己编写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T16:31:54.930

所以你想匹配 id 参数的值，但前提是它有一个包含“#”符号的尾随部分（不匹配“#”或后面的内容）？

不知道您正在使用哪种风格的正则表达式的细节，例如：

```
id=([^#&]*)# 
```

# magento-1.7 - 如何拆分 Magento 订单以获取可下载和实体产品

> ID：13767016
> 
> 赞同：0
> 
> 时间：2012-12-07T16:25:55.380
> 
> 标签：magento-1.7

我如何将订单分成两个不同的部分（一个用于可下载，第二个用于物理）并立即授权总量并在订购时捕获可下载的产品数量，并在产品准备好时从管理面板手动物理捕获装运。

有谁能够帮我.............

先谢谢了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T13:51:50.407

您需要在方法`OnePageController`下创建一个自定义事件（如果您使用的是 Onepage 结帐）`saveOrderAction()`。

并使用以下代码从当前购物车中删除商品并为实体产品创建新订单。

```
class CompanyName_ModuleName_Model_Order extends Mage_Core_Model_Abstract {

public function createOrder() {

    $quoteID = Mage::getSingleton("checkout/session")->getQuote()->getId();
    $quote = Mage::getModel("sales/quote")->load($quoteID);

    foreach($quote->getAllItems() as $item){
        $itemId = $item->getId();
        $productId = $item->getProductId();
        if(put your condition here){
            /* remove the item fro which need to split the order */
            $quote->removeItem($itemId)->save();
        }
    }

    $id = Mage::getSingleton('customer/session')->getCustomer()->getId();
    $customer = Mage::getModel('customer/customer')->load($id);

    $transaction = Mage::getModel('core/resource_transaction');
    $storeId = $customer->getStoreId();
    $reservedOrderId = Mage::getSingleton('eav/config')->getEntityType('order')->fetchNewIncrementId($storeId);

    $order = Mage::getModel('sales/order')
                    ->setIncrementId($reservedOrderId)
                    ->setStoreId($storeId)
                    ->setQuoteId(0)
                    ->setGlobal_currency_code('USD')
                    ->setBase_currency_code('USD')
                    ->setStore_currency_code('USD')
                    ->setOrder_currency_code('USD');

    /* set Customer data */
    $order->setCustomer_email($customer->getEmail())
            ->setCustomerFirstname($customer->getFirstname())
            ->setCustomerLastname($customer->getLastname())
            ->setCustomerGroupId($customer->getGroupId())
            ->setCustomer_is_guest(0)
            ->setCustomer($customer);

    /* set Billing Address */
    $billing = $customer->getDefaultBillingAddress();
    $billingAddress = Mage::getModel('sales/order_address')
                    ->setStoreId($storeId)
                    ->setAddressType(Mage_Sales_Model_Quote_Address::TYPE_BILLING)
                    ->setCustomerId($customer->getId())
                    ->setCustomerAddressId($customer->getDefaultBilling())
                    ->setCustomer_address_id($billing->getEntityId())
                    ->setPrefix($billing->getPrefix())
                    ->setFirstname($billing->getFirstname())
                    ->setMiddlename($billing->getMiddlename())
                    ->setLastname($billing->getLastname())
                    ->setSuffix($billing->getSuffix())
                    ->setCompany($billing->getCompany())
                    ->setStreet($billing->getStreet())
                    ->setCity($billing->getCity())
                    ->setCountry_id($billing->getCountryId())
                    ->setRegion($billing->getRegion())
                    ->setRegion_id($billing->getRegionId())
                    ->setPostcode($billing->getPostcode())
                    ->setTelephone($billing->getTelephone())
                    ->setFax($billing->getFax());
    $order->setBillingAddress($billingAddress);

    $shipping = $customer->getDefaultShippingAddress();
    $shippingAddress = Mage::getModel('sales/order_address')
                    ->setStoreId($storeId)
                    ->setAddressType(Mage_Sales_Model_Quote_Address::TYPE_SHIPPING)
                    ->setCustomerId($customer->getId())
                    ->setCustomerAddressId($customer->getDefaultShipping())
                    ->setCustomer_address_id($shipping->getEntityId())
                    ->setPrefix($shipping->getPrefix())
                    ->setFirstname($shipping->getFirstname())
                    ->setMiddlename($shipping->getMiddlename())
                    ->setLastname($shipping->getLastname())
                    ->setSuffix($shipping->getSuffix())
                    ->setCompany($shipping->getCompany())
                    ->setStreet($shipping->getStreet())
                    ->setCity($shipping->getCity())
                    ->setCountry_id($shipping->getCountryId())
                    ->setRegion($shipping->getRegion())
                    ->setRegion_id($shipping->getRegionId())
                    ->setPostcode($shipping->getPostcode())
                    ->setTelephone($shipping->getTelephone())
                    ->setFax($shipping->getFax());

    $order->setShippingAddress($shippingAddress)
            ->setShipping_method('freeshipping')
            ->setShippingDescription('Free Shipping - Free');
    /*set payment details here for example */
    $orderPayment = Mage::getModel('sales/order_payment')
                    ->setStoreId($storeId)
                    ->setCustomerPaymentId(0)
                    ->setMethod('cybersource_soap')
                    ->setCcType('VI')
                    ->setCcNumber('4111111111111111')
                    ->setCcLast4('1111')
                    ->setCcExpMonth('2')
                    ->setCcExpYear('2013')
                    ->setCcCid('123');
    $order->setPayment($orderPayment);

    /* let say, we have 2 products */
    $subTotal = 0;
    /* pass the product id and quantity here e.g. */
    $products = array(
    '2' => array(
    'qty' => 1
    )
    );
    foreach ($products as $productId => $product) {
        $_product = Mage::getModel('catalog/product')->load($productId);
        $rowTotal = $_product->getPrice() * $product['qty'];
        $orderItem = Mage::getModel('sales/order_item')
                        ->setStoreId($storeId)
                        ->setQuoteItemId(0)
                        ->setQuoteParentItemId(NULL)
                        ->setProductId($productId)
                        ->setProductType($_product->getTypeId())
                        ->setQtyBackordered(NULL)
                        ->setTotalQtyOrdered($product['qty'])
                        ->setQtyOrdered($product['qty'])
                        ->setName($_product->getName())
                        ->setSku($_product->getSku())
                        ->setPrice($_product->getPrice())
                        ->setBasePrice($_product->getPrice())
                        ->setOriginalPrice($_product->getPrice())
                        ->setRowTotal($rowTotal)
                        ->setBaseRowTotal($rowTotal);

        $subTotal += $rowTotal;
        $order->addItem($orderItem);
    }

    $order->setSubtotal($subTotal)
            ->setBaseSubtotal($subTotal)
            ->setGrandTotal($subTotal)
            ->setBaseGrandTotal($subTotal);

    $transaction->addObject($order);
    $transaction->addCommitCallback(array($order, 'place'));
    $transaction->addCommitCallback(array($order, 'save'));
    $transaction->save();
}

} 
```

并且不要忘记根据您的配置等修改此代码。

# c# - 挂起/杀死和等待线程

> ID：13767017
> 
> 赞同：0
> 
> 时间：2012-12-07T16:25:56.127
> 
> 标签：c#

我有一个执行函数的线程和几个使用 AutoResetEvent 阻塞的线程。所有这些都发生在 WCF 服务中

是否有可能从客户端应用程序中挂起/终止等待线程。我跟踪 ManagedThreadIds

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:30:16.597

当然建议您找到另一种方法来向线程发出信号以优雅地结束它们的循环，但在回答您的问题时，是的，这是可能的。看一下 System.Diagnostics.Process 类。从那里您可以检查给定进程的线程。您可以在要终止的线程上调用 Abort()。

# java - 发布/处理使 SwingWorker 变慢

> ID：13767020
> 
> 赞同：3
> 
> 时间：2012-12-07T16:26:03.747
> 
> 标签：java, swing, process, publish, swingworker

我尝试使用 SwingWorker 来更新进度条。对我来说没有什么新鲜事。我有点懒，所以我没有覆盖 process 方法。这里有一个简化的例子：

```
protected Void doInBackground() throws Exception {
    for (int i = 0; i < 10000; i++) {
        progressBar.setValue(i+1);            
    }
    return null;
} 
```

在我的电脑上，将进度条更新到 100% 大约需要 6 秒。现在是星期五，所以我想让我们以一种不同的方式来做这件事，就像经常描述的那样。让我们使用 publish 和 process 方法来更新进度条：

```
@Override
protected Void doInBackground() throws Exception {
    for (int i = 0; i < maximum; i++) {            
        publish(i+1);
    }
    return null;
}

@Override
protected void process(List<Integer> chunks) {        
    progressBar.setValue(chunks.get(chunks.size()-1));
} 
```

但是现在使用发布方法需要 21（而不是 6）秒才能将进度条更新到 100%。

*为什么？*

这里是整个代码（带有“开始”按钮和进度条的框架）：

```
public class Gui extends JFrame {

    public static void main(String[] args) {
        new Gui();
    }

    public Gui() {
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        final JProgressBar progressBar = new JProgressBar();
        progressBar.setStringPainted(true);

        JButton btnStart = new JButton("Start");
        btnStart.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                new MySwingWorker(progressBar).execute();
            }
        });

        getContentPane().setLayout(new BorderLayout(3, 3));
        getContentPane().add(btnStart, BorderLayout.CENTER);
        getContentPane().add(progressBar, BorderLayout.SOUTH);
        pack();
        setVisible(true);
        setLocationRelativeTo(null);
    }

    private class MySwingWorker extends SwingWorker<Void, Integer> {

        private final int MAXIMUM = 100000000;
        private final JProgressBar progressBar;

        public MySwingWorker(JProgressBar progressBar) {
            this.progressBar = progressBar;
            this.progressBar.setMaximum(MAXIMUM);
            this.progressBar.setValue(0);
        }

        @Override
        protected Void doInBackground() throws Exception {
            for (int i = 0; i < MAXIMUM; i++) {
                //----------------------------------
                // TOGGLE BETWEEN THESE LINES:
                //progressBar.setValue(i+1);
                publish(i + 1);
                //-----------------------------------
            }
            return null;
        }

        @Override
        protected void process(List<Integer> chunks) {
            progressBar.setValue(chunks.get(chunks.size() - 1));
        }
    }
} 
```

感谢您的建议...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-01T13:51:25.623

您不应该发布每一次更改，但可能每 10 次发布一次：

```
for (int i = 0; i < maximum; i++) {
    doTheWork();
    if(i % 10 == 0) {
        publish(i+1);
    }
}
publish(maximum); 
```

# r - 基于两个时间点建立的回归模型的比较

> ID：13767021
> 
> 赞同：-3
> 
> 时间：2012-12-07T16:26:11.597
> 
> 标签：r, time-series, regression, model-comparison

我有两个多元线性回归模型，使用相同的受试者组、变量构建，唯一的区别是时间点：一个是基线数据，另一个是一段时间后获得的。我想比较两个模型之间是否有任何统计意义。我看过文章说，在比较模型时，使用 AIC 可能比 p 值更好。

我的问题是：在 R 中使用 extractAIC 纯粹比较 AIC 或获得 anova(lm) 是否有意义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T23:08:29.673

通过估计两个不同的模型来检验在两个时间点记录的观察结果之间的统计显着性是不标准的。

您可能的意思是您正在测试通过包含一些虚拟变量并测试这些虚拟变量的系数，以查看在第二个时间点记录的观察结果是否与第一个时间点在统计上有所不同。不过，这只是估计一个模型。

在您的模型中，您将有第二个时间点的虚拟变量，[一个截距或一个截距以及像这样的交互虚拟变量。](http://latex.codecogs.com/gif.latex?y%20%3D%20%5Cbeta_0%20+%20%5Cbeta_1%20X%20+%20%5Cgamma_0%20D_1%5C%5C%20y%20%3D%20%5Cbeta_0%20+%20%5Cbeta_1%20X%20+%20%5Cgamma_0%20D_1%20+%20%5Cgamma_1%20D_1%20X)

然后你应该两者都做 - 测试所描述模型中一个或两个伽马的 p 值显着性，并查看 AIC。正如文章可能描述的那样，没有明确的“更好”。

# perl - perl 在 ftp->ls 中使用通配符引用

> ID：13767027
> 
> 赞同：0
> 
> 时间：2012-12-07T16:26:36.573
> 
> 标签：perl, ftp, wildcard, quotes, ls

远程目录的内容 `mydir`：

```
blah.myname.1.txt
blah.myname.somethingelse.txt
blah.myname.randomcharacters.txt
blah.notmyname.1.txt
blah.notmyname.2.txt
... 
```

在 perl 中，我想下载所有这些东西`myname`

我在适当的引用方面*真的很失败。*请帮忙。

失败的代码

```
my @files;
@files = $ftp->ls( '*.myname.*.txt' );  # finds nothing
@files = $ftp->ls( '.*.myname.*.txt' );  # finds nothing 
```

ETC..

如何放置通配符以便它们由 解释`ls`，而不是由 perl 解释？这里出了什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T16:45:46.343

我将假设您正在使用该[`Net::FTP`](http://search.cpan.org/%7Egbarr/libnet-1.22/Net/FTP.pm)软件包。那么这部分文档很有趣：

> ### `ls ( [ DIR ] )`
> 
> 获取 DIR 或当前目录的目录列表。
> 
> 在数组上下文中，返回从服务器返回的行列表。在标量上下文中，返回对列表的引用。

这意味着如果您不带参数调用此方法，您将获得当前目录中***所有****文件的**列表***，否则从指定目录中获得。**

 **没有任何关于任何模式的消息，这并不奇怪：FTP 只是一个传输文件的协议，而这个模块只是该协议的一个包装器。

您可以使用以下方法轻松进行过滤`grep`：

```
my @interesting = grep /pattern/, $ftp->ls(); 
```

要选择包含字符序列的所有文件`myname`，请使用`grep /myname/, LIST`.
要选择包含字符序列的所有文件`.myname.`，请使用`grep /\.myname\./, LIST`.
要选择以字符序列结尾的所有文件`.txt`，请使用`grep /\.txt$/, LIST`.

是grep`LIST`或`$ftp->ls`另一个 grep，因此您可以轻松链接多个过滤步骤。

当然，Perl 正则表达式比这更强大，我们可以`/\.myname\.[^.]+\.txt$/`根据您的*具体*要求在一个或其他东西中完成所有过滤。如果您迫切需要一种通配符语法，可以使用一些工具将 glob 模式转换为正则表达式对象，例如[`Text::Glob`](http://search.cpan.org/%7Erclamp/Text-Glob-0.09/lib/Text/Glob.pm)，甚至可以直接进行 glob 匹配：

```
use Text::Glob qw(match_glob);

my @interesting = match_glob ".*.myname.*.txt", $ftp->ls; 
```

然而，至少可以这么说，这是不优雅的，因为正则表达式*更*强大，*绝对*值得学习。**

# c# - Silverlight 中标签中的 AutoSize 功能

> ID：13767032
> 
> 赞同：1
> 
> 时间：2012-12-07T16:26:50.223
> 
> 标签：c#, silverlight, user-interface, resize, silverlight-5.0

我的 Silverlight 5.0 应用程序中有一个 Label 对象，我需要标签在运行时自动调整大小，无论是变大还是变小。

我的应用程序每隔几秒向用户显示一个新数字，其中包含一组数字，并且在某个时间间隔内，基于应用程序运行时的多个因素，我要么添加一个数字，要么从数字长度中减去一个数字。我在 Windows 窗体中很容易做到这一点，但我需要将其转换为 Silverlight，并且标签控件没有 autosize 属性。

我见过这个数字小到 3 位，长到 10 位。

在 silverlight 中向标签添加自动调整大小功能的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:53:59.810

尝试使用嵌入的 TextBlock 而不是标签。

# email - 如何使用 DNS 将邮件从 d1.com 重定向到 d2.com？

> ID：13767033
> 
> 赞同：1
> 
> 时间：2012-12-07T16:26:49.160
> 
> 标签：email, redirect, dns, record

我有 2 个域，我们称它们为 d1.com 和 d2.com。我希望发送到anyone@d1.com 的邮件最终到达d2.com 的邮件服务器。我想使用 DNS 来完成此操作，并首先尝试了以下操作以使其正常工作：

*   在 d1.com 上，我设置了一条 MX 记录“@ MX 3600 10 mail.d2.com。”。在 d2.com 上，我设置了一条 A 记录“mail A 3600 10.10.10.1”，其中 10.10.10.1 是邮件服务器的 IP。

它没有用，发送到某人@d1.com 的电子邮件消失了。所以我尝试了这个：

*   在 d1.com 上，我设置了 MX 记录“@ MX 3600 10 mail”和 A 记录“mail A 3600 10.10.10.1”，其中 10.10.10.1 是 d2.com 邮件服务器的 IP。

这也不起作用，再次发送到someone@d1.com 的电子邮件消失了。有些事情告诉我，我必须以某种方式告诉 d2.com 接受发给 any@d1.com 的邮件，因为 d2.com 可能希望邮件采用 some@d2.com 格式。这是我可以使用 DNS 配置的“接受”吗？或者我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:34:47.190

我认为您的第一次 DNS 更改处于正确的轨道上，但是，正如您在问题结束时指出的那样，您必须将 d2.com 的邮件服务器配置为接受来自 d1.com 的邮件 - 这是要配置的内容邮件服务器而不是 DNS。

# android - java.lang.RuntimeException：无法启动活动 ComponentInfo 无法转换为 android.widget.ZoomControls

> ID：13767042
> 
> 赞同：0
> 
> 时间：2012-12-07T16:27:23.767
> 
> 标签：android, eclipse, classcastexception

我是android开发的新手，希望大家能帮助我。我从互联网上得到了这个 androidVNC 查看器源代码。当我在模拟器中运行 androidVNC 应用程序时，它将自动退出，然后我在 LogCat 中出现以下错误。任何人都可以帮助我吗？谢谢。

```
FATAL EXCEPTION: main
java.lang.RuntimeException: Unable to start activity ComponentInfo{android.androidVNC/android.androidVNC.VncCanvasActivity}:       java.lang.ClassCastException: com.antlersoft.android.zoomer.ZoomControls cannot be cast to     android.widget.ZoomControls
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1955)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1980)
at android.app.ActivityThread.access$600(ActivityThread.java:122)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1146)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4340)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.ClassCastException: com.antlersoft.android.zoomer.ZoomControls       cannot be cast to android.widget.ZoomControls
at android.androidVNC.VncCanvasActivity.onCreate(VncCanvasActivity.java:585)
at android.app.Activity.performCreate(Activity.java:4465)
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1919)
... 11 more 
```

这是 ZoomControls java 文件：

```
package com.antlersoft.android.zoomer;

import android.content.Context;
import android.util.AttributeSet;
import android.view.LayoutInflater;
import android.view.MotionEvent;
import android.view.View;
import android.view.animation.AlphaAnimation;
import android.widget.ImageButton;
import android.widget.LinearLayout;
import android.widget.ZoomButton;

public class ZoomControls extends LinearLayout {

private final ZoomButton mZoomIn;
private final ZoomButton mZoomOut;
private final ImageButton mZoomKeyboard;

public ZoomControls(Context context) {
    this(context, null);
}

public ZoomControls(Context context, AttributeSet attrs) {
    super(context, attrs);
    setFocusable(false);

    LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    inflater.inflate(R.layout.zoom_controls, this, // we are the parent
            true);

    mZoomIn = (ZoomButton) findViewById(R.id.zoomIn);
    mZoomOut = (ZoomButton) findViewById(R.id.zoomOut);
    mZoomKeyboard = (ImageButton) findViewById(R.id.zoomKeys);
}

public void setOnZoomInClickListener(OnClickListener listener) {
    mZoomIn.setOnClickListener(listener);
}

public void setOnZoomOutClickListener(OnClickListener listener) {
    mZoomOut.setOnClickListener(listener);
}

public void setOnZoomKeyboardClickListener(OnClickListener listener) {
    mZoomKeyboard.setOnClickListener(listener);
}

/*
 * Sets how fast you get zoom events when the user holds down the
 * zoom in/out buttons.
 */
public void setZoomSpeed(long speed) {
    mZoomIn.setZoomSpeed(speed);
    mZoomOut.setZoomSpeed(speed);
}

@Override
public boolean onTouchEvent(MotionEvent event) {

    /* Consume all touch events so they don't get dispatched to the view
     * beneath this view.
     */
    return true;
}

public void show() {
    fade(View.VISIBLE, 0.0f, 1.0f);
}

public void hide() {
    fade(View.GONE, 1.0f, 0.0f);
}

private void fade(int visibility, float startAlpha, float endAlpha) {
    AlphaAnimation anim = new AlphaAnimation(startAlpha, endAlpha);
    anim.setDuration(500);
    startAnimation(anim);
    setVisibility(visibility);
}

public void setIsZoomInEnabled(boolean isEnabled) {
    mZoomIn.setEnabled(isEnabled);
}

public void setIsZoomOutEnabled(boolean isEnabled) {
    mZoomOut.setEnabled(isEnabled);
}

@Override
public boolean hasFocus() {
    return mZoomIn.hasFocus() || mZoomOut.hasFocus();
} 
```

}

这是 zoom_controls XML 文件：

```
<merge xmlns:android="http://schemas.android.com/apk/res/android">
<ZoomButton android:id="@+id/zoomOut" 
    android:background="@drawable/btn_zoom_down" 
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    />
<ImageButton android:id="@+id/zoomKeys"
    android:background="@android:drawable/ic_dialog_dialer"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    />
<ZoomButton android:id="@+id/zoomIn" 
    android:background="@drawable/btn_zoom_up"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    />
</merge> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:31:27.393

您使用错误，`import`使用 this`com.antlersoft.android.zoomer.ZoomControls`而不是`android.widget.ZoomControls`

# java - 在 Java 中加入 Hadoop

> ID：13767045
> 
> 赞同：0
> 
> 时间：2012-12-07T16:27:34.663
> 
> 标签：java, join, hadoop, mapreduce, bigdata

我在很短的时间内就开始使用 Hadoop 并尝试在 Java 中实现连接。不管是 Map-Side 还是 Reduce-Side。我采用了 Reduce-Side join，因为它应该更容易实现。我知道 Java 不是连接、聚合等的最佳选择，最好选择我已经做过的 Hive 或 Pig。但是，我正在做一个研究项目，我必须使用所有这 3 种语言才能进行比较。

无论如何，我有两个不同结构的输入文件。一个是 key|value，另一个是 key|value1;value2;value3;value4。每个输入文件的一条记录如下所示：

*   输入1：`1;2010-01-10T00:00:01`
*   输入2：`1;23;Blue;2010-01-11T00:00:01;9999-12-31T23:59:59`

我遵循了 Hadoop Definitve Guide book 中的示例，但它对我不起作用。我在这里发布了我的 java 文件，所以你可以看到有什么问题。

```
public class LookupReducer extends Reducer<TextPair,Text,Text,Text> {

private String result = "";
private String msisdn;
private String attribute, product;
private long trans_dt_long, start_dt_long, end_dt_long; 
private String trans_dt, start_dt, end_dt; 

@Override
public void reduce(TextPair key, Iterable<Text> values, Context context) 
        throws IOException, InterruptedException {

     context.progress();
    //value without key to remember

    Iterator<Text> iter =  values.iterator();

 for (Text val : values) {

Text recordNoKey = val;     //new Text(iter.next());

String valSplitted[] = recordNoKey.toString().split(";"); 

//if the input is coming from CDR set corresponding values

    if(key.getSecond().toString().equals(CDR.CDR_TAG))
    {
        trans_dt = recordNoKey.toString();
        trans_dt_long = dateToLong(recordNoKey.toString());
    }
  //if the input is coming from Attributes set corresponding values
    else if(key.getSecond().toString().equals(Attribute.ATT_TAG))
    {
        attribute = valSplitted[0];
        product = valSplitted[1];
        start_dt = valSplitted[2];
        start_dt_long = dateToLong(valSplitted[2]);
        end_dt = valSplitted[3];
        end_dt_long = dateToLong(valSplitted[3]);;
    }

        Text record = val;  //iter.next();
        //System.out.println("RECORD: " + record);
        Text outValue = new Text(recordNoKey.toString() + ";" + record.toString());     

if(start_dt_long < trans_dt_long && trans_dt_long < end_dt_long)
       {
    //concat output columns
        result = attribute + ";" + product + ";" + trans_dt;    

    context.write(key.getFirst(), new Text(result));
    System.out.println("KEY: " + key);
        }
    }
}

private static long dateToLong(String date){
    DateFormat formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
    Date parsedDate = null;
    try {
        parsedDate = formatter.parse(date);
    } catch (ParseException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    long dateInLong = parsedDate.getTime();

    return dateInLong;

}

public static class TextPair implements WritableComparable<TextPair> {

    private Text first;
    private Text second;

    public TextPair(){
        set(new Text(), new Text());
    }

    public TextPair(String first, String second){
        set(new Text(first), new Text(second));
    }

    public TextPair(Text first, Text second){
        set(first, second);
    }

    public void set(Text first, Text second){
        this.first = first;
        this.second = second;
    }

    public Text getFirst() {
        return first;
    }

    public void setFirst(Text first) {
        this.first = first;
    }

    public Text getSecond() {
        return second;
    }

    public void setSecond(Text second) {
        this.second = second;
    }

    @Override
    public void readFields(DataInput in) throws IOException {
        // TODO Auto-generated method stub
        first.readFields(in);
        second.readFields(in);
    }

    @Override
    public void write(DataOutput out) throws IOException {
        // TODO Auto-generated method stub
        first.write(out);
        second.write(out);
    }

    @Override
    public int hashCode(){
        return first.hashCode() * 163 + second.hashCode();
    }

    @Override
    public boolean equals(Object o){
        if(o instanceof TextPair)
        {
            TextPair tp = (TextPair) o;
            return first.equals(tp.first) && second.equals(tp.second);
        }
        return false;
    }

    @Override
    public String toString(){
        return first + ";" + second;
    }

    @Override
    public int compareTo(TextPair tp) {
        // TODO Auto-generated method stub
        int cmp = first.compareTo(tp.first);
        if(cmp != 0)
            return cmp;
        return second.compareTo(tp.second);
    }

    public static class FirstComparator extends WritableComparator {

        protected FirstComparator(){
            super(TextPair.class, true);
        }

        @Override
        public int compare(WritableComparable comp1, WritableComparable comp2){
            TextPair pair1 = (TextPair) comp1;
            TextPair pair2 = (TextPair) comp2;
            int cmp = pair1.getFirst().compareTo(pair2.getFirst());

            if(cmp != 0)
                return cmp;

            return -pair1.getSecond().compareTo(pair2.getSecond());
        }
    }

    public static class GroupComparator extends WritableComparator {
        protected GroupComparator() 
        {
            super(TextPair.class, true);
        }

        @Override
        public int compare(WritableComparable comp1, WritableComparable comp2)
        {
            TextPair pair1 =  (TextPair) comp1;
            TextPair pair2 =  (TextPair) comp2;

            return pair1.compareTo(pair2);
        }
    }

}

} 
```

* * *

```
public class Joiner  extends Configured implements Tool {

public static final String DATA_SEPERATOR =";";                                      //Define the symbol for seperating the output data
public static final String NUMBER_OF_REDUCER = "1";                                  //Define the number of the used reducer jobs
public static final String COMPRESS_MAP_OUTPUT = "true";                             //if the output from the mapping process should be compressed, set COMPRESS_MAP_OUTPUT = "true" (if not set it to "false")
public static final String 
            USED_COMPRESSION_CODEC = "org.apache.hadoop.io.compress.SnappyCodec";    //set the used codec for the data compression
public static final boolean JOB_RUNNING_LOCAL = true;                                //if you run the Hadoop job on your local machine, you have to set JOB_RUNNING_LOCAL = true
                                                                                     //if you run the Hadoop job on the Telefonica Cloud, you have to set JOB_RUNNING_LOCAL = false
public static final String OUTPUT_PATH = "/home/hduser"; //set the folder, where the output is saved. Only needed, if JOB_RUNNING_LOCAL = false

public static class KeyPartitioner extends Partitioner<TextPair, Text> {
    @Override
    public int getPartition(/*[*/TextPair key/*]*/, Text value, int numPartitions) {
        System.out.println("numPartitions: " + numPartitions);
          return (/*[*/key.getFirst().hashCode()/*]*/ & Integer.MAX_VALUE) % numPartitions;
        }
}

private static Configuration hadoopconfig() {
    Configuration conf = new Configuration();

    conf.set("mapred.textoutputformat.separator", DATA_SEPERATOR);
    conf.set("mapred.compress.map.output", COMPRESS_MAP_OUTPUT);
    //conf.set("mapred.map.output.compression.codec", USED_COMPRESSION_CODEC);
    conf.set("mapred.reduce.tasks", NUMBER_OF_REDUCER);
    return conf;
}

@Override
public int run(String[] args) throws Exception {
    // TODO Auto-generated method stub
    if ((args.length != 3) && (JOB_RUNNING_LOCAL)) {

        System.err.println("Usage: Lookup <CDR-inputPath> <Attribute-inputPath> <outputPath>");
        System.exit(2);
    }

    //starting the Hadoop job
    Configuration conf = hadoopconfig();
    Job job = new Job(conf, "Join cdrs and attributes");
    job.setJarByClass(Joiner.class);

    MultipleInputs.addInputPath(job, new Path(args[0]), TextInputFormat.class, CDRMapper.class);
    MultipleInputs.addInputPath(job, new Path(args[1]), TextInputFormat.class, AttributeMapper.class);
    //FileInputFormat.addInputPath(job, new Path(otherArgs[0]));    //expecting a folder instead of a file

    if(JOB_RUNNING_LOCAL)
        FileOutputFormat.setOutputPath(job, new Path(args[2]));
    else
        FileOutputFormat.setOutputPath(job, new Path(OUTPUT_PATH));

    job.setPartitionerClass(KeyPartitioner.class);
    job.setGroupingComparatorClass(TextPair.FirstComparator.class);
    job.setReducerClass(LookupReducer.class);

    job.setMapOutputKeyClass(TextPair.class);
    job.setMapOutputValueClass(Text.class);
    job.setOutputKeyClass(Text.class);
    job.setOutputValueClass(Text.class);

    return job.waitForCompletion(true) ? 0 : 1;
}

 public static void main(String[] args) throws Exception {

     int exitCode = ToolRunner.run(new Joiner(), args);
     System.exit(exitCode);

 }
} 
```

* * *

```
public class Attribute {

public static final String ATT_TAG = "1";

public static class AttributeMapper 
extends Mapper<LongWritable, Text, TextPair, Text>{

    private static Text values = new Text();
    //private Object output = new Text();

    @Override
    public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException {
        //partition the input line by the separator semicolon   
        String[] attributes = value.toString().split(";");
        String valuesInString = "";

        if(attributes.length != 5)
            System.err.println("Input column number not correct. Expected 5, provided " + attributes.length
                    + "\n" + "Check the input file");
        if(attributes.length == 5)
        {
            //setting the values with the input values read above
            valuesInString = attributes[1] + ";" + attributes[2] + ";" + attributes[3] + ";" + attributes[4];
            values.set(valuesInString);
        //writing out the key and value pair
        context.write( new TextPair(new Text(String.valueOf(attributes[0])), new Text(ATT_TAG)), values);
            }
    }
}   

}

public class CDR    {

public static final String CDR_TAG = "0";

 public static class CDRMapper 
    extends Mapper<LongWritable, Text, TextPair, Text>{

        private static Text values = new Text();
        private Object output = new Text();

    @Override
        public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException {
        //partition the input line by the separator semicolon   
    String[] cdr = value.toString().split(";");

    //setting the values with the input values read above
    values.set(cdr[1]);
    //output = CDR_TAG + cdr[1];

    //writing out the key and value pair
    context.write( new TextPair(new Text(String.valueOf(cdr[0])), new Text(CDR_TAG)), values);
        }

     }

} 
```

如果有人至少可以发布教程链接或实现此类连接功能的简单示例，我将很高兴。我搜索了很多，但要么代码不完整，要么没有足够的解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:44:13.783

老实说，我不知道您的代码要做什么，但这可能是因为我会以不同的方式进行操作，并且不熟悉您正在使用的 API。

我将从头开始如下：

*   创建一个映射器来读取其中一个文件。对于读取的每一行，将键值对写入上下文。键是从键创建的文本，值是通过将“1”与整个输入记录连接而创建的另一个文本。
*   为另一个文件创建另一个映射器。此映射器的作用与第一个映射器类似，但其值是通过将“2”与整个输入记录连接起来创建的文本。
*   写一个reducer来做join。reduce() 方法将获取为特定键写入的所有记录。您可以通过查看值是以“1”还是“2”开头来判断哪个输入文件（以及记录的数据格式）。一旦您知道您是否拥有一种、另一种或两种记录类型，您就可以编写合并来自一个或两个记录的数据所需的任何逻辑。

顺便说一句，您使用 MultipleInputs 类在您的作业/驱动程序类中配置多个映射器。

# c# - NHibernate - 对于分离的父实体，级联合并到子实体失败

> ID：13767048
> 
> 赞同：16
> 
> 时间：2012-12-07T16:27:41.047
> 
> 标签：c#, asp.net, nhibernate, nhibernate-mapping, spring.net

**当前方法**

在 ASP.NET Web 表单应用程序（使用 Spring.NET 和 NHibernate）中，我们有一个聚合根（*Person*），其详细信息通过多个屏幕/页面捕获。*Person*实体在进入此工作流之前就存在，对 Person 对象图所做的所有更改都是*原子*的，因此只能在提交最终屏幕时刷新到数据库。

为了实现这一点，我们第一次使用 NHibernate 3.2 从数据库中（延迟地）将*Person*加载到第一页，然后在页面浏览过程中加载序列化的*Person*对象图并将其保存到 HTTP Session 变量。

从 HTTP 会话中检索出*Person后，它与当前 NHibernate 会话处于分离状态，因此我们通过在当前会话上调用***Update()**方法重新连接，如下所示：

```
var sessionPerson = Session[PersonSessionName] as Person;
var currentSession = SessionFactory.GetCurrentSession();
currentSession.Update(sessionPerson); 
```

注意：使用**Lock()**会抛出异常，提示“重新关联的对象有脏集合”。

重新连接后，我们可以按预期遍历对象图，从数据库中提取尚未加载到内存中的子实体的数据。

**映射文件的子集**

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" auto-import="false" assembly="Domain" namespace=" TestApp.Domain">
  <class name="Person" table="Person">
    <id name="Id">
      <generator class="TestApp.CustomNHibernateHiLoGenerator, TestApp.Core" />
    </id>
    <property name="Name" not-null="false" />

    <bag name="PersonCountries" access="field.camelcase-underscore" cascade="all-delete-orphan">
      <key column="PersonId" foreign-key="FK_ PersonCountry_Person" not-null="true" />
      <one-to-many class="PersonCountry" />
    </bag>
  </class>

  <class name="Country" table="Country">
    <id name="Id">
      <generator class="TestApp.CustomNHibernateHiLoGenerator, TestApp.Core" />
    </id>
    ... No back reference to Person
  </class>
</hibernate-mapping> 
```

**领域**

```
public class PersonCountry : Entity, ICloneable
{
    // No properties of note
}

public class Person : Entity, ICloneable
{
    public virtual string Name { get; set; }
    public virtual IEnumerable<PersonCountry> PersonCountries { get; set; }
    ... 
    // More Properties
} 
```

**刷新对数据库的更改**

```
.. // Code-behind
PricingService.Save(ProductContext.Pricing, forceMerge: true);            

public class PricingService : IPricingService
{
   [Transaction]  // Spring.NET transaction
   public Pricing Save(Pricing pricing, bool forceMerge = false)
   {            
      if(forceMerge)
      {
         CurrentSession.Merge(entity);
      }
      else
      {
         CurrentSession.SaveOrUpdate(entity);
      }
   }
} 
```

当需要刷新对数据库的所有更改时，只要我们只更改*Name*，更改就会按预期工作。但是，将新的*Country*项添加到*Person*会导致**Merge()**在一对多关系上的级联失败，并出现以下异常（奇怪的是，删除*Country*可以正常工作）。

```
NHibernate.StaleStateException: Batch update returned unexpected row count from update; actual row count: 0; Expected: 1 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T20:03:38.803

每个具有有效 ID 的实体都被视为持久实体，这就是它尝试在合并中更新它的原因，但因为它尚未保存但它失败了。`session.Flush()`之后调用`session.Update()`

# codeigniter - 如何在 Codeigniter 中设置 textarea 的值？

> ID：13767050
> 
> 赞同：7
> 
> 时间：2012-12-07T16:27:42.393
> 
> 标签：codeigniter, textarea

```
echo form_textarea('general4', set_value('general4'), 'class="general"'); 
```

set_value 函数似乎不适用于 textarea 所以我尝试了这个：

```
<textarea name='general4' class="general"><?=set_value('general4')?></textarea> 
```

但仍然无法正常工作，有什么想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T16:36:50.870

要在 CI 中使用 form_textarea()，您可以传递参数行和列，如下所示

```
 $data = array(
      'name'        => 'txt_area',
      'id'          => 'txt_area',
      'value'       => 'johndoe',
      'rows'        => '5',
      'cols'        => '10',
      'style'       => 'width:50%',
    );

  echo form_textarea($data); 
```

有关更多详细信息，请参阅 CI 用户指南 [https://www.codeigniter.com/user_guide/helpers/form_helper.html#form_textarea](https://www.codeigniter.com/user_guide/helpers/form_helper.html#form_textarea)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T21:53:03.967

您所做的是将 textarea 字段的名称设置为：*'general4'*。我认为你的意思是向你的文本区域返回一个实际的字符串，以便用来自发布请求或 MySQL 数据库或类似的东西的数据预先填充它。有多种方法可以实现这一目标。

**方法一：** 在 set_value() 函数中设置第二个参数，例如：

```
<textarea name='general4' class="general"><?=set_value('general4', $foo)?></textarea> 
```

***方法 2：*** 您始终可以使用内置的 form_textarea() 函数。[在此处](https://www.codeigniter.com/user_guide/helpers/form_helper.html)找到的文档 示例：

*通用的*

```
<?=form_textarea('name', 'value', 'attributs')?> 
```

*案子*

```
<?=form_textarea('general4', $general4, "class = 'foo'")?> 
```

## 从 CI[文档](https://www.codeigniter.com/user_guide/helpers/form_helper.html)：

## 设定值（）

> 允许您设置输入表单或文本区域的值。您必须通过函数的第一个参数提供字段名称。第二个（可选）参数允许您为表单设置默认值。

```
<input type="text" name="quantity" value="<?php echo set_value('quantity', '0'); ?>" size="50" /> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-12T00:01:44.077

问题是我不需要文本字段。所以我没有在操作 url 中设置任何规则。所以我添加了这个：

```
$this->form_validation->set_rules('general4', 'general question' , 'trim|xss_clean'); 
```

而且效果很好！

# c# - unity Interception: 对带有事件的接口进行接口拦截

> ID：13767055
> 
> 赞同：1
> 
> 时间：2012-12-07T16:28:09.877
> 
> 标签：c#, unity-container, unity-interception

我正在尝试使用统一拦截来拦截异常。我定义了一个接口和一个实现该接口的类。

我正在尝试使用 InterfaceInterception，但 Unity 抛出了一个类型不可拦截的异常。我检查了我的类，与成功拦截的其他类的唯一区别是这个类和接口声明了一些事件。如果我使用 VirtualMethodInterception，Unity 不会抛出异常。

我正在使用 C#

为什么 VirtualMethodInterceptor 工作，为什么 InterfaceInterceptor 不工作？

以下是实际代码的简化。

```
public interface IInterfaceToBeInterceptable : IDisposable
{
    event EventHandler<ItemSavedEventArgs> ItemSaved;

    event EventHandler<GenericEventArgs<bool>> JobWasCompleted;

    InvocationResult InvokeJob( JobInvocationParams invocationParams );
}

public class ClassToBeInterceptable : IInterfaceToBeInterceptable
{
    public event EventHandler<ItemSavedEventArgs> ItemSaved;

    public event EventHandler<GenericEventArgs<bool>> JobWasCompleted;

    public InvocationResult InvokeJob( JobInvocationParams invocationParams )
    {
        // Implementation
    }

    public void Dispose()
    {
        // Implementation
    }

    private static GetInfo()

    {
        // Implementation
    }
} 
```

统一配置是

```
<register type="IInterfaceToBeInterceptable" mapTo="ClassToBeInterceptable">
     <lifetime type="singleton" />

     <interceptor type="InterfaceInterceptor" />
     <interceptionBehavior type="Exceptionbehavior"  />
     <interceptionBehavior type="LoggingBehaviour" />
  </register> 
```

异常详情如下

例外是：ArgumentException - ClassToBeInterceptable 类型不可拦截。参数名称：interceptedType

编辑 ：-

该类被指定为另一个类的依赖项，并且在构建另一个依赖于“另一个”类（或者更准确地说，“另一个”类的接口）的类的过程中抛出了上述异常。

# apache-camel - 重试次数过多后停止骆驼

> ID：13767059
> 
> 赞同：1
> 
> 时间：2012-12-07T16:28:14.790
> 
> 标签：apache-camel

我正在尝试实现更高级的 Apache Camel 错误处理：如果有太多挂起的重试，则停止处理并在某处记录所有收集的异常。

第一部分（在太多重试时停止）已经通过以下辅助方法实现，它获取重试队列的大小，如果队列超过某个限制，我只是停止上下文：

```
 static Long getToRetryTaskCount(CamelContext context)   {
    Long retryTaskCount = null;
    ScheduledExecutorService errorHandlerExecutor = context.getErrorHandlerExecutorService();

    if (errorHandlerExecutor instanceof SizedScheduledExecutorService)
    {
        SizedScheduledExecutorService svc = (SizedScheduledExecutorService) errorHandlerExecutor;
        ScheduledThreadPoolExecutor executor = svc.getScheduledThreadPoolExecutor();
        BlockingQueue<Runnable> queue = executor.getQueue();
        retryTaskCount = (long) queue.size();           
    }
    return retryTaskCount;
} 
```

但是这段代码对我来说很臭，我不喜欢它，而且我在这里看不到任何方法来收集导致所有这些重试的异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T17:56:27.107

Camel 2.11 中还有一个新的控制总线组件，它可以做你想做的事（[来源](http://camel.apache.org/controlbus.html)）

```
template.sendBody("controlbus:route?routeId=foo&action=stop", null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:21:18.613

我不会尝试关闭 CamelContext，只是关闭有问题的路线......这样您的应用程序的其余部分仍然可以运行，您可以获得路线统计信息并查看/移动消息到备用队列等。

见[https://camel.apache.org/how-can-i-stop-a-route-from-a-route.html](https://camel.apache.org/how-can-i-stop-a-route-from-a-route.html)

# jquery - 扩展框关闭后如何使页面跳转到节的开头？

> ID：13767067
> 
> 赞同：1
> 
> 时间：2012-12-07T16:28:49.393
> 
> 标签：jquery, html, expander

我引用的页面在这里：

[http://jjnursingnotes.com/NOV12/](http://jjnursingnotes.com/NOV12/)

JQuery 页面位于此处：

[http://jjnursingnotes.com/NOV12/jquery.expander.js](http://jjnursingnotes.com/NOV12/jquery.expander.js)

单击“阅读更多”后，我希望页面跳转到标题（**<h1>**）或 div 层的开头（**<div class="expander" id="sect##" >** ) 在您单击“阅读少”后在该部分的开头。目前，“阅读少”按钮的代码如下所示：

```
 if ( o.userCollapse && !$this.find(o.lessSelector).length ) {
        $this
        .find(detailSelector)
        .append('<br><br><span class="' + o.lessClass + '">' + o.userCollapsePrefix + '<a href="#">' + o.userCollapseText + '</a></span><br><br>');
      } 
```

我的标题都直接在前面指定了名称（001、002 等），我的猜测是简单地将 #001、#002 等添加到 JQ 代码中的链接中。问题是这个脚本定义了页面上的每个“阅读少”按钮，因此每个按钮的变量需要不同。我在正确的轨道上，还是有更有效的方法来做到这一点？

先感谢您。我显然是所有 JS 和 JQuery 方面的新手！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:39:19.113

```
$('.expander .read-more').click(function(e){
 $('html,body').animate({ scrollTop: $(e.target).closest('.expander').offset().top}, "slow");
}) 
```

你去吧:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T16:31:12.450

而不是`<a href="#">`为什么不只使用`<a href="#sect##">`. 然后“少读”将在没有任何 JS 的情况下工作

# javascript - Javascript动态文本框更改焦点

> ID：13767074
> 
> 赞同：3
> 
> 时间：2012-12-07T16:29:06.040
> 
> 标签：javascript, html, dom-events, onfocus

我有一个带有一些静态文本框和一个将创建动态文本框的按钮的 HTML 表单。现在，当单击按钮时，我希望新创建的框能够聚焦。我正在使用`focus()`方法，但它不起作用。另一件事是我有一个`onFocus()`方法可以改变在静态框中工作但在动态框中不工作的背景颜色。

```
function addPhone(){
try{
    var phone = document.getElementById("phone");
    phone.appendChild(document.createElement("Phone"+noOfPhones));

    var textbox = document.createElement("input");
    textbox.setAttribute("type", "textbox");
    textbox.setAttribute("id","phone"+noOfPhones);
    textbox.setAttribute("name","phone"+noOfPhones);

    textbox.setAttributte('onFocus','onFocus(this);');
    textbox.style.background="lightgrey";

    document.getElementById("phone").appendChild(textbox);
    phone.appendChild(document.createElement("br"));

    textbox.focus();

    noOfPhones++;
}catch(err){
    alert(err);
}

}

function onFocus(element){
element.style.background = "lightgrey";
} 
```

请帮忙。我是 JS 新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:46:17.420

尝试：

```
<div id="phone"></div>
<input type="button" onclick="addPhone()" value="Add"/>
<script type="text/javascript">
var noOfPhones=0;
function addPhone(){
    try{
        noOfPhones++;
        var phone = document.getElementById("phone");
        phone.appendChild(document.createTextNode("Phone :"+noOfPhones));
        var textbox = document.createElement("input");
        textbox.setAttribute("type", "textbox");
        textbox.setAttribute("id","phone"+noOfPhones);
        textbox.setAttribute("name","phone"+noOfPhones);
        textbox.setAttribute('onfocus','onFocus(this, true);');
        textbox.setAttribute('onblur','onFocus(this, false);');
        textbox.style.background="white";
        document.getElementById("phone").appendChild(textbox);
        phone.appendChild(document.createElement("br"));
        textbox.focus();
    }catch(err){
        alert(err);
    }
}

function onFocus(element, hasFocus){
if(hasFocus)
    element.style.background = "lightgrey";
else
    element.style.background = "white";
}
</script> 
```

# eclipse - Eclipse：何时使用 .project 文件与 .settings 文件夹？

> ID：13767076
> 
> 赞同：2
> 
> 时间：2012-12-07T16:29:08.267
> 
> 标签：eclipse, eclipse-plugin

开发 Eclipse 插件时，何时应将项目特定信息保存在 .project 文件中，何时应使用保存在 .settings 文件夹中的项目范围首选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:37:04.160

.project 文件仅用于存储 Eclipse 感兴趣的特定信息（例如构建器和性质）。如果您有特定于您的工具和特定项目的设置，则可以将该信息存储在 .settings 文件夹中。

为了解决这个问题，如果您有一般设置信息，您应该创建一个首选项页面并使用该机制来保存设置。

如果您有一些其他信息或程序状态，请使用 Eclipse 为您提供的状态位置。当然，如果这些信息中的任何一个是特定于项目的，您应该考虑将其存储在项目本身中。

再考虑一点，默认情况下，许多版本控制插件会忽略名称以点开头的文件和文件夹（例如 .project 和 .classpath）。如果您存储的数据必须与项目一起保存，那么您应该考虑使用不以点开头的资源名称。

# php - strtotime 使用日期输入

> ID：13767078
> 
> 赞同：1
> 
> 时间：2012-12-07T16:29:19.810
> 
> 标签：php, mysql, html, date, strtotime

现在我有一个包含 HTML5 日期输入的表单和第二个隐藏输入，它使用 strtotime 来获取今天的工作日（周一、周二等）。问题是如果有人选择今天的 12/5，它将输入到数据库 12/5 和星期五，而实际上应该是 12/5 星期三。

```
<input class="form" id="date" type="date" name="date" size="15" placeholder="yyyy-mm-dd" autofocus required />

<input type="hidden" name="weekday" value="<?php echo date('l',strtotime('now')); ?>" /> 
```

当我实现它时，我认为使用今天的日期不会有问题。但是用例已经改变，人们输入新的结果，但使用旧的日期会不匹配。它会在日期中显示为 12/5，在工作日中显示为星期五，而应该是星期三。

我不确定如何将两个输入链接在一起，因为表单实际上还没有提交。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:33:45.847

你为什么不在服务器端这样做呢？

```
$date = $_POST["date"];
$dateString = date('m/d l',strtotime($date)); 
```

[阅读更多](http://php.net/manual/en/function.date.php)关于 PHP date()

[阅读更多](http://php.net/manual/en/function.strtotime.php)关于 PHP strtotime()

只需完全删除隐藏的输入。没有必要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T16:37:29.127

只需使用 PHP 的 DateTime 函数并一起删除隐藏字段。

```
$date = date_create($_POST['date']);
$day = $date->format('l'); 
```

有关 DateTime 构造的更多信息：http: [//us3.php.net/manual/en/datetime.construct.php](http://us3.php.net/manual/en/datetime.construct.php)

我强烈建议养成使用 PHP 内置的 DateTime 类而不是传统日期函数的习惯。它们通常更容易使用，并且不受 unix 时代限制的影响。它们也可以以面向对象的方式或程序方式使用，具体取决于您的编码偏好。

# html - 更改链接文本的字体颜色

> ID：13767079
> 
> 赞同：2
> 
> 时间：2012-12-07T16:29:23.010
> 
> 标签：html, css

我有以下 HTML：

```
 <ul class="unstyled" style="font-size:16px;">
     {% if stuff %} {% for eachthing in stuff %}
     <li>
     <a href = "path"> Stuff goes here </a>
     </li>
     {% endfor %} {% else %}
</ul> 
```

基本上我想在模板中而不是在 CSS 中更改链接的文本颜色。

我该怎么做？我尝试向元素和元素添加“颜色”属性，但无济于事。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T16:30:55.460

你不能简单地应用这样的样式属性吗？您必须使用不适用于元素的`ul`或元素的颜色属性，而不是尝试这个`li``color``<a>`

```
<a href="path" style="color: #ff0000;">Stuff goes here</a> 
```

或者，如果您改变主意并想使用 CSS，而不是使用它

```
ul.unstyled li a {
   color: #ff0000;
} 
```

或者继承父颜色

[**演示**](http://jsfiddle.net/RmY9x/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T16:37:59.507

如果要更改链接的颜色，则可以在悬停期间使用 onmouseover 更改颜色。但是如果不隐式或显式使用 CSS，您将无法更改颜色

# jquery - 如果表单字段无效，则添加类

> ID：13767080
> 
> 赞同：0
> 
> 时间：2012-12-07T16:29:24.347
> 
> 标签：jquery, jquery-validate

使用 jQuery 验证进行 ajax 表单提交，如果任何文本输入具有类“错误”，我想向 errorContainer 添加一个类。看起来很简单，但我认为这是一个范围问题？

```
if ($('#myInput').hasClass('error')) { 
  $('#errorContainer').addClass('foo'); 
} 
```

我把它放在提交处理程序之外，在提交处理程序内部，在验证调用之外，在验证调用内部......都无济于事。有没有人成功地完成了这个简单的任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:32:38.363

你可以这样做：

```
if ($('input[type=text].error').length > 0) { 
  $('#errorContainer').addClass('foo'); 
} 
```

`$('input[type=text].error')`即使只有一个匹配项，选择器也会返回一个类似数组的对象。所以问一个数组是否`hasClass('error')`没有意义。

您真正想要做的是在要检查错误类的元素周围放置一个容器。您可能已经有一个像表单这样的容器（如果它是表单上的所有输入）。然后你可以做这样的事情：

```
<form id="myForm">
  <input type="text" name="a" />
  <textarea name="b"></textarea>
  <input type="submit" value="Submit" />
</form> 
```

使用 JavaScript：

```
$(':input.error', '#myForm').length > 0 
```

这是一个示例[jsfiddle](http://jsfiddle.net/6ecCt/)。请注意，使用[:input 选择器](http://api.jquery.com/input-selector/)将提供比 `input`您想要的更多的输入类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T16:32:49.407

大多数返回值的函数（例如`.val()`、`.hasClass()`等）只会作用于jQuery 对象中包含的选定元素组中的**第一个元素。**

通常在这些情况下，您需要做的是使用该[`.each()`](http://api.jquery.com/each/)函数迭代**所有**元素，并对每个元素进行测试。

但是，由于您正在测试课程，因此您可以按照 Cymen 的答案中的详细说明修改您的条件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T16:33:04.303

您可以只使用[toggleClass](http://api.jquery.com/toggleClass/)并传入条件

```
$('#errorContainer').toggleClass('foo',$('input[type=text].error').length > 0); 
```

因此，如果有任何类错误..添加类 foo..否则删除类 foo

# java - Java中的随机访问文件和额外的ASCII字符

> ID：13767081
> 
> 赞同：1
> 
> 时间：2012-12-07T16:29:24.397
> 
> 标签：java, ascii, polish, randomaccessfile

我有一个充满字符串的随机访问文件（我知道它们不是真正的字符串，尽管它会帮助我解释问题）。我想做的是查看某个字符串，比如说字符串#4。虽然对于整数和通常的原始数据类型来说这很简单，因为它们具有固定的字节长度，我可以通过总结所有先前的字节来读取正确的字节。

我设法通过给所有字符串一个 16 个字符的固定长度来解决这个问题，所以如果我有“狗”这个词，那么 RAF 中的这个词是“狗”（狗 + 13 个空格）并且字节长度是也固定了。同样，我可以使用以下方法轻松读取正确的值：

```
static String loadOne(int n) throws IOException {
    raf = new RandomAccessFile(file, "rw");
    raf.seek((n-1)*(fix+2));
    String x = raf.readUTF();
    return x;
} 
```

其中*n*是我要读取的值的数量，而*fix*是一个字符串的字符数（和字节数）。

一切似乎都很好，直到我在其中一个字符串中使用了一个额外的 ASCII 字符——一个波兰字母——因为它由 2 个字节组成。字符长度仍然相同 - 16，但有 17 个字节，整个事情都崩溃了。

我能做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:34:38.597

我强烈怀疑您没有使用`readUTF`预期的使用方式。你读过它的作用吗？

> 从当前文件指针开始读取前两个字节，就像通过 readUnsignedShort 一样。该值给出了编码字符串中的后续字节数，而不是结果字符串的长度。随后的字节被解释为字节编码字符在修改的 UTF-8 格式，并被转换为字符。

这是否与您文件中存储的内容相匹配？（您尚未指定有关文件格式的任何内容。）

鉴于 UTF-8 不是固定宽度，这听起来不适合您的场景。

我建议每个条目使用 32 个字节，这将始终提供 16 个`char`值作为 UTF-16 代码单元。您可以非常简单地使用`new String(data, "UTF-16BE")`and `text.getBytes("UTF-16BE")`（或者如果需要，可以使用`LE`而不是）来转换它。`BE`这样，您将拥有一个真正固定长度的字符串，就字节而言，而不仅仅是字符。

# xcode - 如何从终端命令引用当前目录

> ID：13767085
> 
> 赞同：2
> 
> 时间：2012-12-07T16:29:42.730
> 
> 标签：xcode, macos, terminal, xcrun

如何从终端命令引用当前目录：

```
xcrun -sdk iphoneos PackageApplication -v "[current dir]/target/My App.app" -o "[current dir]/target/MyApp.ipa" 
```

> [当前目录] = 我如何获得这个值？

所以基本上我不想在命令中输入整个目录。我希望它查看当前正在运行的目录

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T16:33:21.157

```
xcrun -sdk iphoneos PackageApplication -v "$PWD/target/My App.app" -o "$PWD/target/MyApp.ipa" 
```

# vb.net - 带有选择器 lambda 函数的 Enumerable.Max

> ID：13767087
> 
> 赞同：0
> 
> 时间：2012-12-07T16:29:51.447
> 
> 标签：vb.net, lambda, ienumerable

我有一个`Column`自定义类对象的列表。

`Column`类有一个`Position`属性。

列表中的每一列都有不同的位置（当前为 1、2、3、4）

`Max`我想通过属性找到最右边的列`Position`：

```
Enumerable.Max(Of ExcelColumn)(Me.Columns, Function(c) c.Position) 
```

或者

```
Me.Columns.Max(Function(c) c.Position) 
```

两者总是返回`0`，不明白为什么。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:32:40.923

例如：

```
Class Column
    Public Property Position As Int32
End Class

Dim columns As New List(Of Column) From {
    New Column With {.Position = 1}, New Column With {.Position = 2}, New Column With {.Position = 3}, New Column With {.Position = 4}
}
Dim maxColPos As Int32 = columns.Max(Function(c) c.Position)

Console.Write(maxColPos) ' will output 4 
```

顺便说一句，这将返回重复的零，因此`maxColPos=0`：

```
Dim columns As New List(Of Column) From {
    New Column, New Column, New Column, New Column
} 
```

因为 0 是未初始化字段的[默认值。](http://msdn.microsoft.com/en-us/library/83fhsxwc%28v=vs.110%29.aspx)`Int32`

# javascript - 在javascript中将Double转换为String而不会丢失精度

> ID：13767088
> 
> 赞同：3
> 
> 时间：2012-12-07T16:29:53.090
> 
> 标签：javascript

我想将浮点变量转换为字符串而不会丢失任何精度。

即我希望字符串与我的浮点变量包含的信息相同，因为我使用输出进行进一步处理（即使这意味着字符串将非常长且可读）。

为了更清楚地说，我想有循环转换的功能

```
var dA = 323423.23423423e4;
var sA = toString(dA);
var dnA = toDouble(sA); 
```

我希望 dnA 和 dA 相等

谢谢

PS：互联网上的资料通常谈论如何对字符串进行舍入，但我没有找到有关确切表示的信息。另外我对任意精度计算不感兴趣，我只需要双精度浮点运算。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T16:35:34.440

让字符串算术做字符串转换，然后用`parseFloat`它把它恢复为浮点数：

```
var dA = 323423.23423423e4;
var sA = dA + '';
var dnA = parseFloat(sA); 
```

这是一个在行动中看到它[的小提琴。](http://jsfiddle.net/briguy37/fFkVR/)

注意： [所有 JavaScript 数字都是双精度数](https://stackoverflow.com/a/7312732/508537)，因此您无需区分双精度数和浮点数。因此，您唯一需要担心精度损失的地方就是您的第一行。例如，如果你`var dA = 987654321.0123456789`为你的第一行做了，它将等价于`var dA = 987654321.01234567`, 并且`dA`最终仍然是等价`dnA`的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T16:32:49.830

只是`dA.toString()`而且`parseFloat(sA)`应该这样做。

# android - 在 Android 中，如何处理来自蓝牙的字节并将它们写入 CSV 文件？

> ID：13767090
> 
> 赞同：0
> 
> 时间：2012-12-07T16:30:02.353
> 
> 标签：android, csv, bluetooth

我正在编写一个 android 应用程序，它基本上从通过蓝牙接收的数据创建一个 CSV 文件。接收到的数据需要处理并格式化为 CSV。解决这个问题的最佳方法是什么？我是一个新手java程序员，但我正在考虑使用这种方法。一个线程从蓝牙读取输入并验证数据包是否良好。如果数据包是好的，另一个线程或异步任务或服务（不确定使用哪个，有什么建议吗？）将处理数据，格式化，然后将其写入 SQLite 数据库。读取线程和进程线程都完成后，我将数据库中的所有内容写入 CSV 文件。我对多线程或服务不是很熟悉，所以任何示例代码都将不胜感激。

# iphone - 在 iPhone 上测试 GMAIL 应用程序的代码？

> ID：13767091
> 
> 赞同：1
> 
> 时间：2012-12-07T16:30:05.057
> 
> 标签：iphone, debugging, gmail, responsive-design

我正在尝试构建响应式电子邮件模板，但在 iPhone 的 GMAIL 应用程序上查看电子邮件时遇到了渲染问题。我想知道是否有任何开发人员对测试和调试代码有任何建议，类似于在桌面上使用 Firebug/Developer Tools 的方式。

我已经研究了一段时间，似乎只找到了为测试移动浏览器中的代码而构建的网站。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T11:15:45.477

这是一个已知问题，希望 Google 能尽快解决。他们的智能手机应用程序不支持媒体查询，基本上按照桌面视口呈现电子邮件

# android - 从 onPostExecute 调用 Fragment/Activity

> ID：13767093
> 
> 赞同：0
> 
> 时间：2012-12-07T16:30:16.413
> 
> 标签：android, android-asynctask, android-fragments, android-activity, android-fragmentactivity

我在 Activity 中有 3 个片段，例如`splashscreen`,`login`和`register`. 我的 LoginFragment 基于 asynctask。

那么，在登录过程完成后，如何从 LoginFragment 中的 onPostExecute() 调用 registerfragment 呢？

帮我。

代码片段：

```
protected void onPostExecute(httpresponse reesponse) {
mProgressDialog.dismiss();
super.onPostExecute(response);

// here the fragment must be called but how??? 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T09:40:47.103

解决了这个问题...

```
 mFragmentCallbacks.onFragmentFinished(fragmentname.this); 
```

谢谢大家

# linux - 有没有一种有效的方法来读取 bash 中的行输入？

> ID：13767095
> 
> 赞同：1
> 
> 时间：2012-12-07T16:30:21.887
> 
> 标签：linux, bash, shell

我想将大型压缩 CSV 文件拆分为多个较小的 gzip 文件，并在行边界上拆分。

我正在尝试通过管道将 gunzip 传输到 bash 脚本，同时读取 LINE。该脚本写入一个命名管道，后台 gzip 进程正在重新压缩它。每读取一个 X 字符，我都会关闭 FD 并重新启动新的 gzip 进程以进行下一次拆分。

但是在这种情况下，带有 while read LINE 的脚本消耗了 90% 的 cpu，因为 read 在这里效率很低（我知道它会进行一次系统调用来读取 1 个字符）。

关于有效地做到这一点的任何想法？我希望 gzip 消耗大多数 cpu。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:36:21.007

`split`与`-l`选项一起使用以指定所需的行数。使用`--filter`选项`$FILE`是用于输出到文件的名称 split （并且必须用**单**引号引起来以防止外壳过早扩展：

```
zcat doc.gz | split -l 1000 --filter='gzip > $FILE.gz' 
```

如果您需要任何其他处理，只需编写一个脚本，该脚本将接受文件名作为参数并相应地处理标准输入，并使用它而不是 plain `gzip`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T16:41:07.553

如何使用`split`带有`-l`选项的命令？

```
gzcat large.csv.gz | split -l 1000 - xxx
gzip xxx* 
```

# compass-sass - 如何在 Compass 中覆盖线性梯度函数？

> ID：13767096
> 
> 赞同：4
> 
> 时间：2012-12-07T16:30:22.747
> 
> 标签：compass-sass, sass

我想用[这里](https://github.com/chriseppstein/compass/issues/965)的代码来覆盖`linear-gradient`Compass 自带的函数。我怎样才能做到这一点？

我认为我需要的是一种导入`linear-gradient`函数然后在本地将其重命名为其他名称的方法，以便我自己的`linear-gradient`函数可以调用它。例如：

```
@import "compass/css3/images";

// somehow make `original-lg` alias the current `linear-gradient`

@function linear-gradient($args...) {
  @return original-lg($args...) + ", " + fixed-lg-from-link-above($args...);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T17:23:50.493

您正在尝试的将不起作用，因为我们正在处理必须拆分为不同属性的前缀值。作为链接代码的作者，这是我推荐使用它的方式。您将需要这些功能：

```
@function convert-gradient-angle(
  $deg
) {
  @if type-of($deg) == 'number' {
    @return mod(abs($deg - 450), 360deg);
  } @else {
    $direction: compact();
    @if nth($deg,1) == 'to' {
      @if length($deg) < 2 {
        $direction: top;
        @warn "no direction given for 'to'. Using 'to bottom' as default.";
      } @else { $direction: opposite-position(nth($deg,2)); }
      @if length($deg) > 2 { $direction: append($direction, opposite-position(nth($deg,3)), space);}
    } @else {
      $direction: append($direction, to, space);
      @each $pos in $deg { $direction: append($direction, opposite-position($pos), space); }
    }
    @return $direction;
  }
}

@function convert-gradient(
  $angle,
  $details...
) {
  @return linear-gradient(convert-gradient-angle($angle), $details...);
} 
```

问题是，如果您使用多背景或类似的东西，您将不得不自己在不同的属性中重复这些功能。如果您只想要一个简单的背景图像渐变，您可以使用它来简化：

```
@mixin gradient-background-image(
  $gradient...
) {
  @include background-image(convert-gradient($gradient...));
  background-image: linear-gradient($gradient...);
} 
```

否则，您将需要手动编写这两行，并根据需要添加其他层。

# objective-c - iOS non-navigation bar based navigation and view swapping

> ID：13767104
> 
> 赞同：0
> 
> 时间：2012-12-07T16:31:00.857
> 
> 标签：objective-c, ios, cocoa-touch

I'd like to create an app without using the fancy iOS navigation bar. What's the best or most correct way to change between full screens?

So say I start on "Home", and I want to go to "LogIn" without using the navigation bar -- what should I do? Should I change rootViewController? And when I swap in the new view, how do I make sure the old view is completely released? I imagine with ARC if there's no references it will merely disappear? And pre-ARC I have to set everything to null?

Or is the correct way to hide the navigation bar and use its stack?

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:32:44.353

Use the normal `UINavigationController` and set the navigation bar to hidden. Quite easy.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:02:57.887

You can't use the default UINavigationController with the default segues if you don't want a stack. If you want all the views behind the destination to be released they have to be removed from the stack as the destination goes on screen.

My answer would be to put everything in a navigation controller, set the bar to hidden (`self.navigationController.navigationBarHidden = YES;`) and create a custom segue that overrides the `perform` method like this:

```
- (void) perform {
    UIViewController* destination = self.destinationViewController;
    NSArray* newStack = [NSArray arrayWithObject:destination];
    UIViewController* source = self.sourceViewController;
    [source.navigationController setViewControllers: newStack animated: YES];
} 
```

Then, wire everything up like normal and make the segues your custom class. That way any time you segue the stack will be cleared of everything but the newly visible controller.

EDIT: I'm guessing you edited to clarify that you wanted to use that stack whilst I was writing this. Oh, well. In that case, yeah, just set the bar to hidden and use like normal.

# css - 如何在 IE 中删除音频标签周围的空格

> ID：13767111
> 
> 赞同：2
> 
> 时间：2012-12-07T16:31:18.407
> 
> 标签：css, html, internet-explorer, html5-audio

我想知道 IE 中音频标签周围的空白是从哪里来的。我似乎无法指出它。这是一个已知的问题？

```
<audio controls>
   <source src="http://www.w3schools.com/html/horse.ogg" type="audio/ogg">
   <source src="http://www.w3schools.com/html/horse.mp3" type="audio/mpeg">
 Your browser does not support the audio element.
 </audio> 
```

在行动：[jsFiddle](http://jsfiddle.net/f6z9L/)

使用：IE10

截屏： ![在此处输入图像描述](../Images/3ab43f64591cbf0e721e66e09947bc9d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:45:21.163

您是否将 body/html 等元素的边距和填充清零？

`normalize.css`on jsfiddle 在某些元素上将其归零，但不包括在`html`其中。

尝试放入`* { margin:0; padding:0; }`CSS。

# c# - 安装或配置 Interop.Microsoft.Office.Interop.Word.dll

> ID：13767115
> 
> 赞同：0
> 
> 时间：2012-12-07T16:31:25.630
> 
> 标签：c#, asp.net, interop, office-2013

情况：我的电脑中有网络应用程序，它可以毫无问题地操作文档生成 pdf。我将 dcomcnfg 配置为可以正常工作，因为 COM 的访问权限存在问题。

问题：我必须把网站放在服务器上。服务器有Win8 Enterprise。没有安装 Visual Studio，只有框架 4.0 和 Word Office。当我尝试生成 pdf 时，它总是返回此错误：Retrieving the COM class factory for component with CLSID ... 我运行 dcomcnfg 并自定义了对 IIS 服务的所有权限（不起作用并放入）每个人。我将所有启动和激活权限设置为允许所有人，我还设置了访问权限和配置权限.. 仍然无法正常工作。

*   我必须在服务器中注册 dll？（我该怎么做？）
*   我需要更多配置？
*   我必须安装所有Office？

ps：Office 2013

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:40:36.223

虽然不建议在服务器上使用它，但有一个可能的解决方案：

在 asp.net 应用程序中模拟管理员：http: [//msdn.microsoft.com/en-us/library/aa292118%28v=vs.71%29.aspx](http://msdn.microsoft.com/en-us/library/aa292118%28v=vs.71%29.aspx)

*   它可能有安全问题。

# wordpress - 在 wordpress 中获取当前帖子的分类术语

> ID：13767120
> 
> 赞同：5
> 
> 时间：2012-12-07T16:31:39.827
> 
> 标签：wordpress

我正在尝试使用与当前帖子相关的分类术语填充表单值字段，

我一定尝试了 20 件事，但找不到正确的解决方案。？

我有元字段，但这很容易我刚刚使用了这个：

```
$ref = get_post_meta( $post->ID, 'job_ref', true ); 
```

这对于表单字段：

```
 <input type="text" class="text" name="job_ref" id="job_ref" value="
  <?php echo $ref; ?>" /> 
```

所以我正在为分类术语寻找类似的解决方案..？

非常感谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-07T16:48:44.590

用于`wp_get_post_terms`检索您的帖子条款。这里的语法：

[http://codex.wordpress.org/Function_Reference/wp_get_post_terms](http://codex.wordpress.org/Function_Reference/wp_get_post_terms)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-08-16T14:54:14.367

您可以使用[`get_the_terms()`](https://developer.wordpress.org/reference/functions/get_the_terms/). [`get_the_terms()`](https://developer.wordpress.org/reference/functions/get_the_terms/)和之间的区别在于[`wp_get_post_terms()`](https://codex.wordpress.org/Function_Reference/wp_get_post_terms)的`get_the_terms()`结果被缓存。

# ios - iOS 6 UIWebView 视频不旋转

> ID：13767122
> 
> 赞同：1
> 
> 时间：2012-12-07T16:31:50.527
> 
> 标签：ios, video, uiwebview

我有一个 UIWebView，它显示了一个包含一些嵌入式视频的网站。我注意到，当我在播放视频时尝试旋转手机时，它不会在 iOS 6 上旋转。以前的版本工作正常。我什至尝试了一个 tumblr 提要，它似乎也在那里坏了。

还有其他人有这个问题吗？

# java - Java自定义异常类使用

> ID：13767124
> 
> 赞同：1
> 
> 时间：2012-12-07T16:31:58.020
> 
> 标签：java, exception

> **可能重复：**
> [抛出或尝试捕获](https://stackoverflow.com/questions/3203297/throws-or-try-catch)

我正在编写一个 API，我希望编写代码以便我可以在特定场景中引发异常。我创建了一个异常类，如下所示：-

```
public class InvalidSeverityException extends Exception {
    private static final long serialVersionUID = 1L;
    public InvalidSeverityException() {
        // TODO Auto-generated constructor stub
    }
} 
```

在代码库中，我有以下调用代码：-

```
throw new InvalidSeverityException(); 
```

但是 Eclipse 建议我要么使用它，要么`throws`将它包含在一个`try ... catch`块中。我觉得我不应该发现这个错误，使用我的 API 的开发人员应该将代码包含在`try...catch`.

那有意义吗？难道我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T16:40:36.770

在 Java 中处理异常时，您必须了解已*检查异常*和*未*检查异常的概念。

在您的情况下，您当前正在定义一个已检查的异常，也许您想要一个未检查的异常。

以下是关于每种类型的简要说明：

## 检查异常

此异常必须是引发它们的方法签名的一部分（或调用一个这样做的方法），或者您必须用`try catch`块捕获它们并处理问题。当可以对错误采取一些措施时，以及当您希望开发人员意识到可能会发生此类错误并且必须处理时，通常会使用已检查的异常。

在 java`java.lang.Exception`中是一个检查异常，它的所有子类也将被检查。

## 未经检查的异常

另一方面，这种异常不需要成为方法签名的一部分，也不需要包装在`try catch`块中抛出新的方法。只是期望调用堆栈中的某个地方会有一个`try catch`来处理它，否则如果它到达 JVM，它会*很好地*转储你一个堆栈跟踪。

在java`java.lang.RuntimeException`中是一个未经检查的异常，它的所有子类也是如此。

**我的意见**

如果您正在定义 API，我的建议是使用*检查异常*，这主要是因为您明确告知使用您的 API 的开发人员可能会发生此类异常（因此他们可以随心所欲地处理它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T16:33:23.197

您`throw new InvalidSeverityException();`应该定义 throws的方法`InvalidSeverityException`

例子：

```
 void yourMethod() throws InvalidSeverityException
    {
    ........//Some code
    throw new InvalidSeverityException();

    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T16:34:36.837

你是对的，你不应该抓住它。正如 eclipse 所建议的那样，您应该使用`throws`以便开发人员知道您的方法可能会引发该异常，然后可以捕获它。

```
.... method() throws YourException{ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T16:35:01.947

那么你肯定会遵循 Eclipse 的第一个建议并设置你的方法来抛出异常。

```
public void myMethod() throws InvalidSeverityException {
    //throw it somewhere in here so that other 
    //developer can catch it while calling your method
} 
```

# java - 带有实体名称的休眠查询

> ID：13767125
> 
> 赞同：2
> 
> 时间：2012-12-07T16:31:59.437
> 
> 标签：java, hibernate, hbmxml

我正在使用 POJO 来定义两个表（主表和备份表）。两个 XML 类都引用同一个 Java 类。

参考：[将同一个 POJO 映射到 Hibernate XML 映射文件中的多个表](http://www.coderanch.com/t/492558/ORM/databases/Mapping-POJO-table-Hibernate-XML)

```
<hibernate-mapping>
    <class name="com.mypackage.model.Table1" table="Table1" entity-name="Table1">
        <id name="Id" type="java.lang.Long">
            <column name="ID" />
            <generator class="identity" />
        </id>
        <property name="name" type="string">
            <column name="NAME" length="20" />
        </property>
        <property name="age" type="int">
            <column name="AGE" />
        </property>
    </class>

    <class name="com.mypackage.model.Table1" table="Table2" entity-name="Table2">
        <id name="Id" type="java.lang.Long">
            <column name="ID" />
            <generator class="identity" />
        </id>
        <property name="name" type="string">
            <column name="NAME" length="20" />
        </property>
        <property name="age" type="int">
            <column name="AGE" />
        </property>
    </class>
</hibernate-mapping> 
```

POJO定义：

```
public class Table1 implements Serializable {

    private static final long serialVersionUID = -594654774484987124L;

    private Long id;
    private String Name;
    private int Age;
// Getters and setters.... Removed...
} 
```

我能够创建不同的表。并且还使用

```
 session.saveOrUpdate(entityName, myObject) 
```

API 我可以单独为这些表添加新记录。

检索时，我正在使用 HQL

```
Query query = session.createQuery("from Table1");
list = query.list(); 
```

它返回了 Table1 和 Table2 中的所有记录。如果我尝试给 Table2，则会显示错误“Table2 is not mapped”

是否有任何可以单独从表 1 和表 2 中检索记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:43:30.967

将属性添加 `polymorphism="explicit"`到您的类标签。

代码 ：

```
 <class name="com.mypackage.model.Table1" table="Table1" entity-name="Table1" polymorphism="explicit"> 
```

# jquery - 将 hoverintent 添加到 visio 生成的网页

> ID：13767127
> 
> 赞同：1
> 
> 时间：2012-12-07T16:32:16.237
> 
> 标签：jquery, visio, hoverintent

我正在使用 Visio 2010 Professional 生成工作流网站。我编辑了 Visio 创建的 Javascript，以在鼠标悬停时加载左侧框架，而不是使用默认使用的 Ctrl+Click 方法。这个左侧框架包含一些形状上的链接。在一个非常繁忙的页面上，如果不跨越另一个形状，几乎不可能将鼠标移到左侧框架。

我在互联网上找到了 hoverIntent 并希望实现它，但在 jQuery 和 Javascript 方面我绝对是新手。如何将 hoverIntent 添加到如下所示的 Visio 形状？

```
<v:shape type="#VISSHAPE"  origHref="" style="cursor: pointer;" tabindex="1" title="Foo" origTitle="Foo"  style="top:-1000;left:-1000;width:2594;height:2000;position:absolute" path=" m -448,-292 l 90,-292 l 90,-514 l -448,-514 l -448,-292xe" onmouseover="UpdateTooltip(this,42,5)" onclick="OnShapeClick(42,5)" onfocus="UpdateTooltip(this,42,5);" onkeyup="OnShapeKey(42,5)"/> 
```

理想情况下，hoverIntent 将用简单的东西替换“onmouseover”。让我知道是否有人有任何想法。我也将继续搜索谷歌任何帮助。

# c++ - 带 asio 的多套接字架构

> ID：13767132
> 
> 赞同：1
> 
> 时间：2012-12-07T16:32:39.160
> 
> 标签：c++, performance, sockets, client-server, boost-asio

我有一个客户端 - 服务器架构，有 10 个服务器，与一个客户端永久连接，该软件是用 C++ 编写的，并使用 boost asio 库。所有连接都是在初始化阶段创建的，并且在执行过程中始终处于打开状态。当客户端需要一些信息时，向所有服务器发送请求。每个服务器都会找到所需的信息并回答客户端。

在客户端中，有一个线程负责接收来自所有套接字的消息，特别是，我只使用一个`io_services`，每个套接字都有一个 async_read。

当消息到达其中一个套接字时，`async_read`读取作为消息头的前 N ​​位，然后调用使用`read`（同步）读取消息其余部分的函数。对于服务器端，标头和消息的其余部分通过单个`write`（同步）发送。

然后，架构可以正常工作，但我注意到有时同步`read`需要比平时更多的时间（~0.24 秒）。理论上，数据已经准备好被读取，因为当已经读取了标头`read`时调用了同步。`async_read`我还看到，如果我只使用一台服务器而不是 10 台，则不会出现此问题。此外，我注意到这个问题不是因为消息的维度引起的。

是否有可能因为`io_service`无法处理所有 10 而出现问题`async_read`？特别是，如果所有套接字同时收到一条消息，是否会`io_service`失去一些时间来管理队列并减慢我的同步速度`read`？

我没有发布代码，因为很难从项目中提取出来，但如果你不理解我的描述，我可以写一个例子。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T19:17:24.343

如果您选择异步设计，请不要混入一些同步部分。用异步读取和写入替换所有同步读取和写入。读取和写入都会阻塞您的线程，而异步变体不会。

此外，如果您在读取标头后准确地知道预期的字节数，您应该准确地请求该字节数。

如果您不知道，您可以选择`async_read_some`具有您期望的最大消息大小的单个。`async_read_some`将通知您实际读取了多少字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T18:17:26.067

1）当 async.read 完成处理程序被调用时，这并不意味着某些数据可用，这意味着该时刻所有可用的数据*都已被读取*（除非您指定了限制完成条件）。因此后续的 sync.read 可能会等到更多数据到达。

2) 阻止完成处理程序是一个坏主意，因为您实际上阻止了所有其他完成处理程序和其他发布到该处理程序的函子`io_service`。考虑改变你的设计。

# php - 使用模板的电子邮件功能。包括通过 ob_start 和全局变量

> ID：13767135
> 
> 赞同：3
> 
> 时间：2012-12-07T16:32:41.530
> 
> 标签：php, templates, global-variables, abstract-class, ob-start

我有一个简单的 Email() 类。它用于从我的网站发送电子邮件。

```
<?
Email::send($to, $subj, $msg, $options);
?> 
```

我还有一堆用纯 HTML 编写的电子邮件模板，其中包含一些 PHP 变量。例如`/inc/email/templates/account_created.php`：

```
<p>Dear <?=$name?>,</p>
<p>Thank you for creating an account at <?=$SITE_NAME?>. To login use the link below:</p>
<p><a href="https://<?=$SITE_URL?>/account" target="_blank"><?=$SITE_NAME?>/account</a></p> 
```

为了渲染 PHP 变量，我必须`include`将模板放入我的函数中。但由于`include`不返回内容，而是直接将其发送到输出，我不得不用缓冲区函数包装它：

```
<?
abstract class Email {
    public static function send($to, $subj, $msg, $options = array()) {
        /* ... */
        ob_start();
        include '/inc/email/templates/account_created.php';
        $msg = ob_get_clean();
        /* ... */
    }
} 
```

之后我意识到 PHP vars 没有被渲染，因为它们在函数范围内，所以我必须在模板内全局化变量：

```
<?
global $SITE_NAME, $SITE_URL, $name;
?>
<p>Dear <?=$name?>,</p>
... 
```

所以问题是是否有更优雅的解决方案？主要是我担心我使用`ob_start()`and的解决方法`global`。出于某种原因，这在我看来很奇怪。或者这几乎是常见的做法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T16:44:54.563

一种方法是将文件内容读取到变量中，然后使用正则表达式替换占位符。例如，您有 new-users-template.phtml。您阅读它的内容`$content = file_get_content('new-users-templae.phtml');`。在这些模板中，您将有占位符，如`%%username%%`, `%%sitename%%`, `%%siteurl%%`. 您需要使用 处理此内容`str_replace`，替换占位符。将此代码移动到某个`"prepareEmailTemplate"`函数并将此函数的结果放入您的`"send"`函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T17:49:46.573

[您可以在此答案](https://stackoverflow.com/questions/3706855/send-email-with-a-template-using-php)中找到更优雅的问题解决方案。
注意使用 PHP[提取](http://php.net/manual/en/function.extract.php)函数来实例化模板变量。
换句话说，您应该将模板解析逻辑移到电子邮件发送功能之外。
例如：

```
<?php

class SimpleTemplate {
    private $_tpl  = "";
    private $_vars = array();

    function __construct($tpl_name) {
         $this->_tpl = $tpl_name;
    }

    public function __set($name, $value) {
        $this->_vars[$name] = $value;
    }

    public function setVars($values) {
        $this->_vars = $values;
    }

    public function parse() {
        ob_start();
        extract($this->_vars);
        include $this->_tpl;
        return ob_get_clean();
    }
}

abstract class Email {
    public static function send($to, $subj, $msg, $options = array()) {
        /* ... */
    }
}

$tpl = new SimpleTemplate('/inc/email/templates/account_created.php');
$tpl->name = 'Stack Overflow';
$tpl->SITE_NAME = 'site_name';
$tpl->SITE_URL = 'localhost';
Email::send("me@localhost", "Subject", $tpl->parse());

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T00:31:09.027

一种解决方案是将不需要在模板内部而是在函数内部的变量进行全球化`send`。

```
public static function send($to, $subj, $msg, $options = array()) {
    global $SITE_NAME, $SITE_URL, $name;

    /* ... */
    ob_start();
    include '/inc/email/templates/account_created.php';
    $msg = ob_get_clean();
    /* ... */
} 
```

另一种解决方案是将这些额外的变量作为参数传递。这可能很难看，因为`set`函数中的参数数量可能会增加很多，具体取决于模板中需要多少参数。为了解决这个问题，实现此解决方案的另一种方法是将这些额外的变量作为哈希传递并即时创建这些变量（使用函数`eval`）。这是一个例子：

```
public static function send($to, $extra_vars = array()) {
    foreach ($extra_vars as $key => $value) {
        eval("\$$key = '$value';");
    }

    /* ... */
    ob_start();
    include '/inc/email/templates/account_created.php';
    $msg = ob_get_clean();
    /* ... */
} 
```

那么当你应该像这样调用发送时：

```
$SITE_NAME = "www.somewebsite.com";
Email::send("recipient", array('SITE_NAME' => $SITE_NAME)); 
```

# python - 来自套接字的 Python 商店列表

> ID：13767137
> 
> 赞同：0
> 
> 时间：2012-12-07T16:32:47.940
> 
> 标签：python, list, increment

我的脚本遇到问题：我想将一个字符串存储在一个列表中，并用这些字符串递增这个列表。字符串是从服务器响应中检索的。

这可以在 Python 中像这样恢复：

```
import socket
from socket import *

host = "10.0.0.23",445
def Test(host):
    s = socket(AF_INET, SOCK_STREAM)
    s.connect(host)  
    s.settimeout(30) 
    string ="Test"
    s.send(string)
    data = s.recv(2048)
    StringToStore = data[0:5]#Important: Values returned are random.
    return StringToStore

def ListIncrement(T):
    for x in range(5):  
        ListStr = Test(host)
    ListValue = list(ListStr)
    return ListValue

Testing = ListIncrement(Test)
print "Testing if ListIncrement returned a list of 5 differents strings :", Testing 
```

由于某些我无法理解的原因，这显然不起作用，但我希望 ListIncrement(T) 返回的是这样的数组：

```
['1234','4321','3214','2314','4322'] 
```

提前非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:40:39.333

您可能打算执行以下操作：

```
 ListValue = []
    for x in range(5):  
        ListValue.append(Test(host))
    return ListValue 
```

这也可以作为列表理解来完成：

```
return [Test(host) for x in range(5)] 
```

# javascript - 使用 Drupal 在灯箱中打印“节点/添加”表单

> ID：13767142
> 
> 赞同：2
> 
> 时间：2012-12-07T16:32:58.453
> 
> 标签：javascript, drupal, drupal-hooks, hook-menu

我在灯箱中打印“节点/添加”表单时遇到了一些麻烦。

我有`custom.module`这样的`hook_menu`：

```
 $items['get-form/%'] = array(
    'title' => t('Get a form'),
      'description' => t('Get form'),
      'page callback' => '_get_form',
      'page arguments' => array(1),
      'access arguments' => array('access content'),
      'type' => MENU_CALLBACK,
    ); 
```

... 其中 % 是 id，例如“story_node_form”。

然后，我有这样的回调函数：

```
function _get_form($form_id){
  module_load_include('inc', 'node', 'node.pages');

  if (strpos($form_string, "_node_form")){
    //Test if the form is a <type>_node_form. Is the node/add/<type>
    $content_type = explode("_node_form", $form_id)[0];
    print drupal_render(node_add($content_type));
  } 
```

表单在灯箱中显示正确。问题是表单（所见即所得、节点引用、术语引用......）的 javascript 不起作用。

我试图执行`Drupal.attachBehaviors()`，`Drupal.attachBehaviors(document)`但`Drupal.attachBehaviors("#story-node-form")`似乎没有任何效果。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T11:48:25.717

这段代码应该可以解决问题：

```
function _get_form($form_id){
    global $user;
    $node = (object) array(
        'uid' => $user->uid, 
        'name' => (isset($user->name) ? $user->name : ''), 
        'type' => 'ENTER NODE TYPE HERE', 
        'language' => LANGUAGE_NONE
    );
    $form_state['build_info']['args'] = array($node);
    form_load_include($form_state, 'inc', 'node', 'node.pages');
    echo drupal_render(drupal_build_form($form_id, $form_state));
} 
```

您需要获取节点类型以及 form_id 才能使其正常工作，但这应该不难。

# c# - 在 WCF 服务中使用我们自己的 xsd 文件

> ID：13767147
> 
> 赞同：1
> 
> 时间：2012-12-07T16:33:13.650
> 
> 标签：c#, wcf, xsd, wsdl, xsd.exe

我们有一个 xsd 文件，其中已经定义了合约。我们用来`xsd.exe`为我们的 WCF 服务生成类，并`XmlSerializerFormat`再次为我们的 web 服务使用。

在我看来，这是一件很奇怪的事情，让 WCF 为`xsd.exe`为我们生成的类生成一个新的 XSD，而我们已经有了我们的 XSD 定义。

虽然`xsd.exe`为我们生成类做得很好，但它也简化了复杂类型，正如您在我[之前的问题](https://stackoverflow.com/questions/13761543/xsd-exe-ignores-simple-complextypes)中看到的那样；意思是，xsd在生成类并再次在webservice中使用时实际上会发生一些变化；ArrayOfStringXXX 问题..

我们是否可以告诉 WCF 服务使用我们自己的 xsd 文件作为其合同，而不是根据 xsd.exe 提供的内容生成新合同？

我尝试了什么：

*   我已经看过这个示例：[IWsdlExportExtension 接口示例](http://winterdom.com/2006/09/asampleiwsdlexportextensionforwcf)，它看起来很受欢迎，但我无法替换导出方法中的 xsd，因为它从未被调用过。

**TL;DR：我们能否将 WCF 服务指向我们自己的 xsd 文件，而不是让它自己生成？**

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:41:57.980

您可以使用[WSCF.blue](http://wscfblue.codeplex.com/)之类的工具从您的 XSD 文件生成数据协定类。我有这方面的经验，并且在大多数情况下都可以正常工作。 [请参阅此博客以获得很好的解释。](http://msdn.microsoft.com/en-us/magazine/ee335699.aspx)

还有其他工具可以实现这一点，请参阅[此问题](https://stackoverflow.com/questions/1047161/contract-first-soa-with-wcf)以获取一些建议。

Visual Studio 2012 中似乎也有一个新选项，请参阅[文档](http://msdn.microsoft.com/en-us/library/hh674270.aspx)。我自己没有检查过这个。

这种开发方法被称为*契约优先*，所以你会在谷歌上找到更多信息:-)

# java - Java AES 256 CBC 模式无法正常工作

> ID：13767150
> 
> 赞同：1
> 
> 时间：2012-12-07T16:33:20.230
> 
> 标签：java, aes, cbc-mode

这是在 ECB 和 CBC 中执行 AES 的红宝石代码：

```
 require 'openssl'
require 'base64'
def encrypt(data, key, cipher_type)
  aes = OpenSSL::Cipher::Cipher.new(cipher_type)
  key = key.ljust(32, "\0")
  aes.encrypt
  aes.key = key
  Base64.encode64(aes.update(data) + aes.final).tr("\n","")
end

puts encrypt("XJ5QJSVMKZGBOQO7HMSIJO5BERW2OYWDVNPM3BH32NLSWUCNJ4FIP3BML7EKUBNO", "000000", 'AES-256-ECB')
puts encrypt("XJ5QJSVMKZGBOQO7HMSIJO5BERW2OYWDVNPM3BH32NLSWUCNJ4FIP3BML7EKUBNO", "000000", 'AES-256-CBC') 
```

这是Java等价物：

```
 import org.apache.commons.codec.binary.Base64;

import java.io.UnsupportedEncodingException;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.security.NoSuchProviderException;
import java.security.SecureRandom;
import java.security.spec.InvalidKeySpecException;
import java.util.Arrays;

import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.PBEKeySpec;
import javax.crypto.spec.SecretKeySpec;

public class AESTest 
{ 
    public static void main(String [] args)
    {
        System.out.println(AESEncryptToBase64("AES/ECB/PKCS5padding", "000000", "XJ5QJSVMKZGBOQO7HMSIJO5BERW2OYWDVNPM3BH32NLSWUCNJ4FIP3BML7EKUBNO"));
        System.out.println(AESEncryptToBase64("AES/CBC/PKCS5padding", "000000", "XJ5QJSVMKZGBOQO7HMSIJO5BERW2OYWDVNPM3BH32NLSWUCNJ4FIP3BML7EKUBNO"));
    }

    /**
     * 
     * @param secret
     * @param cleartext
     * @return encrypted b64 string
     */
    public static String AESEncryptToBase64(String cypher, String secret, String clearText) {
        byte[] rawKey = new byte[32];
        java.util.Arrays.fill(rawKey, (byte) 0);
        byte[] secretBytes = secret.getBytes();
        for(int i = 0; i < secretBytes.length; i++){
            rawKey[i] = secretBytes[i];
        }

        SecretKeySpec skeySpec = new SecretKeySpec(rawKey, "AES");
        try{ 
            Cipher cipher = Cipher.getInstance(cypher);
            cipher.init(Cipher.ENCRYPT_MODE, skeySpec);
            byte[] encryptedData = cipher.doFinal(clearText.getBytes());
            if(encryptedData == null) return null;
            // return "l";
            return Base64.encodeBase64String(encryptedData);
        } catch (Exception e){
            e.printStackTrace();
        }
        return null;      

    }
} 
```

**编译：commons jar：[http :](http://apache.mirrors.pair.com//commons/codec/binaries/commons-codec-1.7-bin.zip) **//apache.mirrors.pair.com//commons/codec/binaries/commons-codec-1.7-bin.zip****

 **```
 $ javac -cp .:commons-codec-1.7.jar AESTest.java 
```

**跑**

```
 $ ruby aestest.rb 
hYnClaUD9brJfNpEp4YDH0l1Y/QBlGkclnVN8MObNZFsvykd2da8iT2pcwLftNfox1HK/KFWrdfXt0qhP0Aq/fudP1FPIhF3vUTOEDzJbiY=
hYnClaUD9brJfNpEp4YDH5xcdKI4W5soPmWMpU+NikmAEKGSZkDP3KaJVSqRyOHt3JlcoyQzPbuoHxPV6kw6GH/4atDrcmCwV5LacTp+mBg=

$ java -cp .:commons-codec-1.7.jar AESTest
hYnClaUD9brJfNpEp4YDH0l1Y/QBlGkclnVN8MObNZFsvykd2da8iT2pcwLftNfox1HK/KFWrdfXt0qhP0Aq/fudP1FPIhF3vUTOEDzJbiY=
kZZNkbxis/W9UtEgRkxakGH28QetvK4lbf/SxBLrNDYPkGnf3w4MwonOCsoi9FjLAQ34aElOJ3KUjm62fiYLWxwNiE/wls7AcQnXLD19ano= 
```

请注意，ECB 模式完全适用于两者。但CBC模式不同。我也在 C 上运行它，结果证明 Ruby 是正确的，Java 不是。

我在 Java 中做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:37:01.680

对于 CBC，您需要提供一个初始化向量，例如：

```
cipher.init(Cipher.ENCRYPT_MODE, skeySpec, new IvParameterSpec(new byte[16])); 
```

在您的代码中有一个 if 语句和两个不同的 init。欧洲央行的那个很好，这个欧洲央行不行。**

# java - 当我尝试检测内存泄漏时分析中的内存大小

> ID：13767153
> 
> 赞同：0
> 
> 时间：2012-12-07T16:33:31.777
> 
> 标签：java, memory, netbeans, profiling, heap-memory

我用`-Xms512m -Xmx1G -Xss1G`. 我进行分析以验证内存，所以我`Track every 10 object allocations`. 我观察到这个数字：

![在此处输入图像描述](../Images/3cc9d1c21aa37fa5ae5d8eb29ea88600.png)

我的问题是，为什么它显示我的`117mo`代表`40%`，而我给予`1G`记忆？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:38:41.073

该图是所有分配的百分比，而不是堆大小。添加该屏幕截图中的所有百分比，它们达到〜100％

# ios - 在 UIView 的 animateWithDuration 块方法中阻止 self 和 dot 访问器的作用域

> ID：13767155
> 
> 赞同：0
> 
> 时间：2012-12-07T16:33:36.567
> 
> 标签：ios, uiview, uikit, core-animation

通过 animateWithDuration 块内的点访问器访问 self 和 self 的属性是否安全？

我遇到了一些与扩展自身框架相关的动画故障，尤其是当我调用 self.frame 时，如下所示：

```
[UIView animateWithDuration:timeInterval animations:^{
    self.citiesTableView.frame = CGRectMake(0, 100, 320, 120);
    self.frame = CGRectMake(0, 0, 320, 220);
} completion:^(BOOL completed){
    if (completed) {
        self.citiesTableView.frame = CGRectMake(0, 100, 320, 120);
        self.frame = CGRectMake(0, 0, 320, 220);
        [self.citiesTableView reloadData];
    }
}]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:40:18.060

由于视图不保留块，因此`self`在块内强捕获是安全的。当块强捕获（有意或错误地，通过访问实例变量）并被视图保留时，就会出现问题，`self`例如，当使用块作为条形按钮项的响应时。在这里，块被执行并被丢弃。

# visual-studio - 在 Visual Studio 预构建事件中，如何在其自己的文件夹而不是 bin 文件夹的上下文中执行 exe？

> ID：13767157
> 
> 赞同：16
> 
> 时间：2012-12-07T16:33:42.593
> 
> 标签：visual-studio, build-process, build-automation

我有一个这样定义的预构建事件：

```
$(ProjectDir)PreBuild\runthis.exe 
```

当 runthis.exe 执行时，它在我的项目的 bin 文件夹的上下文中运行，而不是在它所在的 PreBuild 文件夹中运行。如何使构建事件在 PreBuild 文件夹而不是 bin 文件夹的上下文中执行 runthis.exe？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-07T16:36:30.140

首先添加`cd $(ProjectDir)PreBuild`以切换到该文件夹​​。

# javascript - 使用 CSS 或 Javascript 在 DIV 中垂直拉伸文本

> ID：13767159
> 
> 赞同：1
> 
> 时间：2012-12-07T16:33:44.583
> 
> 标签：javascript, jquery, css

我们在您的网页布局中有一个固定宽度和高度的 DIV。文本会根据 DIV 内的某些上下文自动插入，并且文本的长度通常适合大部分框垂直填充。也许在框的底部有一两行空行。业务要求：文字顶部和文字底部要与框的上下边距对齐。*有没有办法通过CSS或Javascript自动*垂直拉伸文本（例如通过调整第八行）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:04:08.650

总有办法的。;-) 使用纯 CSS 很难做到这一点，除非有一个我不知道的新属性。

我很想用 JavaScript 来做，特别是因为盒子的尺寸没有改变。这真的只是一堆数学。这是一个刚刚拼凑在一起的样本。我没有在任何其他浏览器中尝试过，你的里程可能会有所不同......但至少这是一个起点。指向小提琴的链接（作为参考点添加的第二个框）：http: [//jsfiddle.net/j98Rh/](http://jsfiddle.net/j98Rh/)

HTML：

```
<div id="box">
  <p>
  This is a bunch of text, blah blah blah, just a bunch of text. 
  I like to think about whether elves are really just angels who 
  gave up their old jobs to become toymakers because hey... toys!
  </p>
</div> 
```

CSS：

```
#box { width: 300px; height: 120px; background-color: teal}
#box p { line-height: 18px; } 
```

使用 jQuery 的 JavaScript：

```
var $p = $('#box p');

var boxHeight = $('#box').height();
var lineHeight = parseInt($p.css('line-height'));
var pHeight = $p.height();
var numLines = parseInt(pHeight/lineHeight);

var newHeight = boxHeight/numLines;
$p.css('line-height', newHeight + 'px'); 
```

# asp.net - 列表视图创建的无序列表在悬停时不显示

> ID：13767163
> 
> 赞同：0
> 
> 时间：2012-12-07T16:33:45.803
> 
> 标签：asp.net, css, listview, hover

我有一个完全由 css ul 和 li 控制的导航栏。

第一个无序列表包含始终显示的列表项（常规站点页面）。将鼠标悬停在列表项（Gamma）上时，会出现子列表项。这些子列表项本身就是具有模型名称的汽车模型的无序列表。将这些项目中的一个悬停在一个单独的 div 中会向我显示汽车的图片。

当我手动创建汽车列表时，一切正常。汽车模型及其图像正确显示。当我通过列表视图动态创建无序列表时。车名没有显示。

如果我将列表视图放在导航 ul 之外。列表视图工作正常。

我认为这与列表视图创建无序列表的那一刻有关。谁能指出我正确的方向？

我的 ASP.net 代码

```
<nav>
                    <ul class="menu">
                        <li><a class="active" href="Default.aspx">H</a></li>
                        <li><a href="AixamGamma.aspx">Gamma</a>
                             **<asp:ListView ID="lvGamma" runat="server">
                                <LayoutTemplate>
                                    <ul>
                                        <asp:PlaceHolder ID="itemPlaceholder" runat="server"></asp:PlaceHolder>
                                    </ul>
                                </LayoutTemplate>
                                <ItemTemplate>

                                    <li><a href='<%# "AixamGamma.aspx?Model=" + Eval("car.NewCarID").ToString %>' class="sublistitem"  >
                                        <asp:Label ID="lblModelName" runat="server" Text='<%# Eval("car.ModelName") %>'></asp:Label></a>
                                        <div class="modeldetail">
                                            <div class="redbox">
                                                <div class="whitebox">
                                                    <div class="container_12">
                                                        <div class="wrapper">
                                                            <div class="grid_5">
                                                                <h3>
                                                                    <asp:Label ID="lblModelSlogan" runat="server" Text='<%# Eval("car.Slogan") %>'></asp:Label>
                                                                </h3>
                                                            </div>
                                                            <div class="grid_3">
                                                                <div class="wrapper">
                                                                    <img src='<%# Eval("image.ImageLocationPath") + Eval("image.ImageFileName")%>' alt='<%# Eval("car.ModelName") %>'
                                                                        class="img-max-h200-w200" />
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ItemTemplate>
                            </asp:ListView>**
                            *<ul>
                                <li><a href="AixamGamma.aspx#City" class="sublistitem">City</a></li>
                                <li><a href="AixamGamma.aspx#CityS" class="sublistitem">CityS</a></li>
                                <li><a href="#" class="sublistitem">Crossline</a></li>
                                <li><a href="#" class="sublistitem">GTO</a>
                                    <div class="modeldetail">
                                        <div class="redbox">
                                            <div class="whitebox">
                                                <div class="container_12">
                                                    <div class="wrapper">
                                                        <div class="grid_5">
                                                            <h2>
                                                                De nieuwe Aixam Gto</h2>
                                                            <p>
                                                                Rijden zonder rijbewijs in een sportief kleedje</p>
                                                        </div>
                                                        <!--- image width max 220px --->
                                                        <div class="grid_3">
                                                            <div class="wrapper">
                                                                <img src="images/Sliders/Aixam%20GTO.jpg" alt="Gto" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li><a href="#" class="sublistitem">Crossover</a></li>
                            </ul>*
                        </li>
                        <li><a href="UnderConstruction.aspx">Tweedehands</a></li>
                        <li><a href="Onderhoud.aspx">Onderhoud/herstelling </a></li>
                        <li><a href="Wetgeving.aspx">Wetgeving</a></li>
                        <li><a href="Contact.aspx">Contact</a></li>
                    </ul>
                </nav> 
```

**粗体部分**不起作用，除非将其放置在导航列表中，斜体部分*起作用*

谢谢帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T10:12:56.823

我让它工作了。我已经用硬编码的无序列表和列表视图在一项中测试了代码。删除硬编码列表可以解决问题....

# php - 在 WordPress 中使用来自 .js 的 .PHP 文件

> ID：13767166
> 
> 赞同：1
> 
> 时间：2012-12-07T16:33:48.733
> 
> 标签：php, javascript, ajax, wordpress

我正在尝试从 Wordpress 中的 js 代码中读取 php 文件。

```
$.ajax({
  type: "POST",
  url: "/set.php" 
```

问题是在目录中找不到 php 文件，所以在 js 结束时我有错误警报。

我该怎么做才能找到 php 文件？有人有诀窍吗？

编辑：我刚刚按照您的建议解决了编写完整路径的问题，但我想编写一个“迷你路径”而不编写完整路径。有人建议？

EDIT2: 我已经解决了编写完整路径的问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:46:29.597

正如 cilosis 所说，只需使用：

```
$.ajax({
  type: "POST",
  url: "set.php" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T16:37:39.573

当您使用路径*“/set.php”*时，它会在根目录中查找该文件。如果它是您的 JS 文件的一个目录，那么您可能想要做的是*“../set.php”*。如果您可以更好地描述您的文件夹结构，我们可以为您提供更多帮助。

**[编辑]**

当 PHP 文件与 JS 文件位于同一文件夹时，您可以像这样进行 AJAX 调用：

```
$.ajax({
  type: "POST",
  url: "set.php" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T16:39:21.387

url: "/set.php" 表示该文件必须位于您网站的根目录中。如果它位于您的模板文件夹中，那么您必须从根写入完整路径而不是一个斜杠。

# c++ - 为什么这个 C++ 程序运行如此奇怪，程序在添加一个空函数时死掉了

> ID：13767170
> 
> 赞同：-4
> 
> 时间：2012-12-07T16:33:52.123
> 
> 标签：c++

我的代码如下，path1.updatePathInfo() 是一个调用空函数的函数，如果删除它就可以正常工作。我不明白。

```
////////////////////////////////////////////////////main.cpp

#include <iostream>
#include<vector>
#include "CPath.h"
using namespace std;
int main()
{
    for(int i = 0;i<10;++i)
    {
        cout<<i;
        CPath path1;
        CPath path2;
        cross(path1,path2);
        path1.updatePathInfo();  //this is an function which call an empty function
                                 //if I delete this it works fine.I could't understand.
        path2.updatePathInfo();

    }
} 
```

///////////////////////////////////////// ///////////CPath.h

```
#ifndef CPATH_H_
#define CPATH_H_
#include<iostream>
#include<vector>
#include<fstream>
#include<map>
#include<cmath>
#include<cstdlib>
class CPath
{
public:
    CPath();
    friend void cross(CPath & path1,CPath & path2);
    void updatePathInfo();
    std::vector< int > getPathByCode();
    void createRadomCode();
    std::vector< int > code;
    double pathLineLength;
};
#endif //CPATH_H_ 
```

///////////////////////////////////////// //////////////////CPath.cpp

```
#include"CPath.h"
CPath::CPath()
{
    createRadomCode();
}

void cross(CPath & path1,CPath & path2)
{
    int max,min;
    max = rand()%8;
    min = rand()%8;
    if(min > max)
    {
        max ^= min;min ^= max;max ^= min;
    }
    if(0.9*100>rand()%100)
    {
        for(int i = min;i<=max;++i)
        {
            path1.code[i]^=path2.code[i];
            path2.code[i]^=path1.code[i];
            path1.code[i]^=path2.code[i];
        }
    }
}

void CPath::updatePathInfo()
{
    getPathByCode();
}

std::vector< int > CPath::getPathByCode()
{
    //this function has nothing 
}

void CPath::createRadomCode()
{
    for(int i = 0 ; i<8 ; ++i)
    {
        code.push_back(rand()%(i+1));
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:40:43.463

`CPath::getPathByCode()`不返回值，结果是[未定义的行为](http://en.wikipedia.org/wiki/Undefined_behavior)。您的编译器不需要告诉您这一点，但如果您在启用所有警告的情况下进行编译，它几乎肯定会告诉您。

顺便说一句，如果你正确地格式化了你的代码，这种错误会更容易看到。

# titanium - 如何在 appcelerator 中侦听一组 imageViews 上的点击事件

> ID：13767188
> 
> 赞同：0
> 
> 时间：2012-12-07T16:35:18.673
> 
> 标签：titanium, appcelerator, titanium-mobile, appcelerator-mobile

我正在创建一些 imageViews，如下所示。

```
// Time buttons
    var timeButtons =[
        { title: 'Afternoon', path: 'images/others/time/afternoon.png'},
        { title: 'CurrentTime', path: 'images/others/time/currenttime.png'},
        { title: 'Evening', path: 'images/others/time/evening.png'}
    ]

createButtons(timeButtons);

/* Button creation function */
function createButtons(data){

    for (var i = 0; i < data.length; i++){
        //Creating each button
        var button  = Titanium.UI.createImageView({
            image:  data[i].path,
            height: 90,
            width: 90,
            top: 20+90*i+20*i,
            value: 1
        });

        //Adding the buttons to the center view
        centerButtons.add(button);
    }
} 
```

现在，当用户单击任何 imageView 时，我想确定它单击了哪个 imageView 并相应地做一些事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T12:36:14.803

您可以向您的 imageView 额外添加参数。喜欢id左右。这里您的示例带有一个附加参数：

```
for (var i = 0; i < data.length; i++){
    //Creating each button
    var button  = Titanium.UI.createImageView({
        _id: i,    // Your custom parameter
        image:  data[i].path,
        height: 90,
        width: 90,
        top: 20+90*i+20*i,
        value: 1
    });

    //Adding the buttons to the center view
    centerButtons.add(button);
} 
```

您可以使用新参数来识别您的 imageView：

```
centerButtons.addEventListener('click', function(event)
{
    // Perhaps you should check here if the custom parameter ( _id ) exist.

    switch(event.source._id){
        case 0:
            // Your stuff with you first image
            break;
        // etc.
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:28:13.163

```
centerButtons.addEventListener('click', function(evt) {
    alert(evt.source.image);
}); 
```

# fancybox - 使用 flexslider 显示多个 fancybox 画廊

> ID：13767189
> 
> 赞同：0
> 
> 时间：2012-12-07T16:35:23.927
> 
> 标签：fancybox, gallery, flexslider

我有一些缩略图格式的花式画廊，我想使用 flexslider 在它们之间切换。

我正在尝试完成这样的事情：[http ://www.herschelsupply.com/lookbook/](http://www.herschelsupply.com/lookbook/)

这可能吗？如果可以，我需要做什么？

我环顾四周，知道可以在同一页面上运行多个画廊，但我还没有看到对上述设置的任何评论。

谢谢你的帮助！

# javascript - 在选择框中单击已选择的选项

> ID：13767190
> 
> 赞同：0
> 
> 时间：2012-12-07T16:35:29.710
> 
> 标签：javascript, html, css, drop-down-menu, html-select

这看起来应该很容易，但`<select>`对象的局限性相当令人恼火。我有一个带有四个选项的选择框，当您导航到一个页面时，该选项设置为您所在的页面。我想让它让用户可以通过选择相同的选项来刷新页面 - 即选择已经选择的选项。

不幸的是，该`onclick`事件不适用于跨浏览器。大多数人建议使用`onchange`，但这在我所说的情况下不起作用。我一直采用的方法是在顶部添加一个额外的项目，该项目包含当前选择的内容，单击时不执行任何操作，然后在触发 onchange 事件后切换到该选项，以便用户重新选择该选项他们实际上正在改变。不过这很尴尬，因为下拉菜单中有两个相同的项目，我不应该这样做。

有什么好的跨浏览器方式来解决这个问题？一些不太复杂的东西和常规 JavaScript 中的东西会更好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:08:06.523

这可能会有所帮助：

```
function onFocus(element){
    element.setAttribute('old-value',element.value);
    element.value='';
    console.log('reset');
}

function onBlur(element){
    if(element.value=='')
        element.value = element.getAttribute('old-value');
    element.removeAttribute('old-value');   
}

function onChange(element){
    console.log('New Value : '+ element.value);
}
```

```
<select id="mySelect"  onfocus="onFocus(this)" onchange="onChange(this)" onblur="onBlur(this);">
    <option value="" style="display:none;"></option>
    <option value="one">one</option>
    <option value="two">two</option>
    <option value="three">three</option>
</select>
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-07T20:26:38.930

给你解决方案

```
$("select[id=mySelect] option").click(function(){
    alert("HI");
}); 
```

这将在每次单击选项时提醒 -HI-。在选择框中也进行了更改，并且还执行了事件。

# php - 在 Windows 上运行的 PHP5 中获取 $_SERVER["REQUEST_URI"]

> ID：13767194
> 
> 赞同：2
> 
> 时间：2012-12-07T16:35:43.167
> 
> 标签：php, windows

它似乎并不那么简单。我使用这个流行的功能来获取页面完整的 URL：

```
private function getBaseUrl() {
    $pageURL = 'http';
    if ($_SERVER["HTTPS"] == "on") {$pageURL .= "s";}
        $pageURL .= "://";
    if ($_SERVER["SERVER_PORT"] != "80") {
        $pageURL .= $_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER["REQUEST_URI"];
    } else {
        $pageURL .= $_SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];
    }
    return $pageURL;
} 
```

我的 PHP5 在 Windows 服务器上！这就是**$_SERVER["REQUEST_URI"]**为空的原因。我在 Windows 上使用了这个解决方法：

```
function fixRequestURI() {
    if(!isset($_SERVER['REQUEST_URI'])) {
        $_SERVER['REQUEST_URI'] = $_SERVER['SCRIPT_NAME'];
        if($_SERVER['QUERY_STRING']) {
            $_SERVER['REQUEST_URI'] .= '?' . $_SERVER['QUERY_STRING'];
        }
    }
} 
```

但是，它有点工作。我的完整网址是：

```
http://www.domain.com/web/en/contact/ 
```

奇怪的是，由于我的上述功能，我得到了这个：

```
http://www.domain.com/directory1/web/en/contact/index.php?go=3 
```

这个所谓的“directory1”是我的 domain.com 映射到的物理目录。我理解其中的含义，但是......我如何在没有任何修复、调整等的情况下轻松获得完整的 URL，就像在 JavaScript 中使用**document.location.href**一样？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:48:15.420

试试这个：

```
<?
function getUrl(){
    $http = 'http' . (@$_SERVER['HTTPS'] ? 's' : '');
    $query = $_SERVER['QUERY_STRING'] ? "?$_SERVER[QUERY_STRING]" : '';
    return "$http://$_SERVER[HTTP_HOST]$_SERVER[PHP_SELF]$query";
} 
```

它不会抓住锚点（在哈希`#`标签之后）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:51:38.773

回答我的问题：这对我有用：

```
function getFullUrl() {     
    $pageURL = 'http';
    if ($_SERVER["HTTPS"] == "on") {$pageURL .= "s";}
        $pageURL .= "://";          
    if ($_SERVER["SERVER_PORT"] != "80") {
        $pageURL .= $_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER['HTTP_X_REWRITE_URL'];
    } else {
        $pageURL .= $_SERVER["SERVER_NAME"].$_SERVER['HTTP_X_REWRITE_URL'];//$_SERVER["REQUEST_URI"] blank
    }
    return $pageURL;
} 
```

如果它在任何特殊情况下会失败，请给我任何想法。

# android - BitmapFactory.decodeFile(String imagePath) 即使图像存在也返回 null

> ID：13767199
> 
> 赞同：1
> 
> 时间：2012-12-07T16:35:58.547
> 
> 标签：android, image, bitmapfactory

我不知道，为什么我从 BitmapFactory.decodeFile(String imagePath) 方法中得到空值。imagePath 是完美的。代码在下面。

```
public static byte[] imageToByteArray(String imagePath){
        Bitmap bitmap = BitmapFactory.decodeFile(imagePath);
        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();

        bitmap.compress(Bitmap.CompressFormat.JPEG , 100 , byteArrayOutputStream);
        return byteArrayOutputStream.toByteArray();
    } 
```

imagePath 是互联网特定路径。这里我使用的是 google place api，imagePath 是 google 网络服务给出的图像位置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T16:40:09.053

[decodeFile](http://developer.android.com/reference/android/graphics/BitmapFactory.html#decodeFile%28java.lang.String%29)用于`Bitmap`从本地文件系统获取。

```
Decode a file path into a bitmap. If the specified file name is null, or cannot be decoded into a bitmap, the function returns null. 
```

`Bitmap`从互联网使用中获取

```
Bitmap bitmap = BitmapFactory.decodeStream(imageUrl.openConnection().getInputStream()); 
```

不要忘记在后台线程中运行以上行。

# jquery - Jqplot - 如何有垂直线并使 xaxis 在绘图值中上升？

> ID：13767200
> 
> 赞同：1
> 
> 时间：2012-12-07T16:36:01.620
> 
> 标签：jquery, jqplot

我已经使用 jqplot 绘制了一个折线图。

我想要的是垂直线，从 3 开始，沿着底部的绘制值上升。所以 3, 6, 9, 12 , 15, 29, 36 也是左侧的虚线标记。

这就是我目前所拥有的：

```
$(document).ready(function(){
    $.jqplot('chart2', [[[3, @(Model.LearnerWeek[0])], [6, @(Model.LearnerWeek[1])], [9, @(Model.LearnerWeek[2])],
                       [12, @(Model.LearnerWeek[3])], [15, @(Model.LearnerWeek[4])], [29, @(Model.LearnerWeek[5])], [36, @(Model.LearnerWeek[6])]],
                       [[3, @(Model.ManagerWeek[0])], [6, @(Model.ManagerWeek[1])], [9, @(Model.ManagerWeek[2])],
                       [12, @(Model.ManagerWeek[3])], [15, @(Model.ManagerWeek[4])], [29, @(Model.ManagerWeek[5])], [36, @(Model.ManagerWeek[6])]]],
        {
            axes: {
                yaxis: { tickOptions: { show: false}, min: 0, max: 100, label: 'Participation Rate', labelRenderer: $.jqplot.CanvasAxisLabelRenderer },
                xaxis: { min: 3, max: 36, label: 'Week', tickOptions: { formatString: '%d' } }
            },
            seriesDefaults: {
                showMarker: false ,
                rendererOptions: {
                    diameter: undefined, // diameter of pie, auto computed by default.
                    padding: 10,        // padding between pie and neighboring legend or plot margin.
                    fill: true,         // render solid (filled) slices.
                    shadowOffset: 2,    // offset of the shadow from the chart.
                    shadowDepth: 15,     // Number of strokes to make when drawing shadow.  Each stroke
                    // offset by shadowOffset from the last.
                    shadowAlpha: 1   // Opacity of the shadow
                }
            },
            seriesColors: ['#3591cf', '#ef4058', '#73C774', '#C7754C', '#17BDB8']
    });
}); 
```

我玩过渲染选项和 xasis 但似乎无法解决

编辑：

例子：

[http://jsfiddle.net/uzi002/y4YKY/](http://jsfiddle.net/uzi002/y4YKY/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T10:31:08.347

这是您使用以下方法对轴刻度值进行的一个[叉子：](http://jsfiddle.net/Regisc/3sLKH/3/)

```
axes: {
    yaxis: { numberTicks: 5, /* ...*/ }, 
    xaxis: { renderer:$.jqplot.CategoryAxisRenderer, rendererOptions:{sortMergedLabels:true}, /* ... */}
}, 
```

文档的相关部分可以在[这里找到](http://www.jqplot.com/docs/files/jqPlotOptions-txt.html)

# paypal - paypal的取款功能

> ID：13767204
> 
> 赞同：5
> 
> 时间：2012-12-07T16:36:30.013
> 
> 标签：paypal

基本上我有一个脚本，用户应该在他的帐户上有提款按钮，这样他就可以自动从我的贝宝余额中提款

在这种情况下我应该使用什么 API，这对于 paypal 是否可用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T16:42:07.317

您可能对 Mass Pay API 感兴趣。您可以分批发送它们，例如每天、每周或每月。

请参阅此处直接从贝宝获得说明： [https ://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/howto_api_masspay](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/howto_api_masspay)

> MassPay API 允许您通过一次 API 调用向多达 250 个收件人发送付款。每个收件人的付款金额是单独指定的，但 MassPay API 请求中的所有付款必须具有相同的货币类型。您可以选择通过电子邮件地址或 PayPal 客户帐号指定收件人。

这里是 PHP 示例（如果您使用的是 PHP）： [https ://www.x.com/paypal-apis-masspay-php-5.3/soap](https://www.x.com/paypal-apis-masspay-php-5.3/soap)

无论使用何种编程语言，第一个 PayPal.com 链接上都有其他示例和大量文档。

请记住，Mass Pay 有自己的收费表。

还有自适应支付，这可能更适合您，因为它旨在实现更细粒度的控制并具有更大的 API 可用。可以在这里获取信息：

[https://www.x.com/content/introducing-adaptive-payments](https://www.x.com/content/introducing-adaptive-payments)

**但是，自适应付款需要您（发件人）通过 PayPal 网站批准每笔付款。如果您想要 100% 自动化，Mass Pay API 是您的最佳选择。**

请意识到这里的一个错误可能会花费你无数的钱，所以要**非常小心。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T06:27:32.813

如果您试图从您的 PayPal 帐户中提取资金并将其转移到您的银行帐户，那么您无法通过 API 执行此操作，很遗憾。您必须通过 PayPal 手动执行此操作，或者您可以致电他们并要求他们为您启用 AutoSweep，这将在每天结束时自动将 PayPal 中的余额转移到您的银行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-10T10:38:50.233

是的，AdaptivePayment 中有预先批准的 api。您可以批准 api 调用者代表您从您的帐户中提取的金额。

您可以在此处参考 api：[https ://www.x.com/developers/paypal/documentation-tools/api/preapproval-api-operation](https://www.x.com/developers/paypal/documentation-tools/api/preapproval-api-operation)

# java - 继承和instanceof

> ID：13767207
> 
> 赞同：0
> 
> 时间：2012-12-07T16:36:46.797
> 
> 标签：java, oop, inheritance

> **可能重复：**
> [Java 方法重载 + 双分派](https://stackoverflow.com/questions/2794195/java-method-overloading-double-dispatch)

可能是一个愚蠢的新手问题：。我想在这样的情况下避免使用 instanceof 运算符：

```
class Service {
  method(Some param) {  }
}

class Special extends Some { }

class SpecialService extends Service {
  method(Some param) {
    if (param instanceof Special) {
      //do special things 
    }
  }

  method(Special param) {
    //do special things 
  }

} 
```

第二种特殊方法是避免 instanceof 的正确方法吗？

服务的调用方会不会有问题？在我的情况下，特殊服务是一个定制版本，插入并从基本代码调用。将调用哪个方法？

```
Service s = new SpecialService();
s.method(specialparam); 
```

请指出我如何解决这个问题的紧凑描述或模式。似乎是基本的Java/OO知识...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T18:25:09.523

I'm not sure **durron597** is right. It all depends on how your code is written. It would workautomatically only if both variables are **declared** using specific types:

```
//good
Special specialparam = new Special();
SpecialService s = new SpecialService();
s.method(specialparam); 
```

Code like

```
//bad
Some specialparam = new Special();
SpecialService s = new SpecialService();
s.method(specialparam); 
```

or like

```
//bad
Special specialparam = new Special();
Service s = new SpecialService();
s.method(specialparam); 
```

wouldn't work as you expect because known compile-time types are used to select method.

The whole design looks suspicously. This might be the right way but probably it is worths reconsidering it.

One of things that might hepl is [Double dispatch](http://en.wikipedia.org/wiki/Double_dispatch) mentioned by **dasblinkenlight**'s comment. But to do one of base classes (`Some` or `Service`) should know about special cases. In short idea is that you write something like this:

```
class Some {
  public void dispatch(Service service)  {
    service.method(this);
  }
}

class Special extends Some { 
  public void dispatch(Service service)  {
    service.method(this);
  }
}

class Service {
  void dispatch(Some some) {
      some.dispatch(this);
  }

  void method(Some some) {
     // do common things here  
  }

  void method(Special some) {
     method((Some)some);
  }
}

class SpecialService extends Service {

  method(Special param) {
    //do special things 
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T16:38:39.123

Java 会自动执行此操作。您的代码将完全按照您的意愿工作，无需 if 语句。在选择要执行的方法版本时，Java 会选择最具体（最子类化）的方法签名。

[这是一篇关于这个主题的非常好的文章。](http://geekexplains.blogspot.com/2009/06/choosing-most-specific-method-tricky.html)

# c++ - 在 CMake for Visual Studio 2010 中定义宏“禁止复制和分配”

> ID：13767208
> 
> 赞同：2
> 
> 时间：2012-12-07T16:36:46.750
> 
> 标签：c++, visual-studio-2010, macros, cmake

到目前为止，现有的 C++ 多项目在 QT 中使用 CMake 2.8。我们想继续在 Visual Studio 2010 中维护它。我在 CMake 中使用选项生成了 Visual Studio 项目，`-G "Visual Studio 10"`但现在我无法编译它们，原因如下：

在项目中，我们使用了一个众所周知的宏，例如在[这个问题](https://stackoverflow.com/questions/1454407/macros-to-disallow-class-copy-and-assignment-google-vs-qt)中讨论了它。

```
#define DISALLOW_COPY_AND_ASSIGN(TypeName) \
  TypeName(const TypeName&);   \
  void operator=(const TypeName&) 
```

该宏在 CMake 中定义，以便将其作为预处理器定义提供给编译器 (cl.exe)：

```
add_definitions(-DDISALLOW_COPY_AND_ASSIGN\(TypeName\)=\" TypeName(const TypeName&)\; void operator=(const TypeName&)\; \") 
```

Visual Studio 不接受 CMake 的输出，并在代码中使用宏的任何位置引发编译错误。什么是正确的语法，以便 CMake 可以为 Visual Studio 2010 正确生成它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:43:13.837

我建议您一般不要使用宏，尤其是在这种情况下。如果可以使用 boost，则可以私下继承自`boost::noncopyable`. 如果你不这样做，你可以定义你自己的：

```
class noncopyable {
   noncopyable(noncopyable const &);
   void operator=(noncopyable const&);
protected:
   noncopyable();
};

class Use : noncopyable
{
... 
```

如果您坚持使用宏，请阅读编译器文档作为将预处理代码转储到文件中所需的标志，并查看宏扩展为什么。从那里您可以尝试找出问题所在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T16:45:19.627

无法在 cl 的命令行上定义函数样式的宏。您可以通过在头文件中包含宏定义并使用 cl 的命令行选项 /FI 传递此头文件来解决此问题。或者只是在必要时手动包含它（这可能更干净）。

# php - PHP多维数组到html表

> ID：13767211
> 
> 赞同：1
> 
> 时间：2012-12-07T16:36:50.450
> 
> 标签：php, html

我有一个多维数组，我试图将其作为表格输出，这是我的数组；

```
$marksarray=     
array(3) {
      [0]=>
      array(2) {
        [0]=>
        string(1) "8"
        [1]=>
        string(1) "0"
      }
      [1]=>
      array(2) {
        [0]=>
        string(1) "9"
        [1]=>
        string(1) "1"
      }
      [2]=>
      array(2) {
        [0]=>
        string(2) "13"
        [1]=>
        string(1) "2"
      }
    } 
```

到目前为止，我的代码是这样的；

```
echo "<table><tr><td>Question</td><td>Rating</td></tr>";
     foreach ($marksarray as $mks){
         foreach ($mks as $qid=>$rate){
            echo "<tr><td>".$qid."</td><td>".$rate."</td></tr>";
          }
    }
echo "</table></div>"; 
```

但我的输出是； ![在此处输入图像描述](../Images/45525b271f310b79c0bd754a8aca274d.png)

我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T16:41:38.737

你有太多`foreach`的事情发生在那里。试试这个：

```
echo "<table><tr><td>Question</td><td>Rating</td></tr>";
     foreach ($marksarray as $mks){
        echo "<tr><td>".$mks[0]."</td><td>".$mks[1]."</td></tr>";
    }
echo "</table></div>"; 
```

**编辑**

为了将来参考，如果您使用具有有意义键的关联数组数组，它​​会使您的代码更容易理解。例如

```
$marksarray = array(
    array('qid' => 8, 'rating' => 0), 
    array('qid' => 9, 'rating' => 1), 
    array('qid' => 13, 'rating' => 2)
); 
```

然后您的循环将如下所示：

```
foreach ($marksarray as $mark){
    echo "<tr><td>".$mark['qid']."</td><td>".$mark['rating']."</td></tr>";
} 
```

更好的是，您应该使用 MVC（模型、视图、控制器）并将这些数据传递到视图中……但这完全是另一个主题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T16:43:28.800

当`echo`您使用数组时，您输出的`key`是实际值而不是实际值。因此，为什么您在第一列中得到“0”和“1”。

如果您坚持使用当前拥有的数组布局，则需要以下代码：

```
echo "<table><tr><td>Question</td><td>Rating</td></tr>";
     foreach ($marksarray as $mks){
        echo "<tr><td>".$mks[0]."</td><td>".$mks[1]."</td></tr>";
     }
echo "</table></div>"; 
```

...这样您就可以使用键值来提取要显示的匹配值。

如果你不拘泥于你现在拥有的数组结构，你必须像这样构造你的数组，以利用`key`and`pair`值：

```
$marksarray = array(
    "8" => 0,
    "9" => 1,
    "13" => 2,
); 
```

并使用代码：

```
echo "<table><tr><td>Question</td><td>Rating</td></tr>";
     foreach ($marksarray as $qid => $rate){

        echo "<tr><td>".$qid."</td><td>".$rate."</td></tr>";

     }
echo "</table></div>"; 
```

...通过这种方式，您可以在代码中明确引用您的`key`和`pair`价值观。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T16:42:36.093

将回声线更改为

```
 echo "<tr><td>".$rate[0]."</td><td>".$rate[1]."</td></tr>"; 
```

它在工作吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T16:43:23.017

这是正确输出，并且您的循环看起来不错。我认为你的意思是在你的数组中做的是：

```
$marksarray = array(
    "8" => "0",
    "9" => "1",
    "13" => "2"
); 
```

然后将循环更改为：

```
echo "<table><tr><td>Question</td><td>Rating</td></tr>";
         foreach ($marksarray as $qid=>$rate){
            echo "<tr><td>".$qid."</td><td>".$rate."</td></tr>";
          }
echo "</table></div>"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-27T23:15:40.323

我知道这有点老了，但我相信这段代码会完全按照你想要的方式处理现有数组。

```
echo "<table><tr><td>Question</td><td>Rating</td></tr>";
 foreach ($marksarray as $mks){
     echo "<tr>";
     foreach ($mks as $qid=>$rate){
        echo "<td>".$rate."</td>";
      }
      echo "</tr>";
} 
```

`echo "</table></div>";`

有什么理由不这样做吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-26T23:22:26.477

尝试使用此代码

```
function printmarraytable($data){
                            echo "<table>";
                            foreach($data as $key=>$value){
                                echo "<tr><td>".$key."</td>";
                                if(is_array($value) || is_object($value)){
                                    echo "<td>".printmarraytable($value)."     </td>";
                                }else{
                                    echo "<td>".$value."</td></tr>";
                                }
                            }
                            echo "</table>";
                          }
                          printmarraytable($req); 
```

# vim - 卸载了 MacVim，现在不能使用普通的 Vim？

> ID：13767212
> 
> 赞同：0
> 
> 时间：2012-12-07T16:36:53.310
> 
> 标签：vim, terminal, alias

我有一台新机器在工作。以前的开发人员安装了 macvim。在终端中输入“vim”时，macvim 程序将打开。我卸载了 macvim，因为我不使用它。现在，当我在终端中键入“vim”时，它会说：“抱歉，找不到 MacVim.app。” 我只想在终端中运行 vim 。这是别名还是什么？我怎样才能快速修复！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:39:29.347

您可以在终端中输入：

```
which vim
alias 
```

查看有关已定义别名的信息以及尝试运行 vim 时会发生什么

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:27:04.090

以前的用户在`mvim`某处或其他地方安装了 MacVim 附带的脚本，`$PATH`并且可能对其进行了符号链接或创建了别名。

要摆脱这种行为，请尝试以下操作：

*   查看您的`~/.bashrc`或其他是否有指向的别名`mvim`
*   在你的任何地方寻找`$PATH`脚本`mvim`，也许

    ```
    $ which mvim 
    ```

    会做

*   确保`/usr/bin/vim`是一个真正的 Vim 可执行文件，而不是这个命令的符号链接

    ```
    $ file /usr/bin/vim 
    ```

如果它是符号链接的，那么你有麻烦，如果它只是一个别名，只需将其删除。如果您不想乱七八糟，可以`/usr/bin/vim`在您的`~/.profile`或其他任何内容中添加别名。

无论你做什么，我都建议你重新安装 MacVim，因为它几乎在所有方面都比默认的 Vim 好得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T16:39:35.273

这里还有一个文件： /usr/bin/vim 吗？

如果它被删除，那么你需要重新安装vim。

我建议使用[http://mxcl.github.com/homebrew/](http://mxcl.github.com/homebrew/)作为你的包管理器

# asp.net-mvc-4 - 上传问题 ASP.NET 4.5

> ID：13767213
> 
> 赞同：0
> 
> 时间：2012-12-07T16:37:00.887
> 
> 标签：asp.net-mvc-4, asp.net-4.5, iis-8

我正在搜索整个互联网，但找不到一种解决要求的方法。

控制器

```
[HttpPost]
    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Create(Albums albums) 
```

看法

```
@using (Html.BeginForm("Create", "album", FormMethod.Post, new { enctype = "multipart/form-data" }))

            <div>Please select some files</div>
        <input name="data" type="file"/>

<system.web>

<httpRuntime maxRequestLength="1536000" />

<system.webServer>
<security>
  <requestFiltering>
    <requestLimits maxAllowedContentLength="1536000" />
  </requestFiltering>
</security> 
```

如果我清除此字段，问题是

```
HttpException (0x80004005): Maximum request length exceeded. 
```

如果清除 web.config 上的所有修改并发送 14k 文件，一切正常。

如果我只使用

```
<requestLimits maxAllowedContentLength="1536000" /> 
```

在（0%）处无限上传且控制器未激活。

# c# - 向后注销

> ID：13767219
> 
> 赞同：0
> 
> 时间：2012-12-07T16:37:31.323
> 
> 标签：c#, asp.net

如果用户从按钮后面访问页面，我希望页面自动退出。

下面是我的代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    Label1.Visible = false;  
    try
    {
        if (!IsPostBack)
        {
            TxtLogin.Focus();
            Session["url"] = null;

            Response.Cache.SetNoStore();
            Response.Expires = -1;
            Session.Abandon();

            if (Page.User.Identity.IsAuthenticated)
            {
                FormsAuthentication.SignOut();
                Response.Redirect("~\\LoginPage.aspx", false);
            }
        }
    }
    catch (Exception ex) { throw new Exception(ex.Message); }
} 
```

它在 IE 中工作但在 firefox 中不工作如何为 firefox 做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:42:15.553

你将无法做到。Firefox，当您按下后退按钮时，不会像 IE 那样重新查询服务器，它只是“记住”页面的整个状态并恢复到那个状态。请注意，如果用户尝试跟踪任何新链接，或执行任何尝试再次访问服务器的操作，则由于用户已注销，它将无法正常工作。

# java - Java 字符串到 Int

> ID：13767225
> 
> 赞同：3
> 
> 时间：2012-12-07T16:37:52.130
> 
> 标签：java, arrays, string, int

我有一个包含大约 150 个数字的字符串，例如 String num = "64513246563........";

我正在尝试添加此字符串的每个数字。所以我的想法是将它分成一个整数数组并从那里添加它们。我首先将其拆分为 String 数组，然后尝试将其转换为 Int 数组。我收到一个未知来源错误。下面是代码：

```
String[] strArray = num.split("");
int[] intArray = new int[strArray.length];
        for(int i = 0; i < strArray.length; i++) {
           intArray[i] = Integer.parseInt(strArray[i]);
           } 
```

这是错误：

```
Exception in thread "main" java.lang.NumberFormatException: For input string: ""
    at java.lang.NumberFormatException.forInputString(Unknown Source)
    at java.lang.Integer.parseInt(Unknown Source)
    at java.lang.Integer.parseInt(Unknown Source) 
```

谁能看到我做错了什么，或者有更有效的方法吗？

////////////////////////////

感谢大家的帮助，似乎使用 .split("") 拆分字符串会在索引 0 处创建一个空字符串。这是我的主要问题，但有很多有用的指示如何更有效地解决问题 :) 谢谢你们都为您的意见

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T16:43:09.593

给出的第一个字符串`num.split("");`是空的。

一个解决方案是简单地从索引 1 开始迭代。

但是你做的事情太贵了

```
 String num = "64513246563";
    for(int i = 0; i < num.length(); i++) {
         int digit = num.charAt(i)-'0';
         ... // use the digit, perhaps adding it
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-07T16:40:05.083

```
int sum = 0;
for (int i = 0; i < string.length(); i++) {
    sum += Character.getNumericValue(string.charAt(i));
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T16:39:54.353

```
java.lang.NumberFormatException: For input string: "" 
```

异常消息清楚地告诉输入是空字符串。

一种处理方法是，`String`在解析之前进行空检查。

```
 for(int i = 0; i < strArray.length(); i++) {
           if(strArray[i] != null && !"".equals(strArray[i])
              {
               int q = Integer.parseInt(strArray[i]);
              }
           } 
```

注意：如果输入不是有效的 int，这仍然会失败，但在空字符串（或）null 的情况下不会。

处理此问题的另一种方法是 get`chartAt(i)`而不是使用`split("")`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-07T16:42:48.550

```
String num="12234";
        String[] numarr = num.split("");
        System.out.println(numarr.length); 
```

当您拆分字符串时，第零个索引处`""`将有一个**空字符串**。因此，您的结果数组将是：

```
{"", "1", "2", "2", "3", "4"} 
```

测试一下，上面返回的长度为6。因此`Integer.parseInt("")`导致**NumberFormatException**。

测试：

```
String num="12234";
        String[] numarr = num.split("");
        for(String s: numarr){
            if(s.equals("")){
                System.out.println("empty string");
            }
            else {
                System.out.println(s);
            } 
```

输出：

```
empty string
1
2
2
3
4 
```

因此，索引 0 处有一个空字符串。

因此，您必须在解析之前检查字符串是否为空字符串：

```
String[] strArray = num.split("");
int[] intArray = new int[strArray.length];
        for(int i = 0; i < strArray.length; i++) {
           if(!strArray[i].equals(""))
           intArray[i] = Integer.parseInt(strArray[i]);
           } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-07T16:43:11.327

```
char[] charArray = num.toCharArray();

for(char c : charArray) {
    int q = Integer.parseInt("" + c);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-07T16:42:35.803

```
for(int i=0; i<yourString.length; i++) {
    yourIntegers[i] = Integer.parseInt(yourString.charAt(i).ToString());
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-07T16:43:53.803

我只需沿着字符串走，解析每个数字：

```
int sum = 0;
for (int i = 0; i < num.length(); ++i) {
    sum += Integer.parseInt(num.substring(i, i + 1));
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-07T16:47:21.683

由于数组从空字符串开始，因此您必须跳过第一个元素，因此`i`从`1`for 循环中开始。

```
for(int i = 1; i < strArray.length; i++) 
```

# javascript - 使用 Underscore.js 检查未定义的变量

> ID：13767236
> 
> 赞同：2
> 
> 时间：2012-12-07T16:38:45.587
> 
> 标签：javascript, undefined, underscore.js

我遇到了 Underscore.js 模板和 Internet Explorer 的问题。这是导致麻烦的模板的一部分：

```
<p>
  <% if ( typeof description !== 'undefined' ) { %>
    <%- description %>
  <% } else { %>
    No description
  <% } %>
</p> 
```

当变量`description`未定义时（这意味着我根本没有将它提供给模板，变量不存在），这在 Safari、Firefox、Chrome 中工作得很好。

但是，Internet Explorer 无法正常工作。而不是显示`No description`IE8和IE9显示`[object HTMLMetaElement]`，而IE7显示`[object]`。

检查 Safari、Firefox、Chrome 中的`typeof description`返回结果`undefined`，但显然 Internet Explorer`object`会返回。

我已经尝试过 Underscore.js 的`_.isUndefined(value)`功能，但是当变量不存在时，该功能不起作用。

~~有谁知道这个问题的解决方法？（请注意，我无法提供没有值的变量 - 它要么存在，要么不存在）~~

**更新**我在 Underscore.js Github 问题之一中找到了解决方法[https://github.com/documentcloud/underscore/issues/237#issuecomment-1781951](https://github.com/documentcloud/underscore/issues/237#issuecomment-1781951)

有人可以解释为什么 IE 的行为不同，以及为什么解决方法实际上有效吗？

**更新 2** @John-DavidDalton 在下面的评论中提供了另一个更好的解决方法（直接链接到它似乎不起作用）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T17:35:35.577

来自[精美手册](http://underscorejs.org/#template)：

> 默认情况下，**模板**`with`通过语句将数据中的值放在本地范围内。

`source`您可以使用已编译模板的属性查看发生了什么：

```
​var t = _.template('<%= v %>');
console.log(t.source);​​​​​​​​​​​​​​​​​​​ 
```

为您提供（为清晰起见进行了调整）：

```
function(obj) {
    var __t, __p = '';
    with(obj || {}) {
      __p += '' + ((__t = ( v )) == null ? '' : __t) + '';
    }
    return __p;
} 
```

这[`with`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/with)是您的问题的根源：

> JavaScript 通过搜索与包含该不合格名称的脚本或函数的执行上下文相关联的作用域链来查找不合格名称。'with' 语句在评估其语句体期间将给定对象添加到此范围链的头部。如果正文中使用的非限定名称与作用域链中的属性匹配，则该名称将绑定到该属性和包含该属性的对象。否则会抛出“ReferenceError”。

所以鉴于此：

```
with(obj) {
    console.log(pancakes)
} 
```

JavaScript 将首先查找`obj.pancakes`，如果 中没有`pancakes`属性`obj`，它将`pancakes`在全局范围内查找。显然 IE 有一个`window.description`代表页面`<meta>`标签之一的值。在模板中使用您自己的命名空间（如在解决方法中）有点否定所做的事情`with`并阻止您访问全局`window`属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:00:14.653

如果您`typeof something`和某事是`null`，`object`则返回。检查 null 后尝试检查`'undefined'`.

# gtk - Invisble GtkEventBox vs 光标变化

> ID：13767239
> 
> 赞同：0
> 
> 时间：2012-12-07T16:39:07.487
> 
> 标签：gtk, gtk2

在我的应用程序中，有时我需要在进程发生时禁用大多数按钮和事件框（当然“取消”按钮除外）。每个事件框都包含一个可以单击的标签。为了让用户了解这些标签是可点击的，我在文本下划线并在将鼠标悬停在这些标签上时更改了光标。

问题是当我禁用事件框（使其不敏感）时，您会看到一个相当丑陋的工件：

![在此处输入图像描述](../Images/3c3058eaebb73909d5bd3d040224d471.png)

所以，我搜索并找到了这个函数：[gtk_event_box_set_visible_window](http://developer.gnome.org/gtk3/unstable/GtkEventBox.html#gtk-event-box-set-visible-window)。注意：我正在使用（不幸的是，我不得不）Gtk 2.22，但他们只是从他们的网站上删除了文档。反正这个函数的文字是一样的。

根据这个函数，可以让事件框创建一个`GDK_INPUT_ONLY`窗口。如果我这样做了，那么禁用事件框就不会让它变得丑陋了。

但是，由于事件框现在没有可输出的窗口，所以

```
gdk_window_set_cursor(event_box->window, cursor); 
```

使*整个*窗口的光标更改，而不仅仅是事件框。

我可以在某种程度上看到没有可见窗口和光标切换窗口之间的矛盾，但**我的问题是，否则，我可以如何让光标切换到事件框，但在禁用事件框时看不到可见的工件？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T16:02:37.930

我尝试了不同的方法，例如将事件框的背景更改为透明等，但它们都非常复杂。

我找到的最简单的解决方案如下：

```
static GdkCursor *_normal_cursor = NULL;
static GdkCursor *_hand_cursor = NULL;

/* in main */
    _normal_cursor = gdk_window_get_cursor(widgets_to_remember->window->window);
    _hand_cursor = gdk_cursor_new(GDK_HAND2);

    /* create the event box */
    gtk_event_box_set_visible_window(GTK_EVENT_BOX(event_box), FALSE);
    gtk_widget_set_events(event_box, GDK_BUTTON_PRESS_MASK | GDK_ENTER_NOTIFY_MASK | GDK_LEAVE_NOTIFY_MASK);

    _fix_event_box(event_box, window);
/* rest of main */

static gboolean _set_hand(GtkWidget *w, GdkEventCrossing *e, gpointer data)
{
    gdk_window_set_cursor(w->window, _hand_cursor);
    return TRUE;
}

static gboolean _set_normal(GtkWidget *w, GdkEventCrossing *e, gpointer data)
{
    gdk_window_set_cursor(w->window, _normal_cursor);
    return TRUE;
}

static void _fix_event_box(GtkWidget *eb, GtkWidget *window)
{
    g_signal_connect_swapped(eb, "enter_notify_event", G_CALLBACK(_set_hand), window);
    g_signal_connect_swapped(eb, "leave_notify_event", G_CALLBACK(_set_normal), window);
} 
```

这基本上所做的是将事件框设置为不可见，然后设置其`enter-notify-event`和`leave-notify-event`信号处理程序以在鼠标进入或离开其窗口时更改窗口光标。

# ruby-on-rails - Ruby：如何制作公共静态方法？

> ID：13767240
> 
> 赞同：83
> 
> 时间：2012-12-07T16:39:11.510
> 
> 标签：ruby-on-rails, ruby

在 Java 中，我可能会这样做：

```
public static void doSomething(); 
```

然后我可以在不创建实例的情况下静态访问该方法：

```
className.doSomething(); 
```

我怎样才能在 Ruby 中做到这一点？这是我的课，据我了解`self.`，该方法是静态的：

```
class Ask

  def self.make_permalink(phrase)
    phrase.strip.downcase.gsub! /\ +/, '-'
  end

end 
```

但是当我尝试打电话时：

```
Ask.make_permalink("make a slug out of this line") 
```

我得到：

```
undefined method `make_permalink' for Ask:Class 
```

如果我没有声明该方法是私有的，为什么会这样？

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2012-12-07T16:51:35.030

您给出的示例运行良好

```
class Ask
  def self.make_permalink(phrase)
    phrase.strip.downcase.gsub! /\ +/, '-'
  end
end

Ask.make_permalink("make a slug out of this line") 
```

我在 1.8.7 和 1.9.3 中都试过了 你的原始脚本中有错字吗？

一切顺利

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2016-05-11T11:13:17.610

还有一种语法，它的好处是您可以添加更多静态方法

```
class TestClass

  # all methods in this block are static
  class << self
    def first_method
      # body omitted
    end

    def second_method_etc
      # body omitted
    end
  end

  # more typing because of the self. but much clear that the method is static
  def self.first_method
    # body omitted
  end

  def self.second_method_etc
    # body omitted
  end
end 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-07T16:47:24.993

这是我将您的代码复制/粘贴到 IRB 中的内容。似乎工作正常。

```
$ irb
1.8.7 :001 > class Ask
1.8.7 :002?>   
1.8.7 :003 >   def self.make_permalink(phrase)
1.8.7 :004?>     phrase.strip.downcase.gsub! /\ +/, '-'
1.8.7 :005?>   end
1.8.7 :006?>   
1.8.7 :007 > end
 => nil 
1.8.7 :008 > Ask.make_permalink("make a slug out of this line")
 => "make-a-slug-out-of-this-line" 
```

似乎工作。也可以在你的身上进行测试`irb`，看看你会得到什么结果。我在本例中使用的是 1.8.7，但我也在 Ruby 1.9.3 会话中尝试过它，并且效果相同。

您是否使用 MRI 作为您的 Ruby 实现（不是我认为在这种情况下应该有所作为）？

`irb`调用`Ask.public_methods`并确保您的方法名称在列表中。例如：

```
1.8.7 :008 > Ask.public_methods
 => [:make_permalink, :allocate, :new, :superclass, :freeze, :===, 
     ...etc, etc.] 
```

由于您还将此标记为`ruby-on-rails`问题，因此如果您想对应用程序中的实际模型进行故障排除，您当然可以使用 rails 控制台：（`bundle exec rails c`）并验证相关方法的公开性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T21:23:16.873

我正在使用 ruby​​ 1.9.3，该程序也在我的 irb 中运行顺利。

```
1.9.3-p286 :001 > class Ask
1.9.3-p286 :002?>     def self.make_permalink(phrase)
1.9.3-p286 :003?>         phrase.strip.downcase.gsub! /\ +/, '-'
1.9.3-p286 :004?>       end
1.9.3-p286 :005?>   end
 => nil 
1.9.3-p286 :006 > Ask.make_permalink("make a slug out of this line")
 => "make-a-slug-out-of-this-line" 
```

它也在我的测试脚本中工作。您给定的代码没有问题。没关系。

# r - 匹配R中两个向量的值

> ID：13767244
> 
> 赞同：3
> 
> 时间：2012-12-07T16:39:18.353
> 
> 标签：r

我有两个向量：

```
A <- c(1,3,5,6,4,3,2,3,3,3,3,3,4,6,7,7,5,4,4,3) # 7 unique values
B <- c("a","b","c","d","e","f","g")   # 7 different values 
```

我想将 B 的值与 A 匹配，以便 A 中的最小值从 B 中获取第一个值并继续到最大值。

上面的例子是：

```
A:        1 3 5 6 4 3 2 3 3 3 3 3 4 6 7 7 5 4 4 3
assigned: a c e f d c b c c c c c d f g g e d d c 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T16:41:41.017

试试这个：

```
A <- c(1,3,5,6,4,3,2,3,3,3,3,3,4,6,7,7,5,4,4,3)
B <- letters[1:7]

B[match(A, sort(unique(A)))]
#  [1] "a" "c" "e" "f" "d" "c" "b" "c" "c" "c" "c" "c" "d" "f" "g"
# [16] "g" "e" "d" "d" "c" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T19:15:40.453

处理@JoshO'Brien 解决的一般情况的另一个选项是

```
B[as.numeric(factor(A))]
# [1] "a" "c" "e" "f" "d" "c" "b" "c" "c" "c" "c" "c" "d"
# [14] "f" "g" "g" "e" "d" "d" "c"

A2<-ifelse(A > 4, A + 1, A)
# [1] 1 3 6 7 4 3 2 3 3 3 3 3 4 7 8 8 6 4 4 3
B[as.numeric(factor(A2))]
# [1] "a" "c" "e" "f" "d" "c" "b" "c" "c" "c" "c" "c" "d"
# [14] "f" "g" "g" "e" "d" "d" "c" 
```

但是，以下基准显示此方法比@JoshOBrien 的慢。

```
library(microbenchmark)
B <- make.unique(rep(letters, length.out=1000))
A <- sample(seq_along(B), replace=TRUE)
unique_sort_match <- function() B[match(A, sort(unique(A)))]
factor_as.numeric <- function() B[as.numeric(factor(A))]
bm<-microbenchmark(unique_sort_match(), factor_as.numeric(), times=1000L)
plot(bm) 
```

![在此处输入图像描述](../Images/8459f21cfbc8dcfe1adc3b8af339bb98.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T18:35:11.537

要详细说明@Josh 回答中的评论：

如果`A`确实代表了元素的排列`B` （即，其中 a `1`in`A`代表 的第一个元素`B`，a `4`in`A`代表 的第四个元素`B`，等等），那么正如@Matthew Plourde 指出的那样，您可能只想简单地`A`使用索引到`B`：

```
B[A] 
```

如果 A 不代表**B**的排列，那么您应该使用@Josh 建议的方法

# bash - 如何用最后一个斜杠分割路径？

> ID：13767252
> 
> 赞同：79
> 
> 时间：2012-12-07T16:40:04.587
> 
> 标签：bash, split

我有一个文件（比如称为`list.txt`），其中包含文件的相对路径，每行一个路径，即如下所示：

```
foo/bar/file1
foo/bar/baz/file2
goo/file3 
```

我需要编写一个 bash 脚本，一次处理一个路径，在最后一个斜杠处拆分它，然后启动另一个进程，将路径的两条作为参数提供给它。到目前为止，我只有循环部分：

```
for p in `cat list.txt`
do
   # split $p like "foo/bar/file1" into "foo/bar/" as part1 and "file1" as part2
   inner_process.sh $part1 $part2
done 
```

我该如何拆分？这在路径没有斜杠的退化情况下是否有效？

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2012-12-07T16:43:33.620

使用`basename`and `dirname`，这就是你所需要的。

```
part1=$(dirname "$p")
part2=$(basename "$p") 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-12-07T19:11:58.377

一种正确的 100% bash 方式，并且对于包含空格或有趣符号的文件名是安全的（前提`inner_process.sh`是正确处理它们，但这是另一回事）：

```
while read -r p; do
    [[ "$p" == */* ]] || p="./$p"
    inner_process.sh "${p%/*}" "${p##*/}"
done < list.txt 
```

并且它不会为每个文件分叉`dirname`和（在子shell中）。`basename`

该行`[[ "$p" == */* ]] || p="./$p"`位于此处以防万一`$p`不包含任何斜线，然后将`./`其放在前面。

有关和符号的更多信息，请参阅[Bash 参考手册中的](http://www.gnu.org/software/bash/manual/bashref.html)[*Shell 参数扩展*](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion)部分。`%``##`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-06-21T19:53:45.250

我从这个[来源](https://www.unix.com/shell-programming-and-scripting/34310-splitting-up-absolute-filepath.html)找到了一个很好的解决方案。

```
p=/foo/bar/file1
path=$( echo ${p%/*} )
file=$( echo ${p##*/} ) 
```

这也适用于路径中的空格！

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-08-13T06:04:16.870

这是一个查找和替换 xml 文件扩展名的示例。

```
for files in $(ls); do

    filelist=$(echo $files |cut -f 1 -d ".");
    mv $files $filelist.xml;
done 
```

# c# - 正则表达式与 cpu 挂钩

> ID：13767255
> 
> 赞同：0
> 
> 时间：2012-12-07T16:40:13.227
> 
> 标签：c#, .net, regex

我有 4 个正则表达式，它们运行良好，但在某些应用程序中，它们与 cpu 挂钩。我知道它们是最好看的正则表达式，但我不确定更好的方法。我可以做些什么来优化这些正则表达式吗？

```
public static Regex schemaOrg = new Regex(@"\s*itemtype\s*=\s*('|"")\s*http://schema.org/\s*", RegexOptions.Singleline | RegexOptions.IgnoreCase | RegexOptions.Compiled);
public static Regex dataVocabulary = new Regex(@"\s*itemtype\s*=\s*('|"")\s*http://data-vocabulary.org/\s*", RegexOptions.Singleline | RegexOptions.IgnoreCase | RegexOptions.Compiled); 
```

基本上在寻找：

```
itemtype="http://schema.org/" 
```

```
itemtype="http://data-vocabulary.org/" 
```

但是有任意数量的空格，因为这在 html 中仍然有效。

例如：

```
itemtype   ="http://schema.org/" 
```

```
itemtype=   "http://schema.org/" 
```

```
itemtype="   http://schema.org/   " 
```

都是有效的。

更新：仍然包裹 cpu 坏。

```
\s+itemtype\s*=\s*(?:'|"")\s*http://schema\.org/ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:51:50.193

到目前为止，我只能想到一些事情。

*   尾随`\s*`(in `schema.org/\s*`and `vocabulary.org/\s*`) 不是必需的，请将其删除。我假设这是因为您也没有检查尾随报价。
*   `. (dot)`在正则表达式中有特殊含义，像这样`\.`在`schema.org`and中转义它`data-vocabulary.org`。
*   第一个`\s*`没有意义，因为它也会将您的模式与`someitemtype`. 将其替换为`\s+`或尝试使用单词边界`\b`作为模式的开头。
*   如果您对此有疑虑，您还可以`('|"")`通过将其替换为`(?:'|"")`.

**编辑：**您也可以尝试延迟匹配，看看是否有帮助。我可以想象你的正则表达式会阻塞 CPU 的情况。试试下面的示例正则表达式：

```
\s+?itemtype\s*?=\s*?(?:'|"")\s*?http://schema\.org/ 
```

如果这没有帮助，请在此问题的上下文中发布代码和示例字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T16:46:04.457

一个可能的改进是：

在执行 regex.match 之前将所有“”替换为“”

那么你的正则表达式不需要所有这些 \s

# excel - 返回值并在 UDF 中分配单元格

> ID：13767257
> 
> 赞同：1
> 
> 时间：2012-12-07T16:40:28.523
> 
> 标签：excel, vba

我总是需要根据一个键（多个单元格值）比较两个工作表，然后从第二个工作表返回多个单元格值。为了实现它，我需要在使用多个 vlookup 函数返回值之前将单元格连接到两个文件中的一个单元格中。

然后我尝试构建一个UDF，它允许定义搜索键（来自第一个工作表）和搜索键（来自第二个工作表），如果记录匹配，则同时将值分配给不同的单元格。不幸的是，我发现它违反了 Excel UDF 规则，即您不能为返回 UDF 中的单元格设置值。

我不知道为什么 Excel 有这样的限制。它知道它可以在一个子过程中完成。但我真的很想使用 UDF，这样我就可以轻松地将传递参数返回给函数并同时从函数返回一个指标。

请如果您有任何好主意如何解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:39:09.910

UDF 只能将值返回到它所占据的单元格的原因是因为 Excel 的重新计算逻辑的工作方式：将值返回到不同的单元格会弄乱依赖关系树和计算链。

通过使 UDF 成为多单元格数组公式，您可以从 UDF 返回多个值。但是单元格必须是连续的。
见[http://fastexcel.wordpress.com/2011/06/20/writing-efiicient-vba-udfs-part5-udf-array-formulas-go-faster/](http://fastexcel.wordpress.com/2011/06/20/writing-efiicient-vba-udfs-part5-udf-array-formulas-go-faster/)

# shell - 如何使用 wxWidgets 正常启动进程

> ID：13767259
> 
> 赞同：0
> 
> 时间：2012-12-07T16:40:34.043
> 
> 标签：shell, process, wxwidgets

根据官方手册，我测试了这段代码：

```
wxProcess * proc = wxProcess::Open("C:\\windows\\notepad.exe"); 
```

但是这段代码不能正常工作，我在系统管理器中看到了正在工作的记事本进程，但是没有记事本窗口等。此外，如果我启动控制台应用程序 - 新控制台窗口和我的控制台窗口中都没有文本。

如何解决？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T11:46:46.777

如果既不需要 IO 重定向也不需要进程终止通知，启动进程的最简单方法是使用[wxExecute](http://docs.wxwidgets.org/trunk/group__group__funcmacro__procctrl.html#ga8116ca17aec4eea74b848f1544805960)和`wxEXEC_ASYNC`flag。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T22:50:10.973

提供的代码适用于任何其他应用程序，例如`calc`.

```
wxProcess * process = wxProcess::Open(wxT("calc"));
wxLogDebug(wxT("Process: %s"), process != NULL ? wxT("OK") : wxT("Error")); 
```

显示 OK 并出现计算窗口。

# makefile - Makefile：测试makefile以进行比较

> ID：13767266
> 
> 赞同：0
> 
> 时间：2012-12-07T16:40:46.053
> 
> 标签：makefile, grep

我需要制作一个生成文件，将我的书面命令 grep 输出与 .out 文件进行比较。grep 搜索的输入文本文件在tests/*.test 中。

Beta 的回答非常有帮助，但我不明白为什么这个 makefile

```
INPUT_DIR=tests

OUTPUT_DIR=outputs

FILES=$(wildcard ${INPUT_DIR}/*.test)

TEST_LIST = ${FILES:${INPUT_DIR}/%.test=%.diff}

.PHONY: all clean distclean

all: ${TEST_LIST}
    echo ${FILES}
    echo ${TEST_LIST}
${TEST_LIST}: ${INPUT_DIR}/%.test ${OUTPUT_DIR}/%.out
    ./grep apple $< >STDOUT
    diff STDOUT ${OUTPUT_DIR}/$*.out > $@
${INPUT_DIR}/%.test:
    echo $@
${OUTPUT_DIR}/%.out:
    echo $@
clean:
    rm -f ${FILES} 
```

使用`make makefile all -n`

```
make: Nothing to be done for `makefile'. 
echo tests/%.test 
echo outputs/%.out 
./grep apple tests/%.test >STDOUT diff STDOUT outputs/.out > 1.diff 
./grep apple tests/%.test >STDOUT diff STDOUT outputs/.out > 2.diff 
./grep apple tests/%.test >STDOUT diff STDOUT outputs/.out > 3.diff 
echo tests/1.test tests/2.test tests/3.test 
echo 1.diff 2.diff 3.diff 
```

并使用`make makefile all`

```
make: Nothing to be done for `makefile'. 
echo tests/%.test tests/%.test 
echo outputs/%.out outputs/%.out 
./grep apple tests/%.test >STDOUT 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T19:53:29.397

您的问题不清楚，但是由于您将该文件`STDOUT`用作中间文件，并且将其用于每次比较，并且仅用于其他目的，因此我建议您结合规则：

```
%.diff: ${INPUT_DIR}/%.test ${OUTPUT_DIR}/%.out
    ./grep apple $< >STDOUT  # Do you really have an executable called "grep"?
    diff STDOUT ${OUTPUT_DIR}/$*.out > $@ 
```

此外，您的`all`规则并没有达到您的预期。尝试这个：

```
all:
    @echo you must specify a target, e.g. outputs/foo.diff 
```

# asp.net-web-api - 配置 Sencha 的 Rest Proxy 不在 POST 上发送模型的 ID

> ID：13767270
> 
> 赞同：0
> 
> 时间：2012-12-07T16:40:51.587
> 
> 标签：asp.net-web-api, sencha-touch-2

我有一个简单的 Sencha Touch 2.1 模型类：

```
Ext.define('App.model.User', {
    extend: 'Ext.data.Model',
    config: {
        fields: [
            { name: 'id', type: 'number', defaultValue: 0 },
            { name: 'first', type: 'string' },
            { name: 'last', type: 'string' },
            { name: 'email', type: 'string' },
            { name: 'lastUpdated', type: 'auto' }
        ]
    },
    fullName: function () {
        var d = this.data,
            names = [d.first, d.last];
        return names.join(" ");
    }
}); 
```

这些模型的集合位于我已配置为使用 sencha 的 Rest Proxy 的商店中。当我向商店添加新模型并在商店中调用*Sync*方法时，新模型将发布到 ASP.NET WebAPI**用户**控制器，并执行以下操作：

```
 // POST api/Default1
    public HttpResponseMessage PostUser(User user)
    {
        // this is a new user -- get rid of the ID
        user.Id = 0;
        if (ModelState.IsValid)
        {
            db.Users.Add(user);
            db.SaveChanges();

            HttpResponseMessage response = Request.CreateResponse(HttpStatusCode.Created, user);
            response.Headers.Location = new Uri(Url.Link("DefaultApi", new { id = user.Id }));
            return response;
        }
        else
        {
            return Request.CreateResponse(HttpStatusCode.BadRequest);
        }
    } 
```

问题是字符串作为模型的 ID 被发送，因此它没有通过控制器上的*ModelState.IsValid*检查。这是实际发送的内容：

```
{"id":"ext-record-5","first":"c","last":"d","email":"e","lastUpdated":null} 
```

知道为什么将 id 字段设置为字符串吗？此外，任何想法我如何告诉**用户控制器中的***发布*操作不要验证 id 字段（因为它应该处理创建一个新项目，所以服务器为新项目创建 ID 是有意义的，而不是客户端）。

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:38:35.963

这个[链接](http://blog.palominolabs.com/2012/06/21/an-app-in-an-afternoon-sencha-touch-and-stackmob/)帮助我弄清楚了。更新后的模型应该是：

```
Ext.define('App.model.User', {
    extend: 'Ext.data.Model',
    config: {
        fields: [
            { name: 'id', type: 'auto', persist: false },
            { name: 'first', type: 'string' },
            { name: 'last', type: 'string' },
            { name: 'email', type: 'string' },
            { name: 'lastUpdated', type: 'auto' }
        ],
    },
    fullName: function () {
        var d = this.data,
            names = [d.first, d.last];
        return names.join(" ");
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:33:21.213

您需要在模型上设置 idProperty。id 字段也应设置为 auto 类型。请参阅此处的文档[。](http://docs.sencha.com/touch/2-1/#!/api/Ext.data.Model-cfg-idProperty)**

# php - “if”的 PHP 转义字符串

> ID：13767271
> 
> 赞同：-1
> 
> 时间：2012-12-07T16:40:55.583
> 
> 标签：php, string, variables, if-statement, escaping

我想以一种安全但通用的方式在 PHP 代码中使用字符串变量，例如下面的示例。我见过 htmlspecialchars() 但我认为这不是我能得到的最好的。并且 mysql 函数绝对不是解决方案（无论如何，不​​推荐使用 mysql_real_escape_string 之类的东西）。

你们认为以下情况的最佳解决方案是什么：

```
$password = $_POST['password'];
$password_check = $_POST['password_check'];

//make $password and $password_check safe

if($password != $password_check)
{
    $errors[] = 'The two passwords did not match';
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:50:01.360

我不确定是否需要在这里进行注射，因为除了比较两个发布的值之外，您什么也不做。此时是否对字符串进行了清理并不会在比较它们的等效性时产生很大的不同。

当然，如果您随后使用这些值来查询数据库，您将需要使用准备好的语句进行转义`mysqli_real_escape_string`和/或利用准备好的语句来对抗 SQL 注入。

您可能在此处考虑的另一个卫生问题是，不匹配的密码将被预先填充回表单以进行更正。在这种情况下，您需要对 XSS 攻击进行清理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T16:44:55.867

那么如果`mysql_()`即将被弃用怎么办**？**PHP 还有其他选项，例如`mysqli_()`和`PDO`

```
$password = mysqli_real_escape_string($connect, $_POST['password']);
$password_check = mysqli_real_escape_string($connect, $_POST['password_check']);

//make $password and $password_check safe

if($password != $password_check) {
    $errors[] = 'The two passwords did not match';
} 
```

[mysqli_() 参考](http://php.net/manual/en/book.mysqli.php)

# python - 编辑不同长度的txt文件中的行

> ID：13767273
> 
> 赞同：0
> 
> 时间：2012-12-07T16:41:06.897
> 
> 标签：python, io, python-3.x

所以我有多个格式如下的txt文档：

```
james  
M  
18  
72   
170  
teresa  
F  
19  
63  
115 
```

有些只有两个名字，有些有 50 个。基本上，我要做的是格式化信息，以便将其重新写入具有以下格式的新文本文件：

```
Name: james  
Gender: M  
Age: 18  
Height: 72  
Weight: 170  
Name: teresa  
Gender: F  
Age: 19  
Height: 63  
Weight: 115 
```

到目前为止，我有：

```
def tagInfo(fileName):
    with open(fileName) as infile, open("altered.txt","w") as outfile:
        for i,line in enumerate(infile):
            if i == 0:
                outfile.write("Name: "+line.strip()+"\n")
            if i == 1:
                outfile.write("Gender: "+line.strip()+"\n")
            if i == 2:
                outfile.write("Age: "+line.strip()+"\n")
            if i == 3:
                outfile.write("Height: "+line.strip()+"\n")
            if i == 4:
                outfile.write("Weight: "+line.strip()+"\n")
    outfile.close() 
```

这个程序所做的只是编辑前 5 行。我正在努力做到这一点，所以如果我给它一个 50 人的列表来更改，它会更改所有 50 人的信息，而不仅仅是前五行。使用我目前的解决方案，这是不可能的。我不知道从哪里开始，我觉得最好放弃一切并采取不同的方法。

各位有什么解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T16:45:39.220

如果您的文件具有固定的字段列表，则将字段定义为列表，并使用带模数的行号作为索引来获取字段名称：

```
fields = ('Name', 'Gender', 'Age', 'Height', 'Weight')

def tagInfo(fileName):
    with open(fileName) as infile, open("altered.txt","w") as outfile:
        for i, line in enumerate(infile):
            field = fields[i % len(fields)]
            outfile.write('{0}: {1}\n'.format(field, line)) 
```

如果超过 5 个，您可以根据需要添加字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T16:44:18.343

将您的检查更改为`i % 5 == 0`等。这样检查将在每第五行返回一次。

```
if i % 5 == 0:
    outfile.write("Name: "+line.strip()+"\n")
elif i % 5 == 1:
    outfile.write("Gender: "+line.strip()+"\n")
elif i % 5 == 2:
    outfile.write("Age: "+line.strip()+"\n")
elif i % 5 == 3:
    outfile.write("Height: "+line.strip()+"\n")
elif i % 5 == 4:
    outfile.write("Weight: "+line.strip()+"\n") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T16:44:38.873

# 解决方案

### 修改后的解决方案

只需使用 mod，简短而简单：

```
def tagInfo(fileName):
    with open(fileName) as infile, open("altered.txt","w") as outfile:
        for i,line in enumerate(infile):
            if i % 5 == 0:
                outfile.write("Name: "+line.strip()+"\n")
            elif i % 5 == 1:
                outfile.write("Gender: "+line.strip()+"\n")
            elif i % 5 == 2:
                outfile.write("Age: "+line.strip()+"\n")
            elif i % 5 == 3:
                outfile.write("Height: "+line.strip()+"\n")
            elif i % 5 == 4:
                outfile.write("Weight: "+line.strip()+"\n")
    outfile.close() 
```

### 重写的解决方案

这个解决方案会好得多，因为它可以消除代码中的很多欺骗，更不用说让它更干净了：

```
fields = ("Name", "Gender", "Age", "Height", "Weight") # can be edited as per req.s
l = len(fields)

def tagInfo(fileName):
    with open(fileName) as infile, open("altered.txt","w") as outfile:
        for (index, s) in enumerate(infile):
             field = fields[index % l]
             outfile.write("{}: {}\n".format(field, s.strip())
    outfile.close() 
```

# 模组功能

## 从[文档](http://docs.python.org/2/reference/expressions.html#binary-arithmetic-operations)：

> %（取模）运算符产生第一个参数除以第二个参数的余数。数字参数首先转换为通用类型。零右参数引发 ZeroDivisionError 异常。参数可以是浮点数，例如，3.14%0.7 等于 0.34（因为 3.14 等于 4*0.7 + 0.34。）模运算符总是产生与第二个操作数（或零）具有相同符号的结果。结果的绝对值严格小于第二个操作数的绝对值。

### TL;博士：

> [模函数](http://en.wikipedia.org/wiki/Modulo_operation)（也称为 mod 函数）基本上只是给出除第一个数字的余数。到第二个。所以`a % b = cmp(b, 0) * abs(a - (a // b))`（我认为）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T16:58:20.613

只是另一种解决问题的方法

```
fields = ('Name', 'Gender', 'Age', 'Height', 'Weight')
with open("infile.txt") as fin, open("altered.txt","w") as fout:
    while True:
        data =  ''.join(map(':'.join,zip(fields,fin)))
        if data:
            fout.write(data)
        else:
            break 
```

# sas - 如何将数值分配给 SAS 中的字母表

> ID：13767275
> 
> 赞同：1
> 
> 时间：2012-12-07T16:41:19.207
> 
> 标签：sas

我正在尝试将字符串转换为数字变量，然后将每个字符的值求和以用作该字段的唯一标识符。例如，我想要 A=1、B=2、C=3.....X=24 Y=25 Z=26。假设我的字符串是“CAB”，所以在运行代码之后，我希望结果是一个中间数字列，其中 CAB 的值为 3 1 2，结果列将通过对字符串 3+1+2 求和得出= 6 并显示中间列的值，因此最终值为 6。

这是我用来将字符转换为数字的 sas 代码，但我需要有关结果列的帮助。

```
DATA CHAR_VALUE;
SET WORK.XYZ;
CHAR_2_NUM=TRANSLATE(MY_VAR_CHAR, '1 2 3 ...24 25 26', 'A B C ...X Y Z');
NUM_CHAR=INPUT(CHAR_2_NUM,32.);
RUN; 
```

在此先感谢...感谢任何帮助或建议。-雷切尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:56:52.460

RANK 将给出一个字符的 ASCII 数值；所以 A=65，B=66，Z=90，a=97，z=122。

所以这应该有效（如果你只想要大写的值 - 不是 a 的不同值而不是 A）：

```
data test;
charval='CAB';
do _t=1 to length(Charval);
    numval=sum(numval,rank(char(upcase(charval),_t))-64);
end;
put _all_;
run; 
```

另一种选择（基于下面的评论）是建立一个包含字母和值之间关系的信息。我的循环遍历每个字符 A 到 Z，然后您可以将每个字母的任何值作为标签（我只是放了 1、2、3、4 ......但 label= 会改变它）。

```
data fmts;
retain fmtname 'CHARNUM' type 'i';
do _t=65 to 90;
start=byte(_t); *the character, so byte(65)='A';
label=_t-64;    *the resulting number;
output;
end;
run;
proc format cntlin=fmts;
quit;

data test;
charval='CAB';
do _t=1 to length(Charval);
    numval=sum(numval,input(char(upcase(charval),_t),CHARNUM.));
end;
put _all_;
run; 
```

最后，如果您希望能够在*同一个*数据步中构造它，您可以在哈希表中构造关系并查找结果。如果需要，我可以解释一下，尽管我希望看到一个更详细的示例，说明您在定义字母与其代码之间的关系方面想要做什么。

如果您需要查看中间值，您可以通过在循环中插入 CAT 函数来实现 - 我推荐 CATX：

```
data test;
charval='CAB';
format intermed $100.;
   do _t=1 to length(Charval);
        numval=sum(numval,input(char(upcase(charval),_t),CHARNUM.));
        intermed=catx('|',intermed,input(char(upcase(charval),_t),CHARNUM.)); *or the RANK portion from earlier;
    end;

put _all_;
run; 
```

这会给你`3|1|2`，然后你可以通过 SCAN 进行数学运算：

```
do _t = 1 to countc(intermed,'|')+1;
  numval2 = sum(numval2,scan(intermed,_t,'|'));
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T18:55:30.680

您尝试翻译的方法是一个很好的尝试，但它不会真正起作用。这是一个简单的解决方案：

```
DATA CHAR_VALUE;
  retain all_chars 'ABCDEFGHIJKLMMOPQRSTUVXXYZ';
  set XYZ;

  length CHAR_2_NUM $200;
  CHAR_2_NUM = ' ';
  NUM_CHAR = 0;

  do i=1 to length(MY_VAR_CHAR);
     if i=1 then CHAR_2_NUM = substr(MY_VAR_CHAR,i,1);
            else CHAR_2_NUM = trim(CHAR_2_NUM) || ' ' || substr(MY_VAR_CHAR,i,1);
     NUM_CHAR + index(all_chars,substr(MY_VAR_CHAR,i,1));
     end;
  drop i all_chars;
RUN; 
```

这利用了变量中源变量的每个字符的索引位置`all_chars`对应于您所需的映射这一事实。

**更新**以创建您的`CHAR_2_NUM`变量，我在原始问题中忽略了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-25T22:58:56.807

另一个简单的解决方案是基于`collate`函数：

要将一个名为`MyNumbers`（在 1 到 26 范围内）的变量转换为英文大写字符，可以使用：

```
collate(64 + MyNumbers, 64 + MyNumbers) 
```

要获取小写字符，可以使用：

```
collate(96 + MyNumbers, 96 + MyNumbers) 
```

这是一个简单的例子：

```
data _null_;
    do MyNumbers = 1 to 26;
          MyLettersUpper = collate(64 + MyNumbers, 64 + MyNumbers);
          MyLettersLower = collate(96 + MyNumbers, 96 + MyNumbers);
          put MyNumbers MyLettersUpper MyLettersLower;
    end;
run;

    1 A a
    2 B b
    3 C c
    4 D d
    5 E e
    6 F f
    7 G g
    8 H h
    9 I i
    10 J j
    11 K k
    12 L l
    13 M m
    14 N n
    15 O o
    16 P p
    17 Q q
    18 R r
    19 S s
    20 T t
    21 U u
    22 V v
    23 W w
    24 X x
    25 Y y
    26 Z z
    NOTE: DATA statement used (Total process time):
          real time           0.03 seconds
          cpu time            0.03 seconds 
```

# c# - 我们在 IEnumerable 中有一个“包含”方法吗

> ID：13767277
> 
> 赞同：17
> 
> 时间：2012-12-07T16:41:29.760
> 
> 标签：c#

我的代码中有一个类已经派生自 IEnumerable。我想知道是否有一种方法可以在其实例上使用“包含”方法来查找该列表中的内容？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-07T16:42:51.030

你*真的*实现了 non-generic`IEnumerable`还是 generic `IEnumerable<T>`？如果您可以实现通用的，您的生活将变得更加简单 - 因为您可以使用[LINQ to Objects](http://msdn.microsoft.com/en-us/library/bb397919.aspx)，它确实有一个[`Contains`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.contains.aspx)扩展方法。

`Cast`否则，您可能会使用or将非泛型转换为泛型`OfType`，例如

```
bool found = nonGeneric.Cast<TargetType>().Contains(targetItem); 
```

如果您只是实现了通用接口开始，那就更好了:)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-12-07T16:42:30.633

[`IEnumerable<T>`](http://msdn.microsoft.com/en-us/library/system.collections.ienumerable.aspx)不，界面中没有这样的方法。有一个[`extension method`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.contains.aspx)你可以使用的。

```
using System.Linq; 
```

进而：

```
IEnumerable<string> foos = new[] { "foo", "bar", "baz" };
bool IsThereABar = foos.Contains("bar"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-18T10:53:34.947

```
public static bool Contains<T>(this IEnumerable source, T value)
    {
        foreach (var i in source)
        {
            if (Equals(i, value))
                return true;
        }
        return false;
    } 
```

如果需要，可以添加自定义比较器作为参数 ti 扩展方法包含

# jquery - jQuery - 切换 CSS 背景图像展开/关闭

> ID：13767278
> 
> 赞同：0
> 
> 时间：2012-12-07T16:41:36.913
> 
> 标签：jquery, css, toggle, background-image

我正在寻找一种方法来更改切换时的背景图像，如下面的问题所示：

[jQuery - 切换图像展开/关闭](https://stackoverflow.com/questions/6681638/jquery-toggle-image-expand-close)

我的问题是我有这个html：

```
<button id="close-menu"></button>
<div id="menu-bar">
<div class="wrapper">
    <a href="http://www.website.com" target="_blank">
        <img src="image.png" alt="">
    </a>
    <div class="options">
        <h2>eBlast Tools</h2>
        <ul>
            <li class="toggle-images">Images are <span>enabled</span>. Click to disable.</li>
            <li class="download-zip"><a href="download.zip">Download ZIP File</a></li>
        </ul>
    </div>
</div>
</div> 
```

这是我当前的 jquery：

```
$('#close-menu').click(function() {
    $('#menu-bar').slideToggle(400);
    return false;
}); 
```

这是CSS：

```
#close-menu {
background: url(../img/minus-button.png);
background-position: top left;
width: 25px;
height: 25px;
position: absolute;
top: 10px;
right: 20px;
z-index: 100;
border: none;
}

#close-menu:hover {
background: url(../img/minus-button.png);
background-position: bottom left;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T16:48:54.670

假设您想要`close-menu`改变的背景 - 尝试这样的事情：

```
$('#close-menu').click(function() {
    $('#menu-bar').slideToggle(400, function(){
        if($(this).is(':visible')){
            $('#close-menu').css('background-position','bottom left');
        } else {
            $('#close-menu').css('background-position','top left');
        }
    });

    return false;
}); 
```

* * *

**作为对您的评论的回应**-您最好创建一些这样的 CSS：

```
.minus { background: url(../img/minus-button.png) top left no-repeat; }
.minus:hover { background-position: bottom left; }

.plus { background: url(../img/plus-button.png) top left no-repeat; }
.plus:hover { background-position: bottom left; } 
```

添加 to 的类，`minus`然后`close-menu`执行：

```
$('#close-menu').click(function() {
    $('#menu-bar').slideToggle(400, function(){
        $('#close-menu').toggleClass('minus');
        $('#close-menu').toggleClass('plus');
    });

    return false;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:02:28.340

尝试这个，

```
if($('#divname:visible'))
 {
   $('#close-menu').css('background-image','img.jpg');
}
else
{
  $('#close-menu').css('background-image','img.jpg');
} 
```

# git - GIT 拉取文件，但忽略它们

> ID：13767284
> 
> 赞同：1
> 
> 时间：2012-12-07T16:41:53.633
> 
> 标签：git, github

我知道这`.gitignore`用于忽略推送和拉取中的文件。但我想要做的是有一个附加部分，让我们称之为额外的部分。

流程是这样的

1.  开发者拉取应用

2.  extras 部分会自动添加到 gitignore

3.  另一位开发人员通过在附加部分添加“插件”来修改应用程序

4.  开发人员拉取应用程序以使其保持最新，但从未修改附加部分

我的问题是可以从 git 中提取并自动忽略文件或文件夹吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T16:58:06.803

添加`extra`到存储库`.gitignore`并添加`.gitignore`到存储库。

所以，当有人拉repo时，他会自动获取`.gitignore`，`extra`目录会被自动忽略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:09:30.210

简单的例子，你有 2 个文件夹和 1 个 .ignore 文件的存储库

2 文件夹
应用程序和附加功能和
1 文件
.gitignore

.gitignore 应该有这个
extras/

因此，每当有人克隆这个存储库时，他们都会得到一个额外的文件夹，他们可以在其中做他们想做的事情，因为它被忽略了。

但是，如果开发人员使用 extras 文件夹中的内容进行提交，那么从 repo 中提取的开发人员会将该内容放入 extras 文件夹中

干杯

# sql-server-2008 - 对并发连接容量进行基准测试

> ID：13767288
> 
> 赞同：1
> 
> 时间：2012-12-07T16:42:24.353
> 
> 标签：sql-server-2008

我如何知道我的硬件可以支持的 sql 用户连接数的容量是多少？

我们知道平均连接数是多少，并且我们知道企业（我们的版本）有一个硬性限制，大约在 37K 附近。

但是，我们不知道如何确定或者是否有任何好的经验法则来确定在我们需要增加另一台服务器之前我们可以实际支持多少连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:34:27.633

理想情况下，所有连接到数据库的应用程序都应该使用某种形式的连接池。这将大大减少与数据库的打开连接数。

如果不这样做，这应该是重中之重。

根据我的经验，当与 Sql Server 的连接数约为 15,000 时，您将开始遇到各种类型的问题，但这当然会因您的硬件/操作系统而异。

一个问题是用于管理打开连接的内存池已用尽，导致新连接尝试因此失败。

另一个问题是与服务器建立了如此多的连接，操作系统认为它受到了拒绝服务攻击的攻击，因此必须对[注册表进行调整以禁用此保护](http://technet.microsoft.com/en-us/library/cc938202.aspx)。

总之，如果与您的 Sql Server 的连接数是一个问题，那么您有一个应该解决的应用程序/体系结构问题。太多的连接会导致 Sql Server 以异常且难以排除故障的方式死机，应该完全避免。

# javascript - Google IMA SDK 的 HTML 5 问题

> ID：13767299
> 
> 赞同：5
> 
> 时间：2012-12-07T16:42:57.057
> 
> 标签：javascript, html, sdk

好的，我已经搜索了一个关于如何从 Google 获得 HTML 5 IMA SDK 工作的体面示例。

我已经在下面粘贴了我的代码，所发生的只是 HTML 5 视频显示出来，没有任何错误。我认为 Javascript 甚至都没有运行，我知道它是因为我搞砸了。请帮忙。我只想在 HTML 5 vid 中显示广告

我已将我的 VAST 标记替换为 Google 的示例标记，并使用我在网络上找到的通用视频作为 src 视频。任何人都有关于为什么这不起作用的建议。

```
 <video id="videohtml5" width="720" height="405" controls="controls">
        <source src="http://www.cncpts.me/complex/html5-IMA/NewBalance_NYCExperience_FINAL.mp4" type="video/mp4">
              Your browser does not support the video tag.
        </video>
        <script type="text/javascript" src="http://www.google.com/jsapi"></script>
        <script type="text/javascript">
        var adsManager;
        var adsLoader;
        var clickTrackingOverlay = document.getElementById('clickTrackingOverlay');
        var videoElement = document.getElementById('videohtml5');   
        var adsLoader = new google.ima.AdsLoader();  

          // Add event listeners
        adsLoader.addEventListener(
            google.ima.AdsLoadedEvent.Type.ADS_LOADED,
            onAdsLoaded,
            false);
        adsLoader.addEventListener(
            google.ima.AdErrorEvent.Type.AD_ERROR,
            onAdError,
            false);

           // Create request object
           var adsRequest = {
              adTagUrl: "hhttp://pubads.g.doubleclick.net/gampad/ads?sz=400x300&iu=%2F6062%2Fiab_vast_samples&ciu_szs=300x250%2C728x90&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]&cust_params=iab_vast_samples%3Dlinear",
              adType: "video"
            };

          // Make request
          adsLoader.requestAds(adsRequest);

          function onAdsLoaded(adsLoadedEvent) {
            // Get the ads manager
            adsManager = adsLoadedEvent.getAdsManager();
            adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, onAdError);

            // Listen and respond to events which require you to pause/resume content
            adsManager.addEventListener(
                google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,
                onPauseRequested);
            adsManager.addEventListener(
                google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,
                onResumeRequested);

            // Set a visual element on which clicks should be tracked for video ads
            adsManager.setClickTrackingElement(clickTrackingOverlay);
            try {
              // Call play to start showing the ad.
              adsManager.play(videoElement);
            } catch (adError) {
              // An error may be thrown if there was a problem with the VAST response.
            }
          }

          function onAdError(adErrorEvent) {
            // Handle the error logging.
            console.log(adErrorEvent.getError());
          }

          function onPauseRequested() {
            videoElement.pause();
            // Setup UI for showing ads (e.g. display ad timer countdown,
            // disable seeking, etc.)
            // setupUIForAd();
          }

          function onResumeRequested() {
            // Setup UI back for showing content.
            // setupUIForContent();
            videoElement.play();
          }
        </script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T17:37:30.590

想通了下一个任务是学习如何在 iframe 内的嵌入对象上运行它

```
 <script type="text/javascript" src="http://www.google.com/jsapi"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script type="text/javascript" src="http://www.google.com/uds?file=ima&v=1&nodependencyload=true"></script>
        <script type="text/javascript">
        $(document).ready(function(){
            $("#videohtml5").click(function(){   
        var adsManager;
        var clickTrackingOverlay = document.getElementById('clickTrackingOverlay');
        var videoElement = document.getElementById('videohtml5');   
        var adsLoader = new google.ima.AdsLoader();

          // Add event listeners
        adsLoader.addEventListener(
            google.ima.AdsLoadedEvent.Type.ADS_LOADED,
            onAdsLoaded,
            false);
        adsLoader.addEventListener(
            google.ima.AdErrorEvent.Type.AD_ERROR,
            onAdError,
            false);

           // Create request object
           var adsRequest = {
              adTagUrl: "http://pubads.g.doubleclick.net/gampad/ads?sz=400x300&iu=%2F6062%2Fiab_vast_samples&ciu_szs=300x250%2C728x90&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]&cust_params=iab_vast_samples%3Dlinear",
              adType: "video"
            };

          // Make request

          adsLoader.requestAds(adsRequest);

          function onAdsLoaded(adsLoadedEvent) {
            // Get the ads manager
            adsManager = adsLoadedEvent.getAdsManager();
            adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, onAdError);

            // Listen and respond to events which require you to pause/resume content
            adsManager.addEventListener(
                google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,
                onPauseRequested);
            adsManager.addEventListener(
                google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,
                onResumeRequested);

            // Set a visual element on which clicks should be tracked for video ads
            adsManager.setClickTrackingElement(clickTrackingOverlay);
            try {
              // Call play to start showing the ad.
              adsManager.play(videoElement);
            } catch (adError) {
              // An error may be thrown if there was a problem with the VAST response.
            }
          }

          function onAdError(adErrorEvent) {
            // Handle the error logging.
            console.log(adErrorEvent.getError());
          }

          function onPauseRequested() {
            videoElement.pause();
            // Setup UI for showing ads (e.g. display ad timer countdown,
            // disable seeking, etc.)
            // setupUIForAd();
          }

          function onResumeRequested() {
            // Setup UI back for showing content.
            // setupUIForContent();
            videoElement.play();
          }

          });
        });

        </script>
        <video id="videohtml5" width="720" height="405" controls="controls" onclick="">
        <source src="#" type="video/mp4">
              Your browser does not support the video tag.
        </video> 
```

# java - 如何在Java中围绕一个点旋转多边形/点

> ID：13767301
> 
> 赞同：1
> 
> 时间：2012-12-07T16:43:07.810
> 
> 标签：java, rotation, polygon, affinetransform

我一直在尝试围绕指定的中心点旋转多边形，但我尝试过的一切都失败了。例如，我用谷歌搜索，发现很多但没有一个似乎有效。

我试图复制的结果与第一个答案相似

[如何在 Swing 中逐渐旋转图像？](https://stackoverflow.com/questions/3405799)

不同之处在于我需要多边形实际旋转，只是以一定角度绘制它不会切割它。（用于简单的物理建模）

这是我的代码，我尝试了几种不同的方法

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Point;
import java.awt.Polygon;
import java.awt.Shape;
import java.awt.geom.AffineTransform;
import java.util.Timer;
import java.util.TimerTask;
import javax.swing.JPanel;

public class rotationPanel extends JPanel {

    private static final int SIZE = 500;
    private static final Shape outline = makeShape();

    Point p;
    Point p2;
    Point p3;
    Point p4;
    Point[] points;
    Point[] npoints;

    Point center;
    Polygon poly;

    double angle;

    Timer timer;
    long start;
    long sleepTime;
    static int runTime;

    public rotationPanel(){
        setSize(500,500);
        setBackground(Color.DARK_GRAY);
        setVisible(true);

        runTime = 100;  //ms

        start = 0;
        sleepTime = 0;
        timer = new Timer();

        center = new Point(250,250);

        p = new Point(200,200);
        p2 = new Point(150,150);
        p3 = new Point(250,150);
        p4 = new Point(200,100);

        /*
        points = new Point[4];
        points[0]=p;
        points[1]=p2;
        points[2]=p3;
        points[3]=p4;

        npoints = new Point[4];
        npoints[0]=p;
        npoints[1]=p2;
        npoints[2]=p3;
        npoints[3]=p4;

        poly = new Polygon();
        */

    }

    public void mainloop(){
        start= System.currentTimeMillis();

        //rotate(points,2);

        p = rotatePoint(p,center);
        p2 = rotatePoint(p2,center);
        p3 = rotatePoint(p3,center);
        p4 = rotatePoint(p4,center);

        repaint();

        sleepTime = runTime -(System.currentTimeMillis()-start);
        System.out.println("Looped. Sleeping for:" +sleepTime+"ms");

        if(sleepTime>0)
            timer.schedule(new loop(), sleepTime);
        else
            mainloop();

    }

     private static Shape makeShape() {
            AffineTransform at = new AffineTransform();
            at.translate(SIZE/2, SIZE/2);
            at.scale(20, 20);
            at.rotate(Math.toRadians(35));
            return at.createTransformedShape(initPoly());       
        }

        /** Create a U shaped outline. */
        private static Polygon initPoly() {
            Polygon poly = new Polygon();
            poly.addPoint( 1,  0);
            poly.addPoint( 1, -2);
            poly.addPoint( 2, -2);
            poly.addPoint( 2,  1);
            poly.addPoint(-2,  1);
            poly.addPoint(-2, -2);
            poly.addPoint(-1, -2);
            poly.addPoint(-1,  0);
            return poly;
        }

    public void rotatePoint(Point pt, double rotationAngle){

        AffineTransform.getRotateInstance
        (Math.toRadians(rotationAngle), center.x, center.y)
                .transform(pt,pt);          
    }

    public Point rotatePoint(Point pt, Point center)
    {
        angle = (Math.toRadians(150));
        double cosAngle = Math.cos(angle);
        double sinAngle = Math.sin(angle);

        pt.x = center.x + (int) ((pt.x-center.x)*cosAngle-(pt.y-center.y)*sinAngle);
        pt.y = center.y + (int) ((pt.x-center.x)*sinAngle+(pt.y-center.y)*cosAngle);
        return pt;
    }

    public void rotate(Point[] pts, int angle){

        AffineTransform.getRotateInstance
        (Math.toRadians(angle), center.x, center.y)
                .transform(pts,0,npoints,0,4);

        points = new Point[4];
        points[0]=npoints[0];
        points[1]=npoints[1];
        points[2]=npoints[2];
        points[3]=npoints[3];

    }

    public void paintComponent(Graphics g) {
           super.paintComponent(g);  

           g.setColor(Color.BLUE);
           g.fillRect(center.x-4, center.y-4, 8, 8);

           g.setColor(Color.YELLOW);
           //g.fillRect(p.x-4, p.y-4, 8, 8);
           //g.fillRect(p2.x-4, p2.y-4, 8, 8);
           //g.fillRect(p3.x-4, p3.y-4, 8, 8);
           //g.fillRect(p4.x-4, p4.y-4, 8, 8);

           g.fillRect(p.x, p.y, 2, 2);
           g.fillRect(p2.x, p2.y, 2, 2);
           g.fillRect(p3.x, p3.y, 2, 2);
           g.fillRect(p4.x, p4.y, 2, 2);
    }

    class loop extends TimerTask{

        public void run() {
            mainloop();         
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-09T15:10:57.773

由于您没有帮助我改变太多，我被迫自己解决这个问题。开始了：

正确的方法（或至少其中一种方法）是对要旋转的多边形的点使用仿射变换。问题是你不能一遍又一遍地旋转同一个多边形，因为它会由于连续的四舍五入而严重变形。

所以诀窍是保持多边形的“原始版本”并始终旋转那个。

当然，这种方法仅在多次旋转多边形时才是关键的。如果您只想旋转一次，您可以简单地使用要旋转的多边形中的值。

这是我设法整理的一个小例子：

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Point;
import java.awt.Polygon;
import java.awt.RenderingHints;

import java.awt.geom.AffineTransform;
import java.util.Timer;
import java.util.TimerTask;

import javax.swing.JFrame;
import javax.swing.JPanel;

public class rotationPanel extends JPanel {

    private static final long serialVersionUID = 117L;

    private static final int SIZE = 500;

    // point arrays which contain the points that are rotated around the center 
    Point[] points1;
    Point[] points2;
    Point[] points3;

    // The center of rotation  
    Point center;

    // the polygons being rotated
    Polygon poly1;
    Polygon poly2;
    Polygon poly3;

    // the angle of rotation
    double angle;

    Timer timer;
    long start;
    long sleepTime;
    static int runTime;

    public rotationPanel(){
        setSize(500,500);
        setBackground(Color.DARK_GRAY);
        setVisible(true);

        // time loop is set to run at fixed rate of 50 ms
        runTime = 50; 

        start = 0;
        sleepTime = 0;
        timer = new Timer();
        angle = 0;

        // initializing the arrays (not neccesary)
        points1 = getOriginalPoints(1);
        points3 = getOriginalPoints(3);
        points2 = getOriginalPoints(2);

        // setting the rotation to the middle of the screen
        center = new Point(250,250);

        // start the looping
        mainloop();

    }

    public void mainloop(){
        start= System.currentTimeMillis();

        // rotate the points the spcified angle and store the rotated
        //points to the correct array
        rotatePointMatrix(getOriginalPoints(1),angle,points1);
        rotatePointMatrix(getOriginalPoints(2),angle,points2);
        rotatePointMatrix(getOriginalPoints(3),angle,points3);

        // Make the points into a polygon
        poly1 = polygonize(points1);
        poly2 = polygonize(points2);
        poly3 = polygonize(points3);

        // increase the angle by one degree, resulting to rotation in the longer run
        angle++;

        if (angle>=360){
            angle=0;
        }

        // restatring the sequence 
        repaint();

        sleepTime = runTime -(System.currentTimeMillis()-start);
        System.out.println("Looped. Sleeping for:" +sleepTime+"ms");

        if(sleepTime>0)
            timer.schedule(new loop(), sleepTime);
        else
            mainloop();

    }

    public void rotatePointMatrix(Point[] origPoints, double angle, Point[] storeTo){

        /* We ge the original points of the polygon we wish to rotate
         *  and rotate them with affine transform to the given angle. 
         *  After the opeariont is complete the points are stored to the 
         *  array given to the method.
        */
        AffineTransform.getRotateInstance
        (Math.toRadians(angle), center.x, center.y)
                .transform(origPoints,0,storeTo,0,5);

    }

    public Polygon polygonize(Point[] polyPoints){

        //a simple method that makes a new polygon out of the rotated points
        Polygon tempPoly = new Polygon();

         for(int  i=0; i < polyPoints.length; i++){
             tempPoly.addPoint(polyPoints[i].x, polyPoints[i].y);
        }

        return tempPoly;

    }

    public Point[] getOriginalPoints(int type){

        /* In this example the rotated "polygon" are stored in this method. 
         * The Point is that if we want to rotate a polygon constatnly/frequently
         * we cannot use the values of an already rotated polygon as this will 
         * lead to the polygon deforming severely after few translations due 
         * to the points being constantly rounded. So the trick is to save the
         * original Points of the polygon and always rotate that one to the new
         *  angle instead of rotating the same one again and again.
        */
        Point[] originalPoints = new Point[5];

        if(type == 2){

        originalPoints[0]= new Point(200, 100);
        originalPoints[1]= new Point(250, 50);
        originalPoints[2]= new Point(300, 100);
        originalPoints[3]= new Point(300, 400);
        originalPoints[4]= new Point(200, 400);

        }

        else if(type == 1){

        originalPoints[0]= new Point(210, 150);
        originalPoints[1]= new Point(250, 150);
        originalPoints[2]= new Point(250, 190);
        originalPoints[3]= new Point(230, 220);
        originalPoints[4]= new Point(210, 190);

        }
        else{

            originalPoints[0]= new Point(250, 300);
            originalPoints[1]= new Point(290, 300);
            originalPoints[2]= new Point(290, 340);
            originalPoints[3]= new Point(270, 370);
            originalPoints[4]= new Point(250, 340);

        }

        return originalPoints;

    }

    public void paintComponent(Graphics g) {
           super.paintComponent(g);  

           Graphics2D g2d = (Graphics2D) g;

           g2d.setRenderingHint(                    
                    RenderingHints.KEY_ANTIALIASING,
                    RenderingHints.VALUE_ANTIALIAS_ON);

           g2d.setColor(Color.GRAY);
           g2d.fillPolygon(poly2);

           g2d.setColor(Color.yellow);
           g2d.fillPolygon(poly1);

           g2d.setColor(Color.yellow);
           g2d.fillPolygon(poly3);

           g2d.setColor(Color.WHITE);
           for(int  i=0; i < points1.length; i++){
                g2d.fillRect(points1[i].x-1, points1[i].y-1, 3, 3);
                g2d.fillRect(points3[i].x-1, points3[i].y-1, 3, 3);

            }

           g2d.setColor(Color.BLUE);
           g2d.fillOval(center.x-4, center.y-4, 8, 8);

           g2d.setColor(Color.yellow);
           g2d.drawString("Angle: "+angle, 10,450);

    }

    class loop extends TimerTask{

        public void run() {
            mainloop();

        }

    }

    public static void main(String[] args){
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.add(new rotationPanel());
        f.setSize(500,500);
        f.setVisible(true);

    }

} 
```

我希望这有帮助！如果您遇到麻烦，请不要犹豫与我联系！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-04-06T20:13:31.647

这是一个简单的方法，可以从一组点构建一个多边形，围绕一个中心点旋转一个指定的角度：

```
/**
 * Builds a polygon from a set of points, rotated around a point, at the
 * specified rotation angle.
 * 
 * @param centerX the int center x coordinate around which to rotate
 * @param centerY the int center y coordinate around which to rotate
 * @param xp the int[] of x points which make up our polygon points. This
 *           array is parallel to the yp array where each index in this array
 *           corresponds to the same index in the yp array.
 * @param yp the int[] of y points which make up our polygon points. This
 *           array is parallel to the xp array where each index in this array
 *           corresponds to the same index in the xp array.
 * @param rotationAngle the double angle in which to rotate the provided
 *                      coordinates (specified in degrees).
 * @return a Polygon of the provided coordinates rotated around the center point
 *         at the specified angle.
 * @throws IllegalArgumentException when the provided x points array is not the
 *                                  same length as the provided y points array
 */
private Polygon buildPolygon(int centerX, int centerY, int[] xp, int[] yp, double rotationAngle) throws IllegalArgumentException {
    // copy the arrays so that we dont manipulate the originals, that way we can
    // reuse them if necessary
    int[] xpoints = Arrays.copyOf(xp,xp.length);
    int[] ypoints = Arrays.copyOf(yp,yp.length);
    if(xpoints.length != ypoints.length){
        throw new IllegalArgumentException("The provided x points are not the same length as the provided y points.");
    }

    // create a list of Point2D pairs
    ArrayList<Point2D> list = new ArrayList();
    for(int i = 0; i < ypoints.length; i++){
        list.add(new Point2D.Double(xpoints[i], ypoints[i]));
    }

    // create an array which will hold the rotated points
    Point2D[] rotatedPoints = new Point2D[list.size()];

    // rotate the points
    AffineTransform transform = AffineTransform.getRotateInstance(Math.toRadians(rotationAngle), centerX, centerY);
    transform.transform(list.toArray(new Point2D[0]), 0, rotatedPoints, 0, rotatedPoints.length);

    // build the polygon from the rotated points and return it
    int[] ixp = new int[list.size()];
    int[] iyp = new int[list.size()];
    for(int i = 0; i < ixp.length; i++){
        ixp[i] = (int)rotatedPoints[i].getX();
        iyp[i] = (int)rotatedPoints[i].getY();
    }
    return new Polygon(ixp, iyp, ixp.length);
} 
```

# javascript - afterCommandExec 在 CKEditor 4 中为什么不触发？

> ID：13767304
> 
> 赞同：3
> 
> 时间：2012-12-07T16:43:12.577
> 
> 标签：javascript, ckeditor

我查看了 CKEditor API 并发现了这个有用的事件：

[http://docs.ckeditor.com/#!/api/CKEDITOR.editor-event-afterCommandExec](http://docs.ckeditor.com/#!/api/CKEDITOR.editor-event-afterCommandExec)

它不适用于任何需要下拉菜单（类名、字体、字体大小）的东西，但它适用于任何按钮，如粗体、链接、撤消。

有谁知道为什么这不起作用，或者这些工具栏插件是否还有其他事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T17:55:44.380

这是因为这些下拉菜单（字体大小/系列、格式等）不使用命令。

我认为您可以使用[selectionChange](http://docs.ckeditor.com/#!/api/CKEDITOR.editor-event-selectionChange)事件。每次修改选择的[elementPath](http://docs.ckeditor.com/#!/api/CKEDITOR.dom.elementPath)（包括焦点/模糊）时都会触发它。所以所有按钮，每个下拉菜单都会触发它，即使点击它也是如此。

# php - PHP 注释是否有编码标准？

> ID：13767305
> 
> 赞同：2
> 
> 时间：2012-12-07T16:43:14.977
> 
> 标签：php, coding-style

是否有 PHP 编码标准明确定义如何为属性和方法编写 docblock 注释：

*   `@var`
*   `@param`
*   `@return`
*   `@throws`

包括它们之间的正确间距？

[PSR-2](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-2-coding-style-guide.md)涵盖了代码本身，但不强制使用注释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T16:45:01.927

PHP 中没有注释。如果您用于`phpdoc`生成文档，则需要遵循`phpdoc`指南。

[http://www.phpdoc.org/](http://www.phpdoc.org/)

# javascript - 与 KineticJS 的形状相交

> ID：13767306
> 
> 赞同：0
> 
> 时间：2012-12-07T16:43:16.383
> 
> 标签：javascript, html, canvas, html5-canvas, kineticjs

我想使用**KineticJS仅显示两个形状的****交集**。我怎样才能做到这一点？我试着像下面的链接那样做。 [HTML5 画布剪辑区域](http://www.html5canvastutorials.com/advanced/html5-canvas-clipping-region-tutorial/)。有没有别的办法？

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T18:51:48.777

您可以使用`globalCompositeOperation`来执行此操作：http: [//jsfiddle.net/wbzwX/](http://jsfiddle.net/wbzwX/)

```
ctx.fillStyle="#000";
ctx.fillRect(50,50,100,100);

ctx.globalCompositeOperation = "source-in"; 
// this will use the fillstyle of the next drawn object. 
// "destination-in" will use the previous fillstyle.

ctx.beginPath();
ctx.arc(100,50,30,0,Math.PI*2,false);
ctx.closePath();
ctx.fillStyle="#f00";
ctx.fill();​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T05:29:27.300

我创建了基于 Shmi 的解决方案。

```
 function makeShapeComposite(shape, operation) {
        shape.attrs._drawFunc = shape.attrs.drawFunc;
        shape.attrs.drawFunc = function (context) {
            context.save();
            context.globalCompositeOperation = operation;
            this.attrs._drawFunc.call(this, context);
            context.restore();
        };
        return shape;
    };   

   var pol=  makeShapeComposite(new Kinetic.RegularPolygon({
           x: 250,
            y: 100,
            sides: 4,
            radius: 70,
            fill: '#00D2FF',
            stroke: 'black',
            strokeWidth: 2
        }), "destination-in"); 
```

小提琴：http: [//jsfiddle.net/sara9/2v7W2/5/](http://jsfiddle.net/sara9/2v7W2/5/)

[参考本教程。](http://www.html5canvastutorials.com/advanced/html5-canvas-global-composite-operations-tutorial/)**

# git - 在拉动之前提交所有内容，为什么？

> ID：13767309
> 
> 赞同：3
> 
> 时间：2012-12-07T16:43:23.837
> 
> 标签：git, git-pull, git-commit

在分支中工作时，我会更改一些文件。我的一位同事告诉我，他推动了一项改变，我应该采取行动来解决眼前的问题。如果我不提交我的更改，git 不会让我拉。即使我修改过的所有文件都没有更新。

我想知道为什么会这样，如果可能的话，有没有办法避免这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T16:57:41.600

`git pull`本质上是一个提取，然后是一个合并。合并通常要求工作目录处于干净状态；他们这样做是为了您的安全：

> **警告：**不鼓励使用未提交的更改运行 git merge：虽然可能，但它会使您处于在发生冲突时难以退出的状态。（[来源](http://git-scm.com/docs/git-merge)）

和：

> 如果任何远程更改与本地未提交的更改重叠，则合并将自动取消并且工作树保持不变。通常最好在使用 git-stash 拉取或存储它们之前获得工作顺序的任何本地更改。（[来源](http://git-scm.com/docs/git-pull)）

我相信 a pure 中的检查`git merge`实际上比 a 中的更宽容`git pull`，因此您可能想尝试先获取然后手动合并。但最好先把东西藏起来。

# android - 风格动作模式

> ID：13767312
> 
> 赞同：1
> 
> 时间：2012-12-07T16:43:30.613
> 
> 标签：android, android-actionbar, actionbarsherlock

我正在使用 ActionBarSherlock 并尝试设置 ActionMode 的样式。我可以在我的风格中使用这些属性更改背景和完成按钮：

```
<item name="android:actionModeCloseDrawable">@drawable/abs__ic_cab_done_holo_dark</item>
<item name="android:actionModeBackground">@drawable/actionbar_bg</item> 
```

但我不知道如何设置完成按钮旁边的垂直线的颜色。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T08:43:10.473

我在我的主题中用这段代码解决了这个问题：

```
<item name="android:actionModeCloseButtonStyle">@style/action_button_done</item> 
```

样式 action_button_done 只是设置背景可绘制：

```
<style name="action_button_done" parent="Widget.Sherlock.ActionButton.CloseMode">
    <item name="android:background">@drawable/abs__btn_cab_done_holo_dark</item>
</style> 
```

**警告**

这应该是一件简单的事情。确实如此，但出于某种原因，HTC 决定在按钮顶部放置一个额外的层，这使得它无法设置样式。我很幸运，我尝试在我的朋友三星 Galaxy Nexus 上进行部署，并注意到它确实有效。我只用过htc one x，所以不知道在其他htc设备上是否也一样。

# c# - 在 C# 中尝试 INSERT INTO .accdb 时出现“查询表达式中的语法错误（缺少运算符）”

> ID：13767316
> 
> 赞同：0
> 
> 时间：2012-12-07T16:43:44.513
> 
> 标签：c#, database, ms-access-2010

所以我有下面的代码，点击“button3”后，应该将我的dataGridView的内容插入到我的数据库中。我收到错误消息：

**“查询表达式' '中的语法错误（缺少运算符）**，我的第一列的第一个值在单引号中，好像它读取数据，但不知道如何处理它。当我单击“确定” " 关闭消息，然后弹出另一条消息，并且该列的第二个值现在用单引号括起来；依此类推，直到达到最后一个值，最后，弹出一个错误框：

**“INSERT INTO 语句中的语法错误”**

我计划在代码运行后对其进行参数化；所以不用担心。:-)

**请帮忙！！！！感谢所有帮助。**

```
private void button3_Click(object sender, EventArgs e)

        {

            string ConnString = @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Search\\Database.accdb"; //Persist Security Info=True";
            for(int i=0; i< dataGridView1.Rows.Count;i++)
                {
                string StrQuery = "INSERT INTO script_Orders (" + "script, " + "cust_Name) VALUES (" + dataGridView1.Rows[i].Cells["Prescription"].Value + ", " + dataGridView1.Rows[i].Cells["Customer_Name"].Value + ");";
                try
                    {
                        using (OleDbConnection conn = new OleDbConnection (ConnString))
                            {
                            using (OleDbCommand comm = new OleDbCommand(StrQuery, conn))
                                {
                                conn.Open();
                                comm.ExecuteNonQuery();
                                conn.Close();
                                }
                            }
                    }
                catch (Exception ex)
                    {
                        MessageBox.Show(ex.Message, "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
                    }
                }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:48:30.203

尝试这个

```
string StrQuery = String.Format("INSERT INTO script_Orders(script,cust_Name) VALUES ('{0}','{1}')", dataGridView1.Rows[i].Cells["Prescription"].Value,  dataGridView1.Rows[i].Cells["Customer_Name"].Value); 
```

# ajax - 事件后重新渲染不刷新

> ID：13767317
> 
> 赞同：1
> 
> 时间：2012-12-07T16:43:44.253
> 
> 标签：ajax, jsf, richfaces, rendering

我只有一个 selectOneRadio 并且想要根据布尔值显示（或不显示）面板（在使用 a4j 的事件后基本重新渲染）。我与布尔值的绑定很好，并且该操作确认布尔值在单击时发生变化：

这是我的`selectOneRadio`：

```
<h:selectOneRadio  value="#{myController.myBoolean}">
    <a4j:support event="onclick" action="#{...}"  reRender="myPanel" />
        <f:selectItem itemLabel="Yes" itemValue="#{true}"/>
        <f:selectItem itemLabel="No" itemValue="#{false}"/>
</h:selectOneRadio> 
```

为什么使用属性后 reRender 不起作用`rendered`（无效）：

```
<a4j:outputPanel id="myPanel"  rendered="#{myController.myBoolean}">... 
```

而它使用`style`属性工作，通过改变可见性：

```
<a4j:outputPanel id="myPanel"  style="#{myController.myBoolean ? 'visibility:visible;':'display:none;'}">... 
```

*   Richfaces 3.3.3.Final
*   每个浏览器都有相同的错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:57:05.890

该问题可以解释如下。最初，您的面板“myPanel”未渲染，因为渲染属性设置为`false`. `true`然后现在您通过选择`selectOneRadio`组件将呈现的值更改为。然后，您将在标签中`reRender`使用“myPanel” 。 但不幸的是，没有要重新渲染的“myPanel”，因为您的页面中没有这样的元素（因为它没有被渲染）。`reRender="myPanel"``a4j:support`

您可以通过重新渲染“myPanel”的父级来解决此问题。例如，如果“myPanel”有`panel`如下父级，

```
<a4j:outputPanel id="parentPanel">
    <a4j:outputPanel id="myPanel"  rendered="#{myController.myBoolean}">
           .......
    </a4j:outputPanel>
</a4j:outputPanel> 
```

现在`reRender`的父母如下

```
<a4j:support event="onclick" action=#{...}"  reRender="parentPanel" /> 
```

注意：当您更改`visibility`而不是`rendered`属性时，它会起作用，因为尽管“myPanel”被隐藏，但它仍然在您的页面中可用。

# sql - SQL Server：尝试插入重复记录会花费 Id

> ID：13767322
> 
> 赞同：2
> 
> 时间：2012-12-07T16:44:04.463
> 
> 标签：sql, sql-server

我设置了下表：

*   `Id int`pk，唯一不为空
*   `Name varchar(50)`不为空
*   与此问题无关的其他列

将索引设置`Name`为唯一且非聚集的。

该设置完全符合我的要求 - 也就是说，只插入`Name`表中不存在的新行，如果新行是重复的，则抛出错误`Name`。

我可能对此很挑剔，但每次添加重复项的尝试都会导致 SQL Server 跳过本`Id`应分配的下一个，如果新行是 non-duplicate 的话`Name`。

有没有办法通过一些设置来防止这种情况，而无需在决定插入或拒绝之前先查询存在？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:53:21.740

不，没有设置可以防止标识值在插入失败时增加。

就像您建议的那样，您可以通过在执行插入之前检查重复项来缓解这种情况 - 我这样做不仅是为了防止身份增加，而且也是为了防止您的 Sql Server 作为标准过程引发错误。

但是，可能还有其他特殊情况会导致插入失败……因此，如果 ID 中的间隙不仅仅是美学问题，那么标识列可能不是您要解决的问题的最佳解决方案。

# 3d - 相机侧移时模型几何变形

> ID：13767330
> 
> 赞同：0
> 
> 时间：2012-12-07T16:44:21.873
> 
> 标签：3d, three.js

我有一个加载的模型，从前面看起来不错，但如果我将相机移到一边，模型看起来有点奇怪（胖 :)）。我做错了什么还是透视相机视角为 80 是正常的？

这是2图像：

正面：http: [//i48.tinypic.com/14tbg7.jpg](http://i48.tinypic.com/14tbg7.jpg)

侧面：http: [//i47.tinypic.com/scric7.jpg](http://i47.tinypic.com/scric7.jpg)

和加载器代码：

```
var loader = new THREE.JSONLoader();
loader.load( model_js, function( geometry ) {

    var texture = THREE.ImageUtils.loadTexture(textura);
    var material = new THREE.MeshPhongMaterial( { morphTargets: true,map: texture } );
    meshAnim = new THREE.MorphAnimMesh( geometry,material );                        

    meshAnim.scale.set( 1.0, 1.0, 1.0 );

    morphs.push( meshAnim );

    scene.add( meshAnim );       
} ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:50:19.277

这在透视视角为 80 度时是正常的。将其设置为 45 度左右。尝试使用球形网格。

# java - JSONObject.put() 不会存储另一个 JSONObject 的引用

> ID：13767332
> 
> 赞同：3
> 
> 时间：2012-12-07T16:44:29.407
> 
> 标签：java, json-lib

你有没有注意到，如果你用 put() 将一个 JSONObject 放入另一个 JSONObject 中，容器 JSONObject 将不会存储对第一个 JSONObject 的引用，而是一个新的 JSONObject？

一个例子：

```
JSONObject jtmp1 = new JSONObject();
JSONObject jtmp2 = new JSONObject();

jtmp1.put("test", jtmp2);

System.out.println(System.identityHashCode(jtmp2));
System.out.println(System.identityHashCode(jtmp1.getJSONObject("test"))); 
```

两次打印的输出不同，因此 jtmp2 不直接存储在 jtmp1 中。

这是正常行为吗？有什么解决方法吗？我对 JAVA 很陌生，但我认为这不是人们所期望的行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:23:12.047

我也遇到了这个问题，这似乎是正常行为，但我一直无法重现它。解决方法是将所有被放入和取出的对象视为传递值。这实际上可能是一个问题，但您似乎正在使用的那个 JSON 库不再受支持。如果可以的话，我会改成 GSON，它在语法上与您正在使用的库非常相似，没有这个问题，并且目前受支持。

# java - 在代码中的字符串中添加“

> ID：13767342
> 
> 赞同：1
> 
> 时间：2012-12-07T16:45:07.607
> 
> 标签：java, android, json

我正在为使用 JSON 的 Android 应用程序编写一些 Web 服务代码。网址应如下所示

```
url = url + "?maddr=" + mailAddr + "&pwd=FB&lect=" + """ + lectName + """ + "&fb=Test"; 
```

这是因为 Lectname 可能是两个或多个单词。但是编译器不会接受“””，是否有一个字符可以在“”之前让编译器接受它到我的字符串中？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-07T16:46:06.297

试试`" \" "`。您必须转义`"` [http://en.wikipedia.org/wiki/Escape_character](http://en.wikipedia.org/wiki/Escape_character) 您在（几乎）每种编程语言中都需要它。

# video - avconv Fade Filter，合适的输出格式错误

> ID：13767347
> 
> 赞同：1
> 
> 时间：2012-12-07T16:45:24.277
> 
> 标签：video

我正在尝试使用以下命令将淡入过滤器与 ffmpeg 一起使用。

```
ffmpeg -i 2.mp4 "fade=in:0:30" output.mp4 
```

但是，我收到以下错误：

```
Unable to find a suitable output format for 'fade=in:0:30' 
```

我已经检查了 ffmpeg 过滤器并且淡化过滤器安装正确。

请有人让我知道如何进行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T00:17:38.617

您忘记了选项`-filter:v`，后面是过滤器名称和参数。没有它，它将假定这`fade=in:0:30`是一个文件名。

```
ffmpeg -i 2.mp4 -filter:v fade=in:0:30 output.mp4 
```

（一些旧版本`-vf`改为使用。）

# amazon-web-services - 具有静态 IP 地址的 AWS 负载均衡器

> ID：13767349
> 
> 赞同：41
> 
> 时间：2012-12-07T16:45:25.627
> 
> 标签：amazon-web-services, amazon-ec2, load-balancing, amazon-elastic-beanstalk, static-ip-address

我在 Amazon 云上运行了一个设置，其中有几个 EC2 实例通过负载均衡器运行。

重要的是，该站点具有唯一（静态）IP 或一组 IP，因为我正在插入仅接受来自已添加到其白名单的 IP 的请求的第 3 方 API。

所以基本上除非我们可以给这些第 3 方一个静态 IP 或 IP 范围，该站点的请求将始终来自该 IP，否则我们将无法对他们进行任何调用。

任何人都知道如何实现这一点，因为我知道弹性 IP 与负载均衡器不兼容？

如果我要查找负载均衡器 DNS 名称的 IP（例如 dualstack.awseb-BAMobile-ENV-xxxxxxxxx.eu-west-1.elb.amazonaws.com 解析为 200.200.200.200），该 IP 会是静态的吗？

非常感谢任何帮助/建议。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-07T17:08:02.210

负载均衡器的 IP 地址不是静态的。无论如何，您的传入负载均衡器 IP 不会用于传出连接。

您可以将弹性 IP 分配给负载均衡器后面的实际实例，然后将其用于传出请求。您可以获得5个免费的弹性ip，如果您需要，我相信您可以申请更多。

此外，如果使用 VPC 并且您的实例位于私有子网中，那么它们将只能通过您设置的 NAT 实例访问互联网，您当然可以为 NAT 实例分配弹性 IP

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-10-17T08:18:47.000

这是一个老问题，但现在情况发生了变化。

现在您可以创建一个网络 ELB 来获取一个具有静态 IP 的 LB。

来自[https://docs.aws.amazon.com/elasticloadbalancing/latest/network/introduction.html](https://docs.aws.amazon.com/elasticloadbalancing/latest/network/introduction.html)

*   支持负载均衡器的静态 IP 地址。您还可以为负载均衡器启用的每个子网分配一个弹性 IP 地址。

[https://aws.amazon.com/blogs/aws/new-network-load-balancer-effortless-scaling-to-millions-of-requests-per-second/](https://aws.amazon.com/blogs/aws/new-network-load-balancer-effortless-scaling-to-millions-of-requests-per-second/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-08T14:25:34.293

您可以将**额外**的ENI（弹性网络接口）附加到 VPC 中的实例。这样，ELB（弹性负载均衡器）将传入的 Internet 请求路由到 Web 服务器，并且额外的 ENI 将用于连接到您的第 3 方（或内部）请求（*管理网络*）

[您可以在VPC 文档](http://docs.amazonwebservices.com/AmazonVPC/latest/UserGuide/VPC_ElasticNetworkInterfaces.html)中查看有关它的更多详细信息

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-12-07T17:01:40.303

实际上，我知道这样做的唯一方法是在 VPC 中设置您的实例并使用专用的 NAT 实例来路由所有出站流量。

以下是有关如何设置 NAT 实例的 AWS 文档的链接：

[http://docs.amazonwebservices.com/AmazonVPC/latest/UserGuide/VPC_NAT_Instance.html](http://docs.amazonwebservices.com/AmazonVPC/latest/UserGuide/VPC_NAT_Instance.html)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-10-21T12:43:47.953

您可以将弹性 IP 附加到实例，但不能附加到 ELB（这是客户端看到的）。

您可以使用完整的反向代理第 7 层负载均衡器，例如[HAProxy](http://haproxy.1wt.eu/)：

或者像[Loadbalancer.org](http://www.loadbalancer.org/ec2.php)或 Riverbed (Zeus)这样的商业实现

它们都在[AWS Marketplace](https://aws.amazon.com/marketplace/search/results/ref=brs_navgno_search_box?searchTerms=load%20balancer&search=)中：

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-07-06T23:47:21.797

您对第 3 方 API 的出站请求不会通过 ELB/ALB 发出。这是针对传入连接的。如果您需要一个入站静态 IP，您可能需要放弃负载均衡器（或者弄清楚如何实施 Anshu 将弹性 IP 附加到负载均衡器的建议，文档中的细节很简单）。更新：我发现了一些 ALB 使用静态地址的文档（我只是尝试将弹性 IP 绑定到一个以确保失败）。如果您正在谈论出站连接，请参见下文：

*   如果您的服务器部署在公共子网中，您可以将弹性 IP 附加到该主机。出站通信将通过该地址发出。
*   如果您的服务器部署在私有子网中，则会附加一个 NAT 网关。来自您的私有子网的所有出站流量都将通过该接口流出。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-29T22:40:01.180

您可以使用 AWS 中已经提到的 loadbalancer.org 设备。它将取代 AWS NAT 实例并提供更强大的功能，包括第 4 层和第 7 层，以及 SSL 终止和 WAF。

最重要的是，您可以在 AWS 的 30 天试用中获得免费支持，以帮助您启动和运行。

是的，当我为 loadbalancer.org 工作时，我有偏见，但是我想说什么都没有冒险。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-04-11T09:11:14.733

您可以使用允许“ANAME”记录的 DNS 服务，例如 DNSMadeeasy。这些行为类似于 A 记录，但可以指向 FQDN 或 IP。因此，在这种情况下，您可以将其指向 ELB DNS。

戴夫

# arrays - AS3 将 EventListener 添加到 movieClips 数组但出现错误 #2007 :Parameter listener must be non-null

> ID：13767350
> 
> 赞同：0
> 
> 时间：2012-12-07T16:45:27.543
> 
> 标签：arrays, actionscript-3, addeventlistener

我正在尝试为按钮数组中的所有按钮添加一个事件侦听器。我可以在循环中制作它们的按钮，但是当我尝试添加事件侦听器时给我这个错误：

`TypeError: Error #2007: Parameter listener must be non-null. at flash.events::EventDispatcher/addEventListener() at Main()`

我可以将此事件添加到另一个数组，但不能添加到这个数组。我已将这些按钮放在舞台上，并为它们提供了我在 as 文件中引用的实例名称。我在学校学习 AS3，所以这可能是一个非常明显的问题，但我还没有资格调试我的代码：S 感谢您的所有帮助。

```
//array of buttons and making them buttons
var buttons:Array = [armButton, lobeButton, beakButton, crotchButton, earButton, hairButton, legButton, shoulderButton, spineButton, tailButton, tearButton, eyeButton];

for(var b:int = 0; b<buttons.length; b++){
    buttons[b].buttonMode = true;
    buttons[b].addEventListener(MouseEvent.CLICK, clickMe);
}

function clickMe(e:MouseEvent):void{
    trace("hello");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T18:21:35.497

检查定义和参数部分中“clickMe”函数的名称，确保使用完全相同的字符（一个字符有时会被误认为是另一个代码表中的字符）。发生错误是因为在执行循环时“clickMe”表达式为空。

```
var buttons:Array = [armButton, lobeButton, beakButton, crotchButton, earButton, hairButton, legButton, shoulderButton, spineButton, tailButton, tearButton, eyeButton];

for(var b:int = 0; b<buttons.length; b++){
    buttons[b].buttonMode = true;
    // what is the output of the following expression?
    trace(clickMe) // should be "function Function() {}"
    buttons[b].addEventListener(MouseEvent.CLICK, clickMe);
}

function clickMe(e:MouseEvent):void{
    trace("hello");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:43:09.967

在您的 addEventListener 行中，clickMe 为空。

我怀疑我们在这里没有看到所有的代码。该代码是否在同一个文件中？还是您只剪切/粘贴您认为重要的部分？

# java - Java 中不同类型的 Groovy 执行

> ID：13767351
> 
> 赞同：5
> 
> 时间：2012-12-07T16:45:33.023
> 
> 标签：java, scripting, groovy

我有 3 个关于在 java 中使用 Groovy 的问题。它们都是相关的，所以我在这里只提出一个问题。

**1）**有：GroovyClassLoader、GroovyShell、GroovyScriptEngine。但是使用它们有什么区别呢？

例如对于此代码：

```
static void runWithGroovyShell() throws Exception {
    new GroovyShell().parse(new File("test.groovy")).invokeMethod("hello_world", null);
}

static void runWithGroovyClassLoader() throws Exception {
    Class scriptClass = new GroovyClassLoader().parseClass(new File("test.groovy"));
    Object scriptInstance = scriptClass.newInstance();
    scriptClass.getDeclaredMethod("hello_world", new Class[]{}).invoke(scriptInstance, new Object[]{});
}

static void runWithGroovyScriptEngine() throws Exception {
    Class scriptClass = new GroovyScriptEngine(".").loadScriptByName("test.groovy");
    Object scriptInstance = scriptClass.newInstance();
    scriptClass.getDeclaredMethod("hello_world", new Class[]{}).invoke(scriptInstance, new Object[]{});
} 
```

**2）**加载groovy脚本的最佳方法是什么，以便它以*编译*形式保留在内存中，然后我可以在需要时调用该脚本中的函数。

**3)**如何将我的 java 方法/类公开给 groovy 脚本，以便它可以在需要时调用它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:59:24.180

方法 2 和 3 都返回解析`class`后的返回值。`map`因此，一旦解析并成功加载它们，您就可以使用 a将它们保存在内存中。

```
Class scriptClass = new GroovyClassLoader().parseClass(new File("test.groovy"));
map.put("test.groovy",scriptClass); 
```

**更新：**

[GroovyObject](http://groovy.codehaus.org/api/groovy/lang/GroovyObject.html)链接到 groovy 对象文档。

这也可以直接将对象转换为 GroovyObject 和其他 java 类是无法区分的。

```
Object aScript = clazz.newInstance();
MyInterface myObject = (MyInterface) aScript;
myObject.interfaceMethod();
 //now here you can also cache the object if you want to 
```

无法评论效率。但我想如果你把加载的类保存在内存中，一次解析不会有太大的伤害。

**更新为了提高效率**：您应该使用`GroovyScriptEngine`，它在内部使用**脚本缓存**。

这是链接：[Groovy 脚本引擎](https://github.com/groovy/groovy-core/blob/master/src/main/groovy/util/GroovyScriptEngine.java#L99)

否则，您始终可以自己使用一些性能基准测试它，您会得到粗略的想法。例如：在三个不同的循环中使用所有三种方法编译 groovy 脚本，看看哪个性能更好。尝试使用相同和不同的脚本，以查看缓存是否以某种方式启动。

**向脚本传递参数和从脚本传递参数的更新** [绑定类](http://groovy.codehaus.org/api/groovy/lang/Binding.html)将帮助您向脚本发送参数和从脚本发送参数。

[示例链接](http://programmingitch.blogspot.in/2012/01/passing-parameters-into-groovy-script.html)

```
// setup binding
def binding = new Binding()
binding.a = 1
binding.setVariable('b', 2)
binding.c = 3
println binding.variables

// setup to capture standard out
def content = new StringWriter()
binding.out = new PrintWriter(content)

// evaluate the script
def ret = new GroovyShell(binding).evaluate('''
def c = 9
println 'a='+a
println 'b='+b
println 'c='+c 
retVal = a+b+c
a=3
b=2
c=1
''')

// validate the values
assert binding.a == 3
assert binding.getVariable('b') == 2
assert binding.c == 3 // binding does NOT apply to def'd variable
assert binding.retVal == 12 // local def of c applied NOT the binding!

println 'retVal='+binding.retVal
println binding.variables
println content.toString() 
```

# asp.net-mvc - 路由不工作

> ID：13767352
> 
> 赞同：1
> 
> 时间：2012-12-07T16:45:34.563
> 
> 标签：asp.net-mvc, asp.net-mvc-3, routing

网站上有常规页面，例如：

```
foo.com/about
foo.com/contact 
```

我对这些使用单个控制器。

还有管理员页面，我有一个单独的控制器：foo.com/admin/createsomething

这是我的路由配置，它没有选择 HomeController Actions。

```
 routes.MapRoute(
        name: "Default",
        url: "{action}/{id}",
        defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
    );

    routes.MapRoute(
        name: "Admin",
        url: "{controller}/{action}/{id}",
        defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
    ); 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:58:07.413

您需要打破默认约定的 url 路由：

```
routes.MapRoute(
    name: "About",
    url: "about",
    defaults: new { controller = "Home", action = "About" }
);

routes.MapRoute(
    name: "Contact",
    url: "contact",
    defaults: new { controller = "Home", action = "Contact" }
);

routes.MapRoute(
    name: "Default",
    url: "{controller}/{action}/{id}",
    defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
); 
```

那么您的管理员 url 应该使用默认路由解析，其中您有一个`AdminController`和一个`CreateSomething`操作方法

# java - Java Swing 应用程序-> servlet 的 JSON 信息，该怎么做？吗？插座？

> ID：13767357
> 
> 赞同：0
> 
> 时间：2012-12-07T16:45:41.727
> 
> 标签：java, android, json, swing, servlets

我正在使用 Eclipse Indigo 和 Tomcat 7.0。我有一个 Swing 应用程序，带有包“gui”的项目“Controller”。使用此应用程序，我正在创建一个用于“设置”机器信息的控制器工具。我有几个散列图，其中存储了 Swing 元素的信息（20 个类似的面板，但包含不同的信息，如名称、状态等）。

我想使用 servlet 创建一个 JSON 文件，其中包含这些信息（我必须以某种方式将数据获取到我的 android 应用程序，对我来说 JSON 似乎是一个不错的选择）。我的 servlet 可以通过 localhost:8080/CommunicationBase/JSONServlet 连接这就是我遇到的问题：我无法在我的 servlet 的 Dynamic-Web-Service 项目中使用我的 Swing 应用程序。

我的 servlet 的一个小例子：

```
public class JSONServlet extends HttpServlet {
    /*this is in my dynamic-web-service-project "CommunicationBase" */

    public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        JSONArray arrayObj = new JSONArray();
        arrayObj.add("Machine #1");
        arrayObj.add("Status: Down");

        PrintWriter out = response.getWriter();
        out.println(arrayObj);

        arrayObj = new JSONArray();
        arrayObj.add("Machine #2");
        arrayObj.add("Status: Running");        
    }
} 
```

如何将我的 hashmap 信息从 Swing 应用程序放到 Servlet？我可以在我的“控制器”项目中只创建一个 Java 类，然后添加一个`web.xml`? 如果是，在哪里？或者我该怎么做？

我还能以某种方式轻松地从我的 Android 应用程序更改 servlet 的 JSON 信息吗？这样我的 Swing 应用程序中的信息就会改变（Android 和 Swing 应用程序将始终在同一个 LAN 中工作）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:12:30.423

Web 应用程序（即 servlet）应该从某个数据库中获取它的信息。

Swing 应用程序应该直接从/存储到同一个数据库中的信息，而不是将其存储在 HashMaps 中，或者它应该与 Web 应用程序通信以获取/存储信息。

Android 应用程序还应该与 Web 应用程序通信以获取和修改信息。

最后，每个人都会因此获​​取信息并将其存储在同一个数据库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T18:50:17.243

安卓客户端：

```
 Socket socket = new Socket(serverIPAddress, SERVER_PORT);
            BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream(), "UTF-8"));
            String help = reader.readLine();
            JSONObject myJson = new JSONObject(help); 
```

摇摆应用：

```
 Thread thread = new Thread() {
        @Override
        public void run() {
            try {
            //  while(socket.isConnected()){

                writer = new OutputStreamWriter(socket.getOutputStream(), "UTF-8");
                reader = new BufferedReader(new InputStreamReader(socket.getInputStream(), "UTF-8"));

                JSONObject myJson = new JSONObject();
                JSONArray list = new JSONArray();
                ... //do something useful for JsonTransformation

writer.write(myJson.toString());

 }
}catch (IOException e) {
                e.printStackTrace();
            } finally {
                closeSocket();
            }
 } 
```

做了这项工作。谢谢你的帮助！

# python - 为 db tableD Django 创建别名

> ID：13767359
> 
> 赞同：1
> 
> 时间：2012-12-07T16:45:44.010
> 
> 标签：python, django, django-models

我正在尝试设计一些 Django 模型，我的问题是。

如果与我希望在模型中调用的名称不同，如何为 db 表创建别名？

```
class Person(models.Model):
    name = models.CharField(max_length=30) 
```

数据库表

```
core_Person 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T16:47:34.640

```
class Person(models.Model):
  name = models.CharField(max_length=30)

  class Meta:
    db_table = 'core_Person' 
```

来自[文档](https://docs.djangoproject.com/en/dev/ref/models/options/#db-table)：

> 要覆盖数据库表名，请使用 Meta 类中的 db_table 参数。

如果您不熟悉 Meta 选项，django 会[在此处为您提供一些有关它们的信息](https://docs.djangoproject.com/en/dev/topics/db/models/#meta-options)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T16:47:44.700

```
class Person(models.Model):
    name = models.CharField(max_length=30)

    class Meta:
        db_table = 'core_Person' 
```

# java - A* 搜索 Java - TSP

> ID：13767365
> 
> 赞同：0
> 
> 时间：2012-12-07T16:46:02.257
> 
> 标签：java, search, traveling-salesman

> **可能重复：**
> [在 Java 中实现 A 星 (A*) 算法](https://stackoverflow.com/questions/4624924/implementation-of-a-star-a-algorithm-in-java)

对于一项任务，我必须实现一些搜索算法来解决旅行商问题，我理解这个问题并且我理解算法是如何工作的，我只是不知道如何实现它（我的 Java 不是很好）但是这应该是很容易的部分，但不幸的是，我对 Java 的了解还不足以应用我对算法的了解。

因此，我想知道是否有人可以提供一些关于如何开始使用此功能的提示或技巧，或者甚至可以提供一些好的链接来阅读，如果有一个更容易开始的算法，我还必须实现一些其他算法 id be happy和那个一起去！我已经看过这里但似乎找不到任何相关的内容：/

任何帮助深表感谢！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:13:33.040

我不是专家，但我不认为 A* 可以用来解决旅行商问题。我确定您知道 TSP 是 NP 难的，因此确切的解决方案非常复杂，并且并非在每种情况下都存在。我知道（并且已经使用）近似解决方案的最简单方法是所谓的“模拟退火”，这是一种随机方法（即随机！）。

这个想法很简单。您将这些点组织成一个列表，该列表表示所有节点之间的路径（这称为“巡回”）。计算游览时间并保存长度。然后，您选择一个随机子列表并简单地反转它。计算新的长度。如果新列表较短，则保留它，否则丢弃它。只需重复这些步骤 100/1,000/10,000,000 次（取决于点数），您就会得到一个合理的近似值。

例如，假设有 5 个点（伪代码）...

```
List tour = [e, b, a, d, c]
int len = tourLength(tour)
List newTour = [e, b] + [d, a] + [c] // a and d have been reversed
int newLen = tourLength(newTour)
if(newLen < len) {
    tour = newTour
} 
```

对于 10 个点，100 次迭代应该会产生一个好的结果。

# playframework - play framework 1.2.5 绑定模型（GenericModel）异常（numberformatexception）

> ID：13767373
> 
> 赞同：0
> 
> 时间：2012-12-07T16:46:24.423
> 
> 标签：playframework, playframework-1.x

**我的模型**：

```
@Entity(name = "WORKFLOW_ROLE")
public class WorkflowRole extends GenericModel {

   @Id
   @Column(name = "IDNR", unique = true, nullable = false, precision = 22, scale = 0)
   @Required
   @Min(0)
   public long id;
} 
```

**我的控制器动作**：

```
public static void postNewRole(@Valid models.WorkflowRole role) {
    try
    {
      role.workflow = models.Workflow.findById(role.workflow.id);

      if (validation.hasErrors()) {
        params.flash(); // add http parameters to the flash scope
        validation.keep(); // keep the errors for the next request
        newRole();
      }

      role.create();
      flash.success("Rolle erstellt");
      index();
    }
    catch (Exception e)
    {
        params.flash();
        validation.keep();
        flash.put("error", e.getMessage());
        newRole();
    }
} 
```

## 现在，如果我尝试将*WorkflowRole.id*作为字符串传递给我的表单，则会出现以下异常：

```
@6chopgia8
Internal Server Error (500) for request POST /workflowrole/postnewrole

Oops: UnexpectedException
An unexpected error occured caused by exception UnexpectedException: Unexpected Error

play.exceptions.UnexpectedException: Unexpected Error
    at play.data.validation.ValidationPlugin.beforeActionInvocation(ValidationPlugin.java:80)
    at play.plugins.PluginCollection.beforeActionInvocation(PluginCollection.java:639)
    at play.mvc.ActionInvoker.invoke(ActionInvoker.java:134)
    at Invocation.HTTP Request(Play!)
Caused by: play.exceptions.UnexpectedException: Unexpected Error
    at play.db.jpa.JPAPlugin.bind(JPAPlugin.java:84)
    at play.plugins.PluginCollection.bind(PluginCollection.java:579)
    at play.data.binding.Binder.bind(Binder.java:112)
    at play.mvc.ActionInvoker.getActionMethodArgs(ActionInvoker.java:651)
    at play.data.validation.ValidationPlugin$Validator.validateAction(ValidationPlugin.java:117)
    at play.data.validation.ValidationPlugin.beforeActionInvocation(ValidationPlugin.java:72)
    ... 3 more
Caused by: java.lang.NumberFormatException: For input string: "sdf"
    at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)
    at java.lang.Long.parseLong(Long.java:410)
    at java.lang.Long.parseLong(Long.java:468)
    at play.data.binding.Binder.internalDirectBind(Binder.java:612)
    at play.data.binding.Binder.directBind(Binder.java:529)
    at play.db.jpa.JPAPlugin.bind(JPAPlugin.java:76)
    ... 8 more 
```

是否有人在 play 1.2.5 中遇到与通用模型绑定类似的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T16:12:35.737

编辑：是的，这似乎是一个错误。补丁在这里：[https ://gist.github.com/4242156](https://gist.github.com/4242156)

* * *

尝试将您的 ID 设为 Long 而不是 long - 我怀疑这就是活页夹崩溃的原因。原始变量有特殊的逻辑 - 我认为你的案例证明了一个错误。但是，我认为如果您切换到 Long 代码应该按预期工作。

通常，您应该避免使用数据库绑定对象的原始值，除非您可以 100% 确定数据库中没有空值。（但你的代码应该可以工作 - 所以有一个错误）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T07:44:19.457

确保使用 POST 而不是 GET 定义路由。您应该发布完整的代码，以便更轻松地查明问题。

# sql-server - 如何从sql中的日期时间字段中修剪日期部分

> ID：13767374
> 
> 赞同：0
> 
> 时间：2012-12-07T16:46:26.100
> 
> 标签：sql-server, tsql

我有一个显示日期和时间的字段，但我只想显示时间并想修剪所有日期部分。这是我所拥有的：

```
Field1
Dec 30 1899 10:13AM 
```

我只想显示这样的时间：

```
Field1
10:13AM 
```

我想使用更新功能来完成此操作。我怎样才能做到这一点

```
UPDATE MyTable
SET Field1=Time... 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:49:41.597

也许是这样：

```
SELECT CAST(GETDATE() AS time) 
```

没关系，忽略了上午/下午的要求。无论如何，[找到](https://stackoverflow.com/questions/3877907/time-format-in-sql-server/679449)了答案：

> ```
> SELECT ltrim(right(convert(varchar(25), getdate(), 100), 7)) 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:21:50.657

如果您确实需要使用更新（而不是选择中的格式）。

只要 Field1 是 DatTime，DataType 就会有一个日期组件。
无法通过更新删除日期。

如果您想要一个仅时间列，则创建一个时间列，例如 Time1

[时间 (Transact-SQL)](http://msdn.microsoft.com/en-us/library/bb677243.aspx)

然后

更新 mytable set Time1 = CAST(Field1 AS time)

# sql - 即使我正在检查并删除临时表，数据库错误消息中已经有一个名为“#dirs”的对象

> ID：13767377
> 
> 赞同：0
> 
> 时间：2012-12-07T16:46:31.087
> 
> 标签：sql, tsql

如果我正在检查对象是否存在并且如果存在我将删除它，我不确定为什么我会不断收到对象已经存在的消息。有人有任何线索吗？

错误信息：

消息 2714，级别 16，状态 1，过程 spCreateDirectoryStructure，第 54 行数据库中已经有一个名为“#dirs”的对象。消息 2714，级别 16，状态 1，过程 spCreateDirectoryStructure，第 74 行数据库中已经有一个名为“#dirs”的对象。

存储过程：

```
CREATE PROCEDURE spCreateDirectoryStructure
AS 
       BEGIN
             SET NOCOUNT ON;

             DECLARE @year CHAR(4)
             DECLARE @month VARCHAR(2)
             DECLARE @day VARCHAR(2)
             DECLARE @root VARCHAR(200)
             DECLARE @dir VARCHAR(200)
             DECLARE @yearDir VARCHAR(200)
             DECLARE @monthDir VARCHAR(200)
             DECLARE @dayDir VARCHAR(200)

             SET @root = 'C:\Test\'
             SET @year = DATEPART(YEAR, GETDATE())
             SET @month = DATEPART(MONTH, GETDATE())
             SET @day = DATEPART(DAY, GETDATE())
             SET @yearDir = @root + @year + '\'
             SET @monthDir = @root + @year + '\' + @month + '\'
             SET @dayDir = @root + @year + '\' + @month + '\' + @day + '\'

            -- check root folder for year folder
             IF OBJECT_ID(N'tempdb..#dirs') IS NOT NULL 
                BEGIN 
                      DROP TABLE #dirs
                END

             CREATE TABLE #dirs (Directory VARCHAR(200))

             INSERT INTO #dirs
                    EXEC master.dbo.xp_subdirs 
                        @root

             IF NOT EXISTS ( SELECT Directory
                             FROM   #dirs
                             WHERE  Directory = @year ) 
                EXEC master.sys.xp_create_subdir 
                    @yearDir

            -- **********************************************
            -- check year folder for month folder

             IF OBJECT_ID(N'tempdb..#dirs') IS NOT NULL 
                BEGIN
                      DROP TABLE #dirs
                END
             CREATE TABLE #dirs (Directory VARCHAR(200))

             INSERT INTO #dirs
                    EXEC master.dbo.xp_subdirs 
                        @yearDir

             IF NOT EXISTS ( SELECT Directory
                             FROM   #dirs
                             WHERE  Directory = @month ) 
                EXEC master.sys.xp_create_subdir 
                    @monthDir

            -- **********************************************
            -- check month folder for day folder

             IF OBJECT_ID(N'tempdb..#dirs') IS NOT NULL 
                BEGIN
                      DROP TABLE #dirs
                END
             CREATE TABLE #dirs (Directory VARCHAR(200))

             INSERT INTO #dirs
                    EXEC master.dbo.xp_subdirs 
                        @monthDir

             IF NOT EXISTS ( SELECT Directory
                             FROM   #dirs
                             WHERE  Directory = @day ) 
                EXEC master.sys.xp_create_subdir 
                    @dayDir
       END
GO 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:49:01.310

#dirs 在编译存储过程时存在。

只需删除表，然后您就可以创建存储过程。

由于您无论如何都在创建表，请考虑将其声明为局部变量：

```
declare @dirs table (directory varchar(200)) 
```

当局部变量超出范围时（存储过程退出时），局部变量将被自动删除。然后您不必担心清理临时目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:03:13.937

你的问题是你有

```
 CREATE TABLE #dirs (Directory VARCHAR(200)) 
```

**三次**。在解析 TSQL 批处理时，SQL Server 看到第二个并静态确定它将在第二次左右存在。

我的建议是不要对其进行测试，创建一次（在最顶部），而是在每次使用前将其清除。仅供参考，即使您在调用此 SP 的会话中有一个#dirs，也会在 SP 的上下文中创建另一个，并且它将在 SP 结束时超出范围。

```
CREATE PROCEDURE spCreateDirectoryStructure
AS 
             DECLARE @year CHAR(4)
             DECLARE @month VARCHAR(2)
             DECLARE @day VARCHAR(2)
             DECLARE @root VARCHAR(200)
             DECLARE @dir VARCHAR(200)
             DECLARE @yearDir VARCHAR(200)
             DECLARE @monthDir VARCHAR(200)
             DECLARE @dayDir VARCHAR(200)

             SET @root = 'C:\Test\'
             SET @year = DATEPART(YEAR, GETDATE())
             SET @month = DATEPART(MONTH, GETDATE())
             SET @day = DATEPART(DAY, GETDATE())
             SET @yearDir = @root + @year + '\'
             SET @monthDir = @root + @year + '\' + @month + '\'
             SET @dayDir = @root + @year + '\' + @month + '\' + @day + '\'

             CREATE TABLE #dirs (Directory VARCHAR(200))

             INSERT INTO #dirs
                    EXEC master.dbo.xp_subdirs 
                        @root

             IF NOT EXISTS ( SELECT Directory
                             FROM   #dirs
                             WHERE  Directory = @year ) 
                EXEC master.sys.xp_create_subdir 
                    @yearDir

            -- **********************************************
            -- check year folder for month folder

             TRUNCATE TABLE #dirs
             INSERT INTO #dirs
                    EXEC master.dbo.xp_subdirs 
                        @yearDir

             IF NOT EXISTS ( SELECT Directory
                             FROM   #dirs
                             WHERE  Directory = @month ) 
                EXEC master.sys.xp_create_subdir 
                    @monthDir

            -- **********************************************
            -- check month folder for day folder

             TRUNCATE TABLE #dirs
             INSERT INTO #dirs
                    EXEC master.dbo.xp_subdirs 
                        @monthDir

             IF NOT EXISTS ( SELECT Directory
                             FROM   #dirs
                             WHERE  Directory = @day ) 
                EXEC master.sys.xp_create_subdir 
                    @dayDir
GO 
```

# jquery - 如何在jQuery中与实时更改功能和外部照片更改建立关系？

> ID：13767380
> 
> 赞同：0
> 
> 时间：2012-12-07T16:47:00.090
> 
> 标签：jquery

我目前正在使用以下函数在 HTML 选择选项的更改事件中设置超时...

```
jQuery(function($) {
var mselect = $("#myselect");
mselect.live('change',function () {
window.setTimeout(function () {
console.log("the new value is now: "+nextQuery(".nextSKU").text());
},3000);
});
}); 
```

每次我的选择选项更改时，我几乎都会为一个项目写一个 sku 编号，并为延迟效果写一个 setTimeOut。但是我怎样才能将我的 setTimeOut 替换为更有效的东西......意思是，当我的产品图像的 src 更新时，我想执行 console.log(....)。如果我的图像元素看起来像这样，我该怎么做...

```
<img id="imgLargeImageImage" class="nextProdImage" itemprop="image" src="http://.../.../.../SHT-GD-M-SM1.jpg" alt="Gold Shirt"> 
```

当图像根据您选择的选择发生变化时，<img> 标签将像这样更改 src...

```
<img id="imgLargeImageImage" class="nextProdImage" itemprop="image" src="http://.../.../.../SHT-GD-N-394.jpg" alt="BLUE Shirt"> 
```

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:51:37.337

> 当我的产品图像的 src 更新时，我想执行 console.log(....)。

然后你会想要在图像加载时绑定实际的日志调用。

```
$('img.nextProdImage').load(function (e) {
   console.log("the new value is now: "+nextQuery(".nextSKU").text());
});
$("#myselect").live('change', function (e) {
   // set the new image src based on the selected SKU
}); 
```

唯一需要注意的是，您需要确保获得正确的 SKU 以进行记录。我不确定下一个 SKU 是什么或它是如何存储的，但您可能会考虑将其存储在`data`属性中。我也会转移`itemprop`到数据属性，而不是使用这样的自定义道具：

```
<img id="imgLargeImageImage" class="nextProdImage" data-itemprop="image" data-sku="SHT-GD-N-394" src="http://.../.../.../SHT-GD-N-394.jpg" alt="BLUE Shirt" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T16:57:11.547

```
 var img_url = 'http://.../.../.../';
       jQuery(function($){
         var mselect = $("#myselect");
         mselect.live('change',function () {
        window.setTimeout(function () {
            console.log("the new value is now: "+nextQuery(".nextSKU").text());
            //this is how you can channge the image path
            var img_name = mselect.val(); //your drop down should have image name as values. 
            mselect.attr('src',image_url+img_name);//set the new image path.

          },3000);
    });
}); 
```

# java - 在另一个类中调用抽象类的静态方法

> ID：13767386
> 
> 赞同：-2
> 
> 时间：2012-12-07T16:47:30.787
> 
> 标签：java, inheritance, static

我有一个班级员工

```
import javax.swing.*;
public abstract  class Employee {
    public static void  searchEmp(int id) {
        JOptionPane.showMessageDialog(null, "done");
    }
} 
```

现在我有另一个班级测试：

```
public class `test` {
   public static void main(String args[]) {
     searchEmp(2);// here my programme give error
   }
} 
```

我想`searchEmp()`从类测试中调用 which 是 Employee 的一部分，但它给出了一个错误。请提出任何没有继承的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T16:49:44.407

你必须打电话`Employee.searchEmp()`。

静态方法`searchEmp()`仍然是该类的成员，`Employee`您必须通过其类进行静态调用。

此外，该类`Employee`必须对该类可见`test`，否则您必须导入它。我假设这两个类驻留在同一个包中，因此在您的情况下这不会成为问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T16:51:47.350

静态方法和属性绑定到**类**。所以你需要使用`ClassName.methodName`or `ClassName.propertyName`。

```
Employee.searchEmp(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T16:51:21.313

您的 Test 类没有静态 searchEmp(int) 方法，因此出现错误：

```
 searchEmp(2);// here my programme give error 
```

应该

```
Employee.searchEmp(2); 
```

使用静态方法调用`ClassName.staticMethod()`

# objective-c - 以编程方式打开 UIView iOS

> ID：13767388
> 
> 赞同：0
> 
> 时间：2012-12-07T16:47:38.457
> 
> 标签：objective-c, ios

每次如果状态正确，我都想打开一个窗口。问题是，如果我在按钮上使用它而不是在加载时，代码就可以工作。错误代码表示视图不在窗口层次结构中。

```
 info *vs = [self.storyboard instantiateViewControllerWithIdentifier:@"run"];
   [self presentViewController:vs animated:YES completion:nil]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:08:42.990

我做了一个不可重复的计时器来加载一个打开另一个视图的函数。它有点奇怪，但它完成了工作。

# tomcat - 在哪里存储 *.class servlet？

> ID：13767390
> 
> 赞同：0
> 
> 时间：2012-12-07T16:47:46.803
> 
> 标签：tomcat

我安装了 Centos 6.3 作为工作站。在安装过程中，JDK 和 Tomcat 6 都作为包含的软件包的一部分进行了安装。我应该在哪里放置 *.class 文件？我应该用来访问 servlet 的 url 是什么？

我试图在网上搜索，但找不到一个具体的解决方案，这增加了我正在阅读的书中的混乱。

在此先感谢，迈克

# c++ - 关于 `this` 关键字的说明

> ID：13767394
> 
> 赞同：0
> 
> 时间：2012-12-07T16:48:10.740
> 
> 标签：c++, pointers, this

对不起，如果这是一个微不足道的问题：

实施1：

```
class Foo
{
    protected: int bar;

    public: Foo(int bar)
      {
        this->bar =bar;
      }
}; 
```

实施2：

```
class Foo
{
    protected: int bar;

    public: Foo(int bar)
      {
        this.bar =bar;
      }
}; 
```

实施 2 的输出：

`request for member ‘x’ in ‘this’, which is of pointer type ‘Foo* const’ (maybe you meant to use ‘->’ ?)`

`this`指针也是，这个[问题](https://stackoverflow.com/questions/23250/when-do-you-use-the-this-keyword)在代码中有语法错误

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T16:49:15.747

您所指的问题包含用 C# 而不是 C++ 编写的代码示例。是的，在 C++ 中，`this`是一个指针，必须取消引用才能访问它指向的对象的任何成员。

# dynamics-gp - 通过 eConnect 确定客户的账户余额？

> ID：13767395
> 
> 赞同：3
> 
> 时间：2012-12-07T16:48:13.960
> 
> 标签：dynamics-gp

我在使用 eConnect 与 Dynamics GP 交互的 Web 应用程序上工作。具体来说，当通过我们的在线商店处理订单时，我们会使用 eConnect 向 GP 提交发票。

我们的一些客户在账户中，他们的账户余额保存在 GP 中。我们希望能够在购买时确定客户的当前账户余额，以便我们可以拒绝购买，如果这会使他们的账户出现亏损。

有没有办法使用 eConnect 来确定客户的当前账户余额？我在网上搜索了高低，没有太多运气。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-09T22:54:16.600

虽然我不能推荐通过 eConnect 的方式，但您可以通过查询[`RM00103`](http://www.gptablereference.com/2010/Table/RM00103)表通过 SQL 访问客户余额。

```
SELECT CUSTBLNC as CustomerBalance
FROM RM00103
WHERE CUSTNMBR = @CustomerNo 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-24T08:12:09.147

@有没有办法使用 eConnect 来确定客户的当前账户余额？

不，没有 eConnect 来确定客户当前余额。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-24T08:17:44.543

正确的客户编号字段是 CUSTNMBR

从 RM00103 选择 CUSTBLNC 作为 CustomerBalance，其中**CUSTNMBR** = 'XYZ'

# c# - 如何抑制 ReSharper 建议将我的 foreach 循环转换为 LINQ 表达式的单个实例？

> ID：13767400
> 
> 赞同：3
> 
> 时间：2012-12-07T16:48:28.257
> 
> 标签：c#, resharper

通常，如果我不同意 ReSharper 建议的某些代码转换，则操作列表中有一个选项可以通过在代码中添加注释来抑制建议。以下是这些评论的一些示例：

```
// ReSharper disable UseObjectOrCollectionInitializer
var addresses = new MailAddressCollection();
// ReSharper restore UseObjectOrCollectionInitializer 
```

和

```
// ReSharper disable ReturnTypeCanBeEnumerable.Local
private static MailAddressCollection GetEventStatusNotificationRecipients(UserAccountProfile submitter, 
    UserAccountProfile projectPrincipalInvestigator)
// ReSharper restore ReturnTypeCanBeEnumerable.Local 
```

我不知道为什么，但“循环的部分主体可以转换为 LINQ 表达式”规则的操作列表不包含禁止 ReSharper 建议的选项。我已经尝试将其转换为 LINQ 表达式，以查看它产生的输出类型。它把一个清晰的 foreach 循环变成了混淆的垃圾，所以我恢复了这个变化。但是，我希望能够压制该消息。有没有办法抑制建议（除了完全关闭规则，我不想这样做，因为可能存在将循环体转换为 LINQ 表达式有意义的其他情况）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T19:14:11.660

我不确定，但尝试手动插入

```
// ReSharper disable LoopCanBePartlyConvertedToQuery
...
// ReSharper restore LoopCanBePartlyConvertedToQuery 
```

围绕你的代码

# javascript - how can i add a background color to a layer kineticjs?

> ID：13767405
> 
> 赞同：1
> 
> 时间：2012-12-07T16:48:48.353
> 
> 标签：javascript, html, canvas, kineticjs

How can I add a background color to a layer in kineticjs? I want to have multiple layers which have different background colors.

Something like:

```
var layer = new Kinetic.Layer({
                x: 0,
                y: 0,
                width : that.locationData.getCreativeLeftLoc(),
                height : that.locationData.getCreativeTopLoc(),
                background-color : 'black'
            }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T16:55:20.537

You can't. See the [docs](http://kineticjs.com/docs/Kinetic.Layer.html).

It goes `Node` > `Container` > `Layer`, none of which support drawing to themselves. They serve only to group other kinetic objects.

# jquery - jqGrid：问题加载具有本地数据类型的嵌套子网格

> ID：13767408
> 
> 赞同：4
> 
> 时间：2012-12-07T16:48:59.593
> 
> 标签：jquery, jqgrid, nested, subgrid

我试图让嵌套子网格使用 jqGrid 与本地数据一起工作。我已经搜索了很多，但无法找到解决方案。这是我的代码的简化示例：

```
var mainGridData =
    [
        // main grid data
        { id: "m1", col1: "11", col2: "12" },
        { id: "m2", col1: "21", col2: "22" },
        { id: "m3", col1: "31", col2: "32" }
    ];
var firstSubgrid =
    {
        m1: [
            // data for subgrid for the id=m1
            { id: "s1a", c1: "aa", c2: "ab", c3: "ac" },
            { id: "s1b", c1: "ba", c2: "bb", c3: "bc" },
            { id: "s1c", c1: "ca", c2: "cb", c3: "cc" }
        ],
        m2: [
            // data for subgrid for the id=m2
            { id: "s2a", c1: "xx", c2: "xy", c3: "xz" }
        ]
    };
var secondSubgrid =
    {
        s1a: [
            // data for subgrid for the id=m1
            { id: "2s1a", d1: "2aa", d2: "2ab", d3: "2ac" },
            { id: "2s1b", d1: "2ba", d2: "2bb", d3: "2bc" },
            { id: "2s1c", d1: "2ca", d2: "2cb", d3: "2cc" }
        ],
        s2a: [
            // data for subgrid for the id=m2
            { id: "2s2a", d1: "xx", d2: "xy", d3: "xz" }
        ]
    };

//------------
$("#grid").jqGrid({
    datatype: 'local',
    data: mainGridData,
    colNames: ['Column 1', 'Column 2'],
    colModel: [
        { name: 'col1', width: 200 },
        { name: 'col2', width: 200 }
    ],
//Subgrid1...
    subGrid: true,
    subGridRowExpanded: function (subgridDivId, rowId) {
        var subgridTableId = subgridDivId + "_t";
        $("#" + subgridDivId).html("<table id='" + subgridTableId + "'></table>");
        $("#" + subgridTableId).jqGrid({
            datatype: 'local',
            data: firstSubgrid[rowId],
            colNames: ['Col 1', 'Col 2', 'Col 3'],
            colModel: [
                { name: 'c1', width: 100 },
                { name: 'c2', width: 100 },
                { name: 'c3', width: 100 }
            ],
      //Subgrid2...    
            subGrid: true,
            subGridRowExpanded: function (subgrid2DivId, subRowId2) {
                var subgrid2TableId = subgrid2DivId + "_t";
                $("#" + subgrid2DivId).html("<table id='" + subgrid2DivId + "'></table>");
                $("#" + subgrid2TableId).jqGrid({
                    datatype: 'local',
                    data: secondSubgrid[subRowId2],
                    colNames: ['Col 1', 'Col 2', 'Col 3'],
                    colModel: [
                        { name: 'd1', width: 100 },
                        { name: 'd2', width: 100 },
                        { name: 'd3', width: 100 }
                    ],
                });

            }                
        });
    }
}); 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-08T16:52:25.343

我觉得你的问题很有趣。我认为答案可能对其他人有帮助。所以我写了两个演示来演示如何实现需求。

![在此处输入图像描述](../Images/a6947412073c691e49abc1dd2e8f68f7.png)

[第一个演示](http://www.ok-soft-gmbh.com/jqGrid/LocalSubgridMultileve1.htm)基于[我之前的答案](https://stackoverflow.com/a/10178440/315935)中的演示（基于[另一个](https://stackoverflow.com/a/9165978/315935)），您使用的代码已在问题文本中使用。[我还添加了答案](https://stackoverflow.com/a/4538656/315935)中的技巧，以隐藏没有子网格的行的子网格图标（“+”）。

为了简化子网格数据的保存，我在每个行`subgrid`属性中添加了哪些值是子网格的数据。保存数据的方式非常实用，因为 jqGrid 保存了行的全部项目，因此您不再需要任何隐藏列。要访问本地数据，我建议使用`getLocalRow`方法。例如，请参阅[答案](https://stackoverflow.com/a/9145342/315935)以获取其他信息或非常简单的方法[的源代码。](https://github.com/tonytomov/jqGrid/blob/v4.4.1/js/grid.base.js#L3534-L3545)`getLocalRow`

第一个demo的代码：

```
var myData = [
        // main grid data
        { id: "m1", col1: "11", col2: "12",
            subgrid: [
                // data for subgrid for the id=m1
                { id: "s1a", c1: "aa", c2: "ab", c3: "ac",
                    subgrid: [
                        // data for subgrid for the id=m1, subgridId=s1a
                        { id: "2s1a", d1: "2aa", d2: "2ab", d3: "2ac" },
                        { id: "2s1b", d1: "2ba", d2: "2bb", d3: "2bc" },
                        { id: "2s1c", d1: "2ca", d2: "2cb", d3: "2cc" }
                    ]},
                { id: "s1b", c1: "ba", c2: "bb", c3: "bc" },
                { id: "s1c", c1: "ca", c2: "cb", c3: "cc" }
            ]},
        { id: "m2", col1: "21", col2: "22",
            subgrid: [
                // data for subgrid for the id=m2
                { id: "s2a", c1: "xx", c2: "xy", c3: "xz",
                    subgrid: [
                        // data for subgrid for the id=m2, subgridId=s2a
                        { id: "2s2a", d1: "xx", d2: "xy", d3: "xz" }
                    ]}
            ]},
        { id: "m3", col1: "31", col2: "32" }
    ],
    removeSubgridIcon = function () {
        var $this = $(this);
        $this.find(">tbody>tr.jqgrow>td.ui-sgcollapsed").filter(function () {
            var rowData = $this.jqGrid("getLocalRow",
                    $(this).closest("tr.jqgrow").attr("id"));
            return rowData.subgrid == null;
        }).unbind("click").html("");
    },
    isHasSubrids = function (data) {
        var l = data.length, i;
        for (i = 0; i < l; i++) {
            if (data[i].subgrid != null) {
                return true;
            }
        }
        return false;
    };

$("#list").jqGrid({
    datatype: "local",
    data: myData,
    colNames: ["Column 1", "Column 2"],
    colModel: [
        { name: "col1", width: 200 },
        { name: "col2", width: 200 }
    ],
    gridview: true,
    rownumbers: true,
    autoencode: true,
    sortname: "col1",
    sortorder: "desc",
    height: "100%",
    pager: "#pager",
    caption: "Demonstrate how to create subgrid from local hierarchical data",
    subGrid: isHasSubrids(myData),
    loadComplete: function () {
        removeSubgridIcon.call(this);
    },
    subGridRowExpanded: function (subgridDivId1, rowId1) {
        var $subgrid1 = $("<table id='" + subgridDivId1 + "_t'></table>"),
            localRowData1 = $(this).jqGrid("getLocalRow", rowId1);
        $subgrid1.appendTo("#" + $.jgrid.jqID(subgridDivId1));
        $subgrid1.jqGrid({
            datatype: "local",
            data: localRowData1.subgrid,
            colNames: ["Colunm1", "Colunm2", "Colunm3"],
            colModel: [
                { name: "c1", width: 112 },
                { name: "c2", width: 112 },
                { name: "c3", width: 112 }
            ],
            gridview: true,
            rownumbers: true,
            autoencode: true,
            sortname: "c1",
            sortorder: "desc",
            height: "100%",
            loadComplete: removeSubgridIcon,
            subGrid: isHasSubrids(localRowData1.subgrid),
            subGridRowExpanded: function (subgridDivId2, rowId2) {
                var $subgrid2 = $("<table id='" + subgridDivId2 + "_t'></table>"),
                    localRowData2 = $(this).jqGrid("getLocalRow", rowId2);
                $subgrid2.appendTo("#" + $.jgrid.jqID(subgridDivId2));
                $subgrid2.jqGrid({
                    datatype: "local",
                    data: localRowData2.subgrid,
                    colNames: ["Col 1", "Col 2", "Col 3"],
                    colModel: [
                        { name: "d1", width: 90 },
                        { name: "d2", width: 90 },
                        { name: "d3", width: 90 }
                    ],
                    gridview: true,
                    rownumbers: true,
                    autoencode: true,
                    sortname: "d1",
                    sortorder: "desc",
                    height: "100%",
                    subGrid: isHasSubrids(localRowData2.subgrid),
                    loadComplete: removeSubgridIcon
                });
            }
        });
    }
}); 
```

[第二个演示](http://www.ok-soft-gmbh.com/jqGrid/LocalSubgridMultileve2.htm)是对上一个演示的更深入的修改。它可以用于创建非常深的多级子网格。我在演示中使用了额外的密集`idPrefix`来简化 id 的使用。我建议在第一个演示和第二个演示中比较数组`id`项的属性值。`myData`第二个演示的代码如下

```
var myData = [
        // main grid data
        { id: "1", col1: "11", col2: "12",
            subgrid: [
                // data for subgrid for the id=m1
                { id: "1", c1: "aa", c2: "ab", c3: "ac",
                    subgrid: [
                        // data for subgrid for the id=m1, subgridId=s1a
                        { id: "1", d1: "2aa", d2: "2ab", d3: "2ac" },
                        { id: "2", d1: "2ba", d2: "2bb", d3: "2bc" },
                        { id: "3", d1: "2ca", d2: "2cb", d3: "2cc" }
                    ]},
                { id: "2", c1: "ba", c2: "bb", c3: "bc" },
                { id: "3", c1: "ca", c2: "cb", c3: "cc" }
            ]},
        { id: "2", col1: "21", col2: "22",
            subgrid: [
                // data for subgrid for the id=m2
                { id: "1", c1: "1xx", c2: "1xy", c3: "1xz",
                    subgrid: [
                        // data for subgrid for the id=m2, subgridId=s2a
                        { id: "1", d1: "2xx", d2: "2xy", d3: "2xz" }
                    ]}
            ]},
        { id: "3", col1: "31", col2: "32" }
    ],
    removeSubgridIcon = function () {
        var $this = $(this),
            idPrefix = $this.jqGrid("getGridParam", "idPrefix");
        $this.find(">tbody>tr.jqgrow>td.ui-sgcollapsed").filter(function () {
            var rowData = $this.jqGrid("getLocalRow",
                    $.jgrid.stripPref(idPrefix, $(this).closest("tr.jqgrow").attr("id")));
            return rowData.subgrid == null;
        }).unbind("click").html("");
    },
    isHasSubrids = function (data) {
        var l = data.length, i;
        for (i = 0; i < l; i++) {
            if (data[i].subgrid != null) {
                return true;
            }
        }
        return false;
    },
    specificGridOptions = [
        {
            colNames: ["Column 1", "Column 2"],
            colModel: [
                { name: "col1" },
                { name: "col2" }
            ],
            cmTemplate: { width: 200 },
            sortname: "col1",
            sortorder: "desc",
            idPrefix: "s_",
            pager: "#pager",
            caption: "Demonstrate how to create subgrid from local hierarchical data"
        },
        {
            colNames: ["Colunm1", "Colunm2", "Colunm3"],
            colModel: [
                { name: "c1" },
                { name: "c2" },
                { name: "c3" }
            ],
            cmTemplate: { width: 112 },
            sortname: "c1",
            sortorder: "desc"
        },
        {
            colNames: ["Col 1", "Col 2", "Col 3"],
            colModel: [
                { name: "d1" },
                { name: "d2" },
                { name: "d3" }
            ],
            cmTemplate: { width: 90 },
            sortname: "d1",
            sortorder: "desc"
        }
    ],
    commonGridOptions = {
        datatype: "local",
        gridview: true,
        rownumbers: true,
        autoencode: true,
        height: "100%",
        loadComplete: function () {
            // one can use loadComplete: removeSubgridIcon, but I included
            // curent implementation of loadComplete only to show how to call
            // removeSubgridIcon from your loadComplete callback handler
            removeSubgridIcon.call(this);
        },
        subGridRowExpanded: function (subgridDivId, rowId) {
            var $subgrid = $("<table id='" + subgridDivId + "_t'></table>"),
                subgridLevel = $(this).jqGrid("getGridParam", "subgridLevel") + 1,
                parentIdPrefix = $(this).jqGrid("getGridParam", "idPrefix"),
                pureRowId = $.jgrid.stripPref(parentIdPrefix, rowId),
                localRowData = $(this).jqGrid("getLocalRow", pureRowId);
            $subgrid.appendTo("#" + $.jgrid.jqID(subgridDivId));
            $subgrid.jqGrid($.extend(true, {}, commonGridOptions, specificGridOptions[subgridLevel], {
                data: localRowData.subgrid,
                subGrid: isHasSubrids(localRowData.subgrid),
                subgridLevel: subgridLevel,
                idPrefix: rowId + "_",
                rowNum: 10000 // we use this to have no pager in the subgrids
            }));
        }
    };

$("#list").jqGrid($.extend(true, {}, commonGridOptions, specificGridOptions[0], {
    data: myData,
    subgridLevel: 0,
    subGrid: isHasSubrids(myData)
})); 
```

# eclipse-plugin - Makegood：执行 PHPUnit 时找不到类“Memcache”

> ID：13767412
> 
> 赞同：0
> 
> 时间：2012-12-07T16:49:13.940
> 
> 标签：eclipse-plugin, phpunit, makegood

我想使用 MakeGood[1] 在我的 Eclipse 中执行 PHPUnit-Tests。本地 PHPUnit-setup 完成，我可以成功执行测试。

但是当通过 MakeGood 启动 PHPUnit-Test 时，它会停在

```
new Memcache(); 
```

其中“Memcache”是 pecl 扩展。错误消息是“致命错误：找不到类 'Memcache'”。

如何在 MakeGood 中运行测试？

[1] [http://piece-framework.com/projects/makegood](http://piece-framework.com/projects/makegood)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:08:41.717

您正在使用内部 PEAR 库并且没有安装 MemCache。您必须使用您的 PEAR 文件夹作为源来创建用户库。有关更多详细信息，[请参阅此页面](http://www.eclipse.org/pdt/help/html/editing_php_user_libraries.htm)。

# php - 将包含键和值的数组转换为字符串

> ID：13767416
> 
> 赞同：0
> 
> 时间：2012-12-07T16:49:20.787
> 
> 标签：php, arrays, string

我有一个包含键和值的数组。我想转换成字符串。

```
array(
 [business_type]=>'cafe'
 [business_type_plural] => 'cafes'
 [sample_tag]=>'couch'
 [business_name]=>'couch cafe'
 ) 
```

预期输出：

```
business_type,cafe|business_type_plural,cafes|sample_tag,couch|business_name,couch cafe 
```

笔记：

我在 StackOverflow 中搜索并找到了以下问题并且它有答案。我想要完全相反的一个。

[将包含键和值的字符串转换为数组](https://stackoverflow.com/questions/4033282/converting-string-containing-keys-and-values-into-array)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:51:56.743

尝试

```
$data = array();
foreach($arr as $key=>$value) {
  $data[] = $key.','.$value;
}
echo implode('|',$data); 
```

另一个解决方案：

```
function test_alter(&$item1, $key, $delimiter)
{
    $item1 = "$key".$delimiter."$item1";
}

array_walk($arr, 'test_alter',',');
echo implode('|',$arr); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T16:51:26.480

使用该`foreach()`函数遍历数组并将键/值串在一起......

假设您的数组被调用`$array`

```
$result = "";
foreach($array as $key => $value){
    $result .= $key . "," . $value . "|";
} 
```

就这么简单。

编辑 - 谢谢**尼尔森**

在那之后，失去了最后`|`

```
$result = rtrim($result, "|"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T16:53:24.460

试试这个

```
$pieces=array();
foreach(array('key1'=>'val1', 'key2'=>'val2', 'key3'=>'val3') as $k=>$v)
{
    $pieces[]=$k.','.$v;
}
echo implode('|', $pieces); 
```

# knockout.js - knockout.js - 计算项何时重新计算依赖项？

> ID：13767417
> 
> 赞同：1
> 
> 时间：2012-12-07T16:49:25.373
> 
> 标签：knockout.js, computed-observable

假设你有以下js：

```
 var vm = {
    objects: ko.observable([]),
    objectCount: ko.computed(function(){
      return vm && vm.objects().length;
    }),

    add: function() {
      var current = vm.objects();
      current.push({});      
      console.log('current is', current);
      vm.objects(current);
      console.log("should recalculate here", vm.objectCount());
    }
  }; 
```

以及以下html：

```
 <ul data-bind="foreach: objects">
    <li>
      Object: <span data-bind="text: $index"></span>
    </li>
  </ul>
  <button data-bind="click: add">Add Object</button>
  <p>
    Total number of objects:
    <span data-bind="text: objectCount"></span>
  </p> 
```

[从阅读文档](http://knockoutjs.com/documentation/computedObservables.html#how_dependency_tracking_works)中我的理解是，因为在我添加了一个调用 objectCount() 的对象后，它应该重新计算它的依赖关系。相反，它似乎甚至从未执行过该功能，只运行一次！

[JSBin 演示了我的问题的简化版本。](http://jsbin.com/welcome/58741/edit)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T17:07:57.387

在定义你的 viewModel 工作后定义你的计算 - [http://jsbin.com/welcome/58760/](http://jsbin.com/welcome/58760/) - 它发生是因为计算的 observables 的工作方式（来自 ko docs）。

1.  每当你声明一个计算的 observable 时，KO 立即调用它的求值函数来获取它的初始值。
2.  当您的评估器功能运行时，KO 会记录您的评估器读取其值的任何可观察对象（或计算的可观察对象）。
3.  当你的评估器完成后，KO 为你接触过的每个可观察对象（或计算的可观察对象）设置订阅。订阅回调设置为使您的
    评估程序再次运行，
    将整个过程循环回第 1 步（处理任何
    不再适用的旧订阅）。
4.  KO 通知任何订阅者你计算的 observable 的新值。

在 vm 对象中实例化 observable 时，其他属性还不存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T17:03:37.357

这只是一个范围界定问题。如果您将脚本代码重构为如下所示：

```
$(function(){
  var vm = function(){
    var self = this;

    self.objects = ko.observable([]);
    self.objectCount = ko.computed(function(){
      return self.objects().length;
    });

    self.add = function() {
      var current = self.objects();
      current.push({});      
      console.log('current is', current);
      self.objects(current);
      console.log("should recalculate here", self.objectCount());
    };
  };

  ko.applyBindings(new vm());
}); 
```

然后确定正确的变量范围，并且 Knockout 正确计算依赖关系。如[guigouz](https://stackoverflow.com/a/13767716/11702)所述，`ko.computed`最初调用的`vm`时间是未定义的，因此它无法设置任何更改处理程序。

这是[更新的 JSBin](http://jsbin.com/welcome/58745/edit)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T20:55:41.713

`deferEvaluation`另一种方法是使用`ko.computed`. 这将告诉 Knockout 等待计算计算的 observable 直到它第一次使用。到那时，`vm`将被定义。

```
objectCount: ko.computed(function(){
  return vm && vm.objects().length;
}, null, { deferEvaluation: true }), 
```

# vb.net - 在 VB.NET 中从 MDI 父窗体调整子窗体的公共变量

> ID：13767423
> 
> 赞同：1
> 
> 时间：2012-12-07T16:50:02.753
> 
> 标签：vb.net, forms, global-variables, mdichild, mdiparent

我有一个 MDI 父表单，它可以打开一个名为“Order”的子表单。订单表格有一个按钮，允许用户打印订单。Order 表单在开头定义了一个打印尺寸变量：

```
Public Class Order

Public psize As String 

    Private Sub button_order_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles process_order.Click
  ' Code to handle the order and then print, etc 
```

现在父表单也有一个`psize`变量，默认设置为“A4”。只有当有人单击父窗口菜单条上的菜单项之一时才会发生这种情况：

```
psize = "A6" 
```

默认情况下，每当父窗口打开一个新的订单表单时，我需要它将子表单的`psize`变量设置为自己的`psize`值。像这样的东西：

```
 Dim f As Form
    f = New Order
    f.MdiParent = Me
    f.psize = Me.psize ' BUT THIS LINE DOESN'T WORK
    f.Show() 
```

我收到 f.psize 不是表单成员的错误。我知道在 MDI 父级和子级之间传递变量是很常见的，但是尽管尝试了我在这里看到的一些选项，但它似乎并没有起作用。这是错误的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:14:59.230

该属性不可用的原因是您使用了错误的变量类型。基本`Form`类型没有定义该属性。相反，您的派生`Order`类型可以。你可以这样做：

```
Dim f As Order
f = New Order
f.MdiParent = Me
f.psize = Me.psize
f.Show() 
```

**更新**

正如您在下面的评论中所说，您真正需要做的是能够在所有表单之间共享动态设置，以便您可以随时更改设置并使其影响所有已显示的表单。最好的方法是创建一个存储所有共享设置的新类，例如：

```
Public Class Settings
    Public PaperSize As String = "A6"
End Class 
```

如您所见，通过这样做，您可以轻松地将所有默认设置集中在设置类中，这是一个额外的好处。然后，您需要将`Order`表单中的公共属性更改为新`Settings`类型，例如：

```
Public Class Order
    Inherits Form

    Public Settings As Settings
End Class 
```

然后，您需要在 MDI 父窗体中创建共享设置对象，然后在创建时将其传递给每个`Order`窗体：

```
Public Class MyParentForm
    Private _settings As New Settings()

    Private Sub ShowNewOrderForm()
        Dim f As New Order()
        f.MdiParent = Me
        f.Settings = _settings
        f.Show()
    End Sub

    Private Sub ChangePaperSize(size As String)
        _settings.PaperSize = size
    End Sub
End Class 
```

然后，由于父表单和所有子`Order`表单共享同一个`Settings`对象，并且对该对象所做的更改`Settings`将立即被所有表单看到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T17:16:09.573

改变这个：

```
Dim f As Form 
```

到您的表单的实际实现：

```
Dim f As Order 
```

或者只是捷径：

```
Dim f As New Order 
```

# objective-c - 如何解码 NSString UTF-8

> ID：13767426
> 
> 赞同：-1
> 
> 时间：2012-12-07T16:50:07.443
> 
> 标签：objective-c, ios, json

我正在使用从 API`SBJSONParser`解析 a 。`JSON`我得到以下内容`title = "F\U00c3\U00b6rdermittel";`，它已经是 UTF-8 编码的`SBJSONParser`。字符串应该是 'Fördermittel' 但我得到`FÃ¶rdermittel`. 我打电话`[dict objectForKey:@"title"];`来获取字符串。

我在谷歌上找到的只是，`[NSString stringWithUTF8String:(const char *)]`但我有一个`NSString`对象不是`char`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:54:57.337

NSString API 中没有直接解码 UTF-8 NSString 的方法，所以首先必须将其转换为 C 字符串

```
NSString *encodedString;
NSString *decodedString = [NSString stringWithUTF8String:[encodedString cStringUsingEncoding:[NSString defaultCStringEncoding]]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T19:34:23.057

如果您正在为 iOS5 进行部署，我建议使用 JSON 解析器中的构建。

# iphone - 表视图算法

> ID：13767429
> 
> 赞同：0
> 
> 时间：2012-12-07T16:50:23.483
> 
> 标签：iphone, xcode

这是我的表格视图单元格加载代码：

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        [[NSBundle mainBundle] loadNibNamed:@"CellView" owner:self options:nil];
        cell = nibLoadedCell;
    }

    if (photosArray.count > 0) {
        for (int i = 1; i < 4; i++) {                
            UIButton *button = (UIButton *)[cell viewWithTag:i];
            [button addTarget:self action:@selector(buttonPressed:) forControlEvents:UIControlEventTouchUpInside];
            button.layer.borderWidth = 2;
            button.layer.cornerRadius = 5;
            button.clipsToBounds = YES;

            //Add images to the button
            UIImage *btnImg;
            if ((indexPath.row * 3) + i < photosArray.count) {
                btnImg = [photosArray objectAtIndex:((indexPath.row) * 3 + i)];
                NSLog(@"%d",(indexPath.row) * 3 + i);
            }

            [button setBackgroundImage:btnImg forState:UIControlStateNormal];
            button.tag = imageButtonTag;
            imageButtonTag--;                
        }
    }
    NSLog(@"%d",cell.contentView.subviews.count);
    for (UIButton *button in cell.contentView.subviews) {

        if ([button backgroundImageForState:UIControlStateNormal] == nil) {
            [button removeFromSuperview];
        }
    }

    return cell;    
} 
```

我已经创建了一个包含 3 个按钮的自定义单元格。

我也有一系列不同的图像。

上面的代码应该在每个单元格上创建一个带有 3 个按钮/的表格视图，并且每个按钮上面都有一个背景图像。

问题是，当向下滚动时，我看到一些图像重复它们自己。这不可能来自照片的源数组，我 99% 确定我的数组没问题。

有人能看到我在做什么错吗？我一直在看它这么久，我看不出我的错误..

谢谢

# php - 迷你购物车有问题

> ID：13767431
> 
> 赞同：0
> 
> 时间：2012-12-07T16:50:34.807
> 
> 标签：php, mysql, sql, printf

我正在做一个迷你购物车。一切似乎都有效，但是，当我单击不同的产品时，它不会提取正确的数据，例如

我选择产品 1 - 它给了我正确的信息，但如果我选择产品 2，它会给我与产品 1 相同的信息。

我将在下面显示我的代码，但我相信错误来自这行代码：

```
$sql = sprintf("SELECT Model, Price FROM Bike WHERE BikeCode = %d;", $bikecode); 
```

我不认为它得到 $bikecode

这是 php 文件中的全部代码：

```
<?php
    $bikecode = $_GET['id'];     //the product id from the URL 
    $action = $_GET['action']; //the action from the URL

if($bikecode && !productExists($bikecode)) {
    die("Product Doesn't Exist");
} 

    switch($action) {   //decide what to do 

        case "add":
            $_SESSION['cart'][$bikecode]++; //add one to the quantity of the product with id $bikecode 
        break;

        case "remove":
            $_SESSION['cart'][$bikecode]--; //remove one from the quantity of the product with id $bikecode 
            if($_SESSION['cart'][$bikecode] == 0) unset($_SESSION['cart'][$bikecode]); //if the quantity is zero, remove it completely (using the 'unset' function) - otherwise is will show zero, then -1, -2 etc when the user keeps removing items. 
        break;

        case "empty":
            unset($_SESSION['cart']); //unset the whole cart, i.e. empty the cart. 
        break;
    }

    if($_SESSION['cart']){

        echo "<table width=\"100%\">";   

          foreach($_SESSION['cart'] as $bikecode => $quantity) { 

              $sql = sprintf("SELECT Model, Price FROM Bike WHERE BikeCode = %d;", $bikecode); 

                $result = mysqli_query($con, $sql);

                if(mysqli_num_rows($result) > 0) {

                    list($model, $price) = mysqli_fetch_row($result);   

                    $cost = $quantity * $price;
                    $total = $total + $cost;

                        echo "<tr><th>Model:</th><th>Quantity:</th><th>Price:</th></tr>";
                        echo "<tr>";
                        echo "<td align=\"center\">$model</td>";
                        echo "<td align=\"center\">$quantity <a href=\"$_SERVER[PHP_SELF]?action=remove&id=$bikecode\">X</a></td>";
                        echo "<td align=\"center\">£$cost</td>";
                    echo "</tr>";
                }
            }

            echo "<tr>";
                echo "<td colspan=\"2\" align=\"right\">Total</td>";
                echo "<td align=\"right\">£$total</td>";
            echo "</tr>";

            echo "<tr>";
                echo "<td colspan=\"3\" align=\"right\"><a href=\"$_SERVER[PHP_SELF]?action=empty\" onclick=\"return confirm('Are you sure?');\">Empty Cart</a></td>";
            echo "</tr>";       
        echo "</table>";

    }else{
        echo "You have no items in your shopping cart.";
    }

function productExists($bikecode) {
    $sql = sprintf("SELECT * FROM Bike WHERE BikeCode = %d;", $bikecode); 
    return mysqli_num_rows(mysqli_query($con, $sql)) > 0;
}
?> 
```

非常感谢您的帮助，但如果您找不到错误，请指导我以另一种方式显示此代码：

```
$sql = sprintf("SELECT Model, Price FROM Bike WHERE BikeCode = %d;", $bikecode); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:21:48.397

看起来你明白了，但为了便于参考可能搜索它的其他人，问题是你在 sprintf() 中使用 %d 来尝试在 %d 被视为整数时表示一个 varchar。使用 %s 将解决问题。

[sprintf() - 手动](http://php.net/manual/en/function.sprintf.php)

# javascript - iOS 奇数链接行为

> ID：13767432
> 
> 赞同：3
> 
> 时间：2012-12-07T16:50:39.540
> 
> 标签：javascript, html, ios, css

我对 iOS 中以下站点上的链接有一个奇怪的问题：

[http://www.bllink.net/aircraftindex.asp](http://www.bllink.net/aircraftindex.asp)

在“画廊”菜单下，点击子菜单下的链接（例如“Benny”）不会执行任何操作。看起来 Safari 好像要导航到新页面，但事实并非如此。

但是，如果您点击并按住，则可以选择在新选项卡中打开链接，正如预期的那样。

自然地，该站点在台式机上运行良好。

保存链接的 DIV 未设置为 position:fixed，而是设置为 absolute。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T15:56:58.490

摆脱 javascript 并使用 CSS 来完成下拉菜单。这将使您的代码更加整洁和易于阅读，并且您的网站将与关闭 javascript 的浏览器兼容。

您可以通过在 css 中使用 :hover 选择器来做到这一点。

1）所以用你的菜单项或包含 div 的 div 创建一个列表。

2）通过添加隐藏子菜单在css中： display: none;

3）使用悬停选择器在悬停时显示它们。例如：

```
 .menu .menubutton .submenubutton{
      /* selects the div or li within the class menubutton within the class menu */
      display: none;    }    .menu .menubutton:hover .submenubutton{
      /* uses the hover selector on the menubutton, then shows the submenu it contains */
      display: block;    } 
```

有关深入解释，请参阅有关 csswizardry 或 google 的“css 下拉菜单”的这篇文章：http: [//csswizardry.com/2011/02/creating-a-pure-css-dropdown-menu/](http://csswizardry.com/2011/02/creating-a-pure-css-dropdown-menu/)

# opencv - cvLoadImage 适用于字符串常量，但不适用于 c_str()

> ID：13767434
> 
> 赞同：3
> 
> 时间：2012-12-07T16:50:46.747
> 
> 标签：opencv

我正在使用`cvloadimage`在我的程序中打开图像。图像位于外部目录中，使用文件名中的当前时间生成。

当我尝试以这种方式加载图像时：

```
IplImage *image = cvLoadImage(path.c_str,CV_LOAD_IMAGE_COLOR); 
```

图像结构将为 NULL，应用程序将因 q 分段错误而停止。当我尝试以这种方式加载图像时：

```
IplImage *image = cvLoadImage("path/images/image_2012_11_25.jpg",CV_LOAD_IMAGE_COLOR); 
```

然后效果很好。

只是`cvLoadImage`不能接受任何类型的文本的问题`const char*`吗？但是`c_str()`将 string 转换为`char*`，对吗？

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T07:16:48.780

我在写入文件时遇到了同样的问题，所以我使用了下面的代码：

```
const char *M=s.c_str();
 file.write(M,s.size()); 
```

希望它有效...

# xsd - xjc / jaxb2-commons 接口绑定问题，自定义附加到错误的地方

> ID：13767436
> 
> 赞同：1
> 
> 时间：2012-12-07T16:50:54.640
> 
> 标签：xsd, maven-3, jaxb2, xjc, jaxb2-basics

我正在尝试使用来自 jaxb2_commons maven 组的 jaxb2-basics 工件添加接口。

我的 pom.xml 包含以下依赖项

```
<dependency>
  <groupId>javax.xml.bind</groupId>
  <artifactId>jaxb-api</artifactId>
  <version>2.2.7</version>
</dependency>
<dependency>
  <groupId>com.sun.xml.bind</groupId>
  <artifactId>jaxb-impl</artifactId>
  <version>2.2.6</version>
</dependency>
<dependency>
  <groupId>org.jvnet.jaxb2_commons</groupId>
  <artifactId>jaxb2-basics-runtime</artifactId>
  <version>0.6.4</version>
</dependency> 
```

插件配置看起来像

```
 <plugin>
    <groupId>org.jvnet.jaxb2.maven2</groupId>
    <artifactId>maven-jaxb22-plugin</artifactId>
    <version>0.8.2</version>
    <executions>
      <execution>
        <id>jaxb-generate-messages-in</id>
        <phase>generate-sources</phase>
        <goals>
          <goal>generate</goal>
        </goals>
        <configuration>
          <specVersion>2.2</specVersion>
          <schemaLanguage>XMLSCHEMA</schemaLanguage>
          <schemaDirectory>src/main/schema</schemaDirectory>
          <schemaIncludes>
            <include>MESSAGES-IN.xsd</include>
          </schemaIncludes>
          <bindingDirectory>src/main/binding</bindingDirectory>
          <bindingIncludes>
            <include>messages-in-binding.xjb</include>
          </bindingIncludes>
          <episodeFile>${project.build.directory}/generated-sources/messages-in/META-INF/jaxb-messages-in.episode</episodeFile>
          <generateDirectory>${project.build.directory}/generated-sources/messages-in</generateDirectory>
          <extension>true</extension>
          <args>
            <arg>-Xinheritance</arg>
          </args>
          <plugins>
            <plugin>
              <groupId>org.jvnet.jaxb2_commons</groupId>
              <artifactId>jaxb2-basics</artifactId>
              <version>0.6.4</version>
            </plugin>
          </plugins>
        </configuration>
      </execution>
      <execution>
        <id>jaxb-generate-messages-out</id>
        <phase>generate-sources</phase>
        <goals>
          <goal>generate</goal>
        </goals>
        <configuration>
          <specVersion>2.2</specVersion>
          <schemaLanguage>XMLSCHEMA</schemaLanguage>
          <schemaDirectory>src/main/schema</schemaDirectory>
          <schemaIncludes>
            <include>MESSAGES-OUT.xsd</include>
          </schemaIncludes>
          <bindingDirectory>src/main/binding</bindingDirectory>
          <bindingIncludes>
            <include>messages-out-binding.xjb</include>
          </bindingIncludes>
          <episodeFile>${project.build.directory}/generated-sources/messages-out/META-INF/jaxb-messages-out.episode</episodeFile>
          <generateDirectory>${project.build.directory}/generated-sources/messages-out</generateDirectory>
        </configuration>
      </execution>
    </executions>
    <configuration>
      <verbose>true</verbose>
    </configuration>
  </plugin> 
```

从上面可以看出，xjc 有两次调用，它们都有效。专注于第一个，我的绑定文件

```
<jaxb:bindings
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:jaxb="http://java.sun.com/xml/ns/jaxb"
  xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc"
  xmlns:inheritance="http://jaxb2-commons.dev.java.net/basic/inheritance"
  jaxb:extensionBindingPrefixes="xjc"
  version="1.0">
  <jaxb:bindings schemaLocation="../schema/MESSAGES-IN.xsd" node="/xs:schema">
    <jaxb:globalBindings typesafeEnumMaxMembers="3000">
      <jaxb:serializable uid="1"/>
    </jaxb:globalBindings>
    <jaxb:schemaBindings>
      <jaxb:package name="com.whatever.messages.request"/>
    </jaxb:schemaBindings>
    <jaxb:bindings node="//xs:simpleType[@name='YesOrNo']">
      <jaxb:class ref="com.whatever.messages.YesOrNo"/>
    </jaxb:bindings>
    <jaxb:bindings noade="//xs:complexType[@name='someLogin']">
      <jaxb:class name="LoginRequest">
        <jaxb:javadoc><![CDATA[A Login request message.]]>
        </jaxb:javadoc>
      </jaxb:class>
    </jaxb:bindings>
  </jaxb:bindings>
</jaxb:bindings> 
```

奇迹般有效; 但是，当我尝试向“LoginRequest”添加接口时......

```
 <jaxb:bindings node="//xs:complexType[@name='someLogin']">
     <jaxb:class name="LoginRequest">
       <jaxb:javadoc><![CDATA[A Login request message.]]>
       </jaxb:javadoc>
     </jaxb:class>
     <inheritance:implements>com.whatever.messages.Request</inheritance:implements>
   </jaxb:bindings> 
```

我收到错误消息

```
 Error while parsing schema(s).Location [ file:/C:/Users/justme/Documents/NetBeansProjects/someproject/src/main/binding/messages-in-binding.xjb{19,42}].
 com.sun.istack.SAXParseException2; systemId: file:/C:/Users/justme/Documents/NetBeansProjects/someproject/src/main/binding/messsages-in-binding.xjb; lineNumber: 19; columnNumber: 42; compiler was unable to honor this class customization. It is attached to a wrong place, or its inconsistent with other bindings. 
```

报告该位置是

```
 Error while generating code.Location [ file:/C:/Users/justme/Documents/NetBeansProjects/someproject/src/main/schema/MESSAGES-IN.xsd{106693,54}]. 
```

恰好对应于

```
 <xs:complexType name="someLogin" mixed="true">
   ...
 </xs:complexType> 
```

现在，我尝试了第二个指令将接口绑定到 XSD 元素

```
 <xs:element name="someLogin" type="someLogin" substitutionGroup="externalMethod"/> 
```

但我只是收到与元素的行号相同的错误消息作为位置。

显然，有人想将接口附加到类，并且所有示例看起来都非常接近我的绑定文件，但一定有问题。

我的环境是

```
Apache Maven 3.0.4 (r1232337; 2012-01-17 02:44:56-0600)
Maven home: C:\Program Files\NetBeans 7.2.1\java\maven
Java version: 1.7.0_07, vendor: Oracle Corporation
Java home: C:\Program Files (x86)\Java\jdk1.7.0_07\jre
Default locale: en_US, platform encoding: Cp1252
OS name: "windows 7", version: "6.1", arch: "x86", family: "windows" 
```

有人可以解释为什么 xjc 认为扩展在错误的 XSD 类型上运行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:10:41.037

在施工

```
<jaxb:bindings 
  node="//Xs:complexType[@name='someLogin">
  ...
</jaxb:bindings> 
```

该`node`属性应该是一个 XPath 表达式。[（或者它在Oracle](http://docs.oracle.com/cd/E17802_01/webservices/webservices/docs/1.5/tutorial/doc/JAXBUsing4.html)上是这么说的）。尝试添加右方括号使其成为一个，看看是否有帮助。

# java - 为什么我在这里遇到错误？

> ID：13767437
> 
> 赞同：0
> 
> 时间：2012-12-07T16:51:02.687
> 
> 标签：java

有人可以在这里指出我正确的方向或填写我缺少的内容。真的很感激。谢谢

我收到这些错误：

```
E:\Data Netw Proj\BankingApp\BankingServant.java:26: error: cannot find symbol
ArrayList <Accounts> accounts = new ArrayList<Accounts>();
           ^
  symbol:   class Accounts
  location: class BankingServant
E:\Data Netw Proj\BankingApp\BankingServant.java:26: error: cannot find symbol
ArrayList <Accounts> accounts = new ArrayList<Accounts>();
                                              ^
  symbol:   class Accounts
  location: class BankingServant
E:\Data Netw Proj\BankingApp\BankingServant.java:37: error: cannot find symbol
        Accounts lodge = new Accounts();
        ^
  symbol:   class Accounts
  location: class BankingServant
E:\Data Netw Proj\BankingApp\BankingServant.java:37: error: cannot find symbol
        Accounts lodge = new Accounts();
                             ^
  symbol:   class Accounts
  location: class BankingServant
E:\Data Netw Proj\BankingApp\BankingServant.java:47: error: cannot find symbol
        Accounts trans = new Accounts();
        ^
  symbol:   class Accounts
  location: class BankingServant
E:\Data Netw Proj\BankingApp\BankingServant.java:47: error: cannot find symbol
        Accounts trans = new Accounts();
                             ^
  symbol:   class Accounts
  location: class BankingServant
E:\Data Netw Proj\BankingApp\BankingServant.java:58: error: cannot find symbol
        Accounts with = new Accounts();
        ^
  symbol:   class Accounts
  location: class BankingServant
E:\Data Netw Proj\BankingApp\BankingServant.java:58: error: cannot find symbol
        Accounts with = new Accounts();
                            ^
  symbol:   class Accounts
  location: class BankingServant
E:\Data Netw Proj\BankingApp\BankingServant.java:67: error: cannot find symbol
        Accounts bal = new Accounts();
        ^
  symbol:   class Accounts
  location: class BankingServant
E:\Data Netw Proj\BankingApp\BankingServant.java:67: error: cannot find symbol
        Accounts bal = new Accounts();
                           ^
  symbol:   class Accounts
  location: class BankingServant
Note: Some input files use unchecked or unsafe operations.
Note: Recompile with -Xlint:unchecked for details.
10 errors

Tool completed with exit code 1 
```

这是代码：

```
//package BankingApp;

//import BankingApp._BankingImplBase;
import BankingApp.*;
import java.util.ArrayList;
import java.util.Iterator;

public class BankingServant extends _BankingImplBase {
     private String accName;
     private int lodgementAmount ;
     private int transAmount ;
     private int transAccName ;
     private int withAccName;
     private int withAmount;
     private int checkBal;

private class Account {

    String accName;
    int lodgementAmount;
    int transAmount;
    int withAmount;
    int checkBal;
    ArrayList <Account> accounts;
}
ArrayList <Accounts> accounts = new ArrayList<Accounts>();
{
    ArrayList<Account> accounts = new ArrayList();

    }

    public boolean makeLodgement(String accName, int lodgementAmount) {

        System.out.println("Lodgement");
        Accounts lodge = new Accounts();
        lodge.accName = accName;
        lodge.lodgementAmount = lodgementAmount;
        lodge.accounts = this.accounts;
        accounts.add(lodge);
        System.out.println("Money Lodged");

}
    public boolean makeTransfer(String transAccName, int transAmount) {
        System.out.println("transfer");
        Accounts trans = new Accounts();
        trans.transAccName = transAccName;
        trans.transAmount = transAmount;
        trans.accounts = this.accounts;
        accounts.add(trans);
        System.out.println("Money transfered");

}

    public boolean makeWithdrawl(String withAccName, int withAmount) {
        System.out.println("Withdrawl");
        Accounts with = new Accounts();
        with.withAccName = withAccName;
        with.withAmount = withAmount;
        with.accounts = this.accounts;
        accounts.add(with);
        System.out.println("Money Withdrawn");
}
    public boolean checkBalance(String balAccName, int checkBal) {
        System.out.println("Balance");
        Accounts bal = new Accounts();
        bal.transAccName = balAccName;
        bal.checkBal = checkBal;
        bal.accounts = this.accounts;
        accounts.add(bal);
        System.out.println("balance is: ");
}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T16:53:29.257

类名是`Account`，您将其称为`Accounts`. 这就是错误。

将数组列表声明为`ArrayList<Account>`。

# wordpress - Google URL 抓取错误 404 - 域附加到 URL 的末尾

> ID：13767438
> 
> 赞同：0
> 
> 时间：2012-12-07T16:51:03.437
> 
> 标签：wordpress, http-status-code-404, web-crawler, permalinks

我最近在[www.kernelops.com](http://www.kernelops.com)上构建并发布了我的 Wordpress 网站，并将其提交给 google 索引和网站管理员工具。今天我登录网站管理员工具，发现 60 个 URL 错误都属于同一类型的问题。基域地址[www.kernelops.com](http://www.kernelops.com)被附加到我所有的网站页面、类别和帖子 URL。失败 URL 的示例如下所示：

http://www.kernelops.com/blog/www.kernelops.com [_](http://www.kernelops.com) _

谷歌网站管理员工具表明这个奇怪的链接来自基本网址“http://www.kernelops.com/blog”，这显然意味着问题出在我身上。我的 Wordpress 永久链接设置设置为使用帖子名称；我不确定这是否会导致这种情况，即：

http://www.kernelops.com/sample-post/ [_](http://www.kernelops.com) _

我似乎无法通过谷歌搜索找到解决这个奇怪问题的任何帮助，并认为这里的某人可能能够为我指明正确的方向。

可能会影响网站 URL 的 Wordpress 插件如下：

*   多合一搜索引擎优化
*   XML-站点地图

但是我在这些插件中看不到任何会导致此类问题的设置。

任何想法将不胜感激 - 在此先感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:36:18.110

这是一个很长的尝试，但如果 Google 爬虫抓取一个看起来像相对路径的链接并尝试将其附加到当前目录，则可能会发生这种情况。**谷歌极不可能**有这样的错误，但也不是不可能的。

我能找到的可能被认为是相对路径的关闭是这样的：

```
<div class="copyright">
...
<a href="www.kernelops.com">Kernel, Inc.</a>
...
</div> 
```

我怀疑这是问题所在，但可能值得修复它。

现在，还有另一种可能性，那就是网站根据用户代理字符串提供的内容略有不同。当 Google 向您的网站提供用户代理字符串时，SEO 插件会检测到它并尝试优化事物以提高您的排名（不熟悉该插件，所以我不知道它究竟做了什么）。SEO 插件中可能存在一个错误，该错误会导致`www.kernelops.com`URL 看起来像相对路径，或者以某种方式实际构建错误的 URL。

您可以通过将浏览器中的用户代理字符串（例如[FireFox 的用户代理切换器](https://addons.mozilla.org/en-US/firefox/addon/user-agent-switcher/)）设置为[Googlebot 的用户代理字符串](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=1061943)来测试这一点，并测试当您访问您的网站时会发生什么。查看您收到的页面来源，并查找任何可能看起来像 Google 正在找到的链接。

*但是，如果 SEO 工具足够聪明，它将“意识到”您的 IP 与 Googlebot 的有效 IP 之一不匹配，并且不会进行修改。*

# asp.net-mvc - 将活动目录组作为角色使用 Windows 身份验证

> ID：13767439
> 
> 赞同：37
> 
> 时间：2012-12-07T16:51:05.683
> 
> 标签：asp.net-mvc, active-directory, windows-authentication

我已经阅读了有关此主题的几个问题，例如[此处](https://stackoverflow.com/questions/5833059/authenticate-user-using-active-directory-windows-authentication-in-ms-access-200)，[此处](https://stackoverflow.com/questions/13398079/getting-user-roles-groups-from-active-directory-mvc3)，[此处](https://stackoverflow.com/questions/23610/windows-active-directory-user-groups)和[此处](https://stackoverflow.com/questions/209242/asp-net-role-based-authentication-using-security-groups-in-active-directory)；但就我而言，没有人提供可行的解决方案。

**我想做的事：**

为仅由我们自己的员工使用的 Web 应用程序实施 Windows 身份验证。这样他们就不需要登录应用程序，但已经通过登录 Windows 进行了身份验证。

此外，我需要根据用户可能分配到的 Active Directory 安全组来限制应用程序的某些区域。

所以我希望能够用

```
[Authorize(Roles="SomeRole")] 
```

**我试过的：**

我有

```
<authentication mode="Windows" /> 
```

在我的 web.config 中。我已经添加了一些 a 的排列，这些排列`<roleManager>`在上面链接的一些帖子中可以找到。目前我有这个角色经理

```
<roleManager defaultProvider="WindowsProvider"
  enabled="true"
  cacheRolesInCookie="false">
      <providers>
        <add
          name="WindowsProvider"
          type="System.Web.Security.WindowsTokenRoleProvider" />
      </providers>
    </roleManager> 
```

正如在[这篇](http://msdn.microsoft.com/en-us/library/system.web.security.windowstokenroleprovider.aspx)文章中发现的那样。

事实上，如果我用 装饰控制器`[Authorize]`，我可以正常访问它。

**然而：**

我可以在网络上的用户设置中看到，我是名为“IT”的 AD 安全组的一部分。但是，如果我用我装饰同一个控制器，`[Authorize(Roles="IT")]`我会得到由 asp.net 开发服务器为未授权的 401 服务的空白屏幕。 **这是出乎意料的。** 我认为当我登录到 Windows 并且是“IT”组的一部分时，我应该能够查看该页面。

我在这个主题上找到的大部分内容都使得完成我想做的事情听起来很简单，但我显然在这里遗漏了一些东西。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-06-21T01:34:51.147

对于开发人员，我使用 IISExpress 并设置了 MVC 项目的开发服务器属性，以便禁用匿名身份验证并启用 Windows 身份验证。Web 配置是使用我们的 TFS 构建服务器部署的，以测试和发布服务器，这些服务器的身份验证也如上所述设置并且也可以在这些位置工作。

在我的 web.config 我有。

```
 <system.web> 
....
       <authentication mode="Windows" />
        <authorization>
          <deny users="?" />
        </authorization>
        <roleManager enabled="true" defaultProvider="AspNetWindowsTokenRoleProvider">
          <providers>
            <clear />
            <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
          </providers>
        </roleManager>
....

    </system.web> 
```

我可以用

```
[Authorize(Roles = @"DOMAIN\ADGroup")]
Public ActionResult Index()
{...} 
```

或者

```
 public ActionResult Index()
        {
            var User = System.Web.HttpContext.Current.User;
            if (User.IsInRole("DOMAIN\\ADGroup"))
            {
                return RedirectToAction("IRSAdmin");
            }
            return View();
        } 
```

在我记得注销并重新登录后，我获得了 AD 组的权限。

# javascript - 使用 getBackgroundPage() 给了我： Object [object Window] has no method 'getFromStorage'

> ID：13767441
> 
> 赞同：1
> 
> 时间：2012-12-07T16:51:09.473
> 
> 标签：javascript, google-chrome, google-chrome-extension

我的 background.js 中有这个：

```
var write = function (line) {
  if (localStorage["silent"] == true) {
    chrome.extension.getBackgroundPage().console.log(line);
  } else {
    alert(line);
  }
}
var getFromStorage = function (item, default) {
  if (localStorage[item] == undefined) {
    write("Could not find " + item + " in local storage...");
    return default;
  } else {
    return localStorage[item];
  }
}

var isOn = getFromStorage("isOn", true);
var silent = getFromStorage("silent", false); 
```

这在我的 popup.js 中：

```
var bgPage = chrome.extension.getBackgroundPage();
var isOn = bgPage.getFromStorage("isOn", true);
var silent = bgPage.getFromStorage("silent", false); 
```

我得到这个错误：

```
Object [object Window] has no method 'getFromStorage' 
```

非常感谢您的帮助，谢谢:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T18:03:06.477

您应该更改 `default`后台脚本中的参数

```
 var write = function (line) {
    if (localStorage["silent"] == true) {
      chrome.extension.getBackgroundPage().console.log(line);
    } else {
      alert(line);
    }
  }
  var getFromStorage = function (item, d) {
    if (localStorage[item] == undefined) {
      write("Could not find " + item + " in local storage...");
      return d;
    } else {
      return localStorage[item];
    }
  }

  var isOn = getFromStorage("isOn", true);
  var silent = getFromStorage("silent", false); 
```

因为`default`在javascript中被保留。（它与[Switch 语句](http://www.w3schools.com/js/js_switch.asp)一起使用）
因此后台页面根本不会加载，检查它应该会导致类似这样的结果`Uncaught SyntaxError: Unexpected token default at background.js:8`

然后导致`Object [object Window] has no method 'getFromStorage'` 弹出脚本中的错误，因为`getFromStorage`实际上由于在第 8 行终止而从未在后台脚本中加载

# java - 如何应用随机颜色？

> ID：13767442
> 
> 赞同：0
> 
> 时间：2012-12-07T16:51:12.530
> 
> 标签：java, colors

以下代码包含被覆盖以制作矩形图案的方法。我想为每个矩形赋予不同的颜色。你知道如何做到这一点吗？

```
 public void actionPerformed(ActionEvent event) {
        int x1 = 60;
        int y1 = 60;
        int width = 280;
        int length = 140;

        Graphics paper = panelForBackGround.getGraphics();
        for (int x = 1; x < 8; x++) {

            paper.draw3DRect(x1, y1, width,length, true);
            x1 = x1 + 10;
            y1 = y1 + 10;
            width = width - 20;
            length = length - 20;

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:53:14.060

可以使用 RGB 值创建颜色。创建 0 到 255 之间的三个随机数（包括边界）并将生成的颜色应用于您的矩形。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T16:57:22.413

在文件顶部：

```
import java.util.Random;
import java.awt.Color; 
```

在方法的顶部：

```
Random random = new Random(); 
```

在绘制之前循环：

```
paper.setColor(new Color(random.nextInt())); 
```

参考：

*   [http://docs.oracle.com/javase/7/docs/api/java/util/Random.html](http://docs.oracle.com/javase/7/docs/api/java/util/Random.html)
*   [http://docs.oracle.com/javase/7/docs/api/java/awt/Color.html#Color(int)](http://docs.oracle.com/javase/7/docs/api/java/awt/Color.html#Color%28int%29)
*   [http://docs.oracle.com/javase/7/docs/api/java/awt/Graphics.html#setColor(java.awt.Color)](http://docs.oracle.com/javase/7/docs/api/java/awt/Graphics.html#setColor%28java.awt.Color%29)

# liquibase - 如何在 Liquibase 的一段时间内获取变更集

> ID：13767445
> 
> 赞同：0
> 
> 时间：2012-12-07T16:51:21.533
> 
> 标签：liquibase

我可以使用 liquibase 来更改我的数据库架构，这很好。但是我需要在一段时间内获取变更集，例如

```
1/1: add table1 => 1.0
1/10: add table2
1/18: alter table1 => 2.0
1/21: alter table2 
1/28: add table3 => 3.0 
```

如果我想从 1/10~1/28 或 1/18~1/21 获取变更集（SQL 命令），有可能吗？

[更新] 感谢 Mark 的回复，我在我们的开发环境中添加了上述变更集中的版本。而当我们的生产数据库是 1.0 并且我想直接升级到 2.0（或 3.0）但只想使用 liquibase 生成 SQL 命令并手动运行它。

回滚有一个问题，如果我回滚我的开发数据库，​​我需要重新创建上面已经存在的数据。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T09:34:41.163

我建议阅读[命令行文档](http://www.liquibase.org/manual/command_line)。

要根据日期生成 SQL，我认为可以完成的唯一方法如下：

```
liquibase rollbackToDate <date/time> 
liquibase tag <version so can rollback here again>
liquibase updateSQL > keepUpdate.sql
liquibase update 
```

# 更新

您正在尝试做的事情（使用 SQL 更新生产）是 liquibase 旨在支持的常见用例。这是我最喜欢的功能之一。

问题是.... 在理想的世界中，您应该能够吹走您的开发数据库并从头开始。显然，您没有 liquibase 变更集来管理您的数据，因此需要考虑一些替代方案....

## 方法一：新建 DEV 数据库

运行 SQL 查询并确定您的开发数据库中有多少变更集：

```
SELECT ORDEREXECUTED, DATEEXECUTED, ID, FILENAME, DESCRIPTION, COMMENTS 
FROM DATABASECHANGELOG 
ORDER BY ORDEREXECUTED 
```

分析日期并确定有多少 chnageset 会将您从版本 3.0 带回 2.0（2 个变更集）和 1.0（4 个变更集）

创建一个新的数据库并应用您的 liquibase 变更集，将您的架构升级到 3.0 版

```
liquibase update 
```

为版本 2.0 -> 3.0 升级创建 SQL

```
liquibase rollbackCount 2
liquibase updateSQL         > upgrade-2_0-3_0.sql
liquibase futureRollbackSQL > rollback-2_0-3_0.sql 
```

并为版本 1.0 -> 3.0 升级创建 SQL

```
liquibase rollbackCount 2
liquibase updateSQL         > upgrade-1_0-3_0.sql
liquibase futureRollbackSQL > rollback-1_0-3_0.sql 
```

## 方法二：使用 dbunit 保存数据集

另一个真正有用的数据库管理工具是[dbunit](http://www.dbunit.org/)

以下文章解释了如何一起使用 liquibase 和 dbunit 来迁移数据库：

*   [http://www.poornerd.com/2010/12/07/database-migration-with-liquibase-and-dbunit/](http://www.poornerd.com/2010/12/07/database-migration-with-liquibase-and-dbunit/)

这两种工具是互补的。在您的情况下，也许您可​​以定期保存开发数据的快照并使用它来重新填充开发或测试数据库（显然数据集对数据库模式的版本很敏感，因此需要注意）

# php - 在数据库中安全使用 POST 变量

> ID：13767447
> 
> 赞同：0
> 
> 时间：2012-12-07T16:51:27.967
> 
> 标签：php, mysql

亲爱的社区，自从我编写数据库应用程序以来已经有一段时间了，只是为了确保我有一个简单的问题：

下面的 PHP 代码可以安全使用吗？我有一个带有 php 5.3.8 的基本 DA 安装，所以应该禁用魔术引号。

问候，

```
 <?php
    $id =  ( mysql_real_escape_string( stripslashes ($_POST['id'])));
    $naam = ( mysql_real_escape_string( stripslashes  ($_POST['naam'])));
    $bericht =  ( mysql_real_escape_string ( stripslashes ($_POST['bericht'])));

    if ($id and $naam and $bericht) {

    $databsestring = "<div class=\"reactie\"><h3>".$naam." op ".date ("F j, Y").":</h3>" . $bericht . "</div>";

    if ($db_found) {

    $SQL = "UPDATE xxxxx_comments SET comments = CONCAT (comments,'".$databsestring."') WHERE id='".$id."'";
    $result = mysql_query($SQL);

    mysql_close($db_handle);

    }
    ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T16:57:36.560

mysql_* 已弃用，请使用 mysqli 或 PDO 安全地存储数据。

例如：

```
 $add_user = $mysqli->prepare("INSERT INTO `users` SET  `name`=?, `email`=?, `encrypted_password`=?");
    $add_user->bind_param("sss",$name,$email,$hash["encrypted"]);
    $add_user->execute() 
```

使用准备好的语句是避免 sql 注入的安全方法

# css - 具有固定宽度图像的流畅布局，防止重叠

> ID：13767449
> 
> 赞同：0
> 
> 时间：2012-12-07T16:51:35.467
> 
> 标签：css

该网站可在此处查看 - [http://manchestergardeningservices.co.uk/fluid/](http://manchestergardeningservices.co.uk/fluid/)

我创建了一个流畅的布局，并在`content`列中放置了一个 600 像素宽的图像，但是当我调整窗口大小，使`content`列小于 600 像素宽时，结果是图像与侧边栏重叠，如下所示.

我认为添加`min-width`属性`div id ="content"`可能是解决问题的一种方法，但如果添加此属性，则`div id ="content"`当网页缩小时，绿色侧边栏将位于下方。

```
#content {
    min-width: 600px;
    float:left;
    width:70%;
} 
```

![在此处输入图像描述](../Images/ea932132c3e9c77c7aa0289363224922.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:58:54.123

将宽度：100% 添加到图像

```
<img src="bane.jpg" alt="bane" style="width: 100%;"> 
```

并删除 min-width: 600px; 从内容

# c# - 列表 .FindIndex(Int32, 谓词 )

> ID：13767451
> 
> 赞同：11
> 
> 时间：2012-12-07T16:51:38.467
> 
> 标签：c#, .net-3.5

有一个`List<T>.FindIndex(Int32, Predicate <T>)`。该方法正是我想要的`IList<T>`对象。
我知道`IList`有一种方法`IndexOf(T)`，但我需要谓词来定义比较算法。

是否有方法、扩展方法、LINQ 或一些代码来查找 a 中项目的索引`IList<T>`？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-07T16:54:27.477

那么你可以*很*容易地编写你自己的扩展方法：

```
public static int FindIndex<T>(this IList<T> source, int startIndex,
                               Predicate<T> match)
{
    // TODO: Validation
    for (int i = startIndex; i < source.Count; i++)
    {
        if (match(source[i]))
        {
            return i;
        }
    }
    return -1;
} 
```

# javascript - three.js - ipad 管几何上的画布纹理

> ID：13767456
> 
> 赞同：1
> 
> 时间：2012-12-07T16:52:01.237
> 
> 标签：javascript, json, ipad, html5-canvas, three.js

我有一个管几何的 3d 模型。生产端有18000个坐标。我每 9 个坐标取一次，以便实际绘制 9000 个坐标来构建管几何图形。我`CanvasRenderer`只能使用。

现在当我使用`vertexColors: THREE.VertexColors`in时`WebGLRenderer`，模型在每张脸上显示不同的颜色。当我将其更改为 时`CanvasRenderer`，模型仅变为白色。即使我改变`vertexColors: THREE.FaceColors`了，结果也是一样的。

请在下面找到 jsfiddle 的链接和我以前的链接，其中 mrdoob 添加了`material.vertexColors = THREE.FaceColors`对 CanvasRenderer 的支持。

[支持画布渲染中的顶点颜色](https://stackoverflow.com/questions/12404618/highlight-cylinder-face-upon-selection-in-three-js)

[画布渲染中的管](http://jsfiddle.net/RnFqz/20/)

请在图像下方找到根据值应用颜色。 ![参数值](../Images/2701c386988ffa01ec7ade2bb6fe507d.png)

如图所示，每个坐标都有 12 个不同角度的 12 个值。所以我创建了一个半径段为 12 的管。然后我将这些值存储到 JSON 文件中，但由于有 18000 个点，文件变得很重。即使我正在绘制 2000 个点，也需要花费太多时间。对于 2000 个段，每个段有 12 个面，管上有 24000 个面。

请在下面找到根据参数值应用颜色的编程逻辑。

// 获取 res 值并应用颜色 var lblSeg=0; 变量 pntId; 变量 d=0; var faceLength=tube.faces.length; var degree = ['30', '60', '90', '120', '150', '180', '210', '240', '270', '300', '330' ]; var faces = tube.faces; 变量度Cntr = 0；var degreeProp; //console.log(faces); 变量 res30=0,res60=0,res90=0,res120=0,res150=0,res180=0,res210=0,res240=0,res270=0,res300=0,res330=0; 变量资源；变量 resDegree; 变量 pnt=0;

```
 // fetching json data of resistivity values at different degree as                                                          //shown in the image
        var result = getResValue(); 

        for(var k=0; k<faceLength; k++){
            resDegree = degrees[degreeCntr];
            degreeProp = "r"+resDegree;

            res = result.resistivity[pnt][degreeProp];
            objects.push(result.resistivity[pnt]);              

            f = faces[k];               

            color = new THREE.Color( 0xffffff );

            if(res<5){                      
                color.setRGB( 197/255, 217/255, 241/255);
            }

            else if(res>=5 && res<50){                                                                          
                color.setRGB( 141/255, 180/255, 226/255);
            }

            else if(res>=50 && res<100){                                
                color.setRGB( 83/255, 141/255, 213/255);
            }

            else if(res>=100 && res<200){                               
                color.setRGB( 22, 54, 92);
            }

            else if(res>=200 && res<300){                           
                color.setRGB( 15/255,36/255,62/255);
            }

            else if(res>=300 && res<400){                               
                color.setRGB( 220/255, 230/255, 241/255);
            }

            else if(res>=400 && res<700){                               
                color.setRGB( 184/255, 204/255, 228/255);
            }

            else if(res>=700 && res<1200){                              
                color.setRGB( 149/255, 179/255, 215/255);
            }

            else if(res>=1200 && res<1500){                             
                color.setRGB( 54/255, 96/255, 146/255);
            }

            else if(res>=1700 && res<1800){                             
                color.setRGB( 36/255, 84/255, 98/255);
            }

            else if(res>1900){                              
                color.setRGB( 128/255, 128/255, 128/255);
            }

            for(var j=0;j<4;j++)
            {                   
                tube.vertices.push(f.centroid);
                vertexIndex = f[ faceIndices[ j ] ];    
                p = tube.vertices[ vertexIndex ];                   
                f.vertexColors[ j ] = color;                    
            }

            degreeCntr++;
            if(degreeCntr==10){
                degreeCntr=0;
            }
            if(k%12==0 && k!=0){
                pnt++;                  
            }
        } 
```

这个逻辑需要太多时间来渲染模型，模型变得太重，我们无法执行其他操作。Android 上的 FPS 下降 2-3 FPS。实际上我必须在 iPad 上渲染这个模型，所以只能使用画布渲染器。

那么，如何让这个模型更轻，以便在 iPad 上顺利加载和运行？还有其他方法可以在每张脸上涂上颜色吗？如果可以将画布贴图作为纹理应用以使模型更轻，那么如何根据值构建具有所有颜色的贴图？

**更新：** 将库版本更改为 r53`vertexColors: THREE.FaceColors`和`face.color.setRGB( Math.random(), Math.random(), Math.random())`后，模型在画布渲染上显示每个面的随机颜色。

所以现在的问题是根据要求应用颜色（通过画布地图或任何可行的解决方案）并使模型更轻以在 iPad 上顺利加载。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T00:01:22.080

我相信这会给你带来更好的性能+如果你能想出一些自动计算每个角度偏移的颜色的方法，你可以直接设置十六进制颜色：

```
for ( var i = 0; i < tube.faces.length; i ++ ) {

    tube.faces[ i ].color.setHex( Math.random() * 0xffffff );

} 
```

正如我在上一条消息[-three.js-line 旁边的文本](https://stackoverflow.com/questions/13683727/three-js-text-next-to-line/)中向您解释的那样，如果您尝试渲染如此多的面孔，使用画布纹理只会增加您的 fps 负载。

如果你真的想在画布渲染器上渲染 24,000 个面，并且仍然希望它在 iPad 上显示得很好——那你就疯了！））

这是我目前能想到的唯一解决方案：

1) 将您的管子设置为仅 1 段。

2）创建 12 个画布元素（对于每个半径段），宽度等于您的管长度（请参阅上面的链接）。

3) 现在想象一下，您将在每个画布内创建 2000 个片段。因此，您将画布长度除以 2000，并为该除法的每一部分设置计算颜色！！！（就像 Stats() FPS 条显示它的条一样，但是您将让每个条具有不同的颜色）。

4）然后你只需将你的彩色条画布纹理应用到你的 12 个半径段中的每一个，你就可以开始了！

这样，您只会获得初始页面加载（计算 24,000 个彩色条）并且您的整个管子只有 12 个面！！！

现在，我知道您的下一个问题将是：我将如何选择我的面孔来显示带有标签文本的行？

嗯，很简单！只需获取当前面（12 个中的 1 个）选择位置坐标并将它们转换回您的 JSON，就像处理 24,000 个面一样；）

希望有帮助！

# python - Django 模型检索相同的结果

> ID：13767459
> 
> 赞同：7
> 
> 时间：2012-12-07T16:52:15.107
> 
> 标签：python, django, orm, django-models

我有一个基于 SQL 数据库的 django 模型 TestModel。

每当我这样做

```
TestModel.objects.all() 
```

如果我从同一个进程多次运行它，我似乎得到了相同的结果。我测试了通过手动删除（不使用任何 django 原语）从构建模型的表中的一行，查询仍然返回相同的结果，即使删除后显然应该有更少的对象。

是否有某种缓存机制，每次我想检索对象时，django 都不会进入数据库？

如果有的话，有没有办法我仍然可以强制 django 在每个查询中访问数据库，最好不编写原始 SQL 查询？

我还应该指定通过重新启动该过程模型再次返回正确的对象，我不再看到已删除的对象，但如果我删除更多，问题再次出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:12:53.823

这是因为您的数据库隔离级别是可重复读取的。在 django shell 中，所有请求都包含在单个事务中。

**已编辑**

你可以在你的shell中尝试：

```
from django.db import transaction
with transaction.autocommit():
    t = TestModel.objects.all()
    ... 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-07T17:17:36.723

听起来像一个数据库事务问题。如果您在单独进入数据库本身并修改数据时保持 shell 会话打开，则在 shell 中打开的事务将不会因为隔离而看到更改。您需要退出并重新加载 shell 以获取新事务，然后才能看到它们。

请注意，在生产中，事务与请求/响应周期相关联，因此这不是一个重大问题。

# javascript - 句子的随机数组？

> ID：13767461
> 
> 赞同：2
> 
> 时间：2012-12-07T16:52:17.760
> 
> 标签：javascript, html

Javascript noob here....我正在尝试建立一个网站，帮助我的孩子从选定的组中阅读预定义的句子，然后当点击一个按钮时，它会显示其中一个句子。数组是最好的选择吗？

例如，我有这个数组（如下），点击一个按钮，我希望这些句子中的一个出现在页面上。

```
<script type="text/javascript">
Sentence = new Array()
Sentence[0]='Can we go to the park.';
Sentence[1]='Where is the orange cat? Said the big black dog.';
Sentence[2]='We can make the bird fly away if we jump on something.'
Sentence[3]='We can go down to the store with the dog. It is not too far away.'
Sentence[4]='My big yellow cat ate the little black bird.'
Sentence[5]='I like to read my book at school.'
Sentence[6]='We are going to swim at the park.'
</script> 
```

同样，一个数组是最适合这个的，我怎样才能让句子显示？理想情况下，我希望按钮随机选择其中一个句子，但现在只显示其中一个会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T16:57:20.623

Array 可以用于此目的：

您可以使用此代码在指定的 div 中随机显示句子：

```
var sentences = [
    'Can we go to the park.',
    'Where is the orange cat? Said the big black dog.',
    'We can make the bird fly away if we jump on something.',
    'We can go down to the store with the dog. It is not too far away.',
    'My big yellow cat ate the little black bird.',
    'I like to read my book at school.',
    'We are going to swim at the park.'
];

var rand = sentences[Math.floor(Math.random() * sentences.length)];

$('#divid').text(rand); 

//If you don't fancy jQuery then do this instead
document.getElementById('divid').innerHTML = rand; 
```

**[工作演示](http://jsfiddle.net/WPpFn/1/)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T17:32:23.980

只需使用数组就足够简单了。这是一个这样做并检索随机句子的示例：

```
 var sentences = [
    'Can we go to the park.',
    'Where is the orange cat? Said the big black dog.',
    'We can make the bird fly away if we jump on something.',
    'We can go down to the store with the dog. It is not too far away.',
    'My big yellow cat ate the little black bird.',
    'I like to read my book at school.',
    'We are going to swim at the park.'
],

//the number of sentences in the array
maxSentences = sentences.length;

//get and return a random sentences from array
function getRandomSentence() {
    //calculate a random index
    var index = Math.floor(Math.random() * (maxSentences - 1));
    //return the random sentence
    return sentences[index];
} 
```

要在 a 中显示随机句子`div`，可以使用如下函数：（请注意，此示例使用 jQuery 进行简化，并提供跨浏览器使用）：

```
//show a random sentences in a DOM selector
function showRandomSentence(selector){
    var randomSentence = getRandomSentence();  
    $(selector).html(randomSentence);
} 
```

要查看上述工作示例，请访问[此 jsFiddle](http://jsfiddle.net/joeyramone76/MEK8y/2/) ​</p>

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T16:54:52.963

数组对我来说似乎是一个不错的选择。你也可以这样定义：

```
var sentences = [
    'Can we go to the park.',
    'Where is the orange cat? Said the big black dog.',
    'We can make the bird fly away if we jump on something.',
    'We can go down to the store with the dog. It is not too far away.',
    'My big yellow cat ate the little black bird.',
    'I like to read my book at school.',
    'We are going to swim at the park.'
]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T17:01:44.497

这是一个活生生的[例子](http://jsfiddle.net/SzGEh/)。希望您使用的是 jquery。它使事情变得容易。

主要部分是这个，它从数组中选择随机句子。

```
 var randomIndex = Math.floor((Math.random()*Sentence.length)); //random number from [0,Sentence.length)
$("#sentence-div").text( Sentence[randomIndex] ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-07T17:05:39.330

就我个人而言，我认为您应该花一些时间来锻造一些实现[JSON](http://www.w3schools.com/json/default.asp)的东西。

虽然它会，本质上最终是一个数组...... JSON 可能更灵活，您可以根据需要嵌入有关该问题的更多信息。

我怀疑随着时间的推移，您的要求可能会变得更加复杂，并且解析一些 JSON 的额外时间是相当微不足道的。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
<title>Simple use of JSON</title>
<script type="text/javascript">
    //ultimately this will be in a file that you will access so you don't have to update code when the list changes.
    var sentence_json = '{ "sentences" : [{ "sentence" : "Can we go to the park.", "difficulty" : "1" },' + 
    '{ "sentence" : "Where is the orange cat? Said the big black dog.", "difficulty" : "2" },' + 
    '{ "sentence" : "We can make the bird fly away if we jump on something.", "difficulty" : "3" },' + 
    '{ "sentence" : "We can go down to the store with the dog. It is not too far away.", "difficulty" : "3" },' + 
    '{ "sentence" : "My big yellow cat ate the little black bird.", "difficulty" : "2" },' + 
    '{ "sentence" : "I like to read my book at school.", "difficulty" : "1" },' + 
    '{ "sentence" : "We are going to swim at the park.", "difficulty" : "1" }]}';

    //this should go through a parser... but for simplest example:
    var sentence_obj = eval ("(" + sentence_json + ")");
</script>
</head>
<body>
<p>
    Sentence: <span id="sentence"></span><br>
    Difficulty: <span id="difficulty"></span><br>
</p>
<script type="text/javascript">
    //here's where you use an iterator, but static for the example.
    document.getElementById("sentence").innerHTML=sentence_obj.sentences[1].sentence 
    document.getElementById("difficulty").innerHTML=sentence_obj.sentences[1].difficulty
</script>       
</body>
</html> 
```

简单地解决关于它是“最好”的问题，这是一种相对的。[这](http://jsfiddle.net/rwheadon/d8fv6/1/embedded/result/)是一个工作示例，我在其中添加了一个按钮“和东西”。

# html - reCAPTCHA 将我的内容的高度更改了大约 -20px

> ID：13767462
> 
> 赞同：5
> 
> 时间：2012-12-07T16:52:19.817
> 
> 标签：html, css, recaptcha

如果没有 reCAPTCHA，我的页面看起来像这样（[jsfiddle](http://jsfiddle.net/BXufS/)）：

```
<html>
<body>

<div class="content_wrap">
    <div class="left_container">
    </div>

    <div class="right_container">
        <div style="background-color: blue; margin:0px; height: 1500px;">
        <!--RECAPTCHA WOULD GO HERE-->
        </div>
    </div>

</div>

</body>
</html> 
```

CSS：

```
body,html {
    height: 100%;
    width: 100%;
    background-color: #f8f8f8;
}

div.content_wrap {
    width: 100%;
    position: relative;
}

div.left_container {
    float:left;
    position:absolute;
    width: 220px;
    min-height: 100%;
    background-color: red;
}

div.right_container {
    position: relative;
    padding: 0px;
    margin-left: 220px;
    width: 1000px;
} 
```

​</p>

使用 reCAPTCHA（在蓝色区域），整个页面内容的高度在底部减少了约 20 像素，并带有可见的空白条。

有没有人在 reCAPTCHA 更改布局元素时遇到问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T02:05:50.000

我已经能够根据[这个 reCAPTCHA jsfiddle 示例](http://jsfiddle.net/hqv27/)[复制您的问题](http://jsfiddle.net/BXufS/5/)。

看起来 reCAPTCHA 会导致`iframe`在页面底部附加一个空白。

```
<iframe src="about:blank" style="height: 0px; width: 0px; visibility: hidden; border: none;">
    This frame prevents back/forward cache problems in Safari.
</iframe> 
```

[谷歌搜索](https://www.google.com/search?q=This%20frame%20prevents%20back/forward%20cache%20problems%20in%20Safari.)消息中的结果`iframe`，引起了很多关于这个问题的讨论。

这是在 SO 上找到的解决方案：[Recaptcha 在页面上创建 iFrame，破坏样式](https://stackoverflow.com/questions/8155645/recaptcha-creates-iframe-on-page-breaks-styling)

> 试试下面的 CSS：
> 
> ```
> /* ReCaptcha Iframe FIX */
> iframe {display:none !important;}
> header iframe,
> section iframe,
> footer iframe,
> div iframe { display:inline; } 
> ```
> 
> 如果您在网站上没有任何其他框架需要担心，一个更简单的版本就足够了：
> 
> ```
> iframe {display:none !important;} 
> ```

最后，这是实施了解决方案的 jsfiddle：http: [//jsfiddle.net/BXufS/7/](http://jsfiddle.net/BXufS/7/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-21T20:55:36.833

`src`我通过在 CSS 中定位 iframe 属性来解决这个问题

```
<iframe src="about:blank" style="height: 0px; width: 0px; visibility: hidden; border: none;"></iframe>

iframe[src="about:blank"] { display: none; } 
```

当然，我没有其他带有`about:blank`源的 iframe ;)

# postgresql - 具有模式支持的 postgresql 副本

> ID：13767464
> 
> 赞同：1
> 
> 时间：2012-12-07T16:52:23.107
> 
> 标签：postgresql, multi-tenant

我正在尝试使用 postgresql COPY 命令从 CSV 加载一些数据。诀窍是我想在用户标识（包含在 CSV 中）上实现多租户。在加载 csv 时，是否有一种简单的方法可以告诉 postgres 复制命令根据此用户 ID 进行过滤？

即所有带有userid=x 的行转到schema=x，带有userid=y 的行转到schema=y。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:03:08.790

仅使用 COPY 命令无法做到这一点，但您可以将所有数据复制到主表中，然后组合一个简单的 PL/PGSQL 函数为您完成此操作。像这样的东西-

```
CREATE OR REPLACE FUNCTION public.spike()
    RETURNS void AS
$BODY$
    DECLARE
        user_id integer;
        destination_schema text;
    BEGIN
        FOR user_id IN SELECT userid FROM master_table GROUP BY userid LOOP
            CASE user_id
            WHEN 1 THEN
                destination_schema := 'foo';
            WHEN 2 THEN
                destination_schema := 'bar';
            ELSE
                destination_schema := 'baz';
            END CASE;

            EXECUTE 'INSERT INTO '|| destination_schema ||'.my_table SELECT * FROM master_table WHERE userid=$1' USING user_id;
            -- EXECUTE 'DELETE FROM master_table WHERE userid=$1' USING user_id;

        END LOOP;

            TRUNCATE TABLE master_table;

        RETURN;
    END;
$BODY$
    LANGUAGE 'plpgsql' VOLATILE
    COST 100; 
```

这会从 master_table 中获取所有唯一的 user_id，使用 CASE 语句确定目标模式，然后执行 INSERT SELECT 移动行，最后删除移动的行。

# ipad - MonoTouch：Settings.bundle 文件问题

> ID：13767465
> 
> 赞同：1
> 
> 时间：2012-12-07T16:52:22.597
> 
> 标签：ipad, xamarin.ios, ios6, settings.bundle, root.plist

[我一直在尝试为我的应用程序设置设置，但即使我一遍又一遍地查看它并将其与书中的示例和 Craig Dunn 博客上](http://conceptdev.blogspot.co.uk/2009/08/monotouch-settingsbundle.html)的示例进行比较，我似乎无法使其正常工作。

我知道语法必须是完美的，而且这个文件非常简单，目前我只是想显示一个文本字段。我确实在一个全新的项目中短暂地完成了这项工作，但是从那以后我一直没有设法让它工作。

这是我的 Root.plist 文件的 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>Root</key>
<dict>
    <key>PreferenceSpecifiers</key>
    <array>
        <dict>
            <key>Title</key>
            <string>Group Name</string>
            <key>Type</key>
            <string>PSGroupSpecifier</string>
        </dict>
        <dict>
            <key>AutocapitalizationType</key>
            <string>None</string>
            <key>AutocorrectionType</key>
            <string>No</string>
            <key>Key</key>
            <string>usernameTextField</string>
            <key>Title</key>
            <string>Username</string>
            <key>Type</key>
            <string>PSTextFieldSpecifier</string>
        </dict>
    </array>
</dict>
</dict>
</plist> 
```

正如我所说，我已经看过很多次了，我看不出它有任何问题。文件构建操作设置为内容，复制到输出目录设置为始终复制。我使用的 MonoTouch 版本是 6.0.7。

我将不胜感激有关此问题的任何帮助。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T16:04:42.373

1.  确保 Settings.bundle 目录包含在项目的顶层。顶级，我的意思是在文件系统上，Settings.bundle 目录应该与您的 ProjectName.csproj 文件位于同一目录中。在 MonoDevelop 中，它将显示为项目节点下的顶级文件夹之一。

2.  将 Root.plist 构建操作设置为 BundleResource（不要启用“复制到输出目录”。提示：如果您发现自己设置了“复制到输出目录”，请不要这样做 - 这几乎总是错误的做法 - 我们'实际上已经讨论过完全删除该选项。）

现在，对于 plist 文件格式 - 它应该是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>PreferenceSpecifiers</key>
    <array>
        <dict>
            <key>Type</key>
            <string>PSGroupSpecifier</string>
            <key>Title</key>
            <string>Group Name</string>
        </dict>
        <dict>
            <key>Type</key>
            <string>PSTextFieldSpecifier</string>
            <key>Title</key>
            <string>Username</string>
            <key>AutocapitalizationType</key>
            <string>None</string>
            <key>AutocorrectionType</key>
            <string>No</string>
            <key>KeyboardType</key>
            <string>Alphabet</string>
            <key>IsSecure</key>
            <false/>
            <key>Key</key>
            <string>usernameTextField</string>
            <key>DefaultValue</key>
            <string></string>
        </dict>
    </array>
    <key>StringsTable</key>
    <string>Root</string>
</dict>
</plist> 
```

查看您的 Root.plist 文件，似乎 PreferenceSpecifiers 键不在顶级 dict 节点中（它必须在）。换句话说：

删除文件顶部的以下行：

```
<dict>
<key>Root</key> 
```

...以及文件末尾的以下行之一：

```
</dict> 
```

应该这样做...

现在......说了这么多，我最近在尝试将设置添加到我的个人项目时自己发现了这一点，并决定我们在 Xamarin 需要让这更容易。我已经在即将发布的 MonoDevelop 3.1 中修复了一些小问题，但我希望有时间将 Settings.bundle 的模板添加到 MonoDevelop 的“添加新文件”向导中。我还想像 Info.plist 和 Entitlements.plist 一样添加 plist 键/值提示，以便 MonoDevelop 的 plist 编辑器在编辑这些 plist 文件时可以更好地指导您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:18:08.650

对于初学者，您缺少结束 plist`</plist>`标记。我目前的只有一个设置，但它可以工作。您可以与您的进行比较以查看差异：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" 
    "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
  <key>PreferenceSpecifiers</key>
  <array>
      <dict>
          <key>Type</key>
          <string>PSToggleSwitchSpecifier</string>
          <key>Title</key>
          <string>Stay Signed-In</string>
          <key>Key</key>
          <string>staySignedIn</string>
          <key>DefaultValue</key>
          <true/>
      </dict>
    </array>
</dict>
</plist> 
```

我希望这有帮助。

# javascript - jQuery 在 Home 键中设置光标

> ID：13767466
> 
> 赞同：0
> 
> 时间：2012-12-07T16:52:27.970
> 
> 标签：javascript, jquery

我想在提交的追加中键入两个数字`/`并在主页中设置光标。

我家的意思是，`Home`键盘上的键： [![在此处输入图像描述](../Images/a05618a54a148b2c1b1b718e9451947a.png)](https://i.stack.imgur.com/ytH4h.png)

我尝试：（在我的代码中运行 Home 键这个添加`$`）

```
<input type="text" class="num" maxlength="2"/>
​
$(".num").keypress(function(e){
    var val = this.value;
    var value =  val + String.fromCharCode('36');
    (val.length == '2') ? $(this).val(value+'/') : '';
});​ 
```

**演示：http:** [//jsfiddle.net/3ePxg/](http://jsfiddle.net/3ePxg/)

怎么可能做到？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:04:33.087

当`2`在输入中输入时，我们可以附加`/`并转到输入字段的开头（左侧）：我不跟随`Home`键 - 你想用它发生什么（如果你的意思是把光标放在输入字段的开头看看[这个](https://stackoverflow.com/questions/2127221/move-cursor-to-the-beginning-of-the-input-field)）？但是，对于to be`keypress`事件，我们可以这样做：`2``2/`

```
$(".num").on('keypress', function(e){
    if (e.keyCode == 50) {
        var input = $(e.target);
        input.val(input.val() + '2/');
        input.focus();
        e.target.setSelectionRange(0,0);
    }
});​ 
```

演示：[jsfiddle](http://jsfiddle.net/3ePxg/11/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:33:09.440

尝试这个：

js：

```
//based on script from here: http://stackoverflow.com/a/4085357/815386 -> http://blog.vishalon.net/index.php/javascript-getting-and-setting-caret-position-in-textarea
function setCaretPosition(ctrl, pos) {
    if (ctrl.setSelectionRange) {
        ctrl.focus();
        ctrl.setSelectionRange(pos, pos);
    }
    else if (ctrl.createTextRange) {
        var range = ctrl.createTextRange();
        range.collapse(true);
        range.moveEnd('character', pos);
        range.moveStart('character', pos);
        range.select();
    }
}

function GetCaretPosition(ctrl) {
    var CaretPos = 0; // IE Support
    if (document.selection) {
        ctrl.focus();
        var Sel = document.selection.createRange();
        Sel.moveStart('character', -ctrl.value.length);
        CaretPos = Sel.text.length;
    }
    // Firefox support
    else if (ctrl.selectionStart || ctrl.selectionStart == '0') CaretPos = ctrl.selectionStart;
    return (CaretPos);
}

$(".num").keyup(function(e) {
    var val = this.value;
    if (val.length >= '2') {
        var value = val.substr(0, 2);
        var pos=GetCaretPosition(this);
        $(this).val(value + '/');
        setCaretPosition(this, pos);
        console.log(GetCaretPosition(this));
        if (pos >= 2) {
            setCaretPosition(this, 0);
            return false;
        }
    }
});​ 
```

[演示](http://jsfiddle.net/oceog/3ePxg/9/)

# bash - Bash 读取 LINE 与读取 -n LINE

> ID：13767472
> 
> 赞同：1
> 
> 时间：2012-12-07T16:53:14.043
> 
> 标签：bash, shell

如果我在 bash 中执行 while read LINE 循环，则从 stdin 读取大量输入的效率非常低，因为它根本没有缓冲。

使用 while read -n 4096 LINE 会提供临时缓冲，允许 bash 更有效地执行大输入的读取吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:00:08.633

不可以。您可以使用以下方法验证一次读取是否执行一项：

```
echo foo | strace bash -c 'read -n 100 f' 
```

并看到单次读取需要 4 个系统调用。但是很容易实现你想要的。要将最多 4096 个字节从 stdin 放入变量中，请使用进程替换：

```
bash -c 'r=$( dd bs=4096 count=1 2> /dev/null); echo "$r"' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:06:40.947

`-N`( 而不是)`-n`选项将读取换行符。

# python - Python酸洗保持对象身份

> ID：13767474
> 
> 赞同：3
> 
> 时间：2012-12-07T16:53:15.293
> 
> 标签：python, python-3.x, identity, pickle

有没有办法保留腌制对象的身份，即有以下打印`True`：

```
import pickle

class Foo:
    pass

x = Foo()
print(x is pickle.loads(pickle.dumps(x)))          #False 
```

我在 Linux 机器上使用 cPickle 和 cpython 3.x，不需要可移植的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T17:30:26.037

是的，有可能; 您需要以某种方式在腌制结果中包含“身份”；在这种情况下，最自然的方法是使用`__getnewargs__`并让`__new__`方法返回现有的缓存实例。

```
import uuid
import weakref

class Foo(object):
    ident_cache = weakref.WeakValueDictionary()

    def __new__(cls, identity=None, **kwargs):
        if identity is None:
            identity = uuid.uuid1()
        try:
            self = cls.ident_cache[identity]
        except KeyError:
            self = super(Foo, cls).__new__(cls)
            self.__identity = identity
            self.__init__(**kwargs)
            cls.ident_cache[identity] = self
        return self

    def __getnewargs__(self):
        return (self.__identity,)

    def __init__(self, foo):
        self.foo = foo 
```

```
>>> import pickle
>>> a = Foo(foo=1)
>>> b = pickle.loads(pickle.dumps(a, pickle.HIGHEST_PROTOCOL))
>>> a is b
True 
```

重要的注意事项是您*必须*使用协议版本 2（或更高版本，假设）；因为否则，`__new__`永远不会被调用。这只是关心`pickle.dumps`，`loads`不关心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:02:15.793

```
import pickle

class Foo:
    _id_counter = 0
    def __init__(self):
        self._id = Foo._id_counter
        Foo._id_counter += 1

x = Foo()
print(x._id==pickle.loads(pickle.dumps(x))._id)     # True 
```

# menu - rootline 不适用于 TYPO3 4.5 菜单

> ID：13767480
> 
> 赞同：0
> 
> 时间：2012-12-07T16:53:27.830
> 
> 标签：menu, typo3

我在使用 TYPO3 时遇到问题。从 3.8 版开始，我已经使用它好几年了，但这是我第一个使用 4.5 版的网站，我在菜单和根目录方面遇到了问题。我相信这与根线的创建方式有关。将下面的代码用于面包屑/路径类型的菜单，仅显示当前页面。菜单仅`page X`在页面 X 中使用下面的示例和代码显示，它应该是

`home > section 1 > sb a > page X`

```
home
--- section 1
------- sub A
---------- page X
--- section 2 
```

此外，在显示菜单时，ACT 状态未正确激活。据我了解，路径/根行中的每个页面都应该激活 ACT 状态，并且下面的代码不会发生这种情况。这个版本有什么变化吗？到目前为止，我在 4.5 版中已经在许多站点中使用了这两个代码

代码

```
temp.breadcrumbs = HMENU
temp.breadcrumbs.special = rootline
#temp.breadcrumbs.includeNotInMenu = 1
#temp.breadcrumbs.special.range= -2 | -1
temp.breadcrumbs.special.range = 0
temp.breadcrumbs.1= TMENU
temp.breadcrumbs.1.noBlur = 1
temp.breadcrumbs.1.NO.allWrap= |&nbsp;&gt;&nbsp; |*||*|   |

## with and without line   ... special.range   ...

.....
....

temp.topmenu.1 {
   wrap = <ul>|</ul>
   # NO.allWrap = <li>|</li>  
  expAll = 1   
   NO.wrapItemAndSub = <li>|</li>  
   # Enable active state and set properties:
   ACT = 1
   ACT.wrapItemAndSub = <li class="current-menu-item">|</li>     
}
temp.topmenu.2 = TMENU
temp.topmenu.2.noBlur = 1
temp.topmenu.2 {
   wrap = <ul class="sub-menu">|</ul>
   NO.linkWrap = <li>|</li>  
   # Enable active state and set properties:
   ACT = 1
   ACT.linkWrap =  <li class="active">|</li>
   #ACT.allWrap = <li class="selected">|</li>
   #ACT.ATagBeforeWrap = 1
} 
```

谢谢

伊万。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:22:57.397

正如 cascaval 所写，声明开始和结束级别是很常见的，无论如何 0 值也是可以接受的，如 doc 中所写`entryLevel`

> 默认值为“0”，它为我们提供了网站上第一页的菜单。

`page X`可能您在已检查字段的地方放置了一些 TypoScript `Rootlevel`，因此它避免了向上遍历树。我在可用的第一个实现中检查了您的示例代码，它按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:14:21.823

范围应该定义为**[begin-level] | [最终级别]**所以尝试：

```
temp.breadcrumbs.special.range = 0|-1 
```

...或者...

```
temp.breadcrumbs.special.range = 1|-1 
```

*   **-1**表示当前页面。
*   **-2**表示从当前页面上一级的页面。

**注意：**您可能应该设置`temp.breadcrumbs.includeNotInMenu = 1`，因为通常您希望所有页面都包含在面包屑中（因为面包屑所代表的结构在其他情况下没有意义），即包括那些您不想出现在其他菜单中的页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-21T07:15:12.983

在 Typo3 6.2.14 中遇到了同样的问题，终于找到了解决方案。清除“下一级模板”后，rootline 运行良好。

原因：

*   根模板在根模板“下一级模板”中被引用。

解决方案：

*   编辑根模板
*   切换到选项卡文件夹“选项”
*   清除字段“下一级模板”

# php - php echo 无法正常工作

> ID：13767484
> 
> 赞同：0
> 
> 时间：2012-12-07T16:53:40.503
> 
> 标签：php, html, echo, forms, http-post

基本上，我想在 html 中制作一个简单的表单，并且我想在单击使用 php 提交后输出所有用户输入。到目前为止，它只是显示我输入的详细信息，但它没有让用户的数据回显它们。这是我的两个文件

输出.php：

```
<?php 
echo 'Name: '.$POST["name"].'<br /> Gender: '.$POST["gender"].'<br />Country: '.$POST["country"];
?> 
```

testingformphp.html（表单部分）：

```
 <form id="form" name="form" method="post" action="./PHP/output.php"/>
    Name<input name="name" type="text" id="name"/><br/>

    Gender<label><input type="radio" name="gender" id="gender_0" value="male"/>Male</label><br/>
    <label><input type="radio" name="gender" id="gender_1" value="female"/>Female</label><br/>

<select name="country" id="select">
    <optgroup title="europe">
    <option value="Russia">Russia</option>
    <option value="Greece">Greece</option>

    </optgroup>

    </select>

    <input type="submit" id="button" value="Submit"/>
    <input type="reset" id="reset" value="Reset"/>

    </form> 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T16:55:26.490

$POST 不存在，请尝试 $_POST。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:00:20.640

```
<?php 
echo 'Name: '.$_POST["name"].'<br /> Gender: '.$_POST["gender"].'<br />Country: '.$_POST["country"];
?> 
```

[http://www.tizag.com/phpT/postget.php](http://www.tizag.com/phpT/postget.php) 查看帖子并获取方法。

# c# - 无法将自定义 .css 添加到嵌套的 ASP.NET 表格单元控件

> ID：13767485
> 
> 赞同：0
> 
> 时间：2012-12-07T16:53:42.250
> 
> 标签：c#, asp.net, css

我遇到了一个问题，我无法将 .css 类分配给表格 -> 表格行 -> 表格单元内的个人 asp 控件。

但是，我可以直接使用反射添加“样式”（而不是“类”）。

前在这里看到：

在 .aspx 中：

```
 <asp:Table ID="_cellGrid" runat="server" CssClass="datagrid" Width="100%"></asp:Table> 
```

在 .cs 中：

```
TableRow dataTableRow = new TableRow() {  };
_cellGrid.Rows.Add(dataTableRow);

TableCell dataRowCell = new TableCell() {  };
dataTableRow.Cells.Add(dataRowCell);

Label label = new Label() { Text = "TEST" };
label.Attributes.Add("class", "custom");//THIS DOESN'T WORK
label.Attributes.Add("style", "background-color: Red; font-size:2.1em;");//THIS WORKS

dataRowCell.Controls.Add(label); 
```

在 .css 中：

```
.custom {    
background-color: Red;
font-size:2.1em;    
} 
```

.css 文件在我的母版页中被正确引用，我在同一个控件的其他地方（表之外）使用它。

我不希望在整个表格范围内使用“内联”样式 .css，并且我需要为表格单元格中的各个自定义控件分配不同的样式，因此我不能简单地捕获链接到 asp:Table 的“table_row”css或内置的东西（如果你不确定这是什么，请告诉我，我也有很好的例子）。

如果可以，请提供帮助，这似乎是一件简单的事情，但我们到了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:30:51.517

抱歉，这是我的缓存没有刷新的问题，我通常使用 chrome incognito 进行调试，所以我不习惯遇到这个问题。

干杯

# expect - 如何在期望中获取环境变量？

> ID：13767486
> 
> 赞同：0
> 
> 时间：2012-12-07T16:53:46.010
> 
> 标签：expect, tclsh

例如，我想使用登录时定义的 $USER 和 $HOSTNAME。然而

```
set g_user [exec echo \$USER] 
```

仅向我显示 \$USER 无法识别的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:29:57.933

该`env`数组是您需要的：

```
# if you use env in a procedure, you need to specify it is a global variable
global env
set g_user $env(USER) 
```

记录在[http://tcl.tk/man/tcl8.5/TclCmd/tclvars.htm](http://tcl.tk/man/tcl8.5/TclCmd/tclvars.htm)

# ios - GCDASyncSocket SSL 不连接

> ID：13767490
> 
> 赞同：1
> 
> 时间：2012-12-07T16:54:07.913
> 
> 标签：ios, cocoa, sockets, ssl, tcpclient

我的套接字连接正常工作，但服务器已更新为 SSL。我称这种方法为：

```
[socket startTLS:nil]; 
```

但我仍然无法与服务器建立安全连接。我像这样启动连接：

```
- (void) initNetworkCommunication {

    dispatch_queue_t mainQueue = dispatch_get_main_queue();
    socket = [[GCDAsyncSocket alloc] initWithDelegate:self delegateQueue:mainQueue];

    NSError *err = nil;
    if (![socket connectToHost:@"192.168.2.210" onPort:1333 viaInterface:@"" withTimeout:-1 error:&err]) // Asynchronous!
    {
            // If there was an error, it's likely something like "already connected" or "no delegate set"
        NSLog(@"I goofed: %@", err);
    }else
    {
        NSLog(@"Connecting...");
    }
    [socket readDataWithTimeout:-1 tag:1];

} 
```

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T11:56:34.037

我在进行 initNetworkCommunication 之后调用了 [socket startTLS:nil]，但它应该是在我们建立连接的那一刻，如下所示：

```
- (void) initNetworkCommunication {

    dispatch_queue_t mainQueue = dispatch_get_main_queue();
    socket = [[GCDAsyncSocket alloc] initWithDelegate:self delegateQueue:mainQueue];

    NSError *err = nil;
    if (![socket connectToHost:@"192.168.2.210" onPort:1333 viaInterface:@"" withTimeout:-1 error:&err]) // Asynchronous!
    {
            // If there was an error, it's likely something like "already connected" or "no delegate set"
        NSLog(@"I goofed: %@", err);
    }else
    {
        [socket startTLS:nil];
        NSLog(@"Connecting...");

        }
        [socket readDataWithTimeout:-1 tag:1];

} 
```

# python - Python，os.walk()，传回信息？

> ID：13767491
> 
> 赞同：1
> 
> 时间：2012-12-07T16:54:10.910
> 
> 标签：python, recursion, os.walk

我目前正在尝试编写一个简单的 python 程序，该程序循环遍历一堆子目录，查找 java 文件并打印有关某些关键字使用次数的一些信息。我已经设法让这个大部分工作。我遇到的问题是打印有关更高目录的整体信息，例如，我当前的输出如下：

```
testcases/part1/testcase2/root_dir:
    0   bytes     0   public     0   private     0   try     0   catch
testcases/part1/testcase2/root_dir/folder1:
    12586   bytes     19   public     7   private     8   try     22   catch
testcases/part1/testcase2/root_dir/folder1/folder5:
    7609   bytes     9   public     2   private     7   try     11   catch
testcases/part1/testcase2/root_dir/folder4:
    0   bytes     0   public     0   private     0   try     0   catch
testcases/part1/testcase2/root_dir/folder4/folder2:
    7211   bytes     9   public     2   private     4   try     9   catch
testcases/part1/testcase2/root_dir/folder4/folder3:
    0   bytes     0   public     0   private     0   try     0   catch 
```

我希望输出为：

```
testcases/part1/testcase2/root_dir :
    27406  bytes    37  public    11  private    19  try    42  catch
testcases/part1/testcase2/root_dir/folder1 :
    20195  bytes    28  public     9  private    15  try     33  catch
testcases/part1/testcase2/root_dir/folder1/folder5 :
    7609  bytes     9  public     2  private     7  try      11  catch
testcases/part1/testcase2/root_dir/folder4 :
    7211  bytes     9  public     2  private     4  try     9  catch
testcases/part1/testcase2/root_dir/folder4/folder2 :
    7211  bytes     9  public     2  private     4  try     9  catch
testcases/part1/testcase2/root_dir/folder4/folder3 :
    0  bytes        0  public     0  private     0  try     0  catch 
```

如您所见，较低的子目录直接将信息提供给较高的子目录。这是我遇到的问题。如何有效地实现这一点。我考虑过将每个打印内容存储为列表中的字符串，然后在最后打印所有内容，但我认为这不适用于多个子目录，例如提供的示例。到目前为止，这是我的代码：

```
def lsJava(path):

print()

for dirname, dirnames, filenames in os.walk(path):

    size = 0
    public = 0
    private = 0
    tryCount = 0
    catch = 0

    #Get stats by current directory.
    tempStats = os.stat(dirname)

    #Print current directory information

    print(dirname + ":")

    #Print files of directory.
    for filename in filenames:
        if(filename.endswith(".java")):
            fileTempStats = os.stat(dirname + "/" + filename)
            size += fileTempStats[6]
            tempFile = open(dirname + "/" + filename)
            tempString = tempFile.read()
            tempString = removeComments(tempString)
            public += tempString.count("public", 0, len(tempString))
            private += tempString.count("private", 0, len(tempString))
            tryCount += tempString.count("try", 0, len(tempString))
            catch += tempString.count("catch", 0, len(tempString))

    print("       ", size, "  bytes    ", public, "  public    ",
        private, "  private    ", tryCount, "  try    ", catch,
        "  catch") 
```

removeComments 函数使用正则表达式模式简单地从 java 文件中删除所有注释。感谢您提前提供任何帮助。

编辑：

在 for 循环的开头添加了以下代码：

```
 current_dirpath = dirname

    if( dirname != current_dirpath):
        size = 0
        public = 0
        private = 0
        tryCount = 0
        catch = 0 
```

现在的输出如下：

```
testcases/part1/testcase2/root_dir/folder1/folder5:
    7609   bytes     9   public     2   private     7   try     11   catch
testcases/part1/testcase2/root_dir/folder1:
    20195   bytes     28   public     9   private     15   try     33   catch
testcases/part1/testcase2/root_dir/folder4/folder2:
    27406   bytes     37   public     11   private     19   try     42   catch
testcases/part1/testcase2/root_dir/folder4/folder3:
    27406   bytes     37   public     11   private     19   try     42   catch
testcases/part1/testcase2/root_dir/folder4:
    27406   bytes     37   public     11   private     19   try     42   catch
testcases/part1/testcase2/root_dir:
    27406   bytes     37   public     11   private     19   try     42   catch 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:07:38.620

`os.walk()`接受一个可选`topdown`参数。如果您使用`os.walk(path, topdown=False)`它将自下而上遍历目录。

当您第一次启动循环时，将元组的第一个元素（dirpath）保存为变量，如`current_dirpath`. 当您继续循环时，您可以保持该目录中文件大小的总和。然后只需添加一个像 一样的检查`if dirpath != current_dirpath`，此时您知道您已经上升了一个目录级别，并且可以重置总数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:53:21.817

我不相信你可以用一个计数器来做到这一点，即使是自下而上：如果目录 A 有子目录 B 和 C，当你完成 B 后，你需要在进入 C 之前将计数器归零；但是到了做A的时候，你需要把B和C的尺寸相加（但是B的计数早就没有了）。

与其维护单个计数器，不如建立一个字典，将每个目录（键）映射到相关的计数（在元组或其他形式中）。当您迭代（自下而上）时，无论何时您准备好打印一个目录的输出，您都可以查找它的所有子目录（从`dirname`返回的参数中`os.walk()`）并将它们的计数加在一起。

由于您不丢弃数据，因此可以扩展此方法以维护单独的深度计数和浅计数，以便在扫描结束时您可以按浅计数对目录进行排序，报告 10 个最大计数等。

# asp.net - 无法使用带有水晶报表的数据集查看参数

> ID：13767495
> 
> 赞同：0
> 
> 时间：2012-12-07T16:54:42.307
> 
> 标签：asp.net, stored-procedures, parameters, crystal-reports, dataset

我已经处理这个问题超过 6 个月了，当我创建一个数据集并在数据集中我调用一个存储过程，然后将此数据集调用到我的报告中（水晶报告）我看不到参数字段：

![在此处输入图像描述](../Images/f07aa584c6e1bf2e7067df37c4c8e228.png)

我尝试在 sqlcommand 中创建参数，然后使用 rpt.setParameters("@a","sample"); 将参数添加到我的报告中。但我有一个错误。

我能做什么？请帮助我，我对此感到非常绝望和愤怒

我的代码（对不起，如果它是西班牙语）：

```
Dim cmd As New SqlCommand("prd_generarReporteOP", cn) 
cmd.CommandType = CommandType.StoredProcedure 
cmd.Parameters.Add("@idop", SqlDbType.Int).Value = CInt(Session("idop"))
cmd.Parameters.Add("@producto", SqlDbType.VarChar).Value = ""      
Dim da As New SqlDataAdapter da.SelectCommand = cmd 
Dim ds As New DataSetOP da.Fill(ds, "DataSetOP") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:28:08.393

您需要更改数据源。由于您使用 the`dataset`作为数据源，因此您已经获得了过滤后的结果。

您需要使用`stored-procedure`作为您的数据源，然后参数将出现

# javascript - History.js - AJAX 加载页面的共享链接

> ID：13767502
> 
> 赞同：0
> 
> 时间：2012-12-07T16:55:21.267
> 
> 标签：javascript, jquery, ajax, html

当我单击某些链接时，我具有以下功能：

```
function showPage(page) {
    var History = window.History;
    History.pushState(null,null,page);
    $("#post-content").load(page + ".php");
} 
```

页面内容更新，URL 改变。但是我知道我肯定做错了什么。例如刷新页面时，它给了我页面未找到错误，加上新页面的链接无法共享，只是因为同样的原因。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T18:22:24.570

听起来您没有将动态 URL 路由到您的主应用程序。除非`page`引用服务器上的物理文件，否则如果您希望这些 URL 可以用于任何事情，而不仅仅是作为浏览器历史记录中的占位符，则需要在服务器端进行一些 URL 重写。如果您不想弄乱服务器端，则需要使用另一种策略，例如使用[hashes](http://mtrpcic.net/2011/02/fragment-uris-theyre-not-as-bad-as-you-think-really/)破解 URL 。这样，服务器仍然始终为您的主应用程序页面提供服务，然后应用程序页面读取 URL 附加内容以确定需要动态呈现的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:03:15.340

您需要停止依赖 JavaScript 来构建页面。

服务器必须能够自己构建它们。

然后，您可以使用 JavaScript ( + Ajax)[逐步增强](http://en.wikipedia.org/wiki/Progressive_enhancement)`pushState`以将前一页转换为目标页，而无需重新加载所有共享内容。

你的问题是你在建立基础之前已经完成了“增强”。

# android - Android：拍照并保存到指定文件夹

> ID：13767506
> 
> 赞同：2
> 
> 时间：2012-12-07T16:55:26.580
> 
> 标签：android, camera, storage, directory

我有这个代码：

```
public void onCreate(Bundle savedInstanceState){ 
    super.onCreate(savedInstanceState);
    setContentView(R.layout.inventario);
    Button scatta=(Button) findViewById(R.id.scatta_foto);
    scatta.setOnClickListener(new OnClickListener(){
        public void onClick(View v){
            Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
            startActivityForResult(cameraIntent, 2);
        }
    });
}
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == 2) {
        Bitmap photo = (Bitmap) data.getExtras().get("data");
        ImageView test = (ImageView) findViewById(R.id.anteprima);
        test.setImageBitmap(photo);
        try{
            SimpleDateFormat sdf = new SimpleDateFormat("yyyyMMdd_HHmmss");
            String currentDateandTime = sdf.format(new Date()).replace(" ","");
            FileOutputStream out = new FileOutputStream(Environment.getExternalStorageDirectory().getAbsolutePath() + "/bao/bao"+currentDateandTime+".jpg");
            photo.compress(Bitmap.CompressFormat.JPEG, 90, out);
        }catch (Exception e){
            e.printStackTrace();
        }
    }
} 
```

我知道它可以工作（照片是拍摄的，并且由于保管箱，我确定它可以工作），但它没有出现在 ImageView 和文件管理器中！如何将照片放在指定目录（/sdcard/my-app/）和 imageview 中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T18:30:05.523

设置文件路径：

```
public final static String APP_PATH_SD_CARD = "/bao"; 
```

您可以按以下方式保存图像：

```
String fullPath = Environment.getExternalStorageDirectory().getAbsolutePath() + APP_PATH_SD_CARD;

        try {
            File dir = new File(fullPath);
            if (!dir.exists()) {
                dir.mkdirs();
            }
            SimpleDateFormat sdf = new SimpleDateFormat("yyyyMMdd_HHmmss");
            String currentDateandTime = sdf.format(new Date()).replace(" ","");
            OutputStream fOut = null;
            File file = new File(fullPath, currentDateandTime);
            file.createNewFile();
            fOut = new FileOutputStream(file);

            // 100 means no compression, the lower you go, the stronger the compression
            bm.compress(Bitmap.CompressFormat.PNG, 100, fOut);
            fOut.flush();
            fOut.close();
        } 
```

您现在可以从该路径检索该图像：

```
ImageView picture = (ImageView) findViewById(R.id.imageView);
String pathName = Environment.getExternalStorageDirectory().getPath() + "/boa/" + "nameofimage.png";
File path = new File(pathName);
if(path.exists()){
    BitmapFactory.Options options = new BitmapFactory.Options();
    bm = BitmapFactory.decodeFile(pathName, options);
    picture.setImageBitmap(bm);
}
 else{
     //Set default picture or do nothing.
} 
```

# css - 将 CSS 样式应用于行悬停时的第一个表格单元格

> ID：13767507
> 
> 赞同：2
> 
> 时间：2012-12-07T16:55:32.023
> 
> 标签：css, hover

我有一个包含两个单元格的表格行。我怎样才能使当我悬停该行时，只有第一个表格单元格的背景会改变颜色？

```
#formTable tr:hover {
   background:red; // only want the first cell to change...
                   // ...this will do the whole row
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-07T16:57:54.073

这应该有效：

```
#formTable tr:hover td:first-child {
   background:red;
} 
```

:first-child: [https://developer.mozilla.org/en-US/docs/CSS/:first-child](https://developer.mozilla.org/en-US/docs/CSS/:first-child)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T16:58:40.683

这只会更改第一行的第一个单元格：

```
#formTable tr:first-child:hover td:first-child{
    background-color: red;
} 
```

这将更改任何行的第一个单元格：

```
#formTable tr:hover td:first-child{
    background-color: red;
} 
```

# sql - sql查询比预期慢

> ID：13767513
> 
> 赞同：1
> 
> 时间：2012-12-07T16:55:59.047
> 
> 标签：sql, left-join, phpbb

在我在这里显示查询之前是相关的表定义：

```
CREATE TABLE phpbb_posts (
    topic_id mediumint(8) UNSIGNED DEFAULT '0' NOT NULL,
    poster_id mediumint(8) UNSIGNED DEFAULT '0' NOT NULL,
    KEY topic_id (topic_id),
    KEY poster_id (poster_id),
);

CREATE TABLE phpbb_topics (
    topic_id mediumint(8) UNSIGNED NOT NULL auto_increment
); 
```

这是我要执行的查询：

```
SELECT p.topic_id, p.poster_id 
FROM phpbb_topics AS t 
LEFT JOIN phpbb_posts AS p 
   ON p.topic_id = t.topic_id 
      AND p.poster_id <> ... 
WHERE p.poster_id IS NULL; 
```

基本上，该查询试图查找除目标用户以外的其他人发布的次数为零的所有主题。换句话说，唯一发帖的人就是目标用户的话题。

问题是查询需要很长时间。这是它的解释：

```
Array
(
    [id] => 1
    [select_type] => SIMPLE
    [table] => t
    [type] => index
    [possible_keys] =>
    [key] => topic_approved
    [key_len] => 1
    [ref] =>
    [rows] => 146484
    [Extra] => Using index
)
Array
(
    [id] => 1
    [select_type] => SIMPLE
    [table] => p
    [type] => ref
    [possible_keys] => topic_id,poster_id,tid_post_time
    [key] => tid_post_time
    [key_len] => 3
    [ref] => db_name.t.topic_id
    [rows] => 1
    [Extra] => Using where; Not exists
) 
```

对于 SQL，我的一般假设是任何 JOIN 都非常快，并且可以在所有相关列都是主键或外键（在本例中是）的情况下立即完成。

我尝试了其他一些查询：

```
SELECT COUNT(1) 
    FROM phpbb_topics AS t 
    JOIN phpbb_posts AS p 
        ON p.topic_id = t.topic_id; 
```

很快就会返回 353340。

然后我做这些：

```
SELECT COUNT(1) 
    FROM phpbb_topics AS t 
    JOIN phpbb_posts AS p 
        ON p.topic_id = t.topic_id
            AND p.poster_id <> 77198;

SELECT COUNT(1) 
    FROM phpbb_topics AS t 
    JOIN phpbb_posts AS p 
        ON p.topic_id = t.topic_id
    WHERE p.poster_id <> 77198; 
```

这两个都需要相当长的时间（15-30秒之间）。如果我将 <> 更改为 a = 则根本不需要时间。

我做了一些不正确的假设吗？也许我的数据库只是 foobar'd？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:02:53.307

我认为将索引替换`phpbb_posts(topic_id)`为 2 个字段上的复合索引应该可以提高查询的性能：

```
CREATE TABLE phpbb_posts (
topic_id mediumint(8) UNSIGNED DEFAULT '0' NOT NULL,
poster_id mediumint(8) UNSIGNED DEFAULT '0' NOT NULL,
--KEY topic_id (topic_id), 
KEY topic_id_poster_id (topic_id,poster_id)
KEY poster_id (poster_id),
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:07:51.203

你的索引对我来说已经足够了......你能试试这个查询，让我知道性能与你原来的比较吗？

```
SELECT sub.topic_id
FROM (
    SELECT t.topic_id
    FROM phpbb_topics AS t 
    WHERE
        EXISTS (
            SELECT *
            FROM phpbb_posts p
            WHERE 
                p.topic_id = t.topic_id
                AND p.poster_id = 77198
        )
) sub
WHERE 
    NOT EXISTS (
        SELECT *
        FROM phpbb_posts p
        WHERE 
            p.topic_id = sub.topic_id
            AND p.poster_id <> 77198
) 
```

我的想法是，通过将主题限制为仅相关海报实际发布的主题，反加入（在这种情况下使用`NOT EXISTS`而不是 a 实现`LEFT JOIN`）将必须检查的海报主题要少得多，而不是搜索。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T20:36:27.753

```
SELECT t.topic_id 
FROM phpbb_topics AS t 
JOIN phpbb_posts AS p1
   ON p1.topic_id = t.topic_id
      AND p1.poster_id = $poster_id
LEFT JOIN phpbb_posts AS p2 
   ON p2.topic_id = t.topic_id 
      AND p2.poster_id <> $poster_id
WHERE p2.poster_id IS NULL 
```

这让它快了一吨。我正在获取目标用户发布的所有帖子，并附有主题信息，然后获取除目标用户之外的所有发布者。

p1.poster_id 列中会有很多重复项，但是由于我实际上没有得到该行，因此我认为该列中的重复项并不重要。

谢谢！

# java - 单击 JTextField 中的图标并清除其内容

> ID：13767514
> 
> 赞同：4
> 
> 时间：2012-12-07T16:55:59.610
> 
> 标签：java, click, icons, jtextfield

我正在尝试创建一个带有图像和提示的 JTextField。文本字段的功能是搜索一些书籍的搜索字段。现在，我想走得更远一点。我想给图像一个功能。例如，如果我单击图像，则应清除文本字段中的文本。

为了实现这个实现，我创建了一个新类并使用 JTextField 对其进行了扩展。

这是代码：

```
public class JSearchTextField extends JTextField implements FocusListener {

/**
 * 
 */
private static final long serialVersionUID = 1L;
private String textWhenNotFocused;
private Icon icon;
private Insets dummyInsets;
private JTextField dummy;

public JSearchTextField() {
    super();

    Border border = UIManager.getBorder("TextField.border");
    dummy = new JTextField("Suchen...");
    this.dummyInsets = border.getBorderInsets(dummy);

    icon = new ImageIcon(JSearchTextField.class.getResource("/images/clearsearch.png"));
    this.addFocusListener(this);

}

public JSearchTextField(String textWhenNotFocused) {
    this();
    this.textWhenNotFocused = textWhenNotFocused;
}

public void setIcon(ImageIcon newIcon){
    this.icon = newIcon;
}

public String getTextWhenNotFocused() {
    return this.textWhenNotFocused;
}

public void setTextWhenNotFocused(String newText) {
    this.textWhenNotFocused = newText;
}

public void paintComponent(Graphics g){
    super.paintComponent(g);

    int textX = 2;

    if(!this.hasFocus() && this.getText().equals("")) {
        int height = this.getHeight();
        Font prev = this.getFont();
        Font italic = prev.deriveFont(Font.ITALIC);
        Color prevColor = g.getColor();
        g.setFont(italic);
        g.setColor(UIManager.getColor("textInactiveText"));
        int h = g.getFontMetrics().getHeight();
        int textBottom = (height - h) / 2 + h - 4;
        int x = this.getInsets().left;
        Graphics2D g2d = (Graphics2D) g;
        RenderingHints hints = g2d.getRenderingHints();
        g2d.setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING, 
                             RenderingHints.VALUE_TEXT_ANTIALIAS_ON);
        g2d.drawString(textWhenNotFocused, x, textBottom);
        g2d.setRenderingHints(hints);
        g.setFont(prev);
        g.setColor(prevColor);
    } else {
        int iconWidth = icon.getIconWidth();
        int iconHeight = icon.getIconHeight();
        int x = dummy.getWidth() + dummyInsets.right;
        textX = x - 420;
        int y = (this.getHeight() - iconHeight)/2;
        icon.paintIcon(this, g, x, y);
    }

    setMargin(new Insets(2, textX, 2, 2));

}
@Override
public void focusGained(FocusEvent arg0) {
    this.repaint();
}

@Override
public void focusLost(FocusEvent arg0) {
    this.repaint();
} 
```

}

这就是我创建字段的地方；

```
txtSearchBooks = new JSearchTextField("Buch suchen..."); 
```

现在回到我的问题。您知道如何为图像提供自动清除文本的功能吗？我试图实现一个 MouseListener 并将“txtSearchBooks”的文本设置为 null，但它没有奏效。

我希望我没有走错方向。

很抱歉这篇文章很长，但我真的很感激能得到一些建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T17:38:09.613

A`JTextField`是 a `JComponent`，意味着它也是其他组件的容器。您可以使用该`add(Component c)`方法向其中添加其他组件。BUT A`JTextField`不会显示其添加的组件，除非您向`LayoutManager`它提供 a。然后它的行为就像一个正常的`JPanel`.

我做了一个小例子，你可以如何管理你需要的东西。标签显示在右侧，单击它将清除该字段。您也可以使用按钮，而不是标签。

请注意，您不需要`Image`像我一样从头开始创建对象，您可以从文件中加载它。我以这种方式创建它，以便示例不依赖其他文件。

```
public class TextFieldWithLabel {
    public static void main(String[] args) 
    {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        final JTextField textField = new JTextField("Search...");
        textField.setLayout(new BorderLayout());

        //creating dummy image...
        Image image = new BufferedImage(25, 25, BufferedImage.TYPE_INT_RGB);
        Graphics graphics = image.getGraphics();
        graphics.setColor(Color.WHITE);
        graphics.fillRect(0, 0, 25, 25);
        graphics.setColor(Color.RED);
        graphics.fillRect(2, 11, 21, 3);
        graphics.fillRect(11, 2, 3, 21);

        JLabel label = new JLabel(new ImageIcon(image));
        textField.add(label, BorderLayout.EAST);
        label.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseClicked(MouseEvent e) {
                textField.setText("");
            }
        });
        frame.add(textField);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
} 
```

# objective-c - NSPredicate 对数组的数组

> ID：13767516
> 
> 赞同：4
> 
> 时间：2012-12-07T16:56:06.760
> 
> 标签：objective-c, nsarray, nsdictionary, nspredicate

我有一个数组，打印出来时看起来像这样：

```
(
        (
        数据库版本，
        13
    ),
        (
        锁定集ID，
        100
    )
)

```

是否可以使用`NSPredicate`（可能通过数组中的索引）来过滤它。像这样：给我元素0是'databaseVersion'的所有行？我知道如果我有一个字典数组，我可以使用类似于[此处](https://stackoverflow.com/questions/2506836/nspredicate-and-arrays)找到的谓词来做到这一点，但我发现当使用字典并存储大量数据时，我的内存消耗增加了（从 ~80mb 到 ~120mb )，所以如果可能的话，我会保留数组。关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T17:26:31.510

这可以在谓词中使用“SELF[index]”来完成：

```
NSArray *array = @[
    @[@"databaseVersion", @13],
    @[@"lockedSetId", @100],
    @[@"databaseVersion", @55],
    @[@"foo", @"bar"]
];

NSPredicate *pred = [NSPredicate predicateWithFormat:@"SELF[0] == %@", @"databaseVersion"];
NSArray *filtered = [array filteredArrayUsingPredicate:pred];
NSLog(@"%@", filtered); 
```

*输出：*

```
(
        (
        databaseVersion,
        13
    ),
        (
        databaseVersion,
        55
    )
) 
```

或者您可以使用基于块的谓词：

```
NSPredicate *pred = [NSPredicate predicateWithBlock:^BOOL(NSArray *elem, NSDictionary *bindings) {
    return [elem[0] isEqualTo:@"databaseVersion"];
}]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-11-18T11:39:29.337

只需在 NSPredicate中使用**ANY即可：**

它工作正常

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"ANY SELF == %@", @"value"]; 
```

或者

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"ANY SELF contains[cd] %@", @"value"]; 
```

# android - 错误项目上的 Android Lint 错误

> ID：13767521
> 
> 赞同：1
> 
> 时间：2012-12-07T16:56:18.530
> 
> 标签：android, eclipse, maven

我在 Eclipse 中有一个多模块 Maven Android 项目。

父模块显示属于仪器测试模块的 Android Lint 错误。模块本身没有显示这些错误。父模块本身不是 Android 项目（没有 Android Nature）

（Lint 抱怨我项目的 api-level 太低：Call requires API level 3 (current min is 1): )

什么可能导致问题？我以前从未见过父级子模块的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:48:39.960

我自己找到了解决方案。

**原因**：我对我的项目和 Eclipse 中的模块进行了一些重命名。

似乎 Android Lint 将警告/错误存储在一些持久性数据库/文件中。当使用重命名重构时，Eclipse 并不知道 Lint hat 为项目存储了一些警告，或者看起来如此。

重命名更改了项目名称，最终父项目获得了以前是应用程序模块的名称。不知何故，Android Lint 一定会感到困惑（我也是）。

**解决方案**：为了解决这个问题，我手动将 Android Nature 添加到我的父项目中（通过编辑 .project）。然后我使用 Android 工具删除了 Lint 警告。最后我再次删除了 Android Nature。

警告没有回来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-01T10:22:36.290

我遇到了问题，lint 将 80% 的布局和字符串标记为未使用。需要3个小时来修复它..

lint 的问题是我的一个班级中有一个带有 ß 的字符串（我一步一步添加了我所有的班级，并且每次都检查 lint ......）

```
String Eiweiß = new String(e.getString(e.getColumnIndex("Eiweiß"))); 
```

到

```
String Eiweis = new String(e.getString(e.getColumnIndex("Eiweiß"))); 
```

一定是皮毛虫……真气

希望这对任何人都有帮助；）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-07T17:08:53.053

Lint 是静态分析器工具，它会向您显示代码中存在的一些异常情况的警告。它们有时可能不正确/不相关。

为避免这种情况，您可以右键单击项目 -> 修复项目 -> 忽略 lint 错误

# c++ - Regex/grep/findstr 用于定位内存分配 C++

> ID：13767522
> 
> 赞同：1
> 
> 时间：2012-12-07T16:56:32.577
> 
> 标签：c++, regex, memory-management

我在一个项目的嵌套子文件夹中有很多源文件。我尝试替换 4 个不同的类，并希望找到源中分配它们的每个位置（堆 + 堆栈）。

不幸的是，由于包含结构不佳，无法信任 Visual Studio 的“搜索整个解决方案”功能，因此我不得不在源文件中进行手动搜索。

我认为就足够了：

`"new CLASS1("`三个标记之间的空格组合用于堆 `"^CLASS2"` ，我想说类名从行首开始（不包括空格）用于堆栈分配。

对于堆栈分配，`[^a-zA-Z] CLASS3 [a-zA-Z]+`尝试过，但我不熟悉正则表达式，所以想通过 SO 运行它。对于堆，只尝试了上面的那个字符串，但我知道一个简单的额外间距会破坏这种模式，所以我知道它是不正确的。

谁能想出一个更好的匹配器***，甚至是一个更好的方法来解决这个问题？***

谢谢，

AK

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:20:34.337

确保消除对类的所有使用的一种有保证的方法是简单地删除类的定义或使其某些关键部分无效。然后，当您编译项目时，您将在使用该类的每种情况下都会收到错误消息。当所有内容都成功编译后，您将知道所有内容都已被替换。

您当然可以通过对简单案例使用查找/替换来加快速度，然后手动修复任何剩余案例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T17:24:18.863

将构造函数设为私有，每次尝试创建对象时都会收到错误消息。

使用私有 new() 运算符对堆分配执行相同的操作。

**编辑：**注意创建自身实例的类实现（包括静态方法）内部的代码。从这样的上下文调用私有构造函数是有效的并且不会触发错误。还要注意朋友类/功能。

# maven - 我的工件似乎很大，可以由 maven 部署。我能做些什么？

> ID：13767525
> 
> 赞同：5
> 
> 时间：2012-12-07T16:56:52.637
> 
> 标签：maven, deployment, jenkins

我的 maven 3.0.3 版本在 Jenkins 中有一个`-Xmx1G`和设置。`-XX:MaxPermSize=500M`但是，当我进行部署时，我总是得到

```
java.lang.OutOfMemoryError: Java heap space
    at java.util.Arrays.copyOf(Arrays.java:2786)
    at java.io.ByteArrayOutputStream.write(ByteArrayOutputStream.java:94)
    at sun.net.www.http.PosterOutputStream.write(PosterOutputStream.java:61)
    at org.apache.maven.wagon.AbstractWagon.transfer(AbstractWagon.java:492)
    at org.apache.maven.wagon.AbstractWagon.transfer(AbstractWagon.java:457)
    at org.apache.maven.wagon.AbstractWagon.putTransfer(AbstractWagon.java:411)
    at org.apache.maven.wagon.AbstractWagon.transfer(AbstractWagon.java:392)
    at org.apache.maven.wagon.AbstractWagon.putTransfer(AbstractWagon.java:365)
    at org.apache.maven.wagon.StreamWagon.put(StreamWagon.java:163)
    at org.sonatype.aether.connector.wagon.WagonRepositoryConnector$PutTask.run(WagonRepositoryConnector.java:825)
    at org.sonatype.aether.connector.wagon.WagonRepositoryConnector.put(WagonRepositoryConnector.java:465)
    at org.sonatype.aether.impl.internal.DefaultDeployer.deploy(DefaultDeployer.java:278)
    at org.sonatype.aether.impl.internal.DefaultDeployer.deploy(DefaultDeployer.java:215)
    at org.sonatype.aether.impl.internal.DefaultRepositorySystem.deploy(DefaultRepositorySystem.java:480)
    at org.apache.maven.artifact.deployer.DefaultArtifactDeployer.deploy(DefaultArtifactDeployer.java:137)
    at org.apache.maven.plugin.deploy.AbstractDeployMojo.deploy(AbstractDeployMojo.java:167)
    at org.apache.maven.plugin.deploy.DeployMojo.execute(DeployMojo.java:188)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
    at org.jvnet.hudson.maven3.launcher.Maven3Launcher.main(Maven3Launcher.java:79)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597) 
```

要部署的工件`283M`很大。我该怎么做才能正确部署它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T11:41:41.720

这个问题是由[这个错误](http://jira.codehaus.org/browse/WAGON-272)引起的。如链接中所建议，只需使用 webdav 进行部署。

考虑执行以下操作：

```
<project>
  [...]
  <build>
    <extensions>
      <extension>
        <groupId>org.apache.maven.wagon</groupId>
        <artifactId>wagon-webdav</artifactId>
        <version>1.0</version>
      </extension>
    </extensions>  
    </plugin>
  </build>
  ...
  <distributionManagement>
    <site>
        <id>sample-project.website</id>
        <url>dav:https://dav.sample.com/sites/sample-project</url>
    </site>
  </distributionManagement>
  ...
</project> 
```

我以前遇到过这个问题。我相信它只发生在 >= 256 MB 的工件上。

切换到 webdav 部署方式后，还可以减少内存设置。（如果您只是由于部署期间的内存问题而专门修改了它们）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T14:59:55.457

这个答案简单地说@olamy 是对的：升级到 maven 3.0.4 解决了这个问题。

# c# - 在开发过程中绕过或关闭 [Authorize(Roles="")]？

> ID：13767527
> 
> 赞同：21
> 
> 时间：2012-12-07T16:56:53.470
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, authorization, authorize-attribute

构建一个 MVC3 应用程序，TPTB 希望我们使用他们的自定义授权提供程序。然而，在开发过程中，这个身份验证提供程序有点痛苦，因为它要么会给出错误，直到你关闭/重新启动浏览器，要么会要求你在每次编译时重新登录。

现在，我刚刚添加`<authentication mode="None"/>`到 web.config，它工作正常，直到我遇到使用`[Authorize(Roles = "Admin")]`过滤器的操作或控制器（它可以是任何角色，而不仅仅是管理员）。当它遇到其中一个时，它只会呈现一个空白页面。

有没有办法在全局范围内暂时关闭这些过滤器？或者只是在我开发时给用户所有角色？

**编辑**

让我澄清一下——我实际上是在将一个大型应用程序从 MVC2 移植到 MVC3。它有很多`[Authorize(Roles="Admin")]`并且`[Authorize(Roles="Admin,Editor")]`贯穿其中。如果可能的话，我宁愿不改变所有这些。

我是否应该创建一个自动提供所有角色的小型自定义角色提供程序？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-07T16:59:45.913

您可以编写一个自定义授权过滤器，如果请求来自以下位置，它将不执行任何检查`localhost`：

```
public class MyAuthorizeAttribute : AuthorizeAttribute
{
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        if (httpContext.Request.Url.IsLoopback)
        {
            // It was a local request => authorize the guy
            return true;
        }

        return base.AuthorizeCore(httpContext);
    }
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-12-07T17:01:08.773

您可以使用指令继承`AuthorizeAttribute`和分离实现。`#if DEBUG`

```
public class MyAuthorizeAttribute: AuthorizeAttribute
{
#if DEBUG
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        return true;
    }
#endif
} 
```

或者`#define YOUR_OWN_FLAG`在任何构建、调试或发布中打开和关闭行为。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-01-06T06:49:49.467

对于 Web API：

```
public class MyAuthorizeAttribute : System.Web.Http.AuthorizeAttribute
{
    protected override bool IsAuthorized(HttpActionContext actionContext)
    {
        return actionContext.Request.RequestUri.IsLoopback || base.IsAuthorized(actionContext);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-12-09T21:34:37.527

我也在寻找这个并最终像下面的代码一样解决。您可以在开发环境中添加 AllowAnonymousFilter，这将禁用开发环境中的授权。

```
if (env.IsDevelopment()) {
services.AddMvc(opts =>
{
   opts.Filters.Add(new AllowAnonymousFilter());
});
} else {
 services.AddMvc();
} 
```

# c++ - 循环和数组

> ID：13767530
> 
> 赞同：1
> 
> 时间：2012-12-07T16:57:02.217
> 
> 标签：c++, arrays, loops

嗨，我正在尝试构建一个循环来执行（C++）中 8 4 2 1 代码的 16 个状态

```
 while( condition)
   {
   double Bubble[16], Bubble1[16];
        Bubble[0] = ( a-2 - (b-2) ) + ( c-2 - (d-2)); // represents 0000
        Bubble[1] = ( a-2 - (b-2) ) + ( c-2 - (d+2)); // represents 0001
        Bubble[2] = ( a-2 - (b-2) ) + ( c+2 - (d-2)); // represents 0010
        Bubble[3] = ( a-2 - (b-2) ) + ( c+2 - (d+2)); //represents 0011
    .......
        Bubble[15] =(a+2 - (b+2) ) + ( c+2 - (d+2)); //represents 1111
  } 
```

有没有使用 for 循环编码的简单方法？而不是每次都写气泡[]？
0 代表-2，1 代表+2。所以我有 4 个变量，每个变量都需要递增和/或递减。这可以使用 for 循环来完成吗？

感谢你的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T17:02:12.780

我不完全确定您的代码在做什么，但您可以将其重写如下：

```
for (int i = 0; i < 16; i++) {
  double a_value = (i & 0x8) ? a+2 : a-2;
  double b_value = (i & 0x4) ? b+2 : b-2;
  double c_value = (i & 0x2) ? c+2 : c-2;
  double d_value = (i & 0x1) ? d+2 : d-2;
  Bubble[i] = (a_value - b_value) + (c_value - d_value);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T17:11:16.360

这是一个避免分支的版本：

```
double Bubble[16];
for(int i = 0 ; i < 16 ; i ++)
{
    int da,db,dc,dd;
    da = ((i&8) - 4) >> 1;
    db = ((i&4) - 2);
    dc = ((i&2) - 1) << 1;
    dd = ((i&1) << 2) - 2;

    Bubble[i] = 
        ((a + da) - (b + db)) + ((c + dc) - (d + dd));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T17:46:35.850

如果必须针对更多状态（位）执行此操作，那么这也是一种更通用的方法：

```
var varList = [a, b, c, d];  //these would be the values of a, b, c, d up to the number of states desired
for (var i=0; i<Bubble.length; i++) {
     var numBits = varList.length;
     //If the var list is not large enough, this will be an error (I will just handle it by returning)
     if (Math.pow(2, numBits) < Bubble.length) return;
     for (var j=1; j<=numBits; j++) {
         //first bit corresponds to last state
         var stateVal = varList[numBits - j];
         //if 2^bit is set, add 2, else subtract 2
         stateVal += (i % pow(2, j) === 0) ? 2 : -2;
         //add if even state, subtract if odd state
         Bubble[i] += ((numBits - j) % 2 === 0) ? stateVal : -stateVal;
     }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-22T18:28:03.067

无需一直分支并在循环中求和所有双精度数：

```
double offset = a0 - b0 + c0 - d0;
for( int idx = 0; idx < sizeof(bbl)/sizeof(bbl[0]); ++idx )
{
    bbl[idx] = offset + ( (   ( 1 & ( idx >> 3 ) )
                            - ( 1 & ( idx >> 2 ) )
                            + ( 1 & ( idx >> 1 ) )
                            - ( 1 &   idx        ) ) << 2 );
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-07T17:02:58.667

不确定是什么问题。用 for 循环遍历数组本身就很简单：

```
for( int i=0; i < 16; ++i )
{
    Bubble[i] = /* whatever */
} 
```

# windows-8 - WinJS 应用程序出现无法捕获的崩溃

> ID：13767532
> 
> 赞同：4
> 
> 时间：2012-12-07T16:57:09.767
> 
> 标签：windows-8, winjs

在页面之间导航时，我的 WinJS 应用程序出现随机崩溃。

问题是当应用程序附加到 Visual Studio 调试器时，这些崩溃永远不会发生。所以我找不到他们来自哪里。

我使用 WinJS.Application.onerror 事件来防止崩溃并记录发生的情况，但是当我尝试随机异常时效果很好，我的“无法捕获”崩溃似乎不会触发此事件（我没有任何记录）。

您是否知道可能导致这些崩溃的原因，或者找到更多信息的解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-10T11:03:11.613

有时错误无法触发 WinJS.Application.onerror 有几个原因（在我的应用程序中，问题出在 iframe 中，在不使用 winjs 的页面中）。

发生这种情况时，可以在事件日志中的“管理事件”下找到错误

在这个链接上找到这个： [http ://www.davepaquette.com/archive/2012/09/15/windows-8-store-app-crash-logs.aspx](http://www.davepaquette.com/archive/2012/09/15/windows-8-store-app-crash-logs.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T18:04:27.387

[Jason在这个视频中](http://blogs.msdn.com/b/jennifer/archive/2012/12/05/devradio-webcast-jason-follas-on-developing-a-windows-8-app.aspx)给出了一个很好的解决方案（从 14:48 开始）。在他的示例中，如果您有回调并在回调完成之前导航到不同的页面，则应用程序会崩溃。您的应用程序可能是这种情况吗？有关导航时发生的事情的更多详细信息？

对于其他人（因为您似乎已经知道这一点！）：

为了能够更轻松地进行调试，请使用[WinJS.Application.OnError 事件](http://msdn.microsoft.com/en-us/library/windows/apps/Hh974768.aspx)。连接一个事件处理程序，在应用程序崩溃之前转储出有关问题的信息。

```
WinJS.Application.onerror = function (info) {
   var err = {
     errorMessage: info.detail.errorMessage,
     errorUrl: info.detail.errorUrl,
     errorLine: info.detail.errorLine,
     errorCharacter: info.detail.errorCharacter,
   };

   Windows.Storage.ApplicationData.current.localFolder
      .createFileAsync("crash.txt", Windows.Storage.CreationCollisionOption.openIfExists)
      .then(function (file) {
         Windows.Storage.FileIO.appendLinesAsync(file, [JSON.stringify(err)]);
      });
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T21:01:33.467

JavaScript 中异常的最后一站实际上是 window.onerror；不是每个异常都会通过 WinJS.Application.onerror 抛出。尝试直接挂钩 window.onerror。

# c# - 寻找使用正则表达式从字符串中获取数字

> ID：13767539
> 
> 赞同：0
> 
> 时间：2012-12-07T16:57:27.020
> 
> 标签：c#, regex, string

寻找正则表达式以从字符串中获取数字。

我的字符串可能是：

```
abcd1
abcd01
abcd11 
```

我试过了，但它不起作用：`/\d+$/`还有一些其他的，但它们似乎不正确。

有没有简单的方法从字符串中获取数字？它将在最后。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T16:58:47.400

我相信你想要这个正则表达式（没有开始的斜杠，因为 C# 不需要那个）

```
\d+$ 
```

忽略前导 0

[1-9]\d*$

如果您想删除所有前导 0，老实说，将您的结果转换为`Int32`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T17:04:03.833

我想这是你想要的。“反正有没有得到 1 而不是 01？” 就在这里。

```
[1-9]\d*$ 
```

# cron - Cron Job 命令修复

> ID：13767543
> 
> 赞同：0
> 
> 时间：2012-12-07T16:57:40.347
> 
> 标签：cron

以下用于 cron 作业的命令不起作用

```
20 18 * * * wget -O /dev/null 2>&1 http://www.rolsonscommercial.com/cronjobs/sms/autosms.php. 
```

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:04:07.860

尝试给出 wget 的绝对路径（我的系统上的 /usr/local/bin/wget）。您可以使用

```
$type wget
$which wget
$whereis wget 
```

解决这个问题

还回答，什么操作系统？什么版本的cron？这是用户 crontab 还是系统 crontab - 他们有不同的格式。

另外，您希望 cron 作业何时运行？“不工作”是无用的信息。回答“你期待什么？”、“正在发生什么”、“你在做什么？”

# php - 是否有针对 PHP 文档块的 PHPCS 标准？

> ID：13767550
> 
> 赞同：21
> 
> 时间：2012-12-07T16:58:03.847
> 
> 标签：php, phpdoc, codesniffer

是否有 PHPCS 编码标准可以检查文档块中是否存在正确的注释（`@param`、`@return`、`@throws`等），包括它们之间的正确间距？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-08T00:54:37.623

尝试运行以下命令，看看它是否会产生您想要的结果：

`phpcs /path/to/code --standard=Squiz --sniffs=Squiz.Commenting.FunctionComment,Squiz.Commenting.FunctionCommentThrowTag,Squiz.Commenting.ClassComment,Squiz.Commenting.FileComment,Squiz.Commenting.VariableComment`

如果是这样，您可以创建自己的标准，只包括那些嗅探，以及您想要检查的任何其他内容。为此，您可以创建一个`ruleset.xml`文件并将其用作您的标准。

例如，您可以创建一个名为`mystandard.xml`并包含以下内容的文件：

```
<?xml version="1.0"?>
<ruleset name="MyStandard">
  <description>My custom coding standard.</description>
  <rule ref="Squiz.Commenting.FunctionComment" />
  <rule ref="Squiz.Commenting.FunctionCommentThrowTag" />
  <rule ref="Squiz.Commenting.ClassComment" />
  <rule ref="Squiz.Commenting.FileComment" />
  <rule ref="Squiz.Commenting.VariableComment" />
</ruleset> 
```

然后你可以运行这个命令：

```
phpcs /path/to/code --standard=/path/to/mystandard.xml 
```

您可以在`ruleset.xml`文件中执行其他操作。请参阅此处的文档：[https ://github.com/squizlabs/PHP_CodeSniffer/wiki/Annotated-Ruleset](https://github.com/squizlabs/PHP_CodeSniffer/wiki/Annotated-Ruleset)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-05-01T16:54:38.693

在 2017 年，您现在有更多选择：

*   **检查 docblocks**的最佳嗅探器之一是**[来自 SlevomatCodingStandard 的 TypeHintDeclarationSniff](https://github.com/slevomat/coding-standard/blob/master/SlevomatCodingStandard/Sniffs/TypeHints/TypeHintDeclarationSniff.php)**，它适用于 PHP 7、PHP 7.1，删除未使用的文档等。
*   你也可以**使用另一个工具 - [PHP-CS-Fixer](https://github.com/FriendsOfPHP/PHP-CS-Fixer/)**，在那里你可以找到更多的修复器，这将帮助你使用 docblock，只需搜索“doc”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-14T15:56:52.090

*免责声明：我是 Rector 的作者。*

**2019年**你可以使用静态分析为你**完成`@var`类型或类型声明**。

```
class SomeClass
{
    private $value;

    public setValue(string $string)
    {
        // here we know the string type is assigned
        $this->value = $value;
    }    
} 
```

知道了，Rector 自动完成 var 类型：

```
class SomeClass
{
    /**
     * @var string
     */
    private $value;

    public setValue(string $string)
    {
        $this->value = $value;
    }    
} 
```

类似的方法适用于返回类型、PHP 7.4 类型以及来自父接口和类的类型声明。校长都支持。

阅读[如何使用 Rector 在没有 Docblocks 的情况下完成类型声明](https://www.tomasvotruba.cz/blog/2019/01/03/how-to-complete-type-declarations-without-docblocks-with-rector/#properties-without-code-var-code)

# java - 使用 SimpleDateFormat 解析自定义时间格式

> ID：13767560
> 
> 赞同：3
> 
> 时间：2012-12-07T16:58:31.183
> 
> 标签：java, date, simpledateformat

我无法解析从 API 返回的日期格式并且我从未见过（我相信是自定义格式）。日期示例：

```
/Date(1353447000000+0000)/ 
```

当我第一次遇到这种格式时，我很快就发现它是以毫秒为单位的时间，带有时区偏移。不过，我无法使用 SimpleDateFormat 提取此日期。这是我的第一次尝试：

```
String weirdDate = "/Date(1353447000000+0000)/";

SimpleDateFormat sdf = new SimpleDateFormat("'/Date('SSSSSSSSSSSSSZ')/'");

Date d1 = sdf.parse(weirdDate);
System.out.println(d1.toString());
System.out.println(d1.getTime());
System.out.println();

Date d2 = new Date(Long.parseLong("1353447000000"));
System.out.println(d2.toString());
System.out.println(d2.getTime()); 
```

并输出：

```
Tue Jan 06 22:51:41 EST 1970
532301760

Tue Nov 20 16:30:00 EST 2012
1353447000000 
```

日期（和解析的毫秒数）甚至还没有接近，我无法弄清楚原因。经过一些故障排除后，我发现我尝试使用 SDF 的方式显然存在缺陷。例子：

```
String weirdDate = "1353447000000";

SimpleDateFormat sdf = new SimpleDateFormat("S");

Date d1 = sdf.parse(weirdDate);
System.out.println(d1.toString());
System.out.println(d1.getTime()); 
```

并输出：

```
Wed Jan 07 03:51:41 EST 1970
550301760 
```

我不能说我曾经尝试过以这种方式使用 SDF 来解析以毫秒为单位的时间，因为我通常会使用`Long.parseLong()`并将其直接传递给`new Date(long)`（实际上我现在拥有的解决方案只是一个常规的表达式和解析长）。我正在寻找一种更简洁的解决方案，我可以轻松地以毫秒为单位提取时区时间，并快速解析为日期，而无需繁琐的手动处理。任何人有任何想法或可以发现我上面的逻辑中的错误？非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:02:08.543

取字符串中的毫秒值：

```
/Date(1353447000000+0000)/ 
```

并将该值作为 long 传递给 Date 构造函数：

```
Date date = new Date(1353447000000); 
```

并使用 SimpleDateFormat 格式化日期对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:40:04.087

尽管这几乎就是您现在正在做的事情，但我认为手动方法没有太大问题-除了您必须去那里很可惜！

我不相信您可以仅使用 SDF 来做到这一点。这会给你一个合理“优雅”的约会：

```
Date date = new Date(Long.parseLong(weirdDate.split("[^\\d]")[6])); 
```

我相信你已经考虑过了，但是你有没有和 API 的生产者谈过，看看他们为什么以这种奇怪的格式输出这个值？如果接口不公开和/或不广泛，他们可能会考虑将其更改为更传统的东西。

# c# - 定时器 C#。开始、停止和获取调用之间的时间量

> ID：13767561
> 
> 赞同：5
> 
> 时间：2012-12-07T16:58:30.613
> 
> 标签：c#, .net, multithreading, timer, udp

> **可能重复：**
> [如何衡量一个函数运行了多长时间？](https://stackoverflow.com/questions/10107140/how-to-measure-how-long-is-a-function-running)

我正在编写一个具有可靠数据传输的 UDP 聊天。我需要在发送数据包时启动一个计时器，并在它收到来自服务器的应答（ACK - 确认）后立即停止它。

这是我的代码：

```
 private void sendButton_Click(object sender, EventArgs e)
 {
     Packet snd = new Packet(ack, textBox1.Text.Trim());
     textBox1.Text = string.Empty;
     Smsg = snd.GetDataStream();//convert message into array of bytes to send.
     while (true)
     {
        try
         {  // Here I need to Start a timer!
           clientSock.SendTo(Smsg, servEP); 
           clientSock.ReceiveFrom(Rmsg, ref servEP);
           //Here I need to stop a timer and get elapsed amount of time.

           Packet rcv = new Packet(Rmsg);
           if (Rmsg != null && rcv.ACK01 != ack)
               continue;

           if (Rmsg != null && rcv.ACK01 == ack)
           {
            this.displayMessageDelegate("ack is received :"+ack);
            ChangeAck(ack);
            break;
           } 
```

谢谢你。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-07T16:59:55.060

不要使用计时器。它通常不够准确，并且专门为这项工作设计了一个更简单的对象：[Stopwatch](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx)类。

MSDN 文档中的代码示例：

```
using System;
using System.Diagnostics;
using System.Threading;
class Program
{
    static void Main(string[] args)
    {
        Stopwatch stopWatch = new Stopwatch();
        stopWatch.Start();
        Thread.Sleep(10000);
        stopWatch.Stop();
        // Get the elapsed time as a TimeSpan value.
        TimeSpan ts = stopWatch.Elapsed;

        // Format and display the TimeSpan value. 
        string elapsedTime = String.Format("{0:00}:{1:00}:{2:00}.{3:00}",
            ts.Hours, ts.Minutes, ts.Seconds,
            ts.Milliseconds / 10);
        Console.WriteLine("RunTime " + elapsedTime);
    }
} 
```

在您的情况下，您将在发送数据包时启动它，并在收到 ack 时停止它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T17:02:10.507

**[`Stopwatch`](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx)**比任何计时器都要好得多。

```
var stopwatch = new System.Diagnostics.Stopwatch();
stopwatch.Start();

// Your code here.

stopwatch.Stop(); 
```

然后您可以访问`Elapsed`属性（类型`TimeSpan`）以查看经过的时间。

# sql-server - 将批处理文件状态/时间记录到 SQL Server

> ID：13767565
> 
> 赞同：1
> 
> 时间：2012-12-07T16:58:40.573
> 
> 标签：sql-server, batch-file, sqlcmd

我想增强现有的 bat 文件以将执行持续时间记录到 SQL Server 表中。当前的 bat 文件有一行调用命令行实用程序。

我想我会利用这样的东西，[Windows Batch File 中的 SQL 语句](https://stackoverflow.com/questions/389844/sql-statements-in-a-windows-batch-file)。伪代码：

```
StartTime = Now()
hyperioncommandlineshell.cmd /a:parm1 /b:parm2 /c:parm3
sqlcmd.exe -b -S myhost -E -d mydatabase -Q "Insert Into MyTable Values (Current_Timestamp, 'MyProcess', Now() - StartTime)" -W 
```

一些问题：

1.  运行这个 bat 文件的服务器没有 SQL 工具，我从[这篇](http://www.sqlservercentral.com/Forums/Topic1050391-391-1.aspx)文章中看到它确实需要安装（你不能只复制`sqlcmd.exe`文件）。这将遇到阻力。是否有另一种无需安装软件即可从批处理文件执行 SQL 语句的方法？

2.  我没有使用 BAT 文件的经验。有人可以提供有关如何获取流程持续时间的指导（例如获取开始时间并计算结束时的差异）吗？

我可能会尝试使用我更熟悉的另一种工具，但我正在尝试在 bat 中执行此操作，以便更改仅影响一个现有对象，并且不需要其他对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T18:02:50.017

Windows 计算机已经安装了 ODBC 驱动程序，因此您可能有用于 SQL Server 的 ODBC 驱动程序。如果是这样，那么您也许可以使用 Microsoft 的`osql`实用程序从 DOS 运行 T-SQL 语句。这是 MSDN 上的文档：

[http://msdn.microsoft.com/en-us/library/aa214012(v=SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa214012(v=SQL.80).aspx)

它是为 SQL Server 2000 设计的，因此连接到更高版本的 SQL Server 时可能会出现一些问题，但值得一试。如果它有效，那么您将不必安装任何特殊的东西来连接到您的 SQL 服务器（尽管您可能需要为服务器创建一个 ODBC 数据源名称......）。在 Windows Vista+ 中，单击**开始**并键入**ODBC**以打开 ODBC 数据源编辑器。

使用`SQLCMD`将要求您安装 Native Client，或至少安装 SNAC（讨论线程：[http](http://us.generation-nt.com/answer/how-install-only-sqlcmd-exe-utility-help-87134732.html) ://us.generation-nt.com/answer/how-install-only-sqlcmd-exe-utility-help-87134732.html ）无需安装整个 Native Client即可运行`SQLCMD`（尽管仍然需要安装 SNAC）。我以前没有听说过 SNAC，所以这需要一些研究。我假设安装任何东西都会遇到同样的阻力，所以如果你能克服这种阻力，安装 Native Client 可能是你最好的选择。

至于经过的时间。您可以使用`%DATE% %TIME%`获取当前日期/时间。因此，您可以使用以下内容来捕获开始时间，运行您的流程，然后捕获结束时间——将它们全部发布到数据库中：

```
set StartTime=%DATE% %TIME%
hyperioncommandlineshell.cmd /a:parm1 /b:parm2 /c:parm3
set EndTime=%DATE% %TIME%
sqlcmd.exe -b -S myhost -E -d mydatabase -Q "Insert Into MyTable Values ('%StartTime%', 'MyProcess', '%EndTime%')" -W 
```

您将无法`StartTime - EndTime`使用 DOS 本身进行计算，但您可以将开始时间和结束时间都存储在表中并使用 SQL 来完成。

`%DATE%`和的格式`%TIME%`基于机器设置使用的格式。您可以`echo %DATE% %TIME%`在 DOS 提示符下键入以查看它是如何为您格式化的。您可能必须将这些值存储在`varchar`字段中，因为格式可能不会自动转换为`datetime`值。如果它确实自动转换，那么您可以在 DOS 的 SQL 语句中进行计算，如下所示：

```
sqlcmd.exe -b -S myhost -E -d mydatabase -Q "Insert Into MyTable Values ('%EndTime%' - '%StartTime%', 'MyProcess')" -W 
```

（仅供参考 - 我对所有示例都使用了您的伪代码，因此没有进行任何测试。）

# logging - 用于 log4j 的 Otros 日志查看器模式

> ID：13767568
> 
> 赞同：1
> 
> 时间：2012-12-07T16:58:45.707
> 
> 标签：logging, log4j

我正在尝试将以下日志模式设置与[Otros Log Viewer](http://code.google.com/p/otroslogviewer/wiki/Log4jPatternLayout)一起使用：

```
type=log4j
patternn=TIMESTAMP LEVEL [CLASS] (THREAD) MESSAGE
dateFormat=MM-dd HH:mm:ss,SSS
name=IDP JBoss Log
charset=utf-8 
```

但是，但是当我单击“测试解析器”时，屏幕底部的状态行显示“已解析 0 个事件！” 我也试过省略 charset 属性，但这没有效果。我究竟做错了什么？

这是我粘贴到左侧窗格中的内容：

```
12-07 08:38:18,116 TRACE [com.company.security.MyLoginModule] (WorkerThread#6) commit, loginOk=true
12-07 09:08:17,738 TRACE [com.company.security.MyLoginModule] (WorkerThread#6) logout
12-07 09:08:17,739 TRACE [com.company.security.MyLoginModule] (WorkerThread#6) initialize
12-07 09:08:17,739 TRACE [com.company.security.MyLoginModule] (WorkerThread#6) Saw unauthenticatedIdentity=null
12-07 09:08:17,739 TRACE [com.company.security.MyLoginModule] (WorkerThread#6) login
12-07 09:08:17,742 TRACE [com.company.security.MyLoginModule] (WorkerThread#6) Logging into LDAP server 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T13:53:15.737

您打错了“模式”。将“模式”替换为“模式”。

# sql - 逐条比较两个 SQL 表

> ID：13767575
> 
> 赞同：0
> 
> 时间：2012-12-07T16:59:05.250
> 
> 标签：sql, sql-server, cursor, fetch

> **可能重复：**
> [SQL：逐条比较两个表记录](https://stackoverflow.com/questions/13766946/sql-compare-two-table-record-by-record)

我想通过记录比较两个表。每个表都有两个光标。代码看起来像这样

```
Declare Cursor c1 for SELECT * from Table1
OPEN c1
While @@Fetch_status=0
Begin
  Declare Cursor c2 for SELECT * from Table2
  OPEN c2
  WHILE @@Fetch_Status=0
  Begin
     /*Comparison happens here*/
  END
END 
```

当 fecthing 时，我必须指定我正在获取哪个游标，我该怎么做？

这就是我想要做的：

对于 Table1 中的每条记录，我想

*   根据主键在 Table2 中搜索该记录。
*   找到后，我想根据 table1 中的列值更新 Table2 中的额外列值。
*   当 table2 中缺少这条记录时，我想将它从 table1 复制到 table2 并设置 table2 中额外列的默认值。

# php - +, ', " 在 php GET 搜索表单中消失

> ID：13767577
> 
> 赞同：0
> 
> 时间：2012-12-07T16:59:20.300
> 
> 标签：php, forms, input, sanitization

我有一个搜索表格。我使用以下行来获取值。返回时，将加号替换为空格，删除单/双引号后的字母。我想让用户搜索他们想要的关键字。我怎样才能让这些字母显示？

```
$title = trim(filter_input(INPUT_GET, 'title', FILTER_SANITIZE_SPECIAL_CHARS)); 
```

当我用 GET 发送时。

```
header("Location:http://site.org/search/?title=$title"); 
```

我尝试使用 urlencode() 并适用于加号，但它不适用于引号。例如 c"s 将返回 c"s。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:05:10.917

这些是与它们的外观相对应的特殊字符，例如*GET*请求中的加号对应于空格。

请看[这个链接](http://www.degraeve.com/reference/urlencoding.php)。

您必须在重定向之前替换这些字符。您可以使用`urlencode`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:05:55.143

来自 FILTER_SANITIZE_SPECIAL_CHARS 的手册

> HTML 转义 '"<>& 和 ASCII 值小于 32 的字符，可选择剥离或编码其他特殊字符。

如果您尝试的字符的 ascii 值低于 32，您可能需要走不同的路线。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T18:40:53.050

您需要为要输出到的媒体对数据进行编码/转义：

*   用于`url_encode`通过 url 发送变量；
*   使用带有绑定变量的准备好的语句来查询数据库，这样您就可以安全地避免 sql 注入，并且您可以在数据库中搜索带引号的文本；
*   用于`htmlspecialchars`将结果输出到 html 或类似的东西`json_encode`将其发送到 javascript。

# c# - 提示 SmartCard PIN 以实现非签名要求的正确方法是什么？

> ID：13767580
> 
> 赞同：2
> 
> 时间：2012-12-07T16:59:29.837
> 
> 标签：c#, x509certificate, smartcard

我需要使用智能卡作为 WPF 应用程序的身份验证机制。我可以轻松地从商店获取和读取证书信息，并检测卡是否实际插入读卡器。但是，我想提示用户输入他们的 PIN 作为初始登录的一部分。仅拥有卡不足以向应用程序验证他们的身份。

如果我使用证书签署一些数据，我可以获得 PIN 提示，并且只使用一些虚拟数据来获得所需的行为，但这似乎是错误的做法。我想我应该能够将 PIN 提示作为其他一些方法的一部分，它只会返回一个布尔结果。我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T08:22:35.237

这是正确的做法。现在验证给定的签名是否确实包含您的“随机数据”（随机数）以加密验证身份。仅仅要求 PIN 不是身份验证。

# android - Google Play 商店错误 DF-BPA-10

> ID：13767581
> 
> 赞同：5
> 
> 时间：2012-12-07T16:59:31.613
> 
> 标签：android, google-play

我在 stackoverflow 上没有发现 Google Play 商店错误“DF-BPA-10”，但我能够解决这个问题，并为遇到相同问题的任何人发布这个问题和答案。

这个问题发生在我运行 Jelly Bean (4.1.1) 的三星 Galaxy SIII 上，但其他设备可能会受到影响。

接受应用程序的条款和条件后，会出现一条错误通知，说明“处理购买时出错：[DF-BPA-10]”。重新启动设备或强制停止 Play 商店都无法解决该错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T16:59:31.613

为了解决错误，请执行以下操作：

1.  打开安卓设备上的“设置”应用程序，然后导航到“应用程序管理器”。
2.  在列表中找到“Google Play Store”（应按字母顺序排列）并点按它。
3.  点击“强制停止”按钮并确认关闭应用程序。
4.  点击“卸载更新”按钮并确认。这将使 Play 商店恢复到出厂版本。
5.  打开 Play 商店并接受条款和条件。

您现在应该能够安装应用程序而不会出现 DF-BPA-10 错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-10T16:34:57.843

由于在使用它的服务时违反了谷歌的服务条款，我遇到了同样的问题，所以谷歌希望我在让我再次购买之前验证帐户。

因此，在这种情况下，验证帐户可以适用于同一帐户。

# scala - 从方法符号和主体创建方法定义树

> ID：13767582
> 
> 赞同：8
> 
> 时间：2012-12-07T16:59:31.653
> 
> 标签：scala, reflection, macros, scala-2.10, scala-macros

在 Scala 2.10 中是否有一种方便的方法可以将 a[`MethodSymbol`](http://www.scala-lang.org/archives/downloads/distrib/files/nightly/docs/library/index.html#scala.reflect.api.Symbols$MethodSymbolApi)转换为方法定义树（即 a ）的左侧？[`DefDef`](http://www.scala-lang.org/archives/downloads/distrib/files/nightly/docs/library/index.html#scala.reflect.api.Trees$DefDefApi)

例如，假设我想创建一个宏，该宏将采用一个 trait 的实例，并用一些调试功能包装该 trait 的所有方法。我可以写以下内容：

```
import scala.language.experimental.macros
import scala.reflect.macros.Context

object WrapperExample {
  def wrap[A](a: A): A = macro wrap_impl[A]

  def wrap_impl[A: c.WeakTypeTag](c: Context)(a: c.Expr[A]) = {
    import c.universe._

    val wrapped = weakTypeOf[A]
    val f = Select(reify(Predef).tree, "println")

    val methods = wrapped.declarations.collect {
      case m: MethodSymbol if !m.isConstructor => DefDef(
        Modifiers(Flag.OVERRIDE),
        m.name,
        Nil, Nil,
        TypeTree(),
        Block(
          Apply(f, c.literal("Calling: " + m.name.decoded).tree :: Nil),
          Select(a.tree, m.name)
        )
      )
    }.toList

  //...
} 
```

我已经省略了将这些方法粘贴到实现该特征的新匿名类中然后实例化该类的无聊业务——如果您有兴趣，可以[在此处找到一个完整的工作示例。](https://gist.github.com/4234441)

现在我可以写这个，例如：

```
scala> trait X { def foo = 1; def bar = 'a }
defined trait X

scala> val x = new X {}
x: X = $anon$1@15dd533

scala> val w: X = WrapperExample.wrap[X](x)
w: X = $1$$1@27c3a4a3

scala> w.foo
Calling: foo
res0: Int = 1

scala> w.bar
Calling: bar
res1: Symbol = 'a 
```

所以它有效，但仅在非常简单的情况下——如果 trait 具有带有参数列表、访问修饰符、注释等的方法，它就不会。

我真正想要的是一个函数，它将为新主体采用方法符号和树并返回一个`DefDef`. 我已经开始手写一个，但它涉及到很多像这样的繁琐的东西：

```
List(if (method.isImplicit) Some(Flag.IMPLICIT) else None, ...) 
```

这很烦人，冗长且容易出错。我是否错过了在新的反射 API 中执行此操作的更好方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T18:07:04.093

据我所知，从符号到定义树没有标准的方法。

你最好的选择可能是遍历`c.enclosingRun.units`，在你去的时候递归到每`unit.body`棵树。如果您看到一个`DefDef`等于`symbol`您的符号的 ，那么您已经到达目的地。更新。`duplicate`在重用它之前不要忘记定义树！

这种技术远非世界上最方便的东西，但它应该有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T02:28:35.957

您可以尝试以下方法。这适用于多个参数和咖喱函数和类型参数；）

```
val methods = wrapped.declarations.collect {
  case m: MethodSymbol if !m.isConstructor => DefDef(
    Modifiers(Flag.OVERRIDE),
    m.name,
    m.typeParams.map(TypeDef(_)),
    m.paramss.map(_.map(ValDef(_))),
    TypeTree(m.returnType),
    Block(
      Apply(f, c.literal("Calling: " + m.name.decoded).tree :: Nil),
      m.paramss.foldLeft(Select(a.tree.duplicate, m.name): Tree)((prev, params) =>
        Apply(prev, params.map(p => Ident(p.name)))
      )
    )
  )
}.toList 
```

# ios - 用于模式属性初始化的 ARC 模式

> ID：13767587
> 
> 赞同：0
> 
> 时间：2012-12-07T16:59:53.993
> 
> 标签：ios, automatic-ref-counting

当我第一次阅读在 ARC 之前开始 iOS 3 开发时，我记得在一些 ViewController 类中看到过这样的模式：

```
.h
@property (nonatomic, retain) NSArray *myArray;

.m
in viewDidLoad:
NSArray *tempArray = [[NSArray alloc] init];
self.myArray = tempArray;
[tempArray release]; 
```

我记得读过您这样做是为了如果您使用属性设置器/获取器，属性可以为您处理内存。所以现在有了 ARC，我想知道你是否仍然遵循这种变量创建。例如，如果您在 iOS 6 中启动一个新项目，在 AppDelegate 中，它们会

```
.h
@property (strong, nonatomic) ViewController *viewController;
.m
    self.viewController = [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil]; 
```

在这种情况下，不会创建 temp 变量。我想知道为什么以及是否应该遵循该模式而不是第一个模式。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:10:59.917

是的你应该。ARC 会自动为您优化掉不必要的保留和释放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:07:38.213

它们是相同的模式，除了现在 ARC 为您正确处理发布。ARC 的第二个代码块很好。这就是 ARC 如此出色的原因。

# asp.net - 为什么我们需要多个工作流程？

> ID：13767592
> 
> 赞同：0
> 
> 时间：2012-12-07T17:00:04.487
> 
> 标签：asp.net, iis

昨天，我的客户玩了 IIS 设置，他将工作进程的数量更改为 2，这使得我的 Web 应用程序运行非常奇怪，会话状态有时会丢失，有时会恢复，我花了一天时间才知道发生了什么。那么，问题是多工作流程在什么情况下有用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:09:00.430

它对于垂直扩展 Web 应用程序很有用。尤其是设计不佳的那些在 Web 进程中做太多工作的进程，或者进程经常崩溃的进程，所以你总是有一个热门的进程。正如您所发现的那样，这不是一个应该轻易行使的选项，但在您需要时拥有它是一件好事。

您的用户会话开始失败的原因是因为您使用的是默认的进程内会话状态模块。这也很容易修复——只需使用会话状态服务或数据库在进程外运行会话状态。请注意，当您执行此操作时，会话状态的某些行为也会发生变化，因此您需要仔细测试以确保不会破坏其他内容。

# php - PHP用缺失值填充数组

> ID：13767595
> 
> 赞同：1
> 
> 时间：2012-12-07T17:00:11.720
> 
> 标签：php

下面的数组应该为从 1 到 7 的每个“点”值创建一个子数组，但缺少 2、4 和 6。如何为每个缺失值插入一个数组，“值”为 NULL？

我在我的数组上尝试了一个`for($i = 1; $i <= 7; $i++)`and inside foreach'ing 来查看是否`'point' == $i`，但这不起作用。

这已经在一个相当大的数组的嵌套 foreach 中，所以性能有点重要。

到目前为止的代码（不完整，显然不起作用）

```
foreach($measurements as $measurement_id => $set)
        {
            for($i = 1; $i <= 7; $i++)
            {
                foreach($set as $key => $value)
                {
                    $fill = array('value' => null);

                    if($value['point'] == $i)
                        $output[$measurement_id][$key] = $value;
                    else
                        $output[$measurement_id][$key] = $fill;
                }
            }
        } 
```

数组：

```
 [0] => Array
                (
                    [point] => 1
                    [value] => 1.0
                )

            [1] => Array
                (
                    [point] => 3
                    [value] => 2.0
                )

            [2] => Array
                (
                    [point] => 5
                    [value] => 3.0
                )

            [3] => Array
                (
                    [point] => 7
                    [value] => 4.0
                ) 
```

结果应该是

```
 [0] => Array
                (
                    [point] => 1
                    [value] => 1.0
                )

            [1] => Array
                (
                    [point] => 2
                    [value] => NULL
                )

            [2] => Array
                (
                    [point] => 3
                    [value] => 2.0
                )

            [3] => Array
                (
                    [point] => 4
                    [value] => NULL
                )
            [4] => Array
                (
                    [point] => 5
                    [value] => 3.0
                )

            [5] => Array
                (
                    [point] => 6
                    [value] => NULL
                )

            [6] => Array
                (
                    [point] => 7
                    [value] => 4.0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:06:01.867

尝试这个：

```
$oldArr = [ ..your incomplete array.. ];
$newArr = array();

for ($i = 1; $i < 8; ++$i) {
  $new = array(
    'point' => $i,
    'value' => NULL,
  );

  foreach($oldArr as $old) {
    if ($old['point'] == $i) {
      $new['value'] = $old['value'];
    }
  }

  $newArr[] = $new;
} 
```

现在`$newArr`应该包含您想要的所有值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:17:14.060

如果您的原始数组`point`按照示例中的顺序排序，则只能在一个循环中执行：

```
$result = array();
for ($i = 1; $i <= 7; $i++)
{
  // get the first element of your set
  $current = reset($set);
  if ($current['point'] === $i)
  {
    // remove the first element of your set and assign it to the result array
    $result[$i - 1] = array_shift($set);
  }
  else
  {
    // create a new, empty entry
    $result[$i - 1] = array('point' => 1, 'value' => NULL);
  }
} 
```

请注意，我正在创建一个新数组并从原始数组中删除值。如果您真的担心资源/性能，您可以使用相同的原则并向后循环（从 7 到 1），将数组的最后一个元素移动到正确的位置并以相同的方式填充空白空间。

# validation - Symfony2 + Doctrine2：是否可以与实体设置器中的验证注释进行交互？

> ID：13767596
> 
> 赞同：0
> 
> 时间：2012-12-07T17:00:13.313
> 
> 标签：validation, symfony, annotations, doctrine, entity

我有一个使用验证[注释装饰的](http://symfony.com/doc/current/book/validation.html)[实体](http://docs.doctrine-project.org/en/2.0.x/reference/working-with-objects.html)，如下所示：

```
use Symfony\Component\Validator\Constraints as Assert;

class Entity
{
    /**
     * @Assert\MaxLength(100)
     */
    protected $property;
    ...
} 
```

在设置器中，`$property`我想知道提交表单时注释的验证是否成功。如果验证成功（或不成功），我将在 PHP 中执行无法通过注释获得的其他操作。

这可能吗？IE：

```
...
function setProperty($value)
{
    if(annotation_validation_passed_when_form_submitted)
    {
        $value = do_something($value);
    }
    $this->property = $value;
}
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:39:30.147

您可以添加一个`EventListener`来`FormBuilder`监听`FormEvents::BIND`事件。您可以在其自己的类中执行此操作，也可以仅在表单构建器本身中执行此操作。我将展示后者的示例，因为它更快。

```
$builder->addEventListener(FormEvents::BIND, function($event) {
        $data = $event->getData();

        $comment = $data->getComment();
        $comment = $comment . $comment;
        $data->setComment($comment);
}); 
```

当然用你自己的逻辑替换。

# mongodb - 用于大量组合的 Mongodb“布局”

> ID：13767598
> 
> 赞同：0
> 
> 时间：2012-12-07T17:00:15.820
> 
> 标签：mongodb, matrix

我有一个包含 2000 行的 MySQL 表（Table1），每行存储一个 3d 对象的数据：大小、位置、名称等
。第二个表（Table2）包含 Table1 中列出的 3d 对象的属性列表；每个对象在此表中可以有多个条目，也可以没有。在这种特殊情况下，假设我们有 10.000 个条目。这是困难的部分：每个 Table2 条目之间都有一个组合，它给出了一个距离。所以这是第三张表（Table3），它看起来像：

```
row1:         table2_entry1 table2_entry2 result  
row2:         table2_entry1 table2_entry3 result  
....  
rowN:         table2_entry1 table2_entryN result  

rowN+1:       table2_entry2 table2_entry1 result  
rowN+2:       table2_entry2 table2_entry3 result  
....  
rowN+N:       table2_entry2 table2_entryN result  
....  
....  
rowN+N+...+N: table2_entryN table2_entryN-1 result 
```

因此 Table3 将有 10.000.000 个条目。我知道，使用矩阵会将其减半，因为有成对的 (entry1, entry2, same_result) 和 (entry2, entry1, same_result)。

一个 mongoDB 文档看起来像这样（例如 entry1）

```
{  
 "_id": ObjectID("..."),  
 "location": "some_file_location",  
 ...  
 "media_properties": {  
      {entry2: result,    
       entry3: result,  
       ...  
       entryN: result,  
 }  
} 
```

因此“media_properties”对于存储在表 2 中的 10.000 个属性中的每一个都将具有 9.999 个字典对。
我不相信这是存储大量组合的最佳方法。

我应该使用单独的集合来存储 SQL 表中的所有组合，还是应该将字典嵌入媒体文档中（如上面的示例）？

我想摆脱开销，而不是两次存储相同的信息。在这种情况下，我可以有类似的东西：

```
entry1 - entry2 - result  
entry2 - entry3 - result 
```

等等

代替：

```
entry1 - entry2 - result  
entry2 - entry1 - result
entry2 - entry3 - result
entry3 - entry2 - result 
```

ETC

是否可以将半个矩阵“映射”到 mongoDB 文档中？
有没有更好的解决方案来存储它？

欢迎任何想法！
提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T01:40:37.673

我不鼓励将它们中的许多保留在一个文档中，因为您将无法对它们进行排序，也无法取出如此巨大的 json 的部分信息（如果不是由字段构成的话）。在不使用 GridFS (16MB) 的情况下，还有最大的文档大小。
为每个文档保留一个“entry-entry + result”似乎是在浪费空间（有点），但它应该可以很好地满足您的需求并为您提供适当的查询性能 - 即使您需要查询元素而不是结果 - 额外的索引应该可以确定。此外，写入性能（将许多新结果作为新文档添加到新元素而不是将结果添加到文档末尾）不应令人沮丧。我想听听进展如何：）

# c# - AutoMapper：映射子集合

> ID：13767599
> 
> 赞同：8
> 
> 时间：2012-12-07T17:00:16.460
> 
> 标签：c#, automapper

AutoMapper 新手问题。

我有一个具有相同字段和子集合的源和目标 DTO。AutoMapper 如何映射这些？

简化的源 DTO 和目标 DTO 共享相同的名称：

> ```
> Customer
>     Orders
>        Invoices
>     CustomerInfo 
> ```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-07T17:12:23.997

尝试

```
Mapper.CreateMap<Customer, CustomerModel>();
Mapper.CreateMap<Orders, OrderModel>();
Mapper.CreateMap<Invoices, InvoicesModel>();
Mapper.CreateMap<CustomerInfo, CustomerInfoModel>();
var mappedModel = Mapper.Map<Customer, CustomerModel>(customer); 
```

这是另一个类似的主题：[AutoMapper - 在视图模型中映射子集合](https://stackoverflow.com/questions/8270396/automapper-mapping-child-collections-in-viewmodel)

# google-maps - 谷歌地图信息窗口

> ID：13767604
> 
> 赞同：3
> 
> 时间：2012-12-07T17:00:28.430
> 
> 标签：google-maps, infowindow

我正在尝试为一些地图标记创建侦听器。我可以创建标记，它们在地图上，但是，无论我点击哪个标记，它都会告诉我`"Uncaught TypeError: Cannot call method 'open' of undefined"`。当我打破开放代码时，它显示标记[46]，这是最高索引的一个。我点击哪个标记总是相同的索引并不重要。

**编辑**：我编辑了代码并粘贴了所有内容。没有错误，但是当我单击标记时没有任何反应。我正在查看 Chrome，看起来没有注册事件处理程序

```
<script>
var map;
var nav = [];
$(document).ready(function () {
    //initialise a map
    init();
    var infowindow = new google.maps.InfoWindow({});
    $.get("xxxxxx.kml", function (data) {
        html = "";
        //loop through placemarks tags                    
        i = 1;
        $(data).find("Placemark").each(function (index, value) {
            //get coordinates and place name
            coords = $(this).find("coordinates").text();
            contentString = $(this).find("description").text();

            var partsOfStr = coords.split(',');
            var lat = parseFloat(partsOfStr[0]);
            var lng = parseFloat(partsOfStr[1]);
            var myLatLng = new google.maps.LatLng(lng, lat);
            place = $(this).find("name").text();

            createMarker(myLatLng, place, contentString, i)

            //store as JSON
            c = coords.split(",")
            nav.push({
                "place": place,
                "lat": c[0],
                "lng": c[1]
            })
            //output as a navigation
            html += "<li>" + place + "</li>";
            i++;
        });
        //output as a navigation
        $(".navigation").append(html);

        //bind clicks on your navigation to scroll to a placemark

        $(".navigation li").bind("click", function () {

            panToPoint = new google.maps.LatLng(nav[$(this).index()].lng, nav[$(this).index()].lat)

            map.panTo(panToPoint);
        })

    });
    markers = [];

    function createMarker(myLatLng, title, contentString, i) {
        var marker = new google.maps.Marker({
            position: myLatLng,
            map: map,
            title: title
        });

        google.maps.event.addListener(markers, 'click', function () {
            infoWindow.setContent(contentString);
            infowindow.open(map, markers[i]);
        });
        markers[i] = marker;
        return marker
    }

    function init() {

        //google.maps.event.addDomListener(window, 'init', Initialize);
        var latlng = new google.maps.LatLng(39.047050, -77.131409);
        var myOptions = {
            zoom: 4,
            center: latlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP

        };
        map = new google.maps.Map(document.getElementById("map"), myOptions);

    }

}) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T17:17:13.853

这几乎是一个常见问题解答。当您的循环结束时， i 的值为 46（基于您的语句）。没有标记 46，因此所有点击侦听器都失败了。它可以通过函数闭包（一个保存标记和信息窗口内容之间关联的 createMarker 函数）来解决。

在您的示例（未测试）中类似这样的东西，从您的标记创建循环中调用它，需要一个全局标记数组，但不需要全局信息窗口数组：

```
//global markers array
markers = [];
// global infowindow
var infowindow = new google.maps.InfoWindow({});

// createMarker function
function createMarker(myLatLng, title, contentString, i)
{
    var marker = new google.maps.Marker({
    position: myLatlng , 
    map: map, 
    title:title
 });

  google.maps.event.addListener(markers, 'click', function() {
    infoWindow.setContent(contentString);
    infowindow.open(map,markers[i]);
  });
  markers[i] = marker;
  return marker
} 
```

# mod-rewrite - URL Rewriterule 适用于外部重定向，但不适用于内部重定向

> ID：13767605
> 
> 赞同：2
> 
> 时间：2012-12-07T17:00:34.200
> 
> 标签：mod-rewrite, redirect, url-rewriting

我的 .htaccess 有问题，因为它在某种程度上表现得很奇怪。我的网址是

```
http://my_domain.com/best_apps/my_apps/login 
```

我希望它在内部使用 mod rewrite 重定向到

```
http://my_domain.com/best_apps/index.php/login 
```

以下是我的 htaccess 文件：

```
RewriteEngine on
RewriteBase /

RewriteCond $1 ^(my_app)
RewriteRule ^(my_app)(.*)$ /best_apps/index.php$2 [L] 
```

奇怪的行为是，如果重定向是内部的（标志为`[L]`），它不起作用并显示 404 错误，但如果我在外部进行（标志为 ），它确实有效并正确重定向到我的登录页面`[R=301,L]`。

注意：重写应该适用于我的应用程序的所有页面，而不仅仅是登录页面。

# asp-classic - 如何在经典 ASP 中进行 UDP 调用？

> ID：13767610
> 
> 赞同：2
> 
> 时间：2012-12-07T17:00:55.920
> 
> 标签：asp-classic, udp, fsockopen

在 PHP 中，您可以像这样进行 UDP 调用（来自[文档](http://php.net/manual/en/function.fsockopen.php)）：

```
<?php
$fp = fsockopen("udp://127.0.0.1", 13, $errno, $errstr);
if (!$fp) {
    echo "ERROR: $errno - $errstr<br />\n";
} else {
    fwrite($fp, "\n");
    echo fread($fp, 26);
    fclose($fp);
}
?> 
```

是否可以在 Classic ASP 中进行 UDP 调用？如果是这样，最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-02T02:17:16.777

您应该在经典 asp 中使用 activex 组件来执行此操作。至少有 3 种产品，您可以选择其中一种。

*   Dart Communications 的[Udp ActiveX 控件](http://www.powertcp.com/winsock-activex-udp-control.aspx)

*   ActiveXperts 软件的[ActiveXperts 网络组件](http://www.activexperts.com/network-component/)

*   Chilkat Software 的[Socket / SSL 组件](http://www.chilkatsoft.com/socket-features.asp)

# c# - 反映一种反编译的方式？

> ID：13767615
> 
> 赞同：-2
> 
> 时间：2012-12-07T17:01:26.213
> 
> 标签：c#, java, reflection, decompiling

如果是这样，我怎样才能保护我的代码不被反编译？
还是被反映？如果实际上两者是非常不同的。
.Net 框架的 Dotfuscator 之类的工具，它们是否可以帮助您的代码免于被反编译？这是否意味着我仍然可以反思它并看到它的内容？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T17:04:39.453

你也不能停下来。您可以使反编译程序返回难以理解和令人困惑的代码，但它仍然是有效代码，导致程序的功能与您的程序相同。做出细微的改变会*更难*，但并非不可能。这样做被称为混淆，这就是那些工具。

混淆器到处做一些事情，比如将所有变量名更改为无意义的字母数字值，执行各种代码重构，这些代码不会改变代码的工作方式，但只是以不同的方式做同样事情的事情（并且在某种程度上更难人类可以理解，但计算机无法理解）。他们还可以添加不做任何事情的代码，只是为了迷惑人等。不同的混淆器会做各种各样的事情，并且它们可能会有一些差异，例如，它们是否会意外引入错误，它们的作用是什么是关于已编译程序的大小，以及已编译程序与原始源的接近程度（当然，这有点主观）。

它对反射的作用是一样的，虽然反射和反编译是*完全*不同的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T17:12:46.470

首先，让我们回顾一下这两个术语之间的区别。

**反射**提供了在运行时发现程序集中类型信息的能力。这是框架的一部分，使诸如 IDE 中的代码完成、程序集之间的引用等功能成为可能。它也用于框架，例如 ASP.NET（您基本上可以在标记中引用类或 Web 控件并且实例将在运行时使用反射动态创建）。这也用于序列化，这是 Web 服务、WCF、Web 部件框架、会话状态、AJAX 等的核心。

**反编译**是将机器代码转换为更高级别的人类可读代码的术语。.NET 框架使用中间语言 (IL)，它是一种与机器无关的低级语言，*有点类似于*汇编，减去 CPU 特定的东西，如寄存器。运行时本身实际上是获取此 IL 并通过称为 JIT'ing 的过程将其编译为实际特定于本地计算机的代码。显然，您的代码必须在 IL 中才能让运行时理解它（尽管有预编译或预 JIT IL 代码的过程）。

两者之间没有重叠。反射*仅*使用存储在程序集清单中的元数据，它不查看编译器生成的实际 IL 代码。您永远无法使用反射来推断方法的实际实现方式

话虽如此，有各种工具可以混淆 IL 代码，使其更难理解。一种流行的一种工具[Dotfuscator](http://www.preemptive.com/products/dotfuscator)。

# java - Java 正则表达式替换大字符串中的多个文件路径

> ID：13767616
> 
> 赞同：0
> 
> 时间：2012-12-07T17:01:32.083
> 
> 标签：java, regex, string, parsing, html-parsing

所以我不是正则表达式专业人士，我正在寻找一种好方法来做到这一点。我有一个包含可变数字`<img>`标签的大字符串。我需要将所有这些图像的路径更改为`images/`. 大字符串还包含其他内容，而不仅仅是这些 img。

```
<img src='http://server.com/stuff1/img1.jpg' />
<img src='http://server.com/stuff2/img2.png' /> 
```

用`ReplaceAll()`我可以做的替换服务器名称，它是中间的变量路径，我不知道如何包含。它不一定需要是正则表达式，但循环整个字符串似乎很浪费。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:10:12.753

Apache Commons Lang 提供 API 来进行各种替换：

```
String dirName = "images";
StringUtils.replace(html, "http://server.com/stuff1/", dirName + "/"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T17:15:17.610

以下应该适用于替换`<img>`从 server.com 链接到 jpg 的所有标签：

```
s.replaceAll("<img src='http://server.com[^']*/([^']*)' />", "<img src='images/$1' />"); 
```

如果您在属性周围使用双引号`src`：

```
s.replaceAll("<img src=\"http://server.com[^\"]*/([^\"]*)\" />", "<img src=\"images/$1\" />"); 
```

这是有效的，因为`[^']*/`它将匹配尽可能多的非单引号字符，然后是文字“/”，因此它将消耗整个路径。如果所有`<img>`标签都来自 server.com，您可以删除`http://server.com`并且正则表达式将以相同的方式工作。

请注意，如果您事先知道需要替换所有图像标签，或者您的字符串仅包含`<img>`标签，则可以进一步缩短此时间，例如，您可以使用以下内容仅替换所有`src`属性中的路径：

```
s.replaceAll("src='[^']*/([^']*)'", "src='images/$1'"); 
```

如果替换的内容比您想要的多，只需添加更多您想要匹配到正则表达式的文字字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T17:05:11.370

使用 Java 字符串方法`replaceAll(regex, replacement)`

在哪里

```
String regex = "(http://server\\.com/)[^<]+(/[^<]+)"; 
```

和

```
String directory = "images";
String replacement = "$1" + directory + "$2"; 
```

这将转

```
http://server.com/stuff1/img1.jpg 
```

进入

```
http://server.com/images/img1.jpg 
```

例如：

```
String content = "<img src=\"http://server.com/stuff1/img1.jpg\"><img src=\"http://server.com/stuff1/img2.jpg\"><img src=\"http://server.com/stuff1/img3.jpg\">"
String regex = "(http://server\\.com/).+(/img1\\.jpg)";
String directory = "images";
String replacement = "$1" + directory + "$2";
content = content.replaceAll(regex, replacement);
System.out.println(content); 
```

将输出：

```
<img src="http://server.com/images/img1.jpg"><img src="http://server.com/images/img2.jpg"><img src="http://server.com/images/img3.jpg"> 
```

如果您想跳过完整的主机名并使用相对路径更改`replacement`为：

```
String replacement = directory + "$2"; 
```

这将转

```
http://server.com/stuff1/img1.jpg 
```

进入

```
images/img1.jpg 
```

# c# - 使用 Simple Injector 的不同配置

> ID：13767618
> 
> 赞同：8
> 
> 时间：2012-12-07T17:01:43.800
> 
> 标签：c#, dependency-injection, inversion-of-control, simple-injector

我正在使用[Simple Injector](http://simpleinjector.codeplex.com) Dependency Injection 框架，它看起来很酷很漂亮。但是在构建配置并使用它之后，现在我想知道如何从一种配置更改为另一种配置。

**场景**：假设我在 Global Asax 中设置了一个配置，并且在`Container`那里有公共和全局实例。现在我想做一些测试，我希望他们使用模拟类，所以我想更改配置。

当然，我可以构建另一个配置并将其分配给`Container`默认创建的全局配置，这样每次我运行测试时都会设置替代配置。但是在这样做时，尽管我处于开发环境中，但`Container`每个人的情况都会发生变化，即使是正常请求也是如此。我知道我在这种情况下进行测试，这并不重要，但我觉得这不是这样做的方式......我想知道如何以正确的方式从一种配置更改为另一种配置。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T21:17:04.160

在进行单元测试时，您根本不应该使用容器。只需通过调用其构造函数并为其提供适当的模拟对象来创建被测类。

过去对我有很大帮助的一种模式是使用简单的特定于测试类的工厂方法。该方法集中了被测类的创建，并最大限度地减少了当被测类的依赖关系发生变化时需要进行的更改量。这就是这种工厂方法的样子：

```
private ClassUnderTest CreateValidClassUnderTest(params object[] dependencies)
{
    return new ClassUnderTest(
        dependencies.OfType<ILogger>().SingleOrDefault() ?? new FakeLogger(),
        dependencies.OfType<IMailSender>().SingleOrDefault() ?? new FakeMailer(),
        dependencies.OfType<IEventPublisher>().SingleOrDefault() ?? new FakePublisher());
} 
```

对于集成测试，更常见的是使用容器，并交换容器的一些依赖项。尽管如此，这些集成测试不会使用您在 application_start 中创建的容器，但在这种情况下，每个集成测试很可能都有自己的新容器实例，因为每个测试都应该独立运行。即使您确实使用了 application_start 中的单个容器，您的集成测试也是从一个单独的项目中运行的，并且不会干扰您正在运行的应用程序。

尽管每个集成测试都应该有自己的容器实例（如果有的话），但您仍然希望尽可能多地重用容器配置代码。这可以通过将此代码提取到一个方法中来完成，该方法要么在调用时返回一个新的配置容器实例，要么配置一个提供的容器实例（并且不返回任何内容）。此方法通常应执行不完整的配置，调用者（您的测试或全局 asax）应添加缺少的配置。

提取此代码：允许您拥有多个部分共享相同配置的终端应用程序；允许您在集成测试中验证容器；并允许您添加需要由集成测试模拟的服务。

为了让生活更轻松，Simple Injector 允许您将现有注册替换为新注册（例如模拟的注册）。您可以按如下方式启用此功能：

```
container.Options.AllowOverridingRegistrations = true; 
```

但是要小心这个！此选项可以隐藏您意外覆盖注册的事实。根据我的经验，在大多数情况下，构建一个不完整的容器并在之后添加丢失的注册而不是覆盖它们要好得多。或者，如果您决定覆盖，请在最后一刻启用该功能，以防止任何意外的错误配置。

# c++ - 在 Mac 上编写 C（及其变体）并导出到 Mac 和 Windows

> ID：13767620
> 
> 赞同：1
> 
> 时间：2012-12-07T17:01:56.420
> 
> 标签：c++, c, windows, macos, ide

所以有人告诉我，使用也可以在 Windows 中运行的 xcode 在 mac 上编写 Objective C 程序并不是最简单的事情（因为 xcode 使用 mac 专有库）。我对我使用的语言不太挑剔，因为我只是在学习，所以有没有一种简单的方法可以在可以（轻松）导出并在 Windows 中运行的 mac 上编写 C/C#/C++/Objective C？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T17:12:20.353

[您可以使用MXE](http://mxe.cc)在 Mac 上为 Windows 编译 Objective-C 代码。但我假设您对 GUI 应用程序感兴趣，而不仅仅是纯粹的标准 Objective-C 代码。在这种情况下，您将需要一个跨平台框架。例如[Qt](http://qt-project.org)（MXE 与 Qt 一起提供）。但那是一个 C++ 框架。

用于 GUI 应用程序的 Objective-C 几乎只有 Apple 使用。如果您希望应用程序具有更好的可移植性，您可能应该使用 C 或 C++。如果您喜欢动态/脚本语言，Python 是您可以使用的另一种语言。Python 还支持 Qt，因此您可以使用它编写 GUI 应用程序。

我推荐 Qt 胜过所有其他框架的原因是，它不仅为您提供了 GUI 库，而且还为您提供了其他类，使编写跨平台应用程序变得更加容易（例如，易于使用的 Unicode 字符串类，以及用于可移植文件 I/O、网络、线程等的类）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T17:04:18.710

查看跨平台 GUI 库。Objective-C 主要与 Apple 产品相关，所以我怀疑你会在那里找到很多跨平台。

对于 C#，Mono 项目可能是一个不错的起点： [http ://www.mono-project.com/Main_Page](http://www.mono-project.com/Main_Page)

对于 C++，您可以从查看 Qt 和 Wx 开始。

根据付出的努力，您还可以尝试分离您的 GUI 并尝试使用一些 GUI 脚本语言，如 Tk。这样做的好处是你可以在你的主要语言上有更多的余地。

# adobe - Adobe Illustrator - 文件分组

> ID：13767621
> 
> 赞同：-1
> 
> 时间：2012-12-07T17:01:59.400
> 
> 标签：adobe, adobe-illustrator

有没有办法打开多个 AI 文件（比如 3 个单独的文件）并以某种方式保存，以便我将来可以同时打开相同的 3 个文件？我总是希望多个文件一起打开。

情况：我们用人工智能设计产品。一个产品可能有多个版本。设计人员通常会创建 1 个 AI 文件，然后将产品的所有版本放在一个文件中。我需要他们将每个版本放在一个单独的文件中以用于集成项目，但这为他们创造了更多的工作。

我正在寻找的解决方案将允许他们打开所有相关的 AI 文件，并以某种方式将它们全部作为一个组。下一次，他们打开组，所有 AI 文件一起打开。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T21:42:29.683

您可以在 Adob​​e Bridge 中对文件进行分组和标记文件，但要同时打开它们，您必须选择它们全部右键单击并点击打开，或者将它们放在同一个文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T02:35:15.857

只需打开记事本，将其以任何名称保存为“open”，扩展名为“.bat”，因为它看起来像“open.bat”。现在保存在放置文件的目录中。

现在输入 start your_file_name_1.ai
start your_file_name_2.ai
start your_file_name_3.ai

{start[space][file name with extension]}写多少就写多少。并保存它。并且保存文件后，这些文件会同时打开一个接一个。

跳这个工作。

# c# - 如何在 Roslyn 上获取扩展方法？

> ID：13767626
> 
> 赞同：6
> 
> 时间：2012-12-07T17:02:07.263
> 
> 标签：c#, roslyn

我需要列出在文件中找到的所有扩展方法。

这就是我目前正在做的事情（看起来它正在工作）：

```
var methods = nodes.OfType<MethodDeclarationSyntax>();    
var extensionMethods = methods.Where(m => 
        m.Modifiers.Any(t => t.Kind == SyntaxKind.StaticKeyword) 
        && m.ParameterList.Parameters.Any(p => 
            p.Modifiers.Any(pm => pm.Kind == SyntaxKind.ThisKeyword))); 
```

即使我无法测试所有案例，但看起来这很有效。但我想知道是否有更简洁的方法来处理这个解决方案。

是否有某种 IsExtension 或某种 SyntaxKind.ExtensionMethod？我看了看，但至少找不到任何明显的东西。

我正在使用最新的 Roslyn 9 月 12 日

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T18:34:57.820

你在句法层面工作，在这个层面上，没有“扩展方法”之类的东西。您可以做的是获取`Symbol`每个方法的语义信息（称为 ），然后您将看到它是否是扩展方法。就像是：

```
SyntaxTree tree = …
var compilation = Compilation.Create("foo").AddSyntaxTrees(tree);
var model = compilation.GetSemanticModel(tree);

var methods = …
var extensionMethods =
   methods.Where(m => model.GetDeclaredSymbol(m).IsExtensionMethod); 
```

这意味着您的代码实际上需要编译，并且您还必须向编译添加任何必要的引用。

# javascript - 隐藏 twitter 引导弹出框

> ID：13767632
> 
> 赞同：1
> 
> 时间：2012-12-07T17:02:46.537
> 
> 标签：javascript, jquery, twitter-bootstrap

以下是我用来显示的 jquery 代码`popover`。我想做的是当用户点击屏幕上的任何地方或任何地方时，`<span id="close" class="pover"></span>`它会隐藏当前打开的弹出框并显示用户点击的新弹出框。

正如您在下面看到`class="pover"`的，下面的 jquery 正在弹出包含的 span 请告诉我如何隐藏打开的弹出窗口并相应地显示一个新的

目前，所有弹出框都显示在点击事件上。

```
$(document).ready(function() {
    $('.pover').each(function() {
        //$('#close').popover( "hide" );
        $(this).popover({
            title: $(this).attr('abc'),
            content: $(this).attr('data-content'),
            delay: "show",
            trigger: "click"
        });
    });
});​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T19:43:45.323

找到了这个很棒的解决方案：

正是我想要做的。

[https://github.com/lecar-red/bootstrapx-clickover](https://github.com/lecar-red/bootstrapx-clickover)

[http://www.leecarmichael.com/bootstrapx-clickover/examples.html](http://www.leecarmichael.com/bootstrapx-clickover/examples.html)

# javascript - Xml.XmlDataDocument() 过时消息

> ID：13767640
> 
> 赞同：0
> 
> 时间：2012-12-07T17:03:11.857
> 
> 标签：javascript, xml, visual-studio-2010

我正在运行一个简单的程序，您在文本框中输入用户编号，单击提交按钮，然后程序应该去数据库查找您输入的编号并显示该行信息。很简单。问题是我不断收到 Xml.XmlDataDocument() 已过时的错误。我已经用谷歌搜索了这个问题，这导致我来到这里，但是建议的替换在我的程序中不起作用。另外，我没有研究过 VB，这是针对 XML 类的。我已经仔细检查了我的代码是否有任何错误，但什么也没看到。但是，我可能只见树木不见森林。想让另一双眼睛看看我的代码，看看我是否遗漏了什么，或者提供 Xml.XmlDataDocument() 行的替代品。提前感谢您提供的任何帮助。

这是我正在使用的代码：

onClick 事件的 Javascript

```
<script language="javascript" type="text/javascript">

        function btnSearch_onclick() {
            var docSubmit = new ActiveXObject("MSXML2.DOMDocument");
            docSubmit.loadXML("<?xml version='1.0'?><request><customerID>" + txtCustID.value + "</customerID></request>")

            var objSocket = new ActiveXObject("MSXML2.XMLHTTP");
            objSocket.open("POST", "Lookup.aspx", false)
            objSocket.send(docSubmit)
            alert(objSocket.responseXML.xml)

            lblFirstName.innerHTML = objSocket.responseXML.selectSingleNode("//FirstName").firstChild.nodeValue
            lblLastName.innerHTML = objSocket.responseXML.selectSingleNode("//LastName").firstChild.nodeValue
            lblAddress.innerHTML = objSocket.responseXML.selectSingleNode("//Address").firstChild.nodeValue
            lblCity.innerHTML = objSocket.responseXML.selectSingleNode("//City").firstChild.nodeValue
            lblState.innerHTML = objSocket.responseXML.selectSingleNode("//State").firstChild.nodeValue
            lblZip.innerHTML = objSocket.responseXML.selectSingleNode("//Zip").firstChild.nodeValue

        }
    </script> 
```

这是VB代码：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Dim docReceived As New System.Xml.XmlDataDocument()
        docReceived.Load(Request.InputStream)

        Dim CustomerID = docReceived.SelectSingleNode("//customerID").FirstChild.Value

        Dim myConnection As New System.Data.OleDb.OleDbConnection
        Dim myConnectionString As String
        myConnectionString = "Provider = Microsoft.Jet.OLEDB.4.0;Data Source = " & _
        Server.MapPath("customer.mbd")
        myConnection.ConnectionString = myConnectionString

        Dim strSQL As String
        strSQL = "Select * From CustomerInfo where CustomerID = " & CustomerID

        Dim myAdapter As New System.Data.OleDb.OleDbDataAdapter(strSQL, myConnection)

        Dim myDataSet As New System.Data.DataSet("CustomerInfo")

        Dim intRecords As Integer
        intRecords = myAdapter.Fill(myDataSet, "Customer")

        Response.ContentType = "text/xml"

        If intRecords > 0 Then
            myDataSet.WriteXml(Response.OutputStream)
        Else
            Response.Write("<?xml version='1.0'?><customer><FirstName>Not Found</FirstName><LastName>***</LastName><Address>***</Address><City>***</City><State>***</State><Zip>***</Zip><Phone>***</Phone><Email>***</Email></customer>")
        End If

        myDataSet.WriteXml(Response.OutputStream)

        myConnection.Close()
        myAdapter.Dispose()
        myConnection.Dispose()

    End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:34:17.003

XmlDataSet 已过时。正如您在[msdn](http://msdn.microsoft.com/en-us/library/system.xml.xmldatadocument.aspx)上看到的，它甚至可能在 .NET Framework 的下一版本中被删除（[ObsoleteAttribute("XmlDataDocument class will be removed in a future release.")]）。在你的情况下，我认为你根本不需要它。简单的修复似乎是只使用 XmlDocument。我相信您不必更改代码中的任何其他内容，但这一行

```
Dim docReceived As New System.Xml.XmlDataDocument()
```

至：

```
Dim docReceived As New System.Xml.XmlDocument()
```

# java - Pattern/Matcher group() 在 Java 中获取子字符串？

> ID：13767644
> 
> 赞同：12
> 
> 时间：2012-12-07T17:03:24.910
> 
> 标签：java, regex, string, match

**更新：**感谢所有伟大的回应！我尝试了许多不同的正则表达式模式，但不明白为什么 m.matches() 没有做我认为应该做的事情。当我改用**m.find()**并调整正则表达式模式时，我能够到达某个地方。

* * *

我想匹配 Java 字符串中的模式，然后使用正则表达式（如 Perl 的 $& 运算符）提取匹配的部分。

这是我的源字符串“s”：`DTSTART;TZID=America/Mexico_City:20121125T153000` 我想提取“America/Mexico_City”部分。

我以为我可以使用 Pattern 和 Matcher，然后使用 m.group() 进行提取，但它没有按我预期的那样工作。我尝试过使用不同的正则表达式字符串，唯一似乎碰到 m.matches() 的东西`".*TZID.*"`是没有意义的，因为它只返回整个字符串。有人可以启发我吗？

```
 Pattern p = Pattern.compile ("TZID*:"); // <- change to "TZID=([^:]*):"
 Matcher m = p.matcher (s);
 if (m.matches ()) // <- change to m.find()
    Log.d (TAG, "looking at " + m.group ()); // <- change to m.group(1) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-07T17:21:56.223

您使用`m.match()`它尝试匹配整个字符串，如果您将使用`m.find()`，它将在内部搜索匹配项，我还改进了您的正则表达式以使用零宽度查找排除 TZID 前缀：

```
 Pattern p = Pattern.compile("(?<=TZID=)[^:]+"); //
     Matcher m = p.matcher ("DTSTART;TZID=America/Mexico_City:20121125T153000");
     if (m.find()) {
         System.out.println(m.group());
     } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-07T17:11:58.770

这应该很好地工作：

```
Pattern p = Pattern.compile("TZID=(.*?):");
Matcher m = p.matcher(s);
if (m.find()) {
    String zone = m.group(1); // group count is 1-based
    . . .
} 
```

另一种正则表达式是`"TZID=([^:]*)"`. 我不确定哪个更快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T17:06:22.957

您在星号之前缺少一个点。您的表达式将匹配任意数量的大写`D`s。

```
Pattern p = Pattern.compile ("TZID[^:]*:"); 
```

您还应该添加一个*捕获组*，除非您想捕获所有内容，`"TZID"`包括`":"`

```
Pattern p = Pattern.compile ("TZID=([^:]*):"); 
```

最后，您应该使用正确的 API 来搜索字符串，而不是尝试匹配整个字符串。

```
Pattern p = Pattern.compile("TZID=([^:]*):");
Matcher m = p.matcher("DTSTART;TZID=America/Mexico_City:20121125T153000");
if (m.find()) {
    System.out.println(m.group(1));
} 
```

这[打印](http://ideone.com/ogwb5v)

```
America/Mexico_City 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-07T17:09:07.387

你使用了错误的模式，试试这个：

```
Pattern p = Pattern.compile(".*?TZID=([^:]+):.*");
Matcher m = p.matcher (s);
if (m.matches ())
    Log.d (TAG, "looking at " + m.group(1)); 
```

`.*?`将匹配开始时的任何内容`TZID=`，然后`TZID=`将匹配，一个组将开始并匹配所有内容`:`，该组将在此处关闭，然后`:`将匹配`.*`并将匹配字符串的其余部分，现在您可以在`group(1)`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-07T17:14:36.660

为什么不简单地使用 split 作为：

```
 String origStr = "DTSTART;TZID=America/Mexico_City:20121125T153000";
  String str = origStr.split(":")[0].split("=")[1]; 
```

# ios - 如何制作带有步骤、箭头样式的 UIToolbar

> ID：13767647
> 
> 赞同：1
> 
> 时间：2012-12-07T17:03:57.067
> 
> 标签：ios, uitoolbar, uitoolbaritem

很难解释我在寻找什么，甚至不确定 Apple 是否会允许它（因为人机界面设计指南），但是否可以在 UIToolbar 中逐步制作“进度”栏？下图会解释很多。您可以看到 1、2、3、4 步骤，最好是所有按钮（因此您可以单击退一步）

![带有步骤的 UIToolbar](../Images/c3f022d41b3507e5c9f7a1295fd4c7b5.png)

有什么帮助吗？还是我必须用图像来做？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T19:25:07.770

尝试使用与此处类似的方法。[检查 BASEequencecontrol](http://www.cocoacontrols.com/platforms/ios/controls/basequencecontrol)。[源代码](https://github.com/dimzzy/BaseAppKit)可在 github 中找到。

![在此处输入图像描述](../Images/d3a7e135fc6b2216676c281dd8634c0e.png)

# java - 如何使用混音器的同步功能

> ID：13767651
> 
> 赞同：2
> 
> 时间：2012-12-07T17:04:11.510
> 
> 标签：java, audio, javasound, mixer

我正在创建一个程序，它以数学方式生成字节数组，这些字节数组被解释为声音，并让它们都以相同的速率播放并从相同的样本开始，我需要使用`Mixer`来自. 我将其设置为：`java.sound.sampled``synchronize(line[], boolean maintainSync)`

```
 Mixer a = (Mixer) new Object();
        a.synchronize(lines, false);
        lines[0].start(); 
```

我知道这段代码不起作用，但是将接口实现到我的类中并尝试通过引用该方法也没有，但是由于一个函数`this.synchronize(----)`，该类需要成为`abstract`才能实现它。*我不知道如何使用该**方法而不会遇到问题或使该功能真正起作用*。`line.getInfo`*`synchronize()`*

# php - Magento - 在购物车页面上使用自定义模块添加自定义块

> ID：13767656
> 
> 赞同：3
> 
> 时间：2012-12-07T17:04:27.760
> 
> 标签：php, xml, magento, layout, block

我创建了一个自定义模块，并试图在购物车表之后和总计框之前包含一个块。但我无法在那个确切的地方得到它。我可以让我的块出现在内容部分，就在其他所有内容的下方，但不在两者之间。

如果我覆盖 checkout.xml 和 cart.phtml 那么我可以实现我想要显示我的块但我不想覆盖现有文件，因此我的自定义模块。有人可以指出我错过了什么或做错了什么。

这是我的模块代码，

`app/code/local/CM/Test/etc/config.xml`

```
<?xml version="1.0"?>
<config>
<modules>
    <CM_Test>
        <version>0.1.0</version>
    </CM_Test>
</modules>
<frontend>
    <routers>
        <test>
            <use>standard</use>
            <args>
                <module>CM_Test</module>
                <frontName>test</frontName>
            </args>
        </test>
    </routers>
    <layout>
        <updates>
            <cm_test module="CM_Test">
                <file>test.xml</file>
            </cm_test>
        </updates>
    </layout>
</frontend>
<global>
<blocks>
    <test>
    <class>CM_Test_Block</class>
        </test>
</blocks>
</global>
</config> 
```

`app/code/local/CM/Test/Block/Somblock.php`

```
 <?php
  class CM_Test_Block_Somblock extends Mage_Core_Block_Template
  {
   protected function _construct()
   {
    parent::_construct();
    $this->setTemplate('test/testing.phtml');
   }

   public function methodBlock()
   {
     return 'informations about my block !!' ;
   }
} 
```

`app/code/local/CM/Test/controllers/IndexController.php`

```
 <?php
 class CM_Test_IndexController extends Mage_Core_Controller_Front_Action
 {
    public function indexAction()
    {
      $this->loadLayout();
      $this->renderLayout();
    }
    public function somethingAction()
    {
      echo 'test mamethode';
    }
 } 
```

`app/design/frontend/mytheme/layout/test.xml`

```
 <layout version="0.1.0">
  <default></default>
  <test_index_index>
        <reference name="root">
          <action method="setTemplate"><template>page/2columns-right.phtml</template>       
              </action>
        </reference>
        <reference name="content">
              <block type="test/somblock" name="test.somblock" template="test/testing.phtml"/>
            </reference>
  </test_index_index>

  <checkout_cart_index>
  <reference name="checkout.cart.form.before">
        <block type="test/somblock" name="test.somblock">
              <action method="setTemplate"><template>test/testing.phtml</template></action> 
        </block>
        <block type="test/somblock" name="test.somblock" template="test/smtesting.phtml"/>      
  </reference>
  </checkout_cart_index>
 </layout> 
```

`app/design/frontend/default/mytheme/template/test/testing.phtml`

```
 TESTING <br/>
 <?php 
 echo $this->getChildHtml('testing.somblock');
 echo "HELLO"; 
```

`app/design/frontend/default/mytheme/template/test/smtesting.phtml`

```
 <?php
 echo $this->methodBlock(); 
```

`app/etc/modules/CM_Test.xml`

```
 <?xml version="1.0"?>
 <config>
 <modules>
  <CM_Test>
   <codePool>local</codePool>
   <active>true</active>
  </CM_Test>
</modules>
</config> 
```

当我访问[http://mydomain.com/test/index/index](http://mydomain.com/test/index/index)它给了我以下 o/p

`TESTING HELLO`

当我访问[http://mydomain.com/checkout/cart/index](http://mydomain.com/checkout/cart/index)它给了我以下 o/p

![我的模块的输出](../Images/5a3a5ef38a3583ff0e3a10de06916ce7.png)

但是我需要`information about my block`在购物车表和小计框上方的输出，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T07:46:13.790

```
<checkout_cart_index>
    <reference name="checkout.cart">
        <block type="test/somblock" name="test.somblock" before="checkout.cart.totals" template="test/testing.phtml" />
        <block type="test/somblock" name="test.somblock" after="test.somblock" template="test/smtesting.phtml"/>      
    </reference>
</checkout_cart_index> 
```

您指的是购物车前的表格，而您希望它在购物车中。更改您的参考并将其添加到总计之前（或者如果您愿意，可以在折扣之前添加）。

# php - GMT 时间格式转整数格式

> ID：13767660
> 
> 赞同：1
> 
> 时间：2012-12-07T17:04:36.250
> 
> 标签：php, javascript

我正在尝试显示不同时区的自动收报机时钟。当我环顾网络时，看起来它需要数字作为 javascript 中的偏移量（例如 +5.5 小时）。但是我们在 php 中获取 gmtformat 的方式是 +05:30，我试图将其输入到 javascript 函数中。有什么函数可以用来转换吗？

```
/*CLOCK CODE IN JAVASCRIPT*/
function startclock(field, timediff, newOrRepeat)
{ 
    var clockAction=newOrRepeat;
if (timediff=="") {$(field).html("-------");return false;}
    /****THERE ARE MORE STUFF IN BETWEEN AND AFTER WHICH IS NOT RELEVANT TO OFFSET****/
var secondsDiff=0;
var secondsTimeZone = 0;
//calculate the difference in time set by both the timezone as well as the DST
secondsTimeZone = parseInt(timediff);

if ($("input[name='daylight']:checked").val()=="on" && $(field).siblings("#isDaylight").val()=="no")
    secondsDiff=secondsTimeZone + 3600;
else if ($("input[name='daylight']:checked").val()=="off" && $(field).siblings("#isDaylight").val()=="yes")
    secondsDiff=secondsTimeZone - 3600;
else 
    secondsDiff = secondsTimeZone;

var thetime=new Date();

thetime.setUTCSeconds(parseInt(thetime.getUTCSeconds())+parseInt(secondsDiff));
var nhours=thetime.getUTCHours();
var nmins=thetime.getUTCMinutes();
var nsecn=thetime.getUTCSeconds();

} 
```

我直接从我传递给这个函数的 php 获取 gmt 格式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:31:51.403

```
function convert_time($time){
    $parts = explode(':', $time);
    return $parts[0] + number_format($parts[1]/60, 2);
} 
```

# android - 通过 Android 原生应用程序使用意图回复推文

> ID：13767663
> 
> 赞同：7
> 
> 时间：2012-12-07T17:04:41.117
> 
> 标签：android, twitter

我正在开发一个应用程序，我首先在其中列出来自帐户的推文（使用 HttpClient 等，我宁愿不使用 twitter4j）。

当用户单击列表中的推文时，会显示所有内容，我希望有一个按钮可以回复该推文。

我已经成功地让用户通过本地 Twitter 应用程序发送推文。但是，它不会将该响应与原始推文相关联，它只是作为一条新推文呈现。

这是我正在使用的代码：

```
String tweetUrl = "https://twitter.com/intent/tweet?text=EXAMPLE TEST&url=https://www.google.com&in_reply_to_status_id=STATUS ID";
Uri uri = Uri.parse(tweetUrl);
startActivity(new Intent(Intent.ACTION_VIEW, uri)); 
```

如果我将相同的 url 放在网络浏览器中，它会正确处理回复，所以我猜这是本机应用程序没有正确获取所有参数的问题。

有谁知道如何解决这个问题？提前致谢！

# c# - 如何在页面渲染之前加载视图状态

> ID：13767672
> 
> 赞同：0
> 
> 时间：2012-12-07T17:05:23.643
> 
> 标签：c#, viewstate

我在 C# 中动态创建了一些表，它们给了我视图状态问题。我有一个复选框表和一个取决于第一个的数字条目表。当我按下一个导致回发的按钮时，我遇到了一些问题。这是一个流程图。

Page_Load

*   创建复选框表
*   创建数字条目表（复选框始终为空，表的行数错误，但从回发中正确填充了数字）

回发按钮

*   创建数字条目表（现在已填充复选框，表具有正确的行数，但数字无法在回发中存活）。

有没有办法在创建数字条目表之前将视图状态加载到复选框表？我试图在一个或另一个地方创建数字条目表（在页面加载或回发按钮方法上），但都不是完全正确的。我知道需要在每次加载时创建动态内容才能显示视图状态。

我怀疑我可能需要创建一个数据表并将其存储在视图状态中，以便复选框正确重新出现......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:18:58.813

我会在您的页面`PreInit`或`Init`事件中添加您的动态控件。虽然您可以在之后添加它们，但在该`Init`阶段之后`ViewState`是为控件加载数据的时间。

如果在`Page_Load`控件必须播放期间添加控件，则必须*追赶*，这意味着它会运行页面生命周期中的所有事件，直到它赶上页面的其余部分。这可能会导致您看到的问题。

`Page Lifecycle`这是一篇关于and的优秀文章：http `ViewState`: [//www.codeproject.com/Articles/24611/ASP-NET-Internals-Viewstate-and-Page-Life-Cycle](http://www.codeproject.com/Articles/24611/ASP-NET-Internals-Viewstate-and-Page-Life-Cycle)

# c# - C# LINQ - 加载实体然后对它们进行排序

> ID：13767674
> 
> 赞同：0
> 
> 时间：2012-12-07T17:05:31.363
> 
> 标签：c#, linq

未加载“订单”属性！如何更改此代码以加载属性“订单”然后获取其计数以便我可以使用它进行排序？

```
 IOrderedQueryable<Event> orderedQuery = (paging.SortDirection == SortDirection.Ascending)
                                   ? searchQuery.ToList().AsQueryable<Event>().OrderBy(e => e.Orders.Count)
                                   : searchQuery.ToList()
                                                .AsQueryable<Event>()
                                                .OrderByDescending(e => e.Orders.Count); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:08:57.857

`ToList()`执行查询，结果列表将不包含订单。

如果您一开始不打电话`ToList()`，它应该可以工作：

```
var orderedQuery = 
    (paging.SortDirection == SortDirection.Ascending)
     ? searchQuery.OrderBy(e => e.Orders.Count)
     : searchQuery.OrderByDescending(e => e.Orders.Count); 
```

# javascript - 带有 javascript onChange 数学的 ASP 页面

> ID：13767679
> 
> 赞同：0
> 
> 时间：2012-12-07T17:05:46.810
> 
> 标签：javascript, asp-classic, onchange

当我更改数量以反映新成本（数量 * 价格）时，我正在尝试更新此字段（订单成本）

```
<td class="result" align="right">$<Input type="text" maxLength="9" style="text-align:right; width:55px;" align="right" id="OC<%=i %>" value="<%=formatnumber(rstBevInventory("avg_unit_cost"),2)*proposed %>"/></td> 
```

它计算原始总数，但是当我更改数量时，它会调用这个 Javascript 函数：

```
function reCalcOrder(i){
    document.getElementById("OC"+i).value = document.getElementById("P"+i).value * document.getElementById("Q"+i).value;
    cost = document.getElementById("OC"+i).value;
    Math.round(cost * 100) / 100;
    document.getElementById("OC"+i).set("value", "cost");
        if (document.getElementById("Q"+i).value < 0){
            document.getElementById("Q"+i).value = 0;
        }
} 
```

我得到的数字太多了，这似乎是因为 Javascript 处理乘法的方式。当数量字段改变时，有没有办法让 ASP 做出反应？因为 ASP 似乎可以毫无问题地进行数学运算。

提前谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:10:29.573

是的，有，使用 Ajax。但是我相信如果您更改此行，您也会解决问题：

```
Math.round(cost * 100) / 100; 
```

到

```
cost = Math.round(cost * 100) / 100; 
```

另一种选择是使用`Number.prototype.toFixed`：

```
cost = cost.toFixed(2); 
```

# iphone - CGContextDrawImage 崩溃

> ID：13767685
> 
> 赞同：0
> 
> 时间：2012-12-07T17:06:09.433
> 
> 标签：iphone, objective-c, ios, core-graphics

我正在尝试从 CGImage 创建 CVPixelBufferRef 所以这里是方法：

```
- (CVPixelBufferRef) pixelBufferFromCGImage: (CGImageRef) image
{
    CGImageRetain(image);
    NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:
                             [NSNumber numberWithBool:YES], kCVPixelBufferCGImageCompatibilityKey,
                             [NSNumber numberWithBool:YES], kCVPixelBufferCGBitmapContextCompatibilityKey,
                             nil];
    CVPixelBufferRef pxbuffer = NULL;

    CVPixelBufferCreate(kCFAllocatorDefault, CGImageGetWidth(image),
                        CGImageGetHeight(image), kCVPixelFormatType_32ARGB, (CFDictionaryRef) options,
                        &pxbuffer);

    CVPixelBufferLockBaseAddress(pxbuffer, 0);
    void *pxdata = CVPixelBufferGetBaseAddress(pxbuffer);
    CGColorSpaceRef rgbColorSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef context = CGBitmapContextCreate(pxdata, CGImageGetWidth(image),
                                                 CGImageGetHeight(image), 8, 4*CGImageGetWidth(image), rgbColorSpace,
                                                 kCGImageAlphaNoneSkipFirst);
    CGContextRetain(context);
    CGContextConcatCTM(context, CGAffineTransformMakeRotation(0));
    CGContextDrawImage(context, CGRectMake(0, 0, CGImageGetWidth(image),
                                               CGImageGetHeight(image)), image);
    CGColorSpaceRelease(rgbColorSpace);
    CGContextRelease(context);
    CVPixelBufferUnlockBaseAddress(pxbuffer, 0);
    CGContextRelease(context);
    CGImageRelease(image);
    return pxbuffer;
} 
```

我经常调用这个方法，它用于生成视频帧，25fps。这在大多数情况下都可以正常工作，但在某些时候它会在这行代码上崩溃：

```
 CGContextDrawImage(context, CGRectMake(0, 0, CGImageGetWidth(image),
                                                   CGImageGetHeight(image)), image); 
```

我已经测试了内存使用和内存泄漏，一切都很好，但仍然会出现崩溃。

崩溃堆栈：线程 6 崩溃：

```
0   ImageIO                         0x39270806 CGImageReadGetBytesAtOffset + 34
1   ImageIO                         0x392707d6 CGImageReadSessionGetBytes + 22
2   ImageIO                         0x39280c3c fill_input_buffer + 148
3   ImageIO                         0x3928003a read_markers + 154
4   ImageIO                         0x3927fd82 consume_markers + 34
5   ImageIO                         0x3927fbd2 _cg_jpeg_consume_input + 66
6   ImageIO                         0x3927fb62 _cg_jpeg_read_header + 38
7   ImageIO                         0x39292782 copyImageBlockSetJPEG + 2346
8   ImageIO                         0x3928953e ImageProviderCopyImageBlockSetCallback + 510
9   CoreGraphics                    0x38e0b9d6 CGImageProviderCopyImageBlockSetWithOptions + 158
10  CoreGraphics                    0x38e0b66a img_blocks_create + 370
11  CoreGraphics                    0x38e07a98 img_data_lock + 1488
12  CoreGraphics                    0x38e06d2a CGSImageDataLock + 126 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T18:26:54.780

From the crash stack, it looks like your image itself is released on some other thread, probably prior to your call to `CGImageRetain()`. The fact that you're calling `CGImageRetain()` here suggests that you expect that. But if that's the case, the retain is insufficient, since it creates a race condition. The image may have been destroyed before you try to retain it. So either the `CGImageRetain` is unnecessary or it is insufficient. In neither case should it be here (nor its balancing `CGImageRelease`).

This suggests very dangerous use of this image on some other thread, which either suggests that you're calling this method oddly, or that you've let your threading get over-complicated. For instance, if you're using `NSThread` directly, you've probably let it get too complicated.

I would audit your other retains and releases on this image and make sure that they cannot happen in the middle of calling this method. I'm pretty sure that's what's happening.

A side note: you have a redundant `CGContextRetain`/`CGContextRelease` that are not needed. When you called `CGBitmapContextCreate()`, that included a retain (it has "Create" in the name). That said, this is just a minor performance problem; you've properly balanced them. But it suggests that your memory management elsewhere may also be odd, and so you should audit it.

# ruby-on-rails-3 - 在rails3中格式化json

> ID：13767687
> 
> 赞同：0
> 
> 时间：2012-12-07T17:06:22.727
> 
> 标签：ruby-on-rails-3, json

我正在尝试访问我的变量的 JSON 版本。我尝试使用 . 显示变量上的符号，因为我认为它现在已格式化为 json 对象。@shows.title 但这导致了错误。我尝试使用 @shows.to_json.title 让它工作，但仍然没有好处。我想当你 format.json 时它已经调用了 to_json ，这就是使用格式的想法，或者我以这种方式思考是不正确的。如果是这样，那么格式会做什么。

```
 class ShowsController < ApplicationController
      # GET /shows
      # GET /shows.json
      def index
        @shows = Show.all

        respond_to do |format|
          format.html # index.html.erb
          format.json { render json: @shows }

        end
      end 
```

index.html.erb

```
<p> @shows.title <p> 
```

我在 JSON 中寻找的结构是这样的。

```
[
                {
                    "id": "feature",
                    "width":570,
                    "title": "Lorem ipsum dolor amet emipsum do omnis iste natus",
                    "description": "Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantiu mdoloremque laudantium.",
                    "img": "img/work/img1.jpg",
                    "url": "http://www.bla.com"
                },
                {
                    "id": "show",
                    "width":200,
                    "title": "Lorem ipsum dolo",
                    "description": "Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantiu mdoloremque laudantium.",
                    "img": "img/work/img2.jpg",
                    "url": "http://www.bla.com"
                } 
```

]

**更新：**也许我没有正确解释这一点。

我的目标是让我在控制器中的操作调用 index.html 页面，它现在就是这样做的。在该页面上是一个 jquery 插件，它请求一个包含数据库中所有数据的 JSON 对象。这样它就可以解析 JSON 并使用 jquery 插件渲染 index.html 页面上的所有对象。这样做的原因是它使用了一个名为 jquery.masonry.js 和 jquery.infinitescroll.js 的插件，它现在设置为使用多个 JSON 结构来创建我的页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:59:34.867

如果您需要 jquery 可以访问您的集合，那么您可以将其呈现为脚本块内的 json 字符串。因此，例如在您的 index.html.erb 中，您可以输入：

```
<%= javascript_tag "var shows = #{@shows.to_json}" %> 
```

这将呈现

```
<script type="type/javascript"> var shows = { "your":"json", "object":"YAY" } </script> 
```

但是你还是要respond_to html

# sql - Oracle：制作包含三个 Foregin 键的复合键

> ID：13767691
> 
> 赞同：1
> 
> 时间：2012-12-07T17:06:35.697
> 
> 标签：sql, oracle, foreign-keys, primary-key, composite

这是我的代码：

```
create table orderline
(
Order_No number(4) constraint orderno_fk references order_detail(Order_No),
Product_Code varchar2(6) constraint productcode2_fk references product(Product_Code),
Product_Size char(1) constraint productsize_fk references product_stock(Product_Size),
Product_Quantity number(4) not null
constraint orderline_comp primary key (Order_No,Product_Code, Product_Size)
); 
```

我收到错误消息（“订单”之前的左括号下方有星号）：

```
ERROR at line 7:
ORA-00907: missing right parenthesis 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:11:58.627

你需要一个`,`之前`constraint orderline...`

# wcf - 中毒消息服务不应该处理通用消息吗？

> ID：13767697
> 
> 赞同：1
> 
> 时间：2012-12-07T17:07:09.057
> 
> 标签：wcf, msmq

好的，所以我一直试图绕过队列 -> 死信队列 -> 死信队列的毒子队列 -> ？

现在，据[我了解，如果消息处理失败](http://www.cogin.com/articles/SurvivingPoisonMessages.php)**或接收方不支持消息上的操作，则**可以将消息发送到毒队列。 [我发现的大多数文章都](http://msdn.microsoft.com/en-us/library/ms789028.aspx)显示了使用与主服务相同的合同来实现毒服务。如果错误是合约不支持提供的消息，那岂不是*把对毒消息队列有毒的消息**放入**毒消息队列？*

拥有一个可以处理毒物队列中任何东西的处理程序不是更有意义吗？下面假设一个 WCF 消息，它可能也不安全（并且完全未经测试），但是有没有办法进行万无一失的毒物队列处理？我越是尝试通过排队来思考边缘情况，我就越觉得不可能有一个完整的系统来处理所有可能性。

```
 [OperationContract(IsOneWay = true, Action = "*")]
    [OperationBehavior(TransactionScopeRequired = true, TransactionAutoComplete = true)]
    public void CatchAll(Message message)
    {
        // Log somewhere?
    } 
```

另一个想法是有一个触发器，将所有消息从中毒队列移回死信队列以再次处理 - 这可能会再次中毒并无限循环。

我想具体的问题是..人们如何处理死信队列中的毒消息？一般的问题是——你到底是如何处理 MSMQ 中的所有情况的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T21:38:28.123

据我所知，该`MsmqMessage<T>`类型可以与任何 WCF msmq 绑定一起使用。

因此，如果您指定接收类型，`MsmqMessage<String>`则应涵盖所有基础。您将收到作为字符串的消息。你如何处理字符串中的内容是另一回事......

# c++ - 升压测试 - “未定义的参考”错误

> ID：13767699
> 
> 赞同：9
> 
> 时间：2012-12-07T17:07:20.610
> 
> 标签：c++, unit-testing, boost, mingw, boost-test

我有两个简单的文件：

亚军.cpp：

```
#define BOOST_TEST_DYN_LINK
#define BOOST_TEST_MODULE Main
#include <boost/test/unit_test.hpp> 
```

和 test1.cpp：

```
#define BOOST_TEST_DYN_LINK
#ifdef STAND_ALONE
#   define BOOST_TEST_MODULE Main
#endif
#include <boost/test/unit_test.hpp>

BOOST_AUTO_TEST_SUITE( Foo)

BOOST_AUTO_TEST_CASE( TestSomething )
{
    BOOST_CHECK( true );
}

BOOST_AUTO_TEST_SUITE_END() 
```

要编译，我正在使用：

```
$ g++ -I/e/code/boost_1_52_0 -o runner -lboost_unit_test_framework runner.cpp test1.cpp 
```

我收到以下错误：

```
C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\ccU0cDSz.o:runner.cpp:(.text+0x8c): multiple definition of `main'
c:/pdev/mingw/bin/../lib/gcc/i686-pc-mingw32/4.7.2/../../../libboost_unit_test_framework.a(unit_test_main.o):unit_test_main.cpp:(.text.startup+0x0): first defined here
c:/pdev/mingw/bin/../lib/gcc/i686-pc-mingw32/4.7.2/../../../libboost_unit_test_framework.a(unit_test_main.o):unit_test_main.cpp:(.text.startup+0x14): undefined reference to `init_unit_test_suite(int, char**)'
C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\ccU0cDSz.o:runner.cpp:(.text+0x52): undefined reference to `_imp___ZN5boost9unit_test9framework17master_test_suiteEv'
C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\ccU0cDSz.o:runner.cpp:(.text+0xb0): undefined reference to `_imp___ZN5boost9unit_test14unit_test_mainEPFbvEiPPc'
C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\ccU0cDSz.o:runner.cpp:(.text$_ZN5boost9unit_test13test_observerD2Ev[__ZN5boost9unit_test13test_observerD2Ev]+0xe): undefined reference to `_imp___ZTVN5boost9unit_test13test_observerE'
C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\ccU0cDSz.o:runner.cpp:(.text$_ZN5boost9unit_test13test_observerC2Ev[__ZN5boost9unit_test13test_observerC2Ev]+0xe): undefined reference to `_imp___ZTVN5boost9unit_test13test_observerE'
C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\ccU0cDSz.o:runner.cpp:(.text$_ZN5boost9unit_test15unit_test_log_tC1Ev[__ZN5boost9unit_test15unit_test_log_tC1Ev]+0x22): undefined reference to `_imp___ZTVN5boost9unit_test15unit_test_log_tE'
C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\cciSdkmB.o:test1.cpp:(.text+0x88): undefined reference to `_imp___ZN5boost9unit_test15unit_test_log_t14set_checkpointENS0_13basic_cstringIKcEEjS4_'
C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\cciSdkmB.o:test1.cpp:(.text+0x136): undefined reference to `_imp___ZN5boost10test_tools9tt_detail10check_implERKNS0_16predicate_resultERKNS_9unit_test12lazy_ostreamENS5_13basic_cstringIKcEEjNS1_10tool_levelENS1_10check_typeEjz'
C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\cciSdkmB.o:test1.cpp:(.text+0x21d): undefined reference to `_imp___ZN5boost9unit_test9ut_detail24auto_test_unit_registrarC1ENS0_13basic_cstringIKcEE'
C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\cciSdkmB.o:test1.cpp:(.text+0x284): undefined reference to `_imp___ZN5boost9unit_test9ut_detail24auto_test_unit_registrarC1EPNS0_9test_caseEm'
C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\cciSdkmB.o:test1.cpp:(.text+0x2a4): undefined reference to `_imp___ZN5boost9unit_test9ut_detail24auto_test_unit_registrarC1Ei'
C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\cciSdkmB.o:test1.cpp:(.text$_ZN5boost9unit_test14make_test_caseERKNS0_9callback0INS0_9ut_detail6unusedEEENS0_13basic_cstringIKcEE[__ZN5boost9unit_test14make_test_caseERKNS0_9callback0INS0_9ut_detail6unusedEEENS0_13basic_cstringIKcEE]+0x1d): undefined reference to `_imp___ZN5boost9unit_test9ut_detail24normalize_test_case_nameENS0_13basic_cstringIKcEE'
C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\cciSdkmB.o:test1.cpp:(.text$_ZN5boost9unit_test14make_test_caseERKNS0_9callback0INS0_9ut_detail6unusedEEENS0_13basic_cstringIKcEE[__ZN5boost9unit_test14make_test_caseERKNS0_9callback0INS0_9ut_detail6unusedEEENS0_13basic_cstringIKcEE]+0x5b): undefined reference to `_imp___ZN5boost9unit_test9test_caseC1ENS0_13basic_cstringIKcEERKNS0_9callback0INS0_9ut_detail6unusedEEE'
collect2.exe: error: ld returned 1 exit status 
```

我在 MinGW 上使用 g++ 4.7.2，boost 1.52.0。

仅尝试编译时，我会遇到相同的错误`test1.cpp`-“多个主要定义”除外。

我仔细阅读了官方文档很长一段时间，但是关于链接选项的细节很少。当我编译 boost 库时，除此之外`unit_test_framework`，我还得到了`prg_exec_monitor`and `test_exec_monitor`; 也许我应该以某种方式链接这些？我尝试了很多组合，但都导致了某种未定义的引用链接器错误。

boost生成的库的完整列表-我将它们全部放在项目根目录中：

```
libboost_prg_exec_monitor-mgw47-mt-1_52.a
libboost_prg_exec_monitor-mgw47-mt-1_52.dll
libboost_prg_exec_monitor-mgw47-mt-1_52.dll.a
libboost_prg_exec_monitor-mgw47-mt-d-1_52.a
libboost_prg_exec_monitor-mgw47-mt-d-1_52.dll
libboost_prg_exec_monitor-mgw47-mt-d-1_52.dll.a
libboost_test_exec_monitor-mgw47-mt-1_52.a
libboost_test_exec_monitor-mgw47-mt-d-1_52.a
libboost_unit_test_framework-mgw47-mt-1_52.a
libboost_unit_test_framework-mgw47-mt-1_52.dll
libboost_unit_test_framework-mgw47-mt-1_52.dll.a
libboost_unit_test_framework-mgw47-mt-d-1_52.a
libboost_unit_test_framework-mgw47-mt-d-1_52.dll
libboost_unit_test_framework-mgw47-mt-d-1_52.dll.a 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-08T12:59:01.860

在[@llonesmiz](https://stackoverflow.com/users/1252091/llonesmiz)的帮助下，发现了一些问题。

**1\. 需要在使用它们的对象和源*之后指定库。***

[如此处](http://www.network-theory.co.uk/docs/gccintro/gccintro_18.html)所述：

> 链接器的传统行为是在命令行指定的库中从左到右搜索外部函数。这意味着包含函数定义的库应该出现在使用它的任何源文件或目标文件之后。这包括使用快捷方式 -l 选项指定的库，如以下命令所示：
> 
> `$ gcc -Wall calc.c -lm -o calc (correct order)`
> 
> *对于某些链接器，相反的顺序（将 -lm 选项放在使用它的文件之前）会导致错误，*
> 
> `$ cc -Wall -lm calc.c -o calc (incorrect order)`
> `main.o: In function 'main':`
> `main.o(.text+0xf): undefined reference to 'sqrt'`
> 
> 因为在“calc.c”之后没有包含 sqrt 的库或目标文件。选项 -lm 应该出现在文件 'calc.c' 之后</p>

**2\. 应明确指定库路径。**

如果未指定库路径，则链接器可能会在一系列默认文件夹中查找库，从而加载不同的库。这就是我的情况 - 我想链接`boost_unit_test_framework`，但没有指定路径，因为我假设链接器会在当前文件夹中查找。毕竟，这就是运行时发生的事情 - 如果 与`dll`位于同一文件夹中`exe`，它会找到它。

我发现链接器会找到 lib 有点奇怪，因为它被命名为`ibboost_unit_test_framework-mgw47-mt-1_52.dll`. 当我试图链接到一个不存在的库时，链接器抱怨了，所以我认为这不是问题，并且`MinGW`' 的链接器忽略了这些后缀。

经过更多研究，我发现[了这篇关于 MinGW 库路径](http://www.mingw.org/wiki/HOWTO_Specify_the_Location_of_External_Libraries_for_use_with_MinGW)的文章。MinGW 搜索库的文件夹可以在`gcc -print-search-dirs`. 这篇文章还包含一些`bash`魔法来理解该输出：

```
gcc -print-search-dirs | sed '/^lib/b 1;d;:1;s,/[^/.][^/]*/\.\./,/,;t 1;s,:[^=]*=,:;,;s,;,;  ,g' | tr \; \\012 | grep -v '^ */' 
```

这将打印这些文件夹的漂亮列表。*默认情况下，不会*`gcc`在当前目录中查找库。我查看了它们中的每一个，发现正在加载的库 -一个静态库。*`libboost_unit_test_framework.a`*

 *这揭示了另一个值得一提的问题：

**3\. 静态与动态链接**

我没有指定是要`boost_unit_test_framework`静态链接还是动态链接。在这种情况下，[`gcc`更喜欢动态链接](http://www.network-theory.co.uk/docs/gccintro/gccintro_25.html)：

> 由于这些优点，gcc 在大多数系统上默认编译程序以使用共享库，如果它们可用的话。每当静态库“libNAME.a”用于与选项 -lNAME 链接时，编译器首先检查具有相同名称和“.so”扩展名的替代共享库。

（`so`是 Unix 上动态库的扩展名 - 在 Windows 上，相当于`dll`.）

所以，发生的事情是在它的所有默认文件夹中`gcc`查找`libboost_unit_test_framework.dll` ，但找不到它。然后它寻找 `libboost_unit_test_framework.a`，并静态链接。这导致链接错误，因为源具有`#define BOOST_TEST_DYN_LINK`，因此期望动态链接 lib。

为了强制执行静态或动态链接，`-Wl,-Bstatic`和`-Wl,-Bdynamic` 链接器选项发挥作用，描述[here](https://stackoverflow.com/q/6578484/447661)。

如果我告诉链接器我想要动态链接：

```
$ g++ -I/e/code/boost_1_52_0 runner.cpp test1.cpp -o runner -Wl,Bdynamic -lboost_unit_test_framework 
```

这将失败，因为链接器将无法找到`dll`.

**4.总结**

问题是：

1.  在使用它们的源之前指定的库
2.  未指定 lib 路径
3.  未指定链接类型
4.  图书馆名称不正确

最终，工作命令：

```
$ g++ -I/e/code/boost_1_52_0 -o runner runner.cpp test1.cpp -L. -Wl,-Bdynamic -lboost_unit_test_framework-mgw47-mt-1_52 
```*

# ember.js - 如何为 Ember 路由回调提供上下文

> ID：13767701
> 
> 赞同：2
> 
> 时间：2012-12-07T17:07:29.097
> 
> 标签：ember.js

新手报警！

我有一点主/详细视图：http: [//jsbin.com/ijicor/112/edit](http://jsbin.com/ijicor/112/edit)

在 connectOutlets 和序列化的回调函数中，上下文总是未定义的。我错过了什么以及如何访问会员数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T18:40:07.280

我必须做两件事。在第 11 行，我必须提供 event 作为参数： router.transitionTo('member', event); 因此 connectOutlets 函数不会接收上下文，而是接收事件作为参数。我用调试器发现了这一点，并认为这里的文档是错误的。

这是一个工作示例[http://jsbin.com/ijicor/122/edit](http://jsbin.com/ijicor/122/edit)

# android - 如何在 Android 上获取 Vorbis 库？

> ID：13767705
> 
> 赞同：4
> 
> 时间：2012-12-07T17:07:30.127
> 
> 标签：android, android-ndk, ogg, oggvorbis, vorbis

好的，我花了一天的大部分时间试图做到这一点，我想我必须错过一些相当明显的东西。

[Android SDK](http://developer.android.com/guide/appendix/media-formats.html)显然原生支持 Vorbis 文件。作为开发人员有什么方法可以访问这些库。

情况：我有一个使用[libvorbis 和 libogg 库](http://xiph.org/downloads/)的项目来加载 ogg 文件。整个东西在 OSX、linux、iOS 等上编译并运行良好，我试图将它移植到 android。

使用 NDK 编译项目，我得到错误：（ `fatal error: vorbis/codec.h: No such file or directory` `compilation terminated.` 我假设它会继续说它找不到 vorbisfile.h）

问题一：Android上可以访问C语言的vorbis API吗？或者实际上，是否有任何 Vorbis API？

没有太多努力，我偶然发现了 Tremor 和[Tremolo](http://wss.co.uk/pinknoise/tremolo/) - ARM vorbis 库，但我找不到任何关于如何让它们使用 Android SDK 编译的信息。

问题2：有人可以提供任何帮助吗？

让我知道我是否可以提供任何其他信息来提供帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:31:05.303

您可以以 android/ffmpeg/x264[项目](https://github.com/guardianproject/android-ffmpeg)为例。x264 不是 ogg/vorbis，但它是在 android 构建和链接场景中将 ffmpeg 与辅助库链接的一个明显示例。

注意：这将需要相当长的时间才能完成。

如果您了解使用 x264 构建的示例，那么您应该能够交换 obb/vorbis 库来代替 x264 并将其全部链接到 android 构建。

这假设您熟悉 NDK 和跨工具链以及 git 项目和子模块（x264、ogg、vorbis）

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-12-29T04:51:42.647

也许你可以使用 Xiph.org 的 vorbis-java-1.0.0-beta，这是一个 java 包，你可以将它移植到 Android。

# gcc - 如何在 Solaris 10 中以 64 位构建 net-snmp-5.0.9？gcc 中的运行时选项是什么

> ID：13767707
> 
> 赞同：0
> 
> 时间：2012-12-07T17:07:33.537
> 
> 标签：gcc, net-snmp, solaris-10

我想在 Solaris 10 中构建 64 位的 netsnmp 包。

```
How i can build net-snmp-5.0.9 in 64 bit in Solaris 10 ?
what the run time option in gcc 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T07:12:33.837

```
./configure --with-cc="gcc -m64" ... 
```

# android - Android - onResume 后不加载保存的图像文件

> ID：13767710
> 
> 赞同：2
> 
> 时间：2012-12-07T17:07:39.353
> 
> 标签：android, android-imageview, android-camera-intent

我的应用程序中的一个功能是通过相机应用程序拍照，将其保存在外部存储中，然后将其放置在调用相机的活动中的 ImageView 中。代码如下所示：

```
public class ProjectActivity extends Activity {

private static final String JPEG_FILE_SUFFIX = ".jpeg";
private Bitmap _ImageBitmap;
private ImageView _ImageView;
private int _index;
private String _CurrentPhotoPath; 
```

onCreate 方法找到 ImageView 并在位图成员已启动时对其进行设置（对于我以后要添加的功能）：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_project);

    if(_ImageBitmap != null)
        _ImageView.setImageBitmap(_ImageBitmap);
} 
```

如果位图已经初始化，onResume 方法应该将图像加载到 ImageView：

```
@Override
protected void onResume() {
    if(_ImageBitmap != null)
        _ImageView.setImageBitmap(_ImageBitmap);
    super.onResume();
} 
```

拍照的方法，它们都可以正常工作，直到恢复活动：

```
public void takePicture(View view){
    this.dispatchTakePictureIntent(0);
}

/**
 * invokes an intent to take a picture
 * @param actionCode
 */
private void dispatchTakePictureIntent(int actionCode) {
    String action = MediaStore.ACTION_IMAGE_CAPTURE;
    if(Data.isIntentAvailable(this, action)){
            if(this.isExternalStorageWritable()){
            File f = createImageFile();
            if(f != null){
                Intent takePictureIntent = new Intent(action);

                //takePictureIntent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(f));
                startActivityForResult(takePictureIntent, actionCode);
            }
        }
    }
}

/**
 *  Checks if external storage is available for read and write 
 */
public boolean isExternalStorageWritable() {
    String state = Environment.getExternalStorageState();
    if (Environment.MEDIA_MOUNTED.equals(state)) {
        return true;
    }
    return false;
}

private File createImageFile() {
    // Create an image file name
    String imageFileName = this._projName + getIndex();
    File image;
    File dir = getAlbumDir(this, this.getAlbumName());
    try {
        image = File.createTempFile(
            imageFileName, 
            JPEG_FILE_SUFFIX, 
            dir
        );
        _CurrentPhotoPath = image.getAbsolutePath();
        return image;
    } catch (IOException e) {
        Toast.makeText(getApplicationContext(), e.toString(), Toast.LENGTH_LONG).show();
        return null;
    }
}

private File getAlbumDir(Context context, String albumName) {
    File file = new File(context.getExternalFilesDir(
            Environment.DIRECTORY_PICTURES), albumName);
    file.mkdirs();
    if (!file.isDirectory()) {
        return null;
    }
    return file;
}

private String getAlbumName() {
    return this._projName;
}

private String getIndex() {
    this._index++;
    return String.valueOf(this._index);
} 
```

从图像捕获操作返回后，onActivityResult 返回 resultCode -1 和来自相机应用程序的数据：

```
protected void onActivityResult (int requestCode, int resultCode, Intent data){
    switch(requestCode){
        case 0:
            if(resultCode != Activity.RESULT_CANCELED){
                handleSmallCameraPhoto(data);
            }
            break;
        default: break;
    }
} 
```

在这种方法中，我从意图中提取位图并将其加载到 ImageView

```
/**
 * adds the picture unto an ImageView
 * @param intent
 */
private void handleSmallCameraPhoto(Intent intent) {
    Bundle extras = intent.getExtras();
    _ImageBitmap = (Bitmap) extras.get("data");
    _ImageView.setImageBitmap(_ImageBitmap);
} 
```

}

这是布局xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
tools:context=".ProjectActivity" >

<ImageView
    android:id="@+id/project_image_view"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:contentDescription="@string/project_image_view" />

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <Button
        android:id="@+id/add_picture_button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/add_picture_button_text"
        android:onClick="takePicture" />

    <Button
        android:id="@+id/make_movie_button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/make_movie_button_text" />

    <Button
        android:id="@+id/edit_button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/edit_button_text" />

</LinearLayout> 
```

我有相机和外部存储权限。

当我对此进行测试时，我可以在拍摄并返回此活动后看到图片，但是一旦调用 onResume （由于相机应用程序的监视器旋转），图像就会消失，我只能看到按钮。

帮助将不胜感激，伊丹

更新：由于某种原因，第二次调用 onResume 时 _ImageBitmap 为空。任何想法为什么会发生这种情况？

# r - 样本在 R 中的组内具有相同数量的每个性别

> ID：13767719
> 
> 赞同：3
> 
> 时间：2012-12-07T17:08:05.663
> 
> 标签：r, statistics

第一件事，第一件事。这是我的数据：

```
lat <- c(12, 12, 58, 58, 58, 58, 58, 45, 45, 45, 45, 45, 45, 64, 64, 64, 64, 64, 64, 64)
long <- c(-14, -14, 139, 139, 139, 139, 139, -68, -68, -68, -68, -68, 1, 1, 1, 1, 1, 1, 1, 1)
sex <- c("M", "M", "M", "M", "F", "M", "M", "F", "M", "M", "M", "F", "M", "F", "M", "F", "F", "F", "F", "M")
score <- c(2, 6, 3, 6, 5, 4, 3, 2, 3, 9, 9, 8, 6, 5, 6, 7, 5, 7, 5, 1)

data <- data.frame(lat, long, sex, score) 
```

数据应如下所示：

```
 lat long sex score
1   12  -14   M     2
2   12  -14   M     6
3   58  139   M     3
4   58  139   M     6
5   58  139   F     5
6   58  139   M     4
7   58  139   M     3
8   45  -68   F     2
9   45  -68   M     3
10  45  -68   M     9
11  45  -68   M     9
12  45  -68   F     8
13  45    1   M     6
14  64    1   F     5
15  64    1   M     6
16  64    1   F     7
17  64    1   F     5
18  64    1   F     7
19  64    1   F     5
20  64    1   M     1 
```

我束手无策，试图弄清楚这一点。变量是纬度、经度、性别和分数。我希望每个位置的男性和女性数量相等（即具有相同的经度和纬度）。例如，第二个位置（第 3 到 7 行）只有一名女性。这个女性应该被保留，其余个体中的一名男性也应该被保留（也许通过随机抽样）。有些位置只有一种性别的信息，例如第一个位置（第 1 行和第 2 行）只有男性数据。应该删除该位置的行（因为没有女性）。一切按计划进行，最终数据集应如下所示：

```
 lat2 long2 sex2 score2
1    58   139    F      5
2    58   139    M      4
3    45   -68    F      2
4    45   -68    M      3
5    45   -68    M      9
6    45   -68    F      8
7    64     1    M      6
8    64     1    F      5
9    64     1    F      7
10   64     1    M      1 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T18:13:44.097

这是一个解决方案`lapply`：

```
data[unlist(lapply(with(data, split(seq.int(nrow(data)), paste(lat, long))),
        # 'split' splits the sequence of row numbers (indices) along the unique
        # combinations of 'lat' and 'long'
        # 'lapply' applies the following function to all sub-sequences
        function(x) {
          # which of the indices are for males:
          male <- which(data[x, "sex"] == "M")
          # which of the indices are for females:
          female <- which(data[x, "sex"] == "F")
          # sample from the indices of males:
          s_male <- sample(male, min(length(male), length(female)))
          # sample from the indices of females:
          s_female <- sample(female, min(length(male), length(female)))
          # combine both sampled indices:
          x[c(s_male, s_female)]                
        })), ]
# The function 'lappy' returns a list of indices which is transformed to a vector
# using 'unlist'. These indices are used to subset the original data frame. 
```

结果：

```
 lat long sex score
9   45  -68   M     3
11  45  -68   M     9
12  45  -68   F     8
8   45  -68   F     2
7   58  139   M     3
5   58  139   F     5
20  64    1   M     1
15  64    1   M     6
19  64    1   F     5
16  64    1   F     7 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T17:48:06.707

下面是一个快速的方法，它涉及创建一个经纬组合的临时列。我们根据这一列拆分DF，计算每个拆分中的M/F，适当采样，然后重新组合。

```
# First, We call the dataframe something other than "data" ;) 
mydf <- data.frame(lat, long, sex, score)

# create a new data frame with a temporary column, which concatenates the lat & long. 
mydf.new <- data.frame(mydf, latlong=paste(mydf$lat, mydf$long, sep=","))

# Split the data frame according to the lat-long location
mydf.splat <- split(mydf.new, mydf.new$latlong)

# eg, taking a look at one of our tables:
mydf.splat[[4]]

sampled <- 
  lapply(mydf.splat, function(tabl) {
    Ms <- sum(tabl$sex=="M")
    Fs <- sum(tabl$sex=="F")

    if(Fs == 0 || Ms ==0)    # If either is zero, we drop that location
      return(NULL)

    if(Fs == Ms)   # If they are both equal, no need to sample. 
      return(tabl)

    # If number of Females less than Males, return all Females 
    #    and sample from males in ammount equal to Females
    if (Fs < Ms)   
      return(tabl[c(which(tabl$sex=="F"), sample(which(tabl$sex=="M"), Fs)),   ])

    if (Ms < Fs)  # same as previous, but for Males < Femals
      return(tabl[c(which(tabl$sex=="M"), sample(which(tabl$sex=="F"), Ms)),   ])

    stop("hmmm... something went wrong.")  ## We should never hit this line, but just in case. 
  })

# Flatten into a single table
mydf.new <- do.call(rbind, sampled)

# Clean up
row.names(mydf.new) <- NULL  # remove the row names that were added
mydf.new$latlong <- NULL     # remove the temporary column that we added 
```

### 结果

```
mydf.new

#    lat long sex score
# 1   45  -68   F     2
# 2   45  -68   F     8
# 3   45  -68   M     9
# 4   45  -68   M     3
# 5   58  139   F     5
# 6   58  139   M     3
# 7   64    1   M     6
# 8   64    1   M     1
# 9   64    1   F     7
# 10  64    1   F     5 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T19:49:12.673

这会将值作为列表元素返回：

```
spl <- split(data, interaction(data$lat, data$long) ,drop=TRUE)
           # interaction creates all the two way pairs from those two vectors
           # drop is needed to eliminate the dataframes with no representation
res <- lapply(spl, function(x) { #First find the nuber of each gender to select
                        N=min(table(x$sex))  # then sample each sex separately
   rbind( x[ x$sex=="M" & row.names(x) %in% sample(row.names(x[x$sex=="M",] ), N) , ],
                 # One (or both) of these will be "sampling" all of that sex.
          x[ x$sex=="F" & row.names(x) %in% sample(row.names(x[x$sex=="F", ]), N) , ] )
                                } )
res
#------------
$`45.-68`  
   lat long sex score
9   45  -68   M     3
11  45  -68   M     9
8   45  -68   F     2
12  45  -68   F     8

$`12.-14` # So there were no women in this group and zero could be matched
[1] lat   long  sex   score
<0 rows> (or 0-length row.names)

$`45.1`
[1] lat   long  sex   score
<0 rows> (or 0-length row.names)

$`64.1`
   lat long sex score
15  64    1   M     6
20  64    1   M     1
16  64    1   F     7
17  64    1   F     5

$`58.139`
  lat long sex score
7  58  139   M     3
5  58  139   F     5 
```

,,,，但如果你想要它作为数据框，你可以使用`do.call(rbind, res)`：

```
> do.call(rbind, res)
          lat long sex score
45.-68.10  45  -68   M     9
45.-68.11  45  -68   M     9
45.-68.8   45  -68   F     2
45.-68.12  45  -68   F     8
64.1.15    64    1   M     6
64.1.20    64    1   M     1
64.1.17    64    1   F     5
64.1.18    64    1   F     7
58.139.6   58  139   M     4
58.139.5   58  139   F     5 
```

# jquery - cufon 字体大小在悬停事件上没有平滑变化，以便在菜单（文本）上产生鱼眼效果

> ID：13767720
> 
> 赞同：1
> 
> 时间：2012-12-07T17:08:07.247
> 
> 标签：jquery, cufon

这是我关于 Cufon 字体的第一篇文章，因为我是 jquery 和 javascript 的新手。我正在尝试在菜单上创建垂直鱼眼效果，即在文本上。我想要的是当我将鼠标悬停在当前菜单上时，当前菜单的字体大小以及上下 2 个子菜单的字体大小应该会平滑变化。在使用 Cufon 字体之前它工作正常，但现在就在那里是大约 1/2 秒的延迟，影响效果的平滑度。

这是我的html文件...........

```
 <html>
    <head>
    <script type="text/javascript" src="js/cufon-yui.js"></script>
    <script type="text/javascript" src="js/my-custom-font_400.font.js"></script>
   <script type="text/javascript">
     Cufon.replace('#scroller ul li a', { 
     fontFamily: 'my-custom-font',
     hover:true
   });
   </script>
   </head>
   <body>
     <div id="rollerBox">
           <div id="scroller" >    
                    <ul id="innerContainer">
                        <li class="pictures1"><a href="#">link1</a></li>
                        <li class="pictures2"><a href="#">link2</a></li>
                        <li class="pictures3"><a href="#">link3</a></li>
                        <li class="pictures4"><a href="#">link4</a></li>
                        <li class="pictures3"><a href="#">link5</a></li>
                        <li class="pictures4"><a href="#">link6</a></li>
                  </ul> <!-- #keywords -->                      
           </div> <!-- #scroller -->                     
      </div> <!-- #rollerBox --
    </body>
   </html> 
```

这是我的鱼眼效果代码（在文本菜单上）............

```
 $(document).ready(function(){
      $("#scroller ul li a").hover(function(){
         $(this).css({"font-size":"28px","color":"green"})
         $(this).parent().next().children().css({"font-size":"26px"})
         $(this).parent().prev().children().css({"font-size":"26px"})
         $(this).parent().nextAll().eq(1).children().css({"font-size":"25px"})
         $(this).parent().prevAll().eq(1).children().css({"font-size":"25px"})
        Cufon.refresh();
   },function(){   
         $(this).css({"font-size":"24px","color":"white"})
         $(this).parent().next().children().css({"font-size":"24px"})
         $(this).parent().prev().children().css({"font-size":"24px"})
         $(this).parent().nextAll().eq(1).children().css({"font-size":"24px"})
         $(this).parent().prevAll().eq(1).children().css({"font-size":"24px"})
       Cufon.refresh();
   })
  }) 
```

# c# - 通过 WCF 从“服务器”中提取信息

> ID：13767723
> 
> 赞同：0
> 
> 时间：2012-12-07T17:08:11.577
> 
> 标签：c#, winforms, wcf

我有两个 WinForms 应用程序：一个“服务器”和一个“客户端”。在服务器上

```
private ServiceHost host;
private const string serviceEnd = "Done";

public Form1()
{
    InitializeComponent();
}

private void Form1_Load(object sender, EventArgs e)
{
    List<string> sqlList = new List<string>();
    foreach (string line in this.richTextBoxSql.Lines)
        sqlList.Add(line);
    SqlInfo sqlInfo = new SqlInfo(sqlList);

    host = new ServiceHost(
        typeof(SqlInfo),
        new Uri[] { new Uri("net.pipe://localhost") });

    host.AddServiceEndpoint(typeof(ISqlListing),
            new NetNamedPipeBinding(),
            serviceEnd);

    host.Open();
} 
```

在哪里

```
public class SqlInfo : ISqlListing
{
    public SqlInfo() {}

    private List<string> sqlList;
    public SqlInfo(List<string> sqlList) : this() 
    {
        this.sqlList = sqlList;
    }

    public List<string> PullSql()
    {
        return sqlList;
    }
}

[ServiceContract]
public interface ISqlListing
{
    [OperationContract]
    List<string> PullSql();
} 
```

在我有的客户端上

```
private ISqlListing pipeProxy { get; set; }
private const string serviceEnd = "Done";

public Form1()
{
    InitializeComponent();
}

private void button1_Click(object sender, EventArgs e)
{
    List<string> l = pipeProxy.PullSql();
    string s = String.Empty;
    foreach (string str in l)
        s += str + " ";
    this.richTextBoxSql.AppendText(s.ToString());
}

private void Form1_Load(object sender, EventArgs e)
{
    ChannelFactory<ISqlListing> pipeFactory =
    new ChannelFactory<ISqlListing>(
      new NetNamedPipeBinding(),
      new EndpointAddress(
         String.Format("net.pipe://localhost/{0}", serviceEnd)));

    pipeProxy = pipeFactory.CreateChannel();
} 
```

问题是，当我`List<string>`使用它从服务器“拉”时，`pipeProxy.PullSql()`它正在调用`public SqlInfo() {}`默认构造函数并设置`sqlList = null`.

**如何获取此代码以返回`RichTextBox`服务器应用程序中的文本？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:33:43.343

这是因为您使用的是这种服务主机：

```
 host = new ServiceHost(
        typeof(SqlInfo),
        new Uri[] { new Uri("net.pipe://localhost") }); 
```

您正在传递一个类型，WCF 框架猜测它必须创建一个类型的实例`SqlInfo`来处理请求。尝试传递对您构造的`SqlInfo`实例的引用，即`sqlInfo`在您的情况下。 [使用 ServiceHost 的这个重载](http://msdn.microsoft.com/en-us/library/ms585487.aspx)，它允许你直接传递实例：

```
host = new ServiceHost(
            sqlInfo,
            new Uri[] { new Uri("net.pipe://localhost") }); 
```

# android - SQLite：不理解空指针

> ID：13767724
> 
> 赞同：0
> 
> 时间：2012-12-07T17:08:17.040
> 
> 标签：android, sqlite

我下面的代码显示了这个警告：

> 空指针访问：变量 civs 在此位置只能为空

```
public static List<String> getCivs(String game) {
    List<String> civs = null;
    System.err.printf("game: %s\n", game);

    SQLiteDatabase db = godSimDBOpenHelper.getReadableDatabase();
    String where = GAME_COLUMN + "= ?";
    Cursor cursor = db.query(GAMES_TABLE, new String[] {CIV_COLUMN}, where, new String[] {game}, null, null, null);

    while (cursor.moveToNext()) {
        System.err.println("now here");
        System.err.println(cursor.getString(0));
        civs.add(cursor.getString(0));  //warning appears for this line
    }

    return civs;
} 
```

果然，当我运行它时，它崩溃了。根据定义，我不明白为什么这必须为空。我意识到我正在将变量初始化为 null（我这样做只是因为如果我不这样做，Eclipse 会给我另一个错误），但是我正在将值添加到 while 循环内的列表中。这是否意味着它不再为空？

对不起，如果我很密集，但我只是看不出这里有什么问题。也许以我初始化变量的方式。只是不确定。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:10:08.827

您正在尝试向`null`对象添加内容。您的`civs`列表不存在；你还没有创建它。

试试这个：

```
List<String> civs = new ArrayList<String>(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:09:44.707

它失败的原因是该变量`civs`是`null`在您尝试对其运行 add 方法时发生的。因此，实际上，您正在尝试引用一个不存在的类实例（您所做的只是创建了一个能够指向实现 List 接口的类的类实例的变量）。

因此，要完成这项工作，您必须使这个变量（目前没有指向任何东西）指向有意义的东西。在这种情况下，这意味着您必须创建一个实现列表接口的类的新实例，并将您的变量设置为指向该实例。

尝试以下

```
public static List<String> getCivs(String game) {

    // here, you are now creating a new instance of the class ArrayList and 
    // setting civs to point at this instance.
    List<String> civs = new ArrayList<String>(); 

    System.err.printf("game: %s\n", game);

    SQLiteDatabase db = godSimDBOpenHelper.getReadableDatabase();
    String where = GAME_COLUMN + "= ?";
    Cursor cursor = db.query(GAMES_TABLE, new String[] {CIV_COLUMN}, where, new String[] {game}, null, null, null);

    while (cursor.moveToNext()) {
        System.err.println("now here");
        System.err.println(cursor.getString(0));
        civs.add(cursor.getString(0));  //warning appears for this line
    }

    return civs;
} 
```

只是一个小提示，这是非常初步的东西，如果你花一点时间阅读oracle的核心java小径，你会很沮丧。

[http://docs.oracle.com/javase/tutorial/](http://docs.oracle.com/javase/tutorial/)

# ruby-on-rails - 无法安装 gem - 无法构建 gem 本机扩展 - 无法加载此类文件 - mkmf (LoadError)

> ID：13767725
> 
> 赞同：198
> 
> 时间：2012-12-07T17:08:19.887
> 
> 标签：ruby-on-rails, ruby, ubuntu, gem, bcrypt

红宝石 1.9.3

Gemfile 部分

```
#...............
gem "pony"
gem "bcrypt-ruby", :require => "bcrypt"
gem "nokogiri" 
#.................. 
```

当我尝试安装 gems 时，出现错误

```
alex@ubuntu:~/$ bundle
Fetching gem metadata from http://rubygems.org/.........
Fetching gem metadata from http://rubygems.org/..
Enter your password to install the bundled RubyGems to your system: 
#####............................................................
Installing bcrypt-ruby (3.0.1) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        /usr/bin/ruby1.9.1 extconf.rb 
/usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- mkmf (LoadError)
        from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
        from extconf.rb:36:in `<main>'

Gem files will remain installed in /home/alex/.bundler/tmp/5526/gems/bcrypt-ruby-3.0.1 for inspection.
Results logged to /home/alex/.bundler/tmp/5526/gems/bcrypt-ruby-3.0.1/ext/mri/gem_make.out
An error occurred while installing bcrypt-ruby (3.0.1), and Bundler cannot continue.
Make sure that `gem install bcrypt-ruby -v '3.0.1'` succeeds before bundling. 
```

然后我这样做

```
sudo gem install bcrypt-ruby -v '3.0.1'
Building native extensions.  This could take a while...
ERROR:  Error installing bcrypt-ruby:
        ERROR: Failed to build gem native extension.

        /usr/bin/ruby1.9.1 extconf.rb
/usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- mkmf (LoadError)
        from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
        from extconf.rb:36:in `<main>'

Gem files will remain installed in /var/lib/gems/1.9.1/gems/bcrypt-ruby-3.0.1 for inspection.
Results logged to /var/lib/gems/1.9.1/gems/bcrypt-ruby-3.0.1/ext/mri/gem_make.out 
```

并得到一个错误。

我错过了什么？

* * *

## 回答 #1

> 赞同：457
> 
> 时间：2012-12-07T17:13:20.137

有类似的问题：

*   [`require': 没有要加载的文件 -- mkmf (LoadError)](https://stackoverflow.com/questions/7645918/require-no-such-file-to-load-mkmf-loaderror)
*   [无法构建 gem 原生扩展 (mkmf (LoadError)) - Ubuntu 12.04](https://stackoverflow.com/questions/18316667/failed-to-build-gem-native-extension-mkmf-loaderror-ubuntu-12-04/18316692#18316692)

通常，解决方案是：

> sudo apt-get install ruby​​-dev

**或者，如果这不起作用，根据您的 ruby​​ 版本**，运行类似：

> sudo apt-get install ruby​​1.9.1-dev

应该解决你的问题。

* * *

还是行不通？安装 ruby​​-dev 后尝试以下操作：

> sudo apt-get install make

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2019-04-25T18:10:01.840

对于 WSL（Linux 的 Windows 子系统），您需要安装`build-essential`包：

```
sudo apt install build-essential 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2019-12-12T15:25:24.503

刚刚完成了 2 小时的野鹅追逐，试图解决这个问题。发布的答案都不适合我。我在 Mac 上（Mojave 版本 10.14.6，Xcode 版本 11.3）。

原来 ruby​​ 文件头丢失了，所以我不得不运行`open /Library/Developer/CommandLineTools/Packages/macOS_SDK_headers_for_macOS_10.14.pkg`

起初这对我不起作用，因为我安装的 CommandLineTools 版本没有“Packages”文件夹。所以我像这样卸载并重新安装：

`rm -rf /Library/Developer/CommandLineTools`

`xcode-select --install`

然后我再次运行前面的命令：

`open /Library/Developer/CommandLineTools/Packages/macOS_SDK_headers_for_macOS_10.14.pkg`

安装后错误已修复！

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-11-11T04:31:51.180

我在尝试安装 jquery-rails 时遇到了同样的问题。修复是

```
sudo apt-get install zlibc zlib1g zlib1g-dev 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-07-11T22:32:01.523

万一将来有人遇到这个问题，我使用的是 Mac，只需要使用“xcode-select --install”安装命令行工具

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-11-19T09:18:44.990

我发现我需要安装另一个版本的 ruby​​。所以运行命令

```
$ sudo apt-get install ruby1.9.1-dev 
```

然后尝试安装扩展

如果您遇到它告诉您没有 g++ 的问题，您可以运行以下命令来安装它

```
$ sudo apt-get install g++ 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-09-19T05:09:56.703

我创建了一个小型 hackMD 来在 MacOS 10.15 (Catalina) 和 11 (Big Sur) 上安装 cocoapods

[https://hackmd.io/@sBJPlhRESGqCKCqV8ZjP1A/S1UY3W7HP](https://hackmd.io/@sBJPlhRESGqCKCqV8ZjP1A/S1UY3W7HP)

# 在 MacOS Catalina(MacOS 10.15.X) 和 Big Sur (MacOS 11) 上安装 Cocoapods

1.  确保您已安装 xcode 组件。

2.  直接从此链接下载“命令行工具”（约 500MB）（要求您拥有苹果帐户） [https://developer.apple.com/downloads/index.action](https://developer.apple.com/downloads/index.action)

3.  安装下载的文件

4.  点击安装

5.  在终端中安装 COCOAPODS 文件 `sudo gem install -n /usr/local/bin cocoapods`

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-05-29T05:21:11.693

1.  确保`ruby-dev`已安装
2.  确保`make`已安装
3.  如果您仍然收到错误，请查找建议的软件包。如果您尝试安装类似的东西，`gem install pg`您还需要安装 lib `libpq-dev`( `sudo apt-get install libpq-dev`)。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2021-01-22T04:01:23.087

对于 MacOS 用户：

只需这样做，它就可以轻松解决您的问题：

```
brew install cocoapods 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-05-08T18:16:37.073

这对我有用。 `bundle config --global build.snappy --with-opt-dir="$(brew --prefix snappy)"`

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-03-03T23:35:13.990

如果您是 mac 用户，则必须更新正在使用的 clang 版本我花了几个小时搜索这个并安装了卸载的 xcode 命令行工具，但它没有帮助。我跑了`gcc -v`，`Apple clang version 11.0.0 (clang-1100.0.33.8`是输出。然后我跑了`xcode-select -s /Library/Developer/CommandLineTools/`，clang 版本更新为`Apple clang version 12.0.0 (clang-1200.0.32.29)`. 之后捆绑安装成功。我希望这可能会有所帮助。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-04-22T22:46:32.240

我正在制作一个[单词搜索](https://play.google.com/store/apps/details?id=word.search.sopa.deletras)应用程序，我必须安装 cocoapods，在格式化我的 mac 并重新安装 xcode 后，当我想安装 cocoapods 时仍然出现错误。

解决方案如下：

看起来 CocoaPods 1.9.0 是撰写本文时的最新版本，它依赖于比 2.3.7 更新的 Ruby 版本。但 macOS Mojave 仅包含 Ruby 2.3.7，因此您有几个不同的选择。

```
 Upgrade to macOS Catalina and get Ruby 2.6.3
    Use Ruby Version Manager to install a newer version of Ruby
    Install an older version of CocoaPods
    sudo gem install cocoapods -v 1.8.4 
```

我做了3：

sudo gem install cocoapods -v 1.8.4

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-01-22T07:09:05.090

What ended up working for me after a few hours of pain..

if you're running brew..

```
brew install ruby 
```

in the terminal output/log, identify the path where ruby was installed, brew suggests 'You may want to add this to your PATH', so that's what we'll do. For example, mine is

```
/usr/local/lib/ruby/gems/3.0.0/bin 
```

Add this to your path by running (omitting braces)

```
echo 'export PATH"{the_path_you_found_above}:$PATH"' >> ~/.bash_profile 
```

然后通过运行更新您的环境

```
source ~/.bash_profile 
```

现在，尝试运行您的安装，即

```
sudo gem install middleman 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-12-10T21:45:02.310

它还有助于确保安装 libmysqlclient-dev (Ubuntu 14.04)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-08-19T08:24:51.570

在 Mac 中，对我来说这是有效的：

```
CONFIGURE_OPTS="--enable-shared" rbenv install 2.2.2 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-08-01T10:20:49.223

经过一番寻找解决方案后，事实证明需要 -dev 包，而不仅仅是 ruby​​1.8。所以如果你有 ruby​​1.9.1 做

```
sudo apt-get install ruby1.9.1-dev 
```

或安装通用 ruby​​ 版本，使用（根据@lamplightdev 评论）：

```
sudo apt-get install ruby-dev 
```

应该修复它。

尝试定位 mkmf 以查看该文件是否确实存在。

# iphone - 尝试在 UISearchDisplayController 上键入时应用程序崩溃

> ID：13767730
> 
> 赞同：0
> 
> 时间：2012-12-07T17:08:51.540
> 
> 标签：iphone, ios, xcode, uisearchdisplaycontroller

出于某种原因，当我尝试键入时，我的应用程序崩溃了`UISearchDisplayController`。我已经使用了[此处](http://ygamretuta.me/2011/08/10/ios-implementing-a-basic-search-uisearchdisplaycontroller-and-interface-builder/)所需的代码，但似乎找不到解决方案。

这是代码：

**视图控制器.h**

```
// #import SideSwipeTableViewController.h
// #import ...

@interface ViewController : SideSwipeTableViewController {

...
UITableView *table;
NSArray *buttonData;
NSMutableArray *buttons;
NSMutableArray *_cloudItems;
...
}

// ...some more code
@end 
```

**视图控制器.m**

```
// code...

_cloudItems = [[NSMutableArray alloc] initWithObjects:@"The quick brown fox jumped over the lazy dog", @"foo", @"bar", @"Cookies", @"1234567890", nil];

...some more code

@end 
```

**SearchViewController.h**

```
#import "ViewController.h"

@interface SearchViewController : ViewController <UITableViewDelegate, UITableViewDataSource, UISearchBarDelegate, UISearchDisplayDelegate> {

UISearchDisplayController *searchBarController;
UISearchDisplayController *searchResultsController;
NSArray *searchResults;
NSArray *allItems;

}

@property (retain, nonatomic) IBOutlet UISearchDisplayController *searchBarController;
@property (retain, nonatomic) IBOutlet UISearchDisplayController *searchResultsController;
@property (nonatomic, copy) NSArray *searchResults;
@property (nonatomic, copy) NSArray *allItems;
@end 
```

**搜索视图控制器.m**

```
 #import "SearchViewController.h"
    #import "SideSwipeTableViewCell.h"
    #import "ViewController.h"

    #define BUTTON_LEFT_MARGIN 29.3
    #define BUTTON_SPACING 29.3

    @interface SearchViewController (PrivateStuff)
    -(void) setupSideSwipeView;
    -(UIImage*) imageFilledWith:(UIColor*)color using:(UIImage*)startImage;
    @end

    @implementation SearchViewController

    @synthesize searchBarController;
    @synthesize searchResultsController;
    @synthesize searchResults;
    @synthesize allItems;

    - (void)viewDidLoad
    {
        [super viewDidLoad];

        self.table.scrollEnabled = YES;

        // Show buttons when side is swiped

        buttonData = [[NSArray arrayWithObjects:
                      [NSDictionary dictionaryWithObjectsAndKeys:@"Reply", @"title", @"reply.png", @"image", nil],
                      [NSDictionary dictionaryWithObjectsAndKeys:@"Retweet", @"title", @"retweet-outline-button-item.png", @"image", nil],
                      [NSDictionary dictionaryWithObjectsAndKeys:@"Favorite", @"title", @"star-hollow.png", @"image", nil],
                      [NSDictionary dictionaryWithObjectsAndKeys:@"Profile", @"title", @"person.png", @"image", nil],
                      [NSDictionary dictionaryWithObjectsAndKeys:@"Links", @"title", @"paperclip.png", @"image", nil],
                      [NSDictionary dictionaryWithObjectsAndKeys:@"Action", @"title", @"action.png", @"image", nil],
                   nil] retain];

        // Declares buttons when side is swiped

        buttons = [[NSMutableArray alloc] initWithCapacity:buttonData.count];

        self.allItems = _cloud;

        [self.table reloadData];

        self.sideSwipeView = [[[UIView alloc] initWithFrame:CGRectMake(tableView.frame.origin.x, tableView.frame.origin.y, tableView.frame.size.width, tableView.rowHeight)] autorelease];
    [self setupSideSwipeView];
    }

    - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {

        NSInteger rows = 0;

        if ([table isEqual:self.searchDisplayController.searchResultsTableView]){
            rows = [self.searchResults count];
        }
        else{
            rows = [allItems count];
        }

        return rows;
    }

    - (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
        return 55;
    }

    #pragma mark Generate the side-swiping
    - (void) setupSideSwipeView
    {
        // Add the background pattern
        self.sideSwipeView.backgroundColor = [UIColor colorWithPatternImage: [UIImage imageNamed:@"dotted-pattern.png"]];

        // Overlay a shadow image that adds a subtle darker drop shadow around the edges
        UIImage* shadow = [[UIImage imageNamed:@"inner-shadow.png"] stretchableImageWithLeftCapWidth:0 topCapHeight:0];
        UIImageView* shadowImageView = [[[UIImageView alloc] initWithFrame:sideSwipeView.frame] autorelease];
        shadowImageView.alpha = 0.6;
        shadowImageView.image = shadow;
        shadowImageView.autoresizingMask = UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleLeftMargin | UIViewAutoresizingFlexibleBottomMargin | UIViewAutoresizingFlexibleTopMargin | UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
        [self.sideSwipeView addSubview:shadowImageView];

        // Iterate through the button data and create a button for each entry
        CGFloat leftEdge = BUTTON_LEFT_MARGIN;
        for (NSDictionary* buttonInfo in buttonData)
        {
            // Create the button
            UIButton* button = [UIButton buttonWithType:UIButtonTypeCustom];

            // Make sure the button ends up in the right place when the cell is resized
            button.autoresizingMask = UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleLeftMargin | UIViewAutoresizingFlexibleBottomMargin | UIViewAutoresizingFlexibleTopMargin;

            // Get the button image
            UIImage* buttonImage = [UIImage imageNamed:[buttonInfo objectForKey:@"image"]];

            // Set the button's frame
            button.frame = CGRectMake(leftEdge, sideSwipeView.center.y - buttonImage.size.height/2.0, buttonImage.size.width, buttonImage.size.height);

            // Add the image as the button's background image
            // [button setBackgroundImage:buttonImage forState:UIControlStateNormal];
            UIImage* grayImage = [self imageFilledWith:[UIColor colorWithWhite:0.0 alpha:1.0] using:buttonImage];
            [button setImage:grayImage forState:UIControlStateNormal];

            // Add a touch up inside action
            [button addTarget:self action:@selector(touchUpInsideAction:) forControlEvents:UIControlEventTouchUpInside];

            // Keep track of the buttons so we know the proper text to display in the touch up inside action
            [buttons addObject:button];

            // Add the button to the side swipe view
            [self.sideSwipeView addSubview:button];

            // Move the left edge in prepartion for the next button
            leftEdge = leftEdge + buttonImage.size.width + BUTTON_SPACING;
        }
    }

#pragma mark Generate TableView
- (UITableViewCell *)tableView:(UITableView *)theTableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    static NSString *cellId = @"Cell";
    UILabel *itemName;

    SideSwipeTableViewCell *cell = (SideSwipeTableViewCell*)[theTableView dequeueReusableCellWithIdentifier:cellId];
    if (cell == nil)
    {
        cell = [[[SideSwipeTableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellId] autorelease];
        CGRect frame = {{cell.indentationWidth, 0}, { 280.0 , cell.frame.size.height}};
        itemName = [[[UILabel alloc] initWithFrame:frame] autorelease];
        [[cell contentView] addSubview:itemName];
        //  [itemName setTag:1001];
        [itemName setBackgroundColor:[UIColor clearColor]];

        cell.textLabel.backgroundColor = [UIColor clearColor];
        cell.detailTextLabel.backgroundColor = [UIColor clearColor];

        cell.textLabel.font = [UIFont fontWithName:@"Futura-Medium" size:18];
        cell.detailTextLabel.font = [UIFont fontWithName:@"Futura-Medium" size:13];
    } else {
        itemName = (UILabel *)[cell viewWithTag:1001];
    }

    // Configure cell

    // Sets the text for the cell
    NSDictionary *dictItem = [allItems objectAtIndex:indexPath.row];
    NSString *name = (NSString *)[dictItem objectForKey:@"name"];
    //NSString *url = (NSString *)[dictItem objectForKey:@"redirect_url"];

    NSDictionary *dictItemResults = [self.searchResults objectAtIndex:indexPath.row];
    NSString *nameResults = (NSString *)[dictItemResults objectForKey:@"name"];
    //NSString *urlResults = (NSString *)[dictItemResults objectForKey:@"redirect_url"];

    if ([table isEqual:self.searchDisplayController.searchResultsTableView]){
        cell.textLabel.text = [NSString stringWithFormat:@"%@", nameResults];
    }
    else{
        cell.textLabel.text = [NSString stringWithFormat:@"%@", name];
    }

    cell.supressDeleteButton = ![self gestureRecognizersSupported];

    cell.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"cell_background_viewcontroller.png"]];
    tableView.separatorStyle = UITableViewCellSeparatorStyleSingleLine;
    tableView.separatorColor = [UIColor grayColor];

    return cell;

}

- (void)filterContentForSearchText:(NSString*)searchText
                             scope:(NSString*)scope
{
    NSPredicate *resultPredicate = [NSPredicate
                                    predicateWithFormat:@"SELF contains[cd] %@",
                                    searchText];

    self.searchResults = [allItems filteredArrayUsingPredicate:resultPredicate];
}

#pragma mark - UISearchDisplayController delegate methods
-(BOOL)searchDisplayController:(UISearchDisplayController *)controller
shouldReloadTableForSearchString:(NSString *)searchString
{
    [self filterContentForSearchText:searchString
                               scope:[[self.searchDisplayController.searchBar scopeButtonTitles]
                                      objectAtIndex:[self.searchDisplayController.searchBar
                                                     selectedScopeButtonIndex]]];

    return YES;
}

- (BOOL)searchDisplayController:(UISearchDisplayController *)controller
shouldReloadTableForSearchScope:(NSInteger)searchOption
{
    [self filterContentForSearchText:[self.searchDisplayController.searchBar text]
                               scope:[[self.searchDisplayController.searchBar scopeButtonTitles]
                                      objectAtIndex:searchOption]];

    return YES;
}

- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {

    // If row is deleted, remove it from the list.
    /*   if (editingStyle == UITableViewCellEditingStyleDelete)
     {
     // delete your data item here
     // Animate the deletion from the table.
     [self.table deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
     } */
}

#pragma mark Generate images with given fill color
// Convert the image's fill color to the passed in color
-(UIImage*) imageFilledWith:(UIColor*)color using:(UIImage*)startImage
{
    // Create the proper sized rect
    CGRect imageRect = CGRectMake(0, 0, CGImageGetWidth(startImage.CGImage), CGImageGetHeight(startImage.CGImage));

    // Create a new bitmap context
    CGContextRef context = CGBitmapContextCreate(NULL, imageRect.size.width, imageRect.size.height, 8, 0, CGImageGetColorSpace(startImage.CGImage), kCGImageAlphaPremultipliedLast);

    // Use the passed in image as a clipping mask
    CGContextClipToMask(context, imageRect, startImage.CGImage);
    // Set the fill color
    CGContextSetFillColorWithColor(context, color.CGColor);
    // Fill with color
    CGContextFillRect(context, imageRect);

    // Generate a new image
    CGImageRef newCGImage = CGBitmapContextCreateImage(context);
    UIImage* newImage = [UIImage imageWithCGImage:newCGImage scale:startImage.scale orientation:startImage.imageOrientation];

    // Cleanup
    CGContextRelease(context);
    CGImageRelease(newCGImage);

    return newImage;
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)dealloc {
    [searchResultsController release];
    [searchBarController release];
    [buttonData release];
    [allItems release];
    [super dealloc];
}
- (void)viewDidUnload {
    [self setSearchResultsController:nil];
    [self setSearchBarController:nil];
    [super viewDidUnload];
}
@end 
```

这也可能对您有用：

```
*** Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[__NSArrayI objectAtIndex:]: index 0 beyond bounds for empty array'
*** First throw call stack:
(0x392502a3 0x3313f97f 0x3919ae8d 0xe2869 0x323cd545 0x323b230b 0x324cb1b9 0x324eb783 0x3244fd3d 0x324e8ff9 0x324e093b 0x324e08f7 0x32472487 0x324aa22d 0x324a9abd 0x391a1037 0x33fa4d91 0x34efc1b5 0x350ced3b 0x350d0ed3 0x350d0ded 0x350d0ccf 0x350c64ad 0x350d0c0d 0x350d091f 0x350d03af 0x350d0207 0x350d00e5 0x34e9978d 0x34e99105 0x34e98d5f 0x34e98d21 0x34e98c53 0x35050ce7 0x350cfefb 0x350cfe2d 0x39787689 0x350c51db 0x397ad5ef 0x324e5039 0x324e4ff1 0x324b2149 0x324b0041 0x324af8af 0x324ae3a5 0x324ad72f 0x323955f1 0x32382801 0x3238211b 0x375655a3 0x375651d3 0x39225173 0x39225117 0x39223f99 0x39196ebd 0x39196d49 0x375642eb 0x323d62f9 0x9dde7 0x9b4d8)
libc++abi.dylib: terminate called throwing an exception 
```

我将如何解决这个问题？我希望我已经提供了足够的信息。任何帮助表示赞赏。提前致谢。

**更新：**

如果我在 NSArray 中填充一个`SearchViewController.m`，...

```
_cloud = [[NSMutableArray alloc] initWithObjects:@"The quick brown fox jumped over the lazy dog", @"foo", @"bar", @"Cookies", @"1234567890", nil]; 
```

...我得到一个不同的错误：

```
 -[__NSCFConstantString objectForKey:]: unrecognized selector sent to instance 0x1659d4
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFConstantString objectForKey:]: unrecognized selector sent to instance 0x1659d4'
*** First throw call stack:
(0x392502a3 0x3313f97f 0x39253e07 0x39252531 0x391a9f68 0xac743 0x323cd545 0x323b230b 0x324cb1b9 0x324eb783 0x3244fd3d 0x324e8ff9 0x324e093b 0x324e08f7 0x32472487 0x324aa22d 0x324a9abd 0x391a1037 0x33fa4d91 0x34efc1b5 0x350ced3b 0x350d0ed3 0x350d0ded 0x350d0ccf 0x350c64ad 0x350d0c0d 0x350d091f 0x350d03af 0x350d0207 0x350d00e5 0x34e9978d 0x34e99105 0x34e98d5f 0x34e98d21 0x34e98c53 0x35050ce7 0x350cfefb 0x350cfe2d 0x39787689 0x350c51db 0x397ad5ef 0x324e5039 0x324e4ff1 0x324b2149 0x324b0041 0x324af8af 0x324ae3a5 0x324ad72f 0x323955f1 0x32382801 0x3238211b 0x375655a3 0x375651d3 0x39225173 0x39225117 0x39223f99 0x39196ebd 0x39196d49 0x375642eb 0x323d62f9 0x67c9f 0x65390)
libc++abi.dylib: terminate called throwing an exception 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:20:22.607

```
[_cloudItems release];

// Show buttons when side is swiped

[[NSArray arrayWithObjects:
              [NSDictionary dictionaryWithObjectsAndKeys:@"Reply", @"title", @"reply.png", @"image", nil],
              [NSDictionary dictionaryWithObjectsAndKeys:@"Retweet", @"title", @"retweet-outline-button-item.png", @"image", nil],
              [NSDictionary dictionaryWithObjectsAndKeys:@"Favorite", @"title", @"star-hollow.png", @"image", nil],
              [NSDictionary dictionaryWithObjectsAndKeys:@"Profile", @"title", @"person.png", @"image", nil],
              [NSDictionary dictionaryWithObjectsAndKeys:@"Links", @"title", @"paperclip.png", @"image", nil],
              [NSDictionary dictionaryWithObjectsAndKeys:@"Action", @"title", @"action.png", @"image", nil],
               nil] retain]; 
```

似乎这是罪魁祸首。为什么要在 viewDidLoad 上释放该数组？看起来应该是这样的：

`_cloudItems = [[NSArray alloc] initWithObjects:[<dictionaries go here>]];`

不要为此将retain放在最后，alloc会保留它。

希望这可以帮助。

# c# - DropDownList 重复项

> ID：13767732
> 
> 赞同：1
> 
> 时间：2012-12-07T17:08:56.467
> 
> 标签：c#, asp.net

嗨，我正在尝试将数据重新绑定到`DataList`从中获取数据的数据，`SqlDataSource`但我不断收到重复的项目。这是我的代码：

```
<asp:SqlDataSource ID="CategoryDataSource" runat="server" 
    ConnectionString="Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\ASPNETDB.MDF;Integrated Security=True;User Instance=True" 
    ProviderName="System.Data.SqlClient" SelectCommand="SELECT [CategoryName] FROM [forum_categories]">
</asp:SqlDataSource>

protected void Button6_Click( object sender , EventArgs e )
{
    string categoryToCreate = CreateCategory.Text;

    if(categoryToCreate != string.Empty)
    {
        CategoryCreateName.Visible = false;
        DataAccess.insertDataItem(categoryToCreate);
        CategoryList.DataBind(); 
    }
    else
    {
        CategoryCreateName.Visible = true;
    }
} 
```

insertDataItem将一个新*类别*插入到数据库中。

如何更新中的项目，`DropDownList`以免我得到重复的项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:22:15.943

尝试这个：

```
 protected void Button6_Click( object sender , EventArgs e )
{
    string categoryToCreate = CreateCategory.Text;

    if(categoryToCreate != string.Empty)
    {
        CategoryCreateName.Visible = false;
        DataAccess.insertDataItem(categoryToCreate);
        CategoryList.Items.Clear();
        CategoryList.DataBind(); 
    }else
    {
        CategoryCreateName.Visible = true;
    }
} 
```

# scala - 如何隐式使用方法名称来查找到类型的转换？

> ID：13767734
> 
> 赞同：2
> 
> 时间：2012-12-07T17:08:57.000
> 
> 标签：scala, implicit-conversion

[在这里](https://stackoverflow.com/questions/3855595/scala-identifier-implicitly)的另一个答案中，他们给出了以下代码示例：

```
scala> implicitly[Int => { def min(i: Int): Any }]
res22: (Int) => AnyRef{def min(i: Int): Any} = <function1> 
```

这在我的 scala 控制台（2.10.0-RC2）中不起作用。

```
scala> implicitly[Int => { def min(i: Int): Any }]
<console>:8: error: No implicit view available from Int => AnyRef{def min(i: Int): Any}.
          implicitly[Int => { def min(i: Int): Any }]
                    ^
scala> 12 min 11
res15: Int = 11 
```

新的方法是什么？无论如何，这种语法是什么意思？我不熟悉它 - 特别是 part `{ def min(i: Int): Any }`，用作类型表达式。这是定义某种匿名类型吗？

我想这样做是因为当我在代码中看到隐式转换并且不知道它是从哪里导入时，我想追踪它。例如，前几天我看到一些调用`format`a 的代码`java.util.Date`，它没有`format`. 我不知道转换中拉入了哪个进口。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T17:31:52.947

你不会找到`min`，因为`RichInt`现在是一个值类（它不适用于结构类型——它必须是一个`AnyRef`）。

但该策略将在其他情况下起作用：

```
scala> implicitly[Option[Int] => { def iterator: Iterator[Int] }]
res29: Option[Int] => AnyRef{def iterator: Iterator[Int]} = <function1> 
```

所以同样的技巧也能奏效，只是不适用于值类。请尝试使用 IDE。

# django - django-tastypie：通过关系发布到具有多对多字段的资源

> ID：13767740
> 
> 赞同：5
> 
> 时间：2012-12-07T17:09:24.360
> 
> 标签：django, tastypie

我正在为一个项目开发一个 API，并且我通过 OrderProducts 与 Order/Products 建立了关系，如下所示：

在模型.py

```
class Product(models.Model):
    ...

class Order(models.Model):
    products = models.ManyToManyField(Product, verbose_name='Products', through='OrderProducts')
    ...

class OrderProducts(models.Model):
    order = models.ForeignKey(Order)
    product = models.ForeignKey(Product)
    ... 
```

现在，当我通过 API 加载订单时，我也想获得相关的产品，所以我尝试了这个（使用 django-tastypie）：

按顺序/api.py

```
class OrderResource(ModelResource):
    products = fields.ToManyField('order.api.ProductResource', products, full=True)

    class Meta:
        queryset = Order.objects.all()
        resource_name = 'order' 
```

一切都适用于列出订单资源。我得到嵌入了产品数据的订单资源。

问题是我无法使用 api 创建或编辑 Order 对象。由于我在多对多关系中使用直通模型，因此 ManyToManyField(products) 没有 .add() 方法。但是，当向 OrderResource 中的 products 字段发布/放置数据时，tastepie 会尝试调用 .add() 。

```
{"error_message": "'ManyRelatedManager' object has no attribute 'add'", "traceback": "Traceback (most recent call last):\n\n  File \"/Library/Python/2.7/site-packages/tastypie/resources.py\", line 192, in wrapper\n    response = callback(request, *args, **kwargs)\n\n  File \"/Library/Python/2.7/site-packages/tastypie/resources.py\", line 397, in dispatch_list\n    return self.dispatch('list', request, **kwargs)\n\n  File \"/Library/Python/2.7/site-packages/tastypie/resources.py\", line 427, in dispatch\n    response = method(request, **kwargs)\n\n  File \"/Library/Python/2.7/site-packages/tastypie/resources.py\", line 1165, in post_list\n    updated_bundle = self.obj_create(bundle, request=request, **self.remove_api_resource_names(kwargs))\n\n  File \"/Library/Python/2.7/site-packages/tastypie/resources.py\", line 1784, in obj_create\n    self.save_m2m(m2m_bundle)\n\n  File \"/Library/Python/2.7/site-packages/tastypie/resources.py\", line 1954, in save_m2m\n    related_mngr.add(*related_objs)\n\nAttributeError: 'ManyRelatedManager' object has no attribute 'add'\n"} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-14T20:10:16.767

由于您只需要 manytomany 字段**来列出**，因此更好的解决方案是添加`readonly=True`on字段。这消除了覆盖方法的需要。为了完整性：`OrderResource``products``save_m2m`

```
class OrderResource(ModelResource):
    products = fields.ToManyField('order.api.ProductResource', products, 
                                  readonly=True, full=True)

    class Meta:
        queryset = Order.objects.all()
        resource_name = 'order' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T09:04:49.947

解决方案在于覆盖资源上的 save_m2m() 方法。在我的情况下，我需要 manytomany 字段仅用于列出，因此重写了 save_m2m() 方法以不做任何事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-20T06:22:02.993

如果您被允许修改`class OrderProducts`，添加`auto_created = True`可能会解决您的问题，即

```
class OrderProducts(models.Model): 
    class Meta:
        auto_created = True 
```

如果您无法更改`class OrderProducts`，请尝试以下美味派补丁。

```
---------------------------- tastypie/resources.py ----------------------------
index 2cd869e..aadf874 100644
@@ -2383,7 +2383,20 @@ class BaseModelResource(Resource):
                     related_resource.save(updated_related_bundle)
                 related_objs.append(updated_related_bundle.obj)

-            related_mngr.add(*related_objs)
+            if hasattr(related_mngr, 'through'):
+                through = getattr(related_mngr, 'through')
+                if not through._meta.auto_created:
+                    for related_obj in related_objs:
+                        args = dict()
+                        args[related_mngr.source_field_name] = bundle.obj
+                        args[related_mngr.target_field_name] = related_obj
+                        through_obj = through(**args)
+                        through_obj.save()
+                else:
+                    related_mngr.add(*related_objs)
+            else:
+                related_mngr.add(*related_objs)

     def detail_uri_kwargs(self, bundle_or_obj):
         """ 
```

在 Django 1.7 中，错误消息更改为“无法在指定中间模型的 ManyToManyField 上设置值”。解决方法是一样的。

# c# - 在 C# 中构造唯一对象列表的最佳方法

> ID：13767741
> 
> 赞同：5
> 
> 时间：2012-12-07T17:09:25.987
> 
> 标签：c#, performance, generic-list

我想知道遵循一种模式或另一种模式在 C# 中构造唯一的对象列表是否会更快：

选项1

*   将所有项目添加到通用列表中
*   调用 list.Distinct 函数就可以了

选项 2

*   遍历每个项目
*   检查该项目是否已存在于列表中，如果不存在则添加它

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-07T17:13:07.173

您可以使用[`HashSet<T>`](http://msdn.microsoft.com/en-us/library/bb359438.aspx)：

> HashSet 类提供高性能的集合操作。集合是不包含重复元素且其元素没有特定顺序的集合。

您可以[`IEqualityComparer<T>`](http://msdn.microsoft.com/en-us/library/bb359100.aspx)通过构造函数提供自定义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T17:16:52.250

这是“我应该用鞋子还是砖头把钉子钉进木头”的问题之一。您应该为作业使用适当的数据结构，根据您“构建唯一的对象列表”的要求，[`HashSet<T>`](http://msdn.microsoft.com/en-us/library/bb359438.aspx)该类满足。

如果您需要列表格式的项目，您可以随时致电`ToList()`集合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T17:11:46.027

如果您担心查找独特项目的性能，请使用[`Dictionary<TKey, TVale>`](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx). 此外，字典需要唯一的键，所以你永远不会有重复。

# sql - 对话框窗体关闭时如何刷新 DataGridView

> ID：13767743
> 
> 赞同：0
> 
> 时间：2012-12-07T17:09:31.493
> 
> 标签：sql, vb.net, sql-server-2005, datagridview

当我使用对话框表单添加新记录时，我正在尝试刷新 datagirdview。我想知道如何刷新我的datagirdview。我有两个获胜表格。**表单 A**称为**FrmContactDetailList**，它有一个 datagridview，我正在显示来自 sql server 的数据。下面的第一个代码块用于将数据绑定到网格。这是在表单加载事件中给出的，在这个表单中我有一个名为“添加新记录”的按钮。一旦我按下此按钮，它就会打开一个正在打开另一个表单的获胜表单。下面是我用来通过按钮单击事件打开它的代码。

这将打开**Form B**。表单称为**FrmClientDetails**。此表单将有一个文本框和一个保存按钮。因此，一旦我在文本框中输入新名称并按保存，我希望更新 Form A 中的 datagirdview。并在我关闭表格 B 后显示新记录。我该如何实现这一点。

此代码用于绑定 datagridview。我已经给出了这是表单加载事件。

```
 Sub GetContactList()
        Dim BindData As New VoucherClass
        Dim dt As DataTable = BindData .Get_Client_List
        DataGridView.DataSource = dt 
 End Sub

 Private Sub FrmContactDetailsList_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        GetContactList()
 End Sub 
```

我已使用此代码打开对话框表单以输入新数据。

```
 Private Sub BtnOpen_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnOpen.Click
        Dim FrmNewContact As New FrmClientDetails
        FrmNewContact.Owner = Me
        FrmNewContact.ShowDialog()
    End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-04T03:52:55.057

试试这个：`FrmNewContact.ShowDialog()`
`If FrmNewContact.ShowDialog() = DialogResult.OK Then`
`Me.DataFridView.Refresh()`
`End IF`
你可能需要在模态的关闭操作中为对话框结果包含一个设置器，而不是。
`Me.DialogResult = DialogResult.OK`
`Me.Close()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:35:24.913

当绑定数据更改时，它会自动反映到绑定的数据网格视图中。

编辑：

处理 FrmNewContact 的 Closing 事件。您可以在该子中刷新您的 datagridview。

```
Dim WithEvents dialog As New FrmNewContact
Sub done() Handles dialog.FormClosed
    Me.DataGridView1.Refresh()
End Sub 
```

下一次编辑：

```
Dim BindData As New VoucherClass
Dim dt As DataTable = BindData .Get_Client_List 
```

在 sub 之外声明它们。所以你应该有这个：

```
Dim BindData as VoucherClass
Dim dt as DataTable

Sub GetContactList()
        BindData = New VoucherClass
        dt = BindData .Get_Client_List
        DataGridView.DataSource = dt
End Sub 
```

# c++ - 检测和调整负零

> ID：13767744
> 
> 赞同：9
> 
> 时间：2012-12-07T17:09:40.507
> 
> 标签：c++, algorithm, negative-number

我有一些从 Java 移植到 C++ 的代码

```
// since this point is a vector from (0,0,0), we can just take the
// dot product and compare
double r = point.dot(normal);
return (r>=0.0); 
```

但在 C++`r`中，可以是`+0.0`or `-0.0`，当`r`等于`-0.0`时，检查失败。

我试图在下面的代码中调整负零，但它从未到达 DEBUG("Negative zero") 行。但是`r2`打印出来等于`+0.0`.

```
// since this point is a vector from (0,0,0), we can just take the
// dot product and compare
double r = point.dot(normal);
if (std::signbit(r)){
    double r2 = r*-1;
    DEBUG("r=%f r=%f", r,r2);
    if (r2==0.0) {
        DEBUG("Negative zero");
        r = 0.0; //Handle negative zero
    }
}
return (r>=0.0); 
```

有什么建议吗？

测试代码：

```
DEBUG("point=%s", point.toString().c_str());
DEBUG("normal=%s", normal->toString().c_str());
double r = point.dot(normal);
DEBUG("r=%f", r);
bool b = (r>=0.0);
DEBUG("b=%u", b); 
```

测试结果：

```
DEBUG - point=Vector3D[ x=1,y=0,z=0 ]
DEBUG - normal=Vector3D[ x=0,y=-0.0348995,z=0.0348782 ]
DEBUG - r=0.000000
DEBUG - b=1
DEBUG - point=Vector3D[ x=1,y=0,z=0 ]
DEBUG - normal=Vector3D[ x=-2.78269e-07,y=0.0174577,z=-0.0174391 ]
DEBUG - r=-0.000000
DEBUG - b=0 
```

海合会：

```
Target: x86_64-linux-gnu
--enable-languages=c,c++,fortran,objc,obj-c++ 
--prefix=/usr 
--program-suffix=-4.6 
--enable-shared 
--enable-linker-build-id 
--with-system-zlib 
--libexecdir=/usr/lib 
--without-included-gettext 
--enable-threads=posix 
--with-gxx-include-dir=/usr/include/c++/4.6 
--libdir=/usr/lib 
--enable-nls 
--with-sysroot=/ 
--enable-clocale=gnu 
--enable-libstdcxx-debug 
--enable-libstdcxx-time=yes 
--enable-gnu-unique-object 
--enable-plugin 
--enable-objc-gc 
--disable-werror 
--with-arch-32=i686 
--with-tune=generic 
--enable-checking=release 
--build=x86_64-linux-gnu 
--host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu5) 
```

旗帜：

```
CXXFLAGS += -g -Wall -fPIC 
```

回答：

我已经使用@amit 的答案来执行以下操作。

```
return (r>=(0.0-std::numeric_limits<double>::epsilon())); 
```

这似乎有效。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-07T17:12:09.200

好吧，使用`double`s 时的一般建议是记住它们并不准确。因此，如果平等很重要 - 通常建议使用一些容差因子。

在你的情况下：

```
if (|r - 0.0| >= EPSILON) 
```

`EPSILON`您的公差因子在哪里，如果`r`不是 0.0，将产生 true，至少有`EPSILON`间隔。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-07T17:50:54.497

在某些较旧的系统（即 IEE754 之前）上，您可能会发现针对 0 的相等检查因负 0 失败：

```
if (a == 0.0) // when a==-0.0, fails 
```

您可以通过在比较之前将 0.0 添加到值来解决此问题：

```
if ((a+0.0) == 0.0) // when a == -0.0, succeeds 
```

* * *

但是，我要提醒的是，真正需要这样做的硬件/软件组合是*非常*不寻常的。我最后一次必须这样做是在 Control Data 大型机上。即使在那里，它也只是在一些不寻常的情况下出现：Fortran 编译器允许生成负零，并且知道在比较中补偿它们。作为计算的一部分，Pascal 编译器生成了将负零转换为正常零的代码。

因此，如果您在 Fortran 中编写了一个例程并从 Pascal 中调用它，您可能会遇到这个问题，并通过在进行比较之前添加 0.0 来防止它如上所述。

不过，我很有可能您的问题并不是真正源于与负零的比较。我所知道的所有相当现代的硬件都会完全自动处理这个问题，所以软件根本不需要考虑它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-08-17T13:40:18.560

OP`std::signbit`在他的问题中提到，但它应该在一个可以快速找到的答案中，所以这里是：

这从 C++11 开始就可以区分`-0.0`和`+0.0`：

```
#include <cmath>
std::signbit(x) // true iif sign bit of x is set i.e. x is negative 
```

[cppreference 上的 std::signbit](https://en.cppreference.com/w/cpp/numeric/math/signbit)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-07T17:13:50.550

大概你的意思是`if (r2==-0.0)`. 尽管如此，负 0 和正 0 将比较相等。出于所有意图和目的，两者之间没有区别。对于负 0，您可能不需要特殊情况。对于负 0或正 0，您的比较`r >= 0` [*应该*为真。](http://ideone.com/8YbxY7)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-07T17:56:13.243

考虑：

```
#include <stdio.h>
#include <iostream>
using namespace std;

int main()
{
    double const x = -2.78269e-07;

    printf( "printf: x=%f\n", x );
    cout << "cout: x=" << x << endl;
} 
```

结果（使用 Visual C++ 11.0）：

```
[D:\开发\测试]
> *cl foo.cpp*
foo.cpp

[D:\开发\测试]
>*富*
printf: x=-0.000000
cout: x=-2.78269e-007

[D:\开发\测试]
> _

```

这似乎与问题中的神秘结果非常相似。

我认为它像问题的结果一样嘎嘎作响，看起来像问题的结果，像问题的结果*一样*摇摆不定。

所以，我相信未显示的计算代码产生了 value `2.78269e-007`。

* * *

因此，总而言之，显然只有所描述的行为，即“负零”比较不等于零，这是非标准的。实际上，显然没有负零，只有*一个非常小的负值*。对于给定的输出格式，它显示为前面带减号的全零数字。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-19T09:10:03.323

这只是一个很小的负数，控制台无法为您打印它
您可以尝试根据您的精度检查它，以便您可以用**纯零**替换它。

```
std::cout << std::setprecision(7) << (abs(value) < 0.0000005f ? 0 : value); 
```

**请注意**我是如何将 7 个位置添加到我指定的浮动精度中的`std::setprecision()`。

这取决于您想要打印浮点数/双精度的准确度。

# jquery - Jquery $('.class').live('click',...) - 找不到具有相同类名的多个 gridview 列

> ID：13767745
> 
> 赞同：2
> 
> 时间：2012-12-07T17:09:40.447
> 
> 标签：jquery, asp.net, vb.net

我有一个 .aspx 页面（vb.net 后端），我正在向其中添加 jQuery 函数以减少回发。该页面有大约十几个绑定到数据的网格视图，并且有 5 个没有的模板化字段（每行 1 个复选框和 4 个单选按钮）。

我想要完成的是处理模板列更改的 jquery 功能。我的 jquery 工作得很好，但前提是我正在使用一个 gridview。正如我之前所说，该页面总共有大约 12 个网格视图，所有格式都相同，因此需要 jquery 来进行相同的操作。（一种选择是复制我所拥有的 12 次 :(...)

我想如果我能让这对十二个中的两个起作用，那么我就可以了，但我想不通。我对 jquery 很陌生，我所做的工作要感谢这些留言板和其他留言板。经过大量搜索，使用'.class'似乎是我想要完成的答案，但它没有像我预期的那样工作。

我已经获取了 html 以及我想要开始工作的 jquery 并将其加载到[jsFiddler](http://jsfiddle.net/jkmurphy1/68Mpy/)

有人可以看一下并帮助我为我的“.class”工作获得“警报”吗？如果我能做到这一点，我想我可能能够处理我需要的 jquery 的其余部分。

前两个按预期工作。最后一个仅适用于“rbAllNA”类的第一项：

```
$(document).ready(function() {
$(rbAllNA1).live('click', function() {
    alert($(this).attr('class'));
});
$(rbAllNA2).live('click', function() {
    alert($(this).attr('class'));
});

$(".rbAllNA").live('click', function() {
    alert("call from class");
});
}); 
```

有关完整方案，请参阅[http://jsfiddle.net/jkmurphy1/68Mpy/1/ 。](http://jsfiddle.net/jkmurphy1/68Mpy/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:22:55.193

第一个输入元素具有类“rbAllNA”，实时语句有效。第二个有'rbAllNa'（即小写字母a作为最后一个字母）。将其更改为大写“A”，它适用于您的 jsfiddle 示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:23:03.920

你的代码的问题是

在**第一张表中**-`class="rbAllNA"`

在**第二个表中**- `class="rbAllNa"` **<--** `a should have been uppercase`

您的选择器是`$(".rbAllNA")`

**HTML属性区分大小写**..所以后者不起作用..

**[检查小提琴](http://jsfiddle.net/sushanth009/68Mpy/2/)**

`.live()`自 ..起已被弃用。使用代替`1.7.0`附加事件。`.on()`

# neo4j - 在 Neo4j Cypher 查询中仅返回简单路径

> ID：13767748
> 
> 赞同：15
> 
> 时间：2012-12-07T17:09:46.483
> 
> 标签：neo4j, traversal, cypher

给定如下查询：

```
START n = node(123)
MATCH p = n-[r:LIKES*..3]->x
RETURN p; 
```

我通过上面的查询获得的结果路径包含循环。

我怎样才能只返回简单的路径？

给定这个[例子](http://tinyurl.com/cymx37g)：

*   如何避免具有重复节点的路径，例如：[Neo，Morpheus，Trinity，Morpheus，Neo]

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-19T09:15:38.823

指定路径的唯一性是 cypher 的计划功能。

所以现在我们必须确定路径中没有节点是重复的。

有一个`ALL`谓词必须适用于集合的所有元素（路径是）。并且`filter`您可以提取集合的元素，因为某个条件成立。

```
START neo=node(1) 
MATCH path= neo-[r:KNOWS*..4]->other 
WHERE ALL(n in nodes(path) where 
          1=length(filter(m in nodes(path) : m=n))) 
RETURN neo, LENGTH(path) AS length, EXTRACT(p in NODES(path) : p.name), other 
ORDER BY length 
```

所以我所做的是：

*   对于路径的所有节点`n`
*   过滤等于的节点的路径`n`
*   确定该`length`集合的
*   断言`ALL`它必须为每个`n`

见：[http ://console.neo4j.org/r/dpalbl](http://console.neo4j.org/r/dpalbl)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T13:09:22.983

我的解决方法：

```
START n = node(123), x=node(*)
MATCH p = shortestPath(n-[r:LIKES*..3]->x)
RETURN p; 
```

查看[控制台中的示例](http://console.neo4j.org/r/jvc3a6)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-03T01:44:42.467

在 2.3.0 中，使用以下内容：

```
MATCH path = (start {id:2})<-[*1..]-(end {id:3}) 
WHERE ALL(n in nodes(path) where 
          1 = size(filter(m in nodes(path) where m=n))) 
RETURN start, LENGTH(path) AS length, EXTRACT(p in NODES(path) | p.id), end
ORDER BY length 
```

# php - GROUP_BY 仅在值等于时显示第一次出现

> ID：13767749
> 
> 赞同：1
> 
> 时间：2012-12-07T17:09:50.680
> 
> 标签：php, mysql, sql, database

我有一个名为 questions 的表格，其中包含以下行：

```
questions.id | questions.target_username
   1         | every.one
   2         | every.one 
```

我还有带有以下行的答案表：

```
answers.id | answers.username       
   1       | guy
   1       | maricela 
   2       | mikha 
```

如您所见，相同的问题 id 可能有来自不同用户的答案。如果出现以下情况，我只想选择行：

a) 问题的答案不包括 (mikha) 作为 answers.username 并且在这种情况下仅显示一次问题 ID

b）问题的答案用户名（mikha）为answers.username。

我使用以下查询：

```
SELECT questions.id, answers.username
FROM questions
LEFT JOIN answers ON ( questions.id = answers.id ) 
WHERE questions.target_username =  'every.one'
AND (
answers.username IS NOT NULL 
OR answers.username =  'mikha'
)
GROUP BY questions.id, answers.username 
```

我期望的结果：

```
questions.id | answers.usernme
   1         |  
   2         | mikha 
```

我实际得到的：

```
questions.id | answers.usernme
   1         | guy
   1         | maricela  
   2         | mikha 
```

提前致谢 问候米迦勒

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:58:04.727

您只需要将`answers.username = 'mikha'`条件移至 on 子句，此时您甚至可以删除多余的 where 条件。

```
SELECT questions.id, answers.username
FROM questions
LEFT JOIN answers ON(questions.id = answers.id AND answers.username = 'mikha')
WHERE questions.target_username = 'every.one'
GROUP BY questions.id, answers.username; 
```

编辑：我不确定这是否是一项要求，但如果您想省略尚未有人回答的问题，以下是您想要的：

```
SELECT questions.id, answers.username
FROM questions
LEFT JOIN answers ON(questions.id = answers.id AND answers.username = 'mikha')
LEFT JOIN answers others ON(questions.id = others.id AND others.username <> 'mikha')
WHERE questions.target_username = 'every.one'
AND (
    (
        answers.id IS NOT NULL
        AND others.id IS NULL
    )
    OR (
        answers.id IS NULL
        AND others.id IS NOT NULL
    )
)
GROUP BY questions.id, answers.username; 
```

编辑 2：这是我的测试表中的内容，以及查询 #2 的结果：

```
SELECT * FROM questions;
+----+-----------------+
| id | target_username |
+----+-----------------+
|  1 | every.one       |
|  2 | every.one       |
|  3 | every.one       |
|  4 | every.one       |
+----+-----------------+
4 rows in set (0.00 sec)

SELECT * FROM answers;
+-----+----+----------+
| ida | id | username |
+-----+----+----------+
|   1 |  1 | guy      |
|   2 |  1 | maricela |
|   3 |  2 | mikha    |
+-----+----+----------+
3 rows in set (0.00 sec)

(Run query #2 above)
+----+----------+
| id | username |
+----+----------+
|  1 | NULL     |
|  2 | mikha    |
+----+----------+
2 rows in set (0.00 sec) 
```

编辑 3：这是更新的表数据和符合您在评论中添加的条件的更新查询：

```
SELECT * FROM questions;
+----+-----------------+
| id | target_username |
+----+-----------------+
|  1 | every.one       |
|  2 | every.one       |
|  3 | every.one       |
|  4 | every.one       |
+----+-----------------+
4 rows in set (0.00 sec)

SELECT * FROM answers;
+-----+----+----------+
| ida | id | username |
+-----+----+----------+
|   1 |  1 | guy      |
|   2 |  1 | maricela |
|   3 |  2 | mikha    |
|   7 |  4 | guy      |
|   8 |  4 | mikha    |
+-----+----+----------+
5 rows in set (0.00 sec) 
```

新查询：

```
SELECT questions.id, answers.username
FROM questions
LEFT JOIN answers ON(questions.id = answers.id AND answers.username = 'mikha')
LEFT JOIN answers others ON(questions.id = others.id AND others.username <> 'mikha')
WHERE questions.target_username = 'every.one'
AND (
    answers.username = 'mikha'
    OR (
        answers.id IS NULL
        AND others.id IS NOT NULL
    )
)
GROUP BY questions.id, answers.username; 
```

结果：

```
+----+----------+
| id | username |
+----+----------+
|  1 | NULL     |
|  2 | mikha    |
|  4 | mikha    |
+----+----------+
3 rows in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:20:34.837

你必须改变你的答案表，

将 answer.Id 更改为 question.Id 并添加 answer.Id 作为主键...

你的目标不清楚，因为你期望的结果有第 2 行，mikha（你说如果用户名是 mikha，我只需要问题 ID）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T17:29:41.657

如果您只加入回答 ids 那些“mikha”的用户名，您应该会得到想要的结果。那些有答案但没有 mikhas 答案的 id 将获得空值。我不明白您需要问题表在哪里获取此信息：

```
SELECT answers.id, a2.username
FROM answers
LEFT JOIN (
   SELECT id, username
   FROM answers
   WHERE username = 'mikha'
) AS a2 ON a2.id = answers.id
GROUP BY answers.id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T17:42:29.817

你得到这个结果的原因是：

1.  `answers.username IS NOT NULL OR answers.username = 'mikha'`是一个糟糕的状态。第二种情况，`answers.username = 'mikha'`已经是其中的一种情况`answers.username IS NOT NULL`——所以它是一个毫无意义的第二个条件。
2.  `LEFT JOIN`加上这个条件，本质上就等同于`INNER JOIN`。

# c# - XNA 按字符串设置颜色

> ID：13767750
> 
> 赞同：1
> 
> 时间：2012-12-07T17:09:51.893
> 
> 标签：c#, function, xna

因此，我想创建一个函数，您可以在其中输入颜色（如白色、红色、海蓝宝石等），并将矩形的颜色设置为您输入的颜色。最好的方法是什么？

我懂了：

```
public void setVisible(GraphicsDevice gd ,SpriteBatch sb, object c) {

        rec = new Rectangle(ButtonXPosition,ButtonYPosition,ButtonWidthSize,ButtonHeightSize);
        Texture2D pixel = new Texture2D(gd, ButtonWidthSize,ButtonHeightSize);
        sb.Draw(pixel,rec,Color.c);
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T18:15:17.953

您可以通过名称检索预设颜色，并进行一些反射：

```
var prop = typeof(Color).GetProperty(nameOfColor);
if (prop != null)
    return (Color)prop.GetValue(null, null);
return default(Color); 
```

# java - Java 回声服务器

> ID：13767751
> 
> 赞同：0
> 
> 时间：2012-12-07T17:09:53.627
> 
> 标签：java, echo

大家好，我正在尝试通过 java 做一个 echo 服务器，但它不工作.. 我不知道为什么.. 但似乎服务器正在等待客户端，客户端正在等待服务器......所以他们不能互相传递信息..

这是服务器的代码

```
 ServerSocket server = null;
        try {
             server = new ServerSocket(3333);
              System.out.println("Listening on 3333");
    } catch (IOException ex) {
        System.out.println("Error can't connect to 3333");
        System.exit(1);
    }

        Socket clientSocket = null;
    try {
        clientSocket = server.accept();
    } catch (IOException ex) {
        System.out.println("Accept fail");
        System.exit(1);
    }
    PrintWriter out = null;
    try {
         out = new PrintWriter(clientSocket.getOutputStream());
    } catch (IOException ex) {
        Logger.getLogger(JavaApplication20.class.getName()).log(Level.SEVERE, null, ex);
    }
    BufferedReader br = null;
    try {
        br = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
    } catch (IOException ex) {
        Logger.getLogger(JavaApplication20.class.getName()).log(Level.SEVERE, null, ex);
    }
    BufferedReader stdIn = new BufferedReader(new InputStreamReader(System.in));

    String inputLine, outputLine;
 while(!(inputLine=br.readLine()).equals("bye"))
            {
                out.print("echo: " + inputLine);

            }
    out.close();
    br.close();
    clientSocket.close();
    server.close();
    System.out.println("Server Exited"); 
```

这是客户端的代码

```
 Socket client = null;
   try {
        client = new Socket("localhost", 3333);
        System.out.println("Connected on 3333");
    } catch (UnknownHostException ex) {
        System.out.println("Couldn't connect to the server");
        System.exit(1);
    } catch (IOException ex) {
        Logger.getLogger(KnockKnockClient.class.getName()).log(Level.SEVERE, null, ex);
    }

    PrintWriter out = null;
    BufferedReader in = null;
    BufferedReader stdIn = null;

    try {
        out = new PrintWriter(client.getOutputStream(), true);
    } catch (IOException ex) {
        Logger.getLogger(KnockKnockClient.class.getName()).log(Level.SEVERE, null, ex);
    }
    try {
        in = new BufferedReader(new InputStreamReader(client.getInputStream()));
    } catch (IOException ex) {
        Logger.getLogger(KnockKnockClient.class.getName()).log(Level.SEVERE, null, ex);
    }
    stdIn = new BufferedReader(new InputStreamReader(System.in));

    String fromServer, fromUser;

    while((fromUser=stdIn.readLine())!=null)
        {
            System.out.println("From user: "+ fromUser);

            out.print(fromUser);
            fromServer=in.readLine();
            System.out.println(fromServer);
        }

    out.close();
    stdIn.close();
    in.close();
    client.close();

    System.out.println("client Exited"); 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:21:43.247

您正在从客户端发送一些字符串（`"Hello"`例如），并且您正在尝试`readLine()`在服务器上读取它（反之亦然）。`readLine()`只会在找到 EOL 字符或输入流关闭后返回。

由于客户端不发送任何 EOL 字符，服务器无限期地等待，客户端也因为它等待来自服务器的回答。

发送`"Hello\n"`，它会更好地工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:17:29.880

在您的客户端和服务器中`out.print(fromUser);`使用后。`out.flush()`flush 将确保它正确地连接到套接字。

```
while((fromUser=stdIn.readLine())!=null)
    {
        System.out.println("From user: "+ fromUser);

        out.print(fromUser);
        out.flush();
        fromServer=in.readLine();
        System.out.println(fromServer);
    }

out.close();
stdIn.close();
in.close();
client.close(); 
```

关于flush，摘自java doc。

```
Flushes the stream. If the stream has saved any characters from the various write()      methods in a buffer, write them immediately to their intended destination. Then, if that destination is another character or byte stream, flush it. Thus one flush() invocation will flush all the buffers in a chain of Writers and OutputStreams. 

  If the intended destination of this stream is an abstraction provided by the underlying operating system, for example a file, then flushing the stream guarantees only that bytes previously written to the stream are passed to the operating system for writing; it does not guarantee that they are actually written to a physical device such as a disk drive. 
```

# java - 如何在java中动态创建列表？

> ID：13767761
> 
> 赞同：2
> 
> 时间：2012-12-07T17:10:29.650
> 
> 标签：java, arrays, list

我正在为一个类项目用java编程。在我的项目中，我有飞机、机场和乘客。

乘客目的地机场是随机创建的，但随后我必须将其添加到包含该目的地乘客的列表中。

只要从文件中读取机场，因此它们可以变化，我如何根据这些机场创建列表？

我想做的是：

```
List<Passenger> passengersToJFK = new ArrayList<Passenger>();
.
.
.

if(passenger.destination == "JFK"){
   passengersToJFK.add(passenger);
} 
```

问题是，正如我所说，机场的数量和名称可能会有所不同，那么我该如何做一个通用表达式，根据机场文件创建列表，然后根据乘客目的地机场将乘客添加到这些列表中？

我可以获得从文件中读取的机场数量并创建相同数量的列表，但是我如何为这个列表赋予不同的名称？

提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T17:13:32.883

您可以将目的地或机场与带有 , 的乘客列表之间的关联注册表保存在以`Map`乘客管理为中心的特定类中。

```
Map<String,List<Passenger>> flights = new HashMap<String,List<Passenger>>(); 
```

然后，每当您想添加新目的地时，您都会放置一个新的空列表并

```
public void addDestination(String newDestination) {
    flights.put(newDestination, new ArrayList<Passenger>());
} 
```

当您要添加乘客时，您可以根据 a 表示的目的地获取乘客列表`String`。

```
public void addPassengerToDestination(String destination, Passenger passenger) {
    if(flights.containsKey(destination))
        flights.get(destination).add(passenger);        
} 
```

我建议您更深入地研究一些特定的多用途 Java 类，例如 Lists、Maps 和 Sets。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T17:14:43.197

我可能会创建一个`Map`以机场名称为键、以`List`乘客为值的机场。

例如

```
Map<String, List<String>> airports = new HashMap<String, List<String>>();

airports.put("JFK", passengersToJFK); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T17:13:34.570

您听起来好像在原语、字符串和集合方面考虑得太多，而在对象方面考虑得不够。

Java 是一种面向对象的语言；开始考虑对象和封装。

你的`Passenger`课程有一个良好的开端。继续`Airport`。

你加`Passengers`吗`Airport`？不，我认为它们属于`Flight`.

在编写更多代码之前，请先考虑一下您的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T17:15:45.317

您不应该专注于为列表对象的实际变量提供唯一名称，而是创建一个从字符串（目的地 id）到列表（前往该目的地的乘客）的映射，并将列表动态添加到该映射，链接每个到其相关目的地的新清单。根据需要更新该地图中的列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-07T17:20:11.493

最好的方法是为所有三个创建对象。

您可能有一个如下所示的 Airport 对象：

```
    类机场{
        字符串名称；
        列出飞机飞机；
    }

```

那么你会有一架看起来像这样的飞机：

```
    类飞机{
        字符串名称；// ?? 还是bodyType？或者你需要的任何其他东西
        列出乘客乘客；
    }

```

通过这种方式，您以一种最终更容易理解和处理的方式组合您的对象。

请注意，我将省略方法，例如 Airport 可能有一个像“addAirplane”这样的方法来添加另一架飞机，而飞机对象有一个 addPassenger 方法......

# java - 如何下载 mp3 文件并在我的应用程序中播放？

> ID：13767763
> 
> 赞同：0
> 
> 时间：2012-12-07T17:10:35.453
> 
> 标签：java, file, download, mp3

有人可以告诉我或教我如何在一个文件中下载 5 个或更多 mp3 并在我的应用程序中播放它们。我已经搜索过了，但是所有人都问过这个问题，没有人能很好地解释它。我不想只下载一个 mp3，而是一个文件中的多个 mp3。这里是 main.java

```
public class StreamingMp3Player extends Activity implements OnClickListener, OnTouchListener, OnCompletionListener, OnBufferingUpdateListener{

private ImageButton buttonPlayPause;
private SeekBar seekBarProgress;
public EditText editTextSongURL;

private MediaPlayer mediaPlayer;
private int mediaFileLengthInMilliseconds; // this value contains the song duration in milliseconds. Look at getDuration() method in MediaPlayer class

private final Handler handler = new Handler();

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    initView();
}

/** This method initialise all the views in project*/
private void initView() {
    buttonPlayPause = (ImageButton)findViewById(R.id.ButtonTestPlayPause);
    buttonPlayPause.setOnClickListener(this);

    seekBarProgress = (SeekBar)findViewById(R.id.SeekBarTestPlay);  
    seekBarProgress.setMax(99); // It means 100% .0-99
    seekBarProgress.setOnTouchListener(this);
    editTextSongURL = (EditText)findViewById(R.id.EditTextSongURL);
    editTextSongURL.setText(R.string.testsong_20_sec);

    mediaPlayer = new MediaPlayer();
    mediaPlayer.setOnBufferingUpdateListener(this);
    mediaPlayer.setOnCompletionListener(this);
}

/** Method which updates the SeekBar primary progress by current song playing position*/
private void primarySeekBarProgressUpdater() {
    seekBarProgress.setProgress((int)(((float)mediaPlayer.getCurrentPosition()/mediaFileLengthInMilliseconds)*100)); // This math construction give a percentage of "was playing"/"song length"
    if (mediaPlayer.isPlaying()) {
        Runnable notification = new Runnable() {
            public void run() {
                primarySeekBarProgressUpdater();
            }
        };
        handler.postDelayed(notification,1000);
    }
}

@Override
public void onClick(View v) {
    if(v.getId() == R.id.ButtonTestPlayPause){
         /** ImageButton onClick event handler. Method which start/pause mediaplayer playing */
        try {
            mediaPlayer.setDataSource(editTextSongURL.getText().toString()); // setup song from http://www.hrupin.com/wp-content/uploads/mp3/testsong_20_sec.mp3 URL to mediaplayer data source
            mediaPlayer.prepare(); // you must call this method after setup the datasource in setDataSource method. After calling prepare() the instance of MediaPlayer starts load data from URL to internal buffer. 
        } catch (Exception e) {
            e.printStackTrace();
        }

        mediaFileLengthInMilliseconds = mediaPlayer.getDuration(); // gets the song length in milliseconds from URL

        if(!mediaPlayer.isPlaying()){
            mediaPlayer.start();
            buttonPlayPause.setImageResource(R.drawable.button_pause);
        }else {
            mediaPlayer.pause();
            buttonPlayPause.setImageResource(R.drawable.button_play);
        }

        primarySeekBarProgressUpdater();
    }
}

@Override
public boolean onTouch(View v, MotionEvent event) {
    if(v.getId() == R.id.SeekBarTestPlay){
        /** Seekbar onTouch event handler. Method which seeks MediaPlayer to seekBar primary progress position*/
        if(mediaPlayer.isPlaying()){
            SeekBar sb = (SeekBar)v;
            int playPositionInMillisecconds = (mediaFileLengthInMilliseconds / 100) * sb.getProgress();
            mediaPlayer.seekTo(playPositionInMillisecconds);
        }
    }
    return false;
}

@Override
public void onCompletion(MediaPlayer mp) {
     /** MediaPlayer onCompletion event handler. Method which calls then song playing is complete*/
    buttonPlayPause.setImageResource(R.drawable.button_play);
}

@Override
public void onBufferingUpdate(MediaPlayer mp, int percent) {
    /** Method which updates the SeekBar secondary progress by current song loading from URL position*/
    seekBarProgress.setSecondaryProgress(percent);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T21:26:09.593

您需要使用 3rd 方库来支持 MP3 播放，因为它不包含在标准库中。请参阅[Wikipedia](http://en.wikipedia.org/wiki/Java_Media_Framework#Alternatives)以获取替代列表。

对于下载部分，使用 an`URLConnection`获取`InputStream`文件并将其写入`FileOutputStream`. 这也可能有帮助：[Working unbuffered Streams](http://codeisland.org/2012/working-unbuffered-streams/)

# r - 从分组值中的 R 表中提取值

> ID：13767765
> 
> 赞同：1
> 
> 时间：2012-12-07T17:10:38.297
> 
> 标签：r

我有下表按第一、第二和名称排序。

```
 myData <- structure(list(first = c(120L, 120L, 126L, 126L, 126L, 132L, 132L), second = c(1.33, 1.33, 0.36, 0.37, 0.34, 0.46, 0.53), 
    Name = structure(c(5L, 5L, 3L, 3L, 4L, 1L, 2L), .Label = c("Benzene", 
    "Ethene._trichloro-", "Heptene", "Methylamine", "Pentanone"
    ), class = "factor"), Area = c(699468L, 153744L, 32913L, 
    4948619L, 83528L, 536339L, 105598L), Sample = structure(c(3L, 
    2L, 3L, 3L, 3L, 1L, 1L), .Label = c("PO1:1", "PO2:1", "PO4:1"
    ), class = "factor")), .Names = c("first", "second", "Name", 
    "Area", "Sample"), class = "data.frame", row.names = c(NA, -7L)) 
```

在每个组中，我想提取与特定样本相对应的区域。有几个组没有样本中的区域，因此如果未检测到样本，它应该返回“NA”。理想情况下，最终输出应该是每个样本的列。

我尝试使用 ifelse 函数为每个样本创建一列：

`PO1<-ifelse(myData$Sample=="PO1:1",myData$Area, "NA")`

然而，这并没有考虑到组分布。我想这样做，但在小组内。如果 sample=PO1:1，Area，否则在每个组内（一个组的第一、第二和 Name 列的值相等），否则 NA。

对于第一组：

```
structure(list(first = c(120L, 120L), second = c(1.33, 1.33), 
Name = structure(c(1L, 1L), .Label = "Pentanone", class = "factor"), 
Area = c(699468L, 153744L), Sample = structure(c(2L, 1L), .Label = c("PO2:1", 
"PO4:1"), class = "factor")), .Names = c("first", "second", "Name", 
"Area", "Sample"), class = "data.frame", row.names = c(NA, -2L)) 
```

输出应该是：

```
structure(list(PO1.1 = NA, PO2.1 = 153744L, PO3.1 = NA, PO4.1 = 699468L), .Names =c("PO1.1", "PO2.1", "PO3.1", "PO4.1"), class = "data.frame", row.names = c(NA, -1L)) 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T18:16:35.063

*正如问题中的示例一样，我假设`Sample`是一个因素。如果不是这种情况，请考虑这样做。*

### 首先，让我们清理列`Sample`以使其成为合法名称，否则可能会导致错误

```
levels(myData$Sample)  <-  make.names(levels(myData$Sample))

## DEFINE THE CUTS##

# Adjust these as necessary
#--------------------------
  max.second <- 3  #  max & nin range of myData$second 
  min.second <- 0  #
  sprd <- 0.15     # with spread for each group
#--------------------------

# we will cut the myData$second according to intervals,   cut(myData$second, intervals)
intervals <- seq(min.second, max.second, sprd*2)

# Next, lets create a group column to split our  data frame by 
myData$group <- paste(myData$first, cut(myData$second, intervals), myData$Name, sep='-') 
groups <- split(myData, myData$group)

samples <- levels(myData$Sample)   ## I'm assuming not all samples are present in the example.  Manually adjusting with: samples <- sort(c(samples,  "PO3.1"))

# Apply over each group, then apply over each sample    
myOutput <- 
  t(sapply(groups, function(g) {

      #-------------------------------
      # NOTE: If it's possible that within a group there is more than one Area per Sample, then we have to somehow allow for thi. Hence the "paste(...)"
      res <- sapply(samples, function(s) paste0(g$Area[g$Sample==s], collapse=" - "))  # allowing for multiple values
      unlist(ifelse(res=="", NA, res))

      ## If there is (or should be) only one Area per Sample, then remove the two lines aboce and uncomment the two below:
      # res <- sapply(samples, function(s) g$Area[g$Sample==s])  # <~~ This line will work when only one value per sample
      # unlist(ifelse(res==0, NA, res))
      #-------------------------------

  }))

# Cleanup names
rownames(myOutput) <- paste("Group", 1:nrow(myOutput), sep="-")  ## or whichever proper group name

# remove dummy column 
myData$group <- NULL 
```

### 结果

```
myOutput

        PO1.1    PO2.1    PO3.1 PO4.1            
Group-1 NA       "153744" NA    "699468"         
Group-2 NA       NA       NA    "32913 - 4948619"
Group-3 NA       NA       NA    "83528"          
Group-4 "536339" NA       NA    NA               
Group-5 "105598" NA       NA    NA 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T18:50:13.813

你不能真的指望 R 直觉 PO2 和 PO4 之间有第四个因素水平，现在你可以。

```
> reshape(inp, direction="wide", idvar=c('first','second','Name'), timevar="Sample")
  first second               Name Area.PO4:1 Area.PO2:1 Area.PO1:1
1   120    1.3          Pentanone     699468     153744         NA
3   126    0.4            Heptene      32913         NA         NA
4   126    0.4            Heptene    4948619         NA         NA
5   126    0.3        Methylamine      83528         NA         NA
6   132    0.5            Benzene         NA         NA     536339
7   132    0.5 Ethene._trichloro-         NA         NA     105598 
```

# c# - 如何将左外连接添加到分组和求和的 LINQ 查询

> ID：13767767
> 
> 赞同：3
> 
> 时间：2012-12-07T17:10:44.973
> 
> 标签：c#, linq

我有一个员工表：

```
EmployeeID  |  EmployeeName
---------------------------
1           |  Jack
2           |  Jill
3           |  Roger 
```

还有一个 Occurrences 表：

```
OccurrenceID  |  EmployeeID  |  Points
--------------------------------------
1             |  1           |  5
2             |  2           |  3
3             |  1           |  1 
```

我有一个有效的 LINQ 查询，它将两个表分组和汇总在一起：

```
groupedOccurrences = (from o in db.Occurrences.Include(o => o.Employee)
                      where o.OccurrenceDate >= beginDate
                         && o.OccurrenceDate <= endDate
                      group o by o.Employee.EmployeeName into g
                      select new OccurrenceByQuarter
                      {
                          Name = g.Key,
                          Total = g.Sum(o => o.Points)
                       }); 
```

产生这个输出：

```
 Jack 6
 Jill 3 
```

但我也想让员工 Roger 以 0 分出现在输出中。我尝试向 LINQ 查询添加连接，如下所示：

```
groupedOccurrences = (from e in db.Employees
                      from o in db.Occurrences
                      join o in db.Occurrences on e.EmployeeID equals o.EmployeeID into j1
                      from j2 in j1.DefaultIfEmpty()
                      group j2 by e.EmployeeName into g
                      select new OccurrenceByQuarter
                      {
                          Name = g.Key,
                          Total = g.Sum(o => o.Points)
                      }); 
```

但我最终得到的分数被大大夸大了（就像他们应该的 24 倍一样）。

我还尝试通过`public int? Total { get; set; }`在我的 OccurrencesByQuarter 类中将 Total 的声明更改为 null 来让 Total 返回 0，但是当我尝试将 LINQ 查询更改为包含时，`Total = g.Sum(o => o.Points) ?? 0`我收到一条错误消息，提示“操作员 ?? 无法应用到 int 和 int 类型的操作数”。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T17:25:19.657

使用组加入：

```
groupedOccurrences = (from e in db.Employees
                      join o in db.Occurrences.Where(x => 
                                  x.OccurrenceDate >= beginDate &&
                                  x.OccurrenceDate <= endDate)
                           on e.EmployeeID equals o.EmployeeID into g
                      select new OccurrenceByQuarter
                      {
                          Name = e.EmployeeName,
                          Total = g.Sum(x => (int?)x.Points) ?? 0
                      }); 
```

结果将是：

```
Jack  6
Jill  3
Roger 0 
```

为了返回`0`空组，将汇总属性转换为可空，然后应用空合并运算符返回默认值：`g.Sum(x => (int?)x.Points) ?? 0`

# javascript - jQuery 优化代码模式

> ID：13767768
> 
> 赞同：1
> 
> 时间：2012-12-07T17:10:53.333
> 
> 标签：javascript, jquery

整个下午，

我有 2 块 jQuery 代码，有很多重复......我想知道是否有任何方法可以在线条和/或性能方面简化它。

2个区块如下：

```
$("#intro").css('min-height',$(window).height()-88);
$("#trabalhos").css('min-height',$(window).height()-88);
$("#fotografia").css('min-height',$(window).height()-88);
$("#cv").css('min-height',$(window).height()-88);
$("#contactos").css('min-height',$(window).height()-88); 
```

和：

```
$('.portfolio').click(function(e){ e.preventDefault();$('html,body').animate({scrollTop: $('#portfolio').offset().top-88},'slow'); });
$('.cv').click(function(e){ e.preventDefault();$('html,body').animate({scrollTop: $('#cv').offset().top-88},'slow'); });
$('.trabalhos').click(function(e){ e.preventDefault();$('html,body').animate({scrollTop: $('#trabalhos').offset().top-88},'slow'); });
$('.fotografia').click(function(e){ e.preventDefault();$('html,body').animate({scrollTop: $('#fotografia').offset().top-88},'slow'); });
$('.contactos').click(function(e){ e.preventDefault();$('html,body').animate({scrollTop: $('#contactos').offset().top-88},'slow'); }); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T17:13:31.947

您可以将选择器组合成一个语句，用逗号分隔它们。

```
$('#intro, #trabalhos, #fotografia, #cv, #contactos').css('min-height',$(window).height()-88); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T17:15:19.733

您可以使用多个选择器组合您的代码

```
$("#intro,#trabalhos,#fotografia,#cv,#contactos").css('min-height', $(window).height() - 88);

$('.portfolio,.cv,.trabalhos,.fotografia,.contractos').click(function(e) {
    e.preventDefault();
    $('html,body').animate({
        scrollTop: $('#'+$(this).attr('class')).offset().top - 88; // <-- this assuming you only have one class
    }, 'slow');
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-07T17:18:47.507

对于哪个 id，您使用相同的 css 给他们一个公共类，然后

```
 $(".common_class").css('min-height',$(window).height()-88);

  is it OK. 
```

# vb.net - 当我尝试在 VB 中打开 URL 时出现错误

> ID：13767771
> 
> 赞同：2
> 
> 时间：2012-12-07T17:11:13.607
> 
> 标签：vb.net, url, visual-studio-2012

当我尝试在 VB 中打开 URL 时，出现“System.dll 中出现‘System.ComponentModel.Win32Exception’类型的第一次机会异常”错误。我尝试了多种打开网站的方法，但都返回了这个错误。我现在使用的代码是这样的

```
Public Class Revise

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Bitesize.Click
        Dim bitesize As String = "http://www.bbc.co.uk/bitesize/standard/"
        Process.Start(bitesize)
    End Sub
End Class 
```

我对编程很陌生，如果这是我犯的一个愚蠢的错误，我很抱歉。

错误详情：

```
System.ComponentModel.Win32Exception was unhandled
  ErrorCode=-2147467259
  HResult=-2147467259
  Message=Unknown error (0x80041002)
  NativeErrorCode=-2147217406
  Source=System
  StackTrace:
       at System.Diagnostics.Process.StartWithShellExecuteEx(ProcessStartInfo startInfo)
       at System.Diagnostics.Process.Start()
       at System.Diagnostics.Process.Start(ProcessStartInfo startInfo)
       at System.Diagnostics.Process.Start(String fileName)
       at WindowsApplication1.Revise.Button1_Click(Object sender, EventArgs e) in C:\Users\Lewis\Documents\Visual Studio 11\Projects\Study Time!\Study Time!\Revise.vb:line 7
       at System.Windows.Forms.Control.OnClick(EventArgs e)
       at System.Windows.Forms.Button.OnClick(EventArgs e)
       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)
       at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)
       at System.Windows.Forms.Control.WndProc(Message& m)
       at System.Windows.Forms.ButtonBase.WndProc(Message& m)
       at System.Windows.Forms.Button.WndProc(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
       at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)
       at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg)
       at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData)
       at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)
       at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)
       at System.Windows.Forms.Application.Run(ApplicationContext context)
       at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.OnRun()
       at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.DoApplicationModel()
       at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Run(String[] commandLine)
       at WindowsApplication1.My.MyApplication.Main(String[] Args) in 17d14f5c-a337-4978-8281-53493378c1071.vb:line 81
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:15:58.750

Process.Start 实际上是在操作系统中执行一个程序。您尝试访问的 url 不是操作系统上程序的名称，因此它会失败。如果要使用此 url 打开外部浏览器实例，则需要将该程序作为进程打开。

```
Private Sub Button1_Click(ByVal sender as Object, ByVal e as EventArgs) Handles Bitesize.Click
    Dim bitesize as String = "http://www.bbc.co.uk/bitesize/standard/"
    Dim programName as String = "iexplore.exe"

    Process.Start(programName & " " & bitesize)
End Sub 
```

这应该可以实现您正在寻找的效果，但是在 winforms 应用程序中，使用 WebBrowser 控件并在按钮单击时填充其 url 属性会更有意义。

*编辑：*
要在系统的默认浏览器中打开一个 url，你可以简单地将你的 programName 设置为“start”。

```
Dim programName as String = "start" 
```

这是 Windows 中的一个快捷方式，它将使用默认浏览器自动打开一个 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:31:10.437

该代码（听起来您已经知道）将使用您计算机的默认 Web 浏览器打开该网站。您的代码是正确的（尽管方法名称应该与它正在侦听的控件匹配，因此当您有一个包含大量事件处理程序的表单时，它更容易阅读）。

我的猜测（没有详细信息 - 将来，请尝试发布异常堆栈跟踪），将无法确定您的默认 Web 浏览器。试试这个：打开控制面板\程序\默认程序\设置关联..并找到HTTP协议（在所有文件扩展名关联之后）并重置关联的应用程序。

其次，这是另一个很好的学习机会，当您的代码可能出错时（例如启动另一个进程），将代码包装在 Try/Catch 块中是一个非常好的主意。如果出现问题错了，你可以处理它，而不是让你的应用程序崩溃。

```
Try
    Dim bitesize As String = "http://www.bbc.co.uk/bitesize/standard/"
    Process.Start(bitesize)
Catch Ex As Exception
    MessageBox.Show(Ex.Message)
End Try 
```

System.Diagnostic.Process.Start 的 MSDN [http://msdn.microsoft.com/en-us/library/53ezey2s.aspx](http://msdn.microsoft.com/en-us/library/53ezey2s.aspx)

如果您仍然遇到问题，请发布堆栈跟踪，这可能有助于更清楚地了解发生了什么问题。

# jquery - 将 name=type 更改为 id=type

> ID：13767774
> 
> 赞同：-3
> 
> 时间：2012-12-07T17:11:31.580
> 
> 标签：jquery, input, show-hide

我目前正在使用此代码使输入框出现和消失，具体取决于我的用户选择的内容

```
<label class="title">Is the Primary Contact a Director of the corporation?</label>
<input type="radio"{if freeform:mp_data:type=="Yes"} checked="checked"{/if} name="type" id="primary_contact_director_1" value="Yes"> Yes</input><br>
<input type="radio"{if freeform:mp_data:type=="No"} checked="checked"{/if} name="type" id="primary_contact_director_2" value="No"> No</input><br><br>
<div id="Yes_box">

</div>
<div id="No_box">
<label class="title">Director's First Name:</label>
    <input type="text" name="director_first_name" class="form" value="{freeform:mp_data:director_first_name}">

<label class="title">Director's Last Name:</label>
    <input type="text" name="director_last_name" class="form" value="{freeform:mp_data:director_last_name}">

<label class="title">Address:</label>
    <input type="text" name="director_address" class="form" value="{freeform:mp_data:director_address}">

<label class="title">City:</label>
    <input type="text" name="director_city" class="form" value="{freeform:mp_data:director_city}">

<label class="title">State:</label>
    <input type="text" name="director_state" class="form" value="{freeform:mp_data:director_state}">

<label class="title">Zip Code</label>
    <input type="text" name="director_zip_code" class="form" value="{freeform:mp_data:director_zip_code}">
</div>

<script>
$(document).ready(function(){
var myRadio = $('input[name=type]');
var checkedValue = myRadio.filter(':checked').val();
if(checkedValue=='No'){
    $('#No_box').show();
}else{
    $('#No_box').hide();
}
$('#Yes_box_two').hide();

});
</script> 
```

但是，我需要名称字段才能显示结果，所以我想更改 input[name=type] 以调用 id 而不是名称

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:14:28.527

所以改变

```
var myRadio = $('input[name=type]'); 
```

至

```
var myRadio = $('input[id=type]'); 
```

或者

```
var myRadio = $('input#type'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:14:48.000

我认为您很困惑，您的以下行：

```
var myRadio = $('input[name=type]'); 
```

应该真的是这样才有意义：

```
var myRadio = $('input[type=radio]'); 
```

# c# - 使用 AutoMapper 映射相同值时出错

> ID：13767777
> 
> 赞同：5
> 
> 时间：2012-12-07T17:11:44.597
> 
> 标签：c#, automapper

我有这个失败的代码：

```
internal class Program
{
    private static void Main()
    {
        Mapper.CreateMap<SourceFoo, TargetFoo>();
        Mapper.CreateMap<string, Stuff>()
            .ForMember(dest => dest.Value, opt => opt.MapFrom(src => src))
            .ForMember(dest => dest.IgnoreMe, opt => opt.Ignore());

        var source = new SourceFoo
            {
                Stuff = "a",
                Stuff2 = "a"
            };
        var target = new TargetFoo
            {
                Stuff = new Stuff(),
                Stuff2 = new Stuff()
            };
        Mapper.Map(source, target);

        Console.WriteLine(target.Stuff.Value);
        Console.WriteLine(target.Stuff2.Value);
        Console.ReadLine();
    }
}

public class SourceFoo
{
    public string Stuff { get; set; }

    public string Stuff2 { get; set; }
}

public class TargetFoo
{
    public Stuff Stuff { get; set; }

    public Stuff Stuff2 { get; set; }
}

public class Stuff
{
    public string Value { get; set; }
    public bool IgnoreMe { get; set; }
} 
```

当 Stuff/Stuff2 具有相同的值时，我得到这个异常：

> 已添加具有相同密钥的项目。

如果他们有不同的价值观，一切都会奏效。我使用 AutoMapper 2.2.0。

我做错了什么还是一个错误？我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T18:17:23.623

这是一个错误。

现在您可以安装版本 2.1.267。

[NuGet](http://nuget.codeplex.com/)包管理器控制台命令：

> 卸载包 AutoMapper -Force
> 
> 安装包 AutoMapper -版本 2.1.267

检查此链接：

[https://github.com/AutoMapper/AutoMapper/issues/250](https://github.com/AutoMapper/AutoMapper/issues/250)

在里程碑中：2.2.1 issue [#270](https://github.com/AutoMapper/AutoMapper/issues/270)

# sql - 计算项目，按月循环，每次通过

> ID：13767778
> 
> 赞同：0
> 
> 时间：2012-12-07T17:11:45.103
> 
> 标签：sql, vb.net, linq

我有一张票表。我正在尝试计算在本年度每个月末“开放”的门票数量。同样，我将其推送到条形图，我需要通过 LINQ 将其放入数组中。

我的 SQL 查询得到我的计算是：

```
SELECT
    (SELECT COUNT(*) FROM tblMaintenanceTicket t WHERE (CreateDate < DATEADD(MM, 1, '01/01/2012')))
    -
    (SELECT COUNT(*) FROM tblMaintenanceTicket t WHERE (CloseDate < DATEADD(MM, 1, '01/01/2012'))) AS 'Open @Month End' 
```

我的逻辑如下：计算在月初和月底之间打开的所有门票。从月底前关闭的票中减去该计数。

**更新：** 我已经用下面的评论更新了我的查询，但它不适用于 GROUP 中的错误，但我并没有真正理解我猜想的逻辑，我缺乏 SQL 技能是罪魁祸首。

我添加了一个 SQL Fiddle 示例来向您展示我的查询：[http ://sqlfiddle.com/#!3/c9b638/1](http://sqlfiddle.com/#!3/c9b638/1)

期望的输出：

```
-----------
| Jan | 3 |
-----------
| Feb | 4 |
-----------
| Mar | 0 |
----------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T18:43:44.433

Your SQL has several erros . . . are grouping by `CreateDate` but you don't have it as a column from the subqueries. And, you don't have a column alias on the `count(*)`.

I think this is what you are trying to do:

```
select DATENAME(MONTH,CreateDate), DATEPART(YEAR,CreateDate),
       (sum(case when CreateDate < DATEADD(MM, 1, '01/01/2012') then 1 else 0 end) -
        sum(case when CloseDate < DATEADD(MM, 1, '01/01/2012') then 1 else 0 end)
       )
from tblMaintenanceTicket
group by DATENAME(MONTH,CreateDate), DATEPART(YEAR,CreateDate) 
```

Your comment seems to elucidate what you want clearer than your question (the explanation in the question is a bit buried). What you need is a driver table of months and then join this to your table. Something like:

```
select mons.yr, mons.mon, count(*) as OpenTickets
from (select month(CreateDate) as mon, year(CreateDate) as yr,
             cast(min(CreateDate) as date) as MonthStart,
             cast(max(CreateDate) as date) as monthEnd
      from tblMaintenanceTicket
      group by month(CreateDate), year(CreateDate) 
     ) mons left outer join
     tblMaintenanceTicket mt
     on mt.CreateDate <= mons.MonthEnd and
        (mt.CloseDate > mons.MonthEnd or mt.CloseDate is null)
group by mons.yr, mons.mon 
```

I am assuming records are created on every day. This is a convenience so I don't have to think about getting the first and last day of each month using other SQL functions.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:24:09.487

如果您的查询返回您需要的内容，则只需使用`DATENAME(MONTH, yourDate)`检索月份并按月、年分组：

```
 SELECT SUM(*), DATENAME(MONTH,yourDate), DATEPART(YEAR,yourDate)
 FROM
 (
     your actual query here
 )
 GROUP BY DATENAME(MONTH,yourDate), DATEPART(YEAR,yourDate) 
```

# sdl - 如何使用 Blackberry OS 10 的 NDK / Native 设置 SDL？

> ID：13767788
> 
> 赞同：4
> 
> 时间：2012-12-07T17:12:28.940
> 
> 标签：sdl, blackberry-10

我有一个带有雪豹的 Mac 环境，我想将一个带有 sdl 的书面游戏移植到 bb10。我的环境适用于级联和opengl样本......

我看到 github.com/blackberry 上有一个 SDL 端口和一个可供使用的 TouchoverlayLibrary ..但我不知道如何在 motics 中创建和设置 SDL 以及如何使用momentics 创建一个新的 SDL 项目。

现在我做了这些步骤：

*   gitclone sdl 黑莓端口
*   gitclone touchoverlay 库

但现在我被卡住了......因为我不知道如何移动......

我想我必须编译 2 库.. 但是如何？我应该使用momentics还是其他什么？..有什么帮助吗？

PS：这个解决方案没有帮助我：[如何配置 SDL 以使用 Blackberry Playbook Native SDK / NDK？](https://stackoverflow.com/questions/12289628/how-do-i-configure-sdl-to-work-with-the-blackberry-playbook-native-sdk-ndk)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T07:07:24.620

好的，经过一些研究和大量测试......我找到了一个解决方法......这里有一个小指南： http: [//pestohacks.blogspot.it/2012/12/simple-setup-sdl-on-blackberry-os -10-on.html](http://pestohacks.blogspot.it/2012/12/simple-setup-sdl-on-blackberry-os-10-on.html)

# ruby-on-rails - 使用 Mercury Editor 上传多个图像并调整其大小

> ID：13767790
> 
> 赞同：1
> 
> 时间：2012-12-07T17:12:35.430
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mercury-editor

我在我的 Rails 3.2.9 应用程序中使用了最新最好的 Mercury 编辑器。

我已经调整了 Image 模型以允许上传到 s3：

```
 has_attached_file :image,
                    :styles => { :medium => "200x115" },
                    :storage => :s3,
                    :s3_protocol => 'https',
                    :s3_credentials => "#{Rails.root}/config/s3.yml",
                    :path => ":attachment/:id/:style/:filename",   
                    :url => ":attachment/:id/:style/:filename",           
                    :bucket => 'ps-wifi' 
```

这工作正常。

我试图弄清楚如何允许用户上传多个图像，每个图像具有不同的属性。

例如，上述方法适用于徽标，但我们需要另一个更大的 600 x 350 图像。以前，我有另一个“has_attached_file”，但不确定如何使用 Mercury 实现。

# javascript - 哪个访问令牌用于打开图形操作

> ID：13767792
> 
> 赞同：1
> 
> 时间：2012-12-07T17:12:41.513
> 
> 标签：javascript, facebook-graph-api, facebook-javascript-sdk, facebook-opengraph, facebook-access-token

我创建了一个使用 publish_actions 权限的自定义打开图形操作。

用户授予此权限后，我需要使用哪个访问令牌来发布打开图形操作？我可以只使用我的应用令牌还是需要使用活动用户令牌？

我已经对此进行了测试，看起来只要用户授予应用程序权限，只使用应用程序令牌就可以了。我担心这可能是 api 中的一个怪癖，或者它可能会改变，因为它不在 api 文档中。

让我知道其他人是如何实现类似的东西的，如果它有助于这个开放图形操作尚未提交批准。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T19:37:29.533

两者都可以工作，并且在某些情况下需要应用程序访问令牌（这是您可以在特定操作类型上指定的选项），但通常您可能应该使用用户访问令牌，因为您需要它来回读数据并代表用户进行任何其他 api 调用

# java - 在java中将word文件另存为html

> ID：13767796
> 
> 赞同：2
> 
> 时间：2012-12-07T17:12:55.550
> 
> 标签：java, command-line, macros, ms-word, doc

我尝试使用 java 将 word 文件保存为 html。我将 word 文件另存为 xml，它对我有用

```
Runtime rt1 = Runtime.getRuntime();
rt1.exec("C:/Program Files/Microsoft Office/Office12/WINWORD.EXE /msaveasxml C:/myfolder/AB_00040.doc"); 
```

它将我的 doc 文件保存为特定文件夹 C:/myfolder 中的 xml 文件，我在 C:/myfolder/AB_00040.xml 中查看该 xml 文件

如果我想将相同的文件保存为 html，我该怎么办。任何一个帮助

```
rt1.exec("C:/Program Files/Microsoft Office/Office12/WINWORD.EXE /msaveas??? C:/myfolder/AB_00040.doc"); 
```

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-10T12:14:48.293

我在 Zack Macomber 的提示下找到了答案，我使用宏将 word 文件转换为 html 文件。我给出了那个宏的编码。将宏名称另存为“saveashtml”

```
Sub saveashtml()
Dim xmlname As String
xmlname = ActiveDocument.FullName
xmlname = Replace(xmlname, ".docx", ".html", , , vbTextCompare)
xmlname = Replace(xmlname, ".doc", ".html", , , vbTextCompare)
ActiveDocument.SaveAs FileName:=xmlname, FileFormat:=wdFormatHTML, LockComments:=False, Password:="", AddToRecentFiles:=True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData:=False, SaveAsAOCELetter:=False
Application.Quit
End sub 
```

您可以通过以下方式执行此宏

```
Runtime rt1 = Runtime.getRuntime();
rt1.exec("C:/Program Files/Microsoft Office/Office12/WINWORD.EXE /msaveashtml C:/myfolder/AB_00040.doc"); 
```

saveasxml 宏编码

```
Sub saveasxml()
Dim xmlname As String
xmlname = ActiveDocument.FullName
xmlname = Replace(xmlname, ".docx", ".xml", , , vbTextCompare)
xmlname = Replace(xmlname, ".doc", ".xml", , , vbTextCompare)
ActiveDocument.SaveAs FileName:=xmlname, FileFormat:=wdFormatFlatXML, LockComments:=False, Password:="", AddToRecentFiles:=True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData:=False, SaveAsAOCELetter:=False
End Sub 
```

# c# - 如何在 MVC3 Razor 视图中显示存储在变量中的图像

> ID：13767800
> 
> 赞同：0
> 
> 时间：2012-12-07T17:13:09.950
> 
> 标签：c#, asp.net-mvc-3

我有一个项目，我需要在其中显示本地存储在服务器上的图像缩略图。起初，我尝试使用 jquery 库为我的视图“缩略图”原始图像。但是，后来我意识到以这种方式提供可能成千上万的图像会真正占用带宽。所以下面是一种提取窗口缩略图的方法（并且只有一个完整的时间图像将按需提供）。

但问题是，缩略图现在位于模型的变量中。我不知道如何在 Razor 视图中实际显示图像。那么如何在视图中显示 System.Drawing.Icon 项？

```
public static System.Drawing.Icon GetThumbnailImages(string imageFilePath) 
        {
            ShellFile shellFile = ShellFile.FromFilePath(imageFilePath);
            Bitmap shellThumb = shellFile.Thumbnail.ExtraLargeBitmap;
            System.Drawing.Icon shellThumb2 = shellFile.Thumbnail.Icon;
            //var shellThumb3 = shellFile.Thumbnail.MediumIcon;
            return shellThumb2;

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:31:17.083

我会计算图像并在循环中生成标签，该标签以动作为源

```
for(int i= 0; i< MyModel.ImageCount(); i++){

     <img src="@Url.Action("GetImage", "Home")" />

} 
```

您的操作将需要发回文件。[以这个](https://stackoverflow.com/questions/7234733/mvc3-url-action-not-rendering-my-image-in-img-tag)为例

这将加载到图像中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:49:18.857

我建议您使用新尺寸创建一个新文件，然后通过 url 显示它。你可以使用类似的东西：

```
public static string GenerateThumbnail(string filename, string target, int width)
{
    var img = Image.FromFile(filename);

    if (img.Width > width)
    {
        var bitmap = new Bitmap(width, GetTargetHeight(img.Width, width, img.Height));
        var g = Graphics.FromImage(bitmap);

        g.InterpolationMode = InterpolationMode.HighQualityBicubic;
        g.DrawImage(img, 0, 0, width, GetTargetHeight(img.Width, width, img.Height));
        g.Dispose();

        using (Stream file = File.OpenWrite(target))
        {
            CopyStream(bitmap.ToStream(ImageFormat.Jpeg), target);
        }

        return target;
    }

    return filename;
}

private static int GetTargetHeight(int originalWidth, int targetWidth, int originalHeight)
{
    return Convert.ToInt32(decimal.Round((decimal)targetWidth / originalWidth * originalHeight, 0));
} 
```

然后使用

```
<img src="@GenerateThumbnail("path", "targetFile", 100)" /> 
```

# twitter-bootstrap - 你怎么能在引导程序中有一个导航栏拆分按钮下拉组件？

> ID：13767811
> 
> 赞同：3
> 
> 时间：2012-12-07T17:13:37.733
> 
> 标签：twitter-bootstrap

我正在使用引导程序（v2），我从[http://twitter.github.com/bootstrap/components.html#dropdowns](http://twitter.github.com/bootstrap/components.html#dropdowns)看到您可以拥有“拆分按钮下拉菜单”。

在导航栏中，您可以有下拉菜单

但是，您似乎不能在导航栏中有拆分下拉菜单。我想要使​​用它的目的是让登录用户的名称旁边带有插入符号。单击用户名会将您带到该用户的页面，但插入符号会显示一个下拉菜单，其中包含“退出”等操作。

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T18:21:47.043

我修改了你的 jsfiddle 来做我*认为*你要问的事情。将插入符号放在它自己的列表项中会在插入符号和用户名之间产生尴尬的空间。克服这一点需要一些覆盖。编辑：作为一个简单的例子，我使用了两个类来删除两个元素之间的填充。不过，我不得不使用该`!important`属性，这不是最佳做法。 [http://jsfiddle.net/R3JKz/15/](http://jsfiddle.net/R3JKz/15/)

```
<li>
 <a href="#" class="caret-before">
  someuser
 </a>
</li>
<li class="dropdown">    
 <a class="dropdown-toggle caret-after" data-toggle="dropdown">
  <b class="caret"></b>
 </a>
    ...
 </li> 
```

jsfiddle 中还包含一个如何使用 b 标记作为触发器的示例，但此方法在引导导航栏中效果不佳，因为它破坏了布局。例子：

```
<li class="dropdown">
 <a href="#" class="pull-left">
  A Dropdown Menu
 </a>
 <b class="caret pull-left dropdown-toggle" data-toggle="dropdown">
 </b> 
```

我希望这会有所帮助，请随时要求澄清。

# mongodb - 使用 Native Java UUID.getRandom() 作为 Sharding key 和 _id?

> ID：13767813
> 
> 赞同：1
> 
> 时间：2012-12-07T17:13:46.333
> 
> 标签：mongodb, random, uuid, sharding, mongodb-java

我知道对于一个写入繁重的应用程序，使用 ObjectId 对于分片键来说是一个非常糟糕的主意。**但是，使用 Java 中的本机 *UUID.randomUUID()**作为分片键是否是个好主意，因为它们是真正随机的，不会导致单个分片出现热点。

这些 ID 是**128 位 ID**，如下所示：

*   5842fa92557947f1b020041ff74868a4
*   308947443e564d80b97dd8411b4b727e
*   f8a7ee765bed4ce3bcc5800ac3a2a710
*   1bcfd08b89e94c58ae7695b3e7a1bc4f

它与 ObjectId (96bit int) 非常相似。

另外，由于在 _id 上必须有一个索引，所以分片键将是 _id，我们将通过为 shard_key 创建另一个索引来节省 RAM。一切集合都准备好进行分片。

是因为**Mongod**的性能问题还是磁盘/内存空间问题？

UUID 的冲突率是（[来自维基百科](http://en.wikipedia.org/wiki/Universally_unique_identifier#Random_UUID_probability_of_duplicates)）： *仅在接下来的 100 年每秒生成 10 亿个 UUID 之后，仅创建一个副本的概率约为 50%。如果地球上每个人都拥有 6 亿个 UUID，那么出现重复的概率约为 50%。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:37:19.747

使用 UUID 会将您的写访问权限分布在各个分片上，但您不会有查询隔离，因此您的查询结果不会达到最佳。最快的查询是只有一个分片回答的查询。 [http://docs.mongodb.org/manual/core/sharding-internals/#sharding-shard-key-query-isolation](http://docs.mongodb.org/manual/core/sharding-internals/#sharding-shard-key-query-isolation)

这将有助于了解您的收藏中的内容，从而更有效地帮助您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:16:59.567

使用 UUID 是完全可以的（前提是您只需要通过它们的主/分片键来查找这些文档）。shard key 的目的之一是将相关文档组合在一起。如果我们正在构建，比如说，flickr，我们的分片键将以 开头`user_id`，以便用户的照片一起放在一个分片上。如果您的文档不相关并且主键也是分片键，那么没有问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T14:20:02.047

由于[https://jira.mongodb.org/browse/JAVA-403](https://jira.mongodb.org/browse/JAVA-403)，您可能会遇到问题，该问题计划在下一个版本中修复。

# crystal-reports - 水晶报表的参数

> ID：13767814
> 
> 赞同：0
> 
> 时间：2012-12-07T17:13:46.947
> 
> 标签：crystal-reports

我在水晶报表中创建了一个@Month 作为参数名称，然后插入到报表标题部分。

当我运行报告时，它总是通过显示一个框来询问参数。我如何通过代码。我现有的代码如下

```
MyReport rpt = new MyReport();
var srcData = ; //here i added my LINQ statement to select the data
rpt.SetDataSource(srcData);
ParameterDiscreteValue pdValue = new ParameterDiscreteValue();
pdValue.Value = combo2.SelectedValue;
rpt.ParameterFields["@Month"].CurrentValues.Add(pdValue);
this.ReportViewer1.ReportSource = rpt;
this.ReportViewer1.RefreshReport(); 
```

我在哪里做错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T11:30:49.540

嗨，我通过删除 Crystalreportviewer 的RefershReport() 方法解决了

我从以下位置找到：[http ://www.it-sideways.com/2011/10/how-to-disable-parameter-prompt-for.html](http://www.it-sideways.com/2011/10/how-to-disable-parameter-prompt-for.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T19:07:06.620

我在添加参数时也遇到了麻烦。这是我工作的一个例子：

```
string ponumber = Request.QueryString["ponumber"].ToString();
string receiptno = Request.QueryString["receiptno"].ToString();

    // Put Away Report

    CrystalReportSource CrystalReportSource1 = new CrystalReportSource();
    CrystalReportViewer CrystalReportViewer1 = new CrystalReportViewer();

    CrystalReportViewer1.ReportSource = CrystalReportSource1;
    CrystalReportViewer1.EnableParameterPrompt = false;
    CrystalReportSource1.Report.FileName = "Report3.rpt";
    CrystalReportSource1.EnableCaching = false;

    // This will set the values of my two parameters in the report
    CrystalReportSource1.ReportDocument.SetParameterValue(0, ponumber);
    CrystalReportSource1.ReportDocument.SetParameterValue(1, receiptno);

    TableLogOnInfo logOnInfo = new TableLogOnInfo();

    logOnInfo.ConnectionInfo.ServerName = ConfigurationManager.AppSettings["WarehouseReportServerName"];
    logOnInfo.ConnectionInfo.DatabaseName = ConfigurationManager.AppSettings["WarehouseReportDatabaseName"];
    logOnInfo.ConnectionInfo.UserID = ConfigurationManager.AppSettings["WarehouseReportUserID"];
    logOnInfo.ConnectionInfo.Password = ConfigurationManager.AppSettings["WarehouseReportPassword"];

    TableLogOnInfos infos = new TableLogOnInfos();
    infos.Add(logOnInfo);
    CrystalReportViewer1.LogOnInfo = infos;

    maindiv.Controls.Add(CrystalReportSource1);
    maindiv.Controls.Add(CrystalReportViewer1);

    CrystalReportViewer1.DataBind(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T17:50:20.800

如果它不工作，它表明一个错字或什么的。尝试分析 rpt.ParameterFields（设置断点并观察）。你的参数名称正确吗？数据类型？

# wordpress - 如何在另一个页面中选择下拉值？

> ID：13767820
> 
> 赞同：1
> 
> 时间：2012-12-07T17:14:22.177
> 
> 标签：wordpress, drop-down-menu

我的 wordpress 网站上有一个重力形式脚本。它只是创建易于编辑的表单。**我需要以某种方式从链接**发送查询以在下拉列表中选择适当的项目。

[计划 http://agency-ct.ru/dropdown.jpg](http://agency-ct.ru/dropdown.jpg)

# listbox - 在自定义按钮控件中绑定 ListBox 或 ItemsControl

> ID：13767824
> 
> 赞同：1
> 
> 时间：2012-12-07T17:14:41.417
> 
> 标签：listbox, controls, relativesource, templatebinding

您好我是 XAML 的新手，我正在尝试构建一个自定义切换按钮控件。我的控件有以下代码，它没有给出任何编译或运行时错误，但不显示数据。当我尝试进行常规模板绑定时，我不断收到错误，经过研究我发现我需要使用相对源。但无法让列表填充。有人可以指导我做错了什么吗？或者如果有更好的方法来做到这一点？

目标：构建一个具有列表控件的可检查控件。

**XAML** Generic.xml：（此代码位于切换按钮控件模板中）

```
 <ListBox BorderBrush="Red" BorderThickness="2" 
ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=MyRoutes}">
<!--<ItemsControl.ItemsSource>
<Binding Mode="TwoWay" Path="MyRoutes">
<Binding.RelativeSource>
<RelativeSource Mode="TemplatedParent"/>
</Binding.RelativeSource>
</Binding>
</ItemsControl.ItemsSource>-->
<ItemsControl.ItemTemplate>
<DataTemplate>
<StackPanel>
<!--<TextBlock Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Value}"></TextBlock>-->
<TextBlock Text="{Binding Path=Value, RelativeSource={RelativeSource Self}}"></TextBlock>
</StackPanel>
</DataTemplate>
</ItemsControl.ItemTemplate>
</ListBox> 
```

**PlainToggleButton.cs 背后的代码：**

```
public string[] MyRoutes
    {
        get { return (string[])GetValue(MyRoutesProperty); }
        set { SetValue(MyRoutesProperty, value); }
    }

    // Using a DependencyProperty as the backing store for MyRoutes.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty MyRoutesProperty =
        DependencyProperty.Register("MyRoutes", typeof(string[]), typeof(PlainToggleButton), new PropertyMetadata(OnMyRoutesChanged));

    private static void OnMyRoutesChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        return;
    } 
```

**代码 MainWindow.xaml：**

```
<local:PlainToggleButton Grid.Row="1" MyRoutes="{Binding MyRoutes}">            
    </local:PlainToggleButton> 
```

# activerecord - Activerecord Rails 3 字符串限制不起作用

> ID：13767827
> 
> 赞同：0
> 
> 时间：2012-12-07T17:14:52.013
> 
> 标签：activerecord, ruby-on-rails-3.2, rails-migrations

我有一个 Rails 迁移，我很可能在这里做一些不正确的事情，但迁移是 ---

类 CreateStates < ActiveRecord::Migration

定义变化

```
create_table :states do |t|
  t.string      :state_legacy_id
  t.string      :name, :length => 20
  t.string      :abbreviation, :length => 2
  t.timestamps
end
add_index   :states, :id 
```

结尾

结尾

但是当我进入 mysql 数据库并查看表时，名称表以及缩写表的长度为 varchar/255 我的限制语句是不正确的。

我试过带引号和不带引号，所以 :limit => 20 和 :limit => "20" 两个产品表都带有 varchar 255。

任何建议都将受到欢迎。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:16:10.963

我相信这叫做限制 - 而不是长度

例如`:limit => 2`

# matlab - 如何创建一个矩阵，其元素是行号和列号的总和？

> ID：13767832
> 
> 赞同：1
> 
> 时间：2012-12-07T17:15:04.570
> 
> 标签：matlab, matrix, sum

我需要在 MATLAB 中创建一个 95x95 矩阵，其中每个元素都是其行号和列号的总和。我是新手，所以我真的想不出一种方法来告诉 MATLAB 只创建一个矩阵而不放入元素。据我所知，我必须为求和部分启动一个循环。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T17:36:48.133

[如果您使用HANKEL](http://www.mathworks.com/help/matlab/ref/hankel.html)则不需要数学：

```
A = hankel(2:96, 96:190); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T17:20:46.203

我提出了另一种策略，就像 EitanT 的策略一样简单：

```
 v = 1:95;
  A = bsxfun(@plus,v,v'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T17:18:33.010

没有必要用循环“重新发明轮子”。尝试这个：

```
[X, Y] = meshgrid(1:95, 1:95);
A = X + Y 
```

所需的输出存储在矩阵中`A`。

# objective-c - numberOfSectionsInTableView 后 UITableViewController 崩溃

> ID：13767834
> 
> 赞同：0
> 
> 时间：2012-12-07T17:15:13.193
> 
> 标签：objective-c, ios, uitableview, uiviewcontroller, uikit

我已经对 an 进行了子类`UITableViewController`化，我正在通过 segue 对其进行实例化。

似乎表格视图控制器已正确实例化`viewDidLoad`并`numberOfSectionsInTableView`正在被调用。事实上，`numberOfSectionsInTableView`甚至被调用了**两次**。当它第一次被调用时，它有一个有效值`tableView`，当它第二次被调用时（在第一次调用之后），`tableView`是`nil`

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return [super numberOfSectionsInTableView:tableView] + 1 ;
} 
```

我正在使用我在 Interface Builder 中设置的静态单元格（在第 0 节，第 0 行），我在第二节（第 1 节）中添加了动态行数。这就是为什么我将 1 添加到`[super numberOfSectionsInTableView:tableView]`. 父类的tableView类中没有自定义代码，一切都只是在Interface Builder中设置好了。

所有**插座**似乎都设置正确：

![在此处输入图像描述](../Images/02cb40134158397ea8a821f581d8afbb.png)

当代码继续执行时，应用程序崩溃并显示错误消息：

`Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[__NSArrayI objectAtIndex:]: index 1 beyond bounds [0 .. 0]`

您对可能导致错误的原因有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T18:38:10.703

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return [super numberOfSectionsInTableView:tableView] + 1 ;
} 
```

基本上意味着每次`numberOfSectionsInTableView`被调用时，表中的部分数量都会增加 1。话虽如此，如果你只在表中有两个部分，你最好使用`return 2;`.

现在，关于你的错误。考虑到我不知道确切的上下文或错误发生的位置，这很难说，但我的第一个猜测是崩溃发生在`cellForRowAtIndexPath`因为你的数据源要么是 nil 要么是一个空数组。

# c++ - 无法理解类构造函数

> ID：13767835
> 
> 赞同：2
> 
> 时间：2012-12-07T17:15:15.673
> 
> 标签：c++, class, reference, constructor

我有一堂课。

```
class Books
{
private:
    int m_books;
public:
    Books(int books=0)
    {
        m_books = books;
    }

    Books(const Books &source)  //Here is what I don't understand.
    {
        m_books = source.m_books;
    }
}; 
```

我不明白为什么它必须是`Books(const Books &source)`，而不是`Books(const Books source)`。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T17:22:32.993

当你有

```
Books(const Books &source) 
```

源是通过引用传递的。当你有

```
Books(const Books source) 
```

它会按值传递。但是要按值传递，您就是复制构造函数。所以为了避免无限递归，复制构造函数**必须**接受一个引用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-07T17:18:06.450

```
Books(const Books &source) 
```

表示传递的是引用，而不是实际的变量（如按值传递，如`int`or等​​原语`char`）。

在这种情况下，由于您正在构建一个复制构造函数，因此您不想对传入的引用的对象进行修改，因此参数签名以前缀为前缀`const`（这保证了传入的参数是不可变的）

（**注意，最重要的是：**这里的按值传递会引入无限递归 - 请参阅@AProgrammer 的回答）除此之外，按值传递也会不必要地昂贵`source`（意思是：在复制时复制整个源构造函数被调用），我们只是使用一个引用来代替。

* * *

您可能感兴趣的其他阅读材料：[C++ 引用传递与值传递](https://stackoverflow.com/questions/410593/pass-by-reference-value-in-c)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T17:20:50.483

您正在查看的内容称为复制构造函数。您应该通过引用传递对象的原因是因为如果您通过值传递它，则必须构造对象的副本，因此必须再次调用复制构造函数。然后再次。然后再次 ...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T17:17:49.953

所以 book 是通过引用传递而不是通过值复制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-07T17:18:54.103

使用引用意味着不涉及副本。如果你有：

```
Books(const Books source) 
```

然后调用者传递的参数必须被复制到`source`. 如果您改用引用，则不会制作副本。这提供了更好的性能。对于少量数据，这并不重要，因为它是一个没有大量数据的简单类。但是对于更复杂的类，复制可能会很昂贵。使用引用可以避免这个问题。

但是，对于复制构造函数，避免复制是至关重要的。不是出于性能原因，而是因为复制涉及复制构造函数。当调用复制构造函数时，如果不使用引用，则必须制作另一个副本。这意味着对复制构造函数的另一个调用。在那里，必须制作另一个副本。又一次调用复制构造函数。

可以想象，这将导致无限量的复制构造函数调用。通过使用参考可以避免这种情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-07T17:18:43.283

阅读复制构造函数：[http ://www.cplusplus.com/articles/y8hv0pDG/](http://www.cplusplus.com/articles/y8hv0pDG/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-07T17:18:45.677

它传递对`Books source`对象的引用。这一切。

我希望这有帮助。

# image - 检测模糊图像中的细线

> ID：13767850
> 
> 赞同：12
> 
> 时间：2012-12-07T17:15:34.317
> 
> 标签：image, matlab, image-processing, opencv, filtering

![在此处输入图像描述](../Images/f2cfb5601e4aad880398952f96382a5c.png)![在此处输入图像描述](../Images/c229f0376e87718b6481ff66ce1c3e4c.png)我正在寻找一些想法来检测附加图像中的线条。假设线条是垂直的，但它们的质量非常差，每条模糊线条之间只有 2-3 个像素。

我已经尝试过这些方法：垂直腐蚀和膨胀 -> 增强 CLAHE 的好结果 -> 有利于增强霍夫 -> 失败，因为将图像转换为黑色，同时会有太多的断线或断桥。我也试过垂直线掩码。基本上基于黑白图像转换的方法不适用于此。

![在模糊图像中检测非常细的线条](../Images/f5b1d9043ec21477293dcb3e89f60090.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-07T17:26:36.013

我会沿着线条折叠图像以获得一维轮廓。并在那里进行检测（例如，通过查看中值以上的峰值。

这是折叠的图像![折叠的图像](../Images/c1c5ee7345d59fbfb5125c977d1fde4b.png)

那里的物体检测很明显

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-12T12:41:52.997

关于噪声图像中微弱边缘检测的非常有前途的作品：直线的基本版本 ：http: [//www.wisdom.weizmann.ac.il/~meirav/EdgesGalunBasriBrandt.pdf](http://www.wisdom.weizmann.ac.il/~meirav/EdgesGalunBasriBrandt.pdf) 更高级的版本： [http://www.wisdom.weizmann .ac.il/~meirav/Curves_Alpert_Galun_Nadler_Basri.pdf](http://www.wisdom.weizmann.ac.il/~meirav/Curves_Alpert_Galun_Nadler_Basri.pdf)

我不确定作者是否公开了他们的代码。直接联系作者可能是值得的。

这些工作为微弱边缘检测提出了一种经过充分研究和原则性的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T19:02:32.913

这是另一种方法，它会找到你的线条，假设峰值在 ~5 像素内很明显。它将容忍图像的小旋转。

```
img = imread('http://i.stack.imgur.com/w7qMT.jpg');
img = rgb2gray(img);

%# smoothen the image a little with an anisotroic Gaussian
fimg = imfilter(double(img),fspecial('gaussian',[3 1]));

%# find the lines as local maxima
msk = ones(5);
msk(:,2:4) = 0;
lines = fimg > imdilate(fimg,msk); 
```

![在此处输入图像描述](../Images/0b3dd4509997878daf7e74adb49dc592.png)

# c# - 选项卡之间的唯一会话？

> ID：13767856
> 
> 赞同：-1
> 
> 时间：2012-12-07T17:16:00.013
> 
> 标签：c#, php, .net, vb.net, session

我们有一个自定义会话处理程序，它存储页面数据的历史记录。我们有一个要求，我们需要为每个选项卡/窗口存储和识别唯一的会话。

为简单起见，假设我需要每个选项卡的唯一字符串，即

*   窗口 A - 选项卡 1 - ABCDEF
*   窗口 A - 选项卡 2 - CDEFGH
*   窗口 A - 选项卡 3 - EFGHIJ
*   窗口 B - 选项卡 1 - GHIJKL
*   窗口 B - 选项卡 2 - IJKLMN

当单击任何链接或任何选项卡执行回发时，我需要立即访问这些字符串。

我们目前有一个过于复杂的解决方案，它生成这些唯一的字符串并将它们保存在选项卡名称和 cookie 中，并使用窗口模糊/焦点事件来确定页面何时被导航走。它在“实验室”中运行良好，但“在野外”我们确实遇到了问题。

我想最“可靠”的方法是生成一个唯一的字符串并将其放在每个页面和该页面上每个 URL 的查询字符串上，这样当您单击任何链接或回发时，它就会立即可用，您可以在选项卡/窗口之间自由移动。然而，这将需要大量的重写，我想知道我是否错过了一个更直接的选择。

欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T11:22:01.113

最后，我们找到了一个理想的解决方案。我们在选项卡之间没有“唯一”会话，我们为每个页面都有“唯一”会话，完全忽略选项卡。

我们仍然使用模糊/焦点事件来处理用户当前在哪个选项卡上，但这仅用于提供特定于选项卡的导航历史记录，与会话处理没有任何区别。

这似乎很适合我们的需求。

# python - 在 tweepy get_authorization_url() 本地 HTTP 错误 401：未经授权但在网络中正常工作

> ID：13767861
> 
> 赞同：0
> 
> 时间：2012-12-07T17:16:18.813
> 
> 标签：python, google-app-engine, twitter, http-status-code-401, tweepy

我正在使用 google appengine sdk 和 python 进行开发，我正在尝试合并我的 twiiter 应用程序

```
import tweepy
TWITTER_CONSUMER_KEY = 'XXXXXXXXXXX'
TWITTER_CONSUMER_SECRET = 'xxxxxxxxxx'
auth = tweepy.OAuthHandler(TWITTER_CONSUMER_KEY,TWITTER_CONSUMER_SECRET) 
```

但它不起作用，返回以下错误

```
in get_authorization_url
    raise TweepError(e)
TweepError: HTTP Error 401: Unauthorized 
```

问题是这个错误是在本地生成的，但是在网上上传我的应用程序，效果很好

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T20:02:11.213

我开始深入研究 Tweepy 代码，返回的错误是这样的：

桌面应用程序仅支持 oauth_callback 值 \'oob\'

我通过在我的应用程序中设置回调 url 来解决它。我将我的设置为 127.0.0.1，这似乎已经解决了。

# asp.net - 使用 radMonthYearPicker 计算不同的月份

> ID：13767864
> 
> 赞同：1
> 
> 时间：2012-12-07T17:16:36.037
> 
> 标签：asp.net, telerik, asp.net-ajax, 3-tier

我有 2 radMonthYearPicker（1 用于开始日期，另外 1 用于结束日期）我想计算这 2 个日期之间的月份不同。

对于我的开始日期，我将我的月份设置为 12 月和 2012 年。对于我的结束日期，我将我的月份设置为 12 月和 2013 年

基于这 2 RadMonthYearPicker，相隔的月份应该是 12 个月

我能找到的唯一代码是 RadMonthYearPicker.selectedDate

PS 由于缺少重复点，我不允许上传图像文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T18:49:23.933

```
int monthsApart = 12 * (startDate.Year - endDate.Year) + 
   startDate.Month - endDate.Month;

int result = Math.Abs(monthsApart); 
```

# c# - 我可以公开不是 DataContract 的类的 DataMember 吗？

> ID：13767866
> 
> 赞同：0
> 
> 时间：2012-12-07T17:16:38.000
> 
> 标签：c#, .net, wcf, datacontract, datamember

我可以做这样的事情：

```
public abstract class DeletableEntity
{
    [DataMember]
    public bool Delete { get; set; }
}

[DataContract]
public class MyClass : DeletableEntity
{
    [DataMember]
    public int ID { get; set; }
} 
```

我真的只需要让`DeletableEntity`其他人可以继承它，所以它不需要通过 WCF，我可以发送它的`Delete`成员`MyClass`而不必发送`DeletableEntity`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:04:17.447

不，那应该是不可能的。根据您的要求，使用接口会更简单。另外，作为建议，请考虑使用已知类型。这与您的问题并不直接相关，但它允许您在 wcf 上使用“多态性”。可以在此处获得更多详细信息：http: [//msdn.microsoft.com/en-us/magazine/gg598929.aspx](http://msdn.microsoft.com/en-us/magazine/gg598929.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T19:40:00.043

对于 DataContractSerializer 如何处理序列化，您有几个选择：

1.  什么都不做——如果没有关于 [DataContract] 或 [DataMember] 的声明，.NET 4.0 和更高版本中的默认行为是发送所有公共成员。
2.  将 DeletableEntity 声明为 [DataContract] 并声明可序列化的 [DataMembers]。一旦你说了什么，WCF 就会假设你想说更多。

你可能想做#2。完成此操作后，如果您有任何采用 DeletableEntity 及其派生类型的 WCF 方法，请添加 [KnownTypes] 属性。您可能只想使用传递静态方法名称的 KnownTypes 的字符串版本。然后，静态方法可以使用程序集上的反射来提取从 DeletableEntity 派生的所有类型，以便该方法捕获在您编码时添加的任何新项目。

如果您想要以上内容，我推荐以下代码：

```
[DataContract]
[KnownType("GetKnownTypes")]
public abstract class DeletableEntity
{
  [DataMember]
  public bool Delete { get; set; }

  public static Type[] GetKnownTypes()
  {
    return (from type in typeof (DeletableEntity).Assembly.GetTypes()
            where typeof (DeletableEntity).IsAssignableFrom(type)
            select type).ToArray();
  }
} 
```

# class - Apex - Salesforce.com - 我需要帮助编写 APEX 类来测试我的工作触发器 - Chatter - 监控特定关键字

> ID：13767870
> 
> 赞同：0
> 
> 时间：2012-12-07T17:16:58.973
> 
> 标签：class, triggers, salesforce, salesforce-chatter

这是我的工作触发器

```
trigger CheckChatterPostsOnNSP on FeedItem (before insert) {

Set<Id> nspIds = new Set<Id>();

//Get the NSP that will be updated
List<Non_Standard_Pricing__c> nsp2Update = new List<Non_Standard_Pricing__c>();

//Get the key prefix for the NSP object via a describe call.
String nspKeyPrefix = Non_Standard_Pricing__c.sObjectType.getDescribe().getKeyPrefix();

//Get the Id of the user
Id profileId = UserInfo.getProfileId();

for (FeedItem f: trigger.new) {
    String parentId = f.parentId;

    if(profileId == '00e30000000eWXR') {// Users profile must be Sales and Service
        //We compare the start of the 'parentID' field to the NSP key prefix to
        //restrict the trigger to act on posts made to the NSP object.
        if (
            parentId.startsWith(nspKeyPrefix) &&
            (
                f.Body.contains('***APPROVED BY CHANNEL***') || 
                f.Body.contains('***APPROVED BY CSM***') || 
                f.Body.contains('[APPROVED BY CHANNEL]') || 
                f.Body.contains('[APPROVED BY CSM]')
            )
        ){
            nspIds.add(f.parentId);
        }
    }
}
List < Non_Standard_Pricing__c > nsps = [select id, Pre_Approved_Service_Discount__c, ownerId
from Non_Standard_Pricing__c where id in :nspIds];

for (Non_Standard_Pricing__c n: nsps) {
    //We compare the creator of the Chatter post to the NSP Owner to ensure
    //that only authorized users can close the NSP using the special Chatter 'hot-key'

        n.Pre_Approved_Service_Discount__c = true;
        nsp2Update.add(n);
    }
    update nsp2Update;
} 
```

这是我编写 APEX 测试类的尝试

```
@isTest
public class CheckChatterPostsOnNSPTEST {

    static testMethod void CheckChatterPostsOnNSPTEST() {
        //Create and insert opp
        Opportunity opp = new Opportunity(Name='test opp', StageName='stage', Probability = 95, CloseDate=system.today());
        insert opp;

        //Create and insert NSP
        Non_Standard_Pricing__c NSP = new Non_Standard_Pricing__c(Opportunity__c = opp.Id, Status__c = 'Open');
        insert NSP;

        //Find user with Profile = Sales and Service
        Profile SalesNService = [Select id from Profile where Name = 'Sales and Service' limit 1];
        User u = new User(
            Alias = 'standt', 
            Email='standarduser@testorg.com',
            EmailEncodingKey='UTF-8',
            LastName='Testing',
            LanguageLocaleKey='en_US',
            LocaleSidKey='en_US',
            ProfileId = SalesNService.Id,
            TimeZoneSidKey='America/Los_Angeles',
            UserName='standarduser@testorg.com'
        );

        System.runAs(u)
        {
            //Create FeedItem entry with text '[APPROVED BY CHANNEL]'
            FeedItem post = new FeedItem();
            post.body = '[APPROVED BY CHANNEL]';

            //Now update the opportunites to invoke the trigger
            Test.startTest();
            insert post;
            Test.stopTest();
        }

        //Assertion Testing
        for(Opportunity o : [select Id, Name, Primary_NSP__r.Pre_Approved_Service_Discount__c from Opportunity where Id = :opp.Id]){
            system.assert(o.Primary_NSP__r.Pre_Approved_Service_Discount__c = true);
        }
    }
} 
```

我收到以下错误消息：System.QueryException：列表没有分配给 SObject 堆栈跟踪的行：Class.CheckChatterPostsOnNSPTEST.CheckChatterPostsOnNSPTEST：第 14 行，第 1 列

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:19:39.747

那将指向这一行：

```
Profile SalesNService = [Select id from Profile where Name = 'Sales and Service' limit 1]; 
```

只需检查此查询是否返回某些内容？个人资料名称中的错字（也许您有下划线或“销售与服务”）？也许 org 中根本没有这样的配置文件（例如，如果您在生产环境中创建了这样的配置文件，但之后您所在的沙箱没有刷新）？

恐怕我们无法为您提供更多帮助；）它甚至与 API 版本、“seeAllData”等无关，因为[文档说配置文件仍然可见](http://www.salesforce.com/us/developer/docs/apexcode/index_Left.htm#StartTopic=Content/apex_testing_data_access.htm)。

# python - 如何为列表中的每个值分配一个变量

> ID：13767877
> 
> 赞同：2
> 
> 时间：2012-12-07T17:17:15.723
> 
> 标签：python, list, dictionary, python-3.x

我想分配一个变量，但相同的变量只是为列表中的每个值增加一，例如`my_list=[[aa],[ab],[ba],[bb],[bc],[cb],[cc],[cd]]`，我想`d`成为变量并且必须继续遍历列表，`d+=1`例如输出看起来或多或少像`value[0]=d0`，，，，, , , , , .`value[1]=d1``value[2]=d2``value[3]=d3``value[4]=d4``value[5]=d5``value[6]=d6``value[7]=d7`

```
def my_list():
    my_list=[[aa],[ab],[ba],[bb],[bc],[cb],[cc],[cd]] #list of values
    for d in my_list:
        d+=1 #? i don't know? how could i do this? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:26:17.983

也许您正在寻找列表理解？

```
value = [d[0] for d in my_list] 
```

列表推导可以让您处理迭代的每个元素以生成新列表。上面的示例采用嵌套列表的第一个元素，将每个元素添加到一个新列表中。然后您的输入列表将转换为：

```
[aa, ab, ba, bb, bc, cb, cc, cd] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:45:15.417

我想到的一种方法：

```
def my_list(n):
   my_list, my_num, my_var = [], 0, '' #multiple assignment of variables
   for my_num in range(n + 1): #second argument is exclusive, this implies (0, n + 1)
      my_var = 'd' + str(my_num)
      my_list.append(my_var)
   return my_list 
```

或者，您可以使用字典（相同的想法，但有点不同）：

```
def my_dict(n):
   my_dict, my_num, my_var = {}, 0, ''
   for my_num in range(n + 1):
      my_var = 'd' + str(my_num)
      my_dict[my_num] = my_var
   return my_dict 
```

它将导致每个条目的键为`my_num`并且值为`my_var`。你可以`'d'`用任何东西替换，只要它是一个字符串。如果它没有格式化为字符串，并且`my_num`是整数或浮点数，它将把它们加在一起（`3 + 7`会导致`10`, not `37`），而不是连接它们。

# rest - EJB 单例问题

> ID：13767880
> 
> 赞同：1
> 
> 时间：2012-12-07T17:17:23.660
> 
> 标签：rest, jakarta-ee, singleton, ejb

我遇到了 EJB 3.1 单例的问题。我创建了一个简单的项目，看看我是否可以让它们正确实例化，但是，由于 Glassfish 3.1.2.2 的一个长异常，看起来我开始做错了。

我正在使用 maven 将其编译成 WAR（没有 web.xml 描述符）。我正在使用带有 Jersey 的 jax-rs 来处理休息电话。

看起来我无法实例化 SingletonA（当我尝试部署应用程序时失败）。在调用标有 @PostConstruct 的方法时，不会注入/创建 SingletonB。

对此的任何帮助将不胜感激。

这是我的 POM

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>MyGroup</groupId>
<artifactId>myartifact</artifactId>
<version>0.0.1-SNAPSHOT</version>
<packaging>war</packaging>
<name>myproject</name>

<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <configuration>
                <source>1.6</source>
                <target>1.6</target>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.2</version>
            <configuration>
                <failOnMissingWebXml>false</failOnMissingWebXml>
            </configuration>
        </plugin>
    </plugins>
</build>

<dependencies>
    <dependency>
        <groupId>javax</groupId>
        <artifactId>javaee-api</artifactId>
        <version>6.0</version>
    </dependency>
</dependencies> 
```

这是 RestApp

```
package main;

import javax.ws.rs.ApplicationPath;
import javax.ws.rs.core.Application;

@ApplicationPath("/rest/")
public class RestApp extends Application {
} 
```

这是我的 SingletonA

```
package main;

import javax.annotation.PostConstruct;
import javax.ejb.DependsOn;
import javax.ejb.Singleton;
import javax.ejb.Startup;
import javax.inject.Inject;

@Singleton
@Startup
@DependsOn("SingletonB")
public class SingletonA {
    @Inject SingletonB sb;

    @PostConstruct
    public void init()
    {
        System.out.println("\n\n>In SingletonA's startup\n");
        sb.doSomethingCool();
    }

    public String test()
    {
        return sb.getIt();
    }
} 
```

这是 SingletonB

```
package main;

import javax.ejb.Singleton;

@Singleton
public class SingletonB {
    public void doSomethingCool()
    {
        System.out.println("\n\n\n>>Singleton B did something cool!\n\n\n");
    }

    public String getIt()
    {
        return "my string";
    }
} 
```

休息服务：

```
package main;

import javax.ejb.Stateless;
import javax.inject.Inject;
import javax.ws.rs.GET;
import javax.ws.rs.Path;

@Path("")
@Stateless
public class RestSvc {
    @Inject SingletonA sa;

    @Path("/get")
    @GET
    public String asdf()
    {
        return sa.test();
    }
} 
```

最后是来自服务器的堆栈跟踪：

```
[#|2012-12-07T10:21:42.934-0700|SEVERE|glassfish3.1.2|javax.enterprise.system.tools.admin.org.glassfish.deployment.admin|_ThreadID=156;_ThreadName=Thread-2;|Exception while loading the app : javax.ejb.CreateException: Initialization failed for Singleton SingletonA
javax.ejb.CreateException: Initialization failed for Singleton SingletonA
        at com.sun.ejb.containers.AbstractSingletonContainer.createSingletonEJB(AbstractSingletonContainer.java:547)
        at com.sun.ejb.containers.AbstractSingletonContainer.access$100(AbstractSingletonContainer.java:79)
        at com.sun.ejb.containers.AbstractSingletonContainer$SingletonContextFactory.create(AbstractSingletonContainer.java:719)
        at com.sun.ejb.containers.AbstractSingletonContainer.instantiateSingletonInstance(AbstractSingletonContainer.java:451)
        at org.glassfish.ejb.startup.SingletonLifeCycleManager.initializeSingleton(SingletonLifeCycleManager.java:216)
        at org.glassfish.ejb.startup.SingletonLifeCycleManager.initializeSingleton(SingletonLifeCycleManager.java:177)
        at org.glassfish.ejb.startup.SingletonLifeCycleManager.doStartup(SingletonLifeCycleManager.java:155)
        at org.glassfish.ejb.startup.EjbApplication.start(EjbApplication.java:177)
        at org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)
        at org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)
        at org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:301)
        at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:461)
        at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
        at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:389)
        at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)
        at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)
        at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)
        at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)
        at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)
        at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)
        at org.glassfish.admin.rest.ResourceUtil.runCommand(ResourceUtil.java:214)
        at org.glassfish.admin.rest.ResourceUtil.runCommand(ResourceUtil.java:207)
        at org.glassfish.admin.rest.resources.TemplateListOfResource.createResource(TemplateListOfResource.java:148)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at com.sun.jersey.spi.container.JavaMethodInvokerFactory$1.invoke(JavaMethodInvokerFactory.java:60)
        at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:205)
        at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)
        at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)
        at com.sun.jersey.server.impl.uri.rules.SubLocatorRule.accept(SubLocatorRule.java:134)
        at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
        at com.sun.jersey.server.impl.uri.rules.SubLocatorRule.accept(SubLocatorRule.java:134)
        at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
        at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)
        at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
        at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)
        at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1469)
        at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1400)
        at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1349)
        at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1339)
        at com.sun.jersey.server.impl.container.grizzly.GrizzlyContainer._service(GrizzlyContainer.java:182)
        at com.sun.jersey.server.impl.container.grizzly.GrizzlyContainer.service(GrizzlyContainer.java:147)
        at org.glassfish.admin.rest.adapter.RestAdapter.service(RestAdapter.java:148)
        at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)
        at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
        at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)
        at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
        at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
        at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
        at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
        at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
        at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
        at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
        at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
        at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
        at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
        at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
        at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
        at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.NullPointerException
        at main.SingletonA.init(SingletonA.java:20)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at com.sun.ejb.containers.interceptors.BeanCallbackInterceptor.intercept(InterceptorManager.java:1009)
        at com.sun.ejb.containers.interceptors.CallbackChainImpl.invokeNext(CallbackChainImpl.java:65)
        at com.sun.ejb.containers.interceptors.CallbackInvocationContext.proceed(CallbackInvocationContext.java:113)
        at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.doCallback(SystemInterceptorProxy.java:138)
        at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.init(SystemInterceptorProxy.java:120)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at com.sun.ejb.containers.interceptors.CallbackInterceptor.intercept(InterceptorManager.java:964)
        at com.sun.ejb.containers.interceptors.CallbackChainImpl.invokeNext(CallbackChainImpl.java:65)
        at com.sun.ejb.containers.interceptors.InterceptorManager.intercept(InterceptorManager.java:393)
        at com.sun.ejb.containers.interceptors.InterceptorManager.intercept(InterceptorManager.java:376)
        at com.sun.ejb.containers.AbstractSingletonContainer.createSingletonEJB(AbstractSingletonContainer.java:538)
        ... 62 more
|#] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T18:16:56.890

如果您的 EJB 是使用 @EJB 注入的，但没有使用 @Inject，则可能意味着您忘记`beans.xml`在 WEB-INF 目录中添加一个文件（即使是空的）。请参阅[http://docs.oracle.com/javaee/6/tutorial/doc/gjbnz.html](http://docs.oracle.com/javaee/6/tutorial/doc/gjbnz.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:39:08.123

答案在 pom 依赖项中。我只能猜测为什么会修复它，但它确实如此。如果有人知道为什么会这样，请留下评论为什么。

这是我的新 POM 文件（我更改了依赖项。删除了 javaee-api v6 并改用 glassfish javax.ejb。

这个项目中没有 web.xml 或 beans.xml（我在 EE 6 中读过，这些文件是可选的）

我不能再使用@Inject，所以我所有的注入都改成了@EJB。有了这个，我能够成功地实例化两个单例，并毫无问题地注入它们。

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>MyGroup</groupId>
    <artifactId>myartifact</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <packaging>war</packaging>
    <name>myproject</name>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>2.2</version>
                <configuration>
                    <failOnMissingWebXml>false</failOnMissingWebXml>
                </configuration>
            </plugin>
        </plugins>
    </build>

    <dependencies>
        <dependency>
            <groupId>org.glassfish</groupId>
            <artifactId>javax.ejb</artifactId>
            <version>3.1.1</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.ws.rs</groupId>
            <artifactId>jsr311-api</artifactId>
            <version>1.1.1</version>
            <scope>provided</scope>
        </dependency>
    </dependencies>
</project> 
```

# xml - 在 XSL 编码中创建内容并将其写入文件

> ID：13767881
> 
> 赞同：0
> 
> 时间：2012-12-07T17:17:28.010
> 
> 标签：xml, file, xslt, xslt-1.0

嗨，我只想通过 xsl 将 xml 下面写入一个名为 test.xml 的文件

```
<Number>
<num>1</num>
<num>2</num>
</Number> 
```

这是 xsl 的输出，我想将它存储在本地机器的 test.xml 文件中。请让我知道如何在 XSL 中实现这一点。我不知道 XSL 中的文件概念，XSL 是否有能力这样做？..请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T10:21:45.243

希望下面的 xsl 有帮助，

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" omit-xml-declaration="yes"/>
<xsl:template match="/">

    <Number><xsl:text>&#10;</xsl:text>
    <num>1</num><xsl:text>&#10;</xsl:text>
    <num>2</num><xsl:text>&#10;</xsl:text>
   </Number>

</xsl:template>

</xsl:stylesheet> 
```

我自己对此进行了测试。它应该工作。

# php - XAMPP 回显我的 PHP 代码的一部分

> ID：13767884
> 
> 赞同：0
> 
> 时间：2012-12-07T17:17:46.443
> 
> 标签：php, apache, xampp

我在 Windows 7 64 位机器上的 XAMPP 环境中工作。我安装了 Apache 2.4 服务。我遇到的问题让我困惑了大约一天。

到目前为止，我的 php 文件都已按预期执行。最近，我创建了一个文件，该文件以以下内容开头：

```
 function get_web_page($url,$attempt=1){
        if($attempt <4){
            $options = array(
                CURLOPT_RETURNTRANSFER => true,     // return web page
                CURLOPT_HEADER         => false,    // don't return headers
                CURLOPT_FOLLOWLOCATION => true,     // follow redirects
                CURLOPT_ENCODING       => "",       // handle all encodings
                CURLOPT_USERAGENT      => "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:15.0) Gecko/20120427 Firefox/15.0a1", // who am i
                CURLOPT_AUTOREFERER    => true,     // set referer on redirect
                CURLOPT_CONNECTTIMEOUT => 30,      // timeout on connect
                CURLOPT_TIMEOUT        => 30,      // timeout on response
                CURLOPT_MAXREDIRS      => 10,       // stop after 10 redirects
            );
            $ch      = curl_init( $url );
            curl_setopt_array( $ch, $options );
            $content = curl_exec( $ch );
            $err     = curl_errno( $ch );
            $errmsg  = curl_error( $ch );
            $header  = curl_getinfo( $ch );
            curl_close( $ch );

            if($err == 0){
                return $content;
            }else{
                return get_web_page( $url, $attempt + 1 );
            }
        }else{
            return FALSE;
        }
    } 
```

一个检索网页的简单函数，它也不回显任何内容。但是当我在浏览器中访问这个页面时（此时它只定义了一个函数，没有其他任何东西），它会将第一个“=>”实例之后的所有内容打印到页面上（不带引号）。我不明白为什么会这样。我在同一目录中的所有其他 php 文件都按预期运行。

请帮助我了解为什么会发生这种情况以及我应该采取哪些步骤来解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:29:51.107

Look at the source of the page given to your browser and you'll probably see the entire php source in plaintext. It's only rendering what's after the first `=>` because that's likely the first closing `>` it finds after the opening `<` in `<?php`. The first part doesn't render because your browser thinks it's inside some strange HTML tag.

Check your apache config, because it's not routing requests for `*.php` pages through the PHP interpreter.

# objective-c - UIImageView 动画和视网膜图像

> ID：13767887
> 
> 赞同：0
> 
> 时间：2012-12-07T17:17:51.817
> 
> 标签：objective-c, ios

我正在使用以下代码在应用程序主屏幕中为我的公司徽标设置动画：

```
 NSArray *array = [[NSArray alloc] initWithObjects:
                      [UIImage imageNamed:@"logo_001.png"],
                      [UIImage imageNamed:@"logo_002.png"],
                      [UIImage imageNamed:@"logo_003.png"],
                      nil];

    self.imageViewLogo.image = [array lastObject];
    self.imageViewLogo.animationImages = array;
    self.imageViewLogo.animationDuration = 1;
    self.imageViewLogo.animationRepeatCount = 1;
    [self.imageViewLogo startAnimating]; 
```

在这种情况下，我应该如何处理视网膜@2x 图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:21:04.730

如果您有视网膜图像：

```
logo_001@2x.png
logo_002@2x.png
logo_003@2x.png 
```

你不需要做任何事情。`[UIImage imageNamed:]`将为非视网膜设备返回原始图像，为视网膜设备返回 2x 图像。

# c - 我是否正确理解 getopt() ？

> ID：13767888
> 
> 赞同：-1
> 
> 时间：2012-12-07T17:17:53.917
> 
> 标签：c, getopt

我正在尝试扫描命令行中的某些字母、符号和值。我想扫描`"-w"`、 一个数字和`"-s"`。我在上一个问题中得到了答复，我被告知要使用`getopt()`，经过一番谷歌搜索后，我想我可能会明白，但我不确定。

这就是我认为我正在做的事情：

```
int c = 0; 
int b = argv[2];

while((c = getopt(argc, argv, "-w", "-s", b)) 
```

我想我正在扫描`argc`,`"-w"`和值（即数字）`"-s"`。`argv[2]`但我不知道我是否正确使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:25:52.850

你的while循环应该是 `while ((c = getopt(argc, argv, "w:s:"))`

`:`冒号意味着它需要一个参数。现在转换`optarg`为整数或任何你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:30:51.233

```
int number = 0;
int sflag = 0;
int opt;

while ((opt = getopt(argc, argv, "w:s")) != -1)
{
    switch (opt)
    {
    case 's':
        sflag = 1;
        break;
    case 'w':
        number = atoi(optarg);
        break;
    default:
        /* Report usage and exit? */
        break;
    }
} 
```

数字上的转换是惰性的；例如，您可以更仔细地调用调用 的函数`strtol()`。您可能需要一个`wflag`与变量类似设置的`sflag`变量，以便您可以区分“命令行上`-w 0`未指定选项”。`-w`

# objective-c - 从类 X 的布尔值在从类 Y 的视图控制器到类 Z 的视图 控制器的更改之间不会持续存在

> ID：13767890
> 
> 赞同：0
> 
> 时间：2012-12-07T17:17:57.077
> 
> 标签：objective-c, ios

在课堂上`GHHaiku`我`BOOL`有财产`justComposed`。

在`mySecondViewControllerClass`我有以下方法：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    if (!self.ghhaiku)
    {
        self.ghhaiku = [[GHHaiku alloc] init];
    }
    //Lots of other code
}

-(void)saveUserHaiku
{
    //Lots of code
    self.ghhaiku.justComposed=YES;
    NSLog(@"%d",self.ghhaiku.justComposed);
    [self.tabBarController setSelectedIndex:0]; //This switches to `myFirstViewController`
} 
```

在`myFirstViewController`我有以下方法：

```
-(void)viewDidLoad
{
[super viewDidLoad];
    if (!self.ghhaiku)
    {
        self.ghhaiku = [[GHHaiku alloc] init];
    }
}

- (void) viewWillAppear:(BOOL)animated
{
    NSLog(@"%d",self.ghhaiku.justComposed);
    if (self.ghhaiku.justComposedYes==YES)
    {
        [super viewWillAppear:animated];
        self.displayHaikuTextView.text = [[self.ghhaiku.arrayOfHaiku lastObject] valueForKey:@"quote"];
    }
} 
```

`BOOL`in显示1/是`saveUserHaiku`。但是 in中`mySecondViewController`的布尔值显示 0/no。`viewWillAppear``myFirstViewController`

我遗漏了什么？

**编辑：**

这就是我最终要完成的事情：

`myFirstViewController`中实例`GHHaiku`化`viewDidLoad`。然后它`arrayOfHaiku`在那个实例上创建并用 x 个俳句加载它。

`saveUserHaiku`中的方法`mySecondViewController`向该数组添加一个俳句，设置一个布尔值`justComposed' to`YES `, and then programmatically switches view controllers back to`myFirstViewController`。

一旦我们回到 in `myFirstViewController`，`viewWillAppear`调用某个函数 if `justComposed`in `mySecondViewController`is `YES`。

两个视图控制器都是在 Interface Builder 中创建的。

**第二次编辑：** 如果重要，这是一个选项卡式应用程序。 `saveUserHaiku`更改选项卡。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:30:58.173

看来您正在创建单独的 ghhaiku 实例 - 您的两个视图控制器中的每一个都有一个。如果您想在两个视图控制器之间使用相同的 ghhaiku 对象（从而记住 justComposed 布尔值），则需要在创建视图控制器时将 ghhaiku 属性设置为现有对象。不要在 viewDidLoad 中分配/初始化一个新的。

例如，如果要显示 myFirstViewController 中的 mySecondViewControllerClass，它可能如下所示：

```
mySecondViewControllerClass *secondViewController = [[mySecondViewControllerClass alloc] initWithNibName:nil bundle:nil];
secondViewController.ghhaiku = self.ghhaiku; // pass the ghhaiku object to the other view controller
[self presentModalViewController:secondViewController animated:YES]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:26:26.997

为什么它应该具有除 NO 之外的其他值？你有两个不同的课程。在其中一个中，您将类成员的值设置为 YES。然后在另一个类中检查具有相同名称的变量的值，但它不同，并且您从不为其分配任何内容，默认情况下为 NO

# c# - C#中的运算符重载约束

> ID：13767892
> 
> 赞同：0
> 
> 时间：2012-12-07T17:18:05.683
> 
> 标签：c#, operator-overloading

Q) 为什么在 C# 中的运算符重载中需要“public”和“static”？

试过这篇文章

[http://blogs.msdn.com/b/ericlippert/archive/2007/05/14/why-are-overloaded-operators-always-static-in-c.aspx](http://blogs.msdn.com/b/ericlippert/archive/2007/05/14/why-are-overloaded-operators-always-static-in-c.aspx)

但是有人能解释一下作者想说什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:30:38.220

作者以非静态方式对运算符重载的潜在特征进行了简单的成本/收益分析，并得出结论，收益并不能证明成本是合理的：您可以通过分派到虚拟的方式轻松模仿运算符实例重载的功能静态重载运算符内部的方法。但是，让您在没有中间虚函数的情况下定义重载运算符的成本很高：

*   您在操作员的工作方式中引入了不对称性（`2+c`可能是非法的，但`c+2`可以）
*   您需要处理`null`左侧的引用
*   无论如何，单一调度不会解决您的问题，因此您最终会在操作员内部进行额外的调度工作

最后，作者指出，与其引入一个会带来很多混乱但没有显着好处的功能，他们选择了一种更简洁的设计，可以扩展以提供可比较的功能级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:26:40.193

Public 是必需的，以便可以在类之外访问它。静态是必要的，因为不在类的实例上调用它。

```
public class B {
    public static B operator+(B b1, B b2) { return b1.Add(b2); }
    protected virtual B Add(B b2) { // ... 
```

对于上面的例子，我可以有类似的代码`b3 = b1 + b2`，这里 + 运算符不会在 B 类的任何一个实例上调用，所以它需要是静态的。希望这可以帮助。

# facebook - 向 App Center 提交移动应用程序的问题

> ID：13767896
> 
> 赞同：1
> 
> 时间：2012-12-07T17:18:24.413
> 
> 标签：facebook

我已经在 FB 开发人员仪表板的设置选项卡下填写了我的应用程序的所有基本详细信息。我已确保已选择 Native iOS App 选项并填写了所有相关详细信息（Bundle ID、App Store ID 等）。接下来，我单击“应用程序详细信息”选项卡并填写该页面上的所有信息，然后单击“提交应用程序详细信息页面”按钮。执行此操作后，我收到一条错误消息，指出“在设置您的应用详细信息页面之前，您必须指定您的应用如何与 Facebook 集成。单击此处访问您的应用设置页面以管理您的集成。” 单击此链接只会将我带回到我已经填写的基本设置页面。我在 App Center 上搜索过该应用，可以确认它尚未添加到目录中。

# python - 通过从文本文件中导入残基列表，使用 PyMol 脚本选择蛋白质中的保守残基

> ID：13767900
> 
> 赞同：1
> 
> 时间：2012-12-07T17:18:36.410
> 
> 标签：python, bioinformatics, pymol

我想使用 PyMol 脚本选择蛋白质中某些高度保守的残基（通过评分机制计算并在文本文件中列出 - 每个残基在一行中）。我正在使用的下面的 PyMol 脚本不起作用。如果有人可以帮助我，我将非常感激你。

单独运行时，部分脚本工作得非常好 - Pymol 脚本在脚本中提到残基数时没有从文本文件中导入列表，而仅用于将数字从文件加载到数组中的 python 脚本在运行时也可以正常工作分别地。但是当它在下面的脚本中组合时就会出现问题 - 当需要从数组中获取残基数时，就像我在从文本文件中导入列表之后一样。任何帮助表示赞赏。谢谢！

```
#!/usr/bin/python
from pymol import cmd
import string
cmd.load("/home/xyz/proteinA.pdb", 'protein')

f=open('/home/xyz/residuedata.txt','r')
array = []
filecontents = f.read().split()
for val in filecontents:
        array.append(int(val))
f.close()
for i in array:
    cmd.select("residuedata", "resi i")
    cmd.show('sphere', "residuedata")
    cmd.color ('red', "residuedata") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-03T11:22:11.217

该`"resi i"`字符串不知道您的`i`变量。

你打算这样做吗？

```
for i in array:
    cmd.select("residuedata", "resi {}".format(i)) 
```

# wpf - WPF DataGrid 匹配所有列的总宽度

> ID：13767904
> 
> 赞同：0
> 
> 时间：2012-12-07T17:18:44.970
> 
> 标签：wpf, wpfdatagrid

我的 DataGrid 绑定到一个不能在运行时更改的集合。我想确保在调整 DataGrid 列的大小时，列的总宽度不会长于 DataGrid 的宽度，这样一列就不会消失，也不会出现水平滚动，永远不会找到答案。
所以我想不，如果有一种方法可以将我的 DataGrid 宽度绑定到他的列的总宽度，这样我就可以使列无法调整大小并且仍然将列宽设置为“自动”，因此列时不会丢失任何数据不可调整大小？
或者我没有找到的第一个选项 - 限制列的调整大小，以便它们的总宽度不会更长？
非常感谢，请不要使用代码隐藏解决方案。

# sql - 使用 PostgreSQL 中的查询结果更新列

> ID：13767908
> 
> 赞同：15
> 
> 时间：2012-12-07T17:18:53.357
> 
> 标签：sql, database, postgresql, sql-update, postgresql-9.2

我在 PostgreSQL 9.2 中有下表，其中包含时间戳：

**gid [PK] (bigserial), timestamp_mes (timestamp without time zone), time_diff (interval)**
1, 2012-01-23 11:03:40, empty
2, 2012-01-23 11:03:42, empty
3, 2012-01-23 11:03:44，空

我添加了一个间隔列 (time_diff)，并希望用此查询产生的时差值填充它：

```
SELECT timestamp_mes - lag(timestamp_mes, 1) 
over (order by timestamp_mes) as diff
from gc_entretien.trace order by timestamp_mes 
```

我尝试了以下查询来更新 time_diff 列，但没有成功：

```
UPDATE gc_entretien.trace set time_diff = 
(SELECT trace.timestamp_mes - lag(trace.timestamp_mes, 1) 
over (order by trace.timestamp_mes) 
from gc_entretien.trace order by timestamp_mes); 
```

这会导致错误：

> 错误：用作表达式的子查询返回多行

我应该如何继续使用时差查询产生的值更新 time_diff 列？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-12-07T19:32:09.700

像这样的东西：

```
with new_values as (
   SELECT gid, 
          timestamp_mes - lag(timestamp_mes, 1) over (order by timestamp_mes) as diff
   from gc_entretien.trace 
)
update gc_entretien.trace as tr
  set time_diff = nv.diff
from new_values nv
where nv.gid = tr.gid; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-07T19:36:23.100

您不能直接在 UPDATE 中使用窗口函数，因此您需要在子 SELECT 中使用它 - 您已经完成了。但是，您尝试在 UPDATE 中使用该子 SELECT 的方式不是有效的语法。您需要将 sub-SELECT 放在更新的 FROM 子句中，如 Postgres docs here 所述：

[http://www.postgresql.org/docs/9.2/static/sql-update.html](http://www.postgresql.org/docs/9.2/static/sql-update.html)

您想要做的正确语法是：

```
UPDATE gc_entretien.trace t
SET time_diff = subquery.diff
FROM (SELECT {{SomeUniqueId}}, 
             timestamp_mes - lag(timestamp_mes, 1) over (order by timestamp_mes) as diff
      FROM gc_entretien.trace order by timestamp_mes) AS subquery
WHERE t.{{SomeUniqueId}} = subquery.{{SomeUniqueId}} 
```

显然，您需要用我写的行所具有的某个唯一 id 的列名替换`{{SomeUniqueId}}`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T17:30:17.977

实际上，您收到此错误是因为您的子查询返回多个结果，

我无法理解您的查询，所以，

我给你一个例子来解决它，

```
update table t1 set time_diff= select *your_operation* from table t2 where t1.id=t2.id 
```

**这里**:-your_operation 表示查找时差的逻辑，

# java - 多模块 Maven 项目中的 log4j

> ID：13767911
> 
> 赞同：4
> 
> 时间：2012-12-07T17:19:06.520
> 
> 标签：java, jakarta-ee, maven, log4j

如何在多模块 Maven 项目中实现 log4j？我是否将“log4j.properties”文件添加到每个子模块的 src/main/resources 目录中？如果是这样，我是否必须为每个文件附加程序指定不同的输出文件？或者有没有一种方法可以为整个项目提供一个总体 log4j.properties 文件，而不会出现配置噩梦。哪种方法（许多 log4j.properties 文件而不是一个）是更常见和更好的做法？提前感谢所有反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:22:48.427

这取决于您打算如何部署和运行此项目。对于分层多模块项目，我们通常在模块中包含一个 log4j 配置文件以及`main`启动程序的方法。

例如，考虑一个项目的简化设置，`client`它们`server`都依赖于`framework`公共类（RMI 接口、域对象等）。客户端作为桌面应用程序运行，有自己的`main`入口点，因此在 src/main/resources 下获得自己的 log4j.properties 文件。服务器模块也是如此。然而，框架**没有**获取属性文件——它的记录器调用将由其调用模块配置的任何记录器处理。

# azure-storage - Azure 表存储延迟

> ID：13767913
> 
> 赞同：1
> 
> 时间：2012-12-07T17:19:15.773
> 
> 标签：azure-storage

我正在使用 Azure 表存储开发一个项目。我正在尝试记录我的 webrole 和表存储之间的网络延迟。有谁知道我在哪里可以找到一些可用于估算的初步数字？

谢谢 JThomas

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T18:48:41.063

这取决于您的表实体是在哪一代 Azure 存储中创建的。以下是两者的信息：http: [//blogs.msdn.com/b/windowsazure/archive/2012/11/02/windows-azure-s-flat-network-storage-and-2012-scalability-targets.aspx](http://blogs.msdn.com/b/windowsazure/archive/2012/11/02/windows-azure-s-flat-network-storage-and-2012-scalability-targets.aspx)

它具有可扩展性目标和一些网络信息。网络延迟是可变的，但有一些方法可以缓解它：将 Web 角色/表存储放置在同一数据中心位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T18:58:04.920

有趣的是，如果 VM 和存储帐户都在同一个数据中心，我预计延迟在 10 到 30 毫秒之间。

# iphone - 如何在我的视图控制器中显示 Tapku

> ID：13767914
> 
> 赞同：1
> 
> 时间：2012-12-07T17:19:17.460
> 
> 标签：iphone, objective-c, ios, xcode, tapku

我有一个在主屏幕上有一个图标的应用程序，它对我的​​视图控制器进行了 segue。我有`UIViewController`一个视图和一个导航栏。我正在尝试显示日历，但它没有出现。

我`UIViewController`被调用`ViewCOntrollerCalendar`并且在`init`方法中我正在执行以下操作：

```
calendar = [[TKCalendarMonthView alloc] init];
calendar.delegate = self;
calendar.dataSource = self; 
```

然后在我`viewDidLoad`做这个：

```
[self.view addSubview:calendar];
[calendar reload]; 
```

但日历从未出现。我已经查看了一个示例，但我找不到任何基于按钮加载日历的内容。我对 Xcode 相当陌生，所以我确信我错过了一些愚蠢的东西。

我想让日历显示在顶部的导航栏。

任何帮助，将不胜感激。

谢谢

# javascript - 未捕获的 ReferenceError：PhoneGap 未定义

> ID：13767915
> 
> 赞同：0
> 
> 时间：2012-12-07T17:19:24.160
> 
> 标签：javascript, android, cordova, phonegap-plugins

我遇到了一个关于 phonegap 使用的奇怪问题。LogCat 吐出一个未捕获的参考错误，关于未定义 phonegap 正在杀死我的应用程序。我正在运行cordova 2.2，而且我对phonegap 很陌生。有谁知道可能导致这种情况的原因？科尔多瓦文件作为一个包被热加载到我的应用程序中，但即使我切换它并在 html 中静态加载它，我仍然会收到错误消息！请帮忙！

```
 CordovaLog: Uncaught ReferenceError: PhoneGap is not Defined 
```

这主要发生在我使用 Brody 的 SQLite 插件时，但它也发生在其他 phonegap 功能中。此外，如果我为设备就绪添加事件侦听器，它永远不会触发！（我猜它在添加监听器之前已经被触发了，因为它嵌套得很深。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T18:30:48.807

您正在使用一些过时的代码，PhoneGap 对象现在是“cordova”。您应该寻找该插件的更新版本。

# jquery - 如何使用像 * 来匹配 id 的 jquery 选择

> ID：13767917
> 
> 赞同：0
> 
> 时间：2012-12-07T17:19:36.793
> 
> 标签：jquery

我的页面上有一堆单选按钮的 id：

id="scores_0" id="scores_1" 等等。我是 jquery 的新手，想知道是否有办法喜欢选择任何匹配的东西。

```
$("#scores_*").css("border", "2px none black") 
```

ETC ？
还是我必须以某种方式动态正则表达式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T17:22:41.610

试试下面

```
$('input[id^=scores_]'); //^= StartsWith
$('input[id*=scores_]'); //*= Contains 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T17:21:10.893

在此处阅读有关 jQuery 选择器的信息[http://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

```
$('[id^=scores_]') // <-- this selects all id starting with scores_ 
```

# javascript - ajax调用后Jquery事件不会触发

> ID：13767919
> 
> 赞同：72
> 
> 时间：2012-12-07T17:19:38.930
> 
> 标签：javascript, jquery, html, dom-events

这是 jquery 的一个相当奇怪的问题。我正在加载一个 div

```
<div id="container"> 
```

在页面加载。每条记录都是表格数据，并带有与之关联的“删除”ajax 函数。当页面加载并单击“删除”链接时，ajax 调用就会很好地触发。但是，一旦触发事件，则从 ajax 调用返回数据，并用数据填充 div（但页面不会刷新或重新加载）当我再次单击链接时，ajax 脚本将不会触发。这是我的代码：

```
$(document).ready(function() {
    $("button.done").button({
    }).click(function() {
        var BatchID = $("input#BatchID").val();
        var Amount = $("input#Amount").val();
        var Name = $("input#CheckName").val();
        var Check_Number = $("input#Check_Number").val();
        var Company = $("select#Company").val();
        var Department = $("select#Department").val();
        $.ajax({
            type: 'GET',
            url: '/app/usagCheckEntryWS.html',
            data: {
                "BatchID" : BatchID,
                "Amount" : Amount,
                "Name" : Name,
                "Check_Number" : Check_Number,
                "Company" : Company,
                "Department" : Department
            },
            success: function (data) {
                    var ang = '';
                    var obj = $.parseJSON(data);
                    $.each(obj, function() {
                       ang += '<table><tr><td width="45">' + this["RefID"] + '</td><td width="140">' + this["Name"] + '</td><td width="95">' + this["CheckNumber"] + '</td><td align="right" width="70">$' + this["Amount"] + '</td><td width="220" style="padding-left: 15px;">' + this["Description"] + '</td><td><div class="delete" rel="' + this["RefID"] + '"><span>Delete</span></div></td></tr></table>';
                    });
                    $('#container').html(ang);
                    $("input#Amount").val('');
                    $("input#CheckName").val('');
                    $("input#Check_Number").val('');
                    $("select#Company").val('MMS');
                    $("th#dept").hide();
                    $('input#CheckName').focus();
            }
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2012-12-07T17:23:21.520

当您删除一个元素然后替换它（通过 javascript）时，它会丢失在页面加载时添加到它的任何事件绑定。

（这也适用于页面加载后添加到页面的内容 - 即 ajax 加载的内容）

对此有几种可能的解决方案。

1）封装您的“绑定”代码，并在页面加载时以及相关元素添加回页面后立即调用它。例如：

```
$(document).ready(function(){
    // bind event handlers when the page loads.
    bindButtonClick();
});

function bindButtonClick(){
    $('.myClickableElement').click(function(){
        ... event handler code ...
    });
}

function updateContent(){
    $.ajax({
        url : '/ajax-endpoint.php',
        data : {'onMyWay' : 'toServer'},
        dataType : 'html',
        type : 'post',
        success : function(responseHtml){
            // .myClickableElement is replaced with new (unbound) html element(s)
            $('#container').html(responseHtml);

            // re-bind event handlers to '.myClickableElement'
            bindButtonClick();  
        }
    });
} 
```

2)**更优雅的处理方式**：使用[jQuery 的 .on() 方法](http://api.jquery.com/on/)。使用它，您可以将事件处理程序绑定到事件目标以外的元素 - 即永远不会从页面中删除的元素。

```
$(document).ready(function(){
    $('body').on('click','.myClickableElement',function(){
        ... event handler code ....
    });
}); 
```

**一些进一步的解释：**

该`.on()`方法使用***[事件委托](http://learn.jquery.com/events/event-delegation/)***来告诉父元素保留您的事件处理程序代码（第三个参数），并在事件目标（第二个参数）对其执行某种类型的事件（第一个参数）时触发它。

如果您使用的是 1.7 之前的 jQuery 版本，请使用现在已弃用的[委托](http://api.jquery.com/delegate/)方法，它本质上做同样的事情。

此外，值得注意的是，由于事件通过 dom 树“冒泡”的方式，事件目标（.on() 方法的第二个参数）必须是委托元素（jQuery 对象的选择器）的后代。例如，**以下内容将不起作用**

```
<div id="container-1">
    <div>
        <div id="another-div">
            Some Stuff
        </div>
    </div>
</div>

<div id="container-2">
    <a id="click-me">Event Target!!!</a>
</div>

<script type="text/javascript">
    $('#container-1').on('click','#click-me',function(){
        ... event handler code ....
        // This will never execute, should've used '#container-2', or 'body', or 'document' instead of '#container-1'
    });
</script> 
```

`body`or`document`元素通常是安全的选择，因为通常页面上的每个元素都是后代。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-25T12:58:34.973

您可以将事件脚本包含在 DIV 中，并在动态加载内容后运行 Replaceall 命令。

```
<div class="somescript">
-- Event Script that you want to map with dnamically added content
<div> 
```

-- 动态加载您的内容并在其后运行以下命令。

```
$(".somescript").replaceAll($(".somescript")); 
```

加载动态加载的内容并运行替换命令后，将映射事件并且代码将正常运行。

# c - 如何使用 libcurl 检测摘要身份验证失败？

> ID：13767922
> 
> 赞同：0
> 
> 时间：2012-12-07T17:19:46.730
> 
> 标签：c, libcurl

当我们发送一条 http 消息时：

```
res= curl_easy_perform(curl); 
```

如果使用错误的登录名或密码发送 http 消息，如何检测 libcur 的身份验证失败？

我检查了`res`成功和失败的值，发现它= 0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T18:20:16.497

`curl_easy_perform``0`如果请求成功通过，将返回。

错误的身份验证通常会导致 401 Unauthorized HTTP 响应代码。但是，cURL 不会将其视为请求错误。请求错误的一个示例是`CURLE_URL_MALFORMAT`，如果您的请求 URL 格式不正确，则会返回该错误，这意味着该请求甚至没有到达远程服务器。

如果响应代码大于或等于 400，有些人可能会建议您使用`CURLOPT_FAILONERROR`make fail。但是，libcurl 文档明确警告您：`curl_easy_perform`

> 此方法不是万无一失的，有时会出现不成功的响应代码，尤其是在涉及身份验证时（响应代码 401 和 407）。

检查身份验证错误的正确方法是使用`curl_easy_getinfo`获取 HTTP 响应代码，例如：

```
CURLcode res = curl_easy_perform(curl);
long httpCode = 0;
curl_easy_getinfo(curl, CURLINFO_RESPONSE_CODE, &httpCode); 
```

# f# - Interop DLL 的实例化接口

> ID：13767924
> 
> 赞同：3
> 
> 时间：2012-12-07T17:19:57.810
> 
> 标签：f#

我正在使用一些互操作代码，需要实例化一个接口。

C# 中的等价物是：

```
Interop.SomeInterface theInterface;
theInterface = new Interop.SomeInterface();
theInterface.SomeEvent += new SomeEventHandler(...); 
```

如何在 F# 中完成对这个接口的实例化？我是否需要将此互操作 dll 重新包装成 F# 可以理解的东西？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T17:31:03.353

实例化接口是不可能的。[C# 编译器](https://stackoverflow.com/questions/2482508/creating-instance-of-interface-in-c-sharp)通过查找接口的实现者来实例化一个类。这是由编译器检查[`CoClassAttribute`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.coclassattribute.aspx).

据我所知，F# 对 . 什么一无所知`CoClassAttribute`，因此您需要更改代码，以便它实例化一个实际的类，而不是一个接口。

您可以通过使用 Reflector、ILdasm 或任何其他元数据检查器查看 SomeInterface 上的 CoClassAttribute 来找出您需要的类。如果互操作包装器是使用 tlbimp 或 Visual Studio 生成的，则通常该类将按照约定命名为 SomeInterfaceClass。

# php - 我无法访问我的 php 页面上的链接

> ID：13767927
> 
> 赞同：0
> 
> 时间：2012-12-07T17:20:03.620
> 
> 标签：php

我正在`view_category.php`为我的论坛创建一个页面，但我遇到了一个小问题我的链接不起作用我正在登录但页面显示我没有登录它对待我就像我只是查看论坛的客人一样因此我无法在论坛上创建主题，我的 create_topic.php 链接无法访问。

这是我下面的代码

```
// Assign local variables
$cid = $_GET['cid'];

// Check to see if the person accessing this page is logged in
if (isset($_SESSION['uid'])) {
    $logged = " | <a href='create_topic.php?cid=".$cid."'>Click Here To Create A Topic</a>";
} else {
    $logged = " | Please log in to create topics in this forum.";
} 
```

为什么会这样？？

我只是包括

```
var_dump($_SESSION); 
```

这是输出

```
 array(2) { ["username"]=> string(7) "mura" ["password"]=> string(4) "1234" } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T17:21:37.220

放在`session_start();`文件头

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:41:19.887

更改`if (isset($_SESSION['uid']))`为`if (isset($_SESSION['username']))`?

您当前有关用户的会话信息存储在`$_SESSION['username']`, not`$_SESSION['uid']`中，因此您可以使用用户名来检查用户是否已登录，或者在用户登录时将 uid 放入会话中。

顺便说一句，不要在会话中输入您的密码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T17:41:24.000

你在做

```
isset($_SESSION['uid']) 
```

但是当您执行 var_dump 时，该值不在转储中。您需要在某个时候将其添加到您的会话中（在执行 isset() 之前）。

在不相关的说明中，在会话中保存密码是不安全的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T17:42:49.883

根据您刚刚显示的输出，您似乎发现了问题。您设置了两个变量：

```
"username"
"password" 
```

在您上面的解决方案中，尽管您尝试引用：

```
$_SESSION['uid'] 
```

这似乎不存在。要么您没有创建此变量，要么没有正确设置它。无论哪种方式，逻辑都在做它应该做的事情。该变量未设置，因此您永远不会看到“创建”链接。尝试更改逻辑以指向您已经设置的两个变量之一，或为“$_SESSION['uid']”变量分配一个值。

希望这可以帮助。

# spring - 在 Spring 中创建实例化 bean 的列表

> ID：13767930
> 
> 赞同：0
> 
> 时间：2012-12-07T17:20:11.317
> 
> 标签：spring

我有一个bean员工：

```
public class Employee {
    private int empId;
    public int getEmpId() {
        return empId;
    }
    public void setEmpId(int empId) {
        this.empId = empId;
    }
} 
```

一个 EmployeeList 类，如下所示：

```
public class EmployeeList {
    @Autowired
    public Employee[] empList;
} 
```

弹簧配置文件：

```
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans 
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/context
           http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <context:annotation-config/>

 <bean class="org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor"/>

    <bean id="empBean" class="Employee" scope="prototype">
    </bean>
    <bean id="empBeanList" class="EmployeeList">
    </bean>
 </beans> 
```

主要方法类：

```
public class App 
{

    public static void main( String[] args )
    {
        ApplicationContext empContext = new ClassPathXmlApplicationContext(
                "employee-module.xml");

        EmployeeList objList = (EmployeeList) empContext.getBean("empBeanList");

        Employee obj = (Employee) empContext.getBean("empBean");
        obj.setEmpId(1);
        System.out.println(obj.getEmpId());
        System.out.println("length " + objList.empList.length);

        Employee obj1 = (Employee) empContext.getBean("empBean");
        obj1.setEmpId(2);
        System.out.println(obj1.getEmpId());
        System.out.println("length " + objList.empList.length);

        Employee obj2 = (Employee) empContext.getBean("empBean");
        System.out.println("length " + objList.empList.length);
    }
} 
```

我得到的Employee实例的计数总是1。为什么当我多次得到bean实例时它没有增加。Employee bean 具有作为原型的作用域。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:51:34.077

因为获得一个新的原型实例并不会神奇地将它添加到先前实例化的 bean 数组中。

当上下文启动时，单个员工 bean 被实例化并注入到`empBeanList`bean 中，然后创建 empList bean 并且不再更改。

# objective-c - iOS mapview - 添加注释时出现问题

> ID：13767933
> 
> 赞同：0
> 
> 时间：2012-12-07T17:20:21.203
> 
> 标签：objective-c, ios, mkmapview, mapkit

尝试为 a 添加一些注释`MapView`，但不断遇到 ARC 语义问题：**'没有可见的 @interface for 'MKPointAnnotation' 声明了选择器 initWithTitle:andCoordinate：**

我对此很陌生，所以真的不知道这意味着什么，如果有人能解释/纠正它，我将不胜感激。

这是我的`viewDidLoad`方法：

```
- (void)viewDidLoad
{
    CLLocationCoordinate2D location;
    location.latitude = (double) 51.501468;
    location.longitude = (double) -0.141596;

    MKPointAnnotation *newAnnotation = [[MKPointAnnotation alloc] initWithTitle:@"Buckingham Palace" andCoordinate:location];
    [self._mapView addAnnotation:newAnnotation];

} 
```

和我的头文件：

```
#import <Foundation/Foundation.h>
#import <MapKit/MapKit.h>

@interface MapViewAnnotation : NSObject <MKAnnotation> {

NSString *title;
CLLocationCoordinate2D coordinate;

}

@property (nonatomic, copy) NSString *title;
@property (nonatomic, readonly) CLLocationCoordinate2D coordinate;

- (id)initWithTitle:(NSString *)ttl andCoordinate:(CLLocationCoordinate2D)c2d;

@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:38:50.713

您创建的 initWithTitle:andCoordinate 方法是 MapViewAnnotation 的方法，而不是 MKPointAnnotation。

你可能想要：

```
MapViewAnnotation *newAnnotation = [[MapViewAnnotation alloc] initWithTitle:@"Buckingham Palace" andCoordinate:location];
[self._mapView addAnnotation:newAnnotation]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:30:11.780

它试图告诉你它找不到任何与 initWithTitle:andCoordinate 的签名匹配的方法：

```
MKPointAnnotation *annotation = [[MKPointAnnotation alloc] init];
[annotation setCoordinate:coordinate];
[annotation setTitle:@"Buckingham Palace"]; 
```

# ruby-on-rails-3 - 如何在正确的位置安装 rails bundle

> ID：13767935
> 
> 赞同：0
> 
> 时间：2012-12-07T17:20:22.283
> 
> 标签：ruby-on-rails-3

我是用自制软件安装`ruby-1.9.3`的，所以它位于`/usr/local/Cellar/ruby/1.9.3-p286/`.

由 rvm安装后`Rails`，我执行命令`bundle install`，但捆绑包都安装到`/Library/Ruby/Gems/1.8/gems`我的 OS X 上安装的旧版本 ruby​​。

我该怎么做才能让捆绑包安装在正确的位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:29:07.693

试试这个

```
$ rvm use 1.9.3--system 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T17:56:30.853

使用[rvm](https://rvm.io/)或[rbenv](http://rbenv.org/)来管理不同版本的 ruby​​。您也可以考虑[JewelryBox](http://jewelrybox.unfiniti.com/)，它的功能几乎相同，但 GUI 更漂亮。

# ruby-on-rails - 在 Ruby on Rails 中获取关系 n:m 的对象

> ID：13767937
> 
> 赞同：0
> 
> 时间：2012-12-07T17:20:25.537
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有两个模型：

1.  文件
2.  模数

并且它们之间的关系是：Many to Many，有一个表来映射关系：modulos_perfiles

我需要得到属于“perfil”的所有“模数”。我有这个：

```
<% @perfiles.each do |perfil| %>
    <% @m = perfil.modulo.last %>
    <%= @m.ruta %><br/>
<% end %> 
```

但我收到此错误：

> **nil:NilClass 的未定义方法“ruta”**

其中“ruta”是“模”表的一列。

我做的：

```
<% @perfiles.each do |perfil| %>
    <% @m = perfil.modulo.last %>
    <%= debug @m %><br/>
<% end %> 
```

我可以看到 @m 对象的所有属性，所以：

红宝石/对象：模

属性：

*   编号：7
*   描述：布斯克达斯
*   芸香：/busquedas
*   created_at: 2012-11-25 02:23:51.984916000 Z
*   更新时间：2012-11-25 02:23:51.984916000 Z

但我不明白为什么我无法通过以下方式获得此属性：

```
<%= @m.ruta %> 
```

有什么想法吗，谢谢！

**更新**

我的模型类是：

```
class Perfil < ActiveRecord::Base
    has_many :usuario
    has_and_belongs_to_many :modulo
end

class Modulo < ActiveRecord::Base
    has_and_belongs_to_many :perfiles
end

class ModulosPerfiles < ActiveRecord::Base
end 
```

**

## 回答

**

我没有足够的声誉来发布答案。

我已经解决了：

我做的：

```
<% @perfiles.each do |perfil| %>
    <% perfil.modulo.each do |modulo| %>
        <%= modulo.ruta %><br/>
    <% end %>
<% end %> 
```

所以我可以得到对象“模”的任何属性。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:49:07.063

```
<% @perfiles.each do |perfil| %>
    <% perfil.modulo.each do |modulo| %>
        <%= modulo.ruta %><br/>
    <% end %>
<% end %> 
```

# c - 为什么12位未初始化的int变量总是0xff0？

> ID：13767938
> 
> 赞同：1
> 
> 时间：2012-12-07T17:20:27.740
> 
> 标签：c, gcc

当我尝试向我的朋友解释一些简单的代码时，发生了一些奇怪的事情：

```
#include <stdio.h>
int main() 
{
    int x;
    printf("%x\n",x);
} 
```

我已经尝试了数百万次，x 的最后 12 位始终是 0xff0。我已经解除了代码，但仍然无法弄清楚这里发生了什么

我的操作系统是 ubuntu10.10，编译器是 gcc4.7.2

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T17:21:03.790

读取未初始化的变量是未定义的行为。所以你什么都没有保证。

这包括始终为零、始终均匀、始终不同以及重新格式化硬盘。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T17:44:03.527

首先，如果该值始终与 0xFF0 匹配，则“低 12 位”是该值，而不是低 3。

至于为什么会发生这种情况，您正在读取一个尚未初始化的变量。这是未定义的行为，当您尝试执行此操作时，任何事情都可能发生，从崩溃到披萨送达。

但*实际*发生的是：x 引用的位置有一些它之前保存的数据。很可能在您的设置中，该变量恰好包含低 12 位为 0xFF0 的数据；在这种情况下，它很可能是与先前的系统调用相关联的数据，在调用您之前由系统完成的处理工作期间`main`。

长话短说：**在使用变量之前初始化变量，不要问为什么未初始化的变量具有它们的值。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T17:43:20.897

该值始终相同，因为您的程序是*确定性*的。

未初始化变量的值正式“未定义”，但在始终执行完全相同的步骤的程序中，它很可能是*可预测*的。在这种情况下，事实证明，在 main 之前使用该寄存器或堆栈槽的任何东西都需要您看到的值。

一个程序唯一不具有确定性的情况是它与其他不确定的事物（例如用户、可更改文件或网络）交互。然而，如果没有任何外部刺激，线程程序可能是不确定的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T17:52:50.817

> 我发现它不仅仅是偶数，最后 3 位总是结果是

也许之前存储在堆栈上那个位置的东西是指向堆分配内存的指针的值，或者类似的东西（堆分配的块通常四舍五入到边界，例如8字节边界）。

# jquery - 在 onclick 事件中触发引导弹出窗口

> ID：13767946
> 
> 赞同：3
> 
> 时间：2012-12-07T17:20:54.370
> 
> 标签：jquery, twitter-bootstrap

如何在 onclick 事件中触发弹出窗口？

```
jQuery(document).ready(function($) { 
    $('[rel=popover]').popover().click(function(e) {e.preventDefault()});
});

<button class="btn" rel="popover" data-placement="bottom" data-trigger="manual" data-content="somecontent" data-original-title="Title" type="button" onclick="if(something==true) { console.log($(this));$(this).popover('show'); }">Start</button> 
```

这只是给我一个“未捕获的类型错误：未定义不是函数”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:58:18.597

删除您的 onclick，您可以根据文档[http://twitter.github.com/bootstrap/javascript.html#popovers在您的选项中指定触发器](http://twitter.github.com/bootstrap/javascript.html#popovers)

```
$('[rel=popover]').popover({trigger:'click'}) 
```

或在您的 html 中指定它

```
<button class="btn" rel="popover" data-placement="bottom" data-trigger="click" 
```

# python - 数据框中缺少数据

> ID：13767950
> 
> 赞同：1
> 
> 时间：2012-12-07T17:21:07.643
> 
> 标签：python, numpy, pandas

我正在尝试将较小的列添加`len`到`DataFrame`较小项目的索引是较大项目的子集的地方。因此，如果 RIMM 每天都有数据，但总有一天 GOOG 会丢失。我想将 RIMM 添加到带有标题 GOOG 的矩阵中

```
 GOOG
03/12/2012    1
29/11/2012    1
26/11/2012    1

             RIMM    
03/12/2012    1       
30/11/2012    1
29/11/2012    1       
28/11/2012    1
27/11/2012    1
26/11/2012    1 
```

所以它看起来像这样

```
 RIMM    GOOG
03/12/2012    1       1
30/11/2012    1      NaN
29/11/2012    1       1
28/11/2012    1      NaN
27/11/2012    1      NaN
26/11/2012    1       1 
```

我是这种数据类型的新手，所以欢迎任何建议/提示

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:35:02.807

你正在寻找一个外层[`join`](http://pandas.pydata.org/pandas-docs/dev/merging.html#joining-on-index)，这里是一个简单的例子：

```
from pandas import DataFrame
df1 = DataFrame([[1]], columns=['a'])
df2 = DataFrame([[3],[4]], columns=['b'])

In [4]: df1
Out[4]: 
   a
0  1

In [5]: df2
Out[5]: 
   b
0  3
1  4

In [6]: df1.join(df2)
Out[6]: 
   a  b
0  1  3

In [7]: df1.join(df2, how='outer')
Out[7]: 
    a  b
0   1  3
1 NaN  4 
```

# javascript - 如何在不立即调用 JavaScript 函数的情况下为 JavaScript 函数提供特定上下文

> ID：13767952
> 
> 赞同：0
> 
> 时间：2012-12-07T17:21:10.717
> 
> 标签：javascript, oop, closures

我想创建一个带有一些隐藏（使用闭包）变量的对象，以及利用这些隐藏变量的方法。但是，我不想为每个实例重新创建这些方法。我想让它们记住一次。我正在使用普通函数来实例化对象。

这是一些代码：

```
function Mario () {
  var mario = {}; // create the obj
  mario.name = "Mario"; // create a property on it
  mario.hp = (function () { // set up a closure
    var currentHp = Mario.baseHp * 100; // create a "hidden" variable
    return function (value) { // return the hp function that utilizes the hidden currentHp variable
      if (!!value) {
        return currentHp = ((currentHp * Mario.baseHp) + value);
      }
      return currentHp * Mario.baseHp;
    };
  }());
  return mario; // send along the newly created object
}
Mario.baseHp = 1;

var mario = Mario();
log(mario);
log(mario.hp());
log(mario.hp(-20));
log(mario.hp()); 
```

这里的问题是，每次我创建另一个“mario”对象时，我都会在内存中再次创建 hp 函数。到目前为止，这是我对解决方案的尝试：

```
function Mario () {
  var mario = {}; // create the obj
  mario.name = "Mario"; // create a property on it
  mario.hp = (function () { // set up a closure
    var currentHp = Mario.baseHp * 100; // create a "hidden" variable
    return Mario.hp; // reference the hp function below..... but the context is wrong, it needs access to currentHp variable.
  }());
  return mario; // send along the newly created object.
}
Mario.baseHp = 1;
Mario.hp = function (value) { // Create the hp function once in memory
  if (!!value) {
    return currentHp = ((currentHp * Mario.baseHp) + value);
  }
  return currentHp * Mario.baseHp;
};
var mario = Mario();
log(mario);
log(mario.hp());
log(mario.hp(-20));
log(mario.hp()); 
```

但显然 Mario.hp 的上下文是错误的。我在想可能有一种方法可以使用 call 或 apply 来解决这个问题。任何帮助都会摇滚！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:26:19.467

通常的解决方案是使用原型和新的：

```
function Mario () {
  this.name = "Mario"; // create a property on it
  this.baseHP = 33;
}
Mario.prototype.hp = function () { 
    var currentHP = this.baseHp * 100;
    ...
};

var mario = new Mario();
log(mario);
log(mario.hp());
log(mario.hp(-20));
log(mario.hp()); 
```

这创建了通常称为类的东西`Mario`。使用`new Mario()`创建此类的实例，它们都使用相同的函数`hp`（`this`在函数中引用实例）。

编辑

如果要存储`currentHP`变量和`hp`返回它的函数，只需执行以下操作：

```
function Mario () {
  this.name = "Mario"; // create a property on it
  this.baseHP = 33;
  this.currentHP = this.baseHp * 100;
}
Mario.prototype.hp = function () { 
    return this.currentHP;
};

var mario = new Mario();
log(mario);
log(mario.hp()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T18:30:13.110

我认为所有这些关于原型的讨论都是多余的，对你的情况并没有那么大的帮助。您在这里并不真正需要原型，因为您的所有实例`Mario`都将为`currentHp`. 同样，您无需创建`Mario`真正的构造函数并担心必须记住`new`关键字（尽管您可以根据需要）。

据我所知，您尝试做的所有事情都可以通过闭包来处理，另外还可以让您的私人成员（比如`baseHP`计算 HP 的逻辑）真正私有。尝试这个：

```
var Mario = (function () {
    //"private" variable encapsulated by the closure
    var baseHp = 1;

    //"private" method for calculating HP given an instance's current HP
    var getHp = function (currentHp, value) {
        return currentHp * Enemy.baseHp + (value || 0);
    };

    //in OOP terms, baseHp and getHp would be like private static members used by
    //the whole class.

    return function () {
        //another "private" variable, but this one is only for 
        //the current instance.
        var currentHp = baseHp * 100;

        //instance:
        return {
            name: "Mario",
            hp: function (value) {
                return !!value
                    ? currentHp = getHp(currentHp, value)
                    : getHp(currentHp);
            }
        };
    };
})(); 
```

我已经在控制台中对此进行了测试，它似乎工作正常：

```
//test
var Enemy = {
    baseHp: 3
};
var log = console.log.bind(console);
var mario = Mario(); //or new Mario(); either one is fine
log(mario);
log(mario.hp());
log(mario.hp(-20));
log(mario.hp()); 
```

在 jsFiddle 上试用：http: [//jsfiddle.net/jmorgan123/zkw2P/](http://jsfiddle.net/jmorgan123/zkw2P/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T17:38:44.020

```
var Mario = (function() {
  var name = "Mario"; 
  var hp = function (value) { 
      var currentHp = baseHp * 100; 
      if (!value) {
          return currentHp = ((currentHp * Enemy.baseHp) + value);
      }
      return currentHp * Enemy.baseHp;
  }
  return {
        name:name,
        hp:hp
  }
})();
console.log(Mario);
console.log(Mario.hp());
console.log(Mario.hp(-20));
console.log(Mario.hp()); 
```

我对你所做的其他事情的有效性不做任何声明，因为似乎有很多变量显示但没有考虑，但你的外壳似乎在错误的地方。

# regex - 操作文本文件的正则表达式 - Windows

> ID：13767956
> 
> 赞同：0
> 
> 时间：2012-12-07T17:21:29.410
> 
> 标签：regex, string, nant

我在处理文本文件以获得我想要的结果时遇到问题。

例如，我在一个名为的文本文件中有以下行，该文件`sprocs.txt`是从 svn diff 创建的，类似于：

```
 M      https://localhost/svn/Repo/branches/projectA/sprocs/admin/foo.sql
     M      https://localhost/svn/Repo/branches/projectA/sprocs/foo2.sql
     M      https://localhost/svn/Repo/branches/projectA/sprocs/admin
     M      https://localhost/svn/Repo/branches/projectA/sprocs 
```

我正在尝试编辑此文件，以便它保留以 开头的所有内容`/sprocs`，但删除不以 . 结尾的每一行`.sql`。例如，上面的文件将返回以下内容：

```
 /sprocs/admin/foo.sql 
    /sprocs/foo2.sql 
```

顺便说一句：我打算让 nant 处理这些命令。有什么想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T11:42:49.633

这将使用纯 NAnt 完成这项工作：

```
<target name="go">
  <property
    name="file.path"
    value="C:\foo\sprocs.txt" />
  <foreach
    item="Line"
    in="${file.path}"
    property="line">
    <property
      name="MATCH"
      value="" />
    <regex
      pattern="(?'MATCH'/sprocs.*\.sql)$"
      input="${line}"
      failonerror="false" />
    <if test="${string::get-length(MATCH) > 0}">
      <echo message="match: ${MATCH}" />
      <!-- do whatever you want to do with your match -->
    </if>
  </foreach>
</target> 
```

不像[帕拉科的解决方案](https://stackoverflow.com/a/13773955/38029)那样优雅，但它也有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T02:47:48.013

```
 $ cat sprocs.txt | sed -n 's/.*\(\/sprocs\/.*\.sql$\)/\1/p'
/sprocs/admin/foo.sql
/sprocs/foo2.sql 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T17:40:09.560

以下正则表达式模式应该适合您，它将创建一个捕获组，该组将找到以开头`/sprocs`和结尾的任何内容`.sql`

`(/sprocs.*\.sql$)`

确保通过在 nant 正则表达式的选项中传递多行模式来启用多行模式，否则将无法正确匹配。我相信这是**m**选项，如此处[所述](http://msdn.microsoft.com/en-us/library/yd1hzczs.aspx)

# titanium - Titanium UI DashboardView删除项目？

> ID：13767958
> 
> 赞同：0
> 
> 时间：2012-12-07T17:21:39.703
> 
> 标签：titanium, dashboard

有没有办法从现有的 Titanium.UI.DashboardView 添加或删除 DashboardItem？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:19:39.090

不幸的是，没有简单的方法来删除一个项目。您必须删除当前的仪表板视图并像这样重新创建它

```
var win = Ti.UI.createWindow({
    backgroundColor: '#13386c'
});

var button = Ti.UI.createButton({
    title: 'Change Items',
    top:10
});
win.add(button);

var dashboardData = [];
var itemData = [
  { name: 'account', badge: 1 },
  { name: 'cases', badge: 2 },
  { name: 'calls', badge: 3 },
  { name: 'contacts', badge: 4 },
  { name: 'emps', badge: 5 }, 
  { name: 'leads', badge: 6 },
  { name: 'meetings', badge: 7 },
  { name: 'opps',  badge: 8 }
];

for (var i = 0; i < itemData.length; i++)
{
    var item = Ti.UI.createDashboardItem({
        badge: itemData[i].badge,
        image:'/path/to/an/image.png',
        label: itemData[i].name
    });
    dashboardData.push(item);
}

var dashboard = Ti.UI.createDashboardView({
  data: dashboardData,
  top:100
});
win.add(dashboard);

button.addEventListener('click', function(e)
{
    dashboardData = [];
    win.remove(dashboard);
    dashboard = null;
    dashboard = Ti.UI.createDashboardView({
      top:100
    });
    win.add(dashboard);

    var newItemData = [
        { name: 'account', badge: 1 },
        { name: 'calls', badge: 3 },
        { name: 'emps', badge: 5 }, 
        { name: 'meetings', badge: 7 }
    ];

    for (var i = 0; i < newItemData.length; i++)
    {
        var item = Ti.UI.createDashboardItem({
            badge: newItemData[i].badge,
            image:'/path/to/an/image.png',
            label: newItemData[i].name
        });
        dashboardData.push(item);
    }
    dashboard.data = dashboardData;
});
win.open(); 
```

我把那个例子放在一起。我相信它也可以提高效率

# python - 多个while循环的问题

> ID：13767959
> 
> 赞同：2
> 
> 时间：2012-12-07T17:21:40.623
> 
> 标签：python, while-loop

我在尝试获取 while 循环来验证用户输入，然后确保用户不重复值时遇到问题。下面显示的是我尝试过的两种方法，但我不知道如何让它们工作。

## 方法一

```
def test():
my_list = ["", "", ""]
for i in range(3):
    while (my_list[i] != "one") and \
          (my_list[i] != "two") and \
          (my_list[i] != "three"):

        while (my_list[i] == my_list[0]) and \
              (my_list[i] == my_list[1]) and \
              (my_list[i] == my_list[2]):

            text = "Enter, one, two or three", i + 1, ":"
            try:
                my_list[i] = input(text)
            except KeyboardInterrupt:
                sys.exit()

print(my_list) 
```

## 方法二

```
def test2():

my_list= ["", "", ""]
while len(my_list)!=len(set(my_list)) == True:
    for c in range(4):
        while (my_list[i] != "one") and \
              (my_list[i] != "two") and \
              (my_list[i] != "three"):
            text = "Enter, one, two or three", c + 1, ":"
            try:
                my_list[c] = input(text)
            except KeyboardInterrupt:
                sys.exit()

print(my_list) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:24:56.317

为什么不简化一下：

```
my_list = []
while len(data) < 3:
    data = input(text) # Valid for Python 3, use raw_input(text) in Python 2
    if data in ("one", "two", "three") and data not in my_list:
        my_list.append(data) 
```

这是您要求的或多或少的直接翻译：

1.  我有一个清单
2.  虽然列表太小
    1.  获取一些数据
    2.  如果数据是有效值之一，并且不在列表中
        1.  将其添加到列表中

在这种情况下使用`for x in range(y)`只会增加复杂性，因为您实际上并不知道希望循环运行多少次。

没有理由用无效值 ( `my_list = ["", "", ""]`) 预先填充列表，因为可以使用 来调整列表的大小`append`。

此外，您的`sys.exit`代码是不必要的并且可能有害。只要让异常传播，它就会使程序本身崩溃（除非你抓住它，你几乎不应该为`KeyboardInterrupt`异常做这件事）。

注意：如果您将两个 while 循环组合成一个，您的第一个版本就可以工作，这只是不必要的复杂。

# xslt - 为元素添加各种命名空间

> ID：13767966
> 
> 赞同：1
> 
> 时间：2012-12-07T17:22:14.077
> 
> 标签：xslt, add, xml-namespaces

我有一个 xml 文档，其中一些元素有命名空间，而其他元素没有。它们都需要命名空间，有些相同有些不同。元素具有我想保留的属性。

xml：

```
<foo xmlns:gml="http://www.opengis.net/gml" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:gco="http://www.isotc211.org/2005/gco" xsi:schemaLocation="http://www.isotc211.org/2005/gmd http://schemas.opengis.net/iso/19139/20060504/gmd/gmd.xsd" xmlns="http://www.isotc211.org/2005/gmd">
<bar y="2">
<baz z="3"/></bar>
<a-special-element n="8"/>
<another-special-element k="8"/>
</foo> 
```

和 xslt：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:template match="*">
    <xsl:element name="{local-name()}" namespace="A" >
        <xsl:copy-of select="attribute::*"/>
        <xsl:apply-templates />
    </xsl:element>
</xsl:template>

<xsl:template match="foo">
    <xx:foo xmlns:xx="xx">
        <xsl:apply-templates/>
    </xx:foo>
</xsl:template>

<xsl:template match="a-special-element">
    <B:a-special-element xmlns:B="B">
        <xsl:apply-templates/>
    </B:a-special-element>
</xsl:template>

<xsl:template match="another-special-element">
    <C:a-special-element xmlns:C="C">
        <xsl:apply-templates/>
    </C:another-special-element>
</xsl:template>

</xsl:stylesheet> 
```

这是我想要的输出：

```
<xx:foo xmlns:gml="http://www.opengis.net/gml" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:gco="http://www.isotc211.org/2005/gco" xsi:schemaLocation="http://www.isotc211.org/2005/gmd http://schemas.opengis.net/iso/19139/20060504/gmd/gmd.xsd" xmlns="http://www.isotc211.org/2005/gmd">    <bar y="2">
    <baz z="3"/>
</bar>
<B:a-special-element n="8"/>
<C:another-special-element k="4"/>

</xx:foo> 
```

我检查了这个线程，但是“a-special-element”的属性已经被神奇地删除了。[为元素添加命名空间](https://stackoverflow.com/questions/144713/add-a-namespace-to-elements-using-xslt)

我也有多个 xmlns：？？？在我想保留的 foo 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:31:24.247

首先：**名称空间是 XML 中的一个基本概念。**如果您不熟悉命名空间，请花时间学习和理解它们。

> 我有一个 xml 文档，其中一些元素有命名空间，而其他元素没有。

实际上，在您的代码示例中，所有元素都属于一个命名空间。

`xmlns="http://www.isotc211.org/2005/gmd"`根元素中的代码使用 URI 定义默认命名空间`"http://www.isotc211.org/2005/gmd"`。因此，如果元素名称没有命名空间前缀，则此元素及其后代属于此默认命名空间。如果一个元素使用默认命名空间，很容易忘记它位于某个命名空间中，因为没有命名空间前缀。请注意，默认命名空间不适用于属性，仅适用于元素。

您的预期结果文件不清楚。它还应该具有命名空间前缀 和 的命名`xx`空间`B`定义`C`。我还假设您的命名空间`A`与使用预期结果文档的默认命名空间相同。

**无论如何，鉴于此输入：**

```
<foo xmlns:gml="http://www.opengis.net/gml"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xmlns:gco="http://www.isotc211.org/2005/gco"
     xmlns="http://www.isotc211.org/2005/gmd"
     xsi:schemaLocation="http://www.isotc211.org/2005/gmd http://schemas.opengis.net/iso/19139/20060504/gmd/gmd.xsd"
     >
    <bar y="2">
        <baz z="3"/>
    </bar>
    <a-special-element n="8"/>
    <another-special-element k="8"/>
</foo> 
```

**这个 XSLT 代码：**

```
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:gml="http://www.opengis.net/gml"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:gco="http://www.isotc211.org/2005/gco"
    xmlns:gmd="http://www.isotc211.org/2005/gmd"
    xmlns="http://www.isotc211.org/2005/gmd"
    xmlns:B="B"
    xmlns:C="C"
    xmlns:xx="xx"
    >

<xsl:template match="node() | @*" name="identity">
    <xsl:copy>
        <xsl:apply-templates select="node() | @*"/>
    </xsl:copy>
</xsl:template>

<xsl:template match="*">
    <xsl:element name="{local-name()}">
        <xsl:apply-templates select="node() | @*"/>
    </xsl:element>
</xsl:template>

<xsl:template match="gmd:foo">
    <xx:foo>
        <xsl:apply-templates select="node() | @*"/>
    </xx:foo>
</xsl:template>

<xsl:template match="gmd:a-special-element">
    <B:a-special-element>
        <xsl:apply-templates select="node() | @*"/>
    </B:a-special-element>
</xsl:template>

<xsl:template match="gmd:another-special-element">
    <C:another-special-element>
        <xsl:apply-templates select="node() | @*"/>
    </C:another-special-element>
</xsl:template>

</xsl:stylesheet> 
```

**将产生这个输出：**

```
<xx:foo xmlns:xx="xx" 
        xmlns:gml="http://www.opengis.net/gml" 
        xmlns:xlink="http://www.w3.org/1999/xlink" 
        xmlns:gco="http://www.isotc211.org/2005/gco" 
        xmlns:gmd="http://www.isotc211.org/2005/gmd" 
        xmlns="http://www.isotc211.org/2005/gmd" 
        xmlns:B="B" 
        xmlns:C="C" 
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
        xsi:schemaLocation="http://www.isotc211.org/2005/gmd http://schemas.opengis.net/iso/19139/20060504/gmd/gmd.xsd"
        >
    <bar y="2">
        <baz z="3"/>
    </bar>
    <B:a-special-element n="8"/>
    <C:another-special-element k="8"/>
</xx:foo> 
```

请注意身份模板如何用于递归复制输入文档的内容，这是一种常见且有用的技术。

**请注意，XSLT 文档的默认名称空间不适用于** `<xsl:template match="ELEMENT-NAME">`. 因此，您需要为输入文档的默认命名空间定义命名空间前缀，并在引用这些元素时使用该前缀，例如在`match`and`select`属性中。另请注意，因此，命名空间 URI`http://www.isotc211.org/2005/gmd`在结果文档中定义了两次 - 使用前缀`gmd`和作为默认命名空间。如果这让您感到困扰，您可以向元素添加`exclude-result-prefixes="gmd"`属性。`<xsl:stylesheet>`作为副作用，这可能会导致您的默认命名空间定义出现在文档的后面而不是根元素中，但这只是视觉上的差异，底层功能保持不变。

# android - Android.bluetooth.IBluetooth.createBond() 未在 4.2.1 中找到，但适用于早期操作系统版本

> ID：13767972
> 
> 赞同：10
> 
> 时间：2012-12-07T17:22:36.367
> 
> 标签：android, bluetooth

我有一些代码可以通过调用 createBond() 自动与蓝牙设备配对，为 android.bluetooth.device.action.PAIRING_REQUEST 注册广播接收器，然后手动输入 PIN 码进行配对。

到目前为止，这对所有测试到 Andoid 4.0 的设备都非常有效，但今天我在我的 Nexus 7 和 Android 4.2.1 上尝试了这个并得到了以下错误：

java.lang.noSuchMethodException: android.bluetooth.IBluetooth.createBond

他们真的从库中删除了这个函数吗？

**更新**

实际发生的是我用来调用 createBond 的 IBluetooth 接口对象没有被初始化。在下面的代码中，尝试获取名为 BTBinder 的 IBinder 的行在此过程失败时返回 null，导致 BTInterface 在最后设置为 null。所以，我现在的问题是为什么在我的带有 Android 4.2.1 的 Nexus 7 上调用获取活页夹返回 null 但在我测试过的其他 5 台设备上正常工作？

```
public static IBluetooth getBluetoothInterface()
{
    //Gets a bluetooth interface from private Android system API
    IBluetooth BTInterface = null;

    try
    {
        Class<?> ServiceManager = Class.forName("android.os.ServiceManager");
        Method getService = ServiceManager.getDeclaredMethod("getService", String.class);
        IBinder BTBinder = (IBinder) getService.invoke(null, "bluetooth");
        Class<?> IBluetooth = Class.forName("android.bluetooth.IBluetooth");
        Class<?>[] IBluetoothClasses = IBluetooth.getDeclaredClasses();
        Class<?> IBluetoothClass0 = IBluetoothClasses[0];
        Method asInterface = IBluetoothClass0.getDeclaredMethod("asInterface",IBinder.class);
        asInterface.setAccessible(true);
        BTInterface = (IBluetooth) asInterface.invoke(null, BTBinder);
    }
    catch (Exception e)
    {
        return null;
    }

    return BTInterface;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T12:15:17.720

在 Android 4.2 中，他们更改了蓝牙堆栈实现。

“Android 4.2 引入了一种针对 Android 设备进行了优化的新蓝牙协议栈。谷歌和博通合作开发的新蓝牙协议栈取代了基于 BlueZ 的协议栈，并提供了更高的兼容性和可靠性。”

即使使用 Nexus 7 上的公共 api，也有很多与 bt 相关的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T21:48:49.583

```
 public boolean createBond(BluetoothDevice btDevice)  
        throws Exception  
        { 
            Class class1 = Class.forName("android.bluetooth.BluetoothDevice");
            Method createBondMethod = class1.getMethod("createBond");  
            Boolean returnValue = (Boolean) createBondMethod.invoke(btDevice);  
            return returnValue.booleanValue();  
    } 
```

这适用于 4.2.1 Galaxy Nexus。没有在 Nexus 7 上尝试过，但是当我使用 IBluetooth 方法时，我遇到了同样的 MethodNotFoundException 问题。所以它也可能适用于 Nexus 7。

# iphone - testflight 是否有上传限制

> ID：13767975
> 
> 赞同：0
> 
> 时间：2012-12-07T17:22:46.367
> 
> 标签：iphone, xcode, terminal, testflight

TestFlight 是否对您将 .ipa 文件上传到其 API 的频率有限制？

我问的原因是因为我是通过 .sh 脚本上传的，而且它偶尔会起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:24:16.567

最好[直接问他们](http://help.testflightapp.com/customer/portal/emails/new)，但根据我的经验，我从来没有拒绝过上传，除非他们的服务出现问题。

我使用了 TestFlight Jenkins 插件，它会上传每个成功的构建。

他们的文档也没有暗示有任何限制，[https://testflightapp.com/api/doc/](https://testflightapp.com/api/doc/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T19:59:17.100

每个应用程序的上传限制为 800MB。但是您可以联系他们并要求为您的应用程序增加它。

[http://help.testflightapp.com/customer/portal/articles/402851-testflight-faq](http://help.testflightapp.com/customer/portal/articles/402851-testflight-faq)

# java - 将字符串转换为 SpringMVC 的对象

> ID：13767987
> 
> 赞同：1
> 
> 时间：2012-12-07T17:23:35.273
> 
> 标签：java, jakarta-ee, spring-mvc

我在 Spring MVC 3.0.1 框架中将 String 转换为 Object 时遇到了一些问题。当我想使用自定义 Web 编辑器通过表单向 PostgreSQL 数据库添加一些数据（添加新产品）时，没有显示错误，表单字段被插入到数据库中，并且只为我添加的产品插入产品类别（在数据库中`category_types`我插入了一些类别，它们显示在视图中）。当我在 Controller 中删除 InitBinder 方法时，出现错误，应该显示没有编辑器可以转换我想要的内容。

这是我的自定义网络编辑器的代码：

```
package Webeditors;
import java.beans.PropertyEditorSupport;
import Models.CategoryType;
public class CategoryTypeWebEditor extends PropertyEditorSupport {

@Override
public void setAsText(String text) throws IllegalArgumentException { 

    CategoryType a = new CategoryType(); 
    a.setId(Long.parseLong(text));
    setValue(a);  
}      

@Override
public String getAsText() {

    CategoryType type = (CategoryType) getValue();
    return type == null ? null :  Long.toString(type.getId());  
} 
```

}

我的**CategoryType**类是：

```
package Models;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Table;

@Entity
@Table(name="category_types")
public class CategoryType {

@Id
@GeneratedValue(strategy=GenerationType.IDENTITY) 
long id;

String name;

public CategoryType(){}

public CategoryType(long id, String name){

    this.id = id;
    this.name = name;

}

...

@Override
public boolean equals(Object obj) {
    if(obj instanceof CategoryType){
        CategoryType a = (CategoryType)obj;
    return a.getId() == id;
    }
    return false;
}   
} 
```

在我的 JavaBeans**产品**中，我声明：

```
@ManyToMany(fetch=FetchType.EAGER)
List<CategoryType> type;

public Product(){

    type = new ArrayList<CategoryType>();

}
...

public List<CategoryType> getType() {
    return type;
}

public void setType(List<CategoryType> type) {
    this.type = type;
} 
```

在我的**控制器**中，我有这样的东西：

```
@RequestMapping(method = RequestMethod.POST)

public String addProduct(Model model,
        @ModelAttribute("addproduct") Product product, BindingResult result){

....
}
@ModelAttribute("categorytypes")
public List<CategoryType> loadCategoryTypes() {
    List<CategoryType> types = dao.getCategory_Types();
    return types;
}
@InitBinder
public void initBinder(WebDataBinder binder) {
    binder.registerCustomEditor(CategoryType.class, new CategoryTypeWebEditor());
} 
```

我正在这样显示它：

```
<form:form cssClass="form-horizontal" method="Post"
        action="addproductform.html" commandName="addproduct">
<form:checkboxes items="${categorytypes}" path="type" itemValue="id" itemLabel="name" delimiter="<br>"/>
<form:errors cssStyle="margin-top: 10px; margin-left: 160px;" cssClass="alert alert-error" element="div" path="type" />
</form:form> 
```

知道我做错了什么，它没有添加，因为我坚持使用它。谢谢

# android - 试图将项目保留在页面底部

> ID：13767988
> 
> 赞同：0
> 
> 时间：2012-12-07T17:23:40.673
> 
> 标签：android, jquery, css

在 android 中，我在将 div / bg 图像保持在页面底部时遇到了很大的问题。

因此，我试图在您滚动时移动整个侧边栏项目，但我的数学/代码有些问题。

因此，我向您提供了这种尝试，以发现我的逻辑所关心的问题：

```
 jQuery(window).scroll(function() {
        var y = jQuery(this).scrollTop();
        var current = jQuery('.side-bar').css('background-position', '-43px', '0%' + parseInt(+y / 10) + '%');
        current();
        console.log(current;);
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T18:06:44.040

尝试使用 DIV 并使用`position:fixed`and `bottom:0px;`。

# c++ - 命名管道读取超时

> ID：13767989
> 
> 赞同：3
> 
> 时间：2012-12-07T17:23:41.593
> 
> 标签：c++, windows, timeout, named-pipes

我正在尝试为我的命名管道的读取操作设置超时。
为了从命名管道中读取，我正在使用该`ReadFile`函数。
我读到可以使用该`SetCommTimeouts`功能为此功能设置超时，但是当我尝试使用它时，我收到系统错误 1：“功能不正确”。
这是我的代码（这是客户端）：

```
m_pipe = CreateFileA(pipeName,   // pipe name 
                         GENERIC_READ |  // read and write access 
                         GENERIC_WRITE, 
                         0,              // no sharing 
                         NULL,           // default security attributes
                         OPEN_EXISTING,  // opens existing pipe 
                         0,              // default attributes 
                         NULL);          // no template file 

    if (m_pipe != INVALID_HANDLE_VALUE)
    {
            DWORD mode = PIPE_READMODE_MESSAGE | PIPE_WAIT;
            ok = SetNamedPipeHandleState(m_pipe, &mode, NULL, NULL);
            COMMTIMEOUTS cto;
            cto.ReadTotalTimeoutConstant = 1000;
            BOOL time = SetCommTimeouts(m_pipe, &cto);
    } 
```

我做错了什么还是该`SetCommTimeouts`方法不应该与管道一起使用？有没有其他方法可以获得阅读超时？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-08T16:49:21.767

如果超时的目的是为了不卡住，您可以考虑在定时循环中`forever`调用[PeekNamedPipe(...) 。](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365779%28v=vs.85%29.aspx)这样，您可以不时检查是否有要阅读的内容。或者`PeekNamedPipe`，可用于在执行读取**之前**决定管道上的读取是否实际上会得到任何东西。这样可以避免“等待”读取。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T17:30:44.680

您不能将 SetCommTimeouts 与命名管道一起使用。如果您想要超时，您将不得不使用异步 I/O 并自己使用`CancelIo`或实现超时`CancelIoEx`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-19T08:11:23.933

ReadFile 阻塞，直到它读取请求的字节数或发生错误/中止。重叠的工作方式相同，即它在相同的条件下完成。尝试使用 CancelIoEx 实现超时并发现它会丢失数据。到目前为止，还没有办法实现超时并只读取部分请求的字节数，或者读取缓存的数据。

# python - python脚本打开excel工作簿，更改第一个工作表的名称并执行存储过程

> ID：13767990
> 
> 赞同：1
> 
> 时间：2012-12-07T17:23:40.843
> 
> 标签：python

我有这个 python 脚本，它应该从目录中打开一个 excel 工作簿，然后更改第一个工作表的名称，然后在第一个工作表和后续工作表上运行一个存储过程。当我运行脚本时，它给了我一个错误 - 'str' 对象属性 'title' 是只读的。任何帮助或建议表示赞赏。

```
import os
import pyodbc
import openpyxl
from openpyxl import load_workbook

dirList = os.listdir("""\\Raw_Data\\HSRx""")

#database connection
#loop through excel workbooks
#loop through excel sheets in each workbook
#run stored proc on each worksheet
#close files and disconnect to sql server
conn = pyodbc.connect('DRIVER={SQLServer};SERVER=localhost;DATABASE=mydb;UID=myname;PWD=mypwd')
cursor = conn.cursor()

for n in dirList:
    path =os.path.join("""\\Raw_Data\\HSRx""",n)
    workbook = openpyxl.reader.excel.load_workbook(path)
    worksheets = workbook.get_sheet_names()
    sheet = ['None','None']
    i = 0
    print n
    for worksheet in worksheets:
        worksheet.title = "Sheetone"
        sheet[i] = "Sheetone"
        i += 1
        print worksheet
    cursor.execute("""exec SP_IMPORT_HSRx_Ins ?, ?, ?""",n,sheet[0],sheet[1])
    cursor.commit()

conn.close() 
```

这是回溯：

```
CS NOV20 12.xlsx Traceback (most recent call): 
  File "HSRXRecons.py", line 25, in <module> worksheet.title = "Sheetone" 
AttributeError: 'str' object attribute 'title' is read-only 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:44:19.813

`worksheet`是一个字符串，因为`get_sheet_names()`返回一个字符串列表。您不能将属性分配给字符串。

```
>>> 'Sheet1'.title = 'Sheetone'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'str' object attribute 'title' is read-only 
```

要更改标题，请将工作表名称传递给`get_sheet_by_name`：

```
workbook.get_sheet_by_name(worksheet).title = "Sheetone" 
```

# ios - 魔法记录不保存

> ID：13767993
> 
> 赞同：8
> 
> 时间：2012-12-07T17:24:04.017
> 
> 标签：ios, ios5, core-data, ios4, magicalrecord

我正在使用魔法记录： [https ://github.com/magicalpanda/MagicalRecord](https://github.com/magicalpanda/MagicalRecord)

我正在尝试使用 Magical Record 和 Core Data 将从我的网站获取的记录保存到 sqllite 数据库，但我不断收到错误消息：

```
MR_saveWithErrorCallback:](0xaaa6bd0) NO CHANGES IN CONTEXT <NSManagedObjectContext (0xaaa6bd0): *** BACKGROUND SAVING (ROOT) ***> on *** BACKGROUND THREAD *** - NOT SAVING 
```

这是代码：

```
 for(int i = 0; i < count; i += 1)
             {
                 // results  = array of all services from site
                 NSDictionary * result = [results objectAtIndex: i];

                 NSNumber * sid = @([[result objectForKey: @"id"] intValue]);
                 NSNumber * parent = @([[result objectForKey: @"parent"] intValue]);
                 Service * service  = [Service createEntity];

                 NSString * image = [NSString stringWithFormat: @"%@", [result objectForKey: @"image"]];

                 NSString * name  = [NSString stringWithFormat: @"%@", [result objectForKey: @"name"]];
                 NSString * machine_name  = [NSString stringWithFormat: @"%@", [result objectForKey: @"machine_name"]];

                 [service setDate: [NSDate date]];
                 [service setSid: sid];
                 [service setName: name];

                 [service setImage: image];
                 [service setParent: parent];
                 [service setMachine_name: machine_name];

                 [[NSManagedObjectContext defaultContext] saveNestedContexts]; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-17T23:59:18.670

问题是您没有保存正确的上下文。如果您查看源代码，`[Service createEntity]`则会在当前线程的上下文中创建 ManagedObject。不在默认上下文中。

所以你需要做的是，而不是`[[NSManagedObjectContext defaultContext] saveNestedContexts]`，你应该保存当前线程的上下文（即创建 ManagedObject 的上下文）。所以代码应该是`[[NSManagedObjectContext MR_contextForCurrentThread]`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-08T15:19:55.873

您是否尝试过使用`saveInBackgroundWithBlock:`实用程序方法？

如果没有，您可能想尝试类似下面的代码。请注意，它会在后台一次性保存所有对象，然后在主线程上执行完成块：

```
[MagicalRecord saveInBackgroundWithBlock:^(NSManagedObjectContext *localContext){
    Service *service = [Service createInContext:localContext];

    ... set values ...
} completion:^{
    ...
}]; 
```

除此之外，您可以查看是否`[[NSManagedObjectContext defaultContext] hasChanges]`返回 YES 以检查是否是保存问题或实体本身的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-03T22:23:56.793

在我的快速项目中，我这样做：

```
MagicalRecord.setupCoreDataStack() 
```

那么我需要执行以下操作来保存到磁盘：

```
NSManagedObjectContext.MR_defaultContext().MR_saveToPersistentStoreAndWait() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-24T17:28:49.617

移动线

```
[[NSManagedObjectContext defaultContext] saveNestedContexts]; 
```

在 for 循环之外，它对我有用

# android - AsyncTast onPostExecute 未更新 UI 元素：引发 NullPointerException

> ID：13767995
> 
> 赞同：0
> 
> 时间：2012-12-07T17:24:11.747
> 
> 标签：android, android-asynctask

我一度陷入了这个问题。这是我的代码

```
public class PilgrimFriendActivity extends Activity {

    private String DOMAIN = "http://";

    private String LAWS_URL = "";
    private String LOCATIONS_URL = "";

    private ListView list;
    private TextView content;
    private Law law  ;
    private Location location;
    private ProgressDialog dialog;
    private SharedPreferences preferences;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        preferences = getSharedPreferences("com.hackontech.pilgrim_preferences", MODE_PRIVATE);
        this.DOMAIN += preferences.getString("DOMAIN","192.168.0.104");
        this.LAWS_URL = DOMAIN + "/pilgrimfriend/main/getAllLaws";
        this.LOCATIONS_URL = DOMAIN + "/pilgrimfriend/main/getAllLocations";

        dialog = new ProgressDialog(this);
        content = (TextView) findViewById(R.id.content);
        list = (ListView) findViewById(R.id.laws);
        this.lLaws();

    }

    public void lLaws() {

        final class RequestTask extends AsyncTask<String, String, String>{

            private String URL = null;

            @Override
            protected String doInBackground(String... uri) {
                String result = null;
                URL = uri[0];
                try {

                    //Create default http client
                    HttpClient httpclient = new DefaultHttpClient();
                    HttpGet httpget = new HttpGet(URL);
                    Log.v("URL",URL);
                    HttpResponse response = httpclient.execute(httpget);
                    //Retrieve the response body or "entity"
                    HttpEntity entity = response.getEntity();
                    //Return the entity as String
                    result = EntityUtils.toString(entity);
                    Log.v("result",result.toString());

                } catch (Exception e) {
                    return e.getMessage();
                }

                return result;
            }

            @Override
            protected void onPostExecute(String result) {
                //super.onPostExecute(result);
                dialog.dismiss();
                try{

                    JSONArray jArray = new JSONArray(result);

                    JSONObject json_data;
                    ArrayList<String> items = new ArrayList<String>();
                    for(int i=0; i < jArray.length() ; i++) {
                        json_data = jArray.getJSONObject(i);
                        int id=json_data.getInt("id");
                        String title=json_data.getString("title");
                        String scholor =json_data.getString("scholor");
                        items.add(title+" ("+scholor+")");
                    }

                    content.setText(result);
                    ArrayAdapter<String> mArrayAdapter = new ArrayAdapter<String>(getApplicationContext(),  
                            android.R.layout.simple_list_item_1, items);
                    list.setAdapter(mArrayAdapter);

                    Toast.makeText(getApplicationContext(), result, Toast.LENGTH_LONG).show();

                }
                catch(JSONException e) {
                    //content.setText(e.getMessage());
                }
                //Do anything with response..
            }

            @Override
            protected void onPreExecute() {
                // TODO Auto-generated method stub
                super.onPreExecute();

                dialog.setTitle("Downloading Laws Data");
                dialog.show();
            }

        }

        new RequestTask().execute(LAWS_URL);
    } 
```

我每个方法都在工作，但是`onPostExecute`当我像我一样更改视图元素时`content.setText(result)`，应用程序立即停止，有什么问题。

这是`LogCat`：

```
12-07 22:44:33.302: E/AndroidRuntime(778): FATAL EXCEPTION: main
12-07 22:44:33.302: E/AndroidRuntime(778): java.lang.NullPointerException
12-07 22:44:33.302: E/AndroidRuntime(778):  at com.hackontech.pilgrim.PilgrimFriendActivity$1RequestTask.onPostExecute(PilgrimFriendActivity.java:120)
12-07 22:44:33.302: E/AndroidRuntime(778):  at com.hackontech.pilgrim.PilgrimFriendActivity$1RequestTask.onPostExecute(PilgrimFriendActivity.java:1)
12-07 22:44:33.302: E/AndroidRuntime(778):  at android.os.AsyncTask.finish(AsyncTask.java:417)
12-07 22:44:33.302: E/AndroidRuntime(778):  at android.os.AsyncTask.access$300(AsyncTask.java:127)
12-07 22:44:33.302: E/AndroidRuntime(778):  at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:429)
12-07 22:44:33.302: E/AndroidRuntime(778):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-07 22:44:33.302: E/AndroidRuntime(778):  at android.os.Looper.loop(Looper.java:123)
12-07 22:44:33.302: E/AndroidRuntime(778):  at android.app.ActivityThread.main(ActivityThread.java:3683)
12-07 22:44:33.302: E/AndroidRuntime(778):  at java.lang.reflect.Method.invokeNative(Native Method)
12-07 22:44:33.302: E/AndroidRuntime(778):  at java.lang.reflect.Method.invoke(Method.java:507)
12-07 22:44:33.302: E/AndroidRuntime(778):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
12-07 22:44:33.302: E/AndroidRuntime(778):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
12-07 22:44:33.302: E/AndroidRuntime(778):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-06T14:01:20.950

出于某种原因，`onPostExecute`当方法完成时，方法会立即更新所有 UI。

例如：

```
@Override
protected Void doInBackground() {
    someTextView.setText("Do In Background Finished!");
}

@Override
protected void onPostExecute () {
    someTextView.setText("Post Execute Started");
    try {
        Thread.sleep(5000);
    } catch (InterruptedException e) {
        // ..
    }
    someTextView.setText("Post Execute Finished");
} 
```

将导致显示“在后台完成！” 5 秒后（`onPostExecute`结束时）将使用“Post Execute Started”更新文本，并立即使用“Post Execute Finished”再次更新文本。

# prolog - 序言词之前的大写“N”：imp(P,Q,Y) :- not(P,NP),or(NP,Q,Y)

> ID：13767998
> 
> 赞同：0
> 
> 时间：2012-12-07T17:24:28.113
> 
> 标签：prolog

序言词之前的大写“N”是什么意思？

比如imp中的P变成not中的NP？</p>

```
imp(P,Q,Y) :- not(P,NP),or(NP,Q,Y). 
```

NP表示序言中P的否定？

N是prolog中的一种内置函数？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:30:51.417

它没有特别的意义。以大写字母开头的术语`NP`表示它是一个变量（它可以以任何大写字母开头）。

我阅读您的程序的方式：

```
imp(P,Q,Y) :- not(P,NP),or(NP,Q,Y). 
```

它的意思是：'要得到 P 意味着 Q 到变量 Y' 我们调用过程`not/2`来获得输入 P 的否定，然后我们调用过程`or/3`来计算变量 Y 上的“不是 P 或 Q”。当然，你在某个地方定义了过程`not/2`和`or/3`

# mysql - SQL 返回所有结果 ALL，Distinct？

> ID：13767999
> 
> 赞同：0
> 
> 时间：2012-12-07T17:24:29.517
> 
> 标签：mysql, sql, distinct

问题：即使在 a.Month 中找不到 Month_Name，也需要查询返回 b.Monthly_Yield 的 MONTH_NAME 和 YIELD。由于某种原因，如果在 a.Month 中找不到 Month，即使我添加到选择 b.month，查询仍然不会返回 b.Monthly_Yield 值。我现在的方式是，如果在表“a”中找不到月份，但在表“b”中找到月份，则结果将不会返回。即使在“a”中找不到那个月份，我也需要返回“b”的结果。

注：“月”为月数

左外连接的数据结果：

```
Month  Month_Name  Yield_1  Yield_0
------------------------------------
2      Febrero     11.44    14
3      Marzo       NULL     3.21
4      Abril       NULL     14.24
7      Julio       NULL     10.36
8      Agosto      NULL     0
9      Septiembre  NULL     -9.6
10     Octubre     NULL     10.35
11     Noviembre   NULL     1.4
12     Diciembre   11.44    -1.18 
```

右外连接的数据结果：

```
Month  Month_Name  Yield_1  Yield_0
------------------------------------
NULL   NULL        11.44    NULL
2      Febrero     11.44    14
12     Diciembre   11.44    -1.18 
```

询问：

```
SET @ID_CARTERA = 8;

select     
    a.Month,
    a.Month_Name,
    a.Monthly_Yield,
    b.Monthly_Yield

from
( select  
      RIGHT(A.F_ANOMES, 2) Month,
      IF(RIGHT(A.F_ANOMES, 2)=01,'Enero',
      IF(RIGHT(A.F_ANOMES, 2)=02,'Febrero',
      IF(RIGHT(A.F_ANOMES, 2)=03,'Marzo',
      IF(RIGHT(A.F_ANOMES, 2)=04,'Abril',
      IF(RIGHT(A.F_ANOMES, 2)=05,'Mayo',
      IF(RIGHT(A.F_ANOMES, 2)=06,'Junio',
      IF(RIGHT(A.F_ANOMES, 2)=07,'Julio',
      IF(RIGHT(A.F_ANOMES, 2)=08,'Agosto',
      IF(RIGHT(A.F_ANOMES, 2)=09,'Septiembre',
      IF(RIGHT(A.F_ANOMES, 2)=10,'Octubre',
      IF(RIGHT(A.F_ANOMES, 2)=11,'Noviembre',
      IF(RIGHT(A.F_ANOMES, 2)=12,'Diciembre',
      '')
      ))))))))))) Month_Name,

      ROUND(A.POR_RENTABILIDAD, 2) Monthly_Yield

from      dr_rent_carteras_meses A
where     A.ID_CARTERA = @ID_CARTERA
And       A.IND_RENTABILIDAD = 1
And       LEFT(A.F_ANOMES, 4) = ( select MAX(left(F_ANOMES, 4 ) ) - 0
                                  from dr_rent_carteras_meses
                                  where ID_CARTERA = @ID_CARTERA ) ) a

left outer join 
    ( select  
      RIGHT(A.F_ANOMES, 2) Month,
      IF(RIGHT(A.F_ANOMES, 2)=01,'Enero',
      IF(RIGHT(A.F_ANOMES, 2)=02,'Febrero',
      IF(RIGHT(A.F_ANOMES, 2)=03,'Marzo',
      IF(RIGHT(A.F_ANOMES, 2)=04,'Abril',
      IF(RIGHT(A.F_ANOMES, 2)=05,'Mayo',
      IF(RIGHT(A.F_ANOMES, 2)=06,'Junio',
      IF(RIGHT(A.F_ANOMES, 2)=07,'Julio',
      IF(RIGHT(A.F_ANOMES, 2)=08,'Agosto',
      IF(RIGHT(A.F_ANOMES, 2)=09,'Septiembre',
      IF(RIGHT(A.F_ANOMES, 2)=10,'Octubre',
      IF(RIGHT(A.F_ANOMES, 2)=11,'Noviembre',
      IF(RIGHT(A.F_ANOMES, 2)=12,'Diciembre',
      '')
      ))))))))))) Month_Name,

      ROUND(A.POR_RENTABILIDAD, 2) Monthly_Yield

from      dr_rent_carteras_meses A
where     A.ID_CARTERA = @ID_CARTERA
And       A.IND_RENTABILIDAD = 1
And       LEFT(A.F_ANOMES, 4) = ( select MAX(left(F_ANOMES, 4 ) ) - 1
                                  from dr_rent_carteras_meses
                                  where ID_CARTERA = @ID_CARTERA ) ) b on ( a.Month = b.Month ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T17:28:53.443

将左外连接更改为右外连接。

@ypercube 是正确的。使用完全外连接。

您没有得到月份名称的原因是现在 a 表中有值。所以你需要从 b 表中获取它。

尝试

```
ISNULL(a.Month, b.Month) as Month
ISNULL(a.Month_Name, b.Month_Name) as Month 
```

另外，请听取评论的建议。使用正确的数据类型函数。还要查看 CASE 语句。

您可能还想查询联接中的所有信息，然后对外部查询进行数据转换（月份名称）。这样你就不必做两次了。