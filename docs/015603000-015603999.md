# StackOverflow 问答 15603000-15603999

# c++ - sprintf 小数点太多/小数点

> ID：15603003
> 
> 赞同：4
> 
> 时间：2013-03-24T19:35:38.283
> 
> 标签：c++, printf

我必须使用非科学（即没有尾数/指数/E）字符串转换十进制数。我的代码如下所示：

```
/*!
\brief Converts a <em>XML Schema Decimal</em>
*/
char *ToDecimal(double val) const
{
    const size_t nMax = 200;
    char *doubleStr = new char[nMax];

    sprintf(doubleStr, "%1.6f", val);

    return doubleStr;
} 
```

问题是当输入`val`是`1`函数返回时`1.000000`，但我希望输出`1`. 另外，如果我将代码更改为，`sprintf(doubleStr, "%1.0f", val);`那么它会正确输出`1`，但如果输入`val`更改为`0.000005`输出`0`，我希望输出会是`0.000005`。所以基本上我希望所有输出尽可能短并删除所有不必要`0`的。这可能`sprintf`吗？我想用这个功能支持 3.4E +/- 38 范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T19:48:59.857

由于这是标记为 C++，我假设您可以使用 C 中不可用的 C++ 功能（如果没有，请告诉我，我将删除此答案）。

首先，我建议使用 a`std::string`而不是`char*`（这可以让您从管理缓冲区的内存中解放出来）？其次，我建议使用 a`ostringstream`进行转换：

```
#include <sstream>

std::string ToDecimal(double val) {
    std::ostringstream oss;
    oss << val;
    return oss.str();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T21:07:46.303

事实证明，c++ iostreams（特别是`ostringstream`）比`sprintf`.

使用`std::fixed`操纵器禁用科学计数法。用于`std::setprecision`指定精度（小数点后的字符数）。在您的情况下，45 位的精度似乎足以代表所有`float`数字。

```
#include <sstream>
#include <string>
#include <iostream>
#include <iomanip>

std::string convert(double x)
{
    std::ostringstream buffer;
    buffer << std::fixed << std::setprecision(45) << x;
    std::string result = buffer.str();

    return result;
} 
```

此外，要清理结果，请删除任何尾随零。

```
 size_t i = result.find_last_not_of('0');
    if (result[i] != '.')
        ++i;
    result.erase(i); 
```

注意：尾随零的清理仅适用于完全可表示的数字（如 0.75 或 0.03125）：例如，数字 0.1 转换为`0.10000000000000000555111512312578270211815834`. 可以使用非恒定精度（取决于数字的大小），但这很难做到正确。

相反，可以使用以下丑陋（且缓慢）的技巧：尝试将字符串的开头转换回`double`，如果结果等于初始数字，则剪切字符串。

```
size_t i;
for (i = 1; i < result.size(); ++i)
{
    std::istringstream cut(result.substr(0, i));
    double temp;
    cut >> temp; // the verbose syntax could fit into one line 
    if (temp == x) // by using boost::lexical_cast
        break;
} 
```

# angularjs - 为 jQuery UI 按钮创建 AngularJS 指令

> ID：15603005
> 
> 赞同：3
> 
> 时间：2013-03-24T19:35:47.133
> 
> 标签：angularjs, angularjs-directive

**更新**：带完整解决方案的小提琴：http: [//jsfiddle.net/langdonx/VXBHG/](http://jsfiddle.net/langdonx/VXBHG/)

* * *

为了比较和对比 KnockoutJS 和 AngularJS，我浏览了[KnockoutJS 交互式教程](http://learn.knockoutjs.com/)，在每个部分之后，我会使用我已经知道的一点点 + [AngularJS 参考](http://docs.angularjs.org/api/)在 AngularJS 中重写它。

当我进入[创建自定义绑定](http://learn.knockoutjs.com/#/?tutorial=custombindings)教程的第 3 步时，我认为现在是开始学习 Angular 指令并编写自定义标签的好时机。然后我惨败。

我遇到了两个我无法弄清楚的问题。我创建了一个新的 Fiddle 来尝试了解正在发生的事情......

*   **1**（[小提琴](http://jsfiddle.net/langdonx/gWjXc/6/)）：我想出了我的范围问题，但是，是否有可能只是通过`ng-click`？我可以让它工作的唯一方法是将它重命名为`jqb-click` 这有点烦人。
*   **2**（[小提琴](http://jsfiddle.net/langdonx/gWjXc/5/)）：一旦我申请`.button()`了我的元素，事情就变得很奇怪。我的猜测是因为 Angular 和 jQuery UI 都在处理 HTML。我没想到会这样，但 Angular 似乎`span`为我提供了它自己的`button`（参见 JavaScript 的第 21 行），当然 jQuery UI 也是如此，这是我所期望的。我修改了 HTML 以使其看起来正确，但即使在此之前，任何功能都不起作用。我仍然有范围问题，并且没有模板绑定。我错过了什么？

我知道有一个 AngularUI 项目我应该看一下，我可能会用 CSS 完成我想要做的事情，但在这一点上，更多的是学习如何使用指令而不是认为这是一个好的主意。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-24T21:50:34.037

您可以通过设置参数在指令中创建隔离作用域`scope`，或者通过不设置使其使用父作用域。

由于您想要`ng-click`from 父范围，因此此实例可能最容易在指令中使用父范围：

一个技巧是`$timeout`在模板指令中操作 DOM 之前在指令中使用，以便在操作之前给 DOM 时间重新绘制，否则元素似乎不及时存在。

我使用了一个属性来传递文本，而不是担心嵌入编译。以这种方式，当添加模板时，表达式已经被编译，并且`link`回调提供了对属性的轻松访问。

```
<jqbutton ng-click="test(3)" text="{{title}} 3"></jqbutton> 
```

```
angular.module('Components', [])
    .directive('jqbutton', function ($timeout) {
    return {
        restrict: 'E', // says that this directive is only for html elements
        replace: true,        
        template: '<button></button>', 
        link: function (scope, element, attrs) {
            // turn the button into a jQuery button
            $timeout(function () {
                /* set text from attribute of custom tag*/
                element.text(attrs.text).button();
         }, 10);/* very slight delay, even using "0" works*/
        }
    };
}); 
```

演示：http: [//jsfiddle.net/gWjXc/8/](http://jsfiddle.net/gWjXc/8/)

指令非常强大，但也有一些学习曲线。此外，与 Angular 与淘汰赛相比，Angular 更像是一个元框架，从长远来看，它比淘汰赛具有更大的灵活性

对于理解指令范围非常有帮助：

[https://github.com/angular/angular.js/wiki/The-Nuances-of-Scope-Prototypal-Inheritance](https://github.com/angular/angular.js/wiki/The-Nuances-of-Scope-Prototypal-Inheritance)

# node.js - Socket.io 发出回调不在服务器端触发？

> ID：15603006
> 
> 赞同：2
> 
> 时间：2013-03-24T19:35:52.230
> 
> 标签：node.js, socket.io

我的服务器正确地发出事件，但发出回调永远不会起作用。在下面，我的控制台上没有记录任何内容：

服务器：

```
io.sockets.emit('delete hint', {id: id}, function(data){
                    console.log('callback');
                }); 
```

客户：

```
socket.on('delete hint', function(data){
    // display a message before deleting
    $('#' + data.id).fadeOut(function(){ 
        $(this).remove();
    });
}); 
```

我还尝试将客户端代码作为函数（数据，fn），以防回调需要包含在接收函数中。

我正在使用 Windows，当 socket.io 发出事件时，我的命令提示符显示以下内容：

```
websocket writing 5:::{"name":"delete hint", "args":[{"id":"1"}, null]} 
```

我无法弄清楚问题是什么，我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-21T03:58:17.743

当接收方计算机调用它时，在发送方计算机上执行回调

看看这段代码：

**服务器：**

```
io.sockets.on('connection', connectionFunc);

function connectionFunc (socket) {
    socket.emit('delete hint', "data for client", callThis);
}

//this function is executed when client calls it
function callThis (dataFromClient){

    console.log("Call back fired: " + dataFromClient);
} 
```

**客户：**

```
 socket.on('delete hint', function(data, callback) {

        console.log("i received: "+ data);
        // call back will fire only when u the next line runs
        callback("the callThis function on server will run");            

    }); 
```

您可以以相反的方式执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T19:44:20.603

您需要调用回调。

```
socket.on('delete hint', function(data, cb){
    // display a message before deleting
    $('#' + data.id).fadeOut(function(){ 
        $(this).remove();
        cb(null, 'done');
    });
}); 
```

# c++ - 删除链表 C++ 中的节点

> ID：15603009
> 
> 赞同：2
> 
> 时间：2013-03-24T19:36:12.633
> 
> 标签：c++, linked-list

所以我一直在搜索论坛，但我对语言和链接列表仍然很陌生，所以我几乎无法破译结果。

基本上我为我的链表做了一个删除功能。我目前可以创建列表，遍历列表，排序列表，搜索列表，并在链表中的任何节点之前插入。我从插入中回收了一些代码，以找到列表中可以删除的点。我的主要困惑是如何将以前的点链接到我要删除的节点之后的节点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-24T20:24:04.073

我不会编写一个全新的链表实现，但我可以为您指出代码中的一些问题。

> 诀窍是在要删除的节点之前保持一个节点。

为了清楚起见，我已重命名`entry`为`current`

```
nodetype *current , *first, *next;
int akey;

// With this line your search will start from the second element.
// current =start->ptr;
// Should be
current = start;

// this is not needed. I am assuming the last node has NULL value for '->ptr'
// last=start;
next = current->ptr;

cout<<"Input Data You Would Like To Delete"<<endl;
cin>>akey;

// Check if the first node contains the data
// Assuming the list will have at least one element. i.e. current is not NULL 
while (current->adata == akey)
{
  // Delete it.
  delete current;
  // Update current for the while loop
  current = next;
  // update next too.
  next = current->ptr;
}
// Now we know the first element doesn't contain the data.
// Update the pointer to the begging of the new list if anything is removed from the top.
first = current;

// This has unnecessary checks. 
// ****Specifically (akey!=current->adata) will 
// prevent you from entering the loop if it is false.
// while((akey!=current->adata)&&(current->ptr !=NULL))
while(next != NULL)  // This should be enough
{
     if(next->adata == akey)
     {
          // make the current node (before the 'deletion point') 
          // lined to the one after the 'deletion point (next of the next)
          current->ptr = next->ptr; 
          // delete the node. 
          delete next;
          // Make the next pointer point to the new next. 
          next = current->ptr
     }
    // Otherwise advance both current and next.
     else {
           current = next;
           next = next->ptr; 
     }
}

// Use this to test it.
current = first;
while(current){
    cout<<current->adata<<", ";
    current = current->ptr;
} 
```

这不是最干净的方法。但是，它与您的实现类似，因此您可以看到哪里出错了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-24T20:18:22.410

```
#include <iostream>
#include <string>
                                         // blank line(s) after includes

using namespace std;                     // some people will say to avoid this
                                         // but I use it in examples for brevity

                                         // blank line(s) around class def
class nodetype
{                                        // bracket on its own line
public:                                  // non indented visibility specifier
    nodetype(int value, nodetype *p)     // constructor first declared in class
    {
        adata = value;                   // level of indentation for fn body
        ptr   = p;                       // spaces around operators like =
    }
                                         // blank line(s) between fns and vars
    int adata;
    nodetype *ptr;
};
                                         // blank line(s) between class and fn
void LinkedListDelete(nodetype **start, int akey)
{
    nodetype *current, **previous;       // pointer *s are connected to vars
                                         // blank line between section
    previous = start;
    current  = *start;
                                         // blank line between section
                                         // I use blank lines a lot, they help
                                         // me to organize my thoughts

    while((current != NULL) && (akey != current->adata))
    {                                    // indentation inside nested scope
        previous = &current->ptr;        // no space for unary operators like &
        current  = current->ptr;         // assignments justified to same level
    }

    if (current != NULL)
    {
        *previous = current->ptr;        // no space for unary *, space for =
        delete current;
    }
                                         // more blank lines between sections
    return;
}

void LinkedListPrint(nodetype *list)     // no space for unary *
{                                        // brackets on their own lines
    while (list != NULL)                 // space around !=
    {
        cout << "(Node: " << list->adata << ") ";
        list = list->ptr;                // spaces around <<
    }
    cout << endl;
}

int main()
{
    nodetype *node = new nodetype(5, new nodetype(10, // justified stuff
                     new nodetype(7, new nodetype(14,
                     new nodetype(23, NULL)))));
                                         // blank lines
    cout << "Build linked list: ";
    LinkedListPrint(node);
    cout << "Removed node 7: ";
    LinkedListDelete(&node, 7);
    LinkedListPrint(node);

    return 0;
} 
```

我根据您提供的代码制作了此代码。不完全一样，我改变了一些东西，但它会做你想要的。我不得不猜测 nodetype 的结构是什么，为了方便我添加了一个构造函数。我添加了一些评论，指出我的风格的各个方面。

请注意，它比您最初提供的代码更容易阅读。风格很重要。人们会告诉你必须使用 X 或 Y 风格，但真正重要的是你选择你喜欢的任何风格并始终如一地坚持下去；它将使您更容易快速阅读和理解自己的代码。

相信我，当您编写了大量代码时，您将无法一次记住所有代码，并且能够快速弄清楚您在做什么是必不可少的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T19:48:46.113

考虑下面给出的结构，

```
struct info
{
 int data;
 struct info *next;
}; 
```

如果您使用上述结构将记录存储在链表中，则可以使用以下代码从链表中删除元素，

```
void delitem()
{
  info *curr,*prev;
  int tdata;
  if(head==NULL)
  {
    cout<<"\nNo Records to Delete!!!";
  }
  cout<<"\nEnter the Data to be deleted: ";
  cin>>tdata;
  prev=curr=head;
  while((curr!=NULL)&&(curr->data!=tdata))
  {
    prev=curr;
    curr=curr->next;
  }
  if(curr==NULL)
  {
    cout<<"\nRecord not Found!!!";
    return;
  }
  if(curr==head)
  {
    head=head->next;
    cout<<"\nData deleted: "<<tdata;
  }
  else
  {
    prev->next=curr->next;
    if(curr->next==NULL)
    {
      temp=prev;
    }
    cout<<"\nData deleted: "<<tdata;
  }
  delete(curr);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-03T21:26:02.960

我认为删除一个节点或在链表中插入 ine 过于简单易行，但需要准确了解其机制。这个例子展示了如何添加和删除节点，但它不是一个完整的程序，但它揭示了添加和删除以及移动链表的机制：

```
#include <iostream>
using namespace std;

//class Data to store ages. in a real program this class can be any other
//class for example a student class or customer...
class Data
         {
         public:
               Data(int age):itsAge(age){}
               ~Data(){}
               void SetAge(int age){itsAge=age;}
               int  getAge()const{return itsAge;}
         private:
                int itsAge;
         };

//the most important part of the program is the linked0list
class Node
          {
          public:
                //we just make itsPtrHead when created points to Null even if we pass a pointer to Data that is not NULL
                Node(Data* pData): itsPtrData(pData),itsPtrHead(NULL),itsCount(0){}

                Data* getPdata()const;
                Node* getPnext()const;
                int   getCount()const{return itsCount;}

                void  insertNode(Data*);//import bcause it shoes the mechanism of linked-list
                void  deleteNode(int);//most significant in this program
                Data* findData(int&,int);
                void  print()const;
         private:
                Data* itsPtrData;
                Node* itsPtrHead;
                int   itsCount;

          };

Data* Node::getPdata()const
{
if(itsPtrData)
    return itsPtrData;
else
    return NULL;
}
Node* Node::getPnext()const
{
return itsPtrHead;
}
void Node::insertNode(Data* pData)
{
Node* pNode=new Node(pData);//create a node
Node* pCurrent=itsPtrHead;//current node which points first to the first node that is the "head bode"
Node* pNext=NULL;//the next node

int NewAge=pData->getAge();//the new age that is past to insertNode function
int NextAge=0;//next age
itsCount++;//incrementing the number of nodes

//first we check wether the head node "itsPtrHead" points NULL or not
//so if it is null then we assign it the new node "pNode" and return from insert function
if(!itsPtrHead)
    {
    itsPtrHead=pNode;
    return;
    }
//if the condition above fails (head is not null) then check its value and
//compare it with new age and if the new one is smaller than the head
//make this new one the head and then the original node that head points to it make it its next node to the head
if(itsPtrHead->getPdata()->getAge() > NewAge)
    {
    pNode->itsPtrHead=itsPtrHead;
    itsPtrHead=pNode;
    //exit the function
    return;
    }
//if the condition above fails than we move to the next node and so on
for(;;)
    {
    //if the next node to the current node is null the we set it with this new node(pNode) and exit
    if(!pCurrent->itsPtrHead)
        {
        pCurrent->itsPtrHead=pNode;
        return;
        }
    //else if it not null(next node to current node)
    //then we compare the next node and new node
    pNext=pCurrent->itsPtrHead;
    NextAge=pNext->getPdata()->getAge();
    //if next node's age is greater than new then we want new node 
    //to be the next node to current node then make the original next to current to be the next to its next
    if(NextAge > NewAge)
        {
        pCurrent->itsPtrHead=pNode;
        pNode->itsPtrHead=pNext;
        //exitting
        return;
        }
    //if no condition succeeds above then move to next node and continue until last node
    pCurrent=pNext;
    }
}
// delete a node is a bit different from inserting a node
void Node::deleteNode(int age)
{     
//deleting a node is much like adding one the differecne is a bit trickier
Node* pTmp=itsPtrHead;
Node* pCurrent=itsPtrHead;
Node* pNext=NULL;

//1 checking for wether age (node contains age) to be deleted does exist
for(;pTmp;pTmp=pTmp->itsPtrHead)
    {
    if(pTmp->getPdata()->getAge() == age)
        break;
    }
//if age to be deleted doesn't exist pop up a message and return
if(!pTmp)
    {
    cout<<age<<": Can't be found!\n";
    return;
    }

int NextAge=0;

for(;;)
    {
    //if age to be deleted is on the head node
    if(itsPtrHead->getPdata()->getAge() == age)
        {
        //store the next to head node
        pTmp=itsPtrHead->itsPtrHead;
        //delete head node
        delete itsPtrHead;
        //assign the head new node (node after the original head)
        itsPtrHead=pTmp;
        //decrement the count of nodes
        itsCount--;
        //exiting gracefully
        return;
        }
    //moving to next node
    pNext=pCurrent->itsPtrHead;
    NextAge=pNext->getPdata()->getAge();
    //checking next node age with age to be deleted. if they
    //match delete the next node
    if(NextAge == age)
        {
        //next node holds the target age so we want its NEXT node
        //and store it in pTmp;
        pTmp=pNext->itsPtrHead;//Next node of the target node
        //pCurrent doesn't yet hold the target age but it is the
        //previous node to target node
        //change the next node of pCurrent so that it doesn't
        //point to the target node but instead to the node right
        //after it
        pCurrent->itsPtrHead=pTmp;
        //delete the target node (holds the target age) 
        delete pNext;
        //decrement number of nodes
        itsCount--;
        //exit
        return;
        }
    //if pNext doesn't point to target node move to the next node
    //by making pCurrent points to the next node in the list
    pCurrent=pNext;
    }

}

void Node::print()const
{
Node* pTmp=itsPtrHead;
while(pTmp)
    {
    cout<<"age: "<<pTmp->getPdata()->getAge()<<endl;
    pTmp=pTmp->itsPtrHead;
    }
}
int main()
{
//note this is not a real proram just we show how things works

Data* pData=new Data(6);
Node theNode(pData);
theNode.print();
pData=new Data(19);
theNode.insertNode(pData);
pData=new Data(20);
theNode.insertNode(pData);
pData=new Data(23);
theNode.insertNode(pData);
pData=new Data(25);
theNode.insertNode(pData);
pData=new Data(30);
theNode.insertNode(pData);
pData=new Data(27);
theNode.insertNode(pData);
pData=new Data(33);
theNode.insertNode(pData);
pData=new Data(18);
theNode.insertNode(pData);

theNode.print();
cout<<endl<<endl;

//int age;
//int index;
//cout<<"Age to finde: ";
//cin>>age;
//cout<<endl;
//theNode.Find(index,age);

//cout<<age<<" : Found on index: "<<index<<endl; 

//theNode.modify(age);

//theNode.print();
int age;
cout<<"age to delete: ";
cin>>age;
cout<<endl;

theNode.deleteNode(age);
theNode.print();

cout<<endl<<endl<<endl;
return 0;
}
//modify and other member functions are not the purpose of this program 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-09T12:51:48.210

```
void Delete()
{
    int num;
    cout<<"enter node to delete"<<endl;
    cin>>num;
    node *nodeptr=head;
    node *prev;

    if(head==0)
    {   
        cout<<"list is empty"<<endl;
    }
    else if(head->data==num)
        {
          node *t=head;
          head=head->next;
          delete t; 
        }   
        else
        {
        nodeptr=head;
        prev=head;
        while(nodeptr!=NULL)
        {
            if(nodeptr->data==num)
            {
                prev->next=nodeptr->next;
                node *tem=nodeptr->next;
                delete tem;
            }
            prev=nodeptr;
            nodeptr=nodeptr->next;
        }
        }
} 
```

# json - 循环遍历简单的 json 对象

> ID：15603010
> 
> 赞同：0
> 
> 时间：2013-03-24T19:36:12.923
> 
> 标签：json

如何遍历这个 json 对象来获取每个项目的值？我知道这很容易，但我需要不明白为什么这个 json 对象的第一个和结尾有两个括号 ([])。

```
[// I'm talking about this 
    [
        {
            "id": 2,
            "title": "xxxxxxxxx",
            "author": "mike123",
            "postdate": "March 12, 2013 at 6:46 pm",
            "postdatecreation": "2013-03-12",
            "posteditdate": null,
            "postcontent": "eeeeee",
            "userID": 34
        }
    ]
]// and this 
```

如果我删除它们，json 仍然有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T03:45:47.010

您可以使用 $.each 循环遍历您的 json 对象。这是小提琴：

[http://jsfiddle.net/Ay2UB/](http://jsfiddle.net/Ay2UB/)

这里的结果是一个对象数组的数组。我通过访问索引传递了该对象 results[0] 会给你一个数组 results[0][0] 会给你对象

下面的代码：

```
var results=[
    [
        {
            "id": 2,
            "title": "xxxxxxxxx",
            "author": "mike123",
            "postdate": "March 12, 2013 at 6:46 pm",
            "postdatecreation": "2013-03-12",
            "posteditdate": null,
            "postcontent": "eeeeee",
            "userID": 34
        }
    ]
]

$.each(results[0][0],function(key, value){
  alert(value);
}); 
```

$.each 可用于遍历数组或对象，请按照以下链接获取更多信息：

[http://api.jquery.com/jQuery.each/](http://api.jquery.com/jQuery.each/)

希望能帮助到你。如果我错了，请纠正我。

# iphone - 切换视图控制器时 IIViewDeckController 崩溃

> ID：15603011
> 
> 赞同：0
> 
> 时间：2013-03-24T19:36:14.663
> 
> 标签：iphone, viewdeck

我有一个 IIViewDeckController 设置来复制 facebook 应用程序 funcionaly

```
ViewController *vc = [self.storyboard instantiateViewControllerWithIdentifier:@"ViewController"];
EditSettingsViewController *evc = [self.storyboard instantiateViewControllerWithIdentifier:@"EditSettingsViewController"];
IIViewDeckController* deckController =  [[IIViewDeckController alloc] initWithCenterViewController:vc leftViewController:evc                                                                                rightViewController:nil]; 
```

为了切换，我有一个调用不同方法的表格视图。

当我将中心控制器切换到新控制器时，它会崩溃：

```
MyTableViewController *mvc = [self.storyboard instantiateViewControllerWithIdentifier:@"MyTableViewController"]; 
```

[self.viewDeckController setCenterController:mvc];

但是当我对初始中心视图控制器执行完全相同的操作时，它不会崩溃。

我还注意到，当我重置模拟器中的所有内容时，我可以切换到新控制器一次而不会崩溃。

它没有显示任何警告。只是以下内容：

![错误](../Images/250351480bcdcc40902731f1e05f31f2.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:07:45.307

解决了我的问题。

在最初的控制器中，我使用了 viewdeckDelegate 并实现了一些方法。当切换到新的视图控制器时，我没有在调用这些方法时定义委托。

# java - 使用 Lucene 执行 CONTAINS 的最佳方式？

> ID：15603013
> 
> 赞同：0
> 
> 时间：2013-03-24T19:36:28.950
> 
> 标签：java, lucene

谁能给我一个关于如何使用 Lucene 执行 CONTAINS 搜索的建议？而使用 WildcardQuery 的成本要高得多。我可以使用 FILTER 代替 WildcardQuery 吗？

非常感谢您的支持。

# jpa - JPA - 无法在 PersistenceException 上标记回滚

> ID：15603014
> 
> 赞同：0
> 
> 时间：2013-03-24T19:36:29.700
> 
> 标签：jpa

这是我在这个网站上的第一篇文章，我很确定我会解决我的问题。我在 JPA 方面不太好，所以陷入了一个问题。无法分享完整的代码，但通过以下示例让您了解我想要实现的目标：

```
underOneMethod(){

Person personObj1 = entityManager.createNamedQuery("Select * from Person where smthing..");
personObj1.setFirstName("John");
personObj1 = entityManager.merge(personObj1);
entityManager.flush();

Person personObj2 = entityManager.createNamedQuery("Select * from Person where smthing..");
personObj2.setLastName("Cruz");
personObj2 = entityManager.merge(personObj1);
entityManager.flush();

} // This code throws me exception. I think it will work if I use entityManager.clear() method after first flush call but still it will be good, of someone can me some idea of what is happening in this case and how can it be resolved. Thanks in advance..! 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T19:30:01.507

好吧，我很久以前就得到了答案，但没有时间在这里回复。无论如何，它是回答的好时机。正如我之前的评论中已经提到的那样。我使用 entityManager.clear() 方法并且它有效。希望它对其他人也有帮助.. !!

```
underOneMethod(){

Person personObj1 = entityManager.createNamedQuery("Select * from Person where smthing..");
personObj1.setFirstName("John");
personObj1 = entityManager.merge(personObj1);
entityManager.flush();

entityManager.clear();

Person personObj2 = entityManager.createNamedQuery("Select * from Person where smthing..");
personObj2.setLastName("Cruz");
personObj2 = entityManager.merge(personObj1);
entityManager.flush();

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:15:51.093

您的代码甚至无法编译，createNamedQuery 返回的是 Query 而不是 Person。假设您调用 getSingleResult，但 createNamedQuery 仍采用名称而不是 SQL，因为您需要 createNativeQuery。

此外，不需要合并，因为您刚刚选择了对象，因此它已经被管理。

包括异常堆栈跟踪和真实代码会有所帮助。

# php - 使用 PHP 构建 Node 类

> ID：15603015
> 
> 赞同：1
> 
> 时间：2013-03-24T19:36:42.893
> 
> 标签：php, class, tree, nodes

我需要构建一个 Node 类，它代表一棵节点树，所有这些节点都保存在一个数组中。我知道伪代码和 C++ 的结构，但我认为 PHP 中最好的结构？

像这样的东西：

```
class Node 
{
 //number of nodes from 0 to n
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T19:50:28.020

我认为您应该考虑 [Ardent](https://github.com/morrisonlevi/Ardent)它具有良好的[二叉树](https://github.com/morrisonlevi/Ardent/blob/master/src/Ardent/BinaryTree.php)实现并且还支持[BinarySearchTree](https://github.com/morrisonlevi/Ardent/blob/master/src/Ardent/BinarySearchTree.php)

**例子 ：**

```
 $root = new BinaryTree(7);
    $root->setLeft(new BinaryTree(5));
    $root->setRight(new BinaryTree(8));
    $root->getLeft()->setLeft(new BinaryTree(1));
    $root->getLeft()->setRight(new BinaryTree(6));
    $root->getRight()->setRight(new BinaryTree(9)); 
```

您还可以拥有扩展 BinarySearchTree的[AvlTree](https://github.com/morrisonlevi/Ardent/blob/master/src/Ardent/AvlTree.php)

```
$object = new AvlTree();
    //          5
    //        /    \
    //       2      9
    //     /  \    / \
    //    1    4  8  11
    //        /
    //       3
    $object->add(5);
    $object->add(2);
    $object->add(9);
    $object->add(1);
    $object->add(4);
    $object->add(8);
    $object->add(11);
    $object->add(3); 
```

# ruby - 红宝石“潜艇！” 不替换文本 if/elsif 语句

> ID：15603017
> 
> 赞同：0
> 
> 时间：2013-03-24T19:36:56.047
> 
> 标签：ruby, string, replace, gsub

这让我发疯的时间比它应该的要长得多，我正在使用简单的字符串替换，但它无法根据它获得的信息替换字符串（在这种情况下，它是'url'）。

```
class Test
  myURL = 'www.google.com'
puts 'Where are you from?'
  location = gets
    if location == 'England'
     myURL['.com'] = '.co.uk'
    elsif location == 'France'
     myURL['.com'] = '.co.fr'
    end
puts myURL
end 
```

我要疯了吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-24T19:40:53.780

更改`location = gets`为`location = gets.chomp`

正在发生的事情`gets`是它正在拾取您在提示中键入的所有内容，其中包括`Enter`密钥。因此，如果您输入“英格兰”，那么：

```
location == "England\n" #=> true
location == "England"   #=> false 
```

该[`String#chomp`](http://ruby-doc.org/core-2.0/String.html#method-i-chomp)方法将删除最后的终止行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T19:45:11.897

你只需要这样做：

```
class Test
    myURL = 'www.google.com'
    puts 'Where are you from?'
    location = gets.chomp
    if location == 'England'
        myURL['.com'] = '.co.uk'
    elsif location == 'France'
        myURL['.com'] = '.co.fr'
    end
    puts myURL
end 
```

原因是返回的字符串`gets`末尾有换行符。

# javascript - 将 DFP 广告管理系统中的广告定位到代码页输出动态网址

> ID：15603022
> 
> 赞同：0
> 
> 时间：2013-03-24T19:37:18.027
> 
> 标签：javascript, python, django, google-dfp

我已经看到了如何定义某些广告显示的页面（'tag'，'accountants'）的示例，但我想知道将从我的当前 url 动态拉出标签（或我定义的任何内容）的代码已将我的展示广告定位到来自 dfp。（'标签'，'获取当前网址'）

我在数据库驱动的网站上有超过一千个不同的标签页面，并且需要在某些标签页面上投放某些广告。

我确信这很简单，但没有运气找到需要进入我的网站以通过 url 提取添加的 dfp JavaScript。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T10:19:29.200

我写了一个[jquery dfp 插件](https://github.com/coop182/jquery.dfp.js)，可以让你做到这一点。

它允许您定位域、url 和 url 的查询参数。

看看 github 页面上的默认定位部分，听起来您可能想要使用 inURL 定位...为此，您只需在 DFP 管理员的广告资源部分中添加一个新的自定义定位字符串 inURL然后您可以在订单项的广告定位部分设置自定义标准，一切都应该正常工作......有任何问题让我知道。

# neo4j - Spring data neo4j 的高级映射 vs 简单映射

> ID：15603025
> 
> 赞同：3
> 
> 时间：2013-03-24T19:37:27.547
> 
> 标签：neo4j, spring-data-neo4j, spring-data-graph

我知道使用 Spring data neo4j 的高级映射而不是简单的映射有很多优点。

我的问题是使用高级映射而不是简单映射有**什么缺点？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T08:06:01.190

我觉得使用高级模式几乎没有缺点。唯一困扰我的是 AspectJ 相对较差的 IDE 支持。这最初是一个地狱配置和正确的。除此之外，我们的应用程序使用高级映射模式要快得多，所以我们从不回头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-14T22:14:25.070

根据[这篇文章](https://stackoverflow.com/a/14138759/514402)中的 Q5，如果您通过 REST 风格与 Neo4J 交谈，则更喜欢简单映射，而如果您使用嵌入式 Neo4J，则使用高级映射。

# delphi - 如何递归检测文件的更改？

> ID：15603027
> 
> 赞同：1
> 
> 时间：2013-03-24T19:37:29.060
> 
> 标签：delphi, delphi-xe2, id3v2

我正在开发一个多线程组件来加载和管理音乐库，并且我有一个定义多个要包含的根目录的属性。一个线程在这些目录中搜索媒体文件，根据需要添加/删除，另一个线程遍历这些文件并填写 ID3v2 标记信息。我已经有一种机制来检测添加/删除的文件，但我不知道如何检测更改。

我如何检测何时从其他外部应用程序对这些文件中的任何一个进行了更改？我想要一个即时响应，而不必等待线程访问该文件。当这些文件夹中的任何文件被递归更改时，我有没有办法接收警报？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:07:14.240

您需要使用的功能是[`ReadDirectoryChangesW`](http://msdn.microsoft.com/en-gb/library/windows/desktop/aa365465.aspx). 这不是世界上最容易使用的功能，值得指出的是它不是 100% 可靠的。它有时会无法通知您修改。根据我的经验，股票更有可能发生这种情况。

此 API 可用于同步或异步模式。与往常一样，同步版本更容易编写代码。但当然它会阻塞调用线程。所以解决这个问题的方法是将调用`ReadDirectoryChangesW`放在不同的线程中。如果您有大量的目录要观看，那么每个目录一个观看线程将是一个不可行的负担。如果是这样，那么您将需要处理异步使用。

You`bWatchSubtree`参数允许您监视整个目录树，我认为这是您想要做的。

有关更多详细信息，请参阅这篇文章：[了解 ReadDirectoryChangesW](http://qualapps.blogspot.co.uk/2010/05/understanding-readdirectorychangesw.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T10:58:18.420

尝试这个：

```
uses
  ShlObj, ActiveX;

const
  FILE_LIST_DIRECTORY   = $0001;
  cDir = 'E:\...'; // The directory to monitor

Type
  PFileNotifyInformation = ^TFileNotifyInformation;
  TFileNotifyInformation = Record
    NextEntryOffset: DWORD;
    Action: DWORD;
    FileNameLength: DWORD;
    FileName: Array[0..0] of WideChar;
  End;

type
  TWaitThread = class(TThread)
  private
    FForm: TMainForm;
    procedure HandleEvent;
  protected
    procedure Execute; override;
  public
    constructor Create(Form: TMainForm);
    Procedure SendFtp(F: String; AddIfError: Boolean);
  end;

procedure TWaitThread.HandleEvent;
  Var
  FileOpNotification: PFileNotifyInformation;
  Offset: Longint;
  F: String;
  AList: TStringList;
  I: Integer;
begin

  AList := TStringList.Create;

  Try

    With FForm Do
    Begin

      Pointer(FileOpNotification) := @FNotificationBuffer[0];

      Repeat
        Offset := FileOpNotification^.NextEntryOffset;
        //lbEvents.Items.Add(Format(SAction[FileOpNotification^.Action], [WideCharToString(@(FileOpNotification^.FileName))]));

        F := cDir + WideCharToString(@(FileOpNotification^.FileName));

        if AList.IndexOf(F) < 0 Then
        AList.Add(F);

        PChar(FileOpNotification) := PChar(FileOpNotification)+Offset;

      Until Offset=0;

      For I := 0 To AList.Count -1 Do
      // do whatever you need

    End;

  Finally
    AList.Free;
  End;

end;

constructor TWaitThread.Create(Form: TMainForm);
begin
  inherited Create(True);
  FForm := Form;
  FreeOnTerminate := False;
end;

procedure TWaitThread.Execute;
  Var
  NumBytes: DWORD;
  CompletionKey: DWORD;
begin

  While Not Terminated Do
  Begin

    GetQueuedCompletionStatus( FForm.FCompletionPort, numBytes, CompletionKey, FForm.FPOverlapped, INFINITE);

    if CompletionKey <> 0 Then
    Begin
      Synchronize(HandleEvent);

      With FForm do
      begin
        FBytesWritten := 0;
        ZeroMemory(@FNotificationBuffer, SizeOf(FNotificationBuffer));
        ReadDirectoryChanges(FDirectoryHandle, @FNotificationBuffer, SizeOf(FNotificationBuffer), False, FNotifyFilter, @FBytesWritten, @FOverlapped, nil);
      End;

    End
    Else
    Terminate;

  End;

end;

{MainForm}

  private

    FDirectoryHandle: THandle;
    FNotificationBuffer: array[0..4096] of Byte;
    FWatchThread: TThread;
    FNotifyFilter: DWORD;
    FOverlapped: TOverlapped;
    FPOverlapped: POverlapped;
    FBytesWritten: DWORD;
    FCompletionPort: THandle;

procedure TMainForm.FormCreate(Sender: TObject);
begin

  FCompletionPort := 0;
  FDirectoryHandle := 0;
  FPOverlapped := @FOverlapped;
  ZeroMemory(@FOverlapped, SizeOf(FOverlapped));

  Start;

end;

procedure TMainForm.Start;
begin

  FNotifyFilter := 0;

  FNotifyFilter := FNotifyFilter or FILE_NOTIFY_CHANGE_FILE_NAME;

  FDirectoryHandle := CreateFile(cDir,
                      FILE_LIST_DIRECTORY,
                      FILE_SHARE_READ or FILE_SHARE_WRITE or FILE_SHARE_DELETE,
                      Nil,
                      OPEN_EXISTING,
                      FILE_FLAG_BACKUP_SEMANTICS or FILE_FLAG_OVERLAPPED,
                      0);

  if FDirectoryHandle = INVALID_HANDLE_VALUE Then
  Begin
    Beep;
    FDirectoryHandle := 0;
    ShowMessage(SysErrorMessage(GetLastError));
    Exit;
  End;

  FCompletionPort := CreateIoCompletionPort(FDirectoryHandle, 0, Longint(pointer(self)), 0);
  ZeroMemory(@FNotificationBuffer, SizeOf(FNotificationBuffer));
  FBytesWritten := 0;

  if Not ReadDirectoryChanges(FDirectoryHandle, @FNotificationBuffer, SizeOf(FNotificationBuffer), False, FNotifyFilter, @FBytesWritten, @FOverlapped, Nil) Then
  Begin
    CloseHandle(FDirectoryHandle);
    FDirectoryHandle := 0;
    CloseHandle(FCompletionPort);
    FCompletionPort := 0;
    ShowMessage(SysErrorMessage(GetLastError));
    Exit;
  End;

  FWatchThread := TWaitThread.Create(self);
  TWaitThread(FWatchThread).Resume;

end;

procedure TMainForm.Stop;
begin

  if FCompletionPort = 0 Then
  Exit;

  PostQueuedCompletionStatus(FCompletionPort, 0, 0, Nil);
  FWatchThread.WaitFor;
  FWatchThread.Free;
  CloseHandle(FDirectoryHandle);
  FDirectoryHandle := 0;
  CloseHandle(FCompletionPort);
  FCompletionPort := 0;

end;

procedure TMainForm.FormDestroy(Sender: TObject);
begin
  Stop;
end; 
```

# python - BadRequestError：不支持嵌套事务

> ID：15603028
> 
> 赞同：1
> 
> 时间：2013-03-24T19:37:34.120
> 
> 标签：python, google-app-engine, python-2.7, google-cloud-datastore, jinja2

我目前正在学习[交易](https://developers.google.com/appengine/docs/python/datastore/transactions)，我收到此错误消息：

> BadRequestError：不支持嵌套事务

我不知道如何解决这个问题。任何帮助将不胜感激。

**主文件**

```
import webapp2
import jinja2
import os
import datetime

from google.appengine.ext import db

jinja_environment = jinja2.Environment(
    loader=jinja2.FileSystemLoader(os.path.dirname(__file__)))

class MainPage(webapp2.RequestHandler):
    def get(self):          
        transaction_status = create_message_txn("Python_Board", "message name", "Message Title", "Here is the message text")

        message = Message.all()

        template_values = {
            'transaction_status': transaction_status,
            'message': message,
        }       

        template = jinja_environment.get_template('index.html')
        self.response.out.write(template.render(template_values))

class MessageStore(webapp2.RequestHandler):
    def post(self):
        message = Message()
        message.message_title = self.request.get('message_title')       
        message.message_text = self.request.get('message_text')     
        photo.put() 
        self.redirect('/')      

class MessageBoard(db.Expando):
    pass

class Message(db.Expando):
    pass

def create_message_txn(board_name, message_name, message_title, message_text):
    board = db.get(db.Key.from_path('MessageBoard', board_name))
    if not board:
        board = MessageBoard(key_name=board_name)
        board.count = 0

    message = Message(key_name=message_name, parent=board)
    message.title = message_title
    message.text = message_text
    message.post_date = datetime.datetime.now()

    board.count += 1

    db.put([board, message])

    try:
        db.run_in_transaction(create_message_txn, board_name=board_name,
        message_name=message_title,
        message_title=message_title,
        message_text=message_text)
    except db.TransactionFailedError, e:
        transaction_status = "Transaction failed: %s " %e 

app = webapp2.WSGIApplication([('/', MainPage),
                                ('/new_message',MessageStore)], debug=True) 
```

**索引.html**

```
<html>
    <body>                      
        <form action="/new_photo" method="post">            
            <label for="message_title">Message Title</label>
            <div><textarea name="message_title" rows="1" cols="60" id="message_title"></textarea></div>         
            <label for="message_text">Message Text</label>
            <div><textarea name="message_text" rows="3" cols="60" id="message_text"></textarea></div>                       
            <input type="submit" value="Submit">
        </form>
        <div><hr></hr></div>        
        <div><b>{{ transaction_status }}</b></div>          
        <div><hr></hr></div>            
        {% for m in message(limit=5): %}
        <div><b>{{ m.title }}</b></div>
        <div>{{ m.text }}</div>
        <div>{{ m.date }}</div>
        <div><hr></hr></div>        
        <b>{% endfor %}</b>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T19:48:05.793

看起来你正在递归调用`create_message_txn`

```
def create_message_txn():

    # code happening here
    db.run_in_transaction(create_message_txn, board_name=board_name 
```

^`run_in_transaction`调用`create_message_txn`哪个调用`run_in_transaction`哪个调用等...

您可以通过将要作为事务运行的代码分解为单独的函数来解决此问题

# meteor - 在本地主机上使用带有 Meteor 的 MongoHQ 数据库

> ID：15603031
> 
> 赞同：0
> 
> 时间：2013-03-24T19:37:40.500
> 
> 标签：meteor, mongohq

我想知道如何让 MongoHQ 数据库在我本地安装的 Meter 上工作。

我尝试使用 settings.json 方法或 `MONGO_URL=mongodb://user:pass@xxxx.mongohq.com:10061/xxxx`启动流星时的方法，但两者都不起作用，并且可能是错误的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T19:57:41.217

在项目目录中的终端中像这样运行它

```
MONGO_URL=mongodb://user:pass@xxxx.mongohq.com:10061/xxxx meteor 
```

或者

```
export MONGO_URL=mongodb://user:pass@xxxx.mongohq.com:10061/xxxx
meteor 
```

# java - 使用杰克逊删除 JSON 元素

> ID：15603033
> 
> 赞同：43
> 
> 时间：2013-03-24T19:37:45.607
> 
> 标签：java, json, jackson

我有一个特定的 JSON 节点，它对应于 import org.codehaus.jackson.JsonNode，而不是 import org.codehaus.jackson.map.JsonNode。

```
[
    {
        "givenName": "Jim",
        "formattedName": "jimJackson",
        "familyName": null,
        "middleName": "none",
        "honorificPrefix": "mr",
        "honorificSuffix": "none"
    },
    {
        "givenName": "john",
        "formattedName": "johnLasher",
        "familyName": null,
        "middleName": "none",
        "honorificPrefix": "mr",
        "honorificSuffix": "none"
    },
    {
        "givenName": "carlos",
        "formattedName": "carlosAddner",
        "familyName": null,
        "middleName": "none",
        "honorifiPrefix": "mr",
        "honorificSuffix": "none"
    },
    {
        "givenName": "lisa",
        "formattedName": "lisaRay",
        "familyName": null,
        "middleName": "none",
        "honorificPrefix": "mrs",
        "honorificSuffix": "none"
    },
    {
        "givenName": "bradshaw",
        "formattedName": "bradshawLion",
        "familyName": null,
        "middleName": "none",
        "honorificPrefix": "mr",
        "honorificSuffix": "none"
    },
    {
        "givenName": "phill",
        "formattedName": "phillKane",
        "familyName": null,
        "middleName": "none",
        "honorificPrefix": "mr",
        "honorificSuffix": "none"
    },
    {
        "givenName": "Gabriel",
        "formattedName": "gabrielMoosa",
        "familyName": null,
        "middleName": "none",
        "honorificPrefix": "mr",
        "honorificSuffix": "none"
    }
] 
```

我想从上述数组的所有 JSON 节点中删除“familyName”和“middleName”。有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-03-24T21:36:08.810

我没有对此进行测试，但我认为这样的事情会做你想要的：

```
import org.codehaus.jackson.node.ObjectNode;
// ...
for (JsonNode personNode : rootNode) {
    if (personNode instanceof ObjectNode) {
        ObjectNode object = (ObjectNode) personNode;
        object.remove("familyName");
        object.remove("middleName");
    }
} 
```

您也可以使用 Jackon 的原始解析 API 更有效地执行此操作，但代码会更加混乱。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-03-01T07:11:56.823

Jackson 的 ObjectMapper 只需几个步骤即可提供解决方案。

将 json 数据保存在一个文件中，比如“data.json”。将以下代码复制到没有导入语句的函数中并调用该函数。生成的 JSON 将被写入新文件“data1.json”。

```
import java.io.File;
import java.io.IOException;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.node.ObjectNode;
ObjectMapper objectMapper = new ObjectMapper();
        JsonNode jsonNode = objectMapper.readTree(new File("data.json"));
        for (JsonNode node : jsonNode) {
            ((ObjectNode)node).remove("familyName");
            ((ObjectNode)node).remove("middleName");
        }
        objectMapper.writeValue(new File("data1.json"), jsonNode); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-08T06:59:36.920

我最近遇到了这个问题，因为我有一段不寻常的 JSON 需要删除以下元素：

```
{
   "allan": { "score": 88 },
   "bill": { "score": 75 },
   "cassie": { "score": 96 },
   "warnings": [ { "name": "class_low_numbers", "message": "this class is has less than 10 students" }]
} 
```

前三个元素代表一个人和一个相应的分数对象。最后一个“警告”，与分数对象不匹配，这就是我要删除的那个。

从上面gsteff的回答中将rootNode作为起始JsonNode，我发现删除它的方法是遍历每个节点，将节点的对象映射版本添加到HashMap，这是我想要的返回对象，*除非*它是“警告”元素：

```
HashMap<String, ScoreDetails> results = new HashMap<String, ScoreDetails>();

ObjectMapper mapper = new ObjectMapper();
mapper.configure(MapperFeature.ACCEPT_CASE_INSENSITIVE_PROPERTIES, true);
mapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);

Iterator<Map.Entry<String, JsonNode>> fields = rootNode.fields();
while (fields.hasNext()) {
  Map.Entry<String, JsonNode> next = fields.next();
  if (!next.getKey().equals("warnings")) {
    results.put(
        next.getKey(), mapper.treeToValue(next.getValue(), ScoreDetails.class));
  }
}

return results; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-24T23:35:50.587

也可以使用 gsteff 编写的答案，但我认为更简单的方法是使用对象映射器转换为 JSONArray 而不是 JsonNode 并从那里开始。

```
ObjectMapper mapper = new ObjectMapper();
String stringJsonArray = mapper.writeValueAsString(list);
JSONArray csvDatabindedtoBean = new JSONArray(stringJsonArray);
        JSONArray finalArray = new JSONArray();
for (int val = 0; val < csvDatabindedtoBean.length(); val++) {
            JSONObject finalObject = csvDatabindedtoBean.getJSONObject(val);
                finalObject.remove("familyName");
                finalObject.remove("middleName");

            }
            finalArray.put(finalObject);
        } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-10-07T05:51:21.737

[根据 JSONObject 文档](http://docs.oracle.com/javaee/7/api/javax/json/JsonObject.html)，JSONObject 实现了 Map.remove，它返回存储在该键处的值。像这样使用它

```
JSONObject json = new JSONObject();
json.put("key", "value");
String str = (String)json.remove("key"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-06T08:50:30.013

我需要的是从具有特定前缀键的平面根对象中删除元素。我的解决方案是这样的：

```
Iterator<String> it = jsonNode.fieldNames();
        while (it.hasNext()) {
            String nextKey = it.next();
            if (nextKey.startsWith("prefix")) {
                it.remove();
                ((ObjectNode)jsonNode).remove(nextKey);
            }
        } 
```

请记住，您还必须从迭代器中删除元素，否则您将获得 ConcurrentAccess 类型的异常。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2013-03-24T20:29:13.890

您可以创建一个新的 JSONObject，读取除“familyName”和“middleName”之外的所有节点，然后将它们全部保存到一个新文件中。这是一个例子。[JSON.Simple Example – 读写 JSON](http://www.mkyong.com/java/json-simple-example-read-and-write-json/)

# php - Zend：致命错误：构造函数 Zend\Stdlib\Glob::glob() 不能是静态的

> ID：15603034
> 
> 赞同：2
> 
> 时间：2013-03-24T19:37:49.783
> 
> 标签：php, xampp, zend-framework2

我在 Mac OS X 10.6.8 上使用 XAMPP，我只是在设置我的第一个 Zend 应用程序并尝试设置 Skeleton 应用程序，按照手册中的所有步骤操作，但不断得到：`Fatal error: Constructor Zend\Stdlib\Glob::glob() cannot be static in /Applications/XAMPP/xamppfiles/htdocs/www/zf2-tutorial/vendor/zendframework/zendframework/library/Zend/Stdlib/Glob.php on line 193`

我已经搜索了这个问题并返回了旧版本的 php，但是当我从骨架应用程序的目录中终端 php -v 时，我得到：

```
PHP 5.3.4 (cli) (built: Dec 15 2010 12:15:07) 
Copyright (c) 1997-2010 The PHP Group
Zend Engine v2.3.0, Copyright (c) 1998-2010 Zend Technologies
bens-imac:zf2-tutorial Ben$ 
```

所以我不明白问题可能是什么，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-14T09:03:13.460

您使用的是什么版本的 PHP？对于 PHP 5.3.3 及更高版本，这应该不是问题...我已经尝试过 5.3.3、5.3.11 和 5.4.1，并且没有错误。:)

# java - 通过选择 JComboBox 选项动态添加 JTextFields 和 JLabels

> ID：15603036
> 
> 赞同：0
> 
> 时间：2013-03-24T19:37:53.030
> 
> 标签：java, sql, swing, jtextfield, jcombobox

我想编写一个程序，允许用户连接、查看和添加或删除数据库中的值。我被摆动部分卡住了。当我选择一个组合框选项时，什么也没有发生，但我想创建一个像 mysql 工作台这样的视图。应该是这样的；用户从组合框中选择一个表名，并且可以从该表和文本字段中查看列名，以在列名上方添加新值或现有值。

到目前为止，我的代码是这样的：

```
public class DBC extends JFrame{

static String tablo;
static JTextField tf = new JTextField(20);
static int columnCount;
static JPanel tfPanel = new JPanel();
static JLabel depName = new JLabel("Name");
static JLabel depLocation = new JLabel("Location");
static Box box = new Box(BoxLayout.Y_AXIS);

public static void main(String[] args) throws Exception {

    Class.forName("com.mysql.jdbc.Driver");
    Connection connect = DriverManager.getConnection("jdbc:mysql://localhost:3306/project"
              ,"root","123456789");

    final Statement statement = connect.createStatement();

    JLabel tabloSec = new JLabel("Tablo Seçin:");
    final JComboBox<String> tablolar = new JComboBox<String>();
    DatabaseMetaData md = connect.getMetaData();
    final ResultSet rs = md.getTables(null, null, "%", null);
    while (rs.next()) {
        tablolar.addItem(rs.getString(3));
    }

    tablolar.addActionListener(new ActionListener(){

        @Override
        public void actionPerformed(ActionEvent arg0) {

            tablo = tablolar.getSelectedItem().toString();

            try {
                 columnCount = rs.getMetaData().getColumnCount();
                 for(int i=0;i<=columnCount;i++ ){

                        box.add(tf);
                    }
            } catch (SQLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    });

    JButton ekle = new JButton("Ekle");
    ekle.addActionListener(new ActionListener(){

        @Override
        public void actionPerformed(ActionEvent e) {

            try {
                switch(tablo){
                case "department":

                    statement.executeUpdate("INSERT INTO department(Name,Location) VALUES('"+tf.getText()+"')");
                case "employee":

                    statement.executeUpdate("INSERT INTO employee(Id,FirstName,LastName,Sex,Address,Email,Salary,BirthDate,JoinDate) VALUES('"+tf.getText()+"')");
                case "engineer":

                    statement.executeUpdate("INSERT INTO engineer(EngineerType) VALUES('"+tf.getText()+"')");
                case "manager":

                    statement.executeUpdate("INSERT INTO manager(Department) VALUES('"+tf.getText()+"')");
                case "project":

                    statement.executeUpdate("INSERT INTO project(Name,Number,Value) VALUES('"+tf.getText()+"')");
                case "secretary":

                    statement.executeUpdate("INSERT INTO secretary(TypingSpeed) VALUES('"+tf.getText()+"')");
                }

            } catch (SQLException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }
        }
    });

    JButton cik = new JButton("Çık");
    cik.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent e) {

            System.exit(0);
        }
    });

    JPanel panel = new JPanel(new GridLayout(4,3));

    panel.add(tabloSec);
    panel.add(tablolar);
    panel.add(box);
    panel.revalidate();
    panel.add(ekle);
    panel.add(cik);

    JFrame frame = new JFrame("Deneme");
    frame.setSize(600,600);
    frame.setLocationRelativeTo(null);
    frame.add(panel);
    frame.pack();
    frame.setVisible(true);
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:42:13.420

看起来您在遍历结果集的元数据时添加了相同的文本字段：`box.add(tf);`. 这将只添加一次相同的文本字段。在向容器添加新控件后，您还需要`validate()`和容器。请注意，在选择新表时，您还需要从容器中删除所有控件。您可能需要引入滚动窗格。另外，SQL 语句的执行是指同一个文本域。除非当然只有一列和一个值总是应该更新。`repaint()``box``box`

总而言之，除非这是针对一组非常具体的表格的非常具体的解决方案，否则您可以考虑为此使用更友好的控件，可能是列表或表格。可能类似于属性表，其中第一列指定属性的名称，第二列指定该属性的值。值列是可编辑的。选择新的 SQL 表后，您可以重新填充属性表。然后在执行语句时，只需收集所有必要的值。作为替代方案，您还可以显示 SQL 表的相关视图，让用户调整任何值，然后在完成后更新 SQL。查看@camickr 的[数据库中的表。](http://tips4java.wordpress.com/2009/03/12/table-from-database/)

另请注意，您不应在 上执行 SQL 语句`Event Dispatch Thread`，这可能会冻结您的 UI，因为长时间操作会阻塞 EDT。这些操作应该在辅助工作线程上处理。请参阅[事件调度线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)。使用[SwingWorker](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html)来处理这些冗长的任务是很常见的。

# xcode - 在 Xcode 中使用 NLTK

> ID：15603040
> 
> 赞同：0
> 
> 时间：2013-03-24T19:38:05.773
> 
> 标签：xcode, nltk, wordnet

我需要在 xcode 中标记并找到句子中单词的一些同义词。我知道 NLTK 有一些软件包可以做到这一点。但是 NLTK 接口在 python 中。有人知道如何在 xcode 中使用 NLTK 吗？或任何其他在 xcode 中使用 wordnet 的方式？谢谢， 阿哈德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:59:27.273

除非它们具有约束力，否则我认为这不可能/很容易做到。

# python - 在 Python 中读取缓冲区中块的最节省内存的方法

> ID：15603044
> 
> 赞同：5
> 
> 时间：2013-03-24T19:38:27.197
> 
> 标签：python, performance, optimization, buffer, chunking

我有一个行的文本文件（几 GB 和 ~ 1200 万行），其中每行是一个点 x、y、z 和附件信息。我希望逐块读取文件，处理点并拆分（遵循基于点位置的空间索引，尊重 0.25 m 的方形网格）结果在临时文件夹中的几个文本文件中。

```
449319.34;6242700.23;0.38;1;1;1;0;0;42;25;3;17;482375.326087;20224;23808;23808
449310.72;6242700.22;0.35;3;1;1;0;0;42;23;3;17;482375.334291;20480;24576;24576
449313.81;6242700.66;0.39;1;1;1;0;0;42;24;3;17;482375.342666;20224;24576;24576
449298.37;6242700.27;0.39;1;1;1;0;0;42;21;3;17;482375.350762;18176;22784;23552
449287.47;6242700.06;0.39;11;1;1;0;0;42;20;3;17;482375.358921;20736;24832;24832
449290.11;6242700.21;0.35;1;1;1;0;0;42;20;3;17;482375.358962;19968;24064;23808
449280.48;6242700.08;0.33;1;1;1;0;0;42;18;3;17;482375.367142;22528;25856;26624
449286.97;6242700.44;0.36;3;1;1;0;0;42;19;3;17;482375.367246;19712;23552;23296
449293.03;6242700.78;0.37;1;1;1;0;0;42;21;3;17;482375.367342;19456;23296;23808
449313.36;6242701.92;0.38;6;1;1;0;0;42;24;3;17;482375.367654;19968;24576;24576
449277.48;6242700.17;0.34;8;1;1;0;0;42;18;3;17;482375.375420;20224;23808;25088
449289.46;6242700.85;0.31;3;1;1;0;0;42;20;3;17;482375.375611;18944;23040;23040 
```

哪里`";"`是分隔符和`first two columns the x and y`任何有用的给`ID position`

输出结果是另一个文本文件，其中每个 ID 仅随机提取一个点

前任：

```
 20;10;449319.34;6242700.23;0.38;1;1;1;0;0;42;25;3;17;482375.326087;20224;23808;23808
    20;10;449310.72;6242700.22;0.35;3;1;1;0;0;42;23;3;17;482375.334291;20480;24576;24576
    20;10;449313.81;6242700.66;0.39;1;1;1;0;0;42;24;3;17;482375.342666;20224;24576;24576
    20;10;449298.37;6242700.27;0.39;1;1;1;0;0;42;21;3;17;482375.350762;18176;22784;23552
    20;11;449287.47;6242700.06;0.39;11;1;1;0;0;42;20;3;17;482375.358921;20736;24832;24832
    20;11;449290.11;6242700.21;0.35;1;1;1;0;0;42;20;3;17;482375.358962;19968;24064;23808 
```

其中前两列是 ID

最终输出将是（示例）没有 ID 值

```
 20;10;449313.81;6242700.66;0.39;1;1;1;0;0;42;24;3;17;482375.342666;20224;24576;24576
         20;11;449287.47;6242700.06;0.39;11;1;1;0;0;42;20;3;17;482375.358921;20736;24832;24832 
```

我正在使用此[博客中的解决方案](http://effbot.org/zone/readline-performance.htm)

```
# File: readline-example-3.py

file = open("sample.txt")

while 1:
    lines = file.readlines(100000)
    if not lines:
        break
    for line in lines:
        pass # do something 
```

我的代码如下：

```
from __future__ import division
import os
import glob
import tempfile
import sys

def print_flulsh(n, maxvalue = None):
    sys.stdout.write("\r")
    if maxvalue is None:
        sys.stdout.write("Laser points processed: %d" % n)
    else:
        sys.stdout.write("%d of %d laser points processed" % (n, maxvalue))
    sys.stdout.flush()

def point_grid_id(x, y, minx, maxy, size):
    """give id (row,col)"""
    col = int((x - minx) / size)
    row = int((maxy - y) / size)
    return row, col

def tempfile_tile_name(line, temp_dir, minx, maxy, size, parse):
    x, y = line.split(parse)[:2]
    row, col = point_grid_id(float(x), float(y), minx, maxy, size)
    return os.path.normpath(os.path.join(temp_dir + os.sep,"tempfile_%s_%s.tmp" % (row, col)))

# split the text file in small text files following the ID value given by tempfile_tile_name
# where:
# filename : name+path of text file
# temp_dir: temporary folder
# minx, maxy: origin of the grid (left-up corner)
# size: size of the grid
# parse: delimeter of the text file
# num: number of lines (~ 12 millions)

def tempfile_split(filename, temp_dir, minx, maxy, size, parse, num):
    index = 1
    with open(filename) as file:
        while True:
            lines = file.readlines(100000)
            if not lines:
                break
            for line in lines:
                print_flulsh(index, num)
                index += 1
                name = tempfile_tile_name(line, temp_dir, minx, maxy, size, parse)
                with open(name, 'a') as outfile:
                    outfile.write(line) 
```

我的代码的主要问题是当大约 200 万个拆分文本文件保存在临时文件夹中时速度会降低。我想知道`effbot.org`是否有一种优化的方法来创建缓冲区的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T09:34:29.110

代码中的瓶颈不在于读取，而在于打开和关闭每行读取的输出文件。在评论中，您提到了您的最终目标：*拆分后，我需要再次打开每个文件并随机选择一行。*

theodox 提到了一种可能的方法，*为每个 ID 获取第一个条目，然后在内存中随机覆盖它*。请注意，覆盖必须以概率 1/ *n*发生，其中*n*是到目前为止看到的具有相同 ID 的行数，以避免对以后的样本产生偏差。

编辑。您可以通过对文件执行两次传递来节省内存。第一遍构建一组被随机选择排除的行号，第二遍处理未排除的行。

```
from random import random

def random_selection(filename, temp_dir, minx, maxy, size, parse, num):
    selection = {}
    excluded = set()
    with open(filename) as file:
        for i, line in enumerate(file):
            x, y, _ = line.split(parse, 2)
            row_col = point_grid_id(float(x), float(y), minx, maxy, size)
            try:
                n, selected_i = selection[row_col]
            except KeyError:
                selection[row_col] = 1, i
            else:
                n += 1
                if random() < 1.0 / n:
                    excluded.add(selected_i)
                    selected_i = i
                selection[row_col] = n, selected_i

    with open(filename) as file:
        for i, line in enumerate(file):
            if i not in excluded:
                #process the line 
```

# oracle - Pl/SQL 代码没有给出任何输出

> ID：15603046
> 
> 赞同：0
> 
> 时间：2013-03-24T19:38:58.027
> 
> 标签：oracle, plsql

我是 PL/SQL 编码的初学者。这是一个测试程序。

你能告诉我没有输出的原因吗？

请指导我。

```
create or replace package menu as
procedure show(name varchar2);

end menu;
/

create or replace package body menu as
procedure show(name varchar2) AS
new_number number;
begin
select count(*) into  new_number from stock;

dbms_output.put_line('This is output.');

end;
end menu;
/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T19:40:15.267

您需要手动将 Oracle 设置为向控制台输出行：

```
set serveroutput on; 
```

这应该是代码中的第一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T07:20:57.850

1.  正如其他人所说，SQL*Plus 只会在您先从 DBMS_OUTPUT 获取输出`SET SERVEROUT ON`。
2.  您的代码只是在数据库上编译和存储一个数据库包；你实际上并没有*运行*它。要运行它，您将执行如下操作：

    ```
    BEGIN menu.show('something'); END;
    / 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T09:58:30.737

请阅读[文档](http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_output.htm#i1000634)

> ```
> Operational Notes
> 
> If you do not call GET_LINE, or if you do not display the messages on your screen in SQL*Plus, the buffered messages are ignored.
> 
> SQL*Plus calls GET_LINES after issuing a SQL statement or anonymous PL/SQL calls.
> 
> Typing SET SERVEROUTPUT ON in SQL*Plus has the effect of invoking
> 
> DBMS_OUTPUT.ENABLE (buffer_size => NULL);
> with no limit on the output.
> 
> You should generally avoid having application code invoke either the DISABLE Procedure or ENABLE Procedure because this could subvert the attempt of an external tool like SQL*Plus to control whether or not to display output.
> 
> Note:
> Messages sent using DBMS_OUTPUT are not actually sent until the sending subprogram or trigger completes. There is no mechanism to flush output during the execution of a procedure.
> Exceptions
> 
> DBMS_OUTPUT subprograms raise the application error ORA-20000, and the output procedures can return the following errors:
> 
> Table 68-1 DBMS_OUTPUT Errors
> 
> Error Description
> ORU-10027:     Buffer overflow
> ORU-10028:     Line length overflow
> 
> Rules and Limits
> 
> The maximum line size is 32767 bytes.
> 
> The default buffer size is 20000 bytes. The minimum size is 2000 bytes and the maximum is unlimited. 
> ```

所以 SET SERVEROUTPUT ON 仅适用于 SQL*Plus。

# c# - Monodevelop 4.0 没有代码视图

> ID：15603056
> 
> 赞同：7
> 
> 时间：2013-03-24T19:39:52.000
> 
> 标签：c#, mono, gtk, monodevelop, kde4

我正在开发一个应用程序（[http://sourceforge.net/projects/audiocuesheet/](http://sourceforge.net/projects/audiocuesheet/)）并使用fedora。因为fedora 的rpm 来自monodevelop 2.8.x，我需要monodevelop 4.0 的特性。我下载了 tarball 并构建了 monodevelop。如前所述，它工作得很好，但我无法查看我的源文件的来源（屏幕截图）。

[![截屏](../Images/8cf70e677dced6eeff4baa625d3b2379.png)](https://i.stack.imgur.com/vRUAj.png)

有谁知道，为什么这会失败？我尝试在没有重定向的情况下启动 monodevelop，但找不到任何错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-26T10:30:07.510

这是一个已知的错误。

唯一的解决方案（就目前而言）是在 KDE 设置 -> 应用程序外观中更改您的 GTK 主题。

他们说（错误已在某处提交）这是主题本身的问题，但我很难相信......我猜你设置了oxygen-gtk，将其更改为，例如，Raleigh，它会起作用。

记得重新启动 monodevelop ;-)

我喜欢氧气主题，我发现它是 md-4.0 最烦人的问题。

编辑： http: [//mono.1490590.n4.nabble.com/Text-editor-problem-with-monodevelop-4-0-td4658742.html](http://mono.1490590.n4.nabble.com/Text-editor-problem-with-monodevelop-4-0-td4658742.html) - 这是我找到解决方案的地方。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-25T08:08:42.513

这可能是由于oxygen-gtk-theme 的问题。见[这里](https://bugs.kde.org/show_bug.cgi?id=316995)。将环境变量 OXYGEN_DISABLE_INNER_SHADOWS_HACK 设置为 1 启动 Monodevelop。

在外壳中：

```
export OXYGEN_DISABLE_INNER_SHADOWS_HACK=1
monodevelop 
```

你也可以把它作为一个 shell 脚本放到 /usr/local/bin/monodevelop。然后使用这个环境变量自动启动monodevelop。

```
#!/bin/sh
export OXYGEN_DISABLE_INNER_SHADOWS_HACK=1
/usr/bin/monodevelop 
```

请记住使其可执行`sudo chmod a+x /usr/local/bin/monodevelop`

# c++ - C++ 连接两个 .cpp 文件

> ID：15603059
> 
> 赞同：2
> 
> 时间：2013-03-24T19:40:16.173
> 
> 标签：c++

我在 C++ 中连接两个 .cpp 文件时遇到问题。这是我的文件

头文件.h

```
//Header.h
template <class T> class asd{
asd();
check();
print();
} 
```

文件1.cpp

```
//file1.cpp
//defines all methods in class asd
#include "Header.h"
template<class T> asd<T>:: asd(T a, T b){//codes}
template<class T> T asd<T>:: check(T a){//codes}
template<class T> void asd<T>::print(){//codes} 
```

文件2.cpp

```
//file2.cpp
//main method
#include "Header.h"
int main(){//codes} 
```

我不明白的是，当我将 main() 放入 file1.cpp 时代码运行良好，但是当我将它们分成两个文件时它不会编译。有人可以指点吗？

编辑：对于那些有同样问题的人，可以在这里找到解决方案： [http ://www.cplusplus.com/forum/articles/14272/](http://www.cplusplus.com/forum/articles/14272/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T19:42:00.663

类模板的成员函数应该出现在头文件中。只需将函数定义从`file1.cpp`移至`Header.h`.

想象一下你是编译器。编译时`main`，如果您尝试以`asd`任何方式实例化，编译器需要能够看到函数定义以生成适当的代码。例如，如果`main`你这样做`asd<int> my_asd;`，编译器需要`asd`用`T`替换为实例化`int`。如果它看不到函数定义，它就不能对函数执行此操作。

# c# - 调用方法时未处理的异常

> ID：15603060
> 
> 赞同：-4
> 
> 时间：2013-03-24T19:40:26.517
> 
> 标签：c#, exception

我想将列表中的数字传递给 Player 类并打印它们，但是当我尝试编译它时给我一个例外。我的错误在哪里？

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Collections;
using System.Reflection;

namespace Game
{
    public class Poker
    {
        public static void Main()
        {
            Player cards = new Player();

        }
    }

    public class Shuffle : Poker
    {
        public static List<int> numbers = new List<int>();
        Random random = new Random();

        public Shuffle()
        {
            for (int runs = 0; runs < 530; runs++)
            {
                int number = random.Next(1, 53);
                if (!numbers.Contains(number))
                {
                    numbers.Add(number);
                }
            }
        }
    }

    public class Player : Shuffle
    {

        private static int cardOne = numbers[0];
        private static int cardTwo = numbers[1];
        private static int cardThree = numbers[2];
        private static int cardFour = numbers[3];

        public static void playerOne()
        {
            Console.WriteLine(cardOne);
            Console.WriteLine(cardTwo);
        }

        public static void playerTwo()
        {
            Console.WriteLine(cardThree);
            Console.WriteLine(cardFour);
        }
    }
} 
```

当崩溃发生时，它说： 当崩溃发生时，它说： 当崩溃发生时，它说：

```
Unhandled Exception: System.TypeInitializationException: The type initializer fo
r 'Poker.Player' threw an exception. ---> System.ArgumentOutOfRangeException: In
dex was out of range. Must be non-negative and less than the size of the collect
ion.
Parameter name: index
   at System.ThrowHelper.ThrowArgumentOutOfRangeException()
   at System.Collections.Generic.List`1.get_Item(Int32 index)
   at Poker.Player..cctor() in c:\Users\Pc\Documents\Visual Studio 2012\Projects
\PokerProject\TestShit\ShuffleCards.cs:line 42
   --- End of inner exception stack trace ---
   at Poker.Player..ctor()
   at Poker.Poker.Main() in c:\Users\Pc\Documents\Visual Studio 2012\Projects\Po
kerProject\TestShit\ShuffleCards.cs:line 15
Press any key to continue . . . 
```

代码是固定的。现在运行和编译：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Collections;
using System.Reflection;

namespace Game
{
    public class Poker
    {
        public static void Main()
        {
            Player cards = new Player();
            cards.playerOne();
            cards.playerTwo();
            cards.playerThree();
            cards.playerFour();
        }
    }

    public class Shuffle : Poker
    {
        protected List<int> numbers = new List<int>();
        Random random = new Random();

        public Shuffle()
        {
            for (int runs = 0; runs < 530; runs++)
            {
                int number = random.Next(1, 53);
                if (!numbers.Contains(number))
                {
                    numbers.Add(number);
                }
            }
        }
    }

    public class Player : Shuffle
    {
        private static int cardOne;
        private static int cardTwo;
        private static int cardThree;
        private static int cardFour;
        private static int cardFive;
        private static int cardSix;
        private static int cardSeven;
        private static int cardEight;

        public Player()
        {
            cardOne = numbers[0];
            cardTwo = numbers[1];
            cardThree = numbers[2];
            cardFour = numbers[3];
            cardFive = numbers[4];
            cardSix = numbers[5];
            cardSeven = numbers[6];
            cardEight = numbers[7];
        }

        public void playerOne()
        {
            Console.Write("Player one cards: ");
            Console.WriteLine(cardOne + " " + cardTwo);         
            Console.WriteLine();
        }

        public void playerTwo()
        {
            Console.Write("Player two cards: ");
            Console.WriteLine(cardThree + " " + cardFour);
            Console.WriteLine();
        }

        public void playerThree()
        {
            Console.Write("Player three cards: ");
            Console.WriteLine(cardFive + " " + cardSix);
            Console.WriteLine();
        }

        public void playerFour()
        {
            Console.Write("Player four cards: ");
            Console.WriteLine(cardSeven + " " + cardEight);
            Console.WriteLine();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T19:44:18.297

您有一个接受两个整数的方法，并且您尝试在不传递任何参数的情况下调用它：

```
public static void playerOne(int cardOne, int cardTwo) 
```

但是你这样称呼它：

```
cards.playerOne(); 
```

你需要通读你的代码，看看它是如何工作的，也许阅读一些关于 C# 基础的文章？

我明白你想做什么。您想在方法中使用内部变量，但在方法的参数中包含它们。

```
public static void playerOne(int cardOne, int cardTwo)
{
    Console.WriteLine(cardOne);
    Console.WriteLine(cardTwo);
} 
```

应该：

```
public static void playerOne()
{
    Console.WriteLine(cardOne);
    Console.WriteLine(cardTwo);
} 
```

# objective-c - NSUserScriptTask：接受的文件类型？

> ID：15603062
> 
> 赞同：3
> 
> 时间：2013-03-24T19:40:37.367
> 
> 标签：objective-c, cocoa, appstore-sandbox

我正在使用 NSUserScriptTask 运行用户放置在 Application Scripts 目录中的脚本。但是，我发现很难找出 NSUserScriptTask 接受哪些已知类型的脚本，并且[文档](http://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSUserUnixTask_Class/Reference/Reference.html#//apple_ref/occ/cl/NSUserUnixTask)也没有多大帮助......有什么想法吗？

到目前为止，我已经尝试过这些：

*   .sh
*   .applescript
*   .scpt
*   .scptd
*   。文本

并且无法让它们中的任何一个工作（该`initWithURL:error:`方法返回 nil）

**编辑：** 我忘了包括错误！傻我...这是打印在日志上的内容：

```
Error Domain=NSCocoaErrorDomain Code=259 "The file “Untitled.applescript” couldn’t be opened because it isn’t in the correct format." UserInfo=0x100121f50 {NSURL=file://localhost/Users/path to file/Untitled.applescript, NSFilePath=/Users/path to file/Untitled.applescript} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:41:07.163

[NSUserScriptTask 的文档](http://developer.apple.com/library/mac/documentation/Foundation/Reference/NSUserScriptTask_Class/Reference/Reference.html#//apple_ref/occ/instm/NSUserScriptTask/initWithURL%3aerror%3a)声称直接实例化该类将适用于任何有效文件并返回适当类型的任务：

> 返回的对象将属于特定子类之一（[NSUserUnixTask](http://developer.apple.com/library/mac/documentation/Foundation/Reference/NSUserUnixTask_Class/Reference/Reference.html#//apple_ref/occ/cl/NSUserUnixTask)、[NSUserAppleScriptTask](http://developer.apple.com/library/mac/documentation/Foundation/Reference/NSUserAppleScriptTask_Class/Reference/Reference.html#//apple_ref/occ/cl/NSUserAppleScriptTask)和[NSUserAutomatorTask](http://developer.apple.com/library/mac/documentation/Foundation/Reference/NSUserAutomatorTask_Class/Reference/Reference.html#//apple_ref/occ/cl/NSUserAutomatorTask)），或者`nil`如果文件似乎与任何已知类型都不匹配。
> 
> 如果从子类调用，结果将是该类或`nil`.

实际上，我发现（从 10.8.2 开始）NSUserScriptTask 无条件返回`nil`和“这是什么我什至不知道”错误。看来您需要自己实例化正确的任务子类。可能值得[提交一个错误](https://bugreport.apple.com/)。

要测试文件是否可用作脚本任务（例如，在打开面板验证方法中），我所能建议的只是尝试实例化三个类中的每一个，`YES`如果其中任何一个成功并且`NO`全部失败，则返回。

# ios - 使用 AFNetworking 对许多 JSON 请求进行排队并保存它们的响应

> ID：15603063
> 
> 赞同：0
> 
> 时间：2013-03-24T19:40:39.790
> 
> 标签：ios, objective-c, ios6, nsurlconnection, afnetworking

我是 AFNetworking 的新手，我有兴趣使用它为我的应用程序处理几十个 JSON 请求（例如，使用响应 JSON 的 Web 服务 API），但我在理解我应该如何处理时遇到了一些麻烦做这个。

谁能提供一些关于我将如何实现这一目标的见解？就像我说的，我是图书馆的新手，所以如果您用代码解释，将不胜感激。

对于我正在尝试做的更具体的示例，这是我正在使用的 Clear Read API，您将 URL 作为 URL 中的参数传递并返回 JSON 响应（API 从URL，消除其他膨胀）。

示例 URL：[http ://api.thequeue.org/v1/clear?url=http://blogs.balsamiq.com/product/2012/02/27/uxstackexchange/&format=json](http://api.thequeue.org/v1/clear?url=http://blogs.balsamiq.com/product/2012/02/27/uxstackexchange/&format=json)

我将获取几十个 URL 并通过该服务运行它们并希望保存结果。

我以前在 for 循环中使用 NSURLConnection 执行此操作，触发了几十个 NSURLConnections，这导致我的数据到最后变得非常混乱，有很多人同时发生超时和诸如此类的事情。

我知道一次只做几个会更好，AFNetworking 似乎非常适合这种问题，但我真的很困惑如何使用它/子类化它或其他什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:50:42.560

我建议从他们的[入门指南开始](https://github.com/AFNetworking/AFNetworking/wiki/Getting-Started-with-AFNetworking)。

实际上，它并没有太多：`AFJSONRequestOperation`为您要进行的 API 的每次调用构建一个，并在成功回调中适当地处理反序列化的 JSON。如果您要进行大量调用，请使用`AFHTTPClient`a) 简单地构建这些操作的一些重复性工作，以及 b) 使用客户端的操作队列将它们全部批处理。[然后，您可以使用队列的`setMaxConcurrentOperationCount:`方法](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/NSOperationQueue_class/Reference/Reference.html#//apple_ref/occ/instm/NSOperationQueue/setMaxConcurrentOperationCount%3a)一次限制正在运行的请求数。

# performance - 更新 sqlite3 索引的时间波动太大

> ID：15603070
> 
> 赞同：1
> 
> 时间：2013-03-24T19:41:07.910
> 
> 标签：performance, sqlite

我有一个大型 sqlite3 (3.6.22) 数据库（大约 1 GB，500 万行），单个表在一列上建立索引。问题是执行典型 INSERT 事务的时间波动很大。我一次插入大约 10000 行（当然包含在事务中）。通常它需要大约 1.5 秒，但大约每五个事务突然需要几分钟才能完成相同的事务。我做了很多实验，发现只有有索引才会出现这种现象，这让我觉得更新索引需要很多时间。

我需要更一致的表现。如果我只能避免某些事务突然比前一个事务花费 200 倍的时间，那么平均插入时间再高一点就可以了……我该怎么办？

这是架构。blocks.md5 中的字符串总是正好 32 个字节长并且可能是唯一的。rolling.value 列将包含非常大的 64 位整数。

```
CREATE TABLE blocks (blob char(32) NOT NULL, 
                     offset long NOT NULL, 
                     md5 char(32) NOT NULL, 
                     row_md5 char(32));
CREATE TABLE rolling (value INT NOT NULL);

CREATE INDEX index_md5 ON blocks (md5);
CREATE UNIQUE INDEX index_rolling ON rolling (value); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T05:34:42.737

我不确切知道 sqlite 索引是如何实现的，但如果他们将索引存储在磁盘上或重新排序数据，我希望你描述的行为。

想象一个场景，当他们为索引分配块时，他们开始了一些带有 N 个数据槽的页面。当页面填满时，他们必须分配另一个页面并在它们之间拆分数据。

当您插入数据时，MD5 的顺序将尽可能随机，因此每个页面都会独立填满。索引策略没有任何合理的方法可以知道这一点。

其他数据库甚至会建议对字符串使用与正常情况不同的索引策略，尤其是在随机 MD5 之类的情况下。

尝试在全内存数据库中执行此操作会告诉您它是算法访问还是磁盘访问。

我只是真的试图在离线系统中避免这种情况，我可以在插入之前对数据进行排序。全部插入后，我会将其编入索引，这是我能找到的最快的。如果你一次做 10k，那可能是你的用例，虽然我不知道。

# c - 如何使用 kbhit 和 getch（C 编程）

> ID：15603082
> 
> 赞同：6
> 
> 时间：2013-03-24T19:41:54.383
> 
> 标签：c, windows, visual-c++, getch

我正在尝试创建一个函数，`printf`如果用户按下键盘上的任何按钮（除了大写字母），该函数将显示某个字符串`P`，如果用户按下`P`，它将打破循环。

但是我不认为我正在使用`_kbhit`并且`_getch`正确。我使用数字 80，因为那是 80 的 ASCII 符号......抱歉有任何混淆

```
void activateAlarm(int channelID) {

    int key = 0;

    while(temperatureChannel[channelID].currentTemperature > temperatureChannel[channelID].highLimit
        ||temperatureChannel[channelID].currentTemperature < temperatureChannel[channelID].lowLimit) {

        beep(350,100);

        if (_kbhit()) {
            key = _getch();
            if(key == 'P');
                break;
        }    
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-24T19:44:23.120

不用解释了，代码说得更好：

```
#include <conio.h>

// ...

printf("please press P key to pause \n ");

int key = 0;

while(1)
{
    if (_kbhit())
    {
      key =_getch();

      if (key == 'P')
        break;
    }    
} 
```

# c# - 从 MongoDB Enumerable 反序列化为 ICollection

> ID：15603086
> 
> 赞同：1
> 
> 时间：2013-03-24T19:42:23.447
> 
> 标签：c#, mongodb, serialization, bson, tweetsharp

我在 MongoDB 中反序列化 TwitterStatus 类时遇到以下问题，这是使用 MongoDB C# 驱动程序 1.8.0.124 和 TweetSharp 2.0 的失败单元测试：

```
using Microsoft.VisualStudio.TestTools.UnitTesting;
using MongoDB.Driver;
using MongoDB.Driver.Builders;
using System.Linq;
using TweetSharp;

namespace DS.Model.Tests
{
    [TestClass]
    public class TestMongoSerialization
    {
        [TestMethod]
        public void CanDeserializeTwitterEntitiesFromMongoDB()
        {
            var server = new MongoClient().GetServer();
            MongoDatabase db = server.GetDatabase("test");
            var tweets = db.GetCollection<TwitterStatus>("tweetSerialized");

            var tweet = Newtonsoft.Json.JsonConvert.DeserializeObject<TwitterStatus>(tweetWithTwitterEntityiesSerialized);
            Assert.AreEqual(1, tweet.Entities.Count());
            Assert.AreEqual(TwitterEntityType.Url, tweet.Entities.First().EntityType);
            tweets.Save(tweet);
            Assert.AreEqual(1, tweets.FindAll().Count()); 

            var tweetFromMango = tweets.FindOne(Query<TwitterStatus>.EQ(s => s.Id, 315278676398858240));
            Assert.AreEqual(TwitterEntityType.Url, tweetFromMango.Entities.First().EntityType); // throws exception [1]
        }

        string tweetWithTwitterEntityiesSerialized = @"{""Id"":315278676398858240,""Text"":""TeePublic Funds 22 Designs "",""RetweetedStatus"":null,""created_at"":""2013-03-23T01:47:48Z"",""geo"":null,""Entities"":{""user_mentions"":[],""hashtags"":[],""urls"":[{""url"":""http://t.co/rBGN46rua7"",""expanded_url"":""http://zite.to/10uCED9"",""indices"":[71,93],""EntityType"":2}],""media"":[]},""possibly_sensitive"":false,""Place"":null}";

    }
} 
```

抛出的异常是`Enumerable class TwitterEntities does not implement ICollection<T> so it can't be deserialized`，下面的完整堆栈跟踪。

完整的堆栈跟踪：

```
System.IO.FileFormatException: An error occurred while deserializing the Entities property of class TweetSharp.TwitterStatus: 
Enumerable class TwitterEntities does not implement ICollection<T> so it can't be deserialized. ---> MongoDB.Bson.BsonSerializationException: Enumerable class TwitterEntities does not implement ICollection<T> so it can't be deserialized.
Result StackTrace:  
at MongoDB.Bson.Serialization.Serializers.EnumerableSerializer`1.CreateInstance(Type type)
   at MongoDB.Bson.Serialization.Serializers.EnumerableSerializer`1.Deserialize(BsonReader bsonReader, Type nominalType, Type actualType, IBsonSerializationOptions options)
   at MongoDB.Bson.Serialization.BsonClassMapSerializer.DeserializeMemberValue(BsonReader bsonReader, BsonMemberMap memberMap)
 --- End of inner exception stack trace ---
    at MongoDB.Bson.Serialization.BsonClassMapSerializer.DeserializeMemberValue(BsonReader bsonReader, BsonMemberMap memberMap)
   at MongoDB.Bson.Serialization.BsonClassMapSerializer.Deserialize(BsonReader bsonReader, Type nominalType, Type actualType, IBsonSerializationOptions options)
   at MongoDB.Bson.Serialization.BsonClassMapSerializer.Deserialize(BsonReader bsonReader, Type nominalType, IBsonSerializationOptions options)
   at MongoDB.Bson.Serialization.BsonSerializer.Deserialize(BsonReader bsonReader, Type nominalType, IBsonSerializationOptions options) 
```

如果没有此异常，如何从 mongoDB 反序列化 TweetStatus 类？作为参考，有[TwitterEntity 类](https://github.com/danielcrenna/tweetsharp/blob/master/src/TweetSharp/TwitterEntities.cs)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:24:20.220

TwitterStatus 有一个属性

```
public virtual TwitterEntities Entities 
```

它被定义为

```
public class TwitterEntities : IEnumerable<TwitterEntity> 
```

现在，当反序列化 JSon.NET 时，会创建一个 TwitterEntities 实例，**然后**尝试用**TwitterEntity**项填充它。但要做到这一点，它需要一个 Add 方法，而**IEnumerable**没有提供。但是[ICollection(T)](http://msdn.microsoft.com/en-us/library/92t2ye13.aspx)确实提供了**Add**方法，这就是它要求 ICollection(T) 的原因。

但是，如果您使用的是 MongoDb IMO，则不应直接进行任何 JSON 转换。您应该只有简单的 POCO 类，MongoDb 驱动程序会自动为您处理这些类实例的（反）序列化。

这就是使用文档数据库的美妙之处。

# delphi - 实际存在时找不到系统文件

> ID：15603087
> 
> 赞同：12
> 
> 时间：2013-03-24T19:42:28.180
> 
> 标签：delphi

系统找不到`alg.exe`但它确实存在 - " `c:\windows\system32\alg.exe`"。

我最近从 Win 7 x86 转移到 x64，当我在 x86 上时，我对此没有任何问题，尝试了 Delphi 7 和 XE2。

我正在使用的代码：

```
if FileExists('c:\windows\system32\alg.exe') then
  ShowMessage('fe') else ShowMessage('fne'); 
```

试图以管理员权限获取文件的所有权 + 我的应用程序 - 同样的问题。

伙计们，检查x64 ..

```
function IsWow64Process(Handle:THandle; var IsWow64 : BOOL) : BOOL; stdcall; external 'kernel32.dll';

function IS64 : Boolean;
var
 xIS64 : Bool;
begin
 if IsWow64Process(GetCurrentProcess, xIS64) then
  Result := xIS64 else RaiseLastOSError;
end; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-24T19:50:27.490

这是因为[`WOW64 file system redirection`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa384187%28v=vs.85%29.aspx)，如果您的 32 位应用程序想要访问本机 system32 目录，您必须使用该[`Wow64DisableWow64FsRedirection`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365743%28v=vs.85%29.aspx)函数或`Sysnative`别名。

# Wow64DisableWow64Fs 重定向

试试这个样本

```
{$APPTYPE CONSOLE}

uses
  SysUtils,
  Windows;

Function Wow64DisableWow64FsRedirection(Var Wow64FsEnableRedirection: LongBool): LongBool; StdCall;
  External 'Kernel32.dll' Name 'Wow64DisableWow64FsRedirection';
Function Wow64EnableWow64FsRedirection(Wow64FsEnableRedirection: LongBool): LongBool; StdCall;
  External 'Kernel32.dll' Name 'Wow64EnableWow64FsRedirection';

Var
  Wow64FsEnableRedirection: LongBool;
begin
 try
    if Wow64DisableWow64FsRedirection(Wow64FsEnableRedirection) then
    begin
      if FileExists('c:\windows\system32\alg.exe') then
       Writeln('fe')
      else
       Writeln('fne');

      if not Wow64EnableWow64FsRedirection(Wow64FsEnableRedirection) then
       RaiseLastOSError;
    end
    else
    RaiseLastOSError;
 except
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
 Writeln('Press Enter to exit');
 Readln;

end.
end. 
```

此外，请查看该主题的 MSDN 文档。

> 应用程序可以使用 Wow64DisableWow64FsRedirection、Wow64EnableWow64FsRedirection 和 Wow64RevertWow64FsRedirection 函数来控制 WOW64 文件系统重定向器。禁用文件系统重定向会影响调用线程执行的所有文件操作，因此只有在需要单个 CreateFile 调用时才应禁用它，并在函数返回后立即重新启用它。长时间禁用文件系统重定向会阻止 32 位应用程序加载系统 DLL，从而导致应用程序失败。

# 系统性的

> 32 位应用程序可以通过将 %windir%\Sysnative 替换为 %windir%\System32 来访问本机系统目录。WOW64 将 Sysnative 识别为用于指示文件系统不应重定向访问的特殊别名。这种机制灵活且易于使用，因此，建议使用绕过文件系统重定向的机制。请注意，64 位应用程序不能使用 Sysnative 别名，因为它是虚拟目录而不是真实目录。

```
{$APPTYPE CONSOLE}

{$R *.res}

uses
  SysUtils,
  Windows;

begin
 try
    if FileExists('c:\windows\SysNative\alg.exe') then
     Writeln('fe')
    else
     Writeln('fne');
 except
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
 Writeln('Press Enter to exit');
 Readln;

end. 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-24T19:56:18.537

您有一个在 64 位系统上运行的 32 位进程。您的进程在 WOW64 模拟器中运行，并受[文件系统重定向](http://msdn.microsoft.com/en-us/library/windows/desktop/aa384187.aspx)器的约束。这会将对 64 位系统文件夹 %windir%\System32 的引用重定向到 32 位系统文件夹 %windir%\SysWOW64。

从模拟器下运行的 32 位进程中访问 64 位系统文件夹的推荐方法是使用 %windir%\Sysnative 别名：

> 32 位应用程序可以通过将 %windir%\Sysnative 替换为 %windir%\System32 来访问本机系统目录。WOW64 将 Sysnative 识别为用于指示文件系统不应重定向访问的特殊别名。这种机制灵活且易于使用，因此，建议使用绕过文件系统重定向的机制。请注意，64 位应用程序不能使用 Sysnative 别名，因为它是虚拟目录而不是真实目录。

自然，这个别名只存在于 64 位系统上。最简单的检查方法是测试 的值[`TOSVersion.Architecture`](http://docwiki.embarcadero.com/Libraries/en/System.SysUtils.TOSVersion.Architecture)。

虽然可以禁用重定向器，但不建议这样做。文档说：

> 应用程序可以使用 Wow64DisableWow64FsRedirection、Wow64EnableWow64FsRedirection 和 Wow64RevertWow64FsRedirection 函数来控制 WOW64 文件系统重定向器。禁用文件系统重定向会影响调用线程执行的所有文件操作，因此只有在需要单个 CreateFile 调用时才应禁用它，并在函数返回后立即重新启用它。长时间禁用文件系统重定向会阻止 32 位应用程序加载系统 DLL，从而导致应用程序失败。

我强烈建议您不要禁用文件系统重定向器。

# c++ - Visual c++ 没有智能感知，我如何查看类/命名空间/库中的内容？

> ID：15603090
> 
> 赞同：0
> 
> 时间：2013-03-24T19:42:42.310
> 
> 标签：c++, visual-studio-2010, intellisense

我是 C++ 新手，我不知道 System 命名空间中有什么函数/变量等等。我知道至少在 2010 年 CLR 项目中没有智能感知。我要问的是文档吗？还是一个获得它的好地方？是否有一个内置到 Visual C++ 中还是我必须不断地用谷歌搜索它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T19:46:32.463

这是 .NET Framework 类库的链接：http: [//msdn.microsoft.com/en-us/library/vstudio/gg145045.aspx](http://msdn.microsoft.com/en-us/library/vstudio/gg145045.aspx)

但是，您声明您正在寻求使用 C++ 进行开发。除非您使用 C++/CLI 开发托管应用程序，否则 C++ 不以 .NET Framework 为目标。

# javascript - Jam vs Bower，有什么区别？

> ID：15603095
> 
> 赞同：23
> 
> 时间：2013-03-24T19:43:57.653
> 
> 标签：javascript, node.js, client-side, package-managers

客户端 Javascript 有两个包管理器，但它们如何比较？谁能解释一下哪个擅长什么？

*   [果酱](http://jamjs.org/)
*   [鲍尔](http://twitter.github.com/bower/)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-11T01:04:41.310

正如其他人在评论中提到的那样，除了 Jam 和 Bower 之外，这个领域还有一些替代方案。

*   零件
*   安德
*   沃洛

两者都旨在提供一种方法来打包您的资产并为客户管理它们之间的依赖关系。Bower 和 Jam 似乎都在 2012 年首次亮相——分别是 9 月和 5 月。

两者都可以通过 node/npm 获得，如果您只想为您的应用程序解决公共库（如主干、下划线、jquery 等）之间的依赖关系，那么这两种解决方案都可以工作，并允许您使用一些基本选项来控制版本、放置位置它在您的项目中，并检查更新。

至于有什么不同——Bower 的级别比 Jam 低一些，这使得它对更广泛的受众更有用。您可以为不仅仅是 JavaScript 库创建 Bower 组件。Jam 更专注于 AMD 风格的 JavaScript 库。使用 Jam，您可以在 package.json 文件中指定您的依赖项，您已经可以将其与 npm 组件一起使用，而 Bower 按照惯例选择了 component.json。Bower 的限制是它只获取你的依赖项，如果你想使用 Require.js 或 Jam 选择的其他解决方案，你仍然需要一个构建系统，这样你就可以免费获得。Bower 正在获得 Twitter 和其他一些项目（Ender、Yeoman）的支持。

抱歉，如果这是不正确的，但 Jam 的另一个限制是它不允许您创建自己的组件以在私有存储库中分发。这是 Bower 允许您在 .bowerrc 中配置为端点的东西，但我还没有在 Jam 中找到一种方法来做到这一点。也许我搜索得不够好，但似乎至少有一个 fork 用于私人果酱。

其他一些不错的读物：

*   [http://yeoman.io/packagemanager.html](http://yeoman.io/packagemanager.html)
*   [http://dailyjs.com/2013/01/28/components/](http://dailyjs.com/2013/01/28/components/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-14T06:33:48.223

使用以下一些流行的包管理器的细分，您可以决定要在开发中使用什么。它将事实比较为

*   经理是否使用`package.json`或其他形式的描述符
*   它支持哪些功能（脚手架、编译、拥有中央注册表）
*   速度
*   支持的包形式（仅 js、js 和 css、js html 和 css）
*   支持的模块类型
*   当然还有一些基于个人观点的笔记

[https://github.com/wilmoore/frontend-packagers](https://github.com/wilmoore/frontend-packagers)

# wpf - 创建方形用户控件

> ID：15603096
> 
> 赞同：2
> 
> 时间：2013-03-24T19:43:59.827
> 
> 标签：wpf, user-controls, grid, microsoft-metro, winrt-xaml

我正在设计一个需要方形的用户控件，并尽可能多地填充给定的空间（为了给出一些上下文，它是一个检查板）。

我的用户控件如下所示：

```
<Grid>
    <!-- My 8 lines / colums, etc. , sized with "1*" to have equal lines -->
</Grid> 
```

现在我只想说“这个网格必须是方形的，无论它必须扩展什么空间”。

**徒劳的尝试解决方案：**

1.  我不能使用 a`UniformGrid`因为我实际上还有行和列的名称，所以我有一个不同大小的前导标题行和列。

2.  如果我使用 a `Viewbox`，`Uniform`它就会一团糟。

3.  我尝试使用经典

    ```
    <Grid Height="{Binding RelativeSource={RelativeSource Self}, Path=Width}"> ... </Grid> 
    ```

但它只有在我手动设置`Width`属性时才有效。否则，忽略此约束。

**结论**

我不知道，我真的很想避免设置`Width`/`Height`手动，因为这个控件可以在许多不同的地方（`ListItem`模板、游戏等）使用。

* * *

**建议的解决方案：**

可以使用一些代码隐藏的解决方案。我没有找到仅适用于 XAML 的解决方案。

网格现在是：

```
<Grid SizeChanged="Board_FullControlSizeChanged">...</Grid> 
```

事件处理程序是：

```
private void Board_FullControlSizeChanged(object sender, SizeChangedEventArgs args)
{
    double size = Math.min (args.NewSize.Height, args.NewSize.Width);
    ((Grid)sender).Width = size;
    ((Grid)sender).Height = size;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T22:09:10.857

我最初尝试修改您的绑定，但当它是顶级元素`ActualWidth`时它仍然不起作用，并且在某些情况下它最终将控件扩展得比可用大小更远。`Grid`因此尝试了一些其他方法来获得所需的输出。

有两种方法可以解决这个问题：

由于这是一个与视图相关的问题（不破坏 MVVM，保持正方形，如果您可以接受一些代码隐藏，您可以执行类似的操作）

```
private void OnSizeChanged(object sender, SizeChangedEventArgs e) {
  double minNewSizeOfParentUserControl = Math.Min(e.NewSize.Height, e.NewSize.Width);
  mainGrid.Width = minNewSizeOfParentUserControl;
  mainGrid.Height = minNewSizeOfParentUserControl;
} 
```

并且在您的 xaml 中，您可以将主顶级网格命名为“mainGrid”，并将`UserControl`大小更改的事件处理程序附加到上述函数而不是其`Grid`本身。

但是，如果您出于某种原因完全讨厌代码隐藏，您可以更加花哨并创建一种行为，例如

```
public class GridSquareSizeBehavior : Behavior<Grid> {
  private UserControl _parent;

  protected override void OnAttached() {
    DependencyObject ucParent = AssociatedObject.Parent;
    while (!(ucParent is UserControl)) {
      ucParent = LogicalTreeHelper.GetParent(ucParent);
    }
    _parent = ucParent as UserControl;
    _parent.SizeChanged += SizeChangedHandler;
    base.OnAttached();
  }

  protected override void OnDetaching() {
    _parent.SizeChanged -= SizeChangedHandler;
    base.OnDetaching();
  }

  private void SizeChangedHandler(object sender, SizeChangedEventArgs e) {
    double minNewSizeOfParentUserControl = Math.Min(e.NewSize.Height, e.NewSize.Width);
    AssociatedObject.Width = minNewSizeOfParentUserControl;
    AssociatedObject.Height = minNewSizeOfParentUserControl;
  }
} 
```

对于行为，您的 xaml 将如下所示：

```
 <Grid>
    <i:Interaction.Behaviors>
      <local:GridSquareSizeBehavior />
    </i:Interaction.Behaviors>
  </Grid> 
```

是否使用 Snoop 测试了这两种方法，并且在扩展/收缩时保持正方形大小。请注意，症结中的两种方法都使用相同的逻辑（只是一个快速模型），如果您将逻辑更新为仅在宽度更改时更新高度，反之亦然，而不是两者并取消，您可能会获得更好的性能如果不需要，一起调整大小

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T08:39:27.930

尝试将您的网格放入 ViewBox：http: [//msdn.microsoft.com/en-us/library/system.windows.controls.viewbox.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.viewbox.aspx)

这是我想出的代码示例：

用户控件：

```
<UserControl x:Class="StackOverflow.CheckBoard"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">
    <Viewbox>
        <Grid Background="Red" Height="200" Width="200">
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <Button Content="testing" Grid.Row="0"/>
            <Button Content="testing" Grid.Row="1"/>
            <Button Content="testing" Grid.Row="2"/>
        </Grid>
    </Viewbox>
</UserControl> 
```

和主窗口：

```
<Window x:Class="StackOverflow.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:StackOverflow"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <local:AllNoneCheckboxConverter x:Key="converter"/>
    </Window.Resources>
    <Grid>
        <StackPanel>
            <local:CheckBoard MaxWidth="80"/>
        </StackPanel>
    </Grid>
</Window> 
```

这个 Viewbox 将做的是将控件缩放到它给定的空间。由于视图框内的网格是方形的，因此网格将始终保持方形。尝试使用我在 MainWindow 中使用的 MaxWidth 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T21:55:19.890

您可以将`Height`属性绑定到`ActualWidth`而不是`Width`：

```
<Grid Height="{Binding ActualWidth, RelativeSource={RelativeSource Self}}">
    ...
</Grid> 
```

但是，更好的解决方案是使用 Viewbox。避免它“搞砸”的诀窍是通过为 Width 和 Height 定义（合理的）相等值来使其 Child 为正方形：

```
<Viewbox>
    <Grid Width="500" Height="500">
        ...              
    </Grid>
</Viewbox> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-08T19:10:20.853

在适合您的任何地方注册（通常在构造函数或 OnAttached() 中）：

```
SizeChanged += Square; 
```

并用这个处理大小：

```
private void Square(object sender, SizeChangedEventArgs e)
{
    if (e.HeightChanged) Width = e.NewSize.Height;
    else if (e.WidthChanged) Height = e.NewSize.Width;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-29T09:35:57.120

我已经通过从父控件的大小更改事件中设置包含控件的边距来解决这个问题。在我的例子中，我有一个名为 SudokuBoard 的“数独网格”用户控件，位于一个名为 MainGrid 的标准网格控件（填充主窗口）中，它只需要以下代码；

```
 private void MainGrid_SizeChanged(object sender, SizeChangedEventArgs e)
    {
        double verticalMargin = Math.Max((e.NewSize.Height - e.NewSize.Width)*0.5, 0.0);
        double horizontalMargin = Math.Max((e.NewSize.Width - e.NewSize.Height)*0.5, 0.0);
        SudokuBoard.Margin = new Thickness(horizontalMargin, verticalMargin, horizontalMargin, verticalMargin); 
    } 
```

# ruby-on-rails - 能够显示所有活动，但不能只显示关注用户的活动。未定义的方法

> ID：15603097
> 
> 赞同：0
> 
> 时间：2013-03-24T19:44:05.160
> 
> 标签：ruby-on-rails

我按照 Michael Hartl 的 Rails 教程实现了一个类似于 Twitter (railstutorial.org) 的追随者系统。目前，我想使用此关注系统仅显示当前登录用户所关注的用户的活动。我可以在 /activities 页面上显示系统中的所有活动，没有问题。工作的活动控制器代码如下：

```
class ActivitiesController < ApplicationController
  def index
    @activities = PublicActivity::Activity.all
  end
end 
```

活动控制器的索引页面列出了所有用户发表的所有帖子。但是，我想编辑控制器代码以仅显示关注用户的活动。我怎样才能做到这一点？我所有的尝试都没有导致方法错误。以下是相关项目：

用户型号：

```
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me, :first_name, :last_name, :title, :location, :aboutme, :works_attributes
  # attr_accessible :title, :body

  validates_presence_of :first_name, :last_name
  validates_uniqueness_of :first_name, :last_name, :email, :case_sensitive => false

  has_many :works, dependent: :destroy
  accepts_nested_attributes_for :works

  has_many :relationships, foreign_key: "follower_id", dependent: :destroy
  has_many :followed_users, through: :relationships, source: :followed

  has_many :reverse_relationships, foreign_key: "followed_id",
                                   class_name:  "Relationship",
                                   dependent:   :destroy
  has_many :followers, through: :reverse_relationships, source: :follower

  has_many :posts, dependent: :destroy

   def full_name
    [first_name, last_name].join(" ")
  end

  def following?(other_user)
    relationships.find_by_followed_id(other_user.id)
  end

  def follow!(other_user)
    relationships.create!(followed_id: other_user.id)
  end

  def unfollow!(other_user)
    relationships.find_by_followed_id(other_user.id).destroy
  end
end 
```

关系模型：

```
class Relationship < ActiveRecord::Base
  attr_accessible :followed_id, :follower_id

  belongs_to :follower, class_name: "User"
  belongs_to :followed, class_name: "User"

  validates :follower_id, presence: true
  validates :followed_id, presence: true
end 
```

用户控制器

```
class UsersController < ApplicationController

def index
    @users = User.all

respond_to do |format|
  format.html # index.html.erb
  format.xml  { render :xml => @users }
end
end
  def show
    @user = User.find(params[:id])
    @posts = @user.posts.all
    @works = @user.works.all
    respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @user }
    end
  end
   def following
    @title = "Following"
    @user = User.find(params[:id])
    @users = @user.followed_users.all
    render 'show_follow'
  end

  def followers
    @title = "Followers"
    @user = User.find(params[:id])
    @users = @user.followers.all
    render 'show_follow'
  end

  def posts
    @user = User.find(params[:id])
    @posts = @user.posts.all
    render 'show_post'
  end
end 
```

关系控制器

类关系控制器 < 应用控制器

```
 def create
    @user = User.find(params[:relationship][:followed_id])
    current_user.follow!(@user)
   respond_to do |format|
      format.html { redirect_to @user }
      format.js
    end
  end

  def destroy
    @user = Relationship.find(params[:id]).followed
    current_user.unfollow!(@user)
    respond_to do |format|
      format.html { redirect_to @user }
      format.js
    end
  end
end 
```

我已经被这个问题困了太久了。任何帮助将不胜感激。如果您需要更多信息，请随时提出问题。

如何编辑活动控制器以显示关注用户的活动？

**编辑：它有效！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T21:10:41.603

免责声明：我对 public_activity gem 一无所知，但这是文档建议您需要做的事情：

1.  [为您的活动设置“所有者”属性。](https://github.com/pokonski/public_activity/wiki/%5BHow-to%5D-Set-the-Activity%27s-owner-to-current_user-by-default)

2.  过滤您显示的活动：（`PublicActivity::Activity.where(owner_type: "User", owner_id: current_user.followed_users.map {|u| u.id}).all`这是基于[此示例代码。](https://github.com/pokonski/activity_blog/blob/master/app/controllers/activities_controller.rb#L14)）

# c# - 日期的 Excel 互操作单元格格式

> ID：15603098
> 
> 赞同：5
> 
> 时间：2013-03-24T19:44:11.123
> 
> 标签：c#, sql-server, excel

我的程序在 Excel 中创建一个输出。

有些日期似乎被误解了： ![在此处输入图像描述](../Images/5afa1d28e4e78c475e1bb7df8e20e068.png)

打开文件时，日期是屏幕截图中的混合。
如果我实际上将光标放在 Excel 的计算框中（在屏幕打印中）并按 Enter，则单元格的格式将恢复为正确的格式。

我正在使用`Microsoft.Office.Interop.Excel`将数据从 a 移动`Datatable`到`Excel`保存在我的解决方案中的模板。

在将数据放入单元格之前，我使用以下命令相应地更改每列的数字格式`switch`：

```
for(int i = 1; i < NumColumns + 1; i++) {
    switch(dt.Columns[i-1].DataType.ToString()) {
        case "System.Int32":
            xlWorkSheet.Columns[i].NumberFormat = "#,##0_ ;[Red]-#,##0 ";
            break;
        case "System.String":
            xlWorkSheet.Columns[i].NumberFormat = "@";
            break;
        case "System.DateTime":
            xlWorkSheet.Columns[i].NumberFormat = "[$-809]dd mmmm yyyy;@"; //"dd-mmm-yy";
            break;
        case "System.Date":
            xlWorkSheet.Columns[i].NumberFormat = "[$-809]dd mmmm yyyy;@"; //"dd-mmm-yy";
            break;
        default:
            xlWorkSheet.Columns[i].NumberFormat = "@";
            break;
    }
} 
```

要从数据表中移动值，我使用嵌套循环：

```
//move header totals into the spreadsheet
for(int i = 1; i < NumColumns + 1; i++) {
    xlWorkSheet.Cells[1, i].value = dt.Columns[i - 1].ColumnName;
}

//move in the data
DataView dv = new DataView(dt);
dv.Sort = "Date ASC";

int rowCount = 2;
string theValue;
try {
    foreach(DataRowView dr in dv) {//(DataRow dr indt.Rows)
        for(int i = 1; i < NumColumns + 1; i++) {
            theValue = dr[i - 1].ToString();
            xlWorkSheet.Cells[rowCount, i].value = theValue;
        }
        rowCount += 1;
    }
} catch(Exception) {
    throw;
} 
```

在存储过程中，当我填充数据表时，我尝试使用`DATETIME`以下内容显式拼写类型：

```
SELECT 
"Date" = CONVERT(DATE,b.[Date])
    ... 
```

如何使我的日期数据如此明确以至于 Excel 不会误解并应用所有所需的格式？

* * *

**编辑**

嵌套循环的下一个（未经测试的）尝试如下：

```
int rowCount = 2;
string theValue;
DateTime dtm;
DateTime d;
try {
    foreach(DataRowView dr in dv) {//(DataRow dr indt.Rows)
        for(int i = 1; i < NumColumns + 1; i++) {
            //theValue = dr[i - 1].ToString();
            //xlWorkSheet.Cells[rowCount, i].value = theValue;
            switch(dr[i - 1].GetType().ToString()) {
                case "System.DateTime":
                    dtm = Convert.ToDateTime(dr[i - 1]);
                    xlWorkSheet.Cells[rowCount, i].value = dtm.ToOADate();
                    break;
                case "System.Date":
                    d = Convert.ToDateTime(dr[i - 1]);
                    xlWorkSheet.Cells[rowCount, i].value = d.ToOADate();
                    break;
                default:
                    theValue = dr[i - 1].ToString();
                    xlWorkSheet.Cells[rowCount, i].value = theValue;
                    break;
            }

        }
        rowCount += 1;
    }
} catch(Exception) {
    throw;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-24T21:12:36.533

这里的问题是您将所有内容作为字符串写入 Excel，而 Excel 会将其存储为字符串。在编辑并按 Enter 时，Excel 将重新解释单元格内容，然后可能会以不同的方式存储它。

当您调用`ToString()`a`DateTime`时，默认格式为 DD/MM/YY HH:mm:ss 格式，这正是您在结果文件中看到的内容。

Excel 中的日期存储为表示自 1900 年以来经过的天数的数字。要获取此数字，您可以调用该`ToOADate()`方法。

请参阅[http://msdn.microsoft.com/en-gb/library/system.datetime.tooadate.aspx](http://msdn.microsoft.com/en-gb/library/system.datetime.tooadate.aspx)

将数据集作为一个`double`适当的格式字符串，您应该得到您希望的结果！

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2017-11-12T13:01:12.150

只需将 (to string) 替换为 (formated value)

# svn - 如何使用 Tortoise SVN 从谷歌代码中获取源代码？

> ID：15603099
> 
> 赞同：2
> 
> 时间：2013-03-24T19:44:15.703
> 
> 标签：svn, repository, google-code, svn-checkout

这是项目： [https ://code.google.com/p/openpdn/source/checkout](https://code.google.com/p/openpdn/source/checkout)

我试过了：

文件夹 > 右键单击​​ > SVN Checkout > [https://code.google.com/p/openpdn/](https://code.google.com/p/openpdn/)

但不起作用。这条路径看起来不像我见过的以 /svn/trunk 结尾的其他路径。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-24T19:46:27.563

这是一个 Mercurial 存储库，而不是 SVN 存储库。您需要使用[TortoiseHg](https://tortoisehg.bitbucket.io/)，而不是 TortoiseSVN。

# javascript - JavaScript 如何解析这个引用？

> ID：15603106
> 
> 赞同：0
> 
> 时间：2013-03-24T19:44:46.930
> 
> 标签：javascript, recursion, compiler-construction, scope

我对编译器如何在内部解析此引用感兴趣。假设我们有这个代码：

```
function makeConsumer(run_priority,run_object) {
        var consumer = function(last_run_action) {
                if(!!last_run_action) {
                       // do something
                } else {
                        var next_to_load = run_priority.shift();
                        next_to_load.consume = consumer;
                        run_load_script(next_to_load,run_object);
                }
        };
        return consumer;
} 
```

在顶部有一个对的引用`consumer`，然后，在函数完成定义之前，另一个对的引用`consumer`出现在最后一个`else`块中。如果在执行代码时甚至没有分配原始消费者，那么对消费者的引用如何有效？我知道函数将范围推到顶部，但是对于分配给变量的函数表达式也是如此吗？

是否可以创建一个场景，其中函数通过分配给它的变量引用自己，并且该引用尚未有效？`consumer`当该引用是尚未完成定义的函数的一部分时，javascript如何进行第二次引用来引用该函数？

这是否等同于递归中使用的引用？如果是这样，编译器如何评估*它们*是否有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T19:51:16.603

Javascript 变量声明被提升到顶部。因此，所有这些变量在被任何地方引用之前就“存在”了。所以你的例子相当于这个：

```
function makeConsumer(run_priority,run_object) {
        var consumer; 
        consumer= function(last_run_action) {
                var next_to_load;
                if(!!last_run_action) {
                       // do something
                } else {
                        next_to_load = run_priority.shift();
                        next_to_load.consume = consumer;
                        run_load_script(next_to_load,run_object);
                }
        };
        return consumer;
} 
```

这个问题有更多关于提升[的内容。](https://stackoverflow.com/questions/3725546/variable-hoisting)

所以当函数定义中引用消费者时，变量已经被声明了。

在函数运行之前，该变量也不会被评估。因此，在这种情况下，在函数实际运行之前，函数不必知道使用者是什么（在您的示例中未显示。）

# javascript - 主干集合提取不会触发 reset()

> ID：15603107
> 
> 赞同：19
> 
> 时间：2013-03-24T19:44:54.397
> 
> 标签：javascript, jquery, backbone.js, underscore.js

这是我对收藏的看法

```
var mssg = mssg || {};

mssg.MessagesView = Backbone.View.extend({

el: '#messages',

initialize: function() {
    this.collection.fetch();
    this.collection.bind('reset', this.render, this);
},

render : function() {
    this.$el.html('');
    this.collection.each(function( item ) {
        this.renderMessage( item );
    }, this );
    return this;
},

renderMessage : function( item ) {
    var messageView = new mssg.MessageView({
        model : item
    });
    this.$el.append( messageView.render().el );
}

}); 
```

这是收藏

```
var mssg = mssg || {};

mssg.Messages = Backbone.Collection.extend({
    model : mssg.Message,
    url : 'messages'
}); 
```

这就是它的初始化方式：

```
var mssg = mssg || {};

$(function() {
    new mssg.MessagesView({
        collection : new mssg.Messages()
    });
}); 
```

问题是`render`绑定到的函数`reset`在 ajax 获取请求后不会触发。

如果我将它绑定到`add`它工作。我尝试绑定`all`到一个调试函数，它说该`sync`事件是与`add`每个项目一起调用的。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-03-24T20:12:30.497

如果您检查主干[更改日志](http://backbonejs.org/#changelog)，您会看到 1.0 中处理 fetch 的方式发生了变化：

> 将 Collection 的“更新”重命名为 set，以实现与类似 model.set() 的并行性，并与 reset 形成对比。它现在是获取后的默认更新机制。如果您想继续使用“重置”，请通过 `{reset: true}`

因此，要触发重置事件，您现在必须使用

```
this.collection.fetch({reset: true}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-11T12:08:50.693

在骨干网 1.0 中，您必须手动触发重置：

```
youColloection.fetch({reset: true}); 
```

# ruby - 开始使用 Ruby、Watir 和 Ruby Mine？

> ID：15603108
> 
> 赞同：2
> 
> 时间：2013-03-24T19:45:06.120
> 
> 标签：ruby, watir, rubymine

我想自动化测试电子商务网站。我安装了 Ruby、Watir、Gems 和 Ruby Mine。

虽然我玩过 RubyMine，但我不知道如何开始编写一个简单的脚本：

1.  如何开始使用 RubyMine 编写简单的脚本？我创建了一个项目。你下一步怎么做？我现在必须创建一个 rspec 文件吗？并且可能搜索示例程序并运行它？
2.  有人可以给我一个打开网站并点击链接的示例，以便我可以看到它正在运行吗？

我将感谢对我有帮助的简单文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T11:08:07.890

你甚至检查[过 Watir 网站](http://watir.com/)吗？有很多关于如何开始的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T21:12:15.070

这是使用 Cucumber 和 Watir 打开搜索页面、发送查询并验证结果[的示例项目。](https://dl.dropbox.com/u/2752840/cuctest.zip)

`Gemfile`指定所需的 gem，确保它们已安装或可以安装在您的环境中。如果您在 Windows 上，则需要[安装 DevKit](https://github.com/oneclick/rubyinstaller/wiki/Development-Kit)。

# matrix - Three.js 在移动的 Object3D 内旋转对象以始终面向相机

> ID：15603111
> 
> 赞同：0
> 
> 时间：2013-03-24T19:45:20.167
> 
> 标签：matrix, camera, rotation, three.js

我对 Threejs 有点陌生，只是想知道如何让移动网格在场景中始终面向相机。我在一个容器 Object3D 中有 100 个网格，并且正在 x 和 y 轴上旋转这个容器。有什么办法可以强制容器内的网格始终面向相机？

这是一些示例代码，我还在[http://jsfiddle.net/nickelWeb/rZtJX/4/上设置了一个 jsFiddle](http://jsfiddle.net/nickelWeb/rZtJX/4/)

```
for(var k = 0; k<numMeshes; k++){
     meshes[k].lookAt( camera.position );   
} 
```

我试过只使用 .lookAt() 方法，但它似乎不起作用。我知道必须有一种方法可以做到这一点，我只是不知道在哪里看。任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:29:25.063

`Object.lookAt()`如果对象具有旋转的父对象，则将无法正常工作。

解决您的问题的最简单的方法是保持父对象固定并围绕对象旋转相机。

这样，`Object.lookAt()`将按预期工作。

更新小提琴：http: [//jsfiddle.net/rZtJX/5/](http://jsfiddle.net/rZtJX/5/)

三.js r.57

# jquery - Jquery首先加载内容然后淡入

> ID：15603112
> 
> 赞同：0
> 
> 时间：2013-03-24T19:45:22.303
> 
> 标签：jquery

我正在使用 Jquery 将表单“发布”到页面，其结果应该填充表单最初所在的 DIV。

我用这个：

```
$.post('management_actions.php', $('#NewJobForm').serialize(), function(data){
  $('#JobWindow').fadeOut(150).html(data).fadeIn(150);
}); 
```

但它不起作用，因为在加载内容之前它已经淡入淡出。如何使功能相互“等待”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T19:48:33.780

像这样使用回调函数

```
$('#JobWindow').fadeOut(150,function(){
   $('#JobWindow').html(data);
   $('#JobWindow').fadeIn(150);
}); 
```

这将在设置数据之前等待`fadeOut effect`完成

## [演示小提琴](http://jsfiddle.net/mohammadAdil/eFPha/1/)

# mysql - 这个 SQL 查询有什么问题

> ID：15603113
> 
> 赞同：0
> 
> 时间：2013-03-24T19:45:22.583
> 
> 标签：mysql, sql

这个 SQL 查询有什么问题 .. 它一直给我一个错误 .. 并且该错误也在下面指出

这是查询：

```
UPDATE Politicians SET Big Fan = Big Fan +3 WHERE ID = '2' 

 MySQL said: Documentation
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'Fan = Big Fan + 3 WHERE ID ='2'' at line 1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T19:48:17.753

当列名中有空格时，必须使用反引号：

```
UPDATE Politicians SET `Big Fan` = `Big Fan` +3 WHERE ID = '2' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T19:48:38.130

您缺少方括号。尝试这个

```
UPDATE Politicians SET [Big Fan] = [Big Fan] +3 WHERE ID = '2' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T19:49:00.123

这是因为您的 MySQL 表名中有一个空格。我相信你可以尝试这样的事情：

```
UPDATE `Politicians` SET `Big Fan` = `Big Fan` + 3 WHERE `ID` = '2' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-24T19:49:54.740

现在您才发现为什么表名和列名中的空格是 PIA

猜测但是

```
UPDATE Politicians SET `Big Fan` = `Big Fan` +3 WHERE ID = '2' 
```

假设 Politicians 有一个专栏叫 Big Fan，mysql 看到的是 big 和 fan 这两个词，它都不理解。

用反引号括起来，使其将其视为一个“单词”，然后它知道您指的是政治家表中的一列

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-24T19:50:29.723

理想情况下，列名中不应包含空格。而是使用“-”或下划线。现在，如果您有空间，那么您可以在这种情况下使用“列名”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-24T19:48:29.987

这是由于列名中的空格。

```
UPDATE Politicians SET `Big Fan` = `Big Fan` +3 WHERE ID = '2' 
```

# clojure - Clojure 是否在 map 调用中使用多个线程？

> ID：15603114
> 
> 赞同：1
> 
> 时间：2013-03-24T19:45:25.587
> 
> 标签：clojure

我正在尝试探索受 CPU 限制的算法在使用 Clojure 扩展到多个 CPU 时的行为。该算法以连续整数的大序列作为输入，将序列划分为给定数量的子序列，然后使用 map 将函数应用于每个子序列。一旦 map 函数完成，reduce 用于收集结果。

完整代码可在[Github](https://github.com/joshpeterson/nash-clojure/blob/master/src/nash_clojure/core.clj)上找到，但这里有一个示例：

```
(map computation-function (partitioning-function number-of-partitions input)) 
```

当我在具有十二个内核的机器上执行此代码时，我看到大部分内核都在使用，而我希望只看到一个内核在使用中。

理想情况下，我想`pmap`使用给定数量的线程，但我无法使代码仅使用一个线程执行。

那么 Clojure 是否将计算分散到多个 CPU 上？如果是这样，我能做些什么来控制这种行为吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-24T21:12:09.637

我的理解是`pmap`使用多个内核并`map`仅使用当前线程。（如果两个函数都使用了所有可用的内核，那么在库中同时拥有这两个函数就没有意义了。）

下面的简单实验表明`pmap`使用单独的线程并且`map`不使用：

```
(defn something-slow [x]
  (Thread/sleep 1000))

(map something-slow (range 5))
;; Takes 5 seconds
(pmap something-slow (range 5))
;; Takes 1 second 
```

我确实注意到您的 GitHub 代码`pmap`在运行的示例中使用`main-`；如果你改回`map`并行性是否持续存在？

# c++ - 如何在 Objective-C 中调用 C++ 方法

> ID：15603120
> 
> 赞同：0
> 
> 时间：2013-03-24T19:45:47.287
> 
> 标签：c++, objective-c, objective-c++

我有 C++ 文件：C.cpp 和 Ch

```
//C.h
#ifndef __ThreeMoreOpenCV__SourceC__
#define __ThreeMoreOpenCV__SourceC__

#include <iostream>

class C
{
public:
    static void Cmethod ();
};
#endif

//C.cpp
#include "SourceC.h"

using namespace std;

void Cmethod()
{
    printf("ff");

} 
```

我也有 Wrapper.h/.mm

```
//Wrapper.h
#import <Foundation/Foundation.h>

@interface CVWrapper : NSObject
+(void)returnCmethod;
@end

//Wrapper.mm
#import "Wrapper.h"
#import "C.h"

@implementation CVWrapper

+(void)returnCmethod
{
    C::Cmethod();
}

@end 
```

我不知道，但我收到如下错误：

“C::Cmethod()”，引用自：Wrapper.o 中的 +[Wrapper returnCmethod] ld：未找到体系结构 i386 的符号：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）。

谁能告诉我调用函数的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-24T19:57:45.970

您实际上还没有在 C 类中实现 Cmethod 函数。您需要`C::`在函数头中实现它，例如：

```
void C::Cmethod()
{
    printf("ff");
} 
```

# math - 数据结构 - 运行时和渐近界

> ID：15603121
> 
> 赞同：-5
> 
> 时间：2013-03-24T19:45:47.243
> 
> 标签：math, data-structures, big-o, logarithm

如果 a>0 是一个固定变量，则证明：lg(n+a) = Θ(lg n)

请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T19:57:05.937

为了证明 f(n) = Θ(g(n))，你需要证明存在一个非零 k 使得

> lim (n → ∞) f(n) / g(n) = k

在你的情况下，我们想证明

> lim (n → ∞) lg(n + a) / (lg n)

这是 ∞ / ∞ 类型的不确定形式，因此我们可以应用[l'Hôpital 规则](http://en.wikipedia.org/wiki/L%27H%C3%B4pital%27s_rule)并取分子和分母的导数得到

> lim (n → ∞) lg(n + a) / (lg n) =
> 
> lim (n → ∞) (1 / n + a) / (1 / n) =
> 
> lim (n → ∞) n / (n + a)

这又是一个不确定的形式，所以应用 l'Hôpital 的规则给出

> lim (n → ∞) n / (n + a)
> 
> = lim (n → ∞) 1 / 1
> 
> = 1

因此，存在一个非零常数（即 1），使得 lg(n + a) / lg n 当 n 趋于无穷时的极限等于该常数，因此 lg(n + a) = Θ(lg n)。

希望这可以帮助！

# javascript - 我可以观察指令中的态度变化吗？

> ID：15603124
> 
> 赞同：2
> 
> 时间：2013-03-24T19:45:59.610
> 
> 标签：javascript, angularjs, angularjs-directive

我可以观察指令中的属性变化吗？

我有这样的事情：

```
<online-wathers></online-watchers> 
```

它向视频广播显示在线连接的用户，并且需要广播 ID。显然没有这个属性是行不通的。此视频广播不是在文档准备好时开始，而是在发布者真正想要开始时开始。当他开始时-后端给了我广播ID。

现在，当 api 返回我的广播 ID 时，我只是将它附加到具有广播 ID =“xx”的 DOM。

```
$(".online-watchers-container")
      .html($("<online-watchers broadcast-id='"+broadcast.id+"' />"));
$(".chat-container")
      .html($("<chat broadcast-id='"+broadcast.id+"' />"));
$(".request-container")
      .html($("<live-requests broadcast-id='"+broadcast.id+"'></live-requests>"));

// compile directives
angular.bootstrap(angular.element("online-watchers, chat, live-requests"), ['MyApp']); 
```

但是是否有任何内部方法可以观察添加或更改属性？因此，在页面加载时，我已经在 DOM 中有*<online-watchers></online-watchers>*，当我收到广播 ID 的响应时，我只需将属性添加到 DOM 中的元素并指令对其做出反应。

请，如果您将其视为垃圾代码，如果您展示一些更好的解决方案示例，我将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T22:08:58.370

是的你可以

```
function MyDirective() {
    return {
        link: function (scope, iElement, iAttrs) {
            scope.$watch(iAttrs.scopeProp, function (val) {
                console.log("prop: " + val);
            });
            iAttrs.$observe("interpolated", function (val) {
                console.log("interpolate: " + val);
            });
        }
    }
 } 
```

.

```
<my-directive scope-prop="someId" interpolated="{{someId + 1}}" 
```

.

```
function MyCtrl($scope) {
    $scope.someId = 12;
} 
```

有关更多示例，请查看：[如何在自定义指令中获取评估的属性](https://stackoverflow.com/questions/12371159/angularjs-how-to-get-evaluated-attributes-inside-a-custom-directive/12372494#12372494)

# android - 点击事件的视图的getchild

> ID：15603125
> 
> 赞同：1
> 
> 时间：2013-03-24T19:46:01.480
> 
> 标签：android, view, get-childitem

对不起，我的英语……这是谷歌 traductor

我创建（java）例如 10 LLseccion。

每个 LLseccion 内部有多个对象（imageview 和 2 个 textview）

我想阅读点击的布局的第一个文本视图

```
 LinearLayout LLseccion = new LinearLayout(getApplicationContext());
        LLseccion.setOrientation(LinearLayout.HORIZONTAL);
        LLseccion.setId(i);
        LLseccion.setClickable(true);

        LLseccion.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {

            }
        });

                TextView tvBIG=new TextView(getApplicationContext());
                tvBIG.setText("i want read this");
                tvBIG.setTypeface(FontNormal);
                tvBIG.setTextSize(bigSize);
                tvBIG.setTextColor(getResources().getColor(R.color.GREEN));
                tvBIG.setSingleLine(true);
                LLseccion.addView(tvBIG);

                    TextView tvSMALL=new TextView(getApplicationContext());
                    tvSMALL.setText("other text");
                    tvSMALL.setTypeface(FontNormal);
                    tvSMALL.setTextSize(smallSize);
                    tvSMALL.setTextColor(getResources().getColor(R.color.GREEN));
                    tvSMALL.setPadding(30, 0, 0, 0);
                    tvSMALL.setSingleLine(true);
                    LLseccion.addView(tvSMALL); 
```

# regex - 在 R 中删除 URL 字符串的结尾

> ID：15603126
> 
> 赞同：6
> 
> 时间：2013-03-24T19:46:05.487
> 
> 标签：regex, r

我正在尝试从 R 中的 URL 列表中清理和删除目录

我有的：

```
http://domain.com/123
http://www.sub.domain1.com/222
http://www.domain2.com/1233/abc 
```

我想要的是：

```
domain.com
sub.domain1.com
domain2.com 
```

我还有很长的路要清理 URL 的开头

```
url <- c("http://domain.com/123", "http://www.sub.domain1.com/222","http://www.domain2.com/1233/abc"

cleanurl <- gsub("http://","",url)
cleanurl2 <- gsub("www.","",cleanurl) 
```

（如果有更简单的方法来清理 http:// 和 www.，请告诉我。）

现在我遇到了正则表达式的问题，并`/`在最后删除了所有内容。我试过这个

```
cleanurl3 <- gsub("/*","",cleanurl2) 
```

但它只是删除它`/`而不是它之后的所有内容。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-24T19:52:35.480

我使用 a `strsplit`/ `gsub`combo 的方法（不仅仅是`gsub`b/c 有时它很快就能弄清楚，`strsplit`因为它非常直观）：

```
x <- readLines(n=3)
http://domain.com/123
http://www.sub.domain1.com/222
http://www.domain2.com/1233/abc

gsub("www.", "", sapply(strsplit(x, "//|/"), "[", 2))

## > gsub("www.", "", sapply(strsplit(x, "//|/"), "[", 2))
## [1] "domain.com"      "sub.domain1.com" "domain2.com" 
```

**编辑**
或者如果您只想使用`strsplit`（根据马修的建议）：

```
sapply(strsplit(x, "(//|/)(www[.])?"), "[", 2) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-24T19:51:45.510

为了第一：

```
cleanurl <- sub("^http://(?:www[.])?(.*)$", "\\1", url)
cleanurl
## [1] "domain.com/123"       "sub.domain1.com/222"  "domain2.com/1233/abc" 
```

只是域：

```
cleanurl <- sub("^http://(?:www[.])?([^/]*).*$", "\\1", url)
cleanurl
## [1] "domain.com"      "sub.domain1.com" "domain2.com" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-24T19:50:22.950

这应该有效：

```
cleanurl <- gsub("http://","",url)
cleanurl2 <- gsub("www.","",cleanurl)

sapply(strsplit(cleanurl2,"/"),"[",1)
[1] "domain.com"      "sub.domain1.com"
[3] "domain2.com" 
```

# ruby-on-rails - Heroku 仍然响应 mysubdomain.herokuapp.com

> ID：15603128
> 
> 赞同：4
> 
> 时间：2013-03-24T19:46:28.073
> 
> 标签：ruby-on-rails, heroku

我在 Heroku 应用程序中添加了一个自定义域，它工作正常，但应用程序仍然响应 {mysubdomain}.herokuapp.com。

为了防止[重复内容](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=66359)，我想停止让我的应用程序响应子域。Heroku 中是否有一些设置可以为我执行此操作，或者我是否需要编写 301 重定向代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:37:31.800

您将需要 301 重定向。Heroku 将始终响应`.herokuapp.com`您的应用程序的域

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-24T20:43:28.563

另一种选择是使用 rel="canonical" 链接标签。这告诉搜索引擎使用哪个 URL 来处理可能出现在多个 URL 上的内容：

`<link rel="canonical" href="http://www.example.com/correct_url">`

以下是谷歌必须说的：http: [//support.google.com/webmasters/bin/answer.py ?hl=en&answer=139394](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=139394)

（底部明确提到了您的用例。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-28T03:11:54.417

我创建了[**hide_heroku**](https://github.com/ykessler/hide-heroku) gem 来处理这个问题——它使用 X-Robots-Tag HTTP 标头来防止搜索引擎索引***.herokuapp.com下的任何内容**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-24T20:40:06.210

我不相信可以通过他们的 Web 界面或命令行客户端删除 Heroku 提供的域名。如果您对此感到担忧，请将其重定向或添加[`robots.txt`](https://developers.google.com/webmasters/control-crawl-index/docs/robots_txt)到您的站点，该站点在通过以下方式访问时会阻塞`.herokuapp.com`（我不知道该怎么做，抱歉）。

我怀疑谷歌在索引 Heroku 网站和处理双域问题本身方面相当聪明，但这只是一个猜测。

# java - Java 声音重复播放

> ID：15603131
> 
> 赞同：3
> 
> 时间：2013-03-24T19:46:32.613
> 
> 标签：java, audio

我正在尝试将声音添加到我一直在开发的游戏中，但我无法让声音播放不止一次。我想我已经找到了原因，但我不知道如何解决它。我正在使用在搜索 Java 声音教程时发现的枚举器。

问题是我在一个线程中调用声音，在我的 update() 方法中，每次我调用声音的 play() 方法时，它都会重新开始剪辑。第一次调用它时，声音播放良好（我可能会有点僵硬），但之后播放声音的所有尝试都失败了。我没有收到任何异常或错误，只是没有播放声音。

```
public enum Sounds {
    RIFLE("rifle_fire.wav");

    private Clip clip;

    Sounds(String filename) {
        openClip(filename);
    }

    public synchronized void openClip(String filename) {
        try {
            URL audioFile = Sounds.class.getResource("/resources/sounds/" + filename);

            AudioInputStream audio = AudioSystem.getAudioInputStream(audioFile);
            AudioFormat format = audio.getFormat();
            DataLine.Info info = new DataLine.Info(Clip.class, format);
            clip = (Clip) AudioSystem.getLine(info);

            clip.open(audio);
        } catch (UnsupportedAudioFileException uae) {
            System.out.println(uae);
        } catch (IOException ioe) {
            System.out.println(ioe);
        } catch (LineUnavailableException lue) {
            System.out.println(lue);
        }
    }

    public synchronized void play() {
        if(clip.isRunning()) clip.stop();
        clip.setFramePosition(0);
        clip.start();
    }

    public static void init() {
        values();
    }
} 
```

那是我使用的枚举器。它是从我的主线程的 update() 方法中调用的，该方法每 20 毫秒更新一次。在更新方法中，我是这样称呼的。

```
// If the left mouse button is held down, create a new projectile.
if(Globals.buttons[0] && !player.isOnCooldown()) {
    createParticle(pAngle);
    Sounds.RIFLE.play();
} 
```

有人建议我使用后需要关闭线路，但声音只打开一次......为什么我需要关闭它？有谁知道问题是什么？

# c# - ASP.NET MVC：编辑时忽略字段

> ID：15603132
> 
> 赞同：4
> 
> 时间：2013-03-24T19:46:37.413
> 
> 标签：c#, asp.net, .net, asp.net-mvc, asp.net-mvc-3

在学习 ASP.NET MVC 的过程中，我遇到了一个问题并遇到了一些麻烦

我正在尝试创建一个简单的博客，只是为了测试我到目前为止所学到的东西。但是在编辑和离开字段时，我遇到了问题。

我正在尝试在我的博客上编辑已提交的帖子，该帖子包含几个字段：ID、标题、消息、作者和提交日期，不应编辑，保持原样。

这是一些代码：

我的帖子模型：

```
namespace MyBlock.Models
{
    public class Post
    {
        public int Id { get; set; }

        [Required]
        public string Author { get; set; }

        [Required]
        public string Headline { get; set; }

        [Required]
        public string Message { get; set; }

        public DateTime Date { get; set; }
    }
} 
```

我的编辑：

```
[HttpGet]
public ActionResult Edit(int id = 0)
{
    Post post = db.Posts.Find(id);

    if (post != null) {
        return View(post);          
    }

    return HttpNotFound();
}

[HttpPost]
public ActionResult Edit(Post post)
{
    if (ModelState.IsValid) {
        db.Entry(post).State = EntityState.Modified;
        db.SaveChanges();

        return RedirectToAction("Index", "Home");
    }

    return View(post);
} 
```

我的编辑观点：

```
@model MyBlock.Models.Post

@{
    ViewBag.Title = "Edit";
}

<h2>Rediger "@Model.Headline"</h2>

@using (Html.BeginForm()) {
    @Html.LabelFor(u => u.Author)
    @Html.TextBoxFor(u => u.Author)

    @Html.LabelFor(u => u.Headline)
    @Html.TextBoxFor(u => u.Headline)

    @Html.LabelFor(u => u.Message)
    @Html.TextAreaFor(u => u.Message)

    <input type="submit" value="Gem" />
} 
```

我知道我可以输入一个`@HiddenFor(u => u.Date)`并且将提交相同的日期。但我敢打赌，除了将其作为源代码中的隐藏字段之外，还有另一种方法吗？我的意思是在另一个例子中这不是那么安全吗？所以我想要这里的隐藏字段以外的东西。你们能帮帮我吗？

如果我尝试按原样运行它。我收到一个错误，即我的日期未设置，这是合乎逻辑的，因为它也想更新该日期。但我不希望它。如果你能这么说，我想把它留作可选。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-24T19:51:10.923

# 不要从陌生人那里拿糖果

换句话说，不要从客户端获取信息并直接更新数据库。您应该在服务器端强制执行您的业务规则，而不是相信客户端会为您执行此操作。

```
[HttpPost]
public ActionResult Edit(Post post)
{
    if (ModelState.IsValid) {
        var dbPost = db.Posts.FirstOrDefault(p => p.Id == post.Id);
        if (dbPost == null)
        {
            return HttpNotFound();
        }

        dbPost.Author = post.Author;
        dbPost.Message = post.Message;
        dbPost.Headline = post.Headline;
        db.SaveChanges();

        return RedirectToAction("Index", "Home");
    }

    return View(post);
}

[HttpPost]
public ActionResult Add(Post post)
{
    if (ModelState.IsValid) {
        var dbPost = db.Create<Post>();
        dbPost.Author = post.Author;
        dbPost.Message = post.Message;
        dbPost.Headline = post.Headline;
        dbPost.Date = DateTime.Now(); // Don't trust client to send current date
        db.SaveChanges();

        return RedirectToAction("Index", "Home");
    }

    return View(post);
} 
```

在我自己的项目中，我通过向方法添加自定义验证规则来在域层强制执行这样的规则`ValidateEntity`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:00:07.977

DateTime 是值类型，不能为空。因此，它永远不可能是可选的。

您需要将它设为可为空的类型。IE。

```
public DateTime? Date {get;set;} 
```

通常，ViewModel 中的大多数值类型都应该可以为空，然后您使用 Required 属性来强制它们包含一个值。这使您可以判断他们是否未能输入值，或者它是否是默认值。

在您的控制器中，您可以检查日期是否具有值，`Date.HasValue`如果有，则保存日期。

关于安全性，在这种情况下，这不是一个问题。假设某人可以访问该页面（他们通过了授权）并且他们有权更新日期，那么用户是否可以绕过它并不重要。他们所能做的就是提交有效的日期格式。除非您想添加逻辑以确保日期在特定时间段内，否则您不必担心。ModelBinder 不会绑定到无效的日期格式。

如果您想控制用户是否可以更新日期，比如基于角色，那么您可以向控制器添加逻辑以检查日期是否有值并且用户是否处于正确的角色，否则会发出错误。

**更新：**

我认为这里最简单的解决方案是做两件事。第一个是使 Date 可以为空，正如我上面提到的。尽管如果您的视图中没有 Date 的表单域，这并不是绝对必要的，但如果您稍后添加表单域，那么如果您将文本框留空，则会收到验证错误。如果可能的话，我喜欢防止将来发生错误。此外，如果有人手动将值发布到您的编辑操作，并且它们包含一个空白日期字段，它将无法验证，而不是简单地忽略它。使值可为空允许该值被完全忽略，而不管其值如何。

其次，按照@pswg 的建议进行操作，并且只更新您想要更新的字段。从数据库中检索帖子，然后更新除 Id 和 Date 之外的所有字段。然后调用`SaveChanges()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-23T11:12:24.307

这里只有我的 2 美分。我知道这是一个简单的情况，给出的答案很好而且直截了当。但是随着属性列表的增加，它可能会变得困难。

所以不同的方法将沿着这些路线

```
 var t = _db.Blog.Where(x => x.ID == id).FirstOrDefault();

    var info = typeof(Blog).GetProperties();
//properties you don't want to update
    var properties = info.Where(x => x.Name != "xxx" && x.Name != "xxxx").ToList();
  foreach(var p in properties)
   {
      p.SetValue(t, p.GetValue(temp.Volunteer));
   }

   _db.Entry(t).State = EntityState.Modified;
   _db.SaveChanges(); 
```

但是，如果您只是在做一些领域，那么上述内容是有道理的。就用你的脑袋！

# javascript - 如何使用 GPS 为 jQuery 移动应用程序跟踪位置？

> ID：15603138
> 
> 赞同：0
> 
> 时间：2013-03-24T19:47:45.280
> 
> 标签：javascript, jquery, html, google-maps

我正在开发一个 jQuery 移动应用程序。我需要跟踪用户的位置（城市地址）。

```
var x=document.getElementById("demo");
function getLocation()
{
    if (navigator.geolocation)
    {
        navigator.geolocation.getCurrentPosition(showPosition);
    }
    else {
        x.innerHTML="Geolocation is not supported by this browser.";
    }
}

function showPosition(position)
{
    x.innerHTML="Latitude: " + position.coords.latitude + "<br>Longitude: " + position.coords.longitude;
} 
```

这仅给出纬度和经度。我不需要经纬度或地图。我只需要获取城市地址。我必须做什么才能得到这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:00:15.010

尝试使用[Reverse Geocoding](https://developers.google.com/maps/documentation/geocoding/#ReverseGeocoding)，这将返回 JSON。使用这个 URL：

```
http://maps.googleapis.com/maps/api/geocode/json?latlng=40.714224,-73.961452&sensor=true_or_false 
```

像这里解释的那样获取 JSON：http: [//api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

# android - 为什么我的 Android 服务在我从它启动 Activity 时被杀死？

> ID：15603139
> 
> 赞同：1
> 
> 时间：2013-03-24T19:47:55.213
> 
> 标签：android, android-activity, android-service

我有一个必须启动外部活动的服务。我希望即使在启动 Activity 之后，该服务也将继续运行。问题是 onDestroy() 被调用并且服务被杀死。这是我的代码：

我如何从服务内部启动外部活动：

```
 Intent intent = new Intent(Intent.ACTION_DIAL);        
      intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
      context.startActivity(intent); 
```

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:03:31.427

> 当我从服务内部启动活动时，该服务被杀死是否正常？

服务没有被“杀死”。

您的服务将运行到：

*   您调用`stopService()`引用服务，或
*   服务调用`stopSelf()`，或
*   如果您使用的是绑定模式，则所有绑定 (via `bindService()`) 都是未绑定 (via `unbindService()`)，或者
*   Android 会终止您的进程，例如由于内存不足或用户请求

因此，您需要确定哪些条件为真。没有必要与开始一项活动有任何关系。

请注意，从服务启动活动通常不是一个好主意，特别是如果这可能发生在任意时间而不是基于用户输入时。用户不喜欢突然出现的活动。

# marionette - Backbone Marionette iOS 样式页面过渡

> ID：15603141
> 
> 赞同：0
> 
> 时间：2013-03-24T19:48:03.980
> 
> 标签：marionette

我正在使用 Backbone.Marionette 制作单页移动应用程序，并希望实现页面幻灯片转换。我知道如何通过为动画添加和删除适当的 css 类来实现这一点，但是我在处理 Marionette 区域和管理添加这些类的时间时遇到了麻烦。我希望该区域中的当前视图滑出并滑入下一个视图。如何使用木偶中的区域或布局来完成此操作？PS我是木偶的新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:59:34.317

您需要编写自定义区域实现以促进转换。Marionette 上有一张公开票，其中包含使这项工作的核心代码：[https ://github.com/marionettejs/backbone.marionette/issues/320#issuecomment-9746319](https://github.com/marionettejs/backbone.marionette/issues/320#issuecomment-9746319)

但是您需要根据您的特定需求调整此代码。请务必阅读有关它的评论和讨论。我已经多次使用这个核心代码来满足类似的需求，但还没有找到将它集成到木偶中的最佳方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-31T14:09:19.470

这是一个演示视图转换的自定义区域：http: [//codepen.io/somethingkindawierd/pen/cpiEw](http://codepen.io/somethingkindawierd/pen/cpiEw)

# grails - Grails - 如何清除命令对象中以前的验证错误？

> ID：15603144
> 
> 赞同：2
> 
> 时间：2013-03-24T19:48:13.020
> 
> 标签：grails, grails-orm, grails-controller, command-objects

当用户单击浏览器后退按钮时，如何清除来自 Command 对象的先前验证错误消息？

这是示例代码：

```
def create = { UserInfoCommand  cmd ->
    if (cmd.validate()) {
        println("Command obect Show")
        render(view:"Show");
    } else {
      println("Command obect Show")
      render(view: "Create", model: [cmd:cmd]);
    }
} 
```

**设想**

第 1 步：在不输入任何数据的情况下提交表单，然后验证消息将从命令对象显示在 GSP 上。

第 2 步：提交带有数据的表单，用户导航到成功页面。

第 3 步：单击浏览器后退按钮并注意以前的验证消息。

知道什么是清除验证消息的解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T08:22:05.653

就像loteq 说的那样，我正在捕获 beforeunload 并请求一个清除会话的 url，就像你可以在控制器中执行 clearErrors()

```
 $(window).bind('beforeunload', function() {jQuery.get('${createLink(action: 'clearUploadSession')}');} ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T08:17:30.647

你的问题是在客户端，而不是在服务器端。当您单击返回按钮时，客户端不会重新加载页面，因此您想在服务器上完成的任何事情都不会完成。

您可以在页面表单上设置一个事件，它会告诉浏览器每次都重新加载表单，甚至在后面：window.onbeforeunload。即使在那里放置一个空的事件处理程序，也会强制重新加载页面：

`window.onbeforeunload = function () { }`

资源：

[http://www.hunlock.com/blogs/Mastering_The_Back_Button_With_Javascript](http://www.hunlock.com/blogs/Mastering_The_Back_Button_With_Javascript)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T18:30:16.713

I think that what you are looking for is the POST Redirect GET process that's explained in the [wikipedia](http://en.wikipedia.org/wiki/Post/Redirect/Get).

> Post/Redirect/Get (PRG) is a web development design pattern that prevents some duplicate form submissions, creating a more intuitive interface for user agents (users). PRG implements bookmarks and the refresh button in a predictable way that does not create duplicate form submissions.

If the user ended the flow (success message like you said) the back button should go to the beginning of the flow instead of showing the cached page. If you look, this is the default behavior of the scaffold pages (create, save, edit, update). The protected post pages like save and update will issue a `redirect` that will avoid this cache. Just generate a controller for a domain class and you will see what I'm talking.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-24T22:20:01.353

我不知道您正在使用的 Grails 版本，但在 Grails 2.2 中，您可以使用 clearErrors() 方法。

[看这里！](http://grails.org/doc/2.2.x/ref/Domain%20Classes/clearErrors.html)

# objective-c - 如何使 UIView 的内容无效以强制重绘？

> ID：15603148
> 
> 赞同：0
> 
> 时间：2013-03-24T19:48:31.033
> 
> 标签：objective-c, uiview, ios6

我有一个 UIView 就像一个时间表（使用 XCode 4.6、iOS 6.2 和 Storyboards 编写的 iPad 应用程序）。我实际上有两 (2) 个 UIVIew，一个在窗口的上半部分，另一个在下半部分。上半部分有日历；以及低于此的时间网格。当用户点击有约会的一天时，它们会被绘制在底部的 UIView 上。用户可以点击任何一天的约会，旧的被删除，新的数据被绘制在底部视图上。

这很好用，除非那天没有被点击的约会，在这种情况下，旧数据仍然存在，而不是被以某种方式删除。我已经尝试过 [self setNeedsDisplay]，但由于没有任何改变，因此没有绘制任何内容。有没有办法使 UIView 的内容无效以强制在没有数据的情况下重绘它？

**更新**：这是绘制约会的代码：

```
- (void)drawRect:(CGRect)rect  {

//  load dictionary files from plists
NSString *path = [[NSBundle mainBundle] bundlePath];
//    NSLog(@"\n\npath %@",path);
//
NSString *timesFinalPath = [path stringByAppendingPathComponent:@"startingTimes.plist"];  //  do starting times
NSDictionary *startDict = [NSDictionary dictionaryWithContentsOfFile:timesFinalPath];

NSString *namesFinalPath = [path stringByAppendingPathComponent:@"techNames.plist"];  //  do tech names
NSDictionary *techDict = [NSDictionary dictionaryWithContentsOfFile:namesFinalPath];
//    NSLog(@"\nPath: %@\ntechDict.count: %d\nstartDict.count %d", path, techDict.count, startDict.count);

//    NSLog(@"nbr of recognizers: %lu", (unsigned long)self.gestureRecognizers.count);

//  find out how many appointments we have for this day
SingletonAppointments *sharedInstance = [SingletonAppointments sharedInstance];  //  initialize

if(sharedInstance.globalApptList.count > 0) {

    for(int i = 0; i < sharedInstance.globalApptList.count; i++)  {  //  get customer apointments for this day

        AppointmentInfo *apptObject = [sharedInstance.globalApptList objectAtIndex:i];

        //NSLog(@"apptObject.aApptKey: %@", apptObject.aApptKey);

        //  using apptObject.aApptKey, get the client's name
        NSPredicate *predicate =  ([NSPredicate predicateWithFormat:@"(aClientKey = %@)", apptObject.aApptKey]);
        clientInfo = [ClientInfo MR_findAllWithPredicate: predicate];
        NSString *cliInfo;
        for (ClientInfo *cli in clientInfo) {
            cliInfo = cli.aClientName;  //  found client name
        }

        //  settings for name drawing
        const float nameFontSize = 14;
        UIFont *hourfont=[UIFont systemFontOfSize: nameFontSize];

        //  now compute the duration
        NSDateFormatter *df = [[NSDateFormatter alloc] init];
        [df setDateFormat:@"HH:mm"];
        NSTimeInterval interval = [apptObject.aEndTime timeIntervalSinceDate:apptObject.aStartTime];
        int hours = (int)interval / 3600;             // integer division to get the hours part
        int minutes = (interval - (hours*3600)) / 60; // interval minus hours part (in seconds) divided by 60 yields minutes
        //            NSString *duration = [NSString stringWithFormat:@"%d:%02d", hours, minutes];

        //  localize time
        NSDate *sTime = [self localizeDate: apptObject.aStartTime];
        //            NSDate *eTime = [self localizeDate: apptObject.aEndTime];
        //            NSLog(@"\n\nsTime: %@    eTime: %@", sTime, eTime);
        //            NSLog(@"\nlocalized sTime: %@\nlocalized eTime %@", sTime, eTime);

        //  determine time slot  (dictiionary starts at 0900... must accomodate for that)
        NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
        [formatter setTimeZone:[NSTimeZone timeZoneWithName:@"GMT"]];  //Optionally for time zone converstions
        [formatter setDateFormat:@"HH:mm"];

        //  get time shop opens and closes
        PreferenceData *prefDataFound = [PreferenceData MR_findFirst];
        if(prefDataFound)  {  //  fill the times
            startHour = prefDataFound.aShopOpens;
            endHour = prefDataFound.aShopCloses;
        }
        //            NSLog(@"startHour: %@    endHour: %@",startHour, endHour);

        //  now, get first time slot in dictionary
        NSArray *ts = [startDict allKeysForObject:[NSNumber numberWithInt:5]];  //  comes back with one entry: 9:00

        //  clean it (remove colon)
        NSString *dictValue = ts[0];
        NSString *cleanDictValue = [dictValue stringByReplacingOccurrencesOfString:@":" withString:@""];

        //  convert to int
        int dictStartTime = [cleanDictValue intValue];
        int intStartHour = [startHour intValue];

        //  compute gridTimeOffset
        float gridTimeOffset = dictStartTime - intStartHour;

        NSString *stringFromDate = [formatter stringFromDate:sTime];
        //            NSLog(@"\n\nstringFromDate: %@",stringFromDate);
        //            NSLog(@"\nserviceTech: %@", apptObject.aServiceTech);

        //  find the correct column by tech name
        NSNumber *techColumn = [techDict objectForKey:apptObject.aServiceTech];
        //            NSLog(@"\nserviceTech: %@, techColumn: %@", apptObject.aServiceTech, techColumn);

        //  set the context
        CGContextRef context = UIGraphicsGetCurrentContext();

        //  draw the name...  (x refers to column; y refers to time slot)
        [[UIColor blueColor] set];  //  sets color of customer name
        NSNumber *timeSlot = [startDict objectForKey:stringFromDate];
        float correctedSlot = [timeSlot floatValue] + gridTimeOffset;  //  corrected slot info for name and rectangle
        [cliInfo drawAtPoint:CGPointMake([techColumn floatValue], correctedSlot) withFont:hourfont];
        //            NSLog(@"\ntimeSlot: %@    adjusted: %@", [timeSlot floatValue], ([timeSlot floatValue] - gridTimeOffset));

        //  make some settings for the blocking
        UIGraphicsBeginImageContext(self.bounds.size);
        //            CGContextSetStrokeColorWithColor(context, [UIColor blackColor].CGColor);
        //            CGContextSetLineWidth(context, 1.0);

        //  get the CGContextRef for drawing the rectangle
        CGContextSetFillColorWithColor(context, [[[UIColor grayColor] colorWithAlphaComponent: 0.3] CGColor]);

        //            NSNumber *startPos = [startDict objectForKey:stringFromDate];
        int shadeHeight = ((hours * 4) + (minutes / 15)) * 25;  //  compute starting y value

        //            CGContextFillRect(context, CGRectMake([techColumn floatValue], [startPos floatValue], 218, (float)shadeHeight));
        CGContextFillRect(context, CGRectMake([techColumn floatValue], correctedSlot, 218, (float)shadeHeight));

        UIGraphicsEndImageContext();  //  end the context so the other appointments will draw
    }

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:05:14.477

这应该在控制底部视图的视图控制器的回调中处理。（如果你有一个控制顶部和底部的视图控制器，同样适用。）在它的更新方法中（应该在选择一天时调用，包括空天）应该有这样的东西。

```
-(void)update {
    if (selectedDay.events && selectedDay.events.count) {
       // do your normal update
    }
    else {
       // empty the view
    }
} 
```

请注意，如果底部视图是或具有表视图，则重置数据数组或设置（上面引用为`selectedDay.events`）并调用

```
[_tableView reloadData]; 
```

如果您有其他方案，则必须“手动”清空它。

**编辑**

正如 spokane-dud 指出的那样，数据源单例存在缺陷。数据必须在适当的时候明确设置为空。

```
if(appointmentInfo.count > 0) { 
    for (AppointmentInfo *appt in appointmentInfo) { 
      sharedInstance.globalApptList = appointmentInfo; // move data to sharedInstance 
    } 
} 
else { 
    sharedInstance.globalApptList = nil; 
} 
```

# jquery - 用 JQuery 中的单击替换悬停事件

> ID：15603155
> 
> 赞同：0
> 
> 时间：2013-03-24T19:48:45.160
> 
> 标签：jquery, function, onclick, click, hover

我正在使用以下 JQuery 代码来控制鼠标悬停时的一些样式元素，以获得下拉菜单解决方案：

```
$(window).load(function () {

    // On hover show or hide
    $("#menu ul li").hover(function(){
             $(this).children("ul").show();
             $(this).children("ul").css('background-image', 'none');
       },
       function(){
             $(this).children("ul").hide();

    })

    // On hover show or hide
    $("#menu ul ul li, #menu ul ul li a ").hover(function(){
             $(this).css('color', '#666');
       },
       function(){
             $(this).css('color', '#FFF');       
    })

}); 
```

请参阅工作示例：

[http://www.youmeusdesign.co.uk/menu_test](http://www.youmeusdesign.co.uk/menu_test)

我想对此进行修改，以便可以用单击功能替换悬停功能。当客户端使用不支持悬停功能的触摸界面时。以 Windows 电话为例。iOS 工作正常，因为设备已经有一些类来处理悬停事件。

我尝试修改我的脚本，用 .click 替换 .hover 但它不起作用？

例如

```
$("#menu ul li").click(function(){ 
```

非常感激任何的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:02:25.447

试试这个：（在这里测试：http: [//jsfiddle.net/d9mPC/](http://jsfiddle.net/d9mPC/)）

```
$("#menu ul li").on("mouseover mouseout tap",function(event){      
    if($(this).children("ul").is(":hidden") && (event.type == "mouseover" || event.type == "tap")){
         $(this).children("ul").show();
         $(this).children("ul").css('background-image', 'none');
   }else if($(this).children("ul").not(":hidden") && (event.type == "mouseout" || event.type == "tap")){
         $(this).children("ul").hide();
   }    
});

// On hover show or hide
$("#menu ul ul li, #menu ul ul li a ").on("mouseover mouseout tap",function(event){        
   if(!$.hasData($(this),"hovered") && (event.type=="mouseover" || event.type=="tap")){
         $(this).css('color', '#666');
         $.data((this),"hovered",true);
   }else if($.hasData((this),"hovered") && (event.type=="mouseout" || event.type=="tap")){
         $(this).css('color', '#FFF');
       $.removeData((this),"hovered");
   }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:01:22.830

你可能可以同时做这两个。

我要做的是允许单击或悬停以显示该项目（跟踪单击状态，以便在悬停打开它时不会立即关闭它）。

然后你会做一些事情

*   您不必嗅探设备
*   您将使人们能够单击切换菜单项

另一种方法是[嗅探设备](https://stackoverflow.com/questions/3514784/best-way-to-detect-handheld-device-in-jquery)类型或有条件地为每个设备加载不同的 javascript 文件（服务器端的嗅探设备），这可能会导致维护问题。

我建议只为每台设备实现两者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T19:55:14.723

> 我想对此进行修改，以便可以用单击功能替换悬停功能。

```
$("#menu").on('click', 'ul li', function(){
         $("#menu li ul").hide().find('li a').css('color', '#FFF');
         $("ul", this).show().children('li a').css('color', '#666');
}); 
```

# java - 菜单界面 学生记录系统

> ID：15603157
> 
> 赞同：0
> 
> 时间：2013-03-24T19:48:43.640
> 
> 标签：java, loops, interface, menu

我有一个部分工作的记录系统，但我在菜单界面上遇到了问题。基本上，菜单应该允许您：

1.  添加学生
2.  删除学生
3.  打印学生
4.  退出

现在菜单工作正常，但我在“添加学生”部分遇到问题。当他们添加学生时，他们需要：

*   名字提示
*   姓氏提示
*   提示输入 ID 号

完成此操作后，它会询问他们是否要添加另一个；如果输入“y”，则再次循环，如果输入“n”，则返回主菜单。

现在在我的上，当他们按“n”时没有任何反应，当您按 y 时，它会再次循环，但它不会让您为名字输入任何值。

这是系统的所有代码：

REGISTRYINTERFACE.java

```
/**
 * @version 1.0
 * @author parry2411 
 */
package student;

import java.util.Scanner;

    public class RegistryInterface
    {

        private Registry theRegistry = new Registry();
        Scanner input = new Scanner(System.in);

        public RegistryInterface(Registry theRegistry)
        {
        }

        public void doMenu()
        {
            boolean done = false;

            while (!done)
            {
                try
                {
                    System.out.println("\nRegistry Main Menu\n*******************\n");
                    System.out.println("1\. Add a Student \n2\. Delete a Student"
                            + "\n3\. Print Registry\n0\. Quit");

                    System.out.println("Select Option [1, 2, 3, 0] :>");
                    String userDecission = input.nextLine();

                    int decission = Integer.parseInt(userDecission);

                    switch (decission)
                    {
                        case 0:
                            System.out.println("System Closing Down..");
                            break;

                        case 1:
                            doAddStudent();
                            break;

                        case 2:
                            doDeleteStudent();
                            break;

                        case 3:
                            doPrintRegistry();
                            break;

                        default:
                            System.out.println("\nPlease Enter in a valid"
                                    + " Menu Option");
                            doMenu();
                            break;
                    }
                    done = true;
                }catch(Exception e)
                {
                    System.out.println("Incorrect Value Entered, Try Again....");
                }
            }
        }

    private void doAddStudent()
        {
            String addMore;
            do
            {
                System.out.println("\nAdd New Student\n***********\n");

                try
                {
                    System.out.println("Enter Students Forename :>");
                    String fName = input.nextLine();

                    System.out.println("Enter Student Surname :>");
                    String sName = input.nextLine();

                    System.out.println("Enter Student ID Number :>");
                    int idNum = input.nextInt();

                    theRegistry.addStudent(new Student(fName, sName, idNum));

                } catch (Exception e)
                {
                    System.out.println("\nERROR OCCURED: Incorect Value Entered"
                            + "\nTry Again... \nStudent Was NOT added");
                }

                System.out.println("\nAdd Another Student (Y/N) : >");
                addMore = input.next();

            } while (!"n".equals(addMore));
        }

        private void doDeleteStudent()
        {
            String another;
            do
            {
                System.out.println("\nDelete Student\n***********\n");
                System.out.println("Enter Student ID To Delete :>");
                try
                {
                    int studID = input.nextInt();
                    theRegistry.deleteStudent(studID);

                } catch (Exception e)
                {
                    System.out.println("\nERROR OCCURED: Incorect Value Entered"
                            + "\nTry Again...\n");
                }

                System.out.println("\nDelete Another? (Y/N)");
                another = input.next();

            } while (!"n".equals(another));
        }

        private void doPrintRegistry()
        {

            System.out.println("\nPrinting Registry\n***********\n");

            if(theRegistry.studentList.size() == 0)
            {
                System.out.println("The Student Record System Contains No Student"
                        + " Records, Please Add Students\n\n");
            }
            else
            {
               System.out.println(theRegistry.format()); 
                System.out.println("\n****Printing Finished........");
            }

            doMenu();

        }
    } 
```

注册表.java

```
/**
 * @version 1.0
 * @author parry2411 
 */
package student;

import java.util.Iterator;
import java.util.LinkedList;

public class Registry
{
    public LinkedList<Student> studentList = new LinkedList<>();
    public Iterator<Student> iter = studentList.iterator();

    public Registry()
    {
    }

    public void addStudent(Student aStudent)
    {
        Iterator<Student> addIterator = studentList.iterator();

        while (addIterator.hasNext())
        {
            Student ob = addIterator.next();
            if (ob.getStudentID() == aStudent.getStudentID())
            {
                System.out.println("This Student ID "
                        + ""+ aStudent.getStudentID()+ " Is Already Used"
                        + "\n Try Adding Again......");
                return;
            }
        }
        System.out.println("Student "+ aStudent.getForeName() + " "
                + "" + aStudent.getSurName() +" "
                + "Successfully Added To System.....");

        studentList.addLast(aStudent);
    }

    public void deleteStudent(int studentID)
    {
        Iterator<Student> deleteIterator = studentList.iterator();
        boolean removed = false;

        while(deleteIterator.hasNext())
        {
            Student ob = deleteIterator.next();

            if(ob.getStudentID() == studentID)
            {
                deleteIterator.remove();
                removed = true;
                System.out.println(ob.getForeName() + " " + ob.getSurName() + " Was Succesffully Removed from System. \n");
            }
        }
        if(!removed)
        {
            System.out.println("Student ID not found");
        }
    }

    public String format()
    {
        StringBuilder sB = new StringBuilder();
        Iterator<Student> formatIterator = studentList.iterator();

        while(formatIterator.hasNext())
        {
            Student ob = formatIterator.next();
            sB.append(ob.format());      
        }
        return sB.toString();
    }

    @Override
    public String toString()
    {
        Iterator<Student> toStringIterator = studentList.iterator();
        StringBuilder sB = new StringBuilder();

        while(toStringIterator.hasNext())
        {
            Student ob = toStringIterator.next();
            sB.append(ob.toString()).append("\n");
        }
        return sB.toString();
    }
} 
```

注册表应用程序

```
package student;

public class RegistryApp
{

    public static void main(String[] args)
    {
        Registry theRegistry = new Registry();
        RegistryInterface aRegInterface = new RegistryInterface(theRegistry);
        aRegInterface.doMenu();   
    }
} 
```

学生.java

```
/**
 * @version 1.0
 * @author parry2411
 * Date Created: 18-Mar-2013
 */

package student;

public class Student 
{
    private String foreName;
    private String surName;
    private int studentID;

    public Student(String foreName, String surName, int studentID)
    {
        this.foreName = foreName;
        this.surName = surName;
        this.studentID = studentID;
    }

    public String getForeName()
    {
        return foreName;
    }

    public void setForeName(String foreName)
    {
        this.foreName = foreName;
    }

    public String getSurName()
    {
        return surName;
    }

    public void setSurName(String surName)
    {
        this.surName = surName;
    }

    public int getStudentID()
    {
        return studentID;
    }

    public void setStudentID(int studentID)
    {
        this.studentID = studentID;
    }

    @Override
    public String toString()
    {
        return getClass().getSimpleName()+"{" + "foreName=" + foreName + ", surName=" + surName + ", studentID=" + studentID + '}';
    }

    public String format()
    {
        return String.format("%-5s %-5s \t\t %-5d \n",foreName,surName,studentID);
    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:05:29.897

将您的方法更改`doAddStudent`为这种方式：

```
private void doAddStudent()
    {
        String addMore;
        do
        {
            System.out.println("\nAdd New Student\n***********\n");

            try
            {
                System.out.println("Enter Students Forename :>");
                String fName = input.next();//use next() instead of nextLine()

                System.out.println("Enter Student Surname :>");
                String sName = input.next();//use next() instead of nextLine();

                System.out.println("Enter Student ID Number :>");
                int idNum = input.nextInt();

                theRegistry.addStudent(new Student(fName, sName, idNum));

            } catch (Exception e)
            {
                System.out.println("\nERROR OCCURED: Incorect Value Entered"
                        + "\nTry Again... \nStudent Was NOT added");
            }

            System.out.println("\nAdd Another Student (Y/N) : >");
            addMore = input.next();

        } while (!"n".equals(addMore));
    } 
```

由于`Scanner.nextLine()`您正在使用，您遇到了错误。现在问题是 **为什么**？

[`Scanner.nextLine()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html#nextLine%28%29)如官方文档所述是：

> **将此扫描器前进到当前行并返回被跳过的输入。**此方法返回当前行的其余部分，不包括末尾的任何行分隔符。位置设置为下一行的开头。

`Scanner.next()`没有正确终止分配的内存行。因此，当在用户输入之后`nextLine()`调用 via时，它实际上终止了其中实际具有值的前一行 - 输入 via而不是获取新值。这就是它跳过来自 user 的条目的原因。因此，为了继续读取输入的值而不是前一个空行（因为返回的值不终止），您可以使用which 根据官方文档指出：`String fName = input.nextLine();``addMore = input.next();``y``next()``String``next()`[`Scanner.next()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html#next%28%29)

> **从此扫描器中查找并返回下一个完整的令牌。**

**更新**
您还应该替换：

```
String userDecission = input.nextLine(); 
```

至

```
String userDecission = input.next(); 
```

# c++ - 错误：从初始化列表分配给数组

> ID：15603158
> 
> 赞同：15
> 
> 时间：2013-03-24T19:48:47.750
> 
> 标签：c++, arrays, assign

我有一门课，例如：

```
class dialog
{
    public:
    double dReturnType[][5][3];
}; 
```

```
#include <cstdlib>
#include <iostream>
include <string>

using namespace std;
#include "dialog.h";

int main(int argc, char *argv[])
{
    dialog People;
    People.dReturnType[0][1] = {1.2,2.3,6.6};
    return 0;
} 
```

它返回：

> [警告] 扩展初始化列表仅适用于 -std=c++11 或 -std=gnu11 [默认启用] [错误]：从初始化列表分配给数组

我在网上查了一下，真的找不到解决这个问题的方法。我不想在类文件中编辑类（有点违背了目的）。有什么帮助吗？

注意：该类在单独的项目文件中

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-24T19:58:25.160

**初始化器列表仅在初始化期间可用。**

如果要`std::initializer_list`在初始化后使用：

```
auto init = std::initializer_list<double>({1.2,2.3,6.6});
std::copy(init.begin(), init.end(), your_array); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:12:30.497

除非您使用的是 c++11，否则您无法初始化扩展列表。

如果我是你的一个好习惯是使用 * 而不是空的“[]”并在你知道大小时分配内存（使用 new 或 malloc）。dReturn 程序上的类型是 matices 的指针。

而且你只给向量的一个成员一个完整的列表。

```
People.dReturnType[0]={1.2,2.3,6.6}; 
```

这更有意义。

尝试封装和使用/创建初始化函数，这也将帮助您做到这一点。C++ 会将所有 0 放在开头，但您可以执行一个函数并调用：

```
dialog People("the_atributes_are_here"). 
```

将 dReturnType 设为私有并使用函数来访问它的数据并插入/修改内容是一个很好的做法。但这取决于你。

# actionscript-3 - 即使我从中删除光标，该按钮仍处于活动状态，ActionScript 3

> ID：15603159
> 
> 赞同：0
> 
> 时间：2013-03-24T19:48:54.203
> 
> 标签：actionscript-3, flash, actionscript, game-development

好的，所以我有我的游戏，但是我有一个问题，每当我按下按钮时，如果我从按钮上移开光标而不释放鼠标按钮，按钮仍然处于活动状态。我该如何解决它以使鼠标不在按钮的点击区域中时它不是活动的----为了更好和简单地解释它..如果我按下按钮并且不要放开它，如果我是将鼠标拖出按钮区域并松开按钮仍将处于活动状态，我该如何解决？这是我让玩家走路的代码。

```
 var leftPressed:Boolean = false;
var rightPressed:Boolean = false;

var upPressed:Boolean = false;
var shootDown:Boolean = false;

var onGround:Boolean = true;

var level:Number = 1;

var bullets:Array = new Array();
var container_mc:MovieClip; 
var enemies:Array = new Array();

var score:Number = 0;

var tempEnemy:MovieClip;

var tempLaser:MovieClip;

var timesHit:uint = 0;

// BUTTON EVENTS EITHER CLICKED OR NOT

left_btn.addEventListener(MouseEvent.MOUSE_DOWN, moveLeft);
right_btn.addEventListener(MouseEvent.MOUSE_DOWN, moveRight);
up_btn.addEventListener(MouseEvent.MOUSE_DOWN, moveUp);
shoot_btn.addEventListener(MouseEvent.MOUSE_DOWN, shootPressed);

left_btn.addEventListener(MouseEvent.MOUSE_UP, leftUp);
right_btn.addEventListener(MouseEvent.MOUSE_UP, rightUp);
up_btn.addEventListener(MouseEvent.MOUSE_UP, upUp);

player.gotoAndStop('still');

stage.addEventListener(Event.ENTER_FRAME,onenter);

function onenter(e:Event):void{
    if (rightPressed == true && leftPressed == false){
        player.x += 8;
        player.scaleX = 1;
        player.gotoAndStop("walking");
        cloud.x -= 8;

    } else if (leftPressed == true && rightPressed == false){
        player.x -= 8;
        player.scaleX = -1;
        player.gotoAndStop('walking');
        cloud.x += 8;

   } else if(upPressed == true && leftPressed == false && rightPressed == false){

       }
        else{  
        rightPressed = false;
        leftPressed = false;
        player.gotoAndStop('still')}

}
// **** MOVEMENT CONTROLS *********

function shootPressed(e:MouseEvent):void{
    shootDown = true;
    if(shootDown == true){
        fireBullet();
        }

    }

function fireBullet():void
{
    var playerDirection:String;
    if(player.scaleX < 0){
        playerDirection = "left";
    } else if(player.scaleX > 0){
        playerDirection = "right";
    }
    var bullet:Bullet = new Bullet(player.x, player.y, playerDirection);
    //bullets = new Array();
    bullet.y = player.y + 8;
    stage.addChild(bullet);
    bullets.push(bullet);
    trace(bullets);

}

// BUTTON FUNCTIONS

function moveLeft(e:MouseEvent):void
{
    if(MouseEvent.MOUSE_DOWN){
    leftPressed = true;
    }else if (MouseEvent.MOUSE_UP) {
        leftPressed = false;
        }

}
function moveRight(e:MouseEvent):void
{
    if (MouseEvent.MOUSE_DOWN){
    rightPressed = true;
    }else if (MouseEvent.MOUSE_UP){
        rightPressed = false;
        }

}

function moveUp(e:MouseEvent):void
{
    if(MouseEvent.MOUSE_DOWN){
        upPressed = true;
        onGround = false;
        player.y -= 100;
        } 

}

function leftUp(e:MouseEvent):void
{
    leftPressed = false;
}
function rightUp(e:MouseEvent):void
{
    rightPressed = false;
}
function upUp(e:MouseEvent):void
{
    upPressed = false;
 if(upPressed == false){
     player.y += 100;

     }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:09:28.453

除了 mouseup 事件之外，您还需要对 mouse out 事件做一些事情。如果不这样做，当鼠标按下（“拖出”）时光标从按钮上移动时，永远不会触发鼠标向上事件。

使用事件`MouseEvent.MOUSE_OUT`或`MouseEvent.RELEASE_OUTSIDE`

最好的方法是将事件监听器添加到`MOUSE_UP`事件中，或者`MOUSE_OUT`在`RELEASE_OUTSIDE`触发`MOUSE_DOWN`事件时添加事件侦听器。

代码示例：

```
left_btn.addEventListener(MouseEvent.MOUSE_DOWN, handleButtonDown);

function handleButtonDown(e:MouseEvent):void 
{
   // activate "up" listeners
   e.target.addEventListener(MouseEvent.MOUSE_UP, handleButtonUp);
   e.target.addEventListener(MouseEvent.MOUSE_OUT, handleButtonUp);
   e.target.addEventListener(MouseEvent.RELEASE_OUTSIDE, handleButtonUp);

   // call your button action function
   // e.target is your button
   buttonDownAction(e.target);

}

function handleButtonUp(e:MouseEvent):void 
{
   // activate "up" listeners
   e.target.removeEventListener(MouseEvent.MOUSE_UP, handleButtonUp);
   e.target.removeEventListener(MouseEvent.MOUSE_OUT, handleButtonUp);
   e.target.removeEventListener(MouseEvent.RELEASE_OUTSIDE, handleButtonUp);

   // call your button action function
   // e.target is your button
   buttonUpAction(e.target);

}

function buttonDownAction(button:MovieClip) {
   switch(button) {
      case left_btn: 
          // do your thing here

      case right_btn:
          // do something else here
    }
} 
```

在这个例子中，我使 handleButtonDown 和 handleButtonUp 更加通用，因此您可以将这 2 个函数用于所有按钮。

希望对你有帮助，祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:14:48.410

我想这就是你要找的东西。这应该足够了。

```
left_btn.addEventListener(MouseEvent.MOUSE_DOWN, moveLeft);
left_btn.addEventListener(MouseEvent.MOUSE_UP, LeftUp);

function moveLeft(e:MouseEvent):void
{
  leftPressed = true;
  left_btn.addEventListener(MouseEvent.MOUSE_OUT, LeftOut);
}

function leftUp(e:MouseEvent):void
{
  leftPressed = false;
  left_btn.removeEventListener(MouseEvent.MOUSE_OUT, LeftOut);
}

function leftOut(e:MouseEvent):void
{
  leftPressed = false;
  left_btn.removeEventListener(MouseEvent.MOUSE_OUT, LeftOut);
} 
```

MOUSE_OUT 只是在鼠标离开您的对象时触发，因此您只需添加具有此类事件的 EventListener。当然，你可能会明白，如果你之前没有点击过你的btn，那么监听这个事件并不聪明，这就是为什么我选择只在监听MOUSE_DOWN时才添加MOUSE_OUT。因为你想要的只是在你抬起鼠标时设置 leftPressed 我猜你想要鼠标不在时也一样。在此之后，我删除了无用的侦听器 (MOUSE_OUT) 以便能够再次收听它们，因为这是一种常见的内存浪费。

但是，我真的不明白你为什么这样做：

```
function moveLeft(e:MouseEvent):void
{
   if(MouseEvent.MOUSE_DOWN){
       leftPressed = true;
   }else if (MouseEvent.MOUSE_UP) {
       leftPressed = false;
   }
} 
```

那有什么用？！

# python - 如何在 Python 中忽略多输出函数的输出？

> ID：15603163
> 
> 赞同：10
> 
> 时间：2013-03-24T19:49:17.040
> 
> 标签：python, function, output

假设我有一个功能：

```
def f():
  ...
  ...
  ...
  return a,b,c 
```

我只想在函数的输出中得到 b 。我必须使用哪个作业？

谢谢。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-03-24T19:50:49.337

您可以将返回的元组解压缩为一些虚拟变量：

```
_, keep_this, _ = f() 
```

它不一定是`_`，只是一些明显未使用的东西。

（不要`_`在交互式解释器中用作虚拟名称，它用于保存最后一个结果。）

或者，索引返回的元组：

```
keep_this = f()[1] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-24T19:59:44.303

```
def f():
    return 1,2,3 
```

在这里，`f()`返回一个元组`(1,2,3)`，因此您可以执行以下操作：

```
a = f()[0]
print a
1

a = f()[1]
print a
2

a = f()[2]
print a
3 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-24T19:52:39.693

您对该`return a,b,c`行所做的是创建 a`tuple`然后从函数中返回它。因此，您可以使用元组解构来仅从结果中获取您想要的值。例子：

```
def f(x):
    return x, x + 1, x + 2
_, b, _ = f(0)
print(b) # prints "1" 
```

# c - 给实时时钟自己的线程是个好主意吗？

> ID：15603167
> 
> 赞同：2
> 
> 时间：2013-03-24T19:49:42.763
> 
> 标签：c, multithreading, real-time

我对实时编程/多线程还很陌生，我正在尝试进行一些实际的开发。我正在尝试为一个学校项目编写一个程序（用 C 语言），该项目执行多项任务，包括图像处理（openCV）、服务网页（使用 libmicrohttpd 之类的库）以及与外围设备的接口。该程序将有大量线程，每个任务基本上都是独立运行的。

该程序的一个非常重要的部分是事件/数据记录和在外围设备上设置时钟，这需要计算机的板载时间。也就是说，不止一个线程将需要当前时间作为其任务的一部分。所以我的问题是，声明一个全局时间结构并根据单个线程的需要调用 gettime 是更好的主意，还是拥有一个始终保持当前时间的单独线程，然后每个线程都从中读取？前者听起来可能存在访问问题，而后者听起来很难以适当的频率更新。

为了更详细地了解我正在执行的任务：

*   每当opencv检测到某个对象时，我都会保存包含时间的图像和文本日志
*   我正在记录从外围设备收到的最后十个数据包的时间（这是一个非常低的数据速率连接）
*   外设没有板载 RTC，所以当它连接或漂移太远时，这个程序会设置它。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:00:48.323

您最好的选择是使用线程安全的时间获取器。`gettimeofday`就是这样一个函数（参见此处：[Linux 中的 gettimeofday 函数线程安全吗？](https://stackoverflow.com/questions/3220224/is-the-gettimeofday-function-thread-safe-in-linux)）。它为您提供自 unix 纪元以来的秒数和微秒数，因此应该很容易足够准确地进行日志记录。只要您不使用任何具有内部缓冲区等的函数，您如何处理从该函数中获得的数据都取决于您。

您还应该注意如何编写日志。最安全的方法是为每个线程使用单独的文件，但您也可以使用互斥锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T21:00:54.627

您说您的设备没有 RTC。所以我期望它是一个小型嵌入式平台？如果是这样，几乎总是有一些可用的硬件计时器。如果是这样，您可以使用中断或使用线程来轮询计时器值。并且不要忘记记录时间调整，以便以后进行评估。

# jquery - 找不到 URI 时，ASP.NET MVC 4 jQuery ajax 请求将我的自定义 404 html 作为 200 响应返回

> ID：15603168
> 
> 赞同：0
> 
> 时间：2013-03-24T19:49:50.877
> 
> 标签：jquery, asp.net-mvc

我在按下按钮时有一个 ajax 调用。如果我有`customErrors mode="On"`并且找不到我的 ajax 请求 URI，则`404`html 将作为`200`状态返回给请求。

`web.config`

```
<customErrors mode="On" defaultRedirect="/Errors">
  <error statusCode="404" redirect="~/Errors/Error404" />
</customErrors> 
```

JS 在按钮单击时运行。

```
$.get(api_uri, function (json) {
    console.log(json);
    options.element_to_inject.html(compiled_template(json));
    options.status_container.hide();
}).fail(function () {
    options.status_container.hide();
    options.element_to_inject.html("Error").show();
}); 
```

我的 AJAX 请求调用了我的控制器方法。

```
public JsonResult Get(int? id)
{
    // Do work
} 
```

`console.log(json)`如上所示正在输出我的`404`html。如果我转身`customErrors mode="Off"`，我会根据需要返回一个实际的`404`响应代码。

想法：就好像我需要 ajax 请求来忽略 custom `404`。

如何`customErrors mode="On"`获得不返回`404`html 的请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T19:58:05.017

错误网址是控制器/操作吗？如果是这样，请使用

```
if (Request.IsAjaxRequest())
{
     Response.StatusCode = 404;
     Response.TrySkipIisCustomErrors = true;
} 
```

**更新**

404 的问题在于它通常是由框架在到达您的代码之前生成的。您不能使用`customError`标签处理它，但无论请求是否为 AJAX 请求，它都将适用。如果您想使用自定义错误页面来处理它，但希望保留错误代码，请重定向到控制器/操作以生成自定义错误页面，并作为操作的一部分，设置响应代码并关闭 IIS 处理自定义错误。注意：您只能对 AJAX 请求执行此操作，方法是检查它是否是 AJAX 请求，如果是，则仅设置响应代码。

# c++ - SmartPTR 实现堆->isValid 断言

> ID：15603173
> 
> 赞同：1
> 
> 时间：2013-03-24T19:50:24.403
> 
> 标签：c++, pointers

我正在尝试实现一个非常简单的 SmartPointer 用于学习目的，但是我正在努力解决我似乎无法调试的错误。即使在调试模式下，我也没有得到明确的信息，我错了，只有运行时断言。

到目前为止，这是 SmartPTR 的代码：

```
template <typename TYPE>
class SmartPointer
{
    TYPE* pData;
public:
    SmartPointer(void)
        : pData(0)
    {
        std::cout << "DEFAULT CTOR" << std::endl;
    }

    SmartPointer(TYPE* data)
        : pData(data)
    {
        std::cout << "CTOR WITH TYPE*" << std::endl;
    }

    SmartPointer(const SmartPointer<TYPE>& rhs)
    {
        std::cout << "COPY CTOR" << std::endl;
    }

    ~SmartPointer(void)
    { delete pData; }

    SmartPointer<TYPE>& operator=(const SmartPointer<TYPE>& rhs)
    {
        pData = rhs.pData;

        return *this;
    }

    TYPE* operator->(void)
    { return pData; }

    TYPE& operator*(void)
    { return *pData; }
}; 
```

我正在使用的课程非常先进。这是一个简单的 Person 类，可以在 Internet 上的任何地方找到，具有构造函数、复制构造函数和重载赋值运算符。现在有了简单的案例，我没有问题。

```
SmartPointer<Person> p(new Person("Henry", 42));
p->Display(std::cout, *p); // Prints: Henry - 42
SmartPointer<Person> q(p); // Causes runtime error.
SmartPointer<Person> q;
q = p;                     // The same runtime error as with copy constructor. 
```

知道这哪里出错了吗？如果它有帮助，这里是 Person 类：

```
class Person
{
    std::string name;
    unsigned age;
public:
    Person(const char* name, unsigned age)
        : name(name), age(age)
    { std::cout << "PERSON CTOR CALLED!" << std::endl; }
    Person(const Person& rhs)
        : name(rhs.name), age(rhs.age)
    { std::cout << "PERSON COPY CTOR CALLED!" << std::endl; }
    ~Person(void)
    { }
public:
    Person& operator=(const Person& rhs)
    {
        std::cout << "PERSON ASSIGNMENT OPERATOR CALLED!" << std::endl;

        name = std::string(rhs.name);
        age  = rhs.age;

        return *this;
    }
public:
    static std::ostream& Display(std::ostream& os, const Person& p);
};

std::ostream& Person::Display(std::ostream& os, const Person& p)
{
    return os << p.name << " - " << p.age << std::endl;
} 
```

感谢您的每一个帮助！- 乔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T19:55:45.237

您的智能指针只是复制~~复制构造函数和~~赋值运算符中的基础指针。它还删除了析构函数中的指针。因此，每次复制或分配这些智能指针之一时，都会得到多个对象持有指向它们都将尝试删除的东西的指针。

关于复制构造函数（感谢@andyprowl 指出这一点），智能指针类包含一个未初始化的指针，它试图`delete`在析构函数中调用它。这是未定义的行为。

这个问题没有通用的解决方案：您必须指定智能指针的行为方式，以及它实现的所有权类型（如果有）。

# html - 将文本设置为显示在顶部的大表格单元格中

> ID：15603184
> 
> 赞同：0
> 
> 时间：2013-03-24T19:51:05.367
> 
> 标签：html, css, html-table

我有一张这样的桌子；

**HTML**

```
<table>
    <tr>
        <td>mytext</td>
    </tr>
</table> 
```

**CSS**

```
table tr td{
    height: 100px;
    width: 200px;
    border: solid 1px #000;
} 
```

看起来像这样；

![在此处输入图像描述](../Images/a7b22dc955bbe43b259d343930945fcb.png)

但我希望文本从框的开头开始，比如；

![预期的](../Images/e960651a98457dd3abecaa47dc645158.png)

我怎样才能做到这一点？**[这](http://jsfiddle.net/VSZZJ/)**是工作小提琴。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T19:54:58.770

这是答案：

[http://jsfiddle.net/VSZZJ/2/](http://jsfiddle.net/VSZZJ/2/)

```
table tr td{
    height: 100px;
    width: 200px;
    border: solid 1px #000;
    vertical-align: top;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T19:58:37.370

在您的 CSS 中使用以下代码。

```
table tr td{vertical-align: top;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T19:55:27.080

只需使用`vertical-align: top`

[在这里](http://jsfiddle.net/VSZZJ/3/)更新小提琴

# jquery - (jquery) Jtable 加载问题

> ID：15603193
> 
> 赞同：0
> 
> 时间：2013-03-24T19:51:19.833
> 
> 标签：jquery, json, asp.net-mvc

我有一个使用以下代码加载 jtable 的页面[（此处） ：](http://jtable.org)

```
<script type="text/javascript">
        $(document).ready(function () {
            $('#EventTypeTableContainer').jtable({
                title: 'Table of EventType',
                actions: {
                    listAction: 'Admin/GetEventTypeList',
                    createAction: 'Admin/CreateEventType',
                    updateAction: 'Admin/UpdateEventType',
                    deleteAction: 'Admin/DeleteEventType'
                },
                fields: {
                    EventTypeId: {
                        key: true,
                        list: true
                    },
                    ColourCode: {
                        title: 'Event Color',
                        width: '25%',
                        list: true
                    },
                    EventTypeName: {
                        title: 'Event Type',
                        width: '50%',
                        list: true
                    },
                    isSystemEventType: {
                        title: 'Modify/Delete',
                        width: '25%',
                        list: true,
                        create: false,
                        edit: true
                    }
                }
            });
            $('#EventTypeTableContainer').jtable('load');
        });
    </script> 
```

表加载，并显示“无可用数据！”。它确实调用了 listAction，它返回这个 JSON 字符串（例如）：

```
{
   "Result":"OK",
   "Record":[
      {
         "EventTypeID":1,
         "EventTypeName":"Quiz",
         "colourCode":"#FA5858",
         "isSystemEventType":false
      },
  {
     "EventTypeID":2,
     "EventTypeName":"Assignment",
     "colourCode":"#58FA58",
     "isSystemEventType":false
  },
  {
     "EventTypeID":3,
     "EventTypeName":"MidTerm",
     "colourCode":"#5858FA",
     "isSystemEventType":false
  },
  {
     "EventTypeID":4,
     "EventTypeName":"Exam",
     "colourCode":"#FA58F4",
     "isSystemEventType":false
  }
]
} 
```

我初始化表格的方式或数据格式有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T09:10:07.790

jtable 考虑区分大小写，因此请确保您的列的名称与您在结果中列出的名称完全相同。表中有两列名称错误。

```
<script type="text/javascript">
    $(document).ready(function () {
        $('#EventTypeTableContainer').jtable({
            title: 'Table of EventType',
            actions: {
                listAction: 'Admin/GetEventTypeList',
                createAction: 'Admin/CreateEventType',
                updateAction: 'Admin/UpdateEventType',
                deleteAction: 'Admin/DeleteEventType'
            },
            fields: {
                EventTypeID: {
                    key: true,
                    list: true
                },
                colourCode: {
                    title: 'Event Color',
                    width: '25%',
                    list: true
                },
                EventTypeName: {
                    title: 'Event Type',
                    width: '50%',
                    list: true
                },
                isSystemEventType: {
                    title: 'Modify/Delete',
                    width: '25%',
                    list: true,
                    create: false,
                    edit: true
                }
            }
        });
        $('#EventTypeTableContainer').jtable('load');
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-17T14:34:18.310

在您的 JSON 响应中，“记录”字段需要根据文档命名为“记录”：http: [//jtable.org/ApiReference#act-listAction](http://jtable.org/ApiReference#act-listAction)

# html - 如何解决输入字段上的错误行高？

> ID：15603197
> 
> 赞同：3
> 
> 时间：2013-03-24T19:51:32.400
> 
> 标签：html, css, wordpress

你如何给一个固定高度的输入字段，它所包含的文本的跨浏览器垂直对齐？

到目前为止，这似乎`line-height`是我最好的选择。但是，在 Chrome 或 Safari 等 webkit 浏览器上，复制/粘贴时光标会跳到顶部对齐。

我注意到 Wordpress 似乎有一个解决方案，他们的[wp-login form](http://wordpress.org/wp-login/)。

有人知道 Wordpress 是如何做到这一点的吗？

CSS

```
input {
    width: 240px;
    height: 32px;
    line-height: 32px;
    font-size: 18px;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-24T19:58:28.393

我为整个文档设置了行高，**`vertical-align: middle`**包括标签和输入以及**`padding`**.
我还`font`为输入重新定义了（系列和大小），`label`因为浏览器已经有它们的默认值，比如 13.3 像素……
最终`border: 1px solid someColor`将有助于多 1 像素或插图的浏览器。

没有`height`。

然后是 Chrome 及其选择。哦`@*$£#`... [isellsoap forms.css](http://isellsoap.github.com/forms.css/)通过删除和重新定义所有内容来解决这个问题，除了它使用高度而不是填充（imo 它的通用性较差）

# asp.net - Juice UI 可拖动控件

> ID：15603204
> 
> 赞同：0
> 
> 时间：2013-03-24T19:51:57.663
> 
> 标签：asp.net, juice-ui

使用 Juice UI 可拖动控件，我可以轻松地使更新面板可拖动，因为他们网站上的代码建议如下：

```
 <asp:Panel runat="server" ID="upFormControl" CssClass="box">
        <p>Drag me around</p>
    </asp:Panel>
    <Juice:Draggable ID="Draggable1" runat="server" TargetControlID="upFormControl" /> 
```

在我看来，我只能使更新面板可拖动，其他控件似乎不起作用。我确实更改了 ID 和 TargetControlID，一切正常。所以我的逻辑告诉我以下代码应该与按钮一起使用：

```
 <asp:Button ID="Button1" runat="server" Text="Button" />
    <Juice:Draggable ID="Draggable2" runat="server" TargetControlID="Button1" /> 
```

但事实并非如此。Juice UI 没有关于这些问题的文档或帮助。如果有人对此有任何经验并且可以告诉我它不适用于其他控件，甚至更好，请告诉我如何让它与其他控件一起使用，那将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T20:30:00.680

你可以试试[Brew](http://shellscape.org/#brew)，可能会解决问题。它是 Juice UI 的一个分支。

# java - 将 KeyEvent 发送到进程

> ID：15603209
> 
> 赞同：5
> 
> 时间：2013-03-24T19:52:31.380
> 
> 标签：java, process, keyevent, processbuilder, awtrobot

我正在尝试从我的 Java 程序向游戏模拟器发送键盘命令，我知道如何设置`process`和`processbuilder`运行进程。

但是，我仍然无法从我的`Robot`.

`InputStream`不会有太大帮助，因为我需要发送诸如`keyEvents`按下“y”按钮并让模拟器做出相应响应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T13:00:34.407

您需要您的应用程序/控制台窗口成为将按键发送到那里的活动窗口。我建议作为第一个测试，运行您的 java 应用程序，但在开始按键之前添加 10 秒的延迟。然后，手动单击并激活模拟器窗口并等待自动按键启动。

此外，在按键之间添加 500 MS 延迟（例如使用 Thread.sleep() ），因为多次按键无法正常工作。

另请参阅：[使用 Java 将焦点设置到 Windows 中的非 Java 应用程序](https://stackoverflow.com/questions/4782231/using-java-to-set-the-focus-to-a-non-java-application-in-windows)

# c++ - std::map 的工作 ::erase（迭代器位置）？

> ID：15603215
> 
> 赞同：9
> 
> 时间：2013-03-24T19:53:35.977
> 
> 标签：c++, algorithm, data-structures, stl, red-black-tree

我在[cplusplus.com](http://www.cplusplus.com/)`std::map`上读到，通过将迭代器作为参数传递来删除 a 中的元素的操作是常数时间。

如果我没有错（如果我错了，请纠正我）迭代器基本上是指向地图中元素的指针，`++`运算符只返回当前元素的有序后继我猜这就是在遍历时实现排序结果的方式`std::map`.

现在，如果地图是一棵红黑树，那么删除元素（使用其地址）不应该是对数时间操作，我想知道他们如何在恒定时间内做到这一点（除非有一个非常浪费内存的替代方案） .

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-24T20:01:59.117

对于初学者，我会警惕您从 cplusplus.com 获得的任何信息；该网站已知有一些错误。

访问[cppreference.com](http://en.cppreference.com/w/cpp/container/map/erase)，我们了解到复杂性是*摊销*的常数时间。这意味着任何 n`erase`次操作的序列都应该花费时间 O(n)，即使单个擦除操作花费的时间大于 O(1)。

事实证明，从红/黑树中插入或删除所需的时间最终计算如下：每次插入或删除需要时间 O(log n) 才能找到节点的位置，但随后只摊销 O( 1) 努力插入或移除元素。这意味着从红/黑树中插入或删除节点所完成的工作主要是确定该节点去哪里所需的工作，而不是事后重新平衡树所需的工作。结果，如果您已经有一个指向红/黑树的指针并想要删除该元素，则只需执行摊销 O(1) 工作即可删除该元素。每个单独的删除可能需要一些时间（最多 O(log n)），但在 n 个操作的流中，完成的总工作最多为 O(n)。

请注意，该标准不要求`std::map`使用红/黑树。它可以使用另一种类型的数据结构（例如，[展开树](http://en.wikipedia.org/wiki/Splay_tree)、[替罪羊树](http://en.wikipedia.org/wiki/Scapegoat_tree)或确定性[跳过列表](http://en.wikipedia.org/wiki/Skiplist)），也可以保证这种时间复杂度。然而，有趣的是，并非所有平衡二叉搜索树结构都支持分期 O(1) 删除。例如，[AVL 树](http://en.wikipedia.org/wiki/AVL_tree)没有这种保证。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-24T20:03:44.170

如果您将迭代器传递给 map 以删除元素，则根据[http://www.cplusplus.com/reference/map/map/erase/](http://www.cplusplus.com/reference/map/map/erase/)将其摊销为常数时间。

摊销常数时间意味着“如果您执行许多操作，则每次操作所花费的平均时间”。因此，可能有一些操作需要比常数时间更长的时间，但如果你多次执行相同的操作，它就是摊销常数。

# c# - CsQuery 还是 Jint？C# 中的 Javascript 数据操作

> ID：15603216
> 
> 赞同：0
> 
> 时间：2013-03-24T19:53:37.470
> 
> 标签：c#, javascript, jint, csquery

我正在编写一个用于统计目的的网络爬虫。该网站通过javascript动态更新。我设法解析 HTML 文件并将所有脚本值复制到一个数组中。我如何在本地或即时重新执行这些脚本以获得返回值？CsQuery、Jint 还是其他方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:19:41.043

CsQuery 是一个完整的 DOM 操作库，用于`.NET`. 虽然它很棒，但它不能“重新执行”脚本。这将需要一个实际的 JavaScript 解释器（如 Jint）。

如果您需要实际模拟浏览器以获取 AJAX 响应之类的东西，我个人在 Selenium 方面取得了很大的成功。

# javascript - 随机骰子 nr，javascript

> ID：15603217
> 
> 赞同：0
> 
> 时间：2013-03-24T19:53:38.307
> 
> 标签：javascript

当我单击一个按钮来滚动所有三个时，是否可以将顶部的这三个功能合二为一，但每个骰子仍然无法获得相同的随机 nr？清除功能适用于单击单个骰子时，底部的功能适用于我想同时滚动所有三个骰子时！所有这些都有效我的问题是只有用更少的代码才能完成？

```
function rollDice1(){
    var randomDice = Math.floor(6*Math.random())+1;  
    dice1.src = "dice/" + randomDice + ".jpg";
}

function rollDice2(){
    var randomDice = Math.floor(6*Math.random())+1;  
    dice2.src = "dice/" + randomDice + ".jpg";
}

function rollDice3(){
    var randomDice = Math.floor(6*Math.random())+1;
    dice3.src = "dice/" + randomDice + ".jpg";
}

function rollDices() {
    rollDice1();
    rollDice2();
    rollDice3();    
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T19:55:32.930

向函数添加一个参数，以便在调用时可以传入要设置的骰子。这假定`dice1`和是`dice2`全局`dice3`变量。

```
function rollDice(di){
    var randomDice = Math.floor(6*Math.random())+1;  
    di.src = "dice/" + randomDice + ".jpg";
}

function rollDices() {
    rollDice(dice1);
    rollDice(dice2);
    rollDice(dice3);    
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T19:55:54.690

您可以循环，无需三次调用外部函数：

```
function rollDices() {
    for (var i=1; i<=3; i++) {
       var randomDice = Math.floor(6*Math.random())+1;
       window['dice'+i].src = "dice/" + randomDice + ".jpg";
    } 
} 
```

用一个数组而不是三个单独的变量来代替`dice1`,`dice2`和`dice3`（我在这里假设它们是全局变量）可能会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T20:10:42.630

我的做法是：

```
function rollDice(times){
    var randomDices = [];
    while (randomDices.length < times)  {
        var rand = Math.floor(6*Math.random())+1;
        if(randomDices.indexOf(rand) > -1 == false)
            randomDices.push(rand);
    }
    return randomDices
} 
```

上面的代码返回一个由您指定长度的随机骰子数组。例如`rollDice(3)`将返回三个随机骰子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-24T20:03:04.270

我实际上更喜欢采用[OO 方法](http://en.wikipedia.org/wiki/Object-oriented_programming)；只需创建可以滚动的不同 Dice 对象。

```
function Dice() {

    var self = this;

    this.face;

    this.roll = function () {
        var randomDice = Math.floor(6*Math.random())+1;
        self.face = "dice/" + randomDice + ".jpg";
        return randomDice;
    };

};

var dice1 = new Dice(),
    dice2 = new Dice(),
    dice3 = new Dice();

dice1.roll();
dice2.roll();
dice3.roll();

console.log(dice1.face);
console.log(dice2.face);
console.log(dice3.face); 
```

[JSFiddle 示例](http://jsfiddle.net/PXErm/)。

（注意它是不完整的；当骰子没有被掷出时，脸是`undefined`。您可能需要采取措施来防止这种状态）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-25T19:19:51.013

这是我对已接受答案的变体：

```
function rollDice(di) {
    var randomDice = Math.floor(6*Math.random())+1;  
    di.src = "dice/" + randomDice + ".jpg";
}

function rollDices(arr) {
    for (i = 0; i < arr.length; i++) {
        rollDice(arr[i]);
    }    
} 
```

这种实现的一个优点是，您可以使用任意数量的骰子并将图像变量传递到`rollDices`数组中。

要掷骰子，您可以这样做：

```
rollDice(dice1); 
```

但是，您也可以这样做：

```
rollDices([dice1]); 
```

要掷两个骰子，您可以这样做：

```
rollDices([dice1, dice2]); 
```

要掷三个骰子，您可以这样做：

```
rollDices([dice1, dice2, dice3]); 
```

要掷四个骰子，您可以这样做：

```
rollDices([dice1, dice2, dice3, dice4]); 
```

ETC...

# cocoa - 子类化 NSTableHeaderCell / NSTableHeaderView 以制作透明标题

> ID：15603219
> 
> 赞同：3
> 
> 时间：2013-03-24T19:53:46.173
> 
> 标签：cocoa, nstableheaderview

如果以前有人问过这个问题，请给我，但我似乎找不到任何问题答案可以给我想要实现的期望行为。

我主要有我想要实现的行为、字体样式和颜色、标题高度等。但是，我似乎无法让标题变得透明。我一直试图通过子类化`NSTableHeaderCell`和覆盖来做到这一点`- (void)drawWithFrame:(NSRect)cellFrame highlighted:(BOOL)isHighlighted inView:(NSView *)view;`

```
[[NSColor colorWithDeviceWhite:1.0 alpha:0.75] set];
NSRectFillUsingOperation(fillRect, NSCompositeSourceOver); 
```

我想要实现的外观在此[屏幕截图](http://downloads.geektheory.ca/nstableheaderview-transparent.png)中。这是我有史以来的第一个问题，我不得不托管图像，因为我没有足够的分数在我的问题中包含图像。

如果有人可以向我解释一下如何实现这种风格的标题，或者向我指出正确的文档，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-20T09:48:42.163

那不是标题视图，而是浮动组行。注意滚动条的位置：它在“标题”旁边而不是下面。

寻找 TableViewPlayground 示例项目，特别是“复杂表视图”示例。您可以在表格中创建单个浮动组行，使其外观和行为类似于标题视图（即显示您自己的排序指示器并接受单击以切换排序）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-07T07:11:21.443

使用以下作品：

目标-C：

```
[[NSColor colorWithDeviceWhite:1.0 alpha:0.75] set];
NSRectFill(fillRect); 
```

或者在 Swift 中：

```
NSColor(deviceWhite: 1.0, alpha: 0.65).setFill()
NSRectFill(fillRect) 
```

# c# - Mono.Cecil 编写库 Target framework 3.5 - 它写入对 mscorlib 4.0 的引用

> ID：15603220
> 
> 赞同：1
> 
> 时间：2013-03-24T19:53:56.307
> 
> 标签：c#, .net, reflection, mono.cecil

我正在尝试将代码注入使用 Mono.Cecil 为 .NET Framework 3.5 编译的现有程序集

这是应用结构

*   控制台应用程序 --> 编译 v4.0

    *   包装对 Mono Cecil 的调用的库 --> 编译的 v3.5
    *   Mono Cecil --> 编译后的 v3.5 (nuget 版)
*   要注入的外部程序集 --> 已编译 v3.5

新修改的程序集对 mscorlib 4.0.0.0 和 mscorlib 2.0.0.0 有双重引用

当我添加字典<,> 构造函数时，我发现问题出在此处

```
 const BindingFlags flags = BindingFlags.NonPublic | BindingFlags.Instance;
        const MethodAttributes methodAttributes =
            MethodAttributes.Public | MethodAttributes.HideBySig | MethodAttributes.SpecialName |
            MethodAttributes.RTSpecialName;

        var serializableContructor =
            typeof(Dictionary<object, object>).GetConstructor(flags, null, new[]
            {
               typeof (SerializationInfo), typeof (StreamingContext)
            }, null);

        var serializationConstr = new MethodDefinition(".ctor", methodAttributes, @this.Module.Import(typeof(void)));
        serializationConstr.Parameters.Add(new ParameterDefinition(@this.Module.Import(typeof(SerializationInfo))));
        serializationConstr.Parameters.Add(new ParameterDefinition(@this.Module.Import(typeof(StreamingContext))));
        serializationConstr.Body.Instructions.Add(Instruction.Create(OpCodes.Ldarg_0));
        serializationConstr.Body.Instructions.Add(Instruction.Create(OpCodes.Ldarg_1));
        serializationConstr.Body.Instructions.Add(Instruction.Create(OpCodes.Ldarg_2));
        serializationConstr.Body.Instructions.Add(Instruction.Create(OpCodes.Call, @this.Module.Import(serializableContructor)));
        serializationConstr.Body.Instructions.Add(Instruction.Create(OpCodes.Nop));
        serializationConstr.Body.Instructions.Add(Instruction.Create(OpCodes.Nop));
        serializationConstr.Body.Instructions.Add(Instruction.Create(OpCodes.Ret));
        @this.Methods.Add(serializationConstr); 
```

typeof(Dictionary<,>) 返回一个引用 mscorlib 4.0.0.0 的类型

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T00:09:15.460

如果您使用的是运行时类型系统，Cecil 将创建对您正在引用的当前版本的引用。在这种情况下，.net 4.0 字典。

如果你想解耦，你必须使用 Cecil 类型系统来加载正确的程序集并为你的模块创建引用。

# ruby-on-rails - 重置嵌套/子资源的主 ID

> ID：15603221
> 
> 赞同：1
> 
> 时间：2013-03-24T19:53:59.267
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我有一个正在构建的应用程序，其中包含带有图像的相册。我希望图像的 id 在添加到相册时从 1 开始。但是，使用我当前的设置，它们不会为每张专辑重置，而是从一张专辑继续编号到下一张。

**楷模**

```
class Album < ActiveRecord::Base
   attr_accessible :title, :description, :album_id
   has_many :images,  :dependent => :destroy
   validates :title, :description, :presence => true
end

class Image < ActiveRecord::Base
   attr_accessible :title, :description, :picture, :image_id, :album_id, :albumcover
   belongs_to :album
   accepts_nested_attributes_for :album
   mount_uploader :picture, PictureUploader 
end 
```

**图像控制器**

```
class Admin::ImagesController < ApplicationController
    respond_to :html, :json
    def index
        @album = Album.find(params[:album_id])
        @images = @album.images.all
    end
    def new
        @album = Album.find(params[:album_id])
        @image = @album.images.new(params[:id])
    end
    def create
        @album = Album.find(params[:album_id])
        @image = @album.images.new(params[:image]) 
        if @image.save
            flash[:notice] = "Successfully added image!"
            redirect_to [:admin, @album, :images]
        else
            render :action => 'new'
        end
    end
    def show
        @album = Album.find(params[:album_id])
        @image = @album.images.find(params[:id])
    end
    def edit
        @album = Album.find(params[:album_id])
        @image = @album.images.find(params[:id])
    end
    def update
        @album = Album.find(params[:album_id])
        @image = @album.images.find(params[:id])
        if @image.update_attributes(params[:image])
            flash[:notice] = "Successfully updated Image"
            redirect_to [:admin, @album, :images]
        else
            render :action => "edit"
        end
    end
    def destroy
        @album = Album.find(params[:album_id])
        @image = @album.images.find(params[:id])
        @image.destroy
        @albumid = @album.id
        @id = @image.id
        FileUtils.remove_dir("#{Rails.root}/public/uploads/image/picture/#{@albumid}/#{@id}", :force => true)
        redirect_to admin_album_images_path(@album)
    end

end 
```

如何使每张专辑中的编号从 1 开始？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:12:35.293

“我希望图像的 id 从 1 开始”

image_id 字段是可能自动递增的数据库标识符字段。它基于图像表中的行数，与图像和相册之间的关联无关。让逻辑依赖于它可能不是一个好主意。

我很好奇你为什么想要图像的序列号。例如，如果您想在相册中订购图片，一种选择是：

```
album.images.sort_by(&:created_at) 
```

另一种选择是在您的图像表中添加一个名为 serial_number 的额外列并自行管理。

如果您可以通过序列号分享您想要实现的目标，您将获得更好的答案！

# c# - VS 2010 构建输出路径覆盖 Assembly.GetExecutingAssembly 案例？

> ID：15603226
> 
> 赞同：1
> 
> 时间：2013-03-24T19:54:15.677
> 
> 标签：c#, visual-studio

在调试一些依赖于知道当前执行程序集路径的行为时，我注意到如果我在 C# VS 2010 项目中执行以下行而不对构建输出路径进行任何调整，则 Assembly.GetExecutingAssembly 将返回大小写正确的路径.

例如，

```
string location = Assembly.GetExecutingAssembly().Location; 
```

显示“C:\src\MyProject\MyProject\bin\Debug\MyProject.exe”

现在，如果我创建一个单独的目录来将程序集输出到，例如：C:\src\MyCamelCaseDir\，并将 Build -> Output path 更新为 C:\src\mycamelcasedir，上面的代码会生成字符串“C: \src\mycamcelcasedir\MyProject.exe”。

区别在于，显然

```
"..\\MyCamelCaseDir".equals("..\\mycamelcasedir") 
```

是错误的，即使操作系统不将路径视为区分大小写。

我认为在 Visual Studio 中以调试模式运行是导致此问题的原因......但我仍然有点困惑 - GetExecutingAssembly 不应该返回操作系统认为包含程序集、案例和所有内容的目录路径吗？

**编辑**：我认为我的问题表述得不好。我的问题的正确答案是发帖人指出 VS 只是将 Build Ouput Path 中的文本框加上项目名称连接起来。

我想问的问题是：为什么 Assembly.GetExecutingAssembly().Location 不以操作系统存储路径的方式返回区分大小写的路径？

我知道 Windows 不区分大小写，因为您可以在资源管理器窗口中键入 C:\foo\bar，这会将您带到 C:\Foo\Bar（如果有这样的目录）。

但我会认为执行程序集的位置在所有情况下都是相同的，无论是否调试。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:17:59.423

虽然文档在这一点上没有透露，但 GetExecutingAssembly().Location 的路径似乎是操作系统在加载程序集时使用的路径（对于可执行文件，这似乎是传递给 Process.Start() 或其等价物的路径，操作系统按原样使用，而不将其大小写等标准化为文件系统中记录的版本。），除了文件名部分，它取自程序集的实际名称。

您可以通过编译一个测试命令行应用程序并从命令提示符运行它来轻松地看到这一点：

```
using System;
using System.Reflection;

namespace TestLocation
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("{0}", Assembly.GetExecutingAssembly().Location);
        }
    }
} 
```

产生：

> C:\Users\avatar>C:\Working\TestLocation\bin\Debug\TestLocation.exe C:\Working\TestLocation\bin\Debug\TestLocation.exe
> 
> C:\Users\avatar>c:\working\testlocation\bin\debug\testlocation.exe c:\working\testlocation\bin\debug\TestLocation.exe

如果您输入一个短名称，即“testlocation”，您将获得大小写正确的版本，但在上面的第二种情况下，它已经有一个规范的文件名，所以只需按原样传递它 - 因此名称不是装箱。

简而言之：即使 NTFS 文件系统确实在内部提供了它，也不建议在 Windows 下依赖于文件规范中的大小写保留，除非您自己手动从文件系统中查找所有内容的大小写。您将从大多数 API 中获得的只是可用于访问文件的文件规范，而不一定是文件系统中记录的文件规范。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:02:32.063

字符串比较不知道字符串的底层值是什么。正如您所指出的，Windows 中的默认路径不区分大小写，因此在比较时必须以这种方式对待它们。

即在你的情况下你应该使用

```
String.Equals("..\\MyCamelCaseDir", "..\\mycamelcasedir", 
    String.Comparison.OrdinalIgnoreCase) 
```

比较文件路径字符串。（或者您可以先规范化路径 -[在 C# 中规范化目录名称](https://stackoverflow.com/questions/1214513/normalize-directory-names-in-c-sharp)）。

旁注：不同大小写的最可能原因来自您的完整可执行文件名称是由 VS 构造的，其中“输出路径”和“项目名称”的字符串连接。

# function - 将函数作为参数传递给 .vimrc 中的另一个函数

> ID：15603229
> 
> 赞同：1
> 
> 时间：2013-03-24T19:54:19.220
> 
> 标签：function, vim, arguments

我的 .vimrc 中有两个函数：

```
function! DoStuff()
    ...
endfunction

function! DoStuffWrapper(func)
    ...
    func
    ...
endfunction

nnoremap <Leader> ... 
```

基本上这行得通。但我不确定这是否是正确的做法。是否有更好的替代方法可以在另一个函数中传递一个函数？

我看到了类似的方法

```
function! AFunction()
    ...
    :call call (function('FunctionName'), params)
    ...
endfunction 
```

但这似乎只在使用函数名称而不是参数时才有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:55:18.810

您可以这样做，`call DoStuffWrapper(DoStuff())`但是它不会**将**函数传递`DoStuff()`给包装器，而是将`DoStuff()`. 想一想：`echo len(getline('.'))`和你一样的情况。

我希望这个例子可以为你解释一点：

```
fun! Sq(val)
    return a:val*a:val
endf

fun! SqRoot(val)
    return sqrt(a:val)
endf

fun! CalcFunc(val, func)
    echo a:func(a:val)
endf 
```

所以你想将一个函数传递给`CalcFunc`，以便它可以进行动态计算。

现在如果你这样做：

```
call CalcFunc(2, function('SqRoot')) 
```

它会回响`1.414214`

如果你这样做：

```
call CalcFunc(2, function('Sq')) 
```

它会回声`4`。

# java - Arraylist 中的案例抱怨“孤立案例”

> ID：15603230
> 
> 赞同：-6
> 
> 时间：2013-03-24T19:54:30.787
> 
> 标签：java, list, case

我的问题是，我使用 a 创建了一个数组列表，`case`因此值是有条件的，但是编译器抱怨我有一个“孤立的情况”。为什么？

```
ArrayList<Integer> object = new ArrayList<Integer>();{
        case objid == 1:{
        object.add(objnum);
        object.add(objx);
        object.add(objy);} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-24T19:58:56.127

`case`没有声明就不能有`switch`声明。

类似如下的`switch`声明：

```
switch (var) {
case 0:
  doSomething();
  break;
case 1:
  somethingElse();
  break;
default:
  anotherThing();
  break;
} 
```

（大致）相当于

```
if (var == 0) {
  doSomething();
} else if (var == 1) {
  somethingElse();
} else {
  anotherThing();
} 
```

所以，就像说没有意义一样

```
if (0) {
  doSomething();
} // ... 
```

`case`没有任何东西可以比较的声明也是没有意义*的*。从这个意义上说，该`case`语句没有父`switch`语句，因此 Java 说它是**孤立**的。

您可以将代码更改为：

```
if (objid == 1) {
    object.add(obnum);
    object.add(objx);
    object.add(objy);
} 
```

有关该`switch`声明的更多信息，请尝试[此文档](https://www.google.com/search?q=java+switch&aq=f&oq=java+switch&aqs=chrome.0.57j60j65j60l3.1194&sourceid=chrome&ie=UTF-8)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:00:39.600

```
case objid == 1:{
    object.add(objnum);
    object.add(objx);
    object.add(objy);
} 
```

这永远不是有效的Java。你的意思是`if`，像这样吗？

```
if (objid == 1) {
    object.add(objnum);
    object.add(objx);
    object.add(objy);
} 
```

要回答您的第二个问题，`ArrayList`通常只应在您不再直接访问其成员时使用，因此需要类似`x = object.get(3)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T20:11:45.883

```
ArrayList<Integer> object = new ArrayList<Integer>();
switch (objid) {
  case 1:
  {
     object.add(objnum);
     object.add(objx);
     object.add(objy);}
  } 
```

# php - PHP 更改帖子链接

> ID：15603231
> 
> 赞同：0
> 
> 时间：2013-03-24T19:54:33.050
> 
> 标签：php, post, title

我有一个网站，人们可以在其中发布视频和图片。所有帖子的链接格式如下：domain.com/p/7，我想知道如何使用帖子标题而不是多个帖子。例如：domain.com /p/后标题。我认为需要从 .htacces 更改该行，但我不知道到底要更改什么： RewriteRule ^p/(.*) view.php?pid=$1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:01:39.387

你将需要改变更多。首先，您想从 ID 移动到 post-title（我认为是 url 安全别名）。所以 mod_rewrite 将类似于

```
RewriteRule ^p/(.*) view.php?title=$1 
```

但现在您必须更改 view.php。如果您现在按 ID 选择帖子，则将其更改为按帖子标题/别名选择。也许这也需要在其他地方进行更改。也许更容易将 domain.com/p/7 更改为 domain.com/p/7/post-title 然后将重写更改为：

```
RewriteRule ^p/[0-9]+/(.*) view.php?pid=$1 
```

这样你就不必改变 view.php

# wpf - 如何使用令牌在 MVVM 灯中发送简单的字符串消息

> ID：15603232
> 
> 赞同：2
> 
> 时间：2013-03-24T19:54:35.987
> 
> 标签：wpf, mvvm, mvvm-light

在我的 WPF 应用程序中，我有许多字符串消息的订阅者和许多字符串消息发送。我知道我可以使用令牌来区分消息以选择特定的收件人。请直接指向执行此操作的示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:52:07.110

好吧，如果您有两个类`ClassA`，并且`ClassB`都注册了字符串类型的消息，并且类似于以下内容

```
Messenger.Default.Register<string>(this, OnStringMessageReceived); 
```

那么您只能`ClassA`通过在发送模板调用中声明类类型来发送消息，例如

```
Messenger.Default.Send<string, ClassA>("Message to Only ClassA"); 
```

MVVM Light 作者的博客有一些您可能想阅读的相关文档

[http://blog.galasoft.ch/archive/2009/09/27/mvvm-light-toolkit-messenger-v2-beta.aspx](http://blog.galasoft.ch/archive/2009/09/27/mvvm-light-toolkit-messenger-v2-beta.aspx)

从上面的链接中提取（我们用于您的要求的功能）：

```
/// <summary>
/// Sends a message to registered recipients. The message will
/// reach only recipients that registered for this message type
/// using one of the Register methods, and that are
/// of the targetType.
/// </summary>
/// <typeparam name="TMessage">The type of message that will be sent.</typeparam>
/// <typeparam name="TTarget">The type of recipients that will receive
/// the message. The message won't be sent to recipients of another type.</typeparam>
/// <param name="message">The message to send to registered recipients.</param>
void Send<TMessage, TTarget>(TMessage message); 
```

# sql - SELECT TOP 和 SELECT WHERE 速度

> ID：15603235
> 
> 赞同：0
> 
> 时间：2013-03-24T19:54:53.443
> 
> 标签：sql, sql-server

这将是一个简单的问题：）

哪个更快（也许快多少）

```
SELECT * FROM Table WHERE Id<100000000 
```

或者

```
SELECT TOP 100000000 * FROM Table ORDER BY Id 
```

我假设 Id 从 1 开始并增加 1，因此查询应该给出相同的结果。在我的示例中，我选择了 1 亿条记录，但我的真正意思是“一些非常大量的记录，其中速度差异可能很明显”。

如果这很重要，我正在使用 Microsoft SQL Server。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:04:42.597

一般来说，第一个会更快。第一个查询将扫描表一次，进行比较，并在找到行时返回行。

第二个查询需要先对`id`列进行排序，然后才能开始返回行。排序比仅仅读取表格更昂贵，因此需要更长的时间。

如果`id`上面有索引，那么推理就会改变。第一个版本可能使用也可能不使用索引。如果是，它将扫描索引，然后逐条记录获取表中的数据。

第二个查询几乎肯定会使用具有前一段所述性能的索引。使用索引，两者可能是等价的。

使用索引是否比表扫描快取决于您未提及的因素——表有多大以及您有多少内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:08:50.950

这是选择*100 000*行的估计查询计划：

![前Q](../Images/7ca4fb922f89b1966ae268ac61d02ad6.png)

第一个计划 (49%) 使用 ID，第二个计划 (51%) 使用`top`子句。表结构并不完全相同，但你明白了。

# mysql - 如何使用另一个更新 phpmyadmin 中的表

> ID：15603236
> 
> 赞同：0
> 
> 时间：2013-03-24T19:54:54.530
> 
> 标签：mysql, phpmyadmin

嗨，我的数据库遇到了真正的问题，我有两个表

```
GameID and GameGenre 
```

**GameID**具有以下字段

```
Name, age rating, genreid, gid, platformid 
```

**游戏类型**有

```
gid and genreid 
```

所以这是我们拥有的游戏 ID 字段中的一个示例

```
Name        Age Rating   genreid    Platform ID   Gid
Dead Space    16         Horror     PS3,xbox360     1 
```

在我们拥有的游戏类型领域

Gid 1 类型 ID 恐怖

如果我在游戏类型表中将流派 ID 字段更改为恐怖和冒险，我如何使用该信息更新 GameID 字段？

我已经厌倦了在字段中使用关系和伪造键，`genreid`但它会改变
每个字段与我想只更改与特定关联的一个字段相关的类型`gid`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T01:57:51.150

您可能想使用触发器（[http://dev.mysql.com/doc/refman/5.0/en/triggers.html](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)）。

我会提供一个例子，但真的无法理解你的数据库设计。在这种情况下最好提供 create 语句。

# python - Flask：如何管理不同环境的数据库？

> ID：15603240
> 
> 赞同：11
> 
> 时间：2013-03-24T19:55:04.983
> 
> 标签：python, flask, flask-sqlalchemy

我正在开发一个看起来类似于的应用程序

```
facebook/
         __init__.py
         feed/
             __init__.py
             business.py
             views.py
             models/
                    persistence.py
                    user.py
         chat/
             __init__.py
             models.py
             business.py
             views.py
         config/
                dev.py
                test.py
                prod.py 
```

我想要三个环境`Dev`，`Test`和`Production`。
我有以下要求：
a.) 启动服务器`python runserver.py`时，我想提一下我要连接哪个环境 - `Dev`,`Test`或`Production`.
b.) `Dev`&`Production`应该构建架构，只需要连接到机器
c.) 我还希望我的测试连接到`sqlite db`，并创建架构，运行测试

如何以配置方式实现这一点，这样我就不必对与数据库相关的任何内容进行硬编码。

烧瓶中有什么好的图案吗？

目前我`runerver.py`对我不喜欢的环境进行了硬编码，

```
app = Flask(__name__)
app.config['SECRET_KEY'] = dev.SECRET_KEY 
```

我正在寻找比我更好的想法

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-26T22:28:45.160

我使用的解决方案：

```
#__init__.py
app = Flask(__name__)
app.config.from_object('settings')
app.config.from_envvar('MYCOOLAPP_CONFIG',silent=True) 
```

在加载应用程序的同一级别上：

```
#settings.py
SERVER_NAME="dev.app.com"
DEBUG=True
SECRET_KEY='xxxxxxxxxx'

#settings_production.py
SERVER_NAME="app.com"
DEBUG=False 
```

所以。如果环境变量 MYCOOLAPP_CONFIG 不存在 -> 只有 settings.py 会加载，它指的是默认设置（对我来说是开发服务器）
这就是“silent=True”的原因，不需要第二个配置文件，而 settings.py 默认用于开发并具有常用配置键的默认值

如果除了第一个值之外还将加载任何其他设置文件，它会覆盖原始值中的值。（在我的示例中 DEBUG 和 SERVER_NAME 将被覆盖，而 SECRET_KEY 对于所有服务器保持相同）

您应该自己发现的唯一事情取决于您启动应用程序的方式
在启动 ENVVAR 之前应该设置 MYCOOLAPP_CONFIG
例如，我使用主管守护进程运行，而在生产服务器上，我只是将其放入主管配置文件中：

```
environment=MYCOOLAPP_CONFIG="/home/tigra/mycoolapp/settings_production.py" 
```

通过这种方式，您可以轻松管理所有配置文件，此外，通过这种方式，您可以从 git 或任何其他版本控制实用程序中排除这些文件

默认的 Linux 方式是启动前在控制台中的这种方式：
`export MYCOOLAPP_CONFIG="/home/tigra/mycoolapp/settings_production.py"`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-06T17:59:54.080

我认为这就是您要寻找的东西：

[http://flask.pocoo.org/docs/config/#configuring-from-files](http://flask.pocoo.org/docs/config/#configuring-from-files)

但还要检查烧瓶空项目，它是具有特定环境配置的烧瓶应用程序的样板。

[https://github.com/italomaia/flask-empty](https://github.com/italomaia/flask-empty)

您可以像这样在 config.py 中指定配置：

```
class Dev(Config):
    DEBUG = True
    MAIL_DEBUG = True
    SQLALCHEMY_ECHO = True
    SQLALCHEMY_DATABASE_URI = "sqlite:////tmp/%s_dev.sqlite" % project_name 
```

这继承了可以包含您的默认值的 Config 类。从那里，main.py 具有从 config.py 文件创建烧瓶实例的方法，manage.py 确定加载哪个配置。

这是 main.py 的一个片段，所以你明白了：

```
def app_factory(config, app_name=None, blueprints=None):
    app_name = app_name or __name__
    app = Flask(app_name)

    config = config_str_to_obj(config)
    configure_app(app, config)
    configure_blueprints(app, blueprints or config.BLUEPRINTS)
    configure_error_handlers(app)
    configure_database(app)
    configure_views(app)

    return app 
```

然后 manage.py 根据传递的命令行参数处理环境设置，但是您可以了解它是如何工作的（注意这需要烧瓶脚本）：

```
from flask.ext import script

import commands

if __name__ == "__main__":
    from main import app_factory
    import config

    manager = script.Manager(app_factory)
    manager.add_option("-c", "--config", dest="config", required=False, default=config.Dev)
    manager.add_command("test", commands.Test())
    manager.run() 
```

从这里您可以从环境变量或您选择的其他方法中选择所需的 Config 类。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-24T20:05:35.500

您可以创建一个“配置”模块，其中包含每个环境的配置。此后，可以通过设置 shell 变量来指定当前运行的环境。

如果你在主**初始化**文件中初始化你的烧瓶应用程序，也可以在那里设置配置。这就是我设置配置的方式：

```
def setup_config(app):
    """Set the appropriate config based on the environment settings"""
    settings_map = {'development': DevelopmentSettings,
                    'staging': StagingSettings,
                    'testing': TestingSettings,
                    'production': ProductionSettings}
    env = environ['ENV'].lower()
    settings = settings_map[env]
    app.config.from_object(settings) 
```

在运行开发服务器甚至测试之前设置环境变量可能很麻烦，因此我使用 makefile 自动执行这些操作。

另请查看烧瓶脚本[http://flask-script.readthedocs.org/en/latest/](http://flask-script.readthedocs.org/en/latest/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-05T14:40:24.200

Flask 有一个叫做[Instance](http://flask.pocoo.org/docs/config/#instance-folders) folder 的东西，它可以有不同的可能配置并相应地加载它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-10T12:33:09.950

您可以在 setting.json 中拥有如下属性：

```
{
  "production": {
    "DEBUG": false,
    "APPLICATION_ROOT": "/app-root",
    "DB_URI": "mongodb://20.0.0.2:27017/TEST_DB",
    "FTP_HOST": "20.0.0.10"

  },
  "development": {
    "DEBUG": true,
    "APPLICATION_ROOT": "/app-root",
    "DB_URI": "mongodb://localhost:27017/TEST_DB",
    "FTP_HOST": "20.0.0.11"
  },
  "test":{
    "DEBUG": false,
    "APPLICATION_ROOT": "/app-root",
    "DB_URI": "mongodb://localhost:27017/TEST_DB",
    "FTP_HOST": "20.0.0.11"
  },
  "local": {
    "DEBUG": true,
    "APPLICATION_ROOT": "/app-root",
    "DB_URI": "mongodb://localhost:27017/TEST_DB",
    "FTP_HOST": "20.0.0.11"
  },
  "staging": {
    "DEBUG": false,
    "APPLICATION_ROOT": "/app-root",
    "DB_URI": "mongodb://localhost:27017/TEST_DB",
    "FTP_HOST": "20.0.0.19"
  }
} 
```

在代码中：

```
def load_setting():
    with open('setting.json', 'r') as file:
        return json.load(file)[os.getenv('FLASK_ENV')]

app = Flask('TEST-APP')
app.config.update(load_setting()) 
```

确保您已将环境“FLASK_ENV”添加为开发/本地/测试/生产。

```
export FLASK_ENV="local" 
```

# asp.net - 连接字符串问题

> ID：15603243
> 
> 赞同：0
> 
> 时间：2013-03-24T19:55:23.100
> 
> 标签：asp.net, connection-string

我刚刚用 123.reg 购买了虚拟主机，并上传了我的 asp.net 网站和数据库。

我的 web.config 文件当前具有以下作为连接字符串：

```
 <connectionStrings>
    <add name="RaiseConnectionString" connectionString="Data Source=MATT-PC\SQLEXPRESS;Initial Catalog=Raise;Integrated Security=True" providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

但是，123.reg 帐户会出现此问题，因为它要求连接字符串格式为：

```
 <appSettings>
<add key="ConnectionString" value="Server=ATLAS-SQL-07; Database=Raise; User Id=Raise; Password=******" /> 
</appSettings> 
```

通过更改此设置，我的应用程序出现错误，因为它找不到连接字符串 Raise。我该如何纠正这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:05:51.913

这应该在您的 web.config 文件中起作用：

```
<connectionStrings>
    <add name="RaiseConnectionString" connectionString="Data Source=Server=ATLAS-SQL-07;Initial Catalog=Raise;User Id=Raise; Password=******;" providerName="System.Data.SqlClient"/> 
</connectionStrings> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:01:31.933

您不需要将密钥更改为`ConnectionString`- 您的原始密钥`RaiseConnectionString`可能没问题。托管帐户只是告诉您连接字符串的值应该是什么。

# django - Django - ModelChoiceField 查询集如何工作？

> ID：15603249
> 
> 赞同：11
> 
> 时间：2013-03-24T19:55:47.580
> 
> 标签：django, forms, validation, dynamic-forms

我有一个带有 ModelChoiceField 的表单，我想从我的数据库中加载一个表。如果我在表单的初始化中使用这个查询集，那么我的视图 form.is_valid 可以正常工作：

```
self.fields['categoria_formfield'].queryset = sitio_categoria.objects.exclude(categoria='patrimonio').values_list('idCategoria',flat=True) 
```

![在此处输入图像描述](../Images/7aedb5a0cb25acc3a825092386fc00af.png)

该代码在 ModelChoiceField 上显示一个 id 列表，但我需要它来显示类别列表。所以我使用：

```
self.fields['categoria_formfield'].queryset = sitio_categoria.objects.exclude(categoria='patrimonio').values_list('categoria',flat=True) 
```

但是使用此代码 .is_valid 不验证，我收到一个表单错误：“选择一个有效的选择。该选择不是可用的选择之一。” 关于可能是什么问题的一些线索？

![收到错误](../Images/e76c9048f4f6fdc4c7bd52ba2c474b05.png)

模型

```
class sitio_categoria(models.Model):
    idCategoria         =   models.AutoField(primary_key=True)
    categoria           =   models.CharField(max_length=30, null=False, unique=True) 
```

形式

```
class anadirComercioPaso1_form(forms.Form):
        categoria_formfield = forms.ModelChoiceField(widget=forms.Select(attrs={'size':'13', 'onchange':'this.form.action=this.form.submit()'}), queryset=sitio_categoria.objects.none())

def __init__(self, *args, **kwargs):
        super(anadirComercioPaso1_form, self).__init__(*args,**kwargs)
        self.fields['categoria_formfield'].queryset = sitio_categoria.objects.exclude(categoria='patrimonio').values_list('categoria',flat=True) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-24T20:07:46.187

不要使用`values_list`，（或`values`），`ModelChoiceField`需要实际的模型对象。

```
queryset = sitio_categoria.objects.exclude(categoria='patrimonio') 
```

`ModelChoiceField`将使用对象的主键进行验证，并使用它们的 unicode 表示进行显示。因此，您需要在模型中定义转换为 unicode：

```
class sitio_categoria(models.Model):
    idCategoria = models.AutoField(primary_key=True)
    categoria = models.CharField(max_length=30, null=False, unique=True)

    def __unicode__(self):
        return self.categoria 
```

[ModelChoiceField 文档](https://docs.djangoproject.com/en/dev/ref/forms/fields/#modelchoicefield)

> `__unicode__`将调用模型的方法来生成对象的字符串表示形式，以用于字段的选择；

# ruby-on-rails - 带有模型名称的 response_with 路由错误

> ID：15603250
> 
> 赞同：0
> 
> 时间：2013-03-24T19:55:48.933
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes, nested-routes

对于这种特殊情况，我有一个烦人的问题：

```
#Controller> api/albums_controller.rb
class Api::AlbumsController < ApplicationController
  respond_to :json

  def create
    respond_with Album.create(params[:album])
  end
end 
```

如您所见，此控制器位于文件夹名称“api”下。此控制器连接到“artists_controller”控制器：

```
#routes.rb
namespace :api do
  resources :artists do
    resources :albums
  end
end 
```

所以我使用 jQuery 调用该函数：

```
$.ajax({
    url: '/api/artists/1/albums',
    method: 'POST',
    dataType: 'json',
    data: 'album[year]=2000&album[genre_id]=1&album[name]=FDFSD&album[artist_id]=1'
}); 
```

但是当保存操作成功时出现此错误：

```
NoMethodError in Api::AlbumsController#create
undefined method `album_url' for #<Api::AlbumsController:0xc0ebdb4> 
```

仅在保存相册的情况下，如果有任何错误，ajax 调用会返回此内容，例如：

```
$.ajax({
    url: '/api/artists/1/albums',
    method: 'POST',
    dataType: 'json',
    data: 'album[year]=2000&album[genre_id]=1'
});
//Results
{"errors":{"name":["can't be blank"],"artist":["can't be blank"]}} 
```

哪个是正确的，但我怎样才能避免“album_url”错误？

我假设可能会发生此错误，因为我们将此控制器用作 route.rb 文件中的资源，因此正确的路径应该类似于“api_artists_album_url”，但我怎样才能将其更改为正确的变量？

我正在使用 gem 'rails'、'3.2.12'

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:04:55.850

您应该在调用中指定命名空间`respond_to`以使其工作：

```
class Api::AlbumsController < ApplicationController
  respond_to :json

  def create
    respond_with :api, Album.create(params[:album])
  end
end 
```

# java - 尝试制作一个添加变量的简单应用程序，遇到一些问题

> ID：15603255
> 
> 赞同：0
> 
> 时间：2013-03-24T19:56:08.560
> 
> 标签：java, android, eclipse, timepicker, addition

我有一个 24 小时格式的 timePicker，我想获取结果，将它们放入变量中，另外使用变量，然后在 textView 中显示它们。Eclipse 没有给我和语法错误，但是当我运行应用程序时，它在我启动“DisplayMessageActivity.java”时崩溃。

这是代码：

```
package com.example.sleepytime;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;
import android.widget.TimePicker;

@SuppressLint("NewApi")
public class DisplayMessageActivity extends Activity {

 TimePicker timepicker;
 public int hour1 = timepicker.getCurrentHour();
 public int min1 = timepicker.getCurrentMinute();

@SuppressLint("NewApi")
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_display_message);
    // Show the Up button in the action bar. 
    getActionBar().setDisplayHomeAsUpEnabled(true);

    timepicker = (TimePicker) findViewById(R.id.timePicker1);
    timepicker.setIs24HourView(true);

    Button mButton = (Button) findViewById(R.id.button1);
    mButton.setOnClickListener(new View.OnClickListener() { 
        public void onClick(View printIt) {
        final TextView mTextView = (TextView) findViewById(R.id.print);
        mTextView.setText(hour1 + min1);
}   

}); 
```

}

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:29:45.487

这里

```
public int hour1 = timepicker.getCurrentHour();
public int min1 = timepicker.getCurrentMinute(); 
```

`timepicker`是`null`。你需要把它`onCreate()`像这里

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_display_message);
    // Show the Up button in the action bar. 
    getActionBar().setDisplayHomeAsUpEnabled(true);

timepicker = (TimePicker) findViewById(R.id.timePicker1);
timepicker.setIs24HourView(true);
hour1 = timepicker.getCurrentHour();
min1 = timepicker.getCurrentMinute(); 
```

和改变

```
public int hour1 = timepicker.getCurrentHour();
public int min1 = timepicker.getCurrentMinute(); 
```

至

```
public int hour1;
public int min1; 
```

这是我看到的第一个问题。可能还有更多，但这将使您无法继续前进。

```
 mButton.setOnClickListener(new View.OnClickListener() { 
    public void onClick(View printIt) {
    final TextView mTextView = (TextView) findViewById(R.id.print);
    String hourString = String.valueOf(hour);
    String minString = String.valueOf(minute);
    mTextView.setText(hourString + minString); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:34:02.480

```
TimePicker timepicker;
 public int hour1 = timepicker.getCurrentHour();
 public int min1 = timepicker.getCurrentMinute(); 
```

你不能这样做，它会给你空指针异常，这样做

```
timepicker = (TimePicker) findViewById(R.id.timePicker1);
timepicker.setIs24HourView(true);
hour1 = timepicker.getCurrentHour();
min1 = timepicker.getCurrentMinute(); 
```

另外，在低于 3.0 的 api 上运行时，您当前的代码会中断。请检查 getActionBar().setDisplayHomeAsUpEnabled(true);

或者如果您不想支持蜂窝之前的版本，请将最低 sdk 更改为 3.0

# javascript - 使用 offsetTop 不一致的 Canvas 事件侦听器

> ID：15603258
> 
> 赞同：0
> 
> 时间：2013-03-24T19:56:26.417
> 
> 标签：javascript, html5-canvas, offset, addeventlistener

我有一个用于测试的 HTML5 网络游戏的事件侦听器，但我很难让事件侦听器获得预期的实际坐标。

使用javascript控制台，我发现它得到的坐标经常是错误的。

**编辑：**我想我知道为什么会出现问题，但不知道如何解决。我正在使用带有长 y 轴的画布，并且必须向下滚动才能回答一些问题。当我滚动时，坐标开始出错。有没有办法解决这个问题？

这是我的事件监听器。请帮我解决这个问题。

```
canvas.addEventListener('click',ProcessClick,false);
function ProcessClick(ev) {
    my=ev.y-canvas.offsetTop;
    if(ev.y == undefined){
        my = ev.pageY - canvas.offsetTop; 
        } 
```

我如何使用坐标的示例-

```
if(eventstate == 'texta6get'){
            console.log(my);
            if(my>300 && my<390){GetAnswer(1);console.log("Answer1 clicked:");}
            if(my>400 && my<490){GetAnswer(2);console.log("Answer2 clicked:");}
            if(my>500 && my<590){GetAnswer(3);console.log("Answer3 clicked:");}
            if(my>600 && my<690){GetAnswer(4);console.log("Answer4 clicked:");}
            if(my>700 && my<790){GetAnswer(5);console.log("Answer5 clicked:");}
            if(my>800 && my<890){GetAnswer(6);console.log("Answer6 clicked:");}
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T22:28:15.893

如果你可以使用 jQuery，下面的代码给出了一致的结果。

```
// set up a handler for mousedown events
$("#canvas").mousedown(function(e){handleMouseDown(e);});

// get the position of the canvas on the page since it doesn't change
var canvasOffset=$("#canvas").offset();
var offsetX=canvasOffset.left;
var offsetY=canvasOffset.top;

// handle mousedown events
function handleMouseDown(e){
    mx=parseInt(e.clientX-offsetX);
    my=parseInt(e.clientY-offsetY);

    // Put your mousedown stuff here
    if(my>300 && my<390){GetAnswer(1);console.log("Answer1 clicked:");}
    if(my>400 && my<490){GetAnswer(2);console.log("Answer2 clicked:");}
    if(my>500 && my<590){GetAnswer(3);console.log("Answer3 clicked:");}
    if(my>600 && my<690){GetAnswer(4);console.log("Answer4 clicked:");}
    if(my>700 && my<790){GetAnswer(5);console.log("Answer5 clicked:");}
    if(my>800 && my<890){GetAnswer(6);console.log("Answer6 clicked:");}
} 
```

# mysql - 无法删除索引或重命名表 PHPmyadmin

> ID：15603261
> 
> 赞同：2
> 
> 时间：2013-03-24T19:56:43.697
> 
> 标签：mysql, database, indexing, phpmyadmin, primary-key

我正在尝试使用 phpmyadmin 为作业创建一个基本的大学数据库大纲。在我的一张表中，我将主键命名为“学生 ID”。现在在进行查询时出现错误，当我插入列名学生 ID 时显示“未知列学生”，因为列名中有空格。但是 phpmyadmin 不会让我重命名该列甚至删除它。尝试重命名或删除它时会出现此错误 - “#1025 error of rename of ... to ... errno: 150.” 我已将它作为主键删除，并假设它不会让我更改列，因为我错误地放置了索引。现在它不会让我使用 DROP INDEX 删除索引。

```
ALTER TABLE grade_student_module DROP INDEX Student ID_3 
```

这给了我在 ID_3 附近的 mysql synthax 中的 1064 错误

当我进入显示来自grade_student_module 的索引时，学生ID_3 被列为键列下的索引。

本质上，我试图找到一种方法从表中删除所有索引和约束以及键以删除单个空格，以便我可以对表执行简单查询。除了不工作的 DROP INDEX 之外，还有什么方法可以做到这一点？我不允许删除索引的原因是因为索引名称本身有空格吗？

非常感谢帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-24T19:59:59.803

通常，您不应在表、列或约束名称中包含空格。但是当你这样做时，你必须在任何被反引号包围的语句中引用它们。

```
ALTER TABLE grade_student_module DROP INDEX `Student ID_3` 
```

# java - 在使用流布局的两个面板上对齐组件

> ID：15603263
> 
> 赞同：0
> 
> 时间：2013-03-24T19:56:48.757
> 
> 标签：java, swing, jpanel, layout-manager, flowlayout

我有两个使用流布局的面板。这些面板具有相同数量的组件（标签和文本框）。我如何对齐它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:04:26.603

布局管理器不会以这种方式相互通信。除非组件大小相同，否则不能使用两个单独的 FlowLayout。

您也许可以使用 SpringLayout。或者更复杂的布局是 GridBagLayout 和 GroupLayout。

查看有关[使用布局管理](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)器的 Swing 教程以获取工作示例，以确定您想使用哪个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T19:59:21.407

当我硬编码一些东西时，我不能让它工作，比如尺寸。

我建议至少改用 GridBagLayout。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T20:02:18.577

如果您需要对齐组件等，GridBagLayout 是您想要使用的布局。阅读[如何使用 GridBagLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html)。

# opencv - OpenCV - 在窗口中拖动图像块

> ID：15603264
> 
> 赞同：1
> 
> 时间：2013-03-24T19:56:48.767
> 
> 标签：opencv

我正在尝试在 OpenCV 中制作拼图游戏。我正在做的是将图像转换为小方块，它们是相同尺寸的图像。例如，如果我有一个 A x B 大小的图像，那么我将其重新调整为 640 x 640 并将这个重新调整大小的图像划分为每个大小为 64 x 64 的正方形。我将这些方形图像保存在本地磁盘上。

现在我想知道是否可以将这些方形图像随机放置在一个窗口中并拖动这些图像以匹配最终的获胜状态？我找不到实现拖放的方法。如果我能得到一些提示，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:08:30.537

我懒得写你的程序，但这里有一些你可能喜欢的部分：

鼠标：

```
void onmouse(int event, int x, int y, int mousestate, void *userptr)
{
    if (event==1) // lmousebuttondown, do something with x, y
}

namedWindow("win");
setMouseCallback( "win", onmouse ); 
```

并且，将小图像（您拖动的东西）绘制到大图像中：

```
Rect r(x,y,small.cols, small.rows);
big(r) = small; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:46:27.053

**OpenCV 不能在同一个窗口**（本机）上显示多个图像。但是，您可以编写代码将[所有这些小图像组合成一个大图像](https://stackoverflow.com/q/14638038/176769)，然后将其显示在窗口上。

这种方法的缺点是您必须存储一个数组，其中包含这些图像放置位置的信息（从地理上讲），因此当用户单击屏幕中间时，您可以准确地知道哪个图像位于该位置。*但是你也会在编写拖放*动画时遇到一些头疼的问题，因为 OpenCV 提供的东西无法做到这一点。

有一些演示展示了如何处理 OpenCV 上的鼠标点击：

*   [根据鼠标点击显示像素坐标值](https://stackoverflow.com/a/14918425/176769)
*   [鼠标回调函数 OpenCV](https://stackoverflow.com/a/14633072/176769)
*   [使用 OpenCV 在网络摄像头上绘图](https://stackoverflow.com/a/5493633/176769)
*   [使用鼠标从视频上的矩形设置 ROI](https://stackoverflow.com/a/10883266/176769)
*   [自由形式的图像选择](https://stackoverflow.com/a/8196180/176769)

归根结底，**OpenCV 不是为这些类型的用户交互而构建的**。我建议您研究**Qt**或其他一些技术来构建您的游戏。

我记得看到一个 Qt 演示，它实现了你正在寻找的东西：

*   [可拖动图标示例](http://apidocs.meego.com/1.2/qt4/draganddrop-draggableicons.html)

# asp.net-mvc - 使用 MVC 中的 SAML 和 Okta 进行身份验证

> ID：15603265
> 
> 赞同：4
> 
> 时间：2013-03-24T19:56:49.310
> 
> 标签：asp.net-mvc

我需要用针对 Okta 的 SAML 替换 Intranet 站点中的 Windows 身份验证。

我很难找到一个不需要博士学位就能理解的例子。任何人都可以为我指出一个假人指南或一些样本吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-16T23:01:40.877

尝试 Mvc4MusicStore 示例以使用 Okta 而不是 AD： [https ://github.com/okta/okta-music-store](https://github.com/okta/okta-music-store)

您需要修改代码以使用 Okta 成员资格和角色提供程序。

# r - 如何动态地对值进行子集化并计算平均值

> ID：15603270
> 
> 赞同：0
> 
> 时间：2013-03-24T19:57:33.730
> 
> 标签：r, aggregate, plyr, subset

我有一个包含三个变量（ACC、Type 和 ID）的数据框，其中 ACC 是指决策的准确性，Type 是指 30 种不同的决策类型，每种决策类型在参与者身上重复 15 次，ID 是指给参与者。它看起来像这样：

```
ID     ACC     Type
1       1       1
1       0       3   
1       1      10
etc...
2       1       5
2       0      13
2       0      11
etc... 
```

我的目标是分析参与者中每种决策类型的准确性，并将数据合并到一个数据框中。如：

```
ID    ACC_Type1     ACC_Type2 […]  ACC_Type30
1       70             65             87
2       65             50             90
etc... 
```

到目前为止，我能够通过单独子集决策类型来计算，但是，我正在寻找一种更智能的方法来避免单独输入决策类型值：

```
library(data.table)
library(plyr)
dt <- data.table(d,key="Type")
dt_Type1<-data.frame (aggregate(ACC~ID,data=subset(dt,Type==1),mean))
dt_Type2<-data.frame (aggregate(ACC~ID,data=subset(dt,Type==2),mean))
[]
dt_Type30<-data.frame (aggregate(ACC~ID,data=subset(dt,Type==30),mean))

total <- merge(dt_Type1,dt_Type2 […] Type30,by="ID") 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-24T20:42:10.170

使用 Ananda 的数据，`data.table`可以获得如下解决方案：

```
require(data.table)
dt <- data.table(mydf)
setkey(dt, "TYPE", "ID")
dt[, mean(ACC), by=key(dt)][, setattr(as.list(V1), 'names', 
                paste0("ACC", ID)), by=TYPE]
#    TYPE ACC1 ACC2 ACC3
# 1:    1  3.0  2.5  3.0
# 2:    2  1.5  2.0  3.0
# 3:    3  4.0  2.0  4.5 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:09:45.007

你对子集所做的事情太过分了。一个基本的调用就`aggregate`足够了。此外，要获得所需的输出，您需要使用`reshape`. 这是一个例子：

样本数据：

```
set.seed(1)
mydf <- data.frame(
  ID = rep(1:3, each = 6),
  ACC = sample(0:5, 18, replace = TRUE),
  TYPE = rep(1:3, 6)
) 
```

第 1 步：聚合

```
temp <- aggregate(ACC ~ ID + TYPE, mydf, mean)
temp
#   ID TYPE ACC
# 1  1    1 3.0
# 2  2    1 2.5
# 3  3    1 3.0
# 4  1    2 1.5
# 5  2    2 2.0
# 6  3    2 3.0
# 7  1    3 4.0
# 8  2    3 2.0
# 9  3    3 4.5 
```

第二步：重塑

```
reshape(temp, direction = "wide", idvar = "ID", timevar = "TYPE")
#   ID ACC.1 ACC.2 ACC.3
# 1  1   3.0   1.5   4.0
# 2  2   2.5   2.0   2.0
# 3  3   3.0   3.0   4.5 
```

* * *

### 更新

`dcast`from "reshape2" 可以通过它的参数一步处理这个`fun.aggregate`问题，但是你需要做一些清理来修复名称。

```
> dcast(mydf, ID ~ TYPE, fun.aggregate = mean, value.var = "ACC")
  ID   1   2   3
1  1 3.0 1.5 4.0
2  2 2.5 2.0 2.0
3  3 3.0 3.0 4.5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T20:06:11.883

如果`DT` 是您的`data.table`，那么您可以使用`by=Type` （当然发布一些示例数据将有助于生成更准确的答案）：

但这样的事情应该有效

```
 DT[,  mean(ACC),  by = Type] 
```

# jquery - 如何让 ASP.Net 3.5 WebService 接受 AJAX PUT 请求？

> ID：15603275
> 
> 赞同：0
> 
> 时间：2013-03-24T19:57:51.287
> 
> 标签：jquery, ajax, web-services, asp.net-3.5, put

我无法在 ASP.Net 3.5 项目中获得 WebService 来接受 PUT 请求。

这是 AJAX 调用：

```
var url = '/MyService.asmx/UpdateObject';
var options = {
    dataType: "json",
    contentType: "application/json",
    cache: false,
    type: "PUT",
    data: data ? ko.toJSON(data) : null
};

$.ajax(url, options); 
```

在 MyService.asmx 中，我有以下内容：

```
[WebMethod(EnableSession = true)]
[System.Web.Script.Services.ScriptMethod(ResponseFormat = System.Web.Script.Services.ResponseFormat.Json, UseHttpGet=true)]
public ButDto UpdateObject(ObjectDto myObject)
{
    //Do some stuff here

    return myObject;
} 
```

但是，我收到以下错误消息：

> 尝试使用 POST 请求调用方法 UpdateObject，这是不允许的。

如果我从我的 Web 服务声明中删除 ", UseHttpGet=true" 并执行相同的 ajax 调用，我会收到以下错误消息：

> 尝试使用 GET 请求调用方法 UpdateObject，这是不允许的。

所以我在这里有点困惑。

**更新**：

我也尝试使用 dataType:"text"，但结果是一样的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T22:01:01.127

查看[MSDN](http://msdn.microsoft.com/en-us/library/system.web.script.services.scriptmethodattribute%28v=vs.90%29.aspx)，POST 和 GET 是唯一可接受的带有 ScriptMethod 的 HTTP 动词。

为什么你会收到错误。如果`data`在发送 AJAX 请求时将 JSON 数组放入属性中，jQuery 会将其序列化为查询字符串并将其发送到服务器。但这不是 ASP.NET 所要寻找的。您需要向 jQuery 传递您要使用的 JSON 字符串。喜欢：

```
var url = '/MyService.asmx/UpdateObject';
var options = {
    dataType: "json",
    contentType: "application/json; charset=utf-8",  // add charset for good measure
    cache: false,
    type: "POST",
    data: "{'id':2, 'name':'foobar'}"  // notice the quotes here
};

$.ajax(url, options); 
```

如果要将 Javascript 对象转换为完成请求所需的 JSON 字符串，则可以使用[JSON2](https://github.com/douglascrockford/JSON-js/)`JSON.stringify()`中的内容。

如果您想阅读更多内容，请查看[http://encosia.com/3-mistakes-to-avoid-when-using-jquery-with-aspnet-ajax/](http://encosia.com/3-mistakes-to-avoid-when-using-jquery-with-aspnet-ajax/)其中有很多关于一些常见问题的信息错误是。

# javascript - jQuery 在文档就绪函数中不起作用

> ID：15603281
> 
> 赞同：-1
> 
> 时间：2013-03-24T19:58:17.550
> 
> 标签：javascript, jquery, function

我已经有这个问题好几天了，在环顾 SO 和谷歌之后，我似乎无法解决它。

我在 WAMP 中离线工作，建立一个网站。我在`<head>`使用 google API 的部分中包含 jQuery：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> 
```

似乎我所有的其他 jQuery 插件都与我试图构建自己的插件不同。

我编写的所有 jQuery 都像所有其他 js 脚本一样放在一个名为的文件`sitename.js`和目录中。`/js/`

现在的问题是，我似乎无法开始`$(document).ready(function()`工作，或者任何点击事件。

这是我的脚本：

```
$(document).ready(function(){   
      console.log("test");
}); 
```

当我将`console.log`文档就绪功能移到外部时，它会在我的控制台（萤火虫）中显示它，但在内部时，它不会。

点击事件也不起作用，我不知道为什么：

```
$('.more').live("click",function(){
    console.log("test");
} 
```

这也不起作用，我确实有一个类名为`more`.

我不确定问题是什么，是它的代码不正确还是另一个脚本干扰了这个。提前感谢您的任何建议或答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T19:59:45.583

`live`jQuery v. 1.9.1 不再支持

改用`.on()`：

```
$("#parent").on("click", ".more", function(){
    console.log("test");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-30T15:02:49.277

`$``$(document).ready`如果 jQuery 处于非冲突模式，则未在外部定义。

尝试这个：

```
jQuery(document).ready(function(){   
  console.log("test");
}); 
```

此外，请确保您没有从 https 站点链接到 http。如今，无论是来自 http 还是 https，**始终**链接到资源的 https 版本（如果可用）被认为是最佳实践。

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> 
```

忽略您可能找到的有关无协议链接的任何信息。

# wordpress - 在自定义页面模板上分页

> ID：15603286
> 
> 赞同：0
> 
> 时间：2013-03-24T19:58:32.800
> 
> 标签：wordpress, pagination

我不太了解wordpress。也许这是一个愚蠢的问题。

我创建了一个自定义页面，我的博客名称。所有的博客文章都输入了。我想问的是如何创建这样的分页 << Pre [1] [2] [3] ... Next >> 并且帖子编号由设置>阅读>博客页面最多显示...确定。邮政。

这是我的代码。

```
<div class="page-content">
  <?php
    $paged = (get_query_var('page')) ? get_query_var('page') : 1;
    $args_recent_posts = array( 'post_type' => 'post', 'paged' => '$paged');
    $loop_recent_posts = new WP_Query( $args_recent_posts );
      if ( $loop_recent_posts->have_posts() ) :
        function the_excerpt_max_charlength($charlength)
          {
            $excerpt = get_the_excerpt();
            $charlength++;

            if ( strlen( $excerpt ) > $charlength )
              {
                $subex = mb_substr( $excerpt, 0, $charlength - 5 );
                $exwords = explode( ' ', $subex );
                $excut = - ( strlen( $exwords[ count( $exwords ) - 1 ] ) );

            if ( $excut < 0 )
              {
                 echo mb_substr( $subex, 0, $excut );
              }
            else
              {
                echo $subex;
              }
                echo '...';
              }
            else
              {
                echo $excerpt;
              }
          }  
      while ( $loop_recent_posts->have_posts() ) : $loop_recent_posts->the_post();
  ?>
  <div class="entry-item">
    <div class="entry-image-col1">
      <div class="ch-item chi-mg">
        <?php if ( has_post_thumbnail() ) { the_post_thumbnail( 'page-image-1' ); } ?>
        <div class="ch-info"> <a href="<?php the_permalink(); ?>" class="detail">See Full Post</a> </div>
      </div>
    </div>
    <div class="entry-info-col1">
      <div class="entry-meta">
        <div class="entry-date">
          <?php the_time('j M'); ?>
        </div>
        <div class="entry-author">Author : <span>
          <?php the_author_posts_link(); ?>
          </span></div>
        <span class="entry-comment">Comment : <span>
        <?php comments_number( 'no', 'one', '%' ); ?>
        </span></span> </div>
      <div class="entry-content">
        <div class="entry-title"><a href="<?php the_permalink(); ?>">
          <?php the_title(); ?>
          </a></div>
        <p><?php echo substr(get_the_excerpt(), 0,250); ?></p>
        <a href="<?php the_permalink(); ?>" class="link"><?php echo __( 'Read More &raquo;'); ?></a> </div>
    </div>
  </div>
   <?php endwhile; endif; wp_reset_query(); ?>
  <div class="navigation">
    <div class="alignleft">
      <?php next_posts_link('« Older Entries') ?>
    </div>
    <div class="alignright">
      <?php previous_posts_link('Newer Entries »') ?>
    </div>
  </div>
</div> 
```

我希望有人帮助我。谢谢你。

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2013-03-25T17:02:57.857

使用[WP Paginate](http://wordpress.org/extend/plugins/wp-paginate/) - 它非常易于使用。

# asp.net - 跨虚拟目录的表单身份验证

> ID：15603289
> 
> 赞同：4
> 
> 时间：2013-03-24T19:58:46.230
> 
> 标签：asp.net, asp.net-mvc, forms-authentication

我正在尝试将表单身份验证从根应用程序共享到在虚拟目录中运行的子应用程序。我在子站点中进行身份验证时遇到问题。

在父应用程序中，一切都按预期工作。

我有以下设置：

家长申请：

*   **网址**：`http://localhost:1336/`
*   `<forms loginUrl="~/account/sign-in" protection="All" timeout="30" name=".MYAPPLICATION" path="/" requireSSL="false" slidingExpiration="true" cookieless="UseDeviceProfile" enableCrossAppRedirects="true" defaultUrl="/" />`

虚拟目录：

*   **网址**：`http://localhost:1336/subsite`
*   `<forms loginUrl="/account/sign-in" protection="All" timeout="30" name=".MYAPPLICATION" path="/" requireSSL="false" slidingExpiration="true" cookieless="UseDeviceProfile" enableCrossAppRedirects="true" defaultUrl="/" />`

当我尝试时，`http://localhost:1336/subsite`我得到以下流程：

*   **GET** for `http://localhost:1336/subsite`-> 302 to /account/sign-in?ReturnUrl=%2fsubsite *（看起来不错）*
*   输入用户/密码
*   **POST**到`http://localhost:1336/account/sign-in?ReturnUrl=%2fsubsite`-> 302 /subsite *（授权看起来很成功）*
*   **GET** for `http://localhost:1336/subsite`-> 302 to /account/sign-in?ReturnUrl=%2fsubsite *（即子网站认为它没有经过身份验证）*

我也可以在浏览器的列表中看到 cookie（所以它确实在那里）

我的配置有什么问题阻止我的子站点共享父 cookie？

我在 IISExpress 上运行它

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-24T20:50:57.860

在您的 web.config 文件中，设置项目之间的通用机器密钥，以便 2 个域共享验证和解密密钥。

例子：

```
<machineKey validationKey="21F090935F6E49C2C797F69BBAAD8402ABD2EE0B667A8B44EA7DD4374267A75D7" 
decryptionKey="ABAA84D7EC4BB56D75D217CECFFB9628809BDB8BF91CFCD64568A145BE59719F"
validation="SHA1"
decryption="AES"
/> 
```

# windows - 'javac 无法识别'，Java 7-Windows 8

> ID：15603298
> 
> 赞同：4
> 
> 时间：2013-03-24T19:59:36.497
> 
> 标签：windows, command-line-arguments, java, javac

我一直在尝试设置 javac，但我不断收到可怕的错误消息

```
javac is not recognized as an internal or external command, operable program or batch file 
```

我已将 javac (C:\Program Files\Java\jdk1.7.0_17\bin) 的位置添加到`Path`in `Environment Variables`.. 重新启动控制台等，但错误仍然存​​在。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-24T20:06:04.713

我遇到了和你一样的问题，我已经解决了这样的问题：

在系统变量中，我创建了一个新变量，称为 JAVA_HOME，并将值设置为：C:\Program Files\Java\jdk1.7.0_17。之后，我编辑了路径，它也在系统变量中，并添加了：;%JAVA_HOME%\bin。

我希望它会帮助你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:23:16.380

路径中的空间`Program Files`是可疑的。您是否将这部分路径放在引号中？

您还可以尝试`where javac`查看路径上是哪个 javac。但是，在这种情况下，听起来它无论如何都不会在路径上被拾取（它可能还会报告找不到 javac）。

# javascript - CSS 动画菜单，如 facebook IOS 应用程序

> ID：15603301
> 
> 赞同：0
> 
> 时间：2013-03-24T19:59:56.303
> 
> 标签：javascript, html, css

我有一个“display：none”的 div 占据了 25% 的页面。单击页面上的按钮时，div 变为可见并向用户显示菜单。我想让 div 动画看起来好像页面向右滑动并且菜单在它后面，就像 facebook IOS 应用程序上的菜单一样，这可以用 css 和 javascript 完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:25:56.410

请参阅[其中](https://stackoverflow.com/questions/8753024/how-to-make-a-sliding-menu-similar-to-the-facebook-mobile-side-menu-with-html-cs) [一页](https://github.com/i8ramin/fb-menu)[，](https://stackoverflow.com/questions/7794689/jquery-mobile-pageslide-new-facebook-menu) [但](http://lab.hakim.se/meny/) 尚未尝试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-12T09:52:44.863

最好的方法是使用 CSS3 和 Javascript。我为动画强制硬件加速，使其在移动设备上流畅。检查这个 plunkr [http://plnkr.co/edit/GGQLn519tPCrqjwHER4W?p=preview](http://plnkr.co/edit/GGQLn519tPCrqjwHER4W?p=preview)

# ruby-on-rails - Ruby on Rails：将文件上传到服务器

> ID：15603306
> 
> 赞同：0
> 
> 时间：2013-03-24T20:00:29.890
> 
> 标签：ruby-on-rails

我正在使用 Android 设备通过 POST 方法将文件上传到服务器。但我不知道如何让 Rails 处理这个事件。也就是说，Android 设备通过 POST 方法通过 link : 向服务器发送文件后`http://localhost/upload_file`，rails 服务器可以处理这个事件，并将这个文件放入数据库，例如。

我有谷歌和一些结果告诉我使用额外的插件。是否存在任何纯方法只使用 rails ？请告诉我。

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:03:31.143

Rails 可以很容易地处理文件上传。以下是您应该阅读的相关指南：http: [//guides.rubyonrails.org/form_helpers.html](http://guides.rubyonrails.org/form_helpers.html)

以下是指南中的一小段：

> **5.1 上传什么**
> 
> params 哈希中的对象是 IO 子类的一个实例。根据上传文件的大小，它实际上可能是 StringIO 或由临时文件支持的 File 实例。在这两种情况下，对象都有一个 original_filename 属性，其中包含文件在用户计算机上的名称，以及一个 content_type 属性，其中包含上传文件的 MIME 类型。

# c# - 在 WPF Datagrid 中将动态图像设置为自动生成的列

> ID：15603314
> 
> 赞同：2
> 
> 时间：2013-03-24T20:01:18.640
> 
> 标签：c#, wpf, wpfdatagrid

DataGrid 是这样声明的

```
<DataGrid x:Name="DgDirectories" 
                  AutoGenerateColumns="True" /> 
```

它是使用我的 DTO 对象的`DgDirectories.ItemSource`属性动态填充的。`IEnumerable`此对象包含具有**动态**图像的 byte[] 属性（HDD 上不存在）。我想**在网格中****显示**这些图像。

 **我尝试将其转换`byte[]`为`BitmapImage`数据并将其与数据一起传递，但无论如何网格都会`DataGridTextColumn`为这些类型创建。

可能这可以更容易完成，但我有一点使用 WPF 的经验......请帮助我在列中显示图像

PS：我是WPF的新手。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-25T00:04:07.570

您应该删除 autogeneratecolumn=true 并指定要显示的列。这将使您有机会指定具有图像的列的数据模板。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-27T10:16:35.653

用于动态路径名绑定的 Xaml 代码

```
<DataGrid x:Name="dataGrid1" AutoGenerateColumns="False">
        <DataGrid.Columns>
            <DataGridTemplateColumn>
                <DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <Image Source="{Binding ImageFilePath}" />
                    </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
        </DataGrid.Columns>
    </DataGrid> 
```

现在只需使用用 IEnumerable 文件路径列表实例化的 uri 对象在逻辑后面开始你的代码......希望这就足够了**

# algorithm - 用于数据匹配的高效数据结构

> ID：15603315
> 
> 赞同：4
> 
> 时间：2013-03-24T20:01:21.917
> 
> 标签：algorithm, data-structures

匹配数据最有效的数据结构是什么？例如，假设我看到以下场景：

```
<time available> <buy or sell> <company name> <buy or sell price> <amount to buy or sell> 
```

这样一个文件可能包含：

```
0 sell yahoo $100 #1
2 sell yahoo $14  #1
2 sell yahoo $28  #1
.. 95 other yahoo sells <$125 and amount #1
3 sell yahoo $17  #1
5 sell yahoo $33  #1
9 buy yahoo  $125 #100 
```

是否可以在 O(n) 时间内将最后一次买入与前 100 次卖出相匹配，其中 n = 100 如果要与与其想要购买的公司相对应的最低售价匹配（或在平局的情况下首先出现）？

我知道一个天真的解决方案是对列表进行排序并按顺序进行，但这需要比 O(n) 时间更长的时间。处理这个问题以及与之类似的最有效的数据结构是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T22:17:07.380

尝试使用从公司名称到一堆卖单的哈希映射，按价格排序。现在插入卖单`O(log n)`，如果买单没有用完卖单，或者`O(log n)`如果用完（您的问题陈述未指定） ，则买单将保持不变

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T12:49:07.013

由于买卖将处理同一个组织，因此最好将所有买入（或）卖出记录保存在地图中，就像所有雅虎记录都保存在一个列表中，该列表以“雅虎”为键散列到地图中，这可以最大限度地减少您的搜索空间。对时间戳、价格、数量进行排序，然后您可以在插入时通过实现此结构以最优成本实现所需的功能。然后，在此之后的任何查询都应该花费更少的时间，因为搜索空间很小。

# svg - 使 SVG 路径的笔画宽度取决于位置

> ID：15603323
> 
> 赞同：2
> 
> 时间：2013-03-24T20:01:57.077
> 
> 标签：svg, inkscape

我有一个大 (12 MB) SVG 文件，其中包含许多具有相同笔画宽度的弯曲路径。现在，我想以某种数学函数的方式转换笔画宽度，该数学函数将路径段的坐标（甚至更好：路径段上的实际点）作为输入。

到目前为止，我发现的唯一方法是使用 inkscape 分段切割路径，然后使用 python 的 etree 库修改笔画宽度。但我真正想要的是不断减少/增加笔画宽度，就像在 inkscapes 书法工具中一样。

# jquery - 将发布数据发送到 iframe 并重新加载 iframe

> ID：15603326
> 
> 赞同：1
> 
> 时间：2013-03-24T20:02:04.687
> 
> 标签：jquery, iframe

我尝试使用 jquery 进行类似的操作，但我失败了。

`$.ajax({ type: "POST", url: "myphphere.php", data: { command: $('#command').var() } });`

我还考虑过使用按钮的 onclick 属性刷新页面以提交表单。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-24T20:09:34.457

为什么只在表单中使用`target`属性？

```
<form action="..." target="an_iframe" type="post">
<input type="text" name="cmd" placeholder="type a command here..." />
<input type="submit" value="Run!" />
</form>
<iframe id="an_iframe"></iframe> 
```

希望它能解决你的问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-24T20:11:21.267

Jquery [Ajax](http://api.jquery.com/jQuery.ajax/)是您所需要的。

将命令发送到 php 脚本很简单：

```
 $.ajax({
      type: "POST",
      url: "some.php",
      data: { command: $('#command').val()}
    }).done(function( msg ) {
      alert( "result : " + msg );
  }); 
```

您可以接收命令结果并可以在任何地方显示（无需刷新页面）

# java - 按位移位运算符，按负数移位

> ID：15603327
> 
> 赞同：10
> 
> 时间：2013-03-24T20:02:09.267
> 
> 标签：java, bit-manipulation

我遇到了一个有趣的场景，当使用按位移位运算符时。如果第二个操作数是负数，按位移位操作是如何工作的？.

即 a << b ，"<<" 将 a 中的位模式向左移动 b 位。但是如果 b 是消极的，它不应该是运行时的错误吗？

我能够成功运行以下代码，但我不明白它是如何工作的？

```
 public static void bitwiseleftShift(char testChar)
{
    int val=testChar-'a';
    int result= 1<<val;
    System.out.println("bit wise shift of 1 with val="+val+" is "+result);
} 
```

输入

```
 bitwiseleftShift('A');// ASCII 65
   bitwiseleftShift('0'); // ASCII 48 
```

结果

```
 bit wise shift of 1 with val=-32 is 1
   bit wise shift of 1 with val=-49 is 32768 
```

'a' 的 ASCII 是 97。有人可以帮我理解它是如何工作的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-24T20:05:39.807

> 但是如果 b 是消极的，那么它在运行时不应该是一个错误吗？

不根据 Java 语言规范，[第 15.19 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.19)：

> 如果左侧操作数的提升类型是 int，则只有右侧操作数的五个最低位用作移位距离。就好像右手操作数受到按位逻辑与运算符 & (§15.22.1) 的影响，掩码值为 0x1f (0b11111)。因此，实际使用的移位距离始终在 0 到 31 的范围内，包括 0 到 31。

因此，-32 的移位实际上以 0 的移位结束，-49 的移位实际上以 15 的移位结束——因此您看到了结果。

# sql - 从字符串的一部分到某个字符查找长度

> ID：15603329
> 
> 赞同：0
> 
> 时间：2013-03-24T20:02:25.237
> 
> 标签：sql, db2

DB2 SQL => 如何从字符串的一部分中获取长度？例如，该列的数据是

```
MARYqORANGE
JENNYqBLUE,
DAVEqYELLOW,
JONATHANqGREEN 
AMANDAqBLACK 
```

我怎样才能得到这些数据的长度`q`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:09:48.297

使用`locate`功能：

```
select locate('q', col) 
```

如果您想要“q”之前的初始部分，请使用：

```
select (case when col like '%q%' then left(col, locate('q', col) - 1) else col end) 
```

# python - 将 python 脚本注册为文件类型的默认值

> ID：15603334
> 
> 赞同：3
> 
> 时间：2013-03-24T20:02:27.797
> 
> 标签：python, default, file-extension, file-association

我正在使用需要与文件类型关联的 python 应用程序。我需要一个跨平台解决方案（对于不同的平台可能不同），包括设置文件类型的图标、双击该类型的文件时打开我的应用程序以及打开我的应用程序时能够引用该文件.

**澄清**
一下，假设我有一个名为 FooEdit 的应用程序，它可以编辑`.foo`文件。`.foo`文件的 MIME 类型为`text/plain`. 以下是用户首次获取 FooEdit 时发生的过程：

*   用户获取我的应用程序的可执行文件，无论它是在 Linux、Windows 还是 OS X 上。
*   一个 python 脚本运行：
    1.  将 FooEdit（可执行文件）设置为`.foo`文件扩展名的默认应用程序。
    2.  将文件的图标设置为`.foo`foofileicon.png（或 foofileicon.ico，如果效果更好）。
*   同一用户双击`.foo`文件。
*   FooEdit 打开它的`argv`数组中的文件路径（我使用的是 PyQt4）

我见过[这个问题](https://stackoverflow.com/questions/8693622/open-specific-file-type-with-python-script)，但它仅指 Mac OS X，用户必须手动完成，我希望该解决方案适用于所有三个主要平台（Linux、Windows、OS X）并且我希望它能够完成由 python 脚本自动生成。
我也听说过为了这样的目的将值插入到 Windows 注册表中，我可以为我的程序的 Windows 版本这样做。然而，这仍然让我对如何在 Mac 和 Linux 上做同样的事情一无所知。
我想要一个适用于所有平台的单一解决方案，尽管我承认这很可能是不可能的。

# php - 错误：2003 - 无法连接到“localhost”上的 MySQL 服务器 (10061)

> ID：15603336
> 
> 赞同：-6
> 
> 时间：2013-03-24T20:02:32.217
> 
> 标签：php, mysql, sql, oracle10g

我想建立一个连接并将 sql server 连接到 php 但它给出了这个错误

浏览器。我想在本地主机上构建。

请帮助。

如果问题没有意义，请不要投票。

```
 <?php

 $conn = oci_connect("system","password","localhost/xe");

 $username = $_POST["username"];

 $password = $_POST["password"];

  $sql = oci_parse($conn,"Select * from login where username = '$username' and password = 

  '$password'");

  oci_execute($sql);

  $nrows = oci_fetch_all($sql , $res);

  if($nrows > 0)

{

    echo "Login Successfull";

  }
else

{

    echo "Username and password is incorrect";

}

   ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:16:59.470

要使用 php (PDO) 连接到 oracle 数据库，请执行以下操作。

```
<?php
try {
$dbh = new PDO("OCI:", "username", "password")
}
catch (PDOException $e)
{
echo $e->getMessage();
}
?> 
```

这个例子可能更容易理解：Accounts = 数据库名称“charset=utf-8”=用于大多数语言，用户名和密码 = root（大多数情况下在 localhost 上）。

```
<?php
try {
$dbh = new PDO("OCI:dbname=accounts;charset=UTF-8", "username", "password");
}
catch (PDOException $e)
{     echo $e->getMessage();     } ?> 
```

由于您将问题更改为 SQL，我想我可以添加一些代码。上面的答案是针对 oracle 的，但是如果您想连接到 SQL，请执行以下操作。

```
<?php

$hostname = 'localhost';
$username = 'username';
$password = 'password';

try {
   $dbh = new PDO("mysql:host=$hostname;dbname=mysql", $username, $password);
   echo 'Connected to database';
   }
catch(PDOException $e)
{
echo $e->getMessage();
}
?> 
```

如果您仍然没有解决问题，我建议您访问：[http ://www.phpro.org/tutorials/Introduction-to-PHP-PDO.html](http://www.phpro.org/tutorials/Introduction-to-PHP-PDO.html)

请关闭或删除该问题，具体取决于您是否对答案感到满意或不觉得您在寻找的地方得到了答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:14:09.037

问题很简单：您正在使用`mysql_`函数连接到 Oracle。你不能那样做。

也许这会让你开始：[http ://www.databasejournal.com/features/oracle/article.php/3763916/Intro-to-PHP--Oracle.htm](http://www.databasejournal.com/features/oracle/article.php/3763916/Intro-to-PHP--Oracle.htm)

# coldfusion - cfexchangeconnection 如何支持 % 符号？

> ID：15603338
> 
> 赞同：1
> 
> 时间：2013-03-24T20:02:47.423
> 
> 标签：coldfusion, coldfusion-9

在 Coldfusion 9 中，当调用 cfexchangeconnection 时使用的密码包含 % 符号时，我们会遇到错误。

错误是：

```
Could not log in to the Exchange server.

Verify server name, username, and password. 
```

用户名和密码没有问题，因为我们可以使用 CFLDAP 登录系统就好了。此外，如果我们将密码更改为没有百分号的密码，那么 cfexchangeconnection 就可以正常工作。

cfexchangeconnection 如何支持 % 符号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:32:30.593

（来自评论）

这是在黑暗中拍摄的，但是如果您尝试转义字符，例如`%25`（即 url 编码）或可能`\%`不仅仅是`%`?

我会按照亚当的建议继续提交错误报告。与此同时，我想解决方法是使用类似的东西`URLEncodedFormat(thePassword)`？

# c# - JsonString 反序列化错误

> ID：15603343
> 
> 赞同：1
> 
> 时间：2013-03-24T20:03:14.550
> 
> 标签：c#, visual-studio-2010, wcf

我正在尝试反序列化我的 JsonString

```
string JsonString=  "{\"RequestId\":1308,\"Warning\":[\"WARNING_NoOrdersForCustomer\"],\"Customer\":{\"__type\":\"CustomerOrder:#Data\",\"Email\":\"xyz@yahoo.com\",\"FullName\":\"Anke White\",\"Phone\":\"\",\"Orders\":[]}}" 
```

这是我的数据合同

```
 [DataContract]
      public class SalesInfo
      {
          [DataMember(Name = "RequestId")]
          public string RequestId { get; set; }

          [DataMember(Name = "Warning")]
          public string[] Warning { get; set; }

          [DataMember(Name = "Customer")]
          public Customer CustomerData { get; set; }

      }

[DataContract]
    public class Customer
      {
          [DataMember(Name = "Email")]
          public string Email { get; set; }

          [DataMember(Name = "FullName")]
          public string FullName { get; set; }

          [DataMember(Name = "Phone")]
          public string Phone { get; set; }

          [DataMember(Name = "Orders")]
          public string[] Orders { get; set; }

      } 
```

我试过这个

```
SalesInfo sales = Deserialize<SalesInfo>(JsonString); 
```

这是反序列化

```
private static T Deserialize<T>(string json)
{
    var instance = Activator.CreateInstance<T>();
    using (var ms = new MemoryStream(Encoding.Unicode.GetBytes(json)))
    {
        var serializer = new DataContractJsonSerializer(instance.GetType());
        return (T)serializer.ReadObject(ms);
    }
} 
```

但我收到错误消息

```
Element ':Customer' contains data from a type that maps to the name 'http://schemas.datacontract.org/2004/07/Data:CustomerOrder'. The deserializer has no knowledge of any type that maps to this name. Consider using a DataContractResolver or add the type corresponding to 'CustomerOrder' to the list of known types - for example, by using the KnownTypeAttribute attribute or by adding it to the list of known types passed to DataContractSerializer. 
```

请帮我解决这个错误并反序列化 JsonString

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:39:18.877

因为您的 JsonString 不正确：

\"Customer\":{ **\"__type\":\"CustomerOrder:#Data\"** ,\"Em...

并且没有关于 CustomerOrder 类型的任何信息。

在您的情况下，正确的 JsonString 是：

{\"RequestId\":1308,\"Warning\":[\"WARNING_NoOrdersForCustomer\"], **\"Customer\":{\"Email\":\"xyz@yahoo.com\",\"FullName\ ":\"安克白\",\"电话\":\"\",\"订单\":[]}}**

![在此处输入图像描述](../Images/19224d565c3dbdbbfecdb72bd4ca5249.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T21:17:26.270

似乎您使用的是专有的 MS Ajax JSON 格式，该格式插入了这些与其他任何东西都不兼容的“__type”东西。

因此，请检查解决方案的序列化部分。

# python - 如何在 Python 中使用“html 编写”URL 解析 HTML 代码？

> ID：15603356
> 
> 赞同：2
> 
> 时间：2013-03-24T20:04:13.603
> 
> 标签：python, html, parsing

我开始用 Python 编程，并且一直在阅读一些帖子，他们说我应该使用 HTML 解析器从文本而不是重新获取 URL。

我有从 and 获得的`page.read()`源`urllib`代码`urlopen`。

现在，我的问题是解析器正在从文本中删除 url 部分。

另外，如果我没看错，`var = page.read()`,`var`是否存储为字符串？

我怎么能告诉它给我两个“标签”之间的文字？URL 总是介于两者之间`flv=`，`;`因此它不`href`以解析器查找的内容开头，也不包含`http://`任何内容。

我读过很多帖子，但似乎他们都在代码中寻找`href。

我完全错了吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T21:07:22.087

您可以考虑实现自己的搜索/抓取。在伪代码中，它看起来有点像这样：

```
find location of 'flv=' in HTML = location_start
find location of ';' in HTML = location_end
grab everything in between:   HTML[location_start : location_end] 
```

你应该能够在 python 中实现它。

祝你好运！

# r - 绘图函数中的 Y 值标签

> ID：15603357
> 
> 赞同：0
> 
> 时间：2013-03-24T20:04:19.517
> 
> 标签：r, plot

我需要在我的情节旁边添加 Y 值标签，我尝试了文本功能，但这里没有运气 - 它只打印我的 X 值。有什么建议吗？作为绘图函数的参数，这样的功能不是可以实现的吗？

我的第二个小问题是如何在 X 轴上打印所有值，而不仅仅是像我现在这样每五分之一

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:13:09.437

尝试这个：

```
set.seed(1)
y<-rnorm(10)
set.seed(2)
x<-rnorm(10)
plot(x,y)
text(x, y, labels=round(y,2),pos=3) 
```

对于第二个问题，您可以使用`?axis`函数：

```
plot(x,y,xaxt="n") #don't draw x-axis
 #draw x-axis by spesifying the ticks using argument at for function axis
axis(side=1,at=x,labels=round(x,2)) #this makes ticks only for values in x
text(x, y, labels=round(y,2),pos=4) 
```

# app-inventor - 应用程序发明者块编辑器启动缓慢并返回错误“无法下载启动器应用程序...”

> ID：15603359
> 
> 赞同：0
> 
> 时间：2013-03-24T20:04:26.337
> 
> 标签：app-inventor

我正在尝试为应用程序发明者运行 blocs 编辑器。它开始缓慢，然后返回消息：

我们无法从服务器下载启动应用程序以便将其安装在设备上。这可能会阻止“连接到设备”按钮工作。如果您尝试使用之前下载的“.jnlp”文件启动块编辑器，则可能会发生此错误。

我已经安装了最新版本的 java，其他 java 应用程序运行良好。块编辑器如何工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T12:43:06.610

可能有很多原因。您使用的是哪个浏览器？你已经尝试过另一个了吗？

可能有某种阻止软件在您的机器上运行，也许是防火墙。也有来自错误配置的病毒扫描程序的报告。

您可能还想查看[故障排除](http://appinventor.mit.edu/explore/content/troubleshooting.html)页面。如果这没有帮助，请在开始[设置并将您的手机连接到 App Inventor](https://groups.google.com/forum/#!forum/getting-started-with-app-inventor)论坛中发布问题。

# python - Python：在 GUI 中调用服务器函数时出现 Errno 57

> ID：15603361
> 
> 赞同：0
> 
> 时间：2013-03-24T20:04:28.417
> 
> 标签：python, macos, oop, sockets, functional-programming

**问题**

为什么我收到了`error: [Errno 57] Socket is not connected`，即使我已经初始化了套接字？完整的代码[在 paste bin 上](http://pastebin.com/gEXBMFMi)，但请随时查看我在此处提供的内容。

**背景**

我正在为套接字服务器创建一个基本的 GUI。我在使脚本的两个部分（GUI 和服务器）进行通信时遇到问题。服务器部分是按功能编写的，而 Tkinter GUI 是在 OOP 中。GUI 调用服务器的某些部分来运行。服务器完美无缺，但是每当我调用该函数`send_msg`（使用套接字发送消息）时，我都会收到错误消息。

```
[Errno 57] Socket is not connected 
```

**代码**

在`GUI` `__init__`方法中，我调用了`start_up()`函数。该函数打开套接字并将其绑定到相应的地址。这是功能：

```
def start_up():
    HOST = socket.gethostname()
    PORT = 2468

    print "HOST: %s" % (HOST)
    print "PORT: %s" % (PORT)
    print "\n"
    print "-------------------------"
    print "\n"
    global s
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM )
    s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
    print "Socket Created"

    try:
        s.bind((HOST, PORT))
    except socket.error, msg:
        print "Bind failed. Error Code : " + str(msg[0]) + " Message " + str(msg[1])
        sys.exit()
    print "Socket Bind Complete"
    """
    So by specifying 10, it means that if 10
    connections are already waiting to be processed,
    then the 11th connection request shall be rejected.
    This will be more clear after checking socket_accept.
    """
    s.listen(10)
    print "Socket now listening" 
```

每当我按下`self.send`按钮时，它都会调用该`class_send_msg`方法，该方法又会调用该`send_msg(s)`函数。这是`send_msg`代码：

```
def send_msg(s):
    #Send some data to the remote server
    message = app.message.get("0.0", END)

     #set the whole string
    s.sendall(message)
    myHistory = open("history.txt", "a+")
    myHistory.write(message) 
```

最后，我收到的控制台消息（带有回溯）：

```
HOST: ****.local
PORT: 2468

-------------------------

Socket Created
Socket Bind Complete
Socket now listening
Exception in Tkinter callback
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk/Tkinter.py", line 1410, in __call__
    return self.func(*args)
  File "/Volumes/****'S USB/Python Programs/Sockets/IM Project/Server/Server GUI InDev Class.py", line 160, in class_send_msg
    send_msg(s)
  File "/Volumes/****'s USB/Python Programs/Sockets/IM Project/Server/Server GUI InDev Class.py", line 97, in send_msg
    s.sendall(message)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py", line 224, in meth
    return getattr(self._sock,name)(*args)
error: [Errno 57] Socket is not connected 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:10:29.673

“s”是你的监听套接字。这个套接字只接受新的连接。您不应该在此套接字上发送数据。

您应该在“连接”上发送数据，这是您从调用 s.accept() 获得的套接字。

您可能需要重组您的代码来实现这一点。

# sql - 将两个不同条件的计数器放在一起

> ID：15603367
> 
> 赞同：0
> 
> 时间：2013-03-24T20:05:10.357
> 
> 标签：sql, join, count, group-by

我需要计算所有`tweets`和`retweets`（所有转发也是推文）表中的每个用户`authors`。我的第一个想法很有效：

**推文柜台**

```
SELECT a.id, a.name, count(*)
FROM authors AS a
INNER JOIN tweets AS t 
ON t.fromuser_id = a.id
GROUP BY a.id, a.name
ORDER BY count(*) 
```

**转推柜台**

```
SELECT a.id, a.name, count(*)
FROM authors AS a
INNER JOIN tweets AS t 
ON t.fromuser_id = a.id AND retweet = TRUE
GROUP BY a.id, a.name
ORDER BY count(*) 
```

...但现在我想把所有这些放在一起。我想知道是否有比这更好（更快）的方法：

**合并**

```
SELECT a.id, a.name, count(*), (
    SELECT count(*) 
    FROM tweets 
    WHERE fromuser_id = a.id AND retweet = TRUE
)
FROM authors AS a
INNER JOIN tweets AS t 
ON t.fromuser_id = a.id
GROUP BY a.id, a.name
ORDER BY count(*) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:06:45.770

```
SELECT a.id, a.name, count(*),
       SUM(CASE WHEN retweet = TRUE THEN 1 ELSE 0 END) as retweets_count
FROM authors AS a
INNER JOIN tweets AS t 
ON t.fromuser_id = a.id
GROUP BY a.id, a.name
ORDER BY count(*) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:07:43.597

是的，有更好的方法。使用条件求和：

```
SELECT a.id, a.name, count(*),
       sum(case when retweet = true then 1 else 0 end) as retweets
FROM authors AS a
INNER JOIN tweets AS t 
ON t.fromuser_id = a.id
GROUP BY a.id, a.name
ORDER BY count(*) 
```

# javascript - 检查本地存储性能中是否存在项目

> ID：15603369
> 
> 赞同：1
> 
> 时间：2013-03-24T20:05:27.413
> 
> 标签：javascript, html, performance

假设我检查一下 localStorage 中是否存在更快（或者没有区别）的东西？：

```
if (localStorage[key]) do_something(); 
```

或者

```
if (key in localStorage) do_something; 
```

我不知道 Javscript 引擎做了什么，但即使我没有为它指定变量，它也不`localStorage[key]`返回内部的值（假设它已定义）？`localStorage[key]`现在我知道通常这只会分配一个指向 localStorage[key] 内部值的指针，但是由于 localStorage 是一个单独的浏览器 API（可能会转到磁盘），这会改变什么吗？

假设这是一个相对较大的字符串，这在性能敏感代码中可能会很慢。

# iphone - 从 UIBarButtonItem 取回 UIBarButtonSystemItem

> ID：15603375
> 
> 赞同：13
> 
> 时间：2013-03-24T20:05:48.033
> 
> 标签：iphone, ios, cocoa-touch, unit-testing

尝试对我在导航栏按钮上设置正确的 UIBarButtonSystemItem 进行单元测试。

我可以恢复样式，但似乎找不到获取 UIBarButtonSystemItem 的方法

为按钮设置的枚举。失败是因为样式与枚举不同

UIBarButtonSystemItem：

```
- (void)test_init_should_set_left_right_barButtonItems {

    UIBarButtonItem *left = mainVCSUT.navigationItem.leftBarButtonItem;
    UIBarButtonItem *right = mainVCSUT.navigationItem.rightBarButtonItem;
    [Assert isNotNil:left];
    [Assert isNotNil:right];

    UIBarButtonItemStyle leftStyle = left.style;
    UIBarButtonItemStyle rightStyle = right.style;

    [Assert that:[The int:leftStyle] is:[Equal to:[The int:UIBarButtonSystemItemRefresh]]];
    [Assert that:[The int:rightStyle] is:[Equal to:[The int:UIBarButtonSystemItemSearch]]];
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-25T01:32:05.790

至少在 iOS 6.1 上（我还没有测试过其他版本）`UIBarButtonItem`有一个未声明的方法`systemItem`，它返回传递给初始化程序的值。您可以使用键值编码轻松访问它：

```
UIBarButtonSystemItem systemItemIn = UIBarButtonSystemItemAdd;
UIBarButtonItem *item = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:systemItemIn target:nil action:NULL];
NSNumber *value = [item valueForKey:@"systemItem"];
UIBarButtonSystemItem systemItemOut = [value integerValue];
NSLog(@"systemItemIn = %d, systemItemOut = %d", systemItemIn, systemItemOut); 
```

如果这不起作用，您可以为内部匿名结构创建一个 typedef，该结构是`UIBarButtonItem`存储此信息的类的实例变量，并使用私有 ivar 的名称和 Objective C 运行时间，如下所示：

```
//Copied from UIBarButtonItem.h, this is the struct used for the _barButtomItemFlags ivar
typedef struct {
    unsigned int enabled:1;
    unsigned int style:3;
    unsigned int isSystemItem:1;
    unsigned int systemItem:7;
    unsigned int viewIsCustom:1;
    unsigned int isMinibarView:1;
    unsigned int disableAutosizing:1;
    unsigned int selected:1;
    unsigned int imageHasEffects:1;
} FlagsStruct;

// In our test code
// Instantiate a bar button item
UIBarButtonSystemItem systemItemIn = UIBarButtonSystemItemAdd;
UIBarButtonItem *item = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:systemItemIn target:nil action:NULL];

// Set up variables needed for run time functions
Class barItemClass = [item class];
BOOL foundIt = NO; // We check this flag to make sure we found the ivar we were looking for
ptrdiff_t ivarOffset = 0; // This will be the offset of _barButtomItemFlags within the bar button item object

// Iterate through all of UIBarButtonItem's instance variables
unsigned int ivarCount = 0;
Ivar *ivarList = class_copyIvarList(barItemClass, &ivarCount);
for (int i = 0; i < ivarCount; i++) {
    Ivar ivar = ivarList[i];
    const char *ivarName = ivar_getName(ivar);
    if (!strcmp(ivarName, "_barButtonItemFlags")) {
        // We've found an ivar matching the name. We'll get the offset and break from the loop
        foundIt = YES;
        ivarOffset = ivar_getOffset(ivar);
        break;
    }
}
free(ivarList);

if (foundIt) {
    // Do a little pointer math to get the FlagsStruct - this struct contains the system item value.
    void *itemPointer = (__bridge void *)item;
    FlagsStruct *flags = itemPointer + ivarOffset;
    UIBarButtonSystemItem systemItemOut = flags->systemItem;
    NSLog(@"systemItemIn = %d, systemItemOut = %d", systemItemIn, systemItemOut);
    BOOL equal = (systemItemIn == systemItemOut);
    if (equal) {
        NSLog(@"yes they are equal");
    }
    else {
        NSLog(@"no they are not");
    }
}
else {
    // Perhaps Apple changed the ivar name?
    NSLog(@"didn't find any such ivar :(");
} 
```

无论您采用哪种方式，它都可能会发生变化，因此我可能建议您的测试仅在经过验证以支持这些方法中的任何一种的操作系统版本上有条件地运行。

# css - IE 中的 CSS 下拉菜单

> ID：15603379
> 
> 赞同：1
> 
> 时间：2013-03-24T20:05:54.767
> 
> 标签：css, internet-explorer, drop-down-menu

我在 CSS 中有我的导航，因此将鼠标悬停在父级`<ul>`内的主导航上`<li>`。很简单。它适用于除 IE 之外的所有浏览器。我不知道为什么。

这是CSS和HTML：

HTML：

```
<ul>
    <a href="#" class="nav"><li id="first">Home</li></a>
    <a href="#" class="nav"><li id="second">About
        <ul>                    <a href="#1"><li>Who Am I?</li></a>
            <a href="#2"><li>My Mission</li></a>
            <a href="#3"><li>Portfolio</li></a>
        </ul>
    </li></a>
    <a href="#" class="nav"><li id="third">Toy Box
        <ul>
            <a href="#"><li>Projects</li></a>
            <a href="#"><li>Toys</li></a>
        </ul>
    </li></a>
    <a href="#" class="nav"><li id="fourth">Contact</li></a>
    <a <?php if(isset($_SESSION['id'])){ echo "href='editProfile.php'"; }else{ echo "href='login.php'"; } ?> class="nav"><li id="fifth">Account
        <?php
        if(!isset($_SESSION['id'])){
        ?>
        <ul>
            <a href="login.php"><li>Log-In</li></a>
            <a href="register.php"><li>Register</li></a>
        </ul>
        <?php
        }else{
        ?>
        <ul>
            <a href="editProfile.php"><li>Edit Profile</li></a>
            <a href="logout.php"><li>Log-Out</li></a>
        </ul>
        <?php
        }
        ?>
    </li></a>
    <div class="clear"></div>
</ul> 
```

CSS：（以 LESS 格式）

```
ul{
        list-style-type: none;

        li{
            position: relative;
            z-index: 2;
            float: left;
            width: 20%;
            height: 100%;
            margin: 0;
            padding: 0;

            font-size: 20px;
            color: #FFF;
            line-height: 35px;
            text-align: center;
            background-color: fade(#FFF, 15%);
            .transition-duration(.5s);

            ul{
                position: absolute;
                width: 100%;
                left: -9999px;
                .transition-duration(.3s);

                li{
                    display: block;
                    width: 100%;
                    height: 35px;
                    line-height: 35px;
                    background-color: fade(#FFF, 40%);
                }
            }

            &#first:hover{
                background-color: #4200AA;
            }
            &#second:hover{
                background-color: #003BB1;
                ul{
                    left: auto;
                    background-color: #003BB1;
                    .drop-shadow(0px, 2px, 4px, 3px, #111, 30%);
                    li{
                        &:hover{
                            background-color: lighten(#003BB1, 10%);
                        }
                    }
                }
            }
            &#third:hover{
                background-color: #00BC48;
                ul{
                    left: auto;
                    background-color: #00BC48;
                    .drop-shadow(0px, 2px, 4px, 1px, #111, 30%);
                    li{
                        &:hover{
                            background-color: lighten(#00BC48, 5%);
                        }
                    }
                }
            }
            &#fourth:hover{
                background-color: @yellow;
                ul{
                    left: auto;
                    background-color: @yellow;
                    .drop-shadow(0px, 2px, 4px, 1px, #111, 30%);
                    li{
                        &:hover{
                            background-color: lighten(@yellow, 10%);
                        }
                    }
                }
            }
            &#fifth:hover{
                background-color: #E82B15;
                ul{
                    left: auto;
                    background-color: #E82B15;
                    .drop-shadow(0px, 2px, 4px, 1px, #111, 30%);
                    li{
                        &:hover{
                            background-color: lighten(#E82B15, 10%);
                        }
                    }
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:32:03.070

改变

```
<a href="#"><li></li></a> 
```

至

```
<li><a href="#"></a></li> 
```

并设置`a`to`display: block;`和所需的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:15:35.973

将此 HTML 与相同的 css 一起使用

```
<ul>
<a href="#" class="nav"><li id="first">Home</li></a>
<a href="#" class="nav"><li id="second">About
    <ul>                    <a href="#1"><li>Who Am I?</li></a>
        <a href="#2"><li>My Mission</li></a>
        <a href="#3"><li>Portfolio</li></a>
    </ul>
</li></a>
<a href="#" class="nav"><li id="third">Toy Box
    <ul>
        <a href="#"><li>Projects</li></a>
        <a href="#"><li>Toys</li></a>
    </ul>
</li></a>
<a href="#" class="nav" ><li id="fourth">Contact</li></a>
<a <?php if(isset($_SESSION['id'])){ echo "href='editProfile.php'"; }else{ echo "href='login.php'"; } ?> <a href="#" class="nav"><li id="fifth">Account</li></a>
    <?php
    if(!isset($_SESSION['id'])){
    ?>
    <ul>
        <a href="login.php"><li>Log-In</li></a>
        <a href="register.php"><li>Register</li></a>
    </ul>
    <?php
    }else{
    ?>
    <ul>
        <a href="editProfile.php"><li>Edit Profile</li></a>
        <a href="logout.php"><li>Log-Out</li></a>
    </ul>
    <?php
    }
    ?>
</li></a>
<div class="clear"></div> 
```

# actionscript-3 - 如何阻止孩子增加父母的尺寸？

> ID：15603387
> 
> 赞同：0
> 
> 时间：2013-03-24T20:06:34.520
> 
> 标签：actionscript-3, flash, scale, children, bounding-box

在我的游戏中，我有一个有许多天体的太阳系，它们都是相同的类/电影剪辑，它们的大小由它们的质量决定。当分配一个目标时，该目标成为身体的一个孩子。身体向目标移动，并在到达时移除目标。

这种方法是必不可少的，因为它意味着可以设置航路点并且目标可以绕太阳系运行：因为目标周围的一切都在移动，它也需要移动以保持相对运动，否则你最终会在错误的地方。

问题是距离很远的目标会使身体的边界框变得很大，并且身体会缩小以适应所需的尺寸。我需要的是使目标的位置不影响身体的大小，但我找不到所需的方法/属性，`visible = false`也没有做到这一点。如果有人有解决方案，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:13:22.217

我相信 includeInLayout 可以帮助你。visible=false 不会显示对象，但仍用于布局计算。includeInLayout=false 将从布局计算中删除对象。

# javascript - 在 2 个函数之间切换

> ID：15603390
> 
> 赞同：4
> 
> 时间：2013-03-24T20:06:47.520
> 
> 标签：javascript, jquery, click, toggle

我正在尝试做一个切换功能，所以当你点击一个链接时它会做一件事，而当你再次点击同一个链接时它会做另一件事。我的问题是我使用的是最新版本的 Jquery，并且似乎 toggle-event 已[弃用](http://api.jquery.com/toggle-event/)。

在发现它已被弃用之前，我一直在尝试使用它。

```
$('#edit a').toggle(
     function(){
        editList();
    },
     function(){
        addList();
}); 
```

它在文档中说它已经绑定到点击。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-24T20:20:25.200

一个微型 jQuery 插件：

```
jQuery.fn.clickToggle = function(a,b) {
  var ab = [b,a];
  return this.on("click", function(){ ab[this._tog^=1].call(this); });
};

// USE LIKE:

$("button").clickToggle(function() {   
     console.log("AAA");
}, function() {
     console.log("BBB");
}); // Chain here other jQuery methods to your selector 
```

取自我在这里的回答[https://stackoverflow.com/a/21520499/383904](https://stackoverflow.com/a/21520499/383904)

* * *

还有其他方法可以切换状态/值：

**[现场演示](http://jsbin.com/unozoy/1/edit)**

```
var editAdd = [editList, addList],  // store your function names into array
    c = 0;                          // toggle counter

function editList(){                // define function
   alert('EDIT');
}
function addList(){                 // define function
   alert('ADD');
}

$('#edit a').click(function(e){  
  e.preventDefault();
  editAdd[c++%2]();                 // toggle array index and use as function
                                    // % = Modulo operator
}); 
```

`%`您可以使用
**按位 XOR 运算符** 代替模运算符，`^`例如：`[c^=1]`

* * *

**使用 Array.reverse()**
**[现场演示](http://jsbin.com/unozoy/4/edit)**

```
var editAdd = [editList, addList];

function editList(){
   alert('EDIT');
}
function addList(){
   alert('ADD');
}

$('#edit a').click(function(e){  
  e.preventDefault();
  editAdd.reverse()[0]();
}); 
```

reverse 将在每次单击时反转我们的数组，我们需要做的就是获取 0 索引值`[0]`并运行该函数 name `[0]()`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-24T20:12:57.160

您需要做的就是有一个变量或一个属性来指示要运行的函数，例如，使用自定义`data-switch`属性：

```
$('a').click(function(e){
    e.preventDefault();
    var that = $(this);
    switch (that.data('switch')){
        case 'a':
            // do something in situation 'a'
            console.log('Function one');
            that.data('switch','b');
            break;
        case 'b':
            // do something in situation 'b'
            console.log('Function two');
            that.data('switch','a');
            break;
    }
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/ccntg/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-24T20:30:21.610

短而干净

```
var toggle = [addList, editList];
$('#edit a').click({
  var state = +$(this).data('toggle');
  toggle[state]();
  $(this).data('toggle',(1-state));
  return false;
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-05-22T07:40:38.970

[在这里](https://stackoverflow.com/questions/30386333/binding-two-functions-to-a-button-in-jquery/30386548#30386548)查看我对此的回答

此解决方案创建了一个切换函数，该函数由两个函数组成，每次调用时都会在两者之间交替。

```
var toggle = function (a, b) {
    var togg = false;
    return function () {
        // passes return value back to caller
        return (togg = !togg) ? a() : b();
    };
}; 
```

应用它

```
$('#btn').on('click', toggle (function (){
    return editList();
}, function (){
    return addList();
})); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-24T20:12:40.583

不优雅，但快速修复：

```
$('#edit a').click({
  if($(this).data('toggleState') == 1) {
    toggleState = 0;
    addList();
  }
  else {
    toggleState = 1;
    editList();
  }

  $(this).data('toggleState', toggleState);
  return false;
}); 
```

# javascript - 如何在一页上运行多个版本的 Zepto.js？

> ID：15603391
> 
> 赞同：4
> 
> 时间：2013-03-24T20:07:03.967
> 
> 标签：javascript, node.js, zepto

有人可以解释一下我如何以一种对新手友好的方式为 Zepto.js 制作不同的构建（为了包括触摸支持），因为我在互联网上的任何地方都找不到详细的说明。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-24T20:18:05.297

这应该可以工作，就像 jQuery 一样：

```
<script src="zepto1.0.js"></script>
<script>
    var zep10 = window.Zepto;
</script>

<script src="zepto0.8.js"></script>
<script>
    var zep08 = window.Zepto;
</script> 
```

Zepto 不需要“编译”。它只需要放入一个变量中，就像 jQuery 和 MooTools`$`默认放入的一样。`$`如果您愿意，也可以将最常用的 Zepto 版本设置为：

```
<script src="zepto1.0.js"></script>
<script>
    var $ = window.Zepto;
</script> 
```

从那时起，您需要从这些对象触发您的命令。

对于版本`1.0`，您只需使用您的正常`$.()`操作。但是对于`0.8`您将`zep08.()`用来调用操作的版本。

**笔记**

从 Zepto 主页 ( [http://zeptojs.com](http://zeptojs.com) )：

> 如果尚未定义，Zepto 只会将 $ 全局设置为自身。没有 Zepto.noConflict 方法。

因此，如果您已经加载了 jQuery 或 MooTools，它不会破坏`$`绑定，只要您在 Zepto 之前加载了这些库。否则你仍然会被覆盖。

**测试**

还要检查一下：http: [//jsperf.com/qwery-vs-jquery-vs-mootools-selector-engines/11](http://jsperf.com/qwery-vs-jquery-vs-mootools-selector-engines/11)。在 Chrome 和 Safari 上，jQuery 从 Zepto 大获全胜。因此，Zepto 的“初始负载”可能会更轻，但 jQuery 似乎在性能方面胜出。

我已经`Safari 6.0.3 on Mac OS X 10.8.3`用这些结果进行了测试：

吉什/身份证

*   Jeesh("#n-contents");
*   40,136 | ±3.78% | 慢 95%

jQuery/ID

*   jQuery("#n-contents");
*   765,799 | ±4.36% | 最快的

泽普托/ID

*   Zepto("#n-contents");
*   348,956 | ±4.89% | 慢 55%

吉什/类

*   Jeesh(".firstHeading");
*   40,748 | ±3.96% | 慢 95%

jQuery/类

*   jQuery(".firstHeading");
*   306,591 | ±4.31% | 慢 60%

Zepto/类

*   Zepto(".firstHeading");
*   284,822 | ±3.92% | 慢 63%

# android - Phonegap：“processMessage failed”无法发送 javascript 函数 (Cordova 2.5.0)

> ID：15603395
> 
> 赞同：2
> 
> 时间：2013-03-24T20:07:39.677
> 
> 标签：android, cordova, phonegap-plugins, google-cloud-messaging

我试图让 GCM 推送通知在我的应用程序中工作，因此我使用这个项目（[https://github.com/marknutter/GCM-Cordova](https://github.com/marknutter/GCM-Cordova)）作为示例。

当我运行示例代码时，一切正常，但是当我传输所有必需的文件并编辑我的代码以使其在我自己的应用程序中工作时，它不再工作了。我还尝试了以下插件（[https://github.com/phonegap-build/PushPlugin](https://github.com/phonegap-build/PushPlugin)），在自动安装后它给出了完全相同的错误。

该应用程序不会崩溃，但是当我调用注册函数时，我的回调函数“onNotificationGCM”没有收到任何消息。

**注册功能：**

```
window.plugins.GCM.register("my_gcm_id", "onNotificationGCM", successHandler, errorHandler ); 
```

经过一些调试后，我发现原生 android 代码能够注册手机并且确实从 GCM 服务器获得了 ID 消息，但它无法将其发送到我的 javascript。

**原生安卓代码：**

```
public static void sendJavascript( JSONObject _json )
{
  String _d =  "javascript:"+gECB+"(" + _json.toString() + ")";
      Log.v(ME + ":sendJavascript", _d);

      if (gECB != null ) {
        gwebView.sendJavascript( _d );
      }
} 
```

**LogCat 给出以下“失败”消息：**

```
03-24 17:05:21.844: V/GCMPlugin:sendJavascript(31782): javascript:onNotificationGCM({"regid":"APA91bHX...31ASD","event":"registered"})

03-24 17:05:22.834: D/CordovaLog(31782): processMessage failed: Message: Jjavascript:onNotificationGCM({"regid":"APA91bHX...31ASD","event":"registered"}) 
```

消息前面的大写**J**很奇怪，也许这就是导致问题的原因，但它似乎发生在 Cordova 2.5.0 代码的某个地方。

有谁知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-06T14:33:35.403

尝试添加

```
window.onNotificationGCM = onNotificationGCM; 
```

更改函数的上下文

它为我解决了问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-10T08:24:44.857

我有同样的问题。据我了解，经过一些调试后，我的字符串末尾有一个不需要的换行符“\n”，这是我不负责的，似乎电话间隙添加了这个字符。所以我所做的是`.replace("\n", "")`代码的Java部分的字符串。

> String js = "javascript:displayTextMessage('" + date.toString() + " - " + msg.replace("\n", "") + "');" ; 发送Javascript（js）；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T12:31:33.773

这不是 Cordova 2.5.0 错误！如果您从“CORDOVA_GCM_script.js”示例中复制并粘贴，您将拥有如下内容：

```
case 'registered':
    // the definition of the e variable is json return defined in GCMReceiver.java
    // In my case on registered I have EVENT and REGID defined
    gApp.gcmregid = e.regid;
    if ( gApp.gcmregid.length > 0 )
    {
      $("#app-status-ul").append('<li>REGISTERED -> REGID:' + e.regid + "</li>");

      // ==============================================================================
      // ==============================================================================
      // ==============================================================================
      //
      // This is where you would code to send the REGID to your server for this device
      //
      // ==============================================================================
      // ==============================================================================
      // ==============================================================================

    }

    break 
```

确保在脚本中声明了“gApp”数组和“gcmregedit”变量，或者不要在事件处理程序中使用它们。否则，由于之前发生的“未定义”错误，您将收到“processMessage failed”-消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-20T17:59:35.110

检查您的代码是否有任何不正确的 JSON.parse ......这些“非法访问”等错误消息似乎在 JSON.parse(not_a_json_string) 发生时被抛出。

# java - 过滤文件名

> ID：15603396
> 
> 赞同：3
> 
> 时间：2013-03-24T20:07:40.987
> 
> 标签：java, regex, filenames

我在用 Java 过滤文件名时遇到了很多问题。我正在使用 PrimeFaces fileUpload 标签，如果文件仅包含字母数字字符后跟扩展名，例如“.txt”，则我需要允许可以上传的文件。具体来说，在扩展名前，名称必须包含AZ、az或0-9中的一个或多个，不能有空格或其他字符，后跟扩展名“.txt”，即必须有一个，并且只有一个“。” 在名称中，并且必须在扩展名的开头。

到目前为止，过滤名称的所有尝试都没有正确解决，如果我 exclude `.`，那么它也被排除在扩展之外。文件名的类型应为：`abcXYZ123.txt`、、`aaaccc001.txt`等，但不是`ab.cd.txt`等。

我尝试了 , , 等的各种组合`/[A-Za-z0-9]+\\.txt$/`，`/[^\\W_]+\\.txt$/`但`/[\\p{Alnum}]\\.txt$/`它们要么允许某些无效名称，要么排除某些有效名称。

一些帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:13:26.467

我认为你在最后的正确轨道上`$`。我会在开始时将它与插入符号匹配`^`以获得

```
^[A-Za-z0-9]+\\.txt$ 
```

正如`$`“行尾”的意思一样，也意味着“行`^`的开始”。

使用 regex[对此进行测试](http://regexpal.com/)`^[A-Za-z0-9]+\.txt$`，我得到：

**火柴**

*   `a.txt`
*   `abcXYZ123.txt`
*   `aaccc001.txt`

**无匹配**

*   `a.b.c.txt`
*   `ab.cd.txt`
*   `.txt`

附带说明一下，根据您的正则表达式实现，alnum 可能等于也可能不等于`[A-Za-z0-9]`——它可能包含来自其他编号系统的数字（例如六，在中文中是六）。

# gestures - 带有手势的 cocos3d 广告牌平移

> ID：15603403
> 
> 赞同：2
> 
> 时间：2013-03-24T20:08:06.830
> 
> 标签：gestures, cocos3d

我想使用手势来平移广告牌，我该怎么做，我已经修改了 DemoMashUp，如下所示：

```
 - (void)dragBy: (CGPoint) aMovement atVelocity: (CGPoint) aVelocity
{
     if (selectedNode == dieCube || selectedNode == texCubeSpinner) {
         [self rotate: ((SpinningNode*)selectedNode) fromSwipeVelocity: aVelocity];
     }

     if (selectedNode==marker) {
         [self moveSelectedNode:marker fromSwipeMovement:aMovement];
     }
 }

- (void)stopDragging
{
    selectedNode = nil;
}

 - (void)moveSelectedNode:(CC3Billboard*) aNode fromSwipeMovement: (CGPoint) swipeMovement
{
     aNode.location=cc3v(swipeMovement.x, swipeMovement.y, aNode.location.z);
} 
```

但它不起作用，当我触摸广告牌时它消失了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T15:03:42.583

我制作了一个新方法 moveSelectedNode "DemoMashUpScene"，如下所示：

```
 -(void) touchEvent: (uint) touchType at: (CGPoint) touchPoint {
    NSLog(@"\n\n*******************TOUCH EVEN CALLED************************\n\n");

    switch (touchType) {
        case kCCTouchBegan:
            [self pickNodeFromTouchEvent: touchType at: touchPoint];
            break;
        case kCCTouchMoved:

        if (selectedNode==marker||selectedNode==marker1||selectedNode==marker2||selectedNode==marker3||selectedNode==marker4||selectedNode==marker5)
            {

               [self moveSelectedNode:marker1 fromSwipeMovement:touchPoint];

            }
            break;
        case kCCTouchEnded:

            selectedNode = nil;
            break;
        default:
            break;
    }

    lastTouchEventPoint = touchPoint;
    lastTouchEventTime = now;
}

-(void) moveSelectedNode: (CC3Billboard*) aNode fromSwipeMovement: (CGPoint) swipeMovement {

    CC3Vector vector=    CC3VectorMake(swipeMovement.x * 3, swipeMovement.y * 3, 0);
    aNode.location=cc3v(aNode.location.x, aNode.location.y, 0.0);
    aNode.location=CC3VectorAdd(aNode.location,vector);    
    CCLOG(@"%@",aNode.name);
//    NSLog(@"\n\n ******MOVING****%f_____%f*****____%f",vector.x,vector.y,vector.z);

} 
```

# ruby - Ruby：Resque 立即排队

> ID：15603409
> 
> 赞同：1
> 
> 时间：2013-03-24T20:08:39.770
> 
> 标签：ruby, web, redis, sinatra

我有以下代码。它的工作是根据通过浏览器（使用 Sinatra）提供的数据发送电子邮件。它会在 20 秒后向给定的地址发送一封电子邮件。当我运行程序时，它会立即发送电子邮件，而无需等待时间。谁能帮我解决这个问题。

```
require 'rubygems'
require 'sinatra'
require 'pony'
require 'resque'
require 'resque_scheduler'
require 'active_support/time'

Resque.redis = 'localhost:6379'
Resque::Scheduler.dynamic = true

def sendMail

Pony.mail({
  :to => 'eldurotaduro@gmail.com',
  :via => :smtp,
  :via_options => {
    :address              => 'smtp.gmail.com',
    :port                 => '587',
    :enable_starttls_auto => true,
    :user_name            => 'EMAIL',
    :password             => 'PASSWD',
    :authentication       => :plain, # :plain, :login, :cram_md5, no auth by default
    :domain               => "localhost.localdomain" # the HELO domain provided by the            client to the server
  },
   :body => 'roar'
})

end

class Roar
    def self.queue; :app; end
end

class ChildJob 

@message
@email

def setMess(mes)
    @message = mes
end

def setMail(mail)
    @email = mail
end

def self.queue; :app; sendMail; end

def self.perform
  Pony.mail({
  :to => 'eldurotaduro@gmail.com',
  :via => :smtp,
  :via_options => {
    :address              => 'smtp.gmail.com',
    :port                 => '587',
    :enable_starttls_auto => true,
    :user_name            => 'EMAILHERE@gmail.com',
    :password             => 'PASSWD',
    :authentication       => :plain, # :plain, :login, :cram_md5, no auth by default
    :domain               => "localhost.localdomain" # the HELO domain provided by the client to the server
  },
   :body => 'HAHAH'
})
end

end

get '/:email/:message/:time' do

email = params[:email]
message = params[:message]
time = params[:time]
time = time.to_i

Resque.enqueue_in(20.seconds, ChildJob)

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T04:17:15.943

保留`:app`符号，`self.queue`因为这是设置默认队列的原因（请参阅[此 StackOverflow 答案](https://stackoverflow.com/a/9283176/335847)）。将它`sendMail`放入一个`self.perform`方法中，因为这是您在满足时间表时想要完成的事情。例如

```
def self.queue
  :app
end

def self.perform
  sendMail
end 
```

# python - 具有多个“for”子句和单个“if”的python理解

> ID：15603410
> 
> 赞同：6
> 
> 时间：2013-03-24T20:08:41.573
> 
> 标签：python, python-3.x

想象一个离散的 x,y,z 空间：我正在尝试创建一个迭代器，它将返回位于距某个点有一定径向距离的球体内的所有点。

我的方法是首先查看一个较大的立方体中的所有点，该立方体保证包含所有需要的点，然后剔除或跳过距离太远的点。

我的第一次尝试是：

```
x,y,z=(0,0,1)
dist=2
#this doesn't work
it_0=((x+xp,y+yp,z+zp) for xp in range(-dist,dist+1) for yp in range(-dist,dist+1) for zp in range(-dist,dist+1) if ( ((x-xp)**2+(y-yp)**2+(z-zp)**2) <= dist**2+sys.float_info.epsilon ) ) 
```

一个简单的

```
for d,e,f in it_0:
    #print(d,e,f)
    print( ((x-d)**2+(y-e)**2+(z-f)**2) <= dist**2+sys.float_info.epsilon,  d,e,f) 
```

验证 it_0 不会产生正确的结果。我相信它仅将条件应用于第三个（即：z）“for”子句

以下作品：

```
it_1=((x+xp,y+yp,z+zp) for xp in range(-dist,dist+1) for yp in range(-dist,dist+1) for zp in range(-dist,dist+1))
it_2=filter( lambda p: ((x-p[0])**2+(y-p[1])**2+(z-p[2])**2) <= dist**2+sys.float_info.epsilon, it_1) 
```

它收集所有点，然后过滤那些不符合条件的点。

我希望有一种方法可以纠正第一次尝试的实现，或者使这些表达式更具可读性或更紧凑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:23:54.840

您在生成器表达式中混淆了 xp、yp、zp 的含义：

```
it_0=((x+xp,y+yp,z+zp) for xp in range(-dist,dist+1) for yp in range(-dist,dist+1) for zp in range(-dist,dist+1) if ( ((x-xp)**2+(y-yp)**2+(z-zp)**2) <= dist**2+sys.float_info.epsilon ) ) 
```

xp、yp 和 zp 已经是沿各个轴距球心的距离。因此，您不应该再次从 x、y、z 中获取差异。表达式应该是：

```
it_0=((x+xp,y+yp,z+zp) for xp in range(-dist,dist+1) for yp in range(-dist,dist+1) for zp in range(-dist,dist+1) if ( (xp**2+yp**2+zp**2) <= dist**2+sys.float_info.epsilon ) ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-24T21:51:36.680

首先，我建议您将三重嵌套`for`循环替换为`itertools.product()`，如下所示：

```
import itertools as it
it_1 = it.product(range(-dist, dist+1), repeat=3) 
```

如果您使用的是 Python 2.x，则应`xrange()`在此处使用而不是`range()`.

接下来，`filter()`您可以只使用生成器表达式，而不是使用：

```
it_2=(x, y, z for x, y, z in it_1 if ((x-p[0])**2+(y-p[1])**2+(z-p[2])**2) <= dist**2+sys.float_info.epsilon) 
```

这将避免 Python 2.x 中的一些开销（因为`filter()`构建了一个列表），但对于 Python 3.x 来说是差不多的；甚至在 Python 2.x 中你也可以使用`itertools.ifilter()`.

但是为了可读性，我会将整个东西打包成一个生成器，如下所示：

```
import itertools as it
import sys

def sphere_points(radius=0, origin=(0,0,0), epsilon=sys.float_info.epsilon):
    x0, y0, z0 = origin
    limit = radius**2 + epsilon
    for x, y, z in it.product(range(-radius, radius+1), repeat=3):
        if (x**2 + y**2 + z**2) <= limit:
            yield (x+x0, y+y0, z+z0) 
```

我只是从您的原始代码中更改了代码。x、y 和 z 的每个范围都调整为以原点为中心。当我以 0 的半径测试这段代码时，我正确地返回了一个点，即原点。

请注意，我为函数提供了参数，让您可以指定半径、原点，甚至是用于 epsilon 的值，每个参数都有默认值。我还将原点元组解压缩为显式变量；我不确定 Python 是否会优化索引操作，但这样我们就知道循环内不会有任何索引。（我认为 Python 编译器可能会将`limit`计算提升到循环之外，但我实际上更喜欢它在自己的行上，如此处所示，以提高可读性。）

我认为上面的代码和你用原生 Python 写的一样快，而且我认为它在可读性上是一个很大的改进。

PS 如果使用 Cython 重做这段代码，它可能会运行得更快。

[http://cython.org/](http://cython.org/)

编辑：按照@eryksun 在评论中的建议简化代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-24T20:26:06.233

你的使用`epsilon`有点过。sys.float_info 的文档将其描述为 1 和下一个可表示的浮点数之间的差异，因此它太小而无法在 2 上产生差异，更不用说 2**2。

其次，您的所有点都是从过滤器中的 x,y,z 测量的/如果然后在结果表达式中被它偏移`(x+xp,y+yp,z+zp)`。这样你会得到一个相当偏离中心的球体，所以试试`(xp,yp,zp)`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T02:20:14.737

其他人指出了逻辑错误。我将讨论可读性。还要注意给出的数据，不涉及浮点，因此不需要 epsilon。

```
from itertools import product
from pprint import pprint

x,y,z = 0,0,1
r = 2

def points_in_circle(radius):
    '''return a generator of all integral points in circle of given radius.'''
    return ((x,y,z)
            for x,y,z in product(range(-dist,dist+1),repeat=3)
            if x**2 + y**2 + z**2 <= radius**2)

# List integral points of radius r around point (x,y,z).
pprint([(x+xp,y+yp,z+zp) for xp,yp,zp in points_in_circle(r)]) 
```

### 输出

```
[(-2, 0, 1),
 (-1, -1, 0),
 (-1, -1, 1),
 (-1, -1, 2),
 (-1, 0, 0),
 (-1, 0, 1),
 (-1, 0, 2),
 (-1, 1, 0),
 (-1, 1, 1),
 (-1, 1, 2),
 (0, -2, 1),
 (0, -1, 0),
 (0, -1, 1),
 (0, -1, 2),
 (0, 0, -1),
 (0, 0, 0),
 (0, 0, 1),
 (0, 0, 2),
 (0, 0, 3),
 (0, 1, 0),
 (0, 1, 1),
 (0, 1, 2),
 (0, 2, 1),
 (1, -1, 0),
 (1, -1, 1),
 (1, -1, 2),
 (1, 0, 0),
 (1, 0, 1),
 (1, 0, 2),
 (1, 1, 0),
 (1, 1, 1),
 (1, 1, 2),
 (2, 0, 1)] 
```

# facebook - 如何使用 Fb C# Sdk 发布到应用程序的墙上？

> ID：15603411
> 
> 赞同：0
> 
> 时间：2013-03-24T20:08:42.160
> 
> 标签：facebook, facebook-graph-api, facebook-c#-sdk

在一天的大部分时间里，我一直在尝试在我的应用程序的时间线/提要/Fb 墙上发布一些内容，但我一直失败。这越来越令人沮丧。

我正在做的是：我有一个简单的控制台 C# 应用程序，它试图在应用程序的墙上发布一些东西（例如，一个基本的 hello world！）。

此片段显示了我如何检索访问令牌：

```
 private string _AccessToken;
        public string AccessToken
        {
            get
            {
                if (string.IsNullOrEmpty(_AccessToken))
                {
                    //_AccessToken = string.Format("{0}|{1}", Credentials.AppId, Credentials.AppSecret);
                    Logger.Debug("Attempting to retrieve the access token...");
                    dynamic result = ExecuteGet("oauth/access_token", new
                    {
                        client_id = Credentials.AppId, // my app id
                        client_secret = Credentials.AppSecret, // my app secret
                        grant_type = "client_credentials",
                        scope = "manage_pages,publish_actions,publish_stream"
                    }, false);

                    _AccessToken = result.access_token;
                }
                Logger.Debug("Operation succeeded, access token is : {0}", _AccessToken);
                return _AccessToken;
            }
        }

private object ExecuteGet(string path, object parameters)
        {
            return ExecuteGet(path, parameters, true);
        }

        private object ExecuteGet(string path, object parameters, bool useAccessToken)
        {
            try
            {
                Logger.Debug("Executing GET : {0}", path);
                var client = useAccessToken ? new FacebookClient(AccessToken) : new FacebookClient();
                return client.Get(path, parameters);
            }
            catch (FacebookApiException ex)
            {
                Logger.Error("GET Operation failed : {0}", ex.Message);
                throw;
            }
        } 
```

这就是我试图实际发布内容的方式：

```
public void PostToApplicationWall(string message)
        {
            string path = string.Format("/{0}/feed", Credentials.AppId);
            IDictionary<string, object> parameters = new Dictionary<string, object>()
            {
                { "description", "[DESCRIPTION] Facebook description..." },
                { "link", "http://tinyurl.org" },
                { "name", "[NAME] Facebook name..." },
                { "caption", "[CAPTION] Facebook caption..." },
                { "message", message }
            };

            dynamic result = ExecutePost(path, parameters);
        }

private object ExecutePost(string path, object parameters)
        {
            try
            {
                Logger.Debug("Executing POST : {0}", path);
                var client = new FacebookClient(AccessToken);
                return client.Post(path, parameters);
            }
            catch (FacebookApiException ex)
            {
                Logger.Error("POST Operation failed : {0}", ex.Message);
                throw;
            }
        } 
```

请注意 ExecutePost() 使用 AccessToken 属性，我已经粘贴在开头。

我收到的消息是：**(OAuthException - #210) (#210) Subject must be a page**

请帮忙，我不知道我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T08:30:09.710

应用资料页面自 2012 年 2 月 1 日起停用。您必须创建应用页面。[在这里](https://developers.facebook.com/blog/post/611/)阅读。

现在，当您有一个应用程序页面时，您可以像这样更改代码：

```
string path = string.Format("/{0}/feed", Credentials.PageId); 
```

或者

```
string path = string.Format("/{0}/feed", Credentials.PageUsername); 
```

[编辑]要发布到页面，您需要页面访问令牌而不是应用访问令牌。[在此处](https://developers.facebook.com/docs/howtos/login/login-as-page/)阅读有关如何获取页面访问令牌的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:49:24.910

Maciek，如果您真的只想发布到自己的页面，那么编写一个独立的应用程序可能不是最简单的方法。你试过 PowerShell 和[http://facebookpsmodule.codeplex.com](http://facebookpsmodule.codeplex.com)吗？该模块将为您处理权限，并让您使用简单的脚本执行此操作。

# assembly - 对齐VS。不结盟的澄清

> ID：15603415
> 
> 赞同：3
> 
> 时间：2013-03-24T20:09:14.753
> 
> 标签：assembly

我正在介绍嵌入式系统课程，并且在掌握对齐与未对齐内存的概念时遇到了一些困难。

我们主要使用汇编级编程。

好的，这就是我目前所理解的：对齐用于指定汇编程序将使用的指令，即所有数据的长度相同。它的全字长或半字长或双字长。

未对齐意味着数据未定义为任何特定长度。

这个对吗？未对齐与对齐的意义是什么？与另一种相比，一个人何时会从使用其中受益？

对于新手的问题，我深表歉意。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-24T22:22:54.353

4 字节对齐或 32 位对齐意味着地址是 4 字节的整数倍，例如 0x000、0x004、0x008、0x00C 等。另一种查看方式是 4 = 2 的 2 次方，因此低两个地址位需要为零以对齐。8 字节对齐，64 位，8 = 2 的 3 次方，因此低 3 位需要为零才能与 8 字节对齐。2 字节，2 的 1 次方，因此偶数地址对齐，奇数地址未对齐，用于 2 字节传输。基于字节的传输总是对齐的，没有问题。（2 的 0 次方，0 位需要为零才能对齐）。

所有系统都会对未对齐的传输进行处罚，有些系统比其他系统更严重。RISC 平台的性能特征之一是阻止或防止未对齐的传输，因此 MIPS、ARM 等属于更严厉的惩罚类别（以防止它们一起出现）。ARM 现在有内存控制器，允许未对齐的传输而无需旋转或任何奇怪的东西，不确定 MIPS。作为一般规则，尽管您应该尽量避免未对齐的传输，无论您使用什么系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-24T20:32:55.697

内存对齐是指数据在地址空间中的放置。

例如，其两个最低有效位被清除（即 4 的倍数）的地址将在 32 位字系统上进行*字对齐。*类似地，最低有效位清除的地址是半字对齐的。如果某些数据的地址未与指令、数据总线或其他因素所需的任何边界对齐，则它是*未对齐*的。

一些处理器（例如 ARM）要求数据与数据的大小对齐（一个字应该是字对齐的，等等）。尝试访问未对齐的数据可能会导致数据旋转或未定义的行为。
其他处理器可能允许未对齐的内存访问并在内部处理它们，但由于额外的内存访问而导致性能损失。

# ruby-on-rails - MailerFormError:Class 的未定义方法“deliver_sent”

> ID：15603423
> 
> 赞同：0
> 
> 时间：2013-03-24T20:09:53.657
> 
> 标签：ruby-on-rails, ruby-on-rails-3, actionmailer, ruby-on-rails-2

我正在将 rais 2.3.2 项目升级到 rails 3

错误：

```
 undefined method `deliver_sent' for MailerFormError:Class
Application Trace | Framework Trace | Full Trace
app/controllers/leads_controller.rb:72:in `block in create'
app/controllers/leads_controller.rb:56:in `create' 
```

MailerFormError 是我的模型： `class MailerFormError < ActionMailer::Base`

在模型和 Actionmailer::Base 中也没有方法 'deliver_sent' :(

在控制器中使用它的代码：

```
 @msg = {}
    @msg["errors"] = @lead.errors
    @msg["params"] = params
    MailerFormError.deliver_sent(@msg) 
```

Actionmailer 版本：actionmailer (3.2.11)

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T22:00:51.833

发送电子邮件在 2.3 和 3.2 之间发生了很大变化。这是一个基本的操作方法：http: [//xyzpub.com/en/ruby-on-rails/3.2/action_mailer.html](http://xyzpub.com/en/ruby-on-rails/3.2/action_mailer.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T22:49:27.733

1) 对于 Rails 3，要在控制器中发送通知，我会这样写：

```
 MailerFormError.sent(@msg).deliver 
```

2）我用 Rails 3 方式重写你的“发送”方法：

```
 def sent(msg, sent_at = Time.now)
      ...
      mail(:to => '...', :from => '...', :subject => '...') do |format|
        format.html
        format.text
      end
      ...
    end 
```

最后，我在您的视图目录 app/views/mail_form_error 中创建文本版本和 html：send.text.erb 和 sent.html.erb

# java - 线程的客户端/服务器问题。端口已绑定

> ID：15603424
> 
> 赞同：1
> 
> 时间：2013-03-24T20:10:01.507
> 
> 标签：java

我必须创建一个由服务器和 4 个客户端组成的分布式系统，服务器有一个文件，所有客户端不能同时读取，而只有一个可以写入。每个客户端随机选择是读取文件的内容还是写入文件的内容。

如果客户端选择写入，它会生成一个介于 0 和 911 之间的随机数，该随机数会写入到服务器提供给客户端的文件中。当随机数为 100 时，客户端与服务器断开连接。您必须实施适当的机制以使服务器能够同步客户端。

这是错误：

```
Error during I/O
Error during I/O java.net.BindException: Address already in use:
JVM_Bind    at java.net.DualStackPlainSocketImpl.bind0(Native Method)
    at java.net.DualStackPlainSocketImpl.socketBind(Unknown Source)     at
java.net.AbstractPlainSocketImpl.bind(Unknown Source)   at
java.net.PlainSocketImpl.bind(Unknown Source)   at
java.net.ServerSocket.bind(Unknown Source)  at
java.net.ServerSocket.<init>(Unknown Source)    at
java.net.ServerSocket.<init>(Unknown Source)    at
My_Thread.run(My_Thread.java:18) java.net.BindException: Address
already in use: JVM_Bind    at
java.net.DualStackPlainSocketImpl.bind0(Native Method)  at
java.net.DualStackPlainSocketImpl.socketBind(Unknown Source)    at
java.net.AbstractPlainSocketImpl.bind(Unknown Source)   at
java.net.PlainSocketImpl.bind(Unknown Source)   at
java.net.ServerSocket.bind(Unknown Source)  at
java.net.ServerSocket.<init>(Unknown Source)    at
java.net.ServerSocket.<init>(Unknown Source)    at
My_Thread.run(My_Thread.java:18) Waiting Incoming Connection... Local
Address :0.0.0.0/0.0.0.0 Port :5555 Error during I/O
java.net.SocketException: Connection reset  at
java.net.SocketInputStream.read(Unknown Source)     at
java.net.SocketInputStream.read(Unknown Source)     at
sun.nio.cs.StreamDecoder.readBytes(Unknown Source)  at
sun.nio.cs.StreamDecoder.implRead(Unknown Source)   at
sun.nio.cs.StreamDecoder.read(Unknown Source)   at
java.io.InputStreamReader.read(Unknown Source)  at
java.io.BufferedReader.fill(Unknown Source)     at
java.io.BufferedReader.readLine(Unknown Source)     at
java.io.BufferedReader.readLine(Unknown Source)     at
Server.main(Server.java:34) 
```

这是代码：

服务器

```
 import java.net.*;
    import java.util.Scanner;
    import java.io.*;

    public class Server {
    public static void main(String[] args) {
        My_Thread t1=new My_Thread();
        My_Thread t2=new My_Thread();
        t1.start(); 
        t2.start(); 

    try{

    ServerSocket server = new ServerSocket(5555,50);
    System.out.println("Waiting Incoming Connection...");
    System.out.println("Local Address :"+server.getInetAddress()+" Port :"+server.getLocalPort());
    Socket sock = server.accept();
    BufferedReader instream = new BufferedReader (new InputStreamReader (sock.getInputStream()));
    BufferedWriter outstream = new BufferedWriter(new OutputStreamWriter(sock.getOutputStream()));
    FileWriter file = null; 
    int number=0;
    try
    {  
          file = new FileWriter("C://Users//Vagos//Desktop//file.txt");  

    }
    catch(IOException ex)
    {
          System.out.println("File Error");
    }

    Scanner scanner = new Scanner(new File("file.txt"));

    String strin = instream.readLine(); <---and heare
    if (strin.equals("Insert")){ //following the protocol

    do{
    //strin = instream.readLine();
    //outstream.write(strin+"\n");
    //outstream.flush();
    number = instream.read();
    file.write(new Integer(number).toString());
    file.write("   ");
    file.flush();
    }while(number!=100); //bye = terminate the conversation
    }else if(strin.equals("Read") ){

        while(scanner.hasNextInt()){
                   outstream.write(scanner.nextInt());
                   outstream.flush();
                }
    }else { 
    System.out.println("Connection Closing...");
    }
    instream.close();
    outstream.close();
    file.close();
    sock.close();
    }catch (Exception ex){
    System.out.println("Error during I/O");
    ex.getMessage();
    ex.printStackTrace();
    }}}

client

    import java.net.*;
    import java.io.*;
    import java.util.Random;
    import java.util.Scanner;
    public class client {

    public static void main(String[] args) {

    try{

    Socket sock = new Socket("localhost", 5555);
    BufferedReader instream = new BufferedReader (new InputStreamReader(sock.getInputStream()));
    BufferedWriter outstream = new BufferedWriter(new OutputStreamWriter(sock.getOutputStream()));
    System.out.println("Sending Messages to the Server...");
    System.out.println("Connecting to "+ sock.getInetAddress()+ " and port "+sock.getPort());
    System.out.println("Local Address :"+sock.getLocalAddress()+" Port :"+sock.getLocalPort());
    Random random = new Random(System.currentTimeMillis());
    String strin, strout;
    int number=0,choice=0;;
    choice=random.nextInt(2);
    System.out.println("choice "+choice);
    if(choice==1){
    outstream.write("Insert\n");
    outstream.flush();

    do{
    number=random.nextInt(911);
    System.out.print(number);
    outstream.write(number);
    outstream.flush();
    }while (number!=100);

    }else if(choice==2){
    outstream.write("Read\n");
    outstream.flush();

    do{
    number=instream.read();
    System.out.println(number);

    }while (true);
    }

        }catch (Exception ex){
    System.out.println("Connection Refused!!!");
    }
    }
    }

My_Thread

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.Scanner;

public class My_Thread extends Thread{
    public void run(){

        try{

            ServerSocket server = new ServerSocket(5555,50); <---heare
            System.out.println("Waiting Incoming Connection...");
            System.out.println("Local Address :"+server.getInetAddress()+" Port :"+server.getLocalPort());
            Socket sock = server.accept();
            BufferedReader instream = new BufferedReader (new InputStreamReader (sock.getInputStream()));
            BufferedWriter outstream = new BufferedWriter(new OutputStreamWriter(sock.getOutputStream()));
            FileWriter file = null; 
            int number=0;
            try
            {  
                  file = new FileWriter("C://Users//Vagos//Desktop//file.txt");  

            }
            catch(IOException ex)
            {
                  System.out.println("File Error");
            }

            Scanner scanner = new Scanner(new File("file.txt"));

            String strin = instream.readLine();
            if (strin.equals("Insert")){ //following the protocol

            do{
            //strin = instream.readLine();
            //outstream.write(strin+"\n");
            //outstream.flush();
            number = instream.read();
            file.write(new Integer(number).toString());
            file.write("   ");
            file.flush();
            }while(number!=100); //bye = terminate the conversation
            }else if(strin.equals("Read") ){

                while(scanner.hasNextInt()){
                           outstream.write(scanner.nextInt());
                           outstream.flush();
                        }
            }else { 
            System.out.println("Connection Closing...");
            }
            instream.close();
            outstream.close();
            file.close();
            sock.close();
            }catch (Exception ex){
            System.out.println("Error during I/O");
            ex.getMessage();
            ex.printStackTrace();
            }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T21:12:08.433

您只能从您的程序绑定到一个端口一次（除非您设置了特定的套接字选项`SO_REUSEADDRESS`，但暂时忽略它）。目前，您正尝试将一个进程绑定到同一个端口三次 - 一次在您的 for 循环中，一次用于您启动的两个线程。我不完全确定你为什么要启动三个服务器进程，但你会想要重新审视你的设计并确保你只绑定一次服务器端口。

* * *

***编辑***：

我要做的是从 main 方法中删除 try/catch 逻辑，然后只生成***一个***线程：

```
public static void main(String[] args) {
    My_Thread t1 = new My_Thread();
    t1.start();
} 
```

# java - 如何在 Linux 上通过 java 加速 VirMIDI (MIDI) 端口检测和音序器创建

> ID：15603429
> 
> 赞同：2
> 
> 时间：2013-03-24T20:10:48.347
> 
> 标签：java, linux, kernel, midi, openjdk

我安装了 snd-virmidi 内核模块，以便在 java 中拥有虚拟 MIDI 端口。多亏了这些 MIDI 端口，java 可以在 Linux 上连接非 java MIDI 软件合成器。

但是，openjdk 需要很长时间才能检测到这些虚拟 MIDI 端口……而且，它检测到一长串虚拟端口，而“aconnect”命令行告诉我只有 4 个虚拟端口……

我在 impro-visor（java 软件）和我当前的开发（一个 MIDI 应用程序）中观察到了这种行为。

我在 Ubuntu 12.04 上使用 openjdk 7。

这是我用来测试不同关键 MIDI 方法的时间响应的代码：

```
public static void main(String[] args) throws Exception {
    long start = new Date().getTime();
    Sequencer sequencer = MidiSystem.getSequencer(true);
    long end = new Date().getTime();
    System.out.println("getSequencer true end : " + (end - start) + " ms");

    start = new Date().getTime();
    sequencer = MidiSystem.getSequencer(false);
    end = new Date().getTime();
    System.out.println("getSequencer false end : " + (end - start) + " ms");

    start = new Date().getTime();
    List<String> outputDeviceList = new ArrayList<String>();

    // Obtain information about all the installed synthesizers.
    MidiDevice.Info[] infos = MidiSystem.getMidiDeviceInfo();

    // Scan all found devices and check to see what type they are
    MidiDevice device = null;
    for (MidiDevice.Info info : infos) {
        try {
            device = MidiSystem.getMidiDevice(info);
        } catch (MidiUnavailableException e) {
            continue;
        }
        if (device instanceof Synthesizer) {
            outputDeviceList.add(info.getName());
            continue;
        }
        if (!(device instanceof Synthesizer)
                && !(device instanceof Sequencer)) {
            // The device is an instance of a hardware Midi port.
            int numReceivers = device.getMaxReceivers();

            if (numReceivers != 0) {
                outputDeviceList.add(info.getName());
            }
        }
    }
    end = new Date().getTime();
    System.out.println("getAllOutputDevice end : " + (end - start) + " ms");
} 
```

上面的代码已经在带有 openjdk 的 i3 intel 处理器（Ubuntu 12.04）上运行：

```
java version "1.7.0_15"
OpenJDK Runtime Environment (IcedTea7 2.3.7) (7u15-2.3.7-0ubuntu1~12.04.1)
OpenJDK Server VM (build 23.7-b01, mixed mode) 
```

并给出以下输出：

```
getSequencer true end : 20811 ms
getSequencer false end : 6945 ms
getAllOutputDevice end : 13933 ms 
```

卸载 snd-virmidi 内核模块后，结果是：

```
getSequencer true end : 412 ms
getSequencer false end : 5 ms
getAllOutputDevice end : 11 ms 
```

有没有办法加快 java 虚拟 MIDI 端口检测和音序器初始化过程？

# android - 从浏览器的共享意图访问选定的文本和 URL

> ID：15603433
> 
> 赞同：1
> 
> 时间：2013-03-24T20:11:03.340
> 
> 标签：android, android-intent

在 Android 股票浏览器、Chrome 和大多数其他浏览器应用程序中，选择页面上的文本会显示一个上下文操作栏。除了文本工具，它还包含一个共享功能，可以将文本选择发送到其他应用程序，可能使用`sendIntent.putExtra(Intent.EXTRA_TEXT, "Selected text")`.

我的问题：已注册该发送意图的应用程序（使用`<intent-filter/>`）是否可以访问从中提取文本的网站的 URL？换句话说，URL 是作为`EXTRA_...`意图传递的吗？

当然，可以编写一个测试应用程序并检查[此处](http://developer.android.com/reference/android/content/Intent.html#EXTRA_ALARM_COUNT)列出的所有通过的附加功能。但我希望有一些见解或替代方法将选定的文本*和*URL 从浏览器（至少从股票浏览器）发送到另一个应用程序。
这将是一个非常有用的功能，例如在社交网络应用程序中分享报价，同时自动链接来源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:21:49.193

> 我的问题：已注册该发送意图的应用程序（使用 ）是否可以访问从中提取文本的网站的 URL？换句话说，URL 是否在意图中作为 EXTRA_... 传递？

*   我知道除了`EXTRA_TEXT`任何浏览器之外没有记录和支持的附加功能

*   AOSP 浏览器应用程序的源代码没有显示任何被添加到的`Intent`东西`EXTRA_TEXT`

*   欢迎您转储`Intent`附加功能`Bundle`并针对您想要的任何给定浏览器检查它们，以查看包含的内容，但不能保证将来是否会提供未记录的附加功能

# php - 将 Facebook 公共帖子从页面获取到 php 数组

> ID：15603434
> 
> 赞同：9
> 
> 时间：2013-03-24T20:11:11.657
> 
> 标签：php, facebook-graph-api

我只需要一个将公共帖子从 facebook 页面收集到 PHP 数组的代码示例。

我已经创建了一个应用程序，所以我有应用程序 ID/API 密钥和应用程序密钥。

例如，假设我想从 Facebook 获取所有 stackoverflow 公开帖子。我发现 stackoverflow 的 facebook 页面 id 是“11239244970”，但是现在，我如何获取他们所有的公开帖子？

```
$appKey = '635000000000874';
$appSecret = '567xxxxxxxxxxxxxxxxxxxxxxxxxx3e6';
$fbPage = '11239244970';
$publicFeed = array(); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-24T20:18:02.723

您对 PAGE_ID/feed 执行 HTTP GET

`HTTP GET https://graph.facebook.com/11239244970/feed?access_token=YOUR_ACCESS_TOKEN`

[https://developers.facebook.com/docs/reference/api/page/#feed](https://developers.facebook.com/docs/reference/api/page/#feed)

在 PHP 中，它可以是基本的

```
$data  = file_get_contents("https://graph.facebook.com/573948779291487/feed?access_token=YOUR_ACCESS_TOKEN");
$data = json_decode($data, true); 
```

或者您可以使用 PHP SDK。

```
$publicFeed = $facebook->api('/573948779291487/feed'); 
```

要仅获取页面自己的帖子而不获取喜欢页面的粉丝，请使用`/posts`端点。

# php - 在嵌套循环中引用外部循环变量

> ID：15603435
> 
> 赞同：-2
> 
> 时间：2013-03-24T20:11:14.317
> 
> 标签：php, loops, while-loop, nested-loops

我希望下面的代码循环遍历两个不同的 mysql 表。外部 while 循环应该打印一个产品列表，每个表行都是一个新产品。内部 while 循环应打印该产品的每个列变量。内部循环设置为查看 $tableheaders 以获取有关打印哪些列的指导。

内部循环是用外部循环数组中的内容回显表格单元格，内部循环数组指定它应该查看外部数组中的哪一列。

这是我的代码；

```
$tableheaders=mysql_query("SELECT * from `winetable`");

$products=mysql_query("SELECT * FROM `wines`");

while ($row=mysql_fetch_assoc($products)){
    echo '<tr>';
            while ($rowi=mysql_fetch_assoc($tableheaders)){
            $column=$rowi['Title'];
            echo '<td>';
            echo $row[$column];
            echo '</td>';
        }
    echo '</tr>';
    } 
```

它所做的只是变成空白。

现在不使用 mySQLi，因为我的 WebMatrix 在使用它时遇到了一些问题。我认为我的 MySQL 安装已损坏 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T21:08:44.097

请阅读以下代码以了解我将如何调试您的代码。我还意识到您需要使用 mysql_data_seek() 重置其中一个数组：

```
$tableheaders=mysql_query("SELECT * from `winetable`");
$products=mysql_query("SELECT * FROM `wines`");

//check the number of results before looping
if(mysql_num_rows($tableheaders) > 0 && mysql_num_rows($products) > 0){

    while ($row=mysql_fetch_assoc($products)){
        echo '<tr>';

        //check what is in the array
        var_dump($row);

        while ($rowi=mysql_fetch_assoc($tableheaders)){

            //check what is in the array
            var_dump($rowi);

            $column=$rowi['Title'];
            echo '<td>';
            echo $row[$column];
            echo '</td>';
        }
        echo '</tr>';

        //reset the $tableheaders array pointer back to 0 for next loop
        mysql_data_seek($tableheaders, 0);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T21:24:33.657

尝试这样的事情。这样做，您首先将结果加载到一个数组中，您可以进一步操作并在您想要的任何时候重用......

```
<?php

$t = mysql_query("SELECT * FROM `winetable`");
$p = mysql_query("SELECT * FROM `wines`");

if(mysql_num_rows($p) > 0 && mysql_num_rows($t) > 0){
    while ($row=mysql_fetch_assoc($p)){
        $products[] = $row
    }

    while ($row=mysql_fetch_assoc($t)){
        $tableheaders[] = $row;
    }

    foreach($products as $i => $product){ ?>

    <tr><?php
    foreach($tableheaders as $j => $tableheader){
        ?>

        <td><?php echo $row[$tableheader['Title']]; ?></td><?php
    }   
    ?>

    </tr><?php
    }
}

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T21:30:28.100

查看您的代码，我注意到您没有`<table>`或没有`</table>`包含（也许您有，但未在您的问题中显示）。能这么简单吗？`<table>`一些浏览器（即我想）在没有这些标签时不会显示表格。

包括

```
echo '<table>'; 
```

在第一个循环之前

和

```
echo '</table>'; 
```

在代码的末尾（循环之后）

您的 htmlsource 中是否出现任何信息？

**只是一个提示** ，我会尝试另一种方法来收集有关葡萄酒的信息......这将是创建一个包含所需表格和输出信息的记录集。这将显着提高速度并添加更易读的代码。

就像是：

```
SELECT * FROM `wines` w LEFT JOIN `winetable` wt ON (w.id = wt.id) 
```

当然，正如 Theo Kouzelis 提到的，不要使用 mysql_functions。

# java - Java休眠在读取时从MySQL日期时间截断时间部分

> ID：15603438
> 
> 赞同：2
> 
> 时间：2013-03-24T20:11:40.600
> 
> 标签：java, mysql, hibernate, datetime, truncated

我在我的 java 控制台应用程序中使用 hibernate 4.1.10，并且我有一个带有以下列的模型：

```
@Column(name = "created_at", columnDefinition="datetime")
@Temporal(TemporalType.TIMESTAMP)
private Date createdAt; 
```

我只想让 java 正确处理整个 MySQL 日期时间。目前，它只能读取日期部分，其余部分被截断。我有一个简单的测试，我只是将 getCreatedAt() 属性打印到标准输出：

```
System.out.println(income.getCreatedAt()); 
```

它打印出以下内容：

```
2012-05-11 00:00:00.0
2012-05-29 00:00:00.0
2012-05-30 00:00:00.0
2012-06-28 00:00:00.0
2012-07-30 00:00:00.0
2012-08-29 00:00:00.0
2012-09-28 00:00:00.0
2012-10-30 00:00:00.0
2012-11-29 00:00:00.0
2012-12-02 00:00:00.0
2012-12-21 00:00:00.0
2012-12-24 00:00:00.0
2013-01-30 00:00:00.0
2013-02-27 00:00:00.0
2013-02-27 00:00:00.0 
```

这是我`show create table`的桌子：

```
CREATE TABLE `category` (
 `id` bigint(20) NOT NULL AUTO_INCREMENT,
 `parent_id` bigint(20) DEFAULT NULL,
 `name` varchar(32) NOT NULL,
 `type` varchar(255) DEFAULT NULL,
 `created_at` datetime NOT NULL,
 `updated_at` datetime NOT NULL,
 `created_by` bigint(20) DEFAULT NULL,
 `updated_by` bigint(20) DEFAULT NULL,
 PRIMARY KEY (`id`),
 KEY `category_type_idx` (`type`),
 KEY `created_by_idx` (`created_by`),
 KEY `updated_by_idx` (`updated_by`),
 KEY `category_parent_id_category_id` (`parent_id`),
 CONSTRAINT `category_created_by_sf_guard_user_id` FOREIGN KEY (`created_by`) REFERENCES `sf_guard_user` (`id`),
 CONSTRAINT `category_parent_id_category_id` FOREIGN KEY (`parent_id`) REFERENCES `category` (`id`),
 CONSTRAINT `category_updated_by_sf_guard_user_id` FOREIGN KEY (`updated_by`) REFERENCES `sf_guard_user` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=56 DEFAULT CHARSET=utf8 
```

我一直在尝试遵循在网络上（也在 stackoverflow 上）找到的几个 tuts/answers 并决定使用带有注释的 java.util.Date 而不是 java.sql.Date （因为 MySQL 类型是`datetime`）。这就是我设法实现的全部目标。我能做些什么来检索时间部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T21:00:42.243

您可能已经截断了数据库中的数据。尝试存储`Timestamp`而不是`Date`. 例如

```
@Column(name = "created_at", length = 19)
public Timestamp getCreatedAt() {
    return this.createdAt;
}

setCreatedAt(new Timestamp(Calendar.getInstance().getTimeInMillis())); 
```

# html - 当浏览器太小时添加自动滚动到固定元素

> ID：15603447
> 
> 赞同：0
> 
> 时间：2013-03-24T20:12:29.310
> 
> 标签：html, css, overflow, fixed

仅当浏览器太小而无法显示其所有内容时，我才尝试为固定元素提供滚动条。

我在页面底部也有一个固定的页脚，理想情况下，一旦固定元素的内容位于页脚后面，我希望滚动开始。

这是指向我的问题的简单示例的链接。 [http://jsfiddle.net/alsweeet/pGFzF/1/](http://jsfiddle.net/alsweeet/pGFzF/1/)

```
<div id="container">
    <ul>
        <li>Item</li>
        <li>Item</li>
        <li>Item</li>
        <li>Item</li>
    </ul>
</div>       
<div id="footer"></div>

#container{
    color: #fff;
    position: fixed;
    top: 200px;
    left: 0;
    width: 100%;
    background: red;
    overflow: auto;
}

#footer{
    position: fixed;
    height: 50px;
    width: 100%;
    bottom: 0;
    left: 0;
    background: #000000;
} 
```

容器离顶部有一定的距离，所以我不能简单地给高度一个百分比。

我猜这是一个很常见的问题，但我从来没有遇到过，也找不到从谷歌中挤出答案的神奇词汇。

提前感谢您提供任何有用的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T19:40:10.513

万一有人有同样的问题，我选择了百分比选项。此处显示：http: [//jsfiddle.net/alsweeet/rXrEU/1](http://jsfiddle.net/alsweeet/rXrEU/1)

理想情况下，我希望将与顶部的距离保持为固定高度，但我认为这不可能让滚动正常工作。

```
#container{
    color: #fff;
    position: fixed;
    top: 30%;
    left: 0;
    width: 100%;
    background: red;
    overflow: auto;
    height: 70%;
    margin-top: -50px;
}

#footer{
    position: fixed;
    height: 50px;
    width: 100%;
    bottom: 0;
    left: 0;
    background: #000000;
} 
```

# ruby-on-rails - activerecord-import gem 如何处理并发导入？它会锁定桌子吗？

> ID：15603454
> 
> 赞同：0
> 
> 时间：2013-03-24T20:12:42.027
> 
> 标签：ruby-on-rails

每当有人将股票添加到他们的投资组合中时，我都会使用 activerecord 导入 gem 来导入股票价格历史。在添加股票价格历史之前，该函数首先检查该股票是否已存在于表中。这样，即使 2 个人拥有 Google 股票，它也不会两次填充股票价格历史记录。

但是，这让我想到了并发添加。如果 2 个人同时添加了 Google，并且模型中尚不存在价格历史记录，则“导入”功能将同时出现两次。

这让我想到了我的问题。activerecord-import 是否会锁定表以防止同时进行 2 个导入？

编辑：根据吉姆的建议，我做了以下事情：

在我的 Stock 模型中，我使用 an`after_save`来运行导入 StockHistory 的函数，因此我将 StockHistory 锁定为：

```
def populatepricehistory

#columns and prices defined here

StockHistory.transaction do
    StockHistory.lock
    StockHistory.import columns,prices
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:26:12.640

`activerecord-import`本身不做任何显式锁定。如果您正在做任何与并发相关的事情，最好明确地隔离事物。将您的更新包装在[ActiveRecord 事务](http://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html)中。您还可以更明确地使用 ActiveRecord 的[悲观锁定](http://guides.rubyonrails.org/active_record_querying.html#pessimistic-locking)机制进行锁定，但大多数时候这不是必需的；通常最好让其中一个事务失败并处理失败。

包装交易很容易：

```
# Inside ActiveRecord model Foo:

def some_bulk_update
  foo_records = generate_some_foo_records()
  transaction do
    self.import foo_records
  end
end 
```

在事务之外尽可能多地做以减少冲突的窗口是一个好主意。 `generate_some_foo_records()`以上只是一个示例，说明如何在事务之前调用方法来构建`foo_records`要导入的数组。

查看上面的两个链接了解详细信息。

# php - 什么是 php 中的 System.out 或 systemout？

> ID：15603455
> 
> 赞同：3
> 
> 时间：2013-03-24T20:12:47.303
> 
> 标签：php

我正在探索 php，我发现了**system.out**和**systemout**。php 说它们是字符串，但它们的行为不像字符串。这里有些例子。

```
 system.out.print('test');
    //output
    test

    system.out.var_dump('system.out');
    // output
    string(9) "systemout"

    systemout.var_dump('test');
    // output 

string(4) "test" 
```

这是语言错误吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-24T20:19:30.133

让我在代码中这样说：

```
in.fact.you.can.concat.many.undefined.constants.with.any.func.print('.'); 
```

如果你启用了错误报告，php 会通知你许多未定义的常量，它们将被视为字符串，因此将被视为：

```
'in'.'fact'.'you'.'can'.'concat'.'many'.'undefined'.'constants'.'with'.'any'.'func'.print('.'); 
```

产生所需输出的唯一方法是函数调用。此函数的返回值连接到未定义常量的字符串，并且什么也不做。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-03-12T15:07:31.963

```
//i can tell what you are trying to do.is to dumb some vars to console.
//System.out.printLn does not exist in php

//there are other tools like firephp but this is the simplest method to log vars to console
//use the following function instead in php
function phpconsole($label='var',$x){
?>
 <script type="text/javascript">
   console.log('<?php echo ($label)?>');
   console.log('<?php echo json_encode($x)?>');
  </script>
 <?php
}
//use it like this
$salary = 500;
phpconsole('salary:',$salary);

$arr = array('aaa','bbb','ccc');
phpconsole('arr:',$arr);//it will accept any datatype and dumb it to console 
```

# c# - 可以在泛型方法中使用 IList 但不能使用 List

> ID：15603464
> 
> 赞同：7
> 
> 时间：2013-03-24T20:13:32.953
> 
> 标签：c#, list, generics, interface, ilist

我正在尝试创建一个方法，该方法返回用户想要的任何类型的列表。为此，我使用了泛型，我不太熟悉，所以这个问题可能很明显。问题是此代码不起作用并抛出错误消息`Cannot convert type Systems.Collections.Generic.List<CatalogueLibrary.Categories.Brand> to Systems.Collection.Generic.List<T>`

```
private List<T> ConvertToList<T>(Category cat)
{            
     switch (cat)
     {
         case Category.Brands:
             return (List<T>)collection.Brands.ToList<Brand>();

     }
    ...
} 
```

但如果我`IList`改为使用，则没有错误。

```
private IList<T> ConvertToList<T>(Category cat)
{            
     switch (cat)
     {
         case Category.Brands:
             return (IList<T>)collection.Brands.ToList<Brand>();

     }
     ...
} 
```

为什么在这种情况下我可以使用 IList 而不是 List？`BrandCollection`collection.Brands从第三方库返回一个类型，所以我不知道它是如何创建的。可能是`BrandCollection`从 IList 派生的（只是猜测它确实如此），因此可以将其转换为它，但不能转换为普通的 List？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-24T20:35:22.320

由于对 没有任何限制`T`，因此只能`object`在编译时转换为。编译器不会检查对接口类型的强制转换，因为理论上可能会创建一个新类来实现`IList<object>`和继承`List<Brand>`。但是，转换为`List<T>`将失败，因为已知不能创建一个同时继承`List<object>`和的类`List<Brand>`。`T`但是，在您的情况下，您通过语句知道类型是什么，`switch`并希望强制转换。为此，`object`请先按如下方式进行转换：

```
private List<T> ConvertToList<T>(Category cat)
{            
    switch (cat)
    {
        case Category.Brands:
            return (List<T>)(object)collection.Brands.ToList<Brand>();
    }
} 
```

但是，这里更大的设计问题是，当您有一个已知类型的离散列表时，泛型不是最佳选择`T`。`T`当泛型可以是任何东西，或者被限制为基本类型或接口时，泛型会更好。在这里，最好只为 switch 语句的每个分支编写一个单独的方法：

```
private List<Brand> ConvertToBrandList()
{
    return collection.Brands.ToList<Brand>();
} 
```

没有这个，你几乎没有类型安全性。如果有人用 调用你的方法`ConvertToList<int>(Category.Brands)`怎么办？

# android - 片段中的 TapJoy 报价列表

> ID：15603467
> 
> 赞同：1
> 
> 时间：2013-03-24T20:13:48.957
> 
> 标签：android, fragment, tapjoy

我目前正在为需要 TapJoy 集成的客户开发一个 Android 应用程序，并且只想显示 TapJoy 提供的报价列表。该应用程序集成了 Actionbar sherlock 并具有五个选项卡，其中一个选项卡应显示此报价列表。因此，我下载了 jar 和附加的文档，并按照他们的示例介绍了如何显示报价列​​表。

在执行此操作时，我得出的结论是，当您执行以下代码时。

```
Hashtable<String, String> flags = new Hashtable<String, String>();
flags.put(TapjoyConnectFlag.ENABLE_LOGGING, "true");

// Connect with the Tapjoy server.  Call this when the application first starts.
// REPLACE THE SECRET KEY WITH YOUR SECRET KEY.
TapjoyConnect.requestTapjoyConnect(getSherlockActivity().getApplicationContext(), "bba49f11-b87f-4c0f-9632-21aa810dd6f1", "yiQIURFEeKm0zbOggubu", flags);
TapjoyConnect.getTapjoyConnectInstance().showOffers();
TapjoyConnect connect = TapjoyConnect.getTapjoyConnectInstance(); 
```

*注意：键的值来自于 tapjoy self 的示例*

它启动一个带有 Webview 的新 Activity，我知道这是事实，因为您必须在我的 Android 清单中使用 tapjoy 类的 com 标识符声明该 Activity。

如果我使用上面提供的代码，每次加载左侧/右侧的选项卡和实际显示选项列表的选项卡时，它都会启动一个新的 Activity，这是一个不寻常的工作流程。并且完全不是片段寻呼机之类的行为。

现在我的问题！有没有人设法得到。

1.  完整的 ruquested URL（所以我可以在我自己的 webview 中加载它）
2.  让它返回一个 Webview 组件，这样我就可以将它添加到我的 Fragment 中。
3.  用其他可行的方法打我。

我已经尝试扩展一些类，但是启动活动的类是一个单例类，我在超级的构造函数中得到一个错误。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T09:50:31.123

不，这不能做，希望tapjoy将来会考虑android UI指南并在新库中包含片段

# r - 如何将列表的元素合并到数据框中？在 R 中

> ID：15603470
> 
> 赞同：3
> 
> 时间：2013-03-24T20:13:56.597
> 
> 标签：r, list, dataframe

我有一个元素列表，像这样

```
[[1]]
[1] 9.623571 5.334566 7.266597 6.510794 4.301958

[[2]]
[1] 9.693326 9.015892 1.266178 8.547392 4.326199 
```

我想把它转换成这样的数据框：

```
V1       V2       V3       V4       V5
9.623571 5.334566 7.266597 6.510794 4.301958
9.693326 9.015892 1.266178 8.547392 4.326199 
```

因此，列表条目内相同位置的所有元素，合并到同一列中。

它必须与“rbind”相关，因为结果就像这样做：

```
rbind(list[[1]],list[[2]]...) 
```

但我不知道如何将它应用于列表的所有条目。对此的任何说明将不胜感激。

非常感谢您提前。

蒂娜。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-24T20:39:21.847

因为还没有人提到这一点：

```
 library(data.table)
 rbindlist(yourList) 
```

非常快。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-24T20:23:00.993

尝试这个：

```
as.data.frame(do.call(rbind, l)) 
```

在哪里，`l <- list(1:5, 6:10)`

```
#   V1 V2 V3 V4 V5
# 1  1  2  3  4  5
# 2  6  7  8  9 10 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-24T20:23:24.137

用来`sapply`得到你所追求的。举个例子...

```
x <- list( 1:10 , letters[1:10])
as.data.frame( t( sapply(x , rbind) ) )

#     V1 V2 V3 V4 V5 V6 V7 V8 V9 V10
#   1  1  2  3  4  5  6  7  8  9  10
#   2  a  b  c  d  e  f  g  h  i   j 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-24T20:38:31.917

我知道这是使用额外的包，但我通常有`plyr`并且`reshape2`在我的路径中。

```
library(plyr)
x <- list( sample(1:10,10) , sample(1:10,10))
ldply(x) # list 2 data.frame

  V1 V2 V3 V4 V5 V6 V7 V8 V9 V10
1  3  8  6  2 10  9  7  5  1   4
2  8 10  3  4  2  5  1  7  6   9 
```

当列表有名称时，我发现它特别有用：

```
names(x) <- c("hello","goodbye")
ldply(x) 

      .id V1 V2 V3 V4 V5 V6 V7 V8 V9 V10
1   hello  3  8  6  2 10  9  7  5  1   4
2 goodbye  8 10  3  4  2  5  1  7  6   9 
```

使用 reshape2 您还可以快速将 data.frame 重塑为可以使用 ggplot2 快速绘制的东西

```
library(reshape2)
melt(ldply(x),c(".id"))

       .id variable value
1    hello       V1     3
2  goodbye       V1     8
3    hello       V2     8
4  goodbye       V2    10
5    hello       V3     6
6  goodbye       V3     3
7    hello       V4     2
8  goodbye       V4     4
9    hello       V5    10
10 goodbye       V5     2
11   hello       V6     9
12 goodbye       V6     5
13   hello       V7     7
14 goodbye       V7     1
15   hello       V8     5
16 goodbye       V8     7
17   hello       V9     1
18 goodbye       V9     6
19   hello      V10     4
20 goodbye      V10     9 
```

对于非常大的数据集（未经测试的假设），这些解决方案都不是特别快，但它们在处理较小的数据集（< 10k 行）时非常有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-24T20:26:26.553

将列表`Reduce`中`rbind`的元素一起使用：

```
l <- list (a=c(9.623571, 5.334566, 7.266597, 6.510794, 4.301958),
           b=c(9.693326, 9.015892, 1.266178, 8.547392, 4.326199))
# rbind the elements of the list.
Reduce(rbind, l) 
```

# compilation - 仅使用“make”编译任何 C 程序（来自 Makefile）

> ID：15603475
> 
> 赞同：8
> 
> 时间：2013-03-24T20:14:36.837
> 
> 标签：compilation, makefile, gnu, compiler-warnings

我正在通过“Learn C the Hard Way”学习 C 编程。我目前（很长一段时间）在练习 2，可以在这里找到：[http ://c.learncodethehardway.org/book/ex2.html](http://c.learncodethehardway.org/book/ex2.html)

在额外的信用部分，有一个挑战要求我们编辑 Makefile，以便我们可以只使用命令“make”编译 .c 文件（ex1.c）。这就是挑战的确切含义：

> 创建一个 all: ex1 目标，该目标将仅使用命令 make 构建 ex1。

通过查看[这里](https://stackoverflow.com/questions/11232714/where-does-all-belong-in-a-makefile)和其他一些地方，这是我认为正确的代码：

```
CFLAGS="-Wall" -g

all: ex1
    CFLAGS="-Wall" -g

clean:
    rm -f ex1 
```

但是，当我尝试运行它时，我得到编译的文件并不断收到错误：

```
cc "-Wall" -g    ex1.c   -o ex1
CFLAGS="-Wall" -g
/bin/sh: 1: -g: not found
make: *** [all] Error 127 
```

这里发生了什么？错误消息背后的原因是什么？我怎样才能解决这个问题？

多谢你们。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-24T20:35:15.137

*   如果`all`是你的 makefile 中的第一个目标（我在这里做一个疯狂的猜测，因为你没有显示整个 Makefile），当你没有从命令中传递一个明确的目标时，make 会选择它作为第一个构建目标线（即仅仅`make`）

*   `ex1`是 的先决条件`all`，因此它首先构建它，因此您会看到以下行：

    ```
    cc "-Wall" -g    ex1.c   -o ex1 
    ```

*   构建完成后`ex1`，make 尝试为所有人执行配方，并在其中执行以下命令：

    ```
    CFLAGS="-Wall" -g 
    ```

*   由于`-g`其本身不是可以在 shell 中执行的有效命令或应用程序，因此您会收到以下错误：

    ```
    /bin/sh: 1: -g: not found 
    ```

**解决方案：**

*   您已经`CFLAGS`在 makefile 的开头定义了，因此无需在配方中再次定义它。即使您希望覆盖变量`CFLAGS`，也不应将其直接用作配方的一部分。

*   定义`all`和`clean`作为`PHONY`目标，如果您还没有这样做的话。目标`all`并`clean`不会在执行配方后创建名为`all`或的文件，因此最好将这些目标分类为.`clean``PHONY`

*   你不需要双引号`-Wall`

以下 Makefile 包含所有这些更正：

```
CFLAGS = -Wall -g

all: ex1

clean:
    rm -f ex1

.PHONY: all clean 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-24T20:35:07.137

```
CFLAGS = -Wall -g

all: ex1

clean:
    rm -f ex1 
```

应该是你所需要的，因为 make 有一个内置的默认规则来将 .c 文件编译为可执行文件。

您的错误是将变量赋值用作命令。有的部分

```
 CFLAGS="-Wall" -g 
```

尝试`-g`使用一次性变量 assignment运行命令`CFLAGS="-Wall"`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-22T05:10:06.253

我想建议一个调整，以便您`ex1`只需输入即可构建`make`，无论这是第一次编译还是重新编译源代码。

**资源：** `ex1.c`

**生成文件：**

```
CFLAGS=-Wall -g

all : clean ex1

clean:
    rm -rf ex1 ex1.dSYM

.PHONY: all clean 
```

通过将`clean`Phony Target 添加为 的第一个*先决条件*，`all`它将在执行带有先决条件`rm -rf ex1 ex1.dSYM`的隐含命令之前执行该命令。`cc``ex1`

此外，在 Mac OS-X 上，使用执行中的命令`.PHONY all clean`不是必需的，但是，设置这样可能是一个很好的先例，以便以后阅读代码的任何人都意识到 all 和 clean 不是实际的目标文件。`make``Makefile`

哦，非常感谢 Zed A. Shaw 让 Learn the Hard Way 在他的网站[Learn C the Hard](http://c.learncodethehardway.org/book/ex2.html "艰难地学习 C") Way 上免费阅读。

# javascript - JavaScript 函数柯里化不适用于实例方法

> ID：15603477
> 
> 赞同：3
> 
> 时间：2013-03-24T20:14:56.570
> 
> 标签：javascript, function, partial-application

我正在通过在线阅读和编写一些简单的代码来学习 JavaScript 中的函数柯里化。我在在线文章中得到了以下示例

```
 function toArray(obj) {
        return Array.prototype.slice.call(obj);
    }

    Function.prototype.curry = function() {
        if (arguments.length<1) {
            return this; //nothing to curry with - return function
        }
        var __method = this;
        var args = toArray(arguments);
        return function() {
            return __method.apply(this, args.concat(toArray(arguments)));
        }
    }

    var add = function(a,b) {
        return a + b;
    }

    var addTen = add.curry(10); //create function that returns 10 + argument
    alert(addTen(20)); //alerts 30 correctly 
```

然后我尝试了一个实例化函数的方法。所以我试着跟随。但它在倒数第二行给了我错误“无法获取未定义或空引用的属性'原型'”。我知道这个错误与柯里化无关，但我搞砸了 JS 函数概念的一些基础知识。所以我要去哪里错了。

```
 function Person()
    {
        this.age = 15;
    }

    Person.ageAfter = function (years) {
        return this.age + years;
    }

    var personObj = new Person();
    var ageAfterFiveYears = personObj.ageAfter.prototype.curry(5);  //**Error**
    alert(ageAfterFiveYears()); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-24T20:19:30.770

您不应该在调用中包含原型：

```
var ageAfterFiveYears = personObj.ageAfter.curry(5); 
```

“ageAfter”属性的值有一个函数，因此该函数可以访问您的“curry”函数，就像第一个示例中的函数一样。

当您在原型上调用它时，`this`函数内部的值将是原型对象，而不是“ageAfter”函数。

同样作为评论指出，您需要将“ageAfter”放在原型上：

```
Person.prototype.ageAfter = function(years) { ... } 
```

*编辑*——Alnitak 指出的绑定问题也很重要。（当我说“重要”时，我的意思是“使您的代码工作所必需的”。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-24T20:22:41.553

你有两个问题：

1.  该`ageAfter`函数不是实例方法——您已将其添加到“类”中（即，它有点像静态方法）。它应该被添加到原型中。

2.  当您对函数进行 curry 时，您会丢失对象的上下文，因此您要么需要重新绑定上下文

例如：

```
var ageAfterFiveYears = Person.prototype.ageAfter.curry(5).bind(personObj); 
```

为您提供一个*仅*适用于当前实例的函数，或者更好的是，正如@Pointy 在评论中所建议的那样，您应该将 curried 函数放回原型中：

```
Person.prototype.ageAfterFiveYears = Person.prototype.ageAfter.curry(5); 
```

然后将该`.ageAfterFiveYears`方法添加到*每个* `Person`对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-24T20:23:02.847

Curry 不适用于您的用例。您需要绑定上下文，`this`您的 personObj 也是如此。

```
function Person() {
    this.age = 15;
}

Person.prototype.ageAfter = function (years) {
    return this.age + years;
}

var personObj = new Person();
var ageAfterFiveYears = personObj.ageAfter.bind(personObj, 5);
alert(ageAfterFiveYears()); 
```

# java - 正确使用 glVertexPointer？

> ID：15603479
> 
> 赞同：0
> 
> 时间：2013-03-24T20:15:08.317
> 
> 标签：java, opengl, lwjgl

每当我查看解释如何使用 glDrawArrays 和 glVertexPointer 命令的教程时，它们使用的参数与我可用的参数不同。

例如：一个教程调用 glVertexPointer 的参数如下：（顶点是一个浮点数组）

```
glVertexPointer(3, GL_FLOAT, 0, Vertices); 
```

我可用的参数是：

```
glVertexPointer(int size, int stride, FloatBuffer pointer); 
```

我的问题是：使用 glVertexPointer() 的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:33:46.927

`glVertexPointer`，顾名思义，是基于使用*指针*。您正在使用 Java，其中指针*不存在*。因此，Java 等价物必须以不同的方式工作。它必须采用一个特殊的内存数组对象，该对象可以在内部转换为将传递给实际`glVertexPointer`调用的 C 指针。

因为 Java 在缓冲区的内容上放置了一个类型，所以您不需要显式类型字段。[LWJGL](http://www.lwjgl.org/javadoc/org/lwjgl/opengl/GL11.html#glVertexPointer%28int,%20int,%20java.nio.DoubleBuffer%29)中有[几个重载`glVertexPointer`](http://www.lwjgl.org/javadoc/org/lwjgl/opengl/GL11.html#glVertexPointer%28int,%20int,%20java.nio.DoubleBuffer%29)，每个重载都采用不同类型的缓冲区。

# ios - 查看未调用代理

> ID：15603480
> 
> 赞同：0
> 
> 时间：2013-03-24T20:15:11.897
> 
> 标签：ios, xcode, model-view-controller, delegates, protocols

我正在构建一个图形应用程序，我有一个视图和一个视图控制器，它充当视图的委托（检索信息）。虽然我还没有开始实际绘图，但我目前正在尝试将值存储在字典中；但是，我有条不紊地将某些 NSLogs 放置在视图控制器中，并且我注意到我从视图调用的委托方法根本没有被调用。例如，我调用了我的`scaleForGraph`函数，但它没有执行。作为新手，我不确定我是否缺少某些东西。仅供参考：我没有错误，它编译并执行。我试图尽可能地精简代码。谢谢您的帮助！

这是我的观点的 .h，我在其中定义了协议：

```
//  GraphView.h

#import <UIKit/UIKit.h>

@class GraphView;

@protocol GraphViewDelegate <NSObject>
- (float)scaleForGraph:(GraphView *)requestor;
-(NSMutableDictionary*) valuesForGraph:(GraphView *)requestor withWidth:(float) width;

@end

@interface GraphView : UIView
@property (nonatomic) id <GraphViewDelegate> delegate;
@property (nonatomic) id expressionCopy;

@end 
```

这是.m：

```
#import "GraphView.h"

@implementation GraphView
@synthesize expressionCopy = _expressionCopy;

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        self.contentMode = UIViewContentModeRedraw;
    }
    return self;
}

- (void)awakeFromNib
{
    self.contentMode = UIViewContentModeRedraw;
}

// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect
{
    CGContextRef c = UIGraphicsGetCurrentContext();
    CGRect screenBound = [[UIScreen mainScreen] bounds];
    CGSize screenSize = screenBound.size;
    CGFloat width = screenSize.width;
    CGFloat height = screenSize.height;
    float scale = [self.delegate scaleForGraph:self];
    NSLog([NSString stringWithFormat:@"My Scale: %f",scale]); //always returns 0
    NSMutableDictionary *graphValues = [self.delegate valuesForGraph:self withWidth:width];
}
@end 
```

这是我的视图控制器.h：

```
#import <UIKit/UIKit.h>
#import "GraphView.h"

@interface GraphingViewController : UIViewController <GraphViewDelegate>
@property (weak, nonatomic) IBOutlet GraphView *graphView;
@property (strong, nonatomic) IBOutlet UIStepper *stepper;
- (IBAction) changedScale:(UIStepper *)stepper;
@property (nonatomic) int scale;
@property (nonatomic) id expressionCopy;
@end 
```

这是控制器的 .m ：

```
#import "GraphingViewController.h"
@interface GraphingViewController ()

@end

@implementation GraphingViewController
@synthesize expressionCopy = _expressionCopy;

- (void)updateUI
{
    self.stepper.value = self.scale;
    [self.graphView setNeedsDisplay];
}

- (void)setScale:(int)scale
{
    if (scale < 0) scale = 0;
    if (scale > 100) scale = 100;
    _scale = scale;
    [self updateUI];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

-(IBAction)changedScale:(UIStepper *)stepper {
    self.scale = stepper.value; //this function works fine, but is not delegate/does not get called by view
}

-(float) scaleForGraph:(GraphView *)requestor {
    NSLog(@"HI"); //never gets here
}

-(NSMutableDictionary*) valuesForGraph:(GraphView *)requestor withWidth:(float) width {
    NSLog(@"Hello2"); //never gets here
    }
    return xyVals;
}

@end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-24T20:22:26.127

在您发布的代码中没有任何地方告诉您`GraphView`这`GraphingViewController`是它的委托。因此，您正在向`nil`.

您需要执行以下操作：

```
self.graphView.delegate = self; 
```

在您的 GraphingViewController 设置代码中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:27:03.217

使您的控制器成为 GraphView 的实际代表。您可以在界面生成器中通过 Ctrl 键从 GraphView 拖动到对象（底部的橙色圆圈）然后选择“委托”来执行此操作

# ios - 如何在 .plist 文件中添加数据字符串？

> ID：15603482
> 
> 赞同：2
> 
> 时间：2013-03-24T20:15:21.963
> 
> 标签：ios, objective-c, xcode, plist

我想将数据字符串（例如用于创建许多 url 的循环）放在 xcode 上的 plist 文件中。这是我的代码（循环）

```
int count = 5;
NSString *a;
NSMutableArray *b = [[NSMutableArray alloc] initWithCapacity:count];

 for (int i=1; i<= count; i++ ) {

        a = [NSString stringWithFormat:@"http://192.168.1.114:81/book.php?page=%d",i];
        [b addObject:a];

    } 
```

现在我想将顶部代码中的任何页面保存在 .plist 文件的一行中，但我不知道该怎么办？

你能指导我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:41:55.937

我不太确定您要拍摄什么，但如果您尝试从这些 URL 字符串中提取 HTML，您可能会执行以下操作：

```
// build path for filename

NSString *docsPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES)[0];
NSString *filename = [docsPath stringByAppendingPathComponent:@"test.plist"];

// create array of html results

NSMutableArray *htmlResults = [NSMutableArray array];
for (NSString *urlString in b)
{
    // get the html for this URL

    NSString *html = [NSString stringWithContentsOfURL:[NSURL URLWithString:urlString] encoding:NSUTF8StringEncoding error:nil];

    // add the html to our array (or zero length string if it failed)

    if (html)
        [htmlResults addObject:html];
    else
        [htmlResults addObject:@""];
}

// save the html results to plist

[htmlResults writeToFile:filename atomically:YES]; 
```

几个想法：

1.  根据有多少页面，我不确定我是否对将所有页面加载到 plist 中感到疯狂。我要么

    *   使用像 Core Data 这样的持久存储，这样我就不必将所有页面都保存在内存中，或者

    *   对 HTML 进行一些延迟加载（根据需要加载它））

2.  另外，如果我要加载所有页面，考虑到这可能需要一点时间，我可能会有一个进度视图，我会根据我的进度进行更新，这样用户在下载时就不会看到冻结的屏幕正在进行中。

3.  如果您只想检索单个 html 文件，那么将其存储在 plist 中可能没有意义。我只是将 html 写入文件（HTML 文件，而不是 plist）。

4.  我通常不喜欢在主队列中加载 html。我会`dispatch_async`在后台队列中执行此操作。但是，在您明确说明您要查找的内容之前，我会犹豫不决。

但希望这会为您指明正确的方向，向您展示如何从网页中检索数据。

* * *

如果您想将单个 html 文件保存到某个本地文件（例如从零开始的索引号`X.html`在哪里`X`），您可以执行以下操作：

```
// identify the documents folder

NSString *docsPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES)[0];

// save the html results to local files

[b enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    NSString *html = [NSString stringWithContentsOfURL:[NSURL URLWithString:obj] encoding:NSUTF8StringEncoding error:nil];
    if (html)
    {
        NSString *filename = [docsPath stringByAppendingPathComponent:[NSString stringWithFormat:@"%d.html", idx]];
        [html writeToFile:filename atomically:YES encoding:NSUTF8StringEncoding error:nil];
    }
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:22:20.487

尝试`[b writeToFile:@"myFile.plist" atomically:YES];`，但要确保数组中的所有数据都可以在 plist 中表示。

# jquery - 计算在 HTML5 画布上绘制的形状内的像素数？

> ID：15603483
> 
> 赞同：1
> 
> 时间：2013-03-24T20:15:27.180
> 
> 标签：jquery, html, html5-canvas

我正在使用[sketch.js](http://intridea.github.com/sketch.js/)在 HTML5 画布上动态绘制非常简单的形状。

有没有办法计算画布上绘制的封闭形状内的像素数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-24T22:36:28.030

**这是计算画布上不透明像素的方法**

```
// get a reference to your canvas
var c=document.getElementById("canvas");
var ctx=c.getContext("2d");

// get the pixel data from the canvas
var imgData=ctx.getImageData(0,0,c.width,c.height);

// loop through each pixel and count non-transparent pixels
var count=0;
for (var i=0;i<imgData.data.length;i+=4)
  {
      // nontransparent = imgData.data[i+3]==0
      if(imgData.data[i+3]==0){ count++; }
  } 
```

**[已编辑：获取画布上“如果填充”闭合形状的像素数]**

我通常使用此代码在画布中进行遮罩，但我已在此处对其进行了调整，以使您的像素数位于闭合形状内。

一些鱼子酱：

由于使用了“相邻”算法，对于未弯曲的形状，笔划宽度必须至少为 2 个像素宽，对于包含曲线的形状，笔划宽度必须至少为 3 个像素宽。

因为 Canvas 会自动绘制带有抗锯齿的笔触，所以内部像素数总是会比预期的稍大。这是因为抗锯齿“吞噬”了笔画，有效地导致了比预期更多的内部像素。顺便说一句，*没有办法*关闭画布的抗锯齿，如果你尝试getImageData()，将所有形状像素设置为rbg(0,0,0)，putImageData()，生成的图像也会被抗锯齿——只是更锯齿！

这是代码：

```
<!DOCTYPE html>
<html>
  <head>
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<style>
    canvas{border:1px solid red;}
</style>

<script>
$(function(){

//  The floodFill algorithm below is based on the good work by William Malone, Copyright 2010 William Malone (www.williammalone.com) -- Apache License: http://www.apache.org/licenses/LICENSE-2.0 -- Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.

    var canvas=document.getElementById("canvas");
    var context = canvas.getContext("2d");
    var canvasWidth = canvas.width;
    var canvasHeight = canvas.height;
    var strokeColor =  {r: 0, g: 0, b: 0};
    var fillColor =  {r: 101,g: 155,b: 65};
    var fillData;
    var strokeData;

    function redraw() {
        context.clearRect(0, 0, canvasWidth, canvasHeight);
        context.putImageData(fillData, 0, 0);
        drawOutline(context);
    }

    function matchstrokeColor(r, g, b, a) {
      // must check for near black because of anti-aliasing
      return (r + g + b < 100 && a === 255);  
    }

    function matchStartColor(pixelPos, startR, startG, startB) {

      var r = strokeData.data[pixelPos],
        g = strokeData.data[pixelPos + 1],
        b = strokeData.data[pixelPos + 2],
        a = strokeData.data[pixelPos + 3];

      // If current pixel of the outline image is black-ish
      if (matchstrokeColor(r, g, b, a)) {
        return false;
      }

      r = fillData.data[pixelPos];
      g = fillData.data[pixelPos + 1];
      b = fillData.data[pixelPos + 2];

      // If the current pixel matches the clicked color
      if (r === startR && g === startG && b === startB) {
        return true;
      }

      // If current pixel matches the new color
      if (r === fillColor.r && g === fillColor.g && b === fillColor.b) {
        return false;
      }

      return true;
    }

    function setPixel(pixelPos, r, g, b, a) {
      fillData.data[pixelPos] = r;
      fillData.data[pixelPos + 1] = g;
      fillData.data[pixelPos + 2] = b;
      fillData.data[pixelPos + 3] = a !== undefined ? a : 255;
    }

    function floodFill(startX, startY, startR, startG, startB) {

      var newPos;
      var x;
      var y;
      var   pixelPos;
      var   neighborLeft;
      var   neighborRight;
      var   pixelStack = [[startX, startY]];

      while (pixelStack.length) {

        newPos = pixelStack.pop();
        x = newPos[0];
        y = newPos[1];

        // Get current pixel position
        pixelPos = (y * canvasWidth + x) * 4;

        // Go up as long as the color matches and are inside the canvas
        while (y >= 0 && matchStartColor(pixelPos, startR, startG, startB)) {
          y -= 1;
          pixelPos -= canvasWidth * 4;
        }

        pixelPos += canvasWidth * 4;
        y += 1;
        neighborLeft = false;
        neighborRight = false;

        // Go down as long as the color matches and in inside the canvas
        while (y <= (canvasHeight-1) && matchStartColor(pixelPos, startR, startG, startB)) {
          y += 1;

          setPixel(pixelPos, fillColor.r, fillColor.g, fillColor.b);

          if (x > 0) {
            if (matchStartColor(pixelPos - 4, startR, startG, startB)) {
              if (!neighborLeft) {
                // Add pixel to stack
                pixelStack.push([x - 1, y]);
                neighborLeft = true;
              }
            } else if (neighborLeft) {
              neighborLeft = false;
            }
          }

          if (x < (canvasWidth-1)) {
            if (matchStartColor(pixelPos + 4, startR, startG, startB)) {
              if (!neighborRight) {
                // Add pixel to stack
                pixelStack.push([x + 1, y]);
                neighborRight = true;
              }
            } else if (neighborRight) {
              neighborRight = false;
            }
          }

          pixelPos += canvasWidth * 4;
        }
      }
    }

    // Fill
    function paintAt(startX, startY) {

      var pixelPos = (startY * canvasWidth + startX) * 4,
        r = fillData.data[pixelPos],
        g = fillData.data[pixelPos + 1],
        b = fillData.data[pixelPos + 2],
        a = fillData.data[pixelPos + 3];

      if (r === fillColor.r && g === fillColor.g && b === fillColor.b) {
        // this one's already filled
        return;
      }

      if (matchstrokeColor(r, g, b, a)) {
        return;
      }

      floodFill(startX, startY, r, g, b);

      redraw();
    }

    function init() {

      var theShapes=document.getElementById("theShapes");
      var theShapesContext=theShapes.getContext("2d");
      drawOutline(theShapesContext);

      drawOutline(context);

      strokeData = context.getImageData(0, 0, canvasWidth, canvasHeight);
      context.clearRect(0, 0, context.canvas.width, context.canvas.height);
      fillData = context.getImageData(0, 0, canvasWidth, canvasHeight);

      $('#canvas').mousedown(function (e) {
        // Mouse down location
        var mouseX = e.pageX - this.offsetLeft;
        var mouseY = e.pageY - this.offsetTop;
        paintAt(mouseX, mouseY);
      });

      redraw();
    };

    function drawOutline(theContext){   
        theContext.beginPath();
        theContext.moveTo(55, 60);
        theContext.bezierCurveTo(35,  70,  35, 95,  85, 95);
        theContext.bezierCurveTo( 95,110, 130,110, 140, 95);
        theContext.bezierCurveTo(180, 95, 180, 80, 165, 70);
        theContext.bezierCurveTo(185, 40, 155, 35, 140, 45);
        theContext.bezierCurveTo(130, 25,  95, 30,  95, 45);
        theContext.bezierCurveTo( 70, 25,  45, 30,  55, 60);
        theContext.closePath();
        theContext.rect(200,30,100,70);
        theContext.lineWidth = 3;
        theContext.strokeStyle = 'rgb(0,0,0)';
        theContext.stroke();        
    }

    function getFilledPixelCount(theContext,theCanvas){
        // get the pixel data from the fill canvas
        var imgData=theContext.getImageData(0,0,theCanvas.width,theCanvas.height);
        console.log(imgData.data.length);
        var count=0;
        for (var i=0;i<imgData.data.length;i+=4){
              r = imgData.data[i],
              g = imgData.data[i + 1],
              b = imgData.data[i + 2],
              a = imgData.data[i + 3];
              if (r === fillColor.r && g === fillColor.g && b === fillColor.b) {
                  count++;
              }
          }
        return(count);
    }

    $("#counter").click(function(){alert("There are "+getFilledPixelCount(context,canvas)+" filled pixels.");});

    init();

}); // end $(function(){});

</script>

  </head>
  <body>
        <p>The original stroked shapes</p>
        <canvas id="theShapes" width=350 height=150></canvas><br/>
        <p>The filled shapes used for pixel counting</p>
        <p>Click inside a shape below</p>
        <canvas id="canvas" width=350 height=150></canvas><br/>
        <button id="counter">Filled Count</button>
  </body>
</html> 
```

# python - 删除除最后一行之外的每一行的“\n”

> ID：15603485
> 
> 赞同：4
> 
> 时间：2013-03-24T20:15:41.897
> 
> 标签：python, io

目前我有一个 test.txt

```
1234
5678 
```

我想打印没有换行符“\n”的每一行

```
file=open("test.txt","r")
lines = file.readlines()
for i in lines:
    print i[:-1] 
```

这将删除第一行的 \n ，但对于第二行: `5678`，`8`将被切断，因为`\n`它后面没有。什么是正确处理这个问题的好方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-24T20:17:24.543

使用[`rstrip`](http://docs.python.org/2/library/stdtypes.html#str.rstrip).

`i.rstrip()`将从右边删除所有空格，`i.rstrip('\n')`只是换行符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-24T20:17:44.907

您可以使用[`str.rstrip`](http://docs.python.org/2/library/stdtypes.html#str.rstrip)

```
for i in lines:
    print i.rstrip('\n') 
```

这将从每一行中删除换行符（如果有的话）。`rstrip`它自己将删除*所有*尾随空格，而不仅仅是换行符。

例如：

```
>>> 'foobar\n'.rstrip('\n')
foobar
>>> 'foobar'.rstrip('\n')
foobar
>>> 'foobar  \t \n'.rstrip()
foobar 
```

相关的是[`str.strip`](http://docs.python.org/2/library/stdtypes.html#str.strip)，从两端剥离，和[`str.lstrip`](http://docs.python.org/2/library/stdtypes.html#str.lstrip)，仅从左侧剥离。

# ruby - 运行irb文件时出错

> ID：15603487
> 
> 赞同：2
> 
> 时间：2013-03-24T20:16:14.220
> 
> 标签：ruby, watir-webdriver, rubymine

这是我的第一个程序：

```
require 'rubygems'
require 'watir'

ie = Watir::IE.new
ie.goto("http://www.google.com")
ie.text_field(:name, "question").set("microsoft")
ie.button(:name, "btnG").click 
```

当我运行它时，我收到以下错误，请您帮忙。在运行它之前我已经安装了 watir-webdriver

```
C:/Ruby200/lib/ruby/site_ruby/2.0.0/rubygems/core_ext/kernel_require.rb:45:in `require': cannot load such file -- watir (LoadError)
    from C:/Ruby200/lib/ruby/site_ruby/2.0.0/rubygems/core_ext/kernel_require.rb:45:in `require'
    from C:/Ruby200/lib/ruby/site_ruby/2.0.0/rubygems/FirstSample:2:in `<top (required)>'
    from -e:1:in `load'
    from -e:1:in `<main>'

Process finished with exit code 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T11:06:55.090

我的猜测是问题是由于您已经安装了 watir-webdriver gem 但您需要 watir gem。

在您的代码中安装 watir gem 或要求 watir-webdriver gem。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T21:17:21.697

我刚刚用示例项目和有关 DevKit 安装的说明回答了[您的其他问题。](https://stackoverflow.com/q/15603108/104891)

请注意，RubyMine 需要一个有效`Gemfile`的来管理依赖项。您正在使用的所有 gem[都应在该文件中指定](http://www.jetbrains.com/ruby/webhelp/ruby-gems-support.html)。`bundle install`应该安装没有错误的依赖项。

如果您在安装 gems 时遇到错误，请将其作为一个单独的问题发布，并提供更多详细信息，但在此之前验证 DevKit 是否已正确安装并且可以从安装指南构建/运行示例 gem。

有些 gem 可能与最近发布的 Ruby 2.0 版本不完全兼容。如果您无法让它工作，请尝试使用 Ruby 1.9.3。

# vb.net - 沃特格伦项目

> ID：15603489
> 
> 赞同：-1
> 
> 时间：2013-03-24T20:16:49.407
> 
> 标签：vb.net, solution

到目前为止，这就是我为 Waterglen 解决方案所拥有的。我有点迷失了如何调用数组并用 0 定义所有内容去 lbl 无处可去。任何带 1 的东西都会先进入 lblfirst。

这是书中问题的图片。 [http://imgur.com/a/YTNEX](http://imgur.com/a/YTNEX)

提前感谢您的帮助。

```
Option Explicit On
Option Strict On
Option Infer Off

Public Class Form1
Private race(,) As Decimal = {{0, 1, 0, 3, 2}, {1, 0, 2, 0, 0}, {0, 3, 0, 1, 0}, {3, 2, 1, 0, 0}}

'Private horse() As String = {"Horse1", "Horse2", "Horse3", "Horse4"}

Private Sub btnExit_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnExit.Click
    Me.Close()
End Sub

Private Sub btnDisplay_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnDisplay.Click

End Sub

Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    ListBox1.Items.Add("Horse1")
    ListBox1.Items.Add("Horse2")
    ListBox1.Items.Add("Horse3")
    ListBox1.Items.Add("Horse4")
End Sub

Private Sub ListBox1_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles ListBox1.SelectedIndexChanged
    Dim SubScript As Integer = ListBox1.SelectedIndex

    lblFirst.Text = race(SubScript, 0).ToString("N0")
    lblSecond.Text = race(SubScript, 1).ToString("N0")
    lblThird.Text = race(SubScript, 2).ToString("N0")
    lblNoPlace.Text = race(SubScript, 3).ToString("N0")

End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T02:05:39.677

种族可能应该是 Int16 或 Int32 ，因为你不能有分数比赛或分数位置。

```
Dim rowIndex As Int16 = 1
Dim count As Int16 = 0
Dim value As Int16 = 0

For columnIndex = 0 to race.GetLength(rowIndex) - 1
  If value = race(rowIndex)(columnIndex)
    count += 1
  End If
Next

'  count contains how many times [value] occurs in row [rowIndex] 
```

# matlab - 从元胞数组中扫描数据并根据文件扩展名删除

> ID：15603490
> 
> 赞同：1
> 
> 时间：2013-03-24T20:16:51.817
> 
> 标签：matlab, cell-array, textscan

我有一个单元格数组，它是文件名列表。我转置了它们，因为我发现它更容易使用。现在我正在尝试遍历每个单元格中的每一行，并根据它们的文件扩展名删除这些行。最终，我想使用这个列表作为文件名来导入数据。这就是我转置列表的方式

```
 for i = 1:numel(F);
    a = F(1,i);
    b{i} = [a{:}'];
 end; 
```

我用来尝试读取每个单元格中的数据的代码不断给我错误输入必须是双精度或字符串类型。有任何想法吗？

```
for i = 1:numel(b);
    for k = 1:numel(b{1,i});
        b(cellfun(textscan(b{1,i}(k,1),'%s.lbl',numel(b)),b))=[];
    end;
end; 
```

提前致谢。

编辑：这是给 MATLAB 的。应该清楚这一点。谢谢布赖恩。EDIT2：谁为 F 是

```
Name      Size               Bytes  Class    Attributes
b         1x11            13986188  cell 
```

而对于 a 是

```
 Name      Size             Bytes  Class    Attributes
 a         1x1             118408  cell 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:57:59.817

根据您的描述，我不确定您的`F`阵列的外观，但假设

```
F = {'file1.ext1', 'file2.ext2', 'file3.ext2', 'file2.ext1'}; 
```

`.ext2`您可以删除所有以这样结尾的文件：

```
F = F(cellfun('isempty', regexpi(F, '\.ext2$'))); 
```

`regexpi`，它对元胞数组中的每个元素进行操作，返回`[]`与表达式不匹配的所有文件。该`cellfun`调用将元胞数组转换为逻辑数组，其中at 位置对应于以和`false`结尾的所有其他文件。结果数组可用作返回应保留文件的逻辑索引。`.ext2``true``F`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T21:52:13.120

你用错了cellfun。它的签名是`[A1,...,Am] = cellfun(func,C1,...,Cn)`。它接受一个函数作为第一个参数，但您将 textscan 的结果传递给它，这是一个匹配字符串的元胞数组。第二个参数应该是一个元胞数组，但是在循环中一遍又一遍地调用它是没有意义的。`cellfun' 的工作是在您想对单元阵列中的每个单元执行相同的操作时为您编写循环。

我建议您不要使用 textscan 自己解析文件名，而是使用[`fileparts`](http://www.mathworks.se/help/matlab/ref/fileparts.html)

由于您已经在转置步骤中循环遍历单元阵列，因此在那里进行过滤可能是有意义的。它可能看起来像这样：

```
for i = 1:numel(F);
    a = F(1,i);
    [~,~,ext] = fileparts(a{:});
    if strcmpi(ext, '.lbl')
        b{i} = [a{:}'];
    end
end; 
```

# html - 如何从 Chrome 以一致的大小打印 HTML 页面？

> ID：15603491
> 
> 赞同：35
> 
> 时间：2013-03-24T20:16:56.157
> 
> 标签：html, css, google-chrome, printing, print-css

我正在设计一组要打印的 HTML 页面，并且我希望页面的元素最终具有相同的比例。例如，有一类 div 的宽度被定义为 200px 宽出现在几个页面中的每一个上。我希望它在打印每一页时显示完全相同的尺寸（适用于例如剪切和叠加）。

我正在使用一些在 Chrome 中效果最好的东西（主要是 CSS 缩放规则以在其他地方拥有较小的元素副本），所以理想情况下我想继续使用 Chrome。（这在 Firefox 中会更容易，因为它在打印对话框中有一个明确的比例。）但在 Chrome 上，从不同页面**打印时保持相同的元素大小一致**远非易事。

Chrome 的 PDF 生成（这是 Chrome 在后台打印的内容）似乎选择了一些部分来定义页面的宽度，并在此基础上缩放页面的其余部分。或者它可能会尝试将页面大小设置为适合一页上“最佳”数量的元素。如果每个页面的外部框架元素在所有情况下都不是相同的尺寸，那么屏幕尺寸为 200 像素的元素似乎可以从 3-4 厘米到 1.5-2 厘米或更小。

只是使用`@page size`没有帮助：我有这个 CSS，它没有任何区别：

```
@media print {
  @ page size: 297mm 210mm 
} 
```

有人对如何以一致的尺寸打印出东西有任何想法吗？

我可以应用的一种极端解决方法是让它们成为一个大 HTML 页面的所有部分，并使用 Javascript 将某些部分标记为唯一要打印的部分......我什至不确定这是否可行，而且它d 在几个不同的页面上更清晰地热衷于事物。那么还有其他想法吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-08-11T16:32:29.023

我找到了解决方案。关键是要确保在每个文档中，Chrome 将元素拆分为打印的“逻辑页面”大小相同。例如，如果一个文档有很多 200x200px 的正方形，并且 Chrome 决定将它们分组在一个 5x4 的矩形中以打印横向，那么您需要确保 Chrome 将打印所有其他一致的文档，分割成大小为 1000x800px 的元素。

对于仅是多个跨度或按顺序排列的内联块 div 的文档，只需将 div 设置为您选择的宽度（1100px），并确保该 div 在打印预览中占据整个页面宽度。然后只需确保您的 CSS 包含以下内容：

```
@media print {  
  @page {
    size: 297mm 210mm; /* landscape */
    /* you can also specify margins here: */
    margin: 25mm;
    margin-right: 45mm; /* for compatibility with both A4 and Letter */
  }
} 
```

如果这还不够，那么将所有内容放在一个或多个具有固定大小 ( `width: 1100px; height: 800px; overflow: hidden;`) 的 div 中就可以了，作为一种强制 Chrome 拆分为您想要的页面的方法（因此在打印时保持元素大小相同）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-02-17T18:13:29.197

## 允许不同的尺寸，但控制每个尺寸的边距和设计！

第一次回答时，我使用的是 Chrome 32.0.1700.107 m

为页面大小建立的[W3 CSS3 标准](http://www.w3.org/TR/css3-page/#page-size)与直接从 Chrome 的打印界面插件中的“另存为 PDF”选项配合使用非常好。

我多年来一直在为不同的项目使用不同的界面和解决方案（例如：直接从服务器生成 PDF，这在处理过程中过于繁琐且代码混乱，或者告诉用户使用 Windows 打印界面等）。这对我来说是一个很好的解决方案，而且似乎是确定的！

这是同一页面的完美示例，具有 A4 尺寸和 Letter 尺寸打印边距选项：

```
/* style sheet for "A4" printing */
 @media print and (width: 21cm) and (height: 29.7cm) {
    @page {
       margin: 3cm;
    }
 }
 /* style sheet for "letter" printing */
 @media print and (width: 8.5in) and (height: 11in) {
    @page {
        margin: 1in;
    }
 } 
```

您可以使用不同的纸张尺寸进行多次复制。额外的值（颜色、隐藏元素等）将超出@page。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-04-11T07:30:48.647

另外，如果纸张大小是 A4 和 protrait 你也可以使用这个

```
@page {
    size: A4 landscape;
} 
```

这在 Chrome 中运行

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-28T08:36:32.027

您的规则媒体查询结构不正确。尝试：

```
@media print {  
    @page {  
      size:297mm 210mm;  
    }  
}
```

至少提供了正确的语法。至于`size`属性，它是从 css2.1 中删除的，并且浏览器支持有所不同。你总是可以设置`width`, `margin`, 和/或`padding`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-26T00:14:57.133

如果您想打印到 pdf，您可以使用[https://make.cm](https://make.cm)，因为它们可以为您处理服务器负载并消除正确渲染内容的复杂性。我将它用于一个项目，它比处理 chrome 打印到 PDF 系统要容易得多

# iphone - 如何将谷歌地图添加到ios6 sdk

> ID：15603494
> 
> 赞同：1
> 
> 时间：2013-03-24T20:17:08.787
> 
> 标签：iphone, ios6, google-maps-sdk-ios

当我尝试根据此链接[Google MAP将 Google 地图添加到 ios6 时](https://developers.google.com/maps/documentation/ios/start#getting_the_google_maps_sdk_for_ios)

我获得了 API KEY 并将其放入我的应用程序中，但它崩溃了，原因是“Google MAP SDK for ios 必须通过 [GMSServices ProvideAPIKey:...] 进行初始化”

任何人都可以帮助我，给我视频如何做任何事情......

```
 #import "AppDelegate.h"
#import <GoogleMaps/GoogleMaps.h>
#import "ViewController.h"

@implementation AppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
// Override point for customization after application launch.
self.viewController = [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];
self.window.rootViewController = self.viewController;
[self.window makeKeyAndVisible];
return YES;
[GMSServices provideAPIKey:@"AIzaSyBoOGGGQnvDydbKcxGeB1of6wu2ibE6Rjk"];

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-25T00:18:31.270

你在这里做了[第8步](https://developers.google.com/maps/documentation/ios/start#adding_the_google_maps_sdk_for_ios_to_your_project)吗？

如果你这样做了，你能用你的方法的代码更新你的问题`application:didFinishLaunchingWithOptions:`吗？

**更新：**

将调用移到方法中`[GMSServices provideAPIKey:]`更高的位置，即`application:didFinishLaunchingWithOptions:`此行之前的某个位置：

```
self.window.rootViewController = self.viewController; 
```

此行设置根视图控制器，这将导致分配视图控制器的根视图，方法是调用`loadView`. 在 Google 的示例代码`loadView`中创建了`GMSMapView`，因此使用您现在拥有的代码，您试图`GMSMapView`在提供 API 密钥之前创建一个，这会导致 iOS 版 Google Maps SDK 崩溃。

顺便说一句，您`[GMSServices provideAPIKey:]`在 return 语句之后调用了 to，所以它永远不会被调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-27T04:50:54.220

像这样开始你的代表而不是你的：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    [GMSServices provideAPIKey:@"AIzaSyB2LJ2ppIVtkNh0lkG9J1tXW2RcHtI0FKY"];
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    //////

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-08T11:52:44.493

如果您移动它但仍然出现错误，这就是我所做的：

将文件**GoogleMaps.bundle**文件复制到 Xcode 中的框架文件夹中

*“GoogleMaps.framework/Versions/A/Resources/GoogleMaps.bundle”*

..并确保它在“复制捆绑资源”下的目标（而不是项目）构建阶段设置中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-14T12:54:05.137

我移动了这条线：

```
[GMSServices provideAPIKey:@"myAPIKey"]; 
```

在方法**viewDidLoad**中，现在它可以工作了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-25T04:46:09.603

将您的 GMSServices 提供 APIKey 移动到 didFinishLaunchingWithOptions 的顶部，这将解决您的问题，因为现在您在提供 API 密钥之前返回。

# php - Ajax 表单未提交

> ID：15603496
> 
> 赞同：1
> 
> 时间：2013-03-24T20:17:22.210
> 
> 标签：php, jquery, ajax

我正在尝试从 jQuery Modal 表单发送一个非常简单的登录表单。

```
$(  "#dialog-form"  ).dialog({
    var url = "../scripts/sign_up.php"; 
    $.ajax({
        type: "POST",
        url: url,
        data: $("#dialog-form").serialize(),
        success: function(data){
            alert("it works")
        }
    });
}); 
```

这是我尝试 Ajax 的第一次真正尝试，但我在获取成功方法时遇到了问题。我检查了我的脚本是否在正确的位置，并且 dialog_form 具有正确的 ID。

我是否错误地发送了此信息？有没有解决 Ajax 请求问题的好方法？

现在我只是想让信息通过，简单的问题是删除表单的其他代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-24T20:20:58.790

首先，我可能还建议`error`向您的 Ajax 请求添加一个函数 - 它可能有助于错误处理：

```
error: function (jqXHR, textStatus, errorThrown) {
    alert(textStatus);
    alert(errorThrown);
} 
```

其次，您如何将数据从脚本发送回 Ajax 请求？如果您没有回显脚本中的任何数据，则请求不会知道脚本已成功运行。

因此，您可能希望将以下内容添加到您的 AJAX 调用中：

```
dataType: "json", 
```

然后从您的 PHP 脚本返回数据，如下所示：

```
$data = array("success"=> true);
echo json_encode($data);
exit; 
```

完整（使用您的脚本）：

```
$(  "#dialog-form"  ).dialog({
    var url = "../scripts/sign_up.php";
    $.ajax({
        type: "POST",
        url: url,
        dataType: "json",
        data: $("#dialog-form").serialize(),
        success: function(data) {
            if (data.success) {
                alert("it works")
            }
            else {
               alert("it failed, but no server error!");
            }
        }
        error: function (jqXHR, textStatus, errorThrown) {
            alert("server error");
            alert(textStatus);
            alert(errorThrown);
        }
    });
}); 
```

# php - xampp 或 apache 在某些页面 WordPress 中不起作用

> ID：15603497
> 
> 赞同：0
> 
> 时间：2013-03-24T20:17:22.137
> 
> 标签：php, wordpress, apache, xampp, hosting

我在 windows server 2003 上安装 xampp。

起初我将我的 wp 移动到服务器上进行托管。

但是当我打开索引页面时，我知道一切都很好，但是 3 图像源是相同的：

```
<img class="cover" src="<? bloginfo('template_url'); ?>/images/s1.jpg" alt="[HTML & CSS]"/> 
```

或一些数据：

```
<li class="<? if(is_home()) echo 'current_page_item'; ?>"><a href="#"> first page</a></li> 
```

并且在所有页面中包括在第一页：

```
<?

/**

 * @package WordPress

 * @subpackage magazine_obsession

 */

require_once('fn-admin.php');

require_once('thman-settings.php');

require_once('thman-settings-pages.php');

add_action('admin_menu', 'thman_add_menu'); 

?> 
```

当我尝试转到 wp-admin 显示顶部消息时，wp-admin 不会显示给我。

问题是什么？为什么相同的 php 文件执行得很好但其中一些没有？这个问题是 apache 还是 wp 还是 xammp ？

我该如何解决？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:38:26.820

您发布的所有示例都使用短 ( `<? ?>`) 标签变体。您可以考虑将它们更改为，`<?php ?>`或者更简单的解决方案可能只是[`short_open_tag`](http://www.php.net/manual/en/ini.core.php#ini.short-open-tag)在您的 php.ini 中启用

# php - 带有插入和更新查询的 php mysqli

> ID：15603504
> 
> 赞同：-1
> 
> 时间：2013-03-24T20:18:11.307
> 
> 标签：php, mysql, forms, jquery

我正在创建一个反馈表单，用户可以在其中使用 php mysqli 编写他们的反馈并将其存储在数据库中，而无需刷新整个页面。我收到了成功消息，但没有任何输入的数据，谁能帮助我？我昨天问了同样的问题[php mysqli 插入和更新查询](https://stackoverflow.com/questions/15593423/php-mysqli-insert-and-update-queries/15595900?noredirect=1#15595900)

# 反馈表格.php

```
<?php

session_start();

 $login = ($_SESSION['login']);
   $userid = ($_SESSION['user_id']);
   $login_user = ($_SESSION['username']);
   $fname = ($_SESSION['first_name']);
   $lname = ($_SESSION['last_name']);
   $sessionaddres =($_SESSION['address']);

?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>feedback page</title>
    <script type = "text/javascript" src = "http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <link href="style/stylesheet.css"rel="stylesheet" type="text/css"/>

    <script type = "text/javascript">

    $(function(){

       $('#submit').click(function(){
         $('#container').append('<img src = "images/loading.gif" alt="Currently loading" id = "loading" />');

             var comments = $('#comments').val();

             $.ajax({

                url: 'feedback_process.php',
                type: 'POST',
                data: {"comments": comments},

                success: function(result){
                     $('#response').remove();
                     $('#container').append('<p id = "response">' + result + '</p>');
                     $('#loading').fadeOut(500, function(){
                         $(this).remove();
                     });

                }

             });         

            return false;

       });

    });

    </script>

    </head>
<?php require_once('header.php'); ?>

<body>
<form action = "feedback_form.php" method = "post">
  <div id = "container">
            <h2><?php echo $login_user ?></h2>

          <label for = "comments">Comments</label>
          <textarea rows = "5"cols = "35" name = "comments" id = "comments"></textarea>
          <br />
  </div>
   </form>
       <input type = "submit" name = "submit" id = "submit" value = "send feedBack" />

</body>
</html> 
```

# 反馈过程.php

```
<?php

session_start();

 $login = ($_SESSION['login']);
   $userid = ($_SESSION['user_id']);
   $login_user = ($_SESSION['username']);
   $fname = ($_SESSION['first_name']);
   $lname = ($_SESSION['last_name']);
   $sessionaddres =($_SESSION['address']);

$conn = new mysqli('localhost', 'root', 'root', 'lam_el_chamel_db');

  echo"<pre>";
  print_r($_POST);
  echo"</pre>";

  if(isset($_POST['comments'])){

  $comments = $_POST['comments'];

  $query = "INSERT into feedback (feedback_text, user_name,) VALUES(?,?)";

  $stmt = $conn->stmt_init();
  if($stmt->prepare($query))
  {

     $stmt->bind_param('ss', $comments, $login_user);
     $stmt->execute();

  }
  $query2 = "UPDATE feedback SET feedback_text = ?, user_name = ? WHERE user_name = ? ";
  $stmt = $conn->stmt_init();
  if($stmt->prepare($query2))
  {
     $stmt->bind_param('sss', $comments, $login_user, $login_user);
     $stmt->execute();

  }

  if($stmt){

  echo "thank you .we will be in touch soon <br />";

  }
  else{
   echo "there was an error. try again later.";
   }  

}

else
   echo"it is a big error";
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T23:21:59.163

第一：不要问两次。您不会因为您回答两次而得到更好或更快的答案...

成功消息只是告诉您您已经成功*访问*​​了一个文件（而不是其他任何内容）。基于此，我会尝试使用“虚拟”注释和“虚拟”登录用户单独运行 feedback_process.php（不涉及feedback_form.php）。当插入查询不起作用时，我还添加了“失败”的输出......（您的代码实际上只是为更新反馈查询（最后一个）实现了成功与否）

我希望下面的代码对您有所帮助...

```
<?php
session_start();

$login = ($_SESSION['login']); 
$userid = ($_SESSION['user_id']);
$login_user = ($_SESSION['username']);
$fname = ($_SESSION['first_name']);
$lname = ($_SESSION['last_name']);
$sessionaddres =($_SESSION['address']);

$conn = new mysqli('localhost', 'root', 'root', 'lam_el_chamel_db');

echo"<pre>";
print_r($_POST);
echo"</pre>";

//Some dummys for debugging
$comments = 'This is the comments'; 
$login_user = 'FOO';

$query = "INSERT into feedback (feedback_text, user_name) VALUES(?,?)";

$stmt = $conn->stmt_init();
if($stmt->prepare($query)) {
    $stmt->bind_param('ss', $comments, $login_user);
    $stmt->execute();
}
else {
    echo 'FAILED!';
}

$query2 = "UPDATE feedback SET feedback_text = ?, user_name = ? WHERE user_name = ? ";
$stmt = $conn->stmt_init();
if($stmt->prepare($query2)) {
    $stmt->bind_param('sss', $comments, $login_user, $login_user);
    $stmt->execute();
}
else {
    echo 'FAILED!';
}

if($stmt){
    echo "thank you .we will be in touch soon <br />";
}
else {
    echo "there was an error. try again later.";
}  

?> 
```

# date - 如何在 apache thrift 中表示日期类型

> ID：15603505
> 
> 赞同：5
> 
> 时间：2013-03-24T20:18:15.287
> 
> 标签：date, types, thrift

我正在使用[apache thrift](http://thrift.apache.org/)开发服务，我需要定义时间段。日期很重要（`YYYY-mm-dd`），时间应完全省略（`HH:ii:ss`）。我找不到任何特定的日期/日期时间节俭数据类型，所以我正在考虑两种方法：

1.  更复杂

    ```
    int year,
    int month,
    int day, 
    ```

2.  不太复杂，但包括我不需要的时间部分。

    ```
    int timestamp 
    ```

是否有一种通用的节俭方法来表示日期（时间）类型？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T20:33:54.730

我认为 Thrift IDL 上没有日期表示。我们在我们的项目中使用这个符号。

```
typedef string Timestamp 
```

然后在需要像这样使用时间戳的后续模型上使用该符号

```
struct blah{

    /**
    * TODO:list what notation this dateTime represents. eg ISO-8601
    * or if its in the format like YYYY-mm-DD you mentioned.
    */
    1:Timestamp dateTime;

    } 
```

字符串使使用[JODA 操作更容易](http://joda-time.sourceforge.net/)

- 编辑 -

我不知道您打算存储什么时间戳。例如，如果你想计算一个事务已经发生的当前实例并将其存储到那个 thrift 对象中，你可以使用 Joda 来做到这一点。

```
 String timestamp = new DateTime().toString("YYYY-MM-dd"); //2013-03-26 This will be string value generated. It will convert the current time to format you seek to output.
    //Use the generated thrift object.
    Blah newblah = new Blah();
    blah.setDateTime(timestamp); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T16:34:05.350

我不知道某些特定的格式偏好。我通常使用十进制编码的日期表示，因为它非常紧凑且易于阅读，如下所示：`20130325`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-22T18:52:38.033

您可以创建一个结构来代表您 ThriftDate：

```
struct ThriftDate {
  1: i32 year;
  2: i32 month;
  3: i32 day;
} 
```

# ios - 在 iphone 4 中使用 AVAssetWriter 跳过帧捕获电影

> ID：15603508
> 
> 赞同：1
> 
> 时间：2013-03-24T20:18:16.357
> 
> 标签：ios, buffer, avfoundation, avassetwriter

我正在尝试使用 AVAssetWriter 捕捉电影，在 iphone 5 中一切正常，捕捉和保存电影就像一个魅力。

但是当我尝试在 iphone 4 中捕获电影时，样本缓冲区会跳过一些帧并且电影不好。

所以，这是我的代码：

```
- (void) initCaptureSession{
//  openSession and set quality to 1280x720
    session                             = [[AVCaptureSession alloc] init];
    if([session canSetSessionPreset:AVCaptureSessionPreset640x480]) session.sessionPreset = AVCaptureSessionPresetHigh;

//  get devices for audio and video
    deviceVideo                         = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];
    deviceAudio                         = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeAudio];

    NSError *error                      = nil;

//  create input of audio and video
    inputVideo                          = [AVCaptureDeviceInput deviceInputWithDevice:deviceVideo error:&error];
    if (!inputVideo)    NSLog(@"ERROR: trying to open camera: %@", error);

    inputAudio                          = [AVCaptureDeviceInput deviceInputWithDevice:deviceAudio error:&error];
    if (!inputAudio)    NSLog(@"ERROR: trying to open audio: %@", error);

//    CMTime maxDuration                  = CMTimeMake(60, 1);

//  create output audio and video
    outputVideo                         = [[AVCaptureVideoDataOutput alloc] init];
    outputVideo.alwaysDiscardsLateVideoFrames = NO;
    outputVideo.videoSettings           = [NSDictionary dictionaryWithObject: [NSNumber numberWithInt:kCVPixelFormatType_32BGRA] forKey:(id)kCVPixelBufferPixelFormatTypeKey];

    outputAudio                         = [[AVCaptureAudioDataOutput alloc] init];   

//  add inputs and outputs in the current session
    [session beginConfiguration];
    if ([session canAddInput:inputVideo])[session addInput:inputVideo];
    if ([session canAddInput:inputAudio])[session addInput:inputAudio];
    if ([session canAddOutput:outputVideo]) [session addOutput:outputVideo];
    if ([session canAddOutput:outputAudio]) [session addOutput:outputAudio];
    [session commitConfiguration];

//  tourn of the torch
    [deviceVideo lockForConfiguration:&error];
    if([deviceVideo hasTorch] && [deviceVideo isTorchModeSupported:AVCaptureTorchModeOff]) [deviceVideo setTorchMode:AVCaptureTorchModeOff];
    [deviceVideo unlockForConfiguration];

    [self configDevice];

//  create the preview view to show the video
    captureVideoPreviewLayer            = [[AVCaptureVideoPreviewLayer alloc] initWithSession:session];
    [captureVideoPreviewLayer setBackgroundColor:[[UIColor blackColor] CGColor]];
    [captureVideoPreviewLayer setVideoGravity:AVLayerVideoGravityResizeAspectFill];

    captureVideoPreviewLayer.frame      = viewPreview.bounds;
    [viewPreview.layer addSublayer:captureVideoPreviewLayer];

    CALayer *viewLayer                  = viewPreview.layer;

    [viewLayer setMasksToBounds:YES];
    [captureVideoPreviewLayer setFrame:[viewLayer bounds]];
    [viewLayer addSublayer:captureVideoPreviewLayer];

//  dispatch outputs to delegate in a queue
    dispatch_queue_t queue = dispatch_queue_create("MyQueue", NULL);
    [outputVideo setSampleBufferDelegate:self queue:queue];
    [outputAudio setSampleBufferDelegate:self queue:queue];
//    dispatch_release(queue);

    [session startRunning];
}

-(BOOL) setupWriter{    
    urlOutput           = [self tempFileURL];
    NSError *error      = nil;

    videoWriter         = [[AVAssetWriter alloc] initWithURL:urlOutput fileType:AVFileTypeMPEG4 error:&error];
    NSParameterAssert(videoWriter);

//  Add metadata  
    NSArray *existingMetadataArray      = videoWriter.metadata;
    NSMutableArray *newMetadataArray    = nil;
    if (existingMetadataArray) {
        newMetadataArray = [existingMetadataArray mutableCopy];
    } else {
        newMetadataArray = [[NSMutableArray alloc] init];
    }

    AVMutableMetadataItem *mutableItemLocation  = [[AVMutableMetadataItem alloc] init];
    mutableItemLocation.keySpace                = AVMetadataKeySpaceCommon;
    mutableItemLocation.key                     = AVMetadataCommonKeyLocation;
    mutableItemLocation.value                   = [NSString stringWithFormat:@"%+08.4lf%+09.4lf/", location.latitude, location.longitude];

    AVMutableMetadataItem *mutableItemModel     = [[AVMutableMetadataItem alloc] init];
    mutableItemModel.keySpace                   = AVMetadataKeySpaceCommon;
    mutableItemModel.key                        = AVMetadataCommonKeyModel;
    mutableItemModel.value                      = [[UIDevice currentDevice] model];

    [newMetadataArray addObject:mutableItemLocation];
    [newMetadataArray addObject:mutableItemModel];

    videoWriter.metadata = newMetadataArray;

//  video Configuration
    NSDictionary *videoCleanApertureSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                                [NSNumber numberWithInt:640], AVVideoCleanApertureWidthKey,
                                                [NSNumber numberWithInt:360], AVVideoCleanApertureHeightKey,
                                                [NSNumber numberWithInt:2], AVVideoCleanApertureHorizontalOffsetKey,
                                                [NSNumber numberWithInt:2], AVVideoCleanApertureVerticalOffsetKey,
                                                nil];

    NSDictionary *videoAspectRatioSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                              [NSNumber numberWithInt:1], AVVideoPixelAspectRatioHorizontalSpacingKey,
                                              [NSNumber numberWithInt:1],AVVideoPixelAspectRatioVerticalSpacingKey,
                                              nil];

    NSDictionary *codecSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                   [NSNumber numberWithInt:1024000], AVVideoAverageBitRateKey,
                                   [NSNumber numberWithInt:90],AVVideoMaxKeyFrameIntervalKey,
                                   videoCleanApertureSettings, AVVideoCleanApertureKey,
                                   videoAspectRatioSettings, AVVideoPixelAspectRatioKey,
                                   AVVideoProfileLevelH264Main30, AVVideoProfileLevelKey,
                                   nil];

    NSDictionary *videoSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                   AVVideoCodecH264, AVVideoCodecKey,
                                   codecSettings,AVVideoCompressionPropertiesKey,
                                   [NSNumber numberWithInt:640], AVVideoWidthKey,
                                   [NSNumber numberWithInt:360], AVVideoHeightKey,
                                   nil];

    videoWriterInput = [AVAssetWriterInput assetWriterInputWithMediaType:AVMediaTypeVideo outputSettings:videoSettings];

    NSParameterAssert(videoWriterInput);
    videoWriterInput.expectsMediaDataInRealTime = YES;

    // Add the audio input
    AudioChannelLayout acl;
    bzero( &acl, sizeof(acl));
    acl.mChannelLayoutTag = kAudioChannelLayoutTag_Stereo;

    NSDictionary* audioOutputSettings = nil;
    // Both type of audio inputs causes output video file to be corrupted.
//    if( NO ) {
        // should work from iphone 3GS on and from ipod 3rd generation
        audioOutputSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                               [ NSNumber numberWithInt: kAudioFormatMPEG4AAC ], AVFormatIDKey,
                               [ NSNumber numberWithInt: 2 ], AVNumberOfChannelsKey,
                               [ NSNumber numberWithFloat: 44100.0 ], AVSampleRateKey,
                               [ NSNumber numberWithInt: 64000 ], AVEncoderBitRateKey,
                               [ NSData dataWithBytes: &acl length: sizeof( acl ) ], AVChannelLayoutKey,
                               nil];
//    } else {
//        // should work on any device requires more space
//        audioOutputSettings = [ NSDictionary dictionaryWithObjectsAndKeys:
//                               [ NSNumber numberWithInt: kAudioFormatAppleLossless ], AVFormatIDKey,
//                               [ NSNumber numberWithInt: 16 ], AVEncoderBitDepthHintKey,
//                               [ NSNumber numberWithFloat: 44100.0 ], AVSampleRateKey,
//                               [ NSNumber numberWithInt: 1 ], AVNumberOfChannelsKey,
//                               [ NSData dataWithBytes: &acl length: sizeof( acl ) ], AVChannelLayoutKey,
//                               nil ];
//    }

    audioWriterInput = [AVAssetWriterInput assetWriterInputWithMediaType: AVMediaTypeAudio outputSettings: audioOutputSettings];

    audioWriterInput.expectsMediaDataInRealTime = YES;  

    // add input
    [videoWriter addInput:videoWriterInput];
    [videoWriter addInput:audioWriterInput];

    return YES;
}

- (void)captureOutput:(AVCaptureOutput *)captureOutput didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection *)connection{
    if( !CMSampleBufferDataIsReady(sampleBuffer) ){
        NSLog( @"sample buffer is not ready. Skipping sample" );
        return;
    }

    if(isRecording == YES ){
        lastSampleTime = CMSampleBufferGetPresentationTimeStamp(sampleBuffer);
        if(videoWriter.status != AVAssetWriterStatusWriting  ){
            [videoWriter startWriting];
            [videoWriter startSessionAtSourceTime:lastSampleTime];
        }

        if( captureOutput == outputVideo ){
            [self newVideoSample:sampleBuffer];
        } else if( captureOutput == outputAudio) {
            [self newAudioSample:sampleBuffer];
        }
    }
}

-(void) newVideoSample:(CMSampleBufferRef)sampleBuffer{
    if( isRecording ){
        if( videoWriter.status > AVAssetWriterStatusWriting ) {
            NSLog(@"Warning: writer status is %d", videoWriter.status);
            if( videoWriter.status == AVAssetWriterStatusFailed )
                NSLog(@"Error: %@", videoWriter.error);
            return;
        }        

        while (!videoWriterInput.readyForMoreMediaData) {
            NSDate *maxDate = [NSDate dateWithTimeIntervalSinceNow:0.1];
            [[NSRunLoop currentRunLoop] runUntilDate:maxDate];
        }

        if( ![videoWriterInput appendSampleBuffer:sampleBuffer] )
            NSLog(@"Unable to write to video input");
    }
}

-(void) newAudioSample:(CMSampleBufferRef)sampleBuffer{
    if( isRecording ){
        if( videoWriter.status > AVAssetWriterStatusWriting ) {
            NSLog(@"Warning: writer status is %d", videoWriter.status);
            if( videoWriter.status == AVAssetWriterStatusFailed )
                NSLog(@"Error: %@", videoWriter.error);
            return;
        }

        while (!audioWriterInput.readyForMoreMediaData) {
             NSDate *maxDate = [NSDate dateWithTimeIntervalSinceNow:0.1];
            [[NSRunLoop currentRunLoop] runUntilDate:maxDate];
        }

        if( ![audioWriterInput appendSampleBuffer:sampleBuffer] )
            NSLog(@"Unable to write to audio input");
    }
}

-(void) startVideoRecording {
    if( !isRecording ){
        NSLog(@"start video recording...");
        if( ![self setupWriter] ) {
            NSLog(@"Setup Writer Failed") ;

            return;
        }

        isRecording = YES;
        recorded    = NO;
    }
}

-(void) stopVideoRecording {
    if( isRecording ) {
        isRecording                 = NO;
        btRecord.hidden             = NO;
        btRecording.hidden          = YES;
        [timerToRecord invalidate];
        timerToRecord               = nil;

//        [session stopRunning];

        [videoWriter finishWritingWithCompletionHandler:^{
            if (videoWriter.status != AVAssetWriterStatusFailed && videoWriter.status == AVAssetWriterStatusCompleted) {
                videoWriterInput    = nil;
                audioWriterInput    = nil;
                videoWriter         = nil;

                NSLog(@"finishWriting returned succeful");

                recorded    = YES;
            } else {
                NSLog(@"finishWriting returned unsucceful") ;
            }
        }];    

        NSLog(@"video recording stopped");

        [self performSelector:@selector(openPlayer) withObject:nil afterDelay:0.5];
    }
} 
```

当我删除此行时：

```
 while (!audioWriterInput.readyForMoreMediaData) {
             NSDate *maxDate = [NSDate dateWithTimeIntervalSinceNow:0.1];
            [[NSRunLoop currentRunLoop] runUntilDate:maxDate];
        } 
```

我收到了这个错误：

*** 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“*** -[AVAssetWriterInput appendSampleBuffer:] 当 readyForMoreMediaData 为 NO 时，无法附加样本缓冲区。”

在 iphone 5 中我没有使用这个循环。

我在这里阅读了一些示例，但我不明白如何在 iphone 4 中使电影更流畅。

如果有人有使用 AVAssetWriter 为 iphone 3gs、iphone 4、iphone 4s 和 iphone 5 制作电影的建议或完整示例，我将非常感谢。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T01:31:25.427

经过一周与 AVFoundation 的斗争，我得到了一个很好的解决方案。

观看 wwdc2012 - session 520 之后，我提出了一个很好的解决方案。

首先，我使用 AVCaptureMovieFileOutput 和 session presset AVCaptureSessionPreset640x480 录制电影

因此，在录制用户选择是否要保存和共享后，只需保存或删除电影即可。

如果用户想要保存/保存和共享，我会分别录制和压缩电影。

首先，我压缩电影，然后压缩音频并标记轨道。

查看我的代码：

```
-(void)exportMediaWithURL:(NSURL *)url location:(CLLocationCoordinate2D)location mirror:(BOOL)mirror{
    urlMedia                        = url;
    locationMedia                   = location;

    videoRecorded                   = NO;
    audioRecorded                   = NO;

    asset                           = [AVAsset assetWithURL:urlMedia];

    progressVideo                   = 0.0;
    progressAudio                   = 0.0;
    progressMarge                   = 0.0;
    progressFactor                  = 3.0;

    mirrored                        = mirror;

    limitTime                       = CMTimeMake(1000*60, 1000);

    [asset loadValuesAsynchronouslyForKeys:[NSArray arrayWithObject:@"tracks"] completionHandler:^() {
        NSError *error;
        AVKeyValueStatus stats      = [asset statusOfValueForKey:@"tracks" error:&error];

        if(stats == AVKeyValueStatusLoaded){
            if([[asset tracksWithMediaType:AVMediaTypeVideo] count] > 0) video_track = [[asset tracksWithMediaType:AVMediaTypeVideo] objectAtIndex:0];
            if([[asset tracksWithMediaType:AVMediaTypeAudio] count] > 0) audio_track = [[asset tracksWithMediaType:AVMediaTypeAudio] objectAtIndex:0];

            if(!audio_track) progressFactor = 1.0;            
            if(video_track){
                if (CMTimeCompare(asset.duration, limitTime) > 0) {
                    totalTime = limitTime;
                }else{
                    totalTime = asset.duration;
                }
                [self exportVideo];
            }
        }
    }];
}

-(void)exportVideo{
    NSError *error;
    AVAssetReader *assetReader          = [AVAssetReader assetReaderWithAsset:asset error:&error];

    NSDictionary* videoSettings         = [NSDictionary dictionaryWithObject:[NSNumber numberWithUnsignedInt:kCVPixelFormatType_32BGRA] forKey:(NSString*)kCVPixelBufferPixelFormatTypeKey];

    AVAssetReaderOutput *videoOutput    = [AVAssetReaderTrackOutput assetReaderTrackOutputWithTrack:video_track outputSettings:videoSettings];

    [assetReader addOutput:videoOutput];

    assetReader.timeRange               = CMTimeRangeMake(kCMTimeZero, totalTime);

//  start session to make a movie
    if (assetVideoWriter.status == AVAssetWriterStatusUnknown) {
        if ([self setupWriterVideo]) {
            if ([assetVideoWriter startWriting]) {
                [assetVideoWriter startSessionAtSourceTime:kCMTimeZero];
            }
        }
    }            

    if([assetReader startReading]){                
        BOOL videoDone = NO;

        CMSampleBufferRef bufferVideo;

        while (!videoDone) {
            if ([assetReader status]== AVAssetReaderStatusReading ) bufferVideo = [videoOutput copyNextSampleBuffer];

            if(bufferVideo){
                [self newVideoSample:bufferVideo];
                CFRelease(bufferVideo);
            }else{
                videoDone = YES;
            }
        }

//      finish
        [videoWriterInput markAsFinished];
        [assetVideoWriter finishWritingWithCompletionHandler:^{}];

        //  gambiarra to resolve the dealloc problem when use a block to delegate something
        while (!videoRecorded) {
            if (assetVideoWriter.status == AVAssetWriterStatusCompleted) {
                videoWriterInput    = nil;
                assetVideoWriter    = nil;

                videoRecorded       = YES;

                if (audio_track) {
                    [self exportAudio];
                }else{
                    NSMutableDictionary *infoToSend = [NSMutableDictionary new];
                    [infoToSend setValue:urlOutputVideo forKey:@"url_media"];
                    [[NSNotificationCenter defaultCenter] postNotificationName:EXPORT_STATUS_DONE object:self userInfo:infoToSend];
                }
            }
        }
    }
}

-(void)exportAudio{            
    NSError *error;    
    AVAssetReader *assetReader          = [AVAssetReader assetReaderWithAsset:asset error:&error];

    NSDictionary* audioSettings         = [NSDictionary dictionaryWithObjectsAndKeys:[NSNumber numberWithInt:kAudioFormatLinearPCM], AVFormatIDKey, nil];

    AVAssetReaderOutput *audioOutput    = [AVAssetReaderTrackOutput assetReaderTrackOutputWithTrack:audio_track outputSettings:audioSettings];

    [assetReader addOutput:audioOutput];

     assetReader.timeRange               = CMTimeRangeMake(kCMTimeZero, totalTime);

//   start session to make a movie
    if (assetAudioWriter.status == AVAssetWriterStatusUnknown) {
        if ([self setupWriterAudio]) {
            if ([assetAudioWriter startWriting]) {
                [assetAudioWriter startSessionAtSourceTime:kCMTimeZero];
            }
        }
    }

    if([assetReader startReading]){                
        BOOL audioDone = NO;

        CMSampleBufferRef bufferAudio;

        while (!audioDone) {                    
            if ([assetReader status]== AVAssetReaderStatusReading ) bufferAudio = [audioOutput copyNextSampleBuffer];

            if(bufferAudio){                     
                [self newAudioSample:bufferAudio];
                CFRelease(bufferAudio);
            }else{
                audioDone = YES;
            }
        }

//      finish
        [audioWriterInput markAsFinished];
        [assetAudioWriter finishWritingWithCompletionHandler:^{}];

//      gambiarra to resolve the dealloc problem when use a block to delegate something
        while (!audioRecorded) {
            if (assetAudioWriter.status == AVAssetWriterStatusCompleted) {
                audioWriterInput    = nil;
                assetAudioWriter    = nil;

                audioRecorded       = YES;

                [self margeFile];
            }
        }                
    }
}

-(void)margeFile{    
    AVURLAsset *assetVideo                              = [AVURLAsset assetWithURL:urlOutputVideo];
    AVAssetTrack *video_track_marge                     = [[assetVideo tracksWithMediaType:AVMediaTypeVideo] objectAtIndex:0];

    AVURLAsset *assetAudio                              = [AVURLAsset assetWithURL:urlOutputAudio];
    AVAssetTrack *audio_track_marge                     = [[assetAudio tracksWithMediaType:AVMediaTypeAudio] objectAtIndex:0];

    CMTime startTime                                    = CMTimeMake(1, 1);
    CMTimeRange timeRangeVideo                          = CMTimeRangeMake(kCMTimeZero, assetVideo.duration);
    CMTimeRange timeRangeAudio                          = CMTimeRangeMake(kCMTimeZero, assetAudio.duration);

    AVMutableComposition * composition                  = [AVMutableComposition composition];
    AVMutableCompositionTrack *compositionVideoTrack    = [composition addMutableTrackWithMediaType:AVMediaTypeVideo preferredTrackID:kCMPersistentTrackID_Invalid];
    if(mirrored) compositionVideoTrack.preferredTransform = CGAffineTransformMakeRotation(M_PI);
    AVMutableCompositionTrack *compositionAudioTrack    = [composition addMutableTrackWithMediaType:AVMediaTypeAudio preferredTrackID:kCMPersistentTrackID_Invalid];

    NSError *error;

    [compositionVideoTrack insertTimeRange:timeRangeVideo ofTrack:video_track_marge atTime:startTime error:&error];
    [compositionAudioTrack insertTimeRange:timeRangeAudio ofTrack:audio_track_marge atTime:startTime error:&error];

    AVAssetExportSession *exportSession                 = [[AVAssetExportSession alloc] initWithAsset:composition presetName:AVAssetExportPresetPassthrough];
    exportSession.outputFileType                        = AVFileTypeAppleM4V;
    exportSession.outputURL                             = [self tempFileURL:media_mixed];
    exportSession.shouldOptimizeForNetworkUse           = YES;
    exportSession.metadata                              = newMetadataArray;

    exportSession.timeRange                             = CMTimeRangeMake(CMTimeMakeWithSeconds(1.0, 600), totalTime);

    [exportSession exportAsynchronouslyWithCompletionHandler:^{
        NSMutableDictionary *infoToSend = [NSMutableDictionary new];

        switch (exportSession.status) {
            case AVAssetExportSessionStatusCompleted:
                [infoToSend setValue:exportSession.outputURL forKey:@"url_media"];                
                [[NSNotificationCenter defaultCenter] postNotificationName:EXPORT_STATUS_DONE object:self userInfo:infoToSend];
                break;

            case AVAssetExportSessionStatusExporting:
                [[NSNotificationCenter defaultCenter] postNotificationName:EXPORT_STATUS_EXPORTING object:self];
                break;

            case AVAssetExportSessionStatusFailed:
                NSLog(@"failed");
                break;
        }

    }];

    while (exportSession.status == AVAssetExportSessionStatusExporting) {        
        progressMarge = exportSession.progress;

        [self postProgress];
    }
}

-(BOOL) setupWriterVideo{
    urlOutputVideo                              = [self tempFileURL:media_video];
    NSError *error                              = nil;

    assetVideoWriter                            = [[AVAssetWriter alloc] initWithURL:urlOutputVideo fileType:AVFileTypeMPEG4 error:&error];
    NSParameterAssert(assetVideoWriter);

    //  Add metadata
    NSArray *existingMetadataArray              = assetVideoWriter.metadata;
    if (existingMetadataArray) {
        newMetadataArray = [existingMetadataArray mutableCopy];
    } else {
        newMetadataArray = [[NSMutableArray alloc] init];
    }

    AVMutableMetadataItem *mutableItemLocation  = [[AVMutableMetadataItem alloc] init];
    mutableItemLocation.keySpace                = AVMetadataKeySpaceCommon;
    mutableItemLocation.key                     = AVMetadataCommonKeyLocation;
    mutableItemLocation.value                   = [NSString stringWithFormat:@"%+08.4lf%+09.4lf/", locationMedia.latitude, locationMedia.longitude];

    AVMutableMetadataItem *mutableItemModel     = [[AVMutableMetadataItem alloc] init];
    mutableItemModel.keySpace                   = AVMetadataKeySpaceCommon;
    mutableItemModel.key                        = AVMetadataCommonKeyModel;
    mutableItemModel.value                      = [[UIDevice currentDevice] model];

    [newMetadataArray addObject:mutableItemLocation];
    [newMetadataArray addObject:mutableItemModel];

    assetVideoWriter.metadata                    = newMetadataArray;
    assetVideoWriter.shouldOptimizeForNetworkUse = YES;

    videoWriterInput                            = [AVAssetWriterInput assetWriterInputWithMediaType:AVMediaTypeVideo outputSettings:[self videoConfiguration]];
    NSParameterAssert(videoWriterInput);
    videoWriterInput.expectsMediaDataInRealTime = NO;

//  add input
    [assetVideoWriter addInput:videoWriterInput];

    return YES;
}

-(BOOL) setupWriterAudio{
    urlOutputAudio                              = [self tempFileURL:media_audio];
    NSError *error                              = nil;

    assetAudioWriter                            = [[AVAssetWriter alloc] initWithURL:urlOutputAudio fileType:AVFileTypeAppleM4A error:&error];
    NSParameterAssert(assetAudioWriter);

    audioWriterInput                            = [AVAssetWriterInput assetWriterInputWithMediaType:AVMediaTypeAudio outputSettings:[self audioConfiguration]];
    audioWriterInput.expectsMediaDataInRealTime = NO;

    // add input
    [assetAudioWriter addInput:audioWriterInput];

    return YES;
}

- (NSDictionary *)videoConfiguration{
    //  video Configuration
    //    float bitsPerPixel;
    //    int numPixels = 640.0 * 360.0;
    //  int bitsPerSecond;
    //
    //  // Assume that lower-than-SD resolutions are intended for streaming, and use a lower bitrate
    //  if ( numPixels < (640 * 360.0) )
    //      bitsPerPixel = 4.05; // This bitrate matches the quality produced by AVCaptureSessionPresetMedium or Low.
    //  else
    //      bitsPerPixel = 11.4; // This bitrate matches the quality produced by AVCaptureSessionPresetHigh.
    //
    //  bitsPerSecond = numPixels * bitsPerPixel;

    NSDictionary *videoCleanApertureSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                                [NSNumber numberWithInt:640], AVVideoCleanApertureWidthKey,
                                                [NSNumber numberWithInt:360], AVVideoCleanApertureHeightKey,
                                                [NSNumber numberWithInt:2], AVVideoCleanApertureHorizontalOffsetKey,
                                                [NSNumber numberWithInt:2], AVVideoCleanApertureVerticalOffsetKey,
                                                nil];

    NSDictionary *videoAspectRatioSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                              [NSNumber numberWithInt:1],AVVideoPixelAspectRatioHorizontalSpacingKey,
                                              [NSNumber numberWithInt:1],AVVideoPixelAspectRatioVerticalSpacingKey,
                                              nil];

    NSDictionary *codecSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                   [NSNumber numberWithInt:1024000], AVVideoAverageBitRateKey,
                                   [NSNumber numberWithInt:90],AVVideoMaxKeyFrameIntervalKey,
                                   videoCleanApertureSettings, AVVideoCleanApertureKey,
                                   videoAspectRatioSettings, AVVideoPixelAspectRatioKey,
                                   AVVideoProfileLevelH264Main30, AVVideoProfileLevelKey,
                                   nil];

    NSDictionary *videoSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                   AVVideoCodecH264, AVVideoCodecKey,
                                   AVVideoScalingModeResizeAspectFill, AVVideoScalingModeKey,
                                   codecSettings,AVVideoCompressionPropertiesKey,
                                   [NSNumber numberWithInt:640], AVVideoWidthKey,
                                   [NSNumber numberWithInt:360], AVVideoHeightKey,
                                   nil];

    return videoSettings;
}

-(NSDictionary *)audioConfiguration{
    // Add the audio input
    AudioChannelLayout acl;
    bzero( &acl, sizeof(acl));
    acl.mChannelLayoutTag = kAudioChannelLayoutTag_Stereo;

    NSDictionary* audioOutputSettings = nil;
    // Both type of audio inputs causes output video file to be corrupted.
    //    if( NO ) {
    // should work from iphone 3GS on and from ipod 3rd generation
    audioOutputSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                           [ NSNumber numberWithInt: kAudioFormatMPEG4AAC ], AVFormatIDKey,
                           [ NSNumber numberWithInt: 2 ], AVNumberOfChannelsKey,
                           [ NSNumber numberWithFloat: 44100.0 ], AVSampleRateKey,
                           [ NSNumber numberWithInt: 128000 ], AVEncoderBitRateKey,
                           [ NSData dataWithBytes: &acl length: sizeof( acl ) ], AVChannelLayoutKey,
                           nil];
    //    } else {
    //        // should work on any device requires more space
//        audioOutputSettings = [ NSDictionary dictionaryWithObjectsAndKeys:
//                               [ NSNumber numberWithInt: kAudioFormatAppleLossless ], AVFormatIDKey,
//                               [ NSNumber numberWithInt: 16 ], AVEncoderBitDepthHintKey,
//                               [ NSNumber numberWithFloat: 44100.0 ], AVSampleRateKey,
//                               [ NSNumber numberWithInt: 2 ], AVNumberOfChannelsKey,
//                               [ NSData dataWithBytes: &acl length: sizeof( acl ) ], AVChannelLayoutKey,
//                               nil ];
    //    }

    return audioOutputSettings;
}

-(void) newVideoSample:(CMSampleBufferRef)sampleBuffer{
    if( assetVideoWriter.status > AVAssetWriterStatusWriting ) {
        if( assetVideoWriter.status == AVAssetWriterStatusFailed )
            NSLog(@"Error: %@", assetVideoWriter.error);
        return;
    }

    if (assetVideoWriter.status == AVAssetWriterStatusWriting ) {
        while (!videoWriterInput.readyForMoreMediaData) NSLog(@"waitting video");

        if (videoWriterInput.readyForMoreMediaData) {
            CMTime presTime     = CMSampleBufferGetPresentationTimeStamp( sampleBuffer );
            float valueLoading  = (presTime.value / presTime.timescale);
            float valueTotal    = (totalTime.value / totalTime.timescale);

            progressVideo       =  valueLoading / valueTotal;

            [self postProgress];

            if (![videoWriterInput appendSampleBuffer:sampleBuffer]) NSLog(@"Unable to write to video input");
        }
    }    
}

-(void) newAudioSample:(CMSampleBufferRef)sampleBuffer{
    if( assetAudioWriter.status > AVAssetWriterStatusWriting ) {
        if( assetAudioWriter.status == AVAssetWriterStatusFailed )
            NSLog(@"Error: %@", assetAudioWriter.error);
        return;
    }

    if (assetAudioWriter.status == AVAssetWriterStatusWriting ) {
        while (!audioWriterInput.readyForMoreMediaData) NSLog(@"waitting audio");

        if (audioWriterInput.readyForMoreMediaData) {
            CMTime presTime     = CMSampleBufferGetPresentationTimeStamp( sampleBuffer );
            float valueLoading  = (presTime.value / presTime.timescale);
            float valueTotal    = (totalTime.value / totalTime.timescale);

            progressAudio       =  valueLoading / valueTotal;

            [self postProgress];

            if (![audioWriterInput appendSampleBuffer:sampleBuffer]) {
                NSLog(@"Unable to write to audio input");
            }
        }
    }
}

- (void)postProgress{    
    float totalProgress = (progressVideo + progressAudio + progressMarge) / progressFactor;

    NSMutableDictionary *infoToSend = [NSMutableDictionary new];
    [infoToSend setValue:[NSNumber numberWithFloat:totalProgress] forKey:@"progress"];

    [[NSNotificationCenter defaultCenter] postNotificationName:EXPORT_STATUS_EXPORTING object:self userInfo:infoToSend];
}

- (NSURL *)tempFileURL:(int)typeMedia {
    NSString *outputPath;

    switch (typeMedia) {
        case media_video:
            outputPath          = [[NSString alloc] initWithFormat:@"%@%@", NSTemporaryDirectory(), @"output_export.mp4"];
            break;

        case media_audio:
            outputPath          = [[NSString alloc] initWithFormat:@"%@%@", NSTemporaryDirectory(), @"output_export.m4a"];
            break;

        case media_mixed:
            outputPath          = [[NSString alloc] initWithFormat:@"%@%@", NSTemporaryDirectory(), @"mixed.mp4"];
            break;
    }

    NSURL *outputURL            = [[NSURL alloc] initFileURLWithPath:outputPath];
    NSFileManager *fileManager  = [NSFileManager defaultManager];
    if ([fileManager fileExistsAtPath:outputPath]) [[NSFileManager defaultManager] removeItemAtPath:outputPath error:nil];
    return outputURL;
}

- (void) dealloc {
    NSLog(@"dealloc video exporter");
    [[NSNotificationCenter defaultCenter] removeObserver:self];

    assetVideoWriter        = nil;
    assetAudioWriter        = nil;

    videoWriterInput        = nil;
    audioWriterInput        = nil;

    urlMedia                = nil;
    urlOutputVideo          = nil;
    urlOutputAudio          = nil;
    urlOutputFinal          = nil;
}

@end 
```

如果有人有什么要补充的，请在这里发帖！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-14T08:31:03.330

设置 AVAssetWriterInput.outputSettings[AVVideoCompressionPropertiesKey][AVVideoAllowFrameReorderingKey] = @(NO) [在此处输入图像描述](https://i.stack.imgur.com/QXJNt.jpg)

# matlab - 在matlab中使用循环和条件组合矩阵

> ID：15603511
> 
> 赞同：1
> 
> 时间：2013-03-24T20:18:32.943
> 
> 标签：matlab, loops, matrix, conditional-statements

我有以下两个矩阵

```
c=[1 0 1.05 
   1 3 2.05
   1 6 2.52
   1 9 0.88
   2 0 2.58
   2 3 0.53
   2 6 3.69
   2 9 0.18
   3 0 3.22
   3 3 1.88
   3 6 3.98]

f=[1 6 3.9
   1 9 9.1
   1 12 9
   2 0 0.3
   2 3 0.9
   2 6 1.2
   2 9 2.5
   3 0 2.7] 
```

最终的矩阵应该是

```
n=[1 6 2.52 3.9
   1 9 0.88 9.1
   2 0 2.58 0.3
   2 3 0.53 0.9
   2 6 3.69 1.2
   2 9 0.18 2.5
   3 0 3.22 2.7] 
```

结果，我使用的代码仅给出了前一个矩阵 [n] 的最后一行。

```
for j=1
  for i=1:rs1
     for k=1
          for l=1:rs2
               if f(i,j)==c(l,k) && f(i,j+1)==c(l,k+1)                 
                  n=[f(i,j),f(i,j+1),f(i,j+2), c(l,k+2)];
               end
          end
      end 
   end
 end 
```

谁可以帮我这个事？还有更简单的吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:14:56.090

您应该学习使用集合操作并尽可能避免循环。这里[`intersect`](http://www.mathworks.com/help/matlab/ref/intersect.html)可能非常有用：

```
[u, idx_c, idx_f] = intersect(c(:, 1:2) , f(:, 1:2), 'rows');
n = [c(idx_c, :), f(idx_f, end)]; 
```

说明：通过指定`'rows'`标志，在和`intersect`中找到共同的行，它们的索引分别在和中给出。使用向量下标提取矩阵。`c``f``idx_c``idx_f``n`

### 例子

让我们使用您问题中的示例：

```
c = [1 0 1.05;
     1 3 2.05
     1 6 2.52
     1 9 0.88
     2 0 2.58
     2 3 0.53
     2 6 3.69
     2 9 0.18
     3 0 3.22
     3 3 1.88
     3 6 3.98];

f = [1 6 3.9
     1 9 9.1
     1 12 9
     2 0 0.3
     2 3 0.9
     2 6 1.2
     2 9 2.5
     3 0 2.7];

[u, idx_c, idx_f] = intersect(c(:, 1:2) , f(:, 1:2), 'rows');
n = [c(idx_c, :), f(idx_f, end)]; 
```

这应该会产生预期的结果：

```
n =
    1.0000    6.0000    2.5200    3.9000
    1.0000    9.0000    0.8800    9.1000
    2.0000         0    2.5800    0.3000
    2.0000    3.0000    0.5300    0.9000
    2.0000    6.0000    3.6900    1.2000
    2.0000    9.0000    0.1800    2.5000
    3.0000         0    3.2200    2.7000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T21:35:45.567

如果您坚持在循环中执行此操作，则需要`n`根据您正在使用的循环计数器提供适当的维度，或者将其连接到每次迭代的自身（对于大矩阵，这可能非常慢）。例如，写作：

```
for j=1
  for i=1:rs1
    for k=1
      for l=1:rs2
           m=m+1;
           if f(i,j)==c(l,k) && f(i,j+1)==c(l,k+1)                 
              n(m,:)=[f(i,j),f(i,j+1),f(i,j+2), c(l,k+2)];
           end
       end
    end 
  end
end 
```

当循环达到计数器值时，会将 for 数字保存到第 m 行`m`。

但是，请注意，这也可以在没有嵌套循环和 if 条件的情况下以向量化的方式完成。例如，代替`if f(i,j)==c(l,k)...`您可以使用的条件`ismember`等...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-24T21:44:35.573

您可以通过同时比较第一列和第二列来减少循环次数，然后使用“all”函数仅在它们都匹配时折叠值。以下代码段复制了您提供的“n”数组。

```
n = [];
for r1 = 1:size(c, 1)
    for r2 = 1:size(f,1)
        if all(c(r1, [1 2]) == f(r2, [1 2]))
            n(end+1, 1:4) = [c(r1,:) f(r2,3)];
        end
    end    
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-24T20:55:44.607

根据[这个](http://www.mathworks.com/support/solutions/en/data/1-143J0O/?product=ML&solution=1-143J0O)关于 Mathworks 支持的答案，您可以使用统计工具箱中的[连接](http://www.mathworks.com/help/stats/dataset.join.html)，特别是在您的情况下，内连接。

不幸的是，我无法访问我的带有 matlab 的计算机，但试一试，让我们知道它是如何工作的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-26T18:37:55.760

根本没有任何 for 循环怎么样（除了在本机代码中）

```
mf = size(f,1);
mc = size(c,1);
a = repmat(c(:,1:2),1,mf);
b = repmat(reshape((f(:,1:2))',1,[]),mc,1);
match = a == b;
match = match(:, 1 : 2 : 2*mf) & match(:, 2 : 2 : 2*mf);

crows = nonzeros(diag(1:mc) * match);
frows = nonzeros(match * diag(1:mf));

n = [c(crows,:),f(frows,3)] 
```

# javascript - 使用“搜索”方法按文本过滤 和 标签

> ID：15603532
> 
> 赞同：1
> 
> 时间：2013-03-24T20:20:36.290
> 
> 标签：javascript, jquery, search

`<li>`此函数当前通过元素内的文本过滤元素`<li>`。我怎样才能修改它，以便它也可以通过`<li>`标签内的文本过滤（例如数据属性）>。

我已经尝试更改`($(this).text().search(...))`为，`($(this).search(...))`但这只是阻止了该功能完全正常工作。

我在这里发布了一个带有工作示例的小提琴：http: [//jsfiddle.net/chayacooper/sMEbN/](http://jsfiddle.net/chayacooper/sMEbN/)

```
$(document).ready(function () {
    $('#list li').addClass('visible');
    $('#search').show();    
    $('#filter').keyup(function(event) {
    if (event.keyCode == 27 || $(this).val() == '') {
            $(this).val('');    
            $('#list li').removeClass('visible').show().addClass('visible');
    }         
        else {
            filter('#list li', $(this).val());
    }
    });
});

function filter(selector, query) {
  query = $.trim(query);
  query = query.replace(/ /gi, '|');   
  $(selector).each(function() {
    ($(this).text().search(new RegExp(query, "i")) < 0) ? $(this).hide().removeClass('visible') : $(this).show().addClass('visible');
  });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:36:25.347

你可以尝试这样的事情：

```
$(selector).each(function () {
    var data = $.map($(this).data(), function (el) {
        return el;
    }).join(' ');
    ($(this).text() + ' ' + data).search(new RegExp(query, "i")) < 0 
        ? $(this).hide().removeClass('visible')
        : $(this).show().addClass('visible');
}); 
```

[http://jsfiddle.net/sMEbN/5/](http://jsfiddle.net/sMEbN/5/)

`$(this).data()`返回所有数据属性，然后可以将其连接成字符串。

# ruby-on-rails - Capistrano RVM 和 Ubuntu RVM 不是功能，选择带有 'rvm use ...' 的红宝石将不起作用

> ID：15603534
> 
> 赞同：4
> 
> 时间：2013-03-24T20:20:55.700
> 
> 标签：ruby-on-rails, ruby, linux, ubuntu, capistrano

我第一次尝试在 ubuntu 服务器上部署我的应用程序。

我一直遇到这个错误：

```
 2013-03-24 15:13:36 executing `deploy:run_migrations'
  * executing "rvm gemset use vapin"
    servers: ["111.111.111.11"]
    [111.111.111.11] executing command
 ** [out :: 111.111.111.11] 
 ** [out :: 111.111.111.11] 
 ** [out :: 111.111.111.11] RVM is not a function, selecting rubies with 'rvm use ...' will not work.
 ** [out :: 111.111.111.11] 
 ** [out :: 111.111.111.11] 
 ** [out :: 111.111.111.11] 
 ** [out :: 111.111.111.11] You need to change your terminal emulator preferences to allow login shell.
 ** [out :: 111.111.111.11] 
 ** [out :: 111.111.111.11] Sometimes it is required to use `/bin/bash --login` as the command.
 ** [out :: 111.111.111.11] 
 ** [out :: 111.111.111.11] Please visit https://rvm.io/integration/gnome-terminal/ for a example. 
```

这是我的一些 deploy.rb 文件：

```
 require 'bundler/capistrano'
    require 'rvm/capistrano'
    # set the ruby version
    #set :rvm_ruby_string, 'ruby-1.9.3-p392'
    #set :rvm_type, :system

    # set the rvm gemset to use
    set :rvm_gemset, 'vapin'
...
    task :install do
        run "rvm gemset use #{rvm_gemset}"
        run "cd #{current_path} && bundle install  --without=test"
    end 
```

RVM 安装在我的服务器上。

```
$ which rvm
/usr/local/rvm/bin/rvm
$ which ruby
/usr/local/rvm/rubies/ruby-1.9.3-p392/bin/ruby 
```

任何帮助表示赞赏。这几天我一直在谷歌上搜索。

**编辑**

我已经卸载了 RVM 的多用户安装并重新安装了单用户版本。

我在 deploy.rb 脚本中添加了这一行： set :default_shell, "/bin/bash --login" # required for rvm scripts to work proper

现在我没有收到“RVM 不是函数......”错误。

问题是当 bundle install 运行时，gem 没有安装在我的 rvm gemset 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T04:56:44.083

在我的 deploy.rb 文件中，设置这一行：

```
set :bundle_dir, "/usr/local/rvm/gems/ruby-1.9.3-p392" 
```

在此行之前：

```
require 'bundler/capistrano' 
```

似乎帮助捆绑者知道在哪里安装宝石。不知道为什么需要这样做。我以前从来不需要它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-20T15:59:56.693

我一直在努力解决这个问题。尝试了上面列出的所有内容，没有任何效果。从 osx 部署到 ubuntu。

最后，在 ubuntu 上，“su-ed”作为我的部署用户，我做了“rvm get head”（我一直在使用“rvm get stable”）。（我在单用户环境中设置了它，rvm 在“/home/deploy/.rvm”下。）

就像魔术一样，它开始起作用了！呸。所以我想也许最新的 rvm 中有一些修复，但还不稳定？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-12T20:04:15.013

1.  *不要*使用 rvm1/capistrano3 或 rvm/capistrano；*不要*设置：pty。

2.  将服务器上的 runner 用户更改`~/.rvmrc`为 - 请注意，它必须位于它在不以交互方式运行时杀死自己的行*之前：*

```
# get rvm for non-interactive shells (eg capistrano) too
source /etc/profile.d/rvm.sh
export BASH_ENV=$HOME/.bashrc
export rvm_is_not_a_shell_function=0

# If not running interactively, don't do anything
[ -z "$PS1" ] && return 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T07:14:05.557

尽管您似乎已经回答了自己的问题，但我也会把我的帽子扔在戒指上......
我在尝试创建 Rails 模板时遇到了与整个`RVM is not a function`错误类似的问题，并通过获取`rvm`环境来解决它在特定的 Ruby 版本上安装实例，然后直接在其上设置 gemset/running bundle install。在您的情况下，它可能类似于：

```
require 'bundler/capistrano'
require 'rvm/capistrano'
# set the ruby version
set :rvm_ruby_string, 'ruby-1.9.3-p392'

# set the rvm gemset to use
set :rvm_gemset, 'vapin'
...
task :install do
  require 'rvm'
  env = RVM::Environment.new(rvm_ruby_string)
  # If you need to create a new app-specific gemset
  # env.gemset_create(rvm_gemset)
  env.gemset_use!(rvm_gemset)
  # If you need to install bundler in a new gemset
  # env.system("gem", "install", "bundler")
  env.system("bundle", "install", "--without=test")
end 
```

显然，上面的代码没有经过测试，但是我在[这个 Rails 模板文件](https://github.com/paulfioravanti/rails_template/blob/master/recipes/rvm.rb)中创建了类似的代码，如果上面的代码完全失败，我希望它可以作为你的参考。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-24T23:08:06.567

也许您需要将 RVM bin 目录添加到您`$PATH`的脚本中：

```
PATH=$PATH:$HOME/.rvm/bin 
```

# jquery - 启用 - 禁用表单元素检查 - 取消选中复选框输入 jquery

> ID：15603539
> 
> 赞同：0
> 
> 时间：2013-03-24T20:21:51.763
> 
> 标签：jquery

我想在检查复选框表单元素时启用所有表单元素。并反转。
这是我的代码（不起作用）：

```
$(document).ready(function(){

    $('#coments input[type=text]').attr('disabled', 'disabled');
    $('#coments textarea').attr('disabled', 'disabled');
    $('#coments select').attr('disabled', 'disabled');
    $('#coments input[type=submit]').hide();

    $('#coments input[type:checkbox]').click(function() {
        var checkbox = $(this);

        if (checkbox.is(':checked')) {
            $('#coments input[type=submit]').show();
            $('#coments textarea').removeAttr('disabled');
            $('#coments select').removeAttr('disabled');
            $('#coments input[type=text]').removeAttr('disabled');
        } else {
            $('#coments input[type=text]').attr('disabled', 'disabled');
            $('#coments textarea').attr('disabled', 'disabled');
            $('#coments select').attr('disabled', 'disabled');
            $('#coments input[type=submit]').hide();
        }
    });
}); 
```

希望你们中的任何人都可以提供帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:27:16.777

对于文本框和文本区域，您需要设置“只读”属性

```
$('#coments textarea').attr("readonly", "readonly"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:38:09.970

我请你原谅浪费你的时间！我已经发现了一个让我头疼的语法错误。
该行：
$('#comments input[type:checkbox]').click(function() {...
应该是：
$('#comments input[type=checkbox]').click(function() {。 ..
再次抱歉，无论如何谢谢。

# python - 用于提交命令的 os.system

> ID：15603540
> 
> 赞同：2
> 
> 时间：2013-03-24T20:22:08.693
> 
> 标签：python, lsf

我正在使用 os.system 向系统提交命令。

IE，

```
import os
os.system(my_cmd) 
```

但我想知道如何获得输出，即，假设我在 bash 中并输入我的 cmd，我会得到这种形式的输出：

```
Job <57960787> is submitted to queue <queueq>. 
```

在 python 中，如何使用 os.system(cmd) 获取文本输出，并对其进行解析以获取作业 ID 57960787。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-24T20:24:33.200

最好在[这里](http://docs.python.org/2/library/subprocess.html)`subprocess`使用模块文档，示例如下：

```
import subprocess,re
p = subprocess.Popen('commands',stdout=subprocess.PIPE,stderr=subprocess.PIPE)
results, errors = p.communicate()
print results
re.search('<(\d+)>', results).group(1) #Cheers, Jon Clements 
```

或者您甚至可以[在此处](http://docs.python.org/2/library/os.html#os.popen)`os.popen`使用文档，

```
p_os = os.popen("commands","r")
line = p_os.readline()
print line
re.search('<(\d+)>', line).group(1) #Cheers, Jon Clements 
```

或者正如 John Clements 所建议的那样，您可以[在此处](http://docs.python.org/2/library/subprocess.html#subprocess.check_output)`subprocess.check_output`使用文档

```
>>> subprocess.check_output(["echo", "Hello World!"])
'Hello World!\n' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:31:43.807

一个简单的例子：

```
>>> import os, sys
>>> cmd = "uname"
>>> b = os.popen(cmd, 'r', 1)
>>> b.read()
'Linux\n' 
```

我正在运行 Linux`uname`命令。

os.popen() 执行命令并返回一个文件类型对象，您可以使用该对象读取命令的输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T20:50:10.373

`os.system`不返回输出。因此，您可以使用该`commands`模块。

例子：

```
import commands
my_cmd = 'ls -l'
status, output = commands.getstatusoutput(my_cmd)
print output 
```

# sockets - 提升异步 UDP 客户端

> ID：15603544
> 
> 赞同：4
> 
> 时间：2013-03-24T20:22:23.467
> 
> 标签：sockets, boost, asynchronous, udp, boost-asio

我已经通读了 boost:asio 文档（在异步客户端上看起来很安静），并在此处查看，但似乎无法在此处找到树木的森林。

我有一个模拟，它的主循环如下所示：

```
for(;;)
{
  a = do_stuff1();
  do_stuff2(a);
} 
```

很容易。

我想做的是修改它，以便我拥有：

```
for(;;)
{
  a = do_stuff1();
  check_for_new_received_udp_data(&b);
  modify_a_with_data_from_b(a,b);
  do_stuff2(a);
} 
```

我有以下要求：

1.  我不能因为没有积极倾听而丢失数据。IE 我不想丢失数据包，因为在服务器发送数据包时我在 do_stuff2() 而不是 check_for_new_received_udp_data() 中。
2.  我不能让 check_for_new_received_udp_data() 块超过大约 2 毫秒，因为主 for 循环需要以 60Hz 执行。
3.  服务器将在其他地方运行，并且有一个完全不稳定的时间表。有时会没有数据，有时我可能会重复收到相同的数据包。

我玩过异步 UDP，但这需要调用 io_service.run()，它会无限期地阻塞，所以这对我没有帮助。

我考虑过超时阻塞套接字读取，但似乎你必须作弊并退出 boost 调用才能做到这一点，所以这是一个非首发。

答案会涉及线程吗？无论哪种方式，有人可以指出一个有点相似的例子吗？当然，这在以前已经做过了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T21:17:12.487

为避免阻塞，`io_service::run()`您可以使用[io_service::poll_one()](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/io_service/poll_one.html)。

关于丢失 UDP 数据包，我认为你不走运。UDP 不保证传送，如果流量很大，网络的任何部分都可能决定丢弃 UDP 数据包。如果您需要确保交付，您需要实现某种流控制或仅使用 TCP。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-24T21:42:14.410

我认为您的问题是您仍在同步思考。你需要异步思考。

1.  UDP 套接字上的异步读取 - 数据到达时将调用处理程序。
2.  在该处理程序中对传入数据进行处理。请记住，在处理过程中，如果您有一个线程，则不会调度任何其他内容。这完全没问题（UDP 消息仍将在网络堆栈中排队......）。
3.  因此，您可能正在启动其他异步操作。

如果您需要并行进行本质上不相关或离线的工作，这将涉及线程。创建一个调用 io_service.run() 的线程。

如果您需要在异步框架中进行定期工作，请使用[timers](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/deadline_timer.html)。

在您的特定示例中，我们可以重新排列这样的内容（**伪代码**）：

```
read_handler( ... )
{
   modify_a_with_data_from_b(a,b);
   do_stuff2(a);
   a = do_stuff1();
   udp->async_read( ..., read_handler );
}

periodic_handler(...)
{
  // do periodic stuff
  timer.async_wait( ..., periodic_handler );
}

main()
{
   ...
   a = do_stuff1();
   udp->async_read( ..., read_handler )
   timer.async_wait( ..., periodic_handler );

   io_service.run();
} 
```

现在我确定您的问题中还有其他要求不明显，但您需要找出对它们的异步答案，这只是一个想法。还要问自己是否真的需要异步框架或只使用同步套接字 API。

# mongodb - Mongodb base64图像与gridfs

> ID：15603549
> 
> 赞同：9
> 
> 时间：2013-03-24T20:22:55.260
> 
> 标签：mongodb, base64, gridfs

我正在使用 mongodb，我想在我的服务器中存储一些缩略图。什么是最好的？使用 GridFS 或将这些图像转换为 base64 并将它们直接存储在文档中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-08-08T17:45:01.927

与往常一样，有一些（dis）优点：

**优点：**

*   如果只需要文档+缩略图，则更少的数据库请求。
*   更少的客户请求。（当然，您可以从 GridFS 获取缩略图，并将它们放在响应中，但这会导致更多的数据库请求）

**中性的：**

*   存储要求相同

**缺点：**

*   您不能轻易地在另一个文档中重复使用相同的图像缩略图，因为没有要引用的 id。（对我们来说，这不是问题，因为服务器响应是 gzip 压缩的，您无法真正区分 1 和 5 个相等图像之间的区别）

**使用 MongoDB 和 NoSQL，一切都是为了了解您的用例！**

*   如果您的许多文档共享相同的图像，您应该使用 GridFS 并只提供指向这些文件的链接，因为**1.**共享数据更节省空间**2.**客户端可以缓存图像请求并且只需检索一次。

*   如果您的客户总是需要缩略图，您可能应该考虑将文件作为 base64 嵌入响应中。这特别好，如果**1.**图像不在文档之间共享和/或**2.**图像经常更改并且缓存是无用的/不可能的。

*   Base64 当然意味着更多的网络流量，因为它需要 8 位来传输 6 位。即75%的效率。这当然只会影响客户端-服务器通信，因为在 MongoDB 中，您始终可以将数据存储为二进制字段。

*   你喜欢更多的数据库请求（= 使用 GridFS）吗？或者网络上更大的数据/文档大小（=嵌入）？

**我们做了什么：**

我们使用嵌入式缩略图，即使我们可能有重复的图像。在服务器上激活 gzip 压缩后，服务器-客户端传输大小不再重要。但如前所述，这是一个折衷方案：现在我们的客户端请求和数据库请求减少了，但是因为嵌入使得缓存图像变得不可能，所以我们现在在线上有更多数据。

**结论：**

没有一种适合所有解决方案的尺寸。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-19T05:48:35.897

这实际上取决于您的服务器端技术和个人喜好。10gen 建议您使用文档，除非您存储的文件大于文档限制 (16MB)。鉴于您使用的语言，我建议您做任何更容易的事情。如果您在遵循文档后还有其他文档要建模，否则请尝试使用 gridFS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T17:22:30.133

我建议你使用[GridFS](http://docs.mongodb.org/manual/core/gridfs/)。使用[GridFS](http://docs.mongodb.org/manual/core/gridfs/)，您可以利用[MongoDB REST API](http://docs.mongodb.org/ecosystem/tools/http-interfaces/#simple-rest-interface)。因此使用 MongoDB API 检索文档不会过热。REST API 将完成所有艰苦的工作并节省您的时间。

# ios - 链接器错误 - 目标 C

> ID：15603552
> 
> 赞同：0
> 
> 时间：2013-03-24T20:23:01.343
> 
> 标签：ios, objective-c, xcode, linker-errors

当我尝试从文件“VAMenuScreenViewController”导入文件“VARendererViewController.h”时发生此错误

```
duplicate symbol _gestureMinimumTranslation in:
/Users/Sam/Library/Developer/Xcode/DerivedData/Virtual_Human_Avatar-fwgdkxpnkzapxrdzkggtmbnfhjwb/Build/Intermediates/Virtual Human Avatar.build/Debug-iphonesimulator/Virtual Human Avatar.build/Objects-normal/i386/VARendererViewController.o
/Users/Sam/Library/Developer/Xcode/DerivedData/Virtual_Human_Avatar-fwgdkxpnkzapxrdzkggtmbnfhjwb/Build/Intermediates/Virtual Human Avatar.build/Debug-iphonesimulator/Virtual Human Avatar.build/Objects-normal/i386/VAMenuScreenViewController.o 
```

ld：架构 i386 clang 的 1 个重复符号：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）

谁能给我一些

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T00:08:18.170

您有两个编译单元——两个源文件——定义了相同的符号。

这可能是因为您在两个单独的 .m 文件（或其他编译单元；.c、.mm 等）中定义了符号，或者因为您在头文件中定义了符号并将其导入到这两个文件中。或者，如果您将变量声明推入没有 . 的头文件中`extern`，那么它将导致在`.m`导入它的每个文件中创建该名称的符号。

假设`gestureMinimumTranslation`是一个变量，那么如果你真的想要一个全局变量，它应该*只在一个 .m 文件*中定义如下：

```
int gestureMinimumTranslation; 
```

然后，在相应的标题中：

```
extern int gestureMinimumTranslation; 
```

*另一个* `.m`文件应该导入上面的头文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T00:09:43.203

链接器试图连接一组具有共同符号的对象。当`Compile Sources` `Build Phase`有重复的条目或头文件时，通常会发生这种情况。尝试删除这些。

# java - 弄乱 PATH 后找不到 Rake 命令——此外，也没有 rails 命令起作用

> ID：15603556
> 
> 赞同：0
> 
> 时间：2013-03-24T20:23:13.040
> 
> 标签：java, ruby-on-rails, ruby, classpath, rhomobile

更改我的系统 PATH 变量似乎把一切都搞砸了。

所以，我试图运行`rake device:android:production`为我一直在使用 RhoMobile / Rhodes 开发的应用程序制作一个 APK。我收到一条错误消息，告诉我我的`java bin`文件夹已关闭，所以我去检查了我的系统 PATH 变量并将其更改为我的 JDK bin 文件夹。它以前是我安装 RhoMobile 时添加的一些路径。

所以，现在我得到了`Rake Command Not Found`而不是`java bin folder not found`我之前得到的错误。

我也无法运行`rails server`或任何`rails`或`gem`命令，出于某种原因，甚至像这样的命令`ls`也不再为我工作了。

我怎么能让它再次工作，我做了什么？

更改我的 PATH 允许我最终使用`javac`和`java`命令，但实际上搞砸了其他所有内容。我正在使用 Windows 7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T04:13:45.440

这似乎不是一个 Ruby 问题，但如果您在 Windows 上，我假设您正在运行 Windows Installer 版本 ( [ruby​​installer.org](http://rubyinstaller.org) ) 或 JRuby？

PATH 变量应包含

```
c:\ruby200-x64\bin 
```

或者

```
c:\jruby-1.7.3\bin 
```

或本地红宝石的相应路径。

# android - 从活动中停止服务

> ID：15603559
> 
> 赞同：0
> 
> 时间：2013-03-24T20:23:24.387
> 
> 标签：android, android-intent, android-service

我在从活动中停止服务时遇到问题。

我的服务声明：

```
public class MyService extends Service implements LocationListener { .. } 
```

按下按钮时调用此服务：

```
public void startMyService(View view)
{
    ComponentName comp = new ComponentName(getPackageName(), MyService.class.getName());
    ComponentName service = startService(new Intent().setComponent(comp));
} 
```

在另一种方法中（通过单击按钮启动）我想停止它：

```
public void stopMyService(View view)
{
    stopService(new Intent(this, MyService.class));
} 
```

不幸的是，它不起作用。在我看来，这项服务已被另一项服务所取代。此外，它正在累积 - 例如，当我第二次启动服务时，其中有两个正在运行等。有人可以帮助我吗？在此先感谢您的帮助。

更新：Android Manifest（仅限我的服务）：

```
<service android:name=".MyService" 
        android:enabled="true" 
        android:exported="false"
        android:label="LocationTrackingService" 
        /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:32:09.650

您可以将 BroadcastReceiver 添加到您的服务（或静态方法 - 取决于您的偏好）并调用`Context.stopService()`or `stopSelf()`，例如添加 ...

```
public static String STOP_SERVICE = "com.company.SEND_STOP_SERVICE";

private final BroadcastReceiver stopReceiver = new BroadcastReceiver() {
   @Override
   public void onReceive(Context context, Intent intent) {
      if(intent.getAction().equals(STOP_SERVICE)){
          MyService.this.stopSelf();
      }
   }
}; 
```

...为您的服务（假设它被称为`MyService`）。然后调用方法和`registerReceiver(stopReceiver, STOP_SERVICE);`in 。最后从您需要停止服务的任何地方发送广播：`onStartCommand()``unregisterReceiver(stopReceiver);``onDestroy()`

```
Intent intent=new Intent();
intent.setAction(MyService.STOP_SERVICE);
sendBroadcast(intent); 
```

如果你有一些线程，你必须先停止它们（可能你有并且你启动了*粘性*服务，是吗？）

# google-chrome - 如何在 Chrome 中调试 HTTP POST？

> ID：15603561
> 
> 赞同：237
> 
> 时间：2013-03-24T20:23:36.057
> 
> 标签：google-chrome, debugging, post

我想查看在 Chrome 中发送的 HTTP POST 数据。

数据现在在内存中，我可以重新提交表单。

我知道如果我重新提交服务器会抛出一个错误。无论如何我可以查看 Chrome 内存中的数据吗？

* * *

## 回答 #1

> 赞同：269
> 
> 时间：2013-03-24T20:55:08.423

1.  转到 Chrome 开发者工具（Chrome 菜单 -> 更多工具 -> 开发者工具）
2.  选择“网络”选项卡
3.  刷新您所在的页面
4.  您将获得在网络控制台打开时发生的 http 查询列表。在左侧选择其中之一
5.  选择“标题”选项卡

瞧！

[![在此处输入图像描述](../Images/9518307445bb6cfbd30d0050a65657f0.png)](https://i.stack.imgur.com/viZMv.png)

* * *

## 回答 #2

> 赞同：169
> 
> 时间：2016-09-23T13:05:19.657

[您可以使用Chrome DevTools](https://developer.chrome.com/devtools)过滤 HTTP POST 请求。只需执行以下操作：

1.  打开 Chrome DevTools（在 Mac 上为`Cmd`+ `Opt`+ ，在 Windows 上为+ + ）并单击“网络”选项卡`I``Ctrl``Shift``I``F12`
2.  点击“过滤器”图标
3.  输入您的过滤方法：`method:POST`
4.  选择要调试的请求
5.  查看要调试的请求的详细信息

**截屏**

[![Chrome 开发者工具](../Images/1c6c97c793b54420834e315193392c5b.png)](https://i.stack.imgur.com/8RVcY.png)

使用 Chrome 版本 53 进行测试。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-08-25T08:51:26.573

您可以使用[Canary 版本的 Chrome](https://www.google.com/chrome/browser/canary.html)来查看 POST 请求的请求负载。

[![请求有效载荷](../Images/ba4433a6c3aa016abe94d73e461ecebb.png)](https://i.stack.imgur.com/2MjvH.png)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2019-09-13T18:43:32.813

另一个可能有用的选项是专用的 HTTP 调试工具。有一些可用的，我建议[HTTP Toolkit](https://httptoolkit.tech/)：我一直在研究的一个开源项目（是的，我可能有偏见）来为自己解决同样的问题。

主要区别在于可用性和功率。Chrome 开发工具适用于简单的事情，我建议从那里开始，但如果您难以理解那里的信息，并且您需要更多解释或更多功能，那么适当的专注工具可能会很有用！

对于这种情况，它将向您展示您正在寻找的完整 POST 正文，并带有友好的编辑器和突出显示（全部由[VS Code](https://code.visualstudio.com/)提供支持），因此您可以四处挖掘。它当然会为您提供请求和响应标头，但对于您可以看到的每个标准标头和状态代码，它都会提供额外的信息，例如来自 MDN（ [Mozilla 开发者网络）的文档。](https://developer.mozilla.org/en-US/)

一张图片值一千个 StackOverflow 答案：

[![显示 POST 请求及其正文的 HTTP Toolkit 屏幕截图](../Images/def5106997cfb19b9c04dd4c723263b9.png)](https://httptoolkit.tech)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-03-16T13:49:28.927

它有一个棘手的情况：如果您提交一个 post 表单，那么 Chrome 将打开一个新选项卡来发送请求。直到现在，但如果它触发了**下载文件**的事件，此选项卡将立即关闭，因此您无法在开发工具中捕获此请求。

解决方法：在提交post表单之前，需要先**断网**，导致请求无法发送成功，标签页也不会关闭。然后您可以在 Chrome Devtool 中捕获请求消息（如有必要刷新新标签）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-03-27T01:47:22.207

网络选项卡就是您所需要的...

[![在此处输入图像描述](../Images/c5495b35a894a5620a204588d3e79df9.png)](https://i.stack.imgur.com/lmAcV.png)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-11-21T10:56:37.917

**在 Chrome 96** DevTools 网络选项卡上；

单击请求后，有一个显示表单数据的“有效负载”选项卡：

[![在此处输入图像描述](../Images/11e8df7360111b984c02869b9e8a1875.png)](https://i.stack.imgur.com/yM9Wf.png)

您可以将数据视为 url 编码/解码：

[![![在此处输入图像描述](../Images/7d4e8c62033cef303639e1961cfed673.png)](https://i.stack.imgur.com/fjFg9.png)

您可以将数据视为源/解析：

[![在此处输入图像描述](../Images/18d3f91cdce740af5280693ce222a2ef.png)](https://i.stack.imgur.com/BTdMJ.png)

*即使方法是 GET*，您也可以将 Payload 视为查询字符串参数：

[![在此处输入图像描述](../Images/b9d3bbaa5228fb4beff60332f179f4d8.png)](https://i.stack.imgur.com/dMV0k.png)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-11-05T15:05:22.197

其他人的回答非常好，但我想用一个额外的开发工具来完成他们的工作。它被称为**Live HTTP Headers**，您可以将其安装到您的[Firefox](https://addons.mozilla.org/en-US/firefox/addon/live-http-headers/)中，并且在***Chrome***中我们也有类似的[插件](https://chrome.google.com/webstore/detail/http-headers/nioieekamcpjfleokdcdifpmclkohddp?hl=en)。

使用它非常容易。

1.  使用您的 Firefox，导航到您想要向其发送发布请求的网站。

2.  在您的 Firefox 菜单***工具->实时 Http 标头中***

3.  为您弹出一个新窗口，所有 http 方法的详细信息都将保存在此窗口中。您无需在此步骤中执行任何操作。

4.  在网站上，做一个活动（登录、提交表单等）

5.  看看你的插件窗口。这都被记录下来了。

请记住，您需要**检查*****Capture***。

[![在此处输入图像描述](../Images/56506d73663fb84ce489f8c0bc35b498.png)](https://i.stack.imgur.com/w3TcS.png)

# node.js - Node.JS - fs.exists 不工作？

> ID：15603564
> 
> 赞同：2
> 
> 时间：2013-03-24T20:23:54.543
> 
> 标签：node.js, asynchronous, if-statement

我是 Node.js 的初学者，在处理这段代码时遇到了麻烦。

```
var fs = require('fs');

Framework.Router = function() {

    this.run = function(req, res) {
        fs.exists(global.info.controller_file, function(exists) {
            if (exists) {
                            // Here's the problem
                            res.writeHead(200, {'Content-Type':'text/html'});
                var cname = App.ucfirst(global.info.controller)+'Controller';
                var c = require(global.info.controller_file);
                var c = new App[cname]();
                var action = global.info.action;
                c[action].apply(global.info.action, global.info.params);
                            res.end();
            } else {
                App.notFound();
                return false;
            }
        });
    }
}; 
```

问题出在检查“global.info.controller_file”是否存在之后的部分，我似乎无法让代码在内部正常工作： if (exists) { ... **NOT WORKING** } 我尝试注销该部分中所有变量的值，并且它们具有其预期值，但是行：`c[action].apply(global.info.action, global.info.params);` 未按预期运行。它应该调用 controller_file 中的一个函数，并且应该做一个简单的`res.write('hello world');`. 在我开始使用`fs.exists`. **if 语句中的所有内容在此检查之前都运行良好。**

为什么代码没有按预期运行？为什么请求只是超时？它与整个同步与异步的事情有关吗？（对不起，我是一个完整的初学者）

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-31T07:17:36.080

就像其他人评论的那样，我建议您重写代码以使其更符合 Node.js 设计模式，然后看看您的问题是否仍然存在。与此同时，这可能会有所帮助：

`require`应该注意不要在“运行时”动态使用的建议，并且调用`fs.exists()`每个请求是非常浪费的。但是，假设您想将所有 *.js 文件加载到一个目录（可能是“控制器”目录）中。这最好使用 index.js 文件来完成。

例如，将以下内容另存为`app/controllers/index.js`

```
var fs = require('fs');
var files = fs.readdirSync(__dirname);
var dotJs = /\.js$/;
for (var i in files) {
    if (files[i] !== 'index.js' && dotJs.test(files[i]))
        exports[files[i].replace(dotJs, '')] = require('./' + files[i]);
} 
```

然后，在 的开头`app/router.js`，添加：

```
var controllers = require('./controllers'); 
```

现在您可以`app/controllers/test.js`使用`controllers.test`. 所以，而不是：

```
fs.exists(controllerFile, function (exists) {
    if (exists) {
        ...
    }
}); 
```

简单地：

```
if (controllers[controllerName]) {
    ...
} 
```

这样您就可以保留所需的动态功能，而无需不必要的磁盘 IO。

# c# - 通过这些方法限制拳击值得吗？

> ID：15603574
> 
> 赞同：1
> 
> 时间：2013-03-24T20:24:43.277
> 
> 标签：c#, boxing

C# 3 顺便说一句...所以我正在研究我的人工智能黑板。其中一部分是字符串名称到通用值（对象）的关联映射，现在该值存储为装箱值类型或转换为对象的字符串。

所以是这样的：

```
 public class ContextEntry
  {
    public string name;
    public object value;
  }

  public class BehaviorContext
  {
    public ContextEntry AddEntry<T>(string name, T value)
    {
      //checks to see if T is an allowed type, create a ContextEnetry
      //and adds it to map, returning a reference to the added entry
    }

    public bool GetValue<T>(string name, ref T val)
    {
      //look for entry, if found, do an as check with T, 
      //and then unbox the entry value into T
      //otherwise return false 
    }

    public bool GetValue(string name, ref object val)
    {
      //same as GetValue<T> but with object instead
    }

    public bool SetValue<T>(string name, T val)
    {
      //look for entry, if found, do an as check with T, 
      //and then box T into the entry value
      //otherwise return false 
    }

    public bool SetValue(string name, object val)
    {
      //same as SetValue<T> but instead checks val type is compatible with entry
    }

    protected Dictionary<string, ContextEntry> m_EntryMap = new Dictionary<string, ContextEntry>();
  } 
```

对于那些添加条目的人，他们可以保留 ContextEnty 的副本并直接从那里访问值。

所以我看到的是不断的装箱和拆箱正在伤害我，当涉及到帧时间时，因为它被大量使用。

我想知道为 ContextEntry 做这样的事情是否会更好。

```
public interface IContextEntry
  {
    string Name {get; set;} 
    bool SetObj(object o);
    void GetObj(ref object o);
  }  

  public class ContextEntry<T> : IContextEntry
  {
    public bool SetObj(object o) { //do a compatibility check then unbox into value }
    public void GetObj(ref object o) { //box value into o }
    public T value;
  } 
```

现在我会为每个允许的类型保留一个单独的 ContextEntry[T] 字典，如果有人使用 GetValue[T] 或 SetValue[T]，则只在正确的字典中搜索。如果有人使用 GetValue 或 SetValue，我还会保留一个包含所有条目的 IContextEntry 字典。用户会经常使用函数的模板版本，但也经常使用非模板版本。当使用非模板版本时，它们会引发虚函数调用以及装箱/拆箱。

我想知道它是否值得。有什么意见吗？

# objective-c - Xcode/git 不使用子文件夹

> ID：15603575
> 
> 赞同：2
> 
> 时间：2013-03-24T20:24:46.083
> 
> 标签：objective-c, xcode, git, cocoa-touch, cocoa

我已经为我的 Xcode 项目设置了 git。我正在尝试添加一个子文件夹（例如我的项目目录/资源）并跟踪更改。但是，在我将子文件夹拖入 Xcode 后，它并没有被跟踪更改。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T21:10:15.880

1.  将文件夹拖到 Xcode。确保它在正确的位置，或者您也复制它。

2.  在项目浏览器中选择文件，然后选择“文件->源代码管理->添加”。或者，点击`alt``cmd``A`。

或者，转到终端中的目录并键入

```
 git add NewFolder 
```

# php - Javascript自动点击？

> ID：15603578
> 
> 赞同：-1
> 
> 时间：2013-03-24T20:25:03.980
> 
> 标签：php, javascript, jquery, html

我有以下用于 jquery 登录表单的函数，并希望在 php 通过回显自动单击登录按钮的 javascript 函数检测到用户未登录时运行它

jq代码：

```
<script type="text/javascript">

             $(document).ready(function() {
$('a.login-window, a.log').click(function() {

            //Getting the variable's value from a link 
    var loginBox = $(this).attr('href');

    //Fade in the Popup
    $(loginBox).fadeIn(300);

    //Set the center alignment padding + border see css style
    var popMargTop = ($(loginBox).height() + 24) / 2; 
    var popMargLeft = ($(loginBox).width() + 24) / 2; 

    $(loginBox).css({ 
        'margin-top' : -popMargTop,
        'margin-left' : -popMargLeft
    });

    // Add the mask to body
    $('body').append('<div id="mask"></div>');
    $('#mask').fadeIn(300);

    return false;
});

// When clicking on the button close or the mask layer the popup closed
$('a.close, #mask').live('click', function() { 
  $('#mask , .login-popup').fadeOut(300 , function() {
    $('#mask').remove();  
}); 
return false;
});
});
             </script> 
```

HTML

```
 <div id="login-box" class="login-popup">
    <a href="#" class="close"><img src="close_pop.png" class="btn_close" title="Close Window" alt="Close" /></a>
      <form method="post" method="post" name="f" id="f" class="signin" action="login.php">
            <fieldset class="textbox">
            <label class="username">
            <span>Username or email</span>
            <input id="username" name="username" value="" type="text" autocomplete="on" placeholder="Username">
            </label>
            <label class="password">
            <span>Password</span>
            <input id="password" name="password" value="" type="password" placeholder="Password">
            </label>
<button class="submit button" type="submit" name="Submit" value="<?php echo $lang['LOGIN'];" style="background:none;">Sign in</button>
            <p>
            <a class="forgot" href="#">Forgot your password?</a>
            </p>        
            </fieldset>
      </form>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:34:15.500

```
var loggedIn = isUserLoggedIn(); // check login status

if(!loggedIn){
  $('a.login-window, a.log').trigger('click');
} 
```

`.trigger` [文档](http://api.jquery.com/trigger/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:28:48.940

如果你想自动点击一个按钮，你正在寻找`.trigger`

```
$('#some-id').trigger('click'); 
```

`.trigger( 'event' )`解释：

```
Execute all handlers and behaviors attached to the matched elements 
for the given event type. 
```

（因为您已经在使用 jQuery，因此）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-24T20:29:12.240

```
<?php
   if (!$lang['LOGIN']) {
       echo '<script type="text/javascript">';
       echo    '$(function() {';
       echo         '$("a.login-window, a.log").trigger("click")';
       echo    '});';
       echo '</script>';
   }
?> 
```

# c++ - 派生抽象类中的纯虚方法

> ID：15603579
> 
> 赞同：11
> 
> 时间：2013-03-24T20:25:08.560
> 
> 标签：c++, inheritance, virtual

假设我们有这个：

```
class A
{
   public:
   virtual void foo() = 0;
};

class B: public A
{
   public:
   virtual void foo() = 0;
}; 
```

编译器没有抛出错误，我猜是因为 B 也是一个抽象类，因此它不必`foo`从 A 实现。但是这样的构造是什么意思？

1) B 是否`foo`对 A 隐藏`foo`？

2）从B继承的第一个类不是抽象类，它是否必须提供两个实现，例如：

```
class C: public B
{
   public:
   virtual void A::foo() {};
   virtual void B::foo() {};
}; 
```

编译器仅在`B::foo()`缺少 的实现时才会抱怨，但不会抱怨缺少`A::foo()`.

总而言之：这是一种隐藏纯虚方法的方法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-24T21:00:24.307

当您第一次声明时：

```
class A
{
   public:
   virtual void foo() = 0;
}; 
```

您将方法声明为`foo`public、virtual 和 pure。当一个类至少包含一个纯方法时，它被称为*abstract*。这是什么意思？这意味着该类无法实例化，因为它需要纯方法实现。

您显然可以从抽象类继承（我会说您被迫这样做，否则除了提供要继承的接口之外，您不使用的抽象类需要什么？），您还可以从抽象类继承，不实现父类的部分或全部纯方法；在这种情况下，子类也是抽象的，您的 B 类就是这种情况：

```
class B: public A
{
   public:
   virtual void foo() = 0;
}; 
```

在 B 中，您可以轻松地省略`virtual void foo() = 0;`声明，因为定义已经从基类继承。在这种情况下，类 B 是一个抽象类，因此不能像 A 一样被实例化。

更直接地回答您的问题：

> `foo`从B隐藏`foo`A ？

不，不是的。他们都声明了一个纯方法（实际上是相同的方法），因此没有什么可真正*隐藏*的。

> 从 B 继承的第一个类不是抽象类，它是否必须像提供的那样提供两个实现？

不，当然不是。如上所述，它们是相同的方法，因此如果 C 类必须为其提供实现，`foo`则只需实现`foo`：

```
class C: public B
{
   public:
   virtual void foo() {};
}; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-24T20:29:13.183

> 0) 编译器不会抛出错误...

`A`当您尝试实例化对象或`B`它们是抽象的对象时，它将引发错误。不是在您继承和声明它们时。

> 1) 来自 B 的 foo 是否隐藏了来自 A 的 foo？

不，它超越`A::foo`而不是隐藏它。

> 2）从B继承的第一个类不是抽象类，它是否必须提供两个实现......

不，只需覆盖`foo`并为它做一个实现。

```
class C : public B
{
public:
    virtual void foo()
    {
        std::cout << "ABCD" << std::endl;
    }
};

int main()
{
    C c;
    A *a = &c;
    a->foo(); //  Prints ABCD string and proofs B::foo doesn't hide A::foo
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-24T20:53:23.447

我用 gcc 4.5.3 编译了你的代码，它给出了以下错误消息：

```
error: cannot define member function ‘A::foo’ within ‘C’
error: cannot define member function 'B::foo' within 'C' 
```

在您的示例中， class`A`和`B`都是抽象类，因为 foo 是纯虚拟的。他们只定义 B 的派生类应该实现的行为，`foo`因为没有默认行为可以使用（如果派生类不再是抽象的）。

`Question 1:Does foo from B hide foo from A?`

由于`foo`in`B`和`A`具有完全相同的名称，相同的签名和 foo 在基类中是虚拟的，所以它不是隐藏的，而是覆盖的。仅供参考：如果签名相同并且在基类中声明为虚拟，则派生类的函数`overrides`是基类函数。如果通过指针或对基类的引用调用它，则调用派生类中的函数。它“覆盖”了基类中的那个。 `Hiding`仅当您通过指针或引用或直接使用派生类的对象调用非虚拟函数时才会发挥作用。派生类的函数隐藏了所有同名的基类函数。

`Question 2: The first class which inherits from B and is not an abstract class, does it have to provide two implementations`

不，您可以执行以下操作：

```
 class C: public B
  {
   public:
      virtual void foo()
      {
        cout << "foo defined in c" <<endl;
      }
 }; 
```

# sql - 在没有聚合函数的情况下找到最大值

> ID：15603581
> 
> 赞同：2
> 
> 时间：2013-03-24T20:25:37.003
> 
> 标签：sql, max

对于 SQL 中的表，我有以下架构。

```
Owner (ownerid, name, phone, age) 
```

我被要求在不使用任何聚合函数（例如 MAX）的情况下编写一个语句来查找数据库中最旧的所有者。我也不允许使用任何特定于任何 DBMS 的东西。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:27:33.520

您可以使用`EXISTS`运算符，这是所有符合 SQL 的 RDBMS 的标准：

```
SELECT age
FROM Owner o1
WHERE NOT EXISTS (SELECT 1 FROM Owner o2 WHERE o2.age > o1.age) 
```

这个查询背后的想法是不言自明的：最旧的所有者是这样一个所有者`o1`，即没有其他所有者`o2`比`o2`更老`o1`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-11T18:30:29.510

另一种选择是使用 ALL 运算符：

```
select o1.*
from "owner" o1
where age > all (select age 
                 from "owner" o2
                 where o2.ownerid <> o1.ownerid); 
```

它基本上找到年龄大于所有年龄值的所有者，除了我们正在查看的那个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-11T18:23:54.340

您还可以使用**NOT IN**和**JOIN**运算符，这是所有 SQL 投诉 RDMS 的标准。

```
select age from owner where age not in (select o2.age from owner as o1 JOIN owner as o2 ON o1.age > o2.age); 
```

# android - 不可能的 RuntimeException：带有 Robolectric 的存根

> ID：15603583
> 
> 赞同：2
> 
> 时间：2013-03-24T20:25:50.510
> 
> 标签：android, robolectric

我花了几个小时试图弄清楚这一点。

我正在使用 Maven 在 IntelliJ IDEA 中使用 Robolectric 构建和测试一个项目。我在 POM 中的 Android 之前声明了 Robolectric，并且我使用 SDK 部署程序安装到我的本地存储库。但我仍然不断收到此错误：

> java.lang.RuntimeException：存根！在 android.net.Uri.$$robo$$Uri_30fc_parse(Uri.java:53) 在 org.robolectric.bytecode.ShadowWrangler$InvocationPlan.callOriginal(ShadowWrangler.java:591) 在 android.net.Uri.parse(Uri. java) at org.robolectric.shadows.ShadowMediaStore.reset(ShadowMediaStore.java:27) at org.robolectric.Robolectric.resetStaticState(Robolectric.java:821) at org.robolectric.RobolectricTestRunner.resetStaticState(RobolectricTestRunner.java:224) at org.robolectric.RobolectricTestRunner.internalBeforeTest(RobolectricTestRunner.java:133) at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68) at org.junit. org.robolectric.RobolectricTestRunner.methodBlock(RobolectricTestRunner.java:96) .runners.BlockJUnit4ClassRunner.runChild（BlockJUnit4ClassRunner.java：

而我的 pom.xml 正是如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>

<groupId>org.jemson</groupId>
<artifactId>notecloud-mobile</artifactId>
<version>.01</version>
<packaging>apk</packaging>
<name>Note-Cloud Mobile</name>

<profiles>
    <profile>
        <id>offline</id>
        <properties>
            <config.scheme>http://</config.scheme>
            <config.host>10.0.2.2</config.host>
            <config.path>/notecloudtest/index.html</config.path>
        </properties>
    </profile>
    <profile>
        <id>online</id>
        <properties>
            <config.scheme></config.scheme>
            <config.host></config.host>
            <config.path></config.path>
        </properties>

    </profile>
</profiles>

<dependencies>
    <dependency>
        <groupId>com.logician</groupId>
        <artifactId>abstractmodel</artifactId>
        <version>1</version>
    </dependency>
    <dependency>
        <groupId>com.androidquery</groupId>
        <artifactId>android-query</artifactId>
        <version>0.24.3</version>
    </dependency>

    <dependency>
        <groupId>org.robolectric</groupId>
        <artifactId>robolectric</artifactId>
        <version>2.0-alpha-2</version>
        <scope>test</scope>
    </dependency>

    <dependency>
        <groupId>org.hamcrest</groupId>
        <artifactId>hamcrest-core</artifactId>
        <version>1.2</version>
        <scope>test</scope>
    </dependency>

    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.10</version>
        <scope>test</scope>
    </dependency>

    <dependency>
        <groupId>com.googlecode.androidannotations</groupId>
        <artifactId>androidannotations</artifactId>
        <version>2.7</version>
        <scope>provided</scope>
    </dependency>

    <dependency>
        <groupId>com.googlecode.androidannotations</groupId>
        <artifactId>androidannotations-api</artifactId>
        <version>2.7</version>
    </dependency>

    <dependency>
        <groupId>android</groupId>
        <artifactId>android</artifactId>
        <version>4.2.2_r2</version>
        <scope>provided</scope>
    </dependency>

    <dependency>
        <groupId>android.support</groupId>
        <artifactId>compatibility-v4</artifactId>
        <version>12</version>
    </dependency>

</dependencies>

<build>
    <finalName>${project.artifactId}</finalName>
        <plugins>

            <plugin>
                <groupId>com.google.code.maven-replacer-plugin</groupId>
                <artifactId>replacer</artifactId>
                <version>1.5.2</version>
                <executions>
                    <execution>
                        <phase>prepare-package</phase>
                        <goals>
                            <goal>replace</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <file>templates/Config.java</file>
                    <outputFile>src/main/java/org/jemson/notecloud/Config.java</outputFile>
                    <replacements>
                        <replacement>
                            <token>#scheme</token>
                            <value>${config.scheme}</value>
                        </replacement>
                        <replacement>
                            <token>#host</token>
                            <value>${config.host}</value>
                        </replacement>
                        <replacement>
                            <token>#path</token>
                            <value>${config.path}</value>
                        </replacement>
                    </replacements>
                </configuration>
            </plugin>

            <plugin>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>
            </plugin>

            <plugin>
                <!-- See http://code.google.com/p/maven-android-plugin/ -->
                <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                <artifactId>android-maven-plugin</artifactId>
                <version>3.4.1</version>
                <configuration>
                    <sdk>
                        <platform>17</platform>
                    </sdk>
                </configuration>
                <extensions>true</extensions>
            </plugin>

        </plugins>
</build> 
```

AbstractModel 是我自己的个人便利库。它在内部的任何地方都不使用 Uri 类。至于Android-Query，我不确定。我认为对 Uri.parse() 的有问题的调用在我正在测试的 Activity 类中；我已经尝试评论调用以查看会发生什么，但仍然抛出异常。

我尝试在 IntelliJ 模块配置中移动 Robolectric 依赖项，以确保它们实际上是在 Android 之前包含的。我已将我的 POM 和 .iml 文件与 RobolectricSample 项目文件尽可能匹配。我什至删除了项目树中的所有 IntelliJ 文件，并从 POM 中重新打开了项目。没有什么。

我完全糊涂了。我已经尝试了我能想到的一切。我正在考虑为这个项目取消 Robolectric，并在模拟器中运行应用程序进行测试。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T19:01:41.640

我和你有同样的问题。还有一个[额外](https://stackoverflow.com/questions/15753281/robolectric-sqlitestatement-executeupdatedelete-doesnt-perform-any-action)的 .

> 无用的文本剪切

**更新 1。**

在 github 上发现了这个问题： [https ://github.com/pivotal/robolectric/issues/426](https://github.com/pivotal/robolectric/issues/426)

有些人说在mac os上它可以工作..

**更新 2。**

找到解决方法（由[esam091](https://github.com/pivotal/robolectric/issues/426#issuecomment-15677826)评论）：

```
public class YourTestRunner extends RobolectricTestRunner
{
    public YourTestRunner(Class<?> testClass) throws InitializationError
    {
        super(RobolectricContext.bootstrap(YourTestRunner.class, testClass,
            new RobolectricContext.Factory()
            {
                @Override
                public RobolectricContext create()
                {
                    return new RobolectricContext()
                    {
                        @Override
                        public boolean useAsm() // this override does the trick
                        {
                            return false;
                        }

                        @Override
                        protected AndroidManifest createAppManifest()
                        {
                            return new AndroidManifest(
                                new File("YourApp/src/main/android/AndroidManifest.xml"),
                                new File("YourApp/src/main/android/resources"));
                        }
                    };
                }
            }));
    }

    @Override
    public void prepareTest(Object test)
    {
        RoboGuice.injectMembers(Robolectric.application, test);
    }
} 
```

`@RunWith(YourTestRunner.class)`在每个使用 Android API 的测试上指定。

**更新 3。**

问题已修复： [https ://github.com/pivotal/robolectric/pull/458](https://github.com/pivotal/robolectric/pull/458)

# html - 下推第 n 个图像

> ID：15603593
> 
> 赞同：0
> 
> 时间：2013-03-24T20:27:02.900
> 
> 标签：html, css

我有 4 个图像元素，我想在元素 nr 之后下推所有元素。2

所以而不是得到：

```
| | | | 
```

我会得到：

```
| |
| | 
```

我`img:nth-child(2)`用来定位元素，它确实有效。但是我有问题将以下元素向下推。我以为`clear: right`会这样做，但它不起作用。

这是我的小提琴：http: [//jsfiddle.net/zXteb/](http://jsfiddle.net/zXteb/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:29:15.180

你必须浮动图像才能`clear`工作：

```
div img {
    float: left;
    margin-right: 5px;
    margin-top: 5px;
}

div img:nth-child(2n+1) {
    clear: left;
} 
```

[http://jsfiddle.net/zXteb/1/](http://jsfiddle.net/zXteb/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T15:04:09.780

你可以在没有浮动和清除的情况下做到这一点。换行符有一个非常酷的技巧`content`：

[http://jsfiddle.net/rudiedirkx/By2sD/1/](http://jsfiddle.net/rudiedirkx/By2sD/1/)

```
ul {
    list-style: none;
    width: 500px;
    background: #eee;
    text-align: center;
    padding: 0;
    display: block;
}
li {
    display: inline;
    margin: 5px;
}
li:nth-child(2n+2):after {
    content: '\A';
    white-space: pre;
} 
```

`\A`是换行符，而`white-space: pre`是`<br>`. 所有元素都是内联的，因此您可以将整个元素居中

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-24T20:39:05.327

这就是它在 HTML 中的使用方式——

```
<div id="one">
    <img style="width: 100px; height: 100px" />
</div>
<div id="two">
    <img style="width: 100px; height: 100px" />
</div>    
<div id="three">     
    <img style="width: 100px; height: 100px" />
</div>            
<div id="four">
    <img style="width: 100px; height: 100px" />
</div> 
```

而css会像这样

```
#one {
    float:left;
    padding-right:5px;
}
#two {
    float:left;
}
#three {
    float:left;
    clear:both;
    padding-right:5px;
}
#four {
    float:left;
} 
```

# php - 同样的facebook问题... OAuthException：必须使用活动访问令牌来查询有关当前用户的信息

> ID：15603598
> 
> 赞同：1
> 
> 时间：2013-03-24T20:27:43.957
> 
> 标签：php, facebook, api

所以这工作正常......但是当我刷新页面两次（或快速单击包含此脚本的两个页面）时，它会给出此错误 OAuthException：必须使用活动访问令牌来查询有关当前用户的信息。有任何想法吗？

```
<?php

  $app_id = '***************';
  $app_secret = '**************';
  $app_namespace = '****************';

  $app_url = 'http://apps.facebook.com/' . $app_namespace . '/';
  $scope = 'email,publish_actions';

  // Init the Facebook SDK
   $facebook = new Facebook(array(
     'appId'  => $app_id,
     'secret' => $app_secret,
   ));

   // Get the current user
   $user = $facebook->getUser();

   // If the user has not installed the app, redirect them to the Login Dialog

   if (!$user) {
     $loginUrl = $facebook->getLoginUrl(array(
       'scope' => $scope,
       'redirect_uri' => $app_url,
     ));

     print('<script> top.location.href=\'' . $loginUrl . '\'</script>');
   }

if ($user) {
  try {
    // Proceed knowing you have a logged in user who's authenticated.
    $user_profile = $facebook->api('/me', 'POST');
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}
//<img src="https://graph.facebook.com/?php echo $user; ?/picture">
//?php print_r($user_profile); ?
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:10:32.627

我个人觉得管理自己更容易`access_token`。Facebook 的 Graph API 通过要求`access_token`传入一个来保护受保护的端点。PHP SDK 将这一点抽象出来，但我对 Facebook 处理这些信息并不感到满意，因为有时*它根本不起作用*。这并不是说这个库不好，只是说**我没有正确使用它**。请记住这一警告。

看起来您正在使用 Facebook Canvas 应用程序。当用户第一次成功认证时，Facebook 会发送一个`access_token`in `$_GET`。此时，您*应该*将其保存到您的数据库中，因为该访问令牌可以使用 3 个月左右。

此时，您可以在`access_token`调用参数中传入：

```
try {
    $user_profile = $facebook->api('/me', 'POST', array(
        "access_token" => ''    // access token goes here
    ));
} catch (FacebookApiException $e) {
    // error handling
} 
```

鉴于 Facebook 正在返回您需要访问令牌才能调用`/me`资源的错误，它看起来`$facebook->getUser();`正在返回一些东西。您可能需要仔细检查它是什么。

* * *

当我在这里时，您正在使用以下逻辑：

```
if (!conditional) {
    // do something
}
if (conditional) {
    // do something else
} 
```

令人困惑。使用`else`：

```
if (conditional) {
    // do something
} else {
    // do something else
} 
```

# java - JUnit 测试中的覆盖方法

> ID：15603601
> 
> 赞同：1
> 
> 时间：2013-03-24T20:28:08.953
> 
> 标签：java, unit-testing, junit

我需要编写基于耦合的测试来观察多条路径。我正在尝试像通常的测试一样使用`Assert.*`（我不知道有什么更好的方法），但为此我需要更改测试方法。

考虑以下示例

```
Class A {
public Collection<Object[]> mth1(String a);
do whatever
do whatever
B.mth2(a)
do whatever
return null

Class B
public void mth2 (String a)
a.parse();
do whatever
return null 
```

对于我的测试，我对实际值不感兴趣，我只需要知道我的测试是否达到了某个点。

因此，我想以`mth2`这种方式覆盖 - 在第 11 行`mth1`调用 return 并在第 6 行调用 return 值为 1。

有没有办法做这样的事情或更好的方法来测试耦合？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:35:50.133

使用模拟库（谷歌搜索模拟）。为 B 类创建一个模拟对象。在测试中使用它。

# node.js - Node.js 文件系统模式？

> ID：15603602
> 
> 赞同：1
> 
> 时间：2013-03-24T20:28:37.627
> 
> 标签：node.js, file-io

我很难在 Node.js 中打开和读取一个简单的文本文件。我的部分问题是[许多文件系统函数](http://nodejs.org/api/fs.html#fs_fs_open_path_flags_mode_callback)需要一个神秘的 [mode] 参数。这显然是一个四位数的数字，它......做某事。我不知道是什么，我似乎找不到一个好的解释。我怀疑这对于精英 node.js 黑客来说是相当基本的东西，但我发现它相当神秘。谁能解释这个论点的作用？

# php - php mysql登录问题 $_POST['username'] = $result['username']

> ID：15603612
> 
> 赞同：-2
> 
> 时间：2013-03-24T20:29:24.177
> 
> 标签：php, mysql, database, forms, login

我有点'初学者，我已经从零编写了我自己的 PHP 登录，但我仍然遇到了一些错误，这是代码：

```
 <?php 
    include 'connection.php';
    $query = " SELECT * FROM admin";
    $result = mysql_query($query) or die(mysql_error());

    ?>
    <form action="<?php echo $_SERVER['SELF_PHP']; ?>" method="post">
        Username : <input type="text" name="usernameInput" value="" />
        Password : <input type="password" name="passwordInput" value="" />
                    <input type="submit" value="Login" />
    </form>

    <?php
    $username = $_POST['usernameInput'];
    $password = $_POST['passwordInput'];
    if ($username = $result['username']) {
        if ($password = $result['password']){
            header('Location: admin.php');
        } else {
            echo "PASSWORD IS INCORRECT";
        }
    } else {
        echo "USERNAME IS INCORRECT";
    }
    ?> 
```

因此，如果您可以解决此问题或从 PHP 登录获得更简单的方法，请告诉我。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:34:59.817

一些东西...

1.  不要使用`mysql`函数
2.  您需要用于`==`比较字符串，而不是`=`
3.  您需要实际[获取](http://php.net/manual/en/function.mysql-fetch-row.php)查询结果

    ```
    include 'connection.php';
    $query = " SELECT * FROM admin";
    $result = mysql_query($query) or die(mysql_error()); 
    $row = mysql_fetch_row($result); /* add this */

    ?>
    <form action="<?php echo $_SERVER['SELF_PHP']; ?>" method="post">
        Username : <input type="text" name="usernameInput" value="" />
        Password : <input type="password" name="passwordInput" value="" />
                    <input type="submit" value="Login" />
    </form>

    <?php
    if(isset($_POST['usernameInput']) && isset($_POST['passwordInput'])){
        $username = $_POST['usernameInput'];    
        $password = $_POST['passwordInput'];
    }
    else{
       echo 'some error ...';
    }

    if($username == $row ['username'] && $password == $row ['password']){
        header('Location: admin.php');
    } 
    else{
        echo ' username or password is wrong';
    }

    ?> 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:40:11.020

我必须指出，您在没有先检查帖子的情况下一遍又一遍地发送相同的表格。当您发送**表单**时，您将无法将**标头发**送到重定向，因为 html 已启动并且标头已发送。

不推荐使用 mysql 函数，请使用 mysqli 接口。

在其他几个错误中，例如 assignment = 而不是等于 ==

试试这种方式：

如果不存在帖子，请发送表格，否则检查是否可以重定向或不可以。重新发送表格

```
<?php 
if($_POST){
    include 'connection.php';
    $query = " SELECT * FROM admin";
    $r = mysql_query($query) or die(mysql_error());
    // get an associated array from query result resource. 
    $result = mysql_fetch_assoc($r);  
    $username = $_POST['usernameInput'];
    $password = $_POST['passwordInput'];
    if (  ($username == $result['username'])
       && ($password == $result['password'])){
        header('Location: admin.php');
        exit(0);
    } else {
        echo "PASSWORD IS INCORRECT";
    }
} 
?>
<form action="<?php echo $_SERVER['SELF_PHP']; ?>" method="post">
    Username : <input type="text" name="usernameInput" value="" />
    Password : <input type="password" name="passwordInput" value="" />
                <input type="submit" value="Login" />
</form>

<?php

?> 
```

# c# - 如何刷新画布

> ID：15603614
> 
> 赞同：9
> 
> 时间：2013-03-24T20:29:28.850
> 
> 标签：c#, wpf, canvas, .net-4.0, refresh

我正在尝试创建任何排序算法的可视化表示，其中数据以 int[] 数组表示。维基百科上的冒泡排序示例：

![来自维基百科的冒泡排序](../Images/ed8fcb777c80e5675998f2055a4887bf.png)

当交换 int[] 数组中的两个项目时，我的排序算法都会引发一个事件 ItemsSwapped。我试图在画布上的每个事件之后显示数据，这是我的代码：

```
// Handler for ItemsSwapped event.
private void Render(object sender, ItemsSwapEventArgs e)
{
    canvas.Children.Clear();
    int numberOfElements = e.Data.Length;

    for (int x = 0; x < numberOfElements; x++)
    {
        RenderValue(x, e.Data[x]);
    }
    // Here I should somehow refresh canvas.
}

private void RenderValue(int x, int y)
{
    var value = new Ellipse
                    {
                        Width = 5,
                        Height = 5,
                        Stroke = Brushes.Black,
                        StrokeThickness = 2,
                    };
    Canvas.SetTop(value, x);
    Canvas.SetLeft(value, y);
    canvas.Children.Add(value);
} 
```

问题是，画布不会自行刷新，它只是在一段时间后显示最终解决方案。每次引发事件后如何刷新它？

编辑 - 我尝试了 UpdateLayout、InvalidateMeasure 和 Dispatcher 对象，但都没有奏效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:44:32.073

也许您在 UI 线程上启动排序算法，所以它在完成之前不会更新。尝试在另一个线程中排序并使用[Dispatcher](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.aspx)通过调用[Invoke](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.invoke.aspx)或[BeginInvoke](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.begininvoke.aspx)更新 Canvas 子项。

如果您的`ItemsSwapped`处理程序是从单独的线程调用的，它可能如下所示：

```
private void Render(object sender, ItemsSwapEventArgs e)
{
    Dispatcher.Invoke((Action)(() =>
        {
            canvas.Children.Clear();
            int numberOfElements = e.Data.Length;

            for (int x = 0; x < numberOfElements; x++)
            {
                RenderValue(x, e.Data[x]);
            }
        }));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-24T20:45:27.047

你在使用线程吗？您必须在与主 UI 不同的线程中完成工作。这是一个帮助您入门的链接：[如何从 C# 中的另一个线程更新 GUI？](https://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c)

# c++ - 强制 Visual Studio 在包含错误的大写时出错

> ID：15603616
> 
> 赞同：4
> 
> 时间：2013-03-24T20:29:34.837
> 
> 标签：c++, visual-studio-2008

在 Visual Studio 2008 c++ 中，如果可以强制编译错误以导致标题包含的不正确大写。（ThisIsAHeader.h VS thisIsAheader.h）

我知道 Windows 是不区分大小写的文件系统。问题的出现是因为在 Windows 上开发时，由于头文件名错误，无意中破坏了 linux 构建。

如果有一种方法可以使 cl.exe 引发编译错误，则可以节省相当多的不必要的构建破坏周期。

假设：不能要求 Windows 开发团队切换到使用 Visual Studio 以外的其他东西，也不能将所有标题更改为全部小写。

# javascript - 使用键盘箭头选择并选择 div 元素并输入键？

> ID：15603617
> 
> 赞同：4
> 
> 时间：2013-03-24T20:29:38.483
> 
> 标签：javascript, jquery, html, keyboard-events

有什么方法可以通过按键盘上的箭头键来导航 div 元素的网格，然后按 enter 键“单击”选定的 div？我知道我至少应该尝试以某种方式完成这项工作，但我完全不知道如何做到这一点，甚至是否可能。

我知道如果不使用鼠标，以下内容将无效，那么我该怎么做才能在特定 div 上显示某种“焦点”？

```
.show:hover{
    width:94px;
    height:94px;
    border:3px solid black;
}

.lock{
    pointer-events:none;
} 
```

任何提示从哪里开始？我的游戏在这里：http: [//jsfiddle.net/94jerdaw/WXEes/](http://jsfiddle.net/94jerdaw/WXEes/)

**编辑：**

是否可以按原样导航 div 字段，从当前位置“向上”，或者我是否必须为每个 div 做一个案例作为起始点，并伴随它应该在 up/down/left/ 中的每个 div正确的事件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-25T13:07:12.043

希望你的问题对你来说仍然很有趣。我有一些时间，我一直想拥有自己的记忆游戏。所以我开始构建您想要的功能，完整代码请参见[Fiddle](http://jsfiddle.net/BNrBX/)。由于小提琴框架，您必须在游戏中单击一次。

编辑：对不起，我的脚本中有一些垃圾代码，因为我分叉了我自己的插件基本设置之一，稍后将删除它。

它还没有完成，但今天我会完成它。我将它构建为插件，因为稍后我想添加一些选项。但关键运动的想法应该是清楚的。

我创建了一个地图对象（您也可以使用数组，我认为更容易）来查找位置。

太多的代码在这里发布，所以这里有一个片段：

```
$(window).keydown(function (e) {
    //Initial set first card as selected
    var actCard, nextCard;

    if ($('.cardset').find('.selected').length < 1) {
        $('#card1').addClass('selected');
    } else {
        switch (e.which) {
        case 37: // left
            $('.cardset').find('.selected').cardMoveHorizont('prev', cardMap);
            break;

        case 38: // up
            $('.cardset').find('.selected').cardMoveHorizont('up', cardMap);
            break;

        case 39: // right
            $('.cardset').find('.selected').cardMoveHorizont('next', cardMap);
            break;

        case 40: // down
            $('.cardset').find('.selected').cardMoveHorizont('down', cardMap);
            break;

        default:
            return; // exit this handler for other keys
        }
        e.preventDefault();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:39:00.643

您需要为箭头键绑定事件侦听器并输入，可以从 JS/jQ 轻松完成

1min google： [在 JS/jQuery 中绑定箭头键](https://stackoverflow.com/questions/1402698/binding-arrow-keys-in-js-jquery)

# sql - SQL 计算列

> ID：15603618
> 
> 赞同：0
> 
> 时间：2013-03-24T20:29:39.140
> 
> 标签：sql, sql-server

我正在编写一个网站，客户现在想要不同的角色（比规范中指定的角色更多）。所以现在我必须向每个用户展示更少的内容。

例如，如果某人是**数据输入**用户，他也可以查看私人项目。

因此，在我的表 PROJECTS 中，我有一个名为 STATE 的属性，其中显示了项目的状态。

如果是：

1.  待审批，
2.  存档，
3.  删除，
4.  上市，
5.  私人的

在我的代码中，我有很多 SQL 查询`SELECT * FROM PROJECT LIKE 'smth'`或`SELECT * FROM PROJECT WHERE COUNTRY=smth`很多其他需要返回项目的查询。

所以我想要的是表 PROJECT 上的计算值，它将根据**当前登录的 USER**对表的每一行返回 true 或 false 。

所以我可以打电话`SELECT * FROM PROJECT LIKE 'smth' AND computed_attr = TRUE`给我的每一个查询。

问题是我只知道sql上的SCALAR_FUNCTIONS，你只能在当前表上使用参数。

当用户登录并且必须运行查询时，我希望**将此 USER_ROLE_ID 作为参数，**以便函数可以选择显示或不显示表的当前行。

```
SELECT * 
FROM PROJECT 
LIKE 'smth' AND scalarFunction(USER_ROLE_ID) = TRUE 
```

# java - 声明一个不必处理的异常？

> ID：15603623
> 
> 赞同：3
> 
> 时间：2013-03-24T20:30:19.930
> 
> 标签：java, exception

在Java中，当我决定抛出异常时，是否可以将此异常定义为不必处理？

谢谢 ：-）

（我在 Java 7 上）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-24T20:31:15.537

不需要处理任何子`Exception`类型的。[`RuntimeException`](http://docs.oracle.com/javase/6/docs/api/java/lang/RuntimeException.html)这称为未经检查的异常。

也就是说，如果您认为有必要，您仍然可以选择处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:36:38.160

它可以通过抛出[未经检查的异常来实现。](http://docs.oracle.com/javase/tutorial/essential/exceptions/runtime.html) [RuntimeException](http://docs.oracle.com/javase/6/docs/api/java/lang/RuntimeException.html)是调用程序不需要处理的未经检查的异常。任何子类，如 ClassCastException 等，都是从 RuntimeException 派生的，您不必担心处理它们。

# html - 如何获得粘性页脚？

> ID：15603625
> 
> 赞同：1
> 
> 时间：2013-03-24T20:30:22.163
> 
> 标签：html, css, sticky-footer

我知道有很多关于粘性页脚的问题，但我似乎无法让它们在我的页面上工作。

谁能帮我让我的页脚变粘，而不是固定？

我的 HTML

```
<div id="container">
      <div id="header"></div>
      <div id="content"></div>
      <div id="footer"></div>
</div> 
```

我的 CSS

```
#container {
    width: 980px;
    min-height: 100%;
    margin-left: auto;
    margin-right: auto; }

#content {
    width: 100%;
    min-height: 100%;
    margin: 40px 0;  }

#footer {
    width: 3000px;
    min-height: 185px;
    background-color: rgb(0,173,239);
    margin-left: -1000px;  } 
```

我尝试了各种职位（相对的，固定的等），但它不起作用。我似乎修复了页脚并覆盖了内容。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:34:32.120

试试这个 CSS：

```
body {
    min-height: 100%; }

#container {
    width: 980px;
    min-height: 100%;
    margin-left: auto;
    margin-right: auto; }

#content {
    width: 100%;
    min-height: 100%;
    margin: 40px 0;
    margin-bottom: 290px;  }

#footer {
    width: 100%;
    min-height: 185px;
    background-color: rgb(0,173,239);
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;  } 
```

# java - 调用执行异步任务的方法的本地实例的垃圾收集

> ID：15603626
> 
> 赞同：1
> 
> 时间：2013-03-24T20:30:22.767
> 
> 标签：java, android, asynchronous, garbage-collection

如果我有一个调用执行异步任务的方法的类的本地实例，我是否可以依赖在异步任务完成之前永远不会执行垃圾收集。这是我所指的一个例子；如果我有以下情况：

```
private void loadDocument(String url) {
    HtmlReader reader = new HtmlReader();
    reader.addHtmlListener(this);
    reader.loadUrl(url);            
} 
```

和代码`HtmlReader`看起来像这样：

```
public class HtmlReader {

    ArrayList<HtmlListener> _htmlListeners = new ArrayList<HtmlListener>();

    public void addHtmlListener(HtmlListener listener) {
        this._htmlListeners.add(listener);      
    }

    public void removeHtmlListener(HtmlListener listener) {
        this._htmlListeners.remove(listener);
    }

    public void processHtmlResponse(String url, String html) {  
        for (HtmlListener listener: this._htmlListeners) {
            listener.loadUrlSuccessCallback(url, html);
        }       
    }

    public void loadUrl(String url) {
        new GetHtmlTask().execute(url);
    }

    class GetHtmlTask extends AsyncTask<String, Void, String> {
        protected String doInBackground(String... urls) {
            ....
        }

        protected void onPostExecute(String html) {
            processHtmlResponse(html);
        }
    }

    public interface HtmlListener {
        void loadUrlSuccessCallback(String url, String html);
    }
} 
```

在这种情况下，该`loadDocument`方法肯定会在异步任务完成之前完成。我可以确定实例在完成`reader`之前不会被垃圾收集吗？`GetHtmlTask`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:43:33.457

当`GetHtmlTask`有对它的引用时，它不会被垃圾收集。只要线程处于活动状态，调度程序就会维护这样的引用。因为它又是您的类的内部类`HtmlReader`，所以它维护对其封闭实例的引用。因此，只要任务正在运行，实例就不会被垃圾回收。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:43:25.497

我对垃圾收集的了解是，垃圾收集仅在对象超出范围并且对象没有指向它们的实时引用时才会发生。在您的情况下，我认为阅读器对象不会被垃圾收集，因为异步任务是由阅读器实例产生的仍然处于活动状态。一旦读取器对象产生的每个对象都超出范围，那么它将被垃圾收集。

更多关于Java 中的[垃圾收集](http://javarevisited.blogspot.in/2011/04/garbage-collection-in-java.html)。

# python - 如何在 python 中计算 NTLM 哈希？

> ID：15603628
> 
> 赞同：8
> 
> 时间：2013-03-24T20:30:28.353
> 
> 标签：python, hash, ntlm

如何在 python 中计算密码的 NTLM 哈希？是否有任何库或示例代码？

我希望它用于使用 python 编写 NTLM 蛮力工具（如 Cain & Abel）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-24T20:47:28.633

[在这里](http://docs.python.org/2/library/hashlib.html)使用其实非常简单`hashlib`

```
import hashlib,binascii
hash = hashlib.new('md4', "password".encode('utf-16le')).digest()
print binascii.hexlify(hash) 
```

或者您可以在[此处](http://code.google.com/p/python-ntlm/)`python-ntlm`额外使用该库

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-24T20:48:49.737

您可以使用 hashlib 和 binascii 模块来计算您的 NTLM 哈希：

```
import binascii, hashlib
input_str = "SOMETHING_AS_INPUT_TO_HASH"
ntlm_hash = binascii.hexlify(hashlib.new('md4', input_str.encode('utf-16le')).digest())
print ntlm_hash 
```

# php - 带括号和不带括号的语句

> ID：15603629
> 
> 赞同：0
> 
> 时间：2013-03-24T20:30:34.893
> 
> 标签：php, syntax

我目前正在学习 PHP，并且我已经看到了一些用它编写的命令，有些命令没有括号。我在网上看了看，但我似乎无法找到原因的解释。

我正在谈论的事情是：

```
include "header.php"; 
```

与：

```
include ("header.php"); 
```

我也看到了同样的`echo`命令。有人可以向我解释这些的区别吗？

# hibernate - 从一个子类更改为另一个子类的最聪明方法（更新鉴别器值）

> ID：15603631
> 
> 赞同：3
> 
> 时间：2013-03-24T20:31:10.567
> 
> 标签：hibernate, hierarchy, discriminator, table-per-hierarchy

**背景：**我正在为以下类实现持久性：

*   `class Person`

*   `abstract class ContactInfo`

    *   `Email extends ContactInfo`
    *   `SnailMail extends ContactInfo`

每个***Person***都有一个对***ContactInfo***对象的引用。（并且一个***ContactInfo***对象可以在多个***Person***之间共享。）

在我的用户界面中，我需要让用户编辑联系信息对象，并可能将电子邮件地址替换为蜗牛邮件地址。（如果要替换的联系信息对象在几个人之间共享，则所有这些人都应该更新他们的联系信息。）

然而，据我了解，Hibernate 拒绝更新鉴别器列，因此只需创建一个新的***SnailMail对象，为其提供要替换的******电子邮件***对象的主键值，然后保存它是行不通的。

**问题：**允许用户将***ContactInfo***对象从***Email***更改为***SnailMail***的最佳方法是什么？

（这些对象是“短暂的”。它是 Web 应用程序的一部分，所有对象都会在每次请求时通过 HQL 重新读取，因此无需担心任何分离的对象。）

**到目前为止我的想法：**我意识到我可以删除旧对象，插入新对象。如果这是首选方法，我应该 (A) 尝试重用旧的主键值（在这种情况下我需要使用分配的生成器）还是 (B) 让后端为新对象生成新的 ID，并且更新人员联系人引用以指向新对象？

如果 (B) 是要走的路，我可以使用一些 HQL 语句更新引用，还是应该“手动”加载/更新/保存所有受影响的人员对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-29T11:04:57.273

我认为您不太可能使用不同类的全新实例来更新它。毕竟，您已经创建了一个新实体，因此它并不是真正的更新。

您确定 Person 不需要多个 ContactInfo(s) 吗？如果关系是many2many，您可以这样管理它，也许您已经在管理类似的案例。Web 界面将明确显示“地址 1、2、...”，每个都根据其特定类型呈现，每个都带有“-”按钮和最后一个“+”按钮。这将清楚地表明，如果他们想更改其类型，则必须删除/添加联系信息。

一种类似的方法是删除/重新创建联系信息，前提是用户已更改其类型（可能您已经必须呈现新的 Web 表单）。在这种情况下，我认为您无法避免更新与其他人的链接。我会通过建立双向关系来做到这一点，即同时引入Person.getContactInfo() 和ContactInfo.getPersons()。我将在 add()/delete() 方法中管理双向性（即 addContactInfo( ContactInfo c) 应该调用 c.addPerson （ this ），反之亦然，参见[这里](https://github.com/ISA-tools/jUtils/blob/master/src/main/java/uk/ac/ebi/utils/orm/Many2ManyUtils.java)）并且 Hibernate 应该能够自动更新外键.

# matlab - 如何在 Matlab 中创建可扩展数组？

> ID：15603636
> 
> 赞同：1
> 
> 时间：2013-03-24T20:31:24.453
> 
> 标签：matlab

如何在 Matlab 中创建可扩展数组？

我可以创建一个固定长度的数组，`myArray = zeros(1,2);`但我需要一个可以不断将新元素推送到列表中的数组。我应该如何运行命令来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:52:13.720

MATLAB 数组/矩阵在构造上是动态的。`myArray = [];`将创建一个动态数组。从那里您可以分配和扩展（通过附加或连接）。一些例子：

```
myArray = zeros(1,2);
myArray(:,end+1) = 1;
myArray(end+1,:) = ones(1,3);
myArray = [myArray 2*myArray]; 
```

如果无法选择预分配，则可以在此处找到有关 MATLAB 中不同数组大小调整选项的效率的有趣分析：[数组大小调整性能](http://undocumentedmatlab.com/blog/array-resizing-performance)。

您还可以查看此 SO 帖子：[MATLAB 中未知长度的矩阵](https://stackoverflow.com/questions/1548116/matrix-of-unknown-length-in-matlab)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-24T20:41:08.867

您可以将值分配给项目。

```
myArray = zeros(1,2);
myArray(1,3)=3; % item assignment 
```

myArray 现在的维度为 (1,3)。

# ruby-on-rails - before_filter 带有参数和私有方法

> ID：15603644
> 
> 赞同：0
> 
> 时间：2013-03-24T20:32:57.727
> 
> 标签：ruby-on-rails, before-filter

我想将一些变量传递给使用 before_filter 调用的方法。可以使用[带有参数的控制器实例，例如 before_filter](https://stackoverflow.com/questions/5507026/before-filter-with-parameters)。但就我而言，我有一个私有方法。

我不能使用相同的解决方案。

有没有办法解析它的参数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T21:22:25.513

正如已经说过的那样，这并不好，但是使用确实有帮助，并且在[动作控制器概述指南](http://guides.rubyonrails.org/action_controller_overview.html#filters)`.send`中也提到了它，因此我认为没有真正更好的方法。

# java - 倒坐标系中线和矩形的线裁剪算法？

> ID：15603645
> 
> 赞同：1
> 
> 时间：2013-03-24T20:32:59.917
> 
> 标签：java, math, vector, java-canvas

我正在尝试使用以下算法：[http ://www.skytopia.com/project/articles/compsci/clipping.html](http://www.skytopia.com/project/articles/compsci/clipping.html)

但是对于我的特殊情况，我没有一个`line`跨越`rectangle`2 次的 a，但它从`center`矩形的 开始，并且只穿过它一次。

使用上面的算法，我想获得画布上绘图的单个交点。

问题：画布没有正常的坐标空间，其中 Y 增长到顶部，但 Y 增长到底部。

为了“镜像”y轴并使其在画布坐标系中工作，我需要改变什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:49:11.407

实际上，该算法可以直接移植，因为它与画布一起使用。我在算法中有一些错字，在消除后它按预期工作。

# java - 图像不会显示在 JPanel 上

> ID：15603647
> 
> 赞同：0
> 
> 时间：2013-03-24T20:33:35.250
> 
> 标签：java, swing

刚开始使用 Java 并且是初学者。我尝试创建一个照片查看器，它可以在目录中搜索图像并打开图像，但我的程序不会显示图像。

当我运行程序时，它会打开并显示一个菜单栏，我用它来搜索我的目录，但即使我选择了一个图像，它也不会显示。TIA。

```
import java.awt.*;
import java.awt.event.*;
import java.awt.image.BufferedImage;
import java.io.*;
import javax.swing.*;
import javax.swing.event.*;
import javax.swing.filechooser.FileNameExtensionFilter;
import javax.imageio.ImageIO;

public class ICS
{
private JPanel gui;
private JFileChooser fileChooser;
FilenameFilter fileNameFilter;
private JMenuBar menuBar;
DefaultListModel model; 
public ICS() {
    gui = new JPanel(new GridLayout());

    final JLabel imageView = new JLabel();
    gui.add(imageView);

    fileChooser = new JFileChooser();
    String[] imageTypes = ImageIO.getReaderFileSuffixes();

    menuBar = new JMenuBar();
    JMenu menu = new JMenu("GET PHOTO HERE");
    menuBar.add(menu);
    JMenuItem browse = new JMenuItem("browse");
    menu.add(browse);

    browse.addActionListener(new ActionListener(){
            public void actionPerformed(ActionEvent ae) {
                int result = fileChooser.showOpenDialog(gui);
                if (result==JFileChooser.APPROVE_OPTION) {
                    File eg = fileChooser.getSelectedFile();
                }
            }
        }); 
}

public void loadImages(File directory) throws IOException {
    File[] imageFiles = directory.listFiles(fileNameFilter);
    BufferedImage[] images = new BufferedImage[imageFiles.length];
}

public Container getGui() {
    return gui;
}

public JMenuBar getMenuBar() {
    return menuBar;
}

public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable(){
            public void run() {
                ICS imageList = new ICS();

                JFrame f = new JFrame("Image Browser");
                f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
                f.add(imageList.getGui());
                f.setJMenuBar(imageList.getMenuBar());
                f.setLocationByPlatform(true);
                f.pack();
                f.setSize(800,600);
                f.setVisible(true);
            }
        });
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:38:32.500

你没有对你选择的文件做任何事情。鉴于您的 中有一个空`JLabel`的`JPanel`，您可以简单地`Icon`为该组件设置：

```
imageView.setIcon(new ImageIcon(eg.getPath())); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:39:41.657

它没有对图像做任何事情，因为你从来没有告诉过它。在您的动作侦听器中，您创建了一个文件选择器并获取了选定的文件，但您从未对它做任何事情。您只需将其定义为动作侦听器内的局部变量，然后在您的侦听器退出时立即将其销毁。

你应该做的是，在你的动作监听器中，在你检索到用户选择的文件后，调用一个函数来实际显示你的图像。

此外，ICS 是一个糟糕的类名称。当您的程序变得更大并且您试图记住所有内容时，您应该描述您的类名以供您自己参考和理智。

# php - mysql 2 SELECT 在一个查询中

> ID：15603650
> 
> 赞同：0
> 
> 时间：2013-03-24T20:33:39.047
> 
> 标签：php, mysql, select, where

我希望这两个 SELECT 查询给出一个结果，然后我想按`date_time`

选择 1：

```
"SELECT * FROM `table` WHERE `f_id` = '$uid' AND `t_id` = '$pid'" 
```

选择 2：

```
"SELECT * FROM `table` WHERE `f_id` = '$pid' AND `t_id` = '$uid'" 
```

我试图将它放在一个 WHERE 子句中，但这是不可能的，我也尝试将它们放在子查询中，但这使得 SELECT 2 加入正确的 SELECT 1 ：/ 我想要这两个查询的一个输出数组，按`date_time`. 这怎么可能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-24T20:34:59.860

```
SELECT * FROM `table` WHERE `f_id` = '$uid' AND `t_id` = '$pid'
UNION ALL
SELECT * FROM `table` WHERE `f_id` = '$pid' AND `t_id` = '$uid' 
```

编辑：

呃……对不起，我没看到是同一张桌子。

```
SELECT * FROM table
  WHERE (`f_id` = '$uid' AND `t_id` = '$pid') OR (`f_id` = '$pid' AND `t_id` = '$uid')
  ORDER BY date_time 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-24T20:36:35.207

关于什么：

```
SELECT 
    * 
FROM 
    `table` 
WHERE 
    (`f_id` = '$uid' AND `t_id` = '$pid') OR 
    (`f_id` = '$pid' AND `t_id` = '$uid')
ORDER BY 
    `date_time` DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T20:39:40.210

尝试这个

```
 SELECT * FROM 

      ( select * FROM `table` WHERE `f_id` = '$uid' AND `t_id` = '$pid'
       union all 
        SELECT * FROM `table` WHERE `f_id` = '$pid' AND `t_id` = '$uid' )t

   ORDER BY date_time 
```

# c++ - 整数位移

> ID：15603651
> 
> 赞同：0
> 
> 时间：2013-03-24T20:33:45.320
> 
> 标签：c++, bit-manipulation

我正在尝试为我的霍夫曼编码构建一个位打包器。

由于霍夫曼编码的性质，我有以下形式的字符串： 01001 是可变长度的。我想将它们打包成一个整数以节省空间。

这是我正在做的事情`main`：

```
bitpack.pack(found->second, found->second.size()); 
```

在我的 bitpack 里面我正在做

```
void BitPacker::pack(std::string stream, int size)
{
    std::cout << "BitPacker received:\t" << stream.c_str() << "\t" << size << std::endl;
    for(int i = 0; i < size; i++) {
        //if buffer is not full keep shifting
        std::cout << "Buffer index: " << index << std::endl;
        std::bitset<8> binary(buffer);
        std::cout << "Buffer: " << binary << std::endl;

        if(index < 8) {
            if(stream.at(i) == '1') {
                buffer += 1;
                //buffer << 1;
                buffer <<= 1;
                index++;
            }
            else {
                //buffer << 0;
                buffer <<= 1;
                index++;
            }
        }
        //write buffer
        else {
            std::cout << "Writting:\t"<< buffer << std::endl;
            outfile->put(buffer);
            index = 0;
            buffer = 0;
        }
    }
} 
```

但是，看来我做错了什么。

我想要做的是迭代流，如果它是 1，则添加该位然后移位它。如果是0，我只想换档。这样我就可以继续打包成我的整数，一旦它

代码更新

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:50:22.127

这里有一个问题：

```
 buffer << 1; 
```

什么都不做。这就像写作`x + 1`或`y % 7`; 它返回结果但不修改变量的值。我相信你正在寻找

```
buffer <<= 1; 
```

或者

```
buffer = buffer << 1; 
```

我不熟悉霍夫曼编码，但这是代码逻辑的一个明显问题。

还

```
buffer << 0; 
```

甚至

```
buffer <<= 0; 
```

将没有效果（它移动`buffer`了零位）。那条线应该做什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:43:35.350

请尝试`buffer=buffer<<1;`移动它（或您实际想要多少位）。

无论您想做什么，请注意：`buffer << 0;`什么都不做（关于缓冲区值）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-24T20:50:12.280

这条线，移位`buffer`但不存储移位器值

```
buffer << 1; 
```

你应该使用这样的东西

```
buffer <<= 1; 
```

# java - 手动编码 GUI

> ID：15603658
> 
> 赞同：-1
> 
> 时间：2013-03-24T20:34:06.413
> 
> 标签：java, swing

我有一个希望是这样的 jframe： ![在此处输入图像描述](../Images/948888108d87e335dba16376c9d63de1.png)

这是我的代码，但显示全屏按钮！

```
public class editFrame extends JFrame {

JButton saveButton;
JButton cancelButton;

public editFrame() {
    Component add = this.add(createForm());
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    this.setBounds(100, 50, 500, 600);
    this.setVisible(true);
}

public JPanel createForm() {
    String[] labels = {"ID", "Name", "Date", "Borrow Status"};
    // Create and populate jpanel
    JPanel panel = new JPanel();
    for (int i = 0; i < 4; i++) {
        JLabel l = new JLabel(labels[i], JLabel.TRAILING);
        panel.add(l);
        JTextField textField = new JTextField(10);
        l.setLabelFor(textField);
        panel.add(textField);
    }
    SpringLayout sL = new SpringLayout();
    panel.setLayout(sL);
    SpringUtilities.makeCompactGrid(panel, 4, 2, 6, 6, 6, 6);

    return panel;
}

public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {
            editFrame edF = new editFrame();
        }
    });
}
} 
```

我正在尝试使用弹簧布局，但现在是： ![在此处输入图像描述](../Images/37577ef447c44196f29fd761d3ee8f7b.png)

所有的 jtextfield 都这么大！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-24T20:35:18.787

查看布局管理器教程和 API。在那里您会看到 JFrame 的 contentPane 默认使用 BorderLayout。当您使用容器将组件添加到 BorderLayout 而不指定布局常量时，它会添加 BorderLayout.CENTER，占用整个空间并覆盖之前添加的任何内容。解决方案是查看布局管理器教程，然后开始使用各种布局。请注意，您通常会嵌套 JPanel，每个 JPanel 都使用自己的布局以简单的方式实现复杂的 GUI。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-24T21:56:03.433

> 所有的 jtextfield 都这么大！！

那是因为 SpringLayout 将根据可用空间调整字段的大小。

如果你不希望他们长高，你可以这样做：

```
//Component add = this.add(createForm());
Component add = this.add(createForm(), BorderLayout.NORTH); 
```

或者，如果您不希望它们的宽度或高度增加，您可以将面板包装在使用 FlowLayout 的面板中，因为这将尊重组件的首选大小：

```
//Component add = this.add(createForm());
JPanel wrapper = new JPanel();
wrapper.add( createForm() ) ;
add( wrapper ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T21:29:13.043

绝对 - 使用 GUI 构建器来做 GUI。您将花费更少的时间来开发算法。对于 Eclipse，有[WindowBuilder Pro](http://www.eclipse.org/windowbuilder/)，NetBeanIDE 有 GUI builder。

# backbone.js - 似乎无法正确绑定 Coffeescript 中的 Backbone 事件

> ID：15603659
> 
> 赞同：2
> 
> 时间：2013-03-24T20:34:07.877
> 
> 标签：backbone.js, coffeescript, backbone-events, event-binding

好的，所以我很难让事件绑定与 Coffeescript 和 Backbone 一起工作。我觉得这与我如何初始化所有内容有关。我觉得事件委托甚至都没有运行。

这是我的视图代码：

```
$ ->
  class AppName.TitleView extends Backbone.View
    template: JST['templates/title']
    collection: new AppName.Members
    events:
      "keypress #search"      : "search",
    initialize: =>
      $('#search').keypress(@search) #doing it manually as a hack
    search: ->
      console.log('search handler call')
    render: =>
      $('#app').html(@template)
      @delegateEvents() #this doesn't seem to do anything, nor does @delegateEvents(@events)
      @ 
```

编译时，它看起来像这样：

```
(function() {
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = Object.prototype.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor; child.__super__ = parent.prototype; return child; };

  $(function() {
    AppName.TitleView = (function(_super) {

      __extends(TitleView, _super);

      function TitleView() {
        this.render = __bind(this.render, this);
        this.initialize = __bind(this.initialize, this);
        TitleView.__super__.constructor.apply(this, arguments);
      }

      TitleView.prototype.template = JST['templates/title'];

      TitleView.prototype.collection = new AppName.Members;

      TitleView.prototype.events = {
        "keypress #search": "search",
      };

      TitleView.prototype.initialize = function() {
        return $('#search').keypress(this.search);
      };

      TitleView.prototype.search = function() {

        console.log('search handler call'););
        });
      };

      TitleView.prototype.render = function() {
        $('#app').html(this.template);
        this.delegateEvents();
        return this;
      };

      return TitleView;

    })(Backbone.View);
  });

}).call(this); 
```

`AppName.TitleView`从我的路由器（又由 main 启动`app.coffee`）启动：

```
$ ->
  class AppName.Router extends Backbone.Router
    routes:
      ".*": "main"

    main: ->
      @titleView ||= new AppName.TitleView el: $('#app')[0]
      @titleView.render() 
```

但是对于我的生活，我无法`#search`从 Backbone Events 绑定到绑定。我的 hack（在代码中）只是通过`initialize`函数中的 jQuery 进行绑定。

知道发生了什么吗？我希望这是一个简单的错字或错误的初始化。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-24T20:47:30.307

`el`使用 jQuery 的委托形式将视图事件绑定到视图[`on`](http://api.jquery.com/on/)。这意味着您在视图`events`对象中提到的所有内容都**必须**在视图中`el`，否则不会触发事件处理程序。

默认情况下，视图[`el`](http://backbonejs.org/#View-el)是空的，视图将在需要时`<div>`创建该视图并将事件绑定到该视图。您可能会注意到您没有在代码中使用或任何地方；您的事件已正确绑定，但它们已绑定到您放入 DOM 的任何内容，因此看起来事件无法正常工作。`<div>``<div>``this.el``this.$el`

出现了两种直接的可能性：

1.  用作`#app`视图的`el`：

    ```
    class AppName.TitleView extends Backbone.View
      #...
      el: '#app'
      #...
      render: =>
        @$el.html(@template)
        @ 
    ```

2.  以通常的 Backbone 方式做事，并`el`为您的视图创建一个公正的：

    ```
    class AppName.TitleView extends Backbone.View
      #...
      render: =>
        @$el.html(@template)
        @

    v = new AppName.TitleView
    $('#app').append(v.render().el) 
    ```

我推荐后者，因为它更易于管理，并且可以帮助您避免将多个视图附加到同一个 DOM 元素（以及由此产生的僵尸）。

此外，`@template`几乎总是一个函数，所以你想说：

```
$('#app').html(@template()) 
```

# forms - 如何在 emberjs 中转换到新路由之前在不“保存”的情况下管理新创建的对象？

> ID：15603661
> 
> 赞同：0
> 
> 时间：2013-03-24T20:34:18.883
> 
> 标签：forms, ember.js, persistence

我有一个问题，我有一个新路线的资源。当我过渡到那条新路线时，我创建了一个新对象。在表单上，​​我有取消按钮，它会删除该对象。但是，如果我单击导航上的链接，例如返回资源索引，则该对象与我在表单中输入的任何内容都存在。管理创建对象然后离开表单的最佳方法是什么？

我的路线：

```
App.Router.map(function() {
  this.resource('recipes', function() {
    this.route('new');
    this.route('show', { path: '/:recipe_id' });
  });

  this.resource('styles');
});

App.RecipesNewRoute = Ember.Route.extend({
  model: function() {
    return App.Recipe.createRecord({
      title: '',
      description: '',
      instructions: ''
    });
  },

  setupController: function(controller, model) {
    controller.set('styles', App.Style.find());
    controller.set('content', model);
  }
}); 
```

我的新路线控制器：

```
App.RecipesNewController = Ember.ObjectController.extend({
  create: function() {
    this.content.validate()
    if(this.content.get('isValid')) {
      this.transitionToRoute('recipes.show', this.content);
    }
  },

  cancel: function() {
    this.content.deleteRecord();
    this.transitionToRoute('recipes.index');
  },

  buttonTitle: 'Add Recipe'
}); 
```

我正在使用版本 1.0.0.rc.1

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T21:34:44.530

`deactivate`每次离开该路线时，您放置在路线方法中的任何代码都将被执行。如果用户没有明确保存，以下代码将删除新模型。

```
App.RecipesNewRoute = Ember.Route.extend({
    // ...

    deactivate: function() {
        var controller = this.controllerFor('recipes.new');
        var content = controller.get('content');
        if (content && content.get('isNew') && !content.get('isSaving'))
            content.deleteRecord();
    },

    // ...
}); 
```

作为额外的好处，您现在不需要在用户按下取消按钮时显式删除记录。

# java - 异步调度程序错误

> ID：15603662
> 
> 赞同：20
> 
> 时间：2013-03-24T20:34:25.163
> 
> 标签：java, jax-rs, jboss7.x

当我尝试完全根据此处显示的示例上传文件时，我收到了错误 [示例](http://www.mkyong.com/webservices/jax-rs/file-upload-example-in-resteasy/)

错误是

> 为 servlet com.testapp.rest.JaxRsActivator 分配异常：java.lang.RuntimeException：找不到类 org.jboss.resteasy.core.AsynchronousDispatcher 的公共构造函数

这意味着什么？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2013-03-24T20:52:40.087

如果部署到 JBoss 7.x，您需要将 resteasy 依赖项的范围更改为`provided`. 这是因为这些特定的库已经作为模块包含在 JBoss 中：

```
<dependency>
    <groupId>org.jboss.resteasy</groupId>
    <artifactId>resteasy-jaxrs</artifactId>
    <version>2.2.1.GA</version>
    <scope>provided</scope>
</dependency>

<dependency>
    <groupId>org.jboss.resteasy</groupId>
    <artifactId>resteasy-multipart-provider</artifactId>
    <version>2.2.0.GA</version>
    <scope>provided</scope>
</dependency> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-12-15T06:21:11.833

当我遇到此错误并尝试上述解决方案但对我不起作用时，我正在使用**wildfly 10**`resteasy-jaxrs`部署我的应用程序，最后我不得不使用 maven 排除项排除 jar

```
 <dependency>
        <groupId>org.jboss.resteasy</groupId>
        <artifactId>resteasy-servlet-initializer</artifactId>
        <version>3.0.19.Final</version>
        <scope>provided</scope>
        <exclusions>
            <exclusion>
                <artifactId>resteasy-jaxrs</artifactId>
                <groupId>org.jboss.resteasy</groupId>
            </exclusion>
        </exclusions>
    </dependency> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-14T06:49:44.247

像一个魅力

还有一件事，确保你检查resteasy

```
$ mvn dependency:tree | grep "resteasy"

[INFO] \- org.jboss.resteasy:resteasy-jaxrs:jar:3.0.10.Final:provided
[INFO]    +- org.jboss.resteasy:jaxrs-api:jar:3.0.10.Final:provided 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-21T06:08:39.517

也许值得一提的是，RESTeasy 文档中有[关于](https://docs.jboss.org/resteasy/docs/3.0.6.Final/userguide/html_single/#Installation_Configuration)如何升级 JBoss 中包含的 RESTeasy 的信息，如上所述，如果您尝试使用其他版本，可能会引起一些头痛。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-02T06:00:54.990

简单地说，您可以将此依赖项添加到您的 pom.xml 文件中并对其进行测试。

```
<dependency>
<groupId>org.jboss.resteasy</groupId>
<artifactId>resteasy-jaxrs</artifactId>
<version>2.2.1.GA</version>
<scope>provided</scope>
</dependency> 
```

# javascript - 为什么 Lightbox 会扩展我的网页？

> ID：15603664
> 
> 赞同：0
> 
> 时间：2013-03-24T20:34:48.993
> 
> 标签：javascript, jquery, html, css, lightbox

如果这个问题措辞不佳，我深表歉意，但我最近才开始使用 CSS 和 Javascript，所以我在某些地方有点迷失！

我现在正在做一个投资组合网站，我想用灯箱来展示我的一些作品。但是，它并没有像我在其他网站上看到的那样工作 - 当我点击链接时，虽然图像正常显示，但它也扩展了页面，背景中的黑色叠加层并没有一直走向下，加载 gif 和关闭、上一个和下一个按钮似乎都向右移动了一点。

我相信它与继承的样式（以及我自己不太好的 CSS）有关，我尝试检查元素但找不到它影响灯箱 CSS 的位置。我还尝试将灯箱链接移到我的 CSS 应该影响它的位置之外，但无论如何它都会发生在那里。

如果有人能向我解释为什么会发生这种情况，以及将来如何避免，我将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:42:29.543

在您的 style.css 中删除该`div {...}`部分，因为它会影响所有`div`s 并声明更具体的 CSS 样式。在 CSS 中，您通常应该使 CSS 样式尽可能具体。

# ms-access - 搜索具有特定长度且没有空格的文本

> ID：15603674
> 
> 赞同：1
> 
> 时间：2013-03-24T20:35:24.977
> 
> 标签：ms-access, ms-access-2010

我刚刚学习 Access (2010)，我正在尝试设置查询条件，以便它只带回长度为 10 个字母且没有空格的名称。

我试过`Len([Name])="10"`了，它返回长度为 10 的名称，但它也包括那些带有空格的名称。

给出的提示是：

> 使用通配符 * 和 ?，以及短语 LIKE 和 NOT LIKE"

然而，这还不足以让我整理出来。

什么标准可以解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-06T18:01:10.490

对于其他希望解决此类问题的人，请尝试以下操作：

```
SELECT Communication.CommunicationCode, Communication.CommunicationName
FROM Communication
WHERE LEN([CommunicationCode])=10 AND CommunicationName NOT LIKE "* *" 
```

您需要从`10`.

# php - CodeIgniter 缓存

> ID：15603679
> 
> 赞同：0
> 
> 时间：2013-03-24T20:35:47.237
> 
> 标签：php, codeigniter, caching

我在 CodeIgniter 中开发一个页面，但是我突然遇到了关于缓存的问题。

当我进行更改时，会在更改生效前 10 分钟进行 - 这完全是因为缓存。我已添加尝试将所有这些添加到我的控制器构造函数中，但没有效果：

```
$this->output->set_header("HTTP/1.0 200 OK");
$this->output->set_header("HTTP/1.1 200 OK");
$this->output->set_header("Cache-Control: no-store, no-cache, must-revalidate");
$this->output->set_header("Expires: ". gmdate('D, d M Y H:i:s')."GMT");
$this->output->set_header("Cache-Control: post-check=0, pre-check=0");
$this->output->set_header("Pragma: no-cache"); 
$this->output->cache(0); 
```

有谁知道出了什么问题？或者有什么提示吗？发展成这样太可怕了……

# windows - 基于工作互联网 (WLAN) 连接的 Chrome 有条件加载

> ID：15603680
> 
> 赞同：0
> 
> 时间：2013-03-24T20:35:47.343
> 
> 标签：windows, vba, wsh, windows-embedded

我有一个在嵌入式 Windows XP 上独立运行的瘦客户端，它将用作信息屏幕。成功建立 WLAN 连接后，应从互联网（通过网站）获取信息。所以我正在寻找的是一种在 Windows 启动时检查工作互联网连接的方法。如果连接正常，我想在 Google Chrome 中从 Internet 启动一个网站。如果没有找到有效的连接，我想在 Chrome中启动一个*本地网站。*在伪代码中：

```
if (working internet connection)
    launch Chrome with internet
else
    launch Chrome with local website
end 
```

也许这可以通过一段 Visual Basic 来实现？还是有其他可能的脚本？该脚本应在系统启动时运行。

在此脚本的高级版本中，我最终希望在有工作连接时自动创建网站的本地副本。

这一切都是因为 WLAN 连接在使用它的地方是非常不现实的。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T03:51:08.753

这来自 Randy Birch 的 VB.NET 站点，应该这样做：

[http://vbnet.mvps.org/index.html?code/internet/internetcheckconnection.htm](http://vbnet.mvps.org/index.html?code/internet/internetcheckconnection.htm)

# php - 为什么“今天”会在日期结束时返回额外的分钟数

> ID：15603691
> 
> 赞同：2
> 
> 时间：2013-03-24T20:36:44.700
> 
> 标签：php

我需要在 php 中获取给定日期的第一秒和最后一秒。当我使用这个时：

```
$date2 = strToTime('today');
echo Date('Y-m-d h:m:s', $date2) . "</br>"; 
```

我明白了`2013-03-24 12:03:00`。但是为什么要多出 3 分钟呢？应该说`12:00:00`。我需要一个即使在奇怪的闰年情况下也能每次都有效的解决方案，因为此代码将启动付款。

[http://ideone.com/H2JQ0D](http://ideone.com/H2JQ0D)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-24T20:43:12.343

In`PHP` `m`是几个月而不是几分钟

代替

```
echo Date('Y-m-d h:m:s', $date2)
                   ^--------------------- Months 
```

和

```
echo Date('Y-m-d h:i:s', $date2)
                   ^--------------------- Correct Value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:39:41.470

为什么不这样做：

```
$firstSecond = date('Y-m-d') . ' 00:00:00'; // first second of today
$lastSecond  = date('Y-m-d') . ' 23:59:59'; // last second of today 
```

改天

```
$time = strtotime('yesterday');
$firstSecond = date('Y-m-d', $time) . ' 00:00:00'; // first second of yesterday
$lastSecond  = date('Y-m-d', $time) . ' 23:59:59'; // last second of yesterday 
```

编辑：：

现在我想起来了。如果整个目的是查看记录是否在当天登陆，您可以轻松执行以下操作：

```
$recordTime = strtotime('2013-03-24 14:12:23');

if ($recordTime >= strtotime('today') && $recordTime < strtotime('tomorrow') {
    // ... do stuff
} 
```

# mysql - 从当前命中列表创建最后一个 url 列

> ID：15603692
> 
> 赞同：0
> 
> 时间：2013-03-24T20:36:49.010
> 
> 标签：mysql

我目前有以下列：

```
hit_id, visit_id, timestamp, page_url, page_next 
```

`hit_id`向上递增 `visit_id`是访问的 ID，每个访问者 `timestamp`都是唯一的，是命中的 unix 时间戳 `page_url`是正在查看 `page_next`的页面是下一个查看的页面

我想添加一个新列，`page_last`前一页 URL 将进入该列 - 我应该能够从`page_url`和中提取它`page_next`。我不知道为什么我一开始没有创建这个专栏，可能真的有点过分了。

反正有没有使用一些 MySQL 技巧来填充这个专栏？`page_last`在网站的初始点击中始终为空（不包含引荐网站）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T21:59:30.060

我觉得这个名字`page_last`模棱两可（它是指上一页吗？还是访问时的最后一页？）。建议你改成`page_prev`.

假设没有人在一次访问中多次访问同一页面，则以下内容接近于填写：

```
select h.*, hprev.page_url as page_prev
from hits h left outer join
     hits hprev
     on hprev.page_next = h.page_url and hprev.visit_id = h.visit_id 
```

如果这不是真的，那么您需要最新的。您可以使用相关子查询来获得它：

```
select h.*,
       (select h2.page_url
        from hits h2
        where h2.visit_id = h.visit_id and h2.page_next = h.page_url and
              h2.timestamp < h.timestamp
        order by timestamp desc
        limit 1
       ) as page_prev
from hits h 
```

在 MySQL 中进行更新有点棘手，因为您无法在更新中直接使用更新后的表。但是，以下技巧应该有效：

```
update hits
    set page_prev = (select page_url
                     from (select page_url
                           from hits h2
                           where h2.visit_id = hits.visit_id and
                                 h2.page_next = hits.page_url and
                                 h2.timestamp < hits.timestamp
                           order by timestamp desc
                           limit 1
                          ) h3
                    ) 
```

这个技巧之所以奏效，是因为 MySQL 实现了视图，因此它实际上创建了一个“临时表”，其中包含更新所需的信息。

# java - 在 actionPerformed 方法中引用 contentPane

> ID：15603693
> 
> 赞同：0
> 
> 时间：2013-03-24T20:36:57.490
> 
> 标签：java, swing, jpanel, grid-layout, border-layout

我正在创建一个加载按钮，并希望它填充嵌套在边框布局（主窗口）的 CENTER 面板内的 9x9 网格布局内容窗格。此方法位于边框布局的 PAGE_START 部分内。问题是如何从这里将按钮放置在 CENTER 部分的网格布局中？

```
 //Load Button
    JButton load = new JButton("Load");
    load.addActionListener(new ActionListener() { 
        @Override
        public void actionPerformed (ActionEvent a) {
            //Dialog Box To Locate The Puzzle
                SudokuPuzzle puzzle;
                JFileChooser chooser = new JFileChooser();
                FileNameExtensionFilter filter = new FileNameExtensionFilter(
                        "Text Files", "txt");
                chooser.setFileFilter(filter);
                int returnVal = chooser.showOpenDialog(SudukoGUI.this);
                if(returnVal == JFileChooser.APPROVE_OPTION) {
                    String fileLocation = chooser.getSelectedFile().getName();
                    Scanner file = new Scanner(fileLocation);
                    puzzle = new SudokuPuzzle(file, file);

                    //Load Puzzle To Model and draw it
                    try {
                        gridView = new JButton[9][9];
                        int[][] viewArray = puzzle.getArray();

                        for (int row = 0; row < 9; row++) {
                            for (int col = 0; col < 9; col++) {
                                gridView[row][col] = new JButton(String.valueOf(viewArray[row][col])); 

***************THE NEXT LINE REPRESENTS MY PROBLEM***************
                                this.getContentPane().board.add(gridView[row][col]);

                            }
                        } 
```

这是在构造函数中

```
 JPanel board = new JPanel();
    board.setLayout (new GridLayout (9,9));
    board.setPreferredSize(new Dimension(400,400));
    this.getContentPane().add(board, BorderLayout.CENTER); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:43:33.877

首先声明`board`为`final`变量使用：

```
final JPanel board = new JPanel(); 
```

这样`board`就可以从`ActionListener`. 此后，更改此行：

```
this.getContentPane().board.add(gridView[row][col]); 
```

至

```
board.add(gridView[row][col]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T21:08:17.577

这个

```
this.getContentPane().board.add(gridView[row][col]); 
```

没有任何意义。您在构造函数中添加`board`到内容窗格，但这并不意味着它`board`现在是内容窗格的一个字段。所以

```
getContentPane().board 
```

应该无法编译。

您可能应该`board`为您的类创建一个字段，而不是在构造函数中将其声明为局部变量。然后，您将能够在`board`整个班级中进行参考。

基本示例：

```
public class Example
{
    private JPanel board;

    public Example()
    {
         board = new JPanel();
         getContentPane().add(board);
         //assuming above code takes place in the constructor
         JButton load = new JButton("load");
         load.addActionListener(new ActionListener()
         {
              public void actionPerformed(ActionEvent e)
              {
                    ...lots of code
                    //as board is no longer a local variable this will compile
                    board.add(gridView[row][col]);
              }
         }
    }
} 
```

请注意，您可能希望`load`在某个时候添加到您的框架中。

# winforms - 通用表单打开器

> ID：15603694
> 
> 赞同：0
> 
> 时间：2013-03-24T20:37:12.387
> 
> 标签：winforms, generics, user-controls

我正在尝试创建一个新的用户控件作为通用查找表单打开器。

```
lkpControl.FormToOpen="FrmProductList";
lkpControl.ReturnValueVariableName="ProductCode";
lkpControl.ShowThatForm();
if dialog result is OK:
lkpControl.txtValue=lkpControl.GetSelectedValue(); 
```

此控件将从其名称打开预配置（或在设计时指定）表单，并将打开表单中的选定项目返回到其文本框。就像从文件夹浏览器对话框中获取路径一样。

只是一个通用的表单打开器和打开表单中选定项目的值获取器。

如果您能指导我找到任何解决方案或遵循的路径，我将不胜感激。

提前致谢

更新：我已经解决了这个问题：

```
public partial class LookupButton : UserControl
{
    [Description("Type of the Form To Open: typeof(LookupButtonTest.Form2)")]
    [Category("Custom")]
    public Type FormToOpen { get; set; }
    [Description("Name Of the public property to get return value from opened form.")]
    [Category("Custom")]
    public string PropertyToGet { get; set; }
    public LookupButton()
    {
        InitializeComponent();
    }

    private void btnOpenForm_Click(object sender, EventArgs e)
    {
        if (FormToOpen == null)
        {
            throw new ArgumentNullException("FormToOpen");
        }

        if (PropertyToGet.Length <= 0)
        {
            throw new ArgumentNullException("PropertyToGet");
        }

        Form objForm = (Form)Activator.CreateInstance(FormToOpen);

        if (objForm.ShowDialog() == DialogResult.OK)
        {
            bool propertyFound = false;
            PropertyInfo[] props = objForm.GetType().GetProperties(BindingFlags.Instance | BindingFlags.Public);
            foreach (PropertyInfo p in props)
            {
                if (p.Name == PropertyToGet)
                {
                    txtReturnVal.Text = p.GetValue(objForm, null).ToString();
                    propertyFound = true;
                }
            }
            if (!propertyFound)
            {
                throw new ArgumentNullException("PropertyToGet");
            }
        }   
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T21:27:09.217

像这样的东西：

```
public static class ShowFormAs
   {
       public static T1 ShowForm<T1>(string fullTypeName, string propertyName)
           where T1: class
       {
           return string.IsNullOrEmpty(fullTypeName) 
               ? default(T1) : 
               ShowForm<T1>(System.Reflection.Assembly.GetExecutingAssembly().CreateInstance(fullTypeName) as Form, propertyName);
       }

       public static T1 ShowForm<T, T1>(string propertyName)
           where T: Form, new ()
           where T1: class 
       {
           return ShowForm<T1>(new T(), propertyName);
       }

       private static T1 ShowForm<T1>(Form form, string propertyName)
           where T1: class 
       {
           if (form == null)
           {
               return default(T1);
           }

           if (form.ShowDialog() == DialogResult.OK)
           {
               var property = form.GetType().GetProperties().FirstOrDefault(o => string.CompareOrdinal(o.Name, propertyName) == 0);

               if (property == null)
               {
                   return default(T1);
               }

               return property.GetValue(form, null) as T1;
           }

           return default(T1);
       }
   } 
```

用法：

```
var x = ShowFormAs.ShowForm<Form2, string>("TTT");
var z = ShowFormAs.ShowForm<string>("StackOverflow.Form2", "TTT"); 
```

Form2 类是：

```
 namespace StackOverflow
    {
        public partial class Form2 : Form
        {
            public Form2()
            {
                InitializeComponent();
            }

            public string TTT { get { return "Ololo"; } }
        }
    } 
```

结果是：

![在此处输入图像描述](../Images/13ddd76b7cdc42ba67707961f02cf347.png)

# java - 在特定屏幕上启动程序

> ID：15603695
> 
> 赞同：0
> 
> 时间：2013-03-24T20:37:14.317
> 
> 标签：java

我正在制作一个对我个人来说非常有用的程序，并删除了许多让我烦恼的事情之一。:p 总而言之，我正在制作一个 Java 应用程序来注册一个全局键盘+鼠标运动监听器，当按下键盘上的某个键时，它会打开一个程序。我的java程序会做的是，在它直接进入程序打开它之前，java程序会拦截调用并说'在包含光标的屏幕上打开'。然后将继续启动程序，但使其在屏幕 1、2、3、4 等上打开。

我的问题是，我怎样才能让例如 google chrome 在屏幕 1、2、3、4 等上打开。java 可以吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:31:31.987

您可以使用 java Runtime 类。[这是一个示例](https://stackoverflow.com/questions/10800226/firing-command-using-java-runtime-class-on-a-windows-machine)也许您可以通过终端告诉您的操作系统您想要哪个屏幕。（在 linux DISPLAY 环境变量中。）

# .net - 无法将 DBNull 转换为字符串

> ID：15603697
> 
> 赞同：1
> 
> 时间：2013-03-24T20:37:17.413
> 
> 标签：.net, datareader

在我使用 Signalr 的 ASP.NET WEB API 应用程序中，我使用以下代码

```
 using (var reader = command.ExecuteReader())
                    return reader.Cast<IDataRecord>()
                        .Select(x => new CustomerInfo()
                        {
                            CustomerName = x.GetString(0),
                            CustomerAddress = x.GetString(1),

                        }).ToList(); 
```

当我在数据库中有 CustomerName 和 CustomerAddress 时，这工作正常。但是当我有任何一列NULL时它失败了。我得到低于运行时错误

```
Unable to cast object of type 'System.DBNull' to type 'System.String'. 
```

我该如何处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:43:44.237

您可以使用[as](https://stackoverflow.com/questions/3724051/what-is-difference-between-normal-typecasting-and-using-as-keyword/3724062)关键字来执行此操作：`x[0] as string`

```
using (var reader = command.ExecuteReader())
    return reader.Cast<IDataRecord>()
                 .Select(x => new CustomerInfo()
                 {
                     CustomerName = x[0] as string,
                     CustomerAddress = x[1] as string,    
                 }).ToList(); 
```

# oracle - ORACLE SQL：无法左连接 3 个表

> ID：15603702
> 
> 赞同：0
> 
> 时间：2013-03-24T20:38:08.843
> 
> 标签：oracle

如何使用左外连接连接 3 个表？我能够在 table1 和 table2 之间进行左外连接，但不能在 table3 之间进行。

我尝试了以下方法，但不知道如何加入 table3。

```
select tab1.id, tab2.status, tab3.job_history 
from table1 tab1 
left outer join table2 tab2 on tab1.id=tab2.id 
where tab1.job_title='accounting' 
```

我的表模式是：

```
table 1: 
  id           number(5) primary key,
  status_code  number(5),
  job_title    varchar2(20)
  name         varchar2(30)

table 2:
   status_code  number(5) primary key,
   status       varchar2(15)

table 3:
  id           number(5)
  job_history  varchar2(20) 
```

条件：

*   `table1.status_code`可`null`
*   `table1.id`可能没有任何匹配项`table3.id`

我想在 table1 中找到具有`table1.job_title = 'accounting'`或在 table3 中具有`table3.job_history = 'accounting'`when的记录，`table1.id = table3.id`并通过以下方式获取 table2 状态`table1.status_code = table2.status_code`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:42:22.103

由于您在所有表上都没有相同的字段，为了匹配您的条件，您可能会找到更简单的方法来运行连接，例如：

```
 select 
      tab1.id, 
      tab2.status, 
      tab3.job_history 
    from 
      table1 tab1,    
      table2 tab2,
      table3 tab3
    where 
      tab1.job_title='accounting'
      --ADD ADITIONAL FILTERING HERE 
```

对 3 个表进行连接的查询如下所示：

```
select 
  tab1.id, 
  tab2.status, 
  tab3.job_history 
from 
  table1 tab1 
left outer join 
  table2 tab2 on tab1.id=tab2.id 
left outer join  
   table3 tab3 on tab3.id = tab1.id
where 
  tab1.job_title='accounting' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:46:10.253

该SQL假设表1、表2和表3之间存在一对一的关系

```
select tab1.id, tab2.status, tab3.job_history 
from table1 tab1 
left outer join table2 tab2 on tab2.status_code = tab1.status_code 
left outer join table3 tab3 on tab3.id = tab1.id 
where tab1.job_title = 'accounting' or tab3.job_history = 'accounting' 
```

表 3 看起来包含某种形式的工作历史记录，因此对于表 1 中的每条记录，表 3 中可能会有多个记录。如果是这种情况，您将需要执行子查询来查找所有目前或以前拥有会计职称的人，即

```
select tab1.id, tab2.status, tab1.job_title 
from table1 tab1 
left outer join table2 tab2 on tab2.status_code = tab1.status_code 
where tab1.job_title = 'accounting' or 
      tab1.id in (select id from tab3 where job_history = 'accounting') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T20:47:03.033

我怀疑您想加入`table2`on`table1`而`status_code`不是`id`，因为*中没有*ID 列`table2`。要加入第三个表，只需添加另一个`LEFT OUTER JOIN`（或任何其他`JOIN`）。

```
select 
  tab1.id, 
  tab2.status, 
  tab3.job_history 
from 
  table1 tab1 
left outer join 
  table2 tab2 on tab2.status_code = tab1.status_code
left outer join
  table3 tab3 on tab3.id = tab1.id 
where 
  tab1.job_title='accounting' or tab3.job_history = 'accounting' 
```

# android - 内容提供者不删除行

> ID：15603708
> 
> 赞同：0
> 
> 时间：2013-03-24T20:38:24.497
> 
> 标签：android, android-contentprovider

奇怪的是我的内容提供商没有删除我要求的行。据我所知，它应该可以工作，但我不明白为什么它不可以。

**这是我的提供程序中的删除方法：**

```
@Override
public int delete(Uri uri, String selection, String[] selectionArgs) {
    SQLiteDatabase db = helper.getWritableDatabase();

    switch (uriMatcher.match(uri)) {
    case SINGLE_ROW:
        String rowID = uri.getPathSegments().get(1);

        selection = KEY_ROWID
                + "="
                + rowID
                + (!TextUtils.isEmpty(selection) ? " AND (" + selection
                        + ')' : "");
        Log.i("Selection", "" +  selection);
        break;
    case ALLROWS:
        Log.i("Deleted", "All rows");
        break;

    default:
        Log.i("Switch case", "default value");
        break;
    }

    if (selection == null) {
        selection = "1";
    }

    int deleteCount = db.delete(helper.DATABASE_TABLE, selection,
            selectionArgs);
    Log.i("Deleted rows",
            "" + db.delete(helper.DATABASE_TABLE, selection, selectionArgs));
    getContext().getContentResolver().notifyChange(uri, null);

    return deleteCount;
} 
```

这是日志输出，表明没有删除任何行，这对我来说毫无意义。谁能帮忙？

```
03-24 22:36:34.809: I/Selection(27648): _id=2
**03-24 22:36:34.809: I/Deleted rows(27648): 0**
03-24 22:36:34.814: I/Delete Uri(27648): content://com.shifts.provider/shiftsTEST/2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T11:30:58.560

我自己发现了这个问题 - 我已经重构了这样的方法：

```
@Override
public int delete(Uri uri, String selection, String[] selectionArgs) {
    SQLiteDatabase db = helper.getWritableDatabase();

    int deleteCount = db.delete(helper.DATABASE_TABLE, KEY_ID + "="
            + Integer.valueOf(selection), null);
    Log.i("Selection", "" + selection);

    getContext().getContentResolver().notifyChange(uri, null);

    return deleteCount;
} 
```

# javascript - 后端处理与 phantomjs/nodejs 之间的性能差异

> ID：15603713
> 
> 赞同：0
> 
> 时间：2013-03-24T20:39:05.857
> 
> 标签：javascript, highcharts, report, server-side, phantomjs

我目前正在开发一个服务器端应用程序，显示图表、统计数据、报告等。

该应用程序使用基于 JavaScript 的 Highsoft（真棒工具！）的 Highchart 库（图表生成库）。

如果我要在前端创建图表，使用 highchart 很酷。但是当我要在后端（服务器端）创建图表并生成报告时，问题..或考虑出现了。

由于 Javscript 的性质，它是为前端（Web）设计的，如果我要在后端使用它们，我必须使用 phantomjs/nodejs。

但是，如果我要在服务器端语言（例如 PHP）中做同样的工作，我确信它可以更快地处理/创建图表。（使用不同的图表库）

我也很难完全依赖使用 phantomjs/nodejs 的稳定性。（我已经看到并遇到了运行 nodejs 的一些问题）

所以我想问人们的问题是，假设他们在指标方面执行相同的计算/计算任务，那么“后端处理与 phantomjs/nodejs 之间的性能差异”是什么。（例如，通过 phantomjs 执行相同任务，php 大约比 javascript 快 3 倍。）

由于我是一名新手开发人员，在我决定在实施它们之前选择哪种语言之前，我需要很多建议或建议。

如果有人已经做过，请分享知识。这将不胜感激！

感谢您的阅读。

-丹尼·C

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:49:15.450

报告的本质是它们需要呈现正确的数据，而交互性部分不太重要，甚至是不可能的。

*   如果您将报告生成为用户导航到的专用 URL，请使用您在前端使用的相同图表

*   如果您正在生成 PDF/Email 报告，请选择稳定且（如果需要）可扩展的服务器端解决方案、用于 PHP 的 pChart 或其他一些稳定且有据可查的解决方案

请记住，人们习惯于认为报告上的图表看起来与应用程序/前端中的图表不同，所以不要太担心自己，找到稳定的东西，构建有据可查和可维护的系统。

+ 如果您使用某种 Api/Data 提供程序层，则可以加分，这样您就可以将它用于报告和前端，并在任何时候切换实现。

# java - 带注释的休眠映射 id/长外键到可为空的列

> ID：15603717
> 
> 赞同：2
> 
> 时间：2013-03-24T20:39:36.407
> 
> 标签：java, hibernate, null, annotations, foreign-keys

我有以下类映射 MySQL 表：

```
@Entity
@Table(name = "category")
public class Category {

    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    @Column(name = "id")
    private long id;

    @Column(name = "parent_id")
    private long parentId; 
```

并且在处理具有 NULL 列值的`parent_id`列时出现以下错误：

`INFO: HHH000327: Error performing load command : org.hibernate.PropertyAccessException: Null value was assigned to a property of primitive type setter of com.blogspot.symfonyworld.wealthylaughingduck.model.Category.parentId`

这只是一个 java 错误：NULL 不能分配给`long`类型 ( `private long parentId`)。我找不到任何提示如何克服这个问题，我只能想到`long`用`Long`. 这是一个好主意，还是有一些内置的休眠注释或任何机制来做这些特定的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-24T20:42:46.263

您将类属性定义为原始（长），但您的数据库表包含相应列的空值。提供者 (Hibernate) 不会将 null 映射到原语，因为映射是不明确的。

如果您的数据可能包含空值，您需要使用等效的包装类（在本例中为 Long）。

```
@Entity
@Table(name = "category")
public class Category {
    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    @Column(name = "id")
    private long id;

    @Column(name = "parent_id")
    private Long parentId;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:57:52.377

如果`parentId`可以为空并且您需要将其映射为字段，则需要使用包装类。

但是，如果（正如我从文件名中怀疑的那样）您将外键显式映射为字段，那么您可能会错过 ORM 在[映射关联](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html/entity.html#entity-mapping-association)方面的一些真正优势。

# .htaccess - .htaccess 不工作，我做错了什么？

> ID：15603723
> 
> 赞同：0
> 
> 时间：2013-03-24T20:39:50.410
> 
> 标签：.htaccess

所以我有一个 .htaccess 文件，里面有这个：

```
SetEnv APPLICATION_ENV development

RewriteEngine On
RewriteRule ^/path/to/app/(.*)$ /path/to/app/public/$1 [NC,L] 
```

当我在浏览器中转到 /path/to/app/ 时，它会显示目录结构，而不是将服务器重定向到 /path/to/app/public/$1

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T11:09:41.110

问题是这一行：

```
RewriteRule ^/path/to/app/(.*)$ /path/to/app/public/$1 [NC,L] 
```

**请记住：**重写与前导斜杠不匹配。将您的规则更改为：

```
RewriteEngine On
RewriteBase /
RewriteRule ^(path/to/app)/(.*)$ /$1/public/$2 [NC,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:45:49.507

我认为您尝试构建 Symfony 应用程序？要重写规则，您需要在 httpd.conf 中允许覆盖

```
 DocumentRoot "/var/www/symfony/web"

 <Directory "/var/www/symfony/web">
  allow from all
  AllowOverride All  <-------------
  Options +Indexes
 </Directory> 
```

如果你使用指令

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d 
```

这意味着`if`目录存在`then`显示结构`else`使用其他 RewriteRule

也试试

```
RewriteRule ^/path/to/app/(.*)$ /path/to/app/public/$1 [QSA,L] 
```

# objective-c - NSDate 的时间格式

> ID：15603730
> 
> 赞同：0
> 
> 时间：2013-03-24T20:40:25.960
> 
> 标签：objective-c, cocoa-touch

我有从 Web 服务进入我的应用程序的日期时间值。格式如下：

`2013-03-24T09:45:00.000-04:00`

我只需要这个值的时间。我正在使用`NSDateFormatter`并设置日期格式如下：

```
[df setDateFormat:@"HH:mm:ss"]; 
```

当我这样做时，我得到一个相当神秘的运行时错误。但是，当我使用以下内容时，我没有错误（尽管它不满足我的要求）：

```
[df setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss.sssz"]; 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:45:37.840

尝试这个

```
NSString *originalDateString = @"2013-03-24T09:45:00.000-04:00";
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss.sssz"];
NSDate *date  = [dateFormatter dateFromString:originalDateString];

[dateFormatter setDateFormat:@"HH:mm:ss"];
NSString *newDateString = [dateFormatter stringFromDate:date]; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-24T20:56:05.203

也许如果您使用日期格式化程序来检索 NSDate 实例并从那里进行格式化。

```
NSSTring *dateString = "2013-03-24T09:45:00.000-04:00";
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
NSDate *dateFromWebApp = [dateFormatter dateFromString:dateString]; 
```

尚未测试，但它应该可以工作。

干杯

# php - __construct 上的语法错误，如果我使用 ClassName 作为构造函数签名，则有效

> ID：15603734
> 
> 赞同：3
> 
> 时间：2013-03-24T20:40:48.587
> 
> 标签：php, constructor, syntax-error

当我创建这个类的实例时，我得到了错误

```
Parse error: syntax error, unexpected '__construct' (T_STRING), 
expecting variable    (T_VARIABLE) on line 9\. 
```

这就是我创建实例的方式：

```
 function controller_from_str($controller_name)
    {
        $controllers_namespace = 'MVCBP\\Controllers\\';
        $controller = $controllers_namespace 
            . $controller_name . 'Controller';

        return new $controller();
    } 
```

如果我更改`__construct()`为`UserController()`. 我在 Windows 7 上使用 PHP 5.4。这是预期的行为吗？

这是我的课：

```
<?php
namespace MVCBP\Controllers;

use MVCBP\Core as Core;
use MVCBP\Models as Models;
use MVCBP\Repositories as Repos;

class UserController implements Core\ControllerInterface
{
    private $UserRepo;

    public function __construct()
    {
        $this->UserRepo = new Repos\UserRepository();
    }

    public function Index()
    {
        echo '<h1>User</h1>';
    }

    public function Create()
    {
        //TODO: if GET/POST
        $user = new Models\User();
        /*var_dump($user->getDb());*/
        render_view('User/Create');
    }

    private function CreateGet()
    {

    }

    private function CreatePost()
    {

    }
} 
```

# javascript - 为什么在加载 jQuery 时 $ 未定义？

> ID：15603736
> 
> 赞同：0
> 
> 时间：2013-03-24T20:40:59.100
> 
> 标签：javascript, jquery

我在页面的开头有这个：

```
<script type="text/javascript" src="scripts/jquery-1.9.1.js"></script>
<script type="text/javascript">
    $(function () {
        $("#ListBoxSegment").change(function () {
            GetAccountOpportunityTypes($(this).val());
        });
        $("#ListBoxType").change(function () {
            GetNumberOfContacts();
        });
    }); 
```

运行该页面会出现此错误：

```
0x800a1391 - Microsoft JScript runtime error: '$' is undefined 
```

为什么在上面的行中加载 jQuery 时 $ 未定义？

通过从 URL 加载已修复：

```
 <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script> 
```

但仍然有点奇怪，它不会从本地加载。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-24T20:42:48.593

问题很可能是没有加载 jQuery。检查浏览器工具的网络选项卡，查看 jQuery JavaScript 文件中是否有 404 或其他内容。否则，这不会发生。

此外，考虑从 CDN 加载 jQuery 以利用站点之间发生的缓存：

```
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-24T12:34:37.670

我使用的是 IE，我遇到了同样的问题。对我来说，当我清除浏览器选项中的缓存和 cookie 时，它​​已修复。

# javascript - Knockout Mapping Observable 没有被“观察到”？

> ID：15603739
> 
> 赞同：0
> 
> 时间：2013-03-24T20:41:10.670
> 
> 标签：javascript, mvvm, knockout.js

这是我的小提琴：

[http://jsfiddle.net/PTSkR/8/](http://jsfiddle.net/PTSkR/8/)

如果单击文本，我正在尝试使侧面可编辑。我正在从淘汰赛网站关注这个例子：

看法：

```
<p>
    Name: 
    <b data-bind="visible: !editing(), text: name, click: edit">&nbsp;</b>
    <input data-bind="visible: editing, value: name, hasfocus: editing" />
</p>
<p><em>Click the name to edit it; click elsewhere to apply changes.</em></p> 
```

脚本：

```
function PersonViewModel(name) {
    // Data
    this.name = ko.observable(name);
    this.editing = ko.observable(false);

    // Behaviors
    this.edit = function() { this.editing(true) }
}

ko.applyBindings(new PersonViewModel("Bert Bertington")); 
```

[http://knockoutjs.com/documentation/hasfocus-binding.html](http://knockoutjs.com/documentation/hasfocus-binding.html)

当我点击“边”的文本时，我点击了“编辑”功能，但 div 的可见性并没有改变。我认为这是一个范围界定问题，但我不知道如何解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T22:14:54.197

问题是`hasfocus`绑定也与`editable`可观察对象相关联。删除此绑定会导致可见性更新得很好。我猜这意味着 Knockout 试图设置焦点并失败，因此设置`editable`回 false。

也许您可以不使用该绑定，而是将`blur`事件处理程序附加到输入，在该处理程序中您将设置`editable`为 false。

# iphone - UITableView 单元格提供错误信息

> ID：15603740
> 
> 赞同：0
> 
> 时间：2013-03-24T20:41:11.520
> 
> 标签：iphone, ios, uitableview, core-data

我用核心数据中的数据加载了一个表格视图。它加载了文本。每个单元格上都有一个 uiimageview。当表格调用`cellForRow:`它时，要么将图像设置为隐藏，要么不隐藏（取决于核心数据所说的应该是什么。）

代码：

```
-(UITableViewCell *) tableView:(UITableView *)tableView cellForRowAtIndexPath:
(NSIndexPath *)indexPath{

static NSString * identifier = @"identifier";

self.cell = [tableView dequeueReusableCellWithIdentifier:identifier];

HuntingRifleGuns *handguns = [self.tableArray objectAtIndex:indexPath.row];

NSString *brandModel = [[handguns.brand stringByAppendingString:@" "] stringByAppendingString:handguns.model];

self.cell.mainLabel.text = brandModel;

self.cell.nicknameLabel.text = handguns.nickname;
//Right below me, is where is set the imageView to hidden, or not hidden. 
self.cell.alert.hidden = handguns.showBadge.boolValue;

self.cell.alert.image = [UIImage imageNamed:@"tvicon.png"];

return self.cell;
} 
```

我的问题是：如果我在表格视图上有 1 个单元格，它工作得很好，但如果我在表格上有超过 1 个单元格，它就会起作用。

我想检查单元格的图像在被删除时是否隐藏：

```
-(void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {

if (editingStyle == UITableViewCellEditingStyleDelete) {        

    if (!self.cell.alert.isHidden) {

        NSLog(@"showing");

    }
 else{

NSLog(@"Not showing");
}
     ......... 
```

但是当它测试时，它并不总是做正确的事情。它只是打印出来`showing`或`not showing`随机打印出来。而且我知道它是否应该显示，因为它在单元格上显示图像。这可能是什么原因？只是一个侧面说明，用户可以将图像设置为隐藏或不隐藏在不同的视图中，但 tableview 总是显示正确的数据，这意味着它显示图像正确可见或隐藏，只是当我测试它时，它并不总是工作。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:57:33.513

您创建了一个`@property`名为`cell`. 那是行不通的。

您应该只使用一个`UITableViewCell`变量或一个与您的自定义单元格：

```
CustomCell *cell = [tableView dequeue...]; 
```

此外，您对字符串的处理不是非常有效的内存。改用`stringWithFormat`：

```
cell.mainLabel.text = [NSString stringWithFormat:@"%@ %@",
       handguns.brands, handguns.model]; 
```

此外，检查视图是否隐藏以通知您的应用程序逻辑是非常糟糕的做法。相反，您应该有一个健壮的数据模型并改为查询数据模型。在您的情况下，您应该查询适当的`handguns`对象是否有图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T21:06:46.703

奇怪的是，您将出队的单元格分配给`self`. 这几乎肯定不会是您认为的那样，因为单元格是以`-tableView:cellForRowAtIndexPath:`不确定的方式请求的。您应该将出队的单元格分配给具有本地范围的变量。使用 的参数`-tableView:commitEditingStyle:forRowAtIndexPath:`检索要处理的单元格。例如：

```
-(void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {
  if (editingStyle == UITableViewCellEditingStyleDelete) {
    UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
    if ([[[cell textLabel] text] isEqualToString:@"foo"]) {
      NSLog(@"showing");
    } else{
      NSLog(@"Not showing");
    }
  }
} 
```

此外，在调试这样的问题时，将问题简化为仍然导致问题的最简单的事情通常很有用。如果不是使用自定义单元格或您在那里进行的任何操作，而是使用具有`UITableViewCell`默认外观的简单单元格，会发生什么情况。而不是隐藏或显示您添加到单元格的图像视图，您只需将其默认文本更改为“foo”或“bar”或类似的东西？如果您仍然遇到问题，那么您的代码将在这里更简单且易于解释。如果您不再遇到问题，您可以一次添加一个自定义内容，直到找到破坏内容的修改。

# php - 使用 php exec 安装 nodejs

> ID：15603741
> 
> 赞同：-1
> 
> 时间：2013-03-24T20:41:20.090
> 
> 标签：php, node.js, ftp

我刚买了一个有空间的域，但我的提供商不支持 nodejs。我搜索了很多，如何在服务器上构建它，但是当然，要制作，我需要如此特权，所以现在我被困在这里。

我如何使用 nodejs（或其他服务器端 Javascript 引擎）来运行 javascript？

我可以通过 FTP 访问服务器，但仅此而已。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:43:02.673

我相信你做不到。如果您的提供者没有授予这样做的权限，您将被卡住:(

# iphone - 为什么 indexPathForItemAtPoint 总是返回 nil

> ID：15603743
> 
> 赞同：5
> 
> 时间：2013-03-24T20:41:24.017
> 
> 标签：iphone, ios, uicollectionview, flowlayout

我有一个`UICollectionView`包含在一个`UIViewController`使用水平的`UICollectionViewFlowLayout`. 我还使用在我的`UIStoryboard`. 我想创建一个自定义分页，所以我使用`- (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset`.

问题是每次我试图获取`indexPath`与 targetContentOffset 对应的（滚动视图中滚动停止的点）时，即使该点明显位于集合视图 contentSize 内，集合视图也会返回 nil。

```
- (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset
{
    NSIndexPath *indexPath = [_collectionView indexPathForItemAtPoint:(*targetContentOffset)];
    // Do something with indexPath    
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-28T21:46:50.147

collectionView 还不知道 targetContentOffset 的 indexPath。

您必须要求 collectionViewLayout 为您提供将在此位置布局的项目的属性。

尝试这样的事情：

```
UICollectionViewLayoutAttributes *attribute = [_collectionView.collectionViewLayout layoutAttributesForElementsInRect:(CGRect){(*targetContentOffset).x, 0, 10, self.collectionView.bounds.size.height}][0]; 
```

# python - 绿线和芹菜

> ID：15603755
> 
> 赞同：1
> 
> 时间：2013-03-24T20:42:51.220
> 
> 标签：python, multithreading, celery

我是绿色线程概念的新手。我有一个使用 Celery 一次派遣数十名工人的系统

这些线程有时会在 CPU 方面努力工作，处理数字，有时会等待 url 请求。

例如，有没有办法让芹菜产生“绿色线程”以更好地利用 CPU？还是我必须以某种方式将“绿色”线程合并到我的工作代码中？

# c# - 使用 SendKeys 最大化浏览器窗口

> ID：15603757
> 
> 赞同：0
> 
> 时间：2013-03-24T20:43:01.083
> 
> 标签：c#, keyboard-shortcuts

如何使用**Sendkeys.Send()**最大化浏览器窗口？
我试过了，`System.Windows.Forms.SendKeys.Send("% (x)")`但它像**Ctrl+Space**一样工作，而不是**Ctrl+Space+X**。有什么建议么？

# jquery - 如何防止响应式导航上的悬停触发

> ID：15603760
> 
> 赞同：0
> 
> 时间：2013-03-24T20:43:17.893
> 
> 标签：jquery, navigation

我正在构建响应式导航，但遇到了问题。导航的本质在于它是响应式的，因此您单击“三行”按钮，菜单就会在页面中弹出。菜单支持嵌套 <ul>，因此在菜单内，您也可以单击框（右侧）打开嵌套菜单。现在，我的问题是我只想在单击时打开导航，而不是悬停。

*在本质上：*

*   主导航（桌面）：将鼠标悬停在 <li> 以打开子 <ul>
*   当在一定宽度下（媒体查询）隐藏它显示一个黑框可以点击，你可以点击下一个框打开<ul>

一切正常，但是打开*桌面*导航的悬停事件显然会触发导航在响应视图中打开。我怎样才能防止这种情况？

这里是导航的JSFiddle，请点击黑框：[http ://bit.ly/ZZJcYk](http://bit.ly/ZZJcYk)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:56:35.197

我推荐的一种方法是使用： http: [//modernizr.com/](http://modernizr.com/)

在开发响应式网站/应用程序时，它将以许多其他方式帮助您。

通过包含它，您将获得（除其他外）您的 HTML 节点的类。

如果用户在触摸设备上，它将是 .touch 类，如果不是，则为 .no-touch。

要使用此功能，您将对代码执行以下操作：

```
$('.no-touch .nav').on({
        mouseenter: function () {
            $(this).children('.nav-submenu').toggle();
        },
        mouseleave: function () {
            $(this).children('.nav-submenu').toggle();
        }
    }, '.nav-item'); 
```

这`$('.no-touch .nav')`将确保此代码仅在非触摸设备（例如桌面）上执行。还有其他解决方案，但从长远来看，我强烈推荐使用modernizr。

# jquery - jQuery图像淡入准备就绪

> ID：15603764
> 
> 赞同：0
> 
> 时间：2013-03-24T20:43:26.627
> 
> 标签：jquery, image

我目前正在处理一个包含一些非常大的图像的项目。为了在加载图像时产生平滑的淡入效果，我尝试在 jQuery 1.9.1 中使用 ready()，但由于某种原因，它不起作用并在加载之前显示图像。

```
$("img").ready(function(){
$(this).fadeIn("slow");
}); 
```

我究竟做错了什么？

**编辑：** 谢谢！我用 Adeneo 的方法让它工作：http: [//jsfiddle.net/hAm65/](http://jsfiddle.net/hAm65/ "jsFiddle")

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:45:00.167

从[DOCS](http://api.jquery.com/ready/)中，只有文档具有就绪事件：

> .ready() 方法只能在匹配当前文档的 jQuery 对象上调用。

您可以尝试更多类似的方法：

```
$("img").each(function(i,el){
    var img = new Image();
        img.onload = function() {
            $(el).fadeIn("slow");
        }
        img.src = el.src;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-24T20:46:05.840

你不能调用自身`.ready`以外的元素`document`。改用这个

```
$("img").on('load', function(){
  $(this).fadeIn("slow");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-24T21:01:22.923

如果要加载多个图像并且需要等待所有图像完成，请尝试使用 jQuery[延迟](http://api.jquery.com/category/deferred-object/)对象：

```
function loadImages(src) {
    var deferred = $.Deferred();
    var image = new Image();
    image.onload = function() {
        deferred.resolve();
    };
    image.src = src;
    return deferred.promise();
} 
```

以这种方式使用它 -

```
var loaders = [];
loaders.push(loadImage('1.png'));
loaders.push(loadImage('2.png'));
loaders.push(loadImage('3.png'));
$.when.apply(null, loaders).done(function() {
    // callback when everything was loaded
}); 
```

# java - 为什么这会返回 null？

> ID：15603773
> 
> 赞同：0
> 
> 时间：2013-03-24T20:43:53.227
> 
> 标签：java, hibernate

我成功发送了日期值。我从“作用域变量”中检查过。

这是我的 bean 中的一个函数，它调用助手中的一个函数：

```
public DataModel getFt() {
    ftDataModel = new ListDataModel((List) fthelper.getByBeginDate(beginDate));
    return ftDataModel;
} 
```

这是发送`beginDate`到 Hibernate 的函数。但在这里它返回null。为什么？

```
public FinancialTransactions getByBeginDate(String beginDate){            
    List<FinancialTransactions> FtList = null;        
    try {
        org.hibernate.Transaction tx = session.beginTransaction();
        Query q = session.createQuery("from FinancialTransactions where DATE='" + beginDate + "'");
        FtList = (List<FinancialTransactions>) q.list();

    } catch (Exception e) {
        e.printStackTrace();
    }
    return FtList.get(0);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T20:58:37.253

您应该在查询中使用参数：

```
Query q = session.createQuery("from FinancialTransactions where DATE=:date").setParameter("date",beginDate); 
```

应该没有内部异常，否则 FtList.get(0) 也会导致异常。

我的猜测是格式化。您使用日期的字符串表示。总是一个坏主意，因为在转换中有很多事情可能会出错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:51:53.760

其中之一：

```
org.hibernate.Transaction tx = session.beginTransaction();
Query q = session.createQuery("from FinancialTransactions where DATE='" + beginDate + "'"); 
```

抛出异常。使用调试器或简单的 System.out... 来查找这两者中的哪一个。

# sapi - 在 Microsoft SAPI 5.4 Api 中使用 wav 文件输入时没有输出

> ID：15603775
> 
> 赞同：1
> 
> 时间：2013-03-24T20:44:15.007
> 
> 标签：sapi

我正在做一个项目，我需要使用语音识别将 wav 文件输入语音（对话）转换为文本。在尝试 CMUSPhinx 一段时间后，结果很糟糕，我正在考虑使用 Microsoft SAPI (Speech API) 5.4

我正在编写 Visual Studio 中的 Visual Basic Windows 应用程序。这是我的代码片段：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    '   Dim SAPI
    '   SAPI = CreateObject("sapi.spvoice")
    '   SAPI.Speak(TextBox1.Text)

    ' Create new recognizer
    Dim Recognizer As New SpInprocRecognizer

    ' create input file stream
    InputFile = New SpFileStream
    ' Defaults to open for read-only, and DoEvents false
    InputFile.Open(MY_WAVE_AUDIO_FILENAME)

    ' connect wav audio input to speech recognition engine
    Recognizer.AudioInputStream = InputFile

    ' create recognition context
    RecoContext = Recognizer.CreateRecoContext

    '  AddHandler RecoContext.Recognition, AddressOf RecoContext_Recognition

    ' create grammar
    Grammar = RecoContext.CreateGrammar
    ' ... and load dictation
    Grammar.DictationLoad()
    ' start dictating
    Grammar.DictationSetState(SGDSActive)
End Sub 
```

在 MY_WAVE_AUDIO_FILENAME 中，我给出了带有完整路径的文件名。当我单击按钮运行此代码时，我没有得到任何输出。我使用了以下识别方法：

```
 Private Sub RecoContext_Recognition(ByVal StreamNumber As Long, ByVal StreamPosition As Object, ByVal RecognitionType As SpeechRecognitionType, ByVal Result As ISpeechRecoResult)
        ' Log/Report recognized phrase/information
        Console.WriteLine("Reached here......")
        TextBox1.Text = "Text should change"
    End Sub 
```

当我调试应用程序时，流程没有达到 RecoContext_Recognition 方法。输入文件是一个 wav 文件，每个样本 16 位，30 秒长的对话。

我正在使用此链接中提到的代码：http: [//msdn.microsoft.com/en-us/library/ee431813 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ee431813(v=vs.85).aspx)

我如何检查问题？我在某处读到需要对语音识别引擎进行听写训练，如果在我的情况下也需要，那么我该怎么做？同样在链接中提到我们需要指定输入文件的长度才能做到这一点，我也不确定如何做到这一点。需要帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T00:28:13.487

示例代码缺少一些需要解决的步骤。

1) Inproc 识别器在进行任何识别之前需要[绑定一个引擎；](http://blogs.msdn.com/b/tsfaware/archive/2010/03/01/specifying-parameters-for-an-inproc-recognizer.aspx)

2)在开始处理音频之前，需要将 inproc 识别器[设置为活动状态。](http://msdn.microsoft.com/en-us/library/ee413284%28v=VS.85%29.aspx)

您还应该考虑为其他事件添加处理程序，特别是 SPEI_START_SR_STREAM、SPEI_SOUND_START、SPEI_SOUND_END 和 SPEI_PHRASE_START，以验证 SR 引擎是否正在处理音频并且它正在尝试进行一些识别。

# delphi - 如何更改 TEdit 组件的突出显示颜色？

> ID：15603781
> 
> 赞同：1
> 
> 时间：2013-03-24T20:44:54.297
> 
> 标签：delphi, delphi-2007

I need to tweak the appareance of a TEdit component, But i'm failing to find a solution to change the highlight color and font color of a TEdit component when the text is selected (highlighted) , exist any WinApi message or function to change the突出颜色？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-25T06:50:47.023

组件的绘制在`WM_PAINT`消息内完成。在您应该在调用标准之前`WndProc`将所需的颜色设置为，并在调用后将其重置为默认值。我认为这是最简单的解决方案。`clHighlightText``WndProc`

# java - 更改网站 Jsoup 在 if 语句中解析

> ID：15603784
> 
> 赞同：0
> 
> 时间：2013-03-24T20:45:09.090
> 
> 标签：java, android, jsoup

全部 - 我正在解析来自 21 个不同地址的数据，具体取决于用户在微调器中选择的内容。例如，如果用户选择“Eldora”，它应该解析的网站是[http://www.coloradoski.com/resorts/eldora](http://www.coloradoski.com/resorts/eldora)。但是如果他们选择“Copper”应该从[http://www.coloradoski.com/resorts/copper](http://www.coloradoski.com/resorts/copper)解析。问题是，只有地址发生了变化，而不是实际的标签。因此，我可以将所有内容复制到 21 个不同的类中并更改地址，但似乎应该有一种方法可以根据用户选择而不是实际标签来更改地址。这是我的代码：

```
class AddStringTask extends AsyncTask<Void, String, Void> {  
    ProgressDialog progressDialog;
    @Override
    protected void onPreExecute()
    {
        progressDialog= ProgressDialog.show(MainActivity.this, "Loading Data","Getting from http://eldora.com/", true);

        //do initialization of required objects objects here                
    };      
    @Override
    protected Void doInBackground(Void... unused) {
        org.jsoup.nodes.Document doc = null;
        try {
            doc = Jsoup.connect("http://www.coloradoski.com/resorts/eldora").get();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        docTitle = doc.select("div#column-narrow.grid_310.alpha h1").first().text();
        AnnualSnowfallString = doc.select("dl#mountain-stats dt + dd").first().text();

        AreaString = doc.select("dl#mountain-stats dt + dd + dt + dd ").first().text();
        BaseElevationString = doc.select("dl#mountain-stats dt + dd +dt + dd + dt + dd").first().text();
        SummitElevationString = doc.select("dl#mountain-stats dt + dd + dt + dd + dt + dd + dt + dd").first().text();
        HoursofOperationString = doc.select("dl#mountain-stats dt + dd + dt + dd + dt + dd + dt + dd + dt + dd").first().text();
        SeasonDatesString = doc.select("dl#mountain-stats dt + dd + dt + dd + dt + dd + dt + dd + dt + dd + dt + dd").first().text();
        NotesString = doc.select("dl#mountain-stats dt + dd + dt + dd + dt + dd + dt + dd + dt + dd + dt + dd + dt + dd").first().text();
        return null;        
    } 
```

`dl#mountain-stats dt + dd + dt + dd`不会因站点而异，只是地址。关于如何仅根据用户选择进行更改的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T22:29:55.157

您可以将参数发送到您的`AsyncTask`. 改变你的：

```
class AddStringTask extends AsyncTask<Void, String, Void> { 
```

至

```
class AddStringTask extends AsyncTask<String, String, Void> { 
```

现在你可以像这样向你`AsyncTask`的`doInBackground()`函数发送参数：

```
new AddStringTask().execute(STRING_THAT_USER_SELECTED) 
```

在你的`doInBackground()`函数中，你可以得到传递的字符串

```
String passedString = unused[0] 
```

在您的`progressDialog`变量下，定义另一个变量，例如`String url`：

```
class AddStringTask extends AsyncTask<String, String, Void> {  
ProgressDialog progressDialog;
String url ="http://www.coloradoski.com/resorts/"; 
```

在将传递的字符串传递给异步任务后，将传递的字符串附加到`url`并调用`Jsoup's connect()`函数。

```
 doc = Jsoup.connect(url+passedString).get(); 
```

希望这可以帮助

# javascript - 如何从文本块中的跨度展开文本？

> ID：15603786
> 
> 赞同：1
> 
> 时间：2013-03-24T20:45:27.093
> 
> 标签：javascript

所以我有大块`<div>`的文字。单词用户双击正在包装`<span>`元素我如何删除该跨度元素并将单词返回到它的正常位置，没有跨度包装它，所以整个文本将返回到起始位置？

编辑：对不起我的缺席。这是双击函数的代码它包装了div，用户在span中双击，然后将类添加到该span。长得像这样！

```
function onDoubleClick(){
    var selection=window.getSelection().getRangeAt(0);
    var selectedText=selection.extractContents();
    var span=document.createElement("span");
    epic.get(span).addClass('highlightedText');
    span.appendChild(selectedText);
    selection.insertNode(span);
} 
```

![在此处输入图像描述](../Images/5200077f53040872d04258c84d242496.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:51:20.447

这可能是您想要的，但我希望评论中有邪恶的“HTML 中的正则表达式”链接：P。它还取决于是否`<div>`只有文本和跨度在其中或还有许多其他（子）子 Dom 节点。

```
var html = $('#myDiv').html();
var new_html = html.replace(new RegExp('<span>[uU]ser</span>','gm'),'user');
$('#myDiv').html(new_html); 
```

如果您更新问题，我可以为您提供更准确的答案，以缩小 RegEx 可能发生的冲突。

# ruby-on-rails - 显示重复数据的模型 index.html 页面

> ID：15603793
> 
> 赞同：0
> 
> 时间：2013-03-24T20:46:06.180
> 
> 标签：ruby-on-rails

我的模型索引页面上出现了一些奇怪的行为。当我创建一个模型对象时，它会正确显示在索引页面上。当我创建第二个模型对象时，它会在索引页面上显示两个对象的重复项，就像这样

```
OBJECT A
OBJECT B
OBJECT A
OBJECT B 
```

我已经确认没有在我的数据库中创建重复的对象。此外，当我销毁 OBJECT B 时，它只正确显示 OBJECT A 一次。

index.html.erb

```
<table class="table">
  <thead>
    <tr>
      <th>Image</th>
      <th>Name</th>
      <th>Description</th>
      <th>URL</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <%= render @companies %>
  </tbody>
</table> 
```

_company.html.erb

```
<% @companies.each do |company| %>
  <tr>
    <td><%= image_tag company.image(:medium) %></td>
    <td><%= company.name %></td>
    <td><%= company.description %></td>
    <td><%= company.url %></td>
    <td><%= link_to 'Show', company %></td>
    <td><%= link_to 'Edit', edit_company_path(company) %></td>
    <td><%= link_to 'Destroy', company, method: :delete, data: { confirm: 'Are you sure?' } %></td>
  </tr>
<% end %> 
```

公司控制器.rb

```
def index
    @companies = Company.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @companies }
    end
  end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:52:01.257

改变你的偏爱，

```
<tr>
  <td><%= image_tag company.image(:medium) %></td>
  <td><%= company.name %></td>
  <td><%= company.description %></td>
  <td><%= company.url %></td>
  <td><%= link_to 'Show', company %></td>
  <td><%= link_to 'Edit', edit_company_path(company) %></td>
  <td><%= link_to 'Destroy', company, method: :delete, data: { confirm: 'Are you sure?' } %></td>
</tr> 
```

您需要在部分中删除每个循环。

渲染每个公司的`<%= render @companies %>`部分，但您也在每个部分中再次遍历公司。

有关更多信息，请参阅 http://guides.rubyonrails.org/layouts_and_rendering.html#rendering-collections 上的3.4.5[渲染](http://guides.rubyonrails.org/layouts_and_rendering.html#rendering-collections)**集合**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:54:54.473

更改`<%= render @companies %>`为`<%= render "company" %>`; 您的部分被多次渲染，每个公司一次，而您的部分正在渲染所有公司。这只会渲染部分，这将渲染所有公司，这就是你想要的。

# yeoman - 如何让 yeoman 重新加载 bla.html 而不是 index.html

> ID：15603799
> 
> 赞同：0
> 
> 时间：2013-03-24T20:46:39.350
> 
> 标签：yeoman

当对根目录中的任何 html 文件进行更改时，yeoman 会触发重新加载任务，但是，yeoman 只会对`http://localhost:3501/index.html`. 如何让 yeoman 知道我想重新加载`http://localhost:3501/bla.html`？

也许一些 Gruntgile.js 配置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T09:11:29.003

Yeoman 1.0 可以毫无问题地做到这一点，它很容易安装。这是一个快速指南：

1.  确保您已使用 NPM 安装了 Node
2.  卸载旧版本的 Grunt
3.  像这样使用 NPM 安装需求：`npm install -g yo grunt-cli bower`
4.  您现在拥有所需的一切，您可以运行`yo`以确认您安装了正确的版本。

依赖项少了很多，它们被移到了每个项目的基础上。

您可以在他们的网站上阅读更多内容[http://yeoman.io](http://yeoman.io) [确保您阅读了迁移指南。](https://github.com/yeoman/yeoman/wiki/Migrate-from-0.9.6-to-1.0)

注意：他们的 wiki 说它不能在 Windows 上运行，现在不再是这种情况了，我运行的是 Windows 7，它就像魅力一样工作。

# java - 如果有一些用户已经登录，如何确定登录页面？

> ID：15603801
> 
> 赞同：1
> 
> 时间：2013-03-24T20:46:46.900
> 
> 标签：java, spring, spring-mvc, spring-security

`Spring 3 MVC`有什么办法，如何确定使用+时是否有人已经登录`Spring security`？这是我的安全上下文：

```
<beans xmlns:security="http://www.springframework.org/schema/security"
   xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.springframework.org/schema/beans
             http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
             http://www.springframework.org/schema/security
             http://www.springframework.org/schema/security/spring-security-3.1.xsd">

<security:http pattern="/resources/**" security="none"/>
<security:http pattern="/login*" security="none" auto-config="true"/>
<security:http pattern="/denied" security="none"/>

<security:http auto-config="true" access-denied-page="/denied" servlet-api-provision="false">
    <security:intercept-url pattern="/login*" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
    <security:intercept-url pattern="/edit/**" access="ROLE_EDIT"/>
    <security:intercept-url pattern="/admin/**" access="ROLE_ADMIN"/>
    <security:intercept-url pattern="/**" access="ROLE_USER"/>
    <security:form-login login-page="/login"  authentication-failure-url="/denied"
                         default-target-url="/"/>
    <security:logout/>
</security:http>

<security:authentication-manager>
    <security:authentication-provider>
        <security:user-service>
            <security:user name="adam" password="adampassword" authorities="ROLE_USER"/>
            <security:user name="jane" password="janepassword" authorities="ROLE_USER, ROLE_ADMIN"/>
            <security:user name="sue" password="suepassword" authorities="ROLE_USER, ROLE_EDIT"/>
        </security:user-service>
    </security:authentication-provider>
</security:authentication-manager>

</beans> 
```

我可以确定它，即在主页上通过

```
<%
    User user = (User) SecurityContextHolder.getContext()
            .getAuthentication().getPrincipal();
    String username = user.getUsername();
%> 
```

尽管如此，在登录页面上它会生成空指针异常.. :-/

当有人已经登录并且有人尝试再次登录时，浏览器会转到`myurl.com/home`页面并出现 404 错误，因为正确的地址应该是`myurl.com/`. 当没有人登录时，浏览器会重定向到正确的地址。有什么想法可能是错误吗？

我的jsp页面：

```
<%@ page import="org.springframework.security.core.userdetails.User"%>
<%@ page import="org.springframework.security.core.context.SecurityContextHolder"%>
<%@ page import="java.util.Collection"%>
<%@ page import="javax.swing.text.AbstractDocument"%>
<%@ page import="org.springframework.security.core.GrantedAuthority"%>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
</head>
<body>
<div class="form">
    <form name="f" action="j_spring_security_check" method="post">
        <input type="text" id="username" class="input-block-level"
            name="j_username" placeholder="Username"> <input
            type="password" id="password" name="j_password"
            class="input-block-level" placeholder="Password">
        <button class="btn btn-large btn-primary" type="submit">Sign
            in</button>
    </form>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T04:52:21.963

Spring Security 包含一个 JSP 标签库，可以通过以下代码导入：

```
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags" %> 
```

导入后，您可以使用 jsp 标签“sec”（用于安全性），

```
 <sec:authorize access="isAuthenticated()">
     ... <!-- Code or message to show when user is authenticated -->
 </sec:authorize> 
```

在标签内，您可以运行某些代码、显示标签或 html。

[http://static.springsource.org/spring-security/site/docs/3.0.x/reference/taglibs.html](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/taglibs.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-24T21:06:03.847

在jsp中你可以使用

第一个问题：

```
 <sec:authorize access="isAuthenticated()">
     the user has logged in 
 </sec:authorize> 
```

第二个问题：

当某些正文已经登录直接请求登录页面时，您会收到 404 错误，因为您限制了对该页面的访问：

```
 <security:intercept-url pattern="/login*" access="IS_AUTHENTICATED_ANONYMOUSLY"/> 
```

一种解决方案是使用`permitAll`访问限制，并在 jsp 中为已经登录的用户添加一些通知：

```
 <security:intercept-url pattern="/login*" access="permitAll"/> 
```

登录.jsp

```
 <sec:authorize access="isAuthenticated()">
     you already logged in. 
 </sec:authorize> 
```

# eclipse-rcp - P2.inf：根据位置引用更新站点

> ID：15603802
> 
> 赞同：0
> 
> 时间：2013-03-24T20:46:54.347
> 
> 标签：eclipse-rcp, p2

我开发了一个 RCP 应用程序，并提供 p2 更新功能。

在我的 p2.inf 中，我提供了更新站点的 url。我不希望用户添加任何站点，因此我禁用了添加站点的选项。我的 p2.inf 看起来像：

```
instructions.configure=\
  addRepository(type:0,location:http${#58}//blrupdates.com/Updates);\
  addRepository(type:1,location:http${#58}//blrupdates.com/Updates); 
```

如果用户位置是班加罗尔，RCP 应用程序应该去 brlupdates.com，如果用户位置是 chennai，那么 RCP 应用程序应该在 chnupdates.com 上寻找更新。

如何在 p2.inf 中添加另一个存储库位置？

-普里扬克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T13:43:08.503

您需要以编程方式添加存储库。以下解决方案取自[此处](http://coopology.com/2012/08/eclipse-rcp-setting-p2-repositories-update-sites-programmatically-for-when-p2-inf-fails/)。另一种我不确定是否可行的解决方案是使用重定向。您定义一个 p2 存储库，然后将用户重定向到基于位置的存储库。

```
import org.eclipse.equinox.internal.p2.ui.model.MetadataRepositoryElement;
import org.eclipse.equinox.internal.p2.ui.model.ElementUtils;

@SuppressWarnings("restriction")
public class P2Util {
  private static String UPDATE_SITE = "http://www.example.com/update_site";

  public static void setRepositories() throws InvocationTargetException {
    try {
      final MetadataRepositoryElement element = new MetadataRepositoryElement(null, new URI(UPDATE_SITE), true);
      ElementUtils.updateRepositoryUsingElements(new MetadataRepositoryElement[] {element}, null);
    } catch (URISyntaxException e) {
      e.printStackTrace();
      throw new InvocationTargetException(e);
    }
  }
} 
```

# android - Android BatteryManager 类中EXTRA_LEVEL 的意义

> ID：15603804
> 
> 赞同：2
> 
> 时间：2013-03-24T20:47:11.317
> 
> 标签：android, batterylevel

Android 中 BatteryManager 类的 EXTRA_LEVEL 值是什么意思？我试图准确地理解 1% 的水平变化意味着什么。例如 Galaxy Nexus 的电池容量为 1750 mAh。这是否意味着，1% 的变化将意味着 17.5 mAh 的电荷流动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T21:15:13.353

> Android 中 BatteryManager 类的 EXTRA_LEVEL 值是什么意思？

引用[文档：](http://developer.android.com/reference/android/os/BatteryManager.html#EXTRA_LEVEL) “ACTION_BATTERY_CHANGED 的额外内容：包含当前电池电量的整数字段，从 0 到 EXTRA_SCALE。”

> 这是否意味着，1% 的变化将意味着 17.5 mAh 的电荷流动？

不准确，尽管它可能很接近。例如，电池不会线性放电。设备制造商关心的是确保报告的水平在指示可用电量方面相当准确。他们不一定关心保持电池侧面标签上印刷的电池容量的准确性。

# php - 如何设置未设置的会话变量？

> ID：15603807
> 
> 赞同：0
> 
> 时间：2013-03-24T20:47:16.337
> 
> 标签：php, session, variables, unset

我正在尝试测试我的 php 脚本，所以我需要（至少暂时）取回一些未设置的变量。

我是说：

page1.php：

```
<?php
session_start();
$_SESSION['var']="somevalue";
go_to("./page2.php");
?> 
```

page2.php：

```
<?php
session_start();
use($_SESSION['var']);
unset($_SESSION['var']);
?> 
```

现在，当我转到 page1->page2，然后 page1 再次（然后 page2 再次） page2 无法识别`$_SESSION['var']`，所以我需要类似的东西

```
if(!isset($_SESSION['var']))
{
set_back($_SESSION['var']); //But how ?
} 
```

在 page1.php 中。

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T21:13:54.743

我认为您的问题是本地浏览器缓存。

当您返回时`page1`，响应是从您的计算机缓存而不是从服务器提供的，因此不会再次设置会话变量

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T22:50:32.520

php 中没有“回滚”未设置的会话/变量的功能（当然，您可以像 Boaz 建议的那样将原始值存储在临时会话中）。你到底想达到什么目的？

# function - Haskell 中的集群

> ID：15603808
> 
> 赞同：0
> 
> 时间：2013-03-24T20:47:26.470
> 
> 标签：function, haskell

如何使用列表理解在 Haskell 中定义集群？我想为集群定义一个函数：

```
 ( a b c ) = [ a <- [1 .. 10],b<-[2 .. 10], c = (a, b)] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T21:44:58.580

在您的评论中，您给出了示例`[(1,2,1),(1,3,1),(1,4,1),(1,5,1),(1,6,1),(1,7,1)]`。

在那个例子中，只有中间的数字会改变，其他两个总是 1。你可以用

```
ones = [(1,a,1)| a<-[1..7]] 
```

但是，您可能想要改变其他的。让我们看看它是如何工作的，但我将使用字母来使其更清晰：

```
> [(1,a,b)| a<-[1..3],b<-['a'..'c']]
[(1,1,'a'),(1,1,'b'),(1,1,'c'),(1,2,'a'),(1,2,'b'),(1,2,'c'),(1,3,'a'),(1,3,'b'),(1,3,'c')] 
```

您可以看到字母的变化比数字更频繁——`b<-[1..3]`就像一个外循环，*内*`c<-['a'..'c']`循环。

您可以将 复制`c`到元组的三个元素中的第一个：

```
> [(b,a,b)| a<-[1..3],b<-['a'..'b']]
[('a',1,'a'),('b',1,'b'),('a',2,'a'),('b',2,'b'),('a',3,'a'),('b',3,'b')] 
```

或者给每个不同的输入

```
>  [(a,b,c)| a<-[1..2],b<-['a'..'b'],c<-[True,False]]
[(1,'a',True),(1,'a',False),(1,'b',True),(1,'b',False),(2,'a',True),(2,'a',False),(2,'b',True),(2,'b',False)] 
```

# css - 无法将文本框与外部 div 对齐

> ID：15603811
> 
> 赞同：0
> 
> 时间：2013-03-24T20:47:38.740
> 
> 标签：css, dojo

演示：http: [//jsfiddle.net/57M68/](http://jsfiddle.net/57M68/)。我已经尝试了很多东西，比如浮动、边距、填充，但我无法让文本框在黑条的中心垂直对齐。请帮忙。编码：

## html:

```
<body class="claro" data-maq-flow-layout="true" data-maq-comptype="desktop" data-maq-ws="collapse" style="margin-top:0" data-maq-appstates="{}" id="myapp">
 <div id="top_bar">
 <div style="width: 900px; height:50px; margin-left: auto; margin-right: auto;">
<a href="/" class="logo logo_a">
 <div class="logo">

 </div>
</a>
<div style="display:inline-block"> <input type="text" ></input></div>
</div>

</div>
 <div id="top_bar_divider"></div>
 <div data-dojo-type="dijit.layout.BorderContainer" persist="false" gutters="true" style="min-width: 1em; min-height: 1px; z-index: 0; width: 600px; height: 687px; margin-left: auto; margin-right: auto;" design="headline">
   <div data-dojo-type="dijit.layout.ContentPane" extractContent="false" preventCache="false" preload="false" refreshOnShow="false" region="center" splitter="false" maxSize="Infinity">
  </div>
 </div>
</body> 
```

## js：

```
require([
  "dijit/dijit",
  "dojo/parser",
  "maqetta/space",
  "maqetta/AppStates",
  "dijit/layout/BorderContainer",
  "dijit/layout/ContentPane",
  "dijit/form/TextBox"
]); 
```

## CSS：

```
html,body {
    height: 100%;
    width: 100%;
}

 .logo_a{
background:url("icon1.png");
}
.logo{
width:60px;
height:50px;
display:inline-block;
}
.logo_a:active{
background-position:0 1px;
}

#top_bar{
    padding:0px; 
    background: -webkit-linear-gradient(#464646, #121212);
    background: -moz-linear-gradient(#464646, #121212);
    background: -ms-linear-gradient(#464646, #121212);
    background: -o-linear-gradient(#464646, #121212);
    background: linear-gradient(#464646, #121212);
    color: #ccc;
    text-shadow:none;
    height:50px;
    width:100%;
}
#top_bar_divider{
background-color:#1ba0e1;
height:4px;
width:100%;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T21:05:21.057

HTML 是这样的

```
<body class="claro" data-maq-flow-layout="true" data-maq-comptype="desktop" data-maq-         ws="collapse" style="margin-top:0" data-maq-appstates="{}" id="myapp">
<div id="top_bar">
<div style="width: 900px; height:50px; margin-left: auto; margin-right: auto;">
<a href="/" class="logo logo_a">
<div class="logo">

</div>
</a>
<div id="text"> <input type="text"></div>
</div>

</div>
<div id="top_bar_divider"></div>
<div data-dojo-type="dijit.layout.BorderContainer" persist="false" gutters="true"   style="min-width: 1em; min-height: 1px; z-index: 0; width: 600px; height: 687px; margin-  left: auto; margin-right: auto;" design="headline">
<div data-dojo-type="dijit.layout.ContentPane" extractContent="false"   preventCache="false" preload="false" refreshOnShow="false" region="center" splitter="false" maxSize="Infinity">
</div>
</div>
</body> 
```

并将 css 添加到现有的演示中——

```
#text{display:inline;}
#text input{position:relative;
top:-43px;
left:110px;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:56:12.587

您只需要添加`vertical-align: middle`到您的输入 div 并添加到`.logo_a`：

```
.logo_a {
    background:url("icon1.png");
    vertical-align: middle;
} 
```

[http://jsfiddle.net/57M68/1/](http://jsfiddle.net/57M68/1/)

# visual-studio-2012 - 异步方法的代码覆盖率

> ID：15603813
> 
> 赞同：10
> 
> 时间：2013-03-24T20:47:52.857
> 
> 标签：visual-studio-2012, mstest, code-coverage, async-await, c#-5.0

当我在 Visual Studio 2012 中分析代码覆盖率时，异步方法中的任何等待行都显示为未覆盖，即使它们显然正在执行，因为我的测试通过了。代码覆盖率报告说未发现的方法是`MoveNext`，它在我的代码中不存在（也许它是编译器生成的）。

有没有办法修复异步方法的代码覆盖率报告？

**注意**：

我刚刚使用 NCover 进行了覆盖，使用该工具覆盖数字更有意义。作为目前的解决方法，我将切换到它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-24T22:04:19.917

如果您正在等待的操作在等待之前完成，则最常发生这种情况。

我建议您至少测试同步和异步成功情况，但测试同步和异步错误和取消也是一个好主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-19T05:07:46.183

代码未显示为被覆盖的原因与异步方法的实现方式有关。C# 编译器实际上将异步方法中的代码转换为实现状态机的类，并将原始方法转换为初始化并调用该状态机的存根。由于此代码是在您的程序集中生成的，因此它包含在代码覆盖率分析中。

如果您使用的任务在执行所覆盖的代码时未完成，编译器生成的状态机会挂接一个完成回调以在任务完成时恢复。这更完整地锻炼了状态机代码，并导致完整的代码覆盖（至少对于语句级代码覆盖工具）。

获取当前未完成但将在某个时间完成的任务的常用方法是在单元测试中使用 Task.Delay。然而，这通常是一个糟糕的选择，因为时间延迟要么太小（并且导致不可预测的代码覆盖，因为有时任务在被测试的代码运行之前完成）或太大（不必要地减慢测试速度）。

更好的选择是使用“await Task.Yield()”。这将立即返回，但在设置后立即调用延续。

另一种选择——虽然有点荒谬——是实现你自己的等待模式，该模式具有报告不完整的语义，直到连接了一个延续回调，然后立即完成。这基本上迫使状态机进入异步路径，提供完整的覆盖。

可以肯定的是，这不是一个完美的解决方案。最不幸的方面是它需要修改生产代码以解决工具的限制。我更希望代码覆盖工具忽略编译器生成的异步状态机部分。但在此之前，如果您真的想尝试获得完整的代码覆盖率，则没有太多选择。

可以在此处找到有关此 hack 的更完整说明：http: [//blogs.msdn.com/b/dwayneneed/archive/2014/11/17/code-coverage-with-async-await.aspx](http://blogs.msdn.com/b/dwayneneed/archive/2014/11/17/code-coverage-with-async-await.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-13T09:59:19.790

在某些情况下，我不关心测试方法的异步性质，而只想摆脱部分代码覆盖。我使用下面的扩展方法来避免这种情况，它对我来说很好。

此处使用了警告“ *Thread.Sleep* ”！

```
public static IReturnsResult<TClass> ReturnsAsyncDelayed<TClass, TResponse>(this ISetup<TClass, Task<TResponse>> setup, TResponse value) where TClass : class
{
    var completionSource = new TaskCompletionSource<TResponse>();
    Task.Run(() => { Thread.Sleep(200); completionSource.SetResult(value); });
    return setup.Returns(completionSource.Task);
} 
```

并且用法类似于 Moq 的*ReturnsAsync*设置。

```
_sampleMock.Setup(s => s.SampleMethodAsync()).ReturnsAsyncDelayed(response); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-04-11T19:18:47.807

我创建了一个测试运行器，它多次运行一段代码并改变使用工厂延迟的任务。这对于通过简单的代码块测试不同的路径非常有用。对于更复杂的路径，您可能希望为每个路径创建一个测试。

```
[TestMethod]
public async Task ShouldTestAsync()
{
    await AsyncTestRunner.RunTest(async taskFactory =>
    {
        this.apiRestClient.GetAsync<List<Item1>>(NullString).ReturnsForAnyArgs(taskFactory.Result(new List<Item1>()));
        this.apiRestClient.GetAsync<List<Item2>>(NullString).ReturnsForAnyArgs(taskFactory.Result(new List<Item2>()));

        var items = await this.apiController.GetAsync();

        this.apiRestClient.Received().GetAsync<List<Item1>>(Url1).IgnoreAwait();
        this.apiRestClient.Received().GetAsync<List<Item2>>(Url2).IgnoreAwait();

        Assert.AreEqual(0, items.Count(), "Zero items should be returned.");
    });
}

public static class AsyncTestRunner
{
    public static async Task RunTest(Func<ITestTaskFactory, Task> test)
    {
        var testTaskFactory = new TestTaskFactory();
        while (testTaskFactory.NextTestRun())
        {
           await test(testTaskFactory);
        }
    }
}

public class TestTaskFactory : ITestTaskFactory
{
    public TestTaskFactory()
    {
        this.firstRun = true;
        this.totalTasks = 0;
        this.currentTestRun = -1;   // Start at -1 so it will go to 0 for first run.
        this.currentTaskNumber = 0;
    }

    public bool NextTestRun()
    {
        // Use final task number as total tasks.
        this.totalTasks = this.currentTaskNumber;

        // Always return has next as turn for for first run, and when we have not yet delayed all tasks.
        // We need one more test run that tasks for if they all run sync.
        var hasNext = this.firstRun || this.currentTestRun <= this.totalTasks;

        // Go to next run so we know what task should be delayed, 
        // and then reset the current task number so we start over.
        this.currentTestRun++;
        this.currentTaskNumber = 0;
        this.firstRun = false;

        return hasNext;
    }

    public async Task<T> Result<T>(T value, int delayInMilliseconds = DefaultDelay)
    {
        if (this.TaskShouldBeDelayed())
        {
            await Task.Delay(delayInMilliseconds);
        }

        return value;
    }

    private bool TaskShouldBeDelayed()
    {
        var result = this.currentTaskNumber == this.currentTestRun - 1;
        this.currentTaskNumber++;
        return result;
    }

    public async Task VoidResult(int delayInMilliseconds = DefaultDelay)
    {
        // If the task number we are on matches the test run, 
        // make it delayed so we can cycle through them.
        // Otherwise this task will be complete when it is reached.
        if (this.TaskShouldBeDelayed())
        {
            await Task.Delay(delayInMilliseconds);
        }
    }

    public async Task<T> FromResult<T>(T value, int delayInMilliseconds = DefaultDelay)
    {
        if (this.TaskShouldBeDelayed())
        {
            await Task.Delay(delayInMilliseconds);
        }

        return value;
    }
} 
```

# android - 为什么一个按钮会在 Android RelativeLayout 中与另一个按钮交叉？

> ID：15603815
> 
> 赞同：0
> 
> 时间：2013-03-24T20:48:03.153
> 
> 标签：android, android-layout

我目前有两个并排的按钮，但看起来它们的格式就像我想要的那样，但是左按钮重叠并占据了整个宽度，而右按钮完全符合我的要求。当按下左按钮时，看起来好像两个按钮都被按下了，因为它占据了整个宽度。

```
<Button
        android:id="@+id/set_alarm"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/time_picker"
        android:layout_alignParentLeft="true"
        android:text="@string/set_text"
        android:textSize="27sp" />

    <Button
        android:id="@+id/cancel_button"
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
        android:layout_below="@+id/time_picker"
        android:layout_alignParentRight="true"
        android:text="@string/cancel_alarm_text"
        android:textSize="27sp"
        android:onClick="cancelAlarm" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T20:51:03.170

尝试`android:layout_toRightOf="@+id/set_alarm"`像这样添加：属性：

```
<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <Button
        android:id="@+id/set_alarm"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/time_picker"
        android:text="@string/set_text"
        android:textSize="13sp" />

<Button
    android:id="@+id/cancel_button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_below="@+id/time_picker"
    android:layout_toRightOf="@+id/set_alarm"
    android:onClick="cancelAlarm"
    android:text="@string/cancel_alarm_text"
    android:textSize="13sp" />

</RelativeLayout> 
```

它们重叠的原因是因为您已指示它们低于某个布局，但如果您不告诉它们它们彼此不知道，因此它们彼此重叠。

# regex - RegEx (a+b)^n(c+d)^m 匹配什么？

> ID：15603822
> 
> 赞同：0
> 
> 时间：2013-03-24T20:49:08.853
> 
> 标签：regex

我不确定这个[RegEx](http://en.wikipedia.org/wiki/Regular_expression)匹配什么：

```
(a+b)^n(c+d)^m 
```

我知道`+`元字符的意思是“前一个模式的一个或多个倍”。因此，`a+`将匹配一个或多个`a`s 同时`a*`还包括空字符串。

但我认为在这种情况下，正则表达式的意思是`a or b to the nth time concatenated with c or d to the mth time`，所以它会匹配这样的字符串：

```
aaaacc (n=4, m=2)
bbbbbdddd (n=5, m=4)
aaaddddd (n=3, m=5)
bc (n=1, m=1)
aaaaaaaaaaaaccccc (n=12, m=5)
... 
```

这个对吗？如果不是，任何人都可以提供此 RegEx匹配的示例吗*？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T21:00:03.327

由于 ^ 的使用不正确，它看起来不像是一个有效的正则表达式

^ 应该像这样 [^a] 在 [] 中，或者在正则表达式的开头。+ 仅表示字符出现 1 次或多次。

如果 ^n 意味着可以重复 n 次，那么这些将是匹配的：

啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T01:39:16.330

如果您使用带有'm' 选项的Perl 正则表达式，例如`/(a+b)^n(c+d)^m/m`，'^' 将匹配行的内部开始。所以...

```
/
 (a+b)    # Match one or more as followed by b
 ^n       # Match the beginning of a line followed by a literal n.
 (c+d)    # Match one or more cs followed by d
 ^m       # Match the beginning of a line followed by a literal m.
/mx 
```

(a+b) 和 (c+d) 将以 1 美元和 2 美元的价格提供。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T01:22:37.377

显然`(a+b)^n(c+d)^m`意味着“`n`无序*a*和*b*的插槽后跟`m`无序*c*和*d*的插槽”

例如，一个例子`(a+b)^10(c+d)^5`是：`aaaababbbadcccd`

# hadoop - Hadoop slave tasktracker 错误“重试连接”

> ID：15603823
> 
> 赞同：1
> 
> 时间：2013-03-24T20:49:10.033
> 
> 标签：hadoop, amazon-ec2, cluster-computing, slave

我在 EC2 One Master One Slave 上有一个简单的设置

当我做 JPS 时，我看到了除了 tasktracker 进程之外的所有内容。当我执行 start-all.sh/stop-all.sh 时，我会看到 tasktracker 消息启动、记录、停止等。我可以在 Mapreduce 模式下运行我的 pig 命令，也可以在从站上运行。但我不能这样做：

1.  无法访问[http://ec2machineSlave.com:50060/tasktracker.jsp](http://ec2machineSlave.com:50060/tasktracker.jsp)
2.  JPS 不显示任务跟踪器
3.  在 Slave 上出现错误 Retrying to connect to server ec2machineMaster/ipaddress:54300。已尝试 x 次

我可以在主从之间进行 SSH。在 master 上创建一个 id_dsa 密钥，将 id_dsa.pub 复制到 slave 并完成所有许可操作。

谁能建议可能出了什么问题，或者我是否需要尝试其他方法。

# c++ - Win32 c++ 在运行时调整创建窗口的大小

> ID：15603826
> 
> 赞同：1
> 
> 时间：2013-03-24T20:49:30.803
> 
> 标签：c++, button, window, runtime

我用win32 api c++编写，并使用mingw。当主窗口在运行时调整大小时，我想调整按钮的大小。这是我的代码：

```
int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)
{
 // BLA BLA BLA
    hwnd = CreateWindowEx(
        WS_EX_CLIENTEDGE,
        szClassName,
        "Main Window",
        WS_OVERLAPPEDWINDOW,
        CW_USEDEFAULT,
        CW_USEDEFAULT,
        800,        // width
        1000,       // height
        HWND_DESKTOP,
        NULL,
        hInstance,
        NULL
    );
  // BLA BLA BLA
}

LRESULT CALLBACK WndProc(HWND hwnd, UINT Message, WPARAM wParam, LPARAM lParam)
{
    switch(Message)
    {
        case WM_CREATE:
        {
         RECT  rect;
        GetClientRect(hwnd, &rect);
        int width = rect.right - rect.left;
        width = width-20;

        HWND button = CreateWindowEx(BS_PUSHBUTTON, "BUTTON", "grafikon",
                           WS_CHILD | WS_VISIBLE | BS_PUSHBUTTON,
                           10, 10, width, 25,
                           hwnd,
                           (HMENU)ID_BUTTON,
                           GetModuleHandle(NULL),
                           0);
      // BLA BLA BLA
} 
```

所以我想在运行时调整 BUTTON 的大小。我怎样才能做到这一点？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:59:26.223

我想你搜索 WM_SIZE MSDN：http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms632646.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632646.aspx)

# asp.net - ASP.Net IgnoreRoutes 不起作用

> ID：15603831
> 
> 赞同：1
> 
> 时间：2013-03-24T20:50:13.733
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, azure

我有一个 svg 文件作为我的资产，在 routeconfig 中，我提到了以下代码

```
 routes.IgnoreRoute("{*svg}", new { svg = @"(.*/)?.svg(/.*)?" }); 
```

这似乎适用于 cassini（Visual Studio 2012 内置部署服务器），但是当我将它部署到 Azure 时，我得到了 404。

我的 IgnoreRoute 声明正确吗？或任何其他解决方案？所有其他图像，样式表似乎都可以正常工作。

提前非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-17T01:43:40.237

您永远不必忽略磁盘上物理存在的文件的路由，路由模块不会尝试路由这些请求。您只需要忽略到其他虚拟资源的路由。

Azure 网站没有为 .svg 文件配置 mime 类型，至少在去年年底他们没有。`<system.webserver>`您可以在web.config 文件的部分中为 svg 配置 mime 类型：

```
<staticContent>
  <remove fileExtension=".svg"/>      
  <mimeMap fileExtension=".svg" mimeType="image/svg+xml"/>
</staticContent> 
```

删除是为了防止已经有 .svg 条目的服务器上出现错误。添加重复的文件扩展名是错误的，但删除不存在的扩展名不是错误。

更多信息：[Windows Azure 网站上 ASP.NET MVC 4 的配置提示](http://odetocode.com/blogs/scott/archive/2012/08/07/configuration-tips-for-asp-net-mvc-4-on-a-windows.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-05T12:38:12.490

查看[菲尔的博客](http://haacked.com/archive/2008/07/14/make-routing-ignore-requests-for-a-file-extension.aspx)，我认为您需要的是：

```
routes.IgnoreRoute("{*allsvg}", new {allsvg=@".*\.svg(/.*)?"}); 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-16T05:50:40.890

您声明路线的顺序是什么？可能是在那个之上，你有一个默认或全部的路由，实际上已经处理了请求，所以你的 IgnoreRoute 永远不会被击中。

# java - Java 等价于 c++ equal_range（或 lower_bound 和 upper_bound）

> ID：15603832
> 
> 赞同：21
> 
> 时间：2013-03-24T20:50:18.023
> 
> 标签：java, binary-search, lower-bound, upperbound

我有一个排序的对象列表，我想找到对象的第一次出现和最后一次出现。在 C++ 中，我可以轻松地使用 std::equal_range （或者只有一个 lower_bound 和一个 upper_bound）。

例如：

```
bool mygreater (int i,int j) { return (i>j); }

int main () {
  int myints[] = {10,20,30,30,20,10,10,20};
  std::vector<int> v(myints,myints+8);                         // 10 20 30 30 20 10 10 20
  std::pair<std::vector<int>::iterator,std::vector<int>::iterator> bounds;

  // using default comparison:
  std::sort (v.begin(), v.end());                              // 10 10 10 20 20 20 30 30
  bounds=std::equal_range (v.begin(), v.end(), 20);            //          ^        ^

  // using "mygreater" as comp:
  std::sort (v.begin(), v.end(), mygreater);                   // 30 30 20 20 20 10 10 10
  bounds=std::equal_range (v.begin(), v.end(), 20, mygreater); //       ^        ^

  std::cout << "bounds at positions " << (bounds.first - v.begin());
  std::cout << " and " << (bounds.second - v.begin()) << '\n';

  return 0;
} 
```

在Java中，似乎没有简单的等价？我应该如何处理相等的范围

```
List<MyClass> myList; 
```

顺便说一句，我使用的是标准导入 java.util.List；

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-24T20:56:00.007

在 Java 中，您可以使用[`Collections.binarySearch`](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#binarySearch%28java.util.List,%20T%29)在排序列表中查找相等范围的下限（`Arrays.binarySearch`为数组提供了类似的功能）。这为您提供了相同范围内的位置，而没有进一步的保证：

> [如果列表包含多个等于指定对象的元素，则无法保证会找到哪一个。](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#binarySearch%28java.util.List,%20T%29)

然后你线性地向前然后向后迭代，直到你到达相等范围的末端。

这些方法适用于实现[`Comparable`](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html)接口的对象。对于不实现 的类`Comparable`，您可以提供一个*自定义* [`Comparator`](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)实例来比较您的特定类型的元素。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2020-09-12T00:04:14.800

我们可以借助 java 库函数以及定义我们自己的**LowerBound 和 UpperBound 函数来找到下界和上界。**

**{＃情况1}**

如果数字不存在，则下限和上限将相同。即在这种情况下，*lb*和*ub*将是数组的插入点，即应该插入数字以保持数组排序的点。

*示例 1：*

```
6 1 // 6 is the size of the array and 1 is the key
2 3 4 5 6 7 here lb=0 and ub=0 (0 is the position where 1 should be inserted to keep the array sorted)

6 8 // 6 is the size of the array and 8 is the key
2 3 4 5 6 7  here lb=6 and ub=6 (6 is the position where 8 should be inserted to keep the array sorted)

6 3 // 6 is the size of the array and 3 is the key
1 2 2 2 4 5  here lb=4 and ub=4 (4 is the position where 3 should be inserted to keep the array sorted) 
```

**{#case-2(a)}**

如果数字存在且频率为 1。即出现次数为 1

*lb* =该数字的索引。
*ub* =下一个数字的索引，它刚好大于数组中的那个数字。即*ub* =那个数字的索引+1

*示例 2：*

```
6 5 // 6 is the size of the array and 5 is the key
1 2 3 4 5 6 here lb=4 and ub=5 
```

**{#case-2(b)}**

如果数字存在并且频率超过 1。数字出现多次。在这种情况下 ， *lb*将是该数字第一次出现的索引。 *ub*将是该数字+1 的最后一次出现的索引。即，该数字的索引刚好大于数组中的键。

*示例 3：*

```
 11 5 // 11 is the size of the array and 5 is the key
 1 2 3 4 5 5 5 5 5 7 7 here lb=4 and ub=9 
```

# Lower_Bound 和 Upper_Bound 的实现

**方法一：** *通过库函数*

// a 是数组，x 是目标值

```
int lb=Arrays.binarySearch(a,x); // for lower_bound

int ub=Arrays.binarySearch(a,x); // for upper_bound

if(lb<0) {lb=Math.abs(lb)-1;}//if the number is not present

else{ // if the number is present we are checking 
    //whether the number is present multiple times or not
    int y=a[lb];
    for(int i=lb-1; i>=0; i--){
        if(a[i]==y) --lb;
        else break;
    }
}
  if(ub<0) {ub=Math.abs(ub)-1;}//if the number is not present

  else{// if the number is present we are checking 
    //whether the number is present multiple times or not
    int y=a[ub];
    for(int i=ub+1; i<n; i++){
        if(a[i]==y) ++ub;
        else break;
    }
    ++ub;
} 
```

**方法2：** *通过定义自己的功能*

//对于下界

```
static int LowerBound(int a[], int x) { // x is the target value or key
  int l=-1,r=a.length;
  while(l+1<r) {
    int m=(l+r)>>>1;
    if(a[m]>=x) r=m;
    else l=m;
  }
  return r;
} 
```

// 对于 Upper_Bound

```
 static int UpperBound(int a[], int x) {// x is the key or target value
    int l=-1,r=a.length;
    while(l+1<r) {
       int m=(l+r)>>>1;
       if(a[m]<=x) l=m;
       else r=m;
    }
    return l+1;
 } 
```

或者我们可以使用

```
int m=l+(r-l)/2; 
```

但是如果我们使用

```
int m=(l+r)>>>1; // it is probably faster 
```

但是使用上述任何计算 m 的公式都会防止溢出

在 C 和 C++ 中 (>>>) 运算符不存在，我们可以这样做：

```
int m= ((unsigned int)l + (unsigned int)r)) >> 1; 
```

// 程序中的实现：

```
import java.util.*;
import java.lang.*;
import java.io.*;
public class Lower_bound_and_Upper_bound {

public static void main (String[] args) throws java.lang.Exception
{
    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    StringTokenizer s = new StringTokenizer(br.readLine());
    int n=Integer.parseInt(s.nextToken()),x=Integer.parseInt(s.nextToken()),a[]=new int[n];
    s = new StringTokenizer(br.readLine());
    for(int i=0; i<n; i++) a[i]=Integer.parseInt(s.nextToken());
    Arrays.sort(a);// Array should be sorted. otherwise lb and ub cant be calculated
    int u=UpperBound(a,x);
    int l=LowerBound(a,x);
    System.out.println(l+" "+u);
 }
} 
```

**# 计算下界和上界的等效 C++ 代码**

```
 #include<bits/stdc++.h>
  #define IRONMAN ios_base::sync_with_stdio(false);cin.tie(0);cout.tie(0);
  using namespace std;
  typedef long long int ll;
  int main() {
    IRONMAN
    int n,x;cin>>n>>x;
    vector<int> v(n);
    for(auto &i: v) cin>>i;
    ll lb=(lower_bound(v.begin(),v.end(),x))-v.begin();// for calculating lb
    ll ub=(upper_bound(v.begin(),v.end(),x))-v.begin();// for calculating ub
    cout<<lb<<" "<<ub<<"\n";
    return 0;
  } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-09-04T12:45:34.830

Java 已经内置了二进制搜索功能，可以计算数组中元素的下限/上限，无需实现自定义方法。

当我们谈论上限/下限或相等范围时，我们总是指容器的索引（在这种情况下为 ArrayList），而不是包含的元素。让我们考虑一个数组（我们假设数组是排序的，否则我们先排序）：

```
List<Integer> nums = new ArrayList<>(Arrays.asList(2,3,5,5,7,9,10,18,22)); 
```

“下界”函数必须返回**数组的索引，**必须在其中插入元素以**保持数组排序**。“上限”必须返回**数组中最小元素的索引，即大于**查找的元素。例如

```
lowerBound(nums, 6) 
```

必须返回 3，因为 3 是数组的位置（从 0 开始计数），其中必须插入 6 以保持数组排序。

这

```
upperBound(nums, 6) 
```

必须返回 4，因为 4 是数组中**最小**元素的位置，即**大于**5 或​​ 6，（位置 4 上的数字 7）。

在标准库中的 C++ 中，这两种算法都已在标准库中实现。在 Java 中，您可以使用

```
Collections.binarySearch(nums, element) 
```

以**对数时间复杂度**计算位置。

如果数组包含元素，*Collections.binarySearch*返回元素的第一个索引（在上面的数组 2 中）。否则，它返回一个负数，指定下一个更大元素在数组中的位置，从数组**的最后一个索引开始倒数**。在此位置找到的数字是**数组中比**您要查找的元素大的最小元素。

例如，如果您调用

```
int idx = Collections.binarySearch(nums, 6) 
```

该函数返回-5。如果从数组的最后一个索引（-1、-2、...）倒数，索引 -5 指向数字 7——数组中大于元素 6 的最小数字。

结论：如果排序后的数组**中包含**查找的元素，则下限为该元素的位置，上限为下一个较大元素的位置。

如果数组**不包含**元素，则下界为位置

```
Math.abs(idx) - 2 
```

上限是位置

```
Math.abs(idx) - 1 
```

在哪里

```
idx = Collections.binarySearch(nums, element) 
```

请始终牢记边境案件。例如，如果您在上面指定的数组中查找 1：

```
idx = Collections.binarySearch(nums, 1) 
```

该函数返回-1。因此，upperBound = Math.abs(idx) - 1 = 0 - 位置 0 处的元素 2。但元素 1 没有下界，因为 2 是数组中的最小数字。相同的逻辑适用于大于数组中最大数字的元素：如果您查找数字 25 的下限/上限，您将得到

```
 idx = Collections.binarySearch(nums, 25) 
```

ix = -10。可以计算下界：lb = Math.abs(-10) - 2 = 8，也就是数组的最后一个索引，但是没有上界，因为22已经是数组中最大的元素，没有位置 9 的元素。

equal_range 指定数组的所有索引，范围从下限索引开始到（但不包括）上限。例如，上面数组中数字 5 的相等范围是索引

```
 [2,3] 
```

数字 6 的相等范围是空的，因为数组中没有数字 6。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-05-31T14:27:02.283

cpp 中的 Java 等价的 lower_bound 是

```
public static int lower(int arr[],int key){
    int low = 0;
    int high = arr.length-1;
    while(low < high){
        int mid = low + (high - low)/2;
        if(arr[mid] >= key){
            high = mid;
        }
        else{
            low = mid+1;
        }
    }
    return low;
} 
```

但是如果键不存在于数组中，上面的代码片段将给出下限

cpp中upper_bound的Java等价物是

```
public static int upper(int arr[],int key){
    int low = 0;
    int high = arr.length-1;
    while(low < high){
        int mid = low + (high - low+1)/2;
        if(arr[mid] <= key){
            low = mid;
        }
        else{
            high = mid-1;
        }
    }
    return low;
} 
```

但是如果键不存在于数组中，上面的代码片段将给出键的下限

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-24T21:08:45.267

你可以尝试这样的事情：

```
public class TestSOF {

    private ArrayList <Integer> testList = new ArrayList <Integer>();
    private Integer first, last;

    public void fillArray(){

        testList.add(10);
        testList.add(20);
        testList.add(30);
        testList.add(30);
        testList.add(20);
        testList.add(10);
        testList.add(10);
        testList.add(20);
    }

    public ArrayList getArray(){

        return this.testList;
    }

    public void sortArray(){

        Collections.sort(testList);
    }

    public void checkPosition(int element){

        if (testList.contains(element)){

            first = testList.indexOf(element);
            last = testList.lastIndexOf(element);

            System.out.println("The element " + element + "has it's first appeareance on position " 
        + first + "and it's last on position " + last);
        }

        else{

             System.out.println("Your element " + element + " is not into the arraylist!");
       }
    }

    public static void main (String [] args){

        TestSOF testSOF = new TestSOF();

        testSOF.fillArray();
        testSOF.sortArray();
        testSOF.checkPosition(20);
    } 
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-15T05:39:43.770

在二分查找中，当您找到元素时，您可以继续向其左侧进行二分搜索以找到第一个出现的位置，并继续向右进行二分搜索以找到最后一个元素。代码应该清楚这个想法：

```
/*
B: element to find first or last occurrence of
searchFirst: true to find first occurrence, false  to find last
 */
Integer bound(final List<Integer> A,int B,boolean searchFirst){
    int n = A.size();
    int low = 0;
    int high = n-1;
    int res = -1;   //if element not found
    int mid ;
    while(low<=high){
        mid = low+(high-low)/2;
        if(A.get(mid)==B){
            res=mid;
            if(searchFirst){high=mid-1;}    //to find first , go left
            else{low=mid+1;}                // to find last, go right
        }
        else if(B>A.get(mid)){low=mid+1;}
        else{high=mid-1;}
    }
    return res;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-17T12:19:15.207

如果您想在不定义自己的方法的情况下找到 lower_bound 并从头开始做所有事情，请使用以下代码片段。您可能已经注意到，此方法仅适用于原始数组，不适用于 ArrayList，因为我们在 Collections 类中没有指定 Binaryserach 的**开始**和**停止**索引的函数（从 java16 开始）。

*   al 是一个数组`(String[] al = new String[N];)`
*   `token`是我们在数组中寻找的。

```
Arrays.sort(al, 0, N); 
int index = Arrays.binarySearch(al, 0, N , token);
while(index > 0 && al[index].equals(al[index - 1])){
       index = Arrays.binarySearch(al, 0, index, token); //lower_bound in java.
} 
```

对于上限，您可以轻松修改代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-23T06:08:34.770

以这种方式尝试下限和上限。它很容易实现。

```
import java.util.Arrays;

class LowerBoundUpperBound{
    public static void main(String[] args) {
        int a[] = {1, 2, 3, 4, 5, 5, 5, 5, 5, 7, 7};

        int key = 5;
        int pos = Arrays.binarySearch(a, key);
        int lb = (pos < 0) ? ~pos - 1 : getlb(pos, a);
        int ub = (pos < 0) ? ~pos : getUb(pos, a);

        System.out.println("Lower Bound=" + lb);
        System.out.println("Upper Bound=" + ub);

        // You can also try on a[] = {1 ,2 ,3 ,4 ,5 ,6};
        // For key=5, lb=3 and ub=5

    }

    private static int getlb(int pos, int[] a) {
        while (pos - 1 >= 0 && a[pos] == a[pos - 1]) pos--;
        return pos - 1;
    }

    private static int getUb(int pos, int[] a) {
        while (pos + 1 < a.length && a[pos] == a[pos + 1]) pos++;
        return pos + 1;

    }
} 
```

**注意：**执行上述方法时必须对数组进行排序。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-08-21T19:34:58.773

```
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.util.Collections;
import java.util.Vector;

public class Bounds {

    public static void main(String[] args) throws IOException {
        Vector<Float> data = new Vector<>();
        for (int i = 29; i >= 0; i -= 2) {
            data.add(Float.valueOf(i));
        }
        Collections.sort(data);
        float element = 14;
        BufferedReader bf = new BufferedReader(new InputStreamReader(System.in));
        BufferedWriter log = new BufferedWriter(new OutputStreamWriter(System.out));
        String string = bf.readLine();
        while (!string.equals("q")) {
            element=Float.parseFloat(string);
            int first = 0;
            int last = data.size();
            int mid;
            while (first < last) {
                mid = first + ((last - first) >> 1); 
                if (data.get(mid) < element)  //lower bound. for upper use <= 
                    first = mid + 1; 
                else 
                    last = mid;
            }
            log.write("data is: "+data+"\n");
            if(first==data.size())
                first=data.size()-1;
            log.write("element is : " + first+ "\n");
            log.flush();
            string= bf.readLine();
        }
        bf.close();
    }

} 
```

这是类似于 c++ 的 lower_bound 和 upper_bound 的实现。请注意，您要搜索的元素不必出现在向量或列表中。这个实现只给出了元素的上限和下限。

# actionscript-3 - as3 带有触摸事件的对象的连续移动

> ID：15603835
> 
> 赞同：0
> 
> 时间：2013-03-24T20:50:34.203
> 
> 标签：actionscript-3, button, trace, touch-event, physics-engine

我正在尝试使用 actionscript 为我的 nexus 7 制作一个交互式场景。我正在尝试在按下按钮时让颈背身体连续移动。跟踪（event.target.name）；在点击处理程序中，按我的预期返回正在按下的按钮的实例名称，但是 enter_frame 按下函数中的相同跟踪语句正在返回按钮父名称，因此下面的移动没有​​发生是我的代码..

```
resetBtn.addEventListener(TouchEvent.TOUCH_BEGIN , tapHandler);
ballBtn.addEventListener(TouchEvent.TOUCH_BEGIN , tapHandler );
leftArrow.addEventListener(TouchEvent.TOUCH_BEGIN , tapHandler );
rightArrow.addEventListener(TouchEvent.TOUCH_BEGIN , tapHandler );

private function tapHandler(event:TouchEvent):void
{
    //listen for mouse up on the stage, in case the finger moved off of the button accidentally when they release.
    rightArrow.addEventListener(TouchEvent.TOUCH_END, endTouch);
    //while the mouse is down, run the tick function once every frame as per the project frame rate
        addEventListener(Event.ENTER_FRAME, pressed); 

    trace(event.target.name);           
    //ball.applyImpulse(new Vec2(25,0));
}

function endTouch(e:Event):void 
{
    removeEventListener(Event.ENTER_FRAME, pressed);  
    //stop running the tick function every frame now that the mouse is up
    this.removeEventListener(TouchEvent.TOUCH_END,endTouch); 
    //remove the listener for endTouch
}
function pressed(e:Event):void 
{
    space.step(1 / stage.frameRate);

    trace(e.target.name);           
    if(e.target.name == "leftArrow")
    {
        trace("going left");
        crane.position.x -=  5;
        boom.position.x -=  5;
        c.position.x -=  5;
    }
    if(e.target.name == "rightArrow")
    {
        trace("going Right");
        crane.position.x +=  5;
        boom.position.x +=  5;
        c.position.x +=  5;
    }
} 
```

如果您能帮我解决这个问题或提出更好的方法来实现这一点，我们将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T03:26:55.883

您的问题基本上是您将侦听器添加到 Enter_frame 事件的父级，因此该事件调度时的目标不是您想要的按钮。我认为与其移动侦听器，不如使用变量来保存对按钮的引用，如下所示：

```
private var curButton:Sprite;

resetBtn.addEventListener(TouchEvent.TOUCH_BEGIN , tapHandler);
ballBtn.addEventListener(TouchEvent.TOUCH_BEGIN , tapHandler );
leftArrow.addEventListener(TouchEvent.TOUCH_BEGIN , tapHandler );
rightArrow.addEventListener(TouchEvent.TOUCH_BEGIN , tapHandler );

private function tapHandler(event:TouchEvent):void
{
    curButton = event.target;
    curButton.addEventListener(TouchEvent.TOUCH_END, endTouch);

    addEventListener(Event.ENTER_FRAME, pressed); 
}

function endTouch(e:Event):void 
{
    trace("touch end received");
    removeEventListener(Event.ENTER_FRAME, pressed);  
    curButton.removeEventListener(TouchEvent.TOUCH_END, endTouch);
    curButton = null;
}
function pressed(e:Event):void 
{
    trace("currently pressed");
    space.step(1 / stage.frameRate);

    if(curButton == leftArrow)
    {
        trace("going left");
        crane.position.x -=  5;
        boom.position.x -=  5;
        c.position.x -=  5;
    }
    if(curButton == rightArrow)
    {
        trace("going Right");
        crane.position.x +=  5;
        boom.position.x +=  5;
        c.position.x +=  5;
    }
} 
```

好的，请参阅我上面的编辑，希望能帮助解决。此外，看起来您可能已经弄清楚了在定义变量时为其提供的实例名称，与 .name 属性或 .id 属性不同，实例名称在运行时不再可用（如果你真的想要，你可以使用 name 属性，但你必须自己填充它，通常最好只在代码中使用实例名称，因为这是在编译时检查的，并且不会产生额外的运行时高架）。

# css - 编译后登录表单出现奇怪的边框

> ID：15603838
> 
> 赞同：0
> 
> 时间：2013-03-24T20:50:46.297
> 
> 标签：css, compilation, sass

在 fork 一个 CodePen 之后，我重新设计了它的一部分，它在[CodePen](http://codepen.io/anon/pen/tpgJv)处完美呈现，但是通过 CodeKit 运行后，它看起来很奇怪，看到两个字段中间的边框了吗？

**编译的CSS：**

```
 * {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box; }

body {
  background: #E2E2E2;
  margin: 0;
  padding: 0;
  font-family: "Lato", sans-serif; }

.login-form-wrap {
  background: #8fc400;
  border: 1px solid #8fc400;
  box-shadow: 0 1px #8fc400 inset, 0 0 10px 5px rgba(0, 0, 0, 0.1);
  border-radius: 5px;
  position: relative;
  width: 360px;
  height: 380px;
  margin: 60px auto;
  padding: 50px 30px 0 30px;
  text-align: center; }
  .login-form-wrap:before {
    background: url(http://cs6265.userapi.com/u155567463/docs/ad0e8d87e888/OSX-Buttons.png);
    display: block;
    content: '';
    width: 58px;
    height: 19px;
    top: 10px;
    left: 10px;
    position: absolute; }
  .login-form-wrap > h1 {
    margin: 0 0 50px 0;
    padding: 0;
    font-size: 26px;
    color: #fff; }
  .login-form-wrap > h5 {
    margin-top: 40px; }
  .login-form-wrap > h5 > a {
    font-size: 14px;
    color: #fff;
    text-decoration: none;
    font-weight: 400; }

.login-form input[type="email"], .login-form input[type="password"] {
  width: 100%;
  border: 1px solid;
  outline: none;
  padding: 12px 20px;
  color: #424647;
  font-weight: 400;
  font-family: "Lato", sans-serif; }
.login-form input[type="email"] {

  border-radius: 4px 4px 0 0;
  padding-bottom: 13px;
  box-shadow: 0 -1px 0 #e0e0e0 inset, 0 1px 2px rgba(0, 0, 0, 0.23) inset; }
.login-form input[type="password"] {
  border-top: none;
  border-radius: 0 0 4px 4px;
  box-shadow: 0 -1px 2px rgba(0, 0, 0, 0.23) inset, 0 1px 2px rgba(255, 255, 255, 0.1); }
.login-form input[type="submit"] {
  font-family: "Lato", sans-serif;
  font-weight: 400;
  background: #e0e0e0;
  background: -moz-linear-gradient(top, #e0e0e0 0%, #cecece 100%);
  background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #e0e0e0), color-stop(100%, #cecece));
  background: -webkit-linear-gradient(top, #e0e0e0 0%, #cecece 100%);
  background: -o-linear-gradient(top, #e0e0e0 0%, #cecece 100%);
  background: -ms-linear-gradient(top, #e0e0e0 0%, #cecece 100%);
  background: linear-gradient(to bottom, #e0e0e0 0%, #cecece 100%);
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#e0e0e0', endColorstr='#cecece',GradientType=0 );
  display: block;
  margin: 20px auto 0 auto;
  width: 100%;
  border: none;
  border-radius: 3px;
  padding: 8px;
  font-size: 17px;
  color: #636363;
  text-shadow: 0 1px 0 rgba(255, 255, 255, 0.45);
  font-weight: 700;
  box-shadow: 0 1px 3px 1px rgba(0, 0, 0, 0.17), 0 1px 0 rgba(255, 255, 255, 0.36) inset; } 
```

**截屏：**

![截屏](../Images/8725f01a57b59dd60a216f5ad23f2943.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T21:49:22.100

添加`normalize.css`到您的项目中。

# c++ - 尝试/捕获以避免 .stackdump

> ID：15603843
> 
> 赞同：0
> 
> 时间：2013-03-24T20:51:06.827
> 
> 标签：c++, exception-handling, try-catch, python-extensions, stack-dump

在下面的代码中，我`try/catch`在 python 模块代码中使用。在该`try`块中，我有一个简单的错误（内存访问冲突）并试图捕获相应的异常并在不生成`.stackdump`文件的情况下安静地终止程序。然而，后者仍然生成，这意味着`try/catch`构造没有完成它的工作。`.stackdump`当遇到不正确的操作（如代码中的操作）时，如何避免生成文件并退出程序而不会出错？PS我正在用gcc和boost.python在cygwin中编译代码

有趣的是，它不仅适用于 case `x[3]=2`，而且适用于所有其他情况：例如`x[4]=2`or `x[20]=2`or ，显然，`x[2]=2`。

```
#include <boost/python.hpp>
#include <iostream>
#include <iomanip>
using namespace std;
using namespace boost::python;

class Hello
{
    std::string _msg;

public:

    Hello(std::string msg){_msg = msg;}

    void run(){
      try{  

        double* x;
        x = new double[3];
        x[3] = 2.0;
        delete [] x;

      }catch(...){  exit(0);   }

    }

};

BOOST_PYTHON_MODULE(xyz)
{
    class_<Hello>("Hello", init<std::string>())
        .def("run",&Hello::run)
    ;  

} 
```

**编辑：**

根据 Maciek 的建议，我尝试了以下技巧：

使信号处理函数抛出异常，但不退出

```
void sig_action(int signo) {
    std::cout << "SIGNAL " << signo << std::endl;
    throw 1;
//    exit(0);
} 
```

现在尝试在 try/catch 块中包含一个可能有问题的函数（信号函数放在类构造函数中）：

```
class Hello
{
    std::string _msg;

public:

    Hello(std::string msg){
    _msg = msg;
      signal(SIGABRT, sig_action);
      signal(SIGSEGV, sig_action);

    }
    void set(std::string msg) { this->_msg = msg; }
    std::string greet() { return _msg; }

    void run(){

      try{  
        double* x;
        x = new double[3];
        x[3] = 2.0;
        delete [] x;

      }catch(...){ cout<<"error in function run()\n"; exit(0);   }

    }

}; 
```

然而，这样的技巧并没有像我预期的那样起作用，它会产生以下输出：

```
SIGNAL 6
terminate called after throwing an instance of 'int'
SIGNAL 6
terminate called recursively
SIGNAL 6
terminate called recursively
....
(and many more times the same) 
```

所以抛出异常，但一切都在它被捕获之前完成。有没有办法在终止进程之前让它被捕获？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T22:32:08.227

在 linux 上，核心转储由信号处理程序生成，默认操作设置为`core`( `SIGABRT`, `SIGSEGV`, ...)。如果您想避免核心转储，您可以随时捕获/忽略这些信号。它也应该适用于 Cygwin `stackdumps`。但是您仍然可能会收到一些讨厌的消息作为输出。

**编辑：**

```
#include <signal.h>

// [...]

void sig_action(int signo) {
    std::cout << "SIGNAL " << signo << std::endl;
    exit(0);
}

int main(int argc, char* argv[]) {
    signal(SIGABRT, sig_action);
    signal(SIGSEGV, sig_action);

    Hello h("msg");
    h.run();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T20:55:42.660

您只能捕获抛出的异常。无效的指针访问不会引发异常，它只会导致未定义的行为，并且在您的特定情况下会导致堆栈转储。

如果你想捕捉这种情况的情况，使用`std::vector`和[`at`功能](http://en.cppreference.com/w/cpp/container/vector/at)来访问项目。`std::out_of_range`这将在与无效索引一起使用时抛出。但是，通常最好先避免此类访问的可能性，因为它们通常表明程序中存在错误，并且错误不应通过异常处理，应从代码中删除。

# c# - Silverlight 5 中 postAsync 上的便携式 Microsoft.Net.Http 对象引用错误

> ID：15603850
> 
> 赞同：0
> 
> 时间：2013-03-24T20:51:48.293
> 
> 标签：c#, silverlight

代码非常简单：

```
var http = new HttpClient();
var uri = new Uri(Application.Current.Host.Source, "/api/query");
var postContext = new StringContent("test");
var response = await http.PostAsync(uri, postContext); 
```

错误是：对象空引用

```
at System.Net.Http.DelegatingStream.get_CanSeek()
at System.Net.Http.StreamContent..ctor(Stream content, Int32 bufferSize)
at System.Net.Http.StreamContent..ctor(Stream content)
at System.Net.Http.HttpClientHandler.CreateResponseMessage(HttpWebResponse webResponse, HttpRequestMessage request)
at System.Net.Http.HttpClientHandler.TryGetExceptionResponse(WebException webException, HttpRequestMessage requestMessage, HttpResponseMessage& httpResponseMessage)
at System.Net.Http.HttpClientHandler.HandleAsyncException(RequestState state, Exception e)
at System.Net.Http.HttpClientHandler.GetResponseCallback(IAsyncResult ar)
at System.Net.Browser.BrowserHttpWebRequest.<>c__DisplayClass19.<InvokeGetResponseCallback>b__17(Object state2)
at System.Threading.QueueUserWorkItemCallback.WaitCallback_Context(Object state)
at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
at System.Threading.QueueUserWorkItemCallback.System.Threading.IThreadPoolWorkItem.ExecuteWorkItem()
at System.Threading.ThreadPoolWorkQueue.Dispatch()
at System.Threading._ThreadPoolWaitCallback.PerformWaitCallback() 
```

GetAsync 工作得很好。但是 PostAsync 崩溃了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:26:50.860

这是请求失败时 HttpWebRequest 的 Silverlight 浏览器实现中的一个错误（请注意堆栈中的 HandleAsyncException）。我们在 Microsoft.Net.Http 的较新版本中提供了一个解决方法，该版本应该很快就会发布。

现在您可以尝试在 SL 中使用不返回空流的客户端堆栈。 [http://msdn.microsoft.com/en-us/library/dd920295(v=VS.95).aspx](http://msdn.microsoft.com/en-us/library/dd920295(v=VS.95).aspx)

# linux - 部署 JSP 网站

> ID：15603860
> 
> 赞同：0
> 
> 时间：2013-03-24T20:52:22.590
> 
> 标签：linux, jsp, tomcat, web-hosting

我正在尝试部署我工作过的 jsp 网站。我在我的 Windows 机器上实现了它，并且在 PATH 变量中我有一些 bin 目录的路径，我想知道我应该将这个路径或目录放在我要部署到的服务器上的什么位置。

该服务器基于 linux，所以我不确定这是否会有所作为。

我上传了一个 WAR 文件

我试图将它放在 lib 目录中，但它不起作用。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:33:24.927

假设您在 Linux 服务器上安装了 Tomcat，那么您只需将 WAR 文件放在[Tomcat 文档](http://tomcat.apache.org/tomcat-7.0-doc/deployer-howto.html#Deployment_on_Tomcat_startup)`$CATALINA_BASE/webapps`中所述的目录中即可。

如果您没有安装 Tomcat，您可以按照 Tomcat 文档[设置指南](http://tomcat.apache.org/tomcat-7.0-doc/setup.html)或此[博客文章](http://www.davidghedini.com/pg/entry/install_tomcat_7_on_centos)进行操作。您还可以使用包管理器，例如[YUM](http://www.oracle-base.com/articles/linux/apache-tomcat-installation-on-linux.php)或[APT](http://www.mkyong.com/tomcat/how-to-install-tomcat-in-ubuntu/)，具体取决于服务器 Linux 发行版。

# jquery - 将其 ID 传递给 jQuery 对话框时，表单未定义

> ID：15603864
> 
> 赞同：0
> 
> 时间：2013-03-24T20:53:07.853
> 
> 标签：jquery

我正在尝试提交一个显示在 jQuery 对话框中的表单。但是，我无法将表单的 ID 传递到对话框窗口中。这是 Chrome 显示的输出：

[http://i.stack.imgur.com/1EIa1.png](http://i.stack.imgur.com/1EIa1.png)

我知道答案一定很明显，但我不知道为什么 JavaScript 函数不能使用“frmDecline1”？

```
$(function(){
        // Dialog           
        $('#dialog1').dialog({
            autoOpen: false,
            width: 500,
            modal: true,
            buttons: {
                "Ok": function() { 
                    frmDecline1.submit();
                    $(this).dialog("close"); 
                }, 
                "Cancel": function() { 
                    $(this).dialog("close"); 
                } 
            }
        });

        // Dialog Link
        $('#dialog_link1').click(function(){
            $('#dialog1').dialog('open');
            return false;
        }); 
    }); 
```

```
<div id="dialog1" title="Decline Record">
        <p>Please enter your reason for declining this record below</p>
        <form id="frmDecline1" name="frmDecline1" method="post" action="index.asp?decline=1,ClockNo=1,JobNo=1">
        <textarea name="txtDecline1" cols="40" rows="4"></textarea>
        <br>
      </form>
</div> 
```

`<a href='#' id='dialog_link1'> Decline </a> <br> <br>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:56:06.227

基本上你的select语句有点不对劲。

读这个：

[W3Schools jQuery 选择器](http://www.w3schools.com/jquery/jquery_ref_selectors.asp)

并改变这个：

```
frmDecline1.submit(); 
```

对此：

```
$("#frmDecline1").submit(); 
```

这是它的[小提琴](http://jsfiddle.net/hbmSW/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T21:00:48.117

您不能通过简单地创建一个名称与其匹配的变量来访问表单`id`。你有几个选择。

您可以通过 jQuery 访问表单：`$("#frmDecline1")`或者您可以通过纯 javascript 访问它：`document.forms["frmDecline1"];`

# c# - c# MVVM表示逻辑

> ID：15603867
> 
> 赞同：0
> 
> 时间：2013-03-24T20:53:26.860
> 
> 标签：c#, wpf, xaml, mvvm

我是新的 MVVM 模式。

该视图有一个登录按钮和一个进度条。

我有一个名为 LoginViewModel 的视图模型，它公开命令 LoginCommand 并连接到我的视图 LoginPage.xaml。

当登录命令被执行时，登录按钮应该被禁用并且进度条应该变得可见。

如果登录失败，则应启用登录按钮并隐藏进度条。

我不确定的是这个表示逻辑应该发生在哪里。它应该发生在视图模式还是页面后面的代码中？

目前我在视图模型上有一个名为 LoggingIn 的布尔属性，当登录过程开始时设置为 true，如果失败则设置为 false。此布尔值分别与按钮和进度条的 IsEnabled 和 Visibility 属性挂钩。

这对我来说是错误的，所以我尝试制作几个事件，OnBeginLogin 和 OnEndLogin 并将它们连接到页面后面的代码中，这些代码用于控制控件的视觉状态。然而，这需要比以前的解决方案更多的代码。

虽然我也可以在视图模型中公开两个特定于控件的属性，LoginButtonEnabled 和 ProgressBarVisible，以便我可以从视图模型控制视觉状态。但是，如果我添加一个取消按钮，那么我需要添加另一个名为 CancelButtonEnabled 的属性。

我认为不应在视图模型中处理表示逻辑，因此添加事件似乎是最好的解决方案，但我想知道最佳实践或标准/常用方法是什么？

此外，当登录成功时，是否应该在视图模型或页面后面的代码中处理将用户返回到上一页或另一个页面？再次我觉得这不是视图模型的东西，但我不确定。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:00:40.870

我不确定为什么你感觉不对，但你的第一种方法对我来说似乎是最正确的。视图模型正确地将应用程序的状态暴露给视图，然后您使用数据绑定来控制如何将其转换为表示。

# php - php语言系统

> ID：15603869
> 
> 赞同：0
> 
> 时间：2013-03-24T20:53:34.570
> 
> 标签：php

我正在尝试制作一个脚本来检查是否有定义调用，然后调用它并将其放入数组中。但问题是，如何检查是否有多个定义不同的结尾：在我的例子中：“Language_Array_Set_'.$i”。如果我声明了四个名称为“”Language_Array_Set_1,Language_Array_Set_2,Language_Array_Set_3,Language_Array_Set_4”的定义。调用它们并放入一个数组。

```
for($i = 0; $i < Language_Number; $i++) {
    if( defined ( string 'Language_Array_Set_'.$i ) ) {
        return $available = array( 'Language_Array_Set_'.$i => 'en', 'Language_Array_Set_'.$i => 'lt');         // lt, en means that example: Language_Array_Set_1 = en
    }
}
$result = array( 'en', 'lt' );  //what do i want to show me. 
```

问题我需要在哪里寻找或者你会在我的位置做什么或你会怎么做？感谢您的回答。

Language_Number 在它现在保存的另一个文件中定义为 number:2。

**k，这里：** 可能的输入是：

```
define( "Language_Array_Set_1", "en" );
define( "Language_Array_Set_2", "lt" ); 
```

...

输出：

```
return  array( en, lt ); 
```

它需要检查定义了多少个 Language_Array_Set_$number 并使用该数字创建一个数组。

**“Álvaro G. Vicario”**谢谢，但主要问题是如何在数组中添加三个字符串，如果有三个定义，如果两个然后两个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T22:41:30.070

我会做这样的事情：

```
<?php
//Example constants
define( "Language_Array_Set_1", "en" );
define( "Language_Array_Set_2", "lt" );

$definedConstants = get_defined_constants();
$languageArray = array();

foreach($definedConstants as $df => $value) {
    //If first part of constant is Language_Array_Set_ then add
    //defined constant into array $languageArray
    if (substr($df,0,19) == 'Language_Array_Set_') {
        $languageArray[] = $df;
    }

}

//Output relevant information
echo 'lang array=' . print_r($languageArray,true);

$nrOfLanguages = count($languageArray);
echo 'Nr of languages=' . $nrOfLanguages;

?> 
```

*输出将是：*

lang array=Array ( [0] => Language_Array_Set_1 [1] => Language_Array_Set_2 ) 语言数=2

# css - 更高级别的 CSS 动画库？

> ID：15603877
> 
> 赞同：1
> 
> 时间：2013-03-24T20:54:42.800
> 
> 标签：css, css-transitions

我环顾四周，但找不到任何用于制作更高级别动画的好资源（如卡片翻转、立方体等）。就像 ???:CSS :: jQuery:JS。

我知道[过境](http://ricostacruz.com/jquery.transit/)，但我正在寻找具有更多功能和内置动画的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:57:26.107

您是否考虑过使用[Animate.css](http://daneden.me/animate/)？看起来还不错。另一个不错的似乎是[CSS3 Animations](https://developer.mozilla.org/en-US/demos/detail/css3-animations-plugin/launch)和卡片翻转、[CSS3 Playground](http://css3playground.com/)之类的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T21:10:04.100

此版本的编辑版本：[http](http://css3.bradshawenterprises.com/flip/) ://css3.bradshawenterprises.com/flip/ ：

JSfiddle：http: [//jsfiddle.net/PnUHr/1/](http://jsfiddle.net/PnUHr/1/)

**CSS**

```
#f1_container {
    position: relative;
    margin: 10px auto;
    width: 450px;
    height: 281px;
    z-index: 1;
}
#f1_container {
    -webkit-perspective: 1000;
    perspective: 1000;
}
#f1_card {
    width: 100%;
    height: 100%;
    -webkit-transform-style: preserve-3d;
    -webkit-transition: all 1.0s linear;
    transform-style: preserve-3d;
    transition: all 1.0s linear;
}
#f1_container:hover #f1_card {
    -webkit-transform: rotateY(180deg);
    transform: rotateY(180deg);
    box-shadow: -5px 5px 5px #aaa;
}
.face {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
}
.face.back {
    display: block;
    -webkit-transform: rotateY(180deg);
    transform: rotateY(180deg);
    box-sizing: border-box;
    color: white;
    text-align: center;
    background-color: #aaa;
} 
```

**HTML**

```
<div id="f1_container">
    <div id="f1_card" class="shadow">
        <div class="front face">
            <img src="Cirques.jpg"/>
        </div>
        <div class="back face center">
            <img src="Cirques.jpg" style="transform:scaleX(-1), transform:scaleY(-1)"/>
        </div>
    </div>
</div> 
```

所有学分都归于原始创建（见链接）。我刚刚删除了背面的填充`<div>`并添加了正面图像的镜像背景。

对于 Mozilla/Gecko 浏览器，您还需要添加`-moz-*`前缀。Opera ( `-o-*) and Internet Explorer (`-ms-*`) 也是如此。

直接图片链接：[http ://css3.bradshawenterprises.com/images/Cirques.jpg](http://css3.bradshawenterprises.com/images/Cirques.jpg)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-12T17:28:02.453

[Efeckt.css 仍在](http://h5bp.github.io/Effeckt.css/dist/)进行中，但看起来很有希望——一个包含多个源的模式库。

# unit-testing - 来自默认 ASP.Net MVC 4 应用程序项目的单元测试 AccountController

> ID：15603879
> 
> 赞同：1
> 
> 时间：2013-03-24T20:54:56.907
> 
> 标签：unit-testing, asp.net-mvc-4, simplemembership

我正在开发 MVC4 应用程序，并有兴趣创建一组控制器单元测试。我从 AccountController 对方法进行单元测试的所有尝试都以与`WebMatrix.WebData.WebSecurity:`

**要调用此方法，“Membership.Provider”属性必须是“ExtendedMembershipProvider”的一个实例。**

我正在使用`SimpleMemebership`正在通过初始化的提供程序`InitializeSimpleMembershipAttribute`

有人可以提供如何正确执行此操作的指导吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T13:44:01.223

我会放弃它作为答案，因为这会在评论中变得非常难看。我所做的是在我的测试项目中添加一个membershipprovider。我有一个自定义成员资格提供程序，但在您的情况下，app.config 看起来像这样：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.web>
    <membership defaultProvider="SimpleMembershipProvider">
      <providers>
        <clear/>
        <add name="SimpleMembershipProvider"
             type="WebMatrix.WebData.SimpleMembershipProvider, WebMatrix.WebData"/>
      </providers>
    </membership>
  </system.web>
</configuration> 
```

您可能会收到有关缺少 WebMatrix 参考的投诉。添加以下引用：

*   网络矩阵数据
*   WebMatrix.WebData

将副本设置为本地到`true`.

然后确保你打电话给`WebSecurity.InitializeDatabaseConnection`你，你很高兴。

希望这可以帮助。

# svn - 颠覆：如何检索当前更改列表名称列表？

> ID：15603881
> 
> 赞同：1
> 
> 时间：2013-03-24T20:55:07.897
> 
> 标签：svn

通过 创建多个变更列表后`svn changelist`，如何查看我创建的所有变更列表的名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T21:11:58.763

您可以使用`svn status`. 如果您只想要名称，请使用 grep 开头的行`--- Changelist`，例如：

```
svn status | grep "^\-\-\- Changelist" 
```

# c - C中哈希表的时间复杂度

> ID：15603889
> 
> 赞同：3
> 
> 时间：2013-03-24T20:55:30.677
> 
> 标签：c, data-structures, hashtable, big-o

我对哈希表的概念相当陌生，而且我一直在阅读不同类型的哈希表查找和插入技术。

我想知道线性探测、链接和二次探测的时间复杂度之间有什么区别？

我主要对哈希表中节点的插入、删除和搜索感兴趣。因此，如果我将每个进程的系统时间（插入/搜索/删除进程）与进程号绘制成图表，这些图表会有什么不同？

我猜测： - 二次探测将是最坏情况 O(nlogn) 或 O(logn) 进行搜索 - 线性探测将是最坏情况 O(n) 进行搜索 - 不确定但我认为 O(n^2 ) 用于链接

有人可以证实这一点吗？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-24T21:02:48.177

由于各种原因，准确分析所有这些不同的散列方案实际上*非常困难。*首先，除非你对你的散列函数做出非常强的假设，否则很难准确地分析这些散列方案的行为，因为不同类型的散列函数会导致不同的性能。其次，与处理器缓存的交互意味着某些在理论上稍差的哈希表实际上可以胜过理论上稍好一些的哈希表，因为它们的访问模式更好。

如果您假设您的散列函数看起来像一个真正的随机函数，并且如果您将散列表中的负载因子保持在最多一个常数，那么所有这些散列方案都需要 O(1) 的查找时间。换句话说，每个方案，按照预期，只需要您执行恒定数量的查找来找到任何特定元素。

从理论上讲，线性探测比二次散列和链式散列要差一些，因为除非散列函数具有强大的理论特性，否则元素往往会聚集在彼此附近。然而，在实践中，由于引用的局部性，它可能非常快：所有查找往往彼此接近，因此发生的缓存未命中率较低。二次探测具有较少的碰撞，但没有那么好的局部性。链式哈希往往具有极少的冲突，但往往具有较差的引用局部性，因为链式元素通常不是连续存储的。

在最坏的情况下，所有这些数据结构都可能需要 O(n) 时间来进行查找。这种情况发生的可能性极小。在线性探测中，这将要求所有元素连续存储而没有间隙，并且您必须查找第一个元素中的一个。使用二次散列，你必须有一组看起来很奇怪的桶才能获得这种行为。使用链式哈希，您的哈希函数必须将每个元素转储到同一个桶中，以获得绝对最坏情况的行为。所有这些都是指数级不可能的。

简而言之，如果你选择这些数据结构中的任何一个，除非你有一个非常糟糕的哈希函数，否则你不太可能被严重烧毁。我建议使用链式哈希作为默认值，因为它具有良好的性能并且不会经常遇到最坏情况的行为。如果你知道你有一个很好的哈希函数，或者有一个小的哈希表，那么线性探测可能是一个不错的选择。

希望这可以帮助！

# mysql - 交叉表查询

> ID：15603893
> 
> 赞同：1
> 
> 时间：2013-03-24T20:55:56.973
> 
> 标签：mysql, sql

我想将不同的值计为分数。我要计算的值是 7 到 10。表中也有 1 到 6，但我不想计算它们。我做错了。

表中的值如下所示：

```
RPO RSP RSV  
10 9 9
9 10 8
10 7 7
7 10 8
4 4 3

```

我希望结果如下所示：

```
评分 RPO RSP RSV
10 2 2 0
9 1 1 1
7 1 1 1

```

这是我的代码。需要改进它。

```
select  

count(rank.rpo) as RPO,
count(rank.rsp) as RSP,
count(rank.rsv) as RSV

from
round 
left join base 
on round.id = base.round_id 

left join rank 
on round.id = rank.round_id and rank.number = base.number

where 
base.result = 1 
and round.round_date between '2013-03-15' and '2013-03-22'
and round.gameform = 'V4'
and round.gameform not like "OSPEC"

group by ?? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T21:08:57.517

你可以尝试这样的事情：

```
drop table if exists ids;

create table ids (score int unsigned primary key)
select distinct rpo as score from rank
union
select distinct rsp as score from rank
union
select distinct rsv as score from rank;

select ids.score,
       sum(if(rank.rpo=ids.score,1,0)) as RPO,
       sum(if(rank.rsp=ids.score,1,0)) as RSP,
       sum(if(rank.rsv=ids.score,1,0)) as RSV
  from ids,round 
left join base on round.id = base.round_id 
left join rank on round.id = rank.round_id and rank.number = base.number
 where base.result = 1 
   and round.round_date between '2013-03-15' and '2013-03-22'
   and round.gameform = 'V4'
   and round.gameform not like "OSPEC"
   group by ids.score with rollup; 
```

如果您不想创建临时表，可以尝试：

```
select ids.score,
       sum(if(rank.rpo=ids.score,1,0)) as RPO,
       sum(if(rank.rsp=ids.score,1,0)) as RSP,
       sum(if(rank.rsv=ids.score,1,0)) as RSV
  from 
  (
      select distinct rpo as score from rank
      union
      select distinct rsp as score from rank
      union
      select distinct rsv as score from rank
  ) ids, round 
left join base on round.id = base.round_id 
left join rank on round.id = rank.round_id and rank.number = base.number
 where base.result = 1 
   and round.round_date between '2013-03-15' and '2013-03-22'
   and round.gameform = 'V4'
   and round.gameform not like "OSPEC"
group by ids.score with rollup; 
```

有关工作示例，请参见[http://sqlfiddle.com/#!2/9b7d7/6 。](http://sqlfiddle.com/#!2/9b7d7/6)

# c++ - Wt 编译问题

> ID：15603899
> 
> 赞同：0
> 
> 时间：2013-03-24T20:56:11.600
> 
> 标签：c++, compilation, compiler-errors, wt

我开始学习如何编写 Wt 应用程序，但我收到一个编译错误，我不知道如何修复。编译时，我收到一条错误消息

```
g++ -lwthttp -lwt hello.cpp
/usr/bin/ld: /usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to symbol '_ZN5boost7signals6detail16signal_base_impl12connect_slotERKNS_3anyERKNS1_12stored_groupENS_10shared_ptrINS1_9slot_base6data_tEEENS0_16connect_positionE'
/usr/bin/ld: note: '_ZN5boost7signals6detail16signal_base_impl12connect_slotERKNS_3anyERKNS1_12stored_groupENS_10shared_ptrINS1_9slot_base6data_tEEENS0_16connect_positionE' is defined in DSO /usr/lib/libboost_signals.so.1.52.0 so try adding it to the linker command line
/usr/lib/libboost_signals.so.1.52.0: could not read symbols: Invalid operation
collect2: error: ld returned 1 exit status 
```

我正在运行最新版本的 Arch Linux，如果它有任何用处的话。另外，这是我要编译的应用程序。

```
#include <Wt/WApplication>
#include <Wt/WBreak>
#include <Wt/WContainerWidget>
#include <Wt/WLineEdit>
#include <Wt/WPushButton>
#include <Wt/WText>

class HelloApplication : public Wt::WApplication {
  public:
    HelloApplication(const Wt::WEnvironment& env);

  private:
    Wt::WLineEdit *nameEdit_;
    Wt::WText     *greeting_;

    void greet();
};

HelloApplication::HelloApplication(const Wt::WEnvironment& env) : Wt::WApplication(env) {
  setTitle("Hello world");

  root()->addWidget(new Wt::WText("What is your name? "));
  nameEdit_ = new Wt::WLineEdit(root());
  Wt::WPushButton *button = new Wt::WPushButton("Greet me.", root());
  root()->addWidget(new Wt::WBreak());
  greeting_ = new Wt::WText(root());
  button->clicked().connect(this, &HelloApplication::greet);
}

void HelloApplication::greet() {
  greeting_->setText("Hello there, " + nameEdit_->text());
}

Wt::WApplication *createApplication(const Wt::WEnvironment& env) {
  return new HelloApplication(env);
}

int main(int argc, char **argv) {
  return Wt::WRun(argc, argv, &createApplication);
} 
```

更新信息：如果我链接 libboost_signals 库，则会收到以下控制台输出。

```
 g++ hello.cpp -lwt -lwthttp -lboost_signals

/usr/bin/ld: warning: libGraphicsMagick.so.3, needed by /usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so, not found (try using -rpath or -rpath-link)
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawPathCurveToQuadraticBezierAbsolute'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetStrokeWidth'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetClipUnits'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `SetImageType'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetStrokeColor'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `GetDrawInfo'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawDestroyContext'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawPathLineToAbsolute'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawAnnotation'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `ReadInlineImage'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawPathStart'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetClipPath'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `SetImagePixels'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetStrokeOpacity'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawPopClipPath'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetFillOpacity'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetStrokeAntialias'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawPopGraphicContext'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `SyncImagePixels'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DestroyImage'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawPushGraphicContext'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawLine'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawRender'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DestroyMagick'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawPathCurveToAbsolute'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `ConstituteImage'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetFontSize'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `GetExceptionInfo'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `GetImagePixels'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetStrokeDashArray'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `ImageToBlob'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `ReadImage'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `SetImageOpacity'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawPathMoveToAbsolute'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawPushClipPath'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `CropImage'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetFillRule'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawPathFinish'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `GetImageInfo'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetFillColor'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetFont'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawArc'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawAffine'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DestroyDrawInfo'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawClipPath'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetTextEncoding'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `SetImageClipMask'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawComposite'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawPathEllipticArcAbsolute'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawAllocateContext'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetStrokeLineCap'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `InitializeMagick'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `DrawSetGravity'
/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../libwt.so: undefined reference to `CompositeImage'
collect2: error: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T22:10:08.317

事实证明，AUR 上列出了一些可选依赖项，这些依赖项是正确编译所必需的。它们在此处列出

```
https://www.archlinux.org/packages/community/i686/wt/ 
```

此外，按照此处找到的教程进行操作时

```
http://www.webtoolkit.eu/wt/src/hello 
```

您必须包括

```
-lboost_signals 
```

编译时标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T22:12:48.957

提示在错误信息中，您需要安装 libgraphicsmagick。

所有未定义的引用都在这个库中。

这是成功链接程序的 ldd 输出。我用了`-lwthttp -lwt -lboost_signals`

```
 linux-gate.so.1 =>  (0xb770f000)
    libwthttp.so.32 => /usr/lib/libwthttp.so.32 (0xb7629000)
    libwt.so.32 => /usr/lib/libwt.so.32 (0xb6fe3000)
    libboost_signals.so.1.49.0 => /usr/lib/libboost_signals.so.1.49.0 (0xb6fce000)
    libstdc++.so.6 => /usr/lib/i386-linux-gnu/libstdc++.so.6 (0xb6ee2000)
    libm.so.6 => /lib/i386-linux-gnu/i686/cmov/libm.so.6 (0xb6ebc000)
    libgcc_s.so.1 => /lib/i386-linux-gnu/libgcc_s.so.1 (0xb6e9f000)
    libc.so.6 => /lib/i386-linux-gnu/i686/cmov/libc.so.6 (0xb6d3c000)
    libz.so.1 => /lib/i386-linux-gnu/libz.so.1 (0xb6d22000)
    libssl.so.1.0.0 => /usr/lib/i386-linux-gnu/i686/cmov/libssl.so.1.0.0 (0xb6cca000)
    libcrypto.so.1.0.0 => /usr/lib/i386-linux-gnu/i686/cmov/libcrypto.so.1.0.0 (0xb6b0b000)
    libboost_program_options.so.1.49.0 => /usr/lib/libboost_program_options.so.1.49.0 (0xb6aaf000)
    libpthread.so.0 => /lib/i386-linux-gnu/i686/cmov/libpthread.so.0 (0xb6a96000)
    libboost_system.so.1.49.0 => /usr/lib/libboost_system.so.1.49.0 (0xb6a91000)
    libboost_thread.so.1.49.0 => /usr/lib/libboost_thread.so.1.49.0 (0xb6a78000)
    libboost_regex.so.1.49.0 => /usr/lib/libboost_regex.so.1.49.0 (0xb6968000)
    libboost_date_time.so.1.49.0 => /usr/lib/libboost_date_time.so.1.49.0 (0xb6959000)
    libboost_filesystem.so.1.49.0 => /usr/lib/libboost_filesystem.so.1.49.0 (0xb693a000)
    libhpdf-2.2.1.so => /usr/lib/libhpdf-2.2.1.so (0xb6887000)
    libGraphicsMagick.so.3 => /usr/lib/libGraphicsMagick.so.3 (0xb6560000)
    libpangoft2-1.0.so.0 => /usr/lib/i386-linux-gnu/libpangoft2-1.0.so.0 (0xb6532000)
    libpango-1.0.so.0 => /usr/lib/i386-linux-gnu/libpango-1.0.so.0 (0xb64e6000)
    libgobject-2.0.so.0 => /usr/lib/i386-linux-gnu/libgobject-2.0.so.0 (0xb6494000)
    libglib-2.0.so.0 => /lib/i386-linux-gnu/libglib-2.0.so.0 (0xb6396000)
    librt.so.1 => /lib/i386-linux-gnu/i686/cmov/librt.so.1 (0xb638d000)
    /lib/ld-linux.so.2 (0xb7710000)
    libdl.so.2 => /lib/i386-linux-gnu/i686/cmov/libdl.so.2 (0xb6389000)
    libicuuc.so.48 => /usr/lib/i386-linux-gnu/libicuuc.so.48 (0xb621f000)
    libicui18n.so.48 => /usr/lib/i386-linux-gnu/libicui18n.so.48 (0xb6044000)
    libicudata.so.48 => /usr/lib/i386-linux-gnu/libicudata.so.48 (0xb4ed3000)
    libpng12.so.0 => /lib/i386-linux-gnu/libpng12.so.0 (0xb4ea9000)
    libjbig.so.0 => /usr/lib/i386-linux-gnu/libjbig.so.0 (0xb4e9b000)
    liblcms.so.1 => /usr/lib/i386-linux-gnu/liblcms.so.1 (0xb4e60000)
    libtiff.so.4 => /usr/lib/i386-linux-gnu/libtiff.so.4 (0xb4df9000)
    libfreetype.so.6 => /usr/lib/i386-linux-gnu/libfreetype.so.6 (0xb4d5d000)
    libjasper.so.1 => /usr/lib/i386-linux-gnu/libjasper.so.1 (0xb4d06000)
    libjpeg.so.8 => /usr/lib/i386-linux-gnu/libjpeg.so.8 (0xb4ccd000)
    libwmflite-0.2.so.7 => /usr/lib/i386-linux-gnu/libwmflite-0.2.so.7 (0xb4caf000)
    libXext.so.6 => /usr/lib/i386-linux-gnu/libXext.so.6 (0xb4c9c000)
    libSM.so.6 => /usr/lib/i386-linux-gnu/libSM.so.6 (0xb4c94000)
    libICE.so.6 => /usr/lib/i386-linux-gnu/libICE.so.6 (0xb4c7b000)
    libX11.so.6 => /usr/lib/i386-linux-gnu/libX11.so.6 (0xb4b43000)
    libbz2.so.1.0 => /lib/i386-linux-gnu/libbz2.so.1.0 (0xb4b32000)
    libxml2.so.2 => /usr/lib/i386-linux-gnu/libxml2.so.2 (0xb49de000)
    libgomp.so.1 => /usr/lib/i386-linux-gnu/libgomp.so.1 (0xb49ce000)
    libltdl.so.7 => /usr/lib/i386-linux-gnu/libltdl.so.7 (0xb49c4000)
    libgmodule-2.0.so.0 => /usr/lib/i386-linux-gnu/libgmodule-2.0.so.0 (0xb49bf000)
    libfontconfig.so.1 => /usr/lib/i386-linux-gnu/libfontconfig.so.1 (0xb4989000)
    libgthread-2.0.so.0 => /usr/lib/i386-linux-gnu/libgthread-2.0.so.0 (0xb4985000)
    libffi.so.5 => /usr/lib/i386-linux-gnu/libffi.so.5 (0xb497c000)
    libpcre.so.3 => /lib/i386-linux-gnu/libpcre.so.3 (0xb493e000)
    libuuid.so.1 => /lib/i386-linux-gnu/libuuid.so.1 (0xb4938000)
    libxcb.so.1 => /usr/lib/i386-linux-gnu/libxcb.so.1 (0xb4914000)
    liblzma.so.5 => /lib/i386-linux-gnu/liblzma.so.5 (0xb48ed000)
    libexpat.so.1 => /lib/i386-linux-gnu/libexpat.so.1 (0xb48c3000)
    libXau.so.6 => /usr/lib/i386-linux-gnu/libXau.so.6 (0xb48c0000)
    libXdmcp.so.6 => /usr/lib/i386-linux-gnu/libXdmcp.so.6 (0xb48ba000) 
```

# facebook - 如何在 Facebook 帖子中创建锚文本链接

> ID：15603902
> 
> 赞同：4
> 
> 时间：2013-03-24T20:56:35.323
> 
> 标签：facebook, hyperlink

如何在 Facebook 粉丝专页帖子中创建带有锚文本的文本链接？它之所以有效，是因为我看到很多包含此类链接的帖子，甚至在评论中也是如此。

我已经尝试过了，但它不起作用：

```
<a href="http://www.mysite.com">Anchor Text</a> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-06-22T16:08:42.230

两种情况：

帖子：不可能。只能有非常基本的 HTML 格式：粗体、斜体、删除线、下划线。

[备注](https://www.facebook.com/help/488014787881885/)：可能。相当多的 HTML 允许。通过在搜索字段中输入“我的笔记”进行访问。点击。编辑您的笔记并将其作为帖子发布。

* * *

## 回答 #2

> 赞同：-6
> 
> 时间：2013-10-21T09:53:02.490

最简单的照片教程解决方案请参见>> [如何在 Facebook 上创建指向锚文本的超链接](http://www.araddho.com/how-to-create-hyperlinks-to-anchor-text-on-facebook/)

# css - div位置内的css div

> ID：15603905
> 
> 赞同：0
> 
> 时间：2013-03-24T20:57:01.993
> 
> 标签：css, css-float, html

我有一个 div 主容器，其中包含 3 个其他 div 容器。

我希望 3 个子 div 保持居中并且始终处于相同的高度（在父 div 的顶部）。

我的问题是当我调整窗口浏览器的大小时，子 div 位于另一个之下。我不想要这个。

我还为 768px 以下添加了一个 CSS 条件。在这种情况下，我希望子 div 位于其他 div 之下。

这是一个小提琴示例： http: [//fiddle.jshell.net/mCXWs/](http://fiddle.jshell.net/mCXWs/)

在这个小提琴中，蓝色 div 位于绿色下方，黄色位于蓝色下方，用于 768 像素以上的窗口浏览器。我不想要这个结果。我希望保持在同一高度（顶部：0；）

我不知道该怎么办 ...

对不起英语，我是法国人

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T21:22:19.513

*   3块总是相同的高度？使用**CSS**表格布局：`display: table`和`display: table-cell`(IE8+)
*   a（块显示为a）“单元格”永远不会低于另一个“单元格”，问题已经解决（编辑：在同一隐式行中）
*   水平居中？`margin: 0 auto;`在容器上使用
*   在父 div 的顶部？使用`vertical-align: top`.
*   在 768px 下（在 MQ @-rule 中），只需覆盖`table(-cell)`，`display: block`div 将表现得像默认 div，一个在另一个之下。也许您还必须覆盖最小/最大高度。
*   尽可能避免`overflow: hidden`和（好吧，使用表格......）`position: relative`

工作示例： http: [//fiddle.jshell.net/EEEjg/1/](http://fiddle.jshell.net/EEEjg/1/)

# c++ - c++ winapi SHBrowseForFolder 浏览隐藏文件夹

> ID：15603910
> 
> 赞同：1
> 
> 时间：2013-03-24T20:57:27.607
> 
> 标签：c++, winapi

当我用 SHBrowseForFolder 打开一个对话框时，我希望它也能浏览隐藏文件夹（隐藏文件夹出现在对话框中）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:42:53.420

`SHBrowseForFolder`不显示隐藏文件夹。您将需要使用`FolderView`控件或使用`FindFirst/FindNext`.

# django - 使用“mark_safe”时的 Django 文本文件上传和安全性

> ID：15603913
> 
> 赞同：1
> 
> 时间：2013-03-24T20:57:34.643
> 
> 标签：django, django-templates

我正在开发一个用户上传空格/制表符/逗号分隔的文本文件的 Django 应用程序。我在浏览器中显示文本，然后用户可以交互地解析分隔值列，这些列在更改设置时会用 css 突出显示。（只显示一个样本而不是整个文件！）

为了突出显示选择，我在文本中和文本周围插入 html/css 代码，但必须“标记安全”文本以使 html/css 呈现。我认为这会引发安全问题，因为即使是我，一个完整的菜鸟也可以在我的输入文件中插入 html 并让它呈现。

我的问题：在我上传后和在浏览器中呈现它之前，我可以使用什么东西来立即从文本文件中删除 html 吗？剥离'<'和'>'就足够了吗？如果需要禁用 .js 怎么办？

我了解关于文件上传，我可以采取其他有据可查的安全措施。但是，我正在解决与我“marking_safe”相关的具体问题，然后将输入文本呈现给浏览器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T22:34:46.340

Django 已经为此提供了[自动 HTML 转义功能。](https://docs.djangoproject.com/en/dev/topics/templates/#automatic-html-escaping)看看我在文档中发布的链接。希望这可以帮助。

# scala - Scala 泛型自身类型不匹配

> ID：15603920
> 
> 赞同：0
> 
> 时间：2013-03-24T20:58:54.660
> 
> 标签：scala, generics, self-type

我正在尝试将 Scala 的蛋糕模式与具有多个组（层）的通用拦截器一起使用。当一层的末尾需要另一层时，我尝试使用 self 类型来表达。但它因非法继承而失败。该任务的一般背景是我有一个文档模型，我正在尝试在其上进行验证链。玩具示例如下，每一层仅由一个特征表示。

```
trait Element
trait Leaf extends Element
trait Composed extends Element

trait Validator [A] {def validate (element : A) : String}

//second layer
trait LeafValidator extends Validator[Leaf]{
  override def validate (element : Leaf) : String = "leaf"}

//first layer
trait ElementValidator extends Validator[Element]{
  self : Validator[Leaf] =>

  override def validate (element : Element) : String = element match {
    case leaf : Leaf => super.validate(leaf)
    case _ => "other"
  }
}

case class Concrete extends LeafValidator with ElementValidator 
```

错误在实例化线上

> 非法继承；self-type apltauer.david.util.Concrete 不符合 apltauer.david.util.ElementValidator 的 selftype apltauer.david.util.ElementValidator 和 apltauer.david.util.Validator[apltauer.david.util.Leaf] Main.scala / Dependency/src/apltauer/david/util 第 56 行 Scala 问题

逆变抑制了错误，但并没有解决问题，因为此时 self 类型是无用的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-03T13:54:50.010

我有同样的问题。使用两种功能变体打破了（否则，很好和有用的）蛋糕模式。

所以我开发了一个增强功能，就我的问题而言，它允许我保持蛋糕图案完整，我称之为**Feature Pattern**。在你的情况下：

```
trait element_validator extends validator[Element] {
   final override val element_validator = this
}
trait feature_element_validator { val element_validator : element_validator }

/* Analogous for “Leaf” */

trait validator[element_type] {
   final override val validator = this
   /* Feature code here: */
   def validate(element: element_type) = /* … */
}
trait feature_validator[element_type] { val validator : validator[element_type] } 
```

所以现在可以说：

```
object component
   extends element_validator
   with leaf_validator
   with other_cake_feature_1
   with other_cake_feature_2
   with other_cake_feature_3
   /* etc. */ 
```

内部组件一将区分两种验证器：

```
element_validator.validate(…)
leaf_validator.validate(…) 
```

如果只有一个需要，则导入（这与使用自类型注释来获取名称的可用性具有相同的效果）：

```
import element_validator._
validate(…) 
```

我知道，这是相当一些样板。但是，除了将蛋糕与组合物结合起来（只要需要组合物时），我没有看到任何其他解决方案。

# ruby - 调试器（Intellij IDEA）在遇到断点（黄瓜、红宝石、rspec、水豚）时失败

> ID：15603921
> 
> 赞同：2
> 
> 时间：2013-03-24T20:58:58.227
> 
> 标签：ruby, intellij-idea, cucumber, jruby

尝试在 IntelliJ(11.1.5) 中调试黄瓜场景时，它在遇到第一个断点时失败并出现以下错误。如果我删除所有断点，它将成功运行。

```
gem list
capybara (2.0.2, 1.1.4)
cucumber (1.2.3, 1.2.1)
rspec (2.13.0)
ruby-debug-base (0.10.3.4 java)
ruby-debug-ide (0.4.17.beta9) 
```

* * *

```
Testing started at 1:12 PM ...
Fast Debugger (ruby-debug-ide 0.4.17.beta9, ruby-debug-base 0.10.3.4) listens on 127.0.0.1:60409
Using the default profile...
file:/Users/user1456/.rvm/rubies/jruby-1.7.2/lib/jruby.jar!/jruby/java/java_package_module_template.rb:11 warning: `eval' should not be aliased
including Capybara::DSL in the global scope is not recommended!
/Users/user1456/.rvm/gems/jruby-1.7.2@andise-payables/gems/cucumber-1.2.3/bin/../lib/cucumber/parser/gherkin_builder.rb:120 warning: singleton on non-persistent Java type Java::JavaUtil::ArrayList (http://wiki.jruby.org/Persistence)
Tags: @@ITPAY-433, @@sai

    Given I have connected to 'chartofaccounts' collection                            # step_definitions/api/chartofaccounts.rb:4

    Then the total count of 'COA' records should be '38'                              # step_definitions/api/chartofaccounts.rb:20

    When I search for '<brand_id>' / '<market_id>' / '<chnl_id>' in 'COA'             # step_definitions/api/chartofaccounts.rb:12

    Then the 'fcCoa' string recorded should be '<fc_coa>'                             # step_definitions/api/chartofaccounts.rb:24

    And the 'nfcCoa' string recorded should be '<nfc_coa>'                            # step_definitions/api/chartofaccounts.rb:24

    And the 'nfcCoaExtAgentCommisison' string recorded should be '<nfc_ext_agcm_coa>' # step_definitions/api/chartofaccounts.rb:24

Java::JavaLang::NoSuchMethodError: org.jruby.runtime.DynamicScope.getEvalScope()Lorg/jruby/runtime/DynamicScope;
org.jruby.debug.Context.contextCopyLocals(Context.java:407)
org.jruby.debug.Context.frame_locals(Context.java:284)
org.jruby.debug.Context$INVOKER$i$1$0$frame_locals_DBG.call(Context$INVOKER$i$1$0$frame_locals_DBG.gen)
org.jruby.internal.runtime.methods.JavaMethod$JavaMethodOneOrNBlock.call(JavaMethod.java:331)
Skipped step

Skipped step
1 scenario (1 failed)
6 steps (1 failed, 2 skipped, 3 passed)
0m0.553s

Process finished with exit code 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:27:36.233

您的调试 gem 很旧，请使用以下命令进行更新：

```
gem install ruby-debug-base --pre
gem install ruby-debug-ide --pre 
```

# .net - 从 Windows 服务中杀死一个进程

> ID：15603923
> 
> 赞同：3
> 
> 时间：2013-03-24T20:59:20.913
> 
> 标签：.net, windows, vb.net, service

我正在尝试将 explorer.exe KILLED 保持到事件发生。

我的意思是我有一个从我的 Windows 服务后台工作程序读取的 xml 文件。它等待一个值，直到 explorer.exe 不应该执行，这是出于安全目的。

我已经尝试到现在：

```
While (True)
            Dim doc As New XmlDocument
            doc.Load("C:\Users\Alpha-Guy\AppData\Local\Packages\new-design_sa0tb4645bqbp\LocalState\metadata.xml")
            Dim list = doc.GetElementsByTagName("authenticated")
            var_auth = list(0).InnerText

            If var_auth = "0" Then
                Dim pro As Process
                pro = Process.GetProcessesByName("explorer")(0)
                If pro IsNot Nothing Then
                    pro.Kill()
                End If
            End If

            If var_auth = "1" Then
                Dim pro As Process
                pro = Process.GetProcessesByName("explorer")(0)
                If pro Is Nothing Then
                    Process.Start("c:\windows\explorer.exe")
                End If

                'Try
                '    pro = Process.GetProcessesByName("explorer")(0)
                'Catch ex As Exception
                '    Process.Start("c:\windows\explorer.exe")
                'End Try

            End If

        End While 
```

此代码是在 backgroundWorker 的 doWork() 事件中编写的。

我的 Windows 服务将检查 xml 数据库中的值，如果它为 0，那么它将检查 explorer.exe 是否已启动，如果是则杀死它。

如果我在 xml 文件中找到 1 的值，它将检查 explorer.exe 是否启动，如果没有启动它。

问题：当我启动服务时，它会杀死 explorer.exe 一次，但是 explorer.exe 会自动打开并且服务无法再次杀死它。

错误：访问被拒绝。

如果它有一些权限问题而不是第一次杀死它怎么办？

代码有问题吗？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T21:20:49.123

使您的程序/服务以**管理员**身份（或系统帐户，或更高级别的 smtg）运行。
我认为您可以在“安装”服务时做到这一点。然后你不会得到那个错误。
如果您不想在从 Visual Studio 运行服务时出现该错误，也可以以管理员身份运行 Visual Studio。

我想这会对你有所帮助。祝你好运！

# database - 在 Maybe Relation 上运行 join

> ID：15603927
> 
> 赞同：1
> 
> 时间：2013-03-24T20:59:28.537
> 
> 标签：database, haskell, yesod, persistent, esqueleto

我有一个模型

```
Assignment
   blah Text
   .... 
```

和一个模型

```
File
    assignmentId AssignmentId Maybe
    ... 
```

我想在连接查询中获取与分配关联的所有文件。我已经尝试过 Esqueleto 和`runJoin`with`selectOneMany`但没有任何运气，所以我正在考虑不使用连接或使用 rawSql。这似乎真的不是一个好主意，但我无法弄清楚这一点。是否支持该功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T11:03:40.600

更新，工作示例：

```
{-# LANGUAGE PackageImports, OverloadedStrings, ConstraintKinds #-}
module Handler.HTest where

import Import
import "esqueleto" Database.Esqueleto as Esql
import "monad-logger" Control.Monad.Logger (MonadLogger)
import "resourcet" Control.Monad.Trans.Resource (MonadResourceBase)
import qualified Data.List as L

getFilesByAssignment :: (PersistQuery (SqlPersist m), MonadLogger m
                                                  , MonadResourceBase m) =>
                        Text -> SqlPersist m [Entity File]
getFilesByAssignment myAssign = do
  result <- select $
        from $ \(assign `InnerJoin` file) -> do
          on (just (assign ^. AssignmentId)
            Esql.==. file ^. FileAssignmentId)
          where_ (assign ^. AssignmentBlah Esql.==. val myAssign)
          return (assign, file)

  return $ map snd (result :: [(Entity Assignment, Entity File)])

(.$) = flip ($)

getTestR :: Handler RepHtml
getTestR = do
       entFiles <- runDB $ getFilesByAssignment "test"
       defaultLayout $ do
               setTitle "Test page"
               entFiles .$ map (show . unKey . entityKey)
                        .$ L.intercalate ", "
                        .$ toHtml
                        .$ toWidget 
```

# railstutorial.org - Michael Hartl 的 Rails 教程 10.3.3 中遇到的错误

> ID：15603930
> 
> 赞同：0
> 
> 时间：2013-03-24T20:59:44.853
> 
> 标签：railstutorial.org

我在运行 RSpec 测试时遇到了以下错误：

**失败：**

```
1) Authentication authorization as wrong user visiting Users#edit page 
 Failure/Error: before { visit edit_user_path(wrong_user) }
 ActionView::Template::Error:
   undefined local variable or method `feed_item' for #<#<Class:0x007f89628593f8>:0x007f895fcdcd38>
 # ./app/views/shared/_feed.html.erb:1:in `_app_views_shared__feed_html_erb___2268788413810348528_70113969385200'
 # ./app/views/static_pages/home.html.erb:13:in `_app_views_static_pages_home_html_erb__501962788019734978_70114020097480'
 # ./spec/requests/authentication_pages_spec.rb:108:in `block (5 levels) in <top (required)>'

2) Micropost pages micropost creation with invalid information should not create a micropost
 Failure/Error: before { visit root_path }
 ActionView::Template::Error:
   undefined local variable or method `feed_item' for #<#<Class:0x007f89628593f8>:0x007f895ff8c3a8>
 # ./app/views/shared/_feed.html.erb:1:in `_app_views_shared__feed_html_erb___2268788413810348528_70113969385200'
 # ./app/views/static_pages/home.html.erb:13:in `_app_views_static_pages_home_html_erb__501962788019734978_70114020097480'
 # ./spec/requests/micropost_pages_spec.rb:11:in `block (3 levels) in <top (required)>'

3) Micropost pages micropost creation with invalid information error messages 
 Failure/Error: before { visit root_path }
 ActionView::Template::Error:
   undefined local variable or method `feed_item' for #<#<Class:0x007f89628593f8>:0x007f8962b99798>
 # ./app/views/shared/_feed.html.erb:1:in `_app_views_shared__feed_html_erb___2268788413810348528_70113969385200'
 # ./app/views/static_pages/home.html.erb:13:in `_app_views_static_pages_home_html_erb__501962788019734978_70114020097480'
 # ./spec/requests/micropost_pages_spec.rb:11:in `block (3 levels) in <top (required)>'

 4) Micropost pages micropost creation with valid information should create a micropost
 Failure/Error: before { visit root_path }
 ActionView::Template::Error:
   undefined local variable or method `feed_item' for #<#<Class:0x007f89628593f8>:0x007f895de6c3a8>
 # ./app/views/shared/_feed.html.erb:1:in `_app_views_shared__feed_html_erb___2268788413810348528_70113969385200'
 # ./app/views/static_pages/home.html.erb:13:in `_app_views_static_pages_home_html_erb__501962788019734978_70114020097480'
 # ./spec/requests/micropost_pages_spec.rb:11:in `block (3 levels) in <top (required)>'

5) Static pages for signed-in users should render the user's feed
 Failure/Error: visit root_path
 ActionView::Template::Error:
   undefined local variable or method `feed_item' for #<#<Class:0x007f89628593f8>:0x007f895dd16f80>
 # ./app/views/shared/_feed.html.erb:1:in `_app_views_shared__feed_html_erb___2268788413810348528_70113969385200'
 # ./app/views/static_pages/home.html.erb:13:in `_app_views_static_pages_home_html_erb__501962788019734978_70114020097480'
 # ./spec/requests/static_pages_spec 
```

**代码：**

authentication_pages_spec.rb 的代码

```
 require 'spec_helper'

describe "Authentication" do

  subject { page }

  describe "signin page" do
    before { visit signin_path }

    it { should have_selector('h1',    text: 'Sign in') }
    it { should have_selector('title', text: 'Sign in') }
  end

  describe "signin" do
    before { visit signin_path }

    describe "with invalid information" do
      before { click_button "Sign in" }

      it { should have_selector('title', text: 'Sign in') }
      it { should have_selector('div.alert.alert-error', text: 'Invalid') }

      describe "after visiting another page" do
        before { click_link "Home" }
        it { should_not have_selector('div.alert.alert-error') }
      end
    end

    describe "with valid information" do
      let(:user) { FactoryGirl.create(:user) }
      before { sign_in user }

      it { should have_selector('title', text: user.name) }
      it { should have_link('Profile',  href: user_path(user)) }
      it { should have_link('Sign out', href: signout_path) }
      it { should have_link('Settings', href: edit_user_path(user)) }
      it { should have_link('Users',    href: users_path) }
      it { should_not have_link('Sign in', href: signin_path) }

      describe "followed by signout" do
        before { click_link "Sign out" }
        it { should have_link('Sign in') }
      end
    end
  end

  describe "authorization" do

    describe "for non-signed-in users" do
      let(:user) { FactoryGirl.create(:user) }

      describe "when attempting to visit a protected page" do
        before do
          visit edit_user_path(user)
          fill_in "Email",    with: user.email
          fill_in "Password", with: user.password
          click_button "Sign in"
        end

        describe "after signing in" do

          it "should render the desired protected page" do
            page.should have_selector('title', text: 'Edit user')
          end
        end
      end

      describe "in the Users controller" do

        describe "visiting the edit page" do
          before { visit edit_user_path(user) }
          it { should have_selector('title', text: 'Sign in') }
        end

        describe "submitting to the update action" do
          before { put user_path(user) }
          specify { response.should redirect_to(signin_path) }
        end

        describe "visiting the user index" do
          before { visit users_path }
          it { should have_selector('title', text: 'Sign in') }
        end
      end
    end

    describe "in the Microposts controller" do

      describe "submitting to the create action" do
        before { post microposts_path }
        specify { response.should redirect_to(signin_path) }
      end

      describe "submitting to the destroy action" do
        before { delete micropost_path(FactoryGirl.create(:micropost)) }
        specify { response.should redirect_to(signin_path) }
      end
    end

    describe "as wrong user" do
      let(:user) { FactoryGirl.create(:user) }
      let(:wrong_user) { FactoryGirl.create(:user, email: "wrong@example.com") }
      before { sign_in user }

      describe "visiting Users#edit page" do
        before { visit edit_user_path(wrong_user) }
        it { should_not have_selector('title', text: full_title('Edit user')) }
      end

      describe "submitting a PUT request to the Users#update action" do
        before { put user_path(wrong_user) }
        specify { response.should redirect_to(root_path) }
      end
    end

    describe "as non-admin user" do
      let(:user) { FactoryGirl.create(:user) }
      let(:non_admin) { FactoryGirl.create(:user) }

      before { sign_in non_admin }

      describe "submitting a DELETE request to the Users#destroy action" do
        before { delete user_path(user) }
        specify { response.should redirect_to(root_path) }
      end
    end
  end
end 
```

_feed.html.erb 的代码**

```
 <li id="<%= feed_item.id %>">
  <%= link_to gravatar_for(feed_item.user), feed_item.user %>
  <span class="user">
    <%= link_to feed_item.user.name, feed_item.user %>
  </span>
  <span class="content"><%= feed_item.content %></span>
  <span class="timestamp">
    Posted <%= time_ago_in_words(feed_item.created_at) %> ago.
  </span>
</li> 
```

_feed_item.html.erb 的代码

```
 <li id="<%= feed_item.id %>">
  <%= link_to gravatar_for(feed_item.user), feed_item.user %>
    <span class="user">
      <%= link_to feed_item.user.name, feed_item.user %>
    </span>
    <span class="content"><%= feed_item.content %></span>
    <span class="timestamp">
      Posted <%= time_ago_in_words(feed_item.created_at) %> ago.
    </span>
  <% if current_user?(feed_item.user) %>
    <%= link_to "delete", feed_item, method: :delete,
                                     data: { confirm: "You sure?" },
                                     title: feed_item.content %>
  <% end %>
</li> 
```

如果我应该包括其他文件，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T02:29:04.223

您的**_feed.html.erb**和**_feed_item.html.erb**文件有问题：目前，您在引用`feed_item`时没有在任何地方定义它。

请参阅 Rails 教程中的等效文件：[**_feed.html.erb**](https://github.com/railstutorial/sample_app_2nd_ed/blob/master/app/views/shared/_feed.html.erb)、[**_feed_item.html.erb**](https://github.com/railstutorial/sample_app_2nd_ed/blob/master/app/views/shared/_feed_item.html.erb)。

# python - 在 Pyglet 中使用 numpy 数组和 ctypes 进行 OpenGL 调用

> ID：15603931
> 
> 赞同：4
> 
> 时间：2013-03-24T20:59:44.787
> 
> 标签：python, opengl, numpy, ctypes, pyglet

我有一段看起来非常丑陋的小代码，每当我试图用 pyglet 绘制数组时，我似乎都会继续使用它，形式如下：

```
vertPoints = someArray.flatten().astype(ctypes.c_float)
vertices_gl = vertPoints.ctypes.data_as(ctypes.POINTER(ctypes.c_float)) 
```

我根据使用 numpy 和 pyglet 找到的少量资源拼凑而成。有没有更优雅的方法来获取指向 numpy 数组的指针作为 c_floats？

这是我写的一个小例子的上下文中的代码：

```
import numpy as np; import ctypes
import pyglet; import pyglet.gl as gl

def drawArray(someArray):

    vertPoints = someArray[:,:2].flatten().astype(ctypes.c_float)
    vertices_gl = vertPoints.ctypes.data_as(ctypes.POINTER(ctypes.c_float))

    vertColors = someArray[:,2:].flatten().astype(ctypes.c_float)
    colors_gl = vertColors.ctypes.data_as(ctypes.POINTER(ctypes.c_float))

    gl.glVertexPointer(2, gl.GL_FLOAT, 0, vertices_gl)
    gl.glColorPointer(3,  gl.GL_FLOAT, 0, colors_gl)
    gl.glDrawArrays(gl.GL_POINTS, 0, len(vertPoints) // 2)

window = pyglet.window.Window(400,400)

@window.event
def on_draw():
    gl.glPointSize(10.0)
    gl.glEnable(gl.GL_POINT_SMOOTH)
    gl.glEnable(gl.GL_BLEND)
    gl.glBlendFunc(gl.GL_SRC_ALPHA, gl.GL_ONE_MINUS_SRC_ALPHA)
    gl.glEnableClientState(gl.GL_VERTEX_ARRAY)
    gl.glEnableClientState(gl.GL_COLOR_ARRAY)

    points = np.random.random((50,5))*np.array([400,400,1,1,1])
    drawArray(points)

pyglet.app.run() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T22:59:40.953

我认为您不需要将数据的地址转换为浮点指针，您可以直接传递地址：

```
gl.glVertexPointer(2, gl.GL_FLOAT, 0, vertPoints.ctypes.data)
gl.glColorPointer(3,  gl.GL_FLOAT, 0, vertColors.ctypes.data) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-24T21:06:15.170

您可以直接将 Numpy 浮点数组与顶点缓冲区对象一起使用。不过，我还没有在 Pyglet 的上下文中使用它们。就像是：

```
from OpenGL.arrays import vbo

# setup
vertices_gl = vbo.VBO(vertPoints)
colours_gl = vbo.VBO(vertPoints)

# in drawing code
vertices.bind()
colours.bind()
glVertexPointer(2, gl.GL_FLOAT, 0, vertices_gl)
glColorPointer(2, gl.GL_FLOAT, 0, vertices_gl) 
```

# actionscript-3 - 如何通过 gzipped JSON 设置带有套接字和通信的 NodeJS + Actionscript 3.0？

> ID：15603933
> 
> 赞同：1
> 
> 时间：2013-03-24T20:59:50.400
> 
> 标签：actionscript-3, node.js, sockets, gzip

我正在尝试在 NodeJS 中设置服务器并在 actionscript 3 中设置客户端。

到目前为止，我成功地做到了，因此我向 NodeJS 发送了一个字符串化的 JSON，它回复了相同的消息，但现在我希望这种通信通过 gzip 化的字符串化 JSON 进行。

我尝试使用 nodeJS 的 zlib 模块，但无法解压缩。真的，几天尝试放气（在 nodejs 中）/inflate（as3 的 byearray），gzip（nodejs）/gunzip（从 adobe 获得 swc），什么也没有。

此外，在发送压缩后的 90kb 后，有时它只能以大约 30kb 的数量到达。

如果有帮助，我已在 flash builder 和我的脚本中附加了 as 3 项目。 [http://dfiles.eu/files/e2x3e3fir](http://dfiles.eu/files/e2x3e3fir)

先感谢您！

# javascript - 图像缩略图，最大宽度和最大高度——鼠标悬停，以某种方式查看更大的图像

> ID：15603936
> 
> 赞同：0
> 
> 时间：2013-03-24T20:59:59.030
> 
> 标签：javascript, html

我已将缩略图设置为具有最大宽度和最大高度，并且需要设置某种 onmouseover 设置，当他们将鼠标悬停在图像上时，它会向他们显示更大的图像。

我不能使用链接来做到这一点。

有任何想法吗？

html

```
<img src="imageurl" class="s3_right" style="max-width: 400px;"> 
```

我尝试使用下面的代码；但是，它搞砸了，因为我有一个最大宽度/最大高度。

html

```
<img src="image url" class="s3_right" onmouseover='Big(this);' onmouseout='Small(this);' style="max-width: 400px;"> 
```

javascript

```
<script language=javascript>
<!--
function Big(me)
{
me.width *= 2;
me.height *= 2;
}
function Small(me)
{
me.width /= 2;
me.height /= 2;
}
-->
</script> 
```

还有一个问题是 x2 可能会比实际图像大。我不需要代码来扩展比实际图像更大的图像。所以我真的只需要代码来设置一个新的最大宽度和最大高度，或者用最大宽度和最大高度从页面上弹出图像（比如，实际上并没有改变布局，因为图像缩略图正在显示文字环绕它们。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T22:40:35.333

是否有可能只是欺骗一个绝对定位的副本以及缩略图，嵌套在一个分配了相对位置的包装 div 中？

```
<style type="text/css">
    .meDiv
    {
        position:relative;
        border:1px solid black;
        width:200px;
        height:100px;
    }

    .meSmall
    {
        display:block;
        width:100%;
        height:100%;
    }

    .meBig
    {
        z-index:10;
        position:absolute;
        left:0px;
        top:0px;
        display:none;
        width:800px;
        height:350px;
    }
</style>

<div class="meDiv">
    <img class="meSmall" src="imageURL" onmouseover="Big();" />
    <img id="bigOne" class="meBig" src="imageURL" onclick="Small();" onmouseout="Small();" />
</div>

<script language="javascript">
function Big() {
    document.getElementById('bigOne').style.display = "block";
}

function Small() {
    document.getElementById('bigOne').style.display = "none";
}
</script> 
```

显然，给出的代码不会直接插入您的场景或赢得任何奖项，但这只是为了给出概念的概念。

使用它，您可以对包装 div 和/或缩略图应用任何大小限制（允许最大宽度/最大高度的错误），而不会影响大图像或移除任何包装文本。如果需要，您还可以使用缩略图的特征来确定大图像的特征，方法是使用一点 JavaScript 黑色巫术魔法（我自己是 jQuery 粉丝）。

# php - 通过 ajax 返回一系列复杂的命令（或者可能在通过 ajax 返回后对其进行重组）

> ID：15603942
> 
> 赞同：0
> 
> 时间：2013-03-24T21:00:16.070
> 
> 标签：php, jquery, ajax, arrays

我目前有一个看起来像这样的函数：

```
function getEvents($weekNumStart, $weekNumEnd){
    $mysqli = new mysqli(DB_SERVER, DB_USER, DB_PASSWORD, DB_NAME);
    if (!$mysqli) {
        die('There was a problem connecting to the database.');
    }
    else {
        if ($weekNumEnd == '') {
            $weekNumEnd = $weekNumStart;
        }
        $Group = $_SESSION['Group'];
        $query = $mysqli->prepare("SELECT EventID, DAYOFWEEK(Start) AS wday, Events.Start, HOUR(Start) AS sHour, HOUR(End) AS eHour, Events.End, Events.Group, Events.Unit, Type, Room, Lecturer, Cancelled, StartName FROM Events, Week WHERE StartName >= '$weekNumStart' AND StartName <= '$weekNumEnd' AND Events.Start >= StartWeek AND Events.Start <=EndWeek AND (Events.Group = '$Group' OR Events.Group = '');");
        $query->execute();
        $query->bind_result($eventID, $dayofweek, $startDateTime, $startHour, $endHour, $endDateTime, $group, $unit, $type, $room, $lecturer, $cancelled, $weekName);
        $data_arr = array();
        while ($query->fetch()){
            $data_arr[] = array(
               $eventID, $dayofweek, $startDateTime, $startHour, $endHour, $endDateTime, $group, $unit, $type, $room, $lecturer, $cancelled, $weekName
            );
        }
        return $data_arr; //
    }
    $mysqli->close();
} 
```

此功能按我的意愿工作。我目前这样操作它：

```
if (!isset($weekNumEnd)){
        $weekNumEnd = '';
    }
    $data = getEvents($weekNumStart, $weekNumEnd);
    foreach($data as $day) {
        for($i=0;$i<7;$i++){
            for($j=9;$j<=18;$j++){
                if ($day[1] == $i && $day[3] == $j){
                    $unit = $day[7];
                    $type = $day[8];
                    $room = $day[9];
                    if ($i == 2){
                    ?>
                    <script>
                    var mon<?=$j?>unit = '<?=$unit?>';
                    var mon<?=$j?>type = '<?=$type?>';
                    var mon<?=$j?>room = '<?=$room?>';
                    $('#mon-<?=$j?>').append(
                        "<p>"+mon<?=$j?>unit+"<br>"+mon<?=$j?>type+"<br>"+mon<?=$j?>room+"</p>"
                    );
                    </script>
                    <?php
                    if (($day[4] - $day[3]) > 1) {
                        for($q=($day[3]+1);$q<$day[4];$q++){
                        ?>
                        <script>
                            var mon<?=$q?>unit = '<?=$unit?>';
                            var mon<?=$q?>type = '<?=$type?>';
                            var mon<?=$q?>room = '<?=$room?>';
                            $('#mon-<?=$q?>').append(
                                "<p>"+mon<?=$q?>unit+"<br>"+mon<?=$q?>type+"<br>"+mon<?=$q?>room+"</p>"
                            );
                        </script>
                        <?php
                        }
                    }
                } 
```

问题是。我显然无法实时运行它以在每周或任何更改时不断更新事件列表。

所以为了解决这个问题，我决定尝试使用 Ajax。到目前为止，我有这个：

```
function getEvents() {
        var data = 'Events=Yes';
        $.ajax({
            type: "POST",
            url: "functions/updateWeek.php", 
            data: data,
            cache: false,
            dataType: 'json',
            success: function(html) {
                    alert(html.returned_val);
            }
    });
} 
```

我有这个要返回：

```
if($_POST['Events'] == "Yes"){
    $weekNumStart = $_SESSION['startWeek'];
    $weekNumEnd = $_SESSION['endWeek'];
    $data = getEvents($weekNumStart, $weekNumEnd);
    echo json_encode(array('returned_val' => $data));
} 
```

这......有点作品。至少也就是说它以一个丑陋的大块返回数据。

问题是我不能再像上面那样操作它：

```
data = getEvents($weekNumStart, $weekNumEnd);
    foreach($data as $day) {
        for($i=0;$i<7;$i++){
            for($j=9;$j<=18;$j++){
                if ($day[1] == $i && $day[3] == $j){
                    $unit = $day[7];
                    $type = $day[8];
                    $room = $day[9];
                    if ($i == 2){
                    ?>
                    <script>
                    var mon<?=$j?>unit = '<?=$unit?>';
                    var mon<?=$j?>type = '<?=$type?>';
                    var mon<?=$j?>room = '<?=$room?>';
                    $('#mon-<?=$j?>').append(
                        "<p>"+mon<?=$j?>unit+"<br>"+mon<?=$j?>type+"<br>"+mon<?=$j?>room+"</p>"
                    );
                    </script> 
```

也就是说-当我通过ajax调用信息时，我不知道如何重新操作它。我会以完全 javascript 的方式重写以上所有内容吗？有没有我不知道/理解的更合乎逻辑的方法？或者有没有一种方法可以让代码在那个不同的窗口中工作（用php和javascript完成），并让它全部发回，通过ajax更正，自动在页面上工作，而不必在信息后重写它是通过ajax拉回来的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T23:50:44.743

首先，使用 json_encode($data) 就足够了，您将从 AJAX 获取数组。

其次，使用 Firebug 进行检查，因为您应该获得结构化数据，而不是大块数据。

alert() 只是尝试将所有内容打印为单个字符串，仅此而已

```
for( var i = 0; i < html.length; i++ )
    // do something with html[i] 
```

# wordpress - Wordpress - 选择/加载子菜单项页面时突出显示父菜单项

> ID：15603950
> 
> 赞同：7
> 
> 时间：2013-03-24T21:00:56.620
> 
> 标签：wordpress

我有一个基本菜单，一些菜单项有子菜单。我对 wordpress 的经验很少，现在没有时间深入研究细节。所以我的问题是，当用户导航到其中一个子菜单页面时，突出显示顶部菜单项的最简单方法是什么。（我尝试同时使用 javascript 和纯 css 来通过元素 id 和使用“current-cat-parent”类来设置颜色属性，但都没有工作）。
任何帮助是极大的赞赏。

注意：我正在使用一个名为 chameleon 的主题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-30T08:39:07.140

您可以将 current-menu-item 类分配给 .current-menu-ancestor 类，例如

```
.main_menu li.current-menu-item a, .main_menu li.current-menu-ancestor a{
    color: #777777 !important; /* highlight color */
} 
```

它将突出显示父页面菜单

请参考[这个页面](https://web.archive.org/web/20130908095135/http://www.kriesi.at/support/topic/main-menu-li-items-active-while-on-child-and-gradnchild-pages)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-18T14:38:10.393

您可以在主题的 footer.php 文件中插入以下代码，就在结束 body 标记之前。

```
<!-- Highlight parent page link when on child page -->
<?php if (is_page()) {   //  displaying a child page ?>
    <script type="text/javascript">
        jQuery("li.current-page-ancestor").addClass('current-menu-item');
    </script>
<?php } ?> 
```

这样做的美妙之处在于它在 PHP 中，因此代码是动态的。它所做的只是添加另一个原生 WordPress nav li 类，使当前页面的链接处于活动状态。

我在这里写了一篇简短的文章来解释它是如何工作的：[查看子/子页面时如何保持父页面导航链接突出显示](http://bibiano.io/highlight-parent-page/)！

如果您对此有任何疑问，请随时告诉我。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-06-13T15:49:05.497

有趣的。您的解决方案突出显示了父级，但没有突出显示当前的子级。但这让我走上了正确的道路，最终，这就是我所需要的。

```
li.current-menu-parent >a, .current-menu-item >a {
    color: red !important;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-04-19T16:41:29.037

我在编辑它时遇到了一点问题，但找到了一个简单的解决方案。我正在使用 Wordpress Storefront 主题，只需将其粘贴到您的子主题`style.css`文件中：

```
li.current-menu-parent >a {
  color:red !important;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-05-03T08:57:33.747

# WordPress 5.7

**测试和工作，2021**

2021 年。如果你们中的任何人仍在寻找解决方案，那么就在这里。

这将突出显示父母及其孩子。如果没有子菜单，则父菜单将突出显示。记住`!important`是必需的。

```
.current-menu-parent > a,
.current-menu-item a { 
    color: blue !important; /* Important is required */
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-01T13:10:01.210

`.current-menu-ancestor`对我不起作用。`.current-page-ancestor`做过。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-22T21:34:28.730

这对我有用。下面的 CSS 将允许您设置活动菜单的样式... 最多三个菜单。

```
.current-menu-ancestor{ background:RED !important; }
.current_page_parent{background:GREEN !important;}
.active{background:YELLOW !important;} 
```

*   代表当前活动页面的菜单按钮将为黄色，
*   如果代表当前活动页面的按钮是嵌套的，则其父级将为绿色...否则菜单上的顶级按钮将为绿色。

*   最重要的是（无论您的菜单中出现多少级嵌套）任何具有**.current-menu-ancestor**类的元素 都将使用红色背景设置样式。

也可以只设置**.current-menu-ancestor 的**样式，并且任何父菜单项都将被设置样式。

# objective-c - ObjC：错误处理......返回什么

> ID：15603951
> 
> 赞同：5
> 
> 时间：2013-03-24T21:00:58.730
> 
> 标签：objective-c, error-handling

为这样的新手问题道歉。

我写了一个类方法，它接受三个字符串并返回一个子字符串。

我编写了条件语句，仅在满足某些条件时才允许返回子字符串。但是，如果无法提取子字符串，我不确定我需要返回什么。目前我有返回默认“错误”字符串的方法，但我觉得这可能不是最佳实践。

这是我的方法：

```
+(NSString *)ExtractSubstringFrom:(NSString *)sourceString 
             Between:(NSString *)firstString And:(NSString *)secondString {

             NSRange stringRangeOne = [sourceString rangeOfString:secondString];
             NSString *resultString;

             if (stringRangeOne.location != NSNotFound) {
             resultString = [sourceString substringToIndex:stringRangeOne.location]; 
             }

             NSRange stringRangeTwo = [sourceString rangeOfString:firstString];

             if (stringRangeTwo.location !=NSNotFound) {
             resultString = [resultString substringFromIndex:stringRangeTwo.location+stringRangeTwo.length];
             return resultString; 
             }

             else return @"Error!";

             //To do... improve error checking

             } 
```

如何使这种方法对错误更友好？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-24T21:09:14.163

在 Objective C 中有几种处理此类错误的方法：

*   **返回默认值**- 通常，默认值为`nil`. 由于在 Objective C 中允许对对象执行操作`nil`，因此这是相对安全的。
*   **生产`NSError`对象**——这是更典型的可以由最终用户解决的错误，例如连接和配置问题。这种 API 的不幸副作用是需要设置和传递一个额外的参数。
*   **使用断言**——这是处理“编程错误”的好方法，即当程序的参数超出其指定范围时。
*   **抛出异常**- 该选项在该语言中可用，但 Apple 强烈反对使用它。我在这里提到它是为了完整性，即使我自己从未使用过这个选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-27T20:16:49.043

这里实际的最佳实践是不在类方法中执行此操作，而是在将接受值的事物上实现[键值验证，并在设置之前调用验证方法。](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/KeyValueCoding/Articles/Validation.html)因此，您将从该方法中删除此验证/变异逻辑，而是将其放入您的验证方法中，并在控制器中修改值，称为验证方法，然后再设置值。这使您的验证逻辑有机会修改值（即默认值）或在输入值无法强制转换为可用值时返回错误。

有关 Objective-C 中错误处理的更多一般信息，请参阅[使用 Objective-C 编程：处理错误](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/ErrorHandling/ErrorHandling.html)和[错误处理编程指南](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ErrorHandlingCocoa/ErrorHandling/ErrorHandling.html)

# php - 如何检查变量是否为数组？...或类似数组的东西

> ID：15603952
> 
> 赞同：92
> 
> 时间：2013-03-24T21:00:58.887
> 
> 标签：php, arrays, foreach

我想使用一个`foreach`带有变量的循环，但是这个变量可以是许多不同的类型，`NULL`例如。

所以在`foreach`我测试它之前：

```
if(is_array($var)){
  foreach($var as ... 
```

但我意识到它也可以是一个实现`Iterator`接口的类。也许我是盲人但是如何检查该类是否实现了接口？有没有类似`is_a`函数或`inherits`运算符的东西？我发现`class_implements`，我可以使用它，但也许有更简单的东西？

其次，更重要的是，我认为这个函数存在，足以检查变量`is_array`或“实现`Iterator`接口”是否应该测试更多？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2013-03-24T21:11:03.417

如果您`foreach`在函数内部使用并且您期望一个数组或[Traversable](http://php.net/manual/en/class.traversable.php)对象，您可以键入提示该函数：

```
function myFunction(array $a)
function myFunction(Traversable) 
```

如果你没有`foreach`在函数内部使用或者你期望两者都可以，[你可以简单地使用这个结构](http://www.php.net/manual/en/class.traversable.php#99195)来检查你是否可以迭代变量：

```
if (is_array($a) or ($a instanceof Traversable)) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-05-25T10:03:27.657

[*`foreach`*](https://php.net/foreach)可以处理数组和对象。您可以通过以下方式检查：

```
$can_foreach = is_array($var) || is_object($var);
if ($can_foreach) {
    foreach ($var as ...
} 
```

您不需要[*`Traversable`*](https://php.net/Traversable)像其他人在他们的答案中暗示的那样专门检查，因为所有对象（如所有数组）都可以在 PHP 中遍历。

从技术上讲：

> `foreach`适用于各种可遍历对象，即数组、普通对象（遍历可访问属性的地方）和`Traversable`对象（或者更确切地说是定义内部`get_iterator`处理程序的对象）。

（[来源](https://stackoverflow.com/a/14854568/367456)）

简单地说，在常见的 PHP 编程中，每当一个变量是

*   数组
*   一个东西

并且*不是*

*   无效的
*   资源
*   一个标量

你可以用*`foreach`*它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-24T21:09:13.827

`Traversable`您可以使用简单的函数检查实例。这将适用于所有这些，`Iterator`因为`Iterator extends Traversable`

```
function canLoop($mixed) {
    return is_array($mixed) || $mixed instanceof Traversable ? true : false;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-24T21:04:27.770

```
<?php
$var = new ArrayIterator();

var_dump(is_array($var), ($var instanceof ArrayIterator)); 
```

返回`bool(false)`或`bool(true)`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-01-08T13:17:13.797

PHP 7.1.0[引入](https://secure.php.net/archive/2016.php#id2016-07-07-1)了[`iterable`伪类型和`is_iterable()`函数](https://wiki.php.net/rfc/iterable)，它们是专门为此目的而设计的：

> 这 […] 提出了一种新的`iterable`伪类型。这种类型类似于`callable`，接受多种类型而不是一种类型。
> 
> `iterable`接受任何`array`或实现的对象`Traversable`。这两种类型都是可迭代的，`foreach`并且可以`yield`在生成器中使用。

```
function foo(iterable $iterable) {
    foreach ($iterable as $value) {
        // ...
    }
} 
```

> 这个 […] 还添加了一个`is_iterable()`返回布尔值的函数：`true`如果一个值是可迭代的并且将被`iterable`伪类型接受，`false`则为其他值。

```
var_dump(is_iterable([1, 2, 3])); // bool(true)
var_dump(is_iterable(new ArrayIterator([1, 2, 3]))); // bool(true)
var_dump(is_iterable((function () { yield 1; })())); // bool(true)
var_dump(is_iterable(1)); // bool(false)
var_dump(is_iterable(new stdClass())); // bool(false) 
```

您还可以使用该函数`is_array($var)`检查传递的变量是否为数组：

```
<?php
    var_dump( is_array(array()) ); // true
    var_dump( is_array(array(1, 2, 3)) ); // true
    var_dump( is_array($_SERVER) ); // true
?> 
```

阅读更多[如何检查变量是否是 PHP 中的数组？](https://stackhowto.com/how-to-check-if-a-variable-is-an-array-in-php/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-12-18T00:45:46.560

自 PHP 7.1 起，就有一个伪类型[`iterable`](http://php.net/manual/en/language.types.iterable.php)用于此目的。类型提示`iterable`接受任何数组以及`Traversable`接口的任何实现。PHP 7.1 也引入了该功能[`is_iterable()`](http://php.net/manual/en/function.is-iterable.php)。对于较旧的版本，请参阅此处的其他答案，以在没有较新的内置功能的情况下完成等效的类型强制。

公平竞争：正如 BlackHole 所指出的，这个问题似乎是[*Iterable objects 和 array type hinting 的重复？*](https://stackoverflow.com/questions/3584700/iterable-objects-and-array-type-hinting)他或[她的回答](https://stackoverflow.com/a/39320526/3303195)比我的更详细。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-18T00:27:22.823

# 功能

```
<?php

/**
 * Is Array?
 * @param mixed $x
 * @return bool
 */
function isArray($x) : bool {
  return !isAssociative($x);
}

/**
 * Is Associative Array?
 * @param mixed $x
 * @return bool
 */
function isAssociative($x) : bool {
  if (!is_array($array)) {
    return false;
  }
  $i = count($array);
  while ($i > 0) {
    if (!isset($array[--$i])) {
      return true;
    }
  }
  return false;
} 
```

# 例子

```
<?php

$arr = [ 'foo', 'bar' ];
$obj = [ 'foo' => 'bar' ];

var_dump(isAssociative($arr));
# bool(false)

var_dump(isAssociative($obj));
# bool(true)

var_dump(isArray($obj));
# bool(false)

var_dump(isArray($arr));
# bool(true) 
```

# java - com.examples.AddAppointment.addEvent 的空指针异常（AddAppointment.java:125）

> ID：15603954
> 
> 赞同：0
> 
> 时间：2013-03-24T21:01:08.093
> 
> 标签：java, android, sqlite, nullpointerexception

我收到此错误空指针异常。
小背景
我有一个主类，添加约会类和约会数据类。约会数据类有一个创建数据库（SQLite）的方法，如果不存在的话。AddAppointment 类从具有几个 editText 的视图中获取值，并且用户插入一些值，并且此数据应传递给将值插入数据库的同一类中的方法 addEvent，该类之前在约会数据类中创建。但是从未调用约会数据类，因此从未创建数据库，因此我得到空指针异常（无法将值插入到数据库中）。
现在我的问题是。我如何在主类中调用类约会数据，以便调用 onCreate 方法并创建数据库。
下面的代码
约会数据类

```
 public class AppointmentsData extends SQLiteOpenHelper {
    private static final String DATABASE_NAME = "appointments.dba";
    private static final int DATABASE_VERSION = 1;
    private String TIME;
    private String DESCRIPTION;
    private String DETAILS;
    private String DATE;

    //create helper object for events database
    public AppointmentsData(Context ctx){
        super(ctx, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL("CREATE TABLE " + TABLE_NAME + " (" 
                + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, "
                + TIME + " TEXT NOT NULL," 
                + DATE + " TEXT NOT NULL" 
                + DESCRIPTION + " TEXT NOT NULL"
                + DETAILS + " TEXT NOT NULL");
    }
       } 
```

添加约会类

```
public class AddAppointment extends Activity implements OnClickListener {
    private AppointmentsData events;
    private EditText appDesctription;
    private EditText appDate;
    private EditText appTime;
    private EditText appDetails;
    SQLiteDatabase myDB;
    //Connection conn; //A connection (session) with a specific database
    ResultSet rs; //A table of data representing a database result set, which is usually generated by executing a statement that queries the database.
    PreparedStatement pst; //An ob
    String TableName = "appointments";

    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.appointment_details);

        appDate = (EditText) this.findViewById(R.id.appDate);

        appDate.setKeyListener(null);
        Bundle extras = getIntent().getExtras();
        if(extras !=null) {
            String dateSelected = extras.getString("dateselected");
            appDate.setText(dateSelected);

            View saveAppointment = findViewById(R.id.buttonSave);
            saveAppointment.setOnClickListener(this);

            //SQLiteDatabase db = dbHelper.getWritableDatabase();

        }

    }
    private String DESCRIPTION;
    private String DATE;
    private String TIME;
    private String DETAILS;
    @Override
    public void onClick(View v) {

            appDesctription = (EditText) this.findViewById(R.id.appDescription);
            DESCRIPTION = appDesctription.getText().toString();

            appTime = (EditText) this.findViewById(R.id.appTime);
            TIME = appTime.getText().toString();

            appDetails = (EditText) this.findViewById(R.id.appDetails);
            DETAILS = appDetails.getText().toString();

            DATE = appDate.getText().toString();

            AddAppointment aa = new AddAppointment();
            aa.addEvent(DESCRIPTION);
            aa.addEvent(DATE);
            aa.addEvent(DETAILS);
            aa.addEvent(TIME);

            Intent j = new Intent(this, CalendarViewActivity.class);
            startActivity(j);

    }

            private void addEvent(String string) {
                //insert a new record into Events data source
                //would do something similar for delete and update
                SQLiteDatabase db = events.getWritableDatabase();
                ContentValues values = new ContentValues();
                // add key and value
                values.put(DESCRIPTION, string);
                values.put(DATE, string);
                values.put(TIME, string);
                values.put(DETAILS, string);
                db.insertOrThrow(TABLE_NAME, null, values);
            }
            private String[] FROM = { _ID, TIME, DESCRIPTION, };
            private static String ORDER_BY = _ID + "DESC";
            private Cursor getEvents(){
                //perform managed query. The activity will handle closing
                //and requerying the cursor when needed
                SQLiteDatabase db = events.getReadableDatabase();
                Cursor cursor = db.query(TABLE_NAME, FROM ,null, null, null, null, ORDER_BY);
                startManagingCursor(cursor);
                return cursor;              

    }

enter code here 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T22:28:51.650

我认为您的问题是您在 SQLiteOpenHelper 子类`DML`中的方法中有不正确的语句。`onCreate()`

这里：

```
"CREATE TABLE " + TABLE_NAME + " (" 
                + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, "
                + TIME + " TEXT NOT NULL," 
                + DATE + " TEXT NOT NULL" 
                + DESCRIPTION + " TEXT NOT NULL"
                + DETAILS + " TEXT NOT NULL" 
```

您在日期和描述列以及语句末尾的最后一个右括号后面缺少逗号。这就是为什么永远不会创建您的数据库的原因。尝试修复它，它应该可以工作。

所以这里是更正的声明：

```
"CREATE TABLE " + TABLE_NAME + " (" 
                    + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, "
                    + TIME + " TEXT NOT NULL," 
                    + DATE + " TEXT NOT NULL," 
                    + DESCRIPTION + " TEXT NOT NULL,"
                    + DETAILS + " TEXT NOT NULL)" 
```

# css - CSS选择除前两个和后两个之外的所有子元素

> ID：15603957
> 
> 赞同：50
> 
> 时间：2013-03-24T21:01:14.940
> 
> 标签：css, css-selectors

我很好奇（仅此而已），看看您将如何选择除前两个和后两个之外的元素的所有子元素。

[我有一个方法](http://jsfiddle.net/rudiedirkx/7BQV8/)，但它很讨厌而且不可读。必须有一个更清晰的方法，不需要 8 个伪选择器。

```
:not(:nth-child(1)):not(:nth-child(2)):not(:nth-last-child(1)):not(:nth-last-child(2)) {
    background: purple;
} 
```

是的，这太可怕了。它从字面上选择所有元素：不是第一个或第二个第一个或最后一个。必须有一种方法可以`2`用作半变量，而不是堆积在伪选择器上。

[我想到了另一个](http://jsfiddle.net/rudiedirkx/7BQV8/1/)（仍然很乱）：

```
:not(:nth-child(-1n+2)):not(:nth-last-child(-1n+2)) {
    background: purple;
} 
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2015-11-17T11:18:10.120

你甚至不需要`:not()`. `:nth-child(n+3):nth-last-child(n+3)`工作正常。

[在这里](http://jsfiddle.net/7BQV8/172/)查看。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-03-24T21:07:00.283

`:nth-child`除了使用and之外，我没有看到任何其他选项`:not(:nth-last-child)`。

我的版本：`hr:nth-child(n+3):not(:nth-last-child(-n+2))`

[**演示**](http://jsfiddle.net/7BQV8/6/)

根据`:nth-child`参考：

> `:nth-child`CSS 伪类匹配文档树中在它之前有兄弟姐妹的元素，`an+b-1`对于给定的 n 的正值或零值，并且具有父元素。
> 
> 换句话说，这个类匹配所有索引落在集合中的孩子`{ an + b; ∀n ∈ N }`。

所以`nth-child(n+3)`匹配所有元素，从第三个开始。

`:nth-last-child`工作方式类似，但从元素集合的末尾开始，因此`:nth-last-child(-n+3)`仅匹配从集合末尾开始的 2 个元素。因为`:not`这两个元素被排除在选择器之外。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-24T21:12:03.673

您可以简单地将紫色设置为所有元素，然后将其从 3 个不需要的元素中删除：

```
element { background: purple }
element:first-child, element:nth-child(2), element:last-child, element:nth-last-child(2) {
   background: none; /* or whatever you want as background for those */
} 
```

恕我直言更容易阅读

# css - 如何使这个 DIV 居中（CSS/HTML）

> ID：15603958
> 
> 赞同：0
> 
> 时间：2013-03-24T21:01:15.063
> 
> 标签：css, html, image, center-align

我有一个我想居中的 DIV。没有定义宽度或长度，因为该页面被假定为适用于所有窗口大小（当您重新调整窗口大小时，页面会调整）。我需要保留这个，同时将 DIV 居中。

这是我对视觉辅助的意思的照片。

[http://imgur.com/NZ6OSWn,LPkYzwM#1](http://imgur.com/NZ6OSWn,LPkYzwM#1)

包含所有这些图像的 DIV“容器”需要居中。在图片中，它与右侧的间隙左对齐。

只是为了更容易查看，这里是 jsfiddle 中的代码。

[http://jsfiddle.net/fZ4CL/](http://jsfiddle.net/fZ4CL/)

```
#container{
    display:box;
    float:left;
    margin-top:40px;
    left:50%;
}
#thumb{
    display:box;
    float:left;
    top:0;
    left:0;
    margin:5px;
    padding:10px;
    background-color:rgba(102,102,102,0.5);}

<body>
<img src='background/001.JPG' class='background'/>
<div id='navigation'>
    <div>
    <ul id='menu'>
        <li><a href='#'>Home</a></li>
        <li><a href='#'>Albums</a></li>
        <li><a href='#'>Contact</a></li>
    </ul>
    </div>
    <div id='toggle'>
        <a href='#'>Hide All</a>
    </div>       
</div>
<div id='container'>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
    <div id='thumb'><img src='thumbs/thumb.jpg'/></div>
</div>

</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:19:38.333

首先，您不能有多个具有相同 ID 的元素。您有多个 ID 为 的元素`thumb`。你不能那样做。改用类。

然后将`display`缩略图的`inline-block`和`text-align`容器的设置为`center`：

```
#container {
    text-align: center;
}
.thumb {
    display: inline-block;
} 
```

您的代码中还有其他一些错误：

*   `display: box`不太可能是您想要的。你可能想要`block`。
*   `left`并且`top`没有任何效果，除非`position`被设置。
*   你似乎对`float: left`不需要的地方有一种奇怪的吸引力。
*   我需要将 a 更改`margin`为 a`padding`以保持相同的间距。

**[看看结果。](http://jsfiddle.net/YH6Ak/embedded/result,html,css/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T21:04:51.660

边距：0 自动；在#container 中，在margin-top 之前：

另外，为什么要使用 float: left 在容器中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T21:05:30.620

这应该可以解决问题。

```
#container {
   margin-left: auto;
   margin-right: auto;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-24T21:08:36.517

除非你给它一个定义的宽度，否则你不能居中一个块元素。否则，浏览器会为该元素提供尽可能多的宽度，这意味着它已经居中（左边零空间，右边零空间）。

使用`min-width`和/或`max-width`给元素一个定义的宽度，它比单个`width`值更灵活，然后给元素一个`margin: 1em auto`样式，使其在其父元素中可用的未使用宽度内水平居中。

# javascript - 未捕获的 ReferenceError：未定义 ctx

> ID：15603960
> 
> 赞同：7
> 
> 时间：2013-03-24T21:01:20.810
> 
> 标签：javascript, jquery, html, canvas

我已经尝试了一切来解决这个问题，但没有任何效果。在这里发帖是我最后的手段。

我正在尝试编写一个简单的画布元素并动态加载所有内容，但没有任何效果。我不断在 game.js:33 上的 Google 控制台“未捕获的 ReferenceError：ctx 未定义”中收到错误消息。

我最初认为这是因为 common.js 是在其他 2 个 javascript 文件之后加载的，所以我制作了一个加载器文件，它按照我想要的顺序加载每个 JS 文件。我使用 $.getScript() 和 $.when() 函数来做到这一点。不幸的是，这没有奏效。所以正在加载 ctx var，但由于某种原因它给了我错误。

我已包含以下文件。提前感谢您的帮助。

编辑：我只是尝试从每个单独的 JS 文件中取出所有代码，并将它们按照它们应该在的顺序放在同一个文件中，现在它工作正常。但是很高兴知道为什么它根本不起作用。因为将我的所有代码都放在一个文件中会变得非常忙碌。谢谢你。

**索引.php**

```
<!doctype>
<html>
<head>
   <title>Game - Unknown</title>
   <link rel="stylesheet" href="./assets/css/default.css">
   <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
   <script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.3.3.min.js"></script>
   <!--<script src="./assets/js/loader.js"></script>-->
   <script src="./assets/js/common.js"></script>
   <script src="./assets/js/graphics.js"></script>
   <script src="./assets/js/game.js"></script>
</head>
<body>
<canvas id="viewport"></canvas>
</body>
</html> 
```

**common.js**

```
 $(document).ready(function(){

      // Setup the canvas game context for 2D
      var canvas = document.getElementById("viewport");
      var ctx = canvas.getContext("2d");

      // Update the canvas dimensions to match window size when changed
      $(window).resize(function(){canvasResize()}); canvasResize();

      function canvasResize(){
         var cWidth = window.innerWidth;
         var cHeight = window.innerHeight;

         canvas.width = cWidth;
         canvas.height = cHeight;

         ctx.clearRect(0, 0, canvas.width, canvas.height);
         ctx.fillStyle = '#000';
         ctx.fillRect(0, 0, cWidth, cHeight);
      }

      // Get center of things - Useful for centering images on canvas
      function getCenter(dim){ return dim / 2 }

   }); 
```

**图形.js**

```
 $(document).ready(function(){

      function gfxTile(x, y, w, h, r, g, b, a)
      {
         ctx.fillStyle = "rgb(60, 60, 100)";
         ctx.beginPath();
         //ctx.moveTo(x + h / 2, y + w / 2);
         ctx.moveTo(10, 10);
         ctx.lineTo(105, 25);
         ctx.lineTo(25, 105);
         ctx.lineTo(25, 105);
         ctx.closePath();
         ctx.fill();
      }

   }); 
```

**游戏.js**

```
 $(document).ready(function(){

      // START TEMPORARY
      var mapSizeX = 10;
      var mapSizeY = 10;
      var mapArray = new Array();

      function createMap()
      {
         for(x = 0; x < mapSizeX; x++)
         {
            mapArray[x] = [];

            for(y = 0; y < mapSizeY; y++)
            {
               mapArray[x][y] = 0;
            }
         }
      }
      // END TEMPORARY

      setInterval(mainLoop, 50);

      function mainLoop()
      {
         //gfxTile(10, 10, 40, 40, 50, 50, 50, 100);
         ctx.clearRect(0, 0, canvas.width, canvas.height);
      }

   }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T21:06:35.140

`var ctx = canvas.getContext("2d");`创建了一个`ctx`在您传入的函数范围内调用的变量`$(document).ready();`

当 game.js 中的函数执行时，`ctx`其作用域或父作用域`window`.

一个简单的解决方法是改变

```
var ctx = canvas.getContext("2d"); 
```

至

```
window.ctx = canvas.getContext("2d"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T21:57:16.300

您的 ctx 变量已经在可访问的名称空间上，您的问题基本上是加载文件没有顺序和优先级的结果。但是，您可以使用脚本加载器来解决问题，并确保在使用之前已经定义了您的变量。

在这个例子中，我使用了[head.js](http://headjs.com/)脚本加载器。

```
<script src="js/head.js"></script>
<script>
head.js(
"http://code.jquery.com/jquery-1.9.1.min.js",
    "http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.3.3.min.js", 
    "js/common.js", 
    "js/graphics.js", 
    "js/game.js"
); 
```

您可以使用[requireJS](http://requirejs.org/)进一步优化您的代码，以仅公开您想要的命名空间。去看一下。

# jquery - jQuery 计算器的独特“折扣”挑战

> ID：15603962
> 
> 赞同：0
> 
> 时间：2013-03-24T21:01:52.957
> 
> 标签：jquery, forms, calculator

我一直在纠结这个...我有三个表单字段：个人，夫妻，总计。这是一个会议注册费用计算器。

一个人 (#individuals) 的费用为 50 美元。一对夫妇 (#couples) 售价 75 美元。报名人数超过3人可享受优惠。每个人的折扣价为 40 美元。所以我们计算总人数，如果有 3 人或更多人，则对每个人应用 40 美元的新价格。在计算#individuals 和#couples 字段之间的总人数之前，#couples 的值需要乘以2，因为每对夫妇有两个人。新的“打折”#individuals 价格为 40 美元，新的 #couple 价格为 80 美元。

我的问题只是“我哪里出错了？”。非常感谢任何见解。

我当前的代码在 #total 字段中产生了不正确的数字：

```
 $('#individuals').change(compute);
   $('#couples').change(compute);
   function compute() {
      var ind = $('#individuals').val(); // number of individuals
      var coup = $('#couples').val()*2; // number of people in a couple (2)
      var people = ind + coup; // add up the total people
      if (people >= 3) {    
        var a = $('#individuals').val()*40; // discount price of an individual
        var b = $('#couples').val()*80; // discount price of couple
      }
      else {
        var a = $('#individuals').val()*50; // normal price of an individual
        var b = $('#couples').val()*75; // normal price of couple
      }
      var total = a + b;
      $('#total').val(total);
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:05:08.937

1.  不要重复自己——`$('#element').val()`每个领域只打一次电话

2.  用于`parseInt(val, 10)`确保您的数字是数字而不是字符串。您的`ind`字段当前是一个字符串，当您“连接”它时会导致错误`coup`：

例如：

```
function compute() {
  var ind = parseInt($('#individuals').val(), 10); // number of individuals
  var coup = parseInt($('#couples').val(), 10);    // number of couples
  var people = ind + 2 * coup;                     // add up the total people
  var total;
  if (people >= 3) { 
    total = 40 * people;
  } else {
    total = 50 * ind + 75 * coup;
  }
  $('#total').val(total);
}

$('#individuals,#couples').on('change', compute); 
```

# javascript - 从我的图像中删除 onclick

> ID：15603964
> 
> 赞同：1
> 
> 时间：2013-03-24T21:02:02.970
> 
> 标签：javascript, onclick

所以我有以下javascript代码。基本上它正在创建纸牌游戏“记忆”的在线版本（即，您在网格中有隐藏的图像，您翻转一个并需要找到它的匹配图像）。一切对我来说都很好，除了在我的图像匹配之后。如果它们匹配，我想从图像中删除 onclick 事件，以防止用户再次单击它。但是，我查找并尝试过的所有内容都不适合我。

我的部分要求是“将 firstFlip 和 secondFlip 的 onclick 事件处理程序更改为一个除了返回值 false 之外什么都不做的匿名函数”。这是我用来删除事件的片段（checkTiles() 函数的一部分）：

```
 firstFlip.onclick = function(){return false;};
  secondFlip.onclick = function(){return false;}; 
```

这是整个 javascript 代码：

```
/*
  Filename: tiles.js

   Global Variables
   flipCount
      Used to track the number of tiles currently being turned over

   firstFlip
      Used to reference the first tile turned over

   secondFlip
      Used to reference the second tile turned over

   Functions

   addEvent(object, evName, fnName, cap)
      Run the function fnName when the event evName occurs in object.

   randomSort(arr)
      Randomly sorts the contents of the arr array.

   setOpacity(object, value)
      Sets the opacity level of object to value

   setupTiles()
      Sets up the tiles for use in the Concentration game

   flipTile()
      Flips a tile showing the image associated with the tile

   checkTiles(tile1, tile2)
      Checks whether the tile1 image source is the same as the
      tile2 image source

   flipBack()
      Flips back flipped over tiles and resets the flipCount
      variable to 0.
*/

var flipCount = 0;
var firstFlip = new Image();
var secondFlip = new Image();

addEvent(window,"load", setupTiles, false);

function setupTiles() {
   var tiles = new Array();     // array of tile images
   for  (i = 0;i < document.images.length; i++) {  // go through all images
      image = document.images[i]; 
      if (image.className == "tile" && image.parentNode.tagName == "A") {  // must be of class tile and enclosed in <a></a>
         tiles.push(image);     // add tile to array
      }
   }

   var tileImages = new Array(tiles.length);     // array holding actual tile images
   for(j = 0; j < tileImages.length/2; j++) {
      var picture = new Image();
      picture.src = "tileImage" + j + ".jpg";
      tileImages[j] = picture;
   }
   for(n = tileImages.length/2; n < tileImages.length; n++) {
      picture = new Image();
      picture.src = "tileImage" + (n - tileImages.length/2) + ".jpg";
      tileImages[n] = picture;
   }

   randomSort(tileImages);    // randomly position the images in the array

   for(m = 0; m < tiles.length; m++) { 
      tiles[m].flipped = tileImages[m];      // custom property to reference flipped image
      addEvent(tiles[m], "click", flipTile, false);   // run flipTile whenever image is clicked
   }

   showAll = document.getElementById("showAll");
   showAll.onclick = function() {
      for(h = 0; h < tiles.length; h++) 
         tiles[h].src = tiles[h].flipped.src;
   };

   reload = document.getElementById("reload");
   reload.onclick = function() {
      location.reload();
   };
}

function flipTile() {
   if(flipCount == 0) {
      this.src = this.flipped.src;
      firstFlip = this;
      flipCount++;
   }
   else if(flipCount == 1) {
      this.src = this.flipped.src;
      secondFlip = this;
      flipCount++;
      checkTiles();
   }
}

function checkTiles() {
   if (firstFlip.src != secondFlip.src) {
      setTimeout(flipBack, 800);
   }
   else {
      flipCount = 0;
      setOpacity(firstFlip, 70);
      setOpacity(secondFlip, 70);
      firstFlip.onclick = function(){return false;};
      secondFlip.onclick = function(){return false;};
   }

}

function flipBack() {
   firstFlip.src = "tile.jpg";
   secondFlip.src = "tile.jpg";
   flipCount = 0;
}

function addEvent(object, evName, fnName, cap) {
   if (object.attachEvent)
       object.attachEvent("on" + evName, fnName);
   else if (object.addEventListener)
       object.addEventListener(evName, fnName, cap);
}

function randomSort(arr) {

   arr.sort(function () {
      return 0.5 - Math.random();
   })

}

function setOpacity(object, value) {

   // Apply the opacity value for IE and non-IE browsers
   object.style.filter = "alpha(opacity = " + value + ")";
   object.style.opacity = value/100;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:17:21.020

看起来您可以简单地添加一个 removeEvent 方法：

```
function removeEvent(object, evName, fnName) {
    if (object.detachEvent)
        object.detachEvent("on" + evName, fnName);
    else if (object.removeEventListener)
        object.removeEventListener(evName, fnName);
} 
```

然后使用图像元素和`flipTile`函数作为参数调用它：

```
removeEvent(firstFlip, 'click', flipTile); 
```

# iis-7 - Zend 框架 IIS 重定向

> ID：15603968
> 
> 赞同：0
> 
> 时间：2013-03-24T21:02:41.483
> 
> 标签：iis-7, url-rewriting

我有此规则可将流量重定向到`/public`，但出现“重定向循环”错误。有什么建议么？

```
<rule name="Redirect to /public" stopProcessing="true">
    <conditions logicalGrouping="MatchAll">
       <add input="{HTTP_HOST}" pattern="^test.example\.com$" ignoreCase="false" />
    </conditions>
    <action type="Redirect" url="http://test.example.com/{R:1}" />
    <match url="(.*)" ignoreCase="false" />
</rule> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T15:23:50.703

您有一个循环，因为您的规则在以下情况下被触发：

1.  `url="(.*)"`=> 总是正确的
2.  `{HTTP_HOST}`匹配`^test.example\.com$`=> 在您的情况下始终为真

您的重定向规则由访问您网站的任何 url 触发。
然后它会重定向到您的网站，其网址将再次匹配规则...

如果要将所有请求重定向到`/public`，可以使用以下规则：

```
<rule name="Redirect to /public" stopProcessing="true">
    <match url="^public/(.*)" negate="true" />
    <action type="Redirect" url="public/{R:1}" />
</rule> 
```

它检查 url 是否不以`public/`. 如果是这种情况，它会重定向到`public/UrlRequested`.

您也可以保留您`conditions`的：

```
<rule name="Redirect to /public" stopProcessing="true">
    <match url="^public/(.*)" negate="true" />
    <conditions logicalGrouping="MatchAll">
      <add input="{HTTP_HOST}" pattern="^test.example\.com$" ignoreCase="false" />
    </conditions>
    <action type="Redirect" url="public/{R:1}" />
</rule> 
```

# android - 按项目位置在网格视图中设置背景

> ID：15603971
> 
> 赞同：0
> 
> 时间：2013-03-24T21:02:56.380
> 
> 标签：android, gridview, view

我想更改 GridView 中特定项目的背景颜色（按位置）。

```
public View getView(int position, View convertView, ViewGroup parent) {
    ImageView imageView;
    if (convertView == null) {  // if it's not recycled, initialize some attributes
        imageView = new ImageView(mContext);
        imageView.setLayoutParams(new GridView.LayoutParams(85, 85));
        imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
        imageView.setPadding(8, 8, 8, 8);
    } else {
        imageView = (ImageView) convertView;
    }

    parent.getChildAt(1).setBackgroundColor(Color.RED);

    imageView.setImageResource(mThumbIds[position]);
    return imageView;
} 
```

它不起作用。

如果我在 OnClickListener 中使用它，它可以工作：

```
public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
    view.setBackgroundResource(android.R.drawable.btn_default);
} 
```

但我想更改它而无需单击。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:52:50.367

而不是`parent.getChildAt(1).setBackgroundColor(Color.RED);`尝试

```
if(position==1){ // item's position that you want to change background color
    [VIEW_YOU_WANT_TO_CHANGE_BACKGROUND].setBackgroundColor(Color.RED);
}else{
    // Set other item's background color to default background color you want
    [VIEW_YOU_WANT_TO_CHANGE_BACKGROUND].setBackgroundColor(Color.[WHAT_COLOR_YOU_WANT]);
} 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T21:15:02.010

您可以为 中的每个位置`View`添加一个孩子。然后设置整个项目的背景。`ImageView``getView()``View`

```
public View getView(int position, View convertView, ViewGroup parent) {
        final ImageView imageView;
        View v = null;
        if (convertView == null) {
            v = getLayoutInflater().inflate(R.layout.item_grid, parent, false);
            imageView = (ImageView) v.findViewById(R.id.image);
            imageView.setLayoutParams(new GridView.LayoutParams(85, 85));
            imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
            imageView.setPadding(8, 8, 8, 8);
            v.setBackground(R.drawable.whateverBackground)
        } else {
            v = convertView;
        }
        return v;
} 
```

`item_grid.xml`看起来像这样

```
<?xml version="1.0" encoding="utf-8"?>
<ImageView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/image"
    android:layout_width="fill_parent"
    android:layout_height="120dip"
    android:adjustViewBounds="true"
    android:contentDescription="@string/descr_image"
    android:scaleType="centerCrop" /> 
```

# javascript - 你可以在 TypeScript 的本地方法中访问本地静态变量吗？

> ID：15603972
> 
> 赞同：0
> 
> 时间：2013-03-24T21:02:58.053
> 
> 标签：javascript, static, typescript

可以说我有一个像下面这样的课程：

```
class Types
{
    static TypeOne = 1;
    static TypeTwo = 2;
    static TypeThree = 3;
    static TypeFour = 4;
    static TypeFive = 5;

    public GetNameFromType(type: number) : string
    {
        switch (type)
        {
            case Types.TypeOne: return "TypeOne";
            case Types.TypeTwo: return "TypeTwo";
            case Types.TypeThree: return "TypeThree";
            case Types.TypeFour: return "TypeFour";
            case Types.TypeFive: return "TypeFive";
            default: return "Unknown";
        }
    }
} 
```

现在，在阅读了一些关于静态类的文档之后，上面的内容似乎应该可以工作。但是我不断收到一条错误消息，说 Types.TypeOne 在当前范围内不存在。

那么我需要做其他事情还是应该这样做？

== 编辑 ==

由于错误，我认为它没有为它输出任何东西，但它似乎有，这是输出：

```
var Types = (function () {
            function Types() { }
            Types.TypeOne = 1;
            Types.TypeTwo = 2;
            Types.TypeThree = 3;
            Types.TypeFour = 4;
            Types.TypeFive = 5;
            Types.TypeSix = 6;
            Types.prototype.GetNameFromType = function (type) {
                switch(type) {
                    case AbilityTypes.TypeOne:
                        return "TypeOne";
                    case AbilityTypes.TypeTwo:
                        return "TypeTwo";
                    case AbilityTypes.TypeThree:
                        return "TypeThree";
                    case AbilityTypes.TypeFour:
                        return "TypeFour";
                    case AbilityTypes.TypeFive:
                        return "TypeFive";
                    case AbilityTypes.TypeSix:
                        return "TypeSix";
                    default:
                        return "Unknown";
                }
            };
            return Types;
        })(); 
```

这看起来合法，所以也许它正在工作并且只是在抱怨......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T21:07:36.813

您使用的是 Typescript 0.8.3 吗？你的代码对我来说编译得很好。如果错误发生在其他地方，请尝试将它们定义为“公共静态”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T16:33:36.173

将该代码粘贴到 Playground ( [http://www.typescriptlang.org/playground](http://www.typescriptlang.org/playground) ) 对我来说没有显示任何错误或警告，并且它运行与 MSI 相同的 0.8.3 位。如果您仅看到此代码的错误，我将卸载/重新安装，因为除非这是更大项目的一部分并且错误发生在其他地方，否则安装中的某些内容似乎不正常。

# java - 通过命令控制台/终端执行脚本后如何显示 SVG 图像？

> ID：15603977
> 
> 赞同：0
> 
> 时间：2013-03-24T21:03:36.517
> 
> 标签：java, svg, terminal

我正在编写一个将 .txt 脚本文件转换为 .svg 图像文件的应用程序。它是用 Java 编写的（Python 可能会更好，但我使用我拥有的工具），通过命令控制台执行，并且每次执行可以生成多个图像。

所以我的问题是，是否可以在执行时在查看器中打开图像？如果是，那又如何？最好的选择是`file:///C:/Users/.../graphOne.svg`通过网络浏览器执行文件位置 ( )；答案越简单越好，因为我正在编写此代码集以供一般使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T21:09:12.343

尝试：

```
import java.awt.Desktop;
// ...
Desktop.getDesktop().browse(svgFile.toURI()); 
```

或者

```
import java.awt.Destktop;
// ...
Desktop.getDesktop().open(svgFile); 
```

# regex - 使用 sed 在两个字符串之间进行匹配

> ID：15603980
> 
> 赞同：1
> 
> 时间：2013-03-24T21:03:59.387
> 
> 标签：regex, sed

示例字符串：`/Volumes/Macintosh HD/Users/test/`

我需要输出是卷名，`Macintosh HD`

我尝试了以下方法：

```
echo "/Volumes/testVolume/test/" | sed 's/\/Volumes\/\(.*\)\//\1/g' 
```

但输出是：`testVolume/test`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T21:07:50.257

这应该有效：

```
sed 's#/Volumes/\([^/]*\)/.*#\1#' 
```

除了使用`/`来标记搜索和替换表达式，您也可以使用任何其他字符。`#`如果您的搜索或替换表达式中包含该字符，则它是常用字符`/`。

```
$ sed 's#/Volumes/\([^/]*\)/.*#\1#' <<< "/Volumes/Macintosh HD/Users/test/"
Macintosh HD 
```

# php - 正则表达式：如何检测引号内的字符串，但包括转义引号？

> ID：15603982
> 
> 赞同：0
> 
> 时间：2013-03-24T21:04:21.723
> 
> 标签：php, regex

我有一个非常简单的任务，编写一个正则表达式，它将在引号内返回一个字符串：

```
"this is string" 
```

...但也包括任何转义的引号：

```
"this is \" also a string" 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T21:08:38.860

首先，确保正则表达式是您真正想要的。他们有变丑的习惯。

但是，如果您确定，这应该可以解决问题：

```
"((\\.|[^\\"])*)" 
```

外括号只是为了让您可以在没有引号的情况下获取字符串的内容。如果你不需要它，你可以使用`"(\\.|[^\\"])*"`.

要将其发送到 PHP，您可以使用带单引号的字符串（不会转义）；

```
'"((\\.|[^\\"])*)"' 
```

或者如果您必须使用双引号，请根据需要对其进行转义：

```
"\"((\\\\.|[^\\\\\"])*)\"" 
```

# javascript - 2 个按钮，其中一个具有额外功能

> ID：15603983
> 
> 赞同：0
> 
> 时间：2013-03-24T21:04:24.120
> 
> 标签：javascript, jquery, asp.net, html

我有两个不同的按钮。两者都在单击时运行 JQuery 函数“ShowCommentBox”但是，当单击第二个按钮时，我想沿“SHowCommentBox”加载一个附加的 JQuery 函数——该附加函数允许在屏幕上显示额外的选项。

```
<input id="SubmitCommentsForBOQ" type="button" value="Comments" onclick="ShowCommentBox('<%: item.ItemCode %>'')" /> 
```

上面是我还想运行的第二个按钮

```
 $("#SubmitCommentsForTwo").click(function () {
        $("#hiddenBox").show();
    }); 
```

，这使得额外的功能可见......我该怎么做？

感谢您的任何回复

下面是原始的 JQuery：它加载了一个对话框

```
function ShowCommentBox(itemIdentifier, labourOrPlant, desc) {
        id = itemIdentifier;
        LabouringOrPlanting = labourOrPlant;
        description = desc;
        Function.DisplayBox(itemIdentifier);
        $("#LabourOrPlantDialog").dialog({ modal: true }); 
    } 
```

和我的其他代码：

```
 <div id="LabourOrPlantDialog" title="Comments"  style="display:none;">
 <table class="detailstable FadeOutOnEdit">
     <tr>
        <th>Item</th>
     </tr>
     <tr>
         <td id="Item"></td>
     </tr>
 </table>    
 <br />

       <textarea id="ExistingComments" type="text" runat="server" rows="7" cols="30"
        maxlength="2000"> </textarea> 
       <input id="SubmitComment" type="button" value="Submit"
            onclick="SubmitButton()" />  

<br />

<div id="hiddenBox">
<input type="text" name="BoqTextBox" id="BoqTextBox" value="7.15" />
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:11:55.647

最好[将行为与标记分开](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)。您可以使用 HTML`data-`属性解决这两个问题。

首先在 HTML 中嵌入数据：

```
<input id="SubmitCommentsForBOQ" type="button" value="Comments"
    data-item-code="<%: item.ItemCode %>" /> 
```

而不是`onclick`，仅使用 jQuery 绑定事件处理程序，并立即执行您需要的所有操作：

```
$("#SubmitCommentsForBOQ").click(function () {
    var itemCode = $(this).data('itemCode');
    ShowCommentBox(itemCode);
});

$("#SubmitCommentsForTwo").click(function () {
    $("#hiddenBox").show();
    var itemCode = $(this).data('itemCode');
    ShowCommentBox(itemCode);
}); 
```

多个处理程序将按照它们绑定的顺序执行，因此您也可以执行以下操作：

```
// happens first, but only for this specific button
$("#SubmitCommentsForTwo").click(function () {
    $("#hiddenBox").show();
});

// happens for all buttons
$("input[data-item-code]").click(function () {
    var itemCode = $(this).data('itemCode');
    ShowCommentBox(itemCode);
}); 
```

# ios - UIsystemfonts之间的区别

> ID：15603985
> 
> 赞同：0
> 
> 时间：2013-03-24T21:04:30.903
> 
> 标签：ios, objective-c, cocoa-touch

我是学习obj-c的新手。当我输入以下行时

```
NSLog(@"System fonts are %@", [UIFont familyNames]) 
```

我得到以下输出。

```
Thonburi,
"Snell Roundhand",
"Academy Engraved LET",
Avenir,
"Marker Felt",
"Geeza Pro",
"Arial Rounded MT Bold",
"Trebuchet MS",
Arial,
Marion,
"Gurmukhi MN",
"Malayalam Sangam MN",
"Bradley Hand",
"Kannada Sangam MN",
"Bodoni 72 Oldstyle",
Cochin,
"Sinhala Sangam MN",
"Hiragino Kaku Gothic ProN",
Papyrus,
Verdana,
"Zapf Dingbats",
"Avenir Next Condensed",
Courier,
"Hoefler Text",
Helvetica,
"Euphemia UCAS",
"Hiragino Mincho ProN",
"Bodoni Ornaments",
"Apple Color Emoji",
Optima,
"Gujarati Sangam MN",
"Devanagari Sangam MN",
"Times New Roman",
Kailasa,
"Telugu Sangam MN",
"Heiti SC",
"Apple SD Gothic Neo",
Futura,
"Bodoni 72",
Baskerville,
"Chalkboard SE",
"Heiti TC",
Copperplate,
"Party LET",
"American Typewriter",
Symbol,
"Avenir Next",
Noteworthy,
"Bangla Sangam MN",
Zapfino,
"Tamil Sangam MN",
Chalkduster,
"Arial Hebrew",
Georgia,
"Helvetica Neue",
"Gill Sans",
Palatino,
"Courier New",
"Oriya Sangam MN",
Didot,
"Bodoni 72 Smallcaps" 
```

我只是想知道为什么在带有多个单词的字体名称周围有引号？

```
Thonburi vs "Snell Roundhand" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T21:05:23.377

NSLog 打印`"`-quotes，如果它超过一个单词，只是为了明确字符串的开始和结束位置。它应该在 NSArray 的描述方法中定义，因为它们仅在打印字符串数组时使用。[感谢 omz 指出这一点。]

它与字体无关：

```
NSArray *strings = @[@"Lorem ipsum dolor sit amet", @"gubergren"];
NSLog(@"%@", strings);
NSLog(@"%@", strings[0]); 
```

印刷

```
2013-03-24 22:18:42.922 stringprinting[22876:303] (
    "Lorem ipsum dolor sit amet",
    gubergren
)
2013-03-24 22:18:42.923 stringprinting[22876:303] Lorem ipsum dolor sit amet 
```

如果要打印不带引号的所有名称，可以单独打印每个名称

```
[[UIFont familyNames] enumerateObjectsUsingBlock:^(NSString *obj, NSUInteger idx, BOOL *stop) {
    NSLog(@"%@", obj);
}]; 
```

结果

```
Thonburi
Snell Roundhand
Academy Engraved LET
Avenir
Marker Felt
Geeza Pro
Arial Rounded MT Bold
… 
```

# jquery - 使用 addMethod 的 jquery 验证在不应该时失败

> ID：15603990
> 
> 赞同：1
> 
> 时间：2013-03-24T21:04:57.240
> 
> 标签：jquery, validation

我有一个想法，这可能很愚蠢，但我已经坚持了几个小时。

我有一个简单的表单，使用 ajax 进行 jquery 验证以确定电子邮件地址是否已经在数据库中。效果很好。当找到一个电子邮件地址时，它会报告重复，当它不是时，它会保持沉默。

但是当我输入一封我知道是新的电子邮件并填写表格的其余部分并按提交时，它会阻止表格提交并将焦点设置在电子邮件字段上。

这是jQuery：

```
$(document).ready(function(){
var email;
var name;
var passwd;
var passwd_repeat;

     //form validation rules
     $("#regForm1").validate({
         rules: {
            name: {
                required: true,
                minlength: 3,
            },
            passwd: {
                required: true,
                minlength: 8,
            },
            passwd_repeat: {
                required: true,
                equalTo: passwd,
                minlength: 8
            }
         },
         messages:
         {
             name: "Please enter your name.",
             passwd: "Please enter a password.",
             passwd_repeat: "Passwords must match."
         }
     });

    $.validator.addMethod("validateUserEmail", function(value, element) {
        var inputElem = $('#regForm1 :input[name="email"]'),
        data = { "email=" : inputElem.val() },
        eReport = ''; //error report*/
        var dataString = 'email='+ inputElem.val();
        $.ajax( {
            type: "POST",
            url: '/checkdups.php',
            data: dataString,
            success: function(html) {
                if (html !== 'true') {
                  $('#email').after('<label class="error" for="email">error - '+inputElem.val()+' already in use. Please <a href="http://tester4.com/staff/auth/login">Log in</a> with '+inputElem.val()+'.</label>');
                  return false;
                }
                else {
                    return true;
                }
            },
            error: function(xhr, textStatus, errorThrown)
            {
                alert('ajax loading error... ... '+url + query);
                return false;
            }
        });
    }, 
'');

$(':input[name="email"]').rules("add", { "validateUserEmail" : true} ); 
```

});

我正在使用 addMethod 而不是使用 .remote 添加规则，因为我无法让事情比第一次更有效（这意味着它不会在没有页面刷新的情况下拒绝一连串的欺骗），这被建议为解决方法。当我注释掉添加的方法时，它允许我提交表单，但当然不会检查是否有欺骗性。

无论如何，任何见解都将不胜感激。

约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:48:09.677

你真的应该使用`remote`. 我不确定为什么您没有按预期工作 - 远程肯定**会**被多次调用。默认情况下，它的工作方式是在您点击提交之前不调用远程页面，然后如果您的远程调用说它很糟糕，那么之后的每次击键都会生成一个新的远程调用。

这是一个[简单的工作示例](http://jsfiddle.net/ryleyb/yqzDS/)，您可以从中构建。我将其设置为始终返回 false，直到您进行 3 次更改。因此，您应该能够按照以下步骤操作：

1.  输入 john@rand.com 并单击提交。请注意，它被标记为无效。
2.  删除 m（无效）
3.  删除o（无效）
4.  删除 c（无效，但由于它现在不是有效的电子邮件地址）
5.  类型`com`（固定）
6.  提交（作品）

该小提琴的关键代码在规则对象中（响应是此示例的全局计数器）：

```
rules: {
    email: {
        email: true, 
        remote: {
            url: '/echo/json/',
            data: {
                json: function(){
                    response++;
                    return (response > 3)?'true':'false';
                }
            },
            complete: function(data){
                $('#log').append('remote triggered<br>');
            },
            type: 'post'
        },
        required: true
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T21:32:44.803

@Ryley，感谢您的回复。我重试了遥控器，效果很好。我想我的 Firefox 缓存有问题。

我的和你的很像，谢谢！

# c++ - 从程序参数传递的 C++ 信号名称

> ID：15603993
> 
> 赞同：0
> 
> 时间：2013-03-24T21:05:15.580
> 
> 标签：c++, type-conversion, signals

所以我遇到了这个问题，我想用主函数的参数调用我的程序（假设我这样调用它：*程序 SIGQUIT*）并将这个参数传递给代码中的 kill() 和 signal() 函数。

我要问的问题是：如何从包含“SIGQUIT”的字符类型 argv[2] 中获取整数信号编号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T01:04:21.637

为什么不直接用字符串和对应的 建立一个查找表`int`呢？如果您只需要系统上定义的信号，您将需要以下内容：

```
#include <csignal>
#include <map>
#include <string>
#include <iostream>
#include <cassert>

int main(int argc, char *argv[]){
    // lookup table
    std::map<std::string, int> lookup_table;
#define ADD_SIGNAL(X)    lookup_table.insert(std::make_pair(#X,X));
    // standard signals
    ADD_SIGNAL(SIGABRT);
    ADD_SIGNAL(SIGFPE);
    ADD_SIGNAL(SIGILL);
    ADD_SIGNAL(SIGINT);
    ADD_SIGNAL(SIGSEGV);
    ADD_SIGNAL(SIGTERM);

    // implementation specific signals
#ifdef SIGKILL
    ADD_SIGNAL(SIGKILL);
#endif
#ifdef SIGSTOP
    ADD_SIGNAL(SIGSTOP);
#endif
    // ...

#undef ADD_SIGNAL

    assert(argc > 1 && "No signal");
    std::string sig = argv[1];

    std::map<std::string, int>::iterator it = lookup_table.find(sig);
    if(it != lookup_table.end())
        std::cout << "Signal " << it->first << ": " << it-> second << std::endl;
    else
        std::cout << "Unknown signal " << sig << std::endl;
} 
```

编写所有信号有点长，您可以使用此命令行（假设为 POSIX）来生成它们：

```
 kill -l  | sed 's/[0-9]*)//g'
          | grep -v "[+-]"  
          | xargs -n1 echo 
          | awk '{ print "#ifdef " $0 "\n\tADD_SIGNAL(" $0 ")\n#endif" }' 
```

# javascript - 调用函数并忽略回调参数

> ID：15603997
> 
> 赞同：1
> 
> 时间：2013-03-24T21:05:30.377
> 
> 标签：javascript, callback

我想这样称呼：

```
function fwc(a, b, callback) {

dosomestuff(a,b);
callback();
} 
```

有了这个：

```
fwc (a,b); 
```

有时我需要回调，有时我不需要。当我调用函数并完全忽略回调时，这会导致麻烦吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-24T21:06:37.177

如果你不能改变`fwc`函数，你可以这样调用它：

```
fwc(a, b, function(){}); 
```

`fwc`这样在尝试调用第三个参数时不会出错。

如果可以更改，请更改为

```
function fwc(a, b, callback) {
    dosomestuff(a,b);
    if (callback) callback();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-24T21:07:24.233

您应该像这样检查回调的类型：

```
function fwc(a, b, callback) {
 dosomestuff(a,b);
 if( typeof( callback ) == "function" ){
  callback();
 }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-24T21:09:08.070

或者像这样：

```
function fwc(a, b, callback) {
    dosomestuff(a,b);
    callback && callback();
} 
```

您还可以检查`callback`类型以确保它是一个函数。如果是这样，请检查 Travis 的一般答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-24T21:07:14.433

使用三元运算符做一个简单的检查，看看函数是否存在。

```
function fwc(a, b, callback) {
    dosomestuff(a,b);
   (callback) ? callback():"";
} 
```