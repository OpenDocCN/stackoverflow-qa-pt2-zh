# StackOverflow 问答 14790000-14790999

# java - 从 sqlite 填充列表视图

> ID：14790001
> 
> 赞同：0
> 
> 时间：2013-02-09T16:13:30.290
> 
> 标签：java, android, sqlite, list

首先，我是一个完整的 Java 菜鸟。到目前为止，脚本语言完成了我需要的一切工作，但现在我需要创建一个 Android 应用程序并且迷路了。

我正在尝试使用 sqlite 数据库中的项目填充 ListView。该工作的各个部分，但我不能让它们一起工作。

数据库查询：

```
Cursor cursor = database.query("db", new String[] { "_id", "name", "count", "should" }, null, null, null, null, null); 
```

列表项.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="40dp"
android:orientation="horizontal" >

    <TextView
        android:id="@+id/ItemName"
        android:layout_width="fill_parent"
        android:layout_height="40dp"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"
        android:layout_toLeftOf="@+id/ItemCount"
        android:text="TextView" />

    <TextView
        android:id="@+id/ItemCount"
        android:layout_width="50dp"
        android:layout_toLeftOf = "@+id/buttonminus"
        android:layout_height="40dp"
        android:layout_centerVertical="true"
        android:text="TextView" />
    <TextView
        android:id="@+id/ItemShould"
        android:layout_width="50dp"
        android:layout_toLeftOf = "@+id/buttonminus"
        android:layout_height="40dp"
        android:layout_centerVertical="true"
        android:text="TextView" />
    <Button
        android:id="@+id/buttonminus"
        android:layout_width="40dp"
        android:layout_height="40dp"
        android:onClick="buttonMinus"
        android:layout_centerVertical="true"
        android:layout_toLeftOf = "@+id/buttonplus"
        android:focusable="false"
        android:text="-" />        

    <Button
        android:id="@+id/buttonplus"
        android:layout_width="40dp"
        android:layout_height="40dp"
        android:layout_alignParentRight = "true"
        android:focusable="false"
        android:layout_centerVertical="true"
        android:onClick="buttonPlus"
        android:text="+" />

</RelativeLayout> 
```

我有一个可用的 java 代码，它用一个固定的数组填充该列表，但无法在其中获取 db 查询：

```
 private String[][] ItemsArray =
        {{"Test1","10"},
            {"Test2","20"},
            {"Test3","123"},
            {"Test4","456"}}; 
    HashMap<String,String> item;
    for(int i=0;i<ItemsArray.length;i++){
      item = new HashMap<String,String>();
      item.put( "ItemName", ItemsArray[i][0]);
      item.put( "ItemCount", ItemsArray[i][1]);
      item.put( "ItemShould", ItemsArray[i][2]);
      list.add( item );
    }        
    sa = new SimpleAdapter(this, list, R.layout.mylistitem, new String[] { "ItemName","ItemCount","ItemShould" }, new int[] {R.id.ItemName, R.id.ItemCount, R.id.ItemShould});        
    setListAdapter(sa); 
```

此外，我需要将 id 放在该列表中的某个位置（不可见），以便稍后使用它来删除该行，完全不知道该怎么做:-(

非常感谢您的帮助。

更新：像这样尝试过，但这会导致应用程序变为 FC

```
Cursor cursor = database.query("inventory", new String[] { "_id", "name", "ist", "soll" }, null, null, null, null, null);

int i = 0;
cursor.moveToFirst();
HashMap<String,String> item;
ArrayList<HashMap<String,String>> list = new ArrayList<HashMap<String,String>>();
while (cursor.isAfterLast() == false) {
    item = new HashMap<String,String>();
    item.put( "ItemName", cursor.getString(1));
    item.put( "ItemCount", cursor.getString(2));
    list.add( item );
    cursor.moveToNext();
}
cursor.close();

sa = new SimpleAdapter(this, list, R.layout.mylistitem, new String[] { "ItemName","ItemCount","ItemShould" }, new int[] {R.id.ItemName, R.id.ItemCount, R.id.ItemShould});        
setListAdapter(sa); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T07:49:50.103

使用数据库公共类 DBHelper 的帮助程序示例扩展 SQLiteOpenHelper {

```
public static interface DESTINATION extends BaseColumns {
        String TABLE_NAME = "destination";
        String NAME = "name";
    }

private static final String CREATE_TABLE = "CREATE TABLE IF NOT EXISTS ";

private static final String CREATE_TABLE_DESTINATION = CREATE_TABLE + DESTINATION.TABLE_NAME + " (" 
            + DESTINATION._ID + " INTEGER PRIMARY KEY , " + DESTINATION.NAME + " TEXT );";

private static final String DATABASE_NAME = "TravelCompany";
    private static final int DATABASE_VERSION = 2;
public DBHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }
@Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(CREATE_TABLE_DESTINATION);
    }

@Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        db.execSQL("DROP TABLE IF EXISTS " + DESTINATION.TABLE_NAME);
        onCreate(db);
    }
public void insertDestination(String destinationName) {
        ContentValues values = new ContentValues();
        values.put(DESTINATION.NAME, destinationName);
        getWritableDatabase().insert(DESTINATION.TABLE_NAME, null, values);
    }
public Cursor getAllDestination() {
        return getReadableDatabase().query(DESTINATION.TABLE_NAME, new String[] { DESTINATION.NAME }, null,
                null, null, null, null);
    }
}
Than create layout with listview. Add another layout for one row. 

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
android:layout_width="match_parent" 
android:layout_height="match_parent" 
android:orientation="vertical" >

&lt;TextView
        android:id="@+id/rowText" 
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content" />
</LinearLayout> 
```

并像这里一样创建适配器：

DBHelper dataHelper = new DBHelper(this);

ListView testList = (ListView) findViewById(R.id.mylist);

SimpleCursorAdapter 适配器 = new SimpleCursorAdapter(this, R.layout.row_myrow, testCursor,

新字符串 [] { DBHelper.DESTINATION.NAME }，新整数 [] { R.id.rowText }，

SimpleCursorAdapter.IGNORE_ITEM_VIEW_TYPE);

testList.setAdapter（适配器）；

# ado.net - System.EntryPointNotFoundException：找不到名为“AsaConnection_CloseDataRead”的入口点

> ID：14790004
> 
> 赞同：1
> 
> 时间：2013-02-09T16:13:40.027
> 
> 标签：ado.net, sqlanywhere

我的应用程序使用 SQL Anywhere ADO .NET 数据提供程序。我在本周早些时候升级了我的应用程序以使用 SQL Anywhere 12.0.1 EBF 3840，但我不得不在周五将其回滚到 EBF 3817。我的程序启动时出现以下错误：

```
System.EntryPointNotFoundException: Unable to find an entry point named 'AsaConnection_CloseDataReaders' in DLL 'dbdata12.dll'. 
```

我进行了搜索，发现了有关 dbdata12.dll 的[文档页面。](http://dcx.sybase.com/1201/en/dbprogramming/adodotnet-dev-dbdata.html)我已经在我的机器上搜索了 C: 驱动器，但在上面的任何地方都找不到 dbdata12.dll。显然，该程序也没有解压它。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T18:43:29.310

在另一位开发人员的帮助下，我已经解决了这个问题。

问题是卸载程序不会从 GAC 中删除所有 3840 DLL。具体来说，我发现了 iAnywhere.Data.SQLAnywhere.V4.0.dll 和 policy.12.0.iAnywhere.Data.SQLAnywhere.V4.0.dll 和 policy.12.0.iAnywhere.Data.SQLAnywhere.V4.5.dll 的副本EBF 3840 的 C:\Windows\Microsoft.NET\assembly\GAC_MSIL 文件夹，即使在我从计算机上卸载了 SQL Anywhere 两次之后也是如此。

一旦我删除了这些 DLL，问题就停止了。

# oracle - 插入同一张表后更新表列-PLSQL

> ID：14790007
> 
> 赞同：2
> 
> 时间：2013-02-09T16:14:11.713
> 
> 标签：oracle, plsql

一个表中有 4 列，marks1、marks2、marks3 和 total。当我们插入标记 1、标记 2 和标记 3 时，触发器应该计算总数并更新总数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:36:07.507

如果碰巧您使用的是 Oracle 11g，为了获得所需的结果，您可以向表中添加一个虚拟列：

```
SQL> create table your_table(
  2    marks1 number,
  3    marks2 number,
  4    marks3 number
  5  )
  6  ;

Table created

SQL> 
SQL> alter table your_table
  2    add total number generated always as (nvl(marks1, 0)+
  3                                          nvl(marks2, 0)+
  4                                          nvl(marks3, 0)
  5                                          )
  6  ;

Table altered

SQL> insert into your_table(marks1,marks2,marks3)
  2    values(1,2,3);

1 row inserted

SQL> commit;

Commit complete

SQL> select * from your_table;

    MARKS1     MARKS2     MARKS3      TOTAL
---------- ---------- ---------- ----------
         1          2          3          6 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T16:41:40.767

```
create or replace trigger calc_total
before insert on your_table
for each row
begin
  :new.total := :new.marks1 + :new.marks2 + :new.marks3;
end; 
```

# c# - 在深度克隆时保持对静态类的引用

> ID：14790009
> 
> 赞同：1
> 
> 时间：2013-02-09T16:14:13.610
> 
> 标签：c#, class, static, copy, deep-copy

我正在开发用于管理任务的应用程序。每个任务都有自己的状态。并且每个状态都必须易于分配（例如 enum -- task1.status = statuses.started）。而且每个状态都必须知道它的显示颜色、名称等。所以它不能是简单的枚举（我需要类似 --task1.status.color 的东西）。我不想使用 switch，或者很多 ifs。一切都必须非常快（因为这将被迭代很多次）并且代码必须是干净的。

我做了什么：

```
public class BaseStatusType {

        public Color color;
        private string name;

        public BaseStatusType() { 

        }

        public override string ToString()
        {
           return "status" + name;
        }

        [Serializable]
        public class Untaken : BaseStatusType
        {

            public Untaken()
            {

                color = Appname.Core.App.Default.statusUntaken;
                name = "Untaken";

            }

        } 
```

......还有几种任务类型（采取，开始，结束，计费）更像这样..

然后是状态类

```
 public class Status
        {

            public BaseStatusType Type;

            public Status()
            {

                this.Type = StatusType.statusUntaken;

            }
     } 
```

最重要的静态部分。由于这部分，它可以很容易地分配。

```
[Serializable]
    public static class StatusType {

        public static BaseStatusType.Untaken statusUntaken = new BaseStatusType.Untaken();
        public static BaseStatusType.Taken statusTaken = new BaseStatusType.Taken();
        public static BaseStatusType.Started statusStarted = new BaseStatusType.Started();
        public static BaseStatusType.Ended statusEnded = new BaseStatusType.Ended();
        public static BaseStatusType.Billing statusBilling = new BaseStatusType.Billing();            

    } 
```

现在，所有状态都在应用启动时初始化一次。并非每次创建状态。在创建新任务时，会创建新状态，但它的类型只是分配的，而不是新创建的。

```
Status status1 = new Status();
            status1.Type = StatusType.statusEnded;
            Color somecolor = status1.Type.color; 
```

现在解决问题。一切正常，直到我 deepClone 对象任务。我的 deepClone 使用序列化/反序列化。问题可以这样描述：

```
 Task task1 = new Task();
            task1.Status.Type = StatusType.statusEnded;

            Task task2 = new Task();
            task2 = task1.DeepClone();

            if (task1.Status.Type == StatusType.statusEnded) { 

                //this returns true

            }

            if (task2.Status.Type == StatusType.statusEnded)
            {

                //this returns false

            }

            if (task2.Status.Type.ToString() == StatusType.statusEnded.ToString())
            {

                //this returns true

            } 
```

这可能是因为它在 DeepCopy 时创建了自己的 StatusType.statusEnded。但我不明白为什么。Status.Type 不应该只包含对静态对象的引用吗？我是这么说的。这就是为什么我不担心 DeepCopy。它应该只制作引用的副本，而不是静态对象的副本。

那么，如果没有静态值的地址，那么属性状态是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T17:04:53.077

您的`Status.Type`财产不是静态的。当您 DeepClone 对象时，会创建一个新实例并将其分配给克隆的实例。

您有两种解决方法：

1.  修改 DeepClone 以查找现有实例并将其分配给克隆，而不是创建副本
2.  实现 IEquatable 并覆盖通常的嫌疑犯：GetHashCode、Equals、== 和 !=

#2 的优点是您不必确保您的状态对象是不可变的单例（即保证只有一个实例并且一旦创建就永远不会修改）。这是一个简单的编程模型，我怀疑它会丝毫影响您的应用程序的性能。

以下是实现 IEquatable 接口的类的示例：

```
public class Identity : IEquatable<Identity>
{
    public Guid UniqueIdentifier { get; set; }
    public string Name { get; set; }

    public bool IsEmpty
    {
        get { return UniqueIdentifier == Guid.Empty; }
    }

    #region Construction
    public Identity()
    {
    }

    public Identity( Guid uniqueIdentifier, string name )
    {
        UniqueIdentifier = uniqueIdentifier;
        Name = name;
    } 
    #endregion

    public override string ToString()
    {
        return string.IsNullOrWhiteSpace( Name ) ? UniqueIdentifier.ToString() : Name;
    }

    #region IEquatable
    public override int GetHashCode()
    {
        return ToString().GetHashCode();
    }

    public override bool Equals( object obj )
    {
        return Equals( obj as Identity );
    }

    public static bool operator ==( Identity left, Identity right )
    {
        if( ReferenceEquals( null, left ) )
            return ReferenceEquals( null, right );
        return left.Equals( right );
    }

    public static bool operator !=( Identity left, Identity right )
    {
        if( ReferenceEquals( null, left ) )
            return !ReferenceEquals( null, right );
        return !left.Equals( right );
    }

    public bool Equals( Identity other )
    {
        if( ReferenceEquals( null, other ) )
            return false;
        return ToString() == other.ToString();
    }
    #endregion
} 
```

# c# - 在 EntityFramework 中克隆具有多对多关系的对象

> ID：14790012
> 
> 赞同：3
> 
> 时间：2013-02-09T16:14:19.483
> 
> 标签：c#, linq, clone, entity-framework-5

我想要的只是创建一个对象的精确副本。

我有一堂课

```
[Serializable]
public class Project 
{
    public int Id { get; set; }
    public String Name { get; set; }

    //navigational fields..
    public virtual List<BusinessRequirement> BusinessRequirements { get; set; }
 } 
```

和另一个

```
[Serializable]
public class BusinessRequirement 
{
   public int Id { get; set; }
   public String Name { get; set; }
   public String Description { get; set; }
   public virtual List<Project> Projects { get; set; }
} 
```

所以我在某处配置了多对多的黑白关系`Project`，`BusinessRequirement`如下所示：

```
HasMany(s => s.BusinessRequirements)
           .WithMany(s => s.Projects)
           .Map(m =>
            {
                   m.MapLeftKey("ProjectId");
                   m.MapRightKey("BusinessRequirementId");
                   m.ToTable("ProjectBusinessRequirementMapping");

            }); 
```

而且我也让我的 dbcontext 静态，即

```
public static class DataLayer
{
    public static MyDbContext db;
} 
```

现在，我所做的只是尝试复制`Project`ie的对象

```
public Project Clone(Project source)
{

     Project  target = new Project();
     target.Name = source.Name;
     //1.
     // target = source;    

     //2.
     target.BusinessRequirements = new List<BusinessRequirement>();
     foreach(BusinessRequirement br in source.BusinessRequirements)
     {
       BusinessRequirement nbr = DataLayer.Get<BusinessRequirement>(s=>s.Id=br.Id).SingleOrDefault();
        if(nbr!=null)
          target.BusinessRequirements.Add(nbr);
     }  

     //3.
     //target.BusinessRequirements = source.BusinessRequirements;

     //4.
     //target.BusinessRequirements = new List<BusinessRequirement>();
     //foreach(BusinessRequirement br in source.BusinessRequirements)
     //{
     //  BusinessRequirement nbr = br;
     //   if(nbr!=null)
     //     target.BusinessRequirements.Add(nbr);
     //}  

      return target;
} 
```

这四种方法都不能正常工作。

最接近工作的是2，但是发生了一件奇怪的事情。现在，如果我将任何 BusinessRequirements 添加到`Original Project`，它也会被添加到`Clonned One`，反之亦然，删除也是如此。

不知何故，实体框架将这两个项目视为一个项目。虽然这种行为只发生在多对多相关的导航属性中。

为什么 EntityFramework 的行为是这样的？？？。我错过了什么？请帮忙..

它已经快一天了，但我无法让它工作。

我试过[这个](http://ox.no/posts/extension-methods-for-copying-or-cloning-objects)，[这个](http://www.codeproject.com/Articles/137853/Cloning-the-Entity-object-and-all-related-children)，[这个](https://stackoverflow.com/questions/7172725/copy-entity-framework-object)和[这个](https://github.com/havard/copyable)，但他们也没有工作..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T15:45:50.570

您可以使用将对象添加到上下文将其对象图中任何子对象的状态更改为`Added`：

```
Project proj;
using (var db = new MyDbContext())
{
    // Fetch a detached project and populate its BusinessRequirements.
    proj = db.Projects.AsNoTracking().Include(p => p.BusinessRequirements)
             .First(p => p.Id == source.Id);
    db.Projects.Add(proj);
    db.SaveChanges();
} 
```

通过使用`AsNoTracking`上下文获取源项目不会将其添加到其更改跟踪器中，并且下一行将`db.Projects.Add(proj);`项目及其附属子对象视为全新的。

默默地，我放弃了你在一个静态上下文中工作的策略。这是一个不同的话题，但你不应该那样做。上下文应该有很短的生命周期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T16:56:29.433

由于您复制 BusinessRequirement 的方式而存在问题。您只是将引用从源添加到目标。因此，每个 BusinessRequirement 最终都会引用两个项目。

你需要做这样的事情。

```
 target.BusinessRequirements = new List<BusinessRequirement>();
         foreach(BusinessRequirement br in source.BusinessRequirements)
         {
           BusinessRequirement obr = DataLayer.Get<BusinessRequirement>(s=>s.Id=br.Id).SingleOrDefault();
BusinessRequirement obr = new BuisnessRequirment();
            if(nbr!=null){
//copy protperies in obr to nbr
}
              target.BusinessRequirements.Add(nbr);
         } 
```

# jsf - Ajax 更新/渲染不适用于具有渲染属性的组件

> ID：14790014
> 
> 赞同：57
> 
> 时间：2013-02-09T16:14:32.067
> 
> 标签：jsf, jsf-2, rendered-attribute, conditional-rendering, ajax-update

我正在尝试对有条件渲染的组件进行 ajax 更新。

```
<h:form>
    ...
    <h:commandButton value="Login" action="#{login.submit}">
        <f:ajax execute="@form" render=":text" />
    </h:commandButton>
</h:form>
<h:outputText id="text" value="You're logged in!" rendered="#{not empty user}" /> 
```

但是，这是行不通的。我可以保证这`#{user}`实际上是可用的。这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2013-02-09T20:04:26.237

如果组件本身未首先呈现，则无法通过 ajax 重新呈现（更新）组件。必须始终在 ajax 重新渲染之前渲染组件。Ajax 使用 JavaScript`document.getElementById()`来查找需要更新的组件。但是如果 JSF 没有首先渲染组件，那么 JavaScript 就找不到任何要更新的东西。

解决方案是简单地引用始终呈现的父组件。

```
<h:form>
    ...
    <h:commandButton ...>
        <f:ajax ... render=":text" />
    </h:commandButton>
</h:form>
<h:panelGroup id="text">
    <h:outputText ... rendered="#{not empty user}" />
</h:panelGroup> 
```

### 也可以看看：

*   [当我想对它进行 ajax 更新时，为什么需要在另一个组件中嵌套一个带有 render="#{some}" 的组件？](https://stackoverflow.com/questions/9010734/why-do-i-need-to-nest-a-component-with-rendered-some-in-another-component-w/)
*   [如何找出用于 ajax 更新/渲染的组件的客户端 ID？找不到从“bar”引用的表达式“foo”的组件](https://stackoverflow.com/questions/8634156/how-to-find-out-client-id-of-component-for-ajax-update-render-cannot-find-compo/)

# jquery - 通过减少元素的实际值来制作动画

> ID：14790016
> 
> 赞同：0
> 
> 时间：2013-02-09T16:14:42.383
> 
> 标签：jquery, jquery-animate

我需要通过为每个元素减少 30px 来更改元素的顶部位置。

假设我希望 50px 为 20px 和 100px 为 70px 等等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T16:15:45.880

您可以使用`-=`符号来减少属性的当前值。尝试这个：

```
$('#foo').animate({ top: '-=30px' }, 1000); 
```

注意，`1000`是动画完成所需的毫秒数，可以根据需要进行修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T16:15:52.877

`$(".elementClass").animate({"top": "-=30"}, 500);`
`30`是要减少高度的像素数。`500`是动画的毫秒数。

一个工作演示： http: [//jsfiddle.net/JNUUs/](http://jsfiddle.net/JNUUs/)
我添加`.delay(500)`了在动画之前等待 500 毫秒。

# node.js - node.js 版本号如何工作以及如何确保兼容性？

> ID：14790017
> 
> 赞同：12
> 
> 时间：2013-02-09T16:14:48.607
> 
> 标签：node.js, versioning

项目的版本控制风格是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-09T20:24:28.907

您应该只使用偶数版本：`x.[even].z`. 这些都是“稳定的”，错误修复将发布给他们（直到下一个小版本）。`x.[even].z`在任何给定时间仅支持最新版本。

为了兼容性，您应该只查看文档。例如，对于事件：[http ://nodejs.org/api/events.html](http://nodejs.org/api/events.html)

> 稳定性：4 - API 冻结

这意味着您可以放心 EventEmitter 类永远不会改变。

[然后是域](http://nodejs.org/api/domain.html)之类的东西，没有人知道他们在做什么，你可能不应该使用它：

> 稳定性：1 - 实验

您最好的办法就是坚持使用`Stability >= 3`功能，而不用担心版本之间的兼容性。

此外，似乎没有严格的发布周期。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-09T16:35:10.490

Node 有一个双轨版本控制系统。偶数版本（0.4、0.6、0.8）稳定，奇数版本不稳定。稳定版本是 API 稳定的，这意味着如果您使用 0.8.1 并且 0.8.2 出现，您应该能够毫无问题地升级。

在 0.9.x 流上，任何更新都可能更改 API，尤其是在系统中正在积极开发的部分中。当奇数版本达到一定程度的稳定性和成熟度时，它将成为下一个偶数版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T22:11:04.800

没有严格的定时发布周期。Node.JS 的主要维护者是一个名叫 Isaac Schleuter 的人，他一直非常公开地谈论他在 node 上的目标和目标。他也对很多社区的意见持开放态度，因此他们举办 NodeConf 和 Node Summer Camp 以及其他一些活动来收集意见。

如果您有时间真正深入社区，请查看[NodeUp 播客](http://nodeup.com/)和 Isaac 的一些演讲，了解他们的发展方向和 API。

您询问版本 1.0。据我记得，Isaac 在进入 1.0 版之前有几件具体的事情要稳定下来。特别是，我记得 Streams 和 Buffers 确实成为 node 增长的关键。（*也就是说，这只是记忆中的*）

# multithreading - 线程：当一个线程运行时，您可以与另一个线程交互吗？

> ID：14790018
> 
> 赞同：1
> 
> 时间：2013-02-09T16:14:55.313
> 
> 标签：multithreading, concurrency

所以我现在正在学习线程，我想知道一些事情是如何处理的。例如，假设我有一个程序，其中一个线程侦听输入，另一个线程在单个处理器上执行一些计算。当计算线程运行时，如果用户按下输入线程的按钮会发生什么？在切换到特定线程之前，输入线程不会忽略输入吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T00:13:58.737

这很大程度上取决于输入机制是如何实现的。实现 I/O 的一种简单但非常不优雅的方法是*连续轮询*......在这种情况下，输入线程可能处于循环中，一遍又一遍地读取硬件寄存器，并且当寄存器中的值发生变化时从 0 到 1，输入线程会知道按钮被按下：

```
void inputThread()
{
   while(1)
   {
      if (some_register_indicates_the_button_is_pressed()) react();
   }
} 
```

这种方法的问题在于它的效率非常低——输入线程使用了数十亿个 CPU 周期，只是一遍又一遍地检查寄存器。在运行此代码的多线程系统中，线程调度程序将在每个时间段（例如每 10 毫秒一次）在忙等待的输入线程和计算线程之间切换 CPU，因此输入线程将使用一半的 CPU 周期和计算线程会用另一半。在这个系统中，如果输入线程在用户按下按钮的那一刻正在运行，那么输入几乎会在瞬间被检测到，但是如果计算线程正在运行，那么直到下一次输入线程得到时才会检测到输入运行，所以可能会有多达 10 毫秒的延迟。（更糟糕的是，如果用户过早释放按钮，

对连续轮询的改进是*调度轮询*。它的工作原理与上面相同，只是输入线程不是在循环中轮询，而是轮询一次，然后休眠一会儿，然后再次轮询：

```
void inputThread()
{
   while(1)
   {
      if (some_register_indicates_the_button_is_pressed()) react();
      usleep(3000);  // sleep for 30 milliseconds
   }
} 
```

这与第一种情况相比效率要低得多，因为每次调用 usleep() 时，线程调度程序都会将输入线程置于睡眠状态，并且 CPU 立即可供任何其他线程使用。usleep() 还设置了一个硬件计时器，当该硬件计时器关闭时（30 毫秒后），它会引发一个中断。中断导致 CPU 停止它正在做的任何事情并再次运行线程调度代码，并且线程调度代码将（在大多数情况下）意识到 usleep() 返回的时间，并唤醒输入线程因此它可以对其循环进行另一次迭代。这仍然不是完美的：inputThread 仍在持续使用少量 CPU —— 不多，但如果你做很多这样的实例，它就会开始累加起来。还，

这导致我们使用*中断驱动的 I/O*。在这个模型中，输入线程根本不轮询；相反，它告诉操作系统在按下按钮时通知它：

```
void inputThread()
{
   while(1)
   {
      sleep_until_button_is_pressed();
      react();
   }
} 
```

反过来，操作系统的通知工具必须进行设置，以便在按下按钮时通知操作系统，以便操作系统可以唤醒并通知输入线程。操作系统通过告诉按钮的控制硬件在按钮被按下时产生中断来做到这一点。一旦该中断关闭，它的工作方式与前面示例中的定时器中断很相似；CPU 运行线程调度程序代码，它发现是时候唤醒输入线程，并让输入线程运行。这种机制具有非常好的特性：（1）输入线程在按下按钮时尽快被唤醒（没有等待计算线程首先完成其量子），以及（2）输入线程不会吃光任何 CPU 周期，除非按下按钮。由于这些优点，它'

请注意，在现代 PC 或 Mac 上，不仅仅是两个线程和一个硬件按钮；例如，有几十个硬件设备（键盘、鼠标、显卡、硬盘、网卡、声卡等）和几十个程序同时运行，操作系统的工作是在必要时在它们之间进行调解。尽管如此，一般原则还是一样的。假设在您的示例中，用户单击的按钮不是物理按钮，而是屏幕上的 GUI 按钮。在这种情况下，会发生以下事件序列：

1.  用户的手指按下鼠标左键
2.  鼠标的内部硬件通过 USB 电缆向计算机的 USB 控制器发送鼠标按钮按下消息
3.  计算机的 USB 控制器产生中断
4.  中断导致 CPU 中断计算线程的代码并运行 OS 的调度程序例程
5.  线程调度程序看到 USB 中断线指示 USB 事件已准备好，并通过运行 USB 驱动程序的中断处理程序代码来响应
6.  USB 驱动程序的中断处理程序代码读入事件，发现它是鼠标按钮按下事件，并将其传递给窗口管理器
7.  窗口管理器知道哪个窗口具有焦点，因此它知道将鼠标按钮按下事件转发给哪个程序
8.  窗口管理器告诉操作系统唤醒与该窗口关联的输入线程
9.  您的输入线程唤醒并调用 react()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T16:19:17.093

如果您在单处理器系统上运行，那么可以。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T16:19:27.503

嗯，线程可以通过多种方式相互通信。其中之一是具有全局变量并将其用作线程之间通信的缓冲区。
当您询问按钮时，必须有一个包含事件加载器循环的线程。根据我的经验，在这个线程中，输入不会被忽略。

你可以看到我关于这个主题的一些线程：
[在这里](https://stackoverflow.com/questions/14690990/custom-blocking-function-in-c)，我对如何制作通过事件进行通信的 3 线程应用程序感兴趣。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-09T16:19:29.797

简短的回答：是的，线程总是交互的。当它们以不可预测的方式交互时，问题开始出现。进程中的每个线程都可以访问整个进程内存空间，因此在一个线程中更改内存可能会破坏另一个线程的数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-09T19:38:39.793

等待用户输入的线程将“立即”准备好。在大多数操作系统上，等待 I/O 并准备就绪的线程会获得临时优先级提升，即使在单核 CPU 上，也会“立即”抢占另一个以相同优先级运行的线程。

因此，如果一个单核 CPU 正在运行计算并且另一个等待的相同优先级的线程得到输入，它可能会立即运行。

# c# - 无法使用嵌套集合将 IQueryable 类型隐式转换为 ObjectQuery

> ID：14790022
> 
> 赞同：1
> 
> 时间：2013-02-09T16:15:39.037
> 
> 标签：c#, linq, generics

我无法弄清楚如何查询嵌套/关联的集合。

场景是：
1 组列表关联了许多候选人 同一组与许多测试相关联因此在一个组的集合中，每个组都有两个关联的列表。
我需要获取与登录用户所属的任何和所有组相关联的所有测试。

我通过以下代码尝试的内容显示*无法将 IQueryable 类型隐式转换为 ObjectQuery*

```
tests = db.Tests.Where
(t => t.OAS_Group.Candidates.All
    (c=>c.UserName == HttpContext.User.Identity.Name)
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:18:56.433

错误似乎在于`tests`和右手表达式之间的类型不匹配。您需要将其分配给同一个变量吗？如果是这样，您可以将类型更改`tests`为是`IQueryable`吗？由于`ObjectQuery`实现了两者`IQueryabl<T>`，`IQueryable`你应该能够。

```
IQueryable<Test> tests = null;

// some other assignment to tests

tests = db.Tests.Where
        (t => t.OAS_Group.Candidates.All
             (c=>c.UserName == HttpContext.User.Identity.Name)
        ); 
```

# asp.net - 当他登录到网站到asp.net中的asp.net的下一页时，我如何显示用户的信息？

> ID：14790025
> 
> 赞同：0
> 
> 时间：2013-02-09T16:15:50.153
> 
> 标签：asp.net

我想在他登录时访问登录网站的用户的数据到下一页。我没有使用 asp.net 网站工具。请帮我找到我的问题的解决方案.....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:23:34.340

您可能想要使用的是 Session 变量，这是使用一个变量跨页面使用数据的最简单方法。它可能如下所示：

```
Session("pstrLogin") = txtUername.text 
```

在另一个页面上访问它。

```
strName = Session("pstrLogin").ToString() 
```

希望这是你想要的。

# date - 使用 Eloquent，我如何过滤我的模型查询以仅包含今天创建的项目？

> ID：14790027
> 
> 赞同：2
> 
> 时间：2013-02-09T16:15:54.633
> 
> 标签：date, model, laravel, eloquent

我的应用程序有一个仪表板，必须显示今天提交的最后 10 个条目。

如何过滤我的 Eloquent 查询以仅显示`created_at`今天的项目？

编辑：这是雄辩的方式吗？ `Entry::where('DATE(created_at)', '=', 'DATE()') [...]`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T02:36:46.770

你为什么不使用：

```
Entry::where('created_at', '>=', date('Y-m-d')) 
```

如果 PHP 与数据库服务器在同一台机器上运行（因此时间相同）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T16:00:36.107

有时可能会出现时间问题。PHP与数据库服务器在同一台机器上运行，那么它将是安全的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-08T10:52:51.327

你可以使用 Laravel 附带的**Carbon Library**轻松完成此操作。

```
Entry::where('created_at', '>=',Carbon::today()) 
```

# c# - C# 我缺少哪些库？

> ID：14790028
> 
> 赞同：-4
> 
> 时间：2013-02-09T16:16:03.963
> 
> 标签：c#, libraries

我的第二种形式称为“日历”，我目前正在使用以下库。代码：

```
protected void OnAddDatesClicked (object sender, EventArgs e)
    {

            Calendar DatesPanel = new Calendar();
            DatesPanel.Show();

    } 
```

图书馆：

```
using System;
using Gtk;
using System.Net;
using System.IO;
using System.Diagnostics;
using System.Threading;
using System.Windows.Forms;
using System.Drawing; 
```

那么我在这里缺少什么？每次我单击按钮时，都不会出现新表单。（我正在使用 Monodevelop）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T16:33:44.963

仅供您参考；图书馆是错误的词来指代它们，这些是使用（因此是`using`系统这个词；例如）。

*要回答您的问题：*

不，您没有遗漏`using`声明。如果你错过了一个，你就会有一个构建错误。

*要解决您的问题：*

附加一个调试器，看看你的方法是否被执行。如果没有，您可能忘记订阅 buttonClick 事件处理程序。

# ajax - 网址中的 Symfony2 Ajax app_dev.php

> ID：14790031
> 
> 赞同：4
> 
> 时间：2013-02-09T16:16:25.090
> 
> 标签：ajax, symfony

刚从 Symfony2 开始，在成为一名长期的 ZF1 开发人员之后真的很喜欢它。

今晚开始向网站添加一些 Ajax 功能，对以下内容有点困惑。

在我的 ajax 调用中，例如：

```
$.ajax({
    url: '/app_dev.php/ajax/urlgetter',
    data: "url="+urlinput,
    dataType: 'html',
    timeout: 5000,
    success: function(data, status){
         // DO Stuff here
    }
}); 
```

我必须将 /app_dev.php 添加到 url 以使其在开发环境中工作。没有更好的方法吗？这是否意味着当我将项目更改为生产环境时，我需要搜索和替换 /app_dev.php 的所有实例？希望我完全错过了一些简单的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T20:29:34.950

我最终使用了 jsrouting-bundle

安装后，我可以简单地执行以下操作：

```
$.ajax({
     url: Routing.generate('urlgetter'),
    data: "url="+urlinput,
    dataType: 'html',
    timeout: 5000,
    success: function(data, status){
     // DO Stuff here
    }
}); 
```

其中 urlgetter 是在 routing.yml 中定义的路由，例如：

```
urlgetter:
    pattern: /ajax/urlgetter
    defaults: { _controller: MyAjaxBundle:SomeController:urlgetter }
    options:
        expose: true 
```

注意要使用 jsrouting-bundle 的路由必须设置 Expose: true 选项

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T06:53:13.583

我想这个问题已经有点老了，但我遇到了同样的问题。

它不是任何“最佳实践”解决方案，但这就是我所做的。

`twig`你可以完美地使用这个`{{ path('yourRouteName') }}`东西。所以在我的`twig`文件中，我有一个这样的结构：

```
...    
<a href="{{ path('myRoute') }}"> //results in e.g http://localhost/app_dev.php/myRoute
    <div id="clickMe">Click</div>
</a> 
```

现在，如果有人点击 div，我会在我的`.js file`:

```
$('#clickMe').on('click', function(event) {
    event.preventDefault(); //prevents the default a href behaviour
    var url = $(this).closest('a').attr('href');
    $.ajax({
       url: url,
       method: 'POST',
       success: function(data) {
           console.log('GENIUS!');
      }  
    });
}); 
```

我知道这不是针对您想要触发 Ajax 请求的所有情况的解决方案，但我只是将其留在这里，也许有人认为它很有用:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T23:40:08.157

由于这个 jQuery ajax 函数放置在 twig 端并且 url 指向您的应用程序，因此您可以插入路由路径

```
$.ajax({
    url: '{{ path("your_ajax_routing") }}',
    data: "url="+urlinput,
    dataType: 'html',
    timeout: 5000,
    success: function(data, status){
         // DO Stuff here
    }
}); 
```

# python - django模型过滤器排序

> ID：14790034
> 
> 赞同：0
> 
> 时间：2013-02-09T16:16:42.440
> 
> 标签：python, django, orm

我做这样的事情：

```
Player.objects.distinct().filter(Q(game1_set=game) | Q(game2_set=game)) 
```

它返回所有玩过的玩家`game`。我希望对结果进行排序，例如在 filter: `game1_set`first 和 then`game2_set`中。但事实并非如此。它是由 订购的`id`。

另外，我需要一个`QuerySet`结果，因此，合并两个列表不是一种选择。

这是`models.py`为了更好地理解：

```
class Player(models.Model):
    game1_set = models.ManyToManyField('Game', verbose_name='players1')
    game2_set = models.ManyToManyField('Game', verbose_name='players2')

class Game(models.Model):
    # some fields here 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T16:45:55.587

尝试添加`.order_by('game1_set','game2_set')`

```
Player.objects.distinct().filter(Q(game1_set=game) | Q(game2_set=game)).order_by('game1_set','game2_set') 
```

# java - 在 Java 中使用子抽象类

> ID：14790036
> 
> 赞同：2
> 
> 时间：2013-02-09T16:16:51.093
> 
> 标签：java, class, abstract, extend

我有这门课：

```
public abstract class Test {
    public abstract class SubClass extends Test
    {

    }
} 
```

我需要像这样访问它

```
public class JavaApplication1 extends Test.SubClass {

     public JavaApplication1()
     {
         super();
     }
} 
```

但是超级有问题。我不能使用它静态也不能扩展测试我该怎么办？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T16:19:30.733

一种解决方案：使 SubClass 成为静态内部类。

另一种可能的解决方案：

```
public class JavaApplication1 extends Test.SubClass {

   public JavaApplication1() {
      new Test() {}.super();
   }

   public static void main(String[] args) {
      new JavaApplication1();
   }
}

abstract class Test {
   public Test() {
      System.out.println("from Test");
   }

   public abstract class SubClass extends Test {
      public SubClass() {
         System.out.println("from SubClass");
      }
   }
} 
```

返回：

```
from Test
from Test
from SubClass 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T16:21:14.210

为什么要从包含它的类的外部扩展一个内部类？仅当您需要类中的特定需求时才应使用内部类。如果有更多类可以从类提供的服务中受益，那么它不应该是内部类，而是顶级类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T16:27:00.080

问题是访问内部类需要外部类的实例。因此，您不能直接`super()`从`JavaApplication1`构造函数中调用。最接近的方法是创建一个 1-arg 构造函数，传递外部类的实例，然后`super`在该实例上调用：-

```
public JavaApplication1(Test test)
{
    test.super();
} 
```

然后调用构造函数： -

```
new JavaApplication1(new Test() {}); 
```

这将正常工作。但是，使用 0-arg 构造函数，您必须首先创建一个`Test`类的实例（在这种情况下，是一个匿名内部类，因为 Test 是抽象的），然后调用`super()`.

```
public JavaApplication1() {
    new Test() {}.super();
} 
```

# python - Python在其他数据之后将整数列表插入CSV列

> ID：14790045
> 
> 赞同：0
> 
> 时间：2013-02-09T16:18:20.330
> 
> 标签：python, list, csv

我正在尝试在现有数据之后将新列插入 CSV 文件。例如，我的 CSV 文件当前包含：

```
 Heading 1     Heading 2
   1 
   1
   0
   2
   1
   0 
```

我有一个格式的整数列表：

```
 [1,0,1,2,1,2,1,1] 
```

**如何将此列表插入到“标题 2”下的 CSV 文件中？**

到目前为止，我所能实现的只是在当前数据下添加新的整数列表，例如：

```
 Heading 1     Heading 2
   1 
   1
   0
   2
   1
   0
   1
   0
   1
   2
   1
   2
   1
   1 
```

使用代码：

```
 #Open CSV file
 with open('C:\Data.csv','wb') as g:
            #New writer
    gw = csv.writer(g)
            #Add headings
    gw.writerow(["Heading 1","Heading 2"])
            #Write First list of data to heading 1 (orgList)
    gw.writerows([orgList[item]] for item in column)
            #For each value in new integer list, add row to CSV
    for val in newList:
        gw.writerow([val]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T16:22:18.357

未经测试：

```
import csv
from itertools import izip_longest

some_ints = [1,0,1,2,1,2,1,1]

with open('input') as fin, open('output', 'w') as fout:
    csvin = csv.reader(fin)
    csvout = csv.writer(fout)
    cols = izip_longest(csvin, some_ints, fillvalue='')
    csvout.writerows(cols) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T16:52:14.457

你有两个相关的问题：

*   写入您正在阅读的同一个文件
*   仅发出新数据，而不是包含新旧数据的新行。

首先将数据读入内存：

```
with open(r'C:\Data.csv','rb') as f:
    rows = list(csv.reader(f)) 
```

然后将元组列表转换为具有新数据的新元组列表：

```
newdata = [1,0,1,2,1,2,1,1]
newrows = [rows[0]]            # keep the current two headers
newrows += izip_longest(rows[1:], newdata, fillvalue=0) 
```

最后，将数据写回磁盘：

```
with open(r'C:\Data.csv', 'wb') as f:
     csv.writer(f).writerows(newrows) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T23:18:38.820

这是纠正错误的代码：

```
import csv
from itertools import izip_longest

# Creating a CSV file
with open(r'Data.csv','wb') as f:
    fw = csv.writer(f)
    fw.writerows( (('Heading 1', 'Heading 2'),
                   ('1'),
                   ('1'),
                   ('0'),
                   ('2'),
                   ('1'),
                   ('0'))   )

print "The CSV file at start, read by a csv.reader :\n"
with open(r'Data.csv','rb') as f:
    fr = csv.reader(f)
    print '\n'.join(map(repr,fr))

print '\n------------------------------------------'
newdata = [10,0,10,20,10,20,10,10]

with open(r'Data.csv','rb') as f:
    fr = csv.reader(f)
    newrows = [fr.next()]
    newrows += (a+[b] for a,b in izip_longest(fr, newdata,
                                              fillvalue=[0]))

print 'newrows\n',newrows

with open(r'Data.csv', 'wb') as f:
     csv.writer(f).writerows(newrows)
print '------------------------------------------\n'

print "The new CSV file created, read by a csv.reader :\n"
with open(r'Data.csv','rb') as f:
    fr = csv.reader(f)
    print '\n'.join(map(repr,fr)) 
```

它显示：

```
The CSV file at start, read by a csv.reader :

['Heading 1', 'Heading 2']
['1']
['1']
['0']
['2']
['1']
['0']

------------------------------------------
newrows
[['Heading 1', 'Heading 2'], ['1', 10], ['1', 0], ['0', 10], ['2', 20], ['1', 10], ['0', 20], [0, 10], [0, 10]]
------------------------------------------

The new CSV file created, read by a csv.reader :

['Heading 1', 'Heading 2']
['1', '10']
['1', '0']
['0', '10']
['2', '20']
['1', '10']
['0', '20']
['0', '10']
['0', '10'] 
```

# 编辑

更加凝练

```
import csv
from itertools import izip_longest
from os import remove,rename

# Creating a CSV file
with open(r'Data.csv','wb') as f:
    fw = csv.writer(f)
    fw.writerows( (('Heading 1', 'Heading 2'),
                   ('1'),
                   ('1'),
                   ('0'),
                   ('2'),
                   ('1'),
                   ('0'))   )

print "The CSV file at start, read by a csv.reader :\n"
with open(r'Data.csv','rb') as f:
    print '\n'.join(map(repr,csv.reader(f)))

#------------------------------------------
newdata = [10,0,10,20,10,20,10,10]

with open(r'Data.csv','rb') as f, open(r'newData.csv','wb') as g:
    fr = csv.reader(f)
    gw = csv.writer(g)
    gw.writerow(fr.next())
    gw.writerows( a+[b] for a,b in izip_longest(fr, newdata,
                                                fillvalue=[0]) )
remove (r'Data.csv')
rename (r'newData.csv',r'Data.csv')

#------------------------------------------

print "The new CSV file created, read by a csv.reader :\n"
with open(r'Data.csv','rb') as f:
    print '\n'.join(map(repr,csv.reader(f))) 
```

# c# - 从 texture2D 中仅获取 1 个像素的颜色

> ID：14790046
> 
> 赞同：1
> 
> 时间：2013-02-09T16:18:30.267
> 
> 标签：c#, colors, xna, texture2d

目前，我正在使用这种方法来获取我的 Texture2D 的像素颜色

```
 Color[] pixelColours = new Color[MyTexture.Width*MyTexture.Height];
    MyTexture.GetData<Color>(pixelColours); 
```

1.  如您所见，我将每个像素的颜色存储在选项卡中。
2.  texture2D 非常大：1000 像素 x 1000 像素。
3.  但我只需要获取 1 个像素的颜色，这意味着我存储了 999.999 个无用的其他像素。
4.  像素在 Texture2D 上的位置正在移动，所以这段代码在 Update() 方法中。

有没有其他方法可以非常快地以低内存成本获得这只有 1 个像素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T16:30:14.307

GetData 方法已重载，允许您指定起始像素以及要获取多少元素：http: [//msdn.microsoft.com/en-us/library/bb197093.aspx](http://msdn.microsoft.com/en-us/library/bb197093.aspx)。

# node.js - 自定义标签或自定义属性

> ID：14790047
> 
> 赞同：0
> 
> 时间：2013-02-09T16:18:34.287
> 
> 标签：node.js, express, pug, mustache

我想知道为 node.js 开发自定义 html 标记或自定义 html 属性的可能性，而不是在 jam、html 或其他 html 模板引擎中。我正在查看[PhantomJS](http://phantomjs.org/)，但我没有意识到任何实现它的示例，也没有[Cheerio](https://github.com/MatthewMueller/cheerio)。我的目标是制作一些组件，以便在任何流行的 html 引擎中轻松使用。任何方向都会非常有帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T08:57:07.710

您可以编写类似于示例的自己的[过滤器](https://github.com/visionmedia/jade#filters)

```
body
  :markdown
    Woah! jade _and_ markdown, very **cool**
    we can even link to [stuff](http://google.com) 
```

那会给你

```
<body>
  <p>Woah! jade <em>and</em> markdown, very <strong>cool</strong> we can even 
    link to <a href="http://google.com">stuff</a>
  </p>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:28:25.703

Node.js 只是一个网络服务器，你需要一些东西来解析自定义标签，所以它要么是将其转换为有效 html 的模板引擎，要么是带有 JavaScript 的客户端（又名 AngularJS 指令）

# javascript - Firebug 控制台错误/警告过滤器设置

> ID：14790048
> 
> 赞同：1
> 
> 时间：2013-02-09T16:18:40.330
> 
> 标签：javascript, debugging, firebug

我正在开发一个将在商业上出售的 WordPress 主题。我正在通过一些测试和检查来运行主题。我想做的一件事是检查 javascript 的问题。据我所知，所有 JS 都在正常运行，但我注意到在控制台下的 Firebug 中有可能勾选几个过滤器选项以显示诸如 javascript 警告和 CSS 警告等内容。见下图。

我的主题使用了几个库和脚本，例如 bootstrap、modernizr、jquery、fitvids 等。当我打开所有这些过滤器时，我发现我被错误所淹没（许多来自这些库和脚本，我不会“修复”那些 ！ ）

...所以我的问题是这个。什么是检测错误的合理设置，或者更清楚地说，我通常需要勾选其中哪些，以及不勾选哪些我可以侥幸逃脱。我也找不到这些选项的列表。有些是显而易见的，但有些不是，所以如果有人知道萤火虫网站上的位置，*（**编辑**：刚刚找到[这个](https://getfirebug.com/wiki/index.php/Console_Panel#Options_Menu)）*或者只是临时知道我想尽可能多地知道。

![在此处输入图像描述](../Images/61a08aaa7e4080c87d7d14a5ae71584e.png)

# jquery - 每个人都在我的网站上安装 jQuery 库

> ID：14790049
> 
> 赞同：3
> 
> 时间：2013-02-09T16:18:42.843
> 
> 标签：jquery, wordpress

我正在使用 Wordpress，它带有一个内置的 jQuery 库。当我安装一个插件时，另一个版本会进入。我学习编写自己的代码，教程要求我安装另一个！

在撰写本文时，我可能已经安装了 4-5 个版本的 jQuery 库！

快疯了！而且我认为我不需要那么多，我只需要来自 google CDN 的最新版本以获得最佳性能，所以我将这一行放在我的 php 文件中，但即使在我清除缓存后它似乎也没有出现在任何地方.

```
function mytheme_jquery_enqueue(){
    if(!is_admin()){
        wp_deregister_script('jquery');
        wp_register_script('jquery', "http" . ($_SERVER['SERVER_PORT'] == 443 ? "s" : "") . "://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js", false, null);
        wp_enqueue_script('jquery');  
    }
}
add_action('wp_enqueue_scripts', 'mytheme_jquery_enqueue'); 
```

如何修复它并摆脱所有其他不必要的版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:32:46.740

首先，尝试给你的钩子一个较低的优先级，例如：

```
add_action( 'wp_enqueue_scripts', 'mytheme_jquery_enqueue', 99999 ); 
```

这样，它将是最新运行的，除非某些插件的优先级为`9999999`......[这是一场赛马](https://wordpress.stackexchange.com/q/78829/12615)......

* * *

然后，[在插件中加入 jQuery](https://wordpress.stackexchange.com/a/27575/12615)

> 如果您的代码（或主题的代码）正在注销 jQuery 并从另一个位置（Google）重新注册它，您需要在某处添加：
> 
> ```
> jQuery.noConflict(); 
> ```
> 
> 这使得 jQuery 与尝试全局定义 $ 变量的其他脚本（即 Prototype）合作。WordPress 将这一行捆绑到他们的版本中，谷歌没有。

* * *

但是，比自己排队 CDN 更好，建议使用这个插件：[使用谷歌图书馆](http://wordpress.org/extend/plugins/use-google-libraries/)。根据核心开发人员的说法：

> 请不要使用该方法包含来自 Google 的 jQuery 脚本。以上不起作用，并且会导致与其他脚本的冲突以及其他问题。如果您想使用 Google 托管版本的库，请改用“使用 Google 库”插件。这个插件做得对，并且经常更新。上面的方法只是表面上起作用，它会导致问题。–[奥托 2012 年 7 月 29 日在 15:57](https://wordpress.stackexchange.com/questions/60056/enqueue-jquery-in-wordpress#comment77898_60059)

* * *

然后，我们遇到的问题是，真的[***不建议***](https://wordpress.stackexchange.com/a/45440/12615)加载其他 jQuery 库并使用与 WordPress 捆绑的那个。在这种情况下，您应该使用`remove_action`,`wp_deregister_script`或`wp_dequeue_script`来阻止所有这些插件或主题加载它们的版本。

> ### [不要让 WordPress 的 jQuery 出队](http://eamann.com/tech/dont-dequeue-wordpress-jquery/)
> 
> 作为[WordPress Stack Exchange](https://wordpress.stackexchange.com/)的版主，我最终在该网站上花费了大量时间。我看到了很多很棒的问题，很多不太好的问题，还有几个你要开个玩笑的问题。但我最常看到的问题让我感到沮丧：
> 
> > *如何删除 WordPress 的 jQuery 并改用 Google 的 CDN 版本？*
> 
> 我可以毫不费力地说，如果您问这个问题，那么您首先没有建立网站的业务。

# python - Python 印象笔记 api 错误

> ID：14790050
> 
> 赞同：0
> 
> 时间：2013-02-09T16:18:46.490
> 
> 标签：python, django-views, evernote

尝试在 Python/Django 中构建与 Evernote API 连接的应用程序。对于下面的代码，我收到以下错误消息：“'Store' object has no attribute 'NoteFilter'”来自[http://dev.evernote.com/documentation/reference/NoteStore.html#Svc_NoteStore](http://dev.evernote.com/documentation/reference/NoteStore.html#Svc_NoteStore)可以看到，NoteFilter 是NoteStore 的属性。

```
def list(request):
    nbname="mihkel's notebook"
    client = EvernoteClient(token=token, sandbox=False)

    note_store = client.get_note_store()
    notebooks = note_store.listNotebooks()

    for nb in notebooks:
        if nbname == nb.name:
            nb = nb
            filter = note_store.NoteFilter()
            filter.notebookGuid = nb.guid
            notelist = note_store.findNotes(token,filter,0,10)
        break

    return render_to_response('list.html', {'nb': nb, 'notelist':notelist}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T09:20:50.327

解决方案：

```
from evernote.edam.notestore import NoteStore
....
....
def list.. :
    ...
    Filter = NoteStore.NoteFilter() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T16:32:04.683

**notestore/ttypes.py 有 NoteFilter 的定义**

API代码导入中的一些示例是这样的

```
import evernote.edam.notestore.NoteStore as NoteStore
import evernote.edam.type.ttypes as Types 
```

不确定这是否是一种可以接受的纠正方式，但我补充说：

```
import evernote.edam.notestore.ttypes as NoteStoreTypes 
```

并像这样创建了我的过滤器：

```
filter = NoteStoreTypes.NoteFilter() 
```

# matlab - Matlab fmincon - 没有找到可行的解决方案，但没有发现错误

> ID：14790063
> 
> 赞同：2
> 
> 时间：2013-02-09T16:19:45.753
> 
> 标签：matlab, optimization, error-handling

我正在使用优化函数“fmincon”，在某些情况下它不会收敛。我必须识别这些情况并采取必要的措施，但使用的所有方法都无法捕获错误，因此我继续收到错误：

```
No feasible solution found.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance but constraints are not 
satisfied to within the selected value of the constraint tolerance. 
```

首先，我尝试选择函数的退出标志：如果它返回一个已知错误（-1、1、0...），但每次我遇到错误时，返回的退出标志都有一个正确的值。

```
[x,fval,exitflag] = fmincon(@(x) costFunction(x,INPUTS),x0,A,b,[],[],lb,ub,[],options);
if exitflag == 0
    do something;
end 
```

然后我尝试使用“try/catch”结构，但在这种情况下，代码继续运行并且没有出现错误...

```
try %start try/catch
    [x,fval,exitflag] = fmincon(@(x) costFunction(x,INPUTS),x0,A,b,[],[],lb,ub,[],options);
catch err
   disp(err.identifier);
       ... actions 
end  % end try/catch 
```

欢迎任何建议。

ps：使用的选项有：

```
options = optimset(oldopts,'Display','notify', 'Algorithm','active-set', 'MaxFunEvals', 10000); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-24T14:01:11.177

根据[文档](http://www.mathworks.com/help/optim/ug/fmincon.html)，您应该注意`exitFlag == -2`而不是`0`检查这种情况：

IE

```
[x,fval,exitflag] = fmincon(@(x) costFunction(x,INPUTS),x0,A,b,[],[],lb,ub,[],options);
if exitflag == -2
    %// Handle non-convergence
else
    %// Converged
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T17:08:39.383

1.  里面有什么`oldopts`？
2.  `is less than twice the default value of the step size tolerance`建议您需要更改步长或公差值。有几种方法可以解决这个问题：猜测或显示迭代显示。

    ```
    optimset(oldopts,'Display','iter' ...% or 'iter-detailed' 
    ```

3.  确定要更改的内容后，可以使用以下方法进行设置：

    ```
    optimset(options,'stepsize', 1e-2) % or optimset(options,'tolX', 1e-e)... 
    ```

4.  停止查看退出标志以引发错误。该错误是收敛或迭代问题。

5.  问问自己算法是否能够使用图形方法收敛（如果可能）

6.  RTM： http: [//www.mathworks.com/help/optim/ug/when-the-solver-fails.html](http://www.mathworks.com/help/optim/ug/when-the-solver-fails.html)

# javascript - 改变元刷新的内容不会改变刷新时间

> ID：14790065
> 
> 赞同：2
> 
> 时间：2013-02-09T16:19:50.870
> 
> 标签：javascript, html, meta-tags, meta

我有一个`meta http-equiv="refresh"`里面的`<head>`。

```
<head>
     <meta name="mymeta" http-equiv="refresh" content="2" id="myMeta">
</head> 
```

使用**Javascript**，我正在尝试更改此标记的`content`属性。`meta`

```
var myMeta = document.getElementById("myMeta");
myMeta.content="10"; 
```

当我通过 显示内容时`document.write(myMeta.content);`，我得到更改后的值**10**，但是，`meta`标签将每**2**秒刷新一次。

我已经在 Firefox 和 Opera 中对此进行了测试。

**完整页面**

```
<!DOCTYPE html>
<html>
<head>
<meta name="mymeta" http-equiv="refresh" content="2" id="myMeta">
<script>
var myMeta=document.getElementById("myMeta");
myMeta.content="10";
document.write(myMeta.content);
</script>
</head>
<body>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T14:11:45.620

`<meta>`发生这种情况是因为当标签存在 onload 时浏览器会立即处理它。

见[演示](http://jsfiddle.net/fHYbH/)。

加载文档时，浏览器会看到并处理以下内容：

```
<meta name="mymeta" http-equiv="refresh" content="2" id="myMeta"/> 
```

即使您尝试将其内容从 2 更改为 10，这 2 秒的刷新已经得到确认，并且浏览器在刷新页面之前等待 2 秒。JavaScript 注入的 10 秒刷新实际上有效*，尽管页面在达到 2 秒时已经刷新并且似乎没有任何反应。然后一次又一次地重复这个过程。

尝试[相反](http://jsfiddle.net/pjamy/)的情况，看看会发生什么。

^(*这仅适用于 Safari 和 Chrome。Firefox 和 Opera 不支持通过 JavaScript 修改元刷新。)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T16:21:53.583

该`getElementsByTagName`方法返回 a`NodeList`因此您需要指定索引才能正确访问该元素：

```
 var myMeta = document.getElementsByTagName("meta")[0]; 
```

正如有人提到的那样，这可能仍然不起作用，因为`meta`需要重新附加标签才能达到预期的效果。

由于您使用的是 JavaScript，因此您可以使用它`setTimeout`来实现相同的行为

```
setTimeout(function() {
    location.reload();
},2000); // reload page after 2 seconds 
```

# predicate - 你能给我一个使用不涉及集合、列表、枚举器或 IEnumerable 的谓词的好例子吗？

> ID：14790075
> 
> 赞同：1
> 
> 时间：2013-02-09T16:20:44.523
> 
> 标签：predicate

标题几乎问我想要什么——一个使用**不**涉及迭代集合、使用 IEnumerable 或类似方法的谓词的示例。

我不在乎您使用什么语言，或者即使您提供代码示例。如果您只描述一个简单的示例来说明没有通常用途的谓词，我将不胜感激。

我正在写一篇文章，我很困惑，所以任何例子都将被感激地接收和记入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:14:49.817

在一个项目中，我使用谓词手动实现了缓存依赖项。

每当一个依赖于另一个缓存项的新项被放入缓存中时，都会创建一个谓词委托，它将检查依赖项是否仍然有效或缓存项是否必须失效。

每当访问缓存项并为其分配了依赖项检查谓词时，就会在返回缓存项之前对其进行检查。

当然，如果不使用谓词也可以解决这个问题，但是该解决方案非常优雅，并且可以通过轻松注入依赖性检查方法来实现缓存依赖项。

# php - PHP：如何将 2 个不同的数组合并为一个

> ID：14790084
> 
> 赞同：0
> 
> 时间：2013-02-09T16:21:29.610
> 
> 标签：php, arrays

有没有办法将 2 个数组组合成一个数组？

我的第一个数组显示了每天计算的金额。

```
$ArrayBefore[] = $amountOfTransactions_prDayArrayBefore; 
```

输出：

```
Array (
    [0] => Array (
        [09/02] => 102.83
        [08/02] => 3852.49
        [07/02] => 2619.23
        [06/02] => 1135.24
        [05/02] => 2391.4
        [04/02] => 2376.15
        [03/02] => 2760.05
        [02/02] => 1946.41
    )
) 
```

我的第二个数组显示了每天的交易量。

```
$ArrayTrans[] = $amountOfTransactions_prDayArrayTrans; 
```

输出：

```
Array (
    [0] => Array (
        [09/02] => 2
        [08/02] => 30
        [07/02] => 30
        [06/02] => 15
        [05/02] => 36
        [04/02] => 31
        [03/02] => 28
        [02/02] => 14
    )
) 
```

有没有办法将它们组合到一个数组中。我希望它们看起来像这样，所以我可以把它们吐在桌子上。

```
Array (
    [0] => Array (
        [09/02] => 102.83 => 2
        [08/02] => 3852.49 => 30
        [07/02] => 2619.23 => 30
        [06/02] => 1135.24 => 15
        [05/02] => 2391.4 => 36
        [04/02] => 2376.15 => 31
        [03/02] => 2760.05 => 28
        [02/02] => 1946.41 => 14
    )
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:35:47.063

我调用第一个数组 $a ，第二个数组 $b

```
foreach ( $a[0] as $key=>$value )
{
    $c[0]["$value"] = $b[0][$key];
} 
```

和

```
 $c = array (size=1)
      0 => 
        array (size=8)
          '102.83' => int 2
          '3852.49' => int 30
          '2619.23' => int 30
          '1135.24' => int 15
          '2391.4' => int 36
          '2376.15' => int 31
          '2760.05' => int 28
          '1946.41' => int 14 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-09T16:24:11.440

使用[array_merge()](http://www.php.net/manual/en/function.array-merge.php)：

```
$result = array_merge($ArrayBefore, $ArrayTrans); 
```

编辑：

了解我的 php 生锈了，但是如何处理以下内容：

```
foreach($ArrayBefore[] as $key => $value) {
    $tmpPair[$value] = $ArrayTrans[0][$key];
    $newArray[$key] = $tmpPair;
} 
```

您也许还可以简化它

```
foreach($ArrayBefore[] as $key => $value) {
    $newArray[$key][$value] = $ArrayTrans[0][$key];
} 
```

# xml - 内部值的 Xdt 变换

> ID：14790088
> 
> 赞同：5
> 
> 时间：2013-02-09T16:21:49.940
> 
> 标签：xml, web-config, xdt-transform

我正在尝试使用 XML 转换文件 (xdt) 转换以下内容：

```
<serviceProperty name="Group">
  <expression>33</expression>
</serviceProperty> 
```

我想用另一个数字替换 33。我已经想出了如何用

```
<expression xdt:Locator="XPath(//serviceProperty[@name='Group']/expression[text()='33'])" xdt:Transform="Replace" >48</expression> 
```

但是我怎样才能让所有匹配的元素都起作用呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-03T13:21:42.853

您可以尝试在 .config 文件中执行此操作：

```
<serviceProperty name="Group">
    <expression xdt:Transform="Replace">45</expression>
</serviceProperty> 
```

# php - PHP类中的全局变量

> ID：14790090
> 
> 赞同：0
> 
> 时间：2013-02-09T16:21:53.743
> 
> 标签：php, class, variables, global

我想使用一个在班级中发挥作用的简单变量......但是，这不起作用。

```
$GLOBALS['world'] = "Isara";

class Character{
    var $name;
    var $status;
    static $content;
    function __construct($name){
        $this->name=$name;
        $this->getCharInfo();
    }

    private function getCharInfo(){
        if(empty(self::$content)){
            self::$content = file_get_contents("http://www.tibia.com/community/?subtopic=worlds&world=$GLOBALS['world']",0); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T16:26:08.500

使用`$GLOBALS[...]`访问全局变量是正确的。但是，当在字符串中嵌入数组访问器时，您需要将变量括在括号中。

所以，而不是

```
file_get_contents("... $GLOBALS['world']"); 
```

您可以使用以下方法之一：

```
file_get_contents("... {$GLOBALS['world']}");
file_get_contents("... " . $GLOBALS['world']); 
```

或者：

```
global $world;
file_get_contents("... $world"); 
```

# youtube-api - 我可以使用相同的访问令牌访问 youtube api v2 和 v3 吗？

> ID：14790092
> 
> 赞同：0
> 
> 时间：2013-02-09T16:22:07.827
> 
> 标签：youtube-api

我更喜欢使用 youtube 的 api 的 v3（json over xml！），但想要访问评论，这些评论在 v3 中不可用，但在 v2 中可用。

我可以使用相同的访问令牌，`https://www.googleapis.com/auth/youtube`同时使用 v2 和 v3 的范围吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T16:22:07.827

我相信我必须添加范围`https://gdata.youtube.com`以使访问令牌与 API 的两个版本兼容

# mysql - MySQL - 一组时间差异的总和

> ID：14790098
> 
> 赞同：8
> 
> 时间：2013-02-09T16:22:39.113
> 
> 标签：mysql, sql, aggregate-functions

我想总结所有时间差异以显示志愿者工作的总小时数。获得时间差异的结果集很容易：

```
Select timediff(timeOut, timeIn) 
FROM volHours 
WHERE username = 'skolcz' 
```

它按小时给出了时间列表，但我想把它总结为一个总数。

所以如果结果集是：

```
12:00:00
10:00:00
10:00:00
08:00:00 
```

总共只有40个小时。

这有一种方法可以执行以下操作：

```
SELECT SUM(Select timediff(timeOut,timeIn) 
FROM volHours 
WHERE username = 'skolcz') as totalHours 
```

?

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-09T16:28:06.143

```
Select  SEC_TO_TIME(SUM(TIME_TO_SEC(timediff(timeOut, timeIn)))) AS totalhours
FROM volHours 
WHERE username = 'skolcz' 
```

如果没有，那么也许：

```
Select  SEC_TO_TIME(SELECT SUM(TIME_TO_SEC(timediff(timeOut, timeIn))) 
FROM volHours 
WHERE username = 'skolcz') as totalhours 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T16:36:43.157

**您几乎可以从Matthew**那里得到答案，您需要做的就是添加 cast ：

```
Select CAST(SUM(timediff(timeOut, timeIn)) as time) as totalhours
FROM volHours 
WHERE username = 'skolcz' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T16:30:57.103

尝试类似的东西

```
 Select SUM(timediff(timeOut, timeIn)) as total
 FROM volHours 
 WHERE username = 'skolcz' 
```

# canvas - 绘制重叠的半透明线而不在重叠处变暗

> ID：14790101
> 
> 赞同：1
> 
> 时间：2013-02-09T16:23:05.380
> 
> 标签：canvas, drawing, transparency, overlapping

我已经阅读了同名的帖子，它很有用，但没有回答我的问题。我的绘图程序允许用户在图像上自由绘制宽线；但是，当它们通过在同一空间中绘制两次来重叠线条时，我不希望透明度变暗。

无论如何要使用画布 lineTo、stroke、strokeStyle 等进行绘制，这样就不会发生这种情况。下面是一个代码片段，可以说明我做了什么：

```
drawPencilDown: function(e, $this)
        {
            $this.ctx.lineJoin = "round";
            $this.ctx.lineCap = "round";
            $this.ctx.strokeStyle = "rgba(255, 255, 255, 1.0)";
            $this.ctx.fillStyle   = "rgba(255, 255, 255, 0.5)";

            $this.ctx.lineWidth = $this.settings.lineWidth;         
            //draw single dot in case of a click without a move
            $this.ctx.beginPath();
            $this.ctx.arc(e.pageX*sx, e.pageY*sy, $this.settings.lineWidth/2, 0, Math.PI*2, true);
            $this.ctx.closePath(); 
            $this.ctx.fill();
            $this.ctx.beginPath(); 
            $this.ctx.moveTo(e.pageX*sx, e.pageY*sy); 
        },

        drawPencilMove: function(e, $this)
        {
            $this.ctx.lineTo(e.pageX*sx, e.pageY*sy);
            $this.ctx.stroke();
        },

        drawPencilUp: function(e, $this)
        {
            $this.ctx.closePath();
        }, 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-01-03T18:10:08.543

使用`globalCompositeOperation="xor"`并设置 a `globalAlpha`< 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T09:47:30.283

我认为你应该使用 globalCompositeOperation 属性： [https ://developer.mozilla.org/samples/canvas-tutorial/6_1_canvas_composite.html](https://developer.mozilla.org/samples/canvas-tutorial/6_1_canvas_composite.html)

source-atop 和destination-atop 都可以工作

# java - DialogFragment 中未调用 OnCancelListener

> ID：14790103
> 
> 赞同：28
> 
> 时间：2013-02-09T16:23:30.023
> 
> 标签：java, android, android-alertdialog, android-dialogfragment

我有一个简单`AlertDialog`的显示一些项目的列表，单击其中一个项目后，单击的项目将传递回封闭的`Activity`. *当用户取消对话框（使用后退按钮*）时，我还想执行一些默认处理——更具体地说，在这种情况下，我想将一个空字符串传递给活动。

但是，如果我将对话框放入`DialogFragment`（来自**兼容性包**）中，`OnCancelListener` **则当我使用后退按钮关闭对话框时不会调用**。我究竟做错了什么？

```
public class SelectItemDialog extends DialogFragment {

    public interface Callback {
        void onItemSelected(String string);
    }

    private static final String ARG_ITEMS = "items";

    private Callback callback;

    public static SelectItemDialog fromItems(Collection<String> items) {
        SelectItemDialog fragment = new SelectItemDialog();
        fragment.setArguments(newArguments(items));
        return fragment;
    }

    private static Bundle newArguments(Collection<String> items) {
        Bundle arguments = new Bundle();
        arguments.putStringArray(ARG_ITEMS, items.toArray(new String[items.size()]));
        return arguments;
    }

    @Override
    public void onAttach(Activity activity) {
        super.onAttach(activity);
        callback = (Callback) activity;
    }

    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {
        final String[] items = getArguments().getStringArray(ARG_ITEMS);
        return new AlertDialog.Builder(getActivity())
            .setTitle(R.string.dialog_select_email_title)
            .setItems(items, new OnClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int which) {
                    callback.onItemSelected(items[which]);
                }
            })
            .setOnCancelListener(new OnCancelListener() {
                @Override
                public void onCancel(DialogInterface dialog) {
                    // this code is not executed
                    callback.onItemSelected("");
                    throw new RuntimeException("dialog cancelled");
                }
            })
            .create();
    }
} 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-02-09T16:31:28.190

`cancel()`这可能与您的代码没有明确调用这一事实有关。[OnCancelListener](http://developer.android.com/reference/android/content/DialogInterface.OnCancelListener.html)文档说 ：

> 这只会在对话框被取消时调用

这可能需要一个明确的`cancel()`调用。

`OnClickListener`要么使用 a调用一个正/负按钮，[`DialogInterface#cancel()`](http://developer.android.com/reference/android/content/DialogInterface.html#cancel%28%29)要么使用[`OnDismissListener()`](http://developer.android.com/reference/android/content/DialogInterface.OnDismissListener.html)带有额外检查的 a 来查看是否单击了列表项。

此外，要收听后退键并取消对话框，您可以设置一个[`OnKeyListener`](http://developer.android.com/reference/android/content/DialogInterface.OnKeyListener.html)，如[this SO answer中所述](https://stackoverflow.com/questions/7801971/android-how-to-override-onbackpressed-in-alertdialog/7815342#7815342)

此外，一旦您设置了 Dialog，如果用户在 Dialog 之外点击，这也是一个好主意[`Dialog#setCanceledOnTouchOutside()`](http://developer.android.com/reference/android/app/Dialog.html#setCanceledOnTouchOutside%28boolean%29)。

**编辑：以下部分是在 DialogFragment 中处理取消事件的简单方法。**

由于您使用的是 a `DialogFragment`，因此此类有一个非常方便的方法，当取消a[`DialogFragment#onCancel()`](http://developer.android.com/reference/android/app/DialogFragment.html#onCancel%28android.content.DialogInterface%29)时会调用该方法。`DialogFragment`在那里做你的逻辑。

DialogFragment 更复杂，其生命周期与普通对话框略有不同。因此，首先检查文档，如果您`Dialog`尝试移植到某个基于 - 的方法，则`DialogFragment`可能存在一些允许您的新实现正常运行的方法！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-09-09T18:16:52.517

如果您正在使用**DialogFragment**并想收听按钮，请使用它 -

```
 this.getDialog().setOnKeyListener(new Dialog.OnKeyListener() {
        @Override
        public boolean onKey(DialogInterface dialog, int keyCode,
                KeyEvent event) {
            if (keyCode == KeyEvent.KEYCODE_BACK) {
                if (****) {
                    your logic
                }
                return true;
            }
            return false;
        }
    }); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-12-29T10:53:38.740

**注意：DialogFragment 拥有 Dialog.setOnCancelListener 和 Dialog.setOnDismissListener 回调。你不能自己设置它们。**

**要了解这些事件，请覆盖 onCancel(DialogInterface) 和 onDismiss(DialogInterface)。**

```
public class SelectItemDialog extends DialogFragment {

    @Override
    public void onDismiss(DialogInterface dialog) {
        super.onDismiss(dialog);
        //your code hear
        dialog.cancel();
    }
} 
```

你应该删除 .setOnCancelListener()

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-25T03:01:20.873

实际上，如果您想使用`DialogFragment`，则永远无法添加`OnCancelListener`或`OnDismissListener`，因为 Dialog Fragment 拥有对这些方法的回调！

您在这里有 3 个选项：

1-使用常规对话。
2-将您的对话框片段设置为可取消（假）并在对话框中添加一个取消按钮。
3-检查@Nikhil Pingle 的答案。

这是来自对话框片段的文档

```
 * <p><em>Note: DialogFragment own the {@link Dialog#setOnCancelListener
 * Dialog.setOnCancelListener} and {@link Dialog#setOnDismissListener
 * Dialog.setOnDismissListener} callbacks.  You must not set them yourself.</em>
 * To find out about these events, override {@link #onCancel(DialogInterface)}
 * and {@link #onDismiss(DialogInterface)}.</p> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-10-02T03:15:19.187

DialogFragment中的Cancel Listener或Dismiss listener可以通过onDismiss来实现

```
 DialogFragment  newFragment = new DatePickerFragment();
            newFragment.show(getFragmentManager(), "datePicker");
            newFragment.onDismiss(new DialogInterface(){

                @Override
                public void cancel() {
                    // TODO Auto-generated method stub

                }

                @Override
                public void dismiss() {
                    // TODO Auto-generated method stub

                }

            }); 
```

# c# - C# 中的内联“尝试”语句可能吗？

> ID：14790106
> 
> 赞同：4
> 
> 时间：2013-02-09T16:23:51.493
> 
> 标签：c#, exception, exception-handling, try-catch

是否可以在 C# 中以某种方式调用内联`try`语句？

我正在为我的网站检测语言，有时，当语言`en-GR`出于某种原因在客户端时，.NET 会引发异常。所以我需要使用`try`，`catch`即使我没有真正捕捉到任何东西。

在这种情况下，这似乎完全是矫枉过正。

```
// Set allowed languages
string[] allowedLanguages = { "en", "fr", "ru" };

// Get all possible values
var routeLanguage = (filterContext.RouteData.Values["lang"] != null && allowedLanguages.Contains(filterContext.RouteData.Values["lang"].ToString())) ? filterContext.RouteData.Values["lang"].ToString() : null;
var cookieLanguage = (filterContext.HttpContext.Request.Cookies["lang"] != null && allowedLanguages.Contains(filterContext.HttpContext.Request.Cookies["lang"].Value)) ? filterContext.HttpContext.Request.Cookies["lang"].Value : null;
string clientLanguage = null;
try
{
    clientLanguage = (filterContext.HttpContext.Request.UserLanguages != null) ? new CultureInfo(filterContext.HttpContext.Request.UserLanguages[0]).TwoLetterISOLanguageName : null; // Exception sometimes without `try`
}
catch (Exception)
{
} 
```

## 编辑

异常不是我可以解决的，因为我无法控制用户在其文化信息中的内容。.NET 只是将 en-FR 视为无效的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-09T16:34:11.703

首先，最好首先弄清楚如何避免异常。首先集中精力。抛出该异常是有原因的，如果您可以确定它是什么，请不要这样做。

要真正回答您的问题：没有开箱即用的“吃掉这个表达式中的所有异常”机制，但是构建自己的机制很简单：

```
static T EatExceptions(Func<T> func)
{
  try { return func(); } catch { }
  return default(T);
}
...
clientLanguage = (filterContext.HttpContext.Request.UserLanguages != null) ? 
  EatExceptions(() => new CultureInfo(filterContext.HttpContext.Request.UserLanguages[0]).TwoLetterISOLanguageName) :
  null; } 
```

如果有人试图在我正在审查的代码中进行这样的恶作剧，那么我会......好吧，我们只是说更改不会被签入。像这样吃异常在 99% 的情况下都是一个非常糟糕的主意。再次：**找出你做错了什么并停止这样做**。不要做错事，然后处理失败。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-09T16:30:23.417

您是否尝试过完全摆脱该`try/catch`声明？

```
string clientLanguage = null;
var userLanguages = filterContext.HttpContext.Request.UserLanguages;
if (userLanguages != null && userLanguages.Length > 0)
{
    var culture = CultureInfo
        .GetCultures(CultureTypes.AllCultures)
        .FirstOrDefault(
            x => string.Equals(
                x.Name, 
                userLanguages[0].Name, 
                StringComparison.OrdinalIgnoreCase
            )
        );
    if (culture != null)
    {
        clientLanguage = culture.TwoLetterISOLanguageName;
    }
} 
```

仅使用 try/catch 来处理您无法控制的异常。顾名思义，应该使用异常来处理异常情况。

在这种情况下，您正在执行标准解析，因此最好进行防御性编程，而不是尝试、投掷、捕捉……

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-08-30T21:12:30.597

```
_.Try(() => __YourStatementHere__ ); 
```

使用这样的小助手类：

```
/// <summary>
/// Other utility functions.
/// </summary>
public static class _ {

    /// <summary>
    /// Tries to execute the given action. If it fails, nothing happens.
    /// </summary>
    public static void Try(Action action) {
        try {
            action();
        }
        catch {
        }
    }

} 
```

我知道，这个解决方案也不是最优的，但到目前为止我能找到的最简洁的一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-09T16:39:08.740

首先**尽量避免异常**。仅仅因为字符串来自您无法控制的来源，并不意味着您无法验证它。

如果无法避免，则应**捕获**您期望的特定异常并将该逻辑封装在方法中。不要捕获所有异常。

例如：

```
public static CultureInfo TryGetCultureByName(string name)
{
   try
   {
     return new CultureInfo(name);
   }
   catch(CultureNotFoundException)//Only catching CultureNotFoundException
   {
     return null;
   }
} 
```

这样，如果您以后发现处理此特定错误的更好方法，您可以轻松替换它。

例如，您可以创建一个`Dictionary<string, CultureInfo>`，填充它`CultureInfo.GetCultures()`并使用它`TryGetValue`来查找文化，而不会引发异常。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-09T16:34:01.010

你所做的是正确的方法。你说，为什么你不能摆脱异常（我认为是这种情况）。所以你必须处理它。唉，C# 没有 try-catch 作为表达式（不确定它是如何工作的 - catch“子句”需要返回一个值）。

或者，您可以构建一个小辅助函数，该函数接受 a `Func<T>`，调用它并将值传递给调用者。如果发生异常，则返回（例如）`default(T)`。这消除了很多混乱并且可以重复使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-09T16:34:14.673

好吧，撇开关于预先检查的（好的）建议不谈，有几种相当平凡/平淡/明显的方法可以做到这一点：

首先，您可以将其包装在一个函数中。我认为这对您来说不够笼统。

或者，您可以折叠`catch`分支：

```
try
{
    clientLanguage = (filterContext.HttpContext.Request.UserLanguages != null) ? new CultureInfo(filterContext.HttpContext.Request.UserLanguages[0]).TwoLetterISOLanguageName : null; // Exception sometimes without `try`
} catch (Exception) { } 
```

或者，您可以将整个内容折叠成一行：

```
try { clientLanguage = (filterContext.HttpContext.Request.UserLanguages != null) ? new CultureInfo(filterContext.HttpContext.Request.UserLanguages[0]).TwoLetterISOLanguageName : null; } catch (Exception) { } 
```

不优雅，但简单，并且有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-31T16:44:31.373

这是另一种方式：

```
await new @try(async () => { user = await GetItemAsync(userId); })
         .@catch<Exception>(async () => { user = new User(); }); 
```

我认为它比 try/catch 更冗长：

```
try { return await GetItemAsync(userId); } 
catch (Exception ex) { return new User(); } 
```

助手类：

```
public class @try
{
    private Func<Task> func;
    private Action action;

    public @try(Func<Task> func)
    {
        this.func = func;
    }

    public @try(Action action)
    {
        this.action = action;
    }

    public async Task @catch<T>(Func<Task> fallback) where T : Exception
    {
        try
        {
            await func.Invoke();
        }
        catch(T ex)
        {
            await fallback.Invoke();
        }
    }

    public void @catch<T>(Action fallback) where T : Exception
    {
        try
        {
            action.Invoke();
        }
        catch (T ex)
        {
            fallback.Invoke();
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2020-01-07T17:37:32.503

我已经建立了一个可能适合此目的的在线尝试捕获机制。我想要一种类似 LINQ 或 Callback function-y 的语法。这是使用几个包装器，一个 TryWrapper 和一个 CatchWrapper 来完成的，以便点运算符适当地提示下一步，隐式转换为 T 类型。

[![例子](../Images/f3ab18e617234b33d72d91f35832647a.png)](https://i.stack.imgur.com/SaFNA.png)

你也可以做类似的事情

```
Try(() => UpdateSweetGreen("21", SweetGreen))
.Catch(LogToDb(e.Message))
.Catch(LogToFile(e.Message).Finally(ReportNewSweetGreen(SweetGreen); 
```

基本上 CatchWrapper 扩展了 TryWrapper。因此，您可以从另一个 catch 块中捕获异常。在这种情况下，将您的方法失败记录到数据库中，然后如果失败记录到文件中，那么无论向其他组件报告 SweetGreen 变量是什么。

### 这一切都从 TryWrapper 扩展而来

```
 public class TryWrapper<T>
    {
        protected internal T Result { get; set; } = default(T);

        protected internal Exception Exception { get; set; } = null;

        public static implicit operator T(TryWrapper<T> wrapper)
        {
            return wrapper.Result;
        }

        public static implicit operator Exception(TryWrapper<T> wrapper)
        {
            return wrapper.Exception;
        }
    } 
```

### 和 CatchWrapper 它只是扩展 TryWrapper 并且不能直接调用，而是仅在尝试后出现，正如您在标准实现中所期望的那样

```
 public class CatchWrapper<T> : TryWrapper<T>
    {
    } 
```

### 然后是一系列静态扩展方法

```
 public static TryWrapper<T> Try<T>(Func<T> func)
        {
            var product = new TryWrapper<T>();

            try
            {
                product.Result = func.Invoke();
            }
            catch (Exception e)
            {
                product.Exception = e;
            }

            return product;
        }

        public static TryWrapper<T> Try<T>(Action action)
        {
            var product = new TryWrapper<T>();

            try
            {
                action.Invoke();
            }
            catch (Exception e)
            {
                product.Exception = e;
            }

            return product;
        }

        public static CatchWrapper<T> Catch<T>(this TryWrapper<T> wrapper, Action<Exception> response)
        {
            if (wrapper.Exception is null) return wrapper as CatchWrapper<T>;

            response.Invoke(wrapper);
            wrapper.Exception = null;

            return wrapper as CatchWrapper<T>;
        }

        public static TryWrapper<T> Finally<T>(this TryWrapper<T> wrapper, Action<T> response)
        {
            response.Invoke(wrapper);

            return wrapper;
        }

        public static TryWrapper<T> Finally<T>(this TryWrapper<T> wrapper, Func<T> response)
        {
            wrapper.Result = response.Invoke();

            return wrapper;
        }

        public static TryWrapper<T> Finally<T>(this TryWrapper<T> wrapper, Action response)
        {
            response.Invoke();

            return wrapper;
        } 
```

现在这确实实现了 OP 要求的内联语法，但我敢说它的效率较低，因为您可以直接在标准的 try-catch 中处理异常。能够在 Try 之前直接指定 return 仍然有点酷，尽管如果默认为 null，这是有风险的。

# python - 如何在 PyQt4 中向 QFrame 添加浮动工具栏？

> ID：14790108
> 
> 赞同：1
> 
> 时间：2013-02-09T16:24:17.000
> 
> 标签：python, qt, qt4, pyqt4, qmainwindow

我已经制作了一个从基类继承的独立应用程序`QtGui.QFrame`，现在我想向它添加一个浮动工具栏，就像在`QMainWindow`. 我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:48:34.140

我认为你不能用 QFrame 做到这一点。根据文档，您可以在允许的区域中使用工具栏。 [http://pyqt.sourceforge.net/Docs/PyQt4/qtoolbar.html#allowedAreas-prop](http://pyqt.sourceforge.net/Docs/PyQt4/qtoolbar.html#allowedAreas-prop)

但我不确定。

# java - 在arraylists中保存一个包含arraylists的对象

> ID：14790111
> 
> 赞同：0
> 
> 时间：2013-02-09T16:24:29.643
> 
> 标签：java

我有一个名为 myRestaurant 的 Restaurant 类型对象，其中包含EmployeesAList、MenuAList 和OrdersAList，每个对象都存储Employee、Menu_Item 和Order 对象的实例。Order 的每个实例都存储整数、字符串和整数数组列表。

当我保存 myRestaurant 时，除了 Orders 类中的 arraylist 之外，每个 arraylist 都会被保存。

有什么建议么？

Runner中的保存方法

```
 public boolean SaveToFile(Restaurant myrest)
{
    try
    {
        File outFile = new File("etrest.rest");  
        //creates object representing file

        FileOutputStream outFileStream = new FileOutputStream(outFile);
        //connection between program and file

        ObjectOutputStream outObjectStream = new ObjectOutputStream(outFileStream);
        //class which is used to pass objects which will be saved to file

        //Write serializable ArrayList to file
        outObjectStream.writeObject(myrest);        

        //output done, so close the stream
        outObjectStream.close();
        return true;
    }
    catch(IOException IOE)
    {
        System.out.println(IOE.toString()); //debug purpose
        return false;        
    }
} 
```

餐厅中添加订单的方法

ArrayList OrdersAList = new ArrayList();

```
public void AddOrder(Order o)
{
    OrdersAList.add(o);
} 
```

部分订单类 ArrayList Menu_ItemsIDAList = new ArrayList();

```
public Order()
{
    paid = false;
    WaiterNo = 0;
    TableNo = 0;
    item = 0;
}

public Order(boolean pd, int wN, int tN, int it)
{
    paid     = pd;
    WaiterNo = wN;
    TableNo  = tN;
    item     = it;
}

//MENU ITEMS ENTERED PER ORDER
public void AddMenu_ItemID(int item)
{
    Menu_ItemsIDAList.add(item);
} 
```

当我创建一个 Order 实例时，我创建了一个循环来填充 Menu_ItemsIDAList

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:47:30.960

我无法完全重建您的问题...

您/我们应该更好地了解您的列表将准确保存在哪里，以及您的“添加”方法在哪里？在哪个级别...

所以我向你推荐，制作一个图表。在您的情况下，UML 类图（[http://en.wikipedia.org/wiki/Class_diagram](http://en.wikipedia.org/wiki/Class_diagram)）。

一旦你理解了类、属性和关系，你就可以画出这样的图，并且可以以适当的方式使用代码。

当然，我们可以为您提供“缺少某些东西”的快速解决方案……但是对于未来的开发，您应该了解面向对象编程的基础知识。UML 类和 UML 用例图也是一个好的开始......

# php - 动态设置 FOS UserBundle 登录页面的样式

> ID：14790113
> 
> 赞同：1
> 
> 时间：2013-02-09T16:25:06.220
> 
> 标签：php, symfony, fosuserbundle

我对 Symfony 2 比较陌生，但我有一个包含许多不同子域和用户区域的站点，我希望我的登录页面样式不同，但目前不是。我正在使用 Symfony 2 和 FOS UserBundle，目前一切正常，使用 security.yml 中的 1 个防火墙。我根据文档覆盖了 FOS UserBundle 布局，但我希望能够根据请求的来源来设置不同的页面样式，例如：microsite1.mainsite.com/user 获取样式 A microsite1.mainsite.com /admin 获取样式 B microsite2.mainsite.come/user 获取样式 C

我已经考虑了一些选择，我正在寻找其他意见。我考虑的第一个选项是覆盖/扩展 FOS UserBundle 中的控制器，以便可以识别引荐来源并呈现不同的树枝模板。另一种选择是为不同的路由使用不同的防火墙，但我们真的希望能够让不同微型站点中的用户在所有站点上进行身份验证，因此首选一个防火墙。有没有其他解决方案，或者有没有比另一种更可取的方法来解决这个相对较小的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:43:46.563

您可以覆盖[`renderLogin`](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Controller/SecurityController.php#L51-64). `SecurityController`您可以这样做：

```
namespace Acme\UserBundle\Controller;

use FOS\UserBundle\Controller\SecurityController as BaseController;
use Symfony\Component\DependencyInjection\ContainerAware;
use Symfony\Component\Security\Core\SecurityContext;

use Symfony\Component\HttpFoundation\Request;

class SecurityController extends BaseController
{
    /**
    * Overriding the FOS default method so that we can choose a template
    */
    protected function renderLogin(array $data)
    {
        $template = $this->getTemplate();

        return $this->container->get('templating')->renderResponse($template, $data);
    }

    /**
    * You get the subdomain and return the correct template
    */
    public function getTemplate(){

        $subdomain = $this->container->get('request')->getHost();

        if ($subdomain === "microsite1.mainsite.com"){
            $template = sprintf('AcmeUserBundle:Security:loginMicrosite1.html.%s', $this->container->getParameter('fos_user.template.engine'));
        }
        elseif($subdomain === "microsite2.mainsite.com"){
            $template = sprintf('AcmeUserBundle:Security:loginMicrosite2.html.%s', $this->container->getParameter('fos_user.template.engine'));
       }
       //blablabla
       //Customize with what you need here.

       return $template;
    } 
```

# scala - 我在哪里可以了解如何为 Scala 宏构建 AST？

> ID：14790115
> 
> 赞同：39
> 
> 时间：2013-02-09T16:25:42.757
> 
> 标签：scala, macros, scala-macros

我在哪里可以学习如何构建 Scala 的宏生成的 AST？

Scaladoc 没有我想的那么有用。例如：

```
abstract def Apply(sym: Universe.Symbol, args: Universe.Tree*): Universe.Tree
A factory method for Apply nodes. 
```

但是我如何弄清楚 Apply 节点是什么？我在哪里可以找到 AST 中的节点类型列表，以及它们如何组合在一起？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-02-09T17:08:25.073

没有很多关于编译器内部的文档可用，但可用的东西应该足以开始。

[Mirko Stocker](https://stackoverflow.com/users/313873/mirko-stocker)撰写了[关于 Scala 重构的硕士论文](http://scala-refactoring.org/wp-content/uploads/scala-refactoring.pdf)。在附录 D（第 95 页）中，他描述了 AST 的架构。它还包括一个图形概述：

![斯卡拉 AST](../Images/28d4bed9ac9b2928c2090a0064026943.png)

查找有关 AST 信息的另一种方法是直接查看包含 AST的[reflect.internal.Trees的来源。](https://github.com/scala/scala/blob/master/src/reflect/scala/reflect/internal/Trees.scala)

如果需要找出特定的源代码片段在内部是如何表示的，则有`reify`：

```
scala> import reflect.runtime.universe._
import reflect.runtime.universe._

scala> showRaw(reify{val i = 0}.tree)
res8: String = Block(List(ValDef(Modifiers(), newTermName("i"), TypeTree(),
  Literal(Constant(0)))), Literal(Constant(()))) 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-02-10T08:30:43.240

您可以查看 scaladoc ( [http://docs.scala-lang.org/overviews/reflection/symbols-trees-types.html#trees](http://docs.scala-lang.org/overviews/reflection/symbols-trees-types.html#trees) ) 或幻灯片 ( [http://scalamacros.org/talks/ 2012-04-28-MetaprogrammingInScala210.pdf](http://scalamacros.org/talks/2012-04-28-MetaprogrammingInScala210.pdf)，“学习学习”部分）。

这是我通常做的事情。我编写了一个名为 的简单脚本[`parse`](https://github.com/xeno-by/dotx/blob/2e1786c0496a16ea0ec1ab3b4a2581833427df8d/parse)，它将 Scala 代码作为参数，然后用它编译`-Xprint:parser -Ystop-after:parser -Yshow-trees-stringified -Yshow-trees-compact`（`parse`使用另一个帮助脚本：`adhoc-scalac`。[单击此处](https://github.com/xeno-by/dotx/blob/2e1786c0496a16ea0ec1ab3b4a2581833427df8d/adhoc-scalac)也可以查看其源代码）。

这种方法的优势`showRaw`在于它不需要代码进行类型检查。您可以编写一小段代码，它引用不存在的变量或类，它仍然会成功运行并向您显示 AST。这是一个输出示例：

```
09:26 ~$ parse 'class C { def x = 2 }'
[[syntax trees at end of parser]]// Scala source: tmp36sVGp
package <empty> {
  class C extends scala.AnyRef {
    def <init>() = {
      super.<init>();
      ()
    };
    def x = 2
  }
}
PackageDef(Ident(TermName("<empty>")), List(ClassDef(Modifiers(), TypeName("C"), List(), Template(List(Select(Ident(scala), TypeName("AnyRef"))), emptyValDef, List(DefDef(Modifiers(), nme.CONSTRUCTOR, List(), List(List()), TypeTree(), Block(List(pendingSuperCall), Literal(Constant(())))), DefDef(Modifiers(), TermName("x"), List(), List(), TypeTree(), Literal(Constant(2)))))))) 
```

还有一个名为 的脚本[`typecheck`](https://github.com/xeno-by/dotx/blob/2e1786c0496a16ea0ec1ab3b4a2581833427df8d/typecheck)，它的作用相同，但在 之后停止`typer`。这有时有助于理解类型检查器如何准确地转换解析器树。但是，工具箱和宏都适用于解析器树，因此我`typecheck`很少将其用于树构造目的。

# android - 列表视图的光标适配器未显示最新值

> ID：14790116
> 
> 赞同：0
> 
> 时间：2013-02-09T16:25:45.347
> 
> 标签：android, android-widget

我正在使用 SimpleCrusorAdaptor 在列表视图中显示项目列表。当列表视图中的一个项目被选中时，它会启动另一个活动，该活动会更改列表视图中显示的拼图状态。当此活动终止并且包含列表视图的活动再次变为活动状态时，列表视图显示旧状态，

如何确保包含列表视图的活动恢复，游标适配器更新了值？在 cativity 的 onResume() 中要做些什么？

```
private static String[] FROM = { PuzzleDatabase.KEY_PUZZLE_TITLE,
PuzzleDatabase.KEY_PUZZLE_STATUS };
private static int[] TO = { R.id.puzzle_title, R.id.puzzle_status };

 ListView  listView = (ListView) findViewById(R.id.puzzle_list);

 this.cursor = ps.puzzleDatabase.getPuzzleTitles();

 // Set up data binding
          SimpleCursorAdapter adapter = new SimpleCursorAdapter(this,
                R.layout.puzzle_list_row, cursor, FROM, TO);

    // Assign adapter to ListView
    listView.setAdapter(adapter); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T16:39:15.447

光标不会改变它的内容，只是因为底层数据集改变了它的内容！游标包含在进行查询时由查询产生的数据。

你需要一个加载器。您可以在此处查看示例代码：

[https://github.com/marakana/yamba/blob/yambaII/Yamba/src/com/marakana/android/yamba/TimelineActivity.java](https://github.com/marakana/yamba/blob/yambaII/Yamba/src/com/marakana/android/yamba/TimelineActivity.java)

您必须首先初始化 loaderManager。接下来，当它叫你回来时，把它交给一个装载机。最后，当您在加载程序运行后调用您时，您必须将加载程序交换到适配器中。

当然，您也必须通知游标它已过时。这里有示例代码：

[https://github.com/marakana/yamba/blob/yambaII/YambaService/src/com/marakana/android/yamba/svc/data/YambaProvider.java](https://github.com/marakana/yamba/blob/yambaII/YambaService/src/com/marakana/android/yamba/svc/data/YambaProvider.java)

参见，例如，第 182 行

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T16:49:43.797

对于更新值尝试这样做

```
class YourClass extends Activity{
   //other members
   private Bundle savedInstanceState;   //add this to your code
   public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    this.savedInstanceState = savedInstanceState;    //add this to your code

    //your other code here 
   }
    @Override
protected void onResume() {                     //add this function to your code
    datasource.open();                      //change datasource to your own database class's object
    super.onResume();
    onCreate(savedInstanceState);        
}

} 
```

# android - Android后台服务在模拟器上工作但不在手机上

> ID：14790120
> 
> 赞同：1
> 
> 时间：2013-02-09T16:26:15.723
> 
> 标签：android, android-service, background-service

我开发了一个启动 android 后台服务的 android 应用程序。此服务在选定的时间实例上设置警报。此应用程序和服务在 android 模拟器上运行良好。按我的预期工作。但是当我在我的安卓手机上安装这个应用程序时，奇怪的事情发生了。该应用程序运行良好，它也启动了 android 服务。但从那以后什么都没有发生。我检查了手机上的设置-应用程序-运行应用程序。它表明该服务正在手机上运行。但我对这项服务的期望是在选定的时间实例上响起警报，而我的手机却没有。我有一部三星 Galaxy Nexus 手机。你能诊断一下到底是什么问题吗？

# ios - IOS facebook api - 获取朋友的用户名

> ID：14790122
> 
> 赞同：0
> 
> 时间：2013-02-09T16:26:28.170
> 
> 标签：ios, objective-c, facebook

我在我的 ios 应用程序中使用 Facebook api。使用 FBFriendPickerViewController 的委托方法：'shouldIncludeUser' 我试图根据 FBGraphUser 对象的用户名属性过滤用户的朋友列表。

问题是我继续获取用户名属性的空值，尽管该属性在文档中声明为非 access_key 必需。

谢谢， 埃维塔尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T18:42:50.280

终于找到了！显然 FBFriendPickerViewController 对象有一个名为“fieldsForRequest”的属性。使用此属性，我可以设置额外的属性以从默认情况下不检索的服务器检索。

在我的情况下，我只需要用户名属性：

```
FBFriendPickerViewController *friendPickerController = [[FBFriendPickerViewController alloc] init];
    friendPickerController.title = @"Pick Friends";
    friendPickerController.delegate = self;

    friendPickerController.fieldsForRequest = [NSSet setWithObjects:@"username", nil];

    [friendPickerController loadData];      
    // Use the modal wrapper method to display the picker.
    [friendPickerController presentModallyFromViewController:self animated:YES handler:
     ^(FBViewController *sender, BOOL donePressed) {
         if (!donePressed) {
             return;
         }

     }]; 
```

# powershell - PowerShell：获取有关 Get-Process -Property CPU 的帮助

> ID：14790125
> 
> 赞同：0
> 
> 时间：2013-02-09T16:26:44.760
> 
> 标签：powershell, powershell-3.0

使用 PowerShell 3，我试图获得有关 CPU 可用属性的帮助；在使用 Get-Process 时。我只是在黑暗中尝试了一个镜头，如下所示：

```
Help Get-Process -Property CPU 
```

但是，失败了。任何帮助，请！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T16:53:19.247

你要买什么？有关您的处理器的信息？`Get-Process`列出您计算机上正在运行的进程（例如 Internet Explorer），而不是有关您的处理器芯片（CPU）的信息。前任：

```
Get-Process 
```

输出：

```
Handles  NPM(K)    PM(K)      WS(K) VM(M)   CPU(s)     Id ProcessName                                                                        
-------  ------    -----      ----- -----   ------     -- -----------                                                                        
    284      25     7128       8748   103            1608 AppleMobileDeviceService                                                           
     75       7     1136       1528    44            1588 armsvc                                                                             
    703      82     6612       7732   114     1,25   4212 AsusAudioCenter 
```

可以使用以下方法找到有关您的处理器的信息：

```
Get-WmiObject Win32_Processor 
```

输出：

```
Caption           : Intel64 Family 6 Model 42 Stepping 7
DeviceID          : CPU0
Manufacturer      : GenuineIntel
MaxClockSpeed     : 3400
Name              : Intel(R) Core(TM) i7-2600 CPU @ 3.40GHz
SocketDesignation : LGA1155 
```

获取有关您的 CPU 使用的所有属性`Get-WmiObject Win32_Processor | fl *`。要获取可用属性的列表，请使用`Get-Member`cmdlet 检查`Get-WmiObject`返回的对象：

```
Get-WmiObject Win32_Processor | Get-Member 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T20:00:10.470

你在黑暗中的射门打偏了。另外，由于您对问题的描述只不过是“但是，失败了。”，我只能猜测您的问题可能是什么。为了更好地帮助您使用帮助，您需要通过提供有关您的问题的相关信息（例如错误消息）来帮助我们。

首先，`Help`（或[`Get-Help`cmdlet](http://technet.microsoft.com/library/hh849696.aspx)）没有`-Property`参数。 `-Parameter`可能是您要查找的内容，但是运行`Help Get-Process -Parameter CPU`会显示该[`Get-Process`cmdlet](http://technet.microsoft.com/library/hh849832.aspx)没有`CPU`参数。

其次，返回[类](http://msdn.microsoft.com/library/system.diagnostics.process.aspx)`Get-Process`的实例。文档或运行将向您展示该类公开的属性。您可以通过运行类似...[`System.Diagnostics.Process`](http://msdn.microsoft.com/library/system.diagnostics.process.aspx)`Get-Process | Get-Member`

```
Get-Process | Select-Object -Property (
    'ProcessName',
    'Id',
    'ProcessorAffinity',
    'UserProcessorTime',
    'PrivilegedProcessorTime',
    'TotalProcessorTime'
); 
```

最后，与以前的版本不同，PowerShell 3.0 不安装本地帮助内容。您需要运行[`Update-Help`cmdlet](http://technet.microsoft.com/library/hh849720.aspx)来下载和安装帮助内容。或者，在运行时，`Get-Help`您可以传递`-Online`参数，该参数将在 Web 浏览器中打开 MSDN 的帮助内容。

# windows - Windows Courier 字体看起来非常“瘦”

> ID：14790126
> 
> 赞同：4
> 
> 时间：2013-02-09T16:26:49.263
> 
> 标签：windows, html, css

我目前正在开发一个我想使用 Courier 的网络应用程序。除了 Courier 在 Windows 上运行的浏览器上非常薄之外，一切都很好。我知道 OSX 天生会在“更大胆”的一面渲染显示字体，但是 Windows 的情况似乎很可怕。

我的问题：

*   如何在 Windows 上增加字体粗细？我不寻求获得 font-weight: bold; 因为那太多了。

*   我应该使用哪种其他字体而不是 Courier 来提高 Windows 上的可读性？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T19:59:26.960

以下是字体粗细的选项。但请注意，大多数情况下，特定字体系列只有几个可用的权重。当设置了特定权重但不存在人脸时，将使用权重附近的人脸（[来源](http://www.w3.org/TR/css3-fonts/)）。因此，即使您将权重设置为`500`应该比正常稍厚，它看起来仍然可能相同。

如果您关心的是“可读性”，那么您应该考虑使用不同的字体。普遍的共识是，无衬线字体在屏幕上比衬线字体更“可读”，所以你应该使用类似`Helvetica`or `Verdana`... ( `font-family: Helvetica, Verdana, Arial, Sans-Serif;`)

字体粗细：

`100`- 薄的

`200`- 超轻（超轻）

`300`- 光

`400`- 普通的

`500`- 中等的

`600`- 半粗体（半粗体）

`700`- 大胆的

`800`- 超粗体（超粗体）

`900`- 黑色（重）

`normal`- 与“400”相同。

`bold`- 与“700”相同。

`bolder`- 指定比继承值更粗的面的权重。

`lighter`- 指定面的重量比继承的值轻。

顺便说一句`Courier`，`Courier New`在我的 Windows 浏览器上看起来不错。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T19:59:40.983

现代版本的 Windows 没有 Courier。旧版本有这样的字体，通常是质量差的位图字体。现代版本将字体名称 Courier 映射到 Courier New，这是一种更好的字体。不过，它可能看起来有点薄。

Courier New 只有两种字体粗细，普通和粗体。如果它们都不适合您的偏好，请考虑使用不同的字体。（在某种意义上，使用 可以进行类似粗体的人工修改`text-shadow`，但即使是一个像素的阴影也会产生看起来比粗体字体更粗的外观。）

如果您需要等宽字体，而不是 Courier 或 Courier New，请考虑使用 Lucida Console（在大多数 Windows 系统中可用）或 Consolas（在现代 Windows 系统中可用）。他们有更强的笔画宽度。

# codeigniter - Codeigniter - 会话用户数据大小

> ID：14790129
> 
> 赞同：0
> 
> 时间：2013-02-09T16:27:00.370
> 
> 标签：codeigniter, session, size, limit

我使用 Codeigniter 将我的会话存储在数据库中，也许我的问题很愚蠢，但是如果会话数据有大小限制，我没有发现，如果达到该限制，我无法理解应用程序中会发生什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T16:31:27.973

使用数据库保存会话时没有限制。CI 使用 serialize 序列化数据并将其保存到数据库。

唯一的限制可能是数据库中的字段，在情况下有所不同：

TEXT 65,535 字节 ~64kb
MEDIUMTEXT 16,777,215 字节 ~16MB
LONGTEXT 4,294,967,295 字节 ~4GB

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T16:35:45.560

您可以使用 TEXT 字段大小将 user_data 存储在数据库中，TEXT 字段可以存储 ~64kb。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-11T19:18:22.683

大家好，在数据库中设置 user_data 并使用 BLOB 字段大小进行微调，由 codeigniter 文档推荐

```
CREATE TABLE IF NOT EXISTS `ci_sessions` (
        `id` varchar(128) NOT NULL,
        `ip_address` varchar(45) NOT NULL,
        `timestamp` int(10) unsigned DEFAULT 0 NOT NULL,
        `data` blob NOT NULL,
        KEY `ci_sessions_timestamp` (`timestamp`)
); 
```

# python - 类型。Python中S1和S2的区别

> ID：14790130
> 
> 赞同：21
> 
> 时间：2013-02-09T16:27:24.887
> 
> 标签：python, numpy

我有两个字符串数组：

```
In [51]: r['Z']
Out[51]: 
array(['0', '0', '0', ..., '0', '0', '0'], 
      dtype='|S1')

In [52]: r['Y']                                                                                                                
Out[52]: 
array(['X0', 'X0', 'X0', ..., 'X0', 'X1', 'X1'], 
      dtype='|S2') 
```

S1和S2有什么区别？仅仅是他们持有不同长度的条目吗？

如果我的数组有**不同长度**的字符串怎么办？

我在哪里可以找到所有可能的 dtype 的列表以及它们的含义？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-09T16:32:56.897

请参阅[`dtypes`文档](http://docs.scipy.org/doc/numpy/reference/arrays.dtypes.html)。

和字符串是数据类型描述符`|S1`；`|S2`第一个表示数组保存长度为 1 的字符串，第二个表示长度为 2。`|`管道符号是[字节序标志](http://docs.scipy.org/doc/numpy/reference/generated/numpy.dtype.byteorder.html#numpy.dtype.byteorder)；在这种情况下，不需要字节顺序标志，因此将其设置为`|`，表示不适用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-22T18:47:52.203

For storing strings of variable length in a numpy array you could store them as python objects. For example:

```
In [456]: x=np.array(('abagd','ds','asdfasdf'),dtype=np.object_)

In [457]: x[0]
Out[457]: 'abagd'

In [459]: map(len,x)
Out[459]: [5, 2, 8]

In [460]: x[1]=='ds'
Out[460]: True

In [461]: x
Out[461]: array([abagd, ds, asdfasdf], dtype=object)

In [462]: str(x)
Out[462]: '[abagd ds asdfasdf]'

In [463]: x.tolist()
Out[463]: ['abagd', 'ds', 'asdfasdf']

In [464]: map(type,x)
Out[464]: [str, str, str] 
```

# postgresql - PostgreSQL SELECT-RULES ，继承，行级权限

> ID：14790131
> 
> 赞同：3
> 
> 时间：2013-02-09T16:27:40.890
> 
> 标签：postgresql, rules, postgresql-9.2, row-level-security

这是我一直在阅读的内容：

```
 http://www.postgresql.org/docs/9.2/static/rules-views.html
 http://www.postgresql.org/docs/9.2/static/rules-privileges.html 
```

**我的目标是允许登录只看到它“拥有”的那些*行*，可以这么说。**

假设数据库中的每个表都继承自该表：

```
 create table WHOAMI
   ( 
      tenant varchar(25) not null default current_user
   ); 
```

例如：

```
 create table FOO
   (
     id int primary key,
     invoicedate date
   ) inherits (WHOAMI);

    insert into FOO(id, invoicedate) values(1,now()::date);

    select * from FOO;

    --abclogin|1|2013-02-01 
```

PostgreSQL 中是否存在模式级选择规则这样的东西，它会*影响模式中的所有表和视图*，它会在每个选择、插入、更新或删除语句中附加一个条件，实际上是，`..AND WHERE TENANT = current_user`？如果没有这样的全局规则，是否可以逐表完成？我的尝试没有任何成功，并且可能误解了一些关于如何创建规则的事情。这是我尝试做的事情：

我尝试创建一个选择规则：

```
 CREATE RULE "_RETURN" AS ON SELECT TO FOO DO INSTEAD
  SELECT * FROM FOO where tenant = current_user; 
```

但得到这个错误：`ERROR: could not convert table "foo" to a view because it has indexes`

我尝试创建一个带有*安全屏障*的视图：

```
 CREATE VIEW TENANTFOO WITH (security_barrier) AS
       SELECT * FROM FOO WHERE tenant=current_user; 
```

然后尝试插入：

```
 insert into TENANTFOO(id,invoicedate)
        values(2,(now()::date); 
```

但得到这个错误：

```
 `ERROR:  cannot insert into view "tenantfoo"
         HINT:  You need an unconditional ON INSERT DO INSTEAD rule
         or an INSTEAD OF INSERT trigger.` 
```

在表上实现行级安全屏障需要哪些步骤？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:50:04.160

在您的最后一个示例中，您需要`INSERT` **对表**运行或创建另一个 RULE: `ON INSERT TO TENANTFOO DO INSTEAD`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T23:15:12.123

您正在寻找的是[Row-Level Security](http://wiki.postgresql.org/wiki/RLS)，它尚不可用，尽管[已经在这件事上做了一些工作](http://www.postgresql.org/message-id/CADyhKSWGtZqpsXtF7_q2FvKRvX6RqW+xv7VmxNmj4gubSBoo-g@mail.gmail.com)。我希望这个补丁能在即将到来的 9.3 版本中使用。

同时，我前段时间一直在使用以下设计。

要求相似，视图应该只提供那些用于`CURRENT_USER`. 在我们的例子中，访问非常简单：一个表，指定给定用户是否有权访问给定关系和给定键，例如：

```
CREATE TABLE user_grants (
    user_id     integer,
    entity_name text, -- should exist in pg_class
    entity_id   integer
); 
```

然后，对于`tasks`，创建了以下视图：

```
CREATE VIEW tasks_v AS
SELECT t.*
  FROM tasks t
  JOIN user_grants ug ON t.user_id = ug.user_id
   AND ug.entity_name='TASKS' AND ug.entity_id = t.task_id; 
```

当然，如果没有一些辅助函数、触发器和规则，设置是不完整的。此外，有必要确保始终授予一些合理的默认权限。

# javascript - 编写此 JavaScript 日期代码的更短方法

> ID：14790132
> 
> 赞同：0
> 
> 时间：2013-02-09T16:27:44.603
> 
> 标签：javascript, date

您好，我想以以下格式在 JavaScript 中获取今天的日期：dd/mm/YYYY

以下代码可以完成这项工作，但肯定有更短的方法来编写它吗？

```
 var today = new Date();
    var day = today.getDate();
    var month = today.getMonth()+1;
    var year = today.getFullYear(); 
    var todaysDate = day + "/" + month + "/" + year; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T16:37:57.487

推荐一个很棒的 js 日期/时间库： http: [//momentjs.com/](http://momentjs.com/)

```
moment().format('D/M/YYYY');   //"10/2/2013" 
```

如果您需要填充零：

```
moment().format('DD/MM/YYYY'); //"10/02/2013" 
```

如果你想写纯js，这里没什么可做的，只是剪掉一些变量。

```
var today = new Date;
//parenthesis around month is required.
var todaysDate =  today.getDate() + '/' +  (today.getMonth()+1) + '/' + today.getFullYear();
//"10/2/2013" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T16:34:17.790

当然。

```
var date = new Date();
var todaysDate = date.getDate() + "/" + date.getMonth()+1 + "/" + date.getFullYear(); 
```

请注意，这将返回不带前导零的值。为方便起见，您可以使用一个额外的功能添加它们：

```
function checkTime(i){if(i<10){i="0" + i}return i}
var date = new Date();
var todaysDate = checkTime(date.getDate()) + "/" + checkTime(date.getMonth()+1) + "/" + date.getFullYear(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T16:40:26.977

尽管 JavaScript 提供了许多方法来获取和设置日期对象的一部分，但它**缺乏一种根据用户指定的掩码来格式化日期和时间的简单方法**。你的很简单。

您可以使用外部库，但脚本大小的权衡对于一个简单的操作来说并不是最佳的。

更短的版本是以这种方式将最后 4 行内联起来：

```
var today = new Date();
var todaysDate = today.getDate() + "/" + (today.getMonth()+1) + "/" + today.getFullYear(); 
```

# php - Glob() 随机提取图像？

> ID：14790134
> 
> 赞同：0
> 
> 时间：2013-02-09T16:28:03.687
> 
> 标签：php

我使用此代码获取图像

```
$images = glob($reuter. '/'.$url_places.'/*.{jpg,gif}', GLOB_BRACE); 
```

效果很好，但是.. 它每次都按 ASC 顺序抓取图像（即 1、2、3.jpg）。

无论如何，为了使（图像）滑块更有趣，我需要将这些图像随机取出（所有图像，而不仅仅是一个），例如 3、1、2 jpg 或类似图像。

任何线索如何使用`glob()`？谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:31:00.627

只是[`shuffle`](http://php.net/manual/en/function.shuffle.php)结果：

```
shuffle($images); 
```

# php - 如何存储多租户密码？

> ID：14790135
> 
> 赞同：2
> 
> 时间：2013-02-09T16:28:04.610
> 
> 标签：php, mysql, database, database-design, multi-tenant

为每个租户数据库存储密码的正确方法是什么？

租务经理：

```
id | domain      | host      | user | pass  | db
---------------------------------------------------------
1  | website.com | 127.0.0.1 | root | HOW?  | website.com 
```

当域连接到应用程序时，租户管理器应该获取租户信息并连接到适当的数据库，但是，我无法想象如何以安全的方式存储密码，我需要解密才能建立每个连接。

也许 PHP 方法比数据库方法更安全？但是怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:08:59.840

怎么样使用公钥/私钥加密机制（[http://en.wikipedia.org/wiki/Public-key_cryptography](http://en.wikipedia.org/wiki/Public-key_cryptography)）。您可以将密码保存在使用公钥加密的 mysql 中。读取密码时，您可以使用将安全存储在您的密钥库中的私钥对其进行解密。

您可以使用[http://www.openssl.org/](http://www.openssl.org/)创建和管理您的密钥库。

# scala - 作为宏的通用复制功能

> ID：14790137
> 
> 赞同：0
> 
> 时间：2013-02-09T16:28:12.457
> 
> 标签：scala, scala-macros

我真的很想在我的项目中使用案例类的复制功能，但不幸的是我还需要继承，这不适用于案例类。
所以，我想知道是否可以编写一个宏来生成一个为任意类创建带有更改的复制对象的方法。目前让我停下来的是AFAIK宏不支持命名参数的事实。有没有人找到解决方法，或者，可以建议其他方法来轻松创建使用继承的副本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T16:46:55.050

这可以通过类型宏和/或注释宏来实现。当前的宏不支持这一点。

不过，请注意镜头的工作。周围有很多基于宏的版本，例如 Shapeless。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:33:45.277

你也可以看看[https://github.com/dicarlo2/ScalaEquals](https://github.com/dicarlo2/ScalaEquals)

# php - 如何仅使用 preg_match 允许单个下划线？

> ID：14790141
> 
> 赞同：1
> 
> 时间：2013-02-09T16:28:26.423
> 
> 标签：php, regex, preg-match

如何仅使用 preg_match 允许单个下划线？

我在下面制作的正则表达式需要双下划线，这不是我想要的......

```
if(!preg_match('/^[a-z0-9\s\_]+$/', $name))
    {
        $error = true;
        echo '<error elementid="name" message="name - please use alpha-numbers and lowercaps only." />';
    } 
```

例如，

```
hello world                  ok
hello_world                  ok
hello__world                 not ok
hello_world__again__         not ok
_hello_world_again_          not ok 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T16:30:22.213

包括`_`内部`[]+`允许倍数。您需要将其包围，`[]+`但不要将其包含在内。整个结构被包围`()+`以允许它的倍数，但它总是以字母、数字或空格结尾。

```
/^([a-z0-9\s]+_?[a-z0-9]+[a-z0-9\s]+)+$/i 
```

分解它：

*   外部`()+`允许整个结构的倍数
*   `[a-z0-9\s]+`多个字母、数字、空格（非下划线
*   `_?[a-z0-9]+`多个字母/数字/空格内的可*选单*下划线，但后面不跟空格
*   `[a-z0-9\s]+`结尾有更多字母、数字、空格（不能以下划线结尾）
*   `/i`不区分大小写（`i`如果需要区分大小写，请删除）

* * *

```
// Updated to prevent space after underscore
$patt = '/^([a-z0-9\s]+_?[a-z0-9]+[a-z0-9\s]+)+$/i';

echo preg_match($patt, 'hello world');
// 1
echo preg_match($patt, 'hello_world');
// 1
echo preg_match($patt, 'hello_world_');
// 0
echo preg_match($patt, 'hello__world');
// 0
echo preg_match($patt, 'hello_world how_are you');
// 1
echo preg_match($patt, 'hello_world how_are you_');
// 0
echo preg_match($patt, 'hello_world__ how_are you_');
// 0 
echo preg_match($patt, 'hello_world how_ are you');
// 0 
```

# java - Java 扫描程序在循环期间不阻塞

> ID：14790142
> 
> 赞同：2
> 
> 时间：2013-02-09T16:28:31.470
> 
> 标签：java, while-loop, iteration, java.util.scanner

我遇到了一个问题，即 Scanner 在无限期的 while 循环中没有阻止用户输入。我试过使用`hasNextLine()`，但没有奏效。它只是无限地运行循环调用`displayMenu()`.

```
 do {

        displayMenu();

        int response;
        while (iStream.hasNextLine()) {
            response = Integer.parseInt(iStream.nextLine());

            switch (response) {
                case 1:
                    decodeMessage(getPhrase());
                    break;
                case 2:
                    encodeMessage(getPhrase());
                    break;
                case 3:
                    displayAlphabet();
                    break;
                case 4:
                    done = true;
                    System.out.println("Goodbye.");
                    break;
                default:
                    done = false;
            }
        }

    }
    while (!done); 
```

我也尝试过不使用`hasNextLine()`，但我最终得到了 a `NoSuchElementException`，因为它第一次完美运行，但在第二次迭代中，它不会阻止用户输入。

```
 do {

        displayMenu();

        int response = Integer.parseInt(iStream.nextLine());

            switch (response) {
                case 1:
                    decodeMessage(getPhrase());
                    break;
                case 2:
                    encodeMessage(getPhrase());
                    break;
                case 3:
                    displayAlphabet();
                    break;
                case 4:
                    done = true;
                    System.out.println("Goodbye.");
                    break;
                default:
                    done = false;

        }

    }
    while (!done); 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:39:25.097

以下对我来说很好：

```
private static void displayMenu ()
{
    System.out.println ("Menu:");
    System.out.println ("\t1: Decode message");
    System.out.println ("\t2: Encode message");
    System.out.println ("\t3: Display alphabet");
    System.out.println ("\t4: Exit");
}

public static void main (String [] args)
{
    Scanner scanner = new Scanner (System.in);

    boolean done = false;
    while (!done)
    {
        displayMenu();

        switch (Integer.parseInt (scanner.nextLine ()))
        {
            case 1:
                System.out.println ("Decoding...");
                break;
            case 2:
                System.out.println ("Encoding...");
                break;
            case 3:
                System.out.println ("Displaying alphabet...");
                break;
            case 4:
                System.out.println("Exitting...");
                done = true;
                break;
            default:
                done = false;
        }
    }
} 
```

# c++ - 通过引用传递变量并构造新对象

> ID：14790148
> 
> 赞同：0
> 
> 时间：2013-02-09T16:29:18.820
> 
> 标签：c++, reference

您好，我在下面有这样的代码，但我不知道为什么它不起作用。

```
class Clazz2;
class Clazz
{
    public:
    void smth(Clazz2& c)
    {

    }

    void smth2(const Clazz2& c)
    {

    }
};

class Clazz2
{
    int a,b;
};

int main()
{
    Clazz a;
    Clazz2 z;
    a.smth(z);
    //a.smth(Clazz2()); //<-- this doesn't work
    a.smth2(Clazz2()); // <-- this is ok
    return 0;
} 
```

我有编译错误：

```
g++ -Wall -c "test.cpp" (in directory: /home/asdf/Desktop/tmp)
test.cpp: In function ‘int main()’:
test.cpp:26:17: error: no matching function for call to ‘Clazz::smth(Clazz2)’
test.cpp:26:17: note: candidate is:
test.cpp:5:7: note: void Clazz::smth(Clazz2&)
test.cpp:5:7: note:   no known conversion for argument 1 from ‘Clazz2’ to ‘Clazz2&’
Compilation failed. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T16:30:28.130

这是因为非常量引用不允许绑定到临时对象。`const`另一方面，对 的引用可以绑定到临时对象（参见 C++11 标准的 8.3.5/5）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T16:31:14.523

您的第`smth2`一个引用不能绑定到像您的构造函数调用这样的临时对象`a.smth(Claszz2())`。但是，*const*引用可以绑定到临时，因为我们不能修改临时，所以它是允许的。

在 C++11 中，您可以使用*右值引用*，以便您也可以绑定临时对象：

```
void smth2(Clazz2 &&);

int main()
{
    a.smth(Claszz2()); // calls the rvalue overload
} 
```

# android - java.lang.NoClassDefFoundError: com.google.android.gms.common.AccountPicker

> ID：14790149
> 
> 赞同：5
> 
> 时间：2013-02-09T16:29:45.683
> 
> 标签：android, google-drive-api, noclassdeffounderror

好的，我为此失眠了很多，我似乎找不到问题所在。

我正在尝试将谷歌驱动器与我正在与团队合作的大型应用程序集成。.

这是 logcat 吐出的内容：

```
02-09 10:13:40.979: E/AndroidRuntime(9768): java.lang.NoClassDefFoundError: com.google.android.gms.common.AccountPicker
02-09 10:13:40.979: E/AndroidRuntime(9768):     at com.google.api.client.googleapis.extensions.android.gms.auth.GoogleAccountCredential.newChooseAccountIntent(GoogleAccountCredential.java:171)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at graef.mobile.activities.DriveHandler.onCreate(DriveHandler.java:36)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at android.app.Activity.performCreate(Activity.java:4465)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2033)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2104)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at android.app.ActivityThread.access$600(ActivityThread.java:132)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1157)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at android.os.Looper.loop(Looper.java:137)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at android.app.ActivityThread.main(ActivityThread.java:4575)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at java.lang.reflect.Method.invokeNative(Native Method)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at java.lang.reflect.Method.invoke(Method.java:511)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:789)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:556)
02-09 10:13:40.979: E/AndroidRuntime(9768):     at dalvik.system.NativeStart.main(Native Method) 
```

我有我需要的所有库，我也遇到了一些多个 dex 错误。所以我的 libs 文件夹中没有任何内容，因为我发现这是解决该问题的方法，因为 /libs 和 /bin/dexedLibs 中有双罐子

任何帮助将不胜感激

让我知道我需要提供哪些其他信息。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-10T19:42:28.980

我需要确保我已导入并按顺序检查和导出 google play 服务

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T10:25:41.270

我也有同样的问题，直到我添加：

```
import com.google.android.gms.common.AccountPicker; 
```

在我的`activity.java`档案中。希望它也适用于您的问题。

# spring - 在 Spring 中自定义 PropertyEditorSupport

> ID：14790151
> 
> 赞同：0
> 
> 时间：2013-02-09T16:30:06.003
> 
> 标签：spring, validation, spring-mvc, property-editor

我正在使用 Spring 3.2。为了全局验证双精度值，我使用`CustomNumberEditor`. 确实执行了验证。

但是当我输入一个像`1234aaa`,`123aa45`等等的数字时，我希望`NumberFormatException`会被抛出，但事实并非如此。文档说，

> 如果无法解析指定字符串的开头，则会引发 ParseException

因此，上面提到的这些值被解析为它们表示为数字，然后省略字符串的其余部分。

为避免这种情况并使其抛出异常，当输入此类值时，我需要通过扩展此[问题](https://stackoverflow.com/q/4726861/1391249)`PropertyEditorSupport`中提到的类来实现我自己的属性编辑器。

```
package numeric.format;

import java.beans.PropertyEditorSupport;

public final class StrictNumericFormat extends PropertyEditorSupport
{
    @Override
    public String getAsText() 
    {
        System.out.println("value = "+this.getValue());
        return ((Number)this.getValue()).toString();
    }

    @Override
    public void setAsText(String text) throws IllegalArgumentException 
    {
        System.out.println("value = "+text);
        super.setValue(Double.parseDouble(text));
    }
} 
```

我在带有`@InitBinder`注解的方法中指定的编辑器如下。

```
package spring.databinder;

import java.text.DateFormat;
import java.text.DecimalFormat;
import java.text.Format;
import java.text.NumberFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import org.springframework.beans.propertyeditors.CustomDateEditor;
import org.springframework.beans.propertyeditors.CustomNumberEditor;
import org.springframework.web.bind.WebDataBinder;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.InitBinder;
import org.springframework.web.context.request.WebRequest;

@ControllerAdvice
public final class GlobalDataBinder 
{
    @InitBinder
    public void initBinder(WebDataBinder binder, WebRequest request)
    {
        DateFormat dateFormat = new SimpleDateFormat("MM/dd/yyyy HH:mm:ss");
        dateFormat.setLenient(false);
        binder.setIgnoreInvalidFields(true);
        binder.setIgnoreUnknownFields(true);
        //binder.setAllowedFields("startDate");
        binder.registerCustomEditor(Date.class, new CustomDateEditor(dateFormat, true));

        //The following is the CustomNumberEditor

        NumberFormat numberFormat = NumberFormat.getInstance();
        numberFormat.setGroupingUsed(false);
        binder.registerCustomEditor(Double.class, new CustomNumberEditor(Double.class, numberFormat, false));
    } 
} 
```

由于我使用的是 Spring 3.2，因此我可以利用[`@ControllerAdvice`](http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/web/bind/annotation/ControllerAdvice.html)

* * *

出于好奇，从不调用类中的类中**覆盖**的方法，并且将输出重定向到控制台的语句（如在这些方法（和）中指定的那样）不会在服务器控制台上打印任何内容。`PropertyEditorSupport``StrictNumericFormat``getAsText()``setAsText()`

[我已经尝试了该问题](https://stackoverflow.com/q/4726861/1391249)的所有答案中描述的所有方法，但没有一个对我有用。我在这里想念什么？这是否需要在某些 xml 文件中进行配置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:44:56.780

显然你没有通过`StrictNumericFormat`引用。您应该像这样注册您的编辑器：

```
 binder.registerCustomEditor(Double.class, new StrictNumericFormat()); 
```

BTW Spring 3.X 引入了一种实现转换的新方法：[转换器](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/validation.html#core-convert)

# mysql - MySQL：使用从对子句中选择字段的结果插入

> ID：14790159
> 
> 赞同：0
> 
> 时间：2013-02-09T16:30:31.557
> 
> 标签：mysql, subquery

我需要向现有行添加额外的数据项并将结果插入第二个表中。我选择的每一行的数据项都是不同的，所以我不能只将它添加到 SELECT 语句中。原始查询是：

```
SELECT player_id,token_id,email FROM players
WHERE token_id in (101,102) OR email in ("test4@test.com"); 
```

我希望能够执行类似行构造函数的操作并编写如下查询：

```
SELECT player_id,token_id, email, key_val FROM players
WHERE (token_id, key_val) in ( (101, 'xyz'),(102,'abc'))
   OR (email, key_val) in ( ("test4@test.com", 'qpr') ); 
```

这样 IN 子句中对的第二个值 ('key_val') 将作为最后一列添加到 SELECT 输出中。然后整个批次将被插入决赛桌。

IN 子句中的项目数从 3 到可能 100 不等。

如果这是一个重复，真的很抱歉。我查找了类似的内容： [使用 in 子句按字段对选择查询](https://stackoverflow.com/questions/10725901/select-query-by-pair-of-fields-using-an-in-clause) [MySQL：如何在 WHERE 子句中批量选择具有多对的行](https://stackoverflow.com/questions/13426203/mysql-how-to-bulk-select-rows-with-multiple-pairs-in-where-clause) 我想我可以使用临时表，但我担心这样的次数这将被调用。

编辑 -

为了澄清，源表是这样的：

```
player_id, token_id, email
===================================
1          101       null
2          102       null
3          null      test4@test.com 
```

提供的日期是：

```
(token_id=101, key_val='xyz'),(token_id=102, key_val='abc'),(email='test4@test.com', key_val='qpr') 
```

预期的输出将是：

```
player_id  token_id  email          keyy_val
========== ========= ============== ========
1          101       null           zyz
2          102       null           abc
3          null      test4@test.com qpr 
```

希望这能让它更清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T16:38:38.567

尝试这个

```
SELECT player_id,token_id, email, key_val 
FROM players
WHERE token_id in (101,102) AND key_val IN ('xyz','abc')
OR ( email in ("test4@test.com") AND  key_val IN ('qpr') ); 
```

编辑 -。尝试这个

```
 SELECT player_id,token_id, email, key_val 
 FROM ( select player_id,token_id, email, 
  if(`token_id` =101 , 'xyz',
  if(`token_id` =102 , 'abc' ,
  if(email = "test4@test.com" , 'qpr' , NULL))
  ) key_val

from players 
)p 
```

[**演示 SQLFIDDLE**](http://sqlfiddle.com/#!2/e2460/12)

# javascript - 是否可以使用第二个变量为变量赋值？

> ID：14790160
> 
> 赞同：-1
> 
> 时间：2013-02-09T16:30:36.053
> 
> 标签：javascript, variables

我想通过另一个变量将值设置为变量，该变量将引用第一个变量。请参见下面的示例。

```
var white = 1;
var black = 15;
var flag = 'white';

if (flag == 'white') {
  var color = &white;
  color++;
} else {
  var color = &black;
  color--;
}
alert(white + ' ' + black);
//will display   2  15
// or
//will display 1  14 
```

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:37:48.113

JS 中没有真正的传递引用。但是，我想出了这个技巧（对象是 JS 中唯一通过引用传递的东西）：

```
var white = { val: 1 },
    black = { val: 15 },
    flag = 'white', color;

if (flag == 'white') {
  color = white;
  color.val++;
} else {
  color = black;
  color.val--;
}

alert(white.val + ' ' + black.val); // 2, 15 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T16:38:12.097

在 javascript中没有像`&black`,这样的引用变量`&white`你可以说

```
var color = white; 
```

并且警报将显示 2 15

你的 else 语句永远不会被执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T16:38:49.363

在 JS 中，通过引用传递只发生在对象上。原始值通过引用传递。JS 中没有直接等效于 C 指针的功能。

# javascript - 如何从带有模态确认的对话框窗口提交“下属”表单？

> ID：14790162
> 
> 赞同：0
> 
> 时间：2013-02-09T16:30:42.373
> 
> 标签：javascript, jquery, ruby-on-rails, forms, jquery-ui

我正在使用 Ruby on Rails 3.2.9 和 jQuery Rails 2.1.4。我有一个表单，当用户更改单选按钮时会显示确认消息，如果用户确认该操作，则提交表单。相关的 JavaScript 代码如下：

```
radioButtons.change(function() {
  var confirm_submit = confirm('Are you sure?');

  if (confirm_submit) {
    // Submit the form
    var form = $jQ(radioButtonContainer).closest('form');
    form.submit();
  } else {
    // Do nothing
  }
}) 
```

我想用一个[对话框窗口](http://jqueryui.com/dialog/#modal-confirmation)替换警报消息，其中包含模式确认`Confirm`和`Cancel`按钮，其行为如下：

1.  `Cancel`单击按钮时，对话框窗口将关闭，不再发生任何事情；
2.  `Confirm`单击按钮时，对话框窗口将关闭并提交“下属”表单。

我怎样才能做到这一点？

# php - jQuery 脚本因未知原因而循环

> ID：14790163
> 
> 赞同：0
> 
> 时间：2013-02-09T16:30:50.663
> 
> 标签：php, javascript, jquery

我对循环随机次数的 jQuery 脚本有疑问，我不知道为什么。这是我的代码：

```
 <!DOCTYPE html>

    <html lang="en">

    <head>
    <?php
    include 'head.php'
    ?>
    </head>

    <body>
    <div id="container">

    <!-- Header -->

    <?php
    include 'header.php'
    ?>

    <!-- Navigation Bar -->

    <?php
    include 'navigation.php'
    ?>

  <!-- Gallery section -->

  <section class="articles">

    <h1><a href="projects.php?cat=All">Projects</a></h1>
    <hr>

    <div id="infoblock">

    <?php

    if (!empty($_GET['id'])) {
    require 'info.php';
    }

    else {
      if (!empty($_GET['cat'])) {
        require 'maingallery.php';
      }

      else {
        echo '<p>Database error, please reload your page';
      };
    };

    ?>

    </div>

  </section>

  <!-- Footer -->

  <?php
  include 'footer.php'
  ?>

</div>
   </body>

   </html> 
```

所以我的问题是需要 maingallery.php 。这是 maingallery.php 的代码：

```
 <div id="filterbuttons">
    <h4 class="selected" id="All" href="gallery.php" >All</h4>
    <h4 id="Residential" href="gallery.php?cat=Residential" >Residential</h4>
    <h4 id="Modernisation+%26+Domestic+Extensions" href="gallery.php?cat=Modernisation+%26+Domestic+Extensions" >Modernisation & Domestic Extensions</h4>
    <h4 id="Feasibility+Layouts" href="gallery.php?cat=Feasibility+Layouts" >Feasibility Layouts</h4>
    <h4 id="Master+Planning" href="gallery.php?cat=Master+Planning" >Master Planning</h4>
    </div>

    <ul class="gallery">

    <div id="gallerylist">  
       <?php require 'gallery.php'; ?>
    </div>

    </ul> 
```

这是gallery.php：

```
 <?php

    if (!empty($_GET)) {
        $cat = urldecode($_GET['cat']);
    }
    else {
        $cat = 'All';
    };

    $dbc = mysqli_connect('server.microlite10.com','XXXXXX','XXXXXX','avd');

    if ($dbc) {
        getGallery($cat, $dbc);
    }
    else {
        echo '<p>Database error, please refresh your screen!</p>';
    };

    function getGallery($cat, $dbc) {
        $r = 'SELECT * FROM Projects';
        $q = mysqli_query($dbc,$r);
        while ( $row = mysqli_fetch_array( $q, MYSQLI_ASSOC) ) {

            if ( $cat == 'All' ) {
                echo '<li class="item">
                <a class="info" href="info.php?id='.$row['id'].'"><img src="'.$row['thumbnail'].'" width="212" height="119" alt="'.$row['name'].'"></a>
                <h2><a class="info" href="info.php?id='.$row['id'].'">'.$row['name'].'</a></h2>
                <h3><a class="cat" href="gallery.php?cat='.urlencode($row['category']).'">'.$row['category'].'</a></h3></li>';   
            }

            else {
                if ( $row['category']==$cat) {

                    echo '<li class="item">
                    <a class="info" href="info.php?id='.$row['id'].'"><img src="'.$row['thumbnail'].'" width="212" height="119" alt="High Tor East, Earl Shilton"></a>
                    <h2><a class="info" href="info.php?id='.$row['id'].'">'.$row['name'].'</a></h2>
                    <h3><a class="cat" href="gallery.php?cat='.urlencode($row['category']).'">'.$row['category'].'</a></h3></li>';

                };    
            };
        };
    }

    ?>
    <script type="text/javascript">

        // Assign $cat value to variable
        // and find relative <h4> element to assign selected class
        var cat = "<?php echo urlencode($cat); ?>";
        alert('script executed');
        $("h4").each(function () {
          var id = $(this).attr('id');
          if (cat == id) {
            $(this).addClass('selected');
          }
          else {
            $(this).removeClass('selected');
          };
        });

        $("li.item:visible").each(function(i) {
            if((i+1)%4==0) $(this).css("margin","30px 0 30px 0px");
            else $(this).css("margin","30px 20px 30px 0");
        });

        $('.cat').bind('click', function(e) {
            var href = $(this).attr('href');
            $('#gallerylist').load(href);
            e.preventDefault();
        });

        $('h4').bind('click', function(e) {
            var href = $(this).attr('href');
            $('#gallerylist').one().load(href);
            var stateObj = { foo : "bar" };
            var newurl = $(this).attr('id');
            history.pushState(stateObj, "", ('http://www.damianwojtczak.com/avd2/projects.php?cat='+newurl));
            e.preventDefault();
        });

        $('.info').bind('click' , function(e) {
            var href = $(this).attr('href');
            $('#infoblock').load(href);
            e.preventDefault();
        });

  </script> 
```

所以我的问题是添加到 gallery.php 文件的 jQuery 脚本。当我单击任何 h4 元素时，jQuery 正在使用新内容重新加载 #gallerylist 元素并阻止默认操作。对于最初的几次点击，它工作正常，但似乎来自“gallery.php”文件的脚本由于某种原因正在循环，而没有点击任何 h4 元素。我添加了“警报”消息来检查我的脚本执行了多少次，但无法弄清楚它为什么循环。

您可以在此处查看此问题[http://www.damianwojtczak.com/avd2/projects.php?cat=All](http://www.damianwojtczak.com/avd2/projects.php?cat=All)，只需尝试单击过滤元素（全部、住宅等），您会注意到脚本作为警报循环出现几次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T16:41:48.050

问题是，每次通过 ajax 加载新图库时`gallery.php`，都会将点击事件重新绑定到`.cat`和`h4`.. 您只需要绑定一次，并且应该这样做`project.php`而不是在`gallery.php`

如果您打开 Inspector/Firebug 并查看 Net 选项卡，您会看到单击其中一个 H4 会导致发出多个 GET 请求（在画廊之间切换的次数越多）。由于来自的响应`gallery.php`包含一个脚本标记，因此其中的所有 JS 都在执行。

将`<script>`标签移出 gallery.php 并移入 project.php

# c# - 在 wp7 中使用 Dispatcher

> ID：14790169
> 
> 赞同：0
> 
> 时间：2013-02-09T16:31:55.750
> 
> 标签：c#, windows-phone-7

我想在我的应用程序中使用 Dispatcher 但这不运行我的代码在这里

```
 private void LoadPage()
        {
            Dispatcher.BeginInvoke(() =>
                    {
                        TextBlock temp = new TextBlock();
                        temp.TextWrapping = TextWrapping.Wrap;
                        temp.TextAlignment = TextAlignment.Right;
                        temp.FontSize = 32;
                        temp.Text = "";
                        for (int i = 0; i < word.Length; i++)
                        {
                            temp.Text = temp.Text + " " + word[i];
                            temp.UpdateLayout();
                            temp.Measure(new Size(double.PositiveInfinity, double.PositiveInfinity));
                            if (temp.ActualHeight < 600)
                                text = text + " " + word[i];
                            else
                            {
                                pages.Add(text);
                                temp.Text = "";
                                text = "";
                            }
                        }
                        if (text != "")
                            pages.Add(text);
                    });
        } 
```

为了运行这个我使用这个代码

```
Thread t = new Thread(new ThreadStart(LoadPage));
                t.Start();

                while (pages.Count == 0)
                {
                    if (!t.IsAlive)
                        break;
                } 
```

但总是在 while 循环第二次中断但没有 Thread 和 Dispatcher 后，我的应用程序运行良好，并且在我出错的地方没有任何问题？我不知道 ：（

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:01:30.520

你的应用现在是如何工作的

```
UI Thread       | Second thread
====================================   
create and run  |
thread          |
---------------------------------------
waiting         | shedule your dispatcher code 
                | for executing on ui thread
------------------------------------------              
waiting         | finishing (t.IsAlive now is true)
------------------------------------------
waiting count=0 |
....
waiting count=0 |
....            |
(until End      |
of the World)   | 
```

Lambda，传递给 Dispatcher，从未执行。

问题是 Dispatcher 不会并行执行代码，它会调度代码以在 UI 线程上执行，因此只有在当前 UI 线程任务完成后才会执行（在您的情况下，它是一个 while 循环）。

因为在大多数情况下任务很小，它会产生并行工作的错觉，但它只是一个委托队列，一个一个执行。

要知道如何修复它，我需要知道你想要实现什么，因为我不理解这段代码的整个想法。为什么不能放置调度程序代码而不是线程和等待循环？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:47:53.637

您的代码实际上没有多大意义。您正在启动一个线程，然后立即编组回 UI 线程。看起来您的任何代码都不能在 UI 线程之外执行，因此不清楚您要尝试实现什么来启动新代码。

我怀疑您对线程的工作方式也有些困惑。你的代码很可能在你的线程开始之前就开始执行while循环——即它可以很容易地调用`t.Start()`，然后在`LoadPage`调用之前进入while循环。

# php - ajax登录提交后淡出

> ID：14790172
> 
> 赞同：0
> 
> 时间：2013-02-09T16:32:30.377
> 
> 标签：php, jquery, ajax, forms, login

我目前有一个非常好的淡入淡出的登录页面，可以在这里看到：ournewlife.com/001/login.php

在用户成功登录后，我希望它在重定向之前淡出相似的时间。我在以下代码中向 load.fadeOut 传递了一个值（7777）：

```
$('#login').on('click', function(e) {
    // Some variables
    var username = $('input[name=username]').val(),
            password = $('input[name=password]').val(),
            csrf = $('input[name=csrf_field]').val(),
            load = $('.form_loader');
    feedback.slideToggle();
    load.fadeIn();
    // Check to see if any empty values..
    // I mean c'mon.. Why disturb PHP?
    if ( username === "" || password === "" || csrf === "" ) {
        feedback.removeClass().addClass('alert error').text('Please enter your username and or password!').slideToggle();
        load.fadeOut();
        return false;
    }
    // Post the data and validate it.
    $.ajax({
        type: 'post',
        url: 'process.php',
        dataType: 'json',
        data: {
            username: username,
            password: password,
            csrf_field: csrf,
            task: "login"
        }, success: function(data) {
            load.fadeOut(7777);
            feedback.removeClass().addClass( (data.error === false) ? 'alert success' : 'alert error' ).html(data.message).fadeIn();
            if (data.error === false) {
                location.href = data.redirect;
            }
        }, error: function(XMLHttpRequest, textStatus, errorThrown) {
            feedback.removeClass().addClass('error').text('Something went wrong. Please check the console for more information.').fadeIn();
            load.fadeOut();
            console.log(XMLHttpRequest);
            console.log(textStatus);
            console.log(errorThrown);
            // console.log(XMLHttpRequest.responseText);
        }
    });
    return false;
}); 
```

这是此处较大代码的一部分：

```
 jQuery.support.placeholder = (function(){
 var i = document.createElement('input');
 return 'placeholder' in i;
 })();

$(document).ready( function() {

$("body").css("display", "none");
$("body").fadeIn(6666);

// Does it support placeholders?
if ( $.support.placeholder ) {
    // Let the users know what to enter.
    $('.input-block > label').hide();
}

// Global Variables
feedback = $('#feedback');

// Hide the JS message
$('.no-js').hide();

/**
 * Called when the user forgets their password.
 */
$('#forgot_password').on('click', function() {
    // Some variables.
    var email = $('input[name=email]').val();
    feedback.fadeOut();
    if ( email === "" ) {
        feedback.removeClass().addClass('alert error').text('Please fill out all required fields!').slideToggle();
        return false;
    }
    $.ajax({
        type: 'POST',
        url: 'process.php',
        dataType: 'json',
        data: {
            email: email,
            task: 'forgot_password'
        }, success: function(data) {
            feedback.removeClass().addClass((data.error === true) ? 'alert error' : 'alert success').text(data.message).slideToggle();
        }
    });
    return false;
});

$('#save_settings').on('click', function() {
    feedback.fadeOut();
    var allow_reg = parseInt($('#registration').val()),
            location = $('#location').val();
    $.post('process.php', {
        allow_reg: allow_reg,
        location: location,
        task: 'save_settings'
    }, function( data ) {
        if ( data.error === false ) {
            // We have no errors.
            feedback.removeClass().addClass('alert success').text(data.message).slideToggle();
        }
    }, 'json');
    return false;
});

/**
 * Called when the user registers a new account.
 */
$('#register').on('click', function() {
    // Some variables.
    var username = $('input[name=username]').val(),
            password = $('input[name=password]').val(),
            email = $('input[name=email]').val(),
            captcha = $('input[name=captcha]').val();
            feedback.fadeOut();
    // Some validation.
    if ( username === "" || password === "" || email === "" || captcha === "") {
        feedback.removeClass().addClass('alert error').text('Please fill out all required fields!').slideToggle();
        return false;
    }
    $.ajax({
        type: 'POST',
        url: 'process.php',
        dataType: 'json',
        data: {
            username: username,
            password: password,
            email: email,
            captcha: captcha,
            task: 'new_user'
        }, success: function(data) {
            feedback.removeClass().addClass((data.error === true) ? 'alert error' : 'alert success').text(data.message).slideToggle();
        }
    });
    return false;
});

/**
 * When the user clicks on the login button.
 */
$('#login').on('click', function(e) {
    // Some variables
    var username = $('input[name=username]').val(),
            password = $('input[name=password]').val(),
            csrf = $('input[name=csrf_field]').val(),
            load = $('.form_loader');
    feedback.slideToggle();
    load.fadeIn();
    // Check to see if any empty values..
    // I mean c'mon.. Why disturb PHP?
    if ( username === "" || password === "" || csrf === "" ) {
        feedback.removeClass().addClass('alert error').text('Please enter your username and or password!').slideToggle();
        load.fadeOut();
        return false;
    }
    // Post the data and validate it.
    $.ajax({
        type: 'post',
        url: 'process.php',
        dataType: 'json',
        data: {
            username: username,
            password: password,
            csrf_field: csrf,
            task: "login"
        }, success: function(data) {
            load.fadeOut(7777);
            feedback.removeClass().addClass( (data.error === false) ? 'alert success' : 'alert error' ).html(data.message).fadeIn();
            if (data.error === false) {
                location.href = data.redirect;
            }
        }, error: function(XMLHttpRequest, textStatus, errorThrown) {
            feedback.removeClass().addClass('error').text('Something went wrong. Please check the console for more information.').fadeIn();
            load.fadeOut();
            console.log(XMLHttpRequest);
            console.log(textStatus);
            console.log(errorThrown);
            // console.log(XMLHttpRequest.responseText);
        }
    });
    return false;
});

$('#forgot-password').on('click', function() {
    // Some variables.
    var forgotEmail = $('input#forgot-email').val(),
            feedback = $('#feedback'),
            load = $('#loading');

    feedback.fadeOut();
    load.fadeIn();
    if (forgotEmail === "") {
        load.fadeOut();
        feedback.removeClass().addClass('error').text('Please enter your email so that I can work with it!').fadeIn();
        return false;
    }
    $.ajax({
        type: 'post',
        url: 'process.php',
        dataType: 'json',
        data: {
            forgotEmail: forgotEmail
        }, success: function(data) {
            load.fadeOut();
            feedback.removeClass().addClass( (data.error === false) ? 'success' : 'error' ).text(data.message).fadeIn();
        }, error: function(XMLHttpRequest, textStatus, errorThrown) {
            feedback.removeClass().addClass('error').text('Something went wrong. Please check the console for more information.').fadeIn();
            load.fadeOut();
            console.log(XMLHttpRequest);
            console.log(textStatus);
            console.log(errorThrown);
        }
    });
    return false;
});

/** TODO: Do this **/
$('#renew-password').on('click', function() {
    var passwordOne = $('input#re-password').val(),
            passwordTwo = $('input#re-password-2').val(),
            emailReset = $('input#email-reset').val(),
            resetCode = $('input#reset-code').val(),
            feedback = $('#feedback'),
            load = $('#loading');

    feedback.fadeOut();
    load.fadeIn();

    if ( (passwordOne === "") || (passwordTwo === "") || (emailReset === "") || resetCode === "") {
        load.fadeOut();
        feedback.removeClass().addClass('error').text('Please enter your new password, two times!').fadeIn();
        return false;
    }

    $.ajax({
        type: 'post',
        url: 'process.php',
        dataType: 'json',
        data: {
            passwordOne: passwordOne,
            passwordTwo: passwordTwo,
            emailReset: emailReset,
            resetCode: resetCode
        }, success: function(data) {
            load.fadeOut();
            feedback.removeClass().addClass( (data.error === false) ? 'success' : 'error' ).text(data.message).fadeIn();
        }, error: function(XMLHttpRequest, textStatus, errorThrown) {
            feedback.removeClass().addClass('error').text('Something went wrong. Please check the console for more information.').fadeIn();
            load.fadeOut();
            console.log(XMLHttpRequest);
            console.log(textStatus);
            console.log(errorThrown);
        }
    });

    return false;
});

 }); 
```

我在其他地方搜索并尝试了其他解决方案，但它们没有奏效。我又回到了这个，因为它似乎是最简单和最直接的。如果有人对如何实现这一点有任何想法，那就太好了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T17:03:00.467

```
success: function(data) {
  if(data.error){
    feedback.removeClass().addClass('alert error').html(data.message);
  } else {
    load.fadeOut(7777, function(){
      window.location.href = data.redirect;
    }
  }
} 
```

我就是这样做的。如果登录不正确，您真的不想在重试之前等待 fadeOut 执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T16:56:31.250

使用淡出回调：

```
feedback.removeClass().addClass( (data.error === false) ? 'alert success' : 'alert error' ).html(data.message).fadeIn();
load.fadeOut(7777, function() {
       if (data.error === false) {
            location.href = data.redirect;
        }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T12:43:23.710

感谢您的小费。此代码有效：

```
 success: function(data) { 
      if(data.error) load.fadeOut(7, function() { 
        feedback.removeClass().addClass('alert error').html(data.message).fadeIn();
        }); 
      else $("body").fadeOut(4444, function() { 
        //feedback.removeClass().addClass('alert success').html(data.message).fadeIn(); 
        setTimeout(new Function("location.href = '" + data.redirect+ "';")); 
 }); 
```

# android - Android 位图：getPixel() 颜色

> ID：14790173
> 
> 赞同：0
> 
> 时间：2013-02-09T16:32:32.333
> 
> 标签：android, colors, android-camera, rgb

我有一张我加载到位图的照片。我检查了一些像素的颜色。但是在图片中，由于光线和其他因素，有时应该是红色的东西有点多一点栗色、洋红色、橙色等。我正在使用方法 getPixel(x,y) 返回颜色的 int 值。是否有可能检查此 int 值是否在定义类似于红色的颜色的区间内。或者是任何网站或其他东西，我可以在其中找到任何定义或颜色描述？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:40:41.110

是的。从[http://developer.android.com/reference/android/graphics/Color.html](http://developer.android.com/reference/android/graphics/Color.html)，`Color`整数的格式为 0xffRRGGBB。（ff 实际上是一个 alpha 通道，即不透明度，但通常是不透明的，因此是 ff）。

有许多站点可以让您输入这些值以查看颜色 - 例如[http://www.colourchart.net/](http://www.colourchart.net/)。您可以选择每个颜色分量的外部边界。

您也可以考虑使用`Color.colorToHSV()`which 将使您能够根据色调、饱和度和亮度而不是红色、绿色和蓝色来指定边界 - 这在您的上下文中可能在逻辑上更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:12:26.513

Basicall RGB 不适合比较颜色，但是有一个很好的颜色模型叫做 HSV。因此，您应该将 RGB 值转换为 HSV，然后将颜色的色调值与阈值进行比较。

例如，绿色的色调值为 120，但您可以接受 90 到 150 之间的值。

此链接显示如何在颜色模型之间进行转换：[http ://www.cs.rit.edu/~ncs/color/t_convert.html](http://www.cs.rit.edu/~ncs/color/t_convert.html)

有关 HSV 模型的更多信息：[http ://en.wikipedia.org/wiki/HSL_and_HSV](http://en.wikipedia.org/wiki/HSL_and_HSV)

# html - 在旁边添加图像 not on address bar

I am trying to add image next to my title, so not on address bar and I am using this:

```
<link rel="shortcut icon" href="images/title-icon.jpg" ty<="" h1="">

> ID：14790174
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2013-02-09T16:32:36.490
> 
>         
> 
> 标签：html, title

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2014-07-17T10:06:48.850

你可以制作一个 16x16 png 并使用`<link rel="shortcut icon" type="image/png" href="/favicon.png"/>`
favicon.png 是你的图标。实际上，要让你的 favicon 在所有浏览器中工作，你必须有超过 10 个正确大小和格式的图像。大多数浏览器会从站点的根目录中获取 favicon.ico，而无需告知；但他们并不总是立即用新的更新它。

但是，我通常会这样做：

`<link rel='shortcut icon' type='image/x-icon' href='/favicon.ico' />` 
```

# c# - 对 P/Invoke 使用固定指针的 ref insted

> ID：14790176
> 
> 赞同：0
> 
> 时间：2013-02-09T16:32:52.250
> 
> 标签：c#, c++, pointers, dll, unmanaged

我正在尝试为用 C++ 编写的非托管库编写一个包装器。该库的编码器给了我一个示例 C# 包装器，其中包括`DllImport`如下 s：

```
[DllImport(LibraryPath, CallingConvention = CallingConvention.Cdecl)]
internal static extern int doSomething(int inputArraySize, byte* inputArrayPointer, out int outputInteger, out int outputArraySize, out float* outputArrayPointer);

public static int DoSomething(byte[] inputArray, out int outputInteger, out float[] outputArray)
{
    int arraySize = inputArray.Length;

    int outputArraySize;
    float* outputArrayPointer;
    outputArray = null;

    fixed (byte* arrayPointer = inputArray)
    {
        int result = doSomething(arraySize, arrayPointer, out outputInteger, out outputArraySize, out outputArrayPointer);

        if (result == 0)
        {
            outputArray = new float[outputArraySize];

            for (int i = 0; i < outputArraySize; i++)
            {
                outputArray[i] = outputArrayPointer[i];
            }

            // This is another imported function.
            freePointer(outputArrayPointer);
        }
    }

    return result;
} 
```

他`fixed`在代码中使用，我想知道我们是否可以使用`ref`并丢失所有不安全的代码和指针。我可以将其重写为：

```
[DllImport(LibraryPath, CallingConvention = CallingConvention.Cdecl)]
internal static extern int doSomething(int arraySize, ref byte[] arrayPointer, out int someInteger, out int outputArraySize, out float[] someArrayPointer);

public static int DoSomething(byte[] inputArray, out int outputInteger, out float[] outputArray)
{
    int outputArraySize;

    int result = doSomething(inputArray.Length, ref inputArray, out outputInteger, out outputArraySize, out outputArray);

    return result;
} 
```

上面的代码在含义上是否与第一个带有指针的代码相同？

1.  可以使用我的版本吗？
2.  使用我的版本有什么缺点吗？
3.  当我使用`ref`时，传递给非托管库函数的数组在整个函数运行期间是否安全？
4.  你认为这个`freePointer()`函数有什么作用？无论如何，指针都会被垃圾收集器收集。为什么我们需要这样的功能？

我将不胜感激有关此事的任何建议。

**编辑：**我想我不能在没有一些额外代码的情况下将 C++ 指针作为 C# 数组。什么是最好的方法？有没有办法在不使用不安全代码和指针的情况下完成所有这些事情？

**编辑2：**我认为该`freePointer()`函数释放了非托管代码分配的数组。但是，它如何只使用指向它的指针来释放数组，而不将数组大小作为参数呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:36:48.203

您的代码（经过一些小的修改）将用于将指向数组的指针*从*托管代码*传递到*本机代码。它不会朝相反的方向工作，因为本机代码不知道如何分配托管数组 ( `float[]`)，因此您不能期望将其视为托管数组。

`float *`但是，您可以将其键入为返回一个，而不是传递一个原始返回`IntPtr`，并使用它[`Marshal.Copy`](http://msdn.microsoft.com/en-us/library/a53bd6cz.aspx)来提取数据。

将这些放在一起，新的 P/Invoke 签名和代码将如下所示：

```
[DllImport(...)]
internal static extern int doSomething(int arraySize, byte[] arrayPointer,
    out int outputInteger, out int outputArraySize,
    out IntPtr outputArrayPointer);

[DllImport(...)]
internal static extern void freePointer(IntPtr pointer);

public static int DoSomething(byte[] inputArray, out int outputInteger, out float[] outputArray)
{
    outputArray = null;
    int outputArraySize;
    IntPtr outputArrayPointer;

    int result = doSomething(inputArray.Length, inputArray, out outputInteger, out outputArraySize, out outputArrayPointer);

    if (result == 0)
    {
        outputArray = new float[outputArraySize];
        Marshal.Copy(outputArrayPointer, outputArray, 0, outputArraySize);

        freePointer(outputArrayPointer);
    }

    return result;
} 
```

当 P/Invoke 签名被写成采用数组时，编组层会自动将数组固定在内存中（因此它不能被释放或移动，从而可以安全地将其传递给本机代码），然后将指针传递给数组中的第一个元素到本机代码。相比之下，`ref inputArray`将指针传递给托管数组对象（这是内存中的不同位置）。

这些更改将让您`fixed (byte* arrayPointer`从调用代码中删除 ，并且您可以使用`IntPtr`原生代码将数据传回给您。因为本地代码分配了内存，.NET 垃圾收集器不知道如何释放它，所以`freePointer`在复制数据后调用非常重要。它将知道要释放多少数据，因为分配内存的分配例程将在某处存储已分配块的大小（通常在分配内存之前的头块中）；这意味着您不需要将数组大小传递给`freePointer`.

# asp.net - 为登录按钮创建 ASP.NET 窗口

> ID：14790177
> 
> 赞同：0
> 
> 时间：2013-02-09T16:32:52.197
> 
> 标签：asp.net, ajax

当您访问[http://4shared.com](http://4shared.com)并单击登录按钮时，它会在按钮下方显示一个小窗口，您可以填写该框。我是新手`asp.net`，我不知道我应该如何为我的网站做这个？它是一种`AJAX`技术吗？如果是，我应该如何将这种效果添加到我的网站？我能做到`Ajax Control Toolkit`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T16:50:03.013

您可以使用 jQuery。为初学者阅读这个很棒的教程。[http://www.w3schools.com/jquery/default.asp](http://www.w3schools.com/jquery/default.asp)
诀窍是`div`在单击时显示设置`display: none`为默认值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T16:48:42.703

有许多插件可以帮助您完成这项任务。例如，如果您使用的是 jQuery，您可能会查看 jQuery，[`jQuery UI dialog`](http://jqueryui.com/dialog/)这只是可用于实现此目的的众多插件之一。

在此特定示例中，AJAX 用于向服务器提交凭据并执行必要的验证。

# javascript - $.post 后无法识别的变量

> ID：14790180
> 
> 赞同：0
> 
> 时间：2013-02-09T16:33:09.577
> 
> 标签：javascript, jquery, post

当我尝试在 javascript 中调用变量时遇到问题。例如：

```
listItem = "Hello";
listItem +=" Everyone"; 
```

然后我这样做：

```
 $.post('example.php',{}, function(data){
          listItem += data;
    });
 alert(listItem); 
```

输出是：大家好，但我想与可变数据连接。我怎么能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T17:04:40.787

如果您使用此模式而不是回调，您将更有可能看到发生了什么：

```
$.post('example.php', {})
   .then(function(data)
   {
      //things inside this function execute after the post is done
      alert("Server has just replied to post.");
      listItem += data;
      alert(listItem);
   });
alert("Post was just sent."); 
```

您的弹出窗口将按以下顺序显示：

*   **[**帖子刚刚发送。**]**
*   **[**服务器刚刚回复了帖子。**]**
*   **[**内容`listItem` **]**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T16:35:19.410

jQuery[`$.post`](http://api.jquery.com/jQuery.post/)是异步的，因此在调用后立即调用警报`$.post`将打印出原始数组。

如果您想获取数据，请在成功函数中移动警报调用或以异步方式重构您的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T17:10:43.150

您的代码运行的顺序是这样的；

```
// 1.
listItem = "Hello";
listItem += " Everyone";

// 2.
alert(listItem);

// 3.
$.post('example.php', {}, /* your callback here */);

// 4\. wait for server to respond

// 5\. server responds

// 6\. your call back is run
listItem += data; 
```

# android - 如何在android中的上下文菜单中获取选定的项目名称

> ID：14790183
> 
> 赞同：2
> 
> 时间：2013-02-09T16:33:30.083
> 
> 标签：android

我在我的活动中使用 android 列表视图...

现在我需要获取从列表中选择的项目的名称......

这是我的菜单创建代码

```
public void onCreateContextMenu(ContextMenu menu, View v,ContextMenuInfo menuInfo) {
       super.onCreateContextMenu(menu, v, menuInfo);         

     MenuInflater inflater = getMenuInflater();
     inflater.inflate(R.menu.activity_main, menu); //select layout which should pop up in context menu

     menu.add("Delete");
     menu.add("Rename");

} 
```

我需要的是在以下函数中获取列表视图选定项目名称的方法，该函数捕获上下文菜单的点击。

```
@Override
public boolean onContextItemSelected(MenuItem item) 
{

     super.onContextItemSelected(item);

    if(item.getTitle()=="Delete"){
       //slected item's name in string varible here??
    }
    if(item.getTitle()=="Rename"){
            //slected item's name in string varible here??
    }
    return true;

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T16:39:08.297

获取 itemId 使用这个：

```
AdapterContextMenuInfo info = (AdapterContextMenuInfo) item.getMenuInfo(); 
```

您可以通过以下方式获取项目的 ID

```
info.id 
```

如果要接收名称，还可以使用 to`info.position`来获取项目在列表中的位置。有了position就可以从listView中获取item来获取item的名字

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-21T08:23:35.600

public boolean onContextItemSelected(MenuItem item) { AdapterView.AdapterContextMenuInfo itemInfo = (AdapterView.AdapterContextMenuInfo) item.getMenuInfo(); int itemId = itemInfo.position; // Implements our logic

```
 if (item.getTitle()=="Add") {
        Toast.makeText(this, "Item id [" + itemId + "]", Toast.LENGTH_SHORT).show();

    }
    return true;

} 
```

# algorithm - 四叉树——多级段树

> ID：14790184
> 
> 赞同：3
> 
> 时间：2013-02-09T16:33:43.093
> 
> 标签：algorithm, quadtree

我最近遇到了一种称为段树的新数据结构，然后读到它也可以扩展到二维，但我找不到一个好的来源来阅读它的实现细节和其他内容。我想从在编程竞赛中使用它的角度来了解它，而不是在图形领域。使用它可以解决的一些问题也很有用。有人可以指点我一个很好的来源来阅读它吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T15:20:04.383

将段树扩展到多个维度，尤其是在编程竞赛中可能会变得非常困难且耗时。

如果你需要多维度，你应该首先了解二叉索引树，然后尝试将它们扩展到多维度。

二叉索引树是一种数据结构，在某些情况下，它比分段树表现更好，而在其他情况下，它根本不适合。

使用分段树时，对多个维度的扩展是微不足道的。

在这里你可以找到[一篇关于它们的文章](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=binaryIndexedTrees)。

在这里您可以找到[一个可以帮助您测试您的实现的问题](http://acm.timus.ru/problem.aspx?num=1470)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T19:34:14.550

有一篇关于 1D 线段树及其代码示例的 2D 泛化的好文章。但它是俄语的，所以你可能只需要考虑代码示例 =)

[http://e-maxx.ru/algo/segment_tree](http://e-maxx.ru/algo/segment_tree)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T19:21:05.170

我不确定您是否会找到更多有关此的资源。我认为人们需要了解 k 维线段树的工作原理。在你的位置上，我会尝试解决一个可以用它来解决的问题。简单的例子（我知道这个查询可以通过一些预处理在 O(1) 中完成）：矩形范围总和。也就是说：给定一个充满数字的矩阵，回答询问子矩阵总和的查询。在这里，您可以使用一个 semgent 树来分割高度，然后在每个节点上为基于宽度的总和创建一个额外的段树。如果你能做到这一点，那么你就知道关于 2-dim 的一切。段树。下一个挑战是允许更新单个元素——这变得更快更难，因为你必须使用一些“艺术” 正确传播更改（想想段树内的某种类型的缓存）。:)

# jquery - 减慢jQuery可拖动拖动速度？

> ID：14790188
> 
> 赞同：0
> 
> 时间：2013-02-09T16:33:59.897
> 
> 标签：jquery, jquery-ui

无论如何，我可以减慢 div 的“拖动速度”吗？当我拖动当前的 div 时，由于某种原因垂直拖动它时，我得到了非常滞后的结果。

放慢速度可能会使它更流畅一些？

这是我的代码用于拖动：

```
 $('#myDiv').bind('mouseover', function () {
        $(this).draggable({});
    }); 
```

# sql - 如何存储和查询不同的数据

> ID：14790193
> 
> 赞同：1
> 
> 时间：2013-02-09T16:34:20.333
> 
> 标签：sql, storage

我需要知道存储以下数据的最佳做法是什么：

假设我有多个车库，每个车库都有不同类型的具有完全不同属性的车辆（例如飞机、坦克、轮船、自行车）。我需要查询一个车库中的所有车辆，包括它们的属性。

使用一个通用查询来存储和查询这些数据的好做法是什么？将所有车辆存储在一张表中，包含所有可能的属性？或者创建多个表，每个表对应一种特定类型的车辆？那么，如何查询一个车库的所有不同车辆，而不知道它们是哪种类型？

这样的事情甚至可以通过单个查询来实现吗？还是我必须创建多个查询才能获取数据？

我希望你明白我想要达到的目标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T16:59:09.077

这当然是可能的，但是在创建数据模型时需要进行一些规划。

正如您已经提到的，有不同的方法来实现子类型-超类型关系（又名继承）。

**1.) 一张桌子**

在这种情况下，我会像这样模拟您的问题：

```
Garage(GarageId_PK, Name)
Vehicle(VehicleId_PK, LicenceNr, GarageId_FK, SomethingOnlyCarsHave, SoemthingOnlyMortorbikesHave, Type) 
```

对于类型，您可以提供 ID 并有一个单独的表，您可以在其中将 ID 与名称相关联，或者只是在那里写下名称（不是一个非常干净的解决方案！）。顺便说一句：如果您想要多重继承（我猜您不需要车辆），您也可以将 Type 设置为位掩码。

我个人不是很喜欢这种方法，但是这样做是可以的。Oracle ie 在他们的学习资料中建议了这一点。对于您的一个查询问题，它也是更简单的解决方案：

```
SELECT *
FROM Vehicle v
INNER JOIN Type t ON (v.Type = t.TypeId)
WHERE GarageId = 42 
```

**2.) 每个子类型的表**

对我来说，这感觉像是更干净的解决方案，因为您的 NULL 值较少，但您需要更多的工作才能在一个查询中获取所有内容。

```
Garage(GarageId_PK, Name)
Vehicle(VehicleId_PK, LicenceNr, GarageId_FK)
Car(VechicleId_PK_FK, SomethingOnlyCarsHave)
Motorbike(VechicleId_PK_FK SoemthingOnlyMortorbikesHave) 
```

这在理论上允许多重继承，您应该编写一个只允许子类型的触发器。

本例中的 SQL：

```
SELECT *
FROM Vehicles v
     LEFT JOIN Car c ON(v.VehicleId = c.VehicleId)
     LEFT JOIN Motorbike m ON (v.VehicleId = m.VehicleId)
WHERE GarageId = 42 
```

或者，如果您有更多类型，您可以将丑陋的东西放入视图中：

```
CREATE OR REPLACE View v_allVehicles AS
(SELECT *
 FROM Vehicles v
      LEFT JOIN Car c ON(v.VehicleId = c.VehicleId)
      LEFT JOIN Motorbike m ON (v.VehicleId = m.VehicleId)

SELECT *
FROM v_allVehicles 
```

**编辑：**

关于符号的一句话：当我将 _PK 放在名称后面时，它指的是作为主键的列。_FK 到外键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:56:40.007

我会做这样的事情：

表车库——garageid，名字，其他东西

表车辆 - VehicleId，VehicleTypeId，其他东西

表 VehicleType – VehicleTypeId、类型、其他内容

表属性 – AttributeId、AttributeName、其他东西

表 VehicleAttribute – VehicleId、AttibuteId、Value、其他东西

表 VehicleGarage – VehicleId、GarageId、DateIn、DateOut、其他东西

查询以获取车库中的所有车辆和属性

```
select v.vehicleId
, vt.type
, a.attributename
, va.value
from VehicleGarage vg join Vehicle v on vg.VehicleId = v. VehicleId
join VehicleType vt on v.VehicleTypeId = vt.VehicleTypeId
join VehicleAttribute va on v.VehicleId = va.VehicleId
join Attribute a on va.AttributeId = a.AttributeId
where garageId = 1 
```

对于表格，其他内容可能是 CreatedWhen、CreatedBy 等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T16:55:50.893

你可以有一个看起来

```
vehicle_type(vehicle_type_id, description, PK(vehicle_type_id));
 (1, 'bike'; 2, 'plane', ..etc);

vehicle(vehicle_id, vehicle_type_id (FK to  vehicle_type),
 [common attributes], PK(vehicle_id), 
  UNIQUE(vehicle_id,vehicle_type_id ) 
);

bike(vehicle_id,vehicle_type_id , [bike attributes], 
  PK(vehicle_id,vehicle_type_id),
  FK(vehicle_id,vehicle_type_id ) to vehicle, 
  CHECK(vehicle_type_id=1));

plane(vehicle_id,vehicle_type_id , [plane attributes], 
PK (vehicle_id,vehicle_type_id),
  FK(vehicle_id,vehicle_type_id ) to vehicle,
  CHECK(vehicle_type_id=2) 
);

garage(garage_id, name, ..., PK (garage_id));

garage_vehicle(garage_id - FK to garage, 
 vehicle_id - FK to vehicle, PK(garage_id,vehicle_id)
); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T16:56:48.343

> 您可以存储所有可能的车库是一个单独的表车库。然后将所有可能组合的车辆存储在 Vehicles 表中。在车辆表中添加一个引用的外键列

```
create table vehicle(column1,column2...,garageid foreign key references garage) 
```

然后要选择单个车库中的所有车辆，可以查询车辆表

```
select * from vehicle where garage='garage_value' 
```

# phpstorm - 隐藏显示类函数的工具栏

> ID：14790196
> 
> 赞同：14
> 
> 时间：2013-02-09T16:34:32.017
> 
> 标签：phpstorm

是否可以隐藏此工具栏？

![工具栏](../Images/fd3e18fb5a44601018573e2a9524c66a.png)

另外，如何禁用显示“Typo：In world..”的弹出窗口？我讨厌这个，因为它显示在评论和括号中的单词中。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-09T17:01:27.860

可以在此处禁用工具栏：

![工具栏](../Images/c5a3a3b364f4abea7a90a187e4096bf5.png)

可以禁用错字检查或将其配置为忽略注释：

![在此处输入图像描述](../Images/b78d530e08faf33959a5816a2395c658.png)

# c# - 如何将多个控件组合在一起，以便通过方法访问它们？

> ID：14790199
> 
> 赞同：3
> 
> 时间：2013-02-09T16:35:05.133
> 
> 标签：c#, winforms, controls, containers, grouping

我的表单上有多组控件，它们在特定事件中一起更改……但是更改每次都相同，只有控件的名称不同。

所以我必须这样做：

```
label1.Text = "ready";
label2.Text = "let's go";
label1.ForeColor = System.Drawing.Color.Green;
label2.ForeColor = System.Drawing.Color.LightGreen
textbox1.Enabled = true;
textbox2.Enabled = true;
button1.Enabled = true;
button2.Enabled = true; 
```

或者

```
label1.Text = "not ready";
label2.Text = "just waiting to get ready";
label1.ForeColor = System.Drawing.Color.Red;
label2.ForeColor = System.Drawing.Color.Orange;
textbox1.Enabled = false;
textbox2.Enabled = false;
button1.Enabled = false;
button2.Enabled = false; 
```

在每个事件中，但对于 label3+label4 或 label5+label6 等。

所以我的想法是，如果可以将控件组放在容器之类的东西中，然后以容器为参数调用方法。

喜欢：

```
setReady(container);
setNotReady(container); 
```

然后这个方法会做我想做的所有事情。

所以我的问题是，这种方法看起来如何。如何以这种方式访问​​容器内的控件？或者有没有更好的方法来处理这样的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T16:37:10.597

将它们分组在一个`List< Control >`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-09T21:10:41.480

您可以尝试使用用户控件，然后访问用户控件控件

# c# - 在任何给定坐标中打印出一个字符串 c# 控制台应用程序

> ID：14790200
> 
> 赞同：-1
> 
> 时间：2013-02-09T16:35:04.590
> 
> 标签：c#, string, printing, console

我想创建一个程序，在控制台应用程序中使用任何前景色和背景色在任何给定坐标处打印出一个字符串。例如，如果字符串包含“Hello！” 我想要“你好！” 要在控制台中写出的文本，具体取决于我放置坐标的位置。这是我的代码：

```
class PrintString
{
    public int x, y; // Coordinates
    public string Text = "Hello!";
    ConsoleColor color;

    public PrintString(int x, int y, string Text)
    {
        Console.ForegroundColor = color;
        Console.SetCursorPostion(x, y);
        Console.Write(Text);
        Console.ResetColor();
    }

    public void Draw()
    {
        // Here I have no idea on how I should write the code for drawing the string?
    }
} 
```

当我运行此代码时，我得到：错误 4`System.Console`不包含`SetCursorPostion`

我的问题是，我错过了什么才能如我所愿？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:39:27.307

正如编译器所说：

没有办法`SetCursorPostion`。

这是一个错字：

利用`Console.SetCursorPosition(top,left);`

# javascript - y-scroll 上固定菜单的眨眼/眨眼问题

> ID：14790201
> 
> 赞同：0
> 
> 时间：2013-02-09T16:35:05.530
> 
> 标签：javascript, jquery, css, scroll, fixed

我希望右侧菜单的 div 元素适合标题菜单的底部，同时 y 滚动到底部，然后保持固定。并且当 y 滚动到顶部时，保持相对于他之前的元素。

这不容易解释，所以请看以下内容：[**fiddle**](http://jsfiddle.net/HmJbh/)

**HTML**

```
<div id="main">
    <div id="menu">Fixed Menu</div>
    <div id="container">
        <div id="content">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit....
        </div>
        <div id="right_menu">
            <div id="items">
                <!-- Variable number of items !-->
                &bull; Some items<br/>
                &bull; Some items<br/>
                &bull; Some items<br/>
                &bull; Some items 
            </div>
            <div id="fixed_items">
                <!-- Items to be fixed to top menu by scrolling !-->
                &bull; Fixed scroll items<br/>
                &bull; Fixed scroll items<br/>
                &bull; Fixed scroll items
                <input type="text" id="test"/>
            </div>
       </div>
    </div>
</div> 
```

**CSS**

```
#main {
    position:relative;
    height:2000px;
    overflow-y:scroll;
    background:#EDEDED;}
#menu {
    position:fixed;
    z-index:10;
    width:100%;
    line-height:40px;
    background:#555555;
    color:#EDEDED;
    padding-left:10px;}
#container {
    display:table;
    width:100%;
    margin-top:40px;}
#content {
    display:table-cell;
    padding:10px;
    text-align:justify;}
#right_menu {
    display:table-cell;
    width:200px;}
#items, #fixed_items {
    position:relative;
    z-index:9;
    width:160px;
    padding:10px;
    border-bottom:4px solid #555555;
    background:#CCCCCC;}
input {width:100px;} 
```

**JS**

```
$(document).ready(function(){
    $(window).scroll(function(){fix_items();});
});
function fix_items()
{
    var windowPos=$(window).scrollTop(),
        bloc=$('#fixed_items'),
        blocPos=bloc.position(),
        newPos=windowPos-blocPos.top+40;
    if(newPos>0)
        bloc.css({'position':'fixed','top':'40px'});        
    else if (newPos<=0)
        bloc.css({'position':'relative','top':'0px'});
    $('#test').val(blocPos.top+'/'+windowPos);
} 
```

在 bigining 中，我使用了一些`stop().animate({"come CSS"})`btw 缓动真的很烦人......而且`animate({'position':'fixed'})`似乎不起作用（用 chrome 测试）。

没有 ：

```
else if (newPos<=0)
        bloc.css({'position':'relative','top':'0px'}); 
```

它就像一个魅力，但`#fixed_item`不能再适合`#items.`我想问题就在这里，我找不到解决方案。

有什么想法可以在没有这种丑陋效果的情况下完成这项工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T01:56:59.857

最好测试前一个元素的位置，而不是固定滚动的元素（因为固定的元素位置似乎会跳跃......）。

使用以下内容，您将获得一次丑陋的效果：

```
function fix_items()
{
    var windowPos=$(window).scrollTop(),
        bloc=$('#fixed_items'),
        prev=$('#items'),
        prevPos=prev.position(),
        header=$('#menu'),
        newPos=windowPos - (prevPos.top + prev.height() - 16);
    if(newPos>=0)
        bloc.css({'position':'fixed','top':'40px'});        
    else if (newPos<0)
        bloc.css({'position':'relative','top':'0px'});
} 
```

[小提琴](http://jsfiddle.net/HmJbh/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:53:41.017

您需要为您的逻辑添加一个检查，以防止它在每次滚动时执行 css 更改。

```
$(document).ready(function(){
  $(window).scroll(function(){fix_items();});
});
function fix_items()
{
    var windowPos=$(window).scrollTop(),
        bloc=$('#fixed_items'),
        blocPos=bloc.position(),
        newPos=windowPos-blocPos.top+40,
        isFixed = false;
    if( !isFixed && newPos>0)
        bloc.css({'position':'fixed','top':'40px'});        
    else if (isFixed && newPos<=0)
        bloc.css({'position':'relative','top':'0px'});
    $('#test').val(blocPos.top+'/'+windowPos);
} 
```

# javascript - 简单的 iframe 问题

> ID：14790205
> 
> 赞同：0
> 
> 时间：2013-02-09T16:35:17.230
> 
> 标签：javascript, html

将表单提交到 iframe 后，我的页面不会重新加载（这就是我想要的），但它会向上滚动到顶部。我怎样才能防止这种情况？

```
<script type="text/javascript">
    function showThanksDiv(){
      document.getElementById("myThanksDiv").style.visibility = "visible";
    }
</script>

<form id="contacts-form" method="post" action="email.php" target="myiframe" >
<fieldset>
<div class="alignright"><a href="#" onClick="document.getElementById('contacts-form').submit()">Send Your Message!</a></div>
</fieldset>
</form>

<iframe  name="myiframe" id="myiframe" src="" width=1 height=1 style="visibility:hidden;position:absolute;bottom:2px;"></iframe>

<div id="myThanksDiv" style="width:200px;height:150px; border:1px solid black; background:#fff;display:block;padding:20px; visibility:hidden">
Thanks! <br />
Your message was sent. <br />
<div class="alignright"><a href="#!" onClick="javascript:hideThanksDiv()">Discard Message!</a></div>
              </div> 
```

在 email.php 中：

```
echo '<script type="text/javascript">parent.showThanksDiv();
</script>'; 
```

当我单击提交按钮时，我总是被重定向到页面顶部（未重新加载）。为什么？

基本上问题是 php 脚本的回声将调用 showThanksDiv 并滚动到顶部。我怎样才能防止这种情况？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:36:48.987

发生这种情况是因为

```
<a href="#" onClick="document.getElementById('contacts-form').submit();">Send Your Message!</a 
```

改成这个；**返回假；**

```
<a href="#" onClick="document.getElementById('contacts-form').submit();return false">Send Your Message!</a 
```

# php - Joomla文章中插入代码片段的一些问题

> ID：14790210
> 
> 赞同：0
> 
> 时间：2013-02-09T16:35:34.167
> 
> 标签：php, joomla, content-management-system, joomla2.5, geshi

我正在为我的技术博客使用 Joomla 2.5。在我的文章中，我使用预装的 Code Highlighter (GeSHi) 插件放置了一些代码片段。

因此，我通过以下方式插入代码片段：

我以 HTML 模式打开编辑器，并在其中输入以下代码：

```
<pre xml:java="" lines="true">/**
 * The HelloWorldApp class implements an application that
 * simply prints "Hello World!" to standard output.
 */
class HelloWorldApp {
    public static void main(String[] args) {
        System.out.println("Hello World!"); // Display the string.
    }
}
</pre> 
```

剪辑在我的文章中得到了很好的展示，你可以在这里看到（例如）： [http ://scorejava.com/index.php/spring-spring-mvc/corso-spring-core-framework/53-18-autowiring -春天的中间成本](http://scorejava.com/index.php/spring-spring-mvc/corso-spring-core-framework/53-18-autowiring-mediante-costruttore-in-spring)

问题是，如果我尝试复制和粘贴代码段内的代码（例如，如果我将其粘贴到记事本中），则会丢失缩进:-(

为什么？怎么了？

Tnx安德烈亚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T10:06:36.537

对我来说没问题！复制和粘贴，内容格式正确

# jquery - jQuery 添加年份到日期

> ID：14790211
> 
> 赞同：2
> 
> 时间：2013-02-09T16:35:39.303
> 
> 标签：jquery, date

我正在使用一个日期选择器，并且有一个开始日期、合同长度（年）和结束日期。这些都是输入字段。当开始日期与合同长度一起选择时，它应该计算结束日期。

因此，如果 startdate 是 01/02/2013 并且 contractlength 是 2（年）它应该计算 endate 是 31/01/2015。我已经创建了一些 jQuery 并且非常接近，但是在从输入中获取 contractlength 时无法正确计算 endate。

HTML

```
<label>Start Date:</label>
<input type='text' name='startdate' id='startdate' />

<label>Contract Length (Year):</label>
<input type='text' name='contractlength' id='contractlength' />

<label>End Date:</label>
<input type='text' name='EndDate' id='EndDate' /> 
```

jQuery

```
$(function() {
$( "#startdate, #EndDate" ).datepicker({
    defaultDate: "+1w",
    dateFormat: 'dd/mm/yy',
    changeMonth: true,
    numberOfMonths: 1,

    onSelect: function( selectedDate ) {
        if(this.id == 'startdate'){
            var ContractTerm = $('#contractlength').val();
            //var ContractTerm = 2;

            var dateMin = $('#startdate').datepicker("getDate");
            var rMax = new Date(dateMin.getFullYear() + ContractTerm, dateMin.getMonth(),dateMin.getDate() - 1); 
            $('#EndDate').val($.datepicker.formatDate('dd/mm/yy', new Date(rMax)));                    
        }
    }
}); 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T16:51:47.677

尝试这个...

```
$(function() {
$( "#startdate, #EndDate" ).datepicker({
    defaultDate: "+1w",
    dateFormat: 'dd/mm/yy',
    changeMonth: true,
    numberOfMonths: 1,

    onSelect: function( selectedDate ) {
        if(this.id == 'startdate'){
            var ContractTerm = $('#contractlength').val();
            //var ContractTerm = 2;

            var dateMin = $('#startdate').datepicker("getDate");
            var rMax = new Date(dateMin.getFullYear() + parseInt(ContractTerm), dateMin.getMonth(),dateMin.getDate() - 1); 
            $('#EndDate').val($.datepicker.formatDate('dd/mm/yy', new Date(rMax)));                    
        }
    }
});
}); 
```

请参阅[jSfiddle 示例](http://jsfiddle.net/zWfmW/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-18T07:35:28.147

```
var now = new Date();
        now.setFullYear(now.getFullYear() + 10);
        var futureYearLimit = now.getFullYear();

$( "#startdate, #EndDate" ).datepicker({
    defaultDate: "+1w",
    dateFormat: 'dd/mm/yy',
    changeMonth: true,
    numberOfMonths: 1,
    yearRange: "01/02/2013:" + futureYearLimit, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T16:47:07.600

问题是你正在连接字符串。`ContractTerm`是一个字符串，表示在文本框中输入的内容。您必须将其转换为数字：

```
var ContractTerm = +$('#contractlength').val(); 
```

# php - Heroku PHP应用程序无法写入雪松堆栈上的文件系统

> ID：14790217
> 
> 赞同：2
> 
> 时间：2013-02-09T16:35:59.113
> 
> 标签：php, cakephp, heroku

我有几个 Heroku CakePHP 应用程序在 cedar 堆栈上运行。当缓存引擎尝试写出文件时，我的应用程序在每次请求时都会出错。

> [2013 年 2 月 9 日星期六 05:56:51] [错误] [客户端 xxxx] PHP 致命错误：未捕获的异常 'CacheException' 带有消息'缓存引擎 _cake_core_ 未正确配置'。在 /app/www/lib/Cake/Cache/Cache.php:165
> 堆栈跟踪：
> #0 /app/www/lib/Cake/Cache/Cache.php(135): Cache::_buildEngine('_cake_core_')
> # 1 /app/www/app/Config/core.php(277): 缓存::config('_cake_core_', 数组)
> #2 /app/www/lib/Cake/Core/Configure.php(76): 包括( '/app/www/app/Co...')
> #3 /app/www/lib/Cake/bootstrap.php(163): 配置::bootstrap(true)
> #4 /app/www/app/webroot/ index.php(82): include('/app/www/lib/Ca...')
> #5 {main}
> 在第 165 行的 /app/www/lib/Cake/Cache/Cache.php 中抛出
> 
> 2013-02-09T05:56:51+00:00 app[web.1]: [Sat Feb 09 05:56:51 2013] [error] [client xxxx] PHP Warning: /app/www/app/tmp/ cache/persistent/ 在第 336 行的 /app/www/lib/Cake/Cache/Engine/FileEngine.php 中不可写
> 
> 2013-02-09T05:56:51+00:00 应用程序 [web.1]：[2013 年 2 月 9 日星期六 05:56:51] [错误] [客户端 xxxx] PHP 警告：_cake_core_ 缓存无法写入 'cake_dev_en-我们'到第 309 行的 /app/www/lib/Cake/Cache/Cache.php 中的文件缓存

我认为 cedar 堆栈上的 dynos 具有[可写的临时文件系统](https://devcenter.heroku.com/articles/dynos#ephemeral-filesystem)。为什么我得到不可写的错误，我能做些什么来修复它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T14:22:31.043

最好的办法是配置一个实际的缓存系统，比如 Memcahier 甚至 Redis。虽然您通常可以写入测功机，但您的空间有限，并且在重新启动时会丢失，并且如果您使用多个测功机会导致问题。

此特定实例可以通过 apache conf 中的限制或 buildpack 中的 dir 设置来解释。我确定并非所有目录都是可写的。如果你运行 'heroku run bash' 并在你的应用程序中获取一个 shell，该目录是否存在，它的权限是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T15:54:16.613

这个具体问题与 Heroku 无关。

CakePHP 的默认[gitignore 会](https://github.com/cakephp/cakephp/blob/master/.gitignore)忽略 tmp 目录。tmp 目录结构从未提交到我的新应用程序中，因此在部署到 Heroku 时不存在。

因此，当启动一个新的 CakePHP 应用程序时，请注意将 tmp 目录实际提交到您的存储库中。

# android - 文件复制动作android

> ID：14790218
> 
> 赞同：0
> 
> 时间：2013-02-09T16:35:58.083
> 
> 标签：android, file, copy, action, directory

我正在尝试使用此代码进行文件复制操作，但它给了我一个错误**语法错误，插入“}”以完成 ClassBody MainActivity**

*在我放** *的地方请帮帮我

`package com.AleXMan.taptaprevenge4songinstaller;`

`import java.io.File;` `import java.io.FileInputStream;` `import java.io.FileOutputStream;` `import java.io.IOException;` `import java.io.InputStream;` `import java.io.OutputStream;`

`import android.media.MediaCryptoException;` `import android.os.Bundle;` `import android.os.Environment;` `import android.app.Activity;` `import android.util.Log;` `import android.view.Menu;` `import android.view.View;` `import android.view.View.OnClickListener;` `import android.widget.Button;`

`public class MainActivity extends Activity {`

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

                Button button1 = (Button) findViewById(R.id.button1);
                button1.setOnClickListener(new OnClickListener() {

                    @Override
                    public void onClick(View v) {

                        File srcFolder = new File(Environment.getExternalStorageDirectory()+"/folder");
                        File destFolder = new File("/data/data/folder");

                        try{

                            if(!srcFolder.exists()){

                                    Log.e("Error","Folder does not exist");
                                   //just exit

                                }
                            else
                                {

                                    InputStream in = new FileInputStream(srcFolder);

                                    OutputStream out = new FileOutputStream(destFolder);

                                    // Copy the bits from instream to outstream
                                    byte[] buf = new byte[1024];
                                    int len;
                                    while ((len = in.read(buf)) > 0) {
                                        out.write(buf, 0, len);
                                    }
                                    in.close();
                                    out.close();

                                }

                            }

                        finally{

                                }

                    **}**);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
} 
```

`}`

如果您给我一个比我更好的代码，或者帮我解决这个错误，我将非常感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:43:15.933

更换你的线路 `**}**);`

和 `}});`

缩进所有代码是最佳实践。在 Eclipse 中，选择所有行 ( **CTRL+A** ) 然后**CTRL+SHIFT+F**所有代码都将清晰且缩进，因此很容易找出问题所在和问题所在。

# javascript - 如果禁用了javascript，如何避免显示该框？

> ID：14790220
> 
> 赞同：0
> 
> 时间：2013-02-09T16:36:09.367
> 
> 标签：javascript, css

我正在使用 javascript 来隐藏我网站上的框，然后当用户单击文本区域时，将显示此特定框。但是，如果用户出于某种原因正在离线查看我的网站或未启用 javascript，甚至有时页面加载速度很慢，则可以看到这些应该被 javascript 隐藏的框，我想知道我是否除非javascript调用，否则默认情况下可以使用css或其他东西隐藏框吗？

我对javascript真的很陌生，如果有人能告诉我我需要做什么，我将不胜感激。谢谢。

```
<script>
           $(function() {
            $(".search_prompt").hide();
            var focusin_flag = false,
                focusout_flag = false;
            $("#text").focusin(function() {
                if (!focusin_flag) {
                    $(".search_prompt").show();
                    focusin_flag = true;
                }
            }).focusout(function () {
                if (!focusout_flag ) {
                    $(".search_prompt").hide();
                    focusout_flag = true;
                } 
                function timeout_init() {
        setTimeout('search_prompt()', 2000);

                }

            });
        });  

        </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:43:29.537

我认为最好的方法是在禁用 JS 时将相同的类添加到要隐藏的所有框。

```
<div class="xyz"> ... </div> 
```

向你的 body 添加一个类，该类将通过 js 删除。

```
<body class="no-js"> ... </body>
<script>
    document.body.className = document.body.className.replace('no-js','');
</script> 
```

现在您可以扩展此方法以根据此条件进行尽可能多的样式更改。

```
.no-js .xyz {
    display: none;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T16:43:02.797

在您的 CSS 设置中`.search_prompt` **显示**为`none`

```
.search_prompt
{
    display:none;
} 
```

这样，默认情况下该框是隐藏的，如果启用了 javascript，您可以在需要时显示它。

# php - header('location:index.php') 在刷新页面 2 次后将我重定向到 index.php

> ID：14790236
> 
> 赞同：0
> 
> 时间：2013-02-09T16:38:18.143
> 
> 标签：php, session, redirect, header, unset

我有一个 php 页面（index.php），其中在验证用户名和密码后将设置一个会话（$_SESSION['expire']），该会话将在 30 分钟后过期并取消设置（按下登录按钮后 30 分钟）并将我们再次重定向到 index.php：

```
header('location:index.php'); 
```

验证后，将在索引页面中显示一个菜单，其中一项是 ContentManager.php。如下图通过点击此项我们将连接到db并进入contentmanager.php

```
switch($_REQUEST['action'])
{
case 'ContentManager' : 
include('model/content.php');
$contents = getContent($conn);
include('view/contentmanager.php');
break;
} 
```

在 ContentManger.php 我有：

```
<?php
//if the session is not unset and expired yet
    if ( isset($_SESSION['expire']) && ($now<= $_SESSION['expire']))
{   
?>
do sth...

<?php
}
else
{
//unset the session and redirect to index.php again
unset($_SESSION['expire']);
session_destroy(); 
header('location:../index.php');}
?> 
```

这很好用，但问题是经过 30 分钟后，我必须按两次“ContentManager”才能重定向到 index.php 如果我只是按一次它会显示一个空白页面。但是通过第二次刷新页面，它将再次重定向到登录页面（index.php）。

请帮我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-09T22:37:36.730

检查标题包含之前的间距。重定向时可能会导致错误。另一种解决方案是检查**输出缓冲** 是否将输出缓冲设置为**off 或 on**。要检查这个到你的服务器 php.ini 文件并检查**输出缓冲**。如果它关闭然后设置它，如果你没有多余的编辑 php.ini 文件你也可以在这个输入以下代码 `<?php ob_start();?>` 你必须写这个每个页面的代码并关闭**输出缓冲** 类型`<?php ob_end_flush();?>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T16:47:03.997

这是因为您在标题之前输出文本（可能是空行）。在您发布的示例中，它将在 ?> 和

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-07-14T13:52:30.140

我认为这将解决：

```
<?php
//if the session is not unset and expired yet
    if ( isset($_SESSION['expire']) && ($now<= $_SESSION['expire'])):
?>
do sth...

<?php
else {
//unset the session and redirect to index.php again
unset($_SESSION['expire']);
session_destroy(); 
header('location:../index.php');}

endif
?> 
```

# scheme - 方案扩展过程调用

> ID：14790241
> 
> 赞同：3
> 
> 时间：2013-02-09T16:38:59.730
> 
> 标签：scheme

给定一个函数，例如斐波那契递归的树递归实现，我如何显示评估表达式的每个步骤，例如`(fib 5)`？

```
(define (fib n)
  (cond ((= n 0) 0)
        ((= n 1) 1)
        (else (+ (fib (- n 1)
                 (fib (- n 2)))))) 
```

例如，我想输出：

```
(fib 5)

(+ (fib 4) (fib 3))

(+ (+ (fib 3) (fib 2)) (+ (fib 2) (fib 1)))

(+ (+ (+ (+ (fib 1) 0) (fib 1) (+ (fib 1) 0)) (+ (+ (fib 1) 0) (fib 1)))

(+ (+ (+ (+ 1 0) 1 (+ 1 0)) (+ (+ 1 0) 1)) 
```

我知道使用 quasiquoting，您可以部分评估表达式，如：

```
`(+ ,(* 3 4) (- 0.1 2))   ; evaluates to -┐
(+ 12 (- 0.1 2))          ;          <----┘ 
```

但是，我无法使用它来展示评估中的每个步骤。我知道我可以修改像 Peter Norvig 的[lis.py](http://norvig.com/lispy.html)这样的方案解释器，但我想要一种在语言本身内完成的方法。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T16:42:18.153

你的意思是，像这样？

```
(define (fib n)
  (cond ((= n 0) 0)
        ((= n 1) 1)
        (else `(+ ,(fib (- n 1))
                  ,(fib (- n 2)))))) 
```

例如：

```
(fib 5)
=> '(+ (+ (+ (+ 1 0) 1) (+ 1 0)) (+ (+ 1 0) 1)) 
```

当然，上面只会返回评估的*最终*结果。使用像 Racket 中的内置步进器，您可以看到每个中间步骤。有关如何查看此[答案](https://stackoverflow.com/a/14657535/201359)的一些方法，它也恰好显示了斐波那契函数。

# android - 以用户身份发布到 facebook 群组 - 不是作为群组？

> ID：14790242
> 
> 赞同：0
> 
> 时间：2013-02-09T16:38:59.870
> 
> 标签：android, facebook

我可以在消息 på 上将群组墙作为群组发布（具有权限 publish_actions、publish_stream 和 manage_pages），但我不知道如何以我的个人用户身份进行发布。我的目标是让每个喜欢该组的人都可以使用该应用在该组上发帖。

怎么做？- 似乎找不到任何关于它的东西..

使用 facebook api 3.0 发布的代码：

```
Request request = new Request(Session.getActiveSession(), "group-id/feed", postParams, HttpMethod.POST, callback); 
```

# java - Mockito：验证（模拟）问题

> ID：14790252
> 
> 赞同：6
> 
> 时间：2013-02-09T16:39:56.380
> 
> 标签：java, spring, hibernate, mocking, mockito

试图解决这个问题真的很难有谁能帮助我吗？

我显然在做一些根本错误的事情，我试图验证每个 Mock 对象，但它似乎不起作用。

```
 org.mockito.exceptions.misusing.UnfinishedVerificationException: 
 Missing method call for verify(mock) here:
 -> at     com.muuves.reservosity.service.TestProductServiceImpl.search_OneHourSlot_TwoBookingAvailable(TestProductServiceImpl.java:86)

 Example of correct verification:
verify(mock).doSomething()

Also, this error might show up because you verify either of: final/private/equals()  /hashCode() methods.
Those methods *cannot* be stubbed/verified.

at com.muuves.reservosity.service.TestProductServiceImpl.setUp(TestProductServiceImpl.java:41)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

这是我的测试

```
import static org.mockito.Mockito.verify;
import static org.mockito.Mockito.when;

import java.util.ArrayList;
import java.util.List;

import javax.persistence.EntityManager;
import javax.persistence.TypedQuery;
import javax.persistence.criteria.CriteriaBuilder;
import javax.persistence.criteria.CriteriaQuery;
import javax.persistence.criteria.Root;

import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;

public class TestProductServiceImpl {    
    ProductServiceImpl instance;
    @Mock
    EntityManager em;
    @Mock
    CriteriaBuilder builder;
    @Mock 
    CriteriaQuery<Product_Details> c;
    @Mock
    Root<Product_Details> productRoot;
    @Mock
    TypedQuery<Product_Details> typedQuery;

    @Before
    public void setUp() {
        MockitoAnnotations.initMocks(this); 
        instance = new  ProductServiceImpl();
        instance.setEm(em);
        instance.setCriteriaBuilder(builder);
        instance.setQuery(c);
        instance.setProductRoot(productRoot);
        instance.setTypedQuery(typedQuery);
    }

    @Test
    public void search_OneHourSlot_NoBookingAvailable() {
        List<Product_Details> products = booking(60);
        when(em.getCriteriaBuilder()).thenReturn(builder);
        when(builder.createQuery(Product_Details.class)).thenReturn(c);
        when(c.from(Product_Details.class)).thenReturn(productRoot);
        when(em.createQuery(c)).thenReturn(typedQuery);
        when(typedQuery.getResultList()).thenReturn(products);
        Search search = new Search();
        search.setDate("2013-02-09");
        search.setLocation("Cork");
        search.setPrice("20");
        search.setTime("14:00-15:00");
        search.setType("Football");
        List<Search_Result> result = instance.search(search);
        Assert.assertEquals(0, result.size());
    }
    @Test
    public void search_OneHourSlot_TwoBookingAvailable() {
        List<Product_Details> products = booking(60);
        when(em.getCriteriaBuilder()).thenReturn(builder);
        when(builder.createQuery(Product_Details.class)).thenReturn(c);
        when(c.from(Product_Details.class)).thenReturn(productRoot);
        when(em.createQuery(c)).thenReturn(typedQuery);
        when(typedQuery.getResultList()).thenReturn(products);
        Search search = new Search();
        search.setDate("2013-02-09");
        search.setLocation("Cork");
        search.setPrice("20");
        search.setTime("14:00-17:00");
        search.setType("Football");
        List<Search_Result> result = instance.search(search);
        Assert.assertEquals(1, result.size());
        Assert.assertEquals("2013-02-09 15:00", result.get(0).getTime());
        Assert.assertEquals("Google", result.get(0).getProductDetails().getProduct_Name());
    }

    @Test
    public void search_OneHourSlot_EndTimeAfterClosing() {
        List<Product_Details> products = booking(60);
        when(em.getCriteriaBuilder()).thenReturn(builder);
        when(builder.createQuery(Product_Details.class)).thenReturn(c);
        when(c.from(Product_Details.class)).thenReturn(productRoot);
        when(em.createQuery(c)).thenReturn(typedQuery);
        when(typedQuery.getResultList()).thenReturn(products);
        Search search = new Search();
        search.setDate("2013-02-09");
        search.setLocation("Cork");
        search.setPrice("20");
        search.setTime("14:00-20:00");
        search.setType("Football");
        List<Search_Result> result = instance.search(search);
        Assert.assertEquals(1, result.size());
        Assert.assertEquals("2013-02-09 15:00", result.get(0).getTime());
        Assert.assertEquals("Google", result.get(0).getProductDetails().getProduct_Name());
        verify(em);
    }

    @Test
    public void search__StartTimeBeforeOpening() {
        List<Product_Details> products = booking(60);
        when(em.getCriteriaBuilder()).thenReturn(builder);
        when(builder.createQuery(Product_Details.class)).thenReturn(c);
        when(c.from(Product_Details.class)).thenReturn(productRoot);
        when(em.createQuery(c)).thenReturn(typedQuery);
        when(typedQuery.getResultList()).thenReturn(products);
        Search search = new Search();
        search.setDate("2013-02-09");
        search.setLocation("Cork");
        search.setPrice("20");
        search.setTime("08:00-13:00");
        search.setType("Football");
        List<Search_Result> result = instance.search(search);
        Assert.assertEquals(3, result.size());
        Assert.assertEquals("2013-02-09 09:00", result.get(0).getTime());
        Assert.assertEquals("Google", result.get(0).getProductDetails().getProduct_Name());
        Assert.assertEquals("2013-02-09 10:00", result.get(1).getTime());
        Assert.assertEquals("Google", result.get(1).getProductDetails().getProduct_Name());
        Assert.assertEquals("2013-02-09 11:00", result.get(2).getTime());
        Assert.assertEquals("Google", result.get(2).getProductDetails().getProduct_Name());
    }
    @Test
    public void search__StartTimeAndEndTimeBeforeOpening() {
        List<Product_Details> products = booking(60);
        when(em.getCriteriaBuilder()).thenReturn(builder);
        when(builder.createQuery(Product_Details.class)).thenReturn(c);
        when(c.from(Product_Details.class)).thenReturn(productRoot);
        when(em.createQuery(c)).thenReturn(typedQuery);
        when(typedQuery.getResultList()).thenReturn(products);
        Search search = new Search();
        search.setDate("2013-02-09");
        search.setLocation("Cork");
        search.setPrice("20");
        search.setTime("06:00-09:00");
        search.setType("Football");
        List<Search_Result> result = instance.search(search);
        Assert.assertEquals(0, result.size());
    }
    @Test
    public void search__StartTimeAndEndTimeAfterClosing() {
        List<Product_Details> products = booking(60);
        when(em.getCriteriaBuilder()).thenReturn(builder);
        when(builder.createQuery(Product_Details.class)).thenReturn(c);
        when(c.from(Product_Details.class)).thenReturn(productRoot);
        when(em.createQuery(c)).thenReturn(typedQuery);
        when(typedQuery.getResultList()).thenReturn(products);
        Search search = new Search();
        search.setDate("2013-02-09");
        search.setLocation("Cork");
        search.setPrice("20");
        search.setTime("17:00-21:00");
        search.setType("Football");
        List<Search_Result> result = instance.search(search);
        Assert.assertEquals(0, result.size());
    }
    @Test
    public void search__StartTimeAndEndTimeExactlyOpeningClosing() {
        List<Product_Details> products = booking(60);
        when(em.getCriteriaBuilder()).thenReturn(builder);
        when(builder.createQuery(Product_Details.class)).thenReturn(c);
        when(c.from(Product_Details.class)).thenReturn(productRoot);
        when(em.createQuery(c)).thenReturn(typedQuery);
        when(typedQuery.getResultList()).thenReturn(products);
        Search search = new Search();
        search.setDate("2013-02-09");
        search.setLocation("Cork");
        search.setPrice("20");
        search.setTime("09:00-17:00");
        search.setType("Football");
        List<Search_Result> result = instance.search(search);
        Assert.assertEquals(5, result.size());
        Assert.assertEquals("2013-02-09 09:00", result.get(0).getTime());
        Assert.assertEquals("Google", result.get(0).getProductDetails().getProduct_Name());
        Assert.assertEquals("2013-02-09 10:00", result.get(1).getTime());
        Assert.assertEquals("Google", result.get(1).getProductDetails().getProduct_Name());
        Assert.assertEquals("2013-02-09 11:00", result.get(2).getTime());
        Assert.assertEquals("Google", result.get(2).getProductDetails().getProduct_Name());
        Assert.assertEquals("2013-02-09 13:00", result.get(3).getTime());
        Assert.assertEquals("Google", result.get(3).getProductDetails().getProduct_Name());
        Assert.assertEquals("2013-02-09 15:00", result.get(4).getTime());
        Assert.assertEquals("Google", result.get(4).getProductDetails().getProduct_Name());
    }
    private List<Product_Details> booking(int slot){
        List<Product_Details> products = new ArrayList<Product_Details>();
        Product_Details product = new Product_Details();
        product.setProduct_Name("Google");
        product.setSaturday_Open("09:00-17:00");
        product.setDates_Closed("2013-12-25");
        product.setTime_Per_Slot(slot);
        List<Booking_Details> bookings = new ArrayList<Booking_Details>();
        Booking_Details booking1 = new Booking_Details();
        booking1.setBooked_Date("2013-02-09 12:00");
        bookings.add(booking1);
        Booking_Details booking2 = new Booking_Details();
        booking2.setBooked_Date("2013-02-09 14:00");
        bookings.add(booking2);
        Booking_Details booking3 = new Booking_Details();
        booking3.setBooked_Date("2013-02-09 16:00");
        bookings.add(booking3);
        product.setBookings(bookings);
        products.add(product);
        return products;
    }
} 
```

如果有人可以帮助我，那就太好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T19:23:22.503

您试图以错误的方式使用 Mockito 框架的验证方法。它用于验证某些行为是否发生过一次。在您的测试中，您应该指定发生了什么行为（行为意味着方法调用）。

这是一个检查发送邮件的方法的测试示例：

```
@RunWith(MockitoJUnitRunner.class)
public class MailSenderTest {

    @Mock
    private JavaMailSender javaMailSender;

    @InjectMocks
    private MailSenderImpl mailSender;

    @Test
    public void testSendMail() {

        String from = "somemail@gmail.com";
        String to = "Danothermail@gmail.com";
        String title = "Test";
        String text = "Hello world!";

        SimpleMailMessage message = new SimpleMailMessage();
        message.setFrom(from);
        message.setTo(to);
        message.setSubject(title);
        message.setText(text);

        mailSender.sendMail(to, title, text);

        Mockito.verify(javaMailSender).send(message);
    }

} 
```

正如您在 verify(..) 之后从该示例中看到的那样，我指定了要检查的方法调用。换句话说，通过示例的最后一行，我检查了在执行 JavaMailSender 的服务方法 send(..) 的 sendMail(...) 方法期间是否使用正确的参数调用了该方法。

查看mockito官方页面。有很多简单有用的例子，描述得很好。[这是它的链接。](http://code.google.com/p/mockito/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T17:01:45.100

错误消息表明，您`verify(em)...;`在受影响的测试方法中缺少调用`search_OneHourSlot_TwoBookingAvailable()`。

我强烈建议重新格式化您的测试代码，至少将每个测试方法中的断言与测试代码分开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T12:15:28.210

将此添加到每个测试中并且可以正常工作，感谢 harpun 你真的在这里帮助了我

```
 verify(em).createQuery(c);
    verify(builder).createQuery(Product_Details.class);
    verify(c).from(Product_Details.class);
    verify(em).createQuery(c);
    verify(typedQuery).getResultList(); 
```

# r - 从字符串中提取字符

> ID：14790253
> 
> 赞同：6
> 
> 时间：2013-02-09T16:40:07.010
> 
> 标签：r

您将如何提取所有字符直到指定字符？例如，我想提取“。”之前的所有内容。（时期）：

```
a<-c("asdasd.sss","segssddfge.sss","se.sss") 
```

我想回来：

```
asdasd segssddfge se 
```

我试过：

```
substr(a,1,".") 
```

但它似乎不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-09T16:43:21.657

这是一个非常基本的方法：

```
sapply(strsplit(a, "\\."), `[[`, 1)
# [1] "asdasd"     "segssddfge" "se" 
```

还有一个：

```
sub(".sss", "", a, fixed = TRUE)
# [1] "asdasd"     "segssddfge" "se" 
## OR sub("(.*)\\..*", "\\1", a) 
## And possibly other variations 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-09T16:45:17.783

使用`sub`：

```
# match a "." (escape with "\" to search for "." as a normal "." 
# means "any character") followed by 0 to any amount of characters
# until the end of the string and replace with nothing ("")
sub("\\..*$", "", a) 
```

使用`subtr`and `gregexpr`（假设只有 1`.`并且向量内的所有字符串都有明确的匹配）。

```
# get the match position of a "." for every string in "a" (returns a list)
# unlist it and get the substring of each from 1 to match.position - 1
substr(a, 1, unlist(gregexpr("\\.", a)) - 1) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T17:00:33.093

这里尝试使用`gsub`

```
gsub(pattern='(.*)[.](.*)','\\1', c("asdasd.sss","segssddfge.sss","se.sss"))
[1] "asdasd"     "segssddfge" "se" 
```

# java - glassfish 3.1.2.2 JDBC 安全领域中的 CORBA.NO_PERMISSION

> ID：14790260
> 
> 赞同：2
> 
> 时间：2013-02-09T16:41:17.273
> 
> 标签：java, glassfish, jdbcrealm

请帮我解决这个问题......我做错了什么？

```
09.02.2013 19:44:16 com.sun.enterprise.v3.server.CommonClassLoaderServiceImpl findDerbyClient
INFO: Cannot find javadb client jar file, derby jdbc driver will not be available by default.
javax.naming.NamingException: Lookup failed for 'hello' in SerialContext[myEnv={java.naming.factory.initial=com.sun.enterprise.naming.impl.SerialInitContextFactory, java.naming.factory.url.pkgs=com.sun.enterprise.naming, java.naming.factory.state=com.sun.corba.ee.impl.presentation.rmi.JNDIStateFactoryImpl} [Root exception is javax.naming.NamingException: ejb ref resolution error for remote business interfacemain.HelloRemote [Root exception is java.rmi.AccessException: CORBA NO_PERMISSION 0 No; nested exception is: 
    org.omg.CORBA.NO_PERMISSION: ----------BEGIN server-side stack trace----------
org.omg.CORBA.NO_PERMISSION:   vmcid: 0x0  minor code: 0  completed: No 
```

CreateJDBCRealmUser 类在 DB oracle 10g XE 中创建用户

```
package main;
import java.security.MessageDigest;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;

public class CreateJDBCRealmUser {
    private static final String driver = "oracle.jdbc.driver.OracleDriver";
    private static final String jdbcUrl = "jdbc:oracle:thin:@127.0.0.1:1521/XE";
    private static final String userSql = "insert into users values(?, ?)";
    private static final String groupSql = "insert into groups values(?, ?)";

    private static final char[] HEXADECIMAL = { '0', '1', '2', '3',
        '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };

    private static String hashPassword(String password) throws Exception {
        MessageDigest md = MessageDigest.getInstance("MD5");
        md.reset();

        byte[] bytes = md.digest(password.getBytes());
        StringBuilder sb = new StringBuilder(2 * bytes.length);
        for (int i = 0; i < bytes.length; i++) {
            int low = (int)(bytes[i] & 0x0f);
            int high = (int)((bytes[i] & 0xf0) >> 4);
            sb.append(HEXADECIMAL[high]);
            sb.append(HEXADECIMAL[low]);
        }
        return sb.toString();
    }

    public static void main(String args[]) throws Exception {
        String dbUser = "dbuser";
        String dbPassword = "dbpass";
        String user = "admin";
        String password = "admin";
        String group = "admin";

        Class.forName(driver);
        String hPassword = hashPassword(password);
        Connection conn = DriverManager.getConnection(
            jdbcUrl, dbUser, dbPassword);
        PreparedStatement userStmt = conn.prepareStatement(userSql);
        userStmt.setString(1, user);
        userStmt.setString(2, hPassword);
        userStmt.executeUpdate();
        userStmt.close();

        PreparedStatement groupStmt = conn.prepareStatement(groupSql);
        groupStmt.setString(1, user);
        groupStmt.setString(2, group);
        groupStmt.executeUpdate();
        groupStmt.close();

        conn.close();
    }
} 
```

HelloClient - 它是一个 JAVA 应用程序客户端

```
package main;
import java.util.Properties;
import javax.naming.InitialContext;
import javax.naming.NamingException;
import com.sun.appserv.security.ProgrammaticLogin;

public class HelloClient {

    /**
     * @param args
     */
    public static void main(String[] args) {
        try
        {
        InitialContext ic = null;
        Properties props = new Properties();
        props.setProperty("java.naming.factory.initial","com.sun.enterprise.naming.SerialInitContextFactory");
        props.setProperty("org.omg.CORBA.ORBInitialHost", "127.0.0.1");
        props.setProperty("org.omg.CORBA.ORBInitialPort", "3700");

        System.setProperty("java.security.auth.login.config", "./auth.conf"); 
        ProgrammaticLogin pl = new ProgrammaticLogin();
        String spass = new String("admin");
        char pass[] = new char[spass.length()];
        pass = spass.toCharArray();
        pl.login("admin", pass);

        try {
            ic = new InitialContext();
        } catch (NamingException e1) {
            e1.printStackTrace();
        }

        Object obj = ic.lookup("hello");
        HelloRemote hello = (HelloRemote)obj;
        /*
        Call a business method, propagating the security context
        */
        String result;
        try {
        result = hello.hello();
        result = hello.helloNoPermit();
        }
        catch (javax.ejb.EJBException e) {
        result = e.getCausedByException().getMessage();
        }
        /* Print the return result from the business logic */
        System.out.println(result);
        }
        catch (Exception e)
        {
        e.printStackTrace();
        }
    }
} 
```

HelloRemote - 客户端到 EJB 的远程接口，服务器端存在相同的远程接口/

```
package main;
import javax.ejb.Remote;
@Remote
public interface HelloRemote {
    String helloNoPermit();
    String hello();
} 
```

你好 - 它是一个实现 HelloRemote

```
package main;

import javax.annotation.Resource;
import javax.annotation.security.DeclareRoles;
import javax.annotation.security.RolesAllowed;
import javax.ejb.SessionContext;
import javax.ejb.Singleton;
/**
 * Session Bean implementation class Hello
 */
@Singleton(mappedName = "hello")
@DeclareRoles("admin")
public class Hello implements HelloRemote {

    @Resource 
    private SessionContext context;

    public Hello() {

    }

    @RolesAllowed("admin")
    public String helloNoPermit(){

        String name = context.getCallerPrincipal().getName();
        System.out.println(name);
        return name;

    }

    public String hello(){
        String name = context.getCallerPrincipal().getName();
        System.out.println(name);
        return name;
    }
} 
```

auth.conf - 配置文件

```
default {
com.sun.enterprise.security.auth.login.ClientPasswordLoginModule required debug=false;
}; 
```

SQL DDL

```
create table USERS
(
  USER_NAME VARCHAR2(4000),
  USER_PASS VARCHAR2(4000)
)

create table GROUPS
(
  GROUP_NAME VARCHAR2(4000),
  USER_NAME  VARCHAR2(4000)
) 
```

最后是 GF 3.1.2.2 JDBC REALM 配置

```
Security Manager: V
Audit Logging:    V
Default Realm secureRealm:
Default Principal:
Default Principal Password:
JACC: default
Audit Modules: default
Default Principal To Role Mapping: V
Mapped Principal Class: 

Realm Name:secureRealm
Class Name: com.sun.enterprise.security.auth.realm.jdbc.JDBCRealm
JAAS Context: secureRealm
JNDI: jdbc/secure
User Table:USERS
User Name Column:USER_NAME
Password Column:USER_PASS
Group Table:GROUPS
Group Table User Name Column:USER_NAME
Group Name Column:GROUP_NAME
Assign Groups:admin
Database User:
Database Password:
Digest Algorithm:MD5
Password Encryption Algorithm:MD5
Encoding: 
Charset: 
```

sun-ejb-jar.xml

```
<sun-ejb-jar>
 <security-role-mapping>
        <role-name>admin</role-name>
        <group-name>admin</group-name>
    </security-role-mapping>
    <enterprise-beans />
</sun-ejb-jar> 
```

# c++ - 重载流提取运算符

> ID：14790263
> 
> 赞同：0
> 
> 时间：2013-02-09T16:41:46.730
> 
> 标签：c++, operator-overloading, cin

我试图输入一个复数并使用重载运算符来处理实部和虚部的解析。如果我输入一个数字`1 + 2i`，我想要`real = 1`和`imaginary = 2`。

现在如果我输入`1 + 2i`回车，输出是`1 + 0i`. 我怎样才能正确地做到这一点（号码有私人数据成员`real`，`imaginary`并且`operator>>`是一个朋友功能）

```
//input the form of 1 + 2i
istream & operator>>(istream &in, Number &value)
{    
    in >> std::setw(1) >> value.real;
    in.ignore(3); //skip 'space' and '+' and 'space'
    in >> std::setw(1) >> value.imaginary;
    in.ignore(); //skip 'i'

    return in;
}

//output in the for 1 + 2i
ostream &
operator<<(ostream &out, const Complex &value)
{
    out << value.real << " + " << value.imaginary << "i" <<std::endl;

    return out;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T16:52:48.123

您的代码在我的编译器上运行良好！也许问题出在其他地方（例如在输出中）？

请注意，`std::setw`从输入流中提取数字时没有效果。

请记住，您可能还需要考虑以下形式的情况：`A - Bi`并且可能如果用户决定在运算符或`i`. 但是对于简单的情况，`A + Bi`您的原型应该不是问题。

# iphone - 使用音频播放器绑定图像视图和文本视图的索引

> ID：14790264
> 
> 赞同：1
> 
> 时间：2013-02-09T16:41:47.087
> 
> 标签：iphone, objective-c, ios6, xcode4.5

我想将图像视图和文本视图的索引与音频播放器绑定。因此，当音频播放器暂停时，图像视图和文本视图的更新也应该暂停，当音频播放器恢复时，图像视图和文本视图的更新也应该恢复。

```
- (void)updateText:(NSTimer *)theTimer
{
if (index < [myArray count])
{
    self.textView.text = [self.myArray objectAtIndex:index];
    self.imageView.image = [self.imagesArray objectAtIndex:index];
    index++;
}
else {
    index = 0;
}

   } 
```

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T16:57:43.020

```
UIImageView* imageView;   //the view that gets updated

int current_selected_image_index = 0;
float time_for_next_image = 0.0;

AVAudioPlayer* audioPlayer;

NSArray* image_times;   //an array of float values representing each 
                    //time when the view should update

NSArray* image_names;   //an array of the image file names 

-(void)update_view
 {
UIImage* next_image_to_play = [image_names objectAtIndex:current_selected_image_index];
imageView.image = next_image_to_play;
 }

-(void)bind_view_to_audioplayer
 {
while(audioPlayer.isPlaying)
{
    float currentPlayingTime = (float)audioPlayer.currentTime;
    if(currentPlayingTime >= time_for_next_image)
    {
        current_selected_image_index++;
        [self performSelectorOnMainThread:@selector(update_view) withObject:nil waitUntilDone:NO];
        time_for_next_image = [image_times objectAtIndex:[current_selected_image_index+1)];
    }
    [NSThread sleep:0.2];
}
 }

-(void)init_audio
{
current_selected_image_index = 0;
time_for_next_image = [image_times objectAtIndex:1];
} 

-(void)play_audio
{
[audioPlayer play];
[self performSelectorInBackground:@selector(bind_view_to_audioplayer) withObject:nil];
}

-(void)pause_audio
{
[audioPlayer pause];
//that's all, the background thread exits because audioPlayer.isPlaying == NO
//the value of current_selected_image_index stays where it is, so [self play_audio] picks up 
//where it left off.
 } 
```

此外，将 self 添加为 audioPlayerDidFinishPlaying:successfully: 的观察者，以便在音频播放器完成播放时重置。

希望它可以帮助你。

# windows - 使用 AutoIT 向命令提示符回显消息？

> ID：14790266
> 
> 赞同：3
> 
> 时间：2013-02-09T16:42:02.313
> 
> 标签：windows, cmd, autoit

如何使用 AutoIT 将变量的内容回显到命令提示符？我要做的就是在命令提示符下显示一条消息。

```
Run("C:\WINDOWS\system32\cmd.exe")
WinWaitActive("C:\WINDOWS\system32\cmd.exe")
$message = 'Type: "edit file_name.ext" to create or edit a file'
send("$message {ENTER}") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:46:09.930

您需要将变量放在引号之前，然后对其进行评估：

```
send($message & "{ENTER}") 
```

# android - android中的网络提供商？

> ID：14790269
> 
> 赞同：1
> 
> 时间：2013-02-09T16:42:11.863
> 
> 标签：android, location

我在我的应用程序中处理 getlocation。我在想 3 种获取位置的方法。GPS，（3g，wifi）和手机信号塔 trangulation。但我在 android.Network 和 GPS 提供商中看到 2 个提供商。我的问题是网络提供商获取数据（ 3g，wifi）和手机信号塔我想。它怎么能做到这一点？例如，如果我连接 3g，首选 3g 或手机信号塔。而且我没有任何互联网连接，我可以获取当前位置吗？或者获取缓存数据（最后一个位置）？

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T12:53:13.873

你是对的，有 3 种方法可以获取 GPS、3G（手机信号塔）和 wifi 的位置，网络提供商获取 3G 和 wifi 的位置（有时它比 GPS 更准确），它会听一个目前已连接，但如果两者都启用，则手机会优先使用 wifi。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:21:19.477

> 如果我连接 3g 什么是首选 3g 或手机信号塔

为什么你认为 3G 不使用手机信号塔？通过网络提供商，您将获得来自手机信号塔和 wifi 的位置

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-23T11:08:31.043

根据我的经验，网络提供商的质量可能会有很大差异。

如前所述，网络提供商使用 WiFi 和蜂窝塔信息的组合来提供位置信息。

如果您碰巧靠近 Wifi 网络，这在城市化地区很常见，但不是在城市以外，您通常会获得非常好的准确性。

但是，在 Wifi 的范围之外，您将受制于手机信号塔。在这里，精度取决于手机信号塔的质量和功能，以及可用于对您的位置进行三角测量的手机信号塔的数量。

在这些情况下，质量可能会有很大差异，不仅在不同地点之间，而且还取决于您使用的运营商。

我的应用程序在瑞典运行，在我们国家的某些地区，运营商可能在非常大的区域内只有一个塔。在这些情况下，所有经纬度定位都直接在塔上，精度甚至高达 20.000 - 30.000 米。

# ruby - Rake 10.0.3 在 RVM 中运行错误版本的 Ruby

> ID：14790272
> 
> 赞同：1
> 
> 时间：2013-02-09T16:42:45.200
> 
> 标签：ruby, rspec, rake, rvm

我`bundle update rails`今天在一个基于 RVM 的应用程序上运行，并在此过程中将 Rake 更新为 10.0.3。现在我不能再运行`rake spec`了，因为它试图使用系统 Ruby 而不是正确的 RVM Ruby。

这是输出：

```
$ bundle exec rake spec -b
/usr/local/lib/ruby -S rspec ./spec/controllers/articles_controller_spec.rb ...
rake aborted!
/usr/local/lib/ruby -S rspec ./spec/controllers/articles_controller_spec.rb ...
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rspec-core-2.12.2/lib/rspec/core/rake_task.rb:156:in `run_task'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rspec-core-2.12.2/lib/rspec/core/rake_task.rb:124:in `initialize'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/file_utils_ext.rb:61:in `verbose'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rspec-core-2.12.2/lib/rspec/core/rake_task.rb:122:in `send'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rspec-core-2.12.2/lib/rspec/core/rake_task.rb:122:in `initialize'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/task.rb:228:in `call'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/task.rb:228:in `execute'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/task.rb:223:in `each'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/task.rb:223:in `execute'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/task.rb:166:in `invoke_with_call_chain'
/Users/brandan/.rvm/rubies/ruby-1.8.7-p174/lib/ruby/1.8/monitor.rb:242:in `synchronize'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/task.rb:159:in `invoke_with_call_chain'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/task.rb:152:in `invoke'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/application.rb:143:in `invoke_task'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/application.rb:101:in `top_level'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/application.rb:101:in `each'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/application.rb:101:in `top_level'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/application.rb:110:in `run_with_threads'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/application.rb:95:in `top_level'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/application.rb:73:in `run'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/application.rb:160:in `standard_exception_handling'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/lib/rake/application.rb:70:in `run'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/gems/rake-10.0.3/bin/rake:33
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/bin/rake:19:in `load'
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/bin/rake:19
Tasks: TOP => spec 
```

请注意，RSpec 正在尝试使用外壳`/usr/local/lib/ruby`而不是 RVM 安装的 Ruby 的正确路径。如果我只是从命令行运行`rspec`，一切都会通过：

```
$ bundle exec rspec
.....................................

Finished in 1.81 seconds
37 examples, 0 failures 
```

我降级到 Rake 10.0.2 并没有遇到这个问题，我可以在本地机器上类似 Ruby 版本的其他应用程序中使用 Rake 10.0.3 复制它。

问题似乎`Rake::TaskLib::RUBY`是定义不正确：

```
$ bundle exec ruby -e 'require "rake/tasklib"; puts Rake::TaskLib::RUBY'
/usr/local/lib/ruby 
```

知道我的环境有什么问题吗？

```
OS X 10.8.2
RVM 1.18.5 
```

* * *

**编辑：**更多环境：

```
$ echo $PATH
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/bin:/Users/brandan/.rvm/gems/ruby-1.8.7-p174@global/bin:/Users/brandan/.rvm/rubies/ruby-1.8.7-p174/bin:/Users/brandan/.rvm/bin:/usr/local/heroku/bin:/Users/brandan/bin:.gem/ruby/1.8/bin:/usr/local/git/bin:/usr/local/mysql/bin:/usr/local/pear/bin:/usr/local/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin
$ which -a ruby
/Users/brandan/.rvm/rubies/ruby-1.8.7-p174/bin/ruby
/usr/bin/ruby
$ which -a bundle
/Users/brandan/.rvm/gems/ruby-1.8.7-p174@bcl/bin/bundle
/Users/brandan/.rvm/bin/bundle
/usr/bin/bundle
$ head -n 1 $(which bundle)
#!/Users/brandan/.rvm/rubies/ruby-1.8.7-p174/bin/ruby 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T00:45:58.623

看起来您可能会受到此更改的影响[https://github.com/jimweirich/rake/commit/968682759b3b65e42748cd2befb2ff3e982272d9#L0R9](https://github.com/jimweirich/rake/commit/968682759b3b65e42748cd2befb2ff3e982272d9#L0R9)

确保取消设置变量：

```
unset RUBY 
```

# html-agility-pack - 在匿名类型中选择第 n 个值

> ID：14790273
> 
> 赞同：1
> 
> 时间：2013-02-09T16:42:58.943
> 
> 标签：html-agility-pack, linq-to-objects, anonymous-types

在针对 HtmlDocument (HTMLAgilityPack) 的实例运行 XPATH 表达式后，我有一组 HTML 项。

返回的集合是：

### 

{h3} 标签应该是我类型中项目的名称，{div} 应该是内容，但我似乎无法弄清楚如何将这些人组合在一起？

我的匿名类型：

```
var nodes = xhtml.DocumentNode.SelectNodes("//div[@id='membInfo']/h3 | //div[@id='membInfo']/div");

(from node in nodes
 select new 
 {
    Name = node[j],
    Content = node[j + 1]
 }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T07:03:06.633

您可以执行以下操作：

```
var nodes = xhtml.DocumentNode.SelectNodes("//div[@id='membInfo']");

(from node in nodes
 select new 
 {
    Name = node.SelectSingleNode("./h3"),
    Content = node.SelectSingleNode("./div")
 }); 
```

上面的代码 LINQ 代码会给你一个匿名类型，其中`Name`和`Content`都是 type `HtmlNode`。您可能需要查看 properties `Innertext`、`OuterHtml`等，具体取决于您接下来要执行的操作。

# recursion - 语言的递归定义

> ID：14790279
> 
> 赞同：1
> 
> 时间：2013-02-09T16:43:39.970
> 
> 标签：recursion, computer-science, computer-science-theory

假设我有一种只由平衡括号组成的语言，即 {ε, ( ), ( ( ) ), ( ) ( ), ( ( ( ) ) ), ( ( ) ( ) ), ... } 和 I' m 要求为它写一个递归定义。有人可以给我一个例子，看看它可能是什么样子吗？- 我对这种类型的计算机科学理论有点陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:47:26.770

一种递归定义是语法。生成平衡括号的语言：

```
S --> (S) | SS | ^ 
```

这是递归的，因为`S`出现在`RHS`生产规则中。

制作规则： `LHS --> RHS`

**编辑**

为什么`(s)`不`S`呢？

因为要`()`递归地添加对并且不止一次。

```
S --> (S) --->  ((S)) 
```

在第二步中，内部`S`被替换为`(S)`.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-09T16:48:36.170

```
TEXT ::= BRACES | BRACKETS | LIST;
BRACES ::= "{" ( TEXT | /* nothing */ ) "}";
BRACKETS ::= "(" ( TEXT | /* nothing */ ) ")";
LIST ::= ( BRACES | BRACKETS ) | ( BRACES | BRACKETS ) "," LIST; 
```

# gis - 地理信息系统后应用

> ID：14790282
> 
> 赞同：3
> 
> 时间：2013-02-09T16:44:02.060
> 
> 标签：gis, postgis, mapserver, spatial-query

我想学习如何使用 postGIS 构建应用程序。我想知道是否有好的开源示例可供我查看？我对那些不仅使用 postgres 存储地图数据而且在应用程序代码中广泛使用 postGIS 特殊函数（聚合和 SQL-MM，即 ST_* 函数）的人特别感兴趣。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T06:50:36.717

PostGIS 是一款出色的工具，可用于存储和运行对地理数据的各种查询。但是，要显示地图，您将需要另一个工具。那里有很多。

**如果您对网络制图感兴趣：**这是[我问的关于网络制图的问题](https://gis.stackexchange.com/questions/12353/completely-brand-new-to-gis-help-picking-technology-from-the-pros)。我最终将地图数据存储在 PostGIS 数据库中，然后使用 GeoServer 和 OpenLayers 提供服务。另一个可靠的网络地图路线是[GeoDjango](http://geodjango.org/)。

**编辑：**详细说明我以前的经验。我有一组存储在 shapefile (.shp) 中的矢量数据（多边形）。我需要在谷歌地图上显示它们并能够在网络平台上选择它们。首先，我将 shapefile 导入我的 PostGIS 数据库。

设置 GeoServer 后，我将我的 PostGIS 数据库与 GeoServer 连接起来并创建了一个 WFS 图层。有不同的类型（如 WMS），但我使用了 WFS，因为它很适合选择我正在显示的多边形。

接下来，我必须显示我添加到 GeoServer 的图层。为此，我使用了 OpenLayers JavaScript 库。他们的网站上有很多例子。[这个](http://openlayers.org/dev/examples/getfeature-wfs.html)使用 GeoServer 来提供地图数据。只需查看源代码即可了解 Openlayers 如何获取地图并显示它。

**如果您想创建离线地图：** [Quantum GIS](http://www.qgis.org/)是一款不错的免费工具。ArcGIS 也很受欢迎，但不是免费的。

如果我是你，我会查看[https://gis.stackexchange.com/](https://gis.stackexchange.com/)。你会在那里找到很多东西，这是一个非常有帮助的社区。

# javascript - 在数组中查找多个对象值

> ID：14790286
> 
> 赞同：1
> 
> 时间：2013-02-09T16:44:48.173
> 
> 标签：javascript

这是我的对象：

```
function Plane (x,z) {  
    this.x = x;
    this.z = z;
}

var plane = new Plane(0,50000); 
```

我有一个包含这些对象的数组：

```
planesArray.push(plane); 
```

我有一个点对象：

```
function Point (x,z) {  
    this.x = x;
    this.z = z;
}

var point = new Point(0,-50000); 
```

我需要检查是否`planesArray`存在具有特定点的对象，以便检查该点的值 x 和 y 是否等于数组中的任何平面，如果不是，则执行操作。

我还是个新手，如果这个问题听起来很愚蠢，我很抱歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T16:48:47.017

遍历数组并返回一个布尔值，指示是否找到了`Point`具有这些属性的对象。本示例使用该[`.some`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/some)方法执行此操作。

```
var found = planesArray.some(function(plane) {
    return plane.x === x && plane.y === y;
});

if (found) {

} 
```

**更新**：这是与函数相同的代码。

```
function found(list, x, y) {
    return list.some(function(plane) {
        return plane.x === x && plane.y === y;
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T16:48:19.143

```
var point = new Point(0,-50000);
for(var i = 0; i < planesArray.length; i++) {
    var plane = planesArray[i];
    if(plane.x != point.x || plane.z != point.z) {
        //perform action
        //break; //optional, depending on whether you want to perform the action for all planes, or just one
    }
} 
```

# ruby-on-rails-3 - 设计::模型包含

> ID：14790289
> 
> 赞同：0
> 
> 时间：2013-02-09T16:45:06.557
> 
> 标签：ruby-on-rails-3, devise

我正在尝试更深入地了解 Rails 引擎机制，并查看设计项目的来源。

你知道，有一个模块`Devise::Models`定义了一个`devise`为支持身份验证和东西的模型调用的方法。到目前为止一切都很好。

见[https://github.com/plataformatec/devise/blob/master/lib/devise/models.rb](https://github.com/plataformatec/devise/blob/master/lib/devise/models.rb)

但是我很难弄清楚这个模块是如何包含在模型中的。它是自动加载的还是什么？当我在不使用生成器的情况下创建新模型时，该死的设计如何使 Devise::Models 模块可以访问，以便我可以直接调用`devise :trackable, :stuffable`.

这对我来说只是黑暗。任何解释将不胜感激。

感谢您的阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T12:57:23.840

伙计，我觉得自己很愚蠢。我花了很多时间来找出为什么`Devise::Models`我的所有模型中都包含模块，并且我可以在`devise`不引发 NoMethod 错误的情况下调用方法。

最后我找到了答案。

此模块包含在您的设计安装使用的 orm 文件中。如果你没有改变它，你会在你的初始化程序中做这些事情。（选择正确的 Orm 适配器文件）

然后包含在问题中的文件（在我的情况下，`mongoid.yml`）只是：

```
require 'orm_adapter/adapters/mongoid'

Mongoid::Document::ClassMethods.send :include, Devise::Models 
```

如果您愿意为您的引擎提供相同的机制，希望这会启发您。

问候

# blackberry - 同一字段中的不同字体大小

> ID：14790290
> 
> 赞同：2
> 
> 时间：2013-02-09T16:45:14.337
> 
> 标签：blackberry, user-interface, java-me, paint

我们如何在同一字段中使用不同字体大小的绘制方法（使用字段扩展）获取文本。？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T22:41:41.593

如果你真的想通过改变覆盖`paint()`方法中的字体大小来做到这一点，你可以使用这样的东西：

```
 public TextScreen() {
      super(MainScreen.VERTICAL_SCROLL | MainScreen.VERTICAL_SCROLLBAR);

      final int MAX_FONT_SIZE = 24;
      // this is the font style to use, but the SIZE will only apply to the 
      //  beginning of the text
      Font f = Font.getDefault().derive(MAX_FONT_SIZE);

      TextField text = new TextField(Field.NON_FOCUSABLE) {
         public void paint(Graphics g) {
            char[] content = getText().toCharArray();

            Font oldFont = g.getFont();
            int size = MAX_FONT_SIZE;
            // use the baseline for the largest font size as the baseline
            //  for all text that we draw
            int y = oldFont.getBaseline();
            int x = 0;
            int i = 0;
            while (i < content.length) {
               // draw chunks of up to 3 chars at a time
               int length = Math.min(3, content.length - i);
               Font font = oldFont.derive(Font.PLAIN, size--);
               g.setFont(font);

               g.drawText(content, i, length, x, y, DrawStyle.BASELINE, -1);

               // skip forward by the width of this text chunk, and increase char index
               x += font.getAdvance(content, i, length);
               i += length;
            }
            // reset the graphics object to where it was
            g.setFont(oldFont);
         }                     
      };

      text.setFont(f);
      text.setText("Hello, BlackBerry font test application!");

      add(text);
   } 
```

请注意，我必须创建 field `NON_FOCUSABLE`，因为如果您通过`paint()`像这样更改字体来欺骗该字段，蓝色光标将与底层文本不匹配。您也可以通过覆盖`drawFocus()`和不执行任何操作来删除光标。

你没有指定任何焦点要求，所以我不知道你想要什么。

如果您愿意考虑其他替代方案，我认为[RichTextField](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/component/RichTextField.html)更适合让您在同一字段中更改字体大小（或其他文本属性）。如果你想要的只是逐渐缩小文本，就像我的例子一样，这个`paint()`实现可能没问题。如果您想在您的字段中选择某些*单词*以用更大的字体绘制（例如使用 HTML`<span>`标签），那么[RichTextField](http://supportforums.blackberry.com/t5/Java-Development/Format-text-in-a-RichTextField/ta-p/445038)可能是最好的选择。

这是我的示例代码的输出：

![在此处输入图像描述](../Images/7e8b549d908da2e321e23b23999e158e.png)

# iphone - tableView 上的可移动自定义 UIAlertView

> ID：14790292
> 
> 赞同：0
> 
> 时间：2013-02-09T16:45:50.033
> 
> 标签：iphone, uialertview, custom-view

我制作了一个自定义 UIAlertView 如下：- 1）我制作了一个 UIView 的子类，它的大小与 UIWindow 一样，并将其背景颜色设置为 Clear，我这样做是为了让用户无法单击除popupView 2) 然后我创建了一个小的 popupView 这是实际的 AlertView ，它位于 (20,100,300,150) 的固定位置 3) 然后我需要在单击按钮时将其添加到 parentView 如下所示然后显示它

```
[parentView.view addSubView:CustomAlertView];
[CustomAlertView show]; 
```

这在正常大小的普通 UI 上工作正常，但是当我使用 UITableView 时，如果向下滚动到较低的单元格，则 AlertView 不会出现，因为它具有固定位置并且它出现在上方，为此我需要向上滚动到看到 popupView ，

有什么办法可以让我使用相同的方法，但是底部的单元格也可以看到 popupView，因为我的代码没有太大的变化，因为代码很大？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:36:01.760

不要将自定义警报视图添加到视图控制器的视图中。您应该将警报添加到主窗口，或者更好的是，添加一个级别为的第二个窗口，`UIWindowLevelAlert`并将您的警报视图添加到这个附加窗口。然后使第二个窗口成为关键和可见窗口。解散时，移除窗口并再次制作旧的窗口键。

# ruby-on-rails - 在 Rails3 中选择每天的平均不同值

> ID：14790294
> 
> 赞同：1
> 
> 时间：2013-02-09T16:45:52.543
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

不知道为什么这让我如此难过，但我不知道该怎么做。

我有一张有 50 万个会话的表，从一开始就需要每天获取不同 MAC 地址的平均数量。

我试过这个：

```
def self.average_users_per_day
  self.average("distinct mac", :group => Chronic.parse("starttime"))
end 
```

（使用 Chronic，因为 starttime 是一个带时区的字符串。尝试使用 DATE（“starttime）”）

通过大量数据，我得到了我认为正确的数字。直到我进行了一些测试并发现它实际上并没有对结果进行分组。

```
it "finds the average sessions per day", :focus => true do
  10.times do
    FactoryGirl.create(:session, starttime: Time.now, mac: (1..6).map{"%0.2X"%rand(256)}.join(":") )
  end

  10.times do
    FactoryGirl.create(:session, starttime: Time.now - 1.days, mac: (1..6).map{"%0.2X"%rand(256)}.join(":") )
  end
  Session.average_users_per_day.to_i.should eq 10
end 
```

结果总是 20 而不是 10。

查询应该是什么样子？任何帮助表示赞赏 - 有一个思维障碍。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T07:39:01.067

您可能必须使用分组功能，因为不清楚 starttime 的确切存储格式是什么，但这应该适合您：

```
def self.average_users_per_day
  self.from("(SELECT COUNT(DISTINCT mac) AS macs FROM #{self.quoted_table_name} GROUP BY DATE(startime)) AS counts").average("macs").to_f
end 
```

刚刚使用 mysql 在类似的模式上进行了测试，似乎可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:20:07.227

我对此并不完全确定，但想知道您是否需要在 SQL 中解析日期而不是之后使用 Chronic，并且还认为 arel 平均值将返回值的有序散列，因此这是我的尝试认为有效，尽管使用 SQLite 特定的 substr 函数从时间字符串中提取日期

```
def self.average_users_per_day
  sessions_per_day = self.select('distinct mac').group('substr(starttime, 0,11)').size.values
  sessions_per_day.inject(:+).to_f / sessions_per_day.size
end 
```

此外，这会返回一个浮点数，因此已将规范调整为：

```
Session.average_users_per_day.should eq 10.0 
```

# c++ - 在 C++ 中比较和排序 Char 数组

> ID：14790295
> 
> 赞同：0
> 
> 时间：2013-02-09T16:45:53.560
> 
> 标签：c++, c, sorting, char, compare

我们目前正在学习 C++，我认为这段代码还不需要我们使用指针。

因此，对于答案的建议，请让我知道是否可以在没有指针的情况下完成。

问题：如何比较一个 char 数组，以便您可以按升序对它们进行排序？

细节：

目标：在插入名称时按升序对名称进行排序

我们在这里有什么：

```
char name[1024]; // which is a part of a Struct 
```

插入有效。一旦插入。我正在尝试重新排列顺序，以便名称在

升序。

我有：

```
if (RecordCollection[i].name > RecordCollection[i+1].name) // for comparing 
```

我想这可能是问题所在？C++可以这样比较吗？比如，比较约翰和艾米

那一行？

```
After that if statement, I am using swapping the elements so they are in correct order. For example: 
If John[0] the current name is > than Amy[1], then copy John to a temporary. 
Then copy Amy to index[0]. 
Then copy John in temporary to index[1]. 
```

在输入这个问题时，我想我需要一个一个地比较字符...... J和A，如果不一样那么

种类。如果相同，则移动到下一个字符，直到找到不同的排序。但后来我不知道如何

得到 char 1 by 1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:48:46.980

如果您使用字符串，请参阅`strcmp`.

> ### 男人`strcmp`
> 
> 大于零的值表示第一个不匹配的字符 in 的值`str1`大于 in `str2`；小于零的值表示相反。

要对数组进行排序，您还可以使用`qsort`标准 C 库。

```
#include <string.h>

int
cmp (const void *p, const void *q)
{
  return strcmp (p, q);
}

qsort (RecordName, nelems, 1024, cmp); 
```

# joomla - 设置访问控制以允许非注册成员查看介绍文本，但不能查看全文

> ID：14790298
> 
> 赞同：2
> 
> 时间：2013-02-09T16:46:08.187
> 
> 标签：joomla, acl, membership, joomla3.0

我需要在我正在开发的网站上设置 ACL 权限，以便客人可以看到文章的介绍文本，但除非他们注册，否则无法看到全文。

该网站使用的是 Joomla 3.0。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:17:27.820

登录到管理员后端。

1.  转到内容 > 文章管理器并编辑文章。
2.  使用 Read More 链接将文章的访问级​​别（编辑器右侧的详细信息）设置为已注册。
3.  单击选项卡文章选项并找到“显示未经授权的链接”。选择是。
4.  保存并关闭。
5.  在同一窗口中，单击顶部工具栏中的选项按钮。
6.  将显示未经授权的链接设置为是并保存设置。这是一个全局设置，将适用于所有具有阅读更多链接和注册+访问权限的已发布文章。

# c++ - 流 seekg() 实现从 VS2012 到 2010 不同

> ID：14790299
> 
> 赞同：1
> 
> 时间：2013-02-09T16:46:17.927
> 
> 标签：c++, visual-studio-2010, visual-studio-2012, stream

我有一段在 gcc VS2010 上运行良好的旧代码。我试图在 VS2012 中编译相同的。我知道我在任何地方都没有将 done 设置为 true，但它不是实际的代码。我已经缩短了重现问题的代码。

```
std::ifstream file_stream;
file_stream.open("C:\\experiment\\file.txt", std::ios_base::in);
std::istream& stream = file_stream;
bool done = false;
while(stream.good() || !done){
    int stream_position = stream.tellg();
    bool stream_failure = (stream_position == -1);
    bool stream_eof = stream.eof();
    std::string line;
    std::getline(stream, line);

    std::cout << stream_failure << stream_eof << std::endl;

    std::streampos pos = stream.tellg();
    if(pos == std::streampos(-1)){
        std::streampos copy = pos;
        stream.seekg(0, std::ios_base::end);
        pos = stream.tellg();
        stream.seekg(copy);
    }
}
std::getline(std::cin, std::string());
file_stream.close(); 
```

如果我将平台工具集更改为 VS2010，它可以工作并打印`1`代替`stream_eof`
如果我将平台工具集更改为 VS2012，它不会并`0`在`stream_eof` 它达到 EOF 后打印

如果我放一个`if(stream_eof)return 0;`after cout 它会在 VS2010 上返回，但不会在 VS2012 中返回

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T05:06:44.790

这是 C++03 和 C++11 的区别之一。

在 C++03 中，当您调用`seekg()`设置了任何错误位的流时，它会失败并且不执行任何其他操作。

在 C++11 中，`seekg()`首先无条件清除`eofbit`，然后尝试按照指示进行操作。在这种情况下，因为`failbit`也被设置，它失败，但`eofbit`被清除。

（顺便说一句，为什么您的循环首先设置为读取文件末尾？使用通常的`while(getline(stream, line))`）

# php - 评论不显示在自定义模板中

> ID：14790301
> 
> 赞同：0
> 
> 时间：2013-02-09T16:46:21.373
> 
> 标签：php, html, wordpress, wordpress-theming

我正在本地机器上为 WordPress 3.5.1 编写自定义模板。我来到了一个需要添加评论的部分，所以我在我的 index.php 页面中添加了以下内容，我
`<?php comments_template(); ?>`也包括在内`<?php wp_footer(); ?>`并
`<?php wp_header(); ?>`支持 WordPress 插件。但是当我检查页面时，我看不到任何评论，即使是默认评论（我还检查了它是否存在于数据库中）。有什么我想念的吗？什么会影响评论的显示？我需要包括一些额外的东西吗？

它也是一个带有静态内容的单页网站（我编辑了页眉和页脚以显示动态内容，如标题、元数据等），但由于它是一页网站，我决定使用静态内容，不确定它是否有事可做与问题）。因此，用户看到的服务器 index.php 上有 1 页，我不确定这是否是问题所在，但这可能与与帖子相关的评论有关吗？但是我仍然认为我至少应该在页面上看到一个评论表单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:10:36.330

> 有没有办法关联到某个帖子？

您需要查询您想要的帖子并建立一个循环。这真的很简单。

```
$args = array(
  'p' => 188 // works on my server; use whatever ID you need
);
$qry = new WP_Query($args);

if ($qry->have_posts()) {
  while ($qry->have_posts()) {
    $qry->the_post();
    comments_template();
  }
} 
```

这应该会显示您选择的帖子的评论。

[`comment-reply`](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)如果您的页面上尚未加载，[您可能需要排队。](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)

[http://codex.wordpress.org/Class_Reference/WP_Query](http://codex.wordpress.org/Class_Reference/WP_Query)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:02:30.870

您是否在单个页面上调用[了循环？](http://codex.wordpress.org/The_Loop "循环")如果没有，WordPress 将无法查询评论，因为它们都附加到特定的帖子 ID。WordPress 还需要在显示表单之前知道该特定帖子的评论是打开还是关闭。

您的静态内容应存储在 WordPress 页面中，并设置注释。您将该页面定义为“设置”中的首页。（设置->阅读->“首页显示静态页面”）。在模板页面上，您将使用[模板标签](http://codex.wordpress.org/Template_Tags/ "WordPress 模板标签")来输出内容。

```
<?php if(have_posts():
while(have_posts()):
    the_post(); ?>
    \\ output goes here
<?php comments_template(); ?>
<?php endwhile();
endif; ?> 
```

# iphone - 在哪里存储可下载的应用内购买？

> ID：14790302
> 
> 赞同：3
> 
> 时间：2013-02-09T16:46:33.433
> 
> 标签：iphone, ios, ipad, in-app-purchase

我的应用有可下载的应用内购买。下载内容后，我现在将其存储在文档目录中。但我知道 Apple 很挑剔，可能会拒绝我的应用程序，因为可以恢复的内容不应该存储在文档目录中，这意味着将保存到 icloud。

我想过使用临时目录或缓存目录，但是当 iOS 需要空间时，这些目录可以随时清空。

我应该把它保存在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T16:55:56.753

该`Documents`目录只能用于无法下载的用户生成数据（包括包含用户可选设置和类似设置的潜在数据库），所以您是对的，如果您将可下载的内容存储在那里，您可能会被拒绝。

我这样做的方式是将下载的数据存储在`Cache`其中（正如您所说，在空间不足时可以随时清除），并在其中存储一小段数据`Documents`，表示内容*应该*在`Cache`. 当`Documents`说数据应该存在而不存在时，我会通知用户由于空间问题，该内容已被 iOS 自动删除，并提供用户重新下载。

这样，如果用户暂时不使用该内容，他可以将其设备上的空间用于其他事情，并且仍然可以随意再次下载该内容。就像如果我是用户我想要一个应用程序工作一样:)

编辑：`Library`如果您需要它们始终保持不变，您可以将它们放入，但请记住将它们标记为[未备份到 iCloud](https://developer.apple.com/library/ios/#qa/qa1719/_index.html)，否则您很可能会遭到同样的拒绝。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T00:51:53.930

我还阅读了文档文件夹用于用户生成的内容，并且建议使用缓存文件夹，尽管您的数据可以在需要时删除。我还读到，当面向 ios 5.1 及更高版本时，可以选择使用带有无备份标志的文档文件夹。

请参阅 [iOS 5.0.1：如何验证文件夹是否标记为 iCloud 的“不备份”？](https://stackoverflow.com/questions/8117284/ios-5-0-1-how-to-verify-that-the-folder-is-marked-as-do-not-back-up-for-iclo)

[在 iOS 5.0.1 中将“不备份”属性添加到文件夹层次结构](https://stackoverflow.com/questions/8694112/adding-the-do-not-backup-attribute-to-a-folder-hierarchy-in-ios-5-0-1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-09T10:00:49.367

这里的文档[https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Chapters/DeliverProduct.html#//apple_ref/doc/uid/TP40008267-CH5-SW5](https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Chapters/DeliverProduct.html#//apple_ref/doc/uid/TP40008267-CH5-SW5)

说`Documents`文件夹是移动内容的地方，如果你想让它持久存在的话。

> 在 iOS 中，您的应用可以管理下载的文件。这些文件由 Store Kit 框架在未设置备份标志的情况下保存在 Caches 目录中。下载完成后，您的应用程序负责将其移动到适当的位置。对于在设备磁盘空间不足时可以删除的内容（稍后由您的应用重新下载），请将文件保留在 Caches 目录中。否则，将文件移动到 Documents 文件夹并设置标志以将它们从用户备份中排除。

# c# - 滚动到列表框的顶部和底部

> ID：14790306
> 
> 赞同：1
> 
> 时间：2013-02-09T16:47:00.517
> 
> 标签：c#, listbox

我`ListBox`命名**了 lstFiles**来显示图像的文件名，然后在从列表框中选择时，通过鼠标或键盘进行选择。

然后图像将显示在`PictureBox` **pictureBox1**中，但是在列出最后一个条目后，我无法尝试`ListBox`返回顶部，如果您在最后一个条目上选择了键盘上的向下箭头，并且顶部选择了条目，当您在第一个条目上按向上箭头键时，我希望同样进入底部条目。

我已经尝试过但无法让它在列表框中工作

**我有三个联合列表框来显示系统驱动器、文件夹及其内容**

```
private void lstDrive_SelectedIndexChanged_1(object sender, EventArgs e)
        {
            lstFolders.Items.Clear();
        try
        {
            DriveInfo drive = (DriveInfo)lstDrive.SelectedItem;

            foreach (DirectoryInfo dirInfo in drive.RootDirectory.GetDirectories())
                lstFolders.Items.Add(dirInfo);
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
    }

    private void lstFolders_SelectedIndexChanged_1(object sender, EventArgs e)
    {
        lstFiles.Items.Clear();

        DirectoryInfo dir = (DirectoryInfo)lstFolders.SelectedItem;

        foreach (FileInfo fi in dir.GetFiles())
            lstFiles.Items.Add(fi);
    }

    private void lstFiles_SelectedIndexChanged(object sender, EventArgs e)
    {
        pictureBox1.Image = Image.FromFile(((FileInfo)lstFiles.SelectedItem).FullName);

        //I have tried this, but it makes the selected cursor go straight to the bottom file//
        lstFiles.SelectedIndex = lstFiles.Items.Count - 1;

        }
      }
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:37:26.143

您可以通过处理`ListBox KeyUp`事件来完成此操作。试试这个 ：

```
 private int lastIndex = 0;

    private void listBox1_KeyUp(object sender, KeyEventArgs e)
    {

        if (listBox1.SelectedIndex == lastIndex)
        {
            if (e.KeyCode == Keys.Up)
            {
                listBox1.SelectedIndex = listBox1.Items.Count - 1;
            }

            if (e.KeyCode == Keys.Down)
            {
                listBox1.SelectedIndex = 0;
            }                

        }

        lastIndex = listBox1.SelectedIndex;
    } 
```

# ruby-on-rails - rails 将参数传递给“新”方法

> ID：14790310
> 
> 赞同：8
> 
> 时间：2013-02-09T16:47:26.610
> 
> 标签：ruby-on-rails, parameters

显然我对rails很陌生，所以坚持我。

我在我的模型中添加了一个构造函数

```
class Movie < Media
  attr_accessible :director, :studio
  attr_accessor :director, :studio

  validates_presence_of :director, :studio, :title
  def initialize title, director, studio
    @title = title
    @director = director
    @studio = studio
  end
end 
```

和那种对我来说搞砸的事情。在我的控制器中有一个像这样的“新”方法之前

```
def new
    @movies = Movie.new
end 
```

在初始化出现之前它运行良好。它需要将参数传递给“新”方法，但这是在打开视图以从用户传递参数并保存它们之后完成的。现在我无法打开该视图，因为出现错误

```
wrong number of arguments (0 for 3) 
```

由于我开始为我的应用程序编写测试并为构造函数设置默认值将使该测试无效，因此添加了构造函数。关于解决这个问题的建议？

编辑：我的测试如下所示：

```
require 'spec_helper'

describe Movie do

    before :each do 
        @movie = Movie.new "Bullet", "John", "20th"
    end
    describe "#{new}" do
        it "returns new object of Movie" do
            @movie.should be_an_instance_of Movie
        end
        it "throws ArgumentError when give less than 3 parameters" do
            lambda {Movie.new(:director => "John", :studio => "20th")}.should raise_exception ArgumentError
        end
    end

    describe "#title" do
        it "returns the correct title" do
            @movie.title.should eql "Bullet"
        end
    end
    describe "#director" do
        it "returns the correct director" do
            @movie.director.should eql "John"
        end
    end
    describe "#studio" do
        it "returns the correct studio" do
            @movie.studio.should eql "20th"
        end
    end
end 
```

没有那个构造函数，所有的测试都会失败......

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-09T19:50:06.463

ActiveModel 提供的默认构造函数很不错。如果你删除你写的构造函数，你应该可以像这样使用默认构造函数：

```
@movie = Movie.new(title: 'The Hobbit', director: 'Peter Jackson', studio: 'New Line Cinema') 
```

当您不想提供三个参数时（例如在您的`new`操作中），您可以坚持使用`@movie = Movie.new`

# java - Java中有没有办法增量更改类名？

> ID：14790313
> 
> 赞同：1
> 
> 时间：2013-02-09T16:47:32.047
> 
> 标签：java, migration, classname

我有大量使用 XXX 类的 Java 代码。随着时间的推移，类的含义发生了变化，名称不再合适。为了使代码更具可读性，我想将类的名称更改为 YYY。

一种选择是一次性编辑所有文件并将XXX更改为YYY，但类的实际名称不是唯一的——还有其他同名的类，不同的包——所以我需要看代码. 我希望能够进行一些更改，测试它是否正确，然后再更改一些，测试更多等。在此过渡期间，我希望能够交替使用 YYY 和 XXX。最终我会消除XXX。

我需要的是一个“别名”概念，我可以在其中制作 YYY 和 XXX 的别名，但 Java 没有这个。

我可以使用所有相同的构造函数和方法使 YYY 成为 XXX 的子类。这将在变量声明为 XXX 并且我分配一个 YYY 类型的值的情况下正常工作。它也适用于方法参数为 XXX 并且我传递 YYY 的情况。但是当参数声明为 YYY 并且我有一个 XXX 值要发送时，它不会反过来工作。

我可以将 YYY 注入到继承中，以便 XXX 扩展 YYY，但我遇到了与上面相同的问题：在混合使用 XXX 声明和 YYY 值的代码中存在问题。

过渡时间将需要几个月的时间。在这段时间里，我不关心性能或效率，我只需要它编译和运行足够正确以进行测试。 **对于允许在 Java 代码主体中增量更改类名的最佳实践有什么建议吗？**

**更新**

下面的答案是，虽然在 Java 中没有办法做到这一点，但也应该没有理由这样做。我跟进安装和重构代码，并在这篇博文中写下了经验：[不要忍受糟糕的名字](http://agiletribe.wordpress.com/2013/02/12/dont-suffer-poor-names/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T16:50:54.753

使用诸如[Eclipse](http://www.eclipse.org)之类的 IDE并使用其重构工具来重命名该类。这将在使用它的任何地方自动更改它，更新导入等。

# java - 为 Java 垃圾收集取消引用数组中的对象

> ID：14790314
> 
> 赞同：6
> 
> 时间：2013-02-09T16:47:36.093
> 
> 标签：java, arrays, garbage-collection, dereference

我对 java 垃圾收集器进行了一些研究，并了解不再引用的对象将/应该由垃圾收集器处理。就对象数组而言，我知道将新对象分配给数组中的某个位置并不能正确释放先前分配的对象。

1.  我想知道如何从位置 x 的数组中删除和正确解除分配对象，并将新对象分配给位置 x 的同一数组。
2.  我还想知道如何正确释放数组本身。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-09T16:54:03.660

将数组中的一个对象设置为`null`或另一个对象使其符合垃圾收集条件，假设没有对存储在任何地方的相同对象的引用。

所以如果你有

```
Object[] array = new Object[5];
Object object = new Object() // 1 reference
array[3] = object; // 2 references
array[1] = object; // 3 references

object = null; // 2 references
array[1] = null; // 1 references
array[3] = new Object(); // 0 references -> eligible for garbage collection

array = null; // now even the array is eligible for garbage collection
// all the objects stored are eligible too at this point if they're not
// referenced anywhere else 
```

垃圾回收很少会回收本地人的内存，所以垃圾回收大多已经在函数范围之外发生了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T16:55:17.543

在 java 中，您不需要显式释放对象，无论它们是来自数组的引用，还是简单的字段或变量。一旦对象不是从根集强可达的，垃圾回收迟早会释放它。并且尝试帮助 GC 完成其工作通常是不合理的。阅读这篇[文章](http://www.ibm.com/developerworks/java/library/j-jtp01274/index.html#3.2)了解更多详情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T16:53:44.443

好吧，当不再引用所有对象时，垃圾收集器将自动收集它们。你不必为此烦恼。不过，如果您愿意，您可以将 null 分配给数组，并且在下次运行 GC 时，分配给数组的内存将自行释放。对于显式运行 GC，您可以执行

```
 java.lang.Runtime.getRuntime().gc(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-29T19:58:22.767

对象解除分配应在关闭或打开时通过清空对象进行。JUnit 测试对对象执行 assertGC 以确保所有对象都已被垃圾回收。如果项目有引用，Java 不会垃圾收集项目。我强烈建议进行 JUnit 测试。

# javascript - 没有在javascript中正确添加2个数字

> ID：14790317
> 
> 赞同：0
> 
> 时间：2013-02-09T16:47:58.967
> 
> 标签：javascript, html, function, variables, drop-down-menu

我的 html 中有一个下拉列表，此处显示值，

```
<select id="thedropdown">
<option value="1">test1</option>
<option value="2" selected="selected">test2</option>
<option value="3">test3</option>
</select> 
```

还有我的 javascript：

```
function myFunction()
{
var a = document.getElementById("thedropdown");
var b = a.options[a.selectedIndex].value;

var y=b;
var x=y+2;
var demoP=document.getElementById("demo")
demoP.innerHTML= x;
} 
```

但是，当我单击按钮时的答案是 22，而它应该是 4。你可以看到我的问题。提前为帮助喝彩

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T16:50:05.010

现在你的代码连接字符串。在添加之前，您需要[`parseInt()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt)or [`parseFloat()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseFloat)（或[`Number()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Number)或[`+`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Arithmetic_Operators#-_.28Unary_Negation.29)）这些值。

使用时`parseInt()`请确保[始终指定第二个参数（基数）](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt#Parameters)：

```
b = parseInt(a.options[a.selectedIndex].value, 10); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T16:52:58.017

您可以使用一元`+`将数字字符串转换为数字：

```
var y=+b; 
```

或者

```
var x=+y+b; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T16:50:43.397

您正在连接一个字符串而不是添加数字：

```
var x=y+2; 
```

试试看：

```
var x=parseInt(y)+2; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T16:50:39.137

您必须使用 parseInt 函数转换您的值：

```
 var y = parseInt(b, 10) + 2; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-09T16:58:40.587

如果其中一个操作数是 string ，则`+`operator 执行连接。

这会起作用

```
function myFunction()
{
  var a = document.getElementById("thedropdown");
  var b = a.options[a.selectedIndex].value;

  var y=b;
  var x= parseInt(y) + 2;
  var demoP=document.getElementById("demo")
  demoP.innerHTML= x;
} 
```

笔记`var x= parseInt(y) + 2;`

# android - 使用 Theme.Light 背景作为 LinearLayout 背景

> ID：14790318
> 
> 赞同：0
> 
> 时间：2013-02-09T16:48:02.467
> 
> 标签：android, android-layout, android-theme

我目前正在研究类似“人物”中使用的列表视图的列表视图。我正在使用[StickyListHeaders](https://github.com/emilsjolander/StickyListHeaders)库，但在设置列表标题本身的样式时遇到问题。

目前，这是我的 xml：

```
<?xml version="1.0" encoding="UTF-8"?> 
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:layout_width="match_parent"
              android:layout_height="wrap_content"
              android:layout_marginTop="5dp"
              android:orientation="vertical">

    <TextView
        android:id="@+id/header_text"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:paddingLeft="15dp"
        android:textColor="@color/ugent_blue_dark"
        android:textSize="15sp"
        android:textStyle="bold" />

    <View
        android:layout_height="1dp"
        android:layout_width="fill_parent"
        android:background="@color/ugent_blue_light">
    </View>

</LinearLayout> 
```

如前所述，我想要实现的是像“人员”视图这样的列表视图。此时，LinearLayout 是透明的。我想通过在 LinearLayout 上使用背景属性来解决这个问题。要与背景“融合”，它必须使用与我正在使用的主题相同的背景。澄清一下：我不希望它变得透明，这就是我尝试应用背景的原因。现在这是我遇到问题的地方：我使用的主题 has as parent`Theme.Sherlock.Light`有 as parent `android:Theme.Light`。

如果你看截图；您可以看到带有“2 月 12 日”的栏是透明的。我希望它与应用程序的其余部分具有相同的背景。

![在此处输入图像描述](../Images/7097a3b45ee140ca0a433d8f23627fa6.png)

所以，我的问题是：`background:`我需要在 LinearLayout 上应用什么才能使其具有与我的应用程序背景相同的背景？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:04:47.200

如果您使用灯光，那么只需将图像设置为灯光！如果 holo 把背景设置为暗。PS我不知道是哪个代码控制了上面的布局主题！使其透明但确定它是否未设置`styles`然后检查类以查看其是否从那里定制！

# html - 如何在 HTML5 中通过 bittorrent 流式传输视频 -标签？

> ID：14790319
> 
> 赞同：1
> 
> 时间：2013-02-09T16:48:08.643
> 
> 标签：html, html5-video, p2p, bittorrent

如何使用 p2p-next.org 的[SwarmPlayer v2](http://swarmplayer.p2p-next.org/#doc.html) ..？

我正在尝试将其用于站点，没有钱支付大量带宽。

所以我需要通过 bittorrent 蒸汽视频。

我正在使用 Ubuntu 12.10 进行测试。

下面是 HTML5 代码。

```
 <video style="width:544px;height:304px;">   
    <source src="tribe://http://url2torrent.net/torrent/511640ccc3acb404f246f391.torrent">
    <source src="http://upload.wikimedia.org/wikipedia/commons/3/38/Moederdag_%281925%29.ogv" >
    </video> 
```

`<video>`-tag旁边的关键部分是`tribe://`：

> `<source src="tribe://http://url2torrent.net/torrent/511640ccc3acb404f246f391.torrent">`

当我加载 HTML5 页面并转到：`http://127.0.0.1:6877/webUI`

然后我看不到视频下载.. :(

![在此处输入图像描述](../Images/512424ae0fa7a81db5ba13120fd06799.png)

我得到它来下载视频......一个小时后......只有45mb......不是上帝......

那么 SwarmPlayer-p2p-style 是不是很慢？

可以提速吗？

还是有更好的球员来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:58:33.793

HTTP 回退似乎有问题。如果您尝试使用由 BitTorrent 直接播种的 Ogg 视频（和播放时间字段），它仍然有效。例如尝试

[http://ca.isohunt.com/download/280788549/5aa6a160a7470b00e4b3d0ee824333fb7c934ca7.torrent](http://ca.isohunt.com/download/280788549/5aa6a160a7470b00e4b3d0ee824333fb7c934ca7.torrent)

作为来源。有关BitTorrent 引擎。

# php - 如果不匹配，比较用户 ID 并显示不同的输出？

> ID：14790320
> 
> 赞同：0
> 
> 时间：2013-02-09T16:48:09.773
> 
> 标签：php, html

我正在制作个人资料系统，但我似乎碰上了砖墙，我需要这样做，所以如果登录的用户正在查看他们自己的个人资料，那么他们将有其他选择，例如更改他们的个人资料图片，但如果其他人登录并查看其他人的个人资料，则个人资料的输出将有所不同，就像 Facebook 或 Twitter。

我没有任何代码可以给你看，否则我会的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:51:25.647

```
if(md5($_GET['id'])  == $_SESSION['id'])
{
    echo "this is your profile";
}
else
{
    echo "this is not your profile";
} 
```

登录时的 md5 会话，不安全，但比

登录时以纯文本形式保存任何内容更好：$_SESSION['id'] = md5($id);
$id 来自登录名或数据库。

# ruby-on-rails - Copycopter-server：由于“平台”gem，捆绑安装失败

> ID：14790330
> 
> 赞同：1
> 
> 时间：2013-02-09T16:49:04.403
> 
> 标签：ruby-on-rails, rubygems, ruby-on-rails-3.2, copycopter

我决定尝试在我的 VPS 上部署[Copycopter-server 。](http://railscasts.com/episodes/336-copycopter?view=asciicast)在我的开发机器上克隆 Github 存储库后，我尝试了`bundle install`。然后出现错误：

```
Gem::RemoteFetcher::FetchError: Errno::ECONNREFUSED: Connection refused - connect(2) (http://rubygems.org/gems/Platform-0.4.0.gem) 
```

我试图在本地安装 gems `Platform`，`Popen4`但没有成功。看来改进宝石的[最后一次活动是从 2005 年开始......](http://rubygems.org/gems/Platform)`Platform`

我需要你的建议：

*   我怎样才能找到这些 gem（`Platforma`是依赖项`Popen4`）在`Copycopter-server`应用程序中的使用位置？
*   会不会是 Rubigems.org 的临时问题，或者 gem 与 Rails 3.2.11 不兼容？
*   Gemfile 中名称 `Platform`和大写的原因可能是什么？`Popen4`

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T16:58:38.807

请检查您的网络设置。拒绝连接听起来更像是根本不允许您连接到 ruby​​gems。试一试

```
curl "http://rubygems.org" 
```

找出答案。

从评论更新：

中的源代码行`Gemfile`必须从

```
source :rubygems 
```

到

```
source 'https://rubygems.org' 
```

# r - 在 R 中的 lapply 调用中添加列表名称作为绘图标题

> ID：14790331
> 
> 赞同：11
> 
> 时间：2013-02-09T16:49:16.383
> 
> 标签：r, plot

```
sample <- 
structure(list(GB05 = structure(c(22L, 34L, 26L, 2L), .Dim = 4L, .Dimnames = structure(list(
    c("98", "100", "102", "106")), .Names = ""), class = "table"), 
    GB18 = structure(c(8L, 14L, 70L), .Dim = 3L, .Dimnames = structure(list(
        c("173", "175", "177")), .Names = ""), class = "table"), 
    GB06 = structure(c(2L, 16L, 48L, 10L, 10L, 6L), .Dim = 6L, .Dimnames = structure(list(
        c("234", "238", "240", "242", "244", "246")), .Names = ""), class = "table"), 
    GB27 = structure(c(2L, 28L, 2L, 2L, 4L, 3L, 2L, 2L, 15L, 
    17L, 4L, 5L), .Dim = 12L, .Dimnames = structure(list(c("145", 
    "147", "149", "151", "156", "159", "165", "167", "169", "171", 
    "173", "175")), .Names = ""), class = "table"), GB24 = structure(c(2L, 
    4L, 41L, 10L, 6L, 2L, 14L, 2L, 3L), .Dim = 9L, .Dimnames = structure(list(
        c("240", "241", "242", "243", "244", "247", "249", "251", 
        "253")), .Names = ""), class = "table"), GB28 = structure(c(30L, 
    22L, 2L, 10L, 2L, 4L, 2L, 2L, 2L), .Dim = 9L, .Dimnames = structure(list(
        c("363", "364", "365", "367", "371", "377", "380", "384", 
        "390")), .Names = ""), class = "table"), GB15 = structure(c(12L, 
    16L, 43L, 2L, 3L, 4L), .Dim = 6L, .Dimnames = structure(list(
        c("142", "144", "146", "147", "148", "152")), .Names = ""), class = "table"), 
    GB02 = structure(c(6L, 78L, 4L), .Dim = 3L, .Dimnames = structure(list(
        c("194", "197", "200")), .Names = ""), class = "table"), 
    GB10 = structure(c(2L, 36L, 7L, 1L, 16L, 20L), .Dim = 6L, .Dimnames = structure(list(
        c("124", "126", "128", "130", "132", "134")), .Names = ""), class = "table"), 
    GB14 = structure(c(3L, 6L, 7L, 37L, 7L), .Dim = 5L, .Dimnames = structure(list(
        c("181", "184", "187", "193", "196")), .Names = ""), class = "table")), .Names = c("GB05", 
"GB18", "GB06", "GB27", "GB24", "GB28", "GB15", "GB02", "GB10", 
"GB14")) 
```

如何让此列表中的名称在此 lapply 调用中显示为情节标题（每个情节一个标题）？

```
dev.new()
par(mfrow=c(2,5))
lapply(sample,function(x) plot(x,main=names[x])) 
```

我不明白为什么 main=names[x] 不起作用。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-09T16:52:55.383

`lapply`改为在列表项的名称上使用：

```
lapply(names(afn), function(x) plot(afn[[x]], main=x)) 
```

![在此处输入图像描述](../Images/132beb013e9584fc014bf30ccb413bf7.png)

要查看*为什么*您没有得到您的姓名，运行`lapply(afn, function(x) names(x))`会为您提供每个列表项的名称或其他*名称。*尝试相同`lapply(names(afn), function(x) x)`并比较差异。然后，请记住，我们可以使用 . 按名称提取单个列表项`[[`。

# nsdictionary - 如何使用多个 AFJSONRequestOperations 并将结果合并到一个 NSDictionary 中？

> ID：14790332
> 
> 赞同：1
> 
> 时间：2013-02-09T16:49:23.247
> 
> 标签：nsdictionary, objective-c-blocks, afnetworking, nsoperationqueue, afjsonrequestoperation

我不确定我这里有两个问题还是只有一个。我正在尝试从 Google Calendar API 下载多个 JSON 文件并将所有结果合并到一个 NSDictionary 或 NSMutableDictionary 中。

```
client = [[AFHTTPClient alloc] init];
[client.operationQueue setMaxConcurrentOperationCount:1];

eventData = [NSMutableDictionary dictionary];
NSMutableArray *operations = [[NSMutableArray alloc] init];
for (int i = 0; i < calendars.count; i++){
    NSString *calendarID = [calendars objectAtIndex:i];
    NSString *urlString = [NSString stringWithFormat:@"https://www.googleapis.com/calendar/v3/calendars/%@/events?key=%@&singleEvents=true&orderBy=startTime",calendarID,apiKey];
    NSURL *url = [NSURL URLWithString:urlString];
    NSURLRequest *request = [NSURLRequest requestWithURL:url];

    AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
        NSDictionary *add = JSON;
        [eventData addEntriesFromDictionary:add];
        if (i == calendars.count-1) {
            [self parseData];
        }
    } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
        NSLog(@"AFJSONRequest failed with request: %@, and with error: %@",request, error);
    }];

    [operations addObject:operation];
}
[client enqueueBatchOfHTTPRequestOperationsWithRequests:operations progressBlock:nil completionBlock:^(NSArray *operations) {
    NSLog(@"DONE");
}]; 
```

此代码中的 AFJSONRequestOperations 永远不会执行。通过将它们放置在 NSOperationQueue 而不是 AFHTTPClient 批处理中，我有一些运气让它们执行，但是我没有一个字典中的所有数据，只有最后执行的一个。另外，我没有我认为可以像这样使用的 AFHTTPClient 上的良好进度和完成块。

让 AFHTTPClient operationQueue 工作也能解决异步组合多个字典的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-07T22:10:46.347

利用

```
[operation start]; 
```

启动 AFJSONRequestOperation

# xpages - 自定义控件的复合数据在 beforeRenderResponse 事件中未定义

> ID：14790336
> 
> 赞同：5
> 
> 时间：2013-02-09T16:49:44.713
> 
> 标签：xpages

将数据传递给自定义控件时，我一直使用compositeData 对象从控件内部访问这些数据。这工作正常，除了自定义控件的 beforeRenderResponse 事件。以这段代码为例：

```
<xp:this.afterPageLoad><![CDATA[#{javascript:getComponent("lbl0").setValue(typeof(compositeData));}]]></xp:this.afterPageLoad>
<xp:this.beforeRenderResponse><![CDATA[#{javascript:getComponent("lbl1").setValue(typeof(compositeData));}]]></xp:this.beforeRenderResponse>
<xp:label value="" id="lbl0"/>
<xp:label value="" id="lbl1"/> 
```

在 afterPageLoad 事件中，compositeData 的 typeof 是“com.ibm.xsp.binding.PropertyMap”。然而在 beforeRenderResponse 事件中，相同的 typeof 返回“未定义”。

如何访问 beforeRenderResponse 事件中的复合数据？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T21:13:50.527

在*beforePageLoad*或*afterPageLoad 中*创建一个引用了*compositeData*的 SSJS 变量：

```
<xp:this.beforePageLoad>
   <![CDATA[#{javascript:
      var hlp=compositeData;
   }]]>
</xp:this.beforePageLoad> 
```

这允许您在渲染阶段访问 PropertyMap。如果您有属性*测试*，则可以通过以下方式访问它：

```
<xp:this.afterRenderResponse>
   <![CDATA[#{javascript:
      print( hlp.test );
   }]]>
</xp:this.afterRenderResponse> 
```

**编辑：** 这仅在打开页面（pageLoad）时才有效。如果刷新页面，这将不起作用。如果它必须在部分刷新的情况下运行，您必须这样做：

首先，您必须向自定义控件添加一个 ID：

```
<xc:ccWithId test="I am your property" id="ccWithId" /> 
```

*这允许您使用getComponent()*作为常规组件访问自定义控件。现在您可以在自定义控件的事件中访问组件的 propertyMap，该事件包含您想要的变量：

```
<xp:this.beforeRenderResponse>
   <![CDATA[#{javascript:
      var cmp:com.ibm.xsp.component.UIIncludeComposite = getComponent("ccWithId");
      print("Value of 'test' -> " + cmp.getPropertyMap().getString("test") )
   }]]>
</xp:this.beforeRenderResponse> 
```

**由 xpages-noob 编辑**：上面的示例适用于静态自定义控件属性。但是，在计算属性的情况下，属性映射的各种 get 函数返回值绑定对象而不是值本身。因此，可以使用以下功能作为解决方法：

```
 var thisData:com.ibm.xsp.binding.PropertyMap=getComponent("ccWithId").getPropertyMap();
function getPara(key) {
    var x=thisData.get(key);
    if (@Ends(typeof(x),"ValueBinding")) return x.getValue(facesContext);
    else return x
} 
```

例如，如果您想获取属性“test”，请调用 getPara("test")。返回值应等于compositeData.test。

# devise - 设计无法访问的recaptcha

> ID：14790337
> 
> 赞同：0
> 
> 时间：2013-02-09T16:49:47.227
> 
> 标签：devise, ruby-on-rails-3.2, recaptcha

我尝试在设计上使用recaptcha。每次我将代码放入 racaptcha 并提交表单时，我都会收到“recaptcha-not-reachable”消息。几天前，recaptcha 工作正常，但现在我总是收到消息“recaptcha-not-reachable”，我真的不知道为什么。

看法

```
<div class="password">

  <p class="forgot">Forgot your password?</p>

  <hr class="style-six">

  <div class="row">
    <div class="email">
      <%= form_for(resource, :as => resource_name, :url => password_path(resource_name), :html => {:id => "renew", :class => "form-horizontal", :method => :post }) do |f| %>

          <div class="control-group mailinput">
            <%= f.email_field :email, :placeholder => "Email", :autofocus => true, :required => true %>
          </div>

          <%= recaptcha_tags :display => { :theme => 'white' } %>

          <div class="control-group">
            <%= f.button "Re-new password", :class => "btn btn-primary"  %>
          </div>
      <% end %>
    </div>
  </div>

</div> 
```

控制器

```
class PasswordsController < Devise::PasswordsController
  layout 'xxxx_layout'

  # POST /resource/password
  def create
    if verify_recaptcha
      self.resource = resource_class.send_reset_password_instructions(resource_params)
      if successfully_sent?(resource)
        respond_with({}, :location => after_sending_reset_password_instructions_path_for(resource_name))
      else
        flash.delete :recaptcha_error
        flash.now[:error] = t("error.user.noexist")
        render "passwords/new"
      end
    else
      build_resource
      clean_up_passwords(resource)
      flash.now[:alert] = "There was an error with the recaptcha code below. Please re-enter the code."
      #flash.delete :recaptcha_error
      render "passwords/new"
    end
  end

end 
```

根

```
get 'password/new' => 'passwords#new', :as => :new_user_password
post 'password'    => 'passwords#create', :as => :user_password
get 'password/edit' => 'passwords#edit', :as => :edit_user_password
put 'password' => 'passwords#update' 
```

/config/initializers/recaptcha.rb

```
Recaptcha.configure do |config|
  config.public_key  = 'xxxxxxx'
  config.private_key = 'xxxxxxx'
  config.proxy = 'http://127.0.0.1:3000'
end 
```

配置/应用程序.rb

```
require "net/http" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T07:49:12.660

`config.proxy = 'http://127.0.0.1:3000'`似乎是错误的。这通常是您的开发服务器使用的地址，因此不能有代理。将此更改为您的真实代理或将其注释掉。

就像现在一样，reCAPTCHA 尝试使用您的 rails-app 作为代理来建立与 recaptcha-servers 的连接。您的 rails-app 不理解请求（您可能应该在日志中看到某些内容！）并返回错误页面。现在 recaptcha 尝试解析该响应，但不知道如何读取它，甚至识别出这不是来自 recaptcha 服务器并抱怨无​​法访问其服务器。

# php - 在PHP中，我如何从另一个类调用属性的方法

> ID：14790338
> 
> 赞同：0
> 
> 时间：2013-02-09T16:49:50.217
> 
> 标签：php, class, object, methods

我在尝试做一些 Php 对象时遇到了一个小问题。

我有这些课程：

```
class a
{
    public $day;

    function __construct(){
        $this->day = new DateTime("now");
    }
}

class b
{
    public $test;

    function __construct(){
        $this->test = new a()
    }
    function myFunc(){
        $this->test->day->format('Y-m-d');
    }
} 
```

调用 myFunc 时出现此错误：

> 致命错误：在非对象上调用成员函数 format()

我如何从类“b”调用包含在类“a”中的对象属性的方法？

编辑：好的，所以我实际上使上面的代码比我真正拥有的更简单，以便在这里发布它并且这样做错误并没有通过......这是一个更接近我所拥有的代码并显示错误我在谈论

```
<?php
date_default_timezone_set('America/Chicago');
class a
{
    public $day;
}

function __construct($day = "now")
{
    $this->day = new DateTime($day);
}

class b
{
public $test;

function __construct(){
    $this->test = new a();
    }   
function myFunc(){
    echo $this->test->day->format("Y-m-d");
    }   
}
$bclass = new b();
$bclass->myFunc();
?> 
```

这正是我在执行它时得到的：

> ```
> ( ! ) Fatal error: Call to a member function format() on a non-object in C:\wamp\www\axpo\newPHPClass.php on line 21
> Call Stack
> # Time    Memory  Function    Location
> 1 0.0023  256080  {main}( )   ..\newPHPClass.php:0
> 2 0.0024  257128  b->myFunc( )    ..\newPHPClass.php:25 
> ```

我不明白为什么它不起作用......我知道这肯定是愚蠢和基本的，但我只是看不到它......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T11:08:48.730

新代码的问题是您在定义**public $day之后关闭了类定义**

> A类{公共$天；} // 类被最后一个大括号关闭！

所以 __constructor 函数根本没有被调用！删除“public $day;”后面的大括号 并将其添加到 __construct 函数的定义之后。然后它应该工作！

卢西安

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:22:58.827

你错过了一个分号

$this->test = new a();

并且您必须返回或回显类 b 的 myFunc() 中的值才能对其进行处理。看看这个：

```
<?php
class a
{
    public $day;

    function __construct(){
        $this->day = new DateTime("now");
    }
}

class b
{
    public $test;

    function __construct(){
        $this->test = new a(); // Added a semicolon !
    }
    public function myFunc(){
       return $this->test->day->format('Y-m-d'); // Return the value
    }
}

$b= new b();
echo $b->myFunc(); // echo the returned value from the function

?> 
```

# mysql - MySQL - 使用表连接过滤计数查询

> ID：14790339
> 
> 赞同：0
> 
> 时间：2013-02-09T16:49:55.117
> 
> 标签：mysql, join, count

我有一个用户表、一个帖子表、一个私有表和一个 user_stats 表：

```
users                     
user_id |  user_name
--------------------
   1    |    tony
   2    |    steph
   3    |    lizzy
   4    |    adam

posts
post_id   user_id     sugg_by   private (0 is public, 1 is private to authorized users)
-----------------------------------------------------
   1         1           2         0
   2         2           2         1
   3         2           2         1            
   4         2           4         1
   5         2           2         1
   6         2           3         0

private
private_id   post_id   authorized_user_id
-----------------------------------------------
    1           2               4
    2           2               3
    3           4               4
    4           5               1
    5           5               3

user_stats                     
user_id  orig_posts_count(user_id=sugg_by in posts)  sugg_posts_count(user_id<>sugg_by in posts) 
-----------------------------------------------------------------------------------------------------
   1             0                                          1
   2             3                                          2
   3             0                                          0
   4             0                                          0 
```

我遇到的问题是在这个查询中。在此示例中，“4”是 $logged_in_id adam，“2”是我们为 steph 计数的帖子的 user_id。如果 steph 已登录，则 COUNT 将不会运行，我们将给出 'posterview'，这很有效。回到任何其他登录的用户或任何退出的用户，问题就开始了。所以对于亚当'4'：

```
SELECT u.user_id, us.orig_posts_count, us.sugg_posts_count,
IF(us.user_id='4', 'posterview',
COUNT(case when ISNULL(pv.post_id) AND p.private='1' AND p.user_id='2' AND p.sugg_by='2' then null else 1 end)
) as display_orig_posts_count,
IF(us.user_id='4', 'posterview',
COUNT(case when ISNULL(pv.post_id) AND p.private='1' AND p.user_id='2' AND p.sugg_by<>'2' then null else 1 end)
) as display_sugg_posts_count
FROM users u 
JOIN user_stats us ON u.user_id=us.user_id 
JOIN posts p ON p.user_id=us.user_id
LEFT JOIN private pv on pv.post_id = p.post_id AND pv.authorized_user_id='4' 
WHERE u.user_id='2' LIMIT 1 
```

输出应该是：

```
user_id  orig_posts_count  sugg_posts_count  display_orig_posts_count  display_sugg_posts_count
   2            3                  2                    1                          2 
```

然而，它[输出](http://sqlfiddle.com/#!2/7c76e/6)为：

```
user_id  orig_posts_count  sugg_posts_count  display_orig_posts_count  display_sugg_posts_count
   2            3                  2                    3                          5 
```

我相信造成这种情况的原因在于`JOIN posts p ON p.user_id=us.user_id`

如果我将其转换为`JOIN posts p ON p.user_id=us.user_id AND p.sugg_by='2'`（与 display_orig_posts_count 的第一个 COUNT 匹配），则 display_orig_posts_count 为 1，这是正确的，但 display_sugg_posts_count 在 3 时不正确。我得到正确的 display_orig_posts_count 和不正确的 display_sugg_posts_count。[输出](http://sqlfiddle.com/#!2/7c76e/5)为：

```
user_id  orig_posts_count  sugg_posts_count  display_orig_posts_count  display_sugg_posts_count
   2            3                  2                    1                          3 
```

如果我将其转换为`JOIN posts p ON p.user_id=us.user_id AND p.sugg_by<>'2'`（与 display_sugg_posts_count 的第二个 COUNT 匹配），则 display_orig_posts_count 为 2，这是不正确的，但 display_sugg_posts_count 在 2 处是正确的。[输出](http://sqlfiddle.com/#!2/7c76e/4)为：

```
user_id  orig_posts_count  sugg_posts_count  display_orig_posts_count  display_sugg_posts_count
   2            3                  2                    2                          2 
```

基本上，登录用户如果 steph 应该返回“posterview”，但任何其他使用 COUNT 的用户应该只看到公开的帖子（私有 0）或（私有 1）只有当它们是其中的一部分时，然后计数根据 COUNT 子句中的条件来获得所述的正确输出。我已经坚持了几个小时。知道如何让查询正常工作吗？注意：每个示例输出都包含小提琴。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T19:16:49.103

将您的查询更改为：

```
 SELECT u.user_id, us.orig_posts_count, us.sugg_posts_count,
    IF(us.user_id='4', 'posterview',
      COUNT(CASE
        WHEN p.sugg_by='2' AND (p.private='0' OR pv.post_id IS NOT NULL)
        THEN 1
        ELSE NULL
      END)) AS display_orig_posts_count,
    IF(us.user_id='4', 'posterview',
      COUNT(CASE
        WHEN p.sugg_by<>'2' AND (p.private='0' OR pv.post_id IS NOT NULL)
        THEN 1
        ELSE NULL
      END)) AS display_sugg_posts_count
    FROM users AS u
         JOIN user_stats AS us ON u.user_id=us.user_id
         JOIN posts AS p ON p.user_id=us.user_id
         LEFT JOIN private AS pv ON pv.post_id=p.post_id AND pv.authorized_user_id='4'
   WHERE u.user_id='2'
GROUP BY u.user_id, us.orig_posts_count, us.sugg_posts_count 
```

**详细说明**

在您的第一个查询中，正在计算以下帖子（有原因）：

```
display_orig_posts_count = 3:
  post_id=2: pv.post_id is not null (fails ISNULL() check)
  post_id=4: pv.post_id is not null (fails ISNULL() check)
  post_id=6: p.private='0'          (fails p.private='1' check)

display_sugg_posts_count = 5:
  post_id=2: pv.post_id is not null (fails ISNULL() check)
  post_id=3: p.sugg_by='2'          (fails p.sugg_by<>'2' check)
  post_id=4: pv.post_id is not null (fails ISNULL() check)
  post_id=5: p.sugg_by='2'          (fails p.sugg_by<>'2' check)
  post_id=6: p.private='0'          (fails p.private='1' check) 
```

在您的第二个查询中，正在计算以下帖子（有原因）：

```
display_orig_posts_count = 1:
  post_id=2: pv.post_id is not null (fails ISNULL() check)

display_sugg_posts_count = 3:
  post_id=2: pv.post_id is not null (fails ISNULL() check)
  post_id=3: p.sugg_by='2'          (fails p.sugg_by<>'2' check)
  post_id=5: p.sugg_by='2'          (fails p.sugg_by<>'2' check)' 
```

在您的第三个查询中，正在计算以下帖子（有原因）：

```
display_orig_posts_count = 2:
  post_id=4: pv.post_id is not null (fails ISNULL() check)
  post_id=6: p.private='0'          (fails p.private='1' check)

display_sugg_posts_count = 2:
  post_id=4: pv.post_id is not null (fails ISNULL() check)
  post_id=6: p.private='0'          (fails p.private='1' check) 
```

我们要计算什么：

```
display_orig_posts_count = 1:
  post_id=2: because p.sugg_by=2, p.private=1 AND (is_authorized)

display_sugg_posts_count = 3:
  post_id=4: because p.sugg_by<>'2', p.private=1 AND (is_authorized)
  post_id=6: because p.sugg_by<>'2', p.private=0 
```

所以让我们清理一下：

1.  **`p.user_id='2'`从 `CASE1 语句中删除**

    无论如何，这始终是正确的，因为您`user_id='2'`根据您的`JOIN`陈述将帖子限制为仅包含这些帖子的帖子。

2.  **使用肯定性检查**

    在 的情况下`display_orig_posts_count`，我们*想要*某些东西。与其试图过滤掉我们不想要的东西，不如明确地寻找我们想要的*东西*：

    ```
     COUNT(CASE
       WHEN p.sugg_by='2' AND (p.private='0' OR pv.post_id IS NOT NULL)
       THEN 1
       ELSE NULL
     ) 
    ```

    在 的情况下`display_sugg_posts_count`，让我们再次明确地寻找那些东西：

    ```
     COUNT(CASE
       WHEN p.sugg_by<>'2' AND (p.private='0' OR pv.post_id IS NOT NULL)
       THEN 1
       ELSE NULL
     ) 
    ```

3.  **使用`GROUP BY`聚合函数时使用**

    `LIMIT 1`如果您正确分组聚合函数，您也不应该需要。每个用户只应返回一行。

# javascript - d3.js 包布局圆圈重叠

> ID：14790340
> 
> 赞同：4
> 
> 时间：2013-02-09T16:50:00.950
> 
> 标签：javascript, d3.js, overlap, circle-pack

我对 d3.js 包布局有疑问。圆圈重叠，我不知道为什么......

我使用了这个例子中的代码：

[http://mbostock.github.com/d3/talk/20111116/pack-hierarchy.html](http://mbostock.github.com/d3/talk/20111116/pack-hierarchy.html)

![在此处输入图像描述](../Images/5ff66cf0a9d1cb583f46c70f20723d2a.png)

这就是我的工作：

[http://projekty.bron.it/d3-circles-all/](http://projekty.bron.it/d3-circles-all/)

如您所见，重叠使图表无法使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-19T11:42:54.623

对我有帮助的是：通过排序更改流程顺序

所以你在哪里

```
var pack = d3.layout.pack()
.size([r,r])
.value(function(d) { return d.size; }); 
```

添加

```
var pack = d3.layout.pack()
.sort(d3.descending)
.size([r,r])
.value(function(d) { return d.size; }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-16T19:57:47.823

我尝试实现相同的圆形包装示例并且也有重叠的圆圈。对我来说，问题是由于数据父节点有 0 个子节点和大小为 0。一旦我将具有空子数组的父节点更改为格式正确的叶子，问题就消失了。

数据结构之前的不良重叠：

```
root = {name:"root",
    children:[
       {name:"badchildlessparent", children:[]},
       {name:"parentnodewithchild", children:[{name:"a leaf",size=50}]}
     ]
} 
```

数据结构后很好地打包：

```
root = {name:"root",
    children:[
        {name:"fixedit_now_child", size=1} ,
        {name:"parentnodewithchild", children:[{name:"a leaf",size=50}]}
    ]
} 
```

# mysql - MySQL 过程在所有表上动态创建删除触发器

> ID：14790348
> 
> 赞同：1
> 
> 时间：2013-02-09T16:50:30.907
> 
> 标签：mysql, stored-procedures, triggers

任务是在所有表上创建删除日志记录，但不增加现有表或将来创建的表的开销。也就是说，在数据库升级时： 1\. 循环数据库中所有表的信息模式 2\. 在循环中，删除现有触发器以进行删除（因此我们可以在需要时更新触发器逻辑） 3\. 再次在循环中，重新创建删除触发器

调查存储过程的限制，我想我遇到了一些事情。这是我正在寻找的一个循环：

```
DELIMITER $$

DROP PROCEDURE IF EXISTS create_delete_triggers $$

CREATE PROCEDURE create_delete_triggers()
BEGIN
   DECLARE done int default false;
   DECLARE tblname CHAR(50);

   DECLARE cur1 CURSOR FOR SELECT TABLE_NAME FROM INFORMATION_SCHEMA.tables WHERE TABLE_SCHEMA = 'app_db' AND TABLE_NAME LIKE 'obj%' ;
   DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;

   OPEN cur1;

   deleteloop: LOOP
        FETCH cur1 INTO tblname;
        IF done THEN
            LEAVE deleteloop;
        END IF;
        -- ANY SORT of function I can do here to set triggers on these 
        SELECT tblname, DATABASE();
    END LOOP;

    CLOSE cur1;
END $$

DELIMITER ; 
```

首先，其中包含准备好的语句的存储过程看起来像是[不行](http://dev.mysql.com/doc/refman/5.6/en/stored-program-restrictions.html)，这似乎是一个阻碍。在理想情况下，我的游标块将执行一个准备好的语句来执行此操作。

```
DELIMITER $$ 

CREATE TRIGGER del_row_table_name AFTER DELETE ON  tblname 
FOR EACH ROW 
BEGIN 
    -- use old row to marshall a row to store its primary key, time of deletion, and tablename
END $$ 

DELIMITER ; 
```

所以基本上，我正在四处寻找 MySQL 中没有引起我注意来解决这个问题的任何花哨的东西。另一方面，很高兴知道它无法完成，我会接受我必须在开发团队中引入开销。

# php - 以用户可读格式返回从时间戳到现在的时间差

> ID：14790350
> 
> 赞同：0
> 
> 时间：2013-02-09T16:50:41.857
> 
> 标签：php, time

每次用户执行特殊操作时，我都有一个脚本保存时间戳（使用 time() 函数）。

我想以易于阅读的用户方式在页面上显示用户多久以前执行此操作。我目前得到它来显示它大约是多少小时前，但我希望它以如下方式返回：

1天5小时30分钟...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T16:56:30.110

为了实现你想要的，你可以简单地做

```
$target = strtotime("Feb 7 2013 2:15 AM");
$now = time();
$diff = $now - $target;
$days = floor(($diff)/24/60/60);
$hours = floor(fmod($diff, 24*60*60)/60/60);
$minutes = floor(fmod(fmod($diff, 24*60*60),60*60)/60);
echo $days . " days " . $hours . " hours " . $minutes . " minutes"; // e.g. "2 days 14 hours 54 minutes" 
```

更通用的解决方案

```
function timeago($timestamp) {

    // Predefine variables
    $timeago = '';
    $past = FALSE;
    $future = FALSE;
    $prefixAgo = NULL;
    $prefixFromNow = NULL;
    $suffixAgo = "ago";
    $suffixFromNow = "from now";
    $wordSeperator = " ";

    // Current time
    $current = time();

    // Seconds ago
    $seconds = abs($current - $timestamp);

    // Determine whether the time is in the future or the past
    if ($current >= $timestamp) {
        $past = TRUE;
    } else {
        $future = TRUE;
    }

    // Calculate time ago in different formats
    $minutes = $seconds / 60;
    $hours = $minutes / 60;
    $days = $hours / 24;
    $months = $days / 30;
    $years = $days / 365;

    // Format time ago according to calculated time
    if      ($seconds < 45) { $timeago = "less than a minute"; }
    else if ($seconds < 90) { $timeago = "about a minute"; }
    else if ($minutes < 45) { $timeago = round($minutes) . " minutes"; }
    else if ($minutes < 90) { $timeago = "about an hour"; }
    else if ($hours < 24)   { $timeago = "about " . round($hours) . " hours"; }
    else if ($hours < 42)   { $timeago = "a day"; }
    else if ($days < 30)    { $timeago = round($days) . " days"; }
    else if ($days < 45)    { $timeago = "about a month"; }
    else if ($days < 365)   { $timeago = round($months) . " months"; }
    else if ($years < 1.5)  { $timeago = "about a year"; }
    else                    { $timeago = round($years) . " years"; }

    // Append prefix and suffix
    if (!empty($prefixAgo))     { $prefixAgo        = $prefixAgo . $wordSeperator; }
    if (!empty($suffixAgo))     { $suffixAgo        = $wordSeperator . $suffixAgo; }
    if (!empty($prefixFromNow)) { $prefixFromNow    = $prefixFromNow . $wordSeperator; }
    if (!empty($suffixFromNow)) { $suffixFromNow    = $wordSeperator . $suffixFromNow; }
    if ($past)                  { $timeago = $prefixAgo . $timeago . $suffixAgo; }
    if ($future)                { $timeago = $prefixFromNow . $timeago . $suffixFromNow; }

    // Return results
    if (!empty($timeago)) {
        return $timeago;
    } else {
        return NULL;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T16:55:58.157

```
echo date('Y-m-d', time()); 
```

显示 2013-02-09
还可以查看[manual](http://php.net/manual/en/function.date.php) , date('Ymd H:i:s', time()); 将输出 2013-02-09 17:57:30

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T16:57:30.313

试试看：

```
$diff = date_diff($lastaccess, new DateTime(date('d-m-Y'));
echo $diff->format('Last access on: %s seconds %d days %m months and %y years ago')}; 
```

# c++ - 这样的初始化列表在 C++11 中是否合法？

> ID：14790354
> 
> 赞同：4
> 
> 时间：2013-02-09T16:50:44.417
> 
> 标签：c++, vector, c++11, initialization, clang

我阅读了 C++ 入门第 5 版，它说最新的标准支持列表初始化程序。

我的测试代码是这样的：

```
#include <iostream>
#include <string>
#include <cctype>
#include <vector>
using std::cin;
using std::cout;
using std::endl;
using std::string;
using std::vector;
using std::ispunct;
int main(int argc, char *argv[])
{
    vector<int> a1 = {0,1,2};
    vector<int> a2{0,1,2}; // should be equal to a1
    return 0;
} 
```

然后我使用 Clang 4.0：

```
bash-3.2$ c++ --version
Apple clang version 4.0 (tags/Apple/clang-421.0.60) (based on LLVM 3.1svn)
Target: x86_64-apple-darwin12.2.0
Thread model: posix 
```

并像这样编译它：

```
c++ -std=c++11 -Wall    playground.cc   -o playground 
```

但是，它抱怨这样：

```
playground.cc:13:17: error: no matching constructor for initialization of
      'vector<int>'
    vector<int> a1 = {0,1,2};
                ^    ~~~~~~~

 /usr/include/c++/4.2.1/bits/stl_vector.h:255:9: note: candidate constructor
  [with _InputIterator = int] not viable: no known conversion from 'int'
  to 'const allocator_type' (aka 'const std::allocator<int>') for 3rd
  argument;
    vector(_InputIterator __first, _InputIterator __last,
    ^
/usr/include/c++/4.2.1/bits/stl_vector.h:213:7: note: candidate constructor
  not viable: no known conversion from 'int' to 'const allocator_type'
  (aka 'const std::allocator<int>') for 3rd argument;
  vector(size_type __n, const value_type& __value = value_type(), 
```

我检查了[Clang 的 C++ 支持状态，](http://clang.llvm.org/cxx_status.html)看起来它应该已经支持 Clang 3.1 中的 Initializer 列表。但是为什么我的代码不起作用。有人对此有想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T16:59:06.823

该代码是合法的，问题在于您的编译器+stdlib 设置。

Apple 的 Xcode 附带 GNU C++ 标准库 libstdc++ 的古老版本 4.2.1（有关详细信息，请参阅[https://stackoverflow.com/a/14150421/981959](https://stackoverflow.com/a/14150421/981959)），并且该版本早于 C++11 多年，因此它`std::vector`没有初始化列表构造函数。

要使用 C++11 功能，您需要安装和使用更新的 libstdc++，或者告诉 clang 使用 Apple 自己的 libc++ 库，您可以使用该`-stdlib=libc++`选项执行此操作。

# objective-c - 如何跟踪 UIWebView 的更改 url

> ID：14790359
> 
> 赞同：0
> 
> 时间：2013-02-09T16:51:06.273
> 
> 标签：objective-c, cocoa-touch

我遇到了 UIWebView 的问题。首先我从请求中加载网页。当我点击此网页中的任何链接时，UIWebView 会重定向到此链接。如何跟踪 UIWebView 的 url 变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T17:11:07.527

您应该定义`webView:shouldStartLoadWithRequest:`委托方法，例如：

```
- (BOOL)webView:(UIWebView*)webView shouldStartLoadWithRequest:(NSURLRequest*)request navigationType:(UIWebViewNavigationType)navigationType {

if ([[[request URL] scheme] isEqual:@"http"]) {
     ...

    }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-23T11:30:58.373

使用这个 UIWebView 的委托

```
-(BOOL) webView:(UIWebView *)inWeb shouldStartLoadWithRequest:(NSURLRequest *)inRequest   navigationType:(UIWebViewNavigationType)inType
{
    NSLog(@"Redirecting to URL: %@", inRequest.URL.absoluteString);
    return YES;
} 
```

# windows - 使用 hkcu...run 或任务调度程序启动程序时无法在 Windows 7 上写入文件

> ID：14790360
> 
> 赞同：0
> 
> 时间：2013-02-09T16:51:07.190
> 
> 标签：windows, uac, file-handling

我正在创建一个在启动时运行的程序。我只是写一个文件。

我已经将包含文件夹的权限设置为：完全控制=允许列出的所有用户和组。

我也尝试过使用任务调度程序，以提升的权限运行。

但是没有一个工作...

尽管在程序正常运行时（通过单击资源管理器中的文件）它可以正常工作（文件已写入）。

# java - 可以查看在 java 中发送数据包需要多长时间

> ID：14790366
> 
> 赞同：0
> 
> 时间：2013-02-09T16:52:02.603
> 
> 标签：java, sockets

我用java做了一个程序。我使用套接字让不同的程序相互通信。我的问题是：是否有可能以毫秒或更精确的方式查看发送数据包所需的时间。所以从 Socket.writeObject(Object) 到 Socket.readObject(Object)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T16:57:42.903

您可以使用这种代码来获取经过的时间：

```
long startTime = new Date().getTime();
Socket.writeObject(Object)
...
Socket.readObject(Object)
long endTime = new Date.getTime();
long difference = endTrim-startTime; //difference in milliseconds 
```

如果您想从服务器获取时间，您需要向服务器发送请求，并让服务器在响应中发回时间。这可以通过 Web 服务或简单的 HTTP 请求来完成。

# mysql - (my)SQL only 解决方案，用于显示议程系统中的可用时间段

> ID：14790371
> 
> 赞同：0
> 
> 时间：2013-02-09T16:52:22.180
> 
> 标签：mysql, database, postgresql, database-design

**描述** 我正在制作一个带有（多个）议程的议程系统，您可以在其中预订一个可变时间段（10/15/20 或 30 分钟）在选定的时间段内（例如上午 9:00 到上午 11:00）周一和上午 10:30 至下午 3:00）

当然，我可以在 PHP 中执行此操作，并轮询约会和可用性表，以便为每个显示的每个日期提供可用的时间段，但有些听起来有点服务器密集型。所以我想知道是否有一种方法可以生成一个显示时隙和可用性元组的 mySQL 结果关系......

**数据库/表设置** 这是我认为必要的表设置。

***约会*** `holds the appointments already made`
ID | 整数`unique id`
议程_id | 诠释`unique id identifying the agenda`
开始 | 日期时间`start of the appointment`
结束 | date_time`end of the appointment`
*一些更具描述性的字段*

**可用性** `when are there which time slots available`
议程_id | int `identifying which agenda`
day_of_the_week | 整数`which day, eg 1=monday`
开始时间 | 结束时间 `e.g. 09:00:00` | 时间`e.g. 11:00:00`
time_slot | 整数`how long are the time slots? e.g. 10minutes`

（备注：
如果需要time_slots字段也可以硬编码；
系统运行在MySQL数据库上，如果需要我们可以切换到postgresql
）

**期望的结果** 给定一个日期`2013-02-21`和一个议程 ID `1`（如果需要，还有时间段`15`）和一个工作日，从 8:00 到 18:00；
如何创建 mysql 查询、视图或存储过程以生成下表/关系：

```
date       | 8:00 | 8:15 | 8:30 | 8:45 | 9:00 | 9:15 | ..... | 17:15 | 17:30 | 17:45 |
2013-02-21 |   0  |  0   |   0  |  0   |  1   |   2  | ..... |   2   |   2   |   1   | 
```

其中：
0 = 不可预订
1 = 有空，您可以预订此时段
2 = 不可预订，已预约

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:18:26.543

如果您决定切换到 PostgreSQL，您可能需要确保您使用的是 9.2 版（或更高版本），以便您可以充分利用[范围类型](http://www.postgresql.org/docs/current/interactive/rangetypes.html)和[排除约束](http://www.postgresql.org/docs/current/interactive/sql-createtable.html#SQL-CREATETABLE-EXCLUDE)。GiST 索引对此类数据非常有用，但排除约束会自动创建一个，因此您可能不需要显式声明一个。如果您想列出某个范围内的可用空缺时间，则可以使用[generate_series](http://www.postgresql.org/docs/current/interactive/functions-srf.html)函数将候选时间与现有计划相结合，[`NOT x && y`](http://www.postgresql.org/docs/9.2/interactive/functions-range.html#RANGE-OPERATORS-TABLE)以过滤掉不可用的时间。

我不确定 MySQL 中的等价物是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:03:27.567

您想要调整约会并与可用性进行比较。这是一个带有条件聚合的连接和聚合查询。以下是思路：

```
select agendaId, const.thedate,
       sum(case when thedate + interval 8 hour + interval 0 minute between ap.start and ap.end
                then 1 else 0
           end) as "8:00",
       sum(case when thedate + interval 8 hour + interval 15 minute between ap.start and ap.end
                then 1 else 0
           end) as "8:15",
       . . .
from (select date('2013-02-21' ) as thedate) const cross join
     Availability a left outer join
     Appointments ap
     on a.AgendaId = ap.AgendaId and
        const.day_of_the_week = weekday(const.thedate)        
where date(ap.start) = const.thedate 
group by AgendaId 
```

# javascript - 如何在 Ext 网格分组标题中显示不同字段的值？

> ID：14790372
> 
> 赞同：8
> 
> 时间：2013-02-09T16:52:25.440
> 
> 标签：javascript, extjs, grid, extjs4, grouping

我有一个我想按字段分组的 Ext.grid.Panel，但要在分组标题中显示不同的字段。例如，如果我的模型有`status_id`和`status_name`字段，我想按 分组`status_id`，但`status_name`在组标题中显示 。

我玩过这个`groupHeaderTpl`选项，但到目前为止还没有运气。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-11T05:14:06.373

您可以通过执行调试 grouperHeaderTpl 值

```
groupHeaderTpl:'{[console.log(values)]}' 
```

这样您就可以观察所有可能的值并选择正确的路径来获得您正在寻找的值。在这种情况下，您需要做的是

```
groupHeaderTpl: '{[values.rows[0].data.status_name]}' 
```

在这里你可以找到整个例子

```
/* Sample Data */
var data = [ 
         { "status_id": 1, "status_name": "Pending"}, 
         { "status_id": 2, "status_name": "Ready"}, 
         { "status_id": 3, "status_name": "Processing"}, 
         { "status_id": 4, "status_name": "Unavailable"},
         { "status_id": 5, "status_name": "Ready"}, 
       ];

/* Model */
Ext.define("StatusModel", {
  extend: 'Ext.data.Model',
  fields: ['status_id', 'status_name']
});

/* Store */
Ext.create('Ext.data.Store', {
storeId:'statusStore',
model: "StatusModel",
groupField: 'status_id',
data: data,
proxy: {
    type: 'memory',
    reader: {
        type: 'json'
    }
}
});

/* Grouping Feature */
var groupingFeature = Ext.create('Ext.grid.feature.Grouping',{
   groupHeaderTpl: '{[values.rows[0].data.status_name]}'
});

/* Grid Panel */
Ext.create('Ext.grid.Panel', {
title: 'Status',
store: Ext.getStore('statusStore'),
columns: [
    { text: 'Id',     dataIndex: 'status_id' },
    { text: 'Name', dataIndex: 'status_name', flex: 1}
],
features: [groupingFeature],
renderTo: Ext.getBody()
}); 
```

[http://jsfiddle.net/alexrom7/shZLf/1/](http://jsfiddle.net/alexrom7/shZLf/1/)

# ruby - 解决二维哈希的问题

> ID：14790379
> 
> 赞同：1
> 
> 时间：2013-02-09T16:52:58.543
> 
> 标签：ruby, hash

我正在尝试引用二维哈希。有谁知道为什么下面不会输出`true`以及如何更改它以使其输出？

```
grid = Hash.new(false)
grid [[3,2]] = true
current_position = [3,2]
puts grid[[current_position]] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T17:01:48.333

哈希中的键`[3,2]`等效于`current_position`，因此要访问内容，它是：

```
puts grid[current_position] 
```

# ruby - Ruby 机架中间件过滤堆栈中引发的所有异常

> ID：14790380
> 
> 赞同：3
> 
> 时间：2013-02-09T16:53:09.683
> 
> 标签：ruby, exception-handling, rack, middleware

嗨，我刚刚有一个关于如何使用 ruby​​ rack 适当地管理异常处理的问题。

我目前正在使用 Sinatra/Rack 构建一个轻量级 API，并且每条路由都可能通过异常（例如缺少参数、无效格式等）。我希望能够捕获所有这些异常并在中间件应用程序中处理它们。我不想在每个 get、post、put、delete 块中捕获或“拯救”（例如 post '/me'）

我尝试了类似的方法，其中 ExceptionHandler 位于机架堆栈的顶部。

我错过了什么？

```
class Api::ExceptionHandler

  def initialize(application)
    @application = application
  end

  def call(environment)
    @application.call environment
  rescue Api::MissingParameterError => parameter
    [ 400, { }, [ "parameter #{parameter} missing" ] ]
  end

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-08T10:45:29.677

自 Sinatra 1.4 版本（Padrino 从 0.11 版本开始使用）以来，错误 http 状态定义发生了变化。这是`sinatra-1.4.2/lib/sinatra/base.rb`与“handle_exception”相关的一部分！功能

```
 if boom.respond_to? :http_status 
   status(boom.http_status)
 elsif settings.use_code? and boom.respond_to? :code and boom.code.between? 400, 599  
   status(boom.code)
 else
   status(500)
 end 
```

因此，如果您的异常类具有“http_status”方法，则从中定义错误状态。由于这个原因，只有服务器错误（代码从 500 到 599 的错误）可以到达中间件，具体取决于“raise_errors”和“show_exceptions”设置（下面是相同的“handle_exception！”函数）：

```
 return res if res or not server_error?
  raise boom if settings.raise_errors? or settings.show_exceptions? 
```

好消息，默认错误状态为 500。因此，如果您确实需要异常来传播中间件，只需**阻止您的异常类响应“http_status”方法**或使用 500 到 599 以来的 http_status 代码。但对于问题中的示例，最好的方法是使用`error`Max 描述的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T18:04:54.243

好的，正如 Catnapper 所说，上面的代码应该可以工作！我没有提到的是我所有的中间件都继承了一个继承 Sinatra::Base 的类。

并且 Sinatra 有自己的异常处理程序，可以这样修改

```
set :raise_errors, false
set :show_exceptions, false 
```

这就是您在 sinatra 中编写异常处理程序的方式（对于问题中的示例）：

```
error Api::MissingParameterError do |parameter|
  status 400
  headers { }
  body "parameter #{parameter} missing"
end 
```

# android - 来自 Google Cloud Messaging 的消息需要多长时间才能到达设备

> ID：14790382
> 
> 赞同：6
> 
> 时间：2013-02-09T16:53:17.673
> 
> 标签：android, google-cloud-messaging

来自 Google Cloud Messaging 的消息需要多长时间才能到达设备？

我想将我的门铃与我的 Android 应用程序相关联。我在具有 Internet 连接的 RaspberryPi 上收到的门铃。我可以连接到 Google Cloud Messaging，但消息会很快到达我的 Android 设备吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-09T16:58:30.747

如果手机处于活动状态并且具有稳定的互联网连接，则几乎立即（1-2 秒）。但是没有100%的保证。如果手机处于睡眠状态，则可能需要一些时间。如果您忘记支付运营商账单，它将永远不会到来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T13:08:11.687

在生产应用程序中使用了几个月后，我开始注意到它并不那么可靠。我注意到最多可能需要 20 分钟才能收到通知。我觉得我通过发送 SMS 文本消息获得了更好的速度和可靠性。

是的，它通常会在几秒钟内出现。但有时可能需要一段时间。

# asp.net-mvc - 带有 .aspx 引擎的 ASP.NET MVC DisplayModeProvider

> ID：14790386
> 
> 赞同：0
> 
> 时间：2013-02-09T16:53:43.070
> 
> 标签：asp.net-mvc, mobile

我正在使用 ASPX 引擎（不是 RAZOR！）和 Site.Master 作为母版页的 MVC-4 项目。

现在我的任务是为移动设备启用此站点。找到我知道的所有可用信息后，我需要使用 Razor 执行以下任务

1.  在应用程序启动中添加 DisplayModeProvider。
2.  创建 _Layout.Phone.cshtml 并添加 jQuery 移动支持。
3.  创建手机支持的视图，如 Index.Phone.cshtml 并使用 _Layout.Phone.cshmtl 作为母版页。

现在我的问题是如何使用 ASPX 引擎为移动设备启用站点。

我创建了 Site.Phone.Master 和 Index.Phone.aspx 但它只呈现默认网页视图而不是电话视图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:42:06.173

您可以从为移动浏览器创建 MasterPage ( `~/Views/Shared/Site.Mobile.Master`) 开始：

```
<%@ Master Language="C#" Inherits="System.Web.Mvc.ViewMasterPage" %>
<!DOCTYPE html>
<html lang="en">
<head runat="server">
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    This is the mobile master page

    <asp:ContentPlaceHolder ID="MainContent" runat="server" />
</body>
</html> 
```

然后有`~/Views/Home/Index.Mobile.aspx`一个将使用此母版页的移动视图 ( )：

```
<%@ Page 
    Language="C#" 
    MasterPageFile="~/Views/Shared/Site.Mobile.Master" 
    Inherits="System.Web.Mvc.ViewPage" 
%>

<asp:Content ID="indexContent" ContentPlaceHolderID="MainContent" runat="server">
    This is the mobile view
</asp:Content> 
```

好的，现在剩下的就是在你的 : 中插入显示模式`Application_Start`：

```
Func<HttpContextBase, bool> contextCheckDelegate = ctx =>
{
    // Here you could use the ctx variable which represents the HttpContextBase
    // in order to test the UserAgent of the Request and decide whether it is coming
    // from a mobile device or not and return true or false respectively which is what
    // will determine if your .Mobile masterpage and view will be used for this request
    if (IsMobile)
    {
        return true;
    }         
    return false;
};
DefaultDisplayMode mobileMode = new DefaultDisplayMode("Mobile");
mobileMode.ContextCondition = contextCheckDelegate;
DisplayModeProvider.Instance.Modes.Insert(0, mobileMode); 
```

您当然可以拥有更具体的移动视图，例如 iPhone、iPad ……您只需要调整委托内部使用的条件，即检查用户代理。

# javascript - 如果其他选择发生变化，AngularJS 删除并添加选择框选项

> ID：14790388
> 
> 赞同：4
> 
> 时间：2013-02-09T16:53:47.600
> 
> 标签：javascript, angularjs

我正在寻找一个类似的解决方案来解决之前使用以下代码解决的[问题：](https://stackoverflow.com/questions/9979025/remove-add-select-box-option-if-other-selection-changes)

[http://jsfiddle.net/yLCVf/1/](http://jsfiddle.net/yLCVf/1/)

这是我需要从上面的 JSFiddle 中使用的 JS：

```
$(document).ready(function () {
    $('select.hello').change(function () {
        $('select.hello option').attr('disabled', false);
        $('select.hello').each(function() {
            var val = $(this).find('option:selected').val();
            if (!val) return;
            $('select.hello option').filter(function() {
                return $(this).val() == val;
            }).attr('disabled', 'disabled');
        });
    });
}); 
```

但是，我需要在 AngularJS 中执行此操作，并且作为 AngularJS 的新手，我有点难以理解如何将一些 JS “转换”为 AngularJS Seed，只需要一点指导。

本质上，我有 3 个选择下拉列表，它们都包含相同的列表（这是一个人员列表），当用户为第一个选择选择名称时，我需要将该名称从其他 2 个选择选项中删除。上面的 JSfiddle 完美地展示了这一点，但我只需要了解我应该如何将此代码放入 AngularJS 中。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-10T00:13:25.290

这是一个演示这样做的一种方法的小提琴：[http://jsfiddle.net/Zv5NE/4/](http://jsfiddle.net/Zv5NE/4/) 它不像 jQuery 示例那样禁用它们，它只是将它们从其他列表中删除。如果您想禁用它们（我认为），您需要使用指令以正确的角度方式进行操作。您可能还想查看文档：[http ://docs.angularjs.org/api/ng.directive:select](http://docs.angularjs.org/api/ng.directive:select)

这是一个片段：

```
 <select 
    ng-model="selectname1" 
    ng-options="item as item.name for item in friends|filter:filter2|filter:filter3" >
    <option value="">- select -</option>
  </select>

   <select 
     ng-model="selectname2" 
     ng-options="item as item.name for item in friends|filter:filter1|filter:filter3" >
     <option value="">- select -</option>
   </select> 
```

首先使用 ng-model 设置选择绑定的值。这告诉模型（在控制器中定义）选择了什么，它也可以用来设置默认值。然后使用 ng-options 指令来告诉显示哪些选项以及如何过滤它们。这些选项被定义为控制器中的一个数组。所以语句“item as item.name for item in friends”意味着对数组friends中的每个项目使用带有标签item.name的item的值。选项和过滤器在模型中定义。

在 selectname2 中，它使用看起来像“friends|filter:filter1”的朋友过滤器。filter1 是控制器中定义的函数，用于确定要显示的项目。对于 id 与 selectname1 匹配的任何项目，此过滤器仅返回 false，否则返回 true。

```
function HelloCntl($scope) {
    $scope.selectname1={};    
    $scope.selectname2={};    
    $scope.selectname3={};

    $scope.filter1 = function(item){
      return (!($scope.selectname1&&$scope.selectname1.id)||item.id !=$scope.selectname1.id);
    };

    $scope.filter2 = function(item){
      return (!($scope.selectname2&&$scope.selectname2.id)||item.id!=$scope.selectname2.id);
    };
    $scope.filter3 = function(item){
      return (!($scope.selectname3&&$scope.selectname3.id)||item.id !=$scope.selectname3.id);
    };
    $scope.friends = [
      {
        id:1,name: 'John',
        phone: '555-1276'},
      {
        id:2,name: 'Mary',
        phone: '800-BIG-MARY'},
      {
        id:3,name: 'Mike',
        phone: '555-4321'},
      {
        id:4,name: 'Adam',
        phone: '555-5678'},
      {
        id:5,name: 'Julie',
        phone: '555-8765'}
    ];
} 
```

希望有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T00:28:23.847

这是您正在寻找的 plunker 示例。选择列表会根据您的其他选择自动更改。

[http://plnkr.co/edit/yFrYQ1ql9a1x9jd9yGv0](http://plnkr.co/edit/yFrYQ1ql9a1x9jd9yGv0)

您可以概括 n 个列表，然后遍历所有列表以进行任何更改。

```
 <!DOCTYPE html>
<html ng-app="angularjs-starter">

  <head lang="en">
    <meta charset="utf-8">
    <title>Custom Plunker</title>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular.min.js"></script>
    <script src="app.js"></script>
  </head>

  <body ng-controller="MainCtrl">
    <h1>Hello {{name}}</h1>
    <p>
      First List: <select ng-change="onChange()" ng-options='person.name for person in  first.list | filter:{selected: false}' ng-model='first.option'><option value="">-- pick one --</option>  </select> {{first.option.name}}
    </p>
    <p>
      Second List: <select ng-change="onChange()" ng-options='person.name for person in  second.list | filter:{selected: false}' ng-model='second.option'><option value="">-- pick one --</option></select> {{second.option.name}}
    </p>
    <p>
      Third List: <select ng-change="onChange()" ng-options='person.name for person in  third.list | filter:{selected: false}' ng-model='third.option'><option value="">-- pick one --</option></select> {{third.option.name}}
    </p>
    </select>
  </body>

</html> 
```

角码

```
var app = angular.module('angularjs-starter', []);

app.controller('MainCtrl', function($scope) {
  $scope.name = 'World';
  $scope.masterlist = 
      [ {name: 'John', selected: false}, {name: 'Bill', selected: false},
        {name: 'Smith', selected: false}, {name: 'Alex', selected: false},
        {name: 'Martin', selected: false}, {name: 'James', selectes: false}];

  $scope.first = {list: angular.copy($scope.masterlist), option: null};
  $scope.second = {list: angular.copy($scope.masterlist), option: null};
  $scope.third = {list: angular.copy($scope.masterlist), option: null};

  $scope.onChange = function(){
    $scope.enableAllOptions($scope.first.list);
    $scope.enableAllOptions($scope.second.list);
    $scope.enableAllOptions($scope.third.list);

    $scope.disableOptions($scope.first.list, $scope.second.list, $scope.second.option);
    $scope.disableOptions($scope.first.list, $scope.third.list, $scope.third.option);

    $scope.disableOptions($scope.second.list, $scope.first.list, $scope.first.option);
    $scope.disableOptions($scope.second.list, $scope.third.list, $scope.third.option);

    $scope.disableOptions($scope.third.list, $scope.first.list, $scope.first.option);
    $scope.disableOptions($scope.third.list, $scope.second.list, $scope.second.option);
  };

  //Enable all options by default.
  $scope.enableAllOptions = function(arr)
  {
    for(var i=0;i<arr.length;i++)
    {
      arr[i].selected = false;
    }
  };

  //Function that takes the destinationArr , Source Arry , and Source selected item
  $scope.disableOptions = function(destArr, srcArr, srcItem)
  {
    if(srcItem !== null)
    {
      var index = srcArr.indexOf(srcItem);
      if(index >=0) destArr[index].selected = true;
    }
  };

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-23T18:43:44.687

```
$scope.filesList    = FileService.getFiles();
$scope.listsList    = [];
$scope.items = ['settings', 'home', 'other'];
$scope.selection = $scope.items[0];
//esse scope file options mudará depois vou pegar diretamente do banco.
$scope.filesOptions = [
    {
        'filetype'  : 1,
        'filelabel' : 'OPÇÃO A',
        'selected'  : false
    },
    {
        'filetype'  : 2,
        'filelabel' : 'OPÇÃO B',
        'selected'  : false
    },
    {
        'filetype'  : 3,
        'filelabel' : 'OPÇÃO C',
        'selected'  : false
    },
    {
        'filetype'  : 4,
        'filelabel' : 'OPÇÃO D',
        'selected'  : false
    },
    {
        'filetype'  : 5,
        'filelabel' : 'OPÇÃO E',
        'selected'  : false
    }
];

 for (index = 0; index < $scope.filesList.length; ++index) {

$scope.listsList.push({list: angular.copy($scope.filesOptions), option: null});}

$scope.onChange = function(){
    //tgt.selected = true;
    for (var i = 0; i < $scope.listsList.length; ++i) {
        var current = $scope.listsList[i];
        $scope.enableAllOptions(current.list);
        for (var j = 0; j < $scope.listsList.length; ++j) {
            if(current != $scope.listsList[j]){
                $scope.disableOptions(current.list, $scope.listsList[j].list, $scope.listsList[j].option);
            }
        }
    }
};
//Enable all options by default.
$scope.enableAllOptions = function(arr){ for(var i=0;i<arr.length;i++){ arr[i].selected = false;} };
//Function that takes the destinationArr , Source Arry , and Source selected item
$scope.disableOptions = function(destArr, srcArr, srcItem) {
    if(srcItem !== null) {
        var index = srcArr.indexOf(srcItem);
        if(index >=0) destArr[index].selected = true;
    }
};

<div class="col-md-9"><select ng-change="onChange()" ng-options='op.filelabel for op in  listsList[$index].list | filter:{selected: false}' ng-model='listsList[$index].option'> 
```

选一个

# google-chrome-extension - 从 chrome.tabs.executeScript 返回值

> ID：14790389
> 
> 赞同：14
> 
> 时间：2013-02-09T16:53:47.890
> 
> 标签：google-chrome-extension

在 popup.js 中，我使用以下代码显示当前选项卡的某个 div id 内的所有文本 - 并显示在警报中。我想知道如何将 div 文本保存到 popup.js 中的变量中？

```
chrome.tabs.executeScript(null,code:"alert(document.getElementById(\"DIVid\").innerText.split(' '))"}); 
```

以上工作正常，但是当我尝试这个时：

```
var getText = chrome.tabs.executeScript(null,code:"document.getElementById(\"DIVid\").innerText.split(' ')"}); 
```

或者

```
var getText = chrome.tabs.executeScript(null,code:"document.getElementById(\"DIVid\").innerText.split(' ')"},function(response){return response}); 
```

没有存储任何内容。我显然是以错误的方式解决这个问题。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-12T08:41:06.400

使用以下代码，

```
var getText = Array();
chrome.tabs.executeScript(tabs[tab].id, {
    "code": "document.getElementById(\"_Your_ID_Here_\").innerText.split(' ')"
}, function (result) {
    for (i = 0; i < result[0].length; i++)
    getText [i] = result[0][i];
    console.log(getText);
}); 
```

由于**chrome.api的异步性质，您在回调中有更新变量**

# vim - vim 和 snipmate / 片段：如何创建自定义行为

> ID：14790390
> 
> 赞同：1
> 
> 时间：2013-02-09T16:53:52.403
> 
> 标签：vim, code-snippets, snipmate

这是我的片段：

```
# Get repository of a table:
snippet repo
    $$2 = $this->getRepository('${1:Bundle}:${2:TableName}')
    ${3} 
```

当我使用它时，它可能会产生以下内容：

```
$Person = $this->getRepository('MyBundle:Person')
$Address = $this->getRepository('MyBundle:Address') 
```

我希望第一个是小写的，总是小写的，并给我类似的东西：

```
$person = $this->getRepository('MyBundle:Person')
$address = $this->getRepository('MyBundle:Address')
... 
```

. 有没有办法用 snipmate 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:37:41.963

我认为 snipmate 不可能，但你可以看看 UltiSnips。UltiSnips 使用非常相似的模板语法（非常容易转换）并且用途更广泛。 [http://www.vim.org/scripts/script.php?script_id=2715](http://www.vim.org/scripts/script.php?script_id=2715)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T19:51:29.187

*snipMate*无法做到这一点。我试图实现这一点，但是（尤其是当转换改变字符数时），当前的实现很难做到。

这可能是转向[UltiSnips 插件](http://www.vim.org/scripts/script.php?script_id=2715)的最佳理由，它是一种现代的、维护的替代品（但需要 Python 支持）。在那里，该功能称为*转换*，并使用`${<tab stop no/regular expression/replacement/options}`语法。您可以使用`\L`正则表达式原子来小写替换。

# php - 在不刷新页面的情况下更新地图标记 - 传单

> ID：14790394
> 
> 赞同：1
> 
> 时间：2013-02-09T16:54:54.323
> 
> 标签：php, javascript, jquery, html, leaflet

我这里有个情况。我正在尝试使用传单 Javascript 库在在线地图上显示主题的当前位置。我的网站有两个页面。第 1 页有地图显示，第 2 页输入对象的当前位置并相应地设置地图。我使用蓝色标记在地图上显示主题位置。如果我加载第 1 页，标记会正确显示，但如果我更新第 2 页上的位置，则主题的位置不会在第 1 页上的地图上更新。

这是我的第 1 页代码：

```
<!DOCTYPE html>
<html>
<head>
<title></title>
<h1></h1>
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.css" />
<link rel="stylesheet" href="CSS/mystyle.css" />
<!--[if lte IE 8]>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.ie.css" />
<![endif]-->
<script src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"></script>
<script src="SCRIPT/jquery-1.9.1.js"></script>
<script src="SCRIPT/myscript.js"></script>
</head>

<body onload="LoadMap()">
<h2>Current location:</h2>
<table border="1" id="currentloc_table">
    <tr>
        <th>Name</th>
        <th>IMEI</th>
        <th>Latitude</th>
        <th>Longitude</th>
    </tr>
    <tr>
        <td>Azeem HTC Device</td>
        <td>357710043411902</td>
        <td></td>
        <td></td>
    </tr>
</table>
<br/><br/>
<div id="map"></div>
</body>
</html> 
```

这是代码`myscript.js`：

```
 var map;
            var marker;

            function LoadMap()
            {

                $.ajax({
                        url: "../Database/getcurrentlocation.php?deviceId=357710043411902",
                        success: function(data){
                            if(data!=null)
                            {
                                var dataArray = data.split(/~/);
                                SetMap(dataArray[0],dataArray[1]);
                            }
                         }
                      });

                setTimeout(function(){LoadMap();},10000);
            }

            function SetMap(lati,longi)
            {
                var loc_table = document.getElementById('currentloc_table');
                loc_table.rows[1].cells[2].innerHTML = lati;
                loc_table.rows[1].cells[3].innerHTML = longi;
                map = L.map('map').setView([lati, longi], 12);
                L.tileLayer('http://{s}.tile.cloudmade.com/XXXXXXXXXXXXXXXXXXXXXXXXXXXX/997/256/{z}/{x}/{y}.png', {
                attribution: '',
                maxZoom: 18
                }).addTo(map);
                marker = L.marker([lati, longi]).addTo(map);
            } 
```

当我重新加载页面时，地图会更新。但是我可以在不执行第 1 页刷新的情况下用新位置更新地图吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:27:05.873

就放

```
setTimeout(function(){LoadMap();},10000); 
```

在 LoadMap 函数之外

# php - IE8：使用 AJAX、PHP 和进度条上传文件

> ID：14790395
> 
> 赞同：0
> 
> 时间：2013-02-09T16:55:00.917
> 
> 标签：php, ajax, internet-explorer-8, upload, progress-bar

我不敢相信。我刚刚创建了一个不错的上传脚本。它与 chrome 和 firefox 完美配合，但 ie8 不支持 formdata 对象。我需要让它与 IE8 一起工作。我想将我的脚本用于 chrome 和 firefox。如果 someaccess 使用 ie 访问我的 webapp，它应该会自动识别它是哪个浏览器并加载替代脚本。

知道如何为 ie 创建一个带有 progessbar 的上传脚本吗？

注意：我不想使用任何花哨的上传插件或其他语言，如 flash 或 silverlight。也不要链接像uploadfiy这样的花哨的上传插件。你知道，我想了解我在这里创造了什么。

**编辑** 好的，我找到了解决方案，但我只有最后一个问题。我需要一个进度条。这是我的代码：`http://193.109.52.60/dario/ie` 知道如何让它工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:44:30.060

重新发明轮子，尤其是在文件上传方面，总是会导致灾难。现有的库已经很好地解决了这个问题。看看[Fine Uploader](http://fineuploader.com)，它有很多功能，是开源的，不使用或不依赖于 Java 或 Flash（这几天这是一个非常好的东西）并且有一个可选的 jQuery 插件，如果你是一个 jQuery用户（如果没有，您可以不使用 jQuery 插件使用它，并且所有功能仍然可用）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-09T19:55:28.020

IE8 不完全支持 html5，所以你将不得不使用另一种技术来使进度条工作。

我知道你不想要一个插件的链接，但你不应该重新发明轮子，所以看看 plupload @ [http://www.plupload.com/](http://www.plupload.com/)！

它是开源的，如果您真的想知道进度条是如何完成的，请深入研究代码。

卢西安

# c# - EndExecuteNonQuery，它是什么，它做什么以及如何使用它？

> ID：14790401
> 
> 赞同：0
> 
> 时间：2013-02-09T16:55:30.323
> 
> 标签：c#, mysql, try-catch

我正在通过 C# 应用程序在 mysql 数据库中插入数据，我想知道插入是否成功并在互联网上搜索我读了一些关于“EndExecuteNonQuery”的内容，但它没有解释任何关于应该的方式用它。我不知道我可以使用它的方式，甚至我为什么要使用它。

```
try
        {
            cepescola = txtcepescola.Text + txtcepescola1.Text;
            num_escola = int.Parse(txtnumescola.Text);
            cnpj = txtcnpj.Text + txtcnpj2.Text;
            telefoneescola = txtddd.Text + txttel.Text;
            inserte.Append("Insert into estabelecimento ( Nome,CEP,Endereco,Numero,Bairro,UF,CNPJ,Telefone)");
            inserte.Append(" values ");
            inserte.Append("( '" + txtnomeescola.Text + "','" + cep + "','" + txtenderecoescola.Text + "','" + num_escola + "',");
            inserte.Append(" '" + txtbairroescola.Text + "','" + cbxufescola.Text + "','" + cnpj + "','" + telefoneescola + "')");
            conexao.ExecutaComando(inserte.ToString());
            groupBox2.Enabled = false;
            btnestabelecimento.Visible = false;
            btnlogin.Visible = true;
            txtlogin.Focus();
        }
        catch (Exception)
        {
            MessageBox.Show("Dados digitados em formato incorreto.", "Erro de Dados", MessageBoxButtons.OK, MessageBoxIcon.Error);
            groupBox2.Enabled = true;
            btnestabelecimento.Visible = true;
            btnlogin.Visible = false;
            txtlogin.Focus();

        } 
```

在这种情况下我可以在哪里使用它，我应该改变什么？Obs：在“Conexão.ExecutaComando(insertd.ToString());” 这是我创建的用于执行命令的类。

还有一件事，我在出现异常时使用了 Try 和 Catch，但是如果用户写了必须写数字的单词，我想中止连接。我的应用程序正在查找错误，但无论如何它都在插入。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:43:39.320

[`EndExecuteNonQuery`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.endexecutenonquery.aspx)与 i 一起用于[`BeginExecuteNonQuery`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.beginexecutenonquery.aspx)在数据库上异步执行命令。我建议您在考虑异步运行查询之前更轻松地解决您的问题。

关于您需要验证用户输入的主题，我建议两件事。首先是通过在命令中使用参数来消除 SQL 注入攻击的风险。例如，而不是使用以下（为简洁起见）：

```
var sql = "insert into estabelecimento (Nome) values ('" + txtnomeescola.Text + "')"; 
```

您应该使用以下内容：

```
var sql = "insert into estabelecimento (Nome) values (@nomeescola)";
//assume cmd is a SqlCommand instance
cmd.Parameters.AddWithValue("@nomeescola", txtnomeescola.Text); 
```

其次，如果您需要对查询的输入执行验证，那么您应该在执行命令**之前执行此操作。**您已经通过将`num_escola`参数解析为`int`将阻止它成为字符串来验证您的参数。您应该对其他数字参数执行相同的操作，并且可以考虑[`int.TryParse`](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)改用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T16:59:59.463

此[链接](https://stackoverflow.com/questions/4160181/why-is-endexecutenonquery-needed)将对您有用

> **Quote:** 这将执行以下操作：
> 
> 1.  更新参数值（输出/返回）
> 2.  检查异常（TDS 流中的错误代码 - 违反约束等）
> 3.  释放作为上述内容的一部分缓冲的任何对象/数据等

# ocaml - 编写过滤谓词：“表达式的类型为 int .. 预期为 bool 类型”

> ID：14790407
> 
> 赞同：0
> 
> 时间：2013-02-09T16:56:10.470
> 
> 标签：ocaml

所以我写了一个函数“filter”，它应用于输入列表中每个元素的给定谓词，并检查它是否应该包含在输出中。

```
let rec filer (pred: 'a -> bool) (l: 'a list) : 'a list =
begin match l with
| [] -> []
| hd :: rest -> if (pred hd) then hd :: (filter pred rest) else filter pred rest
end 
```

现在我正在编写一个谓词，它可以传递给过滤器以保持五的倍数。

```
let multiples_of_five_pred: int -> bool =
filter (fun (x: int) -> x mod 5) 
```

我不知道我在这里遗漏了什么......我收到一个语法错误，上面写着“这个表达式的类型是 int，但表达式应该是 bool 类型的”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:20:33.003

给定的函数`filter`需要产生一个布尔值，但正如错误消息告诉您的那样，您给定的函数会`filter`产生一个整数，而不是布尔值。您需要将其更改为生成布尔值。

一旦你解决了这个问题，你就会遇到另一个类型错误：应用`filter`到一个接受整数的函数将产生一个 type 的函数`int list -> int list`，但根据你的类型签名，你需要 type `int -> bool`。

另请注意，您说这`multiples_of_five_prod`应该是一个*给定*的函数`filter`，但您实际上是`filter`在函数内部调用的。那不合适。您应该删除对`filter`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T17:01:05.067

问题的根源在于您在不需要时使用了类型注释。如果您错过了它们（不需要它们），您会更快地看到为什么您的第二个函数没有您期望的类型。

# ruby - 使用访问器方法动态创建对象

> ID：14790409
> 
> 赞同：6
> 
> 时间：2013-02-09T16:56:22.727
> 
> 标签：ruby, accessor

使用哈希定义的访问器方法动态创建对象的最简单方法是什么？例如，如果我有一个哈希：

```
{foo: "Foo", bar: "Bar"} 
```

我想要一个对象，它分别具有访问器方法`foo`、`foo=`、`bar`和`bar=`初始值`"Foo"`、 和`"Bar"`。我可以想到做：

```
module ObjectWithAccessor
  def self.new h; Struct.new(*h.keys).new(*h.values) end
end

o = ObjectWithAccessor.new(foo: "Foo", bar: "Bar")
o.foo # => "Foo" 
```

但是，我不需要它们的多个实例具有相同的特定键集，而是希望每次都使用可能不同的键集创建它的新实例，因此`Struct`每次为每个对象创建一个新类似乎矫枉过正，我想避免这种情况。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-09T17:04:15.080

[`OpenStruct`](http://ruby-doc.org/stdlib-1.9.3/libdoc/ostruct/rdoc/OpenStruct.html)已经提供了你想要的：

```
require 'ostruct'

o = OpenStruct.new foo: "Foo", bar: "Bar"
o.foo  #=> "Foo"
o.bar  #=> "Bar"
o.bar = 'BAR'
o.bar  #=> "BAR" 
```

或者，如果您不想在创建对象后定义任意属性（就像您可以使用 一样`OpenStruct`，您可以执行以下操作：

```
class ObjectWithAccessor
  def initialize attrs
    attrs.each do |name, val|
      singleton_class.send :attr_accessor, name.to_sym
      public_send :"#{name}=", val
    end
  end
end

o = ObjectWithAccessor.new foo: "Foo", bar: "Bar"
o.foo           #=> "Foo"
o.bar           #=> "Bar"
o.bar = 'BAR'
o.bar           #=> "BAR"
o.bsr = 'typo'  #=> #<NoMethodError: undefined method `bsr=' for #<Object:0x007fa4160847f8>> 
```

这仍然不会创建一个只使用一次的新类，并且避免了`OpenStruct`.

# facebook-graph-api - 获取喜欢 URL 的用户的 Facebook 个人资料图片

> ID：14790417
> 
> 赞同：0
> 
> 时间：2013-02-09T16:56:50.667
> 
> 标签：facebook-graph-api

我已经浏览了尽可能多的链接，但尚未找到关于是否有可能以及如何获取每个喜欢“页面”在您的网站上（不是 Facebook 页面）。否则，这可以与喜欢 Facebook 页面的人一起完成吗？

非常感谢你的帮助，CW

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T14:24:40.383

您可以通过请求此 URL 来获取任何用户图片：

```
http://graph.facebook.com/{user_id}/picture 
```

**并且您可以通过在他们的个人资料中循环投掷喜欢**字段来从朋友那里知道谁喜欢您的粉丝页面。

# c++ - 创建 CCScale9Sprite 时使用 Lua 和 Cocos2d-x 的困惑

> ID：14790419
> 
> 赞同：0
> 
> 时间：2013-02-09T16:57:00.720
> 
> 标签：c++, xcode, lua, cross-platform, cocos2d-x

嘿，我正在使用 cocos2d-x 开发一个应用程序。为了给应用程序提供更多功能，我目前正在使用 Lua。这是我成功生成新场景的代码：

```
函数主（）

`local visibleSize = CCDirector:sharedDirector():getVisibleSize()
local origin = CCDirector:sharedDirector():getVisibleOrigin()

local cclog = function(...)
    print(string.format(...))
end

-- create layer
local function createLuaSceneLayer()
    local luaSceneLayer = CCLayer:create()

         local function menuCallbackBack()
            CCDirector:sharedDirector():popScene()
        end

        local size = CCDirector:sharedDirector():getWinSize();

        local bg = CCLayerColor:create(ccc4(255,255,255,255))
        luaSceneLayer:addChild(bg)

        local backButton = CCMenuItemImage:create("arrow_left.png", "arrow_left.png")
        backButton:setPosition(ccp(20, CCDirector:sharedDirector():getWinSize().height - 20) )
        backButton:registerScriptTapHandler(menuCallbackBack)

        local menu = CCMenu:createWithItem(backButton)
        menu:setPosition(ccp(0, 0))
        luaSceneLayer:addChild(menu,3)

        local textLabel = CCLabelTTF:create("I am a Lua generated Label", "Thonburi", 20)
        textLabel:setPosition(180 ,size.height -20)
        textLabel:setColor(ccc3(0,0,0))
        luaSceneLayer:addChild(textLabel)

        local taskLabel = CCLabelTTF:create("Enter two numbers in the EditBoxes Below", "Thonburi", 20)
        taskLabel:setPosition(160,size.height /7 * 6)
        taskLabel:setColor(ccc3(0,0,0))
        luaSceneLayer:addChild(taskLabel)

        local mySprite = CCScale9Sprite:create("green_edit.png")

        local textField1 = CCEditBox:create(CCSizeMake(200, 40), mySprite)
        textField1:setPosition(40, 40)
        textField1:setFontColor(ccBLACK);
        textField1:setText("");
        luaSceneLayer:addChild(textField1)

    return luaSceneLayer
end

-- run
local luaScene = CCScene:create()
luaScene:addChild(createLuaSceneLayer())

CCDirector:sharedDirector():pushScene(luaScene)` 

结尾

xpcall（主要，**G__TRACKBACK**）

现在我想添加一个需要 CCScale9Sprite 的 CCEditBox。一旦我打开 Lua 文件，我的应用程序就会崩溃，并收到以下错误消息：

**PANIC：调用 Lua API 时出现未受保护的错误（...3-AEC8-DC161CC38F63/SalesOrderApp.app/helloLocal.lua:47：尝试索引全局“CCScale9Sprite”（零值））**

为什么不能将 CCScale9Sprite 与 Lua 结合使用？

            回答 #1

赞同：1

时间：2013-02-09T23:31:44.447

错误消息告诉你 Lua 不知道名为 CCScale9Sprite 的对象。

CCScale9Sprite 不是 cocos2d 的一部分，据我所知，它也不在 cocos2d-x 中。所以在 cocos2d-x 的 Lua 实现中不能注册为已知对象。您必须先使用 cocos2d-x 的 tolua++ 绑定机制注册 CCScale9Sprite（将其绑定到 Lua），然后才能在 Lua 端使用它。您添加的任何自定义类也是如此。

```

# java - 让 Hibernate Validator 按键验证 Map

> ID：14790420
> 
> 赞同：4
> 
> 时间：2013-02-09T16:57:11.733
> 
> 标签：java, hibernate-validator

我使用 Hibernate Validator (HV) 作为我的 JSR 303 验证器。但是，在 JSR 303 和 HV 的扩展中，似乎都没有任何注释来指定约束，例如键必须存在于 Map 中或仅验证与键对应的 Map 值。

我的用例是，仅当 bean 的某些其他属性设置为 true 时，才要求某些映射键具有有效值。目前，我使用了一个假的 getter 和一个 @AssertTrue 注释，但我真的很想让这个更基于注释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T18:24:34.617

> 似乎没有任何注释来指定约束，例如 Map 中必须存在键。

这可以通过实现[自定义约束](http://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/#validator-customconstraints)来解决：

```
@Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER })
@Retention(RUNTIME)
@Documented
@Constraint(validatedBy = { ContainsKeyValidator.class })
public @interface ContainsKeys {
    String message() default "{com.acme.ContainsKey.message}";
    Class<?>[] groups() default { };
    Class<? extends Payload>[] payload() default { };
    String[] value() default {};
} 
```

像这样的验证器：

```
public class ContainsKeysValidator implements ConstraintValidator<ContainsKeys, Map<?, ?>> {

    String[] requiredKeys;

    @Override
    public void initialize(ContainsKeys constraintAnnotation) {
        requiredKeys = constraintAnnotation.values();
    }

    @Override
    public boolean isValid(Map<?, ?> value, ConstraintValidatorContext context) {
        if( value == null ) {
            return true;
        }

        for( String requiredKey : requiredKeys ) {
            if( value.containsKey( requiredKey ) ) {
                return false;
            }
        }

        return true;
    }
} 
```

> 我的用例是，仅当 bean 的某些其他属性设置为 true 时，才要求某些映射键具有有效值。

对于这个要求，您可以实现一个[类级别的](http://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/#d0e341)约束，它允许访问完整的 bean 及其在验证器实现中的所有属性。

# hornetq - 如何设置 HornetQ 演示

> ID：14790428
> 
> 赞同：5
> 
> 时间：2013-02-09T16:58:02.500
> 
> 标签：hornetq

我正在尝试用我自己的测试项目重新创建 HornetQ 示例。但是我遇到了类加载器问题。显然，我缺少一些文档中未指定的依赖项。

文档让我添加

*   `hornetq-core-client.jar`
*   `netty.jar`
*   `hornetq-jms-client.jar`
*   `jboss-jms-api.jar`

我收到此错误：

```
javax.naming.NoInitialContextException: Cannot instantiate class:
   org.jnp.interfaces.NamingContextFactory 
[Root exception is java.lang.ClassNotFoundException:
   org.jnp.interfaces.NamingContextFactory] 
```

我在哪里可以找到这个课程（以及可能需要的任何其他课程）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T16:59:47.703

我最近遇到了同样的问题。重新创建主题示例，我必须添加以下内容：

jnp-client.jar hornetq-commons.jar

两者都应该在 hornetq 库中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T09:43:17.767

值得一提的是，从**HornetQ 2.3**开始，一切都已经 Mavenized。因此，如果您在为 HornetQ 示例找出依赖列表时遇到困难，只需进入示例文件夹并询问 Maven：

```
cd hornetq/examples/jms/topic
mvn dependency:list 
```

# android - 丰富的通知操作不可点击

> ID：14790429
> 
> 赞同：1
> 
> 时间：2013-02-09T16:58:03.467
> 
> 标签：android, notifications

我正在使用 Jelly Bean 的丰富通知系统，并在通知中添加了两个操作。我遇到的问题是这些操作似乎被禁用了。

这个想法是为`PendingIntent`每个动作设置一个，并在我注册的广播接收器中得到通知，以处理两个意图中的动作。

以下是创建通知的代码：

```
 Intent startIntent = new Intent(Notifications.START);
        Intent resetIntent = new Intent(Notifications.RESET);

        PendingIntent startPendingIntent = PendingIntent.getBroadcast(ctx,
                whichOne, startIntent,
                Intent.FLAG_RECEIVER_REPLACE_PENDING);
        PendingIntent resetPendingIntent = PendingIntent.getBroadcast(ctx,
                whichOne, resetIntent,
                Intent.FLAG_RECEIVER_REPLACE_PENDING);

        [...]

        notificationBuilder = new Notification.Builder(ctx)
                .setContentTitle(s)
                .setContentText("")
                .setContentIntent(appIntent)
                .setSmallIcon(R.drawable.ic_launcher)

                .addAction(R.drawable.play,
                        ctx.getString(R.string.START), startPendingIntent)
                .addAction(R.drawable.reload,
                        ctx.getString(R.string.RESET_TIMER),
                        resetPendingIntent);
        [...] 
```

然后我注册`Receiver`这样的：

```
IntentFilter filter = new IntentFilter();
    filter.addAction(Notifications.START);
    filter.addAction(Notifications.RESET);

    receiver = new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            Toast.makeText(context, intent.getAction(), Toast.LENGTH_LONG)
                    .show();

        }
    };

    registerReceiver(receiver, filter); 
```

我遇到的问题是这些操作似乎被禁用了。我无法单击它们，它们以典型的禁用 alpha 文本颜色显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:11:34.813

您应该`Intent.FLAG_RECEIVER_REPLACE_PENDING`从您`PendingIntent`的两个操作中删除标志并将其替换为 0。[该标志最常用于粘性广播](http://developer.android.com/reference/android/content/Intent.html#FLAG_RECEIVER_REPLACE_PENDING)，其中最近的值是唯一重要的值（例如检查电池电量）。

删除该标志将重新启用您的操作。如果您的意图是在任何给定时间只提供一个操作，那么我建议对该通知使用静态 ID，以便在任何给定时间只能使用该类型的一个通知。

# ruby-on-rails - 从参数中删除哈希（数组）并放入变量

> ID：14790431
> 
> 赞同：1
> 
> 时间：2013-02-09T16:58:12.587
> 
> 标签：ruby-on-rails, arrays, ruby-on-rails-3, variables, hash

我正在从表单中检索控制器中的参数，我想从中删除哈希并放入变量以供以后使用。

假设参数包括以下内容：

```
@form_data = params[:project] // <-- :id, :title, :description, :members 
```

':members' 是一个数组（从复选框中检索），我希望将该数组放入一个新变量中以供以后使用，并且应该从参数中删除它。

```
@members // <-- should contain :members 

@project = Project.new(params[:project])  // <-- ':members' is removed 
```

怎么可能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-09T17:03:26.783

您可以使用[删除](http://www.ruby-doc.org/core-1.9.3/Hash.html#method-i-delete)方法

```
@members = params[:project].delete(:members)
@project = Project.new(params[:project]) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-09T17:04:24.007

为此，您至少有两个选择。

1）初始化项目时忽略成员键

```
@members = params[:project][:members]
@project = Project.new(params[:project].except(:members)) 
```

2) 从 params 对象中删除 members 键

```
@members = params[:project].delete(:members)
@project = Project.new(params[:project]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T17:06:56.813

您可以执行以下操作：

```
 before_filter :edit_params_hash, :only => [:create]

 def edit_params_hash
      @members = params[:projects][:members] if params[:projects][:members].present?
      params[:projects][:members] ||= nil
 end 
```

然后在创建使用

```
def create
     @project = Project.new(params[:project])
     @project.save
     @project.members = @members
end 
```

:)

# jquery - 使用jquery ui关闭自动完成时如何从输入文本区域获取文本？

> ID：14790432
> 
> 赞同：0
> 
> 时间：2013-02-09T16:58:13.293
> 
> 标签：jquery, jquery-ui

当您在输入文本区域中键入与源对象的选择列表匹配的字母时，Jquery UI 自动完成打开，并在使用 Enter 键从选择列表中进行选择后关闭，如果您输入的文本不在，则关闭选择列表。

键入不在选择列表中的文本后，如何检查自动完成功能何时关闭？我想要做的是当输入回车键时，检查自动完成是否关闭，如果是，则获取文本区域中的文本（如果它不为空）。

像这样的东西：

```
 $(".inputText").keydown(function()
           {
               if(keyChar == enterKey)
               {
                 // Somehow check is autocomplete is closed and if inputText is not empty, get the text without it interfering with the autocomplete select event. 
               }

           }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T19:31:42.783

如果我理解正确，您正在寻找的是自动完成的“选择”属性。

```
$( "#tags" ).autocomplete({
    source: aTags,
    select: function( event, ui ) {
        alert(ui.item.value);
    }
}); 
```

这里是 JSFIddle：http: [//jsfiddle.net/CezarisLT/KHqQm/](http://jsfiddle.net/CezarisLT/KHqQm/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:31:12.440

概括地说，有两种方法，一种通过`autocomplete()`方法绑定到元素，第二种侦听自定义事件，`autocompleteclose`由自动完成列表的关闭触发：

```
var list = [
    'apple',
    'Azerbaijan',
    'aggregate',
    'Albert',
    'Aunty',
    'admissible',
    'and so forth...'
];

$('#textInput').autocomplete({
    source: list,
    close: function ( event, ui ) {
        var v = this.value;
        if (list.indexOf(v) === -1) {
            list.push(v);
        }
    }
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/rEmWs/)。

或者：

```
$('#textInput').on('autocompleteclose', function (event, ui) {
    var v = this.value;
    if (list.indexOf(v) === -1) {
        list.push(v);
    }
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/rEmWs/1)。

参考：

*   [`autocomplete()`方法的`close`事件](http://api.jqueryui.com/autocomplete/#event-close)。

# java - Java：在我的家庭网络中获取我自己的 IP 地址

> ID：14790440
> 
> 赞同：0
> 
> 时间：2013-02-09T16:58:53.413
> 
> 标签：java, inetaddress

我在网上找到了两个示例来获取路由器给我的电脑的 IP 地址。这是代码：

```
import java.net.InetAddress;
import java.net.UnknownHostException;

public class tryNet {

public static void displayStuff(String whichHost, InetAddress inetAddr) {
    System.out.println("---------------------");
    System.out.println("host: " + whichHost);
    System.out.println("Canonical host name: " + inetAddr.getCanonicalHostName());
    System.out.println("Host Name: " + inetAddr.getHostName());
    System.out.println("Host Address: " + inetAddr.getHostAddress());
    System.out.println("---------------------");
}

public static void main(String argv[]) {
    try {
        InetAddress inetAddr = InetAddress.getLocalHost();
        displayStuff("localhost", inetAddr);
    }

    catch (UnknownHostException e) {
        e.printStackTrace();
    }
}

} 
```

在初始化 InetAddress inetAddr = InetAddress.getLocalHost(); 我可以使用 inetAddr.getHostAddress() 方法来获取我的 ip 地址，即我的路由器给出的那个（例如在 ubuntu 的终端中写入 ifconfig，或者在 windows 中写入 ipconfig），而是返回我的环回地址...（127.0 .0.1) 为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T19:34:17.023

您的 PC 有多个接口（至少两个）和多个 IP 地址（当然，如果它已插入网络）。通常`localhost`将解析为`127.0.0.1`（在环回接口上），并且您使用的各种方法将返回它。

下面将显示机器上的所有接口以及分配给它们的 IP 地址：

```
public static void main(String[] args) throws InterruptedException, IOException
{
    Enumeration<NetworkInterface> e = NetworkInterface.getNetworkInterfaces();
    while (e.hasMoreElements())
    {
        NetworkInterface n = e.nextElement();
        System.out.println(n.getName());
        Enumeration<InetAddress> ee = n.getInetAddresses();
        while (ee.hasMoreElements())
        {
            InetAddress i = ee.nextElement();
            System.out.println(i.getHostAddress());
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T19:42:36.227

通常，您的主机有一个指向环回接口的名称。分配了 IP 地址的 DHCP 服务器。根据您的 dhcp 客户端配置，主机也可能采用新名称。

# ios - clang：错误：链接器命令失败，退出代码为 1（l5 远程示例应用程序）

> ID：14790444
> 
> 赞同：0
> 
> 时间：2013-02-09T16:59:14.640
> 
> 标签：ios, objective-c, xcode, cocoa

当我尝试运行 L5 Remote ( [http://www.l5remote.com/forum/viewtopic.php?f=12&t=14](http://www.l5remote.com/forum/viewtopic.php?f=12&t=14) ) 的未更改示例应用程序时，出现上述错误。

请参阅随附的屏幕截图![在此处输入图像描述](../Images/2cf0f194755dbd4156e5cb55f9e8c36b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T17:03:49.470

您没有正确链接`libL5Backend`到您的目标。

将其添加到目标设置中“构建阶段”选项卡下的目标“将二进制文件与库链接”部分。在下面显示的图像中，该`+`图标可让您将库添加到目标。

您还可以通过查看“库搜索路径”设置（在构建设置下）来删除警告，并确保它不包含错误的路径。

![在此处输入图像描述](../Images/cf7357f15b5e6d8126d89af9df34169f.png)

# java - Java继承-找不到在对象上调用的方法？

> ID：14790445
> 
> 赞同：0
> 
> 时间：2013-02-09T16:59:16.487
> 
> 标签：java, inheritance, methods

首先，我有三门课。一个叫：

1.  温度（超类）

2.  天气（子类超类）

3.  UseTemperature（包含 main 方法的子类）

对于这个程序，主要方法应该只显示摄氏温度和风速。虽然不知道是什么问题。。

**我的问题是在 UseTemperature 中找不到 setWindSpeed/getWindSpeed。**

```
//TEMPERATURE:

public class Temperature
{
    private double degrees;

    public void setDegrees (double degrees)
    {
        this.degrees = degrees;
    }

    public double getDegrees ()
    {
        return degrees;
    }

/////////////////////////////////////////////////////////////////////////////////////////
//WEATHER:

public class Weather extends Temperature
{
    private double windspeed; // Number + km/h

    private void setWindSpeed (double windspeed) //setter
    {
        this.windspeed = windspeed;
    }

    public double getWindSpeed ()  //getter
    {
        return windspeed;
    }
}
/////////////////////////////////////////////////////////////////////////////////////////
//USE TEMPERATURE:

class UseTemperature // can be public but makes no diffrence
{
    public static void main (String args[])
    {
        Temperature temp;

        temp = new Temperature ();

        temp.setDegrees (40.0);      
        temp.setWindSpeed (70.0); // NOT FOUND IN TEMPERATURE

        System.out.print (temp.getDegrees ());
        System.out.print (" degrees ");

        System.out.println (temp.getWindSpeed()); // NOT FOUND IN TEMPERATURE
        System.out.println (" km/h");

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T17:04:02.607

该类`Temperature`不包含方法`setWindSpeed`或`getWindSpeed`. 您需要创建一个`Weather`对象并使这些方法可以访问以调用它们。

```
Weather myWeather = new Weather();
// set/get ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T17:04:20.983

您需要在温度类中声明 setWindSpeed/getWindSpeed 或执行

```
Weather temp = new Weather (); 
```

原因是当你这样做

```
Temperature temp;
 temp = new Temperature ();
 temp.getWindSpeed() 
```

编译器只是查看 getWindSpeed 是否位于 Temperature 类中。它不是。所以它给出了编译错误

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T17:04:29.033

`Temperature`类确实没有`getWindSpeed`和`setWindSpeed`方法。只有子类`Weather`拥有这些方法。超类对子类一无所知。与其创建 的实例，不如创建 的`Temperature`实例`Weather`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T17:07:26.240

UseTemperature 实际上并没有扩展 Weather，无论如何它都无法访问（私有）setWindSpeed 方法。如果要将其设为嵌套类，则*可以*访问它（有关详细信息，请参见[http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html](http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html)），但这可能不是一个好的设计选项。

相反，如果 UseTemperature 旨在成为您的应用程序访问点并且永远不会被实例化（就像在您发布的代码段中一样），请考虑将 setWindSpeed 的访问修饰符更改为更宽松的内容，例如*protected*甚至*default*。这将允许您从同一包中的类访问它，而无需对其进行子类化。

**编辑**：另外，正如 Reimeus 所指出的，必须实例化一个 Weather 对象而不是 Temperature 对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-09T17:07:35.913

您如何访问`setWindSpeed`和`getWindSpeed`从`Temperature`. 请记住，所有子类都是超类，但所有超类都不是子类。您需要在 中定义`setWindSpeed`和。`getWindSpeed``Temperature`

像这样定义访问 getWindSpeed 和 setWindSpeed 之后。

```
Temperature t = new Weather(); 
```

`t.setWindSpeed();`等等。

也不要在 Weather 中将这些方法设为私有。只有当您制作它们`public`或至少`protected`在`Temperature`.

# model-view-controller - Mvc 前端和 Mvc 后端：错误的架构？

> ID：14790448
> 
> 赞同：2
> 
> 时间：2013-02-09T16:59:37.687
> 
> 标签：model-view-controller, symfony, backbone.js, ember.js

我正在构建一个 web 应用程序，它将是一个 twitter 风格的单页应用程序，可能***带有***用户身份验证。80% 的交互发生在前端，使用 JavaScript，并在后端回答提供来自数据库的数据的帮助下......

到目前为止，我的想法是使用 Symfony2，加上一个用于前端的 MVC 框架，如 Backbone 或 Ember（更喜欢 Ember，因为它看起来更有文档，而且通常更有条理和更容易）。

当我开始学习 Symfony2 时，我注意到 Symfony2 提供的许多东西对我的应用程序毫无用处。我真的不需要它的视图，因为视图将使用 Javascript 进行模板化，我也不需要它的路由器，因为它也将通过前端的 JS 状态处理。

Symfony2 将仅用作 JSON 响应机制，我想教义也可以帮助那些主要不是后端人员的人轻松地进行查询，当然还有身份验证。我猜FORMS也由JavaScript处理。

我已经看到很多关于 Symfony2 和主干、RESTful 等的其他问题。有很多不同的答案，有人说你需要一个 Bundle 来创建 RESTful API（为什么？）——其他人说你需要 Bundle 来完全集成 Backbone/ Symfony2，其他人说你只需要用 Symfony2 查询 JSON 数据并将它们序列化并发送回来，所以没什么特别的..

所以我的问题是：似乎 Symfony2 对这种 APP 来说有点过头了。但考虑到这是一个学习机会的项目，真的有问题吗？（性能方面，或与前端打得不好）。子问题是，你能提供任何关于 Symfony2 与单页网络应用程序集成的工作示例吗？我见过不同的元素，但整体上什么都没有，所以我可以知道我想要在代码方面实现什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T00:23:06.153

我不知道 Symphony2，但听起来很像大多数 ember+rails 项目。这些应用程序很少使用 Rails 框架。人们可以认为更轻的框架更合适，但不应该成为问题。更重要的可能是您一次学习 2 个新框架所需的提升。如果要使用 ember，我将首先构建一个使用 ember 固定适配器的 MVP，根本没有后端。一旦你完成了这项工作，你就可以插入任何有意义的框架。Fire Up Ember.js 窥视代码展示了如何以这种方式构建应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T20:01:43.707

如果您的路线很少、模型很薄、业务逻辑很少且没有模板，您可能会发现使用 Silex [http://silex.sensiolabs.org/](http://silex.sensiolabs.org/)之类的东西更简单。无需禁用 Symfony2 的功能，您只需将所需的内容添加到 Silex。他们都使用相同的构建块，只是具有不同的精神。这是@hhamon 关于将 Silex 用于 REST API [https://speakerdeck.com/hhamon/designing-rest-api-with-silex](https://speakerdeck.com/hhamon/designing-rest-api-with-silex)的精彩演示。

# jquery - Fancybox 在本地运行在 Firefox 中，但在服务器上不运行

> ID：14790452
> 
> 赞同：0
> 
> 时间：2013-02-09T16:59:48.217
> 
> 标签：jquery, fancybox, fancybox-2

我将 Fancybox 合并到以下 URL：

[http://www.radiocraft.ca/Corvette/corvette.htm](http://www.radiocraft.ca/Corvette/corvette.htm)

它在我的计算机上本地运行 IE9 和 Firefox 18，但是当加载到我的服务器上时，Firefox 会在新选项卡中打开照片。IE9 在服务器上运行良好。

有什么不对劲，我看不出是什么。

有人可以指出具体需要纠正的地方吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T17:06:26.723

jquery.fancybox.pack.js 和 jquery.fancybox.css 文件的链接不正确，您当前将它们设置为

```
file://///USER-PC/Users/user/Documents/My Webs/My Webs4/radiocraft.ca/js/fancybox/jquery.fancybox.pack.js
file://///USER-PC/Users/user/Documents/My Webs/My Webs4/radiocraft.ca/js/fancybox/jquery.fancybox.css 
```

这些是您计算机的本地地址，它们应该设置为服务器地址：

```
<script type="text/javascript" src="/js/fancybox/jquery.fancybox.pack.js">
<link rel="stylesheet" type="text/css" href="/js/fancybox/jquery.fancybox.css" media="screen" /> 
```

# php - 大量数据的自定义排序算法

> ID：14790457
> 
> 赞同：1
> 
> 时间：2013-02-09T17:00:11.760
> 
> 标签：php, sql-server, symfony, solr, doctrine-orm

我有大量数据需要根据搜索查询以特定方式排序，但我不确定最佳方法。

我要排序的数据是按学校分组的课程列表。每门课程由一所学校教授。每个学校可能属于任意数量的“伙伴关系”，这代表了许多学校之间的关系。用户可以通过课程名称搜索任意数量的课程。

我需要对数据进行如下排序：

*   课程按学校分组，每页显示 10 所学校。

*   可以提供用户搜索过的每门课程的学校应该首先出现在列表中。

*   在这些结果之后，属于可以容纳用户搜索的所有课程的合作伙伴的学校应该彼此相邻出现。

这是一个例子：

*   *A*教授历史、法语和英语课程。
*   *B*教法语和数学。
*   *C*教授历史。
*   *B*和*C*是合伙人。
*   *D*教历史。

*   用户搜索“历史”和“法语”。

*   *A*应该首先出现在结果中，它的历史和法语课程，因为它可以提供用户正在寻找的两个课程。

*   *接下来出现B*，紧接着是*C*，其所教授的相关课程列在其后，因为合作伙伴可以提供用户所需的两门课程。

*   *D*接下来出现，因为它只提供 1 门相关课程。

数据跨几个表存储在 Microsoft SQL Server 数据库中。这是一个简化的架构：

**课程：**

*   内部编号
*   varchar 名称
*   诠释学校ID

**学校：**

*   内部编号
*   varchar 名称

**合伙：**

*   内部编号
*   varchar 合伙人名称

**学校合作：**

*   内部编号
*   诠释学校ID
*   内部伙伴关系 ID

有超过100000门课程和大约300所学校。我不知道如何按照 SQL 中指定的方式对课程进行排序，我认为这是我最大的问题。我只需要在每页显示 10 个结果，但由于无法在 SQL 查询中进行排序，我必须提取整个结果集并在 PHP 中手动对其进行排序，然后才能将结果集减少到 10 个结果。

我目前正在使用 Doctrine 2 在具有多个连接的单个查询中提取我需要的数据，将结果水合为一个数组。然后计划是在 PHP 中操作这个大的记录数组以使其进入正确的顺序。由于这个数组的大小，我担心这个排序过程会很慢，所以我正在寻找有关如何更快地进行排序的建议，方法是：

*   处理 SQL 查询中的排序。
*   建议如何在 Solr 等搜索引擎中实现上述算法（我对这方面的基础知识有一点经验，但不会执行复杂的排序）。
*   如果其他两个选项不可行，关于如何最好地在 PHP 中执行排序的建议。

**编辑：**

我在这方面取得了一些不错的进展，谢谢（尤其是@Neil）。我已经打开了一个单独的问题（[子查询上的 Groupwise MAX()](https://stackoverflow.com/questions/14841529/groupwise-max-on-a-subquery)），其中包含我到目前为止的一些进展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:56:49.767

按匹配课程的数量查找学校很简单：

```
SELECT schoolId, COUNT(*) AS schoolCount
  FROM Courses
  WHERE name IN ('History', 'French')
  GROUP BY schoolId 
```

如果这就是你所需要的，你可以`ORDER BY schoolCount DESC`按照你想要的顺序得到它们。

要找到与匹配课程的合作伙伴，您首先需要找到在至少一所学校开设课程的合作伙伴：

```
SELECT partnershipId, COUNT(DISTINCT name) AS partnershipCount
  FROM SchoolPartnership
  INNER JOIN Courses ON Course.schoolId = SchoolPartnership.schoolId
  WHERE name IN ('History', 'French')
  GROUP BY partnershipId 
```

请注意，这`DISTINCT`是必需的，因为我们不在乎合作伙伴中有多少学校有该课程。如果你没有，`DISTINCT`那么你可以使用一个子选择来代替：

```
SELECT partnershipId, COUNT(*) AS partnershipCount
  FROM (
    SELECT DISTINCT partnershipId, name
      FROM SchoolPartnership
      INNER JOIN Courses ON Course.schoolId = SchoolPartnership.schoolId
      WHERE name IN ('History', 'French'))
  GROUP BY partnershipId 
```

然后，您可以将上面的第一个和最后一个查询用作与 SchoolPartnership 的连接中的子选择，以按 partnerMatches 和 schoolMatches 的降序排列学校。（请注意，我假设所有学校都与至少一所学校合作。）我认为最终查询将如下所示：

```
SELECT SchoolMatches.schoolID
  FROM (
    SELECT schoolId, COUNT(*) AS schoolCount
      FROM Courses
      WHERE name IN ('History', 'French')
      GROUP BY schoolId
  ) SchoolMatches
  JOIN SchoolPartnership ON SchoolMatches.schoolID = SchoolPartnership.schoolID
  JOIN (
    SELECT partnershipId, COUNT(DISTINCT name) AS partnershipCount
      FROM SchoolPartnership
      INNER JOIN Courses ON Course.schoolId = SchoolPartnership.schoolId
      WHERE name IN ('History', 'French')
      GROUP BY partnershipId
   ) PartnershipMatches ON SchoolPartnership.schoolId = PartnershipMatches.schoolId
   ORDER BY PartnershipMatches.partnershipCount DESC, SchoolMatches.SchoolCount DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:14:25.823

我们对网站的页面也有类似的问题。我们创建了具有所有参数的特殊去规范化搜索表，以执行没有子查询或连接的搜索。所有数据都是重复的，所以当发生变化时，我们会更新所有非规范化数据。我们使用后台任务来同步数据，因此搜索结果在短时间内可能不是实际的。

可能看起来很复杂，但这只有在您的数据和请求会增长的情况下才会如此。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-12-17T11:59:12.793

```
filter_var('sgamgee@example.com', FILTER_VALIDATE_EMAIL); // Returns "sgamgee@example.com" 
```

这是一个有效的电子邮件地址。

# highcharts - 使文本适应高图工具提示最大宽度

> ID：14790459
> 
> 赞同：9
> 
> 时间：2013-02-09T17:00:41.033
> 
> 标签：highcharts

我想垂直调整我的highcharts工具提示中的文本（定义了最大宽度，所以如果文本不适合这个最大宽度，请增加工具提示高度以适应文本）

什么适用于简单的 HTML 内容...

```
#my_div
{
   height:auto;
   max-width:140px;
   overflow:auto
} 
```

不适用于 highcharts 工具提示，请参阅[http://jsfiddle.net/perikut/hNCDb/2/](http://jsfiddle.net/perikut/hNCDb/2/)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-09T19:54:44.073

默认`white-space`设置`nowrap`，您应该将其更改为`normal`.

```
.highcharts-tooltip span {
    height:auto;
    width:140px;
    background-color:green;
    overflow:auto;
    white-space:normal !important; // add this line...
} 
```

[演示](http://jsfiddle.net/hNCDb/3/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-08T21:49:57.797

如果您只想更改`white-space`单个图表的工具提示行为和/或单独控制每个图表的样式，您可以使用以下方法：

```
 tooltip: {
    useHTML: true,
    formatter: function() {
        return "<div style='width: 400px; white-space:normal;'>" + this.points[0].point.yourDataPointValue + "</div>";
    }  
 } 
```

[演示](http://jsfiddle.net/sLfnn/2/)

请注意，如果您想为多个工具提示重用相同的样式，您可以/应该使用类名而不是内联样式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-10-29T12:42:57.727

只需将其添加到图表选项中：

```
tooltip:{
    shared: false,
    useHTML: true
} 
```

然后将以下内容添加到您的 CSS 中：

```
.highcharts-tooltip span {
    height:auto !important;
    width:140px !important;
    max-width:140px !important;
    overflow:auto !important;
    white-space:normal !important; 
} 
```

你已准备好出发！;-)

# couchdb - couchdb 索引器应该如何与 reduce 函数一起使用？

> ID：14790466
> 
> 赞同：0
> 
> 时间：2013-02-09T17:01:42.327
> 
> 标签：couchdb

我有一个视图，其中定义了 map 和 reduce 函数，并且在此视图中缩减和非缩减查询都很有用（这里最需要非缩减查询）。

当它重新索引少量 10k 文档时，CPU 会达到顶峰，并且需要很长时间才能建立完整索引。删除（或简化）reduce 函数解决了这个问题，并且在我可以看到的 couchjs 日志中，reduce/rereduce 调用消耗了所有资源。

问题是：为什么 couchdb 调用 reduce/rereduce 来构建索引，即使使用“reduce=false”选项查询视图？我认为不可能将这些值用作预先计算的，那么我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T10:12:08.253

CouchDB Map/Reduce 索引总是完全预先计算并缓存在磁盘上；从磁盘索引满足查询。

这意味着在哪些方面运行良好存在一些限制，特别是在 reduce 函数中。一般的想法是你的reduce函数应该发出大小恒定的值/结构。这意味着如果您有一个 reduce() 函数来累积数据而不实际减少它（例如将 map 阶段的键或值连接到一个数组中，然后返回该数组），这是一个坏主意。通常，CouchDB 配置了`query_server_config.reduce_limit`设置为 true 的选项，以帮助防止您编写错误的 reduce 函数。

# charts - 基于 CSV 值字符串的 SSRS 2008 R2 迷你图

> ID：14790476
> 
> 赞同：0
> 
> 时间：2013-02-09T17:03:17.957
> 
> 标签：charts, ssrs-2008-r2

我想知道是否可以基于逗号分隔的值列表创建图表/图形。只有 1 个系列，这将是一个迷你图，所以我真的不在乎看到任何一个轴……只是一条上升或下降的线。

来自数据库表的示例输入：1,2,3,4,5 此示例应生成 1 行，其值从左到右递增。

如果需要，我愿意使用 SSRS 中的自定义代码来完成此操作。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T20:40:58.900

在 SSRS 中，您只能将图表指向数据集。我建议您将逗号分隔的数据转换为 xml，然后将您的 xml 数据分解为关系数据，如下所示：

```
WITH ChartData AS
(
    SELECT '1,3,5,4' AS YValues
),
ShrededChartData AS
(
    SELECT Y.value('.','int') AS YValues
    FROM 
    (
        SELECT CAST(N'<root><r>' + REPLACE(YValues,',','</r><r>') + '</r></root>' AS XML) XMLValues
        FROM ChartData 
    ) AS XMLChartData 
    CROSS APPLY XMLValues.nodes('//root/r') AS XmlTable(Y)
)
SELECT YValues
FROM ShrededChartData 
```

然后基于此查询创建数据集并将此数据集指向您的图表。

# java - final vs volatile 保证对象的安全发布

> ID：14790478
> 
> 赞同：25
> 
> 时间：2013-02-09T17:03:24.447
> 
> 标签：java, java-memory-model

来自 Java concurrency in practice 一书：

> 为了安全地发布对象，对象的引用和对象的状态必须同时对其他线程可见。正确构造的对象可以通过以下方式安全地发布：
> 
> *   从静态初始化器初始化对象引用
>     
>     
> *   将对它的引用存储到 volatile 字段或 AtomicReference
>     
>     
> *   将对它的引用存储到正确构造的对象的最终字段中
>     
>     
> *   将对它的引用存储到由
>     锁正确保护的字段中。

我的问题是：

1.  要点 2 和 3 之间有什么区别？我对安全发布对象方面的`volatile`方法和方法之间的区别感兴趣。`final`
2.  *他在第 3 点中正确构造对象*的最终字段是什么意思？在开始项目符号点之前，作者已经提到他们正在谈论一个正确构造的对象（我假设它不会让`this`引用 escape ）。但是为什么他们又一次提到了正确构造的对象？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-09T19:09:41.137

> 要点 2 和 3 之间有什么区别？

*   `volatile`基本上意味着对该字段的任何写入都将从其他线程可见。因此，当您将字段声明为 volatile:`private volatile SomeType field;`时，您可以保证如果构造函数写入该字段：`field = new SomeType();`，则此分配将对随后尝试读取的其他线程可见`field`。
*   `final`具有非常相似的语义：如果您有一个最终字段，则可以保证：对该字段`private final SomeType field;`的写入（在声明中或在构造函数中）：`field = new SomeType();`不会被重新排序，并且*如果对象正确，其他线程将可见已发布*`this`（例如，没有逃脱）。

显然，主要的不同是如果字段是 final 的，你只能分配一次。

> 他在第 3 点中正确构造对象的最终字段是什么意思？

例如，如果您让`this`构造函数逃逸，最终语义提供的保证就消失了：观察线程可能会看到具有默认值的字段（对象为 null）。如果对象构造正确，则不会发生这种情况。

* * *

人为的例子：

```
class SomeClass{
    private final SomeType field;

    SomeClass() {
        new Thread(new Runnable() {
            public void run() {
                SomeType copy = field; //copy could be null
                copy.doSomething(); //could throw NullPointerException
            }
        }).start();
        field = new SomeType();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T19:10:31.467

`volatile`publish与的效果没有区别`final`，除了`final`只能在构造函数中设置一次，因此您阅读的内容永远不会改变。

我相信*正确构造的对象*确实是您所指的对象，该对象的`this`引用没有逃脱其构造函数，并且已以安全的方式发布到使用它的线程。

# django - 无法使用 authenticate() 对用户进行身份验证

> ID：14790480
> 
> 赞同：0
> 
> 时间：2013-02-09T17:03:27.177
> 
> 标签：django

我正在尝试对用户进行身份验证，但是使用`authenticate()`, django (1.4) 返回`None`...我尝试手动查询数据库：

```
select * from auth_user where password = THE_PASSWORD 
```

我让预期的用户回来了。我尝试使用断点进行调试，我发现`check_password()`函数 in正在`django.contrib.auth.hashers`返回......但老实说，我不知道为什么以及如何进一步挖掘问题......任何想法？`False``hasher.verify()`

附言。我没有修改我的原件`SECRET_KEY`

**更新：**

OMG ...我终于找到了问题所在！实际上，在我的应用程序中，我有一个用户注册表格，一旦用户提交该表格，他将收到一封带有激活链接的电子邮件，该链接将用户设置为“活动”......我想实现“自动登录” “一旦用户通过链接被激活并且为了做到这一点，我试图使用散列密码（这是我可以通过编程方式检索的唯一一个）对他进行身份验证，但是 django authenticate() 需要原始密码，因为它是用户在登录表单中手动写入的那个，出于安全原因，它不能从存储在数据库中的散列开始重新生成......所以，我从根本上遵循了一种不好的做法......在我看来，正确的做法是向用户展示一个新页面，上面写着：“恭喜，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T19:30:29.290

如果您使用原始密码手动查询数据库并成功返回用户，这意味着您在数据库中存储了原始密码，而不是散列密码。自然，Django 在数据库中查找散列密码的尝试将失败。

请注意，Django，而不是您，在这里做的是正确的事情：您*必须*存储散列密码，而不是原始密码。

# mysql - MySQL配置：内存使用“危险地高”？

> ID：14790481
> 
> 赞同：0
> 
> 时间：2013-02-09T17:03:28.137
> 
> 标签：mysql

我在专用服务器上使用 DirectAdmin 运行 CentOS（四核 i7 和 ~8Gb RAM），我遇到了 MySQL 的主要问题，可以在[此处](https://serverfault.com/questions/477064/tmp-was-1-8gb-removing-files-older-than-8-days-has-deleted-only-300mb-what)找到更多详细信息。

我刚刚从[这个网站](https://github.com/rackerhacker/MySQLTuner-perl)运行了一个 perl MySQL Tuner 脚本，试图确定问题所在。

可悲的是，输出对我来说没有多大意义：

```
 >>  MySQLTuner 1.2.0 - Major Hayden <major@mhtx.net>
 >>  Bug reports, feature requests, and downloads at http://mysqltuner.com/
 >>  Run with '--help' for additional options and output filtering
Please enter your MySQL administrative login: root
Please enter your MySQL administrative password:

-------- General Statistics --------------------------------------------------
[--] Skipped version check for MySQLTuner script
[OK] Currently running supported MySQL version 5.5.20-log
[OK] Operating on 64-bit architecture

-------- Storage Engine Statistics -------------------------------------------
[--] Status: +Archive -BDB -Federated +InnoDB -ISAM -NDBCluster
[--] Data in MyISAM tables: 236M (Tables: 686)
[--] Data in InnoDB tables: 226M (Tables: 199)
[--] Data in PERFORMANCE_SCHEMA tables: 0B (Tables: 17)
[!!] Total fragmented tables: 312

-------- Security Recommendations  -------------------------------------------
[OK] All database users have passwords assigned

-------- Performance Metrics -------------------------------------------------
[--] Up for: 18h 42m 34s (1M q [18.265 qps], 49K conn, TX: 3B, RX: 835M)
[--] Reads / Writes: 60% / 40%
[--] Total buffers: 528.0M global + 7.0M per thread (1500 max threads)
[!!] Maximum possible memory usage: 10.8G (138% of installed RAM)
[OK] Slow queries: 0% (3/1M)
[OK] Highest usage of available connections: 2% (37/1500)
[OK] Key buffer size / total MyISAM indexes: 64.0M/74.1M
[OK] Key buffer hit rate: 99.9% (8M cached / 5K reads)
[OK] Query cache efficiency: 66.9% (529K cached / 792K selects)
[!!] Query cache prunes per day: 83513
[OK] Sorts requiring temporary tables: 0% (0 temp sorts / 42K sorts)
[!!] Joins performed without indexes: 5962
[OK] Temporary tables created on disk: 5% (5K on disk / 97K total)
[OK] Thread cache hit rate: 99% (37 created / 49K connections)
[OK] Table cache hit rate: 42% (512 open / 1K opened)
[OK] Open file limit used: 10% (756/7K)
[OK] Table locks acquired immediately: 99% (513K immediate / 513K locks)
[!!] InnoDB data size / buffer pool: 226.7M/128.0M

-------- Recommendations -----------------------------------------------------
General recommendations:
    Run OPTIMIZE TABLE to defragment tables for better performance
    MySQL started within last 24 hours - recommendations may be inaccurate
    Reduce your overall MySQL memory footprint for system stability
    Adjust your join queries to always utilize indexes
Variables to adjust:
  *** MySQL's maximum memory usage is dangerously high ***
  *** Add RAM before increasing MySQL buffer variables ***
    query_cache_size (> 64M)
    join_buffer_size (> 2.0M, or always use indexes with joins)
    innodb_buffer_pool_size (>= 226M) 
```

调谐器是否建议我的 MySQL 安装需要超过 8Gb 的 RAM？

我服务器上的主网站每周获得约 30K 的独立访问者，但即便如此，MySQL 肯定没有受到那么严重的打击*吗*？

我的设置`my.cnf`是：

```
[mysqld]
local-infile=0
bind-address=127.0.0.1
max_connections=1500
long_query_time=2
log-slow-queries=/var/log/mysql_slow.log
expire_logs_days=14
external-locking

open_files_limit=1536
key_buffer_size=64M
innodb_buffer_pool_size=128M
innodb_additional_mem_pool_size=8M
innodb_log_buffer_size=8M
group_concat_max_len=16k
max_sort_length=16k
max_length_for_sort_data=16k
query_cache_type=1
query_cache_limit=4M
query_cache_size=64M
innodb_thread_concurrency=16
thread_concurrency=16
thread_cache=128
thread_stack=1M
read_buffer_size=1M
join_buffer_size=2M
read_rnd_buffer_size=1M
table_cache=512
tmp_table_size=256M
max_heap_table_size=256M
log-warnings

[mysqld_safe]
log-error=/var/log/mysqld.log 
```

有人对我如何优化我的 MySQL 安装有任何建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T22:39:25.243

假设您使用 InnoDB，乍一看您并没有使用 RAM 来获取 DB 嗡嗡声。这个怎么样：

```
innodb_buffer_pool_size = 4G 
innodb_log_file_size = 1G 
```

# datagridview - VB.NET 对象引用未设置为对象的实例

> ID：14790485
> 
> 赞同：-1
> 
> 时间：2013-02-09T17:04:12.300
> 
> 标签：datagridview, vb.net-2010

我一直在使用以下代码更改 datagridview 中的单元格值颜色，没有任何问题，直到我将其传输到新项目并将项目连接到不同的服务器。它现在抛出“对象引用未设置为对象的实例”错误。我错过了什么？

它从 GridViewTextBoxColumn1 开始工作，直到它向下移动到 GridViewTextBoxColumn2 并且调试器开始抛出类似的错误。值不能转换为日期时间类型，然后对象引用未设置等。但我到处检查，一切似乎都到位，不明白它是如何以日期时间结束的。

```
 Private Sub TableGrid_CellFormatting(ByVal sender As Object, ByVal e As DataGridViewCellFormattingEventArgs) Handles TableGrid.CellFormatting

    For i As Integer = Nothing To Me.TableGrid.Rows.Count - 1
        If Me.TableGrid.Rows(i).Cells("GridViewTextBoxColumn1").Value <= 0 Then
            Me.TableGrid.Rows(i).Cells("GridViewTextBoxColumn1").Style.ForeColor = Color.Red
        End If
    Next
    For j As Integer = Nothing To Me.TableGrid.Rows.Count - 1
        If Me.TableGrid.Rows(j).Cells("GridViewTextBoxColumn2").Value.ToString = "S" Then
            Me.TableGrid.Rows(j).Cells("GridViewTextBoxColumn2").Style.ForeColor = Color.Blue
        End If
    Next

    For k As Integer = Nothing To Me.TableGrid.Rows.Count - 1
        If Me.TableGrid.Rows(k).Cells("GridViewTextBoxColumn3").Value.ToString = "Z" Then
            Me.TableGrid.Rows(k).Cells("GridViewTextBoxColumn3").Style.ForeColor = Color.Blue
        End If
    Next

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T10:09:47.023

找到了一个对我自己的问题有效的解决方案。但我相信应该有更好的答案。

我的第一个问题中的代码没有测试某些单元格中存在的空值。因此，错误..

```
For i As Integer = 0 To Me.TableGrid.Rows.Count - 1
If Not Me.TableGrid.Rows(i).Cells("DataGridViewTextBoxColumn1").Value Is DBNull.Value Then
If Me.TableGrid.Rows(i).Cells("DataGridViewTextBoxColumn1").Value = "Z" Then
Me.TableGrid.Rows(i).Cells("DataGridViewTextBoxColumn1").Style.ForeColor = Color.Blue
End If
End If

        If Not Me.TableGrid.Rows(i).Cells("DataGridViewTextBoxColumn2").Value Is DBNull.Value Then
            If Me.TableGrid.Rows(i).Cells("DataGridViewTextBoxColumn2").Value <0 Then
                Me.TableGrid.Rows(i).Cells("DataGridViewTextBoxColumn2").Style.ForeColor = Color.Red
            End If
        End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T05:53:10.983

尝试“Dim yourobject As New Yourtype”，因为抛出此异常时通常需要“New”，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T16:41:37.460

通常在尝试引用尚未分配任何内容的对象时会发生此错误，因此请确保您的数据网格单元格中确实有值。

# objective-c - NSData 合并在一起？

> ID：14790490
> 
> 赞同：0
> 
> 时间：2013-02-09T17:04:24.353
> 
> 标签：objective-c, nsdata, bonjour

我通过 Bonjour 发送一些数据：

```
NSString *songString = [NSString stringWithFormat:@"sn:%@", [bHelp song]];
NSString *artistString = [NSString stringWithFormat:@"an:%@", [bHelp artist]];
NSData *imageData = [self PNGRepresentationOfImage:[bHelp getArtwork]];
NSData *songData = [songString dataUsingEncoding:NSUTF8StringEncoding];
NSData *artistData = [artistString dataUsingEncoding:NSUTF8StringEncoding];
[self.server sendData:songData error:nil];
[self.server sendData:artistData error:nil];
[self.server sendData:imageData error:nil]; 
```

然后接收它：

```
NSString *message = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
UIImage *image = [[UIImage alloc] initWithData:data];
if (message != nil) {
    NSLog(message);
    if ([message hasPrefix:@"sn:"]) {
        _songName = [message stringByReplacingOccurrencesOfString:@"sn:" withString:@""];
    } else if ([message hasPrefix:@"an:"]) {
        _artistName = [message stringByReplacingOccurrencesOfString:@"an:" withString:@""];
    }
    return;
}

if (image != nil) {
    self.albumImage = image;
    return;
} 
```

但是`songData`,`artistData`和`imageData`都作为一个接收。一个例子是：`sn:BURN IT DOWNan:Linkin Park`

如果我`imageData`先发送，它永远不会识别`songData`和`artistData`. 如果`imageData`最后送，`songData`混`artistData`在一起，`imageData`绝对不被承认的话。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T19:22:12.693

看来您只是发送了一系列没有分隔符或数据大小指示符的字节。如果你想像你一样发送多个数据块，你需要一种方法来判断一个块在哪里结束，下一个块从哪里开始。

一种常见的方法是发送一个长度，然后是数据。长度将是字节数，并且始终为 4 或 8 个字节。这都将在`sendData:error:`方法中处理。

在接收端，您将读取代表长度的 4 或 8 个字节，然后您将读取`length`字节。

最后，您将发送以下数据：

1.  歌曲数据长度
2.  歌曲数据
3.  艺术家数据长度
4.  艺人资料
5.  图像数据长度
6.  图像数据

# java - 尝试使用 javap 时出现“错误：找不到类”

> ID：14790494
> 
> 赞同：3
> 
> 时间：2013-02-09T17:04:48.997
> 
> 标签：java, javap

我正在尝试查看我的班级的*字节码*，但即使`.class`文件在那里也找不到班级。我可以`Main.java`从 CLI 很好地编译文件，但是使用`javap -c Main`它时找不到类。

```
public class Main {
    public static void main(String args[]) {
        int Y = 0;
        int X = (Y + 4) * 3;
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-09T22:38:23.117

如果该类在默认包中，并且如果您在 Main.class 文件所在的目录中，则使用

```
javap -cp . -c Main 
```

如果你的类在 com.foo.bar 包中，则进入 Main.class 文件所在的目录 (bar)，然后执行以下命令：

```
bar> cd ..
foo> cd ..
com> cd ..
> javap -cp . com.foo.bar.Main 
```

# iis - DNN 或 IIS 401 未经授权的错误和一些失败的诊断尝试

> ID：14790498
> 
> 赞同：4
> 
> 时间：2013-02-09T17:05:05.347
> 
> 标签：iis, dotnetnuke, http-status-code-401

我正在按照 dotnetnuke.com 上的教程进行第一次 DNN 安装，但我一直卡住。我有 Windows 8，所以我无法从 Google 获得答案，所以这是我的问题...

当我启动 dnn 的安装向导时，它看起来像这样：

## ![在此处输入图像描述](../Images/ea50d5234ea64c5e0022e1b30ff01019.png)

样式表和图像显然没有加载，错误控制台如下所示：

## ![在此处输入图像描述](../Images/fca3f7f5d5b2e47e35c2ee59179dee21.png)

好吧，也许这是一个权限问题。我检查了与 IIS 绑定的文件夹的属性，发现它是只读的：

![在此处输入图像描述](../Images/b164d326ee3abcafe70acf17a69a2120.png)

但是设置很顽固，无论我取消选中设置多少次并应用于子文件夹/文件

![在此处输入图像描述](../Images/0ef8d1143a67ef3d222f03cf2d512187.png)

它总是回到说它是只读的。我什至尝试从命令行强制更改：

![在此处输入图像描述](../Images/26a4fc98abe7be2dfb62cf60f1b47520.png)

今天早上我开始想，也许我在追逐错误的线索。也许我忽略了一些 IIS 或 DNN 设置。不幸的是，我已经超出了我的深度。我正在尝试安装 DNN，以便我可以学习它，所以这对我来说是全新的领域。这就是你，Stack Overflow 的伟大人物，进来的地方。请停下来！谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-01-22T21:52:07.230

您需要获取 IIS 身份验证 -> 匿名身份验证 -> “匿名用户身份”以匹配文件目录权限。这是为了允许 DNN 代码在您的文件系统中执行。推荐的设置是使用“应用程序池标识”将您的 IIS 服务器/网站限制在服务器环境的其他部分。

![在此处输入图像描述](../Images/1976c6fba95261f95faac97f62fa2128.png)

从 IIS 管理控制台或 wwwroot\yourDNNinstalllocation 文件夹将“IIS AppPool\ApplicationPoolName”的权限设置为 MODIFY。注意：Windows 权限将要求**位置**为“您的 IIS 服务器或 PC 名称”，而不是任何域位置。

如果您确实需要域角色并在数据库服务器上集成 SQL 安全性，那么您需要

1.  创建一个域\用户，例如“yourDomain\dnn_yourCustomer”然后
2.  将该用户添加到 DNN 数据库的 SQL 安全性和
3.  更改您的 IIS 匿名身份以使用域\用户和
4.  将 www 文件夹的权限设置为 MODIFY 以匹配您的域\用户。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T03:03:28.393

您可能会检查是否在 IIS 中启用了 STATIC 内容？

为此，请转到开始，运行，键入添加删除程序，然后单击打开或关闭 Windows 功能

在 Internet 信息服务下，转到万维网服务部分，通用 HTTP 功能并确保启用静态内容。

**更新：** 您可以安装此 HOTFIX 并查看是否可以解决问题吗？[http://support.microsoft.com/kb/980368](http://support.microsoft.com/kb/980368)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-11T20:20:48.587

好的，我修好了。也许不是“修复它”，而是“这次没有破坏它”。我删除/卸载了所有内容并返回到第一个视频。我之前没有注意到的部分是他说如果您使用的是 SQL Server Management Studio ***Express***，请跳过设置数据库的步骤。所以我做到了，一切正常。

当我在 Google 上搜索“IIS 401.3 未经授权的错误”时，我发现了另一个步骤。它说将 IUSR 用户添加到 dnndev.me 文件夹的安全设置中。我不确定这是否在解决问题方面发挥了任何作用，但它也没有造成任何伤害。

总之，问题解决了。谢谢你，克里斯，你的答复。感谢您的帮助，我期待在 dnn.com 上深入了解您的其他教程视频

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-01T16:16:51.110

我知道我迟到了，但我也遇到了这个问题，并试图使用这里的答案来解决它。在尝试了上述修复后，我无法让它全部工作，所以我查看了 IIS 中默认应用程序的权限。它有两个用户叫`WEBMGR1\Users`和`WEBMGR1\IIS_IUSRS`。我添加了他们两个，它的工作。

# ios - 渲染 PDF 页面，在屏幕边缘显示页面指南和日期

> ID：14790500
> 
> 赞同：1
> 
> 时间：2013-02-09T17:05:07.163
> 
> 标签：ios

我正在尝试渲染 pdf 文档的页面。在 Adob​​e Reader 中打开 pdf 可以正确显示页面。当我尝试将其渲染到视图中时，我会在屏幕边缘看到额外的“项目”。它们看起来像指南和页面创建日期。我已经尝试使用所有 PDFBox 选项，但我无法找到正确的选项。我正在使用 TiledPDFView 类来呈现页面。它使用`CATiledLayer`类。以下是相关方法。

```
-(void)drawLayer:(CALayer *)layer inContext:(CGContextRef)ctx
{
    CGContextSetRGBFillColor(ctx, 1.0,1.0,1.0,1.0);
    CGContextFillRect(ctx, self.bounds);
    CGContextSaveGState(ctx);
    CGContextTranslateCTM(ctx, 0.0, self.bounds.size.height);
    CGContextScaleCTM(ctx, 1.0, -1.0);
    //I've tried many options in the PDFBox parameter.
    CGContextConcatCTM(ctx, CGPDFPageGetDrawingTransform(pdfPage, kCGPDFCropBox, self.bounds, 0, false));
    CGContextDrawPDFPage(ctx, pdfPage);
    CGContextRestoreGState(ctx);
} 
```

我真的不确定如何删除这些准则。这可能只是我的界限问题。

![图片！](../Images/d3a71c13dc8b6bd0c29f1ddfcc1ca2d3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T16:54:15.510

我能够通过不使用该`CGPDFPageGetDrawingTransform`方法而自己进行转换来解决这个问题。我找到了一些代码，我将在这里分享以供将来参考。我不记得我从哪里得到代码的:(。

```
-(void)drawRect:(CGRect)rect
{
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetFillColorWithColor(context, [UIColor whiteColor].CGColor);
    CGContextFillRect(context, rect);
    CGContextGetCTM(context);
    CGContextScaleCTM(context,1,-1);
    CGContextTranslateCTM(context, 0, -rect.size.height);
    CGRect mediaRect = CGPDFPageGetBoxRect(pdfPage, kCGPDFCropBox);
    CGContextScaleCTM(context, rect.size.width/mediaRect.size.width, rect.size.height / mediaRect.size.height);
    CGContextTranslateCTM(context, -mediaRect.origin.x, -mediaRect.origin.y);
    CGContextDrawPDFPage(context, pdfPage);
} 
```

# javascript - 如何在codeigniter中获取json对象的值

> ID：14790502
> 
> 赞同：0
> 
> 时间：2013-02-09T17:05:10.297
> 
> 标签：javascript, jquery, ajax, codeigniter

我正在使用 codeigniter 框架来开发我的网站。目前我正在使用 jQuery 发送 AJAX 请求以从服务器获取数据。我尝试了两种方法，一种是数据在 PHP 关联数组中，另一种是在 JSON 对象中。请查看我从 AJAX 请求返回的数据：

```
{
    "o": [
        {
            "q_id": "83",
            "t_id": "4",
            "question": "jjjjs.jfdaskldjf",
            "option1": "jjjjasdfasdf",
            "option2": "jjj",
            "option3": "lll",
            "option4": "lll",
            "answer": "lll",
            "marks": "22"
        },
        {
            "q_id": "84",
            "t_id": "4",
            "question": "This is testing",
            "option1": "2",
            "option2": "7",
            "option3": "8",
            "option4": "9",
            "answer": "2",
            "marks": "2"
        },
        {
            "q_id": "85",
            "t_id": "4",
            "question": "hello this is another test",
            "option1": "a",
            "option2": "b",
            "option3": "c",
            "option4": "d",
            "answer": "a",
            "marks": "2"
        },
        {
            "q_id": "86",
            "t_id": "4",
            "question": "another test",
            "option1": "8",
            "option2": "9",
            "option3": "0",
            "option4": "1",
            "answer": "1",
            "marks": "2"
        },
        {
            "q_id": "87",
            "t_id": "4",
            "question": "last question ",
            "option1": "z",
            "option2": "x",
            "option3": "c",
            "option4": "v",
            "answer": "c",
            "marks": "2"
        }
    ]
} 
```

我以以下方式访问它：

```
alert(data["o"][0]); 
```

但是发生的错误是：

> 未捕获的类型错误：无法读取未定义的属性“0”

谁能给我一些关于如何获取值或将对象存储在数组中的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:11:56.533

因为 o 这里是一个对象广告而不是一个数组..使用`.`

试试这个

```
alert(data.o[0]) 
```

使用循环`$.each`函数获取里面对象的值`o`

```
data.o[0].each(function(i,v){
   console.log(v.q_id);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-16T02:49:33.660

尝试使用 Std Object 将 JSON 发送到您的 javascript 代码

我的代码如下：

var model = new StdObject(); 模型->blabla =“某事”；

返回模型；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T05:34:38.443

```
header("content-type:application/json"); 
```

* * *

*   由服务器与您的 json 一起发送？

* * *

下一次检查：

* * *

*   使用 $.getJSON 或 $.ajax`datatype='json'`

* * *

最后，然后访问您的对象`data.o['0'].q_id`

# c# - EF Code First - ConcurrencyCheck 和乐观并发

> ID：14790503
> 
> 赞同：0
> 
> 时间：2013-02-09T17:05:14.930
> 
> 标签：c#, entity-framework, concurrency

是否可以编写一个采用当前上下文的方法，然后尝试保存对其的更改，但如果失败，它会刷新 db 中的值并再次应用更改？我有这个：

```
private static void SaveChanges(ScykDb context)
{
    var savedChanges = false;
    while (!savedChanges)
    {
        try
        {
            context.SaveChanges();
            savedChanges = true;
        }
        catch (DbUpdateConcurrencyException ex)
        {
            var objContext = ((IObjectContextAdapter)context).ObjectContext;
            objContext.Refresh(RefreshMode.StoreWins, ex.Entries.Select(e => e.Entity));

        }
    }
} 
```

但它所做的只是应用预先修改的值或保持数据不变（取决于`RefreshMode`）。我希望这段代码从数据库中获取数据，然后对其应用更改。这可能是不可能的，但我很好奇。

# c# - DataServiceContext 保存或更新

> ID：14790507
> 
> 赞同：0
> 
> 时间：2013-02-09T17:05:35.760
> 
> 标签：c#, wcf, entity-framework

这应该更简单，微软，嗯，不是吗？

```
public abstract class AbstractRepository<TContext> : IRepository
    where TContext : DataServiceContext
{
    protected TContext Context;

    public void SaveOrUpdate<TEntity>(TEntity entity)
    {
        try
        {
            this.Context.UpdateObject(entity);
        }
        catch
        {
            try
            {

                this.Context.AddObject(this.ResolveEntitySet(typeof(TEntity)), entity);
            }
            catch
            {

            }
        }
    }

    private string ResolveEntitySet(Type type)
    {
        var entitySetAttribute = (EntitySetAttribute)type.GetCustomAttributes(typeof(EntitySetAttribute), true).FirstOrDefault();

        if (entitySetAttribute != null)
            return entitySetAttribute.EntitySet;

        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:28:00.983

你在寻找更多这样的东西吗？

```
public class EfRepository<T> : IRepository<T> where T : class
    {
           public EfRepository(DbContext dbContext)
           {
               if(dbContext == null)
                   throw new ArgumentNullException("dbContext");

               DbContext = dbContext;
               DbSet = DbContext.Set<T>();
           }

           protected DbContext DbContext { get; set; }
           protected DbSet<T> DbSet { get; set; } 

        public virtual IQueryable<T> GetAll()
        {
            return DbSet;
        }

        public virtual T GetById(int id)
        {
            return DbSet.Find(id);
        }

        public virtual void Add(T entity)
        {
            DbEntityEntry dbEntityEntry = DbContext.Entry(entity);
            if (dbEntityEntry.State != EntityState.Detached)
            {
                dbEntityEntry.State = EntityState.Added;
            }
            else
            {
                DbSet.Add(entity);
            }
        }

        public virtual void Update(T entity)
        {
            DbEntityEntry dbEntityEntry = DbContext.Entry(entity);
            if (dbEntityEntry.State == EntityState.Detached)
            {
                DbSet.Attach(entity);
            }
            dbEntityEntry.State = EntityState.Modified;
        }

        public virtual void Delete(T entity)
        {
            DbEntityEntry dbEntityEntry = DbContext.Entry(entity);
            if (dbEntityEntry.State != EntityState.Deleted)
            {
                dbEntityEntry.State = EntityState.Deleted;
            }
            else
            {
                DbSet.Attach(entity);
                DbSet.Remove(entity);
            }
        }

        public virtual void Delete(int id)
        {
            var entity = GetById(id);
            if (entity == null) return;
            Delete(entity);
        }
    } 
```

# php - 包含英镑（英镑）符号的 POST 变量会中断对 MySQL 数据库的提交

> ID：14790508
> 
> 赞同：-3
> 
> 时间：2013-02-09T17:05:36.350
> 
> 标签：php, mysql, post, encoding

我在我的 Mac 上使用了一些名为“Minco”的时间跟踪软件，它有一个功能，可以将软件记录的所有时间发送到 PHP 脚本以添加到 MySQL 数据库中。我有这个工作正常，使用 POST 方法将数据从软件发送到脚本，脚本将 POST 变量提交到数据库，即：

```
$sql = "INSERT INTO $table_name VALUES('','$_POST[title]', '$_POST[date]', '$_POST[start]', '$_POST[end]', '$_POST[minutes]', '$_POST[amount]', '$_POST[notes]', '$_POST[uid]', '$_POST[type]', '$_POST[hash]')"; 
```

但是，当我将软件设置为包含“金额”变量时，我遇到了一个问题。这个变量包含一个英镑（Sterling）符号，当包含它时，它会中断所有其他变量到数据库的提交，即添加了一个新行，但所有列都没有输入任何内容。

我假设该问题与井号的编码/解码有关，但我不确定如何解决此问题。有人可以建议我怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:26:27.407

请使用列列表和准备好的语句。

如果目标列不需要 HTML 字符，那么您应该在发送之前将其剥离。

```
<?php
$link = mysqli_connect('localhost', 'my_user', 'my_password', 'world');

/* check connection */
if (!$link) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$stmt = mysqli_prepare($link, "INSERT INTO $tableName (col1, col2, col3, col4) VALUES (?, ?, ?, ?)");
mysqli_stmt_bind_param($stmt, 'ssss', $_POST[title], $_POST[date], $_POST[start], $_POST[end]);

/* execute prepared statement */
mysqli_stmt_execute($stmt);

printf("%d Row inserted.\n", mysqli_stmt_affected_rows($stmt));

/* close statement and connection */
mysqli_stmt_close($stmt);

/* close connection */
mysqli_close($link);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:21:43.000

你可以用不同的方式处理它

*   利用`mysql(i)_real_escape_string($_POST[])`
*   或者

    $amount = $_POST[amount]';

    $amount = str_replace ('你的磅符号','',$amount) ;

`$amount`并在你的字符串中使用变量

*   你也可以试试这个`'\$_POST[amount]\'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T19:26:11.063

可以尝试的东西很少。确实，当字符串用双引号括起来时，您可以将 $variables 直接包含在字符串中，但是当您插入数组变量时，您必须将其括*在*花括号中：

```
$myvar = "{$_POST['myvar']}"; 
```

我个人只是连接你的字符串，这样你就可以使用 mysql_real_escape_string() 方法来转义进入 MySQL 的值。类似于以下内容：

```
$sql = "INSERT INTO $table_name 
        VALUES('',
               '" . mysql_real_escape_string($_POST["title"]) . "', 
               '" . mysql_real_escape_string($_POST["date"]) . "', 
               '" . mysql_real_escape_string($_POST["start"]) . "', 
               '" . mysql_real_escape_string($_POST["end"]) . "', 
               '" . mysql_real_escape_string($_POST["minutes"]) . "', 
               '" . mysql_real_escape_string($_POST["amount"]) . "', 
               '" . mysql_real_escape_string($_POST["notes"]) . "', 
               '" . mysql_real_escape_string($_POST["uid"]) . "', 
               '" . mysql_real_escape_string($_POST["type"]) . "', 
               '" . mysql_real_escape_string($_POST["hash"]) . "')"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T20:36:08.100

如果您的页面使用 ISO-8859-1 编码，但您的数据库使用 UTF-8 编码，那么您将尝试将井号作为 0xA3 字节发送，数据库将拒绝该字节为无效的 UTF-8 序列。

使用 UTF-8 编码的页面的反向错误，但使用 ISO-8859-1 编码的数据库更难发现，因为数据库只会认为您发送的是 0xC20xA3 字节序列而不是 U+00A3 字符。

# java - 动态系统日期的Java代码并发出警报

> ID：14790510
> 
> 赞同：0
> 
> 时间：2013-02-09T17:06:11.440
> 
> 标签：java

我正在尝试编写一个 java 代码，它将在一天中的特定时间发出警报，但我不知道我为什么会失败（请对我的问题保持温和，因为我对编程完全陌生）。我有这个代码

```
 new ScheduledThreadPoolExecutor(1).schedule(new Runnable() {
    public void run() {
        if(Calendar.SECOND==30)
        {
            JOptionPane.showMessageDialog(null, "Hola Amigo");
        }
    }
}, 1, TimeUnit.SECONDS); 
```

我应该尝试刷新页面吗？请帮忙...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:15:52.413

您正在检查一个固定常数值`Calendar.SECOND`( `13`) 是否等于`30`。显然，这永远不会是真的，所以对话框永远不会出现。您需要在`Calendar` *实例*中检查此字段。

也使用`schedule`意味着执行线程只运行一次。使用`scheduleAtFixedRate`.

此外，您还需要调用`showMessageDialog`以`EDT`确保调用不会阻塞`Executor` `Thread`.

```
ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);
scheduler.scheduleAtFixedRate(new Runnable() {
    public void run() {
        Calendar calendar = Calendar.getInstance();
        int second = calendar.get(Calendar.SECOND);
        if (second == 30) {
            SwingUtilities.invokeLater(new Runnable() {
                @Override
                public void run() {
                    JOptionPane.showMessageDialog(null, "Hola Amigo");
                }
            });
        }
    }
}, 1, 1, TimeUnit.SECONDS); 
```

如果你想`ExecutorService`每 30 秒调用一次而不是重复检查当前秒，你可以调用

```
scheduler.scheduleAtFixedRate(myRunnable, 1, 30, TimeUnit.SECONDS); 
```

# matlab - 使用 MATLAB 估计误差（最小二乘）

> ID：14790511
> 
> 赞同：1
> 
> 时间：2013-02-09T17:06:17.347
> 
> 标签：matlab, least-squares

我有等式 ln(c)=-1/2k^2 * z^2，其中 y = ln(c)，x = z^2 和 a = -1/2k^2。

我想估计`a`，所以：

```
a = polyfit(z.^2, log(abs(c)), 1) 
```

因为我有（初始）方程 c = exp(-z^2/2k^2)，所以我从上面创建了两个值`a`，现在我想估计 k (k1)，所以我这样做：

```
k1 = sqrt(-1/2*a(1)) 
```

现在，我想使用 k1 和 z 的值来预测 c 和错误。所以，我这样做：

```
c_predict = polyval(a,z)
c1 = exp((-z.^2)/2*k1^2)
error = c_predict - c1 
```

要不就：

```
c1 = exp((-z.^2)./2*s1^2)
error1 = c - c1 
```

什么是正确的？

```
error = c_predict - c1 
```

或者

```
error = c - c1 
```

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T03:53:18.363

尝试查看 norm 命令：

相对最小二乘误差 =`norm(y-y',2)/norm(y)`

y 是您的原始信号，y' 是您测量误差的信号。

看[这里](http://www.mathworks.com/help/matlab/ref/norm.html)

# ruby-on-rails-3.2 - 哪种定义路线的方式更适合 Rails Way 并被推荐？

> ID：14790512
> 
> 赞同：0
> 
> 时间：2013-02-09T17:06:18.130
> 
> 标签：ruby-on-rails-3.2

假设我现在只需要一个 GET REST 服务，当我转到这个地址时它会返回 JSON：

```
http://localhost:3000/population_management/1.json 
```

一种方法是以这种方式定义它：

```
resources :population_management, :only => [:show] 
```

一种方法是以这种方式定义它：

```
 resources :population_management

  match "population_management/:id" => "population_management#show", :via => :get 
```

我相信还有其他方法，那么您的建议是什么，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:01:42.903

第**一个**解决方案更清晰。另外，Rails 已经定义了您在解决方案二中编写的内容（通过使用`resources`->[参见此处](http://guides.rubyonrails.org/routing.html#resources-on-the-web)），因此让 Rails 完成它的工作，仅将这些资源限制为 1 条路线。

# mysql - UTF-8 和 mymysql 包

> ID：14790517
> 
> 赞同：1
> 
> 时间：2013-02-09T17:07:00.873
> 
> 标签：mysql, go

我正在使用[mymysql](http://godoc.org/github.com/ziutek/mymysql)将记录插入到 Go 中的 MySQL 数据库中。

我正在尝试将 UTF-8 编码的数据插入表中。如果我直接使用 mysql 命令提示符插入数据，它工作正常。如果我使用 mymysql，`L’ Échafaud`则变为`Lâ€™ Ã‰chafaud`.

据我了解，mymysql 默认使用 UTF-8。以防万一我添加了明确的`db.Register("set names utf8")`，但这也没有帮助。

如果我在插入字符串之前将它们打印到屏幕上，它们似乎被正确编码。

我还需要在 Go 中做些什么来插入 UTF-8 编码的字符串吗？

以下是相关的代码部分：

```
func NewDbConnection(dbName string, dbServer string, dbUser string, dbPass string) (*Db, error) {
    me := Db{}
    me.Conn = mysql.New("tcp", "", dbServer, dbUser, dbPass, dbName)
    err := me.Conn.Connect()
    me.Conn.Register("set names utf8")
    return &me, err
}

func (db *Db) InsertRelease(r Release) (uint64, error) {
    stmt, err := db.Conn.Prepare(`insert into releases
        (name,artist_id,itunes_id,genre,label_name,image_source,
        created_at,updated_at,date,scraped,itunes)
        values (?,?,?,?,?,?,?,?,?,true,?)`)

    res, err := stmt.Run(r.Name, r.ArtistID, r.ItunesID, r.Genre, r.LabelName,
        r.ImageURL, r.CreatedAt, r.UpdatedAt, r.ReleaseDate, r.ItunesURL)
    return res.InsertId(), err
}

type Release struct {
    ID, ArtistID, ItunesID, ArtistItunesID, Type int
    Name, ImageURL, Genre, LabelName             string
    ItunesURL                                    string
    ReleaseDate, CreatedAt, UpdatedAt            time.Time
} 
```

# python - 使用 Python 3 将一个文件的内容复制到另一个文件中

> ID：14790519
> 
> 赞同：1
> 
> 时间：2013-02-09T17:07:14.260
> 
> 标签：python, python-3.x, file-handling

我编写了以下代码，目的是将 abc.txt 的内容复制到另一个文件 xyz.txt

但该声明`b_file.write(a_file.read())`似乎没有按预期工作。如果我用某个字符串替换 a_file.read() ，它（字符串）就会被打印出来。

```
import locale
with open('/home/chirag/abc.txt','r', encoding = locale.getpreferredencoding()) as a_file:
    print(a_file.read())
    print(a_file.closed)

    with open('/home/chirag/xyz.txt','w', encoding = locale.getpreferredencoding()) as b_file:
        b_file.write(a_file.read())

    with open('/home/chirag/xyz.txt','r', encoding = locale.getpreferredencoding()) as b_file:
        print(b_file.read()) 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-09T17:08:29.593

你正在寻找[`shutil.copyfileobj()`](http://docs.python.org/3/library/shutil.html#shutil.copyfileobj).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-09T19:44:10.417

你打`a_file.read()`了两次电话。它第一次读取整个文件时，但在打开后尝试再次读取时丢失了`xyz.txt`- 因此没有任何内容写入该文件。试试这个来避免这个问题：

```
import locale
with open('/home/chirag/abc.txt','r',
          encoding=locale.getpreferredencoding()) as a_file:
    a_content = a_file.read()  # only do once
    print(a_content)
    # print(a_file.closed) # not really useful information

    with open('/home/chirag/xyz.txt','w',
              encoding=locale.getpreferredencoding()) as b_file:
        b_file.write(a_content)

    with open('/home/chirag/xyz.txt','r',
              encoding=locale.getpreferredencoding()) as b_file:
        print(b_file.read()) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-10T00:05:49.880

要将 abc.txt 的内容复制到 xyz.txt，您可以使用[`shutil.copyfile()`](http://docs.python.org/3/library/shutil.html#shutil.copyfile)：

```
import shutil

shutil.copyfile("abc.txt", "xyz.txt") 
```

# php - 从一堆字符串创建 url 链接

> ID：14790525
> 
> 赞同：0
> 
> 时间：2013-02-09T17:08:11.130
> 
> 标签：php, regex

我有一堆字符串连接在一起成为一个包含文本和链接的字符串。我想在字符串中找到 URL，并希望将它们放入`href`每个 URL（创建一个链接）。我正在使用正则表达式模式来查找字符串中的 URL（链接）。检查下面的示例：

例子 ：

```
 <?php

// The Text you want to filter for urls
        $text = "The text you want to filter goes here. http://google.com/abc/pqr
2The text you want to filter goes here. http://google.in/abc/pqr
3The text you want to filter goes here. http://google.org/abc/pqr
4The text you want to filter goes here. http://www.google.de/abc/pqr";

// The Regular Expression filter
        $reg_exUrl = "/(http|https|ftp|ftps)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(\/\S*)?/";

// Check if there is a url in the text
        if (preg_match($reg_exUrl, $text, $url)) {
            // make the urls hyper links
            echo preg_replace($reg_exUrl, "<a href='.$url[0].'>" . $url[0] . "</a> ", $text);
        } else {
            // if no urls in the text just return the text
            echo $text . "<br/>";
        }
        ?> 
```

但它显示以下输出：

```
>  The text you want to filter goes here. **http://google.com/abc/pqr** 2The
> text you want to filter goes here. **http://google.com/abc/pqr** 3The text
> you want to filter goes here. **http://google.com/abc/pqr** 4The text you
> want to filter goes here. **http://google.com/abc/pqr** 
```

这有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:07:34.277

由于您的正则表达式是用斜杠分隔的，因此当您的正则表达式包含它们时，您需要非常小心。通常，使用不同的字符来分隔正则表达式会更容易：PHP 不介意您使用什么。

尝试将第一个和最后一个“/”字符替换为另一个字符，例如“#”，您的代码可能会起作用。

您还可以简化代码并在一次调用 preg_replace 中完成整个操作，如下所示：

```
<?php

$text = 'The text you want to filter goes here. http://google.com/abc/pqr
    2The text you want to filter goes here. http://google.in/abc/pqr
    3The text you want to filter goes here. http://google.org/abc/pqr
    4The text you want to filter goes here. http://www.google.de/abc/pqr';

echo preg_replace('#(http|https|ftp|ftps)\://[a-zA-Z0-9-.]+.[a-zA-Z]{2,3}(/\S*)?#i', '<a href="$0">$0</a>', $text); 
```

# java - JSONParser 无法读取 JSON 文件

> ID：14790527
> 
> 赞同：0
> 
> 时间：2013-02-09T17:08:14.180
> 
> 标签：java, json, simplejson

我正在使用 Json 文件通过以下代码保存有关用户的一些信息：

```
Login login = new Login(email, token, jsessionId);

            JSONObject jsonObj = new JSONObject();

            JSONObject userDetail = new JSONObject();

            JSONArray listFiles = new JSONArray();

            userDetail.put("email", email);
            token = EncodeUtil.encode(token);
            userDetail.put("token", token);
            userDetail.put("files", listFiles);

            try {

                if (!(file.exists())) {

                    JSONArray userDetails = new JSONArray();
                    userDetails.add(userDetail);
                    jsonObj.put("users", userDetails);

                    FileWriter fileWriter = new FileWriter(file);
                    fileWriter.write(jsonObj.toString());
                    fileWriter.flush();
                    fileWriter.close();

                } else {

                    boolean emailExists = true;

                    JSONParser parser = new JSONParser();
                    Object obj = parser.parse(new FileReader(file));
                    JSONObject jsonObjReader = (JSONObject) obj;
                    JSONArray jsonArrayWriter = (JSONArray) jsonObjReader.get("users");
                    int length = jsonArrayWriter.size();
                    for (int i = 0; i < length; i++) {
                        Object currentObj = jsonArrayWriter.get(i);
                        JSONObject currentJson = (JSONObject) currentObj;
                        String email2 = (String) currentJson.get("email");
                        if (email2.equals(email)) {
                            emailExists = true;
                        } else {
                            emailExists = false;
                        }
                    }

                    if (!emailExists) {
                        jsonArrayWriter.add(userDetail);
                        jsonObj.put("users", jsonArrayWriter);
                        FileWriter fileWriter = new FileWriter(file);
                        fileWriter.write(jsonObj.toString());
                        fileWriter.flush();
                        fileWriter.close();
                    }
                }

            } catch (Exception e) {

                Logger.getLogger(LoginLocalServiceImpl.class.getName()).log(Level.SEVERE, e.getMessage());

                throw new PortalException("Erro ao ler Json File");
            } 
```

它工作正常并返回一个具有这种结构的 JSON：

```
{"users":[
      {"files":[],
       "token":"XXXX",
       "email":"XXXX"}
     ]
} 
```

然后我尝试使用上面的代码在 files[] 数组中添加一些信息：

```
try {

                JSONObject fileRef = new JSONObject();
                fileRef.put("date", date);
                fileRef.put("type", type);
                fileRef.put("name", name);

                JSONParser parser = new JSONParser();
                Object obj = parser.parse(new FileReader(file));

                JSONObject jsonObjReader = (JSONObject) obj;
                JSONArray jsonArrayUsers = (JSONArray) jsonObjReader.get("users");

                for (int i = 0; i < jsonArrayUsers.size(); i++) {
                    JSONObject jsonTest = (JSONObject) jsonArrayUsers.get(i);
                    String emailTest = (String) jsonTest.get("email");
                    if (emailTest.equals(email)) {
                        JSONArray jsonArrayFiles = (JSONArray) jsonTest.get("files");
                        jsonArrayFiles.add(fileRef);
           //             jsonTest.put("files", jsonArrayFiles);
           //             jsonArrayUsers.add(jsonTest);
           //             jsonObjReader.put("users", jsonArrayUsers);

                        //            System.out.println(jsonArrayFiles.toString());

                    }
                }
                FileWriter fileWriter = new FileWriter(file);
                fileWriter.write(jsonObjReader.toString());
                fileWriter.flush();
                fileWriter.close();

            } catch (IOException ex) {
                Logger.getLogger(MainViewController.class.getName()).log(Level.SEVERE, null, ex);
            } catch (ParseException ex) {
                Logger.getLogger(MainViewController.class.getName()).log(Level.SEVERE, null, ex);
            } 
```

我的 json 文件现在显示了我想要的内容：

```
{"users":[
      {"files":[
            {"name":"d9f6cd671a384fe59bae29e2718463b5",
             "type":"Apresentação",
             "date":Sat Feb 09 13:48:32 GMT-03:00 2013}
           ],
       "email":"XXXX",
       "token":"XXXX"
      }
     ]
} 
```

到这里为止没问题。但是，当我尝试使用 JSONParser 使用第一个代码再次加载我的 json 时，它无法读取，为什么？一切似乎都很好:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T19:21:45.757

日期应该用引号括起来

```
{
    "users": [{
        "files":[{
            "name":"d9f6cd671a384fe59bae29e2718463b5",
            "type":"Apresentação",
            "date":"Sat Feb 09 13:48:32 GMT-03:00 2013"
        }],
        "email":"XXXX",
        "token":"XXXX"
    }]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:16:02.183

我假设格式错误的日期字符串是一个错字，因为库不会产生该输出。我注意到您正在编写值超出 U+007F 的代码点。

```
FileWriter fileWriter = new FileWriter(file); 
```

在任何不使用 Unicode 转换格式 (UTF) 作为其默认编码的系统上，上述行都是有缺陷的。[该文档](http://docs.oracle.com/javase/7/docs/api/java/io/FileWriter.html#FileWriter%28java.io.File%29)指出：

> 此类的构造函数假定默认字符编码

相同的问题存在于`FileReader`. 应避免这两种类型。

JSON[要求](https://www.rfc-editor.org/rfc/rfc4627#section-3)Unicode：

> JSON 文本应以 Unicode 编码。默认编码为 UTF-8。

如果您需要将字符数据直接提供给您正在使用的 JSON API，那么您必须指定编码。

阅读：

```
try (InputStream in = new FileInputStream(filename);
     Reader reader = new InputStreamReader(in, StandardCharsets.UTF_8)) {
  // read from stream
} 
```

写作：

```
try (OutputStream out = new FileOutputStream(filename);
     Writer writer = new OutputStreamWriter(out, StandardCharsets.UTF_8)) {
  // write to stream
} 
```

这是 Java 7 代码，但相同的原则适用于早期版本。有关 Java 中字符编码的粗略指南，请参见[此处](http://illegalargumentexception.blogspot.co.uk/2009/05/java-rough-guide-to-character-encoding.html)。读取机制不完整，因为它没有检测到正在使用哪个 UTF - 请参阅[规范](https://www.rfc-editor.org/rfc/rfc4627#section-3)以了解必要的字节模式检测。

*正如一位评论者指出的那样，仅仅说“它不起作用！”是不够的。- 你必须详细说明失败的性质。Java 开发人员期望错误堆栈跟踪。*

# mysql - 查询“如果不存在” ....为什么它不起作用？

> ID：14790528
> 
> 赞同：0
> 
> 时间：2013-02-09T17:08:20.957
> 
> 标签：mysql, if-statement, triggers

我有一个触发器：

```
CREATE TRIGGER BEFORE_DELETE_ON_SENTIERO__HA__TAPPA
BEFORE DELETE ON SENTIERO__HA__TAPPA
FOR EACH ROW 
BEGIN

DECLARE temp_prima_tappa INTEGER;
DECLARE temp_ultima_tappa INTEGER;

-- NOW THIS QUERY WILL FAIL;   it checks if the record that has to be deleted is in the table
IF NOT EXISTS ( SELECT *
                FROM SENTIERO__HA__TAPPA as sht
                WHERE OLD.IDsentiero=sht.IDsentiero and OLD.IDtappa=sht.IDtappa) THEN

                        SIGNAL SQLSTATE '45000'
                        SET MESSAGE_TEXT = 'DELETE: La tappa indicata non è nel sentiero; impossibile elimnarla';

END IF; 
```

**IDsentiero 和 IDtappa 是**它们相关表的 PK：**IDsentiero 代表 SENTIERO，IDtappa 代表 TAPPA。**

问题是**DELETE QUERY 没有用该错误消息回复我**；只是**它让运行 DELETE QUERY，虽然它不能删除任何东西**，因为该记录在表中不存在。

问题是那个查询..我确定，但我找不到错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:30:34.487

删除触发器仅在实际删除的行上运行，因此当触发器运行时，该行必须存在。您不能使用触发器来查找无效的删除语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:30:12.167

像这样的东西应该工作：

```
declare recsexist int;
set recsexist = 0;  

SELECT 1 INTO recsexist 
FROM SENTIERO__HA__TAPPA as sht
WHERE OLD.IDsentiero=sht.IDsentiero and OLD.IDtappa=sht.IDtappa;

IF (recsexist > 0) THEN
     ...

END IF; 
```

# android - 如何在android中解析这种类型的soap数组响应

> ID：14790532
> 
> 赞同：1
> 
> 时间：2013-02-09T17:08:37.627
> 
> 标签：android, ksoap2

我想在android中解析带有名称标签的选项标签，我想对数组列表数据进行这种类型的解析[[anyType{}]，[Man，Kid，Women，Maddy]，[Sandy]]

```
AuthenticateResponse
    {
      Options=anyType
      {
         Form=anyType
          {
           Name=Form;id=12; option=anyType{};
          }; 
        Form=anyType
          {
        Name=Form1 ;id=13; 
       option=anyType
           {
           Name=Man;Id=167;Value=textview;Select=male,female 
           };
       option=anyType
           {
          Name=Kid;Id=157;Value=checkbox;Select=graduate,postgraduate 
           };
        option=anyType
           {
           Name=Women;Id=147;Value=textview;Select=lower,upper 
           };
        option=anyType
           {
           Name=Maddy;Id=167;Value=textview;Select=male,female 
           };
         }; 

     Form=anyType
          {
           Name=Form;id=17;
         option=anyType
           {
        Name=Sandy;Id=187;Value=checkbox;Select=door,close 
           };
          }; 

    }; 
    }; 
```

请帮帮我

# c - pthreads 函数是否在内部设置 errno？

> ID：14790535
> 
> 赞同：4
> 
> 时间：2013-02-09T17:08:44.147
> 
> 标签：c, linux, pthreads

在下面的代码中，我调用 pthread_join()，线程 id 为 self。结果是它返回错误号 35。所以我也试图用 perror 打印。但它正在显示“成功”。我的疑问是库/系统调用是否需要为任何错误明确设置 errno 或者我错过了什么？

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>
#include <pthread.h>

#define DEATH(mess) { perror(mess); exit(errno); }

static void * threadFunc(void *arg)
{
 void *res;
 printf("sleeping for 2 sec ...\n");
 sleep(2);
 char *s = (char *) arg;
 pthread_t t = pthread_self();
 int relval = pthread_join(t, &res);

 if (relval) 
  perror("deadlock");

  printf("return value is %d .....\n",relval);
  return (void *) strlen(s);
}

int main(int argc, char *argv[])
{
 pthread_t t1;
 void *res;
 int ret;

 ret = pthread_create(&t1, NULL, threadFunc, "Hello world\n");
 if (ret != 0)
    DEATH ("pthread_create");

 printf("Message from main()\n");

 pthread_exit(&res);
 exit(EXIT_SUCCESS); 
```

}

```
o/p

Message from main()
sleeping for 2 sec ...
deadlock: Success
return value is 35 ..... 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-09T19:12:48.407

不需要设置 sr 函数`errno`或不理会它。你总是可以自由地做：

```
errno = pthread_join(t, &res); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T19:31:09.323

pthread_join() 没有设置 errno 值

请参考这里的讨论：

[pthread：加入一个分离的线程没有正确设置 errno](https://stackoverflow.com/questions/13917944/pthread-join-a-detached-thread-doesnt-set-errno-correctly)

你最好的选择是只使用 pthread_join 的返回值

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T22:39:50.560

有几件事。

1.  您不应该从线程本身进行连接。连接应该从父线程完成，以清理那里的资源。
2.  errno 变量是每个线程的变量。当您在线程中访问它时，它的值会有所不同，并且在 main 中。

# java - 如何从布尔方法返回整数？

> ID：14790537
> 
> 赞同：0
> 
> 时间：2013-02-09T17:08:50.767
> 
> 标签：java

我在这里寻找类似的东西，但似乎没有任何帮助。我正在尝试将输入到我的布尔方法中的值返回给我的测试程序。任何建议都会被排除在外。由于我的代码很长，我只会包含我认为相关的内容。

```
 public class SeasonCalculatorTester
{
    public static void main(String[] args)
    {
        Scanner in = new Scanner(System.in);
        System.out.print("Enter the month: ");
        int month = in.nextInt();

        System.out.print("Enter the day: ");
        int day = in.nextInt();

        SeasonCalculator calculator = new SeasonCalculator(month, day);

        //TODO USE THE calculator (SeasonCalculator) TO CHECK FOR VALID MONTH AND VALID DAY.  
        //     IF MONTH OR DAY IS NOT VALID PRINT ERROR MESSAGE.  
        //     IF VALID PRINT OUT THE MONTH (IN STRING FORM, NOT INT FORM), THE DAY,
        //     AND THE SEASON THAT THE DAY IS IN 

        if(calculator.isValidMonth())
        {
            System.out.print(calculator.getMonth());
        }
        if(calculator.isValidDay())
        {
            System.out.print(" "+calculator.isValidDay()+" is in the "+ calculator.getSeason());
        }       
        else
        {
            System.out.println("False");
        }

    }
} 
```

我需要返回 int 值的方法是“isValidDay()”，代码如下：

```
public boolean isValidDay()
    {
        if ((month == 1 && day >= 1) && (month == 1 && day <= 31))
        {
            return true;
        }
        if ((month == 2 && day >= 1) && (month == 2 && day <= 29))
        {
            return true;
        }
        if ((month == 3 && day >= 1) && (month == 3 && day <= 31))
        {
            return true;
        }
        if ((month == 4 && day >= 1) && (month == 4 && day <= 30))
        {
            return true;
        }
        if ((month == 5 && day >= 1) && (month == 5 && day <= 31))
        {
            return true;
        }
        if ((month == 6 && day >= 1) && (month == 6 && day <= 30))
        {
            return true;
        }
        if ((month == 7 && day >= 1) && (month == 7 && day <= 31))
        {
            return true;
        }
        if ((month == 8 && day >= 1) && (month == 8 && day <= 31))
        {
            return true;
        }
        if ((month == 9 && day >= 1) && (month == 9 && day <= 30))
        {
            return true;
        }
        if ((month == 10 && day >= 1) && (month == 10 && day <= 31))
        {
            return true;
        }
        if ((month == 11 && day >= 1) && (month == 11 && day <= 31))
        {
            return true;
        }
        if ((month == 12 && day >= 1) && (month == 12 && day <= 31))
        {
            return true;
        }
        else
        {
            return false;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:08:08.673

你可以做的是：

*   如果参数无效，让您的构造函数抛出异常
*   通过将月份的最大天数存储在数组中来检查日期是否有效
*   提供获取器来访问月/日

```
class SeasonCalculator {
    private static final int[] days = {31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    private final int month;
    private final int day;

    public SeasonCalculator(int month, int day) {
        if (month < 1 || month > 12) {
            throw new IllegalArgumentException("Not a valid month: " + month);
        }
        if (day < 1 || day > days[month - 1]) {
            throw new IllegalArgumentException("Not a valid day: " + day + " for month " + month);
        }
        this.month = month;
        this.day = day;
    }

    public int getMonth() {
        return month;
    }

    public int getDay() {
        return day;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T17:11:13.893

添加一个不同的方法`SeasonCalculator`，只返回`day`. 然后：

```
if(calculator.isValidDay())
{
    System.out.print(" "+calculator.getDay()+" is in the "+ calculator.getSeason());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T19:29:49.720

您不能`int`从返回布尔值的方法返回 a 或某物。您可以添加一个全局变量，您可以在日期有效时从方法中设置该变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T21:02:11.030

您也可以尝试返回一个 Integer 对象。如果为空，则不正常。

```
public static Integer returnInt() {
    Integer ret = calculate_something();
    if (ret > AN_OK_CONDITION) {
        return ret;
    }
    else {
        return null;
    }
} 
```

然后，调用它：

```
Integer ret = returnInt();
    if (ret != null) {
        System.out.println("Number: " + ret);
    } 
```

# validation - 如何让 CakePHP 验证更安全？

> ID：14790540
> 
> 赞同：1
> 
> 时间：2013-02-09T17:09:29.627
> 
> 标签：validation, cakephp, cakephp-2.3

最近我完成了关于使用 CakePHP 创建简单博客的教程 - 这里是链接：[http](http://book.cakephp.org/2.0/en/tutorials-and-examples/blog/part-two.html) ://book.cakephp.org/2.0/en/tutorials-and-examples/blog/part-two.html 创建验证表单非常简单快捷，但我注意到一个问题。

名为 post.ctp 的文件包含：

```
 echo $this->Form->create('Post');
  echo $this->Form->input('title'); 
```

它使用以下输入为最终用户生成表单：

```
<input id="PostTitle" type="text" required="required" maxlength="50" name="data[Post][title]"> 
```

使用 Firefox Firebug 的人可以在提交表单之前将 html 代码从：`name="data[Post][title]"`更改为：`name="data[Post][author]"`。这样做的结果将更新名为“作者”的列，而不是“标题”，并且还允许使用“标题”的空数据更新数据库。

在 Post.php 中名为“模型”的文件夹中，验证规则不会阻止：

```
class Post extends AppModel {

public $validate = array(
    'title' => array(
        'rule' => 'notEmpty'
    ),
    'body' => array(
        'rule' => 'notEmpty'
    )
);

} 
```

如何保护我的应用程序并且不允许某人更新数据库中的其他列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T20:41:41.607

Cake 的[安全组件](http://book.cakephp.org/2.0/en/core-libraries/components/security-component.html)包括[表单篡改](http://book.cakephp.org/2.0/en/core-libraries/components/security-component.html#form-tampering-prevention)保护。您需要在控制器中添加安全组件：

```
public $components = array('Security'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T19:22:31.447

查看[模型文档](http://api.cakephp.org/class/model)。至少有两种方法可以处理这个问题。

1.  调用时可以`fieldlist`作为第三个参数传递`save()`。
2.  `whitelist`您可以在调用之前设置模型的属性`save()`。

我还没有使用它，但[安全组件](http://book.cakephp.org/2.0/en/core-libraries/components/security-component.html#SecurityComponent)是另一种选择。

# sql - 使用记录 ID 列表作为输入更新 SQL 服务器中的 400 万条记录

> ID：14790548
> 
> 赞同：6
> 
> 时间：2013-02-09T17:11:18.183
> 
> 标签：sql, sql-server, sql-server-2008, tsql, data-migration

在迁移项目期间，我面临着 SQL Server 中 400 万条记录的更新。

更新非常简单；需要将布尔字段设置为 true/1 并且我的输入是必须填写该字段的所有 id 的列表。（每行一个 id）

当涉及到这种大小的 sql 任务时，我并不完全是专家，所以我开始尝试 1 个包含“ `WHERE xxx IN ( {list of ids, separated by comma} )`”的 UPDATE 语句。首先，我用一百万条记录进行了尝试。在测试服务器上的一个小数据集上，这就像一个魅力，但在生产环境中，这给出了一个错误。因此，我几次缩短了 id 列表的长度，但无济于事。

我尝试的下一件事是将列表中的每个 id 转换为 UPDATE 语句（“ `UPDATE yyy SET booleanfield = 1 WHERE id = '{id}'`”）。某处，我读到每隔 x 行有一个 GO 很好，所以我每 100 行插入一个 GO（使用从 unix 移植的优秀的 'sed' 工具）。

因此，我将 400 万条更新语句列表分成 250.000 条，将它们保存为 sql 文件，然后开始将第一个语句加载并运行到 SQL Server Management Studio (2008) 中。请注意，我也尝试了 SQLCMD.exe，但令我惊讶的是，它的运行速度比 SQL Studio 慢了大约 10-20 倍。

完成大约需要 1.5 小时，并导致“查询完成但有错误”。但是，消息列表包含一个很好的列表，其中包含“1 行受影响”和“0 行受影响”，后者用于未找到 id 时。

接下来，我使用 COUNT(*) 检查了表中更新记录的数量，发现更新语句的数量和更新的记录数量之间存在几千条记录的差异。

然后我认为这可能是由于不存在的记录，但是当我在输出中减去“0 行受影响”的数量时，出现了 895 条记录的神秘差距。

我的问题：

1.  有什么方法可以在“查询完成但出现错误”中找出错误的描述和原因。

2.  895条记录的神秘差距如何解释？

3.  进行此更新的更好或最好的方法是什么？（因为我开始认为我正在做的事情可能非常低效和/或容易出错）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T19:42:34.387

解决这个问题的最好方法是将 400 万条记录插入到一​​个表中。事实上，您可以通过“批量插入”到视图中，将它们放入带有标识列的表中。

```
create table TheIds (rownum int identity(1,1), id int);

create view v_TheIds (select id from TheIds);

bulk insert into v_TheIds . . . 
```

有了数据库中的所有数据，您现在有更多选择。尝试更新：

```
update t
    set booleanfield = 1
    where exists (select 1 from TheIds where TheIds.id = t.id) 
```

您还应该在`TheIds(id)`.

这是一个大型更新，所有更新都作为一个事务执行。这可能会影响性能并开始填满日志。`rownum`您可以使用该列将其分解为较小的事务：

```
update t
    set booleanfield = 1
    where exists (select 1 from TheIds where TheIds.id = t.id and TheIds.rownum < 1000) 
```

这里的 exists 子句相当于`left outer join`. 主要区别在于这种相关的子查询语法应该在其他数据库中工作，其中更新连接是特定于数据库的。

使用该`rownum`列，您可以选择任意多的行进行更新。因此，如果整体更新太大，您可以将更新置于循环中：

```
where rownum < 100000
where rownum between 100000 and 199999
where rownum between 200000 and 299999 
```

等等。您不必这样做，但如果您出于某种原因想要批量更新，您可以这样做。

关键思想是把id列表拿到数据库中的一个表中，这样就可以利用数据库的力量进行后续的操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-09T19:10:00.743

警告：我无法对其进行测试，而且我没有可以保存这么多数据的“游乐场数据库”。

我不确定 1\. 和 2\. 但对于 3\. 你最好将更新的限制留给数据库：

```
UPDATE TOP(100000) yyy
SET booleanfield = 1
WHERE booleanfield = 0
GO 
```

虽然文档说要“随机选择”一些具有 TOP 限制的条目 - 我希望它只从具有`booleanfield = 0`. 重复运行该查询，直到不再报告更新。

如果上述方法不起作用，另一种选择是直接从数据库中选择受影响的 id ......这看起来很奇怪，我也没有测试过，但我希望它有效：

```
UPDATE yyy
SET booleanfield = 1
FROM (SELECT TOP 100000 id FROM yyy WHERE booleanfield = 0 ORDER BY id ASC) AS xxxx
WHERE yyy.id = xxxx.id;
GO 
```

（我假设你`id`在这里的表中有一个唯一的键）。多次（大约 40 次）运行此查询，直到不再报告更新。

# android - Android Proguard 选项 - 更严格的规则和删除日志语句

> ID：14790549
> 
> 赞同：4
> 
> 时间：2013-02-09T17:11:21.427
> 
> 标签：android, obfuscation, proguard

我通过取消注释 project.properties 中的行来启用 proguard。

我反编译了我的 APK 以检查它是否有效。我可以看到我所有的方法、变量名和类名都已更改为 a、b、c.. 等，这很好。但是，我的 Activity 课程尚未重命名。Log.d 语句也没有按预期删除。

如何让某人更难阅读反编译的代码并删除日志语句？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-09T22:30:28.453

与Android应用生命周期相关的各种方法不能重命名，因为：

*   遗产; 超类方法包含在 Android 库中，无法通过 Proguard 对其进行重命名。因此，由于注释，重命名`onCreate()`为将导致编译问题。`a()``@Override`
*   在活动的生命周期中，Android 会执行各种预期具有特定名称的函数（例如`onCreate()`和`onResume()`）。如果您`onCreate()`的重命名为`a()`，则只会执行超类实现——而不是您的。

至于为什么不能重命名您的活动的类名：

*   这将假设对清单进行修改，而 Proguard 根本不支持。
*   自动进行这些修改可能会产生不必要的影响。`A`例如，如果以前混淆为 的类现在可能混淆为 ，则来自用户主屏幕的快捷方式可能不再起作用`B`。

[使用assumenosideeffects](http://proguard.sourceforge.net/manual/usage.html#optimizationoptions)选项通过Proguard 删除您的Log 语句相当简单。[有关详细信息，请参阅此相关问题](https://stackoverflow.com/questions/4435773/android-proguard-removing-all-log-statements-and-merging-packages)：

```
-assumenosideeffects class android.util.Log {
    public static *** d(...);
    public static *** v(...);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-10T01:34:24.907

Paul Lammertsma 为您的问题的第一部分提供了准确的答案。第二部分详解：

如果未禁用优化，则只能删除日志记录，这需要在以下位置指定不同的全局配置文件`project.properties`：

```
 proguard.config=${sdk.dir}/tools/proguard/proguard-android-optimize.txt:proguard-project.txt 
```

这些设置`proguard-project.txt`然后删除所有日志记录：

```
-assumenosideeffects class android.util.Log {
    public static boolean isLoggable(java.lang.String, int);
    public static int v(...);
    public static int i(...);
    public static int w(...);
    public static int d(...);
    public static int e(...);
} 
```

有多种等价形式，通配符更多或更少。

类似的问题和答案：

*   [使用 proguard 删除日志调用](https://stackoverflow.com/questions/13218772/removing-log-call-using-proguard)
*   [在 ProGuard 优化期间删除未使用的字符串](https://stackoverflow.com/questions/6009078/removing-unused-strings-during-proguard-optimisation)
*   [使用 ProGuard 删除日志不会删除正在记录的字符串](https://stackoverflow.com/questions/7086920/removing-logging-with-proguard-doesnt-remove-the-strings-being-logged)
*   [如何配置我的 proguard-project.txt 文件以仅删除日志](https://stackoverflow.com/questions/14123866/how-to-config-my-proguard-project-txt-file-to-remove-just-logs)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-09T19:20:39.647

为了删除对 Log 语句的所有引用，您应该在您的 proguard 配置文件中添加这些行：

```
-assumenosideeffects class android.util.Log {
    public static *** d(...);
    public static *** v(...);
} 
```

[在官方网站上](http://proguard.sourceforge.net/index.html#manual/examples.html)，您可以找到带有示例的完整手册。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-09T20:28:00.880

为了删除日志，我用各种技术写了一篇文章，其中一些来自 StackOverflow（在文章中说谁是作者）你可以在这里看到它：

[http://bakingcode.com/development/ocultar-trazas-en-una-app-final-de-android/](http://bakingcode.com/development/ocultar-trazas-en-una-app-final-de-android/) 恕我直言，我认为 Proguard 的第二个是最好的。

要混淆您的代码，您需要考虑您的需求，请参阅以下更多示例： http: [//proguard.sourceforge.net/index.html#manual/examples.html](http://proguard.sourceforge.net/index.html#manual/examples.html)

# ruby - 模块中的 eval，但该类不是模块的一部分

> ID：14790557
> 
> 赞同：-1
> 
> 时间：2013-02-09T19:08:13.120
> 
> 标签：ruby, module, eval

我有一个模块`Database`。在此模块中，`eval("MyClass")`返回`Database::MyClass is inexistent`. `Database`但我希望它在模块之外进行评估。谁知道这是怎么做的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:31:36.990

您应该尝试显式指定全局范围：

```
eval('::MyClass') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T14:24:12.957

如果您尝试通过包含在字符串中的名称来访问类，则使用 Kernel.const_get 可能是更好的选择。有关更多信息，请参阅此堆栈溢出帖子：[Get a class by name in Ruby？](https://stackoverflow.com/questions/3163641/get-a-class-by-name-in-ruby)

# node.js - 从回调访问调用者参数

> ID：14790558
> 
> 赞同：2
> 
> 时间：2013-02-09T19:08:33.787
> 
> 标签：node.js

我有这个：

```
var parseFile = function(err, data) {
 // I need to access 'myFile'
};
fs.readFile(myFile, 'utf8', parseFile); 
```

如何`'myFile'`在其他地方声明的回调中访问？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T19:33:17.320

```
function parseFile(myFile) {
  return function (err, data) {
    // its a closure bound variable! yay.
  }
}

fs.readFile(myFile, "utf8", parseFile(myFile)) 
```

# java - 使用 iText 加密 PDF 以禁止内容复制和打印

> ID：14790559
> 
> 赞同：2
> 
> 时间：2013-02-09T19:08:44.037
> 
> 标签：java, encryption, itext

我尝试使用此代码来加密我的 PDF，因此用户无法从 PDF 中复制内容（仅用于测试，我知道有些东西是 OCR'ing :p）

```
import java.io.FileOutputStream;

import com.itextpdf.text.pdf.PdfReader;
import com.itextpdf.text.pdf.PdfStamper;
import com.itextpdf.text.pdf.PdfWriter;

public class EncryptPDF {

private static final String INPUT_FILENAME = "/tmp/test.pdf";
private static final String OUTPUT_FILENAME = "/tmp/test_encrypted.pdf";
private static final String USER_PASSWORD = "";
private static final String OWNER_PASSWORD = "foobar";

public static void main(String[] args) {
    PdfReader reader = null;
    FileOutputStream out = null;
    PdfStamper stamper = null;

    try {
        // Define input
        reader = new PdfReader(INPUT_FILENAME);

        // Define output
        out = new FileOutputStream(OUTPUT_FILENAME);

        // Encrypt document
        stamper = new PdfStamper(reader, out);
        stamper.setEncryption(USER_PASSWORD.getBytes(), OWNER_PASSWORD.getBytes(), ~(PdfWriter.ALLOW_COPY | PdfWriter.ALLOW_PRINTING), PdfWriter.STANDARD_ENCRYPTION_128);
    } catch (Exception ex) {
        ex.printStackTrace();
    } finally {
        if (reader != null) {
            try {
                reader.close();
            } catch (Exception ex) {
                ex.printStackTrace();
            }
        }
        if (stamper != null) {
            try {
                stamper.close();
            } catch (Exception ex) {
                ex.printStackTrace();
            }
        }
        if (out != null) {
            try {
                out.close();
            } catch (Exception ex) {
                ex.printStackTrace();
            }
        }
    }

}
} 
```

...但是当我打开 PDF 时，我仍然可以从中选择内容。我正在使用 iText 5.0.2。

关于我做错了什么有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T09:22:11.433

正如我对问题的评论中所提到的，按原样运行示例代码会导致--- 这是很自然的，因为您首先关闭`NullPointerException`然后关闭，但后一种方法访问`stamper.close()``PdfReader``PdfStamper,``close()``PdfReader`（现在已经关闭）进行工作。

`PdfReader`但是，当我按照关闭和反转的顺序运行您的代码时`PdfWriter`，我会得到一个具有所需访问权限的正确结果文件：

![受保护 PDF 的文档属性显示打印和复制已禁用](../Images/a45c6f6d8907e250bd68e02740849aed.png)

PS：我使用的是 iText 5.3.5 版；如果颠倒`close()`调用顺序对您的情况没有帮助，您可能需要从版本 5.0.2 更新。

# .htaccess - 从服务器上的另一个 URL 检索文件

> ID：14790564
> 
> 赞同：0
> 
> 时间：2013-02-09T19:09:59.947
> 
> 标签：.htaccess

我有一台服务器两个域。我需要图像和 css 适用于这两个域。目前我使用 htaccess 解决它：

`RewriteRule ^.*\.(css)$ http://www.rs.cz/style/$0 [L,R]`

怎么可能改进？或者至少参考服务器上的相对路径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T19:37:25.177

创建一个仅用于托管图像和静态内容的子域，例如：
images.mydomain1.com
和另一个子域，例如：
images.mydomain2.com
让它们都重定向到服务器中的同一目录，例如 /var/www/common_images。

# java - 在Java中将二进制转换为十进制

> ID：14790568
> 
> 赞同：-1
> 
> 时间：2013-02-09T19:10:33.807
> 
> 标签：java, binary, decimal

我几乎完成了实现一个代码，该代码允许用户将十进制数输入二进制，然后将二进制数反转，然后再转换回十进制。

我解决了除了二进制到十进制部分之外的所有问题。无论我输入什么，它都会一遍又一遍地给我相同的数字。我不明白为什么。基本上，为什么我的代码的最后一部分是错误的？我无法找到数组/字符串的长度，然后将其乘以 2^n 等...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:19:37.060

这段代码有两个问题。

1）您没有存储十进制到二进制转换的结果。您应该引入新的 String 变量来存储具有反转二进制值的字符串。

2）您的二进制到十进制算法不正确。s.charAt(i) 返回 char 值，但您需要 double 值才能在计算中使用它。Math.pow(2, (s.length() - i - 1)) 也不正确 - 据我了解，它适用于非反转二进制值。

固定版本的代码应如下所示：

```
public static void main(String[] args) {
    int a[] = {0, 1};

    int number;
    int remainder;
    String binary = "";

    Scanner in = new Scanner(System.in);

    System.out.print("Enter Decimal Number: ");
    number = Integer.parseInt( in.next());

    System.out.print("Binary Number in Reverse: ");
    do {
        remainder=number%2;
        if(remainder > 0){
            binary += a[1];
            //System.out.print(a[1]);
        }
        else{
            binary += a[0];
            //System.out.print(a[0]);
        }
        number=number / 2;
    } while(number>0);

    System.out.print(binary);

    System.out.print(" \nDecimal number: ");
    //String s = Integer.toString(number);
    double result = 0;
    for (int i = 0; i < binary.length(); i++)
       result = result + Double.parseDouble(binary.substring(i, i + 1)) * Math.pow(2, i);
    System.out.print(result);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:20:24.123

`number`根据您的 do-while 循环条件，将始终为零或更少： `while(number>0);`

这会导致您的变量`s`（请选择更好的变量名称...）始终为“0”。

我想你可以弄清楚其余的。

# php - Sum more than 1 table from SQL on codeigniter

> ID：14790577
> 
> 赞同：2
> 
> 时间：2013-02-09T19:11:53.720
> 
> 标签：php, sql, codeigniter

need a small help to figure out this situation. I see that codeigniter is not supporting UNION and i want to figure out this method to get the total sum for 2 tables, with same id of product.

The issue is that on sum 2 tables, the values are duplicating or multiplicative.

Link to [SQL Fiddle](http://sqlfiddle.com/#!2/17b30/1)

Structure :

```
create table products
(id int, name varchar(9));
insert into products 
(id, name)
values
(1,'Product 1'),
(2,'Product 2'),
(3,'Product 3');

create table p_items
(puid int, prid int, quantity int);
insert into p_items
(puid, prid, quantity)
values
(11,1,100),
(11,2,100),
(11,2,100),
(14,2,100),
(14,3,100),
(15,3,100);

create table s_items
(puid int, prid int, quantity int);
insert into s_items
(puid, prid, quantity)
values
(11,1,1),
(11,2,1),
(11,2,1),
(13,2,1),
(15,3,1),
(13,3,1); 
```

Execute in normal SQL:

```
select a.puid, b.name, a.prid, sum(a.quantity) as P_ITEMS, sum(c.quantity) as S_ITEMS
from p_items a
join products b
on b.id = a.prid
join s_items c
on c.prid = a.prid
group by a.prid; 
```

Codeigniter Function:

```
$this->alerts
            ->select('products.id as productid, products.name, sumt(p_items.quantity), sum(s_items.quantity)', FALSE)
            ->from('products')
            ->join('p_items', 'products.id = p_items.prid', 'left')
            ->join('s_items', 'products.id = s_items.prid')
            ->group_by("products.id");
            echo $this->alerts->generate(); 
```

Any help is very appreciated.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T20:00:40.003

您的问题是您生产笛卡尔积并因此得到重复的总和。以产品 ID 3 为例。您将其与 p_items prid = 3 相关联。它本身将返回 200。但是，一旦您加入 s_items prid = 3，现在对于 s_items 中的每一行，它必须与 p_items 中的每一行匹配。意义：

```
14 3 100 15 3 1
14 3 100 15 3 1
15 3 100 15 3 1
15 3 100 15 3 1
---------------
     400      4 
```

除了产品表，你的主表是哪个表？如果使用 p_items，则需要从 s_items 获取第 13 行。同样，如果您使用 s_items，您将不会从 p_items 获得第 14 行。

您可以使用子查询来完成此操作：

```
select b.id, 
  b.name, 
  P_ITEMS, 
  S_ITEMS
from products b
  left join 
    (SELECT prid, SUM(quantity) as P_Items
     FROM p_items
     GROUP BY prid)
     a on b.id = a.prid
  left join 
    (SELECT prid, SUM(quantity) as S_Items
     FROM s_items
     GROUP BY prid)
     c on c.prid = a.prid
group by b.id, b.name 
```

以及更新的 Fiddel：[http ://sqlfiddle.com/#!2/62b45/12](http://sqlfiddle.com/#!2/62b45/12)

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:02:28.410

如果获得所需答案的最佳方法是使用联合查询，而 codeigniter 不允许您编写查询，请不要使用 codeigniter 来编写查询。把它放在一个存储过程中，用codeigniter调用这个存储过程。

# visual-studio-2012 - Visual Studio 2012 远程内核调试虚拟机

> ID：14790579
> 
> 赞同：5
> 
> 时间：2013-02-09T19:12:01.647
> 
> 标签：visual-studio-2012, kernel, virtual-machine, remote-debugging, device-driver

我在使用以下配置设置调试环境时遇到了一些麻烦：

```
Host computer - Physical, Windows 7 x64

Target computer - Virtual (Vmware), Windows 7 x64 (Running on Host computer) 
```

我希望能够开发内核模式驱动程序，在我的 VM 中部署和调试它。

Visual Studio 让我很难过，并且配置 VM 无法正常工作。

如何在 VM 中成功部署和调试驱动程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-24T20:02:02.830

我设法自己解决了这个问题。[我在这里](http://www.codeproject.com/script/Articles/ArticleVersion.aspx?waid=175295&aid=545835)写了一篇关于解决方案的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-27T14:36:55.093

要连接到同一台机器上的 VMware 目标，我只需使用串行电缆连接到每个“一半”。我的串行电缆两端都有 USB。因此，我只需将两端连接到计算机上的单独 USB 端口。

# java - Line Joint accelerate wheel

> ID：14790581
> 
> 赞同：1
> 
> 时间：2013-02-09T19:12:19.350
> 
> 标签：java, box2d

I am using box2d line joint, to simulate wheel with suspension, but I can not manage to accelerate properly.

My joint code:

```
 LineJointDef fJointDef = new LineJointDef();
        fJointDef.initialize(mainBody, wheelBody, wheelBody.getWorldCenter(), new Vector2(0,-1));
        fJointDef.enableMotor = true;
        fJointDef.upperTranslation = 0.10f;
        fJointDef.lowerTranslation = -0.10f;
        fJointDef.enableLimit = true;
        fJointDef.motorSpeed = 10;
        fJointDef.maxMotorForce = 30f; 
```

Suspension works, wheel is properly attached to the vehicles body, it might move etc, now I do not really know how to move it properly, editing motor speed and max motor force of the line joint does nothing. I ended up, to applying angular impulse to the wheel body:

```
wheelBody.applyAngularImpulse(5 * direction); 
```

But with this, vehicle might move with infinity speed, would be grateful if someone can provide some help, thanks.

# sql-server-2008 - 无法通过 java 或其他工具连接到本地 sql server sqlexpress 实例

> ID：14790583
> 
> 赞同：1
> 
> 时间：2013-02-09T19:12:21.400
> 
> 标签：sql-server-2008, authentication, jdbc

我在 Win 7 64 上安装了 SQL Server 2008 Express。我可以使用 Windows Auth 通过 SQL Server Management Studio 连接到它，但不能使用 SQl Server Auth。按照[http://www.linglom.com/2009/03/28/enable-remote-connection-on-sql-server-2008-express/](http://www.linglom.com/2009/03/28/enable-remote-connection-on-sql-server-2008-express/)中的说明，我觉得我已经正确配置了远程连接和 sql server auth . 然而，当我尝试登录时，我收到一条错误消息，指出登录失败。谷歌搜索似乎没有帮助答案没有意义，似乎不适用。其中之一是建议将动态端口更改为空白，对端口进行硬编码。由于默认情况下没有以这种方式安装此工具，因此我很难相信这是实际问题。我发现没有一篇文章解释了为什么应该改变它。

确切的信息是：

无法连接到 bvl-wd-bturner\SQLEXPRess 附加信息：用户“DTN\bill.turner”登录失败。（Microsoft SQL Server，错误 18456）

我尝试使用以下凭据登录：

服务器类型：数据库引擎 服务器名称：bvl-wd-bturner\SQLEXPRESS 身份验证：SQL Server 身份验证登录：DTN\bill.turner 密码：

对于它的价值，使用 Windows 身份验证登录，我查看了连接属性。用户名与上面的登录名一致。服务器名称是相同的（实际上是复制/粘贴以确保两者）。

=== 更新 === Windows 防火墙已关闭。

即使有所保留，我也尝试对端口号进行硬编码，删除所有动态端口上的“0”并将端口设置为 1433。没有运气。:-(

=== 更新 2 === 我意识到我需要创建一个 SQL Server 帐户并且已经这样做了。我现在可以使用以下凭据通过 SSMS 登录。但是，我似乎无法通过 DbVisualizer 或以下测试 java 文件登录：

驱动程序是 net.sourceforge.jtds.jdbc。驱动程序连接 url 是 jdbc:jtds:sqlserver://bvl-wd-bturner:1433/host

我现在在 SSMS 中成功使用的凭据是： 服务器类型：数据库引擎 服务器名称：bvl-wd-bturner\SQLEXPRESS 身份验证：SQL Server 身份验证登录：本地密码：

在这一点上，我必须相信这是我显然想念的东西，但还没有找到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T12:55:19.890

登录名：DTN\bill.turner 看起来像 Windows 登录名，而不是没有域组件的 SQL 服务器登录名。DTN是你的域名吗？如果是这样，提供此 SQL 登录可能会使客户端混淆尝试 Windows 身份验证，如果登录不存在，则会失败。

您创建的 SQL 服务器登录名是什么（在 SQL 管理工作室中）？它不应该有域\用户名格式，它应该只是一个用户名。您还需要确保在连接时选择 SQL 身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T13:07:15.600

尝试将您当前登录的帐户 (Windows) 添加到计算机上的本地管理员组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-14T19:20:41.293

开头贴的链接， [http://www.linglom.com/2009/03/28/enable-remote-connection-on-sql-server-2008-express/](http://www.linglom.com/2009/03/28/enable-remote-connection-on-sql-server-2008-express/)

加上这篇关于设置数据库默认登录的文章：http: [//blog.sqlauthority.com/2008/11/04/sql-server-fix-error-4064-cannot-open-user-default-database-login-failed -用户登录失败/](http://blog.sqlauthority.com/2008/11/04/sql-server-fix-error-4064-cannot-open-user-default-database-login-failed-login-failed-for-user/)

为我解决了这个问题。希望它能帮助到这里的其他人。

# c++ - C++ 为什么是括号？

> ID：14790585
> 
> 赞同：0
> 
> 时间：2013-02-09T19:13:00.490
> 
> 标签：c++

我在一本书中找到了这段代码：

```
#include <iostream>
using namespace std;

void ChangesAreGood(int *myparam) {
    (*myparam) += 10;
    cout << "Inside the function:" << endl;
    cout << (*myparam) << endl;
}

int main() {
    int mynumber = 30;
    cout << "Before the function:" << endl;
    cout << mynumber << endl;

    ChangesAreGood(&mynumber);
    cout << "After the function:" << endl;
    cout << mynumber << endl;

    return 0;
} 
```

它说：

```
(*myparam) += 10; 
```

以下会产生什么差异？

```
*myparam += 10; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T19:17:52.187

## 要回答您的问题：

在您的示例中，除了可读性之外没有区别。

而且，正如这篇文章的评论所暗示的那样，*请*不要在这里使用括号......

## 其他有趣的案例

### 在取消引用的对象上使用属性/方法

另一方面，如果您有类似的东西，*则会有所不同*

```
*myObject.myPropertyPtr += 10 
```

相比

```
(*myPointer).myProperty += 10 
```

我在这里选择的名字告诉你区别是什么：解引用操作符`*`适用于它右手边的任何东西；在第一种情况下，运行时将获取 的内容`myObject.myPropertyPtr`，并取消引用它，而在第二个示例中，它将取消引用`myPointer`，并`myProperty`从指向的对象上找到的任何内容中获取`myPointer`。

后者非常常见，甚至有自己的语法：`myPointer->myProperty`.

### 使用`++`运算符而不是`+=`

另一个有趣的例子，我在阅读了这个问题的另一个（现已删除）答案后想到的，是这些之间的区别：

```
*myPointer++
(*myPointer)++
*(myPointer++) 
```

这更有趣的原因是因为`++`它像任何其他调用一样，特别是不处理左右手边的值，它比你的例子更模棱两可`+=`。（当然，它们并不总是有意义 - 有时您最终会尝试在`++`不支持它的对象上使用运算符 - 但如果我们将研究限制为`int`s，这不会成为问题。而且无论如何它应该给你一个编译器错误......）

既然你引起了我的好奇心，我做了一个小实验来测试这些。这是我发现的：

*   `*myPointer++`做同样的事情`*(myPointer++)`，即*首先*增加指针，*然后*取消引用。这不应该如此令人惊讶 - 这是我们期望知道运行结果的结果`*myObject.someProperty`。

*   `(*myPointer)++`做你所期望的，即*首先*取消引用指针，*然后*增加指针指向的任何内容（并保持指针不变）。

如果您愿意，请随时仔细查看[我用来查找此内容的代码。](http://pastebin.com/hwwW1tXz)只需将其保存到`dereftest.cpp`，使用编译`g++ dereftest.cpp -o dereftest`（假设您安装了 G++）并使用`./dereftest`.

# scala - twitter 对抽象代数的兴趣是什么？

> ID：14790588
> 
> 赞同：4
> 
> 时间：2013-02-09T19:13:42.003
> 
> 标签：scala, twitter, algebra, bloom-filter

为什么像 Twitter 这样的公司会对群、幺半群和环等代数概念感兴趣。[https://github.com/twitter/algebird](https://github.com/twitter/algebird)

我能找到的只有：

> Monoids的实现，用于有趣的近似算法，例如[Bloom filter](http://en.wikipedia.org/wiki/Bloom_filter)、[HyperLogLog](https://stackoverflow.com/questions/12327004/how-does-the-hyperloglog-algorithm-work)和[CountMinSketch](http://dimacs.rutgers.edu/~graham/pubs/papers/cmencyc.pdf)。这些使您可以像数字一样思考这些复杂的操作，并将它们添加到 hadoop 或在线中以生成强大的统计数据和分析。

在 GitHub 页面的另一部分：

> 它最初是作为 Scalding 的 Matrix API 的一部分开发的，其中矩阵的值是 [Monoids](http://en.wikipedia.org/wiki/Monoid#Relation_to_category_theory)、[Groups](http://en.wikipedia.org/wiki/Group_%28mathematics%29)或[Rings](http://www.math.ku.dk/~gelvin/Modules.pdf)的元素。随后，很明显该代码在 Scalding 和 Twitter 的其他项目中得到了更广泛的应用。

这个更广泛的应用可能是什么？在 Twitter 内部并出于一般利益？

# c# - 时间：2019-04-01 标签：c#keywordthis

> ID：14790591
> 
> 赞同：1
> 
> 时间：2013-02-09T19:14:20.197
> 
> 标签：c#

我知道关键字“this”是指类变量中构造函数之外的变量。但是为什么不只是将参数的名称更改为 (string _name, string _alias) ，教程中“this”的所有示例都说明了这一点，但我想知道为什么在某些情况下需要这个关键字的工作用途情况。

```
private string name;
private string alias;
   public Employee(string name, string alias) 
    {
       this.name = name;
       this.alias = alias;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T19:34:05.557

在您的示例中，您可以在字段名称上加上下划线，因此`this`不需要（仍然允许，但不需要，因为如果与局部变量没有冲突，则可以推断出来）。事实上，微软的标准鼓励这样做。

但是，仍有很多情况下您可能需要`this`关键字。

一个例子是，如果您在另一个接受 的类中有一个实用程序`Employee`，例如：

```
public static class Utility
{
    public static void SomeMethod(Employee employee)
    {
    }
} 
```

并且您想从`Employee`类中调用此实用程序，则必须将其称为`Utility.SomeMethod(this);`.

此外，在当前实例上调用的扩展方法必须以`this.`. 给定以下扩展方法：

```
public static class UtilityExtensionMethods
{
    public static void SomeExtensionMethod(this Employee employee)
    {
    }
} 
```

如果您想从`Employee`类中调用此扩展方法，则必须将其称为`this.SomeExtensionMethod();`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T19:29:42.347

我命名*私有成员变量* `_x`以避免这种情况¹。[支持/反对这一点的论据比比皆是](https://stackoverflow.com/a/1630928/166390)。

```
private string _name;
public Employee(string name, string alias) 
{       
   // Equivalent to `this._name = name`, as _name is not shadowed
   _name = name;
} 
```

另一方面，我*反对*命名参数`_x`，因为*参数名称是公共合约的一部分*²。这个契约应该是干净、稳定的，并且*不*应该由包含成员变量名称的内部实现来决定。

过去，在这种情况下，我使用 、 和 等名称`employeeName`作为`aName`参数`theAlias`，但我不喜欢最终使用的人工修饰符。如果我不能对私有变量使用下划线，我会使用`this.x`并且不会三思而后行。

* * *

¹需要这种形式是因为`this`在 C# 中是“隐式的”和变量阴影。也就是说，`this.x`它是需要的，因为`x`它会引用一个局部变量/参数，如果它存在的话 - 它在这里。

```
private string name;
public Employee(string name, string alias) 
{
   // Re-assignes parameter to itself.
   // Does NOT assign member variable!
   name = name;
} 
```

²我相信名称中的下划线会破坏“CLS 兼容性”，但这不是我关心的问题，并且仅对*私有*成员变量使用此约定可避免公开暴露此类不兼容的名称。

# jquery - jQuery-UI：无法取消选择选项卡

> ID：14790601
> 
> 赞同：0
> 
> 时间：2013-02-09T19:17:58.333
> 
> 标签：jquery, jquery-ui

我正在使用 jQuery-UI 选项卡小部件，并且我不希望在第一次加载选项卡时选择任何选项卡。我使用以下参数调用了 tabs 方法：

```
$( "#tabs" ).tabs({selected: -1}); 
```

这应该根据 jQuery wiki 取消选择所有选项卡。但是它不起作用，始终选择第一个选项卡“操作”。谁能告诉我如何确保第一次加载时没有选择标签？谢谢。

这是我正在使用的：

```
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="js/jquery-ui-1.9.2.custom/js/jquery-ui-1.10.0.custom/css/ui-lightness/jquery-ui-1.10.0.custom.css" />
        <script src="js/jquery-ui-1.9.2.custom/js/jquery-1.9.1.js"></script>
        <script src="js/jquery-ui-1.9.2.custom/js/jquery-ui-1.10.0.custom/js/jquery-ui-1.10.0.custom.js"></script>

<script language="javascript" type="text/javascript">
             $(document).ready(function(){    
      $( "#tabs" ).tabs({selected: -1}); 

});
        </script>

    </head>
    <body>
        <div id="tabs">
        <ul>
        <li><a href="javascript: void(0);">Action</a></li>
        <li><a href="javascript: void(0);">Animation</a></li>
        <li><a href="javascript: void(0);">Classics</a></li>
        <li><a href="javascript: void(0);">Comedy</a></li>
        <li><a href="javascript: void(0);">Documentary</a></li>
        <li><a href="javascript: void(0);">Drama</a></li>
        <li><a href="javascript: void(0);">Horror</a></li>
        <li><a href="javascript: void(0);">Family</a></li>
        <li><a href="javascript: void(0);">Suspense</a></li>
        <li><a href="javascript: void(0);">Sci Fi/Fantasy</a></li>
        <li><a href="javascript: void(0);">World</a></li>
    </ul>
          </div>
    </body>
</html> 
```

更新：工作`$("#tabs ul li").eq(0).removeClass('ui-state-active');`后添加`$("#tabs").tabs();`。它似乎可以防止您下次单击该选项卡时选择该选项卡，但之后它可以正常工作。不过应该可以解决。

更新：原来你只需要`$("#tabs").tabs({ collapsible: true, active: false });`最初取消选择所有选项卡。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T19:25:34.117

不幸的是，它似乎不适用于 jQuery-UI 选项卡，如[http://jquery.10927.n7.nabble.com/Can-t-disable-all-tabs-td129542.html](http://jquery.10927.n7.nabble.com/Can-t-disable-all-tabs-td129542.html)中所述。

[您可以使用来自http://www.eduteka.org/ajax/tabs3/](http://www.eduteka.org/ajax/tabs3/)的 jquery 选项卡

当您阅读文档时，会有一个标题，例如“从所有未选择的选项卡开始/允许切换可见性”，这就是您要查找的内容。

# css - 相对于图标定位工具提示

> ID：14790602
> 
> 赞同：0
> 
> 时间：2013-02-09T19:18:05.140
> 
> 标签：css, tooltip, positioning

我正在为我的网络图标使用 Font-Awesome，并且我正在尝试向它们添加工具提示。我无法正确定位，因此在悬停时，它在显示时不会移动图标。标签是 [Twitter] 指示实现图标的方式。

这是我的代码：

```
<ul>
    <li>
        <div class="tooltip">like me.</div>
        <i class="icon-facebook-sign"></i>
    </li>
[...] 
```

* * *

```
#footer li {
    display:inline; 
    margin:0px 5%;
}
    #footer i {
        position:relative;
        font-size:74px;
    }
    #footer i:hover {
        color:#3b8edb;
        cursor:pointer;
    }
.tooltip {
    display:none;
    position: relative;
    background: #ffffff;
    font-size:12px;
    color:#2c6ca8;
    border-radius:5px;
    padding:10px;
}
.tooltip:after {
    top: 100%;
    border: solid transparent;
    content: " ";
    height: 0;
    width: 0;
    position: absolute;
    pointer-events: none;
}

.tooltip:after {
    border-top-color: #ffffff;
    border-width: 12px;
    left: 50%;
    margin-left: -12px;
} 
```

* * *

```
$(function() {
    $("#footer li i").mouseenter(function() {
        $(this.parent()).find(".tooltip").toggle();
    }).mouseleave(function() {
        $(this.parent()).find(".tooltip").toggle();
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:31:24.483

```
.tooltip {
    position: absolute;  /* <- not relative */
    top: 10px;           /* <- position relative to #footer li */
    left: 10px;
} 
```

您可以删除 js 并使用 CSS 在鼠标悬停时显示它：

```
#footer li:hover .tooltip{
    display:block;
} 
```

# php - 准备好的 MySQLi 语句

> ID：14790605
> 
> 赞同：3
> 
> 时间：2013-02-09T19:18:14.953
> 
> 标签：php, mysqli

我一直使用 PDO 语句，但由于某种原因，我无法说服服务器人员为 php 安装 PDO，但我确实有 MySQLi，我不知道我做错了什么，我没有收到连接错误而且无论我如何尝试输出一个查询错误，我都不会收到查询错误。这就是我正在做的事情。

```
include 'MySQLiConnect.php';

if($stmt = $mysqli->prepare("SELECT * FROM zipCodeTable WHERE zip_code = ?")){

    $stmt->bind_param("s", '07110');

    $stmt->execute();

    $stmt->bind_result($resultsArray);

    $stmt->fetch();

    foreach($resultsArray as $columnData){

        $matchingZipcode = $columnData['zip_code'];
        $matchingTimezone = $columnData['time_zone'];
    }       

    $stmt->close();

}

echo $matchingZipcode.', '.$matchingTimezone; 
```

这基本上只是为了确认用户的邮政编码，以前从未使用过 MySQLi 准备好的语句，我尝试直接从手册中进行操作，不知道我做错了什么。感谢您抽出时间来阅读。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T19:29:30.680

您正在尝试“绑定”文字字符串。你不能这样做。您必须绑定一个变量。

改变

```
$stmt->bind_param("s", '07110'); 
```

至

```
$string = '07110';

$stmt->bind_param("s", $string); 
```

此外，当您绑定结果时，您必须为返回的每个字段提供一个变量。

例如：

```
$stmt->bind_result($zipCode, $timeZone); 
```

这在使用`SELECT *`. 您可能有兴趣查看此评论以了解您可能想要如何去做：[http ://www.php.net/manual/en/mysqli-stmt.bind-result.php#85470](http://www.php.net/manual/en/mysqli-stmt.bind-result.php#85470)

# java - 使用 Android 的 Google Chrome 徽标

> ID：14790610
> 
> 赞同：-1
> 
> 时间：2013-02-09T19:18:49.137
> 
> 标签：java, android

我找不到与 Google chrome 徽标一样接近的类似示例。我想使用 Android 制作这个标志，忘记颜色或确切的设计。想象一下蓝点是一个 ImageView，红色、绿色和黄色是 ImageButton。我想要一个像这样被 3 或 4 个 ImageButtons 包围的 ImageView。我想出的只是以 ImageView 为中心的椭圆形布局形状。如果有人有，我只需要提示。

![在此处输入图像描述](../Images/f8c39e86bf5cb3e45535ed65ac187fa9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:35:25.757

[http://en.wikipedia.org/wiki/File:Chrome_Logo.svg](http://en.wikipedia.org/wiki/File:Chrome_Logo.svg)和[http://upload.wikimedia.org/wikipedia/commons/e/e2/Google_Chrome_icon_%282011%29.svg](http://upload.wikimedia.org/wikipedia/commons/e/e2/Google_Chrome_icon_%282011%29.svg)是 chrome 标志的 SVG 版本. 您应该能够从中获得非常精确的坐标。

# android - 鼠标悬停的 jQuery 移动等效项

> ID：14790611
> 
> 赞同：1
> 
> 时间：2013-02-09T19:19:23.203
> 
> 标签：android, jquery, hover, equivalent

当光标悬停时，我有一个在一系列缩略图 img 选项卡中激活的功能。

图像是 display:block 和 position:absolute，鼠标悬停时位置（顶部）和大小会发生变化。

如何在 Android 或 iPhone/iPad Safari 上重现相同的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T19:44:29.720

您可能希望将`tap`事件绑定到缩略图而不是`mouseover`. 我相信 iOS 上的 Safari 可能已经将悬停事件解释为点击/点击，因此在这些情况下无需执行任何操作，但这可能仅适用于 CSS`:hover`伪类，而不适用于`mouseover`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-09T19:51:07.300

android中的@Didier Levy，因为没有光标你不能给它类似的效果..

您可以做的是，您可以使用一些 .xml 文件并更改按钮背景等等

首先在 bg_button.xml 中创建一个新的 android .xml 文件到项目的 res/drawable 目录中

内容将是

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<item android:state_pressed="true"
      android:drawable="@drawable/bg_button_ov" /> <!-- pressed -->

<item android:state_focused="true"
      android:drawable="@drawable/bg_button_ov" /> <!-- focused -->

<item android:drawable="@drawable/bg_button_n" /> <!-- default -->
</selector> 
```

使用@drawable 资源来实现您想要的效果

现在**可以将此效果添加到按钮**

```
 <Button
        android:id="@+id/button_save"
        android:layout_width="80dp"
        android:layout_height="fill_parent"

        android:background="@drawable/bg_button" <!-- drawable resource used here-->

        android:text="@string/Save"
        android:textSize="10dp"
        android:textStyle="bold" /> 
```

# java - 无法检测到多个空间？

> ID：14790613
> 
> 赞同：0
> 
> 时间：2013-02-09T19:19:43.610
> 
> 标签：java, string

**更新**

好像当我从这个问题中复制字符串`"       AAAAAA"`并替换它时。该程序正常工作。

所以我只是通过改回`"       AAAAAA"`我以前的错误字符串来做一些测试。然后删除所有空格并通过键入手动输入它，它可以工作！？！？。

这是我的完整代码

```
public static void main(String[] args) {
    URL url;
    InputStream is = null;

    try {
        url = new URL(
                "http://writer.dek-d.com/nattione/story/viewlongc.php?id=466201&chapter=966");

        is = url.openStream(); // throws an IOException
        String result = convertStreamToString(is);
        createFictionFiles(result);

    } catch (MalformedURLException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        try {
            is.close();
        } catch (IOException e) {
            // nothing to see here
        }
    }
}

public static void createFictionFiles(String html) {
    Document doc = Jsoup.parse(html);
    Element title = doc.select("title").first();
    Element table = doc.select("#story_body").first();

    String showTitle = "";
    String showStory = "";
    BufferedWriter bw;
    try {
        showTitle = new String(title.text());
        showStory = new String(table.text());
        //showStory = "       AAAAAA"; these spaces I copy it from log in eclipse. It is the spaces that come from web
        boolean find = showStory.contains("\\t");
        boolean find1 = showStory.contains("\\n");
        boolean find2 = showStory.contains("\\x0b");
        boolean find3 = showStory.contains("\\r");
        boolean find4 = showStory.contains("\\f");
        boolean find5 = showStory.contains(" ");
        boolean find6 = showStory.contains("  ");
        boolean find7 = showStory.matches("\\s");
        System.out.println("\\t = " + find);
        System.out.println("\\n = " + find1);
        System.out.println("\\x0b = " + find2);
        System.out.println("\\r = " + find3);
        System.out.println("\\f = " + find4);
        System.out.println(" = " + find5);
        System.out.println("  = " + find6);
        System.out.println("\\s = " + find7);

        File file = new File("D:/" + "test"
                + ".txt");

        if (!file.exists()) {
            file.createNewFile();
        }

        FileWriter fw = new FileWriter(file.getAbsoluteFile());
        bw = new BufferedWriter(fw);
        bw.write(showStory);
        bw.close();

    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

}

public static String convertStreamToString(InputStream is) {
    Scanner s = new Scanner(is, "TIS-620").useDelimiter("\\A");
    return s.hasNext() ? s.next() : "";
} 
```

**老的**

我有这个字符串

```
showStory = "       AAAAAA"; 
```

这些字符串是从 Web 检索并使用[库将其解析为字符串格式](http://jsoup.org/cookbook/extracting-data/selector-syntax)

我想将超过 3 英寸的空间分开，将它们替换为`"\n"`

我有这些测试。

```
boolean find = showStory.contains("\\t");
boolean find1 = showStory.contains("\\n");
boolean find2 = showStory.contains("\\x0b");
boolean find3 = showStory.contains("\\r");
boolean find4 = showStory.contains("\\f");
boolean find5 = showStory.contains(" ");
boolean find6 = showStory.contains("  ");
boolean find7 = showStory.contains("\\s"); 
```

结果是

```
\t = false
\n = false
\x0b = false
\r = false
\f = false
 = true
  = false
\s = false 
```

我不知道为什么在我的字符串中有 8 个空格的情况下，为什么会有多个空格给我 false。我也将方法从更改为`contains`，`matches`但所有结果都是错误的。

谁能帮我这个？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T19:30:41.650

请再次检查...它不可能识别出 find6 中的 2 个空格

```
 String showStory = "       AAAAAA";

 boolean find = showStory.contains("\\t");
 boolean find1 = showStory.contains("\\n");
 boolean find2 = showStory.contains("\\x0b");
 boolean find3 = showStory.contains("\\r");
 boolean find4 = showStory.contains("\\f");
 boolean find5 = showStory.contains(" ");
 boolean find6 = showStory.contains("  ");
 boolean find7 = showStory.contains("\\s");

 System.out.println("find ="+find);
 System.out.println("find1 ="+find1);
 System.out.println("find2 ="+find2);
 System.out.println("find3 ="+find3);
 System.out.println("find4 ="+find4);
 System.out.println("find5 ="+find5);
 System.out.println("find6 ="+find6);
 System.out.println("find7 ="+find7);

  }//end of main 
```

这是印刷品：

```
find =false
find1 =false
find2 =false
find3 =false
find4 =false
find5 =true
find6 =true
find7 =false 
```

# javascript - IE中没有出现highcharts

> ID：14790614
> 
> 赞同：0
> 
> 时间：2013-02-09T19:19:44.047
> 
> 标签：javascript, internet-explorer, highcharts

我在 ie 浏览器中显示我的图表[jsfiddle 图表时遇到问题。](http://jsfiddle.net/suuuunto/XWAzD/)我已经阅读了有关逗号的所有内容，但没有得到更好的结果。

```
 $(document).ready(function() {
  var chart;
chart = new Highcharts.Chart({

chart: {
renderTo: 'chart_risk_factors_var95',
backgroundColor:'#F7F7F7',
height:200,
plotBackgroundColor: null,
plotBorderWidth: null,
plotShadow: false
},

credits: {
enabled: false
},

tooltip: {
pointFormat: '<b>{point.percentage}%</b>',
percentageDecimals: 1
},

title:{
text:null    
},

plotOptions: {

pie: {
showInLegend: true,
dataLabels: { enabled: false }}
},

legend: {
layout: 'vertical',
align: 'right',
verticalAlign: 'middle'   
}, 

series: [{
type: 'pie',
name: 'risk factors',
data: [
        {name: 'Interest Exposure',y: <?php echo $data['total_exp_interest_pie'] ?>,color:'#3B8686'},
        {name: 'Equity Exposure',y: <?php echo $data['total_exp_equity_pie'] ?>,color:'#79BD9A'},
        {name: 'Fx Exposure',y: <?php echo $data['total_exp_fx_pie'] ?>,color:'#A8DBA8'},
        {name: 'Commodity Exposure',y: <?php echo $data['total_exp_commodity_pie'] ?>,color:'#CFF09E'}
]}]

});
}); 
```

我还添加了一些 php 代码来填写数据。

我做错了什么？

谢谢帮助，suuuunto

# c++ - Panda3D 和 load_model c++

> ID：14790615
> 
> 赞同：1
> 
> 时间：2013-02-09T19:20:14.920
> 
> 标签：c++, panda3d

我是 panda3d 的新手，正在尝试你好世界。

我已经让程序运行了：

```
PandaFramework framework;
framework.open_framework(argc, argv);
WindowFramework *window = framework.open_window();

framework.main_loop();
framework.close_framework();
return 0; 
```

但是，如果我添加：

```
NodePath environt = window->load_model(framework.get_models(), "panda-model");
environt.reparent_to(window->get_render());
environt.set_scale(0.25, 0.25, 0.25);
environt.set_pos(-8, 42, 0); 
```

在 main_loop() 之前，它不会编译。我的 c++ 项目的每个文件夹中都有 panda-model.egg.pz 但每次我的程序中断时：

```
environt.reparent_to(window->get_render()); 
```

excat 消息是：Irr.exe 中 0x0152a317 处的未处理异常：0xC00001A5：检测到无效异常处理程序例程。

它编译得很好，唯一的问题是它找不到 pdb 文件，但这没关系。

有任何想法吗？

顺便说一句，我正在使用 MSVC++ 2010 和 panda3d 1.7.2

我能找到的唯一错误是：Irr.exe 中 0x00bfa317 的第一次机会异常：0xC0000005：访问冲突读取位置 0x737265db。Irr.exe 中 0x00bfa317 处未处理的异常：0xC00001A5：检测到无效的异常处理程序例程。程序“[8476] Irr.exe: Native”已退出，代码为 0 (0x0)。

我很确定这仍然相当模糊。对不起，我能找到的就只有这些了。如有必要，我很乐意对其进行更多描述。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T13:02:40.247

当前版本的 Panda3D 不支持 Microsoft Visual C++ 2010。您将需要使用 2008 或从源代码针对 MSVC 2010 编译 Panda3D SDK。（这并不像听起来那么简单，因为您还需要编译一些第三方软件包以与 2010 兼容。但是，有可能.)

如果您坚持使用 2010 而不是 2008，此论坛帖子可能会有所帮助： [https ://www.panda3d.org/forums/viewtopic.php?t=12663](https://www.panda3d.org/forums/viewtopic.php?t=12663)

# php - 检查 select 语句是否包含文本，然后用另一个更改它

> ID：14790616
> 
> 赞同：0
> 
> 时间：2013-02-09T19:20:20.337
> 
> 标签：php, mysql, sql, triggers

我是 MySql 的新手 ^_^ ，

我正在使用一个名为 GLPI 的现有开源，他们使用的是 MVC 方法，所以我发现编辑主代码非常困难，这就是为什么我决定发布这个问题，如果我可以从 MySql 更改选择语句。

所以我需要知道如果有任何操作包含（

```
SELECT * FROM `glpi_tickettemplates` WHERE `id` = '-2' 
```

)

然后用 (

```
SELECT * FROM `glpi_tickettemplates`  WHERE `id` = '1' 
```

)

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:17:42.660

根据您的问题，您似乎只需要一个特定行，所以为什么不将 id='-2' 的行复制到 id='1' 的行中然后

```
DELIMITER $$
CREATE TRIGGER myTrigger AFTER UPDATE ON `glpi_tickettemplates`
CREATE TEMPORARY TABLE `tempTable` 
AS 
SELECT * FROM `glpi_tickettemplates` WHERE id='-2'; 
UPDATE `tempTable` SET id='1' WHERE id='-2';
REPLACE INTO `glpi_tickettemplates` SELECT * FROM `tempTable`;
DROP TEMPORARY TABLE `tempTable`; 
DELIMITER; 
```

## 更新：

如果你想在所有传入的查询中替换 every `id='-2'`，`id='-1'`请查看[MySQL Proxy](https://launchpad.net/mysql-proxy)。

MySQL Proxy 是一个简单的程序，位于您的客户端和 MySQL 服务器之间，可以监控、分析或转换它们的通信。

它的灵活性允许无限使用；常见的包括：

*   负载均衡
*   故障转移
*   查询分析
*   查询过滤和修改

还有很多。

在[http://forge.mysql.com/wiki/MySQL_Proxy](http://forge.mysql.com/wiki/MySQL_Proxy)，您可以找到安装、使用和运行 MySQL Proxy 的所有链接。

# c++ - 使用没有回调 C++ 的函数

> ID：14790632
> 
> 赞同：0
> 
> 时间：2013-02-09T19:23:06.870
> 
> 标签：c++, visual-c++

我想调用一个需要回调的函数：

```
cookie_monster->SetCookieWithOptionsAsync(
   ext_url, "dummy=value", options, &callback_function)); 
```

如果我不想调用任何回调函数怎么办？有类似 set 的东西`NULL`吗？

```
cookie_monster->SetCookieWithOptionsAsync(
   ext_url, "dummy=value", options, NULL); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T19:28:39.860

这取决于功能。如果在函数的主体中，代码在调用它之前测试是否`callback_function`是`NULL`，你会没事的。否则，您将遇到段错误并且您的程序将崩溃。

在这种情况下，您需要传入一个空/无操作回调来容纳 API。

# javascript - 使用现有键将对象合并到数组中

> ID：14790633
> 
> 赞同：0
> 
> 时间：2013-02-09T19:23:11.923
> 
> 标签：javascript

我多次创建以下对象：

```
id : {
    "hp" : hp,
    "row" : startY,
    "square" : startX
} 
```

我想将这些对象`id`作为键创建一个数组，以获得一个看起来像这样的对象：

```
1 : {
    "hp" : 1,
    "row" : 2,
    "square" : 3
},
2 : {
    "hp" : 4,
    "row" : 5,
    "square" : 6
} 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T19:48:24.477

这是一个示例，它将为您提供所需的对象数组：

**[在此处查看有效的 JSFIDDLE 演示](http://jsfiddle.net/RMBJN/4/)**

下面的代码：

```
var model = { id : {
    "hp" : "",
    "row" : "",
    "square" : ""
} }

function keystempl(args)
{
   var args = Array.prototype.slice.call(args,0);
    var templ = args[0];
    var newo ={};

    var keys = [];
    for(var k in templ) 
    {
        keys.push(k);
    }

    for(var i=0;i<keys.length;i++)
    {
        newo[keys[i]] = args[i + 1]; 
    }
    return newo; 

}

var arr = [];
var obj = keystempl([model["id"],"myhp","myrow","mysquare"]);
var obj2 = keystempl([model["id"],"myhp2","myrow2","mysquare2"]);

arr.push(obj);
arr.push(obj2); 
```

一个示例用法如下：

```
var myarray = [];

myarray.push(keystempl([model["id"],"myhp","myrow","mysquare"]));
myarray.push(keystempl([model["id"],"myhp2","myrow2","mysquare2"]));
//YOUR ARRAY "myarray" NOW HAS TWO OBJECTS IN IT WITH THOSE VALUES 
```

# c# - 从通过usb电缆直接与windows机器连接的手机访问IIS网站

> ID：14790634
> 
> 赞同：3
> 
> 时间：2013-02-09T19:23:17.717
> 
> 标签：c#, asp.net-mvc, iis, mobile

你可能会觉得这个问题很奇怪，但现在我们有各种各样的 Windows 和手机应用程序。虽然谷歌搜索没有帮助，但我认为可能有人知道答案。

是否可以在手机上访问 IIS 托管网站。手机通过usb线连接到windows机器。如果有可能，请问程序是什么。

IIS 网站是用 c# 用 asp.net mvc 4 razor 编写的。不幸的是，网络没有wifi，所以通过wifi连接到windows机器是不可能的。我是我的 Windows 机器的管理员。目前，也无法在服务器上托管网站并使其在互联网上可用。我的手机是最新的安卓。

简而言之，我有一个托管在 IIS 上的网站，并且手机通过 USB 连接到机器，我想通过手机浏览该网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:14:02.007

我脑海中的一些想法：

*   如果您的手机可以访问互联网并且您可以访问您的网络路由器（或者您可以要求您的管理员为您执行此操作），那么您只需将端口转发到您的 PC 并使用适当的端口从互联网连接到您的路由器。请查看您的路由器手册以获取更多详细信息
*   您还可以购买便宜的 USB wifi 密钥，您可以将其与您的 PC 一起使用，以便与您的手机直接连接
*   根据您的手机操作系统，您实际上可以通过使用 3rd 方软件和一些黑客来共享互联网连接（因此可能同时让您的手机访问您的本地 PC） - 这是一个适用于 Android 但需要根操作系统[http:// www.howtogeek.com/117118/how-to-connect-your-android-to-your-pcs-internet-connection-over-usb/](http://www.howtogeek.com/117118/how-to-connect-your-android-to-your-pcs-internet-connection-over-usb/)

祝你好运！:-)

# java - 将css文件添加到jsp文件中的元素？

> ID：14790636
> 
> 赞同：0
> 
> 时间：2013-02-09T19:23:27.460
> 
> 标签：java, jsp, servlets

过去一个小时我一直在网上搜索，但我看不到如何将 css 文件添加到`<head>`页面元素。

假设我有一个名为 shopping.jsp 的 jsp。在其中我有条件地包含一个名为 products.tag 的 jsp 标记文件。

我希望 products.jsp 指定一个 css 文件以添加到页面的 head 元素。如何才能做到这一点？

**编辑**

为了示例，此代码被简化。

```
// shopping.jsp
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<%@taglib prefix="t" tagdir="/WEB-INF/tags" %>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>

<t:standard_page>
    <jsp:body>
        <t:products product="${product}"/>
    </jsp:body>
</t:standard_page>

// products.tag
// I want to specify a css file in this tag file that will get added to the <head> element of the webpage
<%@tag description="Template for products on the shopping cart page" pageEncoding="UTF-8"%>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@tag import="com.myapp.Product" %>
<%@attribute name="product" required="true" type="com.myapp.Product"%>

<div class="shopping-cart-row">
    <div class="product-name">${product.name}</div>
    <div class="product-quantity">${product.quantity}</div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:30:54.233

根据 HTML5，[`<style>`元素](http://www.w3.org/TR/html-markup/style.html#style-context)可以出现在里面

> 任何可以包含元数据元素的元素，`div`, `noscript`, `section`, `article`,`aside`

因此，如果您希望页面进行验证，则无需像处理元素一样将`<style>`元素放入其中。`<head>``<link>`

```
<style type="text/css">@import url("/path/to/stylesheet.css");</style> 
```

从体内将加载外部样式表就好了。

如果`<body>`它`<script>`在`<head>`.

# linux - 在linux中修改（向每个字节添加数字）二进制文件的好方法是什么？

> ID：14790637
> 
> 赞同：0
> 
> 时间：2013-02-09T19:23:47.390
> 
> 标签：linux, command-line, binary, decode

我有一个字节被某个数字关闭的编码文件。我想将该数字添加到文件中的每个字节以对其进行解码。但是通过在十六进制编辑器中手动为每个字节添加数字来这样做非常耗时且效率低下。看起来 bbe 可以是正确的工具，但我不确定如何很好地使用它。是否有任何工具具有逐块添加/删除/修改二进制文件的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:28:08.483

你打算用 0xFF 做什么？

您可能可以使用[tr](http://unixhelp.ed.ac.uk/CGI/man-cgi?tr%201)，但编写一个小 Python 脚本可能会更容易。

**编辑**

如果我发现这是一项家庭作业，但在 Python 中，上帝会帮助你

```
with open('in', 'rb') as f:
    with open('out', 'wb') as g:
        for x in f.read():
            g.write(''.join([ chr((ord(a)+1) % 256) for a in x])) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T19:41:00.620

```
tr \\000-\\376 \\001-\\377  <input >output 
```

# c# - 如何从 C#.NET Windows 应用程序使用基于 HTTPS 的 Web 服务（由 Java 服务器公开）

> ID：14790638
> 
> 赞同：0
> 
> 时间：2013-02-09T19:24:21.817
> 
> 标签：c#

我想使用 C#.NET Windows 应用程序作为客户端从 javaserver 公开的基于 HTTPS 的 Web 服务调用方法。我的 Java 服务器有一些文件格式`.cer`的证书。`.jks`

我的问题是：我需要在本地机器上创建一些证书，还是需要访问存储在 java 服务器中的证书才能提供我的 .NET 客户端和 Java 服务器之间的通信？

# magento - Paypal Payments Pro 是否直接与 magento 社区合作以接受信用卡进行定期计费？

> ID：14790641
> 
> 赞同：1
> 
> 时间：2013-02-09T19:24:45.770
> 
> 标签：magento, paypal, recurring-billing

我在 magento 有一家在线订阅商店，我正在考虑使用 Paypal Payments Pro 来接受信用卡/借记卡（基于英国）以定期接受付款。

我可以直接在 magento 中启用 Paypal payment pro 以接受信用卡进行定期付款，还是需要外部插件（例如headworks等）来实现？关于在线定期付款的信息似乎很少，而且这些公司中的大多数的支持人员都说着极其神秘的语言。

我尝试了我在 Paypal 在线指南中找到的集成步骤，这些步骤在 magento 中启用了 Payment Pro。但是当我这样做时，我只能选择通过贝宝帐户付款。我在这里想念什么？我需要一个外部插件来接受信用卡吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-21T16:03:00.777

首先，免责声明，我正在研究美国的 PayPal 集成，而不是英国的 PayPal 集成，因此可能存在差异。

你的问题是我目前正在处理的一个场景。也就是说，使用 PayPal 作为直接支付方式（通过 Payments Pro 或 Payflow）的提供者，同时使用信用卡直接付款和 PayPal Express Checkout 购买基于订阅的产品（例如，创建定期付款配置文件）。

就重复配置文件而言，Magento 存在局限性。PayPal Payments Pro 确实与 Magento 集成，但它不是在 PayPal 中设置定期配置文件的受支持方法。您需要使用 Express Checkout。

AheadWorks 提供了一个第三方扩展——“订阅和定期付款”，它为定期付款提供了扩展功能。旧版本 (1.9) 支持使用 PayPal Payments Pro 或 Payflow Pro，但不支持 Express Checkout。较新的版本 (2.0) 支持仅使用 Express Checkout。所以你得到一个或另一个。从技术上讲，运行两个版本的 SARP 都是可行的，但这是一种陈旧的、服务器密集型的方法，我不推荐这种方法。

如果您想同时进行 Express Checkout 和直接信用卡支付（通过 PayPal 产品），您必须深入研究池的深处并扩展 Magento 中现有的 PayPal 模块。（我知道这一点，因为我目前在游泳池的最深处！）

抱歉，这并不能“解决”您的问题。我花了几个月的时间在这个特定的情况下进行发现工作，结果是我要么： a) 破解 Magento 的 PayPal 模块来做我想做的事。b) 创建一个扩展 Magento 的 PayPal 模块的自定义模块。c) 使用单独的 Magento 模块创建一个独立的事务 API，以与 API 接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T07:03:32.683

Payments Pro 用于直接处理信用卡，因此如果您启用它，您将获得该选项。

我很确定在 Magento 中，当您启用 Pro 时，它也需要启用 Express Checkout，因此您会看到 Checkout with PayPal 按钮，这将使他们只需登录。但是，如果有人单击常规结帐按钮，并完成剩下的步骤，它将允许他们直接输入信用卡详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T18:53:49.803

Payments Pro（定期付款）不直接与 Magento 集成。但是，您可以通过使用 PayPal 创建计费协议来创建定期配置文件

计费协议是商店与客户之间在支付服务方面签署/授权的购买/销售协议。借助 Magento Enterprise Edition 1.9 和 Magento Community Edition 1.4.1 中引入的计费协议功能，定期从网上商店购买产品的个人客户无需反复输入付款信息即可下订单；他们可以简单地向支付系统授予一次授权。

换句话说，计费协议是一种付款方式，允许客户在不向商店提供付款详细信息的情况下下订单。客户在支付服务端与商店签订计费协议后，后者向商店和客户提供所签署的计费协议的参考ID。参考 ID 是支付系统分配给计费协议的唯一编号。在进一步购买期间，客户选择开票协议作为付款方式并使用开票协议参考 ID。下订单不需要其他付款信息。支付系统验证计费协议信息以及是否可以通过客户指定的参考 ID 完成支付。支付系统进行支付交易后，参考 ID 返回到 Magento 系统并下订单。与 PayPal 签订计费协议后，店主可以直接向客户的 PayPal 账户收费。

目前 Magento 仅支持使用 PayPal 支付系统来实现计费协议功能。在使用计费协议功能之前，商店管理员必须联系 PayPal 商户技术服务，为他们的 PayPal 商户账户启用计费协议（参考交易）。

此处列出的更多信息：http: [//www.magentocommerce.com/knowledge-base/entry/setting-up-billing-agreements-through-paypal//](http://www.magentocommerce.com/knowledge-base/entry/setting-up-billing-agreements-through-paypal//)

# performance - 本地主机上的问题：必须多次更新页面

> ID：14790643
> 
> 赞同：-1
> 
> 时间：2013-02-09T19:24:51.657
> 
> 标签：performance, xampp, localhost, updates

我目前正在制作一个网页并在本地主机上本地运行以进行测试。但是，每当我对该页面进行更改并想在浏览器中查看结果时，我都会遇到“问题”。我必须多次更新（按 F5 或浏览器中的更新按钮）才能显示该站点。与此同时，它只是白色的......假设我在浏览器中打开了该站点（看起来不错），然后我进行了更改并想查看它。我在浏览器中按了一次更新按钮，该站点现在只是白色的。我一次又一次地按下它，但它仍然是白色的。直到我按了随机次数，它才起作用。有时我只需要更新一次，有时我必须更新7-8次。有时它快得像地狱，有时它像我学校的电脑一样慢。

有谁知道网站本身是否存在问题（即使我将其上传到服务器后，此问题仍将存在），或者这只是我的互联网/计算机/在本地主机上运行时的已知问题?

我在 Mac 上使用 XAMPP，并尝试在 Safari 和 Chrome 中测试该页面。

提前感谢所有提示！

来自欧洲的问题，Alekplay

**编辑 1：** 事实证明 Chrome 决定现在给我一条错误消息而不是白屏。它说“没有收到数据”，而 Safari 仍然是空白的。有任何想法吗？我试过关闭缓存。

**编辑 2：** 在这里和那里做了一些调整，发现是 SimpePies autoloader.php 导致了我的问题。你们中的任何人都对 SimplePie 有任何了解，并且知道如何使网站加载更快吗？当我注释掉时很好`require_once('php/autoloader.php');`，但我需要它来加载我的提要。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:31:56.777

进入chrome，您可以关闭缓存。看看这个页面：

[http://geek.michaelgrace.org/2011/09/disable-google-chrome-cache/](http://geek.michaelgrace.org/2011/09/disable-google-chrome-cache/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:34:41.767

使用 Chrome：CTRL+SHIFT+R
我不了解 Safari。
这可能与缓存或 apache 本身有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-23T10:07:59.737

查看 apache 的 error.log 是否有任何错误。它可能与类似于此的错误有关：

> AH00052：子 pid 62969 退出信号分段错误 (11)

那么你应该[在 apache error.log 中检查：“[notice] child pid XXXX exit signal Segmentation fault (11)”](https://stackoverflow.com/questions/7745578/notice-child-pid-xxxx-exit-signal-segmentation-fault-11-in-apache-error-lo)

基本上它声明要尝试增加 php.ini 中的 output_buffering

如其他地方所述，您必须对 coredump 运行回溯以了解它崩溃的原因。在我的情况下，它是 APC，一旦在 php.ini 上被禁用，错误就消失了。你的可能是因为其他原因。

# c# - 为什么位图中的数据超出范围？

> ID：14790645
> 
> 赞同：5
> 
> 时间：2013-02-09T19:25:51.027
> 
> 标签：c#, windows, file-io, bitmap

我正在为 Skyrim 创建一个保存游戏管理器，但遇到了问题。当我自己创建 SaveGame 对象时，保存的位图部分可以正常工作。但是，当我在循环中调用该方法时，位图会出现错误的值，主要是与另一个保存游戏的值相似的值。

TL;DR - 为什么我的表单列表框显示正确的字符保存信息，但嵌入的图片除外？与其选择正确的图片，不如选择最后处理的图片。该过程与通过打开文件对话框选择时有何不同？

* * *

编辑：更新 - 我查看了与每个 SaveGame 对象一起存储的位图，发现在 scanDirectoryForSaves 中创建 SaveGames 的过程中不知何故搞砸了。位图和使用我不知道的字节指针是否存在对象范围问题？

* * *

这是我保存游戏对象的静态工厂的代码：

```
public string Name { get; private set; }
    public int SaveNumber { get; private set; }
    public int PictureWidth { get; private set; }
    public int PictureHeight { get; private set; }
    public Bitmap Picture { get; private set; }
    public DateTime SaveDate { get; private set; }
    public string FileName { get; private set; }

    public static SaveGame ReadSaveGame(string Filename)
    {

        SaveGame save = new SaveGame();
        save.FileName = Filename;

        byte[] file = File.ReadAllBytes(Filename);

        int headerWidth = BitConverter.ToInt32(file, 13);
        save.SaveNumber = BitConverter.ToInt32(file, 21);
        short nameWidth = BitConverter.ToInt16(file, 25);

        save.Name = System.Text.Encoding.UTF8.GetString(file, 27, nameWidth);
        save.PictureWidth = BitConverter.ToInt32(file, 13 + headerWidth - 4);
        save.PictureHeight = BitConverter.ToInt32(file, 13 + headerWidth);
        save.readPictureData(file, 13 + headerWidth + 4, save.PictureWidth, save.PictureHeight);

        save.SaveDate = DateTime.FromFileTime((long)BitConverter.ToUInt64(file, 13 + headerWidth - 12));

        return save;
    }

    private  void readPictureData(byte[] file, int startIndex, int width, int height)
    {
        IntPtr pointer = Marshal.UnsafeAddrOfPinnedArrayElement(file, startIndex);
        Picture =  new Bitmap(width, height, 3 * width, System.Drawing.Imaging.PixelFormat.Format24bppRgb, pointer);
    } 
```

在我的表单中，我使用一种方法来读取某个目录中的所有保存文件，从中创建 SaveGame 对象，然后根据角色名称将它们存储在字典中。

```
private Dictionary<string, List<SaveGame>> scanDirectoryForSaves(string directory)
    {
        Dictionary<string, List<SaveGame>> saves = new Dictionary<string, List<SaveGame>>();
        DirectoryInfo info = new DirectoryInfo(directory);

        foreach (FileInfo file in info.GetFiles())
        {
            if (file.Name.ToLower().EndsWith(".ess") || file.Name.ToLower().EndsWith(".bak"))
            {
                string filepath = String.Format(@"{0}\{1}", directory, file.Name);
                SaveGame save = SaveGame.ReadSaveGame(filepath);

                if (!saves.ContainsKey(save.Name))
                {
                    saves.Add(save.Name, new List<SaveGame>());
                }
                saves[save.Name].Add(save);
            }
        }

        foreach (List<SaveGame> saveList in saves.Values)
        {
            saveList.Sort();
        }

        return saves;
    } 
```

我将键添加到列表框中。在列表框中选择名称时，该角色的最新保存将显示在表单上。每个角色的名称、日期和其他字段都是正确的，但位图是某个角色保存游戏图片的变体。

我在从打开的文件对话框和列表框中选择保存时调用相同的方法来更新表单字段。

```
private void updateLabels(SaveGame save)
    {
        nameLabel.Text = "Name: " + save.Name;
        filenameLabel.Text = "File: " + save.FileName;
        saveNumberLabel.Text = "Save Number: " + save.SaveNumber;

        saveDateLabel.Text = "Save Date: " + save.SaveDate;

        saveGamePictureBox.Image = save.Picture;
        saveGamePictureBox.Image = ScaleImage(
            saveGamePictureBox.Image, saveGamePictureBox.Width, saveGamePictureBox.Height);
        saveGamePictureBox.Invalidate();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T00:10:43.917

当您使用带有`Bitmap`的[构造函数](http://msdn.microsoft.com/en-us/library/zy1a2d14.aspx)创建a 时`IntPtr`，`IntPtr`必须指向在`Bitmap`对象的生命周期内保持有效的内存块。您有责任确保内存块不会被移动或释放。

但是，您的代码正在传递一个`IntPtr`指向 的`file`，这是一个托管字节数组。`file`因为返回后没有引用`ReadSaveGame`，垃圾收集器可以自由地回收内存并将其重用于下一个文件。结果：损坏的位图。

尽管您可以通过使用[GCHandle](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.gchandle.aspx)将数组固定在内存中来解决此问题，但让`Bitmap`管理自己的内存可能更容易和更安全。首先创建一个空的`Bitmap`，然后设置它的位：

```
private void readPictureData(byte[] file, int startIndex, int width, int height)
{
    Bitmap bitmap = new Bitmap(width, height, PixelFormat.Format24bppRgb);
    BitmapData data = bitmap.LockBits(
        new Rectangle(0, 0, width, height),
        ImageLockMode.WriteOnly, PixelFormat.Format24bppRgb);
    Marshal.Copy(file, startIndex, data.Scan0, width * height * 3);
    bitmap.UnlockBits(data);
    Picture = bitmap;
} 
```

# php - CakePHP 不检查表单验证

> ID：14790647
> 
> 赞同：-1
> 
> 时间：2013-02-09T19:26:04.847
> 
> 标签：php, validation, cakephp, view, model

我正在写一个联系表格，并想添加一些简单的验证例程。此页面的操作如下所示：

```
public function contact() {
    $this->loadModel('Contact');

    $this->set('pageTitle', 'Contact me');
} 
```

`Contact`模型是这样的：

```
<?php

class Contact extends AppModel {
public $useTable = false;

public $validate = array(
    'name' => array(
        'between' => array(
            'rule' => array('between', 1, 60),
            'message' => 'Between 1 and 60 characters in length'
        )
    ),
    'email' => array(
        'kosher' => array(
            'rule' => 'email',
            'message' => 'Please make sure your email is entered correctly'
        ),
    ),
    'message' => array(
        'between' => array(
            'rule' => array('between', 1, 65000),
            'message' => 'Between 1 and 65000 characters in length'
        )
    )
); 
```

}

最后是我的视图页面：

```
<?php echo $this->Form->create('Contact'); ?>
<?php echo $this->Form->input('name'); ?>
<?php echo $this->Form->input('email'); ?>
<?php echo $this->Form->input('message', array('type' => 'textarea')); ?>
<?php echo $this->Form->end(array('label' => 'Send', 'class' => 'btn btn-primary')); ?> 
```

但是，当我提交带有不正确值的表单时，不会调用验证例程，也不会显示错误消息。

如何让 Cake 验证表单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:50:55.320

查看文档以了解如何从控制器中的表单插入/更新数据。你会看到这样的东西：

```
if ($this->request->is('post')) {
    if ($this->Contact->save($this->request->data)) {
        // handle the success.
    } else {
       $this->Session->setFlash(__('The Contact could not be saved. Please, try again.'));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:59:20.600

在您的联系操作中，您所做的只是加载联系模型。您必须显式调用相关的模型方法来执行验证。正确阅读[手册](http://book.cakephp.org/2.0/en/models/data-validation/validating-data-from-the-controller.html)以了解如何做到这一点。

# mysql - 启动 MySQL。错误！pid-file 管理器退出而不更新文件

> ID：14790652
> 
> 赞同：1
> 
> 时间：2013-02-09T19:27:04.357
> 
> 标签：mysql

我有一个 Centos，发现我的 MySQL 在突然失败后无法启动。我已经在谷歌尝试了所有可能的研究，但无济于事。这是日志详细信息

```
root@27583 [~]# tail -200 /var/log/mysql.log
18:53:49 UTC - mysqld got signal 6 ;
This could be because you hit a bug. It is also possible that this binary
or one of the libraries it was linked against is corrupt, improperly built,
or misconfigured. This error can also be caused by malfunctioning hardware.
We will try our best to scrape up some info that will hopefully help
diagnose the problem, but since we have already crashed,
something is definitely wrong and this may fail.

key_buffer_size=134217728
read_buffer_size=2097152
max_used_connections=0
max_threads=500
thread_count=0
connection_count=0
It is possible that mysqld could use up to
key_buffer_size + (read_buffer_size + sort_buffer_size)*max_threads = 2184911 K  bytes    of memory
Hope that's ok; if not, decrease some variables in the equation.

Thread pointer: 0x0
Attempting backtrace. You can use the following information to find out
where mysqld died. If you see no messages after this, something went
terribly wrong...
stack_bottom = 0 thread_stack 0x40000
/usr/sbin/mysqld(my_print_stacktrace+0x35)[0x7dad25]
/usr/sbin/mysqld(handle_fatal_signal+0x3e1)[0x693c61]
/lib64/libpthread.so.0[0x7ffa00611ca0]
/lib64/libc.so.6(gsignal+0x35)[0x7ff9ff8112c5]
/lib64/libc.so.6(abort+0x110)[0x7ff9ff812d70]
/usr/sbin/mysqld[0x8deb95]
/usr/sbin/mysqld[0x8b66c9]
/usr/sbin/mysqld[0x8b6c07]
/usr/sbin/mysqld[0x8a87e7]
/usr/sbin/mysqld[0x87eae2]
/usr/sbin/mysqld[0x874ef9]
/usr/sbin/mysqld[0x875514]
/usr/sbin/mysqld[0x876ab1]
/usr/sbin/mysqld[0x8643ba]
/usr/sbin/mysqld[0x82d2a9]
/usr/sbin/mysqld(_Z24ha_initialize_handlertonP13st_plugin_int+0x46)[0x695c66]
/usr/sbin/mysqld[0x587e7c]
/usr/sbin/mysqld(_Z11plugin_initPiPPci+0xcf6)[0x58aac6]
/usr/sbin/mysqld[0x5051e3]
/usr/sbin/mysqld(_Z11mysqld_mainiPPc+0x8ad)[0x50829d]
/lib64/libc.so.6(__libc_start_main+0xf4)[0x7ff9ff7fe9c4]
/usr/sbin/mysqld[0x4ff119]
The manual page at http://dev.mysql.com/doc/mysql/en/crashing.html contains
information that should help you find out what is causing the crash.
130209 19:53:49 mysqld_safe mysqld from pid file  /var/lib/mysql/deepserver.netaviva.net.pid ended
130209 19:58:50 mysqld_safe Starting mysqld daemon with databases from /var/lib/mysql
130209 19:58:50 [Warning] The syntax '--log-slow-queries' is deprecated and will be    removed in a future release. Please use '--slow-query-log'/'--slow-query-log-file' instead.
130209 19:58:50 [Note] Plugin 'FEDERATED' is disabled.
130209 19:58:50 InnoDB: The InnoDB memory heap is disabled
130209 19:58:50 InnoDB: Mutexes and rw_locks use GCC atomic builtins
130209 19:58:50 InnoDB: Compressed tables use zlib 1.2.3
130209 19:58:50 InnoDB: Using Linux native AIO
130209 19:58:50 InnoDB: Initializing buffer pool, size = 128.0M
130209 19:58:50 InnoDB: Completed initialization of buffer pool
130209 19:58:50 InnoDB: highest supported file format is Barracuda.
InnoDB: The log sequence number in ibdata files does not match
InnoDB: the log sequence number in the ib_logfiles!
130209 19:58:50  InnoDB: Database was not shut down normally!
InnoDB: Starting crash recovery.
InnoDB: Reading tablespace information from the .ibd files...
InnoDB: Restoring possible half-written data pages from the doublewrite
InnoDB: buffer...
130209 19:58:50  InnoDB: Error: page 7 log sequence number 7922893671086
InnoDB: is in the future! Current system log sequence number 6086292560908.
InnoDB: Your database may be corrupt or you may have copied the InnoDB
InnoDB: tablespace but not the InnoDB log files. See
InnoDB: http://dev.mysql.com/doc/refman/5.5/en/forcing-innodb-recovery.html
InnoDB: Your database may be corrupt or you may have copied the InnoDB
InnoDB: tablespace but not the InnoDB log files. See
InnoDB: http://dev.mysql.com/doc/refman/5.5/en/forcing-innodb-recovery.html
InnoDB: for more information.
InnoDB: Error: trying to access page number 939544476 in space 0,
InnoDB: space name ./ibdata1,
InnoDB: which is outside the tablespace bounds.
InnoDB: Byte offset 0, len 16384, i/o type 10.
InnoDB: If you get this error at mysqld startup, please check that
InnoDB: your my.cnf matches the ibdata files that you have in the
InnoDB: MySQL server.
130209 19:58:50  InnoDB: Assertion failure in thread 139796076951264 in file fil0fil.c  line 4436
InnoDB: We intentionally generate a memory trap.
InnoDB: Submit a detailed bug report to http://bugs.mysql.com.
InnoDB: If you get repeated assertion failures or crashes, even
InnoDB: immediately after the mysqld startup, there may be
 InnoDB: corruption in the InnoDB tablespace. Please refer to
InnoDB: http://dev.mysql.com/doc/refman/5.5/en/forcing-innodb-recovery.html
InnoDB: about forcing recovery. 
```

请我非常感谢任何帮助以使其再次正常工作。

# php - 循环遍历扩展方法：为 foreach() 提供的参数无效

> ID：14790654
> 
> 赞同：0
> 
> 时间：2013-02-09T19:27:06.637
> 
> 标签：php, class, methods, foreach, extends

我正在尝试遍历父类中扩展类的不同选项，但我的 foreach 语句不断出现此错误：

> 警告：为 foreach() 提供的参数无效

不知道为什么会这样，知道我错过了什么吗？不知道为什么`$this->options()`不被识别为数组......我以前也做过类似的事情，但我认为这里有一些东西正在我的头上拍摄：

```
class parent_class {
    public function my_method() {
        $options = $this->options();
        foreach($options as $option) {
            // ...
        }
    }

    public function options() {
    }
}

class child_one extends parent_class {
    public function options() {
        $options['name_one'] = array(
            'type' => 'type_one',
            'id' => 'id_one',
            'name' => 'name_one'
        );
        return $options;
    }
}

class child_two extends parent_class {
    public function options() {
        $options['name_two'] = array(
            'type' => 'type_two',
            'id' => 'id_two',
            'name' => 'name_two'
        );
        return $options;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:45:59.160

> 警告：为 foreach() 提供的参数无效

告诉你`foreach`期望提供一个数组作为第一个参数。您提供给它`$options = $this->options()`，由于该`options()`方法是空的，因此它的返回值是`NULL`setting `$options = NULL`。

为了避免它，你可以：

```
$options = $this->options();
if (is_array($options))
    foreach($options as $option) {
        // ...
    }
} 
```

# python - 关于在 PyQt 中创建选项卡的困惑

> ID：14790656
> 
> 赞同：0
> 
> 时间：2013-02-09T19:27:11.763
> 
> 标签：python, qt, pyqt, pyqt4

```
import sys
from PyQt4 import QtCore, QtGui

class Class2(object):
    def __init__(self,parent):
        self.welcomeScreen(self)

    def welcomeScreen(self,parent):
        print 'hello'
        self.centralwidget=QtGui.QWidget(parent)
        self.tabWidget=QtGui.QTabWidget(self.centralwidget)
        self.tabWidget.setGeometry(QtCore.QRect(0,0,661,511))
        self.tab=QtGui.QWidget()
        self.lineEdit=QtGui.QLineEdit(self.tab)
        self.tabWidget.addTab(self.tab,"")
        self.tabWidget.show()

class Class1(QtGui.QMainWindow):
    def __init__(self):
        super(Class1, self).__init__()
        self.func()

    def func(self):
        ex=Class2(self)

def main():
    app = QtGui.QApplication(sys.argv)
    mw = Class1()
    mw.show()
    sys.exit(app.exec_())

if __name__=='__main__':
    main() 
```

行。所以在开发一个小型课程管理系统的过程中，我遇到了一个问题，我需要在课堂上创建选项卡，而不是定义主窗口的选项卡。以下程序缩小了我的问题。

问题出在`welcomeScreen(self, parent)`我需要添加标签小部件的功能中。错误是：`TypeError: QWidget(QWidget parent=None, Qt.WindowFlags flags=0): argument 1 has unexpected type 'Class2'`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T19:50:51.857

这一行：

```
self.welcomeScreen(self) 
```

应该

```
self.welcomeScreen(parent) 
```

您有效地将`Class2`对象传递给`welcomeScreen`两次。

`self.welcomeScreen(b)`相当于`Class2.welcomeScreen(self, b)`

# ruby-on-rails - 在 ruby on rails 中将哈希的第一位转换为纯文本，即 en_GB 到英国

> ID：14790660
> 
> 赞同：-1
> 
> 时间：2013-02-09T19:28:08.923
> 
> 标签：ruby-on-rails, ruby, facebook-graph-api

我有这个哈希，我需要将它的第一部分转换为纯文本，例如 en_GB 将是英国。这是我从 Facebook api 获得的示例响应。

```
 {"en_GB"=>6836, "en_US"=>3414, "it_IT"=>120, "es_LA"=>37, "fr_FR"=>24, "zh_TW"=>18, "pt_BR"=>18, "de_DE"=>16, "hr_HR"=>15, "pl_PL"=>12, "es_ES"=>12, "ru_RU"=>10, "id_ID"=>9, "el_GR"=>8, "ar_AR"=>8, "th_TH"=>8, "tr_TR"=>8, "bg_BG"=>7, "lv_LV"=>6, "zh_CN"=>6, "cs_CZ"=>5, "ro_RO"=>4, "pt_PT"=>4, "en_PI"=>4, "he_IL"=>3, "sk_SK"=>3, "hu_HU"=>3, "mk_MK"=>3, "nl_NL"=>2, "sv_SE"=>2, "zh_HK"=>2, "lt_LT"=>2, "nl_BE"=>2, "fb_LT"=>1, "en_IN"=>1, "sl_SI"=>1, "sq_AL"=>1, "ko_KR"=>1, "da_DK"=>1, "ka_GE"=>1, "cy_GB"=>1, "mr_IN"=>1, "sr_RS"=>1, "nb_NO"=>1} 
```

有人知道如何将其转换为纯文本吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:14:32.367

`/config/locales/en.yml`在您的 rails 应用程序中将语言环境数据设置 为

```
en:
  en_GB: "Great Britain"
  en_US: 'United States'
  ..so on.. 
```

然后

```
fb_response = {"en_GB"=>6836, "en_US"=>3414, "it_IT"=>120, "es_LA"=>37, "fr_FR"=>24, "zh_TW"=>18, "pt_BR"=>18, "de_DE"=>16, "hr_HR"=>15, "pl_PL"=>12, "es_ES"=>12, "ru_RU"=>10, "id_ID"=>9, "el_GR"=>8, "ar_AR"=>8, "th_TH"=>8, "tr_TR"=>8, "bg_BG"=>7, "lv_LV"=>6, "zh_CN"=>6, "cs_CZ"=>5, "ro_RO"=>4, "pt_PT"=>4, "en_PI"=>4, "he_IL"=>3, "sk_SK"=>3, "hu_HU"=>3, "mk_MK"=>3, "nl_NL"=>2, "sv_SE"=>2, "zh_HK"=>2, "lt_LT"=>2, "nl_BE"=>2, "fb_LT"=>1, "en_IN"=>1, "sl_SI"=>1, "sq_AL"=>1, "ko_KR"=>1, "da_DK"=>1, "ka_GE"=>1, "cy_GB"=>1, "mr_IN"=>1, "sr_RS"=>1, "nb_NO"=>1}

fb_response = Hash[fb_response.map {|k, v| [t(k.to_sym), v] }] 
```

`map`返回一个新数组，每个元素运行一次块的结果，Hash[] 使用返回的数组中的每个 [k, v] 对创建一个新哈希。在该块中，我们将键转换为符号并将其传递给`#translate`别名 as `t`，这会将其转换为当前语言环境。

# excel - 检查vba模块中的范围是否为空

> ID：14790662
> 
> 赞同：2
> 
> 时间：2013-02-09T19:28:14.930
> 
> 标签：excel, vba

我想检查用户模块中一段代码中的excel范围是否为空。我使用了下面的代码

```
Worksheets(yearsheet).Range("N" & rownum & ":DI").Select
If Application.WorksheetFunction.CountA(Selection) = 0 Then
    Exit Sub
End If 
```

我收到运行时错误 1004。谁能告诉我的错误是什么？

提前致谢。PS：rownum 是整数变量，yearsheet 是字符串变量。在上述代码部分之前，这两个变量都已在代码中正确更新

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:57:51.693

`"N" & rownum & ":DI"`不会评估为真实地址，因为它缺少地址后半部分的行号。此外，您应该尽可能避免使用 Select 语句。

假设整个范围都在一行中，这将起作用：

```
Sub test()
Dim yearsheet As String
Dim rownum As Integer

yearsheet = "Sheet2"
rownum = 2
If Application.WorksheetFunction.CountA(Worksheets(yearsheet) _
        .Range("N" & rownum & ":DI" & rownum)) = 0 Then
    Exit Sub
End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-21T07:13:31.670

在 VBA 中测试选择是否为空的最佳方法：

```
' 测试是否存在选定的单元格。
' @return 真或假
函数 isCellSelection() 作为布尔值
    Dim r As 范围
    isCellSelection = 假
    设置 r = Selection.Cells
    如果 IsEmpty(r) 则
        isCellSelection = 真
    万一
结束函数'isCellSelection

```

# upgrade - 可动式 4 与 5

> ID：14790670
> 
> 赞同：2
> 
> 时间：2013-02-09T19:29:53.957
> 
> 标签：upgrade, movabletype

我有一个运行 MT 4.38 的 Movable Type 站点，我想知道是否应该升级到 5。

有一段时间，MT 4 和 5 好像是同时开发的，现在只看到 MT 5 有活动。MT 4 是不是被放弃了？

使用该网站的人厌恶改变，所以我只想在绝对必要的情况下升级（即安全问题）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T07:21:32.910

是的，MT4 不再开发。它仍然每隔几个月就会收到安全补丁，但不会有新版本。

至于你想用什么，MT4 和 MT5 有一套不同的插件。因此，如果您想升级，请检查您需要的插件是否支持 MT5 或更换 MT5。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-11T04:52:36.840

是的。Movable Type 4.38 有[一个安全漏洞补丁](http://www.movabletype.org/2013/01/movable_type_438_patch.html)，你应该确保应用它。但除此之外，您绝对应该升级到 Movable Type 5.2.3。

最大的原因是 Movable Type 4.38 将在 2013 年 12 月 31 日结束生命周期。这意味着在该日期之后 Movable Type 4.38 将不再有安全更新。

[Movable Type 5](http://movabletype.com/)有许多比 MT 4.38 有了巨大改进的新功能：

*   基于 TinyMCE 的新的和改进的富文本编辑器
*   CMS 中最常用对象的修订历史记录
*   列表管理框架增强了 Movable Type 在 CMS 内管理大量数据的能力
*   可排序的类别和文件夹
*   mt:EntryPrimaryCategory 之类的模板标签
*   增强的多博客支持
*   对基于 Webkit 的浏览器（Safari 和 Google Chrome）以及 IE 8 和 9 的巨大支持改进
*   登录失败检测，允许帐户或 IP 地址锁定

恕我直言，任何人都不应该运行安全补丁不再支持的 Movable Type 版本。认为任何人都可以知道旧版本的内容管理系统（例如 Movable Type）中所有可能的安全问题是愚蠢的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:20:25.363

如果您不使用 3rd 方插件，升级将毫无问题。

如果您使用 3rd 方插件，您可能会遇到兼容性问题，因为 v5.x 架构与 4.x 有很大不同。

在考虑升级到 v5.x 之前，您可能需要检查您的 3rd 方插件，看看是否有适用于 v5.x 的版本。

要考虑的另一件事是克隆您的安装并尝试在不同的域/文件夹或舞台服务器上升级它，您可以在升级实时安装之前检查一切是否正常。

或者，您可以从以下网址订购专业的活字升级服务： [http ://www.movabletypeupgrade.com/](http://www.movabletypeupgrade.com/)

# iphone - 核心数据不获取对象

> ID：14790674
> 
> 赞同：0
> 
> 时间：2013-02-09T19:30:19.357
> 
> 标签：iphone, ios, core-data

您好，这是我的 NSFetchedResultsController 实现：

```
-(NSFetchedResultsController *)fetchedResultsController
{
    if (_fetchedResultsController != nil) {
        return _fetchedResultsController;
    }
    NSLog(@"context - %@",self.context);
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription
                                   entityForName:@"Categories" inManagedObjectContext:self.context];
    [fetchRequest setEntity:entity];

    NSSortDescriptor *sort = [[NSSortDescriptor alloc]
                              initWithKey:@"name" ascending:YES];
    [fetchRequest setSortDescriptors:@[sort]];

    [fetchRequest setFetchBatchSize:20];

    NSFetchedResultsController *theFetchedResultsController =
    [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest
                                        managedObjectContext:self.context sectionNameKeyPath:nil
                                                   cacheName:@"root"];
    _fetchedResultsController = theFetchedResultsController;
    _fetchedResultsController.delegate = self;
//    [[self context] fetchObjectsForEntityName:@"Categories" withPredicate:
//     nil] ;
    return _fetchedResultsController;
} 
```

fetchedResultsController.fetchedObjects 始终为零。这是我添加对象的方式：

```
-(void)addCategoryWithName:(NSString *)name
{
    NSLog(@"context - %@",self.context);
    Categories *category = (Categories *)[NSEntityDescription insertNewObjectForEntityForName:@"Categories" inManagedObjectContext:self.context];
    category.name = name;
    NSLog(@"category name - %@",category.name);
    category.displayOrder = [NSNumber numberWithFloat:1.0f];
    //        site.displayOrder = displayOrder;

    NSError __block *error;
    if (![self.context save:&error]){
        NSLog(@"Error saving - %@", [error localizedDescription]);
    }
} 
```

没有错误，什么都没有。如果我在 Documents 目录中看到我的 .sqlite 文件，它已被修改，但我无法获取任何对象。真的很奇怪，我对我的其他应用程序使用基本相同的代码，它工作得很好。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:05:15.707

您必须调用`performFetch`一次获取的结果控制器。否则它不会获取任何东西，也不会跟踪更改。例如添加

```
NSError *error;
if (![_fetchedResultsController performFetch:&error]) {
    // error handling
} 
```

在`fetchedResultsController`getter 方法的末尾。

~~*备注：*似乎指定一个`cacheName`without`sectionNameKeyPath`可能会导致问题，请参阅[UITableView with NSFetchedResultsController Does Not Load the Second Time](https://stackoverflow.com/questions/14677076/uitableview-with-nsfetchedresultscontroller-does-not-load-the-second-time)。由于缓存用于缓存部分信息，因此如果您没有部分，则无论如何都不需要它。~~

*更新：*前面的评论不再有效，原来链接问题中的问题有不同的原因。

# ruby-on-rails - rails_admin 通过关联在 has_many 上崩溃

> ID：14790677
> 
> 赞同：1
> 
> 时间：2013-02-09T19:30:34.513
> 
> 标签：ruby-on-rails, ruby, rails-activerecord, rails-admin

**编辑**当注释掉有很多通过（或任何与此相关的）时， 我不再可以让它*不崩溃。*我将报告更多细节，但到目前为止，无论如何它都会在访问 /admin/user 时崩溃

**原帖：**

通过 rails admin 访问用户信息时出现分段错误。我已经把它缩小到处理一个有很多的关系。我很确定我通过关联正确设置了我的 has_many。但是，在使用 rails_admin 访问用户信息时，整个 ruby​​ 解释器会崩溃。关于我做错了什么有什么建议吗？rails_admin 中实际上存在错误吗？我正在使用 rails_admin 0.4.4 和 rails 3.2.11。

这是我的联想：

```
class User < ActiveRecord::Base
  has_many :survey_users
  has_many :surveys, :through=>:survey_users
end

class Survey < ActiveRecord::Base
  has_many :survey_users  
  has_many :users, :through=>:survey_users
end

class SurveyUser < ActiveRecord::Base
  belongs_to :user
  belongs_to :survey
end

1.9.3p362 :031 > SurveyUser
 => SurveyUser(id: integer, user_id: integer, survey_id: integer, created_at: datetime, updated_at: datetime) 
```

如果你愿意，我可以发布更多的错误信息。这是开始，然后它继续回溯，等等等等 开始 GET "/assets/rails_admin/rails_admin.js?body=1" for 127.0.0.1 at 2013-02-09 14:13:15 -0500

```
Served asset /rails_admin/rails_admin.js - 304 Not Modified (22ms)
/Users/new/.rvm/gems/ruby-1.9.3-p362@myproject/gems/activerecord-3.2.11/lib/active_record/relation.rb:241: 
[BUG] Segmentation fault
ruby 1.9.3p362 (2012-12-25 revision 38607) [x86_64-darwin12.2.0] 
```

# haskell - “隐式配置”论文的代码

> ID：14790680
> 
> 赞同：3
> 
> 时间：2013-02-09T19:30:55.410
> 
> 标签：haskell, ghci

我正在尝试在以下位置运行此代码`ghci`：

[http://www.cs.rutgers.edu/~ccshan/prepose/Prepose.hs](http://www.cs.rutgers.edu/~ccshan/prepose/Prepose.hs)

这是与论文“Functional Pearl: Implicit Configurations”相关的代码

[http://www.cs.rutgers.edu/~ccshan/prepose/prepose.pdf](http://www.cs.rutgers.edu/~ccshan/prepose/prepose.pdf)

我确定我缺少一些`LANGUAGE`编译指示...我收到以下错误：

```
Prepose.hs:39:1: Parse error in pattern: normalize 
```

另外，是否有与本文相关的黑客包？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T20:24:14.277

您不能将类型签名应用于函数定义模式。这是语法正确的写法：

```
normalize :: (Modular s a, Integral a) => a -> M s a
normalize a = M (mod a (modulus (__ :: s))) :: M s a 
```

但是，这行不通。您真正想要的是在函数的类型签名中引用类型变量*s 。*这可以通过使用 ScopedTypeVariables 扩展来完成，这需要显式量化：

```
normalize :: forall a s. (Modular s a, Integral a) => a -> M s a
normalize x = M (Mod x (modulus (__ :: s))) 
```

作为改进代码的建议，我建议使用*标记*库：

```
import Data.Proxy

modulus :: (Modular s a) => Proxy s -> a 
```

这使您可以在没有丑陋的占位符底部的情况下相处。另一种写法是：

```
modulus :: (Modular s a) => Tagged s a 
```

这也给你一个很好的概念上的好处：你现在有两种类型，`Mod`用于模块化值和`Tagged`它们的模数。你也可以自己定义类型，给它一个更好的名字：

```
newtype Mod     s a = Mod     { residue :: a } 
newtype Modulus s a = Modulus { modulus :: a } 
```

抛开这一切不谈，如果你想实际使用它，我推荐 ocharles 所说的：使用[反射](http://hackage.haskell.org/package/reflection)库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T19:45:31.920

我无法解决代码问题，但 Edward Kmett 的[“反射”](http://hackage.haskell.org/package/reflection)库是基于那篇论文的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T20:38:13.397

这完成了使用该`reflection`库的论文中的示例。我将这个示例基于[`Monoid`](https://github.com/ekmett/reflection/blob/master/examples/Monoid.hs)库源中的示例。

```
data M a s = M a -- Note the phantom comes *after* the concrete

-- In `normalize` we're tying the knot to get the phantom types to align
-- note that reflect :: Reifies s a => forall proxy. proxy s -> a

normalize :: (Reifies s a, Integral a) => a -> M a s
normalize a = b where b = M (mod a (reflect b)) 

instance (Reifies s a, Integral a) => Num (M a s) where
  M a + M b = normalize (a + b)
  ...

withModulus :: Integral a => a -> (forall s. Reifies s a => M a s) -> a
withModulus m ma = reify m (runM . asProxyOf ma)
  where asProxyOf :: f s -> Proxy s -> f s
        asProxyOf a _ = a 
```

# git - Git 树对象的内部格式是什么？

> ID：14790681
> 
> 赞同：44
> 
> 时间：2013-02-09T19:30:55.507
> 
> 标签：git, git-ls-tree

Git 树对象的内容格式是什么？

blob 对象的内容是`blob [size of string] NUL [string]`，但树对象的内容是什么？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2014-02-06T09:48:37.710

树对象的格式：

```
tree [content size]\0[Entries having references to other trees and blobs] 
```

每个条目的格式都引用了其他树和 blob：

```
[mode] [file/folder name]\0[SHA-1 of referencing blob or tree] 
```

我写了一个脚本给树对象放气。它输出如下：

```
tree 192\0
40000 octopus-admin\0 a84943494657751ce187be401d6bf59ef7a2583c
40000 octopus-deployment\0 14f589a30cf4bd0ce2d7103aa7186abe0167427f
40000 octopus-product\0 ec559319a263bc7b476e5f01dd2578f255d734fd
100644 pom.xml\0 97e5b6b292d248869780d7b0c65834bfb645e32a
40000 src\0 6e63db37acba41266493ba8fb68c76f83f1bc9dd 
```

数字 1 作为模式的第一个字符表示对 blob/文件的引用。上面的例子，pom.xml 是一个 blob，其他的是树。

请注意，`\0`为了漂亮的打印，我在后面添加了新的行和空格。通常所有内容都没有新行。我还将 20 个字节（即引用 blob 和树的 SHA-1）转换为十六进制字符串以更好地可视化。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2016-05-08T21:41:20.737

我尝试通过测试回购详细说明@lemiorhan 的答案。

### 创建一个测试仓库

在空文件夹中创建一个测试项目：

```
$ echo ciao > file1            
$ mkdir folder1                 
$ echo hello > folder1/file2     
$ echo hola > folder1/file3 
```

那是：

```
$ find -type f          
./file1                   
./folder1/file2           
./folder1/file3 
```

创建本地 Git 存储库：

```
$ git init 
$ git add . 
$ git write-tree 
0b6e66b04bc1448ca594f143a91ec458667f420e 
```

最后一个命令返回顶层树的哈希值。

### 读取树内容

要以人类可读的格式打印树的内容，请使用：

```
$ git ls-tree 0b6e66
100644 blob 887ae9333d92a1d72400c210546e28baa1050e44    file1  
040000 tree ab39965d17996be2116fe508faaf9269e903c85b    folder1 
```

在这种情况下`0b6e66`，是顶层树的前六个字符。您可以对`folder1`.

要获得相同的内容但采用原始格式，请使用：

```
$ git cat-file tree 0b6e66
100644 file1 ▒z▒3=▒▒▒$ ▒►Tn(▒▒♣D40000 folder1 ▒9▒]▒k▒◄o▒▒▒i▒♥▒[% 
```

内容类似于以压缩格式物理存储为文件的内容，但它缺少初始字符串：

```
tree [content size]\0 
```

要获取实际内容，我们需要解压缩存储`c1f4bf`树对象的文件。我们想要的文件是——给定 2/38 路径格式——：

```
.git/objects/0b/6e66b04bc1448ca594f143a91ec458667f420e 
```

该文件是用 zlib 压缩的，因此我们通过以下方式获取其内容：

```
$ openssl zlib -d -in .git/objects/0b/6e66b04bc1448ca594f143a91ec458667f420e
tree 67 100644 file1 ▒z▒3=▒▒▒$ ▒►Tn(▒▒♣D40000 folder1 ▒9▒]▒k▒◄o▒▒▒i▒♥▒[% 
```

我们知道树的内容大小是 67。

请注意，由于终端不是为打印二进制文件而设计的，它可能会吃掉字符串的某些部分或显示其他奇怪的行为。在这种情况下，将上面的命令与`| od -c`下一节中的手动解决方案一起使用或使用。

### 手动生成树对象内容

为了理解树的生成过程，我们可以从它的人类可读内容开始自己生成它，例如顶部树：

```
$ git ls-tree 0b6e66
100644 blob 887ae9333d92a1d72400c210546e28baa1050e44    file1  
040000 tree ab39965d17996be2116fe508faaf9269e903c85b    folder1 
```

每个对象的 ASCII SHA-1 哈希都以二进制格式转换和存储。如果您需要的只是 ASCII 哈希的二进制版本，您可以这样做：

```
$ echo -e "$(echo ASCIIHASH | sed -e 's/../\\x&/g')" 
```

所以 blob`887ae9333d92a1d72400c210546e28baa1050e44`被转换为

```
$ echo -e "$(echo 887ae9333d92a1d72400c210546e28baa1050e44 | sed -e 's/../\\x&/g')"
▒z▒3=▒▒▒$ ▒►Tn(▒▒♣D 
```

如果我们想创建整个树对象，这里有一个 awk 单行：

```
$ git ls-tree 0b6e66 | awk -b 'function bsha(asha)\
{patsplit(asha, x, /../); h=""; for(j in x) h=h sprintf("%c", strtonum("0x" x[j])); return(h)}\
{t=t sprintf("%d %s\0%s", $1, $4, bsha($3))} END {printf("tree %s\0%s", length(t), t)}'
tree 67 100644 file1 ▒z▒3=▒▒▒$ ▒►Tn(▒▒♣D40000 folder1 ▒9▒]▒k▒◄o▒▒▒i▒♥▒[% 
```

该函数`bsha`将 SHA-1 ASCII 哈希转换为二进制文件。首先将树的内容放入变量中`t`，然后计算其长度并将其打印在`END{...}`节中。

如上所述，控制台不太适合打印二进制文件，因此我们可能希望将它们替换为`\x##`等效格式：

```
$ git ls-tree 0b6e66 | awk -b 'function bsha(asha)\
{patsplit(asha, x, /../); h=""; for(j in x) h=h sprintf("%s", "\\x" x[j]); return(h)}\
{t=t sprintf("%d %s\0%s", $1, $4, bsha($3))} END {printf("tree %s\0%s", length(t), t)}'
tree 187 100644 file1 \x88\x7a\xe9\x33\x3d\x92\xa1\xd7\x24\x00\xc2\x10\x54\x6e\x28\xba\xa1\x05\x0e\x4440000 folder1 \xab\x39\x96\x5d\x17\x99\x6b\xe2\x11\x6f\xe5\x08\xfa\xaf\x92\x69\xe9\x03\xc8\x5b% 
```

输出应该是理解树内容结构的一个很好的折衷方案。将上面的输出与一般的树内容结构进行比较

```
tree [content size]\0[Object Entries] 
```

每个对象条目就像：

```
[mode] [Object name]\0[SHA-1 in binary format] 
```

模式是 UNIX 文件系统模式的子集。有关更多详细信息，请参阅Git 手册上的[树对象。](https://git-scm.com/book/en/v2/Git-Internals-Git-Objects)

我们需要确保结果是一致的。为此，我们可能会将 awk 生成树的校验和与 Git 存储树的校验和进行比较。

至于后者：

```
$ openssl zlib -d -in .git/objects/0b/6e66b04bc1448ca594f143a91ec458667f420e | shasum
0b6e66b04bc1448ca594f143a91ec458667f420e *- 
```

至于自制树：

```
$ git ls-tree 0b6e66 | awk -b 'function bsha(asha)\
{patsplit(asha, x, /../); h=""; for(j in x) h=h sprintf("%c", strtonum("0x" x[j])); return(h)}\
{t=t sprintf("%d %s\0%s", $1, $4, bsha($3))} END {printf("tree %s\0%s", length(t), t)}' | shasum
0b6e66b04bc1448ca594f143a91ec458667f420e *- 
```

校验和是一样的。

### 计算树对象校验和

或多或少的官方获取方式是：

```
$ git ls-tree 0b6e66 | git mktree
0b6e66b04bc1448ca594f143a91ec458667f420e 
```

要手动计算它，我们需要将脚本生成的树的内容通过管道传输到`shasum`命令中。实际上我们已经在上面做了这个（比较生成和存储的内容）。结果是：

```
0b6e66b04bc1448ca594f143a91ec458667f420e *- 
```

和 相同 `git mktree`。

### 打包对象

您可能会发现，对于您的存储库，您无法找到 `.git/objects/XX/XXX...`存储 Git 对象的文件。发生这种情况是因为一些或所有“松散”对象已被打包到一个或多个`.git\objects\pack\*.pack`文件中。

要解压 repo，首先将包文件从其原始位置移开，然后 git-unpack 对象。

```
$ mkdir .git/pcache   
$ mv .git/objects/pack/*.pack .git/pcache/     
$ git unpack-objects < .git/pcache/*.pack 
```

完成实验后重新打包：

```
$ git gc 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2016-03-09T21:03:16.950

表示为类似 BNF 的模式，git 树包含以下形式的数据

```
(?<tree>  tree (?&SP) (?&decimal) \0 (?&entry)+ )
(?<entry> (?&octal) (?&SP) (?&strnull) (?&sha1bytes) )

(?<strnull>   [^\0]+ \0)
(?<sha1bytes> (?s: .{20}))
(?<decimal>   [0-9]+)
(?<octal>     [0-7]+)
(?<SP>        \x20) 
```

也就是说，一个 git 树的开头是

1.  文字串`tree`
2.  SPACE（*即*字节`0x20`）
3.  未压缩内容的 ASCII 编码十进制长度

在 NUL（*即*字节`0x00`）终止符之后，树包含一个或多个形式的条目

1.  ASCII 编码的八进制模式
2.  空间
3.  姓名
4.  零
5.  SHA1 哈希编码为 20 个无符号字节

然后 Git 将树数据提供给[zlib 的](http://www.zlib.net/)deflate 以进行紧凑存储。

请记住，git blob 是匿名的。Git 树将名称与可能是 blob、其他树等的其他内容的 SHA1 哈希相关联。

为了演示，请考虑与 git 的 v2.7.2 标签关联的树，您可能希望[在 GitHub 上浏览它](https://github.com/git/git/tree/326e5bc91eecf73234ead29636207bc516573e79)。

```
$ git rev-parse v2.7.2^{tree}
802b6758c0c27ae910f40e1b4862cb72a71eee9f 
```

下面的代码要求树对象为“松散”格式。我不知道从包文件中提取单个原始对象的方法，所以我首先[`git unpack-objects`](https://www.kernel.org/pub/software/scm/git/docs/git-unpack-objects.html)将包文件从我的克隆文件运行到一个新的存储库。请注意，这会将一个`.git`从大约 90 MB 开始的目录扩展为大约 1.8 GB。

**更新：**感谢 max630 展示[了如何解压单个对象](https://stackoverflow.com/a/35909341/123109)。

```
#! /usr/bin/env perl

use strict;
use warnings;

use subs qw/ git_tree_contents_pattern read_raw_tree_object /;

use Compress::Zlib;

my $treeobj = read_raw_tree_object;

my $git_tree_contents = git_tree_contents_pattern;
die "$0: invalid tree" unless $treeobj =~ /^$git_tree_contents\z/;

die "$0: unexpected header" unless $treeobj =~ s/^(tree [0-9]+)\0//;
print $1, "\n";

# e.g., 100644 SP .gitattributes \0 sha1-bytes
while ($treeobj) {
  # /s is important so . matches any byte!
  if ($treeobj =~ s/^([0-7]+) (.+?)\0(.{20})//s) {
    my($mode,$name,$bytes) = (oct($1),$2,$3);
    printf "%06o %s %s\t%s\n",
      $mode, ($mode == 040000 ? "tree" : "blob"),
      unpack("H*", $bytes), $name;
  }
  else {
    die "$0: unexpected tree entry";
  }
}

sub git_tree_contents_pattern {
  qr/
  (?(DEFINE)
    (?<tree>  tree (?&SP) (?&decimal) \0 (?&entry)+ )
    (?<entry> (?&octal) (?&SP) (?&strnull) (?&sha1bytes) )

    (?<strnull>   [^\0]+ \0)
    (?<sha1bytes> (?s: .{20}))
    (?<decimal>   [0-9]+)
    (?<octal>     [0-7]+)
    (?<SP>        \x20)
  )

  (?&tree)
  /x;
}

sub read_raw_tree_object {
  # $ git rev-parse v2.7.2^{tree}
  # 802b6758c0c27ae910f40e1b4862cb72a71eee9f
  #
  # NOTE: extracted using git unpack-objects
  my $tree = ".git/objects/80/2b6758c0c27ae910f40e1b4862cb72a71eee9f";

  open my $fh, "<", $tree or die "$0: open $tree: $!";
  binmode $fh or die "$0: binmode: $!";
  local $/;
  my $treeobj = uncompress <$fh>;
  die "$0: uncompress failed" unless defined $treeobj;

  $treeobj
} 
```

观看我们可怜的人的`git ls-tree`行动。`tree`除了输出标记和长度外，输出是相同的。

```
$ diff -u <(cd ~/src/git; git ls-tree 802b6758c0) <(../rawtree)
--- /dev/fd/63 2016-03-09 14:41:37.011791393 -0600
+++ /dev/fd/62 2016-03-09 14:41:37.011791393 -0600
@@ -1,3 +1,4 @@
+树 15530
 100644 斑点 5e98806c6cc246acef5f539ae191710a0c06ad3f .gitattributes
 100644 斑点 1c2f8321386f89ef8c03d11159c97a0f194c4423 .gitignore
 100644 blob e5b4126bec557db55924b7b60ed70349626ea2c4 .mailmap
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-10T01:48:14.970

正如建议的那样，Pro Git 很好地解释了结构。要显示漂亮打印的树，请使用：

```
git cat-file -p 4c975c5f5945564eae86d1e933192c4a9096bfe5 
```

要以原始但未压缩的形式显示同一棵树，请使用：

```
git cat-file tree 4c975c5f5945564eae86d1e933192c4a9096bfe5 
```

结构本质上是相同的，散列存储为二进制和以空结尾的文件名。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-10-09T13:07:59.267

@lemiorhan 的答案是正确的，但错过了重要的小细节。树格式为：

```
[mode] [file/folder name]\0[SHA-1 of referencing blob or tree] 
```

但重要的是它`[SHA-1 of referencing blob or tree]`是二进制形式，而不是十六进制。这是将树对象解析为条目的 Python 片段：

```
entries = [
   line[0:2]+(line[2].encode('hex'),)
   for line in
   re.findall('(\d+) (.*?)\0(.{20})', body, re.MULTILINE)
] 
```

# google-chrome-extension - 使用 Chrome 后台扩展休眠后 Firebase 重新连接

> ID：14790690
> 
> 赞同：2
> 
> 时间：2013-02-09T19:31:38.960
> 
> 标签：google-chrome-extension, firebase

我正在用 firebase 编写一个 Chrome 背景扩展。我注意到的是，当我在 Chrome 打开时休眠我的计算机（Win7）时，与 firebase 的连接断开（正如预期的那样）。但是，当我从休眠状态返回时，它不会自动重新连接，并且我的 .on() 事件不再触发。

我已经查看了 API 文档和有关检测断开连接的 StackOverflow 问题：[Detect if Firebase connection is lost/regained](https://stackoverflow.com/questions/11351689/detect-if-firebase-connection-is-lost-regained/11351873#11351873)

这是我用来测试连接的一些伪代码：

```
var myFirebase = new Firebase('https://my.firebaseio.com/'); //replace
setInterval(function() {
  myFirebase.child('.info/connected').on('value', function (snap) {
    if (snap.val() === true) {
      console.log('Connected: ' + (new Date()).toString());
    }
    else {
      console.log('Disconnected: ' + (new Date()).toString());
    }
  });
}, 5000); 
```

这在通过网页运行 javascript 时按预期工作 - 它连接，然后在我休眠时断开连接，然后在从休眠状态恢复后很快重新连接。

但是，当它作为 google 扩展程序的一部分作为背景页面运行时，它会断开连接并且永远不会重新连接。

有没有办法强制重新连接和/或无法按预期工作的原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:24:37.033

您的权限看起来像这样吗？

```
"content_security_policy": "script-src 'self' https://static.firebase.com https://myfirebase.firebaseio.com https://s-ord-nss-1.firebaseio.com https://s-ord-nss-2.firebaseio.com; object-src 'self'" 
```

您是否在日志中收到任何权限错误？

（只是一种预感——不知道这是否与连接逻辑有关，但我过去曾遇到过权限问题。）

# exception-handling - 用于作业执行的工作流工具

> ID：14790691
> 
> 赞同：0
> 
> 时间：2013-02-09T19:31:41.237
> 
> 标签：exception-handling, workflow, monitoring, business-process-management, alerts

我有许多 ETL 作业，我需要以特定的逻辑以特定的顺序执行。什么是最适合的工作流/BPM/编排工具？我有以下一般要求：

1.  监控：了解作业的状态
2.  异常处理：如果作业失败，则会发送警报或采取某种措施。
3.  警报：根据特定条件发送电子邮件警报
4.  批准：有时我的同事需要在执行工作之前批准它。

我的作业是用 python 和 Java 编写的，但它们可以作为可执行文件运行。

我正在考虑使用 ProcessMaker、MuleSoft 等工具。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T12:19:31.277

看看 BonitaSoft。它提供 BPMN 异常处理，一种基于 REST api 并用 Java 编写的开放（源代码）结构。

# c# - 使用 ServiceStack 对 HTTPRequest 标头进行单元测试

> ID：14790695
> 
> 赞同：7
> 
> 时间：2013-02-09T19:32:04.010
> 
> 标签：c#, servicestack

我有这个服务：

```
public class PlayerService : Service
{
    public IPlayerAppService PlayerAppService { get; set; }

    public PlayerService (IPlayerAppService service)
    {
        if (service == null)
            throw new ArgumentException ("Service null");

        PlayerAppService = service;
    }

    public object Post (PlayerDTO request)
    {
        var newPlayer = new PlayerResponse ()
        {
            Player = PlayerAppService.SendPlayerLocation(request.Position.Latitude, request.Position.Longitude)
        };

        return new HttpResult (newPlayer)
        {
            StatusCode = System.Net.HttpStatusCode.Created,
            Headers =
            {
                { HttpHeaders.Location, base.Request.AbsoluteUri.CombineWith(newPlayer.Player.Id.ToString()) }
            }
        };
    }
} 
```

我已经手动验证了位置和响应在我部署此服务时看起来是正确的。我想弄清楚如何对此进行单元测试。我写了一个这样的测试：

```
[TestFixture]
public class PlayerServiceTests
{
    AppHost appHost;

    [TestFixtureSetUp]
    public void TestFixtureSetUp ()
    {
        appHost = new AppHost ();
        appHost.Init ();
        appHost.Start ("http://localhost:1337/");
    }

    [TestFixtureTearDown]
    public void TestFixtureTearDown ()
    {
        appHost.Dispose ();
        appHost = null;
    }

    [Test]
    public void NewPlayer_Should_Return201AndLocation ()
    {
        // Arrange
        PlayerService service = new PlayerService (appHost.TryResolve<IPlayerAppService>());

        // Act
        HttpResult response = (HttpResult)service.Post (It.IsAny<PlayerDTO>());

        // Assert
        Assert.NotNull (response);
        Assert.AreEqual(HttpStatusCode.Created, response.StatusCode);
        Assert.AreEqual(response.Response.ToDto<PlayerResponse>().Player.Id.ToString(), response.Headers.Where(x=> x.Key == HttpHeaders.Location).SingleOrDefault().Value);
    }
} 
```

我的单元测试运行时的 base.Request 。你对我如何从我的单元测试中填充这个有什么建议吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-09T21:12:54.230

您正在使用自托管 HttpListener ，就像在集成测试中一样，但您没有在集成测试中使用。

集成[测试](https://docs.servicestack.net/testing)如下所示：

```
[Test]
public void NewPlayer_Should_Return201AndLocation ()
{
    var client = new JsonServiceClient("http://localhost:1337/") {
        ResponseFilter = httpRes => {
            //Test response headers...
        };
    }

    PlayerResponse response = client.Post(new Player { ... });
} 
```

否则，如果您想进行单元测试，则不需要 AppHost 并且可以`PlayerService`像任何其他 C# 类一样测试该类，注入所有依赖项和它需要的模拟请求上下文。

```
[Test]
public void NewPlayer_Should_Return201AndLocation ()
{
    var mockCtx = new Mock<IRequestContext>();
    mockCtx.SetupGet (f => f.AbsoluteUri).Returns("localhost:1337/player");

    PlayerService service = new PlayerService {
        MyOtherDependencies = new Mock<IMyOtherDeps>().Object,
        RequestContext = mockCtx.Object,
    };

    HttpResult response = (HttpResult)service.Post(new Player { ... });

    //Assert stuff..
} 
```

# javascript - 附加到分离的导航问题

> ID：14790698
> 
> 赞同：0
> 
> 时间：2013-02-09T19:32:46.520
> 
> 标签：javascript, animation, navigation, scroll

我目前正在构建我的个人作品集，在 javascript 方面没有很多实用知识，但是在阅读了很多教程之后，我决定尝试实现我在其他地方看到的东西：可拆卸导航。

使用这个网站[http://code.stephenmorley.org/javascript/detachable-navigation/](http://code.stephenmorley.org/javascript/detachable-navigation/)作为参考，我着手创建我的分离导航；但是，出现了可怕的错误。

一方面，标题将自动向左对齐，而不是返回到其默认位置。

其次，虽然你还看不到它的实现，但我希望社交图标在使用动画滚动过去后显示在导航中。那段代码太复杂了，我把它废弃了。

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:34:45.367

为什么不直接使用 Bootstrap？它已经内置了：http: [//twitter.github.com/bootstrap/components.html#navbar](http://twitter.github.com/bootstrap/components.html#navbar)

1.  下载引导程序：http: [//twitter.github.com/bootstrap/assets/bootstrap.zip](http://twitter.github.com/bootstrap/assets/bootstrap.zip)

2.  将 bootsrap Javascript 和 CSS 添加到您的页面。

3.  在您的 HTML 中，添加以下 DIV：

您可以更改 div 以满足您的需求。

```
<div class="navbar navbar-fixed-top">
    <li class="active">
        <a href="#">Home</a>
    </li>
    <li><a href="#">Link</a></li>
    <li><a href="#">Link</a></li>
</div> 
```

# c# - Windows Phone 隔离存储设置和互斥锁

> ID：14790701
> 
> 赞同：4
> 
> 时间：2013-02-09T19:33:18.063
> 
> 标签：c#, windows-phone-7, windows-phone-8, mutex, windows-phone

我正在为 Windows Phone 开发一个应用程序。此应用程序使用后台代理（计划任务）。

主应用程序在[IsolatedStorageSettings.ApplicationSettings](http://msdn.microsoft.com/en-us/library/windowsphone/develop/system.io.isolatedstorage.isolatedstoragesettings.applicationsettings%28v=vs.105%29.aspx)的帮助下存储了一些设置。后台代理有时只能从设置中读取值。

问题是我应该使用[Mutex](http://msdn.microsoft.com/en-US/library/windowsphone/develop/system.threading.mutex%28v=vs.105%29.aspx)在主应用程序和后台代理之间同步[隔离存储设置上的操作吗？](http://msdn.microsoft.com/en-us/library/windowsphone/develop/system.io.isolatedstorage.isolatedstoragesettings%28v=vs.105%29.aspx)或者这在我的场景中不需要？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T03:31:46.943

是的。 [更多的...](http://msdn.microsoft.com/en-us/library/hh202944%28v=VS.92%29.aspx)

> 对于定期和资源密集型代理：使用 LINQ 2 SQL 或使用互斥锁保护的隔离存储中的文件。对于前台应用程序写入而代理仅读取的单向通信，我们建议使用带有 Mutex 的隔离存储文件。我们建议您不要使用 IsolatedStorageSettings 在进程之间进行通信，因为数据可能会损坏。

简单的方法来做到这一点：

[在 WP7 Silverlight 中保存游戏的简单方法？](https://stackoverflow.com/questions/14381836/easy-way-to-save-game-in-wp7-silverlight/14382853#14382853)

# javascript - d3.js 使用极坐标绘制元素

> ID：14790702
> 
> 赞同：5
> 
> 时间：2013-02-09T19:33:42.233
> 
> 标签：javascript, d3.js

我是 d3.js 的新手，不确定要使用哪个 d3 功能。

我需要将一组元素同心地放在一个原点（在一个圆圈中）。

```
svg.selectAll('circle').each(function() {
    d3.select(this)
        .attr('cx', r * Math.cos(theta))
        .attr('cy', r * Math.sin(theta));
    theta += thetaInc;
}); 
```

因此，不要像上面的代码那样做一些乏味的事情，做这件事的 d3 短方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-09T22:22:16.993

执行此操作的 d3 方法是传入数据并根据数据的索引计算位置，即类似于

```
var theta = 2 * Math.PI / array.length;
svg.selectAll('circle').data(array).enter()
  .append("circle")
  .attr('cx', function(d, i) { return(r * Math.cos(i * theta)); })
  .attr('cy', function(d, i) { return(r * Math.sin(i * theta)); }); 
```

# php - PHP 回显变量和 html 一起

> ID：14790703
> 
> 赞同：10
> 
> 时间：2013-02-09T19:33:54.223
> 
> 标签：php

我知道这是一个基本的 php 问题，但我无法在 HTML 的回声中显示变量。以下是我想要实现的目标。

```
<?php
    $variable = 'testing';
    echo <span class="label-[variable]">[variable]</span>
?> 
```

应该输出：

```
<span class="label-testing">testing</span> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-09T19:35:49.053

```
<?php
    $variable = 'testing';
    echo <span class="label-[variable]">[variable]</span>
?> 
```

应该

```
<?php
    $variable = 'testing';
    echo '<span class="label-' . $variable .'">' . $variable . '</span>';
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T19:35:16.117

如果您的 HTML 包含双引号，那么您可以将其用单引号括起来：

```
echo '<span class="label-' . $variable . '">' . $variable . '</span>'; 
```

此外，您可以通过转义双引号来内联：

```
echo "<span class=\"label-$variable\">$variable</span>"; 
```

使用双引号还允许使用特殊字符，例如`\n`和`\t`。

[文档](http://php.net/manual/en/language.types.string.php)是你的朋友。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-10T08:23:52.847

我知道这是一个老问题，但是这样的事情有什么问题？

```
<?php
    $variable = 'testing';
?>
<span class="label-<? echo variable ?>"><? echo variable ?></span> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-10T20:07:16.390

php 的一大特点是能够在 html 期间随时使用 php 调用和退出。这是我要做的：

```
<?php
   // FIRST WRITE THE PHP PART 
   $variable = 'testing'; 
   // THEN START USE HTML 
   // (call it when it's needed later)
?>
<span class="label-testing"><?php echo $variable; ?></span> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-09T20:36:27.953

像这样的东西应该工作。

```
<?PHP
    $variable = 'testing';
    echo "<span class=\"label-$variable\">$variable</span>";
?> 
```

但是，回声上的引号类型非常重要。如果您宁愿在回声上使用单引号，它会更像这样。

```
<?PHP
    $variable = 'testing';
    echo '<span class="label-' . $variable . '">' . $variable . '</span>';
?> 
```

这应该允许您回显变量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-10T08:31:11.233

```
<?php
$variable = 'testing';
echo '<span class="label-'.$variable.'">'.$variable.'</span>';
?> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-09T19:36:51.590

如果您说这`$variable`是要打印的变量的名称，则需要：

```
echo "<span class=\"label-$variable\">${$variable}</span>"; 
```

该`${$variable}`语法告诉 PHP 打印名为 $variable 的变量。PHP 调用这些[变量变量](http://php.net/manual/en/language.variables.variable.php)。

例如：

```
$itemName = 'pencil';
$variable = 'itemName';
echo "<span class=\"label-$variable\">${$variable}</span>";
//Prints: <span class="label-itemName">pencil</span>" 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-09T19:37:01.003

太基本的问题在这里问...

```
<?php
    $variable = 'testing';
    echo '<span class="label-[' . $variable . ']">[' . $variable . ']</span>;
?> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-02T14:22:08.140

这也有效，而且更甜：

```
<?php
    $variable = 'testing';
    echo "<span class='label-$variable'>$variable</span>";
?> 
```

双引号和单引号的顺序很重要，双引号在外面。如果你使用这种语法要小心，如果变量名后面跟着普通字符，事情可能会出错。然后需要在变量名周围使用花括号。

例子：

```
<?php 
    $max_image_with = 1000;
    echo "<div style='width:${max_image_width}px;'>";
?> 
```

此处的文档：http: [//php.net/manual/en/language.types.string.php#language.types.string.parsing](http://php.net/manual/en/language.types.string.php#language.types.string.parsing)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-10-24T09:17:39.447

PHP代码...它正在工作

```
<?php 
$st_a = '<i class="fa fa-check-circle" ></i> Active'; 
?> 
```

以 HTML 格式显示

```
<h1> Sample Heading <?php echo $st_a; ?></h1> 
```

# python - Python 3 中的 Unicode 字符串是否仍然依赖于“窄”/“宽”构建？

> ID：14790708
> 
> 赞同：8
> 
> 时间：2013-02-09T19:34:32.600
> 
> 标签：python, unicode, python-3.x

从 Python 2.2 和[PEP 261](http://www.python.org/dev/peps/pep-0261/)开始，Python 可以以“窄”或“宽”模式构建，这会影响“字符”的定义，即“Python Unicode 字符串的可寻址单元”。

窄版本中的字符看起来像 UTF-16 代码单元：

```
>>> a = u'\N{MAHJONG TILE GREEN DRAGON}'
>>> a
u'\U0001f005'
>>> len(a)
2
>>> a[0], a[1]
(u'\ud83c', u'\udc05')
>>> [hex(ord(c)) for c in a.encode('utf-16be')]
['0xd8', '0x3c', '0xdc', '0x5'] 
```

*（上面似乎不同意[一些](http://www.cmlenz.net/archives/2008/07/the-truth-about-unicode-in-python) 坚持窄版本使用 UCS-2，而不是 UTF-16 的[消息来源。确实很有趣）](https://stackoverflow.com/questions/1838170/what-is-internal-representation-of-string-in-python-3-x)*

Python 3.0 是否保持这种区别？还是所有 Python 3 构建都广泛？

（我听说[PEP 393](http://www.python.org/dev/peps/pep-0393/)在 3.3 中改变了字符串的内部表示，但这与 3.0 ~ 3.2 无关。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-09T20:02:51.430

是的，从 3.0 到 3.2 他们确实如此。Windows 使用窄构建，而（大多数）Unix 使用宽构建

在 Windows 上使用 Python 3.2：

```
>>> a = '\N{MAHJONG TILE GREEN DRAGON}'
>>> len(a)
2
>>> a
'' 
```

虽然在使用 Windows 的 3.3+ 上预期会出现这种行为：

```
>>> a = '\N{MAHJONG TILE GREEN DRAGON}'
>>> len(a)
1
>>> a
'\U0001f005'
>>> print(a)
Traceback (most recent call last):
  File "<pyshell#3>", line 1, in <module>
    print(a)
UnicodeEncodeError: 'UCS-2' codec can't encode character '\U0001f005' 
in position 0: Non-BMP character not supported in Tk 
```

Tk 上使用了 UCS-2 编解码器（我正在使用 IDLE - 终端可能会显示另一个错误）。

# html - 调整窗口大小时将移动的 div 的定位

> ID：14790709
> 
> 赞同：0
> 
> 时间：2013-02-09T19:34:38.193
> 
> 标签：html, css

我有一个随窗口调整大小的背景图像。我希望我的背景图片上的文字代表链接。我的想法是创建空且透明的 div 并将它们放置在背景图像中的单词上，当单击该 div 时，将激活相应的链接。

我无法定位我的 div。调整窗口大小时，我似乎无法让它们与背景图像中的单词保持一致。

HTML：

```
<div id="wrapper">

    <div id="bespoke">
        I want this to always be aligned with "Bespoke" in the background image
    </div>

</div> 
```

CSS：

```
html { 
    background: url(main.png) no-repeat center center fixed; 
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
    position: fixed;
}

#wrapper {
    position: relative;
    top: auto;
    margin: auto;
    text-align: center;
    height: auto;
}

#bespoke {

} 
```

演示：

[http://jsfiddle.net/DzC3V/1/](http://jsfiddle.net/DzC3V/1/)

注意：如果 jQuery 是实现这一点的最佳方式，我不介意使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:52:36.663

我认为最好的方法是使用媒体查询，它有点拖累，但它会起作用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:46:00.113

在我看来，你不需要 jquery。CSS 和百分比定位应该可以解决问题。尝试以下

```
#yourObeject {
     position: absolute;
     top: 30%;
     left: 30%;
} 
```

正确定位您的 div 很棘手。但它应该工作

如果这不符合您的需求，您应该真正尝试做一个图像 Map 并使用 jquery 调整它的大小

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:27:30.087

您可以将图像设置在 div 中，您可以使用 z-index:1 将空 div 放在其顶部，因此您可以更好地控制两者

# c# - 使用泛型的最佳方式

> ID：14790716
> 
> 赞同：0
> 
> 时间：2013-02-09T19:34:56.303
> 
> 标签：c#, generics, asp.net-web-api

所以我是泛型的新手。但是泛型似乎是减少代码的好方法。这是场景。我有一个 MVC Web API。

```
http://www.google.com/{controller}/{chartType}/{id} 
```

**注意**：id 是可选的

我有几种返回相似对象的图表类型：

1.  每小时设备图表
2.  每小时用户图表
3.  HourlyAvgProcessingTime 等。

我只想有一种方法来评估图表类型参数并执行相应的操作。而不是 8 或 10 种方法。

如果我的设计需要重构，我会接受。我愿意接受建议。这里的想法是减少一些代码。我不想在 Web API 中公开 10 个方法，然后在另一个类中再公开 10 个相应的方法。只是显得多余。

一如既往地欢迎您的建议！

API公开的方法：

```
IEnumerable<T> GetChart(string chartType)
{
    switch(chartType)
    {
        case "DeviceChart":
        return repository.HourlyDeviceChart();
        break;

        case "UserChart":
         return repository.HourlyUsersChart();
         break;

    }
}

//Then the class that handles all the work would look something like the below

IEnumerable<HourlyDeviceChart> HourlyDeviceChart()
{
    // select appropriate items from the queue
    // populate HourlyDeviceChart object
    // add object to list
    // return HourlyDeviceChart list
}

IEnumerable<UserDeviceChart> HourlyUsersChart()
{
    // do more of the same
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:51:52.553

您可以像这样使用泛型：

```
interface IChart {
    bool IsCharItemNeeded(IChartItem item);
    void AddChartItem(IChartItem item);
}

IEnumerable<T> Charts<T>() where T : new, IChart {
    var res = List<T>();
    foreach (QueueCommand command in MyBigQueue) {
        var chart = new T();
        foreach (IChartItem item in command) {
            if (chart.IsCharItemNeeded(item)) {
                chart.AddChartItem(item);
            }
        }
        res.Add(chart);
    }
    return res;
} 
```

所有图表类型都需要实现通用`IChart`接口。该`where T : new, IChart`行提供了一个约束，允许您调用`new T()`; 为此，所有图表类还必须实现无参数构造函数。

现在您可以像这样使用您的通用代码：

```
IEnumerable<UserChart> userCharts = Charts<UserChart>();
IEnumerable<DeviceChart> deviceCharts = Charts<DeviceChart>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:50:58.940

您应该能够通过使用新接口并对您的方法应用约束来做到这一点`GetChart`

```
//Interface with a Type parameter to specify the return type of the method
public interface IChart<T>
{
    IEnumerable<T> HourlyChart();
}

//How to implement the interface
public class HourlyDeviceChart : IChart<HourlyDeviceChart>
{
    public static IEnumerable<HourlyDeviceChart> HourlyChart()
    {
        //Do work
    }
}

//Your new method with a constraint applied
IEnumerable<T> GetChart<T>(string chartType) where T : IChart<T>
{
    return T.HourlyChart();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-17T07:03:17.167

如果`HourlyUserChart`和`HourlyDeviceChart`方法都以相同的方式工作，那么 dasblinkenlight 的答案很好，您可以使用一种通用的方式来填充它们。如果您需要在两个存储库方法中以不同方式填充它们，可能会执行以下操作：

1)

```
interface IHourlyChart {
    IEnumerable<IHourlyChart> Create();
}

class HourlyDeviceChart : IHourlyChart 
{
    public IEnumerable<IHourlyChart> Create()
    {
        return repository.HourlyDeviceChart();
    }
}

class HourlyUsersChart : IHourlyChart 
{
    public IEnumerable<IHourlyChart> Create()
    {
        return repository.HourlyUsersChart();
    }
}

IEnumerable<T> GetChart<T>() where T : IHourlyChart, new()
{
    return (IEnumerable<T>)new T().Create();
} 
```

* * *

2）或者通过泛型使其类型更强大。

```
interface IHourlyChart<T> where T : IHourlyChart<T> {
    IEnumerable<T> Create();
}

class HourlyDeviceChart : IHourlyChart<HourlyDeviceChart>
{
    public IEnumerable<HourlyDeviceChart> Create()
    {
        return repository.HourlyDeviceChart();
    }
}

class HourlyUsersChart : IHourlyChart<HourlyUsersChart>
{
    public IEnumerable<HourlyUsersChart> Create()
    {
        return repository.HourlyUsersChart();
    }
}

IEnumerable<T> GetChart<T>() where T : IHourlyChart, new()
{
    return new T().Create();
} 
```

* * *

3）或一些反射，这仍然比你的类型检查更好：

```
IEnumerable<T> GetChart<T>() where T : IHourlyChart, new()
{
    //find necessary method and invoke. may be:
    return repository.GetType()
                     .GetMethods()
                     .Single(x => x.ReturnType == typeof(IEnumerable<T>))
                     .Invoke(repository, new object[0]) as IEnumerable<T>;
} 
```

* * *

4）最坏的情况，在你的泛型方法中进行类型检查，但检查类型本身，而不是任何非常脆弱的魔术字符串。

```
IEnumerable<T> GetChart<T>()
{
    if (typeof(T) == typeof(HourlyDeviceChart))
        return (IEnumerable<T>)repository.HourlyDeviceChart();
    else if (typeof(T) == typeof(HourlyUsersChart))
        return (IEnumerable<T>)repository.HourlyUsersChart();

    // throw;
} 
```

* * *

像这样称呼他们：

```
var chartables = GetChart<HourlyUserChart>(); //etc 
```

# sharepoint - 共享点。外部内容类型。将值传递给存储过程

> ID：14790721
> 
> 赞同：1
> 
> 时间：2013-02-09T19:35:20.393
> 
> 标签：sharepoint, stored-procedures, sharepoint-2010, bdc

我有简单的存储过程，它需要**几个**参数和**更新**表。

如何通过 BDC 传递参数？

例如，要执行存储过程，它选择行并接受一个参数，代码如下。

```
 BdcService bdcservice = SPFarm.Local.Services.GetValue<BdcService>();
        IMetadataCatalog catalog = bdcservice.GetDatabaseBackedMetadataCatalog(SPServiceContext.Current);
        //  entity.GetLobSystem().GetLobSystemInstances()[0].Value;
        IEntity entity = catalog.GetEntity(Utils.EntityNamespace, "GetMessage");
        ILobSystemInstance lobSystemInstance = entity.GetLobSystem().GetLobSystemInstances()[0].Value;

        IFilterCollection filters = entity.GetDefaultFinderFilters();
        ComparisonFilter filter = (ComparisonFilter)filters[0];
        filter.Value = code;
        IEntityInstanceEnumerator enumerator = entity.FindFiltered(filters, lobSystemInstance);
        DataTable result = entity.Catalog.Helper.CreateDataTable(enumerator); 
```

DataTable 结果包含选定的行。

但是如何将几个参数传递给更新过程？

```
 BdcService bdcservice = SPFarm.Local.Services.GetValue<BdcService>();
        IMetadataCatalog catalog = bdcservice.GetDatabaseBackedMetadataCatalog(SPServiceContext.Current);
        //  entity.GetLobSystem().GetLobSystemInstances()[0].Value;
        IEntity entity = catalog.GetEntity(Utils.EntityNamespace, "ContractAdd");
        ILobSystemInstance lobSystemInstance = entity.GetLobSystem().GetLobSystemInstances()[0].Value;

       // entity.ExecuteScalar(); 
```

实体有方法“ExecuteScalar”，但是如何通过这个方法传递参数？

# android - 如何在完成特定方法之前强制我的视图更新其状态？

> ID：14790723
> 
> 赞同：0
> 
> 时间：2013-02-09T19:35:30.527
> 
> 标签：android

我有 RealViewSwitcher 控件，我正在使用一些代码在 OnScreenSwitchListener 中更新我的 UI，如下所示

```
public void onScreenSwitched(int screen) {
//1 update some text view for example 

//2 heavy process 

} 
```

在繁重的过程完成之前，我的 UI 更新不会出现，我怎样才能立即更新我的文本视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:49:25.423

> 如何即时更新我的​​文本视图？

你不能，就其本身而言。

但是，最有可能的是，您的“繁重进程”应该在后台线程中完成，例如`AsyncTask`. 这将使您的 UI 更新得到更快的处理。

如果您的“繁重过程”本身就是 UI 更新，则您需要安排将“繁重过程”推迟到当前方法返回并且 Android 可以处理您的第一组 UI 更新之后的某个时间。执行此操作的一种方法是将“繁重的过程”工作放入`Runnable`您计划执行的 a 中，使用`post()`on`Handler`或 any上可用的方法`View`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:06:05.097

```
private class YouClass extends AsyncTask<Type1, Type2, Type3> {
 protected Long doInBackground(Type1... obj1) {
     //operations to do in background
 }

 protected void onProgressUpdate(Type2... obj2) {
     //operations during the process progress
 }

 protected void onPostExecute(Type3 obj3) {
     //the operations after the completion of your task
 }
} 
```

有关 AsyncTask<> goto 的更多参考

[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

# php - mysqli 不显示数据库中的图像

> ID：14790724
> 
> 赞同：0
> 
> 时间：2013-02-09T19:35:32.073
> 
> 标签：php, database, image, mysqli

我将所有内容都更改为 mysqli，因为我只是在努力学习它。我究竟做错了什么？我的图像出现损坏并打印文件名，我知道这是一个简单的问题，但我尝试在互联网上搜索但没有结果。对不起我在学习

```
<?php 
include_once("db_conex.php");

$query = "SELECT * FROM employees ORDER BY price ASC";
$query = mysqli_real_escape_string($db,$query);

if($result = mysqli_query($db,$query)){
    while($row = mysqli_fetch_object($result)){
        echo "<br /><br />";
        echo '<img src="/upload/ " border=0>', $row->photo;
        echo "<br /><br />";
        echo '<b> City: </b>', $row->city;
        echo '<b> Price: </b>', $row->price;
        echo '<b> Bath: </b>', $row->bath;           
        echo '<b> Bath: </b>', $row->bed;
        echo '<b> Description: </b>', $row->description;
        echo '<b> Link: </b>', $row->link; 
    }

    mysqli_free_result($result);
}
//Close Connection
mysqli_close($db);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T19:37:58.560

你的问题在这里：

```
echo '<img src="/upload/ " border=0>', $row->photo; 
```

您实际上只是在打印一个空的（可能不存在的）图像，然后是文件名。你可能的意思是：

```
echo '<img src="/upload/' . $row->photo . '" border=0>'; 
```

# objective-c - Key Equivalent NSTextfield 类似 Interface Builder

> ID：14790725
> 
> 赞同：1
> 
> 时间：2013-02-09T19:35:43.277
> 
> 标签：objective-c, cocoa

在过去的两天里，我一直在搜索和阅读很多关于应该非常简单的东西。很明显情况并非如此：我正在尝试这样做：

![IB中的关键等效字段](../Images/bd2b4ef8a64e36eab7c92acb2296325c.png)

就这样。我知道快捷记录器已经很老了，我一直在使用 MASShortcut 的演示。MASShortcut 非常棒，但是对于看似简单的事情却有很多代码。

我还搜索了很多 Apple 示例代码（希望他们会在 Interface Builder 以外的地方实现它，但到目前为止还没有运气）。

这给我留下了以下问题：

- 是否有任何文件可以澄清其中的一些内容？或者还有其他比 MASShortcut 更简单的解决方案吗？

- 我一直在尝试自己复制 IB 控件之类的东西，但我仍然坚持将按下的键“转换”为 NSTextField 中的字符（或者它是 IB 中的自定义 NSView？）。Apple 是否提供了一种简单的方法来做到这一点？因为使用 sendEvent 捕获所有内容并将其与所有键的列表进行比较似乎需要做很多工作，我想知道苹果程序员是如何在上面看到的控件中做到这一点的。如果这是唯一的解决方案，我在使用它时是否应该关注不同的键盘布局？

- 其他应用程序如何实现这一点，使其在此处可见： ![系统偏好设置 > 键盘](../Images/5ad2ea3a731b12c96d2bfd214bab737a.png)

如您所见，TextWranglers 出现在这里，当我在我的应用程序中调用“[NSEvent addGlobalMonitorForEventsMatchingMask:]”时会自动发生这种情况吗？

这些问题很多，我只是希望你们中的一个人能指出我正确的方向。

提前致谢， 弗兰斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T19:55:12.727

上周我自己在摆弄从按键中获取字符，我偶然发现了两个由于某种原因我以前从未见过的函数：[`UCKeyTranslate()`](http://developer.apple.com/library/mac/documentation/Carbon/Reference/Unicode_Utilities_Ref/Reference/reference.html#//apple_ref/doc/uid/TP30000122-CH1g-F10792)在 CoreServices 中和在 ApplicationServices 中明显相关的[`CGEventKeyboardGetUnicodeString()`](http://developer.apple.com/library/mac/documentation/Carbon/Reference/QuartzEventServicesRef/Reference/reference.html#//apple_ref/doc/uid/TP40003550-CH202-DontLinkElementID_9)（看起来像前者的包装器）。

似乎这些是 Apple 自己的文本系统用来将按键转换为 Unicode 字符串以显示为文本的功能——或者至少是代码。

`NSEvent`对's的简单检查`modifierFlags`就足以将修饰键状态转换为像 ⌥⇧⌘ 这样的字符串：

```
NSUInteger flags = [theEvent modifierFlags];
NSString * modString = [NSString stringWithFormat:@"%@%@%@%@",
                                (flags & NSControlKeyMask) ? @"^" : @"",
                                (flags & NSAlternateKeyMask) ? @"⌥" : @"",
                                (flags & NSShiftKeyMask) ? @"⇧" : @"",
                                (flags & NSCommandKeyMask) ? @"⌘" : @""]; 
```

您可能还想查看 Allan Odgaard 的博客文章[“解密 NSEvent”](http://sigpipe.macromates.com/2005/09/24/deciphering-an-nsevent/)，了解他为决定按下哪些键而开发的启发式算法。

# sidekiq - 一旦在终端中启动，如何分离sidekiq进程

> ID：14790727
> 
> 赞同：9
> 
> 时间：2013-02-09T19:35:57.270
> 
> 标签：sidekiq

我想在我的生产服务器上运行 sidekiq，我正在使用这个命令来启动这个过程

```
bundle exec sidekiq -q mailer,5 -q default -e production 
```

如何在不停止进程的情况下脱离进程，以便关闭与服务器的连接。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-28T13:25:43.437

正确答案是小写**-d**：

```
bundle exec sidekiq -d -q mailer,5 -q default -e production 
```

`sidekiq --help`将列出选项：

```
-d, --daemon                     Daemonize process 
```

运行 -d 选项时，sidekiq 会询问日志文件，所以完整的命令是：

```
bundle exec sidekiq -d -L sidekiq.log -q mailer,5 -q default -e production 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T17:12:43.260

您可以通过执行将其分离

bundle exec sidekiq **-D** -q mailer,5 -q default -e production

或者，您可以只使用 God gem 来运行您的 Sidekiq 作业。

# javascript - 将数据添加到 Select

> ID：14790729
> 
> 赞同：0
> 
> 时间：2013-02-09T19:36:06.307
> 
> 标签：javascript, jquery, html

我有这个选择；选择国家并添加到一个新的选择多个国家，限制为 5 个国家，但如果我进行多项选择，我只想通过选择的国家或更多国家添加 1 个国家。我的错误是在我的函数 addC() 中，当我想在我的选择中添加多个国家时，它会在 1 个选项标签中添加多个国家，如下所示：

```
<option>South KoreaUSAJapan</option> 
```

如果我进行多项选择，我可以修改什么以显示以下方式？：

```
<option>South Korea</option>
<option>USA</option>
<option>Japan</option> 
```

我的代码：http: [//jsbin.com/osesem/4/edit](http://jsbin.com/osesem/4/edit)

```
function addC() {
    if ($("#agregarProvincia option").length < 5) {
        var newC = ($("#countries option:selected").text());
        $("#addCountry").append("<option>" + newC + "</option>");
    }
} 
```

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<label for="provincia2"><b>¿Country?</b></label><br>
<span>
    <select multiple="multiple" size="5" id="countries">
        <option value="1">South Korea</option>
        <option value="2">USA</option>
        <option value="2">Japan</option>
        <option value="3">Italy</option>
        <option value="4">Spain</option>
        <option value="5">Mexico</option>
        <option value="6">England</option>
        <option value="7">Phillipins</option>
        <option value="8">Portugal</option>
        <option value="9">France</option>
        <option value="10">Germany</option>
        <option value="11">Hong Kong</option>
        <option value="12">New Zeland</option>
        <option value="13">Ireland</option>
        <option value="14">Panama</option>
        <option value="15">Norwey</option>
        <option value="16">Sweeden</option>
        <option value="17">India</option>
        <option value="18">Morroco</option>
        <option value="19">Russia</option>
        <option value="20">China</option>
    </select>
</span>
<div class="addremover">
    <input class="add" type="button" onclick="addC()" value="Addd »" />
    <br/>
</div>
<span>
    <select id="addCountry" multiple="multiple" size="5">
    </select>
</span> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:46:39.593

使用`each`函数遍历文本并附加它..试试这个

```
function addC() {
    if ($("#agregarProvincia option").length < 5) {
        var newC = ($("#countries option:selected"));
      newC.each(function(){
        $("#addCountry").append("<option>" + $(this).text() + "</option>");
      })
    }
} 
```

[JSbin](http://jsbin.com/inicox/1/edit)在这里

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T19:56:56.110

或者只是克隆选定`<option>`的

```
function addC() {
  if ($('#countries option:selected').size() < 5)
  {
    $('#addCountry').append($('#countries option:selected').clone());
  }
  else
  {
    alert('you can only select 5');
  }
} 
```

# jquery - 带有 HTML 和 jQuery 的动态表格

> ID：14790730
> 
> 赞同：0
> 
> 时间：2013-02-09T19:36:13.393
> 
> 标签：jquery, html, jquery-ui

我需要编写一个 Javascript UI 网页来预约美发沙龙。它将有一个动态表格，其中一个水平轴上的沙龙开放时间和垂直轴上的造型师。该页面还将有一个包含所有造型师姓名的复选框列表。当用户选择/取消选择造型师时，表中的相应列应显示/隐藏。用于填充表的数据将来自一个 json 对象。此外，当约会持续超过 2 小时或更长时间时，应该加入代表它的单元格。

我不是专业的开发人员，所以我可以使用一些帮助。有我可以使用的 UI 库吗？如何有效地操作表格？

谢谢，安娜

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T19:40:18.190

已经有很多插件可用于更改表格，但都需要进行总和设置，并且各有利弊。

一个简单的谷歌搜索“Jquery table”会返回很多，但你提到需要导入 json，所以需要转换。

最好的选择是 Jtable，它将提供您开始所需的一切。 [http://www.jtable.org/](http://www.jtable.org/)

他们有一个很棒的实时动作演示：[http ://www.jtable.org/RealTime](http://www.jtable.org/RealTime)

# java - Java：如何将 Json 格式的字符串分配给 Java 字符串？

> ID：14790733
> 
> 赞同：2
> 
> 时间：2013-02-09T19:36:52.840
> 
> 标签：java, json

我有一个大的 json 字符串，我将作为 UI 的请求获得，它将被转换为 String 并解析。

我想模拟类似的环境进行本地测试，所以为此我捕获了 JSon 格式。

目前我正在手动将“/”添加到这个大的 json 字符串中。

有没有其他方法可以实现这一目标？

例如我得到了这个 json

```
{"age":29,"messages":["msg 1","msg 2","msg 3"],"name":"Preethi"} 
```

并将其转换为

```
 String str = "{\"age\":\"29\",\"messages\":[\"msg 1\",\"msg 2\",\"msg 3\"],\"name\":\"mkyong\"}"; 
```

有没有其他方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:07:53.547

在客户端，在实际发送请求之前，在所需的表单字段上进行搜索和正则表达式“将所有”双引号“替换为单引号”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:23:30.647

实际上，Java 没有[逐字字符串文字](http://msdn.microsoft.com/en-us/library/aa691090.aspx)。

*但是*，如果您想要一种类似 Java（和基于 Java-VM）的语言，您可能需要查看具有[各种形式的字符串文字的](http://groovy.codehaus.org/Strings+and+GString)[Groovy](http://groovy.codehaus.org)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-06T04:21:52.487

我们在构建方法中将 jsonObject 转换为字符串。你为什么不用那个。

```
 JSONObject json = new JSONObject();
 json.toString(); 
```

# ruby - Windows 8 x64 上的 ffi 问题

> ID：14790734
> 
> 赞同：0
> 
> 时间：2013-02-09T19:36:59.700
> 
> 标签：ruby, windows-8, gem, 64-bit

首先尝试使用berkshelf gem，但它说

```
bundle exec berks coolbook test_cookbook
    D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/win32/api.rb:20:
    in `require': cannot load such file -- ffi (LoadError)
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/win
    32/api.rb:20:in `<top (required)>'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/win
    32/api/security.rb:19:in `require'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/win
    32/api/security.rb:19:in `<top (required)>'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/win
    32/security.rb:19:in `require'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/win
    32/security.rb:19:in `<top (required)>'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/fil
    e_access_control/windows.rb:20:in `require'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/fil
    e_access_control/windows.rb:20:in `<top (required)>'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/fil
    e_access_control.rb:30:in `require'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/fil
    e_access_control.rb:30:in `<class:FileAccessControl>'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/fil
    e_access_control.rb:27:in `<class:Chef>'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/fil
    e_access_control.rb:22:in `<top (required)>'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/mix
    in/enforce_ownership_and_permissions.rb:19:in `require'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/mix
    in/enforce_ownership_and_permissions.rb:19:in `<top (required)>'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/pro
    vider.rb:23:in `require'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/pro
    vider.rb:23:in `<top (required)>'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/pla
    tform.rb:26:in `require'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/chef-10.16.2/lib/chef/pla
    tform.rb:26:in `<top (required)>'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/berkshelf-1.1.6/lib/berks
    helf.rb:2:in `require'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/berkshelf-1.1.6/lib/berks
    helf.rb:2:in `<top (required)>'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/berkshelf-1.1.6/bin/berks
    :3:in `require'
            from D:/dev/vagrant/vagrant/embedded/gems/gems/berkshelf-1.1.6/bin/berks
    :3:in `<top (required)>'
            from D:/dev/vagrant/vagrant/embedded/gems/bin/berks:23:in `load'
            from D:/dev/vagrant/vagrant/embedded/gems/bin/berks:23:in `<main>' 
```

然后尝试使用不同版本重新安装 ffi gem

```
gem uninstall ffi
gem install ffi -v 1.0.9

gem uninstall ffi
gem install ffi 
```

它安装得很好，但是在安装文档时出现了问题

```
1 gem installed
Installing ri documentation for ffi-1.3.1-x86-mingw32...
Enclosing class/module 'moduleFFI' for class AbstractMemory not known
Enclosing class/module 'moduleFFI' for class NullPointerError not known
Enclosing class/module "classMemory" for alias put_" #name, "put_" #old); \
    rb_define_alias(classMemory, "get_" #name, "get_" #old); \
    rb_define_alias(classMemory, "put_u" #name, "put_u" #old); \
    rb_define_alias(classMemory, "get_u" #name, "get_u" #old); \
    rb_define_alias(classMemory, "write_" #name, "write_" #old); \
    rb_define_alias(classMemory, "read_" #name, "read_" #old); \
    rb_define_alias(classMemory, "write_u" #name, "write_u" #old); \
    rb_define_alias(classMemory, "read_u" #name, "read_u" #old); \
    rb_define_alias(classMemory, "put_array_of_" #name, "put_array_of_" #old); \

    rb_define_alias(classMemory, "get_array_of_" #name, "get_array_of_" #old); \

    rb_define_alias(classMemory, "put_array_of_u" #name, "put_array_of_u" #old);
 \
    rb_define_alias(classMemory, "get_array_of_u" #name, "get_array_of_u" #old);
 \
    rb_define_alias(classMemory, "write_array_of_" #name, "write_array_of_" #old
); \
    rb_define_alias(classMemory, "read_array_of_" #name, "read_array_of_" #old);
 \
    rb_define_alias(classMemory, "write_array_of_u" #name, "write_array_of_u" #o
ld); \
    rb_define_alias(classMemory, "read_array_of_u" #name, "read_array_of_u" #old
);

    ALIAS(char, int8);
    ALIAS(short, int16);
    ALIAS(int, int32);
    ALIAS(long_long, int64);

    /*
     * Document-method: put_float32
     * call-seq: memory.put_float32offset, value)
     * @param [Numeric] offset
     * @param [Numeric] value
     * @return [self]
     * Put +value+ as a 32-bit float in memory at offset +offset+ (alias: #put_f
loat).
     */
    rb_define_method(classMemory, "put_float32", memory_put_float32, 2);
    /*
     * Document-method: get_float32
     * call-seq: memory.get_float32(offset)
     * @param [Numeric] offset
     * @return [Float]
     * Get a 32-bit float from memory at offset +offset+ (alias: #get_float).
     */
    rb_define_method(classMemory, "get_float32", memory_get_float32, 1);
    rb_define_alias(classMemory, "put_float put_float32 not known
Enclosing class/module "classMemory" for alias get_float get_float32 not known
Enclosing class/module "classMemory" for alias put_array_of_float put_array_of_f
loat32 not known
Enclosing class/module "classMemory" for alias get_array_of_float get_array_of_f
loat32 not known
Enclosing class/module "classMemory" for alias put_double put_float64 not known
Enclosing class/module "classMemory" for alias get_double get_float64 not known
Enclosing class/module "classMemory" for alias put_array_of_double put_array_of_
float64 not known
Enclosing class/module "classMemory" for alias get_array_of_double get_array_of_
float64 not known
Enclosing class/module "classMemory" for alias size total not known
Enclosing class/module 'moduleFFI' for class ArrayType not known
Enclosing class/module 'moduleFFI' for class Buffer not known
Enclosing class/module "BufferClass" for alias length total not known
Enclosing class/module 'moduleFFI' for module DataConverter not known
Enclosing class/module 'moduleFFI' for class DynamicLibrary not known
Enclosing class/module 'LibraryClass' for class Symbol not known
Enclosing class/module 'rbffi_TypeClass' for class Mapped not known
Enclosing class/module 'rbffi_StructLayoutClass' for class CharArray not known
Enclosing class/module "rbffi_StructLayoutCharArrayClass" for alias to_str to_s
not known
Installing RDoc documentation for ffi-1.3.1-x86-mingw32...
Enclosing class/module 'moduleFFI' for class AbstractMemory not known
Enclosing class/module 'moduleFFI' for class NullPointerError not known
Enclosing class/module "classMemory" for alias put_" #name, "put_" #old); \
    rb_define_alias(classMemory, "get_" #name, "get_" #old); \
    rb_define_alias(classMemory, "put_u" #name, "put_u" #old); \
    rb_define_alias(classMemory, "get_u" #name, "get_u" #old); \
    rb_define_alias(classMemory, "write_" #name, "write_" #old); \
    rb_define_alias(classMemory, "read_" #name, "read_" #old); \
    rb_define_alias(classMemory, "write_u" #name, "write_u" #old); \
    rb_define_alias(classMemory, "read_u" #name, "read_u" #old); \
    rb_define_alias(classMemory, "put_array_of_" #name, "put_array_of_" #old); \

    rb_define_alias(classMemory, "get_array_of_" #name, "get_array_of_" #old); \

    rb_define_alias(classMemory, "put_array_of_u" #name, "put_array_of_u" #old);
 \
    rb_define_alias(classMemory, "get_array_of_u" #name, "get_array_of_u" #old);
 \
    rb_define_alias(classMemory, "write_array_of_" #name, "write_array_of_" #old
); \
    rb_define_alias(classMemory, "read_array_of_" #name, "read_array_of_" #old);
 \
    rb_define_alias(classMemory, "write_array_of_u" #name, "write_array_of_u" #o
ld); \
    rb_define_alias(classMemory, "read_array_of_u" #name, "read_array_of_u" #old
);

    ALIAS(char, int8);
    ALIAS(short, int16);
    ALIAS(int, int32);
    ALIAS(long_long, int64);

    /*
     * Document-method: put_float32
     * call-seq: memory.put_float32offset, value)
     * @param [Numeric] offset
     * @param [Numeric] value
     * @return [self]
     * Put +value+ as a 32-bit float in memory at offset +offset+ (alias: #put_f
loat).
     */
    rb_define_method(classMemory, "put_float32", memory_put_float32, 2);
    /*
     * Document-method: get_float32
     * call-seq: memory.get_float32(offset)
     * @param [Numeric] offset
     * @return [Float]
     * Get a 32-bit float from memory at offset +offset+ (alias: #get_float).
     */
    rb_define_method(classMemory, "get_float32", memory_get_float32, 1);
    rb_define_alias(classMemory, "put_float put_float32 not known
Enclosing class/module "classMemory" for alias get_float get_float32 not known
Enclosing class/module "classMemory" for alias put_array_of_float put_array_of_f
loat32 not known
Enclosing class/module "classMemory" for alias get_array_of_float get_array_of_f
loat32 not known
Enclosing class/module "classMemory" for alias put_double put_float64 not known
Enclosing class/module "classMemory" for alias get_double get_float64 not known
Enclosing class/module "classMemory" for alias put_array_of_double put_array_of_
float64 not known
Enclosing class/module "classMemory" for alias get_array_of_double get_array_of_
float64 not known
Enclosing class/module "classMemory" for alias size total not known
Enclosing class/module 'moduleFFI' for class ArrayType not known
Enclosing class/module 'moduleFFI' for class Buffer not known
Enclosing class/module "BufferClass" for alias length total not known
Enclosing class/module 'moduleFFI' for module DataConverter not known
Enclosing class/module 'moduleFFI' for class DynamicLibrary not known
Enclosing class/module 'LibraryClass' for class Symbol not known
Enclosing class/module 'rbffi_TypeClass' for class Mapped not known
Enclosing class/module 'rbffi_StructLayoutClass' for class CharArray not known
Enclosing class/module "rbffi_StructLayoutCharArrayClass" for alias to_str to_s
not known

gem uninstall ffi
gem install ffi 
```

但是没有 ffi 安装解决了 berkshelf 的主要问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-11T08:44:48.587

我在 64 位 Linux 下安装另一个 gem 时遇到了类似的问题。编译 gem 时，我会得到关于 ffi gem 的完全相同的错误。我的解决方法是安装 libffi-dev 包并且它有效。这个包有一个用于 Windows/MingW 版本的 X86-64，所以我建议确保你已经安装了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-06T05:42:48.627

对于 ruby​​ 版本 1.9.3 ruby​​ 1.9.3p551 和 64 位 linux，我也有类似的问题。第一步是安装 libffi-dev，如答案 1。

```
gem uninstall ffi
gem install ffi 
```

仍然有同样的问题。只有在添加了 rdoc gem 的安装之后：

```
gem install rdoc
gem uninstall ffi
gem install ffi 
```

工作没有错误。

# android - 通知类未加载

> ID：14790736
> 
> 赞同：0
> 
> 时间：2013-02-09T19:37:11.403
> 
> 标签：android

我刚刚开始在android上进行实验。我正在阅读 Wrox pulication 的《开始 Android 4 应用程序开发》一书。有一个显示通知的代码。问题是我编写的代码（未复制）几乎没有修改。因此，我可以在状态/通知栏上显示通知，但是单击通知时不会调用通知类。这是 android_mainfest 的代码。

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="legacy_systems.notificationproject"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="7"
    android:targetSdkVersion="9" />
<uses-permission android:name="android.permission.VIBRATE"/>

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="legacy_systems.notificationproject.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity 
        android:name="Notification"
        android:label="Details of the Notification" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.DEFAULT" />                    
        </intent-filter>
    </activity>
</application>

</manifest> 
```

现在，MainActivity 包 legacy_systems.notificationproject 的代码；

```
import android.os.Bundle;
import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Intent;
import android.view.View;
import android.app.Activity;
import android.view.Menu;

public class MainActivity extends Activity {
int notificationID = 1;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

public void onClick(View V)
{
    getNotification();
}

protected void getNotification()
{
    Intent i = new Intent(this, Notification.class);
    i.putExtra("notificationID", notificationID);
    PendingIntent pn = PendingIntent.getActivity(this, 0, i, 0);
    NotificationManager nm= (NotificationManager)getSystemService(NOTIFICATION_SERVICE);
    Notification n = new Notification(R.drawable.ic_launcher,
                                      "Reminder! Meeting starts in 5 Minute",
                                      System.currentTimeMillis());
    CharSequence from = "System Alarm";
    CharSequence message = "Meeting with customer in next 2 minute";
    n.setLatestEventInfo(this, from, message, pn);
    n.vibrate = new long[]{ 100,250,50,500};
    nm.notify(notificationID, n);       
}

} 
```

而且，Notification.java 的代码是 package legacy_systems.notificationproject；

```
import android.app.Activity;
import android.os.Bundle;
import android.app.NotificationManager;
import android.util.Log;

public class Notification extends Activity{
String tag;

public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    Log.d(tag,"In here");

    setContentView(R.layout.notification);

    NotificationManager nm = (NotificationManager)getSystemService(VIBRATOR_SERVICE);
    nm.cancel(getIntent().getExtras().getInt("notificationID"));
}
} 
```

而activity_main.xml 是，

```
<xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<Button
    android:id="@+id/btn"
    android:layout_height="wrap_content"
    android:layout_width="fill_parent"
    android:text="@string/getnot"
    android:onClick="onClick"
 />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:14:57.073

建议您不要将自己的类命名为与系统定义的类相同的名称。您正尝试将`android.app.Notification`其作为活动打开，这将不起作用，并且应该会导致 LogCat 中出现警告。

请将您的`Notification`活动重命名为其他名称，例如`Easdluaerdf`，以使其独一无二，调整您的清单并`PendingIntent`进行匹配，您应该会有更好的运气。

# macros - 如何在clojure中使用宏来查看多行的xy图？

> ID：14790738
> 
> 赞同：0
> 
> 时间：2013-02-09T19:37:16.723
> 
> 标签：macros, clojure, incanter

我尝试编写将数据集作为参数的宏，并在单个 xy 绘图上查看数据集中的所有数据。例如，我创建数据集

```
(def test-data
 [["RECALL" "CAFE" "CLIPPERS"]
 [0 0 0]
 [14 15 13]
 [160 146 155]]) 
```

并写下这个

```
(defmacro figure
  [datas]
  (let [x `(range 0 (nrow ~datas)) y `(rest (:column-names ~datas))]
   `(let [datas# ~datas]
      (with-data datas#
        (doto
          (xy-plot ~x ($ (first (:column-names datas#))))
          ~@(map (fn [arg] `(add-lines ~x ($ ~arg ))) (eval y));;this line, wheh rest of columns have added to xy plot, get me a trouble
          view))))) 
(figure test-data) 
```

但是代码中的 eval 有问题。我认为，这不是 Clojure 惯用的方式，在某些情况下这不起作用。我尝试了各种疯狂的技巧来获取数据集的列名作为评估参数，但这不起作用。

是否存在在宏中的宏扩展时间评估表达式的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T13:25:54.603

你不需要在这里使用宏。普通功能将完成这项工作：

```
(defn figure [data]
  (let [x (range (nrow data))
        [h & t] (:column-names data)]
    (with-data data
      (let [plot (xy-plot x ($ h))]
        (doseq [col-name t]
          (add-lines plot x ($ col-name)))
        (view plot))))) 
```

# c - 使用 strncpy() 复制 const char *

> ID：14790739
> 
> 赞同：2
> 
> 时间：2013-02-09T19:37:21.383
> 
> 标签：c, strncpy

我对 C 很陌生，我在使用 strncpy 函数时遇到了困难。\

这是我正在使用的示例：

```
int main()
{

const char *s = "how";

struct test {
    char *name;
};

struct test *t1 = malloc(sizeof(struct test));

strncpy(t1->name, s, sizeof(*s));
t1->name[NAMESIZE] = '\0';

printf("%s\n", t1->name);

} 
```

我有一个 const char *，我需要将 test 的“名称”值设置为 const char。我很难弄清楚这一点。这甚至是正确的方法吗？

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T19:40:35.357

好吧，您分配了结构，但没有分配结构*内*的字符串。在复制到它之前，您需要这样做。即使这样做，当您尝试设置字符串终止符时，您也可能会覆盖未分配的内存。

而且，由于酒的摄入量很高，我刚刚注意到你实际上只复制了一个字符，但它仍然是*未定义的行为*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T19:54:11.013

让我们一步一步来：

```
struct test *t1 = malloc(sizeof(struct test)); 
```

这为 a 分配空间`struct test`；指针有足够的空间，但没有指针*指向*`name`的任何内存。至少，您需要执行以下操作：

 *```
t1->name = malloc(strlen(s) + 1); 
```

完成后，您可以继续复制字符串。但是，您已经计算了一次字符串的长度来分配内存；通过调用`strncpy`. 相反，请执行以下操作：

```
const size_t len = strlen(s) + 1;  // +1 accounts for terminating NUL
t1->name = malloc(len);
memcpy(t1->name, s, len); 
```

一般来说，尽量使用这种基本模式；当字符串进入您的代码时计算*一次*字符串的长度，然后使用显式大小的内存缓冲区和`mem*`操作，而不是使用操作的隐式长度字符串`str*`。如果操作得当，它至少同样安全（而且通常更安全）和更有效。

您可以改用`strncpy`if`t1->name`是一个固定大小的数组（尽管许多人更喜欢使用`strlcpy`）。如下所示：

```
struct test { char name[MAXSIZE]; };
struct test *t1 = malloc(sizeof *t1);
strncpy(t1->name, s, MAXSIZE - 1);
t1->name[MAXSIZE-1] = 0; // force NUL-termination 
```

请注意，`size`参数 to`strncpy`应该始终是*目标*的大小，而不是源的大小，以避免写入目标缓冲区的范围之外。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T19:50:25.207

在不尝试完整性或教育方向的情况下，这里有一个应该可以工作的代码版本。您可以在本网站上播放“找出不同之处”并分别搜索每一个的解释。

```
int main()
{ 
    const char s[] = "how";                 // s is an array, const char[4]

    struct test{ char name[NAMESIZE]; };    // test::name is an array

    struct test * t1 = malloc(sizeof *t1);  // DRY

    strncpy(t1->name, s, NAMESIZE);         // size of the destination
    t1->name[NAMESIZE - 1] = '\0';          // because strncpy is evil

    printf("%s\n", t1->name);

    free(t1);                               // clean up
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-09T20:00:42.123

strncpy()**总是错误的**

*   如果结果太长，则目标字符串不会以 nul 结尾
*   如果目标太长（第三个参数），尾端将完全用 NUL 填充。如果您有大缓冲区和短字符串，这将浪费很多周期。

相反，您可以使用 memcpy() 或 strcpy，（或者在您的情况下甚至是 strdup() ）

```
int main()
{
const char *s = "how";

struct test {
    char *name;
    };
struct test *t1
size_t len;

t1 = malloc(sizeof *t1);

#if USE_STRDUP

  t1->name = strdup(s);

#else

  len = strlen(s);
  t1->name = malloc (1+len);
  memcpy(t1->name, s, len);
  t1->name[len] = '\0';

#endif    

printf("%s\n", t1->name);

return 0;
} 
```*

# matlab - 在 MATLAB 中使用 i 和 j 作为变量

> ID：14790740
> 
> 赞同：144
> 
> 时间：2013-02-09T19:37:23.460
> 
> 标签：matlab, variables, naming-conventions

`i`并且`j`是非常流行的变量名称（例如，参见[这个问题](https://stackoverflow.com/questions/4137785/why-are-variables-i-and-j-used-for-counters)和[这个](https://stackoverflow.com/questions/454303/why-are-we-using-i-as-a-counter-in-loops)问题）。

例如，在循环中：

```
for i=1:10,
    % Do something...
end 
```

作为矩阵的索引：

```
mat(i, j) = 4; 
```

为什么*不应该将*它们用作 MATLAB 中的变量名？

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2013-02-09T19:40:15.840

因为`i`和`j`都是表示[*虚数单位*](http://en.wikipedia.org/wiki/Imaginary_unit)的函数：

*   [http://www.mathworks.co.uk/help/matlab/ref/i.html](http://www.mathworks.co.uk/help/matlab/ref/i.html)
*   [http://www.mathworks.co.uk/help/matlab/ref/j.html](http://www.mathworks.co.uk/help/matlab/ref/j.html)

因此，一个名为`i`or的变量`j`将覆盖它们，可能会默默地破坏执行复杂数学的代码。

可能的解决方案包括使用`ii`and`jj`作为循环变量，或者使用`1i`需要`i`表示虚数单位的任何时候。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2013-02-13T19:02:27.590

避免变量是一种很好的做法，`i`以`j`防止混淆它们是变量还是虚数单位。

然而，就我个人而言，我经常使用`i`和作为变量作为短循环的索引。`j`为了避免我自己的代码出现问题，我遵循了另一个关于`i`and的好习惯`j`：*不要*用它们来表示虚数。事实上，[MATLAB 自己的文档指出](http://www.mathworks.com/help/matlab/ref/i.html)：

> 为了速度和提高鲁棒性，您可以将 complex`i`和替换`j`为`1i`.

因此，我没有因为潜在的冲突而避免使用两个非常常用的变量名称，而是明确地谈论虚数。它也使我的代码更清晰。任何时候我看到`1i`，我都知道它代表`sqrt(-1)`，因为它不可能是一个变量。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-07-18T12:15:11.903

在旧版本的 MATLAB 中，曾经有一个很好的理由来避免使用`i`和`j`作为变量名 - 早期版本的 MATLAB JIT 不够聪明，无法判断您是使用它们作为变量还是作为虚数单位，因此会关闭许多其他可能的优化。

因此，您的代码会因为`i`和`j`作为变量的存在而变慢，如果您将它们更改为其他内容，则会加快速度。这就是为什么如果您通读大量 MathWorks 代码，您会看到`ii`并`jj`广泛使用循环索引。有一段时间，MathWorks 甚至可能非正式地建议人们自己做这件事（尽管他们总是正式建议人们为优雅/可维护性而编程，而不是按照当前 JIT 所做的任何事情，因为它是每个版本的移动目标）。

但那是很久以前的事了，现在它有点像“僵尸”问题，实际上比许多人仍然认为的要重要得多，但它拒绝死去。

在任何最近的版本中，是否使用`i`和`j`作为变量名确实是个人偏好。如果您对复数进行大量工作，您可能希望避免使用`i`和`j`作为变量，以避免任何小的潜在混淆风险（尽管您可能也/相反希望只使用`1i`或`1j`更少混淆，并获得更好的性能）。

另一方面，在我的典型工作中，我从不处理复数，如果我可以随意使用`i`并`j`作为循环索引，我会发现我的代码更具可读性。

* * *

我在这里看到很多答案说不*推荐......*没有说谁在推荐。以下是 MathWorks 的实际建议范围，来自当前版本文档`i`：

> 由于 i 是一个函数，它可以被覆盖并用作变量。但是，如果您打算在复数算术中使用变量名，最好避免使用 i 和 j。[...] 为了提高速度和提高鲁棒性，您可以将复数 i 和 j 替换为 1i。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-02-15T11:29:46.233

如其他答案中所述，`i`不建议使用通用代码，原因有两个：

*   如果要使用虚数，它可能会与索引混淆或被索引覆盖
*   如果您将其用作索引，它可能会覆盖或与虚数混淆

正如所建议的：`1i`并且`ii`被推荐。然而，尽管这些都是与 的细微偏差，但将这两种`i`替代方案一起使用并不是很好。

这是一个示例，为什么（个人）我不喜欢它：

```
val2 = val + i  % 1
val2 = val + ii % 2
val2 = val + 1i % 3 
```

一个不容易被两个或三个误读，但两个和三个彼此相似。

因此我个人的建议是：如果您有时使用复杂的代码，请始终`1i`与不同的循环变量结合使用。

如果您不使用许多循环变量和字母就足够了的单字母索引示例：`t`、`u`和`k``p`

较长索引的示例：`i_loop`、`step`、`walk`和`t_now`

当然，这也是个人喜好问题，但不难找到可以使用且具有明确含义且不会增长太久的索引。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-06-20T21:47:33.007

有人指出，这`1i`是一种可接受且明确的编写方式`sqrt(-1)`，因此没有必要避免使用`i`. 再说一次，正如[丹尼斯指出的那样](https://stackoverflow.com/questions/14790740/using-i-and-j-as-variables-in-matlab/14893729#14893729)，很难看出 和 之间的`1i`区别`ii`。我的建议：`1j`尽可能用作虚常数。这与电气工程师使用的技巧相同——他们使用`j`的是`sqrt(-1)`因为`i`已经被用于[当前](https://en.wikipedia.org/wiki/Electric_current)。

我个人从不使用`i`and `j`; 当我需要使用复数时，我使用`ii`and`jj`作为速记索引变量（以及 kk、ll、mm、...） 。`1j`

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-04-29T12:51:47.103

这里已经很好地说明了与虚数单位的混淆，但还有一些其他更平淡无奇的原因有时不鼓励使用这些和其他单字母变量名称。

1.  特别是 MATLAB：如果您使用 coder 从您的 MATLAB 代码生成 C++ 源代码（不要，这太可怕了），那么您会被明确警告不要重用变量，因为可能会发生类型冲突。

2.  通常，根据您的 IDE，单字母变量名可能会对荧光笔和搜索/替换造成严重破坏。MATLAB 不受此影响，我相信 Visual Studio 已经有一段时间没有问题了，但是像[MISRA](https://en.wikipedia.org/wiki/MISRA_C)等 C/C++ 编码标准倾向于反对它们。

就我而言，我避免使用所有单字母变量，尽管直接实现数学源有明显的优势。前几百次需要额外的努力，但之后你就不再注意到了，当你或其他一些可怜的灵魂来阅读你的代码时，优势是无穷无尽的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-02-09T19:40:15.417

默认情况下`i`，`j`代表虚数单位。因此，从 MATLAB 的角度来看，`i`用作变量在某种程度上就像`1`用作变量一样。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-12-31T15:20:01.637

任何重要的代码都包含多个`for`循环，最佳实践建议您使用指示其目的和范围的描述性名称。在远古时代（除非我不会保存它的 5-10 行脚本），我一直在使用变量名，比如`idxTask`,`idxAnotherTask`等等`idxSubTask`。

或者至少将它正在索引的数组的第一个字母加倍，例如`ss`索引`subjectList`，`tt`索引`taskList`，但不是`ii`或`jj`不能帮助我毫不费力地从我的多个 for 循环中识别出它们正在索引的数组。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-09-14T07:37:42.673

*除非您是一个非常困惑的用户，否则我认为使用变量名i*和*j*的风险很小，并且我经常使用它们。我没有看到任何官方迹象表明应该避免这种做法。

虽然在其他帖子中提到的某些情况下，遮蔽虚数单位确实会引起一些混乱，但总的来说，我根本不认为这是一个主要问题。您可以在 MATLAB 中做更多令人困惑的事情，例如定义`false=true`

**在我看来，您唯一应该避免使用它们的情况是您的代码专门处理虚数。**

# c - 设置静态分配对象的内存位置

> ID：14790746
> 
> 赞同：1
> 
> 时间：2013-02-09T19:37:50.320
> 
> 标签：c, memory-management, assembly

我有以下代码：

```
struct str {
    int a;
    int b;
};

extern struct str c; 
```

在汇编中（使用 GNU as），我可以像这样设置内存位置`c`：

```
.global c
.set c, 0x12345678 
```

有没有办法在 C 中便携地做到这一点？此代码适用于微控制器，因此我不认为这是“不好的做法”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:46:37.063

是和不是。您可以编写基本上可以使用任何编译器编译的*代码。*之后会发生什么将取决于。

```
 struct str *c = (struct str *)0x12345678; 
```

正如我所说，几乎任何编译器都应该编译这么多（尽管如果您使用的数字是编译器认为不能转换为地址的数字，它可能会被拒绝）。当您尝试取消引用指针时，将取决于编译器如何将其转换为实际地址（有所不同，但旨在成为知道机器寻址的人所期望的）以及它生成的地址是否是您实际拥有的地址访问权限（如果是，您究竟拥有什么访问权限）。

# ember.js - Ember：如何在目录中找到部分车把？

> ID：14790747
> 
> 赞同：3
> 
> 时间：2013-02-09T19:37:54.960
> 
> 标签：ember.js

我正在使用 Ember.js（在 Rails 应用程序中）并在显示表单时得到了重点。我使用了“部分”车把标签，如下所示：

```
{{partial "entity_edit_fields"}} 
```

Ember 尝试从`_entity_edit_fields.hbs`文件中检索模板。但是，我已将所有与实体相关的模板放入单独的目录中。现在，我想告诉 Ember 寻找`entity/_edit_fields.hbs`. 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-10T00:14:55.973

要将模板包含`entity/_edit_fields.hbs`为部分使用：

```
{{partial "entity/edit_fields"}} 
```

如果您再次遇到类似问题，请尝试查看 ember 测试套件。几乎总会有一个例子可以帮助回答你的问题。我也不确定部分是如何工作的，所以在回答之前我看了一下[handlebars_test.js](https://github.com/emberjs/ember.js/blob/master/packages/ember-handlebars/tests/handlebars_test.js#L2267)

```
test("should render other slash-separated templates using the {{partial}} helper", function() {
  Ember.TEMPLATES["child/_subTemplate"] = Ember.Handlebars.compile("sub-template");

  view = Ember.View.create({
    template: Ember.Handlebars.compile('This {{partial "child/subTemplate"}} is pretty great.')
  });

  Ember.run(function() {
    view.appendTo('#qunit-fixture');
  });

  equal(Ember.$.trim(view.$().text()), "This sub-template is pretty great.");
}); 
```

# ruby - 与 Ruby 的“Catch/Throw”结构混淆

> ID：14790752
> 
> 赞同：-1
> 
> 时间：2013-02-09T19:38:30.333
> 
> 标签：ruby

```
class Test
  def foo
    throw(:label, foo)
    "should never get here"
  end

  def bar
    "bar"
  end
end

test = Test.new 
```

现在我尝试了以下方法：

```
puts("bar -> " + catch(:label) {test.bar}) 
```

并得到：

```
bar -> bar
=> nil 
```

现在当我尝试：

```
puts("foo -> " + catch(:label) {test.foo}) 
```

我希望我会得到`nil`但实际上得到了以下内容：

```
SystemStackError: stack level too deep
    from /usr/lib/ruby/1.9.1/irb/workspace.rb:80
Maybe IRB bug! 
```

我无法解释自己为什么会这样。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:42:56.197

无限循环发生在抛出/捕获之外。

```
def foo
  throw(:label, foo) # <-
  "should never get here"
end 
```

必须首先生成返回的值，那里没有惰性 eval。所以它再次调用 foo ，并且您可以无限递归而没有任何停止点。如果你想要零，使用

```
def foo
  throw(:label, nil) # <-
  "should never get here"
end 
```

# jquery - jQuery scrollTo 在 IE8 中导致问题 - 代码块后没有脚本执行

> ID：14790758
> 
> 赞同：2
> 
> 时间：2013-02-09T19:38:52.390
> 
> 标签：jquery, internet-explorer, internet-explorer-8, mobile-safari, scrollto

我使用此 JavaScript 代码隐藏移动 Safari 中的地址栏：

```
window.addEventListener("load",function() {
    setTimeout(function(){
        window.scrollTo(0, 1);
    }, 0);
}); 
```

它工作得很好，并且不会对其他浏览器造成任何伤害。只有 Internet Explorer 8（这是我必须支持的最古老的 IE）似乎存在问题，因为该代码块之后的任何 JavaScript 都不再执行。你知道为什么吗？

我已经用谷歌搜索了一些人`scrollTo`在 IE8 中遇到的问题，但唯一可能有用的资源是指向 jQuery 1.3.3 或类似内容的错误报告的链接。当我使用 jQuery 1.9.0 时，我相信这个问题已经解决了。

顺便说一句：为什么我无法`scrollTo`在 jQuery 文档中找到该方法？它似乎是某种插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:18:17.583

该死的，这是一个棘手的问题！但问题只是 IE8 不知道`addEventListener`- 你能想象吗？相反，IE8 需要`attachEvent`，[看这里](https://stackoverflow.com/questions/2657182/correct-usage-of-addeventlistener-attachevent)。

# html - 只有当我快速使用鼠标时，CSS 才能在当前版本的 Safari 中工作

> ID：14790761
> 
> 赞同：0
> 
> 时间：2013-02-09T19:40:00.160
> 
> 标签：html, css, menubar, iweb

我有一个我正在开发的网站的 CSS 菜单。我已经对其进行了调整，使其在 Firefox、Chrome 和旧版本的 Safari 上完全符合我的要求。然而，在最新版本的 Safari（Lion 上的 6.0.2）中，发生了一些奇怪的事情。如果我让页面完全加载然后将鼠标悬停在菜单上，则菜单功能不起作用。但是，如果我在页面加载时将鼠标悬停在菜单上，它就可以正常工作！这让我发疯，直到我弄清楚了模式。好吧，我想它仍然让我发疯。这种错误行为似乎只影响最新的 Safari，我不知道如何修复它。我尝试注释掉我认为可能与之冲突的其他 CSS 文件。这个问题可能与我'

我正在积极处理代码，所以这个页面可能会改变，但这是我遇到问题的页面（我的编辑）。请注意，许多菜单项还没有为它们制作的页面：

[http://rhythmshuffle.com/dev/2013/robversion1/RS2013/About.html](http://rhythmshuffle.com/dev/2013/robversion1/RS2013/About.html)

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head><link rel="apple-touch-icon" href="images/apple-touch-icon.png" />
<link rel="shortcut icon" href="/favicon.ico" />
<link href="/menu_assets/styles.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Oswald">
<meta name="viewport" content="width=960" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="Generator" content="iWeb 3.0.4" />
<meta name="iWeb-Build" content="local-build-20130209" />
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
<meta name="viewport" content="width=960" />
<title>About</title>
<link rel="stylesheet" type="text/css" media="screen,print" href="About_files/About.css" />
<!--[if lt IE 8]><link rel='stylesheet' type='text/css' media='screen,print' href='About_files/AboutIE.css'/><![endif]-->
<!--[if gte IE 8]><link rel='stylesheet' type='text/css' media='screen,print' href='Media/IE8.css'/><![endif]-->
<style type="text/css">
/*<![CDATA[*/
@import "Scripts/Widgets/HTMLRegion/Paste.css";
/*]]>*/
</style>
<script type="text/javascript" src="Scripts/iWebSite.js"></script>
<script type="text/javascript" src="Scripts/iWebImage.js"></script>
<script type="text/javascript" src="Scripts/iWebMediaGrid.js"></script>
<script type="text/javascript" src="Scripts/Widgets/SharedResources/WidgetCommon.js">  </script>
<script type="text/javascript" src="Scripts/Widgets/HTMLRegion/Paste.js"></script>
<script type="text/javascript" src="About_files/About.js"></script>
  </head>
 <body style="background: rgb(125, 133, 135); margin: 0pt; " onload="onPageLoad();" onunload="onPageUnload();">
<div style="text-align: center; ">
  <div style="margin-bottom: 0px; margin-left: auto; margin-right: auto; margin-top: 0px; overflow: hidden; position: relative; word-wrap: break-word;  background: rgb(165, 183, 156); text-align: left; width: 960px; " id="body_content">
    <div style="float: left; margin-left: 0px; position: relative; width: 960px; z-index: 0; " id="nav_layer">
      <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
      <div style="clear: both; height: 0px; line-height: 0px; " class="spacer"> </div>
    </div>
    <div style="float: left; height: 0px; line-height: 0px; margin-left: 0px; position: relative; width: 960px; z-index: 10; " id="header_layer">
      <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
    </div>
    <div style="margin-left: 0px; position: relative; width: 960px; z-index: 5; " id="body_layer">
      <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
      <div style="height: 11px; width: 648px;  height: 0px; left: 272px; position: absolute; top: 81px; width: 648px; z-index: 1; " class="tinyText shadow_0">
        <div style="position: relative; width: 648px; ">
          <img src="About_files/shapeimage_1.jpg" alt="" style="height: 11px; left: 0px; margin-top: -5px; position: absolute; top: 0px; width: 648px; " />
        </div>
      </div>

      <div style="height: 245px; width: 199px;  height: 245px; left: 41px; position: absolute; top: 639px; width: 199px; z-index: 1; " class="tinyText style_SkipStroke stroke_0" id="id1">
        <img src="About_files/spiralonly.png" alt="" style="border: none; height: 245px; width: 200px; " />
      </div>

      <div style="height: 437px; width: 356px;  height: 437px; left: 582px; position: absolute; top: 77px; width: 356px; z-index: 1; " class="tinyText">
        <div style="position: relative; width: 356px; ">
          <img src="About_files/shapeimage_2.png" alt="" style="height: 437px; left: 0px; position: absolute; top: 0px; width: 356px; " />
        </div>
      </div>

      <div style="height: 50px; width: 462px;  height: 50px; left: 504px; position: absolute; top: 922px; width: 462px; z-index: 1; " class="tinyText style_SkipStrokeSkipFillSkipOpacity shadow_1">
        <div style="position: relative; width: 462px; "></div>
      </div>

      <div id="id2" style="height: 371px; left: 0px; position: absolute; top: 898px; width: 960px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
        <div class="text-content graphic_shape_layout_style_default_External_960_371" style="padding: 0px; ">
          <div class="graphic_shape_layout_style_default"></div>
        </div>
      </div>

      <div class="tinyText" style="height: 75px; left: 589px; position: absolute; top: 901px; width: 364px; z-index: 1; ">
        <img usemap="#map1" id="shapeimage_3" src="About_files/shapeimage_3.png" style="border: none; height: 82px; left: -6px; position: absolute; top: -4px; width: 374px; z-index: 1; " alt="brought to you by SwingBuffalo.com&#10;winner of Buffalo Spree’s 2011&#10;“Best Dance Lessons”" title="" /><map name="map1" id="map1"><area href="http://SwingBuffalo.com/" title="http://SwingBuffalo.com/" onmouseover="IMmouseover('shapeimage_3', '0');" alt="http://SwingBuffalo.com/" onmouseout="IMmouseout('shapeimage_3', '0');" shape="rect" coords="252, 8, 366, 28" onclick="window.open(this.href); return false;" onkeypress="window.open(this.href); return false;" /></map><img style="height: 20px; left: 246px; position: absolute; top: 4px; width: 114px; " id="shapeimage_3_link_0" alt="shapeimage_3_link_0" src="About_files/shapeimage_3_link_0.png" />
      </div>

      <div style="height: 164px; width: 164px;  height: 164px; left: 57px; position: absolute; top: 4px; width: 164px; z-index: 1; " class="tinyText style_SkipStroke_2 stroke_0">
        <a href="Home.html" title="Home.html"><img src="About_files/RS_Logo_small.png" alt="" style="border: none; height: 164px; width: 164px; " /></a>
      </div>

      <div style="height: 7px; width: 969px;  height: 0px; left: -4px; position: absolute; top: 880px; width: 969px; z-index: 1; " class="tinyText">
        <div style="position: relative; width: 969px; ">
          <img src="About_files/shapeimage_4.jpg" alt="" style="height: 7px; left: 0px; margin-top: -3px; position: absolute; top: 0px; width: 969px; " />
        </div>
      </div>
      <div class="com-apple-iweb-widget-HTMLRegion" id="widget0" style="height: 344px; left: 15px; opacity: 1.00; position: absolute; top: 906px; width: 607px; z-index: 1; ">
        <script type="text/javascript"><!--//--><![CDATA[//><!--
var widget0_htmlMarkupURL = ".//About_files/widget0_markup.html";//--><!]]></script>
        <div id="widget0-htmlRegion" class="html_region_widget"></div>
      </div>
      <script type="text/javascript"><!--//--><![CDATA[//><!--new Paste('widget0', 'Scripts/Widgets/HTMLRegion', 'Scripts/Widgets/SharedResources', '.', {"emptyLook": false});//--><!]]></script>
      <div id="id3" style="height: 649px; left: 63px; position: absolute; top: 195px; width: 835px; z-index: 1; " class="style_SkipStroke_3 shape-with-text">
        <div class="text-content graphic_textbox_layout_style_default_External_835_649" style="padding: 0px; ">
          <div class="graphic_textbox_layout_style_default">
            <p style="padding-top: 0pt; " class="paragraph_style">Rhythm Shuffle 2013 is <a class="class1" title="http://SwingBuffalo.com/" href="http://SwingBuffalo.com/">Swing Buffalo’s</a> sixth annual swing dance workshop. Our goal is to spread the pure fun and enjoyment of historical forms of swing dance known as <a onclick="window.open(this.href); return false;" title="http://www.lindycircle.com/history/lindy_hop/" href="http://www.lindycircle.com/history/lindy_hop/" onkeypress="window.open(this.href); return false;">Lindy Hop</a> and <a onclick="window.open(this.href); return false;" title="http://www.lindycircle.com/history/balboa/" href="http://www.lindycircle.com/history/balboa/" onkeypress="window.open(this.href); return false;">Balboa</a>, dances straight from the swing era. Each year, we bring in some of the world’s top swing dance <a title="Instructors.html" href="Instructors.html">instructors</a> and hire some of the greatest swing bands to attract locals and out of town visitors alike to learn and dance with one another.<br /></p>
            <p class="paragraph_style"><br /></p>
            <p class="paragraph_style">By signing up, you will enjoy a weekend of thoughtful learning from helpful, non-threatening, and down to earth <a title="Instructors.html" href="Instructors.html">instructors</a>; dances like they had in the old days that are full of energy, improvisation, and playfulness; bands that will take you back to the 20’s, <span class="style">30</span>’s, and 40’s; blues parties; and DJ’s that’ll make you get up on your feet and onto the dance floor.<br /></p>
            <p class="paragraph_style"><br /></p>
            <p class="paragraph_style">We will also have a vintage vendors on hand for you to shop for the perfect swing attire so you can go to get your <a title="http://LindyFix.com/" href="http://LindyFix.com/">Lindy Fix</a> in style. Sit down to a Sunday lunch with a historical roundtable discussion on a swing-era topic. This year's topic is the Crystal Ballroom and the ships, the Americana and Canadiana (with dance floors) which brought dancers there.<br /></p>
            <p class="paragraph_style"><br /></p>
            <p class="paragraph_style">Each year, our workshop gets bigger and better. Swing Buffalo, as a community organization, works hard to provide the best experience possible at the cheapest price possible. As a community, we work hard all year round to make this event something we can be proud of. In doing so, we hope to inspire and excite you and show you how much better the world could be if we all just learned to swing out.<br /></p>
            <p class="paragraph_style"><br /></p>
            <p style="padding-bottom: 0pt; " class="paragraph_style">- The Rhythm Shuffle Team</p>
          </div>
        </div>
      </div>

      <div style="height: 65px; width: 232px;  height: 65px; left: 668px; position: absolute; top: 125px; width: 232px; z-index: 1; " class="tinyText">
        <div style="position: relative; width: 232px; ">
          <img src="About_files/shapeimage_5.png" alt="About" style="height: 33px; left: 0px; margin-left: 118px; margin-top: 17px; position: absolute; top: 0px; width: 109px; " />
        </div>
      </div>
                <div class="com-apple-iweb-widget-HTMLRegion" id="widget1" style="height: 186px; left: 228px; opacity: 1.00; position: absolute; top: 1px; width: 731px; z-index: 1; ">
<blockquote><div id='cssmenu'>
<ul>
   <li class='has-sub'><a href='About.html'><span style="font-family: 'Oswald'; font-size:24px;text-shadow: -2px 2px #596653">About</span></a>
  <ul>
     <li><a href='About.html'><span style="font-family: 'Oswald'; font-size:18px;">About Rhythm Shuffle</span></a></li>
     <li><a href='Balboa.html'><span style="font-family: 'Oswald'; font-size:18px;">About Balboa</span></a></li>
     <li><a href='LindyHop.html'><span style="font-family: 'Oswald'; font-size:18px;">About Lindy Hop</span></a></li>
     <li><a href='Competitions.html'><span style="font-family: 'Oswald'; font-size:18px;">Competitions</span></a></li>
     <li><a href='Directions.html'><span style="font-family: 'Oswald'; font-size:18px;">Directions</span></a></li>
     <li><a href='Music.html'><span style="font-family: 'Oswald'; font-size:18px;">Music</span></a></li>
     <li class='has-sub'><a href='#'><span style="font-family: 'Oswald'; font-size:18px;">Previous Years</span></a>
        <ul>
           <li><a href='/2012/'><span style="font-family: 'Oswald'; font-size:18px;">2012</span></a></li>
           <li><a href='/2011/'><span style="font-family: 'Oswald'; font-size:18px;">2011</span></a></li>
           <li><a href='/2010/'><span style="font-family: 'Oswald'; font-size:18px;">2010</span></a></li>
           <li><a href='/2009/'><span style="font-family: 'Oswald'; font-size:18px;">2009</span></a></li>
           <li class='last'><a href='/2008/'><span style="font-family: 'Oswald'; font-size:18px;">2008</span></a></li>
        </ul>
     </li>
     <li><a href='Pricing.html'><span style="font-family: 'Oswald'; font-size:18px;">Pricing</span></a></li>
     <li><a href='Schedule.html'><span style="font-family: 'Oswald'; font-size:18px;">Schedule</span></a></li>
     <li><a href='Vendors.html'><span style="font-family: 'Oswald'; font-size:18px;">Vendors</span></a></li>
     <li class='last'><a href='Venues.html'><span style="font-family: 'Oswald'; font-size:18px;">Venues</span></a></li>
  </ul>
   </li>
   <li class='has-sub'><a href='Classes.html'><span style="font-family: 'Oswald'; font-size:24px;text-shadow: -2px 2px #596653">Classes</span></a>
  <ul>
     <li><a href='Classes.html'><span style="font-family: 'Oswald'; font-size:18px;">Dance Classes</span></a></li>
     <li><a href='Talk.html'><span style="font-family: 'Oswald'; font-size:18px;">Panel Discussion</span></a></li>
     <li><a href='Instructors.html'><span style="font-family: 'Oswald'; font-size:18px;">Instructors</span></a></li>
     <li><a href='Schedule.html'><span style="font-family: 'Oswald'; font-size:18px;">Schedule</span></a></li>
     <li class='last'><a href='Directions.html'><span style="font-family: 'Oswald'; font-size:18px;">Directions</span></a></li>
  </ul>
   </li>
   <li class='has-sub'><a href='Dances.html'><span style="font-family: 'Oswald'; font-size:24px;text-shadow: -2px 2px #596653">Dances</span></a>
  <ul>
     <li><a href='Dances.html'><span style="font-family: 'Oswald'; font-size:18px;">Social Dances</span></a></li>
     <li><a href='Competitions.html'><span style="font-family: 'Oswald'; font-size:18px";>Competitions</span></a></li>
     <li><a href='Schedule.html'><span style="font-family: 'Oswald'; font-size:18px;">Schedule</span></a></li>
     <li class='last'><a href='Directions.html'><span style="font-family: 'Oswald'; font-size:18px;">Directions</span></a></li>
  </ul>
   </li>
   <li class='has-sub'><a href='Register.html'><span style="font-family: 'Oswald'; font-size:24px;text-shadow: -2px 2px #596653">Register</span></a>
  <ul>
     <li><a href='Register.html'><span style="font-family: 'Oswald'; font-size:18px;">Register</span></a></li>
     <li><a href='Housing.html'><span style="font-family: 'Oswald'; font-size:18px;">Housing</span></a></li>
     <li><a href='Pricing.html'><span style="font-family: 'Oswald'; font-size:18px;">Pricing</span></a></li>
     <li class='last'><a href='Discounts.html'><span style="font-family: 'Oswald'; font-size:18px;">Discounts</span></a></li>
  </ul>
   </li>
   <li class='last'><a href='Contact.html'><span style="font-family: 'Oswald'; font-size:24px;text-shadow: -2px 2px #596653">Contact</span></a></li>
</ul>
</div>
</blockquote>
</div>
      <div style="height: 1270px; line-height: 1270px; " class="spacer"> </div>
    </div>
    <div style="height: 0px; line-height: 0px; margin-left: 0px; position: relative; width: 960px; z-index: 15; " id="footer_layer">
      <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
    </div>
  </div>
    </div>
  </body>
</html> 
```

这是我编辑的 CSS：

[http://rhythmshuffle.com/dev/2013/robversion1/RS2013/About_files/About.css](http://rhythmshuffle.com/dev/2013/robversion1/RS2013/About_files/About.css)

```
.style_SkipStroke_2 {
    background: transparent;
    opacity: 1.00;
}
.paragraph_style {
    color: rgb(242, 234, 196);
    font-family: 'TrebuchetMS', 'Trebuchet MS', sans-serif;
    font-size: 18px;
    font-stretch: normal;
    font-style: normal;
    font-variant: normal;
    font-weight: 400;
    letter-spacing: 0;
    line-height: 25px;
    margin-bottom: 0px;
    margin-left: 0px;
    margin-right: 0px;
    margin-top: 0px;
    opacity: 1.00;
    padding-bottom: 0px;
    padding-top: 0px;
    text-align: justify;
    text-decoration: none;
    text-indent: 0px;
    text-transform: none;
}
.style {
    color: rgb(247, 239, 202);
    line-height: 25px;
    opacity: 1.00;
}
.style_SkipStroke_3 {
    background: transparent;
    opacity: 1.00;
}
.style_SkipStrokeSkipFillSkipOpacity {
}
.style_SkipStroke {
    background: transparent;
    opacity: 0.25;
}
.style_SkipStroke_1 {
    background: transparent url(backgroundimage_1.jpg) no-repeat scroll center center;
    opacity: 1.00;
}
.Body {
    color: rgb(88, 77, 77);
    font-family: 'ArialMT', 'Arial', sans-serif;
    font-size: 15px;
    font-stretch: normal;
    font-style: normal;
    font-variant: normal;
    font-weight: 400;
    letter-spacing: 0;
    line-height: 20px;
    margin-bottom: 0px;
    margin-left: 0px;
    margin-right: 0px;
    margin-top: 0px;
    opacity: 1.00;
    padding-bottom: 0px;
    padding-top: 0px;
    text-align: left;
    text-decoration: none;
    text-indent: 0px;
    text-transform: none;
}
.graphic_image_style_default_SkipStroke {
    background: transparent;
    opacity: 1.00;
}
.graphic_shape_layout_style_default_External_960_371 {
    position: relative;
}
.graphic_shape_layout_style_default {
    padding: 4px;
}
.graphic_shape_style_default_SkipStroke {
    background: rgb(255, 255, 255);
    opacity: 1.00;
}
.graphic_textbox_layout_style_default_External_835_649 {
    position: relative;
}
.graphic_textbox_layout_style_default {
    padding: 4px;
}
.graphic_textbox_style_default_SkipStroke {
    background: transparent;
    opacity: 1.00;
}
.graphic_textbox_style_default_SkipStrokeSkipFillSkipOpacity {
}
a {
    color: rgb(255, 234, 173);
    text-decoration: underline;
}
a:visited {
    color: rgb(241, 231, 191);
    text-decoration: underline;
}
a.class1 {
    color: rgb(255, 234, 173);
}
a.class1:visited {
    color: rgb(241, 231, 191);
    text-decoration: underline;
}
a.class1:hover {
    color: rgb(255, 255, 218);
    text-decoration: underline;
}
a:hover {
    color: rgb(255, 255, 218);
    text-decoration: underline;
}
#widget1 a {
    color: rgb(255, 234, 173);
    text-decoration: underline;
}
#widget0 a:hover {
    color: rgb(255, 255, 218);
    text-decoration: underline;
}
#widget1 a:hover {
    color: rgb(255, 255, 218);
    text-decoration: underline;
    z-index: 1;
}
#widget0 a:visited {
    color: rgb(241, 231, 191);
    text-decoration: underline;
}
#widget0 a {
    color: rgb(255, 234, 173);
    text-decoration: underline;
}
#widget1 a:visited {
    color: rgb(241, 231, 191);
    text-decoration: underline;
}
.spacer {
    font-size: 1px;
    line-height: 1px;
}
.bumper {
    font-size: 1px;
    line-height: 1px;
}
body { 
    -webkit-text-size-adjust: none;
}
div { 
    overflow: visible; 
}
img { 
    border: none; 
}
.InlineBlock { 
    display: inline; 
}
.InlineBlock { 
    display: inline-block; 
}
.inline-block {
    display: inline-block;
    vertical-align: baseline;
    margin-bottom:0.3em;
}
.inline-block.shape-with-text {
    vertical-align: bottom;
}
.vertical-align-middle-middlebox {
    display: table;
}
.vertical-align-middle-innerbox {
    display: table-cell;
    vertical-align: middle;
}
div.paragraph {
    position: relative;
}
li.full-width {
    width: 100;
}

.alpha60 {
    /* Fallback for web browsers that doesn't support RGBa */
    background: rgb(0, 0, 0);
    /* RGBa with 0.6 opacity */
    background: rgba(0, 0, 0, 0.6);
}

#cssmenu ul { margin: 0; padding: 0;}
#cssmenu li { margin: 0; padding: 0;}
#cssmenu a { margin: 0; padding: 0;}
#cssmenu a:visited { margin: 0; padding: 0;}
#cssmenu ul {list-style: none;}
#cssmenu a {text-decoration: none;}
#cssmenu a:visited {text-decoration: none;}
#cssmenu {height: 70px; background-color: transparent; /*box-shadow: 0px 2px 3px rgba(0,0,0,.4);*/}

#cssmenu > ul > li {
    float: left;
    margin-left: 15px;
    position: relative;
}

#cssmenu > ul > li > a {
    color: rgb(242,234,200);
    font-family: 'Oswald';
    font-size: 24px;
    text-decoration: none;
    line-height: 70px;
    padding: 15px 20px;
-webkit-transition: color .15s;
   -moz-transition: color .15s;
     -o-transition: color .15s;
        transition: color .15s;
}

#cssmenu > ul > li > a:visited {
    color: rgb(242,234,200);
    font-family: 'Oswald';
    font-size: 24px;
    text-decoration: none;
    line-height: 70px;
    padding: 15px 20px;
-webkit-transition: color .15s;
   -moz-transition: color .15s;
     -o-transition: color .15s;
        transition: color .15s;
}

#cssmenu > ul > li > a:hover {color: rgb(255,255,221); text-decoration: none;}

#cssmenu > ul > li > ul {
    opacity: 0;
    visibility: hidden;
    padding: 16px 0 20px 0;
    background-color: rgb(242,234,200);
    text-align: left;
    position: absolute;
    top: 55px;
    left: 50%;
    margin-left: -90px;
    width: 180px;
-webkit-transition: all .3s .1s;
   -moz-transition: all .3s .1s;
     -o-transition: all .3s .1s;
        transition: all .3s .1s;
-webkit-border-radius: 5px;
   -moz-border-radius: 5px;
        border-radius: 5px;
-webkit-box-shadow: 0px 1px 3px rgba(0,0,0,.4);
   -moz-box-shadow: 0px 1px 3px rgba(0,0,0,.4);
        box-shadow: 0px 1px 3px rgba(0,0,0,.4);
}

#cssmenu > ul > li:hover > ul {
    opacity: 1;
    top: 65px;
    visibility: visible;
}

#cssmenu > ul > li > ul:before{
    content: '';
    display: block;
    border-color: transparent transparent rgb(242,234,200) transparent;
    border-style: solid;
    border-width: 10px;
    position: absolute;
    top: -20px;
    left: 50%;
    margin-left: -10px;
}

#cssmenu > ul ul > li { position: relative;}

#cssmenu ul ul a {
    color: rgb(50,50,50);
    text-decoration: none;
    font-family: 'Oswald';
    font-size: 24px;
    background-color: rgb(242,234,200);
    padding: 5px 8px 7px 16px;
    display: block;
-webkit-transition: background-color .1s;
   -moz-transition: background-color .1s;
     -o-transition: background-color .1s;
        transition: background-color .1s;
}

#cssmenu ul ul a:visited {
    color: rgb(50,50,50);
    text-decoration: none;
    font-family: 'Oswald';
    font-size: 24px;
    background-color: rgb(242,234,200);
    padding: 5px 8px 7px 16px;
    display: block;
-webkit-transition: background-color .1s;
   -moz-transition: background-color .1s;
     -o-transition: background-color .1s;
        transition: background-color .1s;
}

#cssmenu ul ul a:hover {background-color: rgb(255,255,221);}

#cssmenu ul ul ul {
    visibility: hidden;
    opacity: 0;
    position: absolute;
    top: -16px;
    left: 206px;
    padding: 16px 0 20px 0;
    background-color: rgb(242,234,200);
    text-align: left;
    width: 160px;
-webkit-transition: all .3s;
   -moz-transition: all .3s;
     -o-transition: all .3s;
        transition: all .3s;
-webkit-border-radius: 5px;
   -moz-border-radius: 5px;
        border-radius: 5px;
-webkit-box-shadow: 0px 1px 3px rgba(0,0,0,.4);
   -moz-box-shadow: 0px 1px 3px rgba(0,0,0,.4);
        box-shadow: 0px 1px 3px rgba(0,0,0,.4);
}

#cssmenu ul ul > li:hover > ul { opacity: 1; left: 196px; visibility: visible;}

#cssmenu ul ul a:hover{
    text-decoration: none;
    background-color: rgb(0,34,60);
    color: rgb(242,234,200);
} 
```

如果有人在 Lion 上使用 Safari 6，请告诉我您是否遇到了我所描述的行为。即使我正在清空我的缓存，我也很难相信我所看到的......</p>

谢谢，罗伯

更新：Vish 认为它可能是其中一种 javascript，所以我尝试注释掉链接到它的标题中的链接，并且菜单开始在最新版本的 Safari 中工作！问题是：为什么？（和）永久删除脚本的链接可能会破坏什么？这是似乎是罪魁祸首的脚本：

```
// Created by iWeb 3.0.4 local-build-20130210

setTransparentGifURL('Media/transparent.gif');function applyEffects()
{var registry=IWCreateEffectRegistry();registry.registerEffects({stroke_0:new IWEmptyStroke(),shadow_0:new IWShadow({blurRadius:0,offset:new IWPoint(-2.1213,2.1213),color:'#000000',opacity:0.350000}),shadow_1:new IWShadow({blurRadius:0,offset:new IWPoint(-2.1213,2.1213),color:'#000000',opacity:0.350000})});registry.applyEffects();}
function hostedOnDM()
{return false;}
function onPageLoad()
{loadMozillaCSS('About_files/AboutMoz.css')
adjustLineHeightIfTooBig('id2');adjustFontSizeIfTooBig('id2');detectBrowser();adjustLineHeightIfTooBig('id3');adjustFontSizeIfTooBig('id3');fixAllIEPNGs('Media/transparent.gif');fixupIECSS3Opacity('id1');fixupAllIEPNGBGs();IMpreload('About_files','shapeimage_3','0');Widget.onload();applyEffects()}
function onPageUnload()
{Widget.onunload();} 
```

好吧，我发现它特别是“applyEffects()”函数调用。有谁知道这应该管理什么，所以当我把它拿出来时我知道我在做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:09:40.963

我不确定您在 Safari 6 中到底指的是什么行为。我在 Safari 中打开了上面的 html 文件，页面加载后，我看到鼠标悬停有延迟。我只在 Safari 中看到这种延迟。在仔细检查了您的 html 和 css 之后，我发现问题与以下代码行有关。

```
#cssmenu > ul > li > ul {
opacity: 0;
visibility: hidden; 
```

当同时使用不透明度和可见性时，您必须小心，因为不透明度会延迟渲染元素，不透明度从 0 到 100% 可能需要几毫秒的延迟。另一方面，下拉菜单的可见性会立即改变，就像显示开/关开关一样。我建议您禁用一个或查看脚本文件以添加超时以抵消可见性延迟。

# properties - 经典 ASP - 将属性作为 byref 传递

> ID：14790762
> 
> 赞同：3
> 
> 时间：2013-02-09T19:40:08.427
> 
> 标签：properties, asp-classic, pass-by-reference, byref

在经典 ASP 中，我有一个对象，称之为`bob`. 然后，它有一个名为`name`、`let`和`get`方法的属性。

我有一个功能如下：

```
sub append(byref a, b)
    a = a & b
end sub 
```

这只是为了更快地将文本添加到变量中。我也有同样的for `prepend`，就是这样`a = b & a`。我知道说起来很简单`bob.name = bob.name & "andy"`，但是我尝试使用上述功能，但它们都不起作用。

我叫它的方式是`append bob.name, "andy"`。谁能看到这有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T08:40:36.523

不幸的是，这是 VBScript 的一个特性。它记录在“类中的参数”下的[http://msdn.microsoft.com/en-us/library/ee478101(v=vs.84).aspx](http://msdn.microsoft.com/en-us/library/ee478101(v=vs.84).aspx)中。另一种方法是使用函数。这是一个说明差异的示例。您可以使用“cscript filename.vbs”从命令行运行它。

```
sub append (a, b)
   a = a & b
end sub

function Appendix(a, b)
   Appendix = a & b
end function

class ClsAA
   dim m_b
   dim m_a
end class
dim x(20)

a = "alpha"
b = "beta"
wscript.echo "variable works in both cases"
append a, b
wscript.echo "sub " & a
a = appendix(a, b)
wscript.echo "function " & a

x(10) = "delta"
wscript.echo "array works in both cases"
append x(10), b
wscript.echo "sub " & x(10)
x(10) = appendix( x(10), b)
wscript.echo "function " & x(10)

set objAA = new ClsAA
objAA.m_a = "gamma"
wscript.echo "Member only works in a function"
append objAA.m_a, b
wscript.echo "sub " & objAA.m_a
objAA.m_a = appendix(objAA.m_a, b)
wscript.echo "function " & objAA.m_a 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T21:40:23.750

您是否尝试过使用关键字`CALL`：

```
call append (bob.name, "andy") 
```

经典的 ASP 对 ByRef 和 ByVal 很敏感。默认情况下，它使用 ByRef - 没有理由指定它。如果你调用一个带括号的函数（没有调用），它会将变量作为 ByVal 传递。

或者，您可以通过以下方式完成相同的操作：

```
function append(byref a, b)
    append = a & b
end sub

bob.name = append(bob.name, "andy"); 
```

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T11:47:31.000

正如[其他答案](https://stackoverflow.com/a/14796040/447356)正确指出的那样，您正面临语言本身的限制。

据我所知，实现您所追求的唯一其他选择是将这样的子例程添加到类本身：

```
Public Sub Append(propName, strValue)
    Dim curValue, newValue
    curValue = Eval("Me." & propName)
    newValue = curValue & strValue
    Execute("Me." & propName & " = """ & Replace(newValue, """", """""") & """")
End Sub 
```

然后使用它：

```
bob.Append "name", "andy" 
```

不太优雅，但工作。

# mongodb - 如何使用 sort 索引 $or 查询

> ID：14790770
> 
> 赞同：6
> 
> 时间：2013-02-09T19:40:41.267
> 
> 标签：mongodb

假设我有一个看起来像这样的查询：

```
db.things.find({
  deleted: false,
  type: 'thing',
  $or: [{
    'creator._id': someid
  }, {
    'parent._id': someid
  }, {
    'somerelation._id': someid
  }]
}).sort({
  'date.created': -1
}) 
```

也就是说，我想找到满足这三个条件之一的文档并按最新排序。但是，$or 查询在与排序一起使用时不会并行使用索引。因此，我将如何索引这个查询？

[http://docs.mongodb.org/manual/core/indexes/#index-behaviors-and-limitations](http://docs.mongodb.org/manual/core/indexes/#index-behaviors-and-limitations)

您可以假设以下选择性：

*   `deleted`- 99%
*   `type`- 25%
*   `creator._id`, `parent._id`, `somerelation._id`- < 1%

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T18:47:15.580

现在您将需要多个索引来执行此查询；毫无疑问。

问题是*什么索引*？

现在您必须考虑到，由于 MongoDB 查询优化器中的错误，您的任何人都无法使用索引以最佳方式对数据进行基本排序： [https](https://jira.mongodb.org/browse/SERVER-1205)`$or` ://jira.mongodb.org/browse/SERVER- [1205](https://jira.mongodb.org/browse/SERVER-1205) .

所以你知道`$or`排序会有一些性能问题，并且将排序字段放入`$or`子句索引是无用的atm。

因此，考虑到这一点，您想要的第一个索引是涵盖您正在执行的基本查询的索引。正如@Leonid 所说，您可以将其制成复合索引，但是，我不会按照他的顺序进行操作。相反，我会这样做：

```
db.col.ensureIndex({type:-1,deleted:-1,date.created:-1}) 
```

`deleted`由于其超低的选择性，我完全不确定该字段是否在索引中；事实上，它可以在索引中而不是被取出来创建一个性能较低的操作（对于大多数数据库，包括 SQL 来说都是如此）。这部分需要您进行测试；也许该字段应该是最后一个（？）。

至于索引的顺序，我也只是猜到了。我已经对所有字段说了 DESC，因为您的排序是 DESC，但是您需要`explain`自己在这里进行。

这样应该能够处理查询的主子句。现在来处理那些`$or`s。

每个都`$or`将单独使用一个索引，MongoDB 查询优化器也会为它们单独查找索引，就好像它们完全是单独的查询一样，所以这里值得注意的是关于复合索引的一些问题（[http://docs.mongodb.org /manual/core/indexes/#compound-indexes](http://docs.mongodb.org/manual/core/indexes/#compound-indexes)）是它们在前缀上工作（这里的示例注释：http: [//docs.mongodb.org/manual/core/indexes/#id5](http://docs.mongodb.org/manual/core/indexes/#id5)）所以你不能做一个单个复合索引覆盖所有三个子句，因此在`$or`（考虑到上面的错误）上声明索引的更优化方法是：

```
db.col.ensureindex({creator._id:1});
db.col.ensureindex({aprent._id:1});
db.col.ensureindex({somrelation._id:1}); 
```

它应该能够让您开始为您的查询创建最佳索引。

但是，我应该强调，您需要自己进行测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T11:35:43.427

~~Mongodb 每次查询只能使用一个索引，所以~~我看不到`someid`在您的模型中使用索引进行查询的方法。

因此，最好的方法是为此任务添加特殊字段：

```
ids = [creator._id, parent._id, somerelation._id] 
```

在这种情况下，您将能够在不使用`$or`运算符的情况下进行查询：

```
db.things.find({
  deleted: false,
  type: 'thing',
  ids: someid
}).sort({
  'date.created': -1
}) 
```

在这种情况下，您的索引将如下所示：

```
{deleted:1, type:1, ids:1, 'date.created': -1} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T17:51:44.730

如果您可以灵活地调整架构，我建议添加一个新字段 associatedIds : [ ] 它将包含 creator._id、parent._id、一些关系._id - 您可以在更新主要对应字段时自动更新该字段，但现在您可以在此字段、type 和 created_date 上创建一个复合索引，这完全消除了查询中对 $or 的需要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T06:53:14.350

考虑到您对 indexing 的要求，我建议您在 $or 查询旁边使用 $orderBy 运算符。我的意思是您应该能够在 $or 查询中使用的 $or 表达式中对条件进行索引，然后您可以 $orderBy 对结果进行排序。

例如：

```
db.things.find({
         deleted: false,
         type: 'thing',
         $or: [{
               'creator._id': someid
              }, {
          'parent._id': someid
          }, {
          'somerelation._id': someid
          }]
        },{$orderBy:{'date.created': -1}}) 
```

上面的查询需要在 $or 表达式中的每个字段上加上在 orderBy 条件中指定的排序对象的复合索引。

例如：

```
db.things.ensureIndex{'parent._id': 1,"date.created":-1}
and so on for other fields. 
```

为结果指定“限制”以防止 mongodb 执行大量内存排序是一个很好的做法。在此处阅读有关[$orderBy 运算符的更多信息](http://docs.mongodb.org/manual/reference/operator/orderby/)

# php - 如何将多件商品发送到 FBA 亚马逊 createFulfillmentOrder

> ID：14790771
> 
> 赞同：0
> 
> 时间：2013-02-09T19:40:45.247
> 
> 标签：php, amazon-web-services

我想请求亚马逊将商品从卖家的库存运送到目的地地址。我正在使用 Amazon createFulfillmentOrder 进行操作。下面是我的代码，对于一个项目，它工作正常，但是当我们在一个订单中有多个项目时，我不确定如何使用它。请帮忙。

```
 $item = new FBAOutboundServiceMWS_Model_CreateFulfillmentOrderItem();
 //Set item parameters
 $item-> setSellerSKU("XX-XXX-XX-XX");
 $item-> setSellerFulfillmentOrderItemId("XX");                 
 $item-> setQuantity("XX");

 $obOrderItemList =new FBAOutboundServiceMWS_Model_CreateFulfillmentOrderItemList();
 $obOrderItemList->setmember($item);

 $request->setItems($obOrderItemList) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-01T16:57:19.060

**多个项目**

```
$obOrderItemList =new FBAOutboundServiceMWS_Model_CreateFulfillmentOrderItemList();
foreach($itemsArray as $key=>$val) {    
    $item = new FBAOutboundServiceMWS_Model_CreateFulfillmentOrderItem();
    //Set item parameters
    $item-> setSellerSKU($val['SKU']); //sku            
    $item-> setSellerFulfillmentOrderItemId("mws-".$val['id']); //unique id             
    $item-> setQuantity($val['item_quantity']); //item quantity                     
    $obOrderItemList->withmember($item);
}                   
$request->setItems($obOrderItemList); 
```

**单项**

```
$item = new FBAOutboundServiceMWS_Model_CreateFulfillmentOrderItem();
//Set item parameters
$item-> setSellerSKU($itemSKU);
$item-> setSellerFulfillmentOrderItemId($uniqueItemId);                 
$item-> setQuantity($item_quantity);
$obOrderItemList =new FBAOutboundServiceMWS_Model_CreateFulfillmentOrderItemList();                 
$obOrderItemList->setmember($item);
$request->setItems($obOrderItemList); 
```

# jquery - 同位素中心曼索里

> ID：14790772
> 
> 赞同：0
> 
> 时间：2013-02-09T19:40:54.847
> 
> 标签：jquery, jquery-plugins, jquery-masonry, jquery-isotope

有人能帮我把这个同位素合并到中心吗

```
jQuery.noConflict();
(function($) {
    $(function() {
        var resizeTimer = null;
        jQuery(window).bind('load resize', function() {
            if (resizeTimer) clearTimeout(resizeTimer);
            resizeTimer = setTimeout("tz_init("+"350)", 100);
        });

        var $container = $('#container'),
            $body = $('body'),
            colW = 0,
            columns = null;

        $container.imagesLoaded( function(){
            $container.isotope({
                itemSelector : '.element',
                layoutMode: 'masonry',
                resizable: true,
                masonry: {
                    columnWidth: colW
                }
            });
            tz_init(350);
        });
         jQuery(document).ready(function(){
             jQuery.callFunction("tz_init(358)");
         });
    });
})(jQuery);

//FILTERING
function loadPortfolio(){
    var $optionSets = $('#options .option-set'),
    $optionLinks = $optionSets.find('a');
    $optionLinks.click(function(event){
        event.preventDefault();
        var $this = $(this);
        // don't proceed if already selected
        if ( $this.hasClass('selected') ) {
            return false;
        }
        var $optionSet = $this.parents('.option-set');
        $optionSet.find('.selected').removeClass('selected');
        $this.addClass('selected');

        // make option object dynamically, i.e. { filter: '.my-filter-class' }
        var options = {},
        key = $optionSet.attr('data-option-key'),
        value = $this.attr('data-option-value');
        // parse 'false' as false boolean

        value = value === 'false' ? false : value;
        options[ key ] = value;
        if ( key === 'layoutMode' && typeof changeLayoutMode === 'function' ) {
            // changes in layout modes need extra logic
            changeLayoutMode( $this, options )
        } else {
            // otherwise, apply new options
            $container.isotope( options );
        }

        return false;
    });
}

loadPortfolio(); 
```

与网站上的那个？

[http://isotope.metafizzy.co/custom-layout-modes/centered-masonry.html](http://isotope.metafizzy.co/custom-layout-modes/centered-masonry.html)

我不太擅长 jquery，它给我带来了问题，据我所见，我网站上的同位素在没有 jQuery.noConflict 的情况下不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-12T18:56:14.160

我用它来居中：

```
 $.Isotope.prototype._getCenteredMasonryColumns = function() {
    this.width = this.element.width();

    var parentWidth = this.element.parent().width();

                  // i.e. options.masonry && options.masonry.columnWidth
    var colW = this.options.masonry && this.options.masonry.columnWidth ||
                  // or use the size of the first item
                  this.$filteredAtoms.outerWidth(true) ||
                  // if there's no items, use size of container
                  parentWidth;

    var cols = Math.floor( parentWidth / colW );
    cols = Math.max( cols, 1 );

    // i.e. this.masonry.cols = ....
    this.masonry.cols = cols;
    // i.e. this.masonry.columnWidth = ...
    this.masonry.columnWidth = colW;
};

    $.Isotope.prototype._masonryReset = function() {
    // layout-specific props
    this.masonry = {};
    // FIXME shouldn't have to call this again
    this._getCenteredMasonryColumns();
    var i = this.masonry.cols;
    this.masonry.colYs = [];
    while (i--) {
      this.masonry.colYs.push( 0 );
    }
};

    $.Isotope.prototype._masonryResizeChanged = function() {
    var prevColCount = this.masonry.cols;
    // get updated colCount
    this._getCenteredMasonryColumns();
    return ( this.masonry.cols !== prevColCount );
};

    $.Isotope.prototype._masonryGetContainerSize = function() {
    var unusedCols = 0,
        i = this.masonry.cols;
    // count unused columns
    while ( --i ) {
      if ( this.masonry.colYs[i] !== 0 ) {
        break;
      }
      unusedCols++;
    }

    return {
          height : Math.max.apply( Math, this.masonry.colYs ),
          // fit container to columns that have been used;
          width : (this.masonry.cols - unusedCols) * this.masonry.columnWidth
    };
}; 
```

# php - 不明白为什么 if 语句没有 {}

> ID：14790778
> 
> 赞同：3
> 
> 时间：2013-02-09T19:41:12.367
> 
> 标签：php, if-statement, conditional

我在 wordpress 的函数中有以下行，但`if(empty($paged)) $paged = 1;`我不明白为什么它没有开头`{`和结尾`}`。是自开自闭，不知道是不是一个名词

这是我正在使用的功能

```
<?php
function kriesi_pagination($pages = '', $range = 2)
{  
     $showitems = ($range * 2)+1;  

     global $paged;
     if(empty($paged)) $paged = 1;

     if($pages == '')
     {
         global $wp_query;
         $pages = $wp_query->max_num_pages;
         if(!$pages)
         {
             $pages = 1;
         }
     }   

     if(1 != $pages)
     {
         echo "<div class='pagination'>";
         if($paged > 2 && $paged > $range+1 && $showitems < $pages) echo "<a href='".get_pagenum_link(1)."'>&laquo;</a>";
         if($paged > 1 && $showitems < $pages) echo "<a href='".get_pagenum_link($paged - 1)."'>&lsaquo;</a>";

         for ($i=1; $i <= $pages; $i++)
         {
             if (1 != $pages &&( !($i >= $paged+$range+1 || $i <= $paged-$range-1) || $pages <= $showitems ))
             {
                 echo ($paged == $i)? "<span class='current'>".$i."</span>":"<a href='".get_pagenum_link($i)."' class='inactive' >".$i."</a>";
             }
         }

         if ($paged < $pages && $showitems < $pages) echo "<a href='".get_pagenum_link($paged + 1)."'>&rsaquo;</a>";  
         if ($paged < $pages-1 &&  $paged+$range-1 < $pages && $showitems < $pages) echo "<a href='".get_pagenum_link($pages)."'>&raquo;</a>";
         echo "</div>\n";
     }
}

?> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-09T19:46:18.253

如果要在`if`条件之后运行的代码只有一行，则可以省略括号。我觉得它令人困惑，所以我不这样做，但[它是有效的 PHP](http://php.net/manual/en/control-structures.if.php)。

因此，您的代码的作用是：

```
if(empty($paged)) $paged = 1; 
```

也可以这样：

```
if(empty($paged)) 
    $paged = 1; // semi-colon marks the end of the line 
```

这不会：

```
if(empty($paged)) $paged = 1; $othervar = 2; 
```

这也不会：

```
if(empty($paged)) 
   $paged = 1; 
   $othervar = 2; 
```

`$othervar`，在这两种情况下，都会在条件之外“执行”——即，它总是设置为 2。

这里还有另一个线程：[PHP - If/else, for, foreach, while - without curly括号？](https://stackoverflow.com/questions/8726339/php-if-else-for-foreach-while-without-curly-braces)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T21:01:44.497

一个答案已经被接受，但如果有人想要更多关于陈述的细节，

最简单的`if`语句形式如下（不带`else`或`elseif`列表）：

```
if (*表达式*)
    *语句*

```

*表达式*相当简单：任何计算出某个值的东西都是一个表达式。表达式的示例包括：赋值 ( `$x = 2`)、函数调用 ( `f(123)`)，甚至常量值 ( `123`)。请注意，`;`表达式的末尾没有。

## 声明

要理解的关键是什么是*语句*。根据您的描述，您希望语句是一些用大括号括起来的代码，例如

```
{ 
    $x = 2; 
    $y = 123;
    // Other statements
} 
```

但是，这只是一种类型的语句，称为*复合语句*或*块语句*。复合语句由一个`{`，后跟一个语句列表，然后是一个终止组成`}`。顺便说一句，由于复合语句也是语句，因此您可以将复合语句嵌套在复合语句中，但您通常不会单独看到复合语句（它们通常附加到其他语句，例如`if`和`while`语句的主体）。

### 表达式语句

请注意，`$x = 2;`and`$y = 123;`也是语句！这些类型的语句称为*表达式语句*，定义为表达式后跟一个`;`. 使用上面的表达式示例，以下是有效的表达式语句：

```
$x = 2;
f(123);
3; // This is a fairly useless statement, but yes, it counts as one 
```

在任何可以使用语句的地方，都可以使用复合语句或表达式语句。

### 其他类型的语句

您可能已经熟悉了其他类型的语句：

*   `while`/`do`
*   `for`/`foreach`
*   `switch`
*   `break`
*   `continue`
*   `return`
*   `if`
*   ...和更多

在任何可以使用语句的地方，您也可以使用上述之一。或者，您可以使用包含它们的某种组合的复合语句。所以回到原来的`if`语句示例，以下都是有效的，因为该`if`语句后面跟着另一个语句：

```
if (123)         // If statement
    $x = 3;      // Expression statement

if ($a == $b)    // If statement
{                // Beginning of compound statement
    $z = 1;      // Expression statement
    {            // Beginning of compound statement
        5;       // Expression statement
    }            // End of compound statement
}                // End of compound statement

if ($z)          // If statement
    while (true) // While statement
        break;   // Break statement

if ($a)          // If statement
    if ($b)      // If statement
        if ($c)  // If statement
        {        // Beginning of compound statement
            f(); // Expression statement
        }        // End of compound statement 
```

请注意，其中一些风格不好或没有做任何有用的事情，但仍然有效，因为归根结底，它们都只是陈述。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T19:44:00.577

只是说如果全局变量 $paged 为空，则将其设置为默认值：1。

有时您不需要放置开始和结束 {}，当 if 的操作将只有一行或一行时，例如 for、while 等，括号不是强制性的。

所以这些例子是有效的：

```
if(condition) one line; 

if(condition) 
    while {
        //several lines; 
    } 
```

无论如何，我真的认为省略“大括号”是一种不好的做法，你可以在[这里](https://stackoverflow.com/questions/359732/why-is-it-considered-a-bad-practice-to-omit-curly-braces)找到答案。

# subdomain - 如何从链接到主域的谷歌索引中删除子域

> ID：14790779
> 
> 赞同：2
> 
> 时间：2013-02-09T19:41:15.727
> 
> 标签：subdomain, cdn, google-index

谁能告诉我如何从链接到主域的谷歌索引中删除子域。

假设我的域是 www.myweb.com，我的子域是 cdn.myweb.com。现在这里子域的文档根与主域相同。所以我不能使用robot.txt 来停止谷歌索引，因为它也会删除主域链接的索引。

我也在 google、bing 和 stackoverflow 上搜索，但我找不到这个问题的完美答案。有没有从你这边解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T12:25:46.877

为此，您可以使用动态 robots.txt。像这样的东西...

httpd.conf (.htaccess):

```
RewriteRule /robots\.txt$ /var/www/myweb/robots.php 
```

机器人.php：

```
<?php
header('Content-type: text/plain');

if($_SERVER['HTTP_HOST']=='cdn.myweb.com'){ 
    echo "User-agent: *\n";
    echo "Disallow: /\n";
}else{              
    include("./robots.txt");    
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T11:25:52.227

我正在使用 nginx，并且在同一个服务器块中有多个子域。我希望将*www*子域包含在 google 的索引中，并将其余子域排除在外。

首先，在我的 nginx 配置的服务器块中，我添加了以下内容以根据域在 /robots.txt 提供 2 个不同的文件。

```
location ~ /robots.txt {
    if ($host = 'www.example.com') {
      rewrite ^/robots\.txt /robots.www.txt last;
    }
  } 
```

然后在我网站的根目录下，有以下2个文件：

*   **robots.txt**阻止抓取，是所有子域的默认设置

```
# Do not crawl subdomain
User-Agent: *
Disallow: / 
```

*   **robots.www.txt**允许抓取所有网站，并且仅在*www.example.com/robots.txt提供*

```
User-agent: *
Disallow: 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-09T22:12:37.277

首先是添加 robots.txt，但在我的情况下，因为我的页面已经被 CDN 子域编入索引，所以对于机器人来说为时已晚。我发现最好的方法是转到 Google 网站管理员工具，添加我的 cdn 域 ( *cdn.mysite.com* )。然后转到 Google index -> Remove URLs 并删除**/** url。过了几天才生效。

# c# - 为什么我的正则表达式无法匹配电子邮件？

> ID：14790780
> 
> 赞同：0
> 
> 时间：2013-02-09T19:41:20.583
> 
> 标签：c#, regex

我必须按照代码验证电子邮件地址

```
 var reg = new Regex(@"/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/");

 string e1 = "name@host.net";
 string e2 = "namehost.net";

 bool b1 = reg.IsMatch(e1);
 bool b2 = reg.IsMatch(e2); 
```

但**b1**和**b2**都失败了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T19:43:06.430

删除开头和结尾的斜线。

```
var reg = new Regex(@"^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$"); 
```

但是，话虽如此，您的正则表达式并不是匹配电子邮件地址的好模式。事实上，准确的图案确实很难制作。谷歌一些，你应该找到更好的。

# mysql - SQL查询故障：“组函数的使用无效”

> ID：14790781
> 
> 赞同：1
> 
> 时间：2013-02-09T19:41:30.110
> 
> 标签：mysql, join, group-by

注意：我知道查询不完整，我正在尝试一次将其拼凑起来。我此时遇到了错误

基本上，我收到了 MySQL 错误

> 组功能使用无效

我不知道为什么。

这是我正在查询的数据库的图表：

![图表](../Images/4cae233b6f847e27f45e7e90a13717a4.png)

问题说：

“显示出版商名称和出版书籍数量为那些出版过两本书的出版商。记录应该按出版书籍数量降序排列，然后是出版商名称升序排列。你的输出应该与给定的显示相匹配下方（包括列标题）。”

输出应该如下所示：

![输出](../Images/b47615c8e711623f8f09492cbcb77ca4.png)

这是我正在尝试的查询：

```
select publisher.name as "Publisher Name", count(book.isbn)
from publisher as "Book Count"
join book using (publisherID)
where count(book.isbn) > 2
group by publisher.name; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:01:20.070

尝试

```
SELECT MIN(p.name) AS `Publisher Name`, COUNT(b.isbn) AS `Book Count`
  FROM publisher AS p INNER JOIN 
       book      AS b ON p.PublisherID = b.PublisherID
GROUP BY p.publisherID
HAVING COUNT(b.isbn) > 2 
```

这是[sqlfiddle](http://sqlfiddle.com/#!2/93c77/13)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:57:50.410

2个问题：

1.  您已将别名添加到表中，而不是列中。

2.  你不能`COUNT`在一个`WHERE`条件下使用。你需要使用`HAVING`.

尝试以下操作：

```
SELECT
    publisher.name as `Publisher Name`,
    COUNT(book.isbn) as `Book Count`
FROM
    publisher 
JOIN
    book USING (publisherID)
GROUP BY
    publisher.name
HAVING
    `Book Count` > 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T18:36:21.680

您不能在 where 中使用 COUNT，而只能在 SELECT 中使用。尝试在组上使用 HAVING 和条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T19:52:57.960

问题出在你的`from`陈述中。正确的语法是：

```
select publisher.name as "Publisher Name", count(book.isbn)  as "Book Count"
from publisher join book
     using (publisherID)
group by publisher.name; 
```

   计数（book.isbn）> 2

你给`publisher`表一个别名`Book Count`，而不是计数。

# python - 使用 Python 可能对齐两个列表

> ID：14790782
> 
> 赞同：0
> 
> 时间：2013-02-09T19:41:43.597
> 
> 标签：python, string, list, alignment

我在两个不同的列表中有两个字符串，`A = [dog bit dog null]`并且`B = [hund bet hund]`. 我想从列表 B 到列表 A 中找到所有可能的对齐方式，例如：

```
 C =  [(hund = dog, bet = bit, hund = dog),
        (hund = dog, bet = bit, hund = bit),
        (hund = dog, bet = bit, hund = null),
        (hund = dog, bet = dog, hund = dog),
        (hund = dog, bet = dog, hund = bit),
        etc.. ] 
```

我认为这两个字符串之间有 64 种不同的对齐方式。我正在研究 IBM model1 的单词翻译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:13:08.583

如果你想要 64 种可能性，你可以使用`itertools.product`：

```
>>> from itertools import product
>>> A = "dog bit dog null".split()
>>> B = "hund bet hund".split()
>>> product(A, repeat=3)
<itertools.product object at 0x1148fd500>
>>> len(list(product(A, repeat=3)))
64
>>> list(product(A, repeat=3))[:5]
[('dog', 'dog', 'dog'), ('dog', 'dog', 'bit'), ('dog', 'dog', 'dog'), ('dog', 'dog', 'null'), ('dog', 'bit', 'dog')] 
```

但请注意，这将产生相当数量的重复，因为您有`dog`两次`A`：

```
>>> len(set(product(A, repeat=3)))
27 
```

如果你愿意，你甚至可以得到相关的三元组：

```
>>> trips = [zip(B, p) for p in product(A, repeat=len(B))]
>>> trips[:5]
[[('hund', 'dog'), ('bet', 'dog'), ('hund', 'dog')], [('hund', 'dog'), ('bet', 'dog'), ('hund', 'bit')], [('hund', 'dog'), ('bet', 'dog'), ('hund', 'dog')], [('hund', 'dog'), ('bet', 'dog'), ('hund', 'null')], [('hund', 'dog'), ('bet', 'bit'), ('hund', 'dog')]] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:09:10.757

```
[(i,j) for i in a for j in b] 
```

您不能在列表中拥有该结构，您需要一个字典，我在这里使用一个元组来关联这些值。

# controller - 子控制器未注入主控制器

> ID：14790785
> 
> 赞同：10
> 
> 时间：2013-02-09T19:42:22.053
> 
> 标签：controller, javafx-2, code-injection, fxml

我有一个 BorderPane（与 MainController 关联），BorderPane 的 FXML 用于将`<fx:include>`Label（带有控制器 StatusBarController）包含到 BorderPane 的底部区域。不幸的是，StatusBarController 没有注入 MainController 类实例，我不明白为什么。

*main.fxml：包含状态栏的 BorderPane*

```
<fx:root type="javafx.scene.layout.BorderPane" fx:id="borderPane" xmlns:fx="http://javafx.com/fxml" fx:controller="com.example.controllers.MainController">
  <bottom>
    <fx:include source="statusbar.fxml" />
  </bottom>
</fx:root> 
```

*statusbar.fxml：标签及其关联的控制器*

```
<Label fx:id="statusbar" text="A label simulating a status bar" xmlns:fx="http://javafx.com/fxml" fx:controller="com.example.controllers.StatusBarController" /> 
```

*带有 StatusBarController 字段的 MainController：*

```
public class MainController
{
    @FXML
    private StatusBarController statusbarController; // PROBLEM HERE: I would expect the StatusBarController to be injected but this does not happen!

    // Implementing Initializable Interface no longer required on JavaFX 2.2 according to
    // http://docs.oracle.com/javafx/2/fxml_get_started/whats_new2.htm
    // (I also tested this, the initialize() method is being called)
    @SuppressWarnings("unused") // only called by the FXMLLoader
    @FXML // This method is called by the FXMLLoader when initialization is complete
    private void initialize() {
        // initialize your logic here: all @FXML variables will have been injected
        assert borderPane != null : "fx:id=\"borderPane\" was not injected: check your FXML file 'main.fxml'.";
        System.out.println("MainController initialize()");

        //statusbarController.setStatusText("Hello from MainController"); // PROBLEM HERE: this fails because statusbarController is not injected as expected
    }
} 
```

*以及应用程序的开始：*

```
public void start(Stage primaryStage) 
    {       
        Parent root = null;

        try {
            root = FXMLLoader.load(getClass().getResource("/resources/main.fxml"));
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        primaryStage.setTitle("Demo");
        primaryStage.setScene(new Scene(root, 800, 600));
        primaryStage.show();
    } 
```

我的示例的完整源代码位于[http://codestefan.googlecode.com/svn/trunk/SubcontrollerAccess/](http://codestefan.googlecode.com/svn/trunk/SubcontrollerAccess/)

那么问题来了：为什么StatusBarController没有注入到MainController的statusbarController变量中呢？

感谢您的任何提示！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-09T23:34:32.530

要使用`@FXML`标签，您必须提供`fx:id`.

更新您的`main.fxml`：

```
<bottom>
    <fx:include fx:id="statusbar" source="statusbar.fxml" />
</bottom> 
```

之后，您可以在您的 : 中使用下一个常量`MainController.java`：

```
@FXML
Label statusbar; // node itself
@FXML
private StatusBarController statusbarController; // controller 
```

请注意，这`statusbarController`不是部分小写的类名，而是`fx:id`+`Controller`字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-24T13:25:34.703

netbeans 8.0 中似乎也存在嵌套 fxml 的错误。不能指望 netbeans 为您创建嵌套的 fxml 的控制器对象，它必须手动插入到您的 MainController 中。每次在 netbeans 中更新控制器时，它都会被清除，因此可能有点乏味。对于此示例，将插入

@FXML 私有状态栏控制器状态栏控制器；

在这种情况下手动连接到主控制器，然后它可以正常工作。对于组织大型 fxmls/控制器非常有用。

# java - 为什么我的循环方法越来越快？

> ID：14790796
> 
> 赞同：1
> 
> 时间：2013-02-09T19:43:15.043
> 
> 标签：java, queue

我正在尝试记录方法完成所需的时间。我最初是为整个方法计时，但数字似乎有点不对劲，所以我决定为每个人通过 for 循环计时。

奇怪的是，随着循环的进行，入队操作似乎每次都变得越来越快。q.enqueue() 的每次调用都将递增的字符串（“String1”、“String2”、....等）加入到链表队列中。

如果我让 num=100，每次通过大约需要 4,000 纳秒。但是，如果我将 num 增加到 100,000，我可以看到前几百次通过再次需要大约 4,000，但它们逐渐变得越来越快，最后一百左右是 316 纳秒或 0 纳秒。

我知道使用 nanotime 不会 100% 准确，但随着循环的进行，它显然会变得更快。

这里发生了什么事？

```
public static void enqueueLoop(int num, Queue q){       
    for (int i=0;i<num;i++){
        long start, enqueueTime;

        start = System.nanoTime();
        q.enqueue("String" + (i+1));
        qTime = System.nanoTime() - start;

        System.out.println("Enqueue Operation took: " + NumberFormat.getInstance().format(qTime) + " nanoseconds");     
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T19:45:18.893

JIT（即时编译器）在看到代码被大量重用后启动，并将其编译为本机代码。

# facebook - facebook 在发布时不会从我的博客页面中读 取任何 opengraph 标签

> ID：14790797
> 
> 赞同：0
> 
> 时间：2013-02-09T19:43:17.143
> 
> 标签：facebook, wordpress, facebook-graph-api, facebook-opengraph

我似乎无法让 facebook 识别我博客存档页面上的 opengraph 标签。每个存档博客文章似乎都有这个问题，但是主页工作正常。

请参阅此帖子作为示例：

[http://www.geekmagazine.org/2013/02/09/leatherman-skeletool-giveaway/](http://www.geekmagazine.org/2013/02/09/leatherman-skeletool-giveaway/)

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T17:24:06.623

根据[FB 的 Object Debugger](https://developers.facebook.com/tools/debug/og/object?q=http://www.geekinsider.com/2013/02/09/leatherman-skeletool-giveaway/)你有 2 个错误。

1.  **应该修复的类似按钮警告：** 缺少管理员和应用程序 ID：缺少 fb:admins 和 fb:app_id 标签。这些标签对于 Facebook 呈现产生高点击率的新闻提要故事是必要的。应该修复的开放图警告

2.  **og:image 应该更大：** 前提是 og:image 不够大。请使用至少 200x200 像素的图片。将使用图像“ [http://www.geekinsider.com/wp-content/uploads/2013/02/skeletool-fanned-602x1024.jpg ”。](http://www.geekinsider.com/wp-content/uploads/2013/02/skeletool-fanned-602x1024.jpg)

# java - 角度的模算术给出不正确的结果

> ID：14790798
> 
> 赞同：0
> 
> 时间：2013-02-09T19:43:24.277
> 
> 标签：java

我正在制作一个非常简单的 Java 程序，用于计算弹丸以不同的角度和速度发射时的行进距离。虽然在谈论发射角度时没有必要包括超过 180 度的角度，但我想知道为什么我的代码没有按照我期望的方式工作，特别是以下部分：

```
if((int)(angle / 180.0) % 2 != 0)
{
     myDataArray[i][j] = 0.0;
} 
```

如果角度是介于 180 和 360（不包括在内）之间的值，那么它应该满足条件，任何等效角度（例如 540 到 720 不包括在内）也应该满足条件。基本上，只要发射角进入地面，距离值应该为零。

代码的其余部分工作正常，但这部分的所有角度值都在 180 及以上，这意味着所有这些距离都为零。（这没有意义，因为 365 度发射角应该与 5 度发射角相同）。

我做错了什么，还是有其他条件可以用来获得预期的结果？

编辑：叹息....计算没有问题，我只是个白痴。我将角度增量器放在 else 语句中，这意味着对于 if 语句为 true 的第一个角度将用于程序的其余部分。这是我拥有的整个方法代码：

```
public void calcDistanceValues()
{
    double angleStart = myAngleDegrees;
    double speedStart = mySpeedMPH;

    for(int i = 0; i < myNumRows; i++)
    {
        for(int j = 0; j < myNumColumns; j++)
        {
            if((int)(myAngleDegrees / 180.0) % 2 != 0)
            {
                myDataArray[i][j] = 0.0;
            }
            else
            {
                myDataArray[i][j] = 5280 *  (Math.pow(mySpeedMPH,2)*Math.sin(2*Math.toRadians(myAngleDegrees))/78973);
                myAngleDegrees += myUnitIncrement; //the problem is here*
            }

        }            
        mySpeedMPH += myUnitIncrement;
        myAngleDegrees = angleStart;            
    }
    mySpeedMPH = speedStart;    
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T20:17:43.550

我认为测试是正确的，错误在于它的使用方式。我写了一个简单的测试程序来试试：

```
public class Test {

  public static void main(String[] args) {
    test(0);
    test(179);
    test(180);
    test(181.0001);
    test(359);
    test(360.0001);
    test(180+360);
  }

  private static void test(double angle){
    System.out.println("Raw angle: "+angle+" modded: "+modAngle(angle));
  }

  private static double modAngle(double angle) {
    if ((int) (angle / 180.0) % 2 != 0) {
      return 0;
    } else {
      return angle;
    }
  }
} 
```

结果是：

```
Raw angle: 0.0 modded: 0.0
Raw angle: 179.0 modded: 179.0
Raw angle: 180.0 modded: 0.0
Raw angle: 181.0001 modded: 0.0
Raw angle: 359.0 modded: 0.0
Raw angle: 360.0001 modded: 360.0001
Raw angle: 540.0 modded: 0.0 
```

如果我了解您的要求，它似乎正在工作。

# oop - 如何在类中的另一个函数中访问函数的变量？

> ID：14790799
> 
> 赞同：0
> 
> 时间：2013-02-09T19:43:24.090
> 
> 标签：oop

我是 OOP 新手，需要澄清一些概念。我有一个带有私有变量和两个简单​​函数的简单类。函数一将私有变量的值设置为 40。现在如何访问函数二中变量的值，使变量值为 40？

```
class MyClass { 

    //declaring private variable:
    private $var = '';

    function MyfuncOne(){
        $this->var = "40";
    }

    function MyfuncTwo(){
    }
} 
```

如何访问`$this->var`MyfuncOne() 中声明的 40 的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:46:49.250

在功能二中，您可以像这样访问它：

```
function MyFuncTwo() {
    print $this -> var; // Just access it, its a member variable of the same class
} 
```

该变量对于从此类继承的其他类是私有的（无法访问），但可以从其他成员函数完全访问。

***编辑默认构造函数*** 如果你想将值设置为 40 而不首先调用函数，你可能需要一个默认构造函数。

见： http: [//php.net/manual/en/language.oop5.decon.php](http://php.net/manual/en/language.oop5.decon.php)

简单地：

```
class MyClass {     
    //declaring private variable:
    private $var = '';

    // This is the default constructor, it gets called when you create the object
    function __construct() {
        $this -> var = "40";
    }

    function MyfuncOne(){
        $this->var = "40";
    }

    function MyfuncTwo(){
    }

    function get_var() {
        return $this -> var;
    }
} 
```

然后当你制作你的对象时，它将被设置为“40”：

```
$obj = new MyClass();
print "The object's var is " . $obj -> get_var(); // Notice we didn't have to call MyFuncOne(), it's just set. 
```

# jquery - Fancybox 2 对象没有方法错误

> ID：14790805
> 
> 赞同：0
> 
> 时间：2013-02-09T19:44:02.783
> 
> 标签：jquery, wordpress, fancybox

我在我的 wordpress 网站上使用了 fancybox 2，它工作的时间最长，但最近它在这个页面（以及其他使用 fancybox 的页面）上没有工作[http://haniabyanyacole.com/?page_id=110](http://haniabyanyacole.com/?page_id=110)

这是我得到的错误：**Uncaught TypeError: Object [object Object] has no method 'fancybox'**

我环顾了其他 stackoverflow 页面，发现其他人也有类似的问题，主要是处理加载的多个 jquery 库，但我只加载了一次，并且在页面顶部。任何人都可以帮忙吗？

**已解决：我最终加载了以前版本的 jquery（当插件仍然有效时）并且它修复了 fancybox**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:51:44.660

我快速[浏览了您的页面](http://haniabyanyacole.com/?page_id=110)。根据错误，看起来 Fancybox 只是被从这里加载的最新版本的 jQuery 破坏了......

[http://code.jquery.com/jquery-latest.js](http://code.jquery.com/jquery-latest.js)

这是使用包含`jquery-latest.js`...的 CDN 的缺点，您永远不会知道最新的 jQuery 版本何时会破坏一些不兼容的过时 jQuery 插件。

您必须弄清楚如何编辑您的 Wordpress 模板以仅加载与您的 Fancybox 兼容的 jQuery 的最新版本……可能是 1.8.3 版。

[http://code.jquery.com/jquery-1.8.3.min.js](http://code.jquery.com/jquery-1.8.3.min.js)

否则，请调查是否有可用于最新 jQuery 版本 1.9.1[的 Fancybox 更新版本。](http://www.fancyapps.com/fancybox/)（[根据这个 jsFiddle，它看起来已经像 Fancybox 2.1.4 与 jQuery 1.9.1 一起使用了](http://jsfiddle.net/hpfj8/)）

以下是所有过去版本的 jQuery 的链接，供您参考：

[http://code.jquery.com/#jquery-all](http://code.jquery.com/#jquery-all)

* * *

另请阅读以下链接中的“ **wp enqueue script** ”，因为您不想在同一页面上加载多个版本的 jQuery...

[http://codex.wordpress.org/Function_Reference/wp_enqueue_script](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)

# android - 音轨无法立即停止播放

> ID：14790806
> 
> 赞同：5
> 
> 时间：2013-02-09T19:44:06.177
> 
> 标签：android

开发人员文档说我必须调用 Pause() 然后 Flush()（用于丢弃播放数据）。

但这不起作用。

我发现如果我在 AudioTrack.Pause() 和 AudioTrack.Flush() 调用之间添加小的延迟。声音播放几乎立即停止，但有时它不起作用。

那么如何立即停止音轨呢？

# r - 在 r 中进行子选择和创建

> ID：14790808
> 
> 赞同：0
> 
> 时间：2013-02-09T19:44:23.913
> 
> 标签：r

假设这个数据集：

```
household_id person_id age_group  
1            1         5  
1            2         3  
1            3         2  
2            1         3  
2            2         5
2            3         1
2            4         1 
```

我想创建一个新字段，指示家庭是否包括任何 age_group=1 的人，如下所示：

```
household_id person_id age_group age_group1  
1            1         5         0  
1            2         3         0
1            3         2         0
2            1         3         1
2            2         5         1
2            3         1         1
2            4         1         1 
```

我感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T19:51:09.630

一个`plyr`解决方案：

```
require(plyr)
df <- structure(list(household_id = c(1L, 1L, 1L, 2L, 2L, 2L, 2L), 
person_id = c(1L, 2L, 3L, 1L, 2L, 3L, 4L), age_group = c(5L, 
3L, 2L, 3L, 5L, 1L, 1L)), .Names = c("household_id", "person_id", 
"age_group"), class = "data.frame", row.names = c(NA, -7L))

ddply(df, .(household_id), transform, age_group1 = 0 + any(age_group == 1))

#   household_id person_id age_group age_group1
# 1            1         1         5          0
# 2            1         2         3          0
# 3            1         3         2          0
# 4            2         1         3          1
# 5            2         2         5          1
# 6            2         3         1          1
# 7            2         4         1          1 
```

**编辑：** `data.table`替代：

```
require(data.table)
dt <- data.table(df, key="household_id")
dt[, age_group1 := 0 + any(age_group == 1), by=household_id] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T19:51:15.643

```
ave(t$age_group, t$household_id, FUN=function(x) 1 %in% x)
[1] 0 0 0 1 1 1 1

> t$age_group1 <- with(t, ave(age_group, household_id, FUN=function(x) 1 %in% x))
> t
  household_id person_id age_group age_group1
1            1         1         5          0
2            1         2         3          0
3            1         3         2          0
4            2         1         3          1
5            2         2         5          1
6            2         3         1          1
7            2         4         1          1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T19:49:20.410

读取您的数据后

```
dat <- read.table(text = 'household_id person_id age_group  
1            1         5  
1            2         3  
1            3         2  
2            1         3  
2            2         5
2            3         1
2            4         1',head=T) 
```

使用`transform`with `ave`（类似于 @Mathhew 解决方案）但使用更简洁的 sytnax

```
 transform(dat, age_group1  = ave(age_group, household_id, FUN=function(x) any(x==1)))

  household_id person_id age_group age_group1
1            1         1         5          0
2            1         2         3          0
3            1         3         2          0
4            2         1         3          1
5            2         2         5          1
6            2         3         1          1
7            2         4         1          1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-09T20:43:08.147

我更喜欢`sql`这种东西，因为很多人已经知道它，它可以跨语言工作（sas 有`proc sql;`），而且非常直观:)

```
# read your data into an object named `x`

# load the sqldf library
library(sqldf)

# create a new household-level table that contains just
# the household id and a 0/1 indicator of
# whether anyone within the household meets your requirement
households <- 
    sqldf( 'select household_id , max( age_group == 1 ) as age_group1 from x group by household_id' )

# merge the new column back on to the original table
x <- merge( x , households )

# view your result
x 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-09T23:27:17.777

这是另一个不涉及安装任何软件包的选项；）

```
# read your data frame into `x`
x <- read.table( text = "household_id person_id age_group  
1            1         5  
1            2         3  
1            3         2  
2            1         3  
2            2         5
2            3         1
2            4         1" , head=TRUE)

# determine the maximum of age_group == 1 within each household id
hhold <- aggregate( age_group == 1 ~ household_id , FUN = max , data = x )

# now just change the name of the second column
names( hhold )[ 2 ] <- 'age_group1'

# merge it back on and you're done
x <- merge( x , hhold )

# look at the result
x 
```

# php - 减少初始连接和 TTFB 时间

> ID：14790811
> 
> 赞同：3
> 
> 时间：2013-02-09T19:44:41.513
> 
> 标签：php, mysql, apache

类似问题：[这里](https://stackoverflow.com/questions/8539784/how-to-reduce-the-time-for-the-first-byte-on-my-website)

网站：[Cleanfiles PPD 网络](http://cleanfiles.net/)

```
Raw Server Link (Skip DNS): http://173.247.246.58/ 
```

瀑布视图（网页测试）： ![瀑布](../Images/d3a31eac8687b77e88bb99867d87426d.png)

我最近搬到了一个新的服务器。**所有 PHP 脚本和资源都保持不变**。新服务器是[Inmotion Elite 专用服务器](http://www.inmotionhosting.com/dedicated_servers/features.html)。

平均服务器负载：

```
Server load 1.25 (8 CPUs)   
Memory Used 14.14% (1,137,916 of 8,048,804) 
Swap Used   0% (0 of 4,095,992) 
```

作为网络所有者，拥有一个快速而漂亮的网站是重中之重。在浏览整个页面时，我不能让我的成员有 2-4 秒的随机等待时间。旧服务器从来没有这样做过，它加载得很好。

由于服务器负载似乎很好并且 PHP 脚本是相同的，我想假设它具有一些 Apache 设置或类似的东西。我真的说不出来。我尝试运行上面发布的问题的最佳答案中列出的两个脚本，但两者都有很长的等待时间......

我与托管公司进行了交谈，但他们并不真正知道发生了什么。对于这个问题或我能做的测试的任何帮助将不胜感激:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-06T12:24:18.070

可能最有效的解决方案是使用具有本机 HTML 缓存功能（静态和动态）的 CDN。TTFB 依赖于您在源服务器上快速处理 HTML 的能力，您可以通过从 CDN 提供新的缓存副本来完全跳过处理时间。

我最近写了一篇关于它的帖子，其中研究了 TTFB 延迟因素和不同资源的平均加载时间（基于跨 1B 会话收集的数据）。您可能会发现它很有用：http: [//www.incapsula.com/the-incapsula-blog/item/809-using-cdn-to-improve-seo-and-ttfb](http://www.incapsula.com/the-incapsula-blog/item/809-using-cdn-to-improve-seo-and-ttfb)

# qtp - DotNetFactory 可以访问哪些对象？

> ID：14790812
> 
> 赞同：0
> 
> 时间：2013-02-09T19:44:48.160
> 
> 标签：qtp

我想知道我可以使用 QTP DotNetFactory 对象访问哪些对象。是否有任何可访问对象的列表及其 API？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T22:47:43.593

qtp 帮助中提供了 DotNetFactory 对象和支持的方法。

如果没有，那么在 qtp 编辑器中，qtp 的智能感知将帮助您获取特定 .net 对象的方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T08:16:54.260

您应该能够使用 .NET 访问任何 .NET 对象`DotNetFactory`。

# mysql - 在数据库中存储内容编辑

> ID：14790815
> 
> 赞同：1
> 
> 时间：2013-02-09T19:45:09.880
> 
> 标签：mysql, database, structure

我想知道在 MySQL 数据库中存储内容编辑的最佳方式是什么？

我首先要做类似的事情`Current_COMMENT, First_COMMENT`，并将原始评论`first_COMMENT`和最新评论（我将显示的评论）存储在`Current_COMMENT`.

但后来我意识到存储每个推荐编辑会更好，这样我就可以回顾所有修订。

我的问题是，将其存储在数据库中的最佳方法是什么？如果我可以存储（几乎）无限量的评论修订，那就太好了。

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T19:48:13.800

使用列作为创建日期，因此您可以在需要时利用历史记录。对于最近的评论，用一个名为 的标志列进行标记`current`。一个简单的`int`就足够了：`1`对于当前的，`0`对于所有其他的。

# c# - 同一使用块内的多个变量

> ID：14790821
> 
> 赞同：5
> 
> 时间：2013-02-09T19:45:57.083
> 
> 标签：c#, dispose, idisposable, using, using-statement

我目前正在使用两个对象，如下所示：

```
using (var ms = new MemoryStream())
using (var bw = new BinaryWriter(ms))
{
    // work with ms and bw, both referenced here
} 
```

它工作“很好”，实际上[也是一个答案](https://stackoverflow.com/a/9396092)。但是，当我运行 VS2012 的代码分析工具时，会收到如下警告：

```
CA2202  Do not dispose objects multiple times   
Object 'ms' can be disposed more than once in method '<my method name>'. 
To avoid generating a System.ObjectDisposedException you should not 
call Dispose more than one time on an object. 
```

这让我相信可能有另一种方法来处理这种情况，但我不知道它是什么。

有谁知道`using`以无警告的方式在单个块中使用两个对象的“正确”方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:23:52.427

BinaryWriter 类的编写方式是，它会在您释放 BinaryWriter 时释放您传递给它的基础流，除非您使用可选的构造函数参数告诉它不要这样做。由于二进制写入器正在处理底层内存流，并且您也在`using`块中处理它，因此它被处理了两次。

现在，对于大多数类来说，这并不是一个真正的问题，因为它们应该（并且内存流被写入）如果被释放两次就可以正常工作，只要你在它被释放后不使用它（你不是）因此您可以放心地忽略该警告。如果您希望警告消失，您可以将内存流从使用中取出，因为它已经被处理掉了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T19:47:54.823

如果您不需要对`MemoryStream`this 的对象引用，则可以正常工作

```
using (var bw = new BinaryWriter(new MemoryStream()))
{
    var memStream = bw.BaseStream as MemoryStream;
} 
```

否则去多次使用。特别是在您使用 .NET 框架对象的情况下，因为它们是使用正确的处置模式实现的。

`using`当可能有第二个 dispose 调用的对象没有正确实现 dispose 模式时，双重语句可能会导致麻烦。

PS：您是否会以这种方式收到相同的警告：

```
using (var memStream = new MemoryStream())
{
    using (var bw = new BinaryWriter(memStream))
    {
        // work with ms and bw
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T20:21:54.437

您假设这是一个*单独*的using 块是不正确的。您示例中的代码是嵌套 using 块的语法糖，如下所示：

```
using (var ms = new MemoryStream())
{
   using (var bw = new BinaryWriter(ms)) 
   {
    // work with ms and bw, both referenced here
   }
} 
```

没有单一的方法可以正确地解决这个问题并避免警告。如果内部资源包装了外部资源并且它们都超出了范围，则需要查阅文档：如果合同规定内部资源的 dispose 方法调用了包装对象的 dispose，则根本不需要将外部资源放在 using 块中。

话虽如此，大多数文档中可能不会提及此类细节。您可以自己检查行为（通过继承和观察副作用），但您必须小心，因为首先它没有记录在案，这种行为可能会在未来的版本中发生变化。

所以如果你很担心的话，你可以留下双重 using 块（以防万一），抑制警告并将整个块`try{} catch (ObjectDisposedException e) {}`完全放在一个安全葫芦中。

听起来很偏执？取决于您使用的库:-)

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2013-02-09T20:06:26.840

我认为您不应该将“使用（...）{}”用于：

```
using (var ms = new MemoryStream()) 
```

因为操作系统管理内存并“处置”它！

# python - 使用 NumPy 进行快速傅立叶变换：为什么会这样？

> ID：14790822
> 
> 赞同：1
> 
> 时间：2013-02-09T19:45:58.847
> 
> 标签：python, numpy, fft

据我所知，快速傅里叶变换是离散傅里叶变换计算的快速方法。

我一直在玩 NumPy 数学库，这段代码也有这样的情节：

```
import numpy as np
from numpy.fft import fft, fftfreq
import matplotlib.pyplot as plt

t = np.arange(0, 10, step=0.001)
signal = np.sin(t) + np.sin(10*t)
sp = fft(signal)
freq = fftfreq(signal.size, d=0.001)
plt.plot(freq, sp)
plt.show() 
```

在我看来，它必须看起来就像 d(x-1) + d(x-10) ... // d 是 delta-function

（据我所知，离散傅里叶变换必须看起来像简单的傅里叶变换，但边缘倾斜）

但事实并非如此。它看起来像“d(x-0.1) + d(x-1.5) ...”，我想知道为什么。fftfreq 有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:32:40.990

学习这个已经很多年了...

您期望在 1 和 10 Hz（周期/秒）处看到峰值吗？然后你需要改变 sin 函数的参数。sin 采用弧度作为 arg。1 Hz 是 2*pi 弧度/秒，10 Hz 是 10*2*pi 弧度/秒

改变你的信号 =np.sin(2*np.pi*t) + np.sin(10*2*np.pi*t) # 根据需要优化数学。

# c - 带有 Janus 的 gtk-vim 语法

> ID：14790823
> 
> 赞同：0
> 
> 时间：2013-02-09T19:46:12.810
> 
> 标签：c, vim, gtk, glib

我最近爱上了 Janus，我不能没有它了。我决定做一些 C 编程并遇到了这个： [http](http://www.vim.org/scripts/script.php?script_id=1000) ://www.vim.org/scripts/script.php?script_id=1000 。

我完全不知道如何让它与 Janus 一起工作，我花了数小时进行试验和研究但无济于事。

我遇到了这个： [向 Janus setup 添加 VIM 插件](https://stackoverflow.com/questions/4808059/adding-vim-plugins-to-janus-setup)，并在 Github 上找到了相同的 Vim 库。在做了两次并确保我做对了所有事情之后，它仍然没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:09:01.287

如果您要使用 Janus，则必须单独使用 Janus，无需任何额外的自定义。如果您想使用 Janus 提供的插件或主题，最好手动安装它们，以便您完全控制自己的 Vim。

# .net - 表单加载时不会设置标签

> ID：14790826
> 
> 赞同：2
> 
> 时间：2013-02-09T19:46:19.877
> 
> 标签：.net, visual-studio-2010

我正在尝试将标签设置为注册表项的值，以便在用户加载表单时将标签设置为注册表项值。它没有设置，只是默认文本，没有找到密钥或发生错误。我得到了 Microsoft.VisualBasic.dll 中出现的“System.InvalidCastException”类型的第一次机会异常，作为即时窗口中的错误。

```
Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Dim readValue As String
    readValue = My.Computer.Registry.GetValue _
    ("HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Bohemia Interactive Studio\ArmA 2 OA", "KEY", Nothing)
    Label3.Text = readValue
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T19:15:57.943

尝试这个：

```
readvalue = Encoding.Unicode.GetString(My.Computer.Registry.GetValue(".etc..",)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:54:50.407

先试试这个：

> MsgBox("值为" & readValue)

只是为了检查它是否在那个“KEY”上。

然后：
添加：

```
Dim bytes as Byte() = CType(readValue, Byte())
str = BitConverter.ToString(bytes)
label.Text = str 
```

# php - 函数 PDO 什么都不返回？

> ID：14790827
> 
> 赞同：1
> 
> 时间：2013-02-09T19:46:22.540
> 
> 标签：php, pdo

我在我的项目中使用 PDO，所以我不知道为什么我的函数什么都不返回......

```
function getuser($username) {
    require 'database.php';
    $rep = $bdd->prepare("SELECT * FROM membre where login =:user");
    $rep =$bdd->execute(
        array(
            'user'=>$username
            ));

        while($row = $rep->fetch(PDO::FETCH_OBJ)) {
            //$userid = $row->id;
            //$usermail = $row->email;
            echo $row->id;
        }
} 
```

和用法：

```
$uname = $_SESSION['uname'];
echo $uname;
//result: kate
echo getuser($uname);
//result: 
```

我不知道为什么它不起作用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T19:48:51.977

你有一个错误。代码应该是：

```
$rep = $bdd->prepare("SELECT * FROM membre where login =:user");
$rep->execute(
    array(
        'user'=>$username
        )); 
```

基本上，`$rep`是一个`statement`. 你`prepare()`一个语句然后执行它。现在你在错误的对象上运行执行。

# java - Java获取线程实例的计数

> ID：14790828
> 
> 赞同：1
> 
> 时间：2013-02-09T19:46:23.750
> 
> 标签：java, multithreading

我有一个用于使用多线程方法更新数据库的对象。

现在，我不想通过更新尝试来压倒我的数据库连接，并且如果我有一定数量的线程处于活动状态，我想等待。

我的班级`implements Runnable`叫做`updateUnmarked`.

现在，如果我的线程数是，我只想启动一个新线程`< X`

`Thread.getAllStackTraces().keySet().size()`似乎不起作用，以下似乎也没有解决它：

```
public static int getLiveThreads(){
    ThreadMXBean bean = null;
    bean = ManagementFactory.getThreadMXBean();

    return bean.getThreadCount();
} 
```

两者都只返回 8...但我肯定有超过 8 个线程。

知道怎么做吗？

谢谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:23:42.090

> 现在，如果我的线程数 < X，我只想启动一个新线程

在我看来，您需要的是一个线程池执行器。对数据库的更新可以提交到池中执行，您可以通过限制分配给池的线程数来限制对数据库的并发请求数：

```
// create a thread pool with a max of 4 concurrent threads
ExecutorService threadPool = Executors.newFixedThreadPool(4);

// submit your database operation to the thread-pool
threadPool.submit(new DatabaseUpdateJob(databaseConnection, updateStatement));

...
public class DatabaseUpdateJob implements Runnable {
    // you can construct your jobs and pass in context for them if necessary
    public DatabaseUpdateJob(Connection dbConnection, String statement) {
        ...
    }
    public void run() {
        // use the connection here to update the database
    }
} 
```

如果你真的想自己做，那么`Thread.activeCount()`绝对应该工作。它返回当前线程组中的活动线程数。您需要做的是在开始数据库工作之前拍摄线程数的快照。有许多系统线程在后台运行，执行您应该忽略的各种任务。然后，每当您进行新计数时，您都可以减去后台线程并仅跟踪您的数据库线程。

但是线程池总是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:33:22.673

我认为在这里使用spring的线程池执行器服务更干净

```
<bean id="taskExecutor" class="org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor">
     <property name="corePoolSize" value="5" />
     <property name="maxPoolSize" value="10" />
     <property name="queueCapacity" value="25" />
</bean> 
```

# sql - SQL 导入数据 - 仅在不存在时插入

> ID：14790829
> 
> 赞同：1
> 
> 时间：2013-02-09T19:46:25.757
> 
> 标签：sql, sql-server-2008

我正在使用 SQL Server 管理工具 2008 将数据导入 Web 主机数据库。我有带有主键的表。（每行的ID）现在我可以正常导入数据了。但是当我第二次导入数据时..我需要确保只有那些当前不存在的行才被插入。如果有一个使用向导来做到这一点？如果没有，那么最佳做法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:09:07.073

1.  将数据插入临时表
2.  使用与主表的左连接来确定要插入哪些记录

--

```
CREATE TABLE T1(col1 int)
go

CREATE TABLE Temp(col1 int )
go

INSERT INTO T1
SELECT 1 
UNION 
SELECT 2

INSERT INTO TEMP
SELECT 1 
UNION 
SELECT 2
UNION 
SELECT 3 
UNION 
SELECT 4 

INSERT INTO T1 
SELECT TEMP.col1
FROM Temp 
LEFT JOIN T1 
  ON TEMP.col1 = T1.col1
WHERE T1.col1 IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:50:52.933

我前段时间用过这个，也许它可以帮助：

```
insert into timestudio.dbo.seccoes (Seccao,Descricao,IdRegiao,IdEmpresa)
  select distinct CCT_COD_CENTRO_CUSTO, CCT_DESIGNACAO, '9', '10' from rhxxi.dbo.RH_CCTT0 
  where CCT_COD_CENTRO_CUSTO not in (select Seccao from TimeStudio.dbo.Seccoes where idempresa = '10') 
```

或者，只需使用简单的 IF 语句。

# ruby-on-rails - 某些（不是全部）控制器的 HTTP 基本身份验证

> ID：14790832
> 
> 赞同：14
> 
> 时间：2013-02-09T19:46:47.647
> 
> 标签：ruby-on-rails, authentication

使用 Rails 3.2。

**我有**六个控制器，并且想用`http_basic_authenticate_with`.

我不想手动添加`http_basic_authenticate_with`到每个控制器（我将来可以添加另一个控制器而忘记保护它！）。似乎答案是把它放在`application_controller.rb`一个`:except`arg 中，它会列出*不*应该受到保护的控制器。问题是， :except 子句需要方法名称而不是外部控制器模块名称，例如：

```
http_basic_authenticate_with :name => 'xxx', :password => 'yyy', :except => :foo, :bar 
```

所以然后我想“等等，既然我已经将受保护的控制器分组在`routes.rb`，让我们把它放在那里。” 所以我在我的路线中尝试了这个：

```
 scope "/billing" do
    http_basic_authenticate_with :name ...
    resources :foo, :bar ...
  end 
```

但现在我明白了

```
undefined method `http_basic_authenticate_with' 
```

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2014-03-10T04:18:52.793

像 Rails 那样做。

```
# rails/actionpack/lib/action_controller/metal/http_authentication.rb

def http_basic_authenticate_with(options = {})
  before_action(options.except(:name, :password, :realm)) do
    authenticate_or_request_with_http_basic(options[:realm] || "Application") do |name, password|
      name == options[:name] && password == options[:password]
    end
  end
end 
```

所做`http_basic_authenticate_with`的只是添加一个`before_action`. 您也可以自己轻松地做同样的事情：

```
# application_controller.rb

before_action :http_basic_authenticate

def http_basic_authenticate
  authenticate_or_request_with_http_basic do |name, password|
    name == 'xxx' && password == 'yyy'
  end
end 
```

这意味着您可以`skip_before_action`在不需要这种行为的控制器中使用：

```
# unprotected_controller.rb

skip_before_action :http_basic_authenticate 
```

# jquery - 来自 Webservice 语法错误 jquery 的 XML

> ID：14790835
> 
> 赞同：0
> 
> 时间：2013-02-09T19:47:16.940
> 
> 标签：jquery, web-services, xml-parsing, webserver, syntax-error

我必须从服务器读取 XML 请求。如果我在本地保存 XML，一切正常。

**脚本：**

```
$(document).ready(function () {
    $.ajax({
        type: 'GET',
        url: 'http://localhost:1410/?SNO=56789&ASQL=plu%20mec%2010;',
        crossDomain: true,
        dataType: "jsonp",
        success: parseXml
    });
});

function parseXml(xml) {
    $(xml).find('dataset').each(function () {
        $("#output").append($(this).find('var[key="article.name"]').text() + "<br />");
    });
} 
```

**XML 输出：**

```
<document name="screen">
  <section name="status">
    <dataset>
      <var key="organization.number">2919</var>
      <var key="organization.name">Testname</var>
      <var key="organization.businessdate">09.02.2013</var>
      <var key="situation.number">0</var>
      <var key="situation.name">Normalbetrieb</var>
      <var key="site.number">0</var>
      <var key="site.name">Normalbetrieb</var>
      <var key="pricelevel.number">1</var>
      <var key="pricelevel.name">Standardpreis</var>
      <var key="terminal.number">0</var>
      <var key="terminal.name">WebKasse</var>
      <var key="terminal.status">open</var>
      <var key="terminal.tapster">inactive</var>
      <var key="waiter.number">1</var>
      <var key="waiter.name">Kellner 1</var>
      <var key="table.number">5</var>
      <var key="table.balance">3.2</var>
      <var key="table.sales">3.2</var>
      <var key="profile.number">1</var>
      <var key="profile.name">Standard</var>
      <var key="execution.severity">I</var>
      <var key="execution.code">23600003</var>
      <var key="execution.message">Mec article list.</var>
    </dataset>
  </section>
  <section name="plu.list">
    <dataset>
      <var key="type">article</var>
      <var key="article.number">1</var>
      <var key="article.name">0,1 l Becher Sekt</var>
      <var key="article.displayname"/>
      <var key="article.price">3.7</var>
      <var key="article.plunumber">1</var>
      <action key="STANDARD">book plu 1;</action>
    </dataset>
    [...] 
```

**使用此代码，我的页面为空白并显示此错误：**

```
SyntaxError: syntax error

<document name="screen"><section name="status"><dataset><var[...] 
```

奇怪的是：我可以*在错误*中看到 XML 输出！

如果我更改`data type:`为`xml`

没有错误，页面空白。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:23:53.620

您应该使用 dataType: xml，因为您希望得到 xml 响应。如果使用不同的 Web 服务器有不同的结果，请检查响应的 MIME 类型。

我认为问题是错误的 MIME 类型。

或者您可以将响应作为字符串获取，并使用 jQuery 将其解析为 xml

```
var xml = "<rss version='2.0'><channel><title>RSS Title</title></channel></rss>",
xmlDoc = $.parseXML( xml ),
$xml = $( xmlDoc ),
$title = $xml.find( "title" ); 
```

# checksum - ICMP 校验和卸载

> ID：14790836
> 
> 赞同：0
> 
> 时间：2013-02-09T19:47:51.433
> 
> 标签：checksum, icmp

我有一个简单的自定义 ping 程序回显请求/回显回复....服务器部分部署在 Linux 中，客户端在 Windows 机器中....

客户端和服务器端都以编程方式计算 ICMP 校验和并设置它..一切都很好。

现在我想为服务器模块启用 ICMP 校验和卸载到网卡 ....我已经使用 ethtool 启用它

我可以看到 TCP，校验和卸载发生......但是当我从服务器程序中注释掉 ICMP 校验和计算部分时，希望网卡会为我做但是我没有得到任何 Echo 回复......虽然服务器正在接收 Echo 请求……一定是因为错误的校验和数据包被丢弃……

谁能给我指路。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T19:06:55.900

据我所知，`NIC checksum offloading`只能破坏`IP/TCP/UDP`框架。

我不认为`ICMP`框架被覆盖。

# c# - 关闭 C# 项目

> ID：14790839
> 
> 赞同：0
> 
> 时间：2013-02-09T19:48:01.730
> 
> 标签：c#, project, shutdown

我目前正在编写一个在按下按钮时应该关闭/重新启动的程序，但是当我按下关闭或重新启动按钮时，操作会立即完成，而无需等待（datetimepicker）中的指定时间。

这是我的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WindowsFormsApplication8
{
    public partial class Form2 : Form
    {
        private DateTime tm;
        public Form2()
        {
            InitializeComponent();
        }
        private void button1_Click(object sender, EventArgs e)
        {
            if (DateTime.Now.CompareTo(tm) > 0)
            {
                Sti();
                System.Diagnostics.Process.Start("shutdown", "/s");
            }
            else
            {
                MessageBox.Show("your computer will shutdown shortly ....");
            }

        }
        private void Sti()
        {
            if (DateTime.Now.TimeOfDay.CompareTo(tm.TimeOfDay) > 0)
            {
                tm = new DateTime(DateTime.Now.Year, DateTime.Now.Month, DateTime.Now.Day + 1, tm.Hour, tm.Minute, tm.Second);
            }
            else
            {
                tm = new DateTime(DateTime.Now.Year, DateTime.Now.Month, DateTime.Now.Day, tm.Hour, tm.Minute, tm.Second);
            }

        }

        private void notifyIcon1_MouseDoubleClick(object sender, MouseEventArgs e)
        {
            this.Show();
        }

        private void notifyIcon1_MouseClick(object sender, MouseEventArgs e)
        {

        }

        private void button2_Click(object sender, EventArgs e)
        {
            if (DateTime.Now.CompareTo(tm) >= 0)
            {
                Sti();
                System.Diagnostics.Process.Start("shutdown", "/r");
            }
            else
            {
                MessageBox.Show("your computer will shutdown shortly ....");
            }

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:57:07.837

使用`-t`开关`shutdown`指定等待时间

```
shutdown {-r|-s} -t xxx 
```

其中 xxx 是等待的秒数。

# ruby-on-rails - 是否有 Rails gem 允许用户通过 Rails 应用程序发送 HTML 电子邮件？

> ID：14790845
> 
> 赞同：-1
> 
> 时间：2013-02-09T19:48:42.510
> 
> 标签：ruby-on-rails, html-email, rich-text-editor

我们想向我们网站上的注册用户发送电子邮件。

到目前为止，我们也以编程方式创建电子邮件并发送它们。

我们希望网站管理员可以使用 Rails 应用程序上的富文本编辑器创建 HTML 电子邮件，从数据库中选择用户并将其发送出去。

从本质上讲，它的行为有点像网络邮件程序，比如 gmail。但是：邮件将作为模板组成，并且可以使用一些 ERB，因此它们可以重新用于电子邮件用户等。

示例应用程序可以是发送给所有用户或只发送给部分用户的时事通讯或广播搜索。

有没有这样做的宝石？

如果没有，您将如何设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T20:01:38.380

我不知道有专门做这件事的 gem，但您可以查看默认包含在 Rails 中的[action mailer 。](http://guides.rubyonrails.org/action_mailer_basics.html)

它非常适合发送模板电子邮件（帐户确认等）。您创建一个视图，它将该视图的内容（使用 ERB）呈现到电子邮件的正文中。

您也许可以使用它进行更多自定义，但我没有过多地使用它。

如果您通过 UNIX`mail`命令以编程方式发送邮件，另一种选择是将内容类型指定为 HTML。我使用的命令是：

`mail -a 'Content-type: text/html' -s 'Subject' to_address@example.com < file_containing_message.html`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-17T03:33:40.283

啊，对不起——我不明白这个问题。我认为您的案例没有什么宝石，因为它是一个非常具体的用例。

我建议在电子邮件模板的数据库中存储一个 ERB 文本块。然后你可以使用这样的东西来呈现电子邮件：

```
require 'erb'
name = user.name
email_html = ERB.new(email.template).result(binding) 
```

有关详细信息，请参阅[ERB 文档](http://ruby-doc.org/stdlib-2.0/libdoc/erb/rdoc/ERB.html)。

# c# - XNA C# 性能问题

> ID：14790846
> 
> 赞同：1
> 
> 时间：2013-02-09T19:48:48.640
> 
> 标签：c#, performance, windows-phone-7, xna

我正在屏幕上绘制多个圆圈（未填充），我对所有圆圈使用相同的精灵，但比例值不同。问题是，当它们大约有 6-10 个时，它会滞后很多。纹理本身是 400x400 png 图片。请注意，当使用`spritebatch.Draw()`参数最少的方法时，性能会显着提高。我在通过包含比例值的列表循环时进行绘图。值得一提的是，我正在为 WP7 平台开发，并且延迟仅发生在速度较慢的设备上。

这是我正在使用的代码：

```
for (int i = 0; i < active_triangles.Count; i++)
                {                        
                    spriteBatch.Draw(circle, circle_origin, null, Color.White, 0, circle_pivot, scales[i], SpriteEffects.None, 0);
                    active_triangles[i].Draw(spriteBatch);
                } 
```

三角形的绘制方法：

```
public void Draw(SpriteBatch spriteBatch)
    {
        spriteBatch.Draw(texture, position, frame, Color.White * alpha, rotation, pivot, 1, SpriteEffects.None, 0);
    } 
```

# c++ - 二次曲线速度

> ID：14790854
> 
> 赞同：9
> 
> 时间：2013-02-09T19:49:56.803
> 
> 标签：c++, bezier

我正在写一个 2d 游戏，我在相机空间里有鸟。我想让它们飞起来。所以，我产生了 3 个随机点。第一个是左上侧，第二个：中下，第三个：右上。

结果我有180度旋转的三角形。

为了让鸟儿通过曲线的路径，我有一个 t 参数，它在每一帧（渲染循环）中增加了一些增量。

问题是在不同的曲线中，鸟类的速度不同。如果三角形是“宽”的（**1**），它们会更慢，如果它被 Y 坐标（**2**）拉伸，则速度非常快。

![在此处输入图像描述](../Images/be1e0628fd751052e44e03542184e8e1.png)

但我想让不同曲线的速度相等。从逻辑上讲，我必须更改`delta`为每条曲线附加的每一帧。

* * *

我试图这样解决它：

通过将 2 个向量的长度相加来找到曲线的 ~ 长度：`P1P2`和`P2P3`。

比我定义的速度为每帧 1 个虚拟米。一点伪代码：

```
float pixelsInMeter = 92.f; // One virtual meter equals to this number of pixels
float length = len(P1P2) + len(P2P3)
float speed  = 0.0003f; // m/frame

// (length * speed) / etalon_length
float speedForTheCurve = toPixels( (toMeters(length) * speed) / 1.f);

// ...
// Each frame code:
t += speedForTheCurve;
Vector2 newPos = BezierQuadratic(t, P1, P2, P3); 
```

但无论如何，鸟类都有不同的速度。怎么了？或者也许有更好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:00:56.050

您使用的 Bezier 函数是一个参数化函数，边界为 [0...1]。您正在使用步长，这就是您获得疯狂速度的原因。一般来说，距离*d*是等式中的因变量，这告诉我它们的速度会根据曲线的长度而有所不同。

由于速度是您的因变量，我们将通过计算步长来向量化您的函数。

看看这个伪代码：

`P1 = (x1, y1)`

`P2 = (x2, y2)`

`P3 = (x3, y3)`

```
int vec[100][2]

int getPoint(int p1, int p2, float stepSize) {
   return p1 + (p2 - p1)*stepSize;
}

for (float i = 0.0; i < 1.0; i += 0.01 ) {
   int newX = getPoint(getPoint(x1, x2, i), getPoint(x2, x3, i), i);
   int newY = getPoint(getPoint(y1, y2, i), getPoint(y2, y3, i), i);
   vec[iter++][0] = newX;
   vec[iter][1] = newY;
} 
```

您可以通过执行第一个差异来获得增量值，但我认为这没有必要。只要您根据*步骤*迭代将所有鸟类移动适当的距离，它们都会移动不同的距离，但它们的轨迹开始和结束是相同的。

根据您的方程式，我们可以计算像素增量步长：

```
int pixelsToMove = toMeter(sqrt((x2 - x1)^2 + (y2 - y1)^2))/pixelsInMeter; 
```

这将为您提供适当数量的像素来移动鸟。这样，它们都会移动不同的步长，但它们的速度会有所不同。那有意义吗？

* * *

或者，尝试这样的事情（更难）：

1.  获得您选择的三个点的实际二次函数。
2.  积分两个`xy`直角坐标之间的二次
3.  将计算的长度转换为像素或您正在使用的任何内容
4.  获得因变量速度，以便所有曲线同时完成。

让我们从二次的东西开始：

`y = Ax^2 + Bx + C`其中`A != 0`，所以既然你有三个点，你将需要三个方程。使用代数，您可以解决以下问题：

`A = (y3 - y2)/((x3 - x2)(x3 - x1)) - (y1 - y2)/((x1 - x2)(x3 - x1))`

`B = (y1 - y2 + A(x2^2 - x1^2))/(x1 - x2)`

`C = y1 - Ax1^2 - Bx1`

然后您可以使用上面的公式来获得封闭形式的弧长。看看这个网站，wolfram 会为你整合它，你只需要输入它：

[二次积分的封闭形式解决方案](http://www.wolframalpha.com/input/?i=integrate%20sqrt%28a%20x%5E2%20%2b%20bx%20%2b%20c%29)

既然您已经计算了弧长，请转换`actualArcLength`为速度或您使用的任何单位：

```
float speedForTheCurve = toPixels( (toMeters(actualArcLength) * speed) / 1.f); 
```

# html - Clickable Div vs Button vs href？

> ID：14790857
> 
> 赞同：4
> 
> 时间：2013-02-09T19:50:42.657
> 
> 标签：html, css

我正在尝试学习通过 HTML/CSS 创建按钮的最佳方法。我以前使用过可点击的 div，但看起来这不是最好的主意。

纽扣呢？或者一个href的

今天哪种方式最好（html5 css3）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T20:06:46.927

这取决于您正在寻找的行为。如果其目的是链接到另一个页面，则使用`<a>`. 如果是为了提交表单或做某种帖子或获取我会使用一个按钮。

有一个名为 Basecamp 的基于 Web 的项目管理产品。当他们第一次启动时，他们使用`<a>`标签作为每个单独任务旁边的删除按钮。在使用 chrome 的谷歌网络优化器插件时访问其内部页面的用户看到他们的所有任务都标记为已删除。Google 页面优化器会在页面中查找链接并触发点击以预加载未来的页面。

让形式跟随功能，你应该很高兴:0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:16:11.970

偏爱按钮的一个原因是按钮自然更易于访问，而使用链接、跨度或其他标签在这方面会失败。要获得对这些其他元素的适当可访问性，您必须使用 ARIA 角色来[修复它们](http://yaccessibilityblog.com/library/easy-fixes-to-common-accessibility-problems.html)。

这本身并不是一个黑客，因为这是 ARIA 角色的一部分。但这是一件额外的事情，需要了解并确保你做对了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-03T09:22:03.587

在 html 中创建按钮的最佳方法是使用或因为当您尝试提交表单时，浏览器默认使用提交类型的按钮和输入

例如 ：

```
<form action="somepage.php" method="POST">
   <input type="text" name="name1">
   <textarea></textarea>
   <input type="submit" value="submit the form with a input of type submit">
</form> 
```

只有当用户点击提交按钮时，表单数据才会被提交

但是，当我们使用 **a**或**div**来扮演按钮的角色时，您需要调用 javascript 并寻求帮助

最后好的做法是使用按钮和输入类型提交来扮演按钮的角色其他一切都是可以增加加载页面时间的自定义

# bash - 设置 -eu 时未绑定的变量不会导致退出子shell

> ID：14790864
> 
> 赞同：7
> 
> 时间：2013-02-09T19:51:07.140
> 
> 标签：bash, shell

```
$ cat test.sh
set -eu
echo "`wc -l < $DNE`"
echo should not get here

$ /bin/bash test.sh
test.sh: line 2: DNE: unbound variable

should not get here 
```

我正在运行 bash 版本 4.1.2。有没有办法确保子shell中所有这些未绑定变量的使用导致脚本退出而不必修改涉及子shell的每个调用？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2016-02-26T01:03:53.300

确保可变消毒的更好解决方案

```
#!/usr/bin/env bash

set -eu

if [[ ${1-} ]]; then
  DNE=$1
else
  echo "ERROR: Please enter a valid filename" 1>&2
  exit 1
fi 
```

通过像这样在花括号内的变量名中添加连字符，bash 可以理智地处理未定义的变量。我还强烈建议您查看 Google shell 样式指南，这是一个很好的参考[https://google.github.io/styleguide/shell.xml](https://google.github.io/styleguide/shell.xml)

```
[[ -z ${variable-} ]] \
  && echo "ERROR: Unset variable \${variable}" \
  && exit 1 \
  || echo "INFO: Using variable (${variable})" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T19:55:13.567

使用临时变量，让 test.sh 进程知道`wc`. 您可以将其更改为：

```
#!/bin/bash
set -eu
out=$(wc -l < $DNE)
echo $out
echo should not get here 
```

现在，您不会看到`should not get here`if wc 失败。

# c - MPI 输出使用一些 MPI_File_write 在 C 中写入 2d 块循环分布

> ID：14790870
> 
> 赞同：1
> 
> 时间：2013-02-09T19:51:26.227
> 
> 标签：c, 2d, mpi, block, cyclic

我在文件中写入二维块循环分布式数组时遇到问题。

我试过这些东西：

```
 rc=MPI_File_open(MPI_COMM_WORLD, rez, MPI_MODE_WRONLY, MPI_INFO_NULL, &cFile);
    if(rc){printf("Failed to open file! Error: %d \n", rc);MPI_Finalize(); 
    fflush(stdout);}
    else
    {
     MPI_File_write_all(cFile, MatC, loccC*locrC, compa, &status);    
    } 
```

...

```
 rc=MPI_File_open(MPI_COMM_WORLD, rez, MPI_MODE_WRONLY, MPI_INFO_NULL, &cFile);
    if(rc){printf("Failed to open file! Error: %d \n", rc);MPI_Finalize(); 
    fflush(stdout);}
    else
    {
     MPI_File_write_ordered(cFile, MatC, loccC*locrC, compa, &status);    
    } 
```

...

```
 rc=MPI_File_open(MPI_COMM_WORLD, rez, MPI_MODE_WRONLY, MPI_INFO_NULL, &cFile);
    if(rc){printf("Failed to open file! Error: %d \n", rc);MPI_Finalize(); 
    fflush(stdout);}
    else
    {
     MPI_File_write_shared(cFile, MatC, loccC*locrC, compa, &status);    
    } 
```

我在这篇文章中什么也找不到（但只是如何读取文件并将其格式化为 2d 块循环分布式数组（我已成功使用该帖子））： [MPI IO Reading and Writing Block Cyclic Matrix](https://stackoverflow.com/questions/10341860/mpi-io-reading-and-writing-block-cyclic-matrix)

对不起我糟糕的英语:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:56:43.187

您告诉过您使用过这篇文章：[MPI IO 读写块循环矩阵](https://stackoverflow.com/questions/10341860/mpi-io-reading-and-writing-block-cyclic-matrix)。我们必须假设一些事情——比如矩阵 MatC 的维度：让我们假设有 m 行和 n 列。MatC中块的尺寸，假设它们是m_b和n_b。假设处理器的数量是 nproc，并且 proc 的等级保存在变量 node 中。此外，对于我们的示例 p 和 q，我们必须知道 2D 环面（处理器网格）的维度。这是你如何做到的：

```
 int dims[]={m, n}, dargs[]={m_b, n_b}, distribs[]={MPI_DISTRIBUTE_CYCLIC, MPI_DISTRIBUTE_CYCLIC}, nproc, dim[]={p, q};
    char nat[]="native";
    MPI_Datatype dcarray, compa; //don't know what type compa is
    ...
    MPI_Type_create_darray(nproc, node, 2, dims, distribs, dargs, dim, MPI_ORDER_C, compa, &dcarray); 
    MPI_Type_commit(&dcarray);
    rc=MPI_File_open(comm, rez, MPI_MODE_CREATE | MPI_MODE_WRONLY, MPI_INFO_NULL, &cFile);
    if(rc){printf("Failed to open file! Error: %d \n", rc);MPI_Finalize(); fflush(stdout);}
    else
    {
        MPI_File_set_view(cFile, 0, compa, dcarray, nat, MPI_INFO_NULL);
        MPI_File_write_all(cFile, MatC, locrC*loccC, compa, &status);    
    }
    MPI_File_close(&cFile); 
```

# genshi - Genshi if else 语句

> ID：14790879
> 
> 赞同：1
> 
> 时间：2013-02-09T19:51:53.857
> 
> 标签：genshi

我一直在尝试让 genshi py:if 使用 python 表达式。为了简单起见，我尝试以下代码。

```
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:py="http://genshi.edgewall.org/">
  <body>
    <py:if test = ${len(linstoflinks)>0}>
      <p>List has lenght</p>
    </py:if>
  </body>
</html> 
```

在 Genshi 文档中，他们说我可以放置任何 python 表达式，只要我将表达式放在花括号中，前面有一个美元符号。 [http://genshi.edgewall.org/wiki/GenshiTutorial](http://genshi.edgewall.org/wiki/GenshiTutorial)。我什至尝试

```
<py:if test = "${True}">
<py:if test = "${1==1}"> 
```

这个简单的代码不起作用。错误是：格式不正确（无效令牌）这有效

```
<py:if test = "foo"> 
```

任何人都知道如何使这个 if 语句与 python 表达式一起工作。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T15:06:40.627

您不需要在模板指令中使用花括号。

尝试这个

```
<py:if test="len(linstoflinks)>0"> 
```

# javascript - 动态加载嵌入式 Twitter 时间线

> ID：14790883
> 
> 赞同：3
> 
> 时间：2013-02-09T19:52:21.333
> 
> 标签：javascript, twitter, coffeescript

Twitter 有很好的嵌入式时间线，但是我似乎只能通过复制粘贴 twitter 提供的小部件代码来工作：

```
<a class="twitter-timeline" data-widget-id="SOME_WIDGET_ID">Tweets about XXXXX</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script> 
```

有什么方法可以根据小部件 ID 将嵌入式时间线动态加载到 div 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-22T22:51:28.890

如果您有该[`widgets.js`](http://platform.twitter.com/widgets.js)文件，您可以使用该[`twttr.widgets.createTimeline()`](https://dev.twitter.com/docs/tfw-javascript)函数指定一个元素来创建时间线。只需动态设置用户名，它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-17T10:15:21.947

有： https: [//plus.google.com/u/0/110804953626559077511/posts/j65ntqa5Qd3](https://plus.google.com/u/0/110804953626559077511/posts/j65ntqa5Qd3)

我不推荐它。所有 Twitter 所要做的就是在他们的 widgets.js 文件中更改一件小事，这将停止工作。

# sql - ANSI 等效于 IS NULL

> ID：14790884
> 
> 赞同：6
> 
> 时间：2013-02-09T19:52:30.040
> 
> 标签：sql, coalesce, isnull, ansi-sql

我正在尝试找到编写 T-SQL 'IS NULL' 的 ANSI 方法。（已更正，是“IN NULL”）互联网上的一些帖子说您可以使用 coalesce 使其像“IS NULL”一样工作

我喜欢这样做的原因是：可移植代码。并且查询必须返回`NULL`.

到目前为止，我创建了这个：

```
SELECT empid,
       firstname,
       lastname,
       country,
       coalesce(region,'unknown') AS regions ,
       city
FROM HR.Employees 
```

结果集如下所示：

```
empid   firstname           lastname       country  regions city
1           Sara            Davis           USA     WA      Seattle
2           Don             Funk            USA     WA      Tacoma
3           Judy            Lew             USA     WA      Kirkland 
4           Yael            Peled           USA     WA      Redmond
5           Sven            Buck            UK      unknown London
6           Paul            Suurs           UK      unknown London
7           Russell         King            UK      unknown London
8           Maria           Cameron         USA     WA      Seattle
9           Zoya            Dolgopyatova    UK      unknown London 
```

我确定了 的行`NULL`，但是如何将它们从该集合中过滤掉？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-09T20:05:45.757

两者都是 ANSI 标准，`IS NULL`并且`COALESCE`在几乎所有合理的数据库中都可用。我认为你想要的结构是：

```
where region IS NULL 
```

这是标准语法。

要进行`COALESCE`类似的工作，`IS NULL`需要一个您知道不在数据中的值：

```
where coalesce(region, '<null>') <> '<null>' 
```

但是，您需要不同的日期和数字值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-03-03T22:09:52.087

您似乎混淆`IS NULL`了（检查值是否为空的谓词）和 T-SQL 特定函数`ISNULL(value, replace)`（后面没有空格和参数），它与`COALESCE`.

请参阅[SQL - COALESCE 和 ISNULL 之间的区别？](https://stackoverflow.com/questions/18828641/sql-difference-between-coalesce-and-isnull)有关T-SQL如何`COALESCE`和不同的详细信息。`ISNULL`

诸如返回什么类型以及所有参数都为 null 时会发生什么等细微差别`ISNULL`是一个函数，如果它不为 null，则返回第一个参数，如果是，则返回第二个参数。 `COALESCE`返回第一个非空参数（可能需要两个以上）。

因此，它们中的每一个都可能用于以不同的方式解决您的问题，并且结果略有不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T20:03:52.847

`IS NULL`是有效的 ANSI SQL-92，称为空谓词。

```
<null predicate> ::= <row value constructor> IS [ NOT ] NULL 
```

参见[SQL-92](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)，第 8.6 段。

所以`WHERE`列名`IS NULL`是完全有效的。

ANSI SQL 处理 NULL 值与 T-SQL 不同的地方是当您编写`WHERE`column name`= NULL`或`WHERE`column name时`<> NULL`。请参阅[SET ANSI NULLS (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms188048.aspx)。

# ios - 故事板视图IOS

> ID：14790886
> 
> 赞同：0
> 
> 时间：2013-02-09T19:52:50.947
> 
> 标签：ios, xcode, storyboard

谁能告诉我我在这里做错了什么:)？

由于某种原因，情节提要上的视图在模拟器中显示的内容不同。

![在此处输入图像描述](../Images/87320292260849b7a79bf05ab2652a6b.png)

屏幕截图：

[http://s12.postimage.org/qe69tndel/Sk_rmbillede_2013_02_09_kl_20_41_49.png](http://s12.postimage.org/qe69tndel/Sk_rmbillede_2013_02_09_kl_20_41_49.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:25:00.950

这里可能有很多问题，包括：

1）您在 4 英寸模拟器上运行项目，但您的应用程序可能没有默认 568h@2x 图像，这是必需的，因此您的应用程序可以在 4 英寸设备上全屏运行。

2) 如果您使用的是自动布局，则可能是约束设置不正确。

3）如果你没有使用自动布局，可能自动调整大小的蒙版设置不正确

# c# - 在同一个数组中将值从一个索引移动到另一个索引，可能吗？

> ID：14790889
> 
> 赞同：0
> 
> 时间：2013-02-09T19:53:05.750
> 
> 标签：c#

这是为了学校作业。

我和我的团队合作伙伴想知道是否可以将一个值移动到同一个数组中的另一个索引？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T19:54:20.103

当然。

```
var temp = array[i];
array[i] = array[j];
array[j] = temp; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:01:17.367

当然可以;

```
var array= new int[]{1, 2, 3};
foreach (var i in array)
{
    Console.WriteLine (i);
}

array[1] = array[2];

foreach (var j in array)
{
    Console.WriteLine (j);
} 
```

结果将是；

```
1 2 3
1 3 3 
```

这是一个[`DEMO`](http://ideone.com/MRw0rs).

但是，当然，这会将值从一个值处理到另一个值。旧索引值移动到新索引值。如果你想使用改变他们的值，你可以使用`temp`像[Daniel's answer](https://stackoverflow.com/a/14790902/447156)这样的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T20:01:41.890

在 C# 中移动一个值与将一个橙子从冰箱中移动到餐桌上是非常不同的，因为当您将橙子从一个地方移动到另一个地方时，旧的地方不再包含橙子。

另一方面，在数组中移动一个项目，本质上是一种复制^*的行为，所以你可以这样写：

```
myArray[newIndex] = myArray[oldIndex]; 
```

现在旧索引中的项目被移动到它的新索引中。旧索引也包含该项目。如果您不希望这种情况发生，则需要通过将其替换为其他内容来明确“删除”该项目。在引用对象数组中，您将其替换为`null`：

```
myArray[oldIndex] = null; 
```

在值对象数组中，您将其替换为您指定为“无”的某个特殊值，或者`null`如果您的值对象可以为空，则替换为该值。

* * *

^*您复制的内容取决于数组元素的类型：在值类型数组中，项目本身会被复制；在引用类型数组中，引用被复制。继续橙子类比，当橙子是引用类型时，橙子数组是定义数组中所有橙子位置的便利贴列表。您没有将橙色移动到阵列中，而是放置了一张便利贴，上面写着“从右边数第三个橙色”，然后将橙色留在原处。复制参考对象只是复制其便利贴。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T20:05:59.553

复制很简单

```
array[Index+1] = array[Index] 
```

交换是

```
var tmp = array[Index + 1];
array[Index+1] = arry[Index];
array[Index] = tmp; 
```

移动得好取决于你想用什么来替换移动的项目，以表明它现在是空的，比如

```
array[Index+1] = array[Index];
array[Index] = -1; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-09T20:09:14.277

将阵列想象成堆垛机托盘。东西可以在里面，你可以移动东西，但是把东西放在一个抽屉里或另一个抽屉里不会影响其他东西的顺序。

您可以使用列表而不是使用数组

```
 List<int> myList = new List<int>();
        myList.Add(1);
        myList.Add(2);
        myList.Add(3);
        myList.Add(4);
        myList.Add(5); 
```

会给你1,2,3,4,5。

然后打电话

```
 int temp = myList[1];
    myList.RemoveAt(1);
    myList.Insert(3, temp); 
```

会给你1,3,4,2,5

# python - 在 Python 中无需重新启动应用程序即可检索 MySQL 数据库的新行

> ID：14790892
> 
> 赞同：1
> 
> 时间：2013-02-09T19:53:24.043
> 
> 标签：python, mysql, python-2.7, tkinter, mysql-python

我使用 jQuery/AJAX 在 PHP 中创建了一个聊天应用程序。现在我正在尝试创建一个带有 GUI (Tkinter) 的 Python (2.7.3) 应用程序，用于查看和管理聊天。

我有一个存储用户和聊天信息的 MySQL 数据库。

在浏览器上，通过使用 setInterval 和 AJAX 调用，我可以在不刷新页面的情况下获取新消息。

在 Python 应用程序中，我使用“after”来调用一个函数来检索诸如 setInterval 之类的信息。我认为它正在工作。但是，我无法获得在浏览器上提交的新条目。

如何在不重新启动应用程序的情况下获取新提交的条目（在 Python 应用程序启动后）？

我正在使用 MySQLdb 模块来访问和更改数据库，并且正在使用 localhost。

作为我如何尝试做的一个例子，我发布了我的 get_messages 函数：

```
def get_messages(sohbet_id, messages_name):
    messages_name.delete(1.0, END) # Remove the content of Text widget
    sql = "SELECT *
        FROM ileti
        WHERE sohbet_id='" + str(sohbet_id) + "'
        ORDER BY created ASC"
    cursor.execute(sql)
    result = cursor.fetchall() # Fetch all the chat info
    chat = ""
    for i in result:
        name = chatter_name(i[1])
        time = datetime.fromtimestamp(i[4]).strftime("%H:%M:%S")
        chat += time + " " + str(name) + ": " + str(i[3]) + "\n" # Create a string of chat messages
    messages_name.insert(END, chat) # Insert all the chat messages to the Text widget
    messages_name.yview(END) # Scroll it down so that the latest message can be seen
    messages_name.after(1000, lambda: get_messages(sohbet_id, messages_name)) # Run this again after 1 second
    return 
```

**编辑**：更多信息：我实际上是在函数中创建小部件。当应用程序启动时，只有主框架在那里，我调用一个函数来创建第一个选项卡（所有聊天的摘要），然后该函数调用另一个打开新选项卡（个人）聊天的函数。在这些单独的聊天标签中，我有这个 get_messages 函数来查询属于该聊天（或标签）的聊天消息。在上述函数中，messages_name 实际上是一个 Text 小部件。我将它传递给函数，因为我正在该函数中修改它（我找不到任何其他方式）。当调用 get_messages 时，不会出现新行。获得它们的唯一方法是重新启动应用程序。就像当应用程序启动时，它会从该实例中的数据库中获取所有数据，仅此而已。我唯一知道的是，我需要像 PHP &

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T04:53:25.340

使用获取和插入数据的方法连接到类中的数据库解决了我的问题。

这就是类：

```
class DBConnection(object):

    def __init__(self, DB_HOST, DB_PORT, DB_USER, DB_PASSWORD, DB_NAME):
        self.host = DB_HOST
        self.port = DB_PORT
        self.name = DB_NAME
        self.user = DB_USER
        self.password = DB_PASSWORD
        self.con = None

    def connect_db(self):
        if self.con is None:
            self.con = MySQLdb.connect(host = self.host,
                                        port = self.port,
                                        db = self.name,
                                        user = self.user,
                                        passwd = self.password)
            self.con.set_character_set("utf8")
        return self.con

    def fetch_db(self, query):
        self.query = query
        self.cursor = self.con.cursor()
        self.cursor.execute("SET NAMES utf8;")
        self.cursor.execute("SET CHARACTER SET utf8;")
        self.cursor.execute("SET character_set_connection=utf8;")
        self.cursor.execute(self.query)
        self.result = self.cursor.fetchall()

        return self.result

    def insert_db(self, query):
        self.query = query
        self.cursor = self.con.cursor()
        self.cursor.execute("SET NAMES utf8;")
        self.cursor.execute("SET CHARACTER SET utf8;")
        self.cursor.execute("SET character_set_connection=utf8;")
        self.cursor.execute(self.query)
        self.con.commit()

        return 
```

这就是我连接的方式（在主循环之前）：

```
DBC = DBConnection('localhost',3306,'root','','sohbet')
con = DBC.connect_db() 
```

这就是我进行查询的方式：

```
result = DBC.fetch_db("SELECT * FROM ileti WHERE sohbet_id='" + str(sohbet_id) + "' ORDER BY created ASC") 
```

但是，我需要检查 mmgp 告诉我的查询方式。

# javascript - 远程刷新页面=>真正的模态表单提交

> ID：14790893
> 
> 赞同：2
> 
> 时间：2013-02-09T19:53:29.917
> 
> 标签：javascript, jquery, ruby-on-rails

我有一个带表单的模态，在没有验证错误的情况下提交它后，我试图关闭模态并用新结果刷新页面。但我无法让它工作。我有这个代码（Rails 3）：

我的控制器：

```
 def create

    @stuff = Stuff.new(params[:stuff])

       respond_to do |format|
          if @stuff.save
             format.js 
          else
             format.js
          end
       end
     end 
```

_addModal.html.erb

```
<div id="addModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Label</h3>
    </div>
        <div class="modal-body">
            <p>
                <fieldset>
                <label></label>
                <%= render 'form2' %>    
                </fieldset>
            </p>
        </div>
    </div> 
```

_form2.html.erb

```
%= form_for(@stuff, :remote => true) do |f| %>

   <% if @stuff.errors.any? %>
     <div id="error_explanation">
       <div class="alert">
          <h2><%= @stuff.errors.count %></h2>

        <ul>
          <% @stuff.errors.full_messages.each do |msg| %>
           <li><%= msg %></li>
          <% end %>
        </ul>
            </div>
          </div>
               <% end %>

     <%= f.label :name %><br />
     <%= f.text_field :name %>

    <%= f.submit %>

  <% end %> 
```

创建.js.erb

```
<%- if @stuff.errors.any? %>

           $('#addModal').html('<%= escape_javascript(render :partial => "form2") %>');

           <%- else %>

          $('#addModal').modal('hide').empty();

          <%- end %> 
```

有什么想法可以让它发挥作用吗？

谢谢！

**更新：**

我也有几个问题：1）如果出现验证错误，create.js.erb 将返回仅包含“form2”内容的新模态 - 没有 #addModal 布局。我该如何解决？

2) 提交成功后如何清除表格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T03:34:25.737

将此添加到您的 js.erb 文件中以自动重新加载页面

```
<%- if @stuff.errors.any? %>
  $('#addModal').html('<%= escape_javascript(render :partial => "form2") %>');
<%- else %>
  $('#addModal').modal('hide').empty();
  window.location.reload();
<%- end %> 
```

# mysql - 在 mySQL 上插入重复键

> ID：14790895
> 
> 赞同：0
> 
> 时间：2013-02-09T19:53:42.360
> 
> 标签：mysql, vb.net, insert

即使该字段与我的主键重复，我将如何插入新字段。

我的表中有 6 个字段 - Employee_Number、Week_number、Time_in、Time_out、Hours、Overtime Employee_number、week_number 和 day 组成一个复合键。

我刚刚注意到，如果员工 (500456) 在星期一的第 4 周打卡，他们将无法在同一周的星期二打卡。有没有我可以用来解决这个问题的 SQL 语句？

这是我目前拥有的；

```
"INSERT INTO daily_calculations (EMPLOYEE_NUMBER, WEEK_NUMBER, DAY, TIME_IN, TIME_OUT, HOURS, OVERTIME)"
sqlquery2 = sqlquery2 + "VALUES ('" & ENumber & "','" & WeekNum & "', '" & day & "', '" & StartTime & "', '" & EndTime & "',"
sqlquery2 = sqlquery2 + "'" & Hours & "', '" & Overtime & "');" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T19:55:21.723

尝试`INSERT IGNORE...`

> 如果使用`IGNORE`关键字，则执行语句时发生的错误将`INSERT`被视为警告。例如，如果没有`IGNORE`，重复表中现有`UNIQUE`索引或`PRIMARY KEY`值的行会导致重复键错误并且语句被中止。使用`IGNORE`，该行仍然没有插入，但没有发出错误。

[文档](http://dev.mysql.com/doc/refman/5.5/en/insert.html)

# java-me - (HttpConnection) Connector.open("http://www.google.com"); 不响应

> ID：14790896
> 
> 赞同：0
> 
> 时间：2013-02-09T19:53:50.200
> 
> 标签：java-me

```
 HttpConnection c = null;
    InputStream is = null;
    StringBuffer sb = new StringBuffer();
    String request = serverUrl; // + "?loc=" + location.getLat() + "," + location.getLng() + "data=" + message.getString();
    try {
        c = (HttpConnection) Connector.open("http://www.google.com");
        c.setRequestMethod(HttpConnection.GET); //default
        is = c.openInputStream(); // transition to connected!
        int ch = 0;
        for (int ccnt = 0; ccnt < 150; ccnt++) { // get the title.
            ch = is.read();
            if (ch == -1) {
                break;
            }
            sb.append((char) ch);
            return sb.toString();
        }
    } catch (IOException x) {
        x.printStackTrace();
    } finally {
        try {
            is.close();
            c.close();
        } catch (IOException x) {
            x.printStackTrace();
        }
    }
    System.out.println(sb.toString());
    return null; 
```

在上面的代码中——这一行

```
(HttpConnection) Connector.open("http://www.google.com"); 
```

不响应。我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T13:24:26.437

尝试以下

```
 HttpConnection c = null;
    InputStream is = null;
    StringBuffer sb = new StringBuffer();
    String request = serverUrl; // + "?loc=" + location.getLat() + "," + location.getLng() + "data=" + message.getString();
    try {
        c = (HttpConnection) Connector.open("http://www.google.com");
        c.setRequestMethod(HttpConnection.GET); //default
        int status_code=c.getResponseCode();
        if(status_code!=HttpConnection.HTTP_OK)
        {
          //Show the  failure message to user
          return;
        }

        //Remaining part is same as your code 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T16:00:53.473

在许多手机和一些模拟器中，您只能在另一个线程中打开连接。也就是说，如果您尝试在 main therad = UI 线程中连接，它将无法工作并且不会告诉您任何内容。尝试简单地将您的方法包装在一个新线程中

# java - 在java中乘以二维数组

> ID：14790897
> 
> 赞同：-4
> 
> 时间：2013-02-09T19:53:57.303
> 
> 标签：java

我已经声明了一个数组，我想将第一列的值乘以每行第二列的值，并创建这些乘积的总和。我已经尝试了下面的代码清单，我错过了什么

```
public class Arrays {
    public static void(String[] args) {

        int array_x[][]={{9,8},{2,17},{49,4},{13,119},{2,19},{11,47},{3,73}};
        int sum = 0;

        for (int i = 0; i < array_x.length; i++) {
            for (int j = 0; j < array_x.length; j++) {
                array_x[i][j] = i * j;
                System.out.println("\n" + array_x[i][j])
            }
        }

    }
} 
```

输出应该类似于 9*8=72 2*17=34 等，然后将整个结果相加为 72+34+....

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-09T20:08:08.617

你写的代码有几个问题，包括它不能编译，因为你有不同数量的左括号和右括号，你没有指定函数名（我认为它是 main）并且有一个**;** 失踪。然而，最大的问题是一个合乎逻辑的问题：你只需要一个**for**来做你想做的事。您知道数组第二维的索引将是 0 和 1，因为正如您所说，数组只有两列。此外，您需要将产品累积到**sum中，而不是将****sum**初始化为 0 并且从不更新它。最后，指令**array_x[i][j] = i * j**将索引而不是值相乘，因此结果不是您所期望的，并且此结果被放入**array_x**，这是错误的地方，因为您确实不需要更改输入数组。

```
class Arrays{

    public static void main(String[] args){

        int array_x[][]={{9,8},{2,17},{49,4},{13,119},{2,19},{11,47},{3,73}};

        int sum=0;

        for(int i=0;i<array_x.length;i++) {
            int prod = array_x[i][0] * array_x[i][1];
            System.out.println("\n"+prod);
            sum += prod;
        }

        System.out.println("Final: " + sum);
    }
} 
```

您最初编写的代码实际上是构建[乘法表](http://chatt.hdsb.ca/~stevenso/0270B743-00009092.0/multiplication_table_complete.jpg)所需要的，但在这种情况下，您需要一个行数和列数相等的数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:11:58.043

```
public class Arrays {
    public static void main (String[] args) {

        int array_x[][]={{9,8},{2,17},{49,4},{13,119},{2,19},{11,47},{3,73}};
        int multiply[] = new int[7];

        for (int i = 0; i < array_x.length; i++) {

            multiply[i] = array_x[i][0] * array_x[i][1];

        }
        int sum = 0;
        for(int i = 0; i < multiply.length; i++)
        {

        System.out.println(array_x[i][0] + "*" + array_x[i][1] + "=" + multiply[i]);
        sum += multiply[i];

        }
        System.out.println("Sum:" + sum);

    }
} 
```

# haskell - 将布尔函数列表应用于列表的最简洁方法？

> ID：14790903
> 
> 赞同：2
> 
> 时间：2013-02-09T19:54:23.607
> 
> 标签：haskell

考虑一下：

```
ruleset = [rule0, rule1, rule2, rule3, rule4, rule5] 
```

其中`rule0`,`rule1`等是带有一个参数的布尔函数。查找特定列表的所有元素是否满足所有规则的最简洁方法是`ruleset`什么？

显然，循环是可行的，但 Haskell 的人似乎总是对这些类型的问题有聪明的单线。

该`all`函数似乎合适（例如`all (== check_one_element) ruleset`）或嵌套`map`s。此外，`map ($ anElement) ruleset`这大致是我想要的，但适用于所有元素。

我是 Haskell 的新手，解决这个问题的方法有很多。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-09T20:05:04.337

如果您要求*每个参数的**所有*函数都为真，那么它只是

 *```
and (ruleset <*> list) 
```

（您需要`import Control.Applicative`使用`<*>`.）

解释：

当`<*>`给定一对列表时，它将左侧列表中的每个函数应用于右侧列表中的每个参数，并返回一个包含所有结果的列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T20:15:04.967

单线：

```
import Control.Monad.Reader

-- sample data
rulesetL = [ (== 1), (>= 2), (<= 3) ]
list = [1..10]

result = and $ concatMap (sequence rulesetL) list 
```

（我们在这里处理的类型是`Integer`，但也可以是其他类型。）

让我解释一下发生了什么：`rulesetL`是 type `[Integer -> Bool]`。通过意识到这`(->) e`是一个单子，我们可以使用

```
sequence :: Monad m => [m a] -> m [a] 
```

在我们的例子中，它将专门用于 type `[Integer -> Bool] -> (Integer -> [Bool])`。所以

```
sequence rulesetL :: Integer -> [Bool] 
```

将值传递给列表中的所有规则。接下来，我们使用`concatMap`此函数将所有结果应用于`list`并将所有结果收集到一个列表中。最后，调用

```
and :: [Bool] -> Bool 
```

将检查返回的所有组合`True`。

**编辑：**查看*dave4420*的答案，它更好更简洁。如果您需要组合规则并稍后在某些列表中应用它们，我的回答可能会有所帮助。尤其

```
liftM and . sequence :: [a -> Bool] -> (a -> Bool) 
```

将多个规则合二为一。您还可以将其扩展到其他类似的组合器，例如 using`or`等。意识到规则是`(->) a`monad 的值可以为您提供其他有用的组合器，例如：

```
andRules = liftM2 (&&) :: (a -> Bool) -> (a -> Bool) -> (a -> Bool)
orRules  = liftM2 (||) :: (a -> Bool) -> (a -> Bool) -> (a -> Bool)
notRule  = liftM not :: (a -> Bool) -> (a -> Bool)
         -- or just (not .) 
```

等（不要忘记导入`Control.Monad.Reader`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T20:07:40.587

一个更容易理解的版本（不使用`Control.Applicative`）：

```
satisfyAll elems ruleset = and $ map (\x -> all ($ x) ruleset) elems 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-10T07:45:21.877

就个人而言，我喜欢这种编写函数的方式，因为它明确使用的唯一组合器是`and`：

```
allOkay ruleset items = and [rule item | rule <- ruleset, item <- items] 
```*

# javascript - 背栅集成

> ID：14790906
> 
> 赞同：4
> 
> 时间：2013-02-09T19:54:50.270
> 
> 标签：javascript, marionette, backgrid

我将如何在骨干网中使用 backgrid.marionette 应用程序？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-09T20:51:42.207

它看起来很简单。只需将 Backgrid 视图添加到任何区域：

```
MyApp.addRegions({
  someRegion: "#some-div"
});

var columns ....
var userList ....

MyApp.someRegion.show(
    new Backgrid.Grid({
        columns : columns,
        collection : userList
    })
); 
```

# mysql - MySQL 中 utf8 中没有的 utf8mb4 中有什么？

> ID：14790909
> 
> 赞同：1
> 
> 时间：2013-02-09T19:55:01.613
> 
> 标签：mysql, utf-8, utf8mb4

似乎无法在网上找到任何资源来说明 MySQL 的 utf8mb4（4 字节 utf8）中哪些语言/字符不在 utf8（3 字节 UTF8）中。

有人可以解释一下 utf8mb4 附带了哪些额外的语言/字符支持吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T20:04:33.240

根据[here](https://web.archive.org/web/20130511134852/http://status.net/open-source/issues/2833)，[here](http://dev.mysql.com/doc/refman/5.5/en/charset-unicode-utf8mb4.html)和[here](http://en.wikipedia.org/wiki/Plane_%28Unicode%29)所有基本多语言平面之外的字符都被`utf8`MySQL中的旧类型截断。

基本上`utf8mb4`你应该能够支持[补充多语言平面](http://en.wikipedia.org/wiki/Plane_%28Unicode%29#Supplementary_Multilingual_Plane)，甚至更进一步。

# javascript - 停止 node.js 服务器的所有实例

> ID：14790910
> 
> 赞同：258
> 
> 时间：2013-02-09T19:55:02.260
> 
> 标签：javascript, windows, node.js, express, port

这是我第一次使用 Node.js，我遇到了这个问题：

我已经通过 IDE 的插件启动了一个 Node 服务器。不幸的是，我不能使用 IDE 的终端。所以我尝试从命令行运行脚本。

这就是问题所在 - 我正在使用 Express 模块，而我的应用正在侦听某个端口 (8080)。当我从命令行启动应用程序时，它会引发此错误：

```
events.js:71
    throw arguments[1]; // Unhandled 'error' event
                   ^
Error: listen EADDRINUSE
    at errnoException (net.js:770:11)
    at HTTPServer.Server._listen2 (net.js:910:14)
    at listen (net.js:937:10)
    at HTTPServer.Server.listen (net.js:986:5)
    at Object.<anonymous> (C:\xampp\htdocs\node\chat\app.js:5:5)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.runMain (module.js:492:10) 
```

尽管我不太确定这个错误可能是什么，但我认为这是因为应用程序正在侦听一个已经在使用的端口。所以我做了：

```
netstat -an 
```

我可以看到

```
TCP    0.0.0.0:8080           0.0.0.0:0              LISTENING 
```

这是因为当我尝试从 IDE 启动 Node 服务器时，它已经启动了。

所以我想知道，如何停止所有服务器实例？另外，如果您能告诉我如何检测端口上正在运行的内容并将其杀死。

* * *

## 回答 #1

> 赞同：577
> 
> 时间：2013-02-09T19:56:31.757

## **视窗机：**

需要杀死 Node.js 服务器，并且您没有任何其他 Node 进程正在运行，您可以告诉您的机器杀死所有名为`node.exe`. 看起来像这样：

```
taskkill /im node.exe 
```

如果进程仍然存在，您可以通过添加`/f`标志强制进程终止：

```
taskkill /f /im node.exe 
```

如果您需要更细粒度的控制并且只需要杀死在特定端口上运行的服务器，您可以使用`netstat`查找进程 ID，然后向其发送终止信号。因此，在您的情况下，端口在哪里`8080`，您可以运行以下命令：

```
C:\>netstat -ano | find "LISTENING" | find "8080" 
```

输出的第五列是进程 ID：

```
 TCP    0.0.0.0:8080           0.0.0.0:0              LISTENING       14828
  TCP    [::]:8080              [::]:0                 LISTENING       14828 
```

然后，您可以使用`taskkill /pid 14828`. 如果进程拒绝退出，那么只需`/f`在命令中添加 (force) 参数。

* * *

## **MacOS机器：**

该过程几乎相同。您可以杀死机器上运行的所有 Node 进程：

```
killall node 
```

[或者也正如下面@jacob-groundwater 的回答中](https://stackoverflow.com/a/14791025/58)提到的那样`lsof`，您可以找到侦听端口的进程的PID（传递`-i`标志和端口以显着加快速度）：

```
$ lsof -Pi :8080
COMMAND   PID      USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME
node     1073    urname   22u  IPv6  bunchanumbershere      0t0  TCP *:8080 (LISTEN) 
```

在这种情况下，进程 ID 是 PID 列下方的数字，然后您可以将其传递给`kill`命令：

```
$ kill 1073 
```

如果进程拒绝退出，那么只需使用`-9`标志，它是 a`SIGTERM`并且不能忽略：

```
$ kill -9 1073 
```

* * *

## **Linux机器：**

同样，该过程几乎相同。您可以杀死机器上运行的所有 Node 进程（`-$SIGNAL`如果`SIGKILL`不足则使用）：

```
killall node 
```

或者也可以使用`netstat`，您可以找到侦听端口的进程的 PID：

```
$ netstat -nlp | grep :8080
tcp        0      0 0.0.0.0:8080         0.0.0.0:*                   LISTEN      1073/node 
```

在这种情况下，进程 ID 是第六列中进程名称之前的数字，然后您可以将其传递给`kill`命令：

```
$ kill 1073 
```

如果进程拒绝退出，那么只需使用`-9`标志，它是 a`SIGTERM`并且不能忽略：

```
$ kill -9 1073 
```

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2015-10-01T12:15:16.967

适用于 Linux、OS X

```
killall node 
```

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2013-02-09T20:07:28.947

您可以使用`lsof`获取已绑定到所需端口的进程。

不幸的是，标志似乎因系统而异，但在 Mac OS X 上，您可以运行

```
lsof -Pi | grep LISTEN 
```

例如，在我的机器上，我得到类似：

```
mongod     8662 jacob    6u  IPv4 0x17ceae4e0970fbe9      0t0  TCP localhost:27017 (LISTEN)
mongod     8662 jacob    7u  IPv4 0x17ceae4e0f9c24b1      0t0  TCP localhost:28017 (LISTEN)
memcached  8680 jacob   17u  IPv4 0x17ceae4e0971f7d1      0t0  TCP *:11211 (LISTEN)
memcached  8680 jacob   18u  IPv6 0x17ceae4e0bdf6479      0t0  TCP *:11211 (LISTEN)
mysqld     9394 jacob   10u  IPv4 0x17ceae4e080c4001      0t0  TCP *:3306 (LISTEN)
redis-ser 75429 jacob    4u  IPv4 0x17ceae4e1ba8ea59      0t0  TCP localhost:6379 (LISTEN) 
```

第二个数字是 PID，他们正在侦听的端口位于“（LISTEN）”之前的右侧。找到流氓PID并`kill -9 $PID`以极端偏见终止。

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2017-09-22T21:17:30.523

**Windows 和 GitBash 终端** 我需要在 Windows / Webstorm / GitBash 终端中使用这个命令

```
cmd "/C TASKKILL /IM node.exe /F" 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2018-06-03T06:38:10.187

如果你想杀死一个特定的节点进程，你可以去命令行路由并输入：

```
ps aux | grep node 
```

获取所有节点进程 ID 的列表。现在您可以获取您的进程 id(pid)，然后执行以下操作：

```
kill -9 PID 
```

如果您想杀死所有节点进程，请执行以下操作：

```
killall -9 node 
```

-9 开关就像 Windows 上的结束任务。它将迫使该过程结束。你可以做：

```
kill -l 
```

查看 kill 命令的所有开关及其注释。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2019-06-14T16:18:00.877

**Linux**

打动你的朋友

```
ps aux | grep -i node | awk '{print $2}' | xargs  kill -9 
```

但这是你会记得的

```
killall node 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-01-28T13:35:57.227

你可以试试这个：

```
taskkill /IM node.exe -F 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2019-08-02T15:59:52.737

它在 Windows 10 中运行良好

```
taskkill /f /im node.exe 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-09-16T19:07:56.770

如果您使用的是 Windows，请按照以下步骤操作：

1.  打开任务管理器，寻找这个进程： [![显示节点进程的任务管理器 - Node.js 服务器端 JavaScript](../Images/4f1a1ef126395e022bc6d843522844ce.png)](https://i.stack.imgur.com/3J1BJ.png)

2.  然后只需右键单击并“结束任务”即可。

3.  就是这样，现在所有的 npm 命令都从开始运行。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-01-16T00:01:15.373

**多平台、稳定、最佳的解决方案：**

使用**[fkill](https://github.com/sindresorhus/fkill)**杀死正在占用您的端口的进程：

```
fkill -f :8080 
```

安装 fkill 使用命令：**npm i -g fkill**

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-01-04T14:11:00.087

你也可以试试：

`killall nodejs`

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-05-21T07:28:48.433

你可以试试

```
killall node 
```

你也可以试试

```
killall nodejs 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-06-21T11:54:33.677

我正在使用 windows 操作系统。

我杀死了所有节点进程并重新启动了它工作的应用程序。

尝试

```
taskkill /im node.exe 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-10-01T13:18:25.237

使用以下命令从批处理文件中杀死并重新启动节点服务器

```
 @echo off
cd "D:\sam\Projects\Node"
taskkill /IM node.exe -F
start /min cmd /C "node index.js"
goto :EOF 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-01-07T07:09:59.600

在 windows 命令中键入命令打击：

taskkill /f /im node.exe

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-07-23T19:35:06.663

由于您指定了 Windows。如果要将其包含在 bat 文件中，则可能不希望它在进程未运行时生成错误。

因此，为了防止“错误：找不到进程“node.exe”。”，您可以添加一个过滤器：

```
TASKKILL /F /IM node.exe /FI "PID gt 0" 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2017-11-24T06:47:06.853

按 cmd 或 bash ： Ctrl + C

# c - GLUT 计时器循环过早停止

> ID：14790911
> 
> 赞同：0
> 
> 时间：2013-02-09T19:55:11.630
> 
> 标签：c, opengl, glut

我遇到了一个奇怪的问题，`glutTimerFunc`当我以零延迟调用它时似乎随机停止工作。

这是我的代码：

```
#include <Windows.h>
#include <GL/gl.h>
#include <GL/glut.h>

int x = 0;

void init(void) 
{
    glClearColor(0.0, 0.0, 0.0, 1.0);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(0.0, 1.0, 0.125, 0.875, -1.0, 1.0);
}

void display(void)
{
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glBegin(GL_POLYGON);
    glColor3f(1.0, x ? 1.0 : 0.0, 0.0);
    glVertex3f(0.25, 0.25, 0.0);
    glVertex3f(0.75, 0.25, 0.0);
    glVertex3f(0.75, 0.75, 0.0);
    glVertex3f(0.25, 0.75, 0.0);
    glEnd();
    glFlush();
    glutSwapBuffers();
}

void timer(int value)
{
    x = !x;
    glutPostRedisplay();
    glutTimerFunc(0, timer, 0); // The line in question
}

int main(int argc, char** argv)
{
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB);
    glutInitWindowSize(800, 600);
    glutInitWindowPosition(200, 200);
    glutCreateWindow("hello");
    init();
    glutDisplayFunc(display);
    glutTimerFunc(0, timer, 0);
    glutMainLoop();
    return 0;
} 
```

我希望这会显示一个闪烁的正方形，它正在以 GPU 能够跟上的速度快速改变颜色。

这就是它最初的实际作用，但计时器循环似乎随机停止，方块停止改变颜色。有时它根本不会明显地闪烁，有时它会闪烁几秒钟然后停止。

`glutTimerFunc(1, timer, 0);`如果我将延迟设置为 1ms ( ) ，它不会停止。

为什么计时器循环意外停止？

我真的不关心如何解决它，只关心它为什么会发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T22:05:08.613

您的 GPU 更改值的速度比您的显示器绘制它的速度要快。

如果您有一台刷新率极高的显示器，您可能会看到它，但不幸的是，我们目前仅限于 60Hz/120Hz/240Hz。

当您删除 1ms 强制延迟时，您将导致系统成为一个非确定性系统（基于其他程序的速度，而不仅仅是您的程序），这就是您获得随机行为的原因。

# r - 在数据框中搜索和匹配

> ID：14790913
> 
> 赞同：2
> 
> 时间：2013-02-09T19:34:56.300
> 
> 标签：r, distance, dataframe

`R`如果这是非常基本的问题，我很陌生，所以请原谅我。使用下面的说明，我编辑了这个问题，希望更有意义。

我有一个`d`看起来像这样的数据框

```
SAMPLE <-c("blueberry", "broccoli")
OPT1 <-c("apple", "beef")
OPT2 <-c("oatmeal", "bacon")
RESPONSE <- c("oatmeal", "beef")
d <- data.frame(SAMPLE,OPT1,OPT2, RESPONSE) 
```

为新数据添加 NA 列

```
d$OPT1.D <- rep("NA",nrow(d)); 
```

和距离矩阵`dist`

```
X <-c("blueberry", "beef", "oatmeal", "broccoli")
blueberry <-c("0", "0.17", "0.09", "0.21")
beef <-c("0.15", "0", "0.979", "0.75")
oatmeal <- c("0.09", "0.375", "0", "0.71")
broccoli <- c("0.25", "0.671", "0.45", "0")
dist <- data.frame(X,blueberry,beef, oatmeal, broccoli) 
```

所以我想在`dist`for`d$RESPONSE`和中找到行/列匹配`d$SAMPLE`。在 的新列中`d$OPT1.D`，第一个条目应该是`0.09`，即 'oatmeal' 和 'blueberry' 之间的距离`dist`。第二个条目应该是`0.671`“牛肉”和“西兰花”之间的距离。

希望这更有意义？我使用了下面的代码，`d$OPT1.D <- dist[cbind(d$RESPONSE, d$SAMPLE)]`但它返回的是文本，而不是数字。非常感谢。

总的来说，这似乎应该是一个相当简单的操作，但在搜索了一下之后，我不知道这是否最好由 FOR 循环或 data.table 之类的包来完成。建议将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T03:25:17.937

您的第一个问题是 d 的类型是因子，当您尝试将其用作 dist[cbind(d$RESPONSE, d$OPT1)] 中的索引时，它们会转换为整数（而不是字符）。调用 data.frame 时需要使用 stringsAsFactors = FALSE。

```
d <- data.frame(SAMPLE,OPT1,OPT2, RESPONSE, stringsAsFactors=FALSE) 
```

第二个问题是 dist 是一个 data.frame，它没有行名。此外，您不需要 X 是一列。

```
dist <- cbind(blueberry,beef, oatmeal, broccoli)
rownames(dist) <- colnames(dist) <- X 
```

像这样它应该做你想做的事。

```
dist[cbind(d$RESPONSE, d$SAMPLE)]
[1] 0.090 0.671 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T20:11:14.483

这是为矩阵索引量身定制的，这是 R 的一个鲜为人知但非常强大的功能。您只需要这个命令（然后对 OPT2 重复）。

```
d$OPT1D <- dist[cbind(d$RESPONSE, d$OPT1)] 
```

顺便说一句，以其他人可以轻松读取的方式包含您的数据是有帮助的。这是我为获取它所做的工作。

```
d <- read.table(text="SAMPLE        OPT1        OPT2        RESPONSE        OPT1D        OPT2D
banana        blueberry   oatmeal     oatmeal         NA           NA
broccoli      beef        bacon       beef            NA           NA",
                 header=TRUE, stringsAsFactors=FALSE)
dist <- read.table(text="blueberry      beef           oatmeal
0              0.15           0.09
0.17           0              0.0872
0.09           0.0979         0", header=TRUE, stringsAsFactors=FALSE)
dist <- as.matrix(dist)
rownames(dist) <- colnames(dist)

> d
    SAMPLE      OPT1    OPT2 RESPONSE OPT1D OPT2D
1   banana blueberry oatmeal  oatmeal  0.09    NA
2 broccoli      beef   bacon     beef  0.00    NA 
```

# clojure - 从 Clojure 中的全局变量更改值

> ID：14790917
> 
> 赞同：2
> 
> 时间：2013-02-09T19:55:22.223
> 
> 标签：clojure

我是 Clojure 的初学者，我遇到了一个问题，我什至不确定是否可以在 Closure 中完成。

所以问题如下。我已经实现了一个函数，它从一个区间（直到一个限制）计算素数。

```
(defn gather_primes_in_range [range_start range_end target_number prime_list]
    (if (or (= 0 target_number) (> range_start range_end) (= FIND_MORE_PRIMES false)) 
        prime_list
        (do
            (if (is_prime? range_start)
                (gather_primes_in_range (+ range_start 1) range_end (- target_number 1) (conj, prime_list, range_start))
                (gather_primes_in_range (+ range_start 1) range_end target_number prime_list)
            )
        )
    )
)

(defn find_nr_of_primes_in_range [range_start range_end target_number]
    (if (< range_start 2)
        (gather_primes_in_range 2 range_end target_number [])
        (gather_primes_in_range range_start range_end target_number [])
    )
) 
```

这工作得很好。但我现在想要的是有一个全局变量，它应该存储在每个方法上，调用在变量中找到的素数，以便稍后查找。在 Python、Ruby 或 Scala 等其他语言中，我只需使用一个 Set 来完成此操作，然后在从函数返回之前向其中添加条目。但是在 Clojure 中，我不知道如何解决这个问题。

基本上我尝试的是，在某个地方声明了全局：

```
(def PRIMES_FOUND_SO_FAR #{}) 
```

然后以某种方式在返回时将条目添加到该变量中。这在 Clojure 中是否可行，如果可以，怎么办？我已经尝试使用`swap!`and`atom`或 set 来更改其他变量的值！但在任何情况下都无法在这里工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-10T00:24:52.397

首先，我强烈建议您阅读有关 clojure 代码约定[的内容 Clojure 的命名约定是什么？](https://stackoverflow.com/questions/6709131/what-are-clojures-naming-conventions)

让我向您展示您的代码的一些改进。

1）应用clojure命名约定。

然后从 切换`(+ variable 1)`到`(inc variable)`（与 相同的优化`dec`）。

也`(= FIND_MORE_PRIMES false)`可以简单地替换为`find-more-primes?`

最后条件`(= 0 smthng)`可以写成更惯用的风格`(zero? smthng)`

现在您的代码看起来更具可读性：

```
(defn gather-primes-in-range [range-start range-end target-number prime-list]
  (if (or (zero? target-number) (> range-start range-end) need-more-primes?)
    prime-list
    (do
      (if (is-prime? range-start)
        (gather-primes-in-range (inc range-start) range-end (dec target-number) (conj prime-list range-start))
        (gather-primes-in-range (inc range-start) range-end target-number prime-list))))) 
```

2）现在我们应该删除多余`do`的调用，因为它包装了唯一的一个函数调用。

最后一个技巧是通过将整个调用[交换到](http://clojure.org/special_forms#Special%20Forms--(recur%20exprs)`gather-primes-in-range``recur`

```
(defn gather-primes-in-range 
  [range-start range-end target-number prime-list]
    (if (or (zero? target-number) (> range-start range-end) need-more-primes?)
      prime-list
      (if (is-prime? range-start)
        (recur (inc range-start) range-end (dec target-number) (conj prime-list range-start))
        (recur (inc range-start) range-end target-number prime-list)))) 
```

是时候回答你的问题了。您不会从这种方法中受益

```
(def PRIMES_FOUND_SO_FAR #{}) 
```

因为你没有机会改变这一套。您唯一可以处理的就是从该结构创建一些新的不可变数据结构。

正如@georgek 提到的，您可以在这种特殊情况下简单地使用[atom 。](http://clojure.org/atoms)

```
(def PRIMES_FOUND_SO_FAR (atom #{})) 
```

向原子添加新的素数：

```
(swap! PRIMES_FOUND_SO_FAR conj prime-number) 
```

用于提取值的 Deref atom：

```
@PRIMES_FOUND_SO_FAR ;; or (deref PRIMES_FOUND_SO_FAR)
-> #{2 3 5 7 11} 
```

无论如何，您的代码有点必要，但您应该始终记住，clojure 是具有不可变数据结构、函数作为参数等的函数式语言。使用全局变量根本不是一个好主意。顺便说一句，这就是你的函数在 clojure 风格中的样子：

```
(defn gather-primes-in-range [start end target-number]
  (take target-number (filter is-prime? (range start end)))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-17T15:14:18.453

对于那些花费太多时间搜索如何在 clojure 中修改全局（根）变量的人来说，这里是解决方案：

```
(def user-remote-browser "anonymous") 
```

你可以从我想的任何地方修改它，但在相同的命名空间中：

```
(alter-var-root #'user-remote-browser (constantly name)) 
```

alter-var-root 使用函数修改变量，不断创建一个常量函数，这里返回字符串名称

# javascript - 启动和停止 setInterval 和 clearInterval

> ID：14790922
> 
> 赞同：0
> 
> 时间：2013-02-09T19:56:54.223
> 
> 标签：javascript, jquery

我对 Javascript 和 jQuery 非常陌生，并且可能通过尝试创建响应式幻灯片放映而跳入了深渊。在调整滑块大小以适应窗口方面，我有以下代码，使用一个函数，通过使用 setInterval 将单个幻灯片设置为等于滑块容器的宽度：

```
var slider          = $('.slider'),         // Get the div with a class of slider
    sliderWidth     = slider.width(),       // Get the width of the slider
    gallery         = $('.slider ul'),
    slides          = $('.slider ul').children('li'),
    noOfSlides      = slides.length,
    speed           = 5000,
    current         = 0,
    slideShowInt,
    responseSlider;

// Initially set the width of the li to equal the width of the slider
$('.slider ul').children('li').width(sliderWidth);                  

// Run a function that keeps making the 
//   li width equal the slider when window is resized
function resizeSlider(){
    responseSlider = setInterval(function(){
        slider      = $('.slider'),
        sliderWidth = slider.width();

        slides.width(sliderWidth);
        console.log(sliderWidth);           
    },10);
}

$(window).resize(resizeSlider);

clearInterval(responseSlider); 
```

这甚至可能不是执行此操作的正确方法，但我想知道是否可以使用 clearInterval 阻止 setInterval 运行，直到再次调整窗口大小。在当前状态下，查看控制台，它只是继续记录宽度。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:16:03.377

您不需要在 resize 方法中使用计时器来检查元素是否正在调整大小。resize 方法将监听要调整大小的元素。

[http://api.jquery.com/resize/](http://api.jquery.com/resize/)

```
var slider          = $('.slider'),         // Get the div with a class of slider
    sliderWidth     = slider.width(),       // Get the width of the slider
    gallery         = $('.slider ul'),
    slides          = $('.slider ul').children('li'),
    noOfSlides      = slides.length,
    speed           = 5000,
    current         = 0,
    slideShowInt;

$('.slider ul').children('li').width(sliderWidth);                  // Initially set the width of the li to equal the width of the slider

function resizeSlider(){

        slider          = $('.slider'),
        sliderWidth     = slider.width();

        slides.width(sliderWidth);
        console.log(sliderWidth);
}

$(window).resize(resizeSlider); 
```

如果这不是您想要采用的方法并且想要将计时器用于其他目的，请查看以下方法。

设置超时： [https ://developer.mozilla.org/en-US/docs/DOM/window.setTimeout](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)

clearTimeout： [https ://developer.mozilla.org/en-US/docs/DOM/window.clearTimeout](https://developer.mozilla.org/en-US/docs/DOM/window.clearTimeout)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:17:20.690

不完全确定您首先尝试使用 setInterval 的原因。除非您尝试随着时间的推移设置动画，否则您可以只听窗口调整大小，然后在没有间隔的情况下执行调整大小操作。如果您必须使用间隔，为什么不尝试这种效果：

```
var myFlag = false;

function resizeSlider(){
    responseSlider = setInterval(function(){
        var myFinalWidth = //what ever you want your final width to be 
        slider          = $('.slider'),
        sliderWidth     = slider.width();

        slides.width(sliderWidth);
        console.log(sliderWidth);
if(myFinalWidth == slides.width){
myFlag = true; 
}

    },10);                                                          
}

$(window).resize(function(){
resizeSlider(); 
if(myFlag){
clearInterval(responseSlider); 
}
}); 
```

您上面的代码不起作用的原因是因为您在全局范围内调用了清除间隔，因此它在您首先设置间隔之前执行。通过将你的调用放在同一个匿名函数中，它们应该一个接一个地执行。一种或另一种方式，我不完全按照你的要求，所以我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T20:52:03.667

我认为您想要的就像这样简单：

```
var slider = $('.slider'),// Get the div with a class of slider
    slides = $('.slider ul').children('li'),
    $w = $(window);

function handleResize() {
    $w.on('resize', resizeSlider);
}
function resizeSlider() {
    slides.width(slider.width());
    $w.off('resize');
    setTimeout(handleResize, 100);//adjust to the highest acceptable value.
}
resizeSlider();//run resizeSlider() to initialize everything. 
```

该`$w.off('resize')`语句与该语句一起降低了调用`setTimeout(handleResize, 100)`频率。`resizeSlider`否则频率会非常高，并且可能会使整个浏览器在调整大小时变得迟缓。

# python - 如何在不同情况下组合基于相同单词的数组？

> ID：14790927
> 
> 赞同：0
> 
> 时间：2013-02-09T19:57:29.460
> 
> 标签：python, nltk

我正在阅读[Python NLTK 书](http://nltk.org/book)。我通过运行以下命令对 Moby Dick 中的单词进行了频率分布：`fdist=FreqDist(text1)`其中 text1 是 Moby Dick 的 NLTK Text 对象，即小说中单词的列表。现在我有一个频率分布对象：

```
>>> fdist1
<FreqDist with 260819 outcomes> 
```

然而，列表中的许多单词在不同的情况下是相同的单词，例如大写和小写的单词“a”：

```
>>> fdist1['a']
4569
>>> fdist1['A']
167 
```

如何组合这两个词（以及单独列出的所有其他词）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:21:28.007

您可以创建一个新字典，遍历 FreqDict 并将键小写。像这样——

```
lc_dict = defaultdict(int)
for (key, value) in fdist1.items():
    lc_dict[key.lower()] = lc_dict[key.lower()] + value 
```

# delphi - 如何通过 CryptoAPI 将 Windows 证书存储中的证书导出为 Base64 字符串

> ID：14790930
> 
> 赞同：3
> 
> 时间：2013-02-09T19:57:39.673
> 
> 标签：delphi, certificate, cryptoapi

我有以下 C# 代码来执行我在主题中要求的操作：

```
public static void ExportCertificatesToFile(string FileName)
{
    stringBuilder builder = new StringBuilder();

    X509Store storeMy = new X509Store(StoreName.My);
    storeMy.Open(OpenFlags.ReadOnly);

    foreach (X509Certificate2 cert in storeMy.Certificates)
    {
        builder.AppendLine("-----BEGIN CERTIFICATE-----");   
              builder.AppendLine(Convert.ToBase64String(cert.Export(X509ContentType.Cert),  Base64FormattingOptions.InsertLineBreaks));
        builder.AppendLine("-----END CERTIFICATE-----");
    }

    storeMy.Close();

    File.WriteAllText(FileName, builder.ToString());
} 
```

正是我想使用 CryptoAPI (JwaWinCrypt.pas) 使用 Delphi 进行归档，我尝试了以下代码：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  hStore: HCERTSTORE;
  CertContext: PCertContext;
  pszString: PAnsiChar;
  pchString: Cardinal;
begin
  hStore := CertOpenSystemStore(0, PChar('MY'));

  try
    CertContext := CertEnumCertificatesInStore(hStore, nil);
    while CertContext <> nil do
    begin
      pszString := '';
      pchString := 0;
      CryptBinaryToString(CertContext.pbCertEncoded, CertContext.cbCertEncoded,  CRYPT_STRING_BASE64, pszString, pchString);

      ShowMessage(StrPas(pszString));

      CertContext := CertEnumCertificatesInStore(hStore, CertContext);
    end;
  finally
    CertCloseStore(hStore, 0);
  end;
end; 
```

问题是 ShowMessage 什么都不显示，字符串为空。有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:33:04.367

的文档说明了[`CryptBinaryToString`](http://msdn.microsoft.com/en-gb/library/windows/desktop/aa379887.aspx)这个`pszString`参数。

> 指向接收转换后的字符串的缓冲区的指针。要计算必须分配以保存返回的字符串的字符数，请将此参数设置为 NULL。该函数将在 pcchString 指向的值中放置所需数量的字符，包括终止 NULL 字符。

您有义务分配缓冲区，以便 API 函数可以填充它。你没有这样做。为了继续，您必须仔细阅读文档并遵守 API 的要求。

所以你需要像这样调用函数：

```
szString: AnsiString;
....
chString := 0;
CryptBinaryToString(CertContext.pbCertEncoded, CertContext.cbCertEncoded,  
    CRYPT_STRING_BASE64, nil, chString);
SetLength(szString, chString-1);
CryptBinaryToString(CertContext.pbCertEncoded, CertContext.cbCertEncoded,  
    CRYPT_STRING_BASE64, PAnsiChar(szString), chString); 
```

您还应该检查 的返回值`CryptBinaryToString`以检测故障。为简洁起见，我省略了它。

我还假设您的是 ANSI Delphi。我假设是因为您使用了`PAnsiChar`.

# clojure - prolog 问题的适用性

> ID：14790934
> 
> 赞同：2
> 
> 时间：2013-02-09T19:57:52.237
> 
> 标签：clojure, clojure-core.logic

作为开始使用 core.logic 的一种方式，我决定解决“九十九个 Prolog 问题”......

[https://github.com/rodnaph/99-core-logic-problems](https://github.com/rodnaph/99-core-logic-problems)

但是在遇到几个问题之后，根据我目前的理解，感觉 core.logic 并不是解决这些问题的正确方法（因为它们只需要一个答案）。

我可能误解了关系方法，但我是在找错树了吗？我应该只使用 Prolog 吗？

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T20:26:35.860

最初的问题是针对 Prolog 的，而在 Prolog 中，关系方法是您所拥有的唯一方法。这些问题中的大多数实际上是变相的函数式编程，并且不使用回溯，因此在 Clojure 中使用它们不会是惯用`core.logic`的。

也就是说，Prolog 的巧妙之处之一是您经常可以向后运行它们（主要是简单的），以生成所有可能的解决方案。例如，您可以通过`append`向后运行找到将列表分成两部分的所有方法。

# http - WinRT 应用程序中是否有最大 http 连接限制？

> ID：14790935
> 
> 赞同：0
> 
> 时间：2013-02-09T19:58:59.250
> 
> 标签：http, windows-8, windows-runtime

我正在制作一个 WinRT 应用程序，但我发现了一个奇怪的行为。我无法向我的服务器打开多个并行 http 请求。这个数字大约是 4-6 个请求（我不知道确切的数字）。

新请求卡在客户端应用程序的某个地方。

我有独立的实例`HttpClient`并且似乎他们共享这个限制，所以它不是每个客户端，而是每个应用程序。

我知道浏览器中的 http 连接限制，WinRT 有相同的行为吗？怎么调？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-06T23:35:31.047

这在 Windows 8.1 中看起来有所不同，因为您可以通过[HttpBaseProtocolFilter.MaxConnectionsPerServer设置最大连接数](http://msdn.microsoft.com/en-us/library/windows/apps/windows.web.http.filters.httpbaseprotocolfilter.maxconnectionsperserver.aspx)

请注意，这需要您使用新`HttpClient`的 in`Windows.Web.Http`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-12T00:42:23.150

似乎限制是每个域。

所以我为我的服务器域设置子域并循环调用服务器。

# django - Django 错误：settings.Databases 配置不正确

> ID：14790937
> 
> 赞同：1
> 
> 时间：2013-02-09T19:59:16.407
> 
> 标签：django, sage

我对 Django 完全陌生，不知道这意味着什么。我真的只是想为圣人设置代码节点。我尝试按照 codenode 网站上的安装指南进行操作，但是当我加载 localhost:8000 时，我收到以下消息和一大堆调试文本：

> settings.DATABASES 配置不正确。请提供 ENGINE 值。查看设置文档以获取更多详细信息。

有人可以引导我完成这个，或者至少给我指出一些东西吗？我已经查看了网站上的其他一些答案，但我无法关注其中的任何一个。我真的很感谢你的帮助。

根据要求，我的设置文件的 DATABASES 部分内容如下：

```
DATABASE_ENGINE = 'django.db.backends.sqlite3'           # 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
DATABASE_NAME = os.path.join(HOME_PATH, 'codenode.db') # Or path to database file if using sqlite3.
DATABASE_USER = ''             # Not used with sqlite3.
DATABASE_PASSWORD = ''         # Not used with sqlite3.
DATABASE_HOST = ''             # Set to empty string for localhost. Not used with sqlite3.
DATABASE_PORT = ''             # Set to empty string for default. Not used with sqlite3. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:06:38.590

SQLite 的示例数据库设置如下所示：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3', 
        'NAME': 'local.sqlite3',
        'USER': '',
        'PASSWORD': '',
        'HOST': '',
        'PORT': '',
    }
} 
```

# java - Java返回变量未初始化的错误

> ID：14790940
> 
> 赞同：-1
> 
> 时间：2013-02-09T19:59:21.890
> 
> 标签：java

我有以下 Java 代码：

```
import java.util.Scanner;

public class C2F_F2C {

public static void main(String[] args) {
    boolean isNotValid = false;
    double toConvert;
    do {
        System.out.print("What do you want to convert from Celsius to Fahrenheit? ");
        Scanner in = new Scanner(System.in);
        String toConvertString = in.nextLine();
        isNotValid = false;
        try {
            toConvert = Double.parseDouble(toConvertString);
        }
        catch (java.lang.NumberFormatException e) {
            System.out.println("Error: Not a number");
            isNotValid = true;

        }
    } while (isNotValid);

    double inCelsius = toCelsius(toConvert);
    System.out.println("The value " + toConvert + " in Celsius is " + inCelsius);

}
public static double toCelsius( double fahrenheit ) {

    double celsius = (fahrenheit -32)*(5/9);
    return celsius;

}

} 
```

但是，当我运行它时，它会引发以下错误：

```
Exception in thread "main" java.lang.Error: Unresolved compilation problems: 
    The local variable toConvert may not have been initialized
    The local variable toConvert may not have been initialized

    at C2F_F2C.main(C2F_F2C.java:24) 
```

我在 do..while 循环之前初始化了变量，并在 try..catch 循环中设置了值。似乎尚未设置变量。抱歉，如果这是一个相当基本的问题，但我似乎无法弄清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:00:32.530

不，您不会在循环和`try`.

这 ：

```
double toConvert; 
```

是声明，而不是初始化。

这 ：

```
double toConvert = 0.0; 
```

是一个初始化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T20:01:09.350

您需要初始化`local variables`. 你认为你有`initialized it inside the try block`，但编译器不这么认为。它认为如果**try 块没有运行怎么办？**您有未**初始化**的局部变量。您必须在声明本身期间对其进行初始化。

```
double toConvert=0.0d; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T20:02:12.937

> 我在 do..while 循环之前初始化了变量，

不，您没有初始化变量。你刚刚宣布了。默认情况下不初始化局部变量。

> 并在 try..catch 循环中设置值

是的，你确实这样做了，但是想想当你的初始化语句`try-catch`抛出异常时会发生什么？将处理异常，并且您的变量不会被初始化。然后在您的程序中，当您尝试访问该变量时，您期望会发生什么？

所以，只需给变量一个默认值。改变：

```
double toConvert; 
```

到：

```
double toConvert = 0.0; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T20:16:58.457

tldr; 虽然*可以*为变量分配初始值，但这样做是一种杂乱无章的做法，*会删除有关程序流程的有价值信息*。

相反，请考虑有问题的构造是什么。请注意，编译器*知道*循环体将至少执行一次，因为它使用 do-while 形式。这是失败案例的简化示例：

```
int b;
try {
  b = SomeMethodWhichMayOrMayNotThrowAnException();
} catch (Exception ex) {
  // b not assigned
}
// What is the value of b here?
// The compiler answer is: It *may* (or *might*) not be initialized. 
```

一个更*正确的*解决方案是在 catch`b` *内设置**或*以其他方式阻止它稍后以编译器可以验证的方式使用。

请记住，编译器*不能使用在编译时不知道的表达式*来确定哪些分支可以执行或不可以执行。因此，编译器*不知道*如果在那里捕获到异常，循环将再次执行。

但是，请考虑将代码更改为以下内容：

```
double ReadValueToConvert (Scanner in) {
    while (true) {
        System.out.print("What do you want to convert from Celsius to Fahrenheit? ");
        String toConvertString = in.nextLine();
        try {
            // No need to keep a flag for the loop
            return Double.parseDouble(toConvertString);
        }
        catch (java.lang.NumberFormatException e) {
            System.out.println("Error: Not a number");
        }
    }
    // Compiler smart enough to know execution can never get here
}

// only create one Scanner, not one per loop
Scanner in = new Scanner(System.in);
// toConvert guaranteed to be assigned
double toConvert = ReadValueToConvert(in); 
```

请注意它如何绕过一些问题并简化代码。

# r - 按日期对数据进行子集以在 R 中创建摘要

> ID：14790943
> 
> 赞同：1
> 
> 时间：2013-02-09T19:59:33.007
> 
> 标签：r

我有一个数据集，其中有 1997 年到 2009 年的数据，我想根据日期对数据进行子集化。

我写的代码如下：

```
creek <- read.csv("wolfcreek.csv")
library(ggplot2)
creek[1:10,]
colnames(creek) <- c("date","flow")
creek$date <- as.Date(creek$date, "%m/%d/%Y") 
```

我用来创建子集的代码如下：

```
creek1 <- subset(creek, as.Date(date) > (01-01-2000) & as.Date(date) <(01-01-2009)) 
```

但是当我尝试查看 creek1 的摘要时，我得到了

```
> creek1
[1] date flow
<0 rows> (or 0-length row.names) 
```

谁能告诉我在这里做错了什么？

我使用的数据集可以在[https://www.dropbox.com/s/eqpena3nk82x67e/creek.csv上找到](https://www.dropbox.com/s/eqpena3nk82x67e/creek.csv)

非常感谢。

最好的问候， 贾巴巴

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:07:11.333

您将日期与数字 -2000 和 -2009（1-1-2000 和 1-1-2009）而不是日期进行比较。

```
creek1 <- subset(creek, date > as.Date('01-01-2000', '%m-%d-%Y') & date < as.Date('01-01-2009', '%m-%d-%Y')) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T20:07:59.907

无需转换列日期，它已经在日期类中。然后您需要创建 dateMin 和 dateMax 将字符串强制为日期。

在这里，我以正确的格式给出字符串，否则您需要使用`format`（就像在@Mathew 回答中一样）

```
subset(creek, date > as.Date("2000-01-01") & date < as.Date("2009-01-01")) 
```

在这里，我将使用 package`xts`来实现他的快速子集和简洁的语法

```
library(xts)
dat.xts <- as.xts(creek$flow, order.by=creek$date)
dat.xts['2000-01/2009-01'] ## powerful and fast!! 
```

使用`quantmod`例如，它是时间序列，所以我们需要使用合适的包来处理它。在这里我子集，我绘制（我缩放我的时间序列）

```
 chart_Series(dat.xts['2000-01/2000-09']) 
```

![在此处输入图像描述](../Images/0e8a21692f14b66384ff3f8145c49eaa.png)

# c# - 在 EWL Windows 服务中调用 WindowsServiceBase.Tick() 的频率如何？

> ID：14790949
> 
> 赞同：1
> 
> 时间：2013-02-09T20:00:28.603
> 
> 标签：c#, asp.net, windows-services, background-process, enterprise-web-library

我已确定我的 EWL Web 应用程序中的 Web 请求上下文中不应该发生一些密集的操作。我看到 EWL 支持运行 Windows 服务，该服务非常适合在后台运行我的密集操作，而不会占用 Web 请求线程并迫使用户等待。

我已经到了需要实施的地步，`void WindowsServiceBase.Tick()`但我看不到`Tick()`被调用的频率。`Tick()`默认情况下多久调用一次，这是可配置的吗？

我还从消息来源看到 Windows 服务在调用之前发送了“健康检查”电子邮件`Tick()`。这背后的想法是什么？如果我不希望我的电子邮件中包含这些电子邮件的垃圾邮件怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:16:34.073

里面的代码`ServiceBaseAdapter`很神秘，但是仔细看你会发现它`Tick`会在`Init`完成十秒后被调用，从那时起，在最后一次`Tick`调用完成后十秒。

健康检查电子邮件将在每天午夜过后不久发出。它旨在让您知道该服务仍然存在。

# ant - ANT FTP如何重命名文件夹？

> ID：14790955
> 
> 赞同：2
> 
> 时间：2013-02-09T20:00:46.417
> 
> 标签：ant, ftp

我正在尝试在 tmp 目录中传输一些文件，然后将 tmp 目录重命名为“live”目录。似乎 ANT FTP 不支持目录重命名。任何建议，解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T13:06:48.870

有趣的问题。我没有意识到 ANT [ftp 任务](http://ant.apache.org/manual/Tasks/ftp.html)有多么受限，只支持有限范围的 ftp 操作。

我能提供的最佳解决方法是使用嵌入式[groovy](http://groovy.codehaus.org/The+groovy+Ant+Task)脚本，如下所示：

```
<target name="ftp">
    <taskdef name="groovy" classname="org.codehaus.groovy.ant.Groovy"/>
    <groovy>
        import org.apache.commons.net.ftp.FTPClient

        new FTPClient().with {
            connect "192.168.33.10"
            login "mark", "letmein"
            rename "testdir2", "testdir3"
            disconnect()
        }
    </groovy>
</target> 
```

笔记：

*   [我用vsftpd](https://security.appspot.com/vsftpd.html)测试了这个例子。必须在一切正常之前启用服务器端用户和写入操作。
*   我一直在其他地方读到一些 FTP 服务器不支持重命名目录。

# c++ - 关于零终止字符的困惑

> ID：14790958
> 
> 赞同：2
> 
> 时间：2013-02-09T20:01:00.503
> 
> 标签：c++

我一直对 C++/C 中的空终止字符串有疑问。例如，如果你有一个这样的字符数组：

```
char a[10]; 
```

然后你想读这样的字符：

```
for(int i = 0; i < 10; i++)
{
  cin >> a[i]; 
} 
```

并让我们输入以下单词：提问者

作为输入。

现在我的问题是'\0'会发生什么？如果我要反转字符串，并使其打印出来

```
renoitseuq 
```

空终止字符在哪里？我认为好的编程习惯是总是为零终止字符留一个额外的字符。但是在这个例子中，一切都被正确打印了，那么为什么要关心空终止字符呢？只是好奇。谢谢你的想法！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T20:07:18.817

在某些情况下，您会*得到*一个空终止符，而在某些情况下您必须自己要求一个。

```
const char* x = "bla"; 
```

是以 null 结尾的 C 样式字符串。它实际上有 4 个字符 - 3 + 空终止符。

您的字符串不是以空值结尾的。事实上，将其视为以 null 结尾的字符串会导致未定义的行为。如果您这样`cout <<`做，您将尝试读取超出您允许访问的内存，因为运行时将继续寻找一个空终止符并吐出字符，直到它到达一个。在你的情况下，你很幸运最后有一个正确的，但这不是保证。

`char a[10];`就像任何其他数组一样 - 未初始化的值，10 个字符 - 而不是 11 仅仅因为它是一个`char`数组。您不会期望`int b[10]`包含 10 个值供您使用，并在最后包含一个额外的值，`0`对吗？

好吧，读回来，我不明白为什么你会期望 C 字符串也是如此——这并不全是直观的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:27:00.243

`char a[10]`是十个字符，其中任何一个都可以是`'\0'`. 如果你把`"questioner"`它们都没有。要获得它，您需要`a[11]`并用“提问者”填充它，然后`'\0'`.

如果你要反转它，你会得到第一个`'\0'`在 a[?] 中的位置，反转到那个位置，然后添加一个空终止符。

这是 C 语言中的经典香蕉皮肤，不幸的是，即使您对它非常熟悉，它仍然会在最不合时宜的时刻踩到您的脚下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T20:08:07.247

您正在阅读 10 个字符，而不是字符串。我假设您还反向输出 10 个字符，因此 0-char 不起作用，因为您不将数组用作字符串，而是将其用作单个字符的数组...

# objective-c - 获取 Mac OSX 中最前面的窗口的时间顺序列表

> ID：14790959
> 
> 赞同：1
> 
> 时间：2013-02-09T20:01:00.890
> 
> 标签：objective-c, macos

我正在寻找一种方法来获取一个列表，其中包含最前面窗口的标题以及它成为 OSX 中最前面窗口的时间。我猜applescript将无法监听不同窗口成为最前面窗口的事件。我该如何解决这个问题？

# ef-code-first - Entity Framework 5 - 代码优先数组导航属性一对多与接口类型

> ID：14790960
> 
> 赞同：4
> 
> 时间：2013-02-09T20:01:01.350
> 
> 标签：ef-code-first, code-first, entity-framework-5, foreign-key-relationship, navigation-properties

这些是我的课：

```
public class Post : IPost
{
    public int Id { get; set; }
    public virtual int[] DuplicateOf { get; set; }
    public virtual ICommentInfo[] Comments { get; set; }
}

 public class CommentInfo : ICommentInfo
{
    public virtual string Author { get; set; }
    public virtual int Id { get; set; }
    public virtual string Text { get; set; }

    public virtual int PostId{ get; set; }
    [ForeignKey("PostId")]
    public virtual Post Post { get; set; }
} 
```

将此 CommentConfiguration 添加到 OnModelCreate() 中：

```
HasRequired(c => c.Post)
            .WithMany(b=>(ICollection<CommentInfo>) b.Comments)
            .HasForeignKey(b=>b.PostId)
            .WillCascadeOnDelete(true); 
```

我真的不明白为什么属性 Comments 总是为空，以及为什么 EF 不初始化它，因为它是虚拟的。我也尝试禁用延迟加载，但是当我尝试加载导航属性时`context.Post.Include("Comments")`出现错误告诉我“没有名为评论的导航属性”。所以我尝试使用Entity Framework Power Tools Beta 3查看实体数据模型，我发现即使两个表之间存在关系并且也有评论表端，表“发布”也没有导航端。

我真的不知道该转向哪个方向，可能是阵列的问题？我应该使用 Icollection 属性吗？虽然我无法更改该属性的类型，因为 Post 正在实现一个接口。

我看到的每个样本都清晰且易于制作。请帮助我..提前谢谢你。

**编辑：**

这是我在查看我昨天发布的[链接后所做的更改。](http://antix.co.uk/Blog/EF4-Code-First-and-Interface-Property-Types)

```
 public class Post : IPost
  {
    public int Id { get; set; }
    public virtual int[] DuplicateOf { get; set; }
    public virtual ICollection<CommentInfo> Comments { get; set; } 
    ICommentInfo[] IPost.Comments { 
      get { return Comments ; } 
      set { Comments = (CommentInfo[])value; } }
  } 
```

例外是：`System.ObjectDisposedException :The ObjectContext instance has been disposed and can no longer be used for operations that require a connection`并在应用程序尝试获取评论时引发。如果我删除`virtual`键异常消失，但属性始终保持为空，并且值不会以任何方式持续存在。

**EDITv2** 我已经解决了添加新属性并将旧属性映射到它的问题。

```
public class Post : IPost
{
    public int Id { get; set; }
    public virtual int[] DuplicateOf { get; set; }
    public ICommentInfo[] Comments
    {
        get { return ListComments.ToArray(); }

    }
    public List<CommentInfo> ListComments {get;set;}
} 
```

在我的 PostConfiguration OnModelCreate() 中，我使用 ListComments 属性作为导航属性，如下所示：

```
HasMany(b => b.ListComments)
                .WithRequired(c=>c.Post)
                .HasForeignKey(c=>c.PostId)
                .WillCascadeOnDelete(true); 
```

现在它完美地工作了，它比我预期的要简单，当我尝试接收评论集合时，如果我包含“ListComments”属性，我会得到 Post 数组。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T14:54:51.217

我无法访问您评论中的链接，但我认为您已更改

```
public virtual ICommentInfo[] Comments { get; set; } 
```

进入定义导航属性的常用方法：

```
public virtual ICollection<CommentInfo> Comments { get; set; } 
```

因为实体框架在其概念模型中不支持接口。

已释放上下文的异常意味着您在`Post`从数据库中获取对象*并*释放上下文后访问此属性。这会在与数据库的连接丢失时触发延迟加载。解决方案是使用[`Include`](http://msdn.microsoft.com/en-us/library/gg671236%28v=vs.103%29.aspx)：

```
var posts = context.Posts.Include(p => p.Comments).Where(...) 
```

现在可以一次性获取帖子和评论。

# wpf - WPF Surface 列表框数据绑定 - 列表框内容未填充内容

> ID：14790967
> 
> 赞同：0
> 
> 时间：2013-02-09T20:01:28.120
> 
> 标签：wpf, xaml, listbox

我`XmlDataProvider`用来从文件夹中获取图片，然后将它们显示在列表框中，但是列表框出现但没有这些图片时出现问题。图片位于项目目录中名为 Resources 的文件夹中。

这是代码，xmldata部分：

```
 <!-- List content -->
        <XmlDataProvider x:Key="tri" XPath="Root">
            <x:XData>
                <Root xmlns="">
                    <Entry Name="Cone" Image="\Resources\cone.jpg" />
                    <Entry Name="Cube" Image="\Resources\cube.jpg" />
                    <Entry Name="Cylinder" Image="\Resources\cylinder.jpg" />
                    <Entry Name="Icosahedron" Image="\Resources\icosahedron.jpg" />
                    <Entry Name="Octahedron" Image="\Resources\octahedron.jpg" />
                    <Entry Name="Sphere" Image="\Resources\sphere.jpg" />
                    <Entry Name="Torus" Image="\Resources\torus.jpg" />
                    <Entry Name="YinYang" Image="\Resources\yinyang.jpg" />
                    </Root>
            </x:XData>
        </XmlDataProvider> 
```

然后是列表框部分：

```
<s:SurfaceListBox x:Name="triList" Grid.Row="1" 
                      s:SurfaceDragDrop.DragCompleted="OntriListDragCompleted" 
                      s:SurfaceDragDrop.DragCanceled="OntriListDragCanceled" 
                      PreviewMouseLeftButtonDown="OntriListPreviewMouseLeftButtonDown" 
                      PreviewMouseMove="OntriListPreviewMouseMove"
                      PreviewMouseLeftButtonUp="OntriListPreviewMouseLeftButtonUp" 
                      ItemsSource="{Binding Source={StaticResource tri}, XPath=Entry}" 
                      Style="{StaticResource triListStyle}" 
                      PreviewTouchDown="OntriListPreviewTouchDown" 
                      PreviewTouchMove="OntriListPreviewTouchMove" 
                      PreviewTouchUp="OntriListPreviewTouchUp" Height="234" VerticalAlignment="Top" Visibility="Visible" ItemsPanel="{Binding}" AllowDrop="False" /> 
```

列表样式：

```
<Style x:Key="triListStyle" TargetType="{x:Type s:SurfaceListBox }">
            <Setter Property="Background" Value="{DynamicResource {x:Static s:SurfaceColors.ListBoxItemBackgroundBrushKey}}" />
            <Setter Property="SelectionMode" Value="Single" />
            <Setter Property="Height" Value="234" />
            <Setter Property="ItemTemplateSelector">
                <Setter.Value>
                    <sc:triListTemplateSelector>
                        <sc:triListTemplateSelector.NormalItemTemplate>
                            <DataTemplate >
                                <StackPanel RenderTransformOrigin="0.5, 0.5"                                
                               Margin="7,0,0,0" 
                               MinWidth="171" MaxWidth="171"                                
                               MinHeight="235" MaxHeight="235">
                                    <Image Margin="14,21,21,11" Source="{Binding XPath=@Image}" 
                            Height="149" Width="101" />
                                    <TextBlock Text="{Binding XPath=@Name}" 
                             MaxWidth="116"
                             FontSize="12"                 
                             Margin="21,0,21,21"
                             FontFamily="Segoe360" 
                             TextAlignment="Center"
                             TextWrapping="Wrap"
                             Foreground="{DynamicResource {x:Static s:SurfaceColors.ListBoxItemForegroundBrushKey}}"  
                             HorizontalAlignment="Center" />
                                </StackPanel>
                              </DataTemplate>
                        </sc:triListTemplateSelector.NormalItemTemplate>

                        <sc:triListTemplateSelector.StartingItemTemplate>
                            <DataTemplate>
                                <Grid Margin="17, 0, 0, -14">
                                    <StackPanel RenderTransformOrigin="0.5, 0.5" 
                                Margin="7,0,0,0" 
                                MinWidth="171" MaxWidth="171" 
                                MinHeight="235" MaxHeight="235">
                                        <Image Margin="14,21,21,11" 
                           Source="{Binding XPath=@Image}" 
                           Height="149" 
                           Width="101" />
                                        <TextBlock Text="{Binding XPath=@Name}" 
                            MaxWidth="116"
                            FontSize="12"          
                            Margin="21,0,21,21"
                            FontFamily="Segoe360" 
                            TextAlignment="Center"
                            TextWrapping="Wrap"
                            Foreground="{DynamicResource {x:Static s:SurfaceColors.ListBoxItemForegroundBrushKey}}"  
                            HorizontalAlignment="Center" />
                                    </StackPanel>
                                    <Rectangle Fill="{DynamicResource {x:Static s:SurfaceColors.SurfaceWindowBackgroundBrushKey}}" 
                               Width="17" HorizontalAlignment="Left" Margin="-26,-2.5,0,3" />
                                </Grid>
                            </DataTemplate>
                        </sc:triListTemplateSelector.StartingItemTemplate>                        
                    </sc:triListTemplateSelector>              

                </Setter.Value>
            </Setter> 
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>
                        <s:SurfaceScrollViewer Background="{TemplateBinding Background}" 
                                   VerticalScrollBarVisibility="Disabled" 
                                   HorizontalScrollBarVisibility="Hidden" 
                                   CanContentScroll="True">
                            <!--<sc:LoopingPanel IsItemsHost="True" /> -->
                        </s:SurfaceScrollViewer>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style> 
```

你能帮我找出问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:43:09.660

不知道为什么需要 XmlDataProvider 的东西来在 ListBox 中显示一些图像，但你需要的是一个带有[Image控件的](http://msdn.microsoft.com/en-us/library/ms610982.aspx)[DataTemplate](http://msdn.microsoft.com/en-us/library/ms589297.aspx) ，它实际上可以可视化每个图像：

```
<DataTemplate x:Key="imageTemplate">
    <Image Source="{Binding XPath=@Image}"/>
</DataTemplate> 
```

您可以通过设置[ItemTemplate](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemtemplate.aspx)属性在 ListBox 中使用它：

```
<s:SurfaceListBox ... ItemTemplate="{StaticResource imageTemplate}"/> 
```

* * *

Also make sure that the [Build Action](http://msdn.microsoft.com/en-us/library/0c6xyb66.aspx) is set to `Resource` for the image files in your Visual Studio project.

# paypal - Paypal：有没有办法在用户付款之前检查购物车？

> ID：14790969
> 
> 赞同：-1
> 
> 时间：2013-02-09T20:01:35.290
> 
> 标签：paypal, authorization, payment

Paypal 的 API 目前有什么方法可以在完成用户付款之前向我的网站发送授权请求？

我认为这里的答案是没有办法做到这一点，但是可以将“授权”设置为购物车参数而不是“销售”。这仍然留下了如何在回调中完成授权的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:11:53.850

也许这会在一定程度上澄清你的疑问。

当您的买家在结账期间授权支付金额时，授权和捕获开始。

例如，您可以使用将 PAYMENTACTION 元素设置为 Authorization 或 Order 的 PayPal Express Checkout API。

在您的买家完成结帐后，您可以将付款的交易 ID 与 Authorization & Capture API 一起使用。你可以：

*   获取部分金额或全部授权金额。

*   授权更高的金额，最高为最初授权金额的 115%（增加不超过 75 美元）。

*   取消之前的授权。

# database - 如何在进行数据库测试时解释 JMeter 结果

> ID：14790974
> 
> 赞同：1
> 
> 时间：2013-02-09T20:01:48.133
> 
> 标签：database, jmeter, load-testing, stress-testing

我最近开始使用 jMeter。我正在为此进行数据库压力测试。我在 lib 文件夹中添加了所需的驱动程序。我的 jMeter 已连接到数据库。它工作正常。

但我现在面临的问题是如何解释这些结果。我只测试了一个`SELECT`在一张表上执行的 SQL。下面是我在 JMeter 中的各种选项卡的屏幕截图。

下面的屏幕截图显示了我正在运行的线程数 (10) 和加速时间。

![在此处输入图像描述](../Images/679e4be27491828b65a5f15352fa1b64.png)

下面的屏幕截图显示了 JDBC 连接配置设置，我也无法理解。如果有人能对此提出一些想法，那就太好了，这与我在上图中运行的线程数相对应是什么意思。

![在此处输入图像描述](../Images/f9c8cfce1f2579288f92ebff11167b94.png)

下面的屏幕截图显示了摘要报告中的结果，我再次无法解释。解释这些结果的最佳方法是什么？对此的任何想法都会有很大帮助。

![在此处输入图像描述](../Images/56e655b5709d100b67c646207aec03e6.png)

下面的屏幕截图显示了我再次无法解释的结果。解释这些结果的最佳方法是什么？我正在寻找执行一个 Select SQL 需要多少时间。这个标签向我展示了很多信息，但不知道如何解释这些信息。对此的任何想法都会有很大帮助。

![在此处输入图像描述](../Images/63ed13534d04cb08398ce3988e3a058a.png)

谁能帮我理解这些结果？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T20:17:22.687

您应该使用以下之一：

*   [响应时间图](http://jmeter.apache.org/usermanual/component_reference.html#Response_Time_Graph)

*   [聚合图](http://jmeter.apache.org/usermanual/component_reference.html#Aggregate_Graph)

另请查看 jmeter-plugins 项目：

*   [http://code.google.com/p/jmeter-plugins/](http://code.google.com/p/jmeter-plugins/)

# performance - InstanceContextMode PerSession，每次调用都有一个新代理

> ID：14790978
> 
> 赞同：1
> 
> 时间：2013-02-09T20:02:10.013
> 
> 标签：performance, wcf

下面两种情况下WCF服务的性能会不会一样？

1.  *InstanceContextMode*设置为`PerCall`
2.  *InstanceContextMode*设置为`PerSession`，并且所有客户端都会为服务方法的每次调用创建一个新代理，并在调用后关闭代理（因此每次调用都有单独的会话）。没有来自一个客户端的并发呼叫。

所有限制参数都设置为其默认值。使用的绑定 - netTcp。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T18:05:12.010

WCF 处理调用的方式存在细微差别。在容量非常大的应用程序的可扩展性中，会话的使用对您的影响最大。PerCall 比其他模型更好地扩展。

真正的问题是在您的特定用例中是否可以检测到差异。只有你才能用基准来回答这个问题。

# python - 如何检查python中的字典列表中是否存在键？

> ID：14790980
> 
> 赞同：50
> 
> 时间：2013-02-09T20:02:15.013
> 
> 标签：python, python-2.7

假设我有一个如下所示的字典列表：

```
[{1: "a"}, {2: "b"}] 
```

指示某个键是否在列表中的一个字典中的pythonic方法是什么？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2013-02-09T20:04:51.253

我可能会写：

```
>>> lod = [{1: "a"}, {2: "b"}]
>>> any(1 in d for d in lod)
True
>>> any(3 in d for d in lod)
False 
```

尽管如果此列表中有很多字典，您可能需要重新考虑您的数据结构。

如果您想要找到第一个匹配项的索引和/或字典，一种方法是使用`next`and `enumerate`：

```
>>> next(i for i,d in enumerate(lod) if 1 in d)
0
>>> next(d for i,d in enumerate(lod) if 1 in d)
{1: 'a'}
>>> next((i,d) for i,d in enumerate(lod) if 1 in d)
(0, {1: 'a'}) 
```

`StopIteration`如果它不存在，这将引发：

```
>>> next(i for i,d in enumerate(lod) if 3 in d)
Traceback (most recent call last):
  File "<ipython-input-107-1f0737b2eae0>", line 1, in <module>
    next(i for i,d in enumerate(lod) if 3 in d)
StopIteration 
```

如果您想避免这种情况，您可以捕获异常或传递`next`一个默认值，例如`None`：

```
>>> next((i for i,d in enumerate(lod) if 3 in d), None)
>>> 
```

正如@drewk 的评论中所指出的，如果您想在多个值的情况下返回多个索引，您可以使用列表推导：

```
>>> lod = [{1: "a"}, {2: "b"}, {2: "c"}]
>>> [i for i,d in enumerate(lod) if 2 in d]
[1, 2] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-06-23T10:34:29.837

要查看单个字典，我们使用“in”关键字：

```
key in dic_instance 
```

要签入字典列表，遍历字典列表并使用'any'函数，因此如果在任何字典中找到键，它将不会进一步迭代列表。

```
dic_list = [{1: "a"}, {2: "b"}]
any(2 in d for d in dic_list)
True
any(4 in d for d in dic_list)
False 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-09T20:05:10.177

将`any`函数与生成器一起使用：

```
>>> d = [{1: "a"}, {2: "b"}]
>>> any(1 in x for x in d)
True 
```

`any`函数返回，如果传递给它`True`的至少一个元素是。但是你真的需要考虑，为什么你没有把所有的对放在一个单子里？`iterable``True``key: value``dict`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-16T05:26:34.040

```
parsedData=[]
dataRow={}
if not any(d['url'] == dataRow['url'] for d in self.parsedData):
       self.parsedData.append(dataRow) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-12T10:37:55.283

为了搜索深度嵌套的数据结构，我使用此代码递归查找列表和字典中的键

```
def isKey(dictORlist, key):
# dictORlist is the data structure you want to search
# key is the keyword you want to search for
def checkList(List, key):
    if isinstance(List, list):
        for i in List:
             return isKey(i, key)

result = checkList(dictORlist, key)
if isinstance(dictORlist, dict):
    for k in dictORlist.keys():
        data = dictORlist[k]
        if k == key:
            return True
        elif isinstance(data, dict):
            result = isKey(data, key)
        else:
            result = checkList(data, key)

if result == None:
    result = False
return result 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2020-01-03T16:18:41.853

我对 python2 与 python3 中可能发生的事情感到震惊。我将根据我最终为 python3 所做的事情来回答它。我的目标很简单：检查字典格式的 json 响应是否出错。我的字典被称为“令牌”，我正在寻找的密钥是“错误”

```
if ((token.get('error', None)) is None):
    do something 
```

我正在寻找关键的“错误”，如果它不存在，则将其设置为 None，然后检查该值是否为 None，如果是，请继续我的代码。一个 else 语句来处理 if 我确实有密钥“错误”

# powershell - Powershell 参数命名空间冲突

> ID：14790981
> 
> 赞同：1
> 
> 时间：2013-02-09T20:02:20.710
> 
> 标签：powershell

我是 Powershell 初学者，虽然不是编程 n00b。我正在尝试创建一个 IDisposable/RAII 风格的故障安全模式，有点像：

[http://www.sbrickey.com/Tech/Blog/Post/IDisposable_in_PowerShell](http://www.sbrickey.com/Tech/Blog/Post/IDisposable_in_PowerShell)

所以我有：

```
Function global:FailSafeGuard
{
param (
[parameter(Mandatory=$true)] [ScriptBlock] $execute,
[parameter(Mandatory=$true)] [ScriptBlock] $cleanup
)

    Try { &$execute }
    Finally { &$cleanup }
} 
```

我正在尝试使用它在不同的目录中执行一堆任务，在输入时使用 Push-Location，在输出时使用 Pop-Location。所以我有：

```
Function global:Push-Location-FailSafe
{
param (
$location,
[ScriptBlock] $execute
)
    FailSafeGuard {
        Push-Location $location;
        &$execute
        } { Pop-Location }  
} 
```

我发现 Push-Location-FailSafe 中的 $execute 参数与 FailSafe 函数中的 $execute 参数冲突。

```
Push-Location-FailSafe "C:\" {dir}
The expression after '&' in a pipeline element produced an invalid object. It must result in a command name, script block or CommandInfo object.
At C:\TEMP\b807445c-1738-49ff-8109-18db972ab9e4.ps1:line:20 char:10
+         &$ <<<< execute 
```

我认为这是名称冲突的原因是，如果我在 Push-Location-FailSafe 中将 $execute 重命名为 $execute2，它可以正常工作：

```
Push-Location-FailSafe "C:\" {dir}
    Directory: C:\

Mode                LastWriteTime     Length Name   
----                -------------     ------ ----   
d----        2011-08-18     21:34            cygwin 
d----        2011-08-17     01:46            Dell   
[snip] 
```

我对参数的理解有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:20:34.730

您的问题在于脚本块以及它们如何处理变量。脚本块中的变量在**执行之前不会扩展**。正因为如此，你正在打一个循环。我来给你展示：

当你调用`Push-Location-Failsafe`方法时，你的变量是这样的：

```
[DBG]: PS C:\>> (Get-Variable execute).Value
 dir 
```

但是然后你调用你的内部函数`FailSafeGuard`，你的`$execute`变量会变成这样：

```
[DBG]: PS C:\>> (Get-Variable execute).Value

        Push-Location $location;
        & $execute 
```

现在，当您的`try { }`块开始执行时，它开始扩展变量。当它展开时，`$execute`它会变成这样：

```
Try { 
    Push-Location $location;
    & $execute 
} 
```

然后它`$execute`再次膨胀。您的尝试块现在是：

```
Try { 
    Push-Location $location;
    & {
        Push-Location $location;
        & $execute
      } 
} 
```

你得到了一个由递归引起的无限循环。要解决此问题，您可以`$execute`在字符串中展开变量，然后从中创建脚本块。像这样：

```
Function global:Push-Location-FailSafe
{
param (
$location,
[ScriptBlock] $execute
)
    FailSafeGuard ([ScriptBlock]::Create("
        Push-Location $location;
        & $execute")) { Pop-Location }  
} 
```

请注意，当`$execute`其中包含变量时，此特定解决方案将出现问题。例如：`$execute = { $h = dir }`因为它会在创建脚本块时尝试扩展 $h。

**解决它的一种更简单更好的方法**是使用不同的变量名，这样一开始就没有冲突:-)

# vb.net - 在 Visual Studio 2010 中读取 XML 文件的随机行

> ID：14790991
> 
> 赞同：0
> 
> 时间：2013-02-09T20:04:12.010
> 
> 标签：vb.net, visual-studio-2010, visual-studio, xml-parsing

我刚刚开始在 Visual Studio 2010 中进行我的第一个编程项目。

我有一个已作为项目添加到程序中的 XML 文件。它具有以下结构：

```
<lexeme><grapheme>Aalesund</grapheme>    <phoneme>'A:lI2s,Vnd</phoneme></lexeme> 
```

有 400,000 个这样的条目，我想做的是在按下按钮时从 xml 文件中选择一个随机的词素，然后用相应的字素和音素填充两个标签。

有人能指出我开始的正确方向吗？我发现的教程用于加载特定数量的数据，而不仅仅是一个随机行并引用外部 xml 文件位置，而不是项目内部的一个。

提前致谢。

编辑：我应该说我的意思是伪随机数。我希望找到一个 rand() 函数，但似乎找不到？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:17:03.677

没有从 XML 中获取随机行的直接方法。依赖行号是危险的，因为如果要更改 XML 的格式：

```
<lexeme><grapheme>Aalesund</grapheme>    <phoneme>'A:lI2s,Vnd</phoneme></lexeme> 
```

至：

```
<lexeme>
  <grapheme>Aalesund</grapheme>    
  <phoneme>'A:lI2s,Vnd</phoneme>
</lexeme> 
```

您随机生成的行号可能不再与`<lexeme>`元素对齐。

我认为最好的方法是获取`<lexeme>`列表中的所有元素并随机生成列表范围内的数字：（请
*原谅我，但代码示例是在 c# 中，我不相信我的VB.Net 足以在 VB 中编写我的代码）*

```
var lexemeList = xDocument.Descendants("lexeme").ToList();
var random = new Random();

var randomLexeme = lexemeList[random.Next(0, lexemeList.Count-1)]; 
```

`randomLexme`然后将有一个伪随机`<lexeme>`元素，您可以根据需要对其进行解析以获取适当的`<grapheme>`和`<phoneme>`元素。

但是，如果您这样做，请记住 .net`Random`类是伪随机的，并且使用当前时间戳作为种子。如果您要定期访问对象，建议将`var random = new Random()`变量设为类级字段并创建一次，然后使用该`Next()`方法获取下一个数字，而不是`Random()`在需要随机数时创建新对象.

这是 VB.Net 中一个更独立的函数：

```
Dim rand = New Random()
Dim myXml = New XDocument()

Function GetRandomLexeme() as XElement

    Dim lexemeList = myXml.Descendants("lexeme").ToList()
    Dim randomLexeme = lexemeList(rand .Next(0, lexemeList.Count - 1))

    GetRandomLexeme = randomLexeme

End Function 
```

# c++ - 如何将带有指针数组的 C++ 类传递给 CUDA？

> ID：14790999
> 
> 赞同：2
> 
> 时间：2013-02-09T20:04:55.190
> 
> 标签：c++, class, pointers, cuda

更清楚地说，我想要的是传递指针和它们指向设备的所有数据。为了测试如何实现这个目标，我编写了一个简单的类：

```
class vecarray{
    public:
        int * vecptr[N];                //array of pointers pointing to array
        int dim[N];                     //store length of each array pointed to
        __device__ __host__ vecarray(); //constructor
        __device__ __host__ int sum();  //sum up all the elements in the array being              
                                       //pointed to
}

vecarray::vecarray(){
    for(int i = 0; i<N; i++)
    {
        vecptr[i] = NULL;
        dim[i] = 0;
    }
}

int vecarray::sum(){
    int i=0, j=0, s=0;
    for (i=0; i<N; i++)
        for(j=0; j < dim[i]; j++)
            s += vecptr[i][j];
    return s;
} 
```

然后我在下面的代码中使用这个类：

```
#define N 2
__global__ void addvecarray( vecarray * v, int *s){
    *s = v->sum();
}

int main(){                                 //copy *V to device, do sum() and pass back 
    vecarray *v, *dev_v;                    //the result by dev_v
    v = new vecarray;
    dev_v = new vecarray;
    int a[3] = {1,2,3};                     //initialize v manually
    int b[4] = {4,5,6,7};
    int result = 0;
    int * dev_result;
    v->vecptr[0] = a;
    v->vecptr[1] = b;
    v->dim[0] = 3; v->dim[1] = 4;

    cudaMalloc((void**)&dev_v, sizeof(vecarray));      

    cudaMemcpy(dev_v, v, sizeof(vecarray),cudaMemcpyHostToDevice); //copy class object 

    for(int i = 0; i < N; i++){
        cudaMalloc((void**)&(dev_v->vecptr[i]), v->dim[i]*sizeof(int));
    }

    for(int i = 0; i<N; i++ ){                   //copy arrays
    cudaMemcpy(dev_v->vecptr[i], v->vecptr[i], v->dim[i]*sizeof(int), cudaMemcpyHostToDevice));
    }
    addvecarray<<<1,1>>>(dev_v, dev_result);

    cudaMemcpy(&result, dev_result, sizeof(int), cudaMemcpyDeviceToHost);
    printf("the result is %d\n", result);
} 
```

该代码通过了 nvcc 编译器，但在运行时因分段错误而失败。我检查了问题在于 for 循环中的两个 cudaMalloc 和 cudaMemcpy 操作。所以我的问题是我应该如何将这个对象传递给 CUDA？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T21:49:26.850

您的代码中有几个错误。正如我在评论中提到的，关键错误之一是如何为类中指针引用的数据区域分配内存。那里的关键错误是您传递了一个指向已经存在于设备内存中的 cudaMalloc 的指针。我们可以通过创建一组额外的指针来解决这个问题，我们将使用这些指针为类中指向的数组分配所需的设备存储空间。此外还有一些其他错误，例如您没有为`dev_result`. 以下代码修复了我能找到的所有错误，我相信会给出正确的结果。我还添加了一个 cuda 错误检查的参考形式，您可能会发现在您的项目中使用它很有用：

```
#include <stdio.h>

#define N 2
#define cudaCheckErrors(msg) \
    do { \
        cudaError_t __err = cudaGetLastError(); \
        if (__err != cudaSuccess) { \
            fprintf(stderr, "Fatal error: %s (%s at %s:%d)\n", \
                msg, cudaGetErrorString(__err), \
                __FILE__, __LINE__); \
            fprintf(stderr, "*** FAILED - ABORTING\n"); \
            exit(1); \
        } \
    } while (0)

using namespace std;

class vecarray{
    public:
        int *vecptr[N];                //array of pointers pointing to array
        int dim[N];                     //store length of each array pointed to

        __device__ __host__ vecarray(); //constructor
        __device__ __host__ int sum();  //sum up all the elements in the array being
                                       //pointed to
};

vecarray::vecarray(){
    for(int i = 0; i<N; i++)
    {
        vecptr[i] = NULL;
        dim[i] = 0;
    }
}

__device__ __host__ int vecarray::sum(){
    int i=0, j=0, s=0;
    for (i=0; i<N; i++)
        for(j=0; j < dim[i]; j++)
            s += vecptr[i][j];
    return s;
}

__global__ void addvecarray( vecarray * v, int *s){
    *s = v->sum();
}

int main(){                                 //copy *V to device, do sum() and pass back
    vecarray *v, *dev_v;                    //the result by dev_v
    v = new vecarray;
    int a[3] = {1,2,3};                     //initialize v manually
    int b[4] = {4,5,6,7};
    int result = 0;
    int *dev_result;
    v->vecptr[0] = a;
    v->vecptr[1] = b;
    v->dim[0] = 3; v->dim[1] = 4;
    int *vptr[N];

    cudaMalloc((void**)&dev_v, sizeof(vecarray));
    cudaCheckErrors("cudaMalloc1 fail");
    cudaMemcpy(dev_v, v, sizeof(vecarray),cudaMemcpyHostToDevice); //copy class object
    cudaCheckErrors("cudaMemcpy1 fail");

    for(int i = 0; i < N; i++){
        cudaMalloc((void**)&(vptr[i]), v->dim[i]*sizeof(int));
        cudaCheckErrors("cudaMalloc2 fail");
        cudaMemcpy(&(dev_v->vecptr[i]), &vptr[i], sizeof(int*), cudaMemcpyHostToDevice);
        cudaCheckErrors("cudaMemcpy2 fail");
    }

    for(int i = 0; i<N; i++ ){                   //copy arrays
        cudaMemcpy(vptr[i], v->vecptr[i], v->dim[i]*sizeof(int), cudaMemcpyHostToDevice);
        cudaCheckErrors("cudaMemcpy3 fail");
    }
    cudaMalloc((void **)&dev_result, sizeof(int));
    cudaCheckErrors("cudaMalloc3 fail");
    addvecarray<<<1,1>>>(dev_v, dev_result);

    cudaMemcpy(&result, dev_result, sizeof(int), cudaMemcpyDeviceToHost);
    cudaCheckErrors("cudaMemcpy4 fail");
    printf("the result is %d\n", result);
    return 0;
} 
```