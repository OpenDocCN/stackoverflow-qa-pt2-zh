# StackOverflow 问答 13482000-13482999

# java - 带有 Hibernate 实体的奇怪 Spring Transactional JUnit 测试为空

> ID：13482002
> 
> 赞同：0
> 
> 时间：2012-11-20T20:57:24.343
> 
> 标签：java, mysql, spring, hibernate, junit

一段时间以来，我一直对这个问题感到恼火和困扰，最后想出了一个例子来说明正在发生的事情。希望其他人对发生的事情有丝毫线索。

我有一个 Spring Transactional JUnit 测试`@Rollback(true)`。测试包含在 HibernateTransaction 中，它在单元测试结束时自动回滚数据库更改。这似乎是有效的，但是在这个使用这个查询的奇怪场景中，只有在我的单元测试中，这个`@Transactional`业务逻辑方法才会返回 null。

```
@Test
@Rollback(true)
public void testObscureIssue() throws Exception {
    // Not important...
    l = createLeague();
    t1 = createTeam(l);
    User u = userBo.getUser(1L, false);

    Player player = TestUtils.getInstance().createTestData(Player.class, 1).get(0);
    player.setUser(u);
    player.setGender("M");
    player.setStartingActivityLevel(ActivityLevelEnum.Sedentary);
    playerBo.addOrUpdate(player);
    TeamPlayer tp = new TeamPlayer(t1, player);
    leagueStructureBo.addOrUpdate(tp);

    // This test will pass 10% of the time, seemingly random. Randomness only inside of unit test
    Team t = playerBo.getCurrentTeam(player.getPlayerID());
    if (t == null) throw new OutOfMemoryError("What is this... I don't even...");

    Team expected = playerBo.getCurrentTeam(player.getPlayerID());
    assertNotNull(expected);
    assertEquals(t1, expected);
} 
```

因此，该方法`playerBo.getCurrentTeam`始终在应用程序中正确返回，并且如果我在单元测试中的任何位置放置断点然后一次单步执行代码，则始终正确返回。但是，在没有调试的情况下简单地运行单元测试时，大多数情况下它会失败。

我想也许这里发生了一些赛车情况，但即使我`Thread.sleep(400000L);`在调用这个 Transactional 方法之前写了一个语句，它仍然会失败。

事务方法的代码：

```
@Override
@Transactional
public Team getCurrentTeam(long playerId) {
    String qry = "select t from Team as t inner join t.teamPlayers as tp " +
            "inner join tp.player as tpp where tpp.playerID = :playerId and (((current_timestamp() between tp.startDate and tp.endDate " +
            "and tp.endDate is not null) or (tp.endDate is null and current_timestamp() > tp.startDate)))";
    Object wtf = sessionFactory.getCurrentSession().createQuery(qry)
            .setParameter("playerId", new Long(playerId)).uniqueResult();
    return (Team)wtf;
} 
```

事务属性都是 Spring Hibernate4 TransactionManager 的默认值。

您可以在代码示例中看到我已经清楚地创建了这个 Team 实体，并且日志显示了为新记录生成的 ID。我可以使用 HQL 通过该 ID 直接查询记录，它会返回，但是在这个 Transactional 方法中上面的这个 HQL 查询仍然会返回 null，除非我在调试模式下单步执行它，然后它就可以工作了。

这是嵌套事务的问题吗，因为我的印象是在最外面的事务回滚之前，什么都不会回滚。为什么只使用这一种特定方法？这是 Hibernate 4 或 Spring 3.1.1 的错误吗？我正在使用 MySQL InnoDB，这可能是 MySQL InnoDB 处理数据库事务的方式的问题吗？

欢迎任何关于其他尝试的建议，因为我在这里完全没有想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:35:50.900

我的猜测是问题出在使用`current_timestamp()`. 您可能使用 now 作为开始日期创建了 TeamPlayer，如果您设置断点，则当前时间戳系统会比开始日期更早，而如果您不设置断点，则代码足够快，10%时间，使当前时间戳等于团队玩家的开始日期。

# python - 如何在使用 django 登录后重定向，同时传递变量并保存到数据库？

> ID：13482004
> 
> 赞同：0
> 
> 时间：2012-11-20T20:57:29.953
> 
> 标签：python, django, redirect, httpresponse

我试图让用户在退出时收藏视频。我正在使用@login_required 强制用户登录，将视频保存到他们的帐户，然后重定向回他们所在的页面。我收到一条错误消息

```
UnboundLocalError at /loggedout_fav/
local variable 'video' referenced before assignment 
```

在loggedout_fav 下的返回行上。我在视图中放置了一条打印语句，但也没有任何内容打印到控制台。关于如何解决它的任何建议？

# html

```
<form method = 'post' action = '/loggedout_fav/'> {% csrf_token %}
    <input type="hidden" value="{{video}}" name = "video_add_loggedout"/>
    <input type='submit' value='Login to plate this video'/>
</form> 
```

# 网址

```
url(r'^loggedout_fav/', 'loggedout_fav'), 
```

# 看法

```
def loggedout_fav(request):
    if 'video_add_loggedout' in request.POST:
        video = request.POST['video_add_loggedout']
        print video
        print 'test'
        try:
            s = Everything.objects.get(profile = request.user, video = request.POST['video_add_loggedout'], playlist = 'Favorites', platform = 'youtube')
            print "already exists"
        except:
            p = Everything(profile = request.user, video = request.POST['video_add_loggedout'], playlist = 'Favorites', platform = 'youtube')
            p.save()
    return HttpResponseRedirect(reverse('reserve.views.trending_video_player', kwargs={'author':'youtube', 'video':video}))

def trending_video_player(request,author,video):
    ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:27:25.290

我相信jpic所说的很可能是问题所在。我发布了一个单独的答案来澄清这个问题： UnboundLocalError 是一个 python 错误，这意味着在你的代码中的某处你在定义它之前访问了一个变量。

在您的“loggedout_fav”视图代码中，我看到您尝试访问最后一行中的“video”变量。当`if 'video_add_loggedout' in request.POST`语句不为 True（因此嵌套块未执行）时，'video' 变量将不会被初始化并且会引发此异常。实际上，这意味着您尝试访问您的视图而不发布“video_add_loggedout”变量。我将按如下方式重新组织视图：

```
def loggedout_fav(request):
    try:
        Everything.objects.get_or_create(profile=request.user, video=request.POST['video_add_loggedout'], playlist='Favorites', platform='youtube')
    except KeyError:
        #do something when the variable is not set. eg:
        return HttpResponseBadRequest()
    return HttpResponseRedirect(reverse('reserve.views.trending_video_player', kwargs={'author':'youtube', 'video':request.POST['video_add_loggedout']})) 
```

上面还演示了如何使用该`get_or_create`方法稍微清理代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:03:11.453

将值保存到会话。[https://docs.djangoproject.com/en/dev/topics/http/sessions/](https://docs.djangoproject.com/en/dev/topics/http/sessions/)

确保在用户登录之前获取会话中的值，这样您就不会丢失它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:10:13.237

您使用了 'id' 而不是 'name' ！所以这永远不是真的：

```
if 'video_add_loggedout' in request.POST: 
```

并且`video`永远不会设置，所以它会窒息（你应该已经发布了堆栈跟踪 BTW，我不得不扭转它）：

```
return HttpResponseRedirect(reverse('reserve.views.trending_video_player', kwargs={'author':'youtube', 'video':video})) 
```

**首先**，您可以修复您的 Python，如下所示：

```
def loggedout_fav(request):
    if 'video_add_loggedout' not in request.POST:
        return HttpResponseBadRequest()

    video = request.POST['video_add_loggedout']
    try:
        s = Everything.objects.get(profile = request.user, video = request.POST['video_add_loggedout'], playlist = 'Favorites', platform = 'youtube')
        print "already exists"
    except:
        p = Everything(profile = request.user, video = request.POST['video_add_loggedout'], playlist = 'Favorites', platform = 'youtube')
        p.save()
    return HttpResponseRedirect(reverse('reserve.views.trending_video_player', kwargs={'author':'youtube', 'video':video})) 
```

**当然**，也要修复你的 HTM，这个：

```
<input type="hidden" value="{{video}}" id = "video_add_loggedout"/> 
```

应该：

```
<input type="hidden" value="{{video}}" name="video_add_loggedout"/> 
```

# javascript - 双重但不同的显示子句

> ID：13482006
> 
> 赞同：1
> 
> 时间：2012-11-20T20:57:38.163
> 
> 标签：javascript, css, user-interface

我在这里找到了一个关于全 CSS 下拉菜单的很棒的 HOWTO（我想说）：[创建 Vimeo-like top navigation](http://www.jankoatwarpspeed.com/post/2009/01/19/Create-Vimeo-like-top-navigation.aspx)。

浏览 CSS 我对规则感到困惑

```
#menu ul { 
    padding:0px; 
    margin:0px; 
    display:block; 
    display:inline;
} 
```

谁能解释双重但不同的显示条款的作用？

干杯

# asp.net-mvc - 如何在运行前编译cshtml

> ID：13482007
> 
> 赞同：52
> 
> 时间：2012-11-20T20:57:48.247
> 
> 标签：asp.net-mvc, jquery-mobile, razor

我相信我在某处读到了其中一个项目文件中的设置，允许您`.cshtml`在构建 Visual Studio 项目时编译文件。

刚开始使用Mobile，当我在文件`MVC/Razor/Query`内的代码块中出现错误时，我对“错误加载页面”感到恼火`.cshtml`

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-11-20T21:00:53.137

`<MvcBuildViews>true</MvcBuildViews>`在 .csproj 文件的`<PropertyGroup>`元素中设置。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-04-16T01:14:50.890

除了真正的设置，您还需要确保在您的 csproj 中以下设置处于活动状态：

```
<Target Name="MvcBuildViews" AfterTargets="AfterBuild" Condition="'$(MvcBuildViews)'=='true'">
<AspNetCompiler VirtualPath="temp" PhysicalPath="$(WebProjectOutputDir)" />
</Target> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-11-15T12:00:45.790

**MvcBuildViews 通常是错误**的，因为它不会按照您想要的术语预编译视图。

MvcBuildViews 临时构建视图并将构建结果返回给构建过程，以在 VS 错误窗口中显示可能的构建错误。

为了实现真正的生产发布视图预编译，您必须在项目的*发布 Web 应用程序*配置窗口中正确设置特定值。

有关如何执行此操作的主要文章，请参见此处，并[通过](http://blog.deltacode.be/2017/01/08/fix-slow-startup-of-asp-net-mvc-5-on-azure-app-services/)msBuild[和](https://gunnarpeipman.com/aspnet/asp-net-mvc-precompiling-views/)Azure 更深入地了解如何执行此操作。

# ruby - Ruby DevKit 问题

> ID：13482012
> 
> 赞同：1
> 
> 时间：2012-11-20T20:58:18.123
> 
> 标签：ruby, makefile, devkit

我在安装 DevKit 时遇到了一些问题。基本上，它不起作用。我已经按[书籍](https://github.com/oneclick/rubyinstaller/wiki/Development-Kit)安装了它，但安装未通过测试：

```
gem install rdiscount --platform=ruby 
```

返回以下错误：

```
C:\Ruby 1.9.3-p327\DevKit>gem install rdiscount --platform=ruby
Building native extensions.  This could take a while...
ERROR:  Error installing rdiscount:
        ERROR: Failed to build gem native extension.

        "C:/Ruby 1.9.3-p327/bin/ruby.exe" extconf.rb
checking for random()... no
checking for srandom()... no
checking for rand()... yes
checking for srand()... yes
creating Makefile

make
Makefile:219: *** multiple target patterns.  Stop.

Gem files will remain installed in C:/Ruby 1.9.3-p327/lib/ruby/gems/1.9.1/gems/r
discount-1.6.8 for inspection.
Results logged to C:/Ruby 1.9.3-p327/lib/ruby/gems/1.9.1/gems/rdiscount-1.6.8/ex
t/gem_make.out 
```

这也是没有用的[。](https://github.com/oneclick/rubyinstaller/wiki/Troubleshooting#wiki-gems_fails_comspec_autorun)那里一切都很好。

gem_make.out 包含以下内容：

```
"C:/Ruby 1.9.3-p327/bin/ruby.exe" extconf.rb
checking for random()... no
checking for srandom()... no
checking for rand()... yes
checking for srand()... yes
creating Makefile

make
Makefile:219: *** multiple target patterns.  Stop. 
```

在这一点上，我要疯了。我尝试只运行 extconf.rb

```
C:\Ruby 1.9.3-p327\lib\ruby\gems\1.9.1\gems\rdiscount-1.6.8\ext>ruby extconf.rb
checking for random()... no
checking for srandom()... no
checking for rand()... yes
checking for srand()... yes
creating Makefile 
```

没有错误！

我的操作系统是 Windows 7 x64！系统上没有安装其他版本的 Ruby 或 DevKit，这是 PATH

```
PATH=C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\Ruby 1.9.3-p327\bin;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\pik;C:\Ruby 1.9.3-p327\DevKit\bin;C:\Ruby 1.9.3-p327\DevKit\mingw\bin 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T00:37:46.023

我可能错了，但我认为 Ruby 安装路径被解读为两个不同的参数，实际上`"C:/Ruby" "1.9.3-p327/bin/ruby.exe"`是因为路径没有被转义（这是正确的词吗？基本上用引号括起来）。

我建议你看看[Stack Overflow 上的一个类似问题](https://stackoverflow.com/questions/8888061/installing-dm-types-on-windows-win7-x64 "堆栈溢出：在 Windows 上安装 dm-types。 (Win7 x64)")。我遇到了和你一样的问题，这个解决方案直接解决了。

# javascript - 高级 javascript 日期范围函数，可针对参考开始月份/期间范围进行调整

> ID：13482015
> 
> 赞同：0
> 
> 时间：2012-11-20T20:58:34.797
> 
> 标签：javascript, jquery, math, datetime

解释这一点很棘手，但找到最简单的方法可能是一个有趣的挑战，我昨天花了几个小时试图重构一段 .NET C# 代码，但没有想出任何优雅的东西。

因此，任何拥有良好 JavaScript、数学、日期问题解决头脑的人都可能拥有一个很好的灯泡时刻！

我基本上需要能够生成日期范围的开始（和结束）。即过去 12 个月、过去 6 个月、过去 24 个月等。

但它不仅仅是一个简单的 CurrentDate 减去年份类型问题。

我们使用周期范围来可视化我们呈现的数据，即每月、每双月、每季度、每半年。但我们也有一个参考月份，周期范围应从该参考月份开始，即周期范围应始终从 7 月开始。因此，从 7 月 1 日到 9 月 30 日，无论当前日期如何等，您总是会得到一个干净利落的季度。

考虑到这一点，我们总是希望开始日期考虑这个参考，参考总是一个月，所以所有开始日期都是一个月的第一天。结束日期将是一个月的最后一天，仅供参考，大部分时间实际上是在当前日期之后，因为我们希望最终期间范围包括今天的日期。

所以我们需要一个可以传入的函数（我已经包含了示例值）：

```
currentDate = 21 NOV 2012
dateRangeInMonths = 12 (Year)
periodRangeInMonths = 3 (Quarterly)
periodRangeReferenceStartMonth = 7 (July) 
```

上述答案如下，因为它符合以下范围：

```
01 JAN 2012 - 31 MAR 2012
01 APR 2012 - 31 JUN 2012
01 JUL 2012 - 30 SEP 2012
01 OCT 2012 - 31 DEC 2012

returns startDate = 01 JAN 2012
returns endDate = 31 DEC 2012 
```

所以这是正确的，因为我们的期间开始于参考月份 7 月，我们将今天的日期包括在最终范围内。

显然，它还需要有利于与前几年的重叠。所以另一个例子可能是：

```
currentDate = 10 FEB 2012
dateRangeInMonths = 6 (Half Year)
periodRangeInMonths = 2 (Bimonthly)
periodRangeReferenceStartMonth = 1 (Jan) 
```

回答：

```
01 SEP 2011 - 31 OCT 2011
01 NOV 2011 - 31 DEC 2011
01 JAN 2012 - 29 FEB 2012

returns startDate = 01 SEP 2011
returns endDate = 29 FEB 2012 
```

此外，如果它有任何帮助，这是 ac# 代码，它可以满足我的要求，但远非优雅，并且依赖于及时循环等。所以你可能想忽略它哈哈。

```
if (this.PeriodRangeInMonths > 1)
{
    this.StartDate = new DateTime(DateTime.Now.Year, this.PeriodRangeReferenceStartMonth, 1).AddMonths(0 - this.DateRangeInMonths);
    var temp = DateTime.Now.AddMonths(0 - this.DateRangeInMonths).AddMonths(this.PeriodRangeInMonths);
    while (this.StartDate.AddMonths(this.PeriodRangeInMonths) < temp)
        this.StartDate = this.StartDate.AddMonths(this.PeriodRangeInMonths);
}
else this.StartDate = new DateTime(DateTime.Now.AddMonths(1).Year, DateTime.Now.AddMonths(1).Month, 1).AddMonths(0 - this.DateRangeInMonths);
this.EndDate = this.StartDate.AddMonths(this.DateRangeInMonths); 
```

我也愿意使用任何可能有帮助的 3rd 方 jquery 库，包括数学或日期函数等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:34:09.547

我想我已经把数学记下来了：http: [//jsfiddle.net/GNn7y/1/](http://jsfiddle.net/GNn7y/1/)

这是一个 javascript 解决方案，但这不应该太难适应另一种语言。

```
function getDateRange(refDate, monthRange, periodMonths, startMonth) {
    var datePeriodOffset = Math.floor((refDate.getMonth() - startMonth)/periodMonths);
    var endMonth = startMonth + datePeriodOffset*periodMonths - 1 + periodMonths;   
    var endDate = new Date(refDate.getFullYear(), endMonth+1, 0);  // the 0 sets it to the last day of the previous month (endMonth)
    var startDate = new Date(endDate.getFullYear(), endDate.getMonth() - monthRange + 1, 1);

    return {
        start : startDate,
        end : endDate
    };
} 
```

# javascript - 动态绑定jquery插件？

> ID：13482019
> 
> 赞同：0
> 
> 时间：2012-11-20T20:58:52.923
> 
> 标签：javascript, jquery, html, dom

在 jQuery 中，您可以通过绑定到父元素并像这样分配过滤器，将事件侦听器动态绑定到具有“subthing”类的所有未来 div 实例：

```
$(".thing").on("click", ".subthing", function(){ 
  console.log('subthing clicked');}
); 
```

如果我有一个我通常会绑定的 jquery 插件

```
$(".subthing").thingify(); 
```

是否有一种既定的方法确保 .subthing 的所有未来实例也将附加插件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:11:28.097

尝试：

```
document.body.addEventListener("DOMNodeInserted", function(event){
    var $elementJustAdded = $(event.target);
    if ($elementJustAdded.hasClass('subthing')) {
        $elementJustAdded.thingify();
    }
}, false); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:23:44.173

看看[livequery 插件](https://github.com/brandonaaron/livequery)

```
$(".subthing").livequery(function(){        
    $(this).thingify(); 
}); 
```

我认为这正是你所需要的。

# spring - 带有 Spring RequestMapping 路径参数的编码斜杠 (%2F) 提供 HTTP 400

> ID：13482020
> 
> 赞同：46
> 
> 时间：2012-11-20T20:58:56.043
> 
> 标签：spring, rest, glassfish, glassfish-3, spring-3

*这不是重复[引用的问题](https://stackoverflow.com/questions/3235219)，因为它是 Spring 特定的。谁添加了这个（事实发生后 3 年！）并没有费心阅读问题或评论线程来查看真正的答案是什么。接受的答案并不完全是答案，但答案的作者从未像我要求的那样回来编辑它。*

鉴于下面的 restful 方法，Spring 3.1 给出了 400 错误“客户端发送的请求在语法上不正确 ()”。当`token`参数包含 URL 编码的斜杠 (%2F) 时，例如“ [https://somewhere.com/ws/stuff/lookup/resourceId/287559/token/R4o6lI%2FbBx43/userName/jim](https://somewhere.com/ws/stuff/lookup/resourceId/287559/token/R4o6lI%2FbBx43/userName/jim) ” 没有 %2F 一切正常美好的。第 3 方已经在调用此服务（当然！）所以我无法更改他们发送的内容，至少在短期内是这样。关于如何在服务器端解决这个问题的任何想法？

这个问题在这里得到了很好的描述[https://jira.springsource.org/browse/SPR-8662](https://jira.springsource.org/browse/SPR-8662)虽然这个问题与我没有使用的 UriTemplate 有关，我可以说。

```
@RequestMapping("/ws/stuff/**")
@Controller
public class StuffController {
  @RequestMapping(value = "/ws/stuff/lookup/resourceId/{resourceId}/token/{token}/userName/{userName}", method = RequestMethod.GET)
   public @ResponseBody
   String provisionResource(@PathVariable("resourceId") String resourceId, @PathVariable("token") String token, @PathVariable("userName") String userName, ModelMap modelMap,
         HttpServletRequest request, HttpServletResponse response) {
      return handle(resourceId, userName, request, token, modelMap);
   }
} 
```

注意：这是在 Glassfish 3.1.2 上，起初是 Grizzly/Glassfish 不接受斜线，但是

`-Dcom.sun.grizzly.util.buf.UDecoder.ALLOW_ENCODED_SLASH=true`

解决了这个问题。

`asadmin set configs.config.server-config.network-config.protocols.protocol.http-listener-2.http.encoded-slash-enabled=true`

似乎没有帮助。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2016-06-02T20:03:20.803

对于spring-boot，以下是诀窍

```
@SpringBootApplication
public class Application extends WebMvcConfigurerAdapter {

    public static void main(String[] args) throws Exception {
        System.setProperty("org.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH", "true");
        SpringApplication.run(Application.class, args);
    }

    @Override
    public void configurePathMatch(PathMatchConfigurer configurer) {
        UrlPathHelper urlPathHelper = new UrlPathHelper();
        urlPathHelper.setUrlDecode(false);
        configurer.setUrlPathHelper(urlPathHelper);
    }

} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-21T07:33:38.187

这可能是您的答案：[urlencoded 正斜杠正在破坏 URL](https://stackoverflow.com/questions/3235219/urlencoded-forward-slash-is-breaking-url)

我建议不要将其放在路径中，而是将其移至请求参数。

**解决方法：**

您可以将 RequestMapping 更改为

```
@RequestMapping(value = "/ws/stuff/lookup/resourceId/**", method = RequestMethod.GET) 
```

然后从请求对象中手动解析路径变量。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2019-10-09T12:06:50.483

## Spring Boot 2+ / Spring（安全）5+ / Java 8+ 的 2019 年更新：

由于我对[iamiddy 答案的](https://stackoverflow.com/a/37601103/1326662)编辑被拒绝，我还想提供 Spring Boot 2 + 的完整解决方案作为单独的答案。

Spring5 `WebMvcConfigurerAdapter`/ Java8 已弃用，可以直接替换为 Interface`WebMvcConfigurer`结尾：

```
@SpringBootApplication
public class Application extends WebMvcConfigurer {

    public static void main(String[] args) throws Exception {
        System.setProperty("org.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH", "true");
        SpringApplication.run(Application.class, args);
    }

    @Override
    public void configurePathMatch(PathMatchConfigurer configurer) {
        UrlPathHelper urlPathHelper = new UrlPathHelper();
        urlPathHelper.setUrlDecode(false);
        configurer.setUrlPathHelper(urlPathHelper);
    }
} 
```

另外，您还需要配置 Spring`(Strict)HttpFirewall`以避免错误消息阻塞编码斜线`The request was rejected because the URL contained a potentially malicious String "%2F"`

```
@Bean
public HttpFirewall allowUrlEncodedSlashHttpFirewall() {
    StrictHttpFirewall firewall = new StrictHttpFirewall();
    firewall.setAllowUrlEncodedSlash(true);    
    return firewall;
} 
```

Spring Boot 将在可用时使用上述`HttpFirewall`Bean - 否则可能需要`WebSecurity`按照[此处](https://stackoverflow.com/a/48636757/1326662)所述进行配置：

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-11-20T11:07:17.130

这是 Spring 3.2.4 的修复（也应该适用于其他版本）。必须覆盖默认的 UrlPathHelper

```
 public class UrlPathHelperFixed extends UrlPathHelper {

        public UrlPathHelperFixed() {
            super.setUrlDecode(false);
        }

        @Override
        public void setUrlDecode(boolean urlDecode) {
            if (urlDecode) {
                throw new IllegalArgumentException("Handler [" + UrlPathHelperFixed.class.getName() + "] does not support URL decoding.");
            }
        }

        @Override
        public String getServletPath(HttpServletRequest request) {
            return getOriginatingServletPath(request);
        }

        @Override
        public String getOriginatingServletPath(HttpServletRequest request) {
            return request.getRequestURI().substring(request.getContextPath().length());
        }
    } 
```

并将其注入映射处理程序：

```
 <bean class="org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping">
        <property name="order" value="-1"></property>
        <property name="urlPathHelper">
            <bean class="com.yoochoose.frontend.spring.UrlPathHelperFixed"/>
        </property>
    </bean> 
```

经过一天的努力，它现在对我有用:-)

建议 Spring 团队使用[https://jira.springsource.org/browse/SPR-11101](https://jira.springsource.org/browse/SPR-11101)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-02-25T19:12:40.423

对于弹簧启动应用程序，这对我有用..

**版本 1** 添加

```
org.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH=true 
```

到您的*application.properties*文件

**版本 2** 像这样运行您的 Spring Boot 应用程序。

```
static void main(String[] args) {
    System.setProperty("org.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH", "true");
    SpringApplication.run this, args
} 
```

版本 3 或使用 -Dorg.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH=true 运行您的 java 应用程序

这个为我修复了 %2F 编码的斜杠路径变量。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-06-07T10:27:23.783

我找到了这个对我有用的解决方案；

```
System.setProperty("org.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH", "true"); 
```

就在 springApplication.run(args); 之前

并在 Application 类中添加以下代码

```
 @Override
    public void configurePathMatch(PathMatchConfigurer configurer) {
        UrlPathHelper urlPathHelper = new UrlPathHelper();
        urlPathHelper.setUrlDecode(false);
        configurer.setUrlPathHelper(urlPathHelper);
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-05-20T15:44:18.760

为了避免手动解析变量，我做了以下操作：

1.  在执行任何其他代码之前添加以下内容：

```
System.setProperty("org.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH", "true"); 
```

2.  **在控制器中，添加 2 个变量而**不是 1 个，例如：

```
 @RequestMapping(value = "/api/devices-by-name/device={deviceId}/restconf/data/ietf-interfaces:interfaces-state/interface={dpuIdPrefix}/{dpuIdSuffix}",
            method = RequestMethod.GET,
            produces = "application/json")
    public ResponseEntity<String> getInterfaceState(@PathVariable(value = "deviceId") String deviceId,
                                                    @PathVariable(value = "dpuIdPrefix") String dpuIdPrefix,
                                                    @PathVariable(value = "dpuIdSuffix") String dpuIdSuffix) {
        String dpuId = dpuIdPrefix + "/" + dpuIdSuffix; 
```

有了它，我可以检索以下内容：

```
curl -s -X GET http://localhost:9090/api/devices-by-name/device=ZNSDX16DPU03/restconf/data/ietf-interfaces:interfaces-state/interface=gfast%200%2F14 
```

如果斜杠是可选的，那么您可能需要配置两个不同的请求映射。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-04-10T19:57:59.040

我们刚刚在我的办公室遇到了这个问题，我们根据[Solubris 所说](https://stackoverflow.com/a/13488354/712849)的将它放在查询参数中的位置做了上面的建议。唯一的额外要求是数据也可以有一个“&”，这会弄乱查询参数。我们所要做的就是在将文本发送到 URL 之前对其进行编码，甚至“&”也被过滤掉了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-23T08:24:00.083

另一个答案是编码`"/"`两次，这将产生`"%252F"`.
在您映射的端点中，Spring 会将其解码回`"%2F"`. 您只需要使用以下内容再次对其进行解码：

`URLDecoder.decode(encoded_URL, "UTF-8");`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-07-22T08:31:25.723

以下解决了 BACK_SLASH 问题：

```
public static void main(String[] args) throws Exception {
  System.setProperty("org.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH", "true");
  SpringApplication.run(Application.class, args);
} 
```

但是，可以通过 application.yml 完成相同的功能。

```
org.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH: true 
```

此设置不起作用。我没有找到方法，并且仍在寻找它。

# javascript - jQuery美元符号未定义

> ID：13482022
> 
> 赞同：5
> 
> 时间：2012-11-20T20:59:07.600
> 
> 标签：javascript, jquery, google-visualization, yql

为了获取历史信息，我尝试使用以下代码。Chrome 调试器这么说`Uncaught ReferenceError: $ is not defined`。你能建议一个修复，我真的被卡住了。我只需要它在 Chrome 上工作，我正在利用 YQL 和 Yahoo API。

这是 jsFiddle [http://jsfiddle.net/pCK5q/1/](http://jsfiddle.net/pCK5q/1/)

```
<html>
  <head>      
    <script type='text/javascript' src='http://www.google.com/jsapi'></script>
    <script type='text/javascript'>
      google.load('visualization', '1', {'packages':['annotatedtimeline']});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = new google.visualization.DataTable();

        /* historical data code that breaks */
        var url = 'http://query.yahooapis.com/v1/public/yql';
        var startDate = '2012-01-01';
        var endDate = '2012-01-08';
        var jsonData = encodeURIComponent('select * from yahoo.finance.historicaldata where symbol in ("YHOO","AAPL","GOOG","MSFT") and startDate = "' + startDate + '" and endDate = "' + endDate + '"');
        $.getJSON(url, 'q=' + data + "&env=http%3A%2F%2Fdatatables.org%2Falltables.env&format=json", callback);

        data.addColumn('date', 'Date');
        data.addColumn('number', 'Sold Pencils');
        data.addColumn('string', 'title1');
        data.addColumn('string', 'text1');

        data.addColumn('number', 'Sold Pens');
        data.addColumn('string', 'title2');
        data.addColumn('string', 'text2');      // not on the fly

        data.addRows([
          [new Date(2008, 1 ,1), 30000, undefined, undefined, 40645, undefined, undefined],
          [new Date(2008, 1 ,2), 14045, undefined, undefined, 20374, undefined, undefined],
          [new Date(2008, 1 ,3), 55022, undefined, undefined, 50766, undefined, undefined],
          [new Date(2008, 1 ,4), 75284, undefined, undefined, 14334, 'Out of Stock','Ran out of stock on pens at 4pm'],
          [new Date(2008, 1 ,5), 41476, 'Bought Pens','Bought 200k pens', 66467, undefined, undefined],
          [new Date(2008, 1 ,6), 33322, undefined, undefined, 39463, undefined, undefined]
        ]);

        var chart = new google.visualization.AnnotatedTimeLine(document.getElementById('chart_div'));
        chart.draw(data, {displayAnnotations: true});
      }
    </script>
  </head>

  <body>
    // Note how you must specify the size of the container element explicitly!
    <div id='chart_div' style='width: 700px; height: 240px;'></div>

  </body> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T21:01:31.493

只需在脚本之前添加对 JQuery 源的引用：

```
<script src="http://code.jquery.com/jquery.min.js"></script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T21:02:52.373

添加这一行：

```
google.load("jquery", "1.7.1"); 
```

就在这个下面，你已经拥有了：

```
google.load('visualization', '1', {'packages':['annotatedtimeline']}); 
```

这将从您已经使用的 Google jsapi 加载 jQuery。这是关于您的代码的最佳解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T21:02:26.593

尝试添加一个 jQuery 引用：

```
<head>      
    <script type='text/javascript' src='http://code.jquery.com/jquery-1.8.3.min.js'></script>
    <script type='text/javascript' src='http://www.google.com/jsapi'></script>
    <script type='text/javascript'> 
```

或（但我认为这不起作用，因为您在加载函数中调用了 jQuery，因此第一种方法可能更好）

通过您正在使用的 JSAPI Google Loader 添加它：

```
<head>      
    <script type='text/javascript' src='http://www.google.com/jsapi'></script>
    <script type='text/javascript'>
        google.load('visualization', '1', {'packages':['annotatedtimeline']});
        google.load("jquery", "1.8.3"); // note, you can also load jQueryUI this way, 
```

// 另一方面，不确定谷歌支持多高的版本
请参阅[托管库](https://developers.google.com/speed/libraries/devguide)了解更多信息

# java - 在 InternalFrame 中打开另一个 InternalFrame 的 ActionListener

> ID：13482023
> 
> 赞同：2
> 
> 时间：2012-11-20T20:59:11.407
> 
> 标签：java, swing, jmenuitem

我目前正在编写一个带有 Swing 的桌面应用程序，其中包含`MainFrame`几个`InternalFrames`将运行的。我想`InternalFrames`为每个类编写单独的类，以避免拥有一个巨大的`MainFrame`类。

现在我的问题是我想将一个添加`ActionListener`到 a`MenuItem`中的 a`PopupMenu`中，`MenuInternalFrame`从而`InternalFrame`在`MainFrame`. 出现`MenuInternalFrame`，但是当我单击 MenuItem 时没有任何反应。当我将代码放在`ActionListener`InternalFrame 之外时出现。

问题一定出在`ActionListener`. `InternalFrame`这可能是我使用本地类和从`mouseClicked`-Method中访问的最终实例的解决方法吗？

以下是来自`MainFrame`-Constructor 的代码的相关部分：

```
class InternalFrames {
    TestInternalFrame test = new TestInternalFrame();
    JDesktopPane desktopPane = new JDesktopPane();
}

final InternalFrames internalFrames = new InternalFrames();

internalFrames.desktopPane.setBackground(Color.WHITE);

Menu menu = new Menu();
menu.getMntmTestMenuItem().addMouseListener( new MouseAdapter() {
    public void mouseClicked(MouseEvent e) {
        internalFrames.desktopPane.add(internalFrames.test);
        internalFrames.test.setVisible(true);
    }
});
internalFrames.desktopPane.add(menu);
menu.setVisible(true); 
```

任何想法可能是什么问题？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:06:07.847

不要`MouseAdapter`在 a上使用，而是`JMenuItem`使用`ActionListener`并添加它`JMenuItem#addActionListener(...)`：

```
Menu menu = new Menu();
menu.getMntmTestMenuItem().addActionListener(new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent ae) {
            internalFrames.desktopPane.add(internalFrames.test);
            internalFrames.test.setVisible(true);
    }
}); 
```

# mysql - 通过连接两个表创建的视图是否读取未查询/未使用的列？

> ID：13482024
> 
> 赞同：1
> 
> 时间：2012-11-20T20:59:16.913
> 
> 标签：mysql, sql

*关于这个过于简单的例子：*

在这个数据库方案中

```
+--------------+  +-------------------+
| MASTER_TABLE |  |    FILES_TABLE    |
+-----+--------+  +-----+------+------+
| nID | field  |  | nID | meta | BLOB |
+-----+--------+  +-----+------+------+
|  1  | ...    |  |  1  |  ... | ...  |
+-----+--------+  +-----+------+------+ 
```

如果我创建这样的视图：

```
CREATE VIEW myView AS
SELECT master.*, file.meta 
FROM master_table master
LEFT JOIN files_table file
USING (nid) 
```

**查询时是否会读取未使用的 BLOB 列`myView`？**（读作：查询视图会比只查询master_table慢得多）

我问这个是因为 BLOB 列将用于存储文件。我们首先将表一分为二的原因是为了加快 master_table 的查询速度。

* * *

## **免责声明：**

在设计数据结构**时，项目经理决定附加到数据的文件应该存储在数据库中**而不是文件系统中。

我很清楚关于将文件存储在数据库与文件系统中的大量激烈讨论，但正如我所说，**这不是我决定的，我也无权改变决定。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:00:40.687

不，只有构建视图的查询所需的选择中列出的字段是“已读”的。但是，任何连接都会影响选择时间，而不仅仅是单个表选择语句。

由于您没有在视图中使用 blob 字段，因此您不会受到此打击。

如果在表和表`nid`中都有索引，性能应该是相当不错的。`master``file`

如果您在表上有 (nid, meta) 的复合索引，则此视图的 JOIN 的最佳性能将是`file`。这假设元不是太大而不能成为复合索引的一部分。

# c++ - 当我关闭控制台时如何让 C++ 执行一个函数

> ID：13482027
> 
> 赞同：2
> 
> 时间：2012-11-20T20:59:20.610
> 
> 标签：c++, windows

当我手动关闭控制台时，我希望 C++ 程序执行一个函数。
我制作了一个 C++ 程序来测试密码，如果密码不正确，则让 Windows 注销。但是，如果我从“X”按钮关闭控制台，没有任何反应，如果控制台从“X”按钮关闭，我想让 Windows 也注销？
我尝试了 _onexit_t oe() 函数，但它对我没有帮助。
那么有一种方法可以做到这一点或隐藏包含“最小化”、“最大化”和“关闭”按钮的栏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:45:22.747

假设您的意思是普通的文本控制台窗口，您可以通过注册自己的事件处理程序`SetConsoleCtrlHandler`并观察事件`CTRL_C_EVENT`, `CTRL_BREAK_EVENT`, `CTRL_CLOSE_EVENT`, `CTRL_LOGOFF_EVENT`,`CTRL_SHUTDOWN_EVENT`等。

# c# - JavaScriptSerializer 无效的 JSON 原语

> ID：13482029
> 
> 赞同：3
> 
> 时间：2012-11-20T20:59:41.113
> 
> 标签：c#, json, javascriptserializer

当我在 C# 中使用 JavaScriptSerializer 时，我得到一个“无效的 JSON 原语”异常。我认为问题出在我的 json 输入字符串上，但我没有看到问题。

```
JavaScriptSerializer  new JavaScjs =riptSerializer();
js.Deserialize<Object>(json) 
```

"{\"new_name\":\"阿灵顿\",\"new_locationid\":\"089c6c6a-f520-e111-bdd3-00505695001f\"},{\"new_name\":\"亚特兰大\",\" new_locationid\":\"0a9c6c6a-f520-e111-bdd3-00505695001f\"},{\"new_name\":\"Baltimore\",\"new_locationid\":\"0c9c6c6a-f520-e111-bdd3-00505695001f\ “}”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-12T13:44:37.390

GoBeavs：

我在这里验证了你的 json：http: [//jsonlint.com/](http://jsonlint.com/)

您的 json 文本是错误的：当您有一个 json 数组时，您必须用括号 ([]) 将其括起来。它必须看起来像这样：

```
"[{\"new_name\":\"Arlington\",\"new_locationid\":\"089c6c6a-f520-e111-bdd3-00505695001f\"},{\"new_name\":\"Atlanta\",\"new_locationid\":\"0a9c6c6a-f520-e111-bdd3-00505695001f\"},{\"new_name\":\"Baltimore\",\"new_locationid\":\"0c9c6c6a-f520-e111-bdd3-00505695001f\"}]" 
```

# jquery - 使用 jquery 专注于特定的 div

> ID：13482035
> 
> 赞同：1
> 
> 时间：2012-11-20T21:00:04.913
> 
> 标签：jquery

html代码是这样的：

```
<div id="div1" class="all"> </div>
<div id="div2" class="all"> </div>
<div id="div3" class="all"> </div>
<div id="div4" class="all"> </div>
<div id="div5" class="all"> </div>
<div id="div6" class="all"> </div>
<div id="div7" class="all"> </div> 
```

我在 jquery 中隐藏和显示 div，如下所示：

```
$(function () {

                 $('#div1').click(function () {

                     $('#div1').hide();    
                         $('#div2').show();  
                 });

                 $('#div2').click(function () {
                     $('#div2').hide();
                       $('#div1').show();
                });
    }); 
```

在 div1.show() 的第二部分；我喜欢将浏览器滚动到 div1。由于该页面的人口非常多，因此在单击之前转到原始 div 会很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:02:16.080

您需要滚动到 div - 您可以使用 animate 来执行此操作。

[这里](https://stackoverflow.com/questions/8082364/scroll-to-div-jquery-specific-position)有一个很好的例子

最好使用@sdespont 推荐的[插件。](http://demos.flesler.com/jquery/scrollTo/)它可以针对一个 DOM 元素（请参阅该页面上的第一个示例），您可以将 div 存储在变量中，然后在需要时转到该 DOM 元素。

**所以，伪代码示例 - 这还没有经过测试，它只是一个关于它如何工作的想法**：

```
 var clickedDiv; 
  $("#div1").click(function(){
     clickedDiv = $(this);
     $("#div2").scrollTo();
   });

  $("#div2").click(function(){
     $("#divHome").scrollTo({onAfter:function(){
        if (clickedDiv != null){
            $(clickedDiv).scrollTo()
         }
    }});    
 }); 
```

# wcf - 在 SubmitChanges 后 RIA 服务丢失列表条目的 DomainContext

> ID：13482039
> 
> 赞同：0
> 
> 时间：2012-11-20T21:00:11.963
> 
> 标签：wcf, silverlight, ria

我正在调用 SubmitChanges 来向我的 RIA 实体之一提交更改。该实体有一个属性，该属性具有一个 ObservableCollection 的 Items 属性。

我所做的唯一更改是在此列表中添加了一个条目。

当我在调用提交更改之前检查计数属性时，它是正确的计数。比方说 6。调用 SubmitChanges 后，客户端的计数为 1。并且列表仅包含新添加的项目，而不包含以前存在的项目。

在服务器上，操作表明所有 6 个项目都在那里，我使用 Fiddler 验证所有 6 个项目都返回给我的客户端。

但是，在应用程序中运行的下一行代码中，此列表的计数为 1（或新添加的项目数）。

我已经验证所有项目都正确存在，并且当我创建一个新的 DomainContext 并重新加载数据时，列表中的所有项目都在那里，即使是我添加的那些。

关于什么可能导致这种行为的任何想法？这些物品正在某处丢失。

这是有问题的对象以及正在丢失其条目的 ObservableCollection。

```
[DataContract(Name = "CT", Namespace = "http://domain/properties")]
public class ChoicePropertyType : PropertyType
{
    [DataMember(Name = "C")]
    public bool IsCustomValueAllowed { get; set; }

    [DataMember(Name = "A")]
    public bool AllowMultiple { get; set; }        

    private ObservableCollection<ValidValue> _defaultValues;

          [Association("DefaultValues", "Id", "ParentId")]
    [Include]
    [Composition]
    [DataMember(Name = "D")]
    public ObservableCollection<ValidValue> DefaultValues
    {
        get
        {
            if (_defaultValues == null)
                _defaultValues = new ObservableCollection<ValidValue>();
            return _defaultValues;
        }
    }

}

[KnownType(typeof(ChoicePropertyType))]
[KnownType(typeof(DatePropertyType))]
[KnownType(typeof(NumberPropertyType))]
[KnownType(typeof(TextPropertyType))]
[KnownType(typeof(UserPropertyType))]
[DataContract(Name = "PT", Namespace = "http://domain/properties")]
public class PropertyType
{
    [Key]
    [DataMember(Name = "I")]
    public string Id { get; set; }

    [DataMember(Name = "P")]
    public int? ParentId { get; set; }

    [DataMember(Name = "R")]
    public bool IsRequired { get; set; }

    [DataMember(Name = "H")]
    public bool HasDefaultValue { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:08:23.117

我认为 RIA 实体的元数据需要有一个 [Include] 属性来装饰列表属性。此外，如果该列表表示其他实体，它实际上应该是一个 EntityCollection。

包含的一个问题是，每当您查询 Ria 实体时，列表中的相关项目（全部）也将被返回。但是，如果不使用 Include，则需要首先通过单独的 Load 调用在域上下文中加载这些相关项。

这意味着您需要执行一个查询，该查询将在域上下文中加载列表中的所有相关项目，然后您的 ria 实体将与列表中的项目具有适当的关系。

此外，将一个项目添加到 ria 实体的列表中并不是真正的正确方法。首先，如果 ria 实体不存在，则将其添加到上下文中。然后您将相关实体添加到上下文中。最后，您将通过相关实体的 ria 实体链接将两者联系在一起并保存更改。

例子：

将 ria 实体添加或检索到域上下文。创建相关实体related entity.ria实体引用链接=ria实体；将相关实体添加到上下文中。保存更改。

# python - 我的 Python 函数解码错误

> ID：13482041
> 
> 赞同：1
> 
> 时间：2012-11-20T21:00:21.940
> 
> 标签：python, unicode

我正在使用 Robot 框架来自动化一些与 HTTP POST 相关的测试。我编写了一个自定义 Python 库，该库具有执行 HTTP POST 的功能。它看起来像这样：

```
# This function will do a http post and return the json response
def Http_Post_using_python(json_dict,url):
    post_data = json_dict.encode('utf-8')
    headers = {}
    headers['Content-Type'] = 'application/json'
    h = httplib2.Http()
    resp, content = h.request(url,'POST',post_data,headers)
    return resp, content 
```

只要我不使用任何 Unicode 字符，它就可以正常工作。当我在`json_dict`变量中有 Unicode 字符（例如，메시지）时，它会失败并出现以下错误：

> UnicodeDecodeError：“ascii”编解码器无法解码位置 164 中的字节 0xeb：序数不在范围内（128）

我在 Windows 7 上运行 Python 2.7.3。我看到了几个相关的问题，但我无法解决问题。我是 Python 和编程的新手，因此不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:04:26.300

您收到此错误是因为`json_dict`is a `str`，而不是`unicode`. 在不了解有关应用程序的任何其他信息的情况下，一个简单的解决方案是：

```
if isinstance(json_dict, unicode):
    json_dict = json_dict.encode("utf-8")
post_data = json_dict 
```

但是，如果您`json.dumps(…)`用于创建`json_dict`，那么您不需要对其进行编码 - 这将由`json.dumps(…)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:04:42.203

使用[`requests`](http://docs.python-requests.org/en/latest/)：

```
requests.post(url, data=data, headers=headers) 
```

它将为您处理编码。

* * *

由于 Python 2 的自动编码/解码，您会遇到错误，这基本上是一个错误，并在 Python 3 中得到了修复。简而言之，Python 2 的`str`对象实际上是“字节”，处理字符串数据的正确方法是在`unicode`目的。由于`unicode`s 是后来引入的，所以当你混淆它们时，Python 2 会自动尝试在它们和字符串之间进行转换。为此，它需要知道编码；由于您没有指定一个，它默认为`ascii`没有所需的字符。

为什么 Python 会自动尝试为您解码？因为你在调用`.encode()`一个`str`对象。它已经编码，因此 Python 首先尝试为您解码，并猜测`ascii`编码。

* * *

您应该阅读[每个软件开发人员绝对、肯定必须了解 Unicode 和字符集的绝对最低要求（没有借口！）](http://www.joelonsoftware.com/articles/Unicode.html)。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-11-20T21:07:16.173

尝试这个：

```
#coding=utf-8
test = "메시지" 
test.decode('utf8') 
```

在这一行中，`#coding=utf-8`我只是将文件编码设置为 UTF-8（以便能够编写“메시지”）。

您需要将字符串解码为 utf-8。[解码方法文档](http://docs.python.org/2/library/stdtypes.html#str.decode)

# jquery - 使用 Jquery 在下拉列表行中返回不同的值

> ID：13482043
> 
> 赞同：0
> 
> 时间：2012-11-20T21:00:24.877
> 
> 标签：jquery, html

我有一排带有与之关联的下拉菜单的复选框。如何为选中的复选框返回相应下拉列表中的值？

[http://jsfiddle.net/Gqzhq/21/](http://jsfiddle.net/Gqzhq/21/)

```
$('input[name=options]').live('click', function() {

    if($(this).hasClass('checked'))
    {
    $(this).removeClass('checked');

    }else{
    $(this).addClass('checked');

    }

    }); 
```

* * *

HTML

```
<table id="test" summary="test">
<th>A</th> <th>B</th><th>C</th>

<tr>
<td><input type="checkbox" name="options" id="1" value="500">
      <select class="my_select">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option></td>
    <td><input type="checkbox" name="options" id="2" value="500">
    <select class="my_select">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option></td>

    <td><input type="checkbox" name="options" id="3" value="500">
    <select class="my_select">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option></td>

    </tr>

    </table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:12:00.263

您可以使用目标选择`siblings()`或转到父级`TD`并使用`find()`. 也`live()`已弃用，请`on()`改用。

如果你使用`toggleClass()`你可以删除你的`if($(this).hasClass('checked'))`

```
$(document).on('click', 'input[name=options]', function() {){
    /* "this" within the handler refers to current input*/

   var selectVal= $(this).siblings('select').val();
             /* OR */
   var selectVal= $(this).parent().find('select').val();

   /* second argument determines  whether to add or remove*/ 
   $(this).toggleClass('checked', this.checked);

}); 
```

API 参考：

[http://api.jquery.com/siblings/](http://api.jquery.com/siblings/)

[http://api.jquery.com/toggleClass/](http://api.jquery.com/toggleClass/)

[http://api.jquery.com/on/](http://api.jquery.com/on/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:26:55.183

```
$('input[type=checkbox]').click(function() {
    if($(this).attr('checked')) 
        alert(
                'value of combo ' + 
                 $(this).attr('id') + ' is ' + 
                 $(this).next('.my_select').val()
             );
}); 
```

我改变了你的例子[http://jsfiddle.net/Gqzhq/27/](http://jsfiddle.net/Gqzhq/27/)

# wordpress - WordPress 在主题之间共享菜单？

> ID：13482049
> 
> 赞同：1
> 
> 时间：2012-11-20T21:00:45.063
> 
> 标签：wordpress, wordpress-theming

我正在创建一个基本的 wordpress 主题，作为我所有网站的起点。

在我的基本主题中，我有几个用于 heaer 和 footer 的自定义菜单。

**我如何以我所有其他主题（使用相同的基础）将继承它们的方式声明这些菜单？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:06:54.290

使用子主题。[http://codex.wordpress.org/Child_Themes](http://codex.wordpress.org/Child_Themes) 您的 header.php 和其他常用模板部分将保留在父主题中，其他文件（如 page.php、single.php 等）将在子主题中被覆盖主题。

# iis - 使用 WebMatrix 2 一次运行多个站点而无需多次打开它

> ID：13482054
> 
> 赞同：2
> 
> 时间：2012-11-20T21:00:55.670
> 
> 标签：iis, web, webmatrix, iis-express

自从我开始使用 WebMatrix 以来，我已经开发了我组织的许多 Web 界面、Intranet 站点。我现在有多达四个，几乎五个站点同时运行以供用户连接，我担心打开整个 WebMatrix 应用程序的那么多实例可能会导致服务器资源的浪费。

我一直在 Internet 上搜索有关如何使用 WebMatrix 运行多个站点的参考。我并没有完全空手而归，但是，我也没有找到我喜欢的解决方案（尽管消息来源表明这是完全可能的）。

即使我确实知道如何使用 WebMatrix 一次运行多个站点（只需打开 WebMatrix 的另一个实例），我的第一个问题是：这不是需要更多资源（对于使用 iis-express 的服务器）吗？通过命令行打开这些站点而不是简单地打开几个 WebMatrix 实例是否有益？

最后一个问题：我在这里找到了这篇文章......：

[http://forums.asp.net/t/1677533.aspx/1](http://forums.asp.net/t/1677533.aspx/1)

...Mike Brind 建议这可以通过使用命令行浏览到正确的 iis-express 目录（对我来说：C:\Program Files (x86)\IIS Express）并使用以下命令来完成：

```
iisexpress /site:EmptySite1 
```

其中 EmptySite1 是要运行的站点的名称。

尝试此操作时出现此错误：

```
Command Line switches must be preceded by a '-' or '/'... 
```

有什么线索可以从命令行一次运行多个站点，或者我什至需要吗？（抱歉，我绝不是命令行专家，我相信你现在可以告诉我）我正在运行 Windows Server 2008 R2，如果这很重要的话。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:46:56.493

由于您运行的是完整的 Windows Server 2008，因此请安装常规 IIS。它可以同时运行多个网站，而无需任何特殊的命令行。由于它作为服务运行，如果重新启动服务器，IIS 将自动重新启动。缺点是 IIS 的配置比 IIS express 稍微复杂一些。

# haskell - Haskell 创建一个具有特定增量的列表

> ID：13482057
> 
> 赞同：2
> 
> 时间：2012-11-20T21:01:08.223
> 
> 标签：haskell

在数学语言中，您可以按如下方式创建向量：

```
x = seq(0, 2*pi, length.out = 100) 
```

这输出：

```
[1] 0.00000000 0.06346652 0.12693304 0.19039955 0.25386607 0.31733259 0.38079911
  [8] 0.44426563 0.50773215 0.57119866 0.63466518 0.69813170 0.76159822 0.82506474
 [15] 0.88853126 0.95199777 1.01546429 1.07893081 1.14239733 1.20586385 1.26933037
 [22] 1.33279688 1.39626340 1.45972992 1.52319644 1.58666296 1.65012947 1.71359599
 [29] 1.77706251 1.84052903 1.90399555 1.96746207 2.03092858 2.09439510 2.15786162
 [36] 2.22132814 2.28479466 2.34826118 2.41172769 2.47519421 2.53866073 2.60212725
 [43] 2.66559377 2.72906028 2.79252680 2.85599332 2.91945984 2.98292636 3.04639288
 [50] 3.10985939 3.17332591 3.23679243 3.30025895 3.36372547 3.42719199 3.49065850
 [57] 3.55412502 3.61759154 3.68105806 3.74452458 3.80799110 3.87145761 3.93492413
 [64] 3.99839065 4.06185717 4.12532369 4.18879020 4.25225672 4.31572324 4.37918976
 [71] 4.44265628 4.50612280 4.56958931 4.63305583 4.69652235 4.75998887 4.82345539
 [78] 4.88692191 4.95038842 5.01385494 5.07732146 5.14078798 5.20425450 5.26772102
 [85] 5.33118753 5.39465405 5.45812057 5.52158709 5.58505361 5.64852012 5.71198664
 [92] 5.77545316 5.83891968 5.90238620 5.96585272 6.02931923 6.09278575 6.15625227
 [99] 6.21971879 6.28318531 
```

如何在 Haskell 中实现这一点？

我尝试创建一个 lambda 函数并将其与 map 一起使用，但我无法获得相同的输出。

谢谢

```
let myPi = (\x -> 2*pi)
map myPi [1..10] 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-20T21:03:31.507

好吧，你可以做

```
[0, 2*pi/100 .. 2*pi] 
```

请注意，这在性能和浮点舍入方面都不理想（因为它转换为`enumFromThenTo`），Daniel Fischer 的版本更好（它转换为`enumFromTo`）。仔细想想，GHC 可能会将两者编译成几乎同样快的代码，但我不确定。如果它*真的*对性能至关重要，最好不要使用列表，而是使用`Data.Vector`.

* * *

正如 Jakub Hampl 所说，Haskell 可以处理*无限*列表。这对你来说可能没有多大用处，但它带来了有趣的可能性——例如，你可能不确定你真正需要哪种分辨率。您可以让您的列表以非常低的分辨率开始，然后折回并以更高的分辨率重新开始。实现此目的的一种简单方法：

```
import Data.Fixed

multiResS₁ = [ log x `mod'` 2*pi | x<-[1 .. ] ] 
```

使用它来绘制正弦函数看起来像这样

> Prelude Data.Fixed Graphics.Rendering.Chart.Simple> 让 domainS₁ = 取 200 multiResS₁<br> Prelude Data.Fixed Graphics.Rendering.Chart.Simple> plotPNG "multiresS1.png" domainS₁ sin

![在此处输入图像描述](../Images/a21fbf3410d6a3516e81b9606581fc8a.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-20T21:04:01.067

最简单的是列表理解，

```
[(2*pi)*k/99 | k <- [0 .. 99]] 
```

（乘以`k/99`减轻浮点舍入，所以最后一个值正好是`2*pi`。）

# android - Dissable_keyGuard 标志不起作用

> ID：13482058
> 
> 赞同：0
> 
> 时间：2012-11-20T21:01:18.857
> 
> 标签：android, locking, screen-lock

我正在尝试禁用屏幕锁定。我希望屏幕在超时后关闭，但在触摸时再次使用我的应用程序。

由于不推荐使用 keywardlock，我在 onCreate() 中尝试了以下操作：

```
 final Window win = getWindow();
    win.setFlags(WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED,
            WindowManager.LayoutParams.FLAG_DISMISS_KEYGUARD); 
```

以防万一，我在清单中添加了以下内容（需要这样做吗？？）：

```
<uses-permission android:name="android.permission.DISABLE_KEYGUARD" />
<uses-permission android:name="android.permission.FLAG_SHOW_WHEN_LOCKED" /> 
```

不过，在我通常的超时之后，屏幕被锁定了......

我究竟做错了什么？？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:00:41.260

[SetFlags](http://developer.android.com/reference/android/view/Window.html#setFlags%28int,%20int%29)采用标志和掩码，您没有以这种方式使用它。最简单的方法是使用辅助方法[addFlags](http://developer.android.com/reference/android/view/Window.html#addFlags%28int%29)我正在使用以下代码。

```
 Window window = getWindow();
  window.addFlags(WindowManager.LayoutParams.FLAG_DISMISS_KEYGUARD);
  window.addFlags(WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED); 
```

# git - 将 Gitlab 与 ReviewBoard 集成 - 文件 Blob 与提交 SHA1

> ID：13482061
> 
> 赞同：9
> 
> 时间：2012-11-20T21:01:34.773
> 
> 标签：git, gitlab, review-board

我正在尝试将我们公司一直在使用的 Gitlab 服务器与新的 ReviewBoard 服务器集成。从我读到的关于 ReviewBoard 设置的所有内容中，如果存储库具有 Web 前端，则集成类似 git 的存储库的最直接方法是使用“原始文件 URL 掩码”字段。

幸运的是，Gitlab 似乎支持这样的前端，甚至有一个有据可查的公共 API：https:///api/v2/projects//repository/commits//blob?private_token=&filepath=

在 ReviewBoard 的存储库设置中，可以指定一个自定义 URL，该 URL 可用于从 git 服务器检索单个文件。此 URL 有两个占位符：

*   {filename} - 文件路径
*   {revision} - 文件 blob 的 sha1

不幸的是，我了解到 Gitlab 的 API 需要提交的 SHA1，而不是单个文件的 SHA1，据我所知，ReviewBoard 只发送单个文件的 SHA1，而不是提交的 SHA1

1.  有没有人成功地将 Gitlab 与 ReviewBoard 集成？如果是这样，我很想听听
2.  是否有人知道 Gitlab 支持的另一个可能未记录的 API 调用，它允许我们根据文件 blob 的 SHA1 检索文件？
3.  是否有人知道 ReviewBoard 中的设置以强制它传递提交的 SHA1 而不是文件 blob？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-01-27T12:20:34.847

Reviewboard 1.7.21 包括对 GitLab 的支持[http://www.reviewboard.org/news/2014/01/14/review-board-1-7-21-released/](http://www.reviewboard.org/news/2014/01/14/review-board-1-7-21-released/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T15:23:19.560

我开始在[评论委员会谷歌小组](https://groups.google.com/forum/?fromgroups=#!topic/reviewboard/r_XGPmCCKJk)上讨论这个问题。看来，能够通过自己的 SHA1 检索文件是许多 Git Web 前端之前缺少的东西，但现在正在添加。不幸的是，Gitlab 在这个功能上落后了，所以他们根本没有它（还?) 但其他人这样做。

我们找到的解决方案是在同一台主机上安装[Gitweb和 Gitlab。](http://sourceforge.net/apps/trac/sourceforge/wiki/GitWeb%20repository%20browser)然后我们简单地指出审查委员会使用 Gitweb API，而我们的开发人员继续使用 Gitlab。

需要注意的一件重要事情。Review Board 文档（至少对于 1.6 版）在 gitweb 的示例原始文件 URL 掩码值中有错字。这是正确的 URL 格式：

```
http://servername/?p=relative path to git repo;a=blob_plain;f=<filename>;h=<revision> 
```

在他们的文档中，最后一个参数的名称是*hb*但它应该是*h*

# class - CakePHP - 在当前模型中使用不同的模型

> ID：13482068
> 
> 赞同：0
> 
> 时间：2012-11-20T21:02:06.293
> 
> 标签：class, cakephp, model

我在 CakePHP 的模型中创建了一个自定义验证函数。在阅读了类似的问题后，我了解到我可以`ClassRegistry::init('Model');`用来在我当前的模型中加载一个外国模型。但它并没有更多地说明语法以及之后如何实际使用它。这是我尝试过的，但是当我尝试打印数组以查看它是否包含正确的东西时，什么都没有“发生”。基本上我想提取用户数据以在我的验证中使用它。

```
class Booking extends AppModel {

    public $name = 'Booking';

    public $validate = array(
        'start_time' => array(
            'noOptionViolation' => array(
                'rule' => 'noOptionViolation',
                'allowEmpty' => false
            )
        ),
    );  

    public function noOptionViolation ($start_time) {

        $this->User = ClassRegistry::init('User');
        $allUsers = $this->User->find('all');
        print_r($allUsers);

    } 
```

这是正确的语法吗？我可以像在控制器中一样使用 $this->User 的所有方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:42:43.857

您可以按照这篇文章的详细说明使用导入： [https ://stackoverflow.com/a/13140816/1081396](https://stackoverflow.com/a/13140816/1081396)

```
App::import('Model', 'SystemSettings.SystemSetting');
$settings = new SystemSetting();
$mySettings = $settings->getSettings(); 
```

在您的示例中，它将类似于：

```
App::import('Model', 'Users.User');
$user = new User();
$allUsers = $user->find('all');
print_r($allUsers); 
```

您最好在模型开始时使用*导入*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T12:24:46.030

您也可以使用它来加载模型

```
$this->loadModel('User'); 
```

并通过以下方式访问所有功能

```
$this->User 
```

# powershell - 将自定义对象数组传递给函数

> ID：13482069
> 
> 赞同：0
> 
> 时间：2012-11-20T21:02:09.490
> 
> 标签：powershell, psobject

我正在尝试将一组自定义对象传递给函数以进一步处理这些对象。

这是我创建自定义对象数组的函数：

```
Function GetNetworkAdapterList
{
    # Get a list of available Adapters
    $hnet = New-Object -ComObject HNetCfg.HNetShare
    $netAdapters = @()
    foreach ($i in $hnet.EnumEveryConnection)
    {   
        $netconprop = $hnet.NetConnectionProps($i)
        $inetconf = $hnet.INetSharingConfigurationForINetConnection($i)

        $netAdapters += New-Object PsObject -Property @{
                Index = $index
                Guid = $netconprop.Guid
                Name = $netconprop.Name
                DeviceName = $netconprop.DeviceName
                Status = $netconprop.Status
                MediaType = $netconprop.MediaType
                Characteristics = $netconprop.Characteristics
                SharingEnabled = $inetconf.SharingEnabled
                SharingConnectionType = $inetconf.SharingConnectionType
                InternetFirewallEnabled = $inetconf.InternetFirewallEnabled
                SharingConfigurationObject = $inetconf
                }
        $index++
    }   
    return $netAdapters
} 
```

然后在我的主代码中，我像这样调用上面的函数：

```
$netAdapterList = GetNetworkAdapterList 
```

$netAdapterList 返回预期的数据，我可以执行以下操作：

```
$netAdapterList | fl Name, DeviceName, Guid, SharingEnabled 
```

到现在为止还挺好。

现在我想调用一个传入 $netAdapterList 的函数

我创建了一个像这样的虚拟函数：

```
Function ShowAdapters($netAdapterListParam)
{
   $netAdapterListParam | fl Name, DeviceName, Guid, SharingEnabled
} 
```

当我这样调用它时：

```
ShowAdapters $netAdapterList 
```

什么都没有打印出来。

我尝试更改函数的签名，但仍然没有运气：

```
Function ShowAdapters([Object[]]$netAdapterListParam)

Function ShowAdapters([Object]$netAdapterListParam)

Function ShowAdapters([PSObject[]]$netAdapterListParam)    

Function ShowAdapters([array]$netAdapterListParam) 
```

**有人知道我在做什么错吗？如何访问函数内的自定义对象？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:56:17.597

感谢您的回复@Christian。尝试了您的步骤，将点点滴滴的内容复制到外壳中，它确实有效。但是，如果我运行完整的 .ps1 脚本，则不会打印出任何内容。

我已经在 Powershell IDE 中运行脚本，在 ShowAdapters 函数内设置断点，并且`$netAdapterListParam`确实具有我要传入的预期自定义对象数组，因此我已将问题缩小到 FL 命令行开关中。

由于某种原因`$netAdapterList | fl Name, DeviceName, Guid, SharingEnabled`对我不起作用，所以我最终改用以下内容：

```
$formatted = $netAdapterListParam | fl Name, DeviceName, Guid, SharingEnabled | Out-String
Write-Host $formatted 
```

这样就成功了，4 个属性被打印在屏幕上。

得到教训：

1) Win7 内置的 Powershell IDE 可以成为调试脚本的非常有用的工具 2) 格式化自定义对象时，Format-List 可能很古怪，因此需要 Out-String。

# ios - 从 UIAlertView 选项 xcode 设置背景

> ID：13482072
> 
> 赞同：-2
> 
> 时间：2012-11-20T21:02:15.447
> 
> 标签：ios

我试图用 4 个 ImageViews 和 4 个 UIButtons 做一个应用程序。当按下其中一个 UIButtons 时，应显示 UIAlertView 并带有 3 个选项。一个名为“图片”的应该打开照片库，以便用户可以更改 ImageView 图片。我为此编写了一个代码，但它不会工作。有人对如何使它工作有任何建议吗？提前致谢！

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
NSString *title = [alertView buttonTitleAtIndex:buttonIndex];
NSString *buttonOne = changeButtonOne;  //the UIButtons
NSString *buttonTwo = changeButtonTwo;
NSString *buttonThree = changeButtonThree;
NSString *buttonFour = changeButtonFour;

if([buttonOne isEqualToString:@"buttonOne"])
{
      if([title isEqualToString:@"Done"])
    {
        NSLog(@"You pressed done");
    }
      else if([title isEqualToString:@"Phone number"])
    {
        NSLog(@"You pressed Phone number");
    }
      else if([title isEqualToString:@"Picture"])
    {
        imagePickerController = [[UIImagePickerController alloc]init];   //I think its this part which are wrong
        [imagePickerController setDelegate:self];
        [imagePickerController setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];
        [self presentViewController:imagePickerController animated:YES completion:nil];
    }
}
else if([buttonTwo isEqualToString:@"buttonTwo"])
{
    if([title isEqualToString:@"Done"])
    {
        NSLog(@"Yoy pressed done");
    }
    else if([title isEqualToString:@"Phone number"])
    {
        NSLog(@"You pressed Phone number");
    }
    else if([title isEqualToString:@"Picture"])
    {
        imagePickerController2 = [[UIImagePickerController alloc]init];  //I think its the part thats wrong.
        [imagePickerController2 setDelegate:self];
        [imagePickerController2 setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];
        [self presentViewController:imagePickerController2 animated:YES completion:nil];
    }

}
else if([buttonThree isEqualToString:@"buttonThree"])
    {
        if([title isEqualToString:@"Done"])
        {
            NSLog(@"You pressed done");
        }
        else if([title isEqualToString:@"Phone number"])
        {
            NSLog(@"You pressed Phone number");
        }
        else if([title isEqualToString:@"Picture"])
        {
            imagePickerController3 = [[UIImagePickerController alloc]init];   //i think this is the wrong part
            [imagePickerController3 setDelegate:self];
            [imagePickerController3 setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];
            [self presentViewController:imagePickerController3 animated:YES completion:nil];
        }
    }

    else if([buttonFour isEqualToString:@"buttonFour"])
    {
        if([title isEqualToString:@"Done"])
        {
            NSLog(@"You pressed done");
        }
        else if([title isEqualToString:@"Phone number"])
        {
            NSLog(@"You pressed Phone number");
        }
        else if([title isEqualToString:@"Picture"])
        {
            imagePickerController4 = [[UIImagePickerController alloc]init];    //this is probably the wrong part
            [imagePickerController4 setDelegate:self];
            [imagePickerController4 setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];
            [self presentViewController:imagePickerController4 animated:YES completion:nil];
        }
    }

}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:26:55.837

您应该使用`tag`UIAlertView 的属性来区分警报和`buttonIndex`（不是按钮标题）以了解按下了哪个按钮。所以不要在警报视图委托方法中使用 isEqualToString 。您希望它适用于不同的语言。

在按钮操作中，在显示警报之前：

```
alertView.tag = 1; // 1 = button1, 2 = button2 etc. 
```

警报视图委托：

```
-(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if (alertView.tag == 1) { //button1
        if (buttonIndex == alertView.cancelButtonIndex) {
            // handle cancel button
        }        
        if (buttonIndex == alertView.firstOtherButtonIndex) {
            // handle action 1
        }
        if (buttonIndex == alertView.firstOtherButtonIndex+1) {
            // handle action 2
        }
    }
    if (alertView.tag == 2) { //button2
        if (buttonIndex == alertView.cancelButtonIndex) {
            // handle cancel button
        }        
        if (buttonIndex == alertView.firstOtherButtonIndex) {
            // handle action 3
        }
        if (buttonIndex == alertView.firstOtherButtonIndex+1) {
            // handle action 4
        }
    }
} 
```

# javascript - 为什么 275481/69/100089 将解析最大日期“new Date()”？

> ID：13482074
> 
> 赞同：5
> 
> 时间：2012-11-20T21:02:22.697
> 
> 标签：javascript

> **可能重复：**
> [JavaScript 的 Date 对象是否容易受到 Y2038 问题的影响？](https://stackoverflow.com/questions/1608108/is-javascripts-date-object-susceptible-to-the-y2038-problem)

因此，在遇到jquery.validate 的日期验证器[的问题后，我正在测试 JavaScript 的新 Data() 解析器的上限。](https://stackoverflow.com/questions/13462687/javascript-equivalent-to-nets-datetime-parse)

奇怪的是，这有效：

```
var d = new Date("275481/69/100089")
// d = Date {Fri Sep 12 275760 00:00:00 GMT-0400 (Eastern Daylight Time)} 
```

但是，所有这些都失败了：

```
var d = new Date("275481/69/100090")
var d = new Date("275481/70/100089")
var d = new Date("275482/69/100089") 
```

我刚刚发现世界末日的日期了吗？

# radscheduler - 如何在 RadScheduleView 中启用或禁用 ContextMenu

> ID：13482081
> 
> 赞同：3
> 
> 时间：2012-11-20T21:02:45.220
> 
> 标签：radscheduler, radmenu

我的页面上显示了一个 RadSchedule 日历对象。我为 RadSchedule 定义了一个带有 RadMenuItem 的 RadContextMenu。我想根据用户右键单击的约会类型启用或禁用此上下文菜单项。

目前，上下文菜单始终显示。

如何启用或禁用 RadMenuItem？

# c - 在C中随机化链表

> ID：13482082
> 
> 赞同：1
> 
> 时间：2012-11-20T21:02:50.557
> 
> 标签：c, random, linked-list

假设我在 C 程序的内存中有一个保留空间，用于包含 1000 个项目的链表。每个项目只包含列表中下一个项目的引用（最后一个指向第一个）。但是现在它们都设置为空，它只是保留空间。

接下来我有一个`rand()`函数，它给了我一个从 1 到 1000 的随机数。我的问题是，有没有简单的方法可以通过以下方式使用这个函数随机化这个列表：当我从第一个元素开始时，我将遍历整个列表，即列表中不会有比整个列表小的圆圈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:13:25.543

根据您的描述，您有一个由 1000 个节点组成的数组，全部归零。为了论证起见，该数组被命名为`node_array`，链接字段被称为`next`。您还有一个名为的指针`head`，它可以指向其中一个节点。

您可以分配一个包含 1000 个整数的数组：

```
enum { NUM_ITEMS = 1000 };
int mapper[NUM_ITEMS]; 
```

您可以初始化列表，以便每个数字出现一次：

```
for (int i = 0; i < NUM_ITEMS; i++)
    mapper[i] = i; 
```

您可以随机播放列表。（我真的应该检查 Knuth（计算机编程艺术）或 Bentley（编程珍珠或更多编程珍珠），但我认为正确的随机洗牌算法需要一个不同的随机数生成器——生成一个范围内的随机数[n..m) — 而不是只生成 0..999 范围内的数字）。

```
for (int i = 0; i < NUM_ITEMS; i++)
{
    int j = rand();
    int t = mapper[j];
    mapper[j] = mapper[i];
    mapper[i] = t;
} 
```

您现在可以遍历节点数组，按照数组中的顺序链接它们`mapper`。因为数组中没有重复项，所以列表中没有循环。

```
head = &node_array[mapper[0]];

for (i = 1; i < NUM_ITEMS; i++)
{
    head->next = head;
    head = &node_array[mapper[i]];
} 
```

等等...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:51:07.857

不需要额外空间的解决方案。虽然注意这`rand()`被称为每个节点分配的随机次数：

```
struct Node
{
    Node* next;
};

int main()
{   
    Node nodes[1000];
    Node* pNext = NULL; 
    Node* pHead = NULL; 
    Node* pTail = NULL;
    int i = 0;
    // reset .next to NULL
    memset(nodes, 0, sizeof(nodes));
    srand ( time(NULL) );
    pHead = &nodes[ rand() % (1000)];           
    pTail = pHead;
    // need only 999 runs as one node is already assigned
    for (i = 0; i < 999; ++i)
    {   
        pTail->next = pTail;
        while ((pNext = &nodes[ rand() % (1000)]) && pNext->next);
        pTail->next = pNext;
        pTail = pNext;
    }
    // pTail->next = pHead; // uncomment if you need circular list
} 
```

# python - 带有数组的 Numpy 索引

> ID：13482086
> 
> 赞同：3
> 
> 时间：2012-11-20T21:03:10.947
> 
> 标签：python, numpy, scipy

我有 2 个数组 [nx1] 分别存储 xpixel（样本）和 ypixel（线）坐标。我有另一个数组 [nxn] 存储图像。我想做的是创建第三个数组，它将图像数组中的像素值存储在给定坐标处。我有这个与以下一起工作，但想知道内置的 numpy 函数是否会更有效。

```
#Create an empty array to store the values from the image.
newarr = numpy.zeros(len(xsam))

#Iterate by index and pull the value from the image.  
#xsam and ylin are the line and sample numbers.

for x in range(len(newarr)):
    newarr[x] = image[ylin[x]][xsam[x]]

print newarr 
```

随机生成器确定 xsam 和 ylin 的长度以及通过图像的行进方向。因此，每次迭代都完全不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:32:07.823

If`image`是一个 numpy 数组并且`ylin`,`xsam`是一维的：

```
newarr = image[ylin, xsam] 
```

如果`ylin`,`xsam`是二维的，第二维是`1`eg，`ylin.shape == (n, 1)`则首先将它们转换为一维形式：

```
newarr = image[ylin.reshape(-1), xsam.reshape(-1)] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T21:27:51.580

您可以使用[高级索引](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#advanced-indexing)：

```
In [1]: import numpy as np
In [2]: image = np.arange(16).reshape(4, 4)
In [3]: ylin = np.array([0, 3, 2, 2])
In [4]: xsam = np.array([2, 3, 0, 1])
In [5]: newarr = image[ylin, xsam]
In [6]: newarr
array([ 2, 15,  8,  9]) 
```

# visual-studio-lightswitch - 将自定义参数传递到 Lightswitch 中的屏幕

> ID：13482088
> 
> 赞同：1
> 
> 时间：2012-11-20T21:03:16.983
> 
> 标签：visual-studio-lightswitch

我有一张“发票”表和一张“支票”表。我有一个创建发票的屏幕和一个创建支票的屏幕。在支票屏幕上，我有一个“选择发票”按钮。单击该按钮将打开“发票”屏幕，以便用户可以选择要添加到当前支票的发票。

在发票屏幕中，我添加了一个命令按钮“添加到支票”，因此当用户单击该按钮时，发票将添加到支票中。

这是发票屏幕的屏幕截图。

![在此处输入图像描述](../Images/19858cbef08ff5e53bf010e31d4ad9c3.png)

问题：

1.  这种方法是正确的吗？我的意思是，有没有更好的方法将发票添加到支票中？
2.  如果这是要走的路，那么我如何将当前的 Check 实例传递到 Invoices 屏幕，以便我可以填写 Invoices 表中的 Checks 属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T01:05:52.083

据我了解，您有两个屏幕：发票屏幕和支票屏幕。我的建议是以下步骤：

1.  在发票屏幕上创建一个 checkId 属性
2.  将 checkId 属性标记为屏幕参数
3.  当您单击按钮并导航到发票屏幕时，传递所选支票的 id
4.  在 Invoices 屏幕的 created 事件上，处理 checkId 属性。
5.  您可以加载检查对象，然后可以使用该对象来填写 Checks 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T10:00:29.923

1.  是的，这看起来是个好方法
2.  根据您的屏幕设计，当您单击按钮时，我认为不需要打开发票屏幕。

您需要做的就是：

**VB：**

```
Private Sub ButtonName_Execute
    If (Me.Invoices.SelectedItem Is Nothing) Then Return

    Me.Invoices.SelectedItem.Check = Me.CheckProperty
End Sub 
```

**C＃：**

```
private void ButtonName_Execute()
{
    if (this.Invoices.SelectedItem == null) { return; }

    this.Invoices.SelectedItem.Check = this.CheckProperty;
} 
```

这假设*Listado de Ofertas/Facturas*集合的名称是*Invoices*，如果它是其他东西（例如*Facturas*，只需替换集合的实际名称。与 CheckProperty 名称相同处理，只需替换实际名称屏幕绑定的 Check 属性。

# sql - SQLite 中的更新语法

> ID：13482091
> 
> 赞同：18
> 
> 时间：2012-11-20T21:03:38.510
> 
> 标签：sql, sqlite, sql-update

我需要知道是否可以在 UPDATE 语句中执行此操作：

```
UPDATE users SET ('field1', 'field2', 'field3') 
VALUES ('value1', 'value2', 'value3'); 
```

或类似的语法。我正在使用 SQLite。

**笔记：**

> 没有人理解我，我只想知道是否可以将单独的字段设置为单独的值。就这样。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-11-20T21:16:59.957

有一个（标准 SQL）语法与您提出的类似，但据我所知，只有 Postgres 实现了它：

```
UPDATE users
SET  (field1, field2, field3)
   = ('value1', 'value2', 'value3') 
WHERE some_condition ; 
```

**[在SQL-Fiddle](http://sqlfiddle.com/#!1/5678f/1)**中测试（针对异教徒）

* * *

这也适用于 Postgres：

```
UPDATE users AS u
SET 
   (field1, field2, field3)
 = (f1, f2, f3)
FROM
  ( VALUES ('value1', 'value2', 'value3')
  ) AS  x (f1, f2, f3)
WHERE condition ; 
```

* * *

这适用于 Postgres 和 SQL-Server：

```
UPDATE users 
SET 
   field1 = f1, field2 = f2, field3 = f3
FROM
  ( VALUES ('value1', 'value2', 'value3')
  ) AS  x (f1, f2, f3)
WHERE condition ; 
```

* * *

正如@JackDouglas 评论的那样，这适用于Oracle：

```
UPDATE users
SET  (field1, field2, field3)
   = ( SELECT 'value1', 'value2', 'value3' FROM dual ) 
WHERE condition ; 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-11-20T21:05:53.887

您发布的内容不是`UPDATE`. 你`UPDATE`的语法是：

```
UPDATE users 
SET field1 = 'value1',
    field2 = 'value2',
    field3 =  'value3'; 
```

您将要添加一个`WHERE`子句，否则这将`UPDATE`是所有记录。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-11-20T21:07:03.673

如果要更新记录，它应该如下所示。您应该很少希望在没有 WHERE 条件的情况下进行更新。

```
UPDATE users
SET field1='value1',
    field2='value2',
    field3='value3'
WHERE field1=1 
```

## [SQL小提琴](http://sqlfiddle.com/#!5/10f3a/1/0)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-11-20T21:05:36.553

尝试

```
UPDATE users SET field1='value1', field2='value2' 
```

ETC...

[你可以在这里](http://www.sqlite.org/lang_update.html)找到官方文档。

W3Schools 也有一个有用的[页面](http://www.w3schools.com/sql/sql_update.asp)：

> SQL 更新语句
> 
> *UPDATE 语句用于更新表中的记录。*
> 
> **SQL 更新语法**

```
UPDATE table_name
SET column1=value, column2=value2,...
WHERE some_column=some_value 
```

> 注意：请注意 UPDATE 语法中的 WHERE 子句。WHERE 子句指定应该更新哪些记录。如果省略 WHERE 子句，所有记录都会更新！

*编辑：由于您似乎需要创建一个字符串，因此安全地执行此操作的常规方法是使用准备好的语句。*

假设是 Java，我们已经在 StackOverflow 上有了[这个例子：](https://stackoverflow.com/a/436162/7028)

```
SQLiteDatabase db = dbHelper.getWritableDatabase();
SQLiteStatement stmt = db.compileStatement("SELECT * FROM Country WHERE code = ?");
stmt.bindString(1, "US");
stmt.execute(); 
```

在你的情况下，

```
SQLiteDatabase db = dbHelper.getWritableDatabase();
SQLiteStatement stmt = db.compileStatement("UPDATE users SET field1=?, field2=?...");
stmt.bindString(1, "value1");
stmt.bindString(2, "value2");
stmt.execute(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-05-20T15:30:55.437

不，sqlite 中**没有**这样的语法（postgress 似乎实现了这样的东西） - 但更好地使用：

```
UPDATE users SET firstname = 'Joe', lastname = 'value2', age = 50 WHERE id=12; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-24T18:16:30.207

从 3.15.0 版本开始支持此功能：

> [更新](https://sqlite.org/lang_update.html)
> 
> **SET 子句中的赋值可以是左侧的列名的括号列表和右侧相同大小的行值。**

语法如下：

```
UPDATE users 
SET ("field1", "field2", "field3") = ('value1', 'value2', 'value3')
-- WHERE ...; 
```

**[db<>小提琴演示](https://dbfiddle.uk/?rdbms=sqlite_3.27&fiddle=c97a1efba0b9005413d94409c3f1db0b)**

# java - 映射器输出在组合器中翻倍

> ID：13482097
> 
> 赞同：0
> 
> 时间：2012-11-20T21:04:03.570
> 
> 标签：java, hadoop, mapreduce, combiners

映射器只输出一次值。但是当我检查组合器的值是两次时。这对我来说真的很奇怪。

请帮忙。

发送输出的地图代码模块：

```
for(int i = 0; i<alcmapi.size(); i++)
{
    int section = 0;

    for(int j = 0; j<alcmapj.size(); j++)
    {
        if(!alcmapi.get(i).getid().equals(alcmapj.get(j).getid()))
        {
            int fi = Integer.parseInt(alcmapi.get(i).getField());
            int fj = Integer.parseInt(alcmapj.get(j).getField());

            ArrayList<CustomMap> al = new ArrayList<CustomMap>();
            al.add(new CustomMap(alcmapi.get(i).getid(), fi));
            al.add(new CustomMap(alcmapj.get(j).getid(), fj));

            if(fi<fj)
            {
                section = fi;
            }
            else
            {
                section = fj;
            }
            Collections.sort(al);
            {
                output.collect(new Text(t+" "+al.get(0).getid()), new Text(al.get(1).getid()+"  "+section));         

            }
        }
    }
} 
```

在组合器中：

当我在此处查看时，我看到与键对应的值加倍：

```
while(values.hasNext()){
    String val = values.next().toString();
    System.out.println("val:"+val);
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:26:29.317

看起来您针对所有其他元素测试所有元素。例如，如果元素 3 和 5 满足条件，那么您将针对 i=3, j=5 写出该对，然后针对 i=5, j=3 再写一次。

我建议您将内部循环更改为：

```
for(int j = i+1; j<alcmapj.size(); j++) 
```

# javascript - html5画布动画对象跟随路径

> ID：13482098
> 
> 赞同：0
> 
> 时间：2012-11-20T21:04:10.160
> 
> 标签：javascript, algorithm, html5-canvas, path-finding

我正在使用 A* 算法来计算我的路径，因此我有一个由 x 和 y 坐标 (x,y) 组成的节点数组。在鼠标单击时，我希望我的玩家根据瓷砖的中心点沿着阵列中的那些瓷砖移动，或者角点无关紧要。（允许对角线移动）。例如，我有一个 [(1,1),(2,2),(3,2)] 数组，这些值是基于图块的地图中的行和列值，基于它我可以计算图块中心点/角点，所以一旦我的玩家移动到第一个给定的瓷砖，那么他就会进入下一个，依此类推。需要注意的几件事： - 玩家与瓷砖的大小相同 - 玩家每三个单位移动一次（因此它不会与瓷砖的中心点完全对齐等等）

```
 function drawPlayerRunning(result) {

    ctx.clearRect(0, 0, mapCanvas.width, mapCanvas.height);
    drawMapTiles(ctx, 12, 12, tileSize);
    ctx.drawImage(tileSheet, 0, 40 * playerAnimationCounter, 40, 40, player.cornerPoint.x + canvasPadding, player.cornerPoint.y + canvasPadding, 40, 40);
    calculatePlayerPosition(result);

    function calculatePlayerPosition(result) {

        var row = result[nextTilePlayerMovesToCounter].x;
        var col = result[nextTilePlayerMovesToCounter].y;
        map[row][col] = 5;

        var tilePoint = cursor.getTileCornerPoint(row, col);

        var calc1 = tilePoint.x - player.cornerPoint.y;
        var calc2 = player.cornerPoint.y - tilePoint.x;
        var calc3 = player.cornerPoint.x - tilePoint.y;
        var calc4 = tilePoint.y - player.cornerPoint.x;

        playerAnimationCounter++;

        if ((calc1) >= player.pixelDistanceWhileMoving) {
            player.cornerPoint.y += player.pixelDistanceWhileMoving;
            //        $("#textDiv4").text("player cornerPoint (x,y): " + player.cornerPoint.x + "," + player.cornerPoint.y);
        } if ((calc2) >= player.pixelDistanceWhileMoving) {
            player.cornerPoint.y -= player.pixelDistanceWhileMoving;
            //        $("#textDiv4").text("player cornerPoint (x,y): " + player.cornerPoint.x + "," + player.cornerPoint.y);
        } if ((calc3) >= player.pixelDistanceWhileMoving) {
            player.cornerPoint.x -= player.pixelDistanceWhileMoving;
            //        $("#textDiv4").text("player cornerPoint (x,y): " + player.cornerPoint.x + "," + player.cornerPoint.y);
        } if ((calc4) >= player.pixelDistanceWhileMoving) {
            player.cornerPoint.x += player.pixelDistanceWhileMoving;
            //        $("#textDiv4").text("player cornerPoint (x,y): " + player.cornerPoint.x + "," + player.cornerPoint.y);
        }
        else {
            //alert("else - in tile");
            playerAnimationCounter = 0;
            nextTilePlayerMovesToCounter++;
            //alert(nextTilePlayerMovesToCounter + " - nextTilePlayerMovestoCounter");
            if (nextTilePlayerMovesToCounter == result.length) {
                //alert("if result.lenght == counter");
                nextTilePlayerMovesToCounter = 0;
                ctx.clearRect(0, 0, mapCanvas.width, mapCanvas.height);
                drawMapTiles(ctx, 12, 12, tileSize);
                drawPlayer();
                isPlayerRunningInProgress = false;
                clearInterval(playerTimerInterval);
                return false;
            }
            //ctx.clearRect(0, 0, mapCanvas.width, mapCanvas.height);
            //drawMapTiles(ctx, 12, 12, tileSize);
            //drawPlayer();
            //isPlayerRunningInProgress = false;
            //clearInterval(playerTimerInterval);
            //return;

        }

        if (playerAnimationCounter > player.pixelDistanceWhileMoving) {
            playerAnimationCounter = 0;
        }
    }
}

 function movePlayer(result) {

if (isPlayerRunningInProgress)
    return false;
isPlayerRunningInProgress = true;

animate(result);

function animate(result) {
    playerTimerInterval = setInterval(function(){drawPlayerRunning(result)}, 50);
   }
 } 
```

这是我的功能，它们有点乱，我想尽可能地简化它，当然最终让它工作。让我们不要担心我在这里拥有的一些变量，例如 isPlayerRunningInProgress 和与之相关的检查，因为我只需要帮助基本的玩家从瓷砖移动到瓷砖和与碰撞相关的检查（如果玩家到达他的目的地）。我猜我需要某种速度变量，例如 x 和 y 为 1、0 或为负数。感谢所有的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:01:12.453

我想出了这个计算函数：

```
 function calculatePlayerPosition(result) {

        var tilePoint = cursor.getTileCornerPoint(row, col);

        var tileYMinusPlayerY = tilePoint.x - player.cornerPoint.y;
        var tileXMinusPlayerX = tilePoint.y - player.cornerPoint.x;

        if (tileYMinusPlayerY > 2)
            velocityY = 1;
        else if (tileYMinusPlayerY < -2)
            velocityY = -1;
        else velocityY = 0

        if (tileXMinusPlayerX > 2)
            velocityX = 1;
        else if (tileXMinusPlayerX < -2)
            velocityX = -1;
        else velocityX = 0;

        playerAnimationCounter++;

        if (Math.abs(tileXMinusPlayerX) >= player.pixelDistanceWhileMoving || Math.abs(tileYMinusPlayerY) >= player.pixelDistanceWhileMoving) {
            //velocity X
            player.cornerPoint.x += player.pixelDistanceWhileMoving * velocityX;
            //velocity Y
            player.cornerPoint.y += player.pixelDistanceWhileMoving * velocityY;

        }
        else {
            playerAnimationCounter = 0;
            nextTilePlayerMovesToCounter++;

            if (nextTilePlayerMovesToCounter == result.length) {
                nextTilePlayerMovesToCounter = 0;
                ctx.clearRect(0, 0, mapCanvas.width, mapCanvas.height);
                drawMapTiles(ctx, 12, 12, tileSize);
                drawPlayer();
                isPlayerRunningInProgress = false;
                clearInterval(playerTimerInterval);
                return false;
            }
             row = result[nextTilePlayerMovesToCounter].x;
             col = result[nextTilePlayerMovesToCounter].y;

            map[row][col] = 5;

            ctx.clearRect(0, 0, mapCanvas.width, mapCanvas.height);
            drawMapTiles(ctx, 12, 12, tileSize);
            drawPlayer();

        }

        if (playerAnimationCounter > player.pixelDistanceWhileMoving) {
            playerAnimationCounter = 0;
        }

    } 
```

# android - android映射第一个程序

> ID：13482102
> 
> 赞同：0
> 
> 时间：2012-11-20T21:04:16.667
> 
> 标签：android, google-maps, mobile

我正在阅读有关移动地图应用程序的 Google 教程。我设法在 Android 虚拟手机中编译和运行我的应用程序：

5.4 FWVGA (480x854:mdpi)。

当我真正在手机中启动应用程序时，我只得到一张带有方形背景的空地图（如几何纸）。

我的感觉是这里出了点问题：

资源/布局/activity_main.xml：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world" />

</RelativeLayout> 
```

资源/布局/main.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<com.google.android.maps.MapView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mapview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:clickable="true"
    android:apiKey="blablabla"
/> 
```

AndroidManifest.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.hellogooglemaps"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="16" />
    <uses-permission android:name="android.permission.INTERNET"/>
    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme">
        <uses-library android:name="com.google.android.maps"/>
        <activity
            android:name=".HelloGoogleMaps" android:label="@string/app_name"
            android:theme="@android:style/Theme.NoTitleBar">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
       </activity>
    </application>
</manifest> 
```

所以要清楚，我如何让我的应用程序连接到互联网并加载磁贴？

谢谢

杰尼亚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:11:00.640

除了检查清单文件中是否授予了 Internet 权限（这是我开始开发新应用程序时经常忘记的东西），您在 MapView 对象的 apiKey 属性中使用的键是专门为调试目的而创建的? 如果不是这种情况，您将无法看到图块，尽管您仍然可以与 MapView 进行交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:53:02.917

假设您*的*项目中引用了 Google API，但您*没有*API 密钥 - 转到[此处](https://developers.google.com/maps/documentation/android/maps-api-signup)并使用[此文档](https://developers.google.com/maps/documentation/android/mapkey)来指导您完成使项目准备好使用的过程！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:31:32.473

这个链接是一个完整的解决方案：

(pt-br) [http://developerai.blogspot.com.br/2012/07/android-development-google-maps.html](http://developerai.blogspot.com.br/2012/07/android-development-google-maps.html)

不要忘记

```
 <uses-library android:name="com.google.android.maps" /> 
```

如果您是高级开发人员并且喜欢更好的应用程序，请了解：

[https://github.com/cyrilmottier/Polaris](https://github.com/cyrilmottier/Polaris)

# exception - Grails UnexpectedRollbackException 发生：不知道为什么

> ID：13482103
> 
> 赞同：9
> 
> 时间：2012-11-20T21:04:22.407
> 
> 标签：exception, grails, transactions

我有以下代码：

```
class ServiceA {

   def save(Object object) {
      if (somethingBadComesBack) {
         throw new CustomRuntimeException(data)
      }
   }
}

class ServiceB {

   def serviceA

   def save(Object object) {
      try {
         serviceA.save(object)
         // do more stuff if good to go
      } catch(CustomRuntimeException e) {
        // populate some objects with errors based on exception
      }
   }
}

class ServiceC {

    def serviceB

    def process(Object object) {
       serviceB.save(object)
       if (object.hasErrors() {
          // do some stuff
       }else{
         // do some stuff
       }

       def info = someMethod(object)
       return info
    }
}

class SomeController {

   def serviceC

   def process() {

     def object = .....
     serviceC.save(object) // UnexpectedRollbackException is thrown here

   }
} 
```

当`ServiceA.save()`被调用并发生异常时，当它试图返回时`ServiceC.save()`抛出一个。`UnexpectedRollbackException`

我做了以下事情：

```
try {
   serviceC.process(object)
}catch(UnexpectedRollbackException e) {
   println e.getMostSpecificCause()
} 
```

我得到：

```
org.springframework.transaction.UnexpectedRollbackException: Transaction rolled back because it has been marked as rollback-only 
```

我不确定从哪里开始寻找如何解决这个问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-20T22:02:08.083

您正在使用运行时异常来回滚事务，但这是作弊 - 它利用了副作用。运行时异常会自动回滚事务，因为您不需要捕获它们，因此假设如果抛出异常，则不是预期的，默认行为是回滚。您可以将方法配置为不回滚特定的预期运行时异常，但这有点少见。已检查的异常不会回滚异常，因为在 Java 中它们必须被捕获或在 中声明`throws`，因此您必须显式抛出它或躲避它；无论哪种方式，您都有机会再试一次。

有意回滚事务的正确方法是调用`setRollbackOnly()`当前事务，`TransactionStatus`但这不能在服务方法中直接访问（它在一个`withTransaction`块中，因为它是闭包的参数）。但是很容易做到： import`org.springframework.transaction.interceptor.TransactionAspectSupport`和 call `TransactionAspectSupport.currentTransactionStatus().setRollbackOnly()`。这将要求您重新编写代码，因为不会捕获异常，因此您需要检查它是否已使用`TransactionAspectSupport.currentTransactionStatus().isRollbackOnly()`.

我不确定这是 Grails 问题还是标准行为，但是当我调试它时，有 3 个提交调用和 3 个不同的`TransactionStatus`实例。只有第一个设置了回滚标志，但第二个知道第一个并且没问题。第三个被认为是一个新事务，它触发了您所看到的相同异常。所以为了解决这个问题，我将它添加到第二和第三个服务方法中：

```
def status = TransactionAspectSupport.currentTransactionStatus()
if (!status.isRollbackOnly()) status.setRollbackOnly() 
```

链接回滚标志。那行得通，我没有得到`UnexpectedRollbackException`.

将它与检查异常结合起来可能更容易。它仍然过于昂贵，因为它会不必要地填充堆栈跟踪，但如果你调用`setRollbackOnly()`并抛出一个检查异常，你将能够使用你现在拥有的相同的一般工作流程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:01:28.783

似乎服务的[默认事务性](http://grails.org/doc/latest/guide/services.html)正在咬你，服务 A 中抛出的未经检查的异常注定了事务只能回滚，即使被捕获也是如此。

上面的文档说 txn 传播级别是[`PROPAGATION_REQUIRED`](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/transaction/TransactionDefinition.html#PROPAGATION_REQUIRED)，这应该意味着相同的事务从您的服务 C 共享到 A，如果我没记错的话。你可以让服务 A 的`save`方法抛出一个检查异常而不是 RuntimeException，以避免后者的自动回滚吗？或者禁用您的服务上的交易，如果这是您的选择？

# c# - 如何在 ASP.Net 网页上使用 OleDb 向数据库添加新行

> ID：13482114
> 
> 赞同：0
> 
> 时间：2012-11-20T21:04:47.807
> 
> 标签：c#, asp.net, database, arrays, ms-access

问题：

我有一个包含 18 个文本框字段的网页，我需要将它们插入一行。列名保存在名为 的 Label 数组`labelArray`中。用户输入数据的文本字段将位于名为 的文本框数组中`textArray.Text`。

我想知道如何将所有 18 个文本字段传递`textArray`到我的数据访问层，在那里我将这些字段插入数据库。我现在的问题是我无法将数组传递给类文件。是否可以转换为字符串并将插入字符串传递给我的数据访问层？

更深入的问题：

在我的 MS 访问数据库中有两列的数据设置为日期/时间。如何将日期时间对象传递给我的访问表？如果它是格式化的字符串可以吗？

如果您需要查看我拥有的一些代码，我已准备好发布它们，并将在接下来的几个小时内使用 StackOverflow。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:43:59.557

以下代码将 a`Textbox[]`转换为等效的字符串表示形式：

```
var str = String.Join("\",\"", TextArray.Select(tb => tb.Text));
if (!string.IsNullOrEmpty(str)) {
    str = "\"" + str + "\"";
}
str = "[" + str + "]"; 
```

请记住，双引号不会被转义。可以在[此处](https://stackoverflow.com/questions/323640/can-i-convert-a-c-sharp-string-value-to-an-escaped-string-literal)和[此处](http://www.hariscusto.com/programming/escape-string-in-c/)找到解决方案。

# ios - 使用圆形绘制三角形

> ID：13482115
> 
> 赞同：0
> 
> 时间：2012-11-20T21:04:49.517
> 
> 标签：ios, ipad, drawing, uibezierpath

有没有办法让用户在 iOS 中使用圆形（透明圆形）绘制三角形。我正在考虑在圆圈中设置三个相等的点来创建三角形，并在拉伸圆圈时构建三角形。也许使用 bezierPathWithArcCenter 或 bezierPathWithOvalInRect。有人做过吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:45:36.650

假设您已经有了手势识别器或其他一些系统来捕捉用户触摸的位置，那么绘制本身就很简单。

```
CGContextRef context = UIGraphicsGetCurrentContext();

// Draw circle
CGFloat derivedRadius = self.radius * self.scale;
CGPoint origin = CGPointMake(self.center.x - derivedRadius, self.center.y - derivedRadius);
CGContextAddEllipseInRect(context, CGRectMake(origin.x, origin.y, derivedRadius * 2, derivedRadius * 2));

// Draw triangle
CGFloat t1 = self.rotation;
CGFloat t2 = self.rotation + ((2 * M_PI) / 3);
CGFloat t3 = self.rotation + ((4 * M_PI) / 3);
CGPoint p1 = CGPointMake(self.center.x + cosf(t1) * derivedRadius, self.center.y + sinf(t1) * derivedRadius);
CGPoint p2 = CGPointMake(self.center.x + cosf(t2) * derivedRadius, self.center.y + sinf(t2) * derivedRadius);
CGPoint p3 = CGPointMake(self.center.x + cosf(t3) * derivedRadius, self.center.y + sinf(t3) * derivedRadius);
CGPoint endpoints[] = { p1, p2, p3, p1 };
CGContextAddLines(context, endpoints, 4);

CGContextStrokePath(context); 
```

其中`self.radius`、`self.scale`、`self.center`和`self.rotation`是捕获用户手势结果的属性。旋转应该以弧度为单位。

# algorithm - 将 n 写为 2 的幂和的方式数

> ID：13482119
> 
> 赞同：2
> 
> 时间：2012-11-20T21:04:54.777
> 
> 标签：algorithm, math

有没有什么算法可以找出有多少种方法可以写一个数字，例如 n ，幂和为 2 ？

示例：对于 4 有四种方法：

```
4 = 4 
4 = 2 + 2 
4 = 1 + 1 + 1 + 1
4 = 2 + 1 + 1 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T12:35:44.510

假设 g(m) 是将 m 写为 2 的幂和的方式数。我们使用 f(m,k) 来表示将 m 写为 2 的幂和所有数字的方式的数量'功率小于或等于 k。然后我们可以简化为等式：

```
if m==0 f(m,k)=1;    
if k<0 f(m,k)=0;    
if k==0 f(m,k)=1;    
if m>=power(2,k) f(m,k)=f(m-power(2,k),k)+f(m,k-1);//we can use power(2,k) as one of the numbers or not.    
else f(m,k)=f(m,k-1); 
```

以6为例：

```
g(6)=f(6,2)
=f(2,2)+f(6,1)
=f(2,1)+f(4,1)+f(6,0)
=f(0,1)+f(2,0)+f(2,1)+f(4,0)+1
=1+1+f(0,1)+f(2,0)+1+1
=1+1+1+1+1+1
=6 
```

下面是代码：

```
#include<iostream>
using namespace std;

int log2(int n)
{
    int ret = 0;
    while (n>>=1) 
    {
        ++ret;      
    }
    return ret;
}

int power(int x,int y)
{
    int ret=1,i=0;
    while(i<y)
    {
        ret*=x;
        i++;
    }
    return ret;
}

int getcount(int m,int k)
{
    if(m==0)return 1;
    if(k<0)return 0;
    if(k==0)return 1;
    if(m>=power(2,k))return getcount(m-power(2,k),k)+getcount(m,k-1);
    else return getcount(m,k-1);

}

int main()
{
    int m=0;
    while(cin>>m)
    {
        int k=log2(m);
        cout<<getcount(m,k)<<endl;
    }
    return 0;
} 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T21:50:26.760

序列的递归定义（来自 Peter 到 A018819 的链接）：

[f(n) = 1 如果 n = 0, Sum(j = 0..[n/2], f(j)) 如果 n > 0 http://mathurl.com/nuaarfm.png](http://mathurl.com/nuaarfm.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-09T04:16:31.523

您想找到可以将数字表示为 2 的幂的总和的方式的数量。首先，您需要找到该特定数字中设置的位数，因为设置的位数将为我们提供最小数量需要将其表示为 2 的幂的总和。将其表示为 2 的幂的总和所需的最大数字将是数字本身，因为您可以将其表示为 1 的总和（因为 2 的 0 幂是 1 ）。例子：5可以表示为（1+1+1+1+1）

因此，将数字表示为 2 的幂的方法总数由公式简单地给出 --> 令 no 为 x ( x - no of set bits in x ) + 1 ；例如，设数字为 17，则 17 中的设置位数为 2，因此路数为 (17 - 2) + 1 = 16；

# python - 如何在 python 中删除矩阵中的第一列？

> ID：13482121
> 
> 赞同：0
> 
> 时间：2012-11-20T21:04:58.020
> 
> 标签：python, matrix

我有一个矩阵，想删除 python 中的第一列。最好的方法是什么？

例如：去掉 E 的第一列。

```
 E E E E E
    E 1 2 3 4
    E 5 6 7 8
    E 9 1 2 3 
```

正在从 txt 文件中读取矩阵。我试图将第一行用作键，去掉第一列并将剩余的行用作值。

这是我到目前为止所拥有的：

```
 matrix_filename = raw_input("Enter the scoring matrix filename:  ")  
    matrix_file = open(matrix_filename, "r")  
    matrix = matrix_file.readlines()  
    keys = matrix[0]  
    vals = matrix[1:] 
```

我希望这些值只是数字。

多谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:18:12.320

我将假设您的矩阵只是一个数组数组，如果是这种情况，则以下代码有效。但是，它不会就地删除元素，它会返回删除第一列的矩阵副本。

```
>>> m = [ [x*5+y for y in range(5)] for x in range(5) ]
>>> m2 = [ row[1:] for row in m ]
>>> print m
[[0, 1, 2, 3, 4], [5, 6, 7, 8, 9], [10, 11, 12, 13, 14], [15, 16, 17, 18, 19], [20, 21, 22, 23, 24]]
>>> m2
[[1, 2, 3, 4], [6, 7, 8, 9], [11, 12, 13, 14], [16, 17, 18, 19], [21, 22, 23, 24]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:18:20.570

```
vals = [line[1:] for line in matrix[1:]] 
```

只需执行与删除矩阵中的第一行相同的操作，但要单独删除每一行。

# ruby-on-rails - Twitter Bootstrap 主题

> ID：13482123
> 
> 赞同：-1
> 
> 时间：2012-11-20T21:05:19.500
> 
> 标签：ruby-on-rails, twitter-bootstrap

我碰巧在我没有使用脚手架的情况下生成的一个模型上使用了 bootstrap:themed 并且它有效。但是，我需要找到用于此的 CSS 类，在我的项目中哪里可以找到它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:32:15.743

Rails 3 中所有 .css 文件的通常位置是 app/assets/stylesheets（名称为 bootstrap.css 或类似名称的文件）。这取决于您使用的引导程序的实现 - 源文件或 gem。在 gem 实现的情况下，您应该在 GitHub 存储库中查找源代码（在您的情况下为类）。

# xna - 来自 VertexShader 的 XNA/HLSL 高度图

> ID：13482125
> 
> 赞同：2
> 
> 时间：2012-11-20T21:05:28.407
> 
> 标签：xna, hlsl

任何人都可以告诉我为什么会收到此错误：

**当前顶点声明不包括当前顶点着色器所需的所有元素。缺少 TextureCoordinate0。**

使用标准的顶点着色器，一切都很好。

**这是我的着色器文件：**

```
float4x4 World; 
float4x4 View; 
float4x4 Projection; 
float4 color; 
float seaLevel; 
texture myTexture; 
float maxHeight = 128; 
float height; 

sampler2D mySampler = sampler_state 
{ 
Texture = <myTexture>; 
MinFilter = Point; 
MagFilter = Point; 
MipFilter = Point; 
AddressU = Clamp; 
AddressV = Clamp; 
}; 

struct VertexShaderInput 
{ 
float4 Position : POSITION0; 
}; 
struct VertexShaderOutput 
{ 
float4 Position : POSITION0; 
}; 

struct VS_INPUT 
{
    float4 position : POSITION;
    float4 uv : TEXCOORD0;
};

struct VS_OUTPUT
{
     float4 position  : POSITION;
     float4 uv : TEXCOORD0;
     float4 worldPos : TEXCOORD1;
};

VS_OUTPUT Transform(VS_INPUT In)
{
      VS_OUTPUT Out = (VS_OUTPUT)0;    
      float4x4 viewProj = mul(View, Projection);
      float4x4 worldViewProj= mul(World, viewProj);
      float height = tex2Dlod ( mySampler, float4(In.uv.xy , 0 , 0 ) );
      In.position.y = height * maxHeight;
      Out.worldPos = mul(In.position, World);
      Out.position = mul( In.position , worldViewProj);
      Out.uv = In.uv;
      return Out;
}

VertexShaderOutput VertexShaderFunction(VertexShaderInput input) 
{ 

    VertexShaderOutput output; 

    float4 worldPosition = mul(input.Position, World); 

    worldPosition = float4(normalize(worldPosition.xyz) * seaLevel, 1); 

    float4 viewPosition = mul(worldPosition, View); 
    output.Position = mul(viewPosition, Projection); 

    return output; 
} 

float4 PixelShaderFunction(VertexShaderOutput input) : COLOR0 
{ 

return color; 
} 

technique Technique1 
{ 
pass Pass1 
{ 

VertexShader = compile vs_3_0 Transform(); 
PixelShader = compile ps_3_0 PixelShaderFunction(); 
} 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:03:48.413

您尝试绘制的模型具有不包含纹理坐标的顶点。

您的顶点着色器需要一个纹理坐标才能工作，如您的技术中指定的顶点着色器使用的结构中所示。

```
struct VS_INPUT 
{
    float4 position : POSITION;
    float4 uv : TEXCOORD0;
};

technique Technique1 
{ 
    pass Pass1 
    {     
        VertexShader = compile vs_3_0 Transform(); 
```

所以，你有两个选择：

1）从VS_INPUT中删除“uv”

2）将纹理坐标字段添加到模型使用的顶点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:43:33.580

我通过在 3D Studio Max 中打开模型、添加“UVM 贴图”修改器并导出回来解决了同样的问题。不是一个令人满意的解决方案，但对我有用。

# ios - phonegap 2.2 方向更改不会调整应用程序大小

> ID：13482126
> 
> 赞同：20
> 
> 时间：2012-11-20T21:05:28.987
> 
> 标签：ios, cordova

我在以前版本的 Phonegap 上没有这个问题。但是在 2.2 中，当我更改方向时，它不会更新`uiwebview`.

phonegap 默认不支持横向视图吗？你怎么处理这个？

![问题](../Images/39109237d0bc7e5ab67ebf0ef8c1cccb.png)

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-11-25T13:20:49.427

这不是 WebView 更新的问题，而是 index.html 文档头中的元标记。

```
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" /> 
```

删除不必要的`height=device-height`一切后一切正常

```
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, target-densitydpi=device-dpi" /> 
```

![支持横向](../Images/0803ead8e901ba45cca3d4c4f36308e7.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-02T03:42:41.307

要添加到斯蒂芬的答案，如果您在方向改变时需要做任何特别的事情，您可以将回调函数设置为：

window.onorientationchange

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-21T05:05:03.873

# 我在 ios phonegap 中也有同样的问题....

只需去更新 x-code 项目文件（IOS 应用程序目标）更改或更新支持界面方向并检查所有方向。

它运作良好......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-28T15:13:18.757

```
window.addEventListener(
    "orientationchange",
    function() {
        // Announce the new orientation number
        location.reload();
    }, false ); 
```

# sql-server - 使用两个字段的内连接：使用一个或两个索引？

> ID：13482127
> 
> 赞同：3
> 
> 时间：2012-11-20T21:05:34.137
> 
> 标签：sql-server

我有这个场景：

```
TableA: +2M rows.
TableB: +60K rows. 
```

我需要`INNER JOIN`他们两个领域`([Month] AS INT, [Year] AS INT)`。

我希望提高该查询的性能；为此，我可以为 和 创建一个索引，也可以为和`[Month, Year]`创建两个单独的索引。我应该考虑什么标准来选择这两种方法之一？`[Month]``[Year]`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:09:23.877

你会在没有搜索的`year`情况下搜索`month`吗？`month`没有搜索就搜索怎么`year`办？

如果您永远不会搜索其中一列而不搜索另一列，则创建一个包含这两列的索引。

如果您只搜索`month`, 或`month`and `year`，则为 , 创建一个索引`month`，`year`注意这`month`是索引的前沿。

如果您有时会单独搜索每列，请创建两个单独的索引，每列一个...如果同时搜索两列，Sql Server 可以有效地使用这两个索引。

# java - 同机 JVM 之间最快的通信

> ID：13482130
> 
> 赞同：4
> 
> 时间：2012-11-20T21:05:43.020
> 
> 标签：java, jvm, rmi, pipe

我需要从在同一台机器上运行的另一个 JVM 调用一个方法。这些方法需要以类似 Java/native 的性能调用很多次。是一种小投入小产出的方法。另一个 JVM 在同一台机器上运行。

进行此调用并从“附近”运行的其他 JVM 检索结果的最快方法是什么？

一些选项可能是 RMI、管道、套接字、JMS、优化的同机 JVM 间通信支持、JVM 中的一些低级 hack。欢迎任何想法，无论它多么专业。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T21:30:46.877

在同一台机器上的 JVM 之间进行通信的最快方式是使用共享内存，例如通过内存映射文件。这比使用 Socket over loopback 快 100 倍。例如，200 ns 的往返时间与 10-20 微秒的 Socket 往返时间。

一种实现是[Java Chronicle](https://github.com/peter-lawrey/Java-Chronicle) BTW 100 ns 延迟包括消息的持久性。

您是否需要这些解决方案中的任何一个都不应该是理所当然的。通常，当人们说他们必须拥有“最快”时，他们的真正意思是他们不知道它需要多快，所以如果他们选择最快的应该是正确的解决方案。这通常是不正确的，因为采用最快的解决方案通常意味着在设计和实现中做出妥协，如果你知道真正的需求是什么，那么它可能永远不需要。

简而言之，除非您有特定的、可测量的延迟和/或吞吐量要求，否则您应该假设最简单的解决方案就是您真正想要的。如果您对所需内容有了更好的了解，如果发现它不适合，则可以用更快的方法替换它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:41:54.820

另一种可能性是[0MQ (ZeroMQ)](http://www.zeromq.org/)，尽管这取决于您所说的“最快”的含义 - zeromq 非常适合*吞吐量*，但如果您绝对必须具有尽可能低的*延迟*，它可能不是最佳的。

ZeroMQ 对两个 JVM 来说可能是多余的，但它的优点是，如果您以后想将其中一个 JVM 移动到另一台机器上，或者与非 Java 进程通信，ZeroMQ 仍然可以正常工作 - 并且它可以扩展到更大规模，也更复杂的通信。

# javascript - 更简洁的jquery，用于控制同一div的可见性的多按钮

> ID：13482131
> 
> 赞同：0
> 
> 时间：2012-11-20T21:05:43.980
> 
> 标签：javascript, jquery

我有 3 个按钮来控制 1 个 div 的可见性。

我们要对 div 做以下操作：

*   显示第一次单击三个按钮中的任何一个
*   显示单击的按钮是否与先前单击的按钮不同
*   如果单击的按钮与上一次单击的按钮相同并且 div 当前可见，则隐藏
*   显示单击的按钮是否与先前单击的按钮相同，以及 div 当前是否不可见

目前我有这个：

```
//$('#alert_area') = target div

$button = $('.button')

if ($button.attr('id') != $('#alert_area').attr('showing')){
    $('#alert_area').show()
}else{
    if ($('#alert_area').is(":visible")){
        $('#alert_area').hide(); 
    }else{
        $('#alert_area').show(); 
    }
}
$('#alert_area').attr('showing', $button.attr('id')) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:09:26.350

这只是一个轻微的改进，但您可以将您的`else`块替换为`toggle`. 你也可以缓存你的选择器来整理东西。

```
 var $button = $('.button'), $alertArea = $("#alert_area");

 if ($button.attr('id') != $alertArea.attr('showing')) {
     $alertArea.show()
 } else {
     $alertArea.toggle();
 }

 $alertArea.attr('showing', $button.attr('id')); 
```

# java - Java中的包和它的子包之间有什么关系？

> ID：13482134
> 
> 赞同：4
> 
> 时间：2012-11-20T21:05:57.603
> 
> 标签：java, package

> **可能重复：**
> [Java：子包可见性？](https://stackoverflow.com/questions/1967229/java-subpackage-visiblity)

这是问题[Java 的延续：子包可见性？](https://stackoverflow.com/q/1967229/932307). 询问的原因是为了引起更广泛社区的关注。

**问题**odp.proj 和 odp.proj.subpackage 这两个包之间有什么关系吗？

有人试图在[这里](https://stackoverflow.com/a/1967259/932307)回答它，但未能描述它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T21:10:13.077

`odp.proj`不，`odp.proj.subpackage`从 Java 语言的角度来看，两者之间没有关系。

对于代码，odp.proj.subpackage 将驻留在 odp.proj 的子目录中，并且一些工具和 IDE 可能会将它们组合在一个 UI 中，但是关于语言访问控制或其他语言功能没有关系。

Java 没有子包的概念，因此 odp.proj.subpackage 和 odp.proj 与任何其他不同命名的包一样彼此不同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T21:13:33.657

## 简短的回答

您正在寻找的确切功能不存在。

## 长答案

[他们考虑为 Java 1.7 做这件事，但该案例处于休眠状态。](http://jcp.org/en/jsr/detail?id=294)

就实际情况而言，除了目录结构、关键字之类的东西`odp.proj`之外，它们之间根本没有任何关系——除了该语句没有从中获取任何类`odp.proj.subpackage``protected``import odp.proj.*;``odp.proj.subpackage`

解决您想要的内容的一种方法是为您想要公开的内容发布 API 规范，并将其余部分保留为未记录或私人记录的内容。您甚至可以使用[ProGuard](http://proguard.sourceforge.net/)之类的东西来混淆每个版本中的私有类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T21:10:39.880

Java 没有子包的概念。

除了组织之外，包使用和“包”（空白）修饰符定义方法/字段的可访问性`protected`，它允许同类和同包访问。但是，这种同包访问也不包括子包类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T22:06:54.167

通常，如果包名称包含“内部”一词，则用户不应直接使用它，因为不能保证这些包将出现在未来的版本中。这只是一个命名约定，但仍然可以作为一种解决方法。

# visual-studio-2010 - 我可以使用 VS2010 TFS Power Tools PowerShell cmdlet 将源代码管理文件的内容直接获取到变量中吗？

> ID：13482139
> 
> 赞同：0
> 
> 时间：2012-11-20T21:06:18.743
> 
> 标签：visual-studio-2010, tfs, powershell-2.0, tfs-power-tools

我想使用存储在 TFS 源代码管理中的 XAML 文件的最新内容并将其嵌入到字符串变量中，该变量将作为查询提交给 MS SQL Server。

我一直在 PowerShell 中使用 TFS Power Tools cmdlet（例如 Get-TfsChildItem 和 Select-TfsItem）来成功获取 TFS 文件、变更集和搁置集的句柄。但是我无法识别这些对象上的任何方法或属性，这些方法或属性可以让我直接将文件的内容放入变量中。

我想做这样的事情：

```
$tfsFileName = "$/MyBranch/MyFile.xaml"
$tfsServerName = "http://myTFSServer:8080/tfs"
$tfsServer = Get-TfsServer $tfsServerName

$xamlFile = Get-TfsChildItem -Item $tfsFileName -Server $tfsServer

$xamlContent = (Get-Content $xamlFile) 
```

这可能吗，还是我总是必须使用 tf.exe 执行 Get Latest，然后获取本地文件的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-26T19:02:29.773

当我收到有关 Team Foundation Services 在我的服务器上不可用的消息时，我发现我的 URI 错误。我最初有[http://tfs.mycompanyweb.mycompany.com:8080/tfs/ist/ISTDatabaseTools](http://tfs.mycompanyweb.mycompany.com:8080/tfs/ist/ISTDatabaseTools)但将其更改为[http://tfs.mycompanyweb.mycompany.com:8080/tfs/ist](http://tfs.mycompanyweb.mycompany.com:8080/tfs/ist)并清除了该错误。

我仍然无法让 DownloadFile 正常工作。我正在尝试自己做类似的事情。

乔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:42:04.177

我想你想要[`DownloadFile`](http://msdn.microsoft.com/en-us/library/bb138502%28v=vs.100%29.aspx)一个[`Item`](http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.versioncontrol.client.item%28v=vs.100%29.aspx). 例如：

```
$xamlFile = Get-TfsChildItem -Item $tfsFileName -Server $tfsServer
$xamlFile.DownloadFile("C:\Temp\file.xaml") 
```

# javascript - 身份验证后如何在 SOA 中的服务层重定向用户？

> ID：13482140
> 
> 赞同：1
> 
> 时间：2012-11-20T21:06:18.643
> 
> 标签：javascript, php, ajax

我正在构建一个 Web 应用程序并使用 SOA。现在，每当用户向数据库发送任何内容时，他都需要一个身份验证（我构建的安全令牌）。如果令牌已更改，则应用程序应将用户踢出。首先，我在数据库中进行 AJAX 调用以进行聊天，然后在服务层，这是我在服务层中测试令牌的地方：

```
function putChat($d,$ip,$token){
///check security
//if the user should be here
if(checkToken($token,$ip,$user_id)){
     echo putChatData($message,$room,$user_id);   
}
//if not, send false back to kick him out
else{
    header('Location: logout.php');
} 
```

}

我的问题是这个标头的东西在服务层根本不起作用，我试图把它放在顶部并且在此之前什么都不回显，但它不起作用。我应该怎么办？

# c# - 从 MVC WebApi 调用 Git/SSH 时挂起

> ID：13482145
> 
> 赞同：3
> 
> 时间：2012-11-20T21:06:42.013
> 
> 标签：c#, git, asp.net-mvc-4, asp.net-web-api

我正在处理的项目的一部分（Windows、C#、MVC4 WebAPI）需要与 git 进行一些集成。现有的 C# git 库都不支持远程克隆，所以我最终移植了我们需要的[JavaGit](http://javagit.sourceforge.net/)项目的部分（结帐、获取、状态），并自己编写了克隆。它实际上只是 git 命令行可执行文件的包装器。它调用的相关代码在这里：

```
public static void RunGitCommand(string repositoryPath, string gitArguments)
{
    // GitCommand is the full path to git.exe (currently using Github for Windows)
    if (null == GitCommand || String.IsNullOrWhiteSpace(GitCommand))
    {
        throw new FileNotFoundException("Unable to find git.exe on your system PATH.");
    }

    // gitArguments contains the command to run (e.g. "clone -- git@repo:projectName c:\repositories\repo_a8c0dd321f")
    var startInfo = new ProcessStartInfo(GitCommand, gitArguments)
    {
        WorkingDirectory = (null != repositoryPath && Directory.Exists(repositoryPath)) ? repositoryPath : String.Empty,
        CreateNoWindow = true,
        UseShellExecute = false,
        RedirectStandardOutput = true,
        RedirectStandardInput = true,
        RedirectStandardError = true
    };

    using (var p = new Process
    {
        EnableRaisingEvents = true,
        StartInfo = startInfo
    })
    {
        p.OutputDataReceived += (sender, args) => Log.Debug(args.Data);

        p.ErrorDataReceived += (sender, args) => Log.Debug(args.Data);

        p.Start();

        p.BeginOutputReadLine();
        p.BeginErrorReadLine();

        p.WaitForExit();
    }
} 
```

代码将调用它：

```
// names changed to protect the innocent
string localRepo = @"c:\repositories\repo_a8c0dd321f";
string gitArgs = "clone -- git@repo:projectName c:\repositories\repo_a8c0dd321f";

GitConfiguration.RunGitCommand(localRepo, gitArgs); 
```

在 MVC API 中，我们使用模拟来确保它以具有有效 git 登录名和密钥（无密码）的用户身份运行。上面的命令和我一样可以在命令行中完美运行，也可以在快速单元测试中运行（我知道这实际上是一个集成测试）。

但是，当它实际从 API 调用时，如上所示，它会挂起。查看任务管理器显示 git.exe 正在运行，命令行显示 git.exe 的完整路径，后跟上面的参数。它没有使用任何处理器时间，只有 2604K 的 RAM，但它声称正在运行。同样，有一个 ssh.exe 进程正在运行，也没有使用处理器，并且有 1212K 的 RAM，使用命令行：

```
ssh git@repo "git-upload-pack 'projectName'" 
```

这两个进程都被列为在我的用户名下运行，因此看起来模拟工作正常。

查看 localRepo 目录，它创建了 .git 目录，然后挂起，在那里留下了大约 13K 的 git 文件，但没有我们的代码。认为这是由于我们的回购规模很大，我让它在一夜之间运行。到今天早上还没有动静。

提出了 LINQPad，运行：

```
Process.GetProcessById($gitPID).Dump() 
```

对 SSH 进程也做了同样的事情。线程显示它们处于等待状态，并且 WaitReason 是执行（等待线程调度程序）。我最初认为它正在等待一个密码，因为我的钥匙有一个。我切换到没有密码的工作密钥，结果相同。

```
Git/SSH versions (from latest GitHub for Windows):
    git version
        git version 1.7.11.msysgit.1
    ssh -v
        OpenSSH_4.6p1, OpenSSL 0.9.8e 23 Feb 2007 
```

* * *

我留下的唯一想法是它可能无法与正在运行的 ssh-agent 通信。不过，它正确地模拟了我，所以我不知道为什么它不能在 WebApi 框架中工作，但在“单元”测试和 Git Shell 中工作得很好。在查看了 Github for Windows 安装脚本后，我尝试确保设置了 HOME、PLINK_PROTOCOL、TERM、SSH_AUTH_SOCK 和 SSH_AGENT_PID 环境变量，以确保我没有遗漏任何内容。

我完全不知所措。这是日志文件的片段，之后有一些注释：

```
2012-11-20 13:42:59.5898 Info Initializing repo at path: c:\repositories\repo_a8c0dd321f 
2012-11-20 13:42:59.5898 Debug Working Directory: c:\repositories\repo_a8c0dd321f 
2012-11-20 13:42:59.6053 Debug C:\Users\christian.doggett\AppData\Local\GitHub\PortableGit_8810fd5c2c79c73adcc73fd0825f3b32fdb816e7\bin\git.exe status --branch 
2012-11-20 13:42:59.6209 Debug HOME=H:\ 
2012-11-20 13:42:59.6209 Debug PLINK_PROTOCOL=ssh 
2012-11-20 13:42:59.6365 Debug TERM=msys 
2012-11-20 13:42:59.6365 Debug SSH_AGENT_PID=58416 
2012-11-20 13:42:59.6365 Debug SSH_AUTH_SOCK=/tmp/ssh-IgTHj19056/agent.19056 
2012-11-20 13:42:59.6521 Info git status --branch
Exit code: 128

2012-11-20 13:42:59.6521 Error  
2012-11-20 13:42:59.6677 Info Cloning repo from origin: git@repo:projectName 
2012-11-20 13:43:01.8674 Debug Cloning into 'c:\repositories\repo_a8c0dd321f'... 
2012-11-20 13:43:03.2090 Debug Could not create directory 'h/.ssh'. 
2012-11-20 13:43:03.2870 Debug Warning: Permanently added 'repo,359.33.9.234' (RSA) to the list of known hosts. 
2012-11-20 13:44:41.4593 Debug fatal: The remote end hung up unexpectedly 
```

我**总是**收到“无法创建目录 'h/.ssh'”和“警告：永久添加 * 到已知主机列表”。消息，甚至在命令行上。我的 H:.ssh\known_hosts 仍然是空的，但是我的密钥在那个目录中，并且 git 发现那些就好了。“远程端意外挂断”错误是在我杀死 git 和 ssh 进程时出现的。

我可能最终会切换到 LibGit2Sharp 来满足我的大部分需求，但这仍然不能解决我的克隆问题。我的密钥设置是否搞砸了，这又在 w3wp.exe 进程之外完美运行？它是否需要能够与 ssh-agent.exe 通信，而不能？有没有人通过 System.Diagnostics.Process 克隆了一个远程 git 存储库并活着讲述这个故事？

**更新（2012 年 11 月 25 日下午 6:54）：**

mvp 指出模拟和映射网络驱动器不能很好地配合使用是正确的。在开始该过程之前，我添加了以下内容：

```
var userProfile = Environment.GetFolderPath(Environment.SpecialFolder.UserProfile);
Environment.SetEnvironmentVariable("HOME", userProfile); 
```

我再次运行它，现在至少在任务管理器中看到了一个新的 git 进程，它占用了 0 个处理器时间，但正在使用越来越多的内存，我相信这是克隆进程的一部分。命令行是：

```
git index-pack --stdin --fix-thin "--keep=fetch-pack 6024 on MACHINENAME" 
```

它终于在 10 分钟后完成（这是一个巨大的存储库），并抛出了异常：

```
fatal: git checkout: updating paths is incompatible with switching branches.
Did you intend to checkout 'origin/8b243b8d9a5140673fc552ef7da8f0dfe9039d50' which can not be resolved as commit? 
```

不过，看起来克隆在更改到目录后工作了！另一个问题与克隆操作完成后立即调用 checkout 有关，但与挂起问题无关。

我只需要在生产服务器上验证我/mvp 的解决方案，然后我就会奖励赏金。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T09:02:16.090

我相信您的主要问题是模拟帐户的主目录不是您认为的那样，主要是因为模拟帐户的网络映射驱动器[实际上不起作用](http://social.msdn.microsoft.com/Forums/is/clr/thread/53034173-7fc0-4e71-a1e4-5efcb7a3e33d)。

作为一种解决方法，您应该为模拟用户设置 HOME 环境变量以指向某个本地目录（比如在 drive 上`C:`），该目录应该包含您的 ssh 密钥（没有密码）。您应该通过`git clone`手动运行来测试它（同时使用假 HOME）并接受 known_host 键，因此它不会阻止后台 git 命令自动工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:14:58.150

主页是 h:\ 有点宽泛，但除此之外，我想说你的下一步是创建一个具有正确权限的 .ssh 目录 (h:.ssh)，应该只对 Web 用户读取，并且不能访问对于任何其他用户。

# python - Python - 如何检查子列表中的值

> ID：13482148
> 
> 赞同：0
> 
> 时间：2012-11-20T21:07:01.160
> 
> 标签：python, list, for-loop, iterator

我正在尝试将子列表附加到相同类型子列表的更大列表中。

子列表：

```
[x-value,y-value, i, 100] 
```

但是，我希望我的代码在添加之前检查是否已经有一个具有相同 x 值和 y 值的子列表，所以在这种情况下，我没有重叠的树（不要问） .

这就是我构建列表的方式：

```
food = []
 for i in range(amount): 
        food.append([
            randint(100, 700), #X
            randint(100, 700), #Y
            i, #identifier
            100]) #energy 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:14:54.200

如果您试图确保`(x, y)`值的唯一性并且您有数据与它们相关联，那么这是字典的完美用例：

```
food = {}
for i in range(amount):
    coords = randint(100, 700), randint(100, 700)
    if coords not in food:
        food[coords] = [
            i,   #identifier
            100, # energy
        ] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:11:56.857

```
food = []
for i in range(amount):
    x,y = randint(100, 700),randint(100, 700)
    value = [x,y,i,100]
    if  all([True if x[0]!=x and x[1]!=y else False for x in food]): #check for duplicated x,y
        food.append(value) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:23:28.257

除了使用“in”或按字典顺序对它们进行排序的字典可能是更好的方法。然后使用 2D 二进制搜索来查找您要查找的内容。

尽管这可能仅在您期望有很多重复项时才有用，否则简单的线性搜索就足够了。

注意：最初建议按距离排序，经过反思，这种排序在这种情况下并不是很有帮助。

# ant - 如何使用 Ant replaceregexp 删除一行，但不留下空行

> ID：13482151
> 
> 赞同：5
> 
> 时间：2012-11-20T21:07:04.367
> 
> 标签：ant

我有以下文本文件：

```
    清单版本：3.0.0
    Ant 版本：Apache Ant 1.7.1
    创建者：10.0-b19（Sun Microsystems Inc.）
    要求捆绑：org.eclipse.linuxtools.cdt.libhover;bundle-version="1.
     1.0"
    Bundle-SymbolicName：com.qnx.doc.gestures.lib_ref
    捆绑版本：3.0.0.20121120
    捆绑本地化：插件
    捆绑包名称：%plugin.name
    捆绑供应商：%plugin.providername

```

我正在尝试在 replaceregexp 任务中使用以下模式

```
    regexp pattern='Require-Bundle: org.eclipse.linuxtools.cdt.libhover;bundle-version="1.
   [\s\S]*'

```

结束这个：

```
    清单版本：3.0.0
    Ant 版本：Apache Ant 1.7.1
    创建者：10.0-b19（Sun Microsystems Inc.）
     1.0"
    Bundle-SymbolicName：com.qnx.doc.gestures.lib_ref
    捆绑版本：3.0.0.20121120
    捆绑本地化：插件
    捆绑包名称：%plugin.name
    捆绑供应商：%plugin.providername

```

问题是我不断得到这个：

```
    清单版本：3.0.0
    Ant 版本：Apache Ant 1.7.1
    创建者：10.0-b19（Sun Microsystems Inc.）

     1.0"
    Bundle-SymbolicName：com.qnx.doc.gestures.lib_ref
    捆绑版本：3.0.0.20121120
    捆绑本地化：插件
    捆绑包名称：%plugin.name
    捆绑供应商：%plugin.providername

```

我的正则表达式应该是什么来摆脱空行？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:12:48.583

像这样的东西应该工作：

```
Require-Bundle: org\.eclipse\.linuxtools\.cdt\.libhover;bundle-version="1\.\s*1.0"\s* 
```

（`\s*`用于匹配零个或多个空格字符，包括`\r`and `\n`）但是由于您正在处理清单文件，因此使用适当的清单解析器会更有意义。不幸的是，Ant`<manifest>`任务没有提供删除属性的方法，但它对`<script>`任务来说非常简单：

```
<property name="manifest.file" location="path/to/manifest.txt" />

<script language="javascript"><![CDATA[
    importPackage(java.io);
    importPackage(java.util.jar);

    // read the manifest
    manifestFile = new File(project.getProperty('manifest.file'));
    manifest = new Manifest();
    is = new FileInputStream(manifestFile);
    manifest.read(is);
    is.close();

    // remove the offending attribute
    manifest.getMainAttributes().remove(new Attributes.Name('Require-Bundle'));

    // write back to the original file
    os = new FileOutputStream(manifestFile);
    manifest.write(os);
    os.close();
]]></script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:27:05.273

```
<replaceregexp file="manifest.mf" match='Require-Bundle: org.eclipse.linuxtools.cdt.libhover;bundle-version=\"[^\"]+\"[\r\n]*' replace="" flags="m"/> 
```

这对我有用。

# security - Magento 结帐期间的安全/不安全项目

> ID：13482153
> 
> 赞同：1
> 
> 时间：2012-11-20T21:07:13.377
> 
> 标签：security, magento, https

Magento 1.6

我正在寻找正确的方法，将图像放在模板上，在安全会话期间是安全的，在不安全的会话期间是不安全的。我在这里和网上搜索过，我找到的唯一解决方案是使用这个调用：

echo $this->getSkinUrl('images/imagename.jpg', array('_secure'=>true));

但是，这总是在 https 中加载图像，即使您不在 https 环境中。

必须有一种动态的方式来设置它。

非常感谢任何可用的帮助/见解。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:38:41.657

你试过了吗 ：

```
array('_forced_secure'=>true) 
```

查看 ：

> 核心/法师/核心/模型/Url.php

# search - ElasticSearch：如何将术语查询与通配符混合

> ID：13482156
> 
> 赞同：0
> 
> 时间：2012-11-20T21:07:16.627
> 
> 标签：search, lucene, wildcard, elasticsearch

比如说，我有以下查询：“文档电子表格应用程序*”。我想构建相当于这种类型的查询'_search?q=_all:document+spreadsheet+app*'的查询字典。比如说，query_words_list = ['document', 'spreadsheet', 'app']。我试过这个：

```
{
  'query': {
     'terms': {
        '_all': query_words_list[:-1] + [query_words_list[-1] + '*'],
     }
   }
} 
```

但是，如果您比较两个查询的结果，它们是不等价的。任何提示相当于 '_search?q=_all:document+spreadsheet+app*' 的查询字典看起来像什么？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:25:34.590

该`q` [参数](http://www.elasticsearch.org/guide/reference/api/search/uri-request.html)等效于[Query String Query](http://www.elasticsearch.org/guide/reference/query-dsl/query-string-query.html)。

# css - 为什么我不能从 Chrome 的用户样式表 Custom.css 中 @import？

> ID：13482157
> 
> 赞同：0
> 
> 时间：2012-11-20T21:07:18.187
> 
> 标签：css, google-chrome, customization

我希望从 Chrome 的自定义样式表中导入其他 css 文件，`C:\Users\*\AppData\Local\Google\Chrome\User Data\Default\User StyleSheets\Custom.css`但它似乎不起作用。我在与上面相同的目录中有 a`stylish.1misc.css`和 a 。`stylish.2img.css`还有符号链接我已经在我的本地服务器上设置了它们，`http://localhost/.my/stylish.2img.css`但是@import 规则似乎都没有工作

```
@import "stylish.1misc.css";
@import url("stylish.1misc.css");
@import url("http://localhost/.my/stylish.2img.css");
@import url("file:///D:/.localhost/.my/stylish.1misc.css"); 
```

为什么不导入？

[有关的](https://stackoverflow.com/questions/13429928/chrome-applies-userstyles-custom-css-on-the-fly-even-when-edited-in-external-e)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T08:32:01.660

尽管我在 Chrome 上也遇到了同样的问题，但是关于在除 IE 之外的每个浏览器的情况下包含本地样式表的声明缺乏优点。Opera、Firefox 和 Safari 都允许包含本地样式表。Safari 和 Opera 甚至允许用户使用位于其硬盘上任何位置的样式表。由于指示 Web 浏览器使用本地样式表的过程需要本地用户的参与，因此违反安全性的机会仍然很小甚至几乎不存在。

由于 CSS 文件必须符合严格的规则，因此这可能为用户提供了另一个理由，使用户可以从硬盘上的任何目录中选择本地 CSS 文件，因为浏览器只是停止解析文件以防它不符合预定义规则和标准。

# c# - 如何在 C# 中向上或向下舍入？

> ID：13482159
> 
> 赞同：26
> 
> 时间：2012-11-20T21:07:19.063
> 
> 标签：c#, math

我尝试过使用 Math.Round 和 MidpointRounding。这似乎没有做我需要的。

例子：

```
52.34567 rounded to 2 decimals UP   = 52.35  
 1.183   rounded to 2 decimals DOWN =  1.18 
```

我需要编写自定义函数吗？

编辑：

我应该更具体。

有时我需要一个像 23.567 这样的数字来向下舍入到 23.56。在这种情况下...

```
Math.Round(dec, 2, MidpointRounding.AwayFromZero) gives 23.57
Math.Round(dec, 2, MidpointRounding.ToEven) gives 23.57 
```

最多可以输出小数点后 9 位的小数，需要四舍五入到小数点后 1、2、3 甚至 4 位。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-11-20T21:10:23.000

尝试使用 decimal.Round()：

```
decimal.Round(x, 2) 
```

您的值在哪里`x`，2 是您希望保留的小数位数。

您还可以通过传递第三个参数来指定 .5 是向上还是向下舍入：

```
decimal.Round(x, 2, MidpointRounding.AwayFromZero); 
```

编辑：

根据新要求（即，尽管数字大于下一个间隔的“一半”，但有时会向下舍入），您可以尝试：

```
var pow = Math.Pow(10, numDigits);
var truncated = Math.Truncate(x*pow) / pow; 
```

Truncate() 去掉小数的非整数部分。请注意，`numDigits`上面应该是您要保留的位数，而不是小数的总数等。

最后，如果您想强制向上舍入（截断实际上是强制向下舍入），您只需在`Truncate()`调用结果上加 1，然后再除。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-11-20T21:29:08.707

尝试使用`Math.Ceiling`（上）或`Math.Floor`（下）。例如`Math.Floor(1.8) == 1.`

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-11-20T22:06:11.570

假设您使用`decimal`数字的类型，

```
static class Rounding
{
    public static decimal RoundUp(decimal number, int places)
    {
        decimal factor = RoundFactor(places);
        number *= factor;
        number = Math.Ceiling(number);
        number /= factor;
        return number;
    }

    public static decimal RoundDown(decimal number, int places)
    {
        decimal factor = RoundFactor(places);
        number *= factor;
        number = Math.Floor(number);
        number /= factor;
        return number;
    }

    internal static decimal RoundFactor(int places)
    {
        decimal factor = 1m;

        if (places < 0)
        {
            places = -places;
            for (int i = 0; i < places; i++)
                factor /= 10m;
        }

        else
        {
            for (int i = 0; i < places; i++)
                factor *= 10m;
        }

        return factor;
    }
} 
```

例子：

```
Rounding.RoundDown(23.567, 2) prints 23.56 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-11-20T23:00:29.850

对于已接受答案的较短版本，以下是可以使用的`RoundUp`和函数：`RoundDown`

```
public double RoundDown(double number, int decimalPlaces)
{
    return Math.Floor(number * Math.Pow(10, decimalPlaces)) / Math.Pow(10, decimalPlaces);
}

public double RoundUp(double number, int decimalPlaces)
{
    return Math.Ceiling(number * Math.Pow(10, decimalPlaces)) / Math.Pow(10, decimalPlaces);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-21T12:29:15.013

带有结果的完整代码。

```
 double a = Math.Round(128.5, 0, MidpointRounding.AwayFromZero); 
```

**结果是**129

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-04-23T03:06:08.733

该类`Math`为您提供了用于向上和向下舍入的方法，它们分别是`Math.Ceiling()`和`Math.Floor()`。它们的工作方式类似`Math.Round()`，但它们有一个特殊性，它们只接收一个值并将它们四舍五入到整个部分。

因此，您需要`Math.Pow()`将该值乘以 10 到您需要四舍五入的 n 小单位，然后您需要除以相同的乘积值。

请务必注意，该`Math.Pow()`方法的输入参数是`double`，因此您需要将它们转换为`double`.

例如：

> 当您要将值四舍五入为小数点后 3 位时（假设值类型为`decimal`）：
> 
> ```
> double decimalsNumber = 3;
> decimal valueToRound = 1.1835675M;
> // powerOfTen must be equal to 10^3 or 1000.
> double powerOfTen = Math.Pow(10, decimalsNumber);
> // rounded must be equal to Math.Ceiling(1.1835675 * 1000) / 1000
> decimal rounded = Math.Ceiling(valueToRound * (decimal)powerOfTen) / (decimal)powerOfTen;
> 
> Result: rounded = 1.184 
> ```
> 
> 当您要将值向下舍入到小数点后 3 位时（假设值类型为`decimal`）：
> 
> ```
> double decimalsNumber = 3;
> decimal valueToRound = 1.1835675M;
> // powerOfTen must be equal to 10^3 or 1000.
> double powerOfTen = Math.Pow(10, decimalsNumber);
> // rounded must be equal to Math.Floor(1.1835675 * 1000) / 1000
> decimal rounded = Math.Floor(valueToRound * (decimal)powerOfTen) / (decimal)powerOfTen;
> 
> Result: rounded = 1.183 
> ```

To reference how to use them more specificaly and to get more information and about both methods you can see these pages from the oficial MSDN Microsoft site:

[Math Class](https://msdn.microsoft.com/en-us/library/system.math(v=vs.110).aspx)

[Math.Pow Method (Double, Double)](https://msdn.microsoft.com/en-us/library/system.math.pow(v=vs.110).aspx)

[Math.Floor Method (Decimal)](https://msdn.microsoft.com/en-us/library/k7ycc7xh(v=vs.110).aspx)

[Math.Floor Method (Double)](https://msdn.microsoft.com/en-us/library/e0b5f0xb(v=vs.110).aspx)

[Math.Ceiling Method (Decimal)](https://msdn.microsoft.com/en-us/library/1cz5da1c(v=vs.110).aspx)

[Math.Ceiling Method (Double)](https://msdn.microsoft.com/en-us/library/zx4t0t48(v=vs.110).aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-07-21T13:58:28.183

也许这个？

```
Math.Round(dec + 0.5m, MidpointRounding.AwayFromZero); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-04-20T04:36:58.787

试试这个自定义舍入

```
public int Round(double value)
{
    double decimalpoints = Math.Abs(value - Math.Floor(value));
    if (decimalpoints > 0.5)
        return (int)Math.Round(value);
    else
        return (int)Math.Floor(value);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-10-22T07:21:18.997

You can achieve that by using the Method of Math.Round() or decimal.Round()-:

```
Math.Round(amt)
Math.Round(amt, Int32) and other overloading methods.

decimal.Round(amt)
decimal.Round(amt, 2) and other overloding methods. 
```

# c++ - 如何在 3D 环境中沿 C++ 中面向的方向移动对象

> ID：13482160
> 
> 赞同：1
> 
> 时间：2012-11-20T21:07:31.143
> 
> 标签：c++, opengl, graphics, 3d

我试图在 C++ 中的 opengl 中移动金字塔，并试图让它朝着它所面临的方向前进。但是，我似乎无法弄清楚如何做到这一点。这是我绘制金字塔的代码：

```
void drawTriangle()
{
    //back
    glBegin(GL_POLYGON);
        glColor3f(1,0,0);
        glVertex3f(-1,-1,-1);
        glVertex3f(1,-1,-1);
        glVertex3f(0,1,0);
    glEnd();

    //front
    glBegin(GL_POLYGON);
        glColor3f(0,1,0);
        glVertex3f(-1,-1,1);
        glVertex3f(1,-1,1);
        glVertex3f(0,1,0);
    glEnd();

    //right
    glBegin(GL_POLYGON);
        glColor3f(0,0,1);
        glVertex3f(1,-1,-1);
        glVertex3f(1,-1,1);
        glVertex3f(0,1,0);
    glEnd();

    //left
    glBegin(GL_POLYGON);
        glColor3f(1,1,0);
        glVertex3f(-1,-1,-1);
        glVertex3f(-1,-1,1);
        glVertex3f(0,1,0);
    glEnd();

    //bottom
    glBegin(GL_POLYGON);
        glColor3f(1,0,1);
        glVertex3f(-1,-1,-1);
        glVertex3f(1,-1,-1);
        glVertex3f(1,-1,1);
        glVertex3f(-1,-1,1);
    glEnd();
} 
```

这是金字塔被绘制到屏幕上的方式：

```
glPushMatrix();
    glTranslatef(Xtri,0,Ztri);
    glRotatef(heading,0,1,0);
    drawTriangle();
    glPopMatrix();

    glFlush(); 
```

以下是如何更新变量以便金字塔可以移动：

```
void processKeys()
{
    if(keys[VK_LEFT])
    {
        heading-=1.0f;
    }
    if(keys[VK_RIGHT])
    {
        heading+=1.0f;
    }
    if(keys[VK_UP])
    {
        Vtri-=0.001f;
    }
    if(keys[VK_DOWN])
    {
        Vtri+=0.001f;
    }
}
void update()
{
    Xtri += Vtri*cos((90+heading)*(PI/180.0f));
    Ztri += Vtri*sin((90+heading)*(PI/180.0f));
} 
```

我试图让金字塔向前移动，以便红色或背面是我想要成为金字塔移动方向的面，但是当我使用此代码时，它根本不起作用，它会移动以一种非常有趣的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T04:06:41.500

这是您可以做到的一种方法。它基于 Direct3D，但我认为它应该与 OpenGL 非常相似。

金字塔有两个向量：一个包含它的位置，另一个包含它的旋转。最初两者都初始化为 0,0,0。还有一个方向向量最初面向对象的方向（例如 1,0,0）和速度，再次设置为 0。

按下 a 或 d 后，将旋转矢量的 y 元素调整到所需的角度。同样，按下 w 或 s 可调整对象的速度。您可能需要考虑帧渲染时间以使运动 fps 独立。

然后像你一样创建一个围绕 Y 轴的旋转矩阵。使用该矩阵通过将其与初始位置向量相乘来创建新的归一化向量。然后将此向量乘以速度添加到您的位置坐标，并将这些坐标用于平移矩阵。

希望这是有道理的。这是一些伪代码：

```
// in constructor:
x = y = z = 0.0f;   // position
ry = 0.0f;          // rotation
speed = 0.0f;
initVec(1,0,0);     // initial direction vector

// in event handler:
// upon key press adjust speed and/or ry

// in move():
// create rotation matrix around Y axis by ry = rotationMatrix

// use it to find new direction vector
newDirectionVector = initVec * rotationMatrix;

// adjust your position
x += newDirectionVector * speed;
y += newDirectionVector * speed;
z += newDirectionVector * speed;

glTranslatef(x, y, z);

// render 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-18T12:43:07.043

我在寻找类似问题的想法时遇到了这个问题，并决定分享我的解决方案：

对于一个底边为 1 个单位，高度为 2 个单位的三角形，y = 0.3 = pos[2]

```
void triangle::draw() {
    glPushMatrix();
    //pos[0] is the x value initialized to 0
    //pos[2] is the z value initialized to 0
    glTranslatef(pos[0], 0, pos[2]);
    glRotatef(direction, 0, 1, 0);
    glBegin(GL_TRIANGLES);
    glVertex3f(.5, pos[1], 0);
    glVertex3f(-.5, pos[1], 0);
    glVertex3f(0, pos[1], 2);
    glEnd();
    glPopMatrix();
}

//called when key w is pressed
void triangle::forward() {
    // convert degrees to rads and multiply (I used 0.5)
    pos[0] += sin(M_PI * direction / 180) * .5;
    pos[2] += cos(M_PI * direction / 180) * .5;
    std::cout << pos[0] << "," << pos[2] << std::endl;
}

//called when key s is pressed
void triangle::back() {
    pos[0] -= sin(M_PI * direction / 180) * .5;
    pos[2] -= cos(M_PI * direction / 180) * .5;
    std::cout << pos[0] << "," << pos[2] << std::endl;
}

//called when key d is pressed
void triangle::right() {
    direction -= 5;
    //direction is the angle (int)
    //this is probably not needed but, if you keep turning in the same direction
    //an overflow is not going to happen
    if (direction <= 360)direction %= 360;
    std::cout << direction << std::endl;
}

//called when key a is pressed
void triangle::left() {
    direction += 5;
    if (direction >= -360)direction %= 360;
    std::cout << direction << std::endl;
} 
```

希望我对遇到类似问题的人有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:14:34.800

你需要在翻译之前进行旋转，假设你的对象是在原点开始的（如果我没记错的话）。我相信应用的旋转矩阵围绕轴 (0, 1, 0) 旋转，如果您已经平移到新位置，该旋转将影响您的位置以及您所面对的方向。

# django - 如何在虚拟环境中安装 neo4django

> ID：13482163
> 
> 赞同：1
> 
> 时间：2012-11-20T21:07:49.117
> 
> 标签：django, neo4j, neo4django

尝试在我的虚拟环境中安装 neo4django 时收到以下错误。不确定是什么问题。服务器在我的机器上运行，py2neo 可以使用 restful api，但不能使用 neo4django。

我正在运行 ubuntu 12.0.4，安装了最新版本的 neo4j (1.9-M01)，安装了 jdk 1.7 (openjkd)，JAVA_HOME 指向：/usr/lib/jvm/java-7-openjdk-amd64

> 回溯（最后一次调用）：文件“manage.py”，第 10 行，在 execute_from_command_line(sys.argv) 文件“/home/alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/ django/core/management/ **init** .py”，第 443 行，在 execute_from_command_line utility.execute() 文件“/home/alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/django/core/ management/ **init** .py”，第 382 行，在执行 self.fetch_command(subcommand).run_from_argv(self.argv) 文件“/home/alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/ django/core/management/base.py"，第 196 行，在 run_from_argv self.execute(*args, ** **options.dict**) 文件“/home/alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/django/core/management/base.py”，第 232 行，执行输出 = self.handle(*args , **options) 文件“/home/alan/workspace/neowiki/neowiki/nodes/management/commands/testcmd.py”，第 10 行，在句柄 pete = Person.objects.create(name='Pete') 文件中“ /home/alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/neo4django/db/models/manager.py”，第 41 行，在 create return self.get_query_set().create(* *kwargs ）文件“/home/alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/neo4django/db/models/query.py”，第 747 行，在创建返回 super（NodeQuerySet，self）。创造（**kwargs) 创建 obj.save(force_insert=是的，使用 = self.db）文件“/home/alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/neo4django/db/models/base.py”，第 325 行，保存返回super(NodeModel, self).save(using=using, **kwargs) 文件“/home/alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/django/db/models/base. py"，第 463 行，保存 self.save_base(using=using, force_insert=force_insert, force_update=force_update) 文件“/home/alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/neo4django /db/models/base.py"，第 340 行，在 save_base self._save_neo4j_node(using) 文件中""，第 2 行，在 _save_neo4j_node 文件中"/home/alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/neo4django/db/models/base.py”，第 115 行，在 trans_method 中 ret = func(*args, **kw)文件“/home/alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/neo4django/db/models/base.py”，第 370 行，在 _save_neo4j_node typesToIndex=type_names_to_index）文件“/home/ alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/neo4django/neo4jclient.py”，第 179 行，在 gremlin_tx 中返回 self.gremlin(script, tx=True, **params) 文件“/ home/alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/neo4django/neo4jclient.py”，第 168 行，在 gremlin 参数中）文件“/home/alan/workspace/neowiki/venv/local /lib/python2.7/site-packages/neo4django/neo4jclient.py”，第 153 行，在 send_script script_rv = ext.execute_script(s, params=params, **execute_kwargs) 文件“/home/alan/workspace/neowiki/venv/local/lib/python2.7/site-packages/neo4jrestclient/client.py”，第 1960 行，在**调用** raise StatusException(response.status, msg) neo4jrestclient.request.StatusException: Error [400]: Bad Request。错误的请求语法或不受支持的方法。发送的数据无效：org.codehaus.groovy.control.MultipleCompilationErrorsException：启动失败：Script4.groovy：94：无法解析类 org.neo4j.cypher.javacompat.CypherParser @ 第 94 行，第 1 列。
> 导入 org.neo4j.cypher。 javacompat.CypherParser ^
> 
> 1 个错误

我的 requirements.txt 包括：

-e git://github.com/scholrly/neo4django.git@eefdf6a122fdbe26c62b6563f9ff6b30a4de2f93#egg=neo4django-dev

neo4jrestclient==1.7.0

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T22:01:08.463

据我所知，您的安装很好。问题是 Neo4j 的版本。

到目前为止，我们只支持 Neo4j 1.6-1.8。虽然我尝试支持所有正在使用的主要版本，但我通常会将对里程碑的支持扩展为更接近一般版本。例如，直到 Neo4j 1.8 达到里程碑 6，我才将支持扩展到它。

您使用 1.9M01 是否有特殊原因，或者最新的稳定版本 (1.8GA) 是否足够？

# java - 从另一个类调用非静态 void

> ID：13482164
> 
> 赞同：0
> 
> 时间：2012-11-20T21:07:54.520
> 
> 标签：java, android, boolean, static-methods

我试图结束一个永无止境的循环。我需要从另一个类中调用一个非静态的 void。我不让它静态的原因是有些东西很难静态化。（静态空隙内的所有东西都必须是静态的）。

我被困在一个圈子里，我需要从另一个类中调用一个非静态 void。我不能让它成为静态的，因为它有些代码不喜欢被传递。

直到现在我通过一个处理程序解决了它：

```
public static void change(){
//This is called to change a boolean
start=true;}

private void startDone(){
int timeBetweenChecks = 50;
final Handler h = new Handler();
h.postDelayed(new Runnable(){
    public void run(){
        if (start==false){
           startDone();

        } else{  
            //Do something          
        }          
        }
    }
}, timeBetweenChecks); 
```

};

问题是我必须运行一个处理程序来检查是否经常发生变化（在我的情况下）。

有什么方法可以直接调用非静态 startDone() 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T21:20:29.900

*如果您问是否有一种方法可以在不*实例化该类的对象的情况下调用类的非静态方法，那么没有。

如果我不养狗，我不能让我的狗坐下。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T21:25:13.060

您的问题的答案是：不，如果没有包含非静态方法的类的实例，您不能从静态方法调用非静态方法。

解决您的问题：也许最好的方法是从 change() 广播意图。

就像是：

```
public static void change(Context c){
    start=true;
    c.sendBroadcast(new Intent("CHANGE_HAS_BEEN_CALLED"));
} 
```

然后在您的活动的非静态代码中，您可以像这样注册一个接收器：

```
IntentFilter filter = new IntentFilter();
filter.addAction("CHANGE_HAS_BEEN_CALLED");
registerReceiver(new BroadcastReceiver() {
    @Override public void onReceive(Context context, Intent intent) {
       if (start==false){
           startDone();

        } else{  
            //Do something          
        }
    }
}, filter); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T13:08:47.790

[这个](https://stackoverflow.com/questions/12797355/how-to-call-non-static-method-from-static-method-in-android)问题的公认答案是比已经建议的解决方案更好的解决方案。希望这会帮助任何人在谷歌上搜索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T21:21:01.603

根据定义，如果 startDone() 是非静态的，那么调用它是没有意义的，除非你已经实例化了包含它的类。非静态方法是实例方法，这意味着它可以为其封闭类型的每个对象返回不同的结果。

我认为你想要的是一个只包含 startDone() 的类。您希望为整个应用程序实例化一次该类，然后能够调用 startDone()。

假设该类称为ItsDone。将其实例化为单例，然后在执行“新建”时返回单例，并调用 startDone()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T21:22:43.393

> 一个处理程序，它正在检查某些东西是否经常发生变化（在我的例子中）。

听起来像是[给](http://en.wikipedia.org/wiki/Callback_%28computer_programming%29)我打电话。您将一段代码传递给那个“某物”，并且只要“某物”的状态发生变化，这段代码就会被“某物”执行。如果你可以控制这个“某物”，那么实现这种行为就很容易，如果你没有（如果“某物”是某个库的一部分），它可能已经实现了这种行为（当然，如果它很好的话-设计）。

无论如何，通过每隔 50 毫秒查询一次来检查状态“某事”并不是要走的路。

# sql - 基于案例陈述中系统日期的日期范围

> ID：13482173
> 
> 赞同：1
> 
> 时间：2012-11-20T21:08:39.327
> 
> 标签：sql, oracle11g

我正在尝试编写一个案例语句，它将根据当前系统日期过滤一系列日期。我需要从 30 天前到当前、30-60 天前和 60-120 天前的范围，所有这些都基于系统日期。这是我所没有的，但事实证明是不成功的：

```
(case 
 when a.last_active_date between sysdate and sysdate-30 then 'Inactive 30 Days or Less'
 when a.last_active_date between sysdate-30 and sysdate-60 then 'Inactive 30-60' 
 when a.last_active_date between sysdate-60 and  sysdate - 120 then 'Inactive 60-120' 
 else 'Inactive 120+ Days'
 end) Inactivity, 
```

关于我应该如何处理这个问题的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:15:29.173

这是 PL-SQL 中的一个解决方案：[DB Fiddle Example](https://dbfiddle.uk/?rdbms=oracle_11.2&fiddle=803d5cbfdc4e7dd3fc30648af2948fb5)

```
-- select based on runtime calculation
select a.last_active_date
,   case 
        when (sysdate - a.last_active_date) <= 30 then 'Inactive 30 Days or Less'
        when (sysdate - a.last_active_date) <= 60 then 'Inactive 30-60' 
        when (sysdate - a.last_active_date) <= 120 then 'Inactive 60-120' 
        else 'Inactive 120+ Days'
 end Inactivity
from demo a
order by a.last_active_date desc 
```

这是 T-SQL 中的答案：[DB Fiddle Example](https://dbfiddle.uk/?rdbms=sqlserver_2017&fiddle=6d3a6129a823958dca4d336471018c47)

```
select a.last_active_date
,   case 
        when getutcdate() - a.last_active_date <= 30 then 'Inactive 30 Days or Less'
        when getutcdate() - a.last_active_date <= 60 then 'Inactive 30-60' 
        when getutcdate() - a.last_active_date <= 120 then 'Inactive 60-120' 
        else 'Inactive 120+ Days'
 end Inactivity
from @t a
order by a.last_active_date desc 
```

这是使用测试数据设置上述示例的代码：

```
declare @t table (last_active_date datetime)

insert @t select getutcdate()
union select getutcdate()-29
union select getutcdate()-30
union select getutcdate()-31
union select getutcdate()-59
union select getutcdate()-60
union select getutcdate()-61
union select getutcdate()-119
union select getutcdate()-120
union select getutcdate()-121 
```

这样做的好处是`getutcdate() - a.last_active_date`函数的重用应该允许缓存结果，因此应该节省一些计算开销。

# jquery - 将 CSS 用于随页面增长和缩小的文本和图像

> ID：13482180
> 
> 赞同：0
> 
> 时间：2012-11-20T21:09:14.417
> 
> 标签：jquery, html, css

理想情况下，文本和图像（底部的按钮除外）会随着页面大小的调整而增长/缩小并保持对齐，但随后会在其原始大小的某个百分比处停止缩小。说30%。我愿意使用 CSS 或 jQuery 或两者兼而有之。

最好/最干净的方法是什么？

请参阅我的代码：http: [//jsfiddle.net/ZZCMV/](http://jsfiddle.net/ZZCMV/)

或者：

HTML：

```
<html><head></head><body id="page_welcome">
<div class="wrapper">    
<div class="main">
    <div class="logo"><img src="https://qa.tweetcaster.com/assets/img/home/logo.png"></div>
    <div class="tagline">
        <div>The best thing to happen to Twitter since Twitter</div>
    </div>
    <div class="footer">
        <div class="download">
            <div>Over 10 million users! Get TweetCaster FREE:</div>
        </div>
        <ul class="devices">
            <li><a href="https://play.google.com/store/apps/details?id=com.handmark.tweetcaster&referrer=utm_source%3DTCwebsite%26utm_medium%3Dweb%26utm_campaign%3DTCwebsite" target="_blank"><img src="https://qa.tweetcaster.com/assets/img/home/play_store.png" alt="TweetCaster for Android"></a></li>
            <li><a href="http://itunes.apple.com/us/app/tweetcaster-for-twitter/id420792544?mt=8" target="_blank"><img src="https://qa.tweetcaster.com/assets/img/home/app_store.png" alt="TweetCaster for iPhone and iPad"></a></li>
            <li><a href="/login" id="web"><img src="https://qa.tweetcaster.com/assets/img/home/web.png" alt="TweetCaster web app"></a></li>
            <li>
                <button id="dropdown_button" class="menu_button"><img src="https://qa.tweetcaster.com/assets/img/home/more.png" alt="More" ></button>                    
            </li>
        </ul>
        <div class="links">
            <a href="http://tweetcaster.uservoice.com/forums/183240-tweetcaster-web" class="feedback" target="_blank">Feedback</a> &#169;
            <a href="http://onelouder.com" target="_blank">Onelouder</a> 
            <a href="http://tweetcaster.com/privacy" target="_blank">Privacy</a>
            <a href="http://onelouder.com/#terms" target="_blank">Terms</a> 
            <a href="http://onelouder.com/#about" target="_blank">About</a> 
            <a href="http://support.onelouder.com" target="_blank">Help</a> 
        </div>
    </div>
</div>
<div class="bird"><img src="https://qa.tweetcaster.com/assets/img/home/bird.png" alt="TweetCaster"></div>
</div>
</body>
</html> 
```

CSS：

```
 html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {
    margin: 0;
    padding: 0;
    border: 0;
    vertical-align: baseline;
}
body {
    background: #7bc5ef url(https://qa.tweetcaster.com/assets/img/layout/bg.jpg) center top repeat-x;
    padding-top: 15%;
    font-family: Helvetica, Arial, sans-serif;
}
.main {
    float: left;
    top: 0px;
    margin-left: 0;
    width: 550px;
}
.wrapper {
    text-align: center;
    height: 100%;
    position: relative;
    margin-left: auto;
    margin-right: auto;
    width: 800px;
}
.logo {
    margin: 30px 0px 0px;
}
.tagline {
    font-size: 40px;
    color: #ffffff;
    text-shadow: 0px 2px 2px rgba(0,0,0, 10);
    font-weight: 700;
    width: 510px;
    margin-left: auto;
    margin-right: auto;
}
.footer {
    bottom: 0px;
    width: 550px;
    left: 0px;
    margin-top: 30%;
    padding-bottom: 20px;
}
.download {
    padding-top: 0px;
    text-align: center;
    color: #000000;
    font-size: 22px;
    margin-bottom: 10px;
    font-weight: 700;
}
.links {
    text-align: center;
    font-size: 14px;
}
.links a {
    padding-right: 5px;
    color: #282828;
    text-decoration: none;
}
.links a:hover {
    text-decoration: underline;
}
.feedback {
    font-weight: 700;
    padding-right: 10px;
}
.devices li {
    display: inline-block;
    display: inline; /*ie7 fix */
    padding-right: 7px;
}
.devices {
    margin-left: 15px;
    display: block;
    margin-bottom: 30px;
}
.other_devices {
    display: block;
    margin: 0 0 0 5px;
}
.other_devices li {
    display: inline-block;
    display: inline; /*ie7 fix */
    padding-right: 6px;
}
.bird img {
    float: right;
    max-width: 100%;
    height: auto;
    width: auto\9; /* ie8 */
    float: right;
    bottom: 0;
    position: fixed;
    z-index: -10;
    _position: absolute;
    _top:expression(eval(document.documentElement.scrollTop+ (document.documentElement.clientHeight-this.offsetHeight)));
    height: 80%;
    margin-left: -4%;
    min-height: 400px;
    min-width: 181px;
}
.menu_button {
    background: none;
    border: none;
    margin-left: -7px;
    cursor: pointer;
}
.hidden_menu {
    background-color: white;
    color: #000;
    height: 328px;
    position: absolute;
    display: none;
    margin-top: 0px;
    width: 480px;
    border: 1px solid #999999;
    left: 40px;
    top: 89px;
    box-shadow: 0 2px 9px rgba(0, 0, 0, .75);
}
 .get_tc {
    color: #222222;
    font-size: 20px;
    text-align: center;
    margin-top: 36px;
    margin-bottom: 14px;
}
.dd_arrow {
    position: absolute;
    margin-left: 420px;
    margin-top: 3px;
}
.tc_pink {
    padding-top: 6px;
    margin-bottom: 20px;
}
.get_tc {
    margin-bottom: 10px;
}
.windows_button {
    border-radius: 7px;
}
.clear:before, .clear:after {
    content: ".";
    display: block !important;
    height: 0;
    overflow: hidden;
}
.clear:after {
    clear: both;
}
.clear {
    zoom: 1;
} /* IE < 8 */
p {
    margin-bottom: 18px;
}
p:first-child {
    margin-bottom: 18px;
}
h1 {
    font-size: 20px;
    line-height: 26px;
    font-weight: normal;
}
table, p, h1, h2, h3, h4, caption {
    color: #888;
}
​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:36:02.683

利用 CSS3 媒体查询根据浏览器和/或设备大小调整页面大小。这是一篇很棒的文章，可以帮助您入门：[http ://css-tricks.com/css-media-queries/](http://css-tricks.com/css-media-queries/)

至于图像，如果您设置一个具有页面宽度百分比的容器，您可以将以下内容添加到页面 css 以使其具有响应性并调整为窗口大小。

```
img {
    max-width: 100%;
    height: auto;
} 
```

这将使图像在您的页面上调整大小而无需使用媒体查询，但如果您正在寻找更适合每个浏览器/设备大小的自定义尺寸，您肯定会想要使用媒体查询。

希望这可以帮助！

# mysql - SQL MACH() AGAINST() 关键字长度

> ID：13482183
> 
> 赞同：0
> 
> 时间：2012-11-20T21:09:45.963
> 
> 标签：mysql, sql, keyword, string-length, match-against

为什么

```
SELECT * , MATCH(tags) AGAINST('php' IN BOOLEAN MODE) .. etc 
```

不返回任何内容（而 php 标签存在于多行中）

和

```
SELECT * , MATCH(tags) AGAINST('jquery' IN BOOLEAN MODE) .. etc 
```

返回结果？

是否有关键字搜索字符长度最小限制？“php”关键字是否太短？：/

有没有办法让查询运行通过“php”关键字搜索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:13:38.873

是的，您是对的，默认情况下，关键字有 4 个字符的限制。

它可以从配置文件中更改，选项称为“ft_min_word_len”。

更改长度后不要忘记重新启动 MySQL 服务/守护进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:16:03.413

默认最小长度是 4 所以可能就是这样

# python - 基本的python语法

> ID：13482184
> 
> 赞同：-6
> 
> 时间：2012-11-20T21:09:46.387
> 
> 标签：python, syntax

今天我第一次处理python代码。基本上，没有时间学习 python 教程。我是Java背景。如果你能帮助我使用 python 语法，那就太好了。一段代码：

```
def fromData(headerdata, offset = 0):
        """Return a new Header object from the supplied binary data."""
        (id, flags, qdc, anc, nsc, arc,) = \
              struct.unpack_from(">6H", headerdata, offset)
        qr_ = (flags >> Header.OFFSET_QR) & 0x1 
```

问题：

1.  这是什么

    ```
    (id, flags, qdc, anc, nsc, arc,) = \
          struct.unpack_from(">6H", headerdata, offset) 
    ```

    意思是？它在做什么？

2.  为什么“弧”以“，”结尾？
3.  为什么qr后面跟着“_”
4.  什么是`>6H`。你能重定向我的格式列表吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:17:01.840

AC`struct`可以打包成平面二进制数据，这就是 Python 2 所说的字符串。该`struct`模块允许您获取代表这些 C 结构之一的字符串，并将其“解包”到 Python 数据结构中。

为此，您调用[`struct.unpack`](http://docs.python.org/2/library/struct.html#struct.unpack). 您需要指定格式字符串（如链接文档中所定义），它会返回从数据中解压缩的值的元组。

# matlab - 修复这个数组？它在某处绘制了一堆零

> ID：13482186
> 
> 赞同：1
> 
> 时间：2012-11-20T21:10:02.730
> 
> 标签：matlab

由于某种原因，它在图中绘制了红色区域。我只担心被着色的岛屿。

[http://img528.imageshack.us/img528/506/2bc9e702042a46369c7631b.png](http://img528.imageshack.us/img528/506/2bc9e702042a46369c7631b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:22:50.787

你的分配`dayh99`看起来像这样：

```
dayh99 = zeros(length(fname),610,620); 
```

然后您尝试使用循环中超出该范围的值填充它。

```
dayh99(i,240:850, 130:750) = ... 
```

我认为您想`0`在两个维度的索引处开始填充。这将消除情节中的“红色”区域。

在你的循环中尝试这个来填充`dayh00`：

```
dayh99(i,:,:) = tmp(240:850,130:750); 
```

# vim - Vim复制行号？

> ID：13482187
> 
> 赞同：5
> 
> 时间：2012-11-20T21:10:10.070
> 
> 标签：vim, copy, copy-paste

我正在通过和 SSH 连接使用 vim。我设置了数字设置，所以当我尝试用鼠标复制我的代码部分时......它也会抓取数字。有没有一种好方法可以复制不带数字的文本。（我知道在那个 vim 实例中我可以使用 Y，但我需要一种方法来复制到其他实例和程序）。

这是我正在谈论的一个例子。

```
1 function foo ( home, ip, hash, regex )
2 {
3 return false;
4 } 
```

非常感谢大家的建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T21:17:18.287

切换`'number'`设置`!`

```
:set nu! 
```

运行一次即可关闭`'number'`。再次运行该命令以重新打开设置。

我在我的使用以下映射`~/.vimrc`：

```
nnoremap <leader>tn :set nu! nu?<cr> 
```

它将切换设置，然后回显当前值`'number'`

如需更多帮助，请参阅：

```
:h 'nu'
:h :set-! 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-20T21:11:21.993

```
:set nonumber 
```

复制你想要的

```
:set number 
```

[:帮助号码](http://vimdoc.sourceforge.net/htmldoc/options.html#%27number%27)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-20T21:55:17.600

*   如果您在 Vim 中复制和粘贴，没有正当理由不使用正确的命令：`y`“yank”（复制，参见`:help y`）和`p`“put”（粘贴，参见`:help p`）。

*   如果你在远程 Vim 中复制粘贴到另一个本地应用程序中，你必须：

    ```
    :set nonumber
    do your thing
    :set number 
    ```

    您可能想要验证您是否能够使用“X11 转发”，因为[它支持双向剪贴板共享。](https://defuse.ca/blog/2012/04/clipboard-over-ssh-with-vim/)

*   如果您在本地应用程序中复制以粘贴到远程 Vim，您必须：

    ```
    copy in local app
    go to Vim
    :set paste
    Ctrl+v or Cmd+v
    :set nopaste 
    ```

    参见`:help pastetoggle`方便的映射。

# java - 用空格替换字符串中所有出现的 ... 的最快方法是什么？爪哇

> ID：13482190
> 
> 赞同：0
> 
> 时间：2012-11-20T21:10:12.250
> 
> 标签：java, string, replace, split

我的程序有问题。在我的程序中，瓶颈是替换和拆分字符串。我需要从字符串中获取要选项卡的单词。

例如：

我有字符串：“这是 Ala。Ala 有猫吗？赚钱的猫。”

我需要得到一个字符串选项卡 [] 和结果

```
tab[0]="This"<br>
tab[1]="is"<br>
tab[2]="Ala"    not "Ala."<br>
tab[3]="Does"<br>
....<br>
tab[7]="cat" not "cat?"<br>
tab[8]="Money"   not "Money-making"<br>
tab[9]="making"<br>
tab[10]="cat" not "cat."  <br> 
```

单词不能有“,./;!:?- 等符号。它们只能有英文字母。

其实我是这样做的

```
s = s.replace(",", " ").replace("!", " ")....   ;

String [] tab = s.split("\\s+"); 
```

但是这种方式真的很慢。我怎样才能更快地做到这一点？在 Java 语言中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:15:59.003

您可以拆分一个或多个非单词字符：

```
String[] parts = str.split("\\W+"); 
```

注意：非单词字符表示除`_`、字母和数字之外的任何字符。如果您只想要字母，那么您将不得不接受[@Bailey S](https://stackoverflow.com/a/13482239/738746)的回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:18:15.867

您可以使用 replaceAll。例如 s.replaceAll("[?.,]","")

# php - PHP中JSON数字的正确编码

> ID：13482200
> 
> 赞同：0
> 
> 时间：2012-11-20T21:10:50.683
> 
> 标签：php, json

假设我有这样的 JSON：

```
{
 id: 1,
 somevalue: "text"
} 
```

我想通过 PHP 函数[json_encode](http://php.net/manual/en/function.json-encode.php)创建这个 JSON 。我可以很容易地得到这个 JSON 格式：

```
{
 "id": "1",
 "somevalue": "text"
} 
```

或者，使用`JSON_NUMERIC_CHECK`, 形式，其中“id”将是数字，但“somevalue”可以是数字或文本，具体取决于其内容。

如何使“somevalue”始终为文本格式（带引号）的 JSON。我会用其他语言来解析它，这很重要。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T21:14:42.120

确保将您希望为非字符串的值（如 int 或 boolean）输入到源数组中：

```
<?php
$a = array('id' => 1, 'really' => true, 'somevalue' => 'text');
var_dump( json_decode( json_encode( $a ) ) ); 
```

给出预期：

```
object(stdClass)#1 (2) {
  ["id"]=>
  int(1)
  ["really"]=>
  bool(true)
  ["somevalue"]=>
  string(4) "text"
} 
```

**编辑**

如果您希望它始终是字符串，则首先将字符串放入数组中：

```
<?php
$a = array('id' => '1', 'really' => 'true', 'somevalue' => 'text');
var_dump( json_decode( json_encode( $a ) ) ); 
```

会给

```
object(stdClass)#1 (3) {
  ["id"]=>
  string(1) "1"
  ["really"]=>
  string(4) "true"
  ["somevalue"]=>
  string(4) "text"
} 
```

但这扼杀了拥有不同变量类型的全部目的。

你可以转换你的数组之前的 json 编码：

```
<?php
$a = array('id' => 1, 'really' => true, 'somevalue' => 'text');

$tmp = array();
foreach( $a as $key=>$val ) {
   $tmp[$key] = (string)$val;
}

var_dump( json_decode( json_encode( $tmp ) ) ); 
```

最后会给出：

```
object(stdClass)#1 (3) {
  ["id"]=>
  string(1) "1"
  ["really"]=>
  string(1) "1"
  ["somevalue"]=>
  string(4) "text"
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T21:24:16.843

`somevalue`始终以“文本”格式制作：

```
$somevalue1 = 1;
$somevalue2 = "text";

$json1 = array("id" => 1, "somevalue" => (string) $somevalue1);
$json2 = array("id" => 1, "somevalue" => (string) $somevalue2);

echo json_encode($json1); // outputs {"id":1,"somevalue":"1"}
echo json_encode($json2); // outputs {"id":1,"somevalue":"text"} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T15:33:02.850

在 PHP> 5.3.3 上，您可以使用 json_decode($array, JSON_NUMERIC_CHECK);

如果您没有 PHP 5.3.3 或更高版本，我编写了这个递归函数：

```
function json_encode_with_numbers($array) {
    if(is_array($array)) {
        if(count($array)>0 && array_keys($array) !== range(0, count($array) - 1)) {
            echo '{'; 

            $isFirst = true;
            foreach($array as $key=>$item) {
                if(!$isFirst) {
                    echo ",";
                }
                echo '"'.$key.'":';
                json_encode_with_numbers($item);
                $isFirst = false;
            }
            echo '}';
        } else {
            echo '['; 
            $isFirst = true;
            foreach($array as $item) {
                if(!$isFirst) {
                    echo ",";
                }
                json_encode_with_numbers($item);
                $isFirst = false;
            }
            echo ']';
        }
    } else {
        if(is_numeric($array)) {
            echo $array;
        } elseif ($array == null) {
            echo "null";
        } else {
            echo '"'.str_replace(array('"', '\\'), array('\"', '\\\\'), $array).'"'; // escape special chars
        }

    }

} 
```

# c# - 命名空间/引用错误

> ID：13482202
> 
> 赞同：1
> 
> 时间：2012-11-20T21:10:58.340
> 
> 标签：c#, namespaces

我的解决方案无法编译。当我尝试编译我的项目时收到一条错误消息：

> 错误 2 命名空间“Base”中不存在类型或命名空间名称“Security”（您是否缺少程序集引用？）

然而，这令人困惑，因为我已经引用了该项目，这是正确的命名空间！这是解决方案设置

解决方案基础 - Base.Domain - Base.Security - Base.Tests - Base.WebUI

在 Base.Security 我有一个自定义角色提供程序文件，如下所示：

```
namespace Base.Security.Providers
{
    public class EFRoleProvider : System.Web.Security.RoleProvider
    {
        //code here
    }
} 
```

我在 Base.Tests 和 Base.Tests 中引用了 Base.Security 我有以下文件（这给了我错误）：

```
using Base.Security.Providers;

namespace Base.Tests
{
    class Program
    {
        static void Main(string[] args)
        {
            var a = new EFRoleProvider();
            //more stuffs
        }
    }
} 
```

我不明白.. 为什么我不能从 Base.Tests 访问 Base.Security 类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:15:02.717

确保您的项目是针对相同的 .NET 版本构建的。从 .NET 4.0 项目添加对 .NET 3.5 项目的引用时，我遇到了这个问题。

要检查/更改 .NET 版本，请右键单击您的项目，选择属性，然后在“应用程序”选项卡下确保每个项目的“目标框架”相同。

您的代码看起来正确，这是设置引用方式的问题。

# java - 复数的指数形式

> ID：13482204
> 
> 赞同：5
> 
> 时间：2012-11-20T21:11:11.990
> 
> 标签：java, math

我有以下问题：

我需要扩展以下类 Complex（表示复数）并添加具有指数形式的字段，另外还有来自 Complex 的重载方法：

```
class Complex{
public double re;
public double im;

public Complex(double r, double i){
    re =r;
    im = i;
}

public Complex add(Complex a,Complex b){
    return new Complex(a.re + b.re,a.im + b.im );
}

public Complex sub(Complex a,Complex b){
    return new Complex(a.re - b.re,a.im - b.im);
}

//more code
} 
```

我的课就像以下

```
class ComplexE extends Complex{
   public double exponential;
    public ComplexE(double a, double b){
        re=a;
        im = b;
    }
    public ComplexE(double _exp){
        super(0,0);
        this.exponential = _exp;
    }

   public void setExpFromComplex(Complex comp){
    double module = Math.sqrt(Math.pow(comp.re,2) + Math.pow(comp.im,2));
    double fi = Math.atan2(comp.re,comp.im);
    this.exponential = module * Math.pow(Math.E, fi);
   } 

   public ComplexE add(ComplexE a,ComplexE b){
        return new ComplexE(a.exponential + b.exponential );
    }

} 
```

我的问题是：我做得对吗？我找到指数形式的方法是否正确？

编辑：我尝试使用的数学方法是：

```
z = |z|*(cos(phi) + i*sin(phi)) = |z|*e^(i*phi). 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T21:29:27.457

你有很多错误。首先，我假设指数是指极坐标，即`r*e^(i*theta)`。除了矩形复数和极坐标复数是同构的，也就是说，您可以将一个转换为另一个，然后再转换回来。

这表明您不应该从常规复数继承指数复数......不同之处在于实现，即数字如何存储在内存中。换句话说，您的界面：

```
public interface IComplex {
    public double getReal();
    public double getImag();
    public double getR();
    public double getTheta();
    public IComplex add(IComplex first, IComplex second);
    public IComplex sub(IComplex first, IComplex second);
    // Etc.
} 
```

和矩形实现：

```
public class RectComplex implements IComplex {
    private double realPart; // note privacy... use getters and setters
    private double imagPart;

    public RealComplex (double real, double imag) {
        realPart = real;
        imagPart = imag;
    }

    public double getReal() {
        return realPart;
    }

    public double getR() {
        return Math.sqrt(realPart * realPart + imagPart * imagPart);
    }

    // Etc.
} 
```

和指数实现：

```
public class ExpComplex implements IComplex {
    private double r;
    private double theta;

    public double getReal() {
        return r * Math.cos(theta);
    }

    public double getR() {
        return r;
    }

    // Etc.
} 
```

这可以防止冗余字段。想想`ArrayList`a 和 a之间的区别`LinkedList`。它们都是列表（以上都是复数），但从实现的角度来看，它们的工作方式完全不同。但是任何使用这些类的代码都不会在意，但他们可能会根据性能选择正确的代码。说得通？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-20T21:30:23.007

这真的没有意义。指数形式只是表示复数的另一种方式。例如

```
 z = x + iy 
```

是您在第一堂课中使用的标准实部和虚部表示。指数形式是

```
 z = r * exp(i * theta) 
```

其中`r`是模数并且`theta`是参数

```
 r = sqrt(x*x + y*y) 
```

和

```
 z = r*( cos(theta) + i*sin(theta)) 
```

本质上，这只是将笛卡尔坐标转换为等效的极坐标表示。

`exponential`您正在尝试计算的第二个派生类中存储一个双精度值，但实际上这个值没有意义。您正在计算正确的模数和`module`正确的参数，`fi`但看起来您`exponential`想要

```
 module*exp(fi) 
```

这并没有真正的意义。如果您想存储对于您的值正确的模数和参数的值，`x`并且`y`作为笛卡尔实部和虚部更有意义，但仅存储双精度值`exponential`是没有意义的，除非您从问题中省略了某些内容。

看起来你真的会更好，要么只从你的`re`和`im`变量中计算模数和参数，然后从函数中返回它们，要么将它们存储为额外的成员变量。

# xaml - WinRT 中的全局调度程序？

> ID：13482205
> 
> 赞同：6
> 
> 时间：2012-11-20T21:11:12.890
> 
> 标签：xaml, windows-8, microsoft-metro, windows-runtime, winrt-xaml

我有一些看起来像这样的 WP7 代码：

```
 using System.Windows;
using System.Windows.Threading;

public static class GlobalDispatcher
{
    public static Dispatcher Current { get { return Deployment.Current.Dispatcher; } }
} 
```

WinRT 中的等价物是什么？是否没有全局可访问的 Dispatcher（或 CoreDispatcher）对象？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T21:45:06.237

你会想要使用`Window.Current.Dispatcher`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-09-10T08:35:30.290

只需将其添加为答案，因为它可以更好地解决我认为的问题：

如果应用程序没有获得焦点，则 Window.Current 为 null，因此当涉及到用户时会给您带来麻烦；）

> CoreApplication.MainView.CoreWindow.Dispatcher 不为空...
> 
> ——杰里米·怀特 2013 年 8 月 4 日 13:09

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-23T06:15:51.593

尝试这个：

```
 var dispatcher = CoreApplication.MainView.CoreWindow.Dispatcher;
        await dispatcher.RunAsync(CoreDispatcherPriority.Normal, () =>
        {
            try
            {
               //Your code here
            }
            catch (Exception ex)
            {
                HandleException(ex);
            }
        }); 
```

# java - Java 和 SOAP 数据客户端请求为 UTC 时间并保存为 EST 时间

> ID：13482207
> 
> 赞同：5
> 
> 时间：2012-11-20T21:11:14.570
> 
> 标签：java, soap

我有一个肥皂客户端请求，我需要将日期响应转换为 EST 时间。

在我的屏幕上，我选择了：上午 11:45，我想将上午 11:45 保存在数据库中。

但是 SOAP 请求是这样的：

2012-11-24T16:45:00.000Z

在 java 代码中，日期打印为：

2012 年 11 月 24 日星期六 11:45:00 EST ...

然而，我们进行了另一个 Web 服务调用，最终保存到数据库（SQL Server）：2012-11-24 16:45

```
Calendar incomingWebServiceCalendarObject = fromWebService.getDateTime()

Calendar outgoingWebServiceCalendarObject = incomingWebServiceCalendarObject;
webServiceBean.setDateTime(outgoingWebServiceCalendarObject); 
```

... 如何保存为 2012-11-24 11:45？

另外，这里是公历：

java.util.GregorianCalendar[time=1353775500000,areFieldsSet=true,areAllFieldsSet=true,lenient=true,zone=sun.util.calendar.ZoneInfo[id="America/New_York",offset=-18000000,dstSavings=3600000,useDaylight =true,transitions=235,lastRule=java.util.SimpleTimeZone[id=America/New_York,offset=-18000000,dstSavings=3600000,useDaylight=true,startYear=0,startMode=3,startMonth=2,startDay=8, startDayOfWeek=1,startTime=7200000,startTimeMode=0,endMode=3,endMonth=10,endDay=1,endDayOfWeek=1,endTime=7200000,endTimeMode=0]],firstDayOfWeek=1,minimalDaysInFirstWeek=1,ERA=1, YEAR=2012,MONTH=10,WEEK_OF_YEAR=47,WEEK_OF_MONTH=4,DAY_OF_MONTH=24,DAY_OF_YEAR=329,DAY_OF_WEEK=7,DAY_OF_WEEK_IN_MONTH=4,AM_PM=0,HOUR=11,HOUR_OF_DAY=11,MINUTE=45,SECOND= 0,MILLISECOND=0,ZONE_OFFSET=-18000000,DST_OFFSET=0]

...

我做了以下工作，这似乎可行，这是一种正确的方法吗，根据我的要求尝试完成的代码是什么？

```
final long offset = this.secondaryScheduleTime.getTimeInMillis() + TimeZone.getTimeZone("EST").getRawOffset();
final Date estTime = new Date(offset);
final Calendar c2 = Calendar.getInstance();
c2.setTime(estTime); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T16:05:03.560

您的初始 SOAP 请求以 UTC（`.000Z`是您的时区信息）的形式传入，之后您的 Calendar 对象将其转换为东部时间 `,zone=sun.util.calendar.ZoneInfo[id="America/New_York"...`以进行显示，然后您将原始 SOAP 信息保存到您的数据库中。

您没有显示的是您*如何*持久化数据库以及使用*哪个*时间戳。

我只能想到两种情况：

1.  您的数据库仅采用 UTC 格式，不保存时区信息。这意味着对您的数据库的每次调用始终是 UTC，并且时区由您的代码决定。
2.  您的数据库通过 Timestamp 数据类型保存时区信息，但是您将 SOAP 请求中的 UTC 信息发送到您的数据库，而不是您的本地日历对象。

我认为您提供的解决方案满足上面列表中的#2，但同样，如果没有看到任何其他细节，我认为很难确定。

我建议删除一些断点并单步执行您的代码，以准确查看创建日期对象的时间/地点以及包含哪些信息。

# git - Perforce：如何跟踪文件“部署”

> ID：13482208
> 
> 赞同：1
> 
> 时间：2012-11-20T21:11:14.203
> 
> 标签：git, svn, version-control, mercurial, perforce

我们是一个使用 Oracle Forms / Reports 作为开发工具的非常小的团队，目前我们没有使用版本控制。我们正在考虑使用 Perforce 作为我们的版本控制软件。

我们当前的政策是团队中的任何开发人员都可以更改任何源文件，然后将生成的可执行文件 (.fmx) 部署（手动复制）到我们的生产文件夹。

使用 Perforce，我们的策略将基本相同，我们只需要记录和跟踪源文件更改以及对生产文件夹的部署。

源代码更改的跟踪是直截了当的。但是我们如何使用 Perforce 跟踪部署？如果 Perforce 无法做到这一点，那么任何其他版本控制软件（例如 Subversion、Git、Mercurial 等）都可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T03:07:47.433

我建议这种安排：

*   使用一个 Perforce`depot`进行源代码更改
*   将另一个`depot`用于您要部署的二进制工件
*   建立一些流程（可能是持续集成）并签入工件
*   在每个部署目标上，维护一个映射到适当构建工件的 Perforce 工作区。
*   在每个部署目标上，设置一个 cron 作业或计划任务，以在某个时间间隔简单地同步 Perforce 工作区。或者，您可以使用审查守护程序让部署目标知道何时运行同步。

我喜欢这个设置有几个原因：

*   您在源和构建工件之间具有完全可追溯性
*   您可以轻松报告哪些版本的工件已部署到任何目标
*   您可以使用 Perforce 工具来验证每个目标上工件的完整性

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T01:33:25.547

根据我们在问题评论中的讨论，我相信您正在寻找的是 Perforce 的[触发器](http://www.perforce.com/perforce/doc.current/manuals/p4sag/06_scripting.html)功能。

从链接页面是一个例子：

```
change-submit  //depot/....exe  "/usr/bin/test.pl %change%" 
```

配置 Perforce 以在将 .exe 文件签入到软件仓库时运行测试脚本。在您的情况下，它将是 .fmx 而不是 .exe，您可能希望将触发器从整个仓库缩小到特定目录。

# windows - Windows 8 托盘通知错误

> ID：13482210
> 
> 赞同：9
> 
> 时间：2012-11-20T21:11:21.633
> 
> 标签：windows, powershell, notifications

我正在尝试在 Windows 8 上创建简单的 Powershell 脚本，它将通过系统托盘通知气球通知我。代码很简单：

```
[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms")

$objNotifyIcon = New-Object System.Windows.Forms.NotifyIcon

$objNotifyIcon.Icon = "D:\1.ico"
$objNotifyIcon.BalloonTipIcon = "Info"
$objNotifyIcon.BalloonTipText = "I'm there"
$objNotifyIcon.BalloonTipTitle = "Hello!"

$objNotifyIcon.Visible = $True
$objNotifyIcon.ShowBalloonTip(10000) 
```

1.ico 是光盘上真正存在的自定义图标。

它可以正常工作，除了一件小事。我更喜欢在我的窗口顶部有任务栏，它似乎给气球带来了麻烦：它画*在*任务栏下（屏幕：[https](https://dl.dropbox.com/u/1138313/systraybug.PNG) ://dl.dropbox.com/u/1138313/systraybug.PNG ）。我用 notifyIcon 在 C# 中制作了测试应用程序并得到了相同的结果。但是像 Dropbox 或 Skydrive 这样的其他应用程序没有这样的问题，我的底部任务栏的脚本也很完美。我在 NotifyIcon 的文档中没有找到任何样式选项。这是烦人的错误还是我可以修复它？

问候。

UPS：看起来，但是 Dropbox 应用程序也有同样的问题（我很惭愧，第一次没有看到）。所以这是系统错误，我猜。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-28T05:11:06.467

这是 Windows 中的已知错误。您可能能够覆盖任务栏行为的唯一方法是找到气球的句柄，然后使用 SetWindowPos 使其位于最顶层：

```
BOOL WINAPI SetWindowPos(
  _In_      HWND hWnd,
  _In_opt_  HWND hWndInsertAfter,
  _In_      int X,
  _In_      int Y,
  _In_      int cx,
  _In_      int cy,
  _In_      UINT uFlags
); 
```

MSDN：“可以通过将 hWndInsertAfter 参数设置为 HWND_TOPMOST 并确保未设置 SWP_NOZORDER 标志，或者通过设置窗口在 Z 顺序中的位置，使其位于任何现有的最顶层窗口之上，从而使窗口成为最顶层窗口。当一个非最顶层的窗口被设置为最顶层，它拥有的窗口也被设置为最顶层。然而，它的所有者并没有改变。有关详细信息，请参阅[SetWindowPos](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633545%28v=vs.85%29.aspx)。

另一种策略是降级任务栏。使用此代码查找最顶层的窗口：

```
HWND FindMyTopMostWindow()
{
    DWORD dwProcID = GetCurrentProcessId();
    HWND hWnd = GetTopWindow(GetDesktopWindow());
    while(hWnd)
    {
        DWORD dwWndProcID = 0;
        GetWindowThreadProcessId(hWnd, &dwWndProcID);
        if(dwWndProcID == dwProcID)
            return hWnd;            
        hWnd = GetNextWindow(hWnd, GW_HWNDNEXT);
    }
    return NULL;
 } 
```

然后将窗口降级或将窗口的 zorder 设置得更高。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-12T13:28:31.683

我遇到了同样的问题，发现气球的形状取决于消息体的大小。也就是说，如果您的消息正文最多有 60 个字符，将显示圆形气球，对于较长的消息，将使用新的和标准的方形气球。

我没有使用 PowerShell 与系统托盘交互，而是使用 WPF NiotifyIcon 库在 WPF 应用程序中显示托盘图标。

高温高压

# mercurial - 我可以在 Mercurial 分支和合并方面做得比我现在做的更好，还是 mercurial 可以比在这个示例测试用例中做得更好？

> ID：13482219
> 
> 赞同：1
> 
> 时间：2012-11-20T21:11:51.727
> 
> 标签：mercurial, branching-and-merging

在商业开发中的版本控制中，一个项目往往有多个分支。在我的 mercurial 管理的项目中，我经常有一个稳定版本和一个主干版本，它们来自一些共同的父级，如下所示：

```
 V8     (the parent of both V8-stable and V9, revisions 1..100)
       |
       +---  V8_stable  (bug fix branch, revisions 101 to 500 )
       |
       +---  V9_trunk   (trunk, revisions 501 to 1000 ) 
```

上述所有版本的项目都有一个文件，我们称之为`helloworldapp.py`. 这些示例使用 Python，因为它是我所知道的最类似于伪代码的语言，但问题不是 Python 问题。现在，在 Mercurial 中，您可以使用克隆进行分支，或者您可以使用 Mercurial 的内置分支功能。在此示例中，我使用整个存储库的克隆进行分支。

这是V8 `helloworldapp.py`，它是共同的父版本：

```
# helloworldapp.py rev 100 (v8)
def func1(a,b,c,d,e):
    print "stuff"
def func2(a,b,c,d,e):
    func1(a,b,c,d,e)
def func3(a,b,c,d,e):
    func2(a,b,c,d,e)
def func4(a,b,c,d,e):
    func3(a,b,c,d,e)
def func5(a,b,c,d,e):
    func4(a,b,c,d,e)
def func6(a,b,c,d,e):
    func5(a,b,c,d,e)
def func7(a,b,c,d,e):
    func6(a,b,c,d,e)

func7(1,2,3,4,5) 
```

这是版本 500，V8-stable 分支的一部分：

```
# helloworldapp.py rev 500 (v8_stable)
def func1(a,b,c,d,e):
    print "stuff"

def morestuff():
   print "morestuff"

morestuff()
func1(1,2,3,4,5) 
```

这是 V9 主干分支的修订版 1000 部分：

```
# helloworldapp.py rev 1000 (v9_trunk)
def func1(a,b,c,d,e):
    print "stuff"

def func4(a,b,c,d,e):
    morestuff()
    morestuff()
    morestuff()
    func1(a,b,c,d,e)

def morestuff():
   print "hello"

func4(1,2,3,4,5) 
```

上述文件是分支不同步时发生的情况的非常简短的示例，在面向文件的版本控制中，当我必须管理“稳定到主干”合并时（通过拉取和然后合并）。

这是合并时最终遇到的情况。请注意，在现实世界中，对我来说，这些问题通常会放大 100 倍到 1000 倍。我经常在数百个文件中遇到 5000 多行 Hg merge 无法解决的冲突，这需要我在 KDiff3 中手动合并每一个。

除了不让分支永远不同步之外，Mercurial 用户可以做些什么来使这种情况下的合并更容易？在我上面说明的情况下，“在文件的分支 A 的第 6 行工作”与“在文件的分支 B 的第 6 行工作”相同，并且逐行合并会产生合并冲突，其中两个用户实际上（在他们自己的脑海中）在一个文件中的不同功能上工作。通过从一个文件中删除不再使用的功能，因为不再需要它，您现在几乎可以确保更多的合并冲突机会。您几乎必须制定诸如“永远不要在上游稳定分支中移动或删除行”之类的规则。我知道如果你使用的是 Smalltalk 基于图像的版本控制系统，“它在哪一行”的意外 将不再参与其中。如果 Mercurial 使用的 diff-tool 理解 Python，它可以在 Python 代码上做得更好，但代价是让它在 C# 代码上可能根本无法正常工作。因此，这是基于文件的编程和 DVCS 工具的最新技术。美好的。

因此，在此处所示的合并情况下，

![在此处输入图像描述](../Images/73c48c7dfec1f16fb17323e4799d3aae.png)

（[点击这里查看大图](https://i.stack.imgur.com/Sv5RI.png)）

* 我看到的是合并冲突，我希望它可以找出我想要全部或不想要“morestuff”功能：

![在此处输入图像描述](../Images/c044eb558118a21f48a7040189c4135c.png)

我希望我得到什么（自动）：

![在此处输入图像描述](../Images/6041d6fa6a1a6cc0f36b65957628ba57.png)

我在 bitbucket 上发布了示例存储库： [helloworldapp_v9](http://bitbucket.org/wpostma/helloworldapp_v9) [helloworldapp_v8_stable](http://bitbucket.org/wpostma/helloworldapp_v8_stable)

要尝试这个“我可以构建的最简单的示例，当您尝试解决合并冲突时会发生什么”，请克隆上述其中一个，然后从另一个中提取，然后合并。最后我的问题是：Mercurial 的专业用户如何处理这种情况？理解这个例子是人为的，但显示了 DVCS 工具的用户遇到的一些复杂性，但在现实世界中，这些冲突通常比我在这里展示的简单案例复杂得多。我已经学会了使用 TortoiseHG 和 KDIFF3 相当快地处理大多数小而简单的冲突，但我发现合并地狱比我记得的使用 Subversion 或 Perforce 的问题要小得多，但我仍然没有 不要认为（a）程序员（我）或（b）我的工具已经完成了所有可以帮助管理和理解这种复杂性的事情。我有一种感觉，我还没有尝试或了解过使用 Mercurial 的替代解决方案、工具和工作策略。也许 MQ 和 Rebase？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T17:15:47.797

实际上，根据我的经验，现实世界通常不是那样的，原因有两个：

1.  我们更频繁地合并（在您的示例中从 v8 到 v9），以便 Mercurial 逐渐了解两个分支之间的事物如何组合在一起。500 个变更集是一步完成的大量变更（我以前也这样做过！）。

2.  合并我们的分支时，我们的更改不会像您的示例那样残酷地发生冲突。由于每次更改的冲突更少，上下文更多，合并工具在将它们组合在一起方面做得更好。

我们确实有碰撞，需要弄清楚如何手动将它们放在一起，如果我们推迟它可能会很头疼。但是，一旦我们这样做了，现在共同的祖先就是合并，我们不需要再次重新访问该碰撞。通过更频繁地合并，您可以减少自共同祖先以来变更集的数量。

我有兴趣通过从 V8_stable 到 V9_trunk 的定期合并来重新运行您的示例。如果您在函数定义之间添加一些文本以为 hg 提供更多上下文以区分更改，我也会感兴趣。

* * *

尝试尝试与您的示例进行更频繁的合并，但效果不佳。如果您的版本差异很大（只有 15%-25% 相同），它们就会成为根本不同的代码库，合并不再有意义。那时，我尝试将这些部分分解为单独的文件，以允许两个版本（以及我的理智！）和平共存。

# sql-server - 如何在不使用 RAISERROR() 的情况下使 T-SQL 脚本失败？

> ID：13482222
> 
> 赞同：0
> 
> 时间：2012-11-20T21:12:01.303
> 
> 标签：sql-server, sql-server-2008, tsql

这就是我想要完成的：

在 SQL Server 代理作业的第一步中检查数据库是否为只读。如果是这种情况 - 退出工作。

所以我想我将为作业步骤使用高级属性，并为“失败阳离子”选择“退出作业报告成功”：

但是，如果不使用 RAISERROR()，T-SQL 脚本如何失败？我不想使用 RAISERROR() 的原因是因为需要成为 sysadmin 服务器角色的成员才能使用它。

我发现了一种相当丑陋的方法——从表中选择一些不存在的东西，脚本如下所示：

```
declare @DBIsRO int;

SET @DBIsRO= (SELECT is_read_only
FROM sys.databases
WHERE name = 'test')

IF @DBIsRO=1 
   select * from dd -- table dd doesn't exist in current database 
```

但是，这似乎只是一个杂物，我正在寻找一种“适当”的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T21:16:22.937

重读文档：

> 任何用户都可以指定从 0 到 18 的严重级别。从 19 到 25 的严重级别只能由系统管理员的成员指定...

你可以做：

```
raiserror( 'Readonly',16,1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:17:19.653

> 我不想使用 RAISERROR() 的原因是因为需要成为 sysadmin 服务器角色的成员才能使用它。

好吧，如果那是真的，没有人会使用它。根本不是真的。[规范](http://msdn.microsoft.com/en-us/library/ms178592.aspx)说：

> 任何用户都可以指定从 0 到 18 的严重级别。从 19 到 25 的严重级别只能由 sysadmin 固定服务器角色的成员或具有 ALTER TRACE 权限的用户指定。

即使这是真的，您也可以使用[代码签名](http://msdn.microsoft.com/en-us/library/ms345102%28v=sql.105%29.aspx)来利用它。但根本没有必要。

# performance - 在 Gridview 的 TemplateField 中使用标签会导致性能问题吗？

> ID：13482223
> 
> 赞同：0
> 
> 时间：2012-11-20T21:12:08.513
> 
> 标签：performance, gridview, cells, templatefield, boundfield

**将Gridview** * *BoundFields* * 更改为带有**标签的****TemplateFields**是否存在重大性能问题？（请参阅下面的代码摘录）

 **由于gridview字段的许多需求更改，我计划实施上述更改，以使代码更易于维护。仅重新排列字段时需要较少的代码更改。

使用 BoundFields 似乎更容易出错，因为必须非常小心地跟踪所有出现的**单元格索引**。尤其是 Gridviews 有很多可以在任何地方访问的字段。

任何帮助/建议表示赞赏。

提前致谢。

**标签：**

***在页面上：***

```
<asp:TemplateField HeaderText="Field1">
     <ItemTemplate>
         <asp:Label ID="lblField1" runat="server" Text='<%# Eval("Field1")%>' />
     </ItemTemplate>
</asp:TemplateField> 
```

***在代码中：***

```
Label lblField1 = row.FindControl("lblField1") as Label;
if (lblField1 != null) { string field1 = lblField1.Text; } 
```

**边界：**

***在页面上：***

```
<asp:BoundField DataField="Field1" HeaderText="Field1" /> 
```

***在代码中：***

```
string field1 = row.Cells[2].Text; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:15:48.020

使用 hastable dataItem 而不是 cells 对象

数据项（“字段 1”）。那么你就不需要担心单元格索引了。

编辑：所以除非你在页面加载时重新绑定你的网格，否则它会出现，你将没有数据项可以使用。

话虽如此，我无法证实这一说法，但我认为模板字段会更适合您的需求，因为认为它可能更密集处理，您将获得对该对象的引用以进行额外处理。

基本上，绑定字段解析为表格中的一个单元格，其中标签将解析为具有引用的跨度。DOM 会有所不同，您对数据的访问也会有所不同。

所以使用标签会有更多的开销，但你会更容易访问。

我不会说存在“重大”性能问题，除非您当然没有分页数百条记录。那么我猜想绑定字段会不那么密集，仅仅是因为你没有生成那么多的 html。**

# java - 另一个 SSLSocket 上的 SSLSocket

> ID：13482224
> 
> 赞同：1
> 
> 时间：2012-11-20T21:12:14.147
> 
> 标签：java, android, ssl, tunnel

我正在为需要我向代理服务器打开 SSLSocket、进行隧道握手然后在隧道上创建另一个 SSLSocket 的系统编写 Android 客户端。这是我创建隧道的代码：

```
 SSLSocketFactory sslsocketfactory = securityService.getSslContextNoCerts().getSocketFactory();
    SSLSocket sslSocket = (SSLSocket) sslsocketfactory.createSocket(proxyAddress.getAddress(),
            proxyAddress.getPort());
    sslSocket.setEnabledProtocols(new String[] { SecurityService.TLS10 });
    sslSocket.setEnabledCipherSuites(SecurityService.CIPHERS);
    sslSocket.startHandshake(); 
```

然后我进行隧道握手，然后：

```
 SSLSocketFactory sslsocketfactory = securityService.getSslContext().getSocketFactory();
    hostSocket = (SSLSocket) sslsocketfactory.createSocket(tunnel,
            InetAddress.getByAddress(remoteAddress.getIpAddress()).getHostAddress(),
            remoteAddress.getPort(), false);
    hostSocket.setUseClientMode(false);
    hostSocket.setNeedClientAuth(true);
    securityService.setEnabledProtocols(hostSocket);
    hostSocket.setEnabledCipherSuites(SecurityService.DATASESSION_CIPHERS);
    hostSocket.startHandshake(); 
```

此时，我收到带有此消息的 SSLProtocolException：

错误：140760FC：SSL 例程：SSL23_GET_CLIENT_HELLO：未知协议（外部/openssl/ssl/s23_srvr.c:589 0xad12b3f0:0x00000000）

有谁知道我怎么能做到这一点？我知道您的第一个问题是为什么在 SSL 上分层 SSL，但我正在为需要它的现有系统编写客户端。

任何帮助将非常感激。竹斌

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T20:06:50.367

好的，我终于解决了这个问题。由于某种原因，当我使用 org.apache.harmony.xnet.provider.jsse.OpenSSLProvider（Android 默认 SSL 提供程序）时，SSL over SSL 不起作用。所以我切换到 org.apache.harmony.xnet.provider.jsse.JSSEProvider 现在一切正常。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-20T22:04:53.033

您的代码看起来正确。由于它不起作用，我建议您误解了该要求，或者它已被歪曲给您。我建议你只需要继续使用原来的 SSLSocket。试试看。我发现任何真正的系统都不太可能按照您所描述的方式工作。它的表现不仅糟糕透顶；服务器必须具有与此处相同的双 SSL 编码：它如何知道何时执行此操作，何时不执行此操作？创建隧道后，代理仅复制字节。我敢打赌，只要继续使用原来的 SSL 连接就可以了。

# java - 排列然后在Java中排序

> ID：13482227
> 
> 赞同：-1
> 
> 时间：2012-11-20T21:12:38.310
> 
> 标签：java, arrays, sorting, loops, recursion

我有一个排序问题。

假设我有 4 个字符串存储在一个数组中，其中我想成对生成所有组合。并从这些对中对它们进行排序，以便没有 2 个数组位置在最大范围内相互连接

例子：

```
String[] array = {"one", "two", "three", "four"};

// want to generate

one - two
one - three
one - four
two - three
two - four
three - four

// then sort

one - two
three - four
one - four
two - three      //two "three" after each other
one - three
two - four 
```

（在这种情况下，一个接一个地得到 2 的那个`"three"`在排序时也太随机了）

我不知道如何在 Java 中做到这一点。尝试嵌套 for 循环，有些人告诉我递归循环。而且我不想要：

“*只需复制粘贴这段代码，一切都会*好起来的”我真的很想了解如何编写这样的东西。

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T21:17:35.457

这是你的不`Just copy paste this code and everything will work`：-

> 第 1 步： - 将临时变量初始化为**`0`**.
> 
> **第 2 步： - 从到**迭代您的数组**`0``arr.length - temp`**
> 
> 第 3 步： - 打印**`arr[i][temp] - arr[i][i + temp]`**
> 
> `temp`第 4 步：- 增量`1`
> 
> 第 5 步： - 重复`step 2`if **`temp < arr.length - 1`**， as**`(i + temp)`**不能超过**`arr.length`**。

因此，对于给定的数组，它将打印： -

```
String arr[] = {"one", "two", "three", "four"}; 
```

**第一次迭代（差异为 1 的索引对）：-**

```
1\. arr[0][0] - arr[0][1], then ("one" - "two")
2\. arr[0][1] - arr[0][2],      ("two" - "three")
.. so on, 
```

然后进入下一次迭代。增加温度`1`： -

**第二次迭代（具有差异 2 的索引对）：-**

```
1\. arr[0][0] - arr[0][2], then  ("one" - "three")
2\. arr[0][1] - arr[0][3]        ("two" - "four") 
```

.. 很快。

**最后一次迭代（有差异的索引对`arr.length - 1`）：-**

```
1\. max = arr.length - 1;
2\. arr[0][0] - arr[0][max]      ("one" - "four") 
```

所以，你可以看到，这里没有任何`sorting`涉及的内容。如果您尝试通过排序来做到这一点，那将会非常复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:21:56.180

首先提出一个算法。它不必为它设置特定的语言。这只是你自己解决问题的方式。

然后将其翻译到计算机上。

这里有一些伪代码可以帮助您入门。

```
public pair[] getPairs(string[] arr)
{

    pair[] retval;
    foreach(string s in arr)
    {
        string first = arr.first
        foreach(string s2 in arr.subArray(allbutfirst))
        {
             retval.Add(newPair(s, s2)
        }
    }
} 
```

# c - 设置 UART 中断以在接收到字符时触发

> ID：13482229
> 
> 赞同：0
> 
> 时间：2012-11-20T21:12:46.227
> 
> 标签：c, interrupt, uart

我正在尝试设置一个 UART 中断以在 UART 屏幕上输入字符时触发。问题是我设置它的方式似乎在发送和接收时触发了中断。我已经阅读了数据表，它并没有真正说明它是否可以完成以及如何完成。它只是说串行端口的中断是可用的。这就是我设置UART的方式

```
S0CON   =   0x50;      
PCON    |=  0x80;       /* Double Baud rate */
ADCON0  |=  0x80;       /* Use baudrate generator */
S0RELL  =   0xCC;       /* Baudrate = 9614 Baud @ 16Mhz */
S0RELH  =   0x03;
TI0     =   1;                /* Ready to transmit */
ES0 =1; 
```

有谁可能知道如何做到这一点？我正在使用 Keil 编译器和英飞凌 C509 [数据表](http://www.keil.com/dd/chip/2957.htm)**链接已修复

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:05:14.537

不幸的是，看起来你不能干净地做你想做的事。查看用户手册——数据表通常不足以解决此类问题——查看图 7.4。硬件设置的通道0、TI0和RI0的发送和接收中断标志，都触发了默认的串行通信中断，看来两者都不能禁用。

可能还有其他选择，但我会考虑以下选项之一：

*   轮询（相对于使用 UART 的任何中断）
*   在工作时使用中断，但首先在串行通信中断中检查 RI0 是否已设置，如果未设置，请立即退出。（只要确保没有任何与此相关的时序问题并清除接收标志以确保您没有任何丢弃字节的可能性。）

链接到 C509-L 用户手册（不确定它会持续多久）：[英飞凌产品网站](http://www.infineon.com/dgdl/m509.pdf?folderId=db3a304412b407950112b415bf961eaf&fileId=db3a304412b407950112b41a65b02a78)

# sql - 如何在 oracle 表中搜索新行字符？

> ID：13482235
> 
> 赞同：15
> 
> 时间：2012-11-20T21:13:00.007
> 
> 标签：sql, oracle, newline

我对从数据库返回的数据（以字节格式）创建的文件有疑问。
问题是文件中有几个换行符。
我想知道是否有办法编写 where 子句来检查某些记录是否有换行符？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-20T21:18:29.093

使用 CHR 函数查找 ASCII 值：

```
select *
from your_table
where instr(your_text_col, chr(10)) > 0; 
```

如果你想搜索回车，那就是 chr(13)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-20T21:18:06.787

您可以编写如下内容：

```
SELECT id
  FROM table_name
 WHERE field_name LIKE '%'||CHR(10)||'%'
; 
```

(`||`是连接运算符；`CHR(10)`是第十个 ASCII 字符，即换行符。)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-20T21:19:01.803

根据平台，换行符通常是`CHR(10)`(Unix) 或`CHR(13)`后跟`CHR(10)`(Windows)。其他更深奥的平台还有其他选择，但 99.999% 的情况下，它将是这两个平台之一。

您可以搜索列中的数据以查找一个或两个字符

```
SELECT instr( column_name, CHR(10) ) position_of_first_lf,
       instr( column_name, CHR(13) || CHR(10) ) position_of_first_cr_lf
  FROM table_name
 WHERE instr( column_name, CHR(10) ) > 0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-04T21:00:01.557

这对我来说效果最好。

select * from label_master where regexp_like (text, chr(10));

# vba - 从访问创建逗号分隔文件 (csv) - 每天从 Windows 安排

> ID：13482242
> 
> 赞同：1
> 
> 时间：2012-11-20T21:13:21.653
> 
> 标签：vba, ms-access, vbscript

我想创建一个 vbs 文件来导出 csv 文件中的访问表（逗号分隔）。我从 Remou 那里看到了这个结尾。它有效，但它创建标签分隔。谁能帮我？谢谢！

```
db = "C:\Docs\LTD.mdb"
TextExportFile = "C:\Docs\Exp.txt"

Set cn = CreateObject("ADODB.Connection")
Set rs = CreateObject("ADODB.Recordset")

cn.Open _
   "Provider = Microsoft.Jet.OLEDB.4.0; " & _
   "Data Source =" & db

strSQL = "SELECT * FROM tblMembers"

rs.Open strSQL, cn, 3, 3

Set fs = CreateObject("Scripting.FileSystemObject")

Set f = fs.CreateTextFile(TextExportFile, True)

a = rs.GetString

f.WriteLine a

f.Close 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T22:52:36.197

创建标准 CSV 并不难

```
Set cn = CreateObject("ADODB.Connection")

cn.Open "Provider=Microsoft.Ace.OLEDB.12.0;Data Source=z:\Docs\test.accdb"

sSQL = "select * into " 
sSQL= sSQL & "[text;database=z:\docs\;FMT=Delimited;HDR=Yes].[csvfile.csv]"
sSQL= sSQL & " from table1"

cn.Execute sSQL 
```

VBScript 文件将在任务计划程序中运行得很好。

编辑重新评论

如果您的语言环境中的小数分隔符是逗号，您可能会遇到问题。您可以使用 schema.ini 文件覆盖 Windows 区域设置，您只需要包含文件的名称和要更改的项目：

```
[csvfile.csv]
DecimalSymbol=. 
```

完整列表可从 Microsoft 获得：[Schema.ini](http://msdn.microsoft.com/en-us/library/ms709353%28VS.85%29.aspx)

没有理由不应该在导出之前在代码中编写 schema.ini，除非确保不要覆盖现有架构——您可以追加。

您将从 Windows 控制面板获取有关系统区域设置的信息：http: [//windows.microsoft.com/en-IE/windows7/Change-the-system-locale](http://windows.microsoft.com/en-IE/windows7/Change-the-system-locale)

# javascript - 在原始窗口中打开新窗口，其中地图范围在运行时派生

> ID：13482244
> 
> 赞同：0
> 
> 时间：2012-11-20T21:13:28.943
> 
> 标签：javascript, window, arcgis

我在 gis.stackexchange 上问了这个问题，但有人建议这更像是一个网络而不是 ArcGIS 问题......我正在尝试从现有窗口打开一个新窗口，该窗口将包含一个地图，其范围源自原来的窗口。换句话说，用户将缩放到原始窗口中的一个区域，单击一个按钮，然后将打开一个新窗口（或选项卡），其中地图设置为缩放范围。我正在使用 ArcGIS Javascript API。我已经尝试了几种 JS/jquery/html 方法来完成这项工作，(window.load, ,$window.ready)..但对我来说没有任何效果。我继续在我的新页面中收到一个错误，说“地图”未定义，并且我可以在 Firebug 中看到我的函数在页面完全加载之前运行基于原始页面的范围设置新范围。我希望我能清楚地解释这个问题。有没有人有任何想法？谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T00:19:19.643

您应该在地图的 onLoad 事件中运行任何配置活动地图的代码，以便它在地图对象本身加载后运行....所以在您的启动代码中的某个地方您需要：

`//create the map object
var map = new esri.Map("mapDiv", {options});`

`//hook the onLoad event
dojo.connect(map, "onLoad", function() { //set your extent here });`

# java - 不能在 servlet 中包含 jsp

> ID：13482250
> 
> 赞同：0
> 
> 时间：2012-11-20T21:13:56.853
> 
> 标签：java, jsp, web

我需要在我的 servlet 中包含 .jsp 文件。

我写了一个简单的jsp文件，我把它放在了dir WEB-INF/jsps/中：

```
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="ISO-8859-1"%>
<html>
<head>
<title> Galleries </title>
</head>

<body>
Test
</body>
</html> 
```

和小服务程序：

```
package photoGallery;

import javax.servlet.RequestDispatcher;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@SuppressWarnings("serial")
public class GalleriesServlet extends HttpServlet {

    public void doGet(HttpServletRequest request, HttpServletResponse response)
    {
        try 
        {
            System.out.println("Test");
            //get the request dispatcher
            RequestDispatcher dispatcher = request.getRequestDispatcher("/WEB-INF/jsps/galleries.jsp");
            //forward to the jsp file
            if (dispatcher != null)
                dispatcher.forward(request, response);
            else 
                System.err.println("Error: dispathcer is null");        
        } 
        catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

在 web.xml 我添加了下一行：

```
 <servlet>
    <display-name>Gallery Servlet</display-name>
    <servlet-name>GalleryServlet</servlet-name>
    <servlet-class>photoGallery.GalleriesServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>GalleryServlet</servlet-name>
    <url-pattern>/galleries/*</url-pattern>
  </servlet-mapping> 
```

当我打开页面时

```
http://localhost:8080/PhotoGallery/galleries 
```

然后在控制台中打印“测试”，但在浏览器中我看到“HTTP 状态 404 - 未找到”

我在哪里犯了错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:33:33.063

我发现了我的错误。还有其他 servlet 映射到“/*”，因此出现错误

# orchardcms - Orchard CMS：将列表内容部分连接到内容项

> ID：13482253
> 
> 赞同：0
> 
> 时间：2012-11-20T21:14:16.623
> 
> 标签：orchardcms

我一直在努力解决我认为很简单的事情。

我有一个名为供应商的内容类型。该供应商的联系信息包含两个地址，一个用于通讯地址，一个用于访问地址。供应商也有几个位置，例如位置北和位置南。位置也是地址。所以基本上我有一个内容项目供应商，它有很多地址，而且它们都有自己的类型。

移民：

```
 public int Create() {
        //Creating the Location contentrecord, contentpart and contenttype
        SchemaBuilder.CreateTable("LocationPartRecord", table => table
                                                                     .ContentPartRecord()
                                                                     .Column<int>("LocationsPartRecord_id")
            );

        ContentDefinitionManager.AlterPartDefinition("LocationPart", part => part
                                                         .Attachable(false)
                                                         .WithField("LocationName", f => f.OfType("TextField"))
                                                         .WithField("AddressLine1", f => f.OfType("TextField"))
                                                         .WithField("AddressLine2", f => f.OfType("TextField"))
                                                         .WithField("Zipcode", f => f.OfType("TextField"))
                                                         .WithField("City", f => f.OfType("TextField"))
                                                         .WithField("Country", f => f.OfType("TextField")));

        ContentDefinitionManager.AlterTypeDefinition("Location",
                                                     cfg => cfg
                                                                .WithPart("CommonPart")
                                                                .WithPart("LocationPart")
            );

        //Creating the Locations 'container' contentpart
        SchemaBuilder.CreateTable("LocationsPartRecord", table => table
                                                                      .ContentPartRecord()
            );

        ContentDefinitionManager.AlterPartDefinition("LocationsPart", builder => builder.Attachable());

        //Creating the supplier. Specific supplier contentfields can be added later. Doing records, so I can add
        //datafields later that are not contentfields
        SchemaBuilder.CreateTable("SupplierPartRecord", table => table
                                                                     .ContentPartRecord());

        ContentDefinitionManager.AlterPartDefinition("SupplierPart", part => part
                                                                                 .Attachable(false)
            );

        ContentDefinitionManager.AlterTypeDefinition("Supplier", builder => builder
                                                                                .Creatable()
                                                                                .Draftable()
                                                                                .WithPart("CommonPart")
                                                                                .WithPart("TitlePart")
                                                                                .WithPart("BodyPart")
                                                                                .WithPart("AutoroutePart", partBuilder =>
                                                                                                           partBuilder.WithSetting("AutorouteSettings.AllowCustomPattern", "true")
                                                                                                               .WithSetting("AutorouteSettings.PatternDefinitions", "[{Name:'Supplier', Pattern: 'aanbieders/{Content.Slug}', Description: 'aanbieders/supplier-name'}]")
                                                                                                               .WithSetting("AutorouteSettings.DefaultPatternIndex", "0"))
                                                                                .WithPart("SupplierPart")
                                                                                .WithPart("LocationsPart"));

        return 1;
    } 
```

型号：* *LocationPartRecord 和 LocationPart **

```
public class LocationPartRecord:ContentPartRecord {
    public virtual LocationsPartRecord LocationsPartRecord { get; set; }
}

public class LocationPart:ContentPart<LocationPartRecord> {
    LocationsPartRecord LocationsPartRecord {
        get { return Record.LocationsPartRecord; }
        set { Record.LocationsPartRecord = value; }
    }
} 
```

**LocationsPartRecord 和 LocationsPart（容器）** 公共类 LocationsPartRecord:ContentPartRecord {

```
 public LocationsPartRecord()
    {
        Locations = new List<LocationPartRecord>();
    }

    [CascadeAllDeleteOrphan]
    public virtual IList<LocationPartRecord> Locations { get; set; }
}

public class LocationsPart:ContentPart<LocationsPartRecord> {

    public LocationsPart() {
        Locations = new List<LocationPart>();
    }

    public readonly LazyField<IList<LocationPart>> _locations = new LazyField<IList<LocationPart>>();

    public IList<LocationPart> Locations {
        get { return _locations.Value; }
        set { _locations.Value = value; }
    }
} 
```

从这里我被困住了。我想在创建新供应商时看到一个屏幕，其中包含供应商的所有内容项字段和位置列表，能够创建、删除或更新位置。

我不需要拼写代码，但一个方向就足够了。我应该创建哪些驱动程序、控制器和视图。这仅适用于管理控制台。对于前端，位置需要显示而不是编辑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:44:46.160

我认为没有任何方法可以在没有自定义编码的情况下获得您想要的功能。正如您所建议的，评论模块可能是一个很好的复制示例。评论模块中的控制器仅用于管理他们自己的管理页面中的所有评论，与其所属的内容项分开。评论的编辑/显示仍然是通过驱动程序和处理程序提供的。

使用 Comments 模块类比：

CommentsPart = AddressesPart - 这将被添加到您的供应商内容类型中

CommentPart = AddressPart - 这将被添加到您的地址内容类型中

你可以去掉很多用于管理评论的额外功能，只复制这两个部分的驱动程序、处理程序、视图和模型。

我已经看到一些画廊模块可以让您通过管理界面建立这些关系，但是我自己没有使用它：http: [//gallery.orchardproject.net/List/Modules/Orchard.Module.Downplay.Mechanics](http://gallery.orchardproject.net/List/Modules/Orchard.Module.Downplay.Mechanics)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T12:50:27.087

不知道这是否会有所帮助（并且该站点似乎已关闭 - 但如果您有耐心加载它，Google 有一个缓存版本），但有一个关于您的情况的好博客。它是天行者优秀的[网上商店](http://skywalkersoftwaredevelopment.net/blog/writing-an-orchard-webshop-module-from-scratch-part-1)系列。我相信第 8 部分包含与多个地址相关的代码（使用地址和地址）。这似乎涉及到你的问题，代码可能是你需要的。

如果您无法访问该站点，还有一个[CodePlex](http://skywalkerwebshop.codeplex.com/)代码库。此外，Bertrand 的[Nwazet Commerce](https://bitbucket.org/ems/nwazet.commerce)模块可能有类似的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T00:40:21.720

地址不应该是一部分，它应该是一个字段。这样，您可以拥有多个，并且每个都可以命名。

# excel - 基于两个唯一列中的条件引用 Excel 中的单元格

> ID：13482256
> 
> 赞同：2
> 
> 时间：2012-11-20T21:14:24.950
> 
> 标签：excel, analytics

我正在构建一个报告工作表来跟踪从 Google Analytics 下载的社交媒体数据。

我在分析中有一个自定义报告，它在三个独特的列中为我提供日期、媒介和访问。我想将按媒介和日期定义的访问次数提取到一个单独的表中，该表中还有其他数据。

这是我的来源信息：

![Excel 数据源示例](../Images/1313a99c25d150f683b85cb85b03a1c6.png)

这是我的目的地：

![Excel 数据目标示例](../Images/1679c1a6213b65d46c7a12514cb82e85.png)

我想将另一张表上的 Twitter 数据中的访问次数填入上面的目的地，同时确保日期一致。

Excel可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:29:36.557

非常如此，

您可以使用数据透视表——它会通过说明为您处理好它。或者，如果您想要基于公式的方法：

```
 A               B           C
1 Date            Medium      Visits
2 11/20/2012      Facebook    3
3 11/20/2012      Twitter     5
4 11/19/2012      Facebook    3
5 11/14/2012      Twitter     1
6 11/15/2012      Twitter     4 
```

我喜欢使用一个叫做 SumProduct 的函数。它可能既慢又笨重，但有时比使用 VB 宏更容易。

去做这个：

```
Total Facebook     xxxx 
```

利用：

=SumProduct((LookupArea = Condition)*(ColumnTotals))

它是如何工作的，对于您查找区域中的每个单元格，它将其与条件进行比较。如果条件为真，则创建 (1)。如果为假，则创建 (0)。这与条件二相乘。条件二告诉它获取“访问”列并将其乘以偏移量 1（因此，10 次访问 x 1 偏移量，即 10 次访问）。

样本：

```
=SUMPRODUCT((B2:B6="Facebook")*(C2:C6)) 
```

这给出了结果：6

您可以通过添加 * 和下一个条件来添加更多条件

```
=SUMPRODUCT((condition1)*(condition2)*(condition3)) 
```

您还可以通过使用 +、-、/ 等来得出不同的总数。这允许您否定值。您可以双重嵌套值并分别处理它们。

```
=SUMPRODUCT(((condition1)*(condition2))-(condition3)*(condition4))) 
```

# html - HTML属性中引号内的换行符？

> ID：13482258
> 
> 赞同：0
> 
> 时间：2012-11-20T21:14:30.440
> 
> 标签：html

我有这个 HTML：

```
<form action="mypage.php" method="post"
   onsubmit="return confirm('Are you sure you want to submit this form? Submitting this form has serious consequences and you should definitely think long and hard before doing it.');"> 
```

我想将我的代码保持在 80 个字符或以下。如何在保留完全相同的功能的同时将其拆分为多行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:18:26.317

随心所欲。只要您避免对像`<PRE>`. 有很多工具，如 HTML Tidy、HTML 美化、HTML 格式，您可以搜索并尝试。或者不时用手敲击ENTER

**编辑**

一开始我似乎并没有真正得到这个问题。如果您需要拆分 JS 参数，请将字符串切成更小的块，然后使用`+`,将其连接回去

```
alert('long line here'); 
```

你冷写：

```
alert('long ' +
      'line ' +
      'here'); 
```

但最好将 JS 与 HTML 分开，因此您`onSubmit`应该调用该函数，而不是保留最终的 JS 代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:21:28.557

我将创建一个 Javascript 部分来定义您从表单中调用的函数：

```
<script type="text/javascript">
    function formSubmit() {
         return confirm('Are you sure you want to submit this form? Submitting' +
                        ' this form has serious consequences and you should ' +
                        'definitely think long and hard before doing it.');
    }
</script> 
```

表格：

```
<form action="mypage.php" method="post" onsubmit="formSubmit()"> 
```

这会让你的 Javascript 脱离你的 HTML 表单，并且可以在你喜欢的地方清楚地被破坏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T21:27:57.783

我肯定会建议删除内联 Javascript 并将其分开。您甚至可以删除该`onsubmit`函数并仅在 Javascript 本身中捕获该事件。

您可以按照建议将字符串拆分并再次连接以获得快速解决方案，但如果您想更多地设置确认框的样式，我建议您查看类似[http://onehackoranother.com/projects/的内容jquery/boxy/](http://onehackoranother.com/projects/jquery/boxy/)或[http://jqueryui.com/dialog/#modal-confirmation](http://jqueryui.com/dialog/#modal-confirmation)以获取其他解决方案选项。

# php - PHP标头重定向到新页面

> ID：13482259
> 
> 赞同：2
> 
> 时间：2012-11-20T21:14:31.097
> 
> 标签：php

我想单击将转到第 2 页的超链接，但我也想打开一个新的空白页。

我试过了：

```
header "Location: http://bing.com";
header ("Location: http://bing.com", false);
header ("Location: http://bing.com", true, 301); 
```

我只想使用 php 打开新的空白页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:16:26.697

您不能从标头重定向中执行此操作。您需要在 HTML 中`target="_blank"`添加属性。`<A>`或者做一些技巧，将您的重定向重定向到将使用 JavaScript 为您执行此操作的页面（尽管它会被浏览器的反弹出功能阻止）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T21:25:01.353

您无法通过执行标头重定向打开新窗口。您必须使用 Javascript。

如果您出于某种原因需要使用 PHP 执行此操作，您可以像这样打印 Javascript：

```
<?php
echo '<script>window.open("http://www.google.com/");</script>';
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:16:18.410

这在 PHP 中是不可能的。如果您想一次打开 2 个页面（替换当前页面，并打开第二个选项卡/窗口），您必须使用 javascript 执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-19T10:05:10.563

我仅在此处找到的完美解决方案之一，您可以做一件事，即您要打开哪个页面以及其他页面，将下面的代码放在需要打开的 PHP 页面中，然后此代码将弹出对于代替默认链接提供的链接。

```
<?php
echo "<script type=\"text/javascript\">  window.open('http://reliable4you.com/', '_blank')  </script>";
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-08T05:52:38.243

这是我的新标签代码，它工作得很好。只关心您的文件位置。

代码：

```
<?php 
          if(isset($_POST['button']))
             {
                echo '<script language="javascript">';
                 echo 'window.open( "/Projectfolder/File.php" )';
                 echo '</script>';
              }
          ?> 
```

# jquery - 生成一个指定背景颜色和字体颜色的按钮

> ID：13482262
> 
> 赞同：0
> 
> 时间：2012-11-20T21:14:43.017
> 
> 标签：jquery, html, json, button

我需要生成一个指定背景颜色和字体颜色的按钮。问题是我只能设置其中一个参数（字体颜色或背景颜色），但不能同时设置。

JSON 代码：

```
{
    "Caption": "Module caption",
    "IconsDirectory": "C://Images/",
    "Buttons": [
        {
        "Conditions": [
            {
            "ConditionText": "1 == 1",
            "ButtonText": "Text_11",
            "Visible": true,
            "Colors": {
                "FontColor": "#FFFFFF",
                "BGColor": "#669933"
            },
            "BButtonText": {
                "TText": "Textt_1"
            },
            "Size": {
                "Width": 200,
                "Height": 50
            },
            "Icon": {
                "FileName": "Smile.png",
                "Width": 16,
                "Height": 16
            },
            "Url": {
                "UrlAddress": "http://www.google.com",
                "OpenNewWindow": true
            },
            "JavaScriptAction": {
                "TText": "alert('ok1');"
            }},
        {
            "ConditionText": "2 == 2",
            "ButtonText": "Text_22",
            "Visible": true,
            "Colors": {
                "FontColor": "#0FFFFF",
                "BGColor": "#FF9966"
            },
            "BButtonText": {
                "TText": "Textt_1"
            },
            "Size": {
                "Width": 200,
                "Height": 50
            },
            "Icon": {
                "FileName": "Smile.png",
                "Width": 16,
                "Height": 16
            },
            "Url": {
                "UrlAddress": "http://www.google.com",
                "OpenNewWindow": true
            },
            "JavaScriptAction": {
                "TText": "alert('ok2');"
            }}
        ]}
    ]
} 
```

html代码：

```
<!DOCTYPE html>
<html>
<head>
<title>SMButtons</title>
<script src="jquery/jquery-1.4.2.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $.getJSON('weekendtask.json', function(data) {
    var res = ""
    $.each(data.Buttons, function(key, button) {
        $.each(button.Conditions, function(key, condition) {
            res += "<li>"
            res += '<input type="button"' + '" value="' + condition.BButtonText.TText 
            res += '" onclick="' + condition.JavaScriptAction.TText 

            //background color
            res += '" style=" background-color:' + condition.Colors.BGColor 

            //font color
            //res += '" style=" color:' + condition.Colors.FontColor 

            res += '"/>'
            res += "<\/li>"
        })
    })
    $(res).appendTo('#ulObj')
});
});
</script>
</head>
<body>
<div>
<ul id='ulObj'>
<li>1</li>
<li>2</li>
<li>3</li>
</ul>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:21:01.207

您正在编写样式属性两次。为什么不这样做

```
res += '" style=" background-color:' + condition.Colors.BGColor + '; color:' + condition.Colors.FontColor + ';'; 
```

# cxf - 将带有 cxf 插件的 grails 项目部署到 WAS 8 时遇到问题

> ID：13482271
> 
> 赞同：2
> 
> 时间：2012-11-20T21:15:20.143
> 
> 标签：cxf, websphere-8, grails-2.1

我对**groovy/grails**相当陌生，并尝试将使用**Grails 2.1.1**和**CXF 插件 1.0.1的****grails**应用程序（WAR 文件）部署到**WebSphere 8**。

 ******这是我第一次使用基于 SOAP 的 Web 服务的 CXF 插件将**Grails 2.1.1**应用程序部署到**WebSphere 8 ，我遇到了一些问题。****相同的应用程序在Tomcat**上本地部署和工作正常，我能够访问我的 Web 服务并访问 WSDL 文件。

任何人都有这个问题或知道可能是什么问题，请帮助。这是堆栈跟踪：

```
Original Exception:

Error Message: javax.servlet.ServletException: Filter [sitemesh]: could not be initialized
Error Code: 500
Target Servlet: CxfServlet
Error Stack: 
com.opensymphony.module.sitemesh.factory.FactoryException: Could not initialize DecoratorMapper : org.codehaus.groovy.grails.web.sitemesh.GrailsLayoutDecoratorMapper: org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'groovyPageLayoutFinder' is defined 
     at com.opensymphony.module.sitemesh.factory.BaseFactory.pushDecoratorMapper(BaseFactory.java:117) 
     at org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.loadDecoratorMappers(Grails5535Factory.java:231) 
     at org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.loadConfig(Grails5535Factory.java:98) 
     at org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.<init>(Grails5535Factory.java:66) 
     at org.codehaus.groovy.grails.web.sitemesh.GrailsPageFilter.init(GrailsPageFilter.java:83) 
     at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.init(FilterInstanceWrapper.java:145) 
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager._loadFilter(WebAppFilterManager.java:568) 
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.loadFilter(WebAppFilterManager.java:475) 
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.getFilterInstanceWrapper(WebAppFilterManager.java:308) 
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.getFilterChain(WebAppFilterManager.java:380) 
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:892) 
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1025) 
     at com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:3704) 
     at com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:304) 
     at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:962) 
     at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1662) 
     at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:195) 
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:452) 
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewRequest(HttpInboundLink.java:511) 
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.processRequest(HttpInboundLink.java:305) 
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.ready(HttpInboundLink.java:276) 
     at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.sendToDiscriminators(NewConnectionInitialReadCallback.java:214) 
     at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.complete(NewConnectionInitialReadCallback.java:113) 
     at com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165) 
     at com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyncFuture.java:217) 
     at com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncChannelFuture.java:161) 
     at com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138) 
     at com.ibm.io.async.ResultHandler.complete(ResultHandler.java:204) 
     at com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:775) 
     at com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:905) 
     at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1659) 
     Root cause: 
     org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'groovyPageLayoutFinder' is defined 
     at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanDefinition(DefaultListableBeanFactory.java:553) 
     at org.springframework.beans.factory.support.AbstractBeanFactory.getMergedLocalBeanDefinition(AbstractBeanFactory.java:1095) 
     at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:277) 
     at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197) 
     at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1102) 
     at org.codehaus.groovy.grails.web.sitemesh.GrailsLayoutDecoratorMapper.init(GrailsLayoutDecoratorMapper.java:48) 
     at com.opensymphony.module.sitemesh.factory.BaseFactory.pushDecoratorMapper(BaseFactory.java:110) 
     at org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.loadDecoratorMappers(Grails5535Factory.java:231) 
     at org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.loadConfig(Grails5535Factory.java:98) 
     at org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.<init>(Grails5535Factory.java:66) 
     at org.codehaus.groovy.grails.web.sitemesh.GrailsPageFilter.init(GrailsPageFilter.java:83) 
     at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.init(FilterInstanceWrapper.java:145) 
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager._loadFilter(WebAppFilterManager.java:568) 
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.loadFilter(WebAppFilterManager.java:475) 
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.getFilterInstanceWrapper(WebAppFilterManager.java:308) 
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.getFilterChain(WebAppFilterManager.java:380) 
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:892) 
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1025) 
     at com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:3704) 
     at com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:304) 
     at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:962) 
     at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1662) 
     at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:195) 
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:452) 
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewRequest(HttpInboundLink.java:511) 
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.processRequest(HttpInboundLink.java:305) 
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.ready(HttpInboundLink.java:276) 
     at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.sendToDiscriminators(NewConnectionInitialReadCallback.java:214) 
     at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.complete(NewConnectionInitialReadCallback.java:113) 
     at com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165) 
     at com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyncFuture.java:217) 
     at com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncChannelFuture.java:161) 
     at com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138) 
     at com.ibm.io.async.ResultHandler.complete(ResultHandler.java:204) 
     at com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:775) 
     at com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:905) 
     at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1659)  a 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:01:21.467

尝试将以下内容添加到您的*BuildConfig.groovy*以排除 JAXB 实现和 Apache 序列化程序相关库。

```
grails.project.dependency.resolution = {
    // inherit Grails' default dependencies
    inherits("global") {
            excludes ("serializer", "jaxb-impl")
    }
...
} 
```

然后重建你的战争，看看它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:54:18.043

如果在 Tomcat 上一切正常，这听起来像是与 IBM Websphere 的库冲突。

请务必**最后将类加载器配置为 Parent**，以便您的应用程序将覆盖 WAS 库。******

# c# - 如何在进度条控件中显示字符串 C#

> ID：13482286
> 
> 赞同：0
> 
> 时间：2012-11-20T21:16:12.950
> 
> 标签：c#, wpf, wpf-controls, progress-bar

我正在为我的 GUI 使用 C# 和 WPF。我的目标是在我从文本框中获得的进度条中显示一个字符串。我希望每 200 毫秒显示 1 个字符，以便字符串动画完成。如何在 WPF 的进度条中显示字符串以及如何为它的显示设置动画？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:22:44.617

你试过`Text`房产吗？

[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.progressbar.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:26:37.823

您可以对 进行子类化`ProgressBar`，添加一个`Text`依赖属性，然后为其创建一个模板，该模板将包含一个使用转换器绑定到该`Text`属性的 TextBox，该转换器将返回一个基于 的子字符串`Value`（`ProgressBar`或者您可以只在类本身中处理它） .

或者，有多种方法可以通过在文本块上覆盖带有渐变画笔的矩形来伪造它。无论您的背景颜色是什么，画笔都应该从透明变为不透明，并且渐变的位置与进度条的值相关联。

这是一个真正快速而肮脏的伪造示例：

```
<Grid>
    <ProgressBar Name="MyBar" Minimum="0" Maximum="1" Value="0.6">

    </ProgressBar>

    <Grid>
        <TextBlock>Some Text that will be covered depending on the value of the progress bar</TextBlock>
        <Rectangle>
            <Rectangle.Fill>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Offset="0" Color="Transparent"/>
                    <GradientStop Offset="{Binding ElementName=MyBar, Path=Value}" Color="Transparent"/>
                    <GradientStop Offset="{Binding ElementName=MyBar, Path=Value}" Color="White"/>
                    <GradientStop Offset="1" Color="White"/>
                </LinearGradientBrush>
            </Rectangle.Fill>
        </Rectangle>
    </Grid>
</Grid> 
```

如果您弄乱了 ProgressBar 的值，您将在渐变画笔中移动透明和不透明之间的过渡。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:38:24.127

订阅 ProgressChanged 但不要使用 ProgressBar。只需使用新文本更新 TextBox。

# jquery - 目录/文件夹名称如何影响页面呈现？

> ID：13482290
> 
> 赞同：3
> 
> 时间：2012-11-20T21:16:25.670
> 
> 标签：jquery, html, css, firefox, dreamweaver

文件夹/文件的名称如何影响 Firefox v16.0.2 中页面呈现客户端宽度的方式？

我使用 CSS、jQuery、HTML 和 notepad++ 作为我的编辑器在本地开发了一个网站。我还必须在站点测试、CMS 和生产部署期间使用 Dreamweaver (DW)。使用 DW 是该项目不可协商的方面，但该站点将在一两年内从 DW 迁移，因此 DW 集成应该是最小的。我怀疑问题出在 DW 上，但我需要帮助来根除它。

问题是主页，只有主页，根据文件夹的名称呈现不同。*从名为siteBeta*的顶级目录打开主页时，页面呈现的宽度小于应有的宽度。如果我将*siteBeta*的全部内容复制到具有任何其他名称的文件夹中，请重命名*siteBeta*文件夹，或重命名页面正确呈现的 homepage.html 文档。

我偷偷怀疑某处存在隐藏文件或文件关联，但我找不到它。

当然，简单的解决方案是重命名文件/文件夹，这是我现在正在学习的课程，但它让我对为什么会发生这种情况感到疯狂。

我已经仔细研究了正确呈现的页面和 firebug 中不正确呈现的页面的输出。滚动浏览布局、计算输出和 DOM 元素的所有方面。我能找到的唯一区别是页面的宽度属性（clientWidth、offsetWidth 等）。

删除 CSS 引用、删除 jQuery 引用以及删除所有引用时会出现此缺陷。唯一不变的是*siteBeta* /homeTab/homePage.html 使客户端宽度比其他所有页面窄约 100 像素。如果通过 dw 在浏览器中打开，或者通过直接在浏览器中打开文件，则会发生这种情况。

真正的问题是 IE8 没有正确呈现 clientWidth 的问题。

我很乐意提供所需的任何其他信息，并提前感谢您的时间以及您可能提供的任何提示或方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:25:32.747

听起来您对相对路径有疑问？

也许尝试使用 Fiddler 来查看是否找不到某些 css 引用。

否则它可能会缓存所以仔细检查..

*   相对路径
*   提琴手
*   缓存

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T19:43:00.647

我的问题的答案是我在某些时候使用了页面缩放 (Ctrl+/-)，并且它一直存在。我觉得错过这么简单的东西很傻。

@Boris [Zbarsky](https://stackoverflow.com/users/720912/boris-zbarsky)，感谢您提出此修复建议。我真的很感激。

# java - Java - 在 Eclipse 中运行的 Boilerpipe 对于演示程序无法正常工作

> ID：13482295
> 
> 赞同：0
> 
> 时间：2012-11-20T21:16:38.690
> 
> 标签：java, eclipse, boilerpipe

所以我在eclipse中运行boilerpipe。我只是想让它工作，这是代码..

```
package de.l3s.boilerpipe.demo;

import java.net.URL;
import de.l3s.boilerpipe.extractors.DefaultExtractor;

public static void main(final String[] args) throws Exception {
URL url;
url = new URL("http://religion.blogs.cnn.com/2012/11/16/my-take-113th-congress-looks-like-old-america/?hpt=hp_c3");

final InputStream urlStream = url.openStream();
final InputSource is = new InputSource(urlStream);

final BoilerpipeSAXInput in = new BoilerpipeSAXInput(is);
final TextDocument doc = in.getTextDocument();
urlStream.close();

System.out.println(DefaultExtractor.INSTANCE.getText(doc));
//System.out.println(ArticleExtractor.INSTANCE.getText(doc));
} 
```

我不确定我是否在 Eclipse 中正确设置它，但我的控制台只是说...

```
SAX features:
http://xml.org/sax/features/namespaces
http://xml.org/sax/features/namespace-prefixes
http://xml.org/sax/features/string-interning
http://xml.org/sax/features/validation
http://xml.org/sax/features/external-general-entities
http://xml.org/sax/features/external-parameter-entities 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:29:44.450

我以前从未听说过 Boilerpipe，所以如果这不是它的工作原理，请原谅我，但您的代码是否还需要在类中？

您的主要方法（实际上是您的所有代码）不在一个类中 - 或者 Boilerplate 是否使 java 的工作方式非常不同？

# php - 使用 PHP mysqli 进行灵活的“INSERT INTO”查询的方法？

> ID：13482299
> 
> 赞同：2
> 
> 时间：2012-11-20T21:16:59.873
> 
> 标签：php, mysql, mysqli

好的，这会有点复杂。

但是现在我正在使用一个自制函数来创建一个查询，用于创建将页面插入到数据库中。

我想知道是否有更聪明的方法来做一个灵活的“插入”方法。

问题是我有一些字段在创建页面时是可选的，所以现在我正在使用它，我正在运行所有字段并检查它们是否已设置。：

```
//creates an Array which can be used to make a MySQL query
function createQueryArray($new) {
    if (isset($this->users_id))
        $this->query_array['users_id'] = mysql_real_escape_string($this->users_id);
    if (isset($this->pagename))
        $this->query_array['pagename'] = mysql_real_escape_string($this->pagename);
    if (isset($this->seo_pagetitle))
        $this->query_array['seo_pagetitle'] = mysql_real_escape_string($this->seo_pagetitle);
    if (isset($this->seo_description))
        $this->query_array['seo_description'] = mysql_real_escape_string($this->seo_description);
    if (isset($this->seo_keywords))
        $this->query_array['seo_keywords'] = mysql_real_escape_string($this->seo_keywords);
    if (isset($this->seo_robots))
        $this->query_array['seo_robots'] = mysql_real_escape_string($this->seo_robots);
    if (isset($this->seo_canonical))
        $this->query_array['seo_canonical'] = mysql_real_escape_string($this->seo_canonical);
    if (isset($this->type))
        $this->query_array['page_type'] = mysql_real_escape_string($this->type);
    //$this->query_array['last_edited'] = date("Y-m-d H:i:s");
} 
```

之后我用数组和表调用这个函数，我想将页面插入：

```
function createInsertStm($arr, $table) {
    $mysqlQuery = ("INSERT INTO $table (");
    $insert = "";
    $values = "";
    if (is_array($arr))
        foreach ($arr as $key => $value) {
            if ($insert == "")
                $insert .= $key;
            else
                $insert .= ', ' . $key;
            if ($values == "")
                $values .= (preg_match('/(MAX\(id\))(.*?)/', $value)) ? $value : '"' . $value . '"';
            else
                $values .= (preg_match('/(MAX\(id\))(.*?)/', $value)) ? "," . $value : ',"' . $value . '"';
        }
    $mysqlQuery .= $insert;
    $mysqlQuery .= ') VALUES (';
    $mysqlQuery .= $values;
    $mysqlQuery .= ')';
    return $mysqlQuery;
}

$db->query($queryArray["pages"]); 
```

是否可以使用准备好的语句然后跳过一些字段或类似的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:20:57.213

如果您在表定义中设置了默认值，则可以在插入时省略该值。

查看以下页面以获取有关默认值的更多信息：

[http://dev.mysql.com/doc/refman/5.0/en/data-type-defaults.html](http://dev.mysql.com/doc/refman/5.0/en/data-type-defaults.html)

# delphi - 为什么我的表单在文件被丢弃时没有收到 WM_DropFiles？

> ID：13482304
> 
> 赞同：7
> 
> 时间：2012-11-20T21:17:22.510
> 
> 标签：delphi, drag-and-drop

我正在使用 Embarcadero RAD Studio XE 开发应用程序。我正在尝试使用以下代码将文件拖放到应用程序中

```
TMainForm = class(TForm)
public:
  procedure WMDropFiles(var Msg: TWMDropFiles); message WM_DROPFILES;
end;

procedure TMainForm.FormCreate(Sender: TObject);
begin
  DragAcceptFiles(Self.Handle, True);
end;

procedure TMainForm.FormDestroy(Sender: TObject);
begin
  DragAcceptFiles(Self.Handle, False);
end;

procedure TMainForm.WMDropFiles(var Msg: TWMDropFiles);
begin
  inherited;
  showmessage('catch here');
  // some code to handle the drop files here
  Msg.Result := 0;
end; 
```

这段代码没有问题。另外，当我拖放文件时，光标显示状态更改为拖放，但在拖放后，什么也没有发生（也没有显示消息）。这有什么问题吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-07-20T08:14:26.727

在`TForm.Create`使用两条线

```
ChangeWindowMessageFilter (WM_DROPFILES, MSGFLT_ADD);

ChangeWindowMessageFilter (WM_COPYGLOBALDATA, MSGFLT_ADD); 
```

就这样

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-20T21:45:01.713

在一个普通的 vanilla 应用程序中，问题中的代码导致在`WMDropFiles`将对象放在表单上时执行。因此，显然还有其他事情发生以阻止它工作。最明显的潜在原因是：

1.  主窗体的窗口句柄在初始调用后重新创建`DragAcceptFiles`。
2.  您的进程运行的完整性级别高于在其上删除文件的进程。例如，您是否以管理员身份运行进程。请注意，以管理员身份运行 Delphi IDE 会导致您的进程在从 IDE 启动时以管理员身份运行。
3.  您的过程中的其他东西正在干扰拖放。在不知道您的应用程序中有什么的情况下，很难猜测这可能是什么。开始删除应用程序的某些部分，直到只剩下问题中的代码。

选项 2 似乎很合理。要了解更多信息，请参阅：[问：为什么当我的应用程序运行提升时拖放不起作用？– A：强制性完整性控制和 UIPI](http://patrickablog.azurewebsites.net/index.php/2010/01/28/q-why-doesnt-drag-and-drop-work-when-my-application-is-running-elevated-a-mandatory-integrity-control-and-uipi/)

# google-apps-script - Google 应用程序脚本错误“UrlFetch 失败，因为发送到指定 URL 的流量过多。”

> ID：13482309
> 
> 赞同：1
> 
> 时间：2012-11-20T21:18:08.363
> 
> 标签：google-apps-script

我找不到有关此错误的任何信息。该脚本今天早些时候工作，我需要每天运行它以将文件加载到 salesforce。这是谷歌限制，我该如何克服？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:55:07.803

[在此处](https://script.google.com/dashboard)查看配额限制（单击配额选项卡）。

请参阅底部的 UrlFetch 的前两个每日限制。

为了为所有用户保持系统的保真度，对于单个用户/脚本可以调用多少 UrlFetch 有一些已发布的限制。

# android - 如何与 Gmail 客户端共享内部存储文件

> ID：13482310
> 
> 赞同：9
> 
> 时间：2012-11-20T21:18:06.907
> 
> 标签：android, android-intent, gmail, android-contentprovider

我正在尝试通过我的 Moto Razr 上的 Gmail 客户端共享我的内部存储文件，但是每次我发送到我的测试 gmail 帐户时，我都得到了除附件之外的所有内容。

这就是我调用和启动 gmail 的方式，同时将文件添加为附件。

```
private void saveDaily() {
Intent intent = new Intent(android.content.Intent.ACTION_SEND_MULTIPLE);
intent.setType("text/plain");

intent.putExtra(Intent.EXTRA_EMAIL, new String[] { loadEmailAddress() });
intent.putExtra(Intent.EXTRA_SUBJECT, "Daily");
intent.putExtra(Intent.EXTRA_TEXT, "Daily Log");
intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);

ArrayList<Uri> uris = new ArrayList<Uri>();
uris.add(saveDaily2File("dailyRecord.txt"));
Log.d(TAG_D, "Size: " + uris.size());
intent.putParcelableArrayListExtra(Intent.EXTRA_STREAM, uris);
startActivity(Intent.createChooser(intent, "Send email"));
} 
```

这就是我实现自定义内容提供程序的方式。

```
public class SavedFileProvider extends ContentProvider {

private static final String TAG_D = "ContentProvider";
private static final HashMap<String, String> MIME_TYPES = new HashMap<String, String>();

static {
MIME_TYPES.put(".txt", "text/plain");
}

@Override
public String getType(Uri uri) {
String path = uri.toString();

for (String extension : MIME_TYPES.keySet()) {
    if (path.endsWith(extension)) {
    return (MIME_TYPES.get(extension));
    }
}

return (null);
}

@Override
public ParcelFileDescriptor openFile(Uri uri, String mode)
    throws FileNotFoundException {
Log.d(TAG_D, "openFile()");

File f = new File(getContext().getFilesDir(), uri.getPath());

Log.d(TAG_D, f.getAbsolutePath());
if (f.exists()) {
    return (ParcelFileDescriptor.open(f,
        ParcelFileDescriptor.MODE_READ_ONLY));
}

throw new FileNotFoundException(uri.getPath());
}

@Override
public Cursor query(Uri url, String[] projection, String selection,
    String[] selectionArgs, String sort) {
throw new RuntimeException("Operation not supported");
}

@Override
public Uri insert(Uri uri, ContentValues initialValues) {
throw new RuntimeException("Operation not supported");
}

@Override
public int update(Uri uri, ContentValues values, String where,
    String[] whereArgs) {
throw new RuntimeException("Operation not supported");
}

@Override
public int delete(Uri uri, String where, String[] whereArgs) {
throw new RuntimeException("Operation not supported");
}

private void copy(InputStream in, File dst) throws IOException {
FileOutputStream out = new FileOutputStream(dst);
byte[] buf = new byte[1024];
int len;

while ((len = in.read(buf)) > 0) {
    out.write(buf, 0, len);
}

in.close();
out.close();
}

@Override
public boolean onCreate() {
Log.d(TAG_D, "onCreate()");
File f = new File(getContext().getFilesDir(), "dailyRecord.txt");

if (!f.exists()) {
    AssetManager assets = getContext().getResources().getAssets();

    try {
    copy(assets.open("dailyRecord.txt"), f);
    } catch (IOException e) {
    Log.e("FileProvider", "Exception copying from assets", e);

    return (false);
    }
}
return (true);
} 
```

}

然后，我在我的 AndroidManifest.xml 文件中添加以下行。

```
<provider
        android:name=".SavedFileProvider"
        android:authorities="Package Path here"
        android:exported="true"
        android:grantUriPermissions="true"
        android:multiprocess="true" >
</provider> 
```

我想知道我在这里缺少什么。

我检查了链接：[Link1](https://github.com/commonsguy/cw-advandroid/blob/master/ContentProvider/Files/src/com/commonsware/android/cp/files/FileProvider.java)，[Link2](https://stackoverflow.com/questions/12170386/create-and-share-a-file-from-internal-storage)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T12:31:35.433

我用这个：

AndroidManifest.xml

```
<provider android:name="com.myapp.main.MyContentProvider" android:authorities="com.myapp.main"></provider> 
```

按钮点击：

```
 public void onClick(View v) {

            List<Intent> targetedShareIntents = new ArrayList<Intent>();
             Intent shareIntent = new Intent(Intent.ACTION_SEND);
             shareIntent.setType("image/jpg");
             Uri theUri = Uri.parse("content://com.myapp.main/"+srcImage);
             List<ResolveInfo> resInfo = getPackageManager().queryIntentActivities(shareIntent, 0);
             int i=0;
             List<ResolveInfo> reInfoToDelete = new ArrayList<ResolveInfo>();
             if (!resInfo.isEmpty()){
                    for (ResolveInfo resolveInfo : resInfo) {
                        String packageName = resolveInfo.activityInfo.packageName;
                        Intent targetedShareIntent = new Intent(android.content.Intent.ACTION_SEND);
                        targetedShareIntent.setType("image/jpg");
                        targetedShareIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "Share file");
                        if (packageName.equals("com.google.android.gm")){
                             targetedShareIntent.setType("image/png");

                             targetedShareIntent.putExtra(Intent.EXTRA_TEXT, "some text");
                             targetedShareIntent.putExtra(Intent.EXTRA_STREAM, theUri);
                             targetedShareIntent.setPackage(packageName);
                             targetedShareIntents.add(targetedShareIntent);

                        }
                    }

                    startActivity(targetedShareIntents.remove(0));
               }
        } 
```

我的内容提供者类

```
 public class MyContentProvider extends ContentProvider implements PipeDataWriter<InputStream>{

    @Override
    public AssetFileDescriptor openAssetFile(Uri uri, String mode) throws FileNotFoundException {
        //Adapt this to your code
        AssetManager am = getContext().getAssets();
        String file_name = "path/"+uri.getLastPathSegment();
        if(file_name == null)
            throw new FileNotFoundException();
        AssetFileDescriptor afd = null;
        try {
            afd = am.openFd(file_name);
        } catch (IOException e) {
            e.printStackTrace();
        }
        return afd;//super.openAssetFile(uri, mode);
    }

    @Override
    public int delete(Uri uri, String selection, String[] selectionArgs) {
        // TODO Auto-generated method stub
        return 0;
    }

    @Override
    public String getType(Uri uri) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public Uri insert(Uri uri, ContentValues values) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public boolean onCreate() {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public Cursor query(Uri uri, String[] projection, String selection,
            String[] selectionArgs, String sortOrder) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public int update(Uri uri, ContentValues values, String selection,
            String[] selectionArgs) {
        // TODO Auto-generated method stub
        return 0;
    }

    public void writeDataToPipe(ParcelFileDescriptor arg0, Uri arg1,
            String arg2, Bundle arg3, InputStream arg4) {
        // Transfer data from the asset to the pipe the client is reading.
        byte[] buffer = new byte[8192];
        int n;
        FileOutputStream fout = new FileOutputStream(arg0.getFileDescriptor());
        try {
            while ((n=arg4.read(buffer)) >= 0) {
                fout.write(buffer, 0, n);
            }
        } catch (IOException e) {
            Log.i("InstallApk", "Failed transferring", e);
        } finally {
            try {
                arg4.close();
            } catch (IOException e) {
            }
            try {
                fout.close();
            } catch (IOException e) {
            }
        }
    }
} 
```

# python - 按值排序元组列表，然后按字母顺序

> ID：13482313
> 
> 赞同：5
> 
> 时间：2012-11-20T21:18:19.683
> 
> 标签：python, list, sorting, import, tuples

有点python新手，但我得到了以下元组列表。我需要按值对其进行排序，如果值相同，请按字母顺序解决关系。这是一个示例：

```
#original
list_of_medals = [('Sweden', 24), ('Germany', 16), ('Russia', 10), ('Ireland', 10), ('Spain', 9), ('Albania', 8), ('Lithuania', 7), ('Iceland', 6), ('Malta', 5), ('Italy', 5), ('Serbia', 4), ('Estonia', 4), ('Turkey', 4), ('Moldova', 2), ('Azerbaijan', 2)]
#                                                              \____/                                                                                                                      \_____/                                         \______/
#after sorting                                                 /    \                                                                                                                      /     \                                         /      \
sorted_medals  = [('Sweden', 24), ('Germany', 16), ('Ireland', 10), ('Russia', 10), ('Spain', 9), ('Albania', 8), ('Lithuania', 7), ('Iceland', 6), ('Malta', 5), ('Italy', 5), ('Estonia', 4), ('Serbia', 4), ('Turkey', 4), ('Azerbaijan', 2), ('Moldova', 2)] 
```

`operator`模块可能吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-20T21:21:31.477

在这种情况下，我将使用 lambda 函数作为/的`key`参数：`sort()``sorted()`

```
In [59]: sorted(list_of_medals, key=lambda x:(-x[1],x[0]))
Out[59]: 
[('Sweden', 24),
 ('Germany', 16),
 ('Ireland', 10),
 ('Russia', 10),
 ('Spain', 9),
 ('Albania', 8),
 ('Lithuania', 7),
 ('Iceland', 6),
 ('Italy', 5),
 ('Malta', 5),
 ('Estonia', 4),
 ('Serbia', 4),
 ('Turkey', 4),
 ('Azerbaijan', 2),
 ('Moldova', 2)] 
```

需要否定才能*按降序*`x[1]`对奖牌进行排序，而*按升序*对国家名称进行排序（简单地设置不会实现）。**`reverse=True`**

 **正如一些人在评论中指出的那样，对复合键进行复杂排序的更一般的方法是执行几个排序步骤。为此，一次对一个组件进行排序，从最不重要的组件开始：

```
In [67]: temp = sorted(list_of_medals, key=itemgetter(0))

In [68]: sorted(temp, key=itemgetter(1), reverse=True)
Out[68]: 
[('Sweden', 24),
 ('Germany', 16),
 ('Ireland', 10),
 ('Russia', 10),
 ... 
```

这依赖于 Python 的排序是稳定的这一事实，这意味着比较相等的项目永远不会重新排序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T21:21:49.727

您可以使用以下`sorted`功能：

```
sorted_by_medals = sorted(list_of_medals, key=lambda tup: (-tup[1], tup[0])) 
```**

# maven - maven 如何包含 /src/main/resources

> ID：13482314
> 
> 赞同：8
> 
> 时间：2012-11-20T21:18:19.370
> 
> 标签：maven, resources

我有一个带有 jar 包装的 mavenized 项目，具有标准布局：

```
/src/main/java
/src/main/resources 
```

当我执行时：`mvn package`

我期望生成的 jar（非执行）文件包含资源文件夹以及项目中该文件夹内的所有内容（即一些 xml 文件），但是当我打开 jar 文件时，我只看到 com 文件夹的位置和内容顶层的资源文件夹...

我认为以上是 maven3 的默认设置，但我想将`resources`文件夹包含在 jar 文件中......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-20T22:08:09.967

您不会`src/main/resources`在生成的 jar 文件中看到。

您只会看到`src/main/resources`jar 文件中的内容。

因此，如果您没有为资源文件创建包结构并将所有内容转储到`src/main/resources`目录中，您将在 jar 的顶层看到资源文件。

如果您希望您的资源出现在生成的 jar 文件中的某个目录下，请在`src/main/resources`树下创建这样的目录。

# nuget - 下载没有 VS/NuGet 包管理器的 Nuget 包

> ID：13482319
> 
> 赞同：31
> 
> 时间：2012-11-20T21:18:46.313
> 
> 标签：nuget, nuget-package, repository

如何在 Visual Studio 之外下载 NuGet 包？所以它可以用来创建离线包。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-20T21:18:46.313

**如何在没有 Visual Studio 或 Nuget 包管理器的情况下下载 NuGet 包：**

1.  [在NuGet 官方网站](http://packages.nuget.org/packages)上搜索您想要的包。

2.  复制软件包页面 URL 的末尾。例如： http: [//nuget.org/packages/EntityFramework](http://nuget.org/packages/EntityFramework) => 包名是*“EntityFramework”*

3.  输入 URL：[http ://packages.nuget.org/api/v1/package/](http://packages.nuget.org/api/v1/package/) **{Package Name}** 例如：[http ://packages.nuget.org/api/v1/package/EntityFramework](http://packages.nuget.org/api/v1/package/EntityFramework)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-07T12:08:36.303

您可以使用以下方法在 Visual Studio 之外下载 NuGet 包：

[NuGet 包资源管理器](https://github.com/NuGetPackageExplorer/NuGetPackageExplorer/releases)

> NuGet 包资源管理器是一个 ClickOnce 应用程序，它允许轻松创建和探索 NuGet 包。安装后，您可以双击 .nupkg 文件查看包内容。您还可以直接从官方 NuGet 源加载包。

从在线提要打开一个包：

[![在此处输入图像描述](../Images/d76e4ac6b9ddf27ea98b640fe1c61ea2.png)](https://i.stack.imgur.com/fkFAN.png)

[![在此处输入图像描述](../Images/4b6d8f25e184afc463b132330ee418c4.png)](https://i.stack.imgur.com/CWKfa.png)

并将包导出到所需位置：

[![在此处输入图像描述](../Images/0053b3d7b7d9042ecb561071d25664c0.png)](https://i.stack.imgur.com/nkbAs.png)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-11-27T09:35:28.727

[安装 NuGet 命令行程序](http://docs.nuget.org/consume/command-line-reference#installing)：

> NuGet 命令行可以通过几种可能的方式安装到计算机上。
> 
> 1.  [从https://dist.nuget.org/win-x86-commandline/latest/nuget.exe](https://dist.nuget.org/win-x86-commandline/latest/nuget.exe)直接下载可执行文件。可执行文件可以放置在文件系统的任何位置，并且在大多数情况下应该放置在 PATH 环境变量中列出的目录中。
> 2.  从 NuGet Visual Studio 客户端安装 NuGet.CommandLine 包，然后将 nuget.exe 移动到公共位置或在项目的上下文中执行它。
> 3.  使用 Chocolatey 客户端安装 NuGet.CommandLine Chocolatey 包。有关 Chocolatey 的更多信息，请访问 [ [http://chocolatey.org]](http://chocolatey.org])。

然后运行`nuget install package`下载安装`package`到当前目录。

有关 NuGet 命令行程序的更多信息：

*   [命令行参考](http://docs.nuget.org/consume/command-line-reference)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-01-28T01:51:28.480

Chrome 插件“NuTake”提供了直接下载链接。

将扩展名重命名为 .zip 并解压

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-08T21:28:53.497

[您可以使用-vnuget.org](http://vnuget.org)下载 nuget 包。

在此网站上，您还可以查看 nuget 包的内容 - [http://vnuget.org/packages/Microsoft.AspNet.Mvc/5.2.3](http://vnuget.org/packages/Microsoft.AspNet.Mvc/5.2.3)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-05-18T14:04:28.207

以下是一些可以添加到 DeePak 答案的示例：

这个从 NuGet.org 下载 AutoMapper

```
nuget.exe install AutoMapper  -OutputDirectory c:\Temp\LotsOfPackages -Version 6.2.2 
```

这个从内部 TFS Nuget 提要下载 MyCustomPackage

```
nuget.exe install MyCustomPackage  -OutputDirectory c:\Temp\LotsOfPackages -Source "http://tfs.myCompany.com:8080/tfs/TFSArea/_packaging/FeedName/nuget/v3/index.json" -Version 1.0.0.2 
```

笔记

*   请记住，安装命令将获取相关包及其所有 NuGet 依赖项。所以，小心把它转储到你运行的目录中。因此，我将 OutputDirectory 添加到命令中。
*   对于内部 Nuget 包/提要，源 URL 可通过 TFS 获得。转到您的包裹选项卡并找到您的特定提要 URL。如果它有任何已用 %20 编码的空格，则需要将它们替换为空格。
*   [CLI 命令参考](https://docs.microsoft.com/en-us/nuget/tools/cli-ref-install)
*   [将包从一个 NuGet 源复制到另一个](https://blog.myget.org/post/2011/07/15/copy-packages-from-one-nuget-feed-to-another.html)

# ios - 嵌套块变量的命名约定（导致变量阴影警告）

> ID：13482321
> 
> 赞同：1
> 
> 时间：2012-11-20T21:18:49.620
> 
> 标签：ios, coding-style, naming-conventions

只是好奇，在这个例子中：

```
[array1 enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
   [array2 enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
      //
   }];
}]; 
```

重命名内部块变量（obj、idx、stop）以使其不影响外部变量的最佳做法是什么？idx2, stop2 看起来很老套，但有时最有意义（考虑当涉及超过 2 个块时）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:22:59.640

我相信您可以将它们重命名为您喜欢的任何名称：

```
[array1 enumerateObjectsUsingBlock:^(id obj1, NSUInteger idx1, BOOL *stop1) {
   [array2 enumerateObjectsUsingBlock:^(id obj2, NSUInteger idx2, BOOL *stop2) {
       //
   }];
}]; 
```

并不是说简单地在末尾附加一个数字是所需的解决方案，而只是表明您可以随意命名这些参数。您不必坚持为您提供示例 XCode 存根。

# javascript - CSS3 边框半径到 HTML5 画布

> ID：13482322
> 
> 赞同：7
> 
> 时间：2012-11-20T21:18:49.670
> 
> 标签：javascript, css, canvas

我试图在画布中重现 CSS3 边框半径。

画圆角矩形很容易，但在 CSS 中，每个边框的值可能很高。

例如：
**HTML**

```
<div class="normal_radius"></div>
<div class="high_radius"></div>
<div class="high2_radius"></div> 
```

**CSS**

```
div { height:50px;width:50px;position:absolute;top:10px; }
.normal_radius {
    border: 1px solid black;
    border-radius: 5px 5px 10px 15px;
    left: 10px;
}
.high_radius {
    border: 1px solid red;
    border-radius: 5000px 500px 100px 150px;
    left: 80px;
}
.high2_radius {
    border: 1px solid blue;
    border-radius: 2500px 250px 50px 75px;
    left: 160px;
} 
```

这是一个[jsfiddle](http://jsfiddle.net/fAJ9t/)

黑色的正常边界半径值，我可以重现。边界半径的红色高值，我不知道如何重现。蓝色，高值除以 2，与红色的结果相同。

我的问题很简单，如何在画布中重现红色和蓝色？

最好的祝福。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T02:55:45.443

下面的函数非常接近。尽管如果您使用大于宽度和高度的值，您将会遇到问题。

**[现场演示](http://jsfiddle.net/fAJ9t/74/)**

```
function canvasRadius(x, y, w, h, tl, tr, br, bl){
  var r = x + w,
      b = y + h;

  ctx.beginPath();
  ctx.moveTo(x+tl, y);
  ctx.lineTo(r-(tr), y);
  ctx.quadraticCurveTo(r, y, r, y+tr);
  ctx.lineTo(r, b-br);
  ctx.quadraticCurveTo(r, b, r-br, b);
  ctx.lineTo(x+bl, b);
  ctx.quadraticCurveTo(x, b, x, b-bl);
  ctx.lineTo(x, y+tl);
  ctx.quadraticCurveTo(x, y, x+tl, y);
  ctx.stroke();

}

canvasRadius(10,10,50,50,5,5,10,15);
ctx.strokeStyle = "red";
canvasRadius(80,10,50,50,47,3,0,0);
ctx.strokeStyle = "blue";
canvasRadius(160,10,50,50,47,3,0,0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:37:44.807

这里的解决方案：

```
CanvasRenderingContext2D.prototype.roundRect=function(x,y,width,height,tl,tr,br,bl) {
  var x1,x2,x3,x4,y1,y2,y3,y4,radii,ratio=0,CURVE2KAPPA=0.5522847498307934;
  ratio=Math.min(Math.min(width/(tl+tr),width/(br+bl)),Math.min(height/(tl+bl),height/(tr+br)));
  if ((ratio>0)&&(ratio<1)) {
    tl*=ratio;
    tr*=ratio;
    bl*=ratio;
    br*=ratio;
  }
  xw=x+width;
  yh=y+height;
  x1=x+tl;
  x2=xw-tr;
  x3=xw-br;
  x4=x+bl;
  y1=y+tr;
  y2=yh-br;
  y3=yh-bl;
  y4=y+tl;
  this.beginPath();
  this.moveTo(x1,y);
  this.lineTo(x2,y);
  radii=CURVE2KAPPA*tr;
  this.bezierCurveTo(x2+radii,y,xw,y1-radii,xw,y1);
  this.lineTo(xw,y2);
  radii=CURVE2KAPPA*br;
  this.bezierCurveTo(xw,y2+radii,x3+radii,yh,x3,yh);
  this.lineTo(x4,yh);
  radii=CURVE2KAPPA*bl;
  this.bezierCurveTo(x4-radii,yh,x,y3+radii,x,y3);
  this.lineTo(x,y4);
  radii=CURVE2KAPPA*tl;
  this.bezierCurveTo(x,y4-radii,x1-radii,y,x1,y);
  this.stroke();
}

ctx.roundRect(0,0,50,50,5,5,10,15);
ctx.strokeStyle="red";
ctx.roundRect(0,0,50,50,5000,500,100,150);
ctx.strokeStyle="blue";
ctx.roundRect(0,0,50,50,2500,250,50,75); 
```

**[现场演示](http://jsfiddle.net/Gy9Ed/1/)**

玩得开心。

# windows - “我们无法获得您的 Windows 8 开发人员许可证”，错误 0xC03F1014

> ID：13482327
> 
> 赞同：4
> 
> 时间：2012-11-20T21:19:17.123
> 
> 标签：windows

每当我尝试在带有 WMC for Visual Studio Ultimate with Blend 的 Windows 8 Professional 中获取我的开发人员许可证时，我都会收到此错误：

> 我们无法获得您的 Windows 8 开发人员许可证。（错误 0xC03F1014）

如何修复此错误以获取我的开发人员许可证？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T10:34:15.177

如果您的 Windows 8 副本被非法破解或激活，您将收到此错误。

如果出于某种原因您不想/无法获得合法副本，则停用破解以返回试用期，获取许可证然后重新激活它应该可以解决此问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T09:26:18.087

尝试按照以下步骤操作：

1.  在 Windows 8 中创建一个临时用户帐户
2.  安装 VS 2012 的新副本

现在再试一次。它现在应该可以工作了，然后再次注销并返回到您的正常帐户。现在开发应用程序并进行部署。希望它对你有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-04T12:16:22.167

**您无需重新安装操作系统或 Visual Studio**

启动任务计划程序服务。这通常在企业/大型组织中通过组策略禁用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-31T21:48:45.153

在将 Windows 8 Pro Upgrade 安装为 CLEAN 安装后，这种情况发生在我身上。问题是有效的许可证密钥无法激活，因为以前版本的 windows 没有升级。因为没有正确激活，开发者许可证也不会注册。

以下步骤使我能够激活全新安装：

1.  运行注册表编辑器 (regedit)
2.  找到以下项：HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Setup\OOBE
3.  将“MediaBootInstall”的值从 1 更改为 0
4.  打开提升的命令提示符（以管理员身份运行）
5.  运行以下命令：slmgr -rearm
6.  重启
7.  打开提升的命令提示符（以管理员身份运行）
8.  运行以下命令：slui 3
9.  激活您的有效 Window 8 Pro 升级许可证密钥

在我的 Windows 8 被正确激活后，开发者许可证更新没有问题！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-08T15:28:52.830

我面临同样的问题。错误是由于代理服务器。我通过设置代理服务器使用互联网。你应该有开放的互联网来获得开发者许可证。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-01T19:18:11.030

看到这些类型的错误发生在我身上。场景是我连接到代理服务器，而我的代理服务器不允许弹出登录。检查您的互联网连接，如果问题没有解决，请重新安装 VS

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-10T20:44:12.750

以管理员身份运行 Visual Studio 2012。它应该会自动提示您输入许可证。此时我必须登录到我的 MSDN 帐户。如果没有出现，请转到项目 -> 商店 -> 获取开发者许可证。这就是为我做的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-13T03:02:25.597

我遇到了同样的问题，附加信息表明网络存在问题（即使我的网络很好）。

对我来说，问题是我自己的用户是受限/普通用户，没有管理员权限。当我尝试获取许可证时，我确实收到了 UAC 提示，并且我提升了使用我单独的管理员帐户的过程，但它不起作用。

但是，起作用的是从我的普通用户*注销，**以我的管理员帐户登录*并尝试以这种方式获得开发人员许可证。

因此，显然在非特权用户下运行并不是 VS2013 在这种情况下所欣赏的。我不确定为什么通过 UAC 提升进程的权限与实际以提升的用户身份登录之间存在差异。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-07-07T13:13:49.353

确保您已安装所有 Windows 更新。如果无法更新：

*   **安装 KB2913270（[x86](http://www.microsoft.com/en-us/download/details.aspx?id=41575) / [x64](http://www.microsoft.com/en-us/download/details.aspx?id=41577)）**（[Ahmad Wahid 提供的原始信息](http://www.windows8core.com/microsoft-releases-bug-fixing-update-windows-store-windows-8-1rt-download-now/)，谢谢 :)）

其他提示：

*   检查系统日期和时间（在他们的系统上不能提前）
*   尝试禁用 NlaSvc 服务（网络位置感知）

# java - 浏览器不显示 java 小程序

> ID：13482331
> 
> 赞同：3
> 
> 时间：2012-11-20T21:19:44.127
> 
> 标签：java, html, applet

我刚开始使用 java applet，发现这个网站提供了教程。我输入了所有代码，但小程序没有出现在我的浏览器中：HelloWorld.java

```
import java.applet.*;
import java.awt.*;

public class HelloWorld extends Applet
{
    public void paint (Graphics g)
    {
    g.drawString("Hello World!", 300, 300);
    }
} 
```

这是我的 HTML 文件

```
<HTML>
<HEAD>
<TITLE>Hello World Applet</TITLE>
</HEAD>
<BODY>
<H1>Hello World Applet</H1>
<applet code="HelloWorld.class" WIDTH=300 HEIGHT=300></applet>
</BODY>
</HTML> 
```

我已经编译了 java 文件（HelloWorld.class）并将所有文件保存在我的桌面上。我在 mac osx 山狮上使用最新版本的 safari。我在谷歌浏览器中尝试过，它说要安装一个插件，我做了，但什么也没发生？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T06:49:33.050

（请注意：这些事情发生在 Windows 中，少数发生在 Ubuntu 中。如果以下任何一项适用于您的问题，只需检查以下内容）尝试以下操作：
**1st** - 在 HTML 文件中，将 body 标记更改为：

```
<body bgcolor = red> 
```

因此，如果您发现您提到的尺寸的白色矩形，但您知道您的小程序正在浏览器上运行，但由于浏览器/jre 的一些问题，小程序没有按预期运行。

**第二**- 我们使用的浏览器通常是 32 位浏览器。如果您的浏览器是 32 位版本，请检查您是否安装了 32 位版本的 java。

**3rd** - 要检查您的小程序是否实际创建，请尝试使用终端使用 appletviewer 运行 html 文件。

无论您使用哪种方式，都可以在 cmd/terminal 中运行以下命令：

> 小程序查看器文件名.html

或者，如果您使用的是 eclipse/netbeans，它们通常具有与 IDE 一起集成的 appletViewer，因此它们可以直接运行 appletviewer。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:07:03.813

看起来问题是您的drawstring方法中的x和y坐标与applet的高度和宽度相同，因此在浏览器中呈现时不允许出现文本。

在您的 html 中，将高度和宽度分别更改为（例如）400，您应该会看到文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-30T01:43:48.710

我知道这已经得到了回答，但我认为更好的答案是标签`applet`已被弃用并且`object`应该被使用。

[在此处](https://stackoverflow.com/a/8440896/3625770)查看原始答案

# jquery - 使用 Jquery 解析粘贴的文本（无服务器端处理）

> ID：13482332
> 
> 赞同：0
> 
> 时间：2012-11-20T21:19:44.330
> 
> 标签：jquery, forms, paste, fill, onpaste

我需要一个解决方案来执行以下操作

用户将一些文本粘贴到文本区域
用户单击按钮“自动填充”
按下按钮后，粘贴文本的各行将被放入适当的表单字段中

```
<p>Copy text into box below to propogate fields</p>
<p>First name: <input data-bind='value: firstName' id='f1'/></p> 
<p>Last name: <input data-bind='value: lastName' id='f2' /></p> 
<p>Postcode:  <input data-bind='value: address' id='f3'/></p>
<h2> <span data-bind='text: fullName'> </span></h2>   
<p>Paste here: <textarea rows="10" cols="30">   </textarea> 
<button><a href="#" onclick="">Autofill</a></button> 
```

这是粘贴数据如何格式化的示例。

```
First Name Jimberly  
Last Name Hagg  
Postcode Test 
```

到目前为止，我的小提琴，正如你所看到的，我正在测试其他东西并且在编码过程中，所以我希望它是可以理解的！

[http://jsfiddle.net/hc8kL/1/](http://jsfiddle.net/hc8kL/1/)

顺便说一句，我的 jquery 禁用“继续”按钮是错误的 - 如果您输入一些数据，它可以工作，但是如果您删除它，该功能不会注意到这一点，它仍然保持启用“继续”按钮

# project - TFS 构建，项目文件：对未推送文件的孤立引用导致无休止的构建错误

> ID：13482335
> 
> 赞同：2
> 
> 时间：2012-11-20T21:19:56.300
> 
> 标签：project

我们使用 TFS 2010 (Visual Studio) 进行部署，并拥有客户端代码项目（.csproj 文件）和数据库项目（.dbproj 文件） 我们了解，当我们的开发人员将文件添加到我们的应用程序时，在项目文件。如果我将包含项目文件的变更集从 Dev 推送到 QA，并且项目文件包含对已添加但不在变更集中的文件的引用，我将收到构建错误。

一旦我们开始只推送变更集（而不是执行完整构建），这很快就成为我们进行 TFS 构建的第一大瓶颈。我会部署数据库项目，会出现 20 个错误。我可以纠正它们的唯一方法是向下导航整个解决方案资源管理器树并单独排除每个孤立的引用。事实证明，这太费时了，在我们首席程序员的建议下，我们又回到了进行 QA 和 UAT 的完整构建。

我们处于该产品的早期阶段，因此我们将在一段时间内添加许多文件。我们需要一个更好的解决方案来解决这个问题。手动排除或要求开发人员在代码准备好进行质量检查之前不要签入代码对我们来说已经足够了。有没有人有过这个问题的经验，如果有，你是如何处理的？谢谢！

乔恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T03:54:14.740

有选择地将变更集推送给 QA 被称为挑选樱桃，会导致您遇到的各种问题。这不是推荐的做法，而是设置 Qa 构建，以便成功构建是签入的一部分。这样，如果缺少修复的一部分（因为它可能在多个更改集中），构建将失败并且无法执行签入。

其次，让开发人员对 QA 进行第二次签入或将开发更改集合并到 Qa，并让团队领导通过打开“通知他人所做的更改”或为开发团队设置策略来观察更改来协调对项目文件的更改. 应始终完成完整构建，因为部分并不总是拾取完整的依赖关系图。

# mysql - 如何从具有日期和金额列的表中选择峰值金额日期

> ID：13482337
> 
> 赞同：1
> 
> 时间：2012-11-20T21:20:00.553
> 
> 标签：mysql, sql, date-range

我有一个包含 2 列、日期和金额的表格。我希望能够找到 x 天的数量峰值。因此，如果我有下表并且正在寻找 3 天的峰值，这意味着该日期的金额高于之前或之后 3 天的任何一天，那么将选择该日期。

```
date         amount
2012-09-04 | 53137.47
2012-09-05 | 53137.2
2012-09-06 | 53137.54
2012-09-07 | 53138.58
2012-09-10 | 53138.73
2012-09-11 | 53138.28
2012-09-12 | 53138.22
2012-09-13 | 53138.48
2012-09-14 | 53140.14
2012-09-17 | 53139.82
2012-09-18 | 53139.86
2012-09-19 | 53140.01
2012-09-20 | 53139.75
2012-09-21 | 53139.82
2012-09-24 | 53139.01
2012-09-25 | 53138.93
2012-09-26 | 53138.48
2012-09-27 | 53138.83
2012-09-28 | 53138.62 
```

应该选择2012-09-10、2012-09-14

我曾尝试使用联接和派生表，但似乎无法使其正常工作。

尝试了以下方法：

```
 select * from a WHERE  
amount=(select MAX(amount) from a where 
date<date_add(date,interval 3 day) and 
date>date_sub(date,interval 3 day)); 
```

和

```
 SELECT a1.*
    FROM a AS a1
    JOIN a AS a2 ON 
(select * from a1 where 
a2.DATE < a1.DATE + 3 and 
a2.DATE > a1.DATE - 3) myalias
    WHERE a1.amount > a2.amount; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:57:15.423

为了找到日期间隔中的最大值，您必须将中心日期的记录连接到间隔中其他日期的记录，然后按中心日期分组。

试试这个查询：

```
SELECT a1.date, a1.amount, max(a2.amount) AS highest
FROM tbl a1 LEFT JOIN tbl a2
ON a2.date BETWEEN date_sub(a1.date, interval 3 DAY)
           AND date_add(a1.date, interval 3 DAY)
GROUP BY a1.date, a1.amount
HAVING a1.amount = highest
ORDER BY a1.date; 
```

要根据连续记录而不是日历日获得答案，您必须使用行号来增加表（通过将表与自身进行自联接），然后将此扩展表与自身进行自联接，选择比较金额时，每个日期的 +/- 3 行内的行：

```
SELECT t3.date FROM
  (SELECT t1.date AS date, t1.amount AS amount, count(t2.date) AS rownum
   FROM tbl t1
   INNER JOIN tbl t2
   ON t2.date <= t1.date
   GROUP BY t1.date, t1.amount) AS t3
LEFT JOIN
  (SELECT t1.date AS date, t1.amount AS amount, count(t2.date) AS rownum
   FROM tbl t1
   INNER JOIN tbl t2
   ON t2.date <= t1.date
   GROUP BY t1.date, t1.amount) AS t4
ON t3.rownum <> t4.rownum
AND t3.rownum - t4.rownum  BETWEEN -3 AND 3
AND t4.amount >= t3.amount
WHERE t4.date IS NULL
ORDER BY t3.date 
```

这适用于 MySQL 和 PostgreSQL，也应该适用于其他数据库引擎。在 MySQL 以外的其他数据库中，可以通过对两个子查询使用 CTE 来简化它。

使用这个[SQLfiddle](http://sqlfiddle.com/#!2/7823e/9/0)来测试它。

# javascript - Backbone：如何将集合放在视图中

> ID：13482344
> 
> 赞同：0
> 
> 时间：2012-11-20T21:20:15.450
> 
> 标签：javascript, backbone.js

我看到许多教程没有遵循所谓的最佳实践，即为该模型制作模型、视图和集合，**然后**为集合创建视图。哪个是父视图？

如何为集合创建视图？此外，它是否可以跟踪何时添加或删除模型以更新/重新渲染？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:37:36.847

你必须在你的集合视图中做这样的事情：

```
var view = Backbone.View.extend({});
var myView = new view({'collection' : new collection}); 
```

要处理添加/删除事件，请在初始化函数中使用：

```
this.collection.on("add", this.onAdd, this);   
this.collection.on("remove", this.onRemove, this); 
```

在您的模型视图中：

```
this.model.on("change", this.onUpdate,this); 
```

在这里看到它：http: [//www.neiker.com.ar/backbone/](http://www.neiker.com.ar/backbone/)

（对不起，我不会说英语）

编辑：只需使用木偶： [https ://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.collectionview.md](https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.collectionview.md)

# json - 无法生成 JSON - javax.ws.rs.WebApplicationException: com.sun.jersey.api.MessageException

> ID：13482346
> 
> 赞同：1
> 
> 时间：2012-11-20T21:20:19.880
> 
> 标签：json, rest, maven, jersey

我正在使用 Jersey 1.15、JDK 1.6、Tomcat 7、Maven 2.2.1 创建一个简单的 Restful Web 服务，它应该从我映射的 POJO 返回一个 JSON 字符串。

这是我的pojo：

```
package com.myservice.domain;

import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement
public class Person {
   private String firstName;
   private String lastName;

  // Getters & Setters
} 
```

我的网络服务：

```
package com.myservice.resource;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;

import com.myservice.domain.Person;

@Path("/service")
public class MyService {

    @GET
    @Path("showPerson")
    @Produces(MediaType.APPLICATION_JSON)
    public Person getPerson() {
       Person person = new Person();
       person.setFirstName("John");
       person.setLastName("Doe");
       return person;
    }
} 
```

这是我的 pom.xml：

```
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0    
         http://maven.apache.org/xsd/maven-4.0.0.xsd">

         <modelVersion>4.0.0</modelVersion>
         <groupId>com.myservice</groupId>
         <artifactId>myservice</artifactId>
         <version>0.0.1-SNAPSHOT</version>
         <packaging>war</packaging>
         <name>My Web Service</name>

         <dependencies>
             <dependency>
                 <groupId>junit</groupId>
                 <artifactId>junit</artifactId>
                 <version>4.8.2</version>
                 <scope>test</scope>
             </dependency>

             <dependency>
                <groupId>com.sun.jersey</groupId>
                <artifactId>jersey-servlet</artifactId>
                <version>1.15</version>
                <scope>runtime</scope>
             </dependency>

            <dependency>
               <groupId>com.sun.jersey</groupId>
               <artifactId>jersey-server</artifactId>
               <version>1.15</version>
            </dependency>

            <dependency>
                  <groupId>com.sun.jersey</groupId>
                  <artifactId>jersey-core</artifactId>
                  <version>1.15</version>
            </dependency>

            <dependency>
                 <groupId>com.sun.jersey</groupId>
                 <artifactId>jersey-json</artifactId>
                 <version>1.14</version>
            </dependency>

           <dependency>
                <groupId>com.sun.jersey.contribs</groupId>
                <artifactId>jersey-multipart</artifactId>
                <version>1.14</version>
           </dependency>

           <dependency>
               <groupId>org.codehaus.jackson</groupId>
               <artifactId>jackson-jaxrs</artifactId>
               <version>1.9.9</version>
           </dependency>
    </dependencies>

     <build>
          <finalName>myservice</finalName>
          <plugins>
                <plugin>
                 <artifactId>maven-compiler-plugin</artifactId>
                  <configuration>
                       <source>1.6</source>
                       <target>1.6</target>
                  </configuration>
                </plugin>
          </plugins>
     </build>
</project> 
```

我的 web.xml：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
                             http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
         version="3.0"
         metadata-complete="true">
     <display-name>My Web Service</display-name>
     <servlet>
       <servlet-name>Jersey REST Service</servlet-name>
       <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
         <init-param>
            <param-name>com.sun.jersey.config.property.packages</param-name>
            <param-value>com.myservice.resource</param-value>
         </init-param>
         <init-param>
            <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
            <param-value>true</param-value>
         </init-param>
         <load-on-startup>1</load-on-startup>
     </servlet>
     <servlet-mapping>
          <servlet-name>Jersey REST Service</servlet-name>
          <url-pattern>/rest/*</url-pattern>
      </servlet-mapping>
</web-app> 
```

部署到 tomcat 后，当我尝试像这样调用 Web 服务时：

```
curl -X GET http://localhost:8080/myservice/rest/service/showPerson 
```

我收到以下错误：

```
Nov 20, 2012 10:40:06 AM com.sun.jersey.spi.container.ContainerResponse write
SEVERE: A message body writer for Java class com.myservice.domain.Person, 
and Java type class com.myservice.domain.Person, 
and MIME media type application/json was not found

Nov 20, 2012 10:40:06 AM com.sun.jersey.spi.container.ContainerResponse write
SEVERE: A message body writer for Java class com.myservice.domain.Person,
and Java type class com.myservice.domain.Person, and MIME media type 
application/json was not found

Nov 20, 2012 10:40:06 AM com.sun.jersey.spi.container.ContainerResponse write 
SEVERE: The registered message body writers compatible with the 
MIME media type are: */* ->

     com.sun.jersey.core.impl.provider.entity.FormProvider
     com.sun.jersey.core.impl.provider.entity.StringProvider
     com.sun.jersey.core.impl.provider.entity.ByteArrayProvider
     com.sun.jersey.core.impl.provider.entity.FileProvider
     com.sun.jersey.core.impl.provider.entity.InputStreamProvider
     com.sun.jersey.core.impl.provider.entity.DataSourceProvider
     com.sun.jersey.core.impl.provider.entity.XMLJAXBElementProvider$General
     com.sun.jersey.core.impl.provider.entity.ReaderProvider
     com.sun.jersey.core.impl.provider.entity.DocumentProvider
     com.sun.jersey.core.impl.provider.entity.StreamingOutputProviderfg
     com.sun.jersey.core.impl.provider.entity.SourceProvider$SourceWriter
     com.sun.jersey.server.impl.template.ViewableMessageBodyWriter
     com.sun.jersey.core.impl.provider.entity.XMLRootElementProvider$General
     com.sun.jersey.core.impl.provider.entity.XMLListElementProvider$General

    Nov 20, 2012 10:40:06 AM com.sun.jersey.spi.container.ContainerResponse 
    write

      SEVERE: The registered message body writers compatible with the 
      MIME media type are:
      */* ->

     com.sun.jersey.core.impl.provider.entity.FormProvider
     com.sun.jersey.core.impl.provider.entity.StringProvider
     com.sun.jersey.core.impl.provider.entity.ByteArrayProvider
     com.sun.jersey.core.impl.provider.entity.FileProvider
     com.sun.jersey.core.impl.provider.entity.InputStreamProvider
     com.sun.jersey.core.impl.provider.entity.DataSourceProvider
     com.sun.jersey.core.impl.provider.entity.XMLJAXBElementProvider$General
     com.sun.jersey.core.impl.provider.entity.ReaderProvider
     com.sun.jersey.core.impl.provider.entity.DocumentProvider
     com.sun.jersey.core.impl.provider.entity.StreamingOutputProvider
     com.sun.jersey.core.impl.provider.entity.SourceProvider$SourceWriter
     com.sun.jersey.server.impl.template.ViewableMessageBodyWriter
     com.sun.jersey.core.impl.provider.entity.XMLRootElementProvider$General
     com.sun.jersey.core.impl.provider.entity.XMLListElementProvider$General

    SEVERE: Mapped exception to response: 500 (Internal Server Error)

    javax.ws.rs.WebApplicationException: 
    com.sun.jersey.api.MessageException:

    A message body writer for Java class
    com.myservice.domain.Person, 
    and Java type class com.myservice.domain.Person, 
    and MIME media type application/json was not found

    com.sun.jersey.api.MessageException: 

    A message body writer for Java class com.myservice.domain.Person, 
    and Java type class com.myservice.domain.Person, and MIME media type  
    application/json was not found

    HTTP Status 500 - Internal Server Error 
    The server encountered an internal error that prevented it from 
    fulfilling this request. 
```

上网一搜，我尝试将大家建议的如下提议的解决方案插入到web.xml中：

```
<init-param>
   <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
   <param-value>true</param-value>
</init-param> 
```

但它仍然给我同样的问题！但是，如果我使用 APPLICATION_XML，它确实会返回编组为 XML 的正确数据。

如果有人能指出我正确的方向，我将不胜感激。

非常感谢您花时间阅读本文。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T21:59:16.253

在您的依赖项中添加[Genson](http://code.google.com/p/genson/)库。它将自动启用 JSON-POJO 数据绑定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-22T16:25:57.023

将 jersey-json 添加到您的依赖项中。它将添加一个 JSON 序列化实现。

将此添加到`pom.xml`

```
<dependency>
    <groupId>com.sun.jersey</groupId>
    <artifactId>jersey-json</artifactId>
    <version>1.8</version>
</dependency> 
```

# c# - windows phone 8 中的依赖注入

> ID：13482350
> 
> 赞同：6
> 
> 时间：2012-11-20T21:20:50.400
> 
> 标签：c#, windows-runtime, windows-phone, windows-store-apps, windows-phone-8

有谁知道 Windows Phone 8 的体面的依赖注入框架？我在 mvvm 之后创建了一个项目，它与 Windows 商店项目共享代码。我将 Unity 用于 Windows 商店应用程序，但我无法让它与 Windows Phone 一起使用。有没有人遇到过类似的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:38:04.150

“MVVM Light”还带有“Simple IoC”。它工作得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-24T17:15:48.477

您可以使用[MEF](http://nuget.org/packages/microsoft.composition)。只需引用`portable-net45+win8`文件夹中的程序集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T13:25:53.213

您是否尝试过 codeplex 中的 funq？

[http://funq.codeplex.com/](http://funq.codeplex.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-30T22:50:01.437

我能够从 unity 下载源代码，并且编译时问题最少。

[http://unity.codeplex.com/releases](http://unity.codeplex.com/releases)

# angularjs - 在指令之间共享数据

> ID：13482351
> 
> 赞同：21
> 
> 时间：2012-11-20T21:20:50.613
> 
> 标签：angularjs

我有一些名为的数据`foo`位于三个孩子的父范围内：

```
<div ng-init="foo=[1, 2, 3]">
    <bar foo="{{foo}}" baz="{{odp}}" />
    <mpq foo="{{foo}}" bats="{{maktz}}" />
    <ktr foo="{{foo}}" otr="{{ompg}}" />
</div>

bar.scope = {foo: '=', baz: '@'};
mpq.scope = {foo: '=', bats: '@'};
ktr.scope = {foo: '=', otr: '@'}; 
```

`foo`在这三个指令之间共享的最佳方式是什么？选项包括：

*   使用一个独立的作用域传入`foo`三遍，从而跨四个作用域复制它
*   让子指令继承父作用域，并且 find `baz`、`bats`或`otr`on`attrs`
*   穿上`foo`并将`$rootScope`其注入子指令

还是有另一种更好的方法？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-20T21:57:31.650

您可以创建一个可以传递给每个指令或控制器的工厂。这将确保您在任何给定时间都只有一个数组实例。编辑：这里唯一的问题是确保您在指令范围内设置引用类型而不是原始类型，否则您最终将复制每个范围中的值。

[这是 Plnkr.co 上的一个示例](http://plnkr.co/edit/ZZOjr2)

```
app.controller('MainCtrl', function($scope, dataService) {
  $scope.name = 'World';
  //set up the items.
  angular.copy([ { name: 'test'} , { name: 'foo' } ], dataService.items);
});

app.directive('dir1', function(dataService){
  return {
    restrict: 'E',
    template: '<h3>Directive 1</h3>' + 
    '<div ng-repeat="item in data.items">' + 
      '<input type="text" ng-model="item.name"/>' + 
    '</div>',
    link: function(scope, elem, attr) {
      scope.data = dataService;
    }
  };
});

app.directive('dir2', function(dataService){
  return {
    restrict: 'E',
    template: '<h3>Directive 2</h3>' + 
    '<div ng-repeat="item in data.items">' + 
      '<input type="text" ng-model="item.name"/>' + 
    '</div>',
    link: function(scope, elem, attr) {
      scope.data = dataService;
    }
  };
});

app.directive('dir3', function(dataService){
  return {
    restrict: 'E',
    template: '<h3>Directive 3</h3>' + 
    '<div ng-repeat="item in data.items">' + 
      '<input type="text" ng-model="item.name"/>' + 
    '</div>',
    link: function(scope, elem, attr) {
      scope.data = dataService;
    }
  };
});

app.factory('dataService', [function(){
  return { items: [] };
}]); 
```

HTML

```
 <dir1></dir1>
  <dir2></dir2>
  <dir3></dir3> 
```

# xpath - XQuery 查找带有“单”引号的文本

> ID：13482352
> 
> 赞同：8
> 
> 时间：2012-11-20T21:20:53.283
> 
> 标签：xpath, escaping

我不知道如何使用 XPATH 搜索包含单引号的文本。

例如，我在此问题的标题中添加了引号。以下行

```
$x("//*[text()='XQuery looking for text with &#39;single&#39; quote']") 
```

返回一个空数组。

但是，如果我尝试以下

```
$x("//*[text()=\"XQuery looking for text with 'single' quote\"]") 
```

它确实返回页面标题的链接，但我希望能够在其中接受单引号和双引号，所以我不能只为单/双引号定制它。

您可以在此页面上的 chrome 或 firebug 控制台中尝试它。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-20T22:44:26.880

这是一个hackaround（感谢Dimitre Novatchev），它可以让我搜索xpaths中的任何文本，无论它包含单引号还是双引号。用 JS 实现，但可以很容易地翻译成其他语言

```
function cleanStringForXpath(str)  {
    var parts = str.match(/[^'"]+|['"]/g);
    parts = parts.map(function(part){
        if (part === "'")  {
            return '"\'"'; // output "'"
        }

        if (part === '"') {
            return "'\"'"; // output '"'
        }
        return "'" + part + "'";
    });
    return "concat(" + parts.join(",") + ")";
} 
```

如果我正在寻找`I'm reading "Harry Potter"`我可以执行以下操作

```
var xpathString = cleanStringForXpath( "I'm reading \"Harry Potter\"" );
$x("//*[text()="+ xpathString +"]");
// The xpath created becomes 
// //*[text()=concat('I',"'",'m reading ','"','Harry Potter','"')] 
```

这是一个（短得多的）Java 版本。如果您删除类型信息，它与 JavaScript 完全相同。感谢[https://stackoverflow.com/users/1850609/acdcjunior](https://stackoverflow.com/users/1850609/acdcjunior)

```
String escapedText = "concat('"+originalText.replace("'", "', \"'\", '") + "', '')";! 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-21T14:01:06.210

在 XPath 2.0 和 XQuery 1.0 中，字符串文字的分隔符可以通过加倍包含在字符串文字中：

```
let $a := "He said ""I won't""" 
```

或者

```
let $a := 'He said "I can''t"' 
```

该约定是从 SQL 借来的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-20T21:37:26.770

**这是一个例子**：

```
/*/*[contains(., "'") and contains(., '"') ]/text() 
```

**当此 XPath 表达式应用于以下 XML 文档时：**

```
<text>
    <t>I'm reading "Harry Potter"</t>
    <t>I am reading "Harry Potter"</t>
    <t>I am reading 'Harry Potter'</t>
</text> 
```

**选择了想要的正确结果（单个文本节点）：**

```
I'm reading "Harry Potter" 
```

**下面是使用[XPath Visualizer](http://www.huttar.net/dimitre/XPV/TopXML-XPV.html)**（我在 12 年前创建的免费开源工具，它向成千上万的人教授 XPath 有趣的方式）的验证：

![在此处输入图像描述](../Images/28ae48329ebda9b04e5174c936864f21.png)

您的问题可能是您无法在所使用的编程语言中将此 XPath 表达式指定为字符串——这不是 XPath 问题，而是您对编程语言的了解方面的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T14:53:32.050

此外，如果您使用的是 XQuery，而不是 XPath，如标题所述，您还可以使用 xml 实体：

```
 "&quot; for double and &apos; for single quotes" 
```

它们也可以在单引号内工作

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-09T06:48:12.327

您可以使用正则表达式来执行此操作。例如（作为 ES6 代码）：

```
export function escapeXPathString(str: string): string {
    str = str.replace(/'/g, `', "'", '`);

    return `concat('${str}', '')`;
} 
```

`'`这会将输入字符串中的所有内容替换为`', "'", '`.

final`, ''`很重要，因为`concat('string')`它是一个错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-24T13:37:19.990

好吧，我在同一个任务中，过了一会儿我发现在 xpath 中没有对此的支持，安静令人失望！但是，我们总是可以解决它！

我想要一些简单而直接的东西。我附带的是**为撇号设置您自己的替换，这是**一种独特的代码（您在 xml 文本中不会遇到的东西），例如，**我选择了 //apos//**。现在你**把它放在你的 xml 文本和你的 xpath 查询**中。（如果你不是总是写 xml，我们可以用任何编辑器的替换功能替换）。**现在我们怎么办？我们用这个正常搜索，检索结果，然后将 //apos// 替换回 '.**

下面是我正在做的一些示例：（replace_special_char_xpath() 是你需要做的）

```
function repalce_special_char_xpath($str){
    $str = str_replace("//apos//","'",$str);
    /*add all replacement here */
    return $str;
}

function xml_lang($xml_file,$category,$word,$language){ //path can be relative or absolute
    $language = str_replace("-","_",$language);// to replace - with _ to be able to use "en-us", .....
    $xml = simplexml_load_file($xml_file);
    $xpath_result = $xml->xpath("${category}/def[en_us = '${word}']/${language}");
    $result = $xpath_result[0][0];
    return repalce_special_char_xpath($result);
} 
```

xml文件中的文本：

```
<def>
     <en_us>If you don//apos//t know which server, Click here for automatic connection</en_us>   <fr_fr>Si vous ne savez pas quelle serveur, Cliquez ici pour une connexion automatique</fr_fr>    <ar_sa>إذا لا تعرفوا أي سرفير, إضغطوا هنا من أجل إتصال تلقائي</ar_sa>
</def> 
```

以及 php 文件中的调用（生成的 html）：

```
<span><?php echo xml_lang_body("If you don//apos//t know which server, Click here for automatic connection")?> 
```

# iphone - 过滤掉一个 UITextField 中的字符

> ID：13482360
> 
> 赞同：0
> 
> 时间：2012-11-20T21:21:05.667
> 
> 标签：iphone, objective-c, ios

好的，我正在尝试编辑 txtCountry 这个文本字段以不接受某些字母，但我不能，因为 txt 国家/地区设置不正确。有人可以帮我解决这个问题。我可能会犯一些小细节错误。

```
 - (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string{
if ([textField isEqual: txtCountry]) {

NSCharacterSet *cs = [[NSCharacterSet characterSetWithCharactersInString:LEAGELNUM] invertedSet];
NSString *filtered = [[string componentsSeparatedByCharactersInSet:cs]     componentsJoinedByString:@""];
BOOL basicTest = [string isEqualToString:filtered];
return basicTest;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:40:36.167

您不需要将文本字段的名称插入到方法中。而是这样做：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    if ([textField isEqual: txtCountry]) {
        //return YES or NO here depending on your criteria
    }
} 
```

# angularjs - angularjs $资源回调

> ID：13482361
> 
> 赞同：1
> 
> 时间：2012-11-20T21:21:13.957
> 
> 标签：angularjs

我有一个名为 Project 的模型，其成员是表中的行，更具体地说，是由 jQuery DataTables 插件装饰的表

这是我在咖啡脚本中的项目模型

```
#= require vendor/angular.js

Project = angular.module('Project', ['ngResource'])
.value( 'csrf', $('meta[name="csrf-token"]').attr('content') )

.factory('Project', ['$resource','csrf', ($resource, csrf) ->
  $resource '/projects/:project_id/:action', {authenticity_token: csrf, project_id:'@id'},
    query:
      method: 'GET'
      isArray: yes
    new:
      method: 'GET'
      params:
        project_id: 'new'
    edit:
      method: 'GET'
    update:
      method: 'PUT'

]) 
```

与 Angular 一起使用的 DataTable 插件的一个缺点是，每当我使用 project.$update() 时，该项目就会从视图中消失

所以我必须通过重新初始化来重新加载 DataTable，我现在可以忍受，但我想知道，如果有一种方法可以为 $resource 设置通用回调，我可以把这个 DataTables重新初始化调用？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:31:00.267

我假设在您调用工厂的控制器中，您有某种包装方法。

让我们称之为 scope.crudData

```
 SomeCtrl = (scope, http, projectService)
      scope.crudData(p_id, act, method) ->
          meth = YOUR LOGIC FOR PARSING AN ACTUAL FUNCTION FROM THE METHOD NAME GOES HERE
          projectService.meth
              project_id: p_id
              act: action
          , (response) ->
               THIS IS WHERE YOUR CALLBACK LIVES. KNOCK YOURSELF OUT. RELOAD THE DATA DO ANYTHING YOU WANT 
```

如果这还不够好，我可以假设在配置中为所有 ajax 请求注册一个侦听器，验证数据等。

让我知道这是否是您正在寻找的东西，我会为您整理一些伪代码。

# javascript - 来自 Yahoo Finance API 的 400 错误请求

> ID：13482365
> 
> 赞同：0
> 
> 时间：2012-11-20T21:21:27.103
> 
> 标签：javascript, html, json, rest, yahoo-api

这是我在 HTML 文件中的 javascript 函数中的代码

```
var url = 'http://query.yahooapis.com/v1/public/yql';
        var startDate = '2012-01-01';
        var endDate = '2012-01-08';
        var jsonData = encodeURIComponent('select * from yahoo.finance.historicaldata where symbol in ("YHOO","AAPL","GOOG","MSFT") and startDate = "' + startDate + '" and endDate = "' + endDate + '"');
        $.getJSON(url, 'q=' + data + "&env=http%3A%2F%2Fdatatables.org%2Falltables.env&format=json", function(){alert("done!");}); 
```

当我在浏览器中打开文件时，我的其他功能除了上述功能之外，因为它产生：

```
GET http://query.yahooapis.com/v1/public/yql?q=[object%20Object]&env=http%3A%2F%2Fdatatables.org%2Falltables.env&format=json 400 **(Bad Request)** jquery-1.8.3.min.js:2
send jquery-1.8.3.min.js:2
v.extend.ajax jquery-1.8.3.min.js:2
v.(anonymous function) jquery-1.8.3.min.js:2
v.extend.getJSON jquery-1.8.3.min.js:2
drawChart 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:29:58.193

应该这样：

```
$.getJSON(url, 'q=' + data + "&env=http%3A%2F%2Fdatatables.org%2Falltables.env&format=json", function(){alert("done!");}); 
```

是这个吗？

```
$.getJSON(url, 'q=' + jsonData + "&env=http%3A%2F%2Fdatatables.org%2Falltables.env&format=json", function(){alert("done!");}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-24T09:47:20.523

请注意——我有几个项目（Java 和 JavaScript）调用了这个 API。它们通常可以工作，但偶尔会失败，400*没有对代码进行任何更改，*然后在几个小时/几天后再次工作，而不更改代码。我认为如果服务器有问题，它可能会返回这个而不是 500 范围内的正确错误（服务器错误 - 是我，不是你）

400 范围内的错误应该是来自服务器的消息，类似于“是你，不是我——在你再次发送之前修复你的请求”，但我认为这个 API 不是这种情况。

简而言之-可能是他们而不是您！

# c - 使用释放的内存是否有风险

> ID：13482366
> 
> 赞同：1
> 
> 时间：2012-11-20T21:21:27.340
> 
> 标签：c, memory-management

假设我有一个指向内存中某个字符串的 char 指针。
并假设我想将该字符串复制到内存中的其他位置。

```
void cpy(char **dst, char *src)
{
    *dst = (char *) realloc(*dst, strlen(src) + 1);
    memcpy(*dst, src, strlen(src) + 1);
} 
```

（假设内存分配成功，并且`src`不为 NULL）
如果我这样调用这个函数会怎样：

```
char *str = malloc(14);
memcpy(str,"hello, world!", 14);
cpy(&str,str+7); 
```

现在我希望`srt`指向字符串`"world!"`（它在我的测试中做了）。
但我担心的是，在这个调用中，`cpy`实际上指向**同一**字符串的不同位置。而且，当调用时，这块内存可能会被释放。但在下一行中，我试图从那个地方复制. `*dst``src`**`realloc``*dst``memcpy`**

 **所以问题是：它有什么问题吗？
或者换一种说法 - 释放内存并在之后立即使用它可以吗？

谢谢。

**注意：**该示例已更新，以便`realloc`在使用`malloc`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T21:23:35.743

这一切都错了。调用不是通过etc获得的指针是完全*未定义的行为。*`realloc``malloc`

正如@Daniel Fischer 指出的那样，`memcpy`在重叠的内存区域上使用它也是未定义的行为（在这种情况下你应该使用`memmove`），所以你必须小心。

* * *

**更新：**在您进行大量编辑后，问题完全不同。它现在相当于这个压缩版本：

```
char * s = malloc(14);
strcpy(s, "hello, world!");

char * p = realloc(s, 14);

memcpy(p, s, 14); 
```

这也是未定义的行为，因为`s`在成功后不允许您再访问指向的内存，并且在不成功后`realloc`不允许您访问指向的内存。`p``realloc`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:40:44.467

您的示例中的隐含假设是允许`cpy`释放未分配的内存。这是一种狡猾的假设，但只要是故意的，就可以了。单独使用`malloc`and`free`而不是`realloc`在这种情况下：

```
void cpy(char **dst, char *src)
{
    // obtain completely new memory (realloc might do this anyway)
    char* new = malloc(strlen(src) + 1);

    // duplicate the string
    memcpy(new, src, strlen(src) + 1);

    // release the original memory now that we know we are done with it
    free(*dst);

    // indicate where to find the new string
    *dst = new;
} 
```

这仍然不是一个好主意，因为无法知道还有哪些其他变量可能指向您正在使用的内存`free`，但是如果您有办法做出这种保证，那么这就是您需要的那种代码。**

# google-app-engine - BadValueError('Property %s must be a float' % self.name) BadValueError: Property USD must be a float

> ID：13482369
> 
> 赞同：1
> 
> 时间：2012-11-20T21:21:34.780
> 
> 标签：google-app-engine, python-2.7

我的 Google App Engine 程序有问题。我已经盯着它几个小时了，不知道解决方案是什么。我[在 GAE 上看到了另一个相关问题“BadValueError: Property category is required”](https://stackoverflow.com/questions/10012476/badvalueerror-property-category-is-required-on-gae)，但即使我从 user 和 USD 变量中删除了“required=True”条件，我也会收到相同的错误。

我的程序将美元货币简单转换为 SR 货币。不幸的是，我不断收到错误消息： BadValueError('Property %s must be a float' % self.name) BadValueError: Property USD must be a float

来自我的 main.py 的代码

```
import webapp2
from google.appengine.ext import db
from google.appengine.ext.webapp import template

class Convert(db.Model):
    user = db.StringProperty(required=True)
    USD = db.FloatProperty(required=True)
    SR = db.FloatProperty()

class MainHandler(webapp2.RequestHandler):
    def get(self):
        conversion=db.GqlQuery('SELECT * FROM Convert')
        values={'conversion':conversion}
        self.response.out.write(template.render('main.html',values))
    def post(self):
        prog= Convert(user=(self.request.get('userName')),USD=((float)self.request.get('currency'))),SR=((float)(self.request.get('currency')*3.75)))
        prog.put()
        self.redirect('/')

app = webapp2.WSGIApplication([('/', MainHandler)], debug=True) 
```

来自我的 main.html 的代码

```
 <tr><td>{% for a in conversion%}
        <div align="right" lang="ar"><font size="+1" color="#000000"><strong><font color="#009999">{{a.user}}أدخل:</font>
        {{a.USD}}<font color="#990000">م</font> = {{a.SR}}{% endfor %}
    </td></tr>

    <tr><td>
        <form action="" method="post" accept-charset="utf-8">
            <p align="right" dir="rtl"><strong><font color="#003366">أدخل الدولار الأمريكي:</font></strong><input type="text" name="currency" value="" id="currency"></input></p>
            <p align="right" dir="rtl"><strong><font color="#003366">الرجـاء إدخــال اسمـك:</font></strong><input type="text" name="userName" value="" id="userName"></input></p>
            <p align="right"><input type="submit" value="تحويل العملة"></input></p>
        </form>
    </td></tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T11:23:56.047

真正奇怪的部分是，我将 USD 和 SR 变量重命名为小写，并且它起作用了。我不知道为什么它坚持大写美元“财产美元必须是浮动的”，但是当我将它们改为小写的usd和sr时，它运行起来很顺利。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:17:50.063

我无法使用本地服务器重现您的错误，而是得到：

```
SyntaxError: invalid syntax
Traceback (most recent call last):
  ...snip...
  File "/Users/user/helloworld/main.py", line 16
    prog= Convert(user=(self.request.get('userName')),USD=((float)self.request.get('currency'))),SR=((float)(self.request.get('currency')*3.75))) 
```

我在评论中提出的建议解决了语法问题和您的原始问题（只有删除`(float)`语句才能得到）：

```
def post(self):
  prog= Convert(user=self.request.get('userName'),USD=float(self.request.get('currency')),SR=float(self.request.get('currency'))*3.75)
  prog.put()
  self.redirect('/') 
```

# sql - 选择特定的 ASCII 字符并在 SQL 中替换

> ID：13482372
> 
> 赞同：0
> 
> 时间：2012-11-20T21:21:42.040
> 
> 标签：sql, sql-server-2008, replace, char, ascii

问题 - 可以将 Char() 设置为 32 到 44 之类的 ASCII 代码范围/集吗？

我想运行一个查询来做这个尝试做的事情。

```
SELECT REPLACE([COLUMN],CHAR(32-44,'-')
FROM TABLE 
```

但我这不起作用。我的理由是可读性/极客性并缩短 15 替换嵌套深度查询或创建具有 15 个值的新表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T13:22:25.323

N/A - 有很多方法可以达到最终结果，但似乎不可能为 ASCII 字符选择一个数字范围。

# ruby - 需要一些 Ruby 翻译

> ID：13482379
> 
> 赞同：1
> 
> 时间：2012-11-20T21:22:09.303
> 
> 标签：ruby, ruby-1.9.3

```
plist_values['HashData'].join("").unpack('m')[0].each_byte do |b|
    hash_decoded << sprintf("%02X", b)
end 
```

我需要把它翻译成其他语言。据我了解，它将'HashData'数组的所有内容放入一个字符串中，然后从Base64解码，但接下来呢？你能给我写一个分步解释它的作用吗？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:26:53.590

`plist_values`它从（带有 key 的那个）解码 base64 值`'HashData'`并将其转换为可打印的十六进制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T21:36:51.090

*   `join("")`连接数组中的所有字符串（或调用时数组中的每个元素返回的内容`to_s`）。
*   `unpack('m')`从[文档](http://www.ruby-doc.org/core-1.9.3/String.html#unpack-method)解码字符串（并假设它是base64编码的）。
*   `sprintf("%02X", b)`从[文档](http://ruby-doc.org/core-1.9.3/Kernel.html#method-i-sprintf)返回带有大写字母的十六进制表示。
*   `hash_decoded << ..`将十六进制表示附加到字符串

最重要的是，您将获得一个字符串，该字符串表示`plist_values['HashData']`.

# android - 没有这样的文件或目录：app.ap_

> ID：13482380
> 
> 赞同：0
> 
> 时间：2012-11-20T21:22:11.063
> 
> 标签：android, titanium, titanium-mobile

当我尝试运行我的应用程序时，它给了我这个错误。但是为什么？

```
[ERROR] Exception occurred while building Android project:
[ERROR] Traceback (most recent call last):
[ERROR]   File "C:\Users\ThomasBolander\AppData\Roaming\Titanium\mobilesdk\win32\2.1.2.GA\android\builder.py", line 2243, in <module>
[ERROR]     s.build_and_run(True, avd_id, device_args=device_args)
[ERROR]   File "C:\Users\ThomasBolander\AppData\Roaming\Titanium\mobilesdk\win32\2.1.2.GA\android\builder.py", line 2068, in build_and_run
[ERROR]     launched, launch_failed = self.package_and_deploy()
[ERROR]   File "C:\Users\ThomasBolander\AppData\Roaming\Titanium\mobilesdk\win32\2.1.2.GA\android\builder.py", line 1585, in package_and_deploy
[ERROR]     unsigned_apk = self.create_unsigned_apk(ap_)
[ERROR]   File "C:\Users\ThomasBolander\AppData\Roaming\Titanium\mobilesdk\win32\2.1.2.GA\android\builder.py", line 1447, in create_unsigned_apk
[ERROR]     resources_zip = zipfile.ZipFile(resources_zip_file)
[ERROR]   File "C:\Users\ThomasBolander\AppData\Local\Titanium Studio\plugins\com.appcelerator.titanium.python.win32_1.0.0.1338515509\python\lib\zipfile.py", line 671, in __init__
[ERROR]     self.fp = open(file, modeDict[mode])
[ERROR] IOError: [Errno 2] No such file or directory: 'C:\\Users\\ThomasBolander\\Dropbox\\Praktikanten\\Apps\\Fritidsjob.dk Android Standard\\build\\android\\bin\\app.ap_' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T19:20:14.043

尝试以下操作：

1.  确保如果您使用的是本地化文件，这些文件中没有错误。
2.  如果您使用任何类型的模块，请确保该模块与您的 SDK 兼容。
3.  清理您的解决方案，然后再次运行该项目。

# c - 导致 if_nametoindex() 缓慢的可能原因是什么？

> ID：13482387
> 
> 赞同：1
> 
> 时间：2012-11-20T21:22:45.727
> 
> 标签：c, glibc

在我测试的常规 linux 机器（内核 3.4）上，它运行得非常快。但是当我将我的程序移动到另一个 linux 机器（内核 3.0）时，这个函数运行得很慢，大约需要 2.5 毫秒才能返回，这就像慢了 500 倍，这会导致很大的性能问题。

那么造成如此大差异的可能原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:09:34.753

我不知道为什么在你的另一台运行 Linux 3.0 的机器上它会慢得多；有很多可能的原因，例如内核中的错误或某些慢速硬件。您可以凭经验确定这一点。首先，看看是不是内核版本的问题；在速度较慢的机器上安装较新的内核，看看是否可以修复它。如果你不能这样做，你可以尝试在你的开发机器上安装旧内核。如果事实证明它是基于内核版本的，那么您可以将内核历史一分为二，以找出哪个提交加快了它的速度。有关[`git bisect`](http://www.kernel.org/pub/software/scm/git/docs/git-bisect.html)如何进行二等分的详细信息，请参阅。如果不是内核问题，则很可能是硬件问题。

不管是什么引入了这个错误，你都会想要修复它。如果您无法通过升级内核来修复它，您可以通过调用`if_nameindex()`一次、存储结果并在该数组中查找结果来解决它。线性扫描大约 15 个项目的数组应该很快；比 2.5 毫秒快得多。

```
struct if_nameindex* cached_nameindex = NULL;

int if_nametoindex_cached(char *name) {
  if (!cached_nameindex) {
    cached_nameindex = if_nameindex();
    if (!cached_nameindex) {
      perror("failed to get nameindex");
      exit(1);
    }
  }

  for (struct if_nameindex *ni = cached_nameindex; ni->if_name; ++ni) {
    if (!strcmp(ni->if_name, name))
      return ni->if_index;
  }

  return 0;
} 
```

# java - Spring Data JPA 和 QueryDSL

> ID：13482389
> 
> 赞同：5
> 
> 时间：2012-11-20T21:22:47.070
> 
> 标签：java, spring-data, querydsl

我是 Spring data JPA 的新手，正在尝试了解如何最好地将它与 QueryDSL 一起使用。如果没有 QueryDSL，我将能够使用 @Query 注释在 SpringData 接口中简单地创建任何查询。

为了获得使用 QueryDSL 的相同体验，据我所知，我需要创建自己的自定义存储库实现并让我的 repo 接口扩展我的自定义实现接口，或者将所有 QueryDSL 查询放在包装我的 repo 的服务层.

在第一种情况下，我无法在自定义 repo 中使用任何 SD 自动生成的方法（例如： findAll(QueryDSL predicate) ），因为我无法访问实际的 repo 对象，而在第二种情况下，我是将查询逻辑放在服务层而不是回购层。

这两种解决方案对我来说都不是特别有吸引力。有没有更合适的第三种方式？还是我误解了如何正确使用 QueryDSL 和 Spring Data？

谢谢！

埃里克

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-22T07:18:53.187

可能最方便的方法是让您的存储库接口简单地扩展`QueryDslPredicateExecutor`，这增加了将 Querydsl 对象简单地通过管道传输到存储库并`Predicate`独立或并行执行它们等的能力。`Pageable``Sort`

如果您真的想将谓词的组合隐藏到存储库层中（这绝对没问题，但实际上用于不同的目的），您可以按照[此处](http://static.springsource.org/spring-data/data-jpa/docs/current/reference/html/#repositories.single-repository-behaviour)所述创建一个单独的存储库实现类并`QueryDslRepositorySupport`用作基类。然后，在您实现的查找器方法中，您可以使用基类的`from(…)`、`update(…)`和`delete(…)`方法轻松地使用 Querydsl 元模型构造和执行查询。

# javascript - 按钮显示依赖于父窗口

> ID：13482390
> 
> 赞同：0
> 
> 时间：2012-11-20T21:22:50.730
> 
> 标签：javascript

我有一个可以从 2 个不同区域访问的网页，一个导航到该页面，一个打开一个新窗口到该页面。我正在尝试使用 window.parent.location 作为开关来显示导航页面的“返回”或新窗口的“关闭”。

我在正确的道路上，有没有更简单的方法来做到这一点？

所有帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:27:43.780

```
if(window.opener)
{
 ///show close
}
else
{
 ////    show back
} 
```

# jquery - 锚定到最外层 div 的菜单

> ID：13482392
> 
> 赞同：0
> 
> 时间：2012-11-20T21:22:55.367
> 
> 标签：jquery, css, layout

我想知道是否可以将菜单锚定在布局上最外层的 div 上方？
这是我设置的 jsFiddle：http: [//jsfiddle.net/L2Deq/7/](http://jsfiddle.net/L2Deq/7/)
这里也是代码：
HTML—</p>

```
<div id="menu">Menu 1</div>
<div id="testing">Testing 1</div>

<div id="menu-right">Menu 2</div>

<div id="boxed">
<div id="box-01" class="boxes"></div>
<div id="box-02" class="boxes"></div>
<div id="box-03" class="boxes"></div>
<div id="box-04" class="boxes"></div>
<div id="box-05" class="boxes"></div>
<div id="box-06" class="boxes"></div>
<div id="box-07" class="boxes"></div>
<div id="box-08" class="boxes"></div>
</div> 
```

​CSS——</p>

```
#menu {
    font-family: Helvetica, Arial, sans-serif;
    font-weight: bold;
    font-size: 14px;
    left: 20px;
    top: 10px;
    position: absolute;
}

#menu-right {
    font-family: Helvetica, Arial, sans-serif;
    font-weight: bold;
    font-size: 14px;
    width: 100px;
    left: 128px;
    top: 10px;
    position: absolute;
}

#testing {
    font-family: Georgia, Arial, sans-serif;
    font-size: 14px;
    left: 20px;
    top: 30px;
    position: absolute;
}

.boxes {
    background-color: red;
    height: 100px;
    width: 100px;
    margin-right: 8px;
    margin-bottom: 8px;
    display: block;
    float: left;
}

#boxed {
    position: absolute;
    left: 20px;
    margin-right: 12px;
    top: 64px;
    width: auto;
    float: left;
    z-index: 9998;
} 
```

基本上，我希望将“菜单 2”与最外面的红色框对齐。因此，当屏幕尺寸减小时，菜单会移动 100 像素（红色框的宽度），因此它始终与右侧的框对齐。希望这是有道理的，我似乎无法弄清楚如何实现这一点，不确定我是否可以用 css 实现，或者它可能需要 jQuery？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:34:00.093

您可以将第二个菜单设置为框 4 的子菜单。将框设置为 position:relative，然后将菜单 2 绝对定位在框 4 上方，方法是给它一个负顶部。

看你的小提琴版本 20

编辑：

使用容器 div 对 STLRick 的解决方案进行快速而肮脏的修改将产生我认为您可以使用的结果。

基本上通过将整个程序集包装在一个容器中，然后将 menu2 设置为相对容器的绝对位置，您可以将 menu2 绝对定位在所述容器的右上角。只要您的布局在菜单的位置和方块的位置方面没有改变，它就应该始终位于右上角。

```
#container {
    max-width: 900px;
    position relative;
}

#menu-right {
    font-family: Helvetica, Arial, sans-serif;
    font-weight: bold;
    font-size: 14px;
    top: 10px;
    right:120px;
    position: absolute;  
} 
```

[http://jsfiddle.net/L2Deq/41/](http://jsfiddle.net/L2Deq/41/)

这真的很接近，但是窗口宽度中有一些点导致框是错误的，它们是非常小的点（2 - 5 像素）

[http://jsfiddle.net/L2Deq/60/](http://jsfiddle.net/L2Deq/60/)

甚至更近一点：

[http://jsfiddle.net/gL22f/5/](http://jsfiddle.net/gL22f/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:34:45.140

我在外面包裹了一个容器，设置了最大宽度，将布局更改为相对而不是绝对，并使用 css Float 属性来正确定位所有内容。我很确定这不是您想要的（菜单不会移动 100px 块，而是流畅地移动），但这里是小提琴和 CSS 更改：

[http://jsfiddle.net/L2Deq/21/](http://jsfiddle.net/L2Deq/21/)

```
#container {
    max-width: 900px;
}

#menu {
    font-family: Helvetica, Arial, sans-serif;
    font-weight: bold;
    font-size: 14px;
    margin-left: 20px;
    margin-top: 10px;
    position: relative;
}

#menu-right {
    font-family: Helvetica, Arial, sans-serif;
    font-weight: bold;
    font-size: 14px;
    margin-left: 10px;
    margin-top: -60px;
    position: relative;
    float: right;
    margin-right: 25px;
}

.clear {
    clear: both;
}

#testing {
    font-family: Georgia, Arial, sans-serif;
    font-size: 14px;
    margin-left: 20px;
    margin-top: 10px;
    position: relative;
}

.boxes {
    background-color: red;
    height: 100px;
    width: 100px;
    margin-right: 8px;
    margin-bottom: 8px;
    display: block;
    float: left;
}

#boxed {
    position: absolute;
    left: 20px;
    margin-right: 12px;
    top: 64px;
    width: auto;
    float: left;
    z-index: 9998;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:22:41.413

要在与框的包装间隔相匹配的间隔中对齐菜单，您需要使用媒体查询或 javascript。我建议使用 jQuery，因为它可以为您提供最大的灵活性来更改框大小，而无需重写所有媒体查询断点。

这是一个片段，我认为它可以呈现您想要的结果。

```
$(document).ready(function() {
    // Position the menu on document ready.
    positionMenu();

    // Bind it to run when the window resizes
    $(window).resize(function(){
        positionMenu();
    });
});

function positionMenu() {
    // Get the top-offset of the first box.
    var toprowoffset = $('.boxes:first').offset().top;

    // All the boxes with the same top-offset is in the top row - add class top to them.
    $('.boxes').each(function(){
        $(this).toggleClass('top',$(this).offset().top == toprowoffset);
    });

    // The last box in the top row is the one we want to align to.
    var alignbox = $('.boxes.top:last');

    // Calculate and set the right margin for the menu using the alignbox position.
    var marginright = $(document).width() - alignbox.position().left - alignbox.width();
    $('#menu-right').css('margin-right',marginright);
}​ 
```

这是一个[jsfiddle-link，它正在运行。](http://jsfiddle.net/L2Deq/26/)

# iphone - FFMPEG 的非 GPL 替代品？

> ID：13482394
> 
> 赞同：10
> 
> 时间：2012-11-20T21:23:04.177
> 
> 标签：iphone, objective-c, ios, ipad

通过阅读 GPL，我得出结论，使用 ffmpeg 之类的库无法在 App Store 上发布应用程序。

是否有除 ffmpeg 之外的其他库用于将 .flv 转换为不受 GPL 许可的音频文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:18:59.010

为什么经常出现这种情况？ffmpeg 网站上有信息解释了如何在 iOS 上部署 ffmpeg 应用程序和许可后果。

[https://ffmpeg.org/trac/ffmpeg/ticket/1229](https://ffmpeg.org/trac/ffmpeg/ticket/1229)

只要您使用 ffmpeg 的 lgpl/gpl 版本就可以了。

2009 年，当我第一次帮助移植第一个 ffmpeg 应用程序时，它更像是一个灰色地带，但现在应用商店中有无数的应用程序。

遵守 LGPL 许可证很重要，但应该没问题。

# batch-file - 批量错误分配变量？

> ID：13482398
> 
> 赞同：0
> 
> 时间：2012-11-20T21:23:32.223
> 
> 标签：batch-file

好吧，我以前很擅长这个，但我有一段时间没做过了，所以我有点生疏了。好吧，我正在制作一个小程序，但遇到了一个错误，一个变量不会设置。所以我把它弄乱了，取出了与那个变量无关的所有东西，但我无法让它工作！为了证明我的问题，我想出了这个：

```
@echo off
:V
set /p V = "What is V? "
echo V is %V%.
goto V 
```

简单吧？以下是它在理论上应该如何工作：

```
What is V? V
V is V.
What is V? _ 
```

显然，它应该是这样工作的。相反，它有点像这样：

```
What is V? V
V is .
What is V? _ 
```

这是迄今为止我遇到的最微不足道的小错误。我发誓，如果我不解决这个问题，我会发疯的..！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:33:41.600

公平警告 - 不要用你的手掌伤害你的头 :-)

您的 SET /P 分配中有一个额外的空间。您正在创建的变量的名称是
`"V "`（不包括引号）

`=`在世界上一切都会正确之前删除有问题的空间。

# python - 在查询集中移动元素

> ID：13482402
> 
> 赞同：2
> 
> 时间：2012-11-20T21:23:42.420
> 
> 标签：python, django

我的 django 视图中有一个查询集。

我想更改其中一个项目的位置，使其成为查询集的第一个元素。

关于如何做到这一点的任何想法？

编辑：

我有一个查询集：

```
 qs = UserProfile.objects.filter(myfilter=whatever) 
```

我知道在这个查询集中我有：

```
 specific_user.userprofile 
```

我想要做的是将 user.userprofile 放在我的查询集中的第一个位置，因为我在模板的循环中使用了这个查询集：

```
 {% for i in qs %}
    <div> i.name </div> 
```

我想确保列表的第一个名称是 specific_user 的名称。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T21:46:13.930

`QuerySet`Django 中的对象是数据库查询结果的抽象表示。一般而言，它表示当请求查询集中的特定对象时可能稍后执行的 SQL，但在此之前，不会执行任何查询。所以你真的不能把查询集想象成一个列表，它可能会被任意重新排序。您可以请求查询集中的对象使用其`order_by`方法进行排序，因此如果您希望特定对象排在第一位，则它必须在数据库端具有一些可排序的属性，以便对其进行排序。[这可以是一个列，也可以是使用F 表达式](https://docs.djangoproject.com/en/dev/topics/db/queries/#query-expressions)从其列计算的值。

但是，根据您的需要，您似乎可以在视图中列出您的查询集：

```
profiles = [specific_user.userprofile] + [profile for profile in UserProfile.objects.filter(myfilter=whatever).exclude(id=specific_user.userprofile.id)] 
```

将其添加到您的上下文中并对其进行迭代，而不是模板中的原始查询集。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-12-30T14:38:43.097

从 Django 1.8 开始，您可以使用[条件表达式](https://docs.djangoproject.com/en/dev/ref/models/conditional-expressions/)来定义特定顺序。

当 UserProfile 为 specific_user.userprofile 时，您将设置一个特殊情况：

```
qs = UserProfile.objects.filter(myfilter=whatever)\
.order_by(Case(When(pk=specific_user.userprofile.pk, then=0), default=1))) 
```

我们在特殊情况下设置为 0，默认设置为 1。这样，指定的用户将始终首先显示。

# jquery - 视频未使用 jquery 在其图像占位符上播放

> ID：13482404
> 
> 赞同：0
> 
> 时间：2012-11-20T21:23:47.590
> 
> 标签：jquery, youtube

我想在单击其占位符（图像）时播放视频。这是代码。

html

```
 <div class="ytembed">
        <a href="http://player.vimeo.com/video/27243869?title=1&byline=1&portrait=1">
            <img width="560" height="315" src="http://placehold.it/560x315" alt="Click to play"/>
        </a>
    </div>​ 
```

jQuery

```
$(function() {
    $('.ytembed:not(.processed)').addClass('processed').each(function() {
        $(this).find('a').click(function(e) {
            e.preventDefault();
            var width = $(this).find('img').width();
            var height = $(this).find('img').height();
            var url = $(this).attr('href');
            var $iframe = $('<iframe src="' + url + '" width="' + width + '" height="' + height + '" frameborder="0"/>');
            $(this).parent().html($iframe);
        });
    });
});​ 
```

请告诉我该怎么做。这是 jsfiddle 版本[http://jsfiddle.net/fEzLZ/](http://jsfiddle.net/fEzLZ/)

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:30:08.603

尝试将“autoplay=1”添加到 Vimeo 网址的末尾。生成的 URL 应该是

```
"http://player.vimeo.com/video/27243869?title=1&byline=1&portrait=1&autoplay=1" 
```

# database - 用户详情管理

> ID：13482405
> 
> 赞同：0
> 
> 时间：2012-11-20T21:23:48.623
> 
> 标签：database, security, passwords, password-recovery

我在我的 Web 应用程序中有一个名为“管理员”的角色。具有此角色的用户应该能够修改有关注册用户的信息。

我正在考虑显示一个包含用户详细信息（例如电子邮件、用户名）的表格，并且能够更改它们，但我不知道如果用户亲自来到办公室，去找管理员并询问我该怎么办更改密码（是的，他们可以这样做）。管理员是否应该只按行上方的重置按钮并告诉用户在他到家时检查他的电子邮件并继续恢复？（例如重置链接）或者管理员应该在那一刻重置用户的密码并给他新密码？第二种方法更可取，因为我被要求这样做......

我知道管理员应该看不到原始密码，因为它应该是散列的并且是未知的。

您对此有何看法？您将如何实现此功能？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:44:26.297

这个问题没有一个完美的答案。工作流的问题将始终取决于应用程序的特定用例，并取决于它所内置的上下文。

话虽这么说，但您对一件事是正确的 - 让管理员或任何其他用户查看其他人的明文密码是可怕的，我的意思是可怕的安全漏洞。所以这绝对是不可能的。

就您而言，似乎赋予管理员更改某人密码的权利是可行的方法。如果您担心它的外观，请不要担心。Google Apps 允许域管理员更改该域下任何电子邮件帐户的密码。

最后，我会建议一个小的额外安全措施。当管理员更改另一个用户的密码时，将旧的加密密码存储在一个列中，不要删除它。当管理员设置新密码时，向用户发送一封电子邮件，说“您的密码已被管理员更改，如果您没有要求，请点击这里”。当他们点击电子邮件中的链接时，只需用旧密码覆盖新密码即可。

这样，如果管理员在没有用户请求的情况下更改密码，您可以为用户提供追索权，并且日志将让您了解管理员有多少次被用户撤销密码重置。

# sql - 当结果集来自自引用表时，有没有办法按层次结构排序？

> ID：13482407
> 
> 赞同：0
> 
> 时间：2012-11-20T21:24:08.800
> 
> 标签：sql, oracle, self-reference

我们有一个 Oracle 自引用表来表示类似于以下的层次结构：

```
THING
---------
ID
PARENT_ID
NAME
SOME_DATA 
```

顶层`THING`有一个`null` `PARENT_ID`.

我希望能够从此表中进行选择，并按层次结构中每一行的位置（从上到下）对数据进行排序，然后按名称对数据集进行排序：

```
ID PARENT_ID  NAME SOME_DATA
1       null   top      null
2          1   cat      null
3          1   dog      null
4          2  frog      null
5          1  bird      null
6          2  fish      null 
```

...变成：

```
ID PARENT_ID  NAME SOME_DATA
1       null   top      null
5          1  bird      null
2          1   cat      null
6          2  fish      null
4          2  frog      null
3          1   dog      null 
```

当我开始输入这个问题时，我很好奇是否有办法在不向`LEVEL`表中添加列的情况下执行此操作，但现在我什至不确定是否可以通过添加该列来完成。

在这里，“否”的答案是完全可以接受的，因为我已经接受了我将不得不在我的 Java 代码中执行此操作的事实。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:13:44.163

与其`LEVEL`以巧妙的方式使用和尝试管理结果，不如使用`START WITH`并`ORDER SIBLINGS BY`获得您正在寻找的结果：

[SQL小提琴](http://www.sqlfiddle.com/#!4/ad474/17)

```
SELECT t.*
FROM thing t
CONNECT BY PRIOR t.id = t.parent_id
START WITH t.parent_id IS NULL
ORDER SIBLINGS BY t.name 
```

**[结果](http://www.sqlfiddle.com/#!4/ad474/17/0)**：

```
| ID | PARENT_ID | NAME | SOME_DATA |
-------------------------------------
|  1 |    (null) |  top |    (null) |
|  5 |         1 | bird |    (null) |
|  2 |         1 |  cat |    (null) |
|  6 |         2 | fish |    (null) |
|  4 |         2 | frog |    (null) |
|  3 |         1 |  dog |    (null) | 
```

这通过层次结构链接，从根 ( `parent_id IS NULL`) 开始并对结果进行排序。

# c# - .NET 是否支持 OFB cipherMode？

> ID：13482408
> 
> 赞同：3
> 
> 时间：2012-11-20T21:24:11.267
> 
> 标签：c#, cryptography, aes

我正在使用`AESCryptoServiceProvider`类。我正在尝试测试不同的`CipherMode`值。

使用`OFB`模式时出现异常：指定的算法无效。

在文档中记录了该模式：

AESCryptoServiceProvider 类 [http://msdn.microsoft.com/es-es/library/system.security.cryptography.aescryptoserviceprovider.aspx](http://msdn.microsoft.com/es-es/library/system.security.cryptography.aescryptoserviceprovider.aspx)

密码模式[http://msdn.microsoft.com/es-es/library/system.security.cryptography.ciphermode.aspx](http://msdn.microsoft.com/es-es/library/system.security.cryptography.ciphermode.aspx)

我也读过这个类似的帖子，但没有找到答案：

[.NET 是否支持 AES OFB](https://stackoverflow.com/questions/4252411/does-net-support-of-aes-ofb)

我的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

using System.Security.Cryptography;
using System.IO;

namespace V_ModosDeEncadenamiento
{
    class Program
    {
        static void Main(string[] args)
        {
            //Clave de 128
            byte[] claveAES128Bits = { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
                                       0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F };

            //Vector de inicialización
            byte[] vectorInicializacion = { 0xA0, 0xA1, 0xA2, 0xA3, 0xA4, 0xA5, 0xA6, 0xA7,
                                            0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE, 0xAF };

            //Texto plano de prueba para codificar. Bloque de 16 bytes todos iguales
            byte[] textoPlanoBloques16BytesIguales = 
                                       {0xB0, 0xB1, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7,
                                       0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE, 0xBF,
                                       0xB0, 0xB1, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7,
                                       0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE, 0xBF,
                                       0xB0, 0xB1, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7,
                                       0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE, 0xBF};

            //Nombre del fichero en disco con texto cifrado
            String nombreFicheroECB = "zz_TextoCifradoECB.bin";
            String nombreFicheroCBC = "zz_TextoCifradoCBC.bin";
            String nombreFicheroCFB = "zz_TextoCifradoCFB.bin";
            String nombreFicheroOFB = "zz_TextoCifradoOFB.bin";

            //Array con el texto descifrado
            byte[] textoDescifrado = new byte[textoPlanoBloques16BytesIguales.Length];

            AesCryptoServiceProvider aesCrypto = new AesCryptoServiceProvider();
            FileStream fileWrite;
            FileStream fileRead;
            ICryptoTransform encryptor;
            ICryptoTransform decryptor;
            CryptoStream stream;
            CryptoStream streamOut;

            //Establecer valores 
            aesCrypto.KeySize = 128;
            aesCrypto.Key = claveAES128Bits;
            aesCrypto.IV = vectorInicializacion;
            aesCrypto.Padding = PaddingMode.PKCS7;

   aesCrypto.Mode = CipherMode.OFB;
    fileWrite = new FileStream(nombreFicheroOFB, FileMode.Create, FileAccess.Write, FileShare.None);
    encryptor = aesCrypto.CreateEncryptor();
    stream = new CryptoStream(fileWrite, encryptor, CryptoStreamMode.Write);

    // THE EXCEPTION HAPPENS HERE **************************************************
    //******************************************************************************
    stream.Write(textoPlanoBloques16BytesIguales, 0, textoPlanoBloques16BytesIguales.Length);
    stream.Flush();
    stream.Close();
    stream.Dispose();
    fileWrite.Close();

    fileRead = new FileStream(nombreFicheroOFB, FileMode.Open, FileAccess.Read, FileShare.None);
    decryptor = aesCrypto.CreateDecryptor();
    streamOut = new CryptoStream(fileRead, decryptor, CryptoStreamMode.Read);
    streamOut.Read(textoDescifrado, 0, textoDescifrado.Length);
    streamOut.Flush();
    streamOut.Close();
    streamOut.Dispose();
    fileRead.Close();

    //Mostrar datos descifrados
    Console.WriteLine();
    Console.WriteLine();
    Console.WriteLine("Cifrado modo EFB.");
    Console.WriteLine("Datos descifrados:");
    for (int i = 0; i <= textoDescifrado.Length - 1; i++)
    {
        if (((i % 8) == 0) && (i != 0)) Console.WriteLine(); //8 bytes en cada linea
        Console.Write(" {0:X2}", textoDescifrado[i]);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T12:32:16.683

检查这篇文章：[http ://social.msdn.microsoft.com/Forums/is/netfxbcl/thread/891955cd-3125-487c-9746-9fd07f24b12f](http://social.msdn.microsoft.com/Forums/is/netfxbcl/thread/891955cd-3125-487c-9746-9fd07f24b12f)

RijndaelManaged 目前不支持 OFB 模式。您可以在 ECB 模式之上自己编写（几乎很容易）OFB 模式，或使用侧面加密库，如 BouncyCastle、SecureBlackbox 等。

# ios - 如何深度复制 NSMutableURLRequest？

> ID：13482409
> 
> 赞同：1
> 
> 时间：2012-11-20T21:24:13.910
> 
> 标签：ios, cocoa, nsurlrequest, nsurlprotocol

[Apple 关于NSMutableURLRequest](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableURLRequest_Class/Reference/Reference.html)的 iOS 文档说：

> NSURLConnection 对传递给它的初始化器之一的每个 NSMutableURLRequest 对象进行深拷贝。

这是如何实施的？我没有看到任何记录在案的方法来执行`NSMutableURLRequest`对象的深层复制。逐个字段的复制不够好，因为`NSMutableURLRequest`可以进行子类化。

我的用例：我正在`NSURLProtocol`为构建在 http 之上的自定义协议实现。我的`NSURLProtocol`实现将执行其自定义内容，然后使用`NSURLConnection`稍作修改的`NSURLRequest`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T01:33:28.783

当您想要制作对象的深层副本时，您可以使用 NSKeyedArchiver。

基本上使用**NSKeyedArchiver**将对象保存到 NSData 对象中

**使用NSKeyedUnarchiver**加载它

# actionscript-3 - CS6 Flash Pro 和 Flash Builder 4.5 之间有什么问题吗？

> ID：13482414
> 
> 赞同：0
> 
> 时间：2012-11-20T21:24:38.803
> 
> 标签：actionscript-3, flash, actionscript, flash-builder, flash-cs6

我正在尝试遵循本指南：[http ://tv.adobe.com/watch/learn-flash-professional-cs5/using-flash-pro-and-flash-builder-together/](http://tv.adobe.com/watch/learn-flash-professional-cs5/using-flash-pro-and-flash-builder-together/)

使用 CS6 Flash Pro 和 Flash Builder 4.5 时。

我遇到的问题是我的 Flash Builder 代码似乎没有任何效果。我按照指南做了所有事情，唯一的变化是我使用的名称和按钮位置。

我最终得到的代码：

```
package
{
    import flash.display.MovieClip;
    import flash.text.TextField;

    public class UntitledMessage extends MovieClip
    {
        public function UntitledMessage()
        {
            super();

            var icon:btnDontKnow = new btnDontKnow();
            icon.x = 0;
            icon.y = 0;
            addChild(icon);

            var btnLabel:TextField = new TextField();
            btnLabel.text = "Play Intro";
            btnLabel.x = 250;
            btnLabel.y = 275;
            addChild(btnLabel);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:30:29.180

如果源代码似乎被忽略，请尝试故意插入语法错误。删除花括号或类似的东西。

如果仍然没有错误，从 .fla 编译并且这应该是根元素，我会尝试检查 .fla 文件中的 Document Class 属性。它位于 Flash CS6 的“属性”选项卡中的*“**发布”下。*它应该说明 UntitledMessage 是文档类并且已找到该文件。

 *还要确保您正在编辑实际正在读取的文件而不是副本。愚蠢但常见的错误。*

# c++ - Linux、waitpid、WNOHANG 和僵尸

> ID：13482416
> 
> 赞同：6
> 
> 时间：2012-11-20T21:24:41.553
> 
> 标签：c++, c, fork, wait, waitpid

我需要能够：

1.  fork 一个进程并使其成为 execvp（我这样做了）
2.  检查子进程execvp是否成功（不知道如何）
3.  检查子进程是否完成（有问题）

我正在分叉一个进程，我没有任何方法可以检查孩子的 execvp 是否有效。如果它失败了，我需要能够知道它失败了。目前我正在使用

```
-1 != waitpid( pid, &status, WNOHANG ) 
```

但似乎如果 pid 进程的 execv 失败，waitpid 不会返回 -1。

我怎么能检查呢？我阅读了 waitpid 手册页，但我不清楚；也许我的英语不够好。

编辑：为了解释更多：
我正在为家庭作业构建自己的终端。我需要输入一个命令字符串，比如说“ls”，然后我必须执行命令。
孩子分叉后，孩子调用 execvp 以执行命令（在我解析字符串之后），父母需要检查命令末尾是否有'&'。
如果命令末尾不存在符号“&”，则父级需要等待子级执行。

所以我需要知道 execvp 是否失败。如果它没有失败，那么父母使用 waitpid 等待孩子完成它的执行。如果失败，则父母将不会等待孩子。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T21:37:25.090

#2 的一个常见解决方案是在 fork() 之前打开一个管道，然后在 exec 之后的子进程中写入它。在父级中，成功读取意味着 exec 失败；不成功的读取意味着 exec 成功并且写入从未发生。

```
// ignoring all errors except from execvp...
int execpipe[2];
pipe(execpipe);
fcntl(execpipe[1], F_SETFD, fcntl(execpipe[1], F_GETFD) | FD_CLOEXEC);
if(fork() == 0)
{
    close(execpipe[0]);
    execvp(...); // on success, never returns
    write(execpipe[1], &errno, sizeof(errno));
    // doesn't matter what you exit with
    _exit(0);
}
else
{
    close(execpipe[1]);
    int childErrno;
    if(read(execpipe[0], &childErrno, sizeof(childErrno)) == sizeof(childErrno))
    {
        // exec failed, now we have the child's errno value
        // e.g. ENOENT
    }
} 
```

这让父级明确知道 exec 是否成功，并且作为副产品，如果不成功，errno 值是什么。

如果 exec 成功，子进程可能仍会失败并显示退出代码，并且使用`WEXITSTATUS`宏检查状态也会为您提供该条件。

注意：`waitpid`使用`WNOHANG`标志调用是非阻塞的，您可能需要轮询进程，直到返回有效的 pid。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T21:32:37.987

如果成功，则 exec 调用根本不应该返回，因为它将当前进程映像替换为另一个，因此如果成功，则表示发生了错误：

```
execvp(...);
/* exec failed and you should exit the
   child process here with an error */
exit(errno); 
```

要让父进程知道是否`exec`失败，您应该阅读子进程的状态：

```
waitpid(pid, &status, WNOHANG); 
```

然后使用`WEXITSTATUS(status)`手册页中的宏：

> WEXITSTATUS(status) 返回子节点的退出状态。 **这由状态参数的最低有效 8 位组成，子进程在调用 exit(3) 或 _exit(2) 时指定或作为 main() 中的 return 语句的参数**

请注意最后一条语句意味着如果`exec`成功并运行该命令，您将获得该命令的功能的退出状态，`main()`换句话说**，您无法通过`exec`这种方式可靠地区分失败和失败的命令**，所以这取决于对你很重要。

另一个问题：

> 如果命令末尾不存在符号“&”，则父级需要等待子级执行。

您需要`wait()`在程序中的某个时刻调用子进程，无论`&`避免使子进程处于*僵尸*状态，

注意：当您使用它时，`WNOHANG`它意味着`waitpid()`如果没有进程更改其状态，它将立即返回，即它不会阻塞，我假设您知道这一点，否则使用`wait()`或调用`waitpid()`作为主循环的一部分。

# nosql - 图数据库解决了关系数据库中难以解决的问题？

> ID：13482417
> 
> 赞同：4
> 
> 时间：2012-11-20T21:24:51.437
> 
> 标签：nosql, relational-database, graph-databases

我有一个客户知道他的数据模型是有向无环图。我们一直在使用节点集合和边的中间表，并且性能非常好。在当前的实现中，我们有不到 100,000 个数据节点，尽管这可能会增长一到两个数量级。他最近开始相信，既然我们有图，那么图数据库（如 Neo4J 或 Titan）会“更好”。

面向图的数据库实际上解决了哪些 SQL 无法解决的问题，或者需要 SQL 客户端进行更多繁重工作的问题？据我所知，路径发现似乎就是**它**，但这不可能是全部。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:35:41.827

在关系数据库中，节点和边将通过它们具有的一些共同值相关联。搜索节点或边通常会涉及查询该值的索引。

在图形数据库中，节点和边直接通过关系数据库用来维护索引内部结构的同一类内部数据库结构相关联。因此，从一个节点或从一个边找到一个节点更像是在关系索引中深入一层，而不考虑节点的数量；而如果您在关系数据库中有数百万个节点，则索引将是几个级别的深度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:14:20.887

简而言之，如果它没有损坏，请不要修复它。如果您或您的客户不清楚优势，只需权衡迁移成本与图形数据库的这种不明确的优势。

由于没有使用上述图形数据库的经验，我只能假设您可以从此类数据库中获得更快的开发，因为您的数据库将更适合您拥有的数据类型。我一直在使用 MongoDB，对我来说最重要的是开发速度，因为查询/写入数据库的简单性，其次是更丰富的文档结构，而无需定义任何模式。您还可以获得一些惊人的功能，例如超级简单的复制、自动故障转移、自动分片等，但在您只有 10 万个文档的情况下，您不太可能很快考虑此类问题。所有主流的关系数据库都可以在小型服务器上运行，并且可以很好地处理这么多的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:28:55.367

实际上它是真的，就像 mongo 具有内置的“地理空间”数据库功能，所以它不必像你想用 mysql 那样处理。您提到的两个数据库（我与 titan 合作过）更适合绘图，并且对您的 php 或 db 语句不会那么苛刻。

# c - OpenGL中的光照

> ID：13482418
> 
> 赞同：1
> 
> 时间：2012-11-20T21:24:56.790
> 
> 标签：c, opengl

我想让这个房间有灯泡效果，但我不确定它有什么问题。到目前为止，光线似乎只是照在球体的顶部和圆锥体的侧面，而墙壁没有得到任何光线。我试着摆弄位置和方向，但没有任何效果。

```
#include <GLUT/glut.h>
#include <stdio.h>
#include <stdlib.h>
//Global variables
double sphere = 1, cone = 1, viewy = 2, viewx = -10, viewz = 5,headup = 5,headright = 5;
void myinit(){
    glClearColor(0,0,0,1);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(60,1,1,100);
    glEnable(GL_LIGHTING);
    glEnable(GL_LIGHT0);
    glEnable(GL_DEPTH_TEST);
    glEnable(GL_COLOR_MATERIAL);
    //glOrtho(-2,20,-2,20,-10,10);
}
void drawRoom(){
    //floor
    glBegin(GL_POLYGON);
    glColor3f(1,1,1);
    glVertex3f(0,0,0);
    glVertex3f(0,10,0);
    glVertex3f(10,10,0);
    glVertex3f(10,0,0);
    glEnd(
    );
    //wall
    glBegin(GL_POLYGON);
    glColor3f(0,0,1);
    glVertex3f(0,10,0);
    glVertex3f(0,10,10);
    glVertex3f(10,10,10);
    glVertex3f(10,10,0);
    glEnd();
    //wall2
    glBegin(GL_POLYGON);
    glColor3f(0,1,0);
    glVertex3f(10,10,0);
    glVertex3f(10,10,10);
    glVertex3f(10,0,10);
    glVertex3f(10,0,0);
    glEnd();
}
void drawObjects(){
    //draw cone
    glShadeModel(GL_FLAT);
    glColor3f(1,0,1);
    glTranslatef(2,2,0);
    glutSolidCone(cone,5,10,2);
    //draw sphere
    glShadeModel(GL_SMOOTH);
    glTranslatef(5,5,0);
    glColor3f(1,0,0);
    glutSolidSphere(sphere,500,500);

}
void move(unsigned char key, int x, int y){
    switch(key){
        case 'y': 
            viewy++;
            glutPostRedisplay();
            break;
        case 'x':
            viewx++;
            glutPostRedisplay();
            break;
        case 'z':
            viewz++;
            glutPostRedisplay();
            break;
        case 'Z':
            viewz--;
            glutPostRedisplay();
            glutPostRedisplay();
            break;
        //moves head
        case 'd':
            headup--;
            headright--;
            glutPostRedisplay();
            break;
        case 'a':
            headup++;
            headright++;
            glutPostRedisplay();
            break;
    }
}

void display(){
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    gluLookAt(viewx,viewy,viewz,headup,headright,5,0,0,1);
    glClear(GL_COLOR_BUFFER_BIT);
    drawRoom();
    GLfloat light_position[] = {5.0,5.0,10.0,0.0};
    GLfloat light_direction[] = {-5,-5,-5};
    GLfloat amb[] = {0,0,0,1};
    glLightfv(GL_LIGHT0, GL_POSITION, light_position);
    glLightfv(GL_LIGHT0, GL_SPOT_DIRECTION,light_direction);
    glLightfv(GL_LIGHT0, GL_AMBIENT,amb);
    drawObjects();
    glutSwapBuffers();
    glFlush();
}
int main (int argc, char** argv)
{
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_RGB | GLUT_DOUBLE);
    glutInitWindowSize(500,500);
    glutInitWindowPosition(100,100);
    glutCreateWindow("Room");
    myinit();
    glutDisplayFunc(display);
    glutKeyboardFunc(move);
    //glutMotionFunc(moveHead);
    glutMainLoop();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:16:06.297

第一：您必须提供法线。

第二：OpenGL 固定函数管道仅在顶点评估照明，然后进行重心颜色插值。盒子内部某处有光源的角落接收的光线最少。使用仅由 6 个四边形组成的盒子，您不会得到很好的衰减，而只会得到昏暗的墙壁。您要么必须使用片段着色器来实现*每个片段照明*（推荐），要么将四边形细分为形成墙壁的合理数量的较小四边形，以便有足够的插值采样点来评估照明。

# javascript - 试图在 swf 中注册 ExternalInterface.addCallback()

> ID：13482419
> 
> 赞同：0
> 
> 时间：2012-11-20T21:24:56.010
> 
> 标签：javascript, flash, externalinterface

我不是 Flash 开发人员。我正在尝试将通信*从*javascript*连接到*.swf 文件。我发现[这里](https://stackoverflow.com/questions/1216446/how-can-i-update-the-text-in-a-loaded-swf-file-with-javascript-as3)和其他地方最简单的方法是使用`ExternalInterface.addCallback()`. 我使用了上面的链接以及[官方文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html)作为参考。

我很确定我不会[像这样](https://stackoverflow.com/questions/302829/as3-externalinterface-addcallback-is-not-working-right)过早地调用 flash 文件中的方法。

这是我的 HTML（我直接从文档中得到）：

```
<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="Project" width="1024" height="768" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab">
    <param name="movie" value="Project.swf" />
    <param name="quality" value="high" />
    <param name="bgcolor" value="#869ca7" />
    <param name="allowScriptAccess" value="always" />
    <embed src="Project.swf" quality="high" bgcolor="#869ca7" width="1024" height="768" name="Project" align="middle" play="true" loop="false" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer"> </embed>
</object> 
```

我的Javascript：

```
function sendToActionScript(value) {        
    GetSWF("Project").updateText(value);
}

function GetSWF(strName) {
    if (window.document[strName] != null)
        if (window.document[strName].length == null)
            return window.document[strName];
        else
            return window.document[strName][4];
    else
        if (document[strName].length == null)
            return document[strName];
        else
            return document[strName][5];
} 
```

相关的 AS：

```
public function Project_Main() 
{
    commune();
}

public function commune()
{
    if (ExternalInterface.available) {
        ExternalInterface.addCallback("updateText", updateText);
    }
    else
    {
        var displayText:TextTheme = new TextTheme(_ArialBlack, 100, 100, 800, 500, 42);
        addChild(displayText);
        displayText.text = "ERROR:ExternalInterface.NOTavailable";
    }
}

private function updateText(pid:String, playerName:String):void 
{
    var displayText:TextTheme = new TextTheme(_ArialBlack, 100, 100, 800, 500, 42);
    addChild(displayText);
    displayText.text = "PLAYER ID:" + pid + " PLAYER NAME:" + playerName;
} 
```

[我在这里](https://stackoverflow.com/a/1748280/374866)读到您无法托管您的文件，`C:\`因此我将 HTML 从`http://localhost`.

当我尝试打电话时，`sendToActionScript("test");`我收到此错误：

```
Error: Error calling method on NPObject. 
```

这听起来像是一个权限问题，但正如你所见，我有`allowScriptAccess=always`. 我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:11:57.983

在JS中有1个参数，

```
GetSWF("Project").updateText(**value**); 
```

但正如 AS 所说，应该是其中两个

```
private function updateText(pid:String**, playerName:String**):void 
```

# ruby-on-rails - 连接表的条件 - Rails

> ID：13482424
> 
> 赞同：0
> 
> 时间：2012-11-20T21:25:21.070
> 
> 标签：ruby-on-rails, postgresql

我的模型：

```
class Review < ActiveRecord::Base 
  belongs_to :business

class Business < ActiveRecord::Base
  has_many :reviews
  has_and_belongs_to_many :categories 
```

我想获得特定类别下企业的评论：

```
Review.joins(:business => :categories).where(:business => {:categories => [1,2,3,4]}) 
```

结果查询：

```
SELECT "reviews".* FROM "reviews" INNER JOIN 
"businesses" ON "businesses"."id" = "reviews"."business_id" INNER JOIN 
"businesses_categories" ON "businesses_categories"."business_id" = "businesses"."id" 
INNER JOIN "categories" ON "categories"."id" = "businesses_categories"."category_id" 
WHERE "business"."categories" IN (1, 2, 3, 4) 
```

但是，我收到以下错误：

```
ActiveRecord::StatementInvalid: PG::Error: ERROR:  missing FROM-clause entry 
for table "business"
LINE 1: ...id" = "businesses_categories"."category_id" WHERE "business"... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:35:45.787

用这个：

```
Review.joins(:business => :categories).where( :categories => { :id => [1,2,3,4] } ) 
```

# node.js - Node.js 和 Express.js 布局

> ID：13482427
> 
> 赞同：2
> 
> 时间：2012-11-20T21:25:39.480
> 
> 标签：node.js, model-view-controller, express

这对于我的快速应用程序结构来说是一个可接受的布局吗

**模型** Mongoose 模型和应用程序模式

**查看** Jade 模板文件

**路由** 路由文件

**控制器** 表单处理和 API 处理 (POST/JSON)

如果这不是构建应用程序的最佳方式，那是什么，有什么例子吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T01:38:03.923

[这是](https://github.com/visionmedia/express/tree/master/examples/mvc)直接来自 Express 代码示例的示例。

同样，[这里](https://stackoverflow.com/questions/5178334/)有一个关于同一主题的问题。

请注意，Express 有多种潜在用途，因此此处的说明性指导有限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-10T09:51:09.157

试试[express-orm-mvc](https://github.com/ddo/express-orm-mvc) 一个简单的包，支持 express 和 orm 的 mvc 模板

# jquery - 在变量中添加变量？

> ID：13482432
> 
> 赞同：0
> 
> 时间：2012-11-20T21:26:20.843
> 
> 标签：jquery

> **可能重复：**
> [在 PHP 中执行字符串连接的最佳方法是什么？](https://stackoverflow.com/questions/4311272/which-is-the-best-method-to-perform-string-concatination-in-php)

我试图将一个变量和字符串添加到另一个变量，如下所示：

```
finalData += $ajaxData + 'some text'; 
```

无济于事。结果什么都没有。有什么建议吗？谢谢

**编辑：我犯了一个重大错误！我忘记了我正在使用 Jquery！这是漫长的一天，对不起！:)**

模组请删除问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:27:07.487

php中的字符串连接是用a完成的，`.`所以你需要这样做：

```
$finalData .= $ajaxData . 'some text'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:29:04.920

```
finalData += ajaxData +'some text'; 
```

# git - Git 使不同的分支保持同步

> ID：13482433
> 
> 赞同：6
> 
> 时间：2012-11-20T21:26:23.087
> 
> 标签：git, merge, workflow, branch

我一直在一个分支上工作`new_feature`：

```
A -- B -- C -- D    master
      \    \
       \    1 -- 2 -- 3  new_feature
        \
         E -- F -- G  port 
```

我们的代码库还有一个较旧的分支`port`，其中另一个开发人员将我们的产品移植到另一个 RDBMS。`port`尚未准备好合并回`master`.

最近有必要`new_feature`在`port`. 所以我将这两个合并到一个新的分支`port/new_feature`中，并在那里进行了一些提交 (I, J) 以使其工作：

```
A -- B -- C -- D    master
      \    \
       \    1 -- 2 -- 3 -- I* -- J* -- K new_feature
        \              \
         E -- F -- G -- H -- I -- J -- K*  port/new_feature
                  port 
```

我将 I 和 J 重新选择为`new_feature`（如 I*、J*），因为它们涉及到我也想参与的重大重构`new_feature`。我也一直在对`new_feature`需要提交到`port/new_feature`(K*) 的新提交 (K)。

展望未来，保持`new_feature`和`port/new_feature`同步的最佳计划是什么（*但仅限于新变化*）？我是否应该从一个到另一个（反之亦然）继续挑选提交？或者有没有一种方便的方法通过合并来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T07:58:12.167

摘樱桃很危险，因为：

*   `I-J-K`重复提交（下一次合并会很复杂，因为 Git 会尝试在...之上重新申请`I-J-K`）。
    如果您将一个分支重新设置在另一个分支之上，则不会出现这种情况（请参阅“ [Git cherry pick 和数据模型完整性](https://stackoverflow.com/questions/2627953/git-cherry-pick-and-datamodel-integrity/2628915#2628915)”），但在您的情况下这是不可能的。

*   功能依赖项（请参阅“[如何在 git 中合并特定提交](https://stackoverflow.com/questions/881092/how-to-merge-a-specific-commit-in-git/881112#881112)”），但我怀疑在您的情况下这不是问题：`I`并且`J`不依赖于 `H`，并且可以安全地应用于`3`.

如果您不打算将端口和新功能合并在一起，那么樱桃采摘很方便。
如果是这样，请继续采摘樱桃。

# asp.net - 设置防火墙以允许访问 ASP.NET 应用程序

> ID：13482435
> 
> 赞同：0
> 
> 时间：2012-11-20T21:26:31.423
> 
> 标签：asp.net, windows-firewall

我在同一个局域网上有两台电脑（通过路由器）。一台计算机安装了 ASP.NET 应用程序。仅当我将公共网络的 Windows 防火墙设置为关闭时，我才能从第二台计算机运行此应用程序。我不想为任何应用程序设置防火墙关闭，而只想为这个特定的 ASP.NET 应用程序设置防火墙。我该怎么做？我在防火墙中的哪个位置指定只允许一个 ASP.NET 应用程序？

预先感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:32:01.693

允许入站端口 80 和 443？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-19T16:01:18.433

在 Windows 防火墙中，确保“万维网服务（HTTP 流量输入）”规则已打开。这对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:20:23.287

它是托管在 IIS 中的应用程序还是自托管的？您可以通过网络浏览器访问它吗

```
 http://localhost/<your_application_Name> 
```

那么应该是80端口。

否则，您可能需要运行命令 promt 和“netstat -a”来查找端口。如果您知道端口，请在防火墙中为其添加入站规则。

# javascript - html app-like页面

> ID：13482436
> 
> 赞同：0
> 
> 时间：2012-11-20T21:26:34.547
> 
> 标签：javascript, html, css

我试图找到一个教程或网站来描述像deck.js 或html5rocks 这样的工具是如何工作的。我想学习的是制作类似应用程序的网页，能够在不重新加载的情况下切换到新页面并带有一些漂亮的动画。

很抱歉打扰您，但我所有的搜索都指向了使用该框架创建演示文稿的手册。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:35:21.423

您正在寻找的是有关单页应用程序或 SPA 的信息，供知情人士使用。我对 Deck.js 没有太多经验，但从我刚刚看到的来看，它看起来相当令人印象深刻。在我看来，优秀的 SPA 应用程序的基础是 Knockout.js 和 jQuery。Deck 似乎没有处理任何模型绑定、更改跟踪等，因此您应该可以很容易地将其与 SPA 应用程序混合使用。那里有很多非常棒的教程，John Papa 刚刚在 PluralSight.com 上发布了关于 SPA 开发和架构的精彩演示。

在与各种形式的 SPA 打交道将近一年之后，我可以告诉你，一个从不“重新加载”的应用程序可能会遇到一些非常疯狂的问题；内存管理是最重要的。我选择了部分重新加载，因为在每个站点中，“部分”都是单页的，但是您使用回发加载每个部分。这使您可以清除任何内存问题、绑定等，并且从长远来看将使应用程序运行更加顺畅。也就是说，直到所有与记忆有关的问题都成为过去......

希望这一切对您有所帮助，祝您好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:32:00.913

如果您想这样做，请访问 jquerymobile.com。使用他们的框架，就像您要制作一个应用程序并将其扩展到网页一样。但是您应该研究的“技术”是ajax，它可以在不刷新页面等的情况下刷新数据等。jquery（用于网站）也可以帮助您处理幻灯片弹出等。警告，如果对IE完全有效的话，几乎没有

[http://jquerymobile.com/](http://jquerymobile.com/)

用它来开始你，他们有一个非常酷的拖放功能，你可以看到他们的代码，它会为你连接事件，它会让你开始

# java - MapRouteOverlay 类型中的重复方法 MapRouteOverlay(GeoPoint, GeoPoint, int)

> ID：13482438
> 
> 赞同：0
> 
> 时间：2012-11-20T21:26:40.013
> 
> 标签：java, android

我试图用我的构造函数解决这个问题，它给了我一个重复的方法错误：

```
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.Point;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapView;
import com.google.android.maps.Overlay;
import com.google.android.maps.Projection;

public class MapRouteOverlay extends Overlay {
private GeoPoint gp1;
private GeoPoint gp2;

private int mode=0;
private int defaultColor;

public MapRouteOverlay(GeoPoint gp1, GeoPoint gp2, int mode) { 
    this.gp1 = gp1;
    this.gp2 = gp2;
    this.mode = mode;
    defaultColor = 999;
}

public MapRouteOverlay(GeoPoint gp1, GeoPoint gp2, int defaultColor) { 
    this.gp1 = gp1;
    this.gp2 = gp2;
    this.mode = mode;
    this.defaultColor = defaultColor;
}

public int getMode() { 
    return mode;
}

public boolean draw(Canvas canvas, MapView mapView, boolean shadow, long when) { 
    Projection projection = mapView.getProjection(); 
    if (shadow == false) { 
        Paint paint = new Paint();
        paint.setAntiAlias(true);
        Point point = new Point();
        projection.toPixels(gp1, point);

        if (mode==2) {
            if(defaultColor == 999)
                paint.setColor(Color.RED);
            else 
                paint.setColor(defaultColor);
            Point point2 = new Point();
            projection.toPixels(gp2, point2);
            paint.setStrokeWidth(5);
            paint.setAlpha(120);
            canvas.drawLine(point.x, point.y, point2.x, point2.y, paint);
        }
    }
    return super.draw(canvas, mapView, shadow, when);
}
} 
```

我得到的错误是：Duplicate method MapRouteOverlay(GeoPoint, GeoPoint, int) in type MapRouteOverlay

我希望他们成为构造函数。我该如何解决这个问题才能正常工作？任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:27:45.763

你不满足重载规则。

```
public MapRouteOverlay(GeoPoint gp1, GeoPoint gp2, int mode) { 
```

您有一个具有相同数量和类型的参数的重复构造函数。

## java中方法重载的规则（也适用于构造函数）：

1.  必须有不同的参数列表。
2.  可能抛出不同的异常
3.  可能有不同的返回类型（在方法重载的情况下）

您将不得不像这样更改您的构造函数签名之一：

```
public MapRouteOverlay( int mode,GeoPoint gp1, GeoPoint gp2) { 
      this(gp1,gp2, mode); //if your super class does not have an no-args constructor,this must be the first line in an overloaded constructor, a call to this() or super();
      //rest of your code.
  } 
```

# java - Ant 和 Junit 测试 java.lang.ClassNotFoundException

> ID：13482439
> 
> 赞同：2
> 
> 时间：2012-11-20T21:26:43.050
> 
> 标签：java, linux, ant, junit

我遇到了一个 ant build.xml 文件的问题，它给了我一个 java.lang.ClassNotFoundExcpetion。我可以在 Windows 上很好地运行它，但是当我将它移植到 Linux vm 时，我得到了异常。

```
<project name="OBJECT" default="compile" >
<!--
Properties for the directories of .java
These are the locations the the source files
These are the locations of the .jar dependancy
 -->
<property name="src.dir" location="src"/>
<property name="src.java.dir" location="${src.dir}/csc439"/>
<property name="src.test.dir" location="${src.dir}/test"/>
<property name="lib.dir" location="lib"/>

<!--
Properties for the directories of .class
This gets deleted when ant clean is run
 -->
<property name="target.dir" location="target"/>
<property name="target.classes.java.dir" location="${target.dir}/classes/java"/>
<property name="target.classes.test.dir" location="${target.dir}/classes/test"/>

<!--Properties for the report directory-->
<property name="target.report.dir" location="${target.dir}/report"/>
<!-- 
compile.java 
Creates a directory for the .class files of the Java files for the file being tested
Compiles the files and places the .class into the java file created
Imports the necissary .jar files from the lib directory
-->
<target name="compile.java">
        <mkdir dir="${target.classes.java.dir}"/>
        <javac includeantruntime="true" destdir="${target.classes.java.dir}">
            <src path="${src.java.dir}"/> 
            <classpath> 
                <pathelement location="${target.classes.java.dir}"/>
                    <pathelement location="${lib.dir}"/>
                <fileset dir="${lib.dir}"> 
                    <include name="*.jar"/>
                </fileset> 
            </classpath> 
        </javac>
    </target>
<!-- 
compile.test 
Depends on compile.java to complete first
Creates a directory for the .class files of the Test files
Compiles the files and places the .class into the test file created
-->
<target name="compile.test" depends="compile.java">
    <mkdir dir="${target.classes.test.dir}"/>
    <javac includeantruntime="true" destdir="${target.classes.test.dir}">
        <src path="${src.test.dir}"/>
        <classpath>
            <pathelement location="${target.classes.java.dir}"/>
                <pathelement location="${lib.dir}"/>
            <fileset dir="${lib.dir}"> 
                <include name="*.jar"/>
            </fileset> 
        </classpath>
    </javac>
</target>
<!-- 
compile
This the the default
Depends on compile.java, and compile.test
-->
<target name="compile" depends="compile.java,compile.test"/>
<!-- 
test
Depends on compile
Creates the report file
Runs the JUnit test TestCacheSuite in the test file in the test .class directory
--> 
<target name="test" depends="compile">
    <mkdir dir="${target.report.dir}"/>
    <junit printsummary="yes" haltonerror="yes" haltonfailure="yes" fork="yes">
        <formatter type="plain" usefile="false"/>
            <formatter type="xml"/>
        <test name="test.TestMediaPlayer" todir="${target.report.dir}"/>
        <classpath>
            <pathelement location="${target.classes.java.dir}"/>
            <pathelement location="${target.classes.test.dir}"/>
        </classpath>
    </junit>
</target>   
<!-- 
report
Depends on test
Creates the file for html documents
Depends on Test
Creates a Junit report 
--> 
<target name="report" depends="test">
    <mkdir dir="${target.report.dir}/html"/>
    <junitreport todir="${target.report.dir}">
        <fileset dir="${target.report.dir}">
            <include name="TEST-*.xml"/>
        </fileset>
        <report todir="${target.report.dir}/html"/>
    </junitreport>
</target>
<!--
clean
Deletes the target directory
This file contains all of the .class files
This file contains all of the reports
-->
<target name = "clean">
    <delete dir = "${target.dir}"/>
</target> 
```

这是我在linux上运行时遇到的错误。

```
 [junit] Running test.MockObject
[junit] Testsuite: test.MockObject
[junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 0 sec
[junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 0 sec
[junit]
[junit]     Caused an ERROR
[junit] test.MockObject
[junit] java.lang.ClassNotFoundException: test.MockObject
[junit]     at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
[junit]     at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
[junit]     at java.security.AccessController.doPrivileged(Native Method)
[junit]     at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
[junit]     at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
[junit]     at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
[junit]     at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
[junit]     at java.lang.Class.forName0(Native Method)
[junit]     at java.lang.Class.forName(Class.java:264)
[junit] 
```

使用完全相同的构建文件，我让它在 Windows 上运行良好。

我已经从 Windows 上的命令行很好地运行它，并且使用 Eclipse 都可以完美地工作。

从我阅读的所有内容来看，我需要检查 CLASSPATH 和 PATH 变量。我已经这样做了，但我一定做错了什么。我不明白为什么它会在一个操作系统中运行相同的构建信息，而不是另一个。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T13:24:39.273

对我来说，出现这个问题是因为我的测试文件使用了内部类。这在 Eclipse 中编译为单独的类文件，您将需要 classname.class 和 classname$1.class 来让 ant 运行您的测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:34:01.183

没有大量信息可以继续，但为了冒险猜测，我会说你需要在你的 junit 调用的类路径中添加你的`${lib.dir}`as a `<pathelement>`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-21T07:27:45.193

尝试将 junit jar 位置添加到您的类路径元素。我不知道如何，但这对我有用！

就像是，

```
 <classpath>
            <pathelement location="path/to/junit/jar"/>
            <pathelement location="${target.classes.java.dir}"/>
            <pathelement location="${target.classes.test.dir}"/>
        </classpath> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T21:42:48.533

```
<echoproperties/> 
```

在这种情况下，这是你最好的朋友。如果它在 Windows 上运行良好，但不能在 linux 上运行，那么文件分隔符一定有问题（但是 ant / 也适用于 Windows），或者只是你有不同的当前目录（你在任何地方都使用相对路径） . 如果您有不同的当前目录，您将在`echoproperties`as的输出中看到它`"user.dir"`。您还可以设置`javac`to `verbose="true"`，然后您可以将脚本的 windows 输出与 linux 输出进行比较。

# c# - 隐藏复选框列表的文本

> ID：13482445
> 
> 赞同：1
> 
> 时间：2012-11-20T21:27:00.620
> 
> 标签：c#, asp.net

我有一个复选框列表，我将它与数据库绑定。我只希望复选框部分可见，我不希望关联的项目可见，例如，如果我的复选框列表中有三个项目，我只希望三个文本框可见并且隐藏文本部分。

下面是我的代码

```
 checkboxlist1.DataSource = RadListBox_selectedAssistAgency.Items; 
 checkboxlist1.DataBind(); 
```

请让我知道我怎样才能做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:06:38.740

您是否`DataTextField`为 CheckboxList 分配了一个属性？将其留空可能会对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:38:20.617

如果您只想隐藏文本，可能的解决方案是使用 css 隐藏标签：

CSS：

```
.noText label 
{
    display: none;
} 
```

在后面的代码中，设置 css 类：

```
checkboxlist1.CssClass = "noText";
checkboxlist1.DataSource = RadListBox_selectedAssistAgency.Items; 
checkboxlist1.DataBind(); 
```

或者在 html 文件中设置 css 类：

```
<asp:CheckBoxList ID="checkboxlist1" runat="server" CssClass="noText"> 
```

* * *

另一种可能的解决方案是从项目中删除文本：

```
checkboxlist1.DataSource = RadListBox_selectedAssistAgency.Items; 
checkboxlist1.DataBind();

foreach (ListItem item in checkboxlist1.Items)
{
    item.Text = ""; // Set text to empty.
} 
```

# emacs - Elisp如何将当前坐标写入缓冲区

> ID：13482446
> 
> 赞同：1
> 
> 时间：2012-11-20T21:27:01.753
> 
> 标签：emacs, elisp

所以我有这个功能，它给了我所选文本的开始和结束位置

```
(defun start-end (pos1 pos2)
 "…"
  (interactive "r")
  ; …
  (message "start: %d. end: %d." pos1 pos2)
) 
```

现在我想写入名为“result”的其他文件缓冲区（如果不存在，则创建缓冲区），例如：

```
 pos1,pos2,param1,param2 
```

其中 param1, param2 应该在 cmd 行上询问。我该如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:34:12.417

尝试类似：

```
(defun start-end (pos1 pos2 param1 param2)
  (interactive "r\nsParam1: \nsParam2: ")
  (message "%d,%d,%s,%s" pos1 pos2 param1 param2)) 
```

`interactive`支持一系列不同的输入形式。您可以用换行符分隔它们：s 以使用多个。事实上，您可以提供一个表达式而不是一个字符串，执行它来执行任何交互操作。

编辑：

要创建缓冲区，您可以使用以下内容，它允许您使用所有标准打印功能在新缓冲区中插入任何内容：

```
(defun start-end (pos1 pos2 param1 param2)
  (interactive "r\nsParam1: \nsParam2: ")
  (with-output-to-temp-buffer "*Result*"
    (princ (format "%d,%d,%s,%s" pos1 pos2 param1 param2)))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:17:59.970

这是创建缓冲区的代码（如果它不存在），然后将您想要的文本附加到它：

```
(defun start-end (pos1 pos2)
  (interactive "nStart: \nnEnd: ")
  (switch-to-buffer (get-buffer-create "*start-end*"))
  (goto-char (point-max))
  (insert (format "start: %d. end: %d.\n" pos1 pos2))) 
```

# windows - 如何远程获取DNS信息？

> ID：13482448
> 
> 赞同：0
> 
> 时间：2012-11-20T21:27:07.793
> 
> 标签：windows, dns

我正在尝试获取远程服务器上的 DNS 信息（通过我尚未编码的脚本或程序）。

在 Windows 机器上，我需要获取 DNS 配置。我有两种方法可以在本地获取这些信息：

```
ipconfig /all
netsh interface ip show config 
```

我可以运行这些命令并将它们通过管道传输到 find 中，然后按照我想要的方式输出。我遇到的问题是远程运行它们（我不能使用 PSExec）。netsh 似乎有一个远程标记，但远程运行时显示配置似乎不起作用：

```
netsh -r IP_or_HostName interface ip show config

The following command was not found: interface ip show config. 
```

看起来“config”之前的所有命令都有效。

关于如何使用 netsh 获取我想要的信息或在远程机器上查找 DNS 信息的替代方法的任何想法？

tldr; 如何从远程机器获取 DNS 信息（不使用 PSExec）？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-05-07T14:02:31.507

终于找到/想到了一些东西。获得它的一种方法是通过 WMI。您可以通过 Powershell 或 VBS 访问它。

# c# - 在c#中用单反斜杠替换双反斜杠

> ID：13482450
> 
> 赞同：0
> 
> 时间：2012-11-20T21:27:17.403
> 
> 标签：c#, string, escaping

我需要用单引号替换双引号，以便像这样

```
\\\\servername\\dir1\\subdir1\\ 
```

变成

```
\\servername\dir1\subdir1\ 
```

我试过这个

```
string dir = "\\\\servername\\dir1\\subdir1\\";
string s = dir.Replace(@"\\", @"\"); 
```

我得到的结果是

```
\\servername\\dir1\\subdir1\\ 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:30:00.727

你不需要在这里更换任何东西。反斜杠被转义，这就是它们被加倍的原因。
就像`\t`代表一个制表符，`\\`代表一个单一的`\`. [您可以在 MSDN 上查看](http://msdn.microsoft.com/en-us/library/h21280bw.aspx)*Escape Sequences* 的完整列表。

```
string dir = "\\\\servername\\dir1\\subdir1\\";
Console.WriteLine(dir); 
```

这将输出`\\servername\dir1\subdir1\`.

顺便说一句：您可以使用逐字字符串使其更具可读性：

```
string dir = @"\\servername\dir1\subdir1\"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:32:20.667

替换代码没有问题。你得到的结果是：

```
\servername\dir1\subdir1\ 
```

当您在调试器中查看结果时，它会显示为将被写入文字字符串，因此反斜杠字符显示为两个反斜杠字符。

您创建的字符串不是您认为的那样。这段代码：

```
string dir = "\\\\servername\\dir1\\subdir1\\"; 
```

生成一个字符串，其中包含：

```
\\servername\dir1\subdir1\ 
```

替换代码确实替换`\\`了字符串开头的 。

如果要生成 string `\\\\servername\\dir1\\subdir1\\`，请使用：

```
string dir = @"\\\\servername\\dir1\\subdir1\\"; 
```

或者：

```
string dir = "\\\\\\\\servername\\\\dir1\\\\subdir1\\\\"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:30:50.780

该字符串`"\\\\servername\\dir1\\subdir1\\"`与`@"\\servername\dir1\subdir1\"`. 为了转义反斜杠，您需要`@`在字符串之前使用符号，或者使用双反斜杠而不是一个。

*为什么你需要那个？*因为在 C# 中用于[转义序列](http://msdn.microsoft.com/en-us/library/h21280bw.aspx)的反斜杠。

# magento - Magento 在一个安装中找到模块 XML，而不是另一个

> ID：13482454
> 
> 赞同：0
> 
> 时间：2012-11-20T21:27:39.427
> 
> 标签：magento, magento-layout-xml

我一直在为 Magento 开发一个插件，并且在我的 layout/name.xml 文件中有一个全局块，其中没有 xml 标签：

```
<block name="one.two.three" template="project/button.phtml" /> 
```

这个想法是能够在任何地方调用 getBlockHtml("one.two.three") 并能够看到 beta.phtml。我得到这个工作没有问题。

为了测试我的插件的安装过程，我尝试从头开始安装另一个 magento。我将插件安装到与第一个插件相同的目录中，并从我的旧安装中复制/粘贴了 getBlockHtml，但没有出现任何内容（甚至没有模板提示）！添加默认引用没有帮助。

它显然没有检测到我的 xml 文件，尽管 adminhtml 菜单和 mysql 安装脚本都可以工作。知道为什么会这样吗？是的，我已经无数次清除缓存。

编辑：

两个安装都是版本 1.7.0.2

这两个安装都在同一台计算机上，因此它们的文件系统和外壳可能是相同的。同一台计算机上的两个在区分大小写方面是否会有所不同？

安装插件：我们有一个脚本，可以将文件复制到 Magento 安装中，到目前为止，它在第一次安装时一直在工作，这也是我在第二次安装时一直在做的事情。为了确认，在复制文件时添加了 magento 数据库中的条目和表。

我的布局存储在一个通用布局文件夹中：app/design/layout/projectEmbeds.xml。我意识到这不是常见的约定，但在我开始这个项目之前就是这样，而且它正在工作，所以我没有搞砸它。我认为这个决定是为了让它看起来独立的网站主题。

同样，我的插件存储在 app/code/local/ -> Project/Embeds 中，其中包含块、控制器等、Helper、Model 和 sql。

有问题的 button.phtml 位于 app/design/frontend/default/default/project

我上面目录中etc中存储的config.xml文件如下。任何引用 Project_Banner 的东西都很重要，而 Project_Embed 几乎完全被弃用了。

```
<config>    
<modules>
    <Project_Embeds>
        <version>0.1.0</version>
    </Project_Embeds>
</modules>
<frontend>
    <routers>
        <embeds>
            <use>standard</use>
            <args>
                <module>Project_Embeds</module>
                <frontName>embeds</frontName>
            </args>
        </embeds>
    </routers>  
    <layout>
        <updates>
            <embeds>
                <file>projectEmbeds.xml</file>
            </embeds>
        </updates>
    </layout>
</frontend>
<global>
    <resources>
    <project_embed_setup>
        <setup>
            <module>Project_Embeds</module>
            <class>Project_Embeds_Model_Mysql4_Setup</class>
        </setup>
    </project_embed_setup>
    </resources>
    <models>
        <embeds>
            <class>Project_Embeds_Model</class>
            <resourceModel>embeds_mysql4</resourceModel>
        </embeds>
        <projectbanner>
            <class>Project_Banner_Model</class>
            <resourceModel>banner_mysql4</resourceModel>
        </projectbanner>
        <embeds_mysql4>
            <class>Project_Embeds_Model_Mysql4</class>
            <entities>
                <embeds>
                    <table>project_embed</table>
                </embeds>
                <banner>
                    <table>project_banner</table>
                </banner>
            </entities>
        </embeds_mysql4>
    </models>
    <resources>
        <embeds_setup>
            <setup>
                <embeds>Project_Embeds</embeds>
            </setup>
            <connection>
                <use>core_setup</use>
            </connection>
        </embeds_setup>
        <embeds_write>
            <connection>
                <use>core_write</use>
            </connection>
        </embeds_write>
        <embeds_read>
            <connection>
                <use>core_read</use>
            </connection>
        </embeds_read>
    </resources>
    <blocks>
        <embeds>
            <class>Project_Embeds_Block</class>
        </embeds>
    </blocks>
    <helpers>
        <embeds>
            <class>Project_Embeds_Helper</class>
        </embeds>
    </helpers>
</global>
<admin>
    <routers>
        <thisprojectname>
            <use>admin</use>
            <args>
                <module>Project_Embeds</module>
                <frontName>project</frontName>
            </args>
        </thisprojectname>
    </routers>
    <!-- default admin design package and theme -->
    <design>
        <package>
            <name>base</name>
        </package>
        <theme>
            <default>default</default>
        </theme>
    </design>
</admin>
<adminhtml>
    <menu>
        <embeds translate="title" module="embeds">
            <title>Project</title> 
            <sort_order>9999</sort_order>
            <children>
                <projectbanner module="embeds">
                    <title>Edit Coupon</title>
                    <sort_order>1</sort_order>
                    <action>embeds/adminhtml_banner</action>
                </projectbanner>
            </children>
        </embeds>
    </menu> 
    <layout>
        <updates handle="index_settings">
            <embeds>
                <file>projectEmbeds.xml</file>
            </embeds>
        </updates>
    </layout>
</config> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T11:19:59.797

尝试在您使用的主题中添加 projectEmbeds.xml 文件，即默认我猜

所以加入

```
 /app/design/frontend/default/default/layout/ 
```

并调用里面的块

```
<default></default> 
```

让我知道它是否有帮助..

# sql - SQL Server 2012 中 LEFT OUTER JOIN 的 SQL 语法

> ID：13482462
> 
> 赞同：7
> 
> 时间：2012-11-20T21:27:53.000
> 
> 标签：sql, sql-server, tsql, sql-server-2012

`*=`由于缺乏对( `LEFT OUTER JOIN`) 运算符的支持，我们遇到了 SQL Server 2012 问题。

谁能告诉我在 SQL Server 2008 上正常工作的以下 SQL 的 SQL Server 2012 的正确语法是什么？

```
SELECT 
    t7410.name, t7408.type, t7410.length, 
    t7410.status, t7410.prec, t7410.scale, 
    t7409.type 
FROM 
    dbo.syscolumns t7410, dbo.systypes t7408, 
    dbo.sysobjects t7409, dbo.sysusers t7411, 
    master.dbo.syslogins t7412 
WHERE 
    t7410.id = t7409.id 
    AND t7411.uid = t7409.uid 
    AND t7409.name = 'GENERAL'
    AND t7409.type IN ('U', 'S', 'V') 
    AND t7410.usertype *= t7408.usertype 
    AND t7412.sid = t7411.sid 
    AND t7412.name = user_name() 
ORDER BY 
    t7410.colid ASC 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-20T21:33:52.680

为什么不用 ANSI JOIN 语法来写这个：

```
SELECT t7410.name, t7408.type, t7410.length, 
    t7410.status, t7410.prec, t7410.scale, 
    t7409.type 
FROM dbo.syscolumns t7410
INNER JOIN dbo.sysobjects t7409
    ON t7410.id = t7409.id
INNER JOIN dbo.sysusers t7411
    ON t7411.uid = t7409.uid 
INNER JOIN master.dbo.syslogins t7412 
    ON t7412.sid = t7411.sid 
LEFT JOIN dbo.systypes t7408
    ON t7410.usertype = t7408.usertype 
WHERE t7409.name = 'GENERAL'
    AND t7409.type IN ('U', 'S', 'V') 
    AND t7412.name = user_name() 
ORDER BY t7410.colid ASC 
```

# c++ - 检查文本文件中是否存在单词c ++

> ID：13482464
> 
> 赞同：6
> 
> 时间：2012-11-20T21:27:58.057
> 
> 标签：c++, file, text

我需要检查字典文本文件中是否存在单词，我想我可以使用 strcmp，但我实际上并不知道如何从文档中获取一行文本。这是我目前坚持的代码。

```
#include "includes.h"
#include <string>
#include <fstream>

using namespace std;
bool CheckWord(char* str)
{
    ifstream file("dictionary.txt");

    while (getline(file,s)) {
        if (false /* missing code */) {
            return true;
        }
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:45:31.873

`std::string::find`做这项工作。

```
#include <iostream>
#include <fstream>
#include <string>

using namespace std;

bool CheckWord(char* filename, char* search)
{
    int offset; 
    string line;
    ifstream Myfile;
    Myfile.open (filename);

    if (Myfile.is_open())
    {
        while (!Myfile.eof())
        {
            getline(Myfile,line);
            if ((offset = line.find(search, 0)) != string::npos) 
            {
                cout << "found '" << search << "' in '" << line << "'" << endl;
                Myfile.close();
                return true;
            }
            else
            {
                cout << "Not found" << endl;
            }
        }
        Myfile.close();
    }
    else
        cout << "Unable to open this file." << endl;

    return false;
}

int main () 
{    
    CheckWord("dictionary.txt", "need");    
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T21:33:05.613

```
char aWord[50];
while (file.good()) {
    file>>aWord;
    if (file.good() && strcmp(aWord, wordToFind) == 0) {
        //found word
    }
} 
```

您需要使用输入运算符读取单词。

# c# - 从 c# 应用程序连接到 .aspx 站点

> ID：13482466
> 
> 赞同：0
> 
> 时间：2012-11-20T21:28:00.967
> 
> 标签：c#, asp.net, login, forms-authentication

我正在尝试构建 c# 应用程序，它会在站点中有“更新”时通知我。站点登录表单包含 3 个文本框，它是 login.aspx。

我的问题是，如何将 3 个详细信息“发送”到站点并从我想用 c# 构建的应用程序连接（身份验证），如果可能的话，我该怎么做？我寻找了任何指南或有关此内容的内容，但没有找到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:31:06.823

你需要使用这个`WebClient`类。有关此类的更多信息，请访问[http://msdn.microsoft.com/en-us/library/system.net.webclient(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/system.net.webclient(v=vs.80).aspx)

还有一个很好的例子在[http://msdn.microsoft.com/en-us/library/system.net.webclient(v=vs.80).aspx?cs-save-lang=1&cs-lang=csharp#code-片段 4](http://msdn.microsoft.com/en-us/library/system.net.webclient(v=vs.80).aspx?cs-save-lang=1&cs-lang=csharp#code-snippet-4)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:51:11.053

[首先，您需要使用 c# 发布表单](https://stackoverflow.com/q/1273998/680372)

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create (args[0]);

            // Set some reasonable limits on resources used by this request
            request.MaximumAutomaticRedirections = 4;
            request.MaximumResponseHeadersLength = 4;
            // Set credentials to use for this request.
            request.Credentials = CredentialCache.DefaultCredentials;
            HttpWebResponse response = (HttpWebResponse)request.GetResponse ();

            Console.WriteLine ("Content length is {0}", response.ContentLength);
            Console.WriteLine ("Content type is {0}", response.ContentType);

            // Get the stream associated with the response.
            Stream receiveStream = response.GetResponseStream ();

            // Pipes the stream to a higher level stream reader with the required encoding format. 
            StreamReader readStream = new StreamReader (receiveStream, Encoding.UTF8);

            Console.WriteLine ("Response stream received.");
            Console.WriteLine (readStream.ReadToEnd ());
            response.Close ();
            readStream.Close (); 
```

[然后尝试保存 cookie，它需要将 aspnet_session_id 存储到客户端以供将来请求](https://stackoverflow.com/questions/4740752/how-to-login-with-webclient-c-sharp)

```
private class CookieAwareWebClient : WebClient
{
    public CookieAwareWebClient()
        : this(new CookieContainer())
    { }
    public CookieAwareWebClient(CookieContainer c)
    {
        this.CookieContainer = c;
    }
    public CookieContainer CookieContainer { get; set; }

    protected override WebRequest GetWebRequest(Uri address)
    {
        WebRequest request = base.GetWebRequest(address);
        if (request is HttpWebRequest)
        {
            (request as HttpWebRequest).CookieContainer = this.CookieContainer;
        }
        return request;
    }
} 
```

确保在每个请求上发送并恢复 aspnet_session_id。还有宾果！！

我建议您阅读[此](http://support.microsoft.com/kb/910443)内容。

# c++ - 为什么我的课程没有链接？

> ID：13482467
> 
> 赞同：0
> 
> 时间：2012-11-20T21:28:04.180
> 
> 标签：c++, compiler-errors, g++

这周我开始将我的知识从 C 升级到 C++，我想重载一些运算符

我有一个名为 Matrix 的课程

```
#include "lcomatrix.h"

inline Matrix::Matrix(unsigned rows, unsigned cols) :
        rows_(rows), cols_(cols)
{
        data_ = new double[rows * cols];
}

inline Matrix::~Matrix() {
    delete[] data_;
}

inline double& Matrix::operator()(unsigned row, unsigned col) {
    return data_[cols_ * row + col];
}

inline double Matrix::operator()(unsigned row, unsigned col) const {
    return data_[cols_ * row + col];
} 
```

的内容`lcomatrix.h`是

```
#include <iostream>

class Matrix {
public:
    Matrix(unsigned rows, unsigned cols);
    double& operator()(unsigned row, unsigned col);
    double operator()(unsigned row, unsigned col) const;

    ~Matrix(); // Destructor        
    Matrix& operator=(Matrix const& m); // Assignment operator      

private:
    unsigned rows_, cols_;
    double* data_;
}; 
```

主文件

```
#include "lcomatrix.h"
#include <iostream>

/*-
 * Application entry point.
 */
int main(void) {

    Matrix mx(12,12);

    //std::cout << mx << std::endl;

    return 0;
} 
```

制作文件：

```
CPPFLAGS=-I /path/lcomatrix/
EFLAGS=

all : main.o lcomatrix.o
    g++ $(EFLAGS) -o main.out  main.o lcomatrix.o 

main.o: lcomatrix.o
    g++ $(EFLAGS) $(CPPFLAGS) -c main.cpp

lcomatrix.o: 
    g++ $(EFLAGS) -c /home/robu/UbuntuOne/ChibiOS-RPi/lcomatrix/lcomatrix.cpp

clean:
    rm *.o main.out 
```

当我尝试构建时，我收到以下链接错误：

```
make all 
g++  -c /home/robu/UbuntuOne/ChibiOS-RPi/lcomatrix/lcomatrix.cpp
g++  -I /home/robu/UbuntuOne/ChibiOS-RPi/lcomatrix/ -c main.cpp
g++  -o main.out  main.o lcomatrix.o 
main.o: In function `main':
main.cpp:(.text+0x1b): undefined reference to `Matrix::Matrix(unsigned int, unsigned int)'
main.cpp:(.text+0x2c): undefined reference to `Matrix::~Matrix()'
collect2: error: ld returned 1 exit status
make: *** [all] Error 1 
```

我想这是一个非常愚蠢的错误，但作为一个初学者，我无法找出解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T21:33:40.867

您的方法定义都是`inline`. 为了内联一个函数，编译器在编译使用它的代码时需要查看它的定义。

要么将函数定义放在它们在使用点可以看到的地方——在标题中，或者在 Main.cpp 的另一个文件#included 中——或者不要将它们标记为内联。

# c++ - 如何在 C++ 中定义自定义迭代器

> ID：13482468
> 
> 赞同：2
> 
> 时间：2012-11-20T21:28:20.040
> 
> 标签：c++, iterator

我在 SO 上看到了许多关于如何定义自定义迭代器的帖子，但似乎没有什么能准确回答我的问题，即......

如何创建一个隐藏嵌套 for 循环的迭代器？

例如，我有一个类 Foo，Foo 内部是一个 Bar，Bar 内部是一个字符串。我可以写

```
for (const Foo& foo : foo_set)
  for (const Bar& bar : foo.bar_set)
    if (bar.my_string != "baz")
      cout << bar.my_string << endl; 
```

但相反，我希望能够执行以下操作：

```
for (const string& good : foo_set)
  cout << good << endl; 
```

我该怎么做这样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:55:57.750

已经有关于[分段迭代器的](http://stlab.adobe.com/wiki/index.php/Segmented_Iterators)[提议](http://lafstern.org/matt/segmented.pdf)和讨论，但没有一个真正将其纳入 C++ 标准（然而，无论如何）。

就目前而言，处理它的最干净的方法（无论如何，IMO）是作为项目的集合，每个项目本身都是一个集合：

```
std::ostream &operator<<(std::ostream &os, bar const &b) { 
     return os << b.my_string;
}

std::ostream &operator<<(std::ostream &os, foo const &f) { 
     std::remove_copy_if(f.begin(), f.end(), 
                         std::ostream_iterator<bar>(os, "\n"),
                         [](bar const &b) { return b.my_string != "baz"; });

     return os;
}

std::copy(foo_set.begin(), foo_set.end(), 
          std::ostream_iterator<foo>(std::cout, "\n")); 
```

或者，如果您坚持：

```
for (auto s : foo_set)
    std::cout << s << "\n"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:50:42.930

是的。

什么，你想要更多细节？

这应该有很多帮助：http: [//www.boost.org/doc/libs/1_52_0/libs/iterator/doc/index.html#iterator-facade-and-adaptor](http://www.boost.org/doc/libs/1_52_0/libs/iterator/doc/index.html#iterator-facade-and-adaptor)

或者： http: [//www.boost.org/doc/libs/1_52_0/libs/iterator/doc/iterator_facade.html#usage](http://www.boost.org/doc/libs/1_52_0/libs/iterator/doc/iterator_facade.html#usage) （函数输入迭代器也可以很好地工作）。

你在范围内工作。迭代器的内部状态是内部迭代器、外部迭代器和一个标志的元组，表示您是否在最后。Increment 推进内部迭代器，检查它是否等于内部范围的 end，如果是，则推进外部迭代器，直到它到达外部范围的末尾或非空的内部范围（然后将内部迭代器设置为外部迭代器，如果外部迭代器没有结束！）

取消引用只是取消引用内部迭代器。盲目！（好吧，扔一些断言）

相等性检查外部迭代器是否相等，如果相等则检查是否设置了“结束标志”。如果不是，它比较内部迭代器是否相等。（有没有一种优雅的方法来避免那个结束标志？）

获取第一个元素包括找到第一个非空内部范围的迭代器。

递减有点棘手，但不是您的任务所必需的。

必须注意避免在外部迭代器有效时具有无效的内部迭代器。我想我列出了上面的大部分问题。

# android - sencha touch + phonegap：事件未触发

> ID：13482469
> 
> 赞同：0
> 
> 时间：2012-11-20T21:28:23.107
> 
> 标签：android, eclipse, sencha-touch, applaud

当我的应用程序（用 Sencha Touch 开发）的第一个视图（一个 form.Panel）被绘制时，我需要检查本地数据库的内容。为此，我捕获了第一个视图的绘制事件。这在 Chrome 中运行良好。但是，当我使用带有 Applaud phonegap 包的 eclipse 在我的设备（Asus Transformer tf101）上调试应用程序时，绘制事件永远不会被触发（我将一条消息记录到控制台，我可以在 Chrome 的控制台中看到，仅使用 Sencha Touch ，但它永远不会出现在 eclipse 的 logCat 中，使用 eclipse 和 Applaud。）有什么想法吗？

# ajax - Fineuploader：PHP随机图片名称变量值

> ID：13482472
> 
> 赞同：1
> 
> 时间：2012-11-20T21:28:29.550
> 
> 标签：ajax

我正在使用 Fineuploader 进行更改用户个人资料图片的 ajax 上传，我的 upload.php 文件的一部分如下：

```
function handleUpload($uploadDirectory, $replaceOldFile = FALSE){
    if (!is_writable($uploadDirectory)){
        return array('error' => "Server error. Upload directory isn't writable.");
    }

    if (!$this->file){
        return array('error' => 'No files were uploaded.');
    }

    $size = $this->file->getSize();

    if ($size == 0) {
        return array('error' => 'File is empty');
    }

    if ($size > $this->sizeLimit) {
        return array('error' => 'File is too large');
    }

    $pathinfo = pathinfo($this->file->getName());
    $filename = $pathinfo['filename'];
    //$filename = md5(uniqid());
    $ext = @$pathinfo['extension'];     // hide notices if extension is empty

    if($this->allowedExtensions && !in_array(strtolower($ext), $this->allowedExtensions)){
        $these = implode(', ', $this->allowedExtensions);
        return array('error' => 'File has an invalid extension, it should be one of '. $these . '.');
    }

    $ext = ($ext == '') ? $ext : '.' . $ext;

    if(!$replaceOldFile){
        /// don't overwrite previous files that were uploaded
        while (file_exists($uploadDirectory . DIRECTORY_SEPARATOR . $filename . $ext)) {
            $filename .= rand(10, 99);

        }
    }

    $this->uploadName = $filename . $ext;

    if ($this->file->save($uploadDirectory . DIRECTORY_SEPARATOR . $filename . $ext)){
        return array('success'=>true);

    } else {
        return array('error'=> 'Could not save uploaded file.' .
            'The upload was cancelled, or server error encountered');
    }

} 
```

因此，如果图像以相同的名称上传，它会创建一个带有数字的副本，所以如果 asd.jpg 上传两次，它的 asd44.jpg .. 但我找不到如何创建变量来获取带有随机数的图像路径创建的。

仅上传文件的初始名称。有谁知道如何执行此操作，然后将更新语句发送到数据库？

# c# - 我可以将单位转换应用于 gridview 列吗？

> ID：13482479
> 
> 赞同：0
> 
> 时间：2012-11-20T21:29:19.747
> 
> 标签：c#, asp.net, gridview

我的网格视图中有一个列，它显示从我的数据库表中提取的某些项目的总成本。但是，我的用户也有一个附加到他们的帐户的货币信息。我想做的是根据个人用户的货币信息转换此列。我尝试了以下方法：

```
<asp:HiddenField id="currencyconvfactor" runat="server" />

<asp:TemplateField HeaderText="Total" SortExpression="Total">
    <ItemTemplate>
        <%# currencyconvfactor.Value %> //this is just a test. see below for the issue.
    </ItemTemplate>
</asp:TemplateField> 
```

代码背后

```
protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
            currencyconvfactor.Value = 12345 
            //i simplified retrieving the specific factor value here as I do some database commands to pull the specific value
    } 
```

但是，我注意到模板字段列始终为空。这是否意味着在页面加载事件之前生成了网格视图？如果是这样，我如何在第一页加载时执行列转换？更具体地说，如何访问转换因子以及时执行转换？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:51:15.517

您可能希望查看使用[RowDataBound](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx)事件来访问列并执行您需要的任何计算：

**.aspx：**

```
<Columns>
    <asp:TemplateField HeaderText="Template Field">
        <ItemTemplate>
            <asp:Label ID="lblConvValue" Runat="server" /> 
        </ItemTemplate>
    </asp:TemplateField>
</Columns> 
```

**代码隐藏：**

```
void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        // Get the current row's data
        DataRowView rowView = (DataRowView)e.Row.DataItem;

        // Do your conversion
        var conv = int.Parse(rowView["valueToConvert"].ToString()); 
        var converted = conv * 12345; // Whatever conversion you want.

        // Set the value of the control in the ItemTemplate
        Label lblConvValue= (Label)e.Row.FindControl("lblConvValue");
        lblConvValue.Text = converted.ToString(); 
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:02:19.563

如果所有行都使用相同的货币转换因子，您可以执行以下操作。...

```
 <ItemTemplate>
    <%#GetCurrencyconvfactor()%>
 </ItemTemplate> 
```

...

在后面的代码中定义一个返回值的方法

```
 public string GetCurrencyconvfactor()
    {
        //you can also pass in custID as an argument if each row uses different factor
        return "123"; // or get this from the user profile/settings 
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:44:01.787

定义好值后，调用GridView.DataBind()

# android-ndk - 如何通过 JNI 向 Java 公开本机枚举？

> ID：13482482
> 
> 赞同：4
> 
> 时间：2012-11-20T21:29:26.830
> 
> 标签：android-ndk, java-native-interface

我正在从现有项目中导入标头以将其移植到 Android-NDK。在少数情况下，我想从 Java 层使用本机头文件中定义的枚举。怎么能做到这一点？

理想情况下，我只想以某种方式将常量公开给 Java 层，但我看不到这样做的方法。

最明显的可能性是在 Java 和 C++ 中双重定义枚举。但是，现有的标头 a) 没有明确的编号，b) 具有 #ifdef'ed 的元素，并且 c) 通过 SVN Externals 与现有项目共享。因此，双重定义枚举似乎比典型情况更脆弱。

下一个想法是使用一些构建时代码生成基于预处理的标头在 Java 中创建枚举——可能只是作为整数常量而不是 Java 枚举？

我的第三个也是最模糊的想法是在 Java 中定义枚举，将这些对象传递给 JNI 粘合，并让它与 FindClass()、GetStaticFieldID() 和 GetStaticObjectField() 的某些调用进行比较；然后让 JNI 胶水将它们重新映射到本机枚举。不过，这一切似乎都是低效的。

建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:37:04.110

我会制作一组完全独立的 Java 枚举，并在两者都可用的 JNI 级别上映射它们。确保在枚举类上运行 javah，以便为它们的序数获得一些#defines。

# windows - Qt + MinGW + 对“WinMain@16”问题的另一个未定义引用

> ID：13482485
> 
> 赞同：10
> 
> 时间：2012-11-20T21:29:43.187
> 
> 标签：windows, qt, mingw, winmain

我知道，我挖掘了整个互联网以找出问题所在，但到目前为止没有任何帮助。

我在 Windows 7 上，使用：

```
Qt 4.8.3: https://download.qt.io/archive/qt/4.8/4.8.3/qt-win-opensource-4.8.3-mingw.exe
MinGW32 4.4.0: http://nosymbolfound.blogspot.com/2012/12/since-until-now-qt-under-windows-is.html 
```

我可以用 Qt Creator 编译任何 Qt 演示示例，所以我相信我的系统工作正常。
在尝试编译程序时，我遇到了一个众所周知的问题：

```
g++ -enable-auto-import -o libqlcengine.a object_script.libqlcengine.Debug  -L".\lib" -L"c:\Qt\4.8.3\lib" -lwinmm -L../../hotplugmonitor/src -lhotplugmonitor -lQtScriptd4 -lQtXmld4 -lQtGuid4 -lQtCored4
c:/mingw/bin/../lib/gcc/mingw32/4.4.0/../../../libmingw32.a(main.o):main.c:(.text+0x104): undefined reference to `WinMain@16' 
```

（object_script.libqlcengine.Debug 是一个相当长的 .o 文件列表）
现在，在构建时它正在尝试链接静态 .a 库，所以我认为 MinGW 没有理由寻找 WinMain。我做了 grep 'WinMain' 并在整个源代码树上找不到结果。

如果您想查看原始来源：

```
svn co https://qlc.svn.sourceforge.net/svnroot/qlc qlc 
```

或者我的分叉版本：

```
git clone git://git.code.sf.net/p/qlcplus/code qlcplus-code 
```

他们有相同的结果。
伙计们，我在这里错过了什么？我尝试了一大堆 C 标志（-mwindows -lmingw32 -DQT_NEEDS_MAIN -lqtmain），但没有一个起作用。

请问有什么魔法吗？

PS 当然我可以在 Linux 上构建 i386/amd64

## **解决了：**

我只需将以下行添加到创建库的 .pro 文件中：

```
win32:QMAKE_LFLAGS += -shared 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T21:57:35.763

[**已解决**]

我刚刚发现我需要将以下行添加到创建库的 .pro 文件中：

```
win32:QMAKE_LFLAGS += -shared 
```

# ruby-on-rails - 设计密码重置问题（new_user？）

> ID：13482487
> 
> 赞同：0
> 
> 时间：2012-11-20T21:29:46.307
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise

当用户的电子邮件输入到忘记密码表单并提交时，我收到一条错误消息`login can't be blank`。我四处`devise.en.yml`寻找此错误消息，但似乎无法在任何地方找到它。

这是我的`views/devise/passwords/new.html.haml`：

```
%div.registration_page
  %h2 Forgot your password?
  = form_for(resource, :as => resource_name, :url => user_password_path, :html => { :method => :post, :id => 'forgot_pw_form', :class => 'forgot_pw' }) do |f|
    %div
      = f.email_field :email, :placeholder => 'Email', :autofocus => true, :autocomplete => 'off'
      %div.email_error.error
    %input.btn.btn-success{:type => 'submit', :value => 'Send Instructions'}
  = render "devise/shared/links" 
```

该表格正在发布`users/password`，但我注意到我的忘记密码表格附加了`class = 'new_user'`. 这是我的表单显示的内容：

```
<form accept-charset='UTF-8' action='/users/password' class='new_user' id='forgot_pw_form' method='post' novalidate='novalidate'></form> 
```

我的设计路线（我有自定义会话和注册控制器）：

```
devise_for :users, :controllers => {:sessions => 'sessions', :registrations => 'registrations'} 
```

如何设置设备的忘记密码功能？为什么我会收到此错误消息，为什么要在此处添加该类？

我试过了：

*   添加我自己的密码控制器并为我的自定义控制器添加新路由。同样的错误
*   将我自己的类和 id 添加到表单中。这成功更改了表单的 id 和 class，但恢复为 class 和 id`new_user`

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:02:37.850

我认为您的主要问题可能是以下之一：

1）你的路线看起来没有正确设置它应该看起来像这样

```
 devise_for :users, :controllers => {:sessions => 'devise/sessions', :registrations => 'devise/registrations', :passwords => 'devise/passwords'}, :skip => [:sessions] do 
```

2）您的**密码/new.html.erb**看起来有点不正确，试试这个：

```
<h2>Forgot your password?</h2>

<%= form_for(resource, :as => resource_name, :url => password_path(resource_name), :html => { :method => :post }) do |f| %>
  <%= devise_error_messages! %>

  <div><%= f.label :email %><br />
  <%= f.email_field :email %></div>

  <div><%= f.submit "Send me reset password instructions" %></div>
<% end %>

<%= render "devise/shared/links" %> 
```

3）在您的 config/environments/development.rb 内部执行以下操作：

**发展.rb**

```
#Defined SMTP options
  #config.action_mailer.default_url_options = { :host => "77.100.90.77:3000"
  #SMTP
  config.action_mailer.default_url_options = { :host => 'localhost:3000/' }
  config.action_mailer.delivery_method = :smtp
  config.action_mailer.smtp_settings = {
      :address              => 'smtp.gmail.com',
      :port                 => 587,
      :domain               => 'gmail.com',
      :user_name            => '*****@gmail.com',
      :password             => 'PASS',
      :authentication       => 'login',
      :enable_starttls_auto => true
  } 
```

你可以从这个设置中看到我正在使用 gmail 进行测试。按照我提供的内容应该可以解决您的问题。让我知道这个是否奏效。

**更新**

会假设 authentication_keys 设置 :username 作为必填字段。

尝试编辑 app/views/devise/passwords/new.html.erb，并替换：

```
<%= f.label :email %>
<br />
<%= f.text_field :email %> 
```

和：

```
<%= f.label :username %>
<br />
<%= f.text_field :username %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-17T04:15:06.880

我也有这个问题。我错过了 _method 标签，所以它被路由到 password#create 而不是 password#update

如果是同样的问题，您的表格中的以下内容将使您继续前进：

```
 <input type="hidden" name="_method" value="put" />
```

# ruby-on-rails - 为什么这会产生无限循环？

> ID：13482489
> 
> 赞同：0
> 
> 时间：2012-11-20T21:29:54.703
> 
> 标签：ruby-on-rails, activerecord

我正在尝试将 ActiveRecord 模型（pos）中的字段分配给值 1+ 迄今为止的最高值。以下，在任一版本中，都会产生一个无限循环。我不知道为什么。你能看见它吗？

```
class Question < ActiveRecord::Base
  attr_accessible :text, :pos, :data_type, :active
  has_many :values
  belongs_to :program

  after_initialize :assign_pos

  def row_label
    text
  end

  def self.highest_pos
    self.order("pos DESC").first
  end

  def assign_pos
    puts "********* #{Question.highest_pos + 1}" # option 1
    self.pos = Question.highest_pos + 1 # option 2
  end

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:34:58.497

您的`assign_pos`方法实际上正在初始化`self.pos`，因此由于`after_initialize`条件，`assign_pos`再次调用并初始化`self.pos`...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:32:28.003

“self.order...”实际上是从数据库中选择对象，并调用初始化。初始化后调用assign_pos，它调用highest_pos，一切重新开始。

# c++ - 将文件中的文本输入到 char 变量

> ID：13482490
> 
> 赞同：0
> 
> 时间：2012-11-20T21:29:53.163
> 
> 标签：c++, char, fstream

我有一个变量

```
ifstream inFile("stuff.txt"); 
```

在 stuff.txt 文件中有一个完整的句子：

```
The quick brown fox jumps over the lazy dog 
```

如何将其放入包含所有空格的 char 数组中？

```
char text[250];
inFile >> text; 
```

带我到第一个空间，没有别的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:32:19.513

用于[`ifstream::getline()`](http://en.cppreference.com/w/cpp/io/basic_istream/getline)读入`char`数组或用于[`std::getline()`](http://en.cppreference.com/w/cpp/string/basic_string/getline)读入`std::string`. 当您使用`inFile >> text`空格时，它将充当分隔符，这就是它停在第一个空格的原因。

使用`std::getline()`to read into a`std::string`消除了指定要读取的最大字符数的要求。这消除了缓冲区溢出的可能性，并避免了处理部分读取行的额外复杂性（`> 250`例如，如果在这种情况下有一行）。

始终立即检查 IO 操作的结果：

```
 std::ifstream inFile("stuff.txt");
 if (inFile.is_open())
 {
     std::string line;
     if (std::getline(inFile, line))
     {
         // Use 'line'.
     }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:32:35.487

```
while (!inFile.eof()) {

    inFile >> text;

 } 
```

# python - App Engine 样板的 Google Apps 身份验证给出错误

> ID：13482494
> 
> 赞同：0
> 
> 时间：2012-11-20T21:30:05.360
> 
> 标签：python, google-app-engine, google-apps, boilerplate

我正在尝试学习如何使用[Google App Engine Boilerplate](http://appengine.beecoss.com/)设置 Web 应用程序，该应用程序将限制通过我们的 Google Apps 域登录的人的访问。

我已经下载了 GAE Boilerplate，它在本地和 apppot 上运行。为了限制登录访问，我做了以下事情：

1.  在管理/应用程序设置中，我将身份验证类型设置为 Google Apps 域，并将我们的域名 (xyz.com) 指定为身份验证域。
2.  在`config/production.py`中，我通过`app_name`编辑确认服务器正在正确加载，我设置`'enable_federated_login' : False,`.

但是当我推送应用程序并加载它时，我看到以下令人费解的错误：

```
You must enable Federated Login Before for this application.
Google App Engine Control Panel -> Administration -> Application Settings -> Authentication Options 
```

此错误来自`boilerplate/lib/basehandler.py`，看来我得到了`NotAllowedError`.

有人可以指出设置此样板以使用 Google Apps 身份验证的正确过程吗？谢谢！

# java - HTTPURLConnection Getoutputstream 挂起

> ID：13482496
> 
> 赞同：3
> 
> 时间：2012-11-20T21:30:09.123
> 
> 标签：java, android, post, android-emulator

我正在编写一个 java 代码来将 POST 请求发送到一个 URL，但它被挂在粗体表示的行上。我在安卓模拟器上运行这个

```
URL url = new URL("htt
HttpURLConnection connection = (HttpURLConnection) url.openConnection();
connection.setDoOutput(true);
connection.setRequestMethod("POST");
OutputStream urlc = connection.getOutputStream(); //line on which code is getting hanged
OutputStreamWriter writer = new OutputStreamWriter(urlc);
writer.write("message");
writer.close(); 
```

我也可以在模拟器浏览器上运行互联网。那就是我检查了互联网是否正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-06-15T17:44:22.520

我有同样的问题，我的错误是我设置了太大的超时（120秒）。更大的超时使 HttpUrlConnection 在消耗每一行之前等待更多时间。当我将它减少到 20 秒时，它的工作速度要快得多。

更改前-等待时间为4-5秒更改后-仅0.5-1.5秒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T05:50:07.260

看到[这](https://stackoverflow.com/questions/13134019/http-post-method-passing-null-values-to-the-server/13134287#13134287)是我的答案之一，它将帮助您并指导您正确的方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-04T20:23:04.927

我有同样的问题。您必须启用您的应用程序的计费。

如果未启用计费`HttpURLConnection`，Java 8 环境中的本机 ( ) 将不起作用。

[https://cloud.google.com/appengine/docs/standard/java/issue-requests](https://cloud.google.com/appengine/docs/standard/java/issue-requests)

> 当您的应用程序使用默认行为在 Java 8 中运行时，您必须**启用您的应用程序进行计费**，否则您将收到以下异常：
> 
> *   java.net.UnknownHostException
> *   java.net.SocketTimeoutException
> *   java.io.IOException

另一种选择是使用 legacy `urlfetch`，但是，您会遇到其他问题，例如：

[如果同时使用 Objectify 6.0 和 <url-stream-handler>，则会出现“DatastoreException：请求缺少所需的身份验证凭据”](https://stackoverflow.com/questions/51976220/got-datastoreexception-request-is-missing-required-authentication-credential)

# python - 没有相应的文件和目录： ' \n

> ID：13482497
> 
> 赞同：0
> 
> 时间：2012-11-20T21:30:09.530
> 
> 标签：python

每当有对 的函数调用时，我都会不断收到以下错误`xml(productline)`，但是如果我将函数调用替换为`file = open('config\\' + productLine + '.xml','r')`，它似乎可以工作，为什么？

```
def xml(productLine):
         with open('config\\' + productLine + '.xml','r') as f:
    return f.read()

def getsanityresults(productline):

xmlfile=xml(productline) // replace with file = open('config\\' + productLine + '.xml','r')
dom = minidom.parse(xmlfile)
data=dom.getElementsByTagName('Sanity_Results')
#print "DATA"
#print data
textnode = data[0].childNodes[0]
testresults=textnode.data
#print testresults
for line in testresults.splitlines():
    #print line
    line = line.strip('\r,\n')
    #print line
    line = re.sub(r'(http://[^\s]+|//[^\s]+|\\\\[^\s]+)', r'<a href="\1">\1</a>', line)
    print line
    #print line       
    resultslis.append(line)
print resultslis
return resultslis 
```

错误：

```
Traceback (most recent call last):
 File "C:\Dropbox\scripts\announce_build_wcn\wcnbuild_release.py", line 910, in <module>
  main()
 File "C:\Dropbox\scripts\announce_build_wcn\wcnbuild_release.py", line 858, in main
testresults=getsanityresults(pL)
 File "C:\Dropbox\scripts\announce_build_wcn\wcnbuild_release.py", line 733, in   getsanityresults
  dom = minidom.parse(xmlfile)
File "C:\python2.7.3\lib\xml\dom\minidom.py", line 1920, in parse
   return expatbuilder.parse(file)
File "C:\python2.7.3\lib\xml\dom\expatbuilder.py", line 922, in parse
fp = open(file, 'rb')
IOError: [Errno 2] No such file or directory: '<root>\n    <PL name = "MSM8930.LA.2.0-PMIC-8917">\n 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:41:56.080

> 我用 替换了函数调用`file = open('config\\' + productLine + '.xml','r')`，它似乎有效，为什么？

您有两个变量，名称略有不同：

```
xmlfile=xml(productline) // replace with file = open('config\\' + productLine + '.xml','r') 
```

有`productline`（小写`l`）和`productLine`（大写`L`）。

如果您在两种情况下都使用相同的变量，您可能会看到更一致的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:50:45.553

[`minidom.parse()`](http://docs.python.org/2/library/xml.dom.minidom.html)期望文件名或文件对象作为参数，但您正在传递文件的内容，试试这个：

```
import os
from xml.dom import minidom

doc = minidom.parse(os.path.join('config', productline + '.xml')) 
```

除非您有特定的要求`minidom`；用于[`xml.etree.cElementTree`](http://docs.python.org/2/library/xml.etree.elementtree)在 Python 中使用 xml。它更 Pythonic，[`lxml`](http://lxml.de/)在更复杂的情况下您可能需要支持它的 API，因此您无需学习两次。

# c++ - 失去焦点后如何更新屏幕

> ID：13482506
> 
> 赞同：0
> 
> 时间：2012-11-20T21:30:41.023
> 
> 标签：c++, winapi, visual-c++

我正在开发一个需要禁用 WM_ERASEBKGND 的程序（以避免闪烁）。

当我的主窗口失去焦点，而另一个窗口（另一个程序）获得焦点时，问题就出现了。

每次经过时，具有焦点的窗口（不是我的程序）都会使我的程序的窗口无效！结果是，我的窗口的屏幕在另一个窗口经过的地方变成白色，之后几乎完全空白。显然，我不能有一个程序在每次失去焦点时屏幕都会变白。

即使在我的窗口失去焦点（WM_KILLFOCUS）之后，是否有任何方法可以继续我的窗口的绘图操作（例如，继续调用 wm_paint）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:51:39.910

首先，从上面的评论中，**永远不要**使用or`WM_PAINT`手动发送。用于指示要重新绘制的窗口。`SendMessage``PostMessage``InvalidateRect`

关于`WM_ERASEBKGND`，返回值用于指示`WM_PAINT`处理程序背景已被擦除，以防绘制过程可以优化。要真正防止背景被擦除，只需不要调用`DefWndProc()`该消息。或者更简单，在窗口类中设置`hbrBackground`为。`NULL`

正如其他人提到的那样，焦点与重新绘制无关，即使在背景中，您的窗口也应该正常绘制。

# jquery - 从 textarea 向段落添加换行符

> ID：13482507
> 
> 赞同：1
> 
> 时间：2012-11-20T21:30:42.523
> 
> 标签：jquery

我有一个`textarea`框，用户在其中输入消息，然后输出到`paragraph`标记中。
我成功捕获了文本，但似乎无法捕获换行符。
[这是我的小提琴](http://jsfiddle.net/nalagg/9a68r/1/)

理想情况下是字符串替换，例如我正在寻找的`<br/>`or 。 任何帮助将不胜感激，谢谢。`\n`

```
var txtBox = $('#myTextArea');
var txt = txtBox.val();

txtBox.keyup(function(){
        txt = txtBox.val();
        $('p.msg').html(txt);
});

txtBox.keydown(function (e) {
        var keyCode = e.keyCode || e.which;
        if (keyCode == 13) {
                $('p.msg').append('<br />');//ApplyLineBreaks(txt);
        }
}); 
```

和标记

```
<textarea id="myTextArea" class="form_0" name="Enter your message" type="text"></textarea>
<p class="msg" style="text-align: center;">msg here</p> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T21:36:22.910

您可以只使用 keydown 事件来做到这一点：

```
var txtBox = $('#myTextArea');
txtBox.keydown(function(e){
    var that = this;
    setTimeout(function(){
        $("p.msg").html(that.value.replace(/\n/g,"<br />"));
    },10);
}); 
```

[http://jsfiddle.net/NJwhC/3/](http://jsfiddle.net/NJwhC/3/)

`setTimeout`很重要，它允许在`this.value`访问之前填充 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T21:35:18.880

您可以只使用 CSS 来告诉元素保留空格：

```
p.msg {
    display: block;
    white-space: pre;
}​ 
```

并简化您的 JS 代码：

```
var $txtBox = $('#myTextArea');

$txtBox.keyup(function(){
    $('p.msg').text($txtBox.val());
}).trigger('keyup')​; 
```

**演示：http: [//jsfiddle.net/9a68r/4/](http://jsfiddle.net/9a68r/4/)**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T21:35:09.050

您正在覆盖函数`<br>`中的 s 。`keyup`摆脱该`keydown`功能并将其更改`keyup`为：

```
txtBox.keyup(function(){
    $('p.msg').html(txtBox.val().replace(/\n/g, '<br>'));
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T21:39:49.537

您的处理程序将在运行后立即`keyup`覆盖内容。在你的 keyup 中使用它：`p.msg``keydown`

```
$('p.msg').html(txt.replace("\n","<br/>")); 
```

# php - 为服务器编写与时间相关的 php 脚本

> ID：13482515
> 
> 赞同：0
> 
> 时间：2012-11-20T21:31:10.363
> 
> 标签：php

PHP 有没有办法根据一天中的时间或一周中的一天执行 PHP 函数？即每个星期三将信息存储到数据库中？也就是说，没有任何人查看网页或单击链接以检查是否每次都是星期三？任何帮助都会很好。我需要一种从数据库中读取信息并经常将其写入文件的方法，即每周在我的服务器上一次。我怎样才能完成这些时间相关的任务？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:34:03.180

您正在寻找 crontab（适用于 Linux）或计划任务（适用于 Windows）。您可以通过在服务器上运行 PHP 可执行文件直接从服务器执行任何 PHP 文件。

(Windows) 示例：

```
php.exe -f P:\ath\to\php\file.php 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T21:33:16.987

最好的办法是将 PHP 脚本设置为在 Cron 中运行。

[http://en.wikipedia.org/wiki/Cron](http://en.wikipedia.org/wiki/Cron)

# google-chrome-extension - Chrome 扩展程序：您无权使用阻止 webRequest 侦听器

> ID：13482516
> 
> 赞同：2
> 
> 时间：2012-11-20T21:31:12.810
> 
> 标签：google-chrome-extension

我正在编写一个扩展程序，并在我的后台页面中有这个调用：

```
chrome.webRequest.onBeforeRequest.addListener(function(details) {console.log(details)}, {urls: ["<all_urls>"]}, ["blocking"]); 
```

但是，每当我运行它时，我都会在后台页面的开发工具中收到此错误：

```
Error during webRequestInternal.addEventListener: You do not have permission to use blocking webRequest listeners. Be sure to declare the webRequestBlocking permission in your manifest. 
```

即使我在清单中的权限看起来像这样：

```
"permissions": [
        "cookies",
        "http://*/*",
        "https://*/*",
        "tabs",
        "history",
        "webRequest",
        "webRequestBlocking"
    ] 
```

这到底是怎么回事？这是网络请求文档[http://developer.chrome.com/stable/extensions/webRequest.html](http://developer.chrome.com/stable/extensions/webRequest.html)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T06:01:59.973

使用以下代码对我很有用，为什么要在特定的背景页面中执行此操作？

**截屏**

![在此处输入图像描述](../Images/5226434c9e43bd44069329ce59f35a5c.png)

**清单.json**

```
{
"name":"My First App",
"description":"This is First App",
"version":"1",
"manifest_version":2,
"permissions": [
        "cookies",
        "http://*/*",
        "https://*/*",
        "tabs",
        "history",
        "webRequest",
        "webRequestBlocking"
    ],
"icons":{"16":"icon.jpg"},
"background":{
    "scripts": ["background.js"]
},
"browser_action":{
    "default_popup":"popup.html",
    "default_icon":"icon.jpg"
}
} 
```

**popup.html**

```
<html>
<head>
<script src="popup.js"></script>
</head>
<body>
</body>
</html> 
```

**popup.js**

```
chrome.webRequest.onBeforeRequest.addListener(function(details) {
console.log(details);
}, {urls: ["<all_urls>"]}, ["blocking"]); 
```

**背景.js**

```
function doNothing(){
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T11:44:19.490

我在编写我的第一个 Chrome 扩展程序时遇到了类似的问题：我的解决方案是**删除扩展程序**，修复**manifest.json**并**再次添加扩展程序**。只是停用它并重新激活它不会起作用。

我将扩展加载到 Chrome 并开始调试。当我在代码中发现错误时，我**停用**了扩展程序，修复了错误并再次**激活**了扩展程序。这可以很好地修复代码错误。但是当我尝试以阻塞方式使用 webrequest 模块时，我总是得到“*在 webRequestInternal.addEventListener 期间出错：您无权使用阻塞 webRequest 侦听器。请务必在清单中声明 webRequestBlocking 权限。* ”。无论我如何更改 manifest.json。

# c - C查找所有出现的子字符串

> ID：13482519
> 
> 赞同：0
> 
> 时间：2012-11-20T21:31:19.537
> 
> 标签：c

有没有一种**有效**的方法来查找所有出现的非常量（包括重叠）并输出 C 中 str1`char *str2`中`char *str1`匹配的数字位置（而不是在 C++ 中，因为它不同）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:45:33.567

您的函数将[`strstr()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/strstr.html)在`while`循环中使用以查找 in 的第一个匹配`str2`项`str1`。然后，您可以打印该匹配的偏移量。您将在匹配后的第一个字符处继续搜索。`strstr()`当不再找到匹配项时（通过`strstr()`返回 NULL 表示） ，您将停止循环。

如果您需要不重叠，您需要知道 的长度，`str2`然后在匹配的字符加上 的长度开始下一次搜索`str2`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-20T21:45:15.480

[`strstr()`](http://www.cplusplus.com/reference/clibrary/cstring/strstr/)在循环内使用：

```
int get_substr_count(const char * haystack, const char *needle)
{
    int count = 0;
    const char *tmp = haystack;
    while( tmp = strstr( tmp, needle)){
        printf( "Position: %d\n", (int)(tmp-haystack));
        ++count;
    }
    return count;
} 
```

# c# - LINQ - 无法在不更改多表分组的情况下将列添加到结果中

> ID：13482520
> 
> 赞同：0
> 
> 时间：2012-11-20T21:31:20.570
> 
> 标签：c#, linq, group-by

假设我有一个“数据库”定义为：

```
// Baked goods vendors
   var vendor = new[] {
    new { ID = 1, Baker = "Pies R Us", StMnemon = "NY", Items = 8, Rating = 9 },
    new { ID = 2, Baker = "Mikes Muffins", StMnemon = "CA", Items = 5, Rating = 9 },
    new { ID = 3, Baker = "Best Bakers", StMnemon = "FL", Items = 2, Rating = 5 },
    new { ID = 4, Baker = "Marys Baked Treats", StMnemon = "NY", Items = 8, Rating = 7 },
    new { ID = 5, Baker = "Cool Cakes", StMnemon = "NY", Items = 4, Rating = 9 },
    new { ID = 6, Baker = "Pie Heaven", StMnemon = "CA", Items = 12, Rating = 9 },
    new { ID = 7, Baker = "Cakes N More", StMnemon = "GA", Items = 6, Rating = 8 },
    new { ID = 8, Baker = "Dream Desserts", StMnemon = "FL", Items = 2, Rating = 7 }
};

// Locations
var location = new[] {
    new {ID= 1, State = "New York", Mnemonic = "NY"},
    new {ID= 2, State = "Massachusetts", Mnemonic = "MA"},
    new {ID= 3, State = "Ohio", Mnemonic = "OH"},
    new {ID= 4, State = "California", Mnemonic = "CA"},
    new {ID= 5, State = "Florida", Mnemonic = "FL"},
    new {ID= 6, State = "Texas", Mnemonic = "TX"},
    new {ID= 7, State = "Georgia", Mnemonic = "GA" }
}; 
```

我想构建一个相当于 SQL 查询的查询：

```
SELECT   State, Rating, SUM(Items) AS 'Kinds'
FROM     vendor, location
WHERE    vendor.StMnemon = location.Mnemonic
GROUP BY State, Rating 
```

此查询中有两件事是：

1.  GROUP BY 涉及多个表，并且
2.  结果包含未出现在分组条件中的列的总和。

我已经在有关[按多个表分组](https://stackoverflow.com/questions/8724719/group-multiple-tables-in-linq)和[对不在 group-by 中的列求和](https://stackoverflow.com/questions/3092088/group-by-and-sum-clauses-in-linq)的帖子中看到了解决方案。问题在于，将两者结合起来并不会真正复制关系查询。

我尝试使用以下代码在 LINQ 中复制它：

```
var query = from v in vendor
           join l in location
           on v.StMnemon equals l.Mnemonic
           orderby v.Rating ascending, l.State
           select new { v, l };

var result = from q in query
           group q by new { 
               s = q.l.State, 
               r = q.v.Rating
/* ==> */    , i = q.v.Items
           } into grp
        select new 
        {
            State = grp.Key.s,
            Rating = grp.Key.r
/* ==> */ , Kinds = grp.Sum(k => grp.Key.i)
        }; 
```

这导致：

```
=================================
State           Rating  Kinds
Florida         5       2
Florida         7       2
New York        7       8
Georgia         8       6
California      9       5
California      9       12
New York        9       8
New York        9       4
================================= 
```

然而，上面给出的 SQL 查询给出了这个结果：

```
=========================
State       Rating  Kinds
Florida     5       2
Florida     7       2
New York    7       8
Georgia     8       6
California  9       17
New York    9       12
========================= 
```

The discrepancy is because there seems to be ***no place to put additional columns, other than in the grouping criteria***, which of course changes the grouped result. Commenting out the two lines indicated by the **/* ==> */** comment in the code above will give the same grouping as the SQL result, but of course that removes the summation field that I want to include.

How do we group multiple tables in LINQ and include additional criteria without changing the grouped result?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:53:43.833

something like this seems to return the same as the SQL query:

```
var result = from v in vendor
             from l in location
             where l.Mnemonic == v.StMnemon
             group v by new { l.State, v.Rating } into grp
             orderby grp.Key.Rating ascending, grp.Key.State
             select new {State = grp.Key.State, Rating = grp.Key.Rating, Kinds = grp.Sum(p=>p.Items)};

foreach (var item in result)
        Console.WriteLine("{0}\t{1}\t{2}", item.State, item.Rating, item.Kinds); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T21:54:01.377

You can do an aggregation outside of the group:

```
var query = from v in vendor
           join l in location
           on v.StMnemon equals l.Mnemonic
           orderby v.Rating ascending, l.State
           select new { v, l };

var result = from q in query
           group q by new { 
               s = q.l.State, 
               r = q.v.Rating
           } into grp
        select new 
        {
            State = grp.Key.s,
            Rating = grp.Key.r,
            Kinds = grp.Sum(g => g.Items)
        }; 
```

Grouping is a little tricky to grasp - it returns an `IGrouping` that has one property - `Key`. The actual items in that grouping are returned by the `GetEnumerator()` function that lets you treat the group as a collection of those items, meaning you can do aggregation on the items within that group.

# web-services - 当我们向服务器发送请求时会发生什么

> ID：13482522
> 
> 赞同：0
> 
> 时间：2012-11-20T21:31:27.000
> 
> 标签：web-services, networking, web, network-protocols

我的问题是关于网络请求：

让我们看一个例子：

我想打开一个我的浏览器没有目标 IP 的网站（带有域名）。

我的请求会怎样？

在 tcp-ip 的网络层，我们必须为我们的请求添加一个 ip。但我们没有目标IP。

天津...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:37:17.690

给定域名并需要 IP 地址，您需要的是 DNS 查找。DNS，或域名服务，是互联网的“电话簿”，由一个分层的服务器树组成，每个服务器要么知道如何将域名“映射”或“解析”到 IP 地址，要么知道哪个将您的请求路由到的父或子 DNS 服务器，以使您更接近拥有此信息的服务器。

很高兴知道您在开发中使用的是什么语言、运行时、操作系统和库。使用 DNS 绝不是一个新问题，因此大多数语言和框架都有内置的方法来做到这一点。即使您自己动手，DNS 请求及其响应的结构和协议也是非常有据可查的。但是，鉴于我们对您的项目一无所知，除了它使用 TCP 并且需要一个 IP 地址之外，任何关于您应该如何在您的情况下执行此操作的尝试答案都将是一个未知数。

# iphone - 奇怪的 Objective-C 语法 - 方括号和 @ 符号

> ID：13482523
> 
> 赞同：5
> 
> 时间：2012-11-20T21:31:27.947
> 
> 标签：iphone, objective-c, ios, ipad, syntax

我在我的一个项目中使用 GHSidebarNav，我遇到了分配对象数组的这段代码。我只是不知道它在做什么。它只是一个数组吗？这是什么奇怪的`@[...]`语法？我以前没见过：

```
NSArray *controllers = @[
    @[
        [[UINavigationController alloc] initWithRootViewController:[[GHRootViewController alloc] initWithTitle:@"Profile" withRevealBlock:revealBlock]]
    ],
    @[
        [[UINavigationController alloc] initWithRootViewController:[[GHRootViewController alloc] initWithTitle:@"News Feed" withRevealBlock:revealBlock]],
        [[UINavigationController alloc] initWithRootViewController:[[GHMessagesViewController alloc] initWithTitle:@"Messages" withRevealBlock:revealBlock]],
        [[UINavigationController alloc] initWithRootViewController:[[GHRootViewController alloc] initWithTitle:@"Nearby" withRevealBlock:revealBlock]],
        [[UINavigationController alloc] initWithRootViewController:[[GHRootViewController alloc] initWithTitle:@"Events" withRevealBlock:revealBlock]],
        [[UINavigationController alloc] initWithRootViewController:[[GHRootViewController alloc] initWithTitle:@"Friends" withRevealBlock:revealBlock]]
    ]
]; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T21:39:14.000

这些是数组文字，一种容器文字，在 Xcode 4.4 及更高版本中[可用。](http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/ObjCAvailabilityIndex/_index.html)

看：

*   [使用 Objective C 编程中数组讨论的](http://developer.apple.com/library/ios/documentation/cocoa/conceptual/ProgrammingWithObjectiveC/FoundationTypesandCollections/FoundationTypesandCollections.html#//apple_ref/doc/uid/TP40011210-CH7-SW13)“文字语法”部分
*   [LLVM 站点上的Objective-C 文字](http://clang.llvm.org/docs/ObjectiveCLiterals.html)讨论
*   WWDC 2012 [Modern Objective-C](https://developer.apple.com/videos/wwdc/2012/?id=405)，大约 19-20 分钟
*   WWDC 2012[迁移到现代 Objective-C](https://developer.apple.com/videos/wwdc/2012/?id=413)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T21:34:47.770

这是一个新的目标 C 文字，它声明了一个多维数组。

它正在取代`[NSArray arrayWithObjects:[NSArray arrayWithObjects:...], [NSArray arrayWithObjects:..]]];`

# ruby-on-rails - 将电子邮件附加到电子邮件 rails 2.3.5 升级到 rails 3.017

> ID：13482526
> 
> 赞同：2
> 
> 时间：2012-11-20T21:31:32.633
> 
> 标签：ruby-on-rails, ruby-on-rails-3, actionmailer

在 Rails 2.3.5 中，我们能够使用以下代码将电子邮件作为附件附加到其他电子邮件，这些电子邮件是多部分电子邮件：

```
 recipients to
   from       from
   subject    subject
   content_type "multipart/mixed" 

   part "text/html" do |p| 
     p.body = render_message("rampup_notification.text.html.erb", :mailbody => body)  
   end 

   part "text/plain" do  |p| 
     p.body = render_message("rampup_notification.text.plain.erb", :mailbody => body) 
   end 

    email = enrollment_application.email
   if email != nil && email.raw_email != nil
     attachment :content_type => "message/rfc822", :filename => "icann.eml", :body => email.raw_email, :transfer_encoding => '7bit'
   end 
```

与其他邮件一起使用 Outlook、Exchange 等是非常有气质的。

我如何在 Rails 3 中执行此操作？

我看到： [http ://www.rubydoc.info/docs/rails/3.0.0/ActionMailer/Base:attachments](http://www.rubydoc.info/docs/rails/3.0.0/ActionMailer/Base:attachments)

```
 encoded_content = SpecialEncode(File.read('/path/to/filename.jpg'))
 attachments['filename.jpg'] = {:mime_type => 'application/x-gzip',
                           :encoding => 'SpecialEncoding',
                           :content => encoded_content } 
```

但我不明白如何使用它，SpecialEncode 是我需要编写的一个进行 7 位编码的类吗？

谢谢乔尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T15:59:11.563

所以事实证明 rails 3 actionmailer 非常聪明，这似乎工作正常：

```
@mailbody = body
attachments["icann.eml"] = {:content => email.raw_email }
mail(:to => to, :from => from, :subject => subject) 
```

# ios - %s 和 %d 是什么？

> ID：13482528
> 
> 赞同：0
> 
> 时间：2012-11-20T21:31:35.807
> 
> 标签：ios, sqlite

我正在尝试学习 iOs 编程。我想这是一个相反的问题。

我刚刚在 youtube 上完成了一个教程，使用 Xcode 创建了一个简单的 iPhone 应用程序，它允许您存储、列出和删除 SQLite3 数据库中的数据（因为我想要生成的应用程序需要一个数据库）。

然而，放视频的那个家伙似乎没有解释“为什么”他做了他所做的，所以我现在试图理解每一段代码的作用（我来自 PHP 和 SQL 网络编程背景，所以我了解访问数据库、调用数据行等以在网站上显示内容。）

我不太理解的这个 iOs 位的一部分是使用的 %s 和 %d 值，因为它们似乎没有在任何地方声明。

代码是；

```
if(sqlite3_open([dbPathString UTF8String], &personDB)==SQLITE_OK) {
        NSString *inserStmt = [NSString stringWithFormat:@"INSERT INTO PERSONS(NAME,AGE) values ('%s', '%d')",[self.nameField.text UTF8String],[self.ageField.text intValue]]; 
```

现在 %s 和 %d 清楚地从 self.nameField 和 self.ageField 中获取它们的值。然而，这意味着我只能将两个值提交到一个表中？或者是否有其他值的其他百分比，但肯定有最大值为 26。

如果您能给出任何解释，我将不胜感激。

此外，是否有人对学习 iOS 编码的其他完全解释的方法有任何建议？特别是如果您是第一次学习 iOS 编程且 C 编程技能有限的初学者。我正在寻找的领域是创建一个应用程序，该应用程序将存储一些文本字段和图像，它们将存储在数据库中，图像要么在数据库中，要么作为链接并适当命名。我希望能够操纵图像来调整它的大小，以便它针对 iPhone 显示器进行优化（不需要在 APP 中使用高清图像）稍后我希望能够弄清楚如何上传本地数据库（sqlite3）文件到在线存储（我自己的服务器或保管箱），

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:38:38.417

`%s`和`%d`分别是以空字符结尾的字符数组和带符号的 32 位整数的格式说明符。[您可以在String Programming Guide](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html#//apple_ref/doc/uid/TP40004265-SW1)中找到有关说明符的详细信息。但是，对于 SQLite 语句，您不应该以这种方式格式化字符串，因为这会使您面临 SQL 注入的风险。相反，您应该使用和适当的函数[绑定值](http://www.sqlite.org/c3ref/bind_blob.html)。对于您的情况，您将使用for和for 。`?``sqlite3_bind*``sqlite3_bind_text``NAME``sqlite3_bind_int``AGE`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:39:17.070

这就是所谓的格式化字符串，基本上，它是一种将值注入字符串的方法。% 符号后面的字符用于指示值应格式化为的数据类型。在您的情况下， %s 用于表示字符串值， %d 用于表示十进制整数值。

这种类型的字符串格式非常常见；许多编程语言提供了一些机制来执行这种类型的字符串格式化，并且格式化符号在很大程度上是标准化的。[您可以在 C++ 网站上](http://www.cplusplus.com/reference/clibrary/cstdio/printf/)找到更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:34:20.660

看看类参考： [https ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)

以下是字符串格式说明符： [https ://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html#//apple_ref/doc/uid/TP40004265](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html#//apple_ref/doc/uid/TP40004265)

如您所见，在输出字符串`%d`的同时输出整数。`%s`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T21:35:01.437

第1部分：

% 约定“字符串格式说明符”是字符串替换的通用标准。

它们不是变量，而是类型化的替换占位符。

```
%s --> string
%d --> number 
```

第 2 部分：您可以查看 iTunes U 课程：

Jan Borchers 教授的 iPhone 应用程序编程 '11

[https://itunes.apple.com/us/itunes-u/iphone-application-programming/id474416629](https://itunes.apple.com/us/itunes-u/iphone-application-programming/id474416629)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T21:35:22.653

[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html)

**%s 以** Null 结尾的 8 位无符号字符数组。因为 %s 说明符导致字符以系统默认编码解释，所以结果可能是可变的，尤其是对于从右到左的语言。例如，使用 RTL，当字符没有强方向性时，%s 会插入方向标记。因此，最好避免使用 %s 并明确指定编码。

**%d, %D** 有符号 32 位整数 (int)。

# r - 对每一行的某些列的单元格求和

> ID：13482532
> 
> 赞同：22
> 
> 时间：2012-11-20T21:32:06.463
> 
> 标签：r, rows

我想计算某些列的总和，然后对每一行应用这个总和。不幸的是，我只能迈出第一步。我现在如何让它发生在每一行？我知道 R 不需要循环；什么是好的方法？

我的矩阵（zscore）如下所示：

```
 a    b    c    t   y
1  3    4    7    7   4

2  4    56   6    6   4

3  3    3    2    1   7

4  3    88   9    9   9 
```

现在我想根据一些列计算每一行的行总和。对于一行，它可能如下所示：

```
f1 <- sum(zscore[1,1:2], zscore[1,3], zscore[1,5]) 
```

我现在如何为每一行执行此操作？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-11-20T21:37:55.460

你可以这样做：

```
summed <- rowSums(zscore[, c(1, 2, 3, 5)]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-26T08:23:06.240

所有单个行的求和也可以使用 dplyr 的逐行操作来完成（`col1, col2, col3`定义三个选定的列，为其计算逐行总和）：

```
library(tidyverse)

df <- df %>% 
    rowwise() %>% 
    mutate(rowsum = sum(c(col1, col2,col3))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-21T16:13:09.807

如果你没有 NA 你可以申请这个

```
suma.zscore = (zscore$a + zscore$c + zscore$t + zscore$y) 
```

# php - 更改php文件中数组元素的顺序

> ID：13482538
> 
> 赞同：0
> 
> 时间：2012-11-20T21:32:20.943
> 
> 标签：php, text

不知道如何命名这篇文章。

我只是继承了一组国际化文档，每个文档都包含一个键值对数组。我承认这种方法并不理想，但是，鉴于我的角色、时间和可用资源，我坚持使用这种方法。这些清单是手工创建的，并且项目不断地随意添加以跟上需求。下面的例子被简化了，有大约 21 个语言文件，每个有 100 多个条目。

一个文件中的数组将包含如下元素：

```
'download_high' => 'Vysoké',
'download_low' => 'Nízké',
'download_med' => 'Strední',
'download_video' => 'Stáhnout video', 
```

而另一个文件将具有以下内容：

```
'download_video' => 'Descargar Video',
'download_high' => 'Alta',
'download_med' => 'Media',
'download_low' => 'Baja', 
```

在大多数情况下，元素的顺序是一致的，但也有很多例外，而且它使维护文件变得复杂。我想知道是否有办法通过IDE或notepad ++插件等使这些数组的顺序/格式保持一致。我不想按字母顺序对它们进行排序，因为有些逻辑分组不能很好地转换为字母顺序排序，因为只有一些变量是命名空间的。手动操作几乎是不可能的，但如果有某种方法可以指定顺序并使用某种文本操作工具批量处理文件，那就太好了。我对php不是很熟悉，所以我不知道通过代码来做这件事对我来说是否值得，除非它非常简单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:36:00.467

PHP 有一个函数叫做[`var_export`](http://php.net/manual/en/function.var-export.php). 您可以运行代码，然后使用该函数打印它。

就个人而言，我会在记事本++中运行一些正则表达式来做到这一点。

**编辑**：在记事本++中，您可以使用正则表达式进行查找/替换。

在“查找内容”字段中，输入`\s*'(.+?)'\s*=>\s*'(.+?)'\s*(?:(,)|\s*$)\s*`

在“替换为”字段中，输入`'$1' => '$2'$3\n`

这将变成这样：

```
'download_high'         =>  'Vysoké',
    'download_low'=>                    

    'Nízké',
'download_med'
=>
'Strední'
,
    'download_video'    =>  'Stáhnout video',
'filter_by' => 'Filtrovat podle'
,

'footer_contact' => 'Kontakt' 
```

进入

```
'download_high' => 'Vysoké',
'download_low' => 'Nízké',
'download_med' => 'Strední',
'download_video' => 'Stáhnout video',
'filter_by' => 'Filtrovat podle',
'footer_contact' => 'Kontakt' 
```

*注意：这是在假设所有键和值都使用单引号并且键和值都没有任何转义的单引号的情况下编写的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:43:39.800

鉴于这种情况，我会根据需要半自动进行。也就是说，在我看来，您负责维护这些文件，而在维护中，排序成为问题。

对于格式如下的每种语言文件：

```
<?php
$something = array(
  'download_video' => 'Descargar Video',
  'download_high' => 'Alta',
  ...
  'download_med' => 'Media',
  'download_low' => 'Baja',
); 
```

1.  在 bash 中发出`sort lang.es.php`命令，或者通过您喜欢的方式对某些内容进行排序。
2.  打开文件进行编辑。
3.  删除数组声明。
4.  从#1 复制/粘贴已排序的行。

老实说，对于你的前任来说，有效地硬编码这样的东西是一个非常糟糕的主意。如果通过 CSV、XML、pg/mySQL 等方式存储它会更好，您至少可以调用理解数据格式的编辑器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:35:12.280

如果您要拥有一个不断增长的列表，我不建议使用数组和 php 文件等。现在花几分钟来设置 mysql 并使用您想要的参数从数据库中提取。整洁、快速、高效且可扩展。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T21:36:01.360

我的建议是简单地构建一个脚本以将所有这些数组加载到数据库中，以便更轻松地维护它们。当然，您需要确保为 UTF-8 字符集和排序规则设置了数据库表/字段。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T21:38:00.493

我是否正确理解您已经将数据放入 PHP 数组？此时，您可以这样做来对键进行排序。这将使排序一致：

```
ksort($array); 
```

# android - Kindle软键栏悬停

> ID：13482543
> 
> 赞同：0
> 
> 时间：2012-11-20T21:32:34.520
> 
> 标签：android, layout, toolbar, kindle

如何阻止 Kindle 软键工具栏悬停在我的应用程序上。相反，我希望软键栏将我的应用程序推到一边。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:07:04.173

我不认为这是一个选项，至少在 Kindle Fire HD 上不是这样，我相信这就是您所指的设备。

根据[亚马逊移动应用博客的](http://www.amazonappstoredev.com/2012/10/optimizing-for-soft-key-support-on-kindle-fire-hd.html)说法，“你应该知道软键工具栏和拖动手柄出现在你的内容上，而不是调整可绘制区域的大小。”

# java - 如何修复超出范围的字符串索引？

> ID：13482545
> 
> 赞同：2
> 
> 时间：2012-11-20T21:33:01.213
> 
> 标签：java, string

我的程序遇到了以下问题（仅在尝试运行它时，构建良好）：

```
Exception in thread "main" java.lang.StringIndexOutOfBoundsException: 
String index out of range: 57
at java.lang.String.substring(String.java:1907)
at Question7.main(Question7.java:68) 
```

我知道网站上有类似的问题，但我正在脑海中经历这些步骤，无法弄清楚哪里出了问题。我不认为所问代码/问题的上下文非常重要；我认为问题与以下几行有关：

```
else if (s1.substring(i,i+1).matches("[0-9]"))

if (counthyphen == 3 && countdigits == 9 && (s1.substring(i, i+1).matches("[0-9]") || s1.substring(i, i+1).matches("X"))) 
```

但请你自己看看。帮助将不胜感激！

```
public class Question7
{
public static void main(String args[])
{
    //Declare and initialize.
    String s1 = new String("0-471-34609-8");
    int counthyphen = 0, countdigits = 0;

    //Begin "for" loop.
    for (int i = 0; i < s1.length()-1; i++)
    {
        /////////////////////////////////
        // Check for missing hyphens //
        if (s1.charAt(1) != '-')
        {
            i = s1.length();
        }
        else if (s1.charAt(11) != '-')
        {
            i = s1.length();
        }

        // Now add to the count values //
        if (s1.charAt(i) == '-')
        {
            counthyphen++;
        }
        **else if (s1.substring(i,i+1).matches("[0-9]"))**
        {
            countdigits++;
        }
        /////////////////////////////////
    }

    int i = s1.charAt(s1.length()-1);
    //Check if it's an ISBN and print result.
    **if (counthyphen == 3 && countdigits == 9 && (s1.substring(i, i+1).matches("[0-9]") || s1.substring(i, i+1).matches("X")))**
    {
        System.out.print("This number is an ISBN.");
    }
    else
    {
        System.out.print("This number is NOT an ISBN.");
    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:36:35.660

```
int i = s1.charAt(s1.length()-1); 
```

此代码在索引处存储`ASCII code`: `character`- `s1.length() - 1`，它可以`certainly`大于`maximum`可访问的字符串索引。

**例如**，`last`您当前字符串中的字符是`8`，其`ASCII code`是： - `56`，这肯定会失败。

所以，`s1.substring(i, i+1)`在你的 if 条件下，那之后会失败。

事实上，我根本不明白这条线的需要。你为什么用它？

* * *

另外，在我`if-else`看来，您的障碍`buggy`：-

```
 if (s1.charAt(1) != '-')
    {
        i = s1.length();
    }
    else if (s1.charAt(11) != '-')
    {
        i = s1.length();
    } 
```

为什么你`i`在那里的两个块中分配了相同的值？

**可能**你想要这样的东西： -

```
 if (s1.charAt(1) != '-' || s1.charAt(11) != '-')
    {
        break;  // Just break if not a valid string
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:42:11.877

你在零索引处开始你的 for 循环。

for (int i = 0; i < s1.length()-1; i++)

然而，您的子字符串在以下代码中超出了 i，

.substring(i, i+1)。

在优化说明中，您可以使用正则表达式来检查索引 1 和 11 处的连字符。

# python - Twisted reactor 停止，但程序没有结束？

> ID：13482550
> 
> 赞同：6
> 
> 时间：2012-11-20T21:33:22.727
> 
> 标签：python, twisted

所以我正在编写一个与 Deluge 一起使用的小脚本。Deluge 使用 Twisted，我真的不知道它是如何工作的。通常我只是查找有关它的更多信息，但是开始使用 Twisted 需要*很长时间*，并且超出了这个小项目的范围。所以我想我会在这里问。

现在，我有这个代码。我将尝试解释我需要帮助的规范部分

```
import base64

import processargs

from deluge.ui.client import client
from twisted.internet import reactor

from deluge.log import setupLogger
setupLogger()

options = processargs.readConfig(os.path.expanduser("~/.deluge-automator"))

d = client.connect(
    host=options['host'],
    port=int(options['port']),
    username=options['username'],
    password=options['password']
)

def start():
    #other code

    t = client.core.add_torrent_file(tfile,
                                     base64.encodestring(data), None)

    t.addCallback(on_torrent_added_success, tfile)
    t.addErrback(on_torrent_added_fail)

def handle_stop_signal(SIGNAL, stack):
    client.disconnect()
    reactor.stop()

def on_torrent_added_success(result, tfile):
    #other code
    start()

def on_torrent_added_fail(result):
    print "Add torrent failed!"
    print "result: ", result

def on_connect_success(result):
    #other code
    start()

d.addCallback(on_connect_success)

def on_connect_fail(result):
    print "Connection failed!"
    print "result: ", result

d.addErrback(on_connect_fail)

signal.signal(signal.SIGTERM, handle_stop_signal)
signal.signal(signal.SIGINT, handle_stop_signal)

reactor.run() 
```

成功添加洪流后，它应该返回 start()，它确实如此，但我认为它会丢失反应器或其他东西。因为现在只要收到 SIGTERM 或 SIGINT，反应器就会关闭，但不会退出程序：

```
± % python2 main.py
Connection was successful!
result:  10
^C^CConnection failed!
result:  [Failure instance: Traceback: <class 'twisted.internet.error.ReactorNotRunning'>: Can't stop reactor that isn't running.
/usr/lib/python2.7/site-packages/twisted/internet/defer.py:551:_runCallbacks
/usr/lib/python2.7/site-packages/deluge/ui/client.py:412:__on_login
/usr/lib/python2.7/site-packages/twisted/internet/defer.py:368:callback
/usr/lib/python2.7/site-packages/twisted/internet/defer.py:464:_startRunCallbacks
--- <exception caught here> ---
/usr/lib/python2.7/site-packages/twisted/internet/defer.py:551:_runCallbacks
main.py:70:on_connect_success
main.py:32:start
main.py:49:handle_stop_signal
/usr/lib/python2.7/site-packages/twisted/internet/base.py:577:stop
] 
```

所以反应堆停止了，但它并没有退出程序。我必须两次键盘中断。一次停止反应器，第二次抛出错误。有没有某种方法可以设置这样的循环？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T23:34:53.870

reactor 处理 sigint、sigterm 本身（可能有一个参数`reactor.run()`会禁用它）。`reactor.addSystemEventTrigger('before', 'shutdown', client.disconnect)`改为安装。

见[twisted: catch keyboardinterrupt and shutdown proper](https://stackoverflow.com/q/3453451/4279)。

# oracle - 将 RefCursor 插入表中

> ID：13482554
> 
> 赞同：3
> 
> 时间：2012-11-20T21:33:38.433
> 
> 标签：oracle, plsql

我有一个简单的函数，我在其中运行一个返回 RefCursor 的存储过程，并尝试使用该 RefCursor 将数据插入到临时表中。尝试这样做时出现以下错误：

`SQL Error: ORA-00947: not enough values`

我知道一个事实，即 refcursor 返回与临时表完全相同数量的值、正确的列名、它们的顺序和类型。我跑了`print RefCursor`，我可以看到所有的数据。这是代码：

```
var r refcursor;

EXEC SCHEMA.PACKAGE.SPROC(:r);

insert into SCHEMA.TEMP_TABLE
values
(r); 
```

我必须补充一点，存储过程有一个定义为 OUT 参数的 refcursor，因此它返回正确的类型。使用`print r;`打印正确的数据。

我究竟做错了什么？

编辑：根据一个建议，我尝试使用对 rowtype 变量的获取，但是每当我尝试获取行时都会出现 Invalid Number 异常：

```
DECLARE
cur SYS_refcursor;
rec SCHEMA.TEMP_TABLE%rowtype;

begin
SCHEMA.PACKAGE.SPROC( cur ); 
LOOP
FETCH cur INTO rec;
EXIT WHEN cur%NOTFOUND; 

INSERT INTO SCHEMA.TEMP_TABLE
  VALUES rec;
END LOOP;
EXCEPTION 
WHEN INVALID_NUMBER THEN
DBMS_output.put_line(rec.move_id); 
end; 
```

我添加了异常块以查看哪一行失败，不用说它是第一行。我运行的存储过程返回来自多个表的选择查询的引用。临时表定义为引用列及其类型的精确副本。不确定是什么导致了异常。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T22:34:55.240

您不能从`refcursor`. 您可以编写一个从游标中获取并插入到表中的过程。如果`schema.package.sproc`返回 ref 游标`temp_table%rowtype`，您可以执行类似的操作

```
DECLARE
  cur sys_refcursor;
  rec schema.temp_table%rowtype;
BEGIN
  schema.package.sproc( cur );
  LOOP
    FETCH cur INTO rec;
    EXIT WHEN cur%NOTFOUND;

    INSERT INTO schema.temp_table
      VALUES rec;
  END LOOP;
END; 
```

# c# - 在 C# 中创建自定义日历控件

> ID：13482557
> 
> 赞同：0
> 
> 时间：2012-11-20T21:33:44.657
> 
> 标签：c#, winforms, user-controls

考虑到我在这方面的技能不足，我已经承担了做一些比我最初想象的更难的任务，但我仍然决心完成它。

我正在尝试设计一个简单的自定义 Windows 窗体控件，该控件显示一个小的每周日历。这个想法是我希望它用彩色块填充，以 15 分钟为增量指示使用的时间段。任何一天的时间范围是上午 8 点到晚上 10 点，所以这是 14 小时，每小时 4 个区块，在任何一天总共有 56 个区块。实际使用的最小时间间隔是 1 小时，其次是 1 小时 15 分钟，然后是 2.5 小时。我希望能够将一个对象传递给该控件，该对象表示大学中给定课程的课程表，该课程通常每周进行 3 小时，每天 1 小时，持续 3 天。我希望控件查看对象的数据以确定它需要在日历上黑屏的时间。

现在这是我的问题。您认为哪种控制方式最适合实现这一目标？我的第一个想法是使用某种 datagridview 作为我的自定义控件的基础，它有 56 行和 7 列。我确信这不是最佳的方法（甚至不是一个非常好的方法 - 但这是我能想到的），因为我想不出一种方法可以让控件为 4、5 着色或 10 个连续的块。

有人对我如何解决这个问题有建议吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:25:48.760

试图将该功能硬塞到现有控件中会很快变得复杂。要使用网格，您必须在每次加载新数据对象时以编程方式更改每个单元格的背景颜色。

作为替代方案，您可以做的是拥有一个用户控件，它只通过 GDI+ ( [System.Drawing](http://msdn.microsoft.com/en-us/library/gg145023.aspx) ) 绘制所有内容。让控件的背景只是网格线，并在该网格顶部手动绘制矩形

还有一些第三方控件，我认为如果你愿意的话，它们会给你你正在寻找的东西，他们通常会在谷歌上搜索“outlook scheduler controls”

# c# - 在对象浏览器中看不到引用的 DLL？

> ID：13482559
> 
> 赞同：2
> 
> 时间：2012-11-20T21:33:51.053
> 
> 标签：c#, visual-studio-2010, dynamics-crm, objectbrowser

我有一个应用程序，我添加了对 Microsoft.Xrm.Sdk 和 Microsoft.Xrm.Sdk.Workflow 的引用......但是当我查看对象浏览器时，它们不会出现在对象浏览器中的任何位置。他们过去是，但现在他们没有。关于为什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-10-30T08:47:03.520

该 dll 是针对比您的参考项目更高版本的 .Net FW 构建的。升级您的引用项目的 .Net FW 版本。

# php - PHP CURL - 关注位置和帖子字段的问题

> ID：13482566
> 
> 赞同：2
> 
> 时间：2012-11-20T21:34:09.763
> 
> 标签：php, redirect, curl, session-cookies

我在维护会话 cookie 和发布字段信息时遇到了重定向问题。过程是这样的：

1) 访问 URL，它们返回一个 cookie 和一个 302 响应（指向您刚刚访问的同一个 URL）

2) 使用他们给您的 cookie 重新访问 URL，您可以看到正确的页面。

我可以使用 进入正确的页面`CURLOPT_FOLLOWLOCATION = true`，但是我猜 CURL 在跟随重定向时不会保留帖子字段，因此页面上没有有用的内容。

我已经尝试手动存储 cookie，并使用存储的 cookie 自己执行“重定向”，但是使用这种方法，我永远无法通过 302 重定向到正确的页面。此处提到的手动方法的代码如下。

```
$tmp_name = tempnam('tmp', 'COOKIE');
$url = "MY_URL";

$options = array(
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_REFERER => $url,
    CURLOPT_HEADER => true,
    CURLOPT_POST => true,
    CURLOPT_POSTFIELDS => array(
        'field1' => 'postfield1',
        'field2' => 'postfield2',
    ),
    CURLOPT_VERBOSE => true,
);

// Make the first request, specifying where to store the cookie
// This request returns the cookie and the 302 response
$ch = curl_init($url);
curl_setopt_array($ch, $options);
curl_setopt($ch, CURLOPT_COOKIEJAR, $tmp_name);
$resp1 = curl_exec($ch);

// Make the second request, using the cookie stored above
// Should return the proper page, but gives me the 302 again instead.
$ch = curl_init($url);
curl_setopt_array($ch, $options);
curl_setopt($ch, CURLOPT_COOKIEFILE, $tmp_name);
$resp2 = curl_exec($ch); 
```

有谁知道上面的代码有什么问题，或者是否有另一种方法来完成任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T19:47:55.060

首先，发布数据永远不会保留在重定向上。所以不用担心，你不必提出两个请求。只要坚持

```
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); 
```

我还建议进行以下进一步调试：即使您发出两个请求，使用相同的 curl 资源，也不要关闭它来创建新的。另外，添加：

```
curl_setopt($ch, CURLOPT_FORBID_REUSE, 0);
curl_setopt($ch, CURLOPT_FRESH_CONNECT, 0);
curl_setopt($ch, CURLOPT_AUTOREFERER, 1);
curl_setopt($ch, CURLOPT_USERAGENT, "valid user agent"); 
```

您还可以使用浏览器插件（即 HttpFox）来检查所需的确切 cookie 和请求序列。您正在尝试模拟真实的请求，因此深入研究您的浏览器发出的请求会很有帮助。

# c# - 使用 LINQ 表达式查找重复项时遇到问题

> ID：13482570
> 
> 赞同：3
> 
> 时间：2012-11-20T21:34:22.667
> 
> 标签：c#, linq, group-by

我有一个列表，`ForecastData`它看起来像这样：

```
public class ForecastData
{
    public string SalesID {get;set;}
    public string Customer {get;set;}
    public string Vendor {get;set;}
    public string Division {get;set;}
    public int Year {get;set;}
    public decimal Amount {get;set;}
} 
```

我需要为金额 > 0 的每个“客户”显示每个不同的“销售 ID”的列表，其中年份是今年。

目前，我正在按客户分组，但因为我的数据集中可以为同一个客户和 SalesID 有多个“金额”，所以我没有得到我期望的结果。我的结果显示：

1.  客户 1 用户 1 $100
2.  客户 1 用户 1 $200
3.  客户 1 用户 1 $300
4.  客户 1 用户 2 100 美元
5.  客户 1 用户 2 $200

但我想要的是

1.  客户 1 用户 1 $600
2.  客户 1 用户 2 300 美元

这是我的表达：

```
var forecasts = (List<ForecastData>)cache.Get(_RAW_FORECAST_DATA_KEY, null);

foreach(var custGroup in forecasts.Where(f => f.Year == DateTime.Now.Year).GroupBy(f => f.Customer))
{
    if(custGroup.Count() > 1) // There's more than one forecast for this customer
    {
        foreach(var instance in custGroup)
        {
            toReturn.Add(new MultipleCustomer(custGroup.Key)
            {
                Salesperson = instance.SalesPersonId,
                Forecast = instance.Amount
            });
        }
    }
}

return toReturn; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:43:47.123

我想如果你改变你的查询，让你有一个 "outer"`GroupBy`和一个 "inner" `GroupBy`，它会解决你的问题：

```
var forecasts = (List<ForecastData>)cache.Get(_RAW_FORECAST_DATA_KEY, null);

var forecastGroups = forcasts
    .Where(f => f.Year = DateTime.Now.Year)
    .GroupBy(f => f.Customer)
    .Where(grp => grp.Count() > 1)
    .Select(grp => new { Key = grp.Key, SalesGroups = grp.GroupBy(f => f.SalesId) });

foreach(var custGroup in forecastGroups)
{
    if(custGroup.SalesGroups.Count() > 1)
    {
        foreach(var salesGroup in custGroup.SalesGroups)
        {
            toReturn.Add(new MultipleCustomer(custGroup.Key)
            {
                Salesperson = salesGroup.Key,
                Forecast = salesGroup.Sum(f => f.Amount)
            });
        }
    }
}

return toReturn; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T22:07:40.123

尝试以下操作：

```
foreach(var custGroup in forecasts.Where(f => f.Year == DateTime.Now.Year).GroupBy(f => new { f.Customer, f.SalesPersonId }).Where(k => k.Count() > 1).Select(k => new { Customer = k.Key.Customer, SalesPersonId = k.Key.SalesPersonId, TotalAmount = k.Sum(x => x.Amount) } )
{
           toReturn.Add(new MultipleCustomer(custGroup.Customer)
           {
              Salesperson = custGroup.SalesPersonId,
              Forecast = custGroup.TotalAmount
           });
       }
   }
} 
```

我一直在写它。附近没有 C# 编译器，因此可能会出现一些错误。

您的问题的关键是您需要汇总您的项目总和他们的金额。

# c# - Task.Factory.StartNew(someMethod(withParam)).continueWith(sameMethod(differentParam)).Wait()

> ID：13482572
> 
> 赞同：5
> 
> 时间：2012-11-20T21:34:27.973
> 
> 标签：c#, .net, task-parallel-library

并行化以下代码的正确语法是什么？

```
static void Main(string[] args)
{
    Task.Factory.StartNew(
        () =>
            doOne(SelectedTask.option1)
           .ContinueWith(
            task => 
            doOne(SelectedTask.option1)).Wait()
   ); 
} 
```

与`enum`“selectedTask”相同的方法来决定执行哪些代码：

```
static enum SelectedTask
{
    option1,
    option2
}

static void doOne(SelectedTask Lunch)
{ 
    switch (lunch)
    {
        case SelectedTask.option1:
            Console.WriteLine("option1");
            break;
        case SelectedTask.option2:
            Console.WriteLine("option2");
            break;
        default:
            break;
    }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-21T06:40:38.227

您希望您的`doOne`通话同时进行吗？然后你可以直接从任务工厂启动它们：

```
// Start two concurrent tasks
var task1 = Task.Factory.StartNew(() => doOne(SelectedTask.option1));
var task2 = Task.Factory.StartNew(() => doOne(SelectedTask.option2));

// Block the current thread until all tasks complete
Task.WaitAll(task1, task2); 
```

您希望您的`doOne`呼叫按顺序进行吗？然后你可以使用链接它们`ContinueWith`：

```
// Start a chain of tasks
var task1 = Task.Factory.StartNew(() => doOne(SelectedTask.option1));
var task2 = task1.ContinueWith(t => doOne(SelectedTask.option2));

// Block the current thread until the last task completes
task2.Wait(); 
```

您帖子标题中的代码（有几个修复）基本上执行与我上面的顺序任务链完全相同的功能：

```
Task.Factory.StartNew(() => doOne(SelectedTask.option1))
            .ContinueWith(t => doOne(SelectedTask.option2))
            .Wait(); 
```

**在下面回答你的问题。**

如果我理解正确，您希望能够为`SelectedTasks`并行的变量列表运行任务：

```
List<SelectedTask> selectedTaskOptions = new List<SelectedTask>()
{
    SelectedTask.option1,
    SelectedTask.option2,
    SelectedTask.option3,
    SelectedTask.option4,
    SelectedTask.option5
};

RunAllSelectedTaskOptions(selectedTaskOptions); 
```

`RunAllSelectedTaskOptions`接受并运行以下列表`SelectedTasks`：

```
public void RunAllSelectedTaskOptions(List<SelectedTask> selectedTaskOptions)
{
    List<Task> createdTasks = new List<Task>();

    foreach(var taskOption in selectedTaskOptions)
    {
        createdTasks.Add(Task.Factory.CreateNew(() => doOne(taskOption)));
    }

    Task.WaitAll(createdTasks);
} 
```

另一种实现方式`RunAllSelectedTaskOptions`是使用`Parallel.ForEach`，它将并行执行并阻塞，直到最慢/最后一次迭代完成：

```
public void RunAllSelectedTaskOptions(List<SelectedTask> selectedTaskOptions)
{
    Parallel.ForEach(selectedTaskOptions, taskOption => doOne(taskOption));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:42:36.550

我假设您正在谈论并行化这两个`doOne`调用？

如果是这样，那么您将需要执行以下操作：

```
var task1 = Task.Factory.StartNew(() => doOne(SelectedTask.option1));
var task2 = Task.Factory.StartNew(() => doOne(SelectedTask.option2));
var taskList = new List<Task>{task1, task2};
Task.WaitAll(taskList); 
```

*以上代码相当准确，但语法未经验证。

# javascript - JS 在计算表列中的值并写入另一个值时遇到麻烦，从文本输入到 textarea

> ID：13482574
> 
> 赞同：1
> 
> 时间：2012-11-20T21:34:33.557
> 
> 标签：javascript, for-loop, objectid

我找不到我的代码有什么问题，因为它什么也没做......

我的js有：

```
function calc()
{
    for(i=1;i<=4;i++)
    {
        document.getElementById("cost"+i).value=        (document.getElementById("pret"+i).value*document.getElementById("cant"+i).value)*1.24;
        document.biblioteca.total.value+=document.getElementById("cost"+i).value;
    }

} 
```

html是：

```
<form name="biblioteca">
<table width=600 border="3">
    <tr>
        <th width="50%">Carte</th>
        <th width="15%">Pret</th>
        <th width="15%">Cantitate</th>
        <th>Cost(TVA inclus)</th>
    </tr>
    <tr>
        <td>Manuscrisul gasit la Accra - Paulo Coelho</td>
        <td id="pret1" value="20">20</td>
        <td><input type="text" value="" id="cant1"></td>
        <td><textarea name="cost1" id="cost1" rows="1" value=""></textarea></td>
    </tr>

    <tr>
        <td>Poarta coliviei - Katie Hickman</td>
        <td id="pret2" value="10">10</td>
        <td><input type="text" value="" id="cant2"></td>
        <td><textarea name="cost2" id="cost2" rows="1" value=""></textarea></td>
    </tr>
    <tr>
        <td>Cincizeci de umbre ale lui Grey - E.L. James </td>
        <td id="pret3" value="44">44</td>
        <td><input type="text" value="" id="cant3"></td>
        <td><textarea name="cost3" id="cost3" rows="1" value=""></textarea></td>
    </tr>
    <tr>
        <td>Ciresarii. Vol.2: Castelul Fetei In Alb - Constantin Chirita</td>
        <td id="pret4" value=6>6</td>
        <td><input type="text" value="" id="cant4"></td>
        <td><textarea name="cost4" id="cost4" rows="1" value=""></textarea></td>
    </tr>
    <tr>
        <td colspan=2></td>
        <td>Total:</td>
        <td><textarea name="total" rows="1" readonly value=""></textarea></td>
    </tr>
</table>

<input type="button" name="calc" value="Caluleaza" onclick="calc()">
</form> 
```

它应该取第二列的值，乘以第三列，然后乘以 1.24，并将结果写入第四列。那么，这个结果应该总结在最后一行的最后一列，总计中。但它什么也没做。我尝试了不同的方式，停在了这个，因为这是我想到的第一个。我也尝试分配 object=document.getElementById("cost"+i) 然后使用 object.value，但它是一样的，它不起作用。我找不到问题所在。

评论后，整个 html 看起来像这样：

```
<html>
<head>

<script type="text/javascript">
function calculate()
{
    document.biblioteca.total.value = 0;
    for(i=1;i<=4;i++)
    {
        document.getElementById("cost"+i).value= (parseInt(document.getElementById("pret"+i).innerText)*parseFloat(document.getElementById("cant"+i).value))*1.24;
        document.biblioteca.total.value = parseFloat(document.biblioteca.total.value) + parseFloat(document.getElementById("cost"+i).value);
    }
}
</script>

</head>

<body>
<h1>Biblioteca</h1>

<form name="biblioteca">
<table width=600 border="3">
    <tr>
        <th width="50%">Carte</th>
        <th width="15%">Pret</th>
        <th width="15%">Cantitate</th>
        <th>Cost(TVA inclus)</th>
    </tr>
    <tr>
        <td>Manuscrisul gasit la Accra - Paulo Coelho</td>
        <td id="pret1">20</td>
        <td><input type="text" value="" id="cant1"></td>
        <td><textarea name="cost1" id="cost1" rows="1" value=""></textarea></td>
    </tr>

    <tr>
        <td>Poarta coliviei - Katie Hickman</td>
        <td id="pret2">10</td>
        <td><input type="text" value="" id="cant2"></td>
        <td><textarea name="cost2" id="cost2" rows="1" value=""></textarea></td>
    </tr>
    <tr>
        <td>Cincizeci de umbre ale lui Grey - E.L. James </td>
        <td id="pret3">44</td>
        <td><input type="text" value="" id="cant3"></td>
        <td><textarea name="cost3" id="cost3" rows="1" value=""></textarea></td>
    </tr>
    <tr>
        <td>Ciresarii. Vol.2: Castelul Fetei In Alb - Constantin Chirita</td>
        <td id="pret4">6</td>
        <td><input type="text" value="" id="cant4"></td>
        <td><textarea name="cost4" id="cost4" rows="1" value=""></textarea></td>
    </tr>
    <tr>
        <td colspan=2></td>
        <td>Total:</td>
        <td><textarea name="total" rows="1" readonly value=""></textarea></td>
    </tr>
</table>

<input type="button" value="Caluleaza" onclick="calculate()">
</form>

</body>
</html> 
```

要么我很累，看不到一些明显的愚蠢错误，要么有一些可疑的东西....因为仍然无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:42:44.437

这些`<input>`元素存储的值不是数字。它们是字符串。您需要将它们转换为浮点数或整数：

```
var total_element = document.biblioteca.total;

var cost_element = document.getElementById("cost" + i);
var pret_element = document.getElementById("pret" + i);
var cant_element = document.getElementById("cant" + i);

var pret = parseFloat(pret_element.value);
var cant = parseFloat(cant_element.value);

cost_element.value = pret * cant * 1.24;
total_element.value += cost_element.value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:49:39.887

首先，当您从输入标签中获取值时，您正在尝试对字符串值进行数学运算。

此外，您的函数没有运行，因为您不能使用 calc() 作为函数名（出于某种原因）

尝试用这个替换你的代码。

JS：

```
function calculate()
{
    document.biblioteca.total.value = 0;
    for(i=1;i<=4;i++)
    {
        document.getElementById("cost"+i).value= (parseInt(document.getElementById("pret"+i).innerText)*parseFloat(document.getElementById("cant"+i).value))*1.24;
        document.biblioteca.total.value = parseFloat(document.biblioteca.total.value) + parseFloat(document.getElementById("cost"+i).value);
    }
} 
```

HTML：

```
<form name="biblioteca">
<table width=600 border="3">
    <tr>
        <th width="50%">Carte</th>
        <th width="15%">Pret</th>
        <th width="15%">Cantitate</th>
        <th>Cost(TVA inclus)</th>
    </tr>
    <tr>
        <td>Manuscrisul gasit la Accra - Paulo Coelho</td>
        <td id="pret1" value="20">20</td>
        <td><input type="text" value="" id="cant1"></td>
        <td><textarea name="cost1" id="cost1" rows="1" value=""></textarea></td>
    </tr>

    <tr>
        <td>Poarta coliviei - Katie Hickman</td>
        <td id="pret2" value="10">10</td>
        <td><input type="text" value="" id="cant2"></td>
        <td><textarea name="cost2" id="cost2" rows="1" value=""></textarea></td>
    </tr>
    <tr>
        <td>Cincizeci de umbre ale lui Grey - E.L. James </td>
        <td id="pret3" value="44">44</td>
        <td><input type="text" value="" id="cant3"></td>
        <td><textarea name="cost3" id="cost3" rows="1" value=""></textarea></td>
    </tr>
    <tr>
        <td>Ciresarii. Vol.2: Castelul Fetei In Alb - Constantin Chirita</td>
        <td id="pret4" value=6>6</td>
        <td><input type="text" value="" id="cant4"></td>
        <td><textarea name="cost4" id="cost4" rows="1" value=""></textarea></td>
    </tr>
    <tr>
        <td colspan=2></td>
        <td>Total:</td>
        <td><textarea name="total" rows="1" readonly value=""></textarea></td>
    </tr>
</table>

<input type="button" name="calc" value="Caluleaza" onclick="calculcate()">
</form> 
```

# eclipse - 如何在创建 WAR 文件期间添加隐藏文件夹。

> ID：13482576
> 
> 赞同：0
> 
> 时间：2012-11-20T21:34:38.690
> 
> 标签：eclipse, svn, web-applications, war

我正在开发一个动态 Web 应用程序并导出 WAR 文件以将其部署在服务器上。我在 Eclipse 中的项目目录有一个名为 .svn 的隐藏文件夹，我想将其包含在正在生成的 WAR 文件中。
例如：我有**ProjectName/.svn**文件夹，我想在创建 WAR 文件期间将其包含在**WebContent/WEB-INF/classes文件夹中。**有没有办法在 Eclipse 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:51:20.553

我*也不明白原因*，但你可以这样做：

如果您有一个动态 Web 项目，那么您有一个名为`.settings/org.eclipse.wst.common.component`. 如果您像下面这样在其中添加一行，您可以指示 Eclipse 将其他内容构建到 WAR 中。部署路径是WAR内部的相对路径，源路径是项目内部的相对路径。如果您将外部文件夹链接到您的项目中，您甚至可以包含它。

```
<?xml version="1.0" encoding="UTF-8"?><project-modules id="moduleCoreId" project-version="1.5.0">
    <wb-module deploy-name="bla">
        <wb-resource deploy-path="/" source-path="/WebContent" tag="defaultRootSource"/>
        <wb-resource deploy-path="/WEB-INF/classes" source-path="/src"/>
        <!--your extra stuff is this line-->
        <wb-resource deploy-path="/.svn" source-path="/.svn"/>
        <property name="context-root" value="bla"/>
        <property name="java-output-path" value="/bla/build/classes"/>
    </wb-module>
</project-modules> 
```

我没有尝试过，但我猜它应该可以工作。

# python - 导入 CSV 并在 Python 中分析

> ID：13482578
> 
> 赞同：1
> 
> 时间：2012-11-20T21:34:45.180
> 
> 标签：python, csv

在一个小项目上寻求帮助。我正在尝试学习 Python，但我完全迷失了一个问题。请让我解释一下。

我有一个包含“Apple 股价”的 csv 文件，到目前为止，我可以使用 csv 模块导入 Python，但是，我需要分析数据并生成月度平均值并确定 6 个月的最佳和最差。我的 csv 列是日期、价格。

非常感谢您的帮助。

```
"Date","Open","High","Low","Close","Volume","Adj Close"
"2012-11-14",660.66,662.18,650.5,652.55,1668400,652.55
"2012-11-13",663,667.6,658.23,659.05,1594200,659.05
"2012-11-12",663.75,669.8,660.87,665.9,1405900,665.9
"2012-11-09",654.65,668.34,650.3,663.03,3114100,663.03
"2012-11-08",670.2,671.49,651.23,652.29,2597000,652.29
"2012-11-07",675,678.23,666.49,667.12,2232300,667.12
"2012-11-06",685.48,686.5,677.55,681.72,1582800,681.72
"2012-11-05",684.5,686.86,675.56,682.96,1635900,682.96
"2012-11-02",694.79,695.55,687.37,687.92,2324400,687.92
"2012-11-01",679.5,690.9,678.72,687.59,2050100,687.59
"2012-10-31",679.86,681,675,680.3,1537000,680.3
"2012-10-26",676.5,683.03,671.2,675.15,1950800,675.15
"2012-10-25",680,682,673.51,677.76,2401100,677.76
"2012-10-24",686.8,687,675.27,677.3,2496500,677.3 
```

ETC...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:59:03.937

有了[`pandas`](http://pandas.pydata.org/)这个

```
In [28]: df = pd.read_csv('my_data.csv', parse_dates=True, index_col=0, sep=',')

In [29]: df
Out[29]: 
              Open    High     Low   Close   Volume  Adj Close
Date                                                          
2012-11-14  660.66  662.18  650.50  652.55  1668400     652.55
2012-11-13  663.00  667.60  658.23  659.05  1594200     659.05
2012-11-12  663.75  669.80  660.87  665.90  1405900     665.90
2012-11-09  654.65  668.34  650.30  663.03  3114100     663.03
2012-11-08  670.20  671.49  651.23  652.29  2597000     652.29
2012-11-07  675.00  678.23  666.49  667.12  2232300     667.12
2012-11-06  685.48  686.50  677.55  681.72  1582800     681.72
2012-11-05  684.50  686.86  675.56  682.96  1635900     682.96
2012-11-02  694.79  695.55  687.37  687.92  2324400     687.92
2012-11-01  679.50  690.90  678.72  687.59  2050100     687.59
2012-10-31  679.86  681.00  675.00  680.30  1537000     680.30
2012-10-26  676.50  683.03  671.20  675.15  1950800     675.15
2012-10-25  680.00  682.00  673.51  677.76  2401100     677.76
2012-10-24  686.80  687.00  675.27  677.30  2496500     677.30

In [30]: monthly = df.resample('1M')

In [31]: monthly
Out[30]: 
               Open      High      Low     Close   Volume  Adj Close
Date                                                                
2012-10-31  680.790  683.2575  673.745  677.6275  2096350   677.6275
2012-11-30  673.153  677.7450  665.682  670.0130  2020510   670.0130 
```

您可以对所需的列进行排序

```
In [33]: monthly.sort('Close')
Out[33]: 
               Open      High      Low     Close   Volume  Adj Close
Date                                                                
2012-11-30  673.153  677.7450  665.682  670.0130  2020510   670.0130
2012-10-31  680.790  683.2575  673.745  677.6275  2096350   677.6275 
```

您甚至可以从 Yahoo Finance 获取数据：

```
In [37]: from pandas.io import data as pddata

In [40]: df = pddata.DataReader('AAPL', data_source='yahoo', start='2012-01-01')

In [41]: df.resample('1M').sort('Close')
Out[44]: 
                  Open        High         Low       Close           Volume   Adj Close
Date                                                                                   
2012-01-31  428.760000  431.008500  425.810500  428.578000  12249740.000000  424.804500
2012-02-29  494.803000  500.849000  491.437500  497.571000  20300990.000000  493.191000
2012-11-30  560.365385  566.118462  548.523846  555.789231  24861884.615385  554.970769
2012-05-31  565.785000  572.141364  558.397273  564.673182  18029781.818182  559.702273
2012-06-30  574.660952  578.889048  569.213333  574.562381  13360247.619048  569.504762
2012-03-31  576.858182  582.064545  570.245909  577.507727  25299250.000000  572.424545
2012-07-31  599.610000  604.920952  594.680476  601.068095  15152466.666667  595.776667
2012-04-30  609.607500  615.487500  598.650000  606.003000  27855340.000000  600.668500
2012-10-31  638.667143  643.650476  628.213810  634.714286  20651071.428571  631.828571
2012-08-31  641.527826  646.655217  637.138261  642.696087  12851252.173913  639.090870
2012-09-30  682.118421  687.007895  676.095263  681.568421  17291363.157895  678.470526 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:45:10.613

阅读项目并将 [month, mean_price] 对保存在列表中后，您可以对列表进行排序：

```
import operator
values_list.sort(key=operator.itemgetter(1)) 
```

这将按价格对值进行排序。要获得前 n 个值：

```
print values_list[-n:] 
```

或底部 n：

```
print values_list[:n] 
```

# c# - DataGridView 未填充 DataSet

> ID：13482581
> 
> 赞同：0
> 
> 时间：2012-11-20T21:34:49.910
> 
> 标签：c#, sql, winforms, datagridview

出于某种奇怪的原因，DataGridView 没有被数据源中的表填充。我不确定我做错了什么。数据集确实有一个表。

```
private void BtnViewUncommittedDataClick(object sender, EventArgs e)
{
    if (rbtnNewBusiness.Checked)
    {
        try
        {
            UpdateGridForNewBusiness();
            return;
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
            Logger.LogError(ex.Source, ex.TargetSite.ToString(), ex.Message);
            Enabled = true;
            return;
        }
    }
}

private void UpdateGridForNewBusiness()
{
    dgvDetail.DataSource = Database.GetNewBusinessDetailJobData();
    dgvSummary.DataSource = Database.GetNewBusinessSummaryJobData();
    dgvDetailNYD.DataSource = Database.GetNewBusinessDetailJobDataNyd();
    dgvSummaryNYD.DataSource = Database.GetNewBusinessSummaryJobDataNyd();
    lblDetailRowCountlbl.Text = "";
    lblDetailNYDRowCountlbl.Text = "";
    lblSummaryRowCountlbl.Text = "";
    lblSummaryNYDRowCountlbl.Text = "";
    lblDetailRowCountlbl.Text = "New Business Detail - Row Count:";
    lblDetailNYDRowCountlbl.Text = "New Business Detail NYD - Row Count:";
    lblSummaryRowCountlbl.Text = "New Business Summary - Row Count:";
    lblSummaryNYDRowCountlbl.Text = "New Business Summary NYD - Row Count:";
    lblDetailRowCount.Text = dgvDetail.Rows.Count.ToString(CultureInfo.InvariantCulture);
    lblSummaryRowCount.Text = dgvSummary.Rows.Count.ToString(CultureInfo.InvariantCulture);
    lblDetailNYDRowCount.Text = dgvDetailNYD.Rows.Count.ToString(CultureInfo.InvariantCulture);
    lblSummaryNYDRowCount.Text = dgvSummaryNYD.Rows.Count.ToString(CultureInfo.InvariantCulture);
} 
```

只是向您展示第一个查询方法，其他方法相同：

```
public static DataSet GetNewBusinessDetailJobData()
{
    using (var conn = new SqlConnection(Settings.Default.ConnectionString))
    {
        using (var cmd = new SqlCommand("spGetNewBusinessDetailJobData", conn) {CommandType = CommandType.StoredProcedure})
        {
            conn.Open();
            cmd.ExecuteNonQuery();
            using (var da = new SqlDataAdapter(cmd))
            {
                using (var ds = new DataSet())
                {
                    da.Fill(ds);
                    return ds;
                }
            }
        }
    }
} 
```

同样，正在提取数据，但由于某种原因，DataGridView 没有改变。它只是灰色的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:55:10.687

我弄清楚了这个问题。

我无法将 DataGridView 的 DataSource 设置为 DataSet。它必须是一个数据表。

# c# - 如何在 C# 中声明具有特殊字符的字符串常量

> ID：13482582
> 
> 赞同：3
> 
> 时间：2012-11-20T21:34:52.177
> 
> 标签：c#, linq-to-xml

如何在我的 c# 程序中将以下 XML 定义为字符串常量。

```
<?xml version="1.0" encoding="utf-8"?>
<smil xmlns="http://www.w3.org/2001/SMIL20/Language">
  <head>
  <meta base="rtmp://dos.com/vevood" />
  </head>
  <body>

 </body>
 </smil> 
```

现在我将以上内容保存为测试文件（file.txt），然后使用以下内容将其加载到 xdocument 中：

```
XDocument.Load(@"G:\file.txt"); 
```

我想将 xml 保存为字符串，然后执行以下操作： XDocument.Load(string);

问题是xml中有特殊字符。

实现我的目标最简单的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T21:37:14.250

您应该使用`XDocument.Parse(string)`从字符串常量初始化它。还可以使用双引号来转义`"`字符：

```
string str = @"<?xml version=""1.0"" encoding=""utf-8""?>
<smil xmlns=""http://www.w3.org/2001/SMIL20/Language/"">
  <head>
    <meta base=""rtmp://dos.com/vevood"" />
  </head>
  <body>

  </body>
</smil>";
XDocument doc = XDocument.Parse(str); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:37:41.660

看看[C#`string`转义](http://msdn.microsoft.com/en-us/library/362314fe.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:40:10.480

```
string value = "<?xml version=\"1.0\" encoding=\"utf-8\"?><smil xmlns=\"http://www.w3.org/2001/SMIL20/Language\"><head><meta base=\"rtmp://dos.com/vevood\" /></head><body></body></smil>"; 
```

应该管用

# html - 我需要一些具有固定高度和宽度的 div .. 怎么样？

> ID：13482583
> 
> 赞同：0
> 
> 时间：2012-11-20T21:34:55.667
> 
> 标签：html, height, block, fixed

我正在为一个学校项目构建一些东西..我当前的代码可能有问题，因为这不是我想要的..所以我想寻求支持！

首先：所有必须是百分比，因为它是针对手机屏幕的，并且都是基于分辨率的。我希望所有东西的大小都相对相等，所以我假设这里的百分比是最好的。

那么我需要的想法是

第1行高度：20% [块一宽度：60%][块二宽度：40%]

第 2 行高度：60% [块一宽度：100%]

第 3 行（页脚）高度：20% [块一宽度：100%]

第 1 行必须始终位于顶部（duh）第 2 行必须在下一个，始终居中，并且必须具有屏幕高度的 60% 的固定高度，无论其中有什么第 3 行必须作为页脚并低于第 2 行（duh）

我认为这里没有太多大代码..但我无法计算固定高度，因为我的“页脚”总是直接在第 2 行之后，而不是总底部..

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:51:00.213

听起来你的问题实际上只是关于设置高度。

这个问题（很可能）您的百分比仅基于正文标签，这对于您的所有内容来说都足够大。尝试这个：

```
html, body
{
    height: 100%;
}
div {
    border-style:solid;
    border-width:1px;
}
div#top { height:20%; }
div#middle {height: 60%; }
div#bottom {height: 20%; } 
```

​查看[http://jsfiddle.net/nhw5X/2/](http://jsfiddle.net/nhw5X/2/)玩一下

与[使正文具有浏览器高度的 100%相关](https://stackoverflow.com/questions/6654958/make-body-have-100-of-the-browser-height)

# python - 我如何告诉 python 从电子邮件中获取最后两个单词，该电子邮件位于类似结构的列表中，但不是由 python 定义的列表，因为它发生了变化？

> ID：13482586
> 
> 赞同：0
> 
> 时间：2012-11-20T21:35:01.517
> 
> 标签：python, windows, list, email

代码还有更多内容，但我对其进行了排序并阅读了特定的电子邮件（但此电子邮件消息发生了变化，并且更多内容以有序格式添加到电子邮件消息中，看起来像列表但不是能够贴上标签..)

```
for num in data[0].split():
        typ, msg_data = conn.fetch(num, '(RFC822)')
        for response_part in msg_data:
            if isinstance(response_part, tuple):
                msg = email.message_from_string(response_part[1])
                subject=msg['subject']                   
                payload=msg.get_payload()
                body=extract_body(payload)
                print(body)
    #the portion of the code is these sources:unutbu and Doug Hellmann's tutorial on  imaplib 
```

当它打印它打印：

```
Run script8.py

Run task9.py

Play asdf.mp3

Run unpause.py 
```

但它会改变，所以如果我从现在开始运行它十分钟，它可能会说：

```
Run script8.py

Run task9.py

Play asdf.mp3

Run unpause.py

Run newscript88.py 
```

我需要它从上面的代码中获取打印的内容，并提取在本例中为的最后两个单词，并将其`Run newscript88.py`标记为字符串，以便稍后放入如下代码中：

```
os.startfile('Run newscript88.py') 
```

所以从字面上看，它会从电子邮件中提取最后两个词，然后将最后两个词放入：

```
 os.startfile('last 2 words') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:42:52.943

您想要正文中的最后两个单词，作为变量中的字符串`body`，对吗？

确切的答案取决于您如何定义“单词”，但这里有一个非常简单的答案：

```
lastTwoWords = body.split()[-2:] 
```

如果你打印它，你会得到类似`['Run', 'newscript88.py']`. 要将其放回字符串中，只需使用`join`：

```
os.startfile(' '.join(lastTwoWords)) 
```

从您的示例数据来看，最后一个“单词”似乎至少可能包含空格，而您*真正*想要的是最后一行的两个单词……所以也许您想要这样的东西：

```
lastLine = body.split('\n')[-1]
lastTwoWords = lastLine.split(None, 1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:48:03.000

尝试以下几行：

```
import re
pat = re.compile('\w+ \w+[.]*$') # not very good regex
here_text = r'''here is some text
with lots of words, of which I only
want the LJ;lkdja9948 last two'''
i = pat.search(here_text)
i.group()
>> 'last two' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:01:07.210

由于您不在 *NIX 系统上，因此我不能建议`tee`ing 您的脚本和`tail`ing 文件。

但是，我建议在您的程序中使用仅包含两项的缓冲区：

```
class Buffer:
    def __init__(self):
        self.items = []
    def add(self, item):
        self.items.append(item)
        self.items = self.items[-2:]
    def __str__(self):
        return "[%s, %s]" %(self.items[0], self.items[1])
    def __getitem__(self, i):
        return self.items[i] 
```

在您的代码中使用此缓冲区并在打印出您的值之前添加到它。然后，在任何时候，缓冲区中的值都将是“最后两个值”

希望这可以帮助

# c# - 在 XNA 中获得持续 3 秒的奖励

> ID：13482591
> 
> 赞同：0
> 
> 时间：2012-11-20T21:35:10.673
> 
> 标签：c#, timer, xna

我正在 XNA 中构建游戏，而且我对 XNA 也很陌生，但我必须从某个地方开始。我游戏中的几乎所有东西都完美无缺。这是一款顶视图赛车游戏。唯一的问题是我想持续获得奖金，我从地图上拾取的奖励持续给定时间，比如 3 秒，我知道我需要使用计时器，但我不知道应该如何使用它。

这是代码的一部分，当汽车与我的地图图块相撞时我使用：

```
 if (map[x][y] == 0)
        {
            if (speedBonus)
            {
                car.speed = 450;
            }
            else
            {
                car.speed = 200;
            } 
```

我希望你们中的一个可以帮助我解决这个问题，因为我花了大约 2 个小时来修复它，但我的代码并没有帮助我。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:44:42.273

您需要记录领取奖金的时间，您可以将其保存到 DateTime 对象中。然后，在主循环的每次迭代中，检查 TimeSpan 是否大于 3 秒。如果是这样，请删除奖金。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:20:59.517

感谢您的帮助，我以这种方式修复了我的代码：

顶部有 2 个变量：

```
float timer = 3;
const float TIMER = 3; 
```

在更新中：

```
if (map[x][y] == 0)
        {
            if (speedBonus)
            {
                float elapsed = (float)gameTime.ElapsedGameTime.TotalSeconds;
                timer -= elapsed;

                car.speed = 450;

                if (timer <= 0)
                {
                    speedBonus = false;
                    timer = TIMER;   //Reset Timer
                }
            }
            else
            {
                car.speed = 200;
            } 
```

它现在就像一个魅力，感谢您的帮助！

# json - CakePHP 在 json 编码字段上找到

> ID：13482593
> 
> 赞同：0
> 
> 时间：2012-11-20T21:35:12.037
> 
> 标签：json, model, controller, cakephp-2.0

我在 CakePHP 中创建了一个商店，并添加了一个文本字段，用于存储该商店所属的所有类别的 json 数组。

如何在所有属于“园艺”类别的商店中找到蛋糕？

json编码字段：

```
["gardening","books-and-toys"] 
```

我正在考虑某种 in_array() 查找但不太确定。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T09:00:49.427

您可以使用 PHP 方法[`json_decode`](http://php.net/manual/en/function.json-decode.php)并将 JSON 对象作为关联数组返回，方法是将该函数的第二个选项设置为`true`. 然后，您可以调用[`array_search`](http://php.net/manual/en/function.array-search.php)例如返回相应的键。

```
<?php
  $categories = json_decode($json, true);
  $categoryKey = array_search('gardening', $categories);
  $categoryName = $categories[$categoryKey];
?> 
```

然后，您可以`$categoryName`在 CakePHP`find()`调用中使用。

# mysql - Mysql根据时间更新？

> ID：13482596
> 
> 赞同：0
> 
> 时间：2012-11-20T21:35:18.960
> 
> 标签：mysql

有没有办法根据时间自动更新一些元组。我有一个字段，我想从为该特定行存储的时间每周增加一次。假设我有两个带有日期和计数字段的元组： 2000-01-02 10 2000-01-03 1

是否可以从存储的日期每周自动增加计数字段？这样第一行在 2000-01-09 递增，第二行在 2000-01-10 递增，这将每周进行一次。

或者一般来说，我可以根据过去的一段时间自动更新一些东西吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:56:46.547

我认为您需要事件调度程序：

[http://dev.mysql.com/doc/refman/5.1/en/events.html](http://dev.mysql.com/doc/refman/5.1/en/events.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:44:29.247

您可以存储一个额外的字段：`next_increment_date`.

然后您定期更新（例如，每小时或每天一次......或者通常是有意义的）：

```
UPDATE my_table
  SET next_increment_date = DATE_ADD( next_increment_date, INTERVAL 1 WEEK ),
      count = count + 1
  WHERE next_increment_date <= NOW(); 
```

# windows-phone-7 - 我可以在可移植类库中使用“动态”关键字吗？

> ID：13482597
> 
> 赞同：4
> 
> 时间：2012-11-20T21:35:19.427
> 
> 标签：windows-phone-7, windows-store-apps, windows-phone-8, portable-class-library

我正在创建一个可移植的类库，其目标是：

1.  .NET 4.5
2.  Windows 应用商店应用
3.  视窗电话 7.5+
4.  银光 5

我可以安全地使用该库中的“动态”关键字吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-21T03:52:05.660

面向 Windows Phone 7.5 的项目不能使用“动态”——它缺乏类型和运行时支持。但是，如果您将电话 7.5 更改为电话 8，上述组合将起作用

# javascript - 计算的可观察动态变量

> ID：13482604
> 
> 赞同：0
> 
> 时间：2012-11-20T21:35:40.080
> 
> 标签：javascript, knockout.js, computed-observable

我有一个输入字段，当Selectbox更改其值时，应动态填充该字段。因此，我将变量绑定到输入，并将另一个值绑定到选择框的选定值。现在我希望能够以编程方式更改输入值：对于选择框的某些值，该值应该是一个空字符串，而对于其他值，我应该在用户执行某些操作时使用一些 javascript 代码来设置它。I though to use a computed function, so I can return the empty string but this lead me to a problem: how can I then set the value programmatically when the other selectbox options are selected?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:41:49.080

`input`如果您的目标是在更改时默认值`select`并允许用户自由更新它，那么一个不错的选择是使用[手动订阅](http://knockoutjs.com/documentation/observables.html#explicitly_subscribing_to_observables)。

```
var ViewModel = function() {
   this.selectedValue = ko.observable();
   this.otherValue = ko.observable();

   this.selectedValue.subscribe(function(newValue) {
       //perform whatever logic that you need to determine how the other value should be populated based on the dropdown's current value (newValue)
       this.otherValue(calculatedValue);
   }, this);
}; 
```

# google-maps - 特定邮政编码、县或地区内的随机真实美国地址

> ID：13482607
> 
> 赞同：3
> 
> 时间：2012-11-20T21:35:48.580
> 
> 标签：google-maps, random, maps, street-address, random-sample

因此，对于学校的一个项目，我试图模拟学生住在我们镇上的地方，因为由于隐私问题显然无法获得官方数据。我开始寻找一个可以通过邮政编码、半径或县工作的生成器，但我找不到任何（商业或免费）我希望它是免费的，但我可能能够获得一些许可证资金. 如果我找到随机生成器，它们不能仅限于邮政编码或城市来随机生成真实地址。

我在这里找到了一个好主意：[https ://stackoverflow.com/a/12289969/1778542](https://stackoverflow.com/a/12289969/1778542)

在此基础上，我会选择市中心的经纬度坐标，找出郊区坐标来创建一个平面，然后在平面内随机生成经纬度坐标，将它们反馈给谷歌，让谷歌为其近似地址。提出的一个问题（我尽量避免）是 Google 不使用经过验证的地址，而是使用近似值。

有没有人暗示在哪里可以找到这样的生成器或使用 GMaps 的更时尚的方式？

太感谢了！

全科医生

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-04T13:13:31.620

我在我的一个 Laravel Seeder 中使用此代码，只要您给它位置区域和城镇，它就会在罗马尼亚获得一个随机街道名称，它通过获取该区域的纬度和经度然后随机添加 2 公里的半径来工作，之后，它向 google api 发出另一个请求，并从中提取随机街道名称。

我不知道这是否对您有帮助，调整此代码可以生成一个真实地址，前提是您提供第一个好位置来查看；

这是代码：

```
 protected function getRandomStreetNameFromCity($judet, $city){
        $kmRange = 2;
        $initalLocation = [];
        $randomLocation= [];
        $randomKmval = mt_rand(1, $kmRange) / mt_getrandmax();

        // Poor Man Lat and Lng 
        //Latitude: 1 deg = 110.574 km
        //Longitude: 1 deg = 111.320*cos(latitude) km

                $guzzelCl = new Client();
        $guzelReq = $guzzelCl->request('GET', 'http://maps.googleapis.com/maps/api/geocode/json?address=Romania,'.$judet.','.$city.'&sensor=false', [
            'verify' => false,   
        ]);

        if($guzelReq->getStatusCode() == 200){
           $arrJson = json_decode($guzelReq->getBody(), true);
            while (count($arrJson['results']) <= 0){
            $judet= $this->getNewJudet();
            $city = $this->getNewOras();
            $guzelReq = $guzzelCl->request('GET', 'http://maps.googleapis.com/maps/api/geocode/json?address=Romania,'.$judet.','.$city.'&sensor=false', [
            'verify' => false,   
        ]);
         $arrJson = json_decode($guzelReq->getBody(), true);      
           }

           $initalLocation = $arrJson['results'][0]['geometry']['location'];
           }

        $plusMinus = $this->generateRandomString(1);

        $randomExp = [ 1 => $tempLat = eval("return (1 / (110.574 ".$plusMinus." ".$randomKmval." )+ ".$initalLocation['lat']." );"),
            2 => eval('return ('.$initalLocation['lng'].' '.$plusMinus.' 1/111.320*cos($tempLat));'),
            ];

        $guzelReq = $guzzelCl->request('GET', 'http://maps.googleapis.com/maps/api/geocode/json?latlng='.$randomExp[1].','.$randomExp[2], [
            'verify' => false,   
        ]);
        return explode(',', json_decode($guzelReq->getBody(), true)['results'][0]['formatted_address'])[0];

 }   

 protected function getNewJudet(){
     //This is a administrative type of location named 'judet' Romania is divided in a number bellow 50 of this  
     return array_rand($this->judetOras, 1);
 }

 protected function getNewOras(){
     //This is a Town String
     return $this->judetOras[$iterateJud = array_rand($this->judetOras, 1)][array_rand($this->judetOras[$iterateJud], 1)];
 }

 protected function generateRandomString($length = 10) {
    $characters = '-+';
    $charactersLength = strlen($characters);
    $randomString = '';
    for ($i = 0; $i < $length; $i++) {
        $randomString .= $characters[rand(0, $charactersLength - 1)];
    }
    return $randomString;
} 
```

# arrays - 内存中的数组布局

> ID：13482611
> 
> 赞同：2
> 
> 时间：2012-11-20T21:36:09.053
> 
> 标签：arrays, visual-studio, visual-c++, memory-management, int

我想知道为什么在下面的代码中指针aptr和amemTab之间的差异不等于分配数组的大小（10 * sizeof（A））而是64字节（sizeof（A）是4）。

在调试模式下：

aptr 0x00395e38

amemTab 0x00395e78

Win XP 家庭版,MSVS2010,x86 Intel 1.86

我想这与填充有关？（我没有删除基类和派生类的代码，因为我想准确地展示我正在测试的内容，但这里是多余的，我只说两行：

```
A * aptr=static_cast<A*>(amem);
void * amemTab= operator new[](10*sizeof(A)); 
```

我的完整示例：

```
// exercise
//

#include "stdafx.h"
#include <algorithm>

void func(const int &i){printf("%d\n",i);}

class A{
public:
    int i;
};
class B{
public:
    int i;
private:
    int j;
};
class base{
public: 
    void f(void){printf("base f not virtual\n");}
    virtual void g(void){printf("base g virtual\n");}
    void h(void){printf("base h not virtual\n\n");}
    int i_;
    base():i_(123){}
    base(int):i_(12345){}
};
class derived:public base{
public: 
    void f(void){printf("derived f not virtual\n");}
    virtual void g(void){printf("derived g virtual\n");}
};

int _tmain(int argc, _TCHAR* argv[])
{
    int ij;
    A a;/*a.i is not initialized*/
    A * aprimprim=new A;/*i is not initialized (but ctor has been called)*/
    A aprim=A();/*aprim.i is 0 initialized as it is public variable 
                and A has only public part (A is POD type) and () is written*/
    A * ap=new A();/*int is 0 initialized*/
    B b;/*b.i is not initialized and b.j is not initialized*/
    B bprim=B();/*bprim.i is not initialized and bprim.j is not initialized
                as A has public AND also private part*/
    B * bp=new B();/*ints are both 0 initialized*/

    void * amem= operator new (sizeof(A));/*uninitialized memory, only allocate*/
    A * aptr=static_cast<A*>(amem);//cast pointer to void to pointer to A

    void * amemTab= operator new[](10*sizeof(A));/*uninitialized memory, only 
                                            allocate for 10 objects of A size*/
    A * aptrtab=static_cast<A*>(amemTab);/*cast pointer to void to pointer to 
                                         A. now it is possible to iterate through
                                         this area of indexed memory:*/
    for(int i=0;i<10;i++){
        new(&aptrtab[i])A();//initialize each A object 
    }
    int s=sizeof(A);
    /*------------------------------*/
    int myarray[5];/*ints are uninitialized*/
    *(1+myarray)=13;/*pointer addition is commutative*/
    2[myarray]=4;/*subscript operator is commutative*/

    std::for_each(myarray,myarray+5,func);

    /*---------------*/
    int *what_here=const_cast<int*>(myarray-6600);
    printf("what_here: %d\n",*what_here);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:46:41.450

严格来说，对于两个连续的堆分配返回的指针之间的关系，没有什么明确的说法。分配器从两个完全不同的内存区域返回指针并非不可想象（例如，它可以根据请求的字节数使用不同的子堆）。

您的情况可能发生的是：

1.  您的分配器以大于一个字节的块管理内存；
2.  分配器使用与分配的内存相邻的几个字节作为其内部数据结构。

这两者都会产生开销。

此外，内存分配必须满足某些对齐要求。这通常会导致更多的开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:51:50.053

aptr 和 amemTab 是 2 个单独分配的结果（一个通过 new，另一个通过 new[]）

由于您的示例很小，因此堆非常空，并且它们的分配非常接近彼此，在您的情况下，相隔 64 个字节。然而，没有什么能阻止分配距离几兆。这完全取决于 Microsoft 对 HeapAlloc 的实现，所有 new、new[] 和 malloc 最终都会在其中执行。

如果您查看调试器中 2 分配之间的内容，您很可能会看到 0xAB 重复。这表明堆上的“无人区”。在较高的地址中，您更有可能看到 0xCD 指示尚未使用堆内存。

在一个完全不相关的注释中，您将 new 和 new[] 运算符视为您的示例中的 C 风格 malloc() 。我希望您知道有一些类型安全且更具可读性的分配方式。例如：

```
A *amemTab = new A[10]; // Allocated an array of 10 A's. 
```

# opengl - 阴影贴图很微弱

> ID：13482612
> 
> 赞同：1
> 
> 时间：2012-11-20T21:36:13.463
> 
> 标签：opengl, glsl

我正在尝试做基于 OpenGL GLSL 的阴影映射。问题是，在我完成了阴影贴图的渲染之后，我正在将贴图渲染到屏幕上以测试渲染是否正确，即我只是将新生成的纹理用作我要映射到屏幕上的纹理. 预期的结果是我会看到新的纹理。但相反，我看到的是一个白色区域，其纹理已绘制但非常微弱。也就是说，如果我将屏幕倾斜到某个角度，我才能看到阴影贴图的微弱轮廓。

谁能告诉我我做错了什么？

这是我的代码的相关部分：

```
 void Init_FBO() 
    { 
            //glActiveTexture(GL_TEXTURE3);  
        GLfloat border[] = {1.0f, 0.0f, 0.0f, 0.0f};  

        glGenTextures(1, &depthTex);  
        glBindTexture(GL_TEXTURE_2D, depthTex);  
        glTexImage2D(GL_TEXTURE_2D, 0, GL_DEPTH_COMPONENT24,900,900, 0, GL_DEPTH_COMPONENT, GL_FLOAT, NULL);  
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);  
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);  
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_BORDER);  
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_BORDER);  
        glTexParameterfv(GL_TEXTURE_2D, GL_TEXTURE_BORDER_COLOR, border);  
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_COMPARE_MODE, GL_COMPARE_REF_TO_TEXTURE);  
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_COMPARE_FUNC, GL_LESS);
        glBindTexture(GL_TEXTURE_2D,0); 

        glGenFramebuffers(1, &shadowFBO);  
        glBindFramebuffer(GL_FRAMEBUFFER, shadowFBO);  
        glDrawBuffer(GL_NONE);  
        glReadBuffer(GL_NONE);  
        glFramebufferTexture2D(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_TEXTURE_2D, depthTex, 0);  
        glBindFramebuffer(GL_FRAMEBUFFER, 0); // go back to the default framebuffer  
        // check FBO status 
        GLenum FBOstatus = glCheckFramebufferStatusEXT(GL_FRAMEBUFFER); 
        if(FBOstatus != GL_FRAMEBUFFER_COMPLETE) 
        {
            printf("GL_FRAMEBUFFER_COMPLETE failed, CANNOT use FBO\n");
        }
        else
        {
            printf("Frame Buffer Done Succesfully\n");
        } 
    }

    void generateShadowTex()
    {
            //Calculate final ligting properties
        glm::vec4 a_f=light_ambient*mat_ambient;
        glm::vec4 d_f=light_diffuse*mat_diffuse;
        glm::vec4 s_f=light_specular*mat_specular;
        int counter=0;
        glEnable(GL_DEPTH_TEST);    // need depth test to correctly draw 3D objects 
        glClearColor(0,0,0,1); 
        //glClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT); 
        glClear(GL_DEPTH_BUFFER_BIT); 
        glCullFace(GL_FRONT);
        if(wframe)
            glPolygonMode(GL_FRONT_AND_BACK,GL_LINE); 
        else
            glPolygonMode(GL_FRONT_AND_BACK,GL_FILL); 

        glUseProgram(programObject);
        //Draw the stuff using Light Position as camera 
        //glutSwapBuffers();
        glActiveTexture(GL_TEXTURE3);
        glBindTexture(GL_TEXTURE_2D,depthTex);
        glUseProgram(0);  

    }

void generateScene()
{
        //Calculate final ligting properties
    glm::vec4 a_f=light_ambient*mat_ambient;
    glm::vec4 d_f=light_diffuse*mat_diffuse;
    glm::vec4 s_f=light_specular*mat_specular;
    int counter=0;
    glEnable(GL_DEPTH_TEST);    // need depth test to correctly draw 3D objects 
    glClearColor(0,0,0,1); 
    glClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT); 

    //Draw the stuff using camera as camera position

    }
    glutSwapBuffers();
    glUseProgram(0);  

}

void display() 
{
    glBindFramebuffer(GL_FRAMEBUFFER, shadowFBO); 
    generateShadowTex(); 
    glBindFramebuffer(GL_FRAMEBUFFER, 0); 
    generateScene(); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:09:03.477

您的深度纹理看起来正常，深度覆盖范围从近到远的裁剪平面，您可以使用设置一些合理的裁剪平面`glFrustumf(...)`

# actionscript-3 - 使用键盘从数组中移动地图

> ID：13482615
> 
> 赞同：2
> 
> 时间：2012-11-20T21:36:31.800
> 
> 标签：actionscript-3, flash

我想用数组创建一个地图...我在flash上​​看到很多关于平台游戏创建的教程，但没有人用地图移动。

所以，我试着自己做。在移动我的地图之前，我必须创建它，这就是我的问题！所以，我让你看看三层代码并发表你的意见。

Flash 通知我一个错误 #1009，他无法访问空对象引用的属性或方法，我一次也看不到？

```
at Sansnom_fla::MainTimeline/createMap()
at Sansnom_fla::MainTimeline/frame1() 
```

第 1 层

```
var grid:MovieClip = new MovieClip();   

// liste d'affichage
addChild(grid)                      

createMap() 
```

第 2 层

```
function createMap():void{
    for (var i:int=0; i<20; i++){                               
        for (var j:int=0; j<15; j++){                           

            var T:int = 32
            var dT:int = T*.5
            var f:int = map[j][i]

            if(f>0) {
                var t:block = new block()
                t.x= i*T;       
                t.y= j*T;       
                t.gotoAndStop(f)        
                grid.addChild(t)
            }
        }
    }
} 
```

第 3 层

```
 var map:Array = [
                     [1,1,1,1,1,1,10,0,0,11,1,1,1,1,1,1,1,1,1,1],
                     [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                     [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                     [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1],
                     [1,0,0,0,0,0,6,1,0,0,4,4,4,4,0,0,6,1,0,1],
                     [1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                     [1,0,0,0,1,6,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                     [1,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                     [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                     [1,0,0,0,0,6,0,0,1,0,0,1,0,0,1,0,0,1,2,1],
                     [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                     [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                     [1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                     [1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,3,1],
                     [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
                     ]

var stock:Array = [
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
                 ] 
```

非常感谢 ！Ps：正如你所了解的，block 是一个movieClip，其中一帧是一个特定的块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:53:50.300

为什么要在层之间拆分代码？不要那样做。`map`此外，您甚至在第 2 层还存在之前就调用了它*（直到第 3 层的代码运行后才创建它）*所以我的建议是将它全部粘贴到 1 层的 1 帧上。

然后像这样调整您的代码顺序：

```
var map:Array = [
                 [1,1,1,1,1,1,10,0,0,11,1,1,1,1,1,1,1,1,1,1],
                 [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1],
                 [1,0,0,0,0,0,6,1,0,0,4,4,4,4,0,0,6,1,0,1],
                 [1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,1,6,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,0,6,0,0,1,0,0,1,0,0,1,0,0,1,2,1],
                 [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,3,1],
                 [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
                 ];

var stock:Array = [
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
             ];

function createMap():void{
    for (var i:int=0; i<20; i++){                               
        for (var j:int=0; j<15; j++){                           

            var T:int = 32
            var dT:int = T*.5
            var f:int = map[j][i]

            if(f>0) {
                var t:block = new block()
                t.x= i*T;       
                t.y= j*T;       
                t.gotoAndStop(f)        
                grid.addChild(t)
            }
        }
    }
}

var grid:MovieClip = new MovieClip();   

// liste d'affichage
addChild(grid);

createMap(); 
```

也不要忘记`;`角色，你有错过他们的习惯。无论如何，希望这会有所帮助！

# r - 使用 R 中的 chron 包将一列日期与一列时间结合起来

> ID：13482621
> 
> 赞同：1
> 
> 时间：2012-11-20T21:37:12.303
> 
> 标签：r

我正在组合一些数据以使用 match() 函数从一个非常大的数据框中提取特定的交易日期/时间，我完全不知道为什么我的代码不起作用。请注意，日期和时间列是分开的，这也对使用 as.POSIXct 函数提出了挑战。请看一下：

这就是我得到数据的方式：

```
 Symbol      Date Time     Open     High      Low    Close Volume Tick.Count
1  USH94 01/3/1994 7:21 114.4062 114.4375 114.3750 114.4062      0          5
2  USH94 01/3/1994 7:22 114.3750 114.4062 114.3125 114.3750      0         11
3  USH94 01/3/1994 7:23 114.3438 114.3750 114.3125 114.3438      0          7
4  USH94 01/3/1994 7:24 114.3125 114.3125 114.2500 114.2812      0         14
5  USH94 01/3/1994 7:25 114.2500 114.2812 114.2188 114.2188      0          6
6  USH94 01/3/1994 7:26 114.1875 114.2500 114.1875 114.2500      0         13 
```

然后我使用 date() 和 time() 函数将列从因子转换为日期和时间值。在这种情况下，我还将保存为字符串的秒数添加为变量 a，并且由于时间变化，我添加了一个小时。

```
US$Time <- times(paste(US$Time,a,sep = ':'))+1/24
US$Date <- dates(as.character(US$Date)) 
```

这是美国现在的样子：

```
head(US)

  Symbol     Date     Time     Open     High      Low    Close Volume Tick.Count
1  USH94 01/03/94 08:21:00 114.4062 114.4375 114.3750 114.4062      0          5
2  USH94 01/03/94 08:22:00 114.3750 114.4062 114.3125 114.3750      0         11
3  USH94 01/03/94 08:23:00 114.3438 114.3750 114.3125 114.3438      0          7
4  USH94 01/03/94 08:24:00 114.3125 114.3125 114.2500 114.2812      0         14
5  USH94 01/03/94 08:25:00 114.2500 114.2812 114.2188 114.2188      0          6
6  USH94 01/03/94 08:26:00 114.1875 114.2500 114.1875 114.2500      0         13 
```

相同的。

然后我尝试将日期和时间与 paste() 函数结合起来

```
US$TradeDates <- paste(US$Date,US$Time)

head(US)

  Symbol     Date     Time     Open     High      Low    Close Volume Tick.Count        TradeDates
1  USH94 01/03/94 08:21:00 114.4062 114.4375 114.3750 114.4062      0          5 01/03/94 0.34791667
2  USH94 01/03/94 08:22:00 114.3750 114.4062 114.3125 114.3750      0         11 01/03/94 0.34861111
3  USH94 01/03/94 08:23:00 114.3438 114.3750 114.3125 114.3438      0          7 01/03/94 0.34930556
4  USH94 01/03/94 08:24:00 114.3125 114.3125 114.2500 114.2812      0         14 01/03/94 0.35000000
5  USH94 01/03/94 08:25:00 114.2500 114.2812 114.2188 114.2188      0          6 01/03/94 0.35069444
6  USH94 01/03/94 08:26:00 114.1875 114.2500 114.1875 114.2500      0         13 01/03/94 0.35138889 
```

看到 TradeDates 列突然有十进制形式的时间....但真正困扰我的是，如果我逐个元素执行完全相同的功能，我会得到所需的结果：

```
US$TradeDates[1] <- paste(US$Date[1],US$Time[1])

head(US)

  Symbol     Date     Time     Open     High      Low    Close Volume Tick.Count          TradeDates
1  USH94 01/03/94 08:21:00 114.4062 114.4375 114.3750 114.4062      0          5   01/03/94 08:21:00
2  USH94 01/03/94 08:22:00 114.3750 114.4062 114.3125 114.3750      0         11 01/03/94 0.34861111
3  USH94 01/03/94 08:23:00 114.3438 114.3750 114.3125 114.3438      0          7 01/03/94 0.34930556
4  USH94 01/03/94 08:24:00 114.3125 114.3125 114.2500 114.2812      0         14 01/03/94 0.35000000
5  USH94 01/03/94 08:25:00 114.2500 114.2812 114.2188 114.2188      0          6 01/03/94 0.35069444
6  USH94 01/03/94 08:26:00 114.1875 114.2500 114.1875 114.2500      0         13 01/03/94 0.35138889 
```

注意最后一列的第一行正是我想要的，但所有其他行仍然是十进制形式。如果这是一个可管理的数据集，我将只使用一个循环，但这实际上是数十亿行，而 R 根本无法处理该循环。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:46:46.923

你应该以 POSIX 格式工作，这会让你的生活更轻松。

您可以将`Date`列转换为`POSIXlt`使用

```
as.POSIXlt(as.character(US$Date), format="%d/%m/%Y") 
```

然后，只需`Time`在几秒钟内添加列，`POSIXlt`格式将处理其余部分。

# macros - LISP 表达式列表

> ID：13482633
> 
> 赞同：-1
> 
> 时间：2012-11-20T21:37:49.713
> 
> 标签：macros, lisp

我有一个表达式列表，我想在宏内按顺序计算并返回最后一个表达式的值。我试过这个，但编译器不喜欢它：

```
(defmacro foo lst-of-exprs
  ',@lst-of-exprs) 
```

和

```
(defmacro foo lst-of-exprs
  '(progn ,@(lst-of-exprs)) 
```

有没有办法在不使用 do 循环的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T07:14:51.813

你要

```
(defmacro foo lst-of-exprs
  `(progn ,@lst-of-exprs)) 
```

尽管实际上这只是为`progn`自己定义了一个同义词。

# .net - HTTP 错误 403.14 - 禁止 - MVC4 .net 4.5 捆绑包

> ID：13482637
> 
> 赞同：27
> 
> 时间：2012-11-20T21:38:02.570
> 
> 标签：.net, asp.net-mvc, iis, razor, .net-4.5

我使用 razor 引擎用 .net 4.5 制作了一个 MVC4 应用程序。使用 Visual Studio 在本地运行时效果很好。

当我在 windows server 2008 R2 上部署到 IIS（所有 windows 更新完成）时，似乎我的捆绑包不起作用并且 CCS 未加载。我尝试在服务器上查看该站点，查看的源代码转到了 css 的捆绑链接，它加载了一些 css，然后出现 IIS 错误：

> HTTP 错误 403.14 - 禁止 Web 服务器配置为不列出此目录的内容。

我试过的：

1) 确保已安装 .net 4.5。
2）添加`<modules runAllManagedModulesForAllRequests="true"/>`到我的 web.config
3）`%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_regiis.exe -ir`在 cmd 中运行
4）检查我的应用程序池是否设置为集成模式
5）检查它是否设置为使用 .net 4

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-12-08T02:57:23.040

你会在这里找到答案：[ASP.NET MVC framework 4.5 CSS bundles does not work on the hosting](https://stackoverflow.com/questions/12081255/asp-net-mvc-framework-4-5-css-bundles-does-not-work-on-the-hosting)

简短的回答是确保您的捆绑包名称不会与您网站中的路径名称冲突。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-14T18:28:26.580

这为我解决了（解决方案来自[MVC4 HTTP Error 403.14 - Forbidden](https://stackoverflow.com/questions/11425574/mvc4-http-error-403-14-forbidden/11435677#11435677)）

```
<system.webServer>
   <modules runAllManagedModulesForAllRequests="true"/> 
 </system.webServer> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-10T11:34:57.760

确保在 web.config 中启用了对“虚拟”捆绑路径的匿名访问。

例如，如果您的样式包类似于“~/content/blahblah”，而您的 javascript 包类似于“~/scripts/blahblah”，则您必须在 web.config 中打开匿名访问“内容”和“脚本”这样的位置：

```
<configuration>
 ...
 <location path="content">
  <system.web>
   <authorization>
    <allow users="?" />
   </authorization>
  </system.web>
 </location>

 <location path="scripts">
  <system.web>
   <authorization>
    <allow users="?" />
   </authorization>
  </system.web>
 </location>
 ...
</configuration> 
```

这样，任何用户对虚拟路径“~/content”或“~/scripts”的任何请求都将被批准，CSS和JS请求将被处理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-09T08:00:56.640

导致 403.14 的另一个潜在问题是 global.asax 和/或 web.config 未在您的发布设置或部署中复制。

# javascript - 如何根据内容的长度动态更改对象或 iframe 的长度

> ID：13482639
> 
> 赞同：1
> 
> 时间：2012-11-20T21:38:02.153
> 
> 标签：javascript, jquery, object, iframe

我正在开发一个项目，其中网页由不同的片段组成，这些片段动态加载了不同类型的对象。例如，在某个时刻，一个页面可能有 2 个片段，一个显示视频，另一个显示一些文本，而在另一个时间，同一页面可能显示 2 个文本块。内容的变化取决于查看它的用户，因为相同的片段（由对象标签或 iframe 定义）可能包含视频（mp4、avi 等）或文本（pdf、docx、txt 等），或者图片等

我遇到的问题与内容的大小（特别是长度）有关。object 和 iframe 标签都由一个边界框分隔，我需要根据内容的长度调整它的大小。如果内容是 30 页长的 PDF，我需要在网页中呈现所有 30 页。我不能让用户向下滚动来查看 PDF 的内容，我需要它尽可能无缝地成为网页的一部分。

[这里](https://stackoverflow.com/questions/1573220/how-do-i-refer-to-the-document-object-of-an-iframe-from-the-parent-page-using/1575412#1575412)找到的答案似乎提供了一个可能的解决方案。我不知道JQuery，但我可以学习。但是，我注意到这些示例中使用的内容始终是网页。就我而言，iframe 的内容可以是许多不同的类型，我想知道是否可以使用 JQuery 来确定不是网页的内容的大小。如果不能，任何人都可以为我的问题提出解决方案吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:47:13.850

您将不得不使用 jquery 或 javascript 来动态设置 iframe 的高度，

这些应该工作

```
// For other good browsers.
$('iframe').load(function() {
  this.style.height =
  this.contentWindow.document.body.offsetHeight + 'px';
});

// Safari and Opera need a kick-start.
for (var i = 0, j = iFrames.length; i < j; i++) {
  var iSource = iFrames[i].src;
  iFrames[i].src = '';
  iFrames[i].src = iSource;
} 
```

[这里](http://sonspring.com/journal/jquery-iframe-sizing)有一整篇文章解释了这段代码

# java - 从 AsyncTask 更新 MapView/MapController？

> ID：13482650
> 
> 赞同：0
> 
> 时间：2012-11-20T21:39:03.913
> 
> 标签：java, android, android-asynctask, android-mapview

我正在制作我的第一个 Android 应用程序，它在初始加载时确定用户的当前位置并在 MapView 中转到它。我已将 MapView/MapController 的初始化委托给 AsyncTask 以使应用程序感觉更灵敏，但我的 doInBackground 方法中出现了 RuntimeException。这是我的初始 Activity 和我正在使用的 AsyncTask 的代码。

```
public class MainActivity extends MapActivity {

Location latestLocation, targetLocation;
MapController mapController;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // Get a reference to the MapView
    MapView myMapView = (MapView)findViewById(R.id.myMapView);

    MapLoader map = new MapLoader();
    try {
        map.execute(myMapView).get();
    } catch (InterruptedException e) {
        e.printStackTrace();
    } catch (ExecutionException e) {
        e.printStackTrace();
    }
    mapController = myMapView.getController();
    //code which determines current location and animates to it in the Mapview.
}
} 
```

这是我的 AsyncTask 的代码。

```
public class MapLoader extends AsyncTask<MapView ,Void, Void>{

MapController mapController;
MapView mapView;

@Override
protected Void doInBackground(MapView... params) {
    // Get the Map View’s controller
    mapController = params[0].getController();
    // Configure the map display options
    mapView.setSatellite(true);
    mapView.displayZoomControls(false);
    // Zoom in
    mapController.setZoom(19);
    return null;

} 
```

}

我是否也应该将用于确定位置的代码放入 AsyncTask 中？目前，我的应用程序加载速度很慢，并且即使在所有内容都初始化后也没有响应。

# javascript - 将上一个和下一个滑块添加到 JS

> ID：13482652
> 
> 赞同：0
> 
> 时间：2012-11-20T21:39:06.267
> 
> 标签：javascript, jquery, slider

这个滑块很好用：

[http://pastebin.com/BxN8vbAt](http://pastebin.com/BxN8vbAt)

我要添加的一件事是 Prev 和 Next

任何人都知道如何使 Prev/Next 链接正常工作？：

```
<ul>
    <li><a href="#">Prev</a></li>
    <li><a href="#">Opens Slide 1</a></li>
    <li><a href="#">Opens Slide 2</a></li>
    <li><a href="#">Opens Slide 3</a></li>
    <li><a href="#">Next</a></li>
</ul> 
```

*解决

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:43:15.407

将课程`link-prev`和课程添加`link-next`到您的上一个和下一个链接。

```
<a href="#" class="link-prev">Prev</a>
<a href="#" class="link-next">Next</a> 
```

并让寻呼机使用`switcher`你的 ul 上的类。但是，您将无法在 ul 中包含上一个和下一个链接。

```
<ul class="switcher"></ul> 
```

# codeigniter - CodeIgniter 和 csv_from_result

> ID：13482654
> 
> 赞同：0
> 
> 时间：2012-11-20T21:39:17.697
> 
> 标签：codeigniter, csv

我从数据库中获取数据并使用

```
$query = $this->db->query("SELECT * FROM mytable");

echo $this->dbutil->csv_from_result($query); 
```

但是我想更改我的 CSV 标题的名称，因为 first_name 是 First Name ......我该怎么做呢？

谢谢，J

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T09:12:14.717

尝试重命名 sql 查询返回的列：

```
$query = $this->db->query("
    SELECT 
         first_name as 'First Name', last_name as 'Last Name' 
    FROM mytable
"); 
```

缺点是您必须列出列而不是简单的`*`.

# java - 将 unicode 数据符号转换为字符串

> ID：13482656
> 
> 赞同：0
> 
> 时间：2012-11-20T21:39:20.847
> 
> 标签：java, eclipse, string, unicode, encoding

我一直无法解决 Java Unicode 和编码的问题。问题是我有 5,000 多个字符串，例如：“Steve O#8217Conord and Mirco Savas”和...“Rusell O’Connell”，其中“#8217”和“’”必须用撇号替换。

但是此代码有许多不同的变体，`apache.common.lang.StringUtils`Apache 库并没有帮助我解决问题，因为该库需要以“&”字符开头和“;” 在末尾。我不能到处输入这些，因为有超过 5,000 个字符串。因此，如果有任何方法使用正则表达式或其他方法在字符串中找到这些序列并用撇号替换它们，我会很高兴听到它:)

此外，还有一些像“Oâ€™”这样的符号，它们是一个大问题，因为它们应该以 UTF8 格式读取。我的意思是像 (\u8127) 和其他字符。你有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:23:04.247

尝试这样的事情：

```
import java.io.FileOutputStream;
import java.io.PrintWriter;
import org.apache.commons.lang3.StringEscapeUtils;

String[] myStringPool = {"Steve O#8217Conord and Mirco Savas","Rusell O&#146Connell"};
PrintWriter pw = new PrintWriter("utf-8.txt", "UTF-8");
for(String string : myStringPool) {
    pw.println(StringEscapeUtils.unescapeXml(string.replaceAll("&?#(\\d+);?", "&#$1;")));
}
pw.close(); 
```

假设您已经有这些字符串可访问，`string.replaceAll("&?#(\\d+);?", "&#$1;")`清理字符串中的 XML 实体，以便通过`org.apache.commons.lang3.StringEscapeUtils`（[在此处](https://commons.apache.org/lang/download_lang.cgi)获取）进行转义，这些字符串最终以 UTF-8 格式写入文件。

请注意，Java 可以配置为以 UTF-8 格式自动读取和写入文件。Java 应该自动为您的系统使用正确的编码。除非您真的知道自己在做什么，否则将文件显式写入特定编码通常是一个坏主意。

# jquery - 如何在主窗口后面打开弹出窗口（HTML，jQuery）

> ID：13482658
> 
> 赞同：-3
> 
> 时间：2012-11-20T21:39:28.443
> 
> 标签：jquery, html, popup

我是新来的。我有一个弹出代码，当用户单击 HTML 页面中的任意位置时，会显示一个弹出窗口：

```
(function () {
    document.onclick = function () {

        var sUrl = "http://URL.com";

        if (typeof daily_capping == "undefined") var daily_capping = 10;

        if (typeof capping_minutes == "undefined") var capping_minutes = 60;

        if (document.cookie.indexOf("_popwin=") === -1) {

            var ads2day = document.cookie.split("_popwinDaily=")[1];

            ads2day = typeof ads2day == "undefined" ? 0 : parseInt(ads2day.split(";")[0]);

            if (ads2day < daily_capping) {

                var isMSIE = navigator.userAgent.indexOf("MSIE") != -1 ? !0 : !1,
                    _parent = self,
                    sOptions, popunder;

                if (top != self) try {
                    top.document.location.toString() && (_parent = top)
                } catch (err) {}

                sOptions = "toolbar=no,scrollbars=yes,location=yes,statusbar=yes,menubar=no,resizable=1,width=" + screen.width.toString() + ",height=" + (screen.height - 20).toString() + ",screenX=0,screenY=0,left=0,top=0", popunder = _parent.window.open(sUrl, "rhpop", sOptions);

                if (popunder) {
                    popunder.blur();
                    if (isMSIE) {
                        window.focus();
                        try {
                            opener.window.focus()
                        } catch (err) {}
                    } else popunder.init = function (e) {
                        with(e)(function () {
                            if (typeof window.mozPaintCount != "undefined" || typeof navigator.webkitGetUserMedia == "function") {
                                var e = window.open("about:blank");
                                e.close()
                            }
                            try {
                                opener.window.focus()
                            } catch (t) {}
                        })()
                    }, popunder.params = {
                        url: sUrl
                    }, popunder.init(popunder)
                }

                var now = new Date,
                    popDaily = (new Date(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate(), 23, 59, 59)).toGMTString();

                document.cookie = "_popwinDaily=" + (ads2day + 1) + ";expires=" + popDaily + ";path=/";

                var popInterval = new Date;
                popInterval.setTime(popInterval.getTime() + capping_minutes * 60 * 1e3), document.cookie = "_popwin=1;expires=" + popInterval.toGMTString() + ";path=/"

            }
        }
    }
})(); 
```

但弹出窗口位于顶部。是否可以在主页后面打开它？是否有任何更轻的弹出代码用于此目的？多谢你们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:56:57.113

你绝对不应该这样做。弹出式广告具有侵入性且令人讨厌。在窗户下面偷偷打开弹窗就更脏了。

如果您不想打扰用户，请不要使用任何类型的弹出窗口为您投放广告。

或者，您可以在现有页面中内嵌显示您的广告。

无论如何，像这样的弹出窗口很可能会被现代浏览器阻止。他们被阻止的原因是用户不想看到这种行为，这可能很危险。

不要制作隐藏的弹出广告。

# java - Netbeans Java 模块交互

> ID：13482659
> 
> 赞同：1
> 
> 时间：2012-11-20T21:39:32.517
> 
> 标签：java, netbeans, module

处理这个问题的方法是什么`Netbeans`？

模块**A**和**B**是顶级组件

1.  A 实现和 B 用来与 A 交互的接口。
2.  B 使用 Lookup API 查找 A，但获得了 A 的新实例，该实例作为新实例不会更新显示的原始 A 的 gui。

3.  基本上 B 需要与 A 的原始实例对话。

4.  松散耦合的 A 和 B 的父级不应该将一个实例发送给另一个。

与`Netbeans`父级是 Windows 应用程序，它似乎甚至没有可编辑的编码区域来发送实例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-24T19:01:42.873

最好的解决方案是拆分为 ATopComponent 和一些 AStorage（例如）。ATopComponent 应该在 AStorage 上实现 LookupListner。

要搜索 ATopComponent，您应该使用 WindowManager.getDefault().find(id of ATopComponent)

# java - javafx-2 ComboBox 转换器：方法 toString(T object) 不为空值调用

> ID：13482662
> 
> 赞同：1
> 
> 时间：2012-11-20T21:39:51.427
> 
> 标签：java, combobox, javafx-2

在 javafx2 应用程序中，ComboBox 应该显示项目列表，在示例中它们`String`为简单起见。

该列表包含一个`null`项目，因为我希望允许用户别无选择。

由于我正在使用 ComboBox 的转换器属性，我想知道是否可以使用它来为无选择的情况提供一个很好的表示，例如“[none]”而不是空行。
但我发现 toString(Object object) 永远不会为 null 项目调用。

下面是重现该案例的最短代码。包括版本信息。

```
import javafx.application.Application;
import javafx.scene.Scene;
import javafx.scene.control.ComboBox;
import javafx.stage.Stage;
import javafx.util.StringConverter;

public class T05 extends Application {
@Override public void start(Stage primaryStage) throws Exception {

    System.out.println(System.getProperty("java.runtime.version"));
    System.out.println(System.getProperty("javafx.runtime.version"));
    System.out.println(System.getProperty("os.version"));
    System.out.println(System.getProperty("os.name"));        

    ComboBox c = new ComboBox();
    //c.setEditable(true);
    primaryStage.setScene(new Scene(c));
    primaryStage.show();

    c.getItems().add("first");
    c.getItems().add(null);

    c.setConverter(new StringConverter<String>(){
        @Override public String toString(String object) {

            System.out.print("converting object: ");
            if (object==null) {
                System.out.println("null");
                return "[none]";
            }
            System.out.println(object.toString());
            return object.toString();
        }

        @Override public String fromString(String string) {
            throw new RuntimeException("not required for non editable ComboBox");
        }

    });

}

} 
```

这是输出，你可以看到`if (object==null)`语句的真正分支永远不会被调用。它是错误还是功能，是否可以自定义空表示？

```
 1.6.0_29-b11
 2.2.3-b05
 6.1
 Windows 7
 converting object: first
 converting object: first
 converting object: first 
```

**更新**
添加一个（只需取消注释）：

```
c.setEditable(true); 
```

我得到另一种行为，即单击组合选择框中的空项，我调用了toString方法，但结果未呈现在选择框中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T00:42:21.580

如果用户没有选择，您可以使用`setPromptText`方法在组合框中显示“[None]”。

示例代码：

```
comboBox.setValue(null);

comboBox.setPromptText("[None]"); 
```

# sql - VBA EXCEL SQL CREATE TABLE 语法

> ID：13482664
> 
> 赞同：0
> 
> 时间：2012-11-20T21:39:55.830
> 
> 标签：sql, excel, vba

有人可以帮我解决以下问题。我正在尝试创建一个表，该表将包含一个 Id 列，该列在插入记录时会自动递增。这是用于微软访问的。

```
"CREATE TABLE " & tblName & " ([P_Id] integer not null AUTOINCREMENT(100, 5))" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:53:20.550

尝试以下方法来创建一个带有自动编号字段的 MS Access 表：

```
"CREATE TABLE [" & tblName & "] ([P_Id] integer not null IDENTITY)" 
```

我不知道您是否可以指定起始值和增量，但您可以尝试一下。

# c# - 使用 C# 查询两个日期之间的 Excel 列

> ID：13482665
> 
> 赞同：2
> 
> 时间：2012-11-20T21:39:56.790
> 
> 标签：c#, sql, excel, oledb

嗨，我试图从两个日期之间的 excel 中选择数据。我有点卡住，因为 excel 中的数据只是文本类型。我将如何查询这个？

```
string Date = DateTime.Now.AddDays(7).ToString("dd/MM/yyyy HH:mm");

string Date2 = DateTime.Now.ToString("dd/MM/yyyy HH:mm");

MyCommand = new System.Data.OleDb.OleDbDataAdapter("select [Req Start Date] from [CR$]", BETWEEN Date and Date2 ? MyConnection); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T01:44:24.940

您可以使用标准 SQL 语法在两个日期之间进行查询，但您需要将日期作为日期参数分配给 OleDbDataAdapter。否则，它将日期视为文本，您将无法获得正确的匹配。

```
DataSet ds = new DataSet();

using (OleDbDataAdapter dataAdapter = new OleDbDataAdapter(SQL, conn))
{
    // Format the dates as dd/mm/yyyy

    string date1 = DateTime.Now.AddDays(7).ToString("dd/MM/yyyy");
    string date2 = DateTime.Now.ToString("dd/MM/yyyy");

    // Set up the SQL with the two date paramters

    string SQL = "SELECT [Req Start Date] FROM [CR$] WHERE [Req Start Date] BETWEEN ? AND ?";

    // Assign the two dates

    dataAdapter.SelectCommand.Parameters.Add("@p1", OleDbType.Date).Value = date1;
    dataAdapter.SelectCommand.Parameters.Add("@p2", OleDbType.Date).Value = date2;

    // Run the query

    dataAdapter.Fill(ds);
} 
```

# c# - 从 dotnet 使用 Java Web 服务的最佳实践是什么

> ID：13482666
> 
> 赞同：0
> 
> 时间：2012-11-20T21:39:57.057
> 
> 标签：c#, java, wcf, web-services

我们可以使用两种方法来使用 Java Web 服务……使用 Dotnet Web 服务或 WCF。有人可以指出做一种或另一种方式的好处吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:24:31.463

如果它是一个肥皂网络服务，您只需在 .NET 中添加对 url 的服务引用

> 网址示例：

```
 http://host:9232/Calculator/CalculatorServiceService?wsdl 
```

![在此处输入图像描述](../Images/7f5ea6b74425992662dd2d053cffbce0.png)：

由于 Java EE Web 服务 (JAX-WS) 是**标准 SOAP 服务**，因此只需单击几下即可轻松地与 .Net 客户端应用程序进行互操作。Visual Studio 生成了一个 .Net 客户端代理，使连接和调用服务变得非常容易。

网络服务调用示例：

```
static void Main(string[] args)
{
    CalculatorServiceClient proxy = new CalculatorServiceClient();
    int result = proxy.Add(2, 3);
    Console.WriteLine("Calculator Service returned: " + result.ToString());
} 
```

# crystal-reports - Crystal Reports - 多个组级别 - 提高效率

> ID：13482667
> 
> 赞同：0
> 
> 时间：2012-11-20T21:40:06.470
> 
> 标签：crystal-reports, crystal-reports-2008

我不得不对我们的一份报告进行一些修改，该报告由约 30 个子报告组成，以将其从约 4 个组级别更改为现在具有约 18 个组级别。似乎它受到了严重的处理退化的影响。我添加了组抑制，因为我关心的唯一组级别是：1（用于将返回的数据分解为部分，因此不必多次重新查询数据库，从而消除额外的数据库命中和额外的子报告)、6-11（部门/地区/等数据）和 18（基层，按人）。

将来可能需要我需要的水平之间的水平，因此现在已经考虑到它们，但是由于它对性能产生了如此负面的影响，我想禁用它们。现在他们被压制了，但他们显然还在被处理，这正在扼杀表演。

我怎样才能在不丢失我所做的所有工作的情况下恢复效率？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:18:02.777

如果包含子报表的部分被抑制 - 不应执行子报表，因此不执行查询。

从报告菜单中，选择性能信息，您将获得所花费时间的细分。

如果这不是自我解释，请给我们更多信息，我们应该能够提供帮助。

# c# - 带有分页 c# 的 Sql Select 语句

> ID：13482672
> 
> 赞同：1
> 
> 时间：2012-11-20T21:40:34.770
> 
> 标签：c#, sql, sql-server-2008, select, pagination

在 c# 控制器上编写用于分页的选择语句的正确方法是什么。这是我想出的最好的，但我知道它不起作用，因为它在网格的第一页上显示了所有数据......请帮助

```
public JsonResult getData(int start, int limit)
{
  List<MyItem> items = new List<MyItem>();
  using (SqlConnection con = new       SqlConnection(ConfigurationManager.ConnectionStrings["ApplicationServices1"].ConnectionString))
 {
 SqlCommand cmd = con.CreateCommand();
 cmd.CommandText = "SELECT State, Capital FROM MYDBTABLE";
 con.Open();
 SqlDataReader reader = cmd.ExecuteReader();
 while (reader.Read())
 {
   MyItem item = new MyItem();
   item.State = reader[0].ToString(); 
   item.Capital = reader[1].ToString(); 
   items.Add(item);
 }
 con.Close();

 if ((start + limit) > Myitem.Count)
 {
    limit = Myitem.Count - start;
 }
 return Json(new {  myTable = items }, JsonRequestBehavior.AllowGet);
 }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T21:48:33.107

这是我喜欢用于分页的存储过程的模板。

```
CREATE PROCEDURE [dbo].[StoredProcName] 
    @page_size INT
    , @page_num INT
AS
BEGIN

    SET NOCOUNT ON;

    ; WITH RESULTS AS
    (
        SELECT *
            , ROW_NUMBER() OVER (ORDER BY <order_col> DESC) AS rn
            , ROW_NUMBER() OVER (ORDER BY <order_col> ASC) AS rn_reversed
        FROM <table>
    )
    SELECT *
        , CAST(rn + rn_reversed - 1 AS INT) AS total_rows
        , CAST(CASE (rn + rn_reversed - 1) % @page_size
            WHEN 0 THEN (rn + rn_reversed - 1) / @page_size
            ELSE ((rn + rn_reversed - 1) / @page_size) + 1 
            END AS INT) AS total_pages
    FROM RESULTS a
    WHERE a.rn BETWEEN 1 + ((@page_num - 1) * @page_size) AND @page_num * @page_size
    ORDER BY rn ASC 

END 
```

你只需要传入存储过程`page_size`，`page_num`你就可以开始了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T22:24:18.830

您可以使用 Linq 并使用`Skip()`并`Take()`像这样：

```
public JsonResult getData(int page, int limit)
{
    DataTable dt = new DataTable();
    using (SqlConnection cnn = new SqlConnection(ConfigurationManager.ConnectionStrings["ApplicationServices1"].ConnectionString))
    {
        using (SqlCommand cmd = cnn.CreateCommand())
        {
            cmd.CommandType = CommandType.Text;
            cmd.CommandText = "SELECT State, Capital FROM MYDBTABLE";
            using (SqlDataAdapter da = new SqlDataAdapter(cmd))
            {
                da.Fill(dt);
            }
        }
    }
    int start = (page * limit) - limit;
    List<MyItem> items  = (from DataRow row in dt.Rows
                           select new MyItem
                           {
                                State = row["State"].ToString(),
                                Capital = row["Capital"].ToString()
                           }).Skip(start - 1).Take(limit).ToList();
    return Json(new {  myTable = items }, JsonRequestBehavior.AllowGet);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:16:42.877

我使用的基本模板是：

```
SELECT ROW_NUMBER(), <Rest of your columns>
FROM <Your Tables/Joins>
WHERE ROW_NUMBER() >= (@PageNum * @RowsPerPage)
AND ROW_NUMBER() < (@PageNum+1 * @RowsPerPage) 
```

# ruby-on-rails - Formtastic 找不到 date_select 的输入类

> ID：13482673
> 
> 赞同：1
> 
> 时间：2012-11-20T21:40:34.803
> 
> 标签：ruby-on-rails, forms, datetime, datepicker, mongoid

我正在创建一个非常基本的表单，其中 formtastic 和 mongoid 作为 ORM。现在我首先尝试手动设置我的字段类型，但我得到了同样的错误。现在我也应用了这个[“补丁”](https://gist.github.com/3742676)，所以字段类型会像 ActiveRecord 一样自动映射，但我仍然遇到同样的问题：

```
Unable to find input class for date_select 
```

或者

```
Unable to find input class for datetime_select 
```

这是我的模型

```
class Event
  include Mongoid::Document

  paginates_per 25

  field :title, type: String
  field :date,  type: Date
  field :place, type: String
end 
```

所以这是非常基本的。我正在使用 ruby​​-1.9.3-p194、formtastic (2.2.1) 和 mongoid (3.0.13)，但我认为这个问题与 mongo 无关。我怀疑formtastic是这里的问题。有没有人遇到过同样的问题？非常欢迎任何提示！

# c# - ReadByte 函数是否正常工作

> ID：13482675
> 
> 赞同：-1
> 
> 时间：2012-11-20T21:40:43.850
> 
> 标签：c#

在`FileStream`课堂上，我们的`ReadByte`方法很好，实际上它不起作用，因为我认为为什么`ReadByte`忽略字节开头的“非重要”零？我怎么能避免呢？

正如评论中提到的那样，是的，我正在尝试将其转换为字符串

```
dane.Append(Convert.ToString((byte)w,2)); 
```

那么是 ToString 函数跳过零吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:52:40.930

数字是一样的；只有 ToString 是问题

```
dane.Append(Convert.ToString((byte)w,2).PadLeft(8, '0')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:47:29.427

`ReadByte`读取一个字节。它返回的结果是一个*数字*。当您说“不重要的零”时，大概是指零*位数*。但是数字不是数字的属性，它们是以十（或十六）为底的数字的文本描述的属性。

*“8”和“08”是用数字表示相同*数字的两种不同方式。如果您没有看到以您想要的方式描述的数字，则问题在于选择谁来描述它的代码。

# javascript - 为什么我的事件监听器不工作？

> ID：13482682
> 
> 赞同：2
> 
> 时间：2012-11-20T21:41:27.833
> 
> 标签：javascript, javascript-events

我一直在到处寻找，即使我找到了答案，也没有以我能理解的方式交付。我在 jsfiddle 上玩弄这段代码，试图理解为什么这个点击处理程序不起作用。如果这是一个无用的帖子，我深表歉意，只是试图理解这一切。如果有人知道有关如何呈现javascript代码以及函数如何传递对象等的任何好的教程。请给我链接！我已经阅读了如何编写函数等的基础知识。但对我来说，了解解析代码时发生的事情是完全不同的事情。

这是我要开始工作的代码：

[http://jsfiddle.net/UumUP/3144/](http://jsfiddle.net/UumUP/3144/)

```
// Function to change the content of t2  
function modifyText(evt) {  
  var thing = evt.target;
  thing.firstChild.nodeValue = "four";      
}  

// add event listener to t  
var el = document.getElementsByTagName("td");  

for(i = 0; i < el.length; i++) {
  el[i].addEventListener("click", modifyText(evt), false);   
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:44:48.693

您正在调用函数并传递该调用的结果，而不是传递函数的引用，而是这样做：

```
el[i].addEventListener("click", modifyText, false); 
```

[http://jsfiddle.net/UumUP/3145/](http://jsfiddle.net/UumUP/3145/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:45:37.087

```
el[i].addEventListener("click", modifyText(evt), false); 
```

应该是

```
el[i].addEventListener("click", modifyText, false); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/UumUP/3146/)**

# qt - 使用 systemd 自动启动的 Qt GUI 实例不响应输入

> ID：13482683
> 
> 赞同：2
> 
> 时间：2012-11-20T21:41:33.733
> 
> 标签：qt, embedded-linux, init, systemd

我有一个嵌入式 Linux 板，它使用 systemd 进行启动过程。我还有一个用 Qt 编写的 GUI，我可以从命令行很好地启动它，并使用电路板的触摸屏或按钮进行交互。要启动应用程序，我通常会这样做：

```
ssh root@192.168.1.2
cd ~/
./gui 
```

我希望它使用 SystemD 自动启动，所以我编写了一个如下所示的服务文件：

```
[Unit]
Description=The Qt Gui
After=dropbear.service systemd-logind.service
ConditionFileIsExecutable=/home/user/gui

[Service]
ExecStart=/home/user/gui
Restart=on-abort

[Install]
WantedBy=multi-user.target 
```

当板子启动时，我在 systemd 日志中看到它在 dropbear SSH 服务之后立即启动我的 gui：

```
[  OK  ] Started Dropbear SSH2 daemon.
         Starting The Qt Gui...
[  OK  ] Started The Qt Gui. 
```

如果我在启动后通过 SSH 连接到主板并运行“ps”，我可以看到我的进程已启动（如果我杀死它，它会按预期从 systemd 重新启动）：

```
196 root     26868 S    /home/user/gui 
```

systemctl status 的输出对我来说看起来不错，请注意最后一行 'ARM build' 是我的代码中的 qDebug() 打印语句：

```
gui.service - The Qt Gui
      Loaded: loaded (/etc/systemd/system/gui.service; enabled)
      Active: active (running) since Tue, 2012-11-20 21:30:20 UTC; 4min 35s ago
    Main PID: 196 (gui)
      CGroup: name=systemd:/system/gui.service
          └ 196 /home/user/gui

Nov 20 21:30:20 systemd[1]: Starting The Qt Gui...
Nov 20 21:30:20 systemd[1]: Started The Qt Gui.
Nov 20 21:30:22 gui[196]: ARM build 
```

但是，我根本无法与使用 systemd 启动的 GUI 实例进行交互！如果我从命令行启动辅助实例，则可以按下按钮或触摸屏，GUI 会在屏幕上弹出并按预期工作。是什么赋予了？我在服务文件中尝试了“Type=forking”，但这也无济于事。关于这里有什么问题的任何想法？我怎样才能让 systemd 启动我的 Qt GUI，就像我从命令行启动它一样？谢谢 -

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:51:16.000

感谢上面的输入。它实际上不是工作目录或时间问题。问题是我的 Qt GUI 没有获得与触摸屏通信所需的正确环境变量。采购 /etc/profile 对我有用：

```
[Unit]
Description=The Qt Gui
After=dropbear.service
ConditionFileIsExecutable=/home/user/gui

[Service]
Type=simple
TimeoutStartSec=60
WorkingDirectory=/home/user
ExecStartPre=/bin/sh -c 'echo 127 > /sys/class/backlight/generic-bl/brightness'
ExecStart=/bin/sh -c 'source /etc/profile ; /home/user/gui -qws'
Restart=always

[Install]
WantedBy=multi-user.target 
```

# nfs - 如何清除 Puppet 中的非托管 NFS 挂载？

> ID：13482686
> 
> 赞同：1
> 
> 时间：2012-11-20T21:41:42.977
> 
> 标签：nfs, puppet

如何使用 Puppet 清除所有非托管 NFS 挂载？

示例 1：以下 Puppet 代码清除所有未由 Puppet 显式管理的用户：

```
resources { "user":
  purge => true,
} 
```

示例 2：以下代码清除所有非托管 Nginx 虚拟主机：

```
file { "/etc/nginx/sites-enabled/":
  recurse => true,
  purge => true,
} 
```

但是如何清除所有非托管 NFS 挂载？

这是我尝试过的。我对 NFS 挂载有自己的定义：

```
define nfs-client::mount() {
...
} 
```

但是，以下方法不起作用：

```
resources { "nfs-client::mount":
  purge => true,
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-29T21:00:32.763

根据这个[错误报告](http://projects.puppetlabs.com/issues/7600)，我不认为这适用于定义（它们是资源的集合） - 仅适用于实现了 initialize() 方法的类型（内置或自定义）（这些是单独的资源）。

但是，由于“ [mount](http://docs.puppetlabs.com/references/latest/type.html#mount) ”是内置资源，您应该能够：

```
resources{'mount': purge => true} 
```

# sql - SQL查询按月分组的计数百分比

> ID：13482691
> 
> 赞同：1
> 
> 时间：2012-11-20T21:41:57.240
> 
> 标签：sql, oracle

我收到一条消息，说表达式是无效标识符。我还收到消息说单个 group by 无效。请提出替代方案。

我有以下 Oracle SQL 语句：

```
SELECT SUM(CASE
            WHEN PDRVARIANCE >= -1 then '1'
            WHEN PDRVARIANCE <-1 then '0'
          END) 
         / count(*) 
         * 100 as PercentCompliance ,
       TO_CHAR (ACTUALFINISHDATE,'MM/YY') AS DCSMONTH
  FROM    ACTIVITIES
WHERE DCSMONTH IS NOT NULL
GROUP BY DCSMONTH 
```

现有数据将是这样的......

```
Variance     Month
   20       10/12
   3.2      10/12
   -4.2     10/12
   -27.8    10/12
   13       11/12
   3        11/12
   -1.2     12/12
   -2       12/12 
```

期望的结果是对每个方差条件和按月分组的“真”与“假”的百分比，并将其显示为...

```
Percent   Month
    50    10/12
    100   11/12
    0     12/12 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T05:58:01.540

您不能在定义它们的相同范围内使用列别名。

您要么必须替换`GROUP BY DSCMONTH`为`GROUP BY TO_CHAR (ACTUALFINISHDATE,'MM/YY')`（并对 where 子句执行相同的操作），要么将查询包装在另一个查询中。

喜欢，

```
select dcsmonth, sum(data) / count(*) * 100 percentcompliance 
  from (
SELECT CASE WHEN PDRVARIANCE >= -1 then 1
            WHEN PDRVARIANCE <-1 then 0 END data,
       TO_CHAR (ACTUALFINISHDATE,'MM/YY') AS DCSMONTH
  FROM  ACTIVITIES 
WHERE ACTUALFINISHDATE IS NOT NULL
)
GROUP BY DCSMONTH 
```

# css - 将图像与文本对齐

> ID：13482697
> 
> 赞同：0
> 
> 时间：2012-11-20T21:42:22.337
> 
> 标签：css, image, html, alignment

我正在尝试将图像与其右侧的文本对齐。我还希望图像与文本垂直对齐。但是当我开始写文字时，它会在图像下方。关于如何解决这个问题的任何想法？

```
<div style="float: left; vertical-align: middle">
<img alt="" src="/portals/85/Images/AukraMaritime.gif" class="Images" />
</div>
<div style="float: left;">
<a href="http:\\www.aukramaritime.no&quot;" class="LinksMenu LeftMenu HoverLinkH1">Aukra Maritime</a>
<br />
<br />
<span>Nam quam nunc, blandit vel, luctus pulvinar, hendrerit id, lorem. Maecenas nec odio et ante tincidunt tempus. Donec vitae sapien ut libero venenatis faucibus. Nullam quis ante. </span><br />
<br />
<a href="http:\\www.aukramaritime.no" class="LinksMenu LeftMenu HoverLink">www.aukramaritime.no</a>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:47:41.423

`float:left`从第二个中删除`div`。

请注意文本将如何从图像旁边开始，然后将漂浮在下方。为了防止这种情况，添加`overflow:hidden`到文本 div，或者给它一个固定的宽度并将它浮动到左边。

请参阅[http://jsfiddle.net/D7gGp/3/](http://jsfiddle.net/D7gGp/3/)。

要垂直对齐，请将图像和文本都包含在一个 div 中，绝对定位图像，将 top:50% 与 margin-top:-(halfImageHeight)px 一起设置，然后将文本向右推以留出空间图片。请参阅[http://jsfiddle.net/D7gGp/6/](http://jsfiddle.net/D7gGp/6/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:55:56.520

您还可以使用边距来调整文本

```
.classname {
          margin-top: 15px;
 }

or

.classname{

            margin : 1px 1px 1px 1px; (please change as per your requirement)
                  /*(BOTTOM, LEFT, RIGHT, TOP)*/
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:43:10.230

您需要将图像浮动到左侧：

CSS

```
.Images { float:left; } 
```

# java - Java WatchService ..监听网络上的目录

> ID：13482698
> 
> 赞同：2
> 
> 时间：2012-11-20T21:42:24.817
> 
> 标签：java, service, directory, watchservice

我正在尝试`listen to directories`通过网络 [All on Windows] 获取//`Create`事件。它似乎不适用于网络上的目录。`Modify``Delete``WatchService`

任何第三方图书馆或任何替代品都将受到高度赞赏。

映射网络驱动器对我来说不是一个选项，因为我有**50 多个目录**要收听。

# ruby-on-rails - Mongoid 3 中的 limit(10) / Moped 对整个集合执行 count()

> ID：13482699
> 
> 赞同：0
> 
> 时间：2012-11-20T21:42:35.283
> 
> 标签：ruby-on-rails, performance, mongodb, mongoid, mongoid3

我有一个执行快速执行的简单查询的操作，但由于某种原因，它还执行了一个`count()`我没有要求的命令：

在控制器中：

```
@things = Thing.active.where(city: "New York", state: "New York).limit(10).desc(:qs) 
```

在日志中：

```
MOPED: 127.0.0.1:27017 QUERY        database=dirot_development collection=things selector={"$query"=>{"status"=>"available", "city"=>"New York", "state"=>"New York"}, "$orderby"=>{"qs"=>-1}} flags=[:slave_ok] limit=10 skip=0 fields=nil (3.8438ms)
MOPED: 127.0.0.1:27017 KILL_CURSORS cursor_ids=[3455573564096875000] (0.0620ms)
MOPED: 127.0.0.1:27017 COMMAND      database=dirot_development command={:count=>"things", :query=>{"status"=>"available", "city"=>"New York", "state"=>"New York"}} (378.4430ms) 
```

从日志中可以看出，计数需要**378 毫秒**，而实际获取我想要的 10 个文档只需要**4 毫秒**。我怎样才能消除计数？

我正在使用 will_paginate，但不在此特定操作/视图中。

有任何想法吗？

*** 更新 *** Active 只是一个标准范围：`scope :active, where(status: "available")`

# css - 什么柱轴：垂直；做？

> ID：13482702
> 
> 赞同：0
> 
> 时间：2012-11-20T21:42:38.677
> 
> 标签：css, webkit

我正在尝试[CSS 多列](http://www.w3.org/TR/css3-multicol/)规范并提出`column-axis`. 但我不明白它的作用是什么？似乎`column-axis: horizontal;`是*常规*的CSS 列，但我不知道`vertical`会做什么。在我的测试中，它完全禁用了列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:05:06.837

看起来背后的想法是

> 允许“列”沿块轴而不是内联轴堆叠。这可以促进分页界面。添加了 column-axis 属性以启用此模式。

根据[http://code.google.com/p/webkit-mirror/source/detail?r=ed6bd9e2ff389c57409a0808527e219b97b347b1](http://code.google.com/p/webkit-mirror/source/detail?r=ed6bd9e2ff389c57409a0808527e219b97b347b1)

我可能错了，但我怀疑目前任何浏览器都不支持它..

# hibernate - 实体类的休眠查询

> ID：13482703
> 
> 赞同：0
> 
> 时间：2012-11-20T21:42:39.423
> 
> 标签：hibernate

我正在与`Person.java.`

此休眠实体没有标记任何字段`@Field.`

另一个类`Group.java`是具有标记的字段的实体`@Field`。

```
@Field
private int id; 
```

在这个遗留代码中，我看到了对 Group 的查询：

```
 getEntityManager().createQuery("delete from group g where g.id = 
:inputId").setParameter("inputId", givenId).getSingleResult(); 
```

但是，我不确定如何对没有字段的实体进行休眠查询。

谢谢，凯文

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:00:42.577

`@Field`不是 JPA 注释，也不是 Hibernate 注释。我不知道它来自哪个包，但它与 JPA/Hibernate 持久性没有任何关系。因此，对于 Hibernate 查询，字段是否具有此注释这一事实是无关紧要的。

默认情况下，没有任何注释，JPA 实体的所有字段都是持久的。

# c# - 如何提取超类来封装通用代码？

> ID：13482722
> 
> 赞同：0
> 
> 时间：2012-11-20T21:44:11.837
> 
> 标签：c#, .net, oop, inheritance, superclass

我有一个使用插件的应用程序。在创建了其中几个之后，我发现大量代码在它们上到处重复，所以我想提取一个超级“插件库”。

在重构之前，我有以下结构：

![以前的结构](../Images/d7fadf4327d29185a05ef97a63a8f5d6.png)

重构后，我有下一个：

![当前结构](../Images/35282fe37dee3575aae0db06aa2bcbb0.png)

我目前没有找到一种方法来模拟插件引擎具有*插件设置*类型的属性*设置*和*插件引擎基础*具有*插件设置基础*类型的属性*设置*的事实。我觉得应该以某种方式声明插件引擎基础的设置属性应该是插件引擎的设置属性的“强制转换”，*并*模拟它们都是相同属性的事实。

 ***我不确定问题是否得到充分解释。随时要求澄清。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:47:52.187

您可以使用泛型。创建泛型基类并将泛型参数约束指定为 type `PluginSettingsBase`。

```
abstract class PluginEngineBase<T>
   where T: PluginSettingsBase
{
   public abstract T Settings { get; set; }
} 
```

从由类参数化的基类继承`PluginsSettings`（因此它是从 继承的`PluginSettingsBase`）

```
class PluginEngine : PluginEngineBase<PluginsSettings>
{
   public PluginSettings Settings { get; set; }
} 
```

与 相同`PluginData`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:02:58.890

我发现的一种方法：

基类：

```
class PluginEngineBase
{
    public PluginSettingsBase Settings { get; set; }
} 
```

继承人：

```
class PluginEngine : PluginEngineBase
{
    public PluginSettings Settings
    {
        get
        {
            return (PluginSettings)base.Settings;
        }
        set
        {
            base.Settings = value;
        }
    }
} 
```***

# html - 如何使div网格居中？

> ID：13482723
> 
> 赞同：2
> 
> 时间：2012-11-20T21:44:17.523
> 
> 标签：html, css

为了详细描述这个问题，我必须做出一些假设：

1.  我有一个项目列表，长度未知（可以是 1、2 甚至 50）
2.  我想在网格中显示它们 - 行中的项目数是未知的（由用户的显示分辨率决定）。
3.  每个项目的宽度都是相同的，并且固定为 250 像素。
4.  项目间距应由显示分辨率确定，或者应缩小容器的宽度。
5.  我**不想**使用 JS。

[你可以在FoodGawker](http://foodgawker.com/)看到我想做什么。我正在使用 2 台不同分辨率的显示器。当将我的浏览器从一个拖放到另一个时，它只会将更多项目排成一行，但所有内容仍然居中且对称。它也适用于禁用 JS。

所以我知道这是可能的，但我不知道该怎么做。

我尝试了浮动：、显示：等的许多变体，但无法使其工作。

下面的代码最接近我想要的 - 适用于 2 个内部 div，但对于许多它不再居中。有任何想法吗？

```
.center_wrapper {
    background: grey;
    padding: 10px;
    text-align: left;
    overflow: hidden; 
    display:inline-block;
}

.cards_wrapper {
    background: red;
    overflow: hidden; 
    margin-left: auto;
    margin-right: auto;
    text-align: center;
    width: 90%;

}
.card {
    background: blue;
    width: 250px;
    height: 250px;
    margin: auto 20px;
    display:inline;
}

<div class="cards_wrapper">
    <div class="center_wrapper">
        <div class="card">
            <img src="./Index - My ASP.NET MVC Application_files/noImageAvailable.png">
        </div>
        <div class="card">
            <img src="./Index - My ASP.NET MVC Application_files/noImageAvailable.png">
        </div>
    </div>
</div> 
```

![在此处输入图像描述](../Images/ac17b737ca35e9edf0e9d1219532343b.png)

![10](../Images/d8cc0bf935d5c60df1ddbda0890788c7.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-20T21:54:30.070

使用`inline-block`和 %`margin`

演示：http: [//jsfiddle.net/MadLittleMods/9SZDC/](http://jsfiddle.net/MadLittleMods/9SZDC/)

```
.block
{
    display: -moz-inline-stack;
    display: inline-block;
    vertical-align: top;
    zoom: 1;
    *display: inline;

    width: 250px;
    height: 100px;
    background: #aaeeff;

    margin: 1%;
}​ 
```

如果要使块居中，则可以向容器添加文本对齐

```
.container
{
    text-align: center;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:50:43.150

删除`text-align: left;`from`.center_wrapper`应该可以解决问题。

[如此处](http://jsbin.com/ekabel/1/edit)所见。

# python - python覆盖我的列表元素

> ID：13482727
> 
> 赞同：0
> 
> 时间：2012-11-20T21:44:31.180
> 
> 标签：python, list, class

对 python 来说相当新，对 python 类来说非常新。问题有点牵涉。非常感谢您的耐心：

我有一个班级“明星”。很简单。属性 x、v 和质量。另一个类 Galaxy 有一个属性“stars”，它只是一个星体列表：

```
class Galaxy:

    numstars=0.
    stars=[]

    def __init__(self,numin,xes,vees,masses):
        self.numstars=numin
        for n in range(numin):
            self.stars.append(Star(xes[n],vees[n],masses[n])) 
```

Galaxy 还有一个名为 time_stepper 的属性函数。只需说 time_stepper 只是更新“stars”的所有元素，然后返回“stars”：

```
def time_stepper(self,dt):
    self.velstep(dt)
    self.xstep(dt)
    self.velstep(dt)
    return(self.stars) 
```

现在，我正在尝试驱动这个东西并将“stars”的各种更新存储在一个名为“history”的列表中：

```
gal=Galaxy(#stuff#)
history=[]
for n in range(100):
    history.append(gal.time_stepper(.1)) 
```

最后，我的问题：在这个循环的每次迭代中，“星”的新元素被添加到“历史”中，但是......在这里......*历史的所有先前元素都被覆盖并给出与历史的最新元素相同的价值观！* 那么发生了什么？我遇到了一些我以前不理解的关于 python 列表的事情，但我想我终于把它搞定了。显然不是。谢谢你的帮助。

附录：感谢大家的帮助。没想到会有这么多有用的回复，尤其是这么快。我的问题是我假设这两段代码本质上是相同的。第一的：

```
>>> a=[]
>>> b=[1,2,3]
>>> a.append(b)
>>> b=[4,5,6]
>>> a.append(b)
>>> a
[[1, 2, 3], [4, 5, 6]] 
```

第二：

```
>>> a=[]
>>> b=[1,2,3]
>>> a.append(b)
>>> b[:]=(4,5,6)
>>> b
[4, 5, 6]
>>> a.append(b)
>>> a
[[4, 5, 6], [4, 5, 6]] 
```

哎呀！他们不是。所以在代码 1 中，我猜，b 被“重新指向”到一个全新的内存位置，而 a[0] 继续指向旧的 b。在第二个中，b 处的内存被“编辑”并且 a[0] 仍然指向该位置。追加后， a[1] 也指向该位置。我现在有吗？

我对 python 很陌生，并且仍在研究“pythonic”哲学。但对我来说，直接重新分配指针，但以更复杂的方式完成“深拷贝”与我通常想要做的事情的方式有点倒退。任何人都可以启发我吗？再次感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T21:48:43.073

我认为值得注意的是，如果你有超过 1 个星系，它们将共享相同的恒星。这可能会让你相信你正在覆盖你的星星，而实际上你并没有……

我猜你可能会更好`__init__`，看起来像：

```
def __init__(self,numin,xes,vees,masses):
    self.stars = []
    self.numstars = numin
    for n in range(numin):
        self.stars.append(Star(xes[n],vees[n],masses[n])) 
```

在这里，我将*类属性* `stars`转换为*实例属性*。现在每个实例都有自己的列表，而不是与宇宙中的所有其他星系`stars`共享一个列表。`stars`

正如其他人所指出的，您的`history`列表将遇到类似的问题（您对*同一个列表*有多个引用）。但是，修复实际上取决于您在`self.velstep`和中执行的操作`self.xstep`。如果您`Star`就地修改对象，那么简单（浅）列表副本对您没有任何好处（例如`gal.time_stepper(0.1)[:]`）。（您将创建一个新列表，但它将包含不断更新的相同星星）。在这种情况下，`copy.deepcopy`当您追加到历史列表时，您会需要：

```
history=[]
for n in range(100):
    history.append(copy.deepcopy(gal.time_stepper(.1))) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T21:47:14.847

这是因为`stars`列表是可变的——它是一个可变变量。当您调用 时`stars.append`，它不会创建新列表 - 它只是编辑现有列表。当您调用 时`history.append(x)`，python 不会创建一个全新的、干净的副本`x`- 它假定您希望将“真实”`x`放置在`history`数组中。

如果您想在每次迭代时复制列表的状态，有几个选项（请参阅[如何在 python 中克隆列表？](https://stackoverflow.com/questions/2612802/how-to-clone-a-list-in-python)）。

该[`copy`模块](http://docs.python.org/2/library/copy.html)将解决问题。它同时提供“浅”和“深”副本——粗略地说，深副本试图复制他们在对象中找到的任何其他变量（例如，包含其他列表的列表），而浅副本只向下一层：

这是浅拷贝`copy`：

```
import copy

history=[]
for n in range(100):
    history.append(copy.copy(gal.time_stepper(.1))) 
```

和深拷贝：

```
import copy

history=[]
for n in range(100):
    history.append(copy.deepcopy(gal.time_stepper(.1))) 
```

切片数组将起作用，因为它总是将浅拷贝作为中间步骤：

```
history = []
for n in range(100):
    history.append(gal.time_stepper(.1)[:]) 
```

您还可以调用`list`现有列表 - 这种类型转换的操作总是返回一个新的列表对象（再次，浅层）：

```
history = []
for n in range(100):
    history.append(list(gal.time_stepper(.1))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T21:47:43.867

它不是更改或重写所有值，而是历史记录中的所有元素都指向同一个数组对象。您需要按值分配，而不是使用数组的副本进行引用。

# javascript - 找不到名称属性

> ID：13482728
> 
> 赞同：0
> 
> 时间：2012-11-20T21:44:36.063
> 
> 标签：javascript, jquery, datatables

在两种情况之一中，我在尝试获取 datatables.js 行上的复选框时遇到问题。

使用下面的代码 chkCtrl.name 在处理程序函数中未定义。

```
$("table#tblAssays tbody tr").each(function (index) {
        if ($.trim($(this).find('td:eq(9)').text()) == todayDOW) 
        {
            var chkCtrl = $(this).find("td input:checkbox");
            HandleCheckedChanged(chkCtrl);
        } 
```

但是，如果我按以下方式处理单击事件，则 this.name 返回一个值

```
 $("#tblAssays").on("click", "tbody td input:checkbox", function () {
    HandleCheckedChanged(this); 
```

有人可以指出我做错了什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:51:21.980

`$(this).find("td input:checkbox")`返回一个没有 name 属性的 jQuery 对象，而`this`在 click 处理函数中引用一个 DOM 对象，它有一个 name 属性。

试试`HandleCheckedChanged(chkCtrl[0]);`吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:53:02.377

在您的第一个示例中，您将 jQuery 对象引用传递给该`HandleCheckedChanged`函数。在后者中，您实际上是在传递 DOM 元素。

您应该将第一个更改为：

```
var chkCtrl = $(this).find("td input:checkbox").get(0); 
```

# c# - ASP:Label、span 和 javascript elementbyId 访问

> ID：13482731
> 
> 赞同：3
> 
> 时间：2012-11-20T21:44:43.203
> 
> 标签：c#, asp.net, html, getelementbyid

我目前正在尝试访问一个类中的控件。

HTML 代码：

```
 <span class="GeoPanelHeaderLeft">
       <asp:Literal ID="LiteralHeaderText" runat="server" Text="New Survey Ticket"></asp:Literal>
     &nbsp
      &nbsp
      &nbsp
       <asp:Image ID = "errorImg" runat = "server" ImageUrl="..\Images\caution_red.gif" visible        = "false"/>
     <asp:Label ID = "literalerrortext2" runat="server" ClientIDMode= "Static"></asp:Label>
    <asp:Label ID = "literalerrortext3" runat="server" ClientIDMode= "Static"></asp:Label>
     <asp:Label ID = "LiteralErrorText" runat="server" ClientIDMode="Static" ></asp:Label> 
```

JavaScript 代码：

```
 function setError(message) {
            var test = window.document.getElementById("LiteralErrorText");
            var test2 = window.document.getElementById("literalerrortext2");
                var test3 = window.document.getElementById("literalerrortext3");

      } 
```

当我运行我的 javascript 函数时，getElementById 函数返回“literalerrortext2”和“literalerrortext3”的对象，但是当涉及“LiteralErrorText”时该对象为空。

我正在使用母版页，但不确定为什么会这样。如果有人可以提供帮助，那就太棒了。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:54:43.293

*您的 Literal 控件按字面意思*呈现为**New Survey Ticket**（没有 html，除非您选择将其放在那里）...与您的 Label 控件不同，它呈现为`<span id=myid>Some text</span>`.

# bash - 用于计算 LOC 的 BASH 脚本

> ID：13482736
> 
> 赞同：2
> 
> 时间：2012-11-20T21:45:12.933
> 
> 标签：bash, scripting, cygwin

在我所有的源代码文件中，我在每个文件的顶部都有一个信息“标题”，如下所示（Java 中的示例）：

```
/* Project: UVa Online Judge
 * Filetype: Java Source Code File
 * Filename: generic.java
 * Path: compsci/sandbox/uva_online_judge
 * Filesize: 1275 bytes
 * Date Created: 11/17/2011
 * Last Modified: Tue Nov 20, 2012  02:28PM
 * LOC: 33
 */ 
```

从 BASH 命令行（我在 Cygwin 版本 1.7.16 上使用 GNU bash 版本 4.1.10）我正在尝试计算特定项目文件夹中所有源文件的总 LOC（代码行）。我将转到顶级项目文件夹（我的一些源代码位于该文件夹的子文件夹中）并运行以下命令：

```
$ grep -r LOC: * 
```

这给了我以下信息：

```
generic.c: * LOC: 44
generic.java: * LOC: 33
solved/100/uva_100.java: * LOC: 77
solved/102/uva_102.java: * LOC: 139
solved/108/uva_108.c: * LOC: 94
solved/120/uva_120.java: * LOC: 109
solved/200/uva_200.java: * LOC: 83
solved/414/uva_414.c: * LOC: 61
solved/424/uva_424.c: * LOC: 100
solved/700/uva_700.c: * LOC: 108
solved/900/uva_900.java: * LOC: 54
unsolved/341/uva_341.java: * LOC: 349 
```

但是我想修改那个 bash 脚本来实际计算总 LOC，因为上面的输出是 1251。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:55:50.417

这是另一种方法`awk`：

```
grep -r LOC: * | awk '{sum+=$NF} END{print sum}' 
```

**解释：**

*   `grep -r LOC: *`- 你的问题已经说明了它的作用
*   `|`将上一步中 grep 的结果通过管道传递到下一个命令
*   `awk`调用 awk 工具
*   `{sum+=$NF}`: 对于每一行，将最后一个字段添加到`sum`. `NF`代表 awk`$NF`中的字段数，具有该数字的字段的内容也是如此。
*   `END{print sum}`: 解析完所有行后，打印总和

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:49:54.440

尝试这样做：

```
bc <<< $(tr ' ' '+' <<< $(grep -r '^ *\* *LOC:' | cut -d ' ' -f4)) 
```

或这个

```
c=0
grep -r '^ *\* *LOC:' | cut -d ' ' -f4 | while read a; do
    ((c+=$a))
done

echo "$c lines" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T21:49:46.030

您应该能够使用 awk：

```
grep -r LOC: * | awk 'BEGIN{sum=0}{sum=sum+$4}END{print sum}' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T05:17:55.693

您可以通过设置 $IFS 来使用一个可爱的技巧：

```
total=$(set -- $(grep -hoP '(?<=LOC: )\d+' *); IFS=+; bc <<< "$*") 
```

假设 cygwin 有 GNU grep

# ruby-on-rails - Rails：复杂的html到link_to helper

> ID：13482742
> 
> 赞同：4
> 
> 时间：2012-11-20T21:45:32.713
> 
> 标签：ruby-on-rails, ruby, hyperlink

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T21:49:10.000

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T21:51:59.600

```
<%= link_to "", "#landing", :id => 'landing_link' do %>
  <div id="headerlogo"></div>
<% end %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:52:08.133

您可以将块传递给 link_to 辅助方法：（HAML）

```
= link_to("#landing", :id => "landing_link") do 
  .headerlogo 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T22:22:46.797

像这样的东西

```
<%= link_to content_tag(:div, '', :id=>'headerlogo'), '#landing', :id=>'landing_link' %> 
```

# java - SwingWorker.process 没有被调用

> ID：13482748
> 
> 赞同：1
> 
> 时间：2012-11-20T21:45:41.080
> 
> 标签：java, swing, swingworker

编辑：我解决了我的问题：

```
while(!finish.equals("readline")){
    publish(finish);
    finish = Main.in.readLine();
} 
```

必须改为：

```
while(true){
    publish(finish);
    finish = Main.in.readLine();
} 
```

老问题：

我正在用 Java 编写一个聊天应用程序，我制作了一个简单的 Gui，它运行良好。但现在我已经重写了收集聊天消息的部分，使其成为线程安全的。登录时，服务器将聊天中的所有消息推送到客户端，这很好用。在那一刻之后，GUI继续响应，我可以发送命令并且它们到达服务器但是没有调用过程方法，所以没有返回任何内容。我究竟做错了什么？

这是我正在谈论的代码：

```
package Client;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.Socket;
import java.net.UnknownHostException;
import java.util.List;

import javax.swing.SwingWorker;

public class ChatReceiver extends SwingWorker<Void, String> {
    @Override
    protected Void doInBackground() {
        try {
            Main.echoSocket = new Socket(Main.ip, 4444);
            Main.out = new PrintWriter(Main.echoSocket.getOutputStream(), true);
            Main.in = new BufferedReader(new InputStreamReader(
                    Main.echoSocket.getInputStream()));
        } catch (UnknownHostException e) {
            System.err.println("Don't know about host.");
        } catch (IOException e) {
            System.err.println("Couldn't get I/O for "
                    + "the connection to: localhost.");
        }
        publish("Sending Login-Request...");
        Main.out.println("login");
        try {
            String text = Main.in.readLine();
            String status = Main.in.readLine();
            publish("Receiving: " + text + " " + status);
            if(status.equals("readline") && text.equals("ready")){
                String finish = "logging in...";
                Main.out.println(Main.name + " SZUTKEY");
                while(!finish.equals("readline")){
                    publish(finish);
                    finish = Main.in.readLine();
                }
            }else{
                throw new RuntimeException("Fuck it login died!");
            }
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        return null;
    }

    @Override
    protected void process(List<String> chats) {
        Main.printTest("xxx");
        for(String s : chats.toArray(new String[0])){
            Main.printTest("called");
            Main.printTest(s);
        }
        Main.textField.validate();
        Main.textField.repaint();
    }
} 
```

这在我的 Gui 中被调用：

```
 loginAction  = new AbstractAction("Login") {

        /**
         * 
         */
        private static final long serialVersionUID = -3279591081543889275L;

        @Override
        public void actionPerformed( ActionEvent arg0 ) {
            name = JOptionPane.showInputDialog("Please input your Chatname");
            ip = JOptionPane.showInputDialog("Please input the Chatserver-IP", "localhost");
            (chat = new ChatReceiver()).execute();
        }
    }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T07:22:30.003

*   你的[SwingWorker 没有完成](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/simple.html)

*   你[错过了覆盖方法 done()](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html#done%28%29)，

*   在`done()`您只能调用时`get()`，[请注意您的代码永远不会捕获任何异常](https://stackoverflow.com/questions/7053865/cant-get-arrayindexoutofboundsexception-from-future-and-swingworker-if-threa)

*   [关于类似想法的代码示例](https://stackoverflow.com/a/6114890/714968)

# java - 如何忽略 Eclipse 中的顶级源文件夹？

> ID：13482749
> 
> 赞同：4
> 
> 时间：2012-11-20T21:45:44.750
> 
> 标签：java, eclipse

在我的 Eclipse 项目中，我有两个源文件夹，**src/app**和**src/test**，每个文件夹分别编译到自己的输出文件夹**classes/app**和 **classes/test**中。

不幸的是，由于它们具有相同的父目录**src**，因此该父目录也显示在 Eclipse 的包资源管理器层次结构中。这没什么大不了的，但它是多余的和烦人的。见插图

![在此处输入图像描述](../Images/24ee4212995375fba6714cd8a8e11125.png)

知道如何从视图中删除 src 但将其两个相关子目录显示为源文件夹吗？我尝试在**配置构建路径**下进行，但找不到方法。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T06:35:48.953

使用 Package Explorer View 的视图菜单，选择 Filters，勾选“Non Java Elements”。这将隐藏同一工作区中的其他非 Java 项目，因此请谨慎使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:08:45.427

你不能，除了开发你自己的插件。

您最接近的方法是单击 2 个黄色箭头旁边的箭头 ![这里](../Images/f1b84c6fd6e8c0f568b502c25af44a1a.png)

并转到过滤器，最后检查“非 java 元素”，但我怀疑 ant 文件也会被隐藏。

问候

# nodes - Greedy Best First Search和A*算法如何修剪返回的节点？

> ID：13482750
> 
> 赞同：3
> 
> 时间：2012-11-20T21:45:52.737
> 
> 标签：nodes, graph-algorithm, a-star, greedy

我正在尝试使用网格（二维数组）实现 GBFS 和 A*。我想在我们进一步讨论之前......这两种算法都记得以前的位置吗？如果是，这是否意味着如果启发式更好，它会跳转到那个位置，即如果它会跳转到兄弟姐妹的孩子的节点，如果兄弟姐妹的孩子比当前节点的孩子有更好的启发式？更好的解释是，例如，如果我有一个 8x8 网格并且我在坐标 7,7 上，我检查了它旁边的单元格，但在 PriorityQueue 中，我们有一个坐标 3,5，它比下一个单元格具有更好的启发式到 7,7...我们会跳到 3,5 吗？

如果答案是肯定的，那么我的问题是如何从已从 PriorityQueue 中删除的返回节点创建正确的路径，因为我们可以从一个位置跳转到另一个位置？即我们如何修剪节点以创建实际路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:48:55.737

> 两种算法都记得以前的位置吗？如果是，这是否意味着如果启发式更好，它将跳转到该位置，即如果兄弟姐妹的孩子比当前节点的启发式更好，它会跳转到兄弟姐妹的孩子的节点吗？孩子们？

两者都是。

当您将节点插入优先级队列时，您应该跟踪它们的“父”节点，即它们之前的节点。例如，如果您在 7,7，然后将 8,7 添加到队列中，则应将 8,7 的父级设置为 7,7。

这样，您可以通过跟随父链从任何节点回溯到起始节点。

> 如果我有一个 8x8 网格并且我在坐标 7,7 上，我检查它旁边的单元格，但在 PriorityQueue 中，我们有一个坐标 3,5，它比 7,7 旁边的单元格具有更好的启发式...我们会跳到 3,5 吗？

是的。在 7,7 之后考虑 3,5 并不意味着玩家“跳”到 3,5。这意味着他现在正在考虑另一条路径，因为通过 3,5 的路径似乎比通过 7,7 的路径更有希望，至少暂时如此。

> 如何从已从 PriorityQueue 中删除的返回节点创建正确路径？

最终您将到达目标节点。假设目标节点是 6,6，而您从 6,5 到达那里。你如何重建让你到达那里的路径？

*   看看 6,5 的父母。
*   看看 6,5 的父母的父母。
*   看看 6,5's parent's parent's parent。
*   等等

这最终会让你回到起始节点，这就是你的路径（反向）。

![GBFS 父母](../Images/a0c4ba4705f6eb0dd2fe6bf248e52bec.png)

根据[您之前的问题](https://stackoverflow.com/questions/13434590/given-a-grid-would-best-first-search-jump-to-a-cell-across-the-board-if-heurist)获取此示例图像。每个箭头代表您拥有的一个父指针。每次搜索从一条路径“跳转”到另一条路径时，我都会更改颜色。请注意如何从搜索期间访问的任何节点开始，然后按照箭头返回开始节点。

# c++ - C++ 原子增量内存排序

> ID：13482751
> 
> 赞同：3
> 
> 时间：2012-11-20T21:45:54.590
> 
> 标签：c++, c++11, atomic

在 C++11 中：如果我增加一个原子变量（std::atomic 上的运算符 ++），新值是否与内存屏障一起存储？还是我必须明确地做一个商店？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T21:53:29.207

您不需要进行显式存储。将使用顺序一致性内存排序。

`operator++(int)`和`operator++()`on类型被指定为具有 的效果，最终以默认的内存顺序调用成员函数。`atomic<`*`integral`*`>``fetch_add(1)``memory_order_seq_cst`

有关规范，请查看*原子类型操作的要求*[atomics.types.operations.req] 29.6.5/33

# django - 在 django-crispy-forms 中使用字段标签作为占位符

> ID：13482753
> 
> 赞同：7
> 
> 时间：2012-11-20T21:46:05.753
> 
> 标签：django, twitter-bootstrap, django-crispy-forms

我正在考虑将字段标签用于我的`<input>`HTML 元素的占位符属性的 DRY 方式。我正在使用`django-crispy-forms`.

现在我有：

```
class FilterForm(Form):

    query = CharField(max_length=50, label='', required=False)

    def __init__(self, data=None, files=None, **kwargs):
        self.helper = FormHelper()
        self.helper.layout = Layout(
            Field('query', placeholder='Search ...'),
        )
        super(FilterForm, self).__init__(data, files, **kwargs) 
```

但是，我宁愿不必分别设置标签和占位符，因为这 for 最终会有更多字段，而且非常冗长。

你有什么建议？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-05-31T15:30:09.453

**使用此__init__**方法可以实现 DRY 解决方案：

> ```
> def __init__(self, *args, **kwargs):
>     super(FilterForm, self).__init__(*args, **kwargs)
>     helper = self.helper = FormHelper()
> 
>     # Moving field labels into placeholders
>     layout = helper.layout = Layout()
>     for field_name, field in self.fields.items():
>         layout.append(Field(field_name, placeholder=field.label))
>     helper.form_show_labels = False 
> ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-22T12:46:11.250

目前，隐藏标签可以通过使用下面的[引导辅助属性](http://django-crispy-forms.readthedocs.org/en/latest/form_helper.html#bootstrap-helper-attributes)来实现：

> self.helper.form_show_labels = False
> 
> 默认设置为真。它决定是否呈现表单的字段标签。

您仍然需要使用 Field 布局对象定义占位符：

> Field('查询', placeholder='搜索...'),

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-17T11:44:10.990

试试这个：

```
class FilterForm(Form):

    query = CharField(max_length=50, label='', required=False)

    def __init__(self, data=None, files=None, **kwargs):
        self.helper = FormHelper()
        self.helper.layout = Layout(
            Field('query', placeholder=kwargs.pop('query_placeholder', 'random text')),
        )
        super(FilterForm, self).__init__(data, files, **kwargs) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-21T18:54:05.557

这种 DRY 解决方案不需要修改布局。我建议把它做成一个mixin：

```
class MyForm(Form):

    _placeholders = {
        'fieldname': 'fieldname placeholder',
    }

    def __init__(self, *args, **kwargs):

        # Assign placeholder to widget of fields
        # listed in self._placeholders.
        for field_name, field in self.fields.items():
            if field_name in self._placeholders:
                self.fields[field_name].widget.attrs['placeholder'] = \
                self._placeholders[field_name]

        super(MyForm, self).__init__(*args, **kwargs) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-20T23:02:59.663

您可以使用以下方法向表单字段添加额外的属性：

```
query = CharField(widget=forms.TextInput(attrs={'placeholder':'Search..'}),
                  max_length=50, label='', required=False) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-13T14:57:36.733

如果您想要更多控制权，可以使用小部件字段

```
class PostForm(forms.ModelForm):
    class Meta:
        model = Post
        widgets = {
            'comment': forms.Textarea(attrs={'rows': 6, 'placeholder': 'Enter your comments'}),
        }
        labels = {
            "private": "Keep Private",
        }
        exclude = ['response', 'display'] 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-04-18T17:33:59.740

我最终只是使用 css 隐藏了字段标签。这有点hackish，但有效。我仍然使用 placeholder="your label" 来定义占位符。

# asp.net-mvc-4 - 成员资格和角色提供者

> ID：13482754
> 
> 赞同：0
> 
> 时间：2012-11-20T21:46:10.327
> 
> 标签：asp.net-mvc-4

任何人都可以让我知道电子邮件地址存储在 mvc 数据库中的哪个位置以进行新安装。

例如，如果我从以下位置获取用户：

```
MembershipUser user = Membership.GetUser(userName); 
```

然后查看属性 user.email 这是空的。我似乎无法在数据库中的任何位置看到设置此标志的标志。

我可以像这样将此值保存到 userprofile 表中

```
String confirmationToken = WebSecurity.CreateUserAndAccount(model.UserName, model.Password, new {Email=model.Email}, requireEmailConfirmation); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:15:03.743

电子邮件和任何其他用户信息都存储在`UserProfile`表中。如果要使用 ASP.NET MVC 4 附带的简单成员资格提供程序，则不应再使用该`Membership.GetUser`方法，而应使用相应的 DBContext 直接查询数据库。请查看[以下文章](http://blog.longle.net/2012/09/25/seeding-users-and-roles-with-mvc4-simplemembershipprovider-simpleroleprovider-ef5-codefirst-and-custom-user-properties/)，该文章描述了如何将自定义属性添加到用户配置文件中。

# android - 如何为存储数组的android写入/读取文件

> ID：13482757
> 
> 赞同：0
> 
> 时间：2012-11-20T21:46:18.717
> 
> 标签：android, arrays, file

我有两个活动。EnterPin 和 ConfirmPin。数组是 pin 和 confirmpin。我需要比较两者。我想用一个文件来比较数组。Enterpin 将写入文件，并且 Confirmpin 应该读取并将其数组与文件进行比较。这可能吗？我一直在做一些研究，但似乎没有什么适合我想做的事情。

```
public class EnterPin extends Activity {
public int[] pin = new int[4];
public Button[] buttons = new Button[10];
public int counter = 0;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_enter_pin);
    //getActionBar().setDisplayHomeAsUpEnabled(true);

    buttons[1] = (Button)findViewById(R.id.button1);
    buttons[2] = (Button)findViewById(R.id.button2);
    buttons[3] = (Button)findViewById(R.id.button3);
    buttons[4] = (Button)findViewById(R.id.button4);
    buttons[5] = (Button)findViewById(R.id.button5);
    buttons[6] = (Button)findViewById(R.id.button6);
    buttons[7] = (Button)findViewById(R.id.button7);
    buttons[8] = (Button)findViewById(R.id.button8);
    buttons[9] = (Button)findViewById(R.id.button9);
    buttons[0] = (Button)findViewById(R.id.button0);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_enter_pin, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case android.R.id.home:
            NavUtils.navigateUpFromSameTask(this);
            return true;
    }
    return super.onOptionsItemSelected(item);
}
public void button1(View view)
{
    if(counter < 3)
    {
        pin[counter] = 1;
        counter++;
    }
    else
    {
        PinEntered();
    }
}
public void button2(View view)
{
    if(counter < 3)
    {
        pin[counter] = 2;
        counter++;
    }
    else
    {
        PinEntered();
    }
} 
public void button3(View view)
{
    if(counter < 3)
    {
        pin[counter] = 3;
        counter++;
    }
    else
    {
        PinEntered();
    }
}
public void button4(View view)
{
    if(counter < 3)
    {
        pin[counter] = 4;
        counter++;
    }
    else
    {
        PinEntered();
    }
}
public void button5(View view)
{
    if(counter < 3)
    {
        pin[counter] = 5;
        counter++;
    }
    else
    {
        PinEntered();
    }
}
public void button6(View view)
{
    if(counter < 3)
    {
        pin[counter] = 6;
        counter++;
    }
    else
    {
        PinEntered();
    }
}
public void button7(View view)
{
    if(counter < 3)
    {
        pin[counter] = 7;
        counter++;
    }
    else
    {
        PinEntered();
    }
}
public void button8(View view)
{
    if(counter < 3)
    {
        pin[counter] = 8;
        counter++;
    }
    else
    {
        PinEntered();
    }
}
public void button9(View view)
{
    if(counter < 3)
    {
        pin[counter] = 9;
        counter++;
    }
    else
    {
        PinEntered();
    }
}
public void button0(View view)
{
    if(counter < 3)
    {
        pin[counter] = 0;
        counter++;
    }
    else
    {
        PinEntered();
    }
}
public void PinEntered()
{
   if(counter == 3)
   {
    TextView EnterPin = (TextView) findViewById(R.id.EnterPin);
    EnterPin.setText("Pin Entered");
    startActivity(new Intent("com.example.textsmslock.ConfirmPin"));
   }
}
public int GetPin(int pin)
{
    return pin;
}
} 
```

.

```
public class ConfirmPin extends EnterPin {
public int[] pinconfirm = new int[4];
public Button[] buttons = new Button[10];
public int counter = 0;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_confirm_pin);
    //getActionBar().setDisplayHomeAsUpEnabled(true);
    buttons[1] = (Button)findViewById(R.id.button1);
    buttons[2] = (Button)findViewById(R.id.button2);
    buttons[3] = (Button)findViewById(R.id.button3);
    buttons[4] = (Button)findViewById(R.id.button4);
    buttons[5] = (Button)findViewById(R.id.button5);
    buttons[6] = (Button)findViewById(R.id.button6);
    buttons[7] = (Button)findViewById(R.id.button7);
    buttons[8] = (Button)findViewById(R.id.button8);
    buttons[9] = (Button)findViewById(R.id.button9);
    buttons[0] = (Button)findViewById(R.id.button0);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_confirm_pin, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case android.R.id.home:
            NavUtils.navigateUpFromSameTask(this);
            return true;
    }
    return super.onOptionsItemSelected(item);
}
public void button1(View view)
{
    if(counter < 3)
    {
        pinconfirm[counter] = 1;
        counter++;
    }
    else
    {
        ConfirmingPin();
    }
}
public void button2(View view)
{
    if(counter < 3)
    {
        pinconfirm[counter] = 2;
        counter++;
    }
    else
    {
        ConfirmingPin();
    }
} 
public void button3(View view)
{
    if(counter < 3)
    {
        pinconfirm[counter] = 3;
        counter++;
    }
    else
    {
        ConfirmingPin();
    }
}
public void button4(View view)
{
    if(counter < 3)
    {
        pinconfirm[counter] = 4;
        counter++;
    }
    else
    {
        ConfirmingPin();
    }
}
public void button5(View view)
{
    if(counter < 3)
    {
        pinconfirm[counter] = 5;
        counter++;
    }
    else
    {
        ConfirmingPin();
    }
}
public void button6(View view)
{
    if(counter < 3)
    {
        pinconfirm[counter] = 6;
        counter++;
    }
    else
    {
        ConfirmingPin();
    }
}
public void button7(View view)
{
    if(counter < 3)
    {
        pinconfirm[counter] = 7;
        counter++;
    }
    else
    {
        ConfirmingPin();
    }
}
public void button8(View view)
{
    if(counter < 3)
    {
        pinconfirm[counter] = 8;
        counter++;
    }
    else
    {
        ConfirmingPin();
    }
}
public void button9(View view)
{
    if(counter < 3)
    {
        pinconfirm[counter] = 9;
        counter++;
    }
    else
    {
        ConfirmingPin();
    }
}
public void button0(View view)
{
    if(counter < 3)
    {
        pinconfirm[counter] = 9;
        counter++;
    }
    else
    {
        ConfirmingPin();
    }
}

public void ConfirmingPin()
{

    /*for(int i = 0; i < 4; i++)
    {
        if(pinconfirm[i] != pin[i])
        {
            TextView ConfirmPin = (TextView) findViewById(R.id.ConfirmPin);
            ConfirmPin.setText("Pins Do Not Match!!!!");

            startActivity(new Intent("com.example.textsmslock.ConfirmPin"));
        }*/
        if(pinconfirm.equals((pin))) == true)
        {
            TextView ConfirmPin = (TextView) findViewById(R.id.ConfirmPin);
            ConfirmPin.setText("Pin Confirmed");
            startActivity(new Intent("com.example.textsmslock.PinComfirmation"));
        }
        else
        {
            TextView ConfirmPin = (TextView) findViewById(R.id.ConfirmPin);
            ConfirmPin.setText("Pins Do Not Match!!!!");

            startActivity(new Intent("com.example.textsmslock.ConfirmPin"));

        }

}
} 
```

这就是我最初尝试仅使用数组的方式

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:57:06.307

对我来说，这听起来像 SharedPreferences 是你正在寻找的。它是一种用于存储数据的轻量级功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:01:57.210

它需要是一个数组吗？

如果它只是一个字符串，你所需要的只是传递你的值：

```
//EnterPinActivity
Intent intent=new Intent(EnterPinActivity.this, ConfirmPinActivity.class);
intent.putExtra("pin", stringWithYourPinCode);
startActivity(intent);

//and then, in your ConfirmPinActivity
Intent intent=getIntent();
String yourPin=intent.getStringExtra("pin"); 
```

如果它绝对必须是一个数组，您仍然可以使用相同的`putExtra()`方法按照您的意图传递它。

我的观点是，通过将数据附加到 Intent 在两个活动之间传递数据比使用文件或 SharedPreferences（还包括文件 I/O 操作）更好（更快、更高效）。

# ios - info.plist 文件中没有方向，会被拒绝吗？

> ID：13482758
> 
> 赞同：0
> 
> 时间：2012-11-20T21:46:20.263
> 
> 标签：ios

6 天前我已经发送了我的第一个应用程序（iPhone 的 iOS 应用程序），它仍在等待敌人的审查。我认识到在 info.plist 文件中没有选择支持的界面方向。我忘了选择其中之一。是拒绝的原因吗？此外，从技术上讲，该应用程序仅使用纵向 UIO，但我已经使用 UIDeviceOrientation 手动实现了方向（例如某些单词向右转 90 度或向左转），这会不会是一个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:54:29.033

我非常怀疑您的应用会因为如此微不足道的事情而被拒绝。选择支持的方向只是额外的元数据，不会影响应用的功能。有关更多信息，请参阅此帖子：

[Xcode 4 支持的设备方向](https://stackoverflow.com/questions/6030647/xcode-4-supported-device-orientations)

话虽如此，苹果可以为所欲为。如果它让您感到困扰，您可以随时拒绝自己的二进制文件并重新提交更改。这可能会使您排在审查的最后，如果您最近提交了它，这并不重要。

# oracle - ORACLE：比较两个值 PL/SQL

> ID：13482759
> 
> 赞同：0
> 
> 时间：2012-11-20T21:46:21.943
> 
> 标签：oracle

嗨，我有以下脚本

```
CREATE OR REPLACE TRIGGER DOUBLE_BOOKINGS
BEFORE INSERT OR UPDATE ON BOOKING_SESSION
FOR EACH ROW
DECLARE
    session_date TIMESTAMP;
    session_room NUMBER;
BEGIN
    SELECT start_session
        INTO session_date --- EXISTING SESSION
        FROM booking_session
    WHERE bk_room = :NEW.bk_room;
    IF session_date = :NEW.start_session THEN
    RAISE_APPLICATION_ERROR
    (-1000, 'Room is already booked');
    END IF;
END;
/ 
```

该脚本假设将任何新预订与同一房间和同一日期的现有预订相匹配（以停止重复预订）

但是它不能正常工作。

```
SQL> INSERT INTO BOOKING_SESSION VALUES (45,TO_TIMESTAMP('18/03/2012 10:00', '
INSERT INTO BOOKING_SESSION VALUES (45,TO_TIMESTAMP('18/03/2012 10:00', 'DD/MM
            *
ERROR at line 1:
ORA-04098: trigger 'U1146815.ROOM_BOOKED' is invalid and failed re-validation 
```

这`start_session`是我存储预订日期和时间的数据库列名称，并且是时间戳。是`booking_session`保存预订的名称，`bk_room`包含房间号。

因此，在提交预订之前，我试图将`new`预订日期与同一房间的旧预订日期相匹配，然后显示错误消息。

更新

新错误，似乎返回了太多行我怎么能一次做一个。

```
ERROR at line 1:
ORA-01422: exact fetch returns more than requested number of rows
ORA-06512: at "U1146815.DOUBLE_BOOKINGS", line 5
ORA-04088: error during execution of trigger 'U1146815.DOUBLE_BOOKINGS' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T04:24:08.480

如果您`SELECT...INTO`在代码中使用，则选择必须返回准确的一行。在其他情况下，它会抛出 NO_DATA_FOUND 异常或 TOO_MANY_ROWS （您的情况）。您可以捕获这些异常，但它会使代码不清楚。更好地使用游标来查询您的记录。

尝试这个

```
CREATE OR REPLACE TRIGGER DOUBLE_BOOKINGS
BEFORE INSERT OR UPDATE ON BOOKING_SESSION
FOR EACH ROW
DECLARE
    session_date TIMESTAMP;
    session_room NUMBER;
    CURSOR c_existing IS
        SELECT start_session
            FROM booking_session
        WHERE bk_room = :NEW.bk_room and
              session_date = :NEW.start_session;
    dummy_session c_existing.start_session%TYPE;
BEGIN
    OPEN c_existing;
    FETCH c_existing INTO dummy_session;
    IF c_existing%FOUND THEN
       CLOSE c_existing;
       RAISE_APPLICATION_ERROR
          (-1000, 'Room is already booked');
    END IF;
    CLOSE c_existing;
END; 
```

/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:50:57.210

您显然`ROOM_BOOKED`在`BOOKING_SESSION`桌子上调用了另一个触发器。并且该触发器处于无效（未编译）状态。

如果您只是想防止具有重复 bk_room/start_session 值的记录，只需向表中添加唯一约束：

```
ALTER TABLE booking_session
add CONSTRAINT my_constraint UNIQUE (bk_room, start_session); 
```

编辑：您的新错误是因为您在表中有多个具有相同 bk_room 值的记录，这是可以预期的。但是，正如我上面所说，您不需要触发器来防止重复，只需一个独特的约束。

# import - 使用 MSBuild 生成目标，然后在同一会话中导入它们

> ID：13482762
> 
> 赞同：0
> 
> 时间：2012-11-20T21:46:42.690
> 
> 标签：import, msbuild

我有一个 MSBuild 项目文件，它生成一些自己的目标，然后导入它们。它工作得很好，除了`msbuild`必须运行两次才能进行构建——一次生成规则，再次让它们可见以完成构建。（逻辑是从一个`Makefile`本身只需要一次运行的。）

是否可以运行生成目标，然后*运行* *生成*的目标之一？`Import`

 *以下清单是实际用例的简化版本，它表现出相同的行为。（除此之外，实际案例从模式的文件名列表生成目标`*-to-*.xsl`，使用名称自动确定依赖关系和目标。）

目标是`msbuild /t:SecondTarget`在第一次尝试时完成工作，而不是要求第二次。

```
<Project
  xmlns="http://schemas.microsoft.com/developer/msbuild/2003"
  InitialTargets="AdditionalTargets"
  ToolsVersion="4.0">

  <!--
    A trivial target-generating task. Presume something more useful for
    the actual case.
  -->
  <UsingTask
    TaskName="GenerateAdditionalTargets"
    TaskFactory="CodeTaskFactory"
    AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.v4.0.dll">
    <ParameterGroup>
      <Result ParameterType="System.String" Output="true"/>
    </ParameterGroup>
    <Task>
      <Reference Include="System.Xml"/>
      <Reference Include="System.Xml.Linq"/>
      <Using Namespace="System"/>
      <Using Namespace="System.Xml.Linq"/>
      <Code Type="Fragment" Language="cs"><![CDATA[
          var ns = XNamespace.Get("http://schemas.microsoft.com/developer/msbuild/2003");

          var collected = new XElement(ns + "Project",
            new XAttribute("ToolsVersion", "4.0"),
            new XElement(ns + "Target",
              new XAttribute("Name", "SecondTarget"),
              new XElement(ns + "Message",
                new XAttribute("Text", "1.21GW?!")
              )
            )
          );

          Result = collected.ToString(SaveOptions.DisableFormatting);
        ]]></Code>
    </Task>
  </UsingTask>

  <PropertyGroup>
    <AdditionalTargets>additional.targets</AdditionalTargets>
  </PropertyGroup>

  <Target Name="AdditionalTargets">
    <GenerateAdditionalTargets>
      <Output TaskParameter="Result" PropertyName="Targets"/>
    </GenerateAdditionalTargets>
    <WriteLinesToFile File="$(AdditionalTargets)" Lines="$(Targets)" Overwrite="true"/>
  </Target>

  <Import Project="$(AdditionalTargets)" Condition="Exists('$(AdditionalTargets)')"/>
</Project> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T04:50:26.973

我不认为这是可能的。根据设计，在调用任务时它没有项目的整个上下文。它只是传递给它的东西。它是这样设计的（*至少有一个原因*），因此任务调用不会产生难以识别的不可预见的后果。*

# python - 当我使用 python 请求检查一个站点时，如果该站点将我重定向到另一个页面，我会知道吗？

> ID：13482777
> 
> 赞同：18
> 
> 时间：2012-11-20T21:47:44.573
> 
> 标签：python, httplib, python-requests

我的意思是，如果我访问“www.yahoo.com/thispage”，而 yahoo 已经设置了一个过滤器来将 /thispage 重定向到 /thatpage。因此，无论何时有人访问/thispage，他/她都会登陆/thatpage。

如果我使用 httplib/requests/urllib，它会知道有重定向吗？什么错误页面？某些站点在找不到页面时将用户重定向到 /errorpage。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-20T22:03:39.620

使用，您可以在响应对象`requests`的属性中获得所有重定向的列表。`.history`它返回一个 Python 列表。有关更多信息，请参阅[文档](http://docs.python-requests.org/en/latest/user/quickstart/#redirection-and-history)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-11-20T22:06:57.460

要防止请求跟随重定向，请使用：

`r = requests.get('http://www.yahoo.com/thispage', allow_redirects=False)`

如果它确实在重定向中，您可以在 r.headers['location'] 中检查重定向目标位置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-25T04:44:27.910

接受的答案是正确的第一个选项，但在某些情况下，如果网站使用元标记重定向，他们还会在重定向后指定规范链接。在此示例中，让我尝试从 wikipedia 请求[http://en.wikipedia.org/wiki/Google_Inc_Class_A](http://en.wikipedia.org/wiki/Google_Inc_Class_A)，这是一个重定向的 url。

```
>> request = requests.get('http://en.wikipedia.org/wiki/Google_Inc_Class_A') 
```

我检查并：

```
>> request.history
[] 
```

另一种方法是尝试提取规范的 url，希望它包含您被重定向到的内容。（注意我在这里也使用 BeautifulSoup）

```
>> soup = BeautifulSoup(request._content)
>> canonical = soup.find('link', {'rel': 'canonical'})
>> canonical['href']
'http://en.wikipedia.org/wiki/Google' 
```

在这种特殊情况下，它与您重定向到的 url 匹配。所以要清楚，这是一个丑陋的第二个选择，但如果一切都失败了，值得尝试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T22:05:51.240

这取决于他们如何进行重定向。“正确”的方式是返回一个重定向的 HTTP 状态码（301/302/303）。“错误”的方法是在 HTML 中放置一个刷新元标记。

如果他们做前者，`requests`将透明地处理它。请注意，任何正常的错误页面重定向仍然会有错误状态代码（例如 404），您可以将其检查为`response.status_code`.

# windows-8 - 从 VS 创建 Windows 8 应用程序包失败

> ID：13482779
> 
> 赞同：0
> 
> 时间：2012-11-20T21:47:49.587
> 
> 标签：windows-8

我刚刚完成了我的第一个 Windows 8 应用程序，我想构建包以将它们上传到商店。

在 VS 2012 中，您可以在 Project -> Store -> Create App packages... 下找到它。

问题是，在创建所有包之后，认证工具运行并且它失败了。

唯一的失败点是“性能暂停”。它说我的应用程序没有正确挂起，这是一个问题。

我在我的开发 PC x64 上运行了认证工具，结果是所有内容都“通过”。

我认为这与 ARM 包有关。在 Surface 平板电脑上进行测试时，我看到当我进入开始屏幕时应用程序没有暂停。

我知道暂停在 x86、x64 上工作正常，我什至在 ARM 上对其进行了测试（关闭应用程序）。

当应用程序不专注于 ARM 设备时，您是否知道为什么会出现暂停问题？有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:48:40.517

如果我正确理解了您的问题，那么看起来这是一个仅在 ARM 上出现的性能问题（如果您在开发 PC x64 机器上的 WACK 上获得“通过”）。向 Windows 应用商店提交应用时有性能要求；查看[此博客文章](http://blogs.msdn.com/b/jennifer/archive/2012/11/14/common-windows-store-certification-errors-3-8-app-must-meet-the-basic-performance-criteria-on-a-low-power-computer.aspx)了解详细信息。

我认为您有 2 个选择： 1\. 仅针对 x86 和 x64 处理器（不是 ARM）将您的应用程序提交到 Windows 应用商店。
2\. 优化你的suspend事件中的代码，让它运行得更快，满足ARM上的要求。这是一篇关于[如何在 C# 中最小化暂停时间](http://msdn.microsoft.com/en-us/library/windows/apps/hh994640.aspx)的文章。

还有一件事：为了测试挂起，我发现我不仅需要从我当前运行的应用程序中切换出来，而且还需要转到一个新的 Windows 应用商店应用程序来强制第一个进入挂起模式（只需进入桌面，对于例如，并不总是这样做）。要查看您的应用程序是否真的被暂停，您可以打开任务管理器。在“查看”下的菜单栏中，选择“状态值”，然后选择“显示暂停状态”。然后您应该能够在任务管理器中看到哪些应用程序被暂停。

# android - Android onUpgrade 数据库导致 IllegalStateException

> ID：13482781
> 
> 赞同：1
> 
> 时间：2012-11-20T21:48:03.457
> 
> 标签：android

在我的`dbHelper`：

```
onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) 
```

功能我将一张表保存到外部数据库。

因此我

1.  附加并复制到外部数据库
2.  删除此函数中的 db 文件并从外部复制
3.  从外部数据库恢复到数据库。

这一直有效，直到函数返回 getWritableDatabase()

在这里，我得到了这个例外：

```
java.lang.IllegalStateException: no transaction pending 
```

怎么了？谢谢塔塔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:01:06.150

问题是`onUpgrade`方法（以及`onCreate`）发生在事务中，最后将事务设置为成功并结束它。

但是，您已经在 中结束了事务`onUpgrade`，导致出现此错误。

相关代码来自`SQLiteOpenHelper`：

```
 ...
        if (version != mNewVersion) {
            db.beginTransaction();
            try {
                if (version == 0) {
                    onCreate(db);
                } else {
                    onUpgrade(db, version, mNewVersion);
                }
                db.setVersion(mNewVersion);
                db.setTransactionSuccessful();
            } finally {
                db.endTransaction();
            }
        }
        ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T21:55:44.680

我猜你可能没有先打电话就打`SQLiteDatabase.endTransaction()`进来了。虽然没有看到任何代码有点难以分辨；）`onUpgrade``SQLiteDatabase.beginTransaction()`

# java - Java - 连接到亚马逊

> ID：13482785
> 
> 赞同：2
> 
> 时间：2012-11-20T21:48:10.383
> 
> 标签：java, networking, httpurlconnection, urlconnection

我正在使用以下代码尝试通过 Amazon 连接到 associates 程序：

```
 public static Session login(final Account account) throws IOException{
    final HashMap<String, String> info = new HashMap<String, String>();
    final URL url = new URL("https://affiliate-program.amazon.com/");
    final HttpURLConnection connection = (HttpURLConnection)(account.isProxySet() ? url.openConnection(account.getProxy()) : url.openConnection());
    connection.setUseCaches(false);
    connection.setDoOutput(true);
    connection.setDoInput(true);
    connection.setReadTimeout(timeout);
    connection.setConnectTimeout(timeout);
    connection.setRequestMethod("POST");
    connection.addRequestProperty("User-Agent", account.getUserAgent());
    connection.addRequestProperty("User-Content", "text/plain");
    connection.setAllowUserInteraction(true);
    final BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(connection.getOutputStream()));
    final Scanner reader = new Scanner(connection.getInputStream());
    while(reader.hasNextLine()){
        final String line = reader.nextLine().trim();
        if(line.contains("<input type=\"hidden\"")){
            final String[] split = line.split("\"");
            info.put(split[3], split[5]);
        }
    }
    String writable = "";
    final Iterator<String> iterator = info.keySet().iterator();
    while(iterator.hasNext()){
        final String key = iterator.next();
        writable += String.format("%s=%s", URLEncoder.encode(key, "UTF-8"), URLEncoder.encode(info.get(key), "UTF-8"));
        if(iterator.hasNext()) writable += "&";
    }
    final String data = String.format("%s&email=%s&password=%s&submit=Sign In", writable, URLEncoder.encode(account.getEmail(), "UTF-8"), URLEncoder.encode(account.getPass(), "UTF-8"));
    System.out.println(data);
    writer.write(data);
    writer.flush();
    writer.close();
    connection.getInputStream().read();
    System.out.println(connection.getURL().toString());
    return new Session(account);
} 
```

课程 Session 和 Account 都是我的，但它与我的问题无关。所以基本上我正在尝试连接到亚马逊网站，但我遇到了问题。每当它打印出它实际写入的数据时，它似乎看起来就像它在网页源内部的样子（用它们的关联值编写正确的名称）。但是，当它打印出新 URL 时，它与旧 URL 相同。

我想我确实知道原因；看来您在写入之前无法阅读（这就是为什么我在初始化 Scanner 之前初始化 BufferedWriter 因为如果我没有，它会告诉我阅读后我无法写入并抛出 IOException）基本上如果你查看该站点的页面源，您会看到一个名为“sessionId”的 id，每次打开新连接时它都会更改。

所以我只能得出结论，唯一的解决方案是在写作之前找出某种方式来阅读，这样会话ID就不会改变。我得出这个结论是因为每次我创建一个新连接并打印出我正在写入的数据（在它被编码之前），会话 ID 都是不同的。有人对如何做到这一点有任何想法吗？任何想法将不胜感激。谢谢。

编辑：根据 ruakh 的回答修改了代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:02:17.867

一个问题是：

```
 writer.write(URLEncoder.encode(data, "UTF-8")); 
```

将用 URL 转义符替换所有 & 和等号，所以不要发布这样的内容：

```
a=b&c=d&e=f 
```

你发布这样的东西：

```
a%3Db%26c%3Dd%26e%3Df 
```

这实际上是垃圾。

您需要分别对各个组件执行 URL 编码，*然后*`=`使用和组合结果`&`。

# objective-c - 从 Xib 设置 UISearchBar 不会在 iOS 5 上显示搜索栏

> ID：13482787
> 
> 赞同：2
> 
> 时间：2012-11-20T21:48:32.023
> 
> 标签：objective-c, ios, uitableview, ios5, uisearchbar

上下文：Xcode 4.5.2，Interface Builder，禁用自动布局

当 UISearchBar 添加为 UITableViewController 的子项时，搜索栏在 iOS 6 上正常显示，但在 iOS 5 上完全不显示。以下错误报告描述了该问题：

[http://openradar.appspot.com/12707740](http://openradar.appspot.com/12707740)

任何人都可以为此提出解决方法吗？

*Interface Builder 中的对象层次结构：*
![Interface Builder 中的对象层次结构](../Images/6f0f83ed3aad6c12c0d63f488c8ca05c.png)

*界面生成器中的外观：*
![Interface Builder 中的外观](../Images/5a20d5a482b095f3928a30acc829856b.png)

*iPhone 6 模拟器中的外观：*
![iPhone 6 模拟器中的外观](../Images/7abd6b6701e992e7dbd6f02dfaf8c595.png)

*iPhone 5.1 模拟器中的外观：*
![iPhone 5.1 模拟器中的外观](../Images/e3fe6d91e177cef32beb043181542b2f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T21:40:48.737

创建 UITableViewController 对象时，必须使用 nib 文件名对其进行初始化：

```
 TableViewControllerObject *tableViewControllerObject = [[TableViewControllerObject alloc]initWithNibName:@"TableViewControllerObject" bundle:nil]; 
```

# json - JSON、Jackson 和多行字符串

> ID：13482795
> 
> 赞同：5
> 
> 时间：2012-11-20T21:48:58.907
> 
> 标签：json, string, jackson

我有以下 JSON。

```
{ "content" : "value" } 
```

我让杰克逊构建 JSON 字符串。

如果值是多行文本，例如：

```
A
B
C 
```

我看到的是：`{ "content" : "A\r\nB\r\nC" }`

`\r\n`它为每一行显式设置(CRLF)。

我想知道我是否可以将杰克逊配置为输出：

```
{ "content" : "A
B
C" } 
```

这是; A、B 和 C 被呈现为 3 行，而不是在 1 行中呈现为“A\r\nB\r\nC”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T05:53:58.120

如果我理解正确，你想知道杰克逊为什么会逃避换行符。如果是这样，答案可以在[这里](http://www.ietf.org/rfc/rfc4627.txt)找到。

# c# - 从独立应用程序执行编码的 UI 测试

> ID：13482796
> 
> 赞同：5
> 
> 时间：2012-11-20T21:49:00.277
> 
> 标签：c#, coded-ui-tests

我发现了几篇关于如何使用 mstest 实用程序执行代码 UI 测试的博客文章，但我需要从我的 C# 应用程序中执行它们。我尝试了最简单的事情：我创建了一个控制台应用程序，添加了对

*   Microsoft.VisualStudio.TestTools.UITest.Logging.dll
*   Microsoft.VisualStudio.TestTools.UITest.Playback.dll
*   Microsoft.VisualStudio.TestTools.UITesting.dll

我尝试从我的应用程序中调用 UI 测试方法。我收到以下错误：

```
The following is not a valid technology name: MSAA. To search for a control, you must specify a valid technology name. 
```

我尝试引用与 UI 测试相关的其他程序集，但错误保持不变。也许我应该在 App.config 中添加一些东西才能运行测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-07T09:18:20.737

我正在使用 bat 文件执行编码的 UI 测试，您只需将 CUIT 测试 .dll 文件复制到您的应用程序并通过 bat 文件调用它即可执行。甚至您也可以使用测试代理从没有 Visual Studio 的不同机器上运行代码 UI 测试。

我的 bat 文件如下所示：

从 DLL 运行所有测试方法：

```
 "C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\mstest.exe" /testcontainer:"DLL_Location\CUIT_03.dll" /resultsfile:"ResultFile_Location\result.trx" 
```

从 DLL 运行单一测试方法：

```
 "C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\mstest.exe" /testcontainer:"DLL_Location\CUIT_03.dll" /test:"TestMethodName" /resultsfile:"ResultFile_Location\result.trx" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-16T17:58:33.193

您需要在执行编码的 UI 部分之前调用 Playback.Initialize()，然后再调用 Playback.Cleanup()。

[http://social.msdn.microsoft.com/forums/wpapps/zh-cn/914e0ecb-6917-43ff-baf6-f30acc6469d3/unable-to-run-a-coded-ui-test-method-when-call-来自-a-console-application-project-in-vs2012](http://social.msdn.microsoft.com/forums/wpapps/zh-cn/914e0ecb-6917-43ff-baf6-f30acc6469d3/unable-to-run-a-coded-ui-test-method-when-called-from-a-console-application-project-in-vs2012)

[http://blogs.microsoft.co.il/blogs/shair/archive/2010/07/15/running-codedui-test-from-another-application.aspx](http://blogs.microsoft.co.il/blogs/shair/archive/2010/07/15/running-codedui-test-from-another-application.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-20T14:53:15.047

在 C# 中使用 MSTest 运行时，我遇到了类似的问题。我正在使用 Selenium，所以我用 [TestClass] 属性标记了我的基类。我需要 CodedUI 来测试文件上传。当我将其更改为 [CodedUITest] 时，它起作用了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T01:48:34.480

如果你从 C# 调用 MSTest，你会解决你的问题吗？如果是这样，这篇[MSDN 帖子会告诉您如何](http://social.msdn.microsoft.com/Forums/en-US/vststest/thread/133cc2fc-78bf-477a-9ebb-4cd127846d85).

否则，我会尝试在 MSTest 中使用反汇编程序来找出它的作用以及它使用的引用。快速浏览一下，我发现了 Microsoft.VisualStudio.QualityTools.ExecutionCommon 以及 Microsoft.VisualStudio.QualityTools.CommandLine 中一个名为 Executor 的类。

请问，为什么需要从 C# 调用 CUIT？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-11T06:26:04.943

我相信你遗漏了一些参考资料，试试这个博客，这是你需要的所有参考资料：

```
c:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\PublicAssemblies\

Microsoft.VisualStudio.TestTools.UITesting.dll
Microsoft.VisualStudio.QualityTools.CodedUITestFramework.dll

C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\PrivateAssemblies\image

Microsoft.VisualStudio.TestTools.UITest.CodeGeneration.dll
Microsoft.VisualStudio.TestTools.UITest.Framework.dll
Microsoft.VisualStudio.TestTools.UITest.Playback.dll 
```

试试这个博客：http: [//blogs.microsoft.co.il/shair/2010/07/15/running-codedui-test-from-another-application/](http://Try%20this%20blog%20post)

它列出了您需要的所有参考文献（尝试过，它适用于 winforms（MSAA））。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-15T11:11:21.143

检查您的应用程序是否作为 32 进程运行，因为编码的 UI 不适用于 64 位进程并且不能在其中使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-14T09:03:41.957

嗨它在我的情况下工作：使用下面的代码==>

```
Playback.Initialize();
CockpitAutomate.CockpitAutomate c = new CockpitAutomate.CockpitAutomate();
c.RunCockpit();
Playback.Cleanup(); 
```

# opencv - 在 OpenCV 中进行校准的目的是什么？

> ID：13482797
> 
> 赞同：2
> 
> 时间：2012-11-20T21:49:01.683
> 
> 标签：opencv, robotics, camera-calibration, calibration

我正在开始一个新的机器人项目（带摄像头），所以我需要校准它的两个摄像头。

我的问题是：为什么我需要校准相机？它与定义物体尺寸和到相机的距离有什么关系吗？

任何信息都可能会有所帮助。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-01-27T13:15:38.457

相机校准（以及更普遍的）仪器校准对于您想要该设备的几乎任何应用程序来说都是必不可少的先前步骤。

例如，假设您有一个相机。在这种情况下，您必须对其内在参数（焦距、主点、偏斜系数）进行校准（即计算其值）。您可以使用校准板（例如[Checkerboard](https://en.wikipedia.org/wiki/Chessboard_detection)、[AprilTag](https://april.eecs.umich.edu/wiki/AprilTags)）来做到这一点。

现在，您可能会说这些参数是该相机的制造商已知和报告的，我们可以在手册或相应的文档中查找它们。然而，情况并非总是如此：

*   制造商可能会向您提供该校准信息。即使他们这样做了，这些数字也可能是粗略的，因此它们适用于整个产品系列。也就是说，他们可能不会校准每一个相机。您可以使用这些校准参数，但如果您想要更高的精度，最好将它们用作粗略估计并自己进行校准。

*   设备可能会受到环境及其运行的整体条件（温度、湿度等）的影响。例如，假设您有一台立体相机。在这种情况下，您将校准两个独立 RGB 相机之间的长度。但是该长度可能会根据温度而变化（加热会使相机之间的刚性连接膨胀）。

*   设备的规格可能会根据其使用年限和使用情况发生变化，因此每 N 年重新计算一次校准参数是有意义的。

总而言之，一定要自己校准你的相机。你会惊讶于这是多么重要。

请查看以下链接以获取更多信息：

*   [https://www.cv-foundation.org/openaccess/content_cvpr_2013/papers/Oth_Rolling_Shutter_Camera_2013_CVPR_paper.pdf](https://www.cv-foundation.org/openaccess/content_cvpr_2013/papers/Oth_Rolling_Shutter_Camera_2013_CVPR_paper.pdf)

*   [https://uk.mathworks.com/help/vision/ug/camera-calibration.html](https://uk.mathworks.com/help/vision/ug/camera-calibration.html)

*   [https://www.measurement.govt.nz/services/temperature-and-humanity/humidity-calibration-service/calibration-certificate/ purpose-of-a-](https://www.measurement.govt.nz/services/temperature-and-humidity/humidity-calibration-service/calibration-certificate/purpose-of-a-)

*   [http://www.npl.co.uk/reference/faqs/should-i-have-my-instrument-calibrated-and,-if-so,-how-often-(faq-force)](http://www.npl.co.uk/reference/faqs/should-i-have-my-instrument-calibrated-and,-if-so,-how-often-(faq-force))

# openid - 为什么 Janrain 的 Engage 示例仅适用于 IE？

> ID：13482798
> 
> 赞同：0
> 
> 时间：2012-11-20T21:49:06.340
> 
> 标签：openid, janrain

首先，让我以我对 OpenID 完全陌生且对 PHP 不是很熟悉的事实作为开头。

我在我的网站 (Apache/PHP) 上设置了 Janrain 的 Engage 示例，包括头部的 JavaScript：

```
(function() {

   if (typeof window.janrain !== 'object') {
      window.janrain = {};
   }
   if (typeof window.janrain.settings !== 'object') {
      window.janrain.settings = {};
   }

   janrain.settings.tokenUrl = 'http://mydomain.com/tokenform.php';

   function isReady() {
      janrain.ready = true;
   };

   if (document.addEventListener) {
      document.addEventListener("DOMContentLoaded", isReady, false);
   } else {
      window.attachEvent('onload', isReady);
   }

   var e = document.createElement('script');
   e.type = 'text/javascript';
   e.id = 'janrainAuthWidget';

   if (document.location.protocol === 'https:') {
      e.src = 'https://rpxnow.com/js/lib/myapp/engage.js';
   } else {
      e.src = 'http://widget-cdn.rpxnow.com/js/lib/myapp/engage.js';
   }

   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(e, s);

})(); 
```

我添加了他们的 DIV 标签：

```
<div id="janrainEngageEmbed"></div> 
```

我根据他们的指示构建了以下令牌收据页面：

```
<?php

header('Content-Type: text/html; charset=utf-8');

?>
<html>
   <head>
      <title>Janrain Engage example</title>
   </head>
   <body>
      <pre>
<?php

$rpx_api_key = file_get_contents('/path/apikey.txt');

/* STEP 1: Extract token POST parameter */
$token = $_POST['token'];

echo "SERVER VARIABLES:\n";
var_dump($_SERVER);
echo "HTTP POST ARRAY:\n";
var_dump($_POST);

// test the length of the token; it should be 40 characters
if (strlen($token) == 40) {

   /* STEP 2: Use the token to make the auth_info API call */
   $post_data = array('token'  => $token,
                     'apiKey' => $rpx_api_key,
                     'format' => 'json',
                     'extended' => 'false');

   $curl = curl_init();
   curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
   curl_setopt($curl, CURLOPT_URL, 'https://rpxnow.com/api/v2/auth_info');
   curl_setopt($curl, CURLOPT_POST, true);
   curl_setopt($curl, CURLOPT_POSTFIELDS, $post_data);
   curl_setopt($curl, CURLOPT_HEADER, false);
   curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);
   curl_setopt($curl, CURLOPT_FAILONERROR, true);
   $result = curl_exec($curl);
   if ($result == false){
      echo "\n".'Curl error: ' . curl_error($curl);
      echo "\n".'HTTP code: ' . curl_errno($curl);
      echo "\n"; var_dump($post_data);
   }
   curl_close($curl);

   /* STEP 3: Parse the JSON auth_info response */
   $auth_info = json_decode($result, true);

   if ($auth_info['stat'] == 'ok') {

      echo "\n You're in!";
      echo "\n auth_info:";
      echo "\n"; var_dump($auth_info);

      /* STEP 4: Use the identifier as the unique key to sign the user into your system.
         This will depend on your website implementation, and you should add your own
         code here. The user profile is in $auth_info.
      */

   } else {
      // Gracefully handle auth_info error.  Hook this into your native error handling system.
      echo "\n".'An error occured: ' . $auth_info['err']['msg']."\n";
      var_dump($auth_info);
      echo "\n";
      var_dump($result);
   }
} else {
   // Gracefully handle the missing or malformed token.  Hook this into your native error handling system.
   echo 'Authentication canceled.';
}

?>
      </pre>
   </body>
</html> 
```

我的小部件接受来自 Google、Facebook、Twitter、Yahoo、LinkedIn 和 Windows Live 的登录。只要我使用 IE，一切都像宣传的那样工作。如果我尝试使用 Firefox 或 Chrome 的任何提供程序，我似乎已通过身份验证，登录对话框消失，但我被困在带有 Open ID 提供程序选择小部件的页面上。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T13:50:37.037

事实证明，Janrain 似乎依赖 3rd 方 cookie 来使他们的机制工作。虽然它可能记录在某个地方，但即使经过数小时的查找，我也没有找到它。

在 Firefox 中，工具、选项、隐私和检查 3rd Party cookie 允许 Janrain 示例开始工作。

在 Chrome 中，程序是：chrome://chrome/settings/，显示高级设置，内容设置，取消选中“阻止第三方 cookie 和站点数据”。

无论阻止第三方 Cookie 设置如何，Janrain 示例都继续在 IE9 中工作。我对 iOS 上的 Safari 也有同样的体验。（它被设置为仅接受来自访问过的网站的 cookie。）

# c++ - 套接字中的页面对齐发送缓冲区

> ID：13482799
> 
> 赞同：0
> 
> 时间：2012-11-20T21:49:08.367
> 
> 标签：c++, tcp

在 64 位 linux 上，我的应用程序发送大小可变且未在 64 位边界上对齐的二进制消息。例如，它可能发送 1026bytes、85bytes 等等。在这种情况下，让页面对齐的套接字发送和接收缓冲区大小是否有帮助或伤害或无关紧要？该应用程序是用 c 编写的，并在 rhel 6.3x 上运行，内核为 2.6.32.x86_64。

更新：

缓冲区，我最初指的是由 setsockopt 设置的 SO_SNDBUF 和 SO_RCVBUF。但是根据 David 的评论，我想包括在 PAGESIZE 边界上创建用于 send 和 recv 调用的应用程序缓冲区的可能性。这会有所帮助，伤害还是无关紧要？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:07:56.707

对于所有应用目的，这无关紧要：

*   内核缓冲区由操作系统管理，实际上会自动舍入/限制为某些页面的倍数。
*   用户级缓冲区可以进行页面对齐，以实现更快的用户内核复制，但我敢打赌你不会注意到差异。

另一方面，如果您从说文件到套接字进行大量缓冲区处理，请查看[`sendfile(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/sendfile.2.html)and [`splice(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/splice.2.html)，这在您的应用程序上下文中可能有意义，也可能没有意义。

# python - Python Google App Engine：如何将 SearchResults 数据移动到我的模板中

> ID：13482802
> 
> 赞同：1
> 
> 时间：2012-11-20T21:49:15.553
> 
> 标签：python, google-app-engine

我正在完成一个项目，但在谷歌应用引擎上使用 python 时遇到了障碍。我有一个保存笔记条目的应用程序。我希望能够搜索这些条目，并且我正在使用此链接：

[https://developers.google.com/appengine/docs/python/search/overview](https://developers.google.com/appengine/docs/python/search/overview)

我能够保存文档、搜索它们、删除它们等。一切正常，但我看不到有关如何将 SearchResults 解析为模板的任何信息。

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:06:33.327

最简单的方法是使用实​​体键作为搜索文档的键。

```
doc = search.Document(doc_id=<entity_key_as_string>, fields=fields) 
```

然后进行搜索查询并仅返回实体键：

```
options = search.QueryOptions(ids_only=True)
query   = search.Query(query_string=query_string, options=options) 
```

然后从数据存储中获取实体并渲染模板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T02:26:24.003

除非我有误解，否则您是否将数据存储实体与搜索文档相关联似乎是正交的（尽管这通常很有用）。您不需要实体来呈现模板中的文档信息。

您可以按照以下方式访问模板中的文档字段：

```
 {% for field in doc.fields %}
      {{field.name}}&nbsp;{{field.value}} <br/>
  {% endfor %} 
```

或者使用 jinja2，获取一个特定的字段值，如下所示：

```
{{doc.field("yourfieldname").value}} 
```

# java - c3p0 getConnection() 抛出异常：ResourcePool 无法从其主工厂或源获取资源

> ID：13482803
> 
> 赞同：12
> 
> 时间：2012-11-20T21:49:21.980
> 
> 标签：java, mysql, jdbc, connection-pooling, c3p0

我们的项目有一个 [Hibernate + c3p0 + MySQL] 配置。我们遇到了以下异常：

```
com.mchange.v2.resourcepool.CannotAcquireResourceException: A ResourcePool could not acquire a resource from its primary factory or source.
    at com.mchange.v2.resourcepool.BasicResourcePool.awaitAvailable(BasicResourcePool.java:1319) ~[c3p0-0.9.1.2.jar:0.9.1.2]
    at com.mchange.v2.resourcepool.BasicResourcePool.prelimCheckoutResource(BasicResourcePool.java:557) ~[c3p0-0.9.1.2.jar:0.9.1.2]
    at com.mchange.v2.resourcepool.BasicResourcePool.checkoutResource(BasicResourcePool.java:477) ~[c3p0-0.9.1.2.jar:0.9.1.2]
    at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:525) ~[c3p0-0.9.1.2.jar:0.9.1.2]
Wrapped by: java.sql.SQLException: Connections could not be acquired from the underlying database!
    at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:106) ~[c3p0-0.9.1.2.jar:0.9.1.2]
    at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:529) ~[c3p0-0.9.1.2.jar:0.9.1.2]
    at com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:128) ~[c3p0-0.9.1.2.jar:0.9.1.2]
    at org.hibernate.service.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:141) ~[hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.hibernate.internal.AbstractSessionImpl$NonContextualJdbcConnectionAccess.obtainConnection(AbstractSessionImpl.java:276) ~[hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.hibernate.engine.jdbc.internal.LogicalConnectionImpl.obtainConnection(LogicalConnectionImpl.java:297) ~[hibernate-core-4.0.1.Final.jar:4.0.1.Final]
Wrapped by: org.hibernate.exception.GenericJDBCException: Could not open connection
    at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:52) ~[hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:125) ~[hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:110) ~[hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.hibernate.engine.jdbc.internal.LogicalConnectionImpl.obtainConnection(LogicalConnectionImpl.java:304) ~[hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.hibernate.engine.jdbc.internal.LogicalConnectionImpl.getConnection(LogicalConnectionImpl.java:169) ~[hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction.doBegin(JdbcTransaction.java:67) ~[hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.hibernate.engine.transaction.spi.AbstractTransactionImpl.begin(AbstractTransactionImpl.java:160) ~[hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.hibernate.internal.SessionImpl.beginTransaction(SessionImpl.java:1263) ~[hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.springframework.orm.hibernate4.HibernateTransactionManager.doBegin(HibernateTransactionManager.java:399) ~[spring-orm-3.1.2.RELEASE.jar:3.1.2.RELEASE]
Wrapped by: org.springframework.transaction.CannotCreateTransactionException: Could not open Hibernate Session for transaction; nested exception is org.hibernate.exception.GenericJDBCException: Could not open connection
    at org.springframework.orm.hibernate4.HibernateTransactionManager.doBegin(HibernateTransactionManager.java:440) ~[spring-orm-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:371) ~[spring-tx-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:336) ~[spring-tx-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:105) ~[spring-tx-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172) ~[spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202) ~[spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at $Proxy28.messageExists(Unknown Source) ~[na:na] 
```

我们的 c3p0 配置：

```
<bean id="provDataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" destroy-method="close">
…
        <property name="acquireIncrement" value="1" />
        <property name="idleConnectionTestPeriod" value="100"/>
        <property name="minPoolSize" value="5" />
        <property name="maxPoolSize" value="50" />
        <property name="maxIdleTime" value="1800" />
</bean> 
```

请注意，我们还在此 MySQL 实例之上配置了另一个类似的 c3p0 数据源。

谁能给我一些关于如何调试的建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:29:30.107

虽然没有严格回答您的问题，但我不想在评论中添加代码，因为评论中的代码不可读。

这是我项目中带有 C3P0 的 MySQL 示例配置。请注意所有额外参数以确保连接不会中断。（最后我选择了 Postgres，因为它不会杀死我的连接并且通常更稳定，还必须使用 select 1 重新测试连接；效率不高）

```
<bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"
     destroy-method="close">
  <property name="driverClass" value="${jdbc.driverClassName}"/>
  <property name="jdbcUrl" value="${jdbc.url}"/>
  <property name="properties">
    <props>
        <prop key="c3p0.minPoolSize">0</prop>
        <prop key="hc3p0.maxPoolSize">1000</prop>
        <prop key="hc3p0.timeout">3000</prop>
        <prop key="c3p0.acquire_increment">10</prop>
        <prop key="c3p0.max_statement">50</prop>

        <prop key="hibernate.c3p0.idle_test_period">60</prop>
        <prop key="c3p0.preferredTestQuery">SELECT 1;</prop>
        <prop key="hibernate.c3p0.testConnectionOnCheckout">false</prop>
        <prop key="user">${jdbc.username}</prop>
        <prop key="password">${jdbc.password}</prop>
    </props>
  </property>
</bean> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-23T15:29:49.553

我找到了以下帮助我解决问题的原因和解决方案列表。也可能帮助其他人：

1.  **您输入的数据库配置详细信息不正确或已更改**。例如，您的 Confluence 数据库的数据库名称或数据库用户名/密码。确认 /confluence.cfg.xml 中的数据库用户名、密码和连接 URL 不正确，如果不正确，请相应更新。
2.  **数据库的 URL 不正确**。例如，如果数据库连接是 jdbc:mysql://yma/confluence?autoReconnect=true，主机 'yma' 是否存在，数据库服务器是否安装在 'yma' 上？检查 /confluence.cfg.xml 以找到该条目。
3.  **数据库服务器没有运行**。如果您的数据库服务器已关闭，请重新启动它并检查日志以查看它失败或停止的原因。
4.  **网络已关闭**（或 Confluence 与其数据库之间存在防火墙）并且无法建立与数据库的连接。如果您的网络出现故障或安装了新防火墙，请咨询您的系统管理员以进行进一步的故障排除。
5.  **您的数据库密码已过期。**如果您的密码已过期（只有当您尝试通过数据库客户端或 DbVisualizer 等外部数据库工具连接到数据库时才会发现此问题），请更新您的密码。您可能希望停用 Confluence 数据库用户的过期密码，以防止问题再次发生。请务必就此咨询您的 DBA。
6.  **Postgres 特定问题**：迁移或升级 Confluence、环境等时，Postgres 加密方法已更改或更改。请检查 pg_hba.conf 文件。如果方法设置为 ident 将其更改为 md5。
7.  **MySQL 特定问题**：触发 MySQL 服务器的连接请求太多，无法阻止 Confluence 发出任何请求。请参阅此 MySQL 文章以获取解决方案。

来源：[https ://confluence.atlassian.com/confkb/connections-could-not-be-acquired-from-the-underlying-database-104825087.html](https://confluence.atlassian.com/confkb/connections-could-not-be-acquired-from-the-underlying-database-104825087.html)

# c++ - 分叉和管道 C++ 奇怪的输出

> ID：13482811
> 
> 赞同：1
> 
> 时间：2012-11-20T21:49:56.577
> 
> 标签：c++, linux, fork, pipe

我要编写一个包含 2 个命令及其参数（最多 5 个）的作业，它将通过管道将一个命令的输出传递给另一个。然后它将循环，再次询问两个命令，直到输入退出。

我遇到的问题是，在第二个循环中输入值后，会发生奇怪的事情，例如在输入第二个命令后立即输出“输入命令 1”（两者都出现在同一行）。我还注意到例如输入 ls -l 然后 cat 可以工作，但是输入 ls -l 然后 wc 会导致问题。有人介意看看并可能帮助我吗？我整天都在努力，我还有一个多小时的时间来完成它。

旁注：是的，我意识到执行命令设置有点愚蠢，但我没有时间，没有时间摆弄它。有用。

```
#include <iostream>
#include <string>
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <sys/wait.h>
#include <sstream>
using namespace std;

int main(){
//Our imput strings that the user enters.
string input1;
string input2;

//Temporary string.
string s;  

//Array to hold the items passed in.
string arg1[6];
string arg2[6];

//A count of how many items they passed in.
int carg1;
int carg2;

//Loop until quit.
while(true){
    //Set all our values to empty/zero
    carg1 = 0;
    carg2 = 0;
    input1.clear();
    input2.clear();

    //Prompt for first command.
    while(input1.empty()){
        cout << "Command One (or quit): ";
        getline(cin, input1);
    }

    //Split the string by the space to get the pieces of the command.
    istringstream iss1(input1); 
    while (getline(iss1, s, ' ')) {
        arg1[carg1] = s;
        carg1++;
    }

    //Check if command is quit and exit if true.
    if(arg1[0].compare("quit") == 0){
        return 0;
    }

    //Prompt for command 2.
    while(input2.empty()){  
        cout << "Command Two: ";
        cin >> input2;
    }

    //Once again, split based on spaces.
    istringstream iss2(input2); 
    while (getline(iss2, s, ' ')) {
        //arg2.push_front(s);
        arg2[carg2] = s;
        carg2++;
    }

    //Initialize the pipe.
    int pipefd[2];
    if(pipe(pipefd) == -1){
        perror("Pipe");
        exit(EXIT_FAILURE);
    }

    //Create the fork to two processes.
    int pid = fork();

    //Switch to check for parent and child.
    switch(pid){
        case 0: //Child process
            //Close the read pipe and standard input.
            close(pipefd[0]);
            close(1);

            //Copy data
            dup(pipefd[1]);

            //Close other end of the pipe
            close(pipefd[1]);

            //Execute the first command. Based on how many params, call different ones.
            switch(carg1){
                case 1:
                    execlp(arg1[0].c_str(), arg1[0].c_str(), (char*)NULL);
                    break;
                case 2:
                    execlp(arg1[0].c_str(), arg1[0].c_str(), arg1[1].c_str(), (char*)NULL);
                    break;
                case 3:
                    execlp(arg1[0].c_str(), arg1[0].c_str(), arg1[1].c_str(), arg1[2].c_str(), (char*)NULL);
                    break;
                case 4:
                    execlp(arg1[0].c_str(), arg1[0].c_str(), arg1[1].c_str(), arg1[2].c_str(), arg1[3].c_str(), (char*)NULL);
                    break;
                case 5:
                    execlp(arg1[0].c_str(), arg1[0].c_str(), arg1[1].c_str(), arg1[2].c_str(), arg1[3].c_str(), arg1[4].c_str(), (char*)NULL);
                    break;
                case 6:
                    execlp(arg1[0].c_str(), arg1[0].c_str(), arg1[1].c_str(), arg1[2].c_str(), arg1[3].c_str(), arg1[4].c_str(), arg1[5].c_str(), (char*)NULL);
                    break;
                case 7:
                    execlp(arg1[0].c_str(), arg1[0].c_str(), arg1[1].c_str(), arg1[2].c_str(), arg1[3].c_str(), arg1[4].c_str(), arg1[5].c_str(), arg1[6].c_str(), (char*)NULL);
                    break;
            }
            return 0;
        case -1: //Error
            perror("fork");
            exit(EXIT_FAILURE);
        default: //Parent Process
            //Wait for initial command to execute.
            wait(&pid);

            //Fork into two processes.
            int pid2 = fork();

            //Switch based on child and parent.
            switch(pid2){
                case 0: //Child process
                    //Close write end of pipe and standard output.
                    close(pipefd[1]);
                    close(0);

                    //Duplicate to standard input
                    dup(pipefd[0]);

                    //Close read end.
                    close(pipefd[0]);

                    //Execute proper command based on params
                    switch(carg2){
                        case 1:
                            execlp(arg2[0].c_str(), arg2[0].c_str(), (char*)NULL);
                            break;
                        case 2:
                            execlp(arg2[0].c_str(), arg2[0].c_str(), arg2[1].c_str(), (char*)NULL);
                            break;
                        case 3:
                            execlp(arg2[0].c_str(), arg2[0].c_str(), arg2[1].c_str(), arg2[2].c_str(), (char*)NULL);
                            break;
                        case 4:
                            execlp(arg2[0].c_str(), arg2[0].c_str(), arg2[1].c_str(), arg2[2].c_str(), arg2[3].c_str(), (char*)NULL);
                            break;
                        case 5:
                            execlp(arg2[0].c_str(), arg2[0].c_str(), arg2[1].c_str(), arg2[2].c_str(), arg2[3].c_str(), arg2[4].c_str(), (char*)NULL);
                            break;
                        case 6:
                            execlp(arg2[0].c_str(), arg2[0].c_str(), arg2[1].c_str(), arg2[2].c_str(), arg2[3].c_str(), arg2[4].c_str(), arg2[5].c_str(), (char*)NULL);
                            break;
                        case 7:
                            execlp(arg2[0].c_str(), arg2[0].c_str(), arg2[1].c_str(), arg2[2].c_str(), arg2[3].c_str(), arg2[4].c_str(), arg2[5].c_str(), arg2[6].c_str(), (char*)NULL);
                            break;
                    }
                    return 0;
                case -1: //Error
                    perror("fork");
                    exit(EXIT_FAILURE);
                default: //Parent Process
                    //wait(&pid2);
                    break;
            }
    }   
}
} 
```

**示例输出**：

```
nick@nick-VirtualBox ~/Documents/Assign10 $ ./z1615629
Command One (or quit): ls -l
Command Two: wc
Command One (or quit): Command One (or quit): quit 
```

**示例输出**：

```
nick@nick-VirtualBox ~/Documents/Assign10 $ ./z1615629
Command One (or quit): ls -l
Command Two: cat
Command One (or quit): Command One (or quit): 
total 32
-rwxr-xr-x 1 nick nick 13358 Nov 20 15:46 z1615629
-rw-r--r-- 1 nick nick  4544 Nov 20 15:46 z1615629.cxx
-rw-r--r-- 1 nick nick  8104 Nov 20 15:46 z1615629.o 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:39:49.987

因为您不使用函数，所以在命令提示和读取循环中存在不对称行为：

```
//Prompt for first command.
while (input1.empty()){
    cout << "Command One (or quit): ";
    getline(cin, input1);
}

...

//Prompt for command 2.
while (input2.empty()){  
    cout << "Command Two: ";
    cin >> input2;
} 
```

第二个命令只包含一个单词。换行符被留下，​​在下一个周期给你双重提示。`getline(cin, input2)`在第二个提示循环中使用。如果你使用函数，你就会获得一致性——函数让生活更轻松，而不是更难。

您需要关闭父进程中的管道。您还需要`wait()`在：

```
 default: //Parent Process
                //wait(&pid2);
                break; 
```

使用：

```
 default: // Parent process
               close(pipefd[0]);
               close(pipefd[1]);
               while (wait(0) != -1)
                   ;
               break; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:48:23.133

我知道它没有解决问题，但这里是 C++ 化的原始代码。

我已经注意保持 C++03 兼容。我只假设 TR1 用于绑定（尽管使用 mem_fun_ref 的咒语应该很容易编写）。

注意尺寸的减小：**去除 88 LoC (>50%)**

```
#include <iostream>
#include <string>
#include <stdio.h>
#include <unistd.h>
#include <sys/wait.h>
#include <sstream>
#include <vector>
#include <algorithm>
#include <iterator>
#include <tr1/functional>
using namespace std;

void execute(std::vector<string> const& arg1) {
    vector<char const*> argv(arg1.size());
    transform(arg1.begin(), arg1.end(), argv.begin(), tr1::bind(&std::string::c_str, tr1::placeholders::_1));
    argv.push_back(NULL);
    execvp(argv[0], (char* const*) &argv[0]); // TODO FIXME error handling?
    exit(EXIT_FAILURE);
}

std::vector<string> getinput(std::string prompt) {
    vector<string> result;
    string input;
    //Prompt for first command.
    while(input.empty()) {
        cout << prompt;
        getline(cin, input);
    }
    //Split the string by the space to get the pieces of the command.
    {
        istringstream iss(input);
        copy(istream_iterator<string>(iss), istream_iterator<string>(), back_inserter(result));
    }
    return result;
}

int main() {
    //Loop until quit.
    while(true) {
        const std::vector<string> cmd1 = getinput("Command One (or quit): ");
        if(cmd1.empty() || cmd1[0] == "quit") {
            return 0;
        }
        const std::vector<string> cmd2 = getinput("Command Two: ");

        //Initialize the pipe.
        int pipefd[2];
        if(pipe(pipefd) == -1) {
            perror("Pipe");
            exit(EXIT_FAILURE);
        }
        int pid = fork();               //Create the fork to two processes.
        switch(pid) {                   // Switch to check for parent and child.
            case 0:                     // Child process
                close(pipefd[0]);       // Close the read pipe and standard input.
                close(1);
                dup(pipefd[1]);         // Copy data
                close(pipefd[1]);       // Close other end of the pipe
                execute(cmd1);
                return 0;
            case -1:                    // Error
                perror("fork");
                exit(EXIT_FAILURE);
            default:                    // Parent Process
                wait(&pid);             // Wait for initial command to execute.
                int pid2 = fork();      // Fork into two processes.
                switch(pid2) {          // Switch based on child and parent.
                case 0:                 // Child process
                    close(pipefd[1]);   // Close write end of pipe and standard output.
                    close(0);
                    dup(pipefd[0]);     // Duplicate to standard input
                    close(pipefd[0]);   // Close read end.
                    execute(cmd2);      // Execute proper command based on params
                    return 0;
                case -1:                // Error
                    perror("fork");
                    exit(EXIT_FAILURE);
                default:                // Parent Process
                    //wait(&pid2);
                    break;
                }
        }
    }
} 
```

**免责声明**它可以编译，我还没有运行它（我不知道要输入什么输入，以及如何输入。）

# firefox - 如何解决 Firefox 和 Chrome 之间的问题？

> ID：13482813
> 
> 赞同：1
> 
> 时间：2012-11-20T21:50:17.323
> 
> 标签：firefox, google-chrome, browser, youtube, embed

```
<iframe width="853" height="480" src="http://www.youtube.com/v/BcNkL6irfUQ?version=3&" frameborder="0" allowfullscreen></iframe> 
```

当我嵌入上述内容并在 Chrome 中查看时，它显示得很好。但是，当我在 Firefox 中查看相同的代码时，它会要求我下载文件并且不显示嵌入的视频。关于如何解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:54:19.483

可能是您的 firefox 浏览器中未安装或启用 flash。

查看[http://helpx.adobe.com/flash-player/kb/find-version-flash-player.html](http://helpx.adobe.com/flash-player/kb/find-version-flash-player.html)以查看 flash 在 firefox 中是否正常工作

# php - PHP排序内部，内部数组

> ID：13482815
> 
> 赞同：1
> 
> 时间：2012-11-20T21:50:32.680
> 
> 标签：php, arrays, sorting

好的，我有一个这样的数组：

```
array {
    [0] => array {
               [0] => array {
                         ["Time"] => "01:00:00"
                      }
               [1] => array {
                         ["Time"] => "00:00:00"
                      }
    }
    [1] => array {
               [0] => array {
                         ["Time"] => "01:00:00"
                      }
               [1] => array {
                         ["Time"] => "00:00:00"
                      }
    }
} 
```

现在我要做的是按时间值对内部内部数组（具有时间值的数组）进行排序。只是为了使内部数组按时间值排序。我该怎么做？

如果有帮助，我确实安装了 PHP 5.3。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:06:06.577

```
foreach ( $array as $key => &$part )
{
    usort( &$part, function( $a, $b ) {
        return strtotime($a['Time'])-strtotime($b['Time']) > 0;
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:03:50.310

试试这个：

```
$arr = array(array(array("Time" => "01:00:00"), array("Time" => "02:00:00"), array("Time" => "00:00:00")),
             array(array("Time" => "02:00:00"), array("Time" => "01:00:00"), array("Time" => "00:00:00")));

$c = count($arr);
for ($i = 0; $i < $c; $i++) {
    sort($arr[$i]);
}

var_dump($arr); // outputs desired array 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:53:12.703

```
function custom_map( $array ) {
    usort( $array, function( $a, $b ) {
        return strtotime($a['Time'])-strtotime($b['Time']) > 0;
    });
    return $array;
}

$new_array = array_map( "custom_map", $array ); 
```

[http://se1.php.net/manual/en/function.usort.php](http://se1.php.net/manual/en/function.usort.php)

[http://se1.php.net/manual/en/function.array-map.php](http://se1.php.net/manual/en/function.array-map.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-10T19:56:41.493

我认为对第二级进行排序并没有变得更简单——迭代第一级并`sort()`在每次出现时调用。因为您的字符串大概是`hh:ii:ss`，所以将它们作为简单字符串进行比较是完全安全的（不需要`strtotime()`）。

代码：（[演示](https://3v4l.org/G5eab)）

```
$array = [
    [
        ['Time' => "01:00:00"],
        ['Time' => "00:00:00"]
    ],
    [
        ['Time' => "01:00:00"],
        ['Time' => "00:00:00"]
    ]
];

array_walk($array, 'sort');
var_export($array); 
```

输出：

```
array (
  0 => 
  array (
    0 => 
    array (
      'Time' => '00:00:00',
    ),
    1 => 
    array (
      'Time' => '01:00:00',
    ),
  ),
  1 => 
  array (
    0 => 
    array (
      'Time' => '01:00:00',
    ),
    1 => 
    array (
      'Time' => '00:00:00',
    ),
  ),
) 
```

# jquery - 淡化 2 个相同 id 的按钮

> ID：13482828
> 
> 赞同：-1
> 
> 时间：2012-11-20T21:51:21.740
> 
> 标签：jquery

我有 2 个 id='1' 的按钮。单击第一个按钮后，它会淡出，但如果我按第二个按钮，它保持不变。

```
$("#1").click(function()
{
$("#1").fadeOut("slow");
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T21:53:19.063

如果您想使用相同的选择器淡出 2 个项目，则 id 应该是唯一的，请使用公共类，例如

HTML

```
<span class="fademe">Bla</span>
<span class="fademe">Bla</span> 
```

JavaScript

```
$('.fademe').fadeOut('slow'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T21:52:16.240

不能有两个具有相同 ID 的按钮——浏览器**假定**ID 是唯一的，JavaScript 只会识别具有给定 ID 的第一个元素。

很快就会有人告诉你，ID 也不能以数字开头，但这仅适用于 HTML 4，而且浏览器很少强制执行。尽管如此，这仍被认为是一个坏习惯。

改用通用类：

```
$(".one").click(function() {
    $(".one").fadeOut("slow");
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T21:55:34.610

要淡化多个事物，您可以使用**class**。

HTML

```
<div class="fade" id="fadeOne">Fade One</div>
<div class="fade" id="fadeTwo">Fade Two</div>

<input type="button" id="fadeButton" value="Fade" /> 
```

JS

```
$('#fadeButton').click(function() {
    $('.fade').fadeOut(); 
}); 
```

小提琴

[http://jsfiddle.net/4WDV8/](http://jsfiddle.net/4WDV8/)

**编辑**

伙计，我今天太慢了，安迪说得对！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T07:36:02.487

每个元素的 ID 必须是唯一的。尝试使用类而不是`id`

尝试这个，

```
<span id="1" class="span">Bla</span>
<span id="2" class="span">Bla</span>

$(".span").click(function(){
  $(this).fadeOut("slow");
}); 
```

# java - 十六进制字符串到整数解析java中的异常处理

> ID：13482838
> 
> 赞同：0
> 
> 时间：2012-11-20T21:52:02.550
> 
> 标签：java, string, parsing, exception, integer

我需要将字符串十六进制值解析为整数值。像这样：

```
String hex = "2A"; //The answer is 42  
int intValue = Integer.parseInt(hex, 16); 
```

但是当我插入不正确的十六进制值（例如“LL”）时，我会得到`java.lang.NumberFormatException: For input string: "LL"`如何避免它（例如返回 0）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:53:18.677

将其包含在 try catch 块中。这就是[异常处理](http://docs.oracle.com/javase/tutorial/essential/exceptions/)的工作原理： -

```
int intValue = 0;
try {
    intValue = Integer.parseInt(hex, 16);
} catch (NumberFormatException e) {
    System.out.println("Invalid Hex Value");
    // intValue will contain 0 only from the default value assignment.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:53:19.373

> 对于输入字符串：“LL”我怎样才能避免它（例如返回 0）？

只需捕获异常并将**零**分配给**intvalue**

```
int intValue;
try {
String hex = "2A"; //The answer is 42  
intValue = Integer.parseInt(hex, 16);
}
catch(NumberFormatException ex){
  System.out.println("Wrong Input"); // just to be more expressive
 invalue=0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T21:54:39.990

您*可以*捕获异常并返回零。

```
public static int parseHexInt(String hex) {
    try {
        return Integer.parseInt(hex, 16);
    } catch (NumberFormatException e) {
        return 0;
    }
} 
```

但是，我建议重新评估您的方法，因为 0 也是有效的十六进制数，并不表示无效输入，例如`"LL"`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T21:54:55.070

> 我怎样才能避免它（例如返回 0）

使用一种简单的方法，`return 0`以防`NumberFormatException`万一

```
public int getHexValue(String hex){

    int result = 0;

    try {
        result = Integer.parseInt(hex, 16);
     } catch (NumberFormatException e) {
        e.printStackTrace();
    }
    return result;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T21:55:04.097

只需捕获异常并设置默认值即可。但是，您需要在`try`块外声明变量。

```
int intValue;
try {
    intValue = Integer.parseInt(hex, 16);
} catch (NumberFormatException e) {
    intValue = 0;
} 
```

如果您需要使用初始化表达式（例如，对于`final`变量）设置值，则必须将逻辑打包在一个方法中：

```
public int parseHex(String hex) {
    try {
        return Integer.parseInt(hex, 16);
    } catch (NumberFormatException e) {
        return 0;
    }
}

// elsewhere...
final int intValue = parseHex(hex); 
```

# c# - 如何检查过长的路径？

> ID：13482841
> 
> 赞同：3
> 
> 时间：2012-11-20T21:52:10.510
> 
> 标签：c#, .net

我想为整个列表检查一次太长的路径，然后才复制/创建它们......

所以我认为这会很好：

```
try
{
    FileInfo file = new FileInfo(path);
    string temp = file.FullName;
}
catch { } 
```

但是，不会抛出异常。

我宁愿不对限制进行硬编码，因为它们可能会改变，而且我可能会错过限制......

那么如何检查长路径呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T21:55:44.063

该`Path.GetFullPath()`方法将抛出一个`PathTooLongException`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T12:27:48.473

似乎 Tim Schmelter[在这里](https://stackoverflow.com/questions/13483319/do-backslashes-count-twice-when-creating-a-directory-but-only-once-when-getting#comment18448946_13483319)给出了答案：在 ILSpy 中，似乎`GetFullPath`使用`MaxDirectoryLength`(255) 而`CreateDirectory`使用 248。

编辑：它被做成了一个[答案](https://stackoverflow.com/a/13493378/939213)。

# intellij-idea - 窗口滚动时如何使 Intellij 不丢失突出显示？

> ID：13482846
> 
> 赞同：1
> 
> 时间：2012-11-20T21:52:45.263
> 
> 标签：intellij-idea, ideavim

当我按住 shift 并点击行尾，或在 IntelliJ 中向下滚动页面时，突出显示会重置为从插入符号移动到的位置开始。有谁知道如何阻止这种情况发生？

我注意到的另一件事实际上发生并且似乎与此相关的是，如果文本离开编辑器并且我点击结束，它不会将插入符号移动到行尾，而是将编辑器移动到下一个“ page" 并在行首重新对齐插入符号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T15:32:37.647

这是 IdeaVim 的已知错误[VIM-279](http://youtrack.jetbrains.com/issue/VIM-279)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:52:45.053

感谢 CrazyCoder，我发现了问题所在，我检查了插件并确定我安装了 IdeaVim 插件，但没有激活，所以我没有意识到它在做任何事情。我已经卸载了它，问题已经消失了。

# c++ - 使用 make test 运行程序并直接调用它时的奇怪行为 ./prog

> ID：13482847
> 
> 赞同：1
> 
> 时间：2012-11-20T21:52:47.800
> 
> 标签：c++, ubuntu, makefile, ubuntu-12.04

我是一个真正的 C++ 菜鸟，所以请耐心等待。

我有一个简单的程序。当我编译它`g++ -Wall prog.cpp -o prog`然后用它运行它时，`./prog`它只是段错误。

经过一番修修补补，我写了一个makefile（见下文）。如果我运行`make test`，程序编译并运行良好。如果我用 运行它`./prog`，它会出现段错误。（确切的错误信息是`Segmentation fault (core dumped)`）

**谁能解释为什么？**

这是程序：

```
#include <iostream>
#include <stdlib.h>
#include <stdio.h>
#include <sys/time.h>

int main() {

    srand(time(NULL));

    //int i, j, k, i2, j2, k2;
    int N = 1000;

    double mul1[N][N];
    double mul2[N][N];
    double res[N][N];

    printf("N: %d\n", N);

    for(int x=0; x<N; x++) {
        for(int y=0; y<N; y++) {
            mul1[x][y] = rand() % 100;
            mul2[x][y] = rand() % 100;
            res[x][y] = 0;
        }
    }

    return 0;
} 
```

这是生成文件：

```
all: prog

prog: prog.cpp
    $(CXX) -Wall -g -o $@ prog.cpp

test: prog
    ./prog

clean: 
    rm -f prog 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T21:58:25.437

第一的：

```
int N = 1000;

double mul1[N][N];
double mul2[N][N];
double res[N][N]; 
```

你有一个堆栈溢出。

假设`double`是`8`您平台上的字节，您的 3 个数组的大小超过 20 MB ( `3 * 8 * 1000 * 1000`)。例如，在我的 Linux 机器上，为每个进程分配的堆栈大小为 8192 kB。

第二：

关于为什么它不能在 shell 上工作，但它在 Makefile 上下文中工作，你可以试试这个：

更改`N`为`10`（因此它不再出现段错误）并在程序开头添加此函数调用：

```
 system("ulimit -s");  // system is in stdlib.h 
```

您会看到 shell 中的堆栈大小（例如 is 的打印值`system`）`8192`与 Makefile 上下文中的堆栈大小（例如 is 的打印值`system`）不同`unlimited`。

# algorithm - 算法/数据结构面试

> ID：13482851
> 
> 赞同：-4
> 
> 时间：2012-11-20T21:53:05.540
> 
> 标签：algorithm, data-structures

目标是将数组转换为`a3b5c2`就地`aaabbbbbcc`数组。我有一个解决方案：

*   假设数组是无限大的，
*   我从最后解析数组。
*   寻找一个数字（比如 n）
*   根据我得到的数字，我寻找下一个字符。
*   当我得到它时，我将元素从当前位置移动到数组末尾`n-1`。
*   用遇到的字符填充空缺职位。

该解决方案的复杂度为 O(n^2)。是否有复杂度小于 O(n^2) 的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:57:23.157

如果您解析一次数组，您可以通过对所有数值求和来知道最后一个元素的位置。

解析一次并找到它的最终大小。

一旦你这样做了，从“结束”开始填充它（从它的最终值开始）：2次`c`，然后5次`b`......

这是一个`O(n)`就地解决方案。

**编辑：**

正如 srbh.kmr 在评论中所说，如果数组中有一系列位置错误的字符仅重复一次，这将不起作用。例如，如果我们有数组`a1b1c1d1e7`，上面的答案将删除最后一个字母。

导致问题的唯一数字是`1`，我们可以将其处理为`O(n)`：

在按上述说明处理阵列之前，请消除这些阵列。从头开始，解析数组，每次`1`找到 a 时，擦除它并向前移动剩余的字母（不是整个剩余的数组，只是下一个字符）。如果在数组中找到几个`1`s，则数组的第一部分和第二部分之间的*孔*会变大。对于上面的示例数组，步骤如下所示：

```
a1b1c1d1e7
// First parse gives length = 1+1+1+1+7

// Repair ones
a b1c1d1e7
ab 1c1d1e7
ab  c1d1e7
abc  1d1e7
abc   d1e7
abcd   1e7
abcd    e7
abcde    7
abcde7 
```

*然后*，应用上面的算法。如果在字符后没有找到数字，只需将字符复制到数组末尾的位置：

```
// Fill final array
abcde7    x
          ^ 11th position
abcde     e
abcde    ee
abcde   eee
abcde  eeee
abcde eeeee
abcdeeeeeee
abcdeeeeeee  // Here we overwrite the first "e"
abcdeeeeeee  // Then we see there are lone letters (4 times), so we leave them. 
```

# actionscript - 矢量艺术 (.svg) 的 Flash 性能不佳

> ID：13482858
> 
> 赞同：0
> 
> 时间：2012-11-20T21:53:32.853
> 
> 标签：actionscript, flash, vector-graphics

当使用多幅矢量图时，我注意到性能变得相当草率，因此我创建了一个简单的测试程序，该程序显示同一图形的 100 个副本并允许缩放。我使用了我认为相当简单的矢量图像（可以查看下面的链接）。但是，放大或缩小时 fps 会大幅下降。我知道缩放需要大量计算，但我有一个高于平均水平的系统（i5 2500k 处理器），我希望能够处理这些需求。有什么我想念的吗？

图片图片 - [http://i.imgur.com/Cj50O.png](http://i.imgur.com/Cj50O.png)

SVG 文件 - [http://pastebin.com/MjBLebFQ](http://pastebin.com/MjBLebFQ)

```
package 
{
import flash.display.Sprite;
import flash.events.MouseEvent;

public class Main extends Sprite 
{
    [Embed(source = "../lib/Doctor.svg")]
    private var Doctor:Class;

    private var container:Sprite = new Sprite();

    public function Main():void 
    {
        container = new Sprite();
        for (var i:int = 0; i < 10; i++) {
            for (var j:int = 0; j < 10; j++) {
                var s:Sprite = new Doctor();
                s.x = i * 20;
                container.addChild(s);                  
            }
        }
        this.addChild(container);
        this.addEventListener(MouseEvent.MOUSE_WHEEL, onMouseWheel);
    }

    private function onMouseWheel(event:MouseEvent):void
    {                               
        if (event.delta > 0) {
            container.scaleX += 0.1;
            container.scaleY += 0.1;
        }else {
            container.scaleX -= 0.1;
            container.scaleY -= 0.1;
        }

    }
}

} 
```

# ruby-on-rails - 在 Rails 中迭代地创建多个文件输入字段

> ID：13482860
> 
> 赞同：0
> 
> 时间：2012-11-20T21:53:44.190
> 
> 标签：ruby-on-rails, ruby, forms, file-upload

我在数据库中有一列产品视图（例如顶部、底部、正面、背面）。我正在尝试生成一系列文件输入，以允许用户为每个视图上传图像。这是我追求的结果：

```
...
<label>Top</label>
<input type="file" name="image[Top]"><br>
<label>Bottom</label>
<input type="file" name="image[Bottom]"><br>
<label>Front</label>
<input type="file" name="image[Front']"><br>
... 
```

这就是我正在尝试的：

```
<%= views = View.order('name ASC').all.map { |view| [view.name, view.id] } %>
<%= views.each { |view| label(view); file_field('image', view) } %> 
```

然而，这一切只是打印出`views`数组几次。希望你们的 Rails 专家能指出我正确的方向。（如果我要屠杀 Ruby，我提前道歉。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:57:20.783

我建议将您的逻辑从视图中移到控制器或辅助方法中。您的 views_controller.rb ：

```
@views = View.all.order('name ASC') 
```

这为您提供了一个实例对象数组，这意味着您可以通过以下方式访问视图名称：

```
@views.each do |v|
   var = v.name
# other code for iterating on View ...
end 
```

现在，在您的视图中（应该是 form_for 或 form_tag ，因此您可以选择图像并上传它们），您可以：

```
<%= form_for(@catalogue) do |f| %>
  <%= @views.each do |v| %>
    <%= f.label v.name %>    < br/ >  
    <%= f.file_field v.name %>
  <% end %>

  <% f.submit %>

<% end %> 
```

# c++ - 为 shared_ptr 指定自定义删除器但遇到错误

> ID：13482867
> 
> 赞同：0
> 
> 时间：2012-11-20T21:54:10.203
> 
> 标签：c++, algorithm, boost, std, shared-ptr

我在 stackoverflow 中搜索了如何为 shared_ptr 指定自定义删除器，这些是我发现的：

```
boost::shared_ptr<T> ptr( new T, std::mem_fun_ref(&T::deleteMe) );
boost::shared_ptr<S> ptr( new S, std::ptr_fun(lib_freeXYZ) ); 
```

我有一个类ISprite，它是一个带有纯虚函数destroy()的抽象类，这个类可以使用libInterface->createSprite(a.bmp)创建实例，现在我使用ISprite作为另一个类的成员变量，想使用shared_ptr封装，但是ISprite实例不能删除，所以如果我想使用shared_ptr来包装成员变量ISprite，我需要为它指定我自己的删除器。以下是我所做的：

```
boost::shared_ptr<ISprite> ptr(system- 
      >createSprite("a.bmp"),std::mem_fun_ref(&ISprite::destroy)); 
```

但编译一直告诉我 ...boost\smart_ptr\detail\shared_count.hpp(132) ：

```
error C2664: 'void std::mem_fun_ref_t<_Result,_Ty>::operator ()(_Ty &) const' :         
cannot convert parameter 1 from 'ISprite *' to 'ISprite &' 
```

我不知道那里出了什么问题，有人可以帮忙吗？太感谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:59:01.510

`mem_fun_ref`期望一个`T &`. 改为使用`mem_fun`；它期望一个`T *`.

# r - 具有右闭区间的 findInterval()

> ID：13482872
> 
> 赞同：20
> 
> 时间：2012-11-20T21:54:31.700
> 
> 标签：r, binary-search

R 中的伟大`findInterval()`函数在其`vec`参数中使用左闭子区间，如其文档所示：

> 如果`i <- findInterval(x,v)`，我们有`v[i[j]] <= x[j] < v[i[j] + 1]`

如果我想要右闭子区间，我有什么选择？我想出的最好的是：

```
findInterval.rightClosed <- function(x, vec, ...) {
  fi <- findInterval(x, vec, ...)
  fi - (x==vec[fi])
} 
```

另一个也有效：

```
findInterval.rightClosed2 <- function(x, vec, ...) {
  length(vec) - findInterval(-x, -rev(vec), ...)
} 
```

这是一个小测试：

```
x <- c(3, 6, 7, 7, 29, 37, 52)
vec <- c(2, 5, 6, 35)
findInterval(x, vec)
# [1] 1 3 3 3 3 4 4
findInterval.rightClosed(x, vec)
# [1] 1 2 3 3 3 4 4
findInterval.rightClosed2(x, vec)
# [1] 1 2 3 3 3 4 4 
```

但如果有更好的解决方案，我希望看到任何其他解决方案。我所说的“更好”是指“在某种程度上更令人满意”或“感觉不像是杂物”，甚至可能是“更有效率”。=)

（请注意， 有一个`rightmost.closed`参数`findInterval()`，但它是不同的 - 它仅指最终的子区间并且具有不同的含义。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T22:03:31.600

**编辑：**主要清理所有过道。

你可能会看`cut`。默认情况下，设置`cut`左开和右闭区间，并且可以使用适当的参数 ( `right`) 进行更改。要使用您的示例：

```
x <- c(3, 6, 7, 7, 29, 37, 52)
vec <- c(2, 5, 6, 35)
cutVec <- c(vec, max(x)) # for cut, range of vec should cover all of x 
```

现在创建四个应该做同样事情的函数：两个来自 OP，一个来自 Josh O'Brien，然后是`cut`. `cut`已从默认设置更改的两个参数：`include.lowest = TRUE`将为最小（最左侧）间隔创建一个两侧闭合的间隔。`labels = FALSE`将导致`cut`仅返回 bin 的整数值，而不是创建一个因子，否则它会这样做。

```
findInterval.rightClosed <- function(x, vec, ...) {
  fi <- findInterval(x, vec, ...)
  fi - (x==vec[fi])
}
findInterval.rightClosed2 <- function(x, vec, ...) {
  length(vec) - findInterval(-x, -rev(vec), ...)
}
cutFun <- function(x, vec){
    cut(x, vec, include.lowest = TRUE, labels = FALSE)
}
# The body of fiFun is a contribution by Josh O'Brien that got fed to the ether.
fiFun <- function(x, vec){
    xxFI <- findInterval(x, vec * (1 + .Machine$double.eps))
} 
```

所有函数都返回相同的结果吗？是的。（注意`cutVec`for的使用`cutFun`）

```
mapply(identical, list(findInterval.rightClosed(x, vec)),
  list(findInterval.rightClosed2(x, vec), cutFun(x, cutVec), fiFun(x, vec)))
# [1] TRUE TRUE TRUE 
```

现在对 bin 的要求更高：

```
x <- rpois(2e6, 10)
vec <- c(-Inf, quantile(x, seq(.2, 1, .2))) 
```

测试是否相同（注意使用`unname`）

```
mapply(identical, list(unname(findInterval.rightClosed(x, vec))),
  list(findInterval.rightClosed2(x, vec), cutFun(x, vec), fiFun(x, vec)))
# [1] TRUE TRUE TRUE 
```

和基准：

```
library(microbenchmark)
microbenchmark(findInterval.rightClosed(x, vec), findInterval.rightClosed2(x, vec),
  cutFun(x, vec), fiFun(x, vec), times = 50)
# Unit: milliseconds
#                                expr       min        lq    median        uq       max
# 1                    cutFun(x, vec)  35.46261  35.63435  35.81233  36.68036  53.52078
# 2                     fiFun(x, vec)  51.30158  51.69391  52.24277  53.69253  67.09433
# 3  findInterval.rightClosed(x, vec) 124.57110 133.99315 142.06567 155.68592 176.43291
# 4 findInterval.rightClosed2(x, vec)  79.81685  82.01025  86.20182  95.65368 108.51624 
```

从这个运行来看，`cut`似乎是最快的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-10-23T16:33:18.670

也许你可以使用 left.open 选项：

```
findInterval(x, vec, left.open=T)
[1] 1 2 3 3 3 4 4 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-08-15T14:38:33.487

如果您的限制是间隔，您只需稍微增加正确的间隔：interval+c(0,0.1) 会做：findinterval(value, interval+c(0,0.1))

# android - 使用网页链接访问移动 GPS 应用程序并将当前位置传递给应用程序

> ID：13482876
> 
> 赞同：0
> 
> 时间：2012-11-20T21:54:50.250
> 
> 标签：android, ios, mobile, gps, webpage

我的目标是使用我当前的网页从网页上的链接访问本机移动 gps 应用程序，并让该链接将我当前的位置和目标位置发送到应用程序。这一切都必须从我的网页完成。例如，我单击一个建筑地址链接，它会通过应用程序将我带到该建筑。用户必须在移动设备上浏览。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:26:20.490

所有的移动浏览器都支持 GEO 位置 API，您可以使用它们的位置来使用 Virtual Earth 或 Google 将地图居中，当然还可以添加您需要添加到地图中的项目，例如图钉等。我有一篇关于它的博客文章：

[http://professionalaspnet.com/archive/2012/05/25/A-Study-Using-The-HTML5-Geolocation-API.aspx](http://professionalaspnet.com/archive/2012/05/25/A-Study-Using-The-HTML5-Geolocation-API.aspx)

# android - 为什么android在looper等待时会在ANR中处理应用程序

> ID：13482883
> 
> 赞同：9
> 
> 时间：2012-11-20T21:55:06.940
> 
> 标签：android

在我的 android logcat 日志中，我看到：

```
01-02 02:01:46.523 E/ActivityManager(  459): ANR in com.android.phone (com.android.phone/.InCallScreen) 
```

然后当我转到 /data/anr/traces.txt 时，我看到了

```
Cmd line: com.android.phone

DALVIK THREADS:
(mutexes: tll=0 tsl=0 tscl=0 ghl=0)

"main" prio=5 tid=1 NATIVE
  | group="main" sCount=1 dsCount=0 obj=0x410f7508 self=0x40eeeb68
  | sysTid=649 nice=0 sched=0/0 cgrp=apps handle=1075429168
  | schedstat=( 0 0 0 ) utm=1361 stm=314 core=1
  #00  pc 0000dac0  /system/lib/libc.so (epoll_wait+12)
  #01  pc 00014899  /system/lib/libutils.so (android::Looper::pollInner(int)+96)
  #02  pc 00014b01  /system/lib/libutils.so (android::Looper::pollOnce(int, int*, int*, void**)+104)
  #03  pc 00063aeb  /system/lib/libandroid_runtime.so (android::NativeMessageQueue::pollOnce(_JNIEnv*, int)+22)
  #04  pc 0001df30  /system/lib/libdvm.so (dvmPlatformInvoke+112)
  #05  pc 0004d1fb  /system/lib/libdvm.so (dvmCallJNIMethod(unsigned int const*, JValue*, Method const*, Thread*)+394)
  #06  pc 00038f4d  /system/lib/libdvm.so (dvmCheckCallJNIMethod(unsigned int const*, JValue*, Method const*, Thread*)+8)
  #07  pc 00000214  /dev/ashmem/dalvik-jit-code-cache (deleted)
  at android.os.MessageQueue.nativePollOnce(Native Method)
  at android.os.MessageQueue.next(MessageQueue.java:125)
  at android.os.Looper.loop(Looper.java:124)
  at android.app.ActivityThread.main(ActivityThread.java:4921)
  at java.lang.reflect.Method.invokeNative(Native Method)
  at java.lang.reflect.Method.invoke(Method.java:511)
  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1038)
  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:805)
  at dalvik.system.NativeStart.main(Native Method) 
```

我的问题是为什么当堆栈跟踪显示 Looper 中的主线程等待消息时，android 认为应用程序处于 ANR 中？这对我来说似乎很正常。我了解当主线程正在下载某些东西/进行长时间操作时，android 会显示 ANR。但它正在等待消息似乎很正常。如果我错了，请纠正我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T16:39:54.283

我发现了这个有趣的错误报告：

[http://code.google.com/p/android/issues/detail?id=41755](http://code.google.com/p/android/issues/detail?id=41755)

简短的总结是，NDK 包装器代码中似乎存在一个错误，这意味着来自多个来源的事件可能会导致 ANR。这完全符合我的用例——我有一个 NDK 应用程序，工作在后台线程和游戏手柄中进行，我得到的 ANR 与您描述的和错误报告中的完全匹配。

这与您的设置相似吗？

**更新：**更多信息： http: [//ps3computing.blogspot.co.uk/2012/12/anr-application-not-responding.html](http://ps3computing.blogspot.co.uk/2012/12/anr-application-not-responding.html)

在应用了他博客上描述的修复后，我似乎无法再次显示 ANR。但这并不是说它消失了，尽管...

# applescript - 在 Applescript 中返回 HTML 解析后，如何正确格式化引号？

> ID：13482886
> 
> 赞同：2
> 
> 时间：2012-11-20T21:55:09.353
> 
> 标签：applescript

我正在使用此代码从网站调用描述：

```
set astid to AppleScript's text item delimiters

set startHere to "<div id=\"doc-original-text\" itemprop=\"description\">"
set stopHere to "</div>"
set mysource_html to do shell script "curl https://play.google.com/store/movies/details?id=H9EKG4-JHSw"
set AppleScript's text item delimiters to startHere
set blurb1 to text item 2 of mysource_html
set AppleScript's text item delimiters to stopHere
set blurb2 to text item 1 of blurb1

set AppleScript's text item delimiters to astid
blurb2 
```

这是它返回的内容：

```
"Liam Neeson stars in producer/director Joe Carnahan&#39;s tense adventure thriller
about a group of tough-as-nails oil rig workers who must fight for their lives in the
Alaskan wilderness after their airplane crashes miles from civilization. With supplies 
running short and hungry wolves closing in, the shaken survivors face a fate worse than 
death if they don&#39;t act fast. Dermot Mulroney, Dallas Roberts, and Frank Grillo co-
star." 
```

如何让引号正确格式化 `'` 而不是`&#39;`返回时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:30:31.507

[ASObjC Runner](http://www.macosxautomation.com/applescript/apps/runner_vanilla.html)有一些有用的功能来编码/解码文本。

```
set astid to AppleScript's text item delimiters

set startHere to "<div id=\"doc-original-text\" itemprop=\"description\">"
set stopHere to "</div>"
set mysource_html to do shell script "curl https://play.google.com/store/movies/details?id=H9EKG4-JHSw"
set AppleScript's text item delimiters to startHere
set blurb1 to text item 2 of mysource_html
set AppleScript's text item delimiters to stopHere
set blurb2 to text item 1 of blurb1

set AppleScript's text item delimiters to astid
tell application "ASObjC Runner" to set blurb3 to modify string blurb2 so it is unencoded for XML 
```

或者您可以继续使用文本项分隔符：

```
set astid to AppleScript's text item delimiters

set startHere to "<div id=\"doc-original-text\" itemprop=\"description\">"
set stopHere to "</div>"
set mysource_html to do shell script "curl https://play.google.com/store/movies/details?id=H9EKG4-JHSw"
set AppleScript's text item delimiters to startHere
set blurb1 to text item 2 of mysource_html
set AppleScript's text item delimiters to stopHere
set blurb2 to text item 1 of blurb1
set AppleScript's text item delimiters to "&#39;"
set blurb2 to text items of blurb2
set AppleScript's text item delimiters to "'"
set blurb2 to blurb2 as text
set AppleScript's text item delimiters to astid 
```

# c# - 取消方法执行的正确方法

> ID：13482895
> 
> 赞同：7
> 
> 时间：2012-11-20T21:55:36.000
> 
> 标签：c#, task-parallel-library, abort, cancellation

> **可能重复：**
> [如何中止/取消 TPL 任务？](https://stackoverflow.com/questions/4783865/how-do-i-abort-cancel-tpl-tasks)

我有一个需要一些时间来执行的方法，因此我将结果作为回调返回。我的方法看起来像：

```
public static void DoWork( Action<object> onCompleteCallBack)
{
  Task.Factory.StartNew( () => {
    // Do work
    onCompleteCallBack(someResult);
  });
} 
```

现在我希望能够停止执行该方法，以防用户不想等待。结果，这就是我所制定的：

```
static void Main ( string[] args )
{            
  var cancelMethod = DoWork( x =>
  {                
    // method completed
    Console.Write( x.ToString() );
  });
  Thread.Sleep( 5000 ); // some time passes 

  // then user decides to abort method
  cancelMethod();
  Console.Read();
}

static Action DoWork ( Action<object> onCompleteCallBack )
{
  bool stopExecuting = false;
  Task.Factory.StartNew( () =>
  {
    for ( var i = 0 ; i < 100000 ; i++ ) 
    {
      Thread.Sleep( 1 );
      if ( stopExecuting )
      {
        onCompleteCallBack( "Method aborted!" );
        return;
      }
    }         
    onCompleteCallBack( "Method completed successfully" );
  } );
  return () => { stopExecuting = true; };
} 
```

什么是中止方法执行的更合适的方法？

## 编辑

感谢您的回答。我现在记得取消令牌的事情。象征性的东西很难记住。我想我会使用这种方法：

```
 static void Main ( string[ ] args )
    {
        Action abortTask;

        DoWork( methodCompleted, out abortTask );

        Thread.Sleep( 5000 ); // some time passes then user decides to abort method

        // cancel execution of method
        abortTask( );

        Console.Read( );
    }

    static void methodCompleted ( object msg )
    {            
        Console.Write( msg.ToString( ) );  
    }

    static void DoWork ( Action<object> onCompleteCallBack, out Action abortThisTask )
    {
        bool stopExecuting = false;

        abortThisTask = ( ) => { stopExecuting = true; };

        Task.Factory.StartNew( ( ) =>
        {
            for ( var i = 0 ; i < 100000 ; i++ ) 
            {
                Thread.Sleep( 1 );

                if ( stopExecuting )
                {
                    onCompleteCallBack( "Method aborted!" );
                    return;
                }
            }

            onCompleteCallBack( "Method completed successfully" );
        } );            
    }

    // Overloaded method
    static void DoWork ( Action<object> onCompleteCallBack )
    {
        Action abortTask;
        DoWork( onCompleteCallBack ,out abortTask );
    } 
```

使用你们在这个问题的答案上建议的方法和这种方法会更好吗？我更喜欢这种方法。我认为它比取消令牌更容易阅读。

PS。我的 Visual Studio 放置了很多空间。随意格式化代码:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T22:05:27.430

[尝试通过在任务http://blogs.msdn.com/b/csharpfaq/archive/2010/07/19/parallel-programming-task-cancellation.aspx](http://blogs.msdn.com/b/csharpfaq/archive/2010/07/19/parallel-programming-task-cancellation.aspx)中指定您的函数来使用取消令牌

```
CancellationTokenSource tokenSource = new CancellationTokenSource();
 Task.Factory.StartNew( () => {
    // Do work
    onCompleteCallBack(someResult);
  }, tokenSource.Token);

private void cancel_Click(object sender, RoutedEventArgs e)
{
    tokenSource.Cancel();

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:01:51.533

查看[CancellationToken](http://msdn.microsoft.com/en-us/library/system.threading.cancellationtoken%28v=vs.100%29.aspx)和[Albahari 的](http://www.albahari.com/threading/part3.aspx#_Safe_Cancellation)安全取消线程指南

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T22:02:05.697

接受 CancellationToken 的 StartNew() 方法有一个重载。这是一个示例：http: [//msdn.microsoft.com/en-us/library/dd997396.aspx](http://msdn.microsoft.com/en-us/library/dd997396.aspx)。基础是您创建然后将此令牌传递给您的方法（或从父线程引用它；它是线程安全的）。然后，您的并行方法必须在方便的时候（例如在循环中）检查令牌是否指示任务已被取消。如果是这样，它会优雅地退出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T22:05:14.297

任务允许您传入一个`CancellationToken`. 您可以调用 ct.Cancel() 以设置取消标志。在您的实际执行逻辑中，您可以在某些“检查点”添加检查，以测试`if (ct.IsCancellationRequested)`并从那里返回方法，或者调用`ct.ThrowIfCancellationRequested()`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T22:00:11.677

[http://msdn.microsoft.com/en-us/library/dd537607(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/dd537607(v=vs.100).aspx)可能是一个不错的起点。取决于你要做什么。

# php - 通过ajax向php脚本发送隐藏输入不起作用

> ID：13482896
> 
> 赞同：2
> 
> 时间：2012-11-20T21:55:39.937
> 
> 标签：php, javascript, jquery, ajax, json

我试图让我的 ajax/json 脚本工作，我查看了 stackoverflow，但找不到任何看起来有帮助的东西。基本上，我要做的就是当用户单击提交按钮时，将隐藏的输入值通过 ajax 发送到另一个 php 脚本，在那里它将被更改等等......然后通过 ajax 发回并显示在里面div 通过响应，我不确定我做错了什么。

目前我什么也没得到，没有输出或任何东西。

我将尝试在下面给出的代码中尽可能彻底，感谢所有帮助。

主页上的 AJAX 脚本

```
<script>
$(document).ready(function () {
  $(".add_detail_land_down").click(function () {
    var hidden_count = $('input[name=addon_detail_hidden_count]').val();
    $.ajax({
      type: "GET",
      url: "ajax_script.php",
      data: {
        hidden_count: hidden_count
      },
      dataType: "json",
      statusCode: {
        success: function (data) {
          $("#total_hidden").html(data.total_hidden);
        }
      }
    });
  })
});
$(".add_detail_land_down").click();
</script> 
```

主页上的表格头（我想我不妨添加它，以防万一）

```
<form action="" method="post"> 
```

主页上的隐藏输入

```
<input type="hidden" name="addon_detail_hidden_count" id="addon_detail_hidden_count" class="addon_detail_hidden_count" value="1" /> 
```

用于在主页面上启动 ajax 进程的提交按钮

```
<input name="add_detail_land_down" type="submit" class="add_detail_land_down" value="add_detail_down"/> 
```

ajax_script.php 中的代码

```
 <?php 

$hidden_count = $_GET["hidden_count"];

$hidden_count = $hidden_count + 1;
include 'connect_to_mysql.php';

echo json_encode(array("total_hidden" => $hidden_count ));

 ?> 
```

感谢您的任何帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:59:07.947

你为什么要嵌套你的`success callback`内部**statusCode**

应该是

```
dataType: "json",
success: function (data) {
    $("#total_hidden").html(data.total_hidden);
} 
```

**或者**

使用状态码**200**而不是**成功**

```
dataType: "json",
statusCode: {
     200 : function (data) {
          $("#total_hidden").html(data.total_hidden);
     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:09:59.957

在提到的所有其他问题中：`statusCode/success`语法问题，以及您的单击 trigegr outlsde`document.ready`还需要阻止浏览器默认提交表单。

目前，当您提交时，您的页面可能正在刷新......正常的浏览器行为。

在点击处理程序中，您需要通过返回`false`或使用来防止这种情况`preventDefault()`

```
$(".add_detail_land_down").click(function (event) {

   /* use either of these */

   /* before your ajax code */
    event.preventDefault();

    /* or after your ajax code*/

     return false;

}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:03:04.837

你的成功回调应该这样指定（如果你只关心 200）：

```
success: function (data) {
    $("#total_hidden").html(data.total_hidden);
} 
```

此外，您尝试`click()`在元素上执行的位置实际上可能发生在文档加载之前，因此在 onclick 处理程序准备好之前执行。如果您想在文档就绪时自动触发，这应该在 onclick 之后的文档就绪内。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T21:59:38.473

statusCode 是数字，对于您的情况，应将其`200`更改`success`为`200`：

```
statusCode: {
    200: function (data) {
        $("#total_hidden").html(data.total_hidden);
    }
} 
```

# sql - 查询返回值为0

> ID：13482908
> 
> 赞同：0
> 
> 时间：2012-11-20T21:56:29.823
> 
> 标签：sql, oracle, oracle10g, oracle11g

我正在尝试在 SQL Developer 中执行以下 PL/SQL 脚本。循环应该返回 null 的计数，但每次它返回 0 时都会以某种方式返回。将 serveroutput 设置为 on

```
DECLARE

--v_count number;
v_count_null number;

BEGIN
execute immediate 'select count(*) from SP_MOSAIX' into v_count;

FOR  i in (select column_name from all_tab_COLUMNS where table_name = 'SP_MOSAIX')
LOOP
select count(*) into v_count_null from SP_MOSAIX  where i.column_name IS NULL ;
dbms_output.put_line(v_count_null);

END LOOP;

END; 
```

所以当我运行它时，我得到以下输出：

0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

但是，如果我手动执行替换 column_name 的查询，我会得到结果。

```
select count(*) into v_count_null from SP_MOSAIX  where i.column_name IS NULL; 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:55:33.310

这里有几件事你需要注意。首先，正如您所提到的，您的 COUNT 查询正在使用 i.column_name 的值执行，该值永远不会为 NULL。

其次，`COUNT(*)`返回与您的子句条件匹配的**行**数，而不考虑值。如果要计算特定列中有多少值，则必须显式地计算该列中的值。`WHERE``NULL``NOT NULL``COUNT`

请参阅以下示例（[SQL Fiddle](http://sqlfiddle.com/#!4/30709/9)）：

**Oracle 11g R2 模式设置**：

```
CREATE TABLE null_col_vals (
  col_without_nulls INTEGER NOT NULL
, col_with_nulls INTEGER
, col_with_mix INTEGER  
)
/

INSERT INTO null_col_vals (col_without_nulls, col_with_nulls, col_with_mix)
VALUES (1, NULL, NULL)
/

INSERT INTO null_col_vals (col_without_nulls, col_with_nulls, col_with_mix)
VALUES (1, NULL, 1)
/

INSERT INTO null_col_vals (col_without_nulls, col_with_nulls, col_with_mix)
VALUES (1, NULL, NULL)
/ 
```

**查询 1**：

```
SELECT 
  COUNT(col_without_nulls) col_without_nulls
, COUNT(col_with_nulls) col_with_nulls
, COUNT(col_with_mix) col_with_mix
, COUNT(*) all_rows
FROM null_col_vals 
```

**结果**：

```
| COL_WITHOUT_NULLS | COL_WITH_NULLS | COL_WITH_MIX | ALL_ROWS |
----------------------------------------------------------------
|                 3 |              0 |            1 |        3 | 
```

如您所见，`COUNT(*)`总是返回存在的行数，但其他的结果会有所不同，具体取决于`NULL`指定列中是否存在值。

您需要使用`EXECUTE IMMEDIATE`将列名转换为查询的一部分。这样的事情可能会完成这项工作：

**查询 2**：

```
DECLARE

  l_count INTEGER;

BEGIN

  FOR r_col IN (
    SELECT *
    FROM all_tab_columns atc
    WHERE atc.table_name = 'NULL_COL_VALS'
  )
  LOOP

    dbms_output.put_line(r_col.column_name);

    EXECUTE IMMEDIATE 'SELECT COUNT(' || r_col.column_name || ') FROM null_col_vals' 
    INTO l_count;

    dbms_output.put_line(l_count);

  END LOOP;

END; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:56:42.090

您需要使用动态 SQL，这将允许您引用每一列：

```
FOR  i in (select column_name from all_tab_COLUMNS where table_name = 'SP_MOSAIX')
LOOP
    execute immediate 'select count(*) from SP_MOSAIX  where '||i.column_name||' IS NULL'
     into v_count_null ;
    dbms_output.put_line(i.column_name||' = '||v_count_null);

END LOOP; 
```

# java - 使用 Joda DateTime 作为 Jersey 参数？

> ID：13482909
> 
> 赞同：12
> 
> 时间：2012-11-20T21:56:40.020
> 
> 标签：java, jersey, jax-rs, jodatime

我想`DateTime`在 Jersey 中使用 Joda 的查询参数，但这不受 Jersey 开箱即用的支持。我假设实现 an`InjectableProvider`是添加`DateTime`支持的正确方法。

有人可以指出一个好的实现`InjectableProvider`for`DateTime`吗？或者有没有值得推荐的替代方法？（我知道我可以从`Date`或`String`在我的代码中进行转换，但这似乎是一个较小的解决方案）。

谢谢。

**解决方案：**

我在下面修改了 Gili 的答案以使用`@Context`JAX-RS 而不是 Guice 中的注入机制。

更新：如果 UriInfo 未注入您的服务方法参数，这可能无法正常工作。

```
import com.sun.jersey.core.spi.component.ComponentContext;
import com.sun.jersey.spi.inject.Injectable;
import com.sun.jersey.spi.inject.PerRequestTypeInjectableProvider;
import java.util.List;
import javax.ws.rs.QueryParam;
import javax.ws.rs.WebApplicationException;
import javax.ws.rs.core.Context;
import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.Status;
import javax.ws.rs.core.UriInfo;
import javax.ws.rs.ext.Provider;
import org.joda.time.DateTime;

/**
 * Enables DateTime to be used as a QueryParam.
 * <p/>
 * @author Gili Tzabari
 */
@Provider
public class DateTimeInjector extends PerRequestTypeInjectableProvider<QueryParam, DateTime>
{
    private final UriInfo uriInfo;

    /**
     * Creates a new DateTimeInjector.
     * <p/>
     * @param uriInfo an instance of {@link UriInfo}
     */
    public DateTimeInjector( @Context UriInfo uriInfo)
    {
        super(DateTime.class);
        this.uriInfo = uriInfo;
    }

    @Override
    public Injectable<DateTime> getInjectable(final ComponentContext cc, final QueryParam a)
    {
        return new Injectable<DateTime>()
        {
            @Override
            public DateTime getValue()
            {
                final List<String> values = uriInfo.getQueryParameters().get(a.value());

                if( values == null || values.isEmpty())
                    return null;
                if (values.size() > 1)
                {
                    throw new WebApplicationException(Response.status(Status.BAD_REQUEST).
                        entity(a.value() + " may only contain a single value").build());
                }
                return new DateTime(values.get(0));
            }
        };
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T19:23:54.390

这是一个依赖于 Guice 的实现。您可以使用不同的注射器，只需稍作修改：

```
import com.google.inject.Inject;
import com.sun.jersey.core.spi.component.ComponentContext;
import com.sun.jersey.spi.inject.Injectable;
import com.sun.jersey.spi.inject.PerRequestTypeInjectableProvider;
import java.util.List;
import javax.ws.rs.QueryParam;
import javax.ws.rs.WebApplicationException;
import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.Status;
import javax.ws.rs.core.UriInfo;
import javax.ws.rs.ext.Provider;
import org.joda.time.DateTime;

/**
 * Enables DateTime to be used as a QueryParam.
 * <p/>
 * @author Gili Tzabari
 */
@Provider
public class DateTimeInjector extends PerRequestTypeInjectableProvider<QueryParam, DateTime>
{
    private final com.google.inject.Provider<UriInfo> uriInfo;

    /**
     * Creates a new DateTimeInjector.
     * <p/>
     * @param uriInfo an instance of {@link UriInfo}
     */
    @Inject
    public DateTimeInjector(com.google.inject.Provider<UriInfo> uriInfo)
    {
        super(DateTime.class);
        this.uriInfo = uriInfo;
    }

    @Override
    public Injectable<DateTime> getInjectable(final ComponentContext cc, final QueryParam a)
    {
        return new Injectable<DateTime>()
        {
            @Override
            public DateTime getValue()
            {
                final List<String> values = uriInfo.get().getQueryParameters().get(a.value());
                if (values.size() > 1)
                {
                    throw new WebApplicationException(Response.status(Status.BAD_REQUEST).
                        entity(a.value() + " may only contain a single value").build());
                }
                if (values.isEmpty())
                    return null;
                return new DateTime(values.get(0));
            }
        };
    }
} 
```

没有 Guice 绑定。@Provider 是一个 JAX-RS 注释。Guice 只需要能够注入 UriInfo 并且[Jersey-Guice](http://jersey.java.net/nonav/apidocs/1.1.5/contribs/jersey-guice/com/sun/jersey/guice/spi/container/servlet/package-summary.html)提供了该绑定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-05T02:10:28.263

处理在客户端-服务器之间发送 Joda DateTime 对象的另一个选项是使用适配器和相应的注释显式地编组/解编组它们。原理是将其编组为 Long 对象，而 de-marshalling 使用 Long 对象为构造函数调用实例化一个新的 DateTime 对象。Long 对象是通过 getMillis 方法获得的。要进行这项工作，请指定要在具有 DateTime 对象的类中使用的适配器：

```
@XmlElement(name="capture_date")
@XmlJavaTypeAdapter(XmlDateTimeAdapter.class)
public DateTime getCaptureDate() { return this.capture_date; }
public void setCaptureDate(DateTime capture_date) { this.capture_date = capture_date; } 
```

然后编写适配器和 XML 类来封装 Long 对象：

```
import javax.xml.bind.annotation.adapters.XmlAdapter;
import org.joda.time.DateTime;
import org.joda.time.DateTimeZone;

/**
 * Convert between joda datetime and XML-serialisable millis represented as long
 */
public class XmlDateTimeAdapter  extends XmlAdapter<XmlDateTime, DateTime> {

    @Override
    public XmlDateTime marshal(DateTime v) throws Exception {

        if(v != null)
            return new XmlDateTime(v.getMillis());
        else
            return new XmlDateTime(0); 

    }

    @Override
    public DateTime unmarshal(XmlDateTime v) throws Exception {

        return new DateTime(v.millis, DateTimeZone.UTC);
    }
}

import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;

/**
 * XML-serialisable wrapper for joda datetime values.
 */
@XmlRootElement(name="joda_datetime")
public class XmlDateTime {

    @XmlElement(name="millis") public long millis;

    public XmlDateTime() {};

    public XmlDateTime(long millis) { this.millis = millis; }   

} 
```

如果一切按计划进行，则应使用适配器对 DateTime 对象进行编组/解编组；通过在适配器中设置断点来检查这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T22:22:52.560

通过阅读[文档](http://jersey.java.net/nonav/documentation/latest/user-guide.html#d4e101)，您似乎需要让您的方法返回一个字符串，然后将其转换为 DateTime，我想使用[DateTime(long) 构造函数](http://joda-time.sourceforge.net/api-release/org/joda/time/DateTime.html#DateTime%28long%29)，有一个（相对）易于遵循的[示例在 codehale](http://codahale.com/what-makes-jersey-interesting-injection-providers/)，如果您希望我尝试一下，请告诉我。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-22T08:12:00.897

@Gili，对不起，我没有直接评论您的帖子所需的声誉，但请您：

*   添加用于您的实施的导入语句？
*   添加一个如何将所有内容与 Guice 绑定的示例？

非常感谢您提前。

M。

* * *

**问题**：

我有兴趣做和 HolySamosa 一样的事情，我也使用 Guice，但我面临以下问题。

如果我添加：

```
bind(DateTimeInjector.class); 
```

在我的`GuiceServletContextListener`，我得到：

```
java.lang.RuntimeException: 
The scope of the component class com.foo.mapping.DateTimeInjector must be a singleton 
```

如果我添加`@Singleton`课程`DateTimeInjector`，我会得到：

```
GRAVE: The following errors and warnings have been detected with resource and/or provider classes:
SEVERE: Missing dependency for method public java.util.List com.foo.ThingService.getThingByIdAndDate(java.lang.String,org.joda.time.DateTime) at parameter at index 1
SEVERE: Method, public java.util.List com.foo.ThingService.getThingByIdAndDate(java.lang.String,org.joda.time.DateTime), annotated with GET of resource, class com.foo.ThingService, is not recognized as valid resource method. 
```

* * *

**建议/解决方案**：

*   注意你使用的注释（不像我）！例如，我实际上是在使用`@PathParam`而不是`@QueryParam`.
*   在您的服务中，您不需要`UriInfo uriInfo`在方法中拥有签名。`UriInfo`仅功能参数就足够了，无论是否存在，它都应该起作用。
*   Guice 需要配置以下内容才能拾取注射器。

例子：

```
// Configure Jersey with Guice:
Map<String, String> settings = new HashMap<String, String>();
settings.put(PackagesResourceConfig.PROPERTY_PACKAGES, "com.foo.mapping");
serve("/*").with(GuiceContainer.class, settings); 
```

* * *

**完整解决方案**：

```
import java.util.List;

import javax.ws.rs.PathParam;
import javax.ws.rs.WebApplicationException;
import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.Status;
import javax.ws.rs.core.UriInfo;
import javax.ws.rs.ext.Provider;

import org.joda.time.DateTime;

import com.google.inject.Inject;
import com.foo.utils.DateTimeAdapter;
import com.sun.jersey.core.spi.component.ComponentContext;
import com.sun.jersey.spi.inject.Injectable;
import com.sun.jersey.spi.inject.PerRequestTypeInjectableProvider;

/**
 * Enables DateTime to be used as a PathParam.
 */
@Provider
public class DateTimeInjector extends PerRequestTypeInjectableProvider<PathParam, DateTime> {
    private final com.google.inject.Provider<UriInfo> uriInfo;

    /**
     * Creates a new DateTimeInjector.
     * 
     * @param uriInfo
     *            an instance of {@link UriInfo}
     */
    @Inject
    public DateTimeInjector(com.google.inject.Provider<UriInfo> uriInfo) {
        super(DateTime.class);
        this.uriInfo = uriInfo;
    }

    @Override
    public Injectable<DateTime> getInjectable(final ComponentContext context, final PathParam annotation) {
        return new Injectable<DateTime>() {
            @Override
            public DateTime getValue() {
                final List<String> values = uriInfo.get().getPathParameters().get(annotation.value());

                if (values == null) {
                    throwInternalServerError(annotation);
                }

                if (values.size() > 1) {
                    throwBadRequestTooManyValues(annotation);
                }

                if (values.isEmpty()) {
                    throwBadRequestMissingValue(annotation);
                }

                return parseDate(annotation, values);
            }

            private void throwInternalServerError(final PathParam annotation) {
                String errorMessage = String.format("Failed to extract parameter [%s] using [%s]. This is likely to be an implementation error.",
                        annotation.value(), annotation.annotationType().getName());
                throw new WebApplicationException(Response.status(Status.INTERNAL_SERVER_ERROR).entity(errorMessage).build());
            }

            private void throwBadRequestTooManyValues(final PathParam annotation) {
                String errorMessage = String.format("Parameter [%s] must only contain one single value.", annotation.value());
                throw new WebApplicationException(Response.status(Status.BAD_REQUEST).entity(errorMessage).build());
            }

            private void throwBadRequestMissingValue(final PathParam annotation) {
                String errorMessage = String.format("Parameter [%s] must be provided.", annotation.value());
                throw new WebApplicationException(Response.status(Status.BAD_REQUEST).entity(errorMessage).build());
            }

            private DateTime parseDate(final PathParam annotation, final List<String> values) {
                try {
                    return DateTimeAdapter.parse(values.get(0));
                } catch (Exception e) {
                    String errorMessage = String.format("Parameter [%s] is formatted incorrectly: %s", annotation.value(), e.getMessage());
                    throw new WebApplicationException(Response.status(Status.BAD_REQUEST).entity(errorMessage).build());
                }
            }

        };
    }
} 
```

# struct - 将带有数组的结构数组加载到 cuda

> ID：13482914
> 
> 赞同：1
> 
> 时间：2012-11-20T21:57:13.677
> 
> 标签：struct, cuda

我正在尝试创建一个内部包含数组的数组结构并将它们加载到 GPU 上。我想我按照步骤正确地做到了这一点。

1.  使用 malloc 在 CPU 上创建一个结构。
2.  `cudamalloc`数组到结构。
3.  使用 cudamalloc 在 GPU 上创建结构
4.  将 CPU 结构复制到 GPU 结构上。

当我运行此代码时，只要我不更改`p[i].c[0]`内核函数中的值，它就会正常工作。如果我删除该行`p[i].c[0] = 3.3;`，那么它会输出预期的结果。当我保持原样时，它会为所有值输出随机数。我希望能够使用内核函数更新数组中的值。

有什么问题？

这是我的代码：

```
#include <stdio.h>
#include <cuda_runtime.h>
#include <iostream>
#include <fstream>
#include <sstream>
#include <cstdio>
#include <fcntl.h>
#include <unistd.h>
#include <assert.h>
#include <omp.h>
#include <vector>
#include <sys/time.h>

    float cData[]
                {
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7,
                        8,
                        9,
                        10,
                        11,
                        12,
                        13,
                        14,
                        15,
                        16
                };
    float dData[]
                {
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7,
                        8,
                        9,
                        10,
                        11,
                        12,
                        13,
                        14,
                        15,
                        16
                };

    typedef struct
            {
                float a, b;
                float* c;
                float* d;
            } point;

__global__ void testKernel(point *p){
    int i = blockIdx.x * blockDim.x + threadIdx.x;
    p[i].a = 1.1;
    p[i].b = 2.2;
    p[i].c[0] = 3.3;
}

void checkerror(cudaError_t error, char* descrp){
    if (error != 0){

        printf("%s error code: %d \n", descrp, error);
    }

}

extern "C" int main()
{
    printf("starting gpuCode\n");
    int *dev_a;
            // set number of points
        int numPoints    = 16,
            gpuBlockSize = 4,
            pointSize    = sizeof(point),
            numBytes     = numPoints * pointSize,
            gpuGridSize  = numPoints / gpuBlockSize;
    cudaError_t err = cudaSuccess;
    printf("initialized variables\n");
            // allocate memory
        point *cpuPointArray,
              *gpuPointArray,
              *outPointArray;
        cpuPointArray = (point*)malloc(numBytes);  //create the cpuPointArray struct on the cpu
        outPointArray = (point*)malloc(numBytes);  //create the outPointArray struct on the cpu
        printf("load cpuPointArray struct with default values\n");

        for (int k=0; k<16; k++){
            err = cudaMalloc( (void**)&cpuPointArray[k].c, 16*sizeof(float) );
            checkerror(err, "assigning cuda pointer c");
            err = cudaMalloc( (void**)&cpuPointArray[k].d, 16*sizeof(float) );
            checkerror(err, "assigning cuda pointer d");
            cpuPointArray[k].a = 16;
            cpuPointArray[k].b = 16;
        }

        for (int k=0; k<16; k++){
            printf("top loop %d\n", k);
            err = cudaMemcpy(cpuPointArray[k].c, cData, 16*sizeof(float), cudaMemcpyHostToDevice);
            printf("after cdata\n");
            checkerror(err, "copying cdata to gpu array c" );
            err = cudaMemcpy(cpuPointArray[k].d, dData, 16*sizeof(float), cudaMemcpyHostToDevice);
            printf("after ddata\n");
            checkerror(err, "copying ddata to gpu array d");
            printf("bottom of loop %d\n", k);
        }

        err = cudaMalloc((void**)&gpuPointArray, numBytes);  //allocate memory on the gpu for the cpu point array
        checkerror(err, "allocating memory for gpuPointArray");
        err = cudaMemcpy(gpuPointArray,cpuPointArray,sizeof(cpuPointArray), cudaMemcpyHostToDevice); //copy the cpu point array onto the gpu
        checkerror(err, "copying cpuPointArray to gpuPointArray");

        printf("loaded the struct into the kernel\n");

        for(int i = 0; i < numPoints; ++i)
                {
                    printf("point.a: %f, point.b: %f ************************\n",cpuPointArray[i].a,cpuPointArray[i].b);

                        printf("cuda mem location point.c: %d point.d: %d\n",&cpuPointArray[i].c, &cpuPointArray[i].d);

                }

            // launch kernel
        testKernel<<<gpuGridSize,gpuBlockSize>>>(gpuPointArray);

        printf("returned the struct from the kernel\n");
        err = cudaMemcpy(outPointArray,gpuPointArray,numBytes, cudaMemcpyDeviceToHost);
        checkerror(err, "copying gpuPointArray to cpuPointArray");
        printf("after gpu copy to cpu\n");
        for (int k=0; k<16; k++){
            printf("creating memory on cpu for array c\n");
            outPointArray[k].c = (float*)malloc(16*sizeof(float));
            printf("creating memory on cpu for array d\n");
            outPointArray[k].d = (float*)malloc(16*sizeof(float));
            printf("copying memory values onto cpu array c\n");
            err = cudaMemcpy(outPointArray[k].c, cpuPointArray[k].c, 16*sizeof(float), cudaMemcpyDeviceToHost);
            checkerror(err, "copy array c from gpu to cpu");
            printf("copying memory values onto cpu array c\n");
            err = cudaMemcpy(outPointArray[k].d, cpuPointArray[k].d, 16*sizeof(float), cudaMemcpyDeviceToHost);
            checkerror(err, "copy array d from gpu to cpu");
            printf("bottom of loop %d\n", k);
        }

            // retrieve the results

        printf("testKernel results:\n");
        for(int i = 0; i < numPoints; ++i)
        {
            printf("point.a: %f, point.b: %f ************************\n",outPointArray[i].a,outPointArray[i].b);
            for (int j=0; j<16; j++){
                printf("point.c: %f point.d: %f\n",outPointArray[i].c[j], outPointArray[i].d[j]);
            }
        }

            // deallocate memory
        free(cpuPointArray);
        cudaFree(gpuPointArray);

        return 0;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:57:55.913

似乎您可能错误地将结构数组复制到设备。尝试改变：

```
err = cudaMemcpy(gpuPointArray,cpuPointArray,sizeof(cpuPointArray), cudaMemcpyHostToDevice); 
```

成为

```
err = cudaMemcpy(gpuPointArray,cpuPointArray,numBytes, cudaMemcpyHostToDevice); 
```

因为 cpuPointArray 的类型是 point*，所以 sizeof(cpuPointArray) 实际上会返回机器上指针的大小。你想要的是整个结构数组的大小。事实上，从设备复制回来时，您甚至看起来都正确地执行了以下操作：

```
err = cudaMemcpy(outPointArray,gpuPointArray,numBytes, cudaMemcpyDeviceToHost); 
```

希望有帮助！

# sql - 查找忽略重叠的总分钟数（将基于光标的答案转换为 CTE）

> ID：13482921
> 
> 赞同：3
> 
> 时间：2012-11-20T21:57:52.013
> 
> 标签：sql, sql-server, sql-server-2008

有一个[现有问题](https://stackoverflow.com/questions/13464281/sum-of-minutes-between-multiple-date-ranges)询问如何在忽略重叠的情况下查找多个日期范围内的分钟数。

给出的示例数据是（用户 ID 不是特别相关）

```
--Available--
ID  userID  availStart          availEnd
1   456     '2012-11-19 16:00'  '2012-11-19 17:00'
2   456     '2012-11-19 16:00'  '2012-11-19 16:50'
3   456     '2012-11-19 18:00'  '2012-11-19 18:30'
4   456     '2012-11-19 17:30'  '2012-11-19 18:10'
5   456     '2012-11-19 16:00'  '2012-11-19 17:10'
6   456     '2012-11-19 16:00'  '2012-11-19 16:50' 
```

我可以使用游标解决问题，但我认为它应该适用于 CTE，但我不知道该怎么做。

方法是按开始时间排列每个范围然后我们构建一个按顺序合并范围的范围，直到找到一个不与我们合并的范围重叠的范围。然后我们计算在合并范围内有多少分钟，并记住这一点 我们继续下一个范围，再次合并任何重叠的范围。每次我们得到一个不重叠的起点时，我们都会累积分钟最后我们将累积的分钟添加到最后一个范围的长度上

很容易看出，由于顺序的原因，一旦一个范围与之前的范围不同，那么没有更多的范围可以与之前的范围重叠，因为它们的开始日期都更大。

```
Declare
  @UserID int = 456,
  @CurStart datetime, -- our current coalesced range start
  @CurEnd datetime, -- our current coalesced range end
  @AvailStart datetime, -- start or range for our next row of data
  @AvailEnd datetime, -- end of range for our next row of data
  @AccumMinutes int = 0 -- how many minutes so far accumulated by distinct ranges

Declare MinCursor Cursor Fast_Forward For
Select
  AvailStart, AvailEnd
From
  dbo.Available
Where
  UserID = @UserID
Order By
  AvailStart

Open MinCursor

Fetch Next From MinCursor Into @AvailStart, @AvailEnd
Set @CurStart = @AvailStart
Set @CurEnd = @AvailEnd

While @@Fetch_Status = 0
Begin
  If @AvailStart <= @CurEnd -- Ranges Overlap, so coalesce and continue
    Begin
    If @AvailEnd > @CurEnd 
      Set @CurEnd = @AvailEnd
    End
  Else -- Distinct range, coalesce minutes from previous range
  Begin
    Set @AccumMinutes = @AccumMinutes + DateDiff(Minute, @CurStart, @CurEnd)
    Set @CurStart = @AvailStart -- Start coalescing a new range
    Set @CurEnd = @AvailEnd
  End
  Fetch Next From MinCursor Into @AvailStart, @AvailEnd
End

Select @AccumMinutes + DateDiff(Minute, @CurStart, @CurEnd) As TotalMinutes

Close MinCursor
Deallocate MinCursor; 
```

让 CTE 工作，只是递归中的一个愚蠢的错误。查询计划的爆炸式增长令人印象深刻：

```
With OrderedRanges as (
  Select
    Row_Number() Over (Partition By UserID Order By AvailStart) AS RN,
    AvailStart,
    AvailEnd
  From
    dbo.Available
  Where
    UserID = 456
),
AccumulateMinutes (RN, Accum, CurStart, CurEnd) as (
  Select
    RN, 0, AvailStart, AvailEnd
  From
    OrderedRanges
  Where 
    RN = 1
  Union All
  Select
    o.RN, 
    a.Accum + Case When o.AvailStart <= a.CurEnd Then
        0
      Else 
        DateDiff(Minute, a.CurStart, a.CurEnd)
      End,
    Case When o.AvailStart <= a.CurEnd Then 
        a.CurStart
      Else
        o.AvailStart
      End,
    Case When o.AvailStart <= a.CurEnd Then
        Case When a.CurEnd > o.AvailEnd Then a.CurEnd Else o.AvailEnd End
      Else
        o.AvailEnd
      End
  From
    AccumulateMinutes a
        Inner Join 
    OrderedRanges o On 
        a.RN = o.RN - 1
)

Select Max(Accum + datediff(Minute, CurStart, CurEnd)) From AccumulateMinutes 
```

这是否适用于 CTE，是否有一种以这种方式累积列表的通用模式？

[http://sqlfiddle.com/#!6/ac021/2](http://sqlfiddle.com/#!6/ac021/2)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T22:54:52.830

以下查询根据您的定义查找数据中的句点。它首先使用相关子查询来确定一条记录是否是一个时期的开始（即，与较早的时期没有重叠）。然后它将“periodStart”指定为最近的开始，即非重叠时段的开始。

以下（未经测试的）查询采用这种方法：

```
with TimeWithOverlap as (
     select t.*,
            (case when exists (select * from dbo.Available tbefore where t.availStart > tbefore.availStart and tbefore.availEnd >= t.availStart)
                  then 0
                  else 1
             end) as IsPeriodStart
     from dbo.Available t 
    ),
    TimeWithPeriodStart as (
     select two.*,
            (select MAX(two1.AvailStart) from TimeWithOverlap two1 where IsPeriodStart = 1 and two1.AvailStart <= two.AvailStart
            ) as periodStart
     from TimeWithOverlap two
    )
select periodStart, MAX(AvailEnd) as periodEnd
from TimeWithPeriodStart twps
group by periodStart; 
```

[http://sqlfiddle.com/#!6/3483c/20](http://sqlfiddle.com/#!6/3483c/20)（第二次查询）

如果两个时段同时开始，那么它仍然有效，因为 AvailStart 值相同。由于相关的子查询，即使在中等大小的数据集上也可能表现不佳。

还有其他方法可以解决这个问题。例如，如果您有 SQL Server 2012，您将能够使用累积求和函数，它提供了一种更简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:37:24.977

我通过创建一个愚蠢的表（在某种程度上）非常有效地解决了这个问题，该表在一列（PK）中具有日期和时间（精确到分钟），而在第二列中则有一点。“1”表示用户可用，0 表示他/她不可用。

剩下的就很简单了。我厌倦了不得不编写无休止的复杂查询来尝试在部分重叠的时间范围内获取分钟数。

事实上，这是为了计算机的效率。

我知道这不是真正的交易，而是我想出的最简单的解决方案。您可以创建一个创建该表的函数/SP..

# ruby-on-rails - 使用 curl 返回状态码 500 测试创建资源

> ID：13482922
> 
> 赞同：0
> 
> 时间：2012-11-20T21:57:57.550
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rest, curl

我正在使用 curl 手动测试 Rails 3 的 Api 创建操作，但我不断收到`Internal server error(500)`. 我有一个产品模型，这是我的控制器中的创建操作和我尝试过的命令......

```
#command
curl -i -H "Accept: application/json"  -X POST -d "product[product_name]=dvd"  http://localhost:3000/api/products  

#controller
module Api  
  class ProductsController < ApplicationController
    respond_to :json

     def create
       @product = Product.new(params[:product])
       respond_to do |format|
         if @product.save
           format.html { redirect_to @product, notice: 'Product was successfully created.' }
           format.json { render json: @product, status: :created, location: @product }
         else
           format.html { render action: "new" }
           format.json { render json: @product.errors, status: :unprocessable_entity }
         end
       end
     end
   end
 end 
```

我在这里想念什么？先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:39:20.720

根据 MassAssignmentSecurity 错误，您似乎只需要使您的模型上的 product_name 字段可访问：

```
class Product < ActiveRecord::Base
  attr_accessible :product_name
  #... other code...
end 
```

# c++ - CDT Visual C++ 支持错误

> ID：13482927
> 
> 赞同：2
> 
> 时间：2012-11-20T21:58:17.997
> 
> 标签：c++, eclipse, eclipse-cdt

我已经安装了 CDT Visual c++ 支持插件。然后我使用工具链 Microsoft Visual C++ 创建了 Hello world c++ 项目，但出现了一些错误。其中之一是`Unresolved inclusion: <iostream>`。我在设置中找不到有关工具链的任何选项。如何在 cdt 中设置工具链以及如何使用 CDT Visual C++ 支持？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T09:08:50.867

您的问题非常清楚，您可以放心地忽略那些无用的无知评论。同样的事情发生在我身上。

你需要：

1.  Visual C++ 编译器 (cl.exe) 作为 Visual Studio 分发的一部分安装。该插件仍然是一个“测试版”插件，不会取代 Visual Studio。相反，它只知道使用正确的参数调用 Visual C++ 编译器 (cl.exe)
2.  运行 Visual Studio 命令提示符并将 PATH、INCLUDE、LIB 和 LIBPATH 复制到 eclipse 中 C++ 项目的环境部分。通过在命令提示符中键入“set”并复制相应的四个环境变量来执行此操作。

右键单击您的 C++ 项目 | **属性 | C++ Build**（或与 Build 相关的东西）| **环境**，添加这些。这是在 64 位上运行 Visual Studio 2010 的机器上：

```
PATH
C:\Program Files (x86)\Microsoft Visual Studio 10.0\VSTSDB\Deploy;C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\;C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\BIN;C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\Tools;C:\Windows\Microsoft.NET\Framework\v4.0.30319;C:\Windows\Microsoft.NET\Framework\v3.5;C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\VCPackages;C:\Program Files (x86)\HTML Help Workshop;C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools;C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin;

INCLUDE
C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\INCLUDE;C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\ATLMFC\INCLUDE;C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\include;

LIB
C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\LIB;C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\ATLMFC\LIB;C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib;

LIBPATH
C:\Windows\Microsoft.NET\Framework\v4.0.30319;C:\Windows\Microsoft.NET\Framework\v3.5;C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\LIB;C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\ATLMFC\LIB; 
```

# php - 从主表mysql中删除重复记录

> ID：13482928
> 
> 赞同：3
> 
> 时间：2012-11-20T21:58:20.993
> 
> 标签：php, mysql

我有 2 个 mySQL 表（表 Master 和表 Backup）有些行被复制到备份表，有些则没有......

现在我需要从主表中删除所有行，这些行在备份表中可用单个查询，因为大约。两个表中都有 700k+ 行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:00:26.983

就像是：

```
DELETE FROM master_table WHERE id IN (SELECT id FROM backup_table) 
```

当然，它需要 id 字段上的唯一键才能工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:19:20.357

我建议这样做：

```
DELETE m
FROM master_table m
JOIN backup_table b ON b.id = m.id 
```

`IN`对这么多行使用子句必然会出现性能问题。

# node.js - 在nodejs express中的ejs模板内渲染图像

> ID：13482932
> 
> 赞同：1
> 
> 时间：2012-11-20T21:58:35.897
> 
> 标签：node.js, express, ejs

我正在尝试在 ejs 模板中渲染图像。我正在这样做：

```
var pic = "./public/images/"+collection_id+"/"+photo_id+".png";
var comments = "bla bla bla";
res.render('index', { title: 'Viewer' , pic: pic , comments: comments } ); 
```

在我的 .ejs 里面

```
<img src='<%= pic %>' /> 
```

然而，我发现真正的要求是

```
GET /collection/1/photo/public/images/1/1.png 404 1ms 
```

其中 /collection/1/photo/1 是我要路由的 URL

我该怎么做才能在模板内渲染图像？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2016-04-28T00:08:51.093

不是积极的，但我相信 express 使用“express.static”术语来识别 HTML、图像和图标等静态内容的根源。你有没有在你的根 js 文件中设置这个术语……比如：

```
 app.use(express.static(__dirname + '/public')); 
```

在此示例中，您的静态内容植根于公共目录，而您的图像目录位于“公共”目录中。

# css - 如何关闭相对定位？

> ID：13482936
> 
> 赞同：13
> 
> 时间：2012-11-20T21:58:56.653
> 
> 标签：css, wordpress

[http://mikroautobusunuoma.org/](http://mikroautobusunuoma.org/)

页面上滑块的位置在所有 3 个主要浏览器中都被搞砸了。通过关闭“位置：相对”（元素样式）似乎解决了这个问题（在 Firebug 等中）我已经搜索了服务器上的每个文件，但找不到元素样式的位置。我使用 Agent Ransack 搜索多个术语以尝试找到代码行，但无济于事。

我迷失了从这里去哪里。

这是一个带有内置主题 Jquery Slider 的 wordpress 站点。

```
 <div id="featured-slider" style="background-image: none; position: relative; overflow: hidden;">

    element.style {
       background-image: none;
       overflow: hidden;
       position: relative;
    } 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-11-20T22:00:00.067

做`position:static !important;`

这将覆盖任何现有的 CSS 和内联样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:05:47.073

Element.style 是内联样式。

如果添加`!important`它将覆盖内联样式，但您需要知道类/ID，除非您可以更改内联样式。

# html - 如何使菜单栏固定，使其在滚动时不会移动

> ID：13482941
> 
> 赞同：4
> 
> 时间：2012-11-20T21:59:24.357
> 
> 标签：html, css

我有三个问题：

1.  当我将鼠标悬停在它们上时，我希望我的菜单链接为“粗体”，但是当我这样做时，它会使右侧的项目略微移动，我怎样才能阻止它们移动？

2.  “Two”上的下拉菜单，如何使项目直接排列在“Two”下方，具有适当的间距，并且具有相同宽度的背景，尽管这两个项目的字符数量不同？

3.  我可以做些什么来固定菜单栏，以便当我向下滚动时，它在页面顶部仍然可见？我尝试添加“位置：固定”，但这只是把它搞砸了..

非常感谢任何帮助，谢谢！

```
<head>
    <title>Untitled</title>
</head>

<body>
    <div id="wrap">
    <div id="menu">
        <ul>
            <li><a href="#">One</a></li>
            <li><a href="#">Two</a>
                <ul>
                    <li><a href="#">Six</a></li>
                    <li><a href="#">Seven</a></li>
                </ul></li> 
                        <li><a href="#">Three</a></li>
            <li><a href="#">Four</a></li>
            <li><a href="#">Five</a></li>
        </ul>
    </div>
    <div id="middle"></div>     
    <div id="footer"></div>
    </div>
</body> 
```

我无法弄清楚如何将 css 粘贴到这里而不让它变得乱码所以这里是样式表的链接：[https ://dl.dropbox.com/u/14754850/stylesheet.css](https://dl.dropbox.com/u/14754850/stylesheet.css)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:34:51.277

以下是您第一个问题的答案：

**1)**

```
#menu ul li {
   ...
   width: 90px; /* Give items fixed size */
} 
```

**2)**

```
#menu ul li ul li {
   background-color: #2d2d2d; /* Add background */ 
}

#menu ul li ul li:last-child {
   padding-bottom: 10px; /* Dirty fix for last menu item */
} 
```

**添加：**

```
#menu ul li ul li a {
   padding-bottom: 0px; /* Makes drop down items more compact */
}

#menu ul li a { 
   ...
   padding: 10px 20px 10px 20px; /* Give menu headers some spacing */
   ... 
} 

#menu ul {
   padding: 0; /* Fix left space */
} 
```

试试看：http: [//jsfiddle.net/uYTnf/3/](http://jsfiddle.net/uYTnf/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:10:58.140

首先将菜单 div 放在 wrap div 之外。这样你就没有任何奇怪的事情发生在 position: fixed 上。

1.  不幸的是，使用 width: auto 你无法控制你看到的“推动”。您需要为列表项提供固定值（无论是百分比还是像素值）。百分比是首选，因为它允许响应式设计。

2.  确保背景颜色应用于 ul 元素而不是 li 元素。此外，使用 text-align: center 使它们保持美观和居中。

3.  定位：固定是正确的！只需确保设置 top: 0 和 left: 0 ，这样栏就不会在不同的浏览器上做任何时髦的事情。此外，您在主容器的顶部和底部都有填充物，以防止栏完全位于顶部。

[这是](http://jsfiddle.net/y7SAX/3/)`#menu li:hover ul`更改和`#menu ul li ul li`添加的小提琴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:37:33.433

如果这会有所帮助，这就是小提琴

[http://jsfiddle.net/squinny/tJZ25/1/](http://jsfiddle.net/squinny/tJZ25/1/)

在 ul li 上，我只是将 with 设置为 width: 100px;

```
 #menu ul li {
    text-decoration: none;
    display: inline;
    position: relative;
    float:left;
    width: 100px;

     } 
```

# bash - 每个单词单独一行

> ID：13482943
> 
> 赞同：17
> 
> 时间：2012-11-20T21:59:25.580
> 
> 标签：bash, shell

我有一句话像

> 这是例如

我想将其写入文件，以便将这句话中的每个单词写入单独的行。

如何在 shell 脚本中做到这一点？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-20T22:08:07.210

几种方法，选择你最喜欢的！

```
echo "This is for example" | tr ' ' '\n' > example.txt 
```

或者干脆这样做以避免`echo`不必要地使用：

```
tr ' ' '\n' <<< "This is for example" > example.txt 
```

该`<<<`表示法与[此处字符串一起使用](http://en.wikipedia.org/wiki/Here_document)

或者，使用`sed`代替`tr`：

```
sed "s/ /\n/g" <<< "This is for example" > example.txt 
```

如需更多选择，请查看其他人的答案 =)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-10-25T17:32:02.427

```
$ echo "This is for example" | xargs -n1
This
is
for
example 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-20T22:01:20.750

尝试使用：

```
string="This is for example"

printf '%s\n' $string > filename.txt 
```

或利用[bash](/questions/tagged/bash "显示标记为“bash”的问题") *分词*

```
string="This is for example"

for word in $string; do
    echo "$word"
done > filename.txt 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-20T22:02:52.883

```
example="This is for example"
printf "%s\n" $example 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-21T05:41:28.147

尝试使用：

```
str="This is for example"
echo -e ${str// /\\n} > file.out 
```

*输出*

```
> cat file.out 
This
is
for
example 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-08-12T22:09:54.430

使用`fmt`命令

```
>> echo "This is for example" | fmt -w1 > textfile.txt ; cat textfile.txt
This
is
for
example 
```

有关`fmt`其选项的完整描述，请查看[相关的手册页](https://www.unix.com/man-page/plan9/1/fmt/)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-07-22T18:47:56.670

### 注意我在几个草稿中写了这个，简化了正则表达式，所以如果有任何不一致，这可能就是原因。

你在乎标点符号吗？例如，在某些调用中，您会看到如*(etc)*之类的“单词” ，与括号完全相同。或者这个词是“括号”。而不是“括号”。如果您正在解析带有正确句子的文件，这可能是一个问题，尤其是如果您想按单词排序甚至获取每个单词的字数。

有一些方法可以解决这个问题，但有一些警告，当然还有改进的余地。这些恰好与数字、破折号（以数字表示）和小数点/点（以数字表示）有关。也许有一套确切的规则会帮助解决这个问题，但下面的例子可以给你一些工作要做。我制作了一些人为的输入示例来演示这些缺陷（或任何你想称它们的名称）。

```
$ echo "This is an example sentence with punctuation marks and digits i.e. , . ; \! 7 8 9" | grep -o -E '\<[A-Za-z0-9.]*\>'
This
is
an
example
sentence
with
punctuation
marks
and
digits
i.e
7
8
9 
```

如您所见，*ie`*原来只是*ie*，否则标点符号不会显示。好的，但这忽略了诸如 major.minor.revision-release 形式的版本号之类的东西，例如*0.0.1-1*；这也可以显示吗？是的：

```
$ echo "The current version is 0.0.1-1\. The previous version was current from 2017-2018."|grep -o -E '\<[-A-Za-z0-9.]*\>'
The
current
version
is
0.0.1-1
The
previous
version
was
current
from
2017-2018 
```

注意句子不以句号结尾。如果在年份和破折号之间添加一个空格会发生什么？你不会有破折号，但每年都会有自己的路线：

```
$ echo "2017 - 2018" | grep -o -E '\<[-A-Za-z0-9.]*\>'
2017
2018 
```

那么问题就变成了您是否希望`-`自己被计算在内；由于分隔单词的性质，如果有空格，您将不会将年份作为单个字符串。因为它本身不是一个词，我不认为。

我相信这些可以进一步简化。此外，如果您根本不需要任何标点符号或数字，您可以将其更改为：

```
$ echo "The current version is 0.0.1-1\. The previous version was current from 2017-2018."|grep -o -E '\<[A-Za-z]*\>'
The
current
version
is
The
previous
version
was
current
from 
```

如果您想获得数字：

```
$ echo "The current version is 0.0.1-1\. The previous version was current from 2017-2018."|grep -o -E '\<[A-Za-z0-9]*\>'
The
current
version
is
0
0
1
1
The
previous
version
was
current
from
2017
2018 
```

至于带有字母和数字的“单词”，这是另一件可能会或可能不会考虑但证明上述内容的事情：

```
$ echo "The current version is 0.0.1-1\. test1."|grep -o -E '\<[A-Za-z0-9]*\>'
The
current
version
is
0
0
1
1
test1 
```

输出它们。但以下没有（因为它根本不考虑数字）：

```
$ echo "The current version is 0.0.1-1\. test1."|grep -o -E '\<[A-Za-z]*\>'
The
current
version
is 
```

忽略标点符号很容易，但在某些情况下可能需要或渴望它们。在*eg*的情况下，我想您可以使用 say sed 将行更改为*eg*到*eg*，但我猜这将是个人喜好。

我可以总结一下它是如何工作的，但只是；我太累了，甚至无法考虑太多：

## 它是如何工作的？

我将只解释调用`grep -o -E '\<[-A-Za-z0-9.]*\>'`，但其他调用大部分是相同的（扩展 grep 中的竖线/竖线符号允许多个模式）：

该*`-o`*选项仅用于打印匹配项而不是整行。*`-E`*用于扩展 grep（也可以使用 egrep）。至于正则表达式本身：

和是单词边界（分别是开始和结束 - 如果需要，您可以只指定一个）`<\`；`\>`我相信该`-w`选项与指定两者相同，但调用可能有点不同（我实际上不知道）。

表示破折号、`'\<[-A-Za-z0-9.]*\>'`大小写字母和点零次或多次。至于为什么会变成*eg*到*.eg*这个时候我只能说是模式，但我没有能力去考虑更多。

## 词频计数的奖励脚本

```
#!/bin/bash

if [ $# -eq 0 ]; then
    echo "Usage: $(basename ${0}) <FILE> [FILE...]"
    exit 1
fi

for file do
    if [ -e "${file}" ]
    then
        echo "** ${file}: "
        grep -o -E '\<[-A-Za-z0-9.]*\>' "${file}"|sort | uniq -c | sort -rn
    else
    echo >&2 "${1}: file not found"
    continue
    fi
done 
```

例子：

```
$ cat example 
The current version is 0.0.1-1 but the previous version was non-existent.

This sentence contains an abbreviation i.e. e.g. (so actually two abbreviations).

This sentence has no numbers and no punctuation  
$ ./wordfreq example 
** example: 
   2 version
   2 sentence
   2 no
   2 This
   1 was
   1 two
   1 the
   1 so
   1 punctuation
   1 previous
   1 numbers
   1 non-existent
   1 is
   1 i.e
   1 has
   1 e.g
   1 current
   1 contains
   1 but
   1 and
   1 an
   1 actually
   1 abbreviations
   1 abbreviation
   1 The
   1 0.0.1-1 
```

注意，我没有将大写字母转写为小写字母，因此“The”和“the”这两个词显示为不同的词。如果您希望它们全部为小写，您可以在排序之前将脚本中的 grep 调用更改为管道：

```
 grep -o -E '\<[-A-Za-z0-9.]*\>' "${file}"|tr '[A-Z]' '[a-z]'|sort | uniq -c | sort -rn 
```

哦，既然您问是否要将其写入文件，您只需添加到命令行（这是用于原始调用）：

```
> output_file 
```

对于脚本，您可以像这样使用它：

```
$ ./wordfreq file1 file2 file3 > output_file 
```

# android - 使用位图工厂选项支持多个屏幕？

> ID：13482946
> 
> 赞同：1
> 
> 时间：2012-11-20T21:59:40.253
> 
> 标签：android, android-emulator, module, screen, bitmapfactory

**编辑一：**

*根据约瑟夫的回答所做的更改：*

在 bytesToDrawable(byte[] imageBytes) 中：

更改了以下内容：使用 BitmapDrawable(Resources res, Bitmap bitmap) 而不是 BitmapDrawable(Bitmap bitmap)：

```
return new BitmapDrawable(ApplicationConstants.ref_currentActivity.getResources(),BitmapFactory.decodeByteArray(imageBytes, 0, imageBytes.length, options)); 
```

**这是该更改的结果：略有不同的问题：**

![在此处输入图像描述](../Images/5650f66e809683450a0afe69711beb36.png)

**问题：**

如果我将新的构造函数用于可绘制位图并缩放图像以达到所需的目标密度，我还需要使用我的 calculateSampleSize 方法吗？

* * *

**原始问题：**

嗨朋友们，

我的应用程序是基于模块的，因此特定于该模块的图像仅从包含它们的 jar(module) 加载，而不是从主应用程序加载。

每个模块都有自己的 ModularImageLoader - 它基本上允许我根据在 jar 中找到的图像名称来获取 Drawables。

构造函数接受 zipFile(Module A) 和文件名列表（zip 中以“.png”结尾的任何文件）。

**进行的研究：**

我使用了以下内容：[Link to Developer Page on Loading bitmaps Effectively](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html#read-bitmap)

最初我为每个密度创建大小的图像，但现在我只有一组大小为 96x96 的图像图标。

如果屏幕密度小于 xhdpi，我会加载 96x96 图像的较小采样尺寸 - 36x36（对于 ldpi）、48x48（对于 mdpi）、72x72（对于 hdpi）。否则我只返回 96x96 图像。（查看方法 calculateSampleSize() 和 bytesToDrawable()）

我认为用代码更容易理解这个概念：所以这里是 ModularImageLoader

**代码：**

```
public class ModularImageLoader
{
    public static HashMap<String, Drawable> moduleImages = new HashMap<String, Drawable>();
    public static int reqHeight = 0;
    public static int reqWidth = 0;
    public ModularImageLoader(ZipFile zip, ArrayList<String> fileNames)
    {
         float sdpi = ApplicationConstants.ref_currentActivity.getResources().getDisplayMetrics().density;
         if(sdpi == 0.75)
         {
            reqHeight = 36;
            reqWidth = 36;
         }
         else if(sdpi == 1.0)
         {
            reqHeight = 48;
            reqWidth = 48;
         }
         else if (sdpi == 1.5)
         {
            reqHeight = 72;
            reqWidth = 72;
         }
         else if (sdpi == 2.0)
         {
            reqHeight = 96;
            reqWidth = 96;
          }
          String names = "";
          for(String fileName : fileNames)
          {
            names += fileName + " ";
          }
          createByteArrayImages(zip, fileNames);
     }

public static Drawable findImageByName(String imageName)
{
    Drawable drawableToReturn = null;
    for (Entry<String, Drawable> ent : moduleImages.entrySet())
    {
        if(ent.getKey().equals(imageName))
        {
            drawableToReturn = ent.getValue();
        }
    }
    return drawableToReturn;
}
private static void createByteArrayImages(ZipFile zip, ArrayList<String> fileNames)
{
    InputStream in = null;
    byte [] temp = null;
    int nativeEndBufSize = 0;
    for(String fileName : fileNames)
    {
        try
        {
            in = zip.getInputStream(zip.getEntry(fileName));
            nativeEndBufSize = in.available();
            temp = toByteArray(in,nativeEndBufSize);

            // get rid of .png
            fileName = fileName.replace(".png", "");
            fileName = fileName.replace("Module Images/", "");
            moduleImages.put(fileName, bytesToDrawable(temp));
        }
        catch(Exception e)
        {
            System.out.println("getImageBytes() threw an exception: " + e.toString());
            e.printStackTrace();
        }
    }
    try
    {
        in.close();
    }
    catch (IOException e)
    {
        System.out.println("Unable to close inputStream!");
        e.toString();
        e.printStackTrace();
    }
}
public static byte[] toByteArray(InputStream is, int length) throws IOException 
{
    ByteArrayOutputStream buffer = new ByteArrayOutputStream();
    int l;
    byte[] data = new byte[length];
    while ((l = is.read(data, 0, data.length)) != -1) 
    {
      buffer.write(data, 0, l);
    }
    buffer.flush();
    return buffer.toByteArray();
}
public static Drawable bytesToDrawable(byte[] imageBytes)
{
    try
    {
        BitmapFactory.Options options = new BitmapFactory.Options();
        options.inJustDecodeBounds = true;
        int imageHeight = options.outHeight;
        int imageWidth = options.outWidth;

        BitmapFactory.decodeByteArray(imageBytes, 0, imageBytes.length, options);
        String imageType = options.outMimeType;
        Log.d("ImageInfo : ", "Height:" + imageHeight +",Width:" +imageWidth + ",Type:" + imageType);

        options.inJustDecodeBounds = false;
        //Calculate sample size
        options.inSampleSize = calculateSampleSize(options);
        return new BitmapDrawable(BitmapFactory.decodeByteArray(imageBytes, 0, imageBytes.length, options));
    }
    catch(Exception e)
    {
        Message.errorMessage("Module Loading Error", "The images in this module are too large to load onto cell memory. Please contact your administrator",
                "Source of error: ModularImageLoader - bytesToDrawable method", e.toString());
        return null;
    }
}
public static int calculateSampleSize(BitmapFactory.Options options)
{
    // raw height and width of the image itself
    int sampleSize = 1;
    int height = options.outHeight;
    int width = options.outWidth;
    if(height > reqHeight || width > reqWidth)
    {
        if(width > height)
        {
            sampleSize = Math.round((float)height / (float)reqHeight);
        }
        else
        {
            sampleSize = Math.round((float)width / (float)reqWidth);
        }
    }
    return sampleSize;
}
} 
```

**问题：**

下图显示了 4 个正在运行的模拟器，这些是它们的规格以及我如何在 eclipse AVD 中设置它们：

LDPI：密度 120，皮肤 QVGA MDPI：密度 160，皮肤 HVGA HDPI：密度 240，皮肤 WVGA800 XHDPI：密度 320，皮肤 800x1280

**图像显示问题：**

![在此处输入图像描述](../Images/223d2737c4037f5fd052206df4c20179.png)

**问题：**

根据代码 - 在 XHDPI 窗口中，为什么联系人图像如此之小？新闻图像也是 96x96（除了从主应用程序加载 - 所以它在 res>XHDPI 下）。问题是，我看到它在 MDPI 屏幕和 HDPI 屏幕上加载良好，但对于其他屏幕来说却很奇怪。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T23:54:07.210

如果您使用 BitmapFactory.Options 提供密度信息，BitmapFactory 能够为您缩放图像。如果您这样做，您应该能够删除 ModularImageLoader 中的自定义缩放代码。

指定 inDensity 和 inTargetDensity - 类似于以下内容：

```
BitmapFactory.Options options = new BitmapFactory.Options();
options.inDensity = DisplayMetrics.DENSITY_MEDIUM;
options.inTargetDensity = activityRef.getResources().getDisplayMetrics().densityDpi;
options.inScaled = true;
return BitmapFactory.decodeStream(openByteStream(), null, options); 
```

BitmapFactory.decodeByteArray 中显然存在一个忽略某些缩放选项的错误，因此您可能需要将字节数组包装在 ByteArrayInputStream 中并使用 BitmapFactory.decodeStream ，如上所示（参见[http://code.google.com/p/android /issues/detail?id=7538](http://code.google.com/p/android/issues/detail?id=7538)）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T22:59:37.573

您应该使用`BitmapDrawable(Resources res, Bitmap bitmap)`构造函数来确保可绘制对象的目标密度设置正确，您正在使用的构造函数已被弃用。

如果你看你的`LDPI`屏幕，那里的联系人图像实际上有点太小了，在你的`HDPI`屏幕上有点太小了。只有在`MDPI`屏幕上它看起来完全正确（因为默认目标密度是`MDPI`）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T23:06:23.370

您可以使用创建所需的高度和宽度`dp`，然后将其转换为`px`以获得缩放图像的正确尺寸。

假设您希望图像为 32x32dp。

```
int reqWidth = dpToPx(context, 32);
int reqHeight = dpToPx(context, 32);

public static int dpToPx(Context context, int dp) {
    return (int) (dp * (context.getResources().getDisplayMetrics().densityDpi / 160f) + 0.5f);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T14:39:19.607

**ldpi - 36x36 mdpi - 48x48 hdpi - 72x72 xhdpi - 96x96**

如果这些都是彼此的纯倍数，那就太好了，因为位图工厂以整数处理样本大小，因此样本大小需要是整数（没有尾随小数才能完全准确）。

**解决方案：**

在开始采样之前，我为“每种”屏幕类型准备了 1 张图像，如果该图像处于按下状态，我将拥有 2 张单独的图像。

因此，对于一张图像 - 我实际上在应用程序中需要 4 个，如果该图像具有按下状态 - 一张图像将需要 8 个图像。

我的主要目标是减少图像的数量，这样我就不会超载位图堆分配并可能抛出内存不足异常，当我的位图大小完全合理时，我已经看到为我抛出了这个异常（我相信这与堆上的图像数量以及它们各自的图像大小有关（如果我错了，请纠正我..））我当然想减少我的模块大小。

所以我决定这样做：每张图像有 2 张图像 - 一张尺寸为 72，一张尺寸为 96 - 这样我就有了 xhdpi 和 hdpi 密度的屏幕所需的图标，我可以（简单地）采样到需要时使用 ldpi 和 mdpi。

72/2 = 36 96/2 = 48

这样，每张图像我只有 2 张图像，最坏的情况是，如果该图像具有按下状态，我将有 4 张图像。这将图像大小库减少了近 50%，并使我的模块更小。我注意到模块大小从 525 kb 变为大约 329。

*这确实是我的目标。*

感谢大家的帮助！如果有人有任何问题，请随时发表评论，我会尽快回复您。

# jquery - jquery + json 根据条件生成按钮（真或假）

> ID：13482953
> 
> 赞同：0
> 
> 时间：2012-11-20T22:00:44.900
> 
> 标签：jquery, html, json, button

我的需要是仅当条件为真时才生成具有指定参数的按钮。我该如何检查？正如您在下面看到的，此时按钮是在不检查条件的情况下生成的。请帮助我正确的语法。

json代码：

```
{
    "Caption": "Module caption",
    "IconsDirectory": "C://Images/",
    "Buttons": [
        {
        "Conditions": [
            {
            "ConditionText": "2 == 1",
            "ButtonText": "Text_11",
            "Visible": true,
            "Colors": {
                "FontColor": "#FFFFFF",
                "BGColor": "#669933"
            },
            "BButtonText": {
                "TText": "Textt_1"
            },
            "Size": {
                "Width": 200,
                "Height": 50
            },
            "Icon": {
                "FileName": "Smile.png",
                "Width": 16,
                "Height": 16
            },
            "Url": {
                "UrlAddress": "http://www.google.com",
                "OpenNewWindow": true
            },
            "JavaScriptAction": {
                "TText": "alert('ok1');"
            }},
        {
            "ConditionText": "2 == 2",
            "ButtonText": "Text_22",
            "Visible": true,
            "Colors": {
                "FontColor": "#0FFFFF",
                "BGColor": "#FF9966"
            },
            "BButtonText": {
                "TText": "Textt_1"
            },
            "Size": {
                "Width": 200,
                "Height": 50
            },
            "Icon": {
                "FileName": "Smile.png",
                "Width": 16,
                "Height": 16
            },
            "Url": {
                "UrlAddress": "http://www.google.com",
                "OpenNewWindow": true
            },
            "JavaScriptAction": {
                "TText": "alert('ok2');"
            }}
        ]}
    ]
} 
```

html代码：

```
<!DOCTYPE html>
<html>
<head>
<title>SMButtons</title>
<script src="jquery/jquery-1.4.2.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $.getJSON('weekendtask.json', function(data) {
    var res = ""
    $.each(data.Buttons, function(key, button) {
        $.each(button.Conditions, function(key, condition) {
            res += "<li>"
            res += '<input type="button"' + '" value="' + condition.BButtonText.TText 
            res += '" onclick="' + condition.JavaScriptAction.TText 

            //background color
            res += '" style=" background-color:' + condition.Colors.BGColor 

            //font color
            res += '; color:' + condition.Colors.FontColor 

            res += '"/>'
            res += "<\/li>"
        })
    })
    $(res).appendTo('#ulObj')
});
});
</script>
</head>
<body>
<div>
<ul id='ulObj'>
<li>1</li>
<li>2</li>
<li>3</li>
</ul>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:07:37.307

您可以`Visible`通过执行以下操作检查值：

```
$.each(data.Buttons, function(key, button) {
    $.each(button.Conditions, function(key, condition) {
       // check the visible value
       if (condition.Visible) {
         res += "<li>"
         res += '<input type="button"' + '" value="' + condition.BButtonText.TText 
         res += '" onclick="' + condition.JavaScriptAction.TText 

         //background color
         res += '" style=" background-color:' + condition.Colors.BGColor    

         //font color
         res += '; color:' + condition.Colors.FontColor 

         res += '"/>'
         res += "<\/li>"
       }
    })
}) 
```

# umbraco - Umbraco 4.9.0/1 模板和 Razor 脚本编辑器抛出错误

> ID：13482954
> 
> 赞同：0
> 
> 时间：2012-11-20T22:00:57.980
> 
> 标签：umbraco

我已经从 4.8.1 手动更新到 4.9.0，然后是 4.9.1

我按照手动更新说明进行操作，但在更新到 4.9.0 后，模板和脚本文件编辑器开始抛出错误

```
Cannot create an object of type 'umbraco.uicontrols.CodeArea+EditorType' from its string representation 'HtmlMixed' for the 'CodeBase' property.

Line 226:            </cc1:PropertyPanel>
Line 227:            <cc1:PropertyPanel ID="pp_source" runat="server">
Line 228:                <cc1:CodeArea ID="editorSource" runat="server" CodeBase="HtmlMixed" EditorMimeType="text/html" ClientSaveMethod="doSubmit"
Line 229:                    AutoResize="true" OffSetX="37" OffSetY="54"/>
Line 230:            </cc1:PropertyPanel> 
```

源文件：/umbraco/settings/editTemplate.aspx 行：228

我升级到 4.9.1 是因为媒体部分需要修复，并希望它能神奇地修复这个错误。

对此的任何帮助将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T12:47:49.560

发现controls.dll没有正确复制

# datetime - 如何从 UTCTime 获取秒和毫秒分量？

> ID：13482958
> 
> 赞同：4
> 
> 时间：2012-11-20T22:01:08.623
> 
> 标签：datetime, haskell

换句话说，我正在寻找 Python 的[datetime.utcnow()](https://docs.python.org/3/library/datetime.html#datetime.datetime.utcnow)等价物。

我也可以使用包含年、月等的 n 元组，直到毫秒（或微秒）。

我曾想过使用`show`然后解析该`String`值，但我相信还有更方便的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T22:13:55.173

重新解析一个字符串是非常不友好的，你当然不希望那样。

我会使用，从[`Data.Time.LocalTime`](http://hackage.haskell.org/packages/archive/time/1.4.0.1/doc/html/Data-Time-LocalTime.html#g:2)，

```
todSec . localTimeOfDay . utcToLocalTime utc  ::  UTCTime -> Data.Fixed.Pico 
```

以皮秒分辨率为您提供几秒钟的时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-16T16:32:00.080

从什么时候开始的秒和毫秒？大概有一个纪元（时间为零）隐藏在这里的某个地方。您从 UTCTime 中减去纪元以获得 NominalDiffTime，然后从中提取秒和毫秒。

```
secondsSince :: UTCTime -> UTCTime -> (Integer, Int)
secondsSince t0 t1 = (i, round $ d * 1000)
   where (i, d) = properFraction $ diffUTCTime t1 t0 
```

当然，您可能希望 t0 为 1970 年 1 月 1 日（Unix 纪元），在这种情况下，您导入[Data.Time.Clock.POSIX](https://www.stackage.org/haddock/lts-8.5/time-1.6.0.1/Data-Time-Clock-POSIX.html)并使用 utcTimeToPOSIXSeconds，它返回一个 NominalDiffTime。

NominalDiffTime 是（除其他外）Fractional 和 Num 的一个实例，因此您可以在操作它们时访问所有常用的数字运算符。从算术的角度来看（包括转换），它被视为秒数。

使用它时，请记住 Unix 会从根本上错误地获取时间，因为它没有任何闰秒空间。每隔几年就有一天是 86401 秒，而不是通常的 86400。早在 70 年代，计算机需要知道这一点的想法似乎是荒谬的（时钟通常由系统管理员参考他的机械表来设置），所以Unix time_t 只计算纪元以来的秒数，并假设每天正好有 86400 秒。NominalDiffTime 是“名义上的”，因为它做出了相同的假设。

正确的做法是使 time_t 成为一个结构，其中包含天数和自午夜以来的秒数作为单独的字段，并让时间算术函数查阅闰秒表。然而，这将有其自身的一系列缺点，因为新的闰秒会经常被指定，因此程序在不同时间运行时可能会给出不同的结果。或者用 Haskell 术语来说，“diffUTCTime”必须在 IO monad 中返回结果。

# perl - 验证来自查询字符串的参数

> ID：13482966
> 
> 赞同：0
> 
> 时间：2012-11-20T22:01:55.403
> 
> 标签：perl

嗨，我对 perl 很陌生。正如您在下面的代码中看到的那样，我需要从查询字符串中获取参数“page”。我还想验证参数值。如果参数不在查询字符串中或不是数字，则将 1 分配给 $current_page，否则只需将值分配给 $current_page。我怎么能在 perl 中做到这一点？请帮我。

```
use strict;

use CGI qw/:standard/;
my $querystring = CGI::Vars();

my $current_page = $querystring->{page};

print $current_page;  # I would get a warning "Use of uninitialized value..." 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:04:12.600

`1`如果参数丢失，这将使用：

```
my $current_page = $querystring->{page} || 1; 
```

但是，它不会检查以确保它是一个数字。那将是这样的：

```
my $current_page = $querystring->{page};
$current_page = 1
   if !defined($current_page)
   || $current_page =~ /[^0-9]/
   || $current_page == 0; 
```

如果您需要验证多个参数，您可能需要类似[Data::FormValidator](http://search.cpan.org/perldoc?Data%3a%3aFormValidator)的东西。一旦你开始使用它，你就会得到它的所有好处，包括修剪前导和尾随空格的能力。

# sql - 使用 IF EXISTS 连接 SQL 选择语句

> ID：13482972
> 
> 赞同：3
> 
> 时间：2012-11-20T22:02:18.363
> 
> 标签：sql, oracle

抱歉，如果这是一个愚蠢的问题，但我无法理解这一点。如果存在，我只想选择一个带有冒号的值，这个值是“县”。但是，我不确定我是否以正确的方式进行此操作？任何帮助将不胜感激。

```
SELECT pe.personname AS "Person Name", pe.street||','||pe.town||','||
    IF NOT EXISTS(SELECT pe.county FROM persons pe WHERE pe.county = '')
    THEN pe.county||','|| 
    ELSE
    END IF
 pe.postcode as "Persons Address"
 FROM persons pe 
```

* * *

如果没有县，更新版本会输出多个逗号。

```
SELECT personname as "Person Name"
street||','||town||
   CASE county
   WHEN '' THEN ''
   ELSE ','||county
   END
||','||postcode as "Person Address"
from Suppliers; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T18:43:26.207

我已经为此而去了，但得到一个**缺少关键字的错误**：-

```
 SELECT personname AS "Person Name", 
   street || ',' || town || ',' ||
     CASE WHEN county > ''
     THEN county || ','
     ELSE ''
     END 
   || postcode AS "Person Address"
 FROM Persons 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:10:33.987

我想你的意思是用逗号。

```
SELECT pe.personname AS "Person Name", pe.street||','||pe.town||
  IF pe.county <> ''
  THEN ','||pe.county
  ELSE ''
  END IF
pe.postcode as "Persons Address"
FROM persons pe 
```

它可能更干净，（你可能必须）这样做：

```
SELECT pe.personname AS "Person Name",
  IF pe.county <> ''
  THEN pe.street||','||pe.town||','||pe.county
  ELSE pe.street||','||pe.town
  END IF
pe.postcode as "Persons Address"
FROM persons pe 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:14:06.910

如果您尝试获取两列，第一列是人名，第二列是地址部分，我会：

```
 select pe.personname, pe.street || ',' || pe.town || ',' || 
(case county when not null then (county || ',') else '' end), postcode 
```

使用 case 语句来评估县，如果有一个用 ',' 插入它，否则 ''

# c# - 在 Regex.Replace() 中使用方法

> ID：13482975
> 
> 赞同：0
> 
> 时间：2012-11-20T22:02:41.853
> 
> 标签：c#, regex

我有个问题。我有一些要解析的文本。问题是我使用正则表达式找到它：

```
text = Regex.Replace(text, @"\(DOWN\)\(LShift\)(.*?)\(UP\)\(LShift\)", "$1"); 
```

我想`$1`使用我的方法将每个字母从 value 解析成一些东西。但是这个方法的输入不是`$1`变量 value 而是一串 value `"$1"`。

我试过：

```
text = Regex.Replace(text, @"\(DOWN\)\(LShift\)(.*?)\(UP\)\(LShift\)", ShiftsParser("$1")); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:07:23.043

研究使用[MatchEvaluator](http://msdn.microsoft.com/en-us/library/cft8645c.aspx)。使用 lambda 的示例：

```
var result = Regex.Replace(input, pattern, match => 
{
    // $1 is equivalent to match.Groups[1].Value,
    // so do whatever you want and return the value here
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:09:20.363

您的方法应该将 Match 对象作为参数。

```
string ShiftsParser(Match match)
{
    string value = match.Groups[1].Value;  // $1 value.
    // Do some work with value
    return value;
} 
```

我希望这会有所帮助。

# javascript - 元素的不同高度取决于页面加载

> ID：13482981
> 
> 赞同：0
> 
> 时间：2012-11-20T22:03:08.670
> 
> 标签：javascript, jquery, html, css, dimensions

我正在开发一个使用 jQuery 来实现仿列效果的网站。这是一个测试页面：http: [//goo.gl/IL3ZB](http://goo.gl/IL3ZB)。左边的黄色`<aside>`高度是用`.body_container`div 的高度在 java 脚本中设置的。高度设置正确以进行显示。

问题是，当我在 Firefox 17 中进行完全刷新（Shift + F5）时，`<aside>`它会以正确的高度正确显示，但 js 中的动画高度要小得多。当我然后正常刷新页面时，java脚本也会看到正确的高度。

我该如何解决这个问题？

这是我的js：

```
var floating_patents_bottom = 0;

$(window).load(function(){
    $('.floating_patents').height( $('.body_container').height()  );
    floating_patents_bottom = ($('.body_container').height() > floating_patents_bottom ? $('.body_container').height() : floating_patents_bottom);
    var toBottom = {
        'top': floating_patents_bottom
    };
});

var toTop = {
    'position': 'absolute',
    'top': '500px',
    'display': 'none'
};

$(document).ready(function(){
    $('.floating_patents').height( $('.body_container').height()  );
    floating_patents_bottom = ($('.body_container').height() > floating_patents_bottom ? $('.body_container').height() : floating_patents_bottom);
//    floating_patents_bottom = $('.floating_patents').height();

    var toBottom = {
        'top': floating_patents_bottom
    };

    var patents = $(".floating_patents img");
    patents.css(toTop);

    patents.each(function(index) {
        $(this).delay(index * 5000).css('margin','10px auto').fadeIn("slow").animate(toBottom , 15000, function(){
            $(this).fadeOut("slow");
                });
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:49:46.360

问题是，当`$(document).ready`调用处理程序时，您的内容中的图像没有完全加载并且尺寸为零，因此您的`$('.body_container').height()`计算不正确（当浏览器从缓存中获取图像时，计算有时会正确发生）。对您来说最简单的解决方案是将所有代码移动到`$(window).load`处理程序中。

一些重构的代码将起作用：

```
function floatingPatents() {
    // find required elements in DOM
    var patentsBlock = $('.floating_patents'), bodyContainer = $('.body_container');
    var patents = patentsBlock.find('img').hide();
    var floating_patents_bottom = 0;

    // wait for complete page load
    $(window).load(function(){
        // resize holder
        floating_patents_bottom = bodyContainer.height();
        patentsBlock.height( floating_patents_bottom );

        // calculate offsets
        var toTop = {
            position: 'absolute',
            top: '500px',
            display: 'none'
        };
        var toBottom = {
            top: floating_patents_bottom
        };

        // start animation
        patents.show().css(toTop).each(function(index) {
            $(this).delay(index * 5000).css('margin','10px auto').fadeIn("slow").animate(toBottom , 15000, function(){
                $(this).fadeOut("slow");
            });
        });
    });
}

// run code when page ready
$(floatingPatents); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:52:37.210

文档在其所有元素加载之前就已准备就绪。您在`$(window).load`事件中获得了正确的高度，但您正在初始化`$(document).ready`事件中的动画。只要把所有东西都搬进去`$(window).load`，你应该会很好。

如果等待窗口完成加载的时间太长（否则，您将无法获得`.body-container`div 的正确高度），您可以尝试使用此技术获取图像的占位符，以便流程在它们实际加载之前是正确的。 [http://andmag.se/2012/10/responsive-images-how-to-prevent-reflow/](http://andmag.se/2012/10/responsive-images-how-to-prevent-reflow/)

# c# - 对删除 CustomValidator 的 ClientValidationFunction 属性中的括号感到好奇吗？

> ID：13482984
> 
> 赞同：0
> 
> 时间：2012-11-20T22:03:15.637
> 
> 标签：c#, asp.net, customvalidator, jscript

我是asp.net 的初学者。我尝试了`CustomValidator`并将`my_fun()`Javascript 函数放入`ClientValidationFunction`属性中。我得到那个错误：

> Microsoft JScript 运行时错误：预期对象

但是当我删除括号时，我完全没有错误。

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:59:21.903

我认为正在发生的事情是：当您将函数名称放在不带括号的情况下时，您就是在引用一个函数*对象*。您正在指示应该调用哪个函数。

当你用括号输入函数名时，你正在*调用*该函数。您表示要调用的函数应该是指定函数的*结果*。

如果您的函数没有返回任何内容，则尝试调用验证函数的代码将没有可调用的内容，并且会出现错误。

# algorithm - 在Matlab中找到具有约束的变量的“可能”组合的算法？

> ID：13482986
> 
> 赞同：4
> 
> 时间：2012-11-20T22:03:27.030
> 
> 标签：algorithm, matlab, combinations, probability

假设我在 A 中有 7 个项目，在 B 中有 4 个项目

```
A=[10;40;90;130;200;260;320]
B=[100;300;500;1000] 
```

我想要列出**可能的组合**，其中：

*   必须包含**A 的**所有子组件
*   可以添加 B 的子组件，**直到**添加的所有子组件的*总和*大于 2000

任何人都知道如何在 Matlab 中做到这一点？

我的尝试：

```
X=sum(A);
y=1;
for Y=1:((length(A))-1);
   X=X+B(y);
   if(X>2000)
       disp('Following is unacceptable')    
   end
   y=y+1
end 
```

但是，此代码不正确。它只是添加 B 的第一个元素，然后将其添加到第二个元素，依此类推。它没有为我提供可能的组合。

例子 ：

*   总和（A）+ B（1）=确定
*   总和（A）+ B（4）=不正确
*   总和（A）+ B（1）+ B（2）=确定
*   总和（A）+ B（2）+ B（3）=确定
*   ETC...

如果将来 A 或 B 的值发生变化，我希望这可以自动化。我不确定这是否也是概率的情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T22:47:39.040

只需使用[`nchoosek`](http://www.mathworks.com/help/matlab/ref/nchoosek.html)and 一个双`for`循环来遍历所有可能的元素组合`B`：

```
SA = sum(A);
for k = 1:numel(B)
    for idx = nchoosek(1:numel(B), k)'
        B_subset = B(idx);
        if (SA + sum(B_subset) <= 2000)
            disp([A(:)', B_subset(:)'])
        end
    end
end 
```

这将打印总和小于（或等于）2000 的所有组合。对于您的示例，我们得到：

```
 10    40    90   130   200   260   320   100
    10    40    90   130   200   260   320   300
    10    40    90   130   200   260   320   500
    10    40    90   130   200   260   320   100   300
    10    40    90   130   200   260   320   100   500
    10    40    90   130   200   260   320   300   500
    10    40    90   130   200   260   320   100   300   500 
```

## 解释：

**内部`for`循环**：
内部`for`循环使用`nchoosek(1:numel(B), k)`，它从 1...length(B) 生成所有 k 长度组合（我使用它[`numel`](http://www.mathworks.com/help/matlab/ref/numel.html)而不是[`length`](http://www.mathworks.com/help/matlab/ref/length.html)出于习惯；在这种情况下，它具有相同的效果）。例如，在我们的例子`B`中有 4 个元素，所以`k = 3`我们得到`nchoosek(1:4, 3)`：

```
 1   2   3
    1   2   4
    1   3   4
    2   3   4 
```

我们从中得到的是 中元素索引的所有可能的 k 长度组合`B`。在每次迭代中，此循环`for`将不同的索引组合分配给`idx`. 我们如何将索引转换`B`为真实元素？我们简单地写`B(idx)`。
在循环内部测试组合：如果总数`sum(A) + sum(B(idx))`小于（或等于）2000，则显示该组合。

**外`for`循环**：
外`for`循环简单地迭代所有可能的组合长度（即，遍历所有可能的值`k`）。

希望有帮助！

## PS：

未来的一些 MATLAB 编程技巧：
1\. 变量名区分大小写。
2\. 你不需要增加循环变量。`for`循环会自动为您执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T22:36:24.617

假设 B 不是很长（大约 10 个元素），对所有组合进行详尽搜索就可以了。您可以使用递归函数执行这种详尽的搜索，但下面的代码使用了一个在 MATLAB 中特别简洁的技巧：它通过将每个组合表示为二进制位字符串来扫描 B 元素的所有组合。

```
% examine each of 2^length(B) combinations
for i=0:2^length(B)-1
    % converts the binary string into an array of 0 and 1 used to select elements in B
    combo = dec2bin(i, length(B))-'0'; 
    % print the combination of elements if their sum is large
    if combo * B + sum(A) > 2000
       disp(find(combo));
    end
end 
```

有 2^length(B) 种可能的组合。这会依次检查它们，将组合表示为长度为 length(B) 的二进制字符串，并评估这些元素的总和（位串和 B 之间的点积）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T22:42:44.377

最好的方法将涉及一些递归，如下所示：

```
sumA=sum(A);
find_CombinationsOfB(B,sumA,[])

function ret=findCombinationsOfB(in_vals,total_sum,already_contained)

if total_sum>2000
    ret=false;
else
    for y=1:length(in_vals);
       if (~findCombinationsOfB(in_vals([1:(y-1);(y+1):length(in_vals)],total_sum+in_vals(y),[already_contained in_vals(y))
          display([already_contained in_vals])
       end
    end
    ret=true;
end 
```

本质上，它的作用是尝试 B 的每种组合。它将打印任何不等于 2000 的组合，包括来自 A 的总和。

一步一步，这是它的作用：

1.  最初，传递 B 的完整数组以及 A 的总和。传递一个空数组以存储迄今为止已使用 B 的哪些元素。
2.  每个元素依次添加到函数中，并使用新的总和再次调用，并且数组中缺少一个值。
3.  如果在任何时候数组总和超过 2000，它就会停止推理链。

如果您想了解更多关于它是如何工作的，请在函数的开头打印 in_vals、total_sum 和 already_contained，如下所示：

```
fprintf("in_vals=%s   total_sum=%i   already_contained=%s",mat2str(in_vals),total_sum,mat2str(already_contained)); 
```

它应该在每次迭代中向您展示正在发生的事情。

# ruby - 合并特定文件夹中的所有 JSON 文件

> ID：13482993
> 
> 赞同：2
> 
> 时间：2012-11-20T22:04:49.197
> 
> 标签：ruby, jruby

我有一个文件夹，其中包含许多 JSON 文件。

我想获取文件名以 .`.json`结尾的所有文件，`_LAST.json`并将它们组合成一个 JSON 文件。要处理的每个文件的名称如下：

```
Bill_LAST.json
Jane_LAST.json
Kitty_LAST.json 
```

`Bill_LAST.json`好像：

```
[{

    "Date": "2012-11-19",
    "Name": "Bill",
    "Age": 54,
    "Sex": "M"

}] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T22:09:43.240

它可能很简单：

```
json = Dir['./*_LAST.json'].map { |f| JSON.parse File.read(f) }.flatten 
```

### [这](http://cibox.org/slivu/stackoverflow?path=is-there-an-easy-way-of-combining-two-json-files-or-splitting-one-json-in-ruby&lang=ruby&file=last.rb&run=true)是一个工作演示。

# r - 计算“长”数据框中的百分比变化

> ID：13482996
> 
> 赞同：1
> 
> 时间：2012-11-20T22:04:59.210
> 
> 标签：r

我有一个数据框，其中包含按国家/地区列出的 GDP 值以及随附的日期列。以下代码复制了两个国家（法国和德国）和六年（2005-2010）的示例数据集：

```
df <- structure(list(geo = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 2L, 
                2L, 2L, 2L, 2L, 2L), .Label = c("DE", "FR"), class = "factor"), 
                 date = structure(c(12784, 13149, 13514, 13879, 14245, 14610, 
                 12784, 13149, 13514, 13879, 14245, 14610), class = "Date"), 
                 GDP = c(2147975, 2249584.4, 2373993.1, 2382892.6, 2224501.8, 
                2371033.2, 1557584.8, 1621633.2, 1715655.4, 1713157.1, 1636336.3, 
               1707966.5)), .Names = c("geo", "date", "GDP"), row.names = c(NA, 
              -12L), class = "data.frame") 
```

现在我想计算一个额外的列，显示每年的百分比差异。我尝试以下方法：

```
library(quantmod) 
# provides the Delt() function to calculate percent differences

df$dtGDP <- as.numeric(Delt(df$GDP)) 
```

这是错误的，因为它使用 2010 年的 DE 值计算 2005 年的 FR 值。有没有办法应用“每个因子水平”函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T00:55:12.493

```
> df$dtGDP <-with(df, ave(GDP, geo, FUN=Delt))
> df
   geo       date     GDP        dtGDP
1   DE 2005-01-01 2147975           NA
2   DE 2006-01-01 2249584  0.047304741
3   DE 2007-01-01 2373993  0.055302971
4   DE 2008-01-01 2382893  0.003748747
5   DE 2009-01-01 2224502 -0.066469970
6   DE 2010-01-01 2371033  0.065871558
7   FR 2005-01-01 1557585           NA
8   FR 2006-01-01 1621633  0.041120329
9   FR 2007-01-01 1715655  0.057979943
10  FR 2008-01-01 1713157 -0.001456178
11  FR 2009-01-01 1636336 -0.044841655
12  FR 2010-01-01 1707966  0.043774742 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T23:12:17.023

试试这个：

```
foo <- aggregate(GDP~geo, df, function(x) list(Delt(x)))
df <- cbind(df, dtGDP = as.numeric(unlist(foo[,-1])))
df 
```

假设你已经运行了这个：

```
library(quantmod) 
df <- structure(list(geo = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 2L, 
                2L, 2L, 2L, 2L, 2L), .Label = c("DE", "FR"), class = "factor"), 
                date = structure(c(12784, 13149, 13514, 13879, 14245, 14610, 
                12784, 13149, 13514, 13879, 14245, 14610), class = "Date"), 
                GDP = c(2147975, 2249584.4, 2373993.1, 2382892.6, 2224501.8, 
                2371033.2, 1557584.8, 1621633.2, 1715655.4, 1713157.1, 1636336.3, 
                1707966.5)), .Names = c("geo", "date", "GDP"), row.names = c(NA, 
                -12L), class = "data.frame") 
```