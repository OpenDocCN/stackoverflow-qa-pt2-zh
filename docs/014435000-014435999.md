# StackOverflow 问答 14435000-14435999

# android - 图像的某些部分如何重复

> ID：14435002
> 
> 赞同：1
> 
> 时间：2013-01-21T08:41:22.393
> 
> 标签：android, background, nine-patch

![在此处输入图像描述](../Images/41658373d0fd8d6f00380db0ac7f632a.png)

我是安卓应用初学者开发者。

我做了一个 9-patch 来使用上面的图像。

图像的虚线不重复，只是拉伸。

![在此处输入图像描述](../Images/ec5047a7941bd8f0323f076f77043851.png)

我必须像上面那样在图像上写文字。

图像的某些部分如何重复？

请告诉我一些建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T08:47:06.787

我不认为你能做到这一点。9 路径图像仅拉伸图像的一部分。一种解决方案可能是使用 3 个可绘制对象。一个是左箭头，一个是右箭头，一个是要重复的中心图像。[然后，您可以使用此处](https://stackoverflow.com/questions/2706913/how-to-make-android-apps-background-image-repeat)和[此处](http://androidblogger.blogspot.in/2009/01/how-to-have-tiled-background-cont.html)给出的虚线重复中心图像。

# three.js - 三.js聚光灯反射计算错误？

> ID：14435010
> 
> 赞同：1
> 
> 时间：2013-01-21T08:42:02.893
> 
> 标签：three.js, webgl, spotlight

有人知道如何在这里进行聚光灯反射：[http](http://web251.merkur.ibone.ch/webgl/three/) ://web251.merkur.ibone.ch/webgl/three/看起来像这里的一个：[http](http://web251.merkur.ibone.ch/webgl) ://web251.merkur.ibone.ch/webgl ？即它会反射到相机上？奇怪的是它不会自动这样做。如果你用鼠标在地球上移动，你会注意到。在这个场景中，除了相机之外，一切都是静止的，随着相机的移动，眼睛 E 也会四处移动，对吧？所以我期望的是行星上的聚光灯反射一直被重新渲染/重新计算，例如使用 Blinn 的 Halfvector，导致在 E 和聚光灯之间的行星上的反射。

非常感谢您的帮助，我们已经搜索了几个小时，但找不到我们的代码出了什么问题的线索！

在此先感谢 Doidel

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T13:13:53.980

我用来玩这个的第一个起始代码是： http: [//mrdoob.github.com/three.js/examples/webgl_materials_shaders.html](http://mrdoob.github.com/three.js/examples/webgl_materials_shaders.html)

关键是为 (Phong) 材质添加具有 specularMap 属性的高光度贴图。

可以按如下方式进行：

```
var MySpecularMap = THREE.ImageUtils.loadTexture( "MySpecularImage.jpg" );

var Color = THREE.ImageUtils.loadTexture( "MyColorImage.jpg" );
var mappedTexture = new THREE.MeshPhongMaterial( { color: 0xffffff, map: Color, specular: 0xffffff, specularMap: MymapSpecular} );

sphere = new THREE.SphereGeometry( 600, 32, 32 );
globe = new THREE.Mesh( sphere, mappedTexture );
scene.add( globe ); 
```

此外，对于这种类型的演示，OrbitControls 似乎是最好的。

这是一个带有 {ColorMap, SpecularMap, BumpMap, Clouds, SkyDome} 的完整示例： [http ://randompast.github.io/randomtests/three.js/earth/1/index.html](http://randompast.github.io/randomtests/three.js/earth/1/index.html)

# php - 循环检查复选框

> ID：14435016
> 
> 赞同：0
> 
> 时间：2013-01-21T08:42:33.377
> 
> 标签：php, mysql, loops, checkbox, foreach

假设我有一张包含汽车经销商列表的表格。

我也有一个列表，其中包含与汽车相关的制造商。

*   示例：`assigned_id`, `assigned_carid`, `assigned_cardealer`.
*   示例 2（经销商列表）：`dealer_id`,`dealer_name`

我需要将所有经销商打印为复选框，如果汽车与经销商相关，则必须选中选择框。

如何在 PHP/MySql 中做到这一点？前锋？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T08:46:25.447

从数据库中获取数组并回显每个获取的数组。如果您回显数据，请在其后回显一个 html 复选框。

# android - Avast 报告说我的 Android 应用程序是木马

> ID：14435019
> 
> 赞同：10
> 
> 时间：2013-01-21T08:42:44.573
> 
> 标签：android, antivirus

我的一个应用程序被 avast 报告为潜在有害程序。它由 avast 标记！作为 Android:Agent-GE 和 Android:AndrAgent-R...

谁能告诉我有关此的更多信息，以便我可以在此应用程序中找到确切被认为是病毒的内容。这是一个非常简单的应用程序，所以我不知道是什么原因造成的...

是否有可能构建 APK 的计算机被感染并在应用程序中注入了一些木马？

我将此报告为误报，并通过他们的论坛联系了 avast。但我想在这里发帖也不会有什么坏处，也许有人有/遇到过类似的问题。

# spring - 使用 Hibernate 保存数据时如何处理数据库服务器故障？

> ID：14435021
> 
> 赞同：0
> 
> 时间：2013-01-21T08:42:55.430
> 
> 标签：spring, hibernate, orm, postgresql-8.4

我有一个使用 PostgreSQL 作为数据库的 Web 应用程序。

假设我正在尝试使用 Hibernate 保存（）数据。现在就在保存数据之前，如果数据库服务器将关闭，那么发生了什么？

Hibernate 将再次尝试保存，或者我是否必须编写重试代码。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T08:56:04.697

不，Hibernate 不会重新尝试保存您的数据。db 失败将导致您的事务失败，并且所有更改都将被回滚。
更糟糕的是，如果您没有正确配置连接池，当数据库再次运行时，您将无法重新建立连接。看看[这个问题](https://stackoverflow.com/questions/8083759/re-establishing-a-db-connection-after-a-network-failure-hibernate)以获取更多信息。我复制并粘贴 c3p0 配置。

```
<c3p0-config>
<default-config>
<!-- Configuring Connection     Testing -->
<!-- property name="automaticTestTable">TEST_EMS_HIBERNATE_CONN</property -->
<property name="checkoutTimeout">0</property>
<property name="testConnectionOnCheckout">true</property>
<property name="testConnectionOnCheckin">false</property>
<property name="preferredTestQuery">SELECT 1 from dual</property>
<!-- Configuring Recovery From Database Outages -->
<property name="acquireRetryAttempts">0</property>
<property name="acquireRetryDelay">1000</property>
<property name="breakAfterAcquireFailure">false</property>
<!-- Configuring to     Debug and Workaround Broken     Client Apps     -->
<property name="unreturnedConnectionTimeout">1800</property>
<property name="debugUnreturnedConnectionStackTraces">true</property>
</default-config> 
```

# java - 分发 XML 文件

> ID：14435023
> 
> 赞同：1
> 
> 时间：2013-01-21T08:43:02.450
> 
> 标签：java, xml

我对 XML 及其功能完全陌生。

我有一个文件说`xyz.xml`。它包含如下内容：

```
<system-config>
    <business-model>
      <agent-category key="operator">
         <singular-name>Operator</singular-name>
         <plural-name>Operators</plural-name>
         <attribute>agent-attribute.reference</attribute>
      </agent-category> 
```

接下来我有

```
 <agent-attribute id="agent-attribute.reference">
     <name>Reference</name>
     < description>A unique identifier for this agent, typically an MSISDN.</description>
     <mandatory>true< /mandatory>
     <editable>false< /editable>
     <deletable>false< /deletable>
     <sensitive>false< /sensitive>
     <system-generated>false< /system-generated>
     <input-method xsi:type="AgentReferenceInputMethod"></input-method>
     <storage-location xsi:type="AgentRefStorage" field="reference"></storage-location>
     </agent-attribute>
 </business-model> 
```

现在我想将代理属性分发到名为 agentAttr.xml 的不同文件中。

是否有可能这样做（注意它`<agent-attribute>`在 下`<system-config><business-model>`），如果可以的话怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:02:15.970

所以你想提取代理属性部分？您可以通过简单的 XSLT 转换来做到这一点（例如使用[Xalan](http://xml.apache.org/xalan-j/)）。另一种选择可能是[jsoup](http://jsoup.org/)，使用 DOM 或手动解析它。

# json - 浏览器 cookie 中的 JSON

> ID：14435030
> 
> 赞同：0
> 
> 时间：2013-01-21T08:43:28.643
> 
> 标签：json, cookies

我不确定之前是否讨论过这个问题，但我想通过 javascript 在 cookie 中存储一个 javascript 对象。

基本上我的问题是我有一个输入字段很少的 html 表单。我想从字段中获取输入并将相同的值存储在 javascript 对象中。只有在我进入此页面之前，才能访问此 javascript 对象。但是一旦我转到另一个页面，我的 javascript 对象就会变为空/未定义。所以我想我可以将 javascript 对象存储在某个地方，我可以从那里取回我从输入字段中输入的值。但我不知道我应该如何做到这一点。

任何帮助将不胜感激。

谢谢，

鲁帕姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T11:15:17.330

饼干是要走的路。您可以执行以下操作：

1.  添加插件：[https ://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

2.  设置 cookie：

    $.cookie("CookieName","CookieValue");

3.  清除 cookie：

    $.removeCookie("CookieName");

4.  访问 cookie 中的值：

    var temp = $.cookie("CookieName");

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T11:21:55.610

我的建议是使用专用的持久存储库，例如：[http](http://brian.io/lawnchair/) ://brian.io/lawnchair/它完全符合您的要求（甚至更多）。

# javascript - Javascript：从字符串中创建一个数组

> ID：14435031
> 
> 赞同：1
> 
> 时间：2013-01-21T08:43:31.687
> 
> 标签：javascript

我想用一个特殊的字符串创建一个数组。格式如下：

> (a),(b),(c(d,e)),(f(g(h,i,j)))

数组应该是这样的：

> (一) | (b) | (c(d,e)) | (f(g(h,i,j)))

使用该`split()`功能不是一个好主意，因为它给了我这样的东西：

> (一) | (b) | (c(d | e)) | (f(g(h | i | j)))

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T08:44:57.133

这是一种可能的简短解决方案：

```
function strSplit(str, x) {
    return x = 0, str.replace(/./g, function(c, i, a) {
        return c === "(" ? (x++, c) :
               c === ")" && i < a.length - 1 && --x === 0 ? c + "|" : c;
    }).split("|,");
}

strSplit("(a),(b),(c(d,e)),(f(g(h,i,j),k(l,m),n))");
// >> ["(a)", "(b)", "(c(d,e))", "(f(g(h,i,j),k(l,m),n))"] 
```

**演示：http:** [//jsfiddle.net/WRdAC/](http://jsfiddle.net/WRdAC/)

* * *

为了使代码更清晰，这里是完整的变体：

```
function strSplit(str) {
    var x = 0;
    return str.replace(/./g, function(c, i, a) {
        if (c === "(") {
            x++;
        } else if (c === ")" && i < a.length - 1 && --x === 0) {
            return c + "|";
        }
        return c;
    }).split("|,");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T09:00:57.747

如何计算左括号的*数量*？如果计数为零，则可以安全拆分。

```
var
  input = '(a),(b),(c(d,e)),(f(g(h,i,j)))',
  i = 0,
  lim = input.length,
  output = [],
  count = 0,
  stack = [],
  c;

for (; i < lim; i += 1) {
  c = input.charAt(i);

  switch (c) {
    case '(':
      count += 1;
      break;

    case ')':
      count -= 1;
      break;

    case ',':
      if (count === 0) {
        output.push(stack.join(''));
        stack = [];
        continue;
      }
      break;
  }

  stack.push(c);
}

if (stack.length > 0) {
  output.push(stack.join(''));
}

console.log(output); // ["(a)", "(b)", "(c(d,e))", "(f(g(h,i,j)))"] 
```

[http://jsbin.com/otofog/1/](http://jsbin.com/otofog/1/)

* * *

或者（如果您的目标不是 IE < 9）：

```
function mySplit(input) {
  var count = 0, output = [], stack;

  stack = input.split('').reduce(function (stack, c) {
    switch (c) {
      case '(': count += 1; break;
      case ')': count -= 1; break;
      case ',':
        if (count === 0) {
          output.push(stack.join(''));
          return [];
        }
    }

    stack.push(c);
    return stack;
  }, []);

  if (stack.length > 0) {
    output.push(stack.join(''));
  }

  return output;
}

console.log( mySplit('(a),(b),(c(d,e)),(f(g(h,i,j)))') ); 
```

[http://jsbin.com/ohasuc/1/](http://jsbin.com/ohasuc/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T08:53:36.943

像这样的东西：

```
var s = "(a),(b),(c(d,e)),(f(g(h,i,j)))";
var a = s.split("),");
for (var i = 0; i < a.length - 1; i++)
  a[i] = a[i] + ")"; 
```

更复杂的结构可能需要这样：

```
var s = "(a),(b),(c(d,e)),(f(g(h,i,j),k(l,m),n))";
var a = s.split("),(");
for (var i = 0; i < a.length - 1; i++)
  a[i] = a[i] + ")";
for (var i = 1; i < a.length; i++)
  a[i] = "(" + a[i]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T09:27:39.463

此功能完全符合您的要求：

```
function parseStrToArr(str){
  var pairs = 0;
  var arr   = [];
  var chars = '';

  for(var i = 0, l = str.length; i < l; i++){
    var char = str[i];

    switch(char){
      case '(': pairs++; break;
      case ')': pairs--; break;
    }

    if(!pairs){
      if(chars){
        arr.push(chars + char);
        chars = '';
      }
    }
    else{
      chars += char;
    }
  }

  return arr;
} 
```

关键是匹配成对的括号。即使您删除逗号，此算法也将起作用。

# android - 如何在 Eclipse 中创建 JNI android 项目

> ID：14435032
> 
> 赞同：1
> 
> 时间：2013-01-21T08:43:33.447
> 
> 标签：android, java-native-interface

我想在 eclipse juno 中创建一个基于 JNI 的 Android 项目。

如何使用 Java 和 C++ 在 android 中创建一个简单的“Hello World”项目。是否有任何教程可以通过使用 JNI 帮助我使用上述应用程序。

通过运行应用程序，它显示以下错误

![在此处输入图像描述](../Images/dfd55842c505754940a58f58b51254c5.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T09:00:29.853

[http://mindtherobot.com/blog/452/android-beginners-ndk-setup-step-by-step/](http://mindtherobot.com/blog/452/android-beginners-ndk-setup-step-by-step/)

这是一个很好的 NDK 入门教程。

好的，这里是代码活动——

```
package com.example.ndk;

import android.app.Activity;
import android.app.AlertDialog;
import android.os.Bundle;

public class MainActivity extends Activity {

    static {
        System.loadLibrary("NDK");
    }

    // declare the native code function - must match ndkfoo.c
    private native String invokeNativeFunction();

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // this is where we call the native code
        String hello = invokeNativeFunction();

        new AlertDialog.Builder(this).setMessage(hello).show();
    }

} 
```

NDK.cpp

```
#include <string.h>
#include <jni.h>

jstring Java_com_example_ndk_MainActivity_invokeNativeFunction(JNIEnv* env, jobject javaThis) {

    return (*env)->NewStringUTF(env, "Hello from native code!");

} 
```

安卓.mk

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

# Here we give our module name and source file(s)
LOCAL_MODULE    := NDK
LOCAL_SRC_FILES := NDK.c

include $(BUILD_SHARED_LIBRARY) 
```

将 Android.mk 和 NDK.cpp 放入`jni`文件夹 现在使用 cygwin 构建库（如果您在窗口上开发），与示例中提到的相同。并运行它。

# self-organizing-maps - 轻量级无监督学习方法，如自组织地图

> ID：14435034
> 
> 赞同：0
> 
> 时间：2013-01-21T08:43:38.503
> 
> 标签：self-organizing-maps, unsupervised-learning

我正在尝试开发一个轻量级系统，该系统使用无监督学习方法，该方法使用 CPU、RAM 利用率等系统参数来训练异常检测系统。除了自组织地图，我想不出任何东西。我可以在这里考虑其他任何学习技巧吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T12:02:20.360

对于 SOM，您没有太多选择。您可以考虑的唯一想法是您将进行批量训练还是顺序训练，当然，如果您将使用的实现提供这两种选项。但是这个选项主要影响训练时间（第一个更快）而不是结果图（至少在理论上）。

您还可以选择欧几里得以外的距离函数，但大部分参考书目并不关心这一点。

# javascript - 制作一个三角形 div 来保存文本并在悬停时关闭

> ID：14435038
> 
> 赞同：0
> 
> 时间：2013-01-21T08:44:01.700
> 
> 标签：javascript, jquery, html, css

如何让一个固定的三角形 div 保存文本和图像？

我所做的也是[**这样**](http://jsfiddle.net/nS9Bm/)，但是当 div 在悬停时打开时，当我悬停时，它不会关闭，因为 div 是方形的，所以当用户悬停时我需要这样做， div应该关闭吗？

jQuery也会很好

CSS

```
.map {
    background-color: transparent;
    position: absolute;
    border-top: 0px;
    border-right: 500px solid transparent;
    border-left: 0;
    border-bottom: 500px solid #ff0000;
    width: 0;
    position: fixed;
    bottom: -440px;
}

.map:hover {
    bottom: 0px;
} 
```

[**另一个小提琴**](http://jsfiddle.net/nS9Bm/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T08:50:50.830

例如，如果您检查 chrome 中的元素，您会看到尽管您使用边框来创建这个技巧，但 div 仍然是一个正方形，当您将鼠标悬停在它上面时，它会覆盖左下角 500x500 像素

您可能需要考虑跟踪鼠标坐标以实现您想要的。

```
$(".map").click(function(e){
   var parentOffset = $(this).parent().offset(); 
   //or $(this).offset(); if you really just want the current element's offset
   var relX = e.pageX - parentOffset.left;
   var relY = e.pageY - parentOffset.top;
}); 
```

# javascript - 提交页面时从 iframe 访问隐藏元素

> ID：14435041
> 
> 赞同：1
> 
> 时间：2013-01-21T08:44:09.613
> 
> 标签：javascript, forms, hidden-field

我有一个这样的问题。例如，我的网页中有 2 个页面，提交时第 1 页转到第 2 页，当然还有它的所有 html 表单元素。我的问题是我在 page1 中有一个 iframe，所以当（提交 page1）时，如何将隐藏元素从 iframe 发送到第 2 页

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T08:46:34.760

试试这个脚本

```
<script language="JavaScript" type="text/javascript">

 function fun(iframeid,iframename){
  obj=document.getElementById(iframeid);
   if (obj.tagName=='IFRAME'){
   obj=window.frames[iframename].document.getElementId('myfield1ID').value;

  }
 }
 </script> 
```

然后将值放在 page1 隐藏元素中并提交页面...

在脚本结束之前

```
 document.getElementById('page1hiden').value=obj.value; 
```

此脚本功能您必须在按下按钮将页面 1 提交到 p2 时调用它

# sql - SQL - 在一次 SQL 调用中从多个表中选择参考数据

> ID：14435042
> 
> 赞同：0
> 
> 时间：2013-01-21T08:44:09.817
> 
> 标签：sql, select

例如，我有 4 个表，都带有用户 ID（可以多次引用。所以例如我可以有：

```
Cars
id, ..., userID  // userID = owner of the car

Garages
id, ..., userID // userID = owner of the garage

Tools
id, ..., userID // userID = owner of the tool 
```

现在我想做一个查询来删除用户，但我只想在他们所有相关数据都消失的情况下删除用户。换句话说，我想确保没有引用数据（假设我不允许 userID = -1 或 null。它必须分配给用户

我能看到进行检查的唯一方法是：

```
SELECT count(*) FROM Cars WHERE USERID = userID
SELECT count(*) FROM Garages WHERE USERID = userID
SELECT count(*) FROM Tools WHERE USERID = userID 
```

我必须检查是否有任何结果大于 0。有没有办法在一个 SQL SELECT 查询中跨 N 个表进行检查？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T08:48:25.540

您可以将计数相加，如下所示：

```
SELECT (SELECT count(*) FROM Cars WHERE USERID = userID)
     + (SELECT count(*) FROM Garages WHERE USERID = userID)
     + (SELECT count(*) FROM Tools WHERE USERID = userID)
FROM ... 
```

如果结果为非 0，则您有一个引用的用户。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T08:59:36.097

如果您想防止删除仍有汽车、车库或工具的用户，您应该将这些表中的外键添加到用户表中。

如果您随后尝试删除仍被引用的用户，您将收到一个可以捕获并处理的错误，例如通过向用户显示适当的错误消息。

这有一个额外的好处，即无论某人如何尝试删除用户（SQL 命令行，应用程序中的一段错误代码，......），删除都将*始终被阻止*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T08:47:49.073

```
SELECT  (SELECT count(*) FROM Cars WHERE USERID = userID) as CarCount
,       (SELECT count(*) FROM Garages WHERE USERID = userID) as GarageCount
,       (SELECT count(*) FROM Tools WHERE USERID = userID) as ToolCount 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T09:33:32.007

如果 Cars 是您要更改的主表，您也可以试试这个：

```
SELECT count(*)
FROM   Cars 
       INNER JOIN
       Garages 
       ON Cars.USERID = Garages.USERID, 
       INNER JOIN
       Tools
       ON Cars.USERID= Tools.USERID
WHERE  Cars.USERID = SOME_USER_ID; 
```

建议为 USERID 创建一个外键。

# android - Android将大视图转换为位图

> ID：14435043
> 
> 赞同：0
> 
> 时间：2013-01-21T08:44:13.777
> 
> 标签：android, image, android-layout

我需要将大视图说（宽度和高度为 1280x1760）转换为位图并将图像保存到 sdcard。但是当我创建大小超过 1280x1400 的视图时，我的应用程序抛出异常 wnen createBitmap(view.getDrawingCache()) 被调用.我使用的是 10 英寸三星标签。图像像素是否取决于标签像素这是我的代码

```
 View   view2=LayoutInflater.from(getApplicationContext()).inflate(R.layout.sample, null);

             LinearLayout   view=new LinearLayout(getApplicationContext());
              view.setBackgroundColor(Color.GRAY);  
              view.setOrientation(LinearLayout.VERTICAL);
             view.addView(view2,new LayoutParams(1280,1760));

              view.setDrawingCacheEnabled(true);

             view.measure(MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED), 
                    MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED));

              view.layout(0, 0, view.getMeasuredWidth(), view.getMeasuredHeight()); 

              view.buildDrawingCache(true);
           try{
              Bitmap bitmap = Bitmap.createBitmap(view.getDrawingCache());
              //Bitmap bitmap = Bitmap.createScaledBitmap(view.getDrawingCache(), 1280, 1200, true);

              //setContentView(view);   
              String path = Environment.getExternalStorageDirectory()+"/Pictures";     

                          File image = new File(path, "Image7.jpg");

                          // Encode the file as a PNG image.
                          FileOutputStream outStream=null;

                              outStream = new FileOutputStream(image);
                              bitmap.compress(Bitmap.CompressFormat.JPEG, 100, outStream); 

                              outStream.flush();
                              outStream.close();

                                   setContentView(view);
                          } catch (Exception e) {
                            Toast.makeText(getBaseContext(), e.getMessage(), 10).show();

                      } 
```

和 sample.xml 布局是

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/ic_launcher" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="match_parent"
        android:layout_height="300px"
        android:text="TextView" 
        android:background="#ffff00"/>

    <Button android:layout_weight="1"
        android:id="@+id/button1"  android:background="#ff00ff"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:text="Button" />

   <Button android:layout_weight="1"  android:background="#ff0000"
        android:id="@+id/button2"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:text="Button" />

</LinearLayout> 
```

这是 LOGCAT

```
01-21 14:26:50.381: E/AndroidRuntime(1611): FATAL EXCEPTION: main
01-21 14:26:50.381: E/AndroidRuntime(1611): java.lang.NullPointerException
01-21 14:26:50.381: E/AndroidRuntime(1611):     at android.graphics.Bitmap.createBitmap(Bitmap.java:455)
01-21 14:26:50.381: E/AndroidRuntime(1611):     at com.hunterlab.essentials.view2image.View2ImageActivity$1.Check(View2ImageActivity.java:196)
01-21 14:26:50.381: E/AndroidRuntime(1611):     at com.hunterlab.essentials.view2image.View2ImageActivity$1.onClick(View2ImageActivity.java:79)
01-21 14:26:50.381: E/AndroidRuntime(1611):     at android.view.View.performClick(View.java:3110)
01-21 14:26:50.381: E/AndroidRuntime(1611):     at android.view.View$PerformClick.run(View.java:11928)
01-21 14:26:50.381: E/AndroidRuntime(1611):     at android.os.Handler.handleCallback(Handler.java:587)
01-21 14:26:50.381: E/AndroidRuntime(1611):     at android.os.Handler.dispatchMessage(Handler.java:92)
01-21 14:26:50.381: E/AndroidRuntime(1611):     at android.os.Looper.loop(Looper.java:132)
01-21 14:26:50.381: E/AndroidRuntime(1611):     at android.app.ActivityThread.main(ActivityThread.java:4025)
01-21 14:26:50.381: E/AndroidRuntime(1611):     at java.lang.reflect.Method.invokeNative(Native Method)
01-21 14:26:50.381: E/AndroidRuntime(1611):     at java.lang.reflect.Method.invoke(Method.java:491)
01-21 14:26:50.381: E/AndroidRuntime(1611):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
01-21 14:26:50.381: E/AndroidRuntime(1611):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
01-21 14:26:50.381: E/AndroidRuntime(1611):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T09:20:22.187

嗨，请看一下这段代码。

```
public static Bitmap new_decode(File f) {

    // decode image size

    BitmapFactory.Options o = new BitmapFactory.Options();
    o.inJustDecodeBounds = true;
    o.inDither = false; // Disable Dithering mode

    o.inPurgeable = true; // Tell to gc that whether it needs free memory,
                            // the Bitmap can be cleared

    o.inInputShareable = true; // Which kind of reference will be used to
                                // recover the Bitmap data after being
                                // clear, when it will be used in the future
    try {
        BitmapFactory.decodeStream(new FileInputStream(f), null, o);
    } catch (FileNotFoundException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }

    // Find the correct scale value. It should be the power of 2.
    final int REQUIRED_SIZE = 300;
    int width_tmp = o.outWidth, height_tmp = o.outHeight;
    int scale = 1;
    while (true) {
        if (width_tmp / 1.5 < REQUIRED_SIZE && height_tmp / 1.5 < REQUIRED_SIZE)
            break;
        width_tmp /= 1.5;
        height_tmp /= 1.5;
        scale *= 1.5;
    }

    // decode with inSampleSize
    BitmapFactory.Options o2 = new BitmapFactory.Options();
    // o2.inSampleSize=scale;
    o.inDither = false; // Disable Dithering mode

    o.inPurgeable = true; // Tell to gc that whether it needs free memory,
                            // the Bitmap can be cleared

    o.inInputShareable = true; // Which kind of reference will be used to
                                // recover the Bitmap data after being
                                // clear, when it will be used in the future
    // return BitmapFactory.decodeStream(new FileInputStream(f), null, o2);
    try {

//      return BitmapFactory.decodeStream(new FileInputStream(f), null,
//              null);
        Bitmap bitmap= BitmapFactory.decodeStream(new FileInputStream(f), null, null);
        System.out.println(" IW " + width_tmp); 
        System.out.println("IHH " + height_tmp);           
        //   int iW = width_tmp;
         //   int iH = height_tmp;
       int iW = Talk_Library.screen_width;
        int iH = Talk_Library.screen_height;

           return Bitmap.createScaledBitmap(bitmap, iW, iH, true);

    } catch (OutOfMemoryError e) {
        // TODO: handle exception
        e.printStackTrace();
        // clearCache();

        // System.out.println("bitmap creating success");
        System.gc();
        return null;
        // System.runFinalization();
        // Runtime.getRuntime().gc();
        // System.gc();
        // decodeFile(f);
    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        return null;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:24:08.987

尝试以下操作（即使他们查看已禁用其绘图缓存也可以使用）：

```
int width = view.getWidth();
int height = view.getHeight();
Bitmap bitmap = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888);
Canvas canvas = new Canvas(bitmap);
view.draw(canvas);
// The view has now drawn to `bitmap` 
```

# java - 在Java中验证左对齐字符串

> ID：14435044
> 
> 赞同：-4
> 
> 时间：2013-01-21T08:44:16.160
> 
> 标签：java, string

我得到一个字符串值，需要验证它是否左对齐。

在**org.apache.commons.lang3.StringUtils**中，有一些方法可以使值左对齐或右对齐，但我需要检查一个值是否左对齐。

我可以编写逻辑，但如果存在，则寻找任何已经内置的相同功能。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:20:04.493

假设您将“左对齐”理解为“左侧没有写空间”，那么解决方案是显而易见的。测试字符串的第一个字符，看它是否是空白字符。它可以在 15 秒内完成编码，这应该是它的结束。

* * *

“解决方案”的问题`StringUtils.isBlank()`是多方面的：

*   您为 2 行方法添加了额外的 JAR 依赖项。
*   您已经花了 5 分钟找到该方法，检查其拼写，检查 javadoc 以刷新您对“空白”含义的记忆，检查它将做什么`null`，对导入进行编码。
*   你已经为下一个阅读你的代码的人做了工作，他可能需要找到/阅读 javadoc 等。

对于这样的事情，只需编写内联测试代码以完全按照您的需要进行操作就更简单了。而且它的代码更容易阅读......除非你的代码*充满*了空白/合理/其他的测试。

（此外，这并不完全是 justified 的意思。justification*通常*是指跨越多行的文本......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T10:38:37.597

假设填充总是空格，你可以试试

```
boolean leftJustified = (myString != null) && !myString.startsWith(" "); 
```

祝你好运！

# arrays - 用于报告结构的 TCL 中带有数字和键或值的数组循环

> ID：14435049
> 
> 赞同：0
> 
> 时间：2013-01-21T08:44:30.343
> 
> 标签：arrays, loops, report, tcl

我需要打印一个带有动态行和动态列的报告，如下所示。

```
 apple                           bannana                  pineapple
    Total           47              Total           376             Total 210
    a       :       3               i       :       10              m       : 45
    b       :       4               j       :       33              o       : 67
    c       :       18              k       :       245             n       : 98
    d       :       22              l       :       45
                                    x       :       43 
```

我想取所有列表的 llength 并以列表的最高 llength 迭代 for 循环。在上面的例子中，它是 5 次。

我的疑问是，如何使用从“for 循环”中获得的数字打印列表中的特定对。

例如，在第一次迭代中，我需要选择所有水果中的第一项并打印。可能像fruit_${type}[1]。不知道我该怎么做。请指教。

```
 #!/bin/sh
    # \
    exec tclsh "$0" "$@"
    set fruit_apple {{a 3} {b 4} {c 18} {d 22}}
    set fruit_bannana {{i 10} {j 33} {k 245} {l 45} {x 43}}
    set fruit_pineapple {{m 45} {o 67} {n 98}}
    set fruit {apple bannana pineapple}
    puts $fruit_apple
    foreach type $fruit {
    puts $type
            foreach pair [set fruit_${type}] {
                    set key [lindex $pair 0]
                    set value [lindex $pair 1]
                    puts "$key : $value"
            }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T12:37:37.423

您必须做很多工作才能像这样垂直格式化报告：

```
#! /usr/bin/env tclsh
set fruit_apple {{a 3} {b 4} {c 18} {d 22}}
set fruit_bannana {{i 10} {j 33} {k 245} {l 45} {x 43}}
set fruit_pineapple {{m 45} {o 67} {n 98}}
set fruit {apple bannana pineapple}
set maxl [expr {max([llength $fruit_apple], [llength $fruit_bannana], [llength $fruit_pineapple])}]

set fmt "%s\t%s\t%s\t"
foreach type $fruit {
    puts -nonewline [format $fmt "" $type ""]
    set total($type) 0
    foreach pair [set fruit_${type}] {
        lassign $pair key value
        incr total($type) $value
    }
}
puts ""
foreach type $fruit {
    puts -nonewline [format $fmt Total "" $total($type)]
}
puts ""
for {set i 0} {$i < $maxl} {incr i} {
    foreach type $fruit {
        set pair [lindex [set fruit_$type] $i]
        if {[llength $pair] == 2} {
            puts -nonewline [format $fmt [lindex $pair 0] : [lindex $pair 0]]
        } else {
            puts -nonewline [format $fmt "" "" ""]
        }
    }
    puts ""
} 
```

输出：

```
 apple                   bannana                 pineapple               
Total           47      Total           376     Total           210     
a       :       3       i       :       10      m       :       45      
b       :       4       j       :       33      o       :       67      
c       :       18      k       :       245     n       :       98      
d       :       22      l       :       45                              
                        x       :       43 
```

将数据转换为更好的数据结构稍微容易一些。在这里，使用数组：

```
#! /usr/bin/env tclsh
set fruit_apple {{a 3} {b 4} {c 18} {d 22}}
set fruit_bannana {{i 10} {j 33} {k 245} {l 45} {x 43}}
set fruit_pineapple {{m 45} {o 67} {n 98}}
set fruit {apple bannana pineapple}

array set keys {}
array set values {}
array set total {}
set maxl 0
foreach type $fruit {
    set l [set fruit_$type]
    if {[llength $l] > $maxl} {set maxl [llength $l]}
    set total($type) 0
    foreach pair $l {
        lassign $pair key value
        lappend keys($type) $key
        lappend values($type) $value
        incr total($type) $value
    }
}

set fmt "%s\t%s\t%s\t"
foreach type $fruit {
    puts -nonewline [format $fmt "" $type ""]
}
puts ""
foreach type $fruit {
    puts -nonewline [format $fmt Total "" $total($type)]
}
puts ""
for {set i 0} {$i < $maxl} {incr i} {
    foreach type $fruit {
        if {$i < [llength $keys($type)]} {
            puts -nonewline [format $fmt [lindex $keys($type) $i] : [lindex $values($type) $i]]
        } else {
            puts -nonewline [format $fmt "" "" ""]
        }
    }
    puts ""
} 
```

# vim - 映射/宏到“智能”在vim中自动创建撇号对（并忽略收缩）

> ID：14435052
> 
> 赞同：1
> 
> 时间：2013-01-21T08:44:40.660
> 
> 标签：vim

我目前正在使用 closepairs 来满足我的自动关闭需求，并且效果很好。然而，有一个警告——撇号。不要误会我的意思，我需要一直关闭撇号。我不想只是禁用它们。但是每当我输入纯文本时，只要有任何收缩（I'm，Don't，Can't）......这些撇号就会产生。

现在我可以键入以尽快删除它们，但每次都这样做有点不切实际。

有谁知道如果它们是单词的开头，我如何修改 closepairs 脚本以仅自动关闭单引号/撇号？也就是说，它们前面有一个空格字符？

这是当前代码：

```
inoremap <expr> " <SID>pairquotes('"')
inoremap <expr> ' <SID>pairquotes("'")
function! s:pairquotes(pair)
    let l:col = col('.')
        let l:line = getline('.')
        let l:chr = l:line[l:col-1]
        if a:pair == l:chr
            return "\<right>"
        else
            return a:pair.a:pair."\<left>"
endf 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T08:58:40.320

我不知道*closepairs*，但[AutoClose - 插入匹配括号、括号、大括号或引号](http://www.vim.org/scripts/script.php?script_id=1849)插件可以很好地处理这个问题。您可以在[Vim Tips Wiki](http://vim.wikia.com/wiki/Automatically_append_closing_characters)上找到插件替代列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:29:32.740

您确定要仅在空格后自动完成吗？在这种情况下，类似的东西`function('string')`不会在括号后自动完成。

无论如何，您可以根据一些正则表达式检查前一个字符。例如，要避免字母后自动完成：

```
function! s:pairquotes(pair)
    let l:line = getline('.')
    let l:col = col('.')
    let l:chr = l:line[l:col - 1]
    let l:prev = l:line[l:col - 2]

    if l:chr == a:pair
        return "\<right>"
    elseif l:prev !~ "[A-Za-z]"
        return a:pair . a:pair . "\<left>"
    else
        return a:pair
    endif
endfunction 
```

请注意，即使在这个保守的示例中也有例外，例如`r'regex'`在 Python 中键入，因此定义特定于文件类型的行为也可能有意义。

# html - 图像中的主体背景颜色和 div

> ID：14435059
> 
> 赞同：0
> 
> 时间：2013-01-21T08:45:06.673
> 
> 标签：html, css

我只是想知道背景是否是彩色的，而内容 div 是否在图像中是可能的？

```
<body style="background-color: black; ">
  <div id="header" style="background: url('xxx11.png') repeat left top;">

  </div>

  <div id="#container" style="background-image: url(xxx.png)">
  </div>
</body> 
```

当我跑步时，我只能看到黑色但看不到背景图像..

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T08:48:53.757

在不设置 div 的宽度和高度之前，您将看到黑色。您没有设置 div 的宽度或高度，或者其中没有内容。这就是它显示主体黑色的原因。当您使用内联样式时，您可以使用它：

```
<div id="header" style="background: url('xxx11.png') repeat left top; width:*px; height:*px;">
</div>

<div id="container" style="background-image: url(xxx.png); width:*px; height:*px;">
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T08:49:37.977

```
<div id="#container" style="background-url: url(xxx.png)"> 
```

应该

```
<div id="#container" style="background-image: url(xxx.png); width=500px; height=500px;"> 
```

将宽度和高度设置为您需要的任何值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T08:49:41.893

如果你`<div>`是空的，它会非常小（1x1 像素？），所以你不会看到你的背景。

所以你可以使用 CSS 来设置你的 idv 的大小，这样背景就会显示出来。例如，您*可以*使用：

```
#header {
    position:absolute;
    height:200px;
    width: 400px;
} 
```

注意：您的容器 div 的 id 是`#container`，我认为`#`标签 id 中不允许使用 a ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T08:47:19.250

试试下面的代码。

```
background: url(../img/pattern/59.png) 0 0 scroll #ccc;
```

```
<body style="background-color: black; ">
    <div id="header" style="background: url('img/4.png') repeat left top #CCC;height:200px;">

    </div>

    <div id="container" style="background-image: url(img/5.png);height:200px;"></div>
</body>
```

上面的代码已经过测试，因为你没有为 div 定义 height 属性，所以 body 是全黑屏的。

# c# - LINQ获取列表中两个索引之间的项目的方法

> ID：14435066
> 
> 赞同：23
> 
> 时间：2013-01-21T08:45:27.227
> 
> 标签：c#, linq

我有员工对象列表。我只需要在两个索引之间选择两个员工对象（基于开始和结束变量）。以下代码工作正常，但不在 LINQ 中。`LINQ`为此目的最好的代码是什么？

注意：我正在寻找`Method Chain`方法

**代码**

```
public static class DatabaseSimulator
{

    public static List<Employee> GetData(string name, int index, int pageSize)
    {
        List<Employee> searchResult = new List<Employee>();
        List<Employee> employeesSource = SearchEmployees(name);

        int start = ((index - 1) * pageSize)  + 1;
        int end = (index * pageSize);
        for (int i = start; i <= end; i++)
        {
            if (searchResult != null)
            {
                int listCount = employeesSource.Count;
                for (int x = 0; x < listCount; x++)
                {
                    if (x == i)
                    {
                        searchResult.Add(employeesSource[x]);
                        break;
                    }
                }
            }
        }

        return searchResult;

    }

    private static List<Employee> SearchEmployees(string name)
    {
        List<Employee> employees = GetEmployees();
        return employees.Where(r => r.Name == name).ToList();
    }

    private static List<Employee> GetEmployees()
    {
        List<Employee> employees = new List<Employee>();
        int i = 0;
        for (i = 0; i <= 100; i++)
        {
            Employee emp = new Employee();
            emp.EmpID = i;
            if (i % 2 == 0)
            {
                emp.Name = "Divisible by 2";
            }
            else if  (i % 3 == 0)
            {
                emp.Name = "Divisible by 3";
            }
            else if (i % 5 == 0)
            {
                emp.Name = "Divisible by 5";
            }
            else if (i % 7 == 0)
            {
                emp.Name = "Divisible by 7";
            }
            else 
            {
                emp.Name = "Other -- "+ i.ToString();
            }

            employees.Add(emp);
        }

        return employees;
    }

} 
```

**客户**

```
List<Employee> searchResult = DatabaseSimulator.GetData("Divisible by 2", 2, 2); 
```

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-01-21T08:46:24.087

您可以使用`list.Skip(startIndex).Take(endIndex - startIndex)`构造。

在哪里

`startIndex`: 是要选择的*第一个*项目的索引

`endIndex`*:最后一个*要选择的项目的是和索引

# php - Twig 不呈现 HTML 标签

> ID：14435071
> 
> 赞同：7
> 
> 时间：2013-01-21T08:45:33.527
> 
> 标签：php, twig

请我想知道为什么树枝会像这样溢出输出：http: [//twig.sensiolabs.org/doc/tags/filter.html](http://twig.sensiolabs.org/doc/tags/filter.html)

这就是我正在使用的：

```
class MyClass {

  public function loadViewWithContent($name, $variables) {
    $twig = load_twig();
    // look at the pages dir
    $page = getdir("pages") . $name . '.html';
    $variables['vars'] = $this->menuItem();
    if(file_exists($page)) {
      print $twig->render($name . '.html', $variables);
    }
  }

  public function menuItem() {
    $loginmenu = array(
      'text' => 'Login',
      'path' => '/login',
      'attributes' => array(
        'target' => '',
        'title' => 'Login'
      )
    );   
    $menus = array(
      'primary_menu' => array(
        'login' => $this->theme_link($loginmenu),
      ),
    );

    return $menus;
  }

  public function theme_link($menu) {

    if(is_array($menu)) {
      $output = '<a href="' . $menu['path'] . '">' . $menu['text'] . '</a>';
    }
    return $output;
  }

}

$clazz = new MyClass();
$clazz->loadViewWithContent('home', array()); 
```

**主页.html**

```
{{ vars.primary_menu.login }} 
```

`<a href="/login">Login</a>` 在浏览器中显示

为什么 HTML 标签在浏览器中显示时不呈现？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-21T08:50:28.097

[Autoescape](http://twig.sensiolabs.org/doc/tags/autoescape.html)可能处于活动状态。您可能想告诉 Twig 登录是一个“安全”值。

```
{{ vars.primary_menu.login|raw }} 
```

或者

```
{% autoescape false %}
    {{ vars.primary_menu.login }}
{% endautoescape %} 
```

# sqlite - Sqlite：如何为 BLOB 转换（数据为 TEXT）

> ID：14435072
> 
> 赞同：19
> 
> 时间：2013-01-21T08:45:33.763
> 
> 标签：sqlite, casting

我有一个 sqlite 数据库，我想从中提取一列数据类型为 BLOB 的信息。我正在尝试这个：

`SELECT cast(data as TEXT) FROM content`

这显然是行不通的。输出是这样的乱码：

`x��Uak�0�&gt;�8�0Ff;I�.��.i׮%�A��s�M`

内容列中的数据主要是文本，但也可能有图像（我认为如果我转换为 TEXT 可能会导致问题）。我只是想将这些数据提取成可用的格式。有任何想法吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-08-23T11:00:51.157

您可以使用

```
SELECT hex(data) FROM content 
```

或者

```
SELECT quote(data) FROM content 
```

第一个将返回一个十六进制字符串 ( `ABCD`)，第二个引用为 SQL 文字 ( `X'ABCD'`)。

请注意，（目前）没有办法将十六进制列信息转换回 SQLite 中的 BLOB。您将不得不使用 C/Perl/Python/... 绑定来转换和导入它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T09:05:44.473

您可以编写一些简单的脚本，将数据库中的所有 blob 保存到文件中。稍后，您可以查看这些文件并决定如何处理它们。

例如，此 Perl 脚本将在当前目录中创建大量文件，这些文件将包含您的数据 blob 字段。只需调整 SELECT 语句以根据需要限制获取的行：

```
use DBI;

my $dbh = DBI->connect("dbi:SQLite:mysqlite.db")
    or die DBI::errstr();
my $sth = $dbh->prepare(qq{
    SELECT id, data FROM content
});
$sth->execute();
while (my $row = $sth->fetchrow_hashref()) {
    # Create file with name of $row->{id}:
    open FILE, ">", "$row->{id}";
    # Save blob data into this file:
    print FILE $row->{data};
    close FILE;
}
$dbh->disconnect(); 
```

# json - 我们如何从fai 3转换为 3 在 WSO2 ESB 中使用 xpath

> ID：14435077
> 
> 赞同：-1
> 
> 时间：2013-01-21T08:45:52.827
> 
> 标签：json, xpath, wso2, wso2esb

我得到这样的JSON

```
{"request":""AttributesCriteriaList":[
            {"FieldName":"PartyBranchId","OperationType":1,"FieldValue":"-1500000000","JoinType":2},
            {"FieldName":"AssetTypeId","OperationType":1,"FieldValue":"-1500000001","JoinType":2},
            {"FieldName":"PeriodFrom","OperationType":10,"FieldValue":"1356998400","JoinType":2},
            {"FieldName":"PeriodTo","OperationType":11,"FieldValue":"1358208000","JoinType":2},
            {"FieldName":"Status","OperationType":1,"FieldValue":"4","JoinType":2}
            ]
} 
```

我怎样才能转换成

```
{"assetid":"150000001","partybranchid":"152555222"} 
```

在 WSO2 ESB 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T11:13:30.227

最简单的方法是使用 XSLT 翻译给定的消息（如果您知道编写 XSLT，这似乎很简单）然后您只需要编写一个代理（在 WSO2 ESB 中），

```
 <proxy name="JSONTOJSONTranformProxy" transports="https,http">
  <target>
  <inSequence>
     <xslt key="translate.xslt"/>
     <property name="messageType" value="application/json" scope="axis2"/>
     <send>
        <address ="[SOME_ADDRESS]"/>
     </send>
  </inSequence>
  <outSequence>
     <send/>
  </outSequence>
  </target>
 </proxy> 
```

# java - LWJGL - 渲染周期屏幕闪烁

> ID：14435085
> 
> 赞同：3
> 
> 时间：2013-01-21T08:46:25.280
> 
> 标签：java, rendering, lwjgl

我正在使用 LWJGL 2.8.5 开发一个 3D 可视化应用程序。在阅读了项目主页上的第一个教程后，我还阅读了一本 OpenGL 书籍，深入分析了我的分析。我看到 OpenGL 中的典型过程是在 init 函数中绘制场景，然后简单地在循环中调用显示的更新。

但是，当我使用 LWJGL 尝试此操作时，我会在显示屏上看到闪烁效果。消除闪烁的唯一方法是在显示更新周期中重新绘制场景。为什么会这样？

为了更好地解释我的问题，我创建了一个简单的类来重现该问题。它只是在屏幕中央绘制一个四边形，然后进入无限的屏幕更新循环。

请注意，如果我取消注释循环内的绘图调用，那么闪烁就会消失，一切正常。为什么？

我期望只绘制一次对象并移动相机以获得静态场景的不同视图，这有什么问题吗？

这是代码：

```
package test;
import org.lwjgl.LWJGLException;
import org.lwjgl.opengl.Display;
import org.lwjgl.opengl.DisplayMode;
import org.lwjgl.opengl.GL11;
import org.lwjgl.util.glu.GLU;

import static org.lwjgl.opengl.GL11.*;

public class DisplayTest 
{

public static void initGL()
{
    GL11.glViewport(0, 0, 640, 480);
    glMatrixMode(GL_PROJECTION);
    GLU.gluPerspective(45.0f, 640f/480f,0.1f, 100.0f); 

    draw();

}

public static void draw()
{
    glMatrixMode(GL_MODELVIEW);

    GL11.glLoadIdentity(); // Reset The Current Modelview Matrix
    GL11.glTranslatef(0, 0, -6.0f);//Place at the center at -6 depth units

    //Start drawing a quad
    //--------------------------------------------------
    GL11.glBegin(GL11.GL_QUADS); 
    int size=1;
    GL11.glColor3f(.3f, .5f, .8f); 

    GL11.glVertex3f(-size/2f,-size/2f,+size/2f);
    GL11.glVertex3f(+size/2f,-size/2f,+size/2f);
    GL11.glVertex3f(+size/2f,+size/2f,+size/2f);
    GL11.glVertex3f(-size/2f,+size/2f,+size/2f);
    glEnd();
}

public static void main(String[] args) 
{
    try 
    {
        // Sets the width of the display to 640 and the height to 480
        Display.setDisplayMode(new DisplayMode(640, 480));
        // Sets the title of the display 
        Display.setTitle("Drawing a quad");
        // Creates and shows the display
        Display.create();
    } 
    catch (LWJGLException e) 
    {
        e.printStackTrace();
        Display.destroy();
        System.exit(1);
    }

    initGL();

    // While we aren't pressing the red button on the display
    while (!Display.isCloseRequested()) 
    {
        //draw();

        // Update the contents of the display and check for input
        Display.update();
        // Wait until we reach 60 frames-per-second
        Display.sync(60);
    }
    // Destroy the display and render it invisible
    Display.destroy();
    System.exit(0);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T02:08:40.660

默认情况下，OpenGL 维护两个缓冲区：前缓冲区和后缓冲区。前缓冲区是显示的内容，而后缓冲区是您绘制的内容。这称为双缓冲，可防止向用户显示部分渲染的场景。每当您调用 Display.update() 时，lwjgl 都会告诉 opengl 将后台缓冲区的内容移动到前台缓冲区以进行显示。这可以通过复制数据来完成，或者通过将旧的前缓冲区标记为新的后缓冲区并将旧的后缓冲区标记为新的前缓冲区（交换缓冲区）来完成。

这适用于正常情况，例如在您想要每秒绘制 60 次新内容的游戏中。现在，如果您实际上没有绘制任何东西，但仍调用 Display.update()（例如获取输入），缓冲区仍会移动。现在取决于它是如何实现的，要么你仍然看到你的旧图像（如果数据被简单地复制，因为你的后台缓冲区仍然包含你渲染的数据），或者你在缓冲区之间交替使用每个 Display.update()已经绘制并且在您渲染时作为前缓冲区的缓冲区（可能只是黑色）。这会导致您看到的闪烁，因为图像仅每隔一帧显示一次（原始后缓冲区），每隔一帧就会看到黑色的原始前缓冲区。

对于某些驱动程序实现（例如来自 Nvidia），Windows 似乎甚至可以在活动的前端缓冲区上绘图，因此如果您不重绘场景，即使在关闭后对话框也可以显示和显示。

最干净的解决方案是在初始化中简单地渲染到纹理（从 OpenGL 1.1 开始工作）或渲染缓冲区（在 OpenGL 3.0 中引入），然后在每一帧渲染这个纹理。这确实是 OpenGL 设计者为这类事情想到的解决方案。

**编辑**：要么取消注释上述代码中的 draw 方法，要么如果由于渲染时间而无法选择，则必须渲染到纹理。使用 OpenGL 3 或更高版本，您需要在您的 init 中添加如下内容：

```
fbo = GL30.glGenFramebuffers();
GL30.glBindFramebuffer(GL30.GL_FRAMEBUFFER, fbo);

rbo = GL30.glGenRenderbuffers();
GL30.glBindRenderbuffer(GL30.GL_RENDERBUFFER, rbo);
GL30.glRenderbufferStorage(GL30.GL_RENDERBUFFER, GL11.GL_RGBA8, 640, 480);
GL30.glFramebufferRenderbuffer(GL30.GL_FRAMEBUFFER, GL30.GL_COLOR_ATTACHMENT0, GL30.GL_RENDERBUFFER, rbo);

assert(GL30.glCheckFramebufferStatus(GL30.GL_FRAMEBUFFER) == GL30.GL_FRAMEBUFFER_COMPLETE);

GL30.glBindFramebuffer(GL30.GL_DRAW_FRAMEBUFFER, fbo);
GL20.glDrawBuffers(GL30.GL_COLOR_ATTACHMENT0);
GL11.glClear(GL11.GL_COLOR_BUFFER_BIT);

drawScene(); //draw here 
```

然后，您调用每一帧的绘制方法将被简化为来自帧缓冲区 fbo 的简单快速的副本：

```
GL30.glBindFramebuffer(GL30.GL_READ_FRAMEBUFFER, fbo);
GL11.glReadBuffer(GL30.GL_COLOR_ATTACHMENT0);
GL30.glBindFramebuffer(GL30.GL_DRAW_FRAMEBUFFER, 0);
GL20.glDrawBuffers(GL11.GL_BACK_LEFT);

GL30.glBlitFramebuffer(0, 0, 640, 480, 0, 0, 640, 480, GL11.GL_COLOR_BUFFER_BIT, GL11.GL_NEAREST);
GL30.glBindFramebuffer(GL30.GL_FRAMEBUFFER, 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T08:59:49.917

您应该在循环中使用 Display.sync(60)（LWJGL 命令，将屏幕速率降低到 60FPS），并在渲染结束时使用 Display.update()。Display.update() 将导致交换背景缓冲区和前景缓冲区，因此您看不到图片本身正在构建（这可能是您闪烁的原因）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-25T20:08:01.753

在更新显示之前没有清除屏幕。`GL11.glClear(GL11.GL_COLOR_BUFFER_BIT);`之前 添加`GL11.glBegin(GL11.GL_QUADS);`

# java - 如何在android中实现滑动手势

> ID：14435088
> 
> 赞同：8
> 
> 时间：2013-01-21T08:46:40.027
> 
> 标签：java, android, swipe-gesture

我是安卓新手。在这里，我想实现滑动手势在活动之间导航。我用谷歌搜索了它，并在不同的网站上找到了不同的答案。但我无法得到确切的观点。通过阅读所有这些，我知道我们需要实现`onTouchEvent()`和`onFlingEvent()`.

这些功能是否足以实现 Swipe 动作？请指定如何逐步执行滑动手势。

如果我问了你一个非常简单的问题，我很抱歉，因为我在长时间尝试了许多代码片段后问了这个问题。

任何人都可以解决我的疑问吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T08:49:41.813

`onTouchEvent`足够。你想做的是：

*   创建一个`VelocityTracker`并将视图中的触摸结果提供给它。
*   当您收到 UP 事件时，检查速度是多少。如果它在 X 方向上超过某个阈值量，则算作一次滑动。
*   当你认出它时开始一个新的活动。

您可能需要稍微调整一下阈值，否则草率的点击可能会被误认为是滑动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T08:53:39.850

如果你想滑动你的视图，那么你应该使用`ViewFlipper`你可以`onTouchListener`在 ViewFlipper 上设置一个。您可以`GestureDetector`在 onTouchListener 中注册。这是[Android 转换的一个很好的例子——滑入和滑出](http://www.inter-fuser.com/2009/07/android-transistions-slide-in-and-slide.html)。

# github - Git推拉起源大师不起作用？

> ID：14435093
> 
> 赞同：0
> 
> 时间：2013-01-21T08:47:00.793
> 
> 标签：github

我目前正在尝试将我的一些项目文件推送到 github，但现在我一直在用头撞桌子，试图找出问题所在。任何帮助将不胜感激。

我所做的是我首先在我的 c:/ 目录中创建了一个名为 cs188 的新文件夹，并将我想要提交的所有文件放在该文件夹中。我的目标是将我创建的整个 cs188 文件夹推送到 github。

在 git bash 中，我输入：

```
(in the cs188 folder):
git init

git add .

git commit -m "first commit" 
```

现在我添加遥控器

```
 git remote add origin https://github.com/my_username/myrepos.git 
```

（myrepos 是我在 github 上的存储库的名称）

然后我输入：

```
git push origin master 
```

我收到一条警告说“ `the tip of my current branch is behind its remote counterparts. Merge the remote changes before pushing again`”。

所以现在我输入：

```
git pull origin master 
```

但是一旦完成，我的整个新文件夹就被我的 repos 的内容替换了。
一旦我输入`git push origin master`, now 并登录到我的 github 帐户，什么都没有改变或添加。

有谁知道我在这里做错了什么？
为什么我的新文件夹被我的存储库中的所有文件夹替换？
我应该怎么做才能摆脱“我当前分支的尖端落后于远程分支”，并让我的整个`cs188`文件夹显示在 github 上？

感谢您提供任何帮助，我现在对 github 感到非常沮丧，并且真的可以使用一些帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T08:51:46.367

一种最简单的方法是：

*   克隆新的空 GitHub 存储库
*   将您的文件添加到该本地克隆中，然后提交
*   推

第一次推动将通过以下方式完成：

```
 git push -u origin master 
```

在那之后，一个简单的`git push`就足够了。
请参阅“ [Git：为什么我需要一直这样做`--set-upstream`？](https://stackoverflow.com/questions/6089294/git-why-do-i-need-to-do-set-upstream-all-the-time) ”。

注意：如果您的 Github 存储库不是空的，那么这个想法仍然有效：克隆它并将您的文件添加到其中。
否则，您需要遵循“[无法推送到 github，一直说需要合并](https://stackoverflow.com/questions/10298291/cannot-pushto-github-keeping-saying-need-merge)”。

# java - Java 中 System.out 的类型是什么？

> ID：14435099
> 
> 赞同：5
> 
> 时间：2013-01-21T08:47:07.693
> 
> 标签：java, system.out, system.in

我只是Java的新手。我想知道使用的方式`System.out.println()`。Out 是`System`类内的静态字段。的类型`out`是`PrintStream`。但是当我看到`PrintStream`类的构造函数时，它需要一个类型的参数，`OutputStream`据我所知，我们无法创建抽象类的对象。在这种情况下，我们必须将某个子类的对象传递给`PrintStream`. 那是什么课？也是一样`System.in`。它也是`InputStream`' 的引用，但它指向的对象类型是什么，因为它`InputStream`是抽象的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T09:03:11.817

查看类结构的一种简单方法是在调试器中检查它。

如您所见，@Andremonify 的描述基本上就是您所拥有的。

文件描述符

*   0 是 System.in
*   1 是 System.out
*   2 是 System.err
*   3+ 用于其他文件

![在此处输入图像描述](../Images/cae7682e0de47f853800db91ba63e9c8.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T08:51:35.600

`PrintStream`wraps `BufferedOutputStream`，它 wraps `FileOutputStream`，它正在写入控制台，它有自己的`FileDescriptor`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T09:02:33.517

是`out`的`PrintStream`类型。并且构造函数`PrintStream`采用`OutputStream`类型。`OutputStream`是抽象类。*但是任何超类引用都可以引用子类对象而无需强制转换*，因此 PrintStream 的构造函数具有`OutputStream`引用，但是此引用必须引用`OutputStream`的子类之一`FileOutputStream`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-26T11:45:45.927

关于`System.out`.

1.  的实际实现类`System.out`未*指定*。javadocs 没有说明它是什么。 *我们（以各种方式）观察*到 Oracle Java 和 OpenJDK Java 以特定方式实现“堆栈”（请参阅​​其他答案），但这*可能*会在未来发生变化。

2.  该`System::setOut(PrintStream)`方法可用于修改`System.out`绑定的内容。如果发生这种情况，任何关于实现类的假设都可能是不正确的。

3.  事实证明，您可以这样做：

    ```
     System.setOut(null); 
    ```

    `System.out` *可能*是这样`null`。但是，对于当前的实现，除非您将其设置`System.out`为.`null``null`

规范实际上**保证**的是 的值`System.out`将具有与赋值兼容的类型`PrintStream`。

# mongodb - 在 Mongodb 的 mongoexport 命令中出现断言错误。

> ID：14435100
> 
> 赞同：4
> 
> 时间：2013-01-21T08:47:08.820
> 
> 标签：mongodb

执行此命令后出现错误：

```
mongoexport --db records --collection source_list --csv --out C:\bcopy.csv 
```

**记录**是我的数据库 n **source_list**是我的收藏

它显示此消息：

```
assertion: 9998 you need to specify fields 
```

我也尝试指定字段，但它给了我同样的错误。

我应该在命令中进行哪些更改以获取我的收藏的备份，或者是否有其他方法可以这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-05T17:06:36.170

就我而言 --headerline 有所帮助。我有大约 60 列，用 -f 枚举它们会很麻烦。

--headerline 如果使用“--type csv”或“--type tsv”，则使用第一行作为字段名称。否则， > mongoimport 会将第一行作为不同的文档导入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T09:25:08.717

这是指定要导出的字段的示例命令：

```
mongoexport -h 127.0.0.1 --port 27018 --db mydb --collection system.profile --csv --out profile.csv --fields ns,millis,numYield,nscanned 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T08:52:21.080

似乎您应该使用 -f 参数来选择将导出到 csv 文件的字段。此案例报告了一个错误以更改解释，因为错误消息的信息量不足。

> [https://jira.mongodb.org/browse/SERVER-4224](https://jira.mongodb.org/browse/SERVER-4224)

# jquery - 我无法完成这项工作。ExtraButton 链接到我的操作 (Srtus2-Jquery-Grid)

> ID：14435106
> 
> 赞同：0
> 
> 时间：2013-01-21T08:47:45.483
> 
> 标签：jquery, jqgrid, struts2, struts2-jquery, struts2-jquery-grid

我已经有货了。我为 struts2 jQuery Grid 创建了一个额外的按钮。当我单击该按钮时，它应该转到我的操作。如何在点击时做到这一点？这是我的部分代码。

```
 navigatorExtraButtons="{
            seperator: { 
            title : 'seperator'  
            }, 
            hide : { 
            title : 'Show/Hide', 
            icon: 'ui-icon-wrench', 
            onclick: function(){ load('<s:url action="ProductInitialise"/>')  } //--> this doesn't work.
            },
            alert : { 
            title : 'Alert', 
            caption : 'Show Alert!', 
            onclick: function(){ alert('Grid Button clicked!') }
            }
            }" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:35:12.710

`navigatorExtraButtons`是`<sjg:grid />`Struts2(-jQuery Plugin) 标签的参数。

不能将 Struts2 标签放在另一个 Struts2 标签内；

为此，您必须使用s `OGNL`，如果是`URL`s，您应该在 grid 标记之外定义`URL`s，并使用 引用它们`OGNL`，如下所示：

```
<s:url id="myUrl" action="ProductInitialise" namespace="/myNamespace"/> 
```

……

```
onclick: function(){ load('%{myUrl}') } 
```

假设所有其余部分都在工作（`load`例如函数），这应该足以让它工作。

# php - php中的虚拟文件系统？

> ID：14435108
> 
> 赞同：1
> 
> 时间：2013-01-21T08:47:53.523
> 
> 标签：php, file-upload, download, virtualfilesystem

我们有一个系统，其中很大一部分是在您登录并拥有正确权限的情况下上传和下载文件的能力。

从用户的角度来看，我们正在寻找帮助组织的方法是拥有一个虚拟文件系统类型布局。

即使（甚至最好）所有用户文件实际上都只是存储在一个目录中，而虚拟文件系统只是从数据库中建立的一个屏幕。

在我们投资创建它之前，我们想知道的是它是否已经存在于某个地方，开源（但能够在商业软件中使用）、免费或付费（最好是前两个！）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T08:57:17.450

一个简单的基于 PHP 的文件系统可以通过构建在 PHP 之上的 WebDAV 来完成：

[http://sabre.io/](http://sabre.io/)

这将是一个很好的例子，但也有其他例子。WebDAV 本质上是一个基于 Web 的文件系统 ( [http://en.wikipedia.org/wiki/WebDAV](http://en.wikipedia.org/wiki/WebDAV) )。

这不仅可以提供文件系统，还可以让您直接使用 Word/Excel (2007+) 编辑文件。然后显示文件夹和文件的树状视图将非常简单，使用很少的数据库表和一些 jquery 组件，例如 jsTree 和 jqGrid。

虽然如果您正在搜索完整的文档管理系统：[http](http://www.opendocman.com/) ://www.opendocman.com/或[http://code.google.com/p/simpledoc/](http://code.google.com/p/simpledoc/)，这就足够了。

这实际上取决于您要在该系统中加入多少功能。会不会有OCR，你想把文件存储在云服务中，会有多少用户输入（简单上传就够了，还是需要相机、扫描仪等设备）？

至于商业产品，您可以查看 Microsoft SharePoint ( [http://en.wikipedia.org/wiki/Microsoft_SharePoint](http://en.wikipedia.org/wiki/Microsoft_SharePoint) ) 或 IBM Lotus Notes ( [http://en.wikipedia.org/wiki/IBM_Lotus_Notes](http://en.wikipedia.org/wiki/IBM_Lotus_Notes) )

# c# - 部署时如何更改 Web 服务参考

> ID：14435110
> 
> 赞同：1
> 
> 时间：2013-01-21T08:48:00.060
> 
> 标签：c#, android, mono, xamarin.android

我是一名 Mono Android 开发人员。

当我完成我的应用程序并部署到生产服务器时，我需要将 Web 服务更改为另一台 IIS 服务器，与测试服务器不同。

我尝试以下代码：

```
wfqry = new AndroidApp.WFQuery.WFQuery();

wfqry.Url = "http://192.123.123.1/APPS/WebServices/WFQ.asmx"

wfqry.Discover(); 
```

但收到错误消息

```
System.InvalidOperationException: The url 'http://xxxxxx/APP/WebServices/WFQ.asmx' does not point to a valid discovery document
  at System.Web.Services.Discovery.DiscoveryClientProtocol.Discover (string) <IL 0x00038, 0x001ec>

  at (wrapper remoting-invoke-with-check) System.Web.Services.Discovery.DiscoveryClientProtocol.Discover (string) <IL 0x00033, 0x000a3>

  at System.Web.Services.Protocols.SoapHttpClientProtocol.Discover () <IL 0x00024, 0x0016f>

  at (wrapper remoting-invoke-with-check) System.Web.Services.Protocols.SoapHttpClientProtocol.Discover () <IL 0x00032, 0x00083>

  at test5.Activity1.OnCreate (Android.OS.Bundle) [0x0005d] in d:\TempData2\TestPrij\test5\test5\Activity1.cs:35

  at Android.App.Activity.n_OnCreate_Landroid_os_Bundle_ (intptr,intptr,intptr) [0x00010] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.4-series/c6e52015/source/monodroid/src/Mono.Android/platforms/android-8/src/generated/Android.App.Activity.cs:1490

  at (wrapper dynamic-method) object.a16901a2-0117-4e00-8013-5fc10b948c06 (intptr,intptr,intptr) <IL 0x00017, 0x00043> 
```

怎么了？

或者

请告诉我如何在不删除和重新添加 Web 参考的情况下轻松更改 Web 服务参考

非常感谢！

# apache-flex - 不占用空间的隐藏 mx 控件

> ID：14435120
> 
> 赞同：1
> 
> 时间：2013-01-21T08:48:24.437
> 
> 标签：apache-flex, air

我正在使用 2 个 mx:html 控件，其中一个是隐藏的，应用程序使用它从页面加载外部数据。加载完成后，应用程序将从这个隐藏的 html 控件中抓取信息。

隐藏控件不必占用任何空间，但将宽度和高度设置为 1 会由于某种原因破坏页面。

在下面的示例中，我将 hidHTML 可见属性设置为 false，但它一直占用主窗口中的空间。

有没有办法让 hidHTML 具有宽度和高度但不占用任何空间并且不可见？

```
<mx:HTML id="gui" location="main.html" enabled="true" 
    complete="mainComplete(event)"
    paddingLeft="0" paddingRight="0" width="100%" height="100%" />
<mx:HTML visible="false" x="1" y="1"
    location="http://externalinfo.com"
    id="hidHTML"
    width="250"
    height="100"
    horizontalScrollPolicy="off" 
    verticalScrollPolicy="off"
    enabled="true"
    paddingLeft="0"
    paddingRight="0"
    /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T08:58:46.537

您还需要设置 includeInLayput="false" 然后控件将不占用空间。

# python - 这种与 isinstance() 混合的 Python 鸭子类型方法是否有意义？

> ID：14435122
> 
> 赞同：1
> 
> 时间：2013-01-21T08:48:38.997
> 
> 标签：python, oop, duck-typing

假设我们有以下类：

```
class Duck(object):
    pass

class OldFashionedDuck(Organism, Duck):
    def look(self):
        self.display_biological_appearance()
    def walk(self):
        self.keep_balance_on_two_feet()
    def quack(self):
        self.make_noise_with_lungs("Quack!")

class ArtificialDuck(Robot, Duck):
    def look(self):
        self.display_imitation_biological_appearance()
    def walk(self):
        self.engage_leg_clockwork()
    def quack(self):
        self.play_sound("quack.au") 
```

在这个例子中，OldFashionedDuck 和ArtificialDuck 没有共同的实现，但是通过构造它们都将为isinstance(..., Duck) 返回True。

这并不完美，但我认为这可能有助于尊重鸭子类型，并且（通过空的 mixin 继承）允许 isinstance()。本质上，它提供了一个满足接口的契约，因此它并不是真正基于完成所有工作的类调用 isinstance()，而是基于任何人都可以选择加入的接口。

我看过基于“isinstance() 被认为有害”的文章，因为它破坏了鸭子类型。但是，我至少作为一名程序员想知道，如果不一定是对象从哪里获取函数，而是它是否实现了接口。

这种方法有用吗？如果有用，可以改进吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T09:08:59.980

> 我看过基于“isinstance() 被认为有害”的文章，因为它破坏了鸭子类型。但是，我至少作为一名程序员想知道，如果不一定是对象从哪里获取函数，而是它是否实现了接口。

我认为你没有抓住重点。

当我们谈论“duck typing”时，我们真正的意思*不是形式化我们的接口*。因此，您要尝试做的事情归结为尝试回答“如何在仍然不使界面形式化的情况下形式化我的界面？”的问题。

我们期望给我们一个对象来实现一个接口——我们描述的一个接口，不是通过创建一个基类，而是通过编写一堆文档和描述行为（如果我们感觉特别活泼，设置某种测试套件） - 因为我们说过这是我们所期望的（再次在我们的文档中）。我们通过尝试像使用它一样使用它来验证对象是否实现了接口，并将任何产生的错误视为调用者的责任。调用给我们错误对象的代码是很顽皮的，这就是需要修复错误的地方。（同样，测试帮助我们追踪这些事情。）

简而言之，测试`isinstance(this_fuzzball_that_was_handed_to_me, Duck)`并没有真正的帮助：

*   它可以通过`isinstance`检查，但以违反我们期望（或者说，`return NotImplemented`）的方式实现这些方法。只有真正的测试才会在这里进行。

*   它可以通过检查，但实际上完全没有实现一个或多个方法；毕竟，基础`Duck`不包含任何实现，Python 没有理由在派生类中检查它们。

*   也许更重要的是，它可能无法通过检查，即使它是一个完全可以像鸭子一样使用的绒毛球。也许它是一些不相关的对象，它`quack`直接`walk`作为`look`属性手动附加到它（而不是它们是它的类的属性，当查找时它们成为方法）。

好的，所以，“不要那样做”，你说。但是现在你正在为每个人做更多的工作；如果客户并不*总是*选择加入，那么使用鸭子的代码进行检查是无用且危险的。同时，你得到了什么？

这与 EAFP 原则有关：不要试图通过看某物来判断它是否是 Duck；通过将其视为鸭子并处理血淋淋的烂摊子来确定它是否是鸭子。

* * *

但是，如果您不关心鸭子类型的哲学，并且绝对必须对事物施加一些严格的外表，那么您可能会对标准库`abc`模块感兴趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:17:44.540

尽管我不想高估这个术语，但是：你的方法不是 pythonic。做鸭子打字，或者不做。

如果您想确保您的“接口”实现实现了它应该实现的一切：测试它！

对于较小的项目，很容易记住您需要什么。你可以简单地尝试一下。

我同意对于较大的项目，甚至团队合作，最好确保您的类型拥有所需的一切。在这种情况下，您绝对应该使用单元测试来确保您的类型是完整的。即使没有鸭式打字，您也需要测试，因此您可能不需要任何额外的测试。

[Guido van Rossum 在本次演讲](https://www.youtube.com/watch?v=EBRMq2Ioxsc)中谈到了一些关于鸭式打字的有趣想法。它是如此鼓舞人心，绝对值得一看。

# mingw - 管道的 Ghostscript（MinGW 编译）问题

> ID：14435126
> 
> 赞同：0
> 
> 时间：2013-01-21T08:48:49.817
> 
> 标签：mingw, pipe, ghostscript, djvu

解决方案在最后一条评论中，但以防万一有人在寻找解决方法，我在这里总结了它：http: [//sourceforge.net/mailarchive/message.php ?msg_id=30391589](http://sourceforge.net/mailarchive/message.php?msg_id=30391589)

* * *

我设法用 MinGW 和当前稳定的 GhostScript (9.06)构建[了 GSDjVu 。](http://djvu.sourceforge.net/gsdjvu.html)将 Bash 脚本转换为 CMD 的任务并不难，但令我惊讶的是`gsdjvu`（带有 gsdjvu 驱动程序的 gs 解释器）没有按预期接受 PDF 输入。它只接受 PostScript。为了避免编写巨大的临时文件，我想创建一个管道，下面是示例：

```
set args=-sstdout=nul -dSAFER -dNOPAUSE -dBATCH

gs %args% -sDEVICE=pswrite -sOutputFile=- test.pdf |^
   gsdjvu %args% -sDEVICE=djvusep -sOutputFile=- - |^
   csepdjvu - test.djvu 
```

导致错误：

```
*** csepdjvu: corrupted input file (lost RLE sync.)
*** (..\..\..\tools\csepdjvu.cpp:647)

Internal error at ./base/gdevdjvu.c:2831 
```

如果我将结果输出`gsdjvu`到文件而不是管道，则没有错误：

```
gs %args% -sDEVICE=pswrite -sOutputFile=- test.pdf |^
   gsdjvu %args% -sDEVICE=djvusep -sOutputFile=test.sep -

csepdjvu test.sep test.djvu 
```

现在，如果我比较（test.sep）的文件输出`gsdjvu`和相同（test2.sep）的管道输出：

```
gs %args% -sDEVICE=pswrite -sOutputFile=- test.pdf |^
   gsdjvu %args% -sDEVICE=djvusep -sOutputFile=- - > test2.sep 
```

我得到了这个差异：

![截屏](../Images/cca2843b5f54cf315b27422957b10c32.png)

经过简单的分析后发现，`0A`在管道输出中表示为`0D0A`，或者“行尾”从 Unix LF 更改为 Windows CRLF。

为什么会这样，有办法补救吗？
或者它可能是一个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T08:27:10.440

我不确定 DjVuLibre 如何无法接受 PDF 作为输入，因为据我所知它是一个 Ghostscript 设备。你有一些文件说这不能做吗？如果是这样，我会向维护者投诉，我看不出有任何理由。

由于这适用于文件输出，因此合乎逻辑的答案是正在进行一些换行符翻译。

一些快速的谷歌搜索表明有很多关于这个的讨论，但我看不到任何与你的经历完全匹配的东西。您可能应该将此标记为 MingW，或者更明智地将其带到 MingW 支持论坛。

或者只是停止管道 I/O。

# download - 通过 Web 模式 CLI 从 PR/CR 下载附件

> ID：14435127
> 
> 赞同：0
> 
> 时间：2013-01-21T08:48:50.593
> 
> 标签：download, attachment, cm-synergy

有没有办法通过 Web 模式 CLI 从 Rational Change Server 中的 CR/PR 下载附件？我知道通过经典客户端的 ccm 可以做到这一点，但在 Web 模式 CLI 中以相同的方式是不可能的（即**ccm*导出***不存在或存在权限问题）。

问候， 帕维尔

**编辑：** 我最终找到了解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T09:33:21.977

您可以 cat 由其对象名表示的对象的内容，问题是附件的对象名内部有一个空格......

```
ccm query "is_attachment_of(cr('CR_PR_displayname'))" -u -f "%objectname %attachment_name %attachment_size" 
```

然后使用附件的对象名称：

```
ccm cat objectname_of_an_attachment > C:\attachment_name 
```

**attachment_name** - 保存带有扩展名的名称

**attachment_size** - 以字节为单位保存大小

# php - 如何将 Google Analytics 代码添加到 Drupal 7

> ID：14435131
> 
> 赞同：7
> 
> 时间：2013-01-21T08:49:08.710
> 
> 标签：php, drupal, drupal-7, google-analytics, drupal-theming

我想在不使用该模块的情况下将我的 Google Analytics 代码添加到我的 Drupal 站点。我阅读了与此相关的主题，但无法在我的网站上发布。我想把我的代码放在`<head></head>`标签里。这是我的代码：

```
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-XXXXXXX-X']);
  _gaq.push(['_setDomainName', 'example.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-21T08:59:50.663

打开`modules/system`Drupal 安装中的文件夹，然后将`html.tpl.php`文件复制到主题目录。将您喜欢的代码添加到文件中并保存。

不要忘记清除缓存。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-06-19T22:13:58.963

在 Drupal 站点上，您想在 template.php 文件的 THEME_preprocess_html 函数中使用 drupal_add_js 函数插​​入额外的 javascript。这样做可以让您正确缓存您的网站。具体来说，这就是它的外观：

```
<?php
    function THEME_preprocess_html(&$variables) {

      $ga  = "var _gaq = _gaq || [];\n";
      $ga .= "_gaq.push(['_setAccount', 'UA-XXXXXXX-X']);\n";
      $ga .= "_gaq.push(['_setDomainName', 'example.com']);\n";
      $ga .= "_gaq.push(['_trackPageview']);\n";
      $ga .= "(function() {\n";
      $ga .= "  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;\n";
      $ga .= "  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';\n";
      $ga .= "  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);\n";
      $ga .= "})();\n";

      drupal_add_js($ga, array('type' => 'inline', 'scope' => 'header'));
    }
?> 
```

Be sure to replace the UA ID and website name with your own. Also, be sure to rename THEME to your theme and clear the cache when complete.

# javascript - 什么是与 JavaScript 等效的 DigestUtils sha256 编码？

> ID：14435132
> 
> 赞同：1
> 
> 时间：2013-01-21T08:49:10.393
> 
> 标签：javascript, apache-commons, sha, sha256

我调用以下并创建密码哈希。

```
ByteString password = ByteString.copyFrom(DigestUtils.sha256("mypassword")); 
```

但现在我需要从客户端（JavaScript）发送经过 sha256 转换的密码消息。我厌倦了使用 CryptoJS 如下

```
 var pass = CryptoJS.SHA256(document.getElementById('password').value);
    var passhash = pass.toString(CryptoJS.enc.Latin1)
    login(passhash); 
```

我尝试了所有 Base64、Latin1 和 Hex 类型来获取字符串。但它不会产生与 Java 相同的密码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:39:17.297

问题在于字符编码。以下修复了问题。

在 JS 中：

```
var password = pass.toString(CryptoJS.enc.Utf16); 
```

在 Java 中：

```
byte[] passhash = jsCryptoString.getBytes("UTF-16BE"); 
```

# asp.net-mvc - 如果为空，则将区域、控制器和操作名称映射为默认值

> ID：14435133
> 
> 赞同：0
> 
> 时间：2013-01-21T08:49:12.577
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我得到 3 个字符串`area`：`controller`和`action`. 其中一些可能有空值，因为在我的路线中定义了默认值。例如，如果`action`为空，它将被映射到`Index`.

我希望通过我的应用程序的路由传递这 3 个字符串，并在映射到默认值的任何空值之后获取它们的实际值。这可能吗？

也许通过做这样的事情是可行的

```
RouteTable.Routes.GetRouteData(context) 
```

但是有没有办法在不构造整个`HttpContext`对象的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T23:47:02.390

您要做的第一件事是获取三个字符串并将其转换为可以通过路由系统传递的 URL。您如何执行此操作取决于您创建了哪些路线。假设您的路由表中有典型的默认路由：

```
 context.MapRoute(
            "Admin_default",
            "Admin/{controller}/{action}/{id}",
            new { controller="Home", action = "Index", id = UrlParameter.Optional }
        ); 
```

然后您必须使用 URL 模式“{area}/{controller}/{action}/{id}”来构建您的 URL。在您的情况下，某些字符串可能为空，因此您的 URL 不会包含所有段。例如，如果 Area="Admin" 且 Controller 和 Action 为空，则基于此路由的 URL 将是：

```
~/Admin 
```

当然，这提出了一个问题，如果您已经知道系统中的路由，为什么不能通过查看路由来获取默认值。

获得要测试的 URL 后，您需要创建 HttpContentBase 对象的模拟，然后通过 RouteTable.Routes.GetDate(httpContext) 运行它。有简单的样板代码可以做到这一点，因为你真的不需要模拟很多组成的 HttpRequestBase 或 HttpResponseBase 类。例如，有关使用 Moq 模拟框架模拟 HttpContextBase 对象的示例，请参见[此处。](https://stackoverflow.com/questions/1228179/mocking-httpcontextbase-with-moq)

# github - 在 github 中托管 chrome 扩展

> ID：14435136
> 
> 赞同：1
> 
> 时间：2013-01-21T08:49:29.847
> 
> 标签：github, google-chrome-extension

我开发了一个 chrome 扩展，想知道如何在 github 中托管 .crx。

我也看到这与我的相似（即托管在 github 中）： [https ://github.com/franverona/MarkAsRead-Chrome-Extension](https://github.com/franverona/MarkAsRead-Chrome-Extension)

但安装说明似乎很复杂（即使这样也没有测试过）。

Q：有没有人成功把.crx托管在github上，让用户一键安装？[（基本上满足谷歌在http://developer.chrome.com/extensions/hosting.html](http://developer.chrome.com/extensions/hosting.html)给出的标题约束 ）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T08:26:58.003

好的，这就是结果：

1.  在我们自己的服务器中托管在最新版本的 chrome 中不起作用。它引导我访问 google chrome 的支持部分，说明出于安全原因他们已完全禁用它

2.  所以剩下的唯一选择（因为我不想在 chrome 网上商店中托管它）是手动安装 - 用户必须下载我的扩展并将其拖放到 chrome://extensions 页面

3.  与 github 相比，我选择了 google 代码（下载部分）来托管我的 .crx，因为在 github 中下载并不简单。更多详细信息：在 github 中，用户必须以“原始”格式下载。对于用户来说，这可能并不简单——如果他们对 .crx 说“另存为”而不去原始视图，那么他们最终会得到 git 混搭文件（换句话说，不是我们上传的原始文件）

# css - rails中的背景图片

> ID：14435141
> 
> 赞同：2
> 
> 时间：2013-01-21T08:49:46.353
> 
> 标签：css, ruby-on-rails, ruby-on-rails-3

我有rails 3.2.9，我想放一张背景图片。我的图像在文件夹中找到：`public/images`我也把它放在文件夹中：`assets/images`。

```
ul { 
    height: 200px; 
    width: 350px; 
    border: solid 1px blue; 
    margin: 0 auto; 
    padding: 0px;
    background-image: url('/images/todo.png'); 
} 
```

但没有背景图像。请帮忙。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T14:11:24.370

我必须说：

```
background-position: center; 
```

所以我的代码是：

```
background: url(/assets/rsz_todo.png) no-repeat;
background-position: center; 
```

我的图像位于`assets/images`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T09:14:54.467

一种简单的检查方法（在编辑 CSS 之前）是在浏览器中输入路径。这样您就可以确定路径应该是什么。

您的**app/assets/images**文件夹映射到：

```
http://domain/assets/ 
```

因此，如果您有一个 app/assets/images/logo.png，您应该能够**在浏览器**中检索它，例如：

```
http://domain/assets/logo.png 
```

然后，在您的 CSS 中，您应该能够引用您的 logo.png，例如：

```
// app/stylesheets/application.css
body {
 background: url(/assets/logo.png) no-repeat;
} 
```

还可以查看 Rails 资产管道：

[http://guides.rubyonrails.org/asset_pipeline.html](http://guides.rubyonrails.org/asset_pipeline.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-12T04:57:00.173

如果这有助于任何人找到这个... [Rails 提供了帮助方法来引用 CSS 或 SASS 文件中的资产](http://guides.rubyonrails.org/asset_pipeline.html#css-and-sass)：

```
background-image: image-url("rails.png") 
```

变成...

```
background-image: url(/assets/rails.png); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T09:49:12.143

你为什么不试试：

```
background: url(image.png) 
```

资产管道是为简单起见而组成的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-21T08:57:41.470

如果您将图像放在 assets/images 中，那么在调用该图像时，您应该使用

```
background-image:url("/assets/image.png"); 
```

或者你可以试试

```
 background:url("/assets/image.png"); 
```

有时我发现使用背景而不是背景图像效果更好，但这只是个人经验

# node.js - Cloud9如何连接MongoDB？

> ID：14435143
> 
> 赞同：4
> 
> 时间：2013-01-21T08:49:57.010
> 
> 标签：node.js, mongodb, cloud9-ide

Cloud9中连接数据库MongoDB有问题请帮忙解决这个问题！

```
var MongoClient = require("mongodb").MongoClient;
var port = process.env.PORT;
var ip   = process.env.IP;
MongoClient.connect("mongodb://"+ip+":"+port+"/test",function(error,db){
        if(!error){
         console.log("We are connected");   
        }
        else{
         console.dir(error); //failed to connect to [127.4.68.129:8080]               
        }
}); 
```

输出：

```
Running Node Process
Your code is running at 'http://demo-project.alfared1991.c9.io'.
Important: use 'process.env.PORT' as the port and 'process.env.IP' as the host in your scripts!
[Error: failed to connect to [127.4.68.129:8080]] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-08-22T12:51:22.693

如果您关注[https://docs.c9.io/setting_up_mongodb.html](https://docs.c9.io/setting_up_mongodb.html)此链接，您将在工作区下设置和运行 mongodb 守护程序。

如果你看一下 的输出`./mongod`，你会发现这个输出：

```
2015-08-22T12:46:47.120+0000 [initandlisten] MongoDB starting : pid=7699 port=27017 dbpath=data 64-bit host=velvetdeth-express-example-1804858 
```

只需将主机和端口值复制到您的 mongodb 配置中，设置数据库 url，在本例中为：

```
mongodb://velvetdeth-express-example-1804858:27017 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T09:41:25.173

`process.env.PORT`并且`process.env.IP`是您的应用程序的端口和 IP 地址，而不是您的数据库。您需要从 MongoDB 提供程序中提取 Mongo 连接字符串。

下面是修改为使用两个环境变量的[Node.js 主页中的 hello world 示例。](http://nodejs.org/)

```
var http = require('http');
http.createServer(function (req, res) {
  res.writeHead(200, {'Content-Type': 'text/plain'});
  res.end('Hello World\n');
}).listen(process.env.PORT || 1337, process.env.IP || '127.0.0.1'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-25T16:18:37.813

对于遇到此问题的其他人，解决方案在这里：[https ://docs.c9.io/setting_up_mongodb.html](https://docs.c9.io/setting_up_mongodb.html)

MongoDB 预安装在 Cloud9 工作区中。运行这个：

```
$ mkdir data
$ echo 'mongod --bind_ip=$IP --dbpath=data --nojournal --rest "$@"' > mongod
$ chmod a+x mongod 
```

要启动 Mongodb 进程，请运行：

```
$ ./mongod 
```

然后“运行”你的 node.js 应用程序脚本，你就可以参加比赛了。

以下是参数的含义：

> --dbpath=data（因为它默认为 /var/db 不可访问）
> 
> --nojournal 因为 mongodb 通常会预先分配 2 GB 的日志文件（超过 Cloud9 磁盘空间配额）
> 
> --bind_ip=$IP（因为你不能绑定到 0.0.0.0）
> 
> --rest 在默认端口 28017 上运行

# java - 我应该怎么做才能将我的 gps 坐标自动存储在 mysql 数据库中？

> ID：14435145
> 
> 赞同：1
> 
> 时间：2013-01-21T08:50:04.153
> 
> 标签：java, android, mysql, gps

我的代码没有错误，我想学习的是在没有按钮的情况下将数据传递到我的数据库。目前我必须先单击我的按钮，然后才能将我的 gps 坐标传递给我的数据库，但正如我所提到的，我想在我的应用程序运行时传递它。

这是我的代码：

**

```
public class Sample extends Activity{
    private ProgressDialog pDialog;
    JSONParser jsonParser = new JSONParser();

    EditText textLat;
    EditText textLong;

    // url to create new product
    private static String url_create_product = "http://10.0.2.2/SampleLocation/index.php";

    // JSON Node names
    private static final String TAG_SUCCESS = "success";
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main1);
        textLat = (EditText) findViewById(R.id.textLat);
        textLong = (EditText) findViewById(R.id.textLong);
        Button btnOK = (Button) findViewById(R.id.btnOK);
        //to run the location class
        LocationManager lm = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        LocationListener ll = new myLocationlistener();
        lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, ll);

        //to run the createnewproduct class
        btnOK.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View view) {
                // creating new product in background thread
                new CreateNewProduct().execute();
            }
        });

    }
    class myLocationlistener  implements LocationListener {
        @Override
        public void onLocationChanged(Location location) {
            if (location != null) {
                double pLong = location.getLongitude();
                double pLat = location.getLatitude();
                textLat.setText(Double.toString(pLat));
                textLong.setText(Double.toString(pLong));
            }
        }
        @Override
        public void onProviderDisabled(String provider) {
            // TODO Auto-generated method stub
        }
        @Override
        public void onProviderEnabled(String provider) {
            // TODO Auto-generated method stub
        }
        @Override
        public void onStatusChanged(String provider, int status, Bundle extras) {
            // TODO Auto-generated method stub
        }
    }

    class CreateNewProduct extends AsyncTask<String, String, String> {

        /**
         * Before starting background thread Show Progress Dialog
         * */
        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            pDialog = new ProgressDialog(Sample.this);
            pDialog.setMessage("Sending Location");
            pDialog.setIndeterminate(false);
            pDialog.setCancelable(true);
            pDialog.show();
        }

        /**
         * Creating product
         * */
        protected String doInBackground(String... args) {
            String latitude = textLong.getText().toString();
            String longitude = textLat.getText().toString();

            // Building Parameters
            List<NameValuePair> params = new ArrayList<NameValuePair>();
            params.add(new BasicNameValuePair("latitude", latitude));
            params.add(new BasicNameValuePair("longitude", longitude));

            // getting JSON Object
            // Note that create product url accepts POST method
            JSONObject json = jsonParser.makeHttpRequest(url_create_product,
                    "POST", params);

            // check log cat fro response
            Log.d("Create Response", json.toString());

            // check for success tag
            try {
                int success = json.getInt(TAG_SUCCESS);

                if (success == 1) {
                    // successfully created product
                    Intent i = new Intent(getApplicationContext(), Echos.class);
                    startActivity(i);

                    // closing this screen
                    finish();
                } else {
                    // failed to create product
                }
            } catch (JSONException e) {
                e.printStackTrace();
            }

            return null;
        }

        /**
         * After completing background task Dismiss the progress dialog
         * **/
        protected void onPostExecute(String file_url) {
            // dismiss the dialog once done
            pDialog.dismiss();
        }
    }   
} 
```

**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:06:41.857

假设您已经实现了您的数据库（例如通过扩展 SQLiteOpenHelper），那么您可以调用以在侦听器的 onLocationChanged() 方法中写入数据库。

可能最好仔细控制使用 locationManager 上 requestLocationUpdates 调用中的参数写入数据库的频率。如果您有一个已经写入数据库的按钮，那么这应该很简单。

# javascript - 禁用 JSTREE 复选框

> ID：14435146
> 
> 赞同：3
> 
> 时间：2013-01-21T08:50:10.533
> 
> 标签：javascript, jquery, jstree

只是想知道 JSTREE 中是否有任何方法可以禁用复选框？

当我单击父节点时，我基本上需要禁用（而不是取消选择）所有我选择的子节点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T09:15:22.107

您需要为此创建一个新类型（禁用）。可以按如下方式完成

```
 "types" : {
        "types": {
        "disabled" : { 
              "check_node" : false, 
              "uncheck_node" : false 
            } 
        }
    } 
```

然后将该类型指定为

```
.set_type("disabled", "#node5"); 
```

更多[文档](http://www.jstree.com/documentation/types)在这里。

要禁用所有子节点，请为 change_state 事件创建一个事件处理程序

```
$("#treeElement").bind("change_state.jstree", function (e, d) {
    var node = d.args[0];
    // here disable all child nodes
    }
}); 
```

# java - 从 IDE 运行 Spring 的集成测试

> ID：14435149
> 
> 赞同：1
> 
> 时间：2013-01-21T08:50:15.387
> 
> 标签：java, spring, glassfish, integration-testing

我正在使用嵌入式 glassfish 进行集成测试。我的 web 服务是用 jersey + spring 编写的。

我已经为 AuthFacadeBean 类编写了测试。当我通过 Maven 运行测试时 - 所有测试都成功通过。但是当我在 IDE 中运行测试时 - 返回 NullPointerException。

应用程序上下文.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" ... >   
    <context:component-scan base-package="api.facade" />
    <bean id="authService" scope="singleton" class="api.management.AuthServiceImpl" />
</beans> 
```

AuthServiceImpl：

```
public interface AuthService {
    String login (String secretKey, Integer userId, String accessToken);
} 
```

AuthFacadeBean：

```
@ Component
@ Scope ("request")
@ Path ("/ auth")
@ Produces (MediaType.APPLICATION_JSON)
public class AuthFacadeBean {

    @ Autowired
    AuthService authService;

    @ GET
    public Response auth (@ QueryParam ("secretKey") String secretKey,
                       @ QueryParam ("userId") Integer userId, @ QueryParam ("accessToken") String accessToken) {
        authService.login (secretKey, userId, accessToken); // exception in this line
        return Response.ok (). build ();
    }
} 
```

测试：

```
public class AuthIntegrationTest extends AbstractIntegrationTest {

    @Test
    public void testAuth() {
        URI url = UriBuilder.fromUri(getEndpoint()).path("api/auth")
                .queryParam("userId", 1)
                .queryParam("accessToken", "qwe")
                .queryParam("secretKey", "secret")
                .build();
        ClientResponse response = getClient().resource(url).get(ClientResponse.class);
        Assert.assertEquals(ClientResponse.Status.OK.getStatusCode(), response.getStatus());
    }
} 
```

堆栈跟踪：

```
янв 21, 2013 12:35:02 PM com.sun.jersey.spi.container.ContainerResponse mapMappableContainerException
SEVERE: The RuntimeException could not be mapped to a response, re-throwing to the HTTP container
java.lang.NullPointerException
    at api.facade.AuthFacadeBean.auth(AuthFacadeBean.java:31)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:00:08.907

您是否在 pom.xml 甚至 M2_HOME/conf 下的 setting.xml 中添加了一些默认配置文件（例如在启动测试时运行嵌入容器），并且当您在 IDE 中运行测试时，默认配置文件没有被触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T11:31:08.737

pom.xml 中的问题。需要添加spring-test：

```
<dependency>
   <groupId>org.springframework</groupId>
   <artifactId>spring-test</artifactId>
   <version>${spring.version}</version>
   <scope>test</scope>
</dependency> 
```

# xml - Xslt：如何拆分字符串并将类添加到两个单词

> ID：14435153
> 
> 赞同：2
> 
> 时间：2013-01-21T08:50:28.583
> 
> 标签：xml, function, xslt, xslt-2.0, tokenize

我需要通过添加一个 CSS 类来用红色突出显示字符串（HTML 标题）中的前两个单词，这`tokenize`就是我现在正在查看的内容。这到底是怎么做到的？如果可能的话。

一些伪代码：

```
<xsl:for-each select="tokenize(title, '\s+')">
    // ......
    <xsl:attribute name="class">
        <xsl:text>className</xsl:text>
    </xsl:attribute>

</xsl:for-each> 
```

我如何挑选结果中的每个单词？

虽然，tokenize 可能不是解决方案。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:05:36.787

可以在这里使用**tokenize**，特别是如果您想处理除单个空格之外的其他单词分隔符（**tokenize**的第二个参数允许指定正则表达式。

无论如何，在您的情况下，可能值得将 tokenize 的结果分配给一个变量，然后对前两个单词采取不同的操作。尝试以下 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>
   <xsl:template match="/*">
      <h1>
         <xsl:variable name="words" select="tokenize(title, ' ')"/>
         <span class="className">
            <xsl:value-of select="concat($words[1], ' ', $words[2])"/>
         </span>
         <xsl:for-each select="$words[position() &gt; 2]">
            <xsl:value-of select="concat(' ', .)"/>
         </xsl:for-each>
      </h1>
   </xsl:template>
</xsl:stylesheet> 
```

以这个 XML 为例

```
<data>
   <title>This is a test</title>
</data> 
```

以下是输出

```
<h1>
   <span class="className">This is</span> a test
</h1> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T15:16:38.840

使用 tokenize() 的缺点是会丢失标记之间的分隔符。这里更好的解决方案是 xsl:analyze-string：

```
<xsl:analyze-string select="title" regex="\s+ (or whatever)">
  <xsl:matching-substring><xsl:value-of select="."/></xsl:matching-substring>
  <xsl:non-matching-substring>
    <xsl:choose>
      <xsl:when test="position() le 4">
         <span class="xxxx"><xsl:value-of select="."/></span>
      </xsl:when>
      <xsl:otherwise><xsl:value-of select="."/></xsl:otherwise>
   </xsl:choose>
 </xsl:non-matching-substring>
</xsl:analyze-string> 
```

如果您使用允许单词之间标点符号的正则表达式，则可以确保标点符号不会丢失。您还可以反转测试并使用匹配单词而不是单词间分隔符的正则表达式。

position() le 4 测试允许序列可能以单词或单词间分隔符开头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T13:16:26.970

**你很亲密。这是一个完整的转换**：

```
<xsl:stylesheet version="2.0"   xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/*">
  <h1>
    <xsl:variable name="vWords" select="tokenize(., '\s+')"/>
    <span class="className">
      <xsl:value-of select="$vWords[not(position() gt 2)]" separator=" "/>
      <xsl:text> </xsl:text>
    </span>
      <xsl:value-of select="$vWords[position() gt 2]" separator=" "/>
  </h1>
 </xsl:template>
</xsl:stylesheet> 
```

**将此转换应用于此 XML 文档时：**

```
<t>Red cat and a mouse</t> 
```

**产生了想要的正确结果：**

```
<h1><span class="className">Red cat </span>and a mouse</h1> 
```

# android - 安卓手机中的磁力计传感器获取方向

> ID：14435155
> 
> 赞同：1
> 
> 时间：2013-01-21T08:50:33.703
> 
> 标签：android, sensors, magnetometer

这是旨在使我的Android手机在某些条件为真时振动的代码。它应该振动直到方位角（我从磁力计获得）不在给定范围内。

但无论我将手机指向哪个方向，它都不会振动。它进入`if`语句，但从不进入`while`语句。并且振动功能正在工作（即手机没有坏）。我的目的是寻找东南西北。

我究竟做错了什么？

```
public void onCreate(Bundle savedInstanceState) {
    // some code        
    mSensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
    if (mSensorManager.getDefaultSensor(Sensor.TYPE_MAGNETIC_FIELD) != null){
        // Success! There's a magnetometer.
        Toast.makeText(
            getApplicationContext(),
            "Detecting magnetic field",
            Toast.LENGTH_LONG).show();
        speakOut("not Working");
    }
    else {
        Toast.makeText(
            getApplicationContext(),
            "not working",
            Toast.LENGTH_LONG).show();
        speakOut("not Working");
    }
    // some code that calls the function
}

some_function(){
    if (//some condition) {
        while (!(85 < azimuth_angle) && !(azimuth_angle < 95)) {
            viberator.vibrate(1000);
            //this should happen when it faces east.
        }
    } 
}

public void onSensorChanged(SensorEvent event) {
    // TODO: Auto-generated method stub
    azimuth_angle = event.values[0];
    pitch_angle = event.values[1];
    roll_angle = event.values[2];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:01:21.933

`registerListener`方法丢失，所以你`SensorEventListener`不会被触发： http: [//developer.android.com/reference/android/hardware/SensorManager.html#registerListener](http://developer.android.com/reference/android/hardware/SensorManager.html#registerListener(android.hardware.SensorEventListener) (android.hardware.SensorEventListener, android.hardware.Sensor, int)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:01:39.540

方位角不是罗盘方向。这是我为指南针传感器编写的一些代码。它不是 100%（它需要一个更好的过滤器，我没有时间或理由来写）。但它显示了获取方向的逻辑，您可以自己更好地过滤返回值。

[回答我发布代码的上一个问题](https://stackoverflow.com/questions/14433182/direction-using-sensor/14433452#comment20094341_14433452)

# .htaccess - 这个 HTACCESS 文件的哪一部分导致了无限循环？

> ID：14435161
> 
> 赞同：0
> 
> 时间：2013-01-21T08:51:00.313
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

我正在尝试缩短用户个人资料页面的字符串，但我对 .htaccess 文件有点陌生。我一直在试图找出为什么这会一直循环，但我很难找到它。如果有人能告诉我如何解决它或至少指出我正确的方向，我将不胜感激！

这是我所拥有的：

```
RewriteEngine On
RewriteCond %(REQUEST_FILENAME) !-f
RewriteCond %(REQUEST_FILENAME) !-d
RewriteRule ^(.*)$ /register_demo/profile.php?username=$1 
```

我得到的错误是浏览器上的“500 Internal Server”，当我查看错误日志时，我看到我超出了内部递归限制。

我还注意到网址的变化：

```
localhost/register_demo/profile.php?username=username 
```

到 localhost/register_demo/profile.php?username=profile.php

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:18:33.440

您在 ! 周围使用圆括号`REQUEST_FILENAME`！将它们更改为大括号。

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /register_demo/profile.php?username=$1 
```

# python - numpy.genfromtxt: delimiter=',' 无法分割字符串

> ID：14435162
> 
> 赞同：3
> 
> 时间：2013-01-21T08:51:12.297
> 
> 标签：python, numpy, genfromtxt

我不明白为什么`numpy.genfromtxt`不正确使用以下字符串拆分，`delimiter=","`而它适用于我的块中的大多数其他字符串。

```
chunk[12968]
Out[143]: '2901869281,3279442095,2012-12-15T23:00:00.003Z,Sacramento,CA,R#3817874,United States,38.583,-121.498,11, 8, 6, 5, 1, 0, 2, 3, 3, 5, 3, 3, 2, 2, 6, 6, 1, 2, 3, 0, 1, 1, 0, 0, 2, 2, 2, 2, 1, 0, 0, 2, 1, 0, 1, 1, 2, 0, 3, 1, 1, 1, 1, 0, 0, 4, 0, 0, 0, 1, 3, 1, 0, 2, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 0, 9, 0, 0, 0, 2, 3, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0,130\n' 
```

我希望有一个形状数组 (110,) 但得到以下

```
genfromtxt([chunk[12968]],delimiter=",",dtype=np.int64)
Out[142]: 
array([2901869281, 3279442095,         -1,         -1,         -1,
               -1], dtype=int64) 
```

请注意，我使用`izip_longest`from`itertools`以这种方式按块读取大的 *csv：

```
with open('events.csv','r') as:
    for chunk in izip_longest(*[f] *50000):
          ... 
```

感谢帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T09:06:11.350

`comments`参数[`genfromtxt()`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.genfromtxt.html)默认为`'#'`，因此输入中的所有内容都将`#`被忽略：

```
2901869281,3279442095,2012-12-15T23:00:00.003Z,Sacramento,CA,R#3817874,United States,...
                                                              ^ start of comment 
```

# jquery - Grails 创建可下载文件

> ID：14435163
> 
> 赞同：0
> 
> 时间：2013-01-21T08:51:17.977
> 
> 标签：jquery, ajax, grails, download

在我看来，我调用了以下 jQuery 函数：

```
$.ajax({
                    url: '${request.contextPath + '/Ticket/passAll'}',
                    type: 'POST',
                    data: Data,

                    success: function(result) {

                        $('#export_form').submit();
                    }

                }); 
```

在控制器中，我正在对传递的数据进行一些过滤和格式化，并在方法结束时将该数据放入会话中：

```
session["export"] = filteredData
render "success" 
```

如果成功，$.ajax() 提交 export_form 表单，该表单仅调用控制器中的另一个函数，该函数将下载数据设置为附件。

```
 def filter = session["export"].toString()

    def tickets = Ticket.findAll("from Ticket as t ${filter}", [])
    session["export"] = null

    OutputStream outputStream = response.getOutputStream();
    outputStream.write(0xEF);
    outputStream.write(0xBB);
    outputStream.write(0xBF);

    response.setHeader("Content-disposition", "attachment; filename=tickets.csv")
    response.setContentType("application/vnd.ms-excel:UTF-8")

    def outs = response.outputStream
    def cols = [:]

    outs << "TicketNo;Ticket Details\n"

    tickets.each() {        
        outs << it.ticketNo + ";" + it.ticketDetails

        outs << "\n"

    }

    outs.flush()
    outs.close() 
```

这正在开发中，但是当我在 Tomcat 上部署它时，出现以下错误：

```
org.codehaus.groovy.grails.web.pages.exceptions.GroovyPagesException: Error processing GroovyPageView: getOutputStream() has already been called for this response
org.codehaus.groovy.grails.web.servlet.view.GroovyPageView.createGroovyPageException(GroovyPageView.java:205)
org.codehaus.groovy.grails.web.servlet.view.GroovyPageView.handleException(GroovyPageView.java:181)
org.codehaus.groovy.grails.web.servlet.view.GroovyPageView.renderWithTemplateEngine(GroovyPageView.java:152)
org.codehaus.groovy.grails.web.servlet.view.GroovyPageView.renderMergedOutputModel(GroovyPageView.java:83)
org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)
org.codehaus.groovy.grails.web.sitemesh.SpringMVCViewDecorator.render(SpringMVCViewDecorator.java:67)
org.codehaus.groovy.grails.web.sitemesh.SpringMVCViewDecorator.render(SpringMVCViewDecorator.java:52)
org.codehaus.groovy.grails.web.sitemesh.GrailsPageFilter.doFilter(GrailsPageFilter.java:160)
org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:369)
org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)
org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)
org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)
org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter.doFilter(RememberMeAuthenticationFilter.java:119)
org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)
org.codehaus.groovy.grails.plugins.springsecurity.RequestHolderAuthenticationFilter.doFilter(RequestHolderAuthenticationFilter.java:40)
org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
org.codehaus.groovy.grails.plugins.springsecurity.MutableLogoutFilter.doFilter(MutableLogoutFilter.java:79)
org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)
org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:168)
org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
org.codehaus.groovy.grails.web.servlet.mvc.GrailsWebRequestFilter.doFilterInternal(GrailsWebRequestFilter.java:69)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
org.codehaus.groovy.grails.web.filters.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:65)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
root cause

java.lang.IllegalStateException: getOutputStream() has already been called for this response
    gsp_helpdesk_layoutsmain_gsp.run(gsp_helpdesk_layoutsmain_gsp.groovy:47) 
```

编辑：我在页面上使用 jQuery DataTables 和 Twitter Bootstrap 插件。调用导出操作的表格和按钮都在`<g:uploadForm>`.

我使用这行代码在 datables 代码中生成按钮：

```
$("div.additional_filters").html('<g:actionSubmit value="${message(code: "datatables.passAll")}" action="export_test" class="btn btn-primary"/> ); 
```

发生了什么以及如何解决这个问题？谢谢你。

我知道这不是正确的方法，但目前必须这样做，所以请多多包涵。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T12:07:13.727

您应该在写入输出之前写入所有 HTTP 标头（稍后在实际内容之后设置内容类型）：

```
response.setHeader("Content-disposition", "attachment; filename=tickets.csv")
response.setContentType("application/vnd.ms-excel; charset=UTF-8")

OutputStream outputStream =  response.getOutputStream();
outputStream.write(0xEF);
outputStream.write(0xBB);
outputStream.write(0xBF); 
```

据我所知，如果您的内容类型是“text/html”（它是默认值），那么 Grails 会尝试为您的操作呈现一个 gsp 视图（并在那里失败）。

你应该`return null`

# php - 在命令中调用控制台命令并在 Symfony2 中获取输出

> ID：14435164
> 
> 赞同：18
> 
> 时间：2013-01-21T08:51:22.067
> 
> 标签：php, symfony

我在 Symfony2 中有一些控制台命令，我需要使用一些参数从另一个命令执行一个命令。

成功执行第二个命令后，**我需要获取结果（例如数组）**，而不是显示输出。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-21T09:09:53.473

[在这里](http://www.craftitonline.com/2011/06/calling-commands-within-commands-in-symfony2/)，您可以在命令中包含基本命令。第二个命令的输出可以是 json，然后您只需解码输出 json 即可检索您的数组。

```
$command = $this->getApplication()->find('doctrine:fixtures:load');
$arguments = array(
    //'--force' => true
    ''
);
$input = new ArrayInput($arguments);
$returnCode = $command->run($input, $output);

if($returnCode != 0) {
    $text .= 'fixtures successfully loaded ...';
    $output = json_decode(rtrim($output));
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-08-26T23:29:50.677

您必须在参数数组中传递命令，并且要避免在教义：fixtures:load 中出现确认对话框，您必须传递 --append 而不是 --force

```
 $arguments = array(
    'command' => 'doctrine:fixtures:load',
    //'--append' => true
    ''
); 
```

否则它将失败并显示错误消息“没有足够的参数”。</p>

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-12-27T22:31:11.577

有一个名为的新输出类（从[v2.4.0](https://github.com/symfony/Console/tree/v2.4.0/Output)开始）`BufferedOutput`。

这是一个非常简单的类，它会在`fetch`调用方法时返回并清除缓冲的输出：

```
 $output = new BufferedOutput();
    $input = new ArrayInput($arguments);
    $code = $command->run($input, $output);

    if($code == 0) {
        $outputText = $output->fetch();
        echo $outputText;
    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-17T19:05:41.760

我做了以下

```
use Symfony\Component\Console\Input\ArrayInput;
use Symfony\Component\Console\Output\StreamOutput;

$tmpFile = tmpfile();
$output  = new StreamOutput($tmpFile);
$input   = new ArrayInput(array(
    'parameter' => 'value',
));

$command = . . .
$command->run($input, $output);

fseek($tmpFile, 0);
$output = fread($tmpFile, 1024);
fclose($tmpFile);

echo $output; 
```

有用！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-16T18:57:22.307

作为[Onema 答案](https://stackoverflow.com/a/20808687/12894421)的更新，在 Symfony 3.4.x（由 Drupal 8 使用）中，

1.  你还需要设置`setAutoExit(false)`，
2.  `int(0)`如果成功，该命令将返回。

这是我用于在 php 中为 Drupal 8.8 项目编写[composer命令的更新示例。](https://getcomposer.org/)这将获取所有作曲家包的列表作为 json，然后将其解码为 php 对象。

```
<?php 

require __DIR__.'/vendor/autoload.php';

use Symfony\Component\Console\Output\BufferedOutput;
use Symfony\Component\Console\Input\ArrayInput;
use Composer\Console\Application;

$input = new ArrayInput([
  'command' => 'show', 
  '--format'=>'json',
]);

$output = new BufferedOutput();
$application = new Application();

// required to use BufferedOutput()
$application->setAutoExit(false);
// composer package list, formatted as json, will be barfed into $output 
$status = $application->run($input, $output);
if($status === 0) {
  // grab the output from the $output buffer
  $json = $output->fetch();
  // decode the json string into an object
  $list = json_decode($json);
  // Profit!
  print_r($list);
}

?> 
```

输出将是这样的：

```
stdClass Object
(
    [installed] => Array
        (
            ... omitted ...

            [91] => stdClass Object
                (
                    [name] => drupal/core
                    [version] => 8.9.12
                    [description] => Drupal is an open source content management platform powering millions of websites and applications.
                )
            ... omitted ...
        )

) 
```

[在Onema 的提示](https://stackoverflow.com/a/20808687/12894421)的帮助下，谷歌在[这里](https://symfony.com/doc/3.4/console/command_in_controller.html)为我找到了其余的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-21T14:27:28.030

我知道这是旧帖子，上面的答案通过一些挖掘解决了这个问题。在 Symfony2.7 中，我在使它工作时遇到了一点问题，所以根据上述建议，我挖了一点，并在这里编译了完整的答案。希望它对某人有用。

[在控制台命令下使用控制台命令](http://php-webdeveloper.com/?p=88)

# php - 用户 ''@'localhost' 拒绝访问数据库 'database'

> ID：14435165
> 
> 赞同：0
> 
> 时间：2013-01-21T08:51:27.587
> 
> 标签：php, mysql

> **可能重复：**
> [PHP - 从不同的服务器连接到 mysql 数据库](https://stackoverflow.com/questions/5991130/php-connecting-to-mysql-database-from-different-server)

```
global $host, $username, $password, $database; 
$host = "meshtelecom.com"; 
$username = "mesh_project"; 
$password = "password"; 
$database = "mesh_database"; 
$link = mysql_connect($host, $username, $password); 
if(!$link)echo "Connection failed."; 
$db = mysql_select_db($database)or die(mysql_error()); 
```

我在meshtelecom.com 中使用phpmyadmin 创建了一个数据库。我无法从另一台服务器访问此数据库.. 它给了我：

```
Connection failed.Access denied for user ''@'localhost' to database 'mesh_database' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T08:55:44.937

也许您的主机必须设置为 localhost，您可以在主机的 Web 面板中进行检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T08:59:14.837

您必须为用户创建一个新帐户才能从其他服务器访问主机。你目前有用户'mesh_project'@'localhost'，但你还需要有'mesh_project'@'%'。或者如果你想限制哪些主机可以用来连接数据库，你可以使用主机名或IP来代替%。

这是一些文档[http://dev.mysql.com/doc/refman/5.5/en//adding-users.html](http://dev.mysql.com/doc/refman/5.5/en//adding-users.html)

如果您可以从命令行登录，请运行以下命令：

```
CREATE USER 'mesh_project'@'%' IDENTIFIED BY 'password';
GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP ON mesh_database.* TO 'mesh_project'@'%'; 
```

将“密码”更改为其他内容，并仅添加您希望用户能够执行的权限。提供过多的权力以使任何主机都无法访问会增加安全风险。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T08:57:31.160

仔细检查您的主机，在大多数情况下，网站和数据库在同一台机器上尝试 localhost 或向您的主机提供商询问数据库连接信息。

# android - NullpointerException 与上下文

> ID：14435166
> 
> 赞同：-1
> 
> 时间：2013-01-21T08:51:32.720
> 
> 标签：android, android-asynctask, nullpointerexception, sharedpreferences, android-context

我正在尝试在 AsyncTask 中获取共享首选项，但我不明白。

我如何在这里使用上下文？

```
package com.example.wettkampftimerbt;

import java.io.DataOutputStream;
import java.io.IOException;
import java.net.Socket;
import java.net.URL;

import android.content.Context;
import android.content.SharedPreferences;
import android.os.AsyncTask;

public class network extends AsyncTask<URL, String, String> {

    private final String PREFS_NAME = "prefs", W1 = "w1",  W2="w2", W3="w3", W4="w4", 
            W5="w5", W6="w6", W7="w7", SENDBEG="sendbeg", SENDEND="sendend";
    int w1, w2, w3, w4, w5, w6, w7, sendend, sendbeg;

    protected String doInBackground(URL... params) {
        int c2, c3, c4, c5, c6;
        int w0 = 00;
        try {
            w1 = sendbeg;
            c2 = w2;
            c3 = w3;
            c4 = w4;
            c5 = w5;
            c6 = w6;
            w7 = sendend;

            Socket ss = new Socket("192.168.3.100", 4455);
            System.out.println(ss);
            boolean stopData = true;
            System.out.println("lane1 stop send");
            DataOutputStream dos = new DataOutputStream(
                    ss.getOutputStream());
            while (stopData) {
                dos.writeByte(w0);
                dos.writeByte(w1);
                dos.writeByte(c2);
                dos.writeByte(c3);
                dos.writeByte(c4);
                dos.writeByte(c5);
                dos.writeByte(c6);
                dos.writeByte(w7);
                stopData=false;
            }
        } catch (IOException e) {
            System.out.println("IO error" + e);
            e.printStackTrace();
        }

        return "Done";
    }

    public void onPreExecute(){
        Context context = network.this;
        SharedPreferences prefs = context.getSharedPreferences("PREFS_NAME");

        doInBackground();
    }

    public void getPrefs (Context context){         
        w1= Integer.valueOf(context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE).getString(W1, "00"));
        w2= Integer.valueOf(context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE).getString(W2, "00"));
        w3= Integer.valueOf(context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE).getString(W3, "00"));
        w4= Integer.valueOf(context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE).getString(W4, "00"));
        w5= Integer.valueOf(context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE).getString(W5, "00"));
        w6= Integer.valueOf(context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE).getString(W6, "00"));
        w7= Integer.valueOf(context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE).getString(W7, "00"));
        sendbeg= Integer.valueOf(context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE).getString(SENDBEG, "00"));
        sendend= Integer.valueOf(context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE).getString(SENDEND, "00"));
    }
} 
```

这是片段，我的问题是：我没有错误，除了开始时的**nullPointerException**（由`getPrefs(null);`？引起）。有人能帮我吗？

我已经阅读了很多上下文解释，甚至我访问过的 Android 开发者网站，但我不明白上下文是什么，以及它到底做了什么。

编辑：感谢您的快速回答，但它仍然无法正常工作。我现在把整个活动放在这里，你给了我一个样本，但我现在出错了。这取决于我，还是 Eclipse 讨厌我？

EDIT2：我自己调用 doInBackground，因为它不是自己启动的。

EDIT3：现在解决了，它有效^^我直接从我的主要活动中调用getPrefs，然后从getPrefs 调用网络......到目前为止很好，但是：我收到了这个NetworkOnMainThreadException错误。现在要做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T08:58:45.007

您必须将您班级的上下文提供给`getPrefs()`. 使用`getPrefs(yourActivity.this)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T08:54:29.620

尝试这个：

1）在你的异步类中定义一个局部变量（在你的情况下是网络类）

```
Context context; 
```

2）在您的异步任务中创建构造函数以接受上下文：

```
public network(Context context) {
    this.context = context;       
} 
```

3）现在，在`onPreExecute()`调用时`getPrefs`，像这样调用：

```
getPrefs(context); 
```

4) 你可以像这样从你的 MainActivity 调用这个类：

```
network networkObj= new network(MainActivity.this);
networkObj.execute(url); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T09:02:05.737

有两种选择：

**1\. 将您的 AsyncTask 定义为 Activity 的内部类**
您的 AsyncTask 类**不能**是静态的，这样才能正常工作。

```
public class MyActivity extends Activity {
    ...    

    private class MyAsyncTask extends AsyncTask<Void, Void, Void> {
        ...

        public void onPreExecute() {
            Context context = MyActivity.this;
            SharedPreferences prefs = context.getSharedPreferences("PREFS_NAME");
        }
    }

} 
```

**2\. 将您的活动/上下文传递给您的 AsyncTask 构造函数并维护对其的 WeakReference**
您的 AsyncTask 类应该是静态的。不要只维护对您的活动/上下文的硬引用（除非它是应用程序上下文），否则您**将**泄漏内存：

```
public class MyAsyncTask extends AsyncTask<Void, Void, Void> {

    private WeakReference<Context> mContextRef;

    public MyAsyncTask(Context context) {
        mContextRef = new WeakReference<Context>(context);
    }

    ...

    public void onPreExecute() {
        Context context = mContextRef.get();
        // context may be null if the activity has been destroyed
        if (context != null) {
            SharedPreferences prefs = context.getSharedPreferences("PREFS_NAME");
        }
    }
} 
```

# jsf - 从 bean 方法发布提交

> ID：14435168
> 
> 赞同：0
> 
> 时间：2013-01-21T08:51:44.850
> 
> 标签：jsf, redirect, post

目前在我的 jsf 应用程序的一个 bean 中，我使用 a`FacesContext.getCurrentInstance().getExternalContext().redirect`重定向到某个页面。我将查询参数附加到 url。这会导致 GET 请求，并且在部署了我的应用程序的某些服务器上，这不起作用，因为它们阻止了 get 请求，因为我的一个参数中有一个单引号。我得到的信息是，这可能是一次 XXS 攻击。因此，我想用查询参数替换我的重定向到 POST sumit。我怎样才能做到这一点？

当前代码：

```
FacesContext.getCurrentInstance().getExternalContext().redirect(request.getContextPath() + "/prospect/detail.xhtml?baumuster=1&customer=" + customer); 
```

当客户等于“rue d'arme”时，我就会遇到问题。

是否可以从我的 bean 内部进行 post sumbit ？我该怎么做？

或者我应该使用通用会话范围 bean 并将客户存储在该 bean 中，然后重定向并从通用 bean 获取客户变量？

# javascript - 通过ajax加载时，Javascript函数在单独的文件中还是与html一起使用？

> ID：14435171
> 
> 赞同：1
> 
> 时间：2013-01-21T08:51:56.197
> 
> 标签：javascript, ajax, function

我们已经开始通过 ajax 进行更多的动态内容加载，并且已经演变的模式是包含函数以及我们加载并粘贴到 div 中的 html。因此，如果主 html 页面有一个 div：

```
<div id="a"></div> 
```

我们将这样的内容加载到该 div 中：

```
<div id="b" onchange="dostuff();">...</div>
<script type="text/javascript">
    function dostuff() {
        // ...
    }
</script> 
```

这里的 dostuff 方法通常不包含任何服务器生成的东西（通过 php 或 jsp），它更方便，将 javascript 代码放在它所操作的 html 附近可以更容易地找到函数和/或查看一个文件中的所有相关代码。

在我工作的另一个项目中，我们倾向于将 dostuff() 之类的函数放在一个单独的 .js 文件中（通常一个 .js 文件将包含许多用于多个动态加载的 html 块的函数），该文件在主页面加载一次加载。这对我来说感觉像是一个更好的解决方案，但是当我想在团队中争论这一点时，我很难确定利弊——也许我错了？

我注意到的一件事是在 Firebug 中调试更困难，因为我在其中放置断点的函数已重新加载，这使调试器感到困惑。随着浏览器重新编译功能，性能可能会降低吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T08:58:58.340

我会说不要混合标记和逻辑。将所有 JavaScript 放在一个单独的文件中并在那里分配事件，这样它就不会那么混乱并且更便携。

html:

```
<div id="b">...</div> 
```

js：

```
var b = document.querySelector('#b');
b.addEventListener('change', function() {
  // do something
}); 
```

假设`b`是静态的，这将起作用，否则请查看“事件委托”。

> 随着浏览器重新编译功能，性能可能会降低吗？

为了获得最佳性能，最好将您的 JavaScript 放在单独的文件中，这样您就可以连接和缩小所有内容并在浏览器中仅加载一个文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:03:00.903

有一件事是，如果您将它包含在您的 html 中，那么您执行它的方式，dostuff 是一个全局函数（这通常是一个坏主意）。至少使用 1 个全局命名空间变量对象文字，并将所有内容附加到该变量：

```
var YOURNAMESPACE = {}; 
```

并在您的包括：

```
<div id="b">...</div>
<script type="text/javascript">
  YOURNAMESPACE.dostuff = function () {
    // ...
  };

  document.getElementById('b').onchange = function () {
    YOURNAMESPACE.dostuff();
  }
</script> 
```

如您所见，我的代码中没有使用 javascript 属性。这只是不好的做法！

关于你的问题，这取决于。由于初始页面加载时间，有一些参数可以用您的 ajax 请求加载它。

在 1 个文件中执行此操作的一个论点是，显然更容易构建您的 javascript 并拥有更好的概览。您可以（并且应该）缩小/丑化您的 javascript 文件！

您通常应该考虑您的 ajax 模式。你能用json ajax 吗？你的ajax请求应该会快很多。（如果你用 json 来做，你的问题就过时了，因为你不能通过 json 将 javascript 代码发送到浏览器）。

# powershell - 如何在 Windows Powershell 上运行 get-vm 命令

> ID：14435177
> 
> 赞同：1
> 
> 时间：2013-01-21T08:52:54.350
> 
> 标签：powershell

我尝试在 windows powershell 上运行 get-vm 命令。它抛出了这个异常：

> “脚本错误：‘Get-VM’一词未被识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，或者如果包含路径，请验证路径是否为更正，然后再试一次。”

但我在系统中心 powershell 上运行相同的命令，它运行成功。但我需要在 windows powershell 上运行。我可以在windows powershell上运行它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:59:50.567

导入 VMM 管理单元。System Center 的 Powershell 快捷方式默认加载它。Vanilla Powershell 没有。

用于`Get-PSSnapin -Registered`列出所有可用的管理单元。你要找的是`Microsoft.SystemCenter.VirtualMachineManager`

加载管理单元：`Add-PSSnapin -Name Microsoft.SystemCenter.VirtualMachineManager`

获取和设置默认 VMM 服务器：`get-vmmserver myVMMServer`.VMMServer `or use`-VMMServer` 开关以指定 cmdlet 将与之交互的 VMM 服务器。

# php - PHP SOAP 调用不等待返回

> ID：14435196
> 
> 赞同：2
> 
> 时间：2013-01-21T08:55:31.380
> 
> 标签：php, soap

有没有一种方法可以在 PHP 中创建一个不等待被调用函数返回的 SOAP 调用？

我正在从我的系统中调用一个 Magento Api 函数来在目录中创建一个新产品。这可能需要很长时间，我不希望我的最终用户等到它完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:00:39.420

我只会打一个普通电话，但不要阻止用户在通话期间做其他事情。这样你就可以吃蛋糕（调用）并吃掉它（得到结果）。

最常见的方法是进行`AJAX`调用：您通过脚本向`PHP`文件发出请求，但界面将是响应式/可用的。如果用户没有从您发出请求的页面浏览，您甚至可以提供响应。

# linux - 在使用 Linux API send 或 sendto 发送数据之前，我可以获取当前连接的 TCP 窗口大小吗

> ID：14435203
> 
> 赞同：4
> 
> 时间：2013-01-21T08:55:52.660
> 
> 标签：linux

在使用 Linux API send 或 sendto 发送数据之前，是否有可用的 Linux API 可以检索当前 TCP 连接的 TCP 窗口大小？

我需要这个的原因是如果当前 TCP 窗口大小小于我需要发送的数据长度，我可以手动释放 CPU 并在其他线程或进程中执行其他操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:49:08.927

也许有更好的方法，但实际上，`RAW SOCKET`我只想到了 a 的使用。

在传输层处理数据允许您访问 TCP 标头（然后是`window`16 位字段）。

对应的是您必须处理您和对等方之间的 TCP 堆栈，这有点疯狂和费力。

这是一个示例，说明您需要做什么才能将**SYN**发送到主机。避免最后的循环，否则它会对你的对等方发起同步洪水攻击:)

[带有原始套接字的 TCP](http://www.binarytides.com/raw-sockets-c-code-linux/)

# ios6 - 为什么 iOS6 不支持 base64Encoding？

> ID：14435205
> 
> 赞同：0
> 
> 时间：2013-01-21T08:55:56.750
> 
> 标签：ios6, nsstring, nsdata

我已经将 UIImage 转换为 NSData，现在我想将该 NSData 转换为 NSString，以便我可以将其发送到服务器。这是代码

```
UIImage *img=mainImage.image;
NSData *imgdata=UIImagePNGRepresentation(img);
NSString *imgstr=[imgdata base64Encoding]; 
```

但我认为 iOS6 不支持这种 base64Encoding。如果有任何替代 iOS6 的 base64Encoding 或任何其他方式将此 NSData 转换为 NSString，请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T07:45:01.800

我得到了问题的解决方案。没有什么像 iOS 6 不支持 Base64Encoding。我已经成功编码了一个 .png 文件，然后发送到服务器。之后，我在我的应用程序的其他视图上检索该编码数据。Base64Encoding 工作得很好。早些时候，问题出在服务器端，因为当我们通过 Web 服务将数据保存在服务器（编程语言 php）上时，它在编码数据中用“/”替换了“+”符号。如果有人遇到这样的问题，请仔细比较控制台中两个地方的编码数据 1> 编码后发送数据的位置。2>您在哪里检索编码数据。之后在服务器端解决此问题。

# regex - 正则表达式帮助：识别文本中的网站

> ID：14435212
> 
> 赞同：3
> 
> 时间：2013-01-21T08:56:16.257
> 
> 标签：regex

我正在尝试编写一个从一段文本中删除网站的函数。我有：

```
removeWebsites<- function(text){
  text = gsub("(http://|https://|www.)[[:alnum:]~!#$%&+-=?,:/;._]*",'',text)
  return(text)
} 
```

这处理了大量的问题，但不是一个流行的问题，即某种形式的问题`xyz.com`

我不希望`.com`在上述正则表达式的末尾添加，因为它限制了该正则表达式的范围。但是我尝试编写更多的正则表达式，例如：

```
gsub("[[:alnum:]~!#$%&+-=?,:/;._]*.com",'',testset[10]) 
```

这有效，但它也将表单的电子邮件 ID 修改`abc@xyz.com`为`abc@`. 我不想要这个，所以我修改为

```
gsub("*((^@)[[:alnum:]~!#$%&+-=?,:/;._]*).com",'\\1',testset[10]) 
```

这留下了电子邮件ID，但停止识别表单的网站`xyz.com`

我知道我需要在此处进行某种设置差异，即此处解释的形式，[但](https://stackoverflow.com/questions/9944361/aflex-regular-expression-difference)我无法实现它（主要是因为我无法完全理解它）。关于我如何解决我的问题的任何想法？

编辑：我尝试了消极的前瞻：

```
gsub("[[:alnum:]~!#$%&+-=?,:/;._](?!@)[^(?!.*@)]*.com",'',testset[10]) 
```

我收到“无效的正则表达式”错误。我相信在纠正方面的一点帮助可能会让这个工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T10:28:32.967

我不敢相信。实际上有一个简单的解决方案。

```
gsub(" ([[:alnum:]~!#$%&+-=?,:/;._]+)((.com)|(.net)|(.org)|(.info))",' ',text) 
```

这通过以下方式起作用：

1.  从一个空格开始。
2.  放各种东西，除了一个'@'。
3.  以 .com/net/org/info/ 结尾

请务必考虑打破它！我相信也会有一些案例会打破这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:57:45.210

你的环视对我来说有点有趣：你不能在一个角色类里面看后面，你为什么要向前看？看看后面更合适。我认为以下表达式*应该*有效，尽管我没有测试它：

```
gsub("*((?<!@)[[:alnum:]~!#$%&+-=?,:/;._]*).com",'\\1',testset[10]) 
```

另请注意，lookbehinds 必须具有固定长度，因此不允许使用乘数

# design-patterns - 运行时选择算法的设计模式

> ID：14435215
> 
> 赞同：0
> 
> 时间：2013-01-21T08:56:34.887
> 
> 标签：design-patterns

在我们的项目中，我们经常根据一些条件选择算法。

例如，假设我们需要打印不同产品的订单。我们需要根据产品类型、价格或任何其他产品特性选择不同的空白并检索不同的数据。通常，我们会写这样的东西。

```
public interface IOrderPrinter
{
    bool CanPrint(Order order);
    PrintResult Print(Order order);
}

class CompositeOrderPrinter : IOrderPrinter
{
    private IList<IOrderPrinter> printers;

    public bool CanPrint(Order order)
    {
        return printers.Any(p => p.CanPrint(order));
    }

    public PrintResult Print(Order order)
    {
        foreach (var printer in printers)
        {
            if (printer.CanPrint(order))
                return printer.Print(order);
        }
        // throw some exception
    }

    public void AddPrinter(IOrderPrinter printer)
    {
        printers.Add(printer);
    }
}

class FirstOrderPrinter : IOrderPrinter
{
    public bool CanPrint(Order order)
    {
        return order.ProductType == ProductType.Banana && order.Price < 100;
    }

    public PrintResult Print(Order order)
    {
        if (!CanPrint)
            // throw some exception
        // print ...
    }
}

class SecondOrderPrinter : IOrderPrinter
{
    public bool CanPrint(Order order)
    {
        return order.ProductType == ProductType.Apple;
    }

    public PrintResult Print(Order order)
    {
        if (!CanPrint)
            // throw some exception
        // print ...
    }
} 
```

这个模式有什么众所周知的名字吗？是的，它看起来与复合模式非常相似，但还是有区别的。是否有任何标准设计模式可以更好（更优雅，更少代码，......）方式解决此任务？阅读有关实现类似行为的另一种方法会很有趣。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T08:58:04.387

当您在运行时选择算法时，它被称为[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)。

> 在计算机编程中，策略模式（也称为策略模式）是一种软件设计模式，可以在运行时选择算法的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T10:06:12.410

正如菲利普所说，这是您实施的战略模式。 [模板模式](http://en.wikipedia.org/wiki/Template_method_pattern)是另一种选择。

但是，如果在您的特定情况下失去灵活性是可以接受的，您需要接听电话。

# php - php请求结束时是否释放所有内存？

> ID：14435216
> 
> 赞同：5
> 
> 时间：2013-01-21T08:56:34.577
> 
> 标签：php, memory-management, memory-leaks

在 php 中，分配用于运行我的脚本的所有内存是在我的页面请求结束时释放的，还是我需要担心随着时间的推移内存泄漏？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T09:10:43.503

不。您不需要手动释放（调用`unset()`）资源。PHP 将自动执行此操作。在请求生命周期结束时，一切都会被释放。所以不，你*不需要*为此烦恼。如果你这样做：

```
<?php
$resource = allocate_heavy_resource();
?> 
```

将`$resource`在请求结束时释放，因此*不会*泄漏内存。如果确实如此，则意味着 PHP 中有一个严重的错误，并且任何关于正常操作的讨论都会通过窗口进行。

编辑：当然有例外。就像持久的数据库连接一样。但这些最终都会得到处理，所以它并不是真正的[内存泄漏](http://en.wikipedia.org/wiki/Memory_leak)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T08:59:42.700

是的，脚本终止后会释放所有内存。但是，基于某些算法，在您的脚本期间可能会发生内存泄漏。您可以使用`unset()`释放变量，但与 vanneto 的观点相反，它[实际上不会释放内存](https://stackoverflow.com/a/5030650/904344)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T09:06:38.287

PHP 确实释放了您通过构建对象等声明的内存。仍然存在未释放内存的情况。为此，5.3 版引入了垃圾收集原理。

您可以使用 gc_enable() 函数来执行它。PHP 中的垃圾收集默认情况下是不活动的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T09:11:24.270

有点，内存泄漏发生在缓存事物时。因此，如果您的 php 脚本中存在内存泄漏，您的 apache 进程将随着时间的推移而增加，您可以在收到这么多请求后重新启动它们。检查您的多处理模块 (MPM) 通常是 prefork 或 worker。

大多数情况下，除非您使用 PHP 进行大量处理，否则这不会对您产生太大影响

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-21T09:03:32.830

[PHP 使用垃圾收集器。它释放所有没有引用的变量。](http://php.net/manual/en/features.gc.php)

[http://v1.srcnix.com/2010/02/10/7-tips-to-prevent-php-running-out-of-memory/](http://v1.srcnix.com/2010/02/10/7-tips-to-prevent-php-running-out-of-memory/)

我很确定 GC 会自动为您完成。（它甚至关闭打开的 mysql 连接）

# android - 在 Android 设备中找不到应用程序包名称

> ID：14435217
> 
> 赞同：2
> 
> 时间：2013-01-21T08:56:41.210
> 
> 标签：android

所以我制作了一个包名为 com.xxx.xxx 的 Android 应用。我知道任何已安装的应用程序都会在 Android/Data/com.xxx.xxx 中创建一个文件夹。但我的情况是安装后在该目录中找不到我的应用程序包名称。我错过了什么吗？

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.ceria.tuntun"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

</manifest> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:00:48.747

已安装的应用程序不需要在`Android/Data`. 那里只存储您的应用程序的缓存文件，如果您已经对应用程序进行了编程，那么也是如此。默认情况下，应用程序存储在`Internal memory`其中`/data/data`，只有当您有根手机和根用户的文件浏览器时才能访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:00:02.020

使用哪个设备？您无法在大多数设备中看到应用程序包，因为如果应用程序安装在手机内存中，则这些设备无法访问内部存储。您只能访问`SDCard`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T09:04:50.310

该应用程序默认安装在手机内存中，而不是 SD 卡中。在无根手机中只能看到 SD 卡文件。

要安装到 SD 卡，请将此代码添加到清单文件中。

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
android:installLocation="preferExternal"
... > 
```

# objective-c - 页面重定向取决于使用 Objective-C 选择的答案

> ID：14435218
> 
> 赞同：0
> 
> 时间：2013-01-21T08:56:43.427
> 
> 标签：objective-c, xcode

我现在可能应该被优秀的程序员和伟大的头脑击中，因为我当前的代码看起来如何，即使我是 Objective-C 的菜鸟。无论如何，我正在做一个标志测验，其中问题是随机顺序的，然后每个问题的选择也是随机顺序的。无论如何，我已经有下面的代码来检查选择答案时页面应该重定向到哪里：

```
- (IBAction)answerA:(UIButton *)sender {
if(imgView.image == [UIImage imageNamed:@"1.png"])
{
    if([btnA.titleLabel.text isEqualToString:@"1"])
    {
        [btnA addTarget:self action:@selector(correctView) forControlEvents:UIControlEventTouchUpInside];
    }
    else
    {
        [btnA addTarget:self action:@selector(wrongView) forControlEvents:UIControlEventTouchUpInside];
    }
}
else if(imgView.image == [UIImage imageNamed:@"2.png"])
{
    if([btnA.titleLabel.text isEqualToString:@"2"])
    {
        [btnA addTarget:self action:@selector(correctView) forControlEvents:UIControlEventTouchUpInside];            
    }
    else
    {
        [btnA addTarget:self action:@selector(wrongView) forControlEvents:UIControlEventTouchUpInside];
    }
}

- (IBAction)answerB:(UIButton *)sender {
    if(imgView.image == [UIImage imageNamed:@"1.png"])
    {
        if([btnB.titleLabel.text isEqualToString:@"1"])
        {
            [btnB addTarget:self action:@selector(correctView) forControlEvents:UIControlEventTouchUpInside];
        }
        else
        {
            [btnB addTarget:self action:@selector(wrongView) forControlEvents:UIControlEventTouchUpInside];
        }
    }
    else if(imgView.image == [UIImage imageNamed:@"2.png"])
    {
        if([btnB.titleLabel.text isEqualToString:@"2"])
        {
            [btnB addTarget:self action:@selector(correctView) forControlEvents:UIControlEventTouchUpInside];
        }
        else
        {
            [btnB addTarget:self action:@selector(wrongView) forControlEvents:UIControlEventTouchUpInside];
        }
    }
} 
```

这可行，但问题是，您必须单击该按钮两次才能转到相应的页面。我知道问题是 IBAction 本身已经是一个在单击按钮后触发的事件，然后我在条件语句中包含代码，只有在再次单击按钮时才会触发。我的问题是，我该如何修改它，以便如果单击按钮一次，它会立即检查当前问题，然后检查正确答案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T10:20:45.177

使用以下代码。我只写一种方法，你可以写第二种。

```
- (IBAction)answerA:(UIButton *)sender {
if(imgView.image == [UIImage imageNamed:@"1.png"])
{
  if([btnA.titleLabel.text isEqualToString:@"1"])
  {
      [self correctView];
  }
  else
  {
      [self wrongView];
  }
}
else if(imgView.image == [UIImage imageNamed:@"2.png"])
{
  if([btnA.titleLabel.text isEqualToString:@"2"])
  {
      [self correctView];
  }
else
  {
      [self wrongView];
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:53:33.447

而不是设置按钮目标/动作：

```
[btnA addTarget:self action:@selector(correctView) forControlEvents:UIControlEventTouchUpInside]; 
```

在调用之前需要另一个按钮点击`correctView`，为什么不直接调用该方法？

```
[self correctView]; 
```

# objective-c - 编写额外的代码来执行涉及 ivars 的单元测试可以还是应该不惜一切代价避免？

> ID：14435228
> 
> 赞同：2
> 
> 时间：2013-01-21T08:57:43.710
> 
> 标签：objective-c, unit-testing, tdd, code-design

在编写单元测试时我还是个新手，我经常遇到这样的情况，我不知道什么是正确的做事方式。为计划中的设计编写测试我遇到了其中一个引起头皮屑的实例。我的设计：

一个 ViewController 根据用户的输入将消息发送到 dataFetcherClass。（以下代码已更改以保护无辜者）。

```
-(void) userPushedLocalBusinessButtons{
    [_businessDataFetcher fetchLocalData];
}

-(void) userPushedWorldwideBusinessButtons{
    [_businessDataFetcher fetchWorldwideData];
} 
```

这些操作的数据格式相同，它是 dataFetcher 应该从更改中收集数据的位置。所以，在 BusinessDataFetcherClass 我有这些方法：

```
-(void) fetchLocalData{
    _dataAddress = @"localData.json";
    [self fetchData]; 
}

-(void) fetchWorldwideData{
    _dataAddress = @"worldwideData.json";
    [self fetchData]; 
} 
```

fetchData 方法异步获取数据，并在完成后发送包含收集到的数据的通知。现在，我想编写单元测试，检查在执行 fetchLocalData 或 fetchWorldwideData 时 ivar _dataAddress 是否已更改。

如果不更改代码，这显然是不可能的。有人会说，这可以通过将 _dataAddress 设置为公共属性来轻松解决，这是一种解决方案。另一种方法是创建一个返回 _dataAddress ivar 值的方法。我对这两种选择都不完全满意，因为它们在两种情况下都迫使我只为测试更改代码，而不是提高实际代码库本身的整体质量。

我选择了第二种选择，并包含了一个方法 -(NSString *) dataAddress; 我的问题（如标题中所述）是这样是否可以？我的设计有问题吗？显然，TDD 的首要目标是避免回归，但我相信提高整体代码质量也是一个重要目标。是否会添加偶尔的绒毛？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T14:48:05.657

> 我想编写单元测试，检查执行 fetchLocalData 或 fetchWorldwideData 时 ivar _dataAddress 是否已更改。

当你写一个单元测试时，它应该测试一个类的外部行为。这是该类的实现细节。如果您想更改获取数据的工作方式，则该类可能在单元测试失败时仍然有效。这使您的单元测试很烦人，没有帮助。

> 异步获取数据并在完成后发送包含收集到的数据的通知。

听起来这是该类中这些方法的外部行为。这是您应该编写测试来检查的内容。我不知道objective-c，所以这是一个伪代码示例：

```
setup expected local data (preferably with a mock)
call fetchLocalData on BusinessDataFetcherClass 
wait a little bit
check that local data is populated on ViewController 
```

> 我的设计有问题吗？

您在这里的设计确实使编写测试变得更加困难，尽管这不是一个大问题。特别是需要在测试中发生的“等待”。您的测试指出的设计问题是您的类至少有两个职责：获取数据和管理异步。如果您将这些职责分开，它们将更容易测试。

> 显然，TDD 的首要目标是避免回归，但我相信提高整体代码质量也是一个重要目标。是否会添加偶尔的绒毛？

在这种情况下，我认为您可能不需要更多绒毛，但有时确实会在单元测试中发生。当您编写带有测试的代码时，您最终会得到两个代码客户端：测试代码和生产代码。在不同的上下文中满足两个客户的需要迫使一些这种“绒毛”进入，或者迫使一些设计改变。好消息是，当您的设计可以轻松满足两个客户时，如果需要，您可能会相当容易地满足第三个和第四个客户。对我来说，这种效果是 TDD 最重要的好处之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T13:37:20.960

你不想测试你的类的内部状态——这是没有意义的。你唯一关心的是你的班级在与外部世界的互动中做了什么（信息是向内还是向外或双向）。

换句话说：一旦你为你的类编写了一个测试，重写你的类的实现（内部）同时保持它的可见行为不应该破坏你的测试。如果是这样，那么您的测试就被 IMO 破坏了。

测试类行为的一个好方法是使用 Mock 对象——例如，请参阅[OCMock](http://ocmock.org/) for iOS。

模拟对象允许您测试目标类的行为。为此，您需要以某种方式编写目标类：在您的示例中，您需要能够传入网络提供程序类，而不是让您的类关闭并使用某个硬编码的提供程序（可重用的组件永远不应该配置自己，而应该被配置）。一旦您以这种方式进行设置，您的单元测试类就可以传入一个模拟网络服务提供程序，该服务提供程序检查是否命中了正确的 URL。

模拟对象乍一看似乎令人费解，但您正在测试正确的东西——目标类的行为——而没有使用任何特殊的测试方法等污染它。

另请注意，使您的代码易于测试也使其更易于重用：您的测试用例成为代码的第二个“用户”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T03:08:04.033

我也不是 ObjectiveC 开发人员，但我认为您发布此内容的原因是因为您正在听您的代码，而您的代码告诉您有些事情不太对劲。

我想问一下你对`fetchData`通话结果做了什么？我怀疑你在某处渲染数据。如果 iOS 正在渲染它，那么您可能在某处可以断言而不是断言实例变量的回调。如果您从类中更新 UI，如果您引入 Observer 以将您的 UI 和获取数据的代码解耦，那么测试将变得更容易。然后，您可以将您的测试寄存器作为接收器并在那里断言您的状态更改。

希望有帮助！

布兰登

# c# - 将枚举作为参数传递

> ID：14435229
> 
> 赞同：0
> 
> 时间：2013-01-21T08:57:48.280
> 
> 标签：c#, .net, asp.net-mvc-4

我有这个方法，

```
private List<SelectListItem> GetList()
{
    var values = from LtlAccountType item in 
                 Enum.GetValues(typeof(LtlAccountType))
                 select new SelectListItem 
                 { Text = item.ToString(), Value = item.ToString() };
    return values.ToList();
} 
```

查询后如何传递`enum`和`parameter`返回列表`enum`

```
private List<SelectListItem> GetList(Enum obj)
{
    var values = from obj item in Enum.GetValues(typeof(obj))
                 select new SelectListItem 
                 { Text = item.ToString(), Value = item.ToString() };
    return values.ToList();
} 
```

我得到了这个错误`obj`

`Type or namespace name expected`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:03:06.293

**更新：**

[从 C# 7.3 开始，](https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-7-3#enhanced-generic-constraints)您可以将`System.Enum`其用作类型约束。

* * *

你应该打电话`GetType()`而不是使用`typeof()`。您也不能`Enum`用作任何枚举的基类。最好的解决方案是使用`struct`...

```
private List<SelectListItem> GetList<T>(T obj) where T : struct
{
    var values = from Enum item in Enum.GetValues(obj.GetType())
                 select new SelectListItem { Text = item.ToString(), Value = item.ToString() };
    return values.ToList();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:03:26.857

这是因为`obj`在 .NET 中不是有效的类型标识符。你为什么不做一个简单的

```
List<SelectedListItem> result = new List<SelectedListItem>();
foreach (var item in Enum.GetValues(typeof(obj)))
   result.Add(new SelectedListItem() { Text = item.ToString(), Value = item.ToStringt() }

return result; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T09:06:31.473

我刚刚尝试过，它有效：

```
private static List<SelectListItem> GetList(Enum item)
{
    var values = from Enum e in Enum.GetValues(item.GetType())
                 select new SelectListItem { Text = e.ToString(), Value = e.ToString() };
    return values.ToList();
} 
```

# c# - NHibernate - 从 PGSQL 迁移到 MSSQL 时语法不正确

> ID：14435230
> 
> 赞同：0
> 
> 时间：2013-01-21T08:57:51.910
> 
> 标签：c#, sql-server-2008, nhibernate, asp.net-mvc-4

我目前正在尝试将 ASP.NET MVC 4 网站从 postgreSQL 迁移到 MS SQL（然后使用 SQL Azure）。该网站与 pgsql 完美配合。我预计只需更改连接字符串和数据库驱动程序就足够了，但我收到一条错误消息：

```
NHibernate.HibernateException: Incorrect syntax near the keyword 'Public'. ---> System.Data.SqlClient.SqlException: Incorrect syntax near the keyword 'Public'. 
```

请注意，我们使用 NHibernate Castle 进行数据库交互。这是显示 NHibernate 配置的 web.config 部分：

```
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
<session-factory>
  <property name="dialect">NHibernate.Dialect.MsSql2008Dialect</property>
  <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
  <property name="connection.connection_string">Data Source=.\SQLEXPRESS;Initial Catalog=folke;Integrated Security=SSPI;</property>
  <property name="connection.driver_class">NHibernate.Driver.SqlClientDriver</property>
  <property name="proxyfactory.factory_class">NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle</property>
  <mapping assembly="Folke" />
</session-factory> 
```

当我调用此方法时触发错误：

```
public static void Install()
    {
        new SchemaExport(CurrentConfiguration).Execute(true, true, false);
    } 
```

这是完整的错误消息：

> NHibernate.HibernateException：关键字“公共”附近的语法不正确。---> System.Data.SqlClient.SqlException：关键字“Public”附近的语法不正确。在 System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose) 在 System.Data.SqlClient.TdsParser. 在 System.Data.SqlClient.SqlConnection.OnError(SqlException 异常，布尔 breakConnection，操作`1 wrapCloseInAction) at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) 在 System.Data.SqlClient.TdsParser。在 System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds（字符串方法名，布尔异步，Int32 超时）在 System.Data.SqlClient.SqlCommand 的 TryRun（RunBehavior runBehavior，SqlCommand cmdHandler，SqlDataReader dataStream，BulkCopySimpleResultSet bulkCopyHandler，TdsParserStateObject stateObj，Boolean&dataReady）。`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite) at System.Data.SqlClient.SqlCommand.ExecuteNonQuery() at NHibernate.Tool.hbm2ddl.SchemaExport.ExecuteSql(IDbCommand cmd, String sql) at NHibernate.Tool.hbm2ddl.SchemaExport.Execute(Action`1 scriptAction, Boolean export, Boolean throwOnError, TextWriter exportOutput, IDbCommand statement, String sql) at NHibernate.Tool.hbm2ddl.SchemaExport.Execute(Action `1 scriptAction, Boolean export, Boolean justDrop, IDbConnection connection, TextWriter exportOutput) at NHibernate.Tool.hbm2ddl.SchemaExport.Execute(Action`1 scriptAction, Boolean export, Boolean justDrop) --- 内部异常堆栈跟踪结束 -- - 在 NHibernate.Tool.hbm2ddl.SchemaExport.Execute(Action `1 scriptAction, Boolean export, Boolean justDrop) at NHibernate.Tool.hbm2ddl.SchemaExport.Execute(Boolean script, Boolean export, Boolean justDrop) at FolkeLib.BaseDataAccess.Install() in e:\Documents\GitHub\Folke\FolkeLib\BaseDataAccess.cs:line 36 at Folke.Models.Installer.Install() in e:\Documents\GitHub\Folke\Folke\Models\Installer.cs:line 22 at Folke.Controllers.InstallerController.Index() in e:\Documents\GitHub\Folke\Folke\Controllers\InstallerController.cs:line 20 at lambda_method(Closure , ControllerBase , Object[] ) at System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 参数) 在 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary `2 parameters) at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass15.<InvokeActionMethodWithFilters>b__12() at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) 在 System.Web.Mvc.ControllerActionInvoker.<> *c_DisplayClass15 .<>c* _DisplayClass17.b__14() 在 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 个参数）在 System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName);

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T08:18:21.323

实际上，我认为这是因为 MS SQL Server 将 PUBLIC 定义为关键字（http://msdn.microsoft.com/en-us/library/ms189822%28v=sql.100%29.aspx）。

您可能有一些像这样命名的表或属性/列。您应该在映射中重命名它，或将其括在反引号 (`) 中以使 NHibernate 应用方言特定的引号字符。

您还可以在 NHibernate 配置中启用自动引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:34:52.303

看起来您的映射中可能有一些[辅助数据库对象](http://nhforge.org/doc/nh/en/index.html#mapping-database-object)。您可能必须更改它们的 SQL 语法，或使用 dialect-scope 为多种方言提供它们。

自定义 SQL 也可能来自命名查询，如果您在 ISession 上使用 CreateSqlQuery()，但由于在模式创建期间发生异常，这似乎不太可能。请注意，其他一些映射结构（如公式和过滤器）也可能在映射中使用自定义 SQL。

如果这没有帮助，我认为您必须尝试弄清楚实际尝试的 SQL 命令是什么。如果它在异常中不可用，通过提供 NHibernate.pdb 文件和相应的源代码应该很容易做到。并要求 Visual Studio 中断发生异常的位置。

# lucene - 过滤器与默默地将条件附加到 Lucene 中的用户搜索查询

> ID：14435232
> 
> 赞同：2
> 
> 时间：2013-01-21T08:58:00.487
> 
> 标签：lucene, lucene.net

我阅读了[这个](https://stackoverflow.com/questions/1878758/filters-in-lucene)问题的答案，发现有两种方法可以在没有任何用户干预的情况下进一步缩小用户搜索查询的范围：

1.  通过静默修改查询
2.  应用 Lucene 过滤器

我在实现层面上了解上述两种技术，但在概念层面上不了解。我有以下问题：

1.  Lucene 应用过滤器的顺序是什么。是在查询之前还是之后？如果我按名字去，我想，应该是之后。
2.  何时使用一种技术而不是另一种？
3.  在没有功能差异的情况下，上述两种技术之间是否存在性能差异？
4.  当文档具有与之关联的用户权限并且用户在搜索结果中只能看到他/她的文档时，哪种技术更合适？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T11:24:02.240

> Lucene 应用过滤器的顺序是什么。

真的有关系吗？如果您有 n 个独立的过滤器，则总体结果将是这些过滤器在彼此之上运行 AND 功能的产物。

> 是在查询之前还是之后？

严格来说，它们是齐头并进的。`IndexSearcher.java`这是（Lucene 3.4版）的摘录

```
while (true) {
  if (scorerDoc == filterDoc) {
    // Check if scorer has exhausted, only before collecting.
    if (scorerDoc == DocIdSetIterator.NO_MORE_DOCS) {
      break;
    }
    collector.collect(scorerDoc);
    filterDoc = filterIter.nextDoc();
    scorerDoc = scorer.advance(filterDoc);
  } else if (scorerDoc > filterDoc) {
    filterDoc = filterIter.advance(scorerDoc);
  } else {
    scorerDoc = scorer.advance(filterDoc);
  }
} 
```

我如何理解这段代码是过滤器/记分器迭代器都向前推进，如果过滤器在记分器之前，则使用记分器，反之亦然。

> 何时使用一种技术而不是另一种？
> 
> 在没有功能差异的情况下，上述两种技术之间是否存在性能差异？

我通常更喜欢在查询中添加额外的位，因为我相信这比查询后过滤更快（即使您使用`QueryWrapperFilter`）。但是您需要确保客户无法进行 Lucene 查询字符串注入。在某些情况下，性能影响可以忽略不计，并且首选过滤器选项，因为过滤结果集比添加查询元素更容易。

> 当文档具有与之关联的用户权限并且用户在搜索结果中只能看到他/她的文档时，哪种技术更合适？

看到[这个问题](https://stackoverflow.com/questions/13866089)，之前已经讨论过了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T15:00:46.787

如果某些标准没有改变并且会在每次索引更新之间被重复使用多次，那么 a`Filter`通常是要走的路。

例如，我通常使用过滤器来获取用户权限。每次索引更新后，缓存的过滤器只会重新计算一次，直到下一次更新。如果您的索引不是实时的，那效果非常好。

过滤器的另一个用例是避免`BooleanQuery.TooManyClauses`异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T14:59:39.260

如果您在将布尔子句附加到查询和使用过滤器之间犹豫不决，这可能意味着您应该使用过滤器。

过滤器比布尔子句更好，因为它们不需要评分。因此，它们更快并且可以被缓存（如果您经常使用相同的条件进行过滤，这非常有用）。

Lucene 不会在查询后应用过滤器。相反，它首先检查过滤器，以免对无论如何都会被过滤掉的文档进行评分（评分可能很昂贵）。

# ios - 如何从个人 Apple Developer 更改为 Enterprise？

> ID：14435233
> 
> 赞同：14
> 
> 时间：2013-01-21T08:58:02.513
> 
> 标签：ios, iphone-developer-program

我的 iOS 开发者许可证将于 2 月 1 日到期，我想知道是否可以切换到企业许可证，还是应该从头开始？我希望保留我的 Apple ID 和应用程序...

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-21T09:19:29.910

您可能误解了企业 iOS 开发人员计划的全部内容，它不是您注册的标准计划的升级。Enterprise 许可证主要适用于为内部分发（内部）创建专有 iOS 应用程序的公司和组织。主要好处是您可以将私有应用程序部署到 iOS 设备，而无需像分发 Ad-hoc 构建时那样在配置门户中注册 UDID。另一方面，您不得在 App Store 上分发应用程序。

只有拥有 Dun & Bradstreet (DUNS) 编号的公司和组织才能注册企业开发者计划。

查看以下[常见问题解答并在](https://developer.apple.com/support/ios/enterprise.html)[此处](https://developer.apple.com/programs/start/ios/)比较标准和企业开发人员计划

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T09:15:56.380

从个人版切换到企业版意味着您将失去通过 App Store 分发应用程序的能力。

此外，大公司还需要企业许可证才能在内部分发应用程序，这意味着仅适用于员工的应用程序。

# jquery - jQuery将参数传递给函数

> ID：14435235
> 
> 赞同：1
> 
> 时间：2013-01-21T08:58:05.947
> 
> 标签：jquery, function, parameters

我在许多线程中阅读了很多关于这个问题的信息。我发现的最好的在这里：[jQuery's .click - pass parameters to user function](https://stackoverflow.com/questions/3273350/jquery-click-pass-parameters-to-user-function)

```
 // say your selector and click handler looks something like this...
 $("some selector").click({param1: "Hello", param2: "World"}, cool_function);

 // in your function, just grab the event object and go crazy...
 function cool_function(event){
    alert(event.data.param1);
    alert(event.data.param2);
 } 
```

我的问题是我想为我的参数动态分配值。不仅仅是“你好”等。

例如我有这样的事情：

```
 <?php
   for($i=0;$i<5;$i++){
   ?>
   <input type="text" id="client_<?=$i?>"> 
   <?
   }
  ?> 
```

如何重写 jQuery 来处理不同的参数值？例如 0,1,2,3,4

显然，我不能做类似的事情

```
 $("#client_1").click({num:1}, cool_function);
 $("#client_2").click({num:2}, cool_function);
 $("#client_3").click({num:3}, cool_function); 
```

等等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T08:59:35.077

在那个特定的例子中，你可能最好只抓住`id`，因为你已经将它输出到元素：

```
$("some selector").click(function() {
    var num = parseInt(this.id.replace(/\D/g, ""), 10);
    // Do something with `num`
}); 
```

如果你还没有放在`id`那里，你可以使用一个[`data-*`属性](http://www.w3.org/TR/html5/dom.html#embedding-custom-non-visible-data-with-the-data-%2a-attributes)：

```
<?php
for($i=0;$i<5;$i++){
?>
<input type="text" data-num="<?=$i?>"> 
<?
}
?> 
```

...然后在`click`处理程序中检索它：

```
$("some selector").click(function() {
    var num = parseInt($(this).attr("data-num"), 10);
    // Or
    var num = parseInt($(this).data("num"), 10);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:11:20.413

你去：

```
$("#foo").click({param1: "Hello", param2: "World"}, onClick);

function onClick(event) {
    for (var param_name in event.data) {
        if (event.data.hasOwnProperty(param_name)) {
            alert('param_name = '+ event.data[param_name]);
        }
    }
} 
```

[jsFiddle](http://jsfiddle.net/web5me/9QvcP/%20jsFiddle)

# iphone - 如何在 Xcode 4.5.2 中添加标签，标签应在用户单击按钮后出现

> ID：14435237
> 
> 赞同：1
> 
> 时间：2013-01-21T08:58:09.957
> 
> 标签：iphone, xcode, label

我正在尝试编写我的第一个 iPhone 应用程序

在 Xcode 4.5.2 中，我无法将文本添加到标签

我正在尝试在下一个视频中执行该程序

[http://youtu.be/0uVxxdZ5umY](http://youtu.be/0uVxxdZ5umY)

它总是不起作用，错误是使用未声明的标识符“标签”

这总是在我写完之后出现 `labe.text`

在里面`.m file`

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:02:46.780

设置按钮的 IBAction。在该方法中创建一个新的 UILabel 实例并将其添加到您的视图中。

我不确定语法。

```
UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 100, 100)];
label.text = @"your text";
[self.view addSubview:label] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:22:03.310

最简单的方法是

```
UILabel *yourLabel = [[UILabel alloc] initWithFrame:CGRectMake(10, 10, 300, 20];
[yourLabel setTextColor:[UIColor blackColor]];
[yourLabel setBackgroundColor:[UIColor clearColor]];
[yourLabel setFont:[UIFont fontWithName: @"Trebuchet MS" size: 14.0f]]; 
[yourSuperView addSubview:yourLabel]; 
```

如果你想隐藏直到用户按下按钮。你可以做

```
[yourLabel setHidden:YES]; 
```

# iphone - APNS - 连一个推送通知都收不到

> ID：14435239
> 
> 赞同：0
> 
> 时间：2013-01-21T08:58:13.263
> 
> 标签：iphone, apple-push-notifications, ad-hoc-distribution

如果您收到推送通知，有人可以告诉我吗？我认为 APNS 存在问题，因为昨天一切正常，没有进行任何更改，而今天我什至无法收到推送通知。

很高兴听到你的回答。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T09:51:18.473

所以我解决了这个问题，现在一切正常。

问题出在 .pem 文件上。

您可以使用此 url 获取正确的 pem 文件：

[https://pushio.zendesk.com/entries/21644287-generating-a-pem-file-for-ios](https://pushio.zendesk.com/entries/21644287-generating-a-pem-file-for-ios)

# iphone - 如何在不点击播放图标的情况下在浏览器中启动 youtube 视频

> ID：14435243
> 
> 赞同：0
> 
> 时间：2013-01-21T08:58:29.660
> 
> 标签：iphone, ios, ipad, ios6, youtube

我正在使用以下代码播放 youtube url：

```
NSString *youtubeUrl = [NSString stringWithFormat:@"http://www.youtube.com/v/%@",[photo videoUrl]];
[self embedYouTube:[youtubeUrl stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding] frame:CGRectMake(10, 120, 300, 200)];

- (void)embedYouTube:(NSString*)url frame:(CGRect)frame
{
    NSString* embedHTML = @"\
    <html><head>\
    <style type=\"text/css\">\
    body {\
        background-color: black;\
    color: black;\
    }\
    </style>\
    </head><body style=\"margin:0\">\
    <embed id=\"yt\" src=\"%@\" type=\"application/x-shockwave-flash\" \
    width=\"%0.0f\" height=\"%0.0f\"></embed>\
    </body></html>";
    NSString* html = [NSString stringWithFormat:embedHTML, url, frame.size.width, frame.size.height];
    if(videoView == nil) {
        videoView = [[UIWebView alloc] initWithFrame:frame];
        videoView.layer.borderColor = [[UIColor blackColor] CGColor];
        [self.view addSubview:videoView];
        [videoView setHidden:NO];
    }
    [videoView loadHTMLString:html baseURL:nil];
} 
```

用户需要点击 webview 来播放这个视频。不点击播放图标就不能直接加载视频吗？

![在此处输入图像描述](../Images/9f98fb1a05ac7d3f6cf609d6ca609453.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:02:29.670

`autoplay=1`在 URL 中添加一个参数，如下所示：

```
NSString *youtubeUrl = [NSString stringWithFormat:@"http://www.youtube.com/v/%@?autoplay=1",[photo videoUrl]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-27T17:55:25.300

我认为简短的回答是，如果您使用 webView 显示视频，则 Apple 指南不再允许自动播放。[文档特别](https://developer.apple.com/library/safari/documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/AudioandVideoTagBasics/AudioandVideoTagBasics.html#//apple_ref/doc/uid/TP40009523-CH2-SW8)指出：

> 警告：为了防止用户自费通过蜂窝网络进行未经请求的下载，嵌入式媒体无法在 iOS 上的 Safari 中自动播放——用户始终会启动播放。

[Google Developer/ YouTube API docs](https://developers.google.com/youtube/iframe_api_reference#Mobile_considerations)引用了同样的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-07T00:29:22.400

您应该检查[LBYouTubePlayerController](https://github.com/larcus94/LBYouTubeView)，它使用 MoviePlayer 组件来加载 youtube 视频，并且自定义内容要容易得多，例如自动播放功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T09:37:36.543

检查这种方式以嵌入您的播放，支持自动播放

[https://developers.google.com/youtube/player_parameters](https://developers.google.com/youtube/player_parameters)

# php - 将特殊引号转换为常规引号

> ID：14435250
> 
> 赞同：2
> 
> 时间：2013-01-21T08:58:52.513
> 
> 标签：php, character-encoding

我正在尝试解析 html，并且我有一个带有奇怪引号的字符串：

```
‘3’ 
```

如何将他们的字符编码转换为常规`'`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T09:04:53.187

无耻地从[Convert Smart Quotes 中恢复正常](http://snippets.jc21.com/snippets/php/convert-smart-quotes-back-to-normal/)：

```
<?php
function convert_smart_quotes($string) {
    //converts smart quotes to normal quotes.
    $search = array(chr(145), chr(146), chr(147), chr(148), chr(151));
    $replace = array("'", "'", '"', '"', '-');
    return str_replace($search, $replace, $string);
}
?> 
```

通过以下方式找到：[“php convert curly quotes”](http://www.google.com/search?q=php%20convert%20curly%20quotes)。

# android - Android、mjpeg、http 证书

> ID：14435257
> 
> 赞同：1
> 
> 时间：2013-01-21T08:59:20.290
> 
> 标签：android, certificate, raspberry-pi, mjpeg

我刚开始学习android编程，我对java也没有那么有经验。我正在尝试在android中制作一个应用程序，从树莓派流式传输mjpeg（使用mjpeg-streamer）。地址模式是：

```
http://ip_address:8080/?action=stream 
```

树莓派部分就完成了。问题出在Android部分..我尝试了这个代码： [Android and MJPEG](https://stackoverflow.com/questions/3205191/android-and-mjpeg)

然后我得到一个黑屏并且它崩溃了..从那个页面上的评论中，我发现我需要获得http证书或类似的..

我尝试了几种解决方案来信任所有证书，但我遇到了一些语法错误。例如，从这个页面：[https ://stackoverflow.com/a/12742591](https://stackoverflow.com/a/12742591)

我在它说的那一行（appx line 83）上遇到了一个错误：

```
super(null, null, null, null, null, (X509HostnameVerifier)null); 
```

错误是：

```
The constructor SSLSocketFactory(null, null, null, null, null, X509HostnameVerifier) is undefined 
```

而且我不知道如何解决它，因为我是这个主题的新手。Eclipse 建议将 (X509HostnameVerifier) 更改为 (HostNameResolver)。但后来我对 mjpeg 部分的编辑位置感到困惑。

我想我应该改变（appx line 29）：

```
DefaultHttpClient httpclient = new DefaultHttpClient(); 
```

至

```
DefaultHttpClient httpclient = HttpsClientBuilder.getBelieverHttpsClient(); 
```

它仍然崩溃。除了提到的两行之外，我没有更改上面页面中的任何代码。有什么建议吗？

我只想信任所有证书，因为当树莓派重新启动时，有时它会更改 IP 地址。如果IP地址发生变化，我必须获得新的证书吗？

**编辑**

我忘了添加互联网使用权限..这是新的logcat：

```
01-21 18:02:48.825: W/dalvikvm(27150): threadid=1: thread exiting with uncaught exception (group=0x40c4d1f8)
01-21 18:02:48.830: E/AndroidRuntime(27150): FATAL EXCEPTION: main
01-21 18:02:48.830: E/AndroidRuntime(27150): java.lang.RuntimeException: Unable to start activity : android.os.NetworkOnMainThreadException
01-21 18:02:48.830: E/AndroidRuntime(27150):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1973)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1999)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at android.app.ActivityThread.access$600(ActivityThread.java:127)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1159)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at android.os.Looper.loop(Looper.java:137)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at android.app.ActivityThread.main(ActivityThread.java:4513)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at java.lang.reflect.Method.invokeNative(Native Method)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at java.lang.reflect.Method.invoke(Method.java:511)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:974)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:741)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at dalvik.system.NativeStart.main(Native Method)
01-21 18:02:48.830: E/AndroidRuntime(27150): Caused by: android.os.NetworkOnMainThreadException
01-21 18:02:48.830: E/AndroidRuntime(27150):    at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1099)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:84)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at libcore.io.IoBridge.connectErrno(IoBridge.java:138)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at libcore.io.IoBridge.connect(IoBridge.java:112)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:459)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at java.net.Socket.connect(Socket.java:842)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at org.apache.http.conn.scheme.PlainSocketFactory.connectSocket(PlainSocketFactory.java:119)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:144)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:360)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at com.example.testviewer.MjpegInputStream.read(MjpegInputStream.java:31)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at com.example.testviewer.MjpegSample.onCreate(MjpegSample.java:40)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at android.app.Activity.performCreate(Activity.java:4465)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1052)
01-21 18:02:48.830: E/AndroidRuntime(27150):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1932)
01-21 18:02:48.830: E/AndroidRuntime(27150):    ... 11 more
01-21 18:02:57.795: I/Process(27150): Sending signal. PID: 27150 SIG: 9 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T11:04:09.513

我对 http 证书一无所知，但您的日志显示您的应用程序由于以下原因而崩溃`Caused by: android.os.NetworkOnMainThreadException`. 这意味着您在保留用于处理 UI 交互的应用程序主线程上运行网络操作。

将您的网络调用移动到另一个线程或使用[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)类在后台运行网络调用以克服此异常。

# javascript - jQuery data-* vs 类选择器 - 性能？

> ID：14435259
> 
> 赞同：13
> 
> 时间：2013-01-21T08:59:28.350
> 
> 标签：javascript, jquery, jquery-selectors, performance-testing

我见过很多例子（包括最喜欢的 Twitter 的引导程序），其中各种 API 使用`$("[data-something]")`而不是按类选择`$(".something")`

尽管如此，我还是试图找到有关这两个不同选择器之间性能的信息。我很惊讶许多性能测试确实发现这些选择器在大多数现代浏览器上都同样快，所以我决定[自己做测试](http://jsperf.com/class-vs-data-test)

我现在真的很困惑，我不知道是我的测试做错了（不知何故？）还是我之前检查过的其他测试？

如果我在测试时做错了什么或者这些测试是否正确并且**数据属性**选择器实际上比常规**类**选择器慢得多，有人可以提供更多信息吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-23T21:47:38.440

使用属性选择器时，性能可能会因浏览器中的 querySelector 支持而异。jQuery 将退回到一个慢得多的内置库（称为 SizzleJS）。

类名的选择会更快，因为它总是使用 getElementsByClassName，这在所有常见的浏览器上都普遍支持。

在我看来，类的用途与数据属性不同。类将“分类”元素，以便它们可以正确设置样式并创建结构。

数据属性正是：数据。有时您需要在元素中存储其他数据。例如：

```
<table>
    <tr data-id="4" data-category="1">
        <td>Name</td>
        <td>Email</td>
    </tr>
</table> 
```

请注意，出于同样的原因，我没有使用常规的“id”属性。

# objective-c - UILabel 文本没有改变，但是 xx.title 正在工作

> ID：14435261
> 
> 赞同：3
> 
> 时间：2013-01-21T08:59:34.680
> 
> 标签：objective-c, ios6, uilabel, uinavigationbar

我有两个视图控制器。在第一个视图控制器中，我有名称列表。当我单击它时，我希望在第二个视图控制器中显示相同的名称。

我有以下代码。

```
-(void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    // PropDetailViewController is second view controller
    PropDetailViewController *prop = [self.storyboard instantiateViewControllerWithIdentifier:@"prop"];

    ListOfProperty *propList = [propListFinal objectAtIndex:indexPath.row];

    NSString *myText = [NSString stringWithFormat:@"%@", propList.addressOfFlat];
    prop.detailLabel.text = myText;
    prop.title  = myText;

    [self.navigationController pushViewController:prop animated:YES];
    [tableView deselectRowAtIndexPath:indexPath animated:YES];
} 
```

在`PropDetailViewController`，我有`@property (retain, nonatomic) IBOutlet UILabel *detailLabel;`。

我所期待的是，当我单击 say 时，我会在 UILabel 和 UINavigationBar 中`Name 1`看到文本。`Name 1`但是我只`Name 1`在导航栏上看到而不是在 UILabel 上看到。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T09:35:51.713

不建议在程序流的那个点访问 UIView 项。设置 prop.detailLabel.text 的值时，视图可能尚未加载。稍后加载视图时，UIView 将使用 IB 中的 XIB 文件中给出的默认设置进行更新。

你应该设置一个 NSString 属性，让我们说

```
@property (retain, nonatomic) NSString *propName; 
```

在像你一样推送视图控制器之前分配它。但是使用这个属性而不是 UILable。并在 viewDidLoad 的 PropDetailViewController 中执行以下操作：

```
(void) viewDidLoad {
  // call super viewDidLoad and all the works ...

  self.detailLabel.text = propName;

} 
```

您可以使用 viewWillAppear 代替 viewDidLoad。因为 viewDidLoad 可能在您分配属性值时已经执行。

如果您想在保存方面，请发明一种新的 init 方法，您可以在其中交出您想要预先设置的所有值。但我从来没有结合故事板（你可以使用实例化......而不是初始化......）这样做，因此我无法给出任何建议。

另一种干净的方法是坚持使用 propName 属性，但要实现一个自定义设置器`-(void)setPropName:(NSString)propName;`，您可以在其中设置属性（如果您自动合成，则可能是 _propName）并设置 UILable 文本以及在 viewDidLoad 中设置 UILable 文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:38:29.820

试试这个：在 .h

```
@property (retain, nonatomic) NSString *detailText; 
```

在`PropDetailViewController.m`

更改代码行

```
 NSString *myText = [NSString stringWithFormat:@"%@", propList.addressOfFlat];
    prop.detailText = myText;
    prop.title  = myText; 
```

在 ViewDidLoad 中：

```
[self.detailLabel setText:self.detailText]; 
```

# python - 如何在 BeautifulSoup 中访问名为“name”的标签

> ID：14435268
> 
> 赞同：16
> 
> 时间：2013-01-21T08:59:42.193
> 
> 标签：python, xml, beautifulsoup

我想访问一个名为的标签，`"name"`例如：

```
<contact><name>Yesügey</name><lastName>Yeşil</lastName><phone>+90 333 9695395</phone></contact> 
```

由于`"name"`是 BeautifulSoup 标签对象的属性，我无法访问子标签`name`：

```
>>> c1
<contact><name>Yesügey</name><lastname>Yeşil</lastname><phone>+90 333 9695395</p
hone></contact>
>>> c1.name
'contact'
>>> c1.lastname
<lastname>Yeşil</lastname> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-21T09:14:46.613

你可以这样试试

```
>>> soup=BeautifulSoup.BeautifulSoup(content).findAll('name')
>>> for field in soup:
...     print field
... 
<name>Yesügey</name> 
```

或者

```
print soup.find('name').string 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-21T09:16:10.100

这是我得到的：

```
from bs4 import BeautifulSoup as BS
soup = '<contact><name>Yesügey</name><lastName>Yeşil</lastName><phone>+90 333 9695395</phone></contact>'
soup = BS(soup)
print soup.find('name').string
# Prints YesĂźgey 
```

因此，我没有调用名称标签，而是简单地找到它并获取其中的内容:)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-21T09:16:44.563

您可以使用以下`.find()`方法：

例子：

`c2.find('name')`

> <name>Yesügey</name>

`c2.find('name').contents`

> 耶苏盖

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T09:16:30.293

描述的是访问 xml 元素名称的两种不同策略

```
>>> xmlstring = '<contact><name>Yesügey</name><lastName>Yeşil</lastName><phone>+90 333    9695395</phone></contact>'
>>> from BeautifulSoup import BeautifulSoup as Soup
>>> f = Soup(xmlstring)
>>> f.find('name')
<name>YesĂźgey</name>
>>> f.contact.name
u'contact'
>>> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-13T02:57:41.227

迟到的答案，但我在尝试查找时遇到了同样的问题`<textarea name=COMMENTS>`

我的解决方案：

`node = soup.find("textarea", attrs={"name": "COMMENTS"}`

# c - 在 C 中使用 libcURL 访问 google Places API 数据时打印出的网格化结果

> ID：14435274
> 
> 赞同：0
> 
> 时间：2013-01-21T08:59:53.727
> 
> 标签：c, libcurl, google-places-api

我在 C 中使用 libcURL将 HTTP 数据从 google 地方 API（文本搜索请求， [https://developers.google.com/places/documentation/search ）获取到 char* 时遇到了问题。](https://developers.google.com/places/documentation/search)

这是我的代码的一部分：

```
#include <stdio.h>
#include <curl/curl.h>

#define RESULT_SIZE 1024

char result[RESULT_SIZE];

static size_t write_data(char* buf, size_t size, size_t count, void *stream) {
    int c;
    for(c=0;c<size*count;c++)
        result[c]=buf[c];
    return size*count;
}

int main(void) {
    int i;
    char* query[300] = "";
    CURL *curl;
    CURLcode res;

    //initializing..
    for(i=0;i<RESULT_SIZE;i++)
        result[i]=0;
    curl_global_init(CURL_GLOBAL_ALL);
    curl = curl_easy_init();

    // make query sentence
    strcat(query,"https://maps.googleapis.com/maps/api/place/textsearc/json?query=40.690043,-74.045062&key=<myGoogleAPIkey>");

    curl_easy_setopt(curl, CURLOPT_URL, query);
    curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_data);

    res = curl_easy_perform(curl);

    printf("%s\n", result");
} 
```

我想要的结果是：

```
{
   "html_attributions" : [],
   "results" : [
      {
         "formatted_address" : "Statue of Liberty National Monument, Statue Of Liberty, 292 Madison Ave, New York, NY 10017, USA",
         "geometry" : {
            "location" : {
               "lat" : 40.69004950,
               "lng" : -74.04506750
            },
            "viewport" : {
               "northeast" : {
                  "lat" : 40.69850950,
                  "lng" : -74.02906010
               },
               "southwest" : {
                  "lat" : 40.68158840,
                  "lng" : -74.06107489999999
               }
            }
         },
         "icon" : "http://maps.gstatic.com/mapfiles/place_api/icons/generic_business-71.png",
         "id" : "c42384e74cfe05bd24d144b520b95cab496b9593",
         "name" : "Statue of Liberty National Monument",
         "reference" : "CpQBiwAAAJB0nFYotkps-eKyoe4WdSHfbKjGcQKSslzCtxpYrmZXS4-0jEXXz_iQV5ngCostzgcMQwrzLFFoJuY8OTlxltNs0GEVuslLNUjPSw4qMHKA-UIZ4_uPAbGONiLaYK5rW4UE--Ff0CTkaRTWsykQoEhJi8Vtekk1RgaexuJgjrsrWOf8HqCsw_mTXa24fqzYUhIQj-AwBAZy08dB0Y8jUZ0bERoUpKEkf-KXVCGrRGayir9y1KOnBpA",
         "types" : [ "point_of_interest", "establishment" ]
      }
   ],
   "status" : "OK"
} 
```

但我的程序打印出来：

```
PUIJhMF-RoUWJ53xFJbynmmPscOUglzfinXnoE",
     "types" : [ "point_of_interest", "establishment" ]
  }
   ],
   "status" : "OK"
}
iberty, 292 Madison Ave, New York, NY 10017, USA",
         "geometry" : {
            "location" : {
               "lat" : 40.69004950,
               "lng" : -74.04506750
            },
            "viewport" : {
               "northeast" : {
                  "lat" : 40.69850950,
                  "lng" : -74.02906010
               },
               "southwest" : {
                  "lat" : 40.68158840,
                  "lng" : -74.06107489999999
               }
            }
         },
         "icon" : "http://maps.gstatic.com/mapfiles/place_api/icons/generic_business-71.png",
         "id" : "c42384e74cfe05bd24d144b520b95cab496b9593",
         "name" : "Statue of Liberty National Monument",
         "reference" : "CpQBigAAAIIwNFStfq0qjoQp-alxRtjFkaonf462dz_qHebtyT8zwc-WrtGdKmEWF-s05xhZasmbfG2wjqsWR_9UBvWfvo5hXTRTEhFCvD4AxdfJ5sWZIJ1_Rp2RpPdibI0aN30vkjXjATkyrv3W7T8pqZZnEU-zGvO_PhtZh05QJbp0Tw4sxKjgUBrfzw2sKCVXpUXQWBIQ_6rPxztrs4rSI 
```

...像这样的混搭字符串。

难道我做错了什么？那么我怎样才能获得完整的 JSON 类型数据呢？或任何比用 C 编码更好的建议？（实际上，我已经厌倦了在 C..:() 中使用字符串格式

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:19:50.110

首先尝试修复此错误：

```
printf("%s\n", result"); 
```

应该

```
printf("%s\n", result); 
```

**加上……** `RESULT_SIZE`太小了。增加它。

**加上......**每次你得到一个数据块并调用写入函数时，`result`数组将从第一个字节开始覆盖，而不是连接结果

# backbone.js - Backobone 我如何获取数据并对其进行控制台

> ID：14435277
> 
> 赞同：0
> 
> 时间：2013-01-21T09:00:06.110
> 
> 标签：backbone.js

我对使用 backone.js 非常陌生，我正在尝试从模型中获取 json 数据并对其进行安慰，但我什么也没得到...

任何人都建议我在我在模型中解析我的响应时使用正确的方法来控制台和查看数据..

代码 ：

```
(function($){   

var list = {};

list.model = Backbone.Model.extend({
  defaults:{
    name:'need the name'
  },
  urlRoot : 'data/names.json',
  parse:function(response){
    console.log(response);// i am not get any data..
    return response.results;
  }
});

list.view = Backbone.View.extend({

});

var newList = new list.model;
var newView = new list.view({model:newList});

})(jQuery) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:14:30.817

你应该调用`fetch`方法。您可以在模型`initialize`方法中执行此操作：

```
initialize : function() {
  this.fetch();
} 
```

或者在创建模型实例之后：

```
var newList = new list.model;
newList.fetch(); 
```

**编辑：** 小提琴：

```
var list = {};

list.model = Backbone.Model.extend({
  defaults : {
    name : 'need the name'
  },
  url : 'https://graph.facebook.com/4?fields=id,name',
  initialize : function(response) {
    this.fetch();
  },
  parse : function(response){
    console.log(response); // <- {"id":"4","name":"Mark Zuckerberg"}
    return response;
  }
});

list.view = Backbone.View.extend({});

var newList = new list.model;
var newView = new list.view({model:newList}); 
```

# objective-c - 按像素识别 UIScrollView 移动

> ID：14435283
> 
> 赞同：4
> 
> 时间：2013-01-21T09:00:46.547
> 
> 标签：objective-c, uiscrollview

我需要根据它们在屏幕上的位置更改`UIScrollView`子视图，以便它们在向上移动时变小，在向下移动时变大。

有没有办法知道 contentOffset 随着每个像素的变化？我抓住了这个`scrollViewDidScroll:`方法，但是只要移动很快，两次调用之间可能会有一些 200pxls 的变化。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T09:09:24.893

你基本上有两种方法：

1.  子类`UIScrollView`和覆盖`touchesBegan/Moved/Ended`；

2.  将您自己添加`UIPanGestureRecognizer`到当前的`UIScrollView`.

3.  设置一个计时器，每次触发时，更新您的视图阅读`_scrollview.contentOffset.x`；

在第一种情况下，你会为​​触摸处理方法做：

```
- (void)touchesMoved:(NSSet*)touches withEvent:(UIEvent*)event {

UITouch* touch = [touches anyObject];
   _initialLocation = [touch locationInView:self.view];
   _initialTime = touch.timestamp;

   <more processing here>

  //-- this will make the touch be processed as if your own logics were not there
  [super touchesBegan:touches withEvent:event];
} 
```

我很确定您需要这样做`touchesMoved`；不知道手势开始或结束时是否还需要特定的东西；在这种情况下，还要覆盖`touchesMoved:`and `touchesEnded:`。也想想`touchesCancelled:`。

在第二种情况下，您将执行以下操作：

```
//-- add somewhere the gesture recognizer to the scroll view
UIPanGestureRecognizer *panRecognizer = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(panView:)];
panRecognizer.delegate = self;
[scrollView addGestureRecognizer:panRecognizer];

//-- define this delegate method inside the same class to make both your gesture
//-- recognizer and UIScrollView's own work together
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer
{
   return TRUE;
} 
```

第三种情况实现起来非常简单。不确定它是否会比其他两个提供更好的结果。

# jquery - 关闭 div 并更改按钮类 jquery

> ID：14435288
> 
> 赞同：1
> 
> 时间：2013-01-21T09:01:02.573
> 
> 标签：jquery

我的 div 用一个按钮打开，该按钮有两个类（活动或非活动），我想在单击 boby 时更改类并且可以工作，但是当我再次单击该按钮时，该类被混淆了。

我已经搜索了很多，但我只是发现更改类或在 body click 上关闭 div，你能帮我把它们两者结合起来吗？

请，谢谢！

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>TEST</title>
<script type="text/javascript" src="jquery-1.7.1.min.js"></script>
</head>
<style>
body{background:#1E1E1E;}
.link{background:gray;color:black;}
.link_active{background:green;color:white;}
#content{background:gray;border:1px solid;width:100px;height:100px;display:none;}
</style>
<script type="text/javascript">
$(document).ready(function(){
    $(".link").toggle(function(){ 
        $(this).toggleClass("link_active");
    },
    function () {
        $(this).removeClass("active");
    });
    $(".link").click(function(){
        $(this).next("#content").slideToggle("fast");
        $(this).removeClass("active");
    });
    $(document).on('click', function() {
        $('#content').css("display","none");
        $('.link').removeClass("link_active");
        $('.link').addClass("link");
    });
});
</script>
<body>
<a href="#" class="link">OPEN</a>
<div id="content"> content content content content content content</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:55:25.447

看到这个：http: [//jsfiddle.net/LVfdk/2/](http://jsfiddle.net/LVfdk/2/)

```
$(document).ready(function () {

 $(".link").click(function (e) {
    $(this).next("#content").slideToggle("fast");
    $(this).toggleClass("link_active");
    e.stopPropagation();
 });
 $(document).on('click', function (e) {
    if (e.target.id !== "content") {
        $('#content').css("display", "none");
        $('.link').removeClass("link_active");
        $('.link').addClass("link");
    }
 });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:04:33.813

```
$(document).on('click', function() {
        $('#content').toggle();
        $('.link').toggleClass("link_active link");

    }); 
```

# database - 如何在 Django 的两个表中使用 Entry.objects.filter()？

> ID：14435294
> 
> 赞同：0
> 
> 时间：2013-01-21T09:01:28.060
> 
> 标签：database, django

我在 Django 中有两个表：第一个是`file`具有文件信息的表，第二个是`share`具有共享信息 的表：`files_id`是表的外键`Share`：现在，我想检索在共享表中具有 files_id 的文件信息（来自 File 表） . 我怎样才能做到这一点？

```
#models.py
class File(models.Model):
    users = models.ForeignKey(User)
    file_name = models.CharField(max_length=100)
    type = models.CharField(max_length=10)
    source = models.CharField(max_length=100)
    start_date = models.TextField()
    end_date = models.TextField()
    duration = models.TextField()
    size = models.TextField()
    flag = models.TextField()
    #delete_date = models.CharField(max_length=100, null=True, blank=True)

class Share(models.Model):
    users = models.ForeignKey(User)
    files = models.ForeignKey(File)
    shared_user_id = models.IntegerField()
    shared_date = models.TextField() 
```

我想用 users_id 获取 file_information 是 log_id 并获取 shared_date 。我得到 log_id 为：`log_id = request.user.id`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:14:56.240

我不知道你为什么不发布你的模型。

大概你想要类似的东西：

```
File.objects.exclude(share=None) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T18:53:46.237

我对您的模型进行了一些更改，以消除`plural names`for`user`和`file`. 我认为您将它们命名为因为您已经拥有一些数据库。

```
#models.py
class File(models.Model):
    user = models.ForeignKey(User, db_column="users_id")
    file_name = models.CharField(max_length=100)
    type = models.CharField(max_length=10)
    source = models.CharField(max_length=100)
    start_date = models.TextField()
    end_date = models.TextField()
    duration = models.TextField()
    size = models.TextField()
    flag = models.TextField()
    #delete_date = models.CharField(max_length=100, null=True, blank=True)

class Share(models.Model):
    user = models.ForeignKey(User,db_column="users_id")
    file = models.ForeignKey(File, db_column="files_id")
    shared_user_id = models.IntegerField()
    shared_date = models.TextField() 
```

因此，从上述两种模型看来，`File`对象是由一个`User`可以与其他用户共享的对象创建的。既然你有`files_id`某种方式，下面的查询应该可以工作

```
file = File.objects.get(id=files_id)
# Assuming one file is shared only ones by an user
# otherwise you should use filter instead of get
shared_file = Share.objects.get(file=file, user=request.user) 
```

你为什么使用`TextField`存储`DateTime`？你应该使用`DateTimeField`.

# wpf - 为什么 PredictFocus() 不支持 FocusNavigationDirection.Next？

> ID：14435296
> 
> 赞同：6
> 
> 时间：2013-01-21T09:01:30.087
> 
> 标签：wpf, focus

`PredictFocus()`不支持的原因是什么`FocusNavigationDirection.Next`？
当 TAB 被击中时，如何让元素获得焦点？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2016-08-01T08:10:19.380

仅***支持上/下/左/右***值。 ***Next、Previous、First、Last*** 方向对`PredictFocus`（但它们对 是合法的`MoveFocus`）是不合法的。

[FrameworkElement.PredictFocus 方法](https://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.predictfocus(VS.100).aspx)

# java - 如何修复图像裁剪的矩形大小？

> ID：14435297
> 
> 赞同：3
> 
> 时间：2013-01-21T09:01:30.930
> 
> 标签：java, android, android-intent

> **可能重复：**
> [如何修复图像裁剪的放大尺寸？](https://stackoverflow.com/questions/14437594/how-to-fix-the-zoom-in-size-for-image-cropping)

在我的应用程序中，用户可以从图库中选择图像，然后他可以放大/缩小该图像。我想在放大图像裁剪时固定矩形的高度和宽度。如何做到这一点？我尝试了很多，但仍然无法解决问题。请有人帮我解决这个问题。我试过了。

```
//intent.setData(mImageCaptureUri);
        intent.putExtra("crop", "true");
        intent.putExtra("outputX", 200);
        intent.putExtra("outputY", 200);
        intent.putExtra("aspectX", 3);
        intent.putExtra("aspectY", 4);
        intent.putExtra("scale", true);
        intent.putExtra("return-data", true); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:08:12.893

```
 Intent intent = new Intent(Intent.ACTION_GET_CONTENT, null)
        .setType("image/*")
        .putExtra("crop", "true")
        .putExtra("aspectX", width)
        .putExtra("aspectY", height)
        .putExtra("outputX", width)
        .putExtra("outputY", height)
        .putExtra("scale", true)
        .putExtra("scaleUpIfNeeded", true)
        .putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(f))
        .putExtra("outputFormat", Bitmap.CompressFormat.JPEG.toString()); 
```

# connection - 当 Ping 和 FTP 未被阻止时检查互联网访问的简单方法？

> ID：14435303
> 
> 赞同：-1
> 
> 时间：2013-01-21T09:02:03.817
> 
> 标签：connection

我的互联网提供商每天都会随机断开互联网连接。之后，我需要通过使用浏览器登录来进行身份验证。我已经在 Firefox 中设置了 iMacros 来模拟身份验证，但是我如何检查互联网连接何时丢失？我需要一个简单的解决方案，因为我不是专家。

即使互联网访问消失，Ping 和 FTP 似乎也能正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T12:54:45.363

您可以尝试制作一个打开 www.google.com 的脚本。并把脚本每2-3-10分钟开一次G。如果脚本成功打开 google，则什么也不做，如果没有，则启动登录过程。为此，您需要一个 JS 脚本，因为您需要 if 子句。也许您甚至应该考虑使用批处理文件来检查连接，这会容易得多。但是您说 FTP 和 ping 有效，所以我不确定批处理文件。

这个想法是制作批处理文件，该文件将 ping 像 google.com 这样的网站，如果 ping 返回错误以运行宏。如果您进一步解释您的问题，所有这些都是可能的。

# java - 获取 List 的唯一元素

> ID：14435305
> 
> 赞同：1
> 
> 时间：2013-01-21T09:02:11.257
> 
> 标签：java, list, arraylist, set, hashset

所有我有包含重复值的列表我想以某种方式只从中获取唯一值并将其存储在另一个列表或集合中。这样我就可以对其执行一些操作。我的代码：

```
{
        List<Integer[]> list1 = new ArrayList<Integer[]>();
          list1.add(new Integer[] { 1,10 });
            list1.add(new Integer[] { 1,10 });
            list1.add(new Integer[] { 1,10 });      
            list1.add(new Integer[] { 2,10 });
            list1.add(new Integer[] { 1,10 });
            list1.add(new Integer[] { 3,10 });

        for(int i=0;i<list1.size();i++)
        {
            System.out.println("I - 0 :"+list1.get(i)[0]+"\t I - 1 :"+list1.get(i)[1]+"\n");
        }

        Set<Integer[]> uniquelist = new HashSet<Integer[]>(list1);

        for(Integer[] number: uniquelist){
              System.out.println(number[0]+"\t"+number[1]);
            }
    } 
```

我希望结果`{1,10;2,10;3,10}`在单独的列表中。当我用谷歌搜索时，我知道我们应该使用 set 作为唯一`Set<Integer[]> uniquelist = new HashSet<Integer[]>(list1);`但这样做之后我不知道如何访问每个元素提前谢谢

```
Output:
1   10
2   10
1   10
3   10
1   10
1   10 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T09:06:39.657

使用常规方法不会得到您想要的结果`Set`。作为您的`List`contains `Integer[]`，然后默认情况下不会被认为是唯一的。所有数组对象都是不同的。因此，您`Set`将包含与您的列表相同的元素。但是，您可以定义您的`Custom Comparator`, 并将其与`TreeSet`构造函数一起使用。

另一种方法是定义一个方法`contains(List<Integer[]> list, Integer[] value)`，它检查您的列表是否包含该数组。定义一个名为 的列表`uniqueList`。现在，遍历您的原始列表，然后对于每个值，调用`contains`方法传递`uniqueList`和 that`value`作为参数。

您的`contains`方法如下所示：-

```
public static boolean contains(List<Integer[]> list, Integer[] value) {
    for (Integer[] arr: list) {
        // We can compare two arrays using `Arrays.equals` method.
        if (Arrays.equals(arr, value)) {
            return true;
        }
    }
    return false;
} 
```

因此，您可以看到，检查遏制与查找的方式不同`Integer`。

现在，从您的`main`方法中，使用以下代码：-

```
List<Integer[]> unique = new ArrayList<Integer[]>();

for (Integer[] arr: list1) {
    // Use your method here, to test whether this value - `arr` 
    // is already in `unique` List or not. If not, then add it.
    if (!contains(unique, arr)) {
        unique.add(arr);
    }
}

for (Integer[] arr: unique) {
    System.out.println(arr);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T09:04:37.313

`Set`在这种情况下，我宁愿使用实现。`LinkedHashSet`如果您希望您的元素被订购，请使用。

你可以声明一个类 IntegerPair 来保存你的对：

```
class IntegerPair {
  private int key;

  private int value;

  public IntegerPair(int k, int v) {
    key = k;
    value = v;
  }

  public int getKey() {
    return key;
  }

  public int getValue() {
    return value;
  }

  public int hashCode() {
    return key * value;
  }

  public boolean equals(Object o) {
    if (!(o instanceof IntegerPair)) {
      return false;
    }
    IntegerPair other = (IntegerPair) o;
    return key == other.key && value == other.value;
  }
} 
```

以这种方式声明它：

```
Set<IntegerPair> set = new LinkedHashSet<IntegerPair>(); 
```

而不是把`new Integer[]`价值观，只是做`set.add(new IntegerPair(1, 10));`

您可以使用 foreach 方法遍历您的元素：

```
for (IntegerPair value : set) {
  System.out.println(value.getKey() + "  =  " + value.getValue());
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T09:03:50.363

`Iterator`您可以通过或使用每个循环访问元素

```
for(Integer number: setOfNumbers){
  System.out.println(number);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T09:13:29.820

使用您的自定义比较器将它们放入设置中，如下所示：

```
new TreeSet(list1, new Comparator<Integer[]>() {
    public int compare(Integer[] one, Integer[] two) {
        int n = one.length;
        for (int i = 0;  i < n;  i++) {
              int comp = one.compareTo(two);
              if (comp != 0) {
                   return comp;
              }
        }
        return 0;
    }
}); 
```

注意我使用`TreeSet`的可以接受自定义比较器。这是因为您正在处理数组。但是，如果您定义自己的包含 2 个 int 值的类，则可以使其实现`equals()`并`hashCode()`允许使用任何 Set 实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-21T09:29:02.413

**问题 ：**

显然，它会以同样的方式返回，因为[set](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Set.html)是..

> 不包含重复元素的集合。更正式地说，集合不包含一对元素 e1 和 e2 使得 e1.equals(e2)，并且最多包含一个空元素。正如它的名字所暗示的，这个接口模拟了数学集合抽象。

但是在您的情况下，您正在添加列表，例如 ..

```
List<Integer[]> list1 = new ArrayList<Integer[]>();
list1.add(new Integer[] { 1,10 });
list1.add(new Integer[] { 1,10 });
list1.add(new Integer[] { 1,10 });      
list1.add(new Integer[] { 2,10 });
list1.add(new Integer[] { 1,10 });
list1.add(new Integer[] { 3,10 }); 
```

这里`new Integer[] { 1,10 }`每次都是一个不同的对象，因此它添加了所有对象。

**解决方案：**
简单的解决方案是您必须注意在列表中没有重复（根据您的要求）整数数组可以添加。

因此，您可以创建一种方法来检查天气，如果该数组已经在不添加它的列表中，如果不在列表中，则添加它。

```
public void addUnique(List<Integer[]> list, Integer[] newValue) {
    for (Integer[] array: list) {
        //Compare two arrays using `Arrays.equals` method.
        if (Arrays.equals(array, newValue)) {
            list.add(newValue)
        }
    }
} 
```

添加如下调用它..

```
List<Integer[]> list1 = new ArrayList<Integer[]>();
addUnique(list1  , new Integer[] { 1,10 });
addUnique(list1  , new Integer[] { 1,10 });
addUnique(list1  , new Integer[] { 1,10 });
addUnique(list1  , new Integer[] { 2,10 });
addUnique(list1  , new Integer[] { 1,10 });
addUnique(list1  , new Integer[] { 3,10 }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-21T09:14:21.187

[在Google-guava](http://code.google.com/p/guava-libraries/)中尝试[Table](http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Table)集合。

**例子 ：**

```
Table<Integer, Integer, Integer[]> sampleTable = HashBasedTable.create();
sampleTable.put(1, 10, new Integer[] { 1,10 });
sampleTable.put(2, 10, new Integer[] { 2,10 });
sampleTable.put(1, 10, new Integer[] { 1,10 }); 
```

所以它会覆盖重复的值。最后，您只有唯一的值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-21T09:16:25.830

在`Integer[] number`你的 for 循环中是一个数组。要获得里面的值，你必须使用`number[index]`指令。为此，您可以使用变量作为索引执行经典的 while 或 for 循环

```
for(int i=0;i<number.length;i++) {
...
} 
```

或 foreach 循环：

```
for(Integer num : number){
...
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-21T09:20:26.007

这可能会帮助你...

```
public static void main(String [] args){
    Set<Integer []> set = new TreeSet<Integer []>(new Comparator<Integer[]>(){
        public int compare(Integer[] o1, Integer[] o2) {
            if(o1.length == o2.length){
                for(int i = 0; i < o1.length; i++){
                    if(o1[i] != o2[i]){
                        return -1;
                    }
                }
                return 0;
            }
            return -1;
        }
    });

    set.add(new Integer[]{1,2});
    set.add(new Integer[]{1,2});
    set.add(new Integer[]{1,2});
    set.add(new Integer[]{1,3});

    int j = 0;
    for(Integer[] i: set){
        System.out.println("\nElements: "+j);
        j++;
        for(Integer k : i){
            System.out.print(k+" ");
        }
    }
} 
```

您需要使用`Comparator`来比较两个相同的元素。由于我们没有 Array 的比较器，Set 将使用实际对象进行比较.. 使用比较器您必须告诉 set 这两个数组是相同的并且不要添加其他相同的数组

# integration - 如何在 Activiti 中重用现有的用户/组数据？

> ID：14435309
> 
> 赞同：6
> 
> 时间：2013-01-21T09:02:20.103
> 
> 标签：integration, activiti

我有一个具有用户/组功能和现有用户/组数据的 web 应用程序。

我想使用 Activiti 流程引擎，但是，似乎 Activiti 自己管理用户/组信息。

我是不是该：

1.  重构我现有的 webapp，以重用来自 Activiti 的用户/组数据，或者
2.  编写一些适配器代码，让 Activiti 重用我现有数据库中的用户/组数据？也许，另一个实现`RepositoryService`，`IdentityService`等，然后重新编译？它似乎`RepositionServiceImpl`在 Activiti 源代码中是硬编码的，并且`setRepositionService()`在`ProcessEngine`.

我无法重命名现有的数据库表，因为还有其他一些应用程序在使用它们。

我已经阅读了用户指南，但我没有找到任何关于如何将 Activiti 与现有应用程序集成的信息。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T17:06:16.857

我不知道您当前使用的是什么版本，但我在 5.5 版中成功使用了您的第二个选项，覆盖了一些 Activiti 类：

1.  扩展`GroupManager`and `UserManager`（来自 package `org.activiti.engine.impl.persistence.entity`），并使用所需的 DAO/EntityManager/指向您的数据库的任何东西来实现您需要的方法。此处的代码：[GroupManager](http://pastebin.com/KCV3R0dg) / [UserManager](http://pastebin.com/EK8t4sQG)。

2.  `org.activiti.engine.impl.interceptor.SessionFactory.SessionFactory`为组和用户实施,。在此处查看代码：[ActivitiGroupManagerFactory](http://pastebin.com/6k0fEAi4) / [ActivitiUserManagerFactory](http://pastebin.com/ipfR1CtQ)。

3.  最后，在您的活动配置中，您必须设置新的 SessionFactory 类。我使用的是spring，所以有我的activiti-config bean代码：[activiti-config.xml](http://pastebin.com/zPwYUfBK)（检查第14行）

希望这在某种程度上有所帮助:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T11:31:50.827

您可以检查 Lim Chee Kin 代码以将 activiti 与 spring security [https://github.com/limcheekin/activiti-spring-security](https://github.com/limcheekin/activiti-spring-security)集成，也许您可​​以通过 spring security 重用您的用户/组数据，这样您就可以重用他的代码。

# joomla - 更改模块 joomla 的类

> ID：14435316
> 
> 赞同：0
> 
> 时间：2013-01-21T09:02:38.890
> 
> 标签：joomla, joomla2.5

我在 joomla 有一个菜单...

在我的模板中，我显示这样的菜单

```
<jdoc:include type="modules"  name="header" style="none"/> 
```

当我看到生成的 html 时，我的菜单类是“munu”

如何将此类更改为其他类？

不放后缀，我想将 class="menu" 更改为 class="other"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:17:13.820

您可以通过管理面板更改类的后缀，您只需进入管理面板，然后进入模块管理器，然后进入菜单模块。在菜单模块中，您将有高级参数来设置类后缀，如屏幕截图所示。![在此处输入图像描述](../Images/a4fa2fe8971bc2e5cb6921993402fde0.png)

如果您无法更改菜单类，您可以更改 div 容器的样式。

```
<div class="other"><jdoc:include type="modules"  name="header" style="xhtml"/></div> and then you can change the style with the reference of the container class. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:55:04.607

如果要更改**菜单类**，则必须在文件夹中的`default.php`文件中`mod_menu`进行更改。但`tmpl`我不建议您更改核心文件，要做到这一点，您可以使用模板覆盖方法。有关如何使用它的更多信息通过这个链接。

[如何覆盖 Joomla 的输出！核](http://docs.joomla.org/How_to_override_the_output_from_the_Joomla!_core)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T10:46:28.030

@user852610 覆盖模块菜单 html。

1.  复制模块菜单，粘贴到 /templates/yourtemplate/html
2.  将 tmpl 文件夹中的所有文件复制到父文件夹并删除其他文件
3.  在 default.php 中查找并替换类“菜单”

# database - 显示字符串到存储在数据库中的数据的顺序

> ID：14435318
> 
> 赞同：0
> 
> 时间：2013-01-21T09:02:51.170
> 
> 标签：database, oracle, pdo

例如，我有下表中的数据

表顺序

```
-----------------------------------------
   id_order    no_order       order_date
-----------------------------------------
     1         0000001       12-01-2013
     2         0000002       15-01-2013
----------------------------------------- 
```

表 item_order

```
--------------------------------------------------
   id_item_order       id_order      order_name
--------------------------------------------------
       1                 2           Product 1
       2                 2           Product 2
       3                 2           Product 3
       4                 2           Product 4
-------------------------------------------------- 
```

然后我想显示来自数据库的数据加入如下

```
--------------------------------------------------
  id_item_order     order_name       no_order
--------------------------------------------------
      1             Product 1        0000002 A
      2             Product 2        0000002 B
      3             Product 3        0000002 C
      4             Product 4        0000002 D
-------------------------------------------------- 
```

如何根据表序中item_order和id_order相关的数据量显示no_order后面的字符“A-n”？

请帮我。谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:54:22.227

我不知道 oracle 但我尝试使用 SQL 并且效果很好

```
select TIO.id_item_order,TIO.order_name,[TO].no_order + char(ROW_NUMBER() 
 OVER (order by id_item_order )+64) as no_order 
 from  
 TableItemOrder TIO inner join TableOrder [TO] on [TO].id_order=TIO.id_order 
```

它对我有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T10:10:56.907

用于测试的[SQL Fiddle](http://www.sqlfiddle.com/#!4/c766f/21/0)

```
select i.id_item_order, i.id_order,
        o.no_order || chr(rownum + 64) as no_order
from item_order i
inner join "order" o on o.id_order = i.id_order; 
```

# c# - ADO.NET 实体数据模型（实体对象）

> ID：14435322
> 
> 赞同：1
> 
> 时间：2013-01-21T09:03:09.947
> 
> 标签：c#, asp.net, sql, entity-framework, ado.net

我有实体实例（北）

```
NorthdatabaseEntity north = new NorthdatabaseEntity() 
```

问题是我无权访问 ObjectContext 方法。我试图用对象“north”来调用它们，但我没有从 ObjectContext 中找到方法“AddObject”或任何其他方法。我认为任何实体对象都具有 ObjectContext 类的所有方法。

这里的问题在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:18:36.910

ObjectContext 和实体是不同的对象；您可以使用`ObjectContext`添加/修改/删除对象，但实体不能直接访问`ObjectContext`.

您需要创建一个实例`ObjectContext`并对其自身执行操作，而不是对实体执行操作。

# javascript - JavaScript 和服务器命令

> ID：14435325
> 
> 赞同：-2
> 
> 时间：2013-01-21T09:03:13.727
> 
> 标签：javascript, webserver

这听起来可能很愚蠢，但是 JavaScript 可以用于黑客攻击吗？它可以用于执行服务器端命令，例如设置服务器变量或访问存储在服务器中但未发布到 Internet 的文件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:05:04.707

不，JavaScript 是一种客户端语言。

尽管 JavaScript 可用于在客户端执行某些操作（例如通过 ajax 调用发送密码），但它甚至不会在服务器上执行。

# django - 将 django 站点移动到另一台服务器

> ID：14435330
> 
> 赞同：0
> 
> 时间：2013-01-21T09:03:35.577
> 
> 标签：django, syncdb

我想将我的 django 站点移动到另一台机器上。（我想从空数据库开始）
我想我会完成以下步骤。

*   复制所有文件

    设置所有工具（django、python、..等）

    运行同步数据库

当我运行时`manage.py syncdb`，它抱怨某些表（例如 django_content_type）不存在。
我查看了数据库，数据库中确实没有表。

我试过`recreate project`（startproject）或`recreate app`（startapp）。（但他们失败了，因为项目或应用程序名称已被占用。）

我应该怎么办？
我能想到的原因是mysql升级到5.5.27（默认为innodb）

* * *

```
$ python manage.py syncdb
Traceback (most recent call last):
  File "manage.py", line 10, in <module>
    execute_from_command_line(sys.argv)
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/core/management/__init__.py", line 443, in execute_from_command_line
    utility.execute()
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/core/management/base.py", line 196, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/core/management/base.py", line 231, in execute
    self.validate()
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/core/management/base.py", line 266, in validate
    num_errors = get_validation_errors(s, app)
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/core/management/validation.py", line 30, in get_validation_errors
    for (app_name, error) in get_app_errors().items():
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/db/models/loading.py", line 158, in get_app_errors
    self._populate()
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/db/models/loading.py", line 64, in _populate
    self.load_app(app_name, True)
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/db/models/loading.py", line 88, in load_app
    models = import_module('.models', app_name)
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
    __import__(name)
  File "/home/ubuntu/Documents/aLittleArtist/django/gallery/models.py", line 152, in <module>
    ALBUM_IMAGE_TYPE = ContentType.objects.get(app_label="gallery", model="AlbumImage")
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/db/models/manager.py", line 131, in get
    return self.get_query_set().get(*args, **kwargs)
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/db/models/query.py", line 361, in get
    num = len(clone)
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/db/models/query.py", line 85, in __len__
    self._result_cache = list(self.iterator())
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/db/models/query.py", line 291, in iterator
    for row in compiler.results_iter():
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/db/models/sql/compiler.py", line 763, in results_iter
    for rows in self.execute_sql(MULTI):
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/db/models/sql/compiler.py", line 818, in execute_sql
    cursor.execute(sql, params)
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/db/backends/util.py", line 40, in execute
    return self.cursor.execute(sql, params)
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/django/db/backends/mysql/base.py", line 114, in execute
    return self.cursor.execute(query, args)
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/MySQLdb/cursors.py", line 174, in execute
    self.errorhandler(self, exc, value)
  File "/home/ubuntu/virtualenvs/aLittleArtist/local/lib/python2.7/site-packages/MySQLdb/connections.py", line 36, in defaulterrorhandler
    raise errorclass, errorvalue
django.db.utils.DatabaseError: (1146, "Table 'gallery_db.django_content_type' doesn't exist") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T10:39:31.217

ALBUM_IMAGE_TYPE = ContentType.objects.get(app_label="gallery", model="AlbumImage")

这条线是罪魁祸首。
似乎上面的行尝试在创建任何数据库表之前进行数据库查询。

我删除了该行和相关代码并让syncdb运行。并确实与南方迁移。

# c# - 是否可以将枚举与字典等配对值一起使用

> ID：14435339
> 
> 赞同：6
> 
> 时间：2013-01-21T09:03:59.543
> 
> 标签：c#, .net

在 c# 中，我对理解 Enum 有点困惑。

在我的特定情况下，我需要以名称值格式存储常量值，例如>

300 秒 = 5 分钟

目前我使用这个类。

*   可以改用 Enum，所以我的 Enum 类看起来像吗？
*   我可以在枚举中存储一对值吗？

你能给我一个代码示例吗？

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace MyWebSite.Models
{
    public class Reminders
    {
        private sortedDictionary<int, string> remindersValue = new SortedDictionary<int, string>();

        // We are settign the default values using the Costructor
        public Reminders()
        {
            remindersValue.Add(0, "None");
            remindersValue.Add(300, "5 minutes before");
            remindersValue.Add(900, "15 minutes before");
        }

        public SortedDictionary<int, string> GetValues()
        {
            return remindersValue;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T09:08:14.397

您可以使用`Tuple<int, int>`as 字典键（至少在 .NET >= 4 中）。

但是由于您实际上想要存储 a [`TimeSpan`](http://msdn.microsoft.com/en-us/library/269ew577.aspx)，因此将其用作键。

```
private static Dictionary<TimeSpan, string> TimeSpanText = new Dictionary<TimeSpan, string>();

static Reminders()
{
    TimeSpanText.Add(TimeSpan.Zero, "None");
    TimeSpanText.Add(TimeSpan.FromMinutes( 5 ), "5 minutes before");
    TimeSpanText.Add(TimeSpan.FromMinutes( 15 ), "15 minutes before");
    TimeSpanText.Add(TimeSpan.FromMinutes( 30 ), "30 minutes before");
    TimeSpanText.Add(TimeSpan.FromHours( 1 ), "1 hour before");
    // ....
}

public static string DisplayName(TimeSpan ts)
{
    string text;
    if (TimeSpanText.TryGetValue(ts, out text))
        return text;
    else
         throw new ArgumentException("Invalid Timespan", "ts");
} 
```

您可以通过以下方式获得翻译：

```
var quarter = TimeSpan.FromMinutes(15);
string text = TimeSpanText[ quarter ]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-21T09:10:01.043

您可以使用描述属性装饰您的枚举，并在以后通过反射访问它们。例如，

```
enum ReminderTimes
{
    [Description("None")]
    None = 0,

    [Description("5 minutes before")]
    FiveMinutesBefore = 300,

    [Description("15 minutes before")]
    FifteenMinutesBefore = 900
} 
```

您可以通过以下方式获取描述：

```
public static string GetDescription(this Enum value)
{            
    FieldInfo field = value.GetType().GetField(value.ToString());

    DescriptionAttribute attribute
            = Attribute.GetCustomAttribute(field, typeof(DescriptionAttribute))
                as DescriptionAttribute;

    return attribute == null ? value.ToString() : attribute.Description;
} 
```

另请参阅： http: [//www.codeproject.com/Articles/13821/Adding-Descriptions-to-your-Enumerations](http://www.codeproject.com/Articles/13821/Adding-Descriptions-to-your-Enumerations)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-21T09:13:12.743

枚举实际上是一个命名的整数类型。例如

```
public enum Foo : int 
{
   SomeValue = 100,
} 
```

这意味着您创建了一个类型为“int”和一些值的 Foo 枚举。我个人总是明确说明正在发生的事情，但 c# 隐含地将其设为“int”类型（32 位 int）。

您可以使用任何名称作为枚举名称，并且可以使用 Enum.IsDefined 检查它是否是有效的枚举（例如检查 300 是否是有效的枚举名称）。

**更新**

好吧，说实话，这并不是 100% 正确的。此更新只是为了展示幕后实际发生的事情。枚举是一种值类型，其字段充当名称。例如，上面的枚举实际上是：

```
public struct Foo 
{ 
    private int _value;
    public static Foo SomeValue { get { return new Foo() { _value = 100 }; } }
} 
```

请注意，'int' 是 int 的类型（在我的例子中是显式的）。因为它是一种值类型，所以它与内存中的实整数具有相同的结构——这可能是编译器在进行强制转换时使用的结构。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-21T09:08:29.807

如果您问是否可以针对枚举存储整数值，那么可以，例如

```
 public enum DurationSeconds
 {
     None = 0,
     FiveMinutesBefore = 300,
     FifteenMinutesBefore = 900,
     ThirtyMinutesBefore = 1800,
     OneHourBefore = 3600,
     TwoHoursBefore = 7200,
     OneDayBefore = 86400,
     TwoDaysBefore = 172800
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-21T09:41:38.117

与我通常做的相反，我将添加另一个答案，即 IMO 问题的答案。

您通常希望编译器在实际使用运行时检查之前尽可能多地进行检查。这意味着在这种情况下使用 Enum 获取值：

```
// provides a strong type when using values in memory to make sure you don't enter incorrect values
public enum TimeSpanEnum : int
{
    Minutes30 = 30,
    Minutes60 = 60,
}

public class Reminders
{
    static Reminders()
    {
        names.Add(TimeSpanEnum.Minutes30, "30 minutes");
        names.Add(TimeSpanEnum.Minutes60, "60 minutes");
    }

    public Reminders(TimeSpanEnum ts)
    {
        if (!Enum.IsDefined(typeof(TimeSpanEnum), ts))
        {
            throw new Exception("Incorrect value given for time difference");
        }
    }

    private TimeSpanEnum value;
    private static Dictionary<TimeSpanEnum, string> names = new Dictionary<TimeSpanEnum, string>();

    public TimeSpan Difference { get { return TimeSpan.FromSeconds((int)value); } }
    public string Name { get { return names[value]; } }

} 
```

在创建这样的程序时，该语言可以通过以下几种方式帮助您：

*   您不能使用未定义的时间跨度
*   准确地说，它只初始化字典一次：当类型被构造时
*   Enum.IsDefined 确保您不使用不正确的 int 值（例如 new Reminders((TimeSpanEnum)5) 将失败。

# jquery - jQuery，可排序：修改“clickAt”

> ID：14435341
> 
> 赞同：1
> 
> 时间：2013-01-21T09:04:09.233
> 
> 标签：jquery, html, drag-and-drop

我有以下可拖动的列表项结构：

```
<ul id="dadCol_0" class="dad-list ui-sortable">
<li class="dad-item ui-draggable" id="sl1" style="position: relative;">1</li>
<li class="dad-item ui-draggable" id="sl2" style="position: relative;">2</li>
<li class="dad-item ui-draggable" id="sl3" style="position: relative;">3</li>
<li class="dad-item ui-draggable" id="sl4" style="position: relative;">4</li>
<li class="dad-item ui-draggable" id="sl5" style="position: relative;">5</li>
</ul> 
```

现在，当您在矩形内单击开始拖动时并不重要 - 但我希望它成为该矩形的中心（宽度 / 2，高度 / 2）。我有点需要使用`clickAt`我猜想的属性，但这里有一个我到目前为止所做的小例子：

```
$('.dad-item').each(function() {
    $(this).draggable({
        opacity: 0.6, 
    });
}); 
```

这确实不透明度，但现在拖动被打破：项目不会改变顺序，没有恢复触发等。

编辑：第二次尝试：

```
dad_list.sortable({
    connectWith: 'ul.dad-list',
    containment: '#containment',
    items: 'li.dad-item',
    cursorAt: {
        top: $(this).height()
    },
    stop: function(event, ui) {
        serializedads();
    }       
}); 
```

现在我不能上下移动它，只能水平移动

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:35:26.637

我想你需要这样的东西

```
$('.dad-item').draggable({
    opacity: 0.6,
    cursorAt: {
        left: width / 2,
        top: height / 2
    }
}); 
```

# parsing - 如何检查 ash 脚本中的额外参数？

> ID：14435349
> 
> 赞同：0
> 
> 时间：2013-01-21T09:04:36.477
> 
> 标签：parsing, getopts, ash

我有一个 ash 脚本，我需要在其中检查用户是否输入了任何愚蠢的内容。正确的用法是：

```
script <read | monitor> -s <system | event> [-f filter] [-n number] 
```

我需要检测用户是否像这样唤起它：

```
script read -s system dummydummy 
```

为了解析正确的参数，我使用

```
while getopts "s:f:n:" Option
do
  case $Option in
    s)logname=${OPTARG};;
    f)filterspec=${OPTARG};;
    n)numlines=${OPTARG};;
    *)exit $E_OPTERROR;;   # DEFAULT
  esac
  OPRIND=${OPTIND}
done 
```

如何检测是否有任何剩余的未解析参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:13:51.687

您可以在退出*while*循环后使用它：

```
shift $(($OPTIND - 1))
echo "Remaining arguments: $@" 
```

它可以在*类似 bash*的 shell 中工作，如果它也可以在 ash 中工作，请告诉我们。

# language-agnostic - 复制垃圾收集器如何确保复制时不访问对象？

> ID：14435354
> 
> 赞同：11
> 
> 时间：2013-01-21T09:05:04.200
> 
> 标签：language-agnostic, concurrency, garbage-collection, copying

在收集时，垃圾收集器将所有活动对象复制到另一个内存空间，从而丢弃进程中的所有垃圾对象。指向新空间中复制对象的前向指针安装到对象的“旧”版本中，以确保收集器正确更新对该对象的所有剩余引用，并且不会错误地将同一对象复制两次。

这显然适用于停止世界的收藏家。然而，由于 stop-the-world 的暂停时间很长，现在大多数垃圾收集器允许 mutator 线程与收集器并发运行，只在短时间内停止 mutator 以进行初始堆栈扫描。

那么收集器如何确保在复制对象时/之后不会访问对象的“旧”版本？我想变异器可以检查带有某种读取障碍的前向指针，但这对我来说似乎代价高昂，因为变量被经常读取。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T09:44:53.170

在 Azul 的 Generational Pauseless Garbage Collector 中实现的*Loaded Value Barrier*是解决此问题的一个示例。你可以在 2011 年初在 InfoQ 上发布的文章[*The Azul Garbage Collector*](http://www.infoq.com/articles/azul_gc_in_detail)中了解它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T17:29:11.780

您几乎需要使用读屏障或写屏障。您显然已经意识到阅读障碍，所以我不会尝试进入它们。

写入器屏障起作用，因为只要您阻止写入发生，您根本不关心是否有人访问旧的或新的数据副本。您设置写屏障，复制数据，然后开始调整指针。复制完成后，您并不真正关心是否有人读取数据的旧副本或新副本，因为写入屏障确保它们是相同的。一旦你完成了指针的调整，一切都将与新数据一起工作，所以你撤销了写屏障。

使用页面保护位将内存区域标记为只读以在相当标准的硬件上创建写屏障已经完成了一些工作。然而，至少在我最后一次研究它时，这仍处于概念验证阶段——工作，但速度太慢，不太实用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-12-02T15:04:34.783

免责声明：这仅与java有关`Shenandoah GC`。

你的理由绝对正确`Shenandoah`！例如[这里](https://stackoverflow.com/questions/59044616/whats-the-mark-compact-algorithm-used-by-hotspot/59141137#59141137)的一些细节。

在不久前，*所有*原始类型和引用类型`Shenandoah`都有写入和读取障碍。正如您所假设的那样，读取障碍实际上只是通过的单一间接。由于它们与写入（这是一个更复杂的障碍）相比要多得多，因此这些读取障碍比那些读取障碍更昂贵（累积时间）。*这与这些数量如此之多*的唯一事实有关。*`forwarding pointer``write`*

 **但是，当实施屏障时[， jdk-13 中的情况发生了变化。](https://bugs.openjdk.java.net/browse/JDK-8221766)`Load Reference`因此，*只有*负载有障碍，写入以通常的方式发生。如果您考虑一下，这很有意义，为了*写入*Object 字段，您需要先*读取*该对象，因此如果您的屏障保留“to-space 不变量”，您将*始终*从最近的和对象的正确副本；无需使用带有`forwarding pointer`.**

# php - Opencart 客户组登录重定向到不同的页面

> ID：14435361
> 
> 赞同：0
> 
> 时间：2013-01-21T09:05:49.450
> 
> 标签：php, e-commerce, opencart

我在我的 openacart 管理员中添加了 3 个客户组，即

1.  所有者
2.  卖方
3.  客人

当这个客户登录时，我在寻找什么，每个组客户都希望重定向到不同的页面......例如：

如果**所有者**登录 - 重定向到 (ownerpage.php)

如果**卖家**登录 - 重定向到（sellerpage.php）

如果**访客**登录 - 重定向到 (guestpage.php)

并为这些组客户提供一些用户页面权限，如管理员用户权限......任何想法......？是否有任何可用的扩展或必须做任何自我编码......？？？

谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T10:25:54.103

这些页面是信息页面吗？无论如何，您可以在 catalog/controller/account/account.php 中设置重定向

（示例使用 Opencart 1.5.4.1）

在此行之前：

```
$this->data['heading_title'] = $this->language->get('heading_title'); 
```

添加：

```
$id = $this->customer->getCustomerGroupId();
   if ($id == 1){
  $this->redirect($this->url->link('custom_page1', '', 'SSL'));
   }
   if ($id == 2){
  $this->redirect($this->url->link('custom_page2', '', 'SSL'));
   }
.... 
```

不知道您所说的页面权限是什么意思。也许您可以修改您的问题以使其更清楚。

[编辑：2013-01-23]

要限制对某些信息页面的访问，您可以检查请求的 information_id 和当前用户组，然后输出自定义内容：

在目录/控制器/信息/信息.php 中找到第 62 行：

```
 $this->response->setOutput($this->render());
    } else {
    ...... 
```

在前面添加：

```
$id = $this->customer->getCustomerGroupId();
        if ($id == 1 && $information_id == 7){
            $this->data['heading_title'] = 'Not allowed.';
            $this->data['description'] = 'You are not allowed to view this page';
        } 
```

根据您的需要修改条件。当然，您可以在其他控制器中执行相同操作，只需删除 information_id 检查即可。当然，您可能只想将用户重定向到主页或其他任何内容，而不是显示自定义消息。但我认为这更优雅，对用户来说也不那么烦人。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-14T12:04:10.283

现在最新版本有这个选项（我在 2.0.2 中找到了这个）：

$groupid = $this->user->getGroupId();

希望这可以帮助某人。

# c# - 如何使用 linq 和“包含”进行过滤

> ID：14435363
> 
> 赞同：-2
> 
> 时间：2013-01-21T09:05:55.923
> 
> 标签：c#, linq, entity-framework

我尝试根据未知数量的过滤器过滤我的项目。

//item.statusId 可以为空 int //statusIds 是一个字符串

```
{...

        var statusIds = Convert.ToString(items["StatusId"]);//.Split(';');

        results = mMaMDBEntities.MamConfigurations.Where(item => 
                  FilterByStatusId(statusIds, item.StatusId)).ToList();

    } 
    return results;
}

private bool FilterByStatusId(string statusIds, int? statusId)
{
    return statusIds.Contains(statusId.ToString());
} 
```

但我收到此错误： `LINQ to Entities does not recognize the method 'Boolean FilterByStatusId(System.String, System.Nullable`1[System.Int32])' 方法，并且此方法无法转换为商店表达式。`

知道如何重写它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:07:53.130

如果`statusIds`是一个数组，那么你可以这样做：

```
results = mMaMDBEntities.MamConfigurations
                        .Where(item => statusIds.Contain(item.StatusID)).ToList(); 
```

一些类似于 SQL 的东西`Select * from table where ID in (1,2,3)`

编辑：

从您的代码看来，您有一个带有分号分隔值的字符串。您可以尝试以下方法来获取一个数组，`int`然后在您的 LINQ 表达式中使用它。

```
var str = Convert.ToString(items["StatusId"]);//.Split(';');
// string str = "1;2;3;4;5"; //similar to this. 
int temp;
int[] statusIds = str.Split(new[] { ";" }, StringSplitOptions.RemoveEmptyEntries)
                     .Select(r => int.TryParse(r, out temp) ? temp : 0)
                     .ToArray(); 
```

然后稍后您可以`int`在表达式中使用该数组，例如：

```
results = mMaMDBEntities.MamConfigurations
                        .Where(item => statusIds.Contain(item.StatusID)).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:08:01.417

为什么不将谓词语句直接插入 where 子句？

像这样：

```
results = mMaMDBEntities.MamConfigurations.Where(item => statusIds.Contains(item.StatusId).ToList(); 
```

您可能需要将 Split 产生的字符串数组转换为 List 或 IEnumerable 以使其工作。

* * *

异常是不言自明的，该方法无法转换为您编写的形式的 SQL 语句，但是如果您像上面那样编写它，您应该获得相同的结果并且它会起作用。

# asp.net-mvc-3 - 安装 VS2012 后 WebPageContext.Current 为空

> ID：14435371
> 
> 赞同：1
> 
> 时间：2013-01-21T09:06:45.633
> 
> 标签：asp.net-mvc-3, visual-studio-2012

所以我决定试试 Visual Studio 2012 专业版。安装它并打开我的 MVC3 解决方案后，我在 ((WebViewPage)WebPageContext.Current.Page).Html; 其中 WebPageContext.Current 为空。不好的想法是：即使在检查了“干净”解决方案并使用 Visual Studio 2010 打开它之后，我仍然会遇到同样的异常，而其他项目成员却没有。发生异常的地方在这篇[文章](https://stackoverflow.com/questions/4710853/using-mvc-htmlhelper-extensions-from-razor-declarative-views)中有特色。代码：

```
// Workaround - exposes the MVC HtmlHelper instead of the normal helper
public static new HtmlHelper<object> Html
{
    get { return ((WebViewPage)WebPageContext.Current.Page).Html; }
} 
```

# batch-file - 根据 ID 将行从一个文本文件复制到另一个文本文件的批处理脚本

> ID：14435375
> 
> 赞同：1
> 
> 时间：2013-01-21T09:07:13.087
> 
> 标签：batch-file

我需要编写一个批处理脚本来从具有两个给定 ID 号之一的管道分隔文件中复制这些行。

例如，对于这个文件：

```
Jack | 12 | Jacksonville
Jane | 34 | Minneapolis 
```

必须硬编码的 ID 号是 12 和 56。因此必须生成一个新的文本文件，其中包含以下内容：

```
Jack | 12 | Jacksonville 
```

建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T14:31:03.207

我不确定您所说的“复制”是什么意思。我假设您要创建一个仅包含匹配行的新文件。使用带有正则表达式的 FINDSTR 有一个非常简单的解决方案。每个正则表达式在第 2 列中查找 ID，并允许在 ID 前后有任意数量的空格（包括 0）。

```
findstr /rb /c:"[^|]*| *12 *|" /c:"[^|]*| *56 *|" "file.txt" >"newFile.txt" 
```

**更新：2015-12-20**

FINDSTR 具有非常原始且完全非标准的正则表达式支持。缺乏交替迫使每个数字替代都需要整个正则表达式。如果您正在寻找更多替代方案，这可能是一个问题。

[使用我的JREPL.BAT 正则表达式文本处理工具](http://www.dostips.com/forum/viewtopic.php?t=6044)有一个更简单的解决方案。它是纯脚本（混合 JScript/批处理），可以在 XP 以后的任何 Windows 机器上本地运行。

```
call jrepl "^[^|]*\| *(12|56) *\|.*" $0 /jmatch /f "test.txt" /o "newFile.txt" 
```

添加额外的管道分隔数字以在括号内搜索是一件简单的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:33:49.730

文件中所有匹配 12 或 56 的 ID`IDFile.txt`都将输出到一个新文件`MatchingIDs.txt`中。

```
@echo off
setlocal enabledelayedexpansion
set line=0
for /f "tokens=2 delims=|" %%a in (IDFile.txt) do (
set num=%%a
set num=!num: =!
if !num!==12 set bool=true
if !num!==56 set bool=true
if "!bool!"=="true" call :GETLINE
set /a line+=1
set bool=false
)

:GETLINE
if not %line%==0 set skip=skip=%line%
for /f "%skip% tokens=* delims=" %%b in (IDFile.txt) do (
echo %%b >>MatchingIDs.txt
goto :BREAK
)
:BREAK 
```

# javascript - 用正则表达式（JavaScript）多次替换字符串？

> ID：14435377
> 
> 赞同：2
> 
> 时间：2013-01-21T09:07:25.740
> 
> 标签：javascript, regex

我有这个字符串：

```
<li><a class="amshopby-attr-selected" href="">1</a> (320)</li>
<li><a class="amshopby-attr" href="">2</a> (2)</li>
<li><a class="amshopby-attr" href="">3</a> (1)</li> 
```

我想用整个字符串（每一行）中的其他内容替换**a class="amshopby-attr-selected" href 。**我尝试使用`"<a class="amshopby-attr-selected" href"`as 正则表达式，但这只会找到并替换一次。我怎样才能一次全部更换？

谢谢！:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T09:13:16.777

您需要指定`g`修饰符以指示*全局*搜索。否则，正则表达式只会匹配一次。

```
var replaced = original.replace(/<a class="amshopby-attr-selected" href"/g, substitute); 
```

# php - 动态表中的动态表 (PHP/MySQL)

> ID：14435378
> 
> 赞同：0
> 
> 时间：2013-01-21T09:07:33.350
> 
> 标签：php, mysql, filter, dynamic-tables

1.  我在同一个数据库中有两个 MySQL 表，每个表都有数据。
2.  我有一个 PHP 结果页面，显示动态 PHP 表中第一个 MySQL 表的数据。
3.  第一个 MySQL 表中的一个字段是以逗号分隔的 ID 列表，这些 ID 与第二个 MySQL 表中的数据相关。
4.  我在第一个动态 PHP 表中有第二个嵌套/嵌入的动态 PHP 表，当行 ID 出现在第一个 MySQL 表的逗号分隔字段中时，它从第二个 MySQL 表中提取数据。（即第一个动态 PHP 表中的一个列包含第二个嵌套动态 PHP 表，其中包含来自第二个 MySQL 表的数据

请参阅下面的 PHP/HTML：

```
<?php
if (!function_exists("GetSQLValueString")) {
function GetSQLValueString($theValue, $theType, $theDefinedValue = "", $theNotDefinedValue = "") 
{
  if (PHP_VERSION < 6) {
    $theValue = get_magic_quotes_gpc() ? stripslashes($theValue) : $theValue;
  }

  $theValue = function_exists("mysql_real_escape_string") ? mysql_real_escape_string($theValue) : mysql_escape_string($theValue);

  switch ($theType) {
    case "text":
      $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL";
      break;    
    case "long":
    case "int":
      $theValue = ($theValue != "") ? intval($theValue) : "NULL";
      break;
    case "double":
      $theValue = ($theValue != "") ? doubleval($theValue) : "NULL";
      break;
    case "date":
      $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL";
      break;
    case "defined":
      $theValue = ($theValue != "") ? $theDefinedValue : $theNotDefinedValue;
      break;
  }
  return $theValue;
}
}

mysql_select_db($database_TravelSite, $TravelSite);
$query_Route = "SELECT * FROM SavedRoutes WHERE RouteCode = '".$_GET['rc']."'";
$Route = mysql_query($query_Route, $TravelSite) or die(mysql_error());
$row_Route = mysql_fetch_assoc($Route);
$totalRows_Route = mysql_num_rows($Route);
?>
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Untitled Document</title>
</head>

<body>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table border="0">
  <tr>
    <td>ID</td>
    <td>StartPoint</td>
    <td>StartPointLatLng</td>
    <td>EndPoint</td>
    <td>EndPointLatLng</td>
    <td>Waypoints</td>
    <td>Name</td>
    <td>Details</td>
    <td>RouteCode</td>
  </tr>
  <?php do { ?>
    <tr>
      <td><?php echo $row_Route['ID']; ?></td>
      <td><?php echo $row_Route['StartPoint']; ?></td>
      <td><?php echo $row_Route['StartPointLatLng']; ?></td>
      <td><?php echo $row_Route['EndPoint']; ?></td>
      <td><?php echo $row_Route['EndPointLatLng']; ?></td>
      <td><p><?php echo $row_Route['Waypoints']; ?></p>
    <?PHP  $string = $row_Route['Waypoints'];
$slashstring = stripslashes($string);
$trimstring = rtrim($slashstring, "', '");
mysql_select_db($database_TravelSite, $TravelSite);
?>
        <p>echo $trimstring = <?PHP echo $trimstring; ?></p>
        <table border="0">
          <tr>
            <td>id</td>
            <td>Lng</td>
            <td>Lat</td>
            <td>Name</td>
          </tr>
          <?php
          mysql_select_db($database_TravelSite, $TravelSite);
$query_Markers = "SELECT * FROM markers WHERE ID IN('".$trimstring."')";
$Markers = mysql_query($query_Markers, $TravelSite) or die(mysql_error());
$row_Markers = mysql_fetch_assoc($Markers);
$totalRows_Markers = mysql_num_rows($Markers);
           do { ?>
            <tr>
              <td><?php echo $row_Markers['id']; ?></td>
              <td><?php echo $row_Markers['Lng']; ?></td>
              <td><?php echo $row_Markers['Lat']; ?></td>
              <td><p>
                <select multiple name="waypoints" id="waypoints">
                  <?php
do {  
?>
                  <option selected value="<?php echo $row_Markers['Lat'] . ", " . $row_Markers['Lng']?>"><?php echo $row_Markers['Lat'] . ", " . $row_Markers['Lng']?></option>
                  <?php
} while ($row_Markers = mysql_fetch_assoc($Markers));
  $rows = mysql_num_rows($Markers);
  if($rows > 0) {
      mysql_data_seek($Markers, 0);
      $row_Markers = mysql_fetch_assoc($Markers);
  }
?>
                </select>
              </p>
                <p><?php echo $row_Markers['Name']; ?></p></td>
            </tr>
            <?php } while ($row_Markers = mysql_fetch_assoc($Markers)); ?>
        </table>
<p>&nbsp;</p></td>
      <td><?php echo $row_Route['Name']; ?></td>
      <td><?php echo $row_Route['Details']; ?></td>
      <td><?php echo $row_Route['RouteCode']; ?></td>
    </tr>
    <?php } while ($row_Route = mysql_fetch_assoc($Route)); ?>
</table>
</body>
</html>
<?php
mysql_free_result($Markers);

mysql_free_result($Route);
?> 
```

现在，当我运行该页面时，会发生以下情况：

*   如果嵌套表中只有一个项目（即第二个表中只有一个 ID 出现在第一个表的逗号分隔字段中），则它可以完美呈现。
*   但是，如果有多个（即逗号分隔字段中有多个 ID），则它将第一项呈现到无穷大（并使浏览器崩溃）。

我究竟做错了什么？显然，嵌套表不是做我想做的事情的正确方法！*n00b*但是什么是？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:16:30.247

更好的解决方案可能是为 Fav_foods 设置一个单独的表。就像是：

```
ID | UserID | FoodID
 1 |   1    |    2
 2 |   1    |    4
 3 |   1    |    5 
```

这就像：约翰最喜欢的食物是 ID 为 2、4、5 的食物......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:17:02.717

从第一个表中删除 fav_food 列，然后添加第三个表 - fav_food：

```
ID | fav_Food
1  | 2
1  | 4
1  | 5
1  | 12 
```

然后，使用 JOIN 选择所有 John 最喜欢的食物，并附上详细信息：

```
SELECT *
FROM `fav_food` JOIN `food`
ON `food`.`ID`=`fav_food`.`fav_food`
WHERE `fav_food`.`ID`=1 
```

（使用不同的查询来选择 John 的详细信息）

一般来说，正如您所说，当您可以使用带有 JOIN 的常规表时，嵌套表并不是最好的主意。

# android - 使用真实产品测试应用计费时避免真实账户收费

> ID：14435379
> 
> 赞同：1
> 
> 时间：2013-01-21T09:07:38.507
> 
> 标签：android, in-app-purchase, in-app-billing

我注意到我使用真实产品进行的应用内计费测试实际上是从我的真实银行账户中收取费用的。有没有办法避免这种情况？在发布我的游戏之前，我真的会测试我的 iab。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T06:00:47.773

这里有几个解决方案。

首先，您应该使用测试帐户。该过程记录在[http://developer.android.com/google/play/billing/billing_testing.html](http://developer.android.com/google/play/billing/billing_testing.html) - 此时页面的底部是您想要的。这些帐户可以购买未发布的 IAP 项目并且不会被收费。

其次，您可以进行测试，然后登录您的商家帐户并取消交易。由于这不是一个记录在案的选项，我怀疑它不受谷歌的鼓励，所以我只在我真的被困在某些事情上时才使用它。即使那样，我也很少使用它。

# jboss - 在 Jboss 4.3 上对 EJB 进行单元测试？

> ID：14435380
> 
> 赞同：0
> 
> 时间：2013-01-21T09:07:39.767
> 
> 标签：jboss, testng, jboss-arquillian

有没有类似的东西`Embedded Glassfish`，可以对 EJB 进行单元测试，对于`Jboss 4.3 AS`. 我用谷歌搜索并了解了一个工具`Arquillian`，后来发现它不支持 Jboss 4.3 容器[检查here](http://docs.jboss.org/arquillian/reference/snapshot/en-US/html_single/#d0e713)。是否有任何类似的开源工具可用于在 Jboss 4.3 上对 EJB 进行单元测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:29:34.980

首先，您问题中参考指南的网址“有点”过时了；请不要提及，因为支持的容器列表以及其他信息已过时。Arquillian 参考指南托管在[Confluence](https://docs.jboss.org/author/display/ARQ/Reference+Guide)中，其中维护[了支持的容器适配器列表。](https://docs.jboss.org/author/display/ARQ/Container+adapters)

[其次，正如JBoss 社区论坛](https://community.jboss.org/thread/196745)中的其他用户所报告的那样，您可能会在 JBoss AS 4.2 容器方面取得一些成功。没有可用于 4.x 的嵌入式容器，因为可嵌入式 EJB 容器源于 EJB 3.1/Java EE 6 规范。

# c# - 当需要更多功能时，应该将枚举重构为一个类吗？

> ID：14435382
> 
> 赞同：4
> 
> 时间：2013-01-21T09:07:53.030
> 
> 标签：c#, class-structure

此时我有以下代码。

```
internal enum Genders
{
  Male,
  Female,
  NotSure,
  Other
} 
```

我正在考虑添加一个额外的功能，以便我可以*foreach*所有值**并**基于它返回一个*字符串。*所以，我会按如下方式进行映射。

```
Male    -> "boy"
Female  -> "girl"
NotSure -> "oh-boy"
Other   -> "cow" 
```

我应该将*枚举*重构为一个类，还是建议仅将*ToString*值分配给不同的*枚举*状态？我用谷歌搜索了它，但没有看到任何代码示例，所以我不确定这样做是否可取。

也许最好创建一个辅助类并使用这样的方法？

```
private IEnumerable<String> GetGenders()
{
  yield return "boy";
  yield return "girl";
  yield return "oh-boy";
  yield return "cow";
} 
```

还是我只是让自己感到困惑，应该立即停止？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T09:14:43.240

考虑改为向 Enum 添加扩展。

例如，您可以这样做：

```
Gender.Male.Description (which would return string "boy") 
```

扩展看起来像这样：

```
 /// <summary>
    /// Defines an EnumExtensions type.
    /// </summary>
    public static class EnumExtensions
    {
        /// <summary>
        /// Gets the value from a DescriptionAttribute applied to the enum.
        /// </summary>
        /// <param name="value">Enum value.</param>
        /// <returns>DescriptionAttribute value, or null if no attribute is applied.</returns>
        public static string Description(this Enum value)
        {
            var type = value.GetType();
            var fieldInfo = type.GetField(value.ToString(CultureInfo.InvariantCulture));

            var descriptionAttributes = fieldInfo.GetCustomAttributes(typeof(DescriptionAttribute), false);

            return descriptionAttributes.Length > 0
                       ? ((DescriptionAttribute)descriptionAttributes[0]).Description
                       : null;
        } 
```

你的枚举看起来像这样：

```
public enum Gender
{
    [Description("boy")]
    Male,

    [Description("girl")]
    Female,

    [Description("oh-boy")]
    NotSure,

    [Description("cow")]
    Other
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:13:10.563

添加此类功能是合理的，但不一定按照您建议的方式。我会使用字典将枚举值映射到它们的翻译，并添加两种方法：

1.  一种在字典中查找单个枚举并为其返回（可能已本地化）字符串的方法。
2.  另一种方法将字典中的所有值作为 IEnumerable 返回。

我认为如果你想要一个枚举的所有字符串的列表，你很有可能还想查找一个特定的枚举。如果您需要这两种方法，您希望对枚举字符串列表有一个实现，以确保这两种方法不会不同步，并且（当然）您不会重复自己。

（我们必须将任何可以显示给用户的枚举映射到字符串，因为我们不能使用内置的 enum.ToString() 因为它是“程序员语言”，而且还没有本地化。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T09:24:18.283

好吧，这取决于您的个人喜好和应用程序的要求。枚举的一大优点是定义了一组有限的数值，即使编译器和开发环境都知道，并且用字符串集合替换它们可以否定这一点。如果您想在某个时候将枚举值存储在数据库字段中，这也可能很重要。

如果性能不是一个大问题，您可以装饰您的枚举以`DescriptionAttributes`将它们与字符串名称或您想要的任何其他元数据相关联：

```
internal enum Genders
{
  [Description("boy")]
  Male,
  [Description("girl")]
  Female,
  [Description("oh-boy")]
  NotSure,
  [Description("cow")]
  Other
} 
```

...然后根据需要使用反射检索描述。不是闪电般快速，但我经常使用将以 WPF 形式显示的标签来执行此操作，其中少数[`GetCustomAttributes()`](http://msdn.microsoft.com/en-us/library/dwc6ew1d.aspx)调用是我最不关心的性能问题。:)

如果您想花哨，这种方法的一个优点（与硬编码字符串相反）是您可以将描述与应用程序资源中包含的字符串联系起来（例如，您可以拥有不同语言的本地化版本） . 我相信微软在他们的一些库中采用了这种方法（或者我在想别的东西吗？）。当然，您可以通过调用`ToString()`枚举值来检索代码中定义的枚举成员的名称。

[`Enum.GetValues()`](http://msdn.microsoft.com/en-us/library/system.enum.getvalues.aspx)您还可以使用该方法枚举枚举的成员。所以真的，你可以用任何一种方式做你正在寻找的事情，这只是你是否值得让事情复杂化或保持简单的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-07T21:46:25.533

这取决于您需要实现的复杂程度。如果只是英文描述，您可以按照其他答案中的建议使用 DescriptionAttributes 。如果您需要支持多种语言，则必须使用本地化资源（在 .resx 文件或数据库中） - 例如参见[http://www.codeproject.com/Articles/19953/Localizing-NET-Enums](http://www.codeproject.com/Articles/19953/Localizing-NET-Enums)

然而，对于更复杂的场景，使用枚举是不够的。

> 枚举有几个问题：

*   与枚举相关的行为分散在应用程序中
*   新的枚举值需要霰弹枪手术
*   枚举不遵​​循开闭原则

（来自 [http://lostechies.com/jimmybogard/2008/08/12/enumeration-classes/](http://lostechies.com/jimmybogard/2008/08/12/enumeration-classes/)）

博文 [Enumeration classes](http://lostechies.com/jimmybogard/2008/08/12/enumeration-classes)描述了公共抽象类 Enumeration 以及如何从中创建派生类。

# javafx-2 - JavaFX 中的截锥体剔除

> ID：14435384
> 
> 赞同：0
> 
> 时间：2013-01-21T09:07:59.583
> 
> 标签：javafx-2, culling

我希望在我的 JavaFX 应用程序中实现一些 Frustum Culling，因为场景外可能有大量节点，但有一些鼠标事件（例如拖动）可能会将它们带回场景。JavaFX 框架中是否已经有一些方法，或者我必须自己实现它。我已经尝试实现一种裁剪方法，该方法可以删除场景之外的节点，但是在鼠标事件之后很难更新场景。

任何帮助将不胜感激谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-05T13:08:10.500

我的猜测是每个节点都附加了侦听器..因此您正在创建 (n ->) 侦听器...也许尝试创建一个在悬停时添加拖动侦听器/并在悬停退出时删除的方法..节点也未在屏幕上呈现也应该删除这样的听众。

也许将这些侦听器包装在 WeakListener 类中

只是我的想法...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T12:43:46.283

您是否需要永久完全删除节点或担心渲染？

场景外的节点根本**不**应该被渲染，这是由 JavaFX 处理的。

# c# - C#：带有单引号的字符串的正则表达式（并通过双引号进行转义）

> ID：14435390
> 
> 赞同：2
> 
> 时间：2013-01-21T09:08:27.843
> 
> 标签：c#, regex, string, escaping

我没有为我的问题找到正则表达式。总是有使用反斜杠转义的示例正则表达式。

但我需要通过加倍封闭字符来转义。

示例：'o''reilly'

结果：奥莱利

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T11:07:12.523

```
'(?:''|[^']*)*' 
```

将匹配可能包含双转义引号的引号分隔字符串。这就是你找到这些字符串的正则表达式。

**解释：**

```
'      # Match a single quote.
(?:    # Either match... (use (?> instead of (?: if you can)
 ''    # a doubled quote
|      # or
[^']*  # anything that's not a quote
)*     # any number of times.
'      # Match a single quote. 
```

现在要正确删除引号，您可以分两步完成：

一、搜索`(?<!')'(?!')`查找所有单引号；用任何东西代替它们。

**解释：**

```
(?<!') # Assert that the previous character (if present) isn't a quote
'      # Match a quote
(?!')  # Assert that the next character (if present) isn't a quote 
```

其次，搜索`''`并全部替换为`'`.

# mingw - MinGW-w64 在 Windows 7 中不起作用

> ID：14435392
> 
> 赞同：0
> 
> 时间：2013-01-21T09:08:29.513
> 
> 标签：mingw, fortran, mingw-w64

我想使用 MinGW-64 构建 64 位 fortran 程序。它在 Windows 8 中工作正常，但在 Windows 7 中不起作用（我需要工作）。错误是：gfortran：错误：CreateProcess：没有这样的文件或目录

我知道这个问题以前被问过很多次，但我真的找不到解决方案。如果有任何解决方案，请告诉我。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T15:53:44.957

如果它有帮助，我在 Windows 7 下使用 Rtools 安装的 gcc 工具链（[这里](http://cran.r-project.org/)）从来没有遇到过问题。它是用于为统计包 R 构建程序的编译器，但也可以编译独立程序。它具有 gcc、g++ 和 gfortran，以及 32 位和 64 位编译器。

# actionscript-3 - 修改保存在数组中的动态创建的对象

> ID：14435395
> 
> 赞同：0
> 
> 时间：2013-01-21T09:08:58.733
> 
> 标签：actionscript-3, actionscript

我有多个动态创建的图像，在某些情况下我想更改图像。我可以将它们保存在数组中，但是如何通过从数组中获取图像来更改图像（加载另一个图像）。假设我有一个数组：

```
var ImagesArray:Array = []; 
```

我向它推送**加载器**对象，并想要更改（加载新）ImagesArray[0] 或 ImagesArray[1] 的图像......比如：

```
var loaderNew:Loader = new Loader();
loaderNew = ImagesArray[i];
loaderNew.load(new URLRequest("../lib/NewImg.png")); 
```

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T06:52:12.463

如果你只想改变它的图像，你不需要创建新的加载器，这里是一个更新图像 url 的函数示例：

```
private function changeImageByIndex(i:int, url:String):void    
{
    var loader:Loader = ImagesArray[i] as Loader;
    if (!loader)
    {
        loader = new Loader();
        addChild(loader);       
        ImagesArray[i] = loader;
    }
    loader.load(new URLRequest(url));
} 
```

如果您有位图，请使用 loadBytes() 方法而不是 load()，这是示例：

```
var bitmap:Bitmap = new Bitmap(new BitmapData(100, 100, true, 0xff0000));
var encoder:JPEGEncoder = new JPEGEncoder();
loader.loadBytes(encoder.encode(bitmap.bitmapData)); 
```

# java - listFiles - c 驱动器的 NullPointerException

> ID：14435398
> 
> 赞同：0
> 
> 时间：2013-01-21T09:09:04.360
> 
> 标签：java, file-io

为了兼容性，我正在尝试将应用程序从 Java 7 降级到 Java 6。但是，使用 Jave 6 的 listFiles() 我在 Windows 机器上的 c 驱动器上得到 NullPointerException（并且 isHidden() 返回 true）。由于 Java 7 的 FileTreeWalker 运行良好，我认为这不是 Windows 问题，是吗？我使用[了这段](https://stackoverflow.com/a/2056326/1856663)代码：

```
public class Filewalker {

    public void walk( String path ) {

        File root = new File( path );
        File[] list = root.listFiles();

        for ( File f : list ) {
            if ( f.isDirectory() ) {
                walk( f.getAbsolutePath() );
                System.out.println( "Dir:" + f.getAbsoluteFile() );
            }
            else {
                System.out.println( "File:" + f.getAbsoluteFile() );
            }
        }
    }

    public static void main(String[] args) {
        Filewalker fw = new Filewalker();
        fw.walk("c:\\" );
    }
} 
```

鲍勃

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:14:59.067

试试[Apache Commons IO](http://commons.apache.org/io/)，他们可能会为您的案例提供跨 JDK 解决方案。

[更新]我运行了您的代码，并在检查了 JDK 文档后，`listFiles`为不表示目录的路径返回 null，现在查看代码，尽管您在递归调用之前检查当前文件是否是目录走，事实证明，在某些时候，一个目录被误认为是一个文件，这可能是由于 Windows 上的访问权限我不太清楚为什么！

一个让我认为它与权限有关的注释是，产生的目录`NullPointerException`是'C：\ Documents and Settings'，`listFiles`在这个路径上调用，返回null。

这种情况的临时解决方法是检查文件列表是否为空。

# node.js - 使用 npm 安装soap模块时出错

> ID：14435399
> 
> 赞同：0
> 
> 时间：2013-01-21T09:09:06.590
> 
> 标签：node.js, npm

嗨，我在尝试使用 npm 安装soap模块时收到以下错误。下面是错误

```
npm WARN node-expat@2.0.0 package.json: bugs['name'] should probably be bugs['url'] 
```

任何帮助如何进一步进行都会很有帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-12T12:19:15.210

正如 NPM 的消息中所述，这不是错误。这是一个警告，它告诉您尝试安装的软件包在该`bugs`字段中有错误的数据，这只是`package.json`文件中可用的各种字段之一。

一个相关问题：[npm WARN package.json: No repository field](https://stackoverflow.com/questions/16827858/npm-warn-package-json/16827990#16827990)

# c# - 信号量等待事件触发的窗口窗体

> ID：14435401
> 
> 赞同：0
> 
> 时间：2013-01-21T09:09:20.323
> 
> 标签：c#, winforms, events, deadlock, semaphore

我已经实现了一个缓冲区。缓冲区有读写两个属性。读取函数调用等待 read_slot 信号量可用。write 函数调用在 write_slot 上等待。write_slot 信号量安装到初始计数 100 和最大计数 100，而读取槽初始化为初始计数 0 和最大计数 100。

所以我触发了一个事件来写入缓冲区——>减少写入槽——>增加读取槽。该事件有时会非常快地触发。读操作减少 read_slot 并增加 write_slot。因此，这种架构不能面对死锁--> 因为只有当 read_slot 为 0 且 write_slot 为 0 时才会发生死锁......这是不可能的，因为在普通互斥锁中增加和减少了槽。

我仍然面临僵局。有没有人对事件触发系统的功能有任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:33:12.073

```
 The event is fired very fast sometimes. 
```

为什么不使用生产者消费者模式。显然，你不能不写就读（读操作应该在写操作之后进行）。[您可以通过BlockingCollections](http://www.codethinked.com/blockingcollection-and-iproducerconsumercollection)在 .Net 中轻松实现这一点。

# c# - File.Copy 访问被拒绝

> ID：14435405
> 
> 赞同：-2
> 
> 时间：2013-01-21T09:09:44.017
> 
> 标签：c#, file-io, copy, .net

我在从本地磁盘复制到闪存时遇到问题。该代码之前有效，但在我创建了另一个 foreach 循环并且我必须创建新对象之后，File.Copy 功能不再有效。在价值文件 | System.IO.File 有类似的值： Error_Access_Denied | 5、Error_Invalid参数| 87、GetFileExInfoStandard | 0。

编辑：locationUSB 显示闪存上的文件路径。(locationUSB == "D:\something.hex") 和 x._location == "C:\something_1.hex" 。

```
foreach (object item in this.dataGridView2.Rows)
{
    versionOnDisk = this.VersionInt(x._version);
    versionOnFlash = this.VersionInt(((DataGridViewRow)item).Cells[2].Value.ToString());

    if (versionOnFlash > versionOnDisk)
        forbidCopying = true;
    else
        locationUSB = _logicalDrive + ((DataGridViewRow)item).Cells["Filename"].Value.ToString();  // <-- location value (because of the foreach)

    if (!forbidCopying)
        File.Copy(x._location, locationUSB, true);   // <--
    else if (AllowDelete.Checked)
        File.Delete(locationUSB);
} 
```

编辑：如果我将位置更改为逻辑驱动器路径，其值为“D:\”，我会得到未处理的 DirectoryNotFoundException：找不到路径“D:\”的一部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:21:54.507

很可能在创建新文件之后，您没有关闭`FileStream`s. `FileStream`使用或者在块`myFile.Close();`内创建新文件关闭新创建文件的s。`using (var myFile = File.Create(myPath))`

# jquery - Jqgrid 多组搜索

> ID：14435407
> 
> 赞同：1
> 
> 时间：2013-01-21T09:09:51.177
> 
> 标签：jquery, jqgrid

我正在尝试了解多组的搜索功能：真的。我正在使用以下演示：

[http://www.ok-soft-gmbh.com/jqGrid/SearchingDialogAboveGrid.htm](http://www.ok-soft-gmbh.com/jqGrid/SearchingDialogAboveGrid.htm)

在这里，如果我给 client = test5 并且在子组 client = test6 中使用“或条件”，我期待两行。但是我没有要查看的记录。

请帮我理解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T11:21:55.020

您描述的问题是 jqGrid 中的一个错误。[我在这里](http://www.trirand.com/blog/?page_id=393/bugs/bug-in-local-searching/#p28113)发布了相应的错误报告。我会在相应的修复准备好后通知您。

作为一种解决方法，您可以修改`postData.filters`内部，`onSearch`以便搜索请求像

![在此处输入图像描述](../Images/61d37bb4e8f49b9bf5c968b4f3d67e0c.png)

将转换为另一个等效查询

![在此处输入图像描述](../Images/dadd4631830103e1e081c69c6ce4a554.png)

在[答案中](https://stackoverflow.com/a/9067628/315935)，[另一个](https://stackoverflow.com/a/8953934/315935)演示了如何在 jqGrid 应用过滤器`postData.filters` *之前修改过滤器。*

# vim - 有没有一种从 gvim 启动程序而不会失去焦点的好方法？

> ID：14435412
> 
> 赞同：3
> 
> 时间：2013-01-21T09:10:10.253
> 
> 标签：vim

Vim 具有执行程序的内置方式，即`:!start foo`适用于 Windows 和`:!bar &`Unix。但是，我遇到的问题是它们从 Vim 中窃取了焦点。我想启动我的构建和测试脚本，虽然它工作并在其命令窗口中显示输出，但不必手动切换回 GVim。

我想到了 3 种可能的解决方案：

*   使用 Auto-It/AutoHotkey 将焦点设置回 Gvim。不幸的是，这只适用于 Windows，而且很脆弱。
*   让另一个进程监视我的源代码，并让该进程在源代码更改时自动启动脚本。（另一个创建新窗口的进程不会窃取焦点）。这有点花哨，因为您需要推迟写入文件，直到您想要启动脚本，并且有时如果您想重新测试，即使源代码中没有任何更改，也会编写一个无用的更改。
*   使用客户端-服务器架构，Vim 通过套接字或类似的方式发送命令。这实际上是我的首选解决方案，如果有任何现有的跨平台方式来做到这一点。（不过，我宁愿不为此运行额外的 GVim 实例。）

那么有什么好的方法可以做到这一点呢？我已经尝试过[AsyncCommander](http://www.vim.org/scripts/script.php?script_id=3431)但不幸的是它也窃取了焦点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T09:30:25.540

当我不使用像`sbt`监视源代码并为我重新构建/重新测试这样的好构建系统时，我倾向于想出这样的技巧：

```
 :map <F9> :!touch and-go<CR><CR> 
```

这里点击`F9`更新文件。选择您喜欢的任何键绑定。（当然你也可以`imap`对 vim 的插入模式做同样的事情。）

然后只需要一个 shell 脚本来监视这个文件并执行构建/测试您的项目的命令。在 unix 上，我会这样做：

```
 while stat -c "%Y" and-go; do sleep 1; done | 
 stdbuf -i0 -o0 uniq -c | 
 while read l; do 
    echo build...;  # Your build/test execution commands here.
 done 
```

在单独的窗口中运行它会很整洁，因为您的 vim/gvim 窗口将始终保持其焦点，而您只需继续点击`F9`（或其他）并查看另一个窗口以查看您的构建情况。

如果您也打算编写 Windows 批处理脚本（或 powershell，我不知道）版本，那么您应该很高兴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T10:38:22.820

我认为这应该有效：

```
:silent! !cmd /c start /b dir 
```

此外，`start.exe`确实可以选择最小化而不是使用共享/后台控制台。

当然`dir`是要换了：）

# xslt - xsl:如果至少存在一个子节点

> ID：14435415
> 
> 赞同：15
> 
> 时间：2013-01-21T09:10:19.260
> 
> 标签：xslt, xpath

```
<node>
   <node1><node11/></node1>
   <node2/>
</node> 
```

我希望我的 XSLT 检查

```
<xsl:if test="If at least 1 child node exists">
  Only node1 can pass the if condition
</xsl:if> 
```

感谢您的回复。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-21T09:16:44.817

首先，请注意此处的术语。你的意思是“节点”还是“元素”。节点可以是元素、注释、文本或处理指令。

无论如何，如果您在这里确实是指元素，要检查至少存在一个子元素，您可以这样做（假设在这种情况下您位于**节点**元素上。

```
<xsl:if test="*"> 
```

您的评论表明只有“node1”可以通过 if 条件，因此要检查特定元素的存在，请执行此操作

```
<xsl:if test="node1"> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-21T09:16:46.210

在您正在测试的节点的上下文中，这应该可以测试节点是否具有子*元素*：

```
<xsl:if test="*">
  Only node1 can pass the if condition
</xsl:if> 
```

如果您实际上是指节点（包括文本节点），那么这将适用于包括文本节点：

```
<xsl:if test="node()">
  Only node1 can pass the if condition
</xsl:if> 
```

但`<node>`也会通过这个测试（`<node2>`不会）。我以为您只是在 's 子节点的上下文中说话`<node>`，但也许不是？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T09:23:16.363

匹配节点的表达式是真的，而不匹配任何东西的表达式是假的，所以：

```
<xsl:if test="node()">
   ...
</xsl:if> 
```

但是，您的问题和隐含条件“只有 node1 可以通过 if 条件”与示例不一致。两者`node`都有`node1`子节点，所以两者都会通过这个 if 条件。

要将其严格限制为`node1`，您必须确保模板上下文是适当的，或者检查有问题的节点不是 documentElement。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T20:55:16.807

问题的措辞尚不清楚，但我认为您只想处理自己有子节点的子节点（即当前节点的孙子节点）

```
<xsl:template match="node">
 do stuff for node
  <xsl:apply-templates select="*[*]"/>
</xsl:template> 
```

只会将模板应用于它，`node1`因为它有一个子节点，它不会将模板应用于`node2`.

# php - 无法使用 PHP Curl 建立 SSL 连接

> ID：14435417
> 
> 赞同：0
> 
> 时间：2013-01-21T09:10:29.977
> 
> 标签：php

我有一个用于连接 SSL 网站的 php 脚本。我两者都有`CURLOPT_SSL_VERIFYPEER`，并且openssl`CURLOPT_SSL_VERIFYHOST`的`FALSE` 版本是最新的。( `SSL Version OpenSSL/1.0.1c`)

当我向该 SSL 网站发送请求时，会产生以下错误：

`string 'error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol' (length=67)`

整天绞尽脑汁，还是解决不了。请帮忙！

===更新===

这是我的代码：

```
$ch = curl_init();
$options = array(
    CURLOPT_URL => 'https://www.example.com',
    CURLOPT_HEADER => 0,
    CURLOPT_RETURNTRANSFER => 1,
    CURLOPT_FOLLOWLOCATION => 1,
    CURLOPT_SSL_VERIFYPEER => false,
    CURLOPT_SSL_VERIFYHOST => false
);
curl_setopt_array($ch, $options);
$result = curl_exec($ch);
curl_close($ch); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-05-09T16:11:01.170

如果您尝试在同一服务器中调用文件，则可以使用以下代码块来满足您的要求：

```
ob_start();
require "b.php";
$result = ob_get_clean(); 
```

# dll - 如何在 Tridion 中获取当前登录用户的 tcmid？

> ID：14435420
> 
> 赞同：-2
> 
> 时间：2013-01-21T09:10:37.640
> 
> 标签：dll, event-handling, tridion, tridion-2011

```
 private void Subscribe()
    {
        EventSystem.Subscribe<User, LoadEventArgs>(GetInfo, EventPhases.Initiated);
    }

    public void GetInfo(User user, LoadEventArgs args, EventPhases phase)
    {
        TcmUri id = user.Id;

        string name = user.Title;
        Console.WriteLine(id.ToString());
        Console.WriteLine(name);

    } 
```

我编写了上面的代码并将程序集添加到 Tridion 服务器的配置文件中，但是在用户登录时没有控制台窗口出现

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T10:55:25.733

您最初订阅的事件是任何可识别对象及其任何操作的处理阶段，基本上会在 SDL Tridion CMS 中发生的每个事务上触发，因此它不会为您提供任何用户登录时间的指示（这基本上是一直发生的一切）。

用户登录后发生的第一件事可能是读取其用户信息和应用程序数据。因此，您应该尝试以下方式：

```
private void Subscribe()
{
    EventSystem.Subscribe<User, LoadEventArgs>(GetInfo, EventPhases.Initiated);
}

public void GetInfo(User user, LoadEventArgs args, EventPhases phase)
{
    TcmUri id = user.Id;
    string name = user.Title;
} 
```

但请记住，这也将由其他操作触发，例如查看历史记录、检查发布交易等等。我不知道您如何将此操作区分为用户登录的一部分，因为没有专门为此触发的事件。

您可能想检查是否可以`LoadEventArgs`在`ContextVariables`、或`EventStack`中找到特定于登录的任何内容。`FormerLoadState``LoadFlags`

## 编辑：

请注意，事件系统在 SDL Tridion 核心内运行，因此您不会从任何地方看到控制台窗口弹出。如果要记录信息，可以包含以下 using 语句：

```
using Tridion.Logging; 
```

添加对`Tridion.Logging.dll`您可以在`..\Tridion\bin\client`目录中找到的引用后。然后，您可以在代码中使用以下日志记录语句：

```
Logger.Write("message", "name", LoggingCategory.General, TraceEventType.Information); 
```

您可以在 Tridion 事件日志中找到它（前提是您也设置了日志级别以显示信息消息）。

但这里最好的选择可能是调试您的事件系统，这样您就可以在触发事件时直接检查您的对象。[在这里](http://yatb.mitza.net/2012/03/debugging-tridion-2011-event-system.html)，您可以找到一篇关于如何设置事件系统调试的不错的[博客文章。](http://yatb.mitza.net/2012/03/debugging-tridion-2011-event-system.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T12:51:54.983

如果要获取当前用户的 TCM URI，可以通过多种方式进行。

我会推荐其中之一：

1.  使用核心服务，调用`GetCurrentUser`并读取`Id`属性。
2.  使用 TOM.NET，读取`User.Id`当前`Session`.

在这种情况下，您似乎想要#2，因为您的代码位于事件系统中。

# model - EmberJS：模型未使用数据初始化（ember-data）

> ID：14435424
> 
> 赞同：1
> 
> 时间：2013-01-21T09:10:53.847
> 
> 标签：model, ember.js, ember-data

我正在尝试从后端加载一些 JSON 并启动一个模型。到目前为止，我想我得到了模型，但没有设置它的属性:(

这是我的测试代码：

```
window.App = Ember.Application.create();

App.Router.map(function() {
   this.resource('person', { path: '/people/:person_id' });
});

App.Adapter = DS.RESTAdapter.extend({
   namespace: '~user1/embertest'
});

App.Store = DS.Store.extend({
   revision: 11,
   adapter: App.Adapter,
});

var attr = DS.attr;
App.Person = DS.Model.extend({
   firstName: attr('string'),
   lastName: attr('string')
});

App.PersonRoute = Ember.Route.extend({
   model: function(params) {
      return App.Person.find(params) ;
   }
});

App.PersonController = Ember.Controller.extend({
   contentDidChange: function() {
      debugger ;
      console.info(this.get('content'));
   }.observes('content.isLoaded')
}) ; 
```

并且数据是从一个仅包含以下内容的 json 文件加载的：

```
{"persons": {"firstName": "Jeff","lastName": "Atwood"}} 
```

现在，使用 url localhost/~user/embertest.html#people/10 我看到数据被加载并且控制器方法**contentDidChange**被调用。但是当我这样做时

```
this.content.get("firstName") ; // or this.get("content").get("firstName") 
```

它返回“未定义”。这里出了什么问题？

最后，这是我的模板，它们位于：

```
<script type="text/x-handlebars" data-template-name="person">
    Person: {{content.firstName}}
</script>
<script type="text/x-handlebars" data-template-name="application">
    {{outlet}}
</script> 
```

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T12:23:49.650

我相信 JSON 是不正确的。

```
{"persons": {"firstName": "Jeff","lastName": "Atwood"}} 
```

执行 App.Person.find(params.person_id) 时，根元素应为“person”

```
{"person": {"firstName": "Jeff","lastName": "Atwood"}} 
```

我也不相信您需要 PersonRoute ，因为默认情况下路由应该执行：

```
App.PersonRoute = Ember.Route.extend({
  model: function(params) {
    return App.Person.find(params.person_id) ;
  }
}); 
```

当您的动态路径段中包含“*_id”时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:54:42.250

尝试删除 PersonRoute，默认模型挂钩应该没问题。我认为这里发生的是 App.Person.find(params) 发送 findQuery() 而不是 find(id)。

# ruby - 我可以使用 Mechanize 下载扩展名为 .docx 和 .xlsx,.txt 的文件吗？

> ID：14435425
> 
> 赞同：2
> 
> 时间：2013-01-21T09:10:55.083
> 
> 标签：ruby, mechanize, mechanize-ruby

我浏览了文档[Mechanize](http://rubydoc.info/gems/mechanize/Mechanize/PluggableParser)。以下仅供`.pdf`参考。

```
require 'mechanize'

agent = Mechanize.new
agent.pluggable_parser.pdf = Mechanize::FileSaver
agent.get 'http://example.com/foo.pdf' 
```

1.  *但是我也可以下载 .docx,.xlsx,.txt 文件吗？*
2.  *当文件下载完成时，它的默认目录是什么？我们也可以更改保存文件目录吗？*
3.  *下载时会选择哪个浏览器？我们也可以更改浏览器控件吗？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T10:03:09.280

1.  文件类型无关紧要；任何可以通过网络访问的文件都可以通过 mechanize 获得，它是一个与 Mechanize 进行自动化交互的工具。

2.  该文件将存储在程序运行的目录中。使用[Mechanize::Download](http://mechanize.rubyforge.org/Mechanize/Download.html)而不是`Mechanize::FileSaver`指定文件应下载到的位置。此处的示例代码：[https](https://stackoverflow.com/a/9105153/429758) ://stackoverflow.com/a/9105153/429758 （在文件名中指定完整路径）

3.  Mechanize 在下载时不使用浏览器。`For all intents and purposes, Mechanize acts like a web browser with no user interface`通过[http://ruby.about.com/od/tasks/a/The-Mechanize-2-0-Handbook.htm](http://ruby.about.com/od/tasks/a/The-Mechanize-2-0-Handbook.htm)

请查看 mechanize 文档上的[示例页面以](http://mechanize.rubyforge.org/EXAMPLES_rdoc.html)获取有关如何使用 mechanize 的更多示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T00:43:00.913

像这样保存文件可能更简单：

```
File.open('myfname.pdf', 'wb'){|f| f << agent.get('http://example.com/foo.pdf').body} 
```

# css - 将所有内容与页面底部对齐？

> ID：14435426
> 
> 赞同：3
> 
> 时间：2013-01-21T09:10:55.780
> 
> 标签：css

我正在尝试将 html 页面与浏览器窗口的底部对齐。这是我的方法：

```
<body>
  <div class="outer-wrapper">
  </div>
</body>

.outer-wrapper{
    min-height: 950px;
    width: 100%;
    position: absolute;
    bottom: 0;
} 
```

此解决方案的问题在于，当屏幕高度小于 950 像素时，外包装的顶部会在屏幕上方消失，并且不会添加滚动。主体和外包装都有背景图像。

这是一个示例，如您所见，红色框的顶部在主体上方。 [http://jsfiddle.net/C5Nce/1/](http://jsfiddle.net/C5Nce/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T06:58:04.930

如果我正确理解您想要的内容，则以下演示应该可以工作：

[http://jsfiddle.net/C5Nce/10/show/](http://jsfiddle.net/C5Nce/10/show/)

我只是使用媒体查询来检测页面何时小于 550px 并将元素设置为固定到顶部：

```
@media screen and (max-height: 550px) {
       .outer_wrapper {
           top: 0;
       }
} 
```

我把它涂成绿色，这样你就可以知道查询何时触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:20:08.973

我只想给你`outer-wrapper`100% 的高度（连同 html、body）：

```
html, body {
    height: 100%;
    padding: 0;
    margin: 0;
}

.outer-wrapper {
    height: 100%;
    width: 100%;
    position: absolute;
    bottom: 0;
    overflow-y: auto;
    background-position:bottom; //Edit
} 
```

然后`outer-wrapper`将永远保持身体的高度。不需要 950px 最小高度，因为如果视口太小，您希望它无法滚动，而在另一种情况下，视口大于 950px - 嗯，它大于 950px - 这是一件好事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T09:40:51.133

```
.outer {
    position:absolute;
    height:100%;
    width:100%;
    background-color:#aaaaaa;
    margin:0;
    padding:0;
}
.content {
    position:relative;
    width:90%;
    height:90%;
    background-color:#444444;
    margin:5%;
}
.inner {
    position:absolute;
    height:20%;
    width:100%;
    background-color:#eeeeee;
    bottom:0;
    margin-bottom:10%;
} 
```

* * *

```
<div class="outer">
    <div class="content">
        <div class="inner"></div>
    </div>
</div> 
```

* * *

[http://jsfiddle.net/L8H9J/](http://jsfiddle.net/L8H9J/)

1）从内部类中删除margin-bottom样式

2）你在内部类中添加的所有内容都将与底部对齐

3) 由于 HTML 中文档的流动，您不能明确地将它们与底部对齐

4）你可以使用这个技巧来做到这一点，但内部类中的所有元素都将再次流动`position:static`

5) 使用 JavaScript 为内部类中的每个元素确定合适的边距

**小费：** `Use percentages; although you want the wrapper to be of height ~950px, but if you can use percentages for the dimensions, you would really love watching your web applications scale with the browsers:`

![图像-1](../Images/ceafff17c5c8adf6904e9b02cf7e7216.png) ![图像-2](../Images/6c6e40de54ab5249e6b24e8312f81ebd.png)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-21T09:17:37.130

[在此处](http://jsbin.com/iqerup/2/edit)从您的代码中编辑部分

```
.outer_wrapper 
{
    background-color:red;
    /*min-height: 550px;*/
    margin-left: -75px; 
    top:auto;
    bottom: 0;
    position: absolute;
    left:50%;
} 
```

并且您正在指定您的**红色框在 body 上方**，如果您将它放在 body 内，它应该像它一样放置，因为您还指定`min-height`了容器。

# javascript - 动态加载的数据未触发更改事件

> ID：14435429
> 
> 赞同：0
> 
> 时间：2013-01-21T09:11:11.440
> 
> 标签：javascript, events

如果文本框的值发生更改，我会动态加载输入类型文本中的数据并触发警报。但是我的代码似乎不起作用。请提供建议。访问此页面获取代码：http: [//jsfiddle.net/NbGBj/103/](http://jsfiddle.net/NbGBj/103/)

```
I want the alert to be shown when the page is loaded 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:13:20.943

你应该移除你的`"`周围`document`

```
$("document").ready(function(){
... 
```

应该

```
$(document).ready(function(){
... 
```

或使用快捷方式

```
$(function(){
... 
```

来自官方文档：

> 以下所有三种语法都是等效的：
> 
> ```
> - $(document).ready(handler)
> - $().ready(handler) (this is not recommended)
> - $(handler) 
> ```

[http://api.jquery.com/ready/](http://api.jquery.com/ready/)

但我猜你想要的是`keyup`事件

```
$(function () {
    $("#upload").val("sample");
    $("#upload").keyup(function () {
        alert($(this).val());
    });
}); 
```

为了更好的可读性，您可以使用链接

```
$(function () {
    $("#upload").val("sample").keyup(function () {
        alert($(this).val());
    });
}); 
```

[http://jsfiddle.net/BXNkq/](http://jsfiddle.net/BXNkq/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:23:03.753

在文本框中设置值后，您可以直接触发更改功能，如下所示：

```
....
$("#upload").val("sample");
$("#upload").change();
.... 
```

# jquery - 使用 Gridster 处理点击事件

> ID：14435434
> 
> 赞同：0
> 
> 时间：2013-01-21T09:11:47.040
> 
> 标签：jquery, gridster

使用[Gridster](http://gridster.net/)，我可以在开始和停止拖动时绑定事件。但是如何将事件绑定到单击项目？我需要能够选择一个项目才能将其删除，或为其设置一些属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T15:15:03.040

您可以使用 jquery 单击事件来绑定单击元素。[这是一个相同的例子。](http://jsfiddle.net/paDE7/11/)以下是绑定的一般布局。

```
 $('.layout_block').click(function () {
                //function to set some properties using $(this)
                //setting an identifier to remove the element
       } 
```

这`layout_block`是gridster所有元素的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-22T17:06:44.677

`javascript $(document).on("click", ".layout_block", handler);`

为我工作，即使是添加了`gridster.add_widget();`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-10T14:09:03.970

我有这个工作代码。

```
$(".gridster ul li button.close").click(function () {
        gridster.remove_widget($(this).parent());
}); 
```

所以在我的 Li 元素中，我有一个`class=close`用于检测点击事件的按钮，我调用小部件方法`gridster.remove_widget`并传递 html 元素以将其删除。

快乐编码:)

# twitter-bootstrap - 如何在点击时显示引导子菜单？

> ID：14435437
> 
> 赞同：2
> 
> 时间：2013-01-21T09:12:41.190
> 
> 标签：twitter-bootstrap, submenu

基本上，我想在点击时显示一个“子菜单”，当用户点击一个菜单时，相应的子菜单将显示，而不是通过引导程序设置为默认值的“悬停”。

引导演示[http://twitter.github.com/bootstrap/components.html#dropdowns](http://twitter.github.com/bootstrap/components.html#dropdowns)（滚动到下拉菜单上的子菜单）

有任何想法吗？

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2013-02-20T18:35:56.030

我正在看完全相同的东西，目前看来这是不可能的。我们应该留意未来可能的修正。

# regex - 使用 reg exp 提取

> ID：14435438
> 
> 赞同：0
> 
> 时间：2013-01-21T09:12:42.530
> 
> 标签：regex, sed, uri

我有相当数量的图像搜索结果，我想将其转换为相当数量的实际图像。

所有结果都是单个图像的 HTML 页面，每个文件都包含子字符串

> <title>Google-Ergebnis für [uri]</title>

其中 [uri] 表示实际结果图像的绝对 URI (http://...(.gif|.jpg|.jpeg|.bmp))。

但我不明白如何提取 uri 以将其交给 wget。

> 猫imgres.html | grep "<标题>" | sed 's/<title>Google-Ergebnis für http://(.*)</title>/\\1/'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:42:05.700

grep 在这种情况下应该有所帮助：

```
....grep "<title>"|grep -Po "(?<=Google-Ergebnis für )[^<]*" 
```

测试

```
kent$ echo "<title>Google-Ergebnis für http://foo.bar.baz/blah.png</title>"|grep -Po "(?<=Google-Ergebnis für )[^<]*"
http://foo.bar.baz/blah.png 
```

**请注意** ，实际上，您可以将两个 grep 合二为一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T14:48:05.153

您已接近 sed 命令：

```
 sed -n 's#<title>Google-Ergebnis für \(http://.*\)</title>#\1#p' imgres.html 
```

不过，不需要 cat、grep 和多个管道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T09:37:08.193

这个怎么样？我假设您的问题是您如何将从 grep/sed 中提取的内容传递给`wget`.

```
cat imgres.html | grep "<title>" | 
  sed 's#<title>Google-Ergebnis für \(http://.*\)</title>#\1#' |
wget -i - 
```

稍微紧凑一点：

```
sed -n '/<title>/{s#.*<title>Google-Ergebnis für \(http://.*\)</title>.*#\1#;p}' imgres.html | 
  wget -i - 
```

请注意使用`#`ins 代替通常`/`作为 . 的分隔符`s`。

# php - MySQL 错误行 1 [插入]

> ID：14435448
> 
> 赞同：1
> 
> 时间：2013-01-21T09:13:28.380
> 
> 标签：php, mysql

嗨，我收到了这个错误，这是我的查询

```
insert into `products` (original_id,name,image_url,buy_url,short_description,long_description,sale_price,retail_price,brand,keyword,category_name,store_name,provider_name) values (5068122-EC1155705-5.5M,Eastland Plainview Shoes (Black) - Women's Shoes - 5.5 M,http://www.shoes.com/productimages/shoes_iaec1155705.jpg,http://gan.doubleclick.net/gan_click?lid=41000000025255752&pid=5068122-EC1155705-5.5M&adurl=http%3A%2F%2Fwww.shoes.com%2FShopping%2Fproductdetails.aspx%3Fcatalog%255Fname%3Dweb%26pg%3D5068122%26p%3DEC1155705&usg=AFHzDLv0Y4C7BN1pbi4RzmWWTgLx7J7uBw&pubid=21000000000526055,Eastland keeps it timeless and classy with these smart and sturdy Plainview oxfords. Soft full grain leather upper in a casual oxford style with a round plain toe. Contouring double stitching and an Eastland side logo tag add classic detail. Five eyelet g,Eastland keeps it timeless and classy with these smart and sturdy Plainview oxfords. Soft full grain leather upper in a casual oxford style with a round plain toe. Contouring double stitching and an Eastland side logo tag add classic detail. Five eyelet grommeted lacing and a smooth leather padded collar and tongue create a comfortable customizable fit. Textile lining and cushioning footbed flexible stitched midsole. Durable polyurethane traction outsole with a sturdy 1 1/4 inch heel.,77.00,77.00,Eastland,Eastland Plainview Shoes (Black) - Women's Shoes - 5.5 M Womens|Casual Eastland US adult Black female  Apparel & Accessories > Shoes   5.5 M,Apparel & Accessories > Shoes,Eastland,gan) 
```

> 在线：127 File C:\web\filesearch\index.php 你的SQL语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“M,Eastland Plainview Shoes (Black) - Women's Shoes - 5.5 M,http://www.shoes.com/”附近使用正确的语法

那有什么问题？

line line: 127 是这个

```
 mysql_query($query) or die($query . "<br />On line: " . __LINE__ . " File " . __FILE__ . " " . mysql_error()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:15:33.343

将您的字符串值包含在 Quotes 中以进行查询。您有大字符串，但它们周围没有引号，这就是错误。例如`5068122-EC1155705-5.5M`应该是`"5068122-EC1155705-5.5M"`或`'5068122-EC1155705-5.5M'`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:20:00.700

还使用 mysql_escape_string 将它们括在引号中后插入的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T09:57:29.733

让我看看代码。我很快就会想出一些东西

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T06:47:53.813

请使用您的新查询更新帖子。如果您已使用 QUOTES 正确更新了查询，则下一个问题可能是数据类型不匹配或字符串与定义的列之间的长度不匹配。

# php - 嵌入位于 webroot 之外的 flv 和 swf

> ID：14435451
> 
> 赞同：3
> 
> 时间：2013-01-21T09:13:35.873
> 
> 标签：php, object, video, http-headers, embed

我有一个在 webroot 之外上传的脚本。然后通过网站将用户链接到图像文档等。

因此，对于图像，链接将是：

```
media.php?file=nameoffile.jpg&user=userid&folder=images 
```

然后用于显示图像：

```
<img src="media.php?file=nameoffile.jpg&user=userid&folder=images" width="100" border="0"> 
```

这适用于图像并提供下载文档的链接。

我面临的问题是嵌入，我使用 ffmpeg 将所有允许的视频类型转换为 flv（这些视频经过测试并且效果很好），但是当我尝试嵌入 flv 视频时它永远不会起作用（它适用于文件的直接链接只是不通过 media.php）。如果可能的话，我还想嵌入 .swf。

我正在使用 jwplayer 嵌入（与文件的直接链接一起使用，而不是通过 media.php）

```
 <!-- START OF THE PLAYER EMBEDDING TO COPY-PASTE --> 
            <object id="player" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" name="player" width="328" height="200"> 
            <param name="movie" value="player.swf" /> 
            <param name="allowfullscreen" value="true" /> 
            <param name="allowscriptaccess" value="always" /> 
            <param name="flashvars" value="media.php?file=nameoffile.flv&user=userid&folder=videos" /> 
            <embed 
                type="application/x-shockwave-flash"
                id="player2"
                name="player2"
                src="player.swf"
                width="328" 
                height="200"
                allowscriptaccess="always" 
                allowfullscreen="true"
                flashvars="file=media.php?file=nameoffile.flv&user=userid&folder=videos"
            /> 
            </object> 
            <script type="text/javascript" src="jwplayer.js"></script>
            <!-- END OF THE PLAYER EMBEDDING --> 
```

**这是media.php：**

```
 $path_parts = pathinfo($_SERVER['REQUEST_URI']);
        $file = basename(urldecode($_GET['file']));
        $user = basename(urldecode($_GET['user']));
        $folder = basename(urldecode($_GET['folder']));
        $ext = pathinfo($file, PATHINFO_EXTENSION);

        $fileDir = 'pathoutsidewebroot';
        $filePath = $fileDir . $file;

        switch(
        $ext) {
            case "flv": $ctype="video/x-flv"; break;
            // adobe
            case "pdf": $ctype="application/pdf"; break;
            // ms office
            case "doc": $ctype="application/msword"; break;
            case "rtf": $ctype="application/rtf"; break;
            case "xls": $ctype="application/vnd.ms-excel"; break;
            case "ppt": $ctype="application/vnd.ms-powerpoint"; break;
            // open office
            case "odt": $ctype="application/vnd.oasis.opendocument.text"; break;
            case "ods": $ctype="application/vnd.oasis.opendocument.spreadsheet"; break;
            default: $ctype = "application/force-download"; break; 
}

        if(in_array($ext, $valid_formats_vid)){
            if (file_exists($filePath)) {
                header('Content-Type: ' . mime_content_type($filePath));
                header('Content-Length: ' . filesize($filePath));
                readfile($filePath);
        }
        }

        else if(in_array($ext, $valid_formats_img)) {
            if (file_exists($filePath)) {
                header('Content-Type: ' . mime_content_type($filePath));
                header('Content-Length: ' . filesize($filePath));
                readfile($filePath);
            }
        }
        else if(in_array($ext, $valid_formats_docs)) {
                    if (file_exists($filePath))
                    {
            header("Pragma: public");
            header("Expires: 0");
            header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
            header("Cache-Control: private",false);
            header("Content-Type: $ctype");
            header("Content-Disposition: attachment; filename=\"".basename($filePath)."\";");
            header("Content-Transfer-Encoding: binary");
            header("Content-Length: ".@filesize($filePath));
            set_time_limit(0);
            @readfile($filePath) or die("File not found.");                 }
        } 
```

**通过 media.php 嵌入的标头**

```
Cache-Control:no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Connection:Keep-Alive
Content-Disposition:filename=encoded_2012-10-19_22.37.09_1359032866.flv
Content-Length:0
Content-Type:video/x-flv
Date:Thu, 24 Jan 2013 16:26:32 GMT
Expires:Thu, 19 Nov 1981 08:52:00 GMT
Keep-Alive:timeout=5, max=88
Pragma:no-cache
Server:Apache/2.2.20 (Ubuntu)
X-Powered-By:PHP/5.3.6-13ubuntu3.8 
```

**从直接链接到文件的标题（有效的）**

```
Accept-Ranges:bytes
Connection:Keep-Alive
Content-Length:2428614
Content-Type:video/x-flv
Date:Thu, 24 Jan 2013 16:23:54 GMT
ETag:"26ca3d8-250ec6-4d4087c796500"
Keep-Alive:timeout=5, max=100
Last-Modified:Thu, 24 Jan 2013 13:07:00 GMT
Server:Apache/2.2.20 (Ubuntu) 
```

**设法通过 media.php 将其更改为此（但仍然无法正常工作）**

```
 header("Content-Type: $ctype");
            header('Content-Length: ' . filesize($filePath));
            header('Accept-Ranges: bytes');
            $now = time( );
            $then = gmstrftime("%a, %d %b %Y %H:%M:%S GMT", $now + 365*86440);
            header("Expires: $then");
            ob_clean();
            flush();
            readfile($filePath);

Accept-Ranges:bytes
Cache-Control:no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Connection:Keep-Alive
Content-Length:2428614
Content-Type:video/x-flv
Date:Thu, 24 Jan 2013 16:44:18 GMT
Expires:Fri, 24 Jan 2014 20:47:38 GMT
Keep-Alive:timeout=5, max=79
Pragma:no-cache
Server:Apache/2.2.20 (Ubuntu)
X-Powered-By:PHP/5.3.6-13ubuntu3.8 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T13:17:04.063

问题在这里：

```
flashvars="file=media.php?file=nameoffile.flv&user=userid&folder=videos" 
```

`flashvars`接收一个查询字符串，所以这被解释为

```
file   : media.php?file=nameoffile.flv
user   : userid
folder : videos 
```

您需要对文件参数进行urlencode：

```
flashvars="file=media.php?file=nameoffile.flv&amp;user=userid&amp;folder=videos" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T09:03:05.883

我设法让它与以下内容一起工作，我还为播放器添加了一个拇指图像（这是通过 ffmpeg 上传的）：

```
header("Content-Type: $ctype");
header('Content-Length: ' . filesize($filePath));
header('Accept-Ranges: bytes');
$now = time( );
$then = gmstrftime("%a, %d %b %Y %H:%M:%S GMT", $now + 365*86440);
header("Expires: $then");
ob_clean();
flush();
readfile($filePath);

$flv_path = 'media.php?file='.$row['cur_image'].'&folder=videos&user='.$row["posted_by"];

$thumb = pathinfo($row['cur_image']);
$thumb_path = 'media.php?file='.$thumb['filename'].'.jpg&folder=videos&user='.$row["posted_by"];
?>           

<!-- START OF THE PLAYER EMBEDDING TO COPY-PASTE -->
<div id="mediaplayer_<?php echo $row['p_id']; ?>">JW Player goes here</div>                           
<script type="text/javascript">
                        jwplayer("mediaplayer_<?php echo $row['p_id']; ?>").setup({
                            flashplayer: "jwplayer/jwplayer.flash.swf",
                            file: "<?php echo $flv_path; ?>",
                            image: "<?php echo $thumb_path; ?>",
                            controlbar: "bottom",
                            width: "380",
                            height: "200",
                            primary: "flash",
                            type: "mp4",
                            controls: true,
                            allowscriptaccess: 'always'
                        });
</script>
<!-- END OF THE PLAYER EMBEDDING --> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T19:54:55.720

其中一种文件读取方法应该有效，请查看此链接：[http ://www.ibm.com/developerworks/library/os-php-readfiles/](http://www.ibm.com/developerworks/library/os-php-readfiles/)

改变你的代码，这一行： readfile($filePath); 使用其他文件读取功能，我认为流式传输也应该与（PHP fread）一起使用

PHP 手册： fread ：提供有用的信息，也请尝试使用第一个用户注释。 [http://php.net/manual/en/function.fread.php](http://php.net/manual/en/function.fread.php)

# php - 在正则表达式中转义\而不转义组

> ID：14435453
> 
> 赞同：1
> 
> 时间：2013-01-21T09:13:37.277
> 
> 标签：php, regex

但是，星期一，我如何获得一个正则表达式来替换所有`\`没有`"`之后的表达式？

我努力了：

```
$toBeCleaned = preg_replace('/\\(?!")/',"\\\\",$toBeCleaned); 
```

这当然是说：

```
preg_replace(): Compilation failed: unmatched parentheses at offset 5 
```

事情是我可以让它工作： http: [//www.solmetra.com/scripts/regex/index.php](http://www.solmetra.com/scripts/regex/index.php)就好了。

但是我将其修改为：

```
$toBeCleaned = preg_replace('/\\\(?!")/',"\\\\",$toBeCleaned); 
```

这不会出错，但同时，当然由于转义完成，它不起作用。

周一早上我似乎无法理解为什么我不能让它完成它的工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:20:21.933

这是一个表达式，它将替换所有后面没有 " 的反斜杠。

```
$toBeCleaned = preg_replace('/\\\[^"]/', 'SLASH', $toBeCleaned); 
```

但是，问题是，您要完成什么？也许有更好的方法，正则表达式并不总是答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:28:10.110

通过实际使用单词替换文本运行@hank 的正则表达式后，我发现我的正则表达式工作得非常好，只是没有正确替换。所以我把它改成：

```
$toBeCleaned = preg_replace('/\\\(?!")/',"\\\\\\",$toBeCleaned); 
```

这确实有效。

我也接受这个答案，因为使用本页提到的否定字符类可能会出现问题：[http ://www.regular-expressions.info/charclass.html](http://www.regular-expressions.info/charclass.html)

我讨厌星期一。

# sql - SQL 仅使用内部联接将行转换为字符串

> ID：14435457
> 
> 赞同：0
> 
> 时间：2013-01-21T09:13:56.583
> 
> 标签：sql, sql-server-2008, inner-join

> **可能重复：**
> [从视图中删除子查询以使其成为索引视图](https://stackoverflow.com/questions/14434865/remove-subquery-from-view-to-make-it-indexed-view)

我有三张桌子

1) 列表

```
ID          Title                                                                                                                                                                                                    
----------------------
27          KFC Chiken                                                                                                                                                                                               
28          Manish Wowly                                                                                                                                                                                             
29          BB                                                                                                                                                                                                       
30          Woderla                                                                                                                                                                                                  
31          funny                                                                                                                                                                                                    
32          Demo123                                                                                                                                                                                                  
33          final                                                                                                                                                                                                    
34          Demo Works                                                                                                                                                                                               
35          real                                                                                                                                                                                                     
36          listing123 
```

2) 成分

```
ID          Name                                                                                                                                                                                                     
----------------------
33          Chiken                                                                                                                                                                                                   
34          Rice 
```

3) 列出成分

```
ID          IngredientId ListingId   IsMainIngredient
----------- ------------ ----------- ----------------
3           33           33          1
4           33           34          1
5           33           35          1
6           33           36          1
7           33           37          1
8           34           33          1
9           33           27          1
10          34           27          1 
```

我，我正在寻找类似于不使用子查询而只使用内连接的输出，因为我想从这个查询中创建一个索引视图

```
 ID          title                   Ingredients                                                                                                                                                                                 
----------- ---------------------------------------
27          KFC Chiken              Chiken,Rice                                                                                                                                                                                 
33          final                   Chiken,Rice                                                                                                                                                                                 
34          Demo Works              Chiken                                                                                                                                                                                 
35          real                    Chiken                                                                                                                                                                                 
36          listing123              Chiken                                                                                                                                                                                 
37          Working Chiken          Chiken 
```

# java - 如何使用 Pattern 和 Matcher 获取所有找到的组

> ID：14435459
> 
> 赞同：4
> 
> 时间：2013-01-21T09:13:58.323
> 
> 标签：java, regex

我有以下正则表达式模式：`^(\d+)(;(\d+))*$`. 我想获得该正则表达式中组的数量以及每个组的值。

我尝试使用 groupCount 和 group 但我得到以下结果：

```
Input: "1"
Groups: 3
"1", "1", null, null 
Input: "1;2"
Groups: 3
"1;2", "1", ";2", "2"
Input: "1;2;3"
Groups: 3
"1;2;3", "1", ";3", "3"
Input: "1;2;3;4"
Groups: 3
"1;2;3;4", "1", ";4", "4" 
```

我期待第一个`"1"`从 groupCount 获得 1。在最后一个的情况下`"1;2;3;4"`，我期望从 groupCount 中得到 7。

Matcher 上是否有任何方法可以返回我所期望的？

编辑：添加了生成上述输出的代码

```
String input = "1";
Pattern pattern = Pattern.compile("^(\\d+)(;(\\d+))*$");
for (int i = 2; i < 6; ++i) {
    Matcher matcher = pattern.matcher(input);
    matcher.matches();
    System.out.println("Input: \"" + input + "\"\nGroups: " + matcher.groupCount());
    for (int group = 0; group <= matcher.groupCount(); ++group) {
        System.out.print("\"" + matcher.group(group) + "\", ");
    }
    System.out.println();
    input += ";" + i;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T09:31:34.690

很抱歉，您对群组有误解。

您使用正则表达式定义组数。它不依赖于字符串。在您的正则表达式中，您定义了 3 个组：

```
 ^(\\d+)(;(\\d+))*$
  1     2 3 
```

组由左括号编号。所以你的正则表达式总是有 3 个组。如果他们匹配的东西是完全不同的东西。

因此，在第一组中总会有第一个找到的数字。对于其他两组，您正在做一些特别的事情：您正在**[重复捕获组](http://www.regular-expressions.info/captureall.html)**。

由于您匹配的以下数字都存储在第 3 组中，因此您只会在最终结果中找到最后一个。在 .net 中，您可以读出所有匹配项，但我认为在 Java 中不可能。

**解决方案：**

使用正则表达式验证字符串

```
^\\d+(;\\d+)*$ 
```

如果格式正确，则通过在“;”上进行拆分来获取数字

# php - 如何使用 Javascript 定位我的 PHP 联系表单警报消息？

> ID：14435462
> 
> 赞同：0
> 
> 时间：2013-01-21T09:14:14.683
> 
> 标签：php, javascript, css, html

定位警报消息时遇到问题（您需要填写所有必填字段！！等）无法通​​过 CSS 完成，因为元素没有任何位置可以从中获取位置。

有任何想法吗？

```
 <!DOCTYPE html>
<html lang="en-US">
    <head>
    <meta charset="utf8" />

        <link rel="stylesheet" type="text/css" media="all" href="css/mainstyle.css"/>

        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script src="js/everypage.js"></script>

        <meta name="viewport" content="initial-scale=1" />
        <link rel="shortcut icon" href="IMG/tabicon/favicon.ico" >
        <title> A band </title>

<?php
        $name = $_POST['name'];
        $email = $_POST['email'];
        $message = $_POST['message'];
        $from = 'From: Website'; 
        $to = 'info@example.com'; 
        $subject = 'Hello';
        $human = $_POST['human'];

        $body = "From: $name\n E-Mail: $email\n Message:\n $message";

        if ($_POST['submit']) {
        if ($name != '' && $email != '') {
            if ($human == '4') {                 
                if (mail ($to, $subject, $body, $from)) { 
                echo '<p class="alert">Your message has been sent!</p>';
            } else { 
                echo '<p class="alert">Something went wrong, go back and try again!</p>'; 
            } 
        } else if ($_POST['submit'] && $human != '4') {
            echo '<p class="alert">You answered the anti-spam question incorrectly!</p>';
        }
        } else {
            echo '<p class="alert">You need to fill in all required fields!!</p>';
        }
    }
    ?>

    </head>
    <body>
    <div id="background">
        <div id="wrapper">

            <div class="navigation">
                <ul id="mainmenu">
                    <li><a href="index.html">Home</a></li>  
                    <li><a href="band.html">Band</a></li>
                    <li><a href="news.html">News</a></li>
                    <li><a href="shows.html">Shows</a></li>
                    <li><a href="music.html">Music</a></li>
                    <li><a href="gallery.html">Gallery</a></li>
                    <li><a href="media.html">Media</a></li>
                    <li><a href="store.html">Store</a></li>                         
                </ul>
            </div>
            <div class="article">
                <div id="logo"></div>
                <div class="contacts">
                        <h1> Contact, booking:</h1>
                        <p> info@example.com </p>
                        <p> Tel: +372 58 131 054</p>
                </div>    

              <form method="post" action="contact.php">

                    <label>Name</label>
                    <input name="name" placeholder="Type Here">

                    <label>Email</label>
                    <input name="email" type="email" placeholder="Type Here">

                    <label>Message</label>
                    <textarea name="message" placeholder="Type Here"></textarea>

                    <input id="submit" name="submit" type="submit" value="Submit">

                    <label>*What is 2+2? (Anti-spam)</label>
                    <input name="human" placeholder="Type Here">   

            </form>

            </div>                     
            </div>

                <div class="footer contactfooter">
                    <p class="bandmembers">content</p>
                    <p class="signature">content</p>

                        <ul id="footermenu">
                            <li><a href="terms.html">Terms of use</a></li>
                            <li><a href="privacy.html">Privacy Policy</a></li>
                            <li><a href="contact.php">Contact</a></li>
                       </ul>

                </div>
          </div> 
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:24:42.743

您可以通过输入相关输入并使用（到包装器元素）定位消息元素来定位警报`<p>`标签。`wrap``position:relative`

所以在你的 JavaScript 验证中：

1.  确定哪个表单元素应该是放置消息的提示。
2.  包装表单元素。
3.  将警报附加到包装器。

该类`validationWrapper`应避免向目标元素添加填充/边距。它应该只是放置`alert`-classed 元素的起点。

以下代码使用了 jQuery JavaScript 库：

```
$(formElem).wrap("<div class=\"validationWrapper\"></div>");
$(".validationWrapper").append("<p class=\"alert\">"+message+"</p>");
$(".validationWrapper .alert").css({ position: "relative", left: 0, top: "-5em"}); 
```

此外，~~您的表单很容易受到垃圾邮件发送者的攻击。标`To`头应设置在服务器端。~~没关系，没有注意到 PHP 标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:50:31.157

对于您的问题，我建议您使用 jquery 进行验证和显示消息。这不仅可以帮助您将消息定位在您想要的位置，还可以为您提供设置消息样式的选项。[使用此链接以获得更好的理解](http://yensdesign.com/2009/01/how-validate-forms-both-sides-using-php-jquery/)

# android - android应用开发多种屏幕尺寸

> ID：14435464
> 
> 赞同：1
> 
> 时间：2013-01-21T09:14:24.617
> 
> 标签：android, size, screen

我们正在开发一个安卓应用程序。实际上我们是 iPhone 开发者。与 iOS 开发相比，我们在 android 开发过程中面临的一个挑战是，android 应用程序将要使用的设备种类繁多。从链接[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)我们得到了一些有用的信息。

1）但我们认为我们需要的测试工作量超过了安卓系统中基于屏幕尺寸的iOS。有人可以建议我们为 android 设备进行各种大小的设备测试的方法吗？

2) 或者至少我们可以通知我们的客户我们将仅在此类设备中进行测试。但我们的观点是，我们怎么能这么说，比如三星 S2、三星 Galaxy Note 等设备名称或 640X480 尺寸、320X240 尺寸等设备？请告知我们。

3) 我们对小、正常、大、xlarge 和 ldpi、mdpi、hdpi、xhdpi 的图像有任何尺寸规格吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T07:21:32.577

为多屏开发，首先确保 AndroidManifest.xml 指定了正确的目标 SDK。对于 android 2.2，目标 SDK 级别为 8。要进行处理，它至少需要 SDK 级别 7 才能运行。

```
<user-sdk android:minSdkversion="7" android:targetSdkversion="8"></user-sdk> 
```

使用这个`<user-sdk>`元素，这样平台就会认为你的android应用是2.2的，否则就认为它是Android 1.5的。

**“normal-hdpi”屏幕的显示指标值为**

```
DisplayMetrics{density=1.5, width=854, height=480, scaledDensity=1.5, xdpi=240.0, ydpi=240.0} 
```

**对于尺寸分类，请使用此配置类**

```
Configuration config = getResources().getConfiguration();
int size = config.screenLayout & config.SCREENLAYOUT_SIZE_MASK;
if (size == config.SCREENLAYOUT_SIZE_SMALL)
{     
  // use special layout for small screens 
} 
```

希望此解决方案对您有用。

# ios - 过滤器滑块的推荐 [iOS]

> ID：14435465
> 
> 赞同：0
> 
> 时间：2013-01-21T09:14:24.963
> 
> 标签：ios, uislider

我想实现这样的目标：

![在此处输入图像描述](../Images/21f40264d8e3b8f55fc3d1e9fc2a1f45.png)

此图像来自[此](https://itunes.apple.com/us/app/national-parks-by-national/id518426085?mt=8)应用程序。

我的问题是，我是否应该依赖这样的东西[，](https://github.com/ShadyElyaski/ios-filter-control)自己做，或者即使有其他一些我不知道的 3rd parary 库，也可以推荐。

我试图获得更多的意见，而不是实际的技术问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:19:03.283

我的建议是：

1.  使用您链接的 github 类；

2.  检查您正在运行的应用程序中的 UI 概念；

3.  如果 UI 运行良好，那么要么坚持那个给定的实现，要么改进它，要么寻找另一个，或者构建你自己的。

我认为在处理 UI 时最重要的一点是（2）：您需要尽快能够测试您的 UI 设计。可能包括其他人的反馈。

github 控件将为该目标创造奇迹。然后，您还可以更好地判断它是否适合您或您想要不同的东西。

您甚至可能会发现 UI 概念对您的应用程序不利，一旦您看到它正在运行，您将节省大量时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:28:47.827

我会建立自己的。这很简单：覆盖触摸事件并在 TouchesMoved 选择器中移动“指示器”视图框架。

# php - ajax响应后下拉选择菜单丢失css样式

> ID：14435468
> 
> 赞同：0
> 
> 时间：2013-01-21T09:14:42.133
> 
> 标签：php, jquery, css, ajax

我有一个表单，用户可以在其中选择他的国家，然后根据选择的国家，表单的下拉列表（选择）更改为该国家/地区的州/省列表。到现在为止还挺好。问题是下拉选择表单是用 CSS 设计的。当页面最初加载时，一切都很完美，但是当调用 ajax 脚本然后更改州/省下拉列表时，它返回无样式，所以基本上它失去了所有样式。有谁知道如何解决这个问题？代码样式正确，由于某种原因，当 ajax 返回它时它只是不执行它。

这是jquery代码：

```
function state_box(country, user_id)
{
    xmlHttp=GetXmlHttpObject();

    if (xmlHttp==null)
    {
            alert ("Browser does not support HTTP Request");
            return;
    }

    var url    = relative_path + 'states.php';
    var action    = url + '?country_id=' + country.value;

    xmlHttp.onreadystatechange = function() {
            if (xmlHttp.readyState == 4)
            {
                    var response = xmlHttp.responseText;
                    document.getElementById('stateBox').innerHTML = response;
            }
    };
    xmlHttp.open("GET", action, true);
    xmlHttp.send(null);
} 
```

而 states.php 的内容，基本上只是返回下拉列表，没什么花哨的：

```
 $display_output = '<select class="mystyle" name="dropdown" id="dropdown"> ';
        $display_output .= '<option value="" selected>Select a State</option> ';

        while ($state_details = $this->fetch_array($sql_select_states))
        {
            $display_output .= '<option value="' . $state_details['id'] . '" ' . (($selected_value == $state_details['id']) ? 'selected' : ''). '>' . $state_details['s.name'] . '</option>';
        }

        $display_output .= '</select>';

    $display_output = ($in_ajax) ? $display_output : '<div id="stateBox">' . $display_output . '</div>';

    return $display_output; 
```

唯一的问题基本上是CSS类“mystyle”在ajax返回后没有在浏览器中格式化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:22:35.553

而不是生成整个选择框作为响应。只需单独生成选项并将其放入 javascript 中的选择框中。试试这个，

```
PHP Code :

$display_output = '<option value="" selected>Select a State</option> ';

while ($state_details = $this->fetch_array($sql_select_states))
{
    $display_output .= '<option value="' . $state_details['id'] . '" ' . (($selected_value == $state_details['id']) ? 'selected' : ''). '>' . $state_details['s.name'] . '</option>';
}

return $display_output; 
```

在 JAVASCRIPT 中，

```
xmlHttp.onreadystatechange = function() {
            if (xmlHttp.readyState == 4)
            {
                    var response = xmlHttp.responseText;
                    document.getElementById('dropdown').innerHTML = response;
            }
    }; 
```

它也不会影响您的 CSS 和选择框。

但我建议您使用 Jquery 来满足未来的脚本要求。

# sharepoint - Sharepoint 自定义字段渲染模式：渲染到多个字段

> ID：14435472
> 
> 赞同：1
> 
> 时间：2013-01-21T09:14:44.970
> 
> 标签：sharepoint, custom-fields, custom-field-type

**最初的问题**

我可以将一个字段中的数据渲染成多列吗？

**背景**

我创建了一个自定义字段，其中包含一个下拉列表和两个文本框。这个想法是用户可以从连接到供应商列表的下拉列表中选择供应商。这将获取供应商的联系人姓名和电话号码并填充相应的文本框。

我这样做是因为能够覆盖联系电话和地址很重要，但客户希望查看默认值。

这是它的样子：

![在此处输入图像描述](../Images/9c29c50616881aa39c38c322e3cfa47f.png)

保存新条目时，该字段的值保存如下：

**;#1;#供应商 1;#联系人姓名;#01234 567890;#**

我选择将数据保存在其中，以便在渲染时可以将其视为多列字段。

我正在使用以下代码拆分数据并覆盖列表视图的显示模式：

```
 <RenderPattern Name="DisplayPattern">
  <Switch>
    <Expr>
      <Column />
    </Expr>
    <Case Value="" />
    <Default>
      <!--<Column SubColumnNumber="0" HTMLEncode="TRUE" />
      <HTML><![CDATA[<br/>]]></HTML>-->
      <Column SubColumnNumber="1" HTMLEncode="TRUE" />
      <HTML><![CDATA[ - ]]></HTML>
      <Column SubColumnNumber="2" HTMLEncode="TRUE" />
      <HTML><![CDATA[ - ]]></HTML>
      <Column SubColumnNumber="3" HTMLEncode="TRUE" />
      <HTML><![CDATA[]]>]></HTML>
     </Default>
  </Switch>
</RenderPattern> 
```

这使我可以将数据呈现给最终用户，如下所示：

![在此处输入图像描述](../Images/bf89984f32ea6bad6d370df8e1eeb535.png)

**问题**

我希望能够在单独的列中显示此拆分数据。我注意到 SharePoint 使用的内置标题字段有四种类型的列，您可以将它们添加到单个字段的视图中。我正在尝试重现这种功能，以便可以从视图中添加或删除数据的每个部分。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T16:47:28.417

事实证明，您可以访问列表项，这意味着我可以通过覆盖 UpdateFieldValueInItem 方法简单地添加到列表项中的其他字段。

```
 Public Overrides Sub UpdateFieldValueInItem()
    Me.ItemFieldValue = ddlSupplier.SelectedItem.Value
    If Me.Item.Fields.ContainsField(Me.Field.InternalName & "-" & "Telephone") Then
        Me.Item(Me.Field.InternalName & "-" & "Telephone") = txtTelephone.Text
    End If
End Sub 
```

一种更有效的方法。

# php - PHP,MySql 向数据库发送查询

> ID：14435482
> 
> 赞同：0
> 
> 时间：2013-01-21T09:15:14.373
> 
> 标签：php, html, mysql, database, phpmyadmin

[http://jsfiddle.net/Fd9wx/](http://jsfiddle.net/Fd9wx/) 我这样做是为了帮助解决我的问题

所以我有一些 php 代码和 html 代码应该在我创建的 html 表上将 sql Query 发送到数据库，比如设置新数据库，但是我填写了我的表单并单击运行它不想为我工作。在你说“使用 PDO 并且不再支持”之前，我做了一些谷歌研究并没有得到任何回报在这里手工制作这个脚本，所以不要说“联系脚本开发人员”，如果有人可以指出我解决我的问题的正确方向，或者只是让我的 sql 错误显示在我的脚本中？喜欢这条线要删除的所有内容

这是我脚本的主要部分

```
$tablename=$_POST['tablename'];
$value=$_POST['value'];
$type=$_POST['type'];
$length=$_POST['length'];
$collation=$_POST['collation'];
$attributes=$_POST['attributes'];
$null=$_POST['null'];
$extra=$_POST['extra'];

// Insert data into mysql 
$sql="CREATE TABLE  `a7972613_db`.`$tablename` (
`field1` $type( $length ) $null $extra
) ENGINE = MYISAM";
$result=mysql_query($sql);
// if successfully insert data into database, displays message "Successful". 
if($result){
echo "Successful";
}

else {
echo "Please Go Back And Check Your Errors!";
} 
```

那是我的主要部分

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:22:12.027

您的代码的问题是您没有选择数据库。

```
$host = "xxxxx";
$database = "xxxxx";
$user = "xxxx";
$password = "xxxxx";

// Connect to server and select database.
mysql_connect("$host", "$user", "$password")or die("cannot connect"); 
```

使用以下代码选择数据库

```
// Connect to server and select database.
$conn = mysql_connect("$host", "$user", "$password")or die("cannot connect"); 
mysql_select_db($database,$conn); 
```

另一个问题是当您的查询失败时，您已经对错误进行了硬编码，但是使用下面的代码来检查查询中的问题在哪里

```
$result=mysql_query($sql) or die(mysql_error()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:23:47.500

将您的查询更改为

```
$result = mysql_query($sql) or die("Error with $sql: " . mysql_error()); 
```

，[`mysql_error()`](http://php.net/manual/en/function.mysql-error.php)你会看到你的问题是什么。

您可以转储您的`$sql`字符串以查看是否正确

```
echo $sql; 
```

# php - PHP，将类作为对象返回

> ID：14435486
> 
> 赞同：3
> 
> 时间：2013-01-21T09:15:33.580
> 
> 标签：php, class, function

我正在测试像 js 一样编写 PHP 的方式，我想知道这是否可能。

如果说我在 C 类中有 A、B 功能。

```
Class C{
   function A(){

   }
   function B(){

   }
}
$D = new C;

$D->A()->B(); // <- Is this possible and how?? 
```

在 Js 中，我们可以简单地写`like D.A().B();`

`return $this`我在里面试过`function A()`，没用。

非常感谢您的建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-21T09:17:19.257

您正在寻找的是所谓的流畅界面。你可以通过让你的类方法返回自己来实现它：

```
Class C{
   function A(){
        return $this;
   }
   function B(){
        return $this;
   }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-21T09:17:26.553

返回`$this`方法内部`A()`实际上是要走的路。请向我们展示据称不起作用的代码（该代码中可能存在另一个错误）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-21T09:17:39.317

它真的很简单，你有一系列的 mutator 方法，它们都返回原始（或其他）对象，这样你就可以继续调用函数。

```
<?php
class fakeString
{
    private $str;
    function __construct()
    {
        $this->str = "";
    }

    function addA()
    {
        $this->str .= "a";
        return $this;
    }

    function addB()
    {
        $this->str .= "b";
        return $this;
    }

    function getStr()
    {
        return $this->str;
    }
}

$a = new fakeString();

echo $a->addA()->addB()->getStr(); 
```

这输出“ab”

在函数内部返回`$this`允许您使用相同的对象调用另一个函数，就像 jQuery 一样。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-21T09:20:36.587

我试过了，它奏效了

```
<?php

class C
{
  public function a() { return $this; }
  public function b(){ }
}

$c = new C();
$c->a()->b();
?> 
```

# multithreading - 来自另一个线程的 devexpress gridcontrol 数据绑定

> ID：14435487
> 
> 赞同：1
> 
> 时间：2013-01-21T09:15:38.330
> 
> 标签：multithreading, devexpress

我的主窗口表单中有一个 devexpress gridcontrol，我想根据我的 windows 手机通过 USB 端口（activesync）连接到桌面 pc 时发生的事件来填充它的数据源。问题是事件调用的方法正在另一个线程上执行。一旦我为我的 gridcontrol 分配了一个新的数据源，它就会尝试重绘控件，然后它给了我“对象引用未设置为对象的实例”错误。我尽力弄清楚它是否真的在另一个线程上完成了它的工作，因为我自己没有创建那个新线程。最后，我了解到，这确实是因为该方法工作的线程具有不同的线程 ID，甚至尝试制作一个小动画以在新线程上工作，以查看在无休止的动画运行时表单是否被锁定。所以可以肯定我尝试从不同的线程填充我的 devex gridcontrol。我怎么能遇到这种情况而不得到任何参考问题。

我正在在 Visual Studio 2003 上创建的 Windows 窗体项目上开发它，并依赖 1.1 的 .net 框架版本和 Windows 7 x86 o/s

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T10:45:42.660

Devex 控件必须在主 UI 线程上处理。

只需调用该方法即可在 UI 线程上工作 :)

# java - Java：在不知道其名称的情况下访问字段。（“保存参考”）

> ID：14435488
> 
> 赞同：0
> 
> 时间：2013-01-21T09:15:45.630
> 
> 标签：java, orm, field

我需要在`Field`不知道其名称的情况下获取（或字段列表）。

即：对于自定义实体管理器，我希望能够像这样进行方法调用：

`cem.getEntities(MyEntity.class, ParamMap)`其中 ParamMap 应该是 Type `Map<Field, Object>`。

我*现在能做*的是这样的：

```
Map<Field, Object> params = new HashMap<Field, Object>();
params.put(MyEntity.class.getDeclaredField("someFieldName"), 20);
List<MyEntity> entitysWithSomeFieldNameEquals20 = cem.getEntities(MyEntity.class, params); 
```

我试图避免使用查询，因为它首先应该“通用”，但也独立于字符串。（它们容易出错）。因此，实体管理器使用反射来确定他需要使用的表名和列名。

但是，我仍然需要使用

```
MyEntity.class.getDeclaredField("someFieldName") 
```

这将简单地将容易出错的字符串“移出”实体管理器......

我想要实现的是这样的：

```
MyEntity.class.getDeclaredField(MyEntity.class.fields.someFieldName.toString()) 
```

因此，无论实际字段的名称是什么，都可以以保存方式引用它，并且重构也将重构所有字段访问调用。

我不确定这是否可能。我可以为所有实体使用（封装的）枚举，但我希望有一种更通用的方法来实现这一点。

* * *

编辑：

一个好的解决方案似乎是使用常量：

```
public class MyEntity{
    private static string SOME_FIELD = "some_field_name_in_database";

    @Column(name = SOME_FIELD);
    private String someField;

}

...
Map<String, Object> params = new HashMap<String, Object>();
params.put(MyEntity.SOME_FIELD, matchValue);
List<MyEntity> result = eem.getEntities(MyEntity.class, params); 
```

这至少将字符串的使用减少到一个位置，可以在该位置对其进行维护和更改，而不会影响任何其他文件。但我仍在寻找没有常量的解决方案，因此*不需要与可用字段同步*：-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T13:29:25.647

好的，这只是一个想法，实现起来并不容易，但它可以工作。

假设 MyEntity 看起来像这样：

```
public class MyEntity {
  private String foo;
  private String bar;

  public String getFoo() { return this.foo; }
  public void setFoo(String foo) { this.foo = foo; }

  public String getBar() { return this.bar; }
  public void setBar(String bar) { this.bar = bar; } 
```

}

并且有一个界面：

```
public interface Pattern {
  public Class<?> getEntityClass();
  public Map<Field, Object> getFields();
} 
```

并且有一个方法，它接受一个类并生成一个模式对象，它是给定类的一个实例：

```
public class PatternFactory {
  public <T> T createPattern(Class<T> klass) {
    // magic happens here
  }
} 
```

发出的实例的要求是它应该实现`Pattern`接口，以便方法 getFields 仅返回显式设置的字段。GetEntityClass 应该返回实体类。然后自定义实体管理器可以这样实现：

```
public class EntityManager {
  public <T> Collection<T> getEntities(T pattern) {
    if (!(pattern instanceof Pattern))
      throw new IllegalArgumentException();

    Class<?> klass = ((Pattern) pattern).getEntityClass();
    Map<Field, Object> fields = ((Pattern) pattern).getFields();
    // fetch objects here
  }
} 
```

然后你可以像这样使用它：

```
PatternFactory pf = // obtain somehow
EntityManager em = // obtain somehow
MyEntity pattern = pf.createPattern(MyEntity.class);
pattern.setFoo("XYZ");
pattern.setBar(null);
Collection<MyEntity> result = em.getEntities(pattern); 
```

在这种情况下，pattern.getFields 将返回一个包含两个条目的地图。

当然，这里的困难在于 createPattern 方法的实现，您必须在运行时发出字节码。但是，这是可能的并且可以做到。

# c# - WebRequest 不在 REST url 上回复，但在其他网址上运行良好

> ID：14435490
> 
> 赞同：0
> 
> 时间：2013-01-21T09:16:08.530
> 
> 标签：c#, web-services, rest, httpwebrequest

我有以下代码。当我的 URL 是 google.com 时，我会从我的 WebRequest 中得到正确的答复，但是当我提供 REST API 请求的 URL 时，我的响应返回 null。

我在浏览器上使用相同的 URL，它返回正确的响应。ps我用#########隐藏的代码实际上是我的API的关键，我不想透露。

```
//HttpWebRequest req = (HttpWebRequest)WebRequest.Create("http://www.google.com");
HttpWebRequest req = (HttpWebRequest)WebRequest.Create("http://#########:@se.api.anpdm.com/v1/mailinglists/1/10");
HttpWebResponse res = (HttpWebResponse)req.GetResponse();
Stream S_DataStream;
StreamReader SR_DataStream;
string s_ResponseString = "nothing";
if (res != null)
       {
        //Translate data from the Web-Response to a string
        S_DataStream = res.GetResponseStream();
        SR_DataStream = new StreamReader(S_DataStream, Encoding.UTF8);
        s_ResponseString = SR_DataStream.ReadToEnd();
        S_DataStream.Close();
       }
Console.WriteLine(s_ResponseString); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T12:33:06.423

我知道了。我不应该将这样的身份验证密钥 (###) 放在 url 中。我应该使用这样的凭据，并将密钥作为用户名和空密码。

```
req.Credentials = new NetworkCredential("#####################",""); 
```

# php - 在与其他用户的所有对话之间获取最新消息

> ID：14435493
> 
> 赞同：0
> 
> 时间：2013-01-21T09:16:16.273
> 
> 标签：php, mysql, sql, messaging

我正在尝试从数据库中提取当前用户发送给/从另一个用户接收的每条最后一条消息的列表，例如 facebook 当前消息框（包含“对话”列表）

示例数据：

```
msg_id sender_id target_id date_sent content ...
  1        2         4        20       bla   ...
  2        2         5        21       bla   ...
  3        2         6        22       bla   ...
  4        4         2        25       bla   ...
  5        5         6        26       bla   ...
  6        4         2        50       bla   ... 
```

如果当前用户是 2，那么我只想获取 2 与其他任何人（发送或接收）的最后一条消息

希望的数据是：

```
msg_id sender_id target_id date_sent content ...
  6        4         2        50       bla   ...
  2        2         5        21       bla   ...
  3        2         6        22       bla   ... 
```

msg_id 6 存在是因为在所有消息 2 和 4 中（无论谁是发送者/接收者）它的日期最长 (50) msg​​_id 2 和 3 存在是因为这是与用户 5 和6（每人一个消息，已发送）

找不到解决方法，应该在一些包含发送者和接收者 ID 的唯一生成字段上包含一个 group_by 吗？不知道，请帮忙

**更新：**

我喜欢这些想法，最终我用另一个新字段创建了该表的视图，其中包含两个 Id 的串联，按顺序（先大），用下划线分隔。这样，该字段对于每个对话都是唯一的。然后按它分组:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:57:42.327

这是一个未经测试的示例。还有其他方法可以做到这一点，如果您进行搜索，这是一个很常见的问题。

```
SELECT t1.*
FROM 
  msg_table AS t1
LEFT JOIN msg_table AS t2
  ON ((t1.sender_id = t2.sender_id AND t1.target_id = t2.target_id) 
    OR (t1.sender_id = t2.target_id AND t1.target_id = t2.sender_id))
    AND t1.msg_id < t2.msg_id
WHERE (t1.sender_id = ? OR t1.target_id = ?) AND t2.msg_id IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T03:35:52.863

我做了一些类似于你在这里拍摄的事情。但为了更容易，我在表中添加了另一列名为 convoID。这不是唯一的 id，而是每次用户发送或接收来自他们已经与之通信的用户的消息时重复使用的 id。然后从表中获取所有convoID（但不重复）

```
SELECT DISTINCT convoID FROM table WHERE sender='$user' OR recipient='$user' 
```

这样，同一 2 个人之间的每条消息都可以作为对话轻松访问。从那里您可以从这样的对话中获取最新消息：

```
SELECT message FROM table WHERE convoID='$thisConvoID' ORDER BY time DESC LIMIT 0,1; 
```

对我来说，这是最不令人困惑的方式，而且效果很好——如果你需要澄清任何事情，只要问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T09:42:07.703

那可能有点乱。

玩得很快，这样的事情就可以完成。但是，这将获取发送给发件人的最新消息和发件人发送的最新消息（而不是您想要的最新消息），以及该发件人发给每个收件人的最新消息。

未经测试，请原谅任何错别字。

```
SELECT a.msg_id, a.sender_id, a.target_id, a.date_sent, a.content
FROM someTable a
INNER JOIN (SELECT sender_id As SomeBod, MAX(date_sent) AS date_sent
FROM someTable
WHERE sender_id = 2
GROUP BY sender_id) sub1
ON a.sender_id = sub1.SomeBod 
AND a.date_sent = sub1.date_sent
UNION 
SELECT b.msg_id, b.sender_id, b.target_id, b.date_sent, b.content
FROM someTable b
INNER JOIN (SELECT target_id As SomeBod, MAX(date_sent) AS date_sent
FROM someTable
WHERE target_id = 2
GROUP BY target_id) sub2
ON b.target_id = sub2.SomeBod 
AND b.date_sent = sub2.date_sent
UNION
SELECT c.msg_id, c.sender_id, c.target_id, c.date_sent, c.content
FROM someTable c
INNER JOIN (SELECT sender_id, target_id, MAX(date_sent) AS date_sent
WHERE sender_id = 2
GROUP BY sender_id, target_id) sub3
ON a.sender_id = sub3.sender_id 
AND b.target_id = sub3.target_id 
AND b.date_sent = sub3.date_sent 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T09:43:35.010

您可能会做一些事情，将 sender_id 和 target_id 组合成一个计算值，然后对其进行“LIKE”查询。

但是，老实说，我怀疑只运行两个更简单的查询然后将结果合并到代码中，您的性能会更好。您的代码也将更易于维护。

# android - GridLayout 的 SetGravity 不起作用

> ID：14435495
> 
> 赞同：6
> 
> 时间：2013-01-21T09:16:25.243
> 
> 标签：android, android-layout, gravity, grid-layout

我正在使用一个简单`GridLayout`的动态添加按钮。

```
<GridLayout
xmlns:android="http://schemas.android.com/apk/res/android"
   android:id="@+id/tagGridLayout"
android:background="@color/white"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:columnCount="3"
>
</GridLayout> 
```

我正在使用这个 Java 代码来填充我的网格，除了 set Gravity 选项没有做任何事情之外，它一切正常。我已经尝试过 - 将 layout_width 更改为 XML 文件中的不同类型，添加重力`GridLayout`等，如本网站其他解决方案中所述。另一件需要注意的是，我是在片段内的异步任务中执行此操作的。基本上我想`layout_gravity="fill_horizontal"`实现在 XML 中实现的目标。

```
tagButtons = new Button[trendingTagsCount];
        for(int i=0;i<trendingTagsCount;i++)
        {
            tagButtons[i] = new Button(getActivity());
            //tagButtons[i].setLayoutParams(new LayoutParams(Gravity.FILL_HORIZONTAL));
            tagButtons[i].setText(getTagsList.get(i).tag);
            tagButtons[i].setGravity(Gravity.FILL_HORIZONTAL);
            tagButtonGrid.addView(tagButtons[i]);
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-07-31T13:08:14.453

As Karan Mer said you set the Layout Gravity with GridLayout.LayoutParams.

But be careful, in Gridlayout you have to set the columnSpec / rowSpec of the Children (in your case the Button) before:

```
param.columnSpec = GridLayout.spec(0);
param.rowSpec = GridLayout.spec(0); 
```

and only then

```
param.setGravity(Gravity.RIGHT); 
```

if columnSpec / rowSpec is UNDEFINED when you do setGravity, gravity doesn't work...

Even if you do:

```
param.setGravity(Gravity.RIGHT);
param.columnSpec = GridLayout.spec(0);
param.rowSpec = GridLayout.spec(0); 
```

Gravity doesn't work...

The right way is:

```
param.columnSpec = GridLayout.spec(0);
param.rowSpec = GridLayout.spec(0);
param.setGravity(Gravity.RIGHT); 
```

I don't know if is a bug or a deliberate thing. (I'm using Android API 19)

# silverlight - Silverlight 网络应用程序。GPU 加速

> ID：14435503
> 
> 赞同：1
> 
> 时间：2013-01-21T09:16:46.137
> 
> 标签：silverlight, web, gpu

在 sivlierlight Web 应用程序 html 页面布局定义的参数中，启用 GPU：

是否可以从 Silverlight Web 应用程序检查 GPU 的硬件使用情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:25:34.993

还好你给了我俄文版。英文是看不懂的。你的问题很有趣。我不能肯定地说，但我相信没有办法直接检测（使用代码）GPU加速是否成功启用。（你可以打开debug overlays，也可以在可信模式下使用COM或者P/Invoke来查询GPU，但是这两种都不适合你。）

您也许可以创建某种基准。您也无法以编程方式获得每秒帧数，但可能有一些技巧可以尝试测量它。例如，启动控件位置的动画，并计算每秒触发 LayoutUpdated 的次数。

无论如何，您应该知道 GPU 加速在 Silverlight 中没有多大作用。它仅在少数情况下有用，例如具有大量精灵的 2D 游戏。在所有其他情况下，Silverlight 由 CPU 渲染（性能相当不错）。

# c - 取消引用指向结构指针的指针

> ID：14435504
> 
> 赞同：4
> 
> 时间：2013-01-21T09:16:47.100
> 
> 标签：c, pointers, structure, operator-precedence

```
gcc 4.7.2
c89 
```

你好，

我正在尝试取消引用指向结构指针的指针，并且在执行以下操作时收到此错误消息：

```
LOG_INFO("CHANNEL ID --- %d", *channel->id); 
```

编译错误

```
request for member ‘id’ in something not a structure or union 
```

如果我尝试将其转换为正确的指针类型，我仍然会收到相同的错误消息：

```
LOG_INFO("CHANNEL ID --- %d", (*(channel_t*)channel->id)); 
```

我通过声明一个新变量并分配结构指向的地址解决了这个问题：

```
channel_t *ch = NULL;
ch = *channel;
LOG_INFO("CHANNEL ID --- %d", ch->id); 
```

我只是想知道为什么前两种方法失败了。

非常感谢您的任何建议，

结构体：

```
typedef struct tag_channel channel_t;
struct tag_channel {
    size_t id;
    char *name;
}; 
```

我这样称呼它：

```
channel_t *channel = NULL;
channel = (channel_t*)apr_pcalloc(mem_pool, sizeof *channel);
LOG_CHECK(job_queue_pop(queue, &channel) == TRUE, "Failed to pop from the queue"); 
```

而这个功能，我遇到了麻烦：

```
apr_status_t job_queue_pop(apr_queue_t *queue, channel_t **channel)
{
    apr_status_t rv = 0;
    channel_t *ch = NULL;

    rv = apr_queue_pop(queue, (void**)channel);
    if(rv != APR_SUCCESS) {
        char err_buf[BUFFER_SIZE];
        LOG_ERR("Failed to pop from the queue %s", apr_strerror(rv, err_buf, BUFFER_SIZE));

        return FALSE;
    }

    ch = *channel;  
    LOG_INFO("CHANNEL ID --- %d", ch->id);
    LOG_INFO("CHANNEL NAME - %s", ch->name);

    return TRUE;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T09:18:42.503

您的优先级错误，应该是例如

```
(*channel)->id 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T09:22:11.280

您的运算符优先级错误。`->`运算符的优先级高于`.`运算符。所以在做出错误`->`之前进行评估。`.``*(channel->id)`

看下面的代码。它工作正常。

```
typedef struct test_
{
   int i;
}test;

int main()
{
   test a;
   test *aptr = &a;
   test **aptrptr = &aptr;
   a.i=6;
   printf("\n%d\n",(*aptrptr)->i);
   return 0;
} 
```

**[在此处](http://www.difranco.net/compsci/C_Operator_Precedence_Table.htm)阅读优先级。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-21T09:19:20.797

由于[运算符优先级](http://en.wikipedia.org/wiki/Operators_in_C_and_C++#Operator_precedence)，这是一个错误。试试这个：

```
(*channel)->id 
```

运算符`"*"`在运算符之后进行评估`"->"`。

# android - 膨胀自定义视图会导致错误

> ID：14435506
> 
> 赞同：2
> 
> 时间：2013-01-21T09:16:53.283
> 
> 标签：android, android-layout, android-relativelayout, layout-inflater

我创建了一个包含 ImageButton 和 TextView 的自定义视图。这是我的布局：

```
<merge xmlns:android="http://schemas.android.com/apk/res/android">

     <ImageButton android:id="@+id/image_button"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content" />

     <TextView android:id="@+id/text_view"
               android:layout_width="wrap_content"
               android:layout_height="wrap_content"
               android:clickable="false"
               android:layout_margin="1dp" />    
</merge> 
```

我还有一个继承自RelativeLayout 的类，称为CustomImageButton。这是它的代码的一部分：

```
public class CustomImageButton extends RelativeLayout {

    ...

    public CustomImageButton(Context context, AttributeSet attrs) {
        super(context, attrs);
        this.attributes = context.obtainStyledAttributes(attrs, R.styleable.CustomImageButton);
    }

    @Override
    protected void onFinishInflate() {
        super.onFinishInflate();

        ((Activity)getContext()).getLayoutInflater().inflate(R.layout.custom_image_button, this);
        this.setClickable(false);
        setupViewItems();
    }

    private void setupViewItems() {
          // DO STUFF HERE TO THE IMAGE BUTTON AND TEXT VIEW
          // FROM THE CUSTOM ATTRIBUTES 
    }
} 
```

这些是赋予自定义图像按钮的自定义属性：（attrs.xml）

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <declare-styleable name="CustomImageButton">
        <attr name="image_src" format="integer" />
        <attr name="text" format="string" />
        <attr name="text_size" format="dimension" />
        <attr name="text_top_padding" format="integer" />
        <attr name="text_alginment">
            <enum name="left" value="1"/>
            <enum name="right" value="2"/>
            <enum name="center" value="3"/>
        </attr>
        <attr name="text_color" format="color"/>
    </declare-styleable>
</resources> 
```

最后这是主要布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:weightSum="3" xmlns:app="http://schemas.android.com/apk/res/com.company.product.sp">

    <View
        android:layout_width="fill_parent"
        android:layout_height="0px"
        android:layout_weight="1" />

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:weightSum="4" >

        <View
            android:layout_width="0px"
            android:layout_height="2px"
            android:layout_weight="1" />

        <com.company.product.ui.views.CustomImageButton
            android:id="@id/main_command"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            app:image_src="@drawable/main_activity"
            app:text="@string/item_title"
            app:text_size="@dimen/main_menu_item_text"
            app:text_top_padding="55"
            app:text_alginment="center"
            app:text_color="@android:color/black" />
</LinearLayout>
</LinearLayout> 
```

现在，对于这个问题。当我在 android 4.0.2 及更高版本上运行我的应用程序时，一切正常但是，当我在 android 2.2.1 上运行我的应用程序时，我得到

```
android.view.InflateException: Binary XML file line #5: Error inflating class <unknown> 
```

根据堆栈跟踪（非常无信息），当我调用该方法时，该方法`CustomImageButton`中的类会引发异常。任何想法为什么以及如何解决这个问题？`onFinishInflate``inflate`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-04T13:35:41.707

如果调用其他两个构造函数中的任何一个（带有一个或三个参数），就会发生这种情况 - 然后 this.attributes 没有设置。这发生在我的案例中。

```
public SelectorButton(Context context) {
    super(context);
    _context = context;
}

public SelectorButton(Context context, AttributeSet attrs) {
    super(context, attrs);
    _context = context;
    init(attrs);
}

public SelectorButton(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
    _context = context;
    init(attrs);
} 
```

您可以看到我只在第二个和第三个构造函数中初始化属性。

# android - 在 AsyncTask 上设置 Bugsense 处理程序会导致违反严格模式

> ID：14435510
> 
> 赞同：2
> 
> 时间：2013-01-21T09:17:04.180
> 
> 标签：android, android-strictmode, bugsense

我设置了严格模式，然后设置了 Bugsense 处理程序。这导致违反 StrictMode 策略。

为什么会发生这种情况有什么合乎逻辑的解释吗？我怎样才能摆脱它？

我的应用程序.java：

```
 android.os.StrictMode.ThreadPolicy.Builder threadPolicyBuilder = new android.os.StrictMode.ThreadPolicy.Builder();
    android.os.StrictMode.VmPolicy.Builder vmPolicyBuilder = new android.os.StrictMode.VmPolicy.Builder();
    android.os.StrictMode.setThreadPolicy(threadPolicyBuilder.detectAll().penaltyLog().build());
    android.os.StrictMode.setVmPolicy(vmPolicyBuilder.detectAll().penaltyLog().build());

    new AsyncTask<Void, Void, Void>() {

        @Override
        protected Void doInBackground(Void... params) {

                BugSenseHandler.initAndStartSession(MyApplication.this, "my-id");

            return null;
        }
    }.execute(); 
```

堆栈：

```
01-21 09:43:40.889: D/StrictMode(29660): StrictMode policy violation: android.os.StrictMode$StrictModeDiskReadViolation: policy=23 violation=2
01-21 09:43:40.889: D/StrictMode(29660):    at android.os.StrictMode$AndroidBlockGuardPolicy.onReadFromDisk(StrictMode.java:745)
01-21 09:43:40.889: D/StrictMode(29660):    at dalvik.system.BlockGuard$WrappedFileSystem.open(BlockGuard.java:228)
01-21 09:43:40.889: D/StrictMode(29660):    at java.io.FileInputStream.<init>(FileInputStream.java:80)
01-21 09:43:40.889: D/StrictMode(29660):    at android.app.ContextImpl.getSharedPreferences(ContextImpl.java:381)
01-21 09:43:40.889: D/StrictMode(29660):    at android.content.ContextWrapper.getSharedPreferences(ContextWrapper.java:146)
01-21 09:43:40.889: D/StrictMode(29660):    at com.bugsense.trace.BugSenseHandler.initAndStartSession(Unknown Source)
01-21 09:43:40.889: D/StrictMode(29660):    at com.bugsense.trace.BugSenseHandler.initAndStartSession(Unknown Source)
01-21 09:43:40.889: D/StrictMode(29660):    at my.app$1.doInBackground(MyApplication.java:52)
01-21 09:43:40.889: D/StrictMode(29660):    at my.app$1.doInBackground(MyApplication.java:1)
01-21 09:43:40.889: D/StrictMode(29660):    at android.os.AsyncTask$2.call(AsyncTask.java:185)
01-21 09:43:40.889: D/StrictMode(29660):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
01-21 09:43:40.889: D/StrictMode(29660):    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
01-21 09:43:40.889: D/StrictMode(29660):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
01-21 09:43:40.889: D/StrictMode(29660):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
01-21 09:43:40.889: D/StrictMode(29660):    at java.lang.Thread.run(Thread.java:1019) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T11:34:27.360

您收到此错误是因为插件从主线程中的 SharedPreferences 读取信息。

不幸的是，目前没有办法克服这一点，除了降低严格模式的政策。

我们正在努力解决这个问题，即将发布的下一个版本的 BugSense 插件将在严格模式下工作得很好。

感谢您的反馈，它非常有价值，如果您有任何其他问题，我很乐意在我们的支持论坛上回答！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T09:47:58.397

您是否尝试过新版本的 BugSense SDK (3.2)？他们修复了严格模式问题。

[在此处](https://www.bugsense.com/releases/android/3.2)查看更改日志。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-24T09:15:55.163

我有类似的问题。我为我的应用创建了 DEVELOPER_MODE。这只是一个布尔标志，它告诉应用程序我是否处于开发人员模式。我只在开发者模式下启用严格模式，没有理由为已发布的应用启用严格模式。另一方面，我禁用了开发人员模式的 bugsense，因为如果我在 LogCat 中看到它们，我不需要报告错误。我的代码看起来像这样

```
public static final boolean DEVELOPER_MODE = true;

@Override
public void onCreate() {

    if (DEVELOPER_MODE) {
    StrictMode.setThreadPolicy(new  StrictMode.ThreadPolicy.Builder().detectAll().penaltyLog().build());
    StrictMode.setVmPolicy(new  StrictMode.VmPolicy.Builder().detectAll().penaltyLog().build());

    }else{
        new AsyncTask<Void, Void, Void>() {

            @Override
            protected Void doInBackground(Void... params) {

                BugSenseHandler.initAndStartSession(MyApplication.this, "my-id");

            return null;
            }
        }.execute();
    }
} 
```

# php - 当前时间（秒）

> ID：14435511
> 
> 赞同：1
> 
> 时间：2013-01-21T09:17:05.737
> 
> 标签：php, javascript, jquery

我有一个奇怪的问题..我有一个用秒计数器显示时间的功能，但是当秒数达到 59 时，我发送了特定时间（小时和分钟）作为参数，没有增加分钟，我不确定小时时是否有同样的问题分钟将是 59 分钟

```
function updateClock(current_hours,current_minutes) {
var currentTime = new Date ( );

var currentHours    = current_hours;
var currentMinutes  = current_minutes;
var currentSeconds  = currentTime.getSeconds ( );

// Pad the minutes and seconds with leading zeros, if required
currentMinutes = ( currentMinutes < 10 ? "0" : "" ) + currentMinutes;
currentSeconds = ( currentSeconds < 10 ? "0" : "" ) + currentSeconds;

// Choose either "AM" or "PM" as appropriate
var timeOfDay = ( currentHours < 12 ) ? "AM" : "PM";

// Convert the hours component to 12-hour format if needed
currentHours = ( currentHours > 12 ) ? currentHours - 12 : currentHours;

// Convert an hours component of "0" to "12"
currentHours = ( currentHours == 0 ) ? 12 : currentHours;

// Compose the string for display
var currentTimeString = currentHours + ":" + currentMinutes + ":" + currentSeconds + " " + timeOfDay;

// Big font time
$('.big_time').html("<span></span>" + currentTimeString);

// Time in red triangle in the track bar
$('.time').html(currentTimeString);
} 
```

我在准备好的文档中的另一个文件中调用此函数..我将从 API 检索到的数据发送到这里（小时和分钟）

```
current_hours   = data.current_hours;
current_minutes = data.current_minutes;

setInterval(function(){updateClock(current_hours,current_minutes)},1000); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T10:01:40.123

改用这个

```
function updateClock ( )
    {
    var currentTime = new Date ( );
    var currentHours = currentTime.getHours ( );
    var currentMinutes = currentTime.getMinutes ( );
    var currentSeconds = currentTime.getSeconds ( );

    // Pad the minutes and seconds with leading zeros, if required
    currentMinutes = ( currentMinutes < 10 ? "0" : "" ) + currentMinutes;
    currentSeconds = ( currentSeconds < 10 ? "0" : "" ) + currentSeconds;

    // Choose either "AM" or "PM" as appropriate
    var timeOfDay = ( currentHours < 12 ) ? "AM" : "PM";

    // Convert the hours component to 12-hour format if needed
    currentHours = ( currentHours > 12 ) ? currentHours - 12 : currentHours;

    // Convert an hours component of "0" to "12"
    currentHours = ( currentHours == 0 ) ? 12 : currentHours;

    // Compose the string for display
    var currentTimeString = currentHours + ":" + currentMinutes + ":" + currentSeconds + " " + timeOfDay;

    $("#clock").html(currentTimeString);

 }

$(document).ready(function()
{
   setInterval('updateClock()', 1000);
}); 
```

[从这里](http://www.jquery4u.com/snippets/create-jquery-digital-clock-jquery4u/)得到这个代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:31:22.630

请检查循环是否经过 60 次计数或以 59 结束，例如 for(i=1,i<=60:i++) 它将转到 59 并结束，检查开始和结束值。

# python - 使用 pymongo 不断得到 DuplicateKeyError

> ID：14435516
> 
> 赞同：0
> 
> 时间：2013-01-21T09:17:24.010
> 
> 标签：python, mongodb, pymongo

Pymongo 几个星期都做得很好，直到我遇到以下错误：

```
    回溯（最近一次通话最后）：
      文件“main.py”，第 14 行，在
        主要的（）
      文件“main.py”，第 11 行，在 main
        下载器.process()
      文件“/mnt/vdisk/crawler/eurostat/downloader.py”，第 25 行，处理中
        self.processHelper()
      文件“/mnt/vdisk/crawler/eurostat/downloader.py”，第 61 行，在 processHelper 中
        self.base.insert（文档）
      文件“/usr/local/lib/python2.7/dist-packages/pymongo/collection.py”，第 359 行，插入
        continue_on_error，self.__uuid_subtype），安全）
      _send_message 中的文件“/usr/local/lib/python2.7/dist-packages/pymongo/mongo_client.py”，第 852 行
        rv = self.__check_response_to_last_error(response)
      文件“/usr/local/lib/python2.7/dist-packages/pymongo/mongo_client.py”，第 793 行，在 __check_response_to_last_error
        引发 DuplicateKeyError（详细信息 [“错误”]）
    pymongo.errors.DuplicateKeyError: E11000 重复键错误索引：test.eurostatdata.$_id_ dup key: { : ObjectId('50fd056757b924675af21a0e') }

```

_id 绝对不是该领域之一。我一直都是靠mongodb生成自己的_id，所以以前从来没有遇到过这种问题。

插入代码：

```
文件 = []
对于 split_table_data 中的键：
    文件 = ele
    文档["title"] = ele["title"]
    文档["table_data"] = split_table_data[key]
    文档[“cols”] = colsHeader
    文档[“字幕”] = 键
    文件。附加（文件）
self.base.insert（文档）

```

我使用最新的 pymongo 包和最新的 mongodb。

唯一可能导致这种情况的是我试图插入一个超过大小限制的文档。

我努力了

> db.repairDatabase()
> 
> db.test.validate()

# html - 如何制作一个html语音按钮

> ID：14435518
> 
> 赞同：0
> 
> 时间：2013-01-21T09:17:26.190
> 
> 标签：html

因此，我正在尝试制作一个html5 语音 [按钮](http://translate.google.com)浏览器，所以我看了一下 HTML 代码，我发现了这个

```
 <input id="gt-speech-in" type="text" speech="speech" x-webkit-speech="x-webkit-speech"                
  x-webkit-grammar="builtin:translate" size="1" lang="en" style="" tabindex="-3"> 
```

它不会像在 translate.google 中那样输出按钮，它只输出一个小文本输入，那么如何将其更改为按钮或使其更小以使其看起来像一个按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:18:41.717

在 Chrome 中，上面的代码片段**确实**显示了输入麦克风，您可以控制样式中文本输入字段的大小，例如：

```
<input id="gt-speech-in" type="text" speech="speech" x-webkit-speech="x-webkit-speech"                
x-webkit-grammar="builtin:translate" size="1" lang="en" style="width:200px;" tabindex="-3"> 
```

您是否尝试在表单上显示任何其他内容（或让它在非 Chrome 环境中工作）？

# configuration - App.config 问题

> ID：14435519
> 
> 赞同：1
> 
> 时间：2013-01-21T09:17:30.243
> 
> 标签：configuration, web-config, app-config

当我修改我的 app.config 以包含 ReflectSoftware 日志信息时，Ninjatrader 崩溃了。你能指出我没有正确配置它的地方吗？

```
?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <system.net>
        <defaultProxy>
            <proxy usesystemdefault="False"/>
        </defaultProxy>
    </system.net>
    <configSections>         
   <section name="insightSettings" type="ReflectSoftware.Insight.ConfigurationHandler,ReflectSoftware.Insight"/>
</configSections> 
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <!--
    In order to recieve location information, you must ensure the layout has the parameter ${callsite} and all 
    its properties set accordantly.
     -->
    <extensions>
        <add assembly="ReflectSoftware.Insight.Extensions.NLog"/>
    </extensions>
    <targets>
      <target name="ReflectInsight"
              xsi:type="ReflectInsight"
              instanceName="nlogInstance1"
              displayLevel="true"
              displayLocation="true"
              layout="${callsite:className=true:fileName=true:includeSourcePath=true:methodName=true}" />
    </targets>
    <rules>
        <logger name="*" minlevel="Trace" writeTo="ReflectInsight" />        
    </rules>
</nlog>
</configuration> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:43:40.280

通过在 Config 部分之后移动 xml 片段来修复

# c# - 为什么使用 HttpClient 进行同步连接

> ID：14435520
> 
> 赞同：223
> 
> 时间：2013-01-21T09:17:31.323
> 
> 标签：c#, asp.net, dotnet-httpclient

我正在构建一个类库来与 API 交互。我需要调用 API 并处理 XML 响应。我可以看到使用`HttpClient`异步连接的好处，但我所做的是纯粹同步的，所以我看不到使用`HttpWebRequest`.

如果有人能阐明任何观点，我将不胜感激。我不是为了新技术而使用新技术的人。

* * *

## 回答 #1

> 赞同：420
> 
> 时间：2013-01-21T09:20:38.897

> 但我正在做的是纯粹同步的

您可以`HttpClient`很好地用于同步请求：

```
using (var client = new HttpClient())
{
    var response = client.GetAsync("http://google.com").Result;

    if (response.IsSuccessStatusCode)
    {
        var responseContent = response.Content; 

        // by calling .Result you are synchronously reading the result
        string responseString = responseContent.ReadAsStringAsync().Result;

        Console.WriteLine(responseString);
    }
} 
```

至于为什么你应该使用`HttpClient`over `WebRequest`，嗯，`HttpClient`是新的孩子，可能包含对旧客户端的改进。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-05-21T10:41:11.800

我会重申 Donny V. answer 和 Josh 的

> “我不使用异步版本的唯一原因是，如果我试图支持尚未内置异步支持的旧版本 .NET。”

（如果我有声誉，请投票。）

我不记得上次是什么时候了，我很感激 HttpWebRequest 抛出状态码 >= 400 的异常。要解决这些问题，您需要立即捕获异常，并将它们映射到一些非异常响应机制在您的代码中......本身很无聊，乏味且容易出错。无论是与数据库通信，还是实现定制的 Web 代理，“几乎”总是希望 Http 驱动程序只告诉您的应用程序代码返回什么，并由您决定如何表现。

因此 HttpClient 更可取。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2021-03-16T13:18:57.687

对于现在遇到此问题的任何人，.NET 5.0 已将同步`Send`方法添加到`HttpClient`. [https://github.com/dotnet/runtime/pull/34948](https://github.com/dotnet/runtime/pull/34948)

优点以及为什么在这里详细讨论 - [https://github.com/dotnet/runtime/issues/32125](https://github.com/dotnet/runtime/issues/32125)

因此，您可以使用 this 而不是`SendAsync`. 例如

```
public string GetValue()
{
    var client = new HttpClient();

    var webRequest = new HttpRequestMessage(HttpMethod.Post, "http://your-api.com")
    {
        Content = new StringContent("{ 'some': 'value' }", Encoding.UTF8, "application/json")
    };

    var response = client.Send(webRequest);

    using var reader = new StreamReader(response.Content.ReadAsStream());

    return reader.ReadToEnd();
} 
```

这段代码只是一个简化的例子，它还没有准备好生产。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2019-05-21T15:40:02.523

```
public static class AsyncHelper  
{
    private static readonly TaskFactory _taskFactory = new
        TaskFactory(CancellationToken.None,
                    TaskCreationOptions.None,
                    TaskContinuationOptions.None,
                    TaskScheduler.Default);

    public static TResult RunSync<TResult>(Func<Task<TResult>> func)
        => _taskFactory
            .StartNew(func)
            .Unwrap()
            .GetAwaiter()
            .GetResult();

    public static void RunSync(Func<Task> func)
        => _taskFactory
            .StartNew(func)
            .Unwrap()
            .GetAwaiter()
            .GetResult();
} 
```

然后

```
AsyncHelper.RunSync(() => DoAsyncStuff()); 
```

如果您使用该类将您的异步方法作为参数传递，您可以以安全的方式从同步方法中调用异步方法。

它在这里解释： [https ://cpratt.co/async-tips-tricks/](https://cpratt.co/async-tips-tricks/)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-01-21T09:24:12.180

如果您正在构建一个类库，那么您的库的用户可能希望异步使用您的库。我认为这是最大的原因。

你也不知道你的图书馆将如何被使用。也许用户会处理大量的请求，而异步执行将有助于它更快、更高效地执行。

如果您可以简单地做到这一点，请尽量不要将负担放在尝试使流程异步的库用户身上，因为您可以为他们处理它。

我不使用异步版本的唯一原因是，如果我试图支持尚未内置异步支持的旧版本 .NET。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-09-26T00:53:17.687

就我而言，接受的答案不起作用。我从没有异步操作的 MVC 应用程序调用 API。

这就是我设法使它工作的方法：

```
private static readonly TaskFactory _myTaskFactory = new TaskFactory(CancellationToken.None, TaskCreationOptions.None, TaskContinuationOptions.None, TaskScheduler.Default);
public static T RunSync<T>(Func<Task<T>> func)
    {           
        CultureInfo cultureUi = CultureInfo.CurrentUICulture;
        CultureInfo culture = CultureInfo.CurrentCulture;
        return _myTaskFactory.StartNew<Task<T>>(delegate
        {
            Thread.CurrentThread.CurrentCulture = culture;
            Thread.CurrentThread.CurrentUICulture = cultureUi;
            return func();
        }).Unwrap<T>().GetAwaiter().GetResult();
    } 
```

然后我这样称呼它：

```
Helper.RunSync(new Func<Task<ReturnTypeGoesHere>>(async () => await AsyncCallGoesHere(myparameter))); 
```

# ruby - OEL 上的 Ruby LoadError

> ID：14435523
> 
> 赞同：0
> 
> 时间：2013-01-21T09:17:38.143
> 
> 标签：ruby, rubygems

我刚刚在 OEL 5.8 服务器上安装了 ruby​​，并且看到了一些奇怪的行为

服务器详情

```
 Linux myhost 2.6.18-238.el5 #1 SMP Tue Jan 4 15:41:11 EST 2011 x86_64 x86 
```

红宝石版本

```
ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux] 
```

当我尝试运行一个 ruby​​ 程序时，我得到一个奇怪的错误

```
 -sh-3.2$ ruby testing.rb
 ruby: No such file or directory -- ('» (LoadError) 
```

类似地调用 gem 返回类似的错误

```
-sh-3.2$ gem -v
/usr/bin/ruby: No such file or directory -- (W
(LoadError) 
```

在 ruby​​ 上运行 strace 会在它死之前显示此错误

```
lstat("/usr", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/usr/lib", {st_mode=S_IFDIR|0755, st_size=12288, ...}) = 0
lstat("/usr/lib/ruby", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/usr/lib/ruby/site_ruby", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/usr/lib/ruby/site_ruby/1.9.1", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/usr/lib/ruby/site_ruby/1.9.1/rubygems", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/usr/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb",  {st_mode=S_IFREG|0644, st_size=1871, ...}) = 0
open("(\227I\6", O_RDONLY)              = -1 ENOENT (No such file or directory)
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
write(2, "ruby", 4ruby)                     = 4
write(2, ": ", 2: )                       = 2
write(2, "No such file or directory -- (\227I"..., 33No such file or directory -- (I) = 33
write(2, " (", 2 ()                       = 2
write(2, "LoadError", 9LoadError)                = 9
write(2, ")\n", 2)
)                      = 2
getrlimit(RLIMIT_STACK, {rlim_cur=10240*1024, rlim_max=RLIM_INFINITY}) = 0
rt_sigaction(SIGINT, {0x1, [], SA_RESTORER|SA_SIGINFO, 0x319d00eb10}, {0x4b1eb0, [],   SA_RESTORER|SA_SIGINFO, 0x319d00eb10}, 8) = 0
rt_sigaction(SIGINT, {SIG_DFL, [], SA_RESTORER|SA_SIGINFO, 0x319d00eb10}, {0x1, [], SA_RESTORER|SA_SIGINFO, 0x319d00eb10}, 8) = 0
write(4, "!", 1)                        = 1
munmap(0x2ac6c5784000, 1052672)         = 0
exit_group(1) 
```

如果有人想看，我有完整的输出

奇怪的是，每次我调用 ruby​​ 时，我都会收到一条略有不同的错误消息（例如）

```
-sh-3.2$ ruby testing.rb
ruby: No such file or directory -- (Ç/ (LoadError)
-sh-3.2$ ruby testing.rb
ruby: No such file or directory -- Ç (LoadError)
-sh-3.2$ ruby testing.rb
ruby: No such file or directory -- 0w;   (LoadError)
-sh-3.2$ ruby testing.rb
ruby: No such file or directory -- NULLCMD (LoadError)
-sh-3.2$ ruby testing.rb
ruby: No such file or directory -- 07î (LoadError) 
```

并且在每种情况下，我的 strace 在它死之前都会显示这样的错误

```
lstat("/usr/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb", {st_mode=S_IFREG|0644, st_size=1871, ...}) = 0
open("\20\7\3\30", O_RDONLY)            = -1 ENOENT (No such file or directory) 
```

我注意到这发生在几周前，并重新安装了 ruby​​ 来修复它，但昨天凌晨 4 点，问题再次发生，这很奇怪，因为在那段时间没有使用盒子

我已经完成了通常的工作，比如检查其他版本的 Ruby，一切看起来都很好，所以我有点卡在这个上

有谁知道可能是什么原因造成的？更重要的是如何解决它

干杯

麦克风

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T16:25:05.997

在运行 RHEL 6.3 的系统上遇到此问题。prelink 包每天运行一次并破坏 ruby​​ 二进制文件。我卸载了 prelink 并替换了 ruby​​ 二进制文件。

# javascript - 动力学 js 画布将事件侦听器添加到 for 循环中的多个点

> ID：14435526
> 
> 赞同：1
> 
> 时间：2013-01-21T09:17:46.270
> 
> 标签：javascript, canvas, html5-canvas, kineticjs

假设我有以下代码，该事件似乎只是不时触发，以以下两个示例为例。

第一个示例效果很好，并且事件每次都按预期触发

```
for (var i = 0; i < items; i++) {
            var rect = new Kinetic.Rect({
                x: 0,
                y: 1+i,
                width: 100,
                height: 2,
                fill: 'green'
            });
            rect.on('mouseover', function(evt) {
                $('#console').text(evt.shape.index);
            });
            layer.add(rect);
        } 
```

查看实际操作[http://jsfiddle.net/6aTNn/5/](http://jsfiddle.net/6aTNn/5/)

当在事件上添加旋转值似乎没有正确触发时，这是我的问题。

```
for (var i = 0; i < items; i++) {
            var rect = new Kinetic.Rect({
                x: stage.getWidth() / 2,
                y: stage.getHeight() / 2,
                width: 100,
                height: 1,
                fill: 'green'
            });
            rect.on('mouseover', function(evt) {
                console.log(evt.shape.index);
                $('#console').text(evt.shape.index);
            });
            rect.rotate(i * angularSpeed / items);
            // add the shape to the layer
            layer.add(rect);
        } 
```

查看实际操作[http://jsfiddle.net/6aTNn/8/](http://jsfiddle.net/6aTNn/8/)

在这方面的任何帮助都会很好地持续几个小时并且找不到有效的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T10:15:32.147

节点太“薄”并且太重叠，事件无法正常触发。

尝试增加每个节点的高度并减少它们的数量。
例如，替换`i++`with`i += 3`并增加`height`to `2`。

```
for (var i = 0; i < 800; i += 3) {
    var rect = new Kinetic.Rect({
        x: stage.getWidth() / 2,
        y: stage.getHeight() / 2,
        width: 100,
        height: 2,
        fill: 'green'
    });
    // ...
} 
```

# android - Android - 为每个孩子设置不同的 OnTouch 事件

> ID：14435528
> 
> 赞同：2
> 
> 时间：2013-01-21T09:17:48.910
> 
> 标签：android, android-layout, ontouchlistener

您好我正在尝试创建一个拖放视图并且我已经成功但是我有一个问题，我像这样动态添加我的视图

```
int k=0;
        for(int i=0;i<badge_list_id.size()/2;i++) {
            Log.i(BaseID.TAG, "K : "+k);
            temp_badge_list_id.clear();
            temp_badge_list_name.clear();
            temp_badge_list_url.clear();
            for(int j=k;j<k+2;j++)
            {
                temp_badge_list_id.add(badge_list_id.get(j));
                temp_badge_list_name.add(badge_list_name.get(j));
                temp_badge_list_url.add(badge_list_url.get(j));
            }
            llContainerBadgeList.addView(new ChildPopUpTopSend(context, temp_badge_list_id, temp_badge_list_name,
                    temp_badge_list_url, badge_id, new callbackDragDrop()));
            k=k+2;
        } 
```

并像这样在子视图中设置 ontouch 侦听器

```
private View.OnTouchListener mOnTouchDrag1=new View.OnTouchListener() {
        @Override
        public boolean onTouch(View v, MotionEvent event) {

            switch(event.getAction())
            {
                case MotionEvent.ACTION_MOVE:
                {
                    cbDrag.onDrag(badge_list_id.get(0), badge_id, BaseID.DRAGGING, event, v, badge_list_url.get(0));
                    break;
                }//inner case MOVE
                case MotionEvent.ACTION_UP:
                {
                    cbDrag.onDrag(badge_list_id.get(0), badge_id, BaseID.STOP_DRAG, event, v, badge_list_url.get(0));
                    break;
                }//inner case UP
                case MotionEvent.ACTION_DOWN:
                {
                    cbDrag.onDrag(badge_list_id.get(0), badge_id, BaseID.START_DRAG, event, v, badge_list_url.get(0));
                    break;
                }//inner case UP
            }//inner switch

            return true;
        }
    }; 
```

而cbDrag.onDrag函数是这样的

```
private class callbackDragDrop implements callbackDrag {

        @Override
        public void onDrag(int selected_badge, ArrayList<Integer> badge_id, int dragState, 
                MotionEvent event, View v, String badge_url) {
            LinearLayout.LayoutParams par = (LinearLayout.LayoutParams) v.getLayoutParams();
            switch(dragState) {
            case BaseID.START_DRAG:
                llContainerDrag = new LinearLayout(context);
                llContainerDrag.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, 
                        (Util.getDisplayHeight(context)*8)/10));
                ivDrag = new ImageView(context);
                imageLoader.DisplayImage(badge_url, ivDrag);
                par.topMargin = (int)event.getRawY() - (int)(v.getHeight()*1.5);
                par.leftMargin = (int)event.getRawX() - (int)(v.getWidth()*1.5);
                ivDrag.setLayoutParams(par);
                llContainerDrag.addView(ivDrag);
                PopUpTopSend.this.addView(llContainerDrag);
                break;
            case BaseID.DRAGGING:
                par.height = drag_height;
                par.width = drag_width;
                par.topMargin = (int)event.getRawY() - (int)(v.getHeight()*1.5);
                par.leftMargin = (int)event.getRawX() - (int)(v.getWidth()*1.5);
                ivDrag.setLayoutParams(par);
                break;
            case BaseID.STOP_DRAG:
                int drop_position = checkDropLocation(event);
                Log.i(BaseID.TAG, "Drop position : "+drop_position);
                ImageView ivDrop;
                switch(drop_position) {
                case 1:
                    if(selected_badge!=badge_id.get(0)) {
                        ivDrop = (ImageView) findViewById(R.id.ivBadgeSend1);
                        imageLoader.DisplayImage(badge_url, ivDrop);
                        PopUpTopSend.this.badge_id.remove(0);
                        PopUpTopSend.this.badge_id.add(0, selected_badge);
                    }
                    break;
                case 2:
                    if(selected_badge!=badge_id.get(1)) {
                        ivDrop = (ImageView) findViewById(R.id.ivBadgeSend2);
                        imageLoader.DisplayImage(badge_url, ivDrop);
                        PopUpTopSend.this.badge_id.remove(1);
                        PopUpTopSend.this.badge_id.add(1, selected_badge);
                    }
                    break;
                case 3:
                    if(selected_badge!=badge_id.get(2)) {
                        ivDrop = (ImageView) findViewById(R.id.ivBadgeSend3);
                        imageLoader.DisplayImage(badge_url, ivDrop);
                        PopUpTopSend.this.badge_id.remove(2);
                        PopUpTopSend.this.badge_id.add(2, selected_badge);
                    }
                    break;
                }
                llContainerDrag.removeView(ivDrag);
                PopUpTopSend.this.removeView(llContainerDrag);
                break;
            }
        }

    } 
```

假设我要动态添加 8 个视图，因此我的代码将从 1 和 2 到 7 和 8 的每个循环添加 2 个视图，但是传递给 cbDrag.onDrag 的始终是第 7 和第 8 数据，所以当我尝试拖动图像时将显示的是第 7 和第 8 图像，我哪里出错了？是不是当我尝试设置 ontouch 侦听器时，数据总是会因为我在循环中而被更改？有没有办法解决这个问题？

谢谢你

# autoit - 如何使用autoit在文本文件中逐列搜索字符串

> ID：14435533
> 
> 赞同：-1
> 
> 时间：2013-01-21T09:18:19.323
> 
> 标签：autoit

我有一个包含 2 列的文本文件，我需要使用 autoit 搜索“A”

```
Column1 Column2
------- --------  
   1        2
   3        A
   5        6 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T15:26:25.090

```
$file = FileRead("columns.txt")
$lines = StringSplit($file, @CR)
$count = $lines[0]

For $i = 1 To $count
   $line = $lines[$i]
   $noExtraBlanks = StringStripWS($line, 7)
   $columns = StringSplit($noExtraBlanks, " ")
   $columnCount = $columns[0]

   For $j = 1 To $columnCount
      If $columns[$j] == "A" Then
         ConsoleWrite("Line: " & $i & ", Column: " & $j & @CR)
      EndIf
   Next
Next 
```

如果您需要更多帮助，则需要更精确地确定您想要实现的目标......这里将为您提供给定文件中“A”的位置。

# android - 屏幕关闭时启动应用程序

> ID：14435534
> 
> 赞同：2
> 
> 时间：2013-01-21T09:18:26.643
> 
> 标签：android, screen

我想在屏幕关闭时打开我的 MainActivity 类。为了做到这一点，我制作了两个类 ScreenReceiver.java 来处理屏幕关闭和屏幕开启意图：

```
public class ScreenReceiver extends BroadcastReceiver {

 private boolean screenOff;

    @Override
    public void onReceive(Context context, Intent intent) {
        if (intent.getAction().equals(Intent.ACTION_SCREEN_OFF)) {
            screenOff = true;
        } else if (intent.getAction().equals(Intent.ACTION_SCREEN_ON)) {
            screenOff = false;
        }
        Intent i = new Intent(context, UpdateService.class);
        i.putExtra("screen_state", screenOff);
        context.startService(i);
    }

} 
```

以及用于实现 ScreenReceiver 的 UpdateService：

```
public  class UpdateService extends Service {

@Override
public void onCreate() {
    super.onCreate();
    // register receiver that handles screen on and screen off logic
    IntentFilter filter = new IntentFilter(Intent.ACTION_SCREEN_ON);
    filter.addAction(Intent.ACTION_SCREEN_OFF);
    BroadcastReceiver mReceiver = new ScreenReceiver();
    registerReceiver(mReceiver, filter);
}

public void onStart(Context context, Intent intent, int startId) {
    boolean screenOn = intent.getBooleanExtra("screen_state", false);
    if (!screenOn) {
        // your code
         Intent intent11 = new Intent(context,MainActivity.class);
         intent11.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
         context.startActivity(intent11);
    } else {
        // your code
        Intent intent11 = new Intent(context,MainActivity.class);
        intent11.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    }
}

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
} 
```

}

所以，当我安装我的应用程序时，屏幕关闭时没有事件。请告诉我问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-26T20:19:40.283

首先，intents`ACTION_SCREEN_OFF`只能`ACTION_SCREEN_ON`由通过 function 注册的接收者处理`registerReceiver()`。在 manifest.xml 中定义一个`IntentFilter`不适用于这些意图。

然后，您需要确保`UpdateService:onCreate()`在您的应用程序中被调用，否则`ScreenReceiver:onReceiver()`将永远不会被调用。当你有意图时你可能想这样做`BOOT_COMPLETED`。

您可以将代码更改为此，并且不要忘记在清单中定义服务：

```
public class UpdateService extends Service {

    BroadcastReceiver mReceiver = new BroadcastReceiver {
    private boolean screenOff;

    @Override
    public void onReceive(Context context, Intent intent) {
        if (intent.getAction().equals(Intent.ACTION_SCREEN_OFF)) {
            screenOff = true;
        } else if (intent.getAction().equals(Intent.ACTION_SCREEN_ON)) {
            screenOff = false;
        }
        handleScreenAction(screenOff);
    }

    private void handleScreenAction(boolean screenOff) {
        if (screenOff) {
            // your code
            Intent intent11 = new Intent(context,MainActivity.class);
            intent11.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            context.startActivity(intent11);
        } else {
            // your code
            Intent intent11 = new Intent(context,MainActivity.class);
            intent11.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        }
    }

    @Override
    public void onCreate() {
        super.onCreate();
        // register receiver that handles screen on and screen off logic
        IntentFilter filter = new IntentFilter(Intent.ACTION_SCREEN_ON);
        filter.addAction(Intent.ACTION_SCREEN_OFF);
        registerReceiver(mReceiver, filter);
    }

    @Override
    public void onDestory() {
        super.onDestory();
        unRegisterReceiver(mReceiver);
    }

    public void onStart(Context context, Intent intent, int startId) {
    }

    @Override
    public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
        return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T14:54:34.207

您是否在应用程序某处的前台启动了 UpdateService？

# sql - 将 BC 日期转换为 AD

> ID：14435539
> 
> 赞同：2
> 
> 时间：2013-01-21T09:18:42.127
> 
> 标签：sql, oracle, date

我有日期，在第 0 年之前。我需要将它们转换为 AD 日期并再增加 1 年。例如，我有`BC 16.2.2011`并且想要`AD 16.2.2012`.

我们有一个第 3 端 Java 应用程序，其中有时会发生错误；它错误地保存了日期。在上面的示例中，它应该保存`16.2.2012`，但在数据库中，它是`-16.2.2011`（它是“小一年”，因为 Oracle 没有零年 - 这很重要）。

转换这些日期很容易，但问题是保存日期应该是什么时候，`29.2.2012`因为没有`-29.2.2011`. 它保存的不是这个日期`-1.3.2011`，我无法轻松转换。

有什么方法可以正确转换日期吗？就像从数据库中的转储数据中获取起始年份的秒数一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T10:24:09.580

Tell us if it is something wrong with:

```
select to_date(to_char(your_bc_date_here,'dd.mm.YYYY'), 'dd.mm.YYYY') + 1 from dual; 
```

This is a *wrong* cast because it does not considers year may be negative(*correct* would be `syyyy`)

I've tested with: `your_bc_date = to_date('BC 28.2.2011', 'BC dd.mm.yyyy')`

# ios - iphone5底部定位

> ID：14435543
> 
> 赞同：0
> 
> 时间：2013-01-21T09:18:59.927
> 
> 标签：ios, iphone-5

我在这里真的很困惑。我的数据选择器未正确定位在屏幕底部。3,5' 可以，但 4' 不行。我不能使用自动布局。我希望语言不会让你感到困惑。在这种情况下不相关。

**这是它在尺寸上的样子：自由形式** ![编辑器 - 尺寸：自由形式](../Images/37b1a42725448f99901f6439b0352074.png)

**这是编辑器的屏幕。尺寸：视网膜 4 全屏。其他设置未更改** ![编辑器 - 尺寸：Retina 4 Fullscreen](../Images/bb54f6b43894aff6442bca0ea8f10c27.png)

**最后。这就是它在 iphone5 模拟器上的实际外观** ![iphone5模拟器画面](../Images/f5ab128a92d42a16d7284c997e39eb8c.png)

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-12T10:12:05.443

尝试这个：

```
somecomponent.frame = cgrectmake(0,320,somecomponent.width,self.view.frame.size.height-(navbarheight+statusbarheight+tabbar height)) 
```

# android - Android ICS 检测网络丢失有延迟。有没有办法来解决这个问题？

> ID：14435545
> 
> 赞同：1
> 
> 时间：2013-01-21T09:19:03.600
> 
> 标签：android, networking, android-4.0-ice-cream-sandwich, connectivity, loss

当使用带有 ICS 的 Android 时，BroadcastReceiver 响应会有大约 3-4 秒的延迟。尽管我断开了 3G 和 wifi 的连接，但在 BroadcastReceiver onReceive 总是被调用之前发生了一个 http 请求，因此在 3-4 秒的持续时间内网络的状态并不清楚。

1.  这是 ICS deviced 的已知问题吗？

2.  有没有更好的方法来尽快了解网络变化？

谢谢

# javascript - 将ajax String数据转换为数组以更新ploty数据

> ID：14435547
> 
> 赞同：1
> 
> 时间：2013-01-21T09:19:10.887
> 
> 标签：javascript, ajax, playframework, jqplot

我正在尝试使用 Ajax 请求动态更新 jqplot 图表。我的服务器正在返回数据的字符串表示，如下所示：

**“[['果汁',30],['牛奶',30],['水',30]]”**

但是我需要将此字符串转换为数组数组。这是更新数据的正确方法吗？如果是，那么转换字符串的最佳方法是什么。

```
 $.ajax({
       url:'http://localhost',
       success:function(plotData){
       var data = plotData.split(","); 
         if(plot){
             plot.series[0].data = data;
             plot.redraw();
         }
       },
       fail:function(error){
          alert('error:'+error);         
       }
   }); 
```

此代码将转换为一维数组：

0：“[['Helpdesk'” 1：“30]” 2：“['用户'” 3：“30]” 4：“['自动生成'” 5：“30]]”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:44:35.900

为了转换一个字符串，你可能可以使用这个函数

```
var plotData = "[['Juice',30],['Milk',30],['Water',30]]";

function strToArr(str) {
//pattern that checks for '[', ']'
var patt=/[\[\]]/gi; 

//we replace the pattern with '' symbol
var tmp = str.replace(patt,'').split(',');

var result = []
for (var i = 0; i < tmp.length; i+=2) {
    //now all data is in one array, we have to putt in pairs
    result[i] = [ tmp[i], tmp[i+1] ]
}
return result;
}

console.log( strToArr(plotData) ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T10:00:58.900

您可以`eval("var x= " + plotData)`用作替代解决方案。[使用](http://24ways.org/2005/dont-be-eval/)[eval](https://stackoverflow.com/questions/197769/when-is-javascripts-eval-not-evil)几乎没有什么[危险](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/eval#Don.27t_use_eval.21) ，请在使用前仔细阅读。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T18:11:39.470

## 正确格式化您的数据

看起来您从服务器获得的响应应该是 JSON。但是，它不是有效的 json，因此被表示为字符串。

所需的更改非常简单，这是无效的 json：

```
[['Juice',30],['Milk',30],['Water',30]] 
```

这是有效的 json：

```
[["Juice",30],["Milk",30],["Water",30]] 
```

唯一的区别是引号。更改响应字符串，可能（取决于你在服务器端做什么）立即纠正`plotData`已经是 3 个数组的数组。

## 返回正确的内容类型

如果您尚未使用正确的 http 标头提供响应 - 确保响应提供为`application/json`，这当然是除了提供有效的 JSON 字符串之外。

## 强制解释为 json

要强制 jQuery 尝试将响应解析为 json - 您可以`dataType`显式设置：

```
$.ajax({
    ...
    dataType: 'JSON'
    ...
}); 
```

我不记得在没有服务器端修改的情况下这是多么严格。

## 使用 JSON.parse

或者，如果您只想按原样处理字符串；你可以*只*使用[JSON.parse](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse)：

```
input = "[['Juice',30],['Milk',30],['Water',30]]";
jsonString = input.replace(/'/g, '"'); // correct quotes as per point 1
result = JSON.parse(jsonString); 
```

然后结果将是一个包含 3 个数组的数组。

# ssl - 基于 HTTPS 的 JSONP

> ID：14435552
> 
> 赞同：2
> 
> 时间：2013-01-21T09:19:45.767
> 
> 标签：ssl, https, cross-domain, jsonp, cors

[是否可以通过 https 从域http://www.a.com](http://www.a.com)（不受我控制）向域 www.b.com（受我控制）发送 jsonp 请求？如果是这样，GET-Request 中的参数值是加密的还是以纯文本形式记录在 access-logs 中？

我正在寻找一种安全的方式来进行跨域请求。不幸的是，通过 CORS 请求/SSL 的 POST 语句不适用于 Internet Explorer。它不支持通过 Access-Control-Allow-Credentials 设置 cookie。有没有其他方法可以实现这个目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T15:24:36.913

对于问题的第二部分，HTTPS 只会加密请求用于传输数据的通道。一旦它到达 Web 服务器，所有请求参数将以纯文本形式记录在您的访问日志中。

您需要使用 POST 请求来防止将数据写入访问日志。但是，您不能在 POST 请求上使用 JSONP（无法使用标签发送 POST 请求）。

# java - Object.hashCode() 是 31 位有什么原因吗？

> ID：14435557
> 
> 赞同：21
> 
> 时间：2013-01-21T09:19:51.800
> 
> 标签：java, hashcode

如果您在 HotSpot Java 7 64 位版本上运行以下命令。

```
int countTopBit = 0, countLowestBit = 0;
for (int i = 0; i < 100000000; i++) {
    int h = new Object().hashCode();
    if (h < 0)
        countTopBit++;
    if ((h & 1) == 1)
        countLowestBit++;
}
System.out.println("The count of negative hashCodes was " + countTopBit + ", the count of odd hashCodes was " + countLowestBit); 
```

你可以得到类似的结果

```
The count of negative hashCodes was 0, the count of odd hashCodes was 49994232 
```

我想知道这是否意味着`Object.hashCode()`真的只有 31 位，为什么会这样？

* * *

并非不使用最高位。来自 HashMap 的来源

```
257   /**
258    * Applies a supplemental hash function to a given hashCode, which
259    * defends against poor quality hash functions.  This is critical
260    * because HashMap uses power-of-two length hash tables, that
261    * otherwise encounter collisions for hashCodes that do not differ
262    * in lower bits. Note: Null keys always map to hash 0, thus index 0.
263    */
264   static int hash(int h) {
265       // This function ensures that hashCodes that differ only by
266       // constant multiples at each bit position have a bounded
267       // number of collisions (approximately 8 at default load factor).
268       h ^= (h >>> 20) ^ (h >>> 12);
269       return h ^ (h >>> 7) ^ (h >>> 4);
270   } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-21T09:44:15.687

HotSpot 支持`Object`. 正如您根据经验发现的那样，在返回结果之前，最高位总是被屏蔽掉：

```
// src/share/vm/runtime/synchronizer.cpp
static inline intptr_t get_next_hash(Thread * Self, oop obj) {
   ...
   value &= markOopDesc::hash_mask;
   ...
   return value;
} 
```

`markOopDesc::hash_mask`计算如下：

```
 enum { age_bits                 = 4,
         lock_bits                = 2,
         biased_lock_bits         = 1,
         max_hash_bits            = BitsPerWord - age_bits - lock_bits - biased_lock_bits,
         hash_bits                = max_hash_bits > 31 ? 31 : max_hash_bits,
         ...
         hash_mask               = right_n_bits(hash_bits), 
```

如您所见，`markOopDesc::hash_mask`始终将第 31 位设置为零。

至于为什么这样做，你的猜测和我的一样好。最初的开发人员可能认为只处理正整数会简化事情。据我们所知，它甚至可能是`hash_bits`计算中的一个错误。;-)

# php - 获取查询字符串的值

> ID：14435561
> 
> 赞同：-3
> 
> 时间：2013-01-21T09:20:06.207
> 
> 标签：php, codeigniter-url

[http://www.example.com/ci_admin_jaspud/index.php/admin/add_member/id/7/created_sort/asc](http://www.example.com/ci_admin_jaspud/index.php/admin/add_member/id/7/created_sort/asc)

> 如何使用 codeigniter 获取上述 url 中多个查询字符串的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:21:53.637

URI 类会自动加载，您可以使用 segment() 方法检索数据

```
$this->uri->segment(4) 
```

得到 7

更多信息：[http ://ellislab.com/codeigniter/user-guide/libraries/uri.html](http://ellislab.com/codeigniter/user-guide/libraries/uri.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:22:10.970

尝试：

```
$this->load->library('uri');
echo $this->uri->segment(4); 
```

URI 类提供了帮助您从 URI 字符串中检索信息的函数。

[Codeigniter URI 类](http://ellislab.com/codeigniter/user-guide/libraries/uri.html)

# mysql - 如何使用动态用户名创建用户？

> ID：14435565
> 
> 赞同：1
> 
> 时间：2013-01-21T09:20:18.850
> 
> 标签：mysql

在 MySQL 脚本中，我想做这样的事情：

```
SET @username = CONCAT(DATABASE(), "-1@`%`");
CREATE USER @username; 
```

但我无法解决 CREATE USER 行中的语法错误。

有没有办法转义内联变量，以便 CREATE USER 可以拥有动态创建的用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T13:01:07.540

您可以使用[准备好的语句](http://dev.mysql.com/doc/refman/5.1/en/sql-syntax-prepared-statements.html)来做到这一点：

```
set @sql=concat("create user '", database(), "-haha", "'@'%' identified by 'whatever';");
prepare stmt from @sql;
execute stmt;
deallocate prepare stmt;

select @sql;

select * from mysql.user where user = 'playground-haha'; 
```

# entity-framework - 用现有的 TPT 声明 TPH（代码优先）

> ID：14435570
> 
> 赞同：0
> 
> 时间：2013-01-21T09:20:27.257
> 
> 标签：entity-framework, ef-code-first, tph

我有几个类继承了 1 个基本抽象类。它通过fluent API 映射到现有数据库（使用Table-Per-Concrete-Type，即未映射到任何表的基本抽象类）。

现在我想在我的代码中添加一些统计信息，对我来说最好的解决方案是对 3-4 个新类使用 TPH 方法。它可能继承也可能不继承与上述相同的类。

但我不知道如何指导 EF 对这 3-4 个类使用 TPH 方法。我是否需要添加带有鉴别器的正确表并且可以使用它？或者我需要通过流畅的 API 以某种方式指定它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:15:07.613

我发现。您不需要以某种方式指定要使用 TPH 的 EF。足以做到以下几点：

创建类层次结构

```
class Base { ... }
class Derived1 : Base { ... }
class Derived2 : Base { ... }
.......
class DerivedN : Base { ... } 
```

创建称为基本类型的表（否则不要忘记使用模型构建器对其进行映射），其中包含公共列（内容`Base`），并且每个派生类型中的每个公共属性都有一列。**添加“鉴别器”列**（`nvarchar(128)`，但我建议使用 varchar，除非您使用 unicode 类名称）。

在 DbContext 的继任者中仅添加一个 DbSet:`DbSet<Base> Data { get; set; }`并将其用于 CRUD 操作。

就这些！

# regex - 如果键与perl哈希中的正则表达式匹配，如何修改值？

> ID：14435572
> 
> 赞同：1
> 
> 时间：2013-01-21T09:20:29.830
> 
> 标签：regex, perl, hash

我有一个名为`%coins`. 如果散列的键与某个字符串匹配，我将尝试修改散列的值。我尝试了以下代码，但无法成功。它正在创建新密钥，而不是修改现有密钥的值。

请帮忙

```
#!/usr/bin/perl
use strict;
use warnings;
use Data::Dumper;

my %coins;
%coins = ( "abc" , 1,
          "mno pqr" , 2,
          "xyz",  3 );

print Dumper \%coins;

if(grep {/mno/} keys %coins)
{
    print"matched \n";
    $coins{$_} = s/$coins{$_}/new_val/g;
}

print Dumper \%coins; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T09:24:44.487

单程：

```
#!/usr/bin/perl
use strict;
use warnings;

use Data::Dumper;

my %coins;
%coins = ( "abc" , 1,
          "mno pqr" , 2,
          "xyz",  3 );

print Dumper \%coins;

my $newval=9;
foreach my $k (keys%coins){
        $coins{$k}=$1.$newval.$2 if ($k =~/(.*)mno(.*)/);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T11:03:24.267

首先，改变

```
if(grep {/mno/} keys %coins)
{
    ...
} 
```

到

```
for(grep {/mno/} keys %coins)
{
    ...
} 
```

至于价值，你想

```
( my $new_val = $_ ) =~ s/mno/new_value/g;
$coins{$_} = $new_val; 
```

或者

```
$coins{$_} = $_ =~ s/mno/new_value/gr;    # Perl 5.14+ 
```

# delphi - 如何在运行时更改界面语言？

> ID：14435576
> 
> 赞同：4
> 
> 时间：2013-01-21T09:20:44.967
> 
> 标签：delphi, localization, delphi-2010

我正在使用嵌入式 Delphi 2010 本地化工具，但找不到在运行时更改界面语言的方法。那么，如何在运行时更改界面语言？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T12:57:53.803

VCL 的设计方式不是让运行时语言切换变得容易。RichEdit 演示实际上是使用表单重新分配。这对于语言切换来说太强了，因为您将失去在运行时为表单所做的一切。

一些本地化工具已经实现了 VCL 的附加组件来实现运行时语言切换。有些人将组件与专有翻译数据一起使用来执行此操作。有些使用标准资源 DLL 和一些链接到应用程序的单元来执行语言切换。例如看看这个文件。它逐步描述了谁执行运行时语言切换，而无需重新分配表单，也不会丢失任何数据。

[http://www.sisulizer.com/translation/vcl/VCL.pdf](http://www.sisulizer.com/translation/vcl/VCL.pdf)

小心包含资源字符串的数组！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T09:45:37.307

请参阅 Demos\DelphiWin32\VCLWin32\RichEdit 目录中的 RichEdit 演示。

# url - 如何在 URL 中使用 RFC2822 格式日期？

> ID：14435577
> 
> 赞同：0
> 
> 时间：2013-01-21T09:20:48.900
> 
> 标签：url, get, rfc2822

如何将 RFC2822 格式的日期传递给 GET 方法中的 URL：

[例如，我想通过 URL https://www.xyz.com/orders](https://www.xyz.com/orders)中的 min_date_created 2013 年 1 月 18 日

RFC 格式的 2013 年 1 月 18 日 ==> 2013 年 1 月 18 日星期五 17:58:49 +0000

如何将其传递给 URL？

蒂亚！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:19:57.733

您可以将日期转换为自 1970 年 1 月 1 日午夜以来的毫秒数，而不是将日期作为字符串传递：

```
var time = new Date('Fri, 18 Jan 2013 17:58:49 +0000').getTime(); // 1358531929000
widow.location.href = 'https://www.xyz.com/orders?min_date_created='+time; 
```

这样您就不会遇到编码问题。

或者你也可以使用`encodeURIComponent()`, 参见[URL encode sees “&” （和）作为“&amp;” HTML 实体](https://stackoverflow.com/questions/3541711/javascript-url-encode)

# java - 在肥皂标题中添加 wsse:UsernameToken

> ID：14435580
> 
> 赞同：2
> 
> 时间：2013-01-21T09:21:12.950
> 
> 标签：java, web-services, soap, soap-client

我正在研究 SOAP 客户端。我的 WSDL URL 是`http://localhost:8080/soap/getMessage?wsdl`.

这需要以下标头来指定用户名和密码。

```
<wsdl:Envelope xmlns:soap="..."
        xmlns:wsse="..." >
       <wsdl:Header>
       <wsse:Security>
       <wsse:UsernameToken>
       <wsse:Username>admin</wsse:Username>
       <wsse:Password>password</wsse:Password>
       </wsse:UsernameToken>
       </wsse:Security>
       </wsdl:Header>
</wsdl:Envelope> 
```

我必须为它编写一个程序。

有人能帮我吗。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T10:26:33.463

这是我过去的肥皂程序。我已经根据您的情况对其进行了修改。

```
//create SOAP
        SOAPConnectionFactory sfc = SOAPConnectionFactory.newInstance();
        SOAPConnection connection = sfc.createConnection();

        SOAPMessage soapMessage = MessageFactory.newInstance().createMessage();
        SOAPPart soapPart = soapMessage.getSOAPPart();
        SOAPEnvelope soapEnvelope = soapPart.getEnvelope();

        SOAPBody soapBody = soapEnvelope.getBody();
        SOAPElement Header = soapBody.addBodyElement(new QName("Header"));

//attribute                     
        SOAPElement Security= Header.addChildElement(new QName("Security"));
        SOAPElement UsernameToken= Security.addChildElement(new QName("UsernameToken"));
        SOAPElement Username= UsernameToken.addChildElement(new QName("Username"));
        SOAPElement Password= UsernameToken.addChildElement(new QName("Password"));

//enter the username and password
Username.addTextNode("username");
Password.addTextNode("password");

//send the soap and print out the result
URL endpoint = "http://localhost:8080/soap/getMessage?wsdl";
        SOAPMessage response = connection.call(soapMessage, endpoint);

        ByteArrayOutputStream out = new ByteArrayOutputStream();
        String xml = "";
        try {
            response.writeTo(out);
            xml = out.toString("UTF-8");
        } catch (Exception e) 
        {
            System.out.println(""+e);
            //log.error(e.getMessage(),e);
        }         

System.out.println(""+xml); 
```

有关更多信息，您可以搜索谷歌在 JDK 1.6 中使用 SOAP

# c# - 一对多实体框架 5 更新代码优先

> ID：14435582
> 
> 赞同：0
> 
> 时间：2013-01-21T09:21:17.847
> 
> 标签：c#, asp.net-mvc-4, ef-code-first, entity-framework-ctp5

我有一个实体，我想更新而不更新它的许多实体列表。我使用 Code-First 但我无法让它工作......我使用 Ninject 并且除了我的更新之外一切正常......

//实体

```
public class A
{
public int AId { get; set; }
public string Name { get; set; }
}

public class B
{
public int BId { get; set; }
public string Name { get; set; }
public virtual List<A>ListOfAs { get; set; }
} 
```

//界面

```
private EFDbContext context = new EFDbContext();

public IQueryable<B> Bs
        {
            get { return context.B; }
        }

        public void SaveBs(B b)
    {
        if (b.Id== 0)
        {
            context.B.Add(b);
            context.SaveChanges();
        }

        *//here i wanna call: 
        context.Entity(b).State = EntityState.Modified;
        BUT VS dont let me... I probably missing something out...*

        context.SaveChanges(); 
```

当我只想将一个新对象添加到我的数据库时，Save 方法正在工作。但是更新不会改变任何东西......

如果有人能告诉我我错过了什么，我会很高兴......

/谢谢J

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T15:06:59.427

使用以下标准，这对我有用

```
public BuyerInformation Update(BuyerInformation objBuyerInformation)
    {
        context.BuyerInformation.Attach(objBuyerInformation);
        context.Entry(objBuyerInformation).State = EntityState.Modified;
        context.SaveChanges();

        return objBuyerInformation;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:25:36.377

```
if (b.Id== 0)
    {
        context.B.Add(b);
    }
else
   {
       context.B.Attach(b);
   }
   context.SaveChanges(); 
```

# node.js - Yeoman 加载页面非常缓慢

> ID：14435584
> 
> 赞同：0
> 
> 时间：2013-01-21T09:21:25.633
> 
> 标签：node.js, yeoman

我正在开发一个使用 Yeoman 的项目，它在我的机器上一直运行良好，直到最近对项目进行了一些更改（主要介绍了 Angular），而我已经有一个月没有工作了。

自从我回来后，每个页面加载都需要大约 2 分钟才能获取 HTML 和 JS 文件！cpu 在 30%-50% 之间，物理内存在 60% 左右，计算机状况良好。从事同一个项目的其他人正在获得非常快的加载时间..

会是什么？10倍！伊格尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T11:50:46.423

听起来问题就在你身边，因此我会删除整个混乱并再次检查，我假设你使用某种版本控制。

如果这不起作用，则可能是一些缓存问题 - 但目前的信息很难说。

你有什么其他人没有的吗？

我还会确保更新 Yeoman、Node.js 等。到最新版本，或者与您的同事一样。

为了获得额外的性能，您可以禁用 gruntfile 中的 force 选项，但是看到您项目中的其他人没有问题，这不应该对您的情况做任何事情。

# c# - C# 桌面应用程序不共享我的物理位置

> ID：14435585
> 
> 赞同：3
> 
> 时间：2013-01-21T09:21:33.353
> 
> 标签：c#, javascript, html

我正在尝试在 Web 应用程序中获取我当前的位置（纬度和经度），它适用于以下 HTML5 代码。

```
<!DOCTYPE html>
<html>
<body>
    <p id="demo">Click the button to get your coordinates:</p>
    <button onclick="getLocation()">Try It</button>
    <script>
        var x = document.getElementById("demo");
        function getLocation()
        {
            if (navigator.geolocation)
            {
                navigator.geolocation.getCurrentPosition(showPosition);
            }
            else
            {
                x.innerHTML = "Geolocation is not supported by this browser.";
            }
        }

        function showPosition(position)
        {
            x.innerHTML="Latitude: " + position.coords.latitude + 
                "<br>Longitude: " + position.coords.longitude;  
        }
    </script>
</body>
</html> 
```

但我想在桌面应用程序中获取用户的纬度和经度。桌面应用程序中没有使用 JavaScript 的选项，因此我尝试使用 Web 浏览器访问它。当我尝试使用 webbrowser 控件（IE10）从 dektop 应用程序访问上面创建的网页时，它不共享物理位置，并且当我通过按钮单击调用脚本时没有任何反应。

谁能帮我在桌面应用程序（C#）中获取我的位置（纬度和经度）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T11:59:26.483

我正在发布该问题的另一个答案，因为这涉及完全不同的方法。

**上下文**

当 JavaScript 尝试访问 IE 10 中的位置对象时，您会看到安全栏，要求您允许访问您的位置。位于本地驱动器或网络共享上的文件的区别在于，您不会看到始终允许访问的选项，而只能选择一次（*允许一次*）。

无论出于何种原因，此安全栏不会显示在`WebBrowser`控件中（即使我尝试为应用程序设置信息[*栏处理*](http://msdn.microsoft.com/en-us/library/ee330732%28v=vs.85%29.aspx#information_bar)`.exe`，但它似乎没有任何效果）。

这就是为什么每次执行脚本时，Web 浏览器控件中都不会发生任何事情。它实际上被信息栏挡住了。

**解决方案**

需要做什么：

1.  **模拟应用程序内部的 Web 服务器**。我使用了一个[简单的 C# Web 服务器](http://www.codehosting.net/blog/BlogEngine/post/Simple-C-Web-Server.aspx)类来提供内容。这样，即使本地机器上没有 Web 服务器，我们也可以拦截对特定 URL 地址和端口的请求，并提供我们想要的内容。

2.  **将`test1.html`文档添加到项目中并在服务器响应中使用它的内容**。只需将文件添加到您的项目中，在“Program.cs”文件旁边，并将其*Copy to Output Directory*属性值设置为*Copy always*。

**这个怎么运作**

首先，我们需要实例化一个 Web 浏览器控件。然后，导航到该`test1.html`文件。加载文档时，我们首先检查 Web 服务器是否未实例化。如果是这样，我们创建它的一个实例，然后我们读取 Web 浏览器的 HTMl 源并将其存储在`response`我们传递给`WebServer`构造函数的变量中。

将`http://localhost:9999`注册`HttpListener`到该前缀，因此对该地址的每个请求都将由我们的简单 Web 服务器提供服务。

接下来，我们导航到该地址。当 Web 服务器接收到请求时，它将传递变量的内容，该`_staticContent`变量的值在 Web 服务器的构造函数中分配。

服务器将文档传送到 Web 浏览器后，将`webBrowser1_DocumentCompleted`触发处理程序。但是这一次，我们已经有了 web 服务器的实例，所以执行通过`else`分支。需要注意的重要一点是，我们将异步等待 JavaScript 执行，获取位置并将其保存到`input`HTML 中的隐藏元素中。

**一个重要的**说明：第一次启动应用程序时，您不会获得任何位置。您首先必须让应用程序保持打开状态，以便您可以使用自定义 HTTP 侦听器，然后执行我在另一个[答案](https://stackoverflow.com/a/14455730/674700)中描述的步骤，浏览位置为 `http://localhost:9999`. 一旦你这样做，关闭并重新打开应用程序。

而已。每次运行应用程序时，您都会在消息框中获得位置坐标。

类`Form1`文件（*Form1.cs*）：

```
public partial class Form1 : Form
{

    WebServer _ws;
    WebBrowser _webBrowser1;

    public Form1()
    {
        InitializeComponent();
        _webBrowser1 = new WebBrowser();
        _webBrowser1.Visible = false;
        var location = Assembly.GetExecutingAssembly().Location;
        _webBrowser1.Navigate(System.IO.Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location) + @"\test1.html");
        _webBrowser1.DocumentCompleted += webBrowser1_DocumentCompleted;
    }

    private void Form1_Load(object sender, EventArgs e)
    {

    }

    async void webBrowser1_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
    {
        if (_ws == null)
        {
            var html = _webBrowser1.Document.GetElementsByTagName("html");
            var response = html[0].OuterHtml;
            _ws = new WebServer(response, "http://localhost:9999/");
            _ws.Run();
            _webBrowser1.Navigate("http://localhost:9999/");
        }
        else
        {
            string latitude = "";
            string longitude = "";

            await Task.Factory.StartNew(() =>
            {
                while (string.IsNullOrEmpty(latitude))
                {
                    System.Threading.Thread.Sleep(1000);

                    if (this.InvokeRequired)
                    {
                        this.Invoke((MethodInvoker)delegate
                        {
                            var latitudeEl = _webBrowser1.Document.GetElementById("latitude");
                            var longitudeEl = _webBrowser1.Document.GetElementById("longitude");

                            latitude = latitudeEl.GetAttribute("value");
                            longitude = longitudeEl.GetAttribute("value");
                        });
                    }
                }
            });
            MessageBox.Show(String.Format("Latitude: {0} Longitude: {1}", latitude, longitude));
        }
    }

    // credits for this class go to David
    // http://www.codehosting.net/blog/BlogEngine/post/Simple-C-Web-Server.aspx
    public class WebServer
    {
        private readonly HttpListener _listener = new HttpListener();
        static string _staticContent;

        public WebServer(string[] prefixes, string content)
        {
            _staticContent = content;
            foreach (string s in prefixes)
                _listener.Prefixes.Add(s);
            _listener.Start();
        }

        public WebServer(string content, params string[] prefixes)
            : this(prefixes,  content) { }

        public void Run()
        {
            ThreadPool.QueueUserWorkItem((o) =>
            {
                try
                {
                    while (_listener.IsListening)
                    {
                        ThreadPool.QueueUserWorkItem((c) =>
                        {
                            var ctx = c as HttpListenerContext;
                            try
                            {
                                byte[] buf = Encoding.UTF8.GetBytes(_staticContent);
                                ctx.Response.ContentLength64 = buf.Length;
                                ctx.Response.OutputStream.Write(buf, 0, buf.Length);
                            }
                            catch { } // suppress any exceptions
                            finally
                            {
                                // always close the stream
                                ctx.Response.OutputStream.Close();
                            }
                        }, _listener.GetContext());
                    }
                }
                catch { } // suppress any exceptions
            });
        }

        public void Stop()
        {
            _listener.Stop();
            _listener.Close();
        }
    }
} 
```

HTML 源代码 ( *test1.html* )

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <script type="text/javascript">
        window.onload = function () {
            var latitude = document.getElementById("latitude");
            var longitude = document.getElementById("longitude");

            function getLocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(showPosition);
                }
                else { }
            }
            function showPosition(position) {
                latitude.value = position.coords.latitude;
                longitude.value = position.coords.longitude;
            }
            getLocation();
        }
    </script>
</head>
<body>
    <input type="hidden" id="latitude" />
    <input type="hidden" id="longitude" />
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T09:55:08.660

发生这种情况的原因是该`WebBrowser`控件使用 Internet Explorer 早期版本的兼容模式。

您可以使用该功能为**每个应用程序**设置 Internet Explorer 的默认仿真模式。`FEATURE_BROWSER_EMULATION`这就是您`WebBrowser`在自己的应用程序中实际设置控件的兼容模式的方式。

您可以按照以下链接中的指示进行配置：

[互联网功能控制 (B..C)](http://msdn.microsoft.com/en-us/library/ee330730%28VS.85%29.aspx#browser_emulation)

**[更新]**

1.  转到 Internet 选项 -> 隐私
2.  在该`Location`部分下，确保`Never allow websites to request your physical location`未**选中**
3.  点击`Clear Sites`
4.  打开`Internet Explorer`（不是您的应用程序）并浏览到包含地理定位脚本的文件的 URL
5.  触发`getLocation()`功能（在您的情况下，单击`Try It`按钮）
6.  当浏览器在窗口下部显示包含 的安全栏时`yourSite wants to know your physical location.`，单击`Options for this site`并选择`Always allow`。

就是这样。

# visual-studio-2010 - Visual Studio 调试器 - 如何快速找到 long if 语句返回 false 的哪一部分

> ID：14435587
> 
> 赞同：0
> 
> 时间：2013-01-21T09:21:38.667
> 
> 标签：visual-studio-2010, debugging, javascript-debugger

我正在寻找一种快速方法来识别复杂 if 条件中的部分，这将导致整个条件返回 false。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T13:46:51.783

尝试反汇编视图。在 Visual Studio 中：调试 -> Windows -> 反汇编。一步一步运行，并尝试了解处理器的作用。

此外，如果您的“if”语句没有函数调用，您可以评估（在表达式评估窗口中）“if”语句的每个部分

# tinymce - Tyni MCE 路径未正确保存

> ID：14435588
> 
> 赞同：1
> 
> 时间：2013-01-21T09:21:45.960
> 
> 标签：tinymce

我在我的网站中嵌入了微型 mce 3.5.8，我用它来上传我的页面内容。当我添加图像的 url 时，它保存为“/upload/gree-forest-wallpaper.jpg”而不是“ ../admin/upload/gree-forest-wallpaper.jpg “。有什么问题？

# c++ - c++ 类构造函数自动将对象映射到事件处理程序

> ID：14435589
> 
> 赞同：1
> 
> 时间：2013-01-21T09:21:48.673
> 
> 标签：c++, pointers, linked-list, beagleboard, gpio

我目前正在为我的 beaglebone 做一个小项目。本质上，目标是创建一个框架，它提供了 c++ 的全部功能，而不是 beaglebone 的股票 javaScript 框架，但也像 arduino 框架一样易于开发人员使用。

我构建的其中一件事是针对不同类型的简单 GPIO 中断（如按钮、旋转编码器等）的预制类，因此开发人员只需定义一个按钮，并告诉它它连接的 beaglebone 上的哪个 GPIO 引脚。

现在我必须手动将中断对象的 pollInterupt() 函数添加到主循环中，以便程序可以反复检查中断 GPIO 引脚的状态。

**问题来了：**我想在按钮的类构造函数中添加代码，定义后会自动将自身传递给后台的中断处理程序，以重复运行新对象的 pollInterupt() 函数，因此开发人员永远不必这样做比定义按钮更复杂的事情。

不过，我似乎正在撞墙。试图让最终用户的框架变得简单，这意味着幕后的代码变得非常复杂。我能想到的自动处理定义的中断对象的最好方法是链接列表。这就是原型代码目前的样子。

```
#include <iostream>

class interuptButton;
class interuptHandler;

class interuptHandler{
    public:
        class node{
            public:
                node *next;
                node *prev;
            public:
                void *interupt;
        };

        node *first;
        node *last;
        node *current;
        node *temp;

public:
    interuptHandler(){
        first = new node;
        last  = new node;
        first -> prev = NULL;
        first -> next = last;
        last  -> prev = first;
        last  -> next = NULL;
    }
    void add(void *_interupt){
        temp = new node;

        current = last -> prev;
        current -> next = temp;
        temp    -> prev = current;
        temp    -> next = last;
        last    -> prev = temp;

        temp    -> interupt = _interupt;
    }
    void run(){
        current = first -> next;
        while(current -> next != NULL){
            std::cout << current -> interupt << std::endl;
//              std::cout << current -> interupt -> pin << std::endl;
//              current->interupt->pollInterupt();
//              std::cout << reinterpret_cast < interuptButton* > (current->interupt)->pin << std::endl;
            current = current -> next;
        }
    }
}handler;

class interuptButton{
public:
    int  pin;
    bool value;
public:
    interuptButton(int _pin){
        pin = _pin;
        handler.add(this);
    }
    void pollInterupt(){
        std::cout << "check pin " << pin << " to see if the GPIO has changed" << std::endl;
    }
};

int main(int argc, char **argv){

interuptButton buttonA(41);
interuptButton buttonB(45);
interuptButton buttonC(43);

handler.run();

return 0;
} 
```

系统似乎正在工作，interuptButton 构造函数成功地将新创建的对象传递给 interuptHandler 的链接列表，然后它可以在 run() 函数中打印内存地址并输出：

```
bin/./test
0x7fff5fbff9e0
0x7fff5fbff9d0
0x7fff5fbff9c0 
```

**问题是当我取消注释 run() 中的任何其他行时，我尝试访问指针对象的变量或函数，g++ 开始抛出错误。**

前两行返回：

```
src/main.cpp: In member function ‘void interuptHandler::run()’:
src/main.cpp:47: error: ‘void*’ is not a pointer-to-object type
make: *** [all] Error 1 
```

第三行返回：

```
src/main.cpp:49: error: invalid use of incomplete type ‘struct interuptButton’
src/main.cpp:4: error: forward declaration of ‘struct interuptButton’
make: *** [all] Error 1 
```

任何有关如何通过指针访问这些对象变量和函数的建议都将不胜感激。

更好的是，如果有人有更好的方法来自动将对象发送到幕后事件处理程序，我会全力以赴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:24:40.057

您是否需要开始将函数定义移动到 .cpp 文件中？看起来您在定义 interuptbutton 之前正在访问其内部。

或者因为它只是 1 个大的 .cpp 文件，您可以**在 main 之前****定义该`run`**函数来修复您的第二组错误。

第一个错误是不言自明的，也许您应该创建一个**Interrupt 接口**并保留指向它的指针，而不是 to `void*`? `reinterpret_cast`ing 只会让一切变得如此丑陋。

```
class IInterupt{
 // other stuff common to all interupt classes
    void pollInterupt() = 0; // pure virtual force all inheriting classes to implement.   
}

class interuptButton : public IInterupt{ //bla bla }

 class node{
        public:
            node *next;
            node *prev;
        public:
            IInterupt*interupt;
    }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:27:09.737

在`node`结构中，`interrupt`指针是一个指针，`void`这意味着它可以指向任何类型。但是，编译器不知道它指向什么，所以你必须通过类型转换告诉编译器它*真正*指向的类型：

```
reinterpret_cast<interuptButton*>(current->interrupt)->pollInterrupt(); 
```

至于另一个问题，你有一个循环依赖。班级`interruptHandler`取决于班级`interruptButton`，反之亦然。您必须通过分离一个或两个类的定义和实现来解决这个问题。最简单的方法是将`interruptButton`类定义放在定义之上`interruptHandler`，并将实现，即实际代码`interruptButton`放在`interruptHandler`类定义之后。

* * *

如果你想使用多个可中断的类，不仅仅是`interruptButton`类，你应该使用带有虚函数的继承和抽象基类。然后你就不需要`void`指针或类型转换：

```
struct baseIntertuptable
{
    virtual void pollInterrupt() = 0;
};

struct interruptHandler
{
private:
    struct node
    {
        // ...
        baseInterruptable* interrupt;
    };

public:
    void run()
    {
        // ...
        current->interrupt->pollInterrupt();
        // ...
    }
};

class interruptButton : public baseInterruptable
{
public:
    void pollInterrupt()
    {
        // ...
    }
}; 
```

这也应该解决您的类定义的循环依赖问题，因为抽象基类`baseInterruptable`现在在使用之前已完全定义，并且`interruptHandler`该类仅使用该类。

# matlab - 为什么 MATLAB deploytool 不能输出 exe 文件？

> ID：14435590
> 
> 赞同：4
> 
> 时间：2013-01-21T09:21:50.517
> 
> 标签：matlab, matlab-deployment

`deploytool`在使用 mbuild 创建 exe 文件之前运行良好，然后出现此错误：

```
Executing command: mbuild  -O -v -output "U1" -I"e:\Mat2009\work\ntst1\U1\src" "e:\Mat2009\work\ntst1\U1\src\U1_main.c" "e:\Mat2009\work\ntst1\U1\src\U1_delay_load.c" "e:\Mat2009\work\ntst1\U1\src\U1_mcc_component_data.c" -link exe  -env MCR_DELAYLOAD=/delayload:mclmcrrt710.dll -env 
MCR_DELAYLIB=delayimp.lib -outdir "e:\Mat2009\work\ntst1\U1\src" 

Error: An error occurred while shelling out to mbuild (error code = -1). 

Unable to build executable. 

??? Error using ==> mcc
Error executing mcc, return status = 1 (0x1). 
```

如何解决此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T11:17:20.053

***发现 COMSPEC env。var 有一个错误的值，所以我删除了错误的路径，重新启动了 MATLAB 然后它运行良好。***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T10:08:49.057

这个错误看起来类似于我曾经遇到的错误（升级到 2012b 之后），我不记得出处，但我找到了两个可能的解决方案：

1.  确保编译器路径中没有空格
2.  尝试构建几次并交叉手指

考虑到我的时间框架，我选择了选项二，经过 5-10 次尝试，它出人意料地奏效了。

# c - Mingw64 多重定义

> ID：14435592
> 
> 赞同：1
> 
> 时间：2013-01-21T09:21:53.760
> 
> 标签：c, multiple-definition-error, mingw-w64

我正在尝试使用代码块 ide 在 Windows 7 x64 机器上使用 mingw64 编译一个退出的大型 c 项目。我根据本教程为编译器进行了设置：http: [//blog.marc-o.org/2010/mingw64-unter-windows-mit-codeblocks](http://blog.marc-o.org/2010/mingw64-unter-windows-mit-codeblocks)

现在我得到了各种标准函数的多个定义错误。看这里：

```
multiple definition of `_Exit'|
multiple definition of `llabs'|
multiple definition of `atoll'|
multiple definition of `sinhf'|
multiple definition of `coshf'|
multiple definition of `tanhf'| 
```

等等。有谁知道我错过了什么？

PS：mingw32版本编译就好了。

# oracle - 如何将图片或图像插入oracle数据库？

> ID：14435594
> 
> 赞同：0
> 
> 时间：2013-01-21T09:21:55.760
> 
> 标签：oracle

```
<code>
 sql>CREATE TABLE Employees
     (
     Id int,
     Name varchar(50) not null,
     Photo varbinary(max) not null
     ) 
</code> 
```

此代码显示如下错误：photo varbinary(max) not null * ERROR at line 5: ORA-00907: missing right parenthesis 请帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:27:54.050

您应该使用[`BLOB (Binary Large Object)`](https://docs.oracle.com/cd/E11882_01/timesten.112/e21642/types.htm#TTSQL482)它来存储图像等多媒体内容的理想选择。

检查这个以[使用 BLOB 存储图像](https://docs.oracle.com/cd/B28359_01/appdev.111/b28845/ch7.htm#i1037547)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:50:17.367

您可以创建如下表并插入到表中，以下是该表的示例脚本

```
create table graphics_table (
  bfile_id number,
  bfile_desc varchar2(30),
  bfile_loc bfile,
  bfile_type varchar2(4));

INSERT INTO graphics_table
   VALUES(4,'April Book of Days Woodcut',bfilename('GIF_FILES','APRIL.JPG'),'JPEG');
INSERT INTO graphics_table
  VALUES(30,'',bfilename('GIF_FILES','SHAPIROS.GIF'),'GIF');

If u need more Info on this please refer to 

http://www.dba-oracle.com/t_storing_insert_photo_pictures_tables.htm 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-03-08T19:31:29.027

首先，已发布的问题是针对 SQL

varbinary(max) 是 sql2012 中的新数据类型

Cast f(x) 将用于将图像转换为二进制格式。

插入图像的插入查询是

插入员工值(1, 'ABC', cast('path\abc.jpeg') as varbinary(max));

# javascript - 带有 javascript 的中间 mousclick ( 没有 jQuery )

> ID：14435595
> 
> 赞同：2
> 
> 时间：2013-01-21T09:21:56.983
> 
> 标签：javascript

我正在使用[这个](https://stackoverflow.com/a/1803868/1488915)解决方案来隐藏中间 mousclick 上的 div，但现在我需要将它包含在一个没有 jQuery 可用的普通调试脚本中（而且永远不会）。

如何编写该事件并使用纯 JavaScript 绑定？

我正在搜索谷歌和 SO，但只有我得到的工作脚本，所有基于 jQuery 的。

* * *

最终代码：

```
<script type="text/javascript">
    function hideOnMiddle(event) {
        if ('which' in event) {
            if( event.which == 2 ) {
                document.getElementById('test').style.display = 'none'; 
            }
        }
    }
</script>
<div id="test" onmousedown="hideOnMiddle(event);">Hide me with middle mouse button</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:37:15.283

看看这个：[http](http://help.dottoro.com/ljwcseaq.php) ://help.dottoro.com/ljwcseaq.php （示例 HTML 代码 3）[（jsFiddle）](http://jsfiddle.net/DJDavid98/LUQ6t/)

```
<head>
    <script type="text/javascript">
        function WhichButton (event) {
                // all browsers except IE before version 9
            if ('which' in event) {
                switch (event.which) {
                case 1:
                    alert ("Left button is pressed");
                    break;
                case 2:
                    alert ("Middle button is pressed");
                    break;
                case 3:
                    alert ("Right button is pressed");
                    break;
                }
            }
            else {
                    // Internet Explorer before version 9
                if ('button' in event) {
                    var buttons = "";
                    if (event.button & 1) {
                        buttons += "left";
                    }
                    if (event.button & 2) {
                        if (buttons == "") {
                            buttons += "right";
                        }
                        else {
                            buttons += " + right";
                        }
                    }
                    if (event.button & 4) {
                        if (buttons == "") {
                            buttons += "middle";
                        }
                        else {
                            buttons += " + middle";
                        }
                    }
                    alert ("The following buttons are pressed: " + buttons);
                }
            }
        }
    </script>
</head>
<body>
    <div onmousedown="WhichButton (event);">Press a mouse button over this text!</div>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:35:44.160

在这种情况下需要做的第一件事是找出它是哪个鼠标单击。为此，我有一段使用 java 脚本的工作代码，您可以使用它。我在这里有的是，我已经用链接测试了鼠标事件，然后是一个文本框和一个提交事件。您可以将以下内容用于您自己的好处：

```
 <SCRIPT type="text/javascript">
    function captureButton(event)
    {
        var button;
        if (event.which == null)
           button= (event.button < 2) ? "MOUSE BUTTON : LEFT" :
                     ((event.button == 4) ? "MOUSE BUTTON : MIDDLE" : "MOUSE BUTTON : RIGHT");
        else
           button= (event.which < 2) ? "MOUSE BUTTON : LEFT" :
                     ((event.which == 2) ? "MOUSE BUTTON : MIDDLE" : "MOUSE BUTTON : RIGHT");
        alert(button);
        preventOperation(event);
    }
    function preventOperation(event)
    {
        if (event.preventDefault)
            event.preventDefault();
        else
            event.returnValue= false;
         return false;
    }
    </SCRIPT>

    <div><B>Link Testing : </B>
    <A onmouseup="return preventOperation(event)" oncontextmenu="return preventOperation(event)" onmousedown="return captureButton(event)" ondblclick="return preventOperation(event)" onclick="return preventOperation(event)" href="javascript:void(null)">Click here with various mouse buttons to test</A> </div><BR>
    <div>
    <B>Submit Event : </B>
    <INPUT onmouseup="return preventOperation(event)" oncontextmenu="return preventOperation(event)" onmousedown="return captureButton(event)" ondblclick="return preventOperation(event)" onclick="return preventOperation(event)" type=submit value="Submit Query" name=btnG> </div><BR>
    <div>
    <B>Text Box : </B>
    <INPUT onmouseup="return preventOperation(event)" oncontextmenu="return preventOperation(event)" onmousedown="return captureButton(event)" ondblclick="return preventOperation(event)" onclick="return preventOperation(event)" name=btnG>
     </div> 
```

我希望这个可以帮助您解决您的具体问题。

# php - echo 在正确文本前显示 1

> ID：14435596
> 
> 赞同：0
> 
> 时间：2013-01-21T09:21:58.510
> 
> 标签：php

当我注册用户时，其他一切都正常工作（它们被添加到数据库并发送激活电子邮件）但是我从“回声”返回的文本说“感谢注册”包括一个 1 在它的前面，我我一生都无法弄清楚为什么我在其他地方做同样的事情并且它工作正常，下面是我的代码：

```
if (empty($_POST) === false && empty($errors) === true) {
    $allow_email = ($_POST['allow_email'] == 'on') ? 1 : 0;
    echo $allow_email;
    $register_data = array(
        'username'    => $_POST['username'],
        'password'    => $_POST['password'],
        'first_name'  => $_POST['first_name'],
        'last_name'   => $_POST['last_name'],
        'email'       => $_POST['email'],
        'email_code'  => md5($_POST['username'] + microtime()),
        'allow_email' => $allow_email
    );

    register_user($register_data);
    echo 'You have been registered successfully! Please check your email';
    exit(); 
```

这就是我网站上显示的内容：

1您已注册成功！请查看你的邮箱

任何帮助将不胜感激，最亲切的问候，史蒂文

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:23:43.320

消除

```
echo $allow_email; 
```

它会导致问题。它显示 的值`$allow_email`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T09:23:50.883

在您提供的代码段的第三行 echo out `$allow_email`。

```
if (empty($_POST) === false && empty($errors) === true) {
    $allow_email = ($_POST['allow_email'] == 'on') ? 1 : 0;
    echo $allow_email; 
```

因为那显然没有你可以删除的意义`echo $allow_email;`。

# kendo-ui - Kendo UI + 继承字体

> ID：14435598
> 
> 赞同：1
> 
> 时间：2013-01-21T09:22:09.533
> 
> 标签：kendo-ui

我正在使用 Kendo ui dataviz 组件（饼图和折线图）。我需要使字体从主 div 继承。是否有任何属性可以将 kendo UI 的字体设置为“继承”，就像在 css 中一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T10:08:11.853

Kendo UI DataViz 在较新的浏览器中使用 SVG 作为图表，在旧的 IE（7 和 8）中使用 VML。您可以使用 CSS 更改文本字体，但不会影响 VML 部分。此外，不会更改 CSS，并且标签大小可能会损坏。

您最好使用图表提供的配置选项来更改字体 - [检查文档](http://docs.kendoui.com/api/dataviz/chart)并使用“字体”过滤器。

# android - 当 anyDensity="false" 时菜单列表消失

> ID：14435607
> 
> 赞同：4
> 
> 时间：2013-01-21T09:22:35.317
> 
> 标签：android, menu, android-actionbar, android-manifest

我正在寻找下一个问题的解决方案。

当我`android:anyDensity="false"`在标记中的清单文件中设置时 - 当我单击操作栏中的菜单时下拉的菜单列表会离开屏幕并且在屏幕内只显示一半的菜单项。Fi 如果我有“设置”菜单项，则只会显示“设置”。

这是屏幕：

![在此处输入图像描述](../Images/6547e82895add2c4442984844fb96c3f.png)

有谁能够帮我？我的安卓 4.0.4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T14:49:02.400

到目前为止，我发现的唯一答案是更改视图在布局中的位置，以便它可以找到显示空间:(

# php - 将数据放入#myModal popup Twitter Bootstrap

> ID：14435609
> 
> 赞同：0
> 
> 时间：2013-01-21T09:22:45.980
> 
> 标签：php, jquery, twitter-bootstrap, popup

它非常简单，但我没有看到解决方案。

如何在这个 twitter 引导弹出链接中放置一个 php var？

`<a href="#myModal" title="Lees meer" value="12345" data-toggle="modal">Read More</a>`

以及如何在弹出字段中获取并打印此链接的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:26:19.183

如果启用短标签：

```
<a 
    href="#myModal" 
    title="Lees meer" 
    value="12345" 
    data-toggle="modal" 
    data-phpvar="<?=$myVariable?>"
>
    Read More
</a> 
```

别的：

```
<a 
    href="#myModal" 
    title="Lees meer" 
    value="12345" 
    data-toggle="modal" 
    data-phpvar="<?php echo $myVariable; ?>"
>
    Read More
</a> 
```

*两者都为了可读性而缩进 - 不要在实际的 HTML 中这样做，它看起来很乱。*

并在 jQuery 中获取它 -*`.data("variable")`自动获取以下开头的属性`data-`*：

```
$("a[href=#myModal]").click(function() {
    alert($(this).data("phpvar"));
}); 
```

或使用`.attr`等价物：

```
$("a[href=#myModal]").click(function() {
    alert($(this).attr("data-phpvar"));
}); 
```

并以模态输出：

```
$("a[href=#myModal]").click(function() {
    var phpVariable = $(this).attr("data-phpvar");
    var modalObject = $($(this).attr("href"));
    modalObject.find(".modal-body").text(phpVariable); //You might also use .html()
}); 
```

[**代码工作的 JSFiddle 演示**](http://jsfiddle.net/ZHbRG/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T10:33:49.863

*非常感谢**h2ooooooo***

我启用了短标签，我将建立如下链接：

```
<a href="#myModal" 
   title="Bewerken" 
   role="button" 
   data-toggle="modal" 
   data-phpvar="<?php echo $value['i_id_pk'] . '||' . $value['c_user'] . '||'. $value['i_user_type_id_fk'];?>">
    <i class="icon-edit"></i>
</a> 
```

我使用 JQuery 将 data-phpvar 的值发送到#myModal 弹出窗口。我使用 OnClick 事件从 a href data-phpvar 中获取值。像这样：

```
<script>
    $("a[href=#myModal]").click(function() {
        var str = $(this).attr("data-phpvar");
        var substr = str.split('||');

        $("[name=user_id]").val(substr[0]);
        $("[name=c_chance_user_name]").val(substr[1]);
        $("[name=validation_c_user]").val(substr[1]);
        $("[name=c_chance_user_type]").val(substr[2]);

        $("span.userName").text(substr[1]);
    });
</script> 
```

它会起作用，但是，我可以让这段 JQuery 变得更短或更好吗？

最终我把值放在弹出框内的文本字段中的a href data-phpvar中。文本字段的名称必须与 JQuery 名称相同：

> $("[name=user_id]").val(substr[0]); 或 $("[name=c_chance_user_name]").val(substr [1](http://twitter.github.com/bootstrap/javascript.html#modals) );

弹出窗口中的 html 文本字段是这样的：

```
 <div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="myModalLabel">Wijzig gebruiker "<span class="userName"></span>"</h3>
        </div>
        <div class="modal-body">
             <input class="span3" id="appendedPrependedInput" type="text" name="c_chance_user_name" value="" minlength="3" required />
             <input class="span3" type="text" data-validation-match-match="c_chance_user_name" name="validation_c_user" minlength="3" required />
        </div>
        <div class="modal-footer">
             <button class="btn" data-dismiss="modal" aria-hidden="true">Sluiten</button>
             <button class="btn btn-success" name="chanceBtn"><li class="icon-ok-circle icon-white"></li> Opslaan</button>
        </div>
    </div> 
```

> [你可以在www.twitter.github.com/](http://twitter.github.com/bootstrap/javascript.html#modals)上找到这个弹出插件

# c++ - 为什么不编译尾随返回类型中的此运算符用法？

> ID：14435619
> 
> 赞同：18
> 
> 时间：2013-01-21T09:23:22.953
> 
> 标签：c++, c++11, operator-keyword, language-lawyer, trailing-return-type

我试图在另一个函数的尾随返回类型中重用运算符的返回类型，但不幸的是，clang 不接受它

```
struct A {
  int operator[](int);
  auto at(int i) -> decltype((*this)[i]);
}; 
```

Clang 说我的班级没有 operator[]。Gcc 确实接受了我的代码。我的代码实际上无效吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T09:44:40.313

看来，这是 CLang 的错误，因为下一个代码

```
struct A {
  int operator[](int);
  auto at(int i) -> decltype( this-> operator[]( i ) );
}; 
```

也由 CLang 编译 - [http://liveworkspace.org/code/2Myghk](http://liveworkspace.org/code/2Myghk) $6

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T10:33:57.997

由于 13.3.1.2p3（第一个项目符号），我会说 clang 是正确的。

> 对于具有`@`cv 非限定版本为 的类型的操作数的一元运算符，以及具有 cv 非限定版本为的类型的左操作数和 cv 非限定版本为的类型的右操作数`T1`的二元运算符，三个候选函数集、指定成员候选函数、非成员候选函数和内置候选函数的构造如下：`@``T1``T2`
> 
> *   如果`T1`是一个完整的类类型，则该成员候选集是 `T1::operator@`(13.3.1.1.1)的合格查找的结果；否则，***成员候选集为空***。

（@sehe 强调）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-21T10:18:02.083

只是为了重申我和斯蒂芬的评论：

**这是 clang 中的一个明显错误**，因为您的课程显然有一个`operator[](int)`.

使用的代码`decltype()`是否有效，是一个微妙的不同问题（我会说它是有效的，但不能证明它）。

# android - 硬件音量按钮在锁定的手机上不起作用

> ID：14435622
> 
> 赞同：1
> 
> 时间：2013-01-21T09:23:29.453
> 
> 标签：android, broadcastreceiver

我正在开发一个简单的应用程序，我在其中计算音量按钮按下 3 次。如果计数器等于 3，那么会发生一些动作。

我的问题是当我在手机锁定时按下硬件音量按钮时，不会调用`onReceive()`方法。`BroadcastReceiver`它在手机解锁时工作正常。

当我在锁定模式下按下音量增大按钮时，有什么方法或技巧可以让我的计数器增加，反之亦然。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T16:46:05.123

我对此进行了研究，结论是这是不可能的。

但是我以某种方式做到了，但这不是一个好方法，因为它会过多地消耗电池。

我以零音量在后台启动媒体播放器。现在，即使手机被锁定，音量键也开始工作。例如音乐应用程序，即使手机被锁定，音量按钮也能正常工作。

# android - 视频无法在我的 Android 应用中播放

> ID：14435623
> 
> 赞同：1
> 
> 时间：2013-01-21T09:23:32.623
> 
> 标签：android, flash, android-browser

为什么视频没有在我的应用程序中播放。

我开发了一个 android 应用程序，我用`mobile firefox browser`它来浏览它。现在，当我尝试播放视频时，它们将无法播放。

我对从我在我的应用程序中使用的浏览器的构建生成的**.apk**进行了同样的尝试，它工作正常。

*   对于 youtube 视频 - 它会打开网站并显示所有可用的视频，但不会播放它们。

*   对于 Foxnews.com - 它显示错误：不支持来源。

*   对于 facebook.com- 它说 Flash 播放器丢失。（但我的设备上安装了 Flash 播放器）。

我是否需要为我的应用授予任何特殊权限才能使用我设备上安装的 Flash 播放器。

我也收到此错误

```
ERROR/GeckoConsole(9981): [JavaScript Warning: "Expected declaration but found '*'.  Skipped to next declaration." {file: "http://m.youtube.com/?reload=5&rdm=mgsa03563#/watch?v=EZEgO1fngnE" line: 13}]
01-21 12:55:18.475: ERROR/GeckoConsole(9981): [JavaScript Warning: "Unknown property '-moz-border-radius'.  Declaration dropped." {file: "http://m.youtube.com/?reload=5&rdm=mgsa03563#/watch?v=EZEgO1fngnE" line: 13}] 
```

# android - 如何在填充布局时使用适配器

> ID：14435624
> 
> 赞同：10
> 
> 时间：2013-01-21T09:23:36.633
> 
> 标签：android, android-layout

我知道我想要成功可能很**奇怪。**

让我详细解释一下。首先，我想在 Activity 屏幕中使用两个 ListView。就像**Pinterest**的样子一样。（我不确定这是不是真的，但它被命名为**异构 gridview**。）我还需要实现一件事：**延迟加载**。我的活动中大约有**30 张图像**，因此一次获取所有图像并不好。这就是为什么我需要延迟加载。

所以首先，我思考了我如何获得那个外观，我的意思是异构网格视图。然后决定添加到`LinearLayout`一个`ScrollView`. 线性具有**垂直**方向。通过这种方法，我在线性布局中使用奇偶方法添加了我的新视图。

虽然没有任何适配器，但据我所知，无法控制显示哪些项目。所以懒加载是不合适的。

我也试过两个`ListView`，`Activity`但有一些滞后和同步滚动问题。另一方面，它的回收率很差。

所以在这种情况下，我想问有没有办法使用填充线性布局`Adapter`？或者你会推荐什么来创建一个异构的gridview，但也有延迟加载。

如果我的方法是错误的，我不会急于改变它。

任何线索对我来说都会很棒。如果有不清楚的地方，请说明。我将解释更多细节。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T06:52:05.593

经过大量研究，最后我找到了一个具有**延迟加载**和**异构网格视图**并且没有任何滚动或回收滞后/问题的库。

Maurycy 的**StaggeredGridView**完全是我想要的。

这是[图书馆](https://github.com/maurycyw/StaggeredGridView)，也有一个[演示](https://github.com/maurycyw/StaggeredGridViewDemo)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T10:03:01.847

如果我的问题正确，这就是您需要的：[http ://spinlist.autsia.com/](http://spinlist.autsia.com/)

# zend-framework - Zend File 多次上传，可访问单独的文件名

> ID：14435626
> 
> 赞同：0
> 
> 时间：2013-01-21T09:23:43.883
> 
> 标签：zend-framework, file-upload, zend-file

我将 Zend Framework 1.12 用于一些文件上传系统。并在一个表单中使用 Zend_File_Transfer_Adapter_Http，用于上传两个文件。这两个文件有两个表单元素。

```
$file1 = new Zend_Form_Element_File('file1');
// other options like setLabel etc.
$this->addElement($file1, 'file1');

$file2 = new Zend_Form_Element_File('file2');
// other options like setLabel etc.
$this->addElement($file2, 'file2'); 
```

我在我的控制器中处理上传过程，如下所示：

```
if ($request->isPost()) {
                    if ($form->isValid($request->getPost())) {

                        $adapter = new Zend_File_Transfer_Adapter_Http();
                        $adapter->setDestination($dirname);
                        $files = $adapter->getFileInfo();

                        foreach ($files as $file => $fileInfo) {

                            if (!$adapter->receive($file)) {
                                $messages = $adapter->getMessages();
                                echo implode("\n", $messages);
                            } else {
                                $location = $adapter->getFileName($file, true);
                                $filename = $adapter->getFileName($file, false);

                               // taking location and file names to save in database..
                            }
                        }
                    } 
```

有了这些，我可以管理两个文件的上传。但我不知道如何获取使用特定 Zend_Form_Element_File 上传的文件的位置。例如，我需要知道哪个文件上传到 $file1（表单中的元素），我会将其位置保存到数据库中的一个表中，以及哪个文件上传到 $file2 并将其位置保存到另一个表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T10:19:09.657

我不喜欢使用 Zend_File_Transfer_Adapter_Http。我更喜欢使用这样的代码：

在 application.ini 中：

```
data_tmp = APPLICATION_PATH "/../data/tmp" 
```

在引导程序中：

```
$options = $this->getOptions();
define('DATA_TMP', $options['data_tmp']); 
```

通知：

```
$elementFoo = new Zend_Form_Element_File('foo');
$elementFoo->setLabel('Upload File 1:')->setDestination(DATA_TMP);

$elementBar = new Zend_Form_Element_File('bar');
$elementBar->setLabel('Upload File 2:')->setDestination(DATA_TMP); 
```

在控制器中：

```
if ($request->isPost()) {
    if ($form->isValid($request->getPost())) {
       $values = $form->getValues();
       $filenameFoo = $values['foo'];
       $filenameBar = $values['bar'];
       //at this point you know the name of the individual filename
       $filePathFoo = DATA_TMP . DIRECTORY_SEPARATOR . $filenameFoo;
       $filePathBar = DATA_TMP . DIRECTORY_SEPARATOR . $filenameBar;
       //now you have even the physical path of the files

       // taking location and file names to save in database..
    }
} 
```

我的 2 美分。

# php - 使用 PHP PDO 创建搜索脚本

> ID：14435628
> 
> 赞同：1
> 
> 时间：2013-01-21T09:23:45.937
> 
> 标签：php, pdo

我花了很多时间研究如何做到这一点，但就是无法让它发挥作用:(

我有一个简单的“联系人” MySQL 数据库，其中包含一些记录的表 ( `id`, `first_name`, `last_name`, )。`email`

我想让用户选择他们的搜索词，即搜索`first_name`特定名称的“”列，或搜索“ `last_name`”列等。

我有一个简单的 HTML 表单，可以将用户数据发送到脚本。

无论如何，我的 PHP 脚本如下所示。当我运行 PHP 脚本时，我没有收到任何错误……只是我什么也没有得到……没有任何反应。

我将不胜感激您能提供的任何帮助。

```
<?php
try{
    $conn = new PDO('mysql:host=localhost; dbname=mydbname', 'user',   'pass');

}catch (PDOException $e){
    echo "Cannot connect to database";
    exit;
}

  $sql = 'SELECT first_name, last_name, email FROM mycontacts WHERE :searchtype LIKE   :searchterm';
  $searchtype = '%'. $_POST['searchtype'] .'%';
  $searchterm = '%'. $_POST['searchterm'] .'%';
  $stmt = $conn->prepare($sql);
  $stmt->bindParam(':searchtype', $searchtype, PDO::PARAM_STR);
  $stmt->bindParam(':searchterm', $searchterm, PDO::PARAM_STR);
  $stmt->bindColumn(1, $first_name);
  $stmt->bindColumn(2, $last_name);
  $stmt->bindColumn(3, $email);

   $stmt->execute();
  $numRows = $stmt->rowCount();

  echo "<p>Number of rows:".$numRows."</p>";

  if (isset($numRows)) { ?>
  <table>
  <tr>
  <th scope="col">First Name</th>
  <th scope="col">Last Name</th>
  <th scope="col">Email</th>
  </tr>
  <?php while ($stmt->fetch()) { ?>
  <tr>
   <td><?php echo $first_name; ?></td>
   <td><?php echo $last_name; ?></td>
   <td><?php echo $email; ?></td>
   </tr>
   <?php } ?>
   </table>
   <?php } ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T09:34:06.410

您需要实施*白名单*以从允许的字段中进行选择。
另请注意，必须使用 GET 方法而不是 POST 来实现搜索

```
$terms = array("last_name","first_name","etc");
if (in_array($_GET['searchtype'], $terms) {
    $field = $_GET['searchtype'];
}
$sql = "SELECT * FROM mycontacts WHERE `$field` LIKE :searchterm"; 
```

# image-processing - 使用 OpenCV 的脉冲、高斯和椒盐噪声

> ID：14435632
> 
> 赞同：32
> 
> 时间：2013-01-21T09:23:53.280
> 
> 标签：image-processing, opencv

我正在研究著名的[冈萨雷斯“数字图像处理”](https://rads.stackoverflow.com/amzn/click/com/013168728X)的图像处理，并谈论图像恢复，很多示例都是使用计算机生成的噪声（高斯、盐和胡椒等）完成的。在 MATLAB 中有一些内置函数可以做到这一点。那么 OpenCV 呢？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-01-21T11:49:29.230

据我所知，没有像 Matlab 这样方便的内置函数。但只需几行代码，您就可以自己创建这些图像。

例如加性高斯噪声：

```
Mat gaussian_noise = img.clone();
randn(gaussian_noise,128,30); 
```

椒盐噪声：

```
Mat saltpepper_noise = Mat::zeros(img.rows, img.cols,CV_8U);
randu(saltpepper_noise,0,255);

Mat black = saltpepper_noise < 30;
Mat white = saltpepper_noise > 225;

Mat saltpepper_img = img.clone();
saltpepper_img.setTo(255,white);
saltpepper_img.setTo(0,black); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2018-12-13T08:22:08.933

There is function [`random_noise()`](http://scikit-image.org/docs/stable/api/skimage.util.html#random-noise) from the scikit-image package. It has several builtin noise patterns, such as `gaussian`, `s&p` (for salt and pepper noise), `possion` and `speckle`.

Below I show an example of how to use this method

```
from PIL import Image
import numpy as np
from skimage.util import random_noise

im = Image.open("test.jpg")
# convert PIL Image to ndarray
im_arr = np.asarray(im)

# random_noise() method will convert image in [0, 255] to [0, 1.0],
# inherently it use np.random.normal() to create normal distribution
# and adds the generated noised back to image
noise_img = random_noise(im_arr, mode='gaussian', var=0.05**2)
noise_img = (255*noise_img).astype(np.uint8)

img = Image.fromarray(noise_img)
img.show() 
```

[![enter image description here](../Images/bc5d2eb0255a4fc4943979de94ec3fdc.png)](https://i.stack.imgur.com/sUjcs.png)

There is also a package called [imgaug](https://github.com/aleju/imgaug) which are dedicated to augment images in various ways. It provides gaussian, poissan and salt&pepper noise augmenter. Here is how you can use it to add noise to image:

```
from PIL import Image
import numpy as np
from imgaug import augmenters as iaa

def main():
    im = Image.open("bg_img.jpg")
    im_arr = np.asarray(im)

    # gaussian noise
    # aug = iaa.AdditiveGaussianNoise(loc=0, scale=0.1*255)

    # poisson noise
    # aug = iaa.AdditivePoissonNoise(lam=10.0, per_channel=True)

    # salt and pepper noise
    aug = iaa.SaltAndPepper(p=0.05)

    im_arr = aug.augment_image(im_arr)

    im = Image.fromarray(im_arr).convert('RGB')
    im.show()

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-06-03T15:31:09.947

> 向图像添加高斯、椒盐散斑和泊松噪声的简单函数

```
Parameters
----------
image : ndarray
    Input image data. Will be converted to float.
mode : str
    One of the following strings, selecting the type of noise to add:

    'gauss'     Gaussian-distributed additive noise.
    'poisson'   Poisson-distributed noise generated from the data.
    's&p'       Replaces random pixels with 0 or 1.
    'speckle'   Multiplicative noise using out = image + n*image,where
                n,is uniform noise with specified mean & variance.

import numpy as np
import os
import cv2

def noisy(noise_typ,image):

if noise_typ == "gauss":
        row,col,ch= image.shape
        mean = 0
        #var = 0.1
       #sigma = var**0.5
        gauss = np.random.normal(mean,1,(row,col,ch))
        gauss = gauss.reshape(row,col,ch)
        noisy = image + gauss
        return noisy
    elif noise_typ == "s&p":
        row,col,ch = image.shape
        s_vs_p = 0.5
        amount = 0.004
        out = image
        # Salt mode
        num_salt = np.ceil(amount * image.size * s_vs_p)
        coords = [np.random.randint(0, i - 1, int(num_salt))
                  for i in image.shape]
        out[coords] = 1

        # Pepper mode
        num_pepper = np.ceil(amount* image.size * (1\. - s_vs_p))
        coords = [np.random.randint(0, i - 1, int(num_pepper))
                  for i in image.shape]
        out[coords] = 0
        return out
    elif noise_typ == "poisson":
        vals = len(np.unique(image))
        vals = 2 ** np.ceil(np.log2(vals))
        noisy = np.random.poisson(image * vals) / float(vals)
        return noisy
    elif noise_typ =="speckle":
        row,col,ch = image.shape
        gauss = np.random.randn(row,col,ch)
        gauss = gauss.reshape(row,col,ch)        
        noisy = image + image * gauss
        return noisy 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-04-08T08:42:12.657

可以使用 NumPy 矩阵运算以非常简单的方式添加“Salt & Pepper”噪声。

```
def add_salt_and_pepper(gb, prob):
    '''Adds "Salt & Pepper" noise to an image.
    gb: should be one-channel image with pixels in [0, 1] range
    prob: probability (threshold) that controls level of noise'''

    rnd = np.random.rand(gb.shape[0], gb.shape[1])
    noisy = gb.copy()
    noisy[rnd < prob] = 0
    noisy[rnd > 1 - prob] = 1
    return noisy 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-10-21T06:09:45.877

```
# Adding noise to the image    

import cv2
import numpy as np
import matplotlib.pyplot as plt
%matplotlib inline

img = cv2.imread('./fruit.png',0)
im = np.zeros(img.shape, np.uint8) # do not use original image it overwrites the image
mean = 0
sigma = 10
cv2.randn(im,mean,sigma) # create the random distribution
Fruit_Noise = cv2.add(img, im) # add the noise to the original image
plt.imshow(Fruit_Noise, cmap='gray') 
```

The values of mean and sigma can be altered to bring about a specific change in noise like gaussian or pepper-salt noise etc. You can use either randn or randu according to the need. Have a look at the documentation: [https://docs.opencv.org/2.4/modules/core/doc/operations_on_arrays.html#cv2.randu](https://docs.opencv.org/2.4/modules/core/doc/operations_on_arrays.html#cv2.randu)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-08-14T06:54:12.863

I made some change of @Shubham Pachori 's code. When reading a image into numpy arrary, the default dtype is uint8, which can cause wrapping when adding noise onto the image.

```
import numpy as np
from PIL import Image

"""
image: read through PIL.Image.open('path')
sigma: variance of gaussian noise
factor: the bigger this value is, the more noisy is the poisson_noised image

##IMPORTANT: when reading a image into numpy arrary, the default dtype is uint8,
which can cause wrapping when adding noise onto the image. 
E.g,  example = np.array([128,240,255], dtype='uint8')
     example + 50 = np.array([178,44,49], dtype='uint8')
Transfer np.array to dtype='int16' can solve this problem.
"""

def gaussian_noise(image, sigma):
    img = np.array(image)
    noise = np.random.randn(img.shape[0], img.shape[1], img.shape[2])
    img = img.astype('int16')
    img_noise = img + noise * sigma
    img_noise = np.clip(img_noise, 0, 255)
    img_noise = img_noise.astype('uint8')
    return Image.fromarray(img_noise)

def poisson_noise(image, factor):
    factor = 1 / factor
    img = np.array(image)
    img = img.astype('int16')
    img_noise = np.random.poisson(img * factor) / float(factor)
    np.clip(img_noise, 0, 255, img_noise)
    img_noise = img_noise.astype('uint8')
    return Image.fromarray(img_noise) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-15T00:29:23.153

[http://scikit-image.org/docs/dev/api/skimage.util.html#skimage.util.random_noise](http://scikit-image.org/docs/dev/api/skimage.util.html#skimage.util.random_noise)

```
skimage.util.random_noise(image, mode='gaussian', seed=None, clip=True, **kwargs) 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-02-06T11:12:28.507

```
#Adding noise
[m,n]=img.shape
saltpepper_noise=zeros((m, n));
saltpepper_noise=rand(m,n); #creates a uniform random variable from 0 to 1 
for i in range(0,m):
    for j in range(0,n):
        if saltpepper_noise[i,j]<=0.5:
            saltpepper_noise[i,j]=0
        else:
            saltpepper_noise[i,j]=255 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2018-03-29T07:50:05.360

although there is no built-in functions like in matlab `imnoise(image,noiseType,NoiseLevel)` but we can easily add required amount random valued impulse noise or salt and pepper into an image manually.

1.  to add random valued impulse noise.

    ```
    import random as r
    def addRvinGray(image,n): # add random valued impulse noise in grayscale 
        '''parameters: 
             image: type=numpy array. input image in which you want add noise.
             n:  noise level (in percentage)'''
        k=0                  # counter variable 
        ih=image.shape[0]    
        iw=image.shape[1]
        noisypixels=(ih*iw*n)/100      # here we calculate the number of pixels to be altered.

        for i in range(ih*iw):
            if k<noisypixels:
                    image[r.randrange(0,ih)][r.randrange(0,iw)]=r.randrange(0,256) #access random pixel in the image gives random intensity (0-255)              
                k+=1
            else:
                break
        return image 
    ```

2.  to add salt and pepper noise

    ```
    def addSaltGray(image,n): #add salt-&-pepper noise in grayscale image

        k=0
        salt=True
        ih=image.shape[0]
        iw=image.shape[1]
        noisypixels=(ih*iw*n)/100

        for i in range(ih*iw):
             if k<noisypixels:  #keep track of noise level
                 if salt==True:
                         image[r.randrange(0,ih)][r.randrange(0,iw)]=255
                         salt=False
                 else:
                         image[r.randrange(0,ih)][r.randrange(0,iw)]=0
                         salt=True
                 k+=1
             else:
                 break
        return image 
    ```

Note: for color images: first split image in to three or four channels depending on the input image using opencv function:

```
(B, G, R) = cv2.split(image)
(B, G, R, A) = cv2.split(image) 
```

after spliting perform the same operations on all channels. at the end merge all the channels:

```
merged = cv2.merge([B, G, R])
return merged 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2022-02-07T12:52:04.447

```
def add_salt_noise(src, ratio: float = 0.05, noise: list = [0, 0, 0]):
    dst = src.copy()
    import random
    shuffle_dict = {}
    i = 0
    while i < (int(dst.shape[0]*dst.shape[1] * ratio)):
        x, y = random.randint(0, dst.shape[0] - 1), random.randint(0, dst.shape[1] - 1)
        if (x, y) in shuffle_dict:
            continue
        else:
            dst[x, y] = noise
            shuffle_dict[(x, y)] = 0
            i += 1
    return dst 
```

# mysql - mySql减去不同表的行

> ID：14435635
> 
> 赞同：0
> 
> 时间：2013-01-21T09:23:58.127
> 
> 标签：mysql, subtraction

我想在不同表的两行之间减去：

我创建了一个`view`被调用的`leave_taken`和`table`被调用的`leave_balance`。

我想从两个表中得到这个结果：

```
leave_taken.COUNT(*) - leave_balance.balance 
```

并分组`leave_type_id_leave_type`

**两个表的代码**

-----------------查看 Leave_Taken------------

```
CREATE ALGORITHM = UNDEFINED DEFINER=`1`@`localhost` SQL SECURITY DEFINER 
VIEW `leave_taken` 
AS 
   select 
     `leave`.`staff_leave_application_staff_id_staff` AS `staff_leave_application_staff_id_staff`,
     `leave`.`leave_type_id_leave_type` AS `leave_type_id_leave_type`,
     count(0) AS `COUNT(*)` 
   from 
   (
      `leave` 
      join `staff` on((`staff`.`id_staff` = `leave`.`staff_leave_application_staff_id_staff`))
   ) 
   where (`leave`.`active` = 1) 
   group by `leave`.`leave_type_id_leave_type`; 
```

------表leave_balance----------

```
CREATE TABLE IF NOT EXISTS `leave_balance` (
  `id_leave_balance` int(11) NOT NULL AUTO_INCREMENT,
  `staff_id_staff` int(11) NOT NULL,
  `leave_type_id_leave_type` int(11) NOT NULL,
  `balance` int(3) NOT NULL,
  `date_added` date NOT NULL,
  PRIMARY KEY (`id_leave_balance`),
  UNIQUE KEY `id_leave_balance_UNIQUE` (`id_leave_balance`),
  KEY `fk_leave_balance_staff1` (`staff_id_staff`),
  KEY `fk_leave_balance_leave_type1` (`leave_type_id_leave_type`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=3 ; 
```

------- 餐桌休假 ----------

```
CREATE TABLE IF NOT EXISTS `leave` (
  `id_leave` int(11) NOT NULL AUTO_INCREMENT,
  `staff_leave_application_id_staff_leave_application` int(11) NOT NULL,
  `staff_leave_application_staff_id_staff` int(11) NOT NULL,
  `leave_type_id_leave_type` int(11) NOT NULL,
  `date` date NOT NULL,
  `active` int(11) NOT NULL DEFAULT '1',
  `date_updated` date NOT NULL,
  PRIMARY KEY (`id_leave`,`staff_leave_application_id_staff_leave_application`,`staff_leave_application_staff_id_staff`),
  KEY `fk_table1_leave_type1` (`leave_type_id_leave_type`),
  KEY `fk_table1_staff_leave_application1` (`staff_leave_application_id_staff_leave_application`,`staff_leave_application_staff_id_staff`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=32 ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T17:43:16.250

好吧，我仍然认为你没有提供足够的信息。拥有一些示例数据和您的预期输出（以表格格式）将**非常有帮助。**也就是说，我可能有一些你可以开始使用的东西。此查询查找所有员工，计算他们当前的休假（按类型分组），并根据休假类型确定其与余额之间的差异。看看它，更重要的是（也许）我[在这里使用的 sqlfiddle](http://sqlfiddle.com/#!2/bc8fb/24)，其中包含示例数据（对于确定这是否是您的数据的正确路径非常重要）。

```
SELECT
    staff.id_staff,
    staff.name,
    COUNT(`leave`.id_leave) AS leave_count,
    leave_balance.balance,
    (COUNT(`leave`.id_leave) - leave_balance.balance) AS leave_difference,
    `leave`.leave_type_id_leave_type AS leave_type
  FROM
    staff
    JOIN `leave` ON staff.id_staff = `leave`.staff_leave_application_staff_id_staff
    JOIN leave_balance ON
      (
        staff.id_staff = leave_balance.staff_id_staff
        AND `leave`.leave_type_id_leave_type = leave_balance.leave_type_id_leave_type
      )
  WHERE 
    `leave`.active = 1
  GROUP BY
    staff.id_staff, leave_type; 
```

祝你好运！

# javascript - jAlert 没有在 IE 中调用

> ID：14435636
> 
> 赞同：0
> 
> 时间：2013-01-21T09:24:08.467
> 
> 标签：javascript, jquery, jquery-ui

我通过在键盘中输入回车键来验证文本框。验证工作正常，但没有显示 JAlert。但是当我在按钮上调用相同的功能时单击它会在 IE 中显示警报。我对此完全感到困惑。谁能帮我？[演示](http://jsfiddle.net/BpacU/)

```
function isEnterPressed(event) {
        var keynum;
        if (window.event) {
            keynum = event.keyCode;
        }else if (event.which) {
            keynum = event.which;
        }
        if(keynum == 13) {
            searchSubmit();
        }
    } 
```

searchSubmit() 也是按钮单击时的函数调用

```
function searchSubmit()
{
    // some valdation
  if(!flag) 
    {
    alert('flag'+flag);
    jAlert("Enter anyone of the value to search");
    return false;  
    }else{
    document.userManagementUsers.action=baseUrl;
    document.userManagementUsers.submit();
    }
 } 
```

alert('flag'+flag) 通过点击回车键显示 jalert 未执行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:30:11.310

你有没有尝试过这样的事情？

```
$('body').jAlert('Enter anyone of the value to search', 'success'); 
```

或者

```
$(document).ready(function() {
  $('body').jAlert('Enter anyone of the value to search', "success");
}); 
```

# java - 检测 JAXB 循环错误的行/代码

> ID：14435640
> 
> 赞同：0
> 
> 时间：2013-01-21T09:24:14.870
> 
> 标签：java, jaxb, jersey

我正在做一个使用 JAX-RS 和 JPA 的项目，实体类是使用 Netbeans 生成的，因为这些类太大并且发生了生成的循环错误。

我的问题是有没有办法检测循环错误的违规代码/行？JAX-B 错误消息不是那么具体。

# gwt - eclipse新建gwt项目时抛出异常

> ID：14435643
> 
> 赞同：2
> 
> 时间：2013-01-21T09:24:23.707
> 
> 标签：gwt, google-plugin-eclipse

我是 GWT 的新手，我开始通过 gwt2.4 学习它。首先，我安装了eclipse插件，之后，我看到了eclipse工具栏中的图标。

![在此处输入图像描述](../Images/0922df8dada2bf3723ada98e5ad28fbb.png)

**当我单击新建 Web 应用程序项目时，它报告了一个异常。详细的堆栈跟踪如下。**

eclipse.buildId=M20110909-1335 java.version=1.6.0_33 java.vendor=Sun Microsystems Inc. BootLoader 常量：OS=win32, ARCH=x86, WS=win32, NL=en_US 框架参数：-product org.eclipse.epp .package.java.product 命令行参数：-os win32 -ws win32 -arch x86 -product org.eclipse.epp.package.java.product

错误 Mon Jan 21 17:18:28 CST 2013 未处理的事件循环异常

java.lang.NoClassDefFoundError: com/google/gdt/eclipse/platform/shared/ui/IPixelConverter 在 com.google.gdt.eclipse.suite.actions.NewWebAppToolbarHandler.execute(NewWebAppToolbarHandler.java:27) 在 org.eclipse.ui .internal.handlers.HandlerProxy.execute(HandlerProxy.java:293) 在 org.eclipse.core.commands.Command.executeWithChecks(Command.java:476) 在 org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(ParameterizedCommand.java :508) 在 org.eclipse.ui.internal.handlers.SlaveHandlerService.executeCommand(SlaveHandlerService.java:241) 在 org.eclipse. ui.menus.CommandContributionItem.handleWidgetSelection(CommandContributionItem.java:829) at org.eclipse.ui.menus.CommandContributionItem.access$19(CommandContributionItem.java:815) 在 org.eclipse.ui.menus.CommandContributionItem$5.handleEvent(CommandContributionItem.java:805) 在 org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) 在 org.eclipse.swt。 widgets.Widget.sendEvent(Widget.java:1053) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4165) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3754)在 org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2696) 在 org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2660) 在 org.eclipse.ui.internal.Workbench.access $4(Workbench.java:2494) at org.eclipse.ui.internal.Workbench $7.run(Workbench.java:674) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:667) 在 org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) 在 org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:123) 在 org.eclipse.equinox.internal.app.EclipseAppHandle。在 org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher. java:79) 在 org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344) 在 org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) 在 sun.reflect .NativeMethodAccessorImpl.invoke0(Native Method) 在 sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) 在 java.lang.reflect。Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:622) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:577) at org.eclipse。 equinox.launcher.Main.run(Main.java:1410) 引起：java.lang.ClassNotFoundException: com.google.gdt.eclipse.platform.shared.ui.IPixelConverter at org.eclipse.osgi.internal.loader.BundleLoader .findClassInternal(BundleLoader.java:513) 在 org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:429) 在 org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:417) ) at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:107) at java.lang.ClassLoader.loadClass(Unknown Source) ... 33 更多java:622) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:577) at org.eclipse.equinox.launcher.Main.run(Main.java:1410) 原因：java.lang.ClassNotFoundException : com.google.gdt.eclipse.platform.shared.ui.IPixelConverter 在 org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:513) 在 org.eclipse.osgi.internal.loader.BundleLoader。 findClass(BundleLoader.java:429) 在 org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:417) 在 org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:107)在 java.lang.ClassLoader.loadClass(Unknown Source) ... 33 更多java:622) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:577) at org.eclipse.equinox.launcher.Main.run(Main.java:1410) 原因：java.lang.ClassNotFoundException : com.google.gdt.eclipse.platform.shared.ui.IPixelConverter 在 org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:513) 在 org.eclipse.osgi.internal.loader.BundleLoader。 findClass(BundleLoader.java:429) 在 org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:417) 在 org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:107)在 java.lang.ClassLoader.loadClass(Unknown Source) ... 33 更多com.google.gdt.eclipse.platform.shared.ui.IPixelConverter 在 org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:513) 在 org.eclipse.osgi.internal.loader.BundleLoader.findClass (BundleLoader.java:429) 在 org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:417) 在 org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:107) 在java.lang.ClassLoader.loadClass(Unknown Source) ... 33 更多com.google.gdt.eclipse.platform.shared.ui.IPixelConverter 在 org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:513) 在 org.eclipse.osgi.internal.loader.BundleLoader.findClass (BundleLoader.java:429) 在 org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:417) 在 org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:107) 在java.lang.ClassLoader.loadClass(Unknown Source) ... 33 更多baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:107) at java.lang.ClassLoader.loadClass(Unknown Source) ... 33 更多baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:107) at java.lang.ClassLoader.loadClass(Unknown Source) ... 33 更多

我不知道它是怎么发生的，我尝试了两种安装 gwt 插件的方法。一种是使用链接文件，另一种是把对应的文件放到plugins和features目录下。但报告了同样的异常。

为什么无法创建该类，我在plugins目录中搜索，在名为**com.google.gdt.eclipse.platform.shared_3.1.3.v201212122040-rel-r37.jar**的jar中找到了这个类。

谁能帮忙，万分感谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T03:47:14.713

清除您的 Eclipse 安装和工作区。下载 eclipse zip 文件并重新开始。

不要使用 Eclipse 的卸载插件功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-04T18:30:54.427

我上面有同样的问题，现在它接缝问题已经解决了。

我的问题是：“未处理的事件循环异常”错误发生错误。有关详细信息，请参阅错误日志。com/google/gdt/eclipse/platform/shared/ui/IPixelConverter。

解决方案：您需要安装或重新安装“Jetty-9 Bundles Composite Repository” - [http://download.eclipse.org/jetty/updates/jetty-bundles-9.x](http://download.eclipse.org/jetty/updates/jetty-bundles-9.x) 仅清单：Jetty - 捆绑包：所有码头捆绑包。重启日食

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-24T21:36:23.933

当我为我的 Eclipse 版本安装了错误的 Google 插件版本时，我收到了这个错误，即我按照 Google 文档安装了 3.7 插件，但我的 Eclipse 是 4.3 版本。

修复起来很简单：从可用软件站点中删除 3.7 plu-ing URL，并为我的 Eclipse 版本添加适当的 URL（在本例中为 4.3 - [https://dl.google.com/eclipse/plugin/4.3](https://dl.google.com/eclipse/plugin/4.3)）。

# sharepoint - Sharepoint Foundation 2010 与 AD 同步

> ID：14435644
> 
> 赞同：1
> 
> 时间：2013-01-21T09:24:28.280
> 
> 标签：sharepoint, active-directory

我们在 AD 中创建了几个全局安全组，我们将域用户作为成员关联到这些安全组。

我们的目标是促进对我们所有网站开发 Sharepoint 的访问权限和权限的管理。

我们遇到以下问题。

在站点权限中的 sharepoint 站点上，当我们第一次从 AD 添加全局安全组时：它运行良好。

该组的所有成员都被我们的共享点正确识别，并拥有我们赋予安全组 AD 的所有权利。

之后，如果我们这样做，我们在 AD 中的安全组的任何更改：在 SharePoint 中都不会考虑在内。

例如，如果我们在组 AD 中添加或删除成员：SharePoint 不会收到更改通知。

如果我们决定重命名安全组的名称，同样的问题

我们尝试使用 PowerShell 命令强制与 AD 同步

例子：

```
Set-SPUser-identity "mydomain\usertest" http://devweb01 -web-syncfromad 
```

此命令非常适合同步域用户，但如果我们尝试同步安全组则不起作用。

如果我们在域安全组上尝试此命令，我们会收到以下错误：

```
Set-SPUser: Unable to get the full name or e-mail address
user "mydomain \ usertest."
At line: 1 char: 11
+ Set-SPUser <<<<-identity $ user-web-http://devweb01 syncfromad
+ CategoryInfo: invalidData (Microsoft.Share ... SPCmdletSetUser:
SPCmdletSetUser) [Set-SPUser] SPException
+ FullyQualifiedErrorId: Microsoft.SharePoint.PowerShell.SPCmdletSetUser 
```

为什么 SharePoint Fundation 不会自动与 AD 中的更改同步？

是否可以强制 SharePoint 与我们的 AD 安全组中的更改进行整体同步？是否有任何命令或解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:54:32.547

这是因为 SharePoint Foundation 没有此功能，因为它是 SharePoint 的免费版本。

当我必须将 AD 用户及其信息同步到 SharePoint Foundation 时，我必须创建 Windows 服务，在服务器上运行并与 SharegPoint 同步信息。

SharegPoint 服务器在安装时具有此功能...

请参阅[此](http://ranaictiu-technicalblog.blogspot.be/2010/12/sharepoint-2010-linking-sharepoint-user.html?m=1)链接。也许它可以帮助！

希望是，

安德鲁

# php - 登录 Google Ingress

> ID：14435645
> 
> 赞同：7
> 
> 时间：2013-01-21T09:24:33.023
> 
> 标签：php, curl, ingress-game

我正在尝试登录 Google 帐户，以便能够在我自己的应用程序中使用 Google Ingress Intel 地图。我发现了这个问题（[使用 PHP 和 Curl 登录 Google，Cookie 已关闭？](https://stackoverflow.com/questions/8991873/login-to-google-with-php-and-curl-cookie-turned-off)），我可以登录 Google 帐户，但是当我想加载 Ingress Intel 地图时出现问题（[http://www.ingress.com/intel](http://www.ingress.com/intel)） ，然后我得到这个错误：

> 禁止 (403)
> 
> CSRF 验证失败。请求中止。

我知道 CSRF，但我不知道我做错了什么。也许是因为我的 cookie.txt 文件是空的，但为什么呢？

这是我的代码：

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch, CURLOPT_COOKIEJAR, 'cookie.txt');
curl_setopt($ch, CURLOPT_COOKIEFILE, 'cookie.txt');
curl_setopt($ch, CURLOPT_HEADER, 0);  
curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 120);
curl_setopt($ch, CURLOPT_TIMEOUT, 120);

curl_setopt($ch, CURLOPT_URL, 
  'https://accounts.google.com/ServiceLogin?hl=en&service=alerts&continue=http://www.google.com/alerts/manage');
$data = curl_exec($ch);

$formFields = getFormFields($data);

$formFields['Email']  = $USERNAME;
$formFields['Passwd'] = $PASSWORD;
unset($formFields['PersistentCookie']);

$post_string = '';
foreach($formFields as $key => $value) {
    $post_string .= $key . '=' . urlencode($value) . '&';
}

$post_string = substr($post_string, 0, -1);

curl_setopt($ch, CURLOPT_URL, 'https://accounts.google.com/ServiceLoginAuth');
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $post_string);

$result = curl_exec($ch);

    curl_setopt($ch, CURLOPT_URL, 'http://www.ingress.com/intel');
    curl_setopt($ch, CURLOPT_POST, 0);
    curl_setopt($ch, CURLOPT_POSTFIELDS, null);

    $result = curl_exec($ch);

    var_dump($result);

function getFormFields($data)
{
    if (preg_match('/(<form.*?id=.?gaia_loginform.*?<\/form>)/is', $data, $matches)) {
        $inputs = getInputs($matches[1]);

        return $inputs;
    } else {
        die('didnt find login form');
    }
}

function getInputs($form)
{
    $inputs = array();

    $elements = preg_match_all('/(<input[^>]+>)/is', $form, $matches);

    if ($elements > 0) {
        for($i = 0; $i < $elements; $i++) {
            $el = preg_replace('/\s{2,}/', ' ', $matches[1][$i]);

            if (preg_match('/name=(?:["\'])?([^"\'\s]*)/i', $el, $name)) {
                $name  = $name[1];
                $value = '';

                if (preg_match('/value=(?:["\'])?([^"\'\s]*)/i', $el, $value)) {
                    $value = $value[1];
                }

                $inputs[$name] = $value;
            }
        }
    }

    return $inputs;
} 
```

感谢您的建议我做错了什么:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T07:05:00.037

```
<?php
$username = 'email@gmail.com';
$password = 'password';
$cookies = 'cookies.txt';

function getFormFields($data) {
        if(preg_match('/(<form.*?id=.?gaia_loginform.*?<\/form>)/is', $data, $matches)) {
                $inputs = getInputs($matches[1]);
                return $inputs;
        } else {
                die('didnt find login form');
        }
}

function getInputs($form) {
        $inputs = array();
        $elements = preg_match_all('/(<input[^>]+>)/is', $form, $matches);

        if($elements > 0) {
                for($i = 0; $i < $elements; $i++) {
                        $el = preg_replace('/\s{2,}/', ' ', $matches[1][$i]);
                        if (preg_match('/name=(?:["\'])?([^"\'\s]*)/i', $el, $name)) {
                                $name  = $name[1];
                                $value = '';
                                if (preg_match('/value=(?:["\'])?([^"\'\s]*)/i', $el, $value)) {
                                        $value = $value[1];
                                }
                                $inputs[$name] = $value;
                        }
                }
        }
        return $inputs;
}

$ch = curl_init();
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.56 Safari/537.17");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch, CURLOPT_COOKIEJAR, $cookies);
curl_setopt($ch, CURLOPT_COOKIEFILE, $cookies);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 120);
curl_setopt($ch, CURLOPT_TIMEOUT, 120);

curl_setopt($ch, CURLOPT_URL, 'https://accounts.google.com/ServiceLogin?service=ah&passive=true&continue=https://appengine.google.com/_ah/conflogin%3Fcontinue%3Dhttp://www.ingress.com/intel');
$data = curl_exec($ch);

$formFields = getFormFields($data);
$formFields['Email']  = $username;
$formFields['Passwd'] = $password;
unset($formFields['PersistentCookie']);

$post_string = '';
foreach($formFields as $key => $value) {
        $post_string .= $key . '=' . urlencode($value) . '&';
}
$post_string = substr($post_string, 0, -1);

curl_setopt($ch, CURLOPT_URL, 'https://accounts.google.com/ServiceLoginAuth');
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $post_string);
$result = curl_exec($ch);

curl_setopt($ch, CURLOPT_URL, 'https://www.ingress.com/intel');
curl_setopt($ch, CURLOPT_POST, 0);
curl_setopt($ch, CURLOPT_POSTFIELDS, null);
$result = curl_exec($ch);

echo $result;

curl_close($ch);
@unlink($cookies);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T12:48:48.230

```
<input type='hidden' name='csrfmiddlewaretoken' value='biVbClptWbMjkpXiJiVUVkt3T1wx9OwF' /> 
```

您必须使用它，它在搜索表单中；）

您的请求中似乎需要此标头：

```
X-CSRFToken:biVbClptWbMjkpXiJiVUVkt3T1wx9OwF 
```

我自己正在尝试使用 Goutte 以及 Symfony DOMCrawler 和控制台组件，它们都与 Composer 捆绑在一起：

```
<?php
namespace Ingress;

use Goutte\Client;
use Doctrine\Common\Cache\ArrayCache;
use Guzzle\Cache\DoctrineCacheAdapter;
use Guzzle\Plugin\Cache\CachePlugin;
use Guzzle\Plugin\Cookie\CookiePlugin;
use Guzzle\Plugin\Cookie\CookieJar\ArrayCookieJar;
use Guzzle\Plugin\Backoff\BackoffPlugin;

class Crawl
{
    const USER = 'googleuser';
    const PASSWORD = 'passwd';
    const URL_START = 'http://www.ingress.com/intel';
    const URL_LOGIN = 'https://accounts.google.com/ServiceLogin?service=ah&passive=true&continue=https://appengine.google.com/_ah/conflogin%3Fcontinue%3Dhttp://www.ingress.com/intel';
    const USER_AGENT = 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11';

    public $client;

    public function __construct()
    {
        $history = new \Symfony\Component\BrowserKit\History();
        $cookieJar = new \Symfony\Component\BrowserKit\CookieJar();
        $config = array('HTTP_USER_AGENT' => self::USER_AGENT);
        $this->client = new Client($config, $history, $cookieJar);

        $guzzleClient = $this->client->getClient();

        $backoffPlugin = BackoffPlugin::getExponentialBackoff();
        $guzzleClient->addSubscriber($backoffPlugin);
        $cachePlugin = new CachePlugin(array('adapter' => new DoctrineCacheAdapter(new ArrayCache())));
        $guzzleClient->addSubscriber($cachePlugin);
        $cookiePlugin = new CookiePlugin(new ArrayCookieJar());
        $guzzleClient->addSubscriber($cookiePlugin);

        $guzzleClient->setConfig(array(
            'ssl.certificate_authority' => false,
            'curl.options' => array(
                CURLOPT_CONNECTTIMEOUT => 120,
                CURLOPT_TIMEOUT => 120
            )
        ));
    }

    public function login()
    {
        $crawler = $this->client->request('GET', self::URL_LOGIN);
        $form = $crawler->selectButton('Sign in')->form(array(
            'Email' => self::USER,
            'Passwd' => self::PASSWORD
        ));
        $form['PersistentCookie']->tick();
        $crawler = $this->client->submit($form);
    }
} 
```

[https://github.com/florinutz/ingress-php](https://github.com/florinutz/ingress-php)

# cloud - paxos 价值选择

> ID：14435646
> 
> 赞同：4
> 
> 时间：2013-01-21T09:24:38.700
> 
> 标签：cloud, paxos

我在 wiki 页面和论文（paxos 变得简单）上阅读了有关 paxos 的信息。但是，我仍然对一些细节感到困惑：

1.  在阶段 1a 中，提议者是否在向接受者的提议中包含其打算选择的值？

2.  在阶段 1b 中，acceptor 应该返回它之前接受的值（如果有的话）。价值的生命周期是多少？IOW，什么时候被认为被接受，什么时候被覆盖/丢弃？

关于生命时间问题的一些更新。IIUC，在第一次接受之后，接受者应该总是手头有一个先前接受的值。它如何决定是否应该在下一个承诺（1b）阶段返回它？或者它什么时候决定忘记这个值？

* * *

更新 2 以更好地与@MichealDeardeuff 讨论：

我对paxos有以下理解：

> 通常在 paxos 工作流中，acceptor 应该总是手头有一个以前接受的值。并且在回答准备请求时，它将在承诺响应中发回该值。*并且提议者需要检查该值是否与上*一轮提议的自己的值相同。如果不是，则提议者继续发送带有接受者返回值的接受请求。如果是，那么提议者继续发送带有它打算在*当前*轮次中发送的值的接受请求。

以上理解正确吗？

如果不正确，请解释原因？

如果它是正确的，我很困惑，因为 paxos 协议没有明确说明。它只说：

> 其中 v 是响应中编号最高的提案的值，或者如果响应报告没有提案，则为任何值。

但是，据我了解，提议者需要检查接受者返回的值是否与*上*一轮提议的*同一提议者相同。*如果是，即使在 Promise 响应中存在编号最高的提议值，提议者仍然可以选择它想要的任何值，就好像接受者没有返回值一样。

 *这就是我想看看是否有任何参考来支持理解的原因。

非常感谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-23T04:11:23.533

> 在阶段 1a 中，提议者是否在向接受者的提议中包含其打算选择的值？

在阶段 2a 之前，提议者不需要发送它打算选择的值。另请参阅[我](https://stackoverflow.com/a/10151660/4931)对先前问题的回答。

> 在阶段 1b 中，acceptor 应该返回它之前接受的值（如果有的话）。价值的生命周期是多少？IOW，什么时候被认为被接受，什么时候被覆盖/丢弃？

从[我](https://stackoverflow.com/a/10114441/4931)对另一个不同问题的回答来看，**“接受者应该接受所有值，除非它承诺不接受它。”** 也就是说，它应该接受任何一个round-id 大于或等于它发送的最后一个响应中的round-id 的值。

它必须接受任何其他值的原因是提议者可能会发现（作为阶段 1 的结果）应该或已经选择了*不同的值；**然后它将这个*值广播给所有的接受者。当有多个提议者和/或在网络分区期间，可能会发生这种差异。

* * *

**更新**以回答评论。

当接受者接受一个值时，它会保留该值，直到它接受另一个值。（与此一起它存储值的轮次）。

在阶段 1b，Acceptor*总是*发送它的值，允许 Proposer 整理出实际选择的值是什么。它*永远不会*忘记它的当前值。曾经。

在收到接受者的承诺后，提议者对系统有一个很好的了解。（注意：它不一定是完整的或最新的视图。）

由于与不同的提议者发生争执，不同的接受者可能接受了不同的值。因此，提议者选择具有最高轮次 id 的值并将*该*值发送给所有接受者。这就是为什么接受者的值被允许改变的原因。

评论中的担忧是这会破坏 Paxos。不是这样。

但是，在我进入示例之前，让我强调一下，使用命名阶段和消息而不是 1a、1b、2a、2b 来考虑 Paxos 要容易得多。我通常将阶段命名为准备阶段和接受阶段。消息 1a 为 Prepare，1b 为 Promise，2a 为 Accept，2b 为 Accepted。

现在，让我们举一个人们经常给出的假设示例，他们认为这会破坏 Paxos。假设我们有三个 Acceptor A1、A2 和 A3。A1 和 A2 在第 1 轮中都接受了值 ABC，而 A3 在第 2 轮中选择了 XYZ（即来自不同的提议者）。我们可以看到 A1 和 A2 占多数，而 ABC 已被“选中”。

继续这个假设的例子，提议者发送 Prepare(3) 并接收来自 A2 和 A3 的回复，即 Promise(ABC @ 1) 和 Promise(XYZ @ 2)。Proposer 看到 XYZ 的轮次最高，并在接受阶段将其发送，覆盖其他主机上的 ABC。还有中提琴，Paxos 坏了，对吧？

不，问题在于启动状态，这是不可能的。让我告诉你为什么。

首先，一些命题，它们是 Paxos 正确运行的关键：

**命题 A**：对于 A1 和 A2 的值为 ABC @ 1，建议者必须发送 Accept(ABC @ 1)，这意味着它必须收到大多数 Promise 以响应发送 Prepare(1)。

**命题 B**：对于 A3 的值为 XYZ @ 2，建议者必须发送 Accept(XYZ @ 2)，这意味着它必须收到大多数 Promises 以响应发送 Prepare(2)。

现在证明：

*案例 1*：A1 和 A2 已经有值 ABC @ 1。根据命题 B，对于 A3 的值 XYZ @ 2 *，它必须*从接受者那里收到大多数 Promise。由于值 ABC 在大多数接受者上，因此其中至少有一个必须发送 Promise(ABC @ 1)。1 是最高的轮 id，提议者必须选择值 ABC 并发送 Accept(ABC @ 2)。但它没有，它发送了 Accept(XYZ @ 2)。一个矛盾。

*案例 2*：A3 已经有值 XYZ @ 2。（请记住，第 2 轮可以在第 1 轮之前：轮 id 仅按每个提议者单调递增。）根据命题 A，对于 A1 和 A2 的值 ABC @ 1，*a提议者必须*从接受者那里收到过半数的承诺。同样，根据命题 B，要让 A3 也拥有*它，必须已经收到了大多数 Promise。*这意味着在集合 {A1, A2} 中必须至少有一个接受者承诺了两次。

*情况 2a*：acceptor 先发送 Promise(1)，然后发送 Promise(2)。那么当它收到Accept(ABC@1)消息时，它肯定拒绝了它，因为它已经承诺不接受早于2的值。但它没有拒绝它，因为它有值ABC@1。矛盾。

*情况 2b*：acceptor 先发送 Promise(2)。然后，当它收到消息 Prepare(1) 时，它肯定拒绝了它，因为它已经承诺进行更高的一轮。但它显然没有，因为根据命题 A，它发送了 Promise(1)。一个矛盾。

哇！

我希望这能够帮到你。

* * *

**更新 2**：这是 Paxos 的伪 python 实现

```
from itertools import count
from concurrent import futures

class Acceptor():
    def __init__(self):
        self.acceptedValue = None
        self.acceptedRound = None

        self.promisedRound = None

    def onPrepare(self, message):
        if self.promisedRound > message.round:
            send(message.source, new Nack())

        self.promisedRound = message.round
        response = new Promise(round=self.acceptedRound, value=self.acceptedValue)
        send(message.source, response)

    def onAccept(self, message):
        if self.promisedRound > message.round:
            send(message.source, new Nack())

        self.acceptedValue = message.value
        self.acceptedRound = message.round
        send(message.source, new Accepted())

class Proposer():

    def __init__(self, selfId, quorum):
        self.quorum = quorum
        self.id = selfId

        # get a unique starting round, 
        # assumes acceptors and proposers are on same hosts
        self.initialRound = sorted(quorum).index(selfId)

    def propose(self, value):
        "Propose a value to be chosen; returns actual value chosen"

        # round is always unique to a proposer
        # count(start, step) returns an infinite sequence
        for round in count(self.initialRound, len(self.quorum))
            promises = self.prepare(round)

            if not promises: continue

            # interpret the prepare phase results, may be None
            selectedValue = max(promises, key=lambda p: p.round or -1)

            accepted = self.accept(round, selectedValue or value)

            if accepted: return value

    def prepare(self, round):
        "Drive the Prepare phase. returns the promises from the acceptors or None"

        message = new Prepare(round, source=self.id)
        responses = []
        for acceptor in self.quorum:
            responses.append(send(acceptor, message)))

        # wait for the results
        promises = []
        for response in futures.as_completed(responses):
            if response.exception(): continue # message died

            message = response.result()
            if not isinstance(message, Promise):
                # A nack message; abort the round. We may have got a majority,
                # but this speeds up the case when we didn't.
                return None

            promises.append(message)
            if (len(promises) > len(self.quorum) / 2:
                return promises

        # No majority of responses
        return None

    def accept(self, round, value):
        "Drive the Accept phase. returns True iff the value was accepted"

        message = new Accept(round, value)
        responses = []
        for acceptor in self.quorum:
            responses.append(send(acceptor, message)

        # wait for the results
        accepts = 0
        for response in futures.as_completed(responses):
            if response.exception(): continue # message died

            message = response.result()
            if not isinstance(message, Accepted):
                # A nack message; abort the round. We may have got a majority,
                # but this speeds up the case when we didn't.
                return False

            accepts = accepts + 1
            if accepts > len(self.quorum) / 2:
                return True

        # No majority of responses
        return False 
```

* * *

**更新 3**回答评论中的更多问题。

> ...如果它与上一轮发送的提议者相同，我们希望提议者忽略它（否则我们最终会陷入死循环，对吗？）

*（我假设“忽略”该值意味着提前退出循环。）*

首先，请注意当提议者收到来自大多数接受者的确认已选择一个值时，循环结束。因此，如果提议者发现自己正在执行后续的准备阶段，您可以确定它正在与另一个提议者竞争，或者发生了一些网络分区。其次，请注意即使*只有一个接受者接受了一个值，准备阶段也会返回一个值*（这意味着该值可能未被多数人接受。）

如果准备阶段产生的值*与上一轮中看到的值相同，*则出于多种原因，无论如何它都应该继续接受阶段。

*   如果提议者提前退出循环，则可能是其他提议者失败了。这可能导致*不选择任何*值。
*   如果它提前退出循环，那么其他提议者也是合理的，遵循相同的算法也退出了循环；再次导致可能*没有*选择任何值。
*   如果碰巧实际选择了该值，则可能并非所有节点都收到了该值（由于网络分区）或具有不同的值（由于与其他提议者的争斗）。那么，为了持久性，将值推送到节点是很好的。

另一方面，当两个或多个提议者之间发生争用并且运气不佳时**，Paxos 可能会进入无限循环。***（这对于任何共识算法都是正确的，并且在实际发现任何共识算法之前*已被 Liskov 等人证明。）所以理论说，但在实际系统**中很容易绕过**：在随后的每一轮中，暂停一个随机量时间让其他提议者有机会赢得比赛。当然，无限循环仍然是*可能*的，但它不太可能在宇宙的整个生命周期中发生。

> 你有任何参考来支持这个论点吗？

我讲的主要是我自己的学习和经验。我所在的团队负责开发和维护一个以 Paxos 为核心的系统。我也对该主题进行了广泛的研究。

这里有一些关于这个主题的好论文：

*   [Paxos 变得简单](http://research.microsoft.com/en-us/um/people/lamport/pubs/pubs.html#paxos-simple)（你说过你已经读过）
*   [Paxon 议会](http://research.microsoft.com/en-us/um/people/lamport/pubs/pubs.html#lamport-paxos "兼职议会")（原始论文）
*   [解构 Paxos](http://scholar.google.com/scholar?q=deconstructing+paxos "解构 Paxos")（将 Paxos 模块化成几个组件，然后针对不同的场景进行调整）
*   [Paxos 的 ABCD](http://research.microsoft.com/lampson/65-ABCDPaxos/Abstract.html.)（Butler Lampson 普及了 Paxos，但他有时会让人困惑。）

* * *

**更新 4**回答问题中的更新。

> 通常在 paxos 工作流中，acceptor 应该总是手头有一个以前接受的值。并且在回答准备请求时，它将在承诺响应中发回该值。*并且提议者需要检查该值是否与上*一轮提议的自己的值相同。如果不是，则提议者继续发送带有接受者返回值的接受请求。

好的，到此为止。但是提议者不需要在轮次之间保持状态。我们很快就会找出原因。

> 如果它是[相同的值]，那么提议者继续发送带有它打算在*当前*轮中发送的值的接受请求。

如果接受器返回*任何*值，则*必须*在接受阶段使用具有最高 round-id 的值。如果接受者*没有返回**任何*值，则可以使用任何值：我的逻辑表明这将是客户端传递给提议者的值。

将此与[Paxos Made Simple](http://research.microsoft.com/en-us/um/people/lamport/pubs/pubs.html#paxos-simple)（第 6 页）进行比较：

> *...其中 v 是响应中编号最高的提案的值，或者如果响应报告没有提案，则为任何值。*

（术语在论文之间切换有点困难。这里 Lamport 使用术语*numbered proposals*，在其他地方他使用术语*round-id*。有一个和相同的。）

假设提议者运行准备阶段并在接受者中看到此状态。

```
 A1   A2  A3
promise:      3    ?   4
value@round:  x@3  ?  y@4 
```

实际状态在哪里

```
 A1  A2  A3
promise:       3   4   4
value@round:  x@3 y@4 y@4 
```

现在，假设它以 y 值运行了上一轮。**如果**此时允许选择任何值，则可以强制此状态：

```
 A1  A2  A3
value@round:  z@5 z@5 z@5 
```

**这会覆盖选择的值，**违反共识的一致性属性（即，**最多可以选择一个值。**）。

如果你*想要*这种行为，你不能按原样使用共识协议。您可以使用[ABD](http://scholar.google.com/scholar?q=Sharing+Memory+Robustly+in+Message-Passing+Systems "在消息传递系统中稳健地共享内存")之类的协议或其他[基于轮数的寄存器](http://scholar.google.com/scholar?q=deconstructing+paxos "解构 Paxos")。或者您可以将 Paxos 视为在状态机中选择*转换。*换句话说，每次你想改变一个变量时，你都会运行一个新的 Paxos 算法*来选择转换*。这就是我的系统所做的（我敢说最实用的 Paxos 系统）。

请注意，ABD 和基于循环的寄存器的行为类似于 Paxos，但更简单一些，因为它们不必保证上述一致性属性（一旦选择，总是选择）。但是基于 Paxos 的状态机允许对变量进行 CAS 操作。*

# regex - 正则表达式匹配一个 URL

> ID：14435649
> 
> 赞同：0
> 
> 时间：2013-01-21T09:24:43.310
> 
> 标签：regex, google-apps-script

在 Google Apps Scripts 中，我尝试使用以下函数使用 RegExp 匹配 URL。

```
function testRegex(){
  var str = "href='https://sites.google.com/a/domain.com/image-store/images/Image1.jpg?attredirects=0'";
  var regex = new RegExp('http[:a-zA-Z\.\/\-_]{0,100}Image1.jpg', 'gi');
  str = str.replace(regex,"new_url");
  Logger.log(str);
} 
```

[当我在http://www.regular-expressions.info/javascriptexample.html](http://www.regular-expressions.info/javascriptexample.html)向正则表达式测试器中输入相同的正则表达式和字符串时，**它可以工作**。但是，它在 Google Apps 脚本中不起作用。

任何想法为什么？

编辑：我认为问题出在下划线上。替换为 \w 有帮助。所以，当我用

```
https[\.a-zA-Z0-9\/+:\w-]{0,100}Image1.jpg 
```

有用。

但是，它仍然不匹配下划线。例如，它不适用于以下 URL

```
https://sites.google.com/a/domain.com/image-store/_/rsrc/1351707816362/images/Image1.jpg 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T19:12:56.570

在斜杠后添加 + 可能会这样做：

```
function testRegex(){
  var str = "href='https://sites.google.com/a/domain.com/image-store/images/Image1.jpg?attredirects=0'";
  var regex = new RegExp('http[:a-zA-Z\.\/+\-_]{1,100}Image1.jpg', 'gi');
  str = str.replace(regex,"new_url");
  Logger.log(str);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T17:36:30.487

我没有调试您的代码，但我在 repl.it 上进行了尝试，并验证它在 Chrome 的 V8 JavaScript 中也不正确。我怀疑这里有一个与 Apps 脚本无关的错误。

编辑：这有效：

```
function testRegex(){
  var str = "href='https://sites.google.com/a/domain.com/image-store/_/rsrc/1351707816362/images/Image1.jpg'";
  var regex = new RegExp('https[\.a-zA-Z0-9\/+:\w_-]{0,100}Image1.jpg', 'gi');
  str = str.replace(regex,"new_url");
  Logger.log(str);
} 
```

它不匹配下划线，因为您没有在字符类中指定下划线。

# iphone - 每次发生旋转时都会调用 supoprtedInterfaceOrientation

> ID：14435651
> 
> 赞同：0
> 
> 时间：2013-01-21T09:24:48.550
> 
> 标签：iphone, ios

`supportedInterfaceOrientation`应该只在 时调用一次`viewDidLoad`，但在我的情况下，每次模拟器旋转时都会调用它。

我只需要倒置两个方​​向的肖像和肖像。

当我旋转到颠倒时，支持的界面方向被调用 4 次，我的视图变成颠倒的。在旋转到横向时，它只被调用一次（但它不应该？）。

有什么解决办法吗？

PS：我没有使用任何导航控制器，因此将旋转设置为顶视图控制器无关紧要。在我的 pList 中，仅支持 2 个方向

此外，我有一个主视图控制器，我在其中添加子视图，并在我的视图控制器中设置了支持的界面方向。

奇怪的是 3 个视图控制器在故障控制器之前（之前显示），它们旋转得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T11:51:26.533

它非常简单，您只需单击您的项目 -> 摘要 -> 支持的界面方向。您可以根据需要单击界面方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:27:52.157

您可以在 viewDidLoad 中检查 interfaceOrientation。您可以使用 self.userInterFaceOrientation 获取 interfaceOrientation。

也许在 viewWillAppear 中检查 interfaceOrientation 会更好。

不同之处在于，每次进入该视图时，viewDidLoad 只会调用 one 和 viewWillAppear。

# jquery - 用户选择在 jQuery 克隆中丢失？

> ID：14435653
> 
> 赞同：2
> 
> 时间：2013-01-21T09:24:53.900
> 
> 标签：jquery, select, clone

背景不是理解问题所必需的，而是我正在尝试做的基本想法：我有一个表单，其中包含可以再次展开、编辑和折叠的各个部分，表单字段的状态是每次都记得。我想为用户提供“取消”更改的能力 - 如果用户展开一个部分并进行更改，但随后决定恢复到表单部分以前的状态（在他展开之前），他们可以单击“取消”和字段将全部还原。（这本质上是一个“撤消”/回滚按钮。）我通过在展开时使用 jQuery`clone`克隆表单部分来实现这一点，如果用户点击“取消”，我用原始克隆替换更新的表单部分。

问题是用户的“选择”元素选择似乎没有包含在克隆中。我已经构建了一个基本的[jsfiddle](http://jsfiddle.net/7f9vd/5/)来演示这一点 - 如果您尝试在任一部分中选择某些内容然后克隆它，它会在没有选择的情况下被克隆。

有没有办法绕过这个限制？我应该使用另一种方法而不是`clone`吗？

我假设我可以手动编写一个循环来复制所有选择的所有选定值，但这很麻烦。有没有更流畅的方法来处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T17:52:09.233

根据您的小提琴：

```
$(function(){
    $('#sec1Clone').click(function(){
        $("#sec1 select option:selected").attr("selected", true);
        $('#sec1').clone(true).attr('id', 'cloneOfSec1').appendTo(document.body);
    });
     $('#sec2Clone').click(function(){
         $("#sec2 select option:selected").attr("selected", true);
        $('#sec2').clone(true).attr('id', 'cloneOfSec2').appendTo(document.body);
    });
}); 
```

如果这是一个可以接受的解决方案，这似乎可行。

# android - 为什么使用 gradle-android-plugin 构建的应用程序在设备上崩溃

> ID：14435657
> 
> 赞同：1
> 
> 时间：2013-01-21T09:25:08.573
> 
> 标签：android, eclipse, groovy, gradle

我已按照[此](https://github.com/jvoegele/gradle-android-plugin)说明进行操作

gradle assemble 作品，gradle eclipse 作品，将项目导入 Eclipse 作品。

但是当我尝试在设备上运行它时，它崩溃了。

```
01-21 10:27:25.286: W/dalvikvm(9696): threadid=1: thread exiting with uncaught exception (group=0x413d4930)
01-21 10:27:25.286: E/AndroidRuntime(9696): FATAL EXCEPTION: main
01-21 10:27:25.286: E/AndroidRuntime(9696): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.mockodu.gradletest/com.mockodu.gradletest.MyAndroidActivity}: java.lang.ClassNotFoundException: Didn't find class "com.mockodu.gradletest.MyAndroidActivity" on path: /data/app/com.mockodu.gradletest-2.apk
01-21 10:27:25.286: E/AndroidRuntime(9696):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2106)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at android.os.Looper.loop(Looper.java:137)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at android.app.ActivityThread.main(ActivityThread.java:5039)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at java.lang.reflect.Method.invokeNative(Native Method)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at java.lang.reflect.Method.invoke(Method.java:511)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at dalvik.system.NativeStart.main(Native Method)
01-21 10:27:25.286: E/AndroidRuntime(9696): Caused by: java.lang.ClassNotFoundException: Didn't find class "com.mockodu.gradletest.MyAndroidActivity" on path: /data/app/com.mockodu.gradletest-2.apk
01-21 10:27:25.286: E/AndroidRuntime(9696):     at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:65)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at android.app.Instrumentation.newActivity(Instrumentation.java:1054)
01-21 10:27:25.286: E/AndroidRuntime(9696):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2097) 
```

AndroidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="com.mockodu.gradletest"
      android:versionCode="1"
      android:versionName="1.0">
    <application android:label="@string/app_name" android:icon="@drawable/ic_launcher">
        <activity android:name="MyAndroidActivity"
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

# ios - My iOS app complains about two-staged rotation but I'm not using it

> ID：14435659
> 
> 赞同：1
> 
> 时间：2013-01-21T09:25:11.960
> 
> 标签：ios, cocoa-touch, uiviewcontroller

I have to support down to iOS 4.3.

My app outputs in the console :

```
Using two-stage rotation animation. To use the smoother single-stage animation, this application must remove two-stage method implementations. 
```

As far as I know I'm not using two-staged rotation. I just have this method in my view controllers :

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return YES;
} 
```

What else should I check in order to fix that?

Edit: More precisions: my app uses a UITabbarController subclass. When the app starts, it checks if a user is logged in and then initiates the controllers of the tabbar controller if it's the case. If there's no user logged in, a modal view is presented (from the tabbar controller) the prompt the user to login and the controllers of the tabbar controller aren't initialized (yet). The "two-staged rotation" error is shown only at that moment and the rotation doesn't work.

So to summarize, the problem happens in that situation:

*   The rootViewController of the main window is the tabbar controller
*   The tabbar controller is empty (there are no view controller in the tabs and there's no tab)
*   A view controller is modally presented from the tabbar controller

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T06:36:04.783

OK I found a solution.

It seems like the presented modal view won't rotate until the viewControllers property of the UITabBarController is initialized. Since the concerned modal view is actually for login, I don't want to display anything behind it until the user is logged in because the views intended to be hold by the tabbar controller depend on the fact that a user is logged in. So now just before presenting the modal view, I initialize the tabbar controller with a single, empty UIViewController and I remove it when the modal view is dismissed (i.e. a user logged in).

Perhaps it seems like a hack but it works well. And even if I don't understand why, it doesn't seem completely illogical that the tabbar controller doesn't behave like we want until it is fully initialized.

If someone has a better solution or explanation, feel free to comment :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-14T23:12:37.953

There aren't many posts regarding this error, so I'll admit my own shortcomings for the benefit of the next person so focused on the trees they might miss the forest. I found a missing

[super viewWillAppear:animated];

call inside my sub.

# c# - ASP.NET 成员资格提供程序和 Web 服务

> ID：14435661
> 
> 赞同：1
> 
> 时间：2013-01-21T09:25:24.737
> 
> 标签：c#, asp.net, web-services, authentication, membership-provider

我正在开发一个使用 ASP.NET Membership Provieder 为每个用户实现身份验证和角色的网络应用程序。

现在我需要创建一个 Web 服务来提供一些异步功能，并且我需要从我的应用程序中的多个页面调用 Web 方法。但我注意到 Web 服务也可以从在浏览器地址栏中设置 url 的非身份验证用户访问。

有没有办法将成员资格提供者规则也应用于网络方法，或者我必须为每种方法实施身份验证系统？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:28:16.837

您可能不应该将 Web 服务公开给公众。它应该驻留在您的内部网络中。如果您需要将其公开给公众，那么您需要以与您的 Web 应用程序相同的方式保护它。您还可以在 Web 服务方法中使用表单身份验证。根据您用于实现服务的技术，可能有多种方法可以实现这一目标。基本上，您的所有 Web 方法调用都需要与每个请求一起发送有效的表单身份验证 cookie，以便对用户进行身份验证。

# asp.net - 在 asp.net 中从 XML 读取菜单项

> ID：14435663
> 
> 赞同：0
> 
> 时间：2013-01-21T09:25:32.583
> 
> 标签：asp.net, xml, menu

我正在建立一个多语言网站，它将提供四种语言。我将使用 asp:MenuItem 控件。对于每种语言，我想从 XML 文档中读取菜单项的名称。XML 草稿可以被认为是：

```
<root>
    <language>
        <en>
            <home>
                <link>Default.aspx</link>
                <text>Home</text>
           </home>
            <about>
                <link>About.aspx</link>
                <text>About</text>
            </about> 
        </en>
        <de>
            <home>
                <link>Default.aspx</link>
                <text>Hauptseite</text>
           </home>
           <about>
                <link>About.aspx</link>
                <text>Über</text>
            </about> 
        </de>
    </language>
</root> 
```

我不确定语法和结构是否正确。我的另一个目标是关于菜单项的订单。所有语言的顺序必须相同。

我想知道如何实现这一点。或者是否有另一种和/或更好的方法来做到这一点。此外，我的数据库已准备好两种语言的内容。

我不想使用 if-else 条件。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T10:08:34.517

如果所有语言都应该具有相同的结构，我建议使用稍微不同的 XML。

这将不同语言的不同名称组合在一起，如果您需要更改任何内容，这应该更容易管理。

```
<root>
  <item>
    <link>default.aspx</link>
    <text>
      <en>Home</en>
      <de>Hauptseite</de>
    </text>
  </item>
  <item>
    <link>about.aspx</link>
    <text>
      <en>About</en>
      <de>Über</de>
    </text>
  </item>
</root> 
```

# xslt - 如何用 xslt 表示 xml 的嵌套元素？

> ID：14435667
> 
> 赞同：-2
> 
> 时间：2013-01-21T09:25:41.590
> 
> 标签：xslt

这是我需要从中生成 xslt 的 xml 数据。

```
<root>
    <entry id="1">
         <headword>go</headword>
         <example>I <hw>go</hw> to school.</example>
    </entry>
    <entry id="2">
         <headword>come</headword>
         <example>I <verb>came</verb> back home.</example>           
    </entry> 
```

我想创建一个这样的html：

```
<html>
     <body>
          <div class="entry" id="1">
                <span class="headword">go</span>
                <span class="example">I <span class="hw">go</span> to school.</span>
          </div>
          <div class="entry" id="2">
                <span class="headword">comeo</span>
                <span class="example">I <span class="hw">came</span> back home.</span>
          </div>
     </body>
</html> 
```

这是我的 xslt：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:template match="/">
        <html>
            <body>
                <xsl:for-each select="root/entry">
                    <div class="entry">
                        <span class="headword">
                            <xsl:value-of select="headword"/>
                        </span>
                        <span class="example">
                            <xsl:value-of select="example"/>
                        </span>
                    </div>
                </xsl:for-each>
            </body>
        </html>
    </xsl:template>
</xsl:stylesheet> 
```

我不知道如何转换属性“id”和元素“hw”的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:34:07.830

请试一试。我假设`class="hw"`您的示例输出中的第二个是错字，应该是`class="verb"`因为这是唯一有意义的可能性：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:template match="/">
    <html>
      <body>
        <xsl:apply-templates select="root/entry" />
      </body>
    </html>
  </xsl:template>

  <xsl:template match="entry">
    <div class="entry" id="{@id}">
      <xsl:apply-templates select="*" mode="entryContents" />
    </div>
  </xsl:template>

  <xsl:template match="*" mode="entryContents">
    <span class="{local-name()}">
      <xsl:apply-templates select="node()" mode="entryContents" />
    </span>
  </xsl:template>
</xsl:stylesheet> 
```

# xmpp - 修改 XMPP Presence 节

> ID：14435670
> 
> 赞同：0
> 
> 时间：2013-01-21T09:25:49.853
> 
> 标签：xmpp

在 XMPP 中，用户可以向另一个用户发送订阅请求以添加到花名册中，即使用户离线，我也很容易做到这一点，即使用户离线服务器会在用户上线时自动发送此状态。

但是我需要为此状态添加一个自定义标签，它在用户在线之前一直有效，如果用户离线，当用户在线时，服务器会发送没有我的自定义标签的常规状态。

如何实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T12:25:12.490

看起来您使用的 XMPP 服务器没有存储存在的扩展信息。
根据 RFC6121 3.1.3.4 服务器必须存储此信息：http:
[//xmpp.org/rfcs/rfc6121.html#sub-request-inbound](http://xmpp.org/rfcs/rfc6121.html#sub-request-inbound)

# c# - 处理 64 位操作系统的注册表项

> ID：14435671
> 
> 赞同：1
> 
> 时间：2013-01-21T09:26:04.860
> 
> 标签：c#, .net, registry, key

我正在使用注册表项从我机器的已安装文件夹中访问 XML 文件的路径。我的机器有 32 位操作系统。所以我正在使用

```
using (RegistryKey pRegKey = Registry.LocalMachine.OpenSubKey(@"SOFTWARE\Wow6432Node\Folder\subfolder\key"))
{
    if (pRegKey == null)
    {
        return;
    } 
    else
        // get path 
```

但是当我在 64 位机器上运行它时，它会显示错误，因为我没有处理 64 位操作系统的异常情况。

我该如何处理？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:30:47.690

如果您的应用程序是 32 位的，并且您想在 32 位和 64 位操作系统上安装它，请使用以下命令：

```
string regPath = string.Format(@"SOFTWARE\{0}AppName\Folder\subfolder\key", 
                      Environment.Is64BitProcess ? @"Wow6432Node\" : string.Empty());

using (RegistryKey pRegKey = Registry.LocalMachine.OpenSubKey(regPath))
        {
             ..... 
```

# mysql - sqoop 导出mysql分区

> ID：14435676
> 
> 赞同：0
> 
> 时间：2013-01-21T09:26:39.553
> 
> 标签：mysql, hadoop, hive, sqoop

我正在尝试使用 sqoop 从分区的配置单元表中导出到 mysql。

起初我试着做

```
$sqoop export --connect jdbc:mysql://<server addr>/<db name> --username <user name> -P --table source_edge_daily --export-dir /path/to/table/<table name> --input-fields-terminated-by '\t' --verbose 
```

命令错误说

```
Open failed for file /path/to/table/<table name>/<partition name>, attempt to open a directory 
```

当我指向分区目录时

```
$sqoop export --connect jdbc:mysql://<server addr>/<db name> --username <user name> -P --table source_edge_daily --export-dir /path/to/table/<table name>/<partition name> --input-fields-terminated-by '\t' --verbose 
```

命令失败说

```
at com.cloudera.sqoop.mapreduce.CombineShimRecordReader.getCurrentKey(CombineShimRecordReader.java:100)
at com.cloudera.sqoop.mapreduce.CombineShimRecordReader.getCurrentKey(CombineShimRecordReader.java:43)
at org.apache.hadoop.mapreduce.lib.input.CombineFileRecordReader.getCurrentKey(CombineFileRecordReader.java:75)
at org.apache.hadoop.mapred.MapTask$NewTrackingRecordReader.getCurrentKey(MapTask.java:452)
at org.apache.hadoop.mapreduce.MapContext.getCurrentKey(MapContext.java:57)
at org.apache.hadoop.mapreduce.Mapper.run(Mapper.java:144)
at com.cloudera.sqoop.mapreduce.AutoProgressMapper.run(AutoProgressMapper.java:189)
at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:668)
at org.apache.hadoop.mapred.MapTask.run(MapTask.java:334)
at org.apache.hadoop.mapred.Child$4.run(Child.java:270)
at java.security.AccessController.doPrivileged(Native Method)
at javax.security.auth.Subject.doAs(Subject.java:396)
at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1109)
at org.apache.hadoop.mapred.Child.main(Child.java:264) 
```

我还尝试在没有分区键的情况下重新创建 mysql 表，创建分区 mysql 表，一切都失败并显示相同的错误消息

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T18:50:02.137

Sqoop 目前不支持加载分区表，仍在[进行中](https://issues.cloudera.org/browse/SQOOP-213)。因此，在解决此问题之前，您的第一个解决方案将不起作用。

直接指定分区目录的问题是您将丢失有关分区的信息，因此您需要创建一个不包含分区列的临时 MySQL 表，然后您可以轻松地将数据加载到该表中。最后你只需要从这个临时表中插入你的真实表。

# events - 如何使用谷歌日历 api 查找最近发生的重复事件

> ID：14435677
> 
> 赞同：1
> 
> 时间：2013-01-21T09:26:47.890
> 
> 标签：events, google-calendar-api

[Google 日历重复事件（Python API）的发生时间](https://stackoverflow.com/questions/14145977/time-of-occurence-of-a-google-calendar-recurring-event-python-api)
我的问题有点相同，但解决方案对我不利，因为我不需要同一事件的所有其他重复，我只需要一个最接近今天。由于流量和不必要数据的处理，我认为在我的情况下使用 singleEvents=true 并不明智。所以我剩下的唯一选择是尝试通过重复规则找到最近的事件。还是我错过了什么？也许有人已经解决了这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T12:52:41.363

这是我正在使用 c# api 做的事情：

```
evtQuery.SingleEvents = true;
evtQuery.SortOrder = CalendarSortOrder.ascending;
evtQuery.ExtraParameters = "orderby=starttime";
evtQuery.StartTime = start;
evtQuery.EndTime = end;
evtFeed = calSvc.Query(evtQuery); 
```

start 和 end 设置为从现在开始的 +-1 天。

然后，在浏览 evtFeed 时，如果我没有得到我正在搜索的内容，我正在做一个新的请求，开始和结束设置为 +-5 天。

# jquery - jquery：中止ajax会触发完成还是失败？

> ID：14435679
> 
> 赞同：8
> 
> 时间：2013-01-21T09:26:53.223
> 
> 标签：jquery, ajax

我对 $.ajax、.done 和 .fail 一无所知

我开始我的 ajax 调用，将它分配给一个变量。

在下一次 ajax 调用中，我测试是否定义了变量，然后调用 abort。

我无法理解 .abort() 是否导致执行 .done 。

如果它导致.done，如何检查状态并检测中止的呼叫？

来自[http://api.jquery.com/jQuery.ajax/#jqXHR](http://api.jquery.com/jQuery.ajax/#jqXHR)：

> 特别是，在对象上调用 .abort() 将在请求完成之前停止请求。

...所以我知道 .done 在 .abort 之后不会被解雇，对吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-21T09:30:40.343

`fail`回调的第二个参数是`textStatus`，对于应该是中止的请求`"abort"`。我不希望`done`回调被触发。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-21T09:50:29.040

`done(0, statusText || "abort")`在“abort”之后，只要没有异常发生（可以从[源代码](http://code.jquery.com/jquery-1.9.0.js)中验证） ，它就会调用“done”（更具体地说，）。这是合理的，因为中止操作是由用户发出的，并且`abort` **IS**没有失败地完成。

# c# - 关于使用 Unity 应用程序块依赖注入的问题

> ID：14435689
> 
> 赞同：0
> 
> 时间：2013-01-21T09:28:09.697
> 
> 标签：c#, dependency-injection, unity-container

我是第一次使用任何名为 unity app block 的 DI 框架。我收到错误。错误是：-

**无法解析类型名称或别名 ILogger。请检查您的配置文件并验证此类型名称。**

我试图从外部将依赖注入到我的主要项目中。假设我想通过依赖将数据保存到任何地方。假设我想将数据保存到文件或控制台、数据库等。

在这里，我将告诉您我如何开发我的应用程序以整合 Unity。

首先我创建了一个名为“Ilogger”的类库项目，它只有一个接口。该接口的完整代码

```
namespace Ilogger
{
    public interface ILog
    {
        void Write(string msg);
    }
} 
```

其次，我创建了一个名为“ConsoleWriter”的类库项目，它只有一个继承 Ilogger 接口的类。所以我只是将 Ilogger 项目的引用添加到 ConsoleWriter 项目中。此 ConsoleWriter 的完整代码

```
namespace ConsoleWriter
{
    public class ConsoleWriter : Ilogger.ILog
    {
        #region ILog Members

        public void Write(string msg)
        {
            Console.WriteLine(msg);
            Console.ReadLine();
        }

        #endregion
    }
} 
```

第三步我创建了一个名为“FileWriter”的类库项目，它只有一个继承Ilogger接口的类。所以我只是将Ilogger项目的引用添加到FileWriter proj中。此 FileWriter 的完整代码

```
namespace FileWriter
{
    public class FileWriter : Ilogger.ILog
    {
        #region IWriter Members

        public void Write(string msg)
        {
            using (StreamWriter streamWriter = new StreamWriter("c:\\TestUnity.txt", true))
            {
                streamWriter.WriteLine(msg);
            }
        }
        #endregion
    }
} 
```

接下来我创建我的 win 应用程序，在运行时注入依赖项。在这个项目中，我添加了一些统一块的 dll 引用，这些都是。

```
Microsoft.Practices.Unity
Microsoft.Practices.Unity.Configuration
system.configuration 
```

我添加了一个 app.config 文件，它有类似的条目

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <configSections>
        <section name="unity" type="Microsoft.Practices.Unity.Configuration.UnityConfigurationSection, Microsoft.Practices.Unity.Configuration"/>
    </configSections>

    <unity xmlns="http://schemas.microsoft.com/practices/2010/unity">
        <alias type="ILogger.ILog, ILogger" alias="ILogger" />
        <namespace name="ILogger.ILog"/>

        <container>
            <register mapTo="FileWriter.FileWriter, FileWriter" name="MyFileWriter" type="ILogger"/>
            <register mapTo="ConsoleWriter.ConsoleWriter, ConsoleWriter" name="MyConsoleWriter" type="ILogger"/>
        </container>
    </unity>

</configuration> 
```

这是引发错误的主要代码

字符串 strCountryCode = "美国";

```
 IDictionary<string, string> loggers = new Dictionary<string, string>();
    loggers.Add("USA", "MyFileWriter");
    loggers.Add("GBR", "MyConsoleWriter");

    IUnityContainer container = new UnityContainer();
    UnityConfigurationSection section = (UnityConfigurationSection)System.Configuration.ConfigurationManager.GetSection("unity");
    //container.LoadConfiguration();
    section.Containers.Default.Configure(container);

    Ilogger.ILog logger = container.Resolve<Ilogger.ILog>(loggers[strCountryCode]);
    logger.Write("Hello World"); 
```

这一行给出错误`section.Containers.Default.Configure(container);`

我第一次使用 DI 框架统一，所以我无法发现我犯了什么错误。所以请任何人帮助我解决错误并告诉我如何解决它。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:36:20.007

可能有几个问题；

*   在应用程序的入口点，您尝试读取统一配置，您需要添加包含`ILog`接口的程序集；组件可能丢失。

*   您需要使用完整路径添加别名；完整路径需要包含程序集名称。

*   为了观察确切的问题，而不是使用配置文件，尝试在代码中进行注册。

# xpath - Xpath 检查多个空子

> ID：14435694
> 
> 赞同：3
> 
> 时间：2013-01-21T09:28:30.870
> 
> 标签：xpath, multiple-instances

使用以下 xml，我试图返回`true`或`false`取决于所有`<CrucialNumber>`元素是否为空：

```
<Invoice>
  <Details>
    <LIN1>
      <Quantity>1</Quantity>
      <Product>Test XML</Product>
      <CrucialNumber/>
    </LIN1>
    <LIN1>
      <Quantity>1</Quantity>
      <Product>Test XML</Product>
      <CrucialNumber/>
    </LIN1>
    <LIN1>
      <Quantity>1</Quantity>
      <Product>Test XML</Product>
      <CrucialNumber>123456</CrucialNumber>
    </LIN1>
  </Details>
</Invoice> 
```

`CrucialNumber`元素的数据类型是`string`。

到目前为止，这些是我尝试过的 xpath 表达式：

```
string-length(//CrucialNumber/*) > 0;    

not(//CrucialNumber/*[text()]);

./Details/LIN1[*]/CrucialNumber[1] = ""; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:39:43.280

```
not(.//CrucialNumber/node()) 
```

应该这样做，当且仅当（a）根本没有`CrucialNumber`后代元素，或（b）所有后代`CrucialNumber`元素都是空的时，它才是真的。

# ios - ios: 请根据附件图片给我 smtp 邮件编码

> ID：14435696
> 
> 赞同：-11
> 
> 时间：2013-01-21T09:28:40.487
> 
> 标签：ios, smtp, sendmail

![在此处输入图像描述](../Images/f87871c90ba1bfb909bfd27b989387fa.png)

请任何人都可以帮助我。如何创建连接到服务器以发送邮件。

答案是[http://iphonesdksnippets.com/post/2009/04/15/Send-email-with-attachments-on-iPhone.aspx](http://iphonesdksnippets.com/post/2009/04/15/Send-email-with-attachments-on-iPhone.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:42:25.347

您可以使用：[**skpsmtpmessage**](http://code.google.com/p/skpsmtpmessage/)

这是一篇很好的文章[**从 Cocoa 发送电子邮件**](http://vafer.org/blog/20080604120118/)，也请检查一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:38:50.330

您需要一个中间服务器来接收 REST 调用并以您想要的任何方式处理它。任何 iOs 网络接口都可能用于此目的，有很多示例如何创建一个简单的请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T09:49:14.033

请提供您问题的更多背景信息。你想单独通过IOS来实现吗？或者您不介意编写一些服务器代码？

如果您可以编写一些服务器代码，您可以尝试使用 Google App Engine API 发送电子邮件（使用 Google 帐户）。您有 3 种语言选择：Java、Phyton 或 Go。

完整文档位于[Google App Engine](https://developers.google.com/appengine/docs/java/mail/usingjavamail)网站。

# android - 当我从一项活动转到另一项活动时，出现空指针异常

> ID：14435698
> 
> 赞同：2
> 
> 时间：2013-01-21T09:28:52.193
> 
> 标签：android, android-activity, nullpointerexception, flags

当我们从一个`activity`到另一个`activity`并从堆栈中删除当前`activity`时，我得到一个`NullPointer exception`. 假设我有`class A`和`class B`。我要从 A 到 B，然后从 B 回到 A 并使用`finish()`方法或使用`Flag_clear_Top`.

“A”类作为 MainClass

```
public class MainClass extends Activity{

    Button callBTN;
    Button messageBTN;
    Button emailBTN;
    Button referBTN;
    TextView nameTXT;

    String name ;
    String email;
    String mobile;

    @Override
    protected void onCreate(Bundle savedInstanceState) {

        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main_class_layout);
         Intent myIntent = getIntent();
        Bundle b = myIntent.getExtras();
        name = b.getString("name");
        email = b.getString("email");
        mobile = b.getString("mobile");

         Log.e("Name String", name);
            Log.e("email String", email);
            Log.e("mobile String", mobile);

          nameTXT=(TextView)findViewById(R.id.name_TXT); 

            callBTN=(Button)findViewById(R.id.call_BTN);
            messageBTN=(Button)findViewById(R.id.message_BTN);
            emailBTN=(Button)findViewById(R.id.email_BTN);
            referBTN=(Button)findViewById(R.id.refer_BTN);

           nameTXT.setText(name);
           callBTN.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View arg0) 

            {
                // TODO Auto-generated method stub
                Intent callIntent = new Intent(Intent.ACTION_CALL);
                callIntent.setData(Uri.parse("tel:"+ mobile));
                startActivity(callIntent);

            }

        });

           messageBTN.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
            Log.e("MainClass","to find mobile number"+mobile);
                Intent intentSendMessage=new Intent(MainClass.this,SmsSender.class);
                intentSendMessage.putExtra("mobile_number",mobile);
                startActivity(intentSendMessage);

            }
        });
           emailBTN.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub

                Intent intentEmail =new Intent(MainClass.this,EmailSender.class);
                intentEmail.putExtra("mail_Str",email);
                startActivity(intentEmail);

            }
        });

           referBTN.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub

                Intent intentRefer=new Intent(MainClass.this,References.class);
                intentRefer.putExtra("emailAgent",email);

                startActivity(intentRefer);

            }
        });

    }

} 
```

“B”类作为参考：

```
package com.cql.ins;

import org.json.JSONException;
import org.json.JSONObject;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.ViewDebug.FlagToString;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

import com.cqlsys.help.UserFunctions;

public class References  extends Activity
{

    EditText nameEDt,emailEDt,phoneEDt,commentEDT;
    TextView errorTXT;
    Button referenceSendBTN;

    String emailReferAgent;

    // JSON Response node names
        private static String KEY_SUCCESS = "status";
        private static String KEY_Message ="message";
        private static String KEY_ERROR = "error";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.references_layout);

        Intent emailIntent = getIntent();
        Bundle d = emailIntent.getExtras();
        emailReferAgent = d.getString("emailAgent");

        nameEDt=(EditText)findViewById(R.id.name_Refer_EDt);
        emailEDt=(EditText)findViewById(R.id.email_Refer_EDT);
        phoneEDt=(EditText)findViewById(R.id.phone_refer_EDT);
        commentEDT=(EditText)findViewById(R.id.comment_Refer_EDT);
        errorTXT=(TextView)findViewById(R.id.errorTXT);
        referenceSendBTN=(Button)findViewById(R.id.refer_send_BTN);

        referenceSendBTN.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View arg0) {
                // TODO Auto-generated method stub
                String nameReferStr = nameEDt.getText().toString();
                String emailReferStr = emailEDt.getText().toString();
                String phoneReferStr =phoneEDt.getText().toString();
                String commentReferStr =commentEDT.getText().toString();    

            UserFunctions userFunction = new UserFunctions();

                JSONObject json =userFunction.referUser(nameReferStr, emailReferStr, phoneReferStr,commentReferStr,emailReferAgent);

                // check for  response
                try {
                    if (json.getString(KEY_SUCCESS) != null) {
                        errorTXT.setText("hello");
                        String res = json.getString(KEY_SUCCESS); 
                        Log.e("REferences Status Tag", res);

                        if(Boolean.parseBoolean(res) == true){
                            // user successfully submit
                            //Toast.makeText(getApplicationContext(), "msg msg", Toast.LENGTH_SHORT).show();
                            Intent intentbackMainClass=new Intent(References.this,MainClass.class);
                            //intentbackMainClass.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); 
                            startActivity(intentbackMainClass);
                            finish();
                        }else{
                            // Error in submit the data
                            errorTXT.setText("Error occured in registration");
                        }

                    }
            }
                 catch (JSONException e) {
                        e.printStackTrace();
                    }
            }
        });

    }

} 
```

但我得到以下异常：

** threadid = 1：线程退出未捕获的异常（组= 0x4001d800）01-19 02：43：27.507：E / AndroidRuntime（13801）：致命异常：主要01-19 02：43：27.507：E / AndroidRuntime（13801 ): java.lang.RuntimeException: 无法启动活动 ComponentInfo{com.cqlsys.insagent/com.cql.ins.MainClass}: java.lang.NullPointerException **

```
01-19 02:43:27.507: E/AndroidRuntime(13801):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
01-19 02:43:27.507: E/AndroidRuntime(13801):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
01-19 02:43:27.507: E/AndroidRuntime(13801):    at android.app.ActivityThread.access$2300(ActivityThread.java:125)
01-19 02:43:27.507: E/AndroidRuntime(13801):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
01-19 02:43:27.507: E/AndroidRuntime(13801):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-19 02:43:27.507: E/AndroidRuntime(13801):    at android.os.Looper.loop(Looper.java:123)
01-19 02:43:27.507: E/AndroidRuntime(13801):    at android.app.ActivityThread.main(ActivityThread.java:4627)
01-19 02:43:27.507: E/AndroidRuntime(13801):    at java.lang.reflect.Method.invokeNative(Native Method)
01-19 02:43:27.507: E/AndroidRuntime(13801):    at java.lang.reflect.Method.invoke(Method.java:521)
01-19 02:43:27.507: E/AndroidRuntime(13801):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
01-19 02:43:27.507: E/AndroidRuntime(13801):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
01-19 02:43:27.507: E/AndroidRuntime(13801):    at dalvik.system.NativeStart.main(Native Method)
01-19 02:43:27.507: E/AndroidRuntime(13801): Caused by: java.lang.NullPointerException
01-19 02:43:27.507: E/AndroidRuntime(13801):    at com.cqlsys.insagent.MainClass.onCreate(MainClass.java:39)
01-19 02:43:27.507: E/AndroidRuntime(13801):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
01-19 02:43:27.507: E/AndroidRuntime(13801):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
01-19 02:43:27.507: E/AndroidRuntime(13801):    ... 11 more 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:33:53.503

我不确定，但是如果您没有从活动 B 传递任何内容并将“b”设为 Null，则可能会发生这种情况。

而不是下面的代码。在您可以通过 Intent 获得所有想要的值之后，您应该首先检查是否**b==null 或 Not 。**

所以与其

```
 Bundle b = myIntent.getExtras();
        name = b.getString("name");
        email = b.getString("email");
        mobile = b.getString("mobile"); 
```

试试下面的代码。

```
Bundle b = myIntent.getExtras();
  if(b!=null){

            name = b.getString("name");
            email = b.getString("email");
            mobile = b.getString("mobile");
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:35:31.497

尝试使用，getExtras 上面`setContentView()`

```
 Intent emailIntent = getIntent();
  Bundle d = emailIntent.getExtras();
  emailReferAgent = d.getString("emailAgent"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T09:31:19.700

我猜是因为这些的值为空，

```
 name = b.getString("name");
    email = b.getString("email");
    mobile = b.getString("mobile"); 
```

但是您尝试在此处的日志中打印它们，

```
 Log.e("Name String", name);
            Log.e("email String", email);
            Log.e("mobile String", mobile); 
```

问题是，我没有看到你从调用 startActivity() 的地方传递额外的东西，因此它们在这里为空，你得到了异常。

如果您不希望您的日志使您的应用程序崩溃，请像这样编辑您的日志，

```
 Log.e("Name String", name+"");
                Log.e("email String", email+"");
                Log.e("mobile String", mobile+""); 
```

因此，如果值为 null，则打印“null”，如果不是，则打印值本身。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T09:44:17.303

```
nameTXT.setText(name); 
```

这似乎是您尝试设置名称文本时的问题，如果名称没有返回任何值，那么它将生成`nullpointerexception`.

请检查您从 B 类到 A 类时是否获得了价值。

# c# - 无法在 FluentNHibernate 下使用自动 id 更新 PostgreSQL 表

> ID：14435705
> 
> 赞同：1
> 
> 时间：2013-01-21T09:29:08.203
> 
> 标签：c#, postgresql, nhibernate, fluent-nhibernate

当使用 SchemaUpdate() 将具有自动递增 id 的映射类导出到 PostgreSQL 服务器时，会引发以下异常： **“错误：42P07：关系“seq_wuf”已经存在”。**

抛出异常是因为表和序列确实存在于服务器中，但我希望 SchemaUpdate() 忽略已经存在的序列。

映射表

```
public class CategoryMap : ClassMap<Category>
{
    public static string tableName = "miao";
    public CategoryMap()
    {
        SchemaAction.Export();
        Table(tableName);
        Id(x => x.Id).GeneratedBy.Sequence("SEQ_" + tableName);
        Map(x => x.Name).Column("Category")
                .CustomType("String")
                .Access.Property()
                .Generated.Never()
                //.CustomSqlType("nvarchar(50)")  // <----
                .Not.Nullable()
                .Length(50); ;
        Map(x => x.Description);
    }
} 
```

导出架构：

```
 FluentConfiguration config = Fluently.Configure();
        config
        .Database(PostgreSQLConfiguration
        .Standard
        .ConnectionString(connStringPosgtgres))
        .Mappings(m => m.FluentMappings.Add(typeof (CategoryMap)))
        .ExposeConfiguration(UpdateSchema)
        .BuildConfiguration(); 
```

架构更新（）

```
private static void CreateSchema(Configuration cfg)
    {
        var schemaExport = new SchemaExport(cfg);
        schemaExport.Drop(false, true);
        schemaExport.Create(false, true);
    } 
```

谢谢，尤瓦尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T08:53:04.197

我发现了为什么会发生这种情况。基本上，虽然 ScemaUpdate 可以创建自动 ID 序列，但它无法检查该序列是否存在于数据库中，因此会尝试重新创建一个现有的对象来提示错误消息。

NHibernate 使用此代码检查序列（src：[https](https://github.com/nhibernate/nhibernate-core/blob/master/src/NHibernate/Dialect/Schema/AbstractDataBaseSchema.cs) ://github.com/nhibernate/nhibernate-core/blob/master/src/NHibernate/Dialect/Schema/AbstractDataBaseSchema.cs ）。我试图玩弄它一段时间，也无法从中检索序列。

```
public virtual DataTable GetTables(string catalog, string schemaPattern, string 
tableNamePattern, string[] types){
var restrictions = new[] { catalog, schemaPattern, tableNamePattern }; 
return connection.GetSchema("Tables", restrictions);\
} 
```

尤瓦尔。

# c# - 是否可以通过在 Visual Studio 2008 中运行时获取值来忽略特定代码以使用条件编译常量进行编译？

> ID：14435706
> 
> 赞同：1
> 
> 时间：2013-01-21T09:29:26.517
> 
> 标签：c#, conditional-compilation

我有一个要求，我使用 microsoft powerpoint 功能在 c# 中使用 Microsoft core dll 将 ppt 转换为视频文件。我的机器上安装了 Microsoft Office 2010。因此，代码在找到 GAC 中存在的 dll 时可以正确编译。

现在我想在没有安装 Microsoft Office 2010 的机器上编译相同的代码。

是否可以使用条件编译常量，或者有什么办法可以做到这一点？

谢谢， 卡兰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:31:00.570

不，条件编译*只是*编译时定义。

你*能*想到的是*依赖注入*。这样，您不必在*编译时定义程序集和办公室程序集之间的关系，而是在**运行时*根据请求将该程序集加载到内存中。

例如，可以看看：

[依赖注入：初学者指南](http://stevescodingblog.co.uk/dependency-injection-beginners-guide/)

或者更完整（但也更复杂！）的解决方案

[哪些 .NET 依赖注入框架值得研究？](https://stackoverflow.com/questions/21288/which-net-dependency-injection-frameworks-are-worth-looking-into)

# c++ - 在派生类中使用基类的模板参数

> ID：14435710
> 
> 赞同：3
> 
> 时间：2013-01-21T09:29:36.897
> 
> 标签：c++, templates, polymorphism

考虑 C++ 中的以下情况：

```
template<int n>
class Base { ... };

class Derived3 : public Base<3> {
  // a complicated body, making use of n=3
};

class Derived7 : public Base<7> {
  // a completely different body, making use of n=7
}; 
```

在`Derived3`成员函数内部，我想显式使用`n=3`, 和内部`Derived7`, `n=7`，而不对数字进行硬编码，即，仍然引用模板参数之类的东西`n`。我想到了以下选项：

1.  还将派生类模板化`n`，然后使用`typedef`. 这样，派生类知道`n`：

    ```
    template<int n>
    class DerivedTemplate3 : public Base<n> { ... };
    typedef DerivedTemplate3<3> Derived3;

    template<int n>
    class DerivedTemplate7 : public Base<n> { ... };
    typedef DerivedTemplate7<7> Derived7; 
    ```

    这样做的问题是`DerivedTemplateX`除了 之外什么都有意义`n=X`，所以这感觉就像在滥用模板范式。

2.  使用静态 const 成员存储`n`，`Base`并在派生类中引用它：

    ```
    template<int n>
    class Base {
    protected:
      static const int nn = n;
      ...
    };

    class Derived3 : public Base<3> {
      // refer to nn=3
    };

    class Derived7 : public Base<7> {
      // refer to nn=7
    }; 
    ```

    这里的问题是我似乎不能使用相同的标识符（`nn`vs. `n`）。另外，我不确定这是否允许我`nn`用作派生类成员的模板参数。

那么：如何以非冗余、高效的方式实现这一点？`static const int`也许在某处使用某种成员身份？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T09:34:13.893

标准做法是使用大写字母作为模板参数，然后使用小写的静态 const 值：

```
template<int N>
class Base {
protected:
  static const int n = N;
  ...
}; 
```

然后你在任何地方都使用小写的静态常量值`n`——不要`N`在其他任何地方使用。

> 另外，我不确定这是否允许我使用 nn 作为派生类成员的模板参数。

它是一个常量表达式，因此可以用作模板参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:35:17.187

这对你有用吗？

```
template<int n>
class Base {
protected:
    static const int MyN = n;
};

class Derived3 : public Base<3> {
    void f()
    {
        std::cout << MyN;
    }
};

class Derived7 : public Base<7> {
    void f()
    {
        std::cout << MyN;
    }
};

int main()
{

} 
```

# c# - android 应用程序和 ASP.net api 之间的安全通信

> ID：14435712
> 
> 赞同：2
> 
> 时间：2013-01-21T09:29:55.423
> 
> 标签：c#, android, web-services, https

我的 Android 应用程序应该与用`C#.Net`. 从手机发送的数据包含不应向公众公开的数据。所以我正在尝试使用该`https`协议。在我的服务器端，我要求所有请求都是`HTTPS`，如下所示：

**RequireRegisteredImei**

```
public class RequireRegisteredImeiAttribute : AuthorizationFilterAttribute
    {
        public override void OnAuthorization(HttpActionContext actionContext)
        {
            var request = actionContext.ControllerContext.Request;

            if (request.RequestUri.Scheme == Uri.UriSchemeHttps)
            {
               //OKAY
            }
            else 
            {
             actionContext.Response = new HttpResponseMessage(HttpStatusCode.Forbidden);
            }
        }
     } 
```

**在控制器中**：

```
[RequireRegisteredImei]
public string Post()
{
} 
```

我通过从我的手机发送一个简单的来调试这段代码`http request`，这段代码运行得很好，它会拒绝我。

所以，我开始研究如何`https`从我的安卓手机发送请求。我想出了这样的事情：

```
public static DefaultHttpClient getSecureHttpClient() {
        SchemeRegistry schemeRegistry = new SchemeRegistry();
        schemeRegistry.register(new Scheme("https", SSLSocketFactory.getSocketFactory(), 443));
        schemeRegistry.register(new Scheme("http", SSLSocketFactory.getSocketFactory(), 80));
        BasicHttpParams params = new BasicHttpParams();
        SingleClientConnManager mgr = new SingleClientConnManager(params, schemeRegistry);
        return new DefaultHttpClient(mgr, params);
    } 
```

我以这种方式使用这种方法：

```
HttpClient httpClient = CustomHttpClient.getSecureHttpClient(); 
```

这只会导致`IOException: No peer certificate`

我已经阅读了几个关于此的主题：

[android中的https（无对等证书）问题](https://stackoverflow.com/questions/9531710/problems-with-https-no-peer-certificate-in-android)

[Android SSL - 无对等证书](https://stackoverflow.com/questions/8806128/android-ssl-no-peer-certificate)

[Android 2.3 中的“无对等证书”错误，但 4 中没有](https://stackoverflow.com/questions/9574870/no-peer-certificate-error-in-android-2-3-but-not-in-4)

但是必须有一种更简单的方法来`HTTPS`从 android 发布数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:59:25.057

如果您有自定义证书或由 CA 颁发的证书，但并非所有 Android 版本都包含，您可以将证书包含到您的应用程序中并直接使用它。

为此，您必须将您的服务器证书（当然没有密钥）导入 BKS 密钥库，然后可以将其用作自定义信任库。

一个很好的教程描述了如何做到这一点是**[Using a Custom Certificate Trust Store on Android](http://nelenkov.blogspot.de/2011/12/using-custom-certificate-trust-store-on.html)**。

与您在 Stackoverflow 中发现的 EasyTrustManager 或 DummyTrustManager 等标准解决方案不同，此解决方案不会禁用 SSL 的身份验证，因此不会像其他解决方案那样不安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T10:49:11.180

您还可以将 配置`HttpClient`为接受所有证书，如下所示：

```
 SSLSocketFactory sslSocketFactory=SSLSocketFactory.getSocketFactory();
    HostnameVerifier hostnameVerifier=org.apache.http.conn.ssl.SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER;
    sslSocketFactory.setHostnameVerifier((X509HostnameVerifier) hostnameVerifier);

    SchemeRegistry schemeRegistry = new SchemeRegistry();
    schemeRegistry.register(
            new Scheme("http", PlainSocketFactory.getSocketFactory(), 80));
    schemeRegistry.register(
            new Scheme("https", sslSocketFactory, 443)); 
```

如果您认为这可能是您的解决方案。

# php - 没有身份验证的 CakePHP v2 域用户名？

> ID：14435721
> 
> 赞同：0
> 
> 时间：2013-01-21T09:30:36.847
> 
> 标签：php, cakephp, cakephp-2.0

我正在一个小型内部站点上工作（= 用户使用域凭据登录到他们的计算机）。在“标准” PHP get_current_user() 上，它就像一个魅力，在蛋糕上却没有。我正在尝试找到一种方法，我可以在不触发 Auth 组件/完整登录对话框的情况下获取用户名，因为用户已经登录。

我看到的每个建议/线程都涉及到 Auth 组件，这真的很麻烦。

**编辑：** get_current_user() 返回“root”，我想这可能是因为路由或内部/故意的？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T11:43:09.677

我看不到您如何`get_current_user()`用于用户身份验证。根据 PHP 手册，它“获取当前 PHP 脚本所有者的名称”。现在，无论谁访问它，脚本所有者（创建 php 文件的用户）总是相同的。

另外，正如 Oldskool 上面所说的，CakePHP 仍然是 PHP。

# php - WAMP MySQL PDO_extension 错误

> ID：14435728
> 
> 赞同：0
> 
> 时间：2013-01-21T09:31:17.357
> 
> 标签：php, mysql, pdo, wamp, wampserver

我想使用 PDO 扩展连接 MySQL 数据库。我正在使用 PHP 5.4

```
 $db = new PDO('mysql:host=localhost:8080;dbname=films_db;charset=UTF-8', 'root', '');

$query = "SELECT * FROM employee";

$result = $db->query($query);

while($row = $result->fetch(PDO::FETCH_ASSOC)) {
    print_r($row);
}

$result->closeCursor(); 
```

但是，我的 WAMP 服务器没有响应。我没有得到任何结果。它的“等待本地主机”状态并出现服务器超时错误。

请帮我解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:44:00.427

8080端口用于http，
一般不用于mysql。

并且默认的 mysql 端口是 3306。
您可能需要检查 mysql 设置以“确认”正在使用的实际端口。

除此之外，您可能需要检查员工表中有多少条记录。
如果有数百万条记录，这可能是加载需要时间的原因。

# iphone - 解决方案中无法访问文件夹路径头文件

> ID：14435733
> 
> 赞同：0
> 
> 时间：2013-01-21T09:31:50.217
> 
> 标签：iphone, objective-c

[我按照此链接教程](http://www.blog.montgomerie.net/easy-xcode-static-library-subprojects-and-submodules#Create_an_Xcode_project_for_the_static_library)将一个项目导入另一个项目

成功构建了这两个项目。但是当我将 `#import <SampleSubproject/SampleSubproject.h>` 它添加到我的主`ViewController.m`文件时会发生错误。错误：**找不到“SampleSubproject/SampleSubproject.h”文件。**

![在此处输入图像描述](../Images/c896857619a49e9a1fb775c53515029f.png)

为什么会出现这个错误？？有什么错误吗？请帮帮我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:45:34.110

您`Headers search path`在项目配置中有设置。假设有目录`A`和`B`. 使用“SampleSubproject/SampleSubproject.h”Xcode 查找`SampleSubproject.h`at`A/SampleSubproject/SampleSubproject.h`和`B/SampleSubproject/SampleSubproject.h`. 如果有`recursive`任何目录的选中标志，则在此目录及其子目录中执行搜索。

现在您需要检查您正在构建的目标的标头搜索路径是什么，记住您可能有多个目标，并且导入的文件可能不会包含在所有目标中。

* * *

由于您还有一个红色库，因此您也需要检查一下`Libraries search path`，它的工作方式相同。

# ruby-on-rails - 尝试运行 POW 时出现神秘错误

> ID：14435735
> 
> 赞同：2
> 
> 时间：2013-01-21T09:31:57.943
> 
> 标签：ruby-on-rails, rack, rack-pow

为我的 rails 应用程序运行 POW 时，我收到一条相当奇怪的错误消息。

我按照说明进行操作：

```
- cd ~/.pow
- ln -s /Users/mingyeow/Dailymuses-Server-Side 
```

得到了这个：

```
Error starting application
Your Rack app raised an exception when Pow tried to run it.
Error: '/Users/mingyeow/Dailymuses-Server-Side/.powrc' failed to load:
true &&
source '/Users/mingyeow/Dailymuses-Server-Side/.powrc' > /dev/null &&
env > '/var/folders/cl/fd2wt82149x9trkxmsvqrt500000gn/T/pow.18625.1358760244196.27206'
Error: '/Users/mingyeow/Dailymuses-Server-Side/.powrc' failed to load:
true &&
source '/Users/mingyeow/Dailymuses-Server-Side/.powrc' > /dev/null &&
env > '/var/folders/cl/fd2wt82149x9trkxmsvqrt500000gn/T/pow.18625.1358760244196.27206'
    at ChildProcess.exithandler (child_process.js:282:15)
    at ChildProcess.emit (events.js:70:17)
    at maybeExit (child_process.js:362:16)
    at Process.onexit (child_process.js:398:5) 
```

尝试重置我能找到的所有内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:03:22.707

我今天在安装 Octopress 时遇到了完全相同的错误。

您的 .powrc 是否如下所示？

```
if [ -f "$rvm_path/scripts/rvm" ] && [ -f ".rvmrc" ] ; then
   source "$rvm_path/scripts/rvm"
   source ".rvmrc"
fi 
```

这是 Octopress 提供的，但我想它很通用。

在我的例子中，我修改了`.rvmrc`文件并且它包含一个语法错误。我纠正了错误，删除了符号链接`~/.pow`并再次创建它，一切都恢复正常了。

希望有帮助！
（如果没有，也许你应该用你的文件内容更新你的问题`.powrc`）

# json - 如何在 solr 中索引嵌套的 json 对象

> ID：14435736
> 
> 赞同：1
> 
> 时间：2013-01-21T09:32:04.410
> 
> 标签：json, solr, indexing

我有一个像这样的 json 对象，

```
{  
"id" : "123",  
"name" : "aaa",  
"loc" : {  
 "lat" : "",  
 "lon" : ""  
},  
} 
```

在 solr 我添加了一个字段

```
<field name="loc" type="string" indexed="true" stored="true" multiValued="true"/> 
```

然后我尝试将 json doc 添加到 solr
但我看不到 'loc' 对象在 solr 中被索引。
我做错了吗？我需要在 schema.xml 中添加任何内容
有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:36:48.310

恐怕您必须将嵌套对象展平才能变成类似的东西

```
loc_lat = value of loc.lat
loc_lon = value of loc.lon 
```

当然，还有两个用于存储数据的新字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T15:29:11.917

你是如何添加 JSON 的？因为它看起来不像[Solr 所需的格式](http://wiki.apache.org/solr/UpdateJSON)。

你需要遵守这一点。此外，如果这些纬度/经度确实是地理坐标，Solr 有专门的[地理空间支持](http://wiki.apache.org/solr/SpatialSearch)。尽管您需要在客户端或使用[UpdateRequestProcessor](http://wiki.apache.org/solr/UpdateRequestProcessor)之类的工具（很可能是[ConcatFieldUpdateProcessorFactory](http://lucene.apache.org/solr/4_0_0/solr-core/org/apache/solr/update/processor/ConcatFieldUpdateProcessorFactory.html) ）将数据转换为适当的形状。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-02T11:22:26.900

发布到

/solr/update/json?commit=true? **拆分=/&f=txt:/****

见[http://lucidworks.com/blog/schemaless-solr-part-1/](http://lucidworks.com/blog/schemaless-solr-part-1/)

# ethernet - 用于从 phy 层读取位的低级以太网驱动程序

> ID：14435737
> 
> 赞同：14
> 
> 时间：2013-01-21T09:32:04.957
> 
> 标签：ethernet, raw-ethernet

是否可以从标准计算机以太网接口直接从物理以太网连接接口读取位？

例如，假设我想将笔记本电脑的以太网插孔用作差分逻辑探头（使用标准以太网电缆）。我是否可以潜在地编写一个驱动程序来获取位或驱动程序可以达到多低的限制？

本质上，物理层只是将比特流发送到设备驱动程序，还是进行任何会影响比特解释或导致设备故障（例如使用不同的编码方案）的解码。

我想归根结底是，我们是否可以通过编写合适的驱动程序将以太网端口用作任何标准的数字差分通信链路，或者我们是否仅限于 ieee 规范（8b/10b 等）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-03-02T06:33:52.197

简短地回答，可能不会。

以下是其中的一些原因：

**在硬件链路层**上，计算机和以太网电缆之间实际上没有电气连接，它通过小型变压器进行电气隔离，并且是电流而不是电压驱动信号，所以这将是第一个要克服的问题，就像你一样在两条线上发送相当精确的电流，而不是在一条线上发送电压。 [以太网变压器](http://www.haloelectronics.com/products/lan/ethernet/discrete-transformers/10-100base-tx/)

**PHY 硬件接口：**然后下一步，这根本不是由执行代码的 CPU 控制，而是由以太网 PHY 芯片接口控制，而且你没有（简单的）方法来闪烁和控制它。一些不同的 PHY 芯片允许您进行不同级别的访问，但我怀疑您会找到任何可以让您直接控制传输接口的芯片，即使可以，也必须将其实现到驱动程序中，这也是不太可能的。 [以太网 PHY 控制器](https://en.wikipedia.org/wiki/PHY_(chip)#Ethernet_physical_transceiver)

**也许** 上面评论的其他一些解决方案，如果您想在计算机上进行直接 IO 控制，最好的解决方案是通过串行或并行端口，也许您可​​以找到以太网到串行或 USB 到串行端口，然后使用它但是这将是数字信号。

您可能想要使用的另一件事是麦克风输入，因为它接受模拟信号并且您可以直接控制它，但请注意不要烧毁您的计算机。（我见过一些在手机上使用的银行卡磁条）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-03T13:46:15.523

您可以使用 libpcap/WinPcap 来执行此操作。尽管如此，您在选择在线上写/读的内容时并不是完全自由的。例如序言和SFD 必须仍然存在。这是非常基本的（因为抗噪性），以至于典型的硬件不支持任何不同的东西。

如果您想完全控制一切，请使用嵌入式硬件，找到一块使用可以为您提供信息的 PHY 和能够处理数据速率的处理器的板。

# scrapy - 使用scrapy将完整链接添加到短链接以使其有效？

> ID：14435739
> 
> 赞同：1
> 
> 时间：2013-01-21T09:32:16.907
> 
> 标签：scrapy

> **可能重复：**
> [Scrapy 修改链接以包含域名](https://stackoverflow.com/questions/14117059/scrapy-modify-link-to-include-domain-name)

我使用此代码从 html 网站中提取数据，并将数据存储在 XML 文件中，它对我很有用。

```
def parse(self, response):
    hxs = HtmlXPathSelector(response)
    items = []
    site1 = hxs.select('/html/body/div/div[4]/div[3]/div/div/div[2]/div/ul/li')
    for site in site1:
        item = NewsItem()

        item ['title'] = site.select('a[2]/text()').extract()
        item ['image'] = site.select('a/img/@src').extract()
        item ['text'] = site.select('p/text()').extract()
        item ['link'] = site.select('a[2]/@href').extract()

        items.append(item)

    return items 
```

但我面临的问题是该网站为 ['image'] 提供了一个短链接，如下所示：

```
<img src="/a/small/72/72089be43654dc6d7215ec49f4be5a07_w200_h180.jpg" 
```

而完整的链接应该是这样的：

```
<img src="http://www.aleqt.com/a/small/72/72089be43654dc6d7215ec49f4be5a07_w200_h180.jpg" 
```

我想知道如何修改我的代码以自动添加缺少的链接

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T01:15:23.633

你可以试试这个

`item ['link'] = urljoin(response.url, site.select('a[2]/@href').extract())`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T01:08:43.863

假设所有这些图片链接只需要添加“http://www.aleqt.com”，你可以这样做：

```
def parse(self, response):
    base_url = 'http://www.aleqt.com'
    hxs = HtmlXPathSelector(response)
    items = []
    site1 = hxs.select('/html/body/div/div[4]/div[3]/div/div/div[2]/div/ul/li')
    for site in site1:
        item = NewsItem()    
        item ['title'] = site.select('a[2]/text()').extract()
        item ['image'] = base_url + site.select('a/img/@src').extract()
        item ['text'] = site.select('p/text()').extract()
        item ['link'] = base_url + site.select('a[2]/@href').extract()
        items.append(item)
    return items 
```

或者，如果您已将完全相同的 url 添加到 start_urls 列表中（假设只有一个，您可以替换`base_url`为`self.start_urls[0]`

# java - 使用 Java Mail 发送邮件时，在握手异常期间远程主机关闭连接

> ID：14435740
> 
> 赞同：3
> 
> 时间：2013-01-21T09:32:17.750
> 
> 标签：java, ssl, email

我正在使用 Java 邮件 API 版本。1.4.2 用于在基于 JSF 1.2-Spring 的 Web 应用程序中发送电子邮件。我正在使用非安全 SMTP 连接发送邮件。此电子邮件配置独立运行良好。还使用 JUnit 4 测试验证了此实用程序，并且我能够使用非安全连接发送邮件。

当我将此电子邮件模块与主 Web 应用程序集成时，我在发送邮件时在运行时收到以下异常。

> javax.mail.MessagingException：异常读取响应；嵌套异常是：javax.net.ssl.SSLHandshakeException：在 com.sun.mail.smtp.SMTPTransport.readServerResponse(SMTPTransport.java:1764) 在 com.sun.mail.smtp.SMTPTransport.openServer( SMTPTransport.java:1523) 在 com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:453) 在 javax.mail.Service.connect(Service.java:317) 在 javax.mail.Service.connect(Service .java:176) 在 javax.mail.Service.connect(Service.java:125) 在 javax.mail.Transport.send0(Transport.java:194) 在 javax.mail.Transport.send(Transport.java:124)

使用安全 SMTP 连接验证此电子邮件模块，它工作正常。

有人对这个问题有想法吗？为什么非安全 SMTP 连接无法与 Web 应用程序集成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T14:33:20.443

我将电子邮件模块用于安全和非安全连接。在以下属性中导致了问题： props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");

为非安全连接删除了此属性，现在我的非安全 SMTP 连接正在与 Web 应用程序集成。

# javascript - 将字符串作为属性传递给对象

> ID：14435741
> 
> 赞同：1
> 
> 时间：2013-01-21T09:32:21.837
> 
> 标签：javascript, json

```
function createObject(arg1, arg2){ 
       var object = {};
           object.arg1 = arg2;
} 
```

我这样调用我的函数。

```
 createObject('name', objectproperties); 
```

我面临的问题是请求对象何时形成。它是这样的

```
{"arg1":{"Properties":"Value"}} 
```

我希望我的对象是这样形成的。它是一个通用类，我正在为要形成的许多请求创建它。

```
{"name":{"Properties":"Value"}} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T09:33:21.340

使用方括号表示法：

```
object[arg1] = arg2; 
```

**参考：** [http ://www.jibbering.com/faq/faq_notes/square_brackets.html#vId](http://www.jibbering.com/faq/faq_notes/square_brackets.html#vId)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:34:02.283

```
object[arg1] = arg2; 
```

那应该行得通。

# javascript - Comet 和客户端缓存

> ID：14435742
> 
> 赞同：0
> 
> 时间：2013-01-21T09:32:26.690
> 
> 标签：javascript, asp.net, caching, comet

我正在使用需要通知系统（类似于 Facebook 通知）的 Asp.net 开发 webapp，我正在考虑使用 Comet。但我也想缓存服务器响应，因此对于每个浏览器实例，我不需要将请求发送到服务器。

我正在考虑的方式是使用cookies作为中间存储来缓存数据和标记响应时间，所以当有请求时，它首先检查这个时间戳，如果它过期然后设置一个锁并将请求发送到服务器和更新缓存的数据。

除了使用 cookie 之外，还有什么可以实现的功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T09:25:11.263

您可以使用[html5 localstorage](http://diveintohtml5.info/storage.html)。
大多数现代浏览器，包括基于手机的浏览器都支持它。

```
// Store value on the browser beyond the duration of the session
localStorage.setItem('key', 'value');

// Retrieve value (works even after closing and re-opening the browser)
alert(localStorage.getItem('key')); 
```

也就是说，像 facebook 这样的网站上的通知经常变化，而且数据量很小。您可能不会从缓存中获得太多优势。

# java - 应用被反复打开

> ID：14435744
> 
> 赞同：2
> 
> 时间：2013-01-21T09:32:33.837
> 
> 标签：java, android, multithreading

我正在开发一个应用程序。当我退出应用程序时，它将再次打开（第一个活动被一次又一次地调用）。所以我无法退出它。

在其他一些活动中，我使用 EXIT 按钮和正确的代码退出。即使我在这些活动上单击“退出”按钮，它也会开始登录活动。（登录页面打开）

在我的应用程序中，我使用

1) 主要

2) 屏幕活动

3) 登录

流程：（从 main->screenActivity->login）

起始页（第一个活动）发布在下面

```
public class main extends Activity {
static ConnectivityManager conMgr;

BackgroundThread backgroundThread;
TextView myText;
boolean myTextOn = true;
Cursor cursor;
String response="";
public SQLiteAdapter mySQLiteAdapter;

private  SQLiteDatabase sqLiteDatabase;
SimpleCursorAdapter cursorAdapter;

public class BackgroundThread extends Thread {

boolean running = false;

 void setRunning(boolean b){
 running = b;
}

@Override
 public void run() {
 // TODO Auto-generated method stub
 //super.run();
 while(running){
  try {
  sleep(1000);
 } catch (InterruptedException e) {
// TODO Auto-generated catch block
e.printStackTrace();
 }
catch(Exception e)
{

}
handler.sendMessage(handler.obtainMessage());
}
}

}

Handler handler = new Handler(){

 @Override
 public void handleMessage(Message msg) {
 // TODO Auto-generated method stub
 //super.handleMessage(msg);
 if (myTextOn){
  myTextOn = false;
  myText.setVisibility(View.GONE);
 }
 else{
  myTextOn = true;
  myText.setVisibility(View.VISIBLE);
 }
}

};

  @Override
   public void onCreate(Bundle savedInstanceState) {
   super.onCreate(savedInstanceState);
   setContentView(R.layout.thread);

   myText = (TextView)findViewById(R.id.mytext);

}

@Override
protected void onStart() {
conMgr =  (ConnectivityManager)getSystemService(CONNECTIVITY_SERVICE);
// TODO Auto-generated method stub
super.onStart();
if(isInternetAvailable())
{
 Toast.makeText(this, "online", Toast.LENGTH_LONG).show();

startActivity(new Intent(main.this, ScreenActivity.class));
}
else{

    startActivity(new Intent(main.this, splashscreen.class));

    Toast.makeText(this, "offline", Toast.LENGTH_LONG).show();

}

 backgroundThread = new BackgroundThread();
 backgroundThread.setRunning(true);
   backgroundThread.start();

}

private boolean isInternetAvailable() {
ConnectivityManager cm=(ConnectivityManager)getSystemService(Context.CONNECTIVITY_SERVICE);
NetworkInfo netInfo = cm.getActiveNetworkInfo();
if (netInfo != null && netInfo.isConnectedOrConnecting()) {
return true;
}
return false;

}

@Override
protected void onStop() {
// TODO Auto-generated method stub
super.onStop();

boolean retry = true;
backgroundThread.setRunning(false);

 while(retry){
 try {
 backgroundThread.join();
 retry = false;
} catch (InterruptedException e) {
 // TODO Auto-generated catch block
 e.printStackTrace();
}
catch(Exception e)
{

}

}

}

public void onDEstroy()
{
super.onDestroy();
}
} 
```

屏幕活动：

```
public class ScreenActivity extends Activity implements AnimationListener {
private TextView animatedView3; 
//ImageView image;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.splash); 

   /* Animation animation1 = AnimationUtils.loadAnimation(this,  
            R.anim.anima);  
    animation1.setAnimationListener(this);  
    View animatedView1 = findViewById(R.id.aet1);  
    animatedView1.startAnimation(animation1);  

    /** set time to splash out */

    final int welcomeScreenDisplay = 9000;
    /** create a thread to show splash up to splash time */
    Thread welcomeThread = new Thread() {

        int wait = 0;

        @Override
        public void run() {
            try {
                super.run();
                /**
                 * use while to get the splash time. Use sleep() to increase
                 * the wait variable for every 100L.
                 */
                while (wait < welcomeScreenDisplay) {
                    sleep(100);
                    wait += 100;
                }
            } catch (Exception e) {
                System.out.println("EXc=" + e);
            } finally {
                /**
                 * Called after splash times up. Do some action after splash
                 * times up. Here we moved to another main activity class
                 */
                startActivity(new Intent(ScreenActivity.this,
                        login.class));

            }
        }
    };
    welcomeThread.start();

}

public void onAnimationStart(Animation animation) {  

}  

public void onAnimationEnd(Animation animation) {  
    //Toast.makeText(this, "Animation ended", Toast.LENGTH_SHORT).show();  
    if (animatedView3.getVisibility() == View.VISIBLE) {  
        animatedView3.setVisibility(View.INVISIBLE);  
    } else {  
        animatedView3.setVisibility(View.VISIBLE);  
    }  
}  

public void onAnimationRepeat(Animation animation) {  
   // Toast.makeText(this, "Animation rep", Toast.LENGTH_SHORT).show();  

}  
} 
```

请任何人解释这个问题以及如何解决它？我不明白。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:37:14.140

放置`finish()`在您的`loginActivity`和其他`Activities`以及其他堆栈中将存储访问列表`Activities`。

# facebook-opengraph - opengraph 协议和 facebook 的 opengraph 之间的界限是什么？

> ID：14435745
> 
> 赞同：1
> 
> 时间：2013-01-21T09:32:36.110
> 
> 标签：facebook-opengraph

我已经阅读了一些关于[OpenGraph](http://ogp.me/)和[Facebook 的 OpenGraph](https://developers.facebook.com/docs/concepts/opengraph/) API 的内容，但我不确定我是否充分理解这些概念以绘制将它们分开的边界。

如果我理解正确的话，opengrahp 协议基本上提供了一些标准符号（一组属性和数据类型）来丰富地描述对象（包括网页）。

在 Facebook 的 Open Graph 页面上，他们基本上通过将活动定义为：用户 + 操作 + 对象来为提要/墙活动添加上下文。

Facebook 的 Open Graph 是否只是开放图元顶部的“扩展”（附加命名空间），但定义了动作和对象的词汇表？或者它是一个实现？

作为 User + Action + Object 的活动概念也是 facebook 命名空间的一部分吗？

我决定悬赏这个问题，所以我期待一个非常完整的答案 =D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T09:29:57.447

我有一些使用 Facebook 的 Open Graph 的经验。如果您有一个网站并且有人在 Facebook 上分享/喜欢您的网站，您的开放图标签将被提取，而 Facebook 将使用其标题、描述、图像等。Facebook 的开放图适用于应用程序。例如，如果您有一个应用程序允许人们显示食谱并在他们烹饪食物时告诉您，“Action”（动词）将是“Cook”。该对象将是“食谱”，您可以将其更改为他们使用您的应用程序制作的任何食物。

一个例子是：“Thomas 用 App Name 煮鸡”

我相信 Facebook 的 Open Graph 只是一个扩展，但您必须遵循他们的标记才能使您的信息正确并正确显示。

我不确定我是否回答了你的问题，但我希望你能弄清楚。

# c# - 通过绝对 URL 访问 MVC3 视图而不显示它

> ID：14435750
> 
> 赞同：0
> 
> 时间：2013-01-21T09:32:59.823
> 
> 标签：c#, asp.net-mvc-3, asp.net-mvc-4, abcpdf

我试图达到的目标：

使用 abcpdf 8 将 MVC3 视图转换为 PDF。

这是一个结果视图，我想切断视图 DOM 的一部分，如导航和其他网站相关部分。

Abcpdf 需要一个绝对 url，才能正确呈现所有 css 格式的 html。但我不想向用户显示结果 PDF 视图。那么如何在不显示视图的情况下通过 URL 从控制器访问视图。始终显示原始结果视图。

提前谢谢你基督徒

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:48:50.303

您不能使用 MVC 直接访问 View，您必须通过 Controller 方法。在 ASP.NET MVC 中，URL 映射到控制器方法，而不是视图。

因此，如果您知道调用 View 的 Controller 方法的 URL，则可以获取该 URL 并将其传递给 ABCPDF。

# c# - 访问运营商信息 windows phone

> ID：14435751
> 
> 赞同：4
> 
> 时间：2013-01-21T09:33:01.473
> 
> 标签：c#, silverlight, windows-phone-7, xaml, windows-phone

> **可能重复：**
> [如何获取芒果的运营商详细信息？](https://stackoverflow.com/questions/6954718/how-to-get-carrier-details-on-mango)

是否可以在 windows phone 中获取运营商信息？我想在应用程序中显示运营商名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:34:31.507

您可以使用 访问此信息`DeviceNetworkInformation.CellularMobileOperator`。

[MSDN 上的 DeviceNetworkInformation.CellularMobileOperator 属性](http://msdn.microsoft.com/en-us/library/microsoft.phone.net.networkinformation.devicenetworkinformation.cellularmobileoperator%28v=VS.92%29.aspx)

```
var operatorName = DeviceNetworkInformation.CellularMobileOperator ?? "(No Network)"; 
```

由于该属性可能是`null`在没有找到网络的情况下，上面的代码将让你要么网络运营商要么`(No Network)`进入`operatorName`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:39:08.773

您可以使用 DeviceNetworkInformation.CellularMobileOperator 获取运营商名称。

有关更多详细信息，请参阅[此](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202875%28v=vs.105%29.aspx)。

# android - 在 GridView 中设置项目长按监听器

> ID：14435753
> 
> 赞同：5
> 
> 时间：2013-01-21T09:33:05.443
> 
> 标签：android, onitemclicklistener

我想添加一个项目长按监听器，它将选择的图像设置为墙纸。我从网络上获取图像并在网格视图中显示它们。我的网格活动如下所示。我已经有一个点击监听器来显示全屏图像。

```
public class ImageGridActivity extends BaseActivity {

String[] imageUrls;

DisplayImageOptions options;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
            WindowManager.LayoutParams.FLAG_FULLSCREEN);

    setContentView(R.layout.ac_image_grid);

    Bundle bundle = getIntent().getExtras();
    imageUrls = bundle.getStringArray(Extra.IMAGES);

    options = new DisplayImageOptions.Builder()
            .showStubImage(R.drawable.stub_image)
            .showImageForEmptyUri(R.drawable.image_for_empty_url)
            .cacheInMemory().cacheOnDisc()
            .bitmapConfig(Bitmap.Config.RGB_565).build();

    GridView gridView = (GridView) findViewById(R.id.gridview);
    gridView.setAdapter(new ImageAdapter());

    // Set Long-Clickable
    gridView.setLongClickable(true);
    gridView.setOnItemLongClickListener(new OnItemLongClickListener() {

        @SuppressLint("NewApi")
        public boolean onItemLongClick(AdapterView<?> parent, View arg1,
                int position, long arg3) {
            // TODO Auto-generated method stub
            ImageAdapter i = (ImageAdapter) parent.getAdapter();
            Bitmap mBitmap = BitmapFactory.decodeResource(getResources(),
                    (int) i.getItemId(position));

            // Get the WallpaperManager
            WallpaperManager myWallpaperManager = WallpaperManager
                    .getInstance(getApplicationContext());

            try {
                // Set the clicked bitmap
                myWallpaperManager.setBitmap(mBitmap);
                Toast.makeText(ImageGridActivity.this, "Wallpaper set",
                        Toast.LENGTH_SHORT).show();
            } catch (IOException e) {
                Toast.makeText(ImageGridActivity.this, "Error setting wallpaper",
                        Toast.LENGTH_SHORT).show();
            }

            return false;
        }
    });

    gridView.setOnItemClickListener(new OnItemClickListener() {

        @SuppressLint("NewApi")
        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            startImageGalleryActivity(position);
        }
    });

    gridView.setOnScrollListener(new PauseOnScrollListener(true, true));

}

private void startImageGalleryActivity(int position) {
    Intent intent = new Intent(this, ImagePagerActivity.class);
    intent.putExtra(Extra.IMAGES, imageUrls);
    intent.putExtra(Extra.IMAGE_POSITION, position);
    startActivity(intent);
}

public class ImageAdapter extends BaseAdapter {
    @Override
    public int getCount() {
        return imageUrls.length;
    }

    @Override
    public Object getItem(int position) {
        return null;
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ImageView imageView;
        if (convertView == null) {
            imageView = (ImageView) getLayoutInflater().inflate(
                    R.layout.item_grid_image, parent, false);
        } else {
            imageView = (ImageView) convertView;
        }

        imageLoader.displayImage(imageUrls[position], imageView, options);
        return imageView;
    }
} 
```

> 日志猫

```
 01-22 16:00:35.101: E/AndroidRuntime(29785): FATAL EXCEPTION: main
01-22 16:00:35.101: E/AndroidRuntime(29785): android.content.res.Resources$NotFoundException: Resource ID #0x2
01-22 16:00:35.101: E/AndroidRuntime(29785):    at android.content.res.Resources.getValue(Resources.java:1105)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at android.graphics.BitmapFactory.decodeResource(BitmapFactory.java:554)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at android.graphics.BitmapFactory.decodeResource(BitmapFactory.java:630)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at com.nostra13.example.universalimageloader.ImageGridActivity$1.onItemLongClick(ImageGridActivity.java:67)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at android.widget.AbsListView.performLongPress(AbsListView.java:2622)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at android.widget.AbsListView$CheckForLongPress.run(AbsListView.java:2572)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at android.os.Handler.handleCallback(Handler.java:608)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at android.os.Handler.dispatchMessage(Handler.java:92)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at android.os.Looper.loop(Looper.java:156)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at android.app.ActivityThread.main(ActivityThread.java:4987)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at java.lang.reflect.Method.invokeNative(Native Method)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at java.lang.reflect.Method.invoke(Method.java:511)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
01-22 16:00:35.101: E/AndroidRuntime(29785):    at dalvik.system.NativeStart.main(Native Method) 
```

> 安卓清单

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.nostra13.example.universalimageloader"
    android:versionCode="26"
    android:versionName="1.7.0" >

    <uses-sdk
        android:minSdkVersion="5"
        android:targetSdkVersion="17" />

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.SET_WALLPAPER"/>

    <application
        android:name=".UILApplication"
        android:icon="@drawable/app_icon"
        android:label="@string/app_name" 
        android:allowBackup="True"
        >
        <activity
            android:name=".HomeActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity
            android:name=".ImageGridActivity"
            android:label="@string/ac_name_image_grid" />
        <activity
            android:name=".ImagePagerActivity"
            android:label="@string/ac_name_image_pager" />

        <!-- Widget -->
        <receiver android:name=".widget.UILWidgetProvider">
            <meta-data
                android:name="android.appwidget.provider"
                android:resource="@xml/widget_provider" />

            <intent-filter>
                <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
            </intent-filter>
        </receiver>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-21T09:39:13.787

改用. `OnItemLong listener`_`OnItemClick Listener`

代替：

```
gridView.setOnItemClickListener(new OnItemClickListener() {
        @SuppressLint("NewApi")
        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

            startImageGalleryActivity(position);
        }
    }); 
```

利用

```
 gridView.setOnItemLongClickListener(new OnItemLongClickListener() {

    @Override
    public boolean onItemLongClick(AdapterView<?> arg0, View arg1,
            int position, long arg3) {
       startImageGalleryActivity(position);
        return false;
    }
}); 
```

**更新**

*OnItemClickListener*

```
 gridview.setOnItemClickListener(new OnItemClickListener() {
              public void onItemClick(AdapterView<?> parent, View v, int position, long id) { 
                  Toast.makeText(test2.this, "Click Listener", Toast.LENGTH_SHORT).show(); 
                   // open the pager activity
                  }    }); 
```

*OnItemLongClickListener*

```
gridview.setOnItemLongClickListener(new OnItemLongClickListener() {

                    public boolean onItemLongClick(AdapterView<?> arg0, View arg1,
                            int position, long arg3) {
                        Toast.makeText(test2.this, "LONG PRESS", Toast.LENGTH_SHORT).show();
                        //set the image as wallpaper 
                        return true;
                    }
                }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:36:59.480

改用这个：

```
 gridView.setOnItemLongClickListener(new OnItemLongClickListener() {

        @Override
        public boolean onItemLongClick(AdapterView<?> arg0, View arg1,
                int arg2, long arg3) {
            // TODO Auto-generated method stub
            return false;
        }
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T09:58:29.997

首先，改变这一行。

```
public class ImageGridActivity extends BaseActivity implements OnItemLongClickListener 
```

然后将此代码添加到您的活动中...

```
 GridView gridView = (GridView) findViewById(R.id.gridview);
 gridView.setOnItemLongClickListener(this);

    @Override
    public boolean onItemLongClick(AdapterView<?> parent, View v, int pos,long id) 
    {
        System.out.println("~~~~~~Long Item Clicked");
        return false;
    } 
```

希望这可以帮助 ：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-15T00:05:13.087

尝试这个。在 onItemLongClick 中返回 true 并且不会调用您的 onItemClickListener :)

```
public boolean onItemLongClick(AdapterView<?> parent, View view, int position, long id) { 
.
.
.
return true;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-21T09:41:12.487

在你的代码中写这部分来设置长点击gridview

```
 GridView  gridView =  (GridView) findViewById(R.id.gridview);
    //Set Long-Clickable
    gridView.setLongClickable(true);
    gridView.setOnItemLongClickListener(new OnItemLongClickListener() {

        @Override
        public boolean onItemLongClick(AdapterView<?> arg0, View view,
                int position , long id) {
            // TODO Auto-generated method stub
                       Toast.makeText(getApplicationContext(), "Long Click", Toast.LENGTH_SHORT).show();
                            /*
                             *You Can use parameters like position,view or id to
                             *Customize your action
                             */   
            return false;
        }
    }); 
```

单击侦听器

```
gridView.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View v,
                int position, long id) {
    Toast.makeText(getApplicationContext(), "Click", Toast.LENGTH_SHORT).show();
        }
    }); 
```

要设置墙纸，我认为需要设置权限

```
 <uses-permission android:name="android.permission.SET_WALLPAPER"></uses-permission> 
```

**注意：**查看 log cat 它的说法，`Resources$NotFoundException`检查您是否正确添加了资源。可能在错误的文件夹或检查 [**这个**](https://stackoverflow.com/a/9468672/1450401)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-21T09:37:35.373

您可以使用

```
gridView.setOnLongClickListener(new OnLongClickListener() {

                @Override
                public boolean onLongClick(View v) {
                    // TODO Auto-generated method stub
                    return false;
                }
            }); 
```

# vb.net - if (VB) 里面的 if 怎么写？

> ID：14435756
> 
> 赞同：0
> 
> 时间：2013-01-21T09:33:13.160
> 
> 标签：vb.net

我怎样才能把一个`If`里面另一个`If`？这是我的代码：

```
 If IsProcessRunning("javaw") = True Then

        Dim result = MessageBox.Show("message", "caption", MessageBoxButtons.OKCancel)
        If (result = DialogResult.Cancel) Then
            MessageBox.Show("Cancel pressed")
        ElseIf (result = DialogResult.OK) Then
            MessageBox.Show("Ok pressed")

        End If 
```

这给了我错误：我应该放在`End If`后面`if IsProcessRunning()`。但这将取消第一条`If`语句，如果`IsProcessRunning`is`True`或将显示消息框`False`。

我怎样才能解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T09:34:55.440

你刚刚错过了第二个`End If`，你不必把它放在 Visual Studio 告诉你的地方，你只需要确保它在那里：

```
If IsProcessRunning("javaw") = True Then

    Dim result = MessageBox.Show("message", "caption", MessageBoxButtons.OKCancel)
    If (result = DialogResult.Cancel) Then
        MessageBox.Show("Cancel pressed")
    ElseIf (result = DialogResult.OK) Then
        MessageBox.Show("Ok pressed")

    End If

End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:36:14.840

```
If IsProcessRunning("javaw") = True Then
    Dim result = MessageBox.Show("message", "caption", MessageBoxButtons.OKCancel)
    If (result = DialogResult.Cancel) Then
        MessageBox.Show("Cancel pressed")
    ElseIf (result = DialogResult.OK) Then
        MessageBox.Show("Ok pressed")
    End If
End If 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T13:15:31.730

如其他语句所示，可以嵌套If语句，即

```
If IsProcessRunning("javaw") 那么
    ...
    如果（结果 = DialogResult.Cancel）那么
        ……
    万一
万一

```

但是，根据您的代码和情况，您最终可能会得到一个“先锋”：如果您想在检查了许多“进入条件”为真之后运行您的“真实”代码，您可以编写：

```
子你的子（）
    如果 cond1 则
        如果 cond2 则
            如果 cond3 则
                如果 cond4 则
                    '“真实代码”：
                    你的代码在这里
                万一
            万一
        万一
    万一
结束子

```

由于这可能会变得非常混乱，因此建议改为反转检查，即：

```
子你的子（）
    '进入条件
    If Not cond1 Then Exit Sub
    If Not cond2 Then Exit Sub
    If Not cond3 Then Exit Sub
    If Not cond4 Then Exit Sub

    '“真实”代码
    你的代码在这里
结束子

```

# java - 高效交叉多个索引Lucene的搜索结果

> ID：14435766
> 
> 赞同：0
> 
> 时间：2013-01-21T09:33:57.810
> 
> 标签：java, lucene, hibernate-search

我有两个 Lucene 索引（版本 3.5.0），我将使用 Hibernate Search 编写它们。我需要实现一个返回结果的搜索，该结果是各个索引上结果的交集 (AND)。主要问题是单个结果和最终结果都可能非常大，因此组合应该是有效的。有没有一种有效的方法来做到这一点？[MultiReader](http://lucene.apache.org/core/3_6_0/api/all/org/apache/lucene/index/MultiReader.html)可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:06:59.717

1.  MultiReader 是跨多个索引进行搜索的简便方法。
2.  用索引标记每个 Lucene 文档可能是最快的解决方案；类似`index:global`和`index:local`（如果你有`global`和`local`索引）。例如，查询“异常”可能如下所示：

    （异常与索引：全局）或（异常与索引：本地）

之后您可以在其中过滤两个索引中出现的 Lucene 文档的搜索结果。

请注意，您不能执行简单的查询：

```
exception AND (index:global AND index:local) 
```

因为将有 0（零）个具有`index:global`和`index:local`值的 Lucene 文档。

# java - 获取 XML 标签的 XPath

> ID：14435767
> 
> 赞同：0
> 
> 时间：2013-01-21T09:33:58.933
> 
> 标签：java, xml, xslt, xpath

如果我有如下 XML 文档：

```
<foo>
   <foo1>Foo Test 1</foo1>
   <foo2>
       <another1>
           <test10>This is a duplicate</test10>
       </another1>
   </foo2>
   <foo2>
       <another1>
           <test1>Foo Test 2</test1>
       </another1>
   </foo2>
   <foo3>Foo Test 3</foo3>
   <foo4>Foo Test 4</foo4>
</foo> 
```

例如，我如何获得 XPath `<test1>`？所以**输出**应该是这样的：`foo/foo2[2]/another1/test1`

我猜代码看起来像这样：

```
public String getXPath(Document document, String xmlTag) {
   String xpath = "";
   ...
   //Get the node from xmlTag
   //Get the xpath using the node
   return xpath;
} 
```

比方说`String XPathVar = getXPath(document, "<test1>");`。我需要取回一个可以在以下代码中工作的绝对 xpath：

```
XPath xpath = XPathFactory.newInstance().newXPath(); 
XPathExpression xpr = xpath.compile(XPathVar); 
xpr.evaluate(Document, XPathConstants.STRING); 
```

但它不能像这样的捷径，`//test1`因为它也将用于元数据目的。

通过以下方式打印结果时：

`System.out.println(xpr.evaluate(Document, XPathConstants.STRING));`

我应该得到节点的值。所以如果`XPathVar = foo/foo2[2]/another1/test1`那时我应该回来：

`Foo Test 2`并不是`This is a duplicate`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T10:04:56.720

您不会以与没有“获取”sql 的方式相同的方式“获取”xpath。

xpath 是您根据对 xml 文档或架构的理解编写的查询，就像 sql 是您根据对数据库架构的理解编写的查询一样 - 您不会“获得”其中任何一个。

我可以通过简单地从给定节点返回节点来从 DOM 生成 xpath 语句，尽管考虑到每个节点上的属性值，这样做足够通用，会使生成的代码几乎无用。例如（带有警告，这将找到具有给定名称的第一个节点，xpath 远不止于此，您也可以只使用 xpath `//foo2`）：

```
import java.io.ByteArrayInputStream;
import javax.xml.parsers.DocumentBuilderFactory;

import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;

public class XPathExample 
{
  private static String getXPath(Node root, String elementName)
  {
    for (int i = 0; i < root.getChildNodes().getLength(); i++)
    {
      Node node = root.getChildNodes().item(i);

      if (node instanceof Element)
      {
        if (node.getNodeName().equals(elementName))
        {
          return "/" + node.getNodeName();
        }
        else if (node.getChildNodes().getLength() > 0)
        {
          String xpath = getXPath(node, elementName);
          if (xpath != null)
          {
            return "/" + node.getNodeName() + xpath;
          }
        }
      }
    }

    return null;
  }

  private static String getXPath(Document document, String elementName)
  {
    return document.getDocumentElement().getNodeName() + getXPath(document.getDocumentElement(), elementName);
  }

  public static void main(String[] args) 
  {
    try 
    {
      Document document = DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(
        new ByteArrayInputStream(
          ("<foo><foo1>Foo Test 1</foo1><foo2><another1><test1>Foo Test 2</test1></another1></foo2><foo3>Foo Test 3</foo3><foo4>Foo Test 4</foo4></foo>").getBytes()
        )
      );

      String xpath = "/" + getXPath(document, "test1");
      System.out.println(xpath);        

      Node node1 = (Node)XPathFactory.newInstance().newXPath().compile(xpath).evaluate(document, XPathConstants.NODE);
      Node node2 = (Node)XPathFactory.newInstance().newXPath().compile("//test1").evaluate(document, XPathConstants.NODE);

      //This evaluates to true, hence you may as well just use the xpath //test1.
      System.out.println(node1.equals(node2));
    }
    catch (Exception e) 
    {
      e.printStackTrace();
    }
  }
} 
```

同样，您可以编写一个 XML 转换，将 xml 文档转换为一系列 xpath 语句，但这种转换会比首先编写 xpath 更复杂，因此在很大程度上毫无意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T11:28:15.400

这个怎么样：

```
private static String getXPath(Document root, String elementName)
{
  try{
      XPathExpression expr = XPathFactory.newInstance().newXPath().compile("//" + elementName);
      Node node = (Node)expr.evaluate(root, XPathConstants.NODE);

      if(node != null) {
          return getXPath(node);
      }
  }
  catch(XPathExpressionException e) { }

  return null;
}

private static String getXPath(Node node) {
    if(node == null || node.getNodeType() != Node.ELEMENT_NODE) {
        return "";
    }

    return getXPath(node.getParentNode()) + "/" + node.getNodeName();
} 
```

请注意，这是首先定位节点（使用 XPath），然后使用定位的节点来获取其 XPath。相当迂回的方法来获得你已经拥有的价值。

工作 ideone 示例：http: [//ideone.com/EL4783](http://ideone.com/EL4783)

# objective-c - 与宏扩展混淆

> ID：14435773
> 
> 赞同：2
> 
> 时间：2013-01-21T09:34:18.173
> 
> 标签：objective-c, c, macros

> **可能重复：**
> [谁能解释这些未定义的行为（i = i++ + ++i，i = i++，等等……）](https://stackoverflow.com/questions/949433/could-anyone-explain-these-undefined-behaviors-i-i-i-i-i-etc)
> [下面的宏会给应用程序带来什么问题？](https://stackoverflow.com/questions/13401518/what-problems-might-the-following-macro-bring-to-the-application)

我编写了一个带有宏扩展的示例应用程序，用于在我的 iOS（Objective C 代码）中实现它。

它是这样的：

```
#define SQUARE(x) ( x * x )
main( )
{
   int i = 3, j, k ;
   j = SQUARE( i++ ) ;
   k = SQUARE( ++i ) ;
   printf ( "\nValue of i++ = %d\nValue of ++i = %d", j, k ) ;
} 
```

**输出是：**

```
Value of i++ = 9
Value of ++i = 49 
```

**预期输出为：**

```
 Value of i++ = 9
 Value of ++i = 25 
```

我对这个结果感到惊讶。我对这个宏扩展有点困惑。

为什么会这样？请帮我找出原因。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T09:37:57.937

您 通过修改不止一次而没有干预序列点来调用**未定义的行为。**`i`

在宏替换之后，这两行将如下所示：

```
 j = ( i++ * i++ ) ;
   k = ( ++i * ++i ) ; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-21T09:38:24.687

这确实是未定义的行为**（不应依赖于另一个编译器，甚至不应该依赖于同一编译器的下一次运行），**因为它在没有序列点的同一语句中将同一变量增加了两次，但这似乎发生在这个案子;

```
#define SQUARE(x) ( x * x )
j = SQUARE( i++ ) ;
k = SQUARE( ++i ) ; 
```

将扩大到

```
j = (i++ * i++);     // Compiler could do i * i, then increment twice, or use i * (i + 1), or...  

k = (++i * ++i);     // Same as above 
```

由于这是未定义的行为，编译器可以随意做任何事情（旧版本的 gcc 使程序启动 nethack ;-)。更准确地说：编译器可以自由假设永远不会调用未定义的行为，并确保代码在“正常”情况下正常工作。在意想不到的情况下会发生什么是任何人的赌注。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T09:41:59.760

这是因为您在两个序列点之间将单个变量增加了两次。因此这是一个未定义的行为

```
 int i = 3, j, k ;
   j = SQUARE( i++ ) ; // it becomes (i++ * i++)
   k = SQUARE( ++i ) ; // it becomes (++i * ++i) 
```

因此即将到来的输出是未定义的。

您得到的输出是因为在第一次 xpression 之后 i 将被递增两次，因此在第二个表达式中 i 由于预递增而被递增两次，对于上述后递增，它也被递增两次。

```
j=(i++ * i++)//it comes 3*3 

k=(++i * ++i)// it comes 7 as two increments of above xpression 
```

# redis - 如何清理cloudfoundry托管的redis？

> ID：14435779
> 
> 赞同：0
> 
> 时间：2013-01-21T09:34:54.160
> 
> 标签：redis, cloud-foundry

[CloudFoundry](http://CloudFoundry.com)提供的redis缓存容量较小，即16MB。我知道redis有一个命令“ [FLUSHALL](http://redis.io/commands/flushall) ”，用于删除缓存中的所有键。如何在 Cloudfoundry 中做同样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:55:18.240

您可以根据需要重新创建和重新绑定服务，除非您有任何无法迁移的特定配置。（我假设 CF.com 提供的服务应该被创建为相同的。）

如果您安装了 vmc 和 caldecott gem 并且在本地执行了 redis，那么将 FLUSHALL 发送到 redis 隧道也应该是另一种选择。您介意是否可以发送错误，为什么您无法连接到它？

# email - SMTP 错误 <<: 503 未公布时使用的 AUTH 命令

> ID：14435781
> 
> 赞同：1
> 
> 时间：2013-01-21T09:34:54.843
> 
> 标签：email, authentication, exim, exim4

我在 Webmail Lite 中遇到了这个错误。

我已经安装了 Exim。这是 auth 块的片段：PLAIN：

```
 driver                     = plaintext

  server_set_id              = $auth2

  server_prompts             = :
  .ifndef AUTH_SERVER_ALLOW_NOTLS_PASSWORDS
  server_advertise_condition = ${if eq{$tls_cipher}{}{}{*}}
  .endif 

  server_condition           = “${if crypteq{$auth3}{${extract{1}{:}{${lookup{$auth2}lsearch{/etc/$domain/passwd}{$value}{*:*}}}}}{1}{0}}” 
```

我以以下格式存储密码：用户名：{MD5}asddfasdlasdkandlanskfdaf

如何启用 AUTH 并正常工作？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-26T09:36:39.870

就我而言，此错误不会定期出现。有时它会起作用，但有时会出现此错误。（SMTP 错误：无法验证。）

我调试了这个然后我发现了这个

```
SMTP -> get_lines(): $data was ""
SMTP -> get_lines(): $str is "503 AUTH command used when not advertised "
SMTP -> get_lines(): $data is "503 AUTH command used when not advertised "
SMTP -> FROM SERVER:503 AUTH command used when not advertised
SMTP -> ERROR: RSET failed: 503 AUTH command used when not advertised
SMTP Error: Could not authenticate. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-10-23T19:39:46.890

此错误消息的一个原因是发送 HELO 而不是 EHLO，或者以错误的顺序发送 EHLO。

但是，即使使用 EHLO，当服务器运行 Exim 时，也会出现此消息。

在我的服务器上，我找到了解决方案。在 WHM > 主页 > 服务配置 > Exim 配置管理器中，选项“要求客户端连接 SSL 或发出 STARTTLS 命令，然后才能通过服务器进行身份验证”设置为默认值 (On)。我不确定我是否这样做，这通常是一个安全的好主意，但强制邮件服务器仅启用（广告）STARTTLS 命令，而不是 AUTH。因此，当我的脚本发送 AUTH 时，服务器发送的错误消息是正确的。更多信息请[参见 http://blog.networkpresence.co/?p=8923](http://blog.networkpresence.co/?p=8923)。有一天，当我有时间时，我会发现如何更改我的脚本以使用 TLS，这样我就可以打开 Exim 选项以确保安全。

# android - ViewPagerIndicator，内容繁重的片段，如何管理加载

> ID：14435785
> 
> 赞同：1
> 
> 时间：2013-01-21T09:35:03.143
> 
> 标签：android, android-viewpager

我使用带有选项卡的 ViewPagerindicator 来显示我的内容。问题是，我的 Fragments 有很多视图，由于许多元素和图片，需要花费大量时间来生成它们。我想在加载时显示进度条，但是如何管理呢？在我的测试实例（TestFragment）中，我有很多 textViews 的这个方法（它模拟了现实）：

```
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

        LinearLayout layout = new LinearLayout(getActivity());
        layout.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));
        layout.setGravity(Gravity.CENTER);
        for (int a=0; a < 1000; a++) layout.addView(createTextView());

        return layout;
    } 
```

在我的寻呼机适配器中，我可以一次加载所有片段，以避免在更改页面时等待片段：

```
 ViewPager pager = (ViewPager)findViewById(R.id.pager);
 pager.setAdapter(adapter);
 pager.setOffscreenPageLimit(5); 
```

但我不知道，我怎么能管理加载的所有片段？因为它们都在适配器中一个接一个地加载：

```
 public Fragment getItem(int position) {
   return TestFragment.newInstance(position);
  } 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-05T19:11:36.550

```
ProgressDialog progressDialog = new ProgressDialog(context);
 progressDialog.setMessage("Loading...");
            progressDialog.show();

//do your stuff

progressDialog.dismiss(); 
```

这应该只是这样做！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-05T19:14:28.670

有几点需要注意。我不认为加载 1000 个 TextView 的成本与加载许多“元素和图片”的成本相同。因此，该模拟不会真正为您提供准确的结果。

其次，您提到您试图在数据加载时显示进度条？它是任意数量的元素和图片吗？如果是这样，您不希望进度条在用户等待内容加载时永远存在。IMO，更好的方法是延迟加载您需要的元素，并使用某种缓存来防止底层数据被不必要地重新加载。

# postgresql - 如何将存储过程参数传递到 EXECUTE 语句

> ID：14435787
> 
> 赞同：0
> 
> 时间：2013-01-21T09:35:10.293
> 
> 标签：postgresql, stored-procedures, prepared-statement, plpgsql

```
CREATE OR REPLACE FUNCTION "Test"(character varying[],character varying[])
RETURNS refcursor AS
$BODY$
DECLARE
curr refcursor;
filter text;
counter integer;
BEGIN
    counter = 1;
    filter = '';

    IF array_length($1,1) > 0 THEN
        filter = 'AND ';

        WHILE ($1[counter] <> '') LOOP
                filter = filter||'LOWER('||$1[counter]||'::character varying) LIKE ''%''||LOWER($2['||counter||'])||''%'' AND ';
                counter = counter + 1;
        END LOOP;

        filter = substring(filter FROM 1 FOR (char_length(filter)-4));

        OPEN curr FOR
         EXECUTE 'SELECT "Reservation".* FROM "Reservation" WHERE "Reservation"."id" > 0 '||filter;
        return curr;
    END IF;
END
$BODY$
LANGUAGE plpgsql VOLATILE
COST 100;

SELECT "Test"(ARRAY['"Reservation"."status"'],'{"waiting"}');
FETCH ALL IN "<unnamed portal 1>"; 
```

我试图打印出查询：

```
"SELECT "Reservation".* FROM "Reservation" WHERE "Reservation"."id" > 0 AND LOWER("Reservation"."status"::character varying) LIKE '%'||LOWER($2[1])||'%' " 
```

但是当它执行时它说没有参数$ 2。所以我意识到它无法访问该存储过程的参数。

我不必担心sql注入的第一个参数，因为它是硬编码的。但是第二个参数必须传递给执行。我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T10:36:09.937

我发现我可以使用“USING”语句将参数传递给 EXECUTE。

这是最终的工作代码：

```
CREATE OR REPLACE FUNCTION "Test"(character varying[],character varying[])
RETURNS refcursor AS
$BODY$
DECLARE
curr refcursor;
filter text;
counter integer;
BEGIN
    counter = 1;
    filter = '';

    IF array_length($1,1) > 0 THEN
        filter = 'AND ';

        WHILE ($1[counter] <> '') LOOP
                filter = filter||'LOWER('||$1[counter]||'::character varying) LIKE ''%''||LOWER($1['||counter||'])||''%'' AND ';
                counter = counter + 1;
        END LOOP;

        filter = substring(filter FROM 1 FOR (char_length(filter)-4));

        OPEN curr FOR
         EXECUTE 'SELECT "Reservation".* FROM "Reservation" WHERE "Reservation"."id" > 0 '||filter USING $2;
        return curr;
    END IF;
END
$BODY$
LANGUAGE plpgsql VOLATILE
COST 100;

SELECT "Test"(ARRAY['"Reservation"."status"'],ARRAY['no-show']);
FETCH ALL IN "<unnamed portal 1>"; 
```

请注意，我将 $1 作为 EXECUTE 语句中的值，因为它接受 $2 作为其第一个参数。

# android - OSMDroid MapView Balloon with scrollView

> ID：14435791
> 
> 赞同：1
> 
> 时间：2013-01-21T09:35:13.390
> 
> 标签：android, osmdroid, android-scrollview

我正在使用 osmdroid 和 osmdroid 奖励包来展示气球。在气球内部有一个滚动视图，其中包含一个线性布局（垂直）作为子级。

当我尝试向下滚动时，我的地图视图也会滚动。我怎样才能强制滚动动作只对我的气球？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T09:41:59.947

好的，我找到了一个解决方案，也许它不是最好的解决方案，但它对我有用，就像我期望的那样

创建一个从 MapView 扩展的类并覆盖下一个方法：

```
 @Override
  public boolean onInterceptTouchEvent(MotionEvent ev) {
    float x = ev.getRawX();
    float y = ev.getRawY();
    View view = findViewById(R.id.my_overlay_view);
    if(view!=null){
        boolean isInside = isPointInsideView(x, y, view);
        if(isInside){
            System.out.println("Touch in");
            canMove = false;
        }else{
            int action = ev.getAction();
            System.out.println(action);
            switch (action) {
            case MotionEvent.ACTION_MOVE:
                moving=true;
                break;
            case MotionEvent.ACTION_UP:
                if(!moving){
                         CustomDefaultInfoWindow window =  (CustomDefaultInfoWindow)view.getTag();
        window.close();
        moving=false;
        }
                default:
                    break;
                }
                canMove = true;
            }
    }

        return super.onInterceptTouchEvent(ev);
    } 

@Override
public void scrollTo(int arg0, int arg1) {
    if(canMove){
        super.scrollTo(arg0, arg1);
    }

};
private boolean isPointInsideView(float x, float y, View view){
    int location[] = new int[2];
    view.getLocationOnScreen(location);
    int viewX = location[0];
    int viewY = location[1];

    //point is inside view bounds
    if(( x > viewX && x < (viewX + view.getWidth())) &&
            ( y > viewY && y < (viewY + view.getHeight()))){
        return true;
    } else {
        return false;
    }
} 
```

# javascript - 跨浏览器访问对象标签的html内容

> ID：14435793
> 
> 赞同：1
> 
> 时间：2013-01-21T09:35:16.043
> 
> 标签：javascript, html, cross-browser, object-tag

我有`object`一个带有数据属性的标签，指向来自同一域的 html 文件。

我想访问 html 的内容。

HTML：

```
<object id="object" width="420" height="360" data="jsp/index.html"></object> 
```

JS：

```
var object = document.getElementById("object").contentDocument;
var html = object.getElementById("tmpl").innerHTML 
```

上面的代码适用于所有浏览器，除了`IE7`

`object`请帮助我在 IE7 中访问标签的 DOM 内容

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T07:14:15.703

好的，所以我尝试按照您提供的代码稍微玩一下，我发现了一些重要的事情，首先是：

1>我首先尝试在firebug中获取这样的html内容：

```
console.log(document.getElementById("iframe").contentDocument.innerHTML); 
```

我将在这里附上我的萤火虫结果：

![在此处输入图像描述](../Images/91d9de9fe78bee615a7e6d30e497b9c9.png)

所以你可以看到这里有一个权限被拒绝。

2> 同样，我也尝试了对象，这就是我得到的：

![在此处输入图像描述](../Images/6b29006fc6e023d698f4612ea5d596e5.png)

从这里很明显，由于**[Same Origin Policy](http://thinkfree-thinkfree.blogspot.com/2013/01/problems-due-to-same-origin-policy.html)** ，它失败了。

我不知道您是如何访问它们的，但对我来说，这个域和主机无法访问。这是猜测，也是您无法获取对象 id 内容的原因。我建议您使用 **[跨站点 HTTP 请求或 CORS 方式](https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS)**来完成这里的工作。

# bitmap - 如何创建此位图？

> ID：14435795
> 
> 赞同：0
> 
> 时间：2013-01-21T09:35:23.257
> 
> 标签：bitmap, hex

这是一个位图，它有一个奇怪的标题。它是如何创建的？这是什么类型的标题？

[http://zapodaj.net/1b0889852f46c.bmp.html](http://zapodaj.net/1b0889852f46c.bmp.html)（保存图像并在十六进制编辑器中打开）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:37:42.837

那不是 BMP 文件，而是扩展名错误的 JPG 文件。

标头包含[0xFF 标记](http://en.wikipedia.org/wiki/JPEG#Syntax_and_structure)和[字符串“JFIF”](http://en.wikipedia.org/wiki/JPEG_File_Interchange_Format#File_format_structure)，这是 JPG 格式的明确标志。

将其保存在磁盘上并使用 IrfanView 打开会给出以下警告：

![在此处输入图像描述](../Images/61461ce386607d34aab52647b1ed57b3.png)

# c# - xpath 查询以选择范围内的数据

> ID：14435803
> 
> 赞同：0
> 
> 时间：2013-01-21T09:36:05.683
> 
> 标签：c#, asp.net, xml, xpath

```
<?xml version="1.0"?>
<AppXmlLogWritter>
  <LogData>
    <LogID>5678201301161640382919</LogID>
    <LogDateTime>20130114164038</LogDateTime>            
  </LogData>
  <LogData>
    <LogID>5678201301161640382920</LogID>
    <LogDateTime>20130115154040</LogDateTime>           
  </LogData>
  <LogData>
  <LogID>5678201301161640382921</LogID>
  <LogDateTime>20130116164042</LogDateTime>          
  </LogData>
</AppXmlLogWritter>

strXpathQuery = @"/AppXmlLogWritter/LogData[LogDateTime/text()>=[starts-with(. , '20130115') and LogDateTime/text()<=starts-with(. , '20130116')]"; 
```

**我必须编写 xpath 查询来选择 LogDateTime 以 20130115 到 20130117 开头的范围内的日志数据 我正在尝试上述查询但无法获取数据**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:51:02.677

请试一试：

```
/AppXmlLogWritter/LogData[substring(LogDateTime, 1, 8) >= 20130115 
                              and substring(LogDateTime, 1, 8) <= 20130116] 
```

如果您想在选择中包含 20130117 个项目，您可以将“20130116”值更改为“20130117”。

# css - CSS 菜单活动项颜色

> ID：14435804
> 
> 赞同：0
> 
> 时间：2013-01-21T09:36:07.023
> 
> 标签：css, wordpress, menu

我正在谈论的网站：[http ://www.formunddrang.de](http://www.formunddrang.de)

当菜单项处于活动状态时，我使用标签`li.selected_page`将菜单项的颜色设置为蓝色。

为了链接到类别而不是`wp-pag`e，我正在使用插件“Page Links To”，它允许我在菜单中添加链接而不是页面。这个菜单项没有`li.selected_page`标签——它似乎根本不知道它什么时候被选中。

有没有人看到访问“Einblicke”菜单项状态的方法，以便在它处于活动状态时将其设为蓝色？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T08:28:12.657

你可以通过 jquery 来做：

```
var url = window.location;
// Will only work if string in href matches with location
$('#cms-nav-top-menu a[href="'+ url +'"]').addClass('active');
// Will also work for relative and absolute hrefs
$('#cms-nav-top-menu a').filter(function() {
    return this.href == url;
}).addClass('active');​ 
```

试一试，告诉我它是否有效。

# mercurial - 如何删除多个头？

> ID：14435811
> 
> 赞同：4
> 
> 时间：2013-01-21T09:36:20.943
> 
> 标签：mercurial

我错误地推送了一些文件，它在主存储库中显示了不同的头。我怎样才能删除那个头？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-21T09:46:53.523

您可以通过编辑`.hgrc`文件来启用“mq”扩展。确保存在以下行：

```
[extensions]
mq = 
```

之后，您可以“剥离”一个特定的修订版，将其删除，以便您只有一个头：

```
hg strip ... 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-21T13:33:03.623

我不认为你真的想删除头。如果你这样做，你将失去在这些分支中完成的工作。

您可能希望将头合并回一个分支。

假设你有一棵这样的树：

```
o  4 : Head 1
|
o  3 : Another commit
|  
| o 2 : Head 2
| |
|/
o  1 : A commit
|
o  0 : Initial commit 
```

为了摆脱额外的头而不丢失其中包含的工作，您将合并两个头（本示例中的修订版 2 和 4），如下所示：

```
hg update 4
hg merge 2
hg commit -m "Merge" 
```

这将创建另一个提交，其中包含修订版 2、3 和 4 中的所有更改，如下所示：

```
o     5: Merge
|\
o |   4 : Head 1
| |
o |   3 : Another commit
| | 
| o   2 : Head 2
| |
|/
o     1 : A commit
|
o     0 : Initial commit 
```

当多个开发人员在同一个存储库上工作时，这是标准过程。

# android - 使用服务器集成的 Android 登录

> ID：14435812
> 
> 赞同：1
> 
> 时间：2013-01-21T09:36:29.250
> 
> 标签：android, android-edittext

在我的应用程序中，我正在使用登录过程。在那我有用户名和密码字段。登录后，即使您退出应用程序或终止应用程序，用户名和密码也会在那里。

我怎么能这样设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T09:39:25.783

在 android 中有**sharedpreferences**的功能您可以将用户名和密码保存在共享首选项中，并检查是否**sharedpreferences**不为空，然后在 textField 中显示用户名和密码

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T09:46:28.340

您可以使用`SharedPreference`如下：

> ```
> SharedPreferences m_sharedPreference=getSharedPreferences("MyPrefs",MODE_PRIVATE);
>   SharedPreferences.Editor m_editor =m_sharedPreference.edit();
>   m_editor.putString("UserName", m_etUsername.getText().toString());
>   m_editor.putString("Password", m_loetPassword.getText().toString());
>  m_editor.commit(); 
> ```

# mongodb - 创建索引后 MongoDB 查询不返回完整数据

> ID：14435813
> 
> 赞同：1
> 
> 时间：2013-01-21T09:36:29.613
> 
> 标签：mongodb, indexing

我有一个 MongoDB 集合，其中包含以下数据

```
> db.UpdateQueryRegistry.find({"studyId" : "20130117193010cfab"})

{  "_id":ObjectId("50f95af799ac247d280484dc"),
   "attempts":0,
   "eTime": ISODate("2013-01-17T17:03:36.501Z"),
   "lastUpdDt": ISODate("2013-01-18T14:23:51.141Z"),
   "numQueries":1,
   "query":"Q1",
   "sTime":null,
   "start":0,
   "status":"COMPLETED",
   "studyId":"20130117193010cfab",
   "updateAction":"convertToIUorNO",
   "updateSource":"DOCUMENTSTATUS"
}
{ "_id":ObjectId("50f95af799ac247d280484db"),
   "attempts":0,
   "eTime": ISODate("2013-01-17T19:50:34.392Z"),
   "lastUpdDt": ISODate("2013-01-18T14:23:51.141Z"),
   "numQueries":1,
   "query":"Q2",
   "sTime":null,
   "start":0,
   "status":"COMPLETED",
   "studyId":"20130117193010cfab",
   "updateAction":"instanceAddQuery",
   "updateSource":"ONTOLOGY"
}
{ "_id":ObjectId("50f95af799ac247d280484da"),
   "studyId":"20130117193010cfab",
   "updateSource":"ONTOLOGY",
   "updateAction":"instanceDeleteQuery",
   "query":"Q3",
   "sTime":null,
   "eTime":null,
   "status":"PENDING",
   "numQueries":0,
   "lastUpdDt": ISODate("2013-01-18T14:23:51.141Z"),
   "attempts":0,
   "start":0
} 
```

索引在 DB 上创建如下：

```
> db.UpdateQueryRegistry.stats().indexSizes

{
    "_id_" : 8176,
    "studyId_1_status_1" : 24528,
    "studyId_1_updateSource_1_updateAction_1_query_1" : 98112
} 
```

但是当我触发查询时

```
db.UpdateQueryRegistry.find({
    "studyId" : "20130117193010cfab",
    "updateSource" : "ONTOLOGY",
    "updateAction" : "instanceDeleteQuery"
}) 
```

我没有得到任何结果，但是当我触发查询时

```
db.UpdateQueryRegistry.find({
    "studyId" : "20130117193010cfab"
}) 
```

我看到上面显示了 3 个结果。请告诉我这是否有任何错误。

# ruby-on-rails - 如何查看 Sidekiq 中有关工人的统计信息？

> ID：14435815
> 
> 赞同：4
> 
> 时间：2013-01-21T09:36:35.213
> 
> 标签：ruby-on-rails, sidekiq

[我们可以通过它的 API](https://github.com/mperham/sidekiq/wiki/API)获得一些关于 sidekiq 状态的信息。没有适用于工人的 API 方法。

我想知道某个班级正在运行多少工人。例如，我有一个名为的类`FooStreamer.rb`，它是用`perform_async`方法执行的。我想知道它目前正在运行多少个工人。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T17:53:43.703

由 Mike（sidekiq 的创建者）通过以下提交解决：

[https://github.com/mperham/sidekiq/commit/c606dd4fde8cdc795d2c750d211a74bf1b380217](https://github.com/mperham/sidekiq/commit/c606dd4fde8cdc795d2c750d211a74bf1b380217)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T16:37:17.553

Sidekiq 带有一个 Sinatra Web 界面，您可以通过 mydomain.com/sidekiq 访问它。您只需要按照这些说明安装它（取决于您使用的是乘客还是独角兽）

[https://github.com/mperham/sidekiq/wiki/Monitoring](https://github.com/mperham/sidekiq/wiki/Monitoring)

没有我知道的 API，但您可以轻松地遍历存储 Sidekiq 信息的 Redis 密钥，以计算在特定队列上工作的工作人员数量

```
workers = redis.smembers("workers")

workers.each do |worker|
        tokens = worker.split(":")
        machine = tokens[0]
        pid = tokens[1].split("-")[0]
        key = "worker:" + pid
        obj = redis.get(key)

        #obj will contain information on what queue this worker is processing
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-30T15:25:20.517

您可以使用[https://github.com/phstc/sidekiq-statsd](https://github.com/phstc/sidekiq-statsd)并使用 Graphite 检查统计信息。

# python - 如何在pylab中更改（轮廓）的x轴标签值

> ID：14435816
> 
> 赞同：0
> 
> 时间：2013-01-21T09:36:40.090
> 
> 标签：python, matplotlib

我在 pylab 中使用 contourf 进行绘图，并且绘图效果很好。然而，x 轴标签值在 y 方向上从 0 到 100，在 x 方向上从 0 到 1000，因为我在 x 方向上有 1000 个数据点，在 y 方向上有 100 个数据点。但我希望将 x 轴标记为从 -4 到 4，将 y 轴标记为从 0 到 1000。我只想更改标签。

```
 pylab.contourf(-pac[:,100,:])  #pac is a 3D data distribution
    pylab.colorbar()
    savefig("PAC Concentration.png")
    pylab.close() 
```

提前感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T09:38:31.097

使用`extent`关键字参数。

```
pylab.contourf(-pac[:,100,:], extent=[-4, 4, 0, 1000])  #pac is a 3D data distribution
pylab.colorbar()
savefig("PAC Concentration.png")
pylab.close() 
```

# symfony - 如何将 sha1() 密码转换为 FOSUserBundle？

> ID：14435820
> 
> 赞同：3
> 
> 时间：2013-01-21T09:37:01.910
> 
> 标签：symfony, doctrine-orm, fosuserbundle

我有旧版应用程序，它使用函数加密密码`sha1()`，没有盐。

现在该站点正在转换为 Symfony2 和 FOSUserBundle，如何将它们转移到新数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T16:49:57.210

我有同样的问题

只需像@iamdto 解释的那样覆盖编码器

```
# app/config/security.yml
security:
    encoders:
        FOS\UserBundle\Model\UserInterface: 
           id: your.custom.encoder 
```

你的课应该是

```
use Symfony\Component\Security\Core\Encoder\PasswordEncoderInterface;

class CustomEncoder implements PasswordEncoderInterface
{

    public function encodePassword( $raw, $salt ) {
        //do not use salt here
        return sha1($raw);
    }

    public function isPasswordValid( $encoded, $raw, $salt ) {
        return $encoded === $this->encodePassword( $raw, $salt );
    }
} 
```

您应该添加一列“版本”以获取旧用户并在下次登录时更新他们的信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-22T17:54:38.210

我的同事为此目的写了一个包：

[https://packagist.org/packages/markup/fallback-password-encoder-bundle](https://packagist.org/packages/markup/fallback-password-encoder-bundle)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T10:07:07.907

你有没有尝试过 ：

```
# app/config/security.yml
security:
    encoders:
        FOS\UserBundle\Model\UserInterface: sha1 
```

你也应该看看这些参考资料：

*   [配置应用程序的 security.yml](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/index.md#step-4-configure-your-applications-securityyml)
*   [编码用户密码](http://symfony.com/doc/current/book/security.html#encoding-the-user-s-password)

# vbscript - 带有或运算符的 WQL WMI 的 vbscript

> ID：14435822
> 
> 赞同：1
> 
> 时间：2013-01-21T09:37:07.280
> 
> 标签：vbscript, wmi, wql

1.  我正在使用 vbscript 查询事件查看器日志。
    1.  当我尝试使用 OR 运算符 @ Where Logfile='System' 或 'Application' 时，它会提供信息但会删除 TYPE 条件，并且我发现我的结果包含信息类型数据。
    2.  我如何结合这两个查询，这样我就不必编写额外的代码。

```
Set colLoggedEvents = objWMIService.ExecQuery _
        ("Select * from Win32_NTLogEvent Where Logfile = 'Application'  AND Type <> 'Information' AND TimeGenerated >  ' " & dteDate & "' ")
```

```
Set colLoggedEvents = objWMIService.ExecQuery _
            ("Select * from Win32_NTLogEvent Where Logfile = 'System'  AND Type <> 'Information' AND TimeGenerated >  ' " & dteDate & "' ")
```

问候：msinfo

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:52:50.953

您可以使用括号进行内部比较。

> Select * from Win32_NTLogEvent Where (Logfile = 'System' or Logfile = 'Application') AND Type <> 'Information' AND TimeGenerated > '" & dteDate & "'

# php - Apple photopicker 将使用 php 拍摄的照片上传到 mysql 数据库

> ID：14435825
> 
> 赞同：0
> 
> 时间：2013-01-21T09:37:11.340
> 
> 标签：php, mysql, xcode, camera

我已经从 Apple 下载了 photopicker 的示例代码：http: [//developer.apple.com/library/ios/#samplecode/PhotoPicker/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010196-Intro- DontLinkElementID_2](http://developer.apple.com/library/ios/#samplecode/PhotoPicker/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010196-Intro-DontLinkElementID_2)

我已经修改了代表 MyViewController.m 中拍摄的图片（快照按钮）结果的代码部分：

```
// as a delegate we are being told a picture was taken
- (void)didTakePicture:(UIImage *)picture
{
    [self.capturedImages addObject:picture];
} 
```

然后使用与此类似的代码将其推送到我的网络服务器：

```
NSData *imageData = UIImageJPEGRepresentation(**_capturedImages.images**, 90);
NSString *urlString = @"http://localhost/upload.php";

NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
[request setURL:[NSURL URLWithString:urlString]];
[request setHTTPMethod:@"POST"];

NSString *boundary = @"---------------------------14737809831466499882746641449";
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@", boundary];
[request addValue:contentType forHTTPHeaderField:@"Content-Type"];

NSMutableData *body = [NSMutableData data];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[@"Content-Disposition: form-data; name=\"userfile\"; filename=\".jpg\"\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[@"Content-Type: application/octet-stream\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[NSData dataWithData:imageData]];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[request setHTTPBody:body];

NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
NSString *returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];

NSLog(returnString); 
```

我遇到的问题是我不断收到消息说文件无法上传或代码崩溃。

我认为这只是正确访问生成的图像并正确推送它的问题。

因为我不知道如何从 MyViewController.m 中提取图像：

```
@property (nonatomic, retain) **NSMutableArray** *capturedImages; 
```

upload.php 的 PHP 代码是：

```
<?php

    $file = basename($_FILES['userfile']['name']);
    $uploadFile = $file;
    $randomNumber = rand(0, 99999); 
    $newName = $randomNumber . $uploadFile;

    echo $file;

    echo $uploadFile;

    echo $randomNumber;

    echo $newName;

    if (is_uploaded_file($_FILES['userfile']['tmp_name'])) 
    {
        echo "Temp file uploaded. \r\n";
    } 
    else 
    {
        echo "Temp file not uploaded. \r\n";
    }

    if ($_FILES['userfile']['size']> 300000) {
        exit("Your file is too large."); 
    }

    if (move_uploaded_file($_FILES['userfile']['tmp_name'], $newName)) 
    {
            $postsize = ini_get('post_max_size');   //Not necessary, I was using these
            $canupload = ini_get('file_uploads');    //server variables to see what was 
            $tempdir = ini_get('upload_tmp_dir');   //going wrong.
            $maxsize = ini_get('upload_max_filesize');

            echo "http://localhost/{$file}" . "\r\n" . $_FILES['userfile']['size'] . "\r\n" . $_FILES['userfile']['type'] ;
    }

?> 
```

谢谢

里吉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T10:08:01.303

这是使用 AFNetworking [http://www.6foot3foot.com/developer-journal/afnetworking-php上传的好例子](http://www.6foot3foot.com/developer-journal/afnetworking-php)

# java - Runtim Exception extends Exception 和 Custom Exception extends from Exception 为什么后面一个是编译时异常而另一个不是？

> ID：14435829
> 
> 赞同：7
> 
> 时间：2013-01-21T09:37:25.180
> 
> 标签：java, exception, exception-handling, runtimeexception

在Java中，我有一个扩展自的异常类`Exception`，但是每当我抛出它时，编译器都会说它需要被捕获/必须声明该方法`throws`异常。

当我使用`RuntimeException`扩展自`Exception`的 a 时，编译器不会停止，它将它们作为**运行时异常**，我们不需要处理它。

有没有一种方法可以让 MyException 从 Exception 扩展并仍然将其作为运行时异常。？或者是什么让这在课堂上成为可能`RuntimeException`

```
private void compileTime() throws MyException{
        throw new MyException();
    }

    private void runTime() {
        throw new MyRuntimeException();
    }

    class MyException extends Exception {

    }
    class MyRuntimeException extends RuntimeException {

    } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-21T09:42:38.467

RuntimeException 是未检查异常的子集，用于可以从中恢复的异常。

在编译时不检查未经检查的异常，这意味着编译器不需要方法来捕获或指定（使用 throws）它们。

> ***未经检查*的异常类是类 RuntimeException 及其子类，以及类 Error 及其子类。**所有其他异常类都是***检查***异常类。

请通过此图像检查异常层次结构： ![异常层次结构](../Images/cf5f64e190abf1dc2a7a6c7179650022.png)

简而言之，任何从“Exception”派生的异常都是经过检查的异常，而从 RuntimeException 派生的类是未经检查的。RuntimeExceptions 不需要由调用代码显式处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T09:39:47.183

没门。根据规范，只有从`RuntimeException`类或`Error`类扩展的异常才被视为未经检查的异常 (JLS 7, p. 11.1.1)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T09:42:12.673

您所说的“编译时”异常称为检查异常。正如您所说，编译器将要求您将其包含在您的方法签名中，并且您的调用者将需要处理它可能被抛出的可能性。

RuntimeException 明确用于“未经检查”的异常情况。

从文档

> 方法不需要在其 throws 子句中声明任何可能在方法执行期间抛出但未被捕获的 RuntimeException 子类。

因此，如果您想要一个未经检查的异常，只需扩展 RuntimeException。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T11:47:38.357

**RuntimeException**不需要 try-catch 组合或在方法的开头抛出。仅仅因为它发生在运行时，例如您想要引用 10 元素长数组的第 14 个元素，或者因为您忘记设置某些东西的值而获得 NullPointerException，这些情况无法预测，因为程序可以很好地使用正确的结构。也正如其他人所说，这是未经检查的。

**异常**不同，你必须告诉程序如何处理众所周知的异常情况。这意味着编译器将强制您在异常开始运行之前以某种方式处理它。

# vb.net - Medialibrary Savesong 方法损坏文件

> ID：14435833
> 
> 赞同：0
> 
> 时间：2013-01-21T09:37:35.897
> 
> 标签：vb.net, windows-phone-8, windows-phone, media-library

这是我在 MSDN 论坛上找到的代码：

```
 Dim file As New Uri("Assets/someSong.mp3", UriKind.Relative)     
    Dim myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication()
    Dim fileStream As IsolatedStorageFileStream = myIsolatedStorage.CreateFile("someSong.mp3")
    Dim resource = Application.GetResourceStream(file)
Dim chunkSize As Integer = 4096
    Dim bytes As Byte() = New Byte(chunkSize - 1) {}
    Dim byteCount As Integer
    While resource.Stream.Read(bytes, 0, chunkSize) > 0
        byteCount = resource.Stream.Read(bytes, 0, chunkSize)
        fileStream.Write(bytes, 0, byteCount)
    End While
    fileStream.Close()
    Dim metaData As New Microsoft.Xna.Framework.Media.PhoneExtensions.SongMetadata()
    metaData.AlbumName = "Some Album name"
    metaData.ArtistName = "Some Artist Name"
    metaData.GenreName = "test"
    metaData.Name = "someSongName"
    metaData.Duration = TimeSpan.FromSeconds(185)
    Dim ml = New MediaLibrary()
    Dim songUri As New Uri("someSong.mp3", UriKind.RelativeOrAbsolute)
    Dim song = Microsoft.Xna.Framework.Media.PhoneExtensions.MediaLibraryExtensions.SaveSong(ml, songUri, metaData, Microsoft.Xna.Framework.Media.PhoneExtensions.SaveSongOperation.CopyToLibrary) 
```

所以我可以将歌曲加载到我的手机歌曲集线器（Lumia 920）中，但是当我点击非歌曲时，它会给出错误：c00d36c4。似乎流在保存过程中被破坏了。

我要保存的歌曲位于应用程序项目中，其中包含构建操作“内容”和“请勿复制”。

WP Emulator 或即使我使用另一个 mp3 文件也会发生同样的情况。

我找不到任何关于 SaveSong 方法的官方文档，你能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T14:18:14.190

解决了这个问题。它无法正确复制整个流。我切换到`[Stream].CopyTo`方法然后工作。

# android - Android In-App billing API3 是否支持 Android api-version 8？

> ID：14435835
> 
> 赞同：0
> 
> 时间：2013-01-21T09:37:42.587
> 
> 标签：android

我正在尝试创建一个应用内计费应用程序，当我在我的 Galaxy s 3 上测试该应用程序时一切正常。但是当我尝试在我的具有 foryo 2.2 的 Galaxy 选项卡上测试该应用程序时，我只是得到“3”作为回应，我不知道这是什么意思！

所以我的问题是：Android In-App billing API3 是否支持 Android api-version 8？如果不是，支持的 api-version 是什么？是16或更高还是什么？

代码：

捆绑拥有

```
dItems = mService.getPurchases(3, getPackageName(), "inapp", null);
int response = ownedItems.getInt("RESPONSE_CODE"); 
```

api-version 16 的响应为 0，这意味着 android api-version 8 或 9 上的成功连接给了我 3！这意味着某处出现故障

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:45:26.630

您是否更新了 Galaxy Tab 上的 Google Play 应用程序？我很确定它需要更新应用程序才能使用“新”API。

值为 3的响应代码[表示](http://developer.android.com/google/play/billing/billing_reference.html)“请求的类型不支持计费 API 版本”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:40:10.333

[请在此处](http://developer.android.com/intl/ja/google/play/billing/billing_reference.html#billing-codes)验证 InApp 计费请求的响应代码。当您收到 3 作为响应代码时，`API`请求的类型不支持计费版本。

# java - 单击另一个按钮在 SWT 中处理 SelectionListener

> ID：14435837
> 
> 赞同：1
> 
> 时间：2013-01-21T09:37:44.923
> 
> 标签：java, swt

我有一个代码，它向 SWT shell 添加了四个复选框按钮，我在复选框按钮中添加了选择侦听器，我想在单击 SWT Shell 的 OK、CANCEL 和 CLOSE 按钮时将其删除，我该如何处理这样的事件，这个是我的代码

```
grpVersionTreeComponents.setLayoutData(componentsRenderer.createGridData(490, 220, 4));
            for(int versionCount = 0; versionCount < versionSplitters.length ; versionCount++ ){
                String splitter= versionSplitters[versionCount];
                Button cbVersionSplitter = new CheckBoxWrapper().getButton(grpVersionTreeComponents,splitter.toString() , "");
                cbVersionSplitter.setEnabled(true);
                versionSplitterCheckBoxList.add(cbVersionSplitter);
                versionSplitterCheckBoxList.get(versionCount).addSelectionListener(addSplitterCheckBoxListner(cbVersionSplitter));

            } 
```

这是我的选择适配器方法

```
public SelectionAdapter addSplitterCheckBoxListner(final Button button){
        return new SelectionAdapter() {
            public void widgetSelected(SelectionEvent e) {

                String[] defaultVersionSplitters =  PropertyClass.getPropertyLabel(QTLConstants.VERSIONING_ASSISTENT_PAGE_SPLLITER).split(QTLConstants.MULTIPLE_EXTENSIONS_SPLITER);
                //check if button.getText() is equal to "Custom Splitter" String
                if(button.getText().equalsIgnoreCase(defaultVersionSplitters[3])){
                    if(button.getSelection()){
                        customVersionSplitterText.setEnabled(true);
                    }else{
                        customVersionSplitterText.setEnabled(false);
                    }

                }

            }

        };
    } 
```

和 OK 取消按钮以这种方式添加

```
private void addOkCancelButtonOnVersionTreePopup(final Shell versionTreeComponentsShell){

        Button ok = componentsRenderer.createButtonWidget(versionTreeComponentsShell, SWT.PUSH,
                PropertyClass.getPropertyLabel(QTLConstants.OK_BUTTON));
        Button cancel = componentsRenderer.createButtonWidget(versionTreeComponentsShell, SWT.PUSH,
                PropertyClass.getPropertyLabel(QTLConstants.CANCEL_BUTTON));
        ok.addSelectionListener(new SelectionAdapter() {
            @Override
            public void widgetSelected(SelectionEvent e) {

}
        });
}
cancel.addSelectionListener(new SelectionAdapter() {
            @Override
            public void widgetSelected(SelectionEvent e) {          
                /*disposeSelectionListener(cbVersionSplitter);*/
                versionTreeComponentsShell.close();             
            }
        });

    }
} 
```

那么我怎样才能删除这个选择监听器

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T15:44:40.017

您可以执行以下操作：

1）。创建将扩展类的`SelectionAdapter`类。

2）。`widgetSelected()`正如您在代码中所做的那样覆盖方法。

3）。`equals(Object other)`使用以下方法覆盖方法：

```
@Override
public boolean equals(Object other) {
   if (other == null) {
      return false;
   }
   if (other instanceof MyOwnSelectionAdapter) {
      return true;
   }
} 
```

您`MyOwnSelectionAdapter`自己的`SelectionAdapter`.

4）。现在您可以执行以下操作：`cancel.removeSelectionListener(new MyOwnSelectionAdapter());`它将删除该选择侦听器。

# networking - 在 SSL 中进行客户端身份验证时出现 SSL 警报 43

> ID：14435839
> 
> 赞同：4
> 
> 时间：2013-01-21T09:37:57.470
> 
> 标签：networking, ssl, network-programming, openssl

我创建了简单的 SSL 客户端服务器程序，在该程序中我使用的是自签名证书，该证书是根据[https://help.ubuntu.com/community/OpenSSL上的帮助使用我自己的本地 CA 创建的](https://help.ubuntu.com/community/OpenSSL "https://help.ubuntu.com/community/OpenSSL")

所以我有我的 CA 证书和私钥。由我的 CA 签名的服务器证书和服务私钥。由我的 CA 和客户端私钥签署的客户端证书。

下面是客户端服务器程序的代码部分，它显示了证书的加载和 SSL 握手。

服务器：

```
SSL_library_init();
ctx = InitServerCTX(); /* initialize SSL */
LoadCertificates(ctx, "server_crt.pem", "server_key.pem"); /* load certs */
SSL_CTX_load_verify_locations(ctx, "cacert.pem", NULL);
//SSL_CTX_set_verify(ctx, SSL_VERIFY_PEER | SSL_VERIFY_FAIL_IF_NO_PEER_CERT, 0);
SSL_CTX_set_verify(ctx, SSL_VERIFY_PEER | SSL_VERIFY_CLIENT_ONCE, 0);
SSL_CTX_set_verify_depth(ctx, 1);
SSL_CTX_set_client_CA_list(ctx, SSL_load_client_CA_file("cacert.pem"));
server = OpenListener(atoi(portnum)); /* create server socket */
while (1)
{
    struct sockaddr_in addr;
    int len = sizeof(addr);
    SSL *ssl;

    int client = accept(server, (struct sockaddr*) &addr, &len); /* accept connection as usual */
    printf("Connection: %s:%d\n", inet_ntoa(addr.sin_addr), ntohs(addr.sin_port));
    ssl = SSL_new(ctx); /* get new SSL state with context */
    SSL_set_fd(ssl, client); /* set connection socket to SSL state */
    Servlet(ssl); /* service connection */
} 
```

客户：

```
SSL_library_init();
ctx = InitCTX();
LoadCertificates(ctx, "client_crt.pem", "client_key.pem"); /* load certs */
SSL_CTX_load_verify_locations(ctx, "cacert.pem", NULL);
SSL_CTX_set_verify_depth(ctx, 1);
server = OpenConnection(hostname, atoi(portnum));
ssl = SSL_new(ctx); /* create new SSL connection state */
SSL_set_fd(ssl, server); /* attach the socket descriptor */
if (SSL_connect(ssl) != 1) /* perform the connection */
    ERR_print_errors_fp(stderr);
else
{
    char *msg = "This is Darshan";

    printf("Connected with %s encryption\n", SSL_get_cipher(ssl));
    ShowCerts(ssl); /* get any certs */
    SSL_write(ssl, msg, strlen(msg)); /* encrypt & send message */
    bytes = SSL_read(ssl, buf, sizeof(buf)); /* get reply & decrypt */
    buf[bytes] = 0;
    printf("Received: \"%s\"\n", buf);
    SSL_free(ssl); /* release connection state */
} 
```

现在，当我运行此程序时，我在客户端中收到如下错误：

```
3073476808:error:14094413:SSL routines:SSL3_READ_BYTES:sslv3 alert unsupported certificate:s3_pkt.c:1248:SSL alert number 43 
```

为什么我收到此错误？我的证书没问题，客户端和服务器证书都由我的 CA 签名。请帮我找出错误。

客户证明：

```
Certificate:
Data:
    Version: 3 (0x2)
    Serial Number: 2 (0x2)
Signature Algorithm: md5WithRSAEncryption
    Issuer: CN=My Root Certificate Authority, ST=somestate, C=IN/emailAddress=xyz@xyz.com, O=XYZ Ltd., OU=Department
    Validity
        Not Before: Jan 18 07:50:30 2013 GMT
        Not After : Jan 17 07:50:30 2018 GMT
    Subject: CN=localhost, ST=somestate, C=IN/emailAddress=abc@abc.com, O=ABC Ltd., OU=Software Department
    Subject Public Key Info:
        Public Key Algorithm: rsaEncryption
            Public-Key: (1024 bit)
            Modulus:
                00:c1:1e:ea:56:d9:44:05:28:cb:4e:cd:85:88:9a:
                8e:8d:77:d7:80:92:7c:b5:20:89:31:45:2a:73:72:
                5d:d2:01:3c:1d:18:2e:c2:72:56:4d:84:f4:21:ae:
                55:d6:b5:5c:58:9a:3b:48:2c:9e:05:a4:ee:af:b7:
                f4:42:ef:54:9c:a1:bc:a9:b5:53:dc:69:90:d2:df:
                c0:e0:09:d5:e4:d4:08:a8:f2:76:1b:c5:0d:c9:13:
                eb:ba:76:09:a2:67:38:cc:d8:6d:44:51:78:39:03:
                b4:a4:a1:73:ec:d4:7d:c3:06:4b:64:6b:f7:14:d3:
                1c:c9:e4:db:cc:82:5c:94:fb
            Exponent: 65537 (0x10001)
    X509v3 extensions:
        X509v3 Subject Alternative Name: 
            DNS:www.example.com
        X509v3 Basic Constraints: 
            CA:FALSE
        Netscape Cert Type: 
            SSL Server
Signature Algorithm: md5WithRSAEncryption
     ba:76:2c:2a:15:f3:98:32:86:60:dc:2a:a9:a6:a8:ca:e6:a7:
     74:d8:8f:0e:b2:ad:00:ef:fc:13:74:26:75:12:fa:af:4f:55:
     61:75:34:77:8c:37:b9:58:ab:ee:71:9b:6d:3c:10:ab:f0:20:
     73:89:7c:5c:e2:df:82:21:96:b4:91:5a:9b:f8:10:6a:4b:01:
     06:7e:b6:26:bc:c1:80:21:85:d9:7f:0b:56:a3:89:5e:e1:f4:
     31:d1:c9:be:a3:39:d5:51:0a:3e:b9:27:fb:82:5f:d1:24:40:
     f0:84:a4:f9:bc:23:11:fb:65:ad:d5:bc:2e:23:a0:5c:0f:58:
     a5:8b:38:f6:0c:52:65:f1:84:29:be:dd:77:73:2b:3c:b6:4c:
     4e:87:3f:38:45:48:b2:50:24:7a:06:fe:ac:79:bf:04:88:d6:
     5d:4b:38:f9:25:90:c9:e4:d6:7d:6b:1c:9a:78:10:5a:42:43:
     8d:26:08:6e:f9:34:e1:8f:2f:bb:33:d5:96:b6:2a:35:75:c1:
     e5:f2:b9:3d:8a:0d:49:e8:00:3c:08:03:5a:97:e2:79:4b:1a:
     9c:98:5c:ba:8b:5b:44:5c:a3:0e:6f:d5:af:5a:9e:88:4e:2e:
     fe:91:ae:95:83:75:68:71:04:e5:99:1b:3e:bc:a6:cf:84:2f:
     98:78:25:33 
```

- - -开始CERTIFICATE ----- MIIDiDCCAnCgAwIBAgIBAjANBgkqhkiG9w0BAQQFADCBtzEsMCoGA1UEAxMjSW52 aXhpdW0gUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkxEDAOBgNVBAgTB0d1amFy YXQxCzAJBgNVBAYTAklOMSYwJAYJKoZIhvcNAQkBFhdkcHJhamFwYXRpQGludml4 aXVtLmNvbTEiMCAGA1UEChMZSW52aXhpdW0gQWNjZXNzIFB2dC4gTHRkLjEcMBoG A1UECxMTRW1iZWRkZWQgRGVwYXJ0bWVudDAeFw0xMzAxMTgwNzUwMzBaFw0xODAx MTcwNzUwMzBaMIGbMRAwDgYDVQQDEwdpeG0ud2ViMRAwDgYDVQQIEwdHdWphcmF0 MQswCQYDVQQGEwJJTjEmMCQGCSqGSIb3DQEJARYXZHByYWphcGF0aUBpbnZpeGl1 bS5jb20xIjAgBgNVBAoTGUludml4aXVtIEFjY2VzcyBQdnQuIEx0ZC4xHDAaBgNV BAsTE1NvZnR3YXJlIERlcGFydG1lbnQwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJ AoGBAMEe6lbZRAUoy07NhYiajo1314CSfLUgiTFFKnNyXdIBPB0YLsJyVk2E9CGu Vda1XFiaO0gsngWk7q + 39ELvVJyhvKm1U9xpkNLfwOAJ1eTUCKjydhvFDckT67p2 CaJnOMzYbURReDkDtKShc + zUfcMGS2Rr9xTTHMnk28yCXJT7AgMBAAGjPTA7MBsG A1UdEQQUMBKCEHd3dy5pbnZpeGl1bS5jb20wCQYDVR0TBAIwADARBglghkgBhvhÇAQEEBAMCBkAwDQYJKoZIhvcNAQEEBQADggEBALp2LCoV85gyhmDcKqmmqMrmp3TY jw6yrQDv / BN0JnUS + q9PVWF1NHeMN7lYq + 5xm208EKvwIHOJfFzi34IhlrSRWpv4 EGpLAQZ + tia8wYAhhdl / C1ajiV7h9DHRyb6jOdVRCj65J / uCX9EkQPCEpPm8IxH7 Za3VvC4joFwPWKWLOPYMUmXxhCm + 3XdzKzy2TE6HPzhFSLJQJHoG / qx5vwSI1l1L OPklkMnk1n1rHJp4EFpCQ40mCG75NOGPL7sz1Za2KjV1weXyuT2KDUnoADwIA1qX 4nlLGpyYXLqLW0Rcow5v1a9anohOLv6RrpWDdWhxBOWZGz68ps + EL5h4JTM = ----- END CERTIFICATE -----

客户端配置文件：

#

# 例子.cnf

#

[ req ] 提示 = no distinct_name = server_distinguished_name

[ server_distinguished_name ] commonName = abc.com stateOrProvinceName = NC countryName = US emailAddress = root@abc.com organizationName = 我的组织名称 organizationsUnitName = 我的大型组织的子单位

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T14:08:25.843

服务器提供的 X.509 证书似乎无效。您能否发布 'openssl x509 -text -in your_cert_file' 的结果？

我怀疑您的证书没有在“x509v3 扩展密钥用法”扩展中设置“Web 服务器身份验证”用法。

[编辑]

查看您发布的证书，Netscape Cert Type 错误，如果这是客户端证书，则设置为“SSL Server”而不是“SSL Client”。

您可能还想设置一些 v3 扩展，例如 X509v3 密钥用法和 X509v3 扩展密钥用法，但这不是强制性的。

如果您对精确检查感兴趣，可以阅读 crypto/x509v3/v3purp.c 中的 OpenSSL 相关代码

[/编辑]

# php - PHP Comet（服务器端推送）

> ID：14435842
> 
> 赞同：3
> 
> 时间：2013-01-21T09:38:20.370
> 
> 标签：php, websocket, comet, server-push, fuelphp

> **可能重复：**
> [在 PHP 中使用彗星？](https://stackoverflow.com/questions/603201/using-comet-with-php)

我正在编写一个后端用 PHP 编写的社交应用程序（我使用的是 FuelPHP 框架）。我想通知客户端服务器上发生了某些事件，其方式与 Facebook 通知的方式类似。

目前我只是使用 AJAX 重复轮询，但我认为我可以使用服务器上的一个事件来实现更好的实现，该事件被触发到客户端。

使用 node.js，我已经使用 Web 套接字和 socket.io 模块实现了这种通信。

有什么办法可以在 PHP 中做这种事情吗？PHP真的那么不适合这种通信吗？我可以以某种方式生成一个基于节点的子进程吗？

这是缺乏知识，有人可以指出我可以研究的解决方案吗？

这段代码可以说明我正在尝试做的事情......

```
private function initEvents() {

  $events = Event::instance('chat_event_listener');

  $events->register('messageWasReceived', function($message){
    $this->handleMessageReceived($message);
  });

}

public function post_addNewMessage(){

  //Client uses Posts message to this method using AJAX

  $message = \Input::post('message');
  Event::instance('chat_event_listener')->trigger('messageWasReceived', $message);

  return $this->response(array(
    'success' => true,
    'data' => 'TO DO',
  ));

}

private function handleMessageReceived($message){
  $this->firephp->log('Message received on server: ' . $message);
  //notify client
} 
```

# mybatis - 如何防止Mybatis覆盖DAO中已经生成的mapper文件？

> ID：14435843
> 
> 赞同：1
> 
> 时间：2013-01-21T09:38:20.550
> 
> 标签：mybatis

由于需求在变化，我需要时常使用Mybatis更新DAO的mapper文件。这是我遇到的问题：我们已经生成了一组映射器 xml 文件，此外，我们在映射器文件中定义了自己的特定元素。

```
<select id="selectTop20PlayerOfClassicCard" resultMap="CollectionRankingMap">
    SELECT playerid,count(cardid) from re_player_card where type in (0,1) GROUP
    BY playerid ORDER BY COUNT(*) DESC limit 20;
</select>

<select id="selectTop20PlayerOfSpecialCard" resultMap="CollectionRankingMap">
    SELECT playerid,count(cardid) from re_player_card where type=2 GROUP BY
    playerid ORDER BY COUNT(*) DESC limit 20;
</select>

<resultMap id="CollectionRankingMap" type="dymaic.RePlayerCardRanking">
    <!-- manually generated -->
    <result column="playerid" jdbcType="INTEGER" property="playerid" />
    <result column="count(cardid)" jdbcType="INTEGER" property="count" />
</resultMap>

<select id="getCardIdByPlayerId" parameterType="int" resultType="int">
    select
    re_player_card.cardid
    from re_player_card
    where playerid = #{playerid}
</select> 
```

3个select语句和resultmap都是我们自己定义的。现在我将再次重新生成映射器文件。但我不希望这些语句块被覆盖。我需要将它们保存在映射器文件中，同时使用 Mybatis 更改其余部分。

我正在使用 Mybatis 生成器 eclipse 插件。那么有什么方法可以实现吗？我很感激你们的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T06:23:55.120

我不认为 MyBatis Generator Tool 能够更新生成文件的部分内容。

如果您使用的是 MyBatis Generator Maven 插件，您可以在 pom.xml 中添加以下属性，以告知不要覆盖现有文件并生成具有其他名称的文件。

```
<mybatis.generator.overwrite>false</mybatis.generator.overwrite> 
```

PS：我上面的假设是错误的。

**来自 MyBatis 文档：**

MyBatis 生成器旨在在迭代开发环境中良好运行，并且可以作为 Ant 任务或 Maven 插件包含在持续构建环境中。迭代运行 MBG 时需要注意的重要事项包括：

> 1.  如果存在与新生成的 XML 文件同名的现有文件，MBG 将自动合并 XML 文件。MBG 不会覆盖您对其生成的 XML 文件所做的任何自定义更改。您可以一遍又一遍地运行它，而不必担心丢失对 XML 的自定义更改。
>     
>     
> 2.  MBG 将替换之前运行中生成的任何 XML 元素。MBG 不会合并 Java 文件，它可以覆盖现有文件或使用不同的唯一名称保存新生成的文件。如果您对生成的 Java 文件进行更改并迭代运行 MBG，则必须手动合并更改。当作为 Eclipse 插件运行时，MBG 可以自动合并 Java 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-18T11:12:39.473

**将您的更改放入另一个映射器 XML 文件**

1.  获取现有文件副本，例如`MyMapperBits.xml`，我选择更改命名空间`..."http://mybatis.org/dtd/mybatis-3-mapper.dtd"> <mapper namespace="MyMapperBitsMapperNameSpace">`

2.  在你的主 mybatis 配置文件中添加`MyMapperBits.xml`引用。在这个例子中，`package name`项目还包含各种 XML 映射器，我已经配置了 mybatis 生成器来创建它们。

    ```
     <mappers>
         <mapper resource="com/example/extended/xmlmapper/MyMapperBits.xml" />
         <package name="com.exmaple.generated.xmlmapper.input_output"/>
         <package name="com.exmaple.generated.xmlmapper.pg_schema_1"/>
         <package name="com.exmaple.generated.xmlmapper.pg_schema_2"/>
    </mappers> 
    ```

3.  然后，您可以通过文件中定义的命名空间访问 MyMapperBits.xml 来访问“SQL”

    ```
    sqlSession . selectList(
    "MyMapperBitsMapperNameSpace.selectTop20PlayerOfClassicCard" ) ; 
    ```

# vb.net - 从实体数据模型自动创建部分类

> ID：14435846
> 
> 赞同：1
> 
> 时间：2013-01-21T09:38:26.433
> 
> 标签：vb.net, visual-studio-2010, entity-framework, visual-studio-2012

如果我使用使用模型优先的方法创建实体数据模型并从现有数据库构建我的模型，是否有一种方法可以自动创建部分类，然后允许我扩展模型以满足我的要求。因此，例如，如果我对 Northwind 数据库进行建模，那么除其他外，将为“客户”和“订单”创建实体。我想找到一种方法让 Visual Studio 为每个实体构建一组部分类并将它们放入单独的文件中。

我不知道这是否可行，或者这是否是最好的方法。为此，我欢迎任何关于从哪里开始学习如何处理这类事情的建议和/或好的基本示例。理想情况下，任何此类示例都包含 vb 和 c# 中的内容。

非常感谢

# android - Android POST JSON 到 PHP

> ID：14435852
> 
> 赞同：-1
> 
> 时间：2013-01-21T09:38:53.913
> 
> 标签：android

**嗨，我想将 JSON 发布到 PHP 脚本。** 这是代码：

```
JSONObject obj = new JSONObject();
for(int k = 0; k<len;k++){
   obj.put("nachrichten_ids", params[k]);
}               
HttpClient httpClient = new DefaultHttpClient();
HttpPost httpPost = new HttpPost("xxxxxx");

List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
nameValuePairs.add(new BasicNameValuePair("nachrichten_ids",obj.toString()));

httpPost.setHeader("Content-type", "application/json");
httpPost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
HttpResponse response = httpClient.execute(httpPost); 
```

PHP 脚本实际上只包含 print_r($_POST)，**并且每次都是空的。**

**问题出在哪里 ？**

**Log.i("TEST",obj.toString()) 输出：** {"nachrichten_ids":"[2144,2138]"}

其中每个数字都是应删除的消息的 IDS。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:41:43.140

这个对我有用 ：

```
/**
     * Functionality of HTTP POST and return response
     * @param url to hit
     * @param json object to post
     * 
     * @return string response
    */
        public String httpPostWithJson(String url, JSONObject json)
        {
            String result = "";
            try
            {
                 HttpPost httppost = new HttpPost(url);

                HttpParams myParams = new BasicHttpParams();
                HttpConnectionParams.setConnectionTimeout(myParams, 10000);
                HttpConnectionParams.setSoTimeout(myParams, 60000);
                HttpConnectionParams.setTcpNoDelay(myParams, true);

                httppost.setHeader("Content-type", "application/json");
                HttpClient httpclient = new DefaultHttpClient(myParams);

               StringEntity se = new StringEntity(json.toString(), HTTP.UTF_8); 
               se.setContentEncoding(new BasicHeader(HTTP.CONTENT_TYPE, "application/json"));
               httppost.setEntity(se); 

              // Execute HTTP Post Request
               HttpResponse response = httpclient.execute(httppost);
    //        Log.e("","response code = "+response.getStatusLine().getStatusCode() );
              if (response.getStatusLine().getStatusCode() == 200)
              {
                  HttpEntity entity = response.getEntity();
                  result = EntityUtils.toString(entity);
              }
            }
            catch (Exception e) {
    //          Log.e(TAG, e.toString());
            }
            return result;
        } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-21T16:48:18.703

**所以，现在它的工作。我使用了库“Gson”：**

```
 final ArrayList<String> delMessagesId = new ArrayList<String>(); 
    for(int i=0;i<nachrichtenListe.size();i++){
      Nachricht nachricht = nachrichtenListe.get(i);
      if(nachricht.isSelected() == true){
        delMessagesId.add(nachricht.nachricht_id); 
       }
    }

    String ddate = new Gson().toJson(params);
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("xxx");

    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(1);
    nameValuePairs.add(new BasicNameValuePair("nachrichten_ids", ddate));
    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

    // Execute HTTP Post Request
    HttpResponse response = httpclient.execute(httppost);
    HttpEntity entity = response.getEntity();

    // Get the return string (JSON data)
    String temp = EntityUtils.toString(entity);
    Log.i("TEST",temp); 
```

# iphone - 如何在饼图中添加数据标签以及如何使用核心图为饼图的图例屏幕设置框架/位置

> ID：14435853
> 
> 赞同：0
> 
> 时间：2013-01-21T09:38:56.993
> 
> 标签：iphone, objective-c, core-plot

[我按照PIE CHART 的 Rayenderlich CORE PLOT 教程](http://www.raywenderlich.com/13269/how-to-draw-graphs-with-core-plot-part-1)在 iPhone 应用程序上实现了一个饼图

[http://www.raywenderlich.com/13269/how-to-draw-graphs-with-core-plot-part-1](http://www.raywenderlich.com/13269/how-to-draw-graphs-with-core-plot-part-1)

这里我有一些问题，

我需要**在图表上添加另一个数据标签（项目名称）**，

我尝试实现另一种方法，例如

```
-(CPTLayer *)dataLabelForPlot:(CPTPlot *)plot recordIndex:(NSUInteger)index 
```

在 CorePlot.h（我在应用程序中只找到一次）和我的 viewcontroller 类中的方法定义中，

但尚未显示额外的数据标签。

我需要将图例表移动到图表下方，而不是在 我尝试使用 frame 和 legendDisplacement 但未找到结果**的图表旁边**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T12:16:06.560

数据标签与绘图数据相关联，一个用于饼图中的每个切片。在您的示例图像中，“每周报告”将是图表`title`。

```
graph.title = @"Weekly Report";
CPTMutableTextStyle *textStyle = [CPTMutableTextStyle textStyle];
textStyle.color                = [CPTColor whiteColor];
textStyle.fontName             = @"Helvetica-Bold";
textStyle.fontSize             = 12.0;
graph.titleTextStyle           = textStyle;
graph.titleDisplacement        = 5.0;
graph.titlePlotAreaFrameAnchor = CPTRectAnchorTop; 
```

您可以使用属性移动图例`legendAnchor`：

```
graph.legendAnchor = CPTRectAnchorBottom; 
```

与 类似`titleDisplacement`，`legendDisplacement`设置图例与其在图表上的锚点之间的边距。

# c++ - 分发使用 JNI 的应用程序的最佳方式

> ID：14435858
> 
> 赞同：3
> 
> 时间：2013-01-21T09:39:33.163
> 
> 标签：c++, windows, visual-studio-2010, java-native-interface, installation

我目前正在使用 JNI 调用位于 jar 文件中的方法的 Windows 桌面应用程序。

我需要知道打包我的应用程序以便它可以链接到 jvm.dll 的最佳方式。我不确定是否应该将在 JDK 的 bin 目录中找到的所有二进制文件打包到我的安装文件中（不确定是否允许这样做）？

问题是网上找到的所有例子都直接链接了JDK安装路径下的jvm.dll。而且由于我的应用程序是商业应用程序，我不能依赖或要求每个用户都应该在我的应用程序旁边安装 JDK，因为那太荒谬了。

请有人可以澄清打包此类应用程序的最佳方法吗？

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T10:26:32.200

jvm.dll 也与普通的 java 运行时（bin/client 子目录）一起安装。通过检查一些注册表值，您可以找到它的路径，从那里加载它并检查是否安装了正确的版本。如果您已经链接了 jvm.lib，那么您需要将 jvm.dll 添加到延迟加载的 dll 列表中，以便您可以在运行时加载它。

有关详细信息，请参阅我最近对另一个问题的回答：
[https ://stackoverflow.com/a/14434203/93652](https://stackoverflow.com/a/14434203/93652)

# c++ - 使用整数和移位来模拟浮点运算

> ID：14435861
> 
> 赞同：0
> 
> 时间：2013-01-21T09:39:43.330
> 
> 标签：c++, bit-manipulation

我的问题是我目前正在开发的 C++ 框架中的范围界定效率。上下文：我有两个大小相等的数组。其中一个包含来自检测到的点云的点坐标，另一个包含相应的颜色值。出现的问题是颜色值索引与点坐标不完全匹配，因此需要缩放颜色数组。

为了保持系统的效率，建议我使用以下“hack”来避免浮点运算，以便让 shift_row_index 运行得比 x 慢，以便缩放颜色数组索引。不幸的是，顾问目前不可用，我不明白为什么这个解决方案在这种情况下有效。

如果有人可以向我解释一下，你会很好。提前致谢！

```
int shifted_row_index = (RGB_OFFSET_X << 8);
for (int x = 0, xmax = g_depthMD.XRes(); x < xmax; x += raster_width)
{
     shifted_row_index += RGB_SCALE_FACTOR_X;
     int rowindex = shifted_row_index >> 8;
     rowindex = std::max(std::min(rowindex, (int)(xmax - 1)), 0);
     color_pointer[0] = pImageRow[rowindex].nRed;
     //....
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:45:48.707

我看到的唯一“bit hack”操作是左右移位操作。我认为您没有理由使用它们，因为任何合理的编译器都会优化代码：

```
int shifted_row_index = (RGB_OFFSET_X * 64); 
```

和

```
int rowindex = shifted_row_index / 64; 
```

一样高效。

# delphi - 使用 TPrototypeBindSource 设计 UI 后如何在运行时切换到 TBindSourceDB？

> ID：14435863
> 
> 赞同：2
> 
> 时间：2013-01-21T09:39:50.740
> 
> 标签：delphi, delphi-xe3, livebindings

我正在尝试 XE3 中的 LiveBindings。

我设计了一个带有一些控件的表单，使用`TPrototypeBindSource`. 控件在`TPrototypeBindSource`使用可视化设计器时被绑定到字段。我可以在设计时看到控件上的随机数据，并且我对布局感到满意。

接下来，我想将 UI 控件与`TClientDataSet`实例中的实时数据存储挂钩。有没有简单的方法来做到这一点？

我尝试了该`TPrototypeBindSource.OnCreateAdapter`活动，但找不到`TBindsourceAdapter`适合`TDataset`. 有一个`TBindSourceDB`但它无法钩到`TBindSourceAdapter`。

`TPrototypeBindSource`我找到的唯一解决方案是我必须将链接从to重新分配`TBindSourceDB`，这样做会使随机数据在设计时丢失。

有什么方法可以让设计时间使用原型数据和运行时使用数据集的数据？

# c# - 重置 8*8 数组的背景色 C#

> ID：14435867
> 
> 赞同：0
> 
> 时间：2013-01-21T09:40:09.527
> 
> 标签：c#, winforms, button, backcolor

嘿伙计们，我现在有一个问题，我有一个 8*8 的按钮阵列。他们可以通过点击来改变颜色。我想制作一个重置按钮，这样当您单击重置按钮时，它们将再次返回背景黑色。Button1 是复位按钮。它位于代码的底部。

这是代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WindowsFormsApplication2
{
    public partial class Form1 : Form
    {
        Button[,] btn = new Button[8, 8];
        public Form1()
        {
            InitializeComponent();
            for (int x = 0; x < btn.GetLength(0); x++)
            {
                for (int y = 0; y < btn.GetLength(1); y++)
                {
                    btn[x, y] = new Button();
                    btn[x, y].SetBounds((50 * x) + 30, (50 * y) + 30, 40, 40);
                    btn[x, y].Click += new EventHandler(this.btnEvent_click);
                    Controls.Add(btn[x, y]);
                    btn[x, y].BackColor = Color.Black;
                }
            }

            this.FormClosing += new FormClosingEventHandler(this.SaveEventHandler);
            LoadFromFile();
        }

        void btnEvent_click(object sender, EventArgs e)
        {
            Control ctrl = ((Control)sender);
            switch (ctrl.BackColor.Name)
            {
                case "Red":
                    ctrl.BackColor = Color.Green;
                    break;
                case "Black":
                    ctrl.BackColor = Color.Red;
                    break;
                case "Green":
                    ctrl.BackColor = Color.Yellow;
                    break;
                case "Yellow":
                    ctrl.BackColor = Color.Black;
                    break;
                default:
                    ctrl.BackColor = Color.Black;
                    break;
            }
        }

        void SaveEventHandler(object sender, EventArgs e)
        {
            SaveToFile();
        }

        private const string filePath = @"C:\testmap\test.txt";
        private void LoadFromFile()
        {
            if (!System.IO.File.Exists(filePath))
                return;

            byte[] data = System.IO.File.ReadAllBytes(filePath);
            if (data == null || data.Length != btn.GetLength(0) * btn.GetLength(1) * 2)
                return;

            for (int x = 0; x < btn.GetLength(0); x++)
            {
                for (int y = 0; y < btn.GetLength(1); y++)
                {
                    int position = (y * btn.GetLength(0) + x);

                    string value = ((char)data[2 * position]).ToString() + ((char)data[2 * position + 1]).ToString();
                    Color color;
                    switch (value)
                    {
                        case "01":
                            color = Color.Red;
                            break;
                        case "00":
                            color = Color.Black;
                            break;
                        case "10":
                            color = Color.Green;
                            break;
                        case "11":
                            color = Color.Yellow;
                            break;
                        default:
                            color = Color.Black;
                            break;
                    }

                    btn[x, y].BackColor = color;
                }
            }
        }

        private void SaveToFile()
        {
            Dictionary<Form1, int> d = new Dictionary<Form1, int>();

            byte[] data = new byte[btn.GetLength(0) * btn.GetLength(1) * 2];
            for (int x = 0; x < btn.GetLength(0); x++)
            {
                for (int y = 0; y < btn.GetLength(1); y++)
                {
                    int position = (y * btn.GetLength(0) + x);
                    string value;
                    switch (btn[x, y].BackColor.Name)
                    {
                        case "Red":
                            value = "01";
                            break;
                        case "Black":
                            value = "00";
                            break;
                        case "Green":
                            value = "10";
                            break;
                        case "Yellow":
                            value = "11";
                            break;
                        default:
                            value = "00";
                            break;
                    }
                    data[2 * position] = (byte)value[0];
                    data[2 * position + 1] = (byte)value[1];
                }
            }

            System.IO.File.WriteAllBytes(filePath, data);
        }

        private void button1_Click(object sender, EventArgs e)
        {

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:43:12.347

就像您初始化按钮一样，您可以将背景颜色设置回黑色：

```
private void button1_Click(object sender, EventArgs e)
{
        for (int x = 0; x < btn.GetLength(0); x++)
        {
            for (int y = 0; y < btn.GetLength(1); y++)
            {
                btn[x, y].BackColor = Color.Black;
            }
        }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:42:58.287

```
for(int i=0;i<8;i++)
{
   for(int j=0;j<8;j++)
   {
       btn[i, j].BackColor = Color.Black;
   }  
} 
```

但你试过什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T09:43:18.897

[http://msdn.microsoft.com/en-AU/library/system.windows.forms.control.tag.aspx](http://msdn.microsoft.com/en-AU/library/system.windows.forms.control.tag.aspx)

假设您不打算将控件的 Tag 属性用于其他任何事情，您可以考虑将所有附属元素设置为特定的 Tag，然后遍历表单的控件以将它们重置为所需的 BackColor，或者您可以简单地将 Tag 设置为您的所需的 BackColor 并让重置按钮根据需要进行迭代。

# javascript - 恢复旧的提交功能javascript

> ID：14435869
> 
> 赞同：1
> 
> 时间：2013-01-21T09:40:16.250
> 
> 标签：javascript, jquery, forms, form-submit

你有一个带有输入数据的表格。像

```
<form id = 'myform'>
...
            <td><input type="checkbox" name="supplier_aid" value="on" checked disabled >{$output.t_artikelnr}</td>
            <td><input type="checkbox" name="descshort" value="on">{$output.t_kurztext}</td>
            <td><input type="checkbox" name="buyer_aid" value="on">{$output.t_sap_materialnr}</td>
...
</form> 
```

在准备好文档时，我用我的函数替换了默认的提交函数（唯一的方法，遗留代码再次出现......）

```
document.myform.submit = function (){
 //do some stuff..

//and eventually

return true;
} 
```

但现在没有表单提交发生......谁知道我怎样才能恢复提交行为？

这是整个js

```
<script type="text/javascript">
       $(document).ready(function(){

        document.articlelistform.progress = {};     
        document.articlelistform.progress.update = function(){
            var variables = document.articlelistform.progress;
            var state = variables.data.done / variables.data.togo;    
            if(document.articlelistform.progress.lock){
                 variables.bar.updateProgress(state,'{/literal}{$output.m_queue_progress_message_status}{literal}')
                 return;
            }

            if(typeof(variables.togo) =='undefined'){
                variables.togo = 5;
                }
            switch(variables.data.state){
                case 'inQue':

                        variables.bar.updateProgress((5 - variables.togo) / 5,'{/literal}{$output.m_queue_progress_message_gathering}{literal}');   
                        variables.togo--;
                        if(variables.togo <= 0) variables.togo = 5;
                        document.articlelistform.submit(variables.data);

                    break;
                case 'inProcess':
                    if(variables.togo <= 0 || variables.data.update){
                        variables.togo = 5;
                        variables.bar.updateProgress(state,'{/literal}{$output.m_queue_progress_message_genarating}{literal} '+ variables.data.done + '/' + variables.data.togo);   
                        document.articlelistform.submit(variables.data);

                    }else variables.togo--;

                    break;
                case 'downloadDone': 
                        variables.bar.updateProgress(1,'{/literal}{$output.m_queue_progress_message_download}{literal}!');   
                            if(window.location != 'failed'){
                                window.location = variables.data.location;
                                clearInterval(variables.ticking);
                                delete variables.ticking;
                                variables.togo = 5;
                                variables.state = 'new';
                            }else{
                                document.articlelistform.progress.bar.updateProgress(1,'{/literal}{$output.m_queue_progress_message_networkerr}{literal}!');
                            }
                       break;
                 case 'error' :
                     clearInterval(variables.ticking);
                     delete variables.ticking;
                     variables.togo = 5;
                     variables.state = 'error';
                     document.articlelistform.progress.bar.updateProgress(1,'{/literal}{$output.m_queue_progress_message_server_error}{literal}');
                     document.articlelistform.submit(variables.data);
                     break;

            }
        }

        document.articlelistform.submit = function(data){
            var settings = document.articlelistform.progress;
            settings.lock  = true;

            if(typeof(data) == 'undefined') data = {state:'new'};

            if(typeof(settings.data) != 'undefined')
            if(settings.data.state == 'downloadDone'){
               window.location = settings.data.location; 
               return false;
            }
            if(typeof(data) == 'object')
                if(data.state == 'error') document.articlelistform.submit()

            $('#formSettings').val(JSON.stringify(data));       
            $.ajax({
                type: "POST",
                url: 'ajax-backend/downloadCatalogueProgress.php',
                data:   $(this).serialize() ,

                success: function(data){

                    settings.lock  = false;
                    if(!data.error){

                        if((data.state == 'inQue' && typeof(settings.bar) == 'undefined')||data.progress){
                            delete data.progress;
                            $('#catalogMessageHolder').html('');
                            settings.bar = new Ext.ProgressBar({
                                renderTo: 'catalogMessageHolder',
                                value: 0.1,
                                width: 200,
                                maxValue:60,
                                minValue: 0,
                                text : '{/literal}{$output.m_queue_progress_message_genarating}{literal}.'

                            });
                            settings.data  = data;     
                            document.articlelistform.progress.ticking  = setInterval(settings.update, 1000, data, true);
                        }else{
                            settings.data  = data;
                        }
                        $('#cataloLoaderHolder').show();

                    }else{
                    //@todo: implement a warning message
                    }

                },
                failure: function(){
                 document.articlelistform.progress.bar.updateProgress(1,'{/literal}{$output.m_queue_progress_message_networkerr}{literal}!');
                } 
            });

            return true; 
        };
    });

    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T14:54:08.873

我设法从我的主管那里得到了改变该死的东西的许可。

我明白他为什么要我改变它......它在大约 20 个地方被硬编码......改变了一切。刚刚用 jquery 调用更改了 js 调用，一切正常。不知道为什么它更早起作用。但这是调用该函数的点击

```
> <td class="blue" background="gfx/buttonb.gif" align="center"
> valign="center"><nobr><a  href="javascript:void(0)" class="blue"
> onclick="if (!(document.articlelistform.catalogpartner3200.checked ||
> document.articlelistform.catalogpartner3582.checked ||
> document.articlelistform.catalogpartner5320.checked ||
> document.articlelistform.catalogpartner5109.checked ||
> document.articlelistform.catalogpartner4774.checked ||
> document.articlelistform.catalogpartner3271.checked ||
> document.articlelistform.catalogpartner3526.checked ||
> document.articlelistform.catalogpartner5544.checked ||
> document.articlelistform.catalogpartner3494.checked ||
> document.articlelistform.catalogpartner3416.checked ||
> document.articlelistform.catalogpartner4439.checked ||
> document.articlelistform.catalogpartner5328.checked ||
> document.articlelistform.catalogpartner5329.checked ||
> document.articlelistform.catalogpartner3267.checked ||
> document.articlelistform.catalogpartner3512.checked ||
> document.articlelistform.catalogpartner2848.checked ||
> document.articlelistform.catalogpartner3417.checked ||
> document.articlelistform.catalogpartner3491.checked ||
> document.articlelistform.catalogpartner3492.checked ||
> document.articlelistform.catalogpartner5554.checked ||
> document.articlelistform.catalogpartner5591.checked ||
> document.articlelistform.catalogpartner5611.checked ||
> document.articlelistform.catalogpartner3517.checked ||
> document.articlelistform.catalogpartner5305.checked ||
> document.articlelistform.catalogpartner3532.checked ||
> document.articlelistform.catalogpartner5077.checked ||
> document.articlelistform.catalogpartner3581.checked ||
> document.articlelistform.catalogpartner3507.checked ||
> document.articlelistform.catalogpartner3579.checked ||
> document.articlelistform.catalogpartner3489.checked ||
> document.articlelistform.catalogpartner3490.checked ||
> document.articlelistform.catalogpartner5306.checked ||
> document.articlelistform.catalogpartner5598.checked ||
> document.articlelistform.catalogpartner5191.checked ||
> document.articlelistform.catalogpartner3305.checked ||
> document.articlelistform.catalogpartner3578.checked ||
> document.articlelistform.catalogpartner3580.checked ||
> document.articlelistform.catalogpartner4934.checked ||
> document.articlelistform.catalogpartner4437.checked ||
> document.articlelistform.catalogpartner3568.checked ||
> document.articlelistform.catalogpartner4079.checked ||
> document.articlelistform.catalogpartner3723.checked ||
> document.articlelistform.catalogpartner5321.checked ||
> document.articlelistform.catalogpartner3569.checked)) {alert('Sie
> müssen mind. 1 Katalog auswählen');  } else { if
> (!(document.articlelistform.supplier_aid.checked ||
> document.articlelistform.descshort.checked ||
> document.articlelistform.buyer_aid.checked ||
> document.articlelistform.desclong.checked ||
> document.articlelistform.keywords.checked ||
> document.articlelistform.manufacturer_name.checked ||
> document.articlelistform.delivery_time.checked ||
> document.articlelistform.remarks.checked ||
> document.articlelistform.reference_feature_group_id.checked ||
> document.articlelistform.order_unit.checked ||
> document.articlelistform.content_unit.checked ||
> document.articlelistform.quantity_min.checked ||
> document.articlelistform.quantity_interval.checked ||
> document.articlelistform.price_amount.checked ||
> document.articlelistform.special_treatment_class.checked ||
> document.articlelistform.mimeinfo.checked ||
> document.articlelistform.sicherheitsdatenblatt.checked )) {alert('Sie
> müssen mind. 1 Auswahlkriterium wählen!');  } else {
> $('#catalogDownloadForm').submit(); } } return false;" onMouseOver=
> "window.status='Als CSV-Datei downloaden'; return true;"
> onMouseOut="window.status=''; return true;">&nbsp;Als CSV-Datei
> downloaden&nbsp;</a></td> 
```

代码很疯狂....我只是从`document.articlelistform.submit()`to 更改为`$('#catalogDownloadForm').submit()`所有工作都按应有的方式工作..不知道为什么会失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:47:03.140

```
document.myform.submit = function (event) {
    // init event if undefined
    if (!event) var event = window.event;
    if (doNotSubmit) {
        event.preventDefault();
        // form won't be submitted
    } else {
        // will automatically submit, no need to return anything
    }
} 
```

* * *

**编辑**

显然，您使用的是 jQuery。然后，另一种解决方案可能会起作用：

```
$("#myForm").on("submit", function() {
    if (doNotSubmit) {
        return false;
        // form won't be submitted
    } else {
        return true;
        // form will be submitted
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T09:56:03.967

你还没有声明一个 onsubmit 事件处理程序，你已经重新声明了提交本身！！！

所以，你真的想做：

```
document.myform.onsubmit = function(){
  // do some stuff...
  // and eventually
  return true;
}; 
```

看起来你做了，否则就不需要返回任何东西，因为`document.myform.submit`没有。

如果这是故意的（eek！），在重新定义之前，`document.myform.submit`您需要存储它：

```
document.myform.originalSubmit = document.myform.submit;
document.myform.submit = function (){
  //do some stuff..
  //and eventually
  document.myform.originalSubmit();
}; 
```

由于这会绕过您与表单关联的任何事件处理程序，因此我看不出这是您真正想要的，因为它不会与其他代码很好地配合使用。

# unix - RHL5 至 Sunsolaries

> ID：14435877
> 
> 赞同：0
> 
> 时间：2013-01-21T09:40:58.967
> 
> 标签：unix

下面的代码在 bash 中有效，但在 ksh 中无效。目前我正在使用 RHL5 版本的操作系统，下面的代码工作正常，但在 sunsolaries 中它不工作。在 sunsolaries 中，我们使用 Korn Shell。

```
#!/bin/bash
#give start date and enddate in the format yyyy_mm_dd
startdate="${1//_/-}"  # change underscores into dashes
enddate="${2//_/-}"
enddate=`date -d "$enddate + $i day" "+%Y_%m_%d"` #Increases enddate by 1 day so that        loop runs on given enddate also
enddate="${enddate//_/-}"
echo "StartDate: $startdate   EndDate+1Day: $enddate"
nextdate=$startdate #nextdate runs from startdate to enddate
while [ 1 ]
do
    echo "$nextdate $enddate"
if [ "$nextdate" == "$enddate" ];then     #after given enddate loop breaks
    break
fi
day=`date -d "$nextdate"`
arr=(${day// / })
echo "${arr[0]}"
if [ "${arr[0]}" == "Sat" ];then           #checking if day is Saturday, if true then increase nextday  and continue
    nextdate=`date -d "$nextdate + 1 day" "+%Y_%m_%d"`
    nextdate="${nextdate//_/-}"
    continue
fi
#####your code begins here
echo "creating file file_$nextdate.txt"
touch "file_$nextdate.txt" #test code, just creating files with date, remove this
#####your code ends here 
nextdate=`date -d "$nextdate + 1 day" "+%Y_%m_%d"`  #increasing nextday by 1 day
nextdate="${nextdate//_/-}"
done 
```

请帮助我如何在 ksh 中工作

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T13:01:13.890

您的脚本多次使用 Gnu 日期特定`-d`选项。要么找到一种不同的方法来实现它在你的用例中的作用，要么在 Solaris 机器上安装 Gnu date（如果还没有的话）。

# android - 如何在图像边框周围添加动画光？

> ID：14435884
> 
> 赞同：0
> 
> 时间：2013-01-21T09:41:30.030
> 
> 标签：android

这是我的动画图像代码工作正常，但我想在图像周围添加绿色照明边框我怎么做？喜欢这张图片 [http://imgur.com/qg0JM0q](http://imgur.com/qg0JM0q) 吗？

在图像圆形边框上淡入淡出？？？

```
public class MainActivity extends Activity {

Button btnAnimation, btnAnimation1, btnAnimation2;
 Animation performAnimation, performAnimation1, performAnimation2;
 ImageView androidImageView;

 @Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
 setContentView(R.layout.activity_main);

performAnimation1 = AnimationUtils.loadAnimation(this, R.layout.animation1);
 performAnimation1.setRepeatCount(4);

androidImageView = (ImageView)findViewById(R.id.androidImageView);

btnAnimation1 = (Button)findViewById(R.id.btn_animation1);

btnAnimation1.setOnClickListener(new View.OnClickListener() {

@Override
public void onClick(View v) {
androidImageView.startAnimation(performAnimation1);

 }
 });

}

 }

                <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<ImageView
android:id="@+id/androidImageView"
android:layout_width="30dp"
android:layout_height="40dp"
android:layout_alignParentTop="true"
android:layout_centerHorizontal="true"
android:layout_marginTop="192dp"
android:adjustViewBounds="false"
android:src="@drawable/alertlogo" />

<Button
android:id="@+id/btn_animation1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignLeft="@+id/androidImageView"
android:layout_below="@+id/btn_animation"
android:text="perform animation 2" />

</RelativeLayout>

<!------------ animation1.xml---->

          <?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android"
android:interpolator="@android:anim/decelerate_interpolator">

<alpha
android:fromAlpha="0.0"
android:toAlpha="1.0"
android:interpolator="@android:anim/accelerate_interpolator"
android:duration="8000" />

</set> 
```

# iphone - iPhone 应用程序在通过电缆部署时工作正常，但在测试飞行时却不行

> ID：14435890
> 
> 赞同：1
> 
> 时间：2013-01-21T09:41:51.197
> 
> 标签：iphone, objective-c, testflight

我有一个 iPhone 应用程序需要 2 次，然后计算开始时间和结束时间之间的时间范围。例如，我输入下午 5 点作为开始时间，下午 6 点作为结束时间，因此应用程序将计算并在设备中保存 3 个时间，并且这 3 个时间以 - 5pm - 5:30pm - 6pm 的顺序显示

所以奇怪的是，当我使用电缆传输在设备上测试这个构建时，我能够分别看到下午 5 点、下午 5 点 30 分和下午 6 点的时间。但是当我做一个 clean -> build 然后将它转移到 testflight 时。我看到了凌晨 2:30、下午 5:00 和下午 6:00 的时间

似乎 testflight 以某种方式搞砸了二进制文件，尽管我似乎无法弄清楚为什么。有人对这个问题有任何线索吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T10:38:24.043

我发现最常见的原因是存在一个仅在“发布”配置中出现的错误。“调试”配置有时能够隐藏错误，尤其是与内存管理相关时。

由于 TestFlight 通常会使用“Release”配置，因此它看起来可能会导致错误。看看您是否可以通过在“发布配置”中构建来在本地重现该错误。如果可以的话，您现在有一个更快的反馈循环来诊断日志语句的问题。（因为你没有调试器）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:46:24.043

尝试从 iPhone 中删除该应用程序，然后通过电缆重新启动该应用程序。这可能是一个原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T12:37:12.810

好的，错误已修复。它确实是那些没有出现在 Debug 配置中但出现在 Release 配置中的罕见错误之一。所以我所做的是通过代码进行静态分析并修复所有警告，然后错误消失了:)

# ios - 如何验证用户输入的邮政编码在 iOS 应用中是正确的美国邮政编码

> ID：14435892
> 
> 赞同：0
> 
> 时间：2013-01-21T09:41:58.767
> 
> 标签：ios, validation, zipcode

我已经验证 UITextfield 只能输入数字以及限制为 5 位数字。但是我如何检查输入的 5 位数代码是否是有效的美国邮政编码？有人可以提供执行此功能的代码/示例应用程序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T10:04:38.777

您可以在此处查看[http://www.populardata.com/zipcode_database.html](http://www.populardata.com/zipcode_database.html)并可以下载美国邮政编码列表，数据为 CSV 格式，但可以轻松转换为 xml，然后您可以将 xml 包含到您的项目中并通过各种解析方法每次需要与xml文件进行比较。

# extjs - 有没有办法将 Sencha Touch 转换为 Sencha EXTJ（或将 EXTJ 转换为 Touch）？

> ID：14435899
> 
> 赞同：3
> 
> 时间：2013-01-21T09:42:06.003
> 
> 标签：extjs, sencha-touch-2

对于一个项目，我为 java 主干创建了一个 ExtJS 接口。现在客户还想要一个移动版本（主要是平板电脑）。

Extjs 版本在手机上运行良好，但不是那么好用，所以我开始在 sencha touch 中开发应用程序。

因为这当然会花费很多新的时间，所以有人问我是否没有更简单的方法可以将 extjs 应用程序“转换”为触摸应用程序。

我在网上搜索过，似乎在“转换器”上找不到任何东西。

有这样的事吗？或者有没有一种方法可以让我对未来的应用程序进行编程，从而减少从一个框架迁移到另一个框架的痛苦？

（显然视图需要重写，我知道，但我说的是应用程序的其余部分——应该是可移植的？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T14:55:10.363

没有这样的工具可以将 ExtJs 转换为 Sencha-touch，反之亦然。实际上它们在功能和代码方面并不是 1:1 映射的，你能做的最好的就是重用模型、存储和控制器（在某种程度上，如果你使用 ExtJs 4）但必须重写视图。

# google-analytics - Google Analytics 跨浏览器跟踪仅将自己的域显示为目标流中的源

> ID：14435902
> 
> 赞同：0
> 
> 时间：2013-01-21T09:42:21.677
> 
> 标签：google-analytics, cross-domain, goal-tracking

我在谷歌分析中设置了跨浏览器跟踪以跟踪目标。但是，在目标流中，我只看到我的域 (mysite.com) 列在按来源访问的列表中。我已通过以下方式设置跟踪：

我网站的所有非安全页面都包含以下代码：

```
 <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-XXXXXXX-Y']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_setDomainName', '.mysite.com']);
  _gaq.push(['_setAllowHash', false])
  _gaq.push(['_trackPageview']);

  (function() {
   var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async =  true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
   })();
 </script> 
```

实现目标的网站的安全页面包含以下代码：

```
 <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-XXXXXXX-Y']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_setDomainName', '.my-securesite.com']);
  _gaq.push(['_setAllowHash', false]);
  _gaq.push(['_trackPageview']);

  (function() {
     var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
     ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
   })();
 </script> 
```

将数据从非安全页面推送到安全页面的表单包含以下数据：

```
<form id="21343" method="post" action="https://my-securesite.com" onsubmit="return _gaq.push(["_linkByPost", this]);"> 
```

查看页面的来源，我确实看到所有 utmx 数据都被发布：

```
 action="https://my-securesite.com/confirm.php?__utma=XXXXXXXXXXX" onsubmit="return _gaq.push(["_linkByPost", this]);"> 
```

一旦我通过例如在 Google 上的搜索访问 mysite.com，我在将数据发布到 my-securesite.com 时确实会看到以下 utmx 定义：

```
 utmcsr=google|utmccn=(organic)|utmcmd=organic| 
```

所以显然代码发布了正确的来源......

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T15:39:47.317

我发现了 GA 没有为我的目标显示正确来源的原因：

我使用了这个跟踪代码：

```
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXXXX-Y']);
_gaq.push(['_setAllowLinker', true]);
_gaq.push(['_setDomainName', '.mysite.com']);
_gaq.push(['_setAllowHash', false])
_gaq.push(['_trackPageview']); 
```

我被告知正确的跟踪代码现在看起来像：

```
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXXXX-Y']);
_gaq.push(['_setDomainName', '.mysite.com']);
_gaq.push(['_setAllowLinker', true]);
_gaq.push(['_trackPageview']); 
```

由于 _gaq.push(['_setAllowHash', false]) 不再使用。

除此之外，我使用 GA 的选项来跟踪结帐页面上的其他综合浏览量。我曾经使用此代码：

```
<script type="text/javascript">
   var _gaq = _gaq || [];
   _gaq.push(['_setAccount', 'UA-XXXXXXX-Y']);
   _gaq.push(['_trackPageview','/funnel/G1/Page-name']);
</script> 
```

但是正确的代码是：

```
<script type="text/javascript">
   var _gaq = _gaq || [];
   _gaq.push(['_setAccount', 'UA-XXXXXXX-Y']);
   _gaq.push(['_setDomainName', '.my-securesite.com']);
   _gaq.push(['_setAllowLinker', true]);
   _gaq.push(['_trackPageview','/funnel/G1/Page-name']);
</script> 
```

由于我实施了这些更改，GA 正确地跟踪了我的目标的来源。

# html - 如何创建带有两列子菜单弹出窗口的垂直纯 css html 菜单？

> ID：14435903
> 
> 赞同：0
> 
> 时间：2013-01-21T09:42:22.563
> 
> 标签：html, css

我想创建一个带有两列的垂直纯 css html 菜单，类似于 eBay 的垂直菜单。假设我进入一个类别，有一个弹出菜单带有两个菜单。

我知道如何做一个 CSS 菜单，但是只有一列下拉菜单。我希望有可能在同一个下拉列表中使用两个或三个列来将其两个。

谢谢。

# c++ - 在 Visual Studio C++ 6.0 中使用模板函数

> ID：14435910
> 
> 赞同：1
> 
> 时间：2013-01-21T09:42:43.233
> 
> 标签：c++, visual-studio, templates

0尊敬的 StackExchange 社区，

我花了两个小时试图找到问题的根源，但完全失败了。Research=google 搜索也没有提供任何可行的解决方案。至少我能够发现，在 VS 6.0 下，不能在 header 和 .cpp 文件之间拆分模板函数的声明和实现。

也许我的方法本身就有缺陷，或者这次是 VS 6.0 特别令人讨厌。

这是我写的测试代码。

```
#include "stdafx.h"
#include <string>
#include <iostream>

class TestClass{

  public:
     template<class T> inline bool isNull(T& inObject){
        return 0;   // edited because of the answer by Joachim Pileborg  :)
                // initial code was: return (inObject != NULL) ? 0:1; 
  }

};

using namespace std;

int main(int argc, char* argv[])
{
    cout<<TestClass::isNull<string>("test");
    return 0;
} 
```

运行此代码会导致以下错误：

*致命错误 C1001：INTERNER COMPILER-FEHLER（编译器文件“msc1.cpp”，第 1794 行）*

有人知道我在这里做错了什么吗？

PS：这次我真的很努力地尽可能准确地提出这个问题，并提供了一个具体的例子。请让我知道是否还有其他我应该添加的内容。

P.SS：我知道 Visual Studio 6.0 已经很老了，但我不得不在工作中使用它。使用新的编译器（在家）运行相同的代码不会导致任何错误。这就是为什么我认为问题主要是由 VS 6.0 的突发奇想引起的。

提前感谢您的帮助！京东

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T09:45:53.830

除非您定义返回指针的自定义转换运算符，否则对象实例永远不能等于`NULL`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:48:15.183

除了评论和答案中指出的事实之外，内部编译器错误发生在编译器中存在错误的情况下，这会阻止它编译有效代码。

Microsoft 通常在 IDE 修补程序或更新版本的编译器中修复这些错误。尝试修改代码结构，使其做同样的事情，但看起来不同——这是避免内部错误问题的唯一方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T09:51:30.113

你的代码有**几个问题：**

我是这样重写的：

*   比较您传递的引用的地址（您已经编辑了您的问题，但您`inObject==NULL`在函数的主体中编写了它并且它也无法编译）
*   使用 const string& 所以必须能够调用`TestClass::isNull<string>("test");`
*   如果你想以你的方式调用它，你必须将你的函数定义为静态的
*   我不确定，但是你的单词模板后面的字符 '<' 在我的 IDE 中看起来编码很糟糕，所以我用一个普通的替换它`<`，它编译得更好
*   这是一种编码方式，但在定义模板时更喜欢使用 typename 而不是 class
*   更喜欢使用`true`and`false`而不是`1`and `0`(你编辑了你的问题，但你仍然返回 0...)

=>

```
#include <string>
#include <iostream>

class TestClass{

  public:
    template<typename T> 
    static bool isNull(const T& inObject)
     {
        return (&inObject == NULL) ? true : false;
    }

};

using namespace std;

int main(int argc, char* argv[])
{
    cout<< TestClass::isNull<string>("test");
    return 0;
} 
```

现在它编译得很好。

# php - 打开浏览器时我需要将信息保存到数据库中

> ID：14435911
> 
> 赞同：-8
> 
> 时间：2013-01-21T09:42:44.567
> 
> 标签：php, javascript, browser

> **可能重复：**
> [javascript检测浏览器关闭选项卡/关闭浏览器](https://stackoverflow.com/questions/3888902/javascript-detect-browser-close-tab-close-browser)

关闭浏览器时，我需要将当前时间保存到数据库中。有没有人可以解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T10:01:14.303

```
window.onunload = function() {

var time = new Date().getTime();
var xhr = new XMLHttpRequest();
xhr.open("GET", "index.php?closetime="+time, true);
xhr.send();

}; 
```

在 index.php 中使用 $_GET["closetime"] 并将其保存到数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:55:36.473

卸载事件可能有效。

```
$(window).unload(function(){
  //write the time to database
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-21T09:44:43.670

您可以收听该`onbeforeunload`事件。当此事件触发时，您可以调用数据库。查看[这篇文章](http://jonathonhill.net/2011-03-04/catching-the-javascript-beforeunload-event-the-cross-browser-way/)，了解如何以跨浏览器的方式使用它。

# web-services - 使用 DTO 是否意味着我在方法调用中没有其他参数？

> ID：14435912
> 
> 赞同：1
> 
> 时间：2013-01-21T09:42:44.677
> 
> 标签：web-services, design-patterns, dto

我正在设置一个由多个 WCF 服务组成的应用程序，其中只有一个可以访问数据库。我们将在 DTO 中传递大量数据，有时是批量传递。因为批量操作假设一个参数保持不变，所以我喜欢以下模式：

```
private void UpdateItems(long clientId, ItemDto[] items); 
```

不过，根据[Martin Fowler](http://martinfowler.com/eaaCatalog/dataTransferObject.html)的说法，DTO 被定义为“可以保存调用的所有数据”的对象。这是否意味着我不应该在 DTO 之外传递其他数据？我真的应该看下面这样的模式吗？似乎打败了我的参数点。

```
private void UpdateItems(ItemsDto itemsDto);

ItemsDto {
    long ClientId;
    ItemDto[] Items;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T14:17:31.623

I think Martin Fowler is great, but definitely don't want to do anything "because Fowler said". What is really needed, is to think about why he gave that advice, and see if those reasons apply for you.

The effect of creating a multi-item DTO here would be to protect yourself from needing to change the interface if you need to change the arguments for batch operations.

For example, if you have to add `clientTimeStamp` to your parameters, it either looks like this:

```
private void UpdateItems(long clientId, DateTimeOffset clientTimeStamp, ItemDto[] items); 
```

or this:

```
private void UpdateItems(ItemsDto itemsDto);

ItemsDto {
    long ClientId;
    DateTimeOffset clientTimeStamp;
    ItemDto[] Items;
} 
```

Also, notice that you can still use your old interface in a day-to-day way by creating an extension method that packs the arguments into your DTO.

So what's the benefit? The difference is that if your methods are public and used by many clients, you can maintain backwards compatibility the second way. It's also a bit easier to change your code, though with VS and resharper, it doesn't actually make much difference. The cost is a some amount of additional code to write (fairly small in the example, but probably larger in your real codebase).

If you expect to have client code outside your direct control (including clients you write but may not be able to update for some reason), a DTO here is probably worth the cost. Otherwise, I would leave it alone until next time I wanted to add a parameter there.

# iphone - Zbar SDK 在 iOS6 中运行不佳

> ID：14435916
> 
> 赞同：2
> 
> 时间：2013-01-21T09:42:58.340
> 
> 标签：iphone, ios6, zbar-sdk

我正在实现一个要扫描 QR 码的应用程序。为此，我使用了 Zbar SDK，它可以正确扫描二维码。但问题是，在扫描时，除非并且直到我查看除 QR 码以外的任何其他内容，否则 QR 码不会被捕获。相同的应用程序在 iOS 5 上运行。但在 iOS 6 上出现此问题。

谁能知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T12:04:05.963

> 要解决此问题，请执行以下步骤：

**1.转到ZBar主页并导航到mercurial存储库[*直接链接*](http://zbar.hg.sourceforge.net/hgweb/zbar)**

**2\. 以 zip 格式下载 zbar 存储库。**

**3\. 解压缩文件并导航到名为“iphone”的子文件夹。**

**4\. 打开 XCode 项目。**

**5\. 删除“Examples”文件夹（该文件夹在我的机器上导致构建错误）。**

**6\. 点击“CMD + B”并构建源代码。**

**7\. 找到新的 libzbar.a 文件。（用户/库/开发人员/Xcode/DerivedData/zbar…）**

**8\. 将项目中旧的 libzbar.a 文件替换为新文件。**

**9\. 点击“CMD + R”就可以了。**

# html - 在移动浏览器中使用 HTML5 进行录音（访问麦克风）

> ID：14435917
> 
> 赞同：2
> 
> 时间：2013-01-21T09:42:59.693
> 
> 标签：html, google-chrome, web, cross-browser, mobile-browser

我们可以访问手机的麦克风来使用 HTML5 录制我们的声音吗？

我正在尝试这个链接：

[http://www.html5rocks.com/en/tutorials/getusermedia/intro/](http://www.html5rocks.com/en/tutorials/getusermedia/intro/)

我在哪里

<输入类型=“文件”接受=“音频/*；捕获=麦克风”>

我使用以下输入标签来访问麦克风，但它在设备的 HTML 查看器中不起作用。

请帮忙。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-17T21:23:17.887

您使用的是哪个浏览器？您可以使用 getUserMedia 而不是`input type="file"`. 此演示适用于 Chrome 桌面： http: [//jsfiddle.net/GD63T/2/](http://jsfiddle.net/GD63T/2/)但要在 Chrome for android 中工作，您必须使用`chrome://flags`

```
navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia ||     navigator.mozGetUserMedia || navigator.msGetUserMedia;

var audio = document.querySelector('audio');

if (navigator.getUserMedia) {
    navigator.getUserMedia({
        audio: true,
        video: false
    }, function (stream) {
       audio.src = window.URL.createObjectURL(stream);
    }, onFailSoHard);
} else {
    alert("sorry, not supported in your browser");
} 
```

# ios - 我可以通过按主页按钮来启动iOS应用程序吗？

> ID：14435921
> 
> 赞同：0
> 
> 时间：2013-01-21T09:43:14.670
> 
> 标签：ios, objective-c

我的问题：

我有一个 iOS 应用程序，它已最小化，并且我希望它在用户按主页按钮三次时启动（或者，例如按钮组合，如“HOME+Volume-”等）。我可以为非越狱设备制作它，只使用本机 iOS 功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:44:34.033

不。

没有越狱是不可能的，然后它必须是操作系统设置中的某种偏好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:46:22.437

像这样自定义 iOS 是不可能的。

如果没有越狱，应用程序只能通过使用来自其他应用程序的自定义 URL 方案或通过通常点击主屏幕上的来打开。要像这样打开应用程序，您必须修改操作系统，如果没有越狱，您将无法做到这一点。

不能覆盖多次按下主页按钮等标准操作系统功能，因为 Apple 确实反对修改用户与应用程序或操作系统交互方式的任何部分。

# git - 将源上所做的更改合并到我的私有分支？

> ID：14435922
> 
> 赞同：1
> 
> 时间：2013-01-21T09:43:17.297
> 
> 标签：git, merge, branch

我现在在我的私人分支上（`new01`），

将这个分支更新到主线（原点）中所做的所有更改的命令是什么？

我尝试了以下方法：

```
C:\GIT\abcd>git branch 
*new01
master
C:\GIT\abcd>git fetch origin
C:\GIT\abcd>git merge origin new01
Already up-to-date 
```

但是分支`new01`还没有随着 master 的最新变化而更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T10:21:14.473

You should go to your branch and merge like this

```
git checkout new01
get merge origin 
```

this will create a new commit into your branch new01.

# hibernate - hibernate-spatial：用于检索几何的 sql 查询

> ID：14435924
> 
> 赞同：7
> 
> 时间：2013-01-21T09:43:19.427
> 
> 标签：hibernate, geometry, postgis, hibernate-spatial

我正在使用 postgresql、hibernate-spatial 和 postgis，并且希望能够使用 SqlQuery 来检索 Geometry 对象。

但是，每当我尝试查询点、多边形或几何时，例如

```
List list = session.createSQLQuery(
    "select geomfromewkt('SRID=1;POINT(1 1)')").list(); 
```

我得到了例外：

```
Caused by: org.hibernate.MappingException: No Dialect mapping for JDBC type: 1111
    at org.hibernate.dialect.TypeNames.get(TypeNames.java:78)
    at org.hibernate.dialect.TypeNames.get(TypeNames.java:103)
    at org.hibernate.dialect.Dialect.getHibernateTypeName(Dialect.java:328)
    at org.hibernate.loader.custom.CustomLoader$Metadata.getHibernateType(CustomLoader.java:590)
    at org.hibernate.loader.custom.CustomLoader$ScalarResultColumnProcessor.performDiscovery(CustomLoader.java:516)
    at org.hibernate.loader.custom.CustomLoader.autoDiscoverTypes(CustomLoader.java:532)
    at org.hibernate.loader.Loader.getResultSet(Loader.java:1962)
    at org.hibernate.loader.Loader.doQuery(Loader.java:802)
    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:274)
    at org.hibernate.loader.Loader.doList(Loader.java:2533)
    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2276)
    at org.hibernate.loader.Loader.list(Loader.java:2271)
    at org.hibernate.loader.custom.CustomLoader.list(CustomLoader.java:316)
    at org.hibernate.impl.SessionImpl.listCustomQuery(SessionImpl.java:1842)
    at org.hibernate.impl.AbstractSessionImpl.list(AbstractSessionImpl.java:165)
    at org.hibernate.impl.SQLQueryImpl.list(SQLQueryImpl.java:157) 
```

休眠.cfg.xml：

```
<property name="dialect">org.hibernatespatial.postgis.PostgisDialect</property> 
```

这不是休眠空间产品的一部分还是我做错了什么？

谢谢，保罗。

相关库/版本：

*   hibernate-core-3.6.0.Final.jar
*   postgresql-9.0-801.jdbc4.jar
*   休眠空间postgis-1.1.1.jar
*   休眠空间 1.1.1.jar
*   postgis-jdbc-1.3.3.jar
*   jts-1.12.jar

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T23:05:38.933

我已经想通了。我需要通过标量将“GeometryUserType”应用于列。

```
SQLQuery qry = session.createSQLQuery("select geomfromewkt('SRID=1;POINT(1 1)') as geom");
qry.addScalar("geom", GeometryUserType.TYPE);
List<Geometry> list = qry.list(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-26T00:07:04.313

我正在使用 Hibernate 5.1.0 Final，

```
dao.getSession().createSQLQuery("select buffer from puntosdeinteres where puntoid = 13193")
                        .addScalar("buffer", new GeolatteGeometryType(PGGeometryTypeDescriptor.INSTANCE))
                        .uniqueResult(); 
```

它确实有效，但现在我觉得那个长篇大论不舒服。

# regex - 带有 3 个反向引用但一个可选的正则表达式

> ID：14435925
> 
> 赞同：1
> 
> 时间：2013-01-21T09:43:20.003
> 
> 标签：regex, backreference

我有一个正则表达式可以捕获三个反向引用，尽管一个（第二个）可能是`null`.

给定流动的字符串：

```
http://www.google.co.uk/url?sa=t&rct=j&q=site%3Ajonathonoat.es&source=web&cd=1&ved=0CC8QFjAA&url=http%3A%2F%2Fjonathonoat.es%2Fbritish-mozcast%2F&ei=MQj9UKejDYeS0QWruIHgDA&usg=AFQjCNHy1cDoWlIAwyj76wjiM6f2Rpd74w&bvm=bv.41248874,d.d2k,.co.uk,site%3Ajonathonoat.es&source=web,1 
```

我希望捕获 TLD（在本例中为 .co.uk）、`q`param 和`cd`param。

我正在使用以下正则表达式：

```
/.*\.google([a-z\.]*).*q=(.*[^&])?.*cd=(\d*).*/i 
```

除了第二个反向引用之外，哪个有效，包括直到参数的其他参数`cd`，我目前得到这个：

```
["http://www.google.co.uk/url?sa=t&rct=j&q=site%3Ajo…,d.d2k,.co.uk,site%3Ajonathonoat.es&source=web,1 ", ".co.uk", "site%3Ajonathonoat.es&source=web", "1", index: 0, input: "http://www.google.co.uk/url?sa=t&rct=j&q=site%3Ajo…,d.d2k,.co.uk,site%3Ajonathonoat.es&source=web,1"] 
```

第一个反向引用是正确的，`.co.uk`第三个也是正确的；它是`1`。在本例中，我希望第二个反向引用为空（或未定义或其他）或只是`q`参数`site%3Ajonathonoat.es`。它目前`source`也包含参数 ( `site%3Ajonathonoat.es&source=web`)。

任何帮助将不胜感激，谢谢！

我已经添加了[代码的 JSFiddle，在浏览器控制台中查看输出](http://jsfiddle.net/jonathonoates/NLNXj/12/)，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:50:36.070

如果否定字符类，我总是向类本身添加一个乘数：

```
/.*\.google([a-z\.]*).*q=([^&]*?)?.*cd=(\d*).*/i 
```

我还建议不要使用 * 或 +，因为它们“贪婪”，总是使用 *？或+？当您要在字符串中查找分隔符时。有关贪婪的更多信息，请查看 JFFriedls Mastering Rgeular Expressions 或简单地[在这里](http://www.regular-expressions.info/repeat.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:48:01.530

您希望中间组是：

```
q=([^&]*) 
```

这将捕获除 & 以外的字符。这也允许零个字符，因此您可以删除可选组 ( `?`)。

工作示例：[http ://rubular.com/r/AJkXxgeX5K](http://rubular.com/r/AJkXxgeX5K)

# python - django-cms 中的导入错误

> ID：14435926
> 
> 赞同：3
> 
> 时间：2013-01-21T09:43:24.513
> 
> 标签：python, django, django-cms

我是 django 的新手，在学习了一些`django`教程后，我开始使用`django-cms`（我需要使用 django-cms 开发一个 cms 站点）。

我已经编辑了设置文件并添加了所有必要的中间件和应用程序`cms`，所以一切都很好并开始开发 html 模板，但有时在我重新启动服务器并收到以下奇怪的错误之后

**错误_1**

```
Django Version: 1.4.3
Exception Type: ImportError
Exception Value:    
cannot import name plugin_pool
Exception Location: /usr/lib/python2.7/site-packages/cms/admin/__init__.py in <module>, line 7
Python Executable:  /usr/bin/python 
```

**错误_2**

```
Django Version: 1.4.3
Exception Value:    Reverse for 'pages-root' with arguments '()' and keyword arguments '{}' not found
Exception Location: /usr/lib/python2.7/site-packages/cms/models/__init__.py in new_reverse, line 67
Python Executable:  /usr/bin/python
................ 
```

这是我有时会遇到的两个错误，不知道为什么会遇到它们，因为它们突然出现，我能知道如何避免这些错误吗

一些设置如下

```
MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'cms.middleware.multilingual.MultilingualURLMiddleware', #CMS
    'cms.middleware.page.CurrentPageMiddleware', #CMS
    'cms.middleware.user.CurrentUserMiddleware', #CMS
    'cms.middleware.toolbar.ToolbarMiddleware', #CMS    
)

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'django.contrib.admin',
    'django.contrib.admindocs',
    'cms',
    'mptt',
    'menus',
    'south',
    'sekizai',
    'reversion',
    'cms.plugins.text',
    'filer',
    'easy_thumbnails',
    'cmsplugin_filer_file',
    'cmsplugin_filer_image',
    'cmsplugin_filer_teaser',
    'cms.plugins.link',
    'cms_themes',

) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-16T07:59:38.787

使用 Django 1.4.3 我遇到了同样的问题：

```
ImportError at / - cannot import name plugin_pool 
```

经过研究，我发现只需将我的 django 更新到 1.4.5 版，我的 plugin_pool 导入错误就消失了。

# sass - 在 Sass mixin 中跳过可选参数

> ID：14435927
> 
> 赞同：37
> 
> 时间：2013-01-21T09:43:30.160
> 
> 标签：sass, mixins

我有这个 mixin 来处理一个简单的 CSS3 线性渐变：

```
@mixin linear-gradient($from, $to, $dir: bottom, $dir-webkit: top, $ie-filters: false) {
    background-color: $to;
    background-image: -webkit-linear-gradient($dir-webkit, $from, $to);
    background-image: linear-gradient(to $dir, $from, $to);
    @if $ie-filters == true and $old-ie {
         filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#{ie-hex-str($from)}', endColorstr='#{ie-hex-str($to)}');
    }
} 
```

`$dir`是“方向”的缩写。

如果我需要设置`$ie-filters`“真”并且我不需要更改`$dir`/`$dir-webkit`默认值，我仍然需要重新声明它们，这显然不是很干燥和最佳，所以我必须这样做：

```
@include linear-gradient(#7a7a7a, #1a1a1a, bottom, top, true); 
```

当我只想这样做时：

```
@include linear-gradient(#7a7a7a, #1a1a1a, true); 
```

调用mixin时如何以这种方式跳过参数？

PS，如果您想知道`$dir-webkit`它适用于 Webkit 的参数，因为它仍然无法处理新的渐变语法（请参阅： http: [//generatedcontent.org/post/37949105556/updateyourcss3](http://generatedcontent.org/post/37949105556/updateyourcss3) -> **New gradient syntax**），方向需要与标准语法相反。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-01-21T11:01:07.523

从 SASS 3.1 开始，您可以传递命名参数来做到这一点：

```
@include linear-gradient($from: #7a7a7a, $to: #1a1a1a, $ie-filters: true); 
```

其余的将是默认的。

# html - FB分享无App ID

> ID：14435929
> 
> 赞同：4
> 
> 时间：2013-01-21T09:43:32.127
> 
> 标签：html, facebook-like, facebook-sharer

没有APP ID可以使用FB分享插件吗？如果我使用 HTML5 代码，那么控制台会记录一个错误`FB.getLoginStatus() called before calling FB.init()`。要像使用 HTML 5 FB 一样，是否需要拥有 APP ID？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T11:29:58.237

在这里我分享我在fb墙上分享帖子所做的事情，这样你就不需要使用appId。只需将此代码放在您希望共享链接的 HTML 页面中...

```
<a name="fb_share" type="button" href="http://www.facebook.com/sharer.php?u={$url}&media={$imgPath}&description={$desc}" class="joinFB">Share Your Advertise</a> 
```

URL参数解释如下，

u ：当用户点击您的墙贴时，您希望用户访问的网址或链接，

media ：完整的图像路径，确保图像在给定路径上可用，它将只接受一个图像

描述：您想在墙上显示的简短描述

![当您单击共享按钮时，它将看起来像这个图像](../Images/8c033438db0b1bdeab5846ff699e2543.png)

它还会要求您编写一些数据，这些数据将显示在您的帖子上方。在 url 中传递的描述将显示在图像的右侧。

请注意，我已根据需要传递了 $url,$desc,$imgPath 变量。上面的代码在 smarty-php 中，所以请根据您的要求进行更改。

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:59:28.133

是的，您需要一个应用程序 ID。您可以尝试在使用 facebook 时将自己的代码注入用户的 DOM 并在他们的 javascript 中调用函数......但我怀疑许多用户实际上会使用以这种方式工作的“应用程序”。

# ios - IOS/AFNetworking：将两个 JSON 操作排入队列，然后比较返回的 NSArrays

> ID：14435931
> 
> 赞同：2
> 
> 时间：2013-01-21T09:43:56.853
> 
> 标签：ios, objective-c, json, asynchronous, afnetworking

对于我的应用程序，我必须连接到两个返回 JSON 的 Web 服务。

我首先使用 GCD 推出了我自己的网络代码，但是看到 AFNetworking 是如何处理事情的，我决定实现它。大多数事情都很顺利，但在某些时候我正在检索两个充满对象的数组。然后使用不同的方法比较这两个数组。不知何故，实际排队要么延迟要么不工作，具体取决于我使用的代码。

使用时：

```
NSArray *operations = [NSArray arrayWithObjects:operation, operation1, nil];
        AFHTTPClient *client = [[AFHTTPClient alloc]init];

        [client enqueueBatchOfHTTPRequestOperations:operations progressBlock:nil completionBlock:^(NSArray *operations) {
            [self compareArrays:self];
        } 
```

它只是挂起。

使用时：

```
 [operation start];
    [operation1 start];
    [operation waitUntilFinished];
    [operation1 waitUntilFinished];

    [self compareArrays:self]; 
```

最后，它获取数组，但仅在 UI 形成后进行比较。

**编辑：我检查了戴夫的答案，它看起来真的很精简。我的应用程序会受益于使用`AFHTTPClient`，还是这种方法（使用`AFJSONRequestOperation`）提供相同的功能？我记得`AFHTTPClient`现在自己处理可达性（尽管您需要设置它）。我摆弄了一下，并得到了这个工作：**

```
NSOperationQueue *queue = [[NSOperationQueue alloc]init];
    WebServiceStore *wss = [WebServiceStore sharedWebServiceStore];
    self.userData = wss.userData;
    serviceURL = [NSString stringWithFormat: @"WEBSERVICE URL"];
    NSString* zoekFruit = [NSString stringWithFormat:
                           @"%@?customer=%@&gebruiker=%@&password=%@&breedte=%@&hoogte=%@&diameter=%@",
                           serviceURL,
                           self.userData.Klant,
                           self.userData.Gebruiker,
                           self.userData.Wachtwoord,
                           breedte,
                           hoogte,
                           diameter];

    NSURL *url = [NSURL URLWithString:[zoekFruit stringByAddingPercentEscapesUsingEncoding: NSUTF8StringEncoding]];

        NSURLRequest *request = [NSURLRequest requestWithURL:url];

        AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
            id results = [JSON valueForKey:@"data"];

            [results enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {

                //Initiate the BWBand

                BWBand *band = [[BWBand alloc]init];

                //Set the BWBand's properties with valueforKey (or so).                    

                [getBandenArray addObject:band];
            }];

            NSLog(@"getBandenArray: %@",getBandenArray);

        } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
            UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:@"Error retrieving Banden" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"Ok", nil];
            [alert show];
        }];

       [queue addOperation:operation]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T19:22:58.473

AFNetworking 类将允许您创建一堆操作，然后将它们全部交给处理。您添加一些代码以在每个单独请求的成功/失败和/或所有请求都已处理时发生。

这是您可能会做的事情的概述。我将把细节、实际比较和错误处理留给你想象。:)

```
-(void)fetchAllTheData {
    NSMutableArray * operations = [NSMutableArray array];
    for (NSString * url in self.urlsToFetchArray) {
        [operations addObject:[self operationToFetchSomeJSON:url]];
    }
    AFHTTPClient *client = [AFHTTPClient clientWithBaseURL:[NSURL URLWithString:[PREFS objectForKey:@"categoryUrlBase"]]];
    [client enqueueBatchOfHTTPRequestOperations:operations
                                  progressBlock:^(NSUInteger numberOfFinishedOperations, NSUInteger totalNumberOfOperations) {
                                      NSLog(@"Finished %d of %d", numberOfFinishedOperations, totalNumberOfOperations);
                                  }
                                completionBlock:^(NSArray *operations) {
                                    DLog(@"All operations finished");
                                    [[NSNotificationCenter defaultCenter] postNotificationName:@"Compare Everything" object:nil];
                                }];
}

-(AFHTTPRequestOperation *)operationToFetchSomeJSON:(NSString*)whichOne {
    NSURL * jsonURL = [NSURL URLWithString:whichOne];
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:jsonURL];
    [request setHTTPShouldHandleCookies:NO];
    [request addValue:@"application/json" forHTTPHeaderField:@"Accept"];

    AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];
    [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
        NSLog(@"My data = %@", operation.responseString); // or responseData
        // Got the data; save it off.
    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {
        DLog(@"Error downloading: %@  %@", whichOne, error);
    }];
    return operation;
} 
```

希望有帮助。

# stl-algorithm - 使用具有提升范围的变换算法

> ID：14435934
> 
> 赞同：1
> 
> 时间：2013-01-21T09:44:11.220
> 
> 标签：stl-algorithm, boost-range

嗨，我正在尝试使用 boost.range 添加两个标准向量，但我得到了一堆错误。

这有效：

```
 std::transform(a.begin(),a.end(),b.begin(),a.begin(),std::plus<double>()); 
```

这不会：

```
 boost::transform(a,b,a,std::plus<double>()); 
```

有一个错误：

```
In file included from /usr/local/include/boost/range/algorithm.hpp:80:0,
                 from /home/kirill/Dropbox/work/projects/doing/quasiclass/dev/source/simple_pcet.h:15,
                 from /home/kirill/Dropbox/work/projects/doing/quasiclass/dev/source/simple_pcet.cc:1:
/usr/local/include/boost/range/algorithm/transform.hpp: In function ‘OutputIterator boost::range_detail::transform_impl(SinglePassTraversalReadableIterator1, SinglePassTraversalReadableIterator1, SinglePassTraversalReadableIterator2, SinglePassTraversalReadableIterator2, OutputIterator, BinaryFunction) [with SinglePassTraversalReadableIterator1 = __gnu_cxx::__normal_iterator<const double*, std::vector<double> >, SinglePassTraversalReadableIterator2 = __gnu_cxx::__normal_iterator<const double*, std::vector<double> >, OutputIterator = std::vector<double>, BinaryFunction = std::plus<double>]’:
/usr/local/include/boost/range/algorithm/transform.hpp:90:33:   instantiated from ‘OutputIterator boost::range::transform(const SinglePassRange1&, const SinglePassRange2&, OutputIterator, BinaryOperation) [with SinglePassRange1 = std::vector<double>, SinglePassRange2 = std::vector<double>, OutputIterator = std::vector<double>, BinaryOperation = std::plus<double>]’
/home/kirill/Dropbox/work/projects/doing/quasiclass/dev/source/simple_pcet.cc:9:45:   instantiated from here
/usr/local/include/boost/range/algorithm/transform.hpp:64:17: error: no match for ‘operator*’ in ‘*out’
/usr/local/include/boost/range/algorithm/transform.hpp:64:17: note: candidates are:
/usr/include/c++/4.6/complex:399:5: note: template<class _Tp> std::complex<_Tp> std::operator*(const _Tp&, const std::complex<_Tp>&)
/usr/include/c++/4.6/complex:390:5: note: template<class _Tp> std::complex<_Tp> std::operator*(const std::complex<_Tp>&, const _Tp&)
/usr/include/c++/4.6/complex:381:5: note: template<class _Tp> std::complex<_Tp> std::operator*(const std::complex<_Tp>&, const std::complex<_Tp>&)
/usr/local/include/boost/range/algorithm/transform.hpp:65:17: error: no match for ‘operator++’ in ‘++out’
/usr/local/include/boost/range/algorithm/transform.hpp:65:17: note: candidate is:
/usr/local/include/boost/iterator/iterator_facade.hpp:722:3: note: template<class I, class V, class TC, class R, class D> typename boost::detail::postfix_increment_result<I, V, R, TC>::type boost::operator++(boost::iterator_facade<Derived, V, TC, R, D>&, int) 
```

这也不是：

```
 std::vector<double> c;
  boost::transform(a,b,c,std::plus<double>()); 
```

有一个错误：

```
In file included from /usr/local/include/boost/range/algorithm.hpp:80:0,
                 from /home/kirill/Dropbox/work/projects/doing/quasiclass/dev/source/simple_pcet.h:15,
                 from /home/kirill/Dropbox/work/projects/doing/quasiclass/dev/source/simple_pcet.cc:1:
/usr/local/include/boost/range/algorithm/transform.hpp: In function ‘OutputIterator boost::range_detail::transform_impl(SinglePassTraversalReadableIterator1, SinglePassTraversalReadableIterator1, SinglePassTraversalReadableIterator2, SinglePassTraversalReadableIterator2, OutputIterator, BinaryFunction) [with SinglePassTraversalReadableIterator1 = __gnu_cxx::__normal_iterator<const double*, std::vector<double> >, SinglePassTraversalReadableIterator2 = __gnu_cxx::__normal_iterator<const double*, std::vector<double> >, OutputIterator = std::vector<double>, BinaryFunction = std::plus<double>]’:
/usr/local/include/boost/range/algorithm/transform.hpp:90:33:   instantiated from ‘OutputIterator boost::range::transform(const SinglePassRange1&, const SinglePassRange2&, OutputIterator, BinaryOperation) [with SinglePassRange1 = std::vector<double>, SinglePassRange2 = std::vector<double>, OutputIterator = std::vector<double>, BinaryOperation = std::plus<double>]’
/home/kirill/Dropbox/work/projects/doing/quasiclass/dev/source/simple_pcet.cc:8:45:   instantiated from here
/usr/local/include/boost/range/algorithm/transform.hpp:64:17: error: no match for ‘operator*’ in ‘*out’
/usr/local/include/boost/range/algorithm/transform.hpp:64:17: note: candidates are:
/usr/include/c++/4.6/complex:399:5: note: template<class _Tp> std::complex<_Tp> std::operator*(const _Tp&, const std::complex<_Tp>&)
/usr/include/c++/4.6/complex:390:5: note: template<class _Tp> std::complex<_Tp> std::operator*(const std::complex<_Tp>&, const _Tp&)
/usr/include/c++/4.6/complex:381:5: note: template<class _Tp> std::complex<_Tp> std::operator*(const std::complex<_Tp>&, const std::complex<_Tp>&)
/usr/local/include/boost/range/algorithm/transform.hpp:65:17: error: no match for ‘operator++’ in ‘++out’
/usr/local/include/boost/range/algorithm/transform.hpp:65:17: note: candidate is:
/usr/local/include/boost/iterator/iterator_facade.hpp:722:3: note: template<class I, class V, class TC, class R, class D> typename boost::detail::postfix_increment_result<I, V, R, TC>::type boost::operator++(boost::iterator_facade<Derived, V, TC, R, D>&, int) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T15:55:48.760

您的问题是第三个参数 to`boost::transform`不是范围，而是用于将结果写入的（输出）迭代器。

以下代码为我编译：

```
boost::transform ( a, b, a.begin(), std::plus<double>()); 
```

# batch-file - 从外部文件批量增量

> ID：14435938
> 
> 赞同：0
> 
> 时间：2013-01-21T09:44:24.107
> 
> 标签：batch-file, cmd

我有一个在 SVN 中创建新标签并添加一些文件的脚本。我想自动化这个任务，所以我想找到一些方法来自动增加标签名称，从 1.0 到 X.0。

我想到了一个 conf 文件，它包含“1.0”作为第一个版本号，并且在每次调用脚本时都会被覆盖。但不确定我是否可以从文件中获取“1.0”值，然后在我的脚本中对其进行增量。

任何帮助将不胜感激。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T12:00:01.930

使用 autoprops 查看 Subversion 中的关键字。

首先，设置颠覆以尊重关键字扩展

```
enable-auto-props = yes

[auto-props]
version.txt = svn:keywords=Revision 
```

然后，设置一个简单的文件，让我们`version.txt`用 $revision$ 关键字和一些随机内容来调用它。

```
$revision$
Random content 
```

然后，在您的批处理文件中，使用新的随机内容重新创建 version.txt 文件

```
echo $revision$ >version.txt
echo %random% %date% %time% >>version.txt 
```

并在每次运行批处理文件时签入这个新文件，因此它将变为

```
$revision 32 $
4214 Mon 21/01/2013 15:53:27,62 
```

这样，subversion 将保留批处理文件所有运行的准确版本号，即使在多个客户端和同时运行也是如此。

然后，您可以从 version.txt 中提取并使用修订号，代码类似于

```
for /f "tokens=1,2" %%a in (version.txt) do (
   if %%a==$revision (
     echo Revision number is %%b
     echo do something with %%b, create %%b tag or whatever
   )
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T14:13:30.683

不要创建种子配置文件。相反，如果文件不存在，则让批处理脚本默认为 1.0。

```
@echo off
setlocal
set "conf=version.conf"
if not exist "%conf%" (set version=1.0) else (
  for /f "usebackq delims=." %%N in ("%conf%") do set /a version=%%N+1
)
set "version=%version%.0"
(echo %version%)>"%conf%" 
```

我假设你永远不会并行运行这个过程多次 - 如果你并行运行它可能会失败。可以进行修改以锁定 conf 文件，以便您可以在需要时并行运行。[如果给定的文件或目录被锁定，它是否被进程使用，](https://stackoverflow.com/q/10518151/1012053)请参阅如何在命令行中签入的公认答案？了解更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T09:52:03.377

由于您没有说要使用哪种语言，因此只能给出一般性说明：

当然可以维护一个包含 ' *dottet version number ' 的小型 '* *version* ' 文件，例如可能。该文件内容可以被任何进程读取。您应该实现一些方法来将该内容拆分为其数字标记（主要和次要版本等）。这些数值可以由您喜欢使用的任何数学函数处理。例如，您可以增加它们。另一种方法是一些“内*爆*”函数，它采用数字标记并再次创建一个“*点版本号*”（现在可能*`0.2.6`**`0.2.7`...) 最后您可以将该信息写回文件中。允许一个控制版本的哪一部分应该递增的参数当然是有意义的。***

 ***这种方案并不真正有效，但通常就足够了。

请注意，只有当您可以保证访问该版本文件始终只有一个进程时，这种方法才有效。否则，多个进程可能会覆盖彼此的结果，这肯定会导致问题。

作为替代方案，也许是更优雅的替代方案，您可以考虑将 subversion 存储库本身视为版本号的种子存储：而不是读取特殊文件内容（如果该文件被删除或发生其他事情怎么办？）颠覆里面的标签文件夹。它应该包含所有以前标记的版本。这正是您想要的信息。取所有版本号，对它们进行排序，取最高的一个并按上述方法处理。***

# heroku - 公钥 - 应用程序错误

> ID：14435939
> 
> 赞同：2
> 
> 时间：2013-01-21T09:44:24.230
> 
> 标签：heroku, ssh, key, public

嘿，我是编程`Facebook`应用程序的新手，我想开始，`Heroku`但开始使用它时遇到了很大的问题。

在我登录控制台后，系统会询问我是否要创建一个`SSH public key`. 当我输入 yes 时，我收到消息，它正在生成一个到`C:/Users/Test/.ssh/id_rsa.pub`.

然后它说

```
Uploading SSH public key C:/Users/Test/.ssh/id_rsa.pub.. - failed.
! Application error. 
```

有谁能够帮我？:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-11T18:34:30.510

在这里我有同样的问题......

我找到的解决方案是：

1) 使用任何 ext 编辑器打开文件“C:/Users/Test/.ssh/id_rsa.pub”。

2）复制内容，从“ssh-rsa”开始直到“==”。

3) 转到[https://dashboard.heroku.com/account](https://dashboard.heroku.com/account)

4）将此复制到“添加新的ssh密钥”，按添加键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T09:57:52.263

我遇到了同样的错误，您可能没有运行**..\Git\bin中的****ssh-keygen.exe**，那么您必须输入 ssh 密钥的地址，在您的情况下，它似乎是**C:/Users/Test/。 ssh/id_rsa**之后你应该登录。

# r - 如何在折线图ggplot2 R上反转坐标

> ID：14435941
> 
> 赞同：2
> 
> 时间：2013-01-21T09:44:33.263
> 
> 标签：r, ggplot2

我正在做一个数据可视化项目，正在制作一些折线图。这是我的数据集：

```
groupA <- read.csv("afcongroupA.csv", header=T, row.names=NULL)
groupA
    Date               Team Position
1   1/12       South Africa       56
2   1/12             Angola       85
3   1/12            Morocco       61
4   1/12 Cape Verde Islands       58
5   4/12       South Africa       71
6   4/12             Angola       78
7   4/12            Morocco       62
8   4/12 Cape Verde Islands       76
9   8/12       South Africa       67
10  8/12             Angola       85
11  8/12            Morocco       68
12  8/12 Cape Verde Islands       78
13 12/12       South Africa       87
14 12/12             Angola       84
15 12/12            Morocco       72
16 12/12 Cape Verde Islands       69 
```

然后我将它们绘制在折线图上，以显示排名下降的上升趋势：

```
groupA$Date <- factor(groupA$Date, levels=groupA$Date[!duplicated(groupA$Date)])
ggplot(groupA, aes(x=Date, y=Position, colour=Team, group=Team)) + geom_line() 
```

我想要做的是反转 y 轴，使最大的数字位于底部。我尝试了这段代码：

```
groupA <- coord_flip() + scale_x_reverse() 
```

但我收到此错误消息：

```
Error in coord_flip() + scale_x_reverse() : 
```

二元运算符的非数字参数

我在运行 OS X 的 Mac 上使用 R 2.15.2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T10:13:30.817

由于您的专栏`Date`是一个因素，因此`scale_x_reverse()`将无法正常工作。一种解决方案是在数据框中订购您的因素水平

```
groupA$Date <- factor(groupA$Date, levels=rev(unique(groupA$Date))) 
```

然后只需使用您的代码来制作绘图和翻转轴。

```
ggplot(groupA, aes(x=Date, y=Position, colour=Team, group=Team)) +
      geom_line()+coord_flip() 
```

# java - 计算两个 UML 模型之间的差异

> ID：14435944
> 
> 赞同：1
> 
> 时间：2013-01-21T09:44:36.290
> 
> 标签：java, uml

我想知道一些关于如何计算（设置？）两个 UML 模型之间差异的参考和想法。基本上，我有一个系统（以 UML/xmi 表示），并且可以对这个系统应用几种模式（也以 UML/xmi 表示）。

例如，我们可以将模式 a 应用于将模式 b 应用于系统的结果 - `Pa(Pb(S))`。然后我想计算`dif(Pb, S)`然后`dif(Pa, S)`，因为在应用模式之后，合并系统可以被视为原始系统。

我正在寻找参考资料（无论是否在文献中）和算法，因为我不想重新发明轮子。最后我会用 Java 编写代码。

提前致谢，

佩德罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:59:50.637

使用[Eclipse EMF Compare](http://www.eclipse.org/emf/compare/)，您可以比较两个不同的 EMF 模型实例。由于 UML 在 Eclipse 中表示为 EMF 模型实例，因此您可以使用它来比较您的 UML 模型。只需安装 EMF Compare，在包资源管理器（或您使用的任何视图）中标记您的 UML 模型，然后从上下文菜单中选择 Compare -> With each other...。比较编辑器可让您将差异保存为 .emfdiff 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T10:03:06.763

我不能为您指出确切的文献，但是如果您不/不能选择上面的 EMF 解决方案，请考虑一下：UML 模型是图形（我需要一些思考才能弄清楚边和顶点是什么，但不管怎么说）。要获得差异，您需要顶点集和边集的[对称差异。](http://en.wikipedia.org/wiki/Symmetric_difference)这样，您就可以获得仅在一张图中的所有内容。如果您使用应用的模式计算原始模型和模型之间的对称差异，那将准确地告诉您该模式对模型的作用。

# iphone - 在 Box2D 游戏中以特定角度投掷 b2body 的问题

> ID：14435949
> 
> 赞同：0
> 
> 时间：2013-01-21T09:44:45.540
> 
> 标签：iphone, box2d, box2d-iphone

在我的游戏中，我有一个 Ccsprite 用于箭头，一个 b2body 用于球......我试图将球扔向我的箭头精灵所指向的方向。这是我的代码...我正在计算箭头精灵的旋转，然后以该角度向球施加脉冲...

```
float totalRotation = arrow.rotation ;

ballBody->ApplyLinearImpulse(b2Vec2(10.0f+cos(totalRotation)*25.0f,10.0f+sin(totalRotation)*25.0f), eggBody->GetWorldCenter()); 
```

但是，这不完全正常......球被扔向不正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T13:27:58.460

`rotation`CCNode（以及继承自 CCNode 的 CCSprite）的属性以度为单位，顺时针旋转为正。Box2D 世界使用以弧度为单位的角度，逆时针旋转为正，这对于笛卡尔坐标系来说更为传统。为了向 Box2D 函数提供正确的角度，您必须进行转换。在 Cocos2D 中，转换是这样的：

`float angle = - 1 * CC_DEGREES_TO_RADIANS(totalRotation);`

宏将 totalRotation 从度数转换为弧度数，然后乘以 -1，因为 Box2D 测量的是逆时针方向的正角度，这与 CCNode 旋转相反。

# sharepoint - 使用递归以编程方式获取文档库的子项

> ID：14435950
> 
> 赞同：1
> 
> 时间：2013-01-21T09:44:47.573
> 
> 标签：sharepoint, recursion, sharepoint-2010, sharepointdocumentlibrary

我需要递归文档库的内容并使用 MVC 在网页上显示它们。但是，在尝试运行我的代码时出现以下错误：“**集合尚未初始化。尚未请求或未执行请求。可能需要显式请求**。”

任何帮助，将不胜感激！

这是我的代码：

```
public class HomeController : Controller
    {
        public ActionResult Index()
        {
            DefaultModel model = new DefaultModel();

            using (ClientContext context = new ClientContext("MySPSite"))
            {
                List list = context.Web.Lists.GetByTitle("DocumentLibrary");
                Folder rootFolder = list.RootFolder;

                IEnumerable<SharePointItemBaseModel> items = ProcessFolder(rootFolder);
                model.items.AddRange(items);
            }

            return View(model);
        }

        public IEnumerable<SharePointItemBaseModel> ProcessFolder(Folder folder)
        {
            List<SharePointItemBaseModel> listItems = new List<SharePointItemBaseModel>();
            foreach (Folder childFolder in folder.Folders)
            {
                FolderModel folderModel = new FolderModel();
                IEnumerable<SharePointItemBaseModel> childFolders = ProcessFolder(childFolder,context);
                folderModel.Items.AddRange(childFolders);
                listItems.Add(folderModel);
            }

            foreach (Microsoft.SharePoint.Client.File file in folder.Files)
            {
                DocumentModel documentModel = new DocumentModel();
                documentModel.Name = file.Title;
                documentModel.modifiedBy = file.ModifiedBy.ToString();
                listItems.Add(documentModel);
            }

            return listItems;
        }

        public ActionResult About()
        {
            return View();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T10:33:08.880

我设法自己解决了这个问题。

在我刚刚使用的递归方法中

上下文.加载（文件夹。文件夹）；

和

上下文.加载（文件夹.文件）；

这初始化了集合，允许我在我的 foreach 循环中使用它

# c# - 如何从字符串中找到最后一个字母的位置？

> ID：14435953
> 
> 赞同：-3
> 
> 时间：2013-01-21T09:44:57.770
> 
> 标签：c#, asp.net, special-characters

嗨，我有一个混合类型的字符串。我想从仅使用单词结尾的单词中删除特殊符号。例如。

```
 "Kapil-Kumar?hasija-- 
```

我需要删除在我的句子之后出现的特殊符号。所以为此我需要找到我最后一个字母的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:57:31.917

你可以使用这个：

```
string s = "Kapil-Kumar?hasija--";

while (s.Length > 0 && !Char.IsLetter(s[s.Length-1]))
  s = s.Substring(0, s.Length-1);

Console.WriteLine(s); // prints "Kapil-Kumar?hasija" 
```

如果最后也允许使用数字，请使用`Char.IsLetterOrDigit`代替`Char.IsLetter`.

# json - 根据用户设置将 JSON 日期解析为 NSDate

> ID：14435954
> 
> 赞同：1
> 
> 时间：2013-01-21T09:45:02.670
> 
> 标签：json, nsdate, nsdateformatter

我在转换原始 JSON 字符串日期时遇到问题：

"created_at" = "2012-12-22T21:39:22Z";

进入 NSDate。

这是我目前的类别：

```
- (NSDate*)dateWithJSONString
{
[NSDateFormatter setDefaultFormatterBehavior:NSDateFormatterBehavior10_4];
 NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss'Z'"];
[dateFormatter setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0]];
[dateFormatter setCalendar:[[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar]];
NSDate *date = [[NSDate alloc] init];
date = [dateFormatter dateFromString:self];
return date;        
} 
```

问题是这适用于我 95% 的情况，但是如果某些用户在日期和时间设置中使用 AM/PM 而不是 24H 并结合自定义国际设置，则日期不是从 json 字符串创建的。

我阅读了此[讨论](https://stackoverflow.com/questions/399527/parsing-unsupported-date-formats-in-via-cocoas-nsdate)，但找不到与所有国际用户和设置一起工作的好方法。

例如，我添加了这个：

```
[dateFormatter setLocale:[NSLocale currentLocale]]; 
```

但它什么也没改变。如果我将 iPhone 设置为 AM/PM 而不是 24H，则不会创建 NSDate。

AM/PM NSDate 架构：2013-01-21 07:12:43 AM +0000

24H NSDate 架构：2013-01-21 07:12:43 +0000

我错过了什么 ？日期格式有什么要更新的吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-06-18T12:44:09.863

您只需要设置正确的 dateFormat，其余代码都是正确的。

```
[dateFormatter setDateFormat:@"yyyy-MM-dd'T'HH:mm:ssz"]; 
```

dateString 中的字符`Z`是 ISO8601 定义的有效日期格式，它表示日期字符串在 UTC 时区。因此，您无需将时区设置为格式化程序。Formatter 可以从 character 识别时区`Z`。因此，如果忽略它，则时区将不匹配，除非为 dateFormatter 指定时区。

如果您的 dateString 不统一，请对 dateFormat 进行回退检查。检查转换后的日期是否为零，如果为零，则使用回退 dateFormat。

除非日期字符串和系统日历的日历类型发生变化，否则也无需将日历设置为 dateFormatter。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-02-23T23:58:46.403

我试图做同样的事情，但在我的情况下，JSON 日期还包括毫秒，该日期来自 MongoDB。

这是您有毫秒时的格式片段（例如`2014-02-27T09:30:00.000Z`）

```
[dateFormatter setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss.SSSz"]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T10:05:05.967

请使用下面的代码，这对我来说是完美的。

```
 NSString* strDate = [jsonObj objectForKey:@"created_at"];
 NSDate *date = [self dateWithJSONString:strDate]; 
```

* * *

```
- (NSDate*)dateWithJSONString:(NSString*)dateStr
{
    // Convert string to date object
    NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
    [dateFormat setDateFormat:@"yyyy'-'MM'-'dd'T'HH':'mm':'ss'Z'"];
    NSDate *date = [dateFormat dateFromString:dateStr];

    // This is for check the output
    // Convert date object to desired output format
    [dateFormat setDateFormat:@"yyyy'-'MM'-'dd'T'HH':'mm':'ss'Z'"]; // Here you can change your require output date format EX. @"EEE, MMM d YYYY"
    dateStr = [dateFormat stringFromDate:date];
    NSLog(@"Date -- %@",dateStr);

    return date;
} 
```

[日期格式问题](https://stackoverflow.com/questions/6441428/date-format-problem/6441612#6441612)

# javascript - 将 appBar 按钮的标签放在图标图像旁边而不是图标图像下方

> ID：14435956
> 
> 赞同：1
> 
> 时间：2013-01-21T09:45:17.167
> 
> 标签：javascript, windows-8, appbar

我使用 javaScript 为我的 windows8 应用程序创建了一个 appbar。

我想将 appbar 按钮的标签放在 appbar 图标旁边，而不是 appbar 图标下方。

谁能告诉我这是否可能。如果是，如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T07:35:54.540

首先，我对以这种方式更改默认行为有点谨慎，因为它会偏离用户对平台上大多数其他应用程序的体验。也就是说，我认为它应该是可行的，至少以一种方式。

以下是一些需要考虑的方法，并不是我认为任何“最佳”方法，但它们可能是您开始的地方：

查看生成对象的结构（您可以在 Blend 中使用交互模式），您可以看到命令是两个堆叠的跨度标签（一个包含图标和圆圈，另一个包含命令文本）。从[WinJS.UI.AppBar](http://msdn.microsoft.com/en-us/library/windows/apps/br229670%28v=vs.85%29.aspx)文档，您可以设置这些 span 的样式，但由于 span 是一个内联元素，我不相信您可以垂直移动它以使其位于按钮旁边。你可以玩`margin-right`一下`margin-left`。

现在另一种选择是尝试重写生成的 DOM，以便您将表示作为 span 标签丢弃并自己构建一些东西，但这是很多未知脆弱性的工作。

第三种选择大致相当于修改 DOM 的设计时。不要使用 AppBar 的默认行为，而是创建自定义布局。例如，以下标记（不是生产质量的，具有内联样式和所有 :)）会生成随后的图像：

```
 <div id="appbar" data-win-control="WinJS.UI.AppBar" data-win-options="{layout: 'custom'}">
    <button data-win-control="WinJS.UI.AppBarCommand" data-win-options="{id:'cmd',  icon:'placeholder'}" type="button"></button>
    <span style="margin-left: -28px; font-size: 0.8em">Command 1</span>
    <button data-win-control="WinJS.UI.AppBarCommand" data-win-options="{id:'cmd',  icon:'placeholder'}" type="button"></button>
    <span style="margin-left: -28px; font-size: 0.8em">Command 2</span>
</div> 
```

![在此处输入图像描述](../Images/8753e91b5e19de2c665c2fa3fb08a835.png)

Windows 开发中心上有一个[AppBar 示例](http://code.msdn.microsoft.com/windowsapps/App-bar-sample-a57eeae9/)，如果您采用自定义路线，它也可能对您有所帮助。

# magento - 如何在 Magento 中明智地显示运输方式客户群？

> ID：14435958
> 
> 赞同：1
> 
> 时间：2013-01-21T09:45:29.970
> 
> 标签：magento, paypal, shipping

我需要显示批发商的付款方式 -> “支票/汇票”。和零售商->“贝宝”。

和运输方式也是批发商-> 免费。和零售商-> 表率。

请帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:58:24.927

更好的选择，您可以在管理面板中创建购物车价格规则。

小路 ：

```
Admin => Promotions => Shopping Cart Price Rules => Add New Rule 
```

为您的条件自定义和设置条件。

# r - 导出轮廓线以通过 WMS 为它们提供服务

> ID：14435963
> 
> 赞同：3
> 
> 时间：2013-01-21T09:45:41.923
> 
> 标签：r, mapping, wms

我正在尝试进行自动映射。我想要一张不确定性地图，这些不确定性由等值线显示。我想导出这些等值线以及与它们关联的值，然后通过 web 地图服务显示它们。可能吗？通过以下代码，您可以生成轮廓线

```
require(gstat)
require(lattice)
data(meuse)
data(meuse.grid)
coordinates(meuse) = ~x+y
gridded(meuse.grid) = ~x+y
m <- vgm(.59, "Sph", 874, .04)
# ordinary kriging:
x <- krige(log(zinc)~1, meuse, meuse.grid, model = m)
l=as.data.frame(x)
contourplot(var1.var ~ x+y,data=l,cuts=10) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T10:35:05.347

这不是您问题的直接答案，但也许它可以为您指明正确的方向：

你可以从你的等高线图中生成一个对象

```
CP<- contourplot(var1.var ~ x+y,data=l,cuts=10) 
```

并尝试看看它的结构

```
fix(CP) 
```

有关等值线的数据存储在这里：

```
x <- CP$panel.args.common[1]$x
y <- CP$panel.args.common[2]$y
z <- CP$panel.args.common[3]$z 
```

但我现在无法弄清楚如何提取它。也许这可以帮助你一点。

# jquery - 过滤2个相同类别的项目（jquery）

> ID：14435966
> 
> 赞同：0
> 
> 时间：2013-01-21T09:45:50.597
> 
> 标签：jquery, select, filter, categories

这就是我想问的问题： [http ://berckmans-designs.nl/filternew/index1.php](http://berckmans-designs.nl/filternew/index1.php)

我在此处的一些帮助下制作了这个过滤系统，但问题是：我无法从同一类别中选择 2 个项目。（假设我从“kleur”类别中选择“wit”和“zwart”）

希望你们能帮助我完成这项工作。

Javascript：

```
 $(document).ready(function() {
    $(".series-selector-items > li").click(function() {
        $(this).toggleClass('selected');
        filterItems();
    });
});

function filterItems() {
    var classSelectors = $(".selected").map(function() {
        var cls = this.id.split('-');
        return '.'+cls.splice(2).join('-');
    }).toArray();

    //if no filter, show all
    if(!classSelectors.length){
        $('#items > li').show('slow');
    }

    $('#items > li').filter(classSelectors.join('')).show('slow');

    $('#items > li').not(function() {
        var self = this;
        var showThis = true;
        $.each(classSelectors, function(i,value) {
            if(!$(self).is(value)) {
                showThis = false;
            }
        });
        return showThis;
    }).hide('slow');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T12:15:07.240

你能行的。检查这是否对您有帮助。

```
$(function() {
$(".series-selector-items > li").click(function() {
    $(this).toggleClass('selected');
    filterItems();
});
});

function filterItems() {
var classSelectors = $(".selected").map(function() {
    var cls = this.id.split('-');
    return '.'+cls.splice(2).join('-');
}).toArray();

if(!classSelectors.length){
    $('#items > li').show('slow');
}
else {
$('#items > li').filter(classSelectors.join(', ')).show('slow');
$("#items > li").filter(":not(" + classSelectors.join(', ') + ")").hide('slow');
}
} 
```

你可以在这里看到演示：http: [//jsfiddle.net/pitchaip/huhbJ/1/](http://jsfiddle.net/pitchaip/huhbJ/1/)

# jenkins - 使用 Jenkins 进行单元测试用例自动化

> ID：14435975
> 
> 赞同：2
> 
> 时间：2013-01-21T09:47:00.083
> 
> 标签：jenkins

我需要在 Jenkins 上为非 Java 项目自动化单元测试。

我创建了一个从 TFS 提取代码并以给定时间间隔成功生成构建的作业。

现在，我如何告诉 Jenkins 生成单元测试用例？

我是否需要编写任何脚本，例如 ANT.

谁能指导我需要遵循的步骤？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T10:09:18.087

我假设您对“触发”过程感到满意，所以我不会考虑

剩下的

1) 在 Build 部分中添加一个步骤，该步骤将运行单元测试并以构建后操作之一可以理解的形式输出。例如在python中

python setup.py nosetests --with-xunit

2) 添加构建后操作以发布结果。例如，使用上面的命令添加“发布 junit 结果报告”作为构建后操作，并将“测试报告 XMLs”配置为“**/nosetests.xml”

有很多方法可以做到这一点，但基本的两个步骤是使单元测试运行并生成一些报告生成器之一可以理解的输出。然后配置报告生成器

# asp.net - 如何在 VS.NET 中使用 Pre 或 Post 构建事件将 xml 文件添加到程序集中

> ID：14435981
> 
> 赞同：0
> 
> 时间：2013-01-21T09:47:20.767
> 
> 标签：asp.net, visual-studio, build, embedded-resource

我有一个 Web 应用程序项目，其中一个文件夹中存在一些 .xml 文件，即 \ProjectXMen\xml\files。我不能将此文件夹包含到项目中，因为这些文件是动态生成的。所以我需要找到一种方法可以使这些文件生成资源（.resx）文件。我想我们可以使用 vs.net IDE 的 Pre 或 Post 构建事件做一些事情。

现在我想将这些 xml 文件转换为资源 .resx 文件，最后将它们添加到项目程序集中。

请建议。

# c# - 无法使用 naudio 播放 adpcm 音频文件

> ID：14435986
> 
> 赞同：1
> 
> 时间：2013-01-21T09:47:32.347
> 
> 标签：c#, audio, naudio, adpcm

我尝试用 NAudio 播放 adpcm alaw（我认为它的 g.723 adpcm 40）文件没有成功。

该文件是立体声采样率为 8000，位深为 16。

当我尝试使用 2 个通道创建 adpcm alaw 格式时，出现 acm not possible 错误。（错误是因为我尝试创建一个 SampleCannel 和 SampleCannel 类强制获取 pcm 或 ieefloat。所以我调用 CreatePcmFormat）。

因此我用 1 个频道创建它，然后我可以播放它，但我听到噪音。

vlc 可以成功播放文件。

# uml - 如何在 UML 图中包含比较器类

> ID：14435987
> 
> 赞同：2
> 
> 时间：2013-01-21T09:47:45.707
> 
> 标签：uml

在为我的软件设计考试学习时，出现了一些问题，在到处寻找之后，我仍然找不到答案，所以就在这里。

显示另一个类的方法使用的比较器类对某些东西进行排序的正确方法是什么？

提前谢谢，如果我不是太具体，我很抱歉，因为我是新来的。

我的代码中使用比较器的部分是这样的

```
public class Jukebox {

List<Song> jukebox= new ArrayList<>();

    public Song getSong(int index){
        return jukebox.get(index) ;
    }
    public List<Song> playTitulo(){
        Collections.sort(jukebox, new ComparaTitle() );
        return jukebox;
    }
} 
```

Song 类有几个属性，例如标题或持续时间，我对它们中的每一个都有一个不同的比较器类，看起来像这样

```
public class CompareTitle implements Comparator<Song>{
    @Override
    public int compare (Cancion c1, Cancion c2){
        return ( c1.getTitulo().compareToIgnoreCase(c2.getTitle()));
    }    
} 
```

我认为这么多代码应该足以了解我在做什么，因为我不想让仍在学习的人的练习让你感到厌烦，但如果你觉得还有什么遗漏，请告诉我，我会立即将其包括在内.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:30:30.040

解决了，看来我要找的是老师不知何故在课堂上忘记提及的<>关系，抱歉打扰。

# mysql - MySQL 在这里不支持单行注释。原因是什么？

> ID：14435989
> 
> 赞同：7
> 
> 时间：2013-01-21T09:48:05.627
> 
> 标签：mysql, command-line, comments

这是我使用单行注释（使用**--**）时得到的结果：

> ERROR 1064 (42000)：您的 SQL 语法有错误

实际上，我在一个程序中使用这些注释来显示一行的确切作用。然后我直接在 MySQL 命令行检查，但我得到了这个错误：

```
mysql> select 1;--test select
+---+
| 1 |
+---+
| 1 |
+---+
1 row in set (0.00 sec)

    -> ;
check the manual that corresponds to your MySQL server version for the right syntax to use near '--test select' at line 1 
```

我需要配置一个文件来支持这个吗？如果我使用多行注释（使用`/* Something */`），它工作正常。

我用谷歌搜索并浏览了 MySQL 文档。因为它向我展示了它支持（**--**）。可能是什么错误？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-21T09:55:15.537

来自 MySQL 文档：

> 从“--”序列到行尾。在 MySQL 中，“--”（双破折号）注释样式要求第二个破折号后跟至少一个空格或控制字符（例如空格、制表符、换行符等）。

之后需要一些空格字符`--`，例如：

```
mysql> select 1;-- test select 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-21T09:55:18.633

您的语法是错误的 - 请阅读[注释语法](http://dev.mysql.com/doc/refman/5.1/en/comments.html)。

只需在之后添加一个空格`--`：

```
mysql> select 1; -- test select
+---+
| 1 |
+---+
| 1 |
+---+
1 row in set (0.00 sec) 
```

# c# - 按图像列对 DevExpress XtraGrid 进行排序

> ID：14435995
> 
> 赞同：0
> 
> 时间：2013-01-21T09:48:32.870
> 
> 标签：c#, devexpress

这项任务似乎很容易。

我想允许 XtraGrid 按图像列排序（图像表示状态）

根据手册，您只需将列排序模式设置为自定义并在 CustomColumnSort Eventhandler 中放置一些代码。

在这里它不起作用，事件处理程序从未被调用。

我明确地尝试了以下内容：

```
gridViewLeftGrid.Columns["ImageColumnName"].OptionsColumn.AllowSort = DevExpress.Utils.DefaultBoolean.True;
gridView.Columns["ImageColumnName"].SortMode = DevExpress.XtraGrid.ColumnSortMode.Custom;
gridView.CustomColumnSort += gridView_CustomColumnSort;
gridView.CustomColumnGroup += grid_CustomColumnGroup; 

void gridView_CustomColumnSort(object sender, DevExpress.XtraGrid.Views.Base.CustomColumnSortEventArgs e)
{
    throw new NotImplementedException();
} 
```

但仍然 - 从未达到 gridView_CustomColumnSort 中的断点。

我看到的唯一影响是，现在每次加载或更新网格时都会引发错误`DevExpress.Data.Storage.DataStorageObjectComparer.CompareRecordsCode`：

> “至少一个对象应该实现 ICompare”

任何人都可以帮助缺少什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T10:24:37.313

> Your data source should implement the **IXtraSortable** interface in order to implement the desired sorting

Check [Devex Support Question](http://www.devexpress.com/Support/Center/Question/Details/A360)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-21T10:51:35.137

我建议您[仔细阅读 ColumnView.CustomColumnSort 事件](http://documentation.devexpress.com/#windowsforms/DevExpressXtraGridViewsBaseColumnView_CustomColumnSorttopic)文档并查看以下几行：

自定义比较的结果应设置为 CustomColumnSortEventArgs.Result 参数，如下所示：

*   如果数据按升序排序时第一行应位于第二行上方，则将 Result 设置为 -1。当数据按降序排序时，第一行将位于第二行之下。
*   如果数据按升序排序时第一行应位于第二行下方，请将 Result 设置为 1。当数据按降序排序时，第一行将位于第二行之上。
*   将 Result 设置为 0 以指示行相等。在这种情况下，行将根据它们在数据源中的索引在网格内排列。

**注意：**如果当前比较操作是 ，则应
将[CustomColumnSortEventArgs.Handled](http://documentation.devexpress.com/windowsforms/clsDevExpressXtraGridViewsBaseCustomColumnSortEventArgstopic.aspx)参数设置为。您可以将此参数设置为 false 以在事件处理程序完成后调用默认比较机制。在这种情况下，自定义比较操作的结果将被忽略。`true``handled`

检查示例：

```
protected void grid_CustomColumnSort
(object sender, DevExpress.Web.ASPxGridView.CustomColumnSortEventArgs e) {
    if (e.Column.FieldName == "Country") {
        e.Handled = true;
        string s1 = e.Value1.ToString(), s2 = e.Value2.ToString();
        if (s1.Length > s2.Length)
            e.Result = 1;
        else
            if (s1.Length == s2.Length)
                e.Result = Comparer.Default.Compare(s1, s2);
            else
                e.Result = -1;
    }
} 
```

您也可以在这样的事件上实现比较代码：

```
if (e.Column.FieldName == "Importance")
{
     int n1 = (int)gridControl1.GetCellValue(e.ListSourceRowIndex1, "Rank");
     int n2 = (int)gridControl1.GetCellValue(e.ListSourceRowIndex2, "Rank");

     e.Result = Comparer<int>.Default.Compare(n1, n2); /// comparator here, that set the e.result

     e.Handled = true;
} 
```

参考：
[如何：实现自定义排序](http://documentation.devexpress.com/#WindowsForms/CustomDocument3071)
[DXGrid CustomColumnSort 无法正确排序](http://www.devexpress.com/Support/Center/p/B220981.aspx)
[CustomColumnSort 无法正常工作](http://www.devexpress.com/Support/Center/p/DB41648.aspx)
[ASPxGridView - 如何对组进行排序](http://www.devexpress.com/Support/Center/Question/Details/K18508)- 它与 asp.net 网格有关，但可能会有所帮助

[按照这篇知识库文章 -如何实现自定义排序](http://www.devexpress.com/Support/Center/e/E963.aspx)，检查引发自定义排序事件的代码片段。希望这有帮助：

```
public partial class GridCustomSortTest : Form
{
    public GridCustomSortTest()
    {
        InitializeComponent();
    }

    private void GridCustomSortTest_Load(object sender, EventArgs e)
    {
        string[] months = new string[] { "January", "February", "March", 
            "April", "May", "June", "July", "August", "September", 
            "October", "November", "December" };

        grid.DataSource = months;
        grid.RefreshDataSource();
        gridView1.Columns[0].SortMode = DevExpress.XtraGrid.ColumnSortMode.Custom;
        gridView1.CustomColumnSort += new DevExpress.XtraGrid.Views.Base.CustomColumnSortEventHandler(gridView1_CustomColumnSort);

    }

    void gridView1_CustomColumnSort(object sender, DevExpress.XtraGrid.Views.Base.CustomColumnSortEventArgs e)
    {
        e.Result = Comparer<int>.Default.Compare(e.ListSourceRowIndex1,
           e.ListSourceRowIndex2);

        e.Handled = true;
    }
} 
```

# google-api - 查询 Picasa 网络相册中的特定 PhotoID 以检查是否存在

> ID：14435999
> 
> 赞同：2
> 
> 时间：2013-01-21T09:48:44.873
> 
> 标签：google-api, picasa

我有一个 PhotoID 列表以及显然需要的用户 ID，因为 PhotoID 不是全球唯一的，我正在尝试获取照片列表以测试照片是否仍然可以访问。

到目前为止我发现的最接近的是这里[https://groups.google.com/forum/?fromgroups=#!searchin/google-picasa-data-api/photos](https://groups.google.com/forum/?fromgroups=#!searchin/google-picasa-data-api/photos) $20by$20id/google-picasa-data-api /OzLyJOVpd4M/7xiSPB4Tg9YJ 提到以下查询应该让我到达那里：

```
http://picasaweb.google.com/data/feed/api/user/default/?kind=photo&v=2&fields=entry[gphoto:id=1234 or gphoto:id=4567]&prettyprint=true 
```

但是，这似乎不起作用，即使与我知道存在的照片一起使用，我也会得到：

```
<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns='http://www.w3.org/2005/Atom' xmlns:app='http://www.w3.org/2007/app' xmlns:gphoto='http://schemas.google.com/photos/2007' xmlns:media='http://search.yahoo.com/mrss/' xmlns:gd='http://schemas.google.com/g/2005'/> 
```

或者，如果我指定了一个有效的 access_token，我会得到以下信息，尽管该令牌对于未列出的照片的更多基本查询工作正常。

```
Token invalid - AuthSub token has wrong scope 
```

**更新**

我已经设法使用以下方法查询单个 gphoto:id 工作：

```
https://picasaweb.google.com/data/feed/api/user/default?kind=photo&v=2.0&fields=entry[gphoto:id=5833637579580309538] 
```

但是，一旦我尝试使用`||`（如下所示），我就会收到一个错误，例如：

```
Invalid selector expression at position 35: no viable alternative at character '|' 
```

如果我使用 Google API 文档中提到的“或”，它只会忽略除第一个之外的所有内容，`gphoto:id`只返回 1 行。

**更新 2**

实际上，它看起来像以下确实有效，但并非适用于所有照片：

```
https://picasaweb.google.com/data/feed/api/user/default?kind=photo&v=2.0&fields=entry[gphoto:id=5827988830283069682%20or%20gphoto:id=5812362364496750642](gphoto:id)&prettyprint=true 
```

是否有某种许可可以防止某些照片被直接查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:54:05.103

你需要使用'||' 而不是请求中的“或”。通过此请求，我可以在相册中选择多张照片。

```
https://picasaweb.google.com/data/feed/api/user/default/albumid/{albumid}?kind=photo&[gphoto.id={photo1 id}||gphoto.id={photo2 id}] 
```