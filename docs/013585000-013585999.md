# StackOverflow 问答 13585000-13585999

# unit-testing - 获取使用数据以构建单元测试

> ID：13585002
> 
> 赞同：0
> 
> 时间：2012-11-27T13:11:45.073
> 
> 标签：unit-testing, logging, mvvm, viewmodel

我正在使用 MVVM 模式开发 WPF 应用程序。

我希望能够收集使用数据，以便能够重播导致错误的场景。

我假设 Viewmodel 是开始的地方，因为这是用户交互数据的来源。

我的想法是首先记录所有属性和方法调用以及重要数据。你怎么看 ？有什么经验可以分享吗？

TIA。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T17:29:21.447

这可能取决于您需要这些日志的详细程度......记录每个属性和方法调用可能会对性能产生影响。
此外，当绑定到属性时，`GetValue` [直接调用](https://stackoverflow.com/a/4225429/1379664)而不是通过 CLR 属性，所以你不会真的得到所有的调用......

无论哪种方式，记录 ViewModel 的概念都是一个很好的概念。如果您的所有虚拟机都从某种`ViewModelBase`.

我建议您首先使用专用的日志记录工具，例如**[log4net](http://logging.apache.org/log4net/)**。将其用于：

*   虚拟机创建
*   调用重要方法
*   例外
*   等等

您可以随时去记录对每个函数的每次调用，但沿途记录*路径点可能更容易。*

# ruby-on-rails - 如何使用 markdown 文件作为 rdoc 的主文件（在 rails 项目中）？

> ID：13585005
> 
> 赞同：8
> 
> 时间：2012-11-27T13:11:47.523
> 
> 标签：ruby-on-rails, ruby, rdoc

是否可以在 Rails 项目中使用 readme.md 文件并让 rdoc 将其用作主页？我尝试如下设置我的 rake 任务，但生成的 index.html 页面有一个占位符语句。如果我更改为 README.rdoc，它会按预期工作，因为它包含文件的内容。

我也在尝试使用tomdoc，我猜这可能会使事情复杂化，不确定。

```
RDoc::Task.new :rdoc do |rdoc|
  rdoc.main = "README.md"

  rdoc.rdoc_files.include("README.md", "doc/*.rdoc", "app/**/*.rb", "lib/**/*.rb", "config/**/*.rb")

  rdoc.title = "My Documentation"
  rdoc.options << "--all"
  rdoc.options << "--line-numbers"
  rdoc.markup = "tomdoc"
  rdoc.rdoc_dir = "rdoc"
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-16T14:42:55.043

这并不是您问题的真正答案，但如果您想要一个好的选择：

使用 YARD

并使用此提示：

[https://github.com/lsegal/yard/issues/404](https://github.com/lsegal/yard/issues/404)

我想你想使用 README.md 来兼容 Github，我经常遇到同样的问题。所以这是一个很好的选择。Personnaly 我更喜欢 YARD 来记录我的 ruby​​ 代码，它更强大，并且实际上与 ruby​​gems 完全兼容，这是首选方式。

给它来扩大你的 Rakefile ：

```
require "github/markup"
require "redcarpet"
require "yard"
require "yard/rake/yardoc_task"

YARD::Rake::YardocTask.new do |t|
  OTHER_PATHS = %w()
  t.files = ['lib/**/*.rb', OTHER_PATHS]
  t.options = %w(--markup-provider=redcarpet --markup=markdown --main=README.md)
end 
```

不要忘记捆绑（更新您的 Gemfile）

# c - bind() 在 Linux 网络编程中得到“无效参数”错误

> ID：13585010
> 
> 赞同：-1
> 
> 时间：2012-11-27T13:11:54.870
> 
> 标签：c, linux, sockets

这是我的代码

```
#include "basic.h"
#include "bp_socket.h"

int setup_tcp(char *port)
{
    struct sockaddr_in server_addr;
    in_port_t server_port;
    int sock;
    int retval;                     //return value

    if ((server_port = atoi(port)) < 0)
    {
        server_port = (in_port_t)DEFAULT_PORT;
        fprintf(stderr, "Error port: %d in line %d\n", (int)server_port, __LINE__);
        //fprintf(stderr, "Use default port: %d\n", DEFAULT_PORT);
    }

    sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
    if (sock < 0)
    {
        return sock;
    }

    retval = listen(sock, 40);
    if (retval < 0)
    {
        return retval;
    }

    memset(&server_addr, 0, sizeof(struct sockaddr_in));
    server_addr.sin_addr.s_addr = htonl(INADDR_ANY);
    server_addr.sin_port        = htons(server_port);
    server_addr.sin_family      = AF_INET;
    retval = bind(sock, (struct sockaddr*)&server_addr, sizeof(server_addr));
    if (retval < 0)
    {
        perror("bind");
        return retval;
    }

    return sock;
}

int main()
{
    printf("%d\n", setup_tcp("4558"));
    perror("");
    return 0;
} 
```

我调试我的代码，然后我发现`bind()`返回`-1`

我用谷歌搜索并阅读手册页，但找不到答案。

功能`setup_tcp`是创建套接字，并与地址绑定。

然后返回`a socket`或`errno value`。

如何解决它。我已经多次阅读我的代码。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:19:48.767

您应该`listen`将`bind`.

`bind`如果套接字已经绑定，则返回错误，并且`listen`在未绑定的套接字上自动将其绑定到随机端口号。

# python - Python / LibTCOD - libtcod.console_wait_for_keypress(True) 为每个输入触发两次

> ID：13585011
> 
> 赞同：2
> 
> 时间：2012-11-27T13:11:59.410
> 
> 标签：python, keyboard, roguelike, libtcod

我正在阅读[Roguebasin python/libtcod roguelike 教程](http://roguebasin.roguelikedevelopment.org/index.php?title=Complete_Roguelike_Tutorial,_using_python%2Blibtcod)。我遇到的问题是，每次`key = libtcod.console_wait_for_keypress(True)`调用时，主循环都不会触发一次，而是触发两次。处理键盘输入的代码如下：

```
def handle_keys():
    #key = libtcod.console_check_for_keypress()  #real-time
    key = libtcod.console_wait_for_keypress(True)  #turn-based

    if key.vk == libtcod.KEY_ENTER and key.lalt:
        #Alt+Enter: toggle fullscreen
        libtcod.console_set_fullscreen(not libtcod.console_is_fullscreen())

    elif key.vk == libtcod.KEY_ESCAPE:
        return 'exit'  #exit game

    if game_state == 'playing':
        #movement keys
        if libtcod.console_is_key_pressed(libtcod.KEY_UP):
            player_move_or_attack(0, -1)

        elif libtcod.console_is_key_pressed(libtcod.KEY_DOWN):
            player_move_or_attack(0, 1)

        elif libtcod.console_is_key_pressed(libtcod.KEY_LEFT):
            player_move_or_attack(-1, 0)

        elif libtcod.console_is_key_pressed(libtcod.KEY_RIGHT):
            player_move_or_attack(1, 0)

        else:
            return 'didnt-take-turn' 
```

[代码从本教程的这一](http://roguebasin.roguelikedevelopment.org/index.php?title=Complete_Roguelike_Tutorial,_using_python%2Blibtcod,_part_6_code)部分逐字提取（除了额外的四个空格缩进） 。请注意，该页面上有两个代码版本。我写了自己的版本，但即使直接复制/粘贴，我也会遇到问题。据我所知，这个问题贯穿了整个教程。

`console_wait_for_keypress(True)`应该等待一个键并将其放入“键”变量中，这样我就可以对其做出反应。所有其他输入都应该被刷新。然后再次调用主循环的新迭代`console_wait_for_keypress(True)`，这应该等待新的输入，依此类推。相反，触发器的每第二次迭代都`console_wait_for_keypress(True)`无需等待新的输入。

游戏实际上运行良好，因为第二个输入不会触发任何`console_is_key_pressed()`条件，并且`handle_keys()`函数返回“didnt-take-turn”，它告诉游戏逻辑什么都不做。这仍然意味着对于每个周期，都会花费两个，这不是所需的行为。`handle_keys()`如果您打印每个循环的结果，问题很容易观察到。它在“None”和“didnt-take-turn”之间交替。

老实说，我对此感到困惑。简单地按住一个方向按钮似乎不会产生'didnt-take-turn'输出，但该功能应该用于单个按键。延迟不能太短，因为正常的按键总是会产生两个输出。libtcod 文档无法帮助我。

我应该怎么做才能使单次击键仅触发一次`console_wait_for_keypress()`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T19:00:09.167

它已在最后一个 svn 中修复： [http ://doryen.eptalys.net/forum/index.php?topic=1500.msg8507#msg8507](http://doryen.eptalys.net/forum/index.php?topic=1500.msg8507#msg8507)

或在这里： [https ://bitbucket.org/jice/libtcod](https://bitbucket.org/jice/libtcod)

# actionscript-3 - ArgumentError：错误 #2025：提供的 DisplayObject 必须是调用者的子对象

> ID：13585014
> 
> 赞同：2
> 
> 时间：2012-11-27T13:12:08.817
> 
> 标签：actionscript-3, flash

我正在 as3.0 中创建一个小游戏。我在游戏中产生了很多试图粉碎你（玩家）的墙。

我正在尝试从阵列和屏幕中删除您附近的所有墙壁。我第一次点击按钮时，它只会删除 250 像素范围内的所有墙壁。但是我第二次点击按钮时出现以下错误：

> ArgumentError：错误 #2025：提供的 DisplayObject 必须是调用者的子对象。

我认为这是因为试图删除已经被删除的孩子。我尝试使用以下代码检查孩子是否存在，但它似乎不起作用。

```
if (wallArray[i] != null && contains(wall)) {
    if (wallArray[i].x < 250 + wp_reach){   
        //haalt de muur weg
        //TODO : KIJK OF HET KIND IS

            removeChild(wallArray[i]); 
         }

    } 
```

这是处理按钮按下的完整代码：

```
Multitouch.inputMode = MultitouchInputMode.TOUCH_POINT;

action.addEventListener(TouchEvent.TOUCH_TAP, fl_TapHandler);

function fl_TapHandler(event:TouchEvent):void
{
    for (var i:Number=0;i<wallArray.length;i++){
        if (wallArray[i] != null && contains(wall)) {
            if (wallArray[i].x < 250 + wp_reach){   
                removeChild(wallArray[i]); 
            }

        }
        else{
            trace ("There is no wall in range yet");
        }
    }   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:24:49.533

始终测试查询中的项目是否是要从中删除的容器的子项，如下所示：

```
if(wallArray[i] && contains(wallArray[i]))
{
    removeChild(wallArray[i]);
} 
```

最好的祝福

# sql - Oracle 序列生成器语法

> ID：13585015
> 
> 赞同：2
> 
> 时间：2012-11-27T13:12:09.133
> 
> 标签：sql, oracle

为 oracle 数据库表属性创建序列生成器的基本语法是：

```
CREATE SEQUENCE customers_seq
START WITH     1000
INCREMENT BY   1
NOCACHE
NOCYCLE; 
```

我想知道`NOORDER`SEQUENCE 语法中的子句是做什么的？如果我包含该`NOORDER`子句，它会给我一个保持增量值随机的序列吗？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T13:18:00.007

在并行服务器模式或集群中运行时，这一点很重要。ORDER 保证序列号是有序的。

```
Example of “noorder” sequence in 10g RAC:

Session 1 on node-A: nextval -> 101
Session 2 on node-A: nextval -> 102
Session 1 on node-B: nextval -> 121
Session 1 on node-B: nextval -> 122
Session 1 on node-A: nextval -> 103
Session 1 on node-A: nextval -> 104 
```

NOORDER 与 CACHING 序列结合会导致这种行为。ORDER 有效地使 CACHE 设置未被使用。当会话获取序列时缓存设置为 10，它会将 10 个序列放入其缓存中。

# apache-flex - 如何在 flex 3.5 的日期字段中更改周末的颜色

> ID：13585031
> 
> 赞同：1
> 
> 时间：2012-11-27T13:13:35.997
> 
> 标签：apache-flex, flex3, flexbuilder

如何更改日期字段中周末的颜色。例如，当用户单击 datefield 时，dateChooser 弹出窗口。我想在日期选择器中以红色显示周末（周六、周日）。我怎样才能做到这一点？我正在使用 flex 3.5。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-14T10:39:08.227

```
<mx:DateField x="158" y="115" disabledColor="red">
    <mx:disabledDays>
        <mx:Number>0</mx:Number>
        <mx:Number>6</mx:Number>
    </mx:disabledDays>
</mx:DateField> 
```

也许这可以帮助

# java - Java小程序类无法实例化

> ID：13585034
> 
> 赞同：0
> 
> 时间：2012-11-27T13:13:48.333
> 
> 标签：java, applet

我是 Java 新手，无法让我的小程序运行。由于某种原因，无法实例化该类。我尝试了一些东西，但没有任何帮助，我真的被卡住了。

这是我收到的错误。

```
load: com.yunatech.pns.chequeprint.HTMLPrinter.class can't be instantiated.
java.lang.InstantiationException: com.yunatech.pns.chequeprint.HTMLPrinter
at java.lang.Class.newInstance0(Unknown Source)
at java.lang.Class.newInstance(Unknown Source)
at sun.applet.AppletPanel.createApplet(Unknown Source)
at sun.applet.AppletPanel.runLoader(Unknown Source)
at sun.applet.AppletPanel.run(Unknown Source)
at java.lang.Thread.run(Unknown Source) 
```

这是我的代码。

```
package com.yunatech.pns.chequeprint;

import java.applet.Applet;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.print.Book;
import java.awt.print.PageFormat;
import java.awt.print.Paper;
import java.awt.print.Printable;
import java.awt.print.PrinterException;
import java.awt.print.PrinterJob;
import java.io.IOException;

import javax.swing.JEditorPane;
import javax.swing.JFrame;

public class HTMLPrinter extends Applet implements Printable{
    /**
     * 
     */
    private static final long serialVersionUID = 2343838467856002371L;
    private final JEditorPane printPane;

    public HTMLPrinter(JEditorPane editorPane){
        printPane = editorPane;
    }

    public int print(Graphics graphics, PageFormat pageFormat, int pageIndex){
        if (pageIndex >= 1) return Printable.NO_SUCH_PAGE;

        Graphics2D g2d = (Graphics2D)graphics;
        g2d.translate((int)pageFormat.getImageableX(), (int)pageFormat.getImageableY());

        printPane.setSize((int)pageFormat.getImageableWidth(), (int)pageFormat.getImageableHeight());
        printPane.print(g2d);

        return Printable.PAGE_EXISTS;
    }

    protected static String dump(Paper paper) {
        StringBuilder sb = new StringBuilder(64);
        sb.append(paper.getWidth()).append("x").append(paper.getHeight())
                .append("/").append(paper.getImageableX()).append("x").
                append(paper.getImageableY()).append(" - ").append(paper
                .getImageableWidth()).append("x").append(paper.getImageableHeight());
        return sb.toString();
    }

    protected static String dump(PageFormat pf) {
        Paper paper = pf.getPaper();
        return dump(paper);
    }

    public void main(String[] args){

        final JFrame frame = new JFrame("Letter wrap test"); 
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 

        final JEditorPane htmlTextPane = new JEditorPane(); 

        String paramUrl   = getParameter("paramUrl");

        htmlTextPane.setContentType("text/html");
        try {
            htmlTextPane.setPage(paramUrl);
        } catch (IOException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }

        HTMLPrinter target = new HTMLPrinter(htmlTextPane);

        PrinterJob pj = PrinterJob.getPrinterJob();
        if (pj.printDialog()) {
            PageFormat pf = pj.defaultPage();
            Paper paper = pf.getPaper();
            double width = 8d * 72d;
            double height = 4d * 72d;
            double margin = 0.1d * 72d;
            paper.setSize(width, height);
            paper.setImageableArea(
                    margin,
                    0,
                    width - (margin * 2),
                    height);
            System.out.println("Before- " + dump(paper));
            pf.setOrientation(PageFormat.PORTRAIT);
            pf.setPaper(paper);
            System.out.println("After- " + dump(paper));
            System.out.println("After- " + dump(pf));
            dump(pf);
            PageFormat validatePage = pj.validatePage(pf);
            System.out.println("Valid- " + dump(validatePage));

            Book pBook = new Book();
            pBook.append(target, pf);
            pj.setPageable(pBook);

            try {
                pj.print();
            } catch (PrinterException ex) {
                ex.printStackTrace();
            }
        }

    } //main

} 
```

如果有人能帮助我指出正确的方向，我将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:18:27.003

这是您要声明的唯一构造函数：

```
public HTMLPrinter(JEditorPane editorPane){
    printPane = editorPane;
} 
```

我相信小程序运行器基础设施需要一个公共的无*参数*构造函数。您希望它从哪里获得`JEditorPane`传递给您的构造函数？

请注意，您的`main`方法在这里无关紧要 - 这*不是*小程序的启动方式。

# c# - “归一化”概率数组

> ID：13585036
> 
> 赞同：0
> 
> 时间：2012-11-27T13:13:53.467
> 
> 标签：c#, java, arrays, probability

我有一个代表某些事件发生概率的双精度数组，[25,25,25,10,15] 代表事件 A,B..E。这些数字加起来是 100。

通过我的分析，我希望能够划掉某个事件发生与否的可能性。

所以，如果我发现事件 E 是不可能的，那么我将该索引设置为 0。如何重新规范化数组，使总数加起来为 100，并保持每个事件的相对概率？

我将使用 C# 或 Java。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:23:10.520

您可以通过多种方式重新分配已移除事件的概率，例如

*   **按比例**- 用值替换每个数字`p/sum(p)`，其中`sum(p)`是*剩余*概率的总和。
*   **相等**- 将删除的值除以剩余项目的数量，并将结果添加到每个剩余概率。

“正确”的答案取决于您的问题的具体情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:21:23.107

```
sum = 100 - P(E)
for each event e:
  if e is E:
    P(E) = 0
  else:
    P(e) = P(e)*100/sum 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T13:28:46.383

我假设概率将保持不变（即在您的示例中，第一个双倍的新可能应该是 25/85）。然后你需要做的是保存你删除的双精度数，减去 100 并除以每个双精度数，然后乘以 100。

Java代码：

```
double[] doubleArray = new double[] { 25, 25 ,25, 10, 15 }; //or any other array
double temp = 100-doubleArray[4]; //or any other specific value in the array
doubleArray[4] = 0;
for (int i; i<doubleArray.length; i++) {
    doubleArray[i] = doubleArray[i]/temp*100;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T14:01:34.090

一个更通用的解决方案是对数组进行归一化以给它一个特定的总数。

```
public static void setTotal(double total, double[] values) {
    double sum = 0;
    for (double value : values) sum += value;
    double factor = total / sum;
    for (int i = 0; i < values.length; i++)
        values[i] *= factor;
} 
```

这允许您更改任何值并确保总数是您想要的任何值（前提是总和不为零）

# android - android CellSignalStrength

> ID：13585037
> 
> 赞同：2
> 
> 时间：2012-11-27T13:13:56.090
> 
> 标签：android

[CellSignalStrength](https://developer.android.com/reference/android/telephony/CellSignalStrength.html)是 android 中的一个新 API 类。

它在 API 级别 17 上发布。

如何在 Android 中获取此小区服务信号强度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:20:22.613

您需要使用这些类之一：

*   [细胞信号强度CDMA](http://developer.android.com/reference/android/telephony/CellSignalStrengthCdma.html)
*   [细胞信号强度Gsm](http://developer.android.com/reference/android/telephony/CellSignalStrengthGsm.html)
*   [细胞信号强度](http://developer.android.com/reference/android/telephony/CellSignalStrengthLte.html)

我玩过它，所以这是我的代码：

```
final TelephonyManager telephonyManager = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);
CellInfoGsm cellInfoGsm = (CellInfoGsm) telephonyManager.getAllCellInfo().get(0);
CellSignalStrengthGsm cellSignalStrengthGsm = cellInfoGsm.getCellSignalStrength();
cellSignalStrengthGsm.getDbm(); 
```

# java - 在主 UI 上执行网络进程

> ID：13585040
> 
> 赞同：0
> 
> 时间：2012-11-27T13:14:12.663
> 
> 标签：java, android, eclipse, json, asynchronous

我的 Android 应用程序需要一些基本数据才能运行。此数据是使用 JSON 从服务器下载的。在 Xcode 中，我只是使用了 sendsynchronous 请求，但我注意到当我在主 ui 上进行网络连接时，Eclipse 给了我一个错误。在 asynctask 上找到了很多东西，但我希望我的应用程序等到下载所需的数据（同步？）。

我尝试使用 asynctask .execute().get() 并在 onPostExecute 中设置变量，但是当我返回变量时，我得到了 NullPointerException。有人知道如何进行这项工作吗？在应用程序运行之前我真的需要这些数据，所以我希望我的应用程序等到数据下载完成。

MainActivity 调用这个：

```
SingletonClass appIDSingleton = SingletonClass.getInstance();
this.ID = appIDSingleton.getAppID(); 
```

单例类：

```
public String getAppID() {
           try {
            new DownloadAppID().execute(APP_ID_URL).get(5000, TimeUnit.MILLISECONDS);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (ExecutionException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (TimeoutException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
           return AppID; //AppID is still NULL (because the download isnt finished yet?)
       }

private class DownloadAppID extends AsyncTask<String, Void, String> {
        @Override
        protected String doInBackground(String... urls) {
            String response = "";
            for (String url : urls) {
                DefaultHttpClient client = new DefaultHttpClient();
                HttpGet httpGet = new HttpGet(url);
                try {
                    HttpResponse execute = client.execute(httpGet);
                    InputStream content = execute.getEntity().getContent();

                    BufferedReader buffer = new BufferedReader(new InputStreamReader(content));
                    String s = "";
                    while ((s = buffer.readLine()) != null) {
                        response += s;
                    }

                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
            return response;
        }

        @Override
        protected void onPostExecute(String result) {

            System.out.println(result);
            AppID = result;
            }
       } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:31:26.803

您需要了解您的`getAppID`方法不能返回将要异步计算的结果。

例如，您可以为您的异步任务提供一个侦听器，以便在应用 ID 可用时发出通知：

```
 SingletonClass appIDSingleton = SingletonClass.getInstance();
    appIDSingleton.getAppID(new AppIdDownloadListener() {

        @Override
        public void appIDAvailable(String appId) {
            this.ID = appId; 
        }
    });

public void getAppID(AppIdDownloadListener listener) {
    try {
        new DownloadAppID(listener).execute(APP_ID_URL).get(5000, TimeUnit.MILLISECONDS);
    } catch (InterruptedException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (ExecutionException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (TimeoutException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}

public interface AppIdDownloadListener {
    public void appIDAvailable(String appId);
}

private class DownloadAppID extends AsyncTask<String, Void, String> {

    private AppIdDownloadListener listener;

    public DownloadAppID(AppIdDownloadListener listener) {
        this.listener = listener;
    }

    @Override
    protected String doInBackground(String... params) {
        /* Your stuff here */
    }

    @Override
    protected void onPostExecute(String result) {
        System.out.println(result);
        listener.appIDAvailable(result);
    }
} 
```

# grails-2.0 - 是否可以动态设置小部件约束？

> ID：13585041
> 
> 赞同：0
> 
> 时间：2012-11-27T13:14:16.217
> 
> 标签：grails-2.0

我正在为 grails 设计动态表单，我想知道是否可以动态设置小部件约束？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T15:26:11.347

设置小部件约束不是解决这个问题的方法。我想最简单的方法是在视图或模板中使用“if”标签根据某些条件选择要显示的标签。例如：

假设你有一本书

```
class Book {

    String name

} 
```

如果你对这个类使用 Grails generate-view，Grails 将生成一个名为 _form 的模板，如下所示：

```
<div class="fieldcontain ${hasErrors(bean: bookInstance, field: 'name', 'error')} ">
    <label for="name">
        <g:message code="book.name.label" default="Name" />

    </label>
    <g:textField name="name" value="${bookInstance?.name}"/>
</div> 
```

您可以在此表单中测试您的状况并更改视图：

```
<div class="fieldcontain ${hasErrors(bean: bookInstance, field: 'name', 'error')} ">
        <label for="name">
            <g:message code="book.name.label" default="Name" />

        </label>

            <g:if test="$yourCondition">
                <g:textField name="name" value="${bookInstance?.name}"/>
            </g:if>
            <g:else>
                <g:textArea name="name"  value="${bookInstance?.name}"/>
            </g:else>
    </div> 
```

现在视图将显示基于 $yourCondition 的 textField 或 textArea 字段。

# android - Android 异步任务取消/停止

> ID：13585044
> 
> 赞同：13
> 
> 时间：2012-11-27T13:14:28.947
> 
> 标签：android, events, android-asynctask

我想知道停止异步任务 frm 运行的最佳方法是什么。

我试过了

```
@Override protected void onCancelled() { 
      super.onCancelled(); 
      mTask.cancel(true);       
 } 
```

我也试过

```
asyncTaskObject.cancel(true); 
```

这在与事件关联时特别有效。

但是假设场景是---有4个AsyncTask。第一次调用第二次，第二次调用第三次，第三次调用第四次。当用户进入活动时，没有对话框。否则我们可以在那里使用 onCancel 方法。当用户单击页面上的任何位置时，如果用户没有单击任何位置，则会出现对话框，则不会显示对话框，但异步任务会在后台继续运行。假设用户单击“返回”按钮或导航图标到主页页面 user.is 从当前活动中取出。但是异步任务继续在后台运行，最终应用程序崩溃。我已经习惯了 onBackPressed 中的取消方法。但问题是您无法确定哪个任务正在运行并且应用程序再次崩溃。

解决这个问题的方法是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-27T13:18:54.787

保持对 AsyncTask 对象的引用作为实例变量，然后在 onDestroy() 中执行此操作

```
@Override
protected void onDestroy() {
    if (mTask != null) {
        mTask.cancel(true);
    }

    super.onDestroy();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T13:24:43.847

在[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)中有一个称为线程规则的会话，它说 AsyncTasks 实例必须在 UI 线程上创建并且必须在 UI 线程上调用执行。如果您从 UI 线程调用执行，您可以取消调用 yourTaskInstance.cancel(true); 的线程

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T13:22:28.150

我不完全确定何时要取消任务，但这里有一些建议： a) 保留对正在运行的每个任务的引用。b）在您的对话框中添加一个关闭侦听器并取消那里的所有任务（如果这是您想要做的）。c) 在您的活动的 onStop 回调中取消所有任务（如果您想再次这样做）。

# extjs - ExtJS4 Column 类是如何工作的？

> ID：13585045
> 
> 赞同：0
> 
> 时间：2012-11-27T13:14:29.647
> 
> 标签：extjs, extjs4.1

我编写了自己的子类，用于一些选择和分页等。但是这些都与 . 一起使用`renderer()`，这要求它们返回一个字符串。

这很好用，我创建了一些图像标签并返回了这些标签。

但是这个类是如何详细工作的呢？我想要一个在单元格中显示图表的子类，这在技术上应该没有问题，但`renderer()`它似乎不适合它，因为它只适用于字符串。

类是否为每一行实例化？或者它真的只是一列的一个实例，对于具有所需数据的每一行调用哪些方法，并且这些实例不保存有关行的任何状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:46:18.247

该`renderer()`机制实际上是在 中实现的`Ext.grid.column.Column`，每列有一个。

正如您所提到的，该`renderer()`函数返回一个字符串，它可能是一个 HTML 字符串（这可能相当复杂 - 看看 ExtJs 用于标准列的模板）。但是您不能返回组件（图表）。

据我所知（基于我自己的理解和对类似问题的回答），ExtJs 没有提供一种直接的方式来渲染网格单元中的组件。如果您真的考虑一下 - 您对网格的要求远远超过其预期角色。它旨在按原始记录呈现记录，并添加了简单的用户交互设施，如复选框。

但是您真正要求的是更多布局图表的方法，对于这个问题，我建议您查看[表格布局](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.layout.container.Table)。

或者，您应该能够将图表呈现到 dom 元素中，该元素将在您自己的自定义列模板中定义。但我会认为这是一项复杂的任务。

# drop-down-menu - 如何从 LightSwitch 的下拉控件中过滤掉已选择的项目？

> ID：13585051
> 
> 赞同：1
> 
> 时间：2012-11-27T13:14:48.353
> 
> 标签：drop-down-menu, visual-studio-lightswitch

我想要实现的是以下内容：我有一个下拉列表，其中包含数据库中的一些值。我有一些与 WorkingUnits 相关联的材料。因此，我可以为一个 WorkingUnit 分配尽可能多的材质，也可以将一个相同的材质分配给两个不同的 WorkingUnit（如果我想这样做的话）。到目前为止一切都很好，但我想要额外实现的是过滤掉每个工作单元已经选择的材料，以便用户无法再次选择它们。

临时表关系：

```
|Materials|1 --------- * |MaterialWorkingUnitMap| * ----------- 1 |WorkingUnit| 
```

我可能会要求一些微不足道的事情，但到目前为止我无法弄清楚。根据所描述的行为，您的关系是否错误？在我看来，它们是有道理的，但我对 LightSwitch 完全陌生。

另一种解决方案是还包括一些验证，以防用户选择一个相同的材料。这是不太理想的方法，但我想它也让我满意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-07T11:08:55.647

我希望这有帮助。

转到您的材料表并创建一个名为“UnusedMaterialsByWorkingUnit”的新查询 在此查询中，添加 1 个参数：Integer 类型的参数 WorkingUnitID。转到写入代码下拉菜单并选择“UnusedMaterialsByWorkingUnit_PreprocessQuery”

使您的 PreprocessQuery 看起来像这样：

```
partial void UnusedMaterialsByWorkingUnit_PreprocessQuery(int? WorkingUnitID, ref IQueryable<Material> query)

{
    query = from material in query
            where !material.MaterialWorkingUnitMaps.Any(c => c.WorkingUnit.Id == WorkingUnitID)
            select material;
} 
```

转到具有下拉菜单的 LIghtswitch 屏幕。添加数据项...并选择 UnusedMaterialsByWorkingUnit 查询。在屏幕左侧，单击查询中的 WorkingUnitID 并将其数据绑定到屏幕上加载的 WorkingUnit.ID。转到您的下拉列表并选择 UnusedMaterialsByWorkingUnit 集合作为源。

让我知道这个是否奏效！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T19:35:13.323

在将选定材料项添加到 MaterialWorkingUnitMap 的命令中，添加一些代码以从材料集合中删除选定的记录。使用 Lightswitch 的数据绑定，应该会立即从视图中移除 Material 记录。但是，当您调用 SaveChanges 时，这将导致从数据库中删除这些材料记录，我认为您不会这样做。因此，为了防止这种情况，在 SaveChanges 管道中，您可以对已删除的 Material 记录调用 DiscardChanges。

# php - HTML5/PHP：如何识别输入的 url

> ID：13585055
> 
> 赞同：1
> 
> 时间：2012-11-27T13:15:07.463
> 
> 标签：php, html, hyperlink

> **可能重复：**
> [如何在 PHP 中自动将 url 转换为超链接？](https://stackoverflow.com/questions/5531502/how-do-i-auto-convert-an-url-into-a-hyper-link-in-php)

假设我的网站上有一个文本字段，用户可以在其中输入任何他想要的内容。如果用户输入一个 url，我想在后台向这个 url 添加代码。因此，我需要逻辑才能识别网址。

示例 用户输入文本：

```
Please visit me at my website: http://www.mywebsite.org 
```

我想把后台的代码改成这样：

```
Please visit me at my website: <a href="http://www.companywebsite.com/redirect.php?http://www.mywebsite.org">http://www.mywebsite.org</a> 
```

提交文本后如何更改该链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:21:00.520

```
<?php

// The Regular Expression filter
$reg_exUrl = "/(http|https|ftp|ftps)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(\/\S*)?/";

// The Text you want to filter for urls
$text = "The text you want to filter goes here. http://google.com";

// Check if there is a url in the text
if(preg_match($reg_exUrl, $text, $url)) {

       // make the urls hyper links
       echo preg_replace($reg_exUrl, "<a href="{$url[0]}">{$url[0]}</a> ", $text);

} else {

       // if no urls in the text just return the text
       echo $text;

}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:19:13.150

是的。只需使用正则表达式。见[preg_replace](http://php.net/manual/en/function.preg-replace.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T13:21:38.117

如果您正在保存用户输入并将其显示在网站上（正如我猜测的那样），您应该保存原始输入并在渲染时应用逻辑。

有关逻辑，请参见此处： [检测 URL 并在其周围添加 achor-tags](https://stackoverflow.com/questions/9647941/detect-url-and-add-achor-tags-around-it)

```
$link = preg_replace("/(http:\/\/[^\s]+)/", "<a href=\"$1\">$1</a>", $link); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T13:30:53.130

哟也可以试试

```
$text = "Please visit me at my website: http://www.mywebsite.org
Please visit me at my website: http://www.mywebsite.org";
$newText    =   preg_replace('/((http|https|ftp):\/\/[^\s]+)/i',
'<a href="$1" class="link1" target="_blank">$1</a>', $text);
echo $newText; 
```

这个

# mysql - mysql 按子查询结果过滤

> ID：13585056
> 
> 赞同：2
> 
> 时间：2012-11-27T13:15:12.030
> 
> 标签：mysql, sql, select, where-clause, inner-query

我有这个查询：

```
SELECT a.*, a.id AS id_player, (SELECT COUNT(id) FROM `vd7qw_footsal_goals` WHERE a.id = id_player AND g.id = id_group) AS goals, 
team.* FROM `vd7qw_footsal_players` AS a 

LEFT JOIN vd7qw_footsal_teams AS team ON team.id= a.id_team

LEFT JOIN vd7qw_footsal_teamofgroup AS tog ON tog.id_team = team.id 4

LEFT JOIN vd7qw_footsal_groups AS g ON g.id = tog.id_group
WHERE g.id IN (SELECT id_group from `vd7qw_footsal_groupofleague` WHERE id_league = 2) 
AND (a.state IN (1)) AND goals > 0 ORDER BY goals DESC 
```

我想通过有目标的玩家过滤它的结果

上面的查询在这部分有错误`goals > 0`我不知道该怎么做任何1可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T13:17:44.337

试试这个：

```
SELECT * FROM 
(SELECT a.*, a.id AS id_player, (SELECT COUNT(id) FROM `vd7qw_footsal_goals` WHERE a.id = id_player AND g.id = id_group) AS goals, 
team.* FROM `vd7qw_footsal_players` AS a 

LEFT JOIN vd7qw_footsal_teams AS team ON team.id= a.id_team

LEFT JOIN vd7qw_footsal_teamofgroup AS tog ON tog.id_team = team.id 4

LEFT JOIN vd7qw_footsal_groups AS g ON g.id = tog.id_group
WHERE g.id IN (SELECT id_group FROM `vd7qw_footsal_groupofleague` WHERE id_league = 2) 
AND (a.state IN (1))) AS A WHERE goals > 0 ORDER BY goals DESC 
```

# spring - 使用 Javascript 的 Spring 表单元素、多个nestedPath 和引用输入

> ID：13585058
> 
> 赞同：0
> 
> 时间：2012-11-27T13:15:12.747
> 
> 标签：spring, spring-mvc

我有复杂的表单对象，具有无限的深度，我试图在 jsp 上使用 spring 表单标签编辑它们。

主模型属性绑定到弹簧形式，当我遍历孩子时，我使用了nestedPath，一切正常。结果，我生成了类似于以下内容的输入名称：

```
name="elements['secondColumn'][0].elements[0].removed" 
```

问题是我不知道生成的名称。为什么我需要它？假设我有删除按钮，我想将相应的字段“删除”设置为 1。

**更新：** 它是如何工作的？我正在使用递归调用它们的标签文件。

*容器标签*

```
<c:forEach items="${elements}" var="element" varStatus="index">
 <spring:nestedPath path="elements[${index.count - 1}]">
   <my:elementConfig element="${element}">
    <my:container elements="${element.elements}"/>
   </my:elementConfig>
 </spring:nestedPath>
</c:forEach> 
```

*elementConfig.tag*

```
...
<form:hidden path="removed"/>
...
<button onclick="delete('howToGetNameOfRemovedHidden')">Delete</button>
...
<jsp:doBody/>
... 
```

我已经找到的最接近的匹配是“nestedPath”pageContext 属性，但它也包含模型属性（表单）名称的名称。

有官方的方法来获取生成的名称吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:13:20.770

我想您可以通过其他属性，例如使用 HTML5 属性`data-*`：

```
<c:set var="i" value="0" />
<c:foreach [...]>
    <form:input path="[...].remove" data-inputid="input${i}" />
    <button class="removebutton" data-inputid="input${i}">Remove</button>
    <c:set var="i" value="${i + 1}" />
</c:foreach> 
```

然后，以 jQuery 为例：

```
$(function() {
    $(".removebutton").click(function() {
        var dataInputId = $(this).data("inputid");
        $("input[data-inputid='" + dataInputId + "']").val(1);
    });
}); 
```

但不要忘记：如果你有嵌套循环，`data-input`整个文档应该是唯一的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T09:32:41.493

似乎没有官方支持获取生成的输入名称，所以我制作了一个处理它的函数。它基于我在 Spring 表单标签库中找到的功能。

**静态方法：**

```
public class JspUtils {

    public static String escapeJS( String value) {
        return StringEscapeUtils.escapeJavaScript( value);
    }

    public static String getPath( PageContext pageContext, String name) {

        String path =   (String)pageContext.getRequest().getAttribute( "nestedPath");
        if (path == null)
            path    =   (String)pageContext.getAttribute( "nestedPath");
        if (path == null)
            return name;

        path        =   path.substring( path.indexOf( ".") + 1);
        path        +=  name;
        return path;
    }

    public static String getPathJsEscaped( PageContext pageContext, String name) {
        return StringEscapeUtils.escapeJavaScript( getPath(pageContext, name));
    }
} 
```

**顶级域名定义：**

```
<function>
    <description>
        Get nested path value as string
    </description>
    <name>getPath</name>
    <function-class>com.pathfix.JspUtils</function-class>
    <function-signature>java.lang.String getPath(javax.servlet.jsp.PageContext, java.lang.String)</function-signature>
</function>
<function>
    <description>
        Get nested path value as javascript escaped string
    </description>
    <name>getPathJsEscaped</name>
    <function-class>com.pathfix.JspUtils</function-class>
    <function-signature>java.lang.String getPathJsEscaped(javax.servlet.jsp.PageContext, java.lang.String)</function-signature>
</function> 
```

**示例用法：**

```
<%@ taglib prefix="pathfix" uri="http://pathfix.com"%>

Name: <form:input path="name"/>
<a href="javascript: alert('Generated name is ${pathfix:getPathJsEscaped( pageContext, 'name')}')">Test it!</a> 
```

# vbscript - 如何删除注册表项及其子项的数组

> ID：13585063
> 
> 赞同：1
> 
> 时间：2012-11-27T13:15:36.543
> 
> 标签：vbscript, registry

我正在尝试删除注册表项及其子项的数组。

以下是我的代码

```
Function DeleteSubkeys(strKeyPath) 

    Msgbox"DeleteSubkeys starts "   

    Dim strComputer,arrSubkeys
    Const HKEY_LOCAL_MACHINE = &H80000002
    strComputer = "."
    Set objRegistry = GetObject("winmgmts:\\" & _
    strComputer & "\root\default:StdRegProv") 

    objRegistry.EnumKey HKEY_LOCAL_MACHINE, strKeyPath, arrSubkeys 

    If IsArray(arrSubkeys) Then 
        For Each strSubkey In arrSubkeys 
            DeleteSubkeys HKEY_LOCAL_MACHINE, strKeyPath & "\" & strSubkey 
        Next 
    End If 

    objRegistry.DeleteKey HKEY_LOCAL_MACHINE, strKeyPath

    Msgbox"DeleteSubkeys ends "

    DeleteSubkeys= null

End Function

Msgbox"Main starts "
dim Regkey 
Regkey = Array(_
    "SOFTWARE\Wow6432Node\Myproj\test1",_
    "SOFTWARE\Wow6432Node\Myproj\test2"_
)

Msgbox"Outside foreach "
For Each strRegKey IN Regkey
    Msgbox"Inside foreach  "
        DeleteSubkeys strRegKey
Next

Msgbox"Main ends " 
```

但它无法调用在 forach 中调用的函数 DeleteSubKeys。我在这里想念什么？

# twitter - 使用 twitteroauth 上传图片的格式是什么？

> ID：13585065
> 
> 赞同：2
> 
> 时间：2012-11-27T13:15:50.203
> 
> 标签：twitter, oauth, twitter-oauth, image-uploading

**来源：** [https ://github.com/abraham/twitteroauth/pull/137](https://github.com/abraham/twitteroauth/pull/137)

在上述链接中，Github 用户 Robhaswell 对亚伯拉罕的 TwitterOAuth 代码进行了调整，并添加了`upload`上传图片的功能。这是对框架的一个很好的补充，但是，新代码没有附加适当的文档或示例，所以我在使用该函数时遇到了一些麻烦：

```
$image = 'weather.jpg';

$response = $tweet->upload('statuses/update_with_media', array(
    'status' => 'This is a test', 
    'media[]' => "@{$image};type=image/jpeg;filename={$image}")
); 
```

而 weather.jpg 与上面代码的文件位于同一文件夹中。

**旁注**：代码将通过 cron 执行，并将始终存在于服务器上的图像上传到 twitter。只是为了澄清用户不必先上传他们的图像，然后通过此脚本将它们提交到 Twitter。

谁能指出我正确的方向？

*编辑：我知道这个功能不是原始版本的一部分，我已经根据 Robhaswell 的调整更新了 twitteroauth 和 OAuth 代码。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-05-07T07:40:28.063

由于这个问题仍然相关，但答案现在已经过时，我将继续使用更新的答案更新这个问题。

`statuses/update_with_media`已被推特弃用。[https://developer.twitter.com/en/docs/tweets/post-and-engage/api-reference/post-statuses-update_with_media.html](https://developer.twitter.com/en/docs/tweets/post-and-engage/api-reference/post-statuses-update_with_media.html)

这是我的工作代码，用于上传和发布带有图片的状态。

```
$twitter = new TwitterOAuth(CONSUMER_KEY, CONSUMER_SECRET, $access_token, $access_token_secret);
$content = $twitter->get("account/verify_credentials");
$tweet = "My tweet";
$imageMedia = $twitter->upload('media/upload', array('media' => '/path/to/image/image_name.png'));
$parameters = array(
    "status" => $tweet,
    "media_ids" => $imageMedia->media_id_string);

$statuses = $twitter->post("statuses/update", $parameters); 
```

我只是想我会在这里发布这个，因为我在寻找答案时偶然发现了这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-20T14:55:25.463

由于我一直在努力解决这个问题，我认为回答这个问题可能会对其他人有所帮助。这使用了 abraham 的 twitteroauth 和添加的图像上传功能（[代码可以在这里找到](https://github.com/robhaswell/twitteroauth/commit/7f5bfd2450cb1cff71641d7ea55e118f5a42885d)）

您应该检查您的图像路径是否正确。它必须指向您服务器上的一个文件（相对）。

另外，确保 twitteroauth 文件中的主机是正确的（参见上传功能，它会短暂更改主机 url，这不再是必需的）。你现在应该使用

```
https://api.twitter.com/1.1/ 
```

代替

```
https://upload.twitter.com/1/ 
```

牢记这两件事，遵循代码应该可以工作（对我有用）；

```
$this->api = new TwitterOAuth($consumerKey, $consumerSecret,$token, $token_secret);    
$attachment = "./images/img.jpg";
$image = "@{$attachment};type=image/jpeg";
$status = "Text";
$result = $this->api->upload('statuses/update_with_media',array('status'=>$message,'media[]'=>$image)); 
```

# javascript - 使用 D3.xml 绘制树状布局

> ID：13585071
> 
> 赞同：3
> 
> 时间：2012-11-27T13:16:22.580
> 
> 标签：javascript, xml, d3.js

在 d3.js 中，我看到了使用 d3.JSON 来使用 JSON 来构建树形布局。我还使用 csv 文件，首先使用 d3.csv 和 d3.nest 将它们转换为 JSON。但是，在使用 d3.xml 获取 XML 数据源时，谁能建议如何在不先将 xml 数据转换为 JSON 的情况下进行树布局？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-22T02:30:49.237

您可以使用`d3.xml`（[https://github.com/mbostock/d3/wiki/Requests#wiki-d3_xml](https://github.com/mbostock/d3/wiki/Requests#wiki-d3_xml)）然后使用 javascript 解析内容

关于 Javascript xml 解析的资源：

[http://www.hiteshagrawal.com/javascript/javascript-parsing-xml-in-javascript](http://www.hiteshagrawal.com/javascript/javascript-parsing-xml-in-javascript)。

# java - 在 swt 中调整大小问题

> ID：13585072
> 
> 赞同：0
> 
> 时间：2012-11-27T13:16:24.000
> 
> 标签：java, user-interface, resize, swt, grid-layout

我对 SWT 编程很陌生。我有一个`GridLayout`. 当我第一次启动 GUI 时，它只`Button`在左上角显示一个。如果我调整它的大小（使窗口更大或更小），我会得到我想要的 GUI。我已经修改了构造函数和`open()`方法，但我所做的每一次更改都没有任何区别。

```
 // constructor
public MyGuiApp(){
    super();
    shell = new Shell();
    shell.setSize(250, 300);

     // the open method
public void open() {
    Display display = Display.getDefault();
    createContents();
    shell.open();
    shell.setLayout(new GridLayout(2,true));

     // instantiation 
        public static void main(String args[]) {
    try {
        MyGuiApp window = new MyGuiApp();
        window.open(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:30:47.450

代码应该是：

```
Display display = Display.getDefault();
Shell shell = new Shell(display);
shell.setLayout(new GridLayout(2, true));
createContents(shell);
shell.pack();
shell.open(); 
```

您缺少`shell.pack();`将根据其内容调整外壳大小的选项。

* * *

顺便说一句：[这](http://www.java-forums.org/java-tip/5028-swt-code-template.html)是一个非常好的模板，几乎可以用作任何 SWT 应用程序的起点。

# html - Wordpress从一个菜单项中删除

> ID：13585074
> 
> 赞同：0
> 
> 时间：2012-11-27T13:16:28.400
> 
> 标签：html, wordpress

在我的联系人菜单下，我有一个使用[http://www.responsetap.com](http://www.responsetap.com) 分析软件动态生成的电话号码，除了 iPhone 上的 Safari 之外，所有浏览器都很好，它似乎正在添加一个额外的`<a>`标签并同时显示动态生成的电话号码和备用电话号码...

现在的问题是：我可以`<a>`从这个菜单项中删除标签，并且只删除这个菜单项，因为他们提供的 JavaScript 似乎无论如何都添加了一个？

这是当前在 chrome 中生成的代码：

```
<li id="menu-item-1372" class="cmi_menu_item_1372 menu-item menu-item-type-custom menu-item-object-custom menu-item-1372"><a>Call Us <span class="rTapNumber23746">0800 612 9481 </span></a></li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:58:50.867

**肮脏的方式：**
创建一个“自定义链接”，`href="#"`它`<a>`会在那里，但点击时它不会做任何事情，我不知道 Iphone 将如何处理它。

**更好的方法**
创建一个[自定义步行者](http://codex.wordpress.org/Function_Reference/Walker_Class)。并建立自己的例外，其中不包括`<a>`

更多信息：

*   [例子](http://shinraholdings.com/62/custom-nav-menu-walker-function/#example-code)
*   [教程](http://wp.tutsplus.com/tutorials/creative-coding/understanding-the-walker-class/)

# internet-explorer - 填写用户名和密码，然后打开另一个IE窗口

> ID：13585076
> 
> 赞同：0
> 
> 时间：2012-11-27T13:16:36.860
> 
> 标签：internet-explorer, autohotkey

> **可能重复：**
> [使用多个选项卡打开 IE](https://stackoverflow.com/questions/13567780/open-ie-with-multiple-tabs)

我试图创建一个可以添加到启动文件夹的 AutoHotkey 脚本，以使用多个预定选项卡打开 IE。我有几个我经常使用的工作网站，我希望在我第一次登录并加载这些页面时自动打开 IE。这是给我的代码（效果很好）：

```
Pwb :=  ComObjCreate("InternetExplorer.Application")
Pwb.Visible:=True
Pwb.Navigate("http://www.google.com") 
Pwb.Navigate("http://stackoverflow.com", 2048)
Pwb.Navigate("http://news.google.com", 2048)
Pwb.Navigate("https://www.quora.com/", 2048)
Return 
```

所以现在，为了让我的请求更加困难，我有一个单独的框，弹出一个请求用户名和密码的网页。我想找到一种方法让它自动填充我的用户名和密码！然后，如果可能的话，我还希望使用自己的选项卡自动打开第二个窗口（在允许第一个窗口登录的等待期之后）。有接盘侠吗？

# drupal - 跟踪 Drupal 站点配置更改

> ID：13585081
> 
> 赞同：3
> 
> 时间：2012-11-27T13:16:54.110
> 
> 标签：drupal

我有时正在开发 Drupal 站点。此开发涉及编写自定义模块，当然还有管理界面上的大量配置工作。

我使用 SCM（当然是 git ..）跟踪我的自定义模块。不幸的是，所有 drupal 模块的配置更加重要和脆弱。这些设置分布在数据库中，因此无法轻松跟踪。

我每天都为我的开发数据库创建备份，但是在意识到出了点问题后，将备份与实际状态进行比较以寻找差异是一件很痛苦的事情。

你有任何最佳实践或建议如何专业地做到这一点？（如果这很重要，我仍然使用 Drupal 6，但我也对 7 和 8 版本的新功能感兴趣）我读到了非常有前途的功能模块，但不完全是我需要的。

我的第一个想法是（1）一个模块，它将所有设置存储在可以使用 SCM 轻松跟踪的文件中，或者（2）一些自动功能，每次发生变化时都会将表导出到文件中

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T13:41:30.557

随着时间的推移，越来越多的配置可以移动到 SCM 中。

在 Drupal 7 的状态下，一些人开始开发他们的站点作为[安装配置文件](http://fuseinteractive.ca/blog/getting-started-drupal-install-profiles)。例如：
[http ://walkah.net/blog/every-drupal-site-install-profile/](http://walkah.net/blog/every-drupal-site-install-profile/)

[功能](http://drupal.org/project/features)是跟踪更改的另一种方式，并且对随时间更改配置很有用，例如，当几个人在一个站点上工作并希望共享他们在本地开发机器上构建的配置时。[使用ctools](http://drupal.org/project/ctools)和[drush](http://drupal.org/project/drush)可以增强功能的可用性（请参阅[Drush CTools Export Bonus 模块](http://drupal.org/project/drush_ctex_bonus)，就像您采用该路线一样）。

对于快速导入/导出`Node types`、`Taxonomy`、`User`和[http://drupal.org/project/bundle_copy](http://drupal.org/project/bundle_copy)似乎是一个不错的选择`Field API fields`。`Field groups`

这是一篇关于不同选项的好博文：http: [//palantir.net/blog/multi-headed-drupal](http://palantir.net/blog/multi-headed-drupal)

使用 Drupal 8，我们将看到配置管理的巨大转变，因为配置导出将内置到核心中。有几个[核心计划](http://drupal.org/community-initiatives/drupal-core)，其中之一是[配置管理计划](http://groups.drupal.org/build-systems-change-management/cmi)。某些功能的反向移植可[作为 Drupal 7 模块](http://drupal.org/project/configuration)使用。

除此之外，我喜欢在工作时处理事情的一种方式是记下我随着时间的推移或我正在从事的项目的问题跟踪器中改变的事情。

# dynamic - 如何在 Dart 中动态执行（如 Eval）？

> ID：13585082
> 
> 赞同：8
> 
> 时间：2012-11-27T13:16:53.657
> 
> 标签：dynamic, eval, dart

自从开始使用 Dart 以来，我一直在寻找一种将 Dart（文本）源（同一程序很可能动态生成）作为代码执行的方法。就像臭名昭著的“eval()”函数。

最近我发现了一些提示，即 Isolates 之间的通信端口支持某种“Spawn”，似乎它可以允许这种“技巧”。在 Ruby 中，也可以将模块作为语言特性动态加载，也许在 Dart 中有一些方法可以做到这一点？

任何线索或一个简单的例子将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-27T13:24:14.937

Ladislav Thon 提供了这个答案（在 Dart 论坛上），

我相信可以肯定地说 Dart 永远不会有 eval。但它会有其他更结构化的动态生成代码的方式（代号镜像构建器）。不过，现在没有这样的事情。

有两种方法可以生成隔离：spawnFunction，它从新隔离中的现有代码运行现有函数，所以你不需要寻找任何东西，以及 spawnUri，它从给定的 URI 下载代码并在新隔离中运行它。这本质上是动态代码加载——但动态加载的代码与现有代码是隔离的。它在一个新的隔离中运行，因此与它通信的唯一方式是通过消息传递（通过端口）。

谢谢拉迪斯拉夫...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2019-08-15T07:39:25.477

您可以将字符串作为 Dart 代码运行，方法是首先从中构造一个数据 URI，然后将其传递到`Isolate.spawnUri`.

```
import 'dart:isolate';

void main() async {
  final uri = Uri.dataFromString(
    '''
    void main() {
      print("Hellooooooo from the other side!");
    }
    ''',
    mimeType: 'application/dart',
  );
  await Isolate.spawnUri(uri, [], null);
} 
```

请注意，您只能在 JIT 模式下执行此操作，这意味着您可能会从中受益的唯一地方是 Dart VM 命令行应用程序/包：构建脚本。它不适用于 Flutter 发布版本。

要从中获取结果，您可以使用*ports*：

```
import 'dart:isolate';

void main() async {
  final name = 'Eval Knievel';
  final uri = Uri.dataFromString(
    '''
    import "dart:isolate";

    void main(_, SendPort port) {
      port.send("Nice to meet you, $name!");
    }
    ''',
    mimeType: 'application/dart',
  );

  final port = ReceivePort();
  await Isolate.spawnUri(uri, [], port.sendPort);

  final String response = await port.first;    
  print(response);
} 
```

[我在我的博客上写过它](https://iirokrankka.com/2019/08/15/how-to-eval-in-dart/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T10:00:29.813

至少在 Ruby 中，Eval() 可以执行从单个语句（如赋值）到完成相关程序的任何内容。与大多数其他可能的执行形式相比，执行许多小片段会花费大量时间。

仔细研究这个问题，至少有三个不同的函数是可以使用 eval 的各种方案的基础。Dart 至少以最少的方式处理其中的 2 个。

Dart 没有，看起来也没有计划支持“通用”脚本执行。

但是，可以使用 NoSuchMethod 方法有效地将变量动态“注入”到本地类环境中。它将 eval() 替换为如下所示的字符串： eval("String text = 'your first name here';" );

Dart 现在支持的第二个函数是调用方法，它看起来像这样： eval("Map map = SomeClass.some_method()" );

在搞砸了这个之后，我终于明白，一个简单的类可以用来存储调用方法所需的信息，对于一个类，作为一个似乎具有通用实用性的字符串。我可以替换一个易于维护的大型 switch 语句，否则它可能需要调用一系列方法。在 Ruby 中，这几乎是微不足道的，但是在 Dart 中，有一些相当不直观的调用，所以我想在一个地方获得这个“技巧”，它适合对字符串进行排序和过滤，例如您可能需要的。

这是使用反射将尽可能多的类（整个库？）“累积”到映射中的代码，这样 class.methodName() 只需一个键（作为字符串）就可以调用。

注意：我使用了一些“辅助方法”来执行 Map & List 功能，您可能想用直接 Dart 替换它们。但是，此代码仅使用函数进行使用和测试..

这是代码：

```
//The used "Helpers" here..
MAP_add(var map, var key, var value){ if(key != null){map[key] = value;}return(map);}
Object MAP_fetch(var map, var key, [var dflt = null]) {var value = map[key];if (value==null) {value = dflt;}return( value );}

class ClassMethodMapper {
  Map    _helperMirrorsMap, _methodMap;

  void accum_class_map(Object myClass){
    InstanceMirror helperMirror = reflect(myClass);
    List methodsAr  = helperMirror.type.methods.values;
    String classNm  = myClass.toString().split("'")[1]; ///#FRAGILE      
    MAP_add(_helperMirrorsMap, classNm, helperMirror);
    methodsAr.forEach(( method) {
      String key = method.simpleName;
      if (key.charCodeAt(0) != 95) { //Ignore private methods
        MAP_add(_methodMap, "${classNm}.${key}()", method);
      }
    });
  }

  Map invoker( String methodNm ) {
    var method = MAP_fetch(_methodMap, methodNm, null);
    if (method != null) {         
      String classNm = methodNm.split('.')[0];        
      InstanceMirror helperMirror = MAP_fetch(_helperMirrorsMap, classNm);
      helperMirror.invoke(method.simpleName, []);
    }
  }

  ClassMethodMapper() {
    _methodMap         = {};
    _helperMirrorsMap  = {};
  }
}//END_OF_CLASS( ClassMethodMapper );

============

main() {
   ClassMethodMapper cMM = new ClassMethodMapper();
   cMM.accum_class_map(MyFirstExampleClass);
   cMM.accum_class_map(MySecondExampleClass);

   //Now you're ready to execute any method (not private as per a special line of code above)
   //by simply doing this:
   cMM.invoker( MyFirstExampleClass.my_example_method() );
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-29T20:11:50.660

实际上[pub.dev/packages](https://pub.dev/packages)中有一些库，但由于是年轻版本，所以有一些限制，所以我可以向你推荐这个库[**表达式**](https://pub.dev/packages/expressions)来飞镖和颤振。

解析和评估简单表达式的库。

这个库可以处理简单的表达式，但不能处理代码块、控制流语句等。它支持大多数编程语言通用的语法。

在那里，我创建了一个代码示例来评估算术运算和数据比较。

```
import 'package:expressions/expressions.dart';
import 'dart:math';

@override
Widget build(BuildContext context) {
 final parsing = FormulaMath();
 // Expression example
 String condition = "(cos(x)*cos(x)+sin(x)*sin(x)==1) && respuesta_texto == 'si'";

 Expression expression = Expression.parse(condition);

 var context = {
   "x": pi / 5,
   "cos": cos,
   "sin": sin,
   "respuesta_texto" : 'si'
 };

 // Evaluate expression
 final evaluator = const ExpressionEvaluator();
 var r = evaluator.eval(expression, context);
 print(r);

 return Scaffold(
   body: Container(
     margin: EdgeInsets.only(top: 50.0),
     child: Column(
       children: [
         Text(condition),
         Text(r.toString())
       ],
     ),
   ),
 );
} 
```

我/颤振（27188）：真

# jquery - 每个循环中的 jQuery 单选按钮选择检查

> ID：13585084
> 
> 赞同：0
> 
> 时间：2012-11-27T13:16:57.823
> 
> 标签：jquery

我有以下 jquery 代码，它检查单选按钮并在每个组中没有选择单选按钮时隐藏或显示相关的警告框。

但是，当我运行代码时，它会获取第一个选中单选的值并将其分配给单选按钮的所有值（即使它们未被选中）。

所以当我只选择第 8 组值为 4 的单选按钮时，在控制台中我得到

6 被检查：4
7 被检查：4
8 被检查：4

但它应该打印 oh no oh no 8 检查：4

你能帮我解决这个问题吗？

谢谢。

```
 $.each(checkboxers, function(_, q)
    {
        var warnbox = $('.q' + q);
        if (!!$("input[@name='answer" + q + "']:checked").val()) {
            console.log(q + ' is checked.' + $("input[@name='answer" + q + "']:checked").val());
            warnbox.hide();
        } else {
            console.log('oh no!');
            err = true;
            warnbox.show();
        }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:43:28.780

删除了所有 @ s 并解决了问题..

# iphone - 如何在 iPhone 应用程序中混合两个 mp3 文件并生成一个

> ID：13585088
> 
> 赞同：1
> 
> 时间：2012-11-27T13:17:02.690
> 
> 标签：iphone, audio

我有两个 mp3 文件，a.mp3 为 5 秒，b.mp3 为 7 秒，我想将它们混合以生成持续时间为 7 秒的 c.mp3。[我已尝试以下链接http://www.modejong.com/iOS/#ex4](http://www.modejong.com/iOS/#ex4)的以下代码示例 4

但它只混合 caf 文件，我需要混合不同大小的 MP3 文件。

谢谢-

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T13:26:54.330

您需要使用[AVMutableCompositionTrack](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVMutableCompositionTrack_Class/Reference/Reference.html)和[AVAssetExportSession 类](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVAssetExportSession_Class/Reference/Reference.html)来执行此操作。

[这是developer.Apple.com](http://developer.apple.com/library/ios/#samplecode/MixerHost/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010210)上的示例代码。

这是一个很好的[教程](http://www.raywenderlich.com/13418/how-to-play-record-edit-videos-in-ios)，它将两个视频文件和一个音乐文件合并为一个文件。可以重复使用相同的代码来合并两个音频文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T06:28:42.810

根据您的要求，您可以使用下面的演示代码将两个`.mp3`或`caf`文件转换为一个文件，请参阅教程并获得一些想法并使用这些演示..

请参阅下面的示例代码和教程链接。

1.  [AudioConverterFileConvert](http://developer.apple.com/library/ios/#samplecode/iPhoneACFileConvertTest/Listings/AudioConverterFileConvert_cpp.html#//apple_ref/doc/uid/DTS40010581-AudioConverterFileConvert_cpp-DontLinkElementID_3)

2.  [iPhoneExtAudioFileConvertTest](http://developer.apple.com/library/ios/#samplecode/iPhoneExtAudioFileConvertTest/Introduction/Intro.html#//apple_ref/doc/uid/DTS40009222)

我希望这可以帮助你...

# c# - 选择不同的只选择单列

> ID：13585095
> 
> 赞同：2
> 
> 时间：2012-11-27T13:17:22.410
> 
> 标签：c#, linq, distinct-values

基于这个问题：

[如何使用 LINQ 执行 SELECT UNIQUE？

我编写了以下表达式来从包含多列的数据表中选择具有唯一`OrganizationID`列的行。`dt`

```
var distinctRows = (from DataRow dRow in dt.Rows
                    select new { col1 = dRow["OrganizationID_int"] }).Distinct(); 
```

但是当我`distinctRows`在执行表达式后检查时，它只有 1 列 ( `col1`) 的记录，而不是保存整个列。我担心添加诸如`col2=...`等之类的表达式可能会被解释为我想在所有这些列上选择不同的。

那么，如何在仅对 1 列而不是整列应用唯一过滤器时获取整行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T13:52:47.430

> 我想要满足所有列的独特条件的整行。我想在下一步中迭代。

因此，您不想按该字段分组并返回多行之一。您只需要唯一的行。

一种方法是使用`Enumerable.GroupBy`并计算每组中的行数：

```
var uniqueRows = dt.AsEnumerable()
                   .GroupBy(r => r.Field<int>("OrganizationID_int"))
                   .Where(g => g.Count() == 1)
                   .Select(g => g.First()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:21:50.830

[Distinct](http://msdn.microsoft.com/en-us/library/bb338049.aspx)异常方法有两个版本，其中一个采用[IEqualityComparar](http://msdn.microsoft.com/en-us/library/system.collections.iequalitycomparer.aspx)可以确定您将如何区分不同的元素。

这里是如何使用此方法的完整示例：

```
class Item
{
    public int Id {get; set;}
    public string Name {get;set;}
}

class ItemComparer : IEqualityComparer<Item>
{
    public bool Equals(Item x, Item y)
    {
        return x.Id == y.Id;
    }

    public int GetHashCode(Item x)
    {
        return x.Id;
    }
}

void Main()
{
  var sequence = new List<Item>() 
  {
      new Item {Id = 1, Name = "1"}, 
      new Item {Id = 1, Name = "2"}
  };

  // Using overloaded version of Distinct method!
  var distinctSequence = sequence.Distinct(new ItemComparer());

  // distinctSequence contains inly one Item with Id = 1
  distinctSequence.Dump();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T13:22:59.550

您正在寻找的是`GroupBy`，然后是一个聚合函数，如`Min`,`Sum`等，为每列选择一个行值。

```
var distinctRows = 
    (from DataRow dRow in dt.Rows
    group dRow by dRow["OrganizationID_int"] into g
    select new { OrgId = g.Key; Col2 = g.First().Col2, Col3 = g.First().Col3 }) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T13:25:16.580

使用 Linq to DataSet 分组：

```
var distinctRows = from row in dt.AsEnumerable()
                   group row by new { 
                      col1 = row.Field<int>("OrganizationID_int")
                      // other columns here 
                   } into g
                   select g.First(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-27T13:25:38.453

看看*MoreLinq*的[`DistinctBy`方法](http://code.google.com/p/morelinq/source/browse/MoreLinq/DistinctBy.cs?r=d4396b9ff63932be0ab07c36452a481d20f96307)，你可以用它来表达你的查询，如下所示：

```
dt.Rows.DistinctBy(dRow => dRow["OrganizationID_int"]) 
```

# android - 创建小型、普通、大型和 xlarge android xml 布局

> ID：13585098
> 
> 赞同：0
> 
> 时间：2012-11-27T13:17:31.760
> 
> 标签：android, android-layout

我正在开发一个具有四个布局文件夹的 android 应用程序。每个 small、normal、large 和 xlarge 类别都有一个文件夹。

我正在使用带有最新 adt 更新的 eclipse juno。

我使用 LG LG-E400 进行小屏幕测试，HTC Sensation 和 Galaxy Note 用于普通测试，Galaxy Tab 10.1 用于 xlarge。

如何让 Eclipse 根据上面显示的四种屏幕尺寸显示准确的屏幕布局？

为什么当我打开我的正常屏幕布局之一时，eclipse pre select Nexus One 3.7" 480 x 720 hdpi 我的 htc 感觉报告它是高密度的正常屏幕尺寸，但是 eclipse 中显示的布局与它的外观完全不同我的实际手机。

我究竟做错了什么？

# php - 如何使用 php 通过 ip 地址获取用户语言？

> ID：13585100
> 
> 赞同：4
> 
> 时间：2012-11-27T13:17:34.600
> 
> 标签：php, ip-address

我需要使用 PHP 获取通过 IP 地址访问我网站的用户的语言。我该怎么做，有任何API可以做到这一点，请指教

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-01-07T14:12:35.177

按照之前的建议使用 GeoIP 模块，然后将此代码插入项目中的某处：

```
if($country = geoip_country_code_by_name($host))
{
    switch($country)
    {
        case "DJ":
        case "ER":
        case "ET":

            $lang = "aa";
            break;

        case "AE":
        case "BH":
        case "DZ":
        case "EG":
        case "IQ":
        case "JO":
        case "KW":
        case "LB":
        case "LY":
        case "MA":
        case "OM":
        case "QA":
        case "SA":
        case "SD":
        case "SY":
        case "TN":
        case "YE":

            $lang = "ar";
            break;

        case "AZ":

            $lang = "az";
            break;

        case "BY":

            $lang = "be";
            break;

        case "BG":

            $lang = "bg";
            break;

        case "BD":

            $lang = "bn";
            break;

        case "BA":

            $lang = "bs";
            break;

        case "CZ":

            $lang = "cs";
            break;

        case "DK":

            $lang = "da";
            break;

        case "AT":
        case "CH":
        case "DE":
        case "LU":

            $lang = "de";
            break;

        case "MV":

            $lang = "dv";
            break;

        case "BT":

            $lang = "dz";
            break;

        case "GR":

            $lang = "el";
            break;

        case "AG":
        case "AI":
        case "AQ":
        case "AS":
        case "AU":
        case "BB":
        case "BW":
        case "CA":
        case "GB":
        case "IE":
        case "KE":
        case "NG":
        case "NZ":
        case "PH":
        case "SG":
        case "US":
        case "ZA":
        case "ZM":
        case "ZW":

            $lang = "en";
            break;

        case "AD":
        case "AR":
        case "BO":
        case "CL":
        case "CO":
        case "CR":
        case "CU":
        case "DO":
        case "EC":
        case "ES":
        case "GT":
        case "HN":
        case "MX":
        case "NI":
        case "PA":
        case "PE":
        case "PR":
        case "PY":
        case "SV":
        case "UY":
        case "VE":

            $lang = "es";
            break;

        case "EE":

            $lang = "et";
            break;

        case "IR":

            $lang = "fa";
            break;

        case "FI":

            $lang = "fi";
            break;

        case "FO":

            $lang = "fo";
            break;

        case "BE":
        case "FR":
        case "SN":

            $lang = "fr";
            break;

        case "IL":

            $lang = "he";
            break;

        case "IN":

            $lang = "hi";
            break;

        case "HR":

            $lang = "hr";
            break;

        case "HT":

            $lang = "ht";
            break;

        case "HU":

            $lang = "hu";
            break;

        case "AM":

            $lang = "hy";
            break;

        case "ID":

            $lang = "id";
            break;

        case "IS":

            $lang = "is";
            break;

        case "IT":

            $lang = "it";
            break;

        case "JP":

            $lang = "ja";
            break;

        case "GE":

            $lang = "ka";
            break;

        case "KZ":

            $lang = "kk";
            break;

        case "GL":

            $lang = "kl";
            break;

        case "KH":

            $lang = "km";
            break;

        case "KR":

            $lang = "ko";
            break;

        case "KG":

            $lang = "ky";
            break;

        case "UG":

            $lang = "lg";
            break;

        case "LA":

            $lang = "lo";
            break;

        case "LT":

            $lang = "lt";
            break;

        case "LV":

            $lang = "lv";
            break;

        case "MG":

            $lang = "mg";
            break;

        case "MK":

            $lang = "mk";
            break;

        case "MN":

            $lang = "mn";
            break;

        case "MY":

            $lang = "ms";
            break;

        case "MT":

            $lang = "mt";
            break;

        case "MM":

            $lang = "my";
            break;

        case "NP":

            $lang = "ne";
            break;

        case "AW":
        case "NL":

            $lang = "nl";
            break;

        case "NO":

            $lang = "no";
            break;

        case "PL":

            $lang = "pl";
            break;

        case "AF":

            $lang = "ps";
            break;

        case "AO":
        case "BR":
        case "PT":

            $lang = "pt";
            break;

        case "RO":

            $lang = "ro";
            break;

        case "RU":
        case "UA":

            $lang = "ru";
            break;

        case "RW":

            $lang = "rw";
            break;

        case "AX":

            $lang = "se";
            break;

        case "SK":

            $lang = "sk";
            break;

        case "SI":

            $lang = "sl";
            break;

        case "SO":

            $lang = "so";
            break;

        case "AL":

            $lang = "sq";
            break;

        case "ME":
        case "RS":

            $lang = "sr";
            break;

        case "SE":

            $lang = "sv";
            break;

        case "TZ":

            $lang = "sw";
            break;

        case "LK":

            $lang = "ta";
            break;

        case "TJ":

            $lang = "tg";
            break;

        case "TH":

            $lang = "th";
            break;

        case "TM":

            $lang = "tk";
            break;

        case "CY":
        case "TR":

            $lang = "tr";
            break;

        case "PK":

            $lang = "ur";
            break;

        case "UZ":

            $lang = "uz";
            break;

        case "VN":

            $lang = "vi";
            break;

        case "CN":
        case "HK":
        case "TW":

            $lang = "zh";
            break;

        default:break;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T13:22:20.317

您可以使用任何 geoIP 模块。它允许您通过 IP 检测国家/地区。但这不是很正确的方法。例如我现在在泰国（我有泰国 IP），但我的语言是俄语 :)

当谷歌向我展示泰语页面时，这不是很好。

对于检测语言，您可以使用浏览器中的标题。首选语言列在此标题中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T13:23:14.793

虽然您可以查找 IP 地址以了解一般物理位置，但物理位置可能与您正在查找其 IP 地址的人的语言没有太大关系。

例如，虽然 IP 位置可能是美国的纽约地区，但该人可能会说普通话作为他们的主要语言，因为他们正在访问该地区。

这是一项可用于 IP 地址查找的服务[http://ipinfodb.com/ip_location_api.php](http://ipinfodb.com/ip_location_api.php)

这是一个 stackoverflow 讨论[Get user location by IP address in C#](https://stackoverflow.com/questions/4327629/get-user-location-by-ip-address)可能也有帮助。

但是，您需要提供一种允许更改语言选择的机制。并使用 cookie 或类似的东西来记住语言选择。

位置信息最常见的用途是提供更有可能对该位置的人有用的有针对性的广告。

**编辑：使用移动设备**

由于通过高速 3G 和 4G 蜂窝网络访问互联网的移动设备和智能手机变得越来越普遍，一个问题是 IP 地址地理定位是否适用于这些类型的设备。

简短的回答是，不太好。请参阅这篇文章，电话在哪里？： Microsoft Research[的 3G 网络上的 IP 地址地理定位。](http://research.microsoft.com/en-us/um/people/maheshba/papers/ephemera-imc09.pdf)

此外，这是一个[来自 HTTP 请求的关于手机位置的 stackoverflow 问题](https://stackoverflow.com/questions/2018514/is-it-possible-to-get-a-rough-mobile-phone-location-from-a-http-request/2625434#2625434)。

这是一篇文章，[在蜂窝数据网络中地理定位 IP 地址](http://pam2012.ftw.at/papers/PAM2012paper16.pdf)，它也提供了有关该问题的一些信息。

# python - 如何在 webapp2 中处理上传的文件

> ID：13585101
> 
> 赞同：8
> 
> 时间：2012-11-27T13:17:38.797
> 
> 标签：python, google-app-engine, webapp2

Google appengine 的 webapp2 有一个[关于处理上传文件的非常神秘的文档](http://webapp2.readthedocs.io/en/latest/guide/request.html#files)。

```
Uploaded files are available as cgi.FieldStorage (see the cgi module) instances directly in request.POST. 
```

我有一个表单，它发出我想要存储在 NDB.JsonProperty 中的 JSON 文件的 POST 请求。

谁能提供一个简短的例子来说明我如何从请求对象中读取文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-28T09:53:33.903

您可以`enctype="multipart/form-data"`在表单中使用，然后通过在处理程序中使用来获取文件内容：

```
raw_file = self.request.get('field_name') 
```

然后，将 raw_file 作为输入传递给模型的属性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-06-21T22:07:06.547

谷歌的文档简直糟透了。我花了大约两个小时试验 webapp2 的请求对象，终于找到了一种方法来做到这一点。

检查[https://stackoverflow.com/a/30969728/2310396](https://stackoverflow.com/a/30969728/2310396)。

基本代码片段在这里：

```
class UploadHandler(BaseHandler):
    def post(self):
        attachments = self.request.POST.getall('attachments')

        _attachments = [{'content': f.file.read(),
                         'filename': f.filename} for f in attachments] 
```

我们使用`self.request.POST.getall('attachments')`代替`self.request.POST.get('attachments')`，因为它们可能是`input`HTML 表单中具有相同名称的多个字段，所以如果您只使用`self.request.POST.get('attachments')`，您只会得到其中一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T17:24:30.423

而不是使用 cgi.FieldStorage 如何存储文件中描述的解决方案[？](https://stackoverflow.com/questions/6846333/how-does-cgi-fieldstorage-store-files)，我在表单中使用了 enctype="multipart/form-data" ，并且

在帖子的处理程序方法中，我通过以下方式访问了文件：

```
file_content = self.request.POST.multi['myfieldname'].file.read() 
```

有效！

# delphi - Delphi中的密码摘要SOAP

> ID：13585102
> 
> 赞同：2
> 
> 时间：2012-11-27T13:17:42.710
> 
> 标签：delphi, soap

有人在 Delphi XE2 中对此进行过编码吗？

```
Password_Digest = Base64 ( SHA-1 ( nonce + created + password ) ) 
```

计算消费 SOAP 服务的密码摘要。

谢谢。

# java - OCR 中的滑动窗口需要大量时间

> ID：13585104
> 
> 赞同：1
> 
> 时间：2012-11-27T13:17:44.007
> 
> 标签：java, machine-learning, artificial-intelligence, neural-network, ocr

我正在实施滑动窗口技术来开发照片 OCR，即从图片中剪切一个特定大小的矩形并检查它是否包含文本。然后矩形再次移动了一些像素。但是这种滑动窗口技术需要很多时间。例如，处理一张 1366x768 的图片需要 6 个小时，步长为 2，窗口大小为 20x25。是否有任何其他可能有用的技术或如何加快该过程？

我正在用java编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T13:34:41.903

在不了解您的算法/代码的任何细节的情况下，很难给出具体的建议。您可以考虑几个潜在的性能改进：

1.  最大限度地减少磁盘 I/O 和缓存未命中。你说一个矩形是“从图片中剪下来的”。如果每个“剪切”都是从磁盘单独读取，则效率非常低，并且会显着增加执行时间。当您移动窗口（移动 2 个像素）时，新窗口中的大部分数据都是相同的，因此请尽量避免重新读取该数据。
2.  减小窗口大小或增加步长。这显然会影响您的结果，但根据您尝试 OCR 的字符大小，它可能是一个选项。
3.  如果您正在应用卷积滤波器进行 OCR，请考虑通过图像数据的 2D FFT进行[快速卷积。](http://en.wikipedia.org/wiki/Convolution#Fast_convolution_algorithms)
4.  多线程您的应用程序，如果它还没有。虽然您的问题不是[令人尴尬的并行](http://en.wikipedia.org/wiki/Embarrassingly_parallel)，但它可能相当容易多线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T04:34:33.663

滑动窗口方法是蛮力的，因此从本质上来说非常缓慢。也许您应该看看基于显着性的技术，这些技术使用过滤器来优先处理要处理的图像区域。

这是我比较熟悉的一篇论文：B. Draper 和 A. Lionelle。“相似变换下选择性注意的评估”，视觉和图像理解，100:152-171，2005

最后，您使用的是什么 ANN 库？确保您的 ANN 代码正在执行矩阵/向量运算，并且它们已尽可能优化！

# mysql - 获取第一次登录的每个日期的计数

> ID：13585111
> 
> 赞同：1
> 
> 时间：2012-11-27T13:18:09.103
> 
> 标签：mysql, sql, count, distinct

我有一个表，其中包含一个 Web 应用程序的日志记录，它跟踪人们何时登录。我的表的一个示例是：

```
| user_id | date_time        |
+---------+------------------+
|    0033 | 2012-11-22 10:33 | <- first login of 0033 on 2012-11-22
|    0034 | 2012-11-22 10:38 | <- first login of 0034 on 2012-11-22
|    0052 | 2012-11-22 10:43 | <- first login of 0052 on 2012-11-22
|    0052 | 2012-11-23 09:23 |
|    0066 | 2012-11-23 15:58 | <- first login of 0066 on 2012-11-23
|    0033 | 2012-11-23 16:14 | 
```

我想要的是一个表格，其中包含每个日期第一次登录的人数，即：

```
| count | date       |
+-------+------------+
|     3 | 2012-11-22 | <- there were 3 users that logged in for the first time on 2012-11-22
|     1 | 2012-11-23 | 
```

我知道我只能通过做得到日期

```
SELECT DATE(`date_time`) AS `date`
FROM `logging`
GROUP BY `date`
ORDER BY `date` ASC 
```

我想在一个查询中获得第二个表，我知道这是可能的，我只是不知道如何。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:28:59.730

您可以使用不相关的子查询来获取每个用户的首次登录日期，然后将这些日期组合在一起以获得每天的首次登录次数。

```
SELECT dd, COUNT(*)
FROM (SELECT MIN(DATE(`date_time`)) AS dd
    FROM `logging`
    GROUP BY `user_id`) a
GROUP BY dd
ORDER BY dd; 
```

[`Demo`](http://www.sqlfiddle.com/#!2/bb004/2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:30:22.263

统计每天的登录次数，对于之前没有登录记录的 user_ids：

```
select  DATE(`date_time`) as `date`,
        count(user_id)
from    `logging` l1
where   user_id not in (
        select user_id from `logging` l2 where l1.user_id = l2.user_id and l2.date_time < l1.date_time)
group by DATE(`date_time`) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-27T13:20:48.650

我认为你需要这个：

```
SELECT count(1) ,
       DATE(`date_time`) 
from my_table
group by DATE(`date_time`) 
```

如果您需要每天登录的用户

```
Select 

user_id, `date_time` from my_table group by DATE(`date_time`), user_id 
```

# javascript - 如何进行 jQuery http -> https AJAX 请求

> ID：13585112
> 
> 赞同：0
> 
> 时间：2012-11-27T13:18:11.450
> 
> 标签：javascript, jquery, apache, http-headers, cross-domain

我知道到目前为止已经讨论过很多次，但我无法让它发挥作用：/我做错了什么？目标页面在独立打开时可以正常工作。看一下截图：

![在此处输入图像描述](../Images/de917bbd3fd658d8af55f4418868e827.png)

模糊的 IP 到处都是一样的响应是空的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:23:17.477

您违反了[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)。

如果您必须跨域（从 HTTP -> HTTPS 算作），则需要发出`JSONP`请求。

# php - PHP中条件的奇怪行为

> ID：13585115
> 
> 赞同：1
> 
> 时间：2012-11-27T13:18:25.803
> 
> 标签：php, if-statement, behavior

我想知道为什么会输出以下代码：

```
$a = log(5, 5);
$b = round(log(5, 5));
echo 'a: ';
var_dump($a);
echo '<br>';
echo 'b: ';
var_dump($b);
echo '<br>';
echo ($a == $b) ? 'equal' : 'not equal'; 
```

这个

```
a: float(1) 
b: float(1) 
not equal 
```

感谢任何可以向我解释这一点的人。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T13:21:06.387

仅引用PHP 手册中 的[**浮点数一章：**](http://www.php.net/manual/en/language.types.float.php)

> 警告浮点精度
> 
> 浮点数的精度有限。尽管取决于系统，但 PHP 通常使用 IEEE 754 双精度格式，由于在 1.11e-16 的数量级四舍五入，这将给出最大的相对误差。非初等算术运算可能会产生较大的误差，当然，当多个运算复合时，必须考虑误差传播。
> 
> 此外，可以精确表示为以 10 为底的浮点数的有理数，如 0.1 或 0.7，没有精确表示为以 2 为底的浮点数，无论尾数大小如何，它都在内部使用。因此，它们不能被转换成它们内部的二进制对应物，而不会有小的精度损失。这可能会导致令人困惑的结果：例如， floor((0.1+0.7)*10) 通常会返回 7 而不是预期的 8，因为内部表示将类似于 7.9999999999999991118...。
> 
> **所以永远不要相信浮点数结果到最后一位，也不要直接比较浮点数是否相等。**如果需要更高的精度，可以使用任意精度的数学函数和 gmp 函数。

# iphone - Iphone-SBJson 为在多个请求发送中获得延迟响应的连接返回 null responseData

> ID：13585119
> 
> 赞同：0
> 
> 时间：2012-11-27T13:18:41.807
> 
> 标签：iphone, ios, json, ipad, sbjson

[在这里，我尝试使用SBJson 框架](http://stig.github.com/json-framework/)向 python 服务器发送异步调用。对于具有相同请求的连续多次调用，`null`在响应字符串中给出值。

在这里，我尝试了什么：

```
- (NSURLConnection *) GetHttpConnection:(NSString *)Path:(NSDictionary *)requestData:(UIView *)appView {
    NSString *jsonReq = nil;
    NSData *reqData = nil;

    if (requestData != nil) {
        jsonReq = [requestData JSONRepresentation];
        reqData=[NSData dataWithBytes:[jsonReq UTF8String] length:[jsonReq length]];
    }
    NSString *urlString = [NSString stringWithFormat:@"%@/%@", URL, Path];
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:urlString]];
    [request setValue:@"application/json" forHTTPHeaderField:@"Accept"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
    if (reqData) {
        [request setHTTPBody:reqData];
    }
    [request setHTTPMethod:@"POST"];
    NSURLConnection *connection = [[NSURLConnection alloc]initWithRequest:request delegate:self];
    if (connection) {
        responseData = [[NSMutableData data] retain];
    }
    return connection;
 }

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    [connection release];
    NSString *responseString = [[NSString alloc] initWithData:responseData encoding:NSUTF8StringEncoding];
    NSLog(@"Connection Finish Loading >>>>> %@",responseString);    
    responseData = nil;
    if (responseString && [responseString JSONValue] != nil) {
       // process response string and send response back to delegate method
    }
  }

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSMutableData*)data {
    [responseData appendData:data];
} 
```

在跟踪`NSlog`响应后，我发现了这一点，如果我发送相同的请求 3 次（按更新详细信息按钮） `connectionDidFinishLoading`应该调用 3 次并且它正在调用它。但是对于任何（一个）请求，相应的响应数据都会返回`null`。这就是为什么 JSON 如下所述

> **JSONValue 失败。错误跟踪是：（“错误域 = org.brautaset.JSON.ErrorDomain 代码 = 11 \“字符串意外结束\” UserInfo = 0x909d4b0 {NSLocalizedDescription =字符串意外结束}”**

我该如何克服这种情况？或者代码有什么问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T15:01:21.343

您的课程不可重入，因为只有一个对 responseData 的引用。如果两个请求同时运行，就会发生坏事。为此，您需要将您的 requestData 放入由 NSURLConnection 键入的字典中，或者为每个请求创建另一个下载器实例。

# dns - 多租户 DNS 设置 - 如何？

> ID：13585120
> 
> 赞同：2
> 
> 时间：2012-11-27T13:18:41.573
> 
> 标签：dns, automation, multi-tenant

很抱歉这个完全是新手的问题，但我似乎真的不明白如何做到这一点。

您能否为托管的多租户应用程序自动创建子域？例如，一个新客户注册并指定选择的子域。user1.mysite.com。

如何自动创建子域并让它指向我的应用程序的单个实例？如果是，您将如何做这件事？任何样本或链接将不胜感激。

谢谢你

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-28T07:24:39.413

您不创建子域，而是创建通配符 DNS 记录。

```
*.mysite.com A 1.2.3.4 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-28T10:48:06.707

如果您拥有该域，则可以在域提供商的配置页面中手动创建子域。提供商必须为您配置子域（输入子域和 IP 映射到 DNS 服务器）。这可能会延迟几个小时。之后，您可以使用 . [在此处](http://content.websitegear.com/article/subdomain_setup.htm)查看更多详细信息。

# twitter-bootstrap - 如何在 YII 中使用 Twitter Bootstrap 将装订线大小减少到零？

> ID：13585121
> 
> 赞同：0
> 
> 时间：2012-11-27T13:18:41.200
> 
> 标签：twitter-bootstrap, yii

我正在使用这个扩展：[Yii-Bootstrap](http://www.yiiframework.com/extension/bootstrap/)，以及这个 less 扩展：[less](http://www.yiiframework.com/extension/less)

在我的 main.php 配置文件中，我有：

```
'components'=>array(
  'less'=>array(
    'class'=>'ext.less.components.LessCompiler',
    'forceCompile'=>true, // indicates whether to force compiling
    //'compress'=>false, // indicates whether to compress compiled CSS
    //'debug'=>false, // indicates whether to enable compiler debugging mode
    'paths'=>array(
      'less/style.less'=>'css/style.css',
    ),
  ),
  'bootstrap'=>array(
      'class'=>'ext.bootstrap.components.Bootstrap',
      'responsiveCss'=>true,
  ), 
```

自举的好处是有效的。我的问题是我正在尝试修改 protected\extensions\bootstrap\lib\bootstrap\less\variables.less 中的变量：

```
@gridGutterWidth:         0px;
@gridGutterWidth1200:     0px;
@gridGutterWidth768:      0px; 
```

但是，即使我直接编辑 variables.less，这些更改也不会反映在网站的任何地方。这让我相信这不是变量。除非我必须编辑。

知道如何改变排水沟吗？

更新：我能够编辑以下文件并查看更改：

```
protected\extensions\bootstrap\assets\css\bootstrap-responsive.css 
```

我变了：

```
[class*="span"] {
  float: left;
  min-height: 1px;
  margin-left: 30px;
} 
```

至：

```
[class*="span"] {
  float: left;
  min-height: 1px;
  margin-left: 0px;
} 
```

这现在消除了排水沟。但并不能完全解决我的问题。我希望这一切都通过 YII 和 LESS 动态发生。我怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T15:34:05.023

解决方案是将 responsiveCss 设置为 false：

```
'bootstrap'=>array(
  'class'=>'ext.bootstrap.components.Bootstrap',
  'responsiveCss'=> false,
), 
```

然后将我的 style.less 文件更改为包括：

```
// Import the Bootstrap mixins, operations and functions so that you can use them in this file.
@import "../protected/extensions/bootstrap/lib/bootstrap/less/mixins.less";
@import "../protected/extensions/bootstrap/lib/bootstrap/less/variables.less";
@import "../protected/extensions/bootstrap/lib/bootstrap/less/scaffolding.less";
@import "../protected/extensions/bootstrap/lib/bootstrap/less/responsive.less"; 
```

混乱来自“responsiveCss”，没有清楚地解释（任何地方）。基本上，这将从 protected\extensions\bootstrap\assets\css\ 复制 css 文件并将其包含到您的文件中，无需修改。我在上面提到的是如何从“标准”版本转移到这种“可定制”的方式。

希望对某人有所帮助，因为它浪费了我很多时间，更不用说我现在必须花时间重做 css 了。

# objective-c - 从较长的 NSString 返回一个自动换行的 NSString

> ID：13585126
> 
> 赞同：11
> 
> 时间：2012-11-27T13:19:00.983
> 
> 标签：objective-c, ios, xcode, nsstring, word-wrap

> **可能重复：**
> [UITextView ：获取带有换行信息的文本](https://stackoverflow.com/questions/7645028/uitextview-get-text-with-wrap-info)

我一直在寻找 NSString 库和众多库中的一个函数，该函数可以采用这样的长字符串：

```
Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo. Quisque sit amet est et sapien ullamcorper pharetra. Vestibulum erat wisi, condimentum sed, commodo vitae, ornare sit amet, wisi. Aenean fermentum, elit eget tincidunt condimentum, eros ipsum rutrum orci, sagittis tempus lacus enim ac dui. 
```

并与指示宽度的 CGSize 或浮点数以及正在使用的字体一起返回给我一个带有 \n 中断和换行的字符串。

结果（大致）：

```
Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac\n
egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet.\n
 Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. \n
placerat eleifend leo. Quisque sit amet est et sapien ullamcorper pharetra.\n
 Vestibulum erat wisi, condimentum sed, commodo vitae, ornare sit amet, wisi.\n
 Aenean fermentum, elit eget tincidunt condimentum, eros ipsum rutrum orci,\n
 sagittis tempus lacus enim ac dui. 
```

我已经知道 UITextViews 等这样做，但这没有帮助，因为我需要在原始 OpenGL 环境中呈现文本，所以我没有使用常规 UI 元素。

我知道这要么作为框架存在，要么作为某个公共类存在。我只是找不到任何统一的方法来处理这个问题。

我想它接近 [NSString sizeWithFont:forWidth:lineBreakMode:]，但我不需要大小，我需要字符串本身。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-27T16:10:40.570

确实没有必要重新发明这个轮子，因为它正是文本引擎每次包装文本时为您所做的。什么*是*文本引擎？它是核心文本。如果您下拉到 Core Text 级别并让 CTFramesetter 为您布置文本，您可以通过询问生成的 CTLines 来了解它在哪里放置换行符。

该文档将帮助您入门：

[http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/CoreText_Programming/Operations/Operations.html](http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/CoreText_Programming/Operations/Operations.html)

网上有很多很好的教程。

简单的例子：

```
NSString* s = @"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do "
@"eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut "
@"enim ad minim veniam, quis nostrud exercitation ullamco laboris "
@"nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor "
@"in reprehenderit in voluptate velit esse cillum dolore eu fugiat "
@"nulla pariatur. Excepteur sint occaecat cupidatat non proident, "
@"sunt in culpa qui officia deserunt mollit.";
NSAttributedString* text = [[NSAttributedString alloc] initWithString:s];

CTFramesetterRef fs =
CTFramesetterCreateWithAttributedString((__bridge CFAttributedStringRef)text);
CGMutablePathRef path = CGPathCreateMutable();
CGPathAddRect(path, NULL, CGRectMake(0,0,200,100000));
CTFrameRef f = CTFramesetterCreateFrame(fs, CFRangeMake(0, 0), path, NULL);
CTFrameDraw(f, NULL);

NSArray* lines = (__bridge NSArray*)CTFrameGetLines(f);
for (id aLine in lines) {
    CTLineRef theLine = (__bridge CTLineRef)aLine;
    CFRange range = CTLineGetStringRange(theLine);
    NSLog(@"%ld %ld", range.location, range.length);
}
CGPathRelease(path);
CFRelease(f);
CFRelease(fs); 
```

正如您将看到的，输出显示了每行换行文本的范围。这不是你追求的那种东西吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T14:12:33.683

似乎没有工厂方法可以做到这一点，所以已经开始构建一个类函数来处理这个问题，基于[这个密切相关的堆栈](https://stackoverflow.com/q/7645028/598857)中引入的解决方案：

```
+ (NSString*)wrappedString:(NSString*)string withFont:(UIFont*)font andWidth:(float)width {
    NSMutableString *resultString = [[NSMutableString alloc] initWithString:@""];

    CGSize textSize = [string sizeWithFont:font];
    float textWidth = textSize.width;
    if (textWidth < width) {
        return string;
    }
    float wordLength;
    float lineLength;
    NSUInteger length = [string length];
    unichar buffer[length];
    [string getCharacters:buffer range:NSMakeRange(0, length)];

    NSString *singleLine = @"";
    NSString *word = @"";
    NSString *longWord = @"";

    for (NSUInteger i = 0; i < length; i++) {

        unichar character = buffer[i];
        if (character != '\n') {
            word = [NSString stringWithFormat:@"%@%c", word, character];
        }

        if (character == '\n') {
            float wordLength = [word sizeWithFont:font].width;
            float lineLength = [singleLine sizeWithFont:font].width;
            if ((lineLength + wordLength) > width) {
                [resultString appendString:singleLine];
                [resultString appendString:@"\n"];
                singleLine = @"";
                singleLine = [singleLine stringByAppendingFormat:@"%@\n",word];
                word = @"";
            } else {
                singleLine = [singleLine stringByAppendingString: word];
                word = @"";
                [resultString appendString:singleLine];
                [resultString appendString:@"\n"];
                singleLine = @"";
            }
        }

        else if (character == ' ') {
            float wordLength = [word sizeWithFont:font].width;
            float lineLength = [singleLine sizeWithFont:font].width;

            if ((lineLength + wordLength) > width) {
                if (wordLength > textWidth) {
                    [resultString appendString:singleLine];
                    [resultString appendString:@"\n"];
                    singleLine = @"";
                    int j = 0;
                    for (; j < [word length]; j++) {
                        unichar longChar = [word characterAtIndex:j];
                        longWord = [NSString stringWithFormat:@"%@%c", longWord, longChar];
                        float longwordLength = [longWord sizeWithFont:font].width;
                        float longlineLength = [singleLine sizeWithFont:font].width;
                        if ((longlineLength + longwordLength) >= width) {
                            singleLine = [singleLine stringByAppendingString:longWord];
                            word = @"";
                            longWord = @"";
                            break;
                        }
                    }

                }
                [resultString appendString:singleLine];
                [resultString appendString:@"\n"];
                singleLine = @"";
            }
            singleLine = [singleLine stringByAppendingString: word];
            word = @"";
        }
    }

    wordLength = [word sizeWithFont:font].width;
    lineLength = [singleLine sizeWithFont:font].width;

    if (wordLength > 0) {
        if ((lineLength + wordLength) > width) {
            [resultString appendString:singleLine];
            [resultString appendString:@"\n"];
            singleLine = @"";
        }
        singleLine = [singleLine stringByAppendingString:word];
    }

    if (lineLength > 0) {
        [resultString appendString:singleLine];
        [resultString appendString:@"\n"];
    }
    return resultString;
} 
```

# php - SOAP 请求处理大数据的时间过长

> ID：13585127
> 
> 赞同：5
> 
> 时间：2012-11-27T13:19:06.247
> 
> 标签：php, arrays, soap

我从其他网站获得了一个帮助 SOAP 客户端的数组，这是一个很大的数组，你可以[在](http://b2b.alta.ge/david/test3.php)这里查看**简短版本**

我需要获取类别名称，我的代码在这里，它可以工作但会减慢网站速度。如果有人可以提供更好的代码。

```
$client = new nusoap_client('http://87.253.63.146/b2b/b2bWS?WSDL', 'wsdl');
$client->soap_defencoding = 'UTF-8';
$client->decode_utf8 = false;
$parametrebi = array('user' => '','brand' => '', 'vat_zone' => 'GEVAT', 'currency' => 'GEL', 'all_items' => 'Y', 'page_num' => '1', 'lines_per_page' => '25');

$result = $client->call('GetPriceList', $parametrebi, array('return' => 'xsd:string'), "");
foreach($result['PriceList']['categories']['category'] as $category)
{
    echo '<option value="'.$category['!id'].'">'.$category['!name'].'</option>';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:48:05.030

类别经常变化吗？
你不能经常轮询这些类别吗？

例如，每 5 分钟左右进行一次soap 调用，然后将类别保存到数据库中的表（不是一个好主意）或内存缓存中。

[http://memcached.org/](http://memcached.org/)

如果您可以使用 memcache ...这是一个 ruff 示例：

```
$memcache_obj = new Memcache();
$memcache_obj->connect('memcache_host', 11211);

if(!$categories = $memcache_obj->get('soap_categories')) {
 $client = new nusoap_client('http://87.253.63.146/b2b/b2bWS?WSDL', 'wsdl');
 $client->soap_defencoding = 'UTF-8';
 $client->decode_utf8 = false;
 $parametrebi = array('user' => '','brand' => '', 'vat_zone' => 'GEVAT', 'currency' => 'GEL',    'all_items' => 'Y', 'page_num' => '1', 'lines_per_page' => '25');
 $result = $client->call('GetPriceList', $parametrebi, array('return' => 'xsd:string'), "");
 $categories = $result['PriceList']['categories']['category'];
 $memcache_obj->set('soap_categories', $categories)
}

foreach($categories as $category)
{
    echo '<option value="'.$category['!id'].'">'.$category['!name'].'</option>';
} 
```

您可以将 memcache 上的过期时间设置为 1,2,5...等分钟，这样每次缓存过期时都会更新类别。否则，当缓存过期时，查找时间将少于 5-10 毫秒。

# php - 如何通过键对多维数组进行排序

> ID：13585128
> 
> 赞同：0
> 
> 时间：2012-11-27T13:19:09.000
> 
> 标签：php

```
Array
(
    [12] => Array
        (
            [id] => 12
            [name] => Car
            [children] => Array
                (
                    [0] => Array
                        (
                            [id] => 14
                            [name] => Volvo
                        )

                    [1] => Array
                        (
                            [id] => 15
                            [name] => Mercedes-Benz
                        )

                )

        )

    [13] => Array
        (
            [id] => 13
            [name] => Manga
            [children] => Array
                (
                    [0] => Array
                        (
                            [id] => 16
                            [name] => Naruto
                        )

                    [1] => Array
                        (
                            [id] => 17
                            [name] => Hunter X Hunter
                        )

                )

        )

    [18] => Array
        (
            [id] => 18
            [name] => aa
            [children] => Array
                (
                )

        )

) 
```

伙计们，我想对该数组的值进行排序，我想按键对其进行排序，键是“名称”。这应该通过键“名称”对第一级和第二级进行排序。

我放入的这个数组`print_r()`看起来像这样。该数组未修复，因此我可以在将来添加。

所以排序后数组的最终值是......

```
Array
(

    [18] => Array
        (
            [id] => 18
            [name] => aa
            [children] => Array
                (
                )

        )

    [12] => Array
        (
            [id] => 12
            [name] => Car
            [children] => Array
                (
            [0] => Array
                        (
                            [id] => 15
                            [name] => Mercedes-Benz
                        )

                    [1] => Array
                        (
                            [id] => 14
                            [name] => Volvo
                        )

            )

        )

    [13] => Array
        (
            [id] => 13
            [name] => Manga
            [children] => Array
                (
            [0] => Array
                        (
                            [id] => 17
                            [name] => Hunter X Hunter
                        )

                    [1] => Array
                        (
                            [id] => 16
                            [name] => Naruto
                        )

                )

        )
) 
```

这是代码中的数组。

```
$categories = array(
                12 => 
                    array('id' =>12, 
                              'name' => 'Car',
                                       'children' => 
                                        array(
                                            array('id' => 14,
                                                      'name' => 'volvo'
                                            )
                                        ),
                                        array(
                                            array('id' => 15,
                                                      'name' => 'Mercedez-Benz'
                                            )
                                        )
                            ),

                13 => 
                    array('id' =>13, 
                              'name' => 'Manga',
                                       'children' => 
                                        array(
                                            array('id' => 16,
                                                      'name' => 'Naruto'
                                            )
                                        ),
                                        array(
                                            array('id' => 17,
                                                      'name' => 'Hunter X Hunter'
                                            )
                                        )
                            ),

                18=>
                    array('id' => 18, 
                              'name'=> 'aa', 
                                      'children' => array())

                );

echo "<pre>";

print_r($categories); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:10:19.843

所以，

我会尝试更好地向你解释

你的数组很大，是的，但你只想对键值'[name]'进行排序。在我的测试中，我使用了您提供的数组：

```
$categories = array(
            12 => 
                array('id' =>12, 
                          'name' => 'Car',
                                   'children' => 
                                    array(
                                        array('id' => 14,
                                                  'name' => 'volvo'
                                        )
                                    ),
                                    array(
                                        array('id' => 15,
                                                  'name' => 'Mercedez-Benz'
                                        )
                                    )
                        ),

            13 => 
                array('id' =>13, 
                          'name' => 'Manga',
                                   'children' => 
                                    array(
                                        array('id' => 16,
                                                  'name' => 'Naruto'
                                        )
                                    ),
                                    array(
                                        array('id' => 17,
                                                  'name' => 'Hunter X Hunter'
                                        )
                                    )
                        ),

            18=>
                array('id' => 18, 
                          'name'=> 'aa', 
                                  'children' => array())

            ); 
```

如果声明了数组，则可以像这样添加 usort：

```
usort($categories,"sortByName"); 
```

上面的第一个元素 ($categories) 是您的数组，第二个元素将提供函数的名称，在本例中为“sortByName”。

之后，您只需将一个函数添加到您的代码中（放置它的位置并不重要，即使它位于页面底部）：

```
function sortByName($categories, $b) {
    return strcasecmp($categories["name"], $b["name"]);
} 
```

基本上这个函数的作用是将你的数组与......你的数组进行比较:)，这样它就可以按名称对它进行排序 - 就像你想要的那样。sthe 'strcasecmp' 是将你的字符串与彼此进行比较以对其进行排序。并不是说这是不区分大小写的（strcmp 也会区分大小写）。我假设您不希望它也检查大写等等，否则结果将不是您想要的。

当您添加该代码时，您可以再次打印您的数组：

```
echo "<pre>";
print_r($categories); 
```

你的结果将是：

```
Array
(
[0] => Array
    (
        [id] => 18
        [name] => aa
        [children] => Array
            (
            )

    )

[1] => Array
    (
        [id] => 12
        [name] => Car
        [children] => Array
            (
                [0] => Array
                    (
                        [id] => 14
                        [name] => volvo
                    )

            )

        [0] => Array
            (
                [0] => Array
                    (
                        [id] => 15
                        [name] => Mercedez-Benz
                    )

            )

    )

[2] => Array
    (
        [id] => 13
        [name] => Manga
        [children] => Array
            (
                [0] => Array
                    (
                        [id] => 16
                        [name] => Naruto
                    )

            )

        [0] => Array
            (
                [0] => Array
                    (
                        [id] => 17
                        [name] => Hunter X Hunter
                    )

            )

    ) 
```

我希望这是你想要的。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:26:44.857

'name' 不是你真正的'Key'，只是说，因为 Php 中的'key' 通常表示你的数组的名称，如数组中的 '18' 和 '12' 等等，如下所示：

```
<?php
    $fruits = array("d"=>"lemon", "a"=>"orange", "b"=>"banana", "c"=>"apple");
    ksort($fruits);
    foreach ($fruits as $key => $val) {
        echo "$key = $val\n";
    }
?> 
```

在此示例中，结果将是：

```
a = orange
b = banana
c = apple
d = lemon 
```

无论如何，要回答您关于如何按“名称”对其进行排序的问题，请使用“usort”：

```
function cmp($a, $b) {
   return $a['name'] - $b['name'];
}

usort($arr,"cmp"); 
```

查看以下链接以获取更多信息： [如何按嵌套在其中的元素对 PHP 数组进行排序？](https://stackoverflow.com/questions/3701855/how-do-i-sort-a-php-array-by-an-element-nested-inside)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T13:28:51.130

如果使用 php 5.3+，您可以在代码中使用闭包并像这样排序

```
usort($categories,function($a,$b){
    return $a['name'] - $b['name']
} 
```

# terminal - vt100终端仿真器中的键盘传输模式

> ID：13585131
> 
> 赞同：1
> 
> 时间：2012-11-27T13:19:11.523
> 
> 标签：terminal, vt100

我正在用 javascript 实现一个 vt100 终端仿真器，vt100 规范（来自`man terminfo`and `infocmp`）告诉我这`smkx=\E[?1h\E=`是进入键盘传输模式`rmkx=\E[?1l\E>`的代码，也是离开“键盘传输”模式的代码。我真的不明白什么是键盘传输模式。

来自[http://vt100.net/dec/ek-vt220-tm-001.pdf](http://vt100.net/dec/ek-vt220-tm-001.pdf)，

> **7.4.4.1 键盘传输模式**——键盘代码和其他一些特殊代码通过8051的PORT中的串行线输出传输。传输的信号通过键盘电缆、显示器和视频电缆从8051到驱动器到 CPU。8051 内部的 UART 控制传输"

我分别在进入和离开时得到这些代码`vim`。我可以安全地忽略这些代码还是需要处理它们？在后一种情况下，我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T15:05:55.260

这两个字符串分别包含两个序列；他们控制着微妙的不同事物：

其中第一个，

```
CSI ? 1h
CSI ? 1l 
```

控制 DEC 私有模式编号 1 `DECCKM`、、光标键模式。此模式确定四个箭头键（上、下、左、右）是否将发送 SS3 或 CSI 前缀序列。

第二对序列，

```
ESC =
ESC > 
```

被称为`DECKPAM`小键盘应用模式和`DECKPNM`小键盘数字模式。这决定了数字键盘是发送控制序列还是普通数字（即认为它类似于 Numlock 功能）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T15:03:06.157

smkx/rmkx 控制键盘是否传输数字或转义码。此外，它是“键盘传输模式”而不是“键盘传输模式”

# c - 如何检查我是否正确实现了 C 库函数？

> ID：13585134
> 
> 赞同：2
> 
> 时间：2012-11-27T13:19:18.087
> 
> 标签：c, libc

是否有基本 C 库函数（如 、 等）的源/`strcmp`数据库`memset`？
我想实现基本的 C 库函数，但我无法验证我是否做对了。

我找到了几个源代码数据库，但它们比应有的复杂得多（例如，实现`strcpy`超过 30 行，其中一半与复制字符串无关，我认为）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T18:25:00.850

PJ Plauger有一本很棒的书[The Standard C Library](https://rads.stackoverflow.com/amzn/click/com/0131315099 "标准 C 库")。它有点过时（1992 年），但如果您想实现 libc 并正确执行，它仍然是宝贵的资源。它包含库的完整代码。还有[musl libc](http://www.musl-libc.org/ "音乐库")。代码位于 git repo 中。实现并不简单，但如果我将它与其他实现进行比较，它真的很小而且很简单。正如其他人已经提到的那样，C 标准是您想要查看的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:25:46.933

“基本”C 库函数也是对程序性能和正确性最重要的一些函数，因此往往具有一些复杂的实现。

我建议您查看[Newlib](http://sourceware.org/newlib/)的代码。它是一个用于嵌入式系统的基本 C 库（您的电视可能会很好地运行它），它也用于 Cygwin。该许可证还与出于您自己的目的的“借用”源代码大部分兼容，但要小心，因为它的某些位（某些文件）是 GPL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T13:34:28.717

查看[OpenBSD C 库](http://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/)。例如，这是它的基本内容[`strcpy`](http://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/string/strcpy.c?rev=1.8)：

```
char *
strcpy(char *to, const char *from)
{
    char *save = to;

    for (; (*to = *from) != '\0'; ++from, ++to);
        return(save);
} 
```

函数的文档以联机帮助页的形式包含。

（它还带有常用例程的[优化版本](http://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/arch/)，通常在汇编程序中，因此 C 版本应该被视为参考实现。）

# uiview - iOS/iPhone：UIView 不为 NSMutableArray 添加元素（包含 UILabel 对象）

> ID：13585137
> 
> 赞同：0
> 
> 时间：2012-11-27T13:19:43.690
> 
> 标签：uiview, nsmutablearray, uilabel

我有一个**UIView**，我在其中编写了以下方法：

```
- (void)drawLabels:(NSMutableArray*)labelArray{
  for (int i=0; i<[labelArray count]; i++) {        
    CGRect labelFrame = CGRectMake(0, 0, 50, 50);
    labelFrame = CGRectInset(labelFrame, 5, 5);
    UILabel *label = (UILabel*)[labelArray objectAtIndex:i];
    [self addSubview:label]; 
```

}

代码崩溃并出现以下错误：

> -[UIDeviceRGBColor superview]：无法识别的选择器发送到实例 0x6e397c0 2012-11-27 18:37:33.559 QuartzSample[57621:f803] *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：'-[UIDeviceRGBColor superview]：无法识别的选择器sent to instance 0x6e397c0' *** First throw call stack: (0x13cf022 0x1560cd6 0x13d0cbd 0x1335ed0 0x1335cb2 0x55e4f 0x5014b 0x4398 0x38a1 0xe0a1e 0x3f401 0x3f670 0x3f836 0x4672a 0x292b 0x17386 0x18274 0x27183 0x27c38 0x1b634 0x12b9ef5 0x13a3195 0x1307ff2 0x13068da 0x1305d84 0x1305c9b 0x17c65 0x19626 0x2632 0x25a5) terminate called throwing an exception(lldb )

我希望将标签放置在具有所有格式（颜色、字体、大小等）的视图上。另外，当我输入以下代码时：

```
NSLog(@"%@",[labelArray objectAtIndex:i]); 
```

我在控制台中得到以下信息： **UIDeviceRGBColorSpace 0 1 0 0.3**

有人可以详细说明吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T13:13:42.863

1.  看来你是设置`labelFrame`，但你没有使用它。
2.  在使用 addSubView 之前，确保`label`不是`nil`
3.  通过as 参数配置`UILabel`使用`setFont:`方法的字体和大小`UIFont`
4.  配置作为参数`.textColor`传递的颜色使用属性`UIColor`

# c++ - 包括 iostream 错误

> ID：13585138
> 
> 赞同：-1
> 
> 时间：2012-11-27T13:19:44.110
> 
> 标签：c++, objective-c

我有一个问题，我找不到解决方案，所以我在这里问:)

我想使用 Xcode-->Mac-->New-->Command Line Tool-->Foundation 创建一个基于 Foundation 的终端应用程序/脚本

这一切正常，但是我想将 header.h 文件添加到我的项目中。此 header.h 文件之一执行以下操作：

```
#include <iostream> 
```

这失败并出现错误：找不到 iostream 文件。

对于测试，我制作了一个新的基于 c++ 的 terminla 脚本，它的作用完全相同：

```
#include <iostream> 
```

但由于某些未知原因，它不会因错误而失败。谁能告诉我，为什么 c++ 脚本可以包含而目标 c 不能？

目标 c: .h 文件 c++: .cpp 文件我将 .h 重命名为 .cpp 但后来它没有找到 NSString 和类似的东西.. 任何使用 iostream 和目标 c 的解决方案？

真的很需要，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:23:06.560

如果您想在同一个源模块中同时使用 Objective-C 和 C++（称为 Objective-C++），请使用`.mm`文件扩展名。

# database - 将字段添加到 App Engine 托管的数据库

> ID：13585143
> 
> 赞同：2
> 
> 时间：2012-11-27T13:20:01.497
> 
> 标签：database, web-services, google-app-engine, datastore, gql

我目前正在开发一个使用 Google App Engine 托管的网络服务的移动应用程序。

但我面临一个问题。我只想在我的数据库表中添加一个字段。App Engine 不使用经典的 SQL 语法，而是使用 GQL。所以我不能使用 ALTER TABLE 语句。我怎么能用 GQL 做到这一点？我在网上寻找解决方案，但没有太多帮助。

```
public MyEntity() {
}

@Id
@GeneratedValue(strategy=GenerationType.IDENTITY)
private Key idStation;
private String name;
private double longitude;
private double latitude;
private java.util.Date dateRefresh = new Date(); //the field i want to add in DB 
```

所以，现在当我创建一个“MyEntity”对象时，它应该将“dateRefresh”字段添加到数据库中......我创建我的对象是这样的：

```
MyEntity station = new MyEntity();
station.setName("test");
station.setLatitude(0);
station.setLongitude(0);
station.setDateRefresh(new Date("01/01/1980"));

DaoFactory.getStationDao().addStation(station); 
```

addStation 方法：

```
@Override
public MyEntity addStation(MyEntity station) {
    EntityManager em = PersistenceManager.getEntityManagerFactory().createEntityManager();
    try {           
        em.getTransaction().begin();
        em.persist(station);
        em.getTransaction().commit();
    } finally {
        if(em.getTransaction().isActive()) em.getTransaction().rollback();
        em.close();
    }
    return station;
} 
```

永远不会在我的数据库中创建字段“dateRefresh”...

有人帮我吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:23:21.160

只需将另一个字段添加到您的数据结构中，也许提供一个`default`子句，仅此而已。例如，如果您有一个`UserAccount`：

```
class UserAccount(db.Model):
    user = db.UserProperty()
    user_id = db.StringProperty() 
```

您可以轻松添加：

```
class UserAccount(db.Model):
    user = db.UserProperty()
    user_id = db.StringProperty()
    extra_info = db.IntegerProperty(default=0)
    timezone = db.StringProperty(default="UTC") 
```

放手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T15:18:26.237

虽然数据存储有点模仿表，但数据是按实体存储的。没有架构或表。

您需要做的就是更新您的模型类，新实体将与新实体的结构（字段）一起保存。

但是，旧实体和索引不会自动更新。它们仍然具有与最初写入数据存储区时相同的字段。

有两种方法可以做到这一点。一种是确保您的代码可以处理缺少新属性的情况，即确保没有抛出异常，或者在缺少属性时正确处理异常。

第二种方法是编写一个小函数（使用 mapreduce 函数）来使用新属性的适当或空值更新每个实体。

请注意，除非写入实体，否则不会更新索引。因此，如果您添加新的索引属性，则在查询新属性时不会显示旧实体。在这种情况下，您必须使用第二种方法并更新数据存储中的所有实体，以便为它们编制索引。

# ajax - 表单内的级联下拉列表

> ID：13585144
> 
> 赞同：0
> 
> 时间：2012-11-27T13:20:07.847
> 
> 标签：ajax, asp.net-mvc, asp.net-mvc-3, cascadingdropdown

我想在 ASP.NET MVC3 / Razor2 应用程序的表单中启用一对级联下拉列表。理想情况下，该解决方案将满足以下目标：

*   只需更改父列表的选择即可填充子列表
*   表单中包含两个下拉列表，因为他们需要在提交时发布信息
*   使用 Ajax 避免整个页面往返
*   使用 Ajax Html 助手轻松集成
*   即使没有启用 javascript 也可以工作

因此，从用户的角度来看，当父下拉列表中的项目被选中时，子下拉列表的内容会刷新以显示与其相关的项目。

谁能建议最好的方法来做到这一点？

**编辑。** 没有接受者……向我表明，上述目标列表中可能存在相互矛盾的要求。我最接近上述内容的是[这篇文章](http://weblogs.asp.net/raduenuca/archive/2011/03/27/asp-net-mvc-cascading-dropdown-lists-tutorial-part-4-cascading-using-form-hijaxing-using-jquery.aspx)，它满足了所有目标，只是它不能嵌套在 Html 表单中。

所以，我将以不同的方式重申这个问题：如何从 Html 表单中的下拉列表进行 AJAX 调用，以便我可以用相关项目填充另一个下拉列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T16:19:51.820

花了一些时间来找到一个合理的解决方案，尽管到目前为止我还没有一个无 jquery 后备。本文向您展示如何使用 AjaxHelper 扩展来创建您自己的启用 Ajax 的控件[。](http://www.prideparrot.com/blog/archive/2012/6/creating_a_custom_ajax_helper)工作一种享受，并且非常可重复使用。

# objective-c - Undeclared identifier for NSMutableArray

> ID：13585148
> 
> 赞同：0
> 
> 时间：2012-11-27T13:20:13.880
> 
> 标签：objective-c

In the interface (.h) of the viewController:

```
@property (strong, nonatomic) NSMutableArray* myMutableArray; 
```

calculate method is as:

```
- (void) calculate {

    DataObject* pObj = [DataObject objStart:(dataStart) objEnd:(dataEnd) objDay:(day)];

    [myMutableArray addObject:pObj];

} 
```

I receive this error message:

Use of undeclared identifier 'myMutableArray': did you mean '_myMutableArray' ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:24:34.763

If you do not have the property synthesized manually (`@synthesize myMutableArray;`) the compiler will create an iVar with an underscore prefix (which is the same as `@synthesize myMutableArray = _myMutableArray`);

To access it use

```
[_myMutableArray addObject:pObj]; 
```

or

```
[self.myMutableArray addObject:pObj]; 
```

If you have it synthesized manually like this

```
@synthesize myMutableArray = nameOfMyBackingIVar 
```

you can access your `NSMutableArray` this way:

```
[nameOfMyBackingIVar addObject:pObj]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:44:48.113

You are using XCode4 :)

Here you are not required to @synthesize. Compiler creates all ivars itself as _ivarName. i.e.,

```
@synthesize myMutableArray=_myMutableArray; 
```

If you want to override it then you can as

```
@synthesize myMutableArray; 
```

or, in this way

```
@synthesize myMutableArray=myMutableArray; 
```

# character-encoding - 数据表、PDF 和特殊字符

> ID：13585150
> 
> 赞同：1
> 
> 时间：2012-11-27T13:20:24.797
> 
> 标签：character-encoding

我正在使用 DataTables 和 TableTools PDF 导出功能。PDF 导出不处理某些特殊字符并将它们翻译成垃圾（或 ISO 等价物，我猜）。字符是 '●' `&#9679;`、 '○'`&#9675;`和 '٭' `&#1645;`。

有没有办法为 PDF 定义字符集，以便我可以保留这些特殊字符？（我猜字符集是问题）或任何其他解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T06:18:09.700

一个迟到的答案（对我自己），但其他人可能会受益。我想用[mPDF](http://www.mpdf1.com/mpdf/index.php)代替。它支持 UTF8、带有特殊字符的语言和嵌入式样式表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T02:51:29.980

不，没有办法为 PDF 配置字符集。DataTables，或者特别是它的 TableTools 插件，使用相当有限的基于 Flash 的 PDF 导出器。

但是，您可以编辑用于制作 TableTools Flash 插件的 ActionScript。

[下载](http://datatables.net/download/)TableTools 并在存档`\media\as3`目录中查找`.as`文件。

如果您没有 Adob​​e 的 Flash 创作软件，您可以尝试开源[Adob​​e Flex](http://en.wikipedia.org/wiki/Adobe_Flex)。

# ios - IOS：以角度旋转NSString

> ID：13585151
> 
> 赞同：-2
> 
> 时间：2012-11-27T13:20:29.540
> 
> 标签：ios, nsstring, rotation, angle

我想将 NSString 旋转一个角度。

但我不希望整个琴弦旋转，而是希望琴弦头留在原来的位置。

我怎样才能让 NSString 围绕某个点旋转，但不是整个矩阵旋转...

好的，对不起，实际上我的问题是我想围绕某个点旋转，但是 CGContextRotateCTM 是基于原点的。所以我怎样才能将原点移动到某个点，当旋转后，我怎样才能移动原点点回来……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:06:34.430

大概你想围绕一个锚点旋转一个 UILabel 。如果是这样，请按照此处从 David Rönnqvist 中提取的方法执行以下操作[：](https://stackoverflow.com/questions/6160519/how-to-rotate-an-object-around-a-arbitrary-point)

```
#define DEGREES_TO_RADIANS(angle) (angle/180.0*M_PI)

- (void)rotateText:(UILabel *)label 
       aroundPoint:(CGPoint)rotationPoint 
          duration:(NSTimeInterval)duration 
           degrees:(CGFloat)degrees {

    /* Setup the animation */
   [UIView animateWithDuration:duration delay:0 options:UIViewAnimationOptionCurveLinear animations:^{
    CGPoint transportPoint = CGPointMake((rotationPoint.x - CGRectGetMinX(label.frame))/CGRectGetWidth(label.bounds),
                                         (rotationPoint.y - CGRectGetMinY(label.frame))/CGRectGetHeight(label.bounds));

    [label.layer setAnchorPoint:transportPoint];
    [label.layer setPosition:rotationPoint]; // change the position here to keep the frame 
    [label.layer setTransform:CATransform3DMakeRotation(DEGREES_TO_RADIANS(degrees), 0, 0, 1)];   
    } completion:nil];
} 
```

如果您希望它围绕一端旋转，请使用在该处设置锚点（方法中的aroundPoint）`CGPointMake(.. , ..)`

# java - 如何使用 Spring 3 从类路径加载文件？

> ID：13585155
> 
> 赞同：0
> 
> 时间：2012-11-27T13:20:40.203
> 
> 标签：java, spring, classpath

我已经定义了一个 ClassPathResource bean，如下所示：

```
<bean id="ivsInputResource" class="org.springframework.core.io.ClassPathResource">
    <qualifier value="ivs" />
    <constructor-arg index="0"
        value="classpath*:IVS90test.csv"/>
</bean> 
```

但是当注入资源 bean 时，我的应用程序因以下异常而中断：

```
Caused by: java.lang.IllegalStateException: Input resource must exist (reader is in 'strict' mode): class path resource [classpath*:IVS90test.csv]
    at org.springframework.batch.item.file.FlatFileItemReader.doOpen(FlatFileItemReader.java:256)
    at org.springframework.batch.item.support.AbstractItemCountingItemStreamItemReader.open(AbstractItemCountingItemStreamItemReader.java:134) 
```

显然找不到资源。当使用 FileSystemResource（调整路径）时，我的应用程序确实可以工作。

如何从类路径正确加载文件？

我的项目布局如下：

![eclipse中项目布局截图](../Images/ada6145980c63ba90a87bb6211e209b2.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:56:35.337

`classpath:`使用[ClassPathResource](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/core/io/ClassPathResource.html)时无需在文件路径中指定

> **参数**：
> path - 类路径中的绝对路径

这里，*绝对路径*是指从资源文件夹的根目录开始，所以你需要做的就是把它改成

```
<bean id="ivsInputResource" class="org.springframework.core.io.ClassPathResource">
    <qualifier value="ivs" />
    <constructor-arg index="0"
        value="IVS90test.csv"/>
</bean> 
```

# php - Symfony2 和 Doctrine2 ：在 Type 类中使用 Repository 类结果

> ID：13585157
> 
> 赞同：0
> 
> 时间：2012-11-27T13:20:46.057
> 
> 标签：php, symfony, doctrine-orm, dql

我有 5 个实体：

1.  联系
2.  人
3.  用户
4.  用户从属关系
5.  个人隶属关系

我的目标是显示一个选择字段列表，我可以在其中选择所有不在 PersonAffiliations 中的 UserAffiliations。

我的想法是在 UserAffiliationRepository 中创建一个公共函数，它将仅返回特定用户的那些从属关系，这些关系不是为特定人预设的。

为此，我正在使用：

```
class UserAffiliationRepository extends EntityRepository
{ 
   public function getUnselectedAffiliations( $user_id = null, $person_id = null )
   {
      $commQB = $this->createQueryBuilder( 'ua' )
      ->select('ua');

      $commQB->where("ua.user_id = {$user_id}");

      $commQB->andWhere( "ua.affiliation_id not in ( select pa.affiliation_id  FROM SciForumVersion2Bundle:PersonAffiliation pa where pa.person_id = 3077 )" );

      return $commQB->getQuery()->getResult();
   }
} 
```

这很好用。

现在，我想在 FormBuilder 中使用这个结果。为此，在我的控制器中，我正在使用：

```
$affiliations = $em->getRepository('SciForumVersion2Bundle:UserAffiliation')->getUnselectedAffiliations($user->getId(), $author->getId())
$enquiry    = new PersonAffiliation();
$formType   = new SubmissionAffiliationAddFormType($user, $affiliations);
$form   = $this->createForm($formType, $enquiry); 
```

然后在 Form 类中，我正在使用：

```
$builder->add('affiliation', 'entity', array(
            'class' => 'SciForumVersion2Bundle:UserAffiliation',
            'multiple' => true)); 
```

但是在这里，我得到了特定用户的所有从属关系，而不仅仅是那些尚未在 PersonAffiliations 实体中准备好的那些。

有什么帮助吗？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:13:24.843

您必须`getUnselectedAffiliations`通过以下方式将您的函数直接迁移到 entity_type

```
$builder->add('affiliation', 'entity', array(
            'class' => 'SciForumVersion2Bundle:UserAffiliation',
            'multiple' => true,
            'query_builder' = function(EntityRepository $repo) use ($yourParameters){
                               return $repo->createQueryBuilder(....);})); 
```

如果你想通过`$yourParameters`，你必须把它变成`__construct`函数（实现它，如果你没有），当你创建你的表单时，你可以将它们传递给调用

# javafx-2 - Javafx，获取TableCell引用的对象

> ID：13585164
> 
> 赞同：8
> 
> 时间：2012-11-27T13:21:14.340
> 
> 标签：javafx-2

我在 TableView 的选定单元格上有以下回调：

```
 Callback<TableColumn<MyFTPFile,String>, TableCell<MyFTPFile,String>> cellFactory =
            new Callback<TableColumn<MyFTPFile,String>, TableCell<MyFTPFile,String>>() {
                public TableCell<MyFTPFile,String> call(TableColumn<MyFTPFile,String> p) {
                    TableCell<MyFTPFile,String> cell = new TableCell<MyFTPFile, String>() {
                        @Override
                        public void updateItem(String item, boolean empty) {
                            super.updateItem(item, empty);
                            setText(empty ? null : getString());
                            setGraphic(null);
                        }

                        private String getString() {
                            return getItem() == null ? "" : getItem().toString();
                        }
                    };

                    cell.addEventFilter(MouseEvent.MOUSE_CLICKED, new EventHandler<MouseEvent>() {
                        @Override
                        public void handle(MouseEvent event) {
                            if (event.getClickCount() > 1) {
                                TableCell<MyFTPFile,String> c = (TableCell<MyFTPFile,String>) event.getSource();

                                ftpObservablelist = MyFTPClient.getInstance().getFtpObservableList(); 
                                ftpTable.setItems(ftpObservablelist);

                            }
                        }
                    }); 
```

现在，我想获取单元格引用的 MyFTPFile 对象，该对象被双击，这样我就可以将它传递给另一个类并做一些事情......知道怎么做吗？？？

提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-27T20:34:47.483

MyFTPFile 对象与单元格的行相关联，因此，正如提问者在他的评论中指出的那样，它可以通过`cell.getTableRow().getItem()`.

起初我认为这应该是[cell.getItem()](http://docs.oracle.com/javafx/2/api/javafx/scene/control/Cell.html#getItem())，它返回与单元格关联的数据值。但是，大多数时候，单元格数据值将是支持项的属性，而不是对象本身（例如 MyFTPFile 对象的文件名字段）。

好奇的可执行样本：

```
import javafx.application.Application;
import javafx.event.EventHandler;
import javafx.scene.Group;
import javafx.scene.Scene;
import javafx.scene.control.TableCell;
import javafx.scene.control.TableColumn;
import javafx.scene.control.TableView;
import javafx.scene.control.cell.PropertyValueFactory;
import javafx.scene.control.cell.TextFieldTableCell;
import javafx.scene.input.MouseEvent;
import javafx.stage.Stage;
import javafx.util.Callback;

public class TableClickListener extends Application {

  public static void main(String[] args) {
    launch(args);
  }

  class FTPTableCell<S, T> extends TextFieldTableCell<S, T> {
    FTPTableCell() {
      super();
      addEventFilter(MouseEvent.MOUSE_CLICKED, new EventHandler<MouseEvent>() {
        @Override
        public void handle(MouseEvent event) {
          if (event.getClickCount() > 1 && getItem() != null) {
            System.out.println("Sending " + getTableRow().getItem() + " to the FTP client");
          }
        }
      });
    }
  }

  final Callback<TableColumn<MyFTPFile, String>, TableCell<MyFTPFile, String>> FTP_TABLE_CELL_FACTORY =
      new Callback<TableColumn<MyFTPFile, String>, TableCell<MyFTPFile, String>>() {
        public TableCell<MyFTPFile, String> call(TableColumn<MyFTPFile, String> p) {
          return new FTPTableCell<>();
        }
      };

  @Override
  public void start(final Stage stage) {
    final TableView<MyFTPFile> table = new TableView<>();

    final TableColumn<MyFTPFile, String> filenameColumn = new TableColumn<>("Filename");
    filenameColumn.setCellValueFactory(new PropertyValueFactory<MyFTPFile, String>("filename"));
    filenameColumn.setCellFactory(FTP_TABLE_CELL_FACTORY);
    filenameColumn.setMinWidth(150);

    final TableColumn<MyFTPFile, String> ratingColumn = new TableColumn<>("Rating");
    ratingColumn.setCellValueFactory(new PropertyValueFactory<MyFTPFile, String>("rating"));
    ratingColumn.setCellFactory(FTP_TABLE_CELL_FACTORY);
    ratingColumn.setMinWidth(20);

    table.getColumns().setAll(filenameColumn, ratingColumn);

    table.getItems().setAll(
        new MyFTPFile("xyzzy.txt", 10),
        new MyFTPFile("management_report.doc", 1),
        new MyFTPFile("flower.png", 7)
    );

    table.setColumnResizePolicy(TableView.CONSTRAINED_RESIZE_POLICY);

    stage.setScene(new Scene(new Group(table)));
    stage.show();
  }

  public class MyFTPFile {
    private final String filename;
    private final int rating;

    MyFTPFile(String filename, int rating) {
      this.filename = filename;
      this.rating = rating;
    }

    public String getFilename() {
      return filename;
    }

    public int getRating() {
      return rating;
    }

    @Override
    public String toString() {
      return "MyFTPFile{" +
          "filename='" + filename + '\'' +
          ", rating=" + rating +
          '}';
    }
  }

} 
```

# javascript - Javascrtip绑定，它是否对`this`进行了深层复制？

> ID：13585165
> 
> 赞同：0
> 
> 时间：2012-11-27T13:21:19.980
> 
> 标签：javascript, environment-variables, prototype

我是原型新手，我只是做了一个不起作用的简单示例。从下面的代码可以看出我想要什么 - 一个计数器。但由于某种原因，输出始终是`5`，我猜是在`bind`制作对象的深层副本，`this`然后将其绑定到函数。有一个明显的解决方案，我将所有内容都公开，但我想知道是否有更优雅的解决方案。（或者你可以纠正我并告诉我没有深拷贝，但有其他错误）。[文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)对我没有帮助。

编码：

```
<!DOCTYPE html>
<html>
    <body>
        <input type="button" value="click" onclick="javascript: doTest();" />
        <div id="canvas"></div>
        <script>
            var ClassA = function (position, element) { // constructor
              this.field1 = position;
              this.target = element;
            };

            ClassA.prototype = function () {
              // private functions
                var _aPrivateMethod = function(){
                    console.log(this);
                    this.field1 += 1;
                    return this.field1;
                };

                var _aPublicMethod = function(){
                    this.target.innerHTML = _aPrivateMethod.bind(this)();
                };

                return { // interface
                    constructor: ClassA,
                    aPublicMethod : _aPublicMethod
                };
            }();

            function doTest() {
                var obj = new ClassA(4, document.getElementById('canvas'));
                obj.aPublicMethod();
            }
        </script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:33:36.390

这里有一些问题。首先你`doTest`每次都打电话。每次单击都会创建一个新对象，因此无法增加`field1`.

据我了解，您想`field1`保持私密性。在您初始化它的方式中，它不能是私有的。您可以执行以下操作：

```
function Person() {
   var counter = 0;
   this.increment = function () {
       return ++counter;
   }
} 
```

这样你就不`counter`能从函数范围之外访问。

另一个问题是您没有使用正确的上下文调用私有方法。你应该使用`_aPrivateMethod.call(this)`pimvdb 提到的。

下面是一个例子：

```
function Person() {

    var age = 0;

    function incrementAge() {
        return ++age;
    }

    function eatCake() {
        console.log('Yey. I\'ll eat cake!');
    }

    this.birthday = function () {
        eatCake();
        return incrementAge();
    }
}

var p = new Person();
p.birthday(); //'Yey. I'll eat cake!', returns 1
p.birthday(); //'Yey. I'll eat cake!', returns 2 
```

这样`eatCake`，`incrementAge`并且`age`由于功能范围而都是私有的。示例中的坏处是我声明函数的方式`birthday`。将为每个实例`Person`创建一个新副本。正确的方法是：

```
Person.prototype.birthday = function () { ... } 
```

我的声明不是这样的，因为我想使用私有数据成员。实际上不仅仅是函数（`age`, `eatCake`, `incrementAge`）的本地私有。无法从原型中声明的函数访问它们，这就是为什么对于上面的示例，我选择了这种方法。

# sencha-touch - 如何使用 Sencha Touch 切换视图容器？

> ID：13585171
> 
> 赞同：3
> 
> 时间：2012-11-27T13:21:41.080
> 
> 标签：sencha-touch, sencha-touch-2

如何在 Sencha Touch 中切换视图？目前我正在显示一个新视图，但它看起来像是覆盖在现有视图上。我想我需要隐藏以前的或销毁它。我正在考虑使用`Ext.getCmp("noteslist")`，但是在尝试获取当前容器时会返回“未定义”。这是在视图之间导航的推荐方式还是有更好的方式？

应用程序

```
Ext.application({
    name: "NotesApp",
    controllers: ["NotesController", "TestController"],
    views: ["NotesListContainer"],

    launch: function () {

        var notesListContainer = Ext.create("NotesApp.view.NotesListContainer");
        Ext.Viewport.add(notesListContainer);
    }
}); 
```

控制器：

```
Ext.define("NotesApp.controller.NotesController", {
    extend: "Ext.app.Controller",
    views: [        
        "TestListContainer"
    ],
    config: {
        refs: {
            newNoteBtn: "#new-note-btn",
            saveNoteBtn: "#save-note-btn",
        },
        control: {
            newNoteBtn: {
                tap: "onNewNote"
            },          
            saveNoteBtn: {
                tap: "onSaveNote"
            }
        }
    },
    onNewNote: function () {
        console.log("onNewNote");
    },
    onSaveNote: function () {
        console.log("onSaveNote");      
        Ext.Viewport.add({xtype:'testlist'}).show();    
            // How do I remove the current one?....         
    },
    launch: function () {
        this.callParent();
        console.log("launch");
    },
    init: function () {
        this.callParent();
        console.log("init");
    }
}); 
```

看法

```
Ext.define("NotesApp.view.NotesListContainer", {
    extend: "Ext.Container",   
    config: {
        items: [{
            xtype: "toolbar",
            docked: "top",
            title: "My Notes",
            items: [{
                xtype: "spacer"
            }, {
                xtype: "button",
                text: "New",
                ui: "action",
                id:"new-note-btn"
            }, {
                xtype: "button",
                text: "Save",
                ui: "action",
                id:"save-note-btn"
            }]
        }]
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T19:47:20.160

使用 Ext.Viewport.add 您只将组件添加到视口，但不会将其设置为活动项目。您可以使用 Ext.Viewport.setActiveItem 添加组件并将其设置为一次调用中的活动项。

例子：

```
//1
Ext.Viewport.setActiveItem({xtype:'testlist'});

//or 2
//Create and add to viewport
Ext.Viewport.add({xtype:'testlist'});
//set active item by index
Ext.Viewport.setActiveItem(1);

//or 3
var list = Ext.create('NotesApp.view.NotesListContainer', {id : 'noteList'});
Ext.Viewport.add(list);
 .....
//In place where you need to show list
Ext.Viewport.setActiveItem(list); 
```

如果要在视图之间进行动画切换，请使用 animateActiveItem(list, {type: 'slide', direction: 'right'}) 代替 setActiveItem。

这是您可以使用 Ext.Viewport 和任何具有卡片布局的容器的方式。在实际应用程序中，可以在应用程序的一部分（在控制器中，在应用程序中，在视图中）创建视图，并在其他部分设置为活动状态。在这种情况下，您需要以任何方式获取到列表的链接并在 setActiveItem 中使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T05:32:44.423

有两种技术 1 使用 setActiveItem 和另一种使用导航视图...

[导航视图](http://docs.sencha.com/architect/2/#!/guide/navigationview)

设置活动项目方法：

```
var view=Ext.Viewport.add({xtype: 'testlist'});
Ext.Viewport.setActiveItem(view);
view.show(); //This is additionally done to fire showAnimation 
```

# sql-server - 基于动态 XML 的插入/更新

> ID：13585172
> 
> 赞同：2
> 
> 时间：2012-11-27T13:21:43.517
> 
> 标签：sql-server, tsql, xpath, xquery

我有以下 XML：

```
<NewDataSet>
  <Data>
    <Id>560f05b2-b215-4fea-9ac6-7f012fbca331</Id>   
    <Number>384D25334E04593B6DE9955E72F413F8A0A828FF</Number>
    <CurrentDate>2012-11-21T09:09:26+00:00</CurrentDate>
  </Data>
  <Data>
    <Id>9cff574b-59ea-4cbd-a2db-9ed02b6cc602</Id>  
    <Number>384D25334E04593B6DE9955E72F413F8A0A828FF</Number>
    <Location>Town</Location>
    <CurrentDate>2012-11-21T09:09:53+00:00</CurrentDate>
  </Data> 
</NewDataSet> 
```

我正在尝试编写一个查询，该查询将根据给定的 xml 插入新记录或更新现有记录。问题是我不能使用预定义的列名称，因为表结构有时会发生变化。所以想法是生成动态查询并应用它。到目前为止，我有以下事情：

```
 SET NOCOUNT OFF;

    DECLARE @TableName nvarchar(50)
    DECLARE @TableData xml
    DECLARE @Query nvarchar(max)
    DECLARE @Id uniqueidentifier
    DECLARE @CurrentDate datetime

    -- declare cursor
    DECLARE cursor_inserting CURSOR LOCAL FAST_FORWARD FOR
    SELECT 
        r.value('fn:local-name(.)', 'nvarchar(50)'), 
        r.query('.')
    FROM @Data.nodes('//NewDataSet/*') AS records(r)
    ORDER BY r.value('fn:local-name(.)', 'nvarchar(50)')

    -- open cursor
    OPEN cursor_inserting
    FETCH NEXT FROM cursor_inserting INTO @TableName, @TableData

    WHILE @@FETCH_STATUS = 0
    BEGIN

        -- Get id
        SELECT @Id = o.value('Id[1]', 'uniqueidentifier') FROM @TableData.nodes('*') as n(o)
        SELECT @CurrentDate = o.value('CurrentDate[1]', 'datetime') FROM @TableData.nodes('*') as n(o)

        SET @Query = NULL

-- temporary update query
SET @UpdateTemp = NULL
SELECT @UpdateTemp = COALESCE(@UpdateTemp + ', ', '') + o.value('fn:local-name(.)', 'nvarchar(50)') + ' = ''' + CAST(o.query('text()') as nvarchar(4000)) + '''' FROM @TableData.nodes('/*/*') as n(o)
SET @UpdateTemp = 'UPDATE ' + @TableName + ' SET ' + @UpdateTemp + ' WHERE Id = ''' + CAST(@Id as nvarchar(40)) + ''''

-- temporary insert query
SET @Insert1Temp = NULL
SELECT @Insert1Temp = COALESCE(@Insert1Temp + ', ', '') + o.value('fn:local-name(.)', 'nvarchar(50)')  FROM @TableData.nodes('/*/*') as n(o)

SET @Insert2Temp = NULL
SELECT @Insert2Temp = COALESCE(@Insert2Temp + ', ', '') + '''' + CAST(o.query('text()') as nvarchar(4000)) + ''''  FROM @TableData.nodes('/*/*') as n(o)

SET @InsertTemp = 'INSERT INTO ' + @TableName  + ' ( ' + @Insert1Temp + ' ) VALUES ( ' + @Insert2Temp + ' )'

IF @TableName = 'Data'
BEGIN

    IF EXISTS (SELECT * FROM Data WHERE Id = @Id)
    BEGIN

        IF EXISTS (SELECT * FROM tblAudit WHERE Id = @Id AND CurrentDate < @CurrentDate)
        BEGIN               
            SET @Query = @UpdateTemp            
        END

    END
    ELSE
    BEGIN
        SET @Query = @InsertTemp
    END
END

IF @Query IS NOT NULL
BEGIN
    SELECT @Query
    EXEC (@Query)
END
        END
    FETCH NEXT FROM cursor_inserting INTO  @TableName, @TableData
END

CLOSE cursor_inserting
DEALLOCATE cursor_inserting 
```

如果有任何更好的方法可以在 SQL 中实现这一点，我想知道，我知道我可以在我的应用程序代码中在 SQL 之外执行此操作，但我想将它放在存储过程中的一个位置以提供 xml 并且需要采取的行动。

**更新 1**

我想澄清一下，我的主要问题是基于 XML 的查询正确生成。很高兴看到处理插入/更新的不同方式，但作为补充

**更新 2**

xml 中可以有超过 1 个表。例如，不仅是 Data，还有 Data2

**更新 3**

我已经更新了我现在拥有的内容 - 它现在正在生成正确的插入/更新，但是我现在遇到了转换问题。例如，日期字符串是 xml 格式，sql 不想自动转换它。所以我的下一步是从数据库中获取正确的列类型，而不是直接从 xml 生成查询 instert。我希望这会奏效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:28:00.987

是的。

您可以使用`MERGE`SQL XQuery 在一个语句中执行此操作。

就像是...

```
merge Data as target
using 
(
    select  
        x.q.value('Id[1]','uniqueidentifier') as ID,
        x.q.value('Number[1]','varchar(50)') as Number,
        x.q.value('Location[1]','varchar(50)') as Town,
        x.q.value('CurrentDate[1]','datetime') as CurrentDate
    from
        @TableData.nodes('/NewDataSet/Data')x(q)
) as Source (ID,Number,Town,CurrentDate)
    on target.id=source.id
when matched and target.CurrentDate < source.CurrentDate then
    update set 
         Number = source.number, 
         town = source.town, 
         currentdate = source.currentdate
when not matched then
    insert (ID,number,town,currentdate)
    values (source.id,source.number,source.town,source.currentdate); 
```

# c - 为什么 line2 中的 free 让 memcpy 什么都不做？malloc 之前是免费的吗？

> ID：13585173
> 
> 赞同：-7
> 
> 时间：2012-11-27T13:21:44.610
> 
> 标签：c, malloc, free, memcpy

```
void str_cpy(char **des,char* src){
   if(*des || *des==src)
     free(*des);
   *des = (char*)malloc(sizeof(char)*(strlen(src)+1));
   if(!*des)
     return ;
   memcpy ( *des, src, (strlen(src)+1)*sizeof(char) );
 } 
```

为什么 line2 中的 free 让 memcpy 什么都不做？malloc之前的free可以吗？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T13:31:40.287

不！！！:-) 在尝试使用之前释放（src）是不行的！（在 *dest == src 的情况下，代码的第 2 行，即 free(*dest) 本质上与 free(src) 相同，然后您使用 src，从那时起它不指向正确分配的内存堵塞。）

尝试使用释放的内存会导致未定义的行为。当某些事情未定义时，任何事情都会发生！也许 free 已经将 src 中的第一个字节更改为 0（在这种情况下 strlen(src) == 0）或者 memcpy 检测到源内存没有正确分配或者可能发生了其他事情。不值得追究为什么会出现*这种*行为的问题。如果您更改构建设置（调试/优化等）或在不同的系统上构建您的程序（实际上是库，而不是您使用的编译器在这里有所不同），您可能会得到不同的结果。

无论如何，当 *dest == src 时，你不需要 free、strlen、malloc 和复制任何东西；你可以回来。

```
void str_cpy(char **des,char* src){
   if(*des==src) return;
   ...
 } 
```

通常，使用您的函数的人会期望您不要对第二个参数 src 做任何有趣的事情，例如更改其内容或释放其内存。我还将参数类型更改为 const char * src。虽然这不会阻止您释放 src 内存块，但它会使函数的预期用途更加清晰。

实际上，函数签名还有另一个更大的问题。*dest 可能指向之前在堆中分配的内存（唯一可以使用 free(*dest) 的情况，当然假设 *dest != src）或之前分配的堆栈内存（在这种情况下 free(*dest) ) 不行），但也有可能它指向静态分配的内存（字符串文字）或不指向分配的内存周期。

标准库函数通过不使用此类签名（即使用 char ** 类型的参数）来避免这个问题。

与您正在做的最相关的功能的签名是：

```
 char * strcpy(char *restrict s1, const char *restrict s2);

 char * strncpy(char *restrict s1, const char *restrict s2, size_t n);

 char * strdup(const char *s1); 
```

更多信息请访问： http: [//www.manpagez.com/man/3/strncpy/](http://www.manpagez.com/man/3/strncpy/)和[http://www.manpagez.com/man/3/strncpy/](http://www.manpagez.com/man/3/strncpy/)

这些函数都不必担心内存分配的位置。这三个都要求它们的参数是有效的指针（指向静态或动态分配的（堆/堆栈）内存。我怀疑 strdup 实际上最适合您正在做的事情（您似乎想为重复的字符串分配新内存） . strcpy 和 strncpy 不分配新内存。（有关详细信息，请参阅上面的文档链接。）

你看到那里的模式了吗？strdup 返回一个指向新分配内存的指针（与 malloc 完全一样），并且 strcpy 和 strcpy 采用 char * 参数并且不分配内存。这些函数都不必处理您的函数所存在的问题，即确定（在 C 中不可能） *dest 指向的内存类型。Kernighan 和 Ritchie 选择这样做是有原因的 :-)

您可以提供明确说明 *dest 必须指向堆中先前分配的内存块或等于 NULL 的文档。然而，优秀的库设计者不会这样做，因为它将责任转嫁给用户（因为用户*会*犯错误）。

依赖文档（即让库设计者将责任传递给其用户）是一条危险的道路。最好完全避免这个问题。好的 C 代码从函数签名开始 :-)

最后一点：您在代码中使用了 strlen() 两次。出于性能原因，最好只使用一次并将其返回值存储在局部变量中，然后在当前调用 strlen() 的地方使用该变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T13:25:36.637

在 C 中，您只能释放由`malloc`、`calloc`或分配的内存`realloc`。所以释放除此之外的内存是`Undefined behaviour`

在你的情况下，不清楚是什么`*des`。以及是否由`malloc`,`calloc`或分配`realloc`。

或者你在调用环境时已经这样做了

```
char des[20]= "hello , world \n"; 
```

或者可能

```
char * des= "hello . world \n"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T13:35:17.863

正如评论中向您指出的那样，您的函数需要文档。如果输入正确，它将完全按照您的要求工作：

这有效：

```
char * str1 = "hello";
char * str2 = malloc(6);   // Of course this is pointless since you'll free it anyway
str_cpy(&str2, str1); 
```

这样做也是如此：

```
char * str1 = "hello";
char * str2 = NULL;
str_cpy(&str2, str1); 
```

但是这个：

```
char * str1 = "hello";
char * str2;
str_cpy(&str2, str1); 
```

或这个：

```
char * str1 = "hello";
char str2[6];
str_cpy(&str2, str1); 
```

或这个：

```
char * str1 = "hello";
char * str2 = str1;
str_cpy(&str2, str1); 
```

会崩溃和燃烧。您需要在评论中注明您的功能的所有前/后条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T13:44:55.007

```
void str_cpy(char **des,char* src){
   if(*des || *des==src)
     free(*des);
   *des = (char*)malloc(sizeof(char)*(strlen(src)+1));
   if(!*des)
     return ;
   memcpy ( *des, src, (strlen(src)+1)*sizeof(char) );
 } 
```

*   在 malloc 之前释放不是必需的，它可能包含一些垃圾值，并且您正在释放导致的垃圾（核心转储）。
*   如果 ( *des == src ) 并且你释放了 des，这意味着 'src' 也被释放了，下面你在 memcpy 中使用 src。

**正确做法：**

```
void str_cpy(char **des,char* src){
   *des = (char*)malloc(sizeof(char)*(strlen(src)+1));
   if(!*des)
     return ;
   memcpy ( *des, src, (strlen(src)+1)*sizeof(char) );
 } 
```

# php - 根据密度过滤数组

> ID：13585175
> 
> 赞同：8
> 
> 时间：2012-11-27T13:21:52.143
> 
> 标签：php, python, arrays, algorithm, filter

我有一个像下面这样的示例图..，我用数组 X 中的一组 (x,y) 值绘制它。

[http://bubblebird.com/images/t.png](http://bubblebird.com/images/t.png)

***如您所见，图像的峰值在 4000 到 5100 之间***

我的确切问题是我可以以编程方式找到图形最密集的这个范围吗？
即..**使用 Array X 如何找到该图密集的范围？**
对于这个数组，它将是 4000 - 5100。

为简单起见，假设该数组只有一个密集区域。
如果您能建议一个伪代码/代码，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T15:47:41.173

您可以在移动窗口上使用信号的方差。这是一个示例（参见附图，其中测试信号为红色，窗口方差为绿色，过滤后的信号为蓝色）：

![简单的例子](../Images/aadbab5246faee1cc56cfdac0822eb8b.png)：

测试信号生成：

```
import numpy as np
X = np.arange(200) - 100\.  
Y = (np.exp(-(X/10)**2) + np.exp(-((np.abs(X)-50.)/2)**2)/3.) * np.cos(X * 10.) 
```

计算移动窗口方差：

```
window_length = 30 # number of point for the window
variance = np.array([np.var(Y[i-window_length / 2.: i+window_length/2.]) for i in range(200)]) 
```

获得方差高的指数（这里我选择标准方差优于最大方差的一半......你可以根据你的情况调整它）：

```
idx = np.where(variance > 0.5 * np.max(variance))

X_min = np.min(X[idx])
# -14.0
X_max = np.max(X[idx])
# 15.0 
```

或过滤信号（将方差低的点设置为零）

```
Y_modified = np.where(variance > 0.5 * np.max(variance), Y, 0) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T13:38:52.433

您可以计算相邻值之间的绝对差，然后可以用滑动窗口稍微平滑一些东西，然后找到平滑后的绝对差值为最大值的 50% 的区域。

使用 python（你在标签中有 python）这看起来像这样：

```
a = ( 10, 11, 9, 10, 18, 5, 20, 6, 15, 10, 9, 11 )

diffs = [abs(i[0]-i[1]) for i in zip(a,a[1:])]
# [1, 2, 1, 8, 13, 15, 14, 9, 5, 1, 2]
maximum = max(diffs)
# 15
result = [i>maximum/2 for i in diffs]
# [False, False, False, True, True, True, True, True, False, False, False] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T15:36:10.753

您可以使用分类算法（例如 k-means），将数据拆分为集群并找到权重最大的集群

# javascript - 带有 div 标签的 TinyMCE？

> ID：13585178
> 
> 赞同：5
> 
> 时间：2012-11-27T13:22:04.560
> 
> 标签：javascript, html, jsp, tinymce

下面是我的 JSP 代码：

```
<tr>
      <td colspan="2">custEmail</td>
      <td colspan="5"><div id= "custEmail"><p><strong>Test</strong></p></div></td>
</tr> 
```

下面是`div`使用[TinyMCE 编辑器附加的代码](http://www.tinymce.com "TinyMCE 编辑器")

```
<script type="text/javascript" src="tinymce/tinymce.min.js"></script>
<script type="text/javascript">
tinyMCE.init({
        width : "640",
        mode : "exact",
        elements : "custEmail",
        theme : "advanced",
        plugins : "preview",
        readonly : true,
        theme_advanced_buttons1 : "forecolor,backcolor,|,justifyleft,justifycenter,justifyright,justifyfull,|,bullist,numlist,|,formatselect,fontselect,fontsizeselect,sub,sup,|,bold,italic,underline,strikethrough",
        theme_advanced_buttons2 : "",
        theme_advanced_buttons3 : "",
        theme_advanced_toolbar_location : "top",
        theme_advanced_toolbar_align : "left",
        theme_advanced_statusbar_location : "bottom",
        theme_advanced_resizing : true
    });
</script> 
```

但是在我的 HTML 页面上，我看到的内容是：

```
<p><strong>Test</strong></p> 
```

而不是大胆的测试。只要我更改以下内容：

```
div id="custEmail" tag to textarea id="custEmail" 
```

它工作正常。不确定我是否需要对 div 标签进行一些设置？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T13:26:01.707

您需要做的就是将[forced_root_block](http://www.tinymce.com/wiki.php/Configuration:forced_root_block)设置为`'div'`：

```
tinyMCE.init({
        ...
        forced_root_block : 'div'
}); 
```

# mysql - mysql中列的计算

> ID：13585179
> 
> 赞同：0
> 
> 时间：2012-11-27T13:22:04.957
> 
> 标签：mysql

我需要基于此执行计算：

(col1 + col2 + col3 + col4 + col5) /col6

完成此计算后，我想根据获得的结果执行 orderby。

请建议。我知道如何执行这样的求和：

```
SELECT SUM(column1) + SUM(column2) + SUM(columnN) FROM mytable 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:23:20.033

```
SELECT (column1+column2+columnN)/column6
FROM mytable
ORDER BY (column1+column2+columnN)/column6 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:24:39.097

我想你的意思是：

```
SELECT ((column1 + column2 + columnN) / column6) as calc 
FROM mytable order by calc 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T13:25:16.277

```
SELECT (col1 + col2 + col3 + col4 + col5) /col6 as calculated
FROM your_table
ORDER BY calculated 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T13:24:41.593

试试这个 ：：

```
SELECT (column1+column2+columnN) as total,
total/column6 as average
FROM mytable
ORDER BY total 
```

# c# - Windows 8 数据绑定

> ID：13585185
> 
> 赞同：1
> 
> 时间：2012-11-27T13:22:40.127
> 
> 标签：c#, xaml, binding, windows-8

我正在使用 C# 和 XAML 开发应用程序，但遇到了一个令我困惑的问题。我的数据中有一个名为的属性，`GroupImage`并使用绑定来设置它的`Source`属性`Image`。效果很好，但是当我想第二次做同样的事情时，它不会在第二个`Image`控件中显示图像。

```
<Image Source="{Binding Group.GroupImage}" Width="250" Height="500" Stretch="UniformToFill" />

<Image VerticalAlignment="Bottom" Stretch="UniformToFill" Source="{Binding Group.GroupImage}" Grid.RowSpan="2"/> 
```

顶部的工作正常，底部的没有。我一直在阅读有关 Data Binding 的内容，并且得到的印象是您需要在 中指定某些内容`DataContext`才能多次使用属性。这是正确的吗？这样做似乎是一种非常奇怪的方式。

我对 C# 比较陌生，如果我遗漏了一些明显的东西，我很抱歉。我会很感激有更多知识渊博的人帮助我。

谢谢

**更新**在我收到的帮助之后，我发现上下文被设置为

```
DataContext="{Binding Group}" 
```

结果，我的第二行需要更改为以下内容，因为数据上下文已设置为组。

```
<Image VerticalAlignment="Bottom" Stretch="UniformToFill" Source="{Binding GroupImage}" Grid.RowSpan="2"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:26:37.793

**您无需在 中指定某些`DataContext`内容即可多次使用属性。**但是您的两个`Image`必须拥有正确的权限`DataContext`（您可以使用调试器轻松对其进行测试），具体取决于它们在可视树上的位置（您没有为该`DataContext`部分提供任何代码？）。

您还可以检查您`Image`的`Width`/`Height`不是 0。

# html - 如何在网站上使用自定义字体？

> ID：13585186
> 
> 赞同：73
> 
> 时间：2012-11-27T13:22:41.300
> 
> 标签：html, fonts

为了让我的网站看起来不错，我需要使用自定义字体，特别是 Thonburi-Bold。问题是 - 除非用户安装了字体，否则字体不会显示。它也不显示在Firefox中。

这个问题有解决方法吗？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2012-11-27T13:26:58.370

您必须像这样在样式表中导入字体：

```
@font-face{
    font-family: "Thonburi-Bold";
    src: url('Thonburi-Bold.ttf'),
    url('Thonburi-Bold.eot'); /* IE */
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-27T13:25:29.473

您可以使用 CSS3`font-face`或 webfonts

**@font-face 用法**

```
@font-face {
   font-family: Delicious; 
   src: url('Delicious-Roman.otf');
} 
```

**网页字体**

看看 Google Webfonts，[http://www.google.com/webfonts](http://www.google.com/webfonts)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-27T13:25:20.513

CSS 允许您在您的网站上使用自定义字体、可下载字体。您可以下载您喜欢的字体，比如说`myfont.ttf`，然后将其上传到托管您的博客或网站的远程服务器。

```
@font-face {
    font-family: myfont;
    src: url('myfont.ttf');
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-11-27T13:26:36.333

是的，有办法。它在 CSS 中称为自定义字体。您的 CSS 需要修改，并且您需要将这些字体上传到您的网站。

为此所需的 CSS 是：

```
@font-face {
     font-family: Thonburi-Bold;
     src: url('pathway/Thonburi-Bold.otf'); 
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-27T13:25:27.327

首先，您必须将字体作为 .otf 或 .ttf 放在服务器上的某个位置。

然后使用 CSS 声明新的字体系列，如下所示：

```
@font-face {
    font-family: MyFont;
    src: url('pathway/myfont.otf'); 
    } 
```

如果将文档链接到声明字体系列的 CSS 文件，则可以像使用任何其他字体一样使用该字体。

# php - XMLHttpRequest 不工作

> ID：13585193
> 
> 赞同：0
> 
> 时间：2012-11-27T13:23:03.357
> 
> 标签：php, javascript, mysql, xmlhttprequest

我在下面的代码中遇到了 XMLHttpRequest 的问题，它没有按预期工作。有人可以帮忙吗！

简而言之：这个程序正在接受来自用户的值，它应该更新 RATEMASTER_draft 表。如果用户按 F5 刷新，它仍然保留值，我正在再次读取表格并将值再次插入输入框中。

但由于某种原因，数据 onchange 没有更新表。

```
<?php include 'accesscontrol.php'; ?>

<?php
$dbservertype='mysql';
$servername='localhost';
    $dbusername='svga';
$dbpassword='aa!@#';
$dbname='svga3';

connecttodb($servername,$dbname,$dbusername,$dbpassword);
function connecttodb($servername,$dbname,$dbuser,$dbpassword)
{
global $link;
$link=mysql_connect ("$servername","$dbuser","$dbpassword");
if(!$link){die("Could not connect to MySQL");}
mysql_select_db("$dbname",$link) or die ("could not open db".mysql_error());
}
//////// End of connecting to database ////////
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head id="Head1" runat="server">
<title>RATEMASTER</title>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
<script type="text/javascript">
    $(function () {
    $("form:not(.filter) :input:visible:enabled:first").focus();
    });
</script>

<script type="text/javascript">

function showUser(str)
{

if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET","rateaccode.php?q1=" + str,false);
xmlhttp.send();
}

function showprodes(str2)
{
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET","rateprod.php?q2=" + str2,true);
xmlhttp.send();
}

function showperltr(str3)
{
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET","rateperltr.php?q3=" + str3,true);
xmlhttp.send();
}

function showperno(str4)
{
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET","rateperno.php?q4=" + str4,true);
xmlhttp.send();
}

function showpercu(str5)
{
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET","ratepercu.php?q5=" + str5,true);
xmlhttp.send();
}

function showperkg(str6)
{
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
xmlhttp=new XMLHttpRequest();
}
else    
{// code for IE6, IE5
xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET","rateperkg.php?q6=" + str6,true);
xmlhttp.send();
}

function showexcise(str7)
{
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET","rateexcise.php?q7=" + str7,true);
xmlhttp.send();
}

function showcess(str8)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","ratecess.php?q8=" + str8,true);
xmlhttp.send();
}

function showedu(str9)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","rateedu.php?q9=" + str9,true);
xmlhttp.send();
}

function showfreight(str10)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","ratefreight.php?q10=" + str10,true);
xmlhttp.send();
}

function showcoll(str11)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","ratecoll.php?q11=" + str11,true);
xmlhttp.send();
}

function showloading(str12)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","rateloading.php?q12=" + str12,true);
xmlhttp.send();
}

function showunloading(str13)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","rateunloading.php?q13=" + str13,true);
xmlhttp.send();
}

function showtransport(str14)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","ratetransport.php?q14=" + str14,true);
xmlhttp.send();
}

function showvat(str15)
{
alert ("vat");
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","ratevat.php?q15=" + str15,false);
xmlhttp.send();
}

function showcst(str16)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","ratecst.php?q16=" + str16,true);
xmlhttp.send();
}

function showcstwithout(str17)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","ratecstwithout.php?q17=" + str17,true);
xmlhttp.send();
}

function showtariff(str18)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","ratetariff.php?q18=" + str18,true);
xmlhttp.send();
}

function showbal(str19)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","ratebal.php?q19=" + str19,true);
xmlhttp.send();
}

function showdesc(str20)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","ratedesc.php?q20=" + str20,true);
xmlhttp.send();
}

//----------------------------------------------------

</script>

<style type="text/css">
<!--
.sty1 {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
    font-weight: bold;
}
-->
</style>

</head>

<body onload="document.f1.vat.focus();">
<table width="100%"  border="0" cellpadding="0" cellspacing="0" bgcolor="#026465">
  <tr>
    <td><div align="center"><span class="style1"> Amogh Gases Private Ltd <br></span>
<center class="style5">RATEMASTER - SUPPLEMENTARY INV</center>
<br>

<table width="603" border="0" cellpadding="0" cellspacing="0" class="wrapper">
  <tr>
    <td height="30"><img src="images/bar1.jpg" width="39" height="30" hspace="0" vspace="0" border="0" align="top" /></td>
<td height="30"><a class="MenuBarItemSubmenu" href="#" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image30','','images/bar2mas_top.jpg',1)"><img src="images/bar2mas.jpg" alt="Master" name="Image30" width="71" height="30" hspace="0" vspace="0" border="0" align="top" id="Image30"/></a></td>
<td height="30"><img src="images/bar3.jpg" width="33" height="30" hspace="0" vspace="0" border="0" align="top" /></td>
<td height="30"><a class="MenuBarItemSubmenu" href="#" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image31','','images/bar4sale_top.jpg',1)"><img src="images/bar4sale.jpg" alt="Sales" name="Image31" width="60" height="30" hspace="0" vspace="0" border="0" align="top" id="Image31"/></a></td>
<td height="30">      <a href="#"><img src="images/bar5.jpg" width="34" height="30" hspace="0" vspace="0" border="0" align="top" /></a></td>
<td height="30">     <a class="MenuBarItemSubmenu" href="#" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image32','','images/bar6purch_top.jpg',1)"><img src="images/bar6purch.jpg" alt="Sales" name="Image32" width="101" height="30" hspace="0" vspace="0" border="0" align="top" id="Image32"/></a> </td>
<td height="30">     <img src="images/bar7.jpg" width="33" height="30" hspace="0" vspace="0" border="0" align="top" /></td>
<td height="30">     <img src="images/bar8repo.jpg" width="81" height="30" hspace="0" vspace="0" border="0" align="top" /></td>
<td height="30">     <img src="images/bar9.jpg" width="33" height="30" hspace="0" vspace="0" border="0" align="top" /></td>
<td height="30">     <img src="images/bar10util.jpg" width="80" height="30" hspace="0" vspace="0" border="0" align="top" /></td>
<td height="30">     <img src="images/bar11.jpg" width="38" height="30" hspace="0" vspace="0" border="0" align="top" /></td>
  </td>
  </tr>
</table>
<span class="style7">.</span></div>
</td>
  </tr>
</table>

<?
    $result = mysql_query("SELECT Ac_code, Ac_desc FROM ACMAST ORDER BY Ac_desc");
    $result2 = mysql_query("SELECT Prod_desc FROM PRODMAST ORDER BY Prod_desc");

//--Table RATEMASTER_draft values------
$res=mysql_query("select * from RATEMASTER_draft WHERE usr='$user'");
$row = mysql_fetch_assoc($res);

$acode=$row['Ac_code'];
$prodesc=$row['Prod_desc'];
$rateno=$row['Rate_perno'];
$rateltr=$row['Rate_perltr'];
$ratecumtr=$row['Rate_percumtr'];
$ratekg=$row['Rate_perkg'];
$exc=$row['Excise_rate'];
$ces=$row['Cess_Excise'];
$edu=$row['Edu_cess'];
$fre=$row['Freight'];
$load=$row['Loading_chrgs'];
$unload=$row['Unloading_chrgs'];    

$cname=mysql_query("select Ac_desc from ACMAST WHERE Ac_code='$acode'");
$cname2=mysql_fetch_assoc($cname);
$cname3=$cname2['Ac_desc'];

echo "<form name='f1'>";
echo "<table width='730' border='0' align='center' cellpadding='0' cellspacing='1'>";
echo "  <tr>";
echo "    <td width='109' height='40'><span class='style3'>Customer </span></td>";

echo "  <td colspan='4'>";
echo "<select name='Accode' onchange=\"showUser(this.value);\"><option value='$acode'>$cname3</option>";
    while($nt=mysql_fetch_assoc($result))
    { //Array or records stored in $nt
    echo "<option value=$nt[Ac_code]>$nt[Ac_desc]</option>";
    }
    echo "</select>";// Closing of list box
echo "</td>";

echo "  <td colspan='3'>";
    echo " <span class='style3'>Gas Type &nbsp;</span> <select name='Proddesc' onchange=\"showprodes(this.value);\"><option value='$prodesc'>$prodesc</option>";
    while($nt2=mysql_fetch_assoc($result2))
    {//Array or records stored in $nt
    echo "<option value='$nt2[Prod_desc]'>$nt2[Prod_desc]</option>";
    /* Option values are added by looping through the array */
    }
    echo "</select>";// Closing of list box

echo "  </td>";
echo "  </tr>";
echo "  <tr>";
echo "    <td><span class='style3'>Rate per no</span></td>";
echo "  <td width='76' height='40'><input name='perno' type='text' size='6' maxlength='6' value='$rateno' onchange=\"showperno(this.value);\"></td>";
echo "  <td width='96'><span class='style3'>Rate per ltr</span></td>";
echo "    <td width='81'><input name='perltr' type='text' size='6' maxlength='6' value='$rateltr' onchange=\"showperltr(this.value);\"></td>";
echo "    <td width='111'><span class='style3'>Rate per cu mtr</span></td>";
echo "    <td width='77'><input name='percu' type='text' size='6' maxlength='6' value='$ratecumtr' onchange=\"showpercu(this.value);\"></td>";
echo "    <td width='117'><span class='style3'>Rate per kg</span></td>";
echo "    <td width='54'><input name='perkg' type='text' size='6' maxlength='6' value='$ratekg' onchange=\"showperkg(this.value);\"></td>";
echo "  </tr>";
echo "  <tr>";
echo "    <td height='40'><span class='style3'>Excise rate</span></td>";
echo "    <td><input name='excise' type='text' size='6' maxlength='6' value='$exc' onchange=\"showexcise(this.value);\"></td>";
echo "    <td><span class='style3'>Cess Excise</span></td>";
echo "    <td><input name='cess' type='text' size='6' maxlength='6' value='$ces' onchange=\"showcess(this.value);\"></td>";
echo "    <td><span class='style3'>Edu cess</span></td>";
echo "    <td><input name='edu' type='text' size='6' maxlength='6' value='$edu' onchange=\"showedu(this.value);\"></td>";
echo "    <td><span class='style3'>Freight</span></td>";
echo "    <td><span class='style3'><input name='freight' type='text' size='6' maxlength='6' value='$fre' onchange=\"showfreight(this.value);\"></span></td>";
echo "  </tr>";
echo "  <tr>";
//echo "    <td height='40'><span class='style3'>Collection chrgs</span></td>";
//echo "    <td><input name='coll' type='text' size='6' maxlength='6' onchange=\"showcoll(this.value);\"></td>";
echo "    <td><span class='style3'>Loading chrgs</span></td>";
echo "    <td><input name='loading' type='text' size='6' maxlength='6' value='$load' onchange=\"showloading(this.value);\"></td>";
echo "    <td><span class='style3'>Unloading chrgs</span></td>";
echo "    <td><input name='unloading' type='text' size='6' maxlength='6' value='$unload' onchange=\"showunloading(this.value);\"></td>";
// echo "    <td><span class='style3'>Transport chrgs</span></td>";
// echo "    <td><input name='transport' type='text' size='6' maxlength='6' onchange=\"showtransport(this.value);\"></td>";
echo "  </tr>";

echo "  <tr>";
echo "    <td><span class='style4'>Suplimentry Invoice</span></td>";

echo "    <td>";
echo "<select name='supli'><option value='1'>Yes</option>";
      echo "</select>";// Closing of list box
echo "</td>";

echo "    <td height='40'><span class='style3'>VAT</span></td>";
echo "    <td><input name='vat' type='text' size='6' maxlength='6' onchange=\"showvat(this.value);\"></td>";
echo "    <td><span class='style3'>CST with CForm</span></td>";
echo "    <td><input name='cst' type='text' size='6' maxlength='6' onchange=\"showcst(this.value);\"></td>";
echo "    <td><span class='style3'>CST without CForm</span></td>";
echo "    <td><input name='cstc' type='text' size='6' maxlength='6' onchange=\"showcstwithout(this.value);\"></td>";
echo "  </tr>";

echo "  <tr>";
echo "    <td height='40'><span class='style4'>Balance Rate</span></td>";
echo "    <td><input name='balrate' type='text' size='6' maxlength='6' onchange=\"showbal(this.value);\"></td>";
echo "    <td><span class='style4'>Description</span></td>";
echo "    <td colspan='5'><input name='desc' type='text' size='70' maxlength='200' value='Transportation and Other Misc Expenses incurred against original Invoice No: ' onchange=\"showdesc(this.value);\"></td>";
echo "  </tr>";

echo "</table>";

echo "</form>";
?>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:36:14.913

您可能会误解 onChange-Function 的含义。当您在字段外单击时调用它，而不是在按下键时调用。

这宁愿是我要说的 onKeyUp 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:41:41.757

Onchange 表示；在元素失去焦点后以另一种方式“完成更改后”。

只有在您完成选择 onchange 后才会触发。

如果您想从键盘执行此操作，只需选择带有向上和向下的项目并选择 (ENTER)，然后按 TAB 使该元素失去焦点

并且，为了防止 ajax 调用被缓存添加一个唯一的时间戳数据到 url 你可以通过改变这样的行来做到这一点；

```
xmlhttp.open("GET","ratecst.php?q16=" + str16 +"&ts="+new Date().getTime(),true); 
```

# r - 在 R 中读取大文件时出现“扫描错误”

> ID：13585195
> 
> 赞同：3
> 
> 时间：2012-11-27T13:23:06.277
> 
> 标签：r, error-handling

我有一个大约 5,00,000 行和 1000 列的大文件。我正在尝试在 R 中按如下方式阅读它：

```
> tab5rows <- read.delim("file_name.txt", header=TRUE,nrows=5)
> classes <- sapply(tab5rows, class)
> data <- read.delim("file_name.txt",  header=TRUE,nrows=500000,colClasses=classes,comment.char="") 
```

但是在做最后一行时，我收到以下错误。

```
Error in scan(file, what, nmax, sep, dec, quote, skip, nlines, na.strings,  :
  scan() expected 'an integer', got '0,00' 
```

谁能帮我知道我该如何解决这个问题？我无法在记事本或 Excel 中打开我的文件，因为它非常大。我怎样才能从 R 解决这个问题？

感谢您的帮助。提前致谢。

# mysql - 为什么 SQL 声明失败？

> ID：13585197
> 
> 赞同：2
> 
> 时间：2012-11-27T13:23:09.257
> 
> 标签：mysql, sql, declare

我有这段代码：

```
BEGIN
    DECLARE @NewLine CHAR(2)
    SET @NewLine = CHAR(13)+CHAR(10)
END 
```

当我在 phpmyadmin 中运行它时，我收到此错误：

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DECLARE @NewLine CHAR(2) SET @NewLine = CHAR(13) + CHAR(10) END' at line 2 
```

我在谷歌上用了大约 2 个小时，没有任何运气。据我所知，它应该是正确的语法。有人请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T13:33:34.877

`IF`像这样的流语句`WHEN`只允许在 MySQL 的存储过程或函数中使用。`BEGIN`并且`END`是此类语句的分隔符。

将该代码放入一个过程中，它应该可以工作。

## 编辑

示例过程

```
DELIMITER // 
CREATE PROCEDURE newline_proc(input varchar(1000))
BEGIN
  declare newline char(2);
  select CHAR(13)+CHAR(10) into newline;
  ...
END//
DELIMITER ; 
```

# html - IE 6、7 悬停适用于除右下角以外的所有角落

> ID：13585212
> 
> 赞同：4
> 
> 时间：2012-11-27T13:24:14.747
> 
> 标签：html, css, internet-explorer-7, internet-explorer-6

我希望不同角落的不同菜单项具有简单的悬停效果。以下代码正在工作。但只有右下菜单项在 IE6 和 IE7 中没有发挥适当的作用。怎么了？

这是[小提琴](http://jsfiddle.net/neqb5/3/)。

**CSS：**

```
.d
{
    height:50px;
    width:50px;
    background-color:#b2b2b2;
    position:fixed !important;
    *position: absolute;
}

.da {position:absolute;}

#d1 {left:0; top:0;}
#d2 {right:0; top:0;}
#d3 {right:0; bottom:0;}
#d4 {left:0; bottom:0;}

#d1a {bottom:0; right:0;}
#d2a {bottom:0; left:0;}
#d3a {top:0; left:0;}
#d4a {top:0; right:0;}

#d1a:hover {right:-5px; bottom:-5px;}
#d2a:hover {bottom:-5px; left:-5px;}
#d3a:hover {top:-5px; left:-5px;}
#d4a:hover {top:-5px; right:-5px;} 
```

**HTML：**

```
<div class="d" id="d1">
    <a class="da" href="#" id="d1a"><img src="images/contact.png" /></a>
</div>
<div class="d" id="d2">
    <a class="da" href="#" id="d2a"><img src="images/contact.png" /></a>
</div>
<div class="d" id="d3">
    <a class="da" href="#" id="d3a"><img src="images/contact.png" /></a>
</div>
<div class="d" id="d4">
    <a class="da" href="#" id="d4a"><img src="images/contact.png" /></a>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T20:36:33.150

由于某种原因，IE6 和 IE7 在 BR 上遇到了负数问题。

奇怪的是，如果你删除 #d3a {top:0; left:0} css 规则，（这应该是它的默认位置）问题就消失了。实际上，如果您使用它...除了 top:0, left:0 之外的任何值都允许浏览器正确确定 #d3a div 的悬停位置。

在 #d3a:hover 规则上使用 !important 的进一步实验将有助于支持这不是正确应用 css 的问题，而是浏览器正确呈现位置的能力。（也就是说，css样式正在应用......但没有效果。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T16:05:11.760

我找到了以下问题的解决方案：

1）添加`visibility:hidden`到`#d3a:hover`块

或者

2）添加`margin-left:0%`到`#d3a:hover`块

这两种解决方案都会使代码在 IE6 和 IE7 中正常运行。（即使它也适用于 IE5.5）

# c# - 单击按钮时如何在面板中编写 HTML 内容？

> ID：13585213
> 
> 赞同：0
> 
> 时间：2012-11-27T13:24:14.667
> 
> 标签：c#, asp.net, button, panel, dynamic-data

单击按钮时，我想在面板中加载 HTML 内容。内容是通过获取数据库从 c# 代码生成的。

目前我必须在面板中加载页面加载内容并在按钮单击时使面板可见。但这使得网站速度非常低。那么请告诉我如何在面板中按需加载html内容？

单击按钮时要在面板中编写的代码应该是这样的：

```
<p><%=databaseFuncs.getName() %></p> 
```

如您所见，我希望在单击按钮时发生一些事情：首先应该执行 C# 代码，然后将其封装在段落标记中，然后写入面板。应该对所有数据库行一一重复。请帮忙。

另请注意，我不想使用自定义 asp.net 控件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:23:20.973

只需制作

```
databaseFuncs 
```

公共和

```
databaseFuncs.getName() 
```

公开的，您的代码应该可以工作...

如果代码在 runat="server" 中，则只需使用 '#' 而不是 '='

# android - 为预蜂窝构建渲染脚本

> ID：13585214
> 
> 赞同：1
> 
> 时间：2012-11-27T13:24:16.563
> 
> 标签：android, adt, renderscript

我有一个 targetVersion 为 16 的项目，我正在使用 SherlockActionBar 和 support-library 来支持 API 级别 8。我正在尝试将[CarouselView](http://code.google.com/p/android-ui-utils/downloads/detail?name=CarouselExample.zip)集成到我的项目中。我计划将 CarouselView 用于支持的版本，将 pageViewer 用于其他版本。我正在使用 Jetbrains IDEA 进行开发。通常我可以使用 IDEA 毫无问题地构建和部署我的应用程序。但是我无法使用 android-tools 构建应用程序。产生的错误在底部。

在调查错误时，我意识到 renderscript 尝试使用 api-level 8 进行编译。我查看了 %sdk.dir%\tools\ant\build.xml 并看到 renderscript 目标使用 project.minSdkVersion 作为 targetApi。这是一个错误还是什么？

```
<renderscript executable="${renderscript}"
            includePathRefId="android.renderscript.include.path"
            genFolder="${gen.absolute.dir}"
            resFolder="${out.res.absolute.dir}/raw"
            targetApi="${project.minSdkVersion}"
            optLevel="${renderscript.opt.level}"
            buildType="${build.is.packaging.debug}"
            previousBuildType="${build.last.is.packaging.debug}">
        <source path="${source.absolute.dir}"/
</renderscript> 
```

> -代码生成：
> 
> [mergemanifest] 找到已删除的目标文件 [mergemanifest] 将 AndroidManifest 文件合并为一个。[mergemanifest] 清单合并已禁用。仅使用项目清单。[echo] 处理aidl 文件... [aidl] 没有要编译的AIDL 文件。[echo] ---------- [echo] 处理 RenderScript 文件... [renderscript] 找到 1 个 RenderScript 文件。 **[renderscript] 使用 -target-api 8 编译 1 个 RenderScript 文件**[renderscript] 优化级别：0 [llvm-rs-cc.exe] D:\Projects\TEB\teb\src\com\pozitron\teb\customwidgets\carousel\carousel.rs:236:14：错误：包含向量的结构维度 3 无法在此 API 级别导出：'carouselPlane' [llvm-rs-cc.exe] D:\Projects\TEB\teb\src\com\pozitron\teb\customwidgets\carousel\carousel.rs:242： 17：错误：无法在此 API 级别导出包含维度 3 向量的结构：'carouselCylinder' [llvm-rs-cc.exe] D:\Projects\TEB\teb\src\com\pozitron\teb\customwidgets\carousel \carousel.rs:254:21：错误：无法在此 API 级别导出包含维度 3 向量的结构：'cardVertices' [llvm-rs-cc.exe] D:\Projects\TEB\teb\src\com\ pozitron\teb\customwidgets\carousel\carousel.rs:262:26: 错误：无法在此 API 级别导出包含维度 3 向量的结构：'camera' [llvm-rs-cc.exe] D:\Projects\TEB\teb\src\com\pozitron\teb\customwidgets\carousel\carousel.rs :1503:20: 错误：无法在此 API 级别导出包含维度 3 向量的结构：'p' [llvm-rs-cc.exe] D:\Projects\TEB\teb\src\com\pozitron\teb\ customwidgets\carousel\carousel.rs:1045:9：错误：无法在此 API 级别导出包含维度 3 向量的结构：'ray' [llvm-rs-cc.exe] D:\Projects\TEB\teb\src \com\pozitron\teb\customwidgets\carousel\carousel.rs:1092:9：错误：无法在此 API 级别导出包含维度 3 向量的结构：'ray' [llvm-rs-cc.exe] D:\项目 [llvm-rs-cc.exe] ects\TEB\teb\src\com\pozitron\teb\customwidgets\carousel\carousel.rs:1503:20: 错误：包含维度为 3 c [llvm-rs-cc.exe] 的向量的结构不能在此 API 级别导出：'p' [llvm-rs-cc.exe] D:\Projects\TEB\teb\src\com\pozitron \teb\customwidgets\carousel\carousel.rs:1781:17：错误：无法在此 API 级别导出包含维度 3 向量的结构：'ray'
> 
> BUILD FAILED D:\Android\android-sdk\tools\ant\build.xml:645：执行此行时出现以下错误：D:\Android\android-sdk\tools\ant\build.xml:665: null返回：1

编辑：正如 Selvin 建议的那样，我从旧版本中复制了 renderscript 文件夹和 llvm-rs-cc.exe。现在我收到以下错误：

```
[mergemanifest] Found Deleted Target File
[mergemanifest] Merging AndroidManifest files into one.
[mergemanifest] Manifest merger disabled. Using project manifest only.
     [echo] Handling aidl files...
     [aidl] No AIDL files to compile.
     [echo] ----------
     [echo] Handling RenderScript files...
[renderscript] Found 1 RenderScript files.
[renderscript] Compiling 1 RenderScript files with -target-api 8
[renderscript] Optimization Level: 0
[llvm-rs-cc.exe] Generating ScriptC_carousel.java ...
[llvm-rs-cc.exe] Generating ScriptField_ProgramStore_s.java ...
[llvm-rs-cc.exe] Generating ScriptField_Card.java ...
[llvm-rs-cc.exe] Generating ScriptField_FragmentShaderConstants_s.java ...
     [echo] ----------
     [echo] Handling Resources...
     [aapt] Found Deleted Target File
     [aapt] Generating resource IDs...

BUILD FAILED
D:\Android\android-sdk\tools\ant\build.xml:645: The following error occurred while executing this line:
D:\Android\android-sdk\tools\ant\build.xml:683: java.lang.IllegalAccessError: tried to access class com.google.common.base.Platform from class com.google.common.base.CharMatcher
        at com.google.common.base.CharMatcher.precomputed(CharMatcher.java:684)
        at com.google.common.base.CharMatcher.<clinit>(CharMatcher.java:63)
        at com.google.common.base.Splitter.on(Splitter.java:129)
        at com.android.sdklib.internal.build.SymbolWriter.write(SymbolWriter.java:51)
        at com.android.ant.AaptExecTask.execute(AaptExecTask.java:711)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
        at com.android.ant.IfElseTask.execute(IfElseTask.java:120)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.MacroInstance.execute(MacroInstance.java:398)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.Target.execute(Target.java:390)
        at org.apache.tools.ant.Target.performTasks(Target.java:411)
        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
        at org.apache.tools.ant.Project.executeTarget(Project.java:1368)
        at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
        at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
        at org.apache.tools.ant.Main.runBuild(Main.java:809)
        at org.apache.tools.ant.Main.startAnt(Main.java:217)
        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)
        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T03:47:59.370

您关于目标 API 与最低 API 级别的 SDK 错误实际上是 Android SDK 编译代码的方式中的错误。至于使用较旧的 SDK/编译器来忽略 float3 问题，请不要这样做。这实际上是旧编译器和设备的一个错误，因为 float3 对齐/打包没有正确处理。旧设备的正确解决方案是使用 float4（在所有设备上都可以正常工作）。如果您使用 r15 中的旧编译器，您最终会得到仅适用于旧设备的某些子集的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:48:24.313

i've got the same problem...

i assuming that you're using newest SDK (21) with platform tool 16...

from this version render script doesn't like structures like

```
typedef struct Ray_s {
    float3 position;
    float3 direction;
} Ray; 
```

with float3... so download older platform tools from:

[http://dl.google.com/android/repository/platform-tools_r15_rc9-linux.zip](http://dl.google.com/android/repository/platform-tools_r15_rc9-linux.zip)

[http://dl.google.com/android/repository/platform-tools_r15_rc9-windows.zip](http://dl.google.com/android/repository/platform-tools_r15_rc9-windows.zip)

[http://dl.google.com/android/repository/platform-tools_r15_rc9-macosx.zip](http://dl.google.com/android/repository/platform-tools_r15_rc9-macosx.zip)

make copy of your

C:\adsdk\platform-tools\llvm-rs-cc.exe <= this file

and

C:\adsdk\platform-tools\renderscript <= whole folder

and replace them with the ones from zip

OR

replace float3 with float4 in render script and do other code change(i'm pretty sure that changing only float3 to float4 will not work)

# ios - 如何检测我的苹果设备是否支持蓝牙低功耗

> ID：13585218
> 
> 赞同：14
> 
> 时间：2012-11-27T13:24:22.397
> 
> 标签：ios, bluetooth, bluetooth-lowenergy

是否有一个 API，我可以通过它判断我的应用程序运行的 Apple 设备（iPad/iPod/iPhone）是否支持蓝牙低功耗（BTLE）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-10T12:18:36.613

假设您有一个 iOS5 或 iOS6 设备并且您有一个 CBCentralManager 对象，您可以使用以下命令检查它的 CBCentralManagerState：

```
switch ([_manager state])
{
    case CBCentralManagerStateUnsupported:
        state = @"This device does not support Bluetooth Low Energy.";
        break;
    case CBCentralManagerStateUnauthorized:
        state = @"This app is not authorized to use Bluetooth Low Energy.";
        break;
    case CBCentralManagerStatePoweredOff:
        state = @"Bluetooth on this device is currently powered off.";
        break;
    case CBCentralManagerStateResetting:
        state = @"The BLE Manager is resetting; a state update is pending.";
        break;
    case CBCentralManagerStatePoweredOn:
        state = @"Bluetooth LE is turned on and ready for communication.";
        break;
    case CBCentralManagerStateUnknown:
        state = @"The state of the BLE Manager is unknown.";
        break;
    default:
        state = @"The state of the BLE Manager is unknown.";

} 
```

您`centralManagerDidUpdateState:central`还需要关注委托更新，然后在您的应用程序中采取适当的操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-16T13:59:46.387

另一种选择是检查设备是否支持 iBeacons。这是因为设备必须支持蓝牙 LE（即蓝牙 4）才能找到 iBeacon。只需导入 CoreLocation 并使用以下内容：

迅速：

```
if (CLLocationManager.isMonitoringAvailable(for: CLBeaconRegion.self)){
    print("Bluetooth LE is supported")
} 
```

目标 C：

```
if ([CLLocationManager isMonitoringAvailableForClass:[CLBeaconRegion class]]){
    NSLog(@"Bluetooth LE is supported");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T14:24:25.100

寻找[CoreBluetooth.framework](http://developer.apple.com/library/ios/documentation/CoreBluetooth/Reference/CoreBluetooth_Framework/CoreBluetooth_Framework.pdf) ... *CBCentralManagerStateUnsupported*等。

# objective-c - 为什么 NSIndexPath 的 row 属性是有符号整数？

> ID：13585220
> 
> 赞同：19
> 
> 时间：2012-11-27T13:24:25.670
> 
> 标签：objective-c, ios6, xcode4.5

为什么 NSIndexPath 的 row 属性是有符号整数？

它会不会出现“有效”的负值？

![在此处输入图像描述](../Images/4873bda7d73d1150feae0a64e1c57a7f.png)

**编辑**

直到今天我设置 LLVM 来检查符号比较时，我才想到这一点。这使得编译器在有`indexPath.row <= [someArray count]`或类似的时候发出警告。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-27T14:15:14.657

## 如果使用负数会发生什么？

使用负值是不明智的，如果你这样做，你会得到疯狂的结果

```
NSIndexPath* path = [NSIndexPath indexPathForRow:-2 inSection:0]; 
```

上面的结果是 0 的部分和 4294967294 的行（这`NSUInteger`对我来说看起来像是下溢！）请注意，这只会发生在 UIKit Additions 类别中，而不是 NSIndexPath 本身。看看背后的概念`NSIndexPath`，持有负值真的没有意义。所以为什么？

## （可能）为什么会这样

OS X的核心对象`NSIndexPath`使用`NSUInteger`s 作为其索引，但 UIKit Addition 使用`NSInteger`. 该类别仅建立在核心对象之上，但使用`NSInteger`over`NSUInteger`并没有提供任何额外的功能。

为什么它会这样工作，我不知道。我的猜测（我规定*猜测*）是第一次启动 iOS 时的一个幼稚的 API 失误。在`UITableView`iOS 2 中发布时，它使用`NSInteger`s 表示各种事物（例如`numberOfSections`）。想一想：这在概念上没有意义，你不能有负数的部分。现在即使在 iOS 6 中，它仍然使用`NSInteger`, 所以不会破坏以前的应用程序与表格视图的兼容性。

除此之外`UITableView`，我们还添加了`NSIndexPath`，它们与表视图一起用于访问它的行等。因为它们必须一起工作，所以它们需要兼容的类型（在这种情况下`NSInteger`）。

将类型更改为`NSUInteger`全面会破坏很多东西，并且为了安全的 API 设计，所有内容都需要重命名，以便 NSInteger 和 NSUInteger 对应物可以安全地并肩工作。Apple 可能不想要这种麻烦（开发人员也不想要！），因此他们将其保留为`NSInteger`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T14:50:53.920

一个可能的原因是无符号类型很容易下溢。例如，我的`NSUInteger`代码中有一个笔画宽度变量。我需要围绕用这个笔划绘制的点创建一个“信封”，因此代码如下：

```
NSUInteger width = 3;
CGRect envelope = CGRectInset(CGRectZero, -width, -width);
NSLog(@"%@", NSStringFromCGRect(envelope)); 
```

使用无符号类型此输出`{{inf, inf}, {0, 0}}`，使用有符号整数您得到`{{-3, -3}, {6, 6}}`。原因是变量之前的一元减号`width`会产生下溢。这对某些人来说可能很明显，但会让很多程序员感到惊讶：

```
NSUInteger a = -1;
NSUInteger b =  1;
NSLog(@"a: %u, b: %u", a, -b); // a: 4294967295, b: 4294967295 
```

因此，即使在使用负值没有意义（笔画宽度不能为负）的情况下，在负上下文中使用该值也是有意义的，这会导致下溢。切换到有符号类型会减少意外，同时仍保持范围相当高。听起来是个不错的妥协。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-14T10:30:28.017

我认为 UIKit Additions 是故意`NSIndexPath`使用类型的。`NSInteger`如果由于某种原因将负行传递`parameter`给任何方法（虽然我目前没有看到...），则`NSIntegerMax + parameter`不会发生自动转换为值，并且任何可能的对象都不会寻找不存在的大得离谱的参数。不过，还有其他方法可以防止这种情况发生，所以这可能只是口味问题。

例如，我不会`NSUInteger`在类中将其作为参数`NSIndexPath`，而是`NSInteger`会检查一个符号`NSIndexPath`，如果任何参数为负数，则根本不会创建。

# ruby-on-rails - Rails，嵌套属性，不能批量分配错误

> ID：13585222
> 
> 赞同：2
> 
> 时间：2012-11-27T13:24:34.137
> 
> 标签：ruby-on-rails, ruby, nested, activeresource, mass-assignment

我在服务器上有两个模型：

喂养

```
class Feed < ActiveRecord::Base
    attr_accessible :name
    belongs_to :broadcasts
  end 
```

播送

```
 class Broadcast < ActiveRecord::Base

    validates_presence_of :content

    attr_accessible :content, feeds, feeds_attributes

    belongs_to :user
    has_many :feeds
    accepts_nested_attributes_for :feeds

    def to_s
      result = "id: " + id.to_s + " content: " + content
      if user
        result += " user: " + user.id.to_s
      end
      result
    end

    def self.per_page
      8
    end
    end 
```

在我的客户端上，我有用于 Broadcast 和 Feed 的基本 ActiveResource 类

当我尝试使用给定的提要（来自客户端）创建新的广播时：

```
feed1 = Feed.find(3) <-succesful

broadcast = Broadcast.new
broadcast.attributes['feeds_attributes'] ||= [] 
broadcast.feed_attributes << feed
broadcast.save 
```

在服务器上的 BroadcastController 中，我只是做

```
@broadcast = Broadcast.new(params[:broadcast]) 
```

这给出了以下错误：

无法批量分配受保护的属性：Feed

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:37:28.327

您不能直接将提要分配给 feed_attributes 哈希（如果这是您实际尝试做的）。

更改`broadcast.feed_attributes << feed`（不应该是 feed1 吗？）为：

```
broadcast.feed_attributes << feed1.attributes 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:28:28.457

我认为您需要在广播模型中添加一个名为 feed_id 的列，并且 attr_accessible 将是

```
attr-accessible :feed_id 
```

在广播模型内

需要创建外键

# php - 我应该在 symfony2 的哪里添加我的内部类文件？

> ID：13585223
> 
> 赞同：0
> 
> 时间：2012-11-27T13:24:34.770
> 
> 标签：php, symfony, psr-0

我将一个旧项目移植到 symfony2 以开始学习框架，但我无法意识到如何在 PHP 文件中正确添加一些辅助函数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T13:37:53.313

[服务](http://symfony.com/doc/current/book/service_container.html)。将这些函数包装在一个类中（如`Helper`），将类定义为服务，然后在需要的地方注入它（控制器或其他服务，甚至是 cli 命令）。

命名空间（因此路径，当您用 psr-0 标记问题时）由您决定。

# c# - html文档关闭时的条件弹出窗口

> ID：13585228
> 
> 赞同：0
> 
> 时间：2012-11-27T13:24:41.713
> 
> 标签：c#, javascript, asp.net

我的 CMS 上有一个内容管理页面，上面有一个弹出窗口，在页面关闭时警告用户。这是一个非常简单的警告，如下所示：

```
window.onbeforeunload = function (e) {
     return 'Are you sure you want to close?';
} 
```

它可以工作，但问题是即使用户单击相同的按钮也会显示弹出窗口。我对记录事件非常陌生，所以我不知道如何执行此操作，但我希望弹出窗口仅在页面关闭时显示，而不是在回发时显示。

另外我还没有在我的网站上使用过 JQuery，所以请不要推荐它；我不想将整个框架仅用于弹出窗口。. 谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:05:38.437

我能够通过使用全局变量来使其工作，如下所示：

```
var check = true; 
```

显示弹出窗口时检查：

```
 window.onbeforeunload = function (e) {
        if (check) {
            return 'Are you sure you want to close?';
        }
    } 
```

然后，您只需设置`check`为`false`当您单击执行回发的按钮时。希望这可以帮助某人。

# mysql - MySQL获取从位置A到位置B的行

> ID：13585231
> 
> 赞同：2
> 
> 时间：2012-11-27T13:24:46.370
> 
> 标签：mysql, database, hibernate

我想知道是否有办法获取两个特定位置之间的行（又名：在一个范围内）。我正在使用休眠，我相信可以使用 .setQuerySize(n) （相信因为我不完全确定）来获取某个行块，但我不知道如何制作它以便我可以从中获取一个块一个随机的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:25:47.580

MYSQL中有一个规定可以使用`limit`

假设您要显示 10 行，追加

```
limit 10 
```

如果您想要从第 1 行开始的前 10 条记录

附加`limit 1,10`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:32:49.393

也许是这样的？

```
Select `value` FROM db.table WHERE `value` >= 'A%' AND `value` <= 'B%' 
```

# javascript - 父窗口刷新时子窗口不关闭

> ID：13585234
> 
> 赞同：0
> 
> 时间：2012-11-27T13:24:55.360
> 
> 标签：javascript

在我的应用程序中有一个选项卡启动新应用程序，其中有 4 个链接。当我单击任何链接时，将打开一个子窗口。假设我从该链接打开了 2 个子窗口。现在我再次单击启动新应用程序，然后从链接打开其他 3 个子窗口。现在，当我注销时，只有父窗口和最后打开的 3 个子窗口关闭，而之前打开的 2 个子窗口没有关闭。我希望他们关闭

我打开子窗口的代码是 if(rowData.productVersion == "1001"){

```
 childWindow[childWindow.length]=is1001Opened=window.open('/eApps/layout/multipleAppPage.jsp?windowID='+windowID+'&newTitle='+rowData.productCode+'&paramTemp='+uri_encode); 
                    }else{

                        childWindow[childWindow.length]=window.open('/eApps/layout/multipleAppPage.jsp?windowID='+windowID+'&newTitle='+rowData.productCode+'&paramTemp='+uri_encode); 
                    } 
```

我的注销代码是

```
{
    $('#'+id).click(function(event){
        event.preventDefault();
        $('#centerContent').load('<%=request.getContextPath()%>/'+target);
    });
} else {
    $('#'+id).click(function(event){
        event.preventDefault();
        var r=confirm("logout");
        if (r==true) {
            for (var i=0;i<childWindow.length;i++) {
                if (childWindow[i] && !childWindow[i].closed) 
                    childWindow[i].close();
            }
            window.close();
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T07:33:56.367

我已经解决了这个问题。

早些时候我将变量声明为

```
 var childWindow= new Array(); 
```

现在我已将变量设为静态

```
 var childWindow;
            if (typeof childWindow!="object")
            childWindow= new Array(); 
```

# iphone - 当我没有 Internet 连接并通过 Appstore 测试时，我可以在 IOS 上使用 Exit(0) 功能吗

> ID：13585235
> 
> 赞同：0
> 
> 时间：2012-11-27T13:24:54.733
> 
> 标签：iphone, ios, appstore-approval, exit-code

我的应用程序大量依赖服务器数据，当我没有连接到我的服务器时，我无法提供任何数据。所以我向用户展示了一个屏幕，向他解释没有连接的情况，并给他一个退出应用程序的按钮我的问题是：它会通过 Appstore 测试吗？我以前从未尝试过，我知道他们不喜欢应用程序使用 exit(0)，还建议我放置一个没有按钮的屏幕并阻止用户返回其他应用程序屏幕并在此屏幕上放置一条消息让用户单击主页按钮以便不使用 exit(0) 是否允许？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T13:29:34.347

不，你不能打电话`exit`。您的应用将被拒绝。这已被 Apple 反复劝阻，并且已知会导致 iOS 多任务切换出现严重错误。您应该让用户自己使用主页按钮。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T13:34:21.040

> 不要调用退出函数。调用 exit 的应用程序将在用户看来已经崩溃，而不是执行正常终止并动画返回主屏幕。

[http://developer.apple.com/library/ios/#qa/qa1561/_index.html](http://developer.apple.com/library/ios/#qa/qa1561/_index.html)

# python - 读取串口读取中的子进程

> ID：13585238
> 
> 赞同：2
> 
> 时间：2012-11-27T13:25:05.293
> 
> 标签：python, multiprocessing

嗨，我正在使用 python 代码与我的一台设备进行串行端口通信。它正在发送一组十六进制代码，接收一组数据。处理它。

这些数据必须存储在数据库中。

我有另一个脚本，它有 MYSQLdb 库将其推入数据库。

如果我在一个脚本中按顺序执行此操作，我会在采样率上损失很多。如果我不连接到数据库并将其插入表中，我每秒最多可以采样 32 个数据集。

如果我使用 Multiprocessing 并尝试运行它，我的采样率将变为 0.75，因为父进程正在等待子进程加入。那么我该如何处理这种情况。

是否可以通过使用队列填充数据来独立运行它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:04:42.763

使用线程和队列。

这是一个例子：

```
from Queue import Queue
import threading
import serial

def readline(ser,output):
    threadLock.acquire()# Get lock to synchronize threads
    output.put(ser.readline())
    threadLock.release()# Free lock to release next thread
    # this will go on forever until you kill the program

if __name__=='__main__':
    output = Queue()
    with serial.Serial(com,baudrate=115200,timeout=1) as ser:
        ser_thread = threading.Thread(target=readline, args=(ser,output,))
        ser_thread.start()
        while(True):
             threadLock.acquire()#wait until lock is free
             try:
                 data=output.get()
             threadLock.release()# Free lock to release next thread
             # do somthing with data 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:42:55.813

使用管道。使用该`subprocess`模块创建两个进程，第一个从串行端口读取并将一组十六进制代码写入标准输出。这通过管道传送到从标准输入读取并更新数据库的第二个进程。

# android - Android：如何在所有 EditText 上全局应用 android:inputType

> ID：13585246
> 
> 赞同：3
> 
> 时间：2012-11-27T13:25:20.770
> 
> 标签：android, mobile

如何全局关闭应用程序所有 EditTexts 的自动建议？
换句话说，我如何`android:inputType="text"`在所有 EditText 上执行此操作？

```
 <EditText android:id="@+id/et1"            
        android:inputType="text">
    </EditText> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T13:33:49.323

您可以创建自定义编辑文本并在布局中使用此自定义视图

```
package com.talha.examples;
import android.content.Context;
import android.text.InputType;
import android.util.AttributeSet;
import android.widget.EditText;

public class CustomEditText extends EditText {

    public CustomEditText(Context context, AttributeSet attrs) {
        super(context, attrs);

    }

    @Override
    public void setInputType(int type) {
        // TODO Auto-generated method stub
        super.setInputType(InputType.TYPE_CLASS_TEXT);
    }
}

<com.talha.examples.CustomEditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:32:39.150

您手动修改每个 EditText。如果您正在动态地创建它们（例如通过代码），那么您已经有了引用并且可以在创建时更改 inputType。如果您通过 xml 创建它们，您可能只需要修改几个按钮，甚至不值得花时间在 stackoverlfow 上发布它。

# machine-learning - 热门商品建议 - 时间敏感数据 - 数据挖掘

> ID：13585250
> 
> 赞同：0
> 
> 时间：2012-11-27T13:25:33.430
> 
> 标签：machine-learning, data-mining, time-series, classification, prediction

我是数据挖掘领域的新手。我正在研究非常有趣的 Data Minign 问题。数据说明如下：

数据是时间敏感的。项目属性取决于时间因素及其类别标签。我将每周数据分组为训练或测试记录的一个实例。每周，一些项目属性可能会随着它的流行度（即类别标签）而变化。

部分样本数据如下：

```
IsBestPicture,MovieID,YearOfRelease,WeekYear,IsBestDirector,IsBestActor,IsBestAc‌​tress,NumberOfNominations,NumberOfAwards,..,Label
-------------------------------------------------
0_1,60000161,2000,1,9-00,0,0,0,0,0,0,0
0_1,60004480,2001,22,19-02,1,0,0,11,3,0,0
0_1,60000161,2000,5,13-00,0,0,0,0,0,0,1
0_1,60000161,2000,6,14-00,0,0,0,0,0,0,0
0_1,60000161,2000,11,19-00,0,0,0,0,0,0,1 
```

我的研究顾问建议使用朴素贝叶斯算法，它可以适应这种随时间变化的动态数据。

我使用 2000-2004 年的数据作为训练，2005 年作为测试。如果我在我的项目数据集中包含 Week-Year 属性，那么它将导致朴素贝叶斯的概率为 0。按时间顺序组织数据后，可以从我的数据集中省略此属性吗？

此外，当我阅读新的测试用例时如何调整我的模型？因为新的测试用例可能会导致类标签的变化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:30:01.843

你能提供更多关于你的方法的见解吗？例如，您使用的是 R、SPSS、Python、SQL Server 2008R2 还是 RapidMiner 5.2？如果您可以包含一些数据的非常小的（3-4 行段），这将有助于人们弄清楚如何解决这个问题。

了解您正在查看的内容的一种直接方法是进行随机森林/决策树和 K-Means 聚类，以确定数据中的常见分离点。您是否开始快速浏览数据的直方图、平均值和异常值？

# sql - SQLPLUS 查询问题

> ID：13585255
> 
> 赞同：0
> 
> 时间：2012-11-27T13:25:42.807
> 
> 标签：sql, oracle, sqlplus

我最近一直在使用 SQL*PLus，我的任务之一是显示满足以下条件的所有员工的 EmpCode、EmpName 和 PostCode：他们出售的每件商品的价格值都高于所有库存商品的平均值

编辑：嗨，马克，我写了一些类似于你建议的东西，但我知道产生的答案是错误的。

```
select E.EmpCode, E.EmpName, PostCode
from Employees E
LEFT OUTER JOIN Stocks ST
where Price >
(select AVG(Quantity) from Stocks
where E.EmpCode = ST.Empcde; 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T13:28:30.517

尝试这样的事情

```
select distinct EmpCode, EmpName, PostCode
from Employees e
LEFT JOIN Stocks st On e.columnName= st.columnName
where Price >
(select AVG(Quantity) from Stocks
where e.EmpCode = st.EmpCode) 
```

[LEFT JOIN](http://www.w3schools.com/sql/sql_join_left.asp)的语法是

```
t1 LEFT JOIN t2 ON t1.id = t2.id 
```

最后还有一个缺少的括号

# spring - 将 Spring @Value 注释评估为原始布尔值

> ID：13585259
> 
> 赞同：33
> 
> 时间：2012-11-27T13:25:51.940
> 
> 标签：spring, annotations

我有一个带有布尔字段的 Spring带`@Configuration`注释的类`MappingsClientConfig`：

```
 @Value("${mappings.enabled:true}")
 private boolean mappingsEnabled; 
```

此类被导入另一个 Spring 注释类，如下所示：

```
@Configuration
@Import(MappingsClientConfig.class)
public class LookupManagerConfig { 
```

在测试用例中通过 Spring 上下文实例化类时，容器无法将字符串解析为布尔字段`mappingsEnabled`，我得到：

```
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private boolean com.barcap.tcw.mappings.economic.client.config.EconomicMappingsClientConfig.economicMappingsEnabled; nested exception is org.springframework.beans.TypeMismatchException: Failed to convert value of type 'java.lang.String' to required type 'boolean'; nested exception is java.lang.IllegalArgumentException: Invalid boolean value [${mappings.enabled:true}]
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:502)
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:84)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:282)
    ... 138 more
Caused by: org.springframework.beans.TypeMismatchException: Failed to convert value of type 'java.lang.String' to required type 'boolean'; nested exception is java.lang.IllegalArgumentException: Invalid boolean value [${mappings.enabled:true}]
    at org.springframework.beans.SimpleTypeConverter.convertIfNecessary(SimpleTypeConverter.java:61)
    at org.springframework.beans.SimpleTypeConverter.convertIfNecessary(SimpleTypeConverter.java:43)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:718)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:703)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:474)
    ... 140 more
Caused by: java.lang.IllegalArgumentException: Invalid boolean value [${mappings.enabled:true}]
    at org.springframework.beans.propertyeditors.CustomBooleanEditor.setAsText(CustomBooleanEditor.java:124)
    at org.springframework.beans.TypeConverterDelegate.doConvertTextValue(TypeConverterDelegate.java:416)
    at org.springframework.beans.TypeConverterDelegate.doConvertValue(TypeConverterDelegate.java:388)
    at org.springframework.beans.TypeConverterDelegate.convertIfNecessary(TypeConverterDelegate.java:157)
    at org.springframework.beans.TypeConverterDelegate.convertIfNecessary(TypeConverterDelegate.java:93)
    at org.springframework.beans.SimpleTypeConverter.convertIfNecessary(SimpleTypeConverter.java:49)
    ... 144 more 
```

关于我错过了什么的任何线索？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2018-02-16T00:28:00.820

它是一个旧线程，但如果您仍想使用 @Value Spring 注释注入非字符串值，请执行以下操作：

```
@Value("#{new Boolean('${item.priceFactor}')}")
private Boolean itemFactorBoolean;

@Value("#{new Integer('${item.priceFactor}')}")
private Integer itemFactorInteger; 
```

在带有 Java 8 的 Spring boot 1.5.9 上为我工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-27T14:40:40.717

看起来您缺少 PropertyPlaceholderConfigurer。您需要将其注册为 bean factory 后处理器。理论上可以这样完成：

```
public class PostProcessorConfig {

    @Bean
    public BeanFactoryPostProcessor getPP() {
       PropertyPlaceholderConfigurer configurer = new PropertyPlaceholderConfigurer();
       configurer.setLocations(new Resource[]{new ClassPathResource("/my.properties")});
       return configurer;
    }
} 
```

但是，似乎有一个[错误](https://jira.springsource.org/browse/SPR-8269)会导致基于 java 的配置执行此操作时出现其他问题。有关解决方法，请参阅票证。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-19T16:15:20.287

这就是在我们的项目中解决它的方式，因为其他答案对我们不起作用。我们也在使用春季批次。

主要工作配置：

```
@Configuration
@EnableBatchProcessing
@PropertySource("classpath:application.properties")
public class MainJobConfiguration {
    @Autowired
    PipelineConfig config;

    @Bean
    public PipelineConfig pipelineConfig(){
        return new PipelineConfig();
    }

    // To resolve ${} in @Value
    @Bean
    public static PropertySourcesPlaceholderConfigurer propertyConfigInDev() {
        return new PropertySourcesPlaceholderConfigurer();
    }

    // job stuff ...
} 
```

属性配置加载器：

```
public class PipelineConfig {
    @Value("${option}")
    private boolean option;
} 
```

请注意`@Value`PipelineConfig 中的情况，但从中加载选项的实际属性是在作业类中指定的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-05T07:48:40.433

您甚至不需要属性文件，例如：

```
    <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer" />

```

# css - 3 垂直 div 中间一个占用页脚和页眉留下的空间，但中间 div 溢出时显示滚动条

> ID：13585268
> 
> 赞同：0
> 
> 时间：2012-11-27T13:26:36.317
> 
> 标签：css, html, overflow

我正在尝试解决滚动条问题。

我有一个问题，我想让三个 div 垂直对齐，而中间的 div 将在页脚和页眉的左边留出空间

这篇文章帮助我完成了这部分：[Middle div with 100% in CSS?](https://stackoverflow.com/questions/11264339/middle-div-with-100-in-css)

事情是我需要内容 div（中间 div）在内容溢出中间 div 空间时显示滚动条。

现在我有了这个：http: [//jsfiddle.net/rv4XS/31/](http://jsfiddle.net/rv4XS/31/)

```
<body>
   <div id="wrap">
      <div id="container">
   <div id="header">header
   </div>
   <div id="content">data<br/>
      data<br/>data<br/>data<br/>data<br/>data<br/>data<br/>data<br/>data<br/>data<br/>
   </div>
   </div>
   </div>
      <div id="footer">footer
   </div>
</body>​ 
```

谢谢您的帮助。

编辑 1：只有 firefox 和 chrome，没有 IE。

编辑2：也许我没有很好地解释我的问题：我有一个根据它所拥有的内容具有可变高度的页眉，页脚有一个固定的高度。现在，知道页眉的高度是可变的，而页脚的高度是固定的，我怎样才能制作一个中间 div（内容 div）来占用页脚和页眉留下的所有空间？

如果页眉的高度增加了很多......会发生什么是中间的 div 将不可见，而只有页眉和页脚。当然这个想法是，如果中间 div 里面有一些数据并且被裁剪，它必须显示滚动条。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:41:21.910

你可以给**#content**如下：

***注意：***不能像你给出的那样给出 %。那么它占据了内容所具有的整个高度和宽度。

**正确的一个**

```
 #content {
    width:100%;
    height:100px;
    overflow: auto;
   } 
```

我已经更新**[了 JSFIDLER](http://jsfiddle.net/rv4XS/34/)**

# spring - 登录成功后getPrincipal()返回null

> ID：13585270
> 
> 赞同：1
> 
> 时间：2012-11-27T13:26:45.863
> 
> 标签：spring, security, principal

我在我的 spring 安全配置中使用了多个 http 元素[具有不同的模式]。每个都指向一个单独的身份验证管理器。我能够成功登录所有 http 元素。但是，登录成功后，返回的 Principal 对象为空。请帮我。

**spring security的内容如下**

```
<http pattern="teacher/login*" authentication-manager-   
        ref="teacherAuthenticationManager">
        <intercept-url pattern="teacher/login*" access="ROLE_TEACHER" />
            <http-basic`enter code here` />
        </http>
        <http pattern="student/login*" authentication-manager- 
        ref="studentAuthenticationManager">
        <intercept-url pattern="student/login*" access="ROLE_STUDENT" />
        <http-basic />
        </http>
        <authentication-manager alias="teacherAuthenticationManager">
        <authentication-provider>
        <!--  <password-encoder hash="md5"/>-->
        <jdbc-user-service data-source-ref="dataSources"
        users-by-username-query="
            select username,password,true 
                from Teacher where username=?" 

            authorities-by-username-query="
            select username,'ROLE_TEACHER' from Teacher where username=?" />
        </authentication-provider>
       </authentication-manager>

       <authentication-manager alias="studentAuthenticationManager">
            <authentication-provider>
        <!--  <password-encoder hash="md5"/>-->
        <jdbc-user-service data-source-ref="dataSources"
        users-by-username-query="
            select username,password,true 
            from Student where username=?" 

        authorities-by-username-query="
                select username,'ROLE_STUDENT' from Student where username=?" />
            </authentication-provider>
        </authentication-manager> 
```

**web.xml如下**

```
<display-name>Spring Web MVC Application</display-name>
    <welcome-file-list>
        <welcome-file>/index.html</welcome-file>
    </welcome-file-list>

    <servlet>
        <servlet-name>mvc-dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>mvc-dispatcher</servlet-name>
        <url-pattern>/rest/*</url-pattern>
    </servlet-mapping>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/mvc-dispatcher-servlet.xml,
            /WEB-INF/spring-security.xml
        </param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
        <dispatcher>FORWARD</dispatcher>
                <dispatcher>REQUEST</dispatcher>
                <dispatcher>ERROR</dispatcher>
    </filter-mapping> 
```

**控制器代码**

```
 @RequestMapping(value = "/teacher/login", method = RequestMethod.GET)
    public @ResponseBody MethodResponse teacherlogin( Principal principal) {
        System.out.println("Welcome Teacher");
        MethodResponse methodResponse = new MethodResponse();
        try {
            //org.springframework.security.core.userdetails.User user = (org.springframework.security.core.userdetails.User) SecurityContextHolder.getContext().getAuthentication().getPrincipal();

                    System.out.println("Is Principal Null:"+Boolean.valueOf(principal==null));
                    final String name = principal.getName();

                    String sql="Select * from Teacher where UserName=?";
                    Teacher teacher = jdbcTemplate.queryForObject(sql,
                            ParameterizedBeanPropertyRowMapper
                                    .newInstance(Teacher.class),name);

                    methodResponse.setData(teacher);

            //String sql = " Select * from Teacher where TeacherId=?";

            /*
            List<Teacher> list = jdbcTemplate.query(sql,
                    ParameterizedBeanPropertyRowMapper
                            .newInstance(Teacher.class), teacherId);

            Teacher[] teachers = list.toArray(new Teacher[] {});
            methodResponse.setDataArray(teachers);*/

            methodResponse
                    .setResponseCode(GlobalConstants.SERVICE_STATUS_CODE_SUCCESS);
            methodResponse
                    .setResponseMessage(GlobalConstants.SERVICE_STATUS_MSG_SUCCESS);
        } catch (Exception e) {
            e.printStackTrace();
            methodResponse
                    .setResponseCode(GlobalConstants.SERVICE_STATUS_CODE_DATABASE_ERROR);
            methodResponse.setResponseMessage(e.getMessage());
        }
        return methodResponse;
    } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-27T16:48:37.453

servlet 映射到 /rest/* 并且这些 URL 不受您的过滤器的保护（所以我希望主体为空）。这能解释你看到的行为吗？

# google-apps-script - 在谷歌文档中插入日期时间

> ID：13585272
> 
> 赞同：40
> 
> 时间：2012-11-27T13:26:54.673
> 
> 标签：google-apps-script, timestamp, google-docs

我想在 Google 文档中插入时间戳（日期和/或时间）。支持文档（）说应该有键盘快捷键，但在我的环境（Win7 + IE9）下不起作用。

谁能为我提供一个 Google Apps 脚本来实现这一目标？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2014-02-10T14:15:37.610

This works well

In Google Docs : Tools -> Open Script Editor and save this script

```
function onOpen() {
  var ui = DocumentApp.getUi();
  // Or FormApp or SpreadsheetApp.
  ui.createMenu('Custom Menu')
      .addItem('Insert Date', 'insertDate')
      .addToUi();

}

function insertDate() {
  var cursor = DocumentApp.getActiveDocument().getCursor();
  if (cursor) {
      // Attempt to insert text at the cursor position. If insertion returns null,
      // then the cursor's containing element doesn't allow text insertions.
      var d = new Date();
      var dd = d.getDate();
      dd = pad(dd, 2)
      var mm = d.getMonth() + 1; //Months are zero based
      mm = pad(mm, 2)
      var yyyy = d.getFullYear();
      var date = dd + "-" + mm + "-" + yyyy;
      var element = cursor.insertText(date);
      if (element) {
        element.setBold(true);
      } else {
        DocumentApp.getUi().alert('Cannot insert text at this cursor location.');
      }
    } else {
      DocumentApp.getUi().alert('Cannot find a cursor in the document.');
  }

}
function pad (str, max) {
  str = str.toString();
  return str.length < max ? pad("0" + str, max) : str;
} 
```

Reload the Doc, Accept the permissions.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-11-08T17:57:26.407

我不确定附加组件是否属于您要求的 Google Apps 脚本类别，错误[文本工厂](https://chrome.google.com/webstore/detail/text-factory/ppiaifpokkcagpcadampdmlpegldaaoc?utm_source=permalink)提供插入时间戳的功能。

[![截屏](../Images/86051dd9781c49f7e938aba45c5f2455.png)](https://i.stack.imgur.com/Ykv2u.png)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-03-25T15:44:23.250

这是一个编辑版本（已经提供的版本），它打印出包括时间在内的日期戳。

这是输出示例：2014 年 3 月 26 日上午 2:43:21

```
function onOpen() {
  var ui = DocumentApp.getUi();
  // Or FormApp or SpreadsheetApp.
  ui.createMenu('Insert Date')
      .addItem('Insert Date', 'insertDate')
      .addToUi();

}

function insertTime() {
  var d = new Date();
  var timeStamp = d.getTime();  // Number of ms since Jan 1, 1970

  // OR:

  var currentTime = d.toLocaleTimeString(); // "12:35 PM", for instance
}

function insertDate() {
  var cursor = DocumentApp.getActiveDocument().getCursor();
  if (cursor) {
      // Attempt to insert text at the cursor position. If insertion returns null,
      // then the cursor's containing element doesn't allow text insertions.
      var d = new Date();
      var dd = d.getDate();
      dd = pad(dd, 2)
      var mm = d.getMonth() + 1; //Months are zero based
      mm = pad(mm, 2)
      var yyyy = d.getFullYear();
      var timeStamp = d.getTime();  // Number of ms since Jan 1, 1970
      var currentTime = d.toLocaleTimeString(); // "12:35 PM", for instance
      var date = currentTime + " " + dd + "-" + mm + "-" + yyyy;
      var element = cursor.insertText(date);
      if (element) {
        element.setBold(true);
      } else {
        DocumentApp.getUi().alert('Cannot insert text at this cursor location.');
      }
    } else {
      DocumentApp.getUi().alert('Cannot find a cursor in the document.');
  }

}
function pad (str, max) {
  str = str.toString();
  return str.length < max ? pad("0" + str, max) : str;
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-11-20T08:10:17.453

如果要**在打开文档后自动获取当前日期**，可以添加此脚本：

在 Google 文档中：**工具 -> 打开脚本编辑器**并保存此脚本：

```
/** 
 *  After open document actualize part with text "Generated" to "Generated [actual date]".
 */

function onOpen() {  
  var body = DocumentApp.getActiveDocument().getBody();
  var date = Utilities.formatDate(new Date(), "GMT", "dd.MM.yyyy");
  // Clear the text surrounding "Apps Script", with or without text.
  body.replaceText("^Generated.*$", "Generated " + date);    
}
```

**在文档正文中，您必须有文本“已生成”。**

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-10-16T18:00:04.280

## 创建新的表格文档

在 A1 中，放入`Date:`和 B1，放入公式`NOW()`。我命名了工作表`current-date`，但您可以随意命名。该文档将作为您所有 Docs 文档的“日期管理员”简单地放在您的驱动器到服务器上。

[![新工作表 NOW()](../Images/baf8b20dc178e592b170945f58ebd355.png)](https://i.stack.imgur.com/tqdXT.jpg)

## 将单元格格式设置为日期

选择单元格 B1 并`Number >> Date`从`Format`菜单中选择。

[![格式化日期](../Images/e5a44255290b5245815724e7a0247ed6.png)](https://i.stack.imgur.com/eJg0g.jpg)

## 选择单元格并复制

选择单元格 A1 和 B1，右键单击，然后选择`Copy`

[![选择和复制](../Images/92a2849a19b404d3773f24dab8156a89.png)](https://i.stack.imgur.com/sGDYU.jpg)

## 粘贴并链接到 Docs 文档

右键单击要粘贴单元格的 Docs 文档，然后单击`Paste`。文档应该询问您是否要将这些单元格链接到源文档。选择`Link to spreadsheet`然后单击`Paste`。

[![粘贴和链接](../Images/848fbc7dd7367f6a472678ef79fddb61.png)](https://i.stack.imgur.com/Yvfq3.jpg)

## 摆脱边界

要摆脱边框，请右键单击插入的单元格并选择`Table Properties`。

[![表属性](../Images/67d257dbc890c4be67327dced444820d.png)](https://i.stack.imgur.com/btJou.jpg)

现在设置`Table Border`为`0pt`并单击`OK`。

[![零边界](../Images/eeb7fe182766eaffef7f16b60e2bf575.png)](https://i.stack.imgur.com/yIDkB.jpg)

## 最后结果

你应该最终得到这样的东西。您可以拖动单元格的边缘以使其变大或变小，还可以更改单元格的字体和文本大小。如果使文本变大，则文本将在单元格内换行，因此您需要使它们变宽。

[![最后结果](../Images/f53fcfc7a227d24825b520b246bad216.png)](https://i.stack.imgur.com/n5Axx.jpg)

## 更新日期

现在，每当您打开带有链接单元格的文档并且日期已更改时，您应该会看到这一点。单击`Update`，您的日期将更新为今天的日期。无需打开`current-date`电子表格！

[![更新单元格](../Images/e2fe1ddc493dbb306410a7291a732807.png)](https://i.stack.imgur.com/wXQvo.jpg)

享受！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-11-27T15:11:38.023

对于 Docs，您可能不走运，因为似乎[没有热键](http://support.google.com/drive/bin/answer.py?hl=en&answer=179738&topic=1361462&ctx=topic)，并且缺乏对 Docs 内部脚本的支持（电子表格将是另一回事）。不过，由于您使用的是 Windows，因此您可以使用[autohotkey](http://www.autohotkey.com)。 [该视频](http://www.youtube.com/watch?v=FzNiR0t4VNk)虽然太长，但显示了分配全局热键组合以在任何地方插入当前日期。这样，您可以在使用 Windows 系统时将日期/时间插入到任何您想要的位置。（您可以将其自定义为仅在某些应用程序（例如 IE）中处于活动状态，如果您想对它感到奇怪的话）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-09-14T19:35:25.347

因为额外的击键被用来从菜单中插入日期，所以我的解决方案是一个批处理文件 sts.cmd，它在调用时将日期时间存储到剪贴板中，从而启用简单的 Windows+R、sts、 Ctrl+V 获取并粘贴。如果您要添加额外的击键以将日期添加到文档中，您不妨将其粘贴进去。代码是

```
@ECHO OFF
for /f "tokens=1-12 delims=/:. " %%d in ("%time%") do SET MYTIME= %%d:%%e:%%f
for /f "tokens=1-12 delims=/:. " %%d in ("%date%") do SET MYDATE= %%g-%%e-%%f
SET MYTS=%MYDATE%%MYTIME%
ECHO | SET /p dummyname=%MYTS%|clip 
```

这对我有用，直到 GDocs 提出一个可嵌入的函数，每次打开文档时都会将显示日期更新为当前日期。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-07-08T01:29:12.623

在 MacOS 上，我使用了 Automator。

我创建了一个与 Chrome 一起工作的服务，不需要输入，运行一个 shell 脚本并将输出发送到剪贴板。shell 脚本非常基础：

```
DateTime=`date "+%Y-%m-%d %H:%M"`
echo $DateTime 
```

我本可以不使用中间变量而只运行 date 命令，但我想我可能想要进行额外的处理和格式化。请注意，如果要在日期字符串的格式中包含空格，则格式参数必须用引号引起来。屏幕截图使用了一个下划线。

[![在此处输入图像描述](../Images/d6c5eb2b2e6f2014fb0488d4cff3a000.png)](https://i.stack.imgur.com/PwoGn.png) 保存脚本后，我转到系统设置 > 键盘 > 快捷方式，在文本部分找到我的脚本 DateTime2CB.workflow 并给它一个热键。要找出正在使用的热键并不容易。

我可以为任何应用程序制作它（如果我发现自己试图使用其他应用程序，我仍然可能会这样做），但现在它只是 Chrome。我也可以让 shell 脚本将日期的输出通过管道传输到剪贴板，Mac 上的 pbcopy，如上所述（使用“clip”）。我已经测试了这两种方法并且它们都有效。

我将相同的脚本添加到另一台 Mac 并设置为坚持将 Automator 文件（*名称*.workflow）保存在 iCloud 中。在这种情况下，它没有在键盘设置中列出。为了解决这个问题，我必须在 Automator 中使用打开 > 最近重新打开保存的 iCloud 文件。它询问我是否想在服务中安装该文件。那时的肯定答案将其保存在我的本地系统上，我可以在“设置”>“键盘”>“快捷方式”>“服务”下找到它。

我希望这可以帮助其他 Mac 用户。

八月

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2013-04-30T05:24:44.457

Try this:

```
function insertTimestamp() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var cell = ss.getActiveCell();

  cell.setValue(new Date());
  // sets the cells format to month/day/year.
  // Remove if you want time inserted as well
  cell.setNumberFormat("MM/dd/yyyy") 
} 
```

This works on spreadsheets not sure if you were looking for other docs.

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2014-01-06T21:53:43.490

立即在 google 文档中创建电子表格。将日期放入 B1 为 Today() 使用函数 Text(B1,"dddd, mmmm d, yyyy") 将其格式化为 C1 然后使用以下脚本（您将需要 Today Spreadsheet 的 url

```
function myFunction() {
  var doc = DocumentApp.getActiveDocument();
  var body1 = doc.getBody();
  var style1 = {};
  style1[DocumentApp.Attribute.BOLD] = true;

  var text1 = doc.editAsText();
  body1.appendHorizontalRule(); 
  var wb = SpreadsheetApp.openByUrl('spreadsheet url');
  var ss = wb.getSheetByName('Today');
  var r = ss.getRange('C1');
  var date1 = r.getValues();
  var par1 =body1.appendParagraph(date1[0]);
  par1.setAttributes(style1);
} 
```

# c# - 重新绑定具有 XAML 绑定的 ListView

> ID：13585276
> 
> 赞同：0
> 
> 时间：2012-11-27T13:27:03.830
> 
> 标签：c#, xaml, windows-8, windows-runtime, observablecollection

我有一个 ListView 绑定到 XAML 代码中的 ObservableCollection，如下所示：

```
<Page
...
DataContext="{Binding Pages, RelativeSource={RelativeSource Self}}" />

<ListView x:Name="lstWebpages" ItemsSource="{Binding}" > 
```

现在我想在代码中重新绑定它。像这样的东西：

```
lstWebpages.DataSource = Pages;
lstWebpages.DataBind(); 
```

但是由于 Pages 集合以某种方式绑定到 Page 和 ListView 控件，我有点困惑？
最初的问题是，当我尝试按照此处的要求对页面列表进行排序时出现错误：
[https ://stackoverflow.com/questions/13567987/hresult-e-fail-in-winrt-listview-add](https://stackoverflow.com/questions/13567987/hresult-e-fail-in-winrt-listview-add)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:44:31.350

我相信你需要做的就是分配一个不同的`ItemsSource`

```
lstWebpages.ItemsSource = NameOfTheObservableCollection; 
```

或者`DataContext`

```
lstWebpages.DataContext = Pages; 
```

# java - Java REST 实现自定义授权/认证

> ID：13585278
> 
> 赞同：3
> 
> 时间：2012-11-27T13:27:12.767
> 
> 标签：java, security, rest

我正在开发一个暴露 REST-ful 接口的 Java 服务器。对接口的调用将由用户名/密码保护，并且每个用户都将分配一个角色，基于该角色将限制对资源的访问。服务器由 Glassfish 3.1 托管。我需要实现一个独立于服务器的自定义授权/身份验证方案（各种原因）。因此，在阅读了有关该主题的大量文章后，我从未找到一篇能够完全解释如何实现该主题的文章。到目前为止，我有一个自定义过滤器类，它拦截所有请求：

```
 public class AuthenticationFilter implements Filter {

    @Override
    public void init(FilterConfig config) throws ServletException { }

    @Override
public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {

    String user = "SalesUser";
    List<String> roles = new ArrayList<String>();
    roles.add("Sales");
    chain.doFilter(new UserRoleRequestWrapper(user, roles, request), response);
} 
```

这个过滤器类使用 UserRoleRequestWrapper：

```
public class UserRoleRequestWrapper extends HttpServletRequestWrapper {

    String user;
    List<String> roles = null;
    HttpServletRequest realRequest;

    public UserRoleRequestWrapper(String user, List<String> roles, HttpServletRequest request) {
        super(request);
        this.user = user;
        this.roles = roles;
        this.realRequest = request;
    }

    @Override
    public boolean isUserInRole(String role) {
        if (roles == null) {
            return this.realRequest.isUserInRole(role);
        }
        return roles.contains(role);
    }

    @Override
    public Principal getUserPrincipal() {
        if (this.user == null) {
            return realRequest.getUserPrincipal();
        }

        // make an anonymous implementation to just return our user  
        return new Principal() {

            @Override
            public String getName() {
                return user;
            }
        };
    }
} 
```

因此过滤器拦截了请求，我设置了一个自定义主体（将基于提供的用户名/密码）。我也可以使用 getCallerPrincipal() 从 SessionContext 获取该委托人问题是 isCallerInRole() 方法。尽管我已经为我的原则分配了角色，但似乎 isCallerInRole() 在其他地方寻找该角色。如何以独立于托管应用程序的服务器的方式以编程方式设置该角色？谢谢 ：）

# javascript - 当javascript创建html时，如何通过onclick事件传递变量？

> ID：13585280
> 
> 赞同：2
> 
> 时间：2012-11-27T13:27:12.770
> 
> 标签：javascript, onclick

我的 javascript 创建了一行 html。

该 html 有一个 onclick 事件调用`openSingle()`。

我需要将一个变量传递给该函数。

`onclick="openSingle('+findID+')"`

当我在运行时检查开发面板时，我得到

`onclick="openSingle(WP0100200-3a)"`

唯一缺少的是`id`. 但是，如果我尝试在引号中进行编码，它会破坏 html，然后将所有内容都打乱。

这是我的代码行和所有相关变量。

```
var iconImage = '<img src="../../resources/images/annotation-icon.png" style="float:left; margin-left:20px; margin-right:0px;"onclick="openSingle('+findID+')"/>';
var paragraph = '<p id="Manual-para" class="colorMe"><a href="';
var redirect = linkMe + '#' + findID;
var manName = section.childNodes( x ).getAttribute( "manualName" );
var workPack = section.childNodes( x ).getAttribute( "workPacket" );

document.getElementById( "annotateBody" ).innerHTML += iconImage + paragraph + redirect + '">' + annotationTitle + ' - ' + manName + ' - ' + workPack + '</a></p>'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T13:30:29.883

您可以像这样使用反斜杠转义引号

```
var iconImage = '<img src="../../resources/images/annotation-icon.png" style="float:left; margin-left:20px; margin-right:0px;"onclick="openSingle(\''+findID+'\')"/>'; 
```

并且正如其他评论所建议的那样，您最好避免使用内联 Javascript

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:31:31.107

转义单引号，如下所示：

```
var iconImage = '<img src="../../resources/images/annotation-icon.png" style="float:left; margin-left:20px; margin-right:0px;"onclick="openSingle(\''+findID+'\')"/>'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T13:31:36.287

尝试添加`\'`将解决问题

```
var iconImage = '<img src="../../resources/images/annotation-icon.png" style="float:left; margin-left:20px; margin-right:0px;"onclick="openSingle(\''+findID+'\;)"/>'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T13:31:58.477

答案是：使用转义字符 \ for ' 字符

```
var iconImage = '<img src="../../resources/images/annotation-icon.png" style="float:left; margin-left:20px; margin-right:0px;"onclick="openSingle(\''+findID+'\;)"/>'; 
```

也尝试连接`&lsquo;`和`&rsquo;`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-27T13:31:44.010

您可以尝试做的一件事是在创建 DOM 节点后附加 onclick。这使您可以随心所欲地灵活，并避免必须评估字符串和其他类似的东西。

```
var domnode = /* get the image tag */
domnode.onclick = function(){ openSingle(findId) } 
```

# android - Android 从 SQLite 重新加载 ListView 数据

> ID：13585281
> 
> 赞同：0
> 
> 时间：2012-11-27T13:27:22.353
> 
> 标签：android, listview

我有一个 ListView，它从 SQLite 数据库和 onClickListener 加载数据，用于打开一个新活动的每个列表。我现在的问题是，当我按“返回”以使用 ListView 返回上一个活动时，它不显示。

如何再次从数据库重新加载列表？我该怎么做？

它与 notifyDataSetChanged() 有什么关系？

请帮忙。

谢谢你。

**编辑：**

下面是我在 onCreate() 下加载 ListView 的代码：

```
 ListView listContent = (ListView) findViewById(R.id.contentlist);
        mySQLiteAdapter = new SQLiteAdapter(this);
        mySQLiteAdapter.openToRead();

        Cursor cursor = mySQLiteAdapter.queueAll();
        startManagingCursor(cursor);

        String[] from = new String[] { SQLiteAdapter.KEY_CONTENT };
        int[] to = new int[] { R.id.text };

        SimpleCursorAdapter cursorAdapter = new SimpleCursorAdapter(this, R.layout.listrow, cursor, from, to);

        listContent.setAdapter(cursorAdapter);

        mySQLiteAdapter.close();

        //Onclick ListView setlistener
        listContent.setTextFilterEnabled(true);
        listContent.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {
                Intent summaryIntent = new Intent(DocumentListActivity.this, ViewDocumentActivity.class);
                listTopic = ((TextView) view).getText().toString();

                summaryIntent.putExtra("SummTopic", listTopic);
                startActivity(summaryIntent);
            }
        }); 
```

那么在 Resume() 中添加什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:31:26.247

您可以将您的代码从数据库中获取数据并将其添加到 ListView 里面`onResume()`。因此，当您跳回之前的 Activity 时，`onResume()`它将被调用，并且您的 ListView 将加载数据库中的数据。

# c - libevent：使计时器持久化

> ID：13585284
> 
> 赞同：4
> 
> 时间：2012-11-27T13:27:35.303
> 
> 标签：c, timer, libevent

我有以下代码：

```
#include <stdio.h>
#include <sys/time.h>
#include <event.h>

void say_hello(int fd, short event, void *arg){
        printf("Hello\n");
}

int main(int argc, const char* argv[])
{
  struct event ev;
  struct timeval tv;

  tv.tv_sec = 3;
  tv.tv_usec = 0;

  event_init();
  evtimer_set(&ev,say_hello,NULL);
  evtimer_add(&ev, &tv);
  event_dispatch();

  return 0;
} 
```

问题是“你好”被打印一次然后程序退出......

我希望它无限期地输出“你好”。

这个怎么做？提前谢谢了，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-22T20:57:57.023

只是为了澄清 Basile 的解决方案：

我也很困惑，直到我意识到“**计时器**”在这种情况下指的是**单次计时器**。我们需要的是一个**间隔定时器**；这需要**libevent中的****EV_PERSIST**标志。

 **```
struct timeval time;
time.tv_sec = 1;
time.tv_usec = 0;

event_set(&my_event, 0, EV_PERSIST, my_function, NULL);
evtimer_add(&my_event, &time); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-24T00:44:07.663

将 main 中的代码更改为读取

```
evtimer_set(&ev,say_hello,&ev); 
```

并使您的 say_hello 功能

```
void say_hello(int fd, short event, void *arg){
    struct event *ev = arg;
    struct timeval tv;

    printf("Hello\n");
    tv.tv_sec = 3;
    tv.tv_usec = 0;

    evtimer_add(ev, &tv);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-06T17:23:10.200

这是 libevent2 的示例：

```
#include <event2/event.h>

static int n_calls = 0;

void cb_func(evutil_socket_t fd, short what, void *arg)
{
    struct event *me = arg;

    printf("cb_func called %d times so far.\n", ++n_calls);

    if (n_calls > 100)
       event_del(me);
}

void run(struct event_base *base)
{
    struct timeval one_sec = { 1, 0 };
    struct event *ev;
    /* We're going to set up a repeating timer to get called called 100
       times. */
    ev = event_new(base, -1, EV_PERSIST, cb_func, event_self_cbarg());
    event_add(ev, &one_sec);
    event_base_dispatch(base);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T13:32:21.520

您是否阅读了[evtimer_set(3)](http://www.daemon-systems.org/man/evtimer_set.3.html)手册页？请再读一遍。

您可能想使用标志`EV_PERSIST`或`evtimer_add`从您的`say_hello`回调中调用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-21T09:02:15.543

```
#include <stdio.h>
#include "ev.h"

static void timer_cback_caller(EV_P_ ev_timer* w, int revents)
{
    const int new_timeout_in_ms = 1200; // new delay between timer ticks

    printf("timer tick\n");

    w->repeat = new_timeout_in_ms / 1000.;
    ev_timer_again(EV_A_ w);
}

int main()
{
    struct ev_loop *loop = ev_default_loop(0);
    ev_timer timer;

    const int start_delay_in_ms = 1000; // delay before first timer tick
    const int timeout_in_ms = 1500; // delay between every timer tick

    ev_timer_init(&timer, timer_cback_caller, start_delay_in_ms/1000., timeout_in_ms/1000.);
    ev_timer_start(loop, &timer);
    ev_run(loop, 0); // will never return

    return 0;
} 
```

[libev 文档](http://pod.tst.eu/http://cvs.schmorp.de/libev/ev.pod#code_ev_timer_code_relative_and_opti)中的更多示例**

# c++ - 使用右值引用延长临时对象的生命周期

> ID：13585285
> 
> 赞同：9
> 
> 时间：2012-11-27T13:27:41.000
> 
> 标签：c++, c++11, rvalue-reference, move-semantics

[根据另一个答案](https://stackoverflow.com/a/3716360/150634)，如果引用它的表达式是 xvalue 表达式，则右值引用不会延长临时变量的生命周期。由于`std::move`返回一个右值引用，调用它的表达式是一个 xvalue，所以下面的结果是一个悬空引用：

```
int main()
{
  std::string&& danger = std::move(get_string());  // dangling reference !
  return 0;
} 
```

没关系。在这里`std::move`没有意义；它已经是一个右值。

但这里是我画一个空白的地方。这与将 xvalue 表达式作为参数传递、完全标准使用`std::move`和右值引用有何不同？

```
void foo(const std::string& val);
// More efficient foo for temporaries:
void foo(std::string&& val);

int main()
{
  std::string s;
  foo(std::move(s)); // Give up s for efficiency
  return 0;
} 
```

右值引用参数是否有特殊规则可以延长临时变量的生命周期，无论它是纯右值还是 xvalue？还是`std::move`调用表达式只是一个 xvalue，因为我们传递了一些已经是右值的东西？我不这么认为，因为它无论如何都会返回一个右值引用，这是一个 xvalue。我在这里很困惑。我想我错过了一些愚蠢的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T13:33:38.377

您的第二个示例不是传递对临时的引用，而是传递对变量的引用，该变量`s`一直持续到`main()`.

如果是（例如`foo(std::move(get_string()));`），那么临时的生命周期将持续到完整表达式的结尾——在函数返回之后。因此在`foo`. 如果`foo`存储指向其参数的引用/指针，并且稍后尝试使用它，则只有危险。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-27T13:31:03.417

这里不需要延长任何生命周期：有问题的对象会持续到 结束`main`，也就是 结束之后`foo`。

# javascript - 如何将 HTML 数组从一种形式传递到另一种形式

> ID：13585291
> 
> 赞同：0
> 
> 时间：2012-11-27T13:27:53.763
> 
> 标签：javascript, arrays, forms

我正在尝试将一个 HTML 元素（它是一个数组）传递给另一个表单。没那么难，我会说，但我尝试了几乎所有可能的组合，但它不起作用。

我有一个表格，其中有这个 SELECT 元素：

```
<select name="preselectedCountries[]" size="9" multiple="multiple">
  <option value="Albania">Albania</option>
  <option value="Algeria">Algeria</option> 
```

我还有另一种形式：

```
<form method="post" name="formGeneric" action="">
  <input type='hidden' name='preselectedCountries[]' value='' /> 
```

现在，我想将第一种形式的选择移交给第二种形式。以各种形式尝试过，例如：

```
<a href="#" onclick="document.formGeneric.preselectedCountries =
document.formIndex.preselectedCountries;" 
```

或者

```
<a href="#" onclick="document.formGeneric.preselectedCountries[] = 
document.formIndex.preselectedCountries[];" 
```

和其他人......但徒劳无功。

我已经搜索了很多，但没有找到解决方案。有人可以给我小费吗？！我将非常感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T15:35:20.640

首先从元素名称中删除 []，因为这只会使事情变得混乱。

然后你需要的javascript行是

```
var selectObject = document.getElementsByName('preselectedCountries')[0];
var selectedArray = [];

for (var i=0; i < selectObject.options.length; i++)
{
 if(selectObject.options[i].selected)
 {
  selectedArray.push(selectObject.options[i].value);
 }
} 
```

假设您的隐藏表单始终位于 DOM 树中的可见表单之后，这应该会为您提供一个数组，其中包含选择列表中的选定值。然后你用这个数组做什么取决于你。您可以`ToString()`将其附加为隐藏输入字段的值，或者尝试直接附加数组。

# c# - 捕获和抛出异常的最佳实践

> ID：13585293
> 
> 赞同：5
> 
> 时间：2012-11-27T13:27:59.813
> 
> 标签：c#, exception

在 msdn[链接](http://msdn.microsoft.com/en-us/library/ms229007.aspx)中，提到
**不要抛出 System.Exception 或 System.SystemException。**
在我的代码中，我这样扔

```
private MsgShortCode GetshortMsgCode(string str)
        {
            switch (str.Replace(" ","").ToUpper())
            {
                case "QNXC00":
                    return MsgShortCode.QNXC00;
                default:
                    throw new Exception("Invalid message code received");
            }
        } 
```

这是不好的做法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-27T13:30:51.430

一般来说，你可以更明确。

在这种情况下，您可以抛出一个

```
ArgumentException 
```

您越具体，其他代码就越容易处理异常。

这可以让你做

```
try
{
    GetshortMsgCode("arg")
}
catch(ArgumentException e)
{
    //something specific to handle bad args, while ignoring other exceptions
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T13:34:53.520

在这种特定情况下，您应该抛出`ArgumentException`.

具体异常类型的重点是从调用者的角度来考虑。我知道这实际上是相当棘手的，因为您也了解双方的实现细节，因此您也在编写调用代码。但是，请始终尝试思考如何为来电者提供足够的信息，以便清楚地了解如果他们做错了什么。

在这种情况下，简单地抛出`Exception`意味着他们必须解析错误消息以了解他们做错了什么，而抛出`ArgumentException`意味着他们可以更容易地区分他们的 try/catch 是否传递给你一些无效的东西或你未能正确执行某些其他原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T13:36:47.547

我不愿意使用诸如“不良做法”之类的术语，因为在某些情况下几乎所有内容都是正确的。但通常情况下，是的，最好抛出针对您的情况存在的最具体的异常类型，如果不存在特定的异常，您应该定义一个。

原因是如果你 throw `Exception`，你的调用者无法区分你引发的错误和他们在调用你的代码期间系统可能抛出的任何其他异常。

在许多情况下，调用者可能会决定以不同于其他问题的方式处理您的异常，或者至少他们可能会记录一条知道您的异常发生的特定消息。如果您的异常不能轻易与其他异常区分开来，那么调用者将很难实现。

# qt - QT UI 仅在模糊后重绘

> ID：13585295
> 
> 赞同：1
> 
> 时间：2012-11-27T13:28:03.100
> 
> 标签：qt, animation, user-interface, repaint

> **可能重复：**
> [QTPropertyAnimation 未正确完成](https://stackoverflow.com/questions/13583748/qtpropertyanimation-not-finishing-properly)

我有一个 UI，在关闭动画之后，还有一个小条。仅当您离开窗口时，此栏才会消失。如何确保栏在动画后消失？

![初始化-打开-关闭](../Images/ca36ac12f1c39a4e2c998251c6a9b273.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:37:52.957

假设动画结束时不显示任何内容，最好的办法是强制窗口重新绘制自身，`update()`在动画结束时使用。

如果您要返回到主事件循环，这将正确执行。如果没有，请致电`qApp->processEvents()`。只要记住在主线程调用这个方法。

希望能帮助到你。

# java - 如何在 eclipse-rcp 应用程序的通用导航器视图中更改文件夹图标（例如源文件夹）？

> ID：13585298
> 
> 赞同：5
> 
> 时间：2012-11-27T13:28:25.207
> 
> 标签：java, icons, eclipse-rcp, navigator, cnf

正如您在这篇文章的标题中看到的那样，我有一个关于 eclipse-rcp 应用程序使用的通用导航器视图中的文件夹图标的问题。

基本上可以在导航器视图中更改标准文件夹的图标吗？我的目标是更改已创建项目的源文件夹的图标。值得一提的是，有一个自己创建的项目性质。

因此，每个创建的具有特定性质的项目都应该有一个源文件夹的自定义图标，但实际上我不知道在哪里可以修改该图标。

那么问题来了：rcp-application 的哪一部分负责处理这些图标？既然有特定的项目性质，我会说性质应该添加这些自定义，对吗？

![我想更改的文件夹图标](../Images/83cce84ae815a4ff4707722784b859e7.png)

在这里您可以看到默认的文件夹结构。我想更改 src 文件夹的图标。

任何帮助将不胜感激！

干杯!

* * *

解决方案：

欲了解更多信息，[请访问此链接。](http://www.eclipse.org/articles/Article-Decorators/decorators.html)

(1) 添加扩展点：

```
<extension point="org.eclipse.ui.decorators">
<decorator
    id="at.fhjoanneum.segof.wsmleditor.natures.decorators.SourceFolderDecorator"
    label="Source Folder Decorator"
    state="true"
    class= "at.fhjoanneum.segof.wsmleditor.natures.decorators.SourceFolderDecorator"
  objectClass="org.eclipse.core.resources.IFolder"
    adaptable="true">
    <description>
      Source Folder Decorator
    </description>
  </decorator>
</extension> 
```

(2) 创建装饰器类：

```
 public class SourceFolderDecorator extends LabelProvider implements ILabelDecorator {

        public SourceFolderDecorator() {
            super();
        }

        @Override
        public Image decorateImage(Image image, Object element) {
//return the image
            return null;
        } 
```

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:28:44.367

为了更改导航器中任何对象的图像，您可以使用标签装饰器。检查`org.eclipse.ui.decorators`扩展点。

# c# - 使用静态构造函数理解网关模式

> ID：13585302
> 
> 赞同：0
> 
> 时间：2012-11-27T13:28:35.730
> 
> 标签：c#, design-patterns, gateway

我正在关注此链接： [http](http://codebetter.com/jpboodhoo/2007/10/15/the-static-gateway-pattern/) ://codebetter.com/jpboodhoo/2007/10/15/the-static-gateway-pattern/ 以了解网关模式。

作者分享了一个“网关”记录器类和相关接口的示例：

```
public class Log
{
    private static ILogFactory logFactory;

    public static void InitializeLogFactory(ILogFactory logFactory)
    {
        Log.logFactory = logFactory;
    }

    public void InformationalMessage(string informationalMessage)
    {
        logFactory.Create().InformationalMessage(informationalMessage);
    }
}

public interface ILogFactory
{
    ILog Create();
}

public interface ILog
{
    void InformationalMessage(string message);
} 
```

这是调用 API

```
public class Calculator
{                
public int Add(int number1,int number2)
{
Log.InformationalMessage("About to add two numbers");            
return number1 + number2;
}
} 
```

我无法理解具体日志记录类的初始化发生在哪里。网关的入口点是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:44:06.320

示例的布局方式有点欺骗性，因为 API 的调用与第一个示例更相关。请注意调用 init 的测试用例。此外，您将拥有作者没有的 Log 实例，在示例中更具象征意义。另一个选项是静态 Log 类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T14:29:53.457

关于接口的具体实现，文章底部有一些例子展示了它是如何实现的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T13:42:45.657

编辑：请忽略这个，这是不正确的。我不删除的唯一原因是我对指出它的人的评论可以继续。

请注意，“Log”类具有静态构造函数：

```
public static void InitializeLogFactory(ILogFactory logFactory)
    {
        Log.logFactory = logFactory;
    } 
```

第一次`Log`加载类时（在第一次引用时），静态构造函数将运行，`logFactory`并使用工厂的具体实现对其进行初始化。

然后，每次`InformationalMessage`调用时，都会使用具体工厂来创建记录器的实例来记录消息。

# sql-server - 创建用于创建具有动态列数的表的过程

> ID：13585303
> 
> 赞同：0
> 
> 时间：2012-11-27T13:28:40.963
> 
> 标签：sql-server

我正在尝试创建一个可以创建没有特定列数的表的过程。我的查询返回值 3 表示它需要 3 列（必须是动态的）。

我已经创建了一个`@variable`来设置表的名称字符串，但我不知道如何制定`CREATE TABLE`语句以实际使用该字符串中的列创建表。

任何形式的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-27T13:34:46.770

您可以使用以下命令从 sql 数据库中获取表上的列

```
select 

    bb.name,
    bb.colid

from sysobjects aa
inner join syscolumns bb
on aa.id = bb.id
where aa.name ='tblMyTable' 
```

名称是列名，ID 是编号。您可以从列表中选择列名并使用动态 sql 来构建选择。不确定您如何决定要从表中查找哪些列。

# ios - 设置状态栏色调颜色

> ID：13585304
> 
> 赞同：1
> 
> 时间：2012-11-27T13:28:45.627
> 
> 标签：ios, ios6, uinavigationbar, uitoolbar, uistatusbar

我有一个选项卡栏应用程序，状态栏色调颜色设置为默认值 - 所以它始终是我在整个应用程序中选择的蓝色。

但是，在一个视图中，我隐藏了我的导航栏，如下所示：

```
[self.navigationController setNavigationBarHidden:YES]; 
```

这是在`viewWillAppear`方法中，并且视图是可访问的，因为它是我的应用程序的选项卡之一。

我隐藏它的原因是因为我想在它的位置放置一个工具栏（大约有 6 个按钮）。

我已经设置了我的工具栏的色调，但是，这个视图上的状态栏总是黑色的。有没有办法为这个视图重新设置状态栏，或者有没有更好的方法来隐藏导航栏以保留状态栏的色调。

**更新**我在某处读到，当着色设置为默认值时，状态栏的颜色将是标题中最低像素的颜色。

我尝试将导航栏隐藏在故事板中，也尝试将色调颜色更改为“自定义”，但这也没有效果。

这两个屏幕截图可能说明了我的问题。切换导航栏会更改状态栏颜色。这是嵌入了相关视图的导航控制器。

![带导航栏 - 蓝色状态栏](../Images/8e7e4c5c51817700ba579f3ad5b24648.png)![没有导航栏 - 黑色状态栏](../Images/7ebcb1e0ea43f43ef4f3a4a7c192b950.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T15:30:50.293

啊！！！我有一个可行的解决方案......虽然是一个非常肮脏和临时的解决方案。

1.  只需隐藏故事板中的导航栏（如相关图像所示 - 取消选中`Shows Navigation Bar`）。
2.  将导航栏拖到视图中。
3.  将其设置`Alpha`为 0 并取消选中`User Interaction Enabled`-***不要隐藏***
4.  确保导航栏位于顶部 - 如下图所示。

    ![屏幕截图](../Images/10d51cabe168414365c157a43899b15f.png)

这样，您的状态栏将获得正确的颜色，而不会显示导航栏。

希望在最近的 Xcode 更新中能有一种更有弹性/更好的方法来做到这一点。

***重要提示：***要使工具栏看起来像导航栏：

1.  将工具栏 -1 定位在 Y 轴上
2.  创建一个高度为 44 像素、宽度为 320 像素、位置为 0,0 的标签（没有文本）。这将是标签栏的底部边框。为获得最佳效果，请截取应用页面的屏幕截图并使用软件获取边框颜色 - 这是阴影开始之前选项卡中最暗的部分（使用此颜色作为标签的背景）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T14:49:50.650

如果您使用的是 iOS 6.0，您可以通过 plist 文件设置状态栏颜色。请参阅 -[如何在 iOS 6 上设置状态栏色调？](https://stackoverflow.com/questions/12467794/how-to-set-status-bar-tint-color-on-ios-6)

> [来自 iOS 6 发行说明；](https://developer.apple.com/library/ios/#releasenotes/General/RN-iOSSDK-6_0/_index.html)
> 
> 状态栏
> 
> 现在可以在应用的 Info.plist 文件中设置状态栏色调参数。您可以这样做以确保在启动期间状态栏颜色与应用的导航栏颜色相匹配。要设置状态栏色调，请将 UIStatusBarTintParameters 键添加到 Info.plist 文件中。此键的值是一个字典，其中包含描述应用程序启动时导航栏的适当值。字典里面应该是 UINavigationBar 键，它的值也是字典。该字典包含初始导航栏的样式（使用 Style 键）并指示它是否是半透明的（使用 Translucent 键）。您还可以指定导航栏的色调颜色（使用 TintColor 键）或其自定义背景图像的名称（使用 BackgroundImage 键）。

[编辑]

在 iOS 6 中，状态栏颜色似乎是由导航栏颜色自动确定的。在隐藏导航栏之前，您可以将导航栏的颜色设置为默认值，看看是否有什么不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T13:32:46.403

```
Change statusBarStyle of application-
[[UIApplication sharedApplication] 
      setStatusBarStyle:UIStatusBarStyleDefault animated:NO]; 
```

# c++ - 子类化编辑文本控件以在按下 shift 时接受小写字符

> ID：13585307
> 
> 赞同：1
> 
> 时间：2012-11-27T13:28:53.073
> 
> 标签：c++, winapi

我有一个编辑文本控件，我想在按下 SHIFT 键时对其进行子类化以允许使用小写字符，因为默认情况下该控件只允许接受大写字符。

所以我的问题是如何将控件中的打字模式从小写更改为大写。

我正在使用 WIN32，我成功捕获了 WM_CHAR 事件：WNDPROC ancienneEditProc; LRESULT CALLBACK EditTextProc(HWND hwnd, UINT mssg, WPARAM wParam, LPARAM lParam) { switch(mssg) {
case WM_CHAR: { char character[2]; 字符[0] = (char)wParam; 字符[1] = 0; if(HIWORD(GetKeyState(VK_SHIFT))) { AnsiLower(字符); } wParam = 字符[0]; } 休息; } return CallWindowProc(ancienneEditProc, hwnd, mssg, wParam, lParam); 但问题是如何在捕获 WM_CHAR 后更新编辑文本控件以接受小写。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:48:04.333

I assume you are using win32 or MFC text edit. Just catch WM_CHAR event.

On MFC, use a message map :

in your .h

```
class YourEdit public CEdit
{
    afx_msg void OnChar(UINT nChar, UINT nRepCnt, UINT nFlags);
    DECLARE_MESSAGE_MAP()
}; 
```

in your .cpp

```
BEGIN_MESSAGE_MAP(YourEdit, CEdit)
    ON_WM_CHAR()
END_MESSAGE_MAP()

YourEdit::::OnChar(UINT nChar, UINT nRepCnt, UINT nFlags)
{
    nchar = toupper(nchar);
    CWnd::OnChar(nChar,nRepCnt,nFlags);
} 
```

see : [http://msdn.microsoft.com/en-us/library/3zzfkd75%28v=vs.71%29.aspx](http://msdn.microsoft.com/en-us/library/3zzfkd75%28v=vs.71%29.aspx)

# c# - 通过贝宝 IPN 进行可选产品销售

> ID：13585308
> 
> 赞同：-1
> 
> 时间：2012-11-27T13:28:54.970
> 
> 标签：c#, paypal, paypal-ipn

考虑以下场景

用户从 Paypal 支付购买产品 1 的费用后来到页面“A”（充当 notify_url）。在“A”上，用户看到另一个产品。如果用户不想要此产品 2，他将被重定向到页面 b 并为产品 1 创建他的登录凭据。但是，如果他们想购买产品 2，他们将被重定向到他们支付产品 2 的贝宝，然后被重定向转到为产品 1 和产品 2 创建用户凭据的页面“B”。

我将 C# 与 .net 框架 3.5 一起使用。这种情况可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:26:09.270

当然，这是可能的，但 notify_url 适用于 IPN。不要将其与 PDT 混淆，PDT 是您用来将数据发送回返回 URL，在用户完成付款后发送给他们的返回 URL。

在您的退货 URL 上，您可以显示您想要的任何额外选项，并在必要时通过付款再次发送。您可能还想查看参考交易，因为这将允许您收取第二笔付款，而无需让用户再次返回 PayPal 页面。

# php - Cakephp 2.0 格式内连接输出

> ID：13585315
> 
> 赞同：0
> 
> 时间：2012-11-27T13:29:11.240
> 
> 标签：php, cakephp

我需要格式化以下蛋糕 php 连接，而不必在我的控制器中运行丑陋的 php 脚本。

这是我的 cakephp 加入

```
$this->Type->find('all' , array(
        'conditions' => array( 'Type.id' => '2' ),
        'joins' => array(
          array(
            'table' => 'subtypes',
            'alias' => 'Subtype',
            'conditions' => 'Subtype.tid = Type.id'
         )
      )
 )); 
```

这是我得到的输出

```
Array
(
    [0] => Array
        (
            [Type] => Array
                (
                    [id] => 4
                    [name] => Clay
                    [handle] => CL
                    [description] => 
                )

            [Subtype] => Array
                (
                    [id] => 11
                    [tid] => 4
                    [name] => Water Based
                )

        )

    [1] => Array
        (
            [Type] => Array
                (
                    [id] => 4
                    [name] => Clay
                    [handle] => CL
                    [description] => 
                )

            [Subtype] => Array
                (
                    [id] => 12
                    [tid] => 4
                    [name] => Oil Based
                )

        )
) 
```

这是我想要的输出

```
Array
(
    [0] => Array
        (
            [Type] => Array
                (
                    [id] => 4
                    [name] => Clay
                    [handle] => CL
                    [description] => 
                )

            [Subtype] => Array(
                [0] => Array(
                    [id] => 11
                    [tid] => 4
                    [name] => Water Based
                )
                [1] =>Array
                (
                    [id] => 12
                    [tid] => 4
                    [name] => Oil Based
                )
            )
        )
) 
```

我怎样才能做到这一点？

非常感谢^^

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:47:16.960

您可以在 Cakephp 中使用模型关联而不是使用连接

供您参考：- [http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html)

如果您需要任何帮助，请告诉我！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:40:49.693

不要使用连接。使用关系和可包含

```
public $hasMany = array('Subtype'); // your foreign key should be "type_id" not "tid" 
```

和

```
$this->Type->find('all', array(
    'conditions' => array('Type.id' => '2'),
    'contain'=>array('Subtype'))); 
```

# php - 在 7 天日历中显示当前周的 mysql 数据

> ID：13585319
> 
> 赞同：3
> 
> 时间：2012-11-27T13:29:34.737
> 
> 标签：php, mysql

我需要一个指导手，我如何显示从星期一开始的“当前周”，在 7 天日历中按 7 个房间的网格，对于我志愿服务的一个小剧院，各种志愿城镇团体使用这些房间。
我的数据库名称=房间，表=房间日记，它有 7 个字段（field_1 到 Field_7）。

我可以在需要时使用“选择”查询和 php isset 代码从 dbase 中填充每一天的数据。但我对如何在正确的一天在正确的房间中正确显示“当前周”数据感到困惑。>

```
////// 周一...周二。星期三 .. 星期四 .. 星期五 . 周六周日
房间 1 数据。数据 。数据 。数据 。数据数据。数据
房间 2 数据。数据 。数据 。数据 。数据数据。数据
3号房间数据。数据 。数据 。数据 。数据数据。数据
4号房数据。数据 。数据 。数据 。数据数据。数据
5号房间数据。数据 。数据 。数据 。数据数据。数据
6号房间数据。数据 。数据 。数据 。数据数据。数据
7号房间数据。数据 。数据 。数据 。数据数据。数据    

```

对于没有发布任何代码，我深表歉意，因为我认为任何通用建议都会对我有所帮助并帮助我学习。任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:44:39.033

我建议你把这个问题一分为二

1.  计算显示周期的开始（“哪个日期是当前星期一”）
2.  选择并显示您的记录

第一点很容易使用 PHP`date()`或`getdate()`函数，第二点可以通过`SELECT ... WHERE datecolumn BETWEEN monday_date AND sunday_date`.

这有助于模块化您的程序：如果您想添加未来的显示选项怎么办？如果您的剧院决定在星期一不演出怎么办？

此外，我建议不要将您的 7 个房间编码为 7 个字段：关系方法将有一个“房间”表（当前有 7 行）和一个连接房间和日期的“表演”表。如果您添加“节目”表并将其链接到“表演”表，您已经免费获得节目数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:33:44.037

1.  重新设计您的数据库，制作餐桌房间（room_id，room_name）和餐桌时间表（room_id，date，data，week_nr，year）

2.  总是用 date 也将 week_nr 写入数据库 - date('W', timestamp)

3.  如果您不想将 week_nr 存储在数据库中，请尝试 strtotime('Last monday', timestamp) 和 strtotime('Next sunday', timestamp) 并从数据库日期中选择范围

# sql - SQL Server 2005：str(4.65,5,1) = 4.7，str(3.65,5,1) = 3.6？

> ID：13585320
> 
> 赞同：11
> 
> 时间：2012-11-27T13:29:36.737
> 
> 标签：sql, sql-server, sql-server-2005

在 SQL Server 2005`str()`中，舍入时某些浮点值的行为很奇怪。在网上搜索时，我在那里找到了以下代码和解释。

```
select STR(4.65,5,1) -- it will give 4.7
select STR(3.65,5,1) -- it will give 3.6 
```

我在[这里](http://www.sqlservercentral.com/questions/T-SQL/94788/)和[这里](http://www.sqlservercentral.com/Forums/Topic1386032-3270-1.aspx)得到了一些解释，但没有从那里得到任何东西*（上面的 T-SQL 取自解释链接之一）*

谁能解释为什么它会这样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T13:54:36.880

[STR()](http://msdn.microsoft.com/en-us/library/ms189527.aspx)的语法；`STR ( float_expression [ , length [ , decimal ] ] )`清楚地表明数字是一个`float_expression`。因此，无论您给出什么数字，它都会首先转换为`FLOAT(n)`默认值**n = 53**。

所以

```
SELECT STR(4.65,5,1), SELECT STR(3.65,5,1) 
```

等于：

```
SELECT STR(CAST(4.65 AS FLOAT(53)),5,1) , STR(CAST(3.65 AS FLOAT(53)),5,1) 
```

如果您指定 n，例如**n = 4**，它将给出您期望的答案（即 4.7 和 3.7）

```
SELECT STR(CAST(4.65 AS FLOAT(4)),5,1) , STR(CAST(3.65 AS FLOAT(4)),5,1)
              --4.7,                     3.7 
```

# vb.net - 猜谜游戏不记分 - VB.NET

> ID：13585323
> 
> 赞同：0
> 
> 时间：2012-11-27T13:29:45.110
> 
> 标签：vb.net

所以我做了一个猜谜游戏，它的工作率为 95%。但是，有两个问题我无法弄清楚。

1.  每当所谓的随机数在 1 到 10 之间时，90% 的时间都是“7”。
2.  我在表格 2 上有一个分数，但是每当添加一个分数时，它要么重置为一个，要么将一个添加到另一个玩家并从第一个玩家中删除一个。

这是代码，提前谢谢你！

```
Public Class Form1
  Public turn As Boolean

  Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Dim turn1 As Integer

    Form2.Show()
    Me.Hide()
    turn1 = 2 * Rnd() + 0
    If turn1 = 0 Then
      turn = True
    Else
      turn = False
    End If

    If turn = True Then
      PictureBox3.Hide()
      PictureBox2.Show()
    End If

    If turn = False Then
      PictureBox3.Show()
      PictureBox2.Hide()
    End If

    If Form2.RadioButton5.Checked = True Then
      PictureBox1.Image = My.Resources.animated_60
      PictureBox1.SizeMode = PictureBoxSizeMode.StretchImage
    End If

    If Form2.RadioButton6.Checked = True Then
      PictureBox1.Image = My.Resources.myanistarb
      PictureBox1.SizeMode = PictureBoxSizeMode.StretchImage
    End If

    If Form2.RadioButton7.Checked = True Then
      PictureBox1.Image = My.Resources.black_rain_fall_animated
      PictureBox1.SizeMode = PictureBoxSizeMode.StretchImage
    End If       
  End Sub

  Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim player1guess As Integer = Val(TextBox1.Text)

    Static onescore As Integer
    If turn = True Then
      PictureBox2.Show()
      PictureBox3.Hide()

      Select Case player1guess
        Case Is = Form2.x
          MsgBox("You Got It")
          My.Computer.Audio.Play(My.Resources.wahoo, AudioPlayMode.Background)
          onescore += 1
          Me.Close()
          Form2.Activate()
          Form2.Label5.Text = Val(onescore)

        Case Is > Form2.x
          MsgBox("Too High")
          Label4.Text = Label4.Text & player1guess & "  - Too High" & vbCrLf
          My.Computer.Audio.Play(My.Resources.daffy_26, AudioPlayMode.Background)

        Case Is < Form2.x
          MsgBox("Too Low")
          Label4.Text = Label4.Text & player1guess & "  - Too Low" & vbCrLf
          My.Computer.Audio.Play(My.Resources.daffy_26, AudioPlayMode.Background)
      End Select
      turn = False
    End If

    If turn = False Then
      PictureBox2.Hide()
      PictureBox3.Show()
    End If

    If turn = False Then
      Button1.BackColor = Color.Black
      Button2.BackColor = Color.White
    End If
  End Sub

  Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
    Dim player2guess As Integer = Val(TextBox2.Text)
    Static twoscore As Integer

    If turn = False Then
      PictureBox2.Hide()
      PictureBox3.Show()

      Select Case player2guess
        Case Is = Form2.x
          MsgBox("You Got It")
          Form2.Label6.Text = Val(twoscore)
          My.Computer.Audio.Play(My.Resources.wahoo, AudioPlayMode.Background)
          twoscore += 1
          Me.Close()
          Form2.Show()

        Case Is > Form2.x
          MsgBox("Too High")
          Label5.Text = Label5.Text & player2guess & "  - Too High" & vbCrLf
          My.Computer.Audio.Play(My.Resources.daffy_26, AudioPlayMode.Background)

        Case Is < Form2.x
          MsgBox("Too Low")
          Label5.Text = Label5.Text & player2guess & "  - Too Low" & vbCrLf
          My.Computer.Audio.Play(My.Resources.daffy_26, AudioPlayMode.Background)
      End Select
      turn = True
    End If

    If turn = True Then
      PictureBox2.Show()
      PictureBox3.Hide()
    End If

    If turn = True Then
      Button2.BackColor = Color.Black
      Button1.BackColor = Color.White
    End If

  End Sub
End Class 
```

这是生成随机数的地方：

```
Public Class Form2
  Public x As Integer
  Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Form1.NAME1.Text = TextBox1.Text
    Form1.NAME2.Text = TextBox2.Text

    If RadioButton1.Checked = True Then
      x = Rnd() * 10 
    ElseIf RadioButton2.Checked = True Then
      x = Rnd() * 100
    ElseIf RadioButton3.Checked = True Then
      x = Rnd() * 1000
    ElseIf RadioButton4.Checked = True Then
      x = Rnd() * 10000
    End If

    If TextBox1.Text = Nothing Then MsgBox("Please enter a name for Player 1")
    If TextBox2.Text = Nothing Then MsgBox("Please enter a name for Player 2")
    If TextBox1.Text <> Nothing And TextBox2.Text <> Nothing Then Form1.Show()
  End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T13:47:45.247

好的，感谢所有评论，一切都已解决。

Randomize() 固定数字。

通过调整执行顺序和公开变量来固定分数。

# java - 将文本（从文件中读取）放入 JFrame

> ID：13585327
> 
> 赞同：2
> 
> 时间：2012-11-27T13:30:20.010
> 
> 标签：java, text, jframe

对编写 Java 非常陌生，因此非常感谢我能得到的任何帮助。

我正在尝试创建 JFrame，其中包含从单独的文本文件中读取的文本（有 5 个段落，每个段落一个接一个地出现）。我需要帮助使文本出现在 JFrame 上（现在不太担心延迟效果），到目前为止，还没有成功。下面的代码离我很远吗？我知道这是一个常见问题，但其他线程一直在处理事件和其他（对我而言）困难的想法，从这些代码中获取我需要的东西对我来说仍然是一个挑战。

我已经读过我需要一个 JLabel 才能继续文本（尽管我在其他地方读过 JPanel？）。我相信我还需要一种在 StoryFrame 类中显示文本的方法，我可以在其中添加 JLabel（并可能说明 nextLine 命令以帮助创建延迟效果，而不是将其放入我的 ShowIntro 类中 - 我打算重复这个过程）。cmd 还让我意识到我从静态位置调用了一个非静态方法 - 尝试在我的 Java 中查找 Dummies 文本，但仍然无法弄清楚如何解决这个问题。我知道这段代码是不够的，我错过了什么？

```
import javax.swing.JFrame;
import javax.swing.JLabel;

public class StoryFrame extends JFrame {
        public StoryFrame() {
        setTitle("見張ってしながら...");
        setSize(400,500);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setLocationRelativeTo(null);
        setVisible(true);
    }

    public void displayText() {
        JLabel Text = new JLabel();
        add(Text); // I feel I need to add a lot more here to connect the two classes

        }
}

import java.util.Scanner;
import java.io.File;
import java.io.IOException;

class ShowIntro {
 public static void main(String args[]) 
                throws IOException {

    new StoryFrame();
    Scanner reader = new Scanner(new File("Intro.txt"));

    while (reader.hasNext()) {
    StoryFrame.displayText();       
        try {
            Thread.sleep(5000);
        } catch (InterruptedException e) {      
        }
    }
 }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:47:04.060

```
class ShowIntro {
 public static void main(String args[]) 
                throws IOException {

    new StoryFrame();
    Scanner reader = new Scanner(new File("Intro.txt"));

    while (reader.hasNext()) {
        StoryFrame.displayText(); // 1 & 2     
        try {
            Thread.sleep(5000);
        } catch (InterruptedException e) {      
        }
    }
 }
} 
```

在看你的`ShowIntro`课时，我注意到两件奇怪的事情：

1.  您正在调用一个类的非静态方法 ( `displayText()`)。
2.  您不会将扫描仪读取的内容传递给该方法调用。

要修复 (1)，您应该将 StoryFrame 类的实例传递给一个变量，并`StoryFrame`在标记的行中替换为该变量的名称。
要修复 (2)，您应该向方法添加一个参数`displayText()`，因此在 StoryFrame 类中替换该方法的标题，并在您从类中`public void displayText(String text) {`调用该方法时传递扫描仪读取的文本。`ShowIntro`

更正版本（未经测试）

```
class ShowIntro {
 public static void main(String args[]) 
                throws IOException {

    StoryFrame frame = new StoryFrame();                  // Store the StoryFrame in a variable
    Scanner reader = new Scanner(new File("Intro.txt"));

    while (reader.hasNext()) {
        frame.displayText(reader.next());               // pass the text read by the scanner to the displayText() method
        try {
            Thread.sleep(5000);
        } catch (InterruptedException e) {      
        }
    }
 }
} 
```

`displayText()`StoryFrame 类中的方法：

```
public void displayText(String text) {       // One parameter: a String
    JLabel Text = new JLabel(text);          // Use the String; make it the content of the JLabel
    add(Text);                               // Now add the JLabel to the JFrame.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:39:49.233

首先，您的 displayText() 不是静态方法，因此您不能从静态方法调用非静态方法，这是主要的，而不在您的类的对象上调用它。

你需要这样的东西：

```
StoryFrame sf = new StoryFrame();
sf.displayText(); 
```

否则，如果您这样做：

```
StoryFrame.displayText(); 
```

编译器会期望 displayText 是一个静态方法，但它不是。

不要尝试将 displayText() 设为静态方法，因为这会在您从 displayText 调用非静态方法时产生新问题。因此，只需创建一个 StoryFrame 对象并在其上调用 displayText()。

还有一条建议，不要用于傻瓜书，它们没用。我推荐的一本用于学习 Java 的好书叫做 Big Java。它会教你很多东西。

同样正如@schippi 提到的，您的 displayText() 方法需要一个参数，这将是您添加到 JLabel 的文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T13:43:53.680

JPanel 只是其他组件的容器。JLabel 可以包含文本。您想将文本添加到 JLabel。

您需要一个 JLabel 作为 Objectvariable，您可以在框架的构造函数中将其添加到框架中

```
private JLabel mylabel;
public StoryFrame() {
    setTitle("見張ってしながら...");
    setSize(400,500);
    setDefaultCloseOperation(EXIT_ON_CLOSE);
    setLocationRelativeTo(null);
    mylabel=new JLabel();
    this.add(mylabel);
    setVisible(true);
} 
```

现在你想要来自扫描仪的文本，这是由

```
reader.next() 
```

那么您要更改标签的文本。

```
mylabel.setText(text); 
```

附加一些你可以的东西

```
mylabel.setText(mylabel.getText()+text); 
```

我希望你能自己解决剩下的问题

提示：您的 displaytext 方法需要一个参数

# symfony - 通过单击链接退出用户模拟

> ID：13585330
> 
> 赞同：0
> 
> 时间：2012-11-27T13:30:28.113
> 
> 标签：symfony, impersonation

我正在尝试创建一个链接以退出用户模拟会话。当用户单击退出链接时，他应该被重定向到管理仪表板并再次以自己的身份登录。

我创建了一个如下链接：（这不起作用，因为我得到一个拒绝访问屏幕，因为我仍然以没有权限查看管理仪表板的普通用户身份登录）

```
<a href="{{ path('AdminBundle_dashboard', {_switch_user: '_exit'}) }}">Exit</a> 
```

但我也尝试使用绝对链接创建链接，并且有效！

```
<a href="http://domain.com/app_dev.php/admin?_switch_user=_exit">Exit</a> 
```

虽然文档说它应该通过使用 path() [http://symfony.com/doc/2.0/book/security.html#impersonating-a-user](http://symfony.com/doc/2.0/book/security.html#impersonating-a-user)

# javascript - CSS3 的浏览器兼容性问题

> ID：13585333
> 
> 赞同：1
> 
> 时间：2012-11-27T13:30:43.137
> 
> 标签：javascript, jquery, html, css

我使用一些 CSS3 设计了一些网页。它在 Google Chrome 中看起来不错，但在 Internet Explorer 中样式变得笨拙。关于这些，我有两个问题：

* * *

我可以这样做吗：我可以制作两个样式表，并根据用户的浏览器加载适当的版本。让我更清楚地说明：

```
if browser is Internet Explorer
    use stylesheet1.css
else
    use stylesheet2.css 
```

* * *

我的主要问题是`border-radius`财产的使用。有没有办法直接避免这种情况。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T13:35:24.197

在您的 HTML/标题中执行以下操作：

```
<!--[if IE]>
 <link rel = "stylesheet" type = "text/css" href = "ie-css.css" />
<![endif]--> 
```

您还可以进一步细分：

```
<!--[if IE 7 ]>     
 <link rel = "stylesheet" type = "text/css" href = "ie7-css.css" />
<![endif]--> 
```

或许多其他组合：

```
<!--[if IE 7 ]>
<!--[if lt IE 7]>     <--- less than IE7
<!--[if gt IE 7]>     <--- greater than IE7
<!--[if IE 8 ]>
<!--[if IE 9 ]>
<!--[if !IE]> 
```

[HTML5 Boilerplate](http://html5boilerplate.com/)的建议（和使用的条件）：

```
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T13:36:52.853

[是的你可以！](http://www.quirksmode.org/css/condcom.html)这些被称为条件注释，并且完全符合您的要求。

```
<link relblablabla />

<!--[if lt IE9]>
    <link relblablabla />
<![endif]--> 
```

当且仅当您使用的 Internet Explorer 版本低于 IE9 时，上述示例将加载备用的第二个样式表。查看上面的链接以获取更多示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T13:37:20.967

您可以通过拥有 2 个不同的 css 文件来解决这些问题。阅读他关于整个跨浏览问题的解决方案：

[在 IE7/8 中模拟 CSS3 边框半径和框阴影](https://stackoverflow.com/questions/2687804/emulating-css3-border-radius-and-box-shadow-in-ie7-8)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-27T13:37:40.980

你可以这样做

在 onload 中调用函数

```
function something()
{
nav=navigator.userAgent;
if (nav.indexOf("IE 8.0")!=-1)
{    

    var $ = document; 
    var cssId = 'myCss';  // you could encode the css path itself to generate id..
    if (!$.getElementById(cssId))
    {
        var head  = $.getElementsByTagName('head')[0];
        var link  = $.createElement('link');
        link.id   = cssId;
        link.rel  = 'stylesheet';
        link.type = 'text/css';
        link.href = 'css/cssyouwant.css';
        link.media = 'all';
        head.appendChild(link);
    }
}
} 
```

navigtor.userAgent 显示您的浏览器名称。

# python - 如何使用 re.findall() 使用符号组名

> ID：13585336
> 
> 赞同：9
> 
> 时间：2012-11-27T13:30:49.200
> 
> 标签：python, regex, match, findall

是否可以访问在正则表达式中定义的符号组`(?P<toto>...)`名称`re.findall()`？

使用`re.match()`, re 返回 a可以`MatchObject`在其上使用该函数`.group('toto')`...我想做一些接近的事情。

这是一个例子：

```
import re
my_str = 'toto=1, bip=xyz, toto=15, bip=abu'
print re.findall('toto=(?P<toto>\d+)\,\sbip=(?P<bip>\w+)', my_str) 
```

它返回：

```
[('1', 'xyz'), ('15', 'abu')] 
```

我想得到类似的东西：

```
[{'toto':'1', 'bip':'xyz'}, {'toto':'15', 'bip':'abu'}] 
```

有什么简单的方法可以做到这一点吗？我到处都找不到...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-27T13:34:37.830

你不能用`.findall()`. 但是，您*可以*[`.finditer()`](http://docs.python.org/2/library/re.html#re.finditer)使用一些列表理解魔术来实现相同的效果：

```
print [m.groupdict() for m in re.finditer('toto=(?P<toto>\d+)\,\sbip=(?P<bip>\w+)', my_str)] 
```

这打印：

```
[{'toto': '1', 'bip': 'xyz'}, {'toto': '15', 'bip': 'abu'}] 
```

所以我们循环遍历产生的每个匹配项`.finditer()`并获取它的`.groupdict()`结果。

# blackberry - 如何在 BlackBerry 中以编程方式设置应用程序权限

> ID：13585337
> 
> 赞同：1
> 
> 时间：2012-11-27T13:30:49.963
> 
> 标签：blackberry, permissions

我想要的是避免安装应用程序时弹出的权限界面，而是手动以编程方式提供所有权限。这在黑莓开发中是可行的吗？如果是这样，请给我一个提示，如何做到这一点。

我已经看过这篇[文章了](https://stackoverflow.com/questions/1699873/how-to-give-blackberry-application-all-the-available-permission)。但这不是我要找的。我根本不希望用户看到那个 Permission 界面。

# php - 客户作为合作伙伴 magento 错误

> ID：13585339
> 
> 赞同：0
> 
> 时间：2012-11-27T13:30:51.947
> 
> 标签：php, zend-framework, magento

我刚刚从 WebKul Customer 作为合作伙伴实现了一个模块，但是我在这方面的代码中遇到了问题。谁能指点我需要修复的区域？

```
$collection = Mage::getResourceModel('customer/customer_collection')
    ->addAttributeToFilter('nickname', $value)
    ->addAttributeToFilter('entity_id', array('nin' => $customer_id)); 
```

这给出了以下错误：

> 致命错误：在第 816 行的 /home/xxx/public_html/app/code/core/Mage/Eav/Model/Entity/Abstract.php 中的非对象上调用成员函数 getBackend()

我是 Magento 的新手，因此我们将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:53:42.223

也许模块的安装脚本没有安装？要进行诊断，请执行以下操作：

1.  *在其config.xml*文件中验证模块版本，并检查**version**和**data_version 是否**与表中的此值匹配`core_resource`。
2.  `eav_attribute`通过搜索属性代码来验证属性是否存在于表中。

# android - 短信管家不断重复发送短信

> ID：13585340
> 
> 赞同：0
> 
> 时间：2012-11-27T13:30:52.193
> 
> 标签：android, smsmanager

我在服务中创建了一个短代码来发送短信，但是在我停止电话之前，相同的短信一直在发送。所以我在这里陷入了死亡循环......电话也是如此。

以下是代码片段：

```
public int onStartCommand(final Intent intent, final int flags,
                final int startId) {

            if (activer == 0 && activerTransmission == 1 && activerCascade == 0){
                sendSms(getApplicationContext());
                stopSelf();
            }

            if (activer == 0 && activerTransmission == 0 && activerCascade == 1){
                call(getApplicationContext());
                stopSelf();
            }
            if (activer == 0 && activerTransmission == 1 && activerCascade == 1){
                sendSms(getApplicationContext());
                call(getApplicationContext());
                stopSelf();
                }               
            else if (activer == 1){

                Intent dialogIntent = new Intent(getBaseContext(), DialogLauncher.class);
                dialogIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                getApplication().startActivity(dialogIntent);
                stopSelf();     
        }
             return START_NOT_STICKY;
     }

public void sendSms(Context context){

        DBAdapter   smsBDD          =   new DBAdapter(context);     
        Cursor      sms             =   smsBDD.selectTransmission();

        String      numero1         =   (sms.getString(sms.getColumnIndex("sms1")));
        String      numero2         =   (sms.getString(sms.getColumnIndex("sms2")));
        String      numero3         =   (sms.getString(sms.getColumnIndex("sms3")));
        String      numero4         =   (sms.getString(sms.getColumnIndex("sms4")));
        String      numero5         =   (sms.getString(sms.getColumnIndex("sms5")));
        String      msg             =   "Alarme perte de verticalité, ";        
        sms.close();

            if(!numero1.equals("aucun")){
                SmsManager.getDefault().sendTextMessage(numero1, null, msg+" "+getLog(context), null, null);
            }           
            if(!numero2.equals("aucun")){
                SmsManager.getDefault().sendTextMessage(numero2, null, msg/*+" "+getLog(context)*/, null, null);
            }           
            if(!numero3.equals("aucun")){
                SmsManager.getDefault().sendTextMessage(numero3, null, msg/*+" "+getLog(context)*/, null, null);
            }           
            if(!numero4.equals("aucun")){
                SmsManager.getDefault().sendTextMessage(numero4, null, msg/*+" "+getLog(context)*/, null, null);
            }
            if(!numero5.equals("aucun")){
                SmsManager.getDefault().sendTextMessage(numero5, null, msg/*+" "+getLog(context)*/, null, null);
            }
        }

private void call(Context context){

    DBAdapter   smsBDD          =   new DBAdapter(context);     
    Cursor      phone           =   smsBDD.selectCascade();

    String      numero1         =   (phone.getString(phone.getColumnIndex("cascade1")));
    /*String    numero2         =   (phone.getString(phone.getColumnIndex("cascade2")));
    String      numero3         =   (phone.getString(phone.getColumnIndex("cascade3")));
    String      numero4         =   (phone.getString(phone.getColumnIndex("cascade4")));
    String      numero5         =   (phone.getString(phone.getColumnIndex("cascade5")));*/
    phone.close();

        if(!numero1.equals("aucun")){
            Intent intent = new Intent(Intent.ACTION_CALL);
            intent.setData(Uri.parse("tel:" + numero1));
            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            intent.addFlags(Intent.FLAG_FROM_BACKGROUND);
            startActivity(intent);      
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T17:15:10.493

好吧，没关系，刚刚发现它是由 FLAG_ACTIVITY_NEW_TASK 引起的，因为该服务是由另一个服务启动的！

问题解决了 ！

# visual-studio-2010 - 将 Visual Studio 2010 连接到 Solid Works

> ID：13585342
> 
> 赞同：2
> 
> 时间：2012-11-27T13:30:54.337
> 
> 标签：visual-studio-2010, visual-studio-2008, solidworks

我在visual sutio 2010中创建了表单并添加了按钮，当用户单击该按钮时，它应该打开Solid Works工具，因此代码是：

```
Imports SolidWorks.Interop.sldworks
Imports SolidWorks.Interop.swconst
Imports System.Runtime.InteropServices
Imports System
Public Class Form1

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)        Handles Button1.Click
    Dim swDoc As ModelDoc2 = Nothing
    Dim swPart As PartDoc = Nothing
    Dim swDrawing As DrawingDoc = Nothing
    Dim swAssembly As AssemblyDoc = Nothing
    Dim boolstatus As Boolean = False
    swDoc = CType(swApp.NewDocument("C:\ProgramData\SolidWorks\SolidWorks 2012\templates\Part.prtdot", 0, 0, 0), ModelDoc2)
    swDoc = CType(swApp.ActiveDoc, ModelDoc2)
    boolstatus = swDoc.Extension.SelectByID2("Top Plane", "PLANE", 0, 0, 0, False, 0, Nothing, 0)
    swDoc.SketchManager.InsertSketch(True)
    Dim skSegment As SketchSegment = Nothing
    skSegment = CType(swDoc.SketchManager.CreateCircle(-0.020947, 0.005368, 0, 0.012306, -0.016627, 0), SketchSegment)
    boolstatus = swDoc.EditRebuild3()
End Sub
End Class 
```

但不幸的是我在导入时遇到错误请帮助我错误是：

> 导入不包含任何公共成员或找不到

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-19T14:46:10.200

如果您想从应用程序启动 SolidWorks（单击按钮并启动 SoWo），那么您应该：

1）向 SolidWorks Interop 库添加必要的参考（正如 Vladyslav Litunovsky 正确指出的那样）

2) “附加/连接”到 SolidWorks 应用程序（对象），以便让您的应用程序启动并使用 SolidWorks。

如果您需要精确控制要附加的 SolidWorks 会话（即，如果超过 1 个正在运行），那么事情会变得更加密集，因为您必须使用 ROT (RunningObjectTable)，您可以在其中获取可能正在运行 SolidWorks 实例。

一般来说，你可以使用

```
Set swApp = CreateObject("SldWorks.Application") 
```

或版本相关实例（在本例中为 21 = 2013），如果您在目标系统上拥有多个版本并希望准确运行特定版本：

```
Set swApp = CreateObject("SldWorks.Application.21") // 
```

这会附加到现有的 SolidWorks 会话或创建一个新会话。

请注意，以编程方式启动和结束 SolidWorks 会话确实涉及控制会话应如何终止和/或显示的附加参数/属性。

您可以查看更多详细信息（显示如何实例化和控制 SolidWorks 会话）：

[http://help.solidworks.com/2013/English/api/sldworksapi/solidworks_visible_or_background_example_vb.htm](http://help.solidworks.com/2013/English/api/sldworksapi/solidworks_visible_or_background_example_vb.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T17:00:16.603

将这些 dll 作为参考添加到您的项目中：
SolidWorks.Interop.sldworks.dll
SolidWorks.Interop.swconst.dll
这些 dll 位于 Solidworks 文件夹中。在我的电脑上是
C:\Program Files\SolidWorks Corp\SolidWorks\

# javascript - 如果一个是onblur，则删除其他人的边框颜色

> ID：13585343
> 
> 赞同：-2
> 
> 时间：2012-11-27T13:31:01.463
> 
> 标签：javascript, html, css

我试图让字段在焦点上时周围有边框颜色，然后在不再焦点时默认回到正常的默认边框

```
<p>
            <label for="username">
                <span>Enter Email</span>
                <input type="text" id="Text4" name="username" 
                    onfocus="this.style.borderColor='#00B4FF'" onblur="this.style.borderColor='#D9D9D9'"
                    class="semi-medium-text" /></label><span id="Span4"></span></p> 
```

另一个是

```
<p>
            <label for="list">
                <span>My dropdwnn</span>
                <select id="Select9" class="semi-selction" maxlength="255" onfocus="this.style.borderColor='#00B4FF'"
                    onblur="this.style.borderColor='#D9D9D9">
                    <option value="">Select  Type</option>
                    <option value="1">A</option>
                    <option value="3">B</option>

                </select>
        </p> 
```

正在使用的 CSS 类是

```
.semi-medium-text, #region-selector-div input {
border: 2px solid #D9D9D9;
border-radius: 5px 5px 5px 5px;
height: 25px;
padding: 5px;
vertical-align: middle;
width: 350px;
} 
```

用于下拉列表的类是

```
.semi-selction {
border: 2px solid #D9D9D9;
border-radius: 5px 5px 5px 5px;
height: 37px;
padding: 5px;
vertical-align: middle;
width: 362px;
} 
```

当它处于焦点/模糊状态时，这正确地在它周围放置了一个边框颜色，但是当它不再处于焦点/模糊状态时，边框颜色相同..这是问题..提前感谢您的建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:35:15.240

您在第二个代码块中错过了一些引号，这似乎是问题所在：

```
<select id="Select9" class="semi-selction" maxlength="255" onfocus="this.style.borderColor='#00B4FF'"
                onblur="this.style.borderColor='#D9D9D9"> 
```

应该：

```
<select id="Select9" class="semi-selction" maxlength="255" onfocus="this.style.borderColor='#00B4FF'"
                onblur="this.style.borderColor='#D9D9D9'"> 
```

我已经对其进行了测试，并且效果很好。

我还可以建议将样式添加`outline:none;`到您的选择框中吗？Chrome 和我认为 Firefox 默认情况下会在 s 周围放置一个丑陋的框`<select>`，它会破坏你所追求的效果。

# spring - 使用 Spring 会话 bean 进行日志记录

> ID：13585345
> 
> 赞同：1
> 
> 时间：2012-11-27T13:31:03.307
> 
> 标签：spring, logging, log4j, aop, spring-aop

我有一个 Spring 网络应用程序。我想将其日志记录行为更改为始终使用存储在会话范围 bean 中的登录用户名预先添加日志行。我们正在使用 log4j。有很多类正在记录但不是 Spring 管理的。虽然我们确实使用了一些 AOP，但都是 Spring AOP，而不是 AspectJ，所以我不能全局修改 log4j 行为（并且仅仅为了愚蠢的日志改进而引入 AspectJ 听起来不是一个好主意）。

我想不出任何理智（甚至可以接受的疯狂）方式来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T15:13:48.903

在您的 servlet 中，您可以使用 log4j 的嵌套诊断上下文来执行以下操作：

```
NDC.push(getUsername());
try {
    ....
}
finally {
    NDC.pop();
} 
```

如果您使用的是 spring dispatcher servlet，您可以将 dispatcher servlet 包装在您自己的 servlet 中，将所有调用委托给 dispatcher servlet 并在那里添加 NDC-stuff。

# java - 遍历 selenium 中同名的类

> ID：13585363
> 
> 赞同：0
> 
> 时间：2012-11-27T13:32:19.587
> 
> 标签：java, selenium-webdriver

在我正在测试的网站中，有一个包含 5 个同名嵌套类的表。

我需要验证表下恰好有 5 个类，但它们的名称都相同。

如何遍历 5 个类？

我附上了一张图片以更好地解释我的意思![在此处输入图像描述](../Images/c5743d555f4d7fc1e2b4f9893f9bdc6d.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:01:14.080

It depends on what you mean by "iterate", but one possibility would be to use XPath's child-position selector. For example, `findElement(By.xpath("//div[contains(@class, 'list-container')]/div[contains(@class, 'list-0')]/div[2]"))` will find the second of the "top-performer-item" divs.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T16:06:30.630

您可以尝试以下代码段：

```
int numberOfElementsFound = getNumberOfElementsFound(By.cssSelector(".list-container > .list-0 > .top-performer-item"));
  for (int pos = 0; pos < numberOfElementsFound; pos++) {
    getElementWithIndex(locator, pos).doWhateverYouWantWithTheElement()
  }

  public int getNumberOfElementsFound(By by) {
      return webDriver.findElements(by).size();
  }

  public WebElement getElementWithIndex(By by, int pos) {
      return webDriver.findElements(by).get(pos);
  } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-28T08:40:28.263

最后，我要做的就是确保 3 个列表中总共有 15 个项目，因此每个列表中有 5 个项目。我需要进行迭代以确保没有遗漏任何内容，并在您的答案的帮助下找到了答案：

```
List<WebElement> element = driver.findElements(By
            .className("top-performer-item"));

    assertEquals(15, element.size());
    driver.quit(); 
```

我没有选择任何特定的答案，因为是你们俩的帮助让我到达了那里。我非常感谢你！

# html - 复选框自定义

> ID：13585365
> 
> 赞同：0
> 
> 时间：2012-11-27T13:32:20.493
> 
> 标签：html, firefox, css

我使用以下代码在复选框上获得圆角

```
input[type=checkbox]{
    -webkit-appearance: none;
    background-color: #fafafa;
    border: 1px solid #cacece;
    -webkit-box-shadow: 0 1px 2px rgba(0,0,0,0.05), inset 0px -15px 10px -12px rgba(0,0,0,0.05);
       -moz-box-shadow: 0 1px 2px rgba(0,0,0,0.05), inset 0px -15px 10px -12px rgba(0,0,0,0.05);
            box-shadow: 0 1px 2px rgba(0,0,0,0.05), inset 0px -15px 10px -12px rgba(0,0,0,0.05);
    -webkit-border-radius: 4px;
     -khtml-border-radius: 4px;
       -moz-border-radius: 4px;
            border-radius: 4px
    display: inline-block;
    position: relative;
    height: 15px;
    width: 15px;
    padding-right: 16px;
    padding-bottom: 13px;
} 
```

但它在 Mozilla 中不起作用。你能给我一些代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-24T20:47:33.850

这篇文章很旧，但这是我的建议：

将标签与您的复选框相关联，如下所示：

```
<input type="checkbox" value="1" id="c1" />
<label class="check" for="c1"></label> 
```

通过 CSS 隐藏您的复选框：

```
.checkboxes input[type=checkbox]{
    display:none
} 
```

根据需要设置标签样式。我创建了一个简单的 jsfiddle，它充分展示了如何使用个性化复选框。在我的示例中，我将它们保持为正方形，但您可以在 css 中轻松添加边框半径。

[这](http://jsfiddle.net/KTADZ/1/)是jsfiddle

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T15:54:45.890

复选框（单选按钮和选择）是特定于操作系统的，并且由操作系统而不是浏览器生成。对这些元素进行样式设置的能力一直非常有限。

# c# - 在 Visual Studio 2012 中按类名对单元测试进行分组（更新 1）

> ID：13585367
> 
> 赞同：2
> 
> 时间：2012-11-27T13:32:22.077
> 
> 标签：c#, visual-studio, unit-testing, visual-studio-2012

是否可以使用 Visual Studio 2012 Update 1 的新功能按类名对单元测试进行分组？

我知道这在原始版本中是不可能的，但是，看起来在更新 1 中对测试资源管理器进行了一些增强。我看到现在有一​​个按项目分组的选项。我还看到我可以添加自定义特征来完成类似的分组。

但是，我希望有一种简单的方法可以按类名进行分组（无需向我们所有的测试添加 trait 属性）。有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T15:58:50.663

不幸的是，Group by Class 没有进行更新 1。请继续关注更新 2 的 CTP。

# php - 将生成的 PDF 附加到电子邮件 Kohana

> ID：13585369
> 
> 赞同：0
> 
> 时间：2012-11-27T13:32:26.373
> 
> 标签：php, email, pdf-generation, kohana, dompdf

我正在使用 Kohana [PDF 查看器模块](https://github.com/shadowhand/pdfview)(DOMPDF) 从 HTML 页面动态创建 PDF 文件。

我可以使用 Kohana`send_file`查看或下载 PDF：

```
// Load a view using the PDF extension
$pdf = View_PDF::factory('Print/Summary');

// Use the PDF as the request response
$response = new Response();
$response->body($pdf);

$filename = 'myfile.pdf';
$response->send_file(TRUE, $filename, array('inline' => TRUE)); 
```

我想将此 PDF 附加到电子邮件并发送，但我不确定获取此 PDF 的最佳方法是什么，因为我通常使用上传的文件而不是服务器生成的文件？

感谢您对此的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T09:22:02.450

您可以使用 swiftmailer 执行此操作：[http ://swiftmailer.org/docs/messages.html#attaching-dynamic-content](http://swiftmailer.org/docs/messages.html#attaching-dynamic-content)

我建议使用 Shadowhand 的电子邮件模块，它本质上是 swiftmailer 的包装器：[https ://github.com/shadowhand/email](https://github.com/shadowhand/email)

# sql - 按季度/半年/每周分组日期

> ID：13585371
> 
> 赞同：1
> 
> 时间：2012-11-27T13:32:37.127
> 
> 标签：sql, sqlite, date, group-by, strftime

我有一个 sql lite 查询，可以让我获得每天/每周/每月/每年的金额总和。

但我希望能够扩展它，以便我可以自定义分组，即按 3 个月或半年分组等。

这是我的查询

```
SELECT sum(amt), strftime('%Y-%m',datetime(date_time)) as date
FROM sales
GROUP BY date
ORDER BY date desc 
```

上面的代码让我得到了每个月的总金额。

但是如何使用查询按季度或半年的月份数进行分组？

# eclipse - 如何将我们自己的观点显示为默认？

> ID：13585377
> 
> 赞同：2
> 
> 时间：2012-11-27T13:32:54.270
> 
> 标签：eclipse, perspective

我想知道如何使用我们自己的默认视角？这意味着在日食午餐时显示透视图。谁能知道该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T14:01:52.247

您可以使用以下命令行参数选择透视图

`-perspective perspectiveId`

有关命令行参数的更多信息，请参阅[Eclipse 帮助](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.user/tasks/running_eclipse.htm)。

# java - WCF Web 服务从 JAVA Web 应用程序访问时返回 401 Unauthorized

> ID：13585379
> 
> 赞同：1
> 
> 时间：2012-11-27T13:32:54.927
> 
> 标签：java, wcf, authentication, axis, webservice-client

我们可以通过 main 方法从普通的 Java 客户端访问 WCF Web 服务。

但是，当我们尝试通过 Java EE 应用程序访问它时，（从 DAO 层）它会显示一个错误。

我们的代码是：

* * *

```
BasicHttpBinding_ISPHostedIMServiceStub stub = new BasicHttpBinding_ISPHostedIMServiceStub(
    new URL("http://mscxxxx.svc?wsdl"),
    new SPHostedIMServiceLocator());

stub.setUsername(username);
stub.setPassword(password);

stub.getTask(); 
```

* * *

## 错误 -

```
AxisFault
 faultCode: {http://xml.apache.org/axis/}HTTP
 faultSubcode: 
 faultString: (401)Unauthorized
 faultActor: 
 faultNode: 
 faultDetail: 
    {}:return code:  401
401 UNAUTHORIZED
    {http://xml.apache.org/axis/}HttpErrorCode:401

(401)Unauthorized
    at org.apache.axis.transport.http.HTTPSender.readFromSocket(HTTPSender.java:744)
    at org.apache.axis.transport.http.HTTPSender.invoke(HTTPSender.java:144)
    at org.apache.axis.strategies.InvocationStrategy.visit(InvocationStrategy.java:32)
    at org.apache.axis.SimpleChain.doVisiting(SimpleChain.java:118)
    at org.apache.axis.SimpleChain.invoke(SimpleChain.java:83)
    at org.apache.axis.client.AxisClient.invoke(AxisClient.java:165)
    at org.apache.axis.client.Call.invokeEngine(Call.java:2784)
    at org.apache.axis.client.Call.invoke(Call.java:2767)
    at org.apache.axis.client.Call.invoke(Call.java:2443)
    at org.apache.axis.client.Call.invoke(Call.java:2366)
    at org.apache.axis.client.Call.invoke(Call.java:1812)
    at org.tempuri.BasicHttpBinding_ISPHostedIMServiceStub.getAllTasks(BasicHttpBinding_ISPHostedIMServiceStub.java:255)
    at com.xxxxImpl.java:195)
    at com.xxxxxImpl.getIncident(inessImpl.java:69)
    at com.xxxxService.getIncidentsPost(Geervice.java:41)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$TypeOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:168)
    at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:71)
    at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:280)
    at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1341)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1273)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1223)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1213)
    at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:414)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:537)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:699)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Unknown Source) 
```

* * *

代理没有问题，因为两者都在同一个网络中。我们正在使用 NTLM 身份验证。

任何指针表示赞赏。

# linux - 在linux中处理c10k

> ID：13585380
> 
> 赞同：0
> 
> 时间：2012-11-27T13:33:06.747
> 
> 标签：linux, tcp, c10k

使用linux BSD socket，如果活动连接数超出系统限制会怎样？会接受呼叫返回错误吗？

即使系统可以接受无限的套接字连接，它是否可以超过整数最大值的大小？

套接字描述符是一个 4 字节的整数值。公平地说，在 32 位系统中与单个进程保持超过 4294967295 个活动 TCP 连接在理论上是不可能的吗？（假设硬件和操作系统可以支持这一点。服务质量并不重要。我们只是想保持活动的 TCP 连接）

这可能是一个愚蠢的问题，但我很好奇。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:02:20.587

从 Linux 系统上的 accept(2) 联机帮助页：

```
 EMFILE The per-process limit of open file descriptors has been reached.

       ENFILE The system limit on the total number of open files has been reached.

       ENOBUFS, ENOMEM
              Not enough free memory.  This often means that the memory allocation is limited by the socket buffer limits, not by the
              system memory. 
```

所以是的，在任何远程理智的配置中，accept 都会报告 EMFILE 或 ENFILE。如果您将 fd 限制设置为某个极高的值，您可能会改为获得 ENOBUFS/ENOMEM。您可能会在 int 数据类型的 INT_MAX 限制之前很久就达到这些限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T14:36:14.087

由于文件描述符是整数，那么您显然不能超过 4G 文件描述符。即使在 64 位系统上也是如此，因为 sizeof(int) 仍然是 4。理论上，您可以跨多个进程打开更多文件描述符。即使您增加所有 /proc 限制，您也可能首先用完内核内存。

linux 内核中的每个套接字分配在千字节范围内，因此即使在大型服务器（具有许多 GB 内存）上，最大连接数也以数百万而不是数十亿来衡量。

# javascript - Jquery - 淡出后淡入音频

> ID：13585381
> 
> 赞同：3
> 
> 时间：2012-11-27T13:33:09.610
> 
> 标签：javascript, jquery, javascript-events

在我的程序中，开始屏幕上有背景音乐。此功能是在单击开始按钮后淡出我的背景声音。

```
$(bgMusic).on('timeupdate', function () {
    var vol = 1,
        interval = 250;
    if (bgMusic.volume == 1) {
        var intervalID = setInterval(function () {
            if (vol > 0) {
                vol -= 0.05;
                bgMusic.volume = vol.toFixed(2);
            } else {
                clearInterval(intervalID);
            }
        }, interval);
    }
}); 
```

我现在添加了一个重启按钮，它可以让你回到开始屏幕，所以我需要以相同的速度淡入音乐。我尝试了一些方法，但它们不起作用，有人可以帮助我吗？

我需要这些方面的东西：

```
$(bgMusic).off('timeupdate', function () {
    var vol = 0,
        interval = 250;
    if (bgMusic.volume == 0) {
        var intervalID = setInterval(function () {
            if (vol < 0) {
                vol += 0.05;
                bgMusic.volume = vol.toFixed(2);
            } else {
                clearInterval(intervalID);
            }
        }, interval);
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T19:03:27.557

可能有更好的方法来做到这一点，但我只是写了一个音量推子来更习惯`<audio>`.

在您`<audio>`的 by上启用它`enableFader(yourAudioNode)`，然后淡出通话`yourAudioNode.fadeOut()`，或淡入通话`yourAudioNode.fadeIn()`。
它基于侦听时间*更新*，因此除非您指定较慢的速率，否则它将以[此处解释](https://stackoverflow.com/a/9678806/1615483)的频率更改音量。

```
function enableFader(node, per_step, min_interval) {
    'use strict';
    var fadeOut, fadeIn;
    node.fadeSettings = {
        dir : 0,
        step : per_step || 0.05,
        interval : min_interval || 0.150,
        lastTime : -Infinity
    };
    fadeOut = function fadeOut() {
        var vol = this.volume,
            settings = this.fadeSettings,
            ctime = this.currentTime,
            dtime = Math.abs(ctime - settings.lastTime);
        if (settings.dir === -1 && dtime >= settings.interval && vol > 0) {
            settings.lastTime = ctime;
            this.volume = (vol - settings.step).toFixed(2);
        } else if (vol <= 0 || settings.dir !== -1) {
            this.removeEventListener('timeupdate', fadeOut);
            settings.dir = 0;
        }
    };
    fadeIn = function fadeIn() {
        var vol = this.volume,
            settings = this.fadeSettings,
            ctime = this.currentTime,
            dtime = Math.abs(ctime - settings.lastTime);
        if (settings.dir === 1 && dtime >= settings.interval && vol < 1) {
            settings.lastTime = ctime;
            this.volume = (vol + settings.step).toFixed(2);
        } else if (vol >= 1 || settings.dir !== 1) {
            this.removeEventListener('timeupdate', fadeIn);
            settings.dir = 0;
        }
    };
    node.fadeOut = function () {
        this.fadeSettings.dir = -1;
        this.addEventListener('timeupdate', fadeOut, false);
    };
    node.fadeIn = function () {
        this.fadeSettings.dir = 1;
        this.addEventListener('timeupdate', fadeIn, false);
    };
} 
```

我使用 Google Chrome 中的开发控制台在[此页面上对其进行了测试。](http://www.apple.com/html5/showcase/audio/)

```
var a = document.getElementById('song');
enableFader(a);
a.fadeOut();
// a.fadeIn(); 
```

# c++ - c ++ valgrind双指针删除用于防止内存泄漏

> ID：13585383
> 
> 赞同：0
> 
> 时间：2012-11-27T13:33:15.033
> 
> 标签：c++, valgrind, double-pointer

读后： [C++指针数组：delete还是delete[]？](https://stackoverflow.com/questions/2814188/c-array-of-pointers-delete-or-delete) （由 shai vashid 回复）和 [http://www.cplusplus.com/forum/beginner/6651/](http://www.cplusplus.com/forum/beginner/6651/)

我实现了以下内容：

内核.h

```
unsigned int **ConfigMeM;
//.....
~Kernel(){ //destructor
    for (unsigned int i=0; i<MeMSize; i++)
        delete [] MeM[i]; //Valgrind:- Invalid read of size 4
                                       - Invalid free() / delete / delete[] / realloc()
    delete [] MeM; //Valgrind: Invalid free() / delete / delete[] / realloc()

    for (unsigned int i=0; i<_item_tot; i++)
        delete [] ConfigMeM[i]; //Valgrind: Same comments as above
    delete [] ConfigMeM; //Valgrind: same as above
}; 
```

内核.cpp

```
//.......
MeM = new unsigned int*[MeMSize];
for (unsigned int i=0; i<MeMSize; i++){
    MeM[i] = new unsigned int[11]; //Valgrind: 14,608 bytes in 332 blocks are definitely lost in loss record 2,021 of 2,036
}
for (unsigned int i=0; i<MeMSize; i++){
    for (int j=0; j<10; j++){
        MeM[i][j] = 0;
    }
}
 //.....
 ConfigMeM = new unsigned int*[_item_tot];
for (unsigned int i=0; i<_item_tot; i++){
    ConfigMeM[i] = new unsigned int[3]; //Valgrind: 1,200 bytes in 100 blocks are definitely lost in loss record 1,131 of 2,036 
}
for (unsigned int i=0; i<_item_tot; i++){
    for (int j=0; j<3; j++){
        ConfigMeM[i][j] = 0;
    }
}
  //..... 
```

我不确定我做错了什么。

请问有什么建议吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:43:03.520

我最好的猜测是使用隐式生成的复制构造函数或复制赋值运算符复制您的类的对象。这将留下两个具有指向同一内存的指针的对象；两者都会尝试在销毁时删除此内存，从而导致双重删除错误。

最简单的解决方法是通过删除这些函数来防止复制：

```
Kernel(Kernel const&) = delete;
void operator=(Kernel const &) = delete; 
```

或者，如果您被一个古老的编译器困住，请将它们声明为没有函数体的私有。

如果您需要复制这些对象，那么您将需要实现这些对象，也许是为了执行分配新内存块的“深度复制”。

`std::vector`或者，使用它来管理动态数组可能更容易；这已经具有正确的复制语义，并且可以非常简单地初始化：

```
std::vector<std::vector<unsigned int>> MeM, ConfigMem;

(MemSize, std::vector<unsigned int>(11)); 
```

# php - php-memcached 是否有任何本地缓存缓冲区？

> ID：13585386
> 
> 赞同：2
> 
> 时间：2012-11-27T13:33:25.880
> 
> 标签：php, memcached

我们的首席开发人员声称 memcached 拥有一些本地缓存缓冲区。因此，他正在代码中执行一些操作，这将导致几乎每次都使用相同的键对 memcached 进行数十万次调用。它肯定会导致许多内存分配，但它需要网络开销吗？

我确实尝试阅读了 php-memcached 的源代码，但它只是调用了 libmemcached 的函数（我不记得它的名字了），我不知道在哪里可以找到它的定义。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T13:58:19.350

您的首席开发人员如何准确地提取该信息会很有用。从[常量列表中](http://php.net/manual/en/memcached.constants.php)，这个特定的选项很突出：

```
Memcached::OPT_BUFFER_WRITES 
```

它用于缓冲写入 Memcached 以减少网络开销；但是，它还声明读取操作会立即将该缓冲区*刷新*到服务器。

到目前为止，网络搜索没有提供任何信息来证实或反驳该声明，尽管如果有这样的功能，应该可以选择关闭该行为；它的缺失使我相信它不存在。

# objective-c - RestKit 直接外键映射

> ID：13585387
> 
> 赞同：0
> 
> 时间：2012-11-27T13:33:26.283
> 
> 标签：objective-c, cocoa, core-data, foreign-keys, restkit

我有以下 JSON

```
{
   ...
   "users": [
            {
                "name": "Username 1"
                "id": "uid1",
            },
            {
                "name": "Username 2",
                "id": "uid2",                
                "userCreator": "uid1"
            },
            {
                "name": "Username 3",
                "id": "uid3",
                "userCreator": "uid1"
            }
        ]
} 
```

在 CoreData 中，在 User 类（名为 id、name 的属性）中，我有一个名为 userCreator 和 User 类的一对多关系

现在我需要映射 JSON 关系，我试过了

```
RKManagedObjectMapping * mapping = [RKManagedObjectMapping mappingForClass:[User class] inManagedObjectStore:[RKManagedObjectStore defaultObjectStore]];

mapping.primaryKeyAttribute = @"id";
[mapping mapAttributes:@"id", @"name", nil];

RKManagedObjectMapping * userCreatorMapping = [RKManagedObjectMapping mappingForClass:[User class] inManagedObjectStore:[RKManagedObjectStore defaultObjectStore]];
userCreatorMapping.primaryKeyAttribute = @"id";
[userCreatorMapping mapAttributes:@"id", nil];

//[mapping hasOne:@"userCreator" withMapping:userCreatorMapping];
[mapping mapRelationship:@"userCreator" withMapping:userCreatorMapping];
[mapping connectRelationship:@"userCreator" withObjectForPrimaryKeyAttribute:@"id"]; 
```

哪个不起作用，生产

```
...
"users":[{
             "id":"uid1",
             "name":"Username 1"
         },
         {
             "id":"uid2",
             "name":"Username 2",
             "userCreator":{"id":"uid1"} // wanted "userCreator":"uid1",
         }... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T14:37:10.530

似乎有问题的台词是

```
userCreatorMapping.primaryKeyAttribute = @"id";
// ...
[mapping connectRelationship:@"userCreator" 
     withObjectForPrimaryKeyAttribute:@"id"]; 
```

虽然我不使用 RK，但很明显你没有告诉 userCreatorMapping 什么映射到什么。你只是`"id"`在两边都给它。

# java - 将数据从 Java 服务器发送到 C++ 客户端时出现 NullPointerException

> ID：13585394
> 
> 赞同：0
> 
> 时间：2012-11-27T13:33:38.920
> 
> 标签：java, sockets

示例.java

```
class Sample
{
    private BufferedOutputStream output;

    public handleRequest(Socket socket)
    {
        this.output = new BufferedOutputStream(socket.getOutputStream(), BUFFSIZE);
        sendString("sometext");//This is working fine
    }

    public void sendString(String str) throws IOException
    {
        ByteArrayOutputStream bytestream;
        bytestream = new ByteArrayOutputStream(str.length());

        DataOutputStream out;
        out = new DataOutputStream(bytestream);

        for (int i = 0; i < str.length(); i++)
            out.write((byte) str.charAt(i));

        output.write(bytestream.toByteArray(), 0, bytestream.size());
        output.flush();
    }
} 
```

另一个类.java

```
class AnotherClass
{
    public send()
    {
        Sample smp = new Sample();
        smp.sendString("somestring");//This is not working
    }
} 
```

每当我在 AnotherClass.java 中调用 sendstring 方法时，它都会给我一个 NullPointerExcetpiton。我无法弄清楚。任何人都可以帮助我..提前谢谢....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:40:05.763

因为你还没有初始化

```
private BufferedOutputStream output; 
```

所以当你调用

```
smp.sendString("somestring");//This is not working 
```

`output`一片空白。您需要先执行方法`public handleRequest(Socket socket){`来初始化输出流

**编辑**

您可以重构您的方法并将初始化提取到另一种方法......但我不确定这是否是您正在寻找的......

```
public OutputStream initializeOutputStream(Socket socket, int size) {
     return new BufferedOutputStream(socket.getOutputStream(), size)
}

public handleRequest(Socket socket)
{
    this.output = initializeOutputStream(socket, BUFFSIZE);
    sendString("sometext");//This is working fine
} 
```

然后在`class AnotherClass`只是使用而`public OutputStream initializeOutputStream(Socket socket, int size)`不是`public handleRequest(Socket socket)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:39:11.613

当您`smp.sendString("something")`在构造函数之后直接调用时，`Sample smp=new Sample();`您将在下一行中获得 NPE

```
output.write(bytestream.toByteArray(), 0, bytestream.size()); 
```

因为`BufferedOutputStream` `output`从未被初始化，因此是`null`。

# android - ViewPager 在屏幕旋转后重新实例化项目

> ID：13585396
> 
> 赞同：2
> 
> 时间：2012-11-27T13:33:42.130
> 
> 标签：android, user-interface, android-fragments, android-viewpager, android-pageradapter

我正在使用一个`ViewPager`包含多个 ListViews 的代码，其代码类似于[Infinite ViewPager](https://stackoverflow.com/questions/7440012/infinite-viewpager)的答案。这个想法是为谷歌日历应用程序提供类似于日视图的东西（其来源似乎不可用；只有默认日历应用程序是，但它使用 a `ViewSwitcher`） - 我想让它看起来像用户可以无限左右滑动，但实际上只有 3 个项目`ViewPager`，当用户点击页面 0 或 2 时，我们将 1 设置为当前页面并相应更新。

现在，这一切都奏效了。然而，奇怪的是，当手机旋转并重建 Activity 时（我暂时避免使用`configChanges`），应用程序中的页面再次实例化，但无序。顺序不是 0->1->2，而是 1->0->2，这会打乱应用程序中页面的顺序。

**我的片段，在`onActivityCreated()`：**

```
mPagerAdapter = new ContinuousPagerAdapter(R.layout.my_listview, this);

// set the adapter
mViewPager = (ViewPager) getView().findViewById(R.id.agendaViewPager);
mViewPager.setOffscreenPageLimit(3);
mViewPager.setOnPageChangeListener(this);
mViewPager.setAdapter(mPagerAdapter);
mViewPager.setSaveEnabled(false);
// ...
mViewPager.setCurrentItem(1, false);
loadData(); 
```

**寻呼机适配器：**

```
import android.content.Context;
import android.os.Parcelable;
import android.support.v4.view.PagerAdapter;
import android.support.v4.view.ViewPager;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;

public class ContinuousPagerAdapter extends PagerAdapter {

    OnPageInstantiatedListener pListener;
    ViewPager container;
    int childLayoutResId;

    @SuppressWarnings("unused")
    private ContinuousPagerAdapter() {
    }

    /**
     * @param childLayoutResId Layout resource ID of the children to be inflated
     */
    public ContinuousPagerAdapter(int childLayoutResId, OnPageInstantiatedListener pListener) {
        this.childLayoutResId = childLayoutResId;
        this.pListener = pListener;
    }

    @Override
    public int getCount() {
        return 3;
    }

    @Override
    public boolean isViewFromObject(View view, Object object) {
        return view == object;
    }

    @Override
    public Object instantiateItem(View container, int position) {
        this.container = (ViewPager) container;

        // inflate a new child view
        LayoutInflater li = (LayoutInflater) container.getContext().getSystemService(
                Context.LAYOUT_INFLATER_SERVICE);
        View childView = li.inflate(childLayoutResId, null, false);

        // add it to the view pager and return
        int count = this.container.getChildCount();
        int actualPos = count > position ? position : count;
        this.container.addView(childView, actualPos);
        pListener.onPageInstantiated(actualPos); // sometimes use 0 instead of actualPos, with different but still inconsistent results
        return childView;
    }

    @Override
    public void destroyItem(View container, int position, Object object) {
        ((ViewPager) container).removeViewAt(position);
    }

    public static interface OnPageInstantiatedListener {
        public void onPageInstantiated(int position);
    }

    /**
     * Needed to ensure all the items are instantiated
     */
    @Override
    public int getItemPosition(Object object) {
        return POSITION_NONE;
    }

    @Override
    public Parcelable saveState() {
        return null;
    }

    @Override
    public void restoreState(Parcelable state, ClassLoader loader) {
    }

    @Override
    public void finishUpdate(View container) {
    }
} 
```

我不明白为什么页面在旋转后以 1->0->2 的顺序实例化。我也没有保存状态。对此的任何见解都会有所帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T09:33:14.203

在仔细调试应用程序并查看`ViewPager`源代码后，我发现了问题。

应用程序第一次启动和`mViewPager.setAdapter(mPagerAdapter)`调用时，页面会立即启动并且应用程序可以正常工作。但是，当手机旋转时，调用会`setAdapter()`推迟实例化页面，因为`getWindowToken()`在窗口尚未准备好时返回 null。实例化被延迟，直到在某个循环中调用*之后。* `onResume()`

调用`setCurrentItem(1, false)`使第一页成为主页面，因此它在其他页面之前被实例化，导致一开始奇怪的 1->0->2 实例化。

**解决方案？**在其他页面实例化后，使用 a`Handler`运行和加载数据：`setCurrentItem()`

```
new Handler().post(new Runnable() {
    @Override
    public void run() {
        mViewPager.setCurrentItem(1, false);
        cleanupAndShowData();
    }
}); 
```

虽然我通常想避免使用`Handler`s，但这似乎是我迄今为止发现的唯一选择，因为页面本身被添加到 looper 中。

**编辑**：即使上面也有一些问题。`mViewPager.setCurrentItem(1, false)`我只在所有页面都被实例化后才调用（在 中`onPageInstantiated()`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T07:14:55.847

```
actualPos= position%getCount(); 
```

如果这没有帮助，请提供一些额外的代码。

我还建议进行一些修改

```
mViewPager.setOffscreenPageLimit(2);   //use 2 instead of 3 unless neccessary 
```

# php - 目录的 CHMOD 只能通过 ftp 或服务器上的脚本读取

> ID：13585400
> 
> 赞同：0
> 
> 时间：2012-11-27T13:33:50.713
> 
> 标签：php, mysql, ftp, chmod

我想在同一服务器上仅使用 php - 脚本保存文件的目录的 CHMOD 是什么。这些文件只能使用我的 ftp 软件（我是管理员）或脚本读取。

背景是，我想在那里保存使用 php 脚本和 cron-job 创建的 mysql 数据库的备份。除了我之外，没有人应该有权访问这些。

是 770、700、600 还是 660 还是不同的？

我是否还需要使用 CHMOD 在此目录下设置文件，或者一旦我设置了上层目录的权限，它们就无法访问？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:38:13.103

您应该将 www-user（如果那是您的 php-/webserver 的组）和 ftp-user 放在一个公共组中。然后，目录应该有 mod= `770`; 即，*拥有目录（您）*和*上述组*的用户可写+可读+可执行...

八位位组的解释（即`7`上面提到的）：

*   `7`: 可写、可读、可执行
*   `5`：可读，可执行
*   `4`: 可读
*   `2`: 可写
*   `1`: 可执行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:37:53.187

如果您以用于 FTP 的同一用户身份运行脚本，那么您只需要：

```
chmod 700 
```

如果您有两个用户帐户，那么您需要一个共同的组成员身份，在这种情况下，权限将是

```
chmod 770 
```

# asp.net-mvc - 网址中的“F”标记？

> ID：13585401
> 
> 赞同：2
> 
> 时间：2012-11-27T13:33:58.450
> 
> 标签：asp.net-mvc, iis-7, asp.net-mvc-4, asp.net-mvc-routing

以前将我的 mvc 应用程序从 mvc2 更新到 mvc 3，上周更新到 mvc 4。还将它从 IIS6 服务器移动到 IIS7 服务器。

现在很多通过 mvc 路由生成的 url 在 url 中都有 token。像这样：

> [http://domain.net/(F(D4379600E44F6AF6D4695965E697E4EF18E37E9D4A33EF1DFAC33B05D8BD1C3601EC6D41276ADE9048699F26558469FB12118644813DE200464A082F0250855D8AC0825CAA33DFF40092C74D3B3AA0440D2547DEFE320118B53A1C43149B9E616D8579D2DFC35225E06055C3E4F8FF37F610729E))/page/something](http://domain.net/(F(D4379600E44F6AF6D4695965E697E4EF18E37E9D4A33EF1DFAC33B05D8BD1C3601EC6D41276ADE9048699F26558469FB12118644813DE200464A082F0250855D8AC0825CAA33DFF40092C74D3B3AA0440D2547DEFE320118B53A1C43149B9E616D8579D2DFC35225E06055C3E4F8FF37F610729E))/page/something)

此令牌适用于页面上所有 url 的 70%，甚至适用于图像。它看起来像无 cookie 浏览器的 Forms Auth 令牌。但我在 web.config 中禁用了 cookieless（仅将其设置为 cookie）。它还适用于所有浏览器（启用了 cookie），即使用户未登录也是如此。

如何解决这个问题？有任何想法吗？想想，升级到新的 mvc 时我错过了一些东西。

UPD。尝试以下一种方式禁用 cookieless（web.config）：

```
<sessionState cookieless="false" />
<authentication mode="Forms">
  <forms loginUrl="~/LogOn" timeout="2880" cookieless="UseCookies"  />
</authentication> 
```

UPD1。我在母版页中使用了几个 RenderAction 命令来呈现一些一般的局部视图。和这些部分的控制器方法，我用 OututCache 属性标记。删除了这个属性 - 现在所有的 url 看起来都不错。这很奇怪，但帮助了我。

```
<%Html.RenderAction("BlogPosts", "Widgets", new RouteValueDictionary()); %> 

[ChildActionOnly]
    //[OutputCache(Duration = 180)]
    public ActionResult BlogPosts()
    {
        var model = new BlogListModel();
        model.BlogPostType = defService.BlogType();
        model.List = widgetService.BlogPosts(3);
        return PartialView("Widgets/BlogPostsWidget", model);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:51:51.687

我同意其他评论者的观点，这可能是由`cookieless`会话状态属性引起的。各种站点表明，如果您将`cookieless`属性设置为`true`，则 URL 将嵌入会话 ID。

> 示例：[http://yourserver/folder/（](http://yourserver/folder/(session)此处为会话 ID）/default.aspx

*   [http://msdn.microsoft.com/en-us/library/aa479314.aspx](http://msdn.microsoft.com/en-us/library/aa479314.aspx)
*   [http://www.dailycoding.com/Posts/implementing_cookieless_session_aspnet.aspx](http://www.dailycoding.com/Posts/implementing_cookieless_session_aspnet.aspx)
*   [http://www.c-sharpcorner.com/UploadFile/deepak.sharma00/using-cookie-less-session-in-Asp-Net/](http://www.c-sharpcorner.com/UploadFile/deepak.sharma00/using-cookie-less-session-in-Asp-Net/)

[OutputCache](http://msdn.microsoft.com/en-us/library/hdxfb6cy%28v=vs.100%29.aspx)似乎与无 cookie 实现无关。

您所做的`web.config`更改可能不是立竿见影的。[这有点模棱两可](https://stackoverflow.com/a/613836/1085891)，但为了安全起见，您应该在对`web.config`文件进行任何更改后重新启动应用程序。

我将重新启动应用程序，取消注释您的 OutputCache 代码，构建/发布，然后查看您得到的结果。

# asp.net - 将可为空的 int 设置为 null

> ID：13585403
> 
> 赞同：0
> 
> 时间：2012-11-27T13:34:07.080
> 
> 标签：asp.net

在我的评估表中，我有一个名为“AppraisalTrace”的字段，它引用了另一个表。该字段是一个可以为空的 int，因为我希望能够在没有 AppraisalTrace 的情况下创建 Appraisal。我正在使用 xsd 来加入数据库和代码。

现在在我的代码中，当我创建评估时，我正在执行以下操作：

```
oAppraisalRow.SetAppraisalTraceNull(); 
```

此自动生成的方法由 dataRow 提供，但是当我尝试插入带有 Null AppraisalTrace 的评估时，它会引发以下异常：

```
Value for column "AppraisalTrace" in table "Appraisal" is DBNull 
```

那么我应该如何创建我的评估？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:43:10.050

我假设您在尝试从可为空字段中检索值时遇到此异常。您的强类型`DataRow`还有一个自动生成的`bool`属性，指示该字段是否`DBNull`存在。你必须使用它：

```
if(oAppraisalRow.IsAppraisalTraceNull)
{
    // this causes your exception, so don't access a nullable field directly 
    var trace = oAppraisalRow.AppraisalTrace;
}
else
{   
    // here you can safely get the value
    var trace = oAppraisalRow.AppraisalTrace;
} 
```

因此，首先检查该属性的字段是否为空`bool`。

# android - 获得最准确的位置/位置？(GPS/卡尔曼/安卓)

> ID：13585405
> 
> 赞同：10
> 
> 时间：2012-11-27T13:34:16.140
> 
> 标签：android, gps, location, accelerometer, kalman-filter

我正在为 android 开发一个 AR 应用程序，我需要一个非常准确的位置（低于 1m）。该应用程序基于行人（户外）并且需要实时位置。我知道这个问题可能是一个非常困难的问题，但希望其他人已经找到了解决方案。

我已经研究过卡尔曼滤波器和扩展卡尔曼滤波器，但到目前为止我还没有找到我能够使用或适应的解决方案。我认为卡尔曼滤波器可能是我需要去的方向。

现在我正在使用原始 gps 数据来设置我的位置，但这太不准确了，当设备静止在一个地方时，它可以四处移动甚至跳跃约 5-10 米。

所以我的问题是：虽然我现在使用未经过滤的原始 gps 数据来获取位置，但我需要如何过滤它（卡尔曼？扩展卡尔曼？）以及我需要使用哪些传感器（gps 位置？gps 速度？加速度计?) 以获得最准确的位置行人户外位置。

更新：我需要更新我的问题，因为不可能做我最初的问题，在平板电脑/手机 gps 上获得低于 1 米的精度。我现在的问题是：我如何应用过滤，以便后续的 gps 位置测量保持在可管理的距离内。例如，当我用我的设备向北 10m 时，我的 gps 也测量到我从初始位置向北 +/-1m (10%)，而不是 gps 测量的跳跃/移动。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T13:55:06.177

确实，这是一项非常艰巨的任务，**人们在这个主题上写他们的博士论文。**我发现这些很有用：

*   [使用鞋装惯性传感器进行行人跟踪](http://www.intersense.com/uploads/documents/Pedestrian_Tracking_with_Shoe-Mounted_Inertial_Sensors.pdf)

*   [使用单个加速度计提高计步器的性能](http://www.analog.com/static/imported-files/application_notes/47076299220991AN_900.pdf)

*   [使用 Sigma-Point Kalman 平滑器的基于 RSSI 的室内定位和跟踪](http://www.cse.ogi.edu/~anindya/Paul_Wan_Plans08.pdf)

另请参阅[Android 加速度计精度（惯性导航）](https://stackoverflow.com/q/7829097/341970)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T14:12:21.053

在实际应用中，GPS 系统无法为您提供比 5 - 10 米更好的精度/准确度，尤其是在您使用智能手机或平板电脑作为接收器时。查看有关 GPS 的 Wikipedia 页面以获取详细说明：

[https://en.wikipedia.org/wiki/Gps](https://en.wikipedia.org/wiki/Gps)

[https://en.wikipedia.org/wiki/Error_analysis_for_the_Global_Positioning_System](https://en.wikipedia.org/wiki/Error_analysis_for_the_Global_Positioning_System)

[https://en.wikipedia.org/wiki/GPS_augmentation](https://en.wikipedia.org/wiki/GPS_augmentation)

仅使用过滤或其他数学“数据按摩”没有任何方法可以提高这种准确性。您必须依赖一些辅助定位系统（即：地理参考数据的辅助来源）。

应用最广泛的辅助定位系统是“网络”系统。它使用蜂窝电话天线和 wi-fi 天线作为辅助参考点。这种方法已经被谷歌地图和其他服务，以及安卓、苹果和 Windows 8 智能手机和平板电脑使用。您只需在代码中的可用位置提供程序中选择它。

即使您应用了大量的数据处理/过滤，基于 Wi-Fi/Cell 的系统也很少能为您提供比几米更好的精度（“房间级精度”）。

如果您想使用不同的系统，您可以评估惯性导航系统或地磁导航系统（如 Indoor Atlas： http: [//www.indooratlas.com/](http://www.indooratlas.com/)）。

编写惯性导航系统 (INS) 并不容易。您可以在网上找到一些描述，但很可能您必须自己编写所有代码。INS 通常不能为您提供比 GPS 更好的精度。

或者，您可以购买商业、即用型地磁系统，例如 Indoor Atlas。地磁系统可以非常精确。室内地图集声称精度为几厘米。

如果您正在寻找基于 wi-fi/cell-antennas 的系统来替代 Google Maps，您可以查看 Combain：

[http://combain.com/](http://combain.com/)

[http://location-api.com/](http://location-api.com/)

我对 WiFiSLAM 也有很好的体验：

[http://wifislam.com/](http://wifislam.com/)

# matlab - 函数之外的 nargin 是什么？

> ID：13585408
> 
> 赞同：2
> 
> 时间：2012-11-27T13:34:21.213
> 
> 标签：matlab, command-line, arguments, octave, interactive-mode

我只是在编写一个 Matlab 函数，并想将我所拥有的内容复制并粘贴到一个交互式会话中。其中一些是`nargin`语句（例如`if nargin < 1; a = 0; end;`），事实证明`nargin`在我的工作区中具有值 11005，而我没有分配它。有谁知道这是什么，它是否用于任何事情（函数之外）以及将其设置为零是否有任何问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T13:47:16.287

When used within a function, [`nargin`](http://www.mathworks.se/help/matlab/ref/nargin.html) gives the number of parameters passed to that function. Used with a string argument `fn` it is an in-built function, which returns the number of parameters taken by function `fn`. You should **not** call it without a parameter from the workspace:

> nargin returns the number of input arguments passed in the call to the currently executing function. **Use this nargin syntax only in the body of a function.**

You can, but you should avoid assigning a value to `nargin`, since it will then loose the second semantics:

```
nargin('sparse')

ans =

 6

nargin = 0;
nargin('sparse')
Index exceeds matrix dimensions. 
```

# oracle - 为 JPA 查询设置 oracle NLS_LANG

> ID：13585413
> 
> 赞同：1
> 
> 时间：2012-11-27T13:34:31.357
> 
> 标签：oracle, jpa, nls-lang

我需要访问一个需要设置特定 nls_lang 的 oracle 数据库视图 - 如果不是，则不会使用索引，并且数据库将永远锁定。我知道这是一个糟糕的笑话设计，但我无法改变。

我可以通过设置系统变量`user.country`和/或来更改 nls_lang `user.language`，这将正确更改 nls_lang。但是，这将以未知的方式影响我的应用程序，甚至更糟：同一服务器上的其他应用程序。简单地说，这不是一个可能的解决方案。

**那么如何为单个 JPA 本机查询设置 nls_lang ，同时为服务器设置另一个语言环境**？它必须是本机查询，因为我正在从不包含实体所需的 PK 的视图中进行选择。

我试过了

```
entityManager.createNativeQuery("ALTER SESSION set NLS_LANGUAGE = 'American'").executeUpdate(); 
```

在运行我的查询之前，但它似乎没有效果，可能是因为查询是在不同的会话中完成的。也许理论上我可以`Locale.setDefault()`临时设置，并在查询后恢复它，但这会产生并发问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:59:24.367

确保您首先开始事务并使用相同的 EntityManager 进行设置和查询。

# facebook - 使用 facebook graph api 从页面获取事件

> ID：13585418
> 
> 赞同：3
> 
> 时间：2012-11-27T13:34:34.990
> 
> 标签：facebook, http, facebook-graph-api, oauth

我正在尝试使用图形 api 从 facebook 页面获取事件。我使用以下方法成功获得了访问令牌：

[https://graph.facebook.com/oauth/access_token?client_id=](https://graph.facebook.com/oauth/access_token?client_id=) '+APP_ID+'&client_secret='+APP_SECRET+'&grant_type=client_credentials

然后我尝试使用 facebook.com/workmans.clubnights/ 从页面获取事件

[https://graph.facebook.com/workmans.clubnights/](https://graph.facebook.com/workmans.clubnights/) **events** ?access_token=XXXXXXXXXXXXXXXXXXXXX

但是我得到一个空洞的回应。

其他请求成功，例如[https://graph.facebook.com/workmans.clubnights/?access_token=XXXXXXXXXXXXXXXXXXXXX](https://graph.facebook.com/workmans.clubnights/?access_token=XXXXXXXXXXXXXXXXXXXXX)

我觉得这可能是权限问题。是否可以从页面获取事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T15:30:48.873

> 我正在尝试从 facebook 页面获取事件

你是——我是说，*真的*……？

> 然后我尝试从 facebook.com/workmans.clubnights/ 页面获取事件

好的，所以你*不是*——不是来自*页面*，因为这是一个**用户配置文件！**

根据[https://developers.facebook.com/docs/reference/api/user/](https://developers.facebook.com/docs/reference/api/user/)，您需要获得许可`user_events`或`friends_events`阅读*用户的*事件。

您正在使用应用程序访问令牌来请求事件 - 这可能有效，但前提是用户首先连接到您的应用程序并授予权限。

当然，这些只是*症状*——真正的问题。（故意的？）这里的错误是您将用户个人资料用于显然应该是粉丝页面的内容。（如果这实际上是您的页面。如果是这样，您应该检查将其转换为粉丝页面的选项。否则，当 Facebook 关闭此帐户时，您可能会突然醒悟，因为它不是真人的帐户。也一样`www.facebook.com/somewherewednesday`。）

# excel - 用多个值填充一列

> ID：13585421
> 
> 赞同：1
> 
> 时间：2012-11-27T13:34:45.833
> 
> 标签：excel, vba

我有一个不寻常的问题。我有一个电子表格，其中包含 A:J 列的数据。我想再添加一列 K，并用员工姓名填充它。这个想法是为每个工作人员分配一个电子表格。分配的数字已经在另一张表中计算出来，并在此电子表格的 M 和 N 列中引用。M2 及以下包含员工姓名，N2 及以下包含其相应的分配。

我的问题是弄清楚如何用这些数据填充 K 列。例如 APerson (M2) 的分配为 23(N2)，我想用 APerson 的名称填充 K2（第 1 行是标题）到 K24。之后，我想为 APerson2(M3) 分配 15(N3)，然后从 K25 开始。我感觉它会涉及循环，但我的 VBA 知识不完整，环顾四周，我只能找到填充增量数字的循环。

编辑：抱歉没有附加任何文件；这最初是通过我的手机发布的，因为我的工作阻止了 stackoverflow。我打印了我正在进行的代码，所以我会尽快输入它。

编辑2：到目前为止，这是我的代码。我有分配工作 - 有点。

```
Sub Allocate()
name1 = Range("M2").Value
countto = Range("N2").Value

Range("K1").Select
 Do
    ActiveCell.Offset(1, 0).Select
    Loop Until IsEmpty(ActiveCell.Value)
    For Counter = 1 To countto
        ActiveCell.Value = name1
        ActiveCell.Offset(1, 0).Select
    Next Counter

name2 = Range("M3").Value
countto2 = Range("N3").Value

Range("K1").Select
 Do
    ActiveCell.Offset(1, 0).Select
Loop Until IsEmpty(ActiveCell.Value)
    For Counter2 = 1 To countto2
        ActiveCell.Value = name2
        ActiveCell.Offset(1, 0).Select
    Next Counter2
End Sub 
```

有没有什么方法可以自动为大量（20 多名）员工分配“name1”、“name2”等，而无需手动输入全部内容，或者任何关于如何提高效率的提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:52:50.463

正如我看到您对 VB 有一些基本知识并且我有点生疏，这是一项匆忙的工作，直到有人给您一个更好的答案。它假定在​​您的源工作表上，每行连续有一个不同的名称，然后是一个空白行。

```
enter code here

Sub Allocate()
i3 = 2     'counter for DESTINATION sheet
i1 = 2     'counter for SOURCE sheet

Do until sheets(source).cells(i1, N#).value = ""     'until the last name
    NAME = sheets(source).cells(i1, N#).value         'N#: column NUMBER containing names
    ENTRIES = Sheets(Source).cells(i1, C#).value      'C#: column NUMBER containing numbers
    For i2 = 1 to ENTRIES
        Sheets(Dest).ceklls(i3, 11).value = NAME             '11 is column K
        i3 = i3 + 1
    Next
i1 = i1 + 1
Loop 
```

# java - Android：日期选择器侦听器从 null 到 active

> ID：13585431
> 
> 赞同：-1
> 
> 时间：2012-11-27T13:35:17.677
> 
> 标签：java, android, eclipse, datepicker, listener

我在同一个活动中有两个日期选择器并且它们相互连接，因为当用户更改一个日期时，另一个日期选择器日期直接更改 **这里是听众**

```
 //initialize period date picker with current date and on date change listener 
        periodDatePicker.init(currentYear, currentMonth, currentDay, new OnDateChangedListener()
        {
            @Override
            public void onDateChanged(DatePicker periodDatePicker, int currentYear, int currentMonth,int currentDay) {
                // TODO Auto-generated method stub
                Number = 1;
            birthDayDatePicker.init(currentYear, currentMonth, currentDay, null);
                birthDateCalculations();

            }
        });

        //initialize birth date picker with current date and on date change listener 
        birthDayDatePicker.init(currentYear, currentMonth, currentDay, new OnDateChangedListener () {

            @Override
            public void onDateChanged(DatePicker birthDayDatePicker, int currentYear, int currentMonth, int currentDay) {
                // TODO Auto-generated method stub
                Number = 2;
                periodDatePicker.init(currentYear, currentMonth, currentDay, null);
                periodDateCalculations();               
            }
        }); 
```

当调用一个日期选择器侦听器时，**我将另一个侦听器转到第二个日期选择器为 null ，我的问题是，我*怎样才能使我转向 null 的侦听器再次处于活动状态***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:46:11.497

**编辑**
如果您为侦听器分配一个变量，您可以重用它们。此外，您似乎有变量名冲突。当`OnDateChangedListener`被调用时，有一个`currentYear/currentMonth/currentDay`函数参数和类成员变量：

```
OnDateChangedListener periodListener = null;
OnDateChangedListener birthdayListener  = null;

periodListener = new OnDateChangedListener() {
         @Override
         public void onDateChanged(DatePicker periodDatePicker, int newYear, int newMonth, int newDay) {
              Number = 1;
              birthDayDatePicker.init(currentYear, currentMonth, currentDay, null);
              birthDateCalculations();
              birthDayDatePicker.init(currentYear, currentMonth, currentDay, birthdayListener);
         }

birthdayListener = new OnDateChangedListener () {    
         @Override
         public void onDateChanged(DatePicker birthDayDatePicker, int newYear, int newMonth, int newDay) {
              Number = 2;
              periodDatePicker.init(currentYear, currentMonth, currentDay, null);
              periodDateCalculations();               
              periodDatePicker.init(currentYear, currentMonth, currentDay, periodListener);
         }
    });

birthDayDatePicker.init(currentYear, currentMonth, currentDay, birthdayListener);
periodDatePicker.init(currentYear, currentMonth, currentDay, periodListener); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:46:53.710

在类级别创建侦听器，并在您需要时在代码中使用它。癌症的答案是正确的。

# sorting - 我可以为reducer中的记录分配序列号吗

> ID：13585434
> 
> 赞同：0
> 
> 时间：2012-11-27T13:35:33.693
> 
> 标签：sorting, hadoop, mapreduce

我希望根据事件发生的时间为来自 Mapper 类的事件分配一个序列号。

例如，我有 100 个事件，其中有时间。我希望根据时间对它们进行排序，然后在减速器阶段为它们分配一个序列号。此外，如果它们是重复的，则在 reducer 阶段删除重复的记录（同时发生相同的事件）。

映射器方法：

```
public class EventMapper extends Mapper<LongWritable, Text, Text, Event> {

public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException {
    String line = value.toString();
    Text newKey;
    Event e = new Event();
    e.setAllValues(line);
    newKey = new Text(e.getKey());
    context.write(newKey, e);
}
} 
```

减速器方法（我想要的东西）：

```
public class EventReducer extends Reducer<Text, Event, Text, Text> {

public void reduce(Text key, Iterator<Event> itrtr, Context context) throws IOException, InterruptedException {
    Event e;
    List<Event> l = new ArrayList<Event>();
    while(itrtr.hasNext()){
        e = itrtr.next();
         l.add(e);
    }
    Collections.sort(l);
    long i = 1;
    for (Event event : l) {
        event.setId(++i);
        context.write(key, new Text(event.toString()));
    }
}
} 
```

我把所有的 id 都设为 0。我怎样才能做到这一点？我是否采用了错误的方法。

这是事件类：

```
public class Event implements Writable, WritableComparable<Event> {
//Some variables and getter + setters
 @Override
public String toString() {
    String delimiter1 = "|";
    return this.date + delimiter1
            + this.evName + delimiter1
            + this.evType + delimiter1
            + this.evValue + delimiter1
            + this.name + delimiter1
            + this.id;
}

@Override
public void readFields(DataInput in) throws IOException {
    try {
        this.date = converStringToDate((WritableUtils.readString(in)).toString(), dateFormat);
    } catch (ParseException ex) {
        System.out.println("Wront date . Pe");
    }
    this.evName = WritableUtils.readString(in);
    this.evType = WritableUtils.readString(in);
    this.evValue = WritableUtils.readString(in);
    this.name = WritableUtils.readString(in);
    this.id = WritableUtils.readVLong(in);
}

@Override
public void write(DataOutput out) throws IOException {
    // TODO Auto-generated method stub
    WritableUtils.writeString(out, this.convertDateToString(date));
    WritableUtils.writeString(out, evName);
    WritableUtils.writeString(out, evType);
    WritableUtils.writeString(out, evValue);
    WritableUtils.writeString(out, name);
    WritableUtils.writeVLong(out, id);
}

public int compareTo(Event o) {
    long value = this.getDate().getTime() - o.getDate().getTime();
    if (value == 0) {
        return 0;
    } else if (value > 1) {
        return -1;
    } else {
        return 1;
    }
    }
public void setAllValues(String input) {
    String[] arrValues = input.split(delimiter);
    System.out.println("No of Values = " + arrValues.length);
    try {
        this.date = converStringToDate(arrValues[0], dateFormat);
    } catch (ParseException pe) {
        System.out.println("pe> Error in date");
    }
    if (arrValues.length >= 2) {
        this.evName = arrValues[1];
    }
    if (arrValues.length >= 3) {
        this.evType = arrValues[2];
    }
    if (arrValues.length >= 4) {
        this.evValue = arrValues[3];
    }
    if (arrValues.length >= 5) {
        this.name = arrValues[4];
    }
}

public String getKey() {
    //return convertDateToString(this.date) + this.evName + this.evType;
    return this.evName;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T14:43:51.427

几个建议：

*   更改 getKey() 以返回 date.getTime()。这是一个长值，并且比字符串更快。将您的内部键类型更改为 LongWritable。
*   您正在利用 hadoop 行为，即在传递给减速器之前按键值对记录进行排序。这是一种排序方式，但您必须确保在作业配置中将 numberOfReducers 设置为 1。否则，您将有多个减速器从 1 开始在它们自己的分区上分配等级。
*   您可以使用多个 reducer，但您必须在这项工作之后完成一项工作，以合并所有内部排名的数据分区。
*   请记住，您的 reducer 将为每个键值调用一次，即使该键有多个记录（例如同时多个事件）。`Iterable`如果您想忽略这些重复事件，那么无论该值有多少条记录，reducer 都应该只将一条记录写入上下文。
*   为了正确分配等级（id），您需要在您的reducer 中有一个long 类型的实例变量（调用它`counter`）。您需要在方法中初始化它并在`setup()`方法中增加它`reduce()`。

# java - 多线程使用的Java同步和静态同步方法

> ID：13585435
> 
> 赞同：1
> 
> 时间：2012-11-27T13:35:40.230
> 
> 标签：java, synchronization

我一直对以下情况感到困惑

MyClass 只有一个对象，有两个线程 T1、T2。现在一个线程说 T2 将能够使用具有唯一 MyClass 对象锁的同步方法 m1()，如果它试图访问 m1()，其他线程 T2 将被阻塞。

现在我的看法是，如果 T2 将尝试通过访问静态共享字段来访问静态同步方法 m2()，它将被阻塞，因为当前对象锁与 T1 并不能执行 m2() 并且如果有两个 Myclass 对象然后 T2 线程将能够访问 m1()。我是对还是错？

```
class MyClass
{

            public static int i = 5;

        public synchronized void m1()
        {
                System.out.println(i); //uses static field i of MyClass
            //T1 is executing this method
        }

            public static synchronized void m3()
            {
                //T2 will be able to call this method on same object lock while it is using
                //static field i???
                System.out.println(i);//uses static field i of MyClass
            }
} 
```

这非常令人困惑，请帮助。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T13:39:18.033

不正确。因为无论方法的状态如何，在尝试调用它时都`m2`不会阻塞任何线程。`synchronized``synchronized``m1`

获取对象上的锁不会阻止对该对象的访问，它只会阻止另一个线程同时获取同一对象上的锁的能力。如果其他线程没有尝试获取锁，它不会被阻塞。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-27T13:39:25.787

> 现在我的看法是，如果 T2 将尝试访问非同步方法 m2() 它将被阻塞，因为当前对象锁与 T1

不`m2()`，不同步，因此没有什么可以阻止它。这就是同步方法和非同步方法之间的区别。

当一个线程试图进入一个同步方法时，它会阻塞直到它可以获取到合适的监视器（锁）。当它退出方法时，它将释放锁。对于非同步方法，这些步骤都不会发生。

（顺便说一句，我个人建议在大多数情况下根本不使用同步方法。相反，*在方法内同步，在**仅*在该类中知道的引用上。这样更容易推理代码，因为*只有*您的班级才能获得该锁。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T13:40:46.053

你错了。对象不会被`synchronized`块“锁定”，唯一发生的事情是其他`synchronized`块试图获取该对象的监视器必须等待。

总结一下：`synchronized`对非同步代码绝对没有阻塞作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T13:40:00.520

线程进入同步方法 /block 时获取锁。因为 m2() 不是同步的，它会被线程 2 执行。记住，锁只有在有同步方法时才会出现

# sbt - 为什么我的 sourceDirectories 设置在 sbt 中无效？

> ID：13585437
> 
> 赞同：5
> 
> 时间：2012-11-27T13:35:51.433
> 
> 标签：sbt

我正在阅读 SBT[入门](http://www.scala-sbt.org/release/docs/Getting-Started/More-About-Settings.html)指南。该页面以`sourceDirectories`设置为例。为了自己尝试，我将以下内容放入我的`build.sbt`文件中，用于基本的“hello world”项目。

```
sourceDirectories in Compile := Seq(file("other")) 
```

（附加`+=`或`++=`不工作。）

我有源文件`<base-dir>/other`和`<base-dir>/src/main/scala`. 我边跑边`sbt`打字`compile`。它忽略了设置：

```
> compile
[info] Compiling 1 Scala source to /Learning/Scala/proj1/target/scala-2.9.2/classes...
[error] /Learning/Scala/proj1/src/main/scala/hello.scala:7: not found: value Foo
[error]     println(Foo.foo) 
```

该对象在源目录`Foo`的 foo.scala 中定义。`other`

我错过了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-12-08T00:57:32.470

tl;dr [@schleichardt 的答案](https://stackoverflow.com/a/13586961/1305344)是有效的 - 您需要将以下内容添加到`build.sbt`文件中：

```
unmanagedSourceDirectories in Compile += file("other") 
```

解释归结为检查`compile`任务的依赖关系。用来`inspect tree compile`找出它们。

```
[proj1]> inspect tree compile
[info] compile:compile = Task[sbt.inc.Analysis]
[info]   +-compile:compile::compileInputs = Task[sbt.Compiler$Inputs]
[info]   | +-compile:scalacOptions = Task[scala.collection.Seq[java.lang.String]]
[info]   | +-compile:sources = Task[scala.collection.Seq[java.io.File]]
[info]   | +-*/*:sourcePositionMappers = Task[scala.collection.Seq[scala.Function1[xsbti.Position, scala.Option[xsbti.Position]]]]
[info]   | +-*/*:maxErrors = 100
[info]   | +-*:compilers = Task[sbt.Compiler$Compilers]
[info]   | +-compile:compile::streams = Task[sbt.std.TaskStreams[sbt.Init$ScopedKey[_ <: Any]]]
[info]   | | +-*/*:streamsManager = Task[sbt.std.Streams[sbt.Init$ScopedKey[_ <: Any]]]
[info]   | |
[info]   | +-compile:incCompileSetup = Task[sbt.Compiler$IncSetup]
[info]   | +-*/*:compileOrder = Mixed
[info]   | +-compile:dependencyClasspath = Task[scala.collection.Seq[sbt.Attributed[java.io.File]]]
[info]   | +-compile:classDirectory = target/scala-2.10/classes
[info]   | +-*/*:javacOptions = Task[scala.collection.Seq[java.lang.String]]
[info]   |
[info]   +-compile:compile::streams = Task[sbt.std.TaskStreams[sbt.Init$ScopedKey[_ <: Any]]]
[info]     +-*/*:streamsManager = Task[sbt.std.Streams[sbt.Init$ScopedKey[_ <: Any]]]
[info] 
```

如您所见，任务取决于`compile:sources`任务。该任务又取决于`compile:unmanagedSources`使用该`compile:unmanagedSourceDirectories`设置的任务。

```
[proj1]> inspect tree compile:sources
[info] compile:sources = Task[scala.collection.Seq[java.io.File]]
[info]   +-compile:unmanagedSources = Task[scala.collection.Seq[java.io.File]]
[info]   | +-compile:unmanagedSourceDirectories = List(/Users/jacek/sandbox/stackoverflow/proj1/src/main/scala, /Users/jacek/sandbox/stackoverflow/proj1/src/main/java, /Users/..
[info]   | | +-compile:javaSource = src/main/java
[info]   | | | +-compile:sourceDirectory = src/main
[info]   | | |   +-*:sourceDirectory = src
[info]   | | |   | +-*:baseDirectory = /Users/jacek/sandbox/stackoverflow/proj1
[info]   | | |   |   +-*:thisProject = Project(id: proj1, base: /Users/jacek/sandbox/stackoverflow/proj1, aggregate: List(), dependencies: List(), configurations: List(compile..
[info]   | | |   |
[info]   | | |   +-compile:configuration = compile
[info]   | | |
[info]   | | +-compile:scalaSource = src/main/scala
[info]   | | | +-compile:sourceDirectory = src/main
[info]   | | |   +-*:sourceDirectory = src
[info]   | | |   | +-*:baseDirectory = /Users/jacek/sandbox/stackoverflow/proj1
[info]   | | |   |   +-*:thisProject = Project(id: proj1, base: /Users/jacek/sandbox/stackoverflow/proj1, aggregate: List(), dependencies: List(), configurations: List(compile..
[info]   | | |   |
[info]   | | |   +-compile:configuration = compile
[info]   | | |
[info]   | | +-*:baseDirectory = /Users/jacek/sandbox/stackoverflow/proj1
[info]   | |   +-*:thisProject = Project(id: proj1, base: /Users/jacek/sandbox/stackoverflow/proj1, aggregate: List(), dependencies: List(), configurations: List(compile, runt..
[info]   | |
[info]   | +-*/*:excludeFilter = sbt.SimpleFileFilter@7ced8ea7
[info]   | +-*:baseDirectory = /Users/jacek/sandbox/stackoverflow/proj1
[info]   | +-*/*:unmanagedSources::includeFilter = sbt.SimpleFilter@1beb6bba
[info]   | +-*/*:sourcesInBase = true
[info]   |
[info]   +-compile:managedSources = Task[scala.collection.Seq[java.io.File]]
[info]     +-compile:sourceGenerators = List()
[info] 
```

该`compile:unmanagedSourceDirectories`设置引用*“非托管源目录，其中包含手动创建的源”。*

```
[proj1]> inspect compile:unmanagedSourceDirectories
[info] Setting: scala.collection.Seq[java.io.File] = List(/Users/jacek/sandbox/stackoverflow/proj1/src/main/scala, /Users/jacek/sandbox/stackoverflow/proj1/src/main/java, /Users/jacek/sandbox/stackoverflow/proj1/other)
[info] Description:
[info]  Unmanaged source directories, which contain manually created sources.
[info] Provided by:
[info]  {file:/Users/jacek/sandbox/stackoverflow/proj1/}proj1/compile:unmanagedSourceDirectories
[info] Defined at:
[info]  (sbt.Defaults) Defaults.scala:161
[info]  /Users/jacek/sandbox/stackoverflow/proj1/build.sbt:1
[info] Dependencies:
[info]  compile:javaSource
[info]  compile:scalaSource
[info]  *:baseDirectory
[info] Reverse dependencies:
[info]  compile:unmanagedSources
[info]  compile:sourceDirectories
[info] Delegates:
[info]  compile:unmanagedSourceDirectories
[info]  *:unmanagedSourceDirectories
[info]  {.}/compile:unmanagedSourceDirectories
[info]  {.}/*:unmanagedSourceDirectories
[info]  */compile:unmanagedSourceDirectories
[info]  */*:unmanagedSourceDirectories
[info] Related:
[info]  test:unmanagedSourceDirectories 
```

该设置属于`scala.collection.Seq[java.io.File]`类型，并且要将元素附加到 seq，您可以使用`+=`方法。

话虽如此，该`build.sbt`文件应如下所示：

```
unmanagedSourceDirectories in Compile += (baseDirectory / "other").value 
```

您不必使用该`baseDirectory`设置，但它使基本目录明确。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T14:58:38.360

你可以试试这个：

```
unmanagedSourceDirectories in Compile += file("other") 
```

# eclipse - 为 Java EE 开发人员升级 Eclipse IDE

> ID：13585438
> 
> 赞同：1
> 
> 时间：2012-11-27T13:35:59.673
> 
> 标签：eclipse, eclipse-juno

我一直在使用 Eclipse IDE for Java EE Developers for Juno (4.2 SR1)，它是我从 Eclipse 站点下载的自定义二进制文件。随着[Juno 的缓慢](https://bugs.eclipse.org/bugs/show_bug.cgi?id=385272)，这几乎无法使用。eclipse 团队正在修复他们宣传的在他们的里程碑版本中可用的修复程序。有人可以指导我：

1.  是否可以升级 Eclipse IDE for Java EE Developers 以从里程碑更新站点获取相关更改？
2.  如果是，如何解决冲突？

我尝试[为 Juno 里程碑添加更新站点](http://download.eclipse.org/eclipse/updates/4.2-M-builds)并尝试升级 Eclipse 平台，如此[处](https://bugs.eclipse.org/bugs/show_bug.cgi?id=385272#c57)
所述 计算依赖关系后，它详细说明了为什么它无法继续，我无法破译。

```
Your original request has been modified.
  "Eclipse Platform" is already installed, so an update will be performed instead.
Cannot complete the install because of a conflicting dependency.
  Software being installed: Eclipse Platform 4.2.2.M20121121-1200 (org.eclipse.platform.ide 4.2.2.M20121121-1200)
  Software currently installed: Eclipse IDE for Java EE Developers 1.5.1.20120917-1257 (epp.package.jee 1.5.1.20120917-1257)
  Only one of the following can be installed at once: 
    Eclipse Workbench User Guide 4.2.0.v20120829-072800 (org.eclipse.platform.doc.user 4.2.0.v20120829-072800)
    Eclipse Workbench User Guide 4.2.0.v20120912-144258 (org.eclipse.platform.doc.user 4.2.0.v20120912-144258)
    Eclipse Workbench User Guide 4.2.0.v20120606-135340 (org.eclipse.platform.doc.user 4.2.0.v20120606-135340)
  Cannot satisfy dependency:
    From: Eclipse IDE for Java EE Developers 1.5.1.20120917-1257 (epp.package.jee 1.5.1.20120917-1257)
    To: org.eclipse.epp.package.jee.feature.feature.group [1.5.1.20120917-1257]
  Cannot satisfy dependency:
    From: Java EE IDE Feature 1.5.1.20120917-1257 (org.eclipse.epp.package.jee.feature.feature.group 1.5.1.20120917-1257)
    To: org.eclipse.platform.feature.group [4.2.1.v20120814-120134-9JF7BHVGFyMveli1uX6aTH0q-eAap6PAgOP5mO]
  Cannot satisfy dependency:
    From: Eclipse Platform 4.2.1.v20120814-120134-9JF7BHVGFyMveli1uX6aTH0q-eAap6PAgOP5mO (org.eclipse.platform.feature.group 4.2.1.v20120814-120134-9JF7BHVGFyMveli1uX6aTH0q-eAap6PAgOP5mO)
    To: org.eclipse.platform.doc.user [4.2.0.v20120829-072800]
  Cannot satisfy dependency:
    From: Eclipse Platform 4.2.1.v20121115-222257-9LF7DHVKG-F1itrD-OMdQj0FBElP-MWn4gn9s_ (org.eclipse.platform.feature.group 4.2.1.v20121115-222257-9LF7DHVKG-F1itrD-OMdQj0FBElP-MWn4gn9s_)
    To: org.eclipse.platform.doc.user [4.2.0.v20120912-144258]
  Cannot satisfy dependency:
    From: Eclipse Platform 4.2.2.M20121121-1200 (org.eclipse.platform.ide 4.2.2.M20121121-1200)
    To: org.eclipse.platform.feature.group [4.2.1.v20121115-222257-9LF7DHVKG-F1itrD-OMdQj0FBElP-MWn4gn9s_] 
```

有人可以帮我吗？我也想过去 eclipse 论坛，但想在这里可能会得到更快的回应。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T04:55:40.240

从[https://bugs.eclipse.org/bugs/show_bug.cgi?id=385272](https://bugs.eclipse.org/bugs/show_bug.cgi?id=385272)，

1.  帮助>安装新软件

2.  使用网站：[junoSR1Patch](http://download.eclipse.org/eclipse/updates/junoSR1Patch-tmp)

3.  选择 Eclipse UI Juno SR1 Optimizations，安装并重启

所有修复也在 Kepler 版本中，但是下一个 Kepler 里程碑还需要几周时间。最好的办法是安装官方候选补丁，它适用于所有 EPP 包以及 Eclipse“经典”SDK

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:37:25.370

不要在这上面浪费你的时间。只需下载一个新的[Eclipse](http://www.eclipse.org/downloads/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T15:35:43.867

您可以在[此下载页面](http://www.eclipse.org/downloads/packages/release/kepler/m3)获取适用于 Java EE 开发人员的 Kepler M3 Eclipse IDE 。

# flash - videojs Flash后备在IE8中不起作用

> ID：13585439
> 
> 赞同：2
> 
> 时间：2012-11-27T13:36:02.460
> 
> 标签：flash, video, fallback, video.js

我最近才开始将 html5 与 videojs 一起使用，我相信我一切正常，但是，flash 视频后备不适用于 WinXP 中的 IE8。此外，它不仅是我的网站，而且[http://videojs.com/](http://videojs.com/)网站上的视频也无法在 IE8 中运行。

所以，我认为这是 videojs flash 播放器的错误。例如，当我使用 IE8 访问[http://videojs.com/](http://videojs.com/)并在页面顶部播放视频时，没有播放视频，而是在视频窗口中显示一个黑框，而视频的音频确实在Flash播放器。不过，当我访问其他 Flash 视频网站时，IE8 可以正常播放它们。

有没有其他人注意到这一点，您是否有任何关于何时修复此问题的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T01:40:37.380

Its fixed. All that I did was turn hardware acceleration off in the local flash player running under IE8 in WinXP:

Right click on video when playing or paused > Settings > Uncheck "Enable hardware acceleration"

I actually had to change the setting while playing a Flash video that doesn't use videojs since IE8 froze up when trying to play Flash with videojs. It probably has something to do with the fact that I am running a virtualized image of WinXP under VirtualBox.

Now the Flash fallback works fine with videojs and I have lots of joy...

# c - 套接字：字节顺序混淆

> ID：13585446
> 
> 赞同：4
> 
> 时间：2012-11-27T13:36:29.433
> 
> 标签：c, unix, networking, ipv6, endianness

我正在编写一个程序，它使用 libpcap 嗅探 IPv6 数据包并通过 TCP/IP 将这些数据包发送到服务器。

由于 IP(v6) 数据包不是多字节数据，而是更像“一堆位”，我不使用任何编组（如 htons ...）。

奇怪的是，我将数据包输出到标准输出，它们看起来很好，但是当我通过网络传输它们时，它们都变得混乱了。我使用 netcat 来确保我的服务器没有问题。一个数据包正确到达，而另一个数据包具有不同的字节顺序。任何想法为什么？

编辑：好的，所以很棒的“不”是对的，我被 hexdump 愚弄了。'hexdump -c' 显示正确的输出。然而，我的程序的服务器部分（老实说，它并没有像发送者/客户端那样受到喜爱，我将在此处发布代码之前重写它）有时会进行 2 次读取并获取正确的数据，并且大部分时间一下子搞定了一切，弄乱了顺序。

（发送）代码：

```
struct pb_elem {
    size_t size;
    u_char *data;
};
-------------------------    

int send_all(int sockfd, packet_buf pbuf) {
int res = 0, n, i;
uint offset = 0, byteleft = 0;
struct pb_elem *packet;

res = packet_buf_dequeue(pbuf, &packet);
while (res == 0) {
    byteleft = packet->size;
    offset = 0;

    /* DEBUG */ fprintf(stderr, "DEBUG: send new packet\n");
    printf("DEBUG: Data size: %zu\n", packet->size);
    for (i=0; i < packet->size; i++) {
        printf(((i % 2 == 1) ? "%02X " : "%02X"), (unsigned int)*(packet->data+i));
    }
    printf("\n");

    do {
        n = send(sockfd, packet->data+offset, byteleft, 0);
        if (n == -1)
            break;
        offset = n;
        byteleft -= n;
        /* DEBUG */ fprintf(stderr, "DEBUG: send: offset: %u, byteleft: %u\n", offset, byteleft);
    } while (byteleft > 0);

    if (n == -1)
        fprintf(stderr, "Error: could not send whole packet.");

    free(packet->data);
    free(packet);

    res = packet_buf_dequeue(pbuf, &packet);
}

return 0;
} 
```

嗅探器 prog（发送方）的示例输出（2 个 ICMPv6 数据包）：

```
IPv6Buffer started
DATA:
0800 277B 1EBD 0A00 2700 0001 86DD 6000 0000 0035 3A40 2001 0DB8 BBBB 0000 0000 0000 0000 0001 2001 0DB8 BBBB 0000 0000 0000 0000 0102 8000 160B 116F 0001 09BD B450 0000 0000 DD2A 0500 0000 0000 CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CA
DATA:
0800 277B 1EBD 0A00 2700 0001 86DD 6000 0000 0035 3A40 2001 0DB8 BBBB 0000 0000 0000 0000 0001 2001 0DB8 BBBB 0000 0000 0000 0000 0102 8000 3E08 116F 0002 0ABD B450 0000 0000 B42C 0500 0000 0000 CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CA
DEBUG: start_sending
DEBUG: Data size: 107
0800 277B 1EBD 0A00 2700 0001 86DD 6000 0000 0035 3A40 2001 0DB8 BBBB 0000 0000 0000 0000 0001 2001 0DB8 BBBB 0000 0000 0000 0000 0102 8000 160B 116F 0001 09BD B450 0000 0000 DD2A 0500 0000 0000 CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CA
DEBUG: Data size: 107
0800 277B 1EBD 0A00 2700 0001 86DD 6000 0000 0035 3A40 2001 0DB8 BBBB 0000 0000 0000 0000 0001 2001 0DB8 BBBB 0000 0000 0000 0000 0102 8000 3E08 116F 0002 0ABD B450 0000 0000 B42C 0500 0000 0000 CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CA 
```

我通过服务器/接收器程序收到的内容：

```
IPv6Buffer started
DEBUG: start_receiving()
DEBUG: pre-accept in receive_data()
Data size: 214
0800 277B 1EBD 0A00 2700 0001 86DD 6000 0000 0035 3A40 2001 0DB8 BBBB 0000 0000 
0000 0000 0001 2001 0DB8 BBBB 0000 0000 0000 0000 0102 8000 2598 1280 0001 B3C8 
B450 0000 0000 2381 0400 0000 0000 CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE CAFE 
CAFE CAFE CAFE CAFE CAFE CA08 0027 7B1E BD0A 0027 0000 0186 DD60 0000 0000 353A 
4020 010D B8BB BB00 0000 0000 0000 0000 0120 010D B8BB BB00 0000 0000 0000 0001 
0280 007A 9712 8000 02B4 C8B4 5000 0000 00CD 8004 0000 0000 00CA FECA FECA FECA 
FECA FECA FECA FECA FECA FECA FECA FECA FECA FECA FECA 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:26:51.240

虽然我不完全确定为什么改变了字节顺序，但我确实有一个修复。

我刚刚实现了一个简单的接收端版本，试图接收尽可能多的数据，以适应 MTU 大小的缓冲区。通常两个数据包都会被读取并放在一起。

Now that I have implemented a primitive "protocol" telling my receiver the size of the packet and thus receiving them separate, they do arrive in order.

# c++ - MFC C++ LINK 2019：未解析的外部符号“public：__thiscall

> ID：13585447
> 
> 赞同：0
> 
> 时间：2012-11-27T13:36:30.060
> 
> 标签：c++, mfc, linker

VC2012，我有很多项目的解决方案。
我制作了一个“通用”项目，其中包含要从另一个项目中使用的类（用于通用目的）。
在“Common”下，我添加了一个名为

> “先决条件管理器” (cpp+h)

和接口

> （先决条件接口）。

在“客户”项目上（添加为“普通”项目的依赖项）我有课

> 客户端Dlg

. 根据需要添加了接口并添加了类型的成员

> '先决条件管理器'

.

> ClientDlg.h 包括“PreRequisitesManager.h”
> PreRequisitesManager 包括 PreRequisitesInterface.h。

我得到这个：

> GetCVClientDlg.obj：错误 LNK2019：未解析的外部符号“公共：__thiscall CPreRequisitesManager::~CPreRequisitesManager(void)”(??1CPreRequisitesManager@@QAE@XZ) 在函数 __unwindfunclet$??0CGetCVClientDlg@@QAE@PAVCWnd@@@Z 中引用$0 GetCVClientDlg.obj：错误 LNK2019：未解析的外部符号“public：__thiscall CPreRequisitesManager::CPreRequisitesManager(void)”(??0CPreRequisitesManager@@QAE@XZ) 在函数“public: __thiscall CGetCVClientDlg::CGetCVClientDlg(class CWnd *)”中引用(??0CGetCVClientDlg@@QAE@PAVCWnd@@@Z) 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:49:15.453

固定的。

问题是项目被编译为 EXE 而不是 DLL。

感谢帮助。

# c# - 如何识别哪个用户初始化或创建了会话变量？

> ID：13585455
> 
> 赞同：0
> 
> 时间：2012-11-27T13:36:53.170
> 
> 标签：c#, asp.net, session, session-variables

我正在创建一个示例项目，并且在使用用户名和密码进行正确身份验证后初始化了一个 Session 变量，因此只有一个经过身份验证的用户可以创建/初始化该 Session 变量。我需要向创建该会话变量的用户显示一条消息，例如“欢迎管理员”。

我如何识别该特定用户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:49:17.147

**You can try this :**

```
 //check particular session exist

    if (Session["loginName"] != null && Session["loginName"] == "yourAdminName")
    {
        //Give a welcome message for the user
    } 
```

You can get **very good knowledge about Session** using **[This Article](http://www.codeproject.com/Articles/32545/Exploring-Session-in-ASP-Net)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:43:03.863

我认为您可以使用[loginstatus.loginview](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.loginview%28v=vs.100%29.aspx)来显示欢迎消息 - 此时，您可以创建一个会话来“跟踪”或您想做的任何事情。

> ```
> <%@ Page Language="C#" %>
> <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
> 
> <script runat="server">
> </script>
> 
> <html xmlns="http://www.w3.org/1999/xhtml" >
>     <head runat="server">
>     <title>ASP.NET Example</title>
> </head>
> <body>
>         <form id="form1" runat="server">
>             <p>
>                 <asp:LoginStatus id="LoginStatus1" runat="server"></asp:LoginStatus></p>
>             <p>
>                 <asp:LoginView id="LoginView1" runat="server">
>                     <AnonymousTemplate>
>                         Please log in for personalized information.
>                     </AnonymousTemplate>
>                     <LoggedInTemplate>
>                         Thanks for logging in 
>                         <asp:LoginName id="LoginName1" runat="Server"></asp:LoginName>.
>                     </LoggedInTemplate>
>                     <RoleGroups>
>                         <asp:RoleGroup Roles="Admin">
>                             <ContentTemplate>
>                                 <asp:LoginName id="LoginName2" runat="Server"></asp:LoginName>, you
>                                 are logged in as an administrator.
>                             </ContentTemplate>
>                         </asp:RoleGroup>
>                     </RoleGroups>
>                 </asp:LoginView></p>
>         </form>
>     </body>
> </html> 
> ```

# c# - 共享密钥签名

> ID：13585456
> 
> 赞同：0
> 
> 时间：2012-11-27T13:36:56.280
> 
> 标签：c#, .net, encryption, digital-signature, encryption-symmetric

我知道加密签名的大多数用途都是使用公钥/私钥，但我需要使用预共享密钥对信息进行签名。我知道我可以加密数据，但我更喜欢签名..

在 C# 中可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:53:21.497

[HMAC](http://en.wikipedia.org/wiki/Hash-based_message_authentication_code)是常用的共享密钥签名算法，在 c# 中是可行的

[如何在 C# 中生成 HMAC-SHA1？](https://stackoverflow.com/questions/6067751/how-to-generate-hmac-sha1-in-c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:49:53.003

有很多方案（涉及 HMAC）使用对称（预共享）密钥材料执行消息签名。

可能重复：

[使用对称密钥 (AES -128) 对消息进行签名和验证](https://stackoverflow.com/questions/8299768/using-symmetric-key-aes-128-to-sign-and-verify-a-message)

# sql - SQL树向下遍历到根并备份一个

> ID：13585460
> 
> 赞同：4
> 
> 时间：2012-11-27T13:37:19.853
> 
> 标签：sql, sql-server-2008, recursion, tree-traversal

我有下表（ObjectStates）并且想要获取根以及根的第一个孩子：

```
ID    Title    ParentID
1     Draft    null
2     Green    null
3     Red      null
4     Foo      1
5     Bar      4
6     Some1    1
7     Some2    6
8     XYZ      2
9     Some3    7 
```

我想要以下输出：

```
GetState(5)
-- returns root: 1, first-child: 4
GetState(6)
-- returns root: 1, first-child: 6
GetState(7)
-- returns root: 1, first-child: 6
GetState(9)
-- returns root: 1, first-child: 6
GetState(8)
-- returns root: 2, first-child: 8 
```

所以无论我查询的层次结构有多深——我总是想要根元素以及第一个子元素。如果你考虑这棵树，我总是想要红色和蓝色元素，不管我在树里有多深。

![在此处输入图像描述](../Images/2925fba9dc024e450958c574654be89f.png)

我可以像这样获得“根”状态：

```
WITH CTEHierarchy
AS (
    SELECT 
    ID
        ,0 AS LEVEL
        ,ID AS root

    FROM ObjectStates
    WHERE  ParentID IS NULL

    UNION ALL

    SELECT 
    ObjectStates.ID
        ,LEVEL + 1 AS LEVEL
        ,[root]

    FROM ObjectStates
    INNER JOIN CTEHierarchy uh ON uh.id = ObjectStates.ParentID
    )    
    SELECT [root]
    FROM CTEHierarchy
    WHERE ID = @ObjectStateID 
```

这给了我我想要的根结果：

```
GetState(5)
-- returns root: 1
GetState(9)
-- returns root: 1
GetState(2)
-- returns root: 2 
```

我怎样才能从那里穿越？那么从根获取树中的下一个孩子？或者反过来 - 获取根以及第一级。递归让我头疼。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:36:47.470

我认为你需要先走上层级，然后获得前两个级别：

```
WITH cteHierarchy As
(
   SELECT
      ID,
      ParentID,
      0 As Level
   FROM
      ObjectStates
   WHERE
      ID = @ObjectStateID

   UNION ALL

   SELECT
      OS.ID,
      OS.ParentID,
      H.Level + 1
   FROM
      cteHierarchy As H
      INNER JOIN ObjectStates As OS
      ON H.ParentID = OS.ID
),
cteReveresedHierarchy As
(
   SELECT
      ID,
      ROW_NUMBER() OVER (ORDER BY Level DESC) As RowNumber
   FROM
      cteHierarchy
)
SELECT
   ID
FROM
   cteReveresedHierarchy
WHERE
   RowNumber In (1, 2)
; 
```

**编辑**
*要在一行中获取两个项目：*

如果您可以保证您永远不会从根目录开始，您可以将过滤器更改为`WHERE RowNumber = 2`，并包含该`ParentID`列。但是，如果您从根开始，则只有一行，因此该查询将不起作用。

要允许查询从根开始，您需要取第 2 行（如果存在），否则取第 1 行：

```
WITH cteHierarchy As
(
   SELECT
      ID,
      ParentID,
      0 As Level
   FROM
      ObjectStates
   WHERE
      ID = @ObjectStateID

   UNION ALL

   SELECT
      OS.ID,
      OS.ParentID,
      H.Level + 1
   FROM
      cteHierarchy As H
      INNER JOIN ObjectStates As OS
      ON H.ParentID = OS.ID
),
cteReveresedHierarchy As
(
   SELECT
      ID,
      ParentID,
      ROW_NUMBER() OVER (ORDER BY Level DESC) As RowNumber
   FROM
      cteHierarchy
)
SELECT TOP 1
   ParentID As [root]
   ID As [FirstChild]
FROM
   cteReveresedHierarchy
WHERE
   RowNumber In (1, 2)
ORDER BY
   RowNumber DESC
; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T14:38:50.953

我今天正在玩这个查询来遍历主键外键关系以跟踪整个路径，这个问题似乎很相似。所以只需粘贴相同的代码。您可以直接运行此代码并检查这是否是您所需要的。

该查询在 CTE 中增加了两列，即 Hops 和 Path，其中 Hops 是元素的级别，Path 是从头到尾遍历的节点。

```
WITH cte
AS
(
    SELECT 
        fk.create_date
        , fk.modify_date
        , fkc.constraint_object_id AS ConstraintId
        , OBJECT_NAME(fkc.constraint_object_id) AS ConstraintName
        , OBJECT_NAME(fkc.referenced_object_id) AS PrimaryKeyTableName
        , rc.name AS PrimaryKeyColumnName
        , OBJECT_NAME(fk.parent_object_id) AS ForeignKeyTableName
        , lc.name AS ForeignKeyColumnName
    FROM sys.foreign_key_columns fkc
    INNER JOIN sys.columns rc 
        ON  rc.OBJECT_ID = fkc.referenced_object_id 
        AND fkc.referenced_column_id = rc.column_id
    INNER JOIN sys.foreign_keys fk 
        ON  fk.OBJECT_ID = fkc.constraint_object_id
    INNER JOIN sys.columns lc 
        ON  lc.OBJECT_ID = fk.parent_object_id
        AND fkc.parent_column_id = lc.column_id
)
, cte2(create_date, modify_date, ConstraintName
        , PrimaryKeyTableName, PrimaryKeyColumnName
        , ForeignKeyTableName, ForeignKeyColumnName
        , Hops, path ) AS 
    (
        SELECT
            create_date, modify_date, ConstraintName
            , PrimaryKeyTableName, PrimaryKeyColumnName
            , ForeignKeyTableName, ForeignKeyColumnName 
            , 1 , CAST(QUOTENAME(PrimaryKeyTableName + '.' + PrimaryKeyColumnName) AS VARCHAR(4000))
        FROM cte
    UNION ALL
        SELECT 
            cte.create_date, cte.modify_date, cte.ConstraintName
            , cte.PrimaryKeyTableName, cte.PrimaryKeyColumnName
            , cte.ForeignKeyTableName, cte.ForeignKeyColumnName
            , cte2.Hops +1, CAST(cte2.path + '-> ' +QUOTENAME(cte.PrimaryKeyTableName+ '.' + cte.PrimaryKeyColumnName) AS VARCHAR(4000))
        FROM cte2 INNER JOIN cte ON cte2.ForeignKeyTableName = cte.PrimaryKeyTableName
        AND cte2.ForeignKeyColumnName != cte.PrimaryKeyColumnName
    )
SELECT 
ConstraintName
        , PrimaryKeyTableName, PrimaryKeyColumnName
        , ForeignKeyTableName, ForeignKeyColumnName
        , Hops, path + '-> ' + QUOTENAME(ForeignKeyTableName + '.' + ForeignKeyColumnName) AS Path
FROM cte2 
```

**仅当外键约束物理存在于数据库中时，此查询才有效。**

# c# - GDI+ 中出现一般错误。尝试将图片框图像保存在磁盘上时

> ID：13585465
> 
> 赞同：0
> 
> 时间：2012-11-27T13:37:26.923
> 
> 标签：c#, .net, gdi+

> **可能重复：**
> [GDI+ 一般错误](https://stackoverflow.com/questions/8295766/gdi-generic-error)

我正在编写一个数据库应用程序并使用“sdf”文件作为数据库。我通过以下代码将图像转换为字节数组，将图像保存在数据库中：

```
byte[] ReadFile(string sPath)
    {

        //Initialize byte array with a null value initially.
        byte[] data = null;

        //Use FileInfo object to get file size.
        FileInfo fInfo = new FileInfo(sPath);
        long numBytes = fInfo.Length;

        //Open FileStream to read file
        FileStream fStream = new FileStream(sPath, FileMode.Open, FileAccess.Read);

        //Use BinaryReader to read file stream into byte array.
        BinaryReader br = new BinaryReader(fStream);

        //When you use BinaryReader, you need to supply number of bytes to read from file.
        //In this case we want to read entire file. So supplying total number of bytes.
        data = br.ReadBytes((int)numBytes);
        return data;
    } 
```

并将其插入数据库。

我通过此代码检索图像：

```
public static Image CreateImage(byte[] imageData)
    {
        Image image=null;
        if(imageData !=null)
        {
            using (MemoryStream inStream = new MemoryStream())
            {
                  inStream.Write(imageData, 0, imageData.Length);

                  image = Bitmap.FromStream(inStream);
            }
        }

        return image;
    } 
```

并将图片框图像分配给 CreateImage 返回值。

直到这里一切都很好但是当我想在磁盘上存储图片框图像时

```
 Bpicture.Image.Save(@"pic1.jpeg", ImageFormat.Jpeg); 
```

发生此错误：

```
An unhandled exception of type 'System.Runtime.InteropServices.ExternalException' occurred in System.Drawing.dll

Additional information: A generic error occurred in GDI+. 
```

当我从磁盘而不是数据库加载图像时，也不会发生此错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:45:34.923

尝试修改您的代码：

```
inStream.Write(imageData, 0, imageData.Length);
inStream.Seek(0, SeekOrigin.Begin);
image = Bitmap.FromStream(inStream); 
```

stream 是一个特定的结构，它有一个需要移动到开头的指针才能读取刚刚写入它的数组。

# ckeditor - Ajax 调用后 CKEditor 不工作

> ID：13585467
> 
> 赞同：1
> 
> 时间：2012-11-27T13:37:34.420
> 
> 标签：ckeditor

我使用 CKEditor 作为所见即所得的编辑器。我的页面上有一些通过 Ajax 调用加载的表单元素。当我填写所有数据，包括所见即所得编辑器，然后点击保存按钮时，什么都没有保存。提交也是通过 Ajax 调用完成的。

没有保存任何内容，因为 CKEditor 没有`textarea`正确更新原始文件。我找到了一个答案，说在提交**之前**执行以下操作：

```
for(var instanceName in CKEDITOR.instances) {
    console.log(instanceName);
    CKEDITOR.instances['element[1][content]'].updateElement();
} 
```

每次在我提交表单之前都会触发此操作。但是这段代码仍然没有用CKEditor拥有的内容更新真正的文本区域......

有人知道我该如何解决这个问题吗？

我正在使用最新的 CKEditor *(3.6.5, 2012 年 10 月 10 日发布)*。

## 编辑

`updateElement()`当我运行以下命令时，刚刚通过未定义的 Firefox 控制台注意到：

```
CKEDITOR.instances['element[1][content]'].updateElement(); 
```

但是当我运行它时，它确实返回一个对象：

```
CKEDITOR.instances['element[1][content]']; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-21T08:59:51.437

有替代解决方案，您可以在 ckeditor 中添加数据而无需编辑实例的值。

例如

在视图中的脚本部分：

```
<script>
$(function(){
    $("#editBasic").click(function(){
        url = "<?=$this->webroot?>derivedItineraries/getDetail/<?=$derived_itinerary_id?>";
        var div = '#basic_detail';
        var data = {id: 1};
        callajax(url, data, $(div));
        return false;
    });
});
</script> 
```

在 Ajax 调用函数中：

```
function callajax2(url, data, divname){
$.ajax({
        type : 'POST',
        url : url,
        dataType : 'text',
        data: data,

        success: function(data) {
            divname.text('');
            divname.append(data);
            divname.show(500);
            if (data.error === true)
                 divname.show(500);
        }
});
return false; 
```

}

在控制器页面中：

```
public function getDetail($id = null) {
    $this->request->onlyAllow('ajax');
       $this->viewClass = 'Json';

       $this->loadModel('Destination');

        $this->DerivedItinerary->recursive = -1;
        $derivedItineraries = $this->DerivedItinerary->findById($id);

        $destination_covered = $this->destination_covered($id);
        $destinations = $this->Destination->find('list');

        $arrData=array(
            'itinerary'=>$derivedItineraries,
            'destination_covered' => $destination_covered,
            'destinations' => $destinations
        );
        $this->set('data', $arrData);
        $this->render('derived_basic', 'ajax'); 
} 
```

视图中应该有文件，名为“ControllerName”/json/derived_basic.ctp

“derived_itineraries/json/derived_basic.ctp”中的文件内容：

```
<?php
 echo $this->Html->script('/ckeditor/ckeditor', false);
  echo $this->Form->create();
  echo $this->Form->input('inclusion', array('type'=>'textarea', 'class'=>'ckeditor', 'required'=>'true', 'div'=>'required', 'style'=>'width:200px;', 'value'=> "Test data"))."      </td></tr>";
  echo $this->Form->end();
 ?> 
```

试试看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:44:10.227

你的第一个代码很糟糕。为什么在同一个对象上调用方法时要使用循环？这个更好：

```
for(var instanceName in CKEDITOR.instances) {
    CKEDITOR.instances[ instanceName ].updateElement();
} 
```

如果仍有问题，请分享您用于创建编辑器的代码。也许您的文本区域与编辑器实例错误地关联。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-02T15:24:43.680

ajax之后可以使用`done()`and方法`then()`

```
$.ajax({
    type: "POST",
    url: url
}).done(function(data){
     $('#content').html(data);
}).then(function(){
     //create ckeditor
}); 
```

# reporting-services - 在 SSRS 中本地化参数标签

> ID：13585468
> 
> 赞同：1
> 
> 时间：2012-11-27T13:37:36.580
> 
> 标签：reporting-services

是否有可能本地化参数提示名称？

无论如何，是否有可能在参数设置中更改提示名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:23:42.970

不，恐怕这不可能直接在 SSRS 中实现。

但是，您可以使用本地化控件/标签在 .NET 中创建自己的 Web/Windows 应用程序，并使用 ReportViewer 控件嵌入 SSRS 报告。

然后，您可以使用 SSRS Web 服务与服务器上的报表对象进行交互，发现所需的参数，并在您的应用程序中创建您自己的参数区域。

*   [有关如何访问 Web 服务的详细信息](http://msdn.microsoft.com/en-us/library/aa337423%28v=sql.105%29.aspx)
*   [ReportViewer 控件文档](http://msdn.microsoft.com/en-us/library/ms251671%28v=vs.110%29.aspx)

# perl - 如何从 Perl 中的 HTML 页面上的链接中提取文本？

> ID：13585477
> 
> 赞同：1
> 
> 时间：2012-11-27T13:37:59.717
> 
> 标签：perl, html-parsing

我不是 Perl 专家，但我编写了一个 Perl 脚本来解析 HTML 页面并按所有`href`标签进行过滤：

输出如下图所示：

```
href="?Name">Name</a>
href="?Desc">Hourly Details</a>
href="/24x7/2012/11-November/">Data
href="./00:00:00/">00:00:00/</a>
href="./01:00:00/">01:00:00/</a>
href="./02:00:00/">02:00:00/</a>
href="./03:00:00/">03:00:00/</a>
href="./04:00:00/">04:00:00/</a>
href="./05:00:00/">05:00:00/</a>
href="./06:00:00/">06:00:00/</a>
href="./07:00:00/">07:00:00/</a>
href="./08:00:00/">08:00:00/</a>
href="./09:00:00/">09:00:00/</a>
href="./10:00:00/">10:00:00/</a>
href="./11:00:00/">11:00:00/</a>
href="./12:00:00/">12:00:00/</a>
href="./13:00:00/">13:00:00/</a>
href="./14:00:00/">14:00:00/</a>
href="./15:00:00/">15:00:00/</a>
href="./16:00:00/">16:00:00/</a>
href="./17:00:00/">17:00:00/</a>
href="./18:00:00/">18:00:00/</a>
href="./19:00:00/">19:00:00/</a>
href="./20:00:00/">20:00:00/</a>
href="./21:00:00/">21:00:00/</a>
href="./22:00:00/">22:00:00/</a>
href="./23:00:00/">23:00:00/</a> 
```

现在我想从“00:00:00”到“23:00:00”提取href标签中的值，同时排除其他值。结果值将被添加到具有 URL 的字符串中：

```
http://x.download.com/00:00:00
------URL------------/..href../
..............................
http://x.download.com/23:00:00 
```

但是，通过尝试以下代码：

```
foreach (@tag) {
    if (m/href/) {
        if ($_ =~ /"\/24/ && $_ =~ /"\/[0-9]/) {
            my $href  = $_;
            my $start = index($href, "\"");
            my $end   = rindex($href, "\"");
            my $link  = substr($href, $start + 1, $end - $start - 1);
            print "Follow: " . $url . $link . "\n";

        }
    }
} 
```

印刷：

```
Follow: http://x.download.com/24x7/2012/11-November/ 
```

我的正则表达式应该是什么才能实现所需的目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T13:44:39.903

这可以通过正则表达式非常简单地完成，如下面的程序所示。它查找紧随其后的一串数字或冒号`>`（因此查找元素的文本内容，而不是`href`像您那样查找属性值）并将该字符串捕获到`$1`.

但我更希望看到使用适当的 HTML 解析器从头到尾解决问题，例如 [`HTML::TreeBuilder`](https://metacpan.org/module/HTML%3a%3aTreeBuilder) or [`Mojo::DOM`](https://metacpan.org/module/Mojo%3a%3aDOM)。

```
use strict;
use warnings;

my @tag = <DATA>;

foreach (@tag) {
  next unless />([\d:]+)/;
  print "http://x.download.com/$1\n";
}

__DATA__
href="?Name">Name</a>
href="?Desc">Hourly Details</a>
href="/24x7/2012/11-November/">Data
href="./00:00:00/">00:00:00/</a>
href="./01:00:00/">01:00:00/</a>
href="./02:00:00/">02:00:00/</a>
href="./03:00:00/">03:00:00/</a>
href="./04:00:00/">04:00:00/</a>
href="./05:00:00/">05:00:00/</a>
href="./06:00:00/">06:00:00/</a>
href="./07:00:00/">07:00:00/</a>
href="./08:00:00/">08:00:00/</a>
href="./09:00:00/">09:00:00/</a>
href="./10:00:00/">10:00:00/</a> 
```

**输出**

```
http://x.download.com/00:00:00
http://x.download.com/01:00:00
http://x.download.com/02:00:00
http://x.download.com/03:00:00
http://x.download.com/04:00:00
http://x.download.com/05:00:00
http://x.download.com/06:00:00
http://x.download.com/07:00:00
http://x.download.com/08:00:00
http://x.download.com/09:00:00
http://x.download.com/10:00:00 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T13:54:50.740

你不想用正则表达式来做。您需要一个合适的 HTML 解析器，而正则表达式无法完成这项工作。

你是如何获取网页的？如果您使用的是 WWW::Mechanize，那么从您获取的页面中提取链接是一个方法调用，因为 WWW::Mechanize 会为您进行 HTML 解析。

```
use WWW::Mechanize;

my $mech = WWW::Mechanize->new();
$mech->get( $url );

my @links = $mech->links();
for my $link ( @links ) {
    say $link->text, ' -> ', $link->url; # Show the text and the URL
} 
```

您需要根据需要重新格式化，但这会给您一个想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T13:45:16.920

首先，我们需要指定一个正则表达式，它将把军事时间精确到秒。

```
my $regex 
    = qr{  # curly brackets instead of slashes
           # so that we can use literal slashes in expression

    "   # a quote
    \.  # a literal dot
    /   # a forward slash
    (   # begin capture group

       (?:              # begin uncaptured sub-group
           [01] \d      # a '0' or '1' followed by a digit
       |   2    [0-3]   # a '2' followed by 0-3
       )                # end grouping
       (?:         # begin repetition grouping
         :         # a literal colon               
         [0-5] \d  # digits 0-5 followed by any digit
       ){2}        # exactly twice
     )  # end capture

     /  # a forward slash
     "  # close quote
}x; # <- x-option allows annotated regex
... 
```

这等效于以下正则表达式：

```
my $regex = qr/"\.\/((?:[01]\d|2[0-3])(:[0-5]\d){2})\/"/; 
```

如果你的分和秒永远是'00:00'，那么表达式就更简单了：

```
my $regex = qr{"\./((?:[01]\d|2[0-3]):00:00)/"}; 
```

*然后，您可以通过在列表*上下文中进行匹配来测试*和检索值：*

 *```
if ( my ( $link ) = m/$regex/ ) { 
    say "http://x.download.com/$link";
} 
```

如果测试不匹配，`$link`将是未定义的。如果确实匹配，则将其声明为（一个）列表，匹配操作会将第一个捕获分配给变量。*

# c# - 确定按下的键是 Windows 运行时中的字母数字

> ID：13585478
> 
> 赞同：7
> 
> 时间：2012-11-27T13:38:05.317
> 
> 标签：c#, .net, windows-runtime

我正在为`Windows 8`.

我正在尝试确定按下的键是否是字母数字。该`KeyRoutedEventArgs`课程似乎没有提供任何帮助。

有什么我忽略的吗？确定用户输入的是字母还是数字的最佳方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T13:43:36.600

`KeyRoutedEventArgs`包含一个`Key`值，它是一个 VirtualKey 。

您可以简单地测试 是否在`Key`您希望从此[列表](http://msdn.microsoft.com/en-us/library/windows/desktop/dd375731%28v=vs.85%29.aspx)中支持的代码中。

例如：

```
private void MyKeyDown(object sender, KeyRoutedEventArgs e)
{
    int keyValue = (int)e.Key;
    if ((keyValue >= 0x30 && keyValue <= 0x39) // numbers
     || (keyValue >= 0x41 && keyValue <= 0x5A) // letters
     || (keyValue >= 0x60 && keyValue <= 0x69)) // numpad
    {
        // do something
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-02T20:38:54.790

这里有一个示例，用于检查按下的键是否非常适合电话号码（数字、空格、点和 +）：

```
 using Windows.System;
    ...
    bool isDigitKey(VirtualKey keyValue)
    {
        return ((keyValue >= VirtualKey.Number0 && keyValue <= VirtualKey.Number9)||
            (keyValue >= VirtualKey.NumberPad0 && keyValue <= VirtualKey.NumberPad9));
    }
    private void TextBoxTo_KeyDown(object sender, KeyRoutedEventArgs e)
    {
        // Characters for phone numbers (+, ., space, digits) 
            Boolean isCharFiltered = !isDigitKey(e.Key)        && // Digits
                                 (e.Key != VirtualKey.Space)   && // Space
                                 (e.Key != VirtualKey.Add)     && // + on NumPad
                                 ((int)e.Key != 0xbb)          && // + which is not correctly mapped to VirualKey.Add
                                 (e.Key != VirtualKey.Decimal) && // . on NumPad
                                 ((int)e.Key != 0xbe);            // . which is curiously mapped to Shift
        // Unfortunately, we can't filter à, é and è on a french keyboard because these keys are mapped to Number0, Number2 and Number7

       e.Handled = isCharFiltered;
    } 
```

# android - 加载屏幕后运行画廊 完成加载

> ID：13585486
> 
> 赞同：1
> 
> 时间：2012-11-27T13:38:40.590
> 
> 标签：android, image-gallery

我目前是 Android 新手。我见过很多情况，加载屏幕能够启动文件的下载。我想知道当加载屏幕完成处理其后台任务时，我如何在 postexecute() 命令上启动图库。以下是后台任务中的代码。我是想在这个背景中编写代码以供画廊在 postexecute() 上执行，还是有其他方法可以做到这一点。

PS 我的加载屏幕和图库位于不同的 java 文件中。那么有什么方法可以让画廊在 postexecute 命令的加载屏幕后立即运行？

谢谢

```
 //The code to be executed in a background thread.
            @Override
            protected String doInBackground(String... strings) 
            {
                /* This is just a code that delays the thread execution 4 times, 
                 * during 850 milliseconds and updates the current progress. This 
                 * is where the code that is going to be executed on a background
                 * thread must be placed. 
                 */
                try 
                {
                    //Get the current thread's token
                    synchronized (this) 
                    {
                        //Initialize an integer (that will act as a counter) to zero
                        int counter = 0;
                        //While the counter is smaller than four
                        while(counter <= 4)
                        {
                            //Wait 850 milliseconds
                            this.wait(850);
                            //Increment the counter 
                            counter++;
                            //Set the current progress. 
                            //This value is going to be passed to the onProgressUpdate() method.
                            publishProgress(counter*25);
                        }
                    }
                } 
                catch (InterruptedException e) 
                {
                    e.printStackTrace();
                }
                return null;
            }

            //Update the TextView and the progress at progress bar
            @Override
            protected void onProgressUpdate(Integer... values) 
            {
                //Update the progress at the UI if progress value is smaller than 100
                if(values[0] <= 100)
                {
                    tv_progress.setText("Progress: " + Integer.toString(values[0]) + "%");
                    pb_progressBar.setProgress(values[0]);
                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:12:55.327

是的你可以。只需从 PostExecute 启动图库。

```
 @Override
        protected void onPostExecute(Void...values) 
        {
            //get image path
            File file = <imageFilepath>;
             //add to intent
        Intent intent = new Intent(Intent.ACTION_VIEW);
            //start activity
        intent.setDataAndType(Uri.fromFile(file),"image/*");
            startActivity(intent);
        } 
```

# blackberry - 如何将图像存储在持久存储中

> ID：13585491
> 
> 赞同：1
> 
> 时间：2012-11-27T13:39:02.073
> 
> 标签：blackberry, persistent, persistent-storage

我正在开发具有“图像按钮”的 BlackBerry 应用程序。“图像按钮”可以在每次点击之间从“开”变为“关”，反之亦然。现在我要做的是，当应用程序关闭并再次加载时，这个“图像按钮”应该作为最后一个状态加载。如果“图像按钮”设置为“开”并且应用程序关闭，则在下次加载时它将加载为“开”。创建图像按钮时，如果该值设置为“true”，则图像加载为“ON”，即使它被创建为 off-on。我在构造函数之外创建了 ImageButton：

```
LabeledSwitch onImg=new LabeledSwitch(off,on,off,on,true); 
```

然后在构造函数中，我尝试检查最后一个图像状态，并相应地再次创建图像按钮。但是， (boolean)((Boolean) persistentHashtable.get("image")).booleanValue() 会抛出 CastException，即使它编译正常。

```
persistentObject = PersistentStore.getPersistentObject(KEY);

 if (persistentObject.getContents() == null) 
 {
    persistentHashtable = new Hashtable();
    persistentObject.setContents(persistentHashtable);
 } else {
    persistentHashtable = (Hashtable) persistentObject.getContents();
     }

  if (persistentHashtable.containsKey("image")) 
 {
     boolean booleanVal = (boolean)((Boolean) persistentHashtable.get("image")).booleanValue();
     if (booleanVal==true)
     {
         onImg=new LabeledSwitch(on,off,on,off,true);
     }
     else
     {
         onImg=new LabeledSwitch(off,on,off,on,false);
     }
 } 
```

我在退出时保存图像的状态：

```
public boolean onClose() 
    {
        int choose=Dialog.ask(Dialog.D_YES_NO, "Are you sure Want to Exit?");
        if(choose==Dialog.YES)
        {
            if(onImg._on)
             persistentHashtable.put("image", Boolean.TRUE);

            else
                persistentHashtable.put("image", Boolean.FALSE); 
            System.exit(0);

        }
        return true;
    } 
```

请指导。作为参考，下面是用于创建图像按钮的 LabeledSwitch 类：

```
import net.rim.device.api.system.*;
import net.rim.device.api.ui.*;

public class LabeledSwitch extends Field {
    private String _textOn;
    private String _textOff;

    private int _textWidth;
    private int _textHeight;

    private int _totalWidth;
    private int _totalHeight;

    private Bitmap _imageOn;
    private Bitmap _imageOnFocus;
    private Bitmap _imageOff;
    private Bitmap _imageOffFocus;

    public boolean _on; //chngd
    private boolean _selected;

    private Font _labelFont;

    private static MenuItem _changeOptionsItem = new ChangeOptionMenuItem();

    private int _textColour = 0x888888;
    private int _textColourFocus = 0x000000;

    private int _horizontalTextImageGap;

    private Bitmap _switchImage;  
    private String _labelText;  
    int mHeight;
    int mWidth;

    public LabeledSwitch(){}

    public LabeledSwitch( Bitmap imageOn
                , Bitmap imageOff
                , Bitmap imageOnFocus
                , Bitmap imageOffFocus
                , boolean onByDefault ) {
        super( Field.FIELD_VCENTER );

        //_textOn = textOn ="";
        //_textOff = textOff ="";

        _imageOn = imageOn;
        _imageOff = imageOff;
        _imageOnFocus = imageOnFocus;
        _imageOffFocus = imageOffFocus;
        _on = onByDefault; 
        _selected = false;

        _horizontalTextImageGap = _imageOn.getHeight() / 3;

    }

    public void applyFont() {
        _labelFont = getFont().derive( Font.PLAIN, _imageOn.getHeight()  );
    }

    /**
     * Change the state of the switch
     * @param on - if true, the switch will be set to on state
     */
    public void setOn(boolean on) {
        _on = on;
        invalidate();
    }

    public boolean getOnState() {
        return _on;
    }

    public boolean isFocusable() {
        return true;
    }

    public int getPreferredWidth() {
        return _totalWidth;
    }

    public int getPreferredHeight() {
        return _totalHeight;
    }

    protected void layout( int width, int height ) {
        // 
        _textWidth = Math.max( _labelFont.getAdvance( _textOn + "a" ), _labelFont.getAdvance( _textOff + "a" ) )-36;
        _textHeight = _labelFont.getHeight();

        _totalWidth = _imageOn.getWidth() + _horizontalTextImageGap + _textWidth;
        _totalHeight = _imageOn.getHeight();

        mWidth = getPreferredWidth();
        mHeight = getPreferredHeight();
        setExtent(mWidth, mHeight);

       // setExtent( _totalWidth, _totalHeight );
    }

    public void paint( Graphics g ){
        Font oldFont = g.getFont();
        int oldColor = g.getColor();

        try { 

            if( _on ) {
                _switchImage = g.isDrawingStyleSet(Graphics.DRAWSTYLE_FOCUS) ? _imageOnFocus : _imageOn;
            } else {
                _switchImage = g.isDrawingStyleSet(Graphics.DRAWSTYLE_FOCUS) ? _imageOffFocus : _imageOff;
            }

            g.setFont( _labelFont );

            // Determine Label Colour
            g.setColor( g.isDrawingStyleSet(Graphics.DRAWSTYLE_FOCUS) ? _textColourFocus : _textColour );

            // Label
            g.drawText( _on ? _textOn : _textOff, 0, ( getHeight() - _textHeight ) / 2, DrawStyle.RIGHT, _textWidth ); 

            // Image
            //g.drawBitmap( _textWidth + _horizontalTextImageGap, 0, _switchImage.getWidth(), _switchImage.getHeight(), _switchImage, 0, 0 );
            g.drawBitmap(0, 5, mWidth, mHeight, _switchImage, 0, 0);
        } finally {
            g.setFont( oldFont );
            g.setColor( oldColor );
        }
    }

    public void paintBackground( Graphics g ) {}

    protected void drawFocus( Graphics g, boolean on ){
        // Paint() handles it all
        g.setDrawingStyle( Graphics.DRAWSTYLE_FOCUS, true );
        paint( g );
    }

    protected boolean keyChar( char key, int status, int time ){
        if( key == Characters.SPACE || key == Characters.ENTER ) {
            toggle();            
            return true;
        }
        return false;
    }

    protected boolean navigationClick(int status, int time){
        toggle();            
        return true;    
    }

    protected boolean invokeAction(int action){
        switch( action ) {
            case ACTION_INVOKE: {
                toggle(); 
                return true;
            }
        }
        return super.invokeAction( action );
    }

    protected boolean trackwheelClick( int status, int time ){        
        if( isEditable() ) {
            toggle();            
            return true;
        }
        return super.trackwheelClick(status, time);
    }

    /**
     * Toggles the state of the switch
     */
    private void toggle(){
        _on = !_on;
        invalidate();
        fieldChangeNotify( 0 );
    }

    public void setDirty( boolean dirty ){
        // We never want to be dirty or muddy
    }

    public void setMuddy( boolean muddy ){
        // We never want to be dirty or muddy
    }    

    protected void makeContextMenu(ContextMenu contextMenu){
        super.makeContextMenu(contextMenu);
        if((Ui.getMode() < Ui.MODE_ADVANCED) && isEditable()) {
            contextMenu.addItem(_changeOptionsItem);
        }
    }

    /**
     * @category Internal InnerClass
     */
    static class ChangeOptionMenuItem extends MenuItem {
        ChangeOptionMenuItem() {
            super("Toggle", 30270, 10);
        }

        ChangeOptionMenuItem(String text) {
            super(text, 30270, 10);
        }

        public void run() {
            LabeledSwitch theSwitch = (LabeledSwitch)getTarget();
            theSwitch.toggle();
        }

        public int getPriority() {
            return 100 + (getTarget().isMuddy() ? 1000 : 0);
        }
    };
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T08:28:31.380

所以，我认为这里可能存在多个问题。我确实认为 Eugen 对这个`commit()`电话的看法是正确的。

但是，我认为`LabeledSwitch`该类的使用不正确。我猜你没有写那门课？我之所以这么说，是因为我在这一类中看到了多种编码约定。

看过多个这样的自定义 BlackBerry UI 类后，我相信这是该类应该工作的方式：

1.  该类可以在两种视觉状态之间切换，您可以通过向该类传递一个表示**开启**状态和**关闭**状态的 PNG 图像来定义这种状态。

2.  可以通过调用`setOn()`方法在这些状态之间切换类，参数为 a`true`或`false`值。该参数的值将决定在类的自定义`paint()`方法中绘制哪个 PNG 文件

3.  该类的原作者打算让您使用`setOn()`和`getOnState()`方法来修改和访问开关的当前状态。你应该改变这个

```
public boolean _on; 
```

对此：

```
private boolean _on; 
```

如果您想知道开关是否打开，请询问`onImg.getOnState()`。

顺便说一句，我会为您的交换机推荐一个不同于`onImg`. 这是一个非常混乱的名字。如果开关用于关闭和打开名为*foo*的东西，它应该类似于`onOffSwitch`, or `toggleSwitch`, or 。在成员变量的上下文中命名它是令人困惑的，它应该**始终**表示在开关打开时显示的**图像**。`fooSwitch`*`onImg``_imageOn`*

 *****所以，总结一下，而不是这样：

```
 if (booleanVal==true)
 {
     onImg=new LabeledSwitch(on,off,on,off,true);
 }
 else
 {
     onImg=new LabeledSwitch(off,on,off,on,false);
 } 
```

使用这样的东西：

```
 onOffSwitch = new LabeledSwitch(on, off, on, off, true);
 onOffSwitch.setOn(booleanValue); 
```

或者

```
 onOffSwitch = new LabeledSwitch(on, off, on, off, booleanValue); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T06:58:36.207

首先，我没有看到存储持久对象所需的以下代码：

```
persistentObject.commit(); 
```

我希望这只是您代码中的几个额外内容，否则您总是在阅读之前重写值，这可能不是预期的。所以'读'代码不应该留在'写'之后，因为它没有任何意义。*****

# sharepoint - 如何在 Sharepoint 上创建表单

> ID：13585493
> 
> 赞同：1
> 
> 时间：2012-11-27T13:39:09.653
> 
> 标签：sharepoint

再详细一点。我是 Sharepoint 的菜鸟，今天获得了访问权限，我正在玩，我将它用作项目的存储站点，使用日历来管理演示请求等。

我希望用户（销售团队）能够填写表格，其中包含以下问题：请求演示的日期是什么时候，需要什么硬件，什么日期？（因此需要知道如何创建一个）。然后，当填写并提交表格并在可能的情况下得到我的批准时，会在日历中输入一个条目，并通知所有销售团队成员已输入一个条目

我已经预订了一个共享点课程，但需要几个月的时间......

任何帮助都会很棒...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T15:01:00.980

该表单只是一个添加了自定义列的列表。该列表可以基于任务列表（将允许 Outlook 集成和警报 [电子邮件] 分配给谁）或自定义列表。

可以通过为销售团队设置警报通知来处理日历条目的销售团队通知。

至于表单（项目）被批准并创建日历条目，您将需要编写自定义解决方案（列表项目事件处理程序）或手动执行此操作。

我的建议是使用不同的列表和 OOB 自定义来确定最适合您的需求。

# codeigniter-2 - Codeigniter Ajax表单提交和ajax检索表中的数据

> ID：13585495
> 
> 赞同：1
> 
> 时间：2012-11-27T13:39:13.617
> 
> 标签：codeigniter-2

在codeigniter中是否有任何完整的示例，我可以通过ajax提交表单，同时也可以通过ajax从数据库获取值到表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:42:50.790

无论您使用什么框架，ajax 的工作方式都差不多，逻辑是一样的。您应该首先完整地学习ajax，然后您可以在任何框架中使用它。

如果你会开车，你就可以开任何车。

这是带有 codeigniter 的 ajax 示例

[http://www.ibm.com/developerworks/web/library/wa-aj-codeigniter/](http://www.ibm.com/developerworks/web/library/wa-aj-codeigniter/)

希望这可以帮助

# android - 在运行时更改形状边框颜色

> ID：13585496
> 
> 赞同：29
> 
> 时间：2012-11-27T13:39:13.970
> 
> 标签：android, xml-drawable

我的可绘制文件夹中有这个形状：

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">
    <corners android:radius="5dp" />
    <solid android:color="#ffffff" />
    <stroke android:width="2dp" android:color="#B5B5B5"/>
</shape> 
```

这定义了一个带圆角的矩形，我可以将它作为背景应用到任何面板，如下所示：**android:background="@drawable/round_corner_shape"**。

问题来了：我的应用程序上有几个面板，形状与背景相同，但对于每个形状，我想要不同的边框（笔触）颜色。我不想创建 3 个形状，唯一的区别是笔触颜色。**是否可以在运行时更改笔画值？**

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-23T18:34:33.367

我有同样的问题。就我而言，我有一个 GridView，网格中的项目可以在运行时由用户更改边框颜色。

因此，在该网格的 gridviewAdapter 中，我在 getView 方法（为适配器生成视图的方法）中执行了以下操作

```
public View getView(int position, View convertView, ViewGroup parent) {
    LayoutInflater inflater = (LayoutInflater) mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    convertView = inflater.inflate(R.layout.griditem, null);
    GradientDrawable gradientDrawable = (GradientDrawable) convertView.getBackground(); 

    gradientDrawable.setStroke(2, mColor); 
    convertView.invalidate();
    return convertView;
} 
```

mColor 是一个表示颜色的 int，就像我们在 xml 文件中所做的那样。在 java 代码中，我们使用“0x”而不是“#”来以 AARRGGBB 格式定义它。例如，使用 0xFF000000 表示 100% 不透明的黑色，使用 0xFF0000FF 表示 100% 不透明的蓝色。在这里解释这一点，因为谷歌 api '有帮助'告诉 int 颜色是“笔画的颜色”。

这解决了我的问题......我想你可以为你的情况尝试类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:50:35.780

嗨，您可以尝试在运行时创建背景，然后您可以随时更改它。

```
RoundRectShape rect = new RoundRectShape(
  new float[] {30,30, 30,30, 30,30, 30,30},
  null,
  null);
ShapeDrawable bg = new ShapeDrawable(rect);
bg.getPaint().setColor(0x99FFFFFF);
view.setBackgroundDrawable(bg); 
```

# django - Django模型完整性错误

> ID：13585501
> 
> 赞同：0
> 
> 时间：2012-11-27T13:39:39.727
> 
> 标签：django, django-models, relationship, integrity

```
class Subscribers(User):
    date = models.DateField()
    user = models.OneToOneField(User)

class Tour(models.Model):
    """ This is not the id is a User object
    """
    owner_id = models.ForeignKey(User)
    name = models.CharField(max_length=50, primary_key=True)
    location = models.ManyToManyField(Location)
    subscribers = models.ManyToManyField(Subscribers, related_name="sub") 
```

我正在尝试使用以下方法测试一种方法：

```
def test_get_subsribers(self):
    user1= User.objects.create_user('Maria','j@j.com','j1')
    user4= User.objects.create_user('Giannis','m@m.com','m1')
    sub= Subscribers()
    sub.user = user4
    tour = Tour()
    tour.owner_id = user1
    tour.name = "Open Day"
    tour.subscribers.add(sub)
    self.assertEqual(get_subscribers("Open Day").count(),0) 
```

但我得到的是一个错误：

```
IntegrityError: insert or update on table "tour_tour_subscribers" violates foreign key constraint "tour_tour_subscribers_subscribers_id_fkey"
DETAIL:  Key (subscribers_id)=(10) is not present in table "tour_subscribers". 
```

我是 Django 的新手，我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:46:13.913

您尝试将未保存的订阅者添加到 Tour。

你需要先`sub.save()`打电话`tour.subscribers.add(sub)`

`tour`还必须在添加之前保存`sub`。

这样做的原因是处理多对多关系的附加表（[请参阅文档](https://docs.djangoproject.com/en/1.4/ref/models/fields/#id1)）。此表存储两个外键 - 一个 for`Tour`和一个 for `Subscribers`。要将一行保存到此表中，Tour 和 Subscriber 都应该存在于数据库中

# javascript - 在我的网站中更改 html DOCTYPE

> ID：13585505
> 
> 赞同：0
> 
> 时间：2012-11-27T13:39:55.763
> 
> 标签：javascript, html

在我的网站中，我从在 Internet 上找到的一个非常简单的免费版本模板开始。我开始在它之上建立一个完整的网站。

现在，当我想添加一个名为“范围”的 INPUT（如果你知道我的意思的话，就像滑块一样），IE 浏览器会像文本框一样解释它。我现在检查并了解并非所有浏览器都支持范围输入...

另外我发现网站的模板有一个旧版HTML的DOCTYPE...

它看起来像这样：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"> 
```

当我尝试将其更改为：

```
<!DOCTYPE html> 
```

或者

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"> 
```

我的起始页看起来不太好，因为我在其中写了一个代码，用箭头表示流程图，而箭头的代码不适用于这些 DOCTYPE...

箭头代码：

```
<script> 
            function draw_arrow(context, startX, startY, size) 
            { 
                var arrowX = startX - 0.75*size; 
                var arrowTopY = startY - 0.707*(0.25*size);  
                var arrowBottomY = startY + 0.707*(0.25*size); 
                context.moveTo(startY, startX);
                context.lineTo(startY-size, startY); 
                context.lineTo(arrowX, arrowTopY); 
                context.moveTo(startY-size, startY); 
                context.lineTo(arrowX, arrowBottomY); 
                context.stroke(); 
            } 
            window.onload = function(){ 
                var canvas = document.getElementById("myCanvas"); 
                var context = canvas.getContext("2d"); 
                var startX = 100;  
                var startY = 100;  
                var size   = 100; 
                context.lineWidth = 4; 
                draw_arrow(context, startX, startY, size); 
                var canvas = document.getElementById("myCanvas2"); 
                var context = canvas.getContext("2d"); 
                var startX = 100;  
                var startY = 100;  
                var size   = 100; 
                context.lineWidth = 4; 
                draw_arrow(context, startX, startY, size); 
            }; 
        </script> 
```

我可以用 DOCTYPE 标题做什么，以便箭头的图表和 INPUT 范围看起来不错？或者如何更改我的网站以支持高版本的 HTML 而不会损坏网站...？

谢谢...

# java - 在Java中没有循环的情况下迭代特定目录中的文件

> ID：13585507
> 
> 赞同：0
> 
> 时间：2012-11-27T13:40:00.147
> 
> 标签：java, file, loops, iteration

迭代特定文件夹中的文件但没有循环的最佳方法是什么？即，当所有文件都被检查一次时，for 循环将结束。

我的示例代码（带循环）：

```
 File dir = new File(svnClient.getDestinationPath().getAbsolutePath());
          for (File child : dir.listFiles())
          {
            report.report("File name: " + child.getName());
          } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T13:46:37.773

递归：

```
public void myMethod(){
     File dir = ...;
     List<File> files = Arrays.asList(dir.listFiles());
     recurse(files.iterator());
}

private void recurse(Iterator<File> iterator){
     if (iterator.hasNext()){
          File file = iterator.next();
          report.report(file.getName());
          recurse(iterator);
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:44:59.200

滥用`listFiles(FileFilter filter)`方法，将您的逻辑放在回调中并忽略返回值。

```
File dir = ...
dir.listFiles(new FileFilter() {
    boolean accept(File child) {
        report.report("File name: " + child.getName());
        return false;
    }
}); 
```

# sql - 有没有比使用子查询更好的方法来编写这个 SQL SELECT 语句？

> ID：13585508
> 
> 赞同：2
> 
> 时间：2012-11-27T13:40:00.387
> 
> 标签：sql, oracle, select, subquery

我有这个查询：

```
SELECT A, B, C
FROM (  SELECT 
        lla.id as A,
        max(decode(lla.attrid, 2, lla.valstr, null)) as B, 
        max(decode(lla.attrid, 3, lla.valstr, null)) as C
    FROM 
        llattrdata lla, 
        llattrdata lla2
    WHERE 
        lla.id = lla2.id 
    GROUP BY lla.id)
WHERE C = "Yes" 
```

有一个更好的方法吗？我尝试使用 HAVING 子句，但无法使其对列 C="Yes" 起作用。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T13:55:52.063

我会让你进入一个秘密。你所拥有的没有任何问题。所以不要满足重写它的需要。

```
SELECT A, B, C
FROM (  SELECT 
        lla.id as A,
        max(decode(lla.attrid, 2, lla.valstr, null)) as B, 
        max(decode(lla.attrid, 3, lla.valstr, null)) as C
    FROM 
        llattrdata lla, 
        llattrdata lla2
    WHERE 
        lla.id = lla2.id 
    GROUP BY lla.id)
WHERE C = 'Yes' 
```

与以下性能相同：

```
SELECT 
    lla.id as A,
    max(decode(lla.attrid, 2, lla.valstr, null)) as B, 
    max(decode(lla.attrid, 3, lla.valstr, null)) as C
FROM 
    llattrdata lla, 
    llattrdata lla2
WHERE 
    lla.id = lla2.id 
GROUP BY lla.id
HAVING max(decode(lla.attrid, 3, lla.valstr, null)) = 'Yes'; 
```

通过避免此处的内联视图，您将不会获得任何性能。无论哪个对您来说更具可读性，请继续使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T13:42:56.877

怎么样

```
SELECT 
        lla.id as A,
        max(decode(lla.attrid, 2, lla.valstr, null)) as B, 
        'Yes' as C
    FROM 
        llattrdata lla, 
        llattrdata lla2
    WHERE 
        lla.id = lla2.id 
    GROUP BY lla.id
    HAVING max(decode(lla.attrid, 3, lla.valstr, null)) = 'Yes' 
```

您不能使用在同一查询中创建的别名。你必须再写一次

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T13:43:33.793

```
SELECT 
        lla.id as A,
        max(decode(lla.attrid, 2, lla.valstr, null)) as B, 
        max(decode(lla.attrid, 3, lla.valstr, null)) as C
    FROM 
        llattrdata lla, 
        llattrdata lla2
    WHERE 
        lla.id = lla2.id 
    GROUP BY lla.id
    HAVING max(decode(lla.attrid, 3, lla.valstr, null)) = "Yes" 
```

请阅读以下内容：[为什么我不能在 count(*)“列”中使用别名并在有子句中引用它？](https://stackoverflow.com/questions/2068682/why-cant-i-use-alias-in-a-count-column-and-reference-it-in-a-having-clause)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T13:43:18.333

使用[`HAVING`子句](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_10002.htm#i2078943)：

```
SELECT 
    lla.id as A,
    max(decode(lla.attrid, 2, lla.valstr, null)) as B, 
    max(decode(lla.attrid, 3, lla.valstr, null)) as C
FROM 
    llattrdata lla, 
    llattrdata lla2
WHERE 
    lla.id = lla2.id 
GROUP BY lla.id
HAVING max(decode(lla.attrid, 3, lla.valstr, null)) = 'Yes' 
```

该子句在 之后进行评估，`GROUP BY`用于过滤分组结果。

不幸的是，您不能在 having 子句中使用别名。在某些情况下，子查询的意图可能比 have 子句更清晰。

# java - Joda Time - 将日历对象转换为 LocalDate

> ID：13585512
> 
> 赞同：8
> 
> 时间：2012-11-27T13:40:06.800
> 
> 标签：java, datetime, timezone, jodatime

我有一个方法`getCalendarFromClass`可以返回一个`Calendar`.

我正在`LocalDate`使用方法将其转换为 Joda Time API `fromCalendarFields`。

```
LocalDate.fromCalendarFields(a.getCalendarFromClass()); 
```

但是如何指定`TimeZone`执行此转换的时间，因为我在 javadoc 中没有找到它。

方法的 javadoc`fromCalendarFields`提到：

*每个字段都从日历中查询并分配给 LocalDate。如果您一直使用日历作为本地日期，而忽略区域，这将非常有用。*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-27T13:56:26.870

1）获取时区：

```
TimeZone tz = calendar.getTimeZone(); 
```

2）从日历创建一个 Joda DateTime：

```
DateTimeZone jodaTz = DateTimeZone.forID(tz.getID());
DateTime dateTime = new DateTime(calendar.getTimeInMillis(), jodaTz); 
```

3) 获取本地日期

```
LocalDate localDate = dateTime.toLocalDate(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-27T13:42:41.377

有`Calendar`一个时区，`Calendar`当 Joda Time 请求不同的字段值时（由 ）使用。Joda Time 只是使用`calendar.get(Calendar.YEAR)`等。

从概念上讲，返回的`LocalDate`没有时区。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T13:43:10.370

LocalDate 看起来不像您想要的课程。从文档：

> LocalDate 是一个不可变的日期时间类，表示*没有* 时区的日期。

（我的重点）

# java - 无法启动 OSGi 包，缺少 com.ibm.uvm.tools

> ID：13585513
> 
> 赞同：4
> 
> 时间：2012-11-27T13:40:09.450
> 
> 标签：java, maven, osgi, maven-bundle-plugin, osgi-bundle

我正在尝试启动一个包含大量依赖项的捆绑包。我收到错误消息`could not be resolved. Reason: Missing Constraint: Import-Package: com.ibm.uvm.tools`，但在 maven 存储库或网络上找不到这个包。通过在 Import-Package 指令中标记这个包（和一堆其他包）为可选，我可以解析包，但如果不满足依赖项，它将无法启动。我能做些什么来解决这个导入包？

我正在使用 maven-bundle-plugin 来生成包。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T13:31:00.773

解决方案是使用 OSGified 版本的 log4j 作为提供的依赖项。我把它作为一个编译的依赖项。Log4j manifest 提到这个包是一个可选的依赖，所以 maven-bundle-plugin 将它添加到我的包的清单中，但没有使它成为可选的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T17:35:03.747

您已经在类路径上使用几个 jar 构建了您的包。否则，您的包将不会引用名为`com.ibm.uvm.tools`. 现在您需要查看此 jar 是否支持 OSGi（指定正确的标头和包导出）。也许还存在该 jar 的“OSGi-fied”版本，例如查看[springsource 存储库](http://ebr.springsource.com/repository/app/)。

查看包名称，我假设可能无法在任何公共存储库中重新包装的专有代码，然后您可以尝试自己将其包装为一个包，看看[这个 stackoverflow 问题](https://stackoverflow.com/questions/1340483/osgi-handling-3rd-party-jars-required-by-a-bundle)。

# .net - abcpdf7 生成的 pdf 在移动设备上看起来很糟糕 - 湿漆效果

> ID：13585514
> 
> 赞同：2
> 
> 时间：2012-11-27T13:40:15.187
> 
> 标签：.net, pdf, sharepoint-2007, pdf-generation, abcpdf

我将 abcpdf7 与我的 .NET 应用程序一起使用。我用它从准备好的 HTML 代码中自动生成 PDF。PDF 在 pc pdf 查看器上看起来很棒，但在手机上预览时看起来真的很糟糕，例如在 Android 或 iOS 上。问题在于字体，因为它们通常看起来像湿油漆。只需看一下附件：

![在此处输入图像描述](../Images/8113319a0f2f1ef7f0f236627213799f.png) [在Android上查看abcpdf7生成的数字](https://i.stack.imgur.com/qHBhb.jpg)

有什么问题？你有没有遇到过这样的问题？你知道解决办法吗？

我已将原始 PDF 文件放在此链接下：[http ://www.sendspace.com/file/3470uu](http://www.sendspace.com/file/3470uu)

# javascript - 如何根据网格线的宽度在带有 alpha 通道的画布中绘制网格？

> ID：13585515
> 
> 赞同：2
> 
> 时间：2012-11-27T13:40:23.780
> 
> 标签：javascript, canvas

我有点坚持这个；基本上我想要发生的是网格首先以完全不透明度绘制，当网格线是画布的宽度或高度时降低到 0.15 不透明度。我有*逆向*工作，但我不确定如何将其转换为我需要的。这是重新创建问题的代码：

```
var bg = id('bg');
var bgCtx = bg.getContext('2d');

/*    Menu Screen
    ------------------------------------- */

var game = 
{
    w:800,
    h:500
};

var menu =
{
    tick: 0,
    gridX: 0,
    gridY: 0,
    active:true,
    lines:
    [

    ]
};

function GridLine(x, y, direction)
{
    this.x = x;
    this.y = y;
    this.dimension = 0;
    this.direction = direction;
}

GridLine.prototype.draw = function()
{
    bgCtx.strokeStyle = 'hsla(192, 100%, 70%, ' + (this.dimension/game.h) + ')';
    bgCtx.lineWidth = 1;
    if (this.direction == 'vertical')
    {
        if (this.dimension < game.h)
        {
            this.dimension+=20;
        }
        bgCtx.beginPath();
        bgCtx.moveTo(0.5 + this.x, 0);
        bgCtx.lineTo(0.5 + this.x, this.dimension);
        bgCtx.stroke();
        bgCtx.closePath();
    }
    else if (this.direction == 'horizontal')
    {
        if (this.dimension < game.w)
        {
            this.dimension+=20;
        }
        bgCtx.beginPath();
        bgCtx.moveTo(0, 0.5 + this.y);
        bgCtx.lineTo(this.dimension, 0.5 + this.y);
        bgCtx.stroke();
        bgCtx.closePath();
    }
}

function updateMenu()
{
    if (menu.active)
    {
        bgCtx.clearRect(0,0,bg.width,bg.height);
        bgCtx.fillStyle = "black";
        bgCtx.fillRect(0, 0, bg.width, bg.height);
        menu.tick++;
        if (menu.tick % 2 == 0 && menu.gridX < game.w)
        {
            menu.gridX += 50;
            menu.gridY += 50;
            menu.lines[menu.lines.length] = new GridLine(menu.gridX, 0, 'vertical');
            menu.lines[menu.lines.length] = new GridLine(0, menu.gridY, 'horizontal');
        }
        for (var h = 0; h < menu.lines.length; h++)
        {
            menu.lines[h].draw();
        }
        requestAnimationFrame(updateMenu);
    }
    else
    {
        cancelAnimationFrame(updateMenu);
    }
}

window.addEventListener('load', function()
{
    updateMenu();
}, false);

/*    Helper functions
    ------------------------------------- */

function id(e)
{
    return document.getElementById(e);
}

(function()
{
    // http://paulirish.com/2011/requestanimationframe-for-smart-animating/
    var lastTime = 0;
    var vendors = ['ms', 'moz', 'webkit', 'o'];
    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x)
    {
        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];
        window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame'] || window[vendors[x]+'CancelRequestAnimationFrame'];
    }

    if (!window.requestAnimationFrame) window.requestAnimationFrame = function(callback, element)
    {
        var currTime = new Date().getTime();
        var timeToCall = Math.max(0, 16 - (currTime - lastTime));
        var id = window.setTimeout(function()
        {
            callback(currTime + timeToCall);
        }, timeToCall);
        lastTime = currTime + timeToCall;
        return id;
    };

    if (!window.cancelAnimationFrame) window.cancelAnimationFrame = function(id)
    {
        clearTimeout(id);
    };
}()); 
```

问题出在`GridLine.prototype.draw function`. 你能给的任何建议都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:25:52.367

如果我了解您想要什么，只需从 1（完全不透明度）中减去您的值即可获得效果..

```
bgCtx.strokeStyle = 'hsla(192, 100%, 70%, ' + (1-this.dimension/game.h) + ')'; 
```

相当整洁的小效果，非常喜欢Tron。

**[现场演示](http://jsfiddle.net/loktar/NWtvH/)**

# c - memcpy 发生错误

> ID：13585516
> 
> 赞同：3
> 
> 时间：2012-11-27T13:40:30.687
> 
> 标签：c

我尝试使用 memcpy() 函数但出现错误：

```
typedef struct
    {
        int a;
        int b;
    }A;

void Test(void **obj)
{
    A *object=(A*)malloc(sizeof(A));

    memcpy(object,*obj,sizeof(A));//program crash here
    printf("a=%d\n",object->a);
    printf("b=%d\n",object->b);
    free(*obj);
    *obj=NULL;

}
void main()
{
    A *obj=(A*)malloc(sizeof(A));
    obj->a=1;
    obj->b=2;
    Test((void**)obj);

} 
```

通知显示：**“访问冲突读取位置 0x00000001”** 当我传递参数是 void* obj。没有任何问题有人可以帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T13:41:57.943

您已使用类型转换来掩盖代码中的错误。你需要改变：

```
Test((void**)obj); 
```

至：

```
Test(&obj); 
```

带回家的信息：每当您觉得需要使用类型转换时，问问自己为什么——在大多数情况下，这是错误的解决方案，只会掩盖更严重的问题。

注意：您可能还应该更改：

```
void Test(void **obj) 
```

至：

```
void Test(A **obj) 
```

因为没有充分的理由在`void **`这里使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T13:44:02.173

您不将指针的地址传递给函数，而是传递指针本身，因此在函数中与在`*obj`函数中相同。`*obj``main`

使用 address-of 运算符将指针传递给指针：

```
Test(&obj); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T13:56:23.890

```
void main()
{
    A *obj=(A*)malloc(sizeof(A));
    obj->a=1;
    obj->b=2;
    Test((void**)obj); //here is the problem

} 
```

您没有传递 *obj 的地址，您只是将 (A *) 转换为 (void * **),void

```
main()
{
    A *obj=(A*)malloc(sizeof(A));
    obj->a=1;
    obj->b=2;
    Test(&obj);

} 
```

测试函数中的内存泄漏，“对象”已分配但未释放，也未返回。

# winapi - Windows 8 上的 GDI+ DrawString() 截断字符串

> ID：13585520
> 
> 赞同：1
> 
> 时间：2012-11-27T13:40:38.527
> 
> 标签：winapi, visual-c++, windows-8, gdi+, gdi

以下代码在 Windows 7（和以前的 Windows 版本）和 Windows 8 之间以不同的方式显示相同的字符串：

```
Graphics graphics(ps.hdc);

std::unique_ptr<StringFormat> format(StringFormat::GenericDefault()->Clone());
Font font(L"Segoe UI", static_cast<Gdiplus::REAL>(17.5), FontStyleBold, UnitPixel);     
format->SetTrimming(StringTrimmingNone);
std::wstring name("rt");
RectF rectName;
graphics.MeasureString(name.c_str(), -1, &font, PointF(20, 20), format.get(), &rectName);           

graphics.DrawString(name.c_str(), -1, &font, rectName, format.get(), &SolidBrush(Color()));

graphics.DrawRectangle(&Pen(Color(255, 0, 0)), rectName); 
```

在 Windows 7 中，我得到了矩形内的字符串 'rt'，因为它应该出现。在 Windows 8 中，仅出现第一个字母“r”。这似乎只发生在某些字符对上。例如，字符串 're' 在两个操作系统中都能正确显示。从 MeasureString() 返回的矩形在 Windows 7 和 Windows 8 中似乎是相同的。对这种差异有什么解释吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:57:50.773

`MeasureString`众所周知，有时会以效率的名义捏造数字。它会做一些猜测工作，然后填充它填充的 RectF，以便 [希望] 使其足够大以供 DrawString 工作。我怀疑字体渲染方面发生了一些变化，或者系统的提示设置不同，这会在 DrawString 实际适合 RectF 中的文本时造成麻烦。

.NET 的 Measure string 方法实际上在[此 MSDN](http://msdn.microsoft.com/en-us/library/6xe5hazb%28VS.80%29.aspx)中记录了这一点：

> MeasureString 方法设计用于单个字符串，并在字符串前后包含少量额外空间，以允许悬垂字形。此外，DrawString 方法会调整字形点以优化显示质量，并且可能会显示比 MeasureString 报告的更窄的字符串。

作为一种解决方法，您可以使用 MeasureString 进行一些更精确的字形测量

```
std::unique_ptr<StringFormat> format(StringFormat::GenericTypographic()->Clone()); 
```

代替

```
std::unique_ptr<StringFormat> format(StringFormat::GenericDefault()->Clone()); 
```

# php - 将php数组传递给javascript函数

> ID：13585527
> 
> 赞同：-1
> 
> 时间：2012-11-27T13:40:59.237
> 
> 标签：php, javascript, html, arrays, function

> **可能重复：**
> [将数组从 php 传递到 javascript](https://stackoverflow.com/questions/5957460/passing-array-from-php-to-javascript)

我需要将“PhP 数组”传递给“javascript 函数”这是我的代码...

```
 $eqt_param=Array();
for($i=1; $i<3; $i++)
{
    <select name="'.$eqt_param[$i].'" onchange="send(this.name)">

} 
```

我想把这个传给

```
 <script>
 function send(Eqt_Param)
 {

 }
 </script> 
```

将值传递给javascript函数后，我需要3个变量来保存数组的值......请帮我解决这个问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:43:25.893

与往常一样，编码为 JSON 以创建有效的 JavaScript 文字。

```
var val = <?php echo json_encode($somevar); ?>; 
```

# flash - 使用带有后效的 Flash 图像

> ID：13585529
> 
> 赞同：0
> 
> 时间：2012-11-27T13:41:03.023
> 
> 标签：flash, after-effects

我一直在使用闪光灯来追踪灯塔的图像。我使用它是因为我发现很难在 Photoshop 中追踪灯塔。

我只是想知道很难从闪光灯中获取图像并将其用于后期效果合成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T15:18:05.760

您可以将 .swf 文件直接导入 AE。你用的是什么版本？您是否尝试过导入？

# ssl - jboss ssl证书

> ID：13585535
> 
> 赞同：2
> 
> 时间：2012-11-27T13:41:26.640
> 
> 标签：ssl, jboss, server.xml

我有一个 JBoss 服务器，我想启用它的 ssl 功能。`server.xml`我阅读并在中进行了修改`jbossweb-tomcat55.sar`；但似乎我不明白如何以正确的方式创建和添加证书。你能用正确的步骤纠正我吗？

我是这样做的：我生成了一个密钥库文件，然后我使用 .pem 文件生成了一个 .pem 文件`keytool -export`。然后我用来`keytool -import`导入`file.pem`. 然后在`server.xml`文件中我将密码和位置写入导入的证书。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T15:58:16.347

如果您发布了用于生成证书的 keytool 语句会更好，但我猜您正在尝试生成自签名证书。为此，首先您应该生成一个公钥 - 私钥对，实现它的命令如下所示：

```
keytool -genkey -alias yourAliasOrDomainName -keyalg RSA -keystore yourKeyStoreName.jks -keysize 2048 
```

要获取证书（公钥证书），您必须使用 export 命令（这是您必须向客户端发出的文件）

```
keytool -export -alias yourAliasOrDomainName -keystore youKeyStoreName.jks -file youServer.cer 
```

最后，您必须将密钥库文件放在您的服务器中，并设置 HTTP / SSL 连接器，指定密钥库文件及其密码（但不是域密码）。就像是：

```
 <Connector protocol="HTTP/1.1" SSLEnabled="true" 
       port="8443" address="${jboss.bind.address}"
       scheme="https" secure="true" clientAuth="false" 
       keystoreFile="${jboss.server.home.dir}/conf/yourKeyStoreName.jks"
       keystorePass="yourKeyStorePassWord" sslProtocol = "TLS" /> 
```

请注意，在连接器中您必须指定密钥库文件，而不是证书！！！

# c# - 如何在多项目解决方案中使用 SimpleInjector 而不创建循环引用

> ID：13585537
> 
> 赞同：8
> 
> 时间：2012-11-27T13:41:29.847
> 
> 标签：c#, dependency-injection, inversion-of-control, simple-injector

我正在启动一个多项目解决方案，它将有多个入口点，例如 Windows 服务、ASP.NET 网站、WebApi 控制器等。我已经选择了 SimpleInjector，因为它非常快而且我不需要任何高级特征。

我的理解是 SimpleInjector 应该在启动时集中配置。从以下基本示例项目集开始

*   NS.Controllers
*   NS.Core.Data
*   NS.Core.Data.Model
*   NS.Web
*   NS.WindowsService（假设它不会一直运行）

有多个入口点，SimpleInjector 的引导应该去哪里，可以/应该集中处理（在这种情况下，配置过程需要引用所有项目才能设置所有解决方案类）？

我是否应该有一个不引用其他项目的全局实例（例如 NS.Global.Container），并且每个入口点负责在启动时添加自己的实例要求（优雅地处理重复注册，例如 NS.Core.Model）？

我是否应该寻求使用 ResolveUnregisteredType 事件来处理请求的注册？

我只是缺乏一些小学生的知识吗？

更新：

Steven 在下面的评论中提供的链接为这个问题提供了彻底的答案。

[在多层应用程序中定位 Ninject 模块的位置](https://stackoverflow.com/questions/11985452/where-to-locate-ninject-modules-in-a-multi-tier-application/11993030#11993030)

[如何在 mvc 站点的类项目部分中初始化 Ninject](https://stackoverflow.com/questions/13327940/how-to-initialize-ninject-in-a-class-project-part-of-an-mvc-site/13331282#13331282)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T23:08:07.437

为什么不使用`IPackage`接口？您可以在每个模块中制作包，然后在每个入口点调用`container.RegisterPackages();`. 例如，所有配置`NS.Core.Data`都将位于`NS.Core.Data.dll`等等。然后，它将在`NS.Web`和中都可用`NS.WindowsService`。只需配置指定给它的类型，`NS.Web`然后调用`container.RegisterPackages();`等等。您的`NS.Core.Data`包裹可能如下所示：

```
public class CoreDataPackage : IPackage {
    public void RegisterServices(Container container) {
        container.Register<ISomeService,SomeImplementation>();
        // etc...
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-27T13:48:34.313

每个入口点都应该有自己的引导容器。

NS.Web 应该有一个，因为那是一个网站（我在这里假设）。NS.WindowsService 应该有一个，因为那是 .exe（服务）。

其他项目看起来像类库，因此它们没有引导容器。

理论上，是的，您可以在每个类库中定义一个部分引导容器，然后您可以在主引导容器（在 Web/服务项目中）中使用它，让生活更轻松。然后，在部分容器中，您将为该类库的组件进行引导。

# android - 是否可以将灰度应用于视图？

> ID：13585540
> 
> 赞同：1
> 
> 时间：2012-11-27T13:41:44.457
> 
> 标签：android, view, grayscale

我知道可以将灰度滤镜应用于位图，我想知道是否可以将其应用于视图。`GridView`这样做的目的是使适配器中的一个元素变灰`getView()`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:45:19.817

您可以将其应用于位图并将其设置为gridview的背景

```
public View getView(int position, View convertView, ViewGroup parent) {
        View vi = convertView;
        ViewHolder holder;

            if (convertView == null) {
                vi = inflater.inflate(R.layout.adaptercategories, null);
                holder = new ViewHolder();              
                holder.txtCategoryName = (TextView) vi.findViewById(R.id.txtCategoryName);
                vi.setTag(holder);

                            // set the bitmap here for vi's background 

            } else {
                holder = (ViewHolder) vi.getTag();
            }

        return vi;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:13:21.020

尝试创建具有透明度的 ImageView 并将其定位以覆盖活动。

您可以将其可见性设置为消失，然后在需要时显示和定位它。

# php - 在选择下拉列表中显示项目

> ID：13585541
> 
> 赞同：1
> 
> 时间：2012-11-27T13:41:56.233
> 
> 标签：php, javascript, html, select

我有一个简单的 html 下拉框

```
<select class="dr_down">
<option>item1</option>
<option>item2</option>
<option>item3 etc...</option>
</select> 
```

我需要做的是在编辑表单时显示所选项目，而不是默认返回列表顶部。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T13:43:05.183

使用`selected`属性：

```
<select class="dr_down">
   <option>item1</option>
   <option selected='true'>item2</option>
   <option>item3 etc...</option>
</select> 
```

这将默认选择“item2”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T14:11:32.633

如果您有一些带有值的数组并选择了值，您应该使用类似这样的东西

```
<select>
<?php foreach( $yourData as $id => $name ):?>
  <option <?php echo $id === $yourCurretID ? "selected='selected'" : ''?> ><?php echo $name?></option>
<?php endforeach;?>
</select> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T13:43:48.703

你试过使用属性吗`selected='true'`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T13:44:39.200

使用`selected`属性来预先选择您的选项，例如

```
<option selected="selected">item2</option> 
```

# linux - 在 postfix 中向组发送邮件

> ID：13585543
> 
> 赞同：0
> 
> 时间：2012-11-27T13:41:58.337
> 
> 标签：linux, email, postfix-mta

我有一个名为`users`and users的组`user1`和`user2`. 我已经安装了 postfix，我可以收到`user1@example.com`和的邮件`user2@example.com`。是否可以将邮件发送到`users@examlpe.com`，以便群组成员能够阅读？

postfix 安装在 ubuntu 服务器上并使用几乎默认配置，只需设置域和网络等。用户和组是使用其主目录创建的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:36:01.267

From the postfix manual:

```
# man aliases
...
 Aliases
  Local Aliases
     /etc/mail/aliases is formatted as a series of lines  of  the
     form

     aliasname:address[, address]

     aliasname is the name of  the  alias  or  alias  group,  and
     address  is the address of a recipient in the group. Aliases
     can be nested. That is,  an  address  can  be  the  name  of
     another  alias  group.  Because of the way sendmail(1M) per-
     forms mapping from upper-case to lower-case, an address that
     is  the  name  of  another  alias group must not contain any
     upper-case letters.

     Lines beginning with white space are treated as continuation
     lines  for  the  preceding alias. Lines beginning with # are
     comments. 
```

You would need to manually add each user to the users group within the aliases file on your host (please check the manual for your distribution for that aliases file location).

So, for your given example:

```
# tail -1 /etc/mail/aliases
users: user1, user2 
```

Once you have made these changes to your *aliases* file, run the following:

```
# newaliases 
```

# c++ - 如何将文本（诗歌）拆分为行（字符串/字符 []）并查找每行的最后一个单词

> ID：13585544
> 
> 赞同：1
> 
> 时间：2012-11-27T13:42:18.897
> 
> 标签：c++, string

我有一首诗，例如：

```
 Roses are red
    Violets are blue
    Sugar is sweet
    And so are you 
```

仅用 /n 分隔，我需要获取每一行的最后一个单词，以便找到朋友建议使用这个的最后一个单词：

```
string lastWord(string line)
{
    return line.substr(max(line.rfind(" "), 0));
} 
```

但是将文本分成几行呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T13:47:12.017

> But what about splitting text into lines?

The answer depends on where the text is initially: if the entire text is in a file, use `ifstream`; if the text is in a `string`, use `stringstream`. In both cases, use [`getline`](http://www.cplusplus.com/reference/string/getline/) in a loop to extract lines from the text one-by-one:

```
string poem = "Roses are red\n\
Violets are blue\n\
Sugar is sweet\n\
And so are you";
stringstream ss(poem);
string line;
while (getline(ss, line)) {
    cout << lastWord(line) << endl;
} 
```

Also, your `lastWord` function has an off-by-one error: you should simply add one to the result of `rfind`, rather than using `max`, like this:

```
string lastWord(string line)
{
    return line.substr(line.rfind(" ")+1);
} 
```

This will remove the initial space from the word being returned.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:49:21.567

I would use a `split` function. See also: [http://www.dotnetperls.com/split](http://www.dotnetperls.com/split)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T13:46:23.733

`substr`只要您有换行符，就可以循环调用。

请记住，换行符可能会因平台、`'\n'`Linux/OSX 和`"\r\n"`Windows 的不同而有所不同。

# excel - Excel UserForm.Print

> ID：13585548
> 
> 赞同：0
> 
> 时间：2012-11-27T13:42:46.547
> 
> 标签：excel, vba

早上好。我遇到了一段过去对我来说效果很好的代码。

```
Private Sub Workbook_Open()

UserForm1.Show

End Sub 
```

存储在用户窗体中

```
Private Sub CommandButton1_Click()

'   Verify All Fields
Msg = "Have you entered all Fields?"
Title = "TONU"
Config = vbYesNo + vbQuestion
Ans = MsgBox(Msg, Config, Title)
    If Ans = Yes Then GoTo nextstep:
    If Ans = No Then Exit Sub

nextstep:

'   Print Option
Msg1 = "Would you like to Print a hard copy?"
Title1 = "TONU"
Config1 = vbYesNo + vbQuestion
Ans1 = MsgBox(Msg1, Config1, Title1)
    If Ans1 = Yes Then UserForm1.Print
    If Ans1 = No Then Run Report

lastRow = Sheets("Sheet1").Cells(Rows.Count, "A").End(xlUp).Row + 1

MsgBox lastRow

End Sub 
```

用户窗体在我的其他项目中打印得很好，但是当在新项目中使用此代码时它不会打印？！？！想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:50:09.760

“是”不是有效的`VbMsgBoxResult`. 应该是`vbYes`或`vbNo`。在第一种情况下，您的代码将落入`NextStep`. 在第二个它将什么都不做。

为避免此类错误`Option Explicit`，请在模块顶部使用。然后它会抱怨 Yes 和 No 是未声明的变量。

更好的是，在工具>选项中选中“需要变量声明”，以使选项显式自动放置在每个模块的顶部。

# php - 无法从 CodeIgniter 中的表单提交运行同步 jQuery ajax 请求

> ID：13585561
> 
> 赞同：0
> 
> 时间：2012-11-27T13:43:11.883
> 
> 标签：php, jquery, ajax, codeigniter

我有一个 js 函数，它被表单上的操作调用两次，一次是用户通过 jQuery.change 在字段中输入文本时，第二次是提交表单时。提交表单时，它会调用该函数来执行 ajax 请求，然后它应该根据返回值停止或继续提交表单。我似乎得到的只是“未定义”的返回值。

被调用的函数是这个......

```
function cf_check_course_slug() {
    // check the slug name is unique
    var course_id = $('#Course_Id').val();
    var course_slug = $('#Slug').val();
    if(course_slug!='') {
        // call script via ajax and ensure it is not already assigned
        $.ajax({
            type:   "GET"
        ,   url:    "/courses/course_slug"
        ,   data:   { cid: course_id, slug: course_slug }
        ,   async:  false
        }).done(function(response) {
            // if we have a duplicate course slug then notify user
            if(response=='duplicate') {
                showErrorMessage('The SLUG created from the LINK NAME you have entered is already being used by another course, please edit the LINK NAME.')
                return false;
            } else {
                return true;
            }
        });
    }
} 
```

提交表单时，它会在 javascript 中触发以下代码...

```
$(document).ready(function () {

    // check we are in the correct module before firing this script
    if($('#course-form').length > 0) {

        // check the link name has created a unique slug
        $('#LinkName').change(function() {
            cf_check_course_slug();
        });

        // check the course record form prior to saving
        $('form').submit(function() {
            if(!cf_check_course_slug()) {
                return false;
            }
        });

    }

}); 
```

此 cf_ 函数调用 CI 中的控制器，该控制器对数据库执行检查以检查 slug 是否重复，如果是则返回字符串“重复”。如果我更新链接名称并检查.change，它会完美运行。

我认为它必须是函数的异步设置的问题，就好像我将它手动编码到提交 js 中一样，它按预期工作 - 虽然，我宁愿让它尽可能干燥。

任何指针都会很棒。

更新 #1 下面是控制器中的以下代码，并从 javascript 函数中调用。

```
function course_slug() {

        // first check this request has come via ajax
        if($this->input->is_ajax_request()) {

            $iCourse_Id = $this->input->get('cid', true);
            $sSlug = $this->input->get('slug', true);

            // load the model and data
            $this->load->model('Course_Model');
            $aCourses = $this->Course_Model->get_courses_by_category();

            // check each course and perform a check on the slug
            $output = '';
            foreach($aCourses as $aCourse) {
                // if we are dealing with an existing course, omit the Course_Id from the course dataset
                if($iCourse_Id && is_numeric($iCourse_Id)) {
                    if($aCourse['Course_Id']!=$iCourse_Id && $aCourse['Active']==1 && $aCourse['Slug']==$sSlug) {
                        $output = 'duplicate';
                    }
                } else {
                    // we are dealing with a new course, check through ALL courses in the dataset
                    if($aCourse['Slug']==$sSlug) {
                        $output = 'duplicate';
                    }
                }

            }

            // spit out the result
            $this->output->set_content_type('application/json')->set_output(json_encode($output));

        } else {
            // redirect to course homepage
            redirect('courses'); 
        }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T15:13:00.180

您的 url 部分应该是

```
url:    "< ?php echo site_url("/courses/course_slug"); ?>" 
```

*您需要加载 url 帮助程序才能使用 site_url() 或 base_url() 函数。

```
$this->load->helper("url"); 
```

代替

```
url:    "/courses/course_slug" 
```

如果您使用标准 htaccess，则相对 url 并不总是在 codeigniter 中工作，因为 codeigniter 使用 index.php 创建 nice_url 选项，因此您的 url 应该类似于 localhost/index.php/courses/course_slug 和您添加的内容有 localhost/courses/course_slug ，如果没有重写引擎，那将无法工作。

尽管如果您也可以发布 php 脚本，那么对于为什么会收到未定义的响应会更有帮助。

# javascript - 用python读取数据库

> ID：13585573
> 
> 赞同：0
> 
> 时间：2012-11-27T13:43:45.940
> 
> 标签：javascript, python

位于此地址[http://www.stiftelser.lst.se/StiftWeb/SSearch.aspx](http://www.stiftelser.lst.se/StiftWeb/SSearch.aspx)的数据库使用一些 javascript 代码来显示更多结果。这是它使用的代码：

javascript:__doPostBack('grdResult$_ctl14$_ctl1',")

通过单击链接执行此 javascript 以显示更多结果不会更改页面的 url。python脚本是否仍然可以执行javascript并从数据库中获取更多结果？

我的 python 脚本真正想要的是查看数据库中的条目，每个条目都有一个 ID，您可以在 URL 末尾附加一个 ID：http: [//www.stiftelser.lst.se/StiftWeb/FoundationDetails.aspx ?id=IDNUMBER_HERE](http://www.stiftelser.lst.se/StiftWeb/FoundationDetails.aspx?id=IDNUMBER_HERE)。

id 似乎从 1000000 到大约 1040000 不等，但总共只有 13136 个条目。您可以通过简单地查找包含信息的条目来以暴力方式创建索引，但我想找到一种更优雅的方法，如果有的话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:50:55.420

你在使用任何框架吗？简单的逻辑是这样的：

您使用方法提交表单`GET`，以便您可以看到 url 中的参数并在服务器端使用该数据并返回。是你想要的吗？

我想，你知道什么是 html 表单以及发送 httpresponse 意味着什么..

希望那有所帮助

顺便说一句：不改变网址更多的是ajax，也许你也试试

# c++ - 提升 python 容器、迭代器和项目的生命周期

> ID：13585575
> 
> 赞同：1
> 
> 时间：2012-11-27T13:43:50.263
> 
> 标签：c++, python, boost-python

我正在尝试将 C++ 容器暴露给 Python。我有：

```
class Container {
    std::auto_ptr<Iterator> __iter__();
};

class Iterator {
    Container & parent;
    Item __next__();
};

class Item {
    Container & parent;
}; 
```

`Item`类在内部引用存在于 Container 中的数据。`Iterator`返回`Item`的实例不必存在`Item`即可使用。

```
c = Container()
for i in c:
    store = i

print store 
```

在上面的代码中，我希望得到`Container`,`Iterator`和几个`Item`实例。当它到达`print`语句时，我希望`Iterator`它已经被破坏，但`Container`实例显然仍然存在`store`。

现在问题来了。我不知道`CallPolicy`用什么来达到这个效果：定义：

```
class_<Container>("Container", ...)
  .def("__iter__", &Container::__iter__, return_interal_reference<>() )
;

class_<Iterator>("Iterator", ...)
  .def("next", &Iterator::__next__, what_call_policy_here? )
;

class_<Item>("Item", ...)
  .def("__str__", ... )
; 
```

我应该用什么代替`what_call_policy_here`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T14:49:39.590

好的，经过长时间的挖掘，我想我想出了对暴露类型透明的解决方案。

# 简短的介绍

基本上解决方案是创建`CallPolicy`将自动存储对返回的*子*对象（即）内的*父*对象（即）的引用作为其属性（我使用了一个私有名称，但 Python 在这方面非常自由）。`Container`*`Iterator`*

 *然后自动将其复制到所有*兄弟*对象（*兄弟*是*parent*的另一个*孩子*，但是是通过调用另一个*孩子*的方法创建的，所以不是直接来自*parent*）。

 ***# 执行

这需要对`CallPolicy`. 我必须创建两个自定义的：

```
// This policy is used for methods returning items that require object to be
// kept as long as return thing is alive.
// It stores reference in attribute named Property_::name
template <typename Property_, class BasePolicy_ = boost::python::default_call_policies>
struct store_parent_reference: public BasePolicy_
{
    template <class ArgumentPackage>
    static PyObject* postcall(ArgumentPackage const& args_, PyObject* result)
    {
        result = BasePolicy_::postcall(args_, result);

        PyObject* parent = detail::get_prev< std::size_t(1) >::execute(args_, result);
        PyObject* child = result;

        if( PyObject_SetAttrString( child, Property_::name, parent ) == -1 )
        {
            std::ostringstream err;
            err << "store_parent_reference::postcall could not set attribute `"                    << Property_::name
                << "` on newly allocated object `"
                << extract<std::string>( object( handle<>(borrowed(child))).attr("__str__")() )()
                << "`";
            throw std::runtime_error(err.str());
        }

        return result;
    }
};

// This policy is used for methods returning "sibling" in the meaning both the returned object
// and one that has this method called on require "parent" object to be alive.
//
// It copies reference to "parent" to attribute named ChildProperty_::name
// from "original" object's attribute named SiblingProperty_::name
template <typename ChildProperty_, typename SiblingProperty_ = ChildProperty_, class BasePolicy_ = boost::python::default_call_policies>
struct copy_parent_from_sibling: public BasePolicy_
{
    template <class ArgumentPackage>
    static PyObject* postcall(ArgumentPackage const& args_, PyObject* result)
    {
        result = BasePolicy_::postcall(args_, result);

        PyObject* sibling = detail::get_prev< std::size_t(1) >::execute(args_, result);
        PyObject* new_child = result;

        PyObject* parent = PyObject_GetAttrString( sibling, SiblingProperty_::name );

        if( parent == NULL )
        {
            std::ostringstream err;
            err << "copy_parent_from_sibling::postcall could not get attribute `"
                << SiblingProperty_::name
                << "` from sibling `"
                << extract<std::string>( object( handle<>(borrowed(sibling))).attr("__str__")() )()
                << "` to set up attribute `"
                << ChildProperty_::name
                << "` of returned object which is `"
                << extract<std::string>( object( handle<>(borrowed(new_child))).attr("__str__")() )()
                << "`";
            throw std::runtime_error(err.str());
        }

        if( PyObject_SetAttrString( new_child, ChildProperty_::name, parent ) == -1 )
        {
            std::ostringstream err;
            err << "copy_parent_from_sibling::postcall could not set attribute `"
                << ChildProperty_::name
                << "` on returned object which is `"
                << extract<std::string>( object( handle<>(borrowed(new_child))).attr("__str__")() )()
                << "`";
            throw std::runtime_error(err.str());
        }

        Py_DECREF(parent);

        return result;
    }
}; 
```

# 用法

现在的用法：

```
struct ContainerProperty {
    static const char * const name;
};
const char * const ContainerProperty::name = "__container"

class_<Container>("Container", ...)
    .def("__iter__", &Container::__iter__, store_parent_reference< ContainerProperty >() )
;

class_<Iterator>("Iterator", ...)
    .def("next", &Iterator::__next__, copy_parent_from_sibling< ContainerProperty >() )
;

class_<Item>("Item", ...)
; 
```

**注意**：很难给出完整的最小工作示例`boost::python`，所以我可能错过了上面的一些细节，但解决方案对我来说似乎工作正常（我正在跟踪析构函数调用以进行检查）。

这也不是唯一的解决方案。请注意，这`store_parent_reference`有点类似于`return_internal_reference`它明确需要一个存储数据的地方。这只是因为`copy_parent_from_sibling`需要从某个地方复制它。

这种方法的主要好处是它不需要原始类来了解 Python 的东西。****

# javascript - 如何使用java脚本将按钮的值获取到其他jsp

> ID：13585576
> 
> 赞同：1
> 
> 时间：2012-11-27T13:43:49.890
> 
> 标签：javascript, jsp

我必须在jsp的其他页面上获取按钮值并`<div>`根据条件执行标签我的`index.jsp`代码是这样的

```
 <%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<%@ taglib prefix="c" uri="http://java.sun.com/jstl/core" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jstl/fmt" %>
<%@ taglib prefix="sql" uri="http://java.sun.com/jstl/sql" %>
<%@ taglib prefix="x" uri="http://java.sun.com/jstl/xml" %>

<html>
<head>
<script type="text/javascript">
   function popuponclick()
   {
      my_window = window.open("file.jsp",
       "mywindow","status=1,width=350,height=150");

 }

</script>
    </head>
    <table>
    <tr>
    <td><button type="button" onclick="popuponclick()" value="1" name="name">GetAllEmployeeByID</button></td>
    </tr>
    <tr>
    <td><button type="button" onclick="popuponclick()" value="2" name="name">GetEmployeeByName</button></td>
    </tr>
     </table>
    </body>
    </html> 
```

我`second.jsp`的就是这个

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<%@ taglib prefix="c" uri="http://java.sun.com/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jstl/fmt"%>
<%@ taglib prefix="sql" uri="http://java.sun.com/jstl/sql"%>
<%@ taglib prefix="x" uri="http://java.sun.com/jstl/xml"%>
<%@page import="com.nousinfo.tutorial.employee.service.model.bo.EmployeeBO" %>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>Insert title here</title>
    <script>
    function myfuntion(String name)
    { 
        location.
        document.getElementById("div1");
        }

</script>

</head>
<body>
    <form action="/EmployeeWeb/GetEmployee">
        <div id="div1" style="display: block;">
                <table>
                    <tr>
                        <td width="29">Find_Employee_By_Name:</td>
                        <td><input type="text" name="findbyname" /></td>

</tr>
                    <tr>
                        <td><input type="submit" name="submit" value="find"></td>
                    </tr>
                </table>
            </div>

 <div id="div2" style="display: none;">
                <table>
                    <tr>
                        <td width="29">Find_Employee_By_Name:</td>
                        <td><input type="text" name="findbyname" /></td>
                    </tr>
                    <tr>
                        <td><input type="submit" name="submit" value="find"></td>
                    </tr>
                </table>
            </div> 
    </form>
     <button onclick="myfunction()"></button>
</body>
</html> 
```

我将如何在第二个 jsp 中获取按钮值，以便根据条件我可以运行该`<div>` 标签部分

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:09:26.867

在 index.jsp 页面中试试这个：

```
function popuponclick()
{
    var my_window = window.open("file.jsp", "mywindow","status=1,width=350,height=150");

    // Gets the two divs
    var div1 = my_window.document.getElementById('div1');
    var div2 = my_window.document.getElementById('div2');

    // Hides the two divs
    div1.style.display = 'none';
    div2.style.display = 'none';

    // Check what the value of the button pressed and displays the correct div
    if(this.value = '1')
        div1.style.display = 'block';
    else
        div2.style.display = 'block';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:12:01.477

如果我的问题是正确的，请尝试这样的事情。您需要向按钮添加一些 ID 以轻松选择它们。

用按钮 ID 替换（用斜线）\button id here\，并将 \some value\ 替换为您想要匹配的值（例如 - 2）。

if (document.getElementById('\button id here\').value == \some value){

} 别的 {

}

顺便说一句，在第二个 jsp 中你得到了这个结构：location.document.getElementById

“位置”对象中没有“文档”属性，在没有“位置”的情况下使用它。

# backbone.js - 如何使用主干使灰尘模板更简单

> ID：13585577
> 
> 赞同：2
> 
> 时间：2012-11-27T13:43:51.423
> 
> 标签：backbone.js, templating, dust.js

我设法使以下代码正确呈现模板。`home`是一个预编译的模板名称。

```
app.HomeView = Backbone.View.extend({
  el: '#main',
  template: 'home',
  render: function(){
    var self = this;
    dust.render(this.template, {name:'world'}, function(err,out){
      self.$el.html(out);
    });
    return this;
  }
}); 
```

`self`但是，因为我有很多模板，所以弄乱和灰尘回调的东西并不是很整洁。

是否可以像使用下划线模板一样清理它（如下所示）？

```
template: _.template( $('#some-template').html() ),
render: function(){
  this.$el.html(this.template( {name:'world'} ));
  return this;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:26:39.267

我实际上并没有使用过灰尘，但是从查看[文档](http://akdubya.github.com/dustjs/)来看，似乎没有办法使用上面示例中的回调。`self`但是，您可以通过使用以下方法将其范围限定为回调方法来摆脱变量`bind`：

```
render: function(){

  dust.render(this.template, {name:'world'}, function(err,out){
      this.$el.html(out);
  }.bind(this));

  return this;
} 
```

`bind`不能完全解决您的问题，但无论如何了解它是有用的。请注意，并非所有浏览器都支持它（例如 IE 8）。但是，您可以轻松地将功能添加到不支持它的浏览器。MDN 有一个我使用的[不错的小解决方案。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)

或者，您可以通过使用下划线的内置模板轻松实现您想要的，尽管您必须构建自己的模板缓存来进行模板的预编译。

```
render: function(){
  this.$el.html(_.template(this.template));
  return this;
} 
```

# c# - 从主程序的线程中访问表单

> ID：13585579
> 
> 赞同：2
> 
> 时间：2012-11-27T13:43:54.960
> 
> 标签：c#, multithreading, com

我编写了一个由 VBScript 访问的 C# DLL COM 库。所有库的东西都写在主程序中，没有任何形式。

后来我添加了一个只显示状态的表单（如“49% 完成”）。这工作得很好，但是当 DLL 必须计算很多东西时，表单会“挂起”。我希望表单始终可以访问和移动。

所以我决定为表格制作一个自己的线程。创建线程和表单很容易，但是从主程序访问此表单时我遇到了很大的问题。例如，我只想设置标题。

我这样称呼表格：

```
 namespace PART1.PART2
{
    public class CLASSNAME
    {
        private Thread fStatus;
        private frm_Status fStatusForm;

        public void runShowStatus()
        {
            if (fStatus == null)
            {
                fStatus = new Thread(new ThreadStart(threadForm));
                fStatus.Start();
            }
        }

        private void threadForm()
        {
            fStatusForm = new frm_Status();
            Application.Run(fStatusForm);
        }
    }
} 
```

表格本身是标准表格。目前没有特殊代码。

有类似的帖子，但有两个主要区别：

*   表单在线程中 - 表单不在主程序中，并且表单不是主表单。
*   主程序尝试访问表单 - 表单不尝试访问主程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:09:22.260

`volatile`您可以像这样向主类添加一个变量`CLASSNAME`：

```
private static volatile int progress = 0; 
```

现在您可以从主线程更改其值，并从表单线程读取值。

# visual-studio-2010 - 将 VS 2010 项目转换为 2011 .vcxproj 文件

> ID：13585586
> 
> 赞同：0
> 
> 时间：2012-11-27T13:44:14.667
> 
> 标签：visual-studio-2010, visual-c++

我们在 VS2010 项目文件中有一个现有代码，它运行良好。我们正在尝试将 VS2010 项目转换为 2011 .vcxproj 文件..

任何人都知道如何以一种聪明的方式进行转换

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:06:07.370

对我来说，我需要做的就是在 VS2012 中打开 VS2010 项目。

您可以查看 .vcxproj 文件的 xml 中发生了什么变化。我相信它只是一个从 v10 变为 v11 的字符串

```
<PlatformToolset>v110</PlatformToolset> 
```

编辑：您可以编写一个批处理来批量转换这些，或者使用某种 XSLT 来自动转换它们......

# ios - iOS Core Data 无法从存储的 URI 打开图像

> ID：13585588
> 
> 赞同：0
> 
> 时间：2012-11-27T13:44:23.947
> 
> 标签：ios, core-data

在我的应用程序中，我将图像存储在我的文档文件夹中，并将它们的 URI 存储在数据库中。

每当我尝试根据存储在数据库中的 URI 加载图像时，结果都会返回“nil”。

存储的 URI 如下所示：

> /Users/myname/Library/Application Support/iPhone Simulator/6.0/Applications/78325CF9-73B0-4D0D-B136-FD8FF8D837C1/Documents/WC_45FEAF25-AC0C-4E91-A5E2-AA48215F1E48-3147-000005C6C9E65B42.jpg

当我从 iTerm 中查看它时，我看到图像在那里，但在 iTerm 中我必须像这样进入目录：

> /Users/myname/Library/Application\ Support/iPhone\ Simulator/6.0/Applications/78325CF9-73B0-4D0D-B136-FD8FF8D837C1/Documents/WC_45FEAF25-AC0C-4E91-A5E2-AA48215F1E48-3147-000005C6C9E65B42.jpg

**注意空格前的反斜杠**

我正在尝试使用此功能获取图像：

```
-(UIImage *) getImageFromURL:(NSString *)fileURL {
    UIImage * result;

    NSData * data = [NSData dataWithContentsOfURL:[NSURL URLWithString:fileURL]];
    result = [UIImage imageWithData:data];

    return result; //result is always nil
} 
```

问题与反斜杠有关吗？很感谢任何形式的帮助！

真挚地，

佐利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:11:55.657

解决方案是不在数据库中存储 uri，只存储图像名称。（但仍将图像存储在文档目录中）然后使用以下函数可以检索图像：

```
- (UIImage*)loadImageWithName:(NSString*) name
{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,
                                                         NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString* path = [documentsDirectory stringByAppendingPathComponent:
                      [NSString stringWithString: name] ];
    UIImage* image = [UIImage imageWithContentsOfFile:path];
    return image;
} 
```

# html - HTML DIV 布局

> ID：13585589
> 
> 赞同：15
> 
> 时间：2012-11-27T13:44:29.640
> 
> 标签：html

我希望创建一个像下面这样的简单布局。

![分区布局](../Images/126f57ea80861197c32a47f1b30be276.png)

有人可以告诉我如何实现这一目标吗？请原谅“坦率”，我来自 C# 背景，所以开发 WEB UI 对我来说有点令人生畏。

**更新：** 我正在使用 's 和 CSS，但没有产生我想要的东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-27T14:00:29.823

这可能会帮助您：

```
<body>
<div style="border: 1px solid; float: right; width: 25%; height: 1000px;" id="1">one</div>
<div style="border: 1px solid; height: 250px; width: 74%;" id="1">two</div>
<div style="border: 1px solid; width: 35%; float: right; height: 750px;" id="1">three</div>
<div style="border: 1px solid; width: 35%; height: 750px;" id="1">four</div>
</body> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-27T13:54:18.657

虽然我们可以写出实现此布局所需的所有代码，但如果您不了解 CSS，这对您无益。但是，我们可以为您指明正确的方向。

这可以使用带有 CSS 的 Float 规则来实现。[这是一个链接](http://css-tricks.com/all-about-floats/)

还应该对 HTML 有很好的基本理解，以便在语义上进行布局。[如果您需要所有帮助， Codecademy](http://www.codecademy.com/#!/exercises/0)将带您了解 HTML 和 CSS。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-25T12:28:16.693

```
<HTML>
    <HEAD>
        <TITLE>Working with div</TITLE>
        <META CHARSET="UTF-8" />
    </HEAD>
    <BODY>

        <link rel=stylesheet href="div.css" type="text/css">

        <div class="a2">two</div>
        <div class="a1">one</div>
        <div class="VerticalSpace"></div>
        <div class="a3">three</div>
        <div class="HorizontalSpace"></div>
        <div class="a4">four</div>

    </BODY>
</HTML> 
```

div.css 文件的内容是

```
 .a1, .a2, .a3, .a4
    {
        border: 4px solid;
    }

    .VerticalSpace, .HorizontalSpace
    {
        border: 0px;
        float: left;
    }

    .a2
    {
        height: 250px;
        float: left;
        width: 74%;
    }

    .a3
    {
        height: 350px;
        float: left;
        width: 35%;
    }

    .a4
    {
        height: 350px;
        float: left;
        width: 35%;
    }

    .a1
    {
        height: 617px;
        width: 23%;
        float: right;
    }

    .VerticalSpace
    {
        width: 60%;
        height: 10px;
    }

    .HorizontalSpace
    {
        height: 350px;
        width: 4%;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T13:50:38.777

[具有流体左列和固定右列的两列 div 布局](https://stackoverflow.com/questions/5645986/two-column-layout-using-divs)
[http://www.456bereastreet.com/lab/developing_with_web_standards/csslayout/2-col/](http://www.456bereastreet.com/lab/developing_with_web_standards/csslayout/2-col/)
这些链接告诉您如何处理两列布局。首先只需将其设置为左右两列，然后再为左侧列执行此操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-27T13:52:08.590

CSS 网格系统，如[960.gs](http://960.gs/)或[Twitter 的引导程序](http://twitter.github.com/bootstrap/scaffolding.html#gridSystem)将极大地帮助使布局按照您的意愿工作。

# javafx-2 - 如何在 FXML 控制器中获取父窗口？

> ID：13585590
> 
> 赞同：27
> 
> 时间：2012-11-27T13:44:28.050
> 
> 标签：javafx-2, fxml

例如，我想在单击按钮时打开一个 DirectoryChooser：

```
<VBox fx:controller="com.foo.MyController"
    xmlns:fx="http://javafx.com/fxml">
    <children>
        <Button text="Click Me!" onAction="#handleButtonAction"/>
    </children>
</VBox> 
```

和控制器类：

```
package com.foo;

public class MyController {
    public void handleButtonAction(ActionEvent event) {
        DirectoryChooser dc = new DirectoryChooser();
        File folder = dc.showDialog(null);//I want to put the WIndows here.
    }
} 
```

我想把主窗口放到*ShowDialog*中，这样它就会被阻止，但我怎样才能访问它呢？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-11-27T18:07:02.203

您可以向任何节点询问`Scene`然后调用`Scene#getWindow()`.

```
((Node) event.getTarget()).getScene().getWindow() 
```

如果这是一个处理程序，则来自[@osvein](https://stackoverflow.com/users/1981338/osvein)`MenuItem` ，它应该是：

```
((MenuItem) event.getTarget()).getParentPopup().getOwnerWindow() 
```

# c# - 如何将一个数字分成多个部分，以使结果总和等于输入？

> ID：13585591
> 
> 赞同：10
> 
> 时间：2012-11-27T13:44:35.353
> 
> 标签：c#

我试图将一个数字分成多个部分，以便部分的总和等于输入数字。

如果我有 3.99 并且需要分成两部分，则预期输出为 2 和 1.99 (2+1.99=3.99)

而如果我需要将 3.99 分成 3 部分，则预期输出为 1.3、1.3 和 1.39（1.3+1.3+1.39=3.99）

对于第一个示例，我能够输出 2.99 和 1，而对于第二个示例，我能够得到 1.99、1 和 1。然而，在这两种情况下，结果都与预期的输出相差甚远。

我需要将邮政费用拆分为单独的行项目。结果可以等分或不等分，同时确保不同部分的总和等于输入数。

以下是一些其他示例：

```
3.99 divided in 3 parts: 1.33, 1.33, 1.33
3.98 divided in 3 parts: 1.33, 1.33, 1.32
3.97 divided in 3 parts: 1.32, 1.32, 1.33
3.96 divided in 3 parts: 1.32, 1.32, 1.32
3.95 divided in 3 parts: 1.32, 1.32, 1.31 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T13:59:06.367

我用您提供的值进行了测试。可能需要一些调整：

```
static IEnumerable<decimal> SplitValue2(decimal value, int count)
{
    if (count <= 0) throw new ArgumentException("count must be greater than zero.", "count");
    var result = new decimal[count];

    decimal runningTotal = 0M;
    for (int i = 0; i < count; i++)
    {
        var remainder = value - runningTotal;
        var share = remainder > 0M ? Math.Max(Math.Round(remainder / ((decimal)(count - i)), 2), .01M) : 0M;
        result[i] = share;
        runningTotal += share;
    }

    if (runningTotal < value) result[count - 1] += value - runningTotal;

    return result;
} 
```

这假设您传入一个具有 2 位小数精度的值。如果你通过 3.999，你将不会得到正确的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-09T03:34:59.457

如果有人打算使用扩展方法拆分四舍五入的数字，可以通过执行以下操作来完成。例如。将 25 分成 4 会得到类似 6,6,6,7 的结果。谢谢@乔恩 B

```
 public static IEnumerable<int> PartitionMeInto(this int value, int count)
    {
        if (count <= 0) throw new ArgumentException("count must be greater than zero.", "count");
        var result = new int[count];

        int runningTotal = 0;
        for (int i = 0; i < count; i++)
        {
            var remainder = value - runningTotal;
            var share = remainder > 0 ? remainder / (count - i) : 0;
            result[i] = share;
            runningTotal += share;
        }

        if (runningTotal < value) result[count - 1] += value - runningTotal;

        return result;
    } 
```

用法

```
 int value = 25;

        var result = value.PartitionMeInto(4); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-19T09:07:23.097

我有一个要求，其中 ex: 29 的数字被分成一个常量数组，其余的必须在最后附加。

29 = 9,9,9,3。为此，我的代码是。

```
 List<int> split(int num,int splitBy)
           {

               List<int> r = new List<int>();
               int v = Convert.ToInt32(num / splitBy);
               r.AddRange(Enumerable.Repeat(splitBy, v).ToArray());
               var remaining = num % splitBy;
               if (remaining != 0)
                   r.Add(remaining);
               return r;

           } 
```

快乐编码！！！

# php - 根据数据或mysql表中不存在数据显示图像

> ID：13585595
> 
> 赞同：0
> 
> 时间：2012-11-27T13:44:43.383
> 
> 标签：php

我有一个表格，其中有用户输入的文本或没有输入的文本。当表格显示时，我当前有一个可点击的图标，它会弹出一个显示数据的框，无论是否有任何数据。我想要可点击的图标来指示是否存在一个值...我有这个...有点...已经有另一个字段但它更容易因为数据值是是或否..见以下

```
<td align=\"center\"><img src=backgrounds/" . $rows['fixed'] . ".png></td> 
```

如果是，则显示 yes.png 图标，如果否，则显示 no.png 图标。这是我目前在信息字段中拥有的内容

```
<td align=\"center\"><a href=\"page.html\" target=\"popup\"
 onClick=\"wopen('info_form.php?id=$rows[id]', 'popup', 400, 200); return false;\"><img src=\"backgrounds/info4.png\" border=\"0\"></a></td> 
```

反正有没有做我想做的事，并且有类似于 yes no 字段？我可以在 no 的默认字段中有一个默认值，然后使用 no.png 但是我将如何做一个 not no 的值然后使用“除了 no”.png 之外的东西？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:46:57.430

检查 $row['fixed'] 以查看是否存在任何值。

```
<?php if($rows['fixed']!=''){?>
     <td align=\"center\"><img src=backgrounds/" . $rows['fixed'] . ".png></td>
<?php }else{?>
     something else?
<?php } ?> 
```

# javascript - 无法使用 javascript 显示图像

> ID：13585598
> 
> 赞同：1
> 
> 时间：2012-11-27T13:44:48.203
> 
> 标签：javascript, asp.net

网络代码如下

```
<asp:Image runat="server" ID="img1" ImageUrl="~/Images/important.gif" />
    <asp:Button ID="btn" runat="server" Text="print" /> 
```

我的javascript如下

```
<script type="text/javascript">
    function printIt() {
        var win = window.open('', 'Image', 'resizable=yes,...');
        if (win) {
            //var imgID = '<%= img1.ClientID %>';
            var imageControl = document.getElementById('<%=img1.ClientID%>').src;
            win.document.write(imageControl);
            win.document.close();
            win.focus();
            win.print();
        }
        return false;
    }
</script> 
```

// 根据`vitoshabg`答案更新代码

```
<script type="text/javascript">
    function printIt() {
        var win = window.open('', 'Image', 'resizable=yes,...');
        if (win) {
            //var imgID = '<%= img1.ClientID %>';
            var imageControl = document.getElementById('<%=img1.ClientID%>').src;
            win.write('<img src="' + imageControl + '">');
            //win.write(imgParent);
            win.document.close();
            win.focus();
            win.print();
        }
        return false;
    }
</script> 
```

但是，我得到的不是图片，而是网址，有人可以帮助我在这里获取图片

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:53:59.833

`var imageControl = document.getElementById('<%=img1.ClientID%>').src;`

在这里，您将获得 getElementById 返回的元素的“src”属性。

您可以使用创建新图像

`win.document.write('<img src="' + imageControl + '">');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:46:56.543

您正在获取 URL，因为您`.src`在此行的末尾有：

```
var imageControl = document.getElementById('<%=img1.ClientID%>').src; 
```

将其更改为此以获取图像控件：

```
var imageControl = document.getElementById('<%=img1.ClientID%>'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T13:47:51.503

错误已删除；）

```
<script type="text/javascript">
    function printIt() {
        var win = window.open('', 'Image', 'resizable=yes,...');
        if (win) {
            //var imgID = '<%= img1.ClientID %>';
            var imageControl = document.getElementById('<%=img1.ClientID%>');
            win.document.write(imageControl);
            win.document.close();
            win.focus();
            win.print();
        }
        return false;
    }
</script> 
```

# php - 在 PHP 中查找全局函数

> ID：13585602
> 
> 赞同：3
> 
> 时间：2012-11-27T13:45:01.980
> 
> 标签：php, function

我正在尝试重构一个相当大的项目（超过 10 万行代码），它混合了函数、方法和静态方法。我需要帮助查找未在类范围内声明的所有函数，以便将它们移至一个。有没有简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T13:47:03.750

请阅读： http: [//php.net/manual/en/function.get-defined-functions.php](http://php.net/manual/en/function.get-defined-functions.php)和/或查看[http://php.net/manual/en/book.reflection.php](http://php.net/manual/en/book.reflection.php)

您可以通过调用轻松调试项目并获取有关现有函数的元信息：

```
$array = get_defined_functions();
$array = $array['user'];
print_r($array); 
```

PHP 5.4.0（及更新版本）

```
print_r(get_defined_functions()['user']); 
```

# security - 如何加密用户数据同时使其在站点管理器中可见？

> ID：13585604
> 
> 赞同：0
> 
> 时间：2012-11-27T13:45:16.990
> 
> 标签：security, encryption, salt

我正在构建一个网络应用程序，并希望确保我们以正确的方式加密用户数据。

这些数据不是高度敏感的（如医疗记录或 CC 号码），但我认为它应该安全地存储 - 只是简单的姓名、公司、职位、电话号码、电子邮件地址。当然还有密码 - 但这将使用哈希/盐来保护......

我想安全地存储用户数据，以防止网站被黑客入侵/服务器受损。但我还需要网站管理员可以看到客户姓名、组织、电话号码和电子邮件地址 - 即在后端可见。

网站管理员当然看不到密码...

我会很感激一些关于我应该如何去做的建议——我想做足够多的事情来“合理地”安全而不会过火——就像我说数据不是非常敏感并且网站本身不是一个任何人都会感到尴尬的……的一员

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:18:08.020

散列是计算数据的不可逆（或几乎不可逆）单向函数的过程。所以你可能会提到加密。

至于在这种情况下的应用程序级加密，您可以这样做，但它只会防止有人倾倒原始数据库并读取它。要提供管理视图的功能，您必须使用一个密钥加密所有内容。并在您的 web 应用程序中动态解密，值得指出的是，如果您的应用程序易受 SQL 注入攻击，这可能意味着尽管进行了加密，但仍有人能够提取数据。因为您的应用程序可能会认为这是合法数据流的一部分而对其进行解密。

加密数据会引入另一个问题，缩小这些字段的选择范围是什么？您必须在传递之前加密参数。但是您必须使用相同的 IV 来匹配字段值。但是为了使用有效的 IV，您必须知道从哪个提取 InitializationVector 中提取的 db 中的确切记录。正如我所说，这可能很棘手。

我个人认为加密是最后的手段，只有在绝对必要时才应该使用。因为在解决机密性问题时，它会引入一个可能更大的密钥管理问题。我认为这是你的情况。

# file - Nginx：将重写与 try_files 一起使用

> ID：13585607
> 
> 赞同：0
> 
> 时间：2012-11-27T13:45:24.617
> 
> 标签：file, nginx, rewrite

我正在尝试`rewrite`与`try_files`. 理想情况下，我希望 Nginx 先尝试原始 URI。如果这不起作用，请尝试使用控制器`/controllers/$1.php`。最后，只需重定向到索引。这就是我到目前为止所拥有的（为了简洁起见，我牺牲了上面提到的理想顺序）：

```
location / {
  if (-f /controllers/$uri) {
    rewrite ^(.*)$ /controllers/$1.php last;
    return 403;
  }
  try_files $uri $uri/ /index.php;
} 
```

不过，这似乎不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T18:29:11.503

```
location / {
    try_files $uri $uri/ /controllers$uri.php;

    location ~ \.php$ {
        try_files $uri /index.php;

        #
        # fastcgi/proxy_pass php configuration
        #
    }
} 
```

*   [http://wiki.nginx.org/IfIsEvil](http://wiki.nginx.org/IfIsEvil)
*   [http://wiki.nginx.org/Pitfalls](http://wiki.nginx.org/Pitfalls)

# html - 链接在 Firefox 中不起作用

> ID：13585609
> 
> 赞同：0
> 
> 时间：2012-11-27T13:45:31.793
> 
> 标签：html, css, asp.net-mvc-3, firefox, razor

我有一个 Asp.net MVC3 应用程序，其中一些链接在 FIREFOX 中不起作用，而在 IE 中同样适用。

我创建了一个示例应用程序来显示问题（[https://www.dropbox.com/s/zvkwp1spl05nmeh/FireFox_Issue.zip](https://www.dropbox.com/s/zvkwp1spl05nmeh/FireFox_Issue.zip)）

在这个应用程序中，我有 3 页：**主页**、**第二**页和**第三**页。

这里**第三**页是在**第二**页的页面加载时使用**Ajax****呈现**的。之后，您会发现**报告链接**已呈现，但不起作用。

 ******无法理解为什么它**不能**在**FIREFOX**中工作，而在**IE中同样适用**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:28:04.033

我没有运行你的示例代码，但经常发生这种情况是因为我有一些覆盖元素，比如`div`链接顶部的 a 不起作用。

你应该为你的问题做一个活生生的例子，这将有很大帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:45:43.843

感谢 RCorrie。问题已解决。

以下是解决方案，如果有人正在搜索此问题：

问题在于我使用的 css 样式：

```
.rightDiv
{
    position: relative;
    **overflow:hidden;**
} 
```

添加**溢出：隐藏**解决了这个问题。******

# symfony - 如何在 Symfony2 中添加 simple-html-dom 作曲家包

> ID：13585612
> 
> 赞同：-1
> 
> 时间：2012-11-27T13:45:34.977
> 
> 标签：symfony, composer-php

simple-html-dom 列在[packagist.org](https://packagist.org/packages/shark/simple_html_dom)中，它应该如何包含在 symfony2 中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T14:00:35.813

如果你有 Symfony2.1，你可以使用 Composer 来管理依赖项/包，如果你有 Symfony2.0，你应该调整 Symfony 标准版以使用 Composer，更多信息在[这个答案](https://stackoverflow.com/a/13457618/1149495)中。

# 方法一

### 1.将包添加到`composer.json`

在文件中添加以下内容`src/composer.json`：

```
{
    ...,
    require: {
        ...,
        'shark/simple_html_dom': 'dev-master'
    }
} 
```

### 2.更新（安装）包

运行以下命令：

```
$ php composer.phar update shark/simple_html_dom 
```

### 3.在你想要的地方使用它

# 方法二

## 1.使用`composer require`快捷命令

运行以下命令：

```
$ php composer.phar require -n shark/simple_html_dom:dev-master 
```

## 2.在你想要的地方使用它

# objective-c - UITableView 的导航控制器中未显示“编辑”按钮

> ID：13585614
> 
> 赞同：0
> 
> 时间：2012-11-27T13:45:42.637
> 
> 标签：objective-c, ios, uibutton, ios6, uinavigationitem

我正在为我的应用程序添加书签，所以我添加`UITableView`了用于查看书签页面...

我添加了这段代码来添加编辑按钮，但它没有在导航栏中显示按钮......

```
self.navigationItem.leftBarButtonItem = self.editButtonItem;
self.navigationItem.title = @"Boookmark"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:08:02.353

您的 ViewController 在 UINavigationController 实例中吗？可能是这个问题

# ruby-on-rails - Rails has_many 在单独的表单/视图中嵌套属性

> ID：13585619
> 
> 赞同：2
> 
> 时间：2012-11-27T13:45:53.833
> 
> 标签：ruby-on-rails, forms, nested-attributes

我找到了很多关于如何构建多模型表单和多模型显示的示例。但是，如果我想要单独的表单和显示怎么办？

post.rb:

```
class Post < ActiveRecord::Bas
  has_many :comments, dependent: :destroy
  attr_accessible :comments_attributes
  accepts_nested_attributes_for :comments
end 
```

评论.rb：

```
class Comment < ActiveRecord::Base
  belongs_to :post
end 
```

post_controller.rb：

```
def new
  @post = Post.new
  @post.comments.build
  ...
end 
```

路线.db：

```
resources posts do
  resources comments
end 
```

我的帖子索引中有一个发布评论索引的链接：

意见/帖子/index.html.erb：

```
...
<%= link_to 'Comments', post_comments_path(post) %>
... 
```

Post 和 Comment 都有自己的脚手架生成形式（不是嵌套的）。

```
<%= form_for(@post) do |f| %>
...

<%= form_for(@comment) do |f| %>
... 
```

在评论索引中，我循环发布评论：

意见/评论/index.html.erb：

```
<% @post = Post.find(params[:post_id]) %>  //works fine  
<% @post.comments.each do |comment| %>
...
<% end %> 
```

然而，在添加新评论后（在特定的帖子 ID 下）*，帖子评论索引中的表格是**空的！***

请帮忙。谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T10:04:53.147

我想到了。

在评论表格中应该是：

```
<%= form_for([@post, @comment]) do |f| %>
... 
```

路径应该像这样使用：

```
post_comments_path(@post)
edit_post_comment_path(@post,@comment) 
```

等等

在评论控制器中：

```
def index
    @post= Post.find(params[:post_id])
    @comments= @post.comments.all
...

def show
    @post= Post.find(params[:post_id])
    @comment= @post.comments.find(params[:id])
... 
```

等等

希望其他人会发现这很有用！

# c# - 通过 WebDav 分块上传文件

> ID：13585620
> 
> 赞同：1
> 
> 时间：2012-11-27T13:45:56.523
> 
> 标签：c#, file-upload, webdav

我们开发了一个 asp.net Web 应用程序，它使用 ashx 处理程序来执行部分文件上传。用户可以通过 silverlight 控件选择文件，该控件启动一个 Post HttpWebRequest 到 ashx 处理程序并以较小的块（通过 HttpWebRequest.BeginGetRequestStream）传输文件，以便 silverlight 控件可以显示进度条。

现在我们要扩展此解决方案以支持上传到 WebDAV 文件夹。所以主要的问题是：这种“分块”上传完全可以通过 WebDAV 完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:13:10.680

WebDAV 协议是 HTTP 协议的扩展，因此所有 HTTP 功能都可以使用它。最好的方法是在上传之前计算文件大小 - 这将允许轻松*绘制*进度条。

另一种选择是使用 Content-Range 标头，它允许以块的形式发送数据，但这将导致每个块有一个 HTTP GET 请求。

JFYI：我们的[WebDAVBlackbox](http://eldos.com/sbb/desc-webdav.php)允许相对容易地使用 Silverlight 的所有 WebDAV 功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:54:07.753

我想如果您保持执行 PUT 请求的连接打开，您可以继续向其发送数据..您必须确保您没有超时。可能有问题的一件事是，许多 DAV 服务器需要在 PUT 启动时知道完整的内容长度。

否则，没有标准可以继续附加到文件，拆分为多个 HTTP 请求；但也许你的服务器有一个非标准的扩展[。SabreDAV](https://code.google.com/p/sabredav/)有。

# android - android - 如何广播接收器是否注册？

> ID：13585621
> 
> 赞同：0
> 
> 时间：2012-11-27T13:45:55.803
> 
> 标签：android

我正在创建广播接收器并从活动中调用。动态我想检查广播接收器是否已注册，以便我可以取消注册广播接收器？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:52:11.020

请检查下面的链接以获取答案。他们你可以看到一个简短的好答案：

[在 onReceive 中取消注册 Android 广播接收器会引发“接收器未注册”](https://stackoverflow.com/questions/4957461/unregister-broadcast-receiver-android)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T17:20:18.207

使用包管理器使用此代码启用和禁用广播接收器：此代码的工作方式类似于切换按钮。

```
int flag = (enabled ?
                    PackageManager.COMPONENT_ENABLED_STATE_ENABLED :
                        PackageManager.COMPONENT_ENABLED_STATE_DISABLED);

            if(flag == 1)
                flag = 2;
            else
                flag = 1;

            Log.d("After Flag","::"+flag);

            ComponentName component = new ComponentName(StartActivity.this, SMSReceiver.class);

            getPackageManager().setComponentEnabledSetting(component, flag,PackageManager.DONT_KILL_APP); 
```

其中 enable 是布尔值，我已将其保存为共享首选项，以了解我的广播接收器上次是否工作。

# ruby-on-rails - 如何通过 has_many 和 belongs_to 显示所有数据？

> ID：13585625
> 
> 赞同：1
> 
> 时间：2012-11-27T13:46:12.543
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, associations

我有两个模型：汽车和发动机。一辆车必须有一个引擎。

我的模特协会

```
class Car < ActiveRecord::Base
  belongs_to :engine

  attr_accessible :name, :engine_id              
end 
```

和

```
class Engine < ActiveRecord::Base
  has_many :cars

  attr_accessible :name
end 
```

我知道如何通过 Car 显示引擎数据：

```
Car.first.engine 
```

这返回

```
irb(main):001:0> Car.first.engine
  ←[1m←[36mCar Load (0.0ms)←[0m  ←[1mSELECT "cars".* FROM "cars" LIMIT 1←[0m
  ←[1m←[35mEngine Load (0.0ms)←[0m  SELECT "engines".* FROM "engines" WHERE "engines"."id" = 1 LIMIT 1
=> #<Engine id: 1, name: "Benzine", created_at: "2012-11-27 12:09:08", updated_at: "2012-11-27 12:09:08"> 
```

但是如何同时展示汽车和发动机呢？

示例：car_id：1，car_name：奥迪，engine_name：Benzine

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T18:07:54.320

```
 res = Car.joins(:engine).select("cars.id,cars.name,cars.model,engines.id,engines.name,...") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T07:11:59.930

```
Car.joins(:engine).includes(:engine).select("cars.name, engines.name") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T13:58:29.493

我想说最简单的解决方案是在您的模型中创建自定义方法。例如，在您的汽车模型 (car.rb) 中，您可以尝试以下操作：

```
 def info
    # as a string
    return "car: " + self.name + ", engine: " + self.engine.name
    # as a hash
    return { "car" => self.name, "engine" => self.engine.name }
  end 
```

那么你就可以打电话给 Car.first.info

# svn - IntelliJ 不会保存 SVN 身份验证信息

> ID：13585631
> 
> 赞同：6
> 
> 时间：2012-11-27T13:46:26.613
> 
> 标签：svn, ide, intellij-idea, credentials

我在 OS X 上使用 IntelliJ Ultimate 11.1.4 版。

每次应用程序启动或我从 SVN 更新时，都会提示我输入我的 SVN 凭据。即使我单击“保存凭据”，它们也不会被存储。

[此票证](http://youtrack.jetbrains.com/issue/IDEA-55531)描述了一种解决方法，其中更改 SVN 以存储明文密码。这不能解决我的问题。

如何让 IntelliJ 存储我的 SVN 凭据？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-27T16:22:02.607

如果目录中有任何修改，则可能会出现此问题`/Applications/<app>.app`。这是自 Mac OS 10.8 以来的新功能，因为应用程序现在已签名，并且操作系统在运行时会检查签名。

如果由于文件中的某些更改而导致签名不匹配（例如在安装补丁更新或调整 中的选项之后`Info.plist`），应用程序对系统密钥库的访问将被阻止（以及其他一些功能）。发生这种情况时，无法保存密码。

要解决此问题，请删除应用程序目录并从`.dmg`. 不用担心设置，它们[存储在其他地方](http://devnet.jetbrains.net/docs/DOC-181)，并且在此过程后将被保留。

# for-loop - 从txt文件中逐行提取并重新设置相同的变量

> ID：13585633
> 
> 赞同：0
> 
> 时间：2012-11-27T13:46:34.353
> 
> 标签：for-loop, batch-file

我有 2 个目录：dirA 和 dirB。我们现在只接受 dirB。dirB 包含许多文件，当然以不同的名称/扩展名命名。

我需要从每个文件中提取前 6 个字母，之后我可以继续程序的第二部分，现在我只需要从每个文件中提取前 6 个字母并将它们写入 txt 文件。

这是我编写的代码，FOR 是唯一一个不能正常工作或更好的代码，而不是具有相同的变量：在 loop1 名为 file1 的 STR，在 loop2 名为 file2 等。

我有 STR = file1file2fileN。var 是 file1f（已经 6 个字母）。

```
@ECHO off
CLS

SET dirA=C:\dirA
SET dirB=C:\dirB
SET lista=C:\lista.txt
IF NOT EXIST %dirB% GOTO DNF
IF NOT EXIST %dirA% GOTO DNF

setLocal EnableDelayedExpansion
CD %dirB%
DIR /B * > %lista%

:MAIN
CLS
SET /P S=Last Filename: || Set S=null

:LOOP 
IF /I "%S%"=="null" GOTO MAIN 
FOR /F "tokens=*" %%I IN (%lista%) DO SET str=!str!%%I
SET var=!str:~0,6!
echo !str! > str.txt
echo !var! >> file.txt
SET !str!%%I
IF /I %S%==!var! GOTO:EOF
IF /I %S% NEQ !var! GOTO SNF
GOTO LOOP

:DNF
ECHO.
ECHO %dirA% - %dirB% not found
GOTO:EOF

:SNF
ECHO.
ECHO %S%  Not found
TIMEOUT /T 2
GOTO MAIN

GOTO:EOF

endLocal
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T18:43:45.813

打扰一下。我想我不明白你的代码试图实现什么。但是，此 Batch 段“从每个文件中提取前 6 个字母并将它们写入 txt 文件”：

```
(for %%I in (*.*) do (
   set str=%%I
   echo !str:~0,6!
)) > file.txt 
```

将整个 FOR 命令括在括号中并使用单个 > 重定向操作比对每个文件名使用 >> 附加操作更有效。

# ajax - 标准表单提交与 Ajax 表单提交 - 浏览器自动保存/建议用户输入

> ID：13585635
> 
> 赞同：9
> 
> 时间：2012-11-27T13:46:44.140
> 
> 标签：ajax, forms, jquery, submit

我们大多数使用结合 ajax 的表单可能会注意到用户提交的输入在以后的会话中没有被浏览器保存/建议。当涉及到“登录”页面时，这是一个失败。浏览器通常会提供保存用户名/密码的功能，这非常方便，但使用 ajax 表单提交......好吧，你知道，这不会发生。

我在这里看过两次这个问题，但仍然没有答案。自从被问到已经有大约 9 个月了，我知道这里有很多聪明人。所以....我决定重新提出这个问题。

我们能做些什么来解决这个问题？我们能以某种方式欺骗浏览器吗？

我愿意为此来回工作，因为我知道有一个工作解决方案供我们所有人使用会很好。

**最终解决方案基于 slashingweapon 的答案*（***谢谢！）

**HTML** - 使用自定义按钮提交，没有表单“操作”或“方法”，只有 ajax

```
<form id="signin">

    <label for="username">Username</label>
    <input type="text" id="username" name="username" />

    <label for="password">Password</label>
    <input type="password" id="password"  name="password" />

    //Custom Styled Submit Button
    <img id="submit" class="form_button" src="btn_txt_sign_in.png" alt="Sign In" tabindex="3" />

    //Hidden Standard Form Submit Button
    <input id='trigger' type='submit' style='display:none;' />

</form> 
```

**jQuery**

```
// Bind a click to the Custom Submit Button
$('#submit').click( function() {
    //Trigger a Click on the Hidden Standard Form Submit 
    $('#trigger').click();
});

// Detect when the form attempts to be submitted
$('#signin').submit( function(e){
    // Prevent Standard Form Submission
    e.preventDefault();
    // Perform Function containing Ajax Submission instead
    submit_signin();
});

// Ajax Submission
function submit_signin() {
    //My Ajax Call....
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T18:38:42.247

单击任何提交类型的按钮时，将提交封闭的表单。您可以选择处理提交事件而不是按钮的单击事件。这是一个例子：

```
$('#demoForm').submit(function(evt) {
    evt.preventDefault();
    var data = $(this).serialize();
    alert(data);
});​ 
```

也有适合你的[小提琴](http://jsfiddle.net/sr2Ft/)。

通过捕获稍后的事件，您将确保至少某些浏览器有机会存储表单数据以供将来自动填充。

# 3d - 在three.js场景中需要交互式鼠标控制3D对象

> ID：13585636
> 
> 赞同：2
> 
> 时间：2012-11-27T13:46:45.443
> 
> 标签：3d, webgl, three.js

我正在尝试为加载的 .stl 3D 对象添加交互式鼠标控制。我的困难在于集成鼠标控制代码，而不是查找示例或显示对象。下面是我正在使用的。我的偏好是使用鼠标事件控制相机位置（而不是抓住对象上的定义点），这样看起来我正在用鼠标旋转对象并用滚轮放大和缩小。

```
<!DOCTYPE html>
<html lang="en">
<head>
    <title>three.js webgl - STL</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
        body    {
            font-family: Monospace;
            background-color: #000000;
            margin: 0px;
            overflow: hidden;
                }

        a { color: skyblue }
    </style>
</head>
<body>

    <script src="https://raw.github.com/mrdoob/three.js/master/build/three.min.js"></script>

    <script src="https://raw.github.com/mrdoob/three.js/master/examples/js/loaders/STLLoader.js"></script>

    <script src="https://raw.github.com/mrdoob/three.js/master/examples/js/controls/TrackballControls.js"></script>

    <script>
        var container, camera, scene, renderer;

        init();
        animate();

        function init() {

            container = document.createElement( 'div' );
            document.body.appendChild( container );

            camera = new THREE.PerspectiveCamera(

            35,                                     // field of view
            window.innerWidth / window.innerHeight, // aspect ratio 
            1   ,                                   // distance to nearest side of rendered space
            10000                                   // distance to farthest side of rendered space
                                                );

            camera.position.set( 3, -3, -3 );    // initial camera position x,y,z coordinates

            scene = new THREE.Scene();

            // object

            var loader = new THREE.STLLoader();
            loader.addEventListener( 'load', function ( event ) {

                var geometry = event.content;

                var material = new THREE.MeshLambertMaterial( { ambient: 0xff5533, color: 0xff5533 } ); //color: object hexadecimal color after the 0x

                var mesh = new THREE.Mesh( geometry, material );

                scene.add( mesh );

            } );
            loader.load( 'slotted_disk.stl' );  // from https://raw.github.com/mrdoob/three.js/dev/examples/models/stl/slotted_disk.stl

            // lights

            scene.add( new THREE.AmbientLight( 0x222222 ) );

            var directionalLight = new THREE.DirectionalLight( 0xffffff, 1 );
            directionalLight.position = camera.position;
            scene.add( directionalLight );

            // renderer

            renderer = new THREE.WebGLRenderer( { antialias: true } );
            renderer.setSize( window.innerWidth, window.innerHeight );

            container.appendChild( renderer.domElement );

            window.addEventListener( 'resize', onWindowResize, false );

        }

        function addLight( x, y, z, color, intensity ) {

            var directionalLight = new THREE.DirectionalLight( color, intensity );
            directionalLight.position.set( x, y, z )
            scene.add( directionalLight );

        }

        function onWindowResize() {

            camera.aspect = window.innerWidth / window.innerHeight;

            camera.updateProjectionMatrix();

            renderer.setSize( window.innerWidth, window.innerHeight );

        }

        function animate() {

            requestAnimationFrame( animate );

            render();

        }

       function render() {

            //var timer = Date.now() * 0.0005;            // optional for auto rotation

            //camera.position.x = Math.sin ( timer ) * 5; // optional for auto rotation
            //camera.position.z = Math.cos( timer ) * 5;  // optional for auto rotation

           camera.lookAt( scene.position );

           renderer.render( scene, camera );

       }

    </script>

</body> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T14:43:59.940

这条线`<script src="https://raw.github.com/mrdoob/three.js/master/examples/js/controls/TrackballControls.js"></script>`让您可以访问轨迹球控件。

但是您必须通过添加以下行来激活它：

*   在变量声明头上：
    `var controls;`

*   在 init() 函数中：
    `controls = new THREE.TrackballControls( camera );
    controls.addEventListener( 'change', render );`

*   在 animate() 函数中，在调用 render() 之前：
    `controls.update();`

这样，您可以实例化您的轨迹球控件对象，将其与渲染绑定并在每一帧更新它。

它在 Three.js 网站的 misc_controls_*.html 示例中非常明显。

希望它会有所帮助...

# wordpress - 在 Wordpress 中显示类别帖子的摘录

> ID：13585640
> 
> 赞同：0
> 
> 时间：2012-11-27T13:46:59.137
> 
> 标签：wordpress

我正在尝试在推荐滑块的某个类别中显示帖子的摘录。我有上面的代码，我正在使用高级自定义字段自定义帖子以显示头像、姓名和报价。我将代码添加到存在滑块的 footer.php 中，但出现的帖子是“未分类”部分中的帖子。知道我做错了什么吗？

```
<?php $posts = query_posts('cat=testimonials&showposts=1'); foreach($posts as $post) { ?>
<?php the_excerpt(); ?>
<?php } ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:04:49.280

```
 query_posts('cat=testimonials&showposts=1');
  while (have_posts()) : the_post();
  the_excerpt();
  endwhile; 
```

query_posts('cat=testimonials&showposts=1');

或尝试

query_posts('cat=CATID&showposts=1'); CATID >> 替换为您的猫 ID

***更新的答案***

然后尝试使用 get_post 代替 query_posts

```
global $post;
$args = array( 'numberposts' => -1, 'category' => 1 );
$myposts = get_posts( $args );
foreach( $myposts as $post ){ echo $post->post_excerpt; } 
```

可能会帮助你...

# plugins - 未找到 IBM Content Navigator Plugin Jar 文件

> ID：13585641
> 
> 赞同：0
> 
> 时间：2012-11-27T13:46:59.550
> 
> 标签：plugins, jar, dojo, websphere, ibm-content-navigator

我正在开发一个**IBM Content Navigator Plugin**。我想向**IBM Content Navigator**添加一个新插件。我已将插件的 jar 文件上传到**WebSphere**服务器，我可以使用浏览器访问该 jar 文件，

* * *

但是，当我使用**IBM Content Navigator Plugin**屏幕执行相同操作时出现错误。我无法将插件 jar 文件加载到**IBM Content Navigator**。

* * *

我已经尝试过 URL 路径和文件路径；我不断收到此错误：“*在指定的 URL 找不到插件 JAR 文件。确保 JAR 文件位于 Web 应用程序服务器上，并且 URL 和文件名正确*。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-06T08:46:00.677

也许答案来得太晚了，但是当插件的 jar 清单中的 Plugin-Class 引用错误或丢失时，可能会发生这种情况。在我们的清单中它丢失了。

也可以看看：

[https://www.ibm.com/developerworks/community/forums/html/topic?id=77777777-0000-0000-0000-000014913620#77777777-0000-0000-0000-000014913713](https://www.ibm.com/developerworks/community/forums/html/topic?id=77777777-0000-0000-0000-000014913620#77777777-0000-0000-0000-000014913713)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-08T14:27:34.607

我知道这个答案对 6 年前发布这个问题的人没有用，但可以帮助 ICN 开发人员在遇到这个问题时进行故障排除。

除了其他人提到的以外，可能还有其他几种可能的情况 ::

1）您对 JAR 文件没有正确的权限。通常每当我在 ICN 服务器上传输文件时，我都会将 JAR 文件的权限更新为 777。

2) 有时如果您部署了一个名为“ABC.jar”的插件 JAR 文件并且想要更新插件，请避免使用相同的name 作为旧的 JAR 文件名。ICN 有时会表现得很奇怪，无法识别旧名称的 JAR 文件。重命名您的新 JAR 文件，例如“ABC1.jar”并在配置时使用它。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-10-01T17:03:06.490

我曾经有同样的问题，我的解决方案是重新启动 websphere 服务器。

# sitecore - Sitecore：基于当前 SiteContext 的模板字段源动态定位

> ID：13585642
> 
> 赞同：3
> 
> 时间：2012-11-27T13:47:01.817
> 
> 标签：sitecore, sitecore6, sitecore-media-library

基本上，我们目前在单个站点核心安装上进行了多站点设置。因此我们在内容节点下有一个这样的结构：

*   站点 1
    *   内容1
*   站点 2
    *   内容二

现在当然我们希望尽可能多地重用我们的模板，所以我们会有一个这样的模板：

```
Templatename: Webpage
Sections: Data
Fields: Title, Body, Image 
```

现在对于“图像”字段源，我们将其设置为`/Media Library/Images`通常的值，但由于我们有 2 个单独的站点，我们希望镜像媒体库中的结构，例如：

*   媒体库
    *   站点 1
        *   图片
    *   站点 2
        *   图片

但是我们将如何在模板上定义源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T19:02:04.957

没有简单的方法可以完成您想要的。您必须用您自己的该类副本覆盖“Sitecore.Shell.Applications.ContentEditor.Image”。

然后重写大部分 BrowseImage 方法，并找到一些方法来选择它应该选择的路径。

如果您支持 webedit，您还必须对命令“webedit:chooseimage”执行此操作。

# spring - Spring MVC：多模块项目 - 无法将 bean 定义从一个模块导入另一个模块

> ID：13585644
> 
> 赞同：0
> 
> 时间：2012-11-27T13:47:02.560
> 
> 标签：spring, maven, servlets, spring-mvc, applicationcontext

我有一个 Maven 项目，它由两个 Maven 模块组成：Web 模块和持久性模块。在 web 模块上使用 Spring MVC。网页.xml：

```
 <web-app id="WebApp_ID" version="3.0"
    xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
    http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">

    <display-name>Web1</display-name>

    <servlet>
        <servlet-name>mvc-dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>mvc-dispatcher</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/mvc-dispatcher-servlet.xml</param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

</web-app> 
```

这是持久性模块上的示例 Spring bean 配置文件（我简化了它以节省时间）：

```
 <?xml version="1.0" encoding="UTF-8"?>
       <beans xmlns="http://www.springframework.org/schema/beans"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://www.springframework.org/schema/beans  
             http://www.springframework.org/schema/beans/spring-beans.xsd">
       <bean name="user" class="com.roganin.auto.persistence.User">
       <property name="userName" value="Jack"/>
        </bean>

        </beans> 
```

**问题：**当我尝试使用类似的东西从 mvc-dispatcher-servlet.xml 导入时：

它无法解决此导入。

我收到以下异常：

```
 java.lang.NoClassDefFoundError: com/test/auto/persistence/User
    at java.lang.Class.getDeclaredMethods0(Native Method)
    at java.lang.Class.privateGetDeclaredMethods(Class.java:2442)
    at java.lang.Class.getDeclaredMethods(Class.java:1808)
    at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.buildLifecycleMetadata(InitDestroyAnnotationBeanPostProcessor.java:196)
    at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.findLifecycleMetadata(InitDestroyAnnotationBeanPostProcessor.java:178)
    at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessMergedBeanDefinition(InitDestroyAnnotationBeanPostProcessor.java:124)
    at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessMergedBeanDefinition(CommonAnnotationBeanPostProcessor.java:283)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyMergedBeanDefinitionPostProcessors(AbstractAutowireCapableBeanFactory.java:830)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:493)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:605)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:925)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:472)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:383)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4791)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5285)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)

        Caused by: java.lang.ClassNotFoundException: com.test.auto.persistence.User
    at  
                org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1714)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1559)
    ... 30 more

And:

    2012-11-27 15:39:50,717 WARN       
    [org.springframework.web.context.support.XmlWebApplicationContext] - <Exception thrown    
    from LifecycleProcessor on context close>
     java.lang.IllegalStateException: LifecycleProcessor not initialized - call 'refresh'     
     before invoking lifecycle methods via the context: Root WebApplicationContext: startup 
     date [Tue Nov 27 15:39:50 EET 2012]; root of context hierarchy
    at org.springframework.context.support.AbstractApplicationContext.getLifecycleProcessor(AbstractApplicationContext.java:353)
    at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1045)
    at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1000)
    at org.springframework.web.context.ContextLoader.closeWebApplicationContext(ContextLoader.java:548)
    at org.springframework.web.context.ContextLoaderListener.contextDestroyed(ContextLoaderListener.java:142)
    at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4831)
    at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:5478)
    at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:160)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722) 
```

但是，在使用 Main 方法的简单两模块项目中，它可以完美运行。

现在我卡住了，因为我无法将任何 bean 从持久性模块注入到 Web 模块。

搜索了很多。请帮忙。

**更新：**我的网络模块 POM：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <parent>
    <groupId>com.test.auto</groupId>
    <artifactId>AutoSite</artifactId>
    <version>1.0</version>
  </parent>
  <groupId>com.test.auto.web</groupId>
  <artifactId>auto-web</artifactId>
  <version>0.1</version>
  <packaging>war</packaging>

    <properties>
        <spring.version>3.1.3.RELEASE</spring.version>
    </properties>

    <dependencies>

    <dependency>
            <groupId>com.test.auto.persistence</groupId>
            <artifactId>auto-persistence</artifactId>
            <version>0.1</version>
        </dependency>

        <!-- Spring 3 dependencies -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-web</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <dependency>
    <groupId>jstl</groupId>
    <artifactId>jstl</artifactId>
    <version>1.2</version>
        </dependency>
                    <dependency>
    <groupId>maven-taglib</groupId>
    <artifactId>maven-taglib-plugin</artifactId>
    <version>1.4.2</version>
         </dependency>
     </dependencies>
         </project> 
```

- 其中“auto-web” - 是一个 Web 模块，“auto-persistence”是一个持久性模块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:49:40.797

它找不到类。您必须指定依赖项。Web 模块依赖于持久性模块，因此它将包含在类路径中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:49:36.533

那是因为我们没有正确加载配置文件吗？您可以尝试`contextConfigLocation`在 Dispatcher Servlet 配置中包含`web.xml`

```
<servlet-name>mvc-dispatcher</servlet-name>
  <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
   <init-param>
     <param-name>contextConfigLocation</param-name>
     <param-value/>
    </init-param>
   <load-on-startup>1</load-on-startup>
 </servlet> 
```

# python - Python: How do I print a statement when a for loop completes a number of times?

> ID：13585648
> 
> 赞同：1
> 
> 时间：2012-11-27T13:47:12.400
> 
> 标签：python

I have some code which mainly revoles around the following couple of lines:

```
#! /usr/bin/env python

from crypt import crypt
import itertools
from string import ascii_letters, digits

def decrypt(all_hashes, salt, charset=ascii_letters + digits + '-' + '/'):
    products = (itertools.product(charset, repeat=r) for r in range(10))
    chain = itertools.chain.from_iterable(products)
    for i, candidate in enumerate(chain, 1):
        if i % 100 == 0:
            print ('%d th candidate: %s' % (i, candidate))
        hash = crypt(''.join(candidate), salt)
        if hash in all_hashes:

            yield candidate, hash
            all_hashes.remove(hash)

        if not all_hashes:
            return

all_hashes = ('aaRrt6qwqR7xk', 'aaacT.VSMxhms' , 'aaWIa93yJI9kU',
'aakf8kFpfzD5E', 'aaMOPiDnXYTPE', 'aaz71s8a0SSbU', 'aa6SXFxZJrI7E',
'aa9hi/efJu5P.', 'aaBWpr07X4LDE', 'aaqwyFUsGMNrQ', 'aa.lUgfbPGANY',
'aaHgyDUxJGPl6', 'aaTuBoxlxtjeg', 'aaluQSsvEIrDs', 'aajuaeRAx9C9g',
'aat0FraNnWA4g', 'aaya6nAGIGcYo', 'aaya6nAGIGcYo', 'aawmOHEectP/g',
'aazpGZ/jXGDhw', 'aadc1hd1Uxlz.', 'aabx55R4tiWwQ', 'aaOhLry1KgN3.',
'aaGO0MNkEn0JA', 'aaGxcBxfr5rgM', 'aa2voaxqfsKQA', 'aahdDVXRTugPc',
'aaaLf47tEydKM', 'aawZuilJMRO.w', 'aayxG5tSZJJHc', 'aaPXxZDcwBKgo',
'aaZroUk7y0Nao', 'aaZo046pM1vmY', 'aa5Be/kKhzh.o', 'aa0lJMaclo592',
'aaY5SpAiLEJj6', 'aa..CW12pQtCE', 'aamVYXdd9MlOI', 'aajCM.48K40M.',
'aa1iXl.B1Zjb2', 'aapG.//419wZU')

all_hashes = set(all_hashes)
salt = 'aa'
for candidate, hash in decrypt(all_hashes, salt):
    print 'Found', hash, '! The original string was', candidate 
```

The program is basically a Brute Force attack and because the output can take a while I need to know if the program is still running or has crashed so I was thinking of having an output statement that says how many combinations of characters have been tried and maybe what the last tried string was but have no idea how to do it.

Thanks in advance for assistance

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-27T13:49:56.390

用于`enumerate`计算候选人。

```
for i, candidate in enumerate(chain, 1):
    if i % 100 == 0:
        print("%d'th candidate: %s" % (i, candidate))
    # perform actual work 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:49:22.783

```
PRINT_COUNT = 10
chain = itertools.chain.from_iterable(products)
count = 0
for candidate in chain:
  hash = crypt(''.join(candidate), salt)
  count = count + 1
  if count % PRINT_COUNT == 0:
    print "count = " + str(count) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T14:01:13.933

好的，我们先举另一个例子：

```
import time
import sys

for i in range(30):
    sys.stdout.write('\r%d'%i)
    sys.stdout.flush()
    time.sleep(0.1) 
```

运行它，它将打印 i 的运行时值。

**注意'\r'**

因此，您可以在代码中执行以下操作：

```
chain = itertools.chain.from_iterable(products)
i = 0
for candidate in chain:
    sys.stdout.write('\r%d'%i)
    sys.stdout.flush()
    i += 1
    hash = crypt(''.join(candidate), salt) 
```

如果输出值在增加，意味着你的程序正在运行。甚至您也可以添加您的所有者代码来确定剩余时间。

# vbscript - Lists in VBScript

> ID：13585660
> 
> 赞同：21
> 
> 时间：2012-11-27T13:48:07.283
> 
> 标签：vbscript

I'm trying to create a simple list in a VBscript, but I'm unable to find something similar.

Basically, I'm working on Active directory, and I need to get all the groups a user is a member of for all the users within a domain. Now, every user might be a member of a different number of groups, so I plan to use a dictionary, with the key being the SAMID for the user, and the value being a list of all the groups he/she is a member of.

I can do this with a static array, but then I have to declare a random large size for the array which is not nice. What I would ideally like to do is have a python-like list, where I can simple do something like myList.Add and don't have to worry about sizing.

I tried using System.Collection.ArrayList, but I get an error when I run it:

```
PS C:\tmp> cscript.exe .\foo.vbs
Microsoft (R) Windows Script Host Version 5.8
Copyright (C) Microsoft Corporation. All rights reserved.

C:\tmp\foo.vbs(1, 1) (null): 0x80131700 
```

how can I accomplish this?

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-11-27T15:52:38.727

摆脱字典并释放 ArrayList 的力量。

```
Option Explicit

dim list
Set list = CreateObject("System.Collections.ArrayList")
list.Add "Banana"
list.Add "Apple"
list.Add "Pear"

list.Sort
list.Reverse

wscript.echo list.Count                 ' --> 3
wscript.echo list.Item(0)               ' --> Pear
wscript.echo list.IndexOf("Apple", 0)   ' --> 2
wscript.echo join(list.ToArray(), ", ") ' --> Pear, Banana, Apple 
```

编辑：我看到您已经尝试过 ArrayList，但出现错误。似乎您安装的 dotnet 框架不正确（System.Collections.ArrayList 是其中的一部分）。微软有一篇关于如何解决这个问题的文章：http: [//answers.microsoft.com/en-us/windows/forum/windows_7-performance/error-code-0x80131700/3add8d80-00e0-4355-a994-8630d01c18f5](http://answers.microsoft.com/en-us/windows/forum/windows_7-performance/error-code-0x80131700/3add8d80-00e0-4355-a994-8630d01c18f5)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-27T13:54:11.733

```
Set dic = CreateObject("Scripting.Dictionary")

dic.Add "Item1", ""
dic.Add "Item2", ""
dic.Add "Item3", "" 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-28T16:36:12.380

这也是一个替代方案......我前段时间创建的一个实际 List 类。您可以自由使用/修改它以满足您的需求。我构建的原始类实际上依赖于另一个名为**ArrayIterator**的自定义类。

以下是如何使用它...

```
Set myList = New List
myList.Add("a")
myList.Add("b")
myList.Add("c")

' Iterate through the List using ArrayIterator. You can of course use other methods...
Set myListItr = myList.GetIterator
While myListItr.HasNext
  MsgBox myListItr.GetNext
Wend

' Iterate through the List by getting the underlying Array.
Dim element
For Each element In myList.GetArray
  MsgBox element
Next 
```

**List**类的源代码：

```
Class List
  Private mArray

  Private Sub Class_Initialize()
    mArray = Empty
  End Sub

  ' Appends the specified element to the end of this list.
  Public Sub Add(element)
    If IsEmpty(mArray) Then
      ReDim mArray(0)
      mArray(0) = element
    Else
      If mArray(UBound(mArray)) <> Empty Then
        ReDim Preserve mArray(UBound(mArray)+1)        
      End If
      mArray(UBound(mArray)) = element
    End If
  End Sub

  '  Removes the element at the specified position in this list.
  Public Sub Remove(index)
    ReDim newArray(0)
    For Each atom In mArray
      If atom <> mArray(index) Then
        If newArray(UBound(newArray)) <> Empty Then
          ReDim Preserve newArray(UBound(newArray)+1)
        End If
        newArray(UBound(newArray)) = atom
      End If
    Next
    mArray = newArray
  End Sub

  ' Returns the number of elements in this list.
  Public Function Size
    Size = UBound(mArray)+1
  End Function

  ' Returns the element at the specified position in this list.
  Public Function GetItem(index)
    GetItem = mArray(index)
  End Function

  ' Removes all of the elements from this list.
  Public Sub Clear
    mArray = Empty
  End Sub

  ' Returns true if this list contains elements.
  Public Function HasElements
    HasElements = Not IsEmpty(mArray)
  End Function

  Public Function GetIterator
    Set iterator = New ArrayIterator
    iterator.SetArray = mArray
    GetIterator = iterator
  End Function

  Public Function GetArray
    GetArray = mArray
  End Function

End Class 
```

**ArrayIterator**类的源代码：

```
Class ArrayIterator
  Private mArray
  Private mCursor  

  Private Sub Class_Initialize()
    mCursor = 0
  End Sub

  Public Property Let SetArray(array)
    mArray = array    
  End Property

  Public Function HasNext
    HasNext = (mCursor < UBound(mArray)+1)
  End Function

  Public Function GetNext
    GetNext = mArray(mCursor)
    mCursor = mCursor + 1
  End Function
End Class 
```

# python - Flask-WTFform：Flash 不显示错误

> ID：13585663
> 
> 赞同：13
> 
> 时间：2012-11-27T13:48:10.887
> 
> 标签：python, flask, wtforms

我正在尝试刷新 WTForm 验证错误。我找到[了这个片段](http://flask.pocoo.org/snippets/12/)并稍微修改了它：

```
 def flash_errors(form):
    """Flashes form errors"""
    for field, errors in form.errors.items():
        for error in errors:
            flash(u"Error in the %s field - %s" % (
                getattr(form, field).label.text,
                error
            ), 'error') 
```

这是我的表单类之一：

```
class ContactForm(Form):
    """Contact form"""
    # pylint: disable=W0232
    # pylint: disable=R0903
    name = TextField(label="Name", validators=[Length(max=35), Required()])
    email = EmailField(label="Email address",
                       validators=[Length(min=6, max=120), Email()])
    message = TextAreaField(label="Message",
                            validators=[Length(max=1000), Required()])
    recaptcha = RecaptchaField() 
```

并查看：

```
@app.route("/contact/", methods=("GET", "POST"))
def contact():
    """Contact view"""
    form = ContactForm()
    flash_errors(form)
    if form.validate_on_submit():
        sender = "%s <%s>" % (form.name.data, form.email.data)
        subject = "Message from %s" % form.name.data
        message = form.message.data
        body = render_template('emails/contact.html', sender=sender,
                               message=message)
        email_admin(subject, body)
        flash("Your message has been sent. Thank you!", "success")

    return render_template("contact.html",
                           form=form) 
```

但是，验证失败时不会闪烁任何错误。我知道我的表单和模板工作正常，因为当数据有效时我的成功消息会闪烁。怎么了？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-27T15:20:20.373

**还没有错误，因为您还没有处理表单**

尝试把方法`flash_errors`放在`else``validate_on_submit`

```
@app.route("/contact/", methods=("GET", "POST"))
def contact():
    """Contact view"""
    form = ContactForm()
    if form.validate_on_submit():
        sender = "%s <%s>" % (form.name.data, form.email.data)
        subject = "Message from %s" % form.name.data
        message = form.message.data
        body = render_template('emails/contact.html', sender=sender,
                               message=message)
        email_admin(subject, body)
        flash("Your message has been sent. Thank you!", "success")
    else:
        flash_errors(form)

    return render_template("contact.html",
                       form=form) 
```

# android - Read a text value and spinner value

> ID：13585664
> 
> 赞同：0
> 
> 时间：2012-11-27T13:48:20.987
> 
> 标签：android

I have the following MainActivity.java file currently running on Eclipse.

My intention is to get the user input and the spinner value and form a url like `www.ex.com?title=(user_inpu)&title_type=(spinner_input)`.

As of now I am hung on this part. How do I get the text value from EditText and Spinner?

I have tried writing this code:

```
package com.example.myfirstapp;

import org.apache.commons.logging.Log;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Spinner;

public class MainActivity extends Activity {

Button btn;
EditText edit;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    btn = (Button) findViewById(R.id.button);
    edit = (EditText) findViewById(R.id.edit_message);

    btn.setOnClickListener(
            new View.OnClickListener()
            {
                public void onClick(View view)
                {
                    Log.v("EditText", edit.getText().toString());
                }
            });

Spinner spinner = (Spinner) findViewById(R.id.spinner);
ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this,R.array.title_type,android.R.layout.simple_spinner_item);
adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
spinner.setAdapter(adapter);

spinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
    public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {
        Object item = parent.getItemAtPosition(pos);
    }
    public void onNothingSelected(AdapterView<?> parent) {
    }
});

}

} 
```

I am getting a small error:

> The method v(string, String) is undefined for MainActivity.java.

I have tried replacing the `Log.v("EditText", edit.getText().toString());` to `Log.v("EditText", MainActivity.this.edit.getText().toString());`, but the error still persists.

How do I get rid of that? And in general, will this code work?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T13:54:49.787

您没有导入正确的`Log`类。

只需更换

```
import org.apache.commons.logging.Log; 
```

经过

```
import android.util.Log; 
```

而且您可能希望使您`spinner`成为活动的成员（就像按钮和文本字段一样），以便您可以从任何侦听器访问它。

我是说：

```
public class MainActivity extends Activity {

    private Button btn;
    private EditText edit;
    private Spinner spinner;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.layout_main);

        btn = (Button) findViewById(R.id.button);
        edit = (EditText) findViewById(R.id.edit_message);
        spinner = (Spinner) findViewById(R.id.spinner);

        btn.setOnClickListener(new View.OnClickListener() {
            public void onClick(View view) {
                Log.v("EditText", edit.getText().toString());
                Log.v("Spinner", spinner.getSelectedItem().toString());
            }
        });

        ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource( this, R.array.title_type, android.R.layout.simple_spinner_item);
        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spinner.setAdapter(adapter);
    }
} 
```

# jquery - Jquery function on parent dom object compile error with TypeScript

> ID：13585665
> 
> 赞同：3
> 
> 时间：2012-11-27T13:48:20.813
> 
> 标签：jquery, typescript

I'm having an error while compiling the following code located in a typescript file:

```
parent.$(mySelector) 
```

Here I'm having an error on the $ sign who is unknown for the typescript compiler. Jquery is referenced through the definition file. What could I do to still be able to use this method of writing my code?

The proper error I'm having is the following:

```
The property '$' does not exist on value of type 'Window' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:06:10.873

您需要为 Window 对象定义 $ 变量，因为 JQuery 定义文件不这样做：

```
interface JQueryWindow extends Window {
    $: JQueryStatic;
} 
```

并且无论何时使用 Window 对象将其转换为 JQueryWindow

```
(<JQueryWindow>parent).$(selector); 
```

# objective-c - Can we use self.prefix name for weak properties in ARC

> ID：13585668
> 
> 赞同：0
> 
> 时间：2012-11-27T13:48:51.180
> 
> 标签：objective-c, cocoa-touch, automatic-ref-counting, self, weak-references

I am working on a ARC based project.

I have declared a property for tableView as follows

```
@property (weak, nonatomic) IBOutlet UITableView *logTable. 
```

In the ViewDidLoad I do the following

```
 - (void)viewDidLoad
{
    [super viewDidLoad];

    [self.logTable.layer setCornerRadius:8.0f];//First Method

   /////OR

    [logTable.layer setCornerRadius:8.0f]; //Second Method

} 
```

My question is, which is the best method i.e First or Second in my case?

I am aware that when we don't use self , we are directly accessing the ivar.But will it make

any difference in case of Weak properties.

EDIT:

Suppose if I have a strong Property as follows

@property(strong,nonatomic)NSArray *dataArray;

As far as I know , this will cause the memory leak

self.dataArray =[[NSArray alloc]init];

So which approach to be followed in this case ?

Any help is greatly appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:54:42.550

我建议使用`self.`for 属性，除非有必要的理由不这样做，例如在自定义访问方法中。当您在将来某个时间回来阅读它时，它会导致需要较少分析的代码，并且如果您决定有一天更改属性属性，它出现错误的机会就会减少。

# email - cakephp send mass email cron job

> ID：13585671
> 
> 赞同：0
> 
> 时间：2012-11-27T13:49:04.890
> 
> 标签：email, shell, cakephp, permissions, cron

i wish to send mass email using cakephp shell cron job. I started with sending mail to a single person. It isn't working. Below is my code:

```
 <?php  
error_reporting(0);
class MyShell extends Shell { 
/** 
 * List of tasks for this shell 
 * 
 * @var array 
 */ 
    var $tasks = array('Email'); 

/** 
 * Email task 
 * 
 * @var EmailTask 
 */ 
    var $Email; 

/** 
 * Startup method for the shell 
 * 
 * Lets set some default params for the EmailTask 
 * 
 */ 
    function startup() { 
        $this->Email->settings(array( 
            'from' => 'tempEmail@gmail.com', 
            'template' => 'test' 
        )); 
    } 

/** 
 * Send just one email 
 * i call this function in shell
 */ 
    function sendMeAnEmail() { 
         //~ $this->out('Hello world.');
        return $this->Email->send(array( 
            'to' => 'tempEmail1@yahoo.in', 
            'subject' => 'Talking to myself' 
        )); 
    } 

/** 
 * Send multiple emails, change a few variables on the fly 
 * and test that we can 'set' variables to the view 
 * 
 //~ */ 
    function sendMyFriendsAnEmail() { 
        $myFriends = array('abc@yahoo.in', 'xyz@yahoo.com'); 
        $this->Email->settings(array('subject' => 'Hello friends')); 
        foreach ($myFriends AS $friend) { 
            $this->Email->set('someVar', $friend); 
            $this->Email->send(array( 
                'to' => $friend,  
                'subject' => 'Hello ' . $friend 
            )); 
        } 
    } 
} 
?> 
```

email.php

```
 <?php  
App::import('Core', 'Controller'); 
App::import('Component', 'Email'); 

class EmailTask extends Shell { 
/** 
* Controller class 
* 
* @var Controller 
*/ 
    var $Controller; 

/** 
* EmailComponent 
* 
* @var EmailComponent 
*/ 
    var $Email; 

/** 
* List of default variables for EmailComponent 
* 
* @var array 
*/ 
    var $defaults = array( 
        'to'        => null, 
        'subject'   => null, 
        'charset'   => 'UTF-8', 
        'from'      => null, 
        'sendAs'    => 'html', 
        'template'  => null, 
        'debug'     => false, 
        'additionalParams'    => '', 
        'layout'    => 'default' 
    ); 

/** 
* Startup for the EmailTask 
* 
*/ 
    function initialize() { 
        $this->Controller =& new Controller(); 
        $this->Email =& new EmailComponent(null); 
        $this->Email->startup($this->Controller); 
    } 

/** 
* Send an email useing the EmailComponent 
* 
* @param array $settings 
* @return boolean 
*/ 
    function send($settings = array()) { 
        $this->settings($settings); 
        return $this->Email->send(); 
    } 

/** 
* Used to set view vars to the Controller so 
* that they will be available when the view render 
* the template 
* 
* @param string $name 
* @param mixed $data 
*/ 
    function set($name, $data) { 
        $this->Controller->set($name, $data); 
    } 

/** 
* Change default variables 
* Fancy if you want to send many emails and only want 
* to change 'from' or few keys 
* 
* @param array $settings 
*/ 
    function settings($settings = array()) { 
        $this->Email->_set($this->defaults = array_filter(am($this->defaults, $settings))); 
    } 
} 
?> 
```

**output:**

```
PHP Warning:  

SplFileInfo::openFile(/mnt/public_html/directory/web/cakephp/app/tmp/cache/persistent/directory_cake_core_file_map): failed to open stream: Permission denied in /mnt/public_html/directory/web/cakephp/lib/Cake/Cache/Engine/FileEngine.php on line 313

Warning: SplFileInfo::openFile(/mnt/public_html/directory/web/cakephp/app/tmp/cache/persistent/directory_cake_core_file_map): failed to open stream: Permission denied in /mnt/public_html/directory/web/cakephp/lib/Cake/Cache/Engine/FileEngine.php on line 313 
```

where am i getting wrong? how do i solve this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-03T17:29:35.510

我知道这是很久以前的事了，但这可能会对某人有所帮助。您的 tmp/cache 目录应该对其以及其中的文件具有写入权限。您还应该 chown -R yourUser:www-data 该目录和 tmp/logs 以防止此错误，即将组所有权授予 Apache。

顺便说一句，如果你想让你的代码在 Apache 空间之外，将你的 Apache webspace 放在 /var/www/ 中并做一些事情，比如把你的应用程序目录放在 /opt 中是更常见的。

# asp.net - Unable to load DLL 'MyDll.dll': The specified module could not be found. asp.net p/invoke

> ID：13585673
> 
> 赞同：2
> 
> 时间：2012-11-27T13:49:06.440
> 
> 标签：asp.net, pinvoke

I am trying o p/invoke a c++ class i have created into a asp.net web application. I have used the following tutorial - [p/invoke](http://manski.net/2012/05/29/pinvoke-tutorial-basics-part-1/)

I can get it working when creating a c# console applicatioin but not a web application

I get the following error when I run it -

"Unable to load DLL 'MyDll.dll': The specified module could not be found."

I have tried putting MyDll.dll into the bin folder but this does not work.

I have set the build path in my web application to match the MyDll.dll but i have read that ASP.NET ignores this and automatically goes to the bin folder when you click debug(F5)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T21:26:22.723

您是否可能在没有安装 C++ 运行时的机器上运行它？错误消息将是您编写的错误消息。或者可能还缺少另一个 DLL。您可以使用 DependencyWalker 找到这一点：http: [//www.dependencywalker.com/](http://www.dependencywalker.com/)

# c++ - 使用指向成员的操作符？

> ID：13585675
> 
> 赞同：-2
> 
> 时间：2012-11-27T13:49:08.307
> 
> 标签：c++

我遇到了以下代码，但无法理解以下概念的重要性。请帮忙 。

```
#include <iostream>
using namespace std;

class cl 
{

public:
    cl(int i) { val=i; }
    int val;
    int double_val() { return val+val; }

};

int main()
{
    int cl::*data; // data member pointer
    int (cl::*func)(); // function member pointer
    cl ob1(1), ob2(2); // create objects
    cl *p1, *p2;
    p1 = &ob1; // access objects through a pointer
    p2 = &ob2;
    data = &cl::val; // get offset of val
    func = &cl::double_val; // get offset of double_val()
    cout << "Here are values: ";
    cout << p1->*data << " " << p2->*data << "\n";
    cout << "Here they are doubled: ";

    cout << (p1->*func)() << " ";
    cout << (p2->*func)() << "\n";
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T13:56:17.190

Pointers-to-members 是 C++ 中的一个特殊小工具，它只告诉您您想要的*类*的哪个成员，而不涉及任何*对象*。您需要将指向成员的指针与对象实例结合起来以获得实际成员，无论它是数据成员还是函数成员。

将指向成员的指针视为“偏移量”。另外，请记住指向成员的指针*不是*指针！

我们可以重写您的代码以使其更清晰：

```
struct Foo
{
    int a;
    int b;
    double f(int, int);
    double g(int, int);
};

int main()
{
    int Foo::*ptm = &Foo::a;
    double (Foo::*ptmf)(int, int) = &Foo::f;

    Foo x, y, z;

    int numbers[] = { x.*ptm, y.*ptm, z.*ptm }; // array of Foo::a's

    ptm = &Foo::b;                              // reseat the PTM

    int more[] = { x.*ptm, y.*ptm, z.*ptm };    // array of Foo::b's

    double yetmore[] = { (x.*ptmf)(1,2), (y.*ptmf)(1,2) };

    ptmf = &Foo::g;

    double evenmore[] = { (x.*ptmf)(1,2), (y.*ptmf)(1,2) };
} 
```

请注意我们如何使用指向成员的指针来仅引用*类成员，并且我们可以使用它从不同的**对象*中获取相同的*相对*类成员。

 *（相比之下，我们也可以形成一个指向实际*对象*成员的真实指针：`int * p = &x.a;`。那是因为 member-`int`实际上是一个整数。但是我们不能对成员函数做任何类似的事情*，*因为成员函数不是函数（例如，你不能调用它们).)

确保您了解类和对象之间的区别，这应该变得非常清楚！*

# java - 在 Java 中实现数据库管理器层 (neo4j) 的指南

> ID：13585677
> 
> 赞同：0
> 
> 时间：2012-11-27T13:49:08.853
> 
> 标签：java, nosql, neo4j

我正在开发一个必须处理多个用户及其请求的 java 应用程序：即。可以创建（注册）用户，可以更新（更改头像，...），或将信息添加到他的帐户（例如描述他的启动）。

为此，我决定使用 neo4j，主要是因为它在关系方面的良好表现（应用程序是“社交的”）。

我想了解的，相信你也知道答案的，就是如何在neo4j中实现多线程。

以下是有关我的软件架构的一些信息：

我有 neo4j 服务器，然后，在我的 javaApplication 中有允许我与服务器通信的 neo4j jar。应用程序分为多个层，每一层都是一个库，包含在下一层中。这意味着我只需要重新编写一个层并暴露相同的接口，其他层不会受到影响。

问题是，使用 MySql，我有一个连接池，我从那里得到一个连接池，并在更高层使用它；一切都被隐藏了，JDBC 为我处理并发。

但是在 neo4j 中，我不明白如何实现并行性：它是从 neo4j 自动处理的吗？那是连接池吗？

我想我明白我必须创建一个“连接”，并且我与所有请求共享同一个。这样对吗？

是否有一些*最佳实践*可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T10:06:43.303

在 Java 应用程序和嵌入式模式中，Neo4j 作为应用程序进程的一部分运行。您处理线程，并且可以为您的遍历生成多个线程并将 Neo4j 视为一个单例。如果您想要自动线程处理，您可以使用 Neo4j Server（通过 REST），它为您提供 webserver-liek 功能，包括多个线程。

# asp.net - Gridview 控件 - 隐藏和显示列

> ID：13585679
> 
> 赞同：0
> 
> 时间：2012-11-27T13:49:12.707
> 
> 标签：asp.net

gridview 控件中是否有任何设置可以在正常模式下隐藏模板字段但在编辑项模板中显示隐藏的字段。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:58:43.117

网格视图是表格数据，因此无论单行的状态如何，您都可以显示或隐藏列。如果您想动态控制布局，`listview`控件将是更好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:46:11.190

要隐藏列，请使用 ie。`GridView1.Columns[0].Visible = false;`. 请注意，它不会是数据绑定的，因此您不能使用隐藏列来检索一些您不想让用户看到的值，就像您可以使用旧的`DataGrid`.

要仅在正在编辑的行上显示字段，请添加一个`TemplateField`空`ItemTemplate`的和一个填充的`EditTemplate`。

```
<asp:TemplateField HeaderText="FirstName" SortExpression="FirstName">
    <EditItemTemplate>
        <asp:TextBox ID="TextBox1" runat="server" Text='<%# Bind("FirstName") %>'></asp:TextBox>
    </EditItemTemplate>
    <ItemTemplate>
    </ItemTemplate>
</asp:TemplateField> 
```

# php - Function argument to push and minus

> ID：13585680
> 
> 赞同：1
> 
> 时间：2012-11-27T13:49:14.433
> 
> 标签：php, function, math, arguments

Try to use function argument in PHP to plus and minus int.

**My functions is :**

```
function int_test($arg) {
    $main = date('m');
    return intval($main.$arg);
} 
```

**so when i test :**

```
echo int_test(); // 11
echo int_test(-1); // 11
echo int_test(1); // 11 
```

Whats happen ? or how can I do ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:50:51.130

```
function int_test($arg = 0) {
    $main = date('m');
    return intval($arg) + $main;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:59:32.817

将从 date ( ) 返回的`.`数字字符串与您传递给函数`$main`的参数 ( )连接起来，因此您最终会得到字符串“11-1”或“11+1”`$arg``int_test`

```
return intval($main.$arg); 
```

返回值将是从字符串“11+1”到第一个无效字符（此处为“+”或“-”）的有效数字数据，剩下 11。

来自 PHP 手册：

> [*字符串转换为数字*](http://docs.php.net/manual/de/language.types.string.php#language.types.string.conversion)
> 
> 在数字上下文中评估字符串时，结果值和类型确定如下。如果字符串包含任何字符“.”、“e”或“E”，则该字符串将被评估为浮点数。否则，它将被评估为整数。该值由字符串的初始部分给出。如果字符串以有效的数字数据开头，这将是使用的值。否则，该值将为 0（零）。有效的数字数据是一个可选的符号，后跟一个或多个数字（可选地包含一个小数点），后跟一个可选的指数。指数是“e”或“E”后跟一位或多位数字。

# combinations - C# dictionary order of combinations

> ID：13585681
> 
> 赞同：1
> 
> 时间：2012-11-27T13:49:16.100
> 
> 标签：combinations

I need to iterate, for some values of k, on all [combinations](http://en.wikiversity.org/wiki/Lexicographic_and_colexicographic_order) of taking k items out of a vector V containing N items. For example if N = 6 and k = 3 then I have to call F() on items V[1](http://en.wikiversity.org/wiki/Lexicographic_and_colexicographic_order), V[2](https://math.stackexchange.com/questions/233125/0-1-knapsack-like-the-set-of-all-non-contained-affordable-binary-selections/236836#236836) and V[3], then on items V[1](http://en.wikiversity.org/wiki/Lexicographic_and_colexicographic_order), V[2](https://math.stackexchange.com/questions/233125/0-1-knapsack-like-the-set-of-all-non-contained-affordable-binary-selections/236836#236836) and V[4], ending with V[4], V[5] and V[6].

Now, going through all combinations of the index is easy. Say k = 3 and N = 6\. Then the first element can go from 1 to N-(k-1), the second from 2 to N-(k-2), the k'th from k to N (i.e. N-(k-k)).

So, for k = 3 the loop would be:

```
for (uint a = 1, a <=  N-2, a++)
  for (uint b = a + 1, b <= N-1, b++)
    for (uint c = b + 1, c <= N, c++)
     F(V[a], V[b], V[c]) 
```

and, for k = 4, the iteration would be:

```
for (uint a = 1, a <=  N-3, a++)
  for (uint b = a + 1, b <= N-2, b++)
    for (uint c = b + 1, c <= N - 1, c++)
       for (uint d = c + 1, d <= N, d++)
          F(V[a], V[b], V[c], V[d]) 
```

The question, however, is: **How do you accomplish this k-level nesting for an arbitrary k without hard coding it (or using code generation)?**

**Edit**: For background (a.k.a. THIS IS NOT HOMEWORK :)) please see Hans Engler's answer to my Math Stackexchange quesion: [0-1 knapsack like - the set of all non-contained affordable binary selections](https://math.stackexchange.com/questions/233125/0-1-knapsack-like-the-set-of-all-non-contained-affordable-binary-selections/236836#236836)

**Edit**: I'll provide a sample. Suppose V= {1,2,3,4,5}.

For k=2 I want F to be called in the following order: F(1,2), F(1,3), F(1,4), F(1,5), F(2,3), F(2,4), F(2,5), F(3,4), F(3, 5) and F(4,5).

For k=3 I want F to be called in the following order: F(1,2,3), F(1,2,4), F(1,2,5), F(2,3,4,), F(2,3,5), F(3,4,5)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:34:21.763

您的代码示例正在生成唯一的组合，而不是排列。无论顺序如何，组合都是唯一的。例如，如果您的数据看起来像这样 - 123、231、321，那么您将使用排列。组合属于二项式系数的范围。

我用 C# 编写了一个类来处理处理二项式系数的常用函数。它执行以下任务：

1.  将任何 N 选择 K 的所有 K 索引以良好的格式输出到文件。K-indexes 可以替换为更具描述性的字符串或字母。

2.  将 K 索引转换为已排序二项式系数表中条目的正确索引。这种技术比依赖迭代的旧已发布技术快得多。它通过使用帕斯卡三角形固有的数学属性来做到这一点。

3.  将已排序二项式系数表中的索引转换为相应的 K 索引。我相信它也比旧的迭代解决方案更快。

4.  使用[Mark Dominus](http://blog.plover.com/math/choose.html)方法计算二项式系数，它不太可能溢出并且适用于更大的数字。

5.  该类是用 .NET C# 编写的，并提供了一种通过使用通用列表来管理与问题相关的对象（如果有）的方法。此类的构造函数采用一个名为 InitTable 的 bool 值，当它为 true 时，将创建一个通用列表来保存要管理的对象。如果此值为 false，则不会创建表。无需创建表即可使用上述 4 种方法。提供了访问器方法来访问表。

6.  有一个关联的测试类，它显示了如何使用该类及其方法。它已经用 2 个案例进行了广泛的测试，并且没有已知的错误。

要了解此类并下载代码，请参阅[制表二项式系数](http://tablizingthebinomialcoeff.wordpress.com/)。

以下代码将按顺序遍历这组组合：

```
int N = 6;  // Total number of elements in the set.
int K = 3;  // Total number of elements in each group.
int[] V = new int[N]; // Holds the vector of numbers.
// Create the bin coeff object required to get all
// the combos for this N choose K combination.
BinCoeff<int> BC = new BinCoeff<int>(N, K, false);
int NumCombos = BinCoeff<int>.GetBinCoeff(N, K);
int[] KIndexes = new int[K];
// Loop thru all the combinations for this N choose K case.
for (int Combo = 0; Combo < NumCombos; Combo++)
{
   // Get the k-indexes for this combination.
   BC.GetKIndexes(Loop, KIndexes);
   // Do whatever processing with the V array that needs to be done.
   // Code to print the values out in C#:
   String S = V[KIndexes[0]].ToString() + ", " + V[KIndexes[1]].ToString() + ", " + 
      V[KIndexes[2]].ToString();
   Console.WriteLine(S};
} 
```

你应该能够很容易地将这个类移植到你选择的语言上。您可能不必移植类的通用部分来实现您的目标。根据您使用的组合数量，您可能需要使用比 4 字节整数更大的字长。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T14:29:31.103

这闻起来像家庭作业，[没关系](https://meta.stackexchange.com/questions/10811/how-to-ask-and-answer-homework-questions)，但你应该指出这是家庭作业。

无论如何，当您看到自己陷入一系列没有明确结束的循环时，递归很可能会有所帮助。考虑下面的课程。我将把函数 F() 的内容留空，但为您指明一条合理的路径（我认为）：

```
class Program
{
    private void F(int[] vector, int k)
    {
        if (vector.Length > 0)
        {
            // TO DO: operate on the first k elements of vector
            // Question: what conditions will throw an exception?
            Console.WriteLine("now operating on vector of length: " + vector.Length);

            // Re-define vector and re-apply F()
            vector = vector.Skip(1).Take(vector.Length - 1).ToArray();
            F(vector, k);
        }

    }

    static void Main(string[] args)
    {
        int[] vector = { 0, 1, 1, 2, 3 };
        int k = 3;

        try
        {
            Program p = new Program();
            p.F(vector, k);
        }
        catch (Exception ex)
        {

            Console.WriteLine("Unhandled exception: " + ex.Message);
            System.Environment.Exit(1);
        }
        finally
        {
            if (System.Diagnostics.Debugger.IsAttached)
            {
                Console.Write("Any key to continue...");
                Console.ReadKey();
            }
        }
    }
} 
```

# php - CodeIgniter 无法发布数据

> ID：13585685
> 
> 赞同：0
> 
> 时间：2012-11-27T13:49:24.157
> 
> 标签：php, codeigniter, post

我尝试在 Codeigniter 中进行简单的用户登录，但我无法通过 Post 获取表单数据。

看简单代码控制器

```
class User extends CI_Controller{

function login(){

    $this->load->helper('form');
    $this->load->library('form_validation');

    $this->form_validation->set_rules('username', 'username', 'required');
    $this->form_validation->set_rules('password', 'password', 'required');
    $this->form_validation->set_error_delimiters('<em>','</em>');

    if($this->input->post('weiter')){

        if($this->form_validation->run()){
            echo "okay";

        }
    }else{
        $this->load->view("templates/header");  
        $this->load->view("user/login");
        $this->load->view("templates/footer");
    }

} 
```

}

路由配置

```
 $route['user/login'] = 'user/login'; 
```

表格：

```
<?php echo form_open("user/login");?>
<table>

    <tr>
        <td><label for="username">Username</label></td>
        <td><input type="text" name="username"></td>
    </tr>
    <tr>
        <td><label for="password">Passwort</label></td>
        <td><input type="password" name="password"></td>
    </tr>
    <tr>
        <td><input type="submit" name="weiter"></td>
        <td></td>
    </tr>
</table> 
```

当我使用 Chrome 中的开发人员工具查看时，它会发布但返回状态是 404，为什么，我可以帮助某人吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-02T00:09:37.887

Have you tried using base_url() ? maybe you have a problem in your .htaccess. try to use the code below.

```
 <?php 
    echo form_open(base_url('user/login'));
   ?>
   <table>

<tr>
    <td><label for="username">Username</label></td>
    <td><input type="text" name="username"></td>
</tr>
<tr>
    <td><label for="password">Passwort</label></td>
    <td><input type="password" name="password"></td>
</tr>
<tr>
    <td><input type="submit" name="weiter"></td>
    <td></td>
    </tr>
 </table>
     <?php echo form_close(); 
       ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T15:34:23.050

我能看到的问题是你的 form_open("user/login"); 没有返回正确的 url，只需将其删除并测试，使用以下代码查看

```
<form method="post">
<table>

    <tr>
        <td><label for="username">Username</label></td>
        <td><input type="text" name="username"></td>
    </tr>
    <tr>
        <td><label for="password">Passwort</label></td>
        <td><input type="password" name="password"></td>
    </tr>
    <tr>
        <td><input type="submit" name="weiter"></td>
        <td></td>
    </tr>
</table>
</form> 
```

`$route['user/login'] = 'user/login';`如果您不将控制器名称或方法名称更改为值，则可以选择删除不需要的路由规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T11:35:39.443

好的，问题已解决，虽然不好，但可以。我已在 config.php 中将属性 index_page 设置为“”以获得清晰的 URL，但是当设置“index.php”时一切正常...

不知道这是否正常

# php - PHP键存在于数组中

> ID：13585687
> 
> 赞同：1
> 
> 时间：2012-11-27T13:49:36.060
> 
> 标签：php, arrays

我有三个数组：

```
$arr_1 = array('a'=>1,'b'=>2);  
$arr_11 = array('a'=>1, 'd'=>4);  
$arr_2 = array('a'=>'aaa','b'=>'bbb', 'c'=>'ccc'); 
```

我想检查 $arr_1 中的所有键是否存在于 $arr_2 中。

```
someFunction($arr_1,$arr_2); //return true  
someFunction($arr_11,$arr_2); //return false 
```

我知道如何使用“foreach”循环来做到这一点。
有没有更好的办法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T13:51:38.863

也许

```
<?php

array_diff(array_keys($arr_1), array_keys($arr_11));

?> 
```

更短是的，更快不知道:)

来自@deceze 的更新

```
<?php 

array_diff_key($arr_1, $arr_11);

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:52:05.800

这是检查是否所有键`$arr1`都存在于中的另一种方法`$arr2`：

```
function check($v){
    return array_key_exists($v,$arr_2);
}
count(array_filter(array_keys($arr_1),"check")) == count($arr_1); // true 
```

请注意，虽然您可能没有自己编写循环，但不可避免地任何类型的数组中键的搜索都会涉及到一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T13:56:19.910

您可以在 while 循环中使用[`array_key_exists()`](http://php.net/manual/en/function.array-key-exists.php)or ：`isset()`

```
$found_missing_key = false
$keys = array_keys($array1);
foreach($keys as $key) {
    if(!isset($array2[$key])) {
        $found_missing_key = true;
        break;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T13:52:12.603

自己写`someFunction`，并在里面使用循环。循环`array_key_exists`是执行此操作的方法，但是如果您将其包装在一个函数中，则可以避免将来再次执行此操作。

**更新**

```
function arrayKeyCompare($control, $variable) {
    foreach (array_keys($control) as $key) {
        if (!array_key_exists($key, $variable)) return false;
    }

    return true;
} 
```

# c# - C# SynML 客户端

> ID：13585689
> 
> 赞同：0
> 
> 时间：2012-11-27T13:49:41.367
> 
> 标签：c#, asp.net, syncml, funambol

我正在开发一个 ASP.NET + C# 网站，我需要一个库或组件来连接到 SyncML 服务器（funambol 服务器）以同步网站和 SyncML 服务器之间的联系人

我需要它用 C# 编写并管理所有 SyncML 东西（连接到服务器，将我的联系人同步到服务器并给我从服务器发送的联系人

我发现 Funambol 有很多客户端，但都是用 java 和 c++ 编写的，我没有将它们转换为 C# 的经验

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-10T19:04:13.790

这是 sourceforge 上的一个项目

[同步MLDotNet](http://sourceforge.net/projects/syncmldotnet/?source=directory)

我自己没试过

# spring - 在数据源（多个 DS、Spring、Hibernate）以编程方式设置用户名/密码

> ID：13585693
> 
> 赞同：1
> 
> 时间：2012-11-27T13:50:02.083
> 
> 标签：spring, hibernate, datasource, credentials, sessionfactory

我正在使用 Struts2、Spring 和 Hibernate 开发一个多数据源 Web 门户。我在将用户凭据设置为我的一个数据源时遇到问题，这些凭据在应用程序启动时不可用，但在用户登录时不可用。它适用于第一个门户用户，但对每个后续用户都失败。

对于每个数据源，都会创建一个会话工厂，它通过 spring 配置获取底层数据源集。

我的四个数据源中的三个通过配置设置了它们的数据库登录凭据，**但其中一个必须使用门户用户的凭据**。请注意，我的 bean 在会话范围内。

这是我的数据源配置：

```
<!-- data source with credentials from configuration -->
<bean id="dataSource1" class="org.springframework.jdbc.datasource.DriverManagerDataSource" scope="session">
    <property name="driverClassName" value="${jdbc.driverClassName}" />
    <property name="url" value="${jdbc.url}" />
    <property name="username" value="${jdbc.username}" />
    <property name="password" value="${jdbc.password}" />
</bean>

<!-- data source that authenticates with user credentials from login. -->
<bean id="dataSource2" class="org.springframework.jdbc.datasource.DriverManagerDataSource" scope="session">
    <property name="driverClassName" value="${ds2.jdbc.driverClassName}" />
    <property name="url" value="${ds2.jdbc.url}" />
</bean> 
```

这是我的会话工厂配置：

```
<bean id="sessionFactory1" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean" scope="session">
    <property name="dataSource">
        <ref bean="dataSource1" />
    </property>

    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.Oracle10gDialect</prop>
            ...
        </props>
    </property>

    <property name="mappingResources">
        <list>
            <value>hibernate/AnotherDTO.hbm.xml</value>
            ...
        </list>
    </property>
</bean>

<bean id="sessionFactory2" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean" scope="session">
    <property name="dataSource">
        <ref bean="dataSource2" />
    </property>

    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.Oracle10gDialect</prop>
            ...
        </props>
    </property>

    <property name="mappingResources">
        <list>
            <value>hibernate/MyDTO.hbm.xml</value>
            ...
        </list>
    </property>
</bean> 
```

门户用户的用户名和密码只有在成功登录门户后才可用，因此必须以编程方式将它们设置为数据源之一 (dataSource2)。

我通过让 Spring 将数据源插入到我的登录操作 (Struts2) 中来实现这一点，然后在每次登录后使用提供的 setter 方法在数据源处设置用户名和密码。

```
@Qualifier("dataSource2")
private DriverManagerDataSource dataSource2;

private void postAuthenticate() {

        dataSource2.setUsername(user);
        dataSource2.setPassword(password);

} 
```

我的 DAO 将会话工厂插入构造函数中，并将其传递给 HibernateDaoSupport（是的，我使用 HibernateTemplate，请不要讨论他的观点 ;-)）：

```
public class MyDAO extends HibernateDaoSupport {
    @Autowired
    public MyDAO(@Qualifier("sessionFactory2") SessionFactory pSessionFactory) {
        setSessionFactory(pSessionFactory);
    }
    ...
} 
```

**现在，这对于第一个使用门户的用户来说效果很好。**在门户的起始页上，显示了来自使用 dataSource2 的 DAO 的项目列表。**但是，每个登录到门户的以下用户都不会从我的 dataSource2 中获得任何结果。**不会引发异常，也不会出现日志消息，因为存在与数据库的有效连接，仅使用其他人的凭据（因此不会为第二个用户返回合适的结果）。

我的假设是，Hibernate 或 Spring 不会以某种方式从前一个用户的会话工厂丢弃旧连接并继续使用它，或者忽略我在新数据源中设置的新凭据。

谁能为我的问题提供一些见解或有用的提示（或解决方案！）？我想知道使用具有在应用程序启动时不可用但在用户登录时不可用的用户凭据的数据源是否真的那么难，并且没有可用的简单通用方法（我在网络上的任何地方都没有找到合适的解决方案）。

非常感谢。

# tcpdf - 在 TCPDF 中使用 WriteHTMLCell 时强制文本适合单元格

> ID：13585695
> 
> 赞同：4
> 
> 时间：2012-11-27T13:50:19.493
> 
> 标签：tcpdf

我花了一个多小时研究这个，我似乎找不到答案。

我在 TCPDF 中使用 writeHTMLCell 。使用 writeHTMLCell 时，我需要一些文本以适应特定区域。

我在[这里（php）](http://www.tcpdf.org/examples/example_004.phps) 和[这里（pdf）看到了一个例子](http://www.tcpdf.org/examples/example_004.pdf)

在使用 Cell 时进行文本拉伸和缩放等，但我想在使用 writeHTMLCell 而不是“Cell”时拉伸或缩放文本以“适合”该区域。

这可能吗 ？请指教。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:39:41.667

我设法实现这一点的方法是使用该`writeHTMLCell`方法废弃并使用`Cell`. 必须将您的 HTML 转换为使用该`Cell`方法是一件很痛苦的事情，尤其是如果您想使用 CSS 样式。我花了很多小时试图用 writeHTMLCell 完成与 Cell 相同的拉伸能力，最后我只是将所有的定位、样式等转换为`Cell`元素。

有很大帮助的一件事是发现`Cell`and的定位`writeHTMLCell`完全不同。该`writeHTMLCell`方法指定一个 x 和 y 坐标，该坐标与文本内容一起以 long 形式传递。该`Cell`元素实际上使用了完全不同的定位系统，因为您必须**事先**定义要将“光标”移动到的位置。例如，

```
$pdf->SetXY(50, 50); 
```

将光标移动到 50, 50 坐标，然后通过写 a`Cell`它将根据该坐标定位该元素。[关于设置 XY 的官方文档](http://www.tcpdf.org/doc/code/classTCPDF.html#a00ec13928f57b17c21040acc881fe482)

所以我基本上可以只取出前两个参数`writeHTMLCell`并将它们移动到`SetXY`. 一旦你按照`Cell`你想要的方式格式化和定位元素。TCPDF 中的拉伸/缩放功能非常出色。我希望有一个更好的解决方案来解决这个问题，但我决定使用 Cell 会是一个更好的选择。

希望这可以帮助！;)

# mysql - Ruby On Rails: CanCan with Devise error 'undefined method `find_by_name' for #

> ID：13585698
> 
> 赞同：1
> 
> 时间：2012-11-27T13:50:34.410
> 
> 标签：mysql, ruby-on-rails-3, devise, cancan

我对cancan很困惑，我试图从我的mysql数据库中获取cancan的角色。我正在使用一个没有显示/编辑/销毁之类的操作的控制器（我认为它被称为非 RESTful 控制器？）。我的用户表中有一个 Role_id 列，我的角色表中有一个 id 和 rolename。

我得到的只是这个错误：

未定义的方法 `find_by_name' 用于#

```
Ability.rb:
 class Ability
      include CanCan::Ability
      def initialize(user)
        can :manage, :all if user.role? :admin
    end
    end 
```

这是我的 User.rb：

```
User.rb:
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable, :confirmable,
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me, :username, :firstname, :lastname, :birthday
  # attr_accessible :title, :body

  validates_uniqueness_of :username
  belongs_to :role

def role?(role)
    return !!self.role.find_by_name(role.to_s.camelize)
end
end 
```

角色.rb：

```
class Role < ActiveRecord::Base
  has_many :users
  attr_accessible :users, :name 
end 
```

这里是我正在使用的控制器：

```
class WsdlController < ApplicationController
 authorize_resource :class => false
    $liga_id = 456
    $liga_short = "bl1"
    $saison = 2012

    def connect
        @client = Savon::Client.new("http://www.openligadb.de/Webservices/Sportsdata.asmx?WSDL")
        @output = ""
    end

    def get_all_for_new_saison
        if @client.nil?
            connect
        end
        #get_teams_by_league_saison
        #get_matchdata_by_league_saison
    end 
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T06:45:13.927

`find_by_name`是一个`ActiveRecord` **类方法**。（请参阅[Active Record 查询接口](http://guides.rubyonrails.org/active_record_querying.html)指南）您正在像**实例方法**一样调用它。

尝试改变这个：

```
def role?(role)
    return !!self.role.find_by_name(role.to_s.camelize)
end 
```

像这样：

```
def role?(role_name)
    return self.role.present? && self.role.name == role_name.to_s
end 
```

当然，在 ruby​​ 中，`return`和`self`都是可选的。

# c++ - 访问主函数内部的私有数据

> ID：13585711
> 
> 赞同：0
> 
> 时间：2012-11-27T13:50:55.857
> 
> 标签：c++

main.cpp 内部

```
class vivek
{
    int i;
    float d;
public:
    vivek()
    {
        i = 4;
        d = 4.44;
    }
    ~vivek()
    {
        cout << "destructor" << i;
    }
    int get()
    {
        return i;
    }
};

int main()
{
    vivek *viku = new vivek;
    vivek *p;

    p = viku;
    cout << (*(int*) (p));
    getchar();

    return 0;
} 
```

通过上面的代码我可以访问变量 i ，但我想知道如何访问变量 d 。

我知道这个概念是不可取的，因为它违反了封装..但我只想知道我们怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:14:30.147

虽然它非常hacky，但它*是*可能的，因为它`vivek`是一个标准布局结构。这意味着您可以这样做：

```
#include <iostream>

// copied from original
class vivek {
  int i;
  float d;
public:
  vivek() {i = 4; d = 4.44; }
  ~vivek() { cout<<"destructor"<<i; }
  int get() { return i; }
};

struct vivek_sneaky_accessor {
  int i;
  float d;
};

int main() {
  vivek v;
  vivek_sneaky_accessor *acc = reinterpret_cast<vivek_sneaky_accessor*>(&v);
  std::cout << acc->d;
  return 0;
} 
```

这依赖于 [class] 点 7 和 8（*标准布局结构*的定义）以及 [class.mem] 点 17 和 20（标准布局结构的布局兼容性）。

**免责声明**我绝不提倡这是合理的做法。我只是说这实际上是可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T14:22:23.130

我会冒险投反对票，因为我认为您这样做是为了理解指针。

也许，你所期待的是这样的：
`int * x=reinterpret_cast<int *>(p);
x++;
cout<<*reinterpret_cast<float *>(x);`

哪个有效，并且可能适用于您遇到的大多数编译器。但是，有很多原因可以说明您不能做这样的事情。

[访问权限的使用和滥用](http://www.gotw.ca/gotw/076.htm)是**必读**的。

另请注意，该标准清楚地评论了由访问说明符分隔的成员的顺序。从[另一个](https://stackoverflow.com/questions/916600/can-a-c-compiler-re-order-elements-in-a-struct)软答案：

> 分配没有中间访问说明符的（非联合）类的非静态数据成员，以便后面的成员在类对象中具有更高的地址。由访问说明符分隔的非静态数据成员的分配顺序未指定 (11.1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T13:54:06.197

在班上`vivek`

```
public:
  float getD() {
    return this -> d;
  } 
```

并在您的代码中调用它，如下所示：

```
std::cout << (p -> getD()) << std::endl; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T13:58:23.803

如果您想要/需要访问它们，请将它们设为`public`. 这就是 . 的意义所在`public`，这意味着该类的用户可以查看和更改`public`.

有人可能会告诉你，这“破坏了封装”。但是，如果您只需要该类保存一些值，并且您不需要做任何花哨的事情，那么公开数据成员就不是问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-27T14:31:58.573

冒着被语言律师否决的风险，这里有一些黑客的建议给你，希望它可能会很有趣。私有成员不应该从类和类的朋友之外访问。但是，如果您绝对必须访问该类的那些成员字段，那么像这样的 hack 可能会起作用：

```
#include <iostream>

class vivek {
    int   i;
    float d;

  public:
    vivek() : i(4), d(4.44) {}
    ~vivek() {}
};

int main()
{
    vivek viku;
    struct badhack {
        int   i;
        float d;
    } *h = (sizeof(badhack) == sizeof viku ? (badhack*)&viku
            : ((badhack*)((char*)&viku + sizeof(void*))));
    std::cout << "i=" << h->i << ", d=" << h->d << std::endl;
} 
```

请注意使用 sizeof 的游戏——这只是确定一个虚拟表的示例，该表采用`sizeof(void*)`字节并且是类中的第一个隐式字段，是否应该有任何虚拟成员。如果你不这样做并且一个类恰好有一个虚拟表，那么数据偏移量就会被搞砸，这个技巧将不起作用，所以这就是我们按`sizeof(void*)`字节调整偏移量以避免这个问题的原因。现在，这不是由标准定义的并且是特定于编译器的，但我从未遇到过以不同方式实现虚拟表的编译器，因为这是最有效的方式。

另一种选择就像这样简单：

```
#include <iostream>

#define class struct
#define private public

class vivek {
    int   i;
    float d;

  public:
    vivek() : i(4), d(4.44) {}
    ~vivek() {}
};

int main()
{
    vivek viku;
    std::cout << "i=" << viku.i << ", d=" << viku.d << std::endl;

    return 0;
} 
```

但是请注意，上述内容很可能不适用于成员函数。如今的编译器很聪明，并且根据访问级别不同地修改函数名称。

并且请不要使用这样的技巧，除非有必要挽救某人的生命并且您愿意牺牲自己的生命作为回报。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-27T14:32:30.730

虽然当然可以将您的对象视为字节序列并直接摆弄这些字节，但这是一个非常糟糕的主意。拥有类和对象的全部意义在于让您不必考虑数据在内存中的实际布局方式。

# javascript - Socket.io 错误处理

> ID：13585712
> 
> 赞同：17
> 
> 时间：2012-11-27T13:50:59.153
> 
> 标签：javascript, node.js, sockets, socket.io

我遇到了 Socket.IO 的问题。

我正在尝试在套接字错误后重新连接套接字，但它不会重新连接。这是代码：

```
socket = io.connect(host, options);
socket.on('connect', this.onConnect);
socket.on('error', function() {
    //here i change options
    socket = io.connect(host, options);
}); 
```

为什么它不创建新的连接？（主机和端口保持不变，它适用于第一个连接）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-08-28T20:22:07.543

尝试将选项添加`{ 'force new connection': true }`到`io.connect`. 听起来它没有重试连接。

除非您指定此选项，否则套接字 IO 不会重新连接到它已经尝试过的主机。

这是一个带有内联指定选项哈希的片段：

```
io.connect(host, {
  'force new connection': true
}); 
```

您可以在此处了解有关选项的更多信息：[https ://github.com/LearnBoost/Socket.IO/wiki/Configuring-Socket.IO](https://github.com/LearnBoost/Socket.IO/wiki/Configuring-Socket.IO)

# php - 从网络摄像头捕获图像并存储在 php 中的数据库中

> ID：13585714
> 
> 赞同：0
> 
> 时间：2012-11-27T13:51:08.683
> 
> 标签：php, flash, codeigniter, webcam

我有一个捕获图像的闪存代码。这是代码：

```
<object id="main" width="300" height="400" align="middle" type="application/x-shockwave-flash" name="main" data="<?php echo JS_PATH;?>bin-debug/dev.swf">
    <param name="quality" value="high">
    <param name="bgcolor" value="#ffffff">
    <param name="allowscriptaccess" value="sameDomain">
    <param name="allowfullscreen" value="true">
    <param name="flashvars" value="<?php echo HTTP_PATH.DS?>user/changeprofilepic_byweb">
</object> 
```

在上面的代码中：

```
 <param name="flashvars" value="<?php echo HTTP_PATH.DS?>user/changeprofilepic_byweb"> 
```

value 参数包含控制器的路径，其中函数 changeprofielpic_byweb 包含更新 profiel 图像的代码。我无法更新图像。我哪里错了？我的闪存代码是正确的吗？我的闪存代码工作正常，它可以捕获图像，但它没有存储到数据库中。这是控制器的代码：

```
 function changeprofilepic_byweb() 
    {
         echo "<script> alert('In to the function'); </script>";
        $sess_data = $this->session->userdata('logged_in');
        $this->load->library('photoslibrary');
        $this->load->Model('usersocialprofile');
        $upload_path = COMM_USER_IMAGE_PATH.$sess_data['user_id']; 

        if(!is_dir($upload_path)) 
        {
            umask(0);
            @mkdir($upload_path,077);
        }

        $db_userprofile = $this->usersocialprofile->getThumb($sess_data['user_id']);

        if(is_file(COMM_USER_IMAGE_PATH.$sess_data['user_id'].DS.$db_userprofile[0]->imageTitle)) 
        {
            $this->usersocialprofile->unlinkImage($db_userprofile[0],PROFILE_IMAGE_THUMB);

        }

        $this->load->helper("Image");
        $fileImage="";
        $data['error']="";

        $fileext='jpeg';    
        $timestamp=md5(time());
        $filename="photo".$timestamp.".".$fileext;

        $filesize = floatval((filesize($filename)/1024)/1024); // bytes to MB  
        list($width, $height, $type, $attr) = getimagesize($filename);

        $req_size=explode(",",PROFILE_IMAGE_THUMB);
        $req_size=explode("x",$req_size[0]);

        if($width<$req_size[0] || $height<$req_size[1])
        {
            $data['error']="Image required minimum ".$req_size[0]."x".$req_size[1]." pixels";
        }else {

            $data['error']="";
            $newthumb_path = "thumb".DS;

        if(!is_dir($newthumb_path))  {
            umask(0);
            @mkdir($newthumb_path,0777);
        }                

        $fileImage=imageresize($filename,$filetempname,PROFILE_IMAGE_THUMB,$upload_path.DS,false,true,true,$newthumb_path);
        $result=$this->usersocialprofile->updateImage($sess_data['user_id'] , $fileImage);
        }
    } 
```

我认为该函数不是由闪存代码调用的。我没有收到任何错误。只是显示捕获的图像，但没有在文件夹中更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T11:13:13.500

要使用网络摄像头上传图像，您只需创建图像并获取设置为闪存代码的变量的值。在获取图像时，您只需使用任何 get 或发布方法。类似的东西：

```
 $fileext='jpeg';    
    $timestamp=md5(time());
    $filename="photo".$timestamp.".".$fileext; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-09T01:12:02.443

下面的答案是展示如何启用用户媒体捕获图像并存储到数据库中。

**注意**：当在画布上绘制图像时，在此代码中始终使用 base64 扩展名，我将使用 php 将 base 64 转换为图像并将其存储在数据库中，同时将其存储在我的图像目录中。

**Javascript代码**

```
//define DOMelements
cameraBtn = document.getElementById('camera');
floatPage1 = document.getElementById('floatPage1');
innerPage = document.getElementById('innerPage');
canvas = document.getElementById('canvasVideo');
//closing webcam
closeBtn = document.getElementById('closeBtn');

captureBtn = document.querySelector('.captureBtn');

navigator.getUserMedia = navigator.getUserMedia || 
                         navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.oGetUserMedia || navigator.msGetUserMedia;

//code below
//adEvents to the buttonclicked....
cameraBtn.addEventListener("click",buttonclickTrigger,true);
closeBtn.addEventListener("click",closeStream,true);
////////////////////////////////////////////////////////////////////////////
function buttonclickTrigger(){
  floatPage1.style.display = "block";
  innerPage.style.display = "block";
  canvas.style.display = "block";
  navigator.getUserMedia({video:
        {height:canvas.height,width:canvas.width}},function(stream){
        videoStream = stream;
        video = document.createElement("video");
        video.src= window.URL.createObjectURL(videoStream);
        video.onloadedmetadata = function(){
        $this = this;
            function canvasPlay(){
                if(!this.paused && !this.ended){
                    cSrc = canvas.getContext("2d");
                    canvasVideo = cSrc.drawImage(video,0,0);
                   }
            }
            setInterval(canvasPlay,1000/30);
            //capture image from the canvas code.....
            captureBtn.onclick = function(){
                canvas.getContext("2d").drawImage(video,0,0);
                var image = new Image();
                image.src = canvas.toDataURL("image/png");
                image = image.src;
                console.log(stream.getTracks()[0]);
                mediaUsed = stream.getTracks()[0].label;
                imageUniqueId = stream.getTracks()[0].id;
                $.ajax({
                    url:"imagesave.php",
                    method:"POST",
                    data:{image:image,mediaUsed:mediaUsed},
                    dataType:"html",
                    success:function(data){
                        alert(data);
                    } 
                });
            }
        }
    },function(err){
        alert(err);
    });
 } 
```

**php代码**

```
<?php
define ("UPLOAD_DIR","../images/");
$imageName = $_POST["image"];
$mediaUsed = $_POST["mediaUsed"];
$imageCreate = explode(";base64,",$imageName);
$image_type_aux = explode("image/", $imageCreate[0]);
$valadid_extension = $image_type_aux[1];
$convertimage = base64_decode($imageCreate[1]);
#generate random id for the image and append them.
$time = time();
$random= "circlestudio_".md5($time);
$image = UPLOAD_DIR.$random."_".uniqid() . '.png';
$fullImage = file_put_contents($image,$convertimage);

move_uploaded_file($fullImage);
$imagesplit = explode(UPLOAD_DIR,$image);
$canvas_imageFullName = $imagesplit[1];
echo $image;
?> 
```

# hyperlink - 如何在詹金斯中显示gcov html结果

> ID：13585721
> 
> 赞同：1
> 
> 时间：2012-11-27T13:51:44.330
> 
> 标签：hyperlink, jenkins, gcov

我想`index.html`在 Jenkins 中显示 gcov 结果文件。我尝试使用*侧边栏链接插件*。但我不知道如何配置路径，如： `/home/jenkins/.jenkins/jobs/platform_linux_test_report/code_coverage/121127/index.html`

我得到如下错误：

```
Status Code: 404
Exception:
Stacktrace:

(none) 
```

任何人都知道如何使用它？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T15:41:20.010

我认为您使用了错误的插件。您可能想改用[HTML Publisher Plugin](http://wiki.jenkins-ci.org/display/JENKINS/HTML+Publisher+Plugin)。它允许您添加在构建中创建的任意 HTML 页面（站点）。

# javascript - 如何将文本区域的内容复制到剪贴板？

> ID：13585722
> 
> 赞同：0
> 
> 时间：2012-11-27T13:51:44.777
> 
> 标签：javascript, jquery

> **可能重复：**
> [如何在 JavaScript 中复制到剪贴板？](https://stackoverflow.com/questions/400212/how-to-copy-to-the-clipboard-in-javascript)

我有一个`html markup`多数民众赞成在回响并被包裹在一个`textarea`和它也是一个只读像这样：

```
<textarea rows="4" cols="70" readonly="readonly">text with markup goes here.</textarea> 
```

当用户单击只读文本区域内容时，我该如何做到这一点，它将被自动选择并复制到剪贴板并通知它已经复制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:57:50.503

PHP 是服务器端的，因此您将无法与客户端交互。就客户端而言，javascript 可以做一些事情。坏消息是，据我回忆，Firefox 不再允许这样做（我记得看到一些关于 TinyMCE 剪贴板功能的争论），所以你可能需要一些混合 flash 和 js 的东西才能完全交叉-浏览器解决方案。

因此，我可以建议[http://code.google.com/p/zeroclipboard/](http://code.google.com/p/zeroclipboard/)作为一种可能性吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T13:56:21.543

你为什么要 PHP，试试这个：

```
function copy(inElement) {
 if (inElement.createTextRange) {
  var range = inElement.createTextRange();
 if (range)
   range.execCommand('Copy');
} else {
  var flashcopier = 'flashcopier';
  if(!document.getElementById(flashcopier)) {
  var divholder = document.createElement('div');
   divholder.id = flashcopier;
  document.body.appendChild(divholder);
}
   document.getElementById(flashcopier).innerHTML = '';
   var divinfo = '<embed src="_clipboard.swf"        FlashVars="clipboard='+encodeURIComponent(inElement.value)+'" width="0" height="0"      type="application/x-shockwave-flash"></embed>';
document.getElementById(flashcopier).innerHTML = divinfo;
}
 } 
```

```
<form name="formtocopy" action="" >
<textarea name="texttocopy" disabled="disabled">
A whole bunch of text here that will be copied.
</textarea>
<br>
<a href="javascript:copy(document.formtocopy.texttocopy);">Copy the Text!</a>
</form> 
```

# javascript - 运行，除非我点击按钮

> ID：13585726
> 
> 赞同：0
> 
> 时间：2012-11-27T13:52:08.263
> 
> 标签：javascript

这是我在页面javascript中的代码，我的问题是我第一次单击按钮并转到第二页并且一切顺利，但是当我再次返回此页面时，`$("consulter").live('click',function(e)`除非我单击，否则按钮的功能将运行按钮

我该如何解决这个问题

```
 $('#lbtn').append('<input type="button" value="Consulter" id="consulter" >');

$("consulter").live('click',function(e)
         {

    alert("eere");
        var sel_id_rub = $('input[name=opt1]:checked').attr('id');//ID of Rubrique

         window.localStorage.setItem("id_rub", sel_id_rub);       //Id Rubrique
         liste_Phrase();

     }
     ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:54:45.187

选择器是错误的，但我不知道这是否是问题：

```
$("#consulter").live('click',function(e) 
```

# java - 将时间戳从毫秒转换为本地时区的日期或日历

> ID：13585732
> 
> 赞同：0
> 
> 时间：2012-11-27T13:52:23.593
> 
> 标签：java

我得到一个带有毫秒和时区的字符串，例如“1353913216000+0000”，所以基本上是UTC时间。如何将其转换为我的当地时间？我不认为我可以使用 DateFormat，没有毫秒模式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:18:23.363

你可以使用类日历

```
 Calendar c= Calendar.getInstance(TimeZone.getTimeZone("GMT+2"));
    c.setTime(new Date(System.currentTimeMillis()));

    System.out.println(new Date(c.getTimeInMillis()+TimeZone.getTimeZone("GMT+2").getOffset(c.getTimeInMillis()))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:03:43.730

如果您不能使用内置解析器之一，您可以执行以下操作：

1.  解析出数字`+`并转换为长整数。
2.  使用此编号创建`Date`实例
3.  使用以 结尾的日期格式`+zone`将日期转换为字符串
4.  用输入中的时区替换时区
5.  解析具有相同日期格式的新字符串

# ruby - 如何获取方法的类绑定？

> ID：13585734
> 
> 赞同：0
> 
> 时间：2012-11-27T13:52:28.913
> 
> 标签：ruby, reflection, methods

拿

```
class A; def foo; end; end
class B < A; end
b = B.new          # => #<B:0x0000000243b8c0>
m = b.method :foo  # => #<Method: B(A)#foo>
m.owner            # => A
m.receiver         # => #<B:0x0000000243b8c0>
m.receiver.class   # => B
mm = m.unbind      # => #<UnboundMethod: B(A)#foo> 
```

我怎么`B`能从`mm`缺少解析结果中得到`mm.to_s`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:38:35.590

我花了一些时间查看[proc.c](https://github.com/ruby/ruby/blob/trunk/proc.c "proc.c")，但我认为这是不可能的。`B`存储在`rclass`其中，据我所知，它在任何地方都无法访问。[您可以在此处](https://github.com/ruby/ruby/blob/trunk/proc.c#L1893)查看它的使用方式，尽管我认为这也无济于事。

请问你为什么需要这样做？也许还有另一种方法可以解决一般问题:)

# javascript - 在 IE 中设置 window.open(url, windowname) 不满足，使用现有的打开窗口？

> ID：13585739
> 
> 赞同：0
> 
> 时间：2012-11-27T13:52:48.743
> 
> 标签：javascript, html, internet-explorer

我正在使用 window.open 打开一个新窗口。并在 IE 中执行以下操作：

```
<a href="/someurl" onclick="window.open(href, 'myname', '...'); 
```

但是窗口会在 IE8 下打开一个新窗口，如果我再次单击我的链接，是否应该打开窗口保留现有窗口，因为我使用的是命名窗口？在这种情况下，当用户单击链接时，会出现一个新窗口。对于Chrome和IE下的一些浏览器配置，打开的窗口可以正常工作。

是否有一些安全设置或某些场景为什么 window.open 会以这种方式行事？

此外，在该窗口内，还会重定向到位于不同主机的第三方站点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:17:58.573

*在IE*下与外部命名窗口有类似的问题。窗口焦点也有问题。这个自定义（并且非常棘手）功能对我来说很好用*IE*，*FF*和*Chrome*：

```
function openWindowWithFocus(url, name, features) {

        if (!name || name == '') {
            name = 'DefaultWindow'
        }

        if (!window[name] || window[name].closed == null || window[name].closed) {
            window[name] = window.open(url, name, features);
        } else {
            window[name].location.replace(url);
        }

        window[name].focus();

    } 
```

# elasticsearch - 更像这样的数组

> ID：13585740
> 
> 赞同：3
> 
> 时间：2012-11-27T13:52:49.340
> 
> 标签：elasticsearch, morelikethis

每个文档都有一个包含每个元素权重的数组。如何获得最相似的文档数组。我认为 more_like_this 功能相同，但带有文本。当然需要通过elasticsearch的工具来实现。

[“str”：int，“str”：int，...]

# algorithm - 多维快速排序算法

> ID：13585741
> 
> 赞同：1
> 
> 时间：2012-11-27T13:52:51.947
> 
> 标签：algorithm, computer-science, quicksort

我正在阅读 C++ RobertSedwick 的算法中的多维排序，如下所示。

为了处理多维排序，其中排序键是向量，并且要重新排列记录，以便键的第一个分量是有序的，然后第一个分量相等的那些按第二个分量排序，依此类推。如果组件没有重复的 kdey，则问题归结为对第一个组件进行排序；然而，在典型应用中，每个组件可能只有几个不同的值，并且是三向分区（移动到中间分区的下一个组件。

我对上述文字的问题是

1.  作者所说的第一部分，第二部分是什么意思？
2.  如果组件没有重复的键，那么作者的意思是什么问题减少到对第一个组件进行排序？

感谢您的时间和帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:58:19.560

作者正在描述映射中键的[字典顺序](http://en.wikipedia.org/wiki/Lexicographical_order)。想象一下，您有一个值对列表：

```
(4 3), (2 3), (1 4), (4 2) 
```

每对中的第一个被称为“第一个组件”，第二个当然是“第二个组件”。这些项目的字典顺序是：

```
(1 4), (2 3), (4 2), (4 3) 
```

我们如何做到这一点？首先，这些对按它们的第一个组件排序。第一个组件是`4, 2, 1, 4`按顺序排列的`1, 2, 4, 4`。但是有两个四。我们可以通过它们的第二个组件进一步排序它们，例如`(4 2)`之前`(4 3)`的。

当然，它们不必成对。您可以将字典顺序应用于具有任意数量值的元素。它们按第一个组件排序，然后是第二个，然后是第三个，依此类推。

这种排序的名称来自我们如何对多种语言中的单词进行排序。给定三个名字，约翰、吉姆和爱丽丝，我们如何为它们排序？首先我们按第一个字母排序，然后是第二个字母，依此类推。这些名字的字典顺序是 Alice、Jim、John。

在作者的描述中，这种排序被用于对地图的键进行排序。也就是说，这些对被映射到某个值。例如，键可以是一对，值是一个字母：

```
(4 3) => A, (2 3) => B, (1 4) => C, (4 2) => D 
```

在按字典顺序对键进行排序后，这些字母的顺序将是`C, B, D, A`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T14:02:14.947

1-如果您有例如 3 件物品：

```
A: {1 2 3 4 5}
B: {2 5 5 5 5}
C: {2 6 6 6 6} 
```

A 的第一个分量是 1，B 和 C 是 2

2-如果您必须对 A 和 B 进行排序，因为 A 的第一个组件 < B 的第一个组件，您不必再进一步，也不必像您那样比较第二个元素做比较 B 和 C

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T13:58:50.823

作者所说的第一部分，第二部分是什么意思？

数组中的第一个、第二个元素。这是： int arr1[] = {1,2,3,4}, arr2[] = {5,6,7,8} arr1 的第一个分量是 1，arr2 的第一个分量是 5。

如果组件没有重复的键，那么作者的意思是什么问题减少到对第一个组件进行排序？

> 如果数组中的所有第一个元素都不同，则只需对第一个元素进行排序。

# google-apps-script - 导航到其他页面谷歌应用脚 本 UiApp

> ID：13585750
> 
> 赞同：1
> 
> 时间：2012-11-27T13:53:17.393
> 
> 标签：google-apps-script

有人可以向我解释如何在谷歌应用脚​​本中导航到新页面吗？我最初的想法是隐藏或删除应用程序中的所有子元素，然后相应地重建它。这是正确的方法吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T15:46:55.443

一种方法是让不同的面板代表不同的页面。最初隐藏除第一页以外的所有页面，然后取消隐藏后续页面

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T16:11:30.820

Srik 已经为页面导航/组织提供了一种非常常见的方法。

这是另一种使用查询字符串属性分叉到不同 UI 路径的方法。这具有获得活动“微调器”的额外好处。

您可以在下面的这个链接中看到它的运行情况，下面的代码为其提供动力。希望这提供了另一个视角。

[https://script.google.com/macros/s/AKfycbx68wR5HmCbil_LY8LlMd2m16_xNEdEtXq7-YfgqsMPqeoe-E3L/exec](https://script.google.com/macros/s/AKfycbx68wR5HmCbil_LY8LlMd2m16_xNEdEtXq7-YfgqsMPqeoe-E3L/exec)

```
function doGet(e) {
  var app = UiApp.createApplication();
  var page = e.parameter.page

  //add a default page
  if(!page){
    page = '1';  
  }

  if(page === '1'){
    var label = app.createLabel('You are in page 1.')

    var anchor = app.createAnchor("Next page",ScriptApp.getService().getUrl()+"?page=2");
    anchor.setTarget('_self');

    app.add(label);
    app.add(anchor);
  }
  else if(page === '2'){
    var label = app.createLabel('You are in page 2, now.')

    var anchor = app.createAnchor("Go back",ScriptApp.getService().getUrl()+"?page=1");
    anchor.setTarget('_self');

    app.add(label);
    app.add(anchor);
  }

  return app;
} 
```

# java - 基于 Java Hashtable 的聊天应用程序

> ID：13585755
> 
> 赞同：0
> 
> 时间：2012-11-27T13:53:50.370
> 
> 标签：java, chat, hashtable

我正在将 Hashtable 用于使用 google 应用引擎的 http 聊天应用程序。我从 Hashtable 得到奇怪的行为。有时，当我尝试使用 Hashtable.get(id) 方法查找 id 时，它会返回 null。我需要你的帮助，这对这样的聊天应用程序有好处吗？对于像聊天应用程序这样的谷歌应用引擎，有没有更好的 java 数据结构？谢谢您的帮助..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:57:57.247

Hashtable.get(id) 如果表中没有 name id 的键，则返回 null，因此需要测试是否为 null。Hashtable 是一个非常适合应用程序的数据结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:08:26.670

如果您的应用程序需要同时处理多个线程，Hashtable 是一个不错的选择。否则，人们通常使用 HashMap，因为时间不会浪费在确保只有一个线程访问数据结构上。由于查找时间是常数时间，因此它们都具有出色的性能。你需要确保你已经用所需的值填充了哈希表，否则你会得到一个空值。

# ruby-on-rails - 如何使用 ActiveRecord 查询获取 Schema Postgres 的值大小

> ID：13585770
> 
> 赞同：0
> 
> 时间：2012-11-27T13:54:24.733
> 
> 标签：ruby-on-rails, postgresql, activerecord, schema, multi-tenant

我有使用 Rails 3 + Postgresql 的多租户应用程序我想获取模式的大小..

在 size_cotroller.rb 上

```
class SizesController < ApplicationController

     def index

      @tablesize = ActiveRecord::Base.connection.select_rows(%q{select pg_size_pretty(CAST((SELECT SUM(pg_total_relation_size(table_schema || '.' || table_name) ) FROM information_schema.tables WHERE table_schema = 'schema2') As bigint) )  As schema_size})
     end

end 
```

但输出显示：

[[“264 KB”]]

如何取大小的值？

**例子**

264

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:11:11.157

假设格式总是`[["### kB"]]`，一种方法（在 Ruby 中）是做一些字符串操作

```
[1] pry(main)> [["264 kB"]].to_s.gsub(/\D/, '').to_i
=> 264 
```

# android - 如何定位一个android小部件

> ID：13585782
> 
> 赞同：0
> 
> 时间：2012-11-27T13:55:02.713
> 
> 标签：android, android-layout, widget

这是我的代码

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="horizontal" 
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:padding="10dp">
 <ImageView android:id="@+id/imgIcon"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:gravity="center_vertical"
    android:layout_alignParentTop="true"
     android:layout_gravity="right"
    android:layout_alignParentBottom="true"
    android:layout_marginRight="15dp"
    android:layout_marginTop="5dp"
    android:layout_marginBottom="5dp" />
 <TextView android:id="@+id/txtTitle"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="center_vertical|right"
    android:layout_alignParentTop="true"
    android:layout_alignParentBottom="true"
    android:textStyle="bold"
    android:textSize="10dp"
    android:layout_gravity="left"
    android:textColor="#000000"
    android:layout_marginTop="5dp"
    android:layout_marginBottom="5dp" /> 
```

结果是这样的，textview在右边，旁边（左边）是imageview我想改变它，我想在右边显示图像，在左边显示文本

我应该怎么办 ？我尝试了我所知道的一切，但它们没有用谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:11:53.750

在 xml 文件中交换它们。将 TextView 放在 ImageView 之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-15T20:13:40.890

试一试：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal"
    android:padding="10dp" >

    <TextView
        android:id="@+id/txtTitle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginBottom="5dp"
        android:layout_marginTop="5dp"
        android:textColor="#000000"
        android:textSize="10sp"
        android:textStyle="bold" />

    <ImageView
        android:id="@+id/imgIcon"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:layout_marginBottom="5dp"
        android:layout_marginRight="15dp"
        android:layout_marginTop="5dp" />

</LinearLayout> 
```

我删除了相对布局的布局属性，因为您使用的是线性布局。此外，重力属性也不是必需的（至少根据您的问题）。最后，对文本使用“sp”，而不是“dp”。

# javascript - ASPNET MVC 4 应用程序中的 Jquery 脚本顺序

> ID：13585787
> 
> 赞同：8
> 
> 时间：2012-11-27T13:55:19.723
> 
> 标签：javascript, jquery, asp.net-mvc, jqgrid, asp.net-mvc-4

我正在使用 jqgrid 开发一个 ASPNET MVC 4 项目。

在那里，ASPNET MVC 4 默认放置

```
@Scripts.Render("~/bundles/jquery") 
```

在 _Layout.cshtml 文件的末尾。

现在，我有一个使用 jqgrid 的 Index.cshtml

```
<script type="text/javascript">
    jQuery("#ajaxGrid").jqGrid({ 
```

所以我必须包括 jqgrid 脚本，如

```
@section jqgridScripts
{
    <script src="@Url.Content("~/Scripts/jqgrid/i18n/grid.locale-en.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jqgrid/js/jquery.jqGrid.min.js")" type="text/javascript"></script>
} 
```

但是在使用 .jqgrid 之前，我需要加载 jqgrid 脚本，而这又需要加载 jquery 脚本，因此，jquery 脚本需要位于 _Layout.cshtml 文件的顶部而不是末尾。

根据最佳实践 jquery 脚本需要在文件末尾加载，但如果我这样做，在 Index.cshtml 文件中它不知道 jQuery 是什么。

我不能将 jqquery 脚本和下面的 jqgrid 脚本放在 _Layout.cshtml 文件的底部，因为上面是使用 jqgrid 脚本的 Index.cshtml 文件内容。

为了能够将jQuery放在最后并且仍然能够在视图中使用jquery，我是否缺少一些东西？

谢谢！吉列尔莫。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-27T15:10:27.310

__Layout.cshtml：

```
@Scripts.Render("~/bundles/jquery")
@RenderSection("jqgridScripts", required: false);

@* for script in current page *@
@RenderSection("pageScripts", required: false); 
```

索引.cshtml：

```
@section pageScripts
{
<script type="text/javascript">
    jQuery("#ajaxGrid").jqGrid({
    ... 
</script>
} 
```

但最好的做法是为您的代码创建一个单独的 javascript 文件，如下所示：

__Layout.cshtml：

```
@Scripts.Render("~/bundles/jquery")
@RenderSection("pageScripts", required: false); 
```

索引.cshtml：

```
@section pageScripts
{
    <script src="@Url.Content("~/Scripts/jqgrid/i18n/grid.locale-en.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jqgrid/js/jquery.jqGrid.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/Site/myscript.js")" type="text/javascript"></script>
} 
```

myscript.js：

```
$(function() {

   jQuery("#ajaxGrid").jqGrid({ ... });

}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T13:59:14.887

我也遇到过这个问题。不捆绑 jQuery 本身似乎有点违反直觉，但这是必须要做的。在标题中向上抛出一个 jQuery 脚本引用。如果您将 jQuery 脚本 src 属性设置为缩小的 google 托管实例的属性，那么脚本很可能已经缓存在您的客户端中。

[这是一个很好的参考...](https://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go "谷歌托管 jquery 参考")

# jquery - 复选框上的 jQuery mouseup 事件无法正常工作？

> ID：13585788
> 
> 赞同：0
> 
> 时间：2012-11-27T13:55:28.643
> 
> 标签：jquery, arrays, checkbox

我正在尝试捕获选定的复选框，以便通过 AJAX 将其发送出去。但是我只能一键获取选定的元素；也就是说，“elm”循环不会将我第一次单击复选框识别为选中的复选框；只有当我第二次点击时，它才会吐出那个元素。在第三次点击时，它会发出第一次和第二次点击，但不是第三次。

```
$(".datatype").mouseup(function() 
{
    /* check keyword */
    var searchbox = document.forms['formIndex'].searchbox.value;

    /* check datasetype */
    var vals = [], datasettype =  document.forms['formIndex']['datasettype[]'];
    for(var i=0,elm;elm = datasettype[i];i++)
    {
        alert(i + ': ' + elm.value);
        if(elm.checked)
        {
            alert(i + ': ' + elm.value);
            vals.push(elm.value);
        }
    }
    contents = vals.join(','); 
```

HTML 代码：

```
<fieldset>
  <legend style="font-size: 1.2em; font-weight: bold; border: 1px solid aaa" for="selectedRegion">Data Set Type</legend>
  <input type="checkbox" class="datatype" name="datasettype[]" value="1">National<br />
  <input type="checkbox" class="datatype" name="datasettype[]" value="3">Sub-Regional<br />
  <input type="checkbox" class="datatype" name="datasettype[]" value="2">Regional<br /> 
```

谁能给我一个提示为什么会这样？非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:00:42.453

我认为您需要使用`change`事件而不是`mouseup`

```
$(".datatype").change(function() 
```

# css - CSS - 行跨度效果

> ID：13585789
> 
> 赞同：15
> 
> 时间：2012-11-27T13:55:35.403
> 
> 标签：css

我只是想实现左列有两个合并行而右列没有合并的效果。我怎样才能实现这种布局？

html 表看起来像 -

```
<table border="1" >
  <tr>
    <td rowspan="2">Div 1</td>
    <td> Div 2 </td>
  </tr>
  <tr>
    <td>Div3</td>
  </tr>
</table>​​​​​​ 
```

编辑：我想使用 Div 来实现这一点。我会将用户控件放在每个 div 元素中。重要的是 Div3 从 div2 下方开始，而不是在 Div1 下方。

[对不起，这是第一篇，无法添加图片]

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T14:06:09.553

CSS

```
 body {
      margin: 0;
      padding: 50px;
      background-color: #FFFFFF;
      color: #000000;
      font-family: Arial, Helvetica, sans-serif;
    }
    .tablewrapper {
      position: relative;
    }
    .table {
      display: table;
    }
    .row {
      display: table-row;
    }
    .cell {
      display: table-cell;
      border: 1px solid red;
      padding: 1em;
    }
    .cell.empty
    {
      border: none;
      width: 100px;
    }
    .cell.rowspanned {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100px;
    }

<div class="tablewrapper">
      <div class="table">
        <div class="row">
          <div class="cell">
            Top left
          </div>
          <div class="rowspanned cell">
            Center
          </div>
          <div class="cell">
            Top right
          </div>
        </div>
        <div class="row">
          <div class="cell">
            Bottom left
          </div>
          <div class="empty cell"></div>
          <div class="cell">
            Bottom right
          </div>
        </div>
      </div>
    </div> 
```

**演示**：[http ://www.sitepoint.com/rowspans-colspans-in-css-tables/](http://www.sitepoint.com/rowspans-colspans-in-css-tables/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-07T16:12:24.127

2017 年引入了网格布局正是为了这个目的，而且可能更复杂。

在您的情况下，您可以使用例如`inline-grid`+ `grid-template-areas`：

```
#page {
  display: inline-grid;
  grid-template-areas: "aside main"
                       "aside foot";
}

#page > aside {
  grid-area: aside;
  background: lightgreen;
}
#page > main {
  grid-area: main;
  background: lightpink;
}
#page > footer {
  grid-area: foot;
  background: lightblue;
}
```

```
<section id="page">
  <aside>aside 1</aside>
  <main>main 2</main>
  <footer>footer 3</footer>
</section>
```

# android - 从 Grid 中选择图像并将其显示在 android 应用程序的 Gallery View 中

> ID：13585792
> 
> 赞同：0
> 
> 时间：2012-11-27T13:55:52.050
> 
> 标签：android, image-gallery, android-gallery

我想从 Activity 的 GridView 中选择一个图像，并将其位置发送到 Gallery View 以将其显示为 Gallery 中的 CurrentView。我能够创建 Gallery Activity 和 GridView Activity。但是，当画廊活动启动时，我无法选择画廊当前图像位置。意味着我在第一个活动中的 GridVIew 中选择的项目应该是画廊活动中的当前可见项目。谁能告诉我一种在图库活动中选择当前显示的图像视图的方法。

我想我需要在我的图库适配器中进行一些更改。但我不清楚。请提供任何 API 代码片段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T18:37:13.780

找到了答案，简单的 API：

```
gallery.setSelection(currentImage); 
```

# windows - 使用 powershell windows server 2008 r2 将用户导入本地

> ID：13585795
> 
> 赞同：0
> 
> 时间：2012-11-27T13:55:58.923
> 
> 标签：windows, powershell, import, local

我得到了这个脚本：

```
$Users = Import-Csv C:\Users\Administrator\Desktop\userImport\userTest.csv
$Users | % { 

# Setting data
$computer = [ADSI]"WinNT://."
$userGroup = [ADSI]"WinNT://./Users,Group"

# Create user itself
$createUser = $computer.Create("User",$_.userid)

# Set password (print1!)
$createUser.SetPassword($_.password)
$createUser.SetInfo()

# Create extra data
$createUser.Description = "Import via powershell"
$createUser.FullName = $_.'full name'
$createUser.SetInfo()

# Set standard flags (Password expire / Password change / Account disabled)
$createUser.UserFlags = 64 + 65536 # ADS_UF_PASSWD_CANT_CHANGE + ADS_UF_DONT_EXPIRE_PASSWD
$createUser.SetInfo()

# Adduser to standard user group ("SERVER02\Users")
$userGroup.Add($createUser.Path)
} 
```

但我收到错误消息：无法将成员添加到本地组或从本地组中删除，因为该成员不存在。我怎样才能解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:46:51.630

尝试在此处更改`.`计算机名称：

```
$computer = [ADSI]"WinNT://." 
```

作为

```
$compname = hostname
$computer = [ADSI]"WinNT://$compname" 
```

# jquery - 尝试使用 jQuery Ajax delete 删除时收到警报

> ID：13585799
> 
> 赞同：4
> 
> 时间：2012-11-27T13:56:21.950
> 
> 标签：jquery, python

尝试删除值时出现以下弹出窗口。我正在使用 jQuery Ajax 删除该值。我使用的编程语言是python2.7，框架是Django 1.3.2

我的代码如下：

```
$.ajax({
    type: "DELETE",
    url: window.location.pathname + id + '/data-centers/' + dc,
    contentType: 'application/html; charset=utf-8',
    data: {
        dc : dc,
    },
    success: function(){
        alert("success");
    }
    etc... 
```

当我确认删除该值时，我从 JavaScript 中得到以下弹出窗口：

```
"This web page is being redirected to a new location. Would you like to resend  
 the form data you have typed to the new location? 
```

在 Ajax 标头中，我可以看到以下内容（它试图重定向到其他位置，但不知道为什么）：

```
Connection  Keep-Alive
Content-Encoding    gzip
Content-Length  251
Content-Type    text/html; charset=iso-8859-1
Date    Tue, 27 Nov 2012 13:53:44 GMT
Keep-Alive  timeout=5, max=100
Location    http://www.test.com/403/test-403.html
Vary    Accept-Encoding
Request Headers
Accept  */*
Accept-Encoding gzip, deflate
Accept-Language en-us,en;q=0.5
Connection  keep-alive
Content-Length  12
Content-Type    application/html; charset=utf-8 
```

这只发生在我尝试使用 DELETE 时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T09:41:39.013

根据您的代码，我发现可能是由于 ajax 的路径不正确或 ajax 调用 html 可能有一些重定向问题而发生了一些错误。因此，如果路径不正确，那么您可以设置不同类型的变量，如下所示

* * *

```
$(location).attr('href'); 
```

* * *

```
$(document).ready(function() {
    var pageurl = window.location;
}); 
```

* * *

```
var currentpageURL = window.location.href; 
```

* * *

```
var currentpagepath = getAbsolutePagePath();

function getAbsolutePagePath() {
    var pageurl = window.location;
    var pathName = pageurl.pathname.substring(0, pageurl.pathname.lastIndexOf('/') + 1);
    return pageurl.href.substring(0, pageurl.href.length - ((pageurl.pathname + pageurl.search + pageurl.hash).length - pathName.length));
} 
```

愿这对你有帮助

# c# - MvvM ViewModel 到 ViewModel 通信

> ID：13585805
> 
> 赞同：0
> 
> 时间：2012-11-27T13:56:35.263
> 
> 标签：c#, mvvm, viewmodel, mvvm-light

我有两个视图模型`ViewModelA`，`ViewModelB`它们都使用一个公共`DataServiceA`来检索名为`Theme`. `ViewModel`B 可以更改该设置并将其保存到数据库中。发生这种情况时，`ViewModelA`不会更新该主题值。
我一直在尝试找出正确的行动方案以允许它也对其进行更新，并提出了一些选择：

1.  保存值时使 DataService 引发属性通知（我不喜欢这样）
2.  使用 MessengerService 使它们保持同步。（我遇到了消息循环问题）
3.  将一个 ViewModel 传递给另一个

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:10:10.357

听起来像是使用事件的好案例，如果他们都可以访问 DataServiceA ，当主题改变时你能不引发事件吗？

所以.. 在 DataServiceA 中，修改主题时会引发“OnThemeChanged”事件，并且 ViewModel 可以订阅该事件并在引发时更新其内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:02:03.487

如果他们两个都使用相同的实例`DataServiceA`，我认为这不是一个坏主意，它`DataServiceA`也会实现**[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/ms229614.aspx)**`Theme`并在属性更改时引发事件。

但如果您不喜欢这个想法，另一种选择是使用**[EventAggregator](http://msdn.microsoft.com/en-us/library/ff921122%28v=pandp.20%29.aspx)**并发布事件。我个人认为第一个选项已经足够了，但这是你的决定......

# c# - 转换可空值 布尔

> ID：13585806
> 
> 赞同：0
> 
> 时间：2012-11-27T13:56:40.640
> 
> 标签：c#, c#-4.0

我得到了这个编译器错误：

> 不能隐式转换类型“bool？” '布尔'。存在显式转换（您是否缺少演员表？）。

对于以下代码：

```
 xEnable = was.xEnable; 
```

`xEnable`是 DB 中的一个可为空的列。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-27T13:59:08.107

这意味着

```
xEnable is of type bool 
```

和

```
was.xEnable is of type bool? (ie: nullable bool) 
```

做类似的事情

```
xEnable = was.xEnable.HasValue ? was.xEnable.Value : false; 
```

其中**false**是默认值，以防**was.xEnable == null**

**编辑** 或者如果你真的想要你可以使用**??** 运营商喜欢

```
xEnable = was.xEnable ?? true; 
```

或者

```
xEnable = was.xEnable ?? false; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T14:01:34.523

要实际使用`??`你的标题，去

```
xEnable = was.xEnable ?? false; 
```

如果你想`xEnable`成为`false`if `was.xEnable`is `null`，或者

```
xEnable = was.xEnable ?? true; 
```

如果你想`xEnable`成为`true`如果`was.xEnable`是`null`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T14:01:54.913

对于 C# 8.0 及更高版本，您可以`??`按照您的要求使用运算符，然后执行

```
xEnable = was.xEnable ?? false; 
```

如果你想`false`成为默认值 when `was.xEnable`is `null`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T13:59:35.520

如果你知道它`was.xEnable`不为空，你可以使用

```
xEnable = was.xEnable.Value 
```

如果要在 is 时使用默认值`was.xEnable`，`null`可以执行以下操作

```
bool defaultValue = false;
xEnable = was.xEnable ?? defaultValue; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T14:02:57.257

您是否尝试将空值实际传递给数据库？如果是这样的话：

```
xEnable = was.xEnable.HasValue ? was.xEnable.Value : DBNull.Value; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-27T14:03:17.360

```
bool a = false; 
bool? b = null; 
a = (bool)b; 
```

`b`如果is ，这将引发异常`null`。

所以可能的解决方案可能是：

*   你知道那`b`是*never* `null`，所以使用这种模式（不好）
*   也可以为`a`空， by `bool? a = false`;
*   检查, `null`_`b``a = (b == null)?false:b.Value;`

希望这可以帮助。

# javascript - xmlhttp 未定义。Javascript Ajax

> ID：13585807
> 
> 赞同：0
> 
> 时间：2012-11-27T13:56:47.463
> 
> 标签：javascript, ajax

我是 javascript 的新手，尤其是 ajax 的新手..只是想弄清楚..

我从一个教程中编写了这段代码，但找不到我做错了什么。[在这里你可以看到它的直播](http://private-db.net16.net/test/index.html)

我从 Firebug 得到的错误：“TypeError: xmlhttp is undefined [Break On This Error]

if (xmlhttp.readyState == 4){"

我的代码是

```
// JavaScript Document

var xmlhttp;
var url;

function ajaxFunction(){

if  (window.ActiveXObject){//if the window is InternetExplorer

    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

    }else if(window.XMLHttpRequest){// if Window is Firefox etc..

        xmmlhttp= new XMLHttpRequest();

        }else{

            alert ("Get a New Browser")

            }

}//end of ajaxFunction()

function getInfo(){

    ajaxFunction();

    var entryInfo= document.getElementById("entry").value;

            function stateChanged(){
                if (xmlhttp.readyState == 4){

                    document.getElementById("results").innerHTML = xmlhttp.responseText;

                    }//if (xmlhttp.readyState == 4)

                }//end of function stateChanged()

url = "info.php?user="+entryInfo;
xmlhttp.onreadystateshange=stateChanged();
xmlhttp.open("GET",url,true);
xmlhttp.send(null);

    }// end of function getInfo 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T13:58:56.563

你这里有一个错字：

```
 xmmlhttp= new XMLHttpRequest();
     ^ 
```

改成

```
 xmlhttp= new XMLHttpRequest(); 
```

同样正如迈克尔指出的那样，在分配 onreadystatechange 函数时有括号：

```
xmlhttp.onreadystateshange=stateChanged();
                                       ^ remove the () 
```

如果不去掉括号，`stateChange()`函数会被调用，返回值会给出`xmlhttp.onreadystateshange`你不想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-07T15:35:19.660

属性名称输入错误： `xmlhttp.onreadystateshange=stateChanged;`

它必须是`'onreadystatechange'`。

# java - java : 直接 gmail 网址

> ID：13585808
> 
> 赞同：3
> 
> 时间：2012-11-27T13:56:53.860
> 
> 标签：java, windows, email, gmail

我对这个网站完全陌生。我正在寻找我的问题的答案。但我看到这个网站上有人问过同样的问题。问题在 [这里](https://webapps.stackexchange.com/questions/18959/can-i-form-a-direct-url-to-a-particular-gmail-account) ，我使用的是 Windows 7。我没有在那个链接中得到答案..所以我再次问同样的问题。我想从 Java 应用程序在浏览器中打开一个 gmail 帐户链接。是的，我确实知道 Desktop 类中的 browse() 方法。问题是我可以打开gmail网站，但我需要在提供用户名和密码的情况下直接打开指定的gmail帐户。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:24:48.853

好的，因此请注意以下几点：1.我上次使用 Google API 是在旧版本中，所以现在可能会有很大不同，2.此代码未经测试，我只是在编写它部分来自记忆，部分来自我的一个旧项目。把它想象成更像是伪代码，并且 3\. 如果这是偶然的工作，这是一个非常肮脏的解决方案。希望这可以让您找到使用 API 执行此操作的更好方法。

```
GoogleOAuthParameters oauthParameters = new GoogleOAuthParameters();
oauthParameters.setOAuthConsumerKey( [insert consumer key here] );

oauthParameters.setOAuthConsumerSecret( [insert consumer secret here] );
OAuthSigner signer = new OAuthHmacSha1Signer();

GoogleOAuthHelper oauthHelper = new GoogleOAuthHelper(signer);

oauthParameters.setScope("https://mail.google.com/mail");  //no clue if this is a valid scope or not

oauthHelper.getUnauthorizedRequestToken(oauthParameters);
String requestUrl = oauthHelper.createUserAuthorizationUrl(oauthParameters);

Desktop desktop = Desktop.getDesktop();
URI url;
url = new URI(requestUrl);
//this will make the user log in to authorize your app
desktop.browse(url);

//auth token response from Google, you can use this to authenticate your app if there are other requests you want to make against the user account
String token = oauthHelper.getAccessToken(oauthParameters);

//since you made sure the user is logged into their account to authorize your app, their gmail can now just be opened.  Yes, very dirty.  I know. (if it all works)
desktop.browse("https://www.gmail.com/"); 
```

# android - 为开发者启动 Google Play 商店

> ID：13585809
> 
> 赞同：0
> 
> 时间：2012-11-27T13:56:57.543
> 
> 标签：android, google-play

我正在尝试使用以下代码从我的 Android 应用程序启动“开发人员应用程序”：

```
final Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setData(Uri.parse("market://search?q=pub:VenturezLab"));
startActivity(intent); 
```

Play 商店启动，但显示未找到任何应​​用。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:09:22.420

您需要指定您指向的不是包名称。

改为使用`market://search?q=pub:VenturezLab`。

# mysql - Mysql函数用描述替换多个id

> ID：13585810
> 
> 赞同：0
> 
> 时间：2012-11-27T13:57:01.643
> 
> 标签：mysql, function, loops, foreach, row

我需要一些帮助来创建一个疯狂的功能！

我有一张叫桌子`product`和一张桌子`country`。在这个产品表上，我有一个名为`CountriesId`id 的列`1,2,3,4`。

我需要创建一个存储函数，当我在产品表上进行选择时，我可以将 CountryId 列中返回的 id 替换为表中的描述`Country`。

例子：

```
SELECT * FROM Country; 
```

结果：

```
CountryId | CountryDescription
1         | U.S.A
2         | Japan
3         | China

SELECT * FROM Product; 
```

结果：

```
ProductId | ProductDescription | CountriesId
1         | Product 1          | 1,2,3

SELECT fnIdToDescription(CountriesId) AS Countries FROM Product; 
```

预期结果：美国、日本、中国国家

也许可以轻松制作，但我没有找到解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:04:24.103

如果您现在更改数据库设计，您现在和将来都会做得更好。它违反了第一规范化规则。

从表中删除`countryIds`列`Product`并创建一个新表`CountryProduct`来存储表之间的关系。例子：

```
CREATE TABLE CountryProduct
(
   countryId INT NOT NULL,      `
   productId INT NOT NULL,
   PRIMARY KEY (countryId, productId) 
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:44:54.987

我找到了一个名为 GROUP_CONCAT() 的函数，并使用 ID 上的子选择和 Description 列上的 GROUP_CONCAT() 解决了它。

谢谢大家。

# iphone - 调整 TableViewCell 大小以适应 RSS 提要详细信息

> ID：13585811
> 
> 赞同：0
> 
> 时间：2012-11-27T13:57:17.580
> 
> 标签：iphone, ios, xcode, tableview

我正在处理 RSS 提要，我正在考虑调整 TableViewCell 的大小以适应进来的标题/描述信息，我希望 Cell 显示所有文本而不是切断它......有人知道吗这样做的好方法或知道一个好的教程？

![在此处输入图像描述](../Images/e235c334c2af17255b095e8f7faaca0a.png)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:01:15.337

[您需要计算保存您的提要项目数据的单元格的高度，并在tableView:heightForRowAtIndexPath:](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDelegate_Protocol/Reference/Reference.html)中的表格要求时返回它。

此外，您需要说`UILabel`不要截断您的文本。为此，请查看[调整标签文本大小下的方法](http://developer.apple.com/library/ios/#documentation/uikit/reference/UILabel_Class/Reference/UILabel.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:05:29.060

您应该为此制作自定义 UITableViewCell。然后在您的 .xib 文件中设置正确的自动调整参数然后，在您的单元格 .m 文件中，您应该以这种方式实现 layoutSubviews 方法

```
- (void) layoutSubviews
{
    [super layoutSubviews];
    CGRect newFrame = rssLabel.frame;
    CGSize maximumLabelSize = CGSizeMake(rssLabel.frame.size.width,9999);
    CGSize expectedLabelSize = [rssLabel.text sizeWithFont:tweetLabel.font        constrainedToSize:maximumLabelSize lineBreakMode:rssLabel.lineBreakMode];
    int height = expectedLabelSize.height;
    newFrame.size.height = height;
    rssLabel.frame = newFrame;
} 
```

当然，我忘了说你应该计算你的行的高度

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T15:29:59.577

最好的方法是子类化`UITableViewCell`。在这个类中实现一个类方法来返回单元格的高度。在 tableview 的委托方法中`tableView:heightForRowAtIndexPath:`调用此方法并将您的文本传递给它。用途`NSString's` `sizeWithFont` `constrainedToSize` `lineBreakMode`：方法和计算高度。将标签的属性设置`noOfLines`为 0。你就可以开始了。

例如：-

```
+(CGFloat)heightForText:(NSString *)value{
     CGSize size = [value sizeWithFont:[UIFont systemFontOfSize:13] constrainedToSize:CGSizeMake(320, MAXFLOAT)];
     if(size.height<MINIMUM_CELL_HEIGHT){
         return MINIMUM_CELL_HEIGHT;
     }else{
    return size.height;
     }
 } 
```

# java - 无法从选择框获取值到 servlet

> ID：13585813
> 
> 赞同：0
> 
> 时间：2012-11-27T13:57:22.313
> 
> 标签：java, jsp, servlets, jstl

尝试将选中的选择框值（一次打开）与文本框值一起提交给 servlet；这是我的代码（jsp）：

```
<script type="text/javascript">
function search(){
document.f2.action="/InfoUser/SearchBox";
document.f2.submit();
}
</script>

<form name="f2">
<div align="right">
<select id="select" name="select" style="color:#2D7EE7">
<option> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ----------- </option>
<option value="a">A</option>
<option value="b">B</option>
<option value="c">C</option>
</select> 
<input type="text" name="search" style="color:#2D7EE7">
<input type="submit" value="Search" onclick="search()">
</div>
</form> 
```

并在 servlet 中：我写过

```
String[] select = request.getParameterValues("select");
String search = request.getParameter("search"); 
```

无法在 servlet 中获取值，我是否缺少一些 javascript/jquery 脚本来获取 servlet 中的值以及如何在`JSTL`. ，将受到欢迎。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T14:00:43.757

尝试更改您的表格：

```
<form action="/InfoUser/SearchBox">
    <div align="right">
        <select id="select" name="select" style="color:#2D7EE7">
            <option> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -----------</option>
            <option value="a">A</option>
            <option value="b">B</option>
            <option value="c">C</option>
        </select>
        <input type="text" name="search" style="color:#2D7EE7">
        <input type="submit" value="Search">
    </div>
</form> 
```

或者：

```
<script type="text/javascript">
    function search(){
        document.f2.action="/InfoUser/SearchBox";
        document.f2.submit();
    }
</script>

<form name="f2">
    <div align="right">
        <select id="select" name="select" style="color:#2D7EE7">
            <option> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ----------- </option>
            <option value="a">A</option>
            <option value="b">B</option>
            <option value="c">C</option>
        </select>
        <input type="text" name="search" style="color:#2D7EE7">
        <input type="submit" value="Search" onclick="search()">
    </div>
</form> 
```

您缺少表单的名称，并且在您的 javascript 中您试图在不存在的表单上设置操作。

在 servlet 中，您必须执行以下操作：

```
String select = request.getParameter("select");
String search = request.getParameter("search"); 
```

您将无法使用：`String[] select = request.getParameterValues("select");`除非您的选择元素将具有`multiple="true"`.

# visual-studio-2010 - C++ srand 函数循环

> ID：13585816
> 
> 赞同：1
> 
> 时间：2012-11-27T13:57:37.207
> 
> 标签：visual-studio-2010, visual-c++, loops, srand

作为密码生成程序的一部分，我有以下方法来生成随机密码，然后对其进行验证。

我的问题是 srand 函数从不满足验证要求并不断循环返回以创建新密码。

我在下面发布代码，询问是否有人有更有效的方法来创建随机密码，以便满足验证要求，而不是连续循环。谢谢。

```
static bool verifyThat(bool condition, const char* error) {
    if(!condition) printf("%s", error);
    return !condition;
}

//method to generate a random password for user following password guidelines.  
void generatePass()

{
    FILE *fptr;//file pointer
    int iChar,iUpper,iLower,iSymbol,iNumber,iTotal;

    printf("\n\n\t\tGenerate Password selected ");

    get_user_password:
    printf("\n\n\t\tPassword creation in progress... ");

    int i,iResult,iCount;
    char password[10 + 1];
    char strLower[59+1] = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRTUVWXYZ!£$%^&*";

    srand(time (0));

    for(i = 0; i < 10;i++)
    {
        password[i] = strLower[(rand() % 52)];

    }
    password[i] = '\0';

    iChar = countLetters(password,&iUpper,&iLower,&iSymbol,&iNumber,&iTotal);

    //folowing statements used to validate password
    iChar = countLetters(password,&iUpper,&iLower,&iSymbol,&iNumber,&iTotal);
    iUpper = countLetters(password,&iUpper,&iLower,&iSymbol,&iNumber,&iTotal);
    iLower =countLetters(password,&iUpper,&iLower,&iSymbol,&iNumber,&iTotal);
    iSymbol =countLetters(password,&iUpper,&iLower,&iSymbol,&iNumber,&iTotal);
    iNumber = countLetters(password,&iUpper,&iLower,&iSymbol,&iNumber,&iTotal);
    iTotal = countLetters(password,&iUpper,&iLower,&iSymbol,&iNumber,&iTotal);

    if(verifyThat(iUpper >= 2, "Not enough uppercase letters!!!\n")
     || verifyThat(iLower >= 2, "Not enough lowercase letters!!!\n")
     || verifyThat(iSymbol >= 1, "Not enough symbols!!!\n")
     || verifyThat(iNumber >= 2, "Not enough numbers!!!\n")
     || verifyThat(iTotal >= 9, "Not enough characters!!!\n")
     || verifyThat(iTotal <= 15, "Too many characters!!!\n"))

    goto get_user_password;

    iResult = checkWordInFile("dictionary.txt", password);

    if(verifyThat(iResult != gC_FOUND, "Password contains small common 3 letter word/s."))
    goto get_user_password;

    iResult = checkWordInFile("passHistory.txt",password);

    if(verifyThat(iResult != gC_FOUND, "Password contains previously used password."))
    goto get_user_password;

    printf("\n\n\n Your new password is verified ");
    printf(password);

    //writing password to passHistroy file.

    fptr = fopen("passHistory.txt", "w");   // create or open the file
    for( iCount = 0; iCount < 8; iCount++)
    {
        fprintf(fptr, "%s\n", password[iCount]);
    }

    fclose(fptr);

    printf("\n\n\n");
    system("pause");

}//end of generatePass method. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T11:57:50.927

我一目了然地查看了您的代码，我想我已经找到了原因，尽管不满足验证要求。

我建议您注意代码的以下部分：
1）`char strLower[59+1] = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRTUVWXYZ!£$%^&*";`

在这里您应该**添加数字 0..9**，这是无法满足要求的原因之一，因为*如果数字不在您选择的数字集中，如何选择？！*
替换它为前。和：

```
char strLower[] = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRTUVWXYZ!£$%^&*0123456789"; 
```

2) `password[i] = strLower[(rand() % 52)];`- 在这部分代码中，用您随机选择数字**的字符串中的符号总数****替换。** 我建议您将其替换为以下代码： `52`

 **```
password[i] = strLower[(rand() % (sizeof(strLower) / sizeof(char) - 1))]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T14:08:34.497

你可以改变你的算法。

*   随机选择一些大于 2 的 Upper 字符。
*   随机选择2个以上的Lower字符。
*   随机选择多个大于 1 的 Sybmol 字符。
*   随机选择一些大于 2 的 Number 字符。

然后用随机项目重新组合您的密码，随机重新排序。填写您想要通过 verifyThat 谓词的任何字符：>=9 和 <= 15。

请：不要使用 goto。而是进行函数调用。**

# date - 包含小时数的日期的 OLAP 维度层次结构

> ID：13585819
> 
> 赞同：1
> 
> 时间：2012-11-27T13:57:54.433
> 
> 标签：date, ssas, hierarchy, olap

我需要创建下一个层次结构：月-> 月中的周-> 周中的日-> 日中的小时。

我使用 SQL Server Business Intelligence Development Studio 2008 中的“维度向导”来创建新维度。当我尝试通过选择“在服务器上生成时间表”来创建维度时，可以选择的最小时间段是“日期”。如何将小时数添加到层次结构中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:09:44.267

正如您所说，SQL 时间维度的最低粒度是日期。您需要同时创建 DimDate 和 DimTime。以下文章提供了时间维度的分步说明。

[代码项目](http://www.codeproject.com/Articles/25852/Creating-Time-Dimension-in-Microsoft-Analysis-Serv)

# xcode - 具有关键路径的核心数据谓词

> ID：13585822
> 
> 赞同：1
> 
> 时间：2012-11-27T13:57:56.557
> 
> 标签：xcode, cocoa-touch, core-data, relationships, predicates

所以我正在尝试弄清楚如何使用这些谓词，我已经阅读了 Apple 文档并尝试使用它（https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates /Articles/pUsing.html) 并且我已经设置了谓词，但它不断得到线程 1：EXC_BAD_ACCESS (code =) etc.etc。

```
 NSError *error;
    NSLog(@"1");

    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
   NSEntityDescription *entity = [NSEntityDescription entityForName:@"Fruit" inManagedObjectContext:managedObjectContext];
    [fetchRequest setEntity:entity];
  NSLog(@"2");
    NSPredicate *predicate = [NSPredicate predicateWithFormat:
                              @"Source.sourceName contains[cd] %@", "Apple Tree"];

    [fetchRequest setPredicate:predicate];
    NSLog(@"3");
    NSArray *fetchResult = [managedObjectContext executeFetchRequest:fetchRequest error:&error];
    NSLog(@"4");
    testLbl.text = [fetchResult objectAtIndex:0]; 
```

这就是我正在使用的代码，至于我们拥有的核心数据......

实体水果和来源

属性fruitName & sourceName

关系（一对一）fruitSource<--------->sourceFruit

我想做的是拔出苹果树上的任何果实...>.<

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:46:04.843

有两个不同的问题：

1.  要从`Fruit`相关关系中获取，`Source`您必须使用关系：`@"fruitSource.sourceName contains ..."`而不是`@"Source.sourceName contains ..."`.

2.  （这可能是导致异常的原因。）该`%@`格式需要一个 Objective-C 对象作为参数，而不是一个 C 字符串：`@"Apple Tree"`而不是`"Apple Tree"`.

所以谓词应该是这样的：

```
[NSPredicate predicateWithFormat:@"fruitSource.sourceName CONTAINS[cd] %@", @"Apple Tree"] 
```

# regex - reg 表达式中的数值取反

> ID：13585825
> 
> 赞同：0
> 
> 时间：2012-11-27T13:58:04.163
> 
> 标签：regex, jmeter

我的脚本中有以下响应，我只需要从低于值中捕获 4 个并传递给下一个请求

```
4,7,6,115,116. 
```

这里`115`和`116`是动态值。但我`116`直接从响应中获得动态值。

我尝试过，`(.^?),7,6`但有很多具有相同边界的值。所以，我想`115`从捕获的行中取反`4`。

```
(.^?),7,6,{Dontknow},${temp} 
```

你能告诉我`115`表达式中否定的函数吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:03:35.697

也许“否定”是指“不应该”，所以试试这个：

```
^(.*?),7,6,(?!115).*?,${temp} 
```

我输入了一个负面的前瞻性，要求第四个 tern*不是*`115`.

还修复了无意义的`(.^?)`

# sql-server - 将表数据从表插入到另一个表

> ID：13585831
> 
> 赞同：0
> 
> 时间：2012-11-27T13:58:25.687
> 
> 标签：sql-server, sql-server-2008

我正在尝试使用 SQL Server 2008 从一个数据库插入另一个数据库。

我正在尝试从“EG-COMPUTER1\FTLIVE”插入到“EG-COMPUTER2\FTSTANDBY”。

基本上从一台计算机上的数据库到同一网络上另一台计算机上的同一数据库。

我怎么能做到这一点？

注意：我可以连接到同一台计算机上的两个数据库，所以必须有一种简单的方法可以从一个数据库插入另一个数据库？

编辑：：

只是补充一下，一台计算机正在使用 SQL Server 2008-R2，另一台计算机正在使用 SQL Server 2008

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:14:48.603

有几种方法可以做到这一点。

```
 1\. RightClick On DataBase -> Tasks -> Import -> Import Export wizard ->Choose Source database -> choose Destination database -> choose Copy data from One or more table -> choose required tables -> Import.

     2.RighClick On Database -> Task -> Generate Script -> Choose tables -> Advanced -> Change "Types of Data to Script " to "Schema and Data or data or schema(as required)" -> Change "script Drop and Create" to Drop and Create(optional) - > create.
Copy the script file/files and run in the other computer.

     3.Right Click the database -> task -> BackUp -> create backup -> take the back up to other computer(.bak file can be found inside the Backup directory inside installation directory)  -> right click the database -> task -> restore   -> choose the bakup file -> done.

     4\. Can use sql azure migration tool  http://sqlazuremw.codeplex.com/ (similar to step 1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T14:02:55.653

如果您只想使用数据库级别的数据传输，那么您应该将这两个实例配置为链接服务器[(msdn doc)](http://msdn.microsoft.com/en-us/library/ms188279.aspx)。

否则，如果您熟悉 Java（或任何提供与数据库交互的 API 的高级语言），您可以编写一个简单的程序，从一台服务器的表中检索数据并插入到另一台服务器的表中（更快无需联系 DBA 来配置链接服务器）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T15:31:47.920

我找到了我需要做的，这是：

```
INSERT INTO [DatabaseNameA].[dbo].[Table]  
([Column1],[Column2] etc...)
SELECT 
[Column1],[Column2] etc...
 SET IDENTITY_INSERT [DatabaseNameB].[dbo].[Table] On;
GO 
```

这将选择我要从中选择的数据库，打开 identity_insert 以便可以插入数据并将数据从一个数据库传输到另一个数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T14:56:43.130

如果这不是经常性活动，您可以使用[OpenRowSet ，否则如果您需要经常执行操作，那么您应该创建](http://msdn.microsoft.com/en-us/library/ms190312.aspx)[链接服务器](http://msdn.microsoft.com/en-us/library/ms188279.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T14:49:43.500

尼斯瓦

请验证您的登录是否可以访问这两个表。如果两个表都可以访问，则尝试将一个数据库表复制到另一个数据库表，否则从一个数据库表创建一个视图并将该视图传输到另一个数据库表。

在那里你可以完成你需要的任务。这是最佳实践方法，将来您也可能不会遇到性能问题。

如果您没有兴趣执行此任务，则只需按照以下查询

**插入 ur-tablename(column-names) select sourcedbname.schemaname.column-name1 , sourcedbname2.schemaname.column-name ... from sourcedatabsename.schemaname.tablename**

# client - XMPP 通知服务代替 GCM / APNS

> ID：13585836
> 
> 赞同：1
> 
> 时间：2012-11-27T13:58:40.633
> 
> 标签：client, xmpp, apple-push-notifications, google-cloud-messaging

[设备如何接收 Android GCM 推送通知？](https://stackoverflow.com/questions/12295674/how-does-device-receive-android-gcm-push-notification)

你好，

在上面的链接中，解释了 GCM 和 Blackberry 通知服务的步骤。

我想知道是否可以使用 XMPP 将 GCM (android)/APNS (iOS) 更改为一个中央通知服务？这是因为我想用 XMPP 构建服务器和客户端，并希望在它们之间进行通信，以及通过消息和通知进行通信。

因此，通过在 android 应用程序中设置 webview 和 GCM 向设备发送通知，GCM 是不可靠的。并非所有消息都发送到设备。我还不确定这对 APNS 是如何工作的，但是该应用程序将在不同的平台上使用，如果只有一种发送通知的方式会很好。

有人有这方面的经验吗？还是有另一种实现通知的方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T14:58:22.490

iOS 不允许您在后台运行应用程序（语音应用程序除外）。这意味着您不能在 iOS 的后台拥有 XMPP 流。对于 iOS，如果您不是语音应用程序，那么除了 APNS 之外没有其他解决方案。Android 没有这些限制。Windows Phone 7.X 和 iOS 有同样的限制，我不知道黑莓是怎么处理的。

# mysql - 如何在 Django 中创建映射表？

> ID：13585840
> 
> 赞同：1
> 
> 时间：2012-11-27T13:58:49.557
> 
> 标签：mysql, django, django-models, django-forms, python-2.7

考虑我有 3 个表（用户、名称、部门）。我已经创建了指定为 manytomanyField() 的部门表，所以我知道创建了一个映射表 Department_Designation，并且当在部门表中提供数据时，数据将自动填充到该表中。现在我需要这个 Department_Designation Map 表和 User 表之间的映射，以便我可以将用户与他的部门和名称相关联，我该如何创建这种关系？这种方法是否正确。如果有的话，请提供建议并提出更好的方法，并附上示例和文档。我在 Windows 上使用 python 2.7、Django 1.3、MySQL5.5。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:03:26.490

[请参阅有关多对多关系的额外字段](https://docs.djangoproject.com/en/dev/topics/db/models/#extra-fields-on-many-to-many-relationships)的文档。

# prolog - 使用 string_to_atom 时出错：参数没有充分实例化

> ID：13585843
> 
> 赞同：3
> 
> 时间：2012-11-27T13:58:50.703
> 
> 标签：prolog, dcg, instantiation-error

我正在使用 Prolog 中的 URI 解析器，但目前我遇到了一些更简单的东西。我正在探索一个字符串以找到一个特定的字符“：”，当我找到它时，我想要一个只包含它之前的连接字符的字符串。

这个程序：

```
% caratteri speciali
colonCheck(S) :-
   string_to_atom([S], C),
   C = ':'.                        % S==:

headGetter([H|T], [H]) :-
   !.

% struttura uri
uri(Scheme, Userinfo, Host, Port, Path, Query, Fragment).

% parsing uri
parsed_uri(UriInput, uri(Scheme,Userinfo,Host,Port,Path,Query,Fragment)) :-
   scheme(UriInput, uri(S,Userinfo,Host,Port,Path,Query,Fragment)),
   not(headGetter(UriInput, ':')),
   !,
   string_to_atom([S], Scheme).

% controllo Scheme, in ingresso ho i dati da controllare e l'oggetto uri che 
% mi servirà per inviarlo al passaggio successivo ho trovato i due punti
scheme([H|T], uri(Scheme,Userinfo,Host,Port,Path,Query,Fragment)):-
   colonCheck(H),
   !,
   end(Scheme).
% non trovo i due punti e procedo a controllare il prossimo carattere
% (la testa dell'attuale coda)
scheme([H|T], uri(Scheme,Userinfo,Host,Port,Path,Query,Fragment)):-
   not(colonCheck(H)),
   scheme(T, uri(This, Userinfo,Host,Port,Path,Query,Fragment)),
   append([H], This, Scheme).

%fine computazione
end([S]). 
```

给出这个结果：

```
?- scheme("http:", uri(A,_,_,_,_,_,_)).
A = [104, 116, 116, 112, _G1205]. 
```

我认为那部分是正确的，但现在我想将 char 列表转换为字符串，所以我将最后一行更改为：

```
end([S]) :-
   string_to_atom([S], K). 
```

但我收到此错误消息：

> 错误：string_to_atom/2：参数没有充分实例化

我可能错过了一些东西。你能说出它是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T18:19:21.470

Prolog 中的字符串只是字符代码的列表，然后您可以大大简化代码：考虑一下

```
?- S = "http:/example.com", append(L, [0':|R], S), format('~s and ~s~n', [L,R]). 
```

将输出

```
http and /example.com
S = [104, 116, 116, 112, 58, 47, 101, 120, 97|...],
L = [104, 116, 116, 112],
R = [47, 101, 120, 97, 109, 112, 108, 101, 46|...] . 
```

ColonCheck/1,headGetter/2,end/1 没用，我认为它在*任何*语言中都是不好的风格，特别是在声明性语言中，不需要引入符号。

如果您需要解析结构化数据，您会发现 DCG 提供了更好的支持：

```
?- phrase((seq(L),":",seq(R)), "http:/example.com", []),format('~s and ~s~n', [L,R]). 
```

在哪里

```
seq([]) --> [].
seq([C|Cs]) --> [C], seq(Cs). 
```

将输出与上面相同的内容，即

```
http and /example.com
L = [104, 116, 116, 112],
R = [47, 101, 120, 97, 109, 112, 108, 101, 46|...] . 
```

底线：将 scheme/2 替换为

```
scheme(Url, uri(Scheme, _Userinfo, _Host, _Port, _Path, _Query, _Fragment)) :-
    append(Scheme, [0':|_], Url). 
```

你会得到

```
?- scheme("http:", uri(A,_,_,_,_,_,_)).
A = [104, 116, 116, 112] 
```

# c# - 尝试从数组列表中的结构检索数据时出现 C# ArgumentOutOfRangeException

> ID：13585845
> 
> 赞同：1
> 
> 时间：2012-11-27T13:58:59.353
> 
> 标签：c#, arraylist, structure

将尝试仅发布相关代码，因为我的程序已经很大了。基本上，该程序将客户信息添加到数组列表结构中。我的存储、保存和文件加载工作完美无缺，但是当我试图显示数据时，我遇到了异常。

大多数主要代码都在一个与表单分开的类上，这个特殊的调用来自“frmViewRecords”。

```
public void ViewData(int currentRecord)
    {
        string fn = ((custDetails)datalist[currentRecord]).firstName;

        frmViewRecords viewRecords = new frmViewRecords();
        viewRecords.WriteData(fn);
    } 
```

上面的代码是导致异常的原因，但下面的消息框代码可以正常工作。

```
public void LoadData()
    {
        bool fileLoaded = false;

        //Load the database
        try
        {
            FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read); //Create the filestream
            try
            {
                BinaryFormatter bf = new BinaryFormatter(); //New binary formatter for deserialization
                datalist = (ArrayList)bf.Deserialize(fs);
                fileLoaded = true; //Update the fileLoaded bool so that it doesn't open the file dialog instance
                recordCount = datalist.Count;
                MessageBox.Show("" + filename + " loaded successfully."); //Inform the user that the file was automatically loaded
                MessageBox.Show("Test: " + ((custDetails)datalist[0]).firstName);
            }
            catch
            {
                MessageBox.Show("Could not de-serialise from " + filename, "FILE LOADING PROBLEM", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
            }
            fs.Close();
        }
        catch
        {
            if (MessageBox.Show("File isn't in the right location, this is normal if a dataset does not yet exist.\n\n If the file exists elsewhere click no and you will be prompted to find the database file, else click yes to create a default file.", "FILE LOADING PROBLEM", MessageBoxButtons.YesNo, MessageBoxIcon.Exclamation) == DialogResult.Yes)
            {
                fileLoaded = true;
                CreateDefaultData();
            }
        } 
```

我试过'string fn = ((custDetails)datalist[0]).firstName;' 以确保它不是导致问题的变量，并且异常仍然发生。我几乎没有想法。问题不能与结构或数组列表定义有关，因为 LoadData() 中的消息框可以正常工作并输出正确的信息。我尝试将消息框移动到 ViewData 方法，这也开始给出异常，所以我只能假设我的方法有问题？

这些方法位于“MainClass.cs”上，下面是我从 frmViewRecords 调用该方法的方式：

```
MainClass mainClass = new MainClass();
int currentRecord = 0;

private void LoadData()
    {
        mainClass.ViewData(currentRecord);
    } 
```

值得一提的是，以前，我直接从 frmViewRecords 调用数据，如下所示：

```
txtFirstName.Text = ((MainClass.custDetails)mainClass.datalist[currentRecord].firstName; 
```

但是在消息框提示起作用时遇到相同的异常后，我将其重写为上面的内容，但仍然遇到问题，所以我不知道是什么原因造成的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:06:21.750

中没有项目`datalist`。`recordCount`中的值可能`LoadData`也为零。试试这个：

```
if(datalist.Count != 0) { /* Get the current record */ } 
```

# xml - 直接从 Azure SQL 报告服务器加载 xml 报告

> ID：13585846
> 
> 赞同：2
> 
> 时间：2012-11-27T13:59:01.783
> 
> 标签：xml, azure, reporting-services

是否可以直接从 Azure SQL 报告服务器获取 xml 报告？

我想直接打开您可以从报告查看器网页“带有报告数据的 XML 文件”中保存的相同报告。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T18:40:34.123

如果您的问题是直接从报表服务器访问 XML 数据，您肯定可以做到。如果您将在浏览器中访问报告服务器 URL，则 XML 数据将在浏览器中呈现，或者如果您以编程方式访问它，那么这取决于如何访问接收到的数据。

SQL Azure 报告主要支持 SQL Server 中的所有系统数据类型以及专用数据类型，例如空间数据类型 geography 和 geometry、hierarchyId 和 XML。支持 XML 数据类型，但尚不支持类型化 XML 和 XML 索引。

创建报表服务器 URL（[如此处所述](http://msdn.microsoft.com/en-us/library/windowsazure/hh403968.aspx)）后，您可以通过传递 XML 格式类型[访问](http://msdn.microsoft.com/en-us/library/windowsazure/hh403971.aspx)相同的报表 URL，如下所示：

[https://_Reporting_Server_ID_.reporting.windows.net/ReportServer/Pages/ReportViewer.aspx?%](https://_Reporting_Server_ID_.reporting.windows.net/ReportServer/Pages/ReportViewer.aspx?%) ReportName&rs:Format=XML&rs:Command=Render

您可以创建报告服务器中已有的所有报告，以便您可以从 URL 或报告查看器控件以不同的格式访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:17:35.057

通过浏览器访问 ReportServer URL 并不是我真正推荐的方法，因为它只是用于帮助进行基本故障排除。它并不完全兼容所有浏览器，因此您可能会看到一些不一致的地方。

另一种方法是以编程方式或通过 ReportViewer 控件的编程实例化版本访问 Web 服务。使用这两种方法，您可以将报告以您想要的任何格式作为二进制对象拉下来，然后用它做任何您想做的事情。虽然没有专门针对您正在做的场景，[http://blogs.msdn.com/b/psssql/archive/2012/11/12/using-a-windows-azure-worker-role-to-generate-reports -using-azure-reporting.aspx](http://blogs.msdn.com/b/psssql/archive/2012/11/12/using-a-windows-azure-worker-role-to-generate-reports-using-azure-reporting.aspx)确实列出了如何以编程方式访问 Azure RS 实例（以及实际上任何 SSRS 实例）。

# python - Stream 中的 CSV 导出（来自 Heroku 上的 Django 管理员）

> ID：13585850
> 
> 赞同：11
> 
> 时间：2012-11-27T13:59:10.673
> 
> 标签：python, django, heroku, django-admin, cedar

我们需要从运行在 Heroku 上的 Django admin 导出一个包含模型数据的 csv 文件。因此，我们创建了一个操作，我们在其中创建了 csv 并在响应中返回它。这一直很好，直到我们的客户端开始导出大量数据并且我们遇到了 Web Worker 的 30 秒超时。

为了规避这个问题，我们考虑将 csv 流式传输到客户端，而不是先在内存中构建它并一次性发送。触发是这条信息：

> Cedar 支持长轮询和流式响应。您的应用程序有一个初始的 30 秒窗口，用于向客户端返回一个字节。在发送每个字节（从 > 客户端接收或由您的应用程序发送）后，您重置一个滚动 55 秒的窗口。如果在 55 秒窗口内没有发送任何数据 > 您的连接将被终止。

因此，我们实现了一些看起来像这样的东西来测试它：

```
import cStringIO as StringIO
import csv, time

def csv(request):
    csvfile = StringIO.StringIO()
    csvwriter = csv.writer(csvfile)

def read_and_flush():
    csvfile.seek(0)
    data = csvfile.read()
    csvfile.seek(0)
    csvfile.truncate()
    return data

def data():
    for i in xrange(100000):
        csvwriter.writerow([i,"a","b","c"])
        time.sleep(1)
        data = read_and_flush()
        yield data

response = HttpResponse(data(), mimetype="text/csv")
response["Content-Disposition"] = "attachment; filename=test.csv"
return response 
```

下载的 HTTP 标头如下所示（来自 FireBug）：

```
HTTP/1.1 200 OK
Cache-Control: max-age=0
Content-Disposition: attachment; filename=jobentity-job2.csv
Content-Type: text/csv
Date: Tue, 27 Nov 2012 13:56:42 GMT
Expires: Tue, 27 Nov 2012 13:56:41 GMT
Last-Modified: Tue, 27 Nov 2012 13:56:41 GMT
Server: gunicorn/0.14.6
Vary: Cookie
Transfer-Encoding: chunked
Connection: keep-alive 
```

“Transfer-encoding: chunked”表示 Cedar 实际上是按我们猜测的分块传​​输内容。

问题是 csv 的下载在 30 秒后仍然被 Heroku 日志中的这些行中断：

```
2012-11-27T13:00:24+00:00 app[web.1]: DEBUG: exporting tasks in csv-stream for job id: 56, 
2012-11-27T13:00:54+00:00 app[web.1]: 2012-11-27 13:00:54 [2] [CRITICAL] WORKER TIMEOUT (pid:5)
2012-11-27T13:00:54+00:00 heroku[router]: at=info method=POST path=/admin/jobentity/ host=myapp.herokuapp.com fwd= dyno=web.1 queue=0 wait=0ms connect=2ms service=29480ms status=200 bytes=51092
2012-11-27T13:00:54+00:00 app[web.1]: 2012-11-27 13:00:54 [2] [CRITICAL] WORKER TIMEOUT (pid:5)
2012-11-27T13:00:54+00:00 app[web.1]: 2012-11-27 13:00:54 [12] [INFO] Booting worker with pid: 12 
```

这应该在概念上有效，对吧？有什么我们错过的吗？

我们非常感谢您的帮助。汤姆

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-30T08:39:21.573

我找到了问题的解决方案。这不是 Heroku 超时，因为否则 Heroku 日志中会出现 H12 超时（感谢 Heroku 的 Caio 指出这一点）。

问题是 Gunicorn 的默认超时时间是 30 秒。将 --timeout 600 添加到 Procfile （在 Gunicorn 行）后，问题就消失了。

Procfile 现在看起来像这样：

```
web: gunicorn myapp.wsgi -b 0.0.0.0:$PORT --timeout 600
celeryd: python manage.py celeryd -E -B --loglevel=INFO 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T18:10:20.240

那不是您的脚本的问题，而是 30 秒 Web 请求默认 Heroku 超时的问题。您可以阅读以下内容： [https](https://devcenter.heroku.com/articles/request-timeout) ://devcenter.heroku.com/articles/request-timeout 并根据此文档 - 将您的 CSV 导出移动到后台进程。

# openal - 使用 OPEN AL 录制

> ID：13585851
> 
> 赞同：1
> 
> 时间：2012-11-27T13:59:11.797
> 
> 标签：openal

我试图用 open al 录音，我四处搜索，只找到了用麦克风录音的人的例子。

我想录制 openal 正在播放的声音。

有人能指出我正确的方向吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-28T03:15:14.693

从我所看到的来看，这并不是一个真正的 OpenAL 问题。我不相信 OpenAL 有任何能力从缓冲数据返回 .wav 文件。您需要在下面的线程中执行类似的操作。

[将音频字节 [] 保存到 wav 文件](https://stackoverflow.com/questions/10991391/saving-audio-byte-to-a-wav-file)

# javascript - Phonegap 中的 HTTP 请求

> ID：13585854
> 
> 赞同：1
> 
> 时间：2012-11-27T13:59:26.260
> 
> 标签：javascript, jquery, ajax, cordova

我对 Phonegap 有一个奇怪的问题。我的 XMLHttpRequests 触发了两次；我正在开发的应用程序中使用 XMLHttpRequests 来创建要选择的事件的动态列表。jQuery 也是我正在使用的库之一。

任何时候我使用 XMLHttpRequest，无论是 vanilla 还是 jQuery，它都会执行两次，即使它应该只运行一次。有没有其他人遇到过这个问题？

这里有一些示例代码：

```
(function(){
    var request = new XMLHttpRequest();
    request.open("GET", "http://{site-url-hidden-for-privacy}/events/list", true);
    request.onreadystatechange = function(){
    if(request.readyState == 4){
        if(request.status == 200 || request.status == 0){
            parse_events(JSON.parse( request.responseText ));
        }               
    }
}
request.send();
})(); 
```

XMLHttpResponse 文本是一个 JSON 数组，而 parse_events 只是获取该数组并使用它为菜单创建一组选择选项。

有谁知道为什么这会触发两次，本质上是为每个事件创建两个选项，而应该只有一个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T17:49:43.270

好的，我明白了。我正在和一位同事一起做这个项目，我们忘记监听 deviceready 事件，因为我们使用的是 phonegap。我们在加载窗口时绑定“online”和“offline”事件，而不是在设备准备好时绑定。

前：

```
document.addEventListener("DOMContentLoaded", function(){
    document.addEventListener("online", function(){...}, false);
    document.addEventListener("offline", function(){...}, false);
}, false); 
```

解决方案：

```
document.addEventListener("DOMContentLoaded", function(){
    document.addEventListener("deviceready",function(){
        document.addEventListener("online", function(){...}, false);
        document.addEventListener("offline", function(){...}, false);
    },false);
}, false); 
```

我不知道为什么，因为它并不完全有意义，但我认为不通过“设备就绪”会导致 HTTP 请求执行两次，一次是在页面加载时，一次是在设备准备好时。

修复是让它只在设备准备好时才运行，如上所示。

# python - 如何使用 Boto 启动 EC2 实例，指定 EBS 的大小？

> ID：13585857
> 
> 赞同：27
> 
> 时间：2012-11-27T13:59:36.530
> 
> 标签：python, amazon-web-services, amazon-ec2, boto

我正在使用 boto/python 启动一个从 EBS 卷启动的新 EC2 实例。在我启动实例时，我想覆盖引导 EBS 卷的默认大小。

我没有发现可能适合我的启动代码的 boto 方法或参数：

```
ec2 = boto.connect_ec2( ACCESS_KEY, SECRET_KEY, region=region )

reservation = ec2.run_instances( image_id=AMI_ID, 
                                 key_name=EC2_KEY_HANDLE, 
                                 instance_type=INSTANCE_TYPE,
                                 security_groups = [ SECGROUP_HANDLE, ] ) 
```

[此网页](http://alestic.com/2010/02/ec2-resize-running-ebs-root)显示如何使用命令行工具增加正在运行的 EC2 实例的 EBS 卷的大小，但我想在指定 EC2 实例时使用 boto：

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-11-28T11:43:04.793

您必须先创建块设备映射：

```
dev_sda1 = boto.ec2.blockdevicemapping.EBSBlockDeviceType()
dev_sda1.size = 50 # size in Gigabytes
bdm = boto.ec2.blockdevicemapping.BlockDeviceMapping()
bdm['/dev/sda1'] = dev_sda1 
```

在此之后，您可以在`run_instances`调用中提供块设备映射：

```
reservation = ec2.run_instances( image_id=AMI_ID, 
                                 key_name=EC2_KEY_HANDLE, 
                                 instance_type=INSTANCE_TYPE,
                                 security_groups = [ SECGROUP_HANDLE, ],
                                 block_device_mappings = [bdm]) 
```

不幸的是，这并[没有很好的记录](https://github.com/boto/boto/issues/736)，但是[可以在源代码中找到](https://github.com/boto/boto/blob/develop/boto/ec2/blockdevicemapping.py#L85)该示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T14:15:55.057

您还可以使用[CloudFormation](http://aws.amazon.com/cloudformation)，它用于记录和自动化您的环境。您可以在以下位置检查 ESB 定义的模板：[https ://s3.amazonaws.com/cloudformation-templates-us-east-1/EC2WithEBSSample.template](https://s3.amazonaws.com/cloudformation-templates-us-east-1/EC2WithEBSSample.template)

```
 "Resources" : {
    "Ec2Instance" : {
      "Type" : "AWS::EC2::Instance",
      "Properties" : {
        "AvailabilityZone" : { "Fn::FindInMap" : [ "RegionMap", { "Ref" : "AWS::Region" }, "TestAz" ]},
        "SecurityGroups" : [ { "Ref" : "InstanceSecurityGroup" } ],
        "KeyName" : { "Ref" : "KeyName" },
        "ImageId" : { "Fn::FindInMap" : [ "RegionMap", { "Ref" : "AWS::Region" }, "AMI" ]},
        "Volumes" : [ 
          { "VolumeId" : { "Ref" : "NewVolume" },
            "Device" : "/dev/sdk"
          }
        ]
      }
    },

    ...

    "NewVolume" : {
      "Type" : "AWS::EC2::Volume",
      "Properties" : {
        "Size" : "100",
        "AvailabilityZone" : { "Fn::FindInMap" : [ "RegionMap", { "Ref" : "AWS::Region" }, "TestAz" ]}
      }
    } 
```

然后，您可以使用[Boto CloudFormation API](http://boto.cloudhackers.com/en/latest/ref/cloudformation.html)来部署您的环境。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-10T11:19:26.047

这是使用boto3“一切都是资源”方法的代码版本。另请注意如何避免硬编码磁盘名称：

```
import boto3

ec2 = boto3.resource('ec2')

def ec2_one_by_key_and_value(collection: str, key: str, value: str):
    handler = getattr(ec2, collection)
    return list(handler.filter(Filters=[{'Name': key, 'Values': [value]}]))[0]

image = ec2_one_by_key_and_value('images', 'name', 'ubuntu/images/hvm-ssd/...')
root_disk = None
for block_device in image.block_device_mappings:
    if block_device['DeviceName'] == image.root_device_name:
        root_disk = block_device
        assert root_disk['Ebs']
        root_disk['Ebs']['VolumeSize'] = 16 # New disk 
        break
assert root_disk
instances = ec2.create_instances(MinCount=1, ..., ImageId=image.id,
                                 BlockDeviceMappings=image.block_device_mappings) 
```

# iis-7 - 为 AngularJS HTML5Mode 配置 IIS URL 重写模块仍然无法正常工作

> ID：13585858
> 
> 赞同：4
> 
> 时间：2012-11-27T13:59:40.107
> 
> 标签：iis-7, url-rewriting, angularjs, configure

我搜索了一些关于配置 IIS URL 重写模块以使用 AngularJS HTML5Mode 的信息，甚至尝试了我在另一个问题上找到的信息：

[如何配置 IIS 以在 HTML5 模式下重写 AngularJS 应用程序的 URL？](https://stackoverflow.com/questions/12614072/how-do-i-configure-iis-for-url-rewriting-an-angularjs-application-in-html5-mode)

我已经对我的 IIS 进行了更改，如上面链接中的问题所示，并设置了基本 URL，当我访问根站点（即 http://localhost/appname/）时，该站点可以正常工作。我所有的观点和路由都很好。

然而; 当我尝试在新选项卡或浏览器窗口中访问特定 URL（即 http://localhost/appname/about）时，我得到一个 404。我还缺少什么吗？？？

我正在运行安装了 URL 重写模块的 Windows 7、IIS 7。

** 我必须将协议隔开以允许接受示例 URL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-01-12T13:44:21.157

安装此扩展：[https ://www.iis.net/downloads/microsoft/url-rewrite](https://www.iis.net/downloads/microsoft/url-rewrite)

并将其添加到 system.webServer 下的 web.config

```
<rewrite>
  <rules>
    <clear />        
    <rule name="Html5Mode" enabled="true" stopProcessing="true">
      <match url="^(.+)$" negate="true" />
      <conditions>
        <add input="{REQUEST_URL}" pattern="^(.+)$" negate="true" />
      </conditions>
      <action type="Rewrite" url="/index.html" logRewrittenUrl="true"/>
    </rule>
    <rule name="AngularJS" enabled="true" stopProcessing="true">
      <match url=".*" />
      <conditions logicalGrouping="MatchAll">
        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
        <add input="{REQUEST_URI}" pattern="^/(api)" negate="true" />
      </conditions>
      <action type="Rewrite" url="/index.html" />
    </rule>        
  </rules>
</rewrite> 
```

这是完整的 web.config，包括提供静态文件。

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <rewrite>
          <rules>
            <clear />        
            <rule name="Html5Mode" enabled="true" stopProcessing="true">
              <match url="^(.+)$" negate="true" />
              <conditions>
                <add input="{REQUEST_URL}" pattern="^(.+)$" negate="true" />
              </conditions>
              <action type="Rewrite" url="/index.html" logRewrittenUrl="true"/>
            </rule>
            <rule name="AngularJS" enabled="true" stopProcessing="true">
              <match url=".*" />
              <conditions logicalGrouping="MatchAll">
                <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
                <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
                <add input="{REQUEST_URI}" pattern="^/(api)" negate="true" />
              </conditions>
              <action type="Rewrite" url="/index.html" />
            </rule>        
          </rules>
        </rewrite>
        <handlers>
           <clear />
            <add 
                name="StaticFile" 
                path="*" verb="*" 
                modules="StaticFileModule,DefaultDocumentModule,DirectoryListingModule" 
                resourceType="Either" 
                requireAccess="Read" />
        </handlers>
        <staticContent>
            <mimeMap fileExtension=".*" mimeType="application/octet-stream" />
        </staticContent>
    </system.webServer>
</configuration> 
```

# jquery - 从 json 文件中检查数据

> ID：13585863
> 
> 赞同：-1
> 
> 时间：2012-11-27T13:59:53.693
> 
> 标签：jquery, html, json

我在 json 文件中有 10 条记录，我将这些记录附加到页面滚动的列表中。所以，只要我继续滚动，数据就会被附加。

我想要的是当 json 文件中存在的所有数据都填充在 list 中时，不应再附加任何数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:17:34.113

每次在将数据附加到 JSON 之前，只需检查是否达到限制？

如果达到了就不要再追加了。

或者，您可以保留一个计数器并在每次将数据附加到 JSON 时递增计数器。

在更新之前检查此计数器以检查是否已达到限制。

# iphone - iOS：使用定位服务阻止内容和处理应用提交

> ID：13585864
> 
> 赞同：1
> 
> 时间：2012-11-27T13:59:55.417
> 
> 标签：iphone, ios, ios-provisioning

如果您不在特定区域，我们正在开发的应用程序使用位置服务来阻止内容。由于该地区不是美国，所以在提交应用时，内容将被屏蔽。提交应用程序的推荐方法是什么，以便内容不会被阻止。

Apple 测试人员是否有工具可以模拟定位服务的不同区域，而我们只需要围绕此添加注释吗？

或者

我们是否应该使用远程配置文件来在应用程序完成提交过程时切换可接受的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:03:01.680

由于即使是 iOS 模拟器也支持设置自定义地理位置，所以我只会使用注释来添加测试位置的说明。

# javascript - 菜单鼠标进入鼠标离开点击

> ID：13585867
> 
> 赞同：2
> 
> 时间：2012-11-27T13:59:56.967
> 
> 标签：javascript, jquery, menu

任何人都可以帮助我吗？我想要一个在 mouseenter 和 mouseleave 事件上带有动画的下拉菜单，但是在鼠标输入后单击时，我希望子菜单保持可见，直到新单击页面中的任何位置（在示例中仅在正文中）。在第二次单击（mouseleave 的相同动画）之后，我希望 mouseenter 和 mouseleave .on 再次像我们开始时一样。

```
$('#menu > li').on('mouseenter',function(){
    //mouseenter handler
});

$('#menu > li').on('mouseleave',function(){
    //mouseleave handler
});
$('#menu > li').toggle(
  function () {
  $('#menu > li').off('mouseenter mouseleave');
  },
  function () {
  //mouseleave handler
  });
$('body').click(function(){
  //same mouseleave handler
}); 
```

我不知道如何在第二次单击后启用 mouseenter/mouseleave。对不起，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:19:29.533

这可以使用事件委托显着简化：

```
$('document').on("click",'#menu > li', function() {
    $('#menu > li').off('mouseenter mouseleave');
});

$('document').on("click",':not(#menu > li)', function() {
    $('#menu > li').on('mouseenter', function(){
         //your mouseenter handler goes here
    });
    $('#menu > li').on('mouseleave', function(){
         //your mouseleave handler goes here
    });
}); 
```

这在语义上等价于：

```
If a click happens on a menu item, unbind mouse enter/leave events

If a click happens on a non menu item, bind mouse enter/leave events 
```

# wpf - Windows Presentation Foundation 项目不支持 PageFunction

> ID：13585868
> 
> 赞同：1
> 
> 时间：2012-11-27T14:00:01.593
> 
> 标签：wpf, xaml, visual-studio-2012, expression-blend

我知道这与[“Windows Presentation Foundation (WPF) 项目中不支持 PageFunction”2012](https://stackoverflow.com/questions/12547990/pagefunction-is-not-supported-in-a-windows-presentation-foundation-wpf-projec)中提出的问题相同- 但是，我不确定如何应用那里提到的解决方法，并认为它可能是将其作为一个单独的问题提出更为合适。如果这违反了网站精神，请提前道歉。

总结一下这个问题：我有一个几年前的 C# Visual Studio 2010 WPF 项目，我现在正试图在 Visual Studio 2012 中打开它。虽然该项目仍然可以正常构建和运行，但我需要编辑 XAML 标记，并且 VS2012 中的设计视图抱怨“无效标记”。它绊倒的确切错误是：

> Windows Presentation Foundation (WPF) 项目不支持页面功能

XAML 的开头如下所示：

```
 <PageFunction
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:MyNamespace" 
    x:Class="MyProject.WizardPage1"
    x:TypeArguments="local:WizardResult"
    KeepAlive="True"
    WindowTitle="My Project" Height="350" ShowsNavigationUI="False" Width="700" > 
```

如原始问题中所述，[此](http://connectppe.microsoft.com/VisualStudio/feedback/details/723887/pagefunction-not-supported-and-typearguments-not-defined-in-xaml-namespace%20%27%27this%27%27)Microsoft 页面上有有关此确切问题的报告。提到了一个涉及“ViewBase”的解决方法，但我看不出这与 PageFunction 问题有什么关系（我对 XAML 很陌生，所以我可能会遗漏一些简单的东西）。

我尝试在 Blend for VS2012（支持非 Windows 8 项目的新预览版）中打开项目，但这给出了关于不支持 PageFunction 的相同错误。最近的 VS2012 更新 1 也没有解决这个问题。

谁能建议我需要在我的 XAML 或代码隐藏中更改什么以便能够直观地编辑此页面？

还是我应该放弃并重新下载 VS2010 来编辑这个项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:52:56.780

根据解决方法，您需要创建一个派生自 的类`PageFunction<WizardResult>`，然后更新您的 XAML 以从该类继承。

**班级：**

```
public class WizardResultPageFunction : PageFunction<WizardResult>
{
} 
```

**代码隐藏：** 要么更改类以从新类继承，要么完全删除基类声明并让 XAML 定义基类：

```
public partial class WizardPage1
// or: 
// public partial class WizardPage1 : WizardResultPageFunction 
{
   ...
} 
```

**XAML：** 替换为`PageFunction`并`local:WizardResultPageFunction`删除`x:TypeArguments`属性：

```
<local:WizardResultPageFunction 
   xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
   xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
   xmlns:local="clr-namespace:MyNamespace" 
   x:Class="MyProject.WizardPage1"
   KeepAlive="True"
   WindowTitle="My Project" Height="350" ShowsNavigationUI="False" Width="700"
> 
```

# git - 从 webstorm 推送到 Git

> ID：13585870
> 
> 赞同：3
> 
> 时间：2012-11-27T14:00:12.157
> 
> 标签：git, webstorm

我正在寻找在 Windows 上使用 Git 的替代方案。Git Gui 对于我们的开发人员来说太复杂了，他们曾经使用 tortois 来处理 subversion (assembla)，并且非常容易提交。现在我们正在使用 BitBucket 迁移到 Git，我正在通过 WebStorm 寻找一个普通的客户端。他们的文档中没有关于如何将本地存储库实际链接到远程存储库的提示。(http://www.jetbrains.com/webstorm/webhelp/using-git-integration.html)

有人知道在这两者之间整合的方法吗？更好的是，也许有比 Git Gui 更好的客户端？

谢谢

更新 - -

只需使用 TortoiseGit 就可以了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-25T18:38:53.997

我发现 Source Tree 是团队成员真正喜欢使用的一款 Git GUI 应用程序：http: [//www.sourcetreeapp.com/](http://www.sourcetreeapp.com/)

它适用于 Windows 和 Mac。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-20T17:56:34.990

我正在使用 bitbucket 插件，请尝试以下选项之一

1) [https://bitbucket.org/dmitry_cherkas/jetbrains-bitbucket-connector/overview](https://bitbucket.org/dmitry_cherkas/jetbrains-bitbucket-connector/overview) 2) [http://plugins.jetbrains.com/plugin/6207?pr=ruby](http://plugins.jetbrains.com/plugin/6207?pr=ruby)

我亲自使用了第一个版本，到目前为止它工作得很好。

# javascript - 使用单张图像进行悬停效果

> ID：13585872
> 
> 赞同：0
> 
> 时间：2012-11-27T14:00:15.780
> 
> 标签：javascript, html, css

我在 webtutorial 的某个地方读到过，我们只能使用单个图像来实现 CSS 中的悬停效果。例如。我只需要在 CSS 中输入这张图片

[![CSS 图像](../Images/3eb6f8c484b5a5afb39597c1a78ce8ee.png)](https://i.stack.imgur.com/Nxrvr.png)

因此，当 Facebook 图标未悬停时，我们会看到暗灰色图标，但是当有人将鼠标悬停在图标上时，会显示蓝色图标，为此我只需要在 CSS 中使用一个图像文件。

我们怎么能这样做。另外，我想知道这些图像是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:08:04.057

它们被称为[精灵](http://css-tricks.com/css-sprites/)

它们允许您将一个图像用于多个元素，这些元素看起来可能完全不同

[官方文档](http://www.w3.org/wiki/CSS_background_images#Sprites)

我做了一个简单的例子来做你[在这里需要的](http://jsfiddle.net/y3u3F/)

```
<div></div>

div {
  background: url('http://i45.tinypic.com/2jee9zo.png');
  background-position: -10px -15px;
  height: 70px;
  width: 70px;
}

div:hover {
  background-position: -10px 83px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:02:35.657

您可以使用 CSS 精灵。这是一个有用的工具：[http ://es.spritegen.website-performance.org/](http://es.spritegen.website-performance.org/)

进一步阅读：[http ://www.w3schools.com/css/css_image_sprites.asp](http://www.w3schools.com/css/css_image_sprites.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T14:07:57.053

编辑：它被称为精灵（抱歉添加了这个，因为我忘了回答你的第一个问题是如何命名的）

您可以通过定位背景图像来做到这一点，如下面我的工作示例

这是CSS，顺便说一句

```
input#searchSubmit          { height: 34px; width: 36px; background: url('../images/searchSubmit.png') no-repeat; margin: 8px 8px 0 4px; cursor: pointer; border: none; }
input#searchSubmit:hover    { background-position: 0px -34px; } 
```

如您所见，当我将鼠标悬停在 searchSubmit 上时，它将更改粘贴在按钮上的图像的背景位置，而不是显示黑色和红色的搜索图标，而是红色和白色的搜索图标。

网站在这里，所以你可以看到它的实际效果，顺便说一句，我所有的操作按钮都是这样制作的。 [单击此处查看实际操作](http://darktiderising.net/newHolo/)

# android - 在 apk 中包含/排除文件

> ID：13585873
> 
> 赞同：0
> 
> 时间：2012-11-27T14:00:18.443
> 
> 标签：android, eclipse, apk

在一个 android eclipse 项目中，我有一个类似 assets/gfx 的目录。在这个目录中有类似 mysprite.png 的文件，但我也有 mysprite.xcf，原始 gimp 文件。此文件是否包含在 apk 文件中，如果包含，是否有办法将其从 apk 文件的构建中排除？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:10:22.470

首先，是的。此文件存在于您的 apk 以及 /res 文件中。

第二，没有。您不能修改 apk 内容（删除、添加、..）。您可以将它们（例如图片）保存在 SD 卡上

# php - for循环导致内存耗尽

> ID：13585876
> 
> 赞同：1
> 
> 时间：2012-11-27T14:00:28.210
> 
> 标签：php, memory

我正在 CMS/框架中创建一个名为[Processwire](http://processwire.com/)的网站，现在我确实想用从数据库结果中收集的值（在 processwire 中称为页面）填充一些数组。现在发生的事情是我得到一个内存错误，我知道我应该提高内存限制，但这感觉不对，因为页面甚至会变得越来越多，然后它已经因此负载会变得更大，我可能会结束up 进一步增加内存限制。现在我想从大堆中挑选一批并处理它们，然后挑选下一批。这是导致崩溃的部分：

```
 for($i = 0; $i<=$count_log; $i+=100)
{
    $all_log_files = $pages->find("template=logs, start=$i, limit=100");
    foreach($all_log_files as $log_file)
    {
        $u++;
        if(empty($actions["$log_file->action"]))
        {
            $actions[$log_file->action] = 1;
        }
        if(empty($ips["$log_file->ip"]))
        {
            $ips[$log_file->ip] = 1;
        }
        if(empty($values["$log_file->value"]))
        {
            $values[$log_file->value] = 1;
        }
        if(empty($results["$log_file->result"]))
        {
            $results[$log_file->result] = 1;
        }
    }
} 
```

现在你可以看到我已经尝试制作“批次”但我失败了，因为我仍然会收到错误......

我该怎么做才能解决这个问题，或者我无能为力，我应该提高内存限制吗？

编辑：

**具体错误：** 致命错误：第47行/xxx/xxx/xxx/xxx/wire/core/DatabaseQuery.php中允许的内存大小为33554432字节耗尽（试图分配6字节）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T14:04:36.790

您遇到了内存问题，因为您尝试一次存储在内存中的数据太大。您可以增加内存限制以保存所有数据或存储更少的数据并更改算法以处理批量数据。

例如，如果您有一个使用存储在 中的值的函数`$results`，那么您可以尝试更改此函数以使其仅处理部分结果，并为每次迭代调用该函数，然后在迭代后清空数组完成。

# nagios - 时间段之外的 Nagios 默认值

> ID：13585883
> 
> 赞同：0
> 
> 时间：2012-11-27T14:00:46.743
> 
> 标签：nagios

我有一项在正常工作时间内受到监控的服务，但有时，该服务会在最后一分钟进入关键状态。此严重状态将持续到非工作时间。

是否有设置在此时间段之外更改值？或者是否有人有脚本可以在超出其时间段时将其放入 cron 中以将某些服务标记为 OK？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T09:57:42.970

对的，这是可能的。

在**timeperiods.cfg**中，定义您的自定义时间。

并在服务模板中使用那些定义的时间段（在 check_period¬ification_period 中）

# python - 限制来自 xml 文件的文件列表失败

> ID：13585884
> 
> 赞同：0
> 
> 时间：2012-11-27T14:00:48.310
> 
> 标签：python, xml, loops, file-io

**这仍然不会按原样运行，但希望它能提供更多信息** 我有这段代码：

```
#import modules
import os, sys, datetime, time
# sys.setdefaultencoding is cancelled by site.py
reload(sys)    # to re-enable sys.setdefaultencoding()
sys.setdefaultencoding('utf-8')
try:
    import xml.etree.cElementTree as ET
except ImportError:
    import xml.etree.ElementTree as ET

now = datetime.datetime.now()
today = now.strftime("%m/%d/%Y")
processed = 0
    #here if sync_list.xml doesn't exist, I ask for some user input i want to save between sessions
    #then I save that info to sync_list.xml, along with the element to store files already synced
    root = ET.Element("root")

    synced = ET.SubElement(root, "synced")
    synced.set("name", "Already Synced")
    sfile = ET.SubElement(synced, "sfile")
    sfile.set("date", today)
    sfile.text = "firstsync"

    tree = ET.ElementTree(root)
    tree.write("sync_list.xml")
#If sync_list.xml already exists, then I grab the info
tree = ET.parse("sync_list.xml")
root = tree.getroot()
#I pull in all the info I need to work with and:
for elem in root.findall('sfile'):
    synced = elem.text
dcheck = 0
for elem in root.findall('synced/sfile'):
  fdate = elem.attrib.get('date')
  if fdate == today:
    dcheck += 1
synced = [elt.text for elt in root.findall('synced/sfile')]
#if sync_list.xml exists get the list of (UUIDs) $entries that have already been synced, and exclude them from the current query. If no UUID's exist in sync_list.xml, ignore
synclimit = 10 - dcheck
print "Already synced today: " + str(dcheck)
print "Today's synclimit: " + str(synclimit)
if synclimit == 0:
    print "Sorry, you've reached your limit for file syncing today. The limit is reset each night at 12:00 a.m."
    sys.exit()
synclimit = int(raw_input("How many files do you want to sync today? You have a max amount of " + str(synclimit) + " left today: "))

for filename in os.listdir(filepath):
    if processed >= synclimit:
        print "You've successfully synced " + str(synclimit) + " files."
        sys.exit()
    else:
        if filename.endswith('.txt') and filename not in synced:
            filename = os.path.join(filepath, filename)
            #process the files. This is where I'm getting variable dofilename
            #The processing works correctly. It's just going over the same files that have already been synced

            tree = ET.parse('sync_list.xml')
            synced = tree.find('synced')
            sfile = ET.SubElement(synced, "sfile", date=today)
            sfile.text = dofilename

            tree.write('sync_list.xml', encoding='utf-8', xml_declaration=True)
            processed += 1

            print 'Synced ' + dofilename + '....>'

print 'done!' 
```

它的意思是检查 sync_list 的文件名，而不是处理这些文件。

**预期输出：** 如果我有一个目录：

```
/root
  |_ file1.txt
  |_ file2.txt
  |_ file3.txt
  |_ file4.txt
  |_ file5.txt
  |_ file6.txt
  |_ file7.txt 
```

我在第 1 天运行脚本，同步限制为 5，我希望 xml 输出看起来像：

```
<sfile date="11/26/2012">file1.txt</sfile>
<sfile date="11/26/2012">file2.txt</sfile>
<sfile date="11/26/2012">file3.txt</sfile>
<sfile date="11/26/2012">file4.txt</sfile>
<sfile date="11/26/2012">file5.txt</sfile> 
```

这按预期工作，但如果我在第二天以 10 的同步限制运行它，我会得到：

```
<sfile date="11/26/2012">file1.txt</sfile>
<sfile date="11/26/2012">file2.txt</sfile>
<sfile date="11/26/2012">file3.txt</sfile>
<sfile date="11/26/2012">file4.txt</sfile>
<sfile date="11/26/2012">file5.txt</sfile>
<sfile date="11/27/2012">file1.txt</sfile>
<sfile date="11/27/2012">file2.txt</sfile>
<sfile date="11/27/2012">file3.txt</sfile>
<sfile date="11/27/2012">file4.txt</sfile>
<sfile date="11/27/2012">file5.txt</sfile>
<sfile date="11/27/2012">file6.txt</sfile>
<sfile date="11/27/2012">file7.txt</sfile> 
```

我希望的是，无论同步限制设置为什么，脚本都会跳过那些已经处理过的文件，而是给我这样的输出：

```
<sfile date="11/26/2012">file1.txt</sfile>
<sfile date="11/26/2012">file2.txt</sfile>
<sfile date="11/26/2012">file3.txt</sfile>
<sfile date="11/26/2012">file4.txt</sfile>
<sfile date="11/26/2012">file5.txt</sfile>
<sfile date="11/27/2012">file6.txt</sfile>
<sfile date="11/27/2012">file7.txt</sfile> 
```

感谢任何指导，至于我会误入歧途。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T14:37:22.343

简单的问题，我只是没有看到它。`synced`在将新条目写入sync_list.xml 时，我正在重新定义。

```
synced = ET.SubElement(root, "synced") 
```

将其更改为不同的变量可以解决所有问题。谢谢你。

# actionscript-3 - 有什么方法可以在 ActionScript3 - FlashPlayer SWF 中呈现 HTML？

> ID：13585887
> 
> 赞同：3
> 
> 时间：2012-11-27T14:00:57.583
> 
> 标签：actionscript-3, flash

我已经知道 StageWebView 和 HTMLLoader，但这仅适用于 Adob​​e AIR。有没有办法（可能是第三方）在 SWF 中做同样的事情。

**原因：**

我正在用 AS3 构建一个游戏，它可以在带有 Adob​​e AIR 的移动设备上运行，还有一个可以作为 SWF 运行的网络版本。

该游戏有一些链接和 URL，它们在移动的 StageWebView 中打开。我的问题是 SWF 必须在浏览器弹出窗口或 i-frame 中打开这些 URL...我不喜欢它:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:52:28.747

你想要完成的事情在 SWF 中是不可能的。但是，在 Web 上，您将可以访问 javascript 和 HTML，这样，您就可以使用直接位于 SWF 之上的 iframe 来复制该功能。

# regex - 无法使正则表达式匹配 .htaccess 中重定向规则中的 URL

> ID：13585889
> 
> 赞同：1
> 
> 时间：2012-11-27T14:01:05.900
> 
> 标签：regex, .htaccess, redirect

我有以下网址：

> [http://mysite.com/dir/someone-else%E2%80%99s-black-tie/](http://mysite.com/dir/someone-else%E2%80%99s-black-tie/)

我希望我的 htaccess 将其重定向到：

> [http://mysite.com/dir/someone-elses-black-tie/](http://mysite.com/dir/someone-elses-black-tie/)

怎么能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:22:09.780

```
RewriteEngine On
RewriteCond %{HTTP_HOST}:%{SERVER_PORT}s ^(.*):(443(s)|\d+s)$
RewriteRule ^/?(dir/someone-else).+(s-black-tie/?)$ http%3://%1/$1$2 [R=301,L] 
```

# sql-server - 找不到要更新的行

> ID：13585890
> 
> 赞同：0
> 
> 时间：2012-11-27T14:01:06.797
> 
> 标签：sql-server, tsql, linked-server

我正在尝试使用以下内容从事件表中删除一些行。

```
DECLARE @PRODUCTION_ID int = 13811

DELETE openquery(TEST, 
'SELECT p.id as production_id FROM EVENTS ev 
LEFT JOIN production_seasons ps ON ev.production_season_id = ps.id 
LEFT JOIN productions p ON ps.production_id = p.id')
where production_id = @PRODUCTION_ID 
```

但是，当返回事件时，即存在非空结果集时，查询会失败。如果结果集为空，则查询只返回`(0 row(s) affected)`。

我得到的错误是：

> 链接服务器“TEST”的 OLE DB 提供程序“MSDASQL”返回消息“无法找到要更新的行。自上次读取以来，某些值可能已更改。”。

我不确定这意味着什么，任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:37:03.437

上面的查询更改为：

```
DECLARE @TSQL varchar(500)
SELECT  @TSQL = 
'DELETE OPENQUERY(TEST,''SELECT ev.* FROM EVENTS ev 
LEFT JOIN production_seasons ps ON ev.production_season_id = ps.id 
LEFT JOIN productions p ON ps.production_id = p.id WHERE p.id = ' + convert(varchar, @PRODUCTION_ID) + ''')'
EXEC (@TSQL) 
```

重要的部分是`select ev.*`因为它似乎使它特定于从事件表中删除。[这个页面](http://www.perturb.org/display/743_MySQL_Delete_with_a_LEFT_JOIN.html)帮助我意识到了这一点。

由于您无法通过 openquery 传递变量，因此我不得不使用[其中之一](http://support.microsoft.com/kb/314520)。

# java - 当字符串未以 UTF-8 编码时抛出异常

> ID：13585897
> 
> 赞同：1
> 
> 时间：2012-11-27T14:01:22.607
> 
> 标签：java, xml

我有输入属性之一是 String xml 的方法。我只想为该 xml 的编码创建控件。如果任何字符采用 UTF-8 的其他编码，则会引发错误。

你能告诉我如何创建和测试它的最简单方法吗？

我用过这样的东西：

```
String xml = IOUtils.toString(new FileInputStream("c:/encoding.xml")); 
Document doc = builder.parse(IOUtils.toInputStream(xml, "UTF-8")); 
```

添加Ľ，Š，Ť，Ž，ľ，š，ť，ž等字母并将其保存为cp1250文件。

但没有错误。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:10:22.243

这不能在 Java 中本地完成。文件只是一串字节，可以随心所欲地解释它们，Java 默认情况下无法添加含义。我推荐使用这个库（不，我没有写）：

[http://code.google.com/p/juniversalchardet/](http://code.google.com/p/juniversalchardet/)

请遵循以下说明（从该链接复制粘贴）：

# 如何使用它

1.  构造一个实例`org.mozilla.universalchardet.UniversalDetector`。
2.  通过调用将一些数据（通常为数千字节）提供给检测器`UniversalDetector.handleData()`。
3.  通过调用通知检测器数据结束`UniversalDetector.dataEnd()`。
4.  通过调用获取检测到的编码名称`UniversalDetector.getDetectedCharset()`。
5.  `UniversalDetector.reset()`在重用检测器实例之前不要忘记调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T15:06:04.497

```
String xml = IOUtils.toString(new FileInputStream("c:/encoding.xml")); 
```

如果这`IOUtils`是`org.apache.commons.io.IOUtils`那么它的[Javadoc](http://commons.apache.org/io/api-release/org/apache/commons/io/IOUtils.html#toString%28java.io.InputStream%29)说

**“使用平台的默认字符编码**将 InputStream 的内容作为字符串获取。”

当您保存为 cp1250 时，我猜 cp1250 也是您的平台字符编码。你的代码要做的是

1.  将文件作为字节流读取
2.  使用 cp1250（平台编码）将字节流转换为字符
3.  将字符转换为 Java 内部表示 (UTF-16)
4.  从 UTF-16 转换为 UTF-8
5.  创建 XML 文档

这将始终有效，因为 cp1250*确实*是您的文件编码，UTF-16 具有 cp1250 中的每个字符，而 UTF-8 具有 UTF-16 中的每个字符。

如果要将字节读取为 UTF-8 并避免自动转换，则应使用以下两个参数变体之一`IOUtils.toString()`：

```
public static String toString(InputStream input, Charset encoding)

public static String toString(InputStream input, String encoding) 
```

所以我会尝试：

```
// Helper import: I always forget if the constant is "UTF8" or "UTF-8"
import org.apache.commons.lang.CharEncoding;

String xml = IOUtils.toString(new FileInputStream("c:/encoding.xml"), CharEncoding.UTF_8); 
Document doc = builder.parse(IOUtils.toInputStream(xml, CharEncoding.UTF_8)); 
```

这里的经验法则是：**切勿**在未指定源/目标编码的情况下进行任何字节到字符串/字符串到字节的转换。

一个小的经验法则是：除非您*需要*使用其他编码，否则在任何地方都使用 UTF-8。

这两个经验法则都与您选择的编程语言无关。

# php - PHP / Mysql，比较两个while循环的值

> ID：13585898
> 
> 赞同：0
> 
> 时间：2012-11-27T14:01:29.877
> 
> 标签：php, mysql, while-loop

有什么方法可以获取下面我的 while 查询的内容并在我的 php 脚本中的其他地方使用它？我想做的是从测验中收集答案，然后将它们与正确答案进行比较，我遇到的问题是答案来自一张桌子，而问题来自另一张桌子，所以我目前不得不运行两个不同的while 查询，但我不能在第二个查询中使用 $quiz，因为它只是保持固定在它吐出的最后一个值。我基本上试图做的是加载表A，在里面寻找`questionID`，选择那个表并拉出正确的答案。然后加载表 B，查看里面，选择相同的答案，`questionID`然后使用 if 语句比较 to，这样 if `correctanswer`=`actualanswer`=正确，并为每个问题循环。虽然我遇到的主要问题是第一次提取所有正确答案就好了，但我不能在其他时候使用它来进行比较。我不确定这是否是正确的方法，或者是否有更好的方法？

寻找正确答案：

```
 $result0 = mysql_query("SELECT * FROM itsnb_chronoforms_data_createquestions  
                WHERE quizID='$quizID' ORDER BY cf_id ASC");
      while($row0 = mysql_fetch_array($result0))
       {
         $answer = $row0['correctanswer'];
       } 
```

寻找提交的实际答案：

```
 $result = mysql_query("SELECT * FROM itsnb_chronoforms_data_answerquiz 
            WHERE quizID='$quizID' AND userID='$userID' ORDER BY cf_id ASC");

   while($row = mysql_fetch_array($result))
     { 
        $quiz = $row['quizselectanswer']; 
     } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:12:02.343

```
SELECT * FROM itsnb_chronoforms_data_answerquiz a, itsnb_chronoforms_data_createquestions
q WHERE a.quizID='$quizID' AND a.userID='$userID' and q.quizID=a.quizID and
a.quizselectanswer = q.correctanswer 
```

应该返回所有正确的答案。如果您还想要错误的答案，则需要对两个表进行外部联接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T14:18:29.870

加入可能是做到这一点的最佳方式。但你也可以使用 php `in_array()`-Function：

```
$result0 = mysql_query("SELECT * FROM itsnb_chronoforms_data_createquestions     WHERE quizID='$quizID' ORDER BY cf_id ASC");
while($row0 = mysql_fetch_array($result0))
{
    $answers[] = $row0['correctanswer'];
} 
```

进而

```
$result = mysql_query("SELECT * FROM itsnb_chronoforms_data_answerquiz WHERE     quizID='$quizID' AND userID='$userID' ORDER BY cf_id ASC");

while($row = mysql_fetch_array($result))
{ 
    if(in_array($row['quizselectanswer'],$answers)){
        ...correct...

        break;
    }
} 
```

# database - 在 PostgreSQL 9.1 中更改编码

> ID：13585904
> 
> 赞同：6
> 
> 时间：2012-11-27T14:01:53.540
> 
> 标签：database, postgresql, encoding

我有以下数据库

```
sudo -u postgres psql -c "\list"

                             List of databases
   Name    |  Owner   | Encoding | Collate | Ctype |   Access privileges   
-----------+----------+----------+---------+-------+-----------------------
 postgres  | postgres | LATIN1   | en_US   | en_US | 
 template0 | postgres | LATIN1   | en_US   | en_US | =c/postgres          +
           |          |          |         |       | postgres=CTc/postgres
 template1 | postgres | LATIN1   | en_US   | en_US | =c/postgres          +
           |          |          |         |       | postgres=CTc/postgres
(3 rows) 
```

如何在数据库中将编码从 LATIN1 更改为 UTF8`template1`或`template0`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T14:13:37.917

由于您在这里似乎没有任何实际数据，因此只需关闭并删除集群（服务器和数据库集）并重新创建它。您使用的是哪个操作系统？创建新集群的标准 PostgreSQL 命令是 initdb，但在 Debian/Ubuntu 等平台上，您通常会使用`pg_createcluster`

另请参阅[如何更改 postgres 数据库的字符编码？](https://stackoverflow.com/questions/5090858/how-do-you-change-the-character-encoding-of-a-postgres-database)

尽管您*可以*尝试调整编码，但不建议这样做。即使我在那个链接的问题中提出了建议，如果您在这里有带有 latin1 字符的数据，您需要将它们重新编码为 utf-8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-28T13:48:06.550

只需使用：

更新 pg_database 集编码 = pg_char_to_encoding('LATIN1') where datname = 'seguros'

# php - 在 mac 上安装 mariaDB

> ID：13585910
> 
> 赞同：8
> 
> 时间：2012-11-27T14:02:10.890
> 
> 标签：php, macos, macports, mariadb

我正在使用 mac 端口通过以下命令安装 mariaDB：

sudo 端口安装 mariadb-server

文件安装后，我不知道接下来会发生什么？

我试图找到任何配置指导，但我失败了，是否有人对从 mac 端口安装后的后续步骤有一些指导（比如如何启动和停止、配置等）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-05T19:51:32.253

配置通常会在 /opt/local/ 某处结束......

你可能需要

```
$ sudo port load mariadb-server 
```

, 启动它。和

```
$ sudo port unload mariadb-server 
```

, 阻止它。

这只是 macports 东西通常的工作方式——我没有专门用 mariadb 尝试过......

希望这会有帮助...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-27T18:34:29.490

安装数据库

```
sudo -u _mysql /opt/local/lib/mariadb/bin/mysql_install_db 
```

更改根密码

```
/opt/local/lib/mariadb/bin/mysqladmin -u root password 'new-password' 
```

或者，您可以运行：

```
/opt/local/lib/mariadb/bin/mysql_secure_installation' 
```

您可以使用以下命令启动 MariaDB 守护程序：

```
cd /opt/local; /opt/local/lib/mariadb/bin/mysqld_safe --datadir='/opt/local/var/db/mariadb' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-12T17:20:15.430

您可以通过[Homebrew](https://brew.sh/index_fr.html)安装它，非常简单

⚠️ 你应该安装 Homebrew

```
 2\. $ brew update
 3\. $ brew search mariadb
 4\. $ brew install mariadb 
```

安装后，您需要使用以下命令激活它：

```
$ brew services start mariadb 
```

或者，如果您不想要/不需要后台服务，您可以运行：

```
$ mysql.server start 
```

# java - 搞砸 CSV 导致异常

> ID：13585914
> 
> 赞同：4
> 
> 时间：2012-11-27T14:02:16.457
> 
> 标签：java, csv, supercsv

我想我发现了一个错误。或者可能不是，但 Super CSV 不能很好地处理。

我正在使用 MapReader 解析具有 41 列的 CSV 文件。但是，我得到了那个 CSV - 给我 CSV 的 Web 服务弄乱了一行。“标题”行是一个制表符分隔的行，有 41 个单元格。

而“错误行”是一个制表符分隔的行，有 36 个单元格，内容没有任何意义。

这是我正在使用的代码：

* * *

```
InputStream fis = new FileInputStream(pathToCsv);
InputStreamReader inReader = new InputStreamReader(fis, "ISO-8859-1");

ICsvMapReader mapReader = new CsvMapReader(inReader, new CsvPreference.Builder('"','\t',"\r\n").build());
final String[] headers = mapReader.getHeader(true);
Map<String, String> row;
while( (row = mapReader.read(headers)) != null ) {

    // do something

} 
```

* * *

在上面提到的行中执行 mapReader.read(headers) 时出现异常。这是一个例外：

```
org.supercsv.exception.SuperCsvException: 
the nameMapping array and the sourceList should be the same size (nameMapping length = 41, sourceList size = 36)
context=null
at org.supercsv.util.Util.filterListToMap(Util.java:121)
at org.supercsv.io.CsvMapReader.read(CsvMapReader.java:79)
at test.MyClass.readCSV(MyClass.java:20)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597) 
```

你觉得我应该怎么做 ？

我不希望整个应用程序崩溃，只是因为一行搞砸了，我宁愿跳过那一行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T23:17:08.707

这是一个很好的问题！作为 Super CSV 开发人员，我将研究在[网站](http://supercsv.sourceforge.net/)上创建一些异常处理示例。

您可以保持简单并使用 CsvListReader （它不关心有多少列），然后自己创建 Map ：

```
public class HandlingExceptions {

    private static final String INPUT = 
        "name\tage\nTom\t25\nAlice\nJim\t44\nMary\t33\tInvalid";

    public static void main(String[] args) throws IOException {

        // use CsvListReader (can't be sure there's the correct no. of columns)
        ICsvListReader listReader = new CsvListReader(new StringReader(INPUT), 
            new CsvPreference.Builder('"', '\t', "\r\n").build());

        final String[] headers = listReader.getHeader(true);

        List<String> row = null;
        while ((row = listReader.read()) != null) {

            if (listReader.length() != headers.length) {
                // skip row with invalid number of columns
                System.out.println("skipping invalid row: " + row);
                continue;
            }

            // safe to create map now
            Map<String, String> rowMap = new HashMap<String, String>();
            Util.filterListToMap(rowMap, headers, row);

            // do something with your map
            System.out.println(rowMap);
        }
        listReader.close();
    }
} 
```

输出：

```
{name=Tom, age=25}
skipping invalid row: [Alice]
{name=Jim, age=44}
skipping invalid row: [Mary, 33, Invalid] 
```

如果您担心使用 Super CSV 的`Util`类（它可能会改变 - 它实际上是一个内部实用程序类），您可以按照我在[这里](https://stackoverflow.com/a/11698684/1068649)的建议结合 2 个阅读器。

您可以尝试 catch `SuperCsvException`，但最终可能会抑制的不仅仅是无效的列数。我建议捕获的唯一 Super CSV 异常（尽管不适用于您的情况，因为您没有使用单元处理器）是`SuperCsvConstraintViolationException`，因为它表明文件格式正确，但数据不满足您的预期约束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T14:17:17.640

如果 CSV 文件包含无法解析的数据，您必须问自己该怎么办。跳过这些行有多重要。在一种情况下，在其他情况下将其删除可能是可以的，最好停止整个过程并告诉用户先修复文件。

我相信您可以使用 Super CSV 构建这两种场景。您绝对必须处理该异常并对上述场景做出适当的反应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T14:23:57.590

好吧，我想出了一些解决方案，但我认为这不是最佳的。

```
while (true) {
    try {
        if ((row = mapReader.read(headers)) == null) {
            break;
        } else {
            // do something
        }
    } catch (SuperCsvException ex) {
        continue;
    }
} 
```

**更新**

更改`Exception`为`SuperCsvException`

# android - ViewPager android中的动态滚动（如listView）

> ID：13585915
> 
> 赞同：0
> 
> 时间：2012-11-27T14:02:18.027
> 
> 标签：android, listview, scroll, android-viewpager

我需要我的 ViewPager 像 ListView 一样工作，我的意思是，如果你开始滚动并且手指离开 listview 继续滚动一段时间。也许，不知何故你知道如何在 ViewPager 中实现这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:13:37.090

也许你应该试试 Horizo​​ntalScrollView？

[http://developer.android.com/reference/android/widget/Horizo​​ntalScrollView.html](http://developer.android.com/reference/android/widget/HorizontalScrollView.html)

# log4j - 每次执行的 Log4j 滚动文件

> ID：13585921
> 
> 赞同：4
> 
> 时间：2012-11-27T14:02:40.343
> 
> 标签：log4j

我有一个 Java 项目，它使用作为批处理的 log4j appender。

我希望它为每次执行滚动一个文件。

Log4j 提供了按时间段`DailyRollingFileAppender`（`RollingFileAppender`

有没有办法手动触发文件滚动？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T14:02:40.343

最后，这很容易，我只需要执行以下操作：

```
for (Enumeration<Appender> e = Logger.getRootLogger().getAllAppenders(); e.hasMoreElements();) {
            Appender a = e.nextElement();
            if (a instanceof RollingFileAppender) {
                ((RollingFileAppender) a).rollOver();
            }
        } 
```

在批次开始时...

# android - android项目中的dexedLibs文件夹

> ID：13585924
> 
> 赞同：10
> 
> 时间：2012-11-27T14:02:55.503
> 
> 标签：android, developer-tools

所以我最近注意到我的 Phonegap/Android 项目 (project/bin/dexedLibs) 中有一个文件夹，这个文件夹包含两个 .jar 文件。在浏览了互联网之后，我发现了一个网站，其中作者说 ADT 版本 21 将“预索引库”放入项目中以加快构建时间。

我最近确实升级到了 ADT 21，只是想知道是否有人可以给我更多关于这些“预索引库”真正做什么的信息？我无法在网上找到任何其他有用的信息。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-30T13:35:34.023

我有一个包含大约 20 个外部库的 Android 项目。在 ADT 21 之前，每次我更改源代码都需要很长时间来重建应用程序。现在速度相当快！

我猜原因是，在 ADT 21 之前，每次在 Eclipse 中点击“运行”按钮时，它都会将外部库编译成 dex 代码。现在它将只为外部库编译一次 dex 代码（直到它们改变），并将预构建库用于以后的“运行”。

我喜欢这个功能！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-12T20:36:44.227

意识到！我刚刚花了一个小时来找出为什么会出现异常：

```
Caused by: java.lang.NoSuchMethodError: 
```

原因是因为我用工作方法将我的lib jar更改为新的jar（同名），而ADT 21没有在dexedLibs中准备新的。

所以只需删除 bin 目录，Eclipse 就会重新创建它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-01T13:32:37.633

这个问题大约有 2 年的历史，但仍然很有趣。

对于稍后浏览这里的人：我只是遇到了麻烦，因为我将 Cordova 项目从`my.name.a3e`to重命名`my.name.A3E`，然后构建过程崩溃了。发现 ant-build 中的 dexed 文件没有刷新（区分大小写）。删除`ant-build`文件夹后它工作正常，但第一次构建需要更长的时间。

一个dex文件是一个Dalvik EXecutable文件，一些编译后的字节码可以被Dalvik虚拟机执行。Dalvik 是 Android 的核心组件，这就是它存在的原因。

[http://sourceforge.net/projects/dexer/](http://sourceforge.net/projects/dexer/) [http://developer.android.com/reference/dalvik/system/DexFile.html](http://developer.android.com/reference/dalvik/system/DexFile.html) [http://fileinfo.com/extension/dex](http://fileinfo.com/extension/dex)

请注意，Eclipse 项目 clean 不会删除 dexed 库。

# scala - Using Akka in Scala IDE

> ID：13585927
> 
> 赞同：2
> 
> 时间：2012-11-27T14:02:59.487
> 
> 标签：scala, akka, scala-ide

I have Scala IDE already setup because I used it for Coursera course "Functional Programming Principles in Scala" by Martin Odersky.

Now i want to use Akka framework in the same IDE.

Is there any Scala IDE Akka plugin available which i can import directly?

I tried to reference all the akka provided jars in a new Scala Project. I am able to run the basic akka [example](http://typesafe.com/resources/tutorials/getting-started-with-akka-scala.html) this way.

But when I try to work with `Dispatchers`, the code is not compiling.

```
object TestActor {
    val dispatcher = Dispatchers.newExecutorBasedEventDrivenWorkStealingDispatcher("pool")
               .setCorePoolSize(100)
               .setMaxPoolSize(100)
               .build
} 
```

I am trying to use Akka 2.0.2 on Scala 2.9

What is the surest way to configure and run akka 2.0.2 or 2.0.4 in Scala IDE?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T01:32:26.477

You're mixing up Akka 1.x APIs (Dispatcher.newXXX) with Akka 2.0 APIs. Please refer to the reference documentation: [http://doc.akka.io/docs/akka/2.0.4/](http://doc.akka.io/docs/akka/2.0.4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:59:26.890

For setting up a quick and dirty Akka 2.0.2 project in IntelliJ, I've had the best luck using Maven. My guess is you could probably get Scala IDE to use Maven to pull in the dependencies using something like what I show below. My pom.xml file looks like this:

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
         http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <name>myProject</name>
    <groupId>myProject</groupId>
    <artifactId>myProject</artifactId>
    <packaging>jar</packaging>
    <version>0.1</version>
    <url>http://example.com</url>

    <dependencies>
        <dependency>
            <groupId>com.typesafe.akka</groupId>
            <artifactId>akka-actor</artifactId>
            <version>2.0.2</version>
        </dependency>
        <dependency>
            <groupId>org.scala-lang</groupId>
            <artifactId>scala-library</artifactId>
            <version>2.9.0-1</version>
            <scope>compile</scope>
        </dependency>
    </dependencies>
    <repositories>
        <repository>
            <id>typesafe</id>
            <name>Typesafe Repository</name>
            <url>http://repo.typesafe.com/typesafe/releases/</url>
        </repository>
    </repositories>
</project> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T15:07:38.533

Here is the surest way.

I was in the same situation as you - I just finished the coursera class, had the integrated Scala IDE set up, want to explore Akka. Here is what I found.

Go to [Installing the Typesafe Stack](http://typesafe.com/resources/typesafe-stack/downloading-installing.html "Installing the Typesafe Stack"). Follow the instructions for setting up scala, sbt, giter8 etc. for your machine. Go to [Getting Started With Akka (Scala)](http://typesafe.com/resources/tutorials/getting-started-with-akka-scala.html "Getting Started With Akka (Scala)"). This will take you through how to use the Typesafe templates to get an Akka project set up just like you were used to in the coursera class. Pay special attention to "Setting up The Scala IDE for Eclipse (optional)". Adding that, you will have a Scala project, with all the Akka dependencies installed, ready to develop in Eclipse. You'll feel right at home.

# javascript - 使用 grunt.js 生成动态文件名

> ID：13585928
> 
> 赞同：1
> 
> 时间：2012-11-27T14:02:59.667
> 
> 标签：javascript, node.js, gruntjs

是否可以在内置的 grunt 任务（例如`concat`or `min`）之外生成动态文件名？我尝试使用类似`<config:concat.dist.dest>`或`<%= dirs.dest %>`文档中描述的东西。但这永远不会被解释/编译，它只是写出字符串。

**更新：** 这就是我根据 jakub.g 的回答所尝试的。我的 grunt.js 看起来像这样：

```
// ... grunt file contents
    jquery: {
      exclude: [],
      version: '1.8.3',
      dest: '../dist/js/jquery-' + grunt.task.directive('<config:jquery.version>') + '.js',
      minify: false
    }, // ... even more grunt file contents 
```

`grunt.task.directive('<config:jquery.version>')`返回`null`。所以文件名被命名为`jquery-null.js`.

然后我尝试了`grunt.template.process('<%= grunt.jquery.version %>')`and `grunt.config.process('<%= grunt.jquery.version %>')`，但没有一个起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:33:32.397

这隐藏在 Grunt 魔法的内置任务中，实际上记录得不够清楚。

您需要使用 sth like [`grunt.task.directive(dest)`](https://github.com/gruntjs/grunt/blob/master/docs/api_task.md#directives)来评估`<config:..>`. 在自定义任务中。

对于`<%= foo %>`，看看[Grunt 模板](https://github.com/gruntjs/grunt/blob/master/docs/api_template.md)。

此外，通配符`*`和`**`默认情况下也不会扩展，如果您想在自定义任务中使用它们，您可以使用`grunt.file.expandFiles()`.

# c# - 为什么 Application.GetResourceStream 在 WP7 中总是返回 null？

> ID：13585931
> 
> 赞同：0
> 
> 时间：2012-11-27T14:03:05.557
> 
> 标签：c#, windows-phone-7, embedded-resource

我正在创建一个 Windows Phone 应用程序，并将关卡数据存储在文本文件中。

我有以下问题：我试图从文件中读取所有行，每次调用`Application.GetResourceStream`它时都会返回`null`。

我知道这个话题是由不同的人提出的，但所有的解决方案都对我不起作用。

这是代码：

```
List<String> fileLines = new List<string>();
var resource = Application.GetResourceStream(
                         new Uri("Level_data/Level_1.txt", UriKind.Relative));
StreamReader streamReader = new StreamReader(resource.Stream);
string line;
while ((line = streamReader.ReadLine()) != null)
    fileLines.Add(line); 
```

此外，解决方案资源管理器看起来像这样。构建操作设置为“资源”，但我也先尝试了“内容”，但也没有用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T09:13:55.573

以下代码有效：

```
 Uri u = new Uri("WindowsPhoneGame1;component/Level_data/Level_1.txt",
                                                             UriKind.Relative);
    StreamResourceInfo sInfo=Application.GetResourceStream(u);
    StreamReader sr=  new StreamReader(sInfo.Stream);
    string line;
    while ((line = sr.ReadLine()) != null)
         fileLines.Add(line);
    sr.Close(); 
```

它之前不起作用的唯一原因是 Uri 的路径是错误的。现在是：`WindowsPhoneGame1;component/Level_data/Level_1.txt`即`(ProjectName);component/(RelativePath)`

# java - 如何在java中使用jdom更改xml内部节点的值

> ID：13585933
> 
> 赞同：1
> 
> 时间：2012-11-27T14:03:13.723
> 
> 标签：java, xml, jdom

我已经尝试通过引用此链接在 jdom 的帮助下更改 xml 值 - [http://www.mkyong.com/java/how-to-modify-xml-file-in-java-jdom/](http://www.mkyong.com/java/how-to-modify-xml-file-in-java-jdom/)

示例中显示的 xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<company>
  <staff id="1">
    <firstname>yong</firstname>
    <lastname>mook kim</lastname>
    <nickname>mkyong</nickname>
    <salary>5000</salary>
  </staff>
</company> 
```

我不清楚如何处理以下 xml 场景：

```
<?xml version="1.0" encoding="UTF-8"?>
<company>
  <staff>
    <firstname>yong</firstname>
    <lastname>mook kim</lastname>
    <nickname>mkyong</nickname>
    <salary>
        <basic>1000</basic>
        <hra>150</hra>
   </salary>
  </staff>
  <staff>
    <firstname>sanjay</firstname>
    <lastname>machani</lastname>
    <nickname>chong</nickname>
    <salary>
        <basic>2000</basic>
        <hra>200</hra>
   </salary>
  </staff>
</company> 
```

我的员工标签不会有身份证，我也会有工资标签。但我需要使用 java 在 xml 中更改 sanjay(firstname) 的薪水。

任何的意见都将会有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T22:46:08.880

如果您使用的是 JDOM，则可以使用以下方法遍历元素：

```
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.util.List;
import org.jdom2.Document;
import org.jdom2.Element;
import org.jdom2.JDOMException;
import org.jdom2.input.SAXBuilder;
import org.jdom2.output.Format;
import org.jdom2.output.XMLOutputter;

    public class yourClass{
    public static void main(String[] args) {

        File xml = new File("yourFile.xml");
        try {
            Document doc = (Document) new SAXBuilder().build(xml);
            Element rootNode = doc.getRootElement();
            List list = rootNode.getChildren("staff");
            XMLOutputter xmlOut = new XMLOutputter();

            for (int i = 0; i < list.size(); i++) {

                Element node = (Element) list.get(i);
                if (node.getChildText("firstname").equals("sanjay"))
                    node.getChild("salary").getChild("basic").setText("250000");
                xmlOut.setFormat(Format.getPrettyFormat());
                xmlOut.output(doc, new FileWriter("yourFile.xml"));
            }
        } catch (IOException io) {
            System.out.println(io.getMessage());
        } catch (JDOMException jdomex) {
            System.out.println(jdomex.getMessage());
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T15:33:54.973

如何使用 XPath：

```
public class ReadSalaryFromStaffTest {

private String xmlData;

@Before
public void init() {
    xmlData = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
    "<company>\n" +
    "  <staff>\n" +
    "    <firstname>yong</firstname>\n" +
    "    <lastname>mook kim</lastname>\n" +
    "    <nickname>mkyong</nickname>\n" +
    "    <salary>\n" +
    "        <basic>1000</basic>\n" +
    "        <hra>150</hra>\n" +
    "   </salary>\n" +
    "  </staff>\n" +
    "  <staff>\n" +
    "    <firstname>sanjay</firstname>\n" +
    "    <lastname>machani</lastname>\n" +
    "    <nickname>chong</nickname>\n" +
    "    <salary>\n" +
    "        <basic>2000</basic>\n" +
    "        <hra>200</hra>\n" +
    "   </salary>\n" +
    "  </staff>\n" +
    "</company>";

}

@Test
public void shouldChangeBaseSalaryInLastNameMachani() throws Exception{
    final SAXBuilder saxbuilder = new SAXBuilder();
    final Document document = saxbuilder.build(new StringReader(xmlData));

    final XPathExpression<Element> compile = XPathFactory.instance().compile("//lastname[text()=\"machani\"]/../salary/basic", new ElementFilter());

    final Element machaniBaseSalary = compile.evaluateFirst(document);

    assertThat(machaniBaseSalary.getText(), is("2000"));
    machaniBaseSalary.setText("2100");
    assertThat(machaniBaseSalary.getText(), is("2100"));
} 
```

}

# php - 使用 PHP 对 MySQL 数据库进行二进制安全备份

> ID：13585934
> 
> 赞同：0
> 
> 时间：2012-11-27T14:03:14.823
> 
> 标签：php, mysql

我使用[http://davidwalsh.name/backup-mysql-database-php](http://davidwalsh.name/backup-mysql-database-php)来备份我的 mysql 数据库。但它会破坏数据库中的二进制数据（blob）。这意味着，导入生成的文件会创建不可读的 blob。

应该改变什么？

为方便起见，代码如下：

```
backup_tables('localhost','username','password','blog');

/* backup the db OR just a table */
function backup_tables($host,$user,$pass,$name,$tables = '*')
{

  $link = mysql_connect($host,$user,$pass);
  mysql_select_db($name,$link);

  //get all of the tables
  if($tables == '*')
  {
    $tables = array();
    $result = mysql_query('SHOW TABLES');
    while($row = mysql_fetch_row($result))
    {
      $tables[] = $row[0];
    }
  }
  else
  {
    $tables = is_array($tables) ? $tables : explode(',',$tables);
  }

  //cycle through
  foreach($tables as $table)
  {
    $result = mysql_query('SELECT * FROM '.$table);
    $num_fields = mysql_num_fields($result);

    $return.= 'DROP TABLE '.$table.';';
    $row2 = mysql_fetch_row(mysql_query('SHOW CREATE TABLE '.$table));
    $return.= "\n\n".$row2[1].";\n\n";

    for ($i = 0; $i < $num_fields; $i++) 
    {
      while($row = mysql_fetch_row($result))
      {
        $return.= 'INSERT INTO '.$table.' VALUES(';
        for($j=0; $j<$num_fields; $j++) 
        {
          $row[$j] = addslashes($row[$j]);
          $row[$j] = ereg_replace("\n","\\n",$row[$j]);
          if (isset($row[$j])) { $return.= '"'.$row[$j].'"' ; } else { $return.= '""'; }
          if ($j<($num_fields-1)) { $return.= ','; }
        }
        $return.= ");\n";
      }
    }
    $return.="\n\n\n";
  }

  //save file
  $handle = fopen('db-backup-'.time().'-'.(md5(implode(',',$tables))).'.sql','w+');
  fwrite($handle,$return);
  fclose($handle);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:51:36.510

我只会看这篇文章的评论。

当您从 PHP 中运行其他进程时，您应该检查返回码，例如：

```
// execute process and capture output and return code in $out and $res
exec('/path/to/command', $out, $res);
if ($res) {
    // the process didn't return with code 0
} 
```

在您的情况下，`$out`将是空的，因为`stderr`用于打印错误消息；要在捕获的输出中显示这些，您可以`stderr`像这样重定向：

```
exec('/path/to/command 2>&1', $out, $res); 
```

可以单独处理另一个进程的各种输入/输出流的更复杂的设置涉及 using `proc_open()`，但这是非常高级的东西，在您的情况下可能没有必要。

# oauth - DotNetOpenAuth 谷歌 OAuth2

> ID：13585937
> 
> 赞同：3
> 
> 时间：2012-11-27T14:03:26.107
> 
> 标签：oauth, oauth-2.0, dotnetopenauth

在最后一个 DotNetOpenAuth 包中，GoogleClient 扩展了 OpenIdClient，有人知道我在哪里可以找到扩展 DotNetOpenAuth OAuth2Client 的 google Oauth2 的实现？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-01-02T14:30:21.273

来自[OAuth2 和 DotNetOpenAuth - 实现 Google 自定义客户端](https://stackoverflow.com/questions/13727466/oauth2-and-dotnetopenauth-implementing-google-custom-client)

```
public class GoogleOAuth2Client : OAuth2Client
{
    #region Constants and Fields

    /// <summary>
    /// The authorization endpoint.
    /// </summary>
    private const string AuthorizationEndpoint = "https://accounts.google.com/o/oauth2/auth";

    /// <summary>
    /// The token endpoint.
    /// </summary>
    private const string TokenEndpoint = "https://accounts.google.com/o/oauth2/token";

    /// <summary>
    /// The _app id.
    /// </summary>
    private readonly string _clientId;

    /// <summary>
    /// The _app secret.
    /// </summary>
    private readonly string _clientSecret;

    #endregion

    public const string ProviderAppendix = "__provider__=google";

    public GoogleOAuth2Client(string clientId, string clientSecret)
        : base("google")
    {
        if (string.IsNullOrWhiteSpace(clientId)) throw new ArgumentNullException("clientId");
        if (string.IsNullOrWhiteSpace(clientSecret)) throw new ArgumentNullException("clientSecret");

        this._clientId = clientId;
        this._clientSecret = clientSecret;
    }

    protected override Uri GetServiceLoginUrl(Uri returnUrl)
    {
        StringBuilder serviceUrl = new StringBuilder();

        serviceUrl.AppendFormat("{0}?scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile", AuthorizationEndpoint);
        serviceUrl.Append("&state=google");
        serviceUrl.AppendFormat("&redirect_uri={0}", returnUrl.ToString().ToLower());
        serviceUrl.Append("&response_type=code");
        serviceUrl.AppendFormat("&client_id={0}", _clientId);

        return new Uri(serviceUrl.ToString());
    }

    protected override IDictionary<string, string> GetUserData(string accessToken)
    {
        var client = new RestClient("https://www.googleapis.com");
        var request = new RestRequest(String.Format("/oauth2/v1/userinfo?access_token={0}", accessToken), Method.GET);
        IDictionary<String, String> extraData = new Dictionary<String, String>();

        var response = client.Execute(request);
        if (null != response.ErrorException)
        {
            return null;
        }
        else
        {
            try
            {
                var json = JObject.Parse(response.Content);

                string firstName = (string)json["given_name"];
                string lastName = (string)json["family_name"];
                string emailAddress = (string)json["email"];
                string id = (string)json["id"];

                extraData = new Dictionary<String, String>
            {
                {"accesstoken", accessToken}, 
                {"name", String.Format("{0} {1}", firstName, lastName)},
                {"firstname", firstName},
                {"lastname", lastName},
                {"email", emailAddress},
                {"id", id}                                           
            };
            }
            catch (Exception ex)
            {
                Ccl.Log.Logging.Error("Error requesting OAuth user data from Google", ex);
                return null;
            }

            return extraData;
        }
    }

    protected override string QueryAccessToken(Uri returnUrl, string authorizationCode)
    {
        StringBuilder postData = new StringBuilder();
        postData.AppendFormat("client_id={0}", this._clientId);
        postData.AppendFormat("&redirect_uri={0}", HttpUtility.UrlEncode(returnUrl.ToString().ToLower()));
        postData.AppendFormat("&client_secret={0}", this._clientSecret);
        postData.AppendFormat("&grant_type={0}", "authorization_code");
        postData.AppendFormat("&code={0}", authorizationCode);

        string response = "";
        string accessToken = "";

        var webRequest = (HttpWebRequest)WebRequest.Create(TokenEndpoint);

        webRequest.Method = "POST";
        webRequest.ContentType = "application/x-www-form-urlencoded";

        try
        {

            using (Stream s = webRequest.GetRequestStream())
            {
                using (StreamWriter sw = new StreamWriter(s))
                    sw.Write(postData.ToString());
            }

            using (WebResponse webResponse = webRequest.GetResponse())
            {
                using (var reader = new StreamReader(webResponse.GetResponseStream()))
                {
                    response = reader.ReadToEnd();
                }
            }

            var json = JObject.Parse(response);
            accessToken = (string)json["access_token"];
        }
        catch (Exception ex)
        {
            Ccl.Log.Logging.Error("Error requesting OAuth access token from Google", ex);
            return null;
        }

        return accessToken;
    }

    public override AuthenticationResult VerifyAuthentication(HttpContextBase context, Uri returnPageUrl)
    {
        string code = context.Request.QueryString["code"];
        if (string.IsNullOrEmpty(code))
        {
            return AuthenticationResult.Failed;
        }

        string accessToken = this.QueryAccessToken(returnPageUrl, code);
        if (accessToken == null)
        {
            return AuthenticationResult.Failed;
        }

        IDictionary<string, string> userData = this.GetUserData(accessToken);
        if (userData == null)
        {
            return AuthenticationResult.Failed;
        }

        string id = userData["id"];
        string name;

        // Some oAuth providers do not return value for the 'username' attribute. 
        // In that case, try the 'name' attribute. If it's still unavailable, fall back to 'id'
        if (!userData.TryGetValue("username", out name) && !userData.TryGetValue("name", out name))
        {
            name = id;
        }

        // add the access token to the user data dictionary just in case page developers want to use it
        userData["accesstoken"] = accessToken;

        return new AuthenticationResult(
            isSuccessful: true, provider: this.ProviderName, providerUserId: id, userName: name, extraData: userData);
    }
} 
```

# jquery - 动态创建时的 IE7 单选按钮问题

> ID：13585939
> 
> 赞同：1
> 
> 时间：2012-11-27T14:03:26.983
> 
> 标签：jquery, forms, internet-explorer, internet-explorer-7, radio-button

当我创建单选按钮的克隆时，我在 IE7 中遇到问题。我正在动态更新名称和 ID 属性，但是，我仍然遇到一个问题，即选中的单选按钮会重置任何其他已动态创建的按钮。知道如何解决这个问题吗？[这是问题的一个小提琴](http://jsfiddle.net/w9UJ8/)

这是操作表单字段的 JS 代码：

```
// Dropdown select
$('#quantity').live("change", function(){

    $('.questions_clonable:not(.questions_clonable:first)').remove();

    // Get value of selection
    var num = $(this).val();

    var cloned_el = $('.questions_clonable').clone();   

    if (num > 1)
    {  
        for (var i = 1; i < num; i++)
        {
            // Assign cloned block to new var
            var new_block = cloned_el;  

             // Store previous number for replacing with current in cloned block input fields
                var prev = i-1;

                // Update input name to make it unique
                new_block.find('input').each(function() {     
                    this.name = this.name.replace(prev, i); 
                    this.id = this.id + i; 
                });

            // Bit of a workaround needed to clone properly, reiterating class name
            $('.multiple_questions_container').append('<span class="questions_clonable hidden">'+new_block.html()+'</span>');

        }   
    }
});​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T14:59:03.550

IE7 在动态创建单选按钮方面存在问题，这很奇怪，因为它是一款非常棒的浏览器。看来 IE7 不会让你重命名`name`单选按钮的属性。

[这](http://code.rawlinson.us/2006/03/another-ie-gotcha-dynamiclly-created.html)是一个可能的解决方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T17:41:30.303

我为此找到了几个可能的修复方法，但以下方法效果很好：

```
function setElementName(elems, name) {
        if ($.browser.msie === true){
            $(elems).each(function() {
                this.mergeAttributes(document.createElement("<input name='" + name + "'/>"), false);
            });
        } else {
            $(elems).attr('name', name);
        }
    } 
```

# c# - C# 引用属性的类的名称

> ID：13585944
> 
> 赞同：0
> 
> 时间：2012-11-27T14:03:39.080
> 
> 标签：c#, data-binding, reflection

无论如何要传递一个对象并取回持有对它的引用的对象吗？

例子：

```
public class Person
{
    public string Name { get; set; }

    public Person(string name)
    {
        this.Name = name;
    }
}

public static class Helper
{

    public static void IsItPossible()
    {
        var person = new Person("John Doe");

        var whoKnowsMe = WhoIsReferencingMe(person.Name);

        //It should return a reference to person
    }

    public static object WhoIsReferencingMe(object aProperty)
    {
        //The magic of reflection
        return null;
    }
} 
```

这里的代码是愚蠢的。但我将使用它来简化 Windows 窗体解决方案中的 DataBinding。

这是我将使用它的地方：

```
 protected void Bind(object sourceObject, object sourceMember, 
        Control destinationObject, object destinationMember)
    {
        //public Binding(string propertyName, object dataSource, string dataMember);
        string propertyName = GetPropertyName(() => destinationMember);
        string dataMember = GetPropertyName(() => sourceMember);

        Binding binding = new Binding(propertyName, sourceObject, dataMember);

        destinationObject.DataBindings.Add(binding);
    }

    public  string GetPropertyName<T>(Expression<Func<T>> exp)
    {
        return (((MemberExpression)(exp.Body)).Member).Name;
    } 
```

原因是该功能有点多余：

```
 this.Bind(viewModel.Client, viewModel.Client.Id, view.icClientId, tiew.icClientId.Text); 
```

我要求将其简化为：

```
 this.Bind(viewModel.Client.Id, view.icClientId.Text); 
```

所以……这有可能发生吗？还是有一种我不知道的更简单的绑定方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:06:37.070

> 无论如何要传递一个对象并取回持有对它的引用的对象吗？

不，一般来说。如果您使用调试器 API，*可能*有一些方法可以做到这一点，但*仅*用于调试目的。您的产品设计不应该需要它。

不过，您可能会使用表达式树：

```
this.Bind(() => viewModel.Client.Id, () => view.icClientId.Text); 
```

...并从表达式树中计算出原始对象和它正在使用的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:06:17.767

> 无论如何要传递一个对象并取回持有对它的引用的对象吗？

不，这不可能作为内置功能。你必须在你的代码中构建它。对象本身不知道指向它的引用。这是一种`GC`责任，要对此进行追踪。

# forms - 像传递另一个 bean 的属性一样传递一个 bean (struts 1.x)

> ID：13585948
> 
> 赞同：0
> 
> 时间：2012-11-27T14:04:02.753
> 
> 标签：forms, javabeans, struts-1

我有两个表单（以及相应的表单 bean），一个在 page1.jsp 上，另一个在 page2.jsp 上（第二个表单是通过 json 动态创建的）。form1 是`mypackage.MyActionForm1`类型，而 form2 是`mypackage.MyActionForm2`类型。在提交第一个表单时执行的操作中，我创建了一个`MyActionForm2`并将`MyActionForm1`表单设置为其属性：

```
MyActionForm2 secondBean = new MyActionForm2();
secondBean.setBeanProp(form1);
request.setAttribute("secondbean", secondBean); 
```

在 jsp 中，我成功访问了以下属性`form1`：

```
${secondbean.beanProp.prop1} 
```

但是如何将第一个 bean 传递给在`form2`提交第二个表单时执行的 Action？

```
form2.getBeanProp().getProp1() // form2.getBeanProp() gives a NullPointerException 
```

我不会使用会话范围。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:02:07.180

如果您的`form2.getBeanProp()`bean 的每个属性都没有隐藏字段，那么显然 Struts 将无法凭空重建这个 bean。

为了能够填充由`prop1`返回的 bean的属性`actionForm.getBeanProp()`，您需要一个名为 的隐藏字段`beanProp.prop1`。如果您不想`beanProp`将 HTML 表单中的整个状态作为隐藏字段，则将此 bean 存储在会话中。

# asp.net - 获取所有文件夹直到最后一级

> ID：13585950
> 
> 赞同：0
> 
> 时间：2012-11-27T14:04:08.503
> 
> 标签：asp.net, asp.net-mvc, io, asp.net-mvc-4, directory

我想从根目录检索所有子目录，直到最后一级。

我已经调整了我的代码，但它只检索第一级文件夹和其中的文件。

有没有办法一直走到最后一层？

这是代码

```
 Response.Write("<ul class=\"jqueryFileTree\" style=\"display: none;\">\n");

    foreach (DriveInfo drive in allDrives)
    {
        if (drive.IsReady == true) 
        {
            Response.Write("\t<li class=\"drive collapsed\"><a href=\"#\" rel=\"" + drive.ToString() + "\">" + drive.ToString() + "</a>\n");     

            System.IO.DirectoryInfo di = new System.IO.DirectoryInfo(drive.ToString());
            Response.Write("<ul>");

            foreach (System.IO.DirectoryInfo di_child in di.GetDirectories())
            {
                Response.Write("\t<li class=\"directory collapsed\"><a href=\"#\" rel=\"" + drive + di_child.Name + "/\">" + di_child.Name + "</a>\n");
                Response.Write("<ul>");

                foreach (System.IO.FileInfo fi in di.GetFiles())
                {
                    string ext = "";

                    if (fi.Extension.Length > 1)
                    {
                        ext = fi.Extension.Substring(1).ToLower();
                    }

                    Response.Write("\t<li class=\"file ext_" + ext + "\"><a href=\"#\" rel=\"" + drive + fi.Name + "\">" + fi.Name + "</a></li>\n");
                }

                Response.Write("</ul></li>");
            }
            Response.Write("</ul></li>");
       }
    }

    Response.Write("</ul>");
}
catch (Exception)
{
    throw;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T14:10:24.600

你需要一个递归函数。

```
private IEnumerable<dynamic> GetFilesByDirectory(string path)
{
    var directories = Directory.GetDirectories(path);
    var files = Directory.GetFiles(path);

    yield return new {path, directories, files };

    foreach(var directory in directories)
    {
        yield return GetFilesByDirectory(directory);
    }
} 
```

并作为旁注。您不应该在控制器操作中调用 Response.Write 。相反，您可以返回一个`ActionResult`用于渲染视图并将您的 html 模板放入视图中。

# uibutton - 通过 ID 更改 UIButton 突出显示

> ID：13585954
> 
> 赞同：0
> 
> 时间：2012-11-27T14:04:22.887
> 
> 标签：uibutton, sender-id

我目前有一个方法允许用户按下按钮并将其状态设置为 isSelected = YES，然后将此按钮的标题附加到 NSString。如果用户然后再次按下按钮，则标题将从字符串中删除，并且按钮 isSelected = NO。

任何连接到此方法的按钮都会成功地从所述字符串中添加和删除文本。这是通过以下方法在方法中完成的：

```
UIButton *tempbutton = (UIButton *)sender; 
```

然后我从这个 tempButton 获取标题并附加到一个字符串。现在我有很多按钮，用户可以在此菜单中按下，但我想做的是循环浏览视图中的所有按钮并设置它们的 isSelected = NO。我希望能够做到这一点，而不必为每个按钮设置属性/合成。

这可能吗，我可以发布我很快尝试过的代码，但如果有这样做的标准方法，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:38:26.257

好的，我想通了，我只是将情节提要中的每个 UIButton 连接到单个插座集合（新的引用插座集合），然后循环遍历设置按钮选定状态的数组。

```
// remove button highlights
for (int i =0; i<[quickNotesCollection count]; i++){
[[quickNotesCollection objectAtIndex:i]setSelected:NO];
} 
```

希望这可以帮助其他有类似问题的人，我第二次回答了我自己的问题:)

# java - 如何去不同的班级执行代码并返回上一个班级

> ID：13585958
> 
> 赞同：0
> 
> 时间：2012-11-27T14:04:38.477
> 
> 标签：java, class

我现在大学二年级。我发现这一年非常艰难，我看不到自己过去了。但不管怎么说。我目前正在开发一个 Java 项目。该项目基于国家汽车测试（NCT）。

基本上我想做的是选择数字来进行全面测试或重新测试。如果用户选择一个完整的测试然后我想去 fullTest 类并执行一些从个人信息开始的问题，然后是汽车详细信息，然后是汽车测试问题。例如油位正常吗？是/否

我想知道的是如何通过代码运行到完整测试类，然后以太显示完整测试类的结果并将结果返回给 mainNct。

```
package Nct;

import java.util.Scanner;

public class MainNCT 
{

public static int choice = -1;

public static void main( String[] args) 
{

    Scanner Console = new Scanner(System.in);

    System.out.println("Menu\n\t1\. Full Test\n\t2\. Re-test\n\t0\. Exit\n");

    System.out.print("Enter a number: ");
    choice = Console.nextInt();

    switch(choice)
    {
        case 1:
            //Go to fulltest class
            break;
        case 2:
            //Go to retest class
            break;
        case 0:
            System.exit(0);
            break;
        default:
            System.out.println("Invalid number entered");
    } // switch

}

} 
```

和

```
package Nct;

import java.util.Scanner;

public class FullTest extends MainNCT {

int wheelAliResult = 0;
String wheelResult;

public FullTest() {

    Scanner Console = new Scanner(System.in);
    //Questions here

    System.out.print("Wheel alingment (%)? ");
    wheelAliResult = Console.nextInt();

    if(wheelAliResult < 0 || wheelAliResult > 6)
    {
        wheelResult = "Fail";
    }
    else
    {
        wheelResult = "Pass";
    }

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:08:38.397

根据您到目前为止的代码，因为逻辑似乎都驻留在您的`FullTest`构造函数中，所以应该这样做：

```
switch(choice)
{
    case 1:
        FullTest ft = new FullTest();
        break;
    case 2:
        ReTest rt = new ReTest();
        break;
    case 0:
        System.exit(0);
        break;
    default:
        System.out.println("Invalid number entered");
} // switch 
```

我假设你也有一个班级`ReTest`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:17:41.433

首先制作一个方法，例如`boolean chkOilLevel()`在`FullTest`课堂上，它将返回您`true`或`false`评估后：

```
boolean chkOilLevel(){
Scanner Console = new Scanner(System.in);
//Questions here

System.out.print("Wheel alingment (%)? ");
wheelAliResult = Console.nextInt();

if(wheelAliResult < 0 || wheelAliResult > 6)
{
    wheelResult = true;
}
else
{
    wheelResult = false;
}
return wheelResult;
} 
```

`MainNCT`您可以通过制作`FullTest`as的对象来调用此类方法

```
FullTest fullTest=new FullTest(); 
```

`MainNCT`并且可以在您的班级中调用此方法

```
 case 1:
           boolean oilLevel=fullTest.chkOilLevel();
           // Do Whatever you want with oilLevel
           break; 
```

这东西将来也会对你有所帮助......

# jquery - 在 opencart 中标题部分的愿望清单链接中换行 span

> ID：13585963
> 
> 赞同：6
> 
> 时间：2012-11-27T14:04:53.063
> 
> 标签：jquery, opencart

我想在我的 opencart 主题中的标题部分的愿望清单链接上包装一个跨度。

我已经尝试了以下尝试但没有成功，任何人都可以提出更好的方法吗？

**这有效，但仅将跨度包裹一秒钟，然后再次回到默认状态。一个班级（whis）被添加到“添加到愿望清单”链接中**

```
$(document).ready(function(e) {
    $('.whis').click(function(){
        $("#header .links #wishlist-total").wrapInner("<span></span>");     
    });
}); 
```

**直到点击产品的“添加到愿望清单”链接之前，它都有效。**

```
$(document).ready(function(e) {
     $("#header .links #wishlist-total").wrapInner("<span></span>");            
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T04:55:33.193

尝试使用 jQuery [.live()](http://api.jquery.com/live/)函数

```
$(function() {
    $(".whis").live("click", function(){
        $("#header .links #wishlist-total").wrapInner("<span/>");
    });
}); 
```

# unit-testing - 如何使用 Mocha 在 Angular.js 中测试使用 angular.module().controller() 创建的控制器

> ID：13585964
> 
> 赞同：16
> 
> 时间：2012-11-27T14:04:56.460
> 
> 标签：unit-testing, controller, angularjs, mocha.js

在这种情况下，我有一个使用 angular.module().controller() 创建的控制器

```
myModule = angular.module('myApp.controllers', [])
                   .controller('testCtrl', ['$scope', function($scope){
                           $scope.test = 'this is a test';
                    }]); 
```

现在，我需要使用 mocha 来测试我的控制器是否正常工作。在 Angular 中，有一些示例将控制器声明为全局函数（例如[http://docs.angularjs.org/tutorial/step_04](http://docs.angularjs.org/tutorial/step_04)），因此它们使用

```
function PhoneListCtrl() {...}
.....
beforeEach(function() {
   scope = {},
   ctrl = new PhoneListCtrl(scope);
});

it('shod test whatever PhoneListCtrl does ', function() {
   expect(scope.someProp).toBe('whateverValue');
}); 
```

所以问题是：

1）如何对使用 angular.module().controller() 声明的控制器进行类似的测试

2）如何使用摩卡做到这一点

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-28T18:48:23.543

AngularJS 提供了模拟，在测试时为依赖注入提供了一些有用的功能。

*   [模块](https://docs.angularjs.org/api/ngMock/function/angular.mock.module)
*   [注入](https://docs.angularjs.org/api/ngMock/function/angular.mock.inject)

## 例子：

*（在茉莉花中）*

假设我们要执行[官方教程](https://docs.angularjs.org/tutorial/step_02)中的第一个测试，并且我们已经定义了一个控制器模块。（您可以命名模块名称，但我想保持简单）

```
var Controllers = angular.module('controllers', []);

Controllers.controller('PhoneListCtrl', ['$scope', function($scope){
    $scope.phones = [{name: "Nexus S", snippet: "Fast..."},
                     {name: "Motorola XOOM...", snippet: "The Next...."},
                     {name: "MOTOROLA XOOM...", snippet: "The Next, Next..."}];
}]); 
```

然后我们为 out app 创建一个模块并将其注入我们的控制器模块

```
var PhonesApp = angular.module('phoneApp', ['controllers']); 
```

最后我们可以这样测试

```
describe('phonesApp', function() {
    describe('phoneApp controllers', function() {
        beforeEach(module('controllers'));
        describe('PhoneListCtrl', function() {
            it('should create "phones" model with 3 phones',
                inject(function($rootScope, $controller) {

                var scope = $rootScope.$new();
                var ctrl = $controller("PhoneListCtrl", {$scope: scope });
                expect(scope.phones.length).toBe(3);
            }));
        });
    });
}); 
```

我没有在摩卡中做过，但我想这个过程是相似的。

Pd：我使用 CoffeeScript 完成了教程，这里是相关位[https://gist.github.com/4163147](https://gist.github.com/4163147)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-12-10T19:33:49.277

如果您使用的是 mocha，请注意不支持`angular.mock.module`或`angular.mock.inject`除非您已升级到 angular-1.1.1。我在同一条船上，但由于另一个问题我无法升级。

我想使用 mocha，因为我的服务器端测试是在 mocha 中进行的，而且我更希望双方都拥有相同的测试框架，所以我有点麻烦。

所以，如果你不能使用注入/模块，那么你可以这样尝试：

```
var $injector = angular.injector(['your-app-name', 'ng']),
  $controller = $injector.get('$controller'),
  $scope = $injector.get('$rootScope');

describe('my app controllers', function () {
  describe('FooCtrl', function () {
     it('should do something', function () {
        // scope can be any object you want; could be $rootScope from above
        var params = { $scope: { } },
          ctrl = $controller('FooCtrl', params);
        // TODO: test ctrl
     });
  });
}); 
```

# javascript - 用 d3.js 计算平均 json

> ID：13585967
> 
> 赞同：1
> 
> 时间：2012-11-27T14:05:18.523
> 
> 标签：javascript, json, d3.js, mean

我有一个像这样的json文件：

```
[
 {"id":1,"sex":"Female","programming":5, "project":7}, 
 {"id":2,"sex":"Male","programming":8, "project":4}, 
 {"id":3,"sex":"Female","programming":5, "project":6}, 
 {"id":4,"sex":"Male","programming":4, "project":7} 
] 
```

我想计算使用 D3 js 编程的值的平均值，我可以得到它的总平均值，如下所示：

```
function meanVak(value) {
    return d3.mean(data, function(d) {return d [value] })
}

var meanProgramming = meanVak('programming'); 
```

但是现在我想要一个基于性别的“编程”的单独平均值。所以对于女性和男性。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:40:24.653

```
// I think the easiest way is to use the d3.nest function.  Perhaps something like ... 
var nest = d3.nest()
  .key(function(d) { return d.sex; })
  .sortKeys(d3.ascending)
  .rollup(function(d) {
    return {
      meanVakValue: d3.mean(d, function(g) { return g[value]; })
    };
  })
  .map(data);

// You may then need to turn it back into entries.  I had to use map first then extract to entries
// but I'm still getting my head around d3.
var nestedData = d3.entries(nest); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:42:17.920

在我看来，您需要创建一个仅包含女性/男性的新数组，然后将该函数与新数组一起使用，您可以使用[jquery.map()](http://api.jquery.com/jQuery.map/)轻松创建新数组。

看[**这里**](http://codepen.io/anon/pen/fdavK)的例子。

```
var data = [
 {"id":1,"sex":"Female","programming":5, "project":7}, 
 {"id":2,"sex":"Male","programming":8, "project":4}, 
 {"id":3,"sex":"Female","programming":5, "project":6}, 
 {"id":4,"sex":"Male","programming":4, "project":7} 
];

var newArray = $.map(obj,function(elem){
  return elem.sex === 'Female'? elem :null;
}); 
```

# c# - Include Table-Count in LINQ Expression

> ID：13585969
> 
> 赞同：2
> 
> 时间：2012-11-27T14:05:21.987
> 
> 标签：c#, linq, count

I got the following LINQ Expression:

```
Context.TableOne.Select(
            one =>
            new
            {
                one.Column1,
                one.Column2,
                one.Column3,
                one.Column4,
                one.Column5,
                one.Column6,
                one.Column7,
                one.Column8,
                one.Column9,
                TwoCount = one.TableTwo.Count()
            }); 
```

When I select it as this:

```
Context.TableOne.Select(
            one =>
            new
            {
                One = one,
                TwoCount = one.TableTwo.Count()
            }); 
```

I would have gotten a nested property "One" containing all the fields of "one". This would require me (for example in a datagrid) to specify the FieldNames `One.Column1` or `One.Column2` instead of `Column1` or `Column2`

Is it possible to include the `TwoCount = one.TableTwo.Count()`-Statement without needing to specify each and every column in this expression?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:07:18.907

You can select the whole entity instead:

```
Context.TableOne.Select(one => new {
    One = one,
    TwoCount = one.TableTwo.Count()
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:07:36.040

Yes, although I am confused as to why you think you need to select all of the columns in the first place.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T14:08:02.687

Select the whole object, not each of its properties.

```
Context.TableOne.Select(
    one =>
        new
        {
            One = one,
            TwoCount = one.TableTwo.Count()
        }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T14:37:51.377

When you use `new {....}` you are creating a new anonymous type. You are then setting the properties on that type with the object initializer syntax. It may be easier to understand if we break this down to what is actually happening.

First you are creating a new type `Foo`. Let's simplify this to 3 properties

```
public class Foo
{
    public object Column1 { get; set; }
    public object Column2 { get; set; }
    public int TwoCount { get; set; }
} 
```

Now, let's just look at the lambda expression that is your select. We can extract this to a function like below.

```
public Foo CreateFoo(TableOne one)
{
    Foo foo = new Foo();
    foo.Column1 = one.Column1;
    foo.Column2 = one.Column2;
    foo.TwoCount = one.TableTwo.Count();

    return foo;
} 
```

As you can see, we must set each property. We could encapsulate this logic in a constructor or somewhere else in class `Foo` because it is not an anonymous type. However, with an anonymous type, there isn't must you can do.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T14:56:26.340

For everyone using EntityFramework, I've got the following solution for you:

Create a partial class in your `TableOne` Namespace and add a new property there:

```
public partial class TableOne
{
    public int TwoCount { get { return Two.Count; } }
} 
```

This way you can just select the whole entity: `var result = Context.TableOne;`

# asp.net - 如何获取和使用 Formview 中按钮的 ID 作为更新面板触发器的触发器

> ID：13585975
> 
> 赞同：1
> 
> 时间：2012-11-27T14:05:40.733
> 
> 标签：asp.net, asp.net-ajax

我有一个 asp.net 按钮，formview 插入模板内的文件上传控件，它位于手风琴控件内，它也在更新面板内。但是即使我添加了一个文件，fileupload.hasfile 仍然返回 false。经过一番谷歌搜索后，我了解到 fileupload 不适用于部分回发。我正在尝试将 asp.net 按钮添加为回发的触发器之一，但我不断收到此错误：

```
A control with ID 'lnkBtnUpdate' could not be found for the trigger in UpdatePanel 'UpdatePanel1'. 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 
Exception Details: System.InvalidOperationException: A control with ID 'lnkBtnUpdate' could not be found for the trigger in UpdatePanel 'UpdatePanel1'.
Source Error: 
An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace: 
[InvalidOperationException: A control with ID 'lnkBtnUpdate' could not be found for the trigger in UpdatePanel 'UpdatePanel1'.]
   System.Web.UI.UpdatePanelControlTrigger.FindTargetControl(Boolean searchNamingContainers) +784600
   System.Web.UI.PostBackTrigger.Initialize() +19
   System.Web.UI.UpdatePanelTriggerCollection.Initialize() +82
   System.Web.UI.UpdatePanel.OnLoad(EventArgs e) +230
   System.Web.UI.Control.LoadRecursive() +71
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +3064 
```

如何获取按钮的 ID，以便将其添加为更新面板的触发器，此外，还有其他方法可以在更新面板中使用 FileUpload 控件吗？

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
  <ContentTemplate>
    <asp:Accordion ID="Accordion1" runat="server" SelectedIndex="0" HeaderCssClass="accordionHeader"
        HeaderSelectedCssClass="accordionHeaderSelected" ContentCssClass="accordionContent"
        FadeTransitions="true" SuppressHeaderPostbacks="true" TransitionDuration="250"
        FramesPerSecond="40" RequireOpenedPane="false" AutoSize="Fill" Height="1197px"
        Width="100%">
      <Panes>
        <asp:AccordionPane ID="AccordionPanePlannedRoles" runat="server">
          <Header>
            View ManPower Plan
          </Header>
          <Content>
            <div id="divListView" style="width: 100%; float: left;">
              <asp:FormView ID="FormView1" runat="server" AllowPaging="True" DataKeyNames="pk_PersonelID"
                  DataSourceID="DSRCFormView" Style="margin-left: 0px; background-color: #EFF3FB;"
                  Width="608px" OnItemInserting="FormView1_ItemInserting" OnItemCreated="FormView1_ItemCreated">
                <EditItemTemplate>
                  <div id="titleSpan" class="titleBannerDIV">Edit Personnel</div>
                  <div style="width: 70%; float: left">
                    <table  id="one-column-emphasisB" style="background-color: #EFF3FB;padding: 1px 1px; width:100%">

                      <tr>
                        <td class="style3">
                          Photo:
                        </td>
                        <td colspan="2" style="text-align: left">
                          <asp:FileUpload ID="FileUpload1" runat="server" CssClass="tb10" />
                        </td>
                        <td>
                          &nbsp;
                        </td>
                      </tr>
                      <tr>
                        <td class="style3" colspan="3">
                          <asp:Label ID="lblErr" runat="server" ForeColor="Red" Style="font-weight: 700; text-align: left;"
                              Width="250px"></asp:Label>
                        </td>
                        <td>
                          &nbsp;
                        </td>
                      </tr>
                      <tr>
                        <td class="style3">
                          &nbsp;
                        </td>
                        <td>
                          <asp:LinkButton ID="lnkBtnUpdate" runat="server" OnClick="lnkBtnUpdate_Click" CommandArgument='' <%#Eval("pk_PersonelID") %>'>Update
                          </asp:LinkButton>
                        </td>
                        <td>
                          <asp:LinkButton ID="UpdateCancelButton" runat="server" CausesValidation="False" CommandName="Cancel"
                              Text="Finish" OnClick="UpdateCancelButton_Click" />
                        </td>
                        <td>
                          &nbsp;
                        </td>
                      </tr>
                    </table>
                  </div>

                </EditItemTemplate>

              </asp:FormView>
              <div>
              </div>
            </div>
          </Content>
        </asp:AccordionPane>

      </Panes>
    </asp:Accordion>
  </ContentTemplate>
  <Triggers>

    <asp:PostBackTrigger ControlID="lnkBtnUpdate"  />
  </Triggers>
</asp:UpdatePanel> 
```

# sql - NOT EXISTS 无效的关系运算符

> ID：13585981
> 
> 赞同：2
> 
> 时间：2012-11-27T14:06:11.527
> 
> 标签：sql, oracle

我有一个看起来像以下列的表：bad_mrn、good_mrn、cr_date

```
insert into mrn_merge values ( '00000001','00000002', '20121120');
insert into mrn_merge values ( '00000002','00000003', '20121120');
insert into mrn_merge values ( '00000003','00000004', '20121120'); 
```

所以最后。
- 1 合并到 2
- 2 合并到 3
- 3 合并到 4

如果我提供 1、2、3 或 4 的输入参数，我需要一个返回 4 的查询。以下准备好的语句确实有效，但是当我的 mrn_merge 表开始有 40k 条记录时需要很长时间。

```
SELECT *
FROM
   (SELECT good_mrn, LEVEL
    FROM mrn_merge
    WHERE 
        (CONNECT_BY_ROOT bad_mrn =
            (SELECT bad_mrn FROM mrn_merge WHERE LEVEL =
                (SELECT MAX (LEVEL) FROM mrn_merge  START WITH good_mrn = ?
                 CONNECT BY PRIOR bad_mrn = good_mrn )
             START WITH good_mrn = ?
             CONNECT BY PRIOR bad_mrn = good_mrn)
        )  OR ( CONNECT_BY_ROOT bad_mrn = ?)
    START WITH  bad_mrn NOT IN ( SELECT good_mrn FROM mrn_merge  )
    CONNECT BY bad_mrn = PRIOR good_mrn  ORDER BY LEVEL DESC)
WHERE ROWNUM = 1 ; 
```

sql 调优顾问说使用“不存在”代替“不存在”，但我得到 ORA-00920：无效的关系运算符 00920。00000 -“无效的关系运算符”..

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T17:59:43.240

你不能简单地`NOT IN`换成`NOT EXISTS`.

`NOT IN`根据子查询的结果测试一列（或括在括号中的一组列），该子查询必须返回相同数量的列。

```
SELECT a.cols
FROM table_a a
WHERE a.id NOT IN (
  SELECT b.id
  FROM table_b b
) 
```

或者

```
SELECT a.cols
FROM table_a a
WHERE (a.id, a.name) NOT IN (
  SELECT b.id, b.name
  FROM table_b b
) 
```

`NOT EXISTS`测试子查询是返回零行 (TRUE) 还是一或多行 (FALSE)。通常，子查询与外部查询*相关*，即子查询内部的列（或列集）针对外部查询中的列（或列集）进行测试。

```
SELECT a.cols
FROM table_a a
WHERE NOT EXISTS (
  SELECT 1
  FROM table_b b
  WHERE b.id = a.id
) 
```

在您的具体示例中，在我看来，您似乎无法合理地将子句重写为 use `NOT EXISTS`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T14:11:00.090

如果有人看过这个谢谢..但是，我的 DBA 能够挤我来帮助这个查询..答案是让它更简单，更高效..

> select good_mrn from (select good_mrn, CONNECT_BY_ROOT bad_mrn, cr_date, bad_mrn
> from mrn_merge Start with good_mrn= ? or bad_mrn=?
> connect by bad_mrn = prior good_mrn) where good_mrn not in
> (select bad_mrn from mrn_merge) and rownum <=1;

现在它运行得非常高效。谢谢..

# html - 如何使用phonegap删除页面导航android之间的白屏

> ID：13585982
> 
> 赞同：1
> 
> 时间：2012-11-27T14:06:10.927
> 
> 标签：html, jquery-mobile, cordova

我是 phonegap 的新手`Android`。我已经用 phonegap 完成了我的应用程序`jQuery Mobile`，我的问题是，当将一个页面导航到另一个页面时，这个白屏显示，而不是显示加载程序。

我想在页面导航上首先加载第一个 java 脚本以及如何在页面导航之间删除白屏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T10:38:33.673

首先将您的 jQuery 选项设置为： $.defaultPageTransition:'none' ，然后您应该按照以下方式在导航栏中设置链接：

```
<div data-role="navbar" data-theme="a"  data-grid="c">
<ul data-transition="none" >
<li><a data-transition="none" href="#" class="ui-btn-active ui-state-persist" id="Page1"  data-icon="custom">Page1</a></li>
<li><a data-transition="none"  href="#Page2"   id="Page2" data-icon="custom">Page2</a></li>
<li><a data-transition="none"  href="#Page3"   id="Page3" data-icon="custom">Page3</a></li>
<li><a data-transition="none"  href="#Page4"   id="Page4" data-icon="custom">Page4</a></li>
</ul>
</div> 
```

或者，您可以使用 changepage 方法，如下所示：

```
 $.mobile.changePage("#pageid", {
            transition: "none",
            reverse: true,
            changeHash: true
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:14:24.093

假设您正确地 ajax 加载页面，您可能会遇到 jquery mobile 引入的错误/功能，因为某些设备在更好的转换方面存在问题。幸运的是，有一个简单的修复方法可用。

[https://github.com/watusi/jquery.mobile.simultaneous-transitions](https://github.com/watusi/jquery.mobile.simultaneous-transitions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T17:43:34.703

你用

```
$.mobile.changePage('#yourPage', "slide"); 
```

？？？

如果没有解决，请参阅[http://jquerymobile.com/demos/1.2.0/docs/pages/loader.html](http://jquerymobile.com/demos/1.2.0/docs/pages/loader.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T10:29:43.213

使用最新的phonegap。使用 corodova-2.2.0。它也应该是 $.defaultPageTransition:'none'

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-06T09:05:28.877

将脚本部分从`HEAD`标记更改为`BODY`标记

# java - 从机器人句柄 awtexception 扩展

> ID：13585983
> 
> 赞同：1
> 
> 时间：2012-11-27T14:06:12.410
> 
> 标签：java, oop, exception, extend, awtrobot

非常简单的问题：我有一个从 java Robot 类扩展的类，但是我的 IDE（netbeans）中有一个错误，我没有为我的类处理 AWTException。我怎样才能解决这个问题？

我的课是这样的：

```
public class KeyBoard extends Robot{
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:09:40.327

类的构造函数`java.awt.Robot`抛出一个`AWTException`需要强制处理的。所以，为了解决这个问题，声明你的类的构造函数来抛出一个`AWTException`.

```
public class KeyBoard extends Robot{
public KeyBoard throws java.awt.AWTException{
//constructor body.
}
//other methods.
} 
```

[有关更多信息，您可以在此处](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/Robot.html)阅读 Robot 类的文档。

# asp.net-mvc - MVC WebApi 在 C# 中获取传递对象

> ID：13585992
> 
> 赞同：3
> 
> 时间：2012-11-27T14:06:40.107
> 
> 标签：asp.net-mvc, json, asp.net-web-api

我需要从我的 mvc webapi 获取 from 和 to date 以检索这些日期之间的项目。这是我尝试过但没有奏效的最喜欢的事情（我尝试了几件事）。

我有一个项目之间共享的对象：

```
public class SchedulerDateSpan
{
    public DateTime StartDate { get; set; }
    public DateTime EndDate { get; set; }
} 
```

这是我的控制器类：

```
public IEnumerable<Appointment> GetAppointments(SchedulerDateSpan dates)
{
   IEnumerable<Appointment> appointments =
   db.Appointments.Where(
   a =>
   (a.StartDate <= dates.StartDate && a.EndDate >= dates.StartDate) || (a.StartDate <= dates.EndDate && a.EndDate >= dates.EndDate) ||
   (a.StartDate > dates.StartDate && a.EndDate < dates.EndDate)).AsEnumerable();
   return appointments;
} 
```

这是我来自客户的电话，其中日期类型为 SchedulerDateSpan：

```
var client = new HttpClient { BaseAddress = new Uri(Properties.Settings.Default.SchedulerWebApi) };

client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue("application/json"));

HttpResponseMessage resp = client.GetAsync(String.Format("api/Appointments/{0}",dates)).Result;

if (resp.IsSuccessStatusCode)
{ 
   var appointments = resp.Content.ReadAsAsync<IEnumerable<Appointment>>().Result;
          ......
} 
```

我还尝试将其更改为似乎可行的 put 但后来我无法解析结果`Content.ReadAsAsync`

任何建议表示赞赏

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T21:20:29.267

默认情况下，复杂类型（例如您的 SchedulerDateSpan）预计将在请求正文中传递。如果要从 URI 传递值，则必须将操作参数标记为 [FromUri]：

```
public IEnumerable<Appointment> GetAppointments([FromUri]SchedulerDateSpan dates)
{...} 
```

然后，您可以从 Uri 中的查询字符串中传递“日期”，如下所示：

```
HttpResponseMessage resp = client.GetAsync(
  String.Format("api/Appointments?dates.StartDate={0}&dates.EndDate={1}", 
    dates.StartDate.ToString(),
    dates.EndDate.ToString())).Result; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T21:18:52.090

如果你试图通过查询字符串传递一个复杂的对象，那么你需要用`[FromUri]`属性装饰你的 Get 方法参数：

```
public IEnumerable<Appointment> GetAppointments([FromUri] SchedulerDateSpan dates) 
```

您的查询字符串看起来像这样：

```
http://server.com/api/Appointments?StartDate=blah1&EndDate=blah2 
```

祝你好运！

# filter - 格式化单元格内容上的 Slickgrid 过滤器

> ID：13585994
> 
> 赞同：0
> 
> 时间：2012-11-27T14:06:46.857
> 
> 标签：filter, formatting, slickgrid

对于一个新项目，我们正在使用 SlickGrid，它是一个非常简洁的工具来显示网格数据。我们正在尝试在网格上方实现一个搜索框，用于过滤网格的内容。我们正在使用带有网格的 DataView，我们可以使用函数“setFilter”和“setFilterArgs”在 DataView 上实现过滤器。

我们还使用自定义格式化程序来格式化某些字段的单元格内容。例如，国家是我们数据对象中的国家代码（例如“NL”），但我们在网格列定义中使用格式化程序将其显示为翻译值“荷兰”。日期也以这种方式格式化。

问题是：我们只能过滤数据对象中的内容，因为它可以从 DataView 访问，但是我们需要过滤网格在单元格中呈现的格式化内容。有什么方法可以快速而有效地完成这项工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T15:55:52.557

CPU 高效方式：在您的格式化程序函数中，在您的 return 语句之前分配：

```
dataContext.countryName = myFullCountryName; 
```

这将为项目/行添加一个新属性。然后，当您对`country`列进行排序时，只需引用 countryName 即可。

内存有效的方法是在排序函数中进行比较之前简单地将每个国家/地区的值通过格式化程序函数。

# shopify - Shopify Wholesale Pricing 使用“价格比较”字段

> ID：13585995
> 
> 赞同：1
> 
> 时间：2012-11-27T14:06:49.827
> 
> 标签：shopify

我们有一个商家要求按产品批发定价。内置的 Shopify 促销引擎显然可以为特定客户群处理商店范围内的百分比折扣，但是该商家有特定要求，即在每个产品/变体的基础上设置批发价格（理想情况下没有促销代码要求）。我们已经查看了所有这些[建议](http://support.shopify.com/customer/portal/articles/75449-can-i-offer-wholesale-)，但它们似乎都不是很好的解决方案。

我们的问题是，是否可以按照以下方式做一些事情：

1.  将“比较价格”字段设置为批发价（我们知道这不是其预期目的，但这是唯一可用的字段）
2.  编辑任何模板以不将“现场比较”用于其原始预期目的（如果在任何情况下低于售价，某些主题不会显示此字段）。
3.  如果客户是批发客户组的一部分，则在“购物车”模板中，将客户实际支付的价格修改为“比较价格”而不是正常的“销售价格”。或者在产品模板本身中，当客户点击“添加到购物车”时，会使用相关价格（基于他们的客户组）进行类似的检查。

换句话说，是否可以将液体价格更改为数据库中为特定变体存储的价格以外的价格？或者对于如何在不创建重复项目或重复商店的情况下解决这个批发问题有任何其他建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T15:08:06.873

正确，这也是使用专有系统的缺点。但是，您可以通过执行以下操作来使用通用设计来掩盖库存水平……</p>

1) 在 shopify 中设置选项以在没有可用库存时允许订购 2) 设置您的变体库存水平如下：a) 零售价库存水平 - 10（或任何实际库存水平） b) 批发库存水平 - 0（离开在 0)

3) 使用以下方法跟踪总库存水平：

如何显示和分配总库存（第 1 部分）： [http ://ecommerce.shopify.com/c/ecommerce-design/t/how-to-display-total-inventory-63060](http://ecommerce.shopify.com/c/ecommerce-design/t/how-to-display-total-inventory-63060)

如何显示和分配总库存（第 2 部分）： [http ://ecommerce.shopify.com/c/ecommerce-design/t/inventory-analysis-36011](http://ecommerce.shopify.com/c/ecommerce-design/t/inventory-analysis-36011)

4) 使用另一个 if 语句显示“不可用文本”或删除订单按钮 IF 总库存 > 0

5）当有人批发订单时，您将不得不手动调整库存水平。但至少您可以控制库存何时可用，并且只需要担心一个选项框。

另一种选择是始终保持您的库存拆分，这将冒着在零售价可用时不允许以批发价订购的风险，反之亦然。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:34:41.030

不幸的是，这是使用 shopify 电子商务基础的众多缺点之一，主要设计之外的所有内容都是专有的。这意味着您无权访问 shopify 处理订单的方式。

但是，您可以使用产品变体，然后使用客户组来指定他们是否有权查看该变体。

示例：如果客户在批发组 1 中，则显示变体 1，如果客户未定义，则不显示变体。

[http://wiki.shopify.com/Variant_variables](http://wiki.shopify.com/Variant_variables) http://wiki.shopify.com/Customer_Group_%28API%29

# xtext - XText：在括号上拆分标记

> ID：13585997
> 
> 赞同：0
> 
> 时间：2012-11-27T14:06:56.980
> 
> 标签：xtext

我将 XText 与这样的语法一起使用：

```
Element: element '[' name=ID ']' '{' content+=Content+ '}'
Content: STRING 
```

现在，以下是有效的：

```
element[blub] { "Text" } 
```

但这不是：

```
element[blub]{ "Text" } 
```

错误：`mismatched input: ']{' expecting ']'`。

我如何告诉词法分析器将它们分成`']{'`两个标记？

我已经试过了

```
terminal BRACKET: '(' | ')' | '[' | ']' | '{' | '}' 
```

和`hiding (WS, …, BRACKET)`，但这不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:59:54.160

异常表明您在语法中的某处使用了关键字“]{”。可以通过将其重构为两个关键字']''{'来解决。

# hibernate - “无法初始化代理 - 无会话”，有可用的打开会话

> ID：13585998
> 
> 赞同：3
> 
> 时间：2012-11-27T14:06:57.380
> 
> 标签：hibernate, jsf, jpa, cdi, myfaces

我使用 JSF 2（MyFaces 2.1.7 和 Primefaces 3.4.2）、CDI（Weld-servlet 1.1.10）、JPA 2（Hibernate 4.1.7）和 Lombok 0.11.2。所有这些都在 Tomcat 6 和 7 上运行。

我使用[OpenSessionInView](https://community.jboss.org/wiki/OpenSessionInView)模式，通过`Filter`.

```
@Advanced
@Data
@Slf4j
public class TransactionalFilter implements Filter, Serializable {

    private static final long serialVersionUID = 999173590695648899L;

    @Inject
    private EntityManager em;

    @Override
    public void doFilter(ServletRequest request, ServletResponse response,
            FilterChain chain) throws IOException, ServletException {
        boolean newTransaction = false;
        EntityTransaction tx = em.getTransaction();
        if (!tx.isActive()) {
            tx.begin();
            newTransaction = true;
        }

        try {
            chain.doFilter(request, response);
            if (newTransaction && tx.isActive()) {
                tx.commit();
            }
        } catch (Exception e) {
            if (newTransaction && tx.isActive()) {
                tx.rollback();
            }
            throw new ServletException(e);
        }

    }
    (...)
} 
```

注入`RequestScoped` `EntityManager`是由 my 提供的`EntityManagerFactory`，他也为我的所有服务前沿提供它。

```
@ApplicationScoped
@Data
@Slf4j
public class TransactionalEntityManagerFactory implements Serializable {

    private static final String PU_NAME = "fr.senat.dosleg";
    private static final long serialVersionUID = -3595175390458199193L;
    private EntityManagerFactory emf;

    /** (...)
     * @return un nouvel EntityManager.
     */
    @Produces
    @RequestScoped
    public EntityManager getEntityManager() {
        if (emf == null) {
            emf = Persistence.createEntityManagerFactory(PU_NAME);
        }
        return emf.createEntityManager();
    }

    /**(...)
     * @param em le gestionnaire d'entité à libérer.
     */
    public void closeEntityManager(@Disposes EntityManager em) {
        if (em != null && em.getTransaction().isActive()) {
            em.getTransaction().rollback();
        }

        if (em != null && em.isOpen()) {
            em.close();
        }
    }
} 
```

这一切都很好，直到我添加了`List<Theme>`下面的 Controle Entity 中显示的内容

```
@Entity
@Data
@NoArgsConstructor
@AllArgsConstructor
@ToString(exclude = { "organisme", "groupePolitique", "lois", "livrables",
    "acteurs", "themes" })
public class Controle implements Serializable {

    private static final long serialVersionUID = -6471695606036735891L;

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Integer id;

    @NotNull
    @Size(max = 256, message = "trop long.")
    private String libelle;

    @Pattern(regexp = Constants.URL_PATTERN, message = "pas au bon format")
    private String url;

    @NotNull
    @Type(type = "fr.senat.util.hibernate.usertype.OuiNonSmallType")
    private boolean initiativeDesGroupes;

    @NotNull
    @Type(type = "fr.senat.util.hibernate.usertype.OuiNonSmallType")
    private boolean courDesComptes;

    @NotNull
    private int anneeCreation;

    @Embedded
    private EcheanceControle echeance = new EcheanceControle();

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "ORGCOD")
    private Organisme organisme;

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "GRPPOL")
    private GroupePolitique groupePolitique;

    @ManyToMany
    @JoinTable(name = "CONTROLE_LOI", joinColumns = @JoinColumn(name = "CON_ID"), inverseJoinColumns = @JoinColumn(name = "LOICOD"))
    private List<Loi> lois;

    @OneToMany(orphanRemoval = true, cascade = CascadeType.ALL)
    @JoinColumn(name = "CON_ID", nullable = false)
    private List<LivrableControle> livrables;

    @OneToMany(orphanRemoval = true, cascade = CascadeType.ALL)
    @JoinColumn(name = "CON_ID", nullable = false)
    private List<ActeurControle> acteurs;

    @ManyToMany
    @JoinTable(name = "THEME_CONTROLE", joinColumns = @JoinColumn(name = "CON_ID"), inverseJoinColumns = @JoinColumn(name = "THECLE"))
    private List<Theme> themes;

    (...)

} 
```

现在，当我尝试通过页面保存现有的 Controle 时`controle.xhtml`，我收到了 ajax 响应错误。下边是`controle.xhtml`

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:s="http://www.senat.fr/taglib/util"
    xmlns:ui="http://java.sun.com/jsf/facelets">
<ui:composition template="template.xhtml">
    <ui:define name="title">
        <h:outputText value="#{controle.controle.libelle}"
            rendered="#{not empty controle.controle.id}" />
        <h:outputText value="Création d'un contrôle"
            rendered="#{empty controle.controle.id}" />
    </ui:define>
    <ui:define name="specific_header">
        <h:outputScript library="fr.senat.util.primefaces"
            name="calendar-locale.js" />
    </ui:define>
    <ui:define name="content">
        <h:form id="controle">

            <p:messages />

            <p:panel>

                <h:panelGrid columns="2" columnClasses="label,">

                    <p:outputLabel for="libelle" value="Libellé" />
                    <p:inputText id="libelle" value="#{controle.controle.libelle}"
                        size="60" />

                    <p:outputLabel for="url" value="URL" />
                    <p:inputText id="url" value="#{controle.controle.url}" size="60" />

                    <h:outputText value="Acteurs" />
                    <h:panelGroup>
                        <h:panelGroup id="acteurs">
                            <p:dataTable var="a" value="#{controle.controle.acteurs}"
                                rendered="#{not empty controle.controle.acteurs}">
                                <p:column headerText="Rôle">
                                    <h:outputText value="#{a.role}" />
                                </p:column>

                                <p:column headerText="Nom">
                                    <h:outputText
                                        value="#{a.senateur.nomUsuel} #{a.senateur.prenomUsuel}" />
                                </p:column>

                                <p:column headerText="Enlever">
                                    <p:commandButton
                                        title="Enlever #{a.senateur.nomUsuel} #{a.senateur.prenomUsuel}"
                                        icon="ui-icon-trash"
                                        actionListener="#{controle.removeElement}"
                                        update=":controle:acteurs" immediate="true">
                                        <f:attribute name="ancien" value="#{a}" />
                                    </p:commandButton>
                                </p:column>
                            </p:dataTable>
                        </h:panelGroup>
                        <p:commandButton id="addActeur" value="Ajouter un acteur"
                            icon="ui-icon-plus" onclick="addActeurDialog.show()"
                            immediate="true" />
                    </h:panelGroup>

                    <p:outputLabel for="themes" value="Thèmes" />
                    <p:selectManyButton id="themes" value="#{controle.controle.themes}">
                        <f:selectItems value="#{controle.themes}" var="t"
                            itemLabel="#{t.libelle}" itemValue="#{t}" />
                    </p:selectManyButton>

                </h:panelGrid>

                <f:facet name="footer">
                    <p:commandButton onclick="deleteControleDialog.show()"
                        value="Supprimer" icon="ui-icon-trash"
                        styleClass="ui-priority-secondary" type="button" />
                    <p:button outcome="pretty:start" value="Annuler"
                        icon="ui-icon-cancel" />
                    <p:commandButton id="saveSubmit" value="Sauvegarder"
                        actionListener="#{controle.save}" icon="ui-icon-disk"
                        styleClass="ui-priority-primary" />
                </f:facet>
            </p:panel>
            <p:defaultCommand target="saveSubmit" />
        </h:form>

        <p:dialog header="Ajoute un nouvel acteur" id="addActeurDialog"
            widgetVar="addActeurDialog" modal="true" width="650">
            <h:form id="addActeurForm">
                <p:messages />
                <h:panelGrid columns="2">

                    <p:outputLabel for="newRole" value="Rôle" />
                    <p:autoComplete id="newRole" dropdown="true"
                        value="#{controle.newRole}"
                        completeMethod="#{controle.completeRole}" />

                    <p:outputLabel for="senateurSearch" value="Sénateur" />
                    <h:panelGroup>
                        <p:inputText id="senateurSearch"
                            value="#{controle.senateurSearch}" size="30" />
                        <p:commandButton id="senateurSearchSubmit" value="Chercher"
                            actionListener="#{controle.searchSenateurs}"
                            update="senateursFound" icon="ui-icon-search"
                            oncomplete="addActeurDialog.initPosition()" />
                        <p:selectBooleanButton value="#{controle.senateurSearchActif}"
                            onLabel="en activité seulement" offLabel="en activité ou non" />
                    </h:panelGroup>
                </h:panelGrid>
                <h:panelGroup id="senateursFound">
                    <p:dataTable value="#{controle.senateurs}" var="s"
                        rendered="#{not empty controle.senateurs}" rows="10">
                        <p:column headerText="Nom">
                            <h:outputText value="#{s.nomCompletUsuel}" />
                        </p:column>

                        <p:column headerText="Ajout">
                            <p:commandButton title="Ajouter le sénateur #{s.nomCompletUsuel}"
                                icon="ui-icon-plus" actionListener="#{controle.addElement}"
                                oncomplete="addActeurDialog.hide()" update=":controle:acteurs">
                                <f:attribute name="nouveau" value="#{s}" />
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>
                </h:panelGroup>

            </h:form>
        </p:dialog>

        <p:confirmDialog id="deleteControleDialog"
            message="Etes-vous sûr de vouloir supprimer ce contrôle ?"
            header="Suppression du contrôle" severity="alert"
            widgetVar="deleteControleDialog">
            <p:commandButton value="Annuler"
                onclick="deleteControleDialog.hide()" />
            <p:commandButton value="Confirmer la suppression"
                action="#{controle.deleteControle}" styleClass="ui-priority-primary" />
        </p:confirmDialog>
    </ui:define>
</ui:composition>
</html> 
```

这就是错误

```
<?xml version="1.0" encoding="utf-8"?>
<partial-response>
    <error>
        <error-name>org.hibernate.LazyInitializationException</error-name>
        <error-message><![CDATA[could not initialize proxy - no Session]]></error-message>
    </error>
</partial-response> 
```

使用调试器，我能够在第一次抛出异常时确定 Stacktrace

```
PersistentBag(AbstractPersistentCollection).withTemporarySessionIfNeeded(LazyInitializationWork<T>) line: 180   
PersistentBag(AbstractPersistentCollection).initialize(boolean) line: 520   
PersistentBag(AbstractPersistentCollection).write() line: 345   
PersistentBag.add(Object) line: 291 
_SharedRendererUtils.getConvertedUISelectManyValue(FacesContext, UISelectMany, String[], boolean) line: 339 
RendererUtils.getConvertedUISelectManyValue(FacesContext, UISelectMany, Object, boolean) line: 1088 
RendererUtils.getConvertedUISelectManyValue(FacesContext, UISelectMany, Object) line: 1056  
HtmlCheckboxRenderer(HtmlCheckboxRendererBase).getConvertedValue(FacesContext, UIComponent, Object) line: 525   
SelectManyButtonRenderer.getConvertedValue(FacesContext, UIComponent, Object) line: 36  
SelectManyButton(UISelectMany).getConvertedValue(FacesContext, Object) line: 402    
SelectManyButton(UIInput).validate(FacesContext) line: 584  
SelectManyButton(UISelectMany).validate(FacesContext) line: 393 
SelectManyButton(UIInput).processValidators(FacesContext) line: 274 
HtmlPanelGrid(UIComponentBase).processValidators(FacesContext) line: 1421   
Panel(UIComponentBase).processValidators(FacesContext) line: 1421   
Panel.processValidators(FacesContext) line: 297 
HtmlForm(UIForm).processValidators(FacesContext) line: 209  
HtmlBody(UIComponentBase).processValidators(FacesContext) line: 1421    
UIViewRoot(UIComponentBase).processValidators(FacesContext) line: 1421  
UIViewRoot._processValidatorsDefault(FacesContext) line: 1401   
UIViewRoot.access$500(UIViewRoot, FacesContext) line: 74    
UIViewRoot$ProcessValidatorPhaseProcessor.process(FacesContext, UIViewRoot) line: 1508  
UIViewRoot._process(FacesContext, PhaseId, UIViewRoot$PhaseProcessor) line: 1357    
UIViewRoot.processValidators(FacesContext) line: 799    
ProcessValidationsExecutor.execute(FacesContext) line: 38   
LifecycleImpl.executePhase(FacesContext, PhaseExecutor, PhaseListenerManager) line: 170 
LifecycleImpl.execute(FacesContext) line: 117   
CodiLifecycleWrapper.execute(FacesContext) line: 95 
FacesServlet.service(ServletRequest, ServletResponse) line: 197 
ApplicationFilterChain.internalDoFilter(ServletRequest, ServletResponse) line: 290  
ApplicationFilterChain.doFilter(ServletRequest, ServletResponse) line: 206  
PrettyFilter.doFilter(ServletRequest, ServletResponse, FilterChain) line: 145   
ApplicationFilterChain.internalDoFilter(ServletRequest, ServletResponse) line: 235  
ApplicationFilterChain.doFilter(ServletRequest, ServletResponse) line: 206  
ApplicationDispatcher.invoke(ServletRequest, ServletResponse, ApplicationDispatcher$State) line: 646    
ApplicationDispatcher.processRequest(ServletRequest, ServletResponse, ApplicationDispatcher$State) line: 436    
ApplicationDispatcher.doForward(ServletRequest, ServletResponse) line: 374  
ApplicationDispatcher.forward(ServletRequest, ServletResponse) line: 302    
PrettyFilter.doFilter(ServletRequest, ServletResponse, FilterChain) line: 137   
ApplicationFilterChain.internalDoFilter(ServletRequest, ServletResponse) line: 235  
ApplicationFilterChain.doFilter(ServletRequest, ServletResponse) line: 206  
TransactionalFilter.doFilter(ServletRequest, ServletResponse, FilterChain) line: 60 
ApplicationFilterChain.internalDoFilter(ServletRequest, ServletResponse) line: 235  
ApplicationFilterChain.doFilter(ServletRequest, ServletResponse) line: 206  
SetUtf8CharacterEncodingFilter.doFilter(ServletRequest, ServletResponse, FilterChain) line: 44  
(...)
Thread.run() line: 662 
```

现在我确实意识到关于 SO 的许多帖子都涉及该异常。所有答案通常都围绕正在关闭的实体管理器（或 Hibernate 方言中的会话）。他们提供了两种解决方案：使用 OpenSessionInView 或懒惰地获取属性。我认为我的问题有几个不同的原因。

1.  我已经使用 OpenSessionInView。此外，日志确实显示，当问题出现时，事务仍然处于打开状态。
2.  试图懒惰地获取`themes`属性无济于事

通过代码，在我看来这对所有[SelectMultiXXX](http://www.primefaces.org/showcase-labs/ui/selectManyButton.jsf)小部件都是通用的，所以我尝试使用 SelectManyCheckbox。它也没有用。我也尝试过在小部件上使用或不使用特定的转换器，结果是一样的。

最后一点，我想指出所有其他 List<> 属性都在同一个 controle.xhtml 上工作。然而，不同之处可能在于这些是通过对话框修改的（因此不同的请求）。

我希望您能看到我没有看到的东西，或者您可以确认这是一个错误，或者您可以为我提供解决方法。如果你不这样做，我仍然感谢你花时间阅读这个长问题。

**更新 29/11/2012**：我现在确定 entitymanager 在异常发生时确实是打开的。此外，我确信问题来自以下方法

```
_SharedRendererUtils.getConvertedUISelectManyValue(FacesContext, UISelectMany, String[], boolean) (line 143) 
```

如果有人想试一试，这里有一些来自该方法调试的指示

1.  `Class<?> modelType = expression.getType(facesContext.getELContext());`是`java.util.List`
2.  `Collection.class.isAssignableFrom(modelType)`是真的
3.  `collectionTypeAttr != null`是假的
4.  `Collection.class.isAssignableFrom(modelType)`是真的
5.  `Collection<?> componentValue = (Collection<?>) component.getValue();`是一个`PersistenBag`似乎用 data ( `storedSnapshot`and `role`) 正确初始化但带有 null 的`session`。
6.  `targetForConvertedValues = (componentValue != null ? componentValue.getClass() : modelType).newInstance();`最终成为一个`PersistentBag`一切都为空（包括数据）的人。*这可能是问题吗？*
7.  `boolean isArray = (targetForConvertedValues.getClass().isArray());`是假的
8.  `((Collection) targetForConvertedValues).add(value);`是一切出错的地方。

有什么想法吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T14:34:16.677

对我来说，这看起来像是我在 Mojarra 中发现的一个非常讨厌的错误，在这个版本的 MyFaces 中可能是相同的。基础是当它进行验证时，它会复制列表，但它使用集合的具体类型，使用无参数构造函数来创建集合。在休眠的情况下，这个新列表没有运行所有的初始化代码，也没有链接回会话。我花了很长时间调试和 Mojarra 源来弄清楚实际发生了什么。

我发现我必须使用 collectionType 属性并将其设置为 java.util 接口类型。在没有明确告诉 JSF 要使用的集合类型的情况下，我不再对集合做任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:25:29.763

默认情况下，当您从 db 接收包含集合的对象时，Hibernate 中的集合会延迟加载，而不是 List<> 或 Set<>，存在该列表或集合的代理。在调用该集合的 getter 方法时，它将被获取。但是，如果生成对象的会话已关闭或不再可访问（这不应该在您的 OpenSessionInView 过滤器的约束中），则会出现问题。

`session.merge`如果它们由不同的会话处理，您可以尝试调用您的对象。或者您可以在获取期间手动调用`getter`您的列表，这将触发代理。或者您可以添加`FetchType.Eager`您的集合，在这种情况下，即使在获取时对象也不会是代理而是真实对象。

但是我看到您正在使用 Weld 进行 CDI，为什么不使用支持事务管理的 Seam Persistence 模块呢？然后，您将能够非常快速地实施您的开放会话视图方法。

[http://www.seamframework.org/Seam3/PersistenceModule](http://www.seamframework.org/Seam3/PersistenceModule)