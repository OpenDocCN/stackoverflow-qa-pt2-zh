# StackOverflow 问答 12900000-12900999

# objective-c - 使用 MagicalRecord 的 saveInBackgroundWithBlock: 和 findAll

> ID：12900007
> 
> 赞同：0
> 
> 时间：2012-10-15T16:34:15.393
> 
> 标签：objective-c, core-data, magicalrecord

由于文档有点参差不齐，我想知道是否有人可以阐明如何/何时准确使用 saveInBackgroundWithBlock。

每次启动后，我都会在后台运行一个批处理来更新 Core Data 中的一些值。但是，当我运行这段代码（简化）时：

```
[MagicalRecord saveInBackgroundWithBlock:^(NSManagedObjectContext *context) {
        NSArray *all = [Event findAll];
        for (Event *event in all) {
            event.timestamp = [NSDate date];
        }
 }]; 
```

在保存上下文时，上下文永远不会有任何更改。但是，当我执行以下操作时：

```
[MagicalRecord saveInBackgroundWithBlock:^(NSManagedObjectContext *context) {
        NSArray *all = [Event findAll];
        for (Event *event in all) {
            Event *tmpEvent = [event inContext:context];
            tmpEvent.timeStamp = [NSDate date];
        }
}]; 
```

一切都很好，变化出现了。我看到的唯一问题是，如果我使用 findAll，所有事件的数据都会出错：

```
(lldb) po event
(Event *) $1 = 0x07497c90 <Event: 0x7497c90> (entity: Event; id: 0x7490a50 <x-coredata://2DB960AE-FA52-42A7-9A5F-957199076FF7/Event/p1> ; data: <fault>)
(lldb) po tmpEvent
(Event *) $2 = 0x08574250 <Event: 0x8574250> (entity: Event; id: 0x7490a50 <x-coredata://2DB960AE-FA52-42A7-9A5F-957199076FF7/Event/p1> ; data: {
    name = Test;
    number = 0;
    timeStamp = "2012-10-15 16:18:39 +0000";
}) 
```

如果我使用 saveInBackground 不正确，我总是可以将 NSOperationQueue 块操作与 MagicalRecord 的上下文线程结合使用，但我希望能够使用这一点语法糖来使我的代码更简洁一些。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:10:26.383

你应该像这样使用它：

```
[MagicalRecord saveInBackgroundWithBlock:^(NSManagedObjectContext *localContext){
    NSArray *all = [Event findAllInContext:localContext];
    for (Event *event in all)
    {
        event.timeStamp = [NSDate date];
    }

}]; 
```

**使用背景块**时，请使用本地上下文。后台块正在执行您在主线程/队列之外执行操作所需的所有设置。因此，您应该在不是“主要”上下文的上下文中执行所有后台操作，正如 MagicalRecord 为您设置的那样。

# php - MySQL查找重复产品并更新列

> ID：12900011
> 
> 赞同：0
> 
> 时间：2012-10-15T16:34:25.263
> 
> 标签：php, mysql, opencart

我正在一个使用 opencart 的网站上工作，并将其设置为自动从两个不同的批发商导入产品。该数据库包含大约 40,000 种不同的产品，其中大约 10,000 种是重复的（都带有该产品）。

我需要查找所有重复的产品（通过 UPC）并启用价格较低的产品。

该表称为“产品”，具有列 product_id、upc、price、status 和其他不相关的列。

我的第一次尝试是运行以下查询

```
SELECT DISTINCT (
upc
) AS upcDuplicate, COUNT( upc ) AS upcCount
FROM product
GROUP BY upc
HAVING upcCount >1 
```

这给了我所有重复产品的列表，然后我将在 php 中遍历这些 upcs 并运行

```
UPDATE product SET status=1 WHERE upc='CURRENTUPC' ORDER BY price ASC LIMIT 1 
```

这将使价格最低的那个。

这行得通，但看起来它是如何依赖 php 来运行 10,000 个不同的 mysql 查询的。有什么方法可以将其放入单个查询中，或者至少是更有效的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T16:40:17.977

未经测试，所以它可能会踢你的狗并偷走你的午餐钱，但是......

```
UPDATE product
INNER JOIN (
    SELECT upc, MIN(price) AS minprice
    FROM product
    GROUP BY upc
) AS derived_product
SET product.status=1
WHERE product.upc = derived_product.upc AND product.price=derived_product.minprice 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T16:41:48.723

无需在 PHP 中编写此代码，您始终可以在 DB 级别创建一个过程并从您的 PHP 代码中调用它，这至少可以节省 PHP 和 DB 之间的对话时间（本例中为 9999）

# string - 正弦波的字符串连接

> ID：12900013
> 
> 赞同：1
> 
> 时间：2012-10-15T16:34:26.853
> 
> 标签：string, string-concatenation, scilab

您好，我正在尝试创建一个标题，其中包含我的正弦波方程和变量。

```
% Set up initial parameters    
pi = 3.14;      % Make a variable called pi, and set it equal to 3.14    
A = 1985;       % Set the amplitude (A) equal to 5    
f = 7/3;        % Set the frequency (f) equal to 10    
p = pi/9;       % Set the phase (p) equal to 0    

% Create a time axis    
dt = 0.1;                    % Set the time step to be relatively small     
t = [0 : dt : 2.*pi];        % Create a list of time points from 0 thrugh 2*pi in steps of dt       

% Calculate the sine wave    
y = A.*sin(f.*t+p);   

y

% Graphical Display    
plot(t,y,'ko-')    
xlabel('Time, sec', 'fontsize', 6)    
ylabel ('Amplitude', 'fontsize', 6)

strA = msprintf('%1.1f', A);    
strf = msprintf('%1.1f', f);    
strp = msprintf('%1.1f', p);    
titlestr = 'y = ' + strA +' .* sin( ' + strf + ' .* t + ' + strp + ')'    
title(titlestr, 'fontsize', 6) 
```

这是我到目前为止所做的。绘制这个方程时，我没有得到标题。请帮忙。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T05:27:22.583

Which version of Scilab are you using ? It works for me with 5.4.0.

By the way, you should use %pi instead of declaration pi and Scilab uses // for comments, not %

# c++ - ofstream 是否会自动关闭其文件？

> ID：12900016
> 
> 赞同：13
> 
> 时间：2012-10-15T16:34:33.117
> 
> 标签：c++, ofstream

> **可能重复：**
> [我需要关闭 std::fstream 吗？](https://stackoverflow.com/questions/4802494/do-i-need-to-close-a-stdfstream)

```
int main() {
    ofstream a("a.txt");
    a << "A" << endl;
    //a.close();
} 
```

这工作正常，但不需要在程序结束时关闭文件吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-15T16:37:02.857

`ofstream`将在调用其析构函数时关闭文件，即当它超出范围时。但是，调用`close()`肯定不会造成任何伤害，并且向维护程序员表达了您的意图。

调用`close()`还允许您检查 close() 是否成功，因为您还可以检查`failbit`：

[http://www.cplusplus.com/reference/iostream/ofstream/close/](http://www.cplusplus.com/reference/iostream/ofstream/close/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-15T16:38:00.587

如果要检查结果（成功或失败），必须调用 close。

否则，流的析构函数将尝试为您关闭文件。

# grails - grails hasOne vs hasMany 行为

> ID：12900020
> 
> 赞同：2
> 
> 时间：2012-10-15T16:34:45.483
> 
> 标签：grails, grails-orm

在 grails 中，当指定单向的一对一关系时，我可以这样做

```
class MyDomainClass {
   AnotherDomainClass another
} 
```

或者

```
class MyDomainClass {
   static hasOne = [another:AnotherDomainClass]
} 
```

我知道语义不同，但任何一种方式都会建立这种关系。

创建 hasMany 关系时，我可以这样做：

```
class MyDomainClass {
  static hasMany = [others:AnotherDomainClass]
} 
```

但我似乎做不到：

```
class MyDomainClass {
  List<AnotherDomainClass> others 
} 
```

编辑：澄清。我想仍然有 hasMany 关系，我只是想知道是否可以通过声明`List<AnotherDomainClass> others`没有`hasMany`变量来做到这一点。我希望只是声明`List<AnotherDomainClass>`会自动创建一个连接表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T16:52:29.020

是的，你可以做到。只需声明两者。

```
class MyDomainClass {

  List<AnotherDomainClass> others 

  static hasMany = [others:AnotherDomainClass]

} 
```

当您不声明该字段时，Grails 会自动为您创建一个`Set`。

# python - 如何手动从 shell 运行 celery 定期任务？

> ID：12900023
> 
> 赞同：86
> 
> 时间：2012-10-15T16:34:53.943
> 
> 标签：python, django, celery, django-celery, celery-task

我正在使用芹菜和 django-celery。我已经定义了一个我想测试的定期任务。是否可以手动从 shell 运行定期任务以便查看控制台输出？

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2012-10-15T16:40:28.987

您是否尝试过从 Django shell 运行任务？您可以使用`.apply`任务的方法来确保它在本地急切地运行。

假设任务`my_task`在 Django 应用程序`myapp`中的`tasks`子模块中调用：

```
$ python manage.py shell
>>> from myapp.tasks import my_task
>>> eager_result = my_task.apply() 
```

结果实例具有与通常类型相同的 API `AsyncResult`，只是结果总是在本地急切地评估，并且该`.apply()`方法将阻塞，直到任务运行完成。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2018-10-20T04:49:14.913

如果您的意思是在不满足条件时触发任务，例如不满足周期时间。您可以分两步完成。

**1.获取您的任务ID。**

您可以通过键入来完成。

```
celery inspect registered 
```

你会看到类似`app.tasks.update_something`. 如果没有，那可能`celery`是没有开始。运行它。

**2.运行任务`celery call`**

```
celery call app.tasks.update_something 
```

有关更多详细信息，只需键入

```
celery --help
celery inspect --help
celery call --help 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-15T16:42:41.657

我认为您需要打开两个 shell：一个用于从 Python/Django shell 执行任务，另一个用于运行`celery worker`( `python manage.py celery worker`)。正如前面的答案所说，您可以使用`apply()`或运行任务`apply_async()`

我已经编辑了答案，因此您没有使用已弃用的命令。

# objective-c - 在 Objective C 中使用 self.varA 而不是 _varA 的区别

> ID：12900028
> 
> 赞同：0
> 
> 时间：2012-10-15T16:35:13.173
> 
> 标签：objective-c, properties, setter, getter, accessor

> **可能重复：**
> [self.ivar 和 ivar 之间的区别？](https://stackoverflow.com/questions/4142177/difference-between-self-ivar-and-ivar)

我最近遇到了一个问题，我试图初始化一个对象，其中涉及传递一个 NSMutableArray 进行赋值。

我试着做

```
- (id)initWithFrame:(CGRect)frame menus:(NSMutableArray *)aMenusArray view:(UIView*)gView
{
    self = [super initWithFrame:frame];
    if (self) {

        // ...some code

        _menusArray = [aMenusArray retain]; // This works
        // _menusArray = aMenusArray; This does not work.
        // self.menusArray = [aMenusArray retain]; This does not work.
        // self.menusArray = aMenusArray; This does not work.

        // ...some code
     }
    return self;
} 
```

“不起作用”意味着当我稍后尝试将数组视为 NSMutableArray 并传递 [self.menusArray removeObjectAtIndex:0] 或类似的东西时，它不会导致 __NSArrayI 上使用的无法识别的选择器出现异常。换句话说，“不起作用”导致 self.menusArray 成为不可变数组而不是可变数组。

我想知道为什么 _menusArray = [aMenusArray retain] 有效，为什么其他无效。据我所知，属性和合成只是创建访问器方法（getter 和 setter）。我问了我的同事，他们回答说我可能在某个地方有一些损坏的记忆。

需要明确的是，aMenusArray 被声明为 NSMutableArray，而 _menusArray 在头文件中声明如下：

```
NSMutableArray *_menusArray; 
```

它的属性和综合（在实现中）是：

```
@property (nonatomic, retain) NSMutableArray *menusArray;

@synthesize menusArray = _menusArray; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T16:50:22.877

在您的 init 方法中使用点表示`self`法会导致意外行为。有关更多详细信息，请参阅[初始化属性、点表示法](https://stackoverflow.com/questions/5932677/initializing-a-property-dot-notation)。

# java - Hibernate 按关联（可选）字段排序

> ID：12900029
> 
> 赞同：1
> 
> 时间：2012-10-15T16:35:16.773
> 
> 标签：java, hibernate

我正在尝试对 Hibernate 数据集进行排序，按（可选）关联对象的属性进行排序。我按照[关联的休眠顺序](https://stackoverflow.com/questions/870029/hibernate-order-by-association)的示例进行了操作-这在一定程度上有效。当没有关联对象时，问题就来了，整个记录都被忽略了。

如果我将对象的关联类型更改为外部联接，它会有所帮助吗？如果是这样，有人可以指点我正确的指令吗？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:23:10.267

引用的问题使用了 Criteria 查询，因此我不确定您是否需要这些问题的答案，或者您是否只需要 HQL。假设 HQL 没问题，如果您有这样的实体：

```
class EntityA {
   private Long id;
   @OneToMany
   private EntityB b;

   ....
}

class EntityB {
  private Long id;
  private String name;
} 
```

如果您在 EntityA 和 EntityB 之间有一个可选的 OneToMany 关系，那么您应该能够使用类似以下的查询：

```
"SELECT obj FROM " + EntityA.class.getName() + " obj LEFT JOIN obj.b obj2 ORDER BY obj2.name"; 
```

您将在其中选择所有`EntityA`与`EntityB`它存在的地方连接的地方，按`EntityB.name`字段排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:11:39.227

我只用一行代码更改就解决了这个问题。在构造 Criteria 对象时，我能够传递参数 JoinFragment.LEFT_OUTER_JOIN。例如：

```
 Criteria subCriteria = criteria.createCriteria(subTypeName, JoinFragment.LEFT_OUTER_JOIN); 
```

# visual-studio-2010 - 自动保存加浏览器刷新

> ID：12900030
> 
> 赞同：1
> 
> 时间：2012-10-15T16:35:16.857
> 
> 标签：visual-studio-2010

是否可以像上一个版本的 WebStorm 一样将 VS 2010 配置为在 Chrome 中的编辑和刷新页面上自动保存`cshtml`//文件`css`？`js`在分屏或两台显示器上工作会更舒服。

# c++ - 检查进程 ID 时使用 WaitForSingleObject 的好处

> ID：12900036
> 
> 赞同：8
> 
> 时间：2012-10-15T16:35:44.730
> 
> 标签：c++, winapi, pid

`WaitForSingleObject`在这里使用与不使用相比有什么好处？第一个代码块来自[上一个答案](https://stackoverflow.com/a/1591371/195488)。第二块是我的做法。

```
BOOL IsProcessRunning(DWORD pid)
{
    HANDLE process = OpenProcess(SYNCHRONIZE, FALSE, pid);
    DWORD ret = WaitForSingleObject(process, 0);
    CloseHandle(process);
    return (ret == WAIT_TIMEOUT);
} 
```

对比

```
BOOL IsProcessRunning(DWORD pid)
{
   HANDLE process = OpenProcess(PROCESS_QUERY_LIMITED_INFORMATION, FALSE, pid);
   const bool exists = (process != NULL);
   CloseHandle(process);
   return exists;
} 
```

似乎使用[SYNCHRONIZE](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684880%28v=vs.85%29.aspx)需要更高的权限，我只想检查当前用户的 PID。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-15T16:51:27.177

当一个进程完成时，它会停止运行，但它不会消失，直到它的最后一个句柄关闭。第一个解决方案区分这两种状态（仍在运行或已完成运行）。当然，当它返回时，答案可能已经过时了。

如果您不需要这种区别，那么您的方法很好（尽管我会将函数命名为 DoesProcessExist 之类的名称）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-06T11:34:50.920

IsProcessRunning 的实现也可以使用 GetExitCodeProcess Win32 API。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-15T16:42:51.300

WaitForSingleObject 将等待进程完成/退出。只有这样它才会回来。

# django - 在 pdf 中使用图像

> ID：12900037
> 
> 赞同：1
> 
> 时间：2012-10-15T16:35:47.017
> 
> 标签：django, python-imaging-library, reportlab, pisa

我正在尝试从 html （带上下文）呈现 pdf。我正在遵循[此处](https://stackoverflow.com/questions/1377446/html-to-pdf-for-a-django-site)给出的代码。我正在从另一种形式的 basae 64 编码格式中获取图像。像这样的东西

```
datauri = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==' 
```

现在我正在使用上下文将此 datauri 发送到模板，并且在我的模板中我正在使用它

```
<img src="{{ datauri}}"> 
```

渲染图像。我使用上下文和 html 文件作为上面链接中提到的 render_to_pdf 方法的输入。但我收到以下错误

```
'NoneType' object has no attribute 'bands'
Exception Location:     /usr/lib64/python2.6/site-packages/PIL/Image.py in split, line 1497 
```

views.py 文件中的错误位置是

```
 pdf = pisa.pisaDocument(StringIO.StringIO(html.encode("ISO-8859-1")), result) 
```

关于为什么会发生这种情况以及克服这种情况的方法的任何想法？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T13:22:32.973

尝试使用与 png 不同的格式，似乎 png 图像存在错误

# sql - Microsoft SQL Server 2008 上使用 TABLOCK、XLOCK 命令的间歇性死锁

> ID：12900038
> 
> 赞同：3
> 
> 时间：2012-10-15T16:35:55.577
> 
> 标签：sql, sql-server, deadlock

我遇到以下存储过程的间歇性死锁。它每分钟运行一次。它已经投入生产 1 年多，我们通常不会收到此错误，但有时会突然出现......它在我们的一个环境中每天抛出 3 到 5 次异常......它与其他实例的环境相同没有抛出错误。存储过程是这样创建的，所以它一次只能运行一次，但也许我们这样做的方式不正确？

这是错误：

> *System.Web.HttpUnhandledException：引发了“System.Web.HttpUnhandledException”类型的异常。---> System.Data.SqlClient.SqlException：事务（进程 ID 60）在锁定资源上与另一个进程死锁，并已被选为死锁受害者。重新运行事务。*

这是存储过程：

```
 SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[requestUpdate]
AS
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;

BEGIN TRAN
    DECLARE @StartDate datetime,
            @EndDate datetime,
            @Throttle bit,
            @Expired bit

    SELECT @Throttle = 0
    SELECT @Expired = 0

    SELECT TOP 1 @StartDate = uq.StartDate, @EndDate = uq.EndDate
      FROM UpdateQueue uq WITH(TABLOCK,XLOCK)
     ORDER BY ID DESC

    -- PREVENT ANOTHER REQUEST IF THIS SP HAS BEEN
    -- CALLED IN THE LAST FORTY SECONDS.
    IF DATEADD(SECOND,-40,GETDATE()) < @StartDate
    BEGIN
      SELECT @Throttle = 1
    END

    -- CREATE ANOTHER REQUEST IF THE CURRENT ONE
    -- HAS NOT COMPLETED IN THE LAST FIVE MINUTES.
    IF @StartDate <= DATEADD(MINUTE,-5,GETDATE())
    BEGIN
      SELECT @Expired = 1
    END

    -- HAS THE CURRENT REQUEST EXPIRED?
    IF @EndDate IS NULL AND @Expired = 1
    BEGIN
      INSERT INTO UpdateQueue (RequestID, StartDate) OUTPUT 'EXPIRED' AS Result, INSERTED.RequestID AS RequestID
      VALUES (NEWID(), GETDATE())
    END

    -- HAS THE CURRENT REQUEST COMPLETED AND YOU ARE NOT THROTTLING
    -- OR HAVE THERE NOT BEEN ANY REQUESTS YET?
    ELSE IF (@EndDate IS NOT NULL AND @Throttle = 0) OR @StartDate IS NULL
    BEGIN
      INSERT INTO UpdateQueue (RequestID, StartDate) OUTPUT 'STARTED' AS Result, INSERTED.RequestID AS RequestID
      VALUES (NEWID(), GETDATE())
    END

    -- Running
    ELSE
    BEGIN
      SELECT 'RUNNING' AS Result, NULL AS RequestID
    END

COMMIT 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:47:40.660

我怀疑这是一个特定的锁被持有的时间超过了您的连接愿意等待的时间。如果没有东西可以终止长时间运行的事务，在这里，您将遇到这种情况，因为当连接超时时，SQL Server 会强制等待结束并终止作为死锁受害者的传入锁。

长话短说：某个进程（此处未详述）正在锁定表，从而导致死锁。

检查当您遇到死锁时还发生了什么 - 是否有备份正在运行，或者其他锁定该表的东西？

# php - 填充读取文件夹中文件的 MySQL 数据库

> ID：12900043
> 
> 赞同：0
> 
> 时间：2012-10-15T16:36:14.907
> 
> 标签：php, mysql

这是我的问题。在我的 FTP 服务器中，我有一个文件夹，其中包含一些 txt 文件（abc.txt、hallo.txt、123.txt ......等等），这些文件由远程软件定期上传。这些 txt 文件包含 MySQL 数据库的数据。

我想知道：如何自动填充 MyQSL 数据库（例如使用 cron 作业）？我已经有一个能够填充数据库的 php 文件，但是使用“POST”方法（不是自动）。我必须手动选择每个文件以从我的计算机上传和更新数据库。

我想设置一个 php 代码来读取并获取包含在我的 FTP 文件夹中的旧 .txt 文件，并提供更新数据库。我已经有了能够在 .txt 文件中读取并推断数据以插入数据库的代码。

在此先感谢您的帮助。

垫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T16:45:46.730

```
<?php 
mysql_connect('localhost','root','root'); // MAMP defaults 
mysql_select_db('yourdatabase'); 
$files = glob('*.txt'); 
foreach($files as $file){ 
  mysql_query("LOAD DATA INFILE '".$file." INTO yourtablename"); 
}
?> 
```

或在 Linux 上使用 bash 脚本

```
#!/bin/bash 

for f in *.csv 
do 
      mysql -e "load data infile '"$f"' into table my_table" -u username --password=your_password my_database 
done 
```

您可以编辑 crontab 以使脚本以指定的时间间隔运行。

# java - 圆阵列队列

> ID：12900044
> 
> 赞同：0
> 
> 时间：2012-10-15T16:36:27.423
> 
> 标签：java, arrays, data-structures, queue, circular-buffer

我试图实现一个没有计数变量的循环数组队列。

我正在寻找一种方法来确定数组是否已满，以便调用 expand 方法，但它似乎不知道为什么？谢谢！

```
public void enqueue (T element) {
        if(front != (rear+1) % queue.length) {
            queue[rear] = element;
            rear = (rear+1) % queue.length;
        }
        else
            expandCapacity();
    }

public void expandCapacity() {
        T[] larger = ((T[]) (new Object[queue.length * 2]));

        for (int scan=0; scan < queue.length; scan++) {
            larger[scan] = queue[front];
            front = (front+1) % queue.length;
        }
        front = 0;
        rear = queue.length;
        queue = larger;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:02:35.180

我看到的第一件事是错误的，在您需要扩展的情况下，您永远不会向队列中添加任何内容！该`enqueue`方法需要如下所示：

```
public void enqueue(T element) {
    if (front == (rear + 1) % queue.length) {
        expandCapacity();
    }
    queue[rear] = element;
    rear = (rear + 1) % queue.length;
} 
```

此外，在 中`expandCapacity`，您设置`rear`的比应有的大一；做了：

```
 rear = queue.length - 1; 
```

# file - Struts2上传文件，在发送文件之前验证文件的大小和内容类型

> ID：12900045
> 
> 赞同：5
> 
> 时间：2012-10-15T16:36:30.743
> 
> 标签：file, validation, upload, struts2, size

我对 Struts 2 及其文件上传拦截器有疑问。它已经验证了我的内容类型和文件大小，但上传过程不会停止。示例我的上传限制为 2Mb，用户发送一个 500MB 的文件，拦截器 struts 2 记录该文件太大，但继续上传文件

我想停止上传过程，在错误的情况下，因为struts2只有在发送文件完成后才返回我的页面。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T11:41:08.753

你不能在 Struts 中——因为 Struts 直到你的 servlet 容器完成处理它才得到响应对象。

但是 - 大多数容器都有控制上传文件大小的方法，对于 tomcat，这是 maxPostSize 参数（默认为 2GB） - 据我所知，tomcat 将计算传入字节数，然后在超过此值时退出. 即 Tomcat 将不会继续阅读超过 maxPostSize。其他容器将具有类似的配置参数。我从未使用过它，所以在这里我无法提供任何进一步的帮助。

如果您有嵌套的容器/服务（例如，位于 Apache Web 服务器后面的 tomcat），请确保您配置了正确的

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-09-18T20:23:20.523

你可以。试试这个。有用..

```
<action name="uploadDocs" class="com.test.myapp.UploadAction" method="upload">
    <interceptor-ref name="fileUpload">
        <param name="maximumSize">2097152</param> <!-- Max 2 MB limit per file-->
        <param name="allowedTypes">image/jpeg,image/bmp</param>
    </interceptor-ref>
    <interceptor-ref name="defaultStack"/>
    <interceptor-ref name="execAndWait"/>
        <param  name="delay">1000</param>
        <result name="wait">wait.jsp</result> <!-- display custom please wait page -->
    <result name="success">cmresulttemp.jsp</result>
    <result name="input">attachfiles.jsp</result>
    <result name="error">attachfiles.jsp</result>
</action> 
```

如果您想限制上传内容的总大小（不是每个文件），请将其添加到您的 struts.xml 文件的顶部

```
<constant name="struts.multipart.maxSize" value="10485760" /> <!-- Total 10 MB--> 
```

# ruby - 为自定义二维数组创建每种方法

> ID：12900047
> 
> 赞同：1
> 
> 时间：2012-10-15T16:36:38.183
> 
> 标签：ruby, each, sparse-array

我按照这些[说明](https://stackoverflow.com/questions/9144822/how-to-declare-a-two-dimensional-array-in-ruby)为二维数组创建了一个自定义类。

```
class SparseArray
  attr_reader :hash

  def initialize
    @hash = {}
  end

  def [](key)
    hash[key] ||= {}
  end

  def rows
    hash.length   
  end

  alias_method :length, :rows
end 
```

如何修改此类，以便可以使用 Object#each 遍历对象的第一级和第二级？请简单解释一下，我是新手。

我将如何在对象上使用 each 方法的示例：

```
sparse_array[0][0] = "row 1 column 1"
sparse_array[0][1] = "row 1 column 2"
sparse_array[1][0] = "row 2 column 1"

sparse_array.each do |row|
  # sparse_array[0] on first iteration
  row.each do |column|
    # sparse_array[0][0] on first iteration
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:09:58.517

`Hash`也有一个`each`方法：

```
hash.each {|key, value| puts "#{key} #{value}" } 
```

但是如果你想要一个更好的方法，把它放在你的类中：

```
def each(&block)
  hash.each do |row,column_hash|
    column_hash.each do |column, value|
      block.call(row,column,value)
    end
  end
end 
```

然后你可以做这样的事情：

```
sparse_array.each do |row, column, value|
  puts "row: #{row}, column: #{column}, value: #{value}"
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:04:15.310

您应该在您的上定义`each`方法`SparseArray`并使用它来包装`values`包装的哈希：

```
def each &block
  @hash.values.each(&block)
end 
```

# r - 尝试在控制台中显示数据框时省略变量

> ID：12900051
> 
> 赞同：2
> 
> 时间：2012-10-15T16:36:50.833
> 
> 标签：r, syntax, console

我有一个包含 72 列和 409 行的数据框，称为：spect

问题：`print(spect)`不显示整个数据框。当我滚动到控制台顶部时，我看到以下内容：

```
96       NA       NA       2      NA      NA       NA            
97       NA       NA       2      NA      NA       NA               
98       NA       NA       1       0      NA       NA 
```

上面显示的输出的问题是我没有看到变量，并且行从 nr 开始。96.

但是，当我要求 R 显示一个子集时，比如说 print(spect[,1:3]) 我得到了预期的结果：

> ```
> print(spect[,1:3])
>     idnr gender      age
> 1      1 kvinde 22.07671
> 2      2 kvinde 32.46575
> 3      3 kvinde 19.72055
> 4      4   mand 19.95617 
> ```

此外，当我编写`fix(spect)`编辑器时，会以预期的正确结果打开。此外，当我对数据进行计算时，它似乎工作正常。对于具有大约 30 个变量的较小数据框，我没有这个问题。我没有收到错误消息。

最大打印是

> getOption("max.print") [1] 99999

但是控制台没有接近那个最大值，实际上它只显示了大约 2000 行。重新启动计算机和 R 并删除所有对象并按“control + l”清除控制台后，我得到了同样的错误。

那么这只是R中的一个错误还是我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T16:38:48.257

我假设您坐在 Unix（Linux、MacOS）终端中。终端对您可以向后滚动的行数有限制，您需要更改此限制才能看到所有内容。下面是`gnome-terminal`显示无限回滚历史复选框选项的屏幕截图：

![在此处输入图像描述](../Images/7537518a7caa23e359460a9d800611e7.png)

max.print 选项仅影响打印的项目数。只有当您在输出的*末尾*（底部）看到以下（或类似的）消息时，它才会打动您：

```
 [ reached getOption("max.print") -- omitted 998000 entries ] 
```

也就是说，在大多数情况下，通过滚动终端查看大型数据帧是不必要且不切实际的。通常，人们对某些特定行感兴趣，并且尝试选择这些行。或者一个块一块地检查它：

```
spect[ 1:50, ]
spect[ 51:100, ] 
```

等等。或者，尝试实现数据的令人满意的图形表示。

# ruby-on-rails - 带有两个正斜杠的 URL

> ID：12900057
> 
> 赞同：2
> 
> 时间：2012-10-15T16:37:04.090
> 
> 标签：ruby-on-rails, ruby-on-rails-3

在我的 Rails 项目中，在我`index`看来，我有一个链接

```
<%= link_to 'Show all posts', show_all_path %> 
```

在`routes.rb`中，我有一条路线：

```
match "show_all" => "Posts#show_all" 
```

当我单击该链接时，它来自

```
http://<domain name>/my_rails_project 
```

到

```
http://<domain name>/my_rails_project//show_all 
```

有用。但是，有两个正斜杠看起来不是很好。我可以让它只出现一个正斜杠吗？

编辑：这些是我的一些文件：

配置/环境.rb

```
require File.expand_path('../application', __FILE__) 
Blog::Application.initialize! 
```

配置/环境/development.rb

```
Blog::Application.configure do 
  config.cache_classes = false 
  config.whiny_nils = true 
  config.consider_all_requests_local = true 
  config.action_view.debug_rjs = true 
  config.action_controller.perform_caching = false 
  config.action_mailer.raise_delivery_errors = false 
  config.active_support.deprecation = :log 
  config.action_dispatch.best_standards_support = :builtin 
  config.action_controller.asset_host = "//pauls.scripts.asu.edu/blog/public" 
end 
```

配置/路由.rb：

```
Blog::Application.routes.draw 
  do resources :posts match "show_all" => "Posts#show_all" 
end 
```

的输出`rake routes`

```
show_all        /show_all(.:format)             {:action=>"show_all", :controller=>"Posts"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T02:32:29.897

当我使用“匹配”时，这是我使用的语法：

`match "/show_all" => "Posts#show_all"`

但是我不确定那个正斜杠是否能解决你的问题。试试看？

干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:40:05.560

您如何将应用程序设置为在 sub-uri 下提供服务？这是最有可能的问题。也许报告一下你是如何做到这一点的。大概您不是在 webrick 下运行它，而是在开发模式下的服务器上的乘客下运行？

RailsBaseURI 或 RAILS_RELATIVE_URL_ROOT 的值是多少，具体取决于您使用的内容，是否有斜杠？检查您的 apache/passenger 配置文件夹中任何位置的斜杠（虚拟主机中的文档根目录？）。还可以尝试输出 root_url 的值以查看它是什么。

作为一个简单的本地测试，创建一个新项目并使用类似这样的路由（注意范围）：

博客::Application.routes.draw 做

```
scope 'my_rails_project' do
   match '/test',  :to => 'welcome#test'
end 
```

结尾

然后在新的帖子控制器中进行测试操作：

```
 def test
    render :text => "ROOT-#{root_url}"
 end 
```

通过使用更简单的路线并引导您重新设置设置，这可能会揭示出问题所在。

然后在您的实际项目中，您可以尝试两件事，更改用于设置子 uri 的 ENV 变量，验证虚拟主机设置，并围绕所有路由设置范围：

```
scope 'my_rails_project' do
   match '/show_all'=> "posts#show_all", :as => "show_all"
end 
```

我还会尝试检查 show_all_path 的输出，以查看您在链接中实际获得的内容，例如您是否在 href 中获得“//”或其他内容？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-23T14:01:23.187

这不是导轨问题。Rails 不知道自己的 url。它只知道资源的相对 url。这些亲属 url 被附加到域 url。它不会生成非法 url，因此不会引发错误。

所以它看起来像一个虚拟主机问题。但我不能告诉你到底是什么问题。在某些时候，您的域 url 是 www.your_domain/rails_projects/。

您可以通过更新您的虚拟主机以获取 www.your_domain 来改变这一点。

**更新 ：**

这里有一个例子：

```
<VirtualHost 172.20.30.40>
 DocumentRoot /www/subdomain/sub2
 ServerName www.sub2.domain.tld
 ServerPath /sub2/
 </VirtualHost> 
```

将回应：

```
http://www.sub2.domain.tld/sub2/ 
```

它看起来与您的问题非常相似。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-18T12:04:09.973

你试过这个语法吗？

```
match '/show_all'=> "posts#show_all", :as => "show_all" 
```

:as 选项为您提供正确的路径

```
<%= link_to 'Show all posts', show_all_path %> 
```

或者，您的 default_url_options 可能会在 url 末尾附加额外的斜杠。检查您的操作 controller.default_url_options

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-18T13:07:25.657

我注意到您的 Rails 应用程序位于子目录中。我不确定它是否相关，但快速搜索生成了[本指南](http://kb.site5.com/ruby-on-rails/how-to-deploy-a-rails-3-application-to-a-sub-directory/)，它可能会也可能不会解决您的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T08:40:03.933

如果您想要这样的网址，`http://<domain name>/my_rails_project/show_all`请将其添加到您的 routes.rb

```
resources :posts
match "show_all", :to => "posts#show_all" 
```

如果您喜欢这样的网址，请`http://<domain name>/my_rails_project/posts/show_all`添加：

```
resources :posts do
  collection do
    get "show_all"
  end
end 
```

[您可以在此处](http://guides.rubyonrails.org/routing.html)查看更多示例

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-22T18:15:37.883

尝试使用空白应用程序重现此问题并将所有代码发布在 github 上，我认为错误可能是其他问题。

请告诉我们您的 rails 版本和 ruby​​ 版本。

# javascript - 如何按数字然后按字母顺序对 javascript 对象数组进行排序？

> ID：12900058
> 
> 赞同：37
> 
> 时间：2012-10-15T16:37:05.093
> 
> 标签：javascript, jquery, arrays, sorting

> **可能重复：**
> [按 JavaScript 中的字段值对数组中的对象进行排序](https://stackoverflow.com/questions/1129216/sorting-objects-in-an-array-by-a-field-value-in-javascript)

如何按数字（按 id）然后按字母（按名称）对对象数组进行排序？

当前的方式是提供无效的输出。

这是我要整理的对象

```
var items = [
    {
        "id": 165,
        "name": "a"
    },
    {
        "id": 236,
        "name": "c"
    },
    {
        "id": 376,
        "name": "b"
    },
    {
        "id": 253,
        "name": "f"
    },
    {
        "id": 235,
        "name": "e"
    },
    {
        "id": 24,
        "name": "d"
    },
    {
        "id": 26,
        "name": "d"
    }
] 
```

以及我尝试排序的方式

```
items.sort(function(a, b) {
    return (a.id - b.id);
}).sort(function(a, b) {
    return (a.name - b.name);
}); 
```

这是jsfiddle。

[http://jsfiddle.net/jh4xb/](http://jsfiddle.net/jh4xb/)

编辑：很抱歉造成混乱，我已经被这个问题迷惑了一段时间。

我想要完成的是首先按最高 id 排序，然后按字母顺序排序，所以最后它应该看起来像：

```
var items = [
    {
        "id": 376,
        "name": "b"
    },
    {
        "id": 253,
        "name": "f"
    },
    {
        "id": 236,
        "name": "c"
    },
    {
        "id": 235,
        "name": "e"
    },
    {
        "id": 165,
        "name": "a"
    },
    {
        "id": 26,
        "name": "d"
    },
    {
        "id": 24,
        "name": "d"
    }
] 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-10-15T16:43:17.333

我认为最好只用...

```
items.sort(function(a, b) { 
  return a.id - b.id  ||  a.name.localeCompare(b.name);
}); 
```

第二种基本上会否定第一种，所以你必须做一次。)

`a.id - b.id || a.name.localeCompare(b.name)`表达式将首先比较`id`s; 只有当它们相等时，它才会比较名称（并返回此比较的结果）。

如果您需要颠倒顺序，请交换位置（`b.id - a.id`等） - 或者只是否定整个事情：

```
items.sort(function(a, b) { 
  return - ( a.id - b.id  ||  a.name.localeCompare(b.name) );
}); 
```

这是[JSFiddle](http://jsfiddle.net/FCZUV/)（必须稍微简化数据以表明我的观点）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-15T17:00:32.983

创建一个通用函数以根据需要对其进行排序。检查下面的动态排序功能

```
var items = [
{
 "id": 165,
 "name": "a"},
{
 "id": 236,
 "name": "b"},
{
 "id": 376,
 "name": "c"},
{
 "id": 253,
 "name": "d"},
{
 "id": 235,
 "name": "e"},
{
  "id": 24,
  "name": "f"}
];

function dynamicSort(property) {
   return function(a, b) {
       return (a[property] < b[property]) ? -1 : (a[property] > b[property]) ? 1 : 0;
   }
}

items.sort(dynamicSort('name')).sort(dynamicSort('id'));
console.log(items);
items.sort(dynamicSort('id')).sort(dynamicSort('name')); 
console.log(items); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-15T16:43:45.873

如果你的意思是你希望它们排序`id`，如果`id`匹配，你希望它们排序，`name`然后使用这个：

```
items.sort(function(a, b) {
    if (a.id !== b.id) {
        return a.id - b.id
    }
    if (a.name === b.name) {
      return 0;
    }
    return a.name > b.name ? 1 : -1;
}); 
```

否则你的问题不清楚。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-15T16:44:53.563

你的问题是你如何对字母进行排序。
`a.name - b.name`

没有按照你的想法做。它没有按字典顺序评估它们。将其替换为

`a.name < b.name ? -1 : 1;`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T16:42:29.673

我在 Chrome 中没有看到任何错误，但它没有正确排序。

如果我将您的排序代码更改为：

```
var firstRun = items.sort(function(a, b) {
    return (a.id - b.id);
});
var secondRun = firstRun.sort(function(a, b) {
    return (a.name - b.name);
});

console.log(secondRun);​ 
```

我相信它的排序正确。您的示例实际上并不需要进行第二次排序，因为每个数字（id）都不同。但是当我让 b、d 和 e 的 ID 都为 235 时，一切正常。

# javascript - 使用 tablesorter 对混合数据列进行排序

> ID：12900059
> 
> 赞同：1
> 
> 时间：2012-10-15T16:37:06.123
> 
> 标签：javascript, jquery, tablesorter

我目前正在使用此处找到的 JQuery Tablesorter 插件：[http](http://www.tablesorter.com) ://www.tablesorter.com ，并且我遇到了包含日期和文本的列的问题。这是jsfiddle：

[http://jsfiddle.net/M3V4U/1/](http://jsfiddle.net/M3V4U/1/)

如果您单击名字字段标题，它不会排序，因为里面有一个随机日期。我尝试强制进行文本排序，但它不起作用。有人有想法么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T05:10:14.623

看起来您正在尝试使用元数据设置排序器类型

```
<th class="{sorter: 'text'}">first name</th> 
```

但是元数据插件没有在那个演示中加载。所以要么加载[元数据插件](https://github.com/jquery-orphans/jquery-metadata)，要么将排序器类型添加到标题选项：

```
$("table").tablesorter({
  headers: {
    0: { sorter: "text" },
    4: { sorter: "percent" }
  }
}); 
```

这是一个[更新的演示](http://jsfiddle.net/Mottie/eY8uH/270/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:58:31.140

找到了一个不太好的答案，但现在有效。

我删除了这个解析器：

```
ts.addParser({
    id: "shortDate",
    is: function (s) {
        return /\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(s);
    }, format: function (s, table) {
        var c = table.config;
        s = s.replace(/\-/g, "/");
        if (c.dateFormat == "us") {
            // reformat the string in ISO format
            s = s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/, "$3/$1/$2");
        } else if (c.dateFormat == "uk") {
            // reformat the string in ISO format
            s = s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/, "$3/$2/$1");
        } else if (c.dateFormat == "dd/mm/yy" || c.dateFormat == "dd-mm-yy") {
            s = s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/, "$1/$2/$3");
        }
        return $.tablesorter.formatFloat(new Date(s).getTime());
    }, type: "numeric"
}); 
```

这似乎解决了我的问题，因为它完全停止了日期解析器的执行。这可能会在其他情况下导致问题，但目前似乎适用于我的页面。如果人们有其他答案，我仍然愿意接受。

# c# - C# 从 SQL 数据表中填充组合框

> ID：12900062
> 
> 赞同：1
> 
> 时间：2012-10-15T16:37:13.307
> 
> 标签：c#, sql

```
DataTable _dt = new DataTable();

using (SqlConnection _cs = new SqlConnection("Data Source=COMNAME; Initial Catalog=DATABASE; Integrated Security=True"))
{
    string _query = "SELECT * FROM Doctor";
    SqlCommand _cmd = new SqlCommand(_query, _cs);

    using (SqlDataAdapter _da = new SqlDataAdapter(_cmd))
    {
        _da.Fill(_dt);
    }
}
cbDoctor.DataSource = _dt;
foreach(DataRow _dr in _dt.Rows)
{
    cbDoctor.Items.Add(_dr["name"].ToString());
} 
```

有一个错误...

结果`System.Data.DataRowView`不是数据库中的数据..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T16:59:25.040

我还不确定您的代码中的确切错误是什么，但如果您可以不使用`DataTable`，您可以这样做：

```
using (SqlConnection sqlConnection = new SqlConnection("connstring"))
{
    SqlCommand sqlCmd = new SqlCommand("SELECT * FROM Doctor", sqlConnection);
    sqlConnection.Open();
    SqlDataReader sqlReader = sqlCmd.ExecuteReader();

    while (sqlReader.Read())
    {
        cbDoctor.Items.Add(sqlReader["name"].ToString());
    }

    sqlReader.Close();
} 
```

有关更多信息，请查看[MSDN 上的 SqlDataReader 参考](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.aspx)。

为了在您发布的原始代码中找到问题，请提供您在哪一行得到异常的信息（或者是阻止应用程序编译的错误？）以及它的全部信息是什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T17:04:12.247

您还可以将组合框的 DisplayMember 属性指定为任何列名。例如，如果你想显示名称字段，你可以这样做

```
Combobox1.DisplayMember="Name"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T16:48:43.183

我认为问题在于您试图将多列插入组合框（只能接受一列）。调整您的 SELECT 语句，使其将您需要的所有数据合并到一列中：

例子：

```
SELECT Name + ' ' LastName + ' '+ ID AS 'DoctorData' FROM Doctor 
```

通过使用 + 运算符，您可以组合数据库中的多个列，并将其表示为单个数据。我认为您的代码应该在那之后工作（您甚至可以评论 foreach 循环，我认为将数据源添加到您的组合框就足够了）

# php - 如何以编程方式重新创建 php yii 会话？

> ID：12900063
> 
> 赞同：2
> 
> 时间：2012-10-15T16:37:13.597
> 
> 标签：php, session, yii

从我的应用程序视图中，我需要以编程方式注销当前用户并在此之后立即登录另一个用户。

我想将第二个用户登录到他自己的不同 CHttpSession（使用另一个 sessionID 等等）。出于安全原因，我需要它。

如何在 Yii 框架中实现这一点？

下面的代码

$oSession->destroy(); $oSession->open();

没有按预期工作..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T16:52:18.320

看起来您正在尝试[冒充用户](http://www.yiiframework.com/wiki/154/impersonate-users-within-yii-framework/)：

1.  在您的 UserIdentity 中创建一个函数，允许您以另一个已知用户身份登录：

    ```
    protected function logInUser($user)
    {
        if($user)
        {
            $this->_user = $user;
            $this->_id=$this->_user->id;
            $this->setState('name', $this->_user->name);
            $this->errorCode=self::ERROR_NONE;
        }
    } 
    ```

2.  在你的控制器中，调用这个函数来获取 UserIdentity 对象，然后使用 Yii 的 CWebUser 登录

    ```
    $ui = null;
    $user = User::model()->findByPk($userId);
    if($user)
    {   
        $ui = new UserIdentity($user->email, "");
        $ui->logInUser($user);
    }
    Yii::app()->user->login($ui, 0); 
    ```

请记住保护此控制器的操作不受非授权用户的影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:10:01.520

一种可能的棘手方法（经过测试）：

```
session_unset();
Yii::app()->user->id = $the_new_id; 
```

执行上述代码时，页面上没有任何可见的变化，因此您可能需要重定向浏览器：

```
$this->redirect('somewhere'); 
```

在下一页加载时，具有 $the_new_id 的用户将登录

# php - PHP 中的 HTML DOM 解析器

> ID：12900065
> 
> 赞同：1
> 
> 时间：2012-10-15T16:37:16.107
> 
> 标签：php, html, dom

使用 PHP Simple HTML DOM Parse 但无法获取要显示的图像。

我不是编码员，我正在尝试从网站上提取文章和图像。文章很好，但图像不显示。而是显示部分路径，例如

```
> //ssl.gstatic.com/ui/v1/button/search-white.png
> //ssl.gstatic.com/ui/v1/button/search-white.png
> //ssl.gstatic.com/ui/v1/icons/common/settings.png 
```

以谷歌为例，这是我正在使用的代码：

```
<?php 
$html = file_get_html('https://news.google.com/nwshp?hl=en&tab=in');  

foreach($html->find('h2') as $e) 
     echo $e->innertext . '<br><br>';  

foreach($html->find('div.jsdisplay') as $e) 
     echo $e->innertext . '<br>'; 

foreach($html->find('img') as $element) 
     echo $element->src . '<br>';
?> 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T16:48:21.650

你应该更换

```
foreach($html->find('img') as $element)
    echo $element->src . '<br>'; 
```

和

```
foreach ( $html->find('img') as $element ) {
    $img = str_replace(array("//ssl"), array("http://ssl"), $element->src);
    for($i = 0; $i < 5; $i ++) {
        $img = str_replace("//nt$i", "http://nt$i",$img);
    }
    echo "<img src=\"$img\"  /> <br>";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T16:43:57.590

`//ssl.gstatic.com/ui/v1/button/search-white.png`是一个相对 URI（未指定方案，因此它将使用与它出现的页面相同的方案（例如 http: 或 https:)）。

像解决任何其他相对 URI 一样解决它。

> 我的问题是如何使用我原始帖子中的代码显示图像。

您必须将`<img>`标签而不是 URI 作为纯文本输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T16:50:42.300

**在您最后发表评论后使用您的原始网站网址**“http://frielatvsales.com/QuadAttachments.htm”更新我的答案

**试试下面的代码。**

```
include_once "simplehtmldom/simple_html_dom.php";

$url = "http://frielatvsales.com/QuadAttachments.htm";

$html = file_get_html($url); 

preg_match('@^(?:http://)?([^/]+)@i', $url, $matches);

$host = $matches[1];

foreach($html->find('h2') as $e) {

echo $e->innertext . '<br><br>';  
}

foreach($html->find('div.jsdisplay') as $e) {

echo $e->innertext . '<br>'; 

}

foreach($html->find('img') as $element) {

echo '<img src=http://'.$host.'/'.$element->src . ' /><br>';
} 
```

# session - 配置两个 cxf jaxrs 客户端使用相同的会话（cookies）

> ID：12900072
> 
> 赞同：9
> 
> 时间：2012-10-15T16:37:45.480
> 
> 标签：session, rest, cookies, cxf, jax-rs

我想使用 apache cxf 连接到带有 jaxrs 客户端的 REST 服务器。服务器有一个 url 来进行身份验证，还有一些其他的 url 来做实际的事情。登录后，服务器会创建一个会话并保持连接打开 30 分钟。我的问题是客户端不存储 cookie，我总是在服务器上获得一个新的（未经过身份验证的）会话。

我在我的 spring 应用程序上下文中配置了客户端。

```
<jaxrs:client id="loginResource" 
    serviceClass="com.mycompany.rest.resources.LoginResource" 
    address="${fsi.application.url}">
</jaxrs:client>
<jaxrs:client id="actionResource" 
    serviceClass="com.mycompany.rest.resources.ActionResource" 
    address="${fsi.application.url}">
</jaxrs:client> 
```

如何将两个客户端配置为使用相同的会话或在客户端之间共享会话 cookie？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-21T01:33:48.790

我一直在努力解决同样的问题，我终于找到了解决方案。

1）让客户端保留cookies。

```
WebClient.getConfig(proxy).getRequestContext().put(
        org.apache.cxf.message.Message.MAINTAIN_SESSION, Boolean.TRUE); 
```

*也许有一种方法可以通过配置与编程来完成上述操作。*

2) 将 cookie 从一个客户端复制到另一个客户端。

```
public static void copyCookies(Object sourceProxy, Object targetProxy) {
    HTTPConduit sourceConduit = WebClient.getConfig(sourceProxy).getHttpConduit();
    HTTPConduit targetConduit = WebClient.getConfig(targetProxy).getHttpConduit();
    targetConduit.getCookies().putAll(sourceConduit.getCookies());
} 
```

使用代理 A 进行身份验证后，我调用上述方法与代理 B 共享其 cookie，代理 B 完成实际工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-29T14:00:30.600

我使用以下请求/响应过滤器在每个请求中传递会话 ID：

> **ClientResponseFilter** >> 用于从 session-cookie 中提取 session-id
> 
> **ClientRequestFilter** >> 在每个请求中将 session-id 作为 cookie 标头传递

```
private class SessionIdRequestFilter implements ClientRequestFilter, ClientResponseFilter {
    /** cookie header key */
    private static final String COOKIE_KEY = "Cookie"; //$NON-NLS-1$

    /** name of the session cookie */
    private String cookieName = "JSESSIONID";

    /** holds the session id from the cookie */
    private String sessionId;

    @Override
    public void filter(ClientRequestContext request) throws IOException {
        // append session cookie to request header
        if (!request.getHeaders().containsKey(COOKIE_KEY) && sessionId != null) {
            request.getHeaders().add(COOKIE_KEY, getCookieName() + "=" + sessionId); //$NON-NLS-1$
        }
    }

    @Override
    public void filter(ClientRequestContext request, ClientResponseContext response) throws IOException {
        // find sessionId only if not already set
        if (sessionId == null) {
            Map<String, NewCookie> cookies = response.getCookies();
            if (cookies != null && !cookies.isEmpty()) {
                NewCookie cookie = cookies.get(getCookieName());
                if (cookie != null) {
                    sessionId = cookie.getValue();
                }
            }
        }
    }

    private String getCookieName() {
        return cookieName;
    }
} 
```

要注册过滤器，请使用：

```
RestClientBuilder.newBuilder().baseUri(apiUri).register(new SessionIdRequestFilter()); 
```

# virtualization - Type-1 VMM 和 Ring 1

> ID：12900074
> 
> 赞同：1
> 
> 时间：2012-10-15T16:37:47.700
> 
> 标签：virtualization, context-switch, protected-mode, hypervisor

最近，我正在做关于虚拟化的功课。我的问题是，VMM 如何将控制权转移到来宾内核并在 Ring 1 中运行该代码？

Type-1 VMM：这是经典的陷阱和仿真 VMM。VMM 直接在硬件上运行，在 Ring 0 中充当“主机操作系统”。来宾内核和来宾应用程序在 VMM 上运行，分别在 Ring 1 和 Ring 3 中。

1.  当来宾应用程序进行系统调用时，它将捕获到 Ring 0 VMM，（CPU 旨在执行此操作）。

2.  **然后 VMM 将检测到这是一个系统调用，然后将控制权转移到来宾内核系统处理程序并在环 1 中执行它。**

3.  完成后，来宾内核执行 syscall-return，这是一个特权调用，它将再次陷入 VMM。

4.  VMM 然后在 ring 3 中真正返回到访客用户空间。（CPU 也被设计为这样做。）

我的问题是关于第 2 步**的。VMM 如何将控制权转移到来宾内核并强制 CPU 响铃 1？**这不可能是一个简单的“调用”，因为那时来宾内核代码将在环 0 中运行。它必须是某种“系统调用返回”或一些特殊的上下文切换指令。

你有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-01T16:48:32.170

只需使用 RPL=1 的 CS 选择器运行来宾操作系统（尽管在 x86 上）。从更高特权的环返回到更低的环通常使用 iret 完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T16:24:45.143

Xen 是在 ring 1 中运行客户操作系统的 VMM 之一。在 Xen 中，诸如 HLT 指令（客户操作系统运行在 ring 1 中的指令）之类的指令被超级调用取代。在这种情况下，调用 xen_idle() 方法而不是调用 HLT 指令（最终在 Linux 内核中完成）。它执行一个超级调用，即管理特权环切换的 HYPERVISOR_sched_op(SCHEDOP_block, 0) 超级调用。有关更多信息，请参阅：

[http://www.linuxjournal.com/article/8909](http://www.linuxjournal.com/article/8909)

# sql - 如何在存储过程中使用 CSV 值？

> ID：12900076
> 
> 赞同：0
> 
> 时间：2012-10-15T16:37:52.673
> 
> 标签：sql, sql-server-2008, stored-procedures, csv

我将 CSV 值存储在字符串中：

```
 StringBuilder CSValue = new StringBuilder();
    for (int i = 0; i < obj._contactNumbers.Count; i++)
    {
        CSValue.Append(obj._contactNumbers[i]);
        if (i != obj._contactNumbers.Count - 1)
        {
            CSValue.Append(",");
        }
    } 
```

我已将它传递给存储过程（作为 CSValue.ToString()），现在我必须选择每个值并将其存储在单元格中。我应该如何分离这些值？

请帮帮我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T16:47:03.137

由于您使用的是 SQL Server 2008，而不是 CSV，因此我实际上会将它们推送到 XML 文档中，如下所示：

```
<Values>
    <Value value="1" />
    <Value value="2" />
    <Value value="3" />
</Values> 
```

然后，在存储过程中，我将使用以下 SQL 将每个值作为单独的行检索：

```
SELECT value.value('(@value)[1]', 'INT') as 'id' 
FROM @idList.nodes('/Values/Value') as T(value) 
```

可以使用普通 SQL 查询连接将此结果与任何其他表连接，并获得所需的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T16:48:34.673

我定义了一个拆分函数。

有几个彻底的堆栈溢出线程与此有关，例如，[在 T-SQL 中等效的拆分函数？](https://stackoverflow.com/questions/697519/split-function-equivalent-in-tsql)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T16:45:39.800

你可以试试这个

```
declare @Temp nvarchar(max), @c int, @a nvarchar(max)

declare @Temp_Table table (value nvarchar(max))

select @Temp = 'a,b,c,g,a'

select @c = CHARINDEX(',', @Temp)
while @c > 0
begin
    insert into @Temp_Table
    select LEFT(@Temp, @c - 1)

    select @Temp = right(@Temp, LEN(@Temp) - @c)
    select @c = CHARINDEX(',', @Temp)
end

select * from @Temp_Table 
```

或者您可以编写一个表函数来执行此操作，如果您需要经常这样做

# c# - 具有泛型和 DI 的存储库模式

> ID：12900078
> 
> 赞同：1
> 
> 时间：2012-10-15T16:38:00.253
> 
> 标签：c#, generics, dependency-injection, repository-pattern

我有一个其他合同扩展的基本存储库合同，如下所示

```
public interface IBaseRepository<T> where T : class 
{
  IList<T> GetContents();
} 
```

然后还有其他合同将其扩展如下

```
public interface IRepository1 : IBaseRepository<MyClass1>
{
}

public interface IRepository2 : IBaseRepository<MyClass2>
{
} 
```

我实现 IRepository1 如下

```
public class Repository1 : IRepository1
{
 public IList<MyClass1> GetContents()
 {
  //some code goes here
 }
} 
```

对于 IRepository2 类似

```
public class Repository2 : IRepository2
{
 public IList<MyClass2> GetContents()
 {
  //some code goes here
 }
} 
```

现在我有一个服务 Service1 实现 IService 如下

```
public class Service1 : IService
{

} 
```

我想在我的服务构造函数中使用我的基础存储库（IBaseRepository），获取这个基础存储库的一个实例并像这样使用它

```
 public class Service1 : IService
 {
   private IBaseRepository<T> _baseRepository;
   public Service1(IBaseRepository<T> baseRepository)
   {
     _baseRepository = baseRepository;
   }

   public MyMethod1()
   {
      var contentsOfType1 = _baseRepository<MyClass1>.GetContents();
   }

   public MyMethod1()
   {
      var contentsOfType2 = _baseRepository<MyClass2>.GetContents();
   }
  } 
```

这是我无法做到的。

所以我有一个类型为 T 的通用基础存储库合同，还有其他合同（接口）扩展了基础合同，并指定了 T 类型。

所有这些合约（扩展通用基础合约）都有各自的实现。

我想要做的是在我的服务类中，实例化这个通用基础合约，并使用它来推断扩展类型（以及因此实现）并使用基础存储库中的方法。

所以如果基础合约是 `IBaseRepository<T>`

和延长合同是 `IRepository1 : IBaseRepository<MyClass1>`

这是由 `Repository1 : IRepository1`

我想在我的服务类中使用它

```
public class service()
{
   *private IBaseRepository<T> _repo;

   public  service(IBaseRepository<T> repo)
   { 
    *_repo = repo;
   } 

   public void MyMethod()
   {

     *var x = _repo<MyClass1>.MethodFromIBaseRepository()
   }

} 
```

所以它是我想要实现的*标记线，我无法做到。

我正在为 DI 使用城堡温莎。

谢谢你们的帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T15:16:48.790

除了通用的`IRepository<T>`. 如果你需要这些，你就错过了一个抽象。

例如，人们拥有自定义存储库接口的一个常见原因是因为他们有一些存储库具有的自定义查询，而其他存储库没有。例如：

```
public interface IEmployeeRepository : IRepository<Employee>
{
    Employee GetEmployeeOfTheMonth(int month);
} 
```

这里的问题是`IEmployeeRepository`被滥用于“自定义查询”。自定义查询值得拥有自己的（通用）抽象：

```
// Defines a query
public interface IQuery<TResult>
{
}

// Defines the handler that will execute queries
public interface IQueryHandler<TQuery, TResult>
    where TQuery : IQuery<TResult>
{
    TResult Handle(TQuery query);
} 
```

通过这种抽象，我们可以向系统添加自定义查询，而无需创建`IRepository<T>`派生词：

```
public class GetEmployeeOfTheMonthQuery : IQuery<Employee>
{
    [Range(1, 12)]
    public int Month { get; set; }
}

class GetEmployeeOfTheMonthHandler : IQueryHandler<GetEmployeeOfTheMonthQuery, Employee>
{
    public Employee Handle(GetEmployeeOfTheMonthQuery query)
    {
        // todo: query the database, web service, disk, what ever.
    }
} 
```

需要知道当月员工的消费者现在可以简单地依赖`IQueryHandler<GetEmployeeOfTheMonthQuery, Employee>`并执行查询，如下所示：

```
var query = new GetEmployeeOfTheMonthQuery { Month = 11 };
var employee = this.employeeOfMonthHandler.Handle(query); 
```

这可能看起来像是开销，但这种模型非常灵活、可扩展，并且有许多有趣的好处。例如，通过使用装饰器包装处理程序很容易添加横切关注点。

这也允许我们的存储库隐藏在一个通用接口之后，这使我们能够轻松地一次批量注册它们并向它们添加装饰器。

有关更深入的信息，请阅读这篇文章：[同时……在我的架构的查询方面](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=92)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T05:34:33.283

不可能。控制容器的反转通过构造函数提供依赖，因此它必须在构造函数中知道要获取什么类型。所以你应该这样做：

```
public class service()
{
   private IBaseRepository<MyClass1> _repo;

   public  service(IBaseRepository<MyClass1> repo)
   { 
       _repo = repo;
   } 

   public void MyMethod()
   {

      var x = _repo.MethodFromIBaseRepository()
   }

} 
```

# c# - 地址簿教程

> ID：12900082
> 
> 赞同：0
> 
> 时间：2012-10-15T16:38:01.260
> 
> 标签：c#, visual-studio-2010

我一直在[为初学者使用 ac# 教程来创建地址簿](http://www.youtube.com/watch?v=0ZoDmeAZAD8&feature=relmfu)。我按照说明进行操作，遇到了两个问题。

1.  当我选择 Listview 框的属性时，缺少[SelectedIndexChanged](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.selectedindexchanged%28v=vs.110%29.aspx)事件。我已经重新启动并刷新了几次程序。我已直接写入该文件，但它仍然不存在。

2.  从列表中选择联系人时，文本框不反映选择。我怀疑这与 ui 中缺少[SelectedIndexChanged](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.selectedindexchanged%28v=vs.110%29.aspx)事件有关。即使我在代码中设置[SelectedIndexChanged](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.selectedindexchanged%28v=vs.110%29.aspx)事件，这种情况仍然存在。

所有帮助将不胜感激。我的代码如下

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;
using System.Web;

namespace AddressBook
{
    public partial class AddressBook : Form
    {
        public AddressBook()
        {
            InitializeComponent();
        }

        List<Person> people = new List<Person>();

        private void AddressBook_Load(object sender, EventArgs e)
        {
            string path = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);
            if (!Directory.Exists(path + "\\Address Book - Joe"))
                Directory.CreateDirectory(path + "\\Address Book - Joe");
            if (!File.Exists(path + "\\Address Book - Joe\\settings.xml"))
                File.Create((path + "\\Address Book - Joe\\settings.xml"));
        }

        private void btnAdd_Click(object sender, EventArgs e)
        {
            Person p = new Person();
            p.FirstName = txtFName.Text;
            p.Address = txtAddress.Text;
            p.City = txtCity.Text;
            p.State = comboState.Text;
            p.ZipCode = txtZip.Text;
            p.Email = txtEmail.Text;
            p.PhoneNumber = txtPhone.Text;
            p.Additional = rtxtAdd.Text;
            people.Add(p);
            listView1.Items.Add(p.FirstName);
            txtFName.Text = "";
            txtAddress.Text = "";
            txtCity.Text = "";
            comboState.Text = "";
            txtZip.Text = "";
            txtEmail.Text = "";
            txtPhone.Text = "";
            rtxtAdd.Text = "";

        }

        private void listView1_SelectedIndexChanged(object sender, EventArgs e)
        {
            txtFName.Text = people[listView1.SelectedItems[0].Index].FirstName;
            txtAddress.Text = people[listView1.SelectedItems[0].Index].Address;
            txtCity.Text = people[listView1.SelectedItems[0].Index].City;
            comboState.Text = people[listView1.SelectedItems[0].Index].State;
            txtZip.Text = people[listView1.SelectedItems[0].Index].ZipCode;
            txtEmail.Text = people[listView1.SelectedItems[0].Index].Email;
            txtPhone.Text = people[listView1.SelectedItems[0].Index].PhoneNumber;
            txtZip.Text = people[listView1.SelectedItems[0].Index].ZipCode;
            rtxtAdd.Text = people[listView1.SelectedItems[0].Index].Additional;

        }

        private void txtFName_TextChanged(object sender, EventArgs e)
        {

        }
    }

    public class Person
    {
        public string FirstName { get; set; }
        public string Address { get; set; }
        public string City { get; set; }
        public string State { get; set; }
        public string ZipCode { get; set; }
        public string PhoneNumber { get; set; }
        public string Email { get; set; }
        public string Additional { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T16:39:51.927

您需要单击“属性”窗口中的闪电图标以转到“事件”选项卡。
在那里，您将看到`SelectedIndexChanged`事件（假设您选择了正确的控件。

您需要将处理程序绑定到该事件才能运行代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T16:40:08.773

`SelectedIndexChanged`可能在“属性”窗口中列为**OnSelectedIndexChanged**。一旦您使该事件处理程序工作，文本框应按预期填充值。

# windows - 如何读取更新日志文件

> ID：12900086
> 
> 赞同：0
> 
> 时间：2012-10-15T16:38:23.563
> 
> 标签：windows, cmd

我想知道是否有一种方法/命令可以在实时更新窗口时读取日志。我的操作系统是 Windows 7。类似于 linux 中的“tail -f *.log”。

任何帮助都会非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T16:45:55.583

上一篇文章中提到了很多工具

[https://serverfault.com/questions/7263/convenient-windows-equivalent-to-tail-f-logfile](https://serverfault.com/questions/7263/convenient-windows-equivalent-to-tail-f-logfile)

[http://unxutils.sourceforge.net/](http://unxutils.sourceforge.net/) unxutils 就是其中之一

# ios - PhoneGap CDVViewController

> ID：12900092
> 
> 赞同：1
> 
> 时间：2012-10-15T16:38:54.620
> 
> 标签：ios, inheritance, cordova

我正在使用 PhoneGap 构建一个小型 IOS 应用程序，在设置了一个基础项目后，我注意到在 AppDelegate.h 下初始化了以下 PhoneGap 对象：

```
@property (nonatomic, strong) IBOutlet CDVViewController* viewController; 
```

但是我也注意到 MainViewController 继承了 CDViewController，并且 MainViewController 在通过 AppDelegate 运行后显示，所以我不太明白为什么它只执行以下操作：

```
@property (nonatomic, strong) IBOutlet MainViewController* viewController; 
```

我修改了上面的代码，它工作得很好。是否有任何理由使用 CDViewController 而不是 MainViewController :S？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-07T23:19:43.893

MainViewController 是 CDVViewController 的子类，因此更通用且不易混淆。

# jquery - 使用引导选项卡选择的动态数据的视觉故障

> ID：12900093
> 
> 赞同：0
> 
> 时间：2012-10-15T16:38:55.937
> 
> 标签：jquery, css, twitter-bootstrap, jquery-chosen

使用引导程序版本 2.1.1 使用最后选择

当所选内容在选项卡内容中重新呈现时，我正在尝试视觉故障，在选项卡内容 div 和滚动条内创建一个空白区域。

jQuery代码

```
$('.chzn-select').chosen();
    <?php if(!empty($data_which_depends_the _chosen)){ ?>
     $.ajax({
        url: '<?php echo(site_url("/url_to_get_the_data/")); ?>',
        dataType: 'json',
        type: 'POST',
        data: {
            l: <?php echo($data_which_depends_the _chosen); ?>,
            <?php echo $this->security->get_csrf_token_name()?>: '<?php echo $this->security->get_csrf_hash()?>'
        },
        success: setChosenOptions
    });
    <?php } ?> 
```

...

```
var setChosenOptions = function(data)
{
    $("select[name='numChosen[]']").children().remove();
    if(data !== null)
    {
        $.each(data.data, function(i,item){
            <?php if(!$readOnly){ ?>
            $("select[name='numChosen[]']").append('<option value="' + item.ids + '">' + item.number + '</option>');
            <?php }else{ ?>
            $("select[name='numChosen[]']").append('<option disabled="disabled" value="' + item.ids + '">' + item.number + '</option>');
            <?php } ?>
        });
        $.ajax({
            url: '<?php echo(site_url("/url_to_get_other_data/")); ?>',
            dataType: 'json',
            type: 'POST',
            data: {
                l: '<?php echo($data_which_depends_the _chosen); ?>',
                <?php echo $this->security->get_csrf_token_name()?>: '<?php echo $this->security->get_csrf_hash()?>'
            },
            success: function(data){
                if(data !== null)
                {
                    $.each(data.data, function(i,item){
                        if($("select[name='numChosen[]']").find("option[value=" + item.ids + "]").length)
                            $("select[name='numChosen[]']").find("option[value=" + item.ids + "]").attr('selected','selected');
                        else
                            $("select[name='numChosen[]']").append('<option selected="selected" disabled="disabled" value="' + item.ids + '">' + item.number + '</option>');
                    });
                }
                $("select[name='numChosen[]']").trigger("liszt:updated");
            }
        });                 
    }
} 
```

调用时会出现所有问题`$("select[name='numChosen[]']").trigger("liszt:updated");`，这就是它的外观：

![在此处输入图像描述](../Images/f15177e5e4c9b472063c9bdf25559c65.png)

问题是：任何想法如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:52:18.010

简单地添加`style="overflow: visible;"`到`<div class="tab-content" style="overflow: visible;">`并解决了问题：D

# visual-studio-2010 - 更新 VSTO Excel 2010 加载项安装

> ID：12900094
> 
> 赞同：1
> 
> 时间：2012-10-15T16:38:57.790
> 
> 标签：visual-studio-2010, vsto, windows-installer

我目前正在开发一个 Excel 2010 加载项，并且我已经成功地为其创建了一个 Windows Installer 项目，该项目可以在任何机器上成功安装该加载项。但是，我面临一个问题：为了安装新版本的插件，我必须先卸载以前的插件......在 Windows Installer 项目中，我将 RemovePreviousVersions 属性设置为 True，但这并没有没有任何帮助...为了创建 MSI，我使用了本指南，其中没有提及任何有关更新的内容... [http://msdn.microsoft.com/en-us/library/ff937654.aspx](http://msdn.microsoft.com/en-us/library/ff937654.aspx)

任何想法和建议将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T06:17:35.287

您可能会收到“已安装此产品的另一个版本”的消息？

通常，如果您创建了一个包，安装了它，修改了它的内容，然后您尝试再次安装它而不卸载原始包，则会显示此消息。基本上，Windows Installer 只有在修改后的软件包具有更高版本和不同的产品代码时才能升级原始软件包。如果您不想创建新版本的软件包，则需要在安装修改后的之前卸载原始 MSI。

一个简单的方法是创建一个小批处理文件，在该文件中使用 /x 选项调用 msiexec 以删除旧版本，而不是使用 /i 选项调用它来安装新版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:15:10.573

每个 MSI 软件包都有 UpgradeCode。借助它，您可以管理升级。在您的情况下，如果您有以前的 MSI，则需要将此代码添加到新 MSI 的 UpgradeTable 中。有关[MSDN的更多信息](http://msdn.microsoft.com/en-us/library/windows/desktop/aa372379%28v=vs.85%29.aspx)

# php - 添加到二维数组或循环二维数组时出错

> ID：12900097
> 
> 赞同：0
> 
> 时间：2012-10-15T16:39:15.900
> 
> 标签：php, arrays, foreach

我在这段代码中有一个问题：

```
while ($end <= $to){
        $currentDates = array("from" => $start, "to"=>$end);
        $allDates[] = $currentDates;
        echo 'from: ', $currentDates["from"]->format("m-d-y"),'<br>';
        unset($currentDates);
        $start->add($intervalObj);
        $end->add($intervalObj);
    }

var_dump($allDates); 
```

循环中的 echo 显示正确的值，但 vardump 显示要在数组的所有位置添加到数组的最后日期

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:01:57.093

我不认为你需要2个循环......

错误来自您的循环

```
while ($end <= $to){
                ^-------  This was never used 
```

另见

```
$currentDates = array("from" => $start, "to"=>$end);
         Not in the Condition  --^              ^---- To means something else 
```

你虽然可以很简单

```
$start = new DateTime("2012-4-12");
$end = new DateTime("2012-12-12");
$dv = new DateInterval('P24D'); // Every 24 days

echo "<pre>";
while ( $start <= $end ) {
    echo "From ", $start->format('Y-m-d');
    $start->add($dv);
    echo " To ", $start->format('Y-m-d'), PHP_EOL;
} 
```

输出

```
From 2012-04-12 To 2012-05-06
From 2012-05-06 To 2012-05-30
From 2012-05-30 To 2012-06-23
From 2012-06-23 To 2012-07-17
From 2012-07-17 To 2012-08-10
From 2012-08-10 To 2012-09-03
From 2012-09-03 To 2012-09-27
From 2012-09-27 To 2012-10-21
From 2012-10-21 To 2012-11-14
From 2012-11-14 To 2012-12-08
From 2012-12-08 To 2013-01-01 
```

# apache - Centos 上的 munin

> ID：12900101
> 
> 赞同：3
> 
> 时间：2012-10-15T16:39:25.713
> 
> 标签：apache, centos, munin

我已经在 Centos 6.2 上安装了 Munin，并成功配置并启动了它。唯一的问题是在 var/www/html/munin 文件夹中，我只有：

```
/static
/cgi 
```

没有 index.html 或其他任何内容，因此 Munin 无法正常运行... /static 中有一些附件文件

我的 munin 节点**配置**是：

```
#
# Example config-file for munin-node
#

log_level 4
log_file /var/log/munin/munin-node.log
pid_file /var/run/munin/munin-node.pid

background 1
setsid 1

user root
group root

# Regexps for files to ignore
ignore_file [\#~]$
ignore_file DEADJOE$
ignore_file \.bak$
ignore_file %$
ignore_file \.dpkg-(tmp|new|old|dist)$
ignore_file \.rpm(save|new)$
ignore_file \.pod$

# Set this if the client doesn't report the correct hostname when
# telnetting to localhost, port 4949
#
host_name my.host.is

# A list of addresses that are allowed to connect.  This must be a
# regular expression, since Net::Server does not understand CIDR-style
# network notation unless the perl module Net::CIDR is installed.  You
# may repeat the allow line as many times as you'd like

allow ^127\.0\.0\.1$
allow 192.168.15.173
allow my.host.is

# If you have installed the Net::CIDR perl module, you can use one or more
# cidr_allow and cidr_deny address/mask patterns.  A connecting client must
# match any cidr_allow, and not match any cidr_deny.  Note that a netmask
# *must* be provided, even if it's /32
#
# Example:
#
# cidr_allow 127.0.0.1/32
# cidr_allow 192.0.2.0/24
# cidr_deny  192.0.2.42/32

# Which address to bind to;
host *
#host 127.0.0.1

# And which port
port 4949 
```

**/var/www/html/munin 文件夹上的**所有者和组是 munin****

 **访问 /munin url 时，apache 抛出以下错误：

```
Directory index forbidden by Options directive: /var/www/html/munin/ 
```

关于发生了什么以及如何解决它的任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T21:43:41.487

这是预期的行为，直到/除非您执行以下操作之一：

*   启用 cgi 内容生成（版本 2.x 的默认设置）
*   确保 munin-cron 正在调用 munin-html 来生成内容（1.4.x 版本的默认设置）

您在 munin.conf 中将“graph_strategy”设置为什么？**

# c++ - 与对象无关的方法

> ID：12900102
> 
> 赞同：5
> 
> 时间：2012-10-15T16:39:28.553
> 
> 标签：c++

我有一个关于 OOP 的基本问题。我想在类中创建一个方法，该方法使用该类的 2 个对象作为参数，并根据这些对象的属性返回一个浮点值。

```
public float MyMethod(CMyClass obj1, CMyclass obj2) 
```

当我想在 main() 中使用此方法时，我不能这样做：

```
CMyClass o1 = CMyClass();
CMyClass o2 = CMyClass();
float x = MyMethod(o1, o2); 
```

我看不到这个方法，因为它与一个对象有关。我可以这样访问它：

```
o1.MyMethod(...) 
```

但这没有意义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T16:40:24.250

您可以声明该方法`static`，并像访问它一样`MyClass::MyMethod`

```
class MyClass {
public:
    static void MyMethod(const MyClass & arg1, const MyClass & arg2) {}
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T16:41:54.980

由于您想访问这些属性，请使用朋友功能（非成员）。你可以在你的类中声明它：

```
friend float MyMethod(CMyClass obj1, CMyclass obj2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T16:40:38.087

你要

```
static float MyMethod(CMyClass obj1, CMyclass obj2) 
```

`static`这里的关键字将使方法属于类，而不是类/对象的单个实例。访问为`CMyClass::MyMethod`.

# jquery - jQuery触发点击元素循环

> ID：12900103
> 
> 赞同：3
> 
> 时间：2012-10-15T16:39:30.923
> 
> 标签：jquery, loops, triggers, click, cycle

我在页面中有元素：

```
<a class="element" onclick="do this"></a>
<a class="element" onclick="do this"></a>
<a class="element" onclick="do this"></a>
<a class="element" onclick="do this"></a> 
```

我需要触发每个点击并在触发的点击之间延迟一些时间。

```
//for each one .element
$('.element').delay(800).trigger('click'); 
```

然后我需要将这个循环重复为无限循环，但我需要`stop it when user click on a .element`

我尝试了很多东西，比如 $.each(loop trigger); 但我不明白如何循环到无限并在我悲伤时停止它:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T16:54:50.253

可能存在更优雅的解决方案，但这是我的两分钱：

```
​$(function(){
    $("a").on("click", function(e, d){
        $(this).addClass("active").siblings().removeClass("active");
        if(d !== true) {
            clearInterval(timer);
        }
    });

    $("a:first").addClass("active");
    var timer = setInterval(doClick, 800);

    function doClick() {
        var $n = $(".active").next();
        if ($n.length == 0) {
            $n = $(".active").siblings().first();
        }
        console.log($n.length);
        $n.trigger("click", [true]);
    }
});
​ 
```

[jsFiddle](http://jsfiddle.net/HvpMM/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T16:57:28.250

我的解决方案：

```
$(function(){
    var links = $('.element');

    var timer = setInterval(function(){
        links.each(function(index, value){
            var link = $(this);
            setTimeout(function(){
                link.trigger('click', "trigger");
            }, 100 + index * 50);
        });
    }, 800);

    links.click(function(e, isTrigger){
        e.preventDefault();
        if(!isTrigger)
        {
            clearInterval(timer);
        }
    });
}); 
```

演示：http: [//jsfiddle.net/c2G6q/1/](http://jsfiddle.net/c2G6q/1/)

# jquery - Jquery上下滑动

> ID：12900104
> 
> 赞同：0
> 
> 时间：2012-10-15T16:39:32.337
> 
> 标签：jquery, slidetoggle, jquery-effects

我想知道是否有办法更好地压缩此代码，这样我就不必编写所有可能的场景。任何帮助表示赞赏。

```
 $('select.contactselect').change(function(){
   var selectVal = $(this).val();
   if(selectVal == 'press'){
    $('.support').slideUp('fast');
    $('.general').slideUp('fast');
    $('.press').delay(100).slideDown('fast', function() {
        // Animation complete.
    });
  }else if (selectVal == 'general'){
    $('.press').slideUp('fast');
    $('.support').slideUp('fast');
    $('.general').delay(100).slideDown('fast', function() {
      // Animation complete.
    });
  }else if (selectVal == 'support'){
    $('.press').slideUp('fast');
    $('.general').slideUp('fast');
    $('.support').delay(100).slideDown('fast', function() {
      // Animation complete.
    });
  }
  }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T16:44:49.053

将类“all_lists”添加到具有类（新闻、通用和支持）的所有这三个元素，然后使用以下。

```
$('select.contactselect').change(function(){
  var selectVal = $(this).val();

  $('.all_lists').slideUp('fast');
  $('.' + selectVal).delay(100).slideDown('fast', function() {
// Animation complete.
});

}); 
```

# c# - Facebox Jquery 框的关闭按钮关闭母版页，而不是弹出窗口

> ID：12900105
> 
> 赞同：0
> 
> 时间：2012-10-15T16:39:35.333
> 
> 标签：c#, javascript, jquery, asp.net

我正在使用 Facebox jquery 框来加载一个带有提交按钮和取消按钮的小表单。

当我单击提交时，它会关闭加载 Facebox 窗口而不是 Facebox 窗口的主页！它使 AddNote.aspx 站点保持打开状态（由 Facebox 加载）并关闭我的 Main.aspx。

这是我在 AddNote.aspx 中的代码（由 Main.aspx 上的 Facebox 弹出窗口呈现）：

```
 protected void SubmitButtom_Click(object sender, EventArgs e)
    {

        string note = NotesTextBox.Text;

        //will need to add current user

        using (cmd = new SqlCommand("INSERT INTO notes (FID, note_date, note_text) VALUES (@FID, @note_date, @note_text)", con))
        {
            con.Open();
            cmd.Parameters.Add(new SqlParameter("FID", FID));
            cmd.Parameters.Add(new SqlParameter("note_date", DateTime.Now.ToString()));
            cmd.Parameters.Add(new SqlParameter("note_text", note));
            cmd.ExecuteNonQuery();
            con.Close();
            Page.ClientScript.RegisterOnSubmitStatement(typeof(Page), "closeModal", "$.facebox.close();");              //WHY DOES THIS CLOSE MAIN.ASPX INSTEAD OF FACEBOX WINDOW?                  
        }           

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:01:20.147

欢迎使用 ASP.NET

您正在使用服务器端代码来处理此表单。这意味着您必须执行 ASP.NET 所称的“回发”。这意味着`form`页面上的 正在将数据提交回自身进行处理。由于“提交”按钮是触发它的按钮，因此您的处理程序会被调用。

这里重要的是，这需要访问服务器。表单正在提交，在普通 HTTP 中（因此在 ASP.NET 中，因为它是为 HTTP 处理构建的框架），意味着页面刷新。浏览器说“哦！正在提交表单！是时候向服务器发出请求，并等待响应。我现在可能可以卸载我拥有的页面了。” 确实如此。

为了做你想做的事，请查看“AJAX”或异步 XMLHttpRequest。它们是一样的，除了一个更流行。

# .net - DbProviderFactories.GetFactory(providerClass) 看不到刚刚安装的提供程序

> ID：12900107
> 
> 赞同：0
> 
> 时间：2012-10-15T16:39:41.300
> 
> 标签：.net, dbproviderfactories

如果我在我的应用程序运行时安装提供程序。然后调用 DbProviderFactories.GetFactory(providerClass) 查看它是否已安装，我得到一个异常调用它。但是如果我退出我的应用程序并重新启动它，它就会看到它。

我必须调用什么来让 DbProviderFactories.GetFactory(providerClass) 重新读取 machine.config？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T16:39:41.300

首次使用时在静态数据表中读取提供程序信息，然后始终返回该值，直到应用程序重新启动并且该数据表当然会再次重新创建。

以下代码（首次发布于[Windward Wrocks](http://blogs.windward.net/davidt/2012/10/15/flush-the-dbproviderfactories-getfactoryclasses-cache/)）将刷新该内部缓存并强制重新读取：

```
/// <summary>
/// Force DbProviderFactories to re-read machine.config on the next call to
/// DbProviderFactories.GetFactoryClasses().
/// </summary>
static public void FlushDbProviderFactoriesCache()
{
  try
    {
    FieldInfo initStateFieldInfo = typeof(DbProviderFactories).GetField("_initState",
                                  BindingFlags.Static | BindingFlags.NonPublic);
    if (initStateFieldInfo != null)
      {
        ConnectionState state = ConnectionState.Closed;
        object initState = initStateFieldInfo.GetValue(state);
        if (initState is ConnectionState)
        {
          state = (ConnectionState)initState;
          if (state != ConnectionState.Closed)
            initStateFieldInfo.SetValue(state, ConnectionState.Closed);
          ConfigurationManager.RefreshSection("system.data");
        }
      }
    }
  catch (Exception)
    {
    // nada
    }
  } 
```

# java - 如何在eclipse中将wsdl部署到tomcat

> ID：12900112
> 
> 赞同：0
> 
> 时间：2012-10-15T16:40:00.083
> 
> 标签：java, eclipse, web-services, wsdl, tomcat7

> **可能重复：**
> [无法发布使用 eclipse 在 java 中创建的 Web 服务](https://stackoverflow.com/questions/11739868/unable-to-publish-web-service-which-is-created-in-java-using-eclipse)

我已经为此绞尽脑汁一个多星期了。我需要在 Eclipse 中将 wsdl 部署到我的 tomcat7 服务器。我知道这取决于地铁运行时，我不需要做任何花哨的事情。我只想用浏览器点击它并查看一些漂亮的 XML。我对网络服务开发相当陌生，所以如果这个问题是二年级的或者已经在其他地方得到了回答，我很抱歉，但是在尝试了我的前 10 页谷歌搜索结果中的每一个解决方案并且一无所获之后，我想我什至可能对这个话题还不够了解问正确的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:33:07.347

将您的 WebService 项目导出为 WAR 文件并将其部署在 Tomcat 中。

# ruby-on-rails - 是否可以在 Ruby 1.9 中透明地实现 ActiveRecord 查询的 Future 模式？

> ID：12900121
> 
> 赞同：4
> 
> 时间：2012-10-15T16:40:15.073
> 
> 标签：ruby-on-rails, performance, activerecord, asynchronous, future

我正在一个现有的 Rails 2 站点上工作，该站点具有最近更新到 Ruby 1.9.2 和 mysql2 gem 的大型代码库。我注意到这个设置允许非阻塞的数据库查询；你可以做`client.query(sql, :async => true)`，然后再调用`client.async_result`，它会阻塞直到查询完成。

在我看来，我们可以通过让所有`ActiveRecord`返回集合的查询拒绝阻塞，直到在集合上调用方法来提高性能。例如

```
@widgets = Widget.find(:all, :conditions=> conditions) #sends the query
do_some_stuff_that_doesn't_require_widgets
@widgets.each do #if the query hasn't completed yet, wait until it does, then populate @widgets with the result. Iterate through @widgets
... 
```

这可以通过猴子补丁`Base::find`及其相关方法来创建一个新的数据库客户端，异步发送查询，然后立即返回一个 Delegator 或其他代理对象，当任何方法被调用时，调用`client.async_result`，实例化结果使用`ActiveRecord`, 并将方法委托给它。 `ActiveRecord`关联代理对象已经以类似的方式实现 ORM。

但是，我找不到任何这样做的人，而且在任何版本的 Rails 中似乎都不是一个选项。我已经尝试自己实现它并且它在控制台中工作（只要我附加`; 1`到调用所有内容的行，这样`to_s`就不会在结果中调用它）。但它似乎与其他各种魔法发生碰撞并产生各种问题。

那么，出于某种我没有想到的原因，这是一个坏主意吗？如果没有，为什么它不是`ActiveRecord`已经工作的方式？有没有一种干净的方法来实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T12:42:09.970

我怀疑 .async_result 方法不适用于所有数据库驱动程序；如果没有，它就不能合并到通用的 ActiveRecord 调用中。

在循环大型记录集时提高性能的一种更便携的方法是使用 find_each 或 find_in_batches。我认为它们可以在 rails 2.3 和 rails 3.x 中工作。[http://guides.rubyonrails.org/active_record_querying.html#retrieving-multiple-objects-in-batches](http://guides.rubyonrails.org/active_record_querying.html#retrieving-multiple-objects-in-batches)

# c - char* 数组初始化

> ID：12900127
> 
> 赞同：-1
> 
> 时间：2012-10-15T16:40:31.563
> 
> 标签：c, char, segmentation-fault

我有这个数组：

```
char *tags[100]; 
```

如果我这样做：

```
tags[0]="something"; 
```

它有效（至少没有错误）。但是，for 循环中的相同代码却没有。

```
int j=0;       
for(j; j<100; ++j)
{
    tags[j]="something";
} 
```

它说“分段错误”。这是什么？

更新：整个代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void append(char* s, char c)
{
        int len = strlen(s);
        s[len] = c;
        s[len+1] = '\0';
}

int main()
{
   int istag;
   FILE *fopen(), *fp;
   int i;
   fp = fopen("oldal.html","r");
   i= getc(fp) ;
   char* szo;

   int index=0;
   char *tags[100]; 

int j=0;       
for(j; j<100; ++j)
{
    tags[j]="something";
}

   while (i!= EOF)
   {            

        i = getc(fp);
        char c=i;

        if(c=='<')
        {
            istag=1;
        }
        if(c=='>')
        {
            istag=0;
            index++;
            //printf("tag vege: %s %d",tags[index],index);

        }

        if(istag)
        {

            //append(tags[index],'a');
        }

        append(szo,c);

   }

   //printf("%s",szo);
   fclose(fp);

   return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T16:57:19.377

您的代码调用您的 append() 函数将数据附加到`szo`，但`szo`从未初始化并包含恰好在声明它的堆栈上的任何值。

谁知道它写到哪里。这几乎肯定是问题的原因。

`szo`通过将其指向足够大小的字符缓冲区来进行初始化。请记住使其大到足以容纳附加的数据和终止符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T16:58:56.003

分段错误很可能来自 line `append(szo,c);`，因为`szo`此时是一个未初始化的指针，您将它传递给一个函数，该函数试图使用该指针派生一个要写入的内存位置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-15T16:51:42.160

这意味着您的代码中的其他地方存在错误。您发布的代码中没有错误，讨论结束。

更新： *叹息*

```
 s[len+1] = '\0'; 
```

是错的。

请在调试器中运行您的代码，以查看将来产生错误的行 - 因为它甚至不是您发布的代码中的一行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T16:57:27.253

它应该是 s[len] = '\0' 而不是 s[len+1] = '\0';。也正如其他用户所说， szo 从未初始化。它指向一个随机位置，该位置可能/可能不是可访问位置。导致分段违规

# android - 方向更改时未找到 id 的视图 IllegalArgumentException:?

> ID：12900129
> 
> 赞同：3
> 
> 时间：2012-10-15T16:40:41.703
> 
> 标签：android, android-layout, android-fragments, android-viewpager, illegalargumentexception

我正在创建一个应用程序。我有两种看法。

拇指视图和网格视图。对于这些视图，我为 ViewPager 使用了两个不同的 FragmentStatePagerAdapter。在主布局中，我创建了一个空间来重用该子视图以根据选择加载 ThumbView 或 GridView。

```
public void loadThumbView()
{
     LinearLayout subLayout= (LinearLayout)findViewById(R.id.subLayout);
           subLayout.removeAllViews();
           View subView =(View)inflater.inflate(R.layout.thumb_layout, null);
           thumbViewPager=(ViewPager)subView.findViewById(R.id.pager);
           thumbViewPagerAdapter=new ViewPagerAdapter(getSupportFragmentManager());
           thumbViewPager.setAdapter(thumbViewPagerAdapter);
           subLayout.addView(subView);
}

public void loadGridView()
{
LinearLayout subLayout= (LinearLayout)findViewById(R.id.subLayout);
        subLayout.removeAllViews();     
        View subView=(View)inflater.inflate(R.layout.grid_layout, null);
        test= new TestAdapter(getSupportFragmentManager(),this);
        viewPager =(ViewPager)subView.findViewById(R.id.pager);        
        viewPager.setAdapter(test);        
        pageIndicator = (CirclePageIndicator)subView.findViewById(R.id.indicator);        
        pageIndicator.setViewPager(viewPager,0);        
        pageIndicator.setSnap(false);
        subLayout.addView(subView);
} 
```

这就是我在 MainLayout.xml 的子布局中加载视图的方法

但是，当我更改方向时，应用程序会崩溃，因为在上述代码的第 2 行，我正在删除所有视图。当我旋转我的应用程序时，我的应用程序因以下错误而崩溃。

```
10-15 19:50:43.146: E/AndroidRuntime(8546): FATAL EXCEPTION: main
10-15 19:50:43.146: E/AndroidRuntime(8546): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.taruni.testsample/com.taruni.activities.MainActivity}: java.lang.IllegalArgumentException: No view found for id 0x7f04000a for fragment SubFragment{41579be0 #0 id=0x7f04000a}
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:3512)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.app.ActivityThread.access$700(ActivityThread.java:130)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1201)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.os.Handler.dispatchMessage(Handler.java:99)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.os.Looper.loop(Looper.java:137)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.app.ActivityThread.main(ActivityThread.java:4745)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at java.lang.reflect.Method.invokeNative(Native Method)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at java.lang.reflect.Method.invoke(Method.java:511)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at dalvik.system.NativeStart.main(Native Method)
10-15 19:50:43.146: E/AndroidRuntime(8546): Caused by: java.lang.IllegalArgumentException: No view found for id 0x7f04000a for fragment SubFragment{41579be0 #0 id=0x7f04000a}
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:864)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1080)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1062)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.support.v4.app.FragmentManagerImpl.dispatchActivityCreated(FragmentManager.java:1810)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.support.v4.app.FragmentActivity.onStart(FragmentActivity.java:501)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at com.taruni.activities.MainActivity.onStart(MainActivity.java:374)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1163)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.app.Activity.performStart(Activity.java:5018)
10-15 19:50:43.146: E/AndroidRuntime(8546):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2032)
10-15 19:50:43.146: E/AndroidRuntime(8546):     ... 12 more 
```

SubFragment 是扩展 Fragment 的类的名称。如何处理？如何强行销毁/分离碎片？如何完全删除 ViewPager 及其所有相关的片段以进行某些操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:51:48.297

您可以覆盖`onConfigurationChanged(...)`以处理方向更改。

将此行添加到您`<activity >`的 mainfest 中：

```
android:configChanges="orientation" 
```

添加此方法以在更改方向时执行您想要的操作

```
@Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);

    // Checks the orientation of the screen
    if (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE) {
        Toast.makeText(this, "landscape", Toast.LENGTH_SHORT).show();
    } else if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT){
        Toast.makeText(this, "portrait", Toast.LENGTH_SHORT).show();
    }
} 
```

*   更多信息在这里[http://developer.android.com/guide/topics/resources/runtime-changes.html](http://developer.android.com/guide/topics/resources/runtime-changes.html)

# java - 用于性能的 GWT 设计器和单元小部件

> ID：12900134
> 
> 赞同：1
> 
> 时间：2012-10-15T16:40:51.500
> 
> 标签：java, gwt, gwt-designer

在观看[了有关 GWT 性能的 Google I/O 视频后，](http://www.youtube.com/watch?v=0F5zc1UAt2Y)很明显 GWT 团队希望开发人员采用所谓的“Cell Widgets”，而不是普通（笨重、慢）的小部件。

我是 GWT 的新手，正在使用 GWT Designer 来帮助我更好地适应环境并学习 API。在 GWT Designer 面板中，有一个单元格小部件部分，但是可供选择的选项受到很大限制。例如，如果我想以 HTML 密码字段结束，我唯一`PasswordTextBox`的选择是来自普通（非单元格）小部件窗格。没有 Cell 等效项，例如`CellPasswordTextBox`.

这是因为 GWT Designer 的一些缺点吗？您可能会认为，如果 Google 正在推广这个 Cell Widget“库”，他们就会为每种小部件类型提供 Cell 等效项。不是这样吗？开发人员*是否必须*在某些时候处理非 Cell 小部件？只是感到困惑，因为我似乎在这里遗漏了一些明显的东西。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:53:48.347

单元格小部件的整个概念是自己制作。与 Designer 没有很好的集成 - 尽管我认为有一些 - 但是当您达到使您能够编写自定义 Cell 小部件的级别时，您无论如何都不需要它。

[在这里](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiCustomCells)查看更多详细信息。

可以在[此处找到带有相应代码的展示柜](http://gwt.google.com/samples/Showcase/Showcase.html#!CwCheckBox)

# c# - CIL 中的十六进制值

> ID：12900136
> 
> 赞同：0
> 
> 时间：2012-10-15T16:40:58.020
> 
> 标签：c#, .net, cil

这是一个 C# 代码：

```
Console.WriteLine(-1);
Console.WriteLine(-4);
Console.WriteLine(5);
Console.WriteLine(12);
Console.WriteLine("string number 1");
Console.WriteLine(555);
Console.WriteLine(-555);
Console.WriteLine(555.55);
Console.WriteLine(-555.55); 
```

这是IL代码的一部分

```
ldc.i4.m1, -1
ldc.i4.s, -4
ldc.i4.5
ldc.i4.s, 12
ldstr, "string number 1"
ldc.i4, 0x22b
ldc.i4, 0xfffffdd5
ldc.r8, 555.54999999999995
ldc.r8, -555.54999999999995 
```

我想知道为什么`555`表示为`0x22b`and - `555`as `0xfffffdd5`？

# .net - 向 WebGrid 呈现的表格添加自定义属性

> ID：12900138
> 
> 赞同：1
> 
> 时间：2012-10-15T16:41:15.930
> 
> 标签：.net, asp.net-mvc-3, webgrid

我正在使用 MVC3 WebGrid，并希望将表单“data-xxx”的自定义属性添加到`<table>`由`WebGrid.GetHtml()`.

我试图这样做如下：

```
grid.GetHtml(...
    htmlAttributes: new { data_xxx = "value" }
); 
```

然而，这呈现为：

```
<table ... data_xxx="value"> 
```

而不是预期的：

```
<table ... data-xxx="value"> 
```

即，与其他 MVC 助手不同，它不会用连字符替换属性名称中的下划线。

在对 Reflector 进行了一番探索之后，似乎：

1.  `WebGrid.GetHtml()`调用`System.Web.WebPages.Html.ObjectToDictionary`将匿名属性对象转换为字典。与`System.Web.Mvc.HtmlHelper.AnonymousObjectToHtmlAttributes`其他助手使用的方法不同，这不会将“_”替换为“-”。

2.  与大多数其他 MVC 帮助程序不同，`WebGrid.GetHtml()`它没有采用 的重载`IDictionary<string, object>`，因此我无法通过以这种方式指定属性来解决该错误。

这对我来说似乎是一个错误，我已将其提交给 Connect：

[http://connect.microsoft.com/VisualStudio/feedback/details/767456/webgrid-gethtml-helper-does-not-allow-data-attributes-to-be-set](http://connect.microsoft.com/VisualStudio/feedback/details/767456/webgrid-gethtml-helper-does-not-allow-data-attributes-to-be-set)

任何解决方法的建议？还是在 MVC4 中修复？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:40:31.370

感谢您报告此问题：

昨天在 CodePlex 中通过解决问题 610 和 575 解决了这个问题。

[https://aspnetwebstack.codeplex.com/workitem/610](https://aspnetwebstack.codeplex.com/workitem/610)

[https://aspnetwebstack.codeplex.com/workitem/575](https://aspnetwebstack.codeplex.com/workitem/575)

你可以试试[夜间位](https://aspnetwebstack.codeplex.com/wikipage?title=Use%20Nightly%20Builds)。

# java - StreamCorruptedException 只有三个盒子中的两个？

> ID：12900142
> 
> 赞同：2
> 
> 时间：2012-10-15T16:41:32.737
> 
> 标签：java, javascript, servlets, stream, ehcache

我完全不知道为什么会发生这种情况。我有一个 javascript 文件部署到三个测试框。在其中两个上，当我点击页面时出现以下错误（如下）。如您所见，它说流标头是一串零，并且它正在读取的文件中没有零。我认为这意味着它正在尝试读取数据但没有任何内容通过（因此所有未设置的位......）但它在一个盒子上工作但在其他两个盒子上工作的事实令人困惑，因为它们都部署了相同的代码给他们。

我已经通过 Java 服务查看了任何未关闭或未正确读取的流，但该服务甚至没有打开它们。正如您在堆栈跟踪中看到的那样，它利用`Ehcache`执行这些操作（并且正确实现）的方式。

关于这在世界上做什么的正确方向的任何指示？

```
exception

org.apache.jasper.JasperException: An exception occurred processing JSP page/CacheHistory.jsp at line 6

3: <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
4: 
5: <%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
6: <jsp:useBean id="cacheHistory" class="org.jpg.CacheHistory" />
7: <html> 
8: <head>
9:  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">

Stacktrace:
    org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:519)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:428)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)

root cause

net.sf.ehcache.CacheException: java.io.StreamCorruptedException: invalid stream header: 00000000
    net.sf.ehcache.store.disk.DiskStorageFactory.retrieve(DiskStorageFactory.java:964)
    net.sf.ehcache.store.disk.Segment.decodeHit(Segment.java:178)
    net.sf.ehcache.store.disk.Segment.get(Segment.java:216)
    net.sf.ehcache.store.disk.DiskStore.get(DiskStore.java:504)
    net.sf.ehcache.store.disk.DiskStore.getQuiet(DiskStore.java:511)
    net.sf.ehcache.store.FrontEndCacheTier.getQuiet(FrontEndCacheTier.java:196)
    net.sf.ehcache.Cache.searchInStoreWithoutStats(Cache.java:2101)
    net.sf.ehcache.Cache.get(Cache.java:1630)
    net.sf.ehcache.Cache.get(Cache.java:1597)

root cause

java.io.StreamCorruptedException: invalid stream header: 00000000
    java.io.ObjectInputStream.readStreamHeader(Unknown Source)
    java.io.ObjectInputStream.<init>(Unknown Source)
    net.sf.ehcache.util.PreferTCCLObjectInputStream.<init>(PreferTCCLObjectInputStream.java:39)
    net.sf.ehcache.store.disk.DiskStorageFactory.read(DiskStorageFactory.java:375)
    net.sf.ehcache.store.disk.DiskStorageFactory.retrieve(DiskStorageFactory.java:960)
    net.sf.ehcache.store.disk.Segment.decodeHit(Segment.java:178)
    net.sf.ehcache.store.disk.Segment.get(Segment.java:216)
    net.sf.ehcache.store.disk.DiskStore.get(DiskStore.java:504)
    net.sf.ehcache.store.disk.DiskStore.getQuiet(DiskStore.java:511)
    net.sf.ehcache.store.FrontEndCacheTier.getQuiet(FrontEndCacheTier.java:196)
    net.sf.ehcache.Cache.searchInStoreWithoutStats(Cache.java:2101)
    net.sf.ehcache.Cache.get(Cache.java:1630)
    net.sf.ehcache.Cache.get(Cache.java:1597) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:46:40.943

正在读取的文件在失败的平台上已损坏。

# android - 添加活动大小调整功能

> ID：12900146
> 
> 赞同：0
> 
> 时间：2012-10-15T16:41:42.717
> 
> 标签：android

我有一个活动，我想根据用户事件调整大小。我在`getWindow.setLayout()`里面试过，`onTouchListener`但调整大小一点也不顺畅。请提供一些建议。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-15T16:56:20.733

请使用绝对布局。我想，这会有所帮助

# matlab - matlab中的错误，同时在GUI中使用set

> ID：12900149
> 
> 赞同：0
> 
> 时间：2012-10-15T16:41:50.287
> 
> 标签：matlab, user-interface

我在 Matlab 中尝试了以下代码：

```
function pushbutton5_Callback(hObject, eventdata, handles)

global smoothening_level;

global Amp_threshold;

global Min_PeakDistance;

global Mat_wave

global Mat_wave2

global Mat_inten

global pks

Mat_inten2 = smooth(Mat_inten,smoothening_level);

[pks,locs] = findpeaks(Mat_inten2,'minpeakdistance',Min_PeakDistance,'minpeakheight',Amp_threshold)

s = size(pks)

figure(1)

Mat_wave2 = Mat_wave(locs(:));

Mat_inten2loc = Mat_inten(locs(:));

hold all;

plot(Mat_wave,Mat_inten2);

plot(Mat_wave2,pks,'o','MarkerEdgeColor','r');

legend('Ouptut Spectrum','Smoothened Spectrum','Identified Peaks')

axis([350 900 0 max(Mat_inten)]);

xlabel('Wavelength')

ylabel('Intensity')

grid on

title('Plasma Emission Spectrum')

temp(:,1)=Mat_wave2;

temp(:,2)=Mat_inten2loc;

set(handles.uitable8,'Data',num2cell(temp)) 
```

但是它给出了以下错误：

```
??? Attempt to reference field of non-structure array.

Error in ==> GUI>pushbutton5_Callback at 242
set(handles.uitable8,'Data',num2cell(temp))

Error in ==> gui_mainfcn at 96
        feval(varargin{:});

Error in ==> GUI at 50
    gui_mainfcn(gui_State, varargin{:});

Error in ==> @(hObject,eventdata)GUI('pushbutton5_Callback',hObject,eventdata,guidata(hObject))

??? Error while evaluating uicontrol Callback 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T08:35:46.150

该错误告诉您这`handles`不是 type `struct`。因此，您无法访问`handles.uitables8`. 最有可能你想写的是 `set(handles,'Data',num2cell(temp))'`，但这只是一个猜测，不知道你的代码的其余部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T16:48:37.240

检查以确保 handles.uitable8 存在。最简单的方法是在代码的第 242 行设置断点。当代码在调试器中停止时，转到工作区并打开句柄结构。

如果您使用 GUIDE 创建了这个 gui，那么很可能标签被贴错标签或类似的东西。

# symfony - Symfony2 composer.phar

> ID：12900151
> 
> 赞同：1
> 
> 时间：2012-10-15T16:41:55.007
> 
> 标签：symfony, composer-php, ioncube

我想按照[http://symfony.com/doc/current/book/installation.html](http://symfony.com/doc/current/book/installation.html)的说明安装属于 Symfony2 的 Composer 。当我运行第一个命令 ( `curl -s https://getcomposer.org/installer | php`) 时，出现错误：

> 您的 ionCube Loader 扩展 (4.0) 与 Phar 文件不兼容。升级到 ionCube 4.0.9 或更高版本或从您的删除此行（路径可能不同）`php.ini`以禁用它：zend_extension = /usr/lib/php5/20090626+lfs/ioncube_loader_lin_5.3.so

但我的 php.ini 说：

> Zend Engine v2.3.0，版权所有 (c) 1998-2012 Zend Technologies with the ionCube PHP Loader v4.0.10，版权所有 (c) 2002-2011，ionCube Ltd.

问题是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T09:26:27.150

安装程序脚本用于`version_compare(ioncube_loader_version(), '4.0.9', '<')`确定您拥有的 ioncube 版本。它似乎在您的设置上报告 4.0，这是错误的。你能在你的机器上检查一下这个输出吗？

```
php -r "var_dump(ioncube_loader_version());" 
```

作为暂时强制安装 Composer 的解决方法，您可以使用以下命令：

```
curl -s https://getcomposer.org/installer | php -- --force 
```

也就是说，请给我反馈，以便我们修复检测脚本并避免 ionCube 用户将来出现问题。

# php - Swiftmailer BCCing 500 个用户

> ID：12900155
> 
> 赞同：0
> 
> 时间：2012-10-15T16:42:25.443
> 
> 标签：php, email, swiftmailer

我们的系统中有 500 个唯一用户，我们创建了一个通知系统，当其中一个部分有更新时，它将向所有用户发送纯文本电子邮件。系统使用 swiftmailer 并创建一个电子邮件对象，然后在发送之前密件抄送 500 个用户。

我只是想要一些保证，密件抄送 500 个用户意味着服务器会将这视为发送 1 封电子邮件，但会发送给很多用户。我不想遇到我的服务器主机设置的任何电子邮件限制限制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T16:49:40.437

它*不会*算作一封电子邮件。消息内容相同的事实无关紧要，因为您仍然有 500 个收件人。此外，您主机的电子邮件服务器可能会将每封邮件的密件抄送收件人数量限制在一个更合理的值上，所以如果您甚至可以做到这一点，我会感到惊讶。这种爆炸应该通过单独的消息发送。如果您的主机对音量犹豫不决，您可能不得不去像 Constant Contact 等的送货服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T12:11:10.430

我还尝试使用这种密件抄送方法发送 1000 封电子邮件，似乎对我的限制在 100 封左右。所以不要用这个。而是尝试使用 SwiftMailer 提供的插件。

这是一些示例代码：

```
$mailer = Swift_Mailer::newInstance(
  Swift_SmtpTransport::newInstance('smtp.example.org', 25)
);

// Use AntiFlood to re-connect after 100 emails
$mailer->registerPlugin(new Swift_Plugins_AntiFloodPlugin(100));

// And specify a time in seconds to pause for (30 secs)
$mailer->registerPlugin(new Swift_Plugins_AntiFloodPlugin(100, 30));

$content = 'email body'

$message = Swift_Message::newInstance('Email subject')
            ->setFrom(array('no-reply@email.com'=> 'From me'))
            ->setBody($content,'text/html');

$emails = array('email1@email.com','email2@email.com','email3@email.com');

foreach($emails as $recipient){
   $message->setTo($recipient);
   $mailer->send($message);
} 
```

我希望这有助于解决您的问题，因为它是一个更简单的解决方案。

# android - Android：在 Webview 上绘制画布

> ID：12900157
> 
> 赞同：1
> 
> 时间：2012-10-15T16:42:31.267
> 
> 标签：android

我正在使用 WebView 来显示我的资源中的图像，使用 WebView 因为我需要它是可缩放的。动态地，我需要能够在图像上绘制点，它是一张地图。为此，我试图在加载的图像上放置一个画布。画布上将绘制点。

```
mWebView = (WebView)findViewById(R.id.webview);
mWebView.getSettings().setBuiltInZoomControls(true);
mWebView.loadUrl("file:///android_res/drawable/map.png");

Canvas c = new Canvas();
c.drawARGB(10, 0, 100, 12);//This is just random. It is where I would draw the points
mWebView.draw(c); 
```

代码中的最后 3 行似乎没有做任何事情。

有没有更好的方法来在 WebView 上绘图？这种方式甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-26T09:18:00.653

在你的最后一行，你给它一个新的画布（它不会加载 map.png）。

你应该做的是：

*   创建一个扩展 WebView 的新类
*   覆盖其 onDraw() 方法，例如：

    ```
    public class MyWebView extends WebView{

        @Override
        protected void onDraw(Canvas canvas) {
            super.onDraw(canvas);
            canvas.drawPoint(yourPoint);
       }
    } 
    ```

使其变量：

```
 MyWebView mWebView = new MyWebView(this);
        mWebView.getSettings().setBuiltInZoomControls(true);
        mWebView.loadUrl("file:///android_res/drawable/map.png"); 
```

将此视图添加到布局的主视图中。

```
 myMainView.add(wv); 
```

完毕！

# iphone - CCDirecter 用 UIView / nib 替换场景

> ID：12900159
> 
> 赞同：1
> 
> 时间：2012-10-15T16:42:34.853
> 
> 标签：iphone, cocos2d-iphone, uikit

我想做的是让 Cocos2d 共享导演用 UIKit 中的 UIView 替换当前场景（可能从笔尖加载）。这个想法是在 Cocos2d 和 UIKit 之间进行干净的转换。

我已经看到了一些解决这个问题的方法。其中大部分是关于在同一场景中将 UIKit 与 Cocos2d 混合，我想将它们分开。一种方法是添加 UIView 的实例作为导向器 GLView 的子视图。像这样：

```
UIView* cocosView = [[CCDirector sharedDirector] openGLView];
[cocosView addSubview:t]; 
```

[将 UIView 叠加到 Cocos 层上？](https://stackoverflow.com/questions/8225511/overlaying-a-uiview-onto-a-cocos-layer)

这可行，但我必须先创建一个空白场景并过渡到该场景，然后添加 UIView，然后将其删除并过渡到任何其他场景。这是模块化的，但有点混乱。

更好的方法是将 UIView 包装到节点中。像： http: [//www.cocos2d-iphone.org/forum/topic/6889](http://www.cocos2d-iphone.org/forum/topic/6889)

有官方的 cocos2d 扩展吗？如果可能的话，我还想从故事板/笔尖加载 UIView。非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T16:55:38.380

> 用 UIKit 中的 UIView 替换当前场景

如果您使用的是 cocos2d 1.x：[http ://www.raywenderlich.com/4817/how-to-integrate-cocos2d-and-uikit](http://www.raywenderlich.com/4817/how-to-integrate-cocos2d-and-uikit)

如果你使用 cocos2d 2.x：CCDirector 是 UIViewController 的子类，所以你可以使用[常用方法](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/ModalViewControllers/ModalViewControllers.html#//apple_ref/doc/uid/TP40007457-CH111-SW1)。停止/开始动画后的增量时间计算有一个小[错误](http://code.google.com/p/cocos2d-iphone/issues/detail?id=1435)，但很容易修复。

# c# - 搜索数据表

> ID：12900161
> 
> 赞同：0
> 
> 时间：2012-10-15T16:42:43.290
> 
> 标签：c#, ado.net

我正在尝试在绑定到 DataTable 的 datagridview 上进行“模糊”搜索。

我正在尝试使用 DataTable.Select 但我认为它不起作用。这是我的代码：

```
private void buttonSearch_Click(object sender, EventArgs e)
{
   string SearchString;

   if (this.textSearchString.Text == "")
   {
      return;
   }

   SearchString = this.textSearchString.Text;

   DataRow[] rows = dt.Select("PartName Like '" + SearchString + "%'");

   dt.Rows.Clear();
   foreach (DataRow row in rows)
   {
      dt.Rows.Add(row.ItemArray);
   }
   this.datagridInventory.DataSource = null;
   LoadInventoryList(); //loads up dt and formats columns
} 
```

我不确定这是否正确，它似乎不起作用。有人可以指出我的错误或更好地向我解释这个概念吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T16:49:40.883

您正在迭代一组在迭代之前清除（=设为空）的数据行。

消除`dt.Rows.Clear();`

然后您将“dt”中的项目添加到相同的“dt”？

首先，这没有任何意义，因为在 clear() 之后没有更多的行。其次，如果您删除 clear 则不再使用迭代它们并再次添加它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T16:49:56.653

尝试删除您的 dt.Rows.Clear(); 命令。它会删除数据表中的所有行。

但是，如果要保留两组数据（原始数据集和所选行），则需要[dt.clone()](http://msdn.microsoft.com/en-us/library/system.data.datatable.clone.aspx)将要搜索的表放入新数据表中（.clone 只需使用与第一个结构相同，不复制数据），然后使用[clonedTable.Rows.ImportRow()](http://msdn.microsoft.com/en-us/library/system.data.datatable.importrow.aspx)将查询结果转储到新表中。

```
DataTable clonedTable = dt.Clone();

DataRow[] rows = dt.Select("PartName Like '" + SearchString + "%'");

foreach ( DataRow row in rows ){
    cloneTable.importRow( row );
}

clonedTable.acceptChanges(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-20T12:10:40.790

```
StringBuilder searchQuery = new StringBuilder();

foreach (DataColumn column in dataTable.Columns)
{
  if (string.IsNullOrEmpty(searchQuery.ToString()))
    searchQuery.Append(column.ColumnName + " like '%" + searchString + "%' ");
  else
    searchQuery.Append(" OR " + column.ColumnName + " like '%" + searchString + "%' ");
}

DataRow[] foundRows = dataTable.Select(searchQuery.ToString());

if (foundRows != null && foundRows.Length > 0)
{
  dataTable = new DataTable();
  dataTable = foundRows.CopyToDataTable();
} 
```

现在数据表有搜索结果。

# c# - 如何从各个行读取和解析数据？

> ID：12900162
> 
> 赞同：-1
> 
> 时间：2012-10-15T16:42:42.160
> 
> 标签：c#

我是 C#.net 的新手。有人可以帮我解决以下问题吗？谢谢你。

我需要从文件中读取内容，然后检查文件的每一行是否有以“：”或“，”分隔的数据。然后获取“：”和“，”之间的数据。最后将其添加到数据表中。

我该怎么做呢？非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T16:54:52.263

鉴于您的问题的普遍性和整体范围（即，您应该将其分解为您不理解的部分并单独询问），这是我能想出的最好的方法，*可以*做您想做的事情。

```
var data = File.ReadLines() // read the content from a file
               .Where(line => line.Contains(":") && line.Contains(",") // data separated by ":" & ","
               .Select(line => line.Split(":,".ToArray())[1])  // data between ":" & "," -- could yield data between "," and ":"
               .Select(data => new object[] {data}); // for DataTable.Rows.Add

// I can only assume you have a DataTable with one column
foreach(var rowData in data)
   yourTable.Rows.Add(rowData); 
```

希望这能启发你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T16:55:12.570

```
String linestring = streamreader.ReadLine();
String[] linetokens = linestring.Split(new String[]{":",","}, StringSplitOptions.None); 
```

之后 linetokens 数组将填充您需要的段。

# actionscript-3 - 从舞台 AS3 中删除所有内容

> ID：12900169
> 
> 赞同：0
> 
> 时间：2012-10-15T16:42:53.780
> 
> 标签：actionscript-3, movieclip

所以，我想清理我的整个舞台。我已经在互联网上进行了搜索，不幸的是，我的情况没有任何效果。

基本上，我正在做的是一个有点复杂的迷宫生成器，在我创建一个新的迷宫生成器之前，我想摆脱之前创建的所有东西。到目前为止，我听说从舞台上删除影片剪辑的最佳方法是使用以下命令购买：

```
while(numChildren > 0)
    removeChildAt(0); 
```

然而，这只适用于我调用它的当前影片剪辑，其中不包括我生成的迷宫。我只想彻底摆脱一切。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T17:01:08.067

您的思路是正确的，您可以使用`numChildren`，`removeChildAt`但是您需要在舞台范围内调用它们：

```
while(stage.numChildren > 0)
{
  stage.removeChildAt(0);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-16T09:16:02.027

只需将其从舞台上移除：

```
stage.removeChildren(); 
```

**仅仅从舞台上删除剪辑并不总是等于从内存中删除它们**

`removeChildren`，`removeChild`或者`removeChildAt`实际上并没有从*内存*中删除 Sprite 或任何其他 DisplayObject ，它只是将其从`displaylist`. 这意味着如果您创建 1000 个精灵并将它们添加到舞台（显示列表），然后使用`removeChildren`它们仍然可以存在于内存中（永远）。然后你有一个内存泄漏。

要将其从内存中删除，与 有关系的所有对象`displayObject`都应设置为空。这包括事件侦听器和来自/到`non-displaylist`相关对象的关系。

如果您想确保所有相关的东西都应该消失，只需将其设为空并检查以下内容：

*   从`displaylist`using`removeChild`或`removeChildAt`removeChildren 中删除它。（注意这可以在舞台上完成）
*   删除所有`eventListeners`附加到剪辑的内容，或使用*弱*事件侦听器。
*   如果您在 Array、Vector、Dictionary 或任何其他对象中使用了引用，请将其从对象中删除，将其设置为 null 或使用 Array.splice() 拼接它
*   `setTimeout/setInterval`应该清除
*   设置`object = null`

您可以使用来自 Temple Library 的[Doob 先生统计数据](https://github.com/mrdoob/Hi-ReS-Stats)或[性能统计数据](http://templelibrary.googlecode.com/svn/trunk/doc/temple/utils/PerformanceStat.html)来分析内存。删除所有剪辑时，您应该会在一段时间后看到一个丢弃（垃圾收集）。多次删除后，内存指标不应该更高。

# ruby-on-rails - Rails generate 命令有参考/备忘单吗？

> ID：12900170
> 
> 赞同：3
> 
> 时间：2012-10-15T16:42:54.760
> 
> 标签：ruby-on-rails, ruby, command-line

**我很好奇 Rails generate**命令是否有某种参考或备忘单？列出所有可能的生成器（模型、控制器、迁移等）以及您可以为每个生成器传入的选项（*--skip-migration*等）的东西。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-15T16:51:12.550

您可以在命令行上获取所有这些信息。

*   `rails generate`没有生成器名称将输出所有可用生成器的列表以及有关全局选项的一些信息。
*   `rails generate GENERATOR --help`将列出可以传递给指定生成器的选项。

# android - Android TextView 不会在 Android 2.3 中显示正确的行数

> ID：12900171
> 
> 赞同：2
> 
> 时间：2012-10-15T16:42:58.697
> 
> 标签：android, textview, android-2.3-gingerbread

我的应用程序中有几个 TextView，它们应该正好有 3 行。这适用于 Android 3+，但在我也想支持的 Android 2.3 上，这些字段正好有 2 行。我也试过 TextView.setLines(3); 在代码中，但这似乎没有帮助。这是我的文本视图：

```
<TextView
    d1p1:lines="3"
    d1p1:maxLines="3"
    d1p1:minLines="3"
    d1p1:ellipsize="end"
    d1p1:text="Some Text"
    d1p1:textAppearance="?android:attr/textAppearanceMedium"
    d1p1:layout_width="fill_parent"
    d1p1:layout_height="55dp"
    d1p1:id="@+id/detailsTextView"
    d1p1:layout_below="@+id/locationTextView"
    d1p1:textSize="13dp"
    d1p1:textColor="@color/app_darkgray"
    d1p1:background="@color/app_dark_background"
    d1p1:layout_marginLeft="@dimen/sr_horizontal_padding"
    d1p1:layout_marginRight="@dimen/sr_horizontal_padding" /> 
```

将高度设置为 wrap_content 也不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T17:57:53.880

经过一番研究，看来我的怀疑是正确的。正如这里所讨论的（[ellipsize multiline textview](https://stackoverflow.com/questions/2160619/android-ellipsize-multiline-textview)），Ellipsize 会导致最小/最大行属性出现问题。因此，您可能要考虑避免 Ellipsize，否则，如果这不是一个选项，您可以按照其他线程中的说明使用自定义 TextView 类来解决该问题。

# javascript - JavaScript 在 Acrobat 中工作，但在 Reader 中不工作

> ID：12900174
> 
> 赞同：14
> 
> 时间：2012-10-15T16:43:14.407
> 
> 标签：javascript, pdf, adobe

我在 Acrobat 中创建了一个包含提交按钮的表单。当用户单击它时，我希望将某些字段导出为制表符分隔的文本。在 Acrobat 中，单击按钮时会打开窗口，允许我选择要导出到的文件夹，然后导出数据。在阅读器中没有任何反应。调试器给了我这个错误：

```
RangeError: Invalid argument value.
Doc.exportAsText:2:Field Submit:Mouse Up 
```

我已经查看并且似乎无法找到有关此错误的信息。我原来的脚本是这样的：

```
var aSubmitFields = new Array ( "Name", "Address")
this.exportAsText ({aFields: aSubmitFields}) 
```

如您所见，它非常基础。我不明白为什么它不起作用。

**编辑：**从 ({ 中删除“a”后，`aFields`我收到错误消息：

```
NotAllowedError: Security settings prevent access to this property or method.
Doc.exportAsText:2:Field Submit:Mouse Up 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-28T11:40:20.583

要在 Acrobat Reader 中实现这一点，首先用户将打开工具>首选项，用户将看到安全设置。这里首先需要`active contents`允许`run`

完成此操作后，您的代码应该可以工作，恶意用户会利用 JavaScript 等活动内容，因此默认情况下禁用此功能。

安装了 HotFix 的新版本将不允许 JavaScript，每次应用安全热修复时，它都会禁用 JavaScript/Active Content 选项。

我希望这会给您一些解决方案的见解..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-23T13:12:57.577

为了能够在 Adob​​e Reader 中调用exportAsText **(** **)** ，您需要对文档拥有“高级表单功能权限”。您可以在[文档](http://partners.adobe.com/public/developer/en/acrobat/sdk/AcroJS.pdf)第 32 和 251 页中看到它。如果您在调用 JavaScript 代码的文档上没有此权限，您将收到“安全设置阻止访问此属性或方法”。错误。

 **在 Adob​​e Acrobat 中创建文档时可以设置此权限。

正如 MarmiK 已经告诉您的那样，阅读器中必须允许活动内容。**

# vb.net - 使用 Visual Basic 修改注册表值

> ID：12900175
> 
> 赞同：0
> 
> 时间：2012-10-15T16:43:14.907
> 
> 标签：vb.net, registry

我想使用 VB 修改我的窗口的设置。例如，我想更改文件资源管理器窗口标题栏、菜单栏等的颜色。如何开始使用 VB 修改注册表以及修改哪些条目以更改颜色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:57:17.070

我建议将设置保存到文件中，例如 app.config 就是为此目的而设计的。如果您更喜欢注册表，请查看 codeproject 文章[Application Settings the .NET way。INI、注册表或 XML](http://www.codeproject.com/Articles/8554/Application-Settings-the-NET-way-INI-Registry-or-X)

# ruby-on-rails - 为什么我不能使用考拉发布到测试用户的订阅源，但可以发布到我自己的订阅源？

> ID：12900177
> 
> 赞同：0
> 
> 时间：2012-10-15T16:43:17.257
> 
> 标签：ruby-on-rails, facebook, facebook-opengraph, koala

我正在构建一个小型项目来测试将 Facebook 的 Open Graph 集成到我正在构建的 Rails 应用程序中，并且遇到了一个奇怪的问题。我可以将用户（在应用程序内）链接到我的 Facebook 帐户，并成功发布开放图更新，但是如果我断开应用程序与我的 Facebook 帐户的连接，并将其链接到 Facebook 中生成的测试用户，我会收到以下错误：

```
u.facebook.put_connections("me", "goodgym:accept", mission: "http://4ztq.localtunnel.com/missions/1")
Koala::Facebook::APIError: HTTP 500: Response body: {"error":{"message":"An unexpected error has occurred. Please retry your request later.","type":"OAuthException","code":2}}
from /Users/idrysdale/.rvm/gems/ruby-1.9.3-p194@rails327/gems/koala-1.5.0/lib/koala/api.rb:56:in `api'
from /Users/idrysdale/.rvm/gems/ruby-1.9.3-p194@rails327/gems/koala-1.5.0/lib/koala/api/graph_api.rb:424:in `graph_call'
from /Users/idrysdale/.rvm/gems/ruby-1.9.3-p194@rails327/gems/koala-1.5.0/lib/koala/api/graph_api.rb:134:in `put_connections'
from (irb):3
from /Users/idrysdale/.rvm/gems/ruby-1.9.3-p194@rails327/gems/railties-3.2.7/lib/rails/commands/console.rb:47:in `start'
from /Users/idrysdale/.rvm/gems/ruby-1.9.3-p194@rails327/gems/railties-3.2.7/lib/rails/commands/console.rb:8:in `start'
from /Users/idrysdale/.rvm/gems/ruby-1.9.3-p194@rails327/gems/railties-3.2.7/lib/rails/commands.rb:41:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>' 
```

我正在使用我在 user.rb 模型中定义的 Facebook 方法：

```
def facebook
    @facebook ||= Koala::Facebook::API.new(oauth_token('facebook'))
    block_given? ? yield(@facebook) : @facebook
    rescue Koala::Facebook::APIError => e
        logger.info e.to_s
        nil # or consider a custom null object
end 
```

并且 OmniAuth 已设置为：

```
Rails.application.config.middleware.use OmniAuth::Builder do
    provider :facebook, ENV['FACEBOOK_APP_ID'], ENV['FACEBOOK_SECRET'], scope: "email, publish_stream"
end 
```

我不明白为什么这可能适用于我的帐户，但不适用于测试用户（据我所知，所有其他设置都是相同的，并且我们都授权了该应用程序）。

为了让您了解一些设置背景，我注册了一个新的 Facebook 应用程序（几乎按照[http://railscasts.com/episodes/360-facebook-authentication?view=asciicast](http://railscasts.com/episodes/360-facebook-authentication?view=asciicast)上的说明进行操作）

然后我在 Facebook 中创建了一个角色来测试应用程序。

然后，在我的 Rails 应用程序中，我使用 OAuth 连接到 Facebook，它成功生成了一个令牌。

然后我使用 Koala，使用 Facebook 的 Open Graph 发布。

有没有人知道为什么这可能适用于我的帐户，而不是测试角色？如果做不到这一点，任何关于如何更好地调试它的指针将不胜感激。那个意外的错误没有多大用处！

谢谢！

# javascript - 如何仅显示 3 秒的 div 并使用 jquery 再次消失？

> ID：12900179
> 
> 赞同：1
> 
> 时间：2012-10-15T16:43:31.783
> 
> 标签：javascript, jquery

我有这样的html

```
<p id="msgfail"  hidden="hidden" >Theres an error processing ur request</p>
<p id="sucessmsg"  hidden="hidden">Success fully update database</p> 
```

当我单击一个按钮时，它会触发尝试向 mysql 数据库输入数据。并且相应的 p 项是可见的。现在我的问题是如何让它在超时后再次消失？

我试过这样

```
if ($("#msgfail").is(":visible")) {
  setTimeout(function() {$("#msgfail").hide();}, 3000);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T16:45:36.357

你在想这样的事情吗？

```
$("#msgfail").delay(3000).hide(1); 
```

[的文档`delay`](http://api.jquery.com/delay/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T16:53:46.490

您可以只使用`setTimeout`JavaScript 原生的。

```
$('#msgfail').show();
setTimeout(function() { $('#msgfail').hide(); }, 3000); 
```

# git - git reset 中的模棱两可的论点

> ID：12900185
> 
> 赞同：10
> 
> 时间：2012-10-15T16:43:59.990
> 
> 标签：git, version-control

我最近搞砸了一个`git rebase -i`，所以我想做一个`git reset --hard HEAD@{5}`。

但是，执行`git reset --hard HEAD@{5}`or`git log HEAD@{5}`导致显示以下错误消息：

```
fatal: ambiguous argument 'HEAD@{5}': unknown revision or path not in the working tree. 
```

然后，我决定指定对应于`HEAD@{5}`显示的哈希键`git reflog`。例如：

```
git reset --hard e8be841 
```

在这样做的过程中，是否存在搞砸 git 存储库或做一些意想不到的事情的风险？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-04-23T09:13:02.280

对我来说，问题是我需要在**Windows command prompt**上加上双引号。

代替：

```
git reset --soft 'HEAD^' 
```

我不得不写：

```
git reset --soft "HEAD^" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:15:05.897

Git 在合并和变基方面非常宽容。如果您在其中一项操作期间查看 git 存储库的文件结构，您会发现它会更改指定用于帮助执行这些操作的文件，并且不会不安全地更改核心对象。如果是这样，它是一种附加的方式。

因此，几乎没有机会对您的存储库造成任何损害。例如，获取另一个 repo，制作副本，启动 rebase，然后比较两者中的 .git 文件夹。

PS根据您对问题的评论，是的，请使用`git rebase --abort`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-26T09:48:35.240

Git 有一些 shell 参数引用问题。

试试`git log 'HEAD@{5}'`吧。

就我而言，我得到了错误`fatal: Log .git/logs/HEAD is empty.`。

下一个解决方法是：

`git log HEAD^^^^^` .

# c# - LINQ 连接如何只选择第一条记录？

> ID：12900186
> 
> 赞同：18
> 
> 时间：2012-10-15T16:44:05.390
> 
> 标签：c#, entity-framework, linq, linq-to-entities

我希望在下面的连接查询中只从“ ”表中选择**第一条记录**`CustomerSubOwners`，并想知道在 LINQ 中实现这一目标的最佳方法是什么。

```
var result= (from t1 in db.Cases
             from t2 in db.CustomerSubOwners
                          .Where(o => t1.CustomerId == o.CustomerId && o.Expiry >= DateTime.Now)
                          .DefaultIfEmpty()
             select t1); 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-10-15T16:54:36.327

我认为您正在寻找[Take](http://msdn.microsoft.com/en-us/library/bb503062.aspx)方法，如下所示：

```
var result= (from t1 in db.Cases
             from t2 in db.CustomerSubOwners.Where(o => t1.CustomerId == o.CustomerId && o.Expiry >= DateTime.Now)
                                            .Take(1)
                                            .DefaultIfEmpty()
             select t1); 
```

# objective-c - xCode：将标签文本传递到自定义添加的子视图中

> ID：12900188
> 
> 赞同：0
> 
> 时间：2012-10-15T16:44:10.953
> 
> 标签：objective-c, ios, uiview, properties, pass-data

我已经重写了它以尝试使用更多代码使其更具描述性：

我设置了一个单独的`UIView`类，名为：pageTitleView 代码如下：头文件：

```
 #import <UIKit/UIKit.h>

 @interface pageTitleView : UIView
    @property (nonatomic, strong) IBOutlet UILabel *pageTitle;
    @property (nonatomic, strong) IBOutlet UILabel *subTitle;
 @end 
```

M 文件：

```
 @implementation pageTitleView

   @synthesize pageTitle;
   @synthesize subTitle;

  - (id)initWithFrame:(CGRect)frame{

     pageTitle = [[UILabel alloc] initWithFrame:CGRectMake(0,labelPosY,300,20)];
     pageTitle.textColor = txtColour;
     pageTitle.backgroundColor = [UIColor clearColor];
     pageTitle.textAlignment = NSTextAlignmentCenter;
     pageTitle.font = [UIFont systemFontOfSize:14];
     // pageTitle.text to be set by parent view
    [self addSubview:pageTitle];
  } 
```

在我的父视图控制器中，我有以下内容：

头文件：

```
 #import <UIKit/UIKit.h>

   @interface UsingThisGuide : UIViewController

     @property (strong, nonatomic) UIView *PageTitleBlock;
     @property (strong, nonatomic) UIWebView *dispalyPageContent;
     @property (strong, nonatomic) UIView *FooterBar;

   @end 
```

在 M 文件中，我有以下内容：

```
 #import <QuartzCore/QuartzCore.h>
  #import "pageTitleView.h"
  #import "MyFirstView.h"

  @interface MyFirstView ()

  @end

  @implementation MyFirstView {
   - (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil{
       self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
         if (self) {
          // Custom initialization
          }
        return self;
     }
   - (void)viewDidLoad {

      _PageTitleBlock = [[pageTitleView alloc] initWithFrame:CGRectMake(0, 0, 300, 50)];
      _PageTitleBlock.layer.cornerRadius = 5;

      _PageTitleBlock.pageTitle.text = @"This should work but not";

      [self.view addSubview:_PageTitleBlock];
      [super viewDidLoad];
    }

 @end 
```

不，我想做的是通过其父控制器使用类似的东西`pageTitle.text`从类中设置，但这是我得到的错误：`pageTitleView``MyFirstView``_PageTitleBlock.pageTitle.text=`

```
 Property 'pageTitle' not found on object of type 'UIView * 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:26:35.663

是的，您可以轻松地做到这一点，例如，使用`properties`.

1.  在`TitleBlock`（或`pageTitleView`）类的头文件中，您应该定义属性`@interface`之前的部分：`@end`

    ```
    @property (nonatomic, retain) UILabel pageTitle; 
    ```

    或用于 ARC 项目

    ```
    @property (nonatomic, strong) UILabel pageTitle; 
    ```

2.  在父视图控制器中，您应该`_PageTitleBlock`使用**frame**启动：

    ```
    _PageTitleBlock = [[pageTitleView alloc] initWithFrame:CGRectMake(10, 10, 200, 200)]; // specify needed frame
    // and add it to root view:
    [self.view addSubview:_PageTitleBlock]; 
    ```

3.  现在您可以访问`pageTitle`属性：

    ```
    _PageTitleBlock.pageTitle.text = @"Text of page title label"; 
    ```

希望它会帮助你。

PS 对于类名，最好使用大写名称，即，`PageTitleView`而不是`pageTitleView`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T20:40:49.543

这里的问题是，您要声明您的属性称为in`PageTitleBlock`类型，然后调用在 class 中声明的属性。编译器不相信这一点。**`UIView`**`UsingThisGuide``pageTitle``pageTitleView`

`PageTitleBlock`将from的类型更改为`UIView`to `pageTitleView`，您就可以开始了！

# visual-studio-2012 - 使用 Visual Studio 2012 检测到“LoaderLock”

> ID：12900192
> 
> 赞同：25
> 
> 时间：2012-10-15T16:44:30.653
> 
> 标签：visual-studio-2012

我有几个使用 SQL CE 4.0 和实体框架的 MVC 项目。自从迁移到 Visual Studio 2012 后，我不断收到以下错误（不是每次，但经常出现）

检测到 LoaderLock

尝试在 OS Loader 锁内进行托管执行。不要尝试在 DllMain 或图像初始化函数中运行托管代码，因为这样做会导致应用程序挂起。

如果我重新使用 VS 2010，则不会发生该错误，这使我相当确定这是 Visual Studio 的问题，而不是我的代码，但我希望有人为我确认！

**编辑**

当调用 dbcontext 的 Dispose() 方法时，似乎总是会出现该问题。这是异常助手的截图：

![异常助理](../Images/045cb26ec39659bc58df5a0594ad973c.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-12-20T13:18:23.890

我[关掉这个](http://harriyott.com/2006/08/loaderlock-was-detected)。因为它警告应用程序可能挂起，如果您的程序没有挂起，那么您可能没问题。

> 这个问题可以通过关闭 MDA 以同样的方式解决：
> 
> 调试 -> 异常 -> 托管调试助手
> 
> 并取消选中 LoaderLock 项。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-14T18:53:28.587

`LoaderLock`当我在 C# 应用程序中使用一些外部 dll 时，我也遇到了问题。

*   对于**.NET 3.5**，我只是取消选中`Thrown option`（`Exceptions menu`加载[程序锁定错误](https://stackoverflow.com/questions/56642/loader-lock-error)）
*   对于我添加的**.NET 4.0**`<startup useLegacyV2RuntimeActivationPolicy="true">``app.config`

# asp.net - 网格视图数据绑定不起作用

> ID：12900193
> 
> 赞同：1
> 
> 时间：2012-10-15T16:44:33.293
> 
> 标签：asp.net, gridview

这是我绑定gridview的代码。但是当我运行时，我什么也看不到（没有 gridview 只是空的），但是当我使用 sqldatsource 时，我可以全部绑定。我怎样才能解决这个问题？

```
 SqlConnection conn = new SqlConnection(yol);

        conn.Open();

    SqlCommand komut = new SqlCommand("select * from duyuru", conn);
    SqlDataReader dr = komut.ExecuteReader();
    DataTable dt = new DataTable();
    dt.Load(dr);
    GridView1.DataSource = dt;
    GridView1.DataBind();
    conn.Close();

<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" 
                    onrowdeleting="GridView1_RowDeleting" AllowPaging="True" 
                    BackColor="#DEBA84" BorderColor="#DEBA84" BorderStyle="None" BorderWidth="1px" 
                    CellPadding="3" CellSpacing="2" onrowcommand="GridView1_RowCommand">
                    <RowStyle BackColor="#FFF7E7" ForeColor="#8C4510" />
                    <FooterStyle BackColor="#F7DFB5" ForeColor="#8C4510" />
                    <PagerStyle ForeColor="#8C4510" HorizontalAlign="Center" />
                    <SelectedRowStyle BackColor="#738A9C" Font-Bold="True" ForeColor="White" />
                    <HeaderStyle BackColor="#A55129" Font-Bold="True" ForeColor="White" />
                </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T16:52:43.377

试试这个：

```
SqlConnection conn = new SqlConnection(yol);

        conn.Open();

    SqlCommand komut = new SqlCommand("select * from duyuru", conn);

SqlDataAdapter adapter = new SqlDataAdapter(komut);
            DataSet ds = new DataSet();

             adapter.Fill(ds, "Products");//here enter your table name

            GridView1.DataSource = ds;
            GridView1.DataBind(); 
```

# c# - 选择已使用按钮单击方法打开的工作簿 Excel

> ID：12900194
> 
> 赞同：3
> 
> 时间：2012-10-15T16:44:42.840
> 
> 标签：c#, vsto, excel

我有一个问题，我想使用按钮单击方法插入数据，但此方法是在功能区菜单 (VSTO) 中创建的。

为了更好地理解这一点，我想对数据库进行查询，将其发送到人员列表，并在 excel 上打印我想从这些人那里看到的内容。例如，我只想查看姓名和出生日期，或姓名、身份证和职业。

为此，我需要选择运行应用程序时打开的工作簿。所以我试试这个：

```
private void button1_Click(object sender, RibbonControlEventArgs e)
        {
            Excel.Workbook wb = (Excel.Workbook)Globals.ThisWorkbook.InnerObject;
            Excel.Worksheet ws = wb.Sheets["Sheet1"];
            ws.Cells[1, 2] = "teste";
        } 
```

*   使用 Excel = Microsoft.Office.Tools.Excel；
*   使用 ExcelTools = Microsoft.Office.Tools；
*   使用 Microsoft.Office.Interop.Excel；

但我得到这个错误： `**"Unable to cast COM object of type 'System.__ComObject' to interface type 'Microsoft.Office.Tools.Excel.Workbook'. This operation failed because the QueryInterface call on the COM component for the interface with IID '{B74CBB86-9C9F-4172-9AE7-3CE4A7BFA5EB}' failed due to the following error: No such interface supported (Exception from HRESULT: 0x80004002 (E_NOINTERFACE))."**`

可能比我看到的更容易，但我太累了，我需要完成这个......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T16:11:25.673

男人试试这个：

```
using Excel = Microsoft.Office.Interop.Excel;
using Microsoft.Office.Tools.Excel;
using Office = Microsoft.Office.Core;
using Microsoft.VisualStudio.Tools.Applications.Runtime;
Excel.Worksheet wsheet =
  (Excel.Worksheet)Globals.ThisAddIn.Application.ActiveSheet; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-16T11:43:17.530

以下应该有效（删除.InnerObject）

```
private void button1_Click(object sender, RibbonControlEventArgs e) 
        { 
            Excel.Workbook wb = (Excel.Workbook)Globals.ThisWorkbook; 
            Excel.Worksheet ws = wb.Sheets["Sheet1"]; 
            ws.Cells[1, 2] = "teste"; 
        } 
```

InnerObject[属性](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.innerobject%28v=vs.100%29.aspx)返回对基础（读取 COM）工作簿的引用。返回类型是 Microsoft.Office.Interop.Excel.Workbook（而不是 Microsoft.Office.Tools.Excel.Workbook，它是工作簿的 .Net 包装版本）

这同样适用于工作表：
如果您访问本机 Com 工作簿的 Sheets 集合，它将返回 Microsoft.Office.Interop.Excel.WorkSheet，访问 Excel.Workbook 将返回 Excel.WorkSheet

有关 vsto 包装对象的更多信息，请参见：[this](http://msdn.microsoft.com/en-us/library/cc668196%28v=vs.100%29.aspx)

# javascript - asp.net 2.0 表单 - 共享/通用 HTML

> ID：12900195
> 
> 赞同：0
> 
> 时间：2012-10-15T16:44:43.123
> 
> 标签：javascript, jquery, asp.net

我需要扩展我最近创建的 asp.net 2.0 Web 应用程序。目前有一个页面包含一些嵌入的 HTML，在我正在处理的新页面中的应用程序的单独部分中需要这些 HTML。在这个新页面上，我将在整个页面中多次使用 HTML，主要是使用 JavaScript/jQuery 复制 HTML。所以我不确定是否要将 HTML 放在 JavaScript 变量中或隐藏在页面中，然后调用`$.clone()`HTML 以动态重新创建它。

有没有办法在 asp.net 2.0*表单*web 应用程序中共享 HTML 文件，这样我就不必完成代码的双重维护；我假设类似于 MVC 应用程序的工作方式（尽管我并不完全熟悉 MVC HTML 的工作方式）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T16:51:39.800

如果它只部署在单个项目中，则将其创建为用户控件 - 否则您将在版本控制方面进行一些重复工作。如果是这种情况，请将其重新创建为服务器控件并从那里发出 HTML/JS；服务器控件可以在他们自己的库中的项目之间共享。您只需要维护一份副本。

# java - 通过同一个套接字发送和接收

> ID：12900199
> 
> 赞同：3
> 
> 时间：2012-10-15T16:44:59.173
> 
> 标签：java, android, networking

我对 Java 套接字很陌生，并且在使用同一个套接字发送和接收数据时遇到了问题。

服务器位于 Android 设备上：

```
 ServerSocket listenSocket = null;
    OutputStream dataOutStream = null;
    Socket socket = null;
    InputStream dataInputStream = null;

    // Listen
    System.out.println("Start listening");
    try {
        listenSocket = new ServerSocket(4370);
        socket = listenSocket.accept();
        System.out.println("Connection accepted");
        dataInputStream = socket.getInputStream();
        dataOutStream = socket.getOutputStream();
        while (dataInputStream.read() != -1);
    } catch (IOException e) {
        e.printStackTrace();
        close(listenSocket, socket);
        return;
    }

    // Answer
    System.out.println("Answering...");
    byte[] answer = {(byte) 0x82, (byte) 0xf8, 0, 0};
    try {
        dataOutStream.write(answer);
    } catch (IOException e) {
        e.printStackTrace();
        close(listenSocket, socket);
        return;
    }

    close(listenSocket, socket);
    System.out.println("Finished"); 
```

客户端在装有 Java 6 的 Linux 机器上运行：

```
 Socket socket = new Socket("192.168.1.33", 4370);
    OutputStream dataOutputStream = socket.getOutputStream();
    InputStream dataInputStream = socket.getInputStream();
    byte[] bufferOut = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
    dataOutputStream.write(bufferOut);
    System.out.println("Sent");

    while (dataInputStream.read() != -1);       
    socket.close();
    System.out.println("Finished"); 
```

这里的问题是服务器卡住了`while (dataInputStream.read() != -1);`。看起来客户端永远不会关闭发送。

如果我`dataOutputStream.close()`在客户端部分这样做（当然是在编写之后），那么它确实可以工作，但是客户端会在`while (dataInputStream.read() != -1);`说套接字已关闭时死掉。

我想保持整个套接字打开，以便在同一个套接字上进行更多数据交换，直到发送关闭命令。

我显然在这里做错了什么，有什么见解吗？提前致谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-15T17:00:22.637

您既不关闭套接字也不关闭输出流。您在客户端执行[shutdownOutput() ：](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/Socket.html#shutdownOutput%28%29)

```
...
dataOutputStream.write(bufferOut);
System.out.println("Sent");
socket.shutdownOutput();
... 
```

这称为半关闭，因为它只关闭一个方向而使另一方向保持打开状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T16:53:12.890

*编辑*：Olaf 展示了一种内置方法来实现问题中的请求-响应场景。

关闭从套接字获得的流也会关闭套接字（[另见](https://stackoverflow.com/questions/8890303/behavior-of-java-sockets-when-closing-output-stream)）。另一方面，只要流/套接字打开，从套接字获得的 InputStream 就不可能查看是否发送了所有数据（可能在路上会有更多的东西！）。除非使用 Olafs 示例，否则 2-way 通信不能以这种方式工作。这允许等待服务器响应。

您可以做的是自己定义一个结束信号（例如字符串“END”），并且任何一方都在监听，直到读取该结束信号，然后写入。但这伴随着您肯定会遇到的各种其他问题（如果发送的文本包含结束信号怎么办？如果合作伙伴在发送结束之前死了怎么办？超时？...）。[也可以看看](https://stackoverflow.com/questions/5562370/how-to-identify-end-of-inputstream-in-java)

我会尝试查看在 Java 中得到很好支持的 SOAP 或 RESTful 服务（但我不知道在 Android 上有多好）。通常有许多库可以为您解决这些问题，并使您从低级网络中解脱出来。使用现有解决方案几乎总能带来回报。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T16:52:02.060

尝试通过执行刷新 OutputStream`dataOutStream.flush()`

# jquery - 使用 jQuery 插件过滤 twitter bootstrap 手风琴

> ID：12900200
> 
> 赞同：4
> 
> 时间：2012-10-15T16:45:04.933
> 
> 标签：jquery, twitter-bootstrap

我正在用我的 Rails 应用程序中的数据填充 Twitter 引导手风琴，我希望能够过滤数据。我找到了一些不错的 jQuery 插件，但似乎都没有过滤数据。这是因为它不是一个简单的列表吗？编辑：不再使用列表。这是我到目前为止的代码：

```
<div id="descriptions">

    <% unless @subcategories.nil? %>
    <form class="filterform" action="#">
        <input class="filterinput" type="text">
    </form>

    <div id="list" class="display-subcategory">
        <div class="accordion" id="accordion2">
            <% @subcategories.each do |s| %>
                <% unless s.description == "No description yet"%>
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <a class="accordion-toggle purple-text" data-toggle="collapse" data-parent="#accordion2" href="#collapse<%=s.name.gsub(/\s+/, "")%>">
                                <h3><%= s.name %> </h3>
                        </a>
                    </div>
                    <div id="collapse<%=s.name.gsub(/\s+/, "")%>" class="accordion-body collapse out">
                        <div class="accordion-inner">
                            <%= s.description.html_safe %>
                        </div>
                    </div>
                </div>
                <% end %>
            <% end %>
        </div>
        </div>
    <% end %>
</div> 
```

这是我正在使用的插件：http: [//anthonybush.com/projects/jquery_fast_live_filter/](http://anthonybush.com/projects/jquery_fast_live_filter/)

编辑：我不再使用这个插件，我将尝试编写自己的过滤器函数。

我正在尝试按项目名称进行过滤，但我无法弄清楚这一点，希望能得到一些帮助。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T11:12:24.207

这是我用来过滤手风琴的 jQuery，我用这个 jfiddle 来帮助[http://jsfiddle.net/U8T8p/10/](http://jsfiddle.net/U8T8p/10/)：

```
 (function($) {

        $('.filterinput').keyup(function() {
            var a = $(this).val();
            if (a.length > 0) {
                children = ($("#accordion2").children());

                var containing = children.filter(function () {
                    var regex = new RegExp('\\b' + a, 'i');
                    return regex.test($('a', this).text());
                }).slideDown();
                children.not(containing).slideUp();
            } else {
                children.slideDown();
            }
            return false;
        })

    }(jQuery)); 
```

因此，这使用正则表达式来查找我的手风琴标题并在它们与输入不匹配时隐藏它们。无论如何，希望这对其他人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-10T12:35:24.520

```
 $.expr[":"].contains = $.expr.createPseudo(function(arg) {
    return function( elem ) {
        return $(elem).text().toUpperCase().indexOf(arg.toUpperCase()) >= 0;
    };
});
$("#searchinput").change( function() {
    var filter = $(this).val();
    var list= $(".accordion .accordion-group");
    if(filter) {
        $(list).find(":not(:contains(" + filter + "))").filter( ".text-contrast" ).parent().parent().parent().hide();
        $(list).find(":not(:contains(" + filter + "))").filter( ".accordion-inner" ).parent().parent().hide();
        $(list).find(":contains(" + filter + ")").filter( ".text-contrast" ).parent().parent().parent().show();
        $(list).find(":contains(" + filter + ")").filter( ".accordion-inner" ).parent().parent().show();
    } else {
        $(list).show();
    }
    return false;
}).keyup( function() {

    $(this).change();
}); 
```

您可以搜索手风琴内容和手风琴标题。搜索也是免费的。在引导程序中工作。

# html - HTML 框架/iframe

> ID：12900206
> 
> 赞同：0
> 
> 时间：2012-10-15T16:45:43.467
> 
> 标签：html, iframe, frame

我看到 HTML 既有`frame`标签又有`iframe`标签。它们有什么不同，什么时候应该优先选择一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T16:46:49.797

> 它们有何不同？

[框架](http://www.w3.org/TR/html4/present/frames.html#edef-FRAME)出现在[框架集中](http://www.w3.org/TR/html4/present/frames.html#edef-FRAMESET)。[iframe](http://www.w3.org/TR/html4/present/frames.html#edef-IFRAME)出现在具有`<body>`.

> 什么时候应该优先于另一个？

他们做着截然不同的事情。

两者都可以破坏链接/书签（因此应该很少使用），但是常规框架的用例使得它们比 iframe 更有可能发生这种情况。

# asp-classic - OWC11 数据透视表：不支持 TotalMember

> ID：12900208
> 
> 赞同：1
> 
> 时间：2012-10-15T16:45:46.500
> 
> 标签：asp-classic, iis-7.5, office-interop

我有一个古老的经典 ASP 应用程序，它使用 Office Interop 进行枢轴。

一切都很好，直到我最近不得不搬到一个新的主人。经过一天的痛苦，我设法让 CreateObject("OWC11.PivotTable") 工作。

我现在正在尝试运行这个：

```
Dim oPivot
Set oPivot = Server.CreateObject("OWC11.PivotTable")
'... get data from sql'
set myData = oPivot.ActiveData
set dataColumnMembers = myData.ColumnMembers 
dataColumnMembers.TotalMember 
```

它在最后一条语句上失败并出现此错误：

> 对象不支持此属性或方法：'dataColumnMembers. **总会员**'

我猜我在新服务器上使用的 OWC dll 比旧服务器上的更新，并且可能已弃用*TotlaMember*。我找不到替代品是什么。

我会很感激你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T08:17:45.553

呼，我终于成功了！这是OWC11的解决方案：

这些属性

```
myData.ColumnMembers.TotalMember
myData.RowMembers.TotalMember 
```

被替换为

```
myData.ColumnAxis.ColumnMember.TotalMember
myData.RowAxis.RowMember.TotalMember 
```

这是一个幸运的猜测:)

# wpf - 文本块未显示在选项卡控件中

> ID：12900210
> 
> 赞同：1
> 
> 时间：2012-10-15T16:45:46.773
> 
> 标签：wpf, wpf-controls

我显然在这里遗漏了一些东西。我正在尝试在 WPF 窗口的选项卡控件中获取文本块。我从互联网上获取了一些示例代码并稍微更改了它，现在文本块没有显示。

**编辑** 这种造型似乎是负责任的

```
 <Window.Resources>
<Style TargetType="{x:Type TabItem}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type TabItem}">
                <Grid>
                    <Border 
         Name="Border"
         Background="{DynamicResource TabSelected}"
         BorderBrush="Black" 
         BorderThickness="1,1,1,1" 
         CornerRadius="6,6,0,0" >
                        <ContentPresenter x:Name="ContentSite"
           VerticalAlignment="Center"
           HorizontalAlignment="Center"
           ContentSource="Header"
           Margin="12,2,12,2"/>
                    </Border>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{DynamicResource TabSelected}" />
                    </Trigger>
                    <Trigger Property="IsSelected" Value="False">
                            <Setter TargetName="Border" Property="Background" Value="{DynamicResource TabNormal}" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
<Style  TargetType="{x:Type TabControl}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TabControl}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <TabPanel 
         Grid.Row="0"
         Panel.ZIndex="1" 
         Margin="0,0,4,-1" 
         IsItemsHost="True"
         Background="Transparent" />
                        <Border 
         Grid.Row="1"
         BorderBrush="Black" 
         BorderThickness="1" 
         CornerRadius="0, 12, 12, 12" >

                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</Window.Resources> 
```

**结束编辑**

```
 <Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="25"></RowDefinition>
        <RowDefinition></RowDefinition>
        <RowDefinition Height="25"></RowDefinition>
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition></ColumnDefinition>
    </Grid.ColumnDefinitions> 

    <Button Content="Button" Height="23" Grid.Row="0"  HorizontalAlignment="Left" Name="button1" VerticalAlignment="Top" Width="75" Click="button1_Click" />
    <TextBox Height="27" HorizontalAlignment="Left" Grid.Row="2" Name="txtMessages" VerticalAlignment="Top" Width="200" />
    <TabControl Grid.Row="1" Grid.Column="0" Height="258" HorizontalAlignment="Left" Margin="12,15,0,0" Name="tabMainContent" VerticalAlignment="Top" Width="351">
        <TabItem Header="Assigned Printers" Name="tabInstalledPrinters" Margin="0">
            <TabItem.Content>
                <StackPanel>
                    <Grid>
                        <Grid.RowDefinitions >
                            <RowDefinition></RowDefinition>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition></ColumnDefinition>
                        </Grid.ColumnDefinitions>
                    <TextBlock Grid.Row="0" Grid.Column="0" Name="txtDisplayText" Height="23" Width="209" Text="Im Here" Background="Aqua" Margin="20,40,30,50" />
                    </Grid>
                </StackPanel>
            </TabItem.Content>
        </TabItem>
        <TabItem Header="Options" Name="tabOptions">
            <Grid />
        </TabItem>
    </TabControl>
</Grid> 
```

一切都如我所料，但 Textblock 没有显示，我已将其设为 Aqua 以确保我不会错过它。

谁能看到它不显示的原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:19:27.647

你`ContentPresenter`从你的`TabControl`风格中删除了一个。把它放在里面`Border`：

```
<Style TargetType="{x:Type TabControl}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type TabControl}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TabPanel Grid.Row="0" Panel.ZIndex="1" Margin="0,0,4,-1" IsItemsHost="True" Background="Transparent" />
                    <Border Grid.Row="1" BorderBrush="Black" BorderThickness="1" CornerRadius="0, 12, 12, 12" >
                        <ContentPresenter ContentSource="SelectedContent"/>
                    </Border>
                 </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

# c# - 时间：2019-05-10 标签：c#winform Facebooksdk Post vs PostTaskAsync

> ID：12900211
> 
> 赞同：0
> 
> 时间：2012-10-15T16:45:46.913
> 
> 标签：c#, facebook, winforms

我对 facebooksdk 很陌生，但是我在 c# 中有一个 winform 项目，可以使用它执行简单的状态发布和照片上传。

到目前为止，SDK 做得很好，但是，FacebookClient.Post 和 FacebookClient.PostTaskAync 之间有什么区别？

我使用以下代码将照片发布到我的 Facebook 帐户：

```
public static void uploadPhoto(string fPath, string userMsg, string imgType = "")
{
    var fb = new FacebookClient(AccessToken);
    if (imgType.Equals(""))
        imgType = "image/jpeg";

    using (var file = new FacebookMediaStream
    {
        ContentType = imgType,
        FileName = Path.GetFileName(fPath)
    }.SetValue(File.OpenRead(fPath)))
    {
        dynamic result = fb.Post("me/photos",
            new { message = userMsg, file });
    }
} 
```

但是，当文件很大时，上述方法会“挂起”我的系统，因为主线程仍在工作，所以我尝试了以下方法：

```
dynamic result = fb.PostTaskAsync("me/photos",
                  new { message = userMsg, file }); 
```

但它只是不起作用（至少照片没有上传到我的fb帐户）......

我实际上想要的是避免系统上出现“挂起”的感觉，我什至尝试过“Application.DoEvents()”，但没有运气。

有什么建议可以解决这个问题吗？我应该使用另一个线程来处理这张照片上传吗？或者？

感谢所有的答案和评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:18:37.723

您是否尝试过使用异步/等待？

显然，下面是一个非常小的示例，但请注意：

*   该方法被标记为“异步”
*   返回类型是 Task （或 Task < T > ）
*   facebook 方法更改为：'await fb.PostTaskAsync('

这意味着结果仅在完成后才被封送回 UI 线程，并且您的 UI 将保持响应。请参阅：http: [//msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx](http://msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx)

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        this.Load += OnLoad;
    }

    private const string AccessToken = "xxxxxxxxxxxxxx";
    private const string imgType = "image/jpeg";
    private const string fPath = "c:\bob.jpg";
    private const string userMsg = "My Message";

    private async void OnLoad(object sender, EventArgs e)
    {
        await DoSomething();
    }

    private async Task DoSomething()
    { 
        var fb = new FacebookClient(AccessToken);

        using (var file = new FacebookMediaStream
        {
            ContentType = imgType,
            FileName = Path.GetFileName(fPath)
        }.SetValue(File.OpenRead(fPath)))
        {
            dynamic result = await fb.PostTaskAsync("me/photos",
                new { message = userMsg, file });
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:33:26.777

看来我设法在我的 VS2010 .net4.0 上使用 System.Threading.Tasks 处理它，如下所示：

```
 // For Tasks
    private static Task _taskUpload = null;
    private static string _fPath = "";
    private static string _userMsg = "";
    private static string _imgType = "";

    /// <summary>
    /// used to post photo to facebook
    /// </summary>
    /// <param name="fPath"></param>
    /// <param name="userMsg"></param>
    /// <param name="imgType"></param>
    public static void uploadPhoto(string filePath, string userMsg, string imgType = "")
    {
        // Assign Values
        _fPath = filePath;
        _userMsg = userMsg;
        _imgType = imgType;

        // Start Task
        _taskUpload = Task.Factory.StartNew(new Action(processUploadPhoto));

    }

    /// <summary>
    /// Used to process actual upload of photo to FB
    /// </summary>
    private static void processUploadPhoto()
    {
        var fb = new FacebookClient(AccessToken);
        if (_imgType.Equals(""))
            _imgType = "image/jpeg";

        using (var file = new FacebookMediaStream
        {
            ContentType = _imgType,
            FileName = Path.GetFileName(_fPath)
        }.SetValue(File.OpenRead(_fPath)))
        {
            dynamic result = fb.Post("me/photos",
                new { message = _userMsg, file });
        }
    } 
```

感谢您的所有建议。

# javascript - HTA 应用程序并确认浏览器关闭

> ID：12900214
> 
> 赞同：0
> 
> 时间：2012-10-15T16:45:50.713
> 
> 标签：javascript, html, dom

我需要你的帮助。我有一个 HTA 应用程序，当我使用（IE 7）中的 [X] 按钮关闭浏览器窗口并使用下面的代码确认操作时，我收到一条错误消息：“对象不支持此属性或方法”

我不确定我做错了什么？

```
<body onbeforeunload="return promptonclose()">

function promptonclose()
    {
          if (confirm('Do you want to close this form?')){
                alert('you clicked OK');
          }else{
                alert('Cancelling form close');
                window.event.stopPropogation();
          }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:37:14.240

IE7 还不支持`event.stopPropagation`。只有`event.returnValue`可以用于`onbeforeunload`事件。请注意，Web 浏览器将始终显示其自己的对话框以供最终决定，因此脚本无法完全控制以防止当前窗口/选项卡关闭，并且显示确认对话框（通过`confirm`）将无用。

使用`event.returnValue`，脚本只能为最终的 Web 浏览器提示对话框选择自定义消息，如下所示：

```
<body onbeforeunload=" window.event.returnValue='This form will be closed.'; "> 
```

# c - 何时在 c 中使用 typedef？

> ID：12900215
> 
> 赞同：9
> 
> 时间：2012-10-15T16:45:53.497
> 
> 标签：c, struct, typedef

谁能告诉我什么时候在 C 中使用 typedef？在以下代码中，我收到警告`gcc`：

`warning: useless storage class specifier in empty declaration`

```
typedef struct node
{
  int data;
  struct node* forwardLink;
} ; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-15T16:47:08.013

的语法`typedef`是`typedef <type> <name>`; 它使类型可以通过`name`. 在这种情况下，您只指定了 a`type`和 no `name`，因此您的编译器会抱怨。

你可能想要

```
typedef struct node
{
  int data;
  struct node* forwardLink;
} node; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-15T16:48:23.477

所以..

你可以这样做：

```
struct node {
  int data;
  struct node* forwardLink;
}; 
```

定义一个可以用作`struct node`.

像这样：

```
struct node x; 
```

但是，假设您想将其称为 just `node`。然后你可以这样做：

```
struct node {
  int data;
  struct node* forwardLink;
};

typedef struct node node; 
```

或者

```
 typedef struct {
  int data;
  void* forwardLink;
} node; 
```

然后将其用作：

```
node x; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T16:47:44.407

`typedef`当你想为一个类型使用另一个名字时使用，例如一个结构。

在您的情况下，`struct node`您可以使用 , 而不是使用来声明变量，而是使用`Node`, 作为`struct node`.

但是您在声明中缺少别名：

```
typedef struct node
{
  int data;
  struct node* forwardLink;
} Node; 
```

这完成了同样的事情，但可能更好地阐明错误的原因：

```
struct node
{
  int data;
  struct node* forwardLink;
};

// this is equivalent to the above typedef:
typedef struct node Node; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T16:49:24.203

```
typedef struct node
{
    int data;
    struct node* forwardLink;
} MyNode; 
```

如果你想写

```
MyNode * p; 
```

代替

```
struct node *p; 
```

在结构内部，您仍然需要结构节点 * forwardLink;

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-15T16:54:10.053

typedef 用于定义用户数据类型。例如

```
typedef int integer; 
```

现在您可以使用整数来定义 int 数据类型而不是 int。

```
integer a;// a would be declared as int only 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-15T20:26:23.257

对于作为某个变量的可能值列表的 contants：

```
typedef enum {BLACK=0, WHITE, RED, YELLOW, BLUE} TColor; 
```

一般来说，它可以帮助您了解您是否正确地操作事物，因为编译器会警告您有关隐式转换等问题。它比仅仅让你的代码更具可读性更有用。

# jquery - 在页面加载时显示加载 gif

> ID：12900217
> 
> 赞同：0
> 
> 时间：2012-10-15T16:45:58.427
> 
> 标签：jquery, ajax, tabs, loading

我有一个选项卡式菜单。

```
<ul>
    <a href="views/wrap1.php"><li class="wrap1"> Home &nbsp&nbsp </li></a>&nbsp
    <a href="views/wrap2.php"><li class="wrap2"> Packages</li></a>&nbsp
    <a href="views/wrap3.php"><li class="wrap3"> Clients &nbsp </li></a>&nbsp
    <a href="views/wrap4.php"><li class="wrap4"> Creations</li></a>&nbsp
    <a href="views/wrap5.php"><li class="wrap5"> Reach Us &nbsp </li></a>&nbsp
</ul> 
```

并使用 Jquery.load() 我将五个页面 wrap1.php 、 wrap2.php 、 wrap3.php 、 wrap4.php 、 wrap5.php 加载到一个通用的 div**容器中**

我正在使用的 Jquery 代码是

```
$('.wrap1').css({'border':'2px solid black'}) ;
     $('#tabs li').click(function(){

     $('#container').load('views/'+$(this).attr("class")+'.php', function(){

     $('#container').fadeIn('slow') ;
        });
        return false;
    }); 
```

**一切正常**，但我想在页面加载时显示加载 gif，并在页面加载时隐藏该 gif。我在这里阅读了很多问题并尝试了所有方法，但对我没有任何帮助。还要告诉我应该在哪里放置脚本以便它可以工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:48:14.333

为此，您可以通过 jQuery。jQuery 为您提供了许多动画事件或函数。

单击此处[jQuery Image Loader](http://mycodeprograms.blogspot.com/2012/10/how-to-add-loader-while-page-load.html)查看可以在代码中使用的一些不错的示例。

# java - java7中的符号“ BasicFileAttributes.class ”是什么意思？

> ID：12900219
> 
> 赞同：1
> 
> 时间：2012-10-15T16:46:08.913
> 
> 标签：java, java-7, nio

这是代码

```
Path file = ...;
BasicFileAttributes attr = Files.readAttributes(file, BasicFileAttributes.class);
System.out.println("creationTime: " + attr.creationTime());
System.out.println("lastAccessTime: " + attr.lastAccessTime());
System.out.println("lastModifiedTime: " + attr.lastModifiedTime()); 
```

在链接 [http://docs.oracle.com/javase/tutorial/essential/io/fileAttr.html](http://docs.oracle.com/javase/tutorial/essential/io/fileAttr.html)，他们说 BasicFileAttributes 是一个类。但是链接[http://docs.oracle.com/javase/7/docs/api/java/nio/file/attribute/BasicFileAttributes.html](http://docs.oracle.com/javase/7/docs/api/java/nio/file/attribute/BasicFileAttributes.html)将其称为接口。（如果您知道，请清除这种混淆，虽然这不是' t 主要问题）

**主要问题：**
我无法理解**BasicFileAttributes.class**参数。他们是否试图将类作为参数传递？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T16:53:51.327

[`BasicFileAttributes`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/attribute/BasicFileAttributes.html)被定义为一个接口，因为它指定了行为（在这种情况下，文件属性信息的访问器方法），并且有子类以实现定义的方式提供它。文档页面列出了已知的`DosFileAttributes`子`PosixFileAttributes`类。

接口可以用作声明类型以保持基本行为协定相同。换句话说，当我有一个`BasicFileAttributes`对象时，我不知道它是真正的 a`DosFileAttributes`还是`PosixFileAttributes`引擎盖下的 a，我不在乎。我所关心的是我可以调用它上面的任何`BasicFileAttributes`方法并得到我期望的结果。

至于[`Files.readAttributes`](http://openjdk.java.net/projects/nio/javadoc/java/nio/file/Files.html#readAttributes%28java.nio.file.Path,%20java.lang.Class,%20java.nio.file.LinkOption...%29)方法，是的，您正在传入一个类。在这种情况下，您可以使用 获取基本文件属性`BasicFileAttributes.class`，或者您可以传入其子类之一并获取特定于平台的信息（有风险）处理`UnsupportedOperationException`如果您要求的属性在您的平台上不存在）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T16:51:47.057

BasicFileAttributes 是一个接口，但在口语表达中很常见使用诸如“BasicFileAttributes 类”之类的短语来表示“实现 BasicFileAttributes 的类”。

至于您的主要问题，您正在传递一个特殊 Java 类的实例`java.lang.Class`。所以不，你不是“传递一个类”（这个概念实际上在 Java 中毫无意义）。您正在传递这样一个`java.lang.Class`描述**接口** `BasicFileAttributes`的实例。

这类似于将 的实例传递`File`给方法：传递的不是实际的文件，而是可以管理该文件的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T16:52:25.373

> 他们是否试图将类作为参数传递？

是的。

接口也有`.class`描述其元数据的关联文件。这里的后缀，或者类文件的使用，并不一定意味着所引用的类型是“类”，因为它不是接口或枚举。

# grails - grails hasOne vs 直接成员变量

> ID：12900221
> 
> 赞同：23
> 
> 时间：2012-10-15T16:46:14.437
> 
> 标签：grails, foreign-keys, grails-orm, has-one

假设我有一个看起来像的 grails 域类

```
class Person {
    Address address
} 
```

我也可以将其声明为

```
class Person {
  static hasOne = [address:Address]
} 
```

第二种方法是将外键移动到地址表而不是人员表。

与另一种方式相比，这样做的实际好处（或缺点）是什么？据我了解，它们都将使用外键，这只是外键所在位置的问题。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-15T17:09:04.430

如果地址表上存在外键，则该地址只能有一个人。如果外键在 person 表上，则多个人可以有相同的地址。

这不是关于哪种方式更好/更差。这是关于什么是对数据建模的正确方法。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-04-22T19:34:06.253

我发现`hasOne`在 Grails 中的使用特别令人困惑。例如，这个问题询问当一个 toOne 关系声明如下时会发生什么：

```
class Person {
  static hasOne = [address: Address]
} 
```

如上所述，这会导致`person_id`外键出现在 Address 表中，这意味着每个 Address 只能指向一个 Person。那么，我觉得奇怪的是，即使代码写成“一个人有一个地址”，实际结果是“一个地址有一个人”。

事实上，仅按照上面的定义，没有什么（在数据库级别）阻止多个地址记录指向同一个 Person，这意味着一个 Person 并不真的必须有一个 Address。

有趣的是，如果您像这样创建 Address 类，您将获得相同的数据库表示：

```
class Address {
    Person person
} 
```

外`person_id`键将在 Address 表中，就像在前面的示例中一样，但显然，如果不以某种方式定义该关系，您就无法从代码中的 Person 到 Address。

同样有趣的是，如果您在数据库中建模从 Person 到 Address 的 toMany 关系，您将使用相同的表布局。您将父母的主键 (person_id) 放入子表中。那么从数据库的角度来看， using`hasOne`创建的结构与 toMany 关系将创建的结构相同。

当然，我们不只是创建数据库表，我们还在创建 Grails 域类，这些类具有一些与之相关的行为，以及一些关系语义的实施。在这个特定的业务示例中，您可能不想与多个人共享相同的地址记录，您只想单独存储地址（也许为一个人有多个地址的那一天做准备）。我可能会投票支持这种方法：

```
class Person {
    Address address

    static constraints = {
        address unique:true
    }
} 
```

外`address_id`键将在 Person 表中，并且唯一约束将强制没有两条 Person 记录指向同一个地址。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-01-31T20:39:56.550

我建议以下...

```
class Person {
  ...
  static hasOne = [address: Address]
}

class Address {
    ...
    static belongsTo = [person: Person]
} 
```

一个人有一个地址，地址属于一个人。

这样，当你删除一个人时，地址也会被删除，没有问题。

我认为这是更好的方法。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-04-14T15:18:12.683

*人*“ **hasOne** ”*地址*和*地址*“**属于**”*人*。_

将外键放在“子”表上更有意义，因为这样如果父项丢失，子项就会中断。一个*人*可以没有它的地址而存在，但是没有一个人的“人的地址”是没有意义的。所以*地址*应该是关系中较弱的一面。

在 grails 中这样做，两个实体都会相互引用，所以不会感觉很奇怪。此外，默认的级联行为将在您保存*人员时保存并删除**地址*，但如果您想删除*地址*，则*人员*将保持保存状态。

# javascript - 如何将变量从控制器传递到视图中的javascript？

> ID：12900226
> 
> 赞同：0
> 
> 时间：2012-10-15T16:46:41.277
> 
> 标签：javascript, ruby-on-rails, ruby, ruby-on-rails-3, partial-views

我有一个数组@fields，它有一个文本和一个id，asset_id。要将局部变量从控制器传递到渲染中的视图，我们使用

```
render(:template => "assets/invalid", :locals => {:asset_id => params[:id], :fields => @fields}) 
```

观点是

```
<div id="panel">
  <script>
    alert('Invalid values for ')
    window.location = "../assets/" 
  </script>
</div> 
```

这应该会生成一个弹出框。但是，我希望弹出框重定向到“../assets/asset_id”并显示“+ 字段的无效值”

以下不起作用，

```
<div id="panel">
  <script>
    var fields = fields
    var asset_id = asset_id 
    alert('Invalid values for ' + fields )
    window.location = "../assets/" + asset_id 
  </script>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:04:40.560

可以这么简单吗？

```
<div id="panel">
  <script>
    var fields = <%= fields.to_json %>
    var asset_id = <%= asset_id.to_json %>
    alert('Invalid values for ' + fields )
    window.location = "../assets/" + asset_id 
  </script>
</div> 
```

**更新**顺便说一句，为什么你需要传递`fields`或`params`作为局部变量，为什么不在`@fields`你的视图中使用？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:29:48.973

我在几个应用程序中使用的一种方法是，客户端代码需要使用服务器数据，即构建一个哈希并将其呈现为页面上的 json 文字，并让我的所有 JS 引用该对象。它与上面提到的方法相同，但更简洁一些，因为您不必在 JS 代码中混合大量服务器标签。更易于阅读和维护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:04:57.723

这有什么问题

```
<div id="panel">
  <script>
    var fields = fields
    var asset_id = <%= asset_id %> 
    alert('Invalid values for ' + fields )
    window.location = "../assets/" + asset_id 
  </script>
</div> 
```

现在您可以将数据传递给 html 以进行高级操作，您可以使用类似**gon** check out gon gem 它可能会有所帮助

# c# - 如何处理 LinqServerModeDataSource 和数据上下文？

> ID：12900229
> 
> 赞同：3
> 
> 时间：2012-10-15T16:46:52.607
> 
> 标签：c#, .net, entity-framework-4.1, objectcontext

我正在尝试学习如何使用**LinqServerModeDataSource** DevExpress 控件。承诺是控件将接受可查询（查询），动态修改它，并从数据库服务器中仅提取需要显示的数据。在处理大型数据集时，这应该会带来更快的性能。

我正在使用实体框架 4.1。我所有的对象都是用 ADO.NET POCO Entity Generator (ObjectContext) 创建的

**到目前为止我做了什么：**

我在页面上放置了 ASPxGridView 和 LinqServerModeDataSource 控件，并做了所有必要的接线......

在**LinqServerModeDataSource1_Selecting**方法中，我有这样的东西：

```
e.KeyExpression = "CarwashId";
e.QueryableSource = Carwashes.GetCarWashes().AsQueryable(); 
```

我的 GetCarWashes 方法是这样定义的：

```
public static IQueryable<Carwash> GetCarWashes()
{
    using (var ctx = new LMEntities(PBase.EntityFrameworkConnectionString))
    {
        var query = from c in ctx.Carwashes
                    join d in ctx.Stations on c.StationId equals d.StationId
                    orderby d.Number
                    select c;
        return query;
     }
} 
```

问题是我总是得到空网格，没有结果。根据我迄今为止对 EF 的了解，这是有道理的，因为实际上从未评估过查询。如果我将上述方法中的 return 语句更改为 return query.ToList() 那么，当然，我的记录会显示在网格中，但这不是违背了 LinqServerModeDataSource 控件的目的吗？

**问题：**

我知道这与正在处理数据上下文的问题有关。所以，如果我在**LinqServerModeDataSource1_Selecting 中** 放置这样的代码：

```
var ctx = new LMEntities();
e.QueryableSource = from c in ctx.Carwashes
                    join d in ctx.Stations on c.StationId equals d.StationId
                    orderby d.Number
                    select c; 
```

一切正常，并显示记录。

但是如果我像这样使用 dispose 上下文（注意 using 语句）：

```
using (var ctx = new LMEntities());
{
    e.QueryableSource = from c in ctx.Carwashes
                        join d in ctx.Stations on c.StationId equals d.StationId
                        orderby d.Number
                        select c;
} 
```

在这种情况下，我没有得到任何数据行。
那么，这里发生了什么？我被认为总是使用**using**语句来确保正确处理对象。此外，在我的应用程序中，需要将数据层保存在单独的项目中。如果我必须有开放的数据上下文，那么我如何保持这种分离？

谢谢

# multithreading - 函数返回不等待计时器停止

> ID：12900230
> 
> 赞同：0
> 
> 时间：2012-10-15T16:46:54.567
> 
> 标签：multithreading, .net-4.0, timer

我创建了创建 System.Timers.Timer 的函数，并在新线程中调用了新函数。但是我的第一个函数不等待 timer.Stop 执行并在调用 timer.Start() 后返回值

当我在函数返回之前添加此代码时：

```
while(timer.Enabled)
{
Thread.Sleep(2000);
} 
```

计时器函数永远不会被调用：/

我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T02:28:50.547

如果您查看 MSDN 文档，您会看到以下注释（我怀疑这是正在发生的事情，但如果没有其他代码，则无法分辨）：

> 事件处理方法可能在另一个线程调用 Stop 方法或将 Enabled 属性设置为 false 的同时在一个线程上运行。这可能会导致在计时器停止后引发 Elapsed 事件。Stop 方法的示例代码显示了避免这种竞争条件的一种方法。

[http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)

# vba - 在 VB 中取消命名范围（Excel 2003，VB 6.5）

> ID：12900231
> 
> 赞同：0
> 
> 时间：2012-10-15T16:46:57.460
> 
> 标签：vba, excel, range, rename, excel-2003

如果单元格存在，我正在尝试取消命名范围。下面的代码找到具有正确名称的范围，但在 nm.Delete 行处爆炸，没有任何解释。我该如何修复/调试它？

谢谢！

```
Function unefineRange(strRgeName As String)
    Dim nm As Name
    For Each nm In ThisWorkbook.Names
        If nm.Name = strRgeName Then
            nm.Delete
        End If
    Next nm
End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:04:41.130

我刚刚在 Excel 2003 中运行它并且运行良好：

我创建了两个命名范围，Fred 和 Wilma，并在 Visual Basic 编辑器中运行它（模块 1）。毫无问题地删除了“Wilma”。

```
Function undefineRange(strRgeName As String)
    Dim nm As Name
    For Each nm In ThisWorkbook.Names
        If nm.Name = strRgeName Then
            nm.Delete
        End If
    Next nm
End Function

Sub unDefineRangePlease()
   undefineRange ("Wilma")
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T18:47:27.667

试试这个

```
Sub DeleteName(strRgeName As String)
    On Error Resume Next  ' so if name does not exist no error is raised
    ThisWorkbook.Names(strRgeName).Delete
End Sub 
```

我改为 a `Sub`，我认为没有理由成为 a `Function`，因为您没有设置返回值

# vb.net - 使用 DrawString 更改字符串的颜色？

> ID：12900235
> 
> 赞同：0
> 
> 时间：2012-10-15T16:47:20.453
> 
> 标签：vb.net, winforms, graphics, drawstring

我在 vb.net 中，正在尝试格式化打印文档。它在一个角落的不可协商属性之一是我必须有一个带有黑色背景和白色文本的字符串。我正在尝试使用 DrawString 并且可以更改画笔颜色，但无论如何我都看不到更改背景颜色。

有谁知道这是否可能，或者我是否必须做一些稍微复杂的事情，比如分两步画一个矩形并将其变为黑色，然后将带有白色画笔颜色的字符串放在它上面。

如果有人可以提供帮助，请提前致谢。

```
 Dim Lgraph As Graphics = e.Graphics

    Dim rec As System.Drawing.Rectangle
    rec.X = 30
    rec.Y = 0
    rec.Width = 70
    rec.Height = 50

    Lgraph.DrawRectangle(Pens.Black, balls)

    Lgraph.DrawString(lblSku.Text.Substring(3, 4), New Font("Arial", 18, FontStyle.Regular), Brushes.Blue, rec) 
```

这几乎可以满足我的要求，但是，我想用特定颜色填充矩形，因为 Pens.Black 只是使边框成为所选颜色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T16:53:23.463

恐怕您必须分两步完成，首先为矩形着色，然后向其中添加彩色文本。[Graphics.DrawString](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.drawstring%28v=VS.71%29.aspx)方法不允许您在调用中创建或操作矩形。幸运的是，它们确实允许您通过矩形，所以不应该太麻烦。

# iphone - Imageview 旋转需要将近一分钟

> ID：12900242
> 
> 赞同：0
> 
> 时间：2012-10-15T16:47:48.187
> 
> 标签：iphone, ios, cocoa-touch

在正在开发的 iPhone/iPad 应用程序中，正在使用以下代码旋转图像视图：

```
 if (myOrientation == UIInterfaceOrientationPortrait) {

        NSLog(@"portrait");

        self.imageViewPic.transform = CGAffineTransformMakeRotation(degreesToRadians(0));
        self.imageViewPic.bounds = CGRectMake(0.0f, 0.0f, [[UIScreen mainScreen] bounds].size.width,  [[UIScreen mainScreen] bounds].size.height);
        self.imageViewPic.center = CGPointMake(([[UIScreen mainScreen] bounds].size.height)/2, ([[UIScreen mainScreen] bounds].size.width)/2);
        [self.imageViewPic setFrame:CGRectMake(0.0,0.0,[[UIScreen mainScreen] bounds].size.width,[[UIScreen mainScreen] bounds].size.height)];
        self.imageViewPic.image = self.picture;

        self.imageViewBarTop.transform = CGAffineTransformMakeRotation(degreesToRadians(0));
        self.buttonHome.transform = CGAffineTransformMakeRotation(degreesToRadians(0));
       ....
    } 
```

imageViewPic（全屏尺寸）确实会旋转，但它发生在我实际旋转设备（iPhone/iPad） *“之后”几乎一分钟*，而相比之下，屏幕中的其他组件（例如，imageViewBarTop -> 这是屏幕顶部的一个栏，buttonHome -> 这是一个“主页”按钮）在设备旋转时*立即*旋转。为什么 imageViewPic 的旋转需要这么长时间（即使它的代码实际上*在*旋转其他组件的代码之前）？是不是因为imageViewPic占据了整个屏幕？非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:32:12.390

您是否有理由要手动转换图像？如果您要旋转视图中的所有内容，您可能只想旋转视图本身并为您的处理器节省大量工作！只需使用 willAnimateRotationToInterfaceOreintation 方法。

# php - PHP，使用命名参数调用 COM 对象函数

> ID：12900245
> 
> 赞同：1
> 
> 时间：2012-10-15T16:47:53.787
> 
> 标签：php, com

我正在使用 PHP 调用/操作 Word 文档，使用 COM。我正在做的一件事是将另存为文本格式。因为我正在处理许多 Word 文档，所以我不希望文档显示在最近的文件列表中。

VBA SaveAs 函数有一个可选参数来完成此操作，但我想知道，有没有一种方法可以将命名参数传递给 COM 对象，类似于您可以在 VBA 中执行的操作？

例如，在 Word 中，我可以这样写：

```
ActiveDocument.SaveAs(Filename:='mynewfilename.doc', FileFormat:=2, AddToRecentFiles:=False) 
```

有没有办法在 PHP 中使用 COM 对象来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:18:08.123

由于 PHP 不理解命名参数的概念（至少，不像 VB/A 那样），您必须尊重方法签名并以正确的顺序传递参数。

VB 命名参数的存在只是为了允许您以错误的顺序传递参数，但该方法仍然具有已定义的签名，并且您可以传递未命名的参数，只要它们以正确的顺序。

假设签名与[此处](http://msdn.microsoft.com/en-us/library/office/aa662158%28v=office.10%29.aspx)定义的签名相同，我想这应该可行：

```
$com->SaveAs('mynewfilename.doc', 2, NULL, NULL, FALSE); 
```

[[免责声明：我假设 PHP COM 会处理`NULL`并`FALSE`明智地处理 - 这可能是一个愚蠢的假设。]]

# django - Django 媒体上传到 AS3

> ID：12900257
> 
> 赞同：1
> 
> 时间：2012-10-15T16:48:41.453
> 
> 标签：django, amazon-s3, boto, django-storage

我正在尝试将所有 Django 媒体文件（从管理面板上传）上传到 Amazon S3。所以设置文件看起来像这样：

```
INSTALLED_APPS = (
'django.contrib.auth',
'django.contrib.contenttypes',
'django.contrib.sessions',
'django.contrib.sites',
'django.contrib.messages',
'django.contrib.staticfiles',
'django.contrib.admin',
'tastypie',
'core',
'advertisment',
'storages',

)

  DEFAULT_FILE_STORAGE = 'storages.backends.s3boto.S3BotoStorage'
  AWS_ACCESS_KEY_ID = 'xxx' 
  AWS_SECRET_ACCESS_KEY = 'xxx'
  AWS_STORAGE_BUCKET_NAME = 'media'
  MEDIA_URL = 'https://s3.amazonaws.com/%s/' % AWS_STORAGE_BUCKET_NAME 
```

当我尝试从管理面板上传文件时，出现以下错误：

```
S3ResponseError: 403 Forbidden 
```

我检查了[这个](https://stackoverflow.com/questions/10854095/boto-exception-s3responseerror-s3responseerror-403-forbidden)答案，但仍然没有帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T18:59:19.237

您是否安装了[boto](http://pypi.python.org/pypi/boto)，因为 django-storage 依赖于 boto ？

然后您必须将以下内容添加到您的 settings.py

```
import os

AWS_ACCESS_KEY_ID = os.environ.get('AWS_ACCESS_KEY_ID')
AWS_SECRET_ACCESS_KEY = os.environ.get('AWS_SECRET_ACCESS_KEY')
AWS_STORAGE_BUCKET_NAME = os.environ.get('S3_BUCKET_NAME')

STATICFILES_STORAGE = 'storages.backends.s3boto.S3BotoStorage'
DEFAULT_FILE_STORAGE = 'storages.backends.s3boto.S3BotoStorage'

STATIC_URL = 'http://' + AWS_STORAGE_BUCKET_NAME + '.s3.amazonaws.com/'
ADMIN_MEDIA_PREFIX = STATIC_URL + 'admin/' 
```

然后您的缓存将存储在 AWS S3 本身上。

我希望它有帮助

注意：出于安全原因，最好将您的 AWS_ACCESS_KEY_ID 和 AWS_SECRET_ACCESS_KEY 添加为环境变量，而不是直接将它们写在 setting.py 中。

# javascript - Raphael.js：为什么 SVG 位于左侧 -0.5px？

> ID：12900261
> 
> 赞同：4
> 
> 时间：2012-10-15T16:49:00.733
> 
> 标签：javascript, html, raphael

我正在开发的 Web 应用程序的一项功能允许将 DIV 内的图像替换为 SVG 的精确副本。这是使用 Raphael.js 库完成的。

Bellow 是这样一个包含图像的 HTML 元素的示例：

```
<div id="ow-0" reference="0" class="object-wrapper" style="z-index: 3; width: 231px; left: 116px; top: 217px; outline: rgb(0, 0, 0) solid 1px; ">
    <img id="o-0" reference="0" class="object image" src="image-gallery/intermediate/3295094303_2b50e5fe03_z.jpg" />
</div> 
```

调用名为 的方法时`addSVG()`，将图像父`div`对象设置为 Raphael 对象`paper`，并在隐藏原始图像后添加图像的 SVG：

```
 // Create the SVG and add it to the Viewport
            this.addSVG = function(){

                // Hide the HTML element before replacing it with the SVG
                $("#o-"+this.ref).hide();

                // Create the "paper" (svg canvas) before embedding the actual SVG
                this.canvas = new Raphael(document.getElementById("ow-"+this.ref), this.width, this.height);                

                if (this.type=="image" || this.type=="QR"){
                    this.svg = this.canvas.image(this.src,0,0,this.width,this.height);

                }
                else {

                }
            } 
```

几乎所有的东西都是完美的，除了 svg 的位置，它在左边 -0.5px （当然，这很烦人）。下面是操作后生成的 HTML 代码：

```
 <div id="ow-0" reference="0" class="object-wrapper" style="z-index: 3; width: 231px; left: 116px; top: 217px; outline: rgb(0, 0, 0) solid 1px; ">
        <svg style="overflow: hidden; position: relative; left: -0.5px; " height="170" version="1.1" width="231" xmlns="http://www.w3.org/2000/svg">
            <desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); ">Created with Raphaël 2.1.0</desc>
            <defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); "></defs>
            <image style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); " x="0" y="0" width="231" height="170" preserveAspectRatio="none" xlink:href="image-gallery/intermediate/3295094303_2b50e5fe03_z.jpg"></image>
        </svg>
        <img id="o-0" reference="0" class="object image" src="image-gallery/intermediate/3295094303_2b50e5fe03_z.jpg" style="display: none; ">
    </div> 
```

为什么要添加 -0.5px 以及如何防止它发生？顺便说一句，作为实验，我调整了浏览器窗口的大小，并且不再添加 -0.5px ......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-01T13:58:04.270

我发现解决此问题的唯一解决方案是将 SVG 的`top`和`left`属性（使用 CSS）显式设置为 0，并将 CSS 规则标记为`!important`.

```
svg {
   top: 0 !important;
   left: 0 !important;
} 
```

但是，我仍然不知道问题的原因，所以如果有人有答案，请与我们分享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:40:58.140

您需要调用 Paper.renderfix() 以在 IE9 和 Firefox 中修复此问题。

[http://raphaeljs.com/reference.html#Paper.renderfix](http://raphaeljs.com/reference.html#Paper.renderfix)

> Paper.renderfix()
> 
> 修复了 Firefox 和 IE9 关于亚像素渲染的问题。如果纸张在回流后依赖于其他元素，它可能会移动半个像素，从而导致线条失去清晰度。此方法解决了该问题。

# android - Phonegap 应用程序中的垂直间隙

> ID：12900263
> 
> 赞同：0
> 
> 时间：2012-10-15T16:49:15.010
> 
> 标签：android, html, css, cordova

我正在开发基于 Sencha Touch 2 和 Phonegap Cordova 的 Android 应用程序。

我有一个非常奇怪的错误，您可以在以下屏幕截图中看到：

![在此处输入图像描述](../Images/55b702d7fbbbed3e5b1b08876ff00ac3.png)

屏幕中间有一个垂直的缝隙，我不明白它是从哪里来的……

你有什么主意吗 ？

非常感谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T16:11:47.770

对于那些可能有同样问题的人来说，这似乎是 Android 4.1 引入的一个错误。

让我们希望它会在下一个 Android 版本中得到纠正。

# ruby - 验证数组是升序还是降序

> ID：12900275
> 
> 赞同：4
> 
> 时间：2012-10-15T16:49:42.567
> 
> 标签：ruby, arrays

我有一个包含日期的数组。

```
dates = [#<DateTime: 2002-07-01T00:00:00+00:00 ((2452457j,0s,0n),+0s,2299161j)>, #<DateTime: 2003-10-31T00:00:00+00:00 ((2452944j,0s,0n),+0s,2299161j)>, #<DateTime: 2003-12-01T00:00:00+00:00 ((2452975j,0s,0n),+0s,2299161j)>, #<DateTime: 2004-03-01T00:00:00+00:00 ((2453066j,0s,0n),+0s,2299161j)>, #<DateTime: 2004-03-01T00:00:00+00:00 ((2453066j,0s,0n),+0s,2299161j)>] 
```

如果它是升序还是降序，我如何检查这个数组的排序顺序？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-15T16:54:42.267

如果每两个相邻元素中的第一个小于或等于第二个，则数组是升序的：

```
def ascending? arr
  arr.each_cons(2).all?{|left, right| left <= right}
end 
```

或者（更漂亮但不幸的是更慢），您可以将数组与自身的排序版本进行比较：

```
def ascending? arr
  arr == arr.sort
end 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-15T18:33:04.440

以下是处理速度的一些基准测试结果：

```
require 'benchmark'
require 'date'

ary = (DateTime.parse('2002-07-01T00:00:00+00:00') .. DateTime.parse('2004-03-01T00:00:00+00:00')).to_a

def ascending1? arr
  arr.reduce{ |e1,e2| e1 <= e2 ? e2 : (return false) }; true
end

def ascending2? arr
  arr.each_cons(2).all?{|i,j| i <= j}
end

def ascending3? arr
  arr == arr.sort
end

n = 10_000
Benchmark.bm(9) do |b|
  b.report('reduce')    { n.times{ ascending1?(ary) } }
  b.report('each_cons') { n.times{ ascending2?(ary) } }
  b.report('sort')      { n.times{ ascending3?(ary) } }
end 
```

随着测试结果：

```
 user     system      total        real
reduce      1.380000   0.000000   1.380000 (  1.381107)
each_cons   2.250000   0.000000   2.250000 (  2.243958)
sort        0.670000   0.000000   0.670000 (  0.675025) 
```

* * *

以下是 2020 年的一些结果`ruby 2.7.1p83 (2020-03-31 revision a0c7c23c9c) [x86_64-darwin19]`：

```
 user     system      total        real
reduce      0.765766   0.000939   0.766705 (  0.767853)
each_cons   1.220724   0.001394   1.222118 (  1.223502)
sort        0.693166   0.009011   0.702177 (  0.702492) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-09-24T00:08:02.483

为什么不检查排序后的数组是否与未排序的数组相同？

`array == array.sort`用于上升

和`array == array.sort.reverse`下降

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T17:10:15.553

我认为`reduce`会比`each_cons`

```
def ascending? arr
  arr.reduce{ |e1,e2| e1 <= e2 ? e2 : (return false) }; true
end 
```

# excel - 要求用户使用 MATLAB 从 EXCEL 中选择所需的数据范围

> ID：12900278
> 
> 赞同：4
> 
> 时间：2012-10-15T16:49:53.323
> 
> 标签：excel, matlab, input, plot

为了使用 Matlab 在同一个 Excel 文件中绘制 Excel 中的数据，是否可以要求用户选择所需的范围而不是在 Matlab 代码中定义范围？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:07:14.540

是的，[XLSREAD](http://www.mathworks.com/help/matlab/ref/xlsread.html)提供了以交互方式加载数据的选项，尽管它仅适用于 Windows。

```
out = xlsread(fileName,-1); 
```

# jquery - jQuery Timer：在 x 开始一个事件并在 y 结束它

> ID：12900280
> 
> 赞同：0
> 
> 时间：2012-10-15T16:49:57.027
> 
> 标签：jquery, timer

我正在 jQuery（或插件！）中寻找计时器或函数，它允许我执行以下操作：“在 25 秒时，显示按钮 x，在 45 秒时显示按钮 y，在 55 时，停止显示 x，在 65 岁时，停止显示 y"。

看起来很简单，但我一直空着。我发现很多定时器会分派一个事件，但不会结束或隐藏它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T16:56:10.657

尝试

```
setTimeout(function() { /* code to show x */ }, 25000);
setTimeout(function() { /* code to show y */ }, 45000);
setTimeout(function() { /* code to hide x */ }, 55000);
setTimeout(function() { /* code to hide y */ }, 65000); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T16:59:56.177

如果您不介意自己计算事件之间的间隔：

```
$('#x').delay(25000).show().delay(30000).hide();
$('#y').delay(45000).show().delay(20000).hide(); 
```

或者，这是我刚刚敲出的一个插件：

```
(function($) {
    var t0 = null;

    $.fn.timerAt = function(t) {
        var self = this;
        return this.queue(function(next) {
            var t1 = Date.now();
            var delay = Math.max(0, t0 + t - t1);
            setTimeout(next, delay);
        });
    };

    $.timerReset = function() {
        t0 = Date.now(); // use a shim on older browsers
    };

    $.timerReset();

})(jQuery);

$('#x').timerAt(25000).hide('slow').timerAt(55000).show('fast');
$('#y').timerAt(45000).hide('slow').timerAt(65000).show('fast');​ 
```

# javascript - javascript运行时错误保存/恢复

> ID：12900286
> 
> 赞同：1
> 
> 时间：2012-10-15T16:50:32.793
> 
> 标签：javascript, html, css, runtime-error

我已经创建了这个代码，它用于在我按下保存时将表存储在一个变量中，并在我按下恢复时返回到该状态，但我似乎在最后一个代码上遇到了运行时错误（表的 ID 是数独）它适用于Firefox，但不适用于IE，谢谢

```
var clone
function save()
{
    var table = document.getElementById("sudoku")
    clone = table.innerHTML
}

function restore()
{
    document.getElementById("sudoku").innerHTML=clone
} 
```

**编辑**：错误消息：

```
Webpage error details User Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; CPNTDF; .NET4.0E; .NET4.0C; BOIE9;ENUS) Timestamp: Mon, 15 Oct 2012 16:57:44 UTC Message: Unknown runtime error Line: 50 Char: 128 Code: 0 URI: file:///F:/uni%20work/home/Second%20year/CO525/assessments/Assessment2/assessmen‌​t2/javascript.js Message: Unknown runtime error Line: 50 Char: 128 Code: 0 URI: file:///F:/uni%20work/home/Second%20year/CO525/assessments/Assessment2/assessmen‌​t2/javascript.js 
```

**编辑** 完整代码：

```
 var current_cell = null; // the currently selected cell
    var saved = {};     // Object for saving the current game
    function initialize() {
var col, row;
// Work through all the cells in the table and set
// onclick event handlers and classNames for the empty
// ones.
for (row = 0; row <=8; row++) {
    for (col=0; col <= 8; col++) {
        var cell = document.getElementById('cell_' + col + '_' + row);
        if (!parseInt(cell.innerHTML)) {
            // cell is empty
            cell.onclick = selectCell;
            cell.className = 'tofill';
        }
    }
}
document.onkeypress = keyPress;
save();
    }
    var current_cell = null; // the currently selected cell
    var saved = {};     // Object for saving the current game
    function initialize() {
var col, row;
// Work through all the cells in the table and set
// onclick event handlers and classNames for the empty
// ones.
for (row = 0; row <=8; row++) {
    for (col=0; col <= 8; col++) {
        var cell = document.getElementById('cell_' + col + '_' + row);
        if (!parseInt(cell.innerHTML)) {
            // cell is empty
            cell.onclick = selectCell;
            cell.className = 'tofill';
        }
    }
}
document.onkeypress = keyPress;
save();
    }

    // mouse button event handler
    function selectCell() {
if (current_cell !== null) {
    current_cell.className = 'tofill';
}
current_cell = this;
current_cell.className = 'selected';
    }

    // Capture keyboard key presses. If the key pressed is a digit
    // then add it to the current cell. If it is a space then empty
    // the current cell.
    function keyPress(evt) {
if (current_cell == null)
    return;
var key;
if (evt)
    // firefox or chrome
    key = String.fromCharCode(evt.charCode);
else
    // IE
    key = String.fromCharCode(event.keyCode);
if (key == ' ')
    current_cell.innerHTML = '';
else if (key >= '1' && key <= '9')
    current_cell.innerHTML = key;
    }

    var clone
    function save()
    {
    var table = document.getElementById("sudoku");
    clone = table.innerHTML;
    }

   function restore()
    {
    document.getElementById("sudoku").innerHTML=clone;
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:14:08.780

我假设`#sudoku`是一个`<table>`元素，不是吗？[Internet Explorer 不允许`innerHTML`在表格元素上设置属性](https://stackoverflow.com/q/4729644/1048572)。

相反，请使用适当的 DOM 方法，或者不要尝试存储 HTML 字符串，而是将数独的内容存储在二维数组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:16:07.930

`innerHTML`这是 IE 和使用该属性插入新 HTML 的长期问题。
（哎呀，谁会猜到，IE 有问题！！）

如果您愿意使用 jQuery，那么您可以使用...

```
$("#mytable").html(myHtml); 
```

否则，如果您可以以某种方式将 html 放入标签的`innerHTML`属性中，它应该可以工作。`<div>`

`document.createElement("TR");`另一种选择是使用编码风格自己创建单个对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:23:21.887

您可以使用 DOM 内置的 javascript 方法`cloneNode`来克隆您的节点。

例如

```
 var clone;
    function save()
    {
        var table = document.getElementById("sudoku");
        clone = table.cloneNode(true);
    }

    function restore()
    {
        document.getElementById("sudoku").parentNode.appendChild(clone);
    } 
```

参考：[https ://developer.mozilla.org/en-US/docs/DOM/Node.cloneNode](https://developer.mozilla.org/en-US/docs/DOM/Node.cloneNode)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-15T17:16:50.607

您添加的代码看起来不错，但我认为您在每个语句后都缺少分号。

```
    变种克隆；
    函数保存（）
    {
        var table = document.getElementById("sudoku");
        克隆 = table.innerHTML;
    }

    函数恢复（）
    {
        document.getElementById("sudoku").innerHTML=clone;
    }

```

你也可以通过 jQuery html 方法。如果您想了解更多关于 html() 函数的信息，请单击此处[jQuery html () 函数。](http://mycodeprograms.blogspot.com/2012/10/jquery-html-method.html)

例如

```
    `$('#sudoku').html(克隆);`

```

# php - 在表单和 URL 之间传输哈希

> ID：12900287
> 
> 赞同：0
> 
> 时间：2012-10-15T16:50:34.500
> 
> 标签：php, urlencode

每个用户都有他们 id 的哈希值，以允许我启动他们之间的连接。

因此，用户收到连接请求，他们首先获得带有想要连接的用户哈希的链接（connectID 是哈希）

例如

```
connect.html?connectID=8W7SBvYj7fnpu4+S4= 
```

所以我对此进行了urlencode，然后得到一个表格。我将 connectID 的值存储在隐藏字段中的表单中，但是当我查看源代码时，表单显示隐藏字段的值为

```
<input type="hidden" name="connectId" value="8W7SBvYj7fnpu4 S4="> (space where + was) 
```

我已经在隐藏字段上尝试了 urlencode 但这没有任何区别，如果我查看源代码它仍然是一样的

我怎样才能克服这个问题并保持它开始在 URL 和表单之间移动时的状态？

我需要它与它到达流程的最终处理部分时完全匹配我检查它与存储在 Mysql 数据库中的用户的哈希值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T16:52:43.953

> 我已经在隐藏字段上尝试了 urlencode

您必须在将数据放入 URI 之前对其进行编码，而不是在将其从 URL 中取出之后

```
$uri = "connect.html?connectID=" + urlencode('8W7SBvYj7fnpu4+S4='); 
```

# asp.net-mvc - FileContentResult 写入响应正文

> ID：12900289
> 
> 赞同：0
> 
> 时间：2012-10-15T16:50:44.920
> 
> 标签：asp.net-mvc, asp.net-mvc-3, download

为什么这会将“w，w，w”写入响应而不是打开保存文件对话框？

```
 [HttpPost]
    public ActionResult Export(int id)
    {            
        var contentType = "text/csv";
        var content = "w,w,w";
        var bytes = Encoding.UTF8.GetBytes(content);
        var result = new FileContentResult(bytes, contentType)
                {
                    FileDownloadName = "www.csv"
                };
        return result;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T16:55:08.567

因为它是 POST 而不是 GET。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T18:27:27.123

抱歉，我不能把这个作为评论放在问题中，你是如何打电话给控制器的？

# scala - Seq[Tuple2] 上的多重赋值

> ID：12900290
> 
> 赞同：0
> 
> 时间：2012-10-15T16:50:50.287
> 
> 标签：scala, collections, tuples, variable-assignment

在这里晃荡，似乎很简单。

有一个`Seq[Tuple2[A,B]]`，叫它 foo，我想把它提取`Tuple2`到一个`(Seq[A],Seq[B])`我可以做一个一站式商店多任务的地方。

```
val(a,b) = foo ?? 
```

尝试过地图、平面地图和其他失败的变体。

如果你愿意，请点亮;-)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T16:55:39.360

试试`unzip`。

文档将其指定为

```
def unzip[A1, A2](implicit asPair: (A) ⇒ (A1, A2)): (Seq[A1], Seq[A2]) 
```

所以你可以说`val (a, b) = foo.unzip`

要走另一条路（从`x: Seq[A]`和`y: Seq[B]`到`z: Seq[(A,B)]`），您可以使用`val z = x.zip(y)`.

# java - 规避默认的servlet java

> ID：12900294
> 
> 赞同：1
> 
> 时间：2012-10-15T16:51:07.440
> 
> 标签：java, xml, servlets, webserver, jetty

我的问题是所有请求都通过默认 servlet，如下所示：

```
DefaultServlet defaultServlet = new DefaultServlet();
ServletHolder holder = new ServletHolder(defaultServlet);
context.addServlet(holder, "/"); 
```

但是对于具体的请求，我需要有另一个映射。我怎样才能做到这一点？例如，`"/anotherMapping/"`不应该通过`DefaultServlet`. 我怎样才能使用java`import org.eclipse.jetty.*`而不更改`xml`文件来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T22:01:13.020

映射是具有级联优先级的规则引擎。

如果你把默认设置为最后一个，你应该没问题。

例如。

```
 context.addServlet(...., "/anotherMapping/*");
 context.addServlet(...., "/*") 
```

# c++ - 在模板结构外重载运算符

> ID：12900298
> 
> 赞同：4
> 
> 时间：2012-10-15T16:51:26.917
> 
> 标签：c++, function, templates

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T17:06:39.127

你的方法有两个问题。第一个是`_printnice`从属名称，因此您需要添加一个额外的`typename`. 如果解决了这个问题，你最终会得到：

```
template<class F>
ostream& operator << (ostream& os, typename CMPLX<F>::_printnice const & p) 
```

正如 Dietmar 在之前的回答中指出的那样，此代码的问题在于`F`它处于不可演绎的上下文中，这将失败。

一种简单的解决方案是在代码范围内定义运算符`_printnice`，其中`typename`：

```
template <class F>
struct CMPLX {
   //...
   struct _printnice {
      friend std::ostream& operator<<( std::ostream& o, _printnice const & p ) {
         // print here
         return o;
      }
   }
   //...
}; 
```

在 的定义中`_printnice`，类型被认为是一种类型，因此`typename`不再需要 。重载`operator<<`将由 Argument Dependent Lookup 找到，并且由于它引用了该类型的特定实例化，因此无需推导模板参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T16:59:25.927

在函数中：

```
template <typename F>
std::ostream& operator<<( std::ostream& os, CMPLX<F>::_printnice p); 
```

`F`不在可演绎的上下文中。（见§14.8.2.5。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:29:40.013

注意。这不是一个答案。大卫已经回答了。FWIW，只是修复了一些问题，因此它可以在 gcc 4.72 下编译和运行。

```
#include <iostream>
#include <stdio.h>
using namespace std;

template <class F>
struct CMPLX {

    F Re, Im;

    struct _printnice {

        F Re, Im;
        string sep;
        _printnice(const F& Re, const F& Im, const string& sep) : Re(Re), Im(Im), sep(sep) {}

        friend ostream& operator << (ostream& os, const _printnice& p){
            cout << p.Re << p.sep << p.Im;
            return os;
        }
    };

    CMPLX <F> (F Re, F Im) : Re(Re), Im(Im) {}

    _printnice PrintNice(const string& sep="\t"){
        return _printnice(Re, Im, sep);
    }

};

template<class F>
ostream& operator << (ostream& os, const CMPLX<F> c){
    cout << c.Re << " + " << c.Im << "i";
    return os;
}

int main() {
    CMPLX<float> c(2.0,1.0);
    cout << c << endl;
    cout << c.PrintNice() << endl;
}

//result
/*
2 + 1i
2       1
*/ 
```

# matlab - 错误：“您必须在不带输入参数的情况下调用 TOC 之前调用不带输出参数的 TIC。”

> ID：12900299
> 
> 赞同：5
> 
> 时间：2012-10-15T16:51:33.060
> 
> 标签：matlab, user-interface, time, error-handling

我在运行我的 gui 时遇到这个错误，我不明白它的含义以及如何解决它......有什么想法吗？

```
Error using toc
You must call TIC without an output argument before calling TOC without an
input argument.

 Error in hand_rotation2/youPress (line 126)
         c = toc;

 Error while evaluating figure KeyPressFcn 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T19:09:21.283

您可以通过`tic/toc`以下方式使用：

```
% tic without output argument
tic;
rand(10);
% toc without input argument
te=toc; 
```

或者

```
% tic with output argument
ts=tic;
rand(10);
% toc with input argument
te=toc(ts); 
```

您不能混合使用上述场景，例如，

```
ts=tic;
rand(10);
te=toc;   % wrong! toc must be called as toc(ts)

Error using toc
You must call TIC without an output argument before calling TOC without an input
argument. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-15T16:55:31.937

您正在使用 tic / toc matlab 函数，这些函数用于测量时间。该消息告诉您 toc 正在调用之前没有 tic 调用，您可以删除第 126 行或首先调用 tic。

# c# - ASP.net 中使用 Convert.toInt32 和 toString 的算术运算问题

> ID：12900300
> 
> 赞同：1
> 
> 时间：2012-10-15T16:51:37.527
> 
> 标签：c#, asp.net-mvc, razor, html.dropdownlistfor

我正在尝试这样做，但无论 x 是什么值，它都会返回 1024。

```
(Convert.ToInt32(x) * 1024).ToString() 
```

此行嵌入在一些剃刀代码中：

```
Html.DropDownListFor(
    m => m.AccountInfoModel.DiskSpace,
    Html.DropDownListFromComplexMember(m => m.AccountInfoModel.DiskSpace)
        .Split(',')
        .Select(x => new SelectListItem
        {
            Text = (Convert.ToInt32(x) * 1024).ToString(),
            Value = (Convert.ToInt32(x) * 1024).ToString()
        })) 
```

由于它是嵌入在另一个 lambda 表达式中的 lambda 表达式，因此我无法提取值并在行外进行计算。

有任何想法吗？

# string - 使用powershell比较字符串不起作用

> ID：12900305
> 
> 赞同：0
> 
> 时间：2012-10-15T16:51:50.533
> 
> 标签：string, powershell, compare

我正在尝试使用 powershell 比较字符串，但它没有按要求工作。

```
$compare_test = @(Get-Content compare_test.txt)
$test = @(Get-Content test.txt)
for ($c1 = 0; $c1 -lt $test.Length; $c1++) {
    $space_position = $test[$c1].IndexOf(" ")
    $leftpart = $test[$c1].Substring(0, $space_position)
    $rightpart = $test[$c1].Substring($space_position+1)
    $type_cast_rightpart = [int]$rightpart
    for ($c3 = 0; $c3 -lt $compare_test.Length; $c3++) {
        $space_position_2 = $compare_test[$c3].IndexOf(" ")
        $leftpart_2 = $compare_test[$c3].Substring(0, $space_position_2)
        $rightpart_2 = $compare_test[$c3].Substring($space_position_2+1)
        $type_cast_rightpart_2 = [int]$rightpart_2
        $same_server = $leftpart_2.CompareTo($leftpart)
        if ($same_server -eq 0) {
            if ($type_cast_rightpart -gt $type_cast_rightpart_2) {
                $entry_server_log = $leftpart + " " + $type_cast_rightpart
                $myarray += $entry_server_log
                break
            }
            else {
                $entry_server_log = $leftpart + " " + $type_cast_rightpart_2
                $myarray += $entry_server_log
                break
            }
        }
        elseif ($same_server -eq 1 -or $same_server -eq -1) {
            $entry_server_log = $leftpart_2 + " " + $type_cast_rightpart_2
            $myarray += $entry_server_log
            break
        }
    }
}
Set-Content compare_test.txt $myarray 
```

每次我尝试运行 powershell 脚本时，elseif 部分都会执行。test.txt 和 compare_test 都包含相同的字符串集，如下所示

```
NTHKGTBP126 2401
NTHKGTBP132 806 
```

等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:26:05.900

没有访问数据很难回答。你看过`Compare-Object`cmdlet 吗？

# android - 什么是在所有屏幕上一致地调整位图大小的万无一失的方法

> ID：12900306
> 
> 赞同：3
> 
> 时间：2012-10-15T16:51:51.783
> 
> 标签：android, image, bitmap

我的 Android 应用程序有需要在所有屏幕上准确测量的尺子，无论大小或密度如何。标尺是我通过设置为图像视图的可绘制资源`BitmapFactory`。

我最初的方法是将位图设置为一个图像视图，其相对`layout_width`值设置为固定的 50mm（底层 png 的精确宽度），其比例类型为`FIT_CENTER`.

因为我发现 Android 的预缩放非常令人沮丧，所以我尝试通过`android:anyDensity="true"`在清单中声明并结合使用`BitmapFactory`option来禁用此过程`inScaled = "false"`。

我使用的标尺位图是 320dpi png，所有尺寸均为 50 毫米宽。我的想法是提供一个高分辨率图像，该图像可以很容易地缩小到低密度屏幕上所需的确切宽度。

上述方法已在几乎所有经过 Beta 测试的设备上成功运行。但在 HTC Evo 4G 上，标尺显得太大。后者运行 Android 2.3.5 的设备是迄今为止唯一报告的失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:17:26.180

我的设备上的 Android 2.3.5 也有同样的问题，通过手动重新缩放所有图像来解决。我的图像是在运行时设置到 ImageView 中的，所以以前重新缩放图像对我来说不是问题。

```
byte[] icon = Icon.getIcon(mContext.getFilesDir());
        Bitmap bitmap = BitmapFactory.decodeByteArray(icon, 0, icon.length);
        int width = LicenseDialog.convertDpToPx(mContext, 48);
        ByteArrayOutputStream stream = new ByteArrayOutputStream();
        Bitmap.createScaledBitmap(bitmap, width, width, true).compress(CompressFormat.PNG, 100, stream);
        icon = stream.toByteArray(); 
```

# mysql - 添加了两个子查询以添加不返回记录的复杂 mySQL 查询

> ID：12900307
> 
> 赞同：0
> 
> 时间：2012-10-15T16:51:53.483
> 
> 标签：mysql, count, subquery

我有这段代码，并且它们都单独工作，所以我认为它一定是错误放置的语法：

```
SELECT i.*, o.organ_name, o.organ_logo, vtable.*, cc.ccount
FROM heroku_056eb661631f253.op_ideas i
JOIN 
```

以上收集了 op_ideas 表中的所有记录。

```
(SELECT v.idea_Id,
    COUNT(v.agree = 1 or null) as agree,
    COUNT(v.disagree = 1 or null) as disagree,
    COUNT(v.obstain = 1 or null) as abstain
FROM op_idea_vote v
GROUP BY v.idea_id
) AS vtable ON vtable.idea_id = i.idea_id 
```

然后上面搜索另一个表并计算每条记录的投票并将其添加到行中。

```
JOIN 
(SELECT ccc.idea_id AS cid, COUNT(ccc.idea_id = 1 or null) AS ccount 
FROM op_comments ccc
GROUP BY idea_id
) AS cc ON cid = i.idea_id 
```

以上计算了idea_id附加了多少评论并将其添加到主行。

```
LEFT JOIN op_organs o ON i.post_type = o.organs_id 
```

以上将另一个表连接到现有行，该行可能为空白，也可能不为空白

```
WHERE idea_geo = 'International'; 
```

上面的国际被替换为可以等于：本地、区域、国家或国际的变量。

**问题**：查询触发但返回为空，但如果单独放置它们可以工作。有人可以指出我正确的方向。

这是帮助阅读它的完整代码：

```
Here is another issue, I think I have placed the code in the wrong place.  Wanting to add another sub SELECT to count how many comments are per idea:

SELECT i.*, o.organ_name, o.organ_logo, vtable.*, cc.ccount
FROM heroku_056eb661631f253.op_ideas i
JOIN
(SELECT v.idea_Id,
    COUNT(v.agree = 1 or null) as agree,
    COUNT(v.disagree = 1 or null) as disagree,
    COUNT(v.obstain = 1 or null) as abstain
FROM op_idea_vote v
GROUP BY v.idea_id
) AS vtable ON vtable.idea_id = i.idea_id
JOIN 
(SELECT ccc.idea_id AS cid, COUNT(ccc.idea_id = 1 or null) AS ccount 
FROM op_comments ccc
GROUP BY idea_id
) AS cc ON cid = i.idea_id
LEFT JOIN op_organs o ON i.post_type = o.organs_id
WHERE idea_geo = 'International'; 
```

提前致谢。

**编辑新解决方案**

感谢 WayneC 和 Conrad，我们有一个完整的工作查询。

这是代码：

```
SELECT i.*, o.organ_name, o.organ_logo, vtable.*
FROM heroku_056eb661631f253.op_ideas i
LEFT JOIN
(SELECT v.idea_Id, cc.*,
    COUNT(v.agree = 1 or null) as agree,
    COUNT(v.disagree = 1 or null) as disagree,
    COUNT(v.obstain = 1 or null) as abstain
FROM op_idea_vote v 
LEFT JOIN 
    (SELECT idea_id AS id,COUNT(*) AS ccount 
    FROM op_comments cco
    GROUP BY cco.idea_id
    ) AS cc ON cc.id = v.idea_id
GROUP BY v.idea_id
) AS vtable ON vtable.idea_id = i.idea_id
LEFT JOIN op_organs o ON i.post_type = o.organs_id
WHERE idea_geo = 'International'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T19:32:47.547

答案如下：

```
SELECT i.*, o.organ_name, o.organ_logo, vtable.*
FROM heroku_056eb661631f253.op_ideas i
LEFT JOIN
  (SELECT v.idea_Id, cc.*,
    COUNT(v.agree = 1 or null) as agree,
    COUNT(v.disagree = 1 or null) as disagree,
    COUNT(v.obstain = 1 or null) as abstain
    FROM op_idea_vote v 
LEFT JOIN 
  (SELECT idea_id AS id,COUNT(*) AS ccount 
    FROM op_comments cco
    GROUP BY cco.idea_id
    ) AS cc ON cc.id = v.idea_id
  GROUP BY v.idea_id
  ) AS vtable ON vtable.idea_id = i.idea_id
  LEFT JOIN op_organs o ON i.post_type = o.organs_id
WHERE idea_geo = 'International'; 
```

# r - 构建 RF 时下标越界

> ID：12900319
> 
> 赞同：0
> 
> 时间：2012-10-15T16:52:52.437
> 
> 标签：r, random-forest

我正在尝试基于 r 中的随机森林构建分类器。

重现此的代码：

```
 library(quantmod)
    library(randomForest)

    getSymbols('^GSPC', from="2002-01-01") 
    GSPC <- GSPC[,1:5] # remove adjusted close
    GSPC$wkret <- lag(GSPC$GSPC.Close,-5)/GSPC$GSPC.Close # build weekly future return
    GSPC$wkret <- GSPC$wkret * 100 -100 # build index

    cutoff <- floor(dim(GSPC)[1]/4) # select the row at 25%
    cutoffbreak <- sort(abs(as.data.frame(GSPC$wkret)[,1]),decreasing=T)[cutoff] # get the top 25% return in absolute terms
    y <- cut(GSPC$wkret, breaks=c('-100',-cutoffbreak,cutoffbreak ,'100'),labels=c('down','','up')) # build factors 
    randomForest(GSPC[1:100],y[1:100]) # select first 100 to exclude NA's, dimension problems. 
```

这有效：

```
y[1:100]
[1]                                                                                      down      down down
 [22]                up   up        down      down                          up   up   up   up 
=== zip ===

> is.factor(y)
[1] TRUE

> x[1:100]
              open    high     low   close     volume
2002-01-02 1148.08 1154.67 1136.23 1154.67 1171000000
2002-01-03 1154.67 1165.27 1154.01 1165.27 1398900000
2002-01-04 1165.27 1176.55 1163.42 1172.51 1513000000
2002-01-07 1172.51 1176.97 1163.55 1164.89 1308300000
=== zip ===

> class(x)
[1] "xts" "zoo" 
```

这有效（但当然没有意义）：

```
lm(y[1:100] ~ .,data=x[1:100]) 
```

但是建立一个随机森林会给出：

```
> rf <- randomForest(y[1:100] ~ .,data=x[1:100])
Error in randomForest.default(m, y, ...) : subscript out of bounds

> traceback()
4: randomForest.default(m, y, ...)
3: randomForest(m, y, ...)
2: randomForest.formula(y[1:100] ~ ., data = x[1:100])
1: randomForest(y[1:100] ~ ., data = x[1:100]) 
```

谷歌搜索说这是一个尺寸问题，但无法弄清楚为什么/如何。

r 版本：

> R.version _
> platform i686-pc-linux-gnu
> arch i686
> os linux-gnu
> system i686, linux-gnu
> status
> major 2
> minor 15.1
> year 2012
> month 06
> day 22
> svn rev 59600
> language R
> version.string R version 2.15.1 (2012 -06-22) 昵称烤棉花糖

库版本：

```
 randomForest version: "2.15.1"
    quantmod version: "2.15.1" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T17:33:25.620

我创建 y 时出了点问题。当我添加此代码时，代码运行良好：

```
 y <- as.factor(as.numeric(y)) 
```

我不知道我的 y 值有什么问题，但我认识到只有在我提供完整代码时才能重现。

```
 > randomForest(na.omit(GSPC),y[1:2713])
    Error in randomForest.default(na.omit(GSPC), y[1:2713]) : 
      subscript out of bounds
    > y <- as.factor(as.numeric(y))
    > randomForest(na.omit(GSPC),y[1:2713])

    Call:
     randomForest(x = na.omit(GSPC), y = y[1:2713]) 
                   Type of random forest: classification
                         Number of trees: 500
    No. of variables tried at each split: 2

            OOB estimate of  error rate: 0.07%
    Confusion matrix:
        1    2   3 class.error
    1 348    1   0 0.002865330
    2   0 2034   0 0.000000000
    3   0    1 329 0.003030303 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T16:58:56.583

使用公式和数据参数调用 randomForest 非常常见，但`x[1:100]`它不是矩阵，而是向量。我想你的意思是`x[1:100,]`。

此外，数据的参数应该是数据框，而不是矩阵。我假设 x 是一个矩阵（而不是一个数据框），`x[1:100]`否则会返回以下错误消息：

```
Error in `[.data.frame`(x, 100) : undefined columns selected 
```

或者，根据评论的建议，您也可以运行

```
randomForest( x[ 1:100, ], y[ 1:100 ] ) 
```

# sql-server - 简单连接失败时的 SQL

> ID：12900320
> 
> 赞同：0
> 
> 时间：2012-10-15T16:52:54.667
> 
> 标签：sql-server, tsql

我需要在文档中显示产品数据，包括产品 url 信息（可以找到产品的页面）。在我的开发机器上，我有一个相当成功的脚本。我遇到的问题是，当我在本地将相同的脚本很好地移动到生产机器上时，代码会运行，但只有一些产品显示了它们的 Url 信息。连接很简单

```
Select 
    A.ID, A.Case, B.Val, B.Unit, B.Url
from A  
left join B on A.onID = B.UID 
```

请对可能的问题有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:44:13.627

由于您正在执行左连接，我希望某些数据不会有 URL，因为它来自 tableB，它不需要返回表 A 中的记录的数据。这意味着表 A 中的每条记录都没有表 B 中的等效记录。

# c# - 使用是或否选项填充单选按钮列表，并在单击时保存到数据库

> ID：12900325
> 
> 赞同：1
> 
> 时间：2012-10-15T16:53:16.430
> 
> 标签：c#, dataset, radiobuttonlist

C# 代码。我之前填充了复选框，但没有填充单选按钮。这是一个示例页面：

```
<asp:Content ID="Content" runat="server" ClientIDMode="Static">
    <asp:UpdatePanel ID="category" runat="server">
        <ContentTemplate>
            <div>
                <span>Data:</span>
                <asp:TextBox ID="txBox" runat="server" TextMode="MultiLine">
                </asp:TextBox>
            </div> 
            <!-- Need to add this to populate from dataset, and save to database table -->     
            <asp:RadioButtonList ID ="radioButtonList" runat="server" AutoPostBack="true"
                OnSelectedIndexChanged="RadioButtonList1_SelectedIndexChanged"  >
                <asp:ListItem ID="isEnabledTrue">Yes</asp:ListItem>
                <asp:ListItem ID ="isEnabledFalse" Selected="True">No</asp:ListItem>           
            </asp:RadioButtonList>    
        </ContentTemplate>
    </asp:UpdatePanel>
</asp:Content> 
```

如何以相同的方式填充 radioButtonList。返回的表/数据集为 Name : NVARCHAR(25) isEnabled: 1/0 - BIT

如何将“isEnabled”数据集附加到 radioButtonList 控件。我还需要监视对 radioButtonlist 控件的更改并保存到数据库。

因此，我有两种方法与需要的控件关联： 从数据库填充值：DataSet 中的 TextBox 和 RadioButtonList 将值保存到数据库：选中 TextBox 和 RadioButton，以保存到表中。

如果这不起作用，我的替代方法是从数据库中获取 XML，然后从这个 XML 结构构造一个 XSLt。如果需要，我可以添加通过 AJAX 调用数据库的事件，以保存更新的单选按钮/文本框。我需要额外的代码来确保 javascript 方法也能正常工作。只是想在采用 XML 方式之前测试数据集方法..

我的 aspx.cs 代码隐藏执行此操作。

```
protected void Page_Load(object sender, EventArgs e)
{
    Populate();
}

private void Populate()
{
    DataSet dataSet = CustomCode.GetDataSet(somethingPassedIn);
    DataRow row = dataSet .Tables["Table1"].Rows[0];
    txBox.Text = row["Name"].ToString();
    //How to populate RadioButtonList with Yes/No checked appropriately? 
    //A bit column of 1/0 is returned per what needs to be checked 
    //(1=> Yes should be selected, 0=>No should be selected) 
}

protected void RadioButtonList1_SelectedIndexChanged(object sender, EventArgs e)
{
    SaveData(); 
}
private void SaveData()
{
    CustomCode.SaveData(txBox.Text.Trim(), radioButtonList?);       
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:02:15.470

捆绑：

```
if((bool)row["IsEnabled"])
{
    radioButtonList.SelectedValue = "Yes";
}
else
{
    radioButtonList.SelectedValue = "No";
} 
```

保存：

```
bool isEnabled;
if(radioButtonList.SelectedValue = "Yes")
{
    isEnabled = true;
}
CustomCode.SaveData(txBox.Text.Trim(), isEnabled); 
```

# typescript - TypeScript - 从另一个 JavaScript 文件初始化属性

> ID：12900328
> 
> 赞同：1
> 
> 时间：2012-10-15T16:53:22.983
> 
> 标签：typescript, firebase

我同时使用 TypeScript 和 Firebase。

我的班级`fireybase: FirebaseInterface;`有财产。

当我使用初始化它时`this.fireybase = new Firebase('URL/');`

我收到有关该`Firebase`对象的编译时错误。

```
The name 'Firebase' does not exist in the current scope

interface FirebaseInterface {
    set(s:string): any;
} 
```

我尝试将 Firebase 接口添加到库中，但它仍然不喜欢它。

在 TypeScript 中执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T18:28:03.737

typescript 编译器告诉你它无法找到类型`Firebase`，所以你需要引入它。在您的情况下，如果 firebase 库的提供者想要支持 Typescript 中的开发，他们将需要提供一个声明文件来指定类型`Firebase`（和依赖类型）。在您的情况下，一个简单的`Firebase.d.ts`文件可能如下所示：

**Firebase.d.ts**

```
declare class Firebase {    
    constructor(u:string);    
    set(s:string): any;
} 
```

然后，您需要使用引用声明将声明文件纳入范围，如下所示：

**MyApp.ts**

```
///<reference path='firebase.d.ts'/>
class MyApp {  
    fireybase: Firebase;  
    constructor () => {
        this.fireybase = new Firebase('URL/');
    }
} 
```

[您可以在语言规范](http://go.microsoft.com/fwlink/?LinkId=267238)中阅读有关声明文件和引用路径的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:15:45.280

我认为您需要引用包含 Firebase 静态定义的模块。也许一个快速的解决方法是在文件顶部使用以下语句：

`declare var Firebase: any;`

# c++ - 调试 C++ 互斥体时截断调用堆栈

> ID：12900329
> 
> 赞同：0
> 
> 时间：2012-10-15T16:53:26.573
> 
> 标签：c++, qt, mutex, callstack

在尝试追踪被阻塞的互斥体时，调用堆栈似乎在等待互斥体时被截断。我没有看到正常的调用图，只有以下内容：

0 CpupSyscallStub wow64cpu 0x75132e09
1 Thunk0ArgReloadState wow64cpu 0x75132bf1
2 RunCpuSimulation wow64 0x751ad07e
3 Wow64LdrpInitialize wow64 0x751ac549
4 LdrpInitializeProcess ntdll 0x77984956
5 ::FNODOBFM::`string' ntdll 0x77981a17
6 LdrInitializeThunk ntdll 0x7796c32e

这阻碍了 QMutex，我正在使用来自 MSVC2008 的 CDB 与 Qt Creator 一起开发。我希望能够看到一个“正常”堆栈，这是一个直到 mutex.lock() 调用点的调用图。如果我不得不猜测，这将与在 64 位机器上调试 32 位应用程序有关。关于如何获得正确的调用堆栈的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-02T16:38:59.260

这个链接简要地谈到了这个问题。[Qt Windows 调试](http://qt-project.org/wiki/Qt_Creator_Windows_Debugging)

这不是 Qt 或 Qt Creator 特定的问题。CDB.exe，Windows 命令行调试器（类似于 GDB），内置两个版本，32 位和 64 位。在 32 位 CDB 上调试 32 位应用程序时，应用程序堆栈看起来正常。在 64 位 CDB 上调试 32 位应用程序时，堆栈会被 32 位仿真器混淆。

# javascript - 如何在 JavaScript 中舍入数百万和数千？

> ID：12900332
> 
> 赞同：7
> 
> 时间：2012-10-15T16:53:34.470
> 
> 标签：javascript, jquery, rounding, number-formatting, shorthand

我正在尝试对大数字进行舍入。例如，如果我有这个号码：

`12,645,982`

我想四舍五入这个数字并将其显示为：

`13 mil`

或者，如果我有这个号码：

`1,345`

我想将其四舍五入并将其显示为：

`1 thousand`

如何在 JavaScript 或 jQuery 中执行此操作？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-06-05T22:01:29.843

这是一个格式化数千、数百万和数十亿的实用程序函数：

```
function MoneyFormat(labelValue) 
  {
  // Nine Zeroes for Billions
  return Math.abs(Number(labelValue)) >= 1.0e+9

       ? Math.abs(Number(labelValue)) / 1.0e+9 + "B"
       // Six Zeroes for Millions 
       : Math.abs(Number(labelValue)) >= 1.0e+6

       ? Math.abs(Number(labelValue)) / 1.0e+6 + "M"
       // Three Zeroes for Thousands
       : Math.abs(Number(labelValue)) >= 1.0e+3

       ? Math.abs(Number(labelValue)) / 1.0e+3 + "K"

       : Math.abs(Number(labelValue));

   } 
```

用法：

```
 var foo = MoneyFormat(1355);
   //Reformat result to one decimal place
   console.log(parseFloat(foo).toPrecision(2) + foo.replace(/[^B|M|K]/g,"")) 
```

**参考**

*   [ECMAScript-5：附件 A](http://interglacial.com/javascript_spec/annexa.html)

*   [在 JavaScript 中显示数字](http://www.2ality.com/2012/03/displaying-numbers.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-06-16T10:20:11.483

数字 JS .. 如果有人检查这个，请检查数字 Js。您只需要包含脚本，然后只包含一行代码

```
numeral(yourNumber).format('0.0a') 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-15T17:13:55.890

```
var lazyround = function (num) {
    var parts = num.split(",");
    return parts.length > 1 ? (Math.round(parseInt(parts.join(""), 10) / Math.pow(1000, parts.length-1)) + " " + ["thousand", "million", "billion"][parts.length-2]) : parts[0];
};

alert(lazyround("9,012,345,678"));
alert(lazyround("12,345,678"));
alert(lazyround("345,678"));
alert(lazyround("678")); 
```

它输出这个：

```
9 billion
12 million
346 thousand
678 
```

玩得开心。这很好用，因为我没有看到你自己做了任何事情，所以这被混淆了。

在 jsfiddle 中有一个工作示例：[jsfiddle.net/p8pfB/](http://jsfiddle.net/p8pfB/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-08-26T15:42:41.587

@Paul 的回答很棒，但它给出了 773.282600918 M 等。

我们可能不希望它用于大数字。使用 Math.round() 修复

```
function moolah_round(num,locale='en') {
    // Nine Zeroes for Billions
    return Math.abs(Number(num)) >= 1.0e+9
        ? Math.round(Math.abs(Number(num)) / 1.0e+9 ) + " B"
        // Six Zeroes for Millions
        : Math.abs(Number(num)) >= 1.0e+6
            ? Math.round(Math.abs(Number(num)) / 1.0e+6 ) + " M"
            // Three Zeroes for Thousands
            : Math.abs(Number(num)) >= 1.0e+3
                ? Math.round(Math.abs(Number(num)) / 1.0e+3 ) + " K"
                : Math.abs(Number(num)); 
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-15T17:02:00.817

```
var number = 1345;
var zeroCount = 3;
var roundedNumber = Math.round( number / Math.pow(10,zeroCount) ) 
```

只需将 zeroCount 调整为 3 表示数千，6 表示数百万等。我假设您可以使用 if 语句并且只需要一些数学函数的帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-02-19T16:33:35.250

保罗斯威特的回答很好

迪帕克托马斯的回答很好

我的答案是更灵活/可定制且更易于阅读，所以这里是：

**代码**

```
function NumbFormat(options) {

  let number = Math.abs(Number(options.number));

  // Nine zeros for Billions
  if (Number(number) >= 1.0e+9) {
    return (number / 1.0e+9).toFixed(options.billion.decimal) + ` ${options.billion.unit}`;
  }

  // Six zeros for Millions
  if (Number(number) >= 1.0e+6) {
    return (number / 1.0e+6).toFixed(options.million.decimal) + ` ${options.million.unit}`;
  }

  // Thrhee zeros for Thousands
  if (Number(number) >= 1.0e+3) {
    return (number / 1.0e+3).toFixed(options.thousand.decimal) + ` ${options.thousand.unit}`;
  }

  return number;
}

console.log(NumbFormat({
  'number': 100000000,
  'billion': {
    'decimal': 1,
    'unit': 'B',
  },
  'million': {
    'decimal': 1,
    'unit': 'M',
  },
  'thousand': {
    'decimal': 1,
    'unit': 'K',
  },
}));

console.log(NumbFormat({
  'number': 100000000,
  'billion': {
    'decimal': 1,
    'unit': 'B',
  },
  'million': {
    'decimal': 1,
    'unit': 'Million',
  },
  'thousand': {
    'decimal': 1,
    'unit': 'K',
  },
}));

console.log(NumbFormat({
  'number': 100000000,
  'billion': {
    'decimal': 1,
    'unit': 'B',
  },
  'million': {
    'decimal': 0,
    'unit': 'Million',
  },
  'thousand': {
    'decimal': 1,
    'unit': 'K',
  },
}));

console.log(NumbFormat({
  'number': 100000000,
  'billion': {
    'decimal': 1,
    'unit': 'B',
  },
  'million': {
    'decimal': 0,
    'unit': 'M',
  },
  'thousand': {
    'decimal': 1,
    'unit': 'K',
  },
}));
```

使用上面的代码，您可以控制数十亿、数百万或数千的小数位数，您还可以控制要显示的单位 :)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-15T16:55:04.223

用途`str.length` 和`switch`情况

```
var number=12345; 
```

像这样的东西

```
switch (number.length) {
  case 4:
    alert(number/10000+"Thousand");
    break;

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-07-06T15:54:14.270

这是对 Deepak Thomas 答案的改进。

它在必要时处理小数，并提供更多的可读性和对函数的控制。

运行代码片段以查看显示其用法的 5 警报实时演示。

```
function numRound(num) {
  num = Math.abs(Number(num))
  const billions = num/1.0e+9
  const millions = num/1.0e+6
  const thousands = num/1.0e+3
  return num >= 1.0e+9 && billions >= 100  ? Math.round(billions)  + "B"
       : num >= 1.0e+9 && billions >= 10   ? billions.toFixed(1)   + "B"
       : num >= 1.0e+9                     ? billions.toFixed(2)   + "B"
       : num >= 1.0e+6 && millions >= 100  ? Math.round(millions)  + "M"
       : num >= 1.0e+6 && millions >= 10   ? millions.toFixed(1)   + "M"
       : num >= 1.0e+6                     ? millions.toFixed(2)   + "M"
       : num >= 1.0e+3 && thousands >= 100 ? Math.round(thousands) + "K"
       : num >= 1.0e+3 && thousands >= 10  ? thousands.toFixed(1)  + "K"
       : num >= 1.0e+3                     ? thousands.toFixed(2)  + "K"
       : num.toFixed()
}

alert(numRound(1234))
alert(numRound(23456))
alert(numRound(345678))
alert(numRound(4567890))
alert(numRound(56789012))
```

# c++ - 在 Windows-8 64 位操作系统上注册 COM Dll 失败

> ID：12900337
> 
> 赞同：1
> 
> 时间：2012-10-15T16:53:44.470
> 
> 标签：c++, visual-c++, com, windows-8

我的 C++ COM Shell Extension DLL 使用 Visual Studio 2010 在 Windows 7 64 位系统上构建。DLL 注册失败，当我尝试在 Windows 8 64 位评估版上注册我的 dll 时

我做了以下步骤来注册我的 Dll

1.  创建了一个文件夹，如 C:\MyDll
2.  将 COM dll 和依赖 DLL 复制到名为 MyDll 的文件夹（依赖 Dll：MSVCP.Dll、MSVCR.dll、System.Data.SQLite.DLL）
3.  以管理员身份打开 Cmd.exe
4.  执行以下命令 C:\Windows\System32>regsvr32 C:\MyDll\Test64.dll

我注册步骤提示错误信息：

> 模块“C:\MyDll\Test64.dll”加载失败。确保二进制文件存储在指定路径或对其进行调试以检查二进制文件或相关 .DLL 文件是否存在问题。动态链接库 (DLL) 初始化例程失败

应用程序事件查看器错误日志：

> 错误应用程序名称：regsvr32.exe，版本：6.2.9200.16384，时间戳：0x5010a4f2 错误模块名称：未知，版本：0.0.0.0，时间戳：0x00000000 异常代码：0xc0000005 错误偏移量：0x000000008003f038 错误进程 id：0xef0时间：0x01cdab0260bf6785 错误应用程序路径：C:\Windows\system32\regsvr32.exe 错误模块路径：未知报告 ID：9e7efd80-16f5-11e2-be6f-bcaec589de41 错误包全名：错误包相对应用程序 ID：

在此先感谢您的帮助。

# php - PHP 方法的最佳 DRY 方法 2 级深度一个类？

> ID：12900341
> 
> 赞同：1
> 
> 时间：2012-10-15T16:53:48.583
> 
> 标签：php, class, methods, syntax

我在一个大类中工作，它是应用程序的骨干之一，我们称之为`myClass`. 我需要为这个类创建一个新的公共方法，并让它接受一个变量数组，该数组调用我正在编写的函数的各个方法：`my_new_iterative_function()`......从某种意义上说，我需要一个“类中的类” " (javascript 很适合这个 ;) ... 我怎样才能实现以下目标，我迭代`$fallback_order`参数数组以更改调用这些方法的顺序，然后有一个默认顺序，如果`$fallback_order`为 false则执行默认参数？

```
class myClass {
    public function existing_app_method_1() {
        // other code
    }
    public function existing_app_method_2() {
        // other code
    }
    // large app-centric class with many more methods

    public function my_new_iterative_function( array $fallback_order = false ) {
        method_foo() {
            // do stuff
        }
        method_bar() {
            // do stuff
        }
        method_more_methods() {
            // there are at least 5 of them in total
        }

        if ( $fallbackorder == false ):
            method_foo();
            method_bar();
        else:
            foreach ( $fallback_order as $index => $this_fallback ) {
                $name = $this_fallback;
                if ( $this_fallback == $name ):
                    $this->$name();
                endif;
            }
        endif;
    }
} 
```

视图模板中的目标如下：

`<div><?php $myClass->my_new_iterative_function( array( 'method_more_methods', 'method_bar', 'method_foo', ) ); ?></div>`

编辑：修复了一些明显错误的逻辑

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:10:37.830

您可以将方法作为匿名函数放在方法内的数组中，并使用输入索引这些数组，如下所示：

```
class Foo {
    private $stuff = 'tickle me elmo';        

    public function my_new_iterative_function(array $fallback_order = array('method_foo', 'method_bar')) {

        $self = $this; // this acts as a keyword, you can't use in the `use ()` part

        $order_functions = array(
            'method_foo' => function() use ($self) {
                print "im in foo: {$self->stuff}<br>";
            },
            'method_bar' => function(){
                print "im in bar<br>";
            },
        );

        foreach ( $fallback_order as $index => $this_fallback ) {
            $order_functions[$this_fallback]();
        }
    }
}
(new Foo)->my_new_iterative_function(); // look, one-line `new` and method call, since php 5.4
(new Foo)->my_new_iterative_function([ 'method_bar', 'method_foo', ]); // and even [] for array literals too! 
```

我还在默认参数中嵌入了默认顺序。（当您将其作为数组输入时将其设置为 false 是一个致命错误）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T00:28:18.907

我意识到你已经接受了一个很好的答案，我应该说我不太了解 PHP，但我想我可能会插话，因为我已经考虑了一点.

我想知道将您迭代的方法中的逻辑抽象为单独的[命令](http://en.wikipedia.org/wiki/Command_pattern)是否会更整洁（具有明显的优势，您可以在不触及迭代代码的情况下添加更多方法，并且您将最小化添加到您的额外代码的数量大班）。然后，您可以将默认顺序数组设置为的属性，`myClass`但如果需要，可以在`my_new_iterative_function`方法的参数中覆盖它（或者，可能更好，通过 setter on `myClass`）。

原谅代码，但像这样：

```
class myClass 
{

    // override default order via class setter if required
    protected $fallback_order = array(new FooCommand(), new BarCommand(), new ANOtherCommand());

    public function my_new_iterative_function(  ) {

            foreach ( $this -> fallback_order as $value ) {
                $value -> execute();
            }
    }
} 
```

或者可能是这样的：

```
class MyClass 
{

    // override default order in method invokation if required
    protected $default_fallback_order = array(new FooCommand(), new BarCommand(), new ANOtherCommand());

    public function my_new_iterative_function( $fallback_order = null ) {

            // Use default fallback order if an override has not been 
            // specified in method parameter
            if (is_null($fallback_order))
                $fallback_order = $this -> default_fallback_order;

            foreach ( $fallback_order as $value ) {
                $value -> execute();
            }
    }
}

$myClass = new MyClass();
$myClass -> my_new_iterative_function(); // use default fallback order
$myClass -> my_new_iterative_function(array(new ANOtherCommand(), new BarCommand(), new FooCommand())); 
```

# c++ - 使用 const & 打印出 List

> ID：12900350
> 
> 赞同：0
> 
> 时间：2012-10-15T16:54:28.567
> 
> 标签：c++, list, reference, constants

嘿，我有一个包含值的列表，我想使用 const & 将其打印出来。我可以通过引用它来做到这一点，但是当我把 const 放进去时，我得到了一个错误。我不确定为什么会这样，因为代码不会编辑列表。这是我的代码。

```
// Prints out the list declared
template<typename DATA_TYPE>
    void print(const list<DATA_TYPE> &myList){
    for(list<DATA_TYPE>::iterator pos = myList.begin(); pos != myList.end(); pos++){
        DATA_TYPE currentWord = *pos;
        cout << currentWord << " ";
    }
} 
```

如果您还可以了解错误背后的逻辑，那就太好了，谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T16:56:17.177

由于您`list`的声明为`const`，因此您需要使用`const_iterator`：

```
list<DATA_TYPE>::const_iterator pos 
```

ps 为了将来参考，请复制并粘贴您在问题中遇到的任何编译器错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T16:55:29.927

使用`const_iterator`，而不是迭代器。

# git - 如何显示按作者日期过滤的日志？

> ID：12900355
> 
> 赞同：2
> 
> 时间：2012-10-15T16:54:47.973
> 
> 标签：git

我正在处理一个导入到 git 的存储库，并且所有提交者日期都是错误的（5 年以上压缩到 2 天）。我已经读过，默认情况下 git log`--since='...'`将使用提交者日期进行过滤，因此结果对我来说毫无用处，我的命令如下所示：

```
$ git log --since='2011-09-21' --pretty=format:"%aD,%h,%s" --author='Zeo' myfile.cpp 
```

是否有一个开关可以`--since`使用作者日期而不是提交者日期？

我到处搜索，但找不到。

[编辑] 在此类导入使用后将所有作者日期重写为提交者日期：

```
$ git filter-branch --env-filter 'export GIT_COMMITTER_DATE="$GIT_AUTHOR_DATE"' 
```

来自：[https ://gist.github.com/568898](https://gist.github.com/568898)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T18:17:59.433

我从 2009 年的 git 列表中找到了这个，

```
git log --format='%H %at' |
perl -ane '
BEGIN {
use DateTime::Format::Natural;
$max_age = DateTime::Format::Natural->new->parse_datetime(
"last friday"
)->epoch;
}
print $F[0], "\n" if $F[1] < $max_age;
' 
```

# xml - 用编号的项目解析“XML”

> ID：12900357
> 
> 赞同：0
> 
> 时间：2012-10-15T16:54:50.510
> 
> 标签：xml

我遇到了一个看起来像这样的“XML”片段（缩进和缩写 -`...`代表更多标签）：

```
<items>"Std Stability"
  <items[1]>
    <id>-2</id>
    ...
  </items[1]>
  <items[2]>
    <id>-5</id>
  </items[2]>
  ...
</items> 
```

这些`[1]`数字阻塞了我正在使用的解析器（[lxml](http://lxml.de/)）。是否有一些类似的格式有效？还是我必须编写一个自定义解析器来处理它？

我对格式没有任何控制权，文档实际上并没有描述或命名格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:13:16.043

这不是一个有效的 Xml 文档，您将无法使用任何符合 Xml 的解析器来处理它。我以前没有见过这样的格式，所以我不知道你会用什么工具来处理这个。我假设他们有一个“自制的”Xml-ish 解析器，您可能希望使用它来读取它。从 Xml 的角度来看 - 在这种情况下，您总是希望将输入固定在源头。想出在您这边解决这样的问题以使其有效的 xml 通常会导致问题。

# colors - 以编程方式在电子表格中设置边框颜色和样式

> ID：12900359
> 
> 赞同：21
> 
> 时间：2012-10-15T16:54:53.107
> 
> 标签：colors, google-apps-script, border, google-sheets

Google 电子表格在工具栏下的边框按钮下还有一个用于更改颜色和更改边框样式的按钮。

如何在 Google Apps 脚本中访问这些内容？

`setBorderColor`为文档描述的功能似乎不适用于电子表格。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2016-01-12T21:14:18.220

[截至 2016 年 1 月 12 日](https://code.google.com/p/google-apps-script-issues/issues/detail?id=2002#c26)，报告的问题已得到修复。Range 现在有以下方法：

*   [setBorder(top, left, bottom, right, vertical, Horizo​​ntal)](https://developers.google.com/apps-script/reference/spreadsheet/range#setbordertop-left-bottom-right-vertical-horizontal)和以前一样。
*   [setBorder（上，左，下，右，垂直，水平，颜色，样式）](https://developers.google.com/apps-script/reference/spreadsheet/range#setbordertop-left-bottom-right-vertical-horizontal-color-style)，**新！**

文档中提供了示例；以下是如何设置红色虚线边框^*：

```
var ss = SpreadsheetApp.getActiveSpreadsheet();
var sheet = ss.getSheets()[0];

var cell = sheet.getRange("B2");
// Sets borders on the top and bottom, but leaves the left and right unchanged
// Also sets the color to "red", and the border to "DASHED".
cell.setBorder(true, null, true, null, false, false, "red", SpreadsheetApp.BorderStyle.DASHED); 
```

* * *

^*更正，根据评论：*文档是错误的，它应该是 SpreadsheetApp.BorderStyle.DASHED/DOTTED/SOLID，而不是 Range。——戈多弗里茨*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-11-05T15:09:45.963

目前 setBorder() 属性不允许我们提供颜色和样式。您可以[在此处](https://code.google.com/p/google-apps-script-issues/issues/detail?id=2002)关注一个未解决的问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-06-19T13:26:03.630

你可以做一个小技巧。将彩色边框单元格中的格式复制到您想要的任何位置。

```
var ss = SpreadsheetApp.getActiveSpreadsheet();
var source = ss.getSheets()[0];
var destination = ss.getSheets()[1];

var blueBorderRange = source.getRange("B2:D4");

// This copies the formatting in B2:D4 from the source sheet to
// D4:F6 in the second sheet
blueBorderRange.copyFormatToRange(destination, 4, 6, 4, 6); 
```

# php - 限制返回的结果

> ID：12900365
> 
> 赞同：0
> 
> 时间：2012-10-15T16:55:18.613
> 
> 标签：php, codeigniter

控制器

```
elseif($type == 'high'){
        //Get Urgent Projects
        $this->session->set_userdata('show_num','5');
        $page_rows = $this->session->userdata('show_num');

        $urgent_conditions = array('projects.project_status' => '0','budget_max >=' => '10');
        $order = array('budget_max','DESC');
        $this->outputData['listProjects']   = $this->skills_model->getProjects($urgent_conditions,NULL,NULL,NULL,$order);
        $this->outputData['title'] = 'High Budget Projects';
        $this->outputData['viewall'] = 'high_budget';
    }
    $this->load->view('listProjects',$this->outputData); 
```

模型

```
 function getProjects($conditions=array(),$fields='',$like=array(),$limit=array(),$orderby = array())
 {
    //Check For Conditions
    if(is_array($conditions) and count($conditions)>0)      
        $this->db->where($conditions);

    //Check For like statement
    if(is_array($like) and count($like)>0)      
        $this->db->like($like); 

    //Check For Limit   
    if(is_array($limit))        
    {
        if(count($limit)==1)
            $this->db->limit($limit[0]);
        else if(count($limit)==2)
            $this->db->limit($limit[0],$limit[1]);
    }   
    //pr($orderby);
    //Check for Order by
    if(is_array($orderby) and count($orderby)>0)
        $this->db->order_by($orderby[0], $orderby[1]);

    $this->db->from('projects');
    $this->db->join('users', 'users.id = projects.creator_id','left');
    //Check For Fields   
    if($fields!='')
            $this->db->select($fields);
    else        
        $this->db->select('projects.id,projects.project_name,projects.project_status,projects.description,projects.budget_min,projects.budget_max,projects.project_categories,projects.creator_id,projects.is_feature,projects.is_urgent,projects.is_hide_bids,projects.created,projects.attachment_name,projects.attachment_url,users.user_name,projects.enddate,projects.programmer_id,projects.project_award_date,projects.project_award_date,projects.contact,projects.salary,projects.flag,projects.escrow_due,users.id as userid,projects.checkstamp,projects.provider_rated,projects.buyer_rated,projects.project_paid,projects.is_private,projects.private_users,users.user_rating,users.num_reviews,users.email'); 
    $result =$this->db->get();

    return $result;

 }//End of getProjects Function 
```

我面临的问题是无法限制返回的结果数量，因为对于这个“HIGH” $type ，没有任何设置内置。对于另一个 $type 在管理面板中有一个设置，其中包含一些如何许多人返回。无论如何我可以在这里插入一个 LIMIT 数字来强制它返回固定数量的结果吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T05:08:09.257

您的方法有第四个参数来传递自定义限制，但它是数组，因此传递如下

```
//this is limit 0,5
$this->skills_model->getProjects($urgent_conditions,NULL,NULL,array(5),$order);

//this is limit 5,20
$this->skills_model->getProjects($urgent_conditions,NULL,NULL,array(5,20),$order); 
```

# google-chrome-extension - 401 在空闲时间后使用 OAuth2.0 时凭据无效

> ID：12900366
> 
> 赞同：0
> 
> 时间：2012-10-15T16:55:21.700
> 
> 标签：google-chrome-extension, oauth-2.0

我正在阅读Boris Smus 的[此页面](http://smus.com/oauth2-chrome-extensions/)并尝试实施，一切正常。唯一的问题是，请求在一段时间后失败。我正在使用 googleapis。一旦我安装了我的测试扩展并尝试发出一些 googleapi 请求，它们就通过了。但是一段时间后，当我尝试相同的方法时，它们失败了。在 background.js NET 选项卡中，我看到以下响应。

```
{ "error": { "errors": [ { "domain": "global", "reason": "authError", "message": "Invalid Credentials", "locationType": "header", "location": "Authorization" } ], "code": 401, "message": "Invalid Credentials" } } 
```

如果我只是重新加载我的扩展程序，一切都会再次正常工作。我认为这与 accesstoken 有关，但不确定如何/在哪里修复它。

另外，我从 background.js 页面的控制台选项卡中观察到，当一切正常时，google.isAccessTokenExpired() 会导致“假”。当一切都失败时，它返回 TRUE。我在哪里/如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-30T10:00:45.477

对我来说，它适用于 userinfo API。但不适用于联系人 API。通过将联系人的 URL 从 http 更改为 https 解决了该问题

所以我使用的网址： https: [//www.googleapis.com/m8/feeds/contacts/default/full](https://www.googleapis.com/m8/feeds/contacts/default/full)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:25:58.710

解决了！添加了以下代码。

```
if(google.isAccessTokenExpired()) { 
    google.authorize(function() { myFunc(info); } );
} 
```

不知道为什么它在一段时间前不起作用。现在它的工作。

# php - “命令行参数无效”错误 - 仅适用于 Outlook。使用 PHP 创建电子邮件消息

> ID：12900369
> 
> 赞同：0
> 
> 时间：2012-10-15T16:55:33.943
> 
> 标签：php, outlook

我希望用户能够单击将打开桌面默认电子邮件程序并填充新电子邮件的链接。然后，用户可以进一步修改电子邮件并将其发送。我的编码已经完美运行了一年多。这仍然适用于 Thunderbird，但最近，使用 Outlook 作为其默认电子邮件程序的用户收到以下消息：

“无法启动 Microsoft Office Outlook。命令行参数无效。验证您正在使用的开关。”

任何人都知道这个问题，并希望它的解决方案？我假设我需要在创建链接的 PHP 编码中进行更正。这是它的胆量：

```
echo '<td colspan=2><a href="';
echo 'mailto:'.$row[10].'?subject=Item Request&body='.$body;
echo '">Contact Owner</td>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:00:35.257

链接的路径组件`mailto:`需要[`urlencode()`](http://php.net/urlencode)像任何其他 URL 一样是 d：

```
echo '<td colspan=2><a href="';
echo htmlspecialchars('mailto:'.urlencode($row[10]).'?subject=Item%20Request&body='.urlencode($body));
echo '">Contact Owner</td>'; 
```

请注意，要在 HTML 文档上输出的任何动态字符串也应该通过[`htmlspecialchars()`](http://php.net/htmlspecialchars).

# java - IDEA：javac：源版本 1.7 需要目标版本 1.7

> ID：12900373
> 
> 赞同：502
> 
> 时间：2012-10-15T16:55:45.080
> 
> 标签：java, intellij-idea

使用 IntelliJ IDEA 运行 JUnit 测试时，我得到

![在此处输入图像描述](../Images/b4378ef2d4abb96d1d0af25a6e7ef89e.png)

我该如何纠正？

*   使用 SDK 1.7
*   模块语言级别为 1.7

Maven 构建工作正常。（这就是为什么我在 IDEA 配置问题中相信这一点）

* * *

## 回答 #1

> 赞同：767
> 
> 时间：2012-10-15T17:26:27.350

您很可能在此处从 Maven 导入了不正确的编译器选项：

![编译器选项](../Images/86b825a35529c827213966bb2abf30f5.png)

还要检查屏幕截图中列出的项目和模块字节码（**目标）版本设置。**

**其他配置源**语言级别的地方：

*   项目结构 | **项目**

[![项目](../Images/d7c3867bb00da540496b99847b060a35.png)](https://i.stack.imgur.com/7nKEx.png)

*   项目结构 | 模块（检查每个模块）| **来源**

[![来源](../Images/336b919f998a66239b13426184e907f3.png)](https://i.stack.imgur.com/h7OtW.png)

Maven**默认语言级别**为**1.5** (5.0)，您将在上面的屏幕截图中看到此版本为模块语言级别。

这可以使用里面[的 maven-compiler-plugin](https://maven.apache.org/plugins/maven-compiler-plugin/examples/set-compiler-source-and-target.html)配置来改变`pom.xml`：

```
<project>
  [...]
  <build>
    [...]
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <configuration>
          <source>1.8</source>
          <target>1.8</target>
        </configuration>
      </plugin>
    </plugins>
    [...]
  </build>
  [...]
</project> 
```

或者

```
<project>
  [...]
  <properties>
    <maven.compiler.source>1.8</maven.compiler.source>
    <maven.compiler.target>1.8</maven.compiler.target>
  </properties>
  [...]
</project> 
```

[在Maven 项目](https://www.jetbrains.com/help/idea/2016.3/maven-projects-tool-window.html)工具窗口中**重新导入**Maven 项目后，IntelliJ IDEA 将遵循此设置：

[![重新导入](../Images/848c534505cf31f4270f0848632f0a56.png)](https://i.stack.imgur.com/OJgF6.png)

* * *

## 回答 #2

> 赞同：359
> 
> 时间：2014-01-18T21:02:30.467

# IntelliJ 15、2016 和 2017

与下面讨论的 IntelliJ 13 和 14 类似，但在 Settings/Preferences 面板中有一个额外的级别：*Settings* > *Build, Execution, Deployment* > *Compiler* > *Java Compiler*。

[![在此处输入图像描述](../Images/c931abe7b294e382771e93400c37c3f6.png)](https://i.stack.imgur.com/mlaEJ.png)

# 智能 13 和 14

在 IntelliJ 13 和 14 中，检查*Settings > Compiler > Java Compiler* UI 以确保您没有针对模块中的不同字节码版本。

![在此处输入图像描述](../Images/2f1b4604a89c5b480a30fb06f9523642.png)

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2015-04-07T22:12:01.553

在**IntelliJ IDEA 14.1**中，“目标字节码版本”位于不同的位置。

以下更改对我有用：

**文件 > 设置... > 构建、执行、部署 > 编译器 > Java 编译器**：将**目标字节码版本**从 1.5 更改为 1.8

![在此处输入图像描述](../Images/e56ec448d4fbbcce316d70cb0009b719.png)

![在此处输入图像描述](../Images/ce52414d6e644d85aa3daf92326174f5.png)

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2013-08-25T11:29:45.997

如果您使用 maven 3 和 JDK 7，您是否查看过您的构建配置

```
<build>
    <finalName>SpringApp</finalName>
    <plugins>
        <plugin>
            <artifactId>maven-compiler-plugin</artifactId>
            <configuration>
                <source>1.7</source>
                <target>1.7</target>
            </configuration>
        </plugin>
        ...
    </plugins>
    ...
</build> 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2012-12-13T04:20:09.930

我遇到了这个问题，解决方法是转到项目设置 > 模块 > 单击特定模块 > 依赖项选项卡。我注意到模块 SDK 仍然设置为 1.6，我将其更改为 1.7 并且它工作。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2013-06-15T10:57:29.253

*在我的情况下，我在设置 > 编译器 > java 编译器*中找到了必需的选项（'目标字节码版本'）（intelij idea 12.1.3）

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2015-06-08T14:14:17.240

修改项目的编译器设置文件如下路径，将'target'改为1.7：

> /project/.idea/compiler.xml

```
<bytecodeTargetLevel>
  <module name="project-name" target="1.7" />
</bytecodeTargetLevel> 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-12-20T12:08:13.193

我通过将字段设置为空白来解决它：

设置 > 编译器 > Java 编译器 > 项目字节码版本

比 IntelliJ 使用 JDK 默认版本。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-07-20T09:31:40.880

从某一刻到另一刻，我也没有明确的原因得到这个错误。我更改了编译器/模块等的各种设置。但最后我只是通过重新导入 Maven 项目重新创建了 IntelliJ 项目，问题就解决了。我认为这是一个错误。

智能 12 129.961

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-04-06T08:58:52.170

在从 IntelliJ IDEA 14 小幅升级到 v14.1 之后，我就遇到了这个问题。对我来说，更改顶部/父 pom 的编辑有帮助，然后单击重新导入 Maven（如果它不是自动的）。

但是右键单击模块/聚合/父模块和 Maven -> 重新导入可能就足够了。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-12-12T06:29:59.920

我解决了以下方法

文件>>项目结构>>项目>>项目语言级别->设置正确的版本（例如：1.5）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-08-24T00:49:56.260

检查 .idea/misc.xml 有时您需要手动更改 languageLevel="JDK_1_X" 属性

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-04-12T01:14:53.793

如果是 Gradle 项目，请在 build.gradle 文件中搜索以下设置：

```
sourceCompatibility = "xx"
targetCompatibility = "xx" 
```

对于所有子项目，在您的根 build.gradle 文件中，您可以输入：

```
subprojects { project ->
    sourceCompatibility = "1.7"
    targetCompatibility = "1.7"
} 
```

虽然您可以在 Idea > Settings 中手动设置语言级别，但如果是 Gradle 项目，Idea 会自动从 Gradle 设置中同步模块 .iml 文件（使用 Idea 15+ 测试）。因此，当 gradle 刷新时，您的所有手动更改都会被覆盖。

根据[Gradle 文档](https://docs.gradle.org/current/userguide/java_plugin.html)，如果未设置这些，则使用当前 JVM 配置。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-06-24T17:59:02.103

我找到了另一种遇到此错误的方法。如果您一直在重新组织您的目录结构，并且您的一个 pom 指向不再配置 javac 的旧父级（因为该配置已移至中间级别），您可以获得此信息。如果发生这种情况，顶层默认为 1.5，行为不端的低层 pom 会继承它。

因此，当您看到此错误时要检查的另一件事是您的 pom 结构与您的目录结构正确匹配。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-07-27T09:20:57.917

如果 Maven 构建工作正常，请尝试同步 Maven 和 IntelliJ IDEA 项目的结构。

在[Maven 工具窗口](https://www.jetbrains.com/help/idea/maven-projects-tool-window.html)中，单击刷新按钮[![刷新](../Images/a617265a26af035ca13a9d5c5257d8be.png)](https://i.stack.imgur.com/KupZQ.png)。按下此按钮后，IntelliJ IDEA 会在 Maven 工具窗口中解析项目结构。

请注意，如果您使用 EAP 构建，这可能无济于事，因为 Maven 同步功能有时可能会被破坏。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-04-23T12:13:20.367

如果以前的所有解决方案都没有为您工作（这是我的情况），您可以删除 intellij 配置文件：

*   project_directory/.idea/compiler.xml
*   project_directory/.idea/encodings.xml
*   项目目录/.idea/misc.xml
*   项目目录/.idea/modules.xml
*   项目目录/.idea/vcs.xml
*   项目目录/.idea/workspace.xml
*   等等

Intellij 稍后会重新生成新的。 **但是，请注意，这也会删除在 projet 上进行的所有 intellij 配置（即：调试模式的配置，...）**

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-10-08T10:15:44.503

您需要在构建配置中更改 Java 编译器版本。

[![在此处输入图像描述](../Images/1c39a87f922868a1eefe71145744133f.png)](https://i.stack.imgur.com/qTqUc.png)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-11-09T22:39:55.753

确保选择了正确的依赖关系。文件 > 项目结构

选择您的项目并导航到 Dependencies 选项卡。从下拉列表中选择正确的依赖关系或创建新的。

# azure - Azure - Windows Azure 虚拟机问题

> ID：12900375
> 
> 赞同：0
> 
> 时间：2012-10-15T16:55:56.987
> 
> 标签：azure

我的虚拟机出现故障，有没有办法弄清楚为什么机器没有响应？我无法连接到 VM，因为 RDP 似乎没有响应。在这种情况下有哪些选择，或者可以采取哪些预防措施来防止这种情况在未来发生？

谢谢，

史蒂夫·阿米蒂奇

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:51:24.180

如果您遇到这种情况，您无能为力，只能联系[Microsoft 支持](https://www.windowsazure.com/en-us/support/contact/)。我一直发现它们很有帮助，但您确实需要注意，对问题的根本原因分析有时可能需要一段时间。至于防止这个问题再次发生，这取决于问题。我遇到过两个这样的情况，一次是因为我们的代码中的内存泄漏，所以这是我可以修复的，另一个是只有 MS 可以修复的，所以很难说。

# c# - 我需要能够取消只读取数据的长时间运行的 NHibernate 查询

> ID：12900380
> 
> 赞同：1
> 
> 时间：2012-10-15T16:56:31.217
> 
> 标签：c#, nhibernate

所以我搜索了互联网和 SO，但我似乎无法找到我的问题的答案。我看到一些地方人们可以取消事情，因为他们正在使用 IQueryable 但在我的情况下，我有一个存储库并且我正在返回一个列表，但我希望能够取消对仅返回数据的查询的调用 -嗯，我不知道我解释得很好。希望这个代码片段应该更清楚。

```
 public class EdiRepository : GenericRepository<EdiEventLog, Guid>, IEdiRepository
{
    private readonly ISessionStorage _sessionStorage;
    private ISession _session;

    public EdiRepository(ISessionStorage sessionStorage)
        : base(sessionStorage)
    {
        _sessionStorage = sessionStorage;
    }

    public void Cancel()
    {
        //Uhm, this doesn't seem like the right thing to do. 
        _session.Dispose();
    }

    public IList<EdiEventLog> GetAllLogs(List<String> eventTtypes)
    {
        _session = GetSession();

        var query = from q in _session.Query<EdiEventLog>()
                    where eventTtypes.Contains(q.EventType)
                    select q;

        return query.ToList();
    }
} 
```

如果这是多余的并且我刚刚错过了它，请指出我正确的方向，但我所看到的一切都假设您正在返回并且 IQueryable 不是列表。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T11:44:34.137

调用`_session.CancelQuery();`（当然来自不同的线程，因为您的查询线程将在查询调用时被阻塞）。它将抛出数据库特定的查询取消异常。

请注意，这仅在您的查询仍在数据库上运行时才有效。如果查询调用已经从返回的数据创建 .NET 对象，它不会取消任何内容。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-16T12:00:53.987

我会实现我自己的取消方法，它会更快地返回部分结果

```
public IEnumerable<IList<EdiEventLog>> GetAllLogs(List<String> eventTtypes)
{
    _session = GetSession();
    const int pagesize = 1000;
    int page = 0;
    var query = from q in _session.Query<EdiEventLog>()
                where eventTtypes.Contains(q.EventType)
                orderby q.Id   // to make sure repeated queries return consistent results
                select q;

    IList<EdiEventLog> results;
    do
    {
        results = query.Skip(page * pagesize).Take(pagesize).ToList();
        page++;
    } while(results.Count > 0);
} 
```

并使用它

```
foreach(var someLogs in GetAllLogs(eventTypes))
{
    AddToGui(someLogs);
    if (userCanceled)
        break;
} 
```

# c# - 如何确定队列中待处理操作的进度？

> ID：12900382
> 
> 赞同：1
> 
> 时间：2012-10-15T16:56:45.630
> 
> 标签：c#, asp.net, .net, wcf, msmq

我想使用 MSMQ 队列来处理对 XML 数据文件的大量操作。如果我正确理解该技术，任务将被传递到队列，它们将由处理程序获取。另外，如果这样的任务很多，handler 会一个一个地抓任务。因此，有一些待处理的任务只是在队列中等待处理程序。

因此，我还应该以百分比显示在网站上处理上传的 XML 文件的进度。问题是我如何才能证明真正没有开始处理的待处理任务的进展。

## 后编辑

反映处理某些任务的进度的常规方法是通过某个令牌（之前生成的客户端）请求服务返回一定百分比的完整性。然后把它写在网站上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:02:25.233

您可以双向打开队列，让处理程序将答案传回给发送者。

MSMQ 可以被不同的进程使用，甚至可以在不同的计算机上运行。这是一种将长时间运行的作业从当前进程中卸载的方法，例如服务。

如果该服务关闭，您的客户端将不知道它，它甚至不应该关心，因为 MSMQ“保证”工作将完成。考虑在这种情况下使用跟踪进度有多少？（除了观察到服务*可能*已经死了）

如果您只是想做一些简单的异步工作，我建议您查看 Task 类并离开 MSMQ。

# facebook - Facebook Like 按钮不发布

> ID：12900385
> 
> 赞同：1
> 
> 时间：2012-10-15T16:56:51.327
> 
> 标签：facebook, button, facebook-like

我有一个网站的快照版本，我正在使用新的喜欢按钮，至少尝试这样做。

类似系统运行良好。我什至可以像我一样保存每次点击的次数。但是，我无法弄清楚为什么每次我尝试发布（使用单击“赞”按钮后打开的对话框）时，内容都不会出现在我的活动或其他任何地方。

这是我正在使用的示例代码：

```
<fb:like layout="button_count" href="http://www.podeir.com.br/brasilia/agenda/visualizar/id_agenda/2/AERO-GROOVE" send="false" width="194" show_faces="false" font="tahoma"></fb:like> 
```

只是注意到：我的喜欢按钮计数正在增长。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:01:20.743

[Facebook 会在调试器结果](https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.podeir.com.br%2Fbrasilia%2Fagenda%2Fvisualizar%2Fid_agenda%2F2%2FAERO-GROOVE)中告诉您问题所在。

您的`og:image`标签必须是完全限定的 URL（例如以 开头`http://`）

# java - 在 Java 中，如何从 ArrayList 中删除重复项 有效率的？

> ID：12900389
> 
> 赞同：0
> 
> 时间：2012-10-15T16:56:58.530
> 
> 标签：java, arrays, arraylist, stringbuilder, duplicate-removal

我尝试使用`HashSet`从`ArrayList<StringBuilder>`.

例如这里是一个`ArrayList`，每一行都是一个`StringBuilder`对象。

```
"u12e5 u13a1 u1423"
"u145d"
"u12e5 u13a1 u1423"
"u3ab4 u1489" 
```

我想得到以下信息：

```
"u12e5 u13a1 u1423"
"u145d"
"u3ab4 u1489" 
```

我目前的实现是：

```
static void removeDuplication(ArrayList<StringBuilder> directCallList) {
    HashSet<StringBuilder> set = new HashSet<StringBuilder>();
    for(int i=0; i<directCallList.size()-1; i++) {
        if(set.contains(directCallList.get(i)) == false)
            set.add(directCallList.get(i));
    }   
    StringBuilder lastString = directCallList.get(directCallList.size()-1);
    directCallList.clear();
    directCallList.addAll(set);
    directCallList.add(lastString);
} 
```

`ArrayList`但随着规模的增长，性能变得越来越差。这个实现有什么问题吗？或者在性能方面你有更好的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-15T17:05:15.197

StringBuilder 没有实现 equals() 或 hashcode()。两个 StringBuilder 仅当它们是完全相同的对象时才相等，因此将它们添加到 HashSet 不会排除两个具有相同内容的不同 StringBuilder 对象。

您应该将 StringBuilders 转换为 String 对象。

此外，您应该在构造函数中使用“初始容量”初始化 HashSet。如果您正在处理大量对象，这将有助于提高速度。

最后，在添加对象之前不必在哈希集上调用 contains()。只需将您的字符串添加到集合中，集合就会拒绝重复项（并将返回 false）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T17:09:00.140

让我们分析您的方法以找到可以改进的地方：

```
static void removeDuplication(ArrayList<StringBuilder> directCallList) {
    HashSet<StringBuilder> set = new HashSet<StringBuilder>();
    for(int i=0; i<directCallList.size()-1; i++) {
        if(set.contains(directCallList.get(i)) == false)
            set.add(directCallList.get(i));
    } 
```

这个 for 循环对`ArrayList`. 对于手头的任务，这似乎是不可避免的。但是，由于`HashSet`每个项目只能包含一项，因此该`if`语句是多余的。`HashSet.add()`再次进行完全相同的检查。

```
 StringBuilder lastString = directCallList.get(directCallList.size()-1); 
```

我不明白需要`lastString`从您的列表中获取然后添加它。如果您的循环正常工作，它应该已经被添加到`HashSet`.

```
 directCallList.clear(); 
```

根据列表的实现，这`O(n)`可能需要很长时间，因为它可能需要访问列表中的每个元素。

```
 directCallList.addAll(set); 
```

同样，这需要`O(n)`时间。如果没有重复项，则`set`包含原始项目。

```
 directCallList.add(lastString); 
```

这条线似乎是一个逻辑错误。您将添加一个`String`已经存在`set`并添加到`directCallList`. }

所以总的来说，这个算法需要`O(n)`时间，但有一个常数因子`3`。如果你能减少这个因素，你就可以提高性能。一种方法是简单地创建一个新的`ArrayList`，而不是清除现有的。

此外，如果您使用正确的构造函数并返回没有重复项`removeDuplication()`，则可以在一行中编写此函数：`ArrayList`

```
static List<StringBuilder> removeDuplication(List<StringBuilder> inList) {
    return new ArrayList<StringBuilder>(new HashSet<StringBuilder>(inList));
} 
```

当然，这仍然没有解决`StringBuilder`其他人指出的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T17:20:41.453

所以你有一些其他的选择，但我喜欢我的解决方案简短、简单、中肯。我已将您的方法更改为不再操纵参数，而是返回一个新的`List`. 我用 a`Set<String>`查看每个的内容`StringBuilder`是否已经包含并返回唯一`String`的 s。我还使用了 for each 循环而不是按索引访问。

```
static List<StringBuilder> removeDuplication(List<StringBuilder> directCallList) {
    HashSet<String> set = new HashSet<String>();
    List<StringBuilder> returnList = new ArrayList<StringBuilder>();
    for(StringBuilder builder : directCallList) {
        if(set.add(builder.toString())
            returnList.add(builder);
    }   
    return returnList;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T17:05:51.813

正如 Sam 所说，`StringBuider`不会覆盖`hashCode`，`equals`因此`Set`不会正常工作。

我认为答案是将 Builder 包装在一个只执行一次 toString 的对象中：

```
class Wrapper{
   final String string;
   final StringBuilder builder;

   Wrapper(StringBuilder builder){
      this.builder = builder;
      this.string = builder.toString();
   }

   public int hashCode(){return string.hashCode();}

   public boolean equals(Object o){return string.equals(o);}
}     

 public Set removeDups(List<StringBuilder> list){
    Set<Wrapper> set = ...;
    for (StringBuilder builder : list)
       set.add(new Wrapper(builder));

    return set;
 } 
```

`removeDups`可以更新该方法以从集合中提取构建器并返回`List<StringBuilder>`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T17:10:43.510

如前所述，StringBuilders 不会覆盖`Object#equals`并且不是`Comparable`.

尽管使用 StringBuilders 连接您的字符串是可行的方法，但我建议您完成连接后，**您应该在列表中存储基础字符串**( `stringBuilder.toString()`) 而不是 StringBuilders。

然后删除重复项变成一行：

```
Set<String> set = new HashSet<String>(list); 
```

或者更好的是，如果您不需要知道有重复，则直接将字符串存储在集合中。

# php - 无法在查询字符串中维护问号

> ID：12900397
> 
> 赞同：1
> 
> 时间：2012-10-15T16:57:30.000
> 
> 标签：php, url, drupal

我正在使用 drupal 的`l()`功能来建立链接。所以我将此变量作为第二个参数传递，该函数将从中生成 href 值。

```
$performer = $row->node_field_data_field_evenement_performer_title;
$url = 'node/' . $row->node_field_data_field_evenement_performer_nid . '/lightbox2';
print  l($performer, $url, array('html' => TRUE, 'attributes' => array('rel' => 'lightframe[group|width:500px; height: 500px][caption]', 'class' => 'performer-link'))); 
```

URL 应以查询字符串结尾`?format=simple`。所以基本上我的`$url`变量应该更新如下：

```
$url = 'node/' . $row->node_field_data_field_evenement_performer_nid . '/lightbox2?format=simple'; 
```

无论我使用什么编码/解码功能，无论我做什么转义，问号和等号都会被解释为`%25`字符类型。我试过：

```
$url = 'node/' . $row->node_field_data_field_evenement_performer_nid . '/lightbox2\?format\=simple'); 
```

或者

```
'/lightbox2' . any_decode_or_encode_function_outthere('?format=simple'); 
```

但我不断收到类似`node/202/lightbox2%5C%3Fformat%5C%3Dsimple`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:07:40.453

使用`query`传递给的选项数组的键`l()`：

```
print l($performer, $url, array(
  'html' => TRUE,
  'attributes' => array(
    'rel' => 'lightframe[group|width:500px; height: 500px][caption]',
     'class' => 'performer-link'
  ),
  'query' => array(
    'format' => 'simple'
  )
)); 
```

`l()`内部调用`url()`，并且可以转发选项。请参阅文档[`url()`](http://api.drupal.org/api/drupal/includes%21common.inc/function/url/6)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:07:56.057

尝试`l($performer, $url, array('query' => array('format' => 'simple'), /*...the rest of your array...*/ );`

这适用于 drupal 7。在选项数组中，您可以指定一个查询数组，它是要附加到 url 查询字符串的键值数组。

# iphone - 代码或编译器：在 C 中为 iPhone 4 及更高版本优化 IIR 过滤器

> ID：12900398
> 
> 赞同：4
> 
> 时间：2012-10-15T16:57:32.773
> 
> 标签：iphone, c, optimization, floating-point, llvm

我一直在分析我几乎完成的项目，我看到大约四分之三的 CPU 时间花在这个 IIR 过滤器功能上（目前在目标硬件上大约在一秒钟内调用了数十万次）因此，在其他一切正常的情况下，我想知道它是否可以针对我的特定硬件和软件目标进行优化。我的目标只有 iPhone 4 和更新版本，只有 iOS 4.3 和更新版本，只有 LLVM 4.x。如果有收获，一点点不精确可能是可以的。

```
static float filter(const float a, const float *b, const float c, float *d, const int e, const float x)
{
    float return_value = 0;

    d[0] = x;
    d[1] = c * d[0] + a * d[1];

    int j;

    for (j = 2; j <= e; j++) {
        return_value += (d[j] += a * (d[j + 1] - d[j - 1])) * b[j];
    }

    for (j = e + 1; j > 1; j--) {
        d[j] = d[j - 1];
    }
    return (return_value);
} 
```

任何有关加速它的建议都值得赞赏，如果可以在默认编译器优化之外进行优化，也对您的意见感兴趣。我想知道 NEON SIMD 是否会有所帮助（这对我来说是新的领域），或者是否可以利用 VFP，或者 LLVM 自动矢量化是否会有所帮助。

我尝试了以下 LLVM 标志：

-ffast-math（没有显着差异）

-O4（在 iPhone 4S 上有很大的不同，时间减少了 25%，但在我的最低目标设备 iPhone 4 上没有显着差异，改进是我的主要目标）

-O3 -mllvm -unroll-allow-partial -mllvm -unroll-runtime -funsafe-math-optimizations -ffast-math -mllvm -vectorize -mllvm -bb-vectorize-aligned-only （来自 Hal Finkel 幻灯片的 LLVM 自动矢量化标志：[http://llvm.org/devmtg/2012-04-12/Slides/Hal_Finkel.pdf](http://llvm.org/devmtg/2012-04-12/Slides/Hal_Finkel.pdf)，比 Xcode 发布目标的默认 LLVM 优化慢）

对其他标志、不同方法和功能更改开放。我宁愿单独留下输入和返回类型和值。实际上在这里讨论了使用 FIR 的 NEON 内在函数：[https](https://pixhawk.ethz.ch/_media/software/optimization/neon_support_in_the_arm_compiler.pdf) ://pixhawk.ethz.ch/_media/software/optimization/neon_support_in_the_arm_compiler.pdf但我没有足够的经验来成功应用信息我自己的情况。谢谢你的澄清。

**编辑**我很抱歉没有早点注意到这一点。在调查了 aka.nice 的建议后，我注意到为 e、a 和 c 传入的值始终是相同的值，并且我在运行前就知道它们，因此可以选择包含此信息的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T19:06:22.830

以下是可以对代码进行的一些转换以使用 vDSP 例程。这些转换使用名为 T0、T1 和 T2 的各种临时缓冲区。每一个都是一个浮点数组，有足够的空间容纳 e-1 元素。

首先，使用临时缓冲区来计算`a * b[j]`. 这改变了原始代码：

```
for (j = 2; j <= e; j++) {
    return_value += (d[j] += a * (d[j + 1] - d[j - 1])) * b[j];
} 
```

至：

```
vDSP_vsmul(b+2, 1, &a, T0, 1, e-1);
for (j = 2; j <= e; j++)
    return_value += (d[j] += (d[j+1] - d[j-1])) * T0[j-2]; 
```

然后使用 vDSP_vmul 计算`d[j+1] * T0[j-2]`：

```
vDSP_vsmul(b+2, 1, &a, T0, 1, e-1);
vDSP_vmul(d+3, 1, T0, 1, T1, 1, e-1);
for (j = 2; j <= e; j++)
    return_value += (d[j] += T1[j-2] - d[j-1] * T0[j-2]; 
```

接下来，将 vDSP_vmul 提升为 vDSP_vma（向量乘加）以计算`d[j] + d[j+1] * T0[j-2]`：

```
vDSP_vsmul(b+2, 1, &a, T0, 1, e-1);
vDSP_vma(d+3, 1, T0, 1, d+2, 1, T1, 1, e-1);
for (j = 2; j <= e; j++)
    return_value += (d[j] = T1[j-2] - d[j-1] * T0[j-2]; 
```

我想我会计时，看看是否有任何改进。有一些问题：

*   SIMD 代码在数据为 16 字节对齐时效果最佳。使用数组索引，例如`j-1`和`j+1`防止这种情况。手机中的 ARM 处理器在数据未对齐方面并不像其他一些处理器那样糟糕，但性能会因型号而异。
*   如果 e 很大（超过几千个），那么在 vDSP_vma 操作期间 T0 和 d 可能会从缓存中清除，并且下面的循环将不得不重新加载它们。有一种称为露天采矿的技术可以减少这种影响。我现在不会详细说明它，但本质上，操作被划分为更小的数组条带。
*   最后循环中的 IIR 可能仍会成为处理器的瓶颈。vDSP 中有用于执行某些 IIR 的例程（例如 vDSP_deq22），但尚不清楚此过滤器是否可以以与 vDSP 例程充分匹配的方式表示，以获得比转换可能损失的性能更多的性能.
*   最后循环中用于计算 return_value 的求和也可以从循环中删除并替换为 vDSP 例程（可能是 vDSP_sve），但我怀疑由 IIR 引起的松弛将允许在不增加显着执行时间的情况下完成添加环形。

以上是我的头顶；我没有测试过代码。我建议逐一进行转换，以便您可以在每次更改后测试代码并在继续之前识别任何错误。

如果您能找到不是 IIR 的令人满意的滤波器，则可能会有更多的性能优化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T18:43:56.840

> 我宁愿单独留下输入和返回类型和值……</p>

尽管如此，将渲染从浮点数转换为整数会有很大帮助。

将更改本地化到您提供的实现将没有用。但是，如果您将其扩展为仅将 FIR 重新实现为整数，它可以很快得到回报（除非保证大小总是非常小——然后转换/移动时间成本更高）。当然，将渲染图的较大部分移动到整数将带来更大的收益，并且需要更少的转换。

另一个考虑因素是查看 Accelerate.framework 中的实用程序（可能使您免于编写自己的 asm）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T22:48:50.593

我尝试了这个小练习来用延迟运算符 z 重写你的过滤器

例如，对于 e=4，我将输入 u 和输出 y 重命名

```
d1*z= u
d2*z= c*u + a*d1
d3*z= d2 + a*(d3-d1*z)
d4*z= d3 + a*(d4-d2*z)
d5*z= d4 + a*(d5-d3*z)
y = (b2*d3*z + b3*d4*z + b4*d5*z) 
```

请注意，di 是过滤器状态。
d3*z 是 d3 的下一个值（它在您的代码中似乎是变量 d2）
然后您可以消除 di 以在 z 中编写传递函数 y/u。
然后，您会发现通过分解/简化上述传递函数，最小表示只需要 e 个状态。
分母是`z*(z-a)^3`，即 0 处的一个极点，另一个具有多重性 (e-1) 的 a 处。

然后，您可以将过滤器置于标准状态空间矩阵表示中：

```
z*X = A*X + B*u
y = C*X + d*u 
```

使用特定形式的极点，您可以分解部分分数展开中的传递并以这种特殊形式获得矩阵 A 和 B（类似于 matlab 的符号）

```
A = [0 1 0 0;    B=[0;
     0 a 1 0;       0;
     0 0 a 1;       0;
     0 0 0 a]       1] 
```

不过，C 和 d 不太容易......
它们是从分子和部分分数展开的直接项中提取的
它们是 bi、c（1 度）和 a（e 度）中的多项式
对于 e=4，我有

```
C=[   a^3*b2            - a^2*b3                      + a*b4 ,
     -a^2*b2              + a*b3                + (c-a^2)*b4 ,
        a*b2        + (c-a^2)*b3 + (-2*a^2*c-2*a^2-a+a^4)*b4 ,
  (c-a^2)*b2 + (-a^2-a^2*c-a)*b3 +         (-2*a*c+2*a^3)*b4 ]
d=     -a*b2            - a*c*b3                    + a^2*b4 
```

如果你能在 e 中找到控制 C & d 的递归，并预先计算它们，
那么过滤器可以简化为那些简单的向量操作：

```
z*X = a*[ 0; x2 ; x3 ; x4 ... xe ] + [x2 ; x3 ; x4 ... xe ; u ];
Y = C*[ x1 ; x2 ; x3 ; x4 ... xe ] + d*u 
```

或者表示为函数`(Xnext,y)=filter(X,u,a,C,d,e)`伪代码：

```
y = dot_product( C , X) + d*u; // (like BLAS _DOT)
Xnext(1:e-1) = X(2:e); // this is a memcopy (like BLAS _COPY)
Xnext(e)=u;
X(1)=0;
Xnext=a*X+Xnext; // this is an inplace vector muladd (like BLAS _AXPY)

X=Xnext; // another memcopy outside the function (can be moved inside). 
```

请注意，如果您使用 BLAS 函数，您的代码将可移植到许多硬件，而不仅仅是以 Apple 为中心，我猜性能不会有太大不同。

**编辑：关于部分分数扩展**

纯部分分数展开将给出对角状态空间表示，以及一个充满 1 的矩阵 B。这也可能是一个有趣的变体。（并行过滤器）
我上面使用的变体更像是级联或梯子（串联过滤器）。

# c# - 通过 IronPython 在 C# 中评估三角函数

> ID：12900399
> 
> 赞同：3
> 
> 时间：2012-10-15T16:57:34.523
> 
> 标签：c#, python, math, eval, ironpython

我正在尝试使用 Iron-Python 二进制文件中的 Python 引擎评估一些与流体力学相关的表达式。我已经达到以下代码：

```
ScriptEngine engine = Python.CreateEngine();
ScriptSource source = engine.CreateScriptSourceFromString("import math", SourceCodeKind.AutoDetect);
source.Execute();
source = engine.CreateScriptSourceFromString("2*sin (2)", SourceCodeKind.AutoDetect);
button1.Text = source.Execute<float>().ToString(); 
```

每当我尝试运行时，都会出现以下错误：`Global name 'sin' not defined`. 我也尝试过`Math.sin()`，但没有成功。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:20:35.817

如果您想让所有数学函数在全局范围内可访问，您可以使用`from math import *`代替（这可能对您有用，因为您的表达式本质上是数学的）。`import math`

您还应该创建一个`ScriptScope`来存储全局状态，这样您就可以执行多个语句：

```
ScriptScope scope = engine.CreateScope();

ScriptSource source = engine.CreateScriptSourceFromString("from math import *", SourceCodeKind.AutoDetect);
source.Execute(scope);

source = engine.CreateScriptSourceFromString("2*sin (2)", SourceCodeKind.AutoDetect);
button1.Text = source.Execute<float>(scope).ToString(); 
```

您甚至可以从 C# 将对象放入范围：

```
scope.SetVariable("x", 0.577); 
```

# environment-variables - 主管和环境变量

> ID：12900402
> 
> 赞同：84
> 
> 时间：2012-10-15T16:57:47.003
> 
> 标签：environment-variables, supervisord

我真的不知道如何让主管使用环境变量。

下面是一个配置片段。

```
[program:htNotificationService]
priority=2
#autostart=true
#autorestart=true
directory=/home/ubuntu/workspace/htFrontEnd/heythat/htsite
command = /usr/bin/python htNotificationService.py -service
stdout_logfile=/var/log/heythat/htNotificationService.log
redirect_stderr=true
environment=PATH=/home/ubuntu/workspace/htFrontEnd/heythat
stopsignal=QUIT 
```

我尝试了以下方法：

```
environment=PATH=/home/ubuntu/workspace/htFrontEnd/heythat
environment=PYTHONPATH=$PYTHONPATH:/home/ubuntu/workspace/htFrontEnd/heythat
environment=PATH=/home/ubuntu/workspace/htFrontEnd/heythat,PYTHONPATH=$PYTHONPATH:/home/ubuntu/workspace/htFrontEnd/heythat 
```

当我开始主管时，我得到

```
htNotificationService: ERROR (abnormal termination) 
```

我可以通过设置 python 路径从 shell 开始，但不能从主管开始。在日志中，我收到一条错误消息，指出找不到导入。好吧，如果主管能工作，这将解决。我什至在 /etc/environments 中有路径？

为什么主管不工作？

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2013-10-26T21:08:40.317

使用 %(ENV_VARNAME)s 引用现有的环境变量

（见[https://github.com/Supervisor/supervisor/blob/master/supervisor/skel/sample.conf](https://github.com/Supervisor/supervisor/blob/master/supervisor/skel/sample.conf)）

设置多个环境变量是通过用逗号分隔它们来完成的

（见[http://supervisord.org/subprocess.html#subprocess-environment](http://supervisord.org/subprocess.html#subprocess-environment)）

尝试：

```
environment=PYTHONPATH=/opt/mypypath:%(ENV_PYTHONPATH)s,PATH=/opt/mypath:%(ENV_PATH)s 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2016-03-24T11:40:48.197

在 supervisord 块下的 .conf 文件中，您可以像这样添加所有环境键=值对

```
[supervisord]
environment=CELERY_BROKER_URL="amqp://guest:guest@127.0.0.1:5672//",FLASK_CONFIG="TESTING"

[program:celeryd]
command=celery worker -A celery --loglevel=info -P gevent -c 1000 
```

如果您不想对变量进行硬编码但想从 os 环境中将其拉入，请在 bash 上执行第 1 步

**导出环境变量**

```
>> sudo export CELERY_BROKER_URL="amqp://guest:guest@127.0.0.1:5672//" 
```

**重新加载 Bash**

```
>> . ~/.bashrc 
```

**检查环境变量是否设置正确**

```
>> env 
```

**现在修改 conf 文件以读取**-[注意](http://supervisord.org/configuration.html#environment-variables)：在您的环境变量前面加上 ENV_

```
[supervisord]
environment=CELERY_BROKER_URL="%(ENV_CELERY_BROKER_URL)s",FLASK_CONFIG="%(ENV_FLASK_CONFIG)s"

[program:celeryd]
command=celery worker -A celery --loglevel=info -P gevent -c 1000 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2016-12-25T13:04:18.743

这对我有用。注意每一行之前的标签：

```
environment=
    CLOUD_INSTANCE_NAME=media-server-xx-xx-xx-xx,
    CLOUD_APPLICATION=media-server,
    CLOUD_APP_COMPONENT=none,
    CLOUD_ZONE=a,
    CLOUD_REGION=b,
    CLOUD_PRIVATE_IP=none,
    CLOUD_PUBLIC_IP=xx.xx.xx.xx,
    CLOUD_PUBLIC_IPV6=xx.xx.xx.xx.xx.xx,
    CLOUD_PROVIDER=c 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2020-06-16T16:38:02.233

我知道这已经过时了，但我只是为此苦苦挣扎了几个小时，并想帮助下一个人。

进行更新后不要忘记重新加载配置文件

```
supervisorctl reread
supervisorctl update 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-08-01T02:09:35.843

如果您从包安装程序安装 Supervisor，请检查您使用的 Supervisor 版本。截至 2016 年 8 月，您将获得**3.0b2**。如果是这种情况，您将需要更新版本的主管。您可以通过手动安装 supervisor 或使用 Python 的 pip 来获得它。确保满足所有依赖项以及 upstart 设置，以便**supervisord**作为服务工作并在系统启动时启动。

# javascript - Firefox 中的 innerText 替代方案

> ID：12900405
> 
> 赞同：0
> 
> 时间：2012-10-15T16:58:29.797
> 
> 标签：javascript, jquery, innertext

> **可能重复：**
> [Mozilla 中的 InnerText 替代品](https://stackoverflow.com/questions/6015388/innertext-alternative-in-mozilla)

我有这个代码

```
<div id="code">My program<br />It is here!</div>
<script type="text/javascript">
var program=document.getElementById('code');
ShowLMCButton(program.innerText);
</script> 
```

它在 IE 中有效，但在 Firefox 中，innerText 不起作用。如何在 Firefox 中使用它？我试过 .text() 但它不想工作！我需要文本格式为“我的程序\n 它在这里！” 它不能是 textContent ，因为它会复制 html 标签。

这是什么，是从站点复制 VB 脚本并将其直接粘贴到程序中，它必须包括所有新行、空白等。

ShowLMCButton() 是“点击复制”的脚本 - [http://www.lettersmarket.com/view_blog/a-3-copy_to_clipboard_lmcbutton.html](http://www.lettersmarket.com/view_blog/a-3-copy_to_clipboard_lmcbutton.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:04:57.070

将 textContent 用于 Firefox

```
ShowLMCButton(program.innerText || program.textContent) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T17:00:45.247

您可以使用 JQuery 来执行此操作：

**[现场演示](http://jsfiddle.net/rajaadil/WS7G3/)**

```
ShowLMCButton($('#code').text()); 
```

# java - java自动将数组大小加倍

> ID：12900406
> 
> 赞同：0
> 
> 时间：2012-10-15T16:58:34.413
> 
> 标签：java, arrays, double, capacity

尝试将我的数组初始化为 1 并在每次输入填满时将其加倍。这就是我现在所拥有的

```
int max = 1;
 PhoneRecord[] records = new PhoneRecord[max];
      int numRecords = 0;
      int size = Integer.parseInt(length.records[numRecords]);
 if (size >= max) {
   size = 2*size;
 } 
```

但它显然充满了失败。任何建议或指导都会很棒，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T16:59:32.430

为什么不使用[ArrayList](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)？它会自动表现出非常相似的特征。

从[私有的 grow() 方法](http://www.docjar.com/html/api/java/util/ArrayList.java.html)：

```
int newCapacity = oldCapacity + (oldCapacity >> 1); 
```

你不能覆盖增长行为，但除非你*真的*因为你的应用程序特性需要加倍，否则我相信它就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:11:15.987

好的，您应该使用`ArrayList`，但其他几个人已经告诉过您了。

如果您仍想使用数组，请按以下方式调整它的大小：

```
int max = 1;
PhoneRecord[] records = new PhoneRecord[max];
int numRecords = 0;

void addRecord(PhoneRecord rec) {
    records[numRecords++] = rec;
    if(numRecords == max) {
        /* out of space, double the array size */
        max *= 2;
        records = Arrays.copyOf(records, max);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T17:16:53.677

大小只是乘以大小数，而不是数组大小的两倍。尝试：

```
 records = Arrays.copyOf(records, records.length*2); 
```

# c++ - 如何使用 GetSystemPowerStatusEx2 API 在 Wince 中表示电池温度值？

> ID：12900408
> 
> 赞同：0
> 
> 时间：2012-10-15T16:58:36.210
> 
> 标签：c++, windows-mobile, windows-ce, battery, temperature

我只想确认电池温度数据。

我正在使用 GetSystemPowerStatusEx2 API 来获取使用 c++ 的 windows ce 设备的电池温度。

我正在使用**“SYSTEM_POWER_STATUS_EX2”**类型的变量“psse **”**。

**成功**后，返回的电池温度值如下所述：-

`psse.BatteryTemperature = 29 //which is of dword type.`

我的疑问是实际的电池温度表示是多少？

是 2.9 摄氏度还是 29 摄氏度？为什么？

请回复。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:03:47.490

根据[MSDN 上的文档](http://msdn.microsoft.com/en-us/library/aa926903.aspx)

> 电池温度，以摄氏度为单位。该成员的值可以在 –3,276.8 到 3,276.7 范围内；增量为 0.1 摄氏度。

所以 29 的值意味着 2.9 摄氏度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T03:41:10.113

在调用函数之前，您是否将 BatteryStatusEx2 结构内存归零？

OTOH OEM 可以，但不需要正确填写所有值。因此，如果函数返回 29，即 2.9°C，我假设 OEM 未正确填写该值。要么是 29°C，但随着时间的推移，这也不是一个真实的值，因为在设备使用过程中电池温度应该会上升。

OEM 可能会为纠正错误读数的设备提供新的固件或服务版本。

值的准确性取决于驱动程序的实现。可能电池根本没有暴露任何温度，驱动程序总是用值 29 填充结构。

不要太相信 OEM 始终正确地实现所有功能。

~约瑟夫

# java - 多态性和instanceof

> ID：12900409
> 
> 赞同：2
> 
> 时间：2012-10-15T16:58:45.010
> 
> 标签：java, arrays, object, polymorphism, instanceof

我编写了一个 Worker 和 MachineWorker 类。它符合要求。但是当我运行它时，在连续三个语句之后程序停止。我找不到问题，我不知道如何以及何时使用“instanceof”。我正在写下面的问题以及所有课程......

问题：- (i)声明一个数组，最多可以存储 5 个**Worker**或**MachineWorker**对象的引用。a) 允许用户输入对象类型和该类型对象的数据（Worker 为 3 个值，MachineWorker 为 4 个值）。b) 构造适当的对象，将引用存储在公共数组中。

ii) 现在允许用户重复输入每周数据。如果是**Worker**对象，用户必须输入 ID 和工时。如果是**MachineWorker**对象，用户必须输入 ID、hoursWorked 和pieces。一旦这些值在调用**addWeekly()之前通过数组搜索以定位具有给定 ID 的对象。要传递给****addWeekly**的参数的数量（1 或 2）取决于所引用的对象的类型。要确定被引用对象的类型（**Worker 或 MachineWorker**），您可以使用**instanceof**运算符。

请在下面查看我的代码：-

```
 //Worker.java
    public class Worker { 
            public final double bonus=100;    
            protected String name, workerID;
            protected double hourlyRate, totalHoursWorked,tax,grossSalary,netSalary;

            public Worker(){

        }
    public Worker(String name, String workerID, double hourlyRate){
        this.name = name;
        this.workerID = workerID;
        this.hourlyRate = hourlyRate;

        }

    public void addWeekly(double hoursWorked){
        this.totalHoursWorked = this.totalHoursWorked + hoursWorked;
        }

    public double gross(){
        grossSalary = (totalHoursWorked*hourlyRate);
                if(totalHoursWorked>=150){
            grossSalary = grossSalary +100;
            }
            return  grossSalary;
            }
    public double netAndTax(){
        netSalary = grossSalary;
        if(grossSalary>500){
            tax = (grossSalary - 500) *0.3;
            netSalary = (grossSalary - tax);

        }
        return netSalary;
     }
    public String getName(){
        return this.name;
    }

    public String getWorkerID(){
        return this.workerID;
    }

    public double getHourlyRate(){
        return this.hourlyRate;
    }

    public double getTotalHours(){
        return totalHoursWorked;
    }

    public double getGrossSalary(){
        return grossSalary;
        }

    public void addToGross(double amt){
        grossSalary = grossSalary + amt;
    }
    public void displaySalary(){
        System.out.print("Name: " +getName() + "\nID :" + getWorkerID() 
                + "\nHourly Rate: " + getHourlyRate()+ "\nTotalHours Worked" + getTotalHours() + 
                "\nGross pay" + getGrossSalary() + "\nTax: " + netAndTax() + 
                "\nNet Pay: " + netAndTax());
    }

    }

//MachineWorker.java
    public class MachineWorker extends Worker{

        private double targetAmount;
        private double totalPieces, productivityBonus;

        public MachineWorker(String workerName, String workerID, double hourlyRate, double targetAmount)
        {
            super(workerName, workerID, hourlyRate);
            //this.productivityBonus = productivityBonus;
            this.targetAmount = targetAmount;

        }

        public void addWeekly(double hoursWorked, double weeklyAmount)
        {
            totalHoursWorked = hoursWorked + totalHoursWorked;
            totalPieces = weeklyAmount + totalPieces;
        }

        public double productivityBonus()
        {
            productivityBonus = 100 + (totalPieces - targetAmount);
            return productivityBonus;
        }

        public double gross()
        {
            grossSalary = (totalHoursWorked * hourlyRate) + productivityBonus;
            if(totalHoursWorked >= 150)
            {
                grossSalary = grossSalary + bonus;
            }
            return  grossSalary;
        }

        public void addToGross(double amt)
        {
            amt = productivityBonus;
            grossSalary = grossSalary + amt;
        }

        public void displaySalary()
        {

        System.out.println("Name    " + super.name + "\nID  " + 
        super.workerID + "\nHourly rate " + super.hourlyRate + "\nTotal Hours Worked    " + 
        super.totalHoursWorked + "\nGross Pay   $" + super.grossSalary + "\nTax $" + super.tax + "\nNetpay  $" + super.netSalary);
            System.out.println("Productivity Bonus  " + productivityBonus);
        }   
    }

  //Polymorphism PolyWorker.java

import java.util.*;
        public class PolyWorkers
    {
        public static void main(String args[])
        {
            Scanner input = new Scanner(System.in);

            Worker[] a = new Worker[5];
            MachineWorker[] b = new MachineWorker[5];

            char option = '0';
            String choice;
            boolean nChar = false;

            for (int i = 0; i < 5; i++){

                System.out.print("\tType of object " + (i+1) + " [W/M]: ");
                choice = input.nextLine();

                if (choice.length() == 1)
                {
                    option = choice.charAt(0); //pick the first character

                    if (option == 'w' || option == 'W')
                    {
                        System.out.println("\n\tEnter name, ID and hours:   ");
                        String name = input.nextLine();
                        System.out.print("  ");
                        String id = input.nextLine();
                        System.out.print("  ");
                        double hours = input.nextDouble();

                        a[i] = new Worker(name, id, hours);
                        System.out.println();

                    }
                    if (option == 'm' || option == 'M')
                    {
                        System.out.print("\n\tEnter name, ID, hours and pieces: ");
                        String name = input.nextLine();
                        System.out.print("  ");
                        String id = input.nextLine();
                        System.out.print("  ");
                        double hours = input.nextDouble();
                        System.out.print("  ");
                        double pieces = input.nextDouble();

                        b[i] = new MachineWorker(name, id, hours, pieces);
                        System.out.println();
                    }
                System.out.print("\tType of object " + (i+1) + " [W/M]: ");
                choice = input.nextLine();
                }

                a[i].displaySalary();
                b[i].displaySalary();
                b[i].productivityBonus();

            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:06:50.170

您的问题表明您必须将引用存储在一个公共数组中，当您将它们存储在 2 个不同的数组`a`和`b`. 由于您对不同类型的对象有不同的数组，因此您不需要使用`instanceOf`运算符。有关 instanceOf 的更多信息[在这里](http://www.java-samples.com/showtutorial.php?tutorialid=332)。

此外，您在打印薪水或奖金时不检查 null。在循环的任何时候，只会创建一种类型的对象，a[i] 或 b[i] 中的一个肯定为 null，从而导致 NullPointerException。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:10:45.433

在您已经编写的循环之后，您需要另一个循环，以允许用户输入工人的工作时间。这可能是一个`while`不断要求输入的循环。然后，您将选择某种退出循环的输入。在循环中，您要求数小时并接受 2 或 3 个参数。

目前你没有存储你的工人/机器工人。您需要创建一个数组来存储它们。您还需要创建它们都将扩展/实现的基类或接口。这将允许您创建一个数组来存储它们。

然后，您遍历您的 Workers/MachineWorkers 数组，当您找到匹配的 id 时，您可以使用 your`instanceof`来确定是否需要传递 1 个或 2 个参数。如果它是 MachineWorker，您应该将其转换为这样，然后使用 2 个参数调用适当的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T18:08:03.400

您可能希望使用重写方法 readfromInput 和 displaySalary 来区分 Worker 和 Machinworker 的作用。不同的行为应该在类中实现，而不是在调用 Polyworker 类中。如果 MachineWorker displaySalary 显示奖金，这应该在 MachineWorker 的 displaySalary 中调用

请参阅下面的修改代码

```
//Worker.java
import java.util.Scanner;

/**
 * a generic worker
 */
public class Worker {
    public final double bonus = 100;
    protected String name, workerID;
    protected double hourlyRate, totalHoursWorked, tax, grossSalary, netSalary;

    public void addWeekly(double hoursWorked) {
        this.totalHoursWorked = this.totalHoursWorked + hoursWorked;
    }

    public double gross() {
        grossSalary = (totalHoursWorked * hourlyRate);
        if (totalHoursWorked >= 150) {
            grossSalary = grossSalary + 100;
        }
        return grossSalary;
    }

    public double netAndTax() {
        netSalary = grossSalary;
        if (grossSalary > 500) {
            tax = (grossSalary - 500) * 0.3;
            netSalary = (grossSalary - tax);

        }
        return netSalary;
    }

    public String getName() {
        return this.name;
    }

    public String getWorkerID() {
        return this.workerID;
    }

    public double getHourlyRate() {
        return this.hourlyRate;
    }

    public double getTotalHours() {
        return totalHoursWorked;
    }

    public double getGrossSalary() {
        return grossSalary;
    }

    public void addToGross(double amt) {
        grossSalary = grossSalary + amt;
    }

    public void displaySalary() {
        System.out.print("Name: " + getName() + "\nID :" + getWorkerID()
                + "\nHourly Rate: " + getHourlyRate() + "\nTotalHours Worked"
                + getTotalHours() + "\nGross pay" + getGrossSalary() + "\nTax: "
                + netAndTax() + "\nNet Pay: " + netAndTax());
    }

    public void readFromInput(Scanner input) {
        name = input.nextLine();
        System.out.print("  ");
        this.workerID= input.nextLine();
        System.out.print("  ");
        this.totalHoursWorked = input.nextDouble();
        System.out.println();
    }

} // Worker

//MachineWorker.java
import java.util.Scanner;
public class MachineWorker extends Worker {

    private double targetAmount;
    private double totalPieces, productivityBonus;

    public void addWeekly(double hoursWorked, double weeklyAmount) {
        totalHoursWorked = hoursWorked + totalHoursWorked;
        totalPieces = weeklyAmount + totalPieces;
    }

    public double productivityBonus() {
        productivityBonus = 100 + (totalPieces - targetAmount);
        return productivityBonus;
    }

    public double gross() {
        grossSalary = (totalHoursWorked * hourlyRate) + productivityBonus;
        if (totalHoursWorked >= 150) {
            grossSalary = grossSalary + bonus;
        }
        return grossSalary;
    }

    public void addToGross(double amt) {
        amt = productivityBonus;
        grossSalary = grossSalary + amt;
    }

    @Override
    public void displaySalary() {
        super.displaySalary();
        System.out.println("Productivity Bonus  " + productivityBonus);
    }

    @Override
    public void readFromInput(Scanner input) {
        super.readFromInput(input);
        this.totalPieces = input.nextDouble();
    }
}

//Polymorphism PolyWorker.java

import java.util.*;

public class PolyWorkers {
    public static void main(String args[]) {
        Scanner input = new Scanner(System.in);
        Worker[] workers = new Worker[5];

        char option = '0';
        String choice;

        for (int i = 0; i < 5; i++) {

            System.out.print("\tType of object " + (i + 1) + " [W/M]: ");
            choice = input.nextLine();

            if (choice.length() == 1) {
                option = choice.toLowerCase().charAt(0); // pick the first character
                switch (option) {
                case 'w': {
                    workers[i] = new Worker();
                    System.out.println("\n\tEnter name, ID and hours:   ");
                }
                    break;
                case 'm': {
                    System.out.print("\n\tEnter name, ID, hours and pieces: ");
                }
                    break;
                } // switch
                workers[i].readFromInput(input);
            }

            workers[i].displaySalary();
        }

    }
} 
```

# php - 如何将 SVG 字符串转换为 PNG？

> ID：12900412
> 
> 赞同：3
> 
> 时间：2012-10-15T16:58:49.330
> 
> 标签：php, javascript, svg, jquery-svg

我知道有很多关于这个的话题，但我还没有找到正确的答案......

我需要将 SVG 字符串转换为 png 图像，它必须是 png 图像，因为我需要透明度并且我尝试使用它只接受 png（或礼物）图像......

**我需要通过php**或**javascript**来做到这一点...

我一直在阅读有关 Raphael 的信息，但它只以某种方式返回图像，我需要图像文件！！！！

我也一直在尝试使用图像魔法（php ext），它给了我这个错误：

> **此图像格式没有解码委托**

我希望任何人都可以帮助！

谢谢！

这是我的 SVG 文件...

```
<svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" version="1.1" width="560" height="300">
<defs>
<clipPath id="highcharts-6">
<rect rx="0" ry="0" fill="none" x="0" y="0" width="9999" height="300" stroke-width="0.000001">
</rect>
</clipPath>
<clipPath id="highcharts-7">
<rect fill="none" x="0" y="0" width="560" height="300">
</rect>
</clipPath>
</defs>
<g class="highcharts-series-group" >
</g>
<g class="highcharts-shadow" >
<path fill="none" d="M 279.96944901944573 0.0000031112080876027903 A 150 150 0 0 1 326.3009125168081 292.6752448748937 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="5" stroke-linejoin="round"  stroke-opacity="0.049999999999999996" transform="translate(1, 1)">
</path>
<path fill="none" d="M 279.96944901944573 0.0000031112080876027903 A 150 150 0 0 1 326.3009125168081 292.6752448748937 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="3" stroke-linejoin="round"  stroke-opacity="0.09999999999999999" transform="translate(1, 1)">
</path>
<path fill="none" d="M 279.96944901944573 0.0000031112080876027903 A 150 150 0 0 1 326.3009125168081 292.6752448748937 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="1" stroke-linejoin="round"  stroke-opacity="0.15" transform="translate(1, 1)">
</path>
</g>
<g class="highcharts-shadow" >
<path fill="none" d="M 326.3007698415401 292.67529117573486 A 150 150 0 0 1 133.00773034195186 179.88766736926223 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="5" stroke-linejoin="round"  stroke-opacity="0.049999999999999996" transform="translate(1, 1)">
</path>
<path fill="none" d="M 326.3007698415401 292.67529117573486 A 150 150 0 0 1 133.00773034195186 179.88766736926223 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="3" stroke-linejoin="round"  stroke-opacity="0.09999999999999999" transform="translate(1, 1)">
</path>
<path fill="none" d="M 326.3007698415401 292.67529117573486 A 150 150 0 0 1 133.00773034195186 179.88766736926223 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="1" stroke-linejoin="round"  stroke-opacity="0.15" transform="translate(1, 1)">
</path>
</g>
<g class="highcharts-shadow" >
<path fill="none" d="M 133.007700454358 179.88752037697762 A 150 150 0 0 1 156.4888806240783 64.88241432872512 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="5" stroke-linejoin="round"  stroke-opacity="0.049999999999999996" transform="translate(1, 1)">
</path>
<path fill="none" d="M 133.007700454358 179.88752037697762 A 150 150 0 0 1 156.4888806240783 64.88241432872512 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="3" stroke-linejoin="round"  stroke-opacity="0.09999999999999999" transform="translate(1, 1)">
</path>
<path fill="none" d="M 133.007700454358 179.88752037697762 A 150 150 0 0 1 156.4888806240783 64.88241432872512 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="1" stroke-linejoin="round"  stroke-opacity="0.15" transform="translate(1, 1)">
</path>
</g>
<g class="highcharts-shadow" >
<path fill="none" d="M 156.48896574172574 64.8822908176483 A 150 150 0 0 1 217.00753341120077 13.867898153818942 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="5" stroke-linejoin="round"  stroke-opacity="0.049999999999999996" transform="translate(1, 1)">
</path>
<path fill="none" d="M 156.48896574172574 64.8822908176483 A 150 150 0 0 1 217.00753341120077 13.867898153818942 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="3" stroke-linejoin="round"  stroke-opacity="0.09999999999999999" transform="translate(1, 1)">
</path>
<path fill="none" d="M 156.48896574172574 64.8822908176483 A 150 150 0 0 1 217.00753341120077 13.867898153818942 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="1" stroke-linejoin="round"  stroke-opacity="0.15" transform="translate(1, 1)">
</path>
</g>
<g class="highcharts-shadow" >
<path fill="none" d="M 217.00766954333415 13.867835161420402 A 150 150 0 0 1 273.3436894553766 0.14776101127640118 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="5" stroke-linejoin="round"  stroke-opacity="0.049999999999999996" transform="translate(1, 1)">
</path>
<path fill="none" d="M 217.00766954333415 13.867835161420402 A 150 150 0 0 1 273.3436894553766 0.14776101127640118 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="3" stroke-linejoin="round"  stroke-opacity="0.09999999999999999" transform="translate(1, 1)">
</path>
<path fill="none" d="M 217.00766954333415 13.867835161420402 A 150 150 0 0 1 273.3436894553766 0.14776101127640118 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="1" stroke-linejoin="round"  stroke-opacity="0.15" transform="translate(1, 1)">
</path>
</g>
<g class="highcharts-shadow" >
<path fill="none" d="M 273.3438393076189 0.1477543550407745 A 150 150 0 0 1 279.9415029437792 0.00001140635239949006 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="5" stroke-linejoin="round"  stroke-opacity="0.049999999999999996" transform="translate(1, 1)">
</path>
<path fill="none" d="M 273.3438393076189 0.1477543550407745 A 150 150 0 0 1 279.9415029437792 0.00001140635239949006 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="3" stroke-linejoin="round"  stroke-opacity="0.09999999999999999" transform="translate(1, 1)">
</path>
<path fill="none" d="M 273.3438393076189 0.1477543550407745 A 150 150 0 0 1 279.9415029437792 0.00001140635239949006 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="black" stroke-width="1" stroke-linejoin="round"  stroke-opacity="0.15" transform="translate(1, 1)">
</path>
</g>
<g class="highcharts-point" >
<path fill="#4572A7" d="M 279.96944901944573 0.0000031112080876027903 A 150 150 0 0 1 326.3009125168081 292.6752448748937 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="#FFFFFF" stroke-width="1" stroke-linejoin="round">
</path>
<path fill="rgb(192,192,192)" d="M 279.96944901944573 0.0000031112080876027903 A 150 150 0 0 1 326.3009125168081 292.6752448748937 L 280 150 A 0 0 0 0 0 280 150 Z"  fill-opacity="0.000001" visibility="visible" style="">
</path>
</g>
<g class="highcharts-point" >
<path fill="#AA4643" d="M 326.3007698415401 292.67529117573486 A 150 150 0 0 1 133.00773034195186 179.88766736926223 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="#FFFFFF" stroke-width="1" stroke-linejoin="round">
</path>
<path fill="rgb(192,192,192)" d="M 326.3007698415401 292.67529117573486 A 150 150 0 0 1 133.00773034195186 179.88766736926223 L 280 150 A 0 0 0 0 0 280 150 Z"  fill-opacity="0.000001" visibility="visible" style="">
</path>
</g>
<g class="highcharts-point" >
<path fill="#89A54E" d="M 133.007700454358 179.88752037697762 A 150 150 0 0 1 156.4888806240783 64.88241432872512 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="#FFFFFF" stroke-width="1" stroke-linejoin="round">
</path>
<path fill="rgb(192,192,192)" d="M 133.007700454358 179.88752037697762 A 150 150 0 0 1 156.4888806240783 64.88241432872512 L 280 150 A 0 0 0 0 0 280 150 Z"  fill-opacity="0.000001" visibility="visible" style="">
</path>
</g>
<g class="highcharts-point" >
<path fill="#80699B" d="M 156.48896574172574 64.8822908176483 A 150 150 0 0 1 217.00753341120077 13.867898153818942 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="#FFFFFF" stroke-width="1" stroke-linejoin="round">
</path>
<path fill="rgb(192,192,192)" d="M 156.48896574172574 64.8822908176483 A 150 150 0 0 1 217.00753341120077 13.867898153818942 L 280 150 A 0 0 0 0 0 280 150 Z"  fill-opacity="0.000001" visibility="visible" style="">
</path>
</g>
<g class="highcharts-point" >
<path fill="#3D96AE" d="M 217.00766954333415 13.867835161420402 A 150 150 0 0 1 273.3436894553766 0.14776101127640118 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="#FFFFFF" stroke-width="1" stroke-linejoin="round">
</path>
<path fill="rgb(192,192,192)" d="M 217.00766954333415 13.867835161420402 A 150 150 0 0 1 273.3436894553766 0.14776101127640118 L 280 150 A 0 0 0 0 0 280 150 Z"  fill-opacity="0.000001" visibility="visible" style="">
</path>
</g>
<g class="highcharts-point" >
<path fill="#DB843D" d="M 273.3438393076189 0.1477543550407745 A 150 150 0 0 1 279.9415029437792 0.00001140635239949006 L 280 150 A 0 0 0 0 0 280 150 Z" stroke="#FFFFFF" stroke-width="1" stroke-linejoin="round">
</path>
<path fill="rgb(192,192,192)" d="M 273.3438393076189 0.1477543550407745 A 150 150 0 0 1 279.9415029437792 0.00001140635239949006 L 280 150 A 0 0 0 0 0 280 150 Z"  fill-opacity="0.000001" visibility="visible" style="">
</path>
</g>
<g class="highcharts-legend" >
<rect rx="5" ry="5" fill="none" x="0.5" y="0.5" width="7" height="7" stroke-width="1" stroke="#909090" visibility="hidden">
</rect>
<g  clip-path="url(#highcharts-6)">
<g>
</g>
</g>
</g>
<g class="highcharts-tooltip"  style="padding:0;white-space:nowrap;" visibility="hidden">
<rect rx="5" ry="5" fill="none" x="0" y="0" width="10" height="10" stroke-width="5" fill-opacity="0.85"  stroke="black" stroke-opacity="0.049999999999999996" transform="translate(1, 1)">
</rect>
<rect rx="5" ry="5" fill="none" x="0" y="0" width="10" height="10" stroke-width="3" fill-opacity="0.85"  stroke="black" stroke-opacity="0.09999999999999999" transform="translate(1, 1)">
</rect>
<rect rx="5" ry="5" fill="none" x="0" y="0" width="10" height="10" stroke-width="1" fill-opacity="0.85"  stroke="black" stroke-opacity="0.15" transform="translate(1, 1)">
</rect>
<rect rx="5" ry="5" fill="rgb(255,255,255)" x="0" y="0" width="10" height="10" stroke-width="2" fill-opacity="0.85">
</rect>
<text x="5" y="18" style="font-family:'lucida grande', 'lucida sans unicode', verdana, arial, helvetica, sans-serif;font-size:12px;color:#333333;fill:#333333;" >
</text>
</g>
<g class="highcharts-tracker" >
</g>
</svg> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T17:58:15.367

你能分享你的svg文件文本结构吗？我也有同样的错误，然后我发现问题出在 svg 文件本身的文本结构上。现在我的 svg 文件如下所示，按预期工作：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns:svg="http://www.w3.org/2000/svg" version="1.1">path tags</svg> 
```

# vb.net - 字符串的 XSD minOccurs="1"

> ID：12900420
> 
> 赞同：2
> 
> 时间：2012-10-15T16:59:19.377
> 
> 标签：vb.net, xsd

我有一个名为“accountNumber”的字符串字段作为 Web 服务中使用的对象的一部分。我需要这个字段，`minOccurs="1"`但**没有** `nillable="true"`。如果我将该字段定义为，`<XmlElement(IsNullable:=True)>`那么我得到`minOccurs="1"`and `nillable="true"`。如果我定义`<XmlElement(IsNullable:=False)>`那么我没有得到`nillable="true"`，但我得到`minOccurs="0"`了。

那么，我如何定义我的对象以在我的 XSD 中获取它：

```
<s:element minOccurs="1" maxOccurs="1" name="accountNumber" type="s:string" /> 
```

我的类定义很简单：

```
<Serializable()> _
<XmlType(Namespace:="http://mysite.org")> _
Public Class MyServiceWS
    'some other definitions
    <XmlElement(IsNullable:=True)> <VBFixedString(64)> Public accountNumber As String
End Class 
```

感谢您的任何帮助。

* * *

## **编辑 2012 年 10 月 16 日：逆向工程 XSD**

* * *

我使用以下字段对 XSD 进行了逆向工程：

```
<xs:element name="TEST1" minOccurs="1" maxOccurs="1" type="xs:string"/>
<xs:element name="TEST2" minOccurs="0" maxOccurs="1" type="xs:string"/>
<xs:element name="TEST3" minOccurs="1" maxOccurs="1" nillable="true" type="xs:string"/>
<xs:element name="TEST4" minOccurs="0" maxOccurs="1" nillable="false" type="xs:string"/> 
```

我使用了以下命令：xsd.exe MyClass.xsd /classes /language:vb /f

产生了以下结果：

```
'''<remarks/>
Public TEST1 As String

'''<remarks/>
Public TEST2 As String

'''<remarks/>
<System.Xml.Serialization.XmlElementAttribute(IsNullable:=true)>  _
Public TEST3 As String

'''<remarks/>
Public TEST4 As String 
```

从这个结果来看，似乎无法做到我想要完成的事情。

* * *

## **编辑 2012 年 10 月 17 日：发现一篇有类似问题的帖子**

* * *

对于所有对这个问题感兴趣的人，我发现了一个类似问题的帖子。没有提供解决方案。

[如何使 dotnet webservice 在字符串值上设置 minOccurs=“1”](https://stackoverflow.com/questions/3961112/how-to-make-a-dotnet-webservice-set-minoccurs-1-on-a-string-value?rq=1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T17:36:46.120

据我所知，我所要求的无法通过 .NET 实现自动化。我将不得不手动更改 WSDL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-06T20:09:43.880

我在另一个有同样问题的线程上发布了详细的答案：[How to make a dotnet webservice set minOccurs=“1” on a string value](https://stackoverflow.com/a/16971203/1474915)。

然而，简短的回答是**否定**的。字符串类型是不可能的。

字符串类型有一个默认值*String.Empty*，并且 minOccurs 不会设置为 1 ，除非没有默认值（这只能使用**IsNullable = true**字符串）。

# java - 向 Joda 区间添加句点

> ID：12900429
> 
> 赞同：1
> 
> 时间：2012-10-15T16:59:49.230
> 
> 标签：java, jodatime

快速提问：

我有一天的间隔：

```
Interval interval = new LocalDate().toInterval(DateTimeZone.getDefault()); 
```

假设我想在开头添加一天，在结尾添加一天。现在我使用的方法`withDurationBeforeEnd`并不`withDurationAfterStart`适合我的用例。我错过了什么吗？我正在寻找一些API，例如`Interval.addPeriod(Period period);`

还是我完全错了，应该使用别的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:35:39.450

```
Interval newInterval = new Interval(oldInterval.getStart().minusDays(1), oldInterval.getEnd().plusDays(1)); 
```

# javascript - 更正 jQuery 语法：检查两个选择框选项值并编写单独的输入值

> ID：12900430
> 
> 赞同：1
> 
> 时间：2012-10-15T16:59:50.053
> 
> 标签：javascript, jquery, syntax

```
<script type="text/javascript">
    $(document).ready(function() {
        $('#gender').change(function() {
            if($(this).find('option:selected').val() == 'Male' && $('#size').find('option:selected').val() == 'Large') {
                $('#results').val() == 'Size Large - The Most Basic Size'
            }
            else if($(this).find('option:selected').val() == 'Female' && $('#size').find('option:selected').val() == 'Large') {
                $('#results').val() == 'Size Large - The Second Most Basic Size'
            }
            else {
                $('#results').val() == 'Nothing'
            };
        });
    });
</script> 
```

目标很简单：检查两个选择框的值，并使用第一个选择更改函数更改#results 输入中的值。这可能很简单，但我知道我做错了，因为它不起作用......；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:02:57.503

您以错误的方式设置结果值。试试这个：

```
<script type="text/javascript">
    $(document).ready(function() {
        $('#gender').change(function() {
            if($(this).find('option:selected').val() == 'Male' && $('#size').find('option:selected').val() == 'Large') {
                $('#results').val('Size Large - The Most Basic Size');
            }
            else if($(this).find('option:selected').val() == 'Female' && $('#size').find('option:selected').val() == 'Large') {
                $('#results').val('Size Large - The Second Most Basic Size');
            }
            else {
                $('#results').val('Nothing');
            };
        });
    });
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:03:15.367

您应该将字符串作为参数传递：

```
$('#results').val('Size Large - The Most Basic Size'); 
```

请注意，使用`find`不是必需的，`val`返回所选选项的值：

```
if ($(this).val() == 'Male' && $('#size').val() == 'Large') { 
```

# asynchronous - BeginInvoke 为什么第一个调用先完成？

> ID：12900432
> 
> 赞同：0
> 
> 时间：2012-10-15T16:59:58.150
> 
> 标签：asynchronous, delegates

我正在测试代表，我停止了 BeginInvoke 和 EndInvoke。我想知道这个同伴代码中发生了什么。

我虽然第一个开始调用将在第二个之后终止，因为第二个只有 2 秒，第一个是 3 秒。这不是让它像一个同步调用吗？为什么 ？

似乎只有在使用 EndInvoke 时才调用实际调用。

```
/// <summary>
/// Démonstration d'un appel d'une méthode ASYNCRONE avec BeginInvoke() SANS rappel (Callback).
/// </summary>
public class AsyncBeginInvokeDemo
{
    // Voici la méthode délégué.
    // L'équivalent: Func<int, string> (Func<In1, ..., Out>)
    // Note: Aurait pu être également Action<int> si la méthode ne retourne pas de valeurs.
    delegate string MethodDelegate(int iCallTime, string message);

    /// <summary>
    /// Démarrer la démonstration.
    /// </summary>
    public void Start()
    {
        string strReturnedData = String.Empty;

        // Attaché la méthode au délégué.
        MethodDelegate dlgt = new MethodDelegate(this.LongRunningMethod);

        // Initié l'appel asyncrone A.
        IAsyncResult arA = dlgt.BeginInvoke(3000, "A est terminée!", null, null);

        // Initié l'appel asyncrone B.
        IAsyncResult arB = dlgt.BeginInvoke(2000, "B est terminée!", null, null);

        // Retrieve the results of the asynchronous call.
        strReturnedData = dlgt.EndInvoke(arA);
        Console.WriteLine(strReturnedData);
        strReturnedData = dlgt.EndInvoke(arB);
        Console.WriteLine(strReturnedData);
    }

    /// <summary>
    /// Il s'agit de l'opération à executé.
    /// </summary>
    /// <param name="iCallTime">Temps d'execution de l'opération. (Simulation)</param>
    /// <returns>Données par l'opération. (Simulation)</returns>
    public string LongRunningMethod(int iCallTime, string message)
    {
        // Mettre le thread en attente pendant un nombre de milliseconde x.
        Thread.Sleep(iCallTime);

        // Retourner des données.
        return message;
    }

} 
```

这个输出：

一个est terminée！最好的终结者！

不应该吗？

最好的终结者！一个est terminée！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:07:08.580

你明确地调用`EndInvoke`：

```
strReturnedData = dlgt.EndInvoke(arA); 
```

这将*等到*委托完成。鉴于您正在传递`arA`，它*只能*等待第一个委托调用完成。它不可能对第二个委托调用做任何事情，因为您明确表示您想要第一个委托的结果。

> 似乎只有在使用 EndInvoke 时才调用实际调用。

不，只是你阻塞直到委托*完成*。

如果您在之前添加此代码`return message;`：

```
Console.WriteLine("Finished {0}", message); 
```

然后你会看到输出：

```
Finished B est terminée!
Finished A est terminée!
A est terminée!
B est terminée! 
```

# python - 在 Python 图像库中将 EPS 文件转换为 PNG 时更改输出分辨率

> ID：12900435
> 
> 赞同：2
> 
> 时间：2012-10-15T17:00:13.023
> 
> 标签：python, python-imaging-library, eps

我编写了一个简单的 PIL 实现来将 EPS 文件列表转换为 PNG。

```
import Image
for infile in sys.argv[1:]:
    f, e = os.path.splitext(infile)
    outfile = f+".png"
    try:
        im = Image.open(infile)
        im.save(outfile, dpi = (1000, 1000))
    except IOError:
        print "Error" 
```

虽然 dpi 标志改变了 PNG 的文件分辨率，但它并没有增加 im 对象的分辨率。这意味着我的输出 PNG 图像质量非常低。有没有办法提高 im 对象的分辨率？此代码不起作用。

```
im = Image.open(infile, dpi = (1000, 1000)) 
```

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:15:59.073

查看 /usr/lib64/python2.7/site-packages/PIL/EpsImagePlugin.py 这是通过调用 ghostscript 实现的：

```
# Build ghostscript command
command = ["gs",
           "-q",                    # quite mode
           "-g%dx%d" % size,        # set output geometry (pixels)
           "-dNOPAUSE -dSAFER",     # don't pause between pages, safe mode
           "-sDEVICE=ppmraw",       # ppm driver
           "-sOutputFile=%s" % file,# output file
           "- >/dev/null 2>/dev/null"] 
```

size 选项仅更改图形大小，但不会重新缩放它。也许在这里向 PIL 开发人员报告错误会很有用。

作为解决方法，如果您安装了 ImageMagick 命令行工具，您可以使用它作为解决方法：

```
import os
cmd = 'convert test.ps test.png'
os.system(cmd) 
```

这在我的系统上运行良好，不会降低质量。

此版本对您获得的分辨率提供了更多控制：

```
import os
cmd = "convert -density 300 test.ps test.png"
os.system(cmd) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-29T18:06:50.503

另一种解决方法是使 ps/eps 中的几何图形或文本非常大。对于我的应用程序，我在 EPS 中渲染乳胶并转换为 PNG。我只是将字体大小设置为更大的数字（200 pt），PNG 质量非常完美。如果您正在生成 EPS 内容，这将适用于您。

# ruby-on-rails-3 - 在 Rails 中，关闭指定列的时区转换

> ID：12900437
> 
> 赞同：2
> 
> 时间：2012-10-15T17:00:26.303
> 
> 标签：ruby-on-rails-3, timezone

很简单，我需要禁用特定列的时区转换。我将手动处理任何 TZ 转换，但我需要 Rails 3 来放弃*写入*和*读取*以及任何 AREL 功能的转换。但是，我不想禁用非指定属性的转换。

好的，我知道如何禁用它以供阅读：

```
self.skip_time_zone_conversion_for_attributes = [:test_timestamp] 
```

但这仅适用于*阅读*。编写属性时，它仍然转换为 UTC（是的，我在 3.2.8 中对此进行了测试）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-07T01:54:55.453

正如您所注意到的，`skip_time_zone_conversion_for_attributes`仅适用于阅读，这使得整个功能非常无用。

有两种可能的解决方案：

**1.-**接受时间将以 UTC 编写，并相应阅读：

```
def starts_at # override reader method
  attributes['starts_at'].in_time_zone(whatever_timezone)
end 
```

**缺点：**使用时绕过覆盖的方法`MyModel.pluck(:starts_at).`

**2.-**将时间值存储为字符串，注意以正确的格式写入值，并在所需的时区读取它们。

```
def starts_at
 DateTime.strptime(attributes['starts_at'], whatever_format).in_time_zone(whatever_timezone)
end 
```

**缺点**：失去使用日期运算符（小于、大于）查询数据库的能力。

# sql - 合并而不聚合？

> ID：12900439
> 
> 赞同：2
> 
> 时间：2012-10-15T17:00:34.383
> 
> 标签：sql, sql-server, tsql, select

长话短说，我对 T-SQL 相当陌生，我正在为我们的调度部门查询 JD Edwards 的一些信息。我们是一家制造工厂，包含我们的零件信息和制造每个零件的组件的表对所有组件使用单个列，每个组件都有多行，因此我们可以有一个包含 20 行的零件，我有两个这个查询的问题让我有点难过，第一个是我想在每个工作订单中看到一行，其中包含来自 WO 表的所有零件信息，我在以下查询中使用我们的成品零件编号：

此 WO 和成品的必要列的原始数据：

```
WALITM                      IXLITM                      WADOCO
TF2-10426IA                 CF-S1094P-UL                800059
TF2-10426IA                 CF-S1094P-UL                800059
TF2-10426IA                 CF-S1094P-UL                800059
TF2-10426IA                 CF-S1094P-UL                800059
TF2-10426IA                 TE2-06718                   800059
TF2-10426IA                 TE2-06718                   800059
TF2-10426IA                 TE2-06718                   800059
TF2-10426IA                 TE2-06718                   800059
TF2-10426IA                 RP-TR23                     800059
TF2-10426IA                 RP-TR23                     800059
TF2-10426IA                 RP-TR23                     800059
TF2-10426IA                 RP-TR23                     800059
TF2-10426IA                 RP-BX35                     800059
TF2-10426IA                 RP-BX35                     800059
TF2-10426IA                 RP-BX35                     800059
TF2-10426IA                 RP-BX35                     800059 
```

（抱歉，今天显然是一个完整的 n00b，除了创建一个 HTML 表格之外，无法弄清楚如何将其格式化为表格）

```
 SELECT WO, TF, TE, CAP, LABEL
    FROM (SELECT DISTINCT Sched.dbo.TBS.WADOCO AS WO,
    Sched.dbo.TBS.WALITM AS TF,
    CASE WHEN Part.IXLITM LIKE 'TE%' THEN Part.IXLITM END AS TE,
    CASE WHEN Part.IXLITM LIKE 'CF%' THEN Part.IXLITM END AS CAP,
    CASE WHEN Part.IXLITM LIKE 'LBL%' THEN Part.IXLITM END AS LABEL
    FROM WB.dbo.Part
    INNER JOIN Sched.dbo.TBS ON TBS.WAAITM=Part.IXKITA) AS T2
    WHERE WO=800059 
```

哪个产生：

```
WO          TF            TE          CAP            LABEL
800059      TF2-10426IA   NULL        NULL           NULL
800059      TF2-10426IA   NULL        CF-S1094P-UL   NULL
800059      TF2-10426IA   TE2-06718   NULL           NULL 
```

我已经进行了几次其他尝试，将所有内容组合在一条线上，但没有任何运气，但我认为类似于“Group By”的东西会是理想的......

这个查询的第二部分也让我有点难过，尽管我承认我在上面做了更多的工作，但我需要从 IXLITM 列中提取更多数据`Where IXKITA=[The TE2***] for the TF2*** Number`。

我认为在这两个问题之间，我可能会寻找 T-SQL 之外的解决方案，但我想我会首先向各位专家寻求一些见解。

在此先感谢您的帮助，我们将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T18:07:32.693

尝试这个：

```
SELECT WO, 
       TF, 
       TE, 
       CAP, 
       LABEL 
FROM   (SELECT DISTINCT WADOCO   AS WO, 
                        WALITM   AS TF, 
                        Max(CASE 
                              WHEN IXLITM LIKE 'TE%' THEN PART.IXLITM 
                              ELSE '' 
                            END) AS TE, 
                        Max(CASE 
                              WHEN IXLITM LIKE 'CF%' THEN PART.IXLITM 
                              ELSE '' 
                            END) AS CAP, 
                        Max(CASE 
                              WHEN IXLITM LIKE 'LBL%' THEN PART.IXLITM 
                              ELSE '' 
                            END) AS LABEL 
        FROM   PART 
        GROUP  BY WALITM, 
                  WADOCO)T2 
WHERE  WO = 800059 
```

[SQL Fiddle](http://sqlfiddle.com/#!3/c204b/5)上有一个可行的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T18:06:04.780

```
SELECT DISTINCT Sched.dbo.TBS.WADOCO AS WO,
Sched.dbo.TBS.WALITM AS TF,
TE.IXLITM AS TE,
CF.IXLITM AS CAP,
LBL.IXLITM AS LABEL
FROM Sched.dbo.TBS
LEFT JOIN WB.dbo.Part TE ON TBS.WAAITM = Part.IXKITA AND LEFT(Part.IXLITM,2) = 'TE'
LEFT JOIN WB.dbo.Part CF ON TBS.WAAITM = Part.IXKITA AND LEFT(Part.IXLITM,2) = 'CF'
LEFT JOIN WB.dbo.Part LBL ON TBS.WAAITM = Part.IXKITA AND LEFT(Part.IXLITM,3) = 'LBL'
WHERE WO=800059 
```

# vb.net - VB.NET：默默地失败？

> ID：12900442
> 
> 赞同：1
> 
> 时间：2012-10-15T17:00:42.590
> 
> 标签：vb.net, ide

如果出现问题，我不喜欢 VB.NET 在操作上静默失败的事实：

```
 Dim n(10) As String
    n(11) = "blah" 
```

我不想用 Try/Catch/Finally 来处理这种情况，那将是矫枉过正。在开发期间测试我的应用程序时，我会偶然发现这种情况。

但是 VB.NET 只是跳过这个错误的事实有点烦人。我可以更改 IDE 以使其在此行中中断吗？

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T17:02:21.893

单击调试、异常，然后选中所有复选框。

无论何时在任何地方抛出任何异常，调试器都不会中断，即使随后对其进行了处理。

# python - 尝试通过计算列表列表中的出现次数来添加字典值（Python）

> ID：12900444
> 
> 赞同：2
> 
> 时间：2012-10-15T17:00:46.483
> 
> 标签：python, list, dictionary, count, iteration

我正在尝试获取列表列表中的项目计数，并将这些计数添加到 Python 中的字典中。我已经成功地制作了列表（它是单个广告查看记录的所有可能出现组合的列表）和一个字典，其键等于可能出现的所有值，现在我需要计算每个出现和更改的次数字典中的值到列表列表中对应键的计数。这是我所拥有的：

```
import itertools
stuff=(1,2,3,4)
n=1
combs=list()
while n<=len(stuff):
    combs.append(list(itertools.combinations(stuff,n)))
    n = n+1
viewers=((1,3,4),(1,2,4),(1,4),(1,2),(1,4)) 
recs=list()
h=1
while h<=len(viewers):
    j=1
    while j<=len(viewers[h-1]):
       recs.append(list(itertools.combinations(viewers[h-1],j))) 
       j=j+1
    h=h+1
showcount={}
for list in combs:
    for item in list:
        showcount[item]=0    
for k, v in showcount:
        for item in recs:
            for item in item:
                if item == k:
                    v = v+1 
```

我已经尝试了很多不同的方法来做到这一点，我通常要么得到“太多的值来解包”错误，要么根本没有填充。发布了几个类似的问题，但我对 Python 还很陌生，而且没有一个真正解决了我需要足够接近让我弄清楚的问题。非常感谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-15T17:07:57.520

使用 a[`Counter`](http://docs.python.org/library/collections.html#counter-objects)而不是普通的 dict 来计算事物：

```
from collections import Counter

showcount = Counter()
for item in recs:
    showcount.update(item) 
```

甚至：

```
from collections import Counter
from itertools import chain

showcount = Counter(chain.from_iterable(recs)) 
```

如您所见，这使您的代码变得*非常*简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-09T22:13:34.043

我有一些类似于该问题的旧代码，它可能对面临类似问题的人有用。

```
import sys
file = open(sys.argv[-1], "r").read()
wordictionary={}
for word in file.split():
    if word not in wordictionary:
        wordictionary[word] = 1
    else:
        wordictionary[word] += 1
sortable = [(wordictionary[key], key) for key in wordictionary]
sortable.sort()
sortable.reverse()
for member in sortable: print (member) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:08:16.897

首先，使用生成器表达式“展平”列表：`(item for sublist in combs for item in sublist)`。

然后，遍历展平列表。对于每个项目，您可以向 dict 添加一个条目（如果它不存在），或者向值添加一个。

```
d = {}
for key in (item for sublist in combs for item in sublist):
    try:
        d[key] += 1
    except KeyError:  # I'm not certain that KeyError is the right one, you might get TypeError. You should check this
        d[key] = 1 
```

该技术假定子列表的所有元素都是可散列的并且可以用作键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T17:13:02.417

如果您只想展平列表列表，则可以使用 itertools.chain()

```
>>> import itertools
>>> listOfLists = ((1,3,4),(1,2,4),(1,4),(1,2),(1,4)) 
>>> flatList = itertools.chain.from_iterable(listOfLists) 
```

集合模块中的 Counter 对象可能会完成您想要的其余工作。

```
>>> from collections import Counter
>>> Counter(flatList)
Counter({1: 5, 4: 4, 2: 2, 3: 1}) 
```

# ios - 如何使用 UITableViewHeaderFooterView？

> ID：12900446
> 
> 赞同：51
> 
> 时间：2012-10-15T17:00:49.583
> 
> 标签：ios, objective-c, uitableview

嗨，我想`UITableHeaderFooterView`在我的应用程序中使用，我正在这样做：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
    [_tableView registerClass:[M3CTableViewCell class] forCellReuseIdentifier:@"cell"];
    [_tableView registerClass:[M3CHeaderFooter class] forHeaderFooterViewReuseIdentifier:@"footer"];

}

- (UITableViewHeaderFooterView *)footerViewForSection:(NSInteger)section {
    M3CHeaderFooter * footer = [[M3CHeaderFooter alloc]initWithReuseIdentifier:@"footer"];
    footer.textLabel.text = @"Test";
    return footer;
} 
```

通过这样做，我在页脚的地方没有得到任何东西。而且这个方法甚至没有被调用，但我认为这个方法是`UITableViewDelegate`协议的一部分。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-12-10T04:07:24.710

使用可重用页眉/页脚视图的新 iOS 6 功能涉及两个步骤。你似乎只做了第一步。

第一步：您通过注册 UITableViewHeaderFooterView 的自定义子类（我假设您的 M3CHeaderFooter 是 UITableViewHeaderFooterView 的子类）来告诉表格视图要为节标题视图使用什么类。

第二步：通过实现 tableView 委托方法，告诉表视图对标题部分使用（和重用）什么视图

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section 
```

所以在你的 viewDidLoad 你会实现这样的东西：

```
 // ****** Do Step One ******
    [_tableView registerClass:[M3CHeaderFooter class] forHeaderFooterViewReuseIdentifier:@"TableViewSectionHeaderViewIdentifier"]; 
```

然后，您将在创建和显示表视图的类中实现表视图委托方法：

```
- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section
{
    return 40.0;
}
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    static NSString *headerReuseIdentifier = @"TableViewSectionHeaderViewIdentifier";

    // ****** Do Step Two *********
    M3CHeaderFooter *sectionHeaderView = [tableView dequeueReusableHeaderFooterViewWithIdentifier:headerReuseIdentifier];
   // Display specific header title
   sectionHeaderView.textLabel.text = @"specific title";   

    return sectionHeaderView;    
} 
```

现在请注意，您不需要子类 UITableViewHeaderFooterView 来使用它。在 iOS 6 之前，如果你想要一个部分的标题视图，你需要实现上面的 tableView 委托方法并告诉表视图每个部分使用什么视图。因此，每个部分都有您提供的 UIView 的不同实例。这意味着如果您的 tableView 有 100 个部分，并且在委托方法中您创建了一个 UIView 的新实例，那么您将为显示的 100 个部分标题为 tableView 提供 100 个 UIView。

使用可重用页眉/页脚视图的新功能，您可以创建 UITableViewHeaderFooterView 的实例，系统会为每个显示的节标题重用它。

如果您想拥有一个可重用的 UITableViewHeaderFooterView 而无需子类化，那么您只需将 viewDidLoad 更改为：

```
// Register the class for a header view reuse.
[_buttomTableView registerClass:[UITableViewHeaderFooterView class] forHeaderFooterViewReuseIdentifier:@"TableViewSectionHeaderViewIdentifier"]; 
```

然后你的委托方法：

```
- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section
{
    return 40.0;
}
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    static NSString *headerReuseIdentifier = @"TableViewSectionHeaderViewIdentifier";

   // Reuse the instance that was created in viewDidLoad, or make a new one if not enough.
    UITableViewHeaderFooterView *sectionHeaderView = [tableView dequeueReusableHeaderFooterViewWithIdentifier:headerReuseIdentifier];
    sectionHeaderView.textLabel.text = @"Non subclassed header";

    return sectionHeaderView;

} 
```

我希望这已经足够清楚了。

**编辑：** 子类化标题视图时，如果您希望向 headerView 添加自定义视图，则可以实现类似于以下的代码：

```
 // Add any optional custom views of your own
    UIView *customView = [[UIView alloc] initWithFrame:CGRectMake(0.0, 0.0, 50.0, 30.0)];
    [customView setBackgroundColor:[UIColor blueColor]];

    [sectionHeaderView.contentView addSubview:customView]; 
```

在子类中执行此操作，而不是 viewForHeaderInSection: 委托方法（如下面的 Matthias 所述），将确保仅创建任何子视图的一个实例。然后，您可以在子类中添加任何允许您访问自定义子视图的属性。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-05T20:49:48.093

UITableViewHeaderFooterView 是少数几个我会以编程方式处理视图而不是使用 Storyboard 或 XIB 的地方之一。由于您不能正式使用外观代理，并且没有 IB 方法可以在不滥用 UITableViewCells 的情况下做到这一点。我用老式的方式来做，只使用标签上的标签来获取自定义元素。

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    UITableViewHeaderFooterView *headerView = [tableView dequeueReusableHeaderFooterViewWithIdentifier:kSectionHeaderReuseIdentifier];
    if (headerView == nil) {
        [tableView registerClass:[UITableViewHeaderFooterView class] forHeaderFooterViewReuseIdentifier:kSectionHeaderReuseIdentifier];
        headerView = [tableView dequeueReusableHeaderFooterViewWithIdentifier:kSectionHeaderReuseIdentifier];
    }

    UILabel *titleLabel = (UILabel *)[headerView.contentView viewWithTag:1];
    if (titleLabel == nil) {
        UIColor *backgroundColor = [UIColor blackColor];
        headerView.contentView.backgroundColor = backgroundColor;
        titleLabel = [[UILabel alloc] initWithFrame:CGRectMake(10.0f, 0.0f, 300.0f, 44.0f)];
        titleLabel.textColor = [UIColor whiteColor];
        titleLabel.backgroundColor = backgroundColor;
        titleLabel.shadowOffset = CGSizeMake(0.0f, 0.0f);
        titleLabel.tag = 1;
        titleLabel.font = [UIFont systemFontOfSize:24.0f];
        [headerView.contentView addSubview:titleLabel];
    }

    NSString *sectionTitle = [self.sections objectAtIndex:section];
    if (sectionTitle == nil) {
        sectionTitle = @"Missing Title";
    }

    titleLabel.text = sectionTitle;

    return headerView;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-02-18T14:46:59.050

这是一篇旧帖子并且有很好的答案，但我想分享另一个解决我遇到的非常相似的问题的方法。

起初，我使用：

```
-(UIView *) tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section 
```

使用我的标题视图的自定义原型单元格。这样子类化 UITableViewCell

```
 static NSString *cellIdentifier = @"CustomHeaderCell";
CustomHeaderCell * cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier]; 
```

但是，当为节标题上方的 TableView 单元格设置动画时（使它们高一倍），标题视图会消失。正如所指出的，这是因为实现只提供了一个视图，而不是一个可重用的视图。

我没有放弃自定义原型单元格的所有内容，而是实现了 UITableViewHeaderFooterWithIdentifier 并将其设置为原型单元格的 contentView，而没有继承 UITableViewHeaderFooterWithIdentifier。

```
 static NSString *customHeaderViewIdentifier = @"CustomHeaderView";
UITableViewHeaderFooterView *headerView = [tableView dequeueReusableHeaderFooterViewWithIdentifier:customHeaderViewIdentifier];

headerView = (UITableViewHeaderFooterView *)cell.contentView; 
```

我意识到这会创建标题视图的两个实例（至少我认为它会......）但是它确实允许您保留自定义原型单元的好处，而无需以编程方式进行所有操作。

完整代码：

```
 // viewDidLoad
    [myTableView registerClass:[UITableViewHeaderFooterView class] forHeaderFooterViewReuseIdentifier:@"CustomHeaderView"];

// Implement your custom header
 -(UIView *) tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
     static NSString *cellIdentifier = @"CustomHeaderCell";
    CustomHeaderCell * cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];

    static NSString *customHeaderViewIdentifier = @"CustomHeaderView";
    UITableViewHeaderFooterView *headerView = [tableView dequeueReusableHeaderFooterViewWithIdentifier:customHeaderViewIdentifier];

// do your cell-specific code here
// eg. cell.myCustomLabel.text = @"my custom text"

    headerView = (UITableViewHeaderFooterView *)cell.contentView;

return headerView;
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-05-10T22:10:27.557

有几种方法可以解决这个问题，但这是**Swift**中的一种解决方案：这里的想法是我们有一个`UITableViewHeaderFooterView`被调用的子类`SNStockPickerTableHeaderView`；它公开了一个名为的方法，`configureTextLabel()`该方法在调用时设置文本标签的字体和颜色。我们仅在设置标题后调用此方法，即 from, `willDisplayHeaderView`，并且字体设置正确。

标题视图还支持自定义行分隔符，以将其与其他单元格区分开来。

```
// MARK: UITableViewDelegate

func tableView(tableView:UITableView, willDisplayHeaderView view:UIView, forSection section:Int) {
  if let headerView:SNStockPickerTableHeaderView = view as? SNStockPickerTableHeaderView {
    headerView.configureTextLabel()
  }
}

func tableView(tableView:UITableView, viewForHeaderInSection section:Int) -> UIView? {
  var headerView:SNStockPickerTableHeaderView? = tableView.dequeueReusableHeaderFooterViewWithIdentifier(kSNStockPickerTableHeaderViewReuseIdentifier) as? SNStockPickerTableHeaderView
  if (headerView == nil) {
    // Here we get to customize the section, pass in background color, text 
    // color, line separator color, etc. 
    headerView = SNStockPickerTableHeaderView(backgroundColor:backgroundColor,
      textColor:primaryTextColor,
      lineSeparatorColor:primaryTextColor)
  }
  return headerView!
} 
```

这是习俗`UITableViewHeaderFooterView`：

```
import Foundation
import UIKit

private let kSNStockPickerTableHeaderViewLineSeparatorHeight:CGFloat = 0.5
private let kSNStockPickerTableHeaderViewTitleFont = UIFont(name:"HelveticaNeue-Light", size:12)

let kSNStockPickerTableHeaderViewReuseIdentifier:String = "stock_picker_table_view_header_reuse_identifier"

class SNStockPickerTableHeaderView: UITableViewHeaderFooterView {

  private var lineSeparatorView:UIView?
  private var textColor:UIColor?

  required init(coder aDecoder: NSCoder) {
    fatalError("init(coder:) has not been implemented")
  }

  // We must implement this, since the designated init of the parent class
  // calls this by default!
  override init(frame:CGRect) {
    super.init(frame:frame)
  }

  init(backgroundColor:UIColor, textColor:UIColor, lineSeparatorColor:UIColor) {
    super.init(reuseIdentifier:kSNStockPickerTableHeaderViewReuseIdentifier)
    contentView.backgroundColor = backgroundColor
    self.textColor = textColor
    addLineSeparator(textColor)
  }

  // MARK: Layout

  override func layoutSubviews() {
    super.layoutSubviews()
    let lineSeparatorViewY = CGRectGetHeight(self.bounds) - kSNStockPickerTableHeaderViewLineSeparatorHeight
    lineSeparatorView!.frame = CGRectMake(0,
      lineSeparatorViewY,
      CGRectGetWidth(self.bounds),
      kSNStockPickerTableHeaderViewLineSeparatorHeight)
  }

  // MARK: Public API

  func configureTextLabel() {
    textLabel.textColor = textColor
    textLabel.font = kSNStockPickerTableHeaderViewTitleFont
  }

  // MARK: Private

  func addLineSeparator(lineSeparatorColor:UIColor) {
    lineSeparatorView = UIView(frame:CGRectZero)
    lineSeparatorView!.backgroundColor = lineSeparatorColor
    contentView.addSubview(lineSeparatorView!)
  }
} 
```

这是结果，请参阅“热门股票”部分的标题：

                              ![在此处输入图像描述](../Images/9d293b0df84a54e99ec935f09085b8d1.png)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-07-16T01:34:12.943

我无法在[Cameron Lowell Palmer 的帖子](https://stackoverflow.com/a/18067457/3160700)下发表评论，但要回答 Christopher King，有一种简单的方法可以确保在不对 UITableViewHeaderFooterView 进行子类化的情况下重复使用，但仍使用自定义子视图。

首先，不要为标题视图重用注册该类。

然后在 tableView:viewForHeaderInSection: 你只需要在需要时创建 UITableViewHeaderFooterView ：

```
-(UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    static NSString *kYourTableViewReusableHeaderIdentifier = @"ID";

    UILabel *titleLabel = nil;

    UITableViewHeaderFooterView *headerView = [tableView dequeueReusableHeaderFooterViewWithIdentifier:kYourTableViewReusableHeaderIdentifier];

    if (headerView == nil) {

        headerView = [[UITableViewHeaderFooterView alloc] initWithReuseIdentifier:kYourTableViewReusableHeaderIdentifier];

        titleLabel = [[UILabel alloc] initWithFrame:CGRectMake(...)];
        titleLabel.tag = 1;
        // ... setup titleLabel 

        [headerView.contentView addSubview:titleLabel];
    } else {
        // headerView is REUSED
        titleLabel = (UILabel *)[headerView.contentView viewWithTag:1];
    }

    NSString *sectionTitle = (...); // Fetch value for current section
    if (sectionTitle == nil) {
        sectionTitle = @"Missing Title";
    }

    titleLabel.text = sectionTitle;

    return headerView;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-04T19:01:00.473

这是一种“快速而肮脏”的方式来实现这一目标。它将在标题中制作一个小的蓝色标签。我已经确认这在 iOS 6 和 iOS 7 中可以正常工作。

在你的 UITableViewDelegate 中：

```
 -(void)viewDidLoad
{
...
    [self.table registerClass:[UITableViewHeaderFooterView class] forHeaderFooterViewReuseIdentifier:@"Header"];
...
}

- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section
{
    return 34.;
}

- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    UITableViewHeaderFooterView *header = [tableView dequeueReusableHeaderFooterViewWithIdentifier:@"Header"];

    UILabel *leftlabel = [[UILabel alloc] initWithFrame:CGRectMake(0., 0., 400., 34.)];
    [leftlabel setBackgroundColor:[UIColor blueColor]];

    [header.contentView addSubview:leftlabel];
    return header;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-22T19:50:26.293

万一它在上面的彻底答案中迷失了，人们可能遗漏的事情（与标准`cellForRowAtIndexPath:`方法相比）是您必须注册用于节标题的类。

```
[tableView registerClass:[UITableViewHeaderFooterView class] forHeaderFooterViewReuseIdentifier:@"SectionHeader"]; 
```

尝试添加`registerClass:forHeaderFooterViewReuseIdentifier:`，看看它是否开始工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-02-08T17:08:31.480

该方法可能未被调用的原因之一是表格的样式。标准与分组处理页眉/页脚的方式不同。这可以解释为什么它没有被调用。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-10-15T17:09:50.920

1.  设置实例的`delegate`属性`UITableView`以引用实现下一个方法的控制器：

2.  返回节页脚视图的方法：

    > 要求委托将视图对象显示在表视图的指定部分的页脚中。 `- (UIView *)tableView:(UITableView *)tableView viewForFooterInSection:(NSInteger)section`

3.  部分页脚中的视图高度：

    > 向代理询问用于特定部分页脚的高度。
    > 
    > `- (CGFloat)tableView:(UITableView *)tableView heightForFooterInSection:`(NSInteger) 部分

# java - 在 Restful 客户端中检索枚举的 PostgreSQL 类型

> ID：12900452
> 
> 赞同：1
> 
> 时间：2012-10-15T17:01:03.640
> 
> 标签：java, postgresql, jpa, netbeans, glassfish

我在 PostgreSQL 数据库`current_status`的表中有一个枚举类型字段。`history`枚举定义为：

```
CREATE TYPE et_status AS ENUM
   ('PENDING', 'SUCCESS', 'LATE', 'EARLY', 'FAILED', 'IN_PROGRESS', 'EXPIRED');
```

我在服务器端添加了一个枚举类型，并对相关字段的类型以及 getter 和 setter 进行了一些更改。这看起来像：

```
@Entity
@Table(name = "history")
@XmlRootElement
@NamedQueries({ ... })
public class History implements Serializable {
    public enum StatusType implements Serializable
        {PENDING, SUCCESS, SUCCESS_LATE, SUCCESS_EARLY,
         FAILED, IN_PROGRESS, EXPIRED};

...

    @Lob
    @Column(name = "current_status")
    private StatusType currentStatus;

...

    public StatusType getCurrentStatus() {
        return currentStatus;
    }

    public void setCurrentStatus(StatusType currentStatus) {
        this.currentStatus = currentStatus;
    }
} 
```

在测试 Web 服务时，我收到以下错误：

```
The object [PENDING], of class [class org.postgresql.util.PGobject], from mapping
[org.eclipse.persistence.mappings.DirectToFieldMapping[currentStatus-->history.current_status]]
with descriptor [RelationalDescriptor(entities.History --> [DatabaseTable(history)])],
could not be converted to [class java.lang.Integer].
```

搜索互联网产生了[这个解决方案](http://softteco.blogspot.com/2009/12/postgres-enum-java-enum-and-jpa.html)，但它似乎需要使用我的安装中似乎没有的 org.hibernate.annotations.TypeDef。

问题：通过 RESTful Web 服务从 PostgreSQL 枚举类型转换为 Java 枚举类型的正确方法是什么？

数据库：PostgreSQL 8.4
应用服务器：Glassfish 3.1.2.2
IDE：NetBeans 7.2
JDK：7 更新 7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:12:25.600

不要使用@Lob，而是尝试@Enumerated(EnumType.STRING)。

但是，您必须确保 java 中的名称与 postgresql 中的名称完全匹配（它们在您当前的代码中没有）。

# php - PHP 连接到 AIM TOC

> ID：12900455
> 
> 赞同：6
> 
> 时间：2012-10-15T17:01:10.000
> 
> 标签：php, bots, aol, aim, oscar-protocol

2010 年年中，我发现了一个名为**PHPToCLib**的类库。它完美地运行了一年多——我能够将大量我自己的自定义代码实现到一个 AIM Bot 中，我可以从我的 CMD 提示符中运行它。然而，在 2011 年底，服务器停止响应脚本。它连接到端口**5190上的****toc.oscar.aol.com**，并且没有更改。我确实知道 AOL 停止了他们的 TOC2 服务器，并且无法再与他们连接。但是，我下载了一个名为**[TerraIM](https://terraim.en.softonic.com/)**的程序，它使用相同的规范并且能够以某种方式连接到它们。我想知道是否有任何关于如何让我的脚本连接的更新，如果是这样，我需要改变什么？

 **先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T11:56:40.413

TerraIM 还支持我认为它默认的 OSCAR 协议。如果您正在使用 IM 机器人，那么绝对最好的方法是利用 libpurple。不幸的是，没有一个好的 PHP 绑定到 libpurple。有几个 python 绑定。如果您不想迁移您的代码，有一个实现提供了一个 HTTP 接口，根据您的用例，它可能很容易集成。或者，您可以使用 thrift 在现有 PHP 代码和 python 绑定之间进行交流——这需要比利用 HTTP 接口更多的编码。以下是一些您可能会觉得有帮助的资源：

Python绑定：

github.com/fahhem/python-purple

github.com/Raptr/Heliotrope

HTTP 绑定的 HTTP 接口：

github.com/atamurad/http-purple

节约：

[http://thrift.apache.org/](http://thrift.apache.org/)**

# javascript - couchdb 减少非键值

> ID：12900456
> 
> 赞同：1
> 
> 时间：2012-10-15T17:01:10.243
> 
> 标签：javascript, mapreduce, couchdb

我在 couchdb 中有一个数据集，其中包含多个文档，其中列出了时间戳和一组来自传感器的信号。在此示例中，我只使用了几个不同的名称，但随着向系统中添加额外的传感器，可能会有无数不同的名称。以下是三个示例文档的示例：

```
{ timestamp: 12345,
  signals: ["highTemperature", "highPressure"]
}

{ timestamp: 12346,
  signals: ["highTemperature"]
}

{ timestamp: 12347,
  signals: ["lowPressure", "highTemperature"]
} 
```

我想做的是获得每个标签的频率。一个简单的方法是创建一个这样的地图函数：

```
function (doc) {
  for (var idx in doc.signals) {
  emit(doc.signals[idx], 1);
} 
```

除了这样的reduce函数：

```
function(signal, counts) {
  var sum = 0;
  for(var i = 0; i < counts.length; i++) {
    sum += counts[i]; 
  };
  return sum; 
} 
```

这将返回一组不错的数据，如下所示：

```
{"rows":[
  {"key":"highTemperature","value":3},
  {"key":"highPressure","value":1},
  {"key":"lowPressure","value":1}
]} 
```

如果我想知道一直以来的信号分布，这很好，但我真的想知道数据点子集的标签分布，比如时间戳 12346 - 12349。但是，我不能做的是切片使用时间戳记数据`startkey`，`endkey`因为时间戳记不是键的一部分。如果我让时间戳是关键，那么我无法减少以获得信号的分布。

有没有办法进行这样的分组，以便减少不属于键的元素？理想情况下，我想通过 URL 参数指定分组间隔，例如：`/mydb/_design/main/_view/signalsByTime?startkey=12346&endkey=12347`并让它返回该时间段的信号分布，如下所示：

```
{"rows":[
  {"key":"highTemperature","value":2},
  {"key":"lowPressure","value":1}
]} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:46:59.060

如果您想`timestamp`成为关键且可能信号的数量非常小（`O(1)`，假设您的示例中为 3），那么您可以在信号的`map`特征向量中发出：

```
if (doc.signal == "highTemperature") {
  emit(doc.timestamp, [1,0,0]);
} else if (doc.signal == "highPressure") {
  emit(doc.timestamp, [0,1,0]);
} ... 
```

和中的向量求和`reduce`，可能像这样：

```
function(keys, values) {
  var sum = [0,0,0];
  for (v in values) {
    for (s in sum) {
      sum[s] += values[v][s];
    }
  }
  return sum; 
} 
```

# websphere - 版本更改时未抛出 OptimisticLockException

> ID：12900460
> 
> 赞同：3
> 
> 时间：2012-10-15T17:01:35.460
> 
> 标签：websphere, jpa-2.0, ejb-3.1, openjpa, optimistic-locking

我创建了一个简单的 EJB 应用程序，该应用程序使用 JPA 进行持久性，并且遇到了一个问题，即乐观锁定没有像我预期的那样运行。

该应用程序包含一个名为的类，该类`Site`定义了数据库中名为 SITE 的表的模型。SITE 表包含一个名为 ROW_VERSION 的列，该列在`Site`类中使用`@version`注释进行引用。

每当更新记录时，ROW_VERSION 都会增加 1。到目前为止，一切都很好。

当应用程序使用该`EntityManager find`方法读取行和该方法更新行之间的时间行发生变化时，就会出现问题`EntityManager merge`。由于该行的 ROW_VERSION 已增加 1，因此与`EntityManager find`调用该方法时不同，因此我希望`OptimisticLockException`抛出一个，而是将更改写入表并进而覆盖所做的更改其他过程。

该应用程序在 WebSphere 8.5 上运行，并使用容器提供的 OpenJPA。

我是否误解了乐观锁定应该如何工作，或者我需要做些什么来实现这一点`OptimisticLockException`？

站点类如下：

```
@Entity
@Table(name="SITE")
public class Site {

    @Id
    @Column(name="SITE_ID")
    private int id;
    @Column(name="SITE_NAME")
    private String siteName;
    @Column(name="SITE_ADDRESS")
    private String address;
    @Column(name="ROW_VERSION")
    @Version
    private long rowVersion;

    //getters and setters
} 
```

应用程序使用 Generic DAO 包装类来调用 EntityManager 方法。课程内容如下：

```
public abstract class GenericDAO<T> {
    private final static String UNIT_NAME = "Test4EJB";

    @PersistenceContext(unitName = UNIT_NAME)
    private EntityManager em;

    private Class<T> entityClass;

    public GenericDAO(Class<T> entityClass) {
        this.entityClass = entityClass;
    }

    public T update(T entity) {
        return em.merge(entity);
    }

    public T find(int entityID) {
        return em.find(entityClass, entityID);
    }
    //other methods
} 
```

**更新**- 我做了更多调查，发现了这个[http://pic.dhe.ibm.com/infocenter/wasinfo/v8r0/index.jsp?topic=%2Fcom.ibm.websphere.nd.multiplatform.doc% 2Finfo%2Fae%2Fae%2Fcejb_genversionID.html](http://pic.dhe.ibm.com/infocenter/wasinfo/v8r0/index.jsp?topic=%2Fcom.ibm.websphere.nd.multiplatform.doc%2Finfo%2Fae%2Fae%2Fcejb_genversionID.html)但即使我添加了@VersionColumn 和@VersionStrategy 注释，我仍然无法抛出OptimisticLockException。

# itextsharp - iTextSharp 表格页面水平跨越

> ID：12900461
> 
> 赞同：1
> 
> 时间：2012-10-15T17:01:41.483
> 
> 标签：itextsharp

我在 iTextSharp 中有一张桌子，但它相当宽。我需要它能够跨越这样的页面：

第 1 页 第 2 页

第 3 页 第 4 页

我似乎找不到文件说明这是否可能。我该怎么做？理想情况下，我可以说 Page1 和 Page3 有 Columns1-3，而 Page2 和 Page4 有 Columns4-6。

是可能的，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T05:53:19.667

您需要`WriteSelectedRows`“iText in Action”第 4 章中描述的方法。

*   Java 示例： http: [//itextpdf.com/examples/iia.php ?id=90](http://itextpdf.com/examples/iia.php?id=90)
*   对应的C#示例： http: [//kuujinbo.info/iTextInAction2Ed/index.aspx ?ch=Chapter04&ex=Zhang](http://kuujinbo.info/iTextInAction2Ed/index.aspx?ch=Chapter04&ex=Zhang)

请注意，这将需要您测量行的高度，因为您必须选择特定的行，并且您必须将表格的不同部分定位在绝对位置。

# f# - 如何使用 fscheck 生成数据？

> ID：12900470
> 
> 赞同：3
> 
> 时间：2012-10-15T17:02:18.440
> 
> 标签：f#, fscheck

是否可以使用 fscheck 生成数据，特别是列表，以便在 fscheck 之外使用？我无法调试 fscheck 测试中看起来比较结果相等的情况，但 fscheck 说它们不是。

我有一个对象列表的生成器。如何生成可以从此生成器使用的列表？

```
let genListObj min max  = Gen.listOf Arb.generate<obj> |> Gen.suchThat (fun l -> (l.Length >= min) && (l.Length <= max)) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T11:52:44.653

编辑：这个函数现在是 FsCheck API (Gen.sample) 的一部分，所以你不再需要下面的......

这是一个从给定生成器生成 n 个样本的示例函数：

```
let sample n gn  = 
   let rec sample i seed samples =
       if i = 0 then samples
       else sample (i-1) (Random.stdSplit seed |> snd) (Gen.eval 1000 seed gn :: samples)
   sample n (Random.newSeed()) [] 
```

编辑：那里的 1000 幻数代表生成值的大小。1000 相当大 - 例如，序列的长度将在 0 到 1000 个元素之间，字符串也是如此。如果生成需要很长时间，您可能需要调整该值（或将其作为函数的参数）。

# javascript - 工具提示：JavaScript 标题操作与仅标题

> ID：12900471
> 
> 赞同：-5
> 
> 时间：2012-10-15T17:02:19.640
> 
> 标签：javascript, html, tooltip, title

我什么时候想使用 JavaScript 来操作标题属性，而不是仅使用标题属性来获取工具提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:17:40.203

如果您希望工具提示在表单过程中发生变化，您将使用 Javascript。例如，如果您想在单击按钮后显示不同的提示，那么您可以在按钮的单击处理程序中设置工具提示。

如果工具提示永远不会改变，那么只需将其包含在元素中。

# python - 从函数返回 SQL 结果作为数组

> ID：12900477
> 
> 赞同：2
> 
> 时间：2012-10-15T17:02:34.383
> 
> 标签：python

由于查询返回超过 1 个结果，在 Get_results 类中，我如何将 data_out 作为数组返回以迭代查询结果？

```
import psycopg2
import sys

class Get_results():
    def db_call(self,query,dbHost,dbName,dbUser,dbPass):
        try:
            con = None
            con = psycopg2.connect(host=dbHost, database=dbName,
                                   user=dbUser, password=dbPass)
            cur = con.cursor()
            cur.execute(query)
            data = cur.fetchall()
            for data_out in data:
                return data_out
        except psycopg2.DatabaseError, e:
                print 'Error %s' % e
                sys.exit(1)
        finally:
            if con:
                con.close()

 sql = " some sql "
 w = Get_results()
 for i in  w.db_call(sql, dbHost, dbName, dbUser, dbPass):
     print "The result is : " + i 
```

对于附加信息，如果我在得到结果`print data`后 立即添加`data = cur.fetchall()`：

```
[('The_Galaxy', 'The_Galaxy:star'),
 ('The_Galaxy', 'The_Galaxy:planet')] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T17:15:04.970

直接的答案是改变：

```
for data_out in data:
    data_out result 
```

到：

```
for data_out in data:
    yield data_out 
```

但是您应该考虑使用`with`语句（如果 DB API 支持它），并简化代码 - 这可以通过创建生成器函数来完成（一个类是 OTT）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T17:19:38.313

```
import psycopg2
import sys

class Get_results():
    def db_call(self,query,dbHost,dbName,dbUser,dbPass):
        try:
            con = None
            con = psycopg2.connect(host=dbHost, database=dbName,
                                   user=dbUser, password=dbPass)
            cur = con.cursor()
            cur.execute(query)
            data = cur.fetchall()  
            resultList = []  
            for data_out in data:  
                resultList.append(data_out[1])  

            return resultList   
        except psycopg2.DatabaseError, e:
                print 'Error %s' % e
                sys.exit(1)
        finally:
            if con:
                con.close()

 sql = " some sql "
 w = Get_results()
 for i in  w.db_call(sql, dbHost, dbName, dbUser, dbPass):
     print "The result is : " + i 
```

# forms - CodeIgniter - 将类添加到下拉列表中的选项

> ID：12900479
> 
> 赞同：0
> 
> 时间：2012-10-15T17:02:39.053
> 
> 标签：forms, codeigniter

我正在使用 jQuery.chained，因此当您从下拉列表中选择国家/地区时，它会过滤省/州下拉列表。然而，它要求每个`<option>`人都有一个对应国家的类名。

这是我到目前为止所拥有的

```
$options = array(
    //Canada
    "AB" => "Alberta",
    "BC" => "British Columbia",
    "MB" => "Manitoba",
    //etc...

    //United States
    "AL" => "Alabama",
    "AK" => "Alaska",
    "AZ" => "Arizona",
    //etc...
);

echo form_dropdown('province', $options, $province); 
```

这给了我

```
<option value="AB" selected="selected">Alberta</option>
<option value="BC">British Columbia</option>
<option value="MB">Manitoba</option>

<option value="AL">Alabama</option>
<option value="AK">Alaska</option>
<option value="AZ">Arizona</option> 
```

但我需要的是

```
<option value="AB" class="canada" selected="selected">Alberta</option>
<option value="BC" class="canada">British Columbia</option>
<option value="MB" class="canada">Manitoba</option>

<option value="AL" class="us">Alabama</option>
<option value="AK" class="us">Alaska</option>
<option value="AZ" class="us">Arizona</option> 
```

那么我将如何为每个`<option>`. 我假设我可能需要一个自定义助手，但我不知道如何创建一个。我是编码新手。谁能帮我？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:14:52.667

利用

```
echo form_dropdown('province', $options, $province,'class="someclass"'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T18:01:11.680

您可以扩展默认的 form_helper、创建自定义帮助程序或通过 JavaScript 添加类。

CodeIgniter 已创建，因此您可以非常轻松地覆盖现有代码

创建自定义助手

*   打开“codeigniter/helpers/form_helper.php”
*   找到“ **form_dropdown** ”函数，将其复制到一个新文件中并保存为“application/helpers/MY_form_helper.php”
*   对下拉菜单的原始方法进行任何更改，并为函数**form_dropdown使用相同的名称保存它**

您将像使用旧助手一样加载/使用新助手。

```
$this->load->helper('form'); 
```

另一个选项是在调用 jQuery 插件之前通过 JavaScript 添加类，具体取决于您的代码技能水平，您可能会发现此选项更容易。

CodeIgniter 的用户指南是一个非常有用的[信息来源](http://codeigniter.com/user_guide/general/helpers.html)

希望如果您在编写实际功能后写出您已经尝试过的内容时会有所帮助，我可能会为您提供帮助，另一种选择是从另一个基于 CodeIgniter 的应用程序中获取帮助程序，或者寻找 Spark。我知道 CI-Bonfire 有一个非常有用的地址助手，我很确定我也看到了一个 Spark。

# php - Array_walk 遍历 10000 个项目。可以优化吗？

> ID：12900481
> 
> 赞同：3
> 
> 时间：2012-10-15T17:02:45.370
> 
> 标签：php, arrays, query-optimization, laravel

我的代码正在使用 array_walk 遍历一个数组，该数组包含大约 10.000 个项目。查询需要 5.19 秒来获取记录，但遍历数组需要 19.86 秒。我可能没有什么可以做的来加快速度？

问题以 json 格式返回，并由 jquery dataTables 插件用于创建表。该插件似乎对这么多条目没有问题（至少在 Firefox 上没有）。

我正在使用 laravel 框架。请参阅下面的控制器代码

```
$start = microtime(true);
$questions = Question::with(array('tags', 'category'))->get();
$now = microtime(true) - $start;
echo "<h3>FETCHED QUESTIONS: $now</h3>";
array_walk($questions, function(&$value, $key) {
    $value = $value->to_array();
    if (empty($value['category'])) $value['category'] = '--';
    if (empty($value['difficulty'])) $value['difficulty'] = '--';
    $value['difficulty'] = HTML::difficulty_label($value['difficulty']);
    $value['approved'] = HTML::on_off_images($value['approved'], 'approved', 'declined');
    $value['active'] = HTML::on_off_images($value['active'], 'active', 'disabled');
    $value['edit_link'] = '<a href="' . URL::to('admin/editquestion/' . $value['id']) . '">' . HTML::image('img/icons/pencil.png', 'edit question') ; '</a>';
});

$spent = microtime(true) - $start - $now;
$now = microtime(true) - $start;
echo "<h3>AFTER WALK: $now ($spent)</h3>";
$out = array('aaData' => $questions);
return json_encode($out); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:07:00.440

只需自己循环数组`foreach`即可避免进行 10000 次函数调用的惩罚：

```
foreach($questions as &$value) {
    $value = $value->to_array();
    if (empty($value['category'])) $value['category'] = '--';
    if (empty($value['difficulty'])) $value['difficulty'] = '--';
    $value['difficulty'] = HTML::difficulty_label($value['difficulty']);
    $value['approved'] = HTML::on_off_images($value['approved'], 'approved', 'declined');
    $value['active'] = HTML::on_off_images($value['active'], 'active', 'disabled');
    $value['edit_link'] = '<a href="' . URL::to('admin/editquestion/' . $value['id']) . '">' . HTML::image('img/icons/pencil.png', 'edit question') ; '</a>';
} 
```

# delphi - TXMLDocument 的替代品？

> ID：12900487
> 
> 赞同：5
> 
> 时间：2012-10-15T17:03:12.080
> 
> 标签：delphi, dll, delphi-xe, txmldocument

最近我们将代码从 Delphi 2009 升级到 Delphi XE 并更新了我们的 Indy 组件（不确定这是否相关）。

但是从那以后，我们在 Windows Server 2003 机器上加载和保存 XML 文件时遇到了错误。

```
XMLDoc.LoadFromFile()
XMLDoc.SaveToFile() 
```

![以下是错误](../Images/398398eea1917d157100cf19bcd92952.png)

与其他操作系统上的超过 600kb 相比，Windows Server 2003 上的 DLL msvcrt.dll 小得多（300kb 左右）......所以它在该文件中丢失了一些东西并导致错误......

有谁知道如何解决这一问题？`TXMLDocument`或者有没有我可以尝试的替代方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:56:28.510

默认情况下，`TXMLDocument`/`IXMLDocument`只是在 Windows 平台上运行时围绕 MSXML COM 接口的包装器。Indy 和 Indy都`TXMLDocument`没有使用该`_ftol2_sse()`函数，甚至没有链接到 msvcrt.dll。您项目中的其他问题有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T11:21:22.267

msvcrt.dll 是 Microsoft Visual C++ 运行时的（一部分）。我认为您有一个不包含此功能的此运行时的较旧（甚至可能是较新）版本。

现在您必须找出调用此函数的位置。您是否将 obj 文件与您的项目链接或使用（其他）第 3 方 dll？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-08T15:32:31.577

要回答最后一部分（“有替代方案吗？”），您可能需要查看 Jedi Code Library 的`TJclSimpleXML`课程。它不需要任何外部 DLL，速度非常快，而且非常易于使用。此外，如果你在 Delphi 中编码，现在 JCL 和 JVCL 是必不可少的。

我相信[http://wiki.delphi-jedi.org/wiki/JEDI_Code_Library是他们的页面。](http://wiki.delphi-jedi.org/wiki/JEDI_Code_Library)我听说在西雅图你可以通过 IDEs 集成包管理器获得它。

# android - 使用 ImageView 旋转 Android 活动会将 ImageView 缩小到 1px

> ID：12900488
> 
> 赞同：0
> 
> 时间：2012-10-15T17:03:11.967
> 
> 标签：android, layout, rotation, imageview

我有一个活动，用户可以通过意图选择照片。预期的行为如下：

*   图像的大小可以填充父宽度（减去边距）。
*   这种尺寸永远不会增加图像，只需在需要时缩小。
*   纵横比应该总是准确的。
*   高度应与宽度完全一样，以保持正确的纵横比。
*   在纵向模式下，最大高度在滚动出现之前可以达到多少（只需填满屏幕）。
*   这意味着如果受高度限制，宽度可能不会完全拉伸到父宽度。
*   在横向模式下，最大高度无关紧要，因为允许滚动，宽度应该始终是父宽度。

这是我正在使用的纵向 XML 布局：

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"    
                 android:layout_width="fill_parent"
                 android:layout_height="fill_parent"
                 android:orientation="vertical"
                 android:background="@drawable/gray_background"
                 android:weightSum="1" >

      <!-- Other controls here -->

      <ImageView android:id="@+id/imgView"
                 android:layout_gravity="center"
                 android:layout_margin="5dip"
                 android:layout_width="fill_parent"
                 android:layout_height="0dip"                
                 android:contentDescription="@string/ImageToSend"
                 android:adjustViewBounds="true"
                 android:layout_weight="1"
                 android:scaleType="fitCenter" />

      <!-- Other controls here -->
   </LinearLayout> 
```

这是我正在使用的 Landscape XML 布局：

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:fillViewport="true">
   <!-- Other controls are here -->      
   <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"    
                 android:layout_width="fill_parent"
                 android:layout_height="wrap_content"
                 android:orientation="vertical"
                 android:background="@drawable/gray_background" >

       <ImageView android:id="@+id/imgView"
                  android:layout_gravity="center"
                  android:layout_margin="5dip"
                  android:layout_width="fill_parent"
                  android:layout_height="0dip"                
                  android:contentDescription="@string/ImageToSend"
                  android:adjustViewBounds="true"
                  android:layout_weight="1"
                  android:scaleType="fitCenter" />

   <!-- Other controls are here -->      
   </LinearLayout>
</ScrollView> 
```

无论我在什么视图中，这都能正常工作。我遇到的问题是，当用户旋转设备时，ImageView 不再具有正确的大小。如果我首先在横向模式下选择图像，旋转看起来很好。如果我首先选择纵向模式的图像，然后切换到横向模式，则图像现在显示为 1px x 1px。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:06:42.690

经过一段时间的失败后，我发现调用 setContentView() 并重做布局解决了这个问题。不确定这是否是我应该做的，但它已经解决了。

# jquery - 将 jquery 过滤器下拉列表更改为复选框

> ID：12900492
> 
> 赞同：0
> 
> 时间：2012-10-15T17:03:17.993
> 
> 标签：jquery, filtering, jquery-filter

我正在制作一个谈论水果及其价格的网站。
我有制作下拉列表的代码，它选择一个选项，然后在单击该选项时将其缩小，然后还有另一个选项可以进一步缩小它。这就像一个魅力，但我不想要一个下拉框，我想要复选框。

这是代码：

```
<select id="fruit" class="friltro">
    <option value="all">All fruits</option>
    <option value="apple">apple</option>
    <option value="orange">orange</option>
    <option value="pineapple">pineapple</option>
</select>
<select id="price" class="friltro">
    <option value="all">All prices</option>
    <option value="1">$1</option>
    <option value="3">$3</option>
    <option value="4">$4</option>
</select> 
```

我尝试更改 html 和 jquery 但是当我尝试过滤掉它时它根本不起作用

```
<input type="checkbox" id="price" value="all" class="filtro" >
<label for="filrtro" >all</label>
<input type="checkbox" id="price" value="apple" class="filtro" >
<label for="filrtro" >apple</label>

$('.friltro').change(function () {
    var criteria = '';
    var showAll = true;
    $('.friltro').each(function () {
        var val = $(this).children(':selected').val();
        if (val !== 'all') {
            criteria += '.' + $(this).attr('id') + '-' + val;
            showAll = false;
        }
    });
    if (showAll) {
        $('.item').show();
    } else {
        $('.item').hide();
        $(criteria).show();
    }
});​ 
```

我应该改变什么？

# image - 下载带有“非法”字符的图像

> ID：12900494
> 
> 赞同：-1
> 
> 时间：2012-10-15T17:03:25.397
> 
> 标签：image, download, bulk

我正在为客户迁移一家商店。

我必须从她没有 FTP 访问权限的“商店”中提取所有旧图像文件。

它允许我导出文件名/url 列表。我的计划是在 Firefox 中加载它们并使用“Downloadthemall”来简单地下载所有文件。（大约 2000 年）。然而，大约 1 1/3 有 [ 和 ] 。

IE

cdn.crapshop.com/images/image[1].jpg

Downloadthemall 吓坏了，只把它读作

cdn.crapshop.com/images/image

并且不会下载它，因为它不是文件。

任何人都对另一种方法来提取这样的列表有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:24:39.810

请参阅此解决方案，解释您提供的示例 URL 无效的原因：[Validation](https://stackoverflow.com/questions/1547899/which-characters-make-a-url-invalid)。在您查看该帖子后，您会发现，在@good 提供的答案中，您必须使用百分比编码对不符合规范的字符进行编码，以便网络服务器能够理解它们。

这需要 python ......请参阅这篇文章：[python 中的百分比编码](https://stackoverflow.com/questions/12114853/percent-encoding-url-with-python)

然后我们可以将它们放在一个脚本中，您将使用该脚本从 stdin 读取并输出到 stdout: `python script.py < input > output.out`。

```
import urllib, sys

while 1:
    try:
        line = sys.stdin.readline()

    except KeyboardInterrupt:
        break

    if not line:
        break

    print urllib.quote(line.strip(), safe=':').strip('\'') 
```

然后，希望下载它们都将解析已被脚本更正的文件列表（该脚本的输入应该是由换行符分隔的 url 列表）。

您可能也对这篇文章感兴趣：[使用 python 下载文件](https://stackoverflow.com/questions/862173/how-to-download-a-file-using-python-in-a-smarter-way)。它向您展示了如何使用 python 下载文件（尤其是网页）。

祝你好运！

# stl - ndk 使用 Visual Studio 文件构建

> ID：12900499
> 
> 赞同：0
> 
> 时间：2012-10-15T17:04:06.973
> 
> 标签：stl, android-ndk

我正在使用本机类构建一个 android 应用程序。问题是有一些调用OpenCV的cpp文件和调用VC的opencv头文件包括jni中没有提供的。所以我该怎么做？创建一个新的opencv文件夹并将那里的每个opencv文件更改为正确的路径？或任何其他方式来配置它？因为我不想更改原来的 opencv 文件夹。那是用于VC编程的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:11:58.417

`<algorithm>`是 STL 标头之一。您应该在 NDK 中启用 STL 支持，如 [docs/CPLUSPLUS-SUPPORT.html](http://gitorious.org/mingw-android-ndk/mingw-android-ndk/blobs/e144b4a3d50f8182805424186d9ccba3e7466391/docs/CPLUSPLUS-SUPPORT.html)文档中所述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T17:19:12.743

指出事情。我需要把它们放到 Application.mk 中。认为这个文件是可选的。

# database - 重新排序数组表行并更新数据库

> ID：12900503
> 
> 赞同：0
> 
> 时间：2012-10-15T17:04:21.950
> 
> 标签：database, arrays, sql-update, sorting

我一直在寻找一种方法来做某事，并且我确信我一直在使用错误的搜索条件来寻找解决方案......所以，我来了。

我在内容管理系统中有一个下拉菜单，当创建新页面或编辑位置时，数据库会使用新的或编辑的值更新......这一切都很好。

但是，我想做的是......当页面位置的数字从比方说位置 5 更改为位置 1...以前的位置编号 1 更改为位置编号 2...并且每个任何剩余页面的位置编号都会相应地重新编号。

所以，我的问题是，我如何更新我的数据库，所以，每当我在下拉菜单中更改页面的位置时，所有位置值都会得到，我不知道，一个 +1 ......或者什么......和另外，不允许两个位置值相同……你知道，只能有一个……

在此先感谢...希望我在解释我想做的事情时做得不错:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:16:15.537

您是否尝试过类似的方法：

```
UPDATE my_table SET position=position+1 WHERE position>2 AND position<5 
```

where 语句应该是您刚刚更新的那个的新位置和旧位置

# reporting-services - 修改后的 Reporting Services 报告 - RDL 没有改变？

> ID：12900505
> 
> 赞同：2
> 
> 时间：2012-10-15T17:04:32.967
> 
> 标签：reporting-services, ssrs-2008, rdl

我的 Reporting Services 2005 报告有一个错误：“参数 UserID 是只读的”。经过一番研究，我找到了一个可行的解决方案。我从 Report Manager Web 界面打开了报告并更改了以下内容：

![前](../Images/7c04e96d7ae88f1480733f6018b26973.png)

..对此：

![后](../Images/5678d7c2e6b9a2991f18a7ee69939046.png)

更改后，报告有效！伟大的！

所以，我想我会下载修改后的 RDL，这样我就可以看到更改并将更正后的 RDL 放入我的源代码存储库中。所以，我下载了 RDL：

![下载 RDL](../Images/ab4044cfdc098587332d58adde639101.png)

但是我的差异工具告诉我，RDL 的“之前”版本与 RDL 的“之后”版本相同。确信我的差异工具是错误的，我尝试了另一个。果然，RDL 没有区别。

我错过了什么？更改是否反映在 RDL 以外的其他地方，或者 Reporting Services 没有提供正确版本的 RDL？无论哪种情况，我如何才能获得正确版本的 RDL？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:43:51.810

**TL/DR 版本：** Reporting Services*没有*为您提供正确的 RDL。

* * *

您的问题促使我进一步调查我在 SSRS 上已有一段时间的怀疑：**在部署（或下载）报告定义时，报告参数可能会以报告开发人员意想不到的方式运行**。我之前注意到的一个相关场景：

1.  创建带有参数的报告。
2.  首次部署报告。
3.  以某种方式更新报告参数。
4.  再次部署相同的报告。
5.  **结果：**参数设置*未*在服务器上成功更新。
6.  从报告管理器中删除报告。
7.  再次部署报告（实际上与步骤 2 相同）。
8.  **结果：**报告参数*正确*更新。

简而言之，如果您想更新已部署报表的参数设置，您首先需要将其删除然后部署，或者直接通过报表管理器更新设置。

回到您的问题。您没有遗漏任何东西，这似乎是 SSRS 的行为方式（有意或无意）。[RDL 模式](http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition/ReportDefinition.xsd)有这个（缩写）部分：

```
<xsd:complexType name="ReportParameterType">
    <xsd:choice minOccurs="1" maxOccurs="unbounded">
        <xsd:element name="DataType">
            <!-- abbreviated -->
        </xsd:element>
        <xsd:element name="Nullable" type="xsd:boolean" minOccurs="0"/>
        <xsd:element name="DefaultValue" type="DefaultValueType" minOccurs="0"/>
        <xsd:element name="AllowBlank" type="xsd:boolean" minOccurs="0"/>
        <xsd:element name="Prompt" type="xsd:string" minOccurs="0"/>
        <xsd:element name="ValidValues" type="ValidValuesType" minOccurs="0"/>
        <xsd:element name="Hidden" type="xsd:boolean" minOccurs="0"/>
        <xsd:element name="MultiValue" type="xsd:boolean" minOccurs="0"/>
        <xsd:element name="UsedInQuery" minOccurs="0">
    </xsd:choice>
    <xsd:attribute name="Name" type="xsd:normalizedString" use="required"/>
</xsd:complexType> 
```

因此，您的 ReportParameter 应该有一个“隐藏”元素。

我刚刚验证了您的发现（在 SSRS 2008 中），并且认为我可能已经回答了您的第二个问题：**SSRS 确实*没有*提供正确版本的 RDL**。它缺少有关参数的各种位，包括是否隐藏的元素。

有趣的是：如果您在 BIDS 中更改报表并将参数设置为隐藏，则 RDL*将*被更改并具有`<Hidden>true</Hidden>`元素。

# xquery - XQuery 节点是序列

> ID：12900512
> 
> 赞同：1
> 
> 时间：2012-10-15T17:04:46.990
> 
> 标签：xquery, node-set, functx

`is-node-in-sequence-deep-equal`在 XQuery 中吗？我想知道，因为我在[xqueryfunctions.com](http://www.xqueryfunctions.com/xq/functx_is-node-in-sequence-deep-equal.html)上看到过该功能，但我无法使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T18:15:17.280

该函数是 FunctX XQuery 库的一部分。有两种方法可以使用此功能：

1.  您[下载整个库](http://www.xqueryfunctions.com/xq/download.html)（选择与您的 XQuery 版本相对应的下载），将其保存在与您的 XQuery 程序/文件相同的目录中，然后将模块导入您的 XQuery 文件中，例如：

    ```
    import module namespace functx = "http://www.functx.com" at "functx-1.0-doc-2007-01.xq";

    (: Insert your code here and call the is-node-in-sequence-deep-equal function as seen below :)

    functx:is-node-in-sequence-deep-equal($node, $seq) 
    ```

2.  除了下载具有所有功能的整个库之外，您还可以简单地复制粘贴您需要的特定功能，如[您链接到的页面](http://www.xqueryfunctions.com/xq/functx_is-node-in-sequence-deep-equal.html)上所示：

    ```
    declare namespace functx = "http://www.functx.com"; 
    declare function functx:is-node-in-sequence-deep-equal 
      ( $node as node()? ,
        $seq as node()* )  as xs:boolean {

       some $nodeInSeq in $seq satisfies deep-equal($nodeInSeq,$node)
     } ;

    (: Insert your code here and call the 'is-node-in-sequence-deep-equal' function as seen below :)

    functx:is-node-in-sequence-deep-equal($node, $seq) 
    ```

在这两个示例中，您只需将`$node`和替换`$seq`为您的变量。

# c++ - OpenCV 2.42 FeatureDetector FREAK

> ID：12900514
> 
> 赞同：10
> 
> 时间：2012-10-15T17:04:56.120
> 
> 标签：c++, opencv

我想尝试`FREAK`OpenCV 2.4.2 中的新课程。

我尝试使用特征检测器的通用接口来构造`FREAK`，但是，它当然不起作用。我应该如何修改我的代码以获得结果？

```
#include <stdio.h>
#include <iostream>
#include <opencv\cxcore.h>
#include <opencv2\nonfree\features2d.hpp>
#include <opencv\highgui.h>
#include <opencv2\features2d\features2d.hpp>
#include <vector>

using namespace std;
using namespace cv;

int main(){
    Mat mat1;
    mat1 = imread("Testimg06.jpg",0);
    vector<KeyPoint> P1;
    Ptr<FeatureDetector> freakdes;
    Ptr<DescriptorExtractor> descriptorExtractor; 
    freakdes = FeatureDetector::create("FREAK"); 

    freakdes->detect(mat1,P1);

    Mat keypoint_img;

    drawKeypoints( mat1, P1, keypoint_img, Scalar::all(-1), DrawMatchesFlags::DEFAULT );
     imshow("Keypoints 1", keypoint_img );
    cvWaitKey(0);

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-15T18:13:04.643

FREAK 只是描述符。没有对应的特征检测器。

因此，您需要将其与可用的检测器之一结合使用：FAST、ORB、SIFT、SURF、MSER 或使用`goodFeaturesToTrack`函数。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-12T07:54:52.733

有一个 OpenCV[示例](http://fossies.org/dox/OpenCV-2.4.3/freak__demo_8cpp_source.html)展示了如何将 FREAK 与 FAST 结合使用。

基本说明如下：

```
FREAK extractor;
BruteForceMatcher<Hamming> matcher;
std::vector<KeyPoint> keypointsA, keypointsB;
Mat descriptorsA, descriptorsB;
std::vector<DMatch> matches;

FAST(imgA,keypointsA,10);
FAST(imgB,keypointsB,10);

extractor.compute( imgA, keypointsA, descriptorsA );
extractor.compute( imgB, keypointsB, descriptorsB );

matcher.match(descriptorsA, descriptorsB, matches); 
```

# javascript - listview（'刷新'）不工作jqm 1.2

> ID：12900519
> 
> 赞同：0
> 
> 时间：2012-10-15T17:05:17.807
> 
> 标签：javascript, jquery, jquery-mobile

当我在 jquery mobile 1.2 中动态更改可折叠列表的 h2 内容时，h2 标签会丢失它的格式。

调用 listview('refresh') 似乎并没有解决它。

有任何想法吗？

```
<div id="mylist" data-role="collapsible" data-theme="a" data-content-theme="a" data-mini="true" >
<h2>Choose...</h2>
<ul data-role="listview">
<li data-mini="true"><a href="#">Item 1</a></li>
<li data-mini="true"><a href="#">Item 2</a></li>
<li data-mini="true"><a href="#">Item 3</a></li>
</ul>
</div>

<script>
$("#mylist li").live( 'click',function(event){

$("#mylist h2").text($(this).text());
$("#mylist").listview('refresh');

});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:18:20.010

您正在覆盖 jQuery Mobile 为您的可折叠小部件创建的 HTML 结构。`<h2>`从 jQuery Mobile 初始化后，您尝试更新的元素的 HTML 结构如下所示：

```
<h2 class="ui-collapsible-heading ui-collapsible-heading-collapsed">
    <a href="#" class="ui-collapsible-heading-toggle ui-btn ui-mini ui-btn-icon-left ui-corner-top ui-corner-bottom ui-btn-up-a" data-corners="false" data-shadow="false" data-iconshadow="true" data-wrapperels="span" data-icon="plus" data-iconpos="left" data-theme="a" data-mini="true">
        <span class="ui-btn-inner ui-corner-top ui-corner-bottom">
            <span class="ui-btn-text">
                Choose...
                <span class="ui-collapsible-heading-status"> click to expand contents</span>
            </span>
            <span class="ui-icon ui-icon-plus ui-icon-shadow">&nbsp;</span>
        </span>
    </a>
</h2> 
```

因此，考虑到这种 HTML 结构，您的代码应该以`.ui-btn-text`元素内的`<h2>`元素为目标。

例如：

```
$(document).on('click', "#mylist li", function(event){
    $("#mylist h2 .ui-btn-text").text($(this).text());
});​ 
```

这是一个演示：http: [//jsfiddle.net/XDnGs/](http://jsfiddle.net/XDnGs/)

# jquery - 在 jQuery 插件中使用超时，同时仍然保持可链接性

> ID：12900522
> 
> 赞同：3
> 
> 时间：2012-10-15T17:05:26.137
> 
> 标签：jquery, jquery-plugins

我正在尝试创建一个内部具有超时功能的 jQuery 插件。这是我现在所拥有的基本思想。它工作正常，但它不保持可链接性。

```
;(function( $ ) {
    $.fn.myPlugin = function(length) {
        th = $(this);
        th.css('animation', 'none');
        setTimeout((function(th) {
            return function() { 
                th.css('display', 'block');
            };
        })(this), length);
    };
})( jQuery ); 
```

为了尝试使其可链接，我创建了它，但它不运行 TimeOut 函数中的代码。

```
;(function( $ ) {
    $.fn.myPlugin = function(length) {
        return this.each(function() {
            th = $(this);
            th.css('animation', 'none');
            setTimeout((function(th) {
                return function() { 
                    th.css('display', 'block');
                };
            }),(this), length);
        });
    };
})( jQuery ); 
```

这是没有链接的插件：http: [//jsfiddle.net/FhARs/1/](http://jsfiddle.net/FhARs/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:48:27.277

这个正在工作，这是你想要的吗？

```
;(function( $ ) {
    $.fn.myPlugin = function(length) {
        return this.each(function() {
            th = $(this);
            th.css('display', 'none');
            setTimeout(function() {
                th.css('display', 'block');
            }, length);
        });
    };
})( jQuery ); 
```

[**演示**](http://jsfiddle.net/FhARs/2/)。

# maven - 即使已在其父 pom 文件的依赖项管理部分中声明了依赖项，也缺少 dependencies.dependency.version

> ID：12900525
> 
> 赞同：14
> 
> 时间：2012-10-15T17:05:31.250
> 
> 标签：maven, dependency-management

如前所述，我的项目中的依赖项：树目标抱怨缺少已在其父 pom 的依赖项管理部分中声明的依赖项的依赖项版本。请注意，有问题的依赖项是一个新的依赖项，刚刚添加到管理部分。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-10-15T17:05:31.250

确实，父 pom 已经在依赖管理部分包含了依赖声明。但它没有被考虑在内。为此，我们应该执行命令在本地 maven repo 中安装 pom 文件。

`mvn -f <the absolute path to the parent's pom file> install -N`

请注意，当 maven 解析依赖项时，它总是会查找 repo 中已经可用的 pom 文件。相反，不考虑本地文件。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-05-08T19:49:04.717

Maven 抱怨缺少依赖项的另一个原因是父 pom 中声明的依赖项的 <type> 与子 pom 正在寻找的类型不对应。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-21T17:44:00.500

我会将此添加为对王慧的回答的评论，但由于某种原因，评论似乎被禁用。

无论如何，就我而言，我不得不使用以下命令：

```
mvn -f <path to the parent's pom file> install -N 
```

我正在使用 maven 3，所以它可能与 maven 2 不同。

如果没有 -f，我无法让 Hui 的命令工作，并且父 pom 文件的路径不必是绝对的（相对和绝对都有效）。

# sql-server-2005 - CTE 数据转换错误 - 可以使用临时表

> ID：12900527
> 
> 赞同：0
> 
> 时间：2012-10-15T17:05:34.853
> 
> 标签：sql-server-2005, common-table-expression, type-conversion

所以，我有一个抛出错误的 CTE：`Msg 8114, Level 16, State 5, Line 1 Error converting data type nvarchar to float.` 问题是，如果我将 CTE 分解为临时表，一切运行正常！

下面是对我正在做的事情的轻微简化（数据类型是准确的，我只是重命名了一些东西，创建了虚假数据，删除了几个额外的连接以及似乎不会影响错误的 where 子句等）......请注意，此示例确实可以正常工作，这只会增加我的困惑：

```
--Build and populate sample data
create table vals
(
    groupID int,
    valName nvarchar(50),
    val     nvarchar(50)
)
insert into vals(groupID, valName, val)
select 1, 'setting1', '12:00' union
select 1, 'setting2', '18:00' union
select 1, 'setting3', '3.2' union
select 2, 'setting1', '9:00' union
select 2, 'setting3', '4' union
select 2, 'setting5', 'steve'

create table collected
(
    groupID int,
    timeUTC datetime,
    collected float
)
insert into collected(groupID, timeUTC, collected)
select 1, '2012-09-12 18:00', 2.8 union
select 1, '2012-09-12 18:30', 3.0 union
select 1, '2012-09-12 19:00', 3.3 union
select 1, '2012-09-12 19:30', 4.0 union
select 1, '2012-09-12 20:00', 2.5 union
select 2, '2012-09-12 18:00', 3.5 union
select 2, '2012-09-12 18:30', 3.9 union
select 2, '2012-09-12 19:00', 4.6 union
select 2, '2012-09-12 19:30', 4.2 union
select 2, '2012-09-12 20:00', 4.3

--Here's the CTE that errors on the actual dataset
;with triggerVal as (
    select groupID,
        [trg] = min(cast(val as float))
    from vals
    where valName = 'setting3'
    group by groupID
), currentVal as (
    select c.groupID, c.timeUTC,
        [curr] = c.collected
    from collected c
        join (
            select groupID, [lastTime] = max(timeUTC)
            from collected
            group by groupID
        ) l on c.groupID=l.groupID
            and c.timeUTC = l.lastTime
)
select t.groupID, c.timeUTC, t.trg, c.curr
from triggerVal t
    join currentVal c on t.groupID=c.groupID 
```

同样，在我的实时数据中，如果我将上述 CTE 分解为临时表 (`#triggerVal`和`#currentVal`)，一切运行正常。虽然修改代码对我来说并不是世界末日，但我真的很想了解发生了什么！

# mysql - 错误代码：1136。列计数与第 1 行的值计数不匹配

> ID：12900531
> 
> 赞同：2
> 
> 时间：2012-10-15T17:05:53.357
> 
> 标签：mysql

我正在尝试在 MYSQL 上插入以下信息，但不断收到上述错误？即使我只是尝试插入其中一个值，它也会不断出错。

```
CREATE TABLE depositor
    (depositor_name   char(30),
    depositor_number  varchar(20),
    PRIMARY KEY (depositor_number),
    FOREIGN KEY (depositor_name)  REFERENCES depositor(depositor_name));

INSERT INTO depositor VALUES("Johnson", "A-101");
INSERT INTO depositor VALUES("Smith",   "A-215");
INSERT INTO depositor VALUES("Hayes",   "A-102");
INSERT INTO depositor VALUES("Hayes",   "A-101");
INSERT INTO depositor VALUES("Turner",  "A-305");
INSERT INTO depositor VALUES("Johnson", "A-201");
INSERT INTO depositor VALUES("Jones",   "A-217");
INSERT INTO depositor VALUES("Lindsay", "A-222");
INSERT INTO depositor VALUES("Majeris", "A-333");
INSERT INTO depositor VALUES("Smith",   "A-444");

SELECT * FROM DEPOSITOR 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-11-07T10:09:38.410

以防万一它帮助任何人。

我在表 X 上触发插入和更新时遇到此错误。插入和更新查询没有任何问题。我发现有触发器将正在更新/插入的行插入到其他表 Y。它的列数不相等。所以它抛出了这个错误。一旦我更改了 Y 的表结构，错误就解决了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:12:48.060

用单引号替换双引号：

```
INSERT INTO depositor VALUES('Johnson', 'A-101'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:20:14.540

外键引用自己，这没有任何意义（实际上我很惊讶 MySQL 允许你创建它：我尝试时遇到错误；也许你的`CREATE TABLE`命令在你没有注意到的情况下失败了，你正试图`INSERT`进入一些没有两列的表的先前版本？）。

删除外键约束（和`DROP`任何现有表）。

# ruby-on-rails - 尝试上传图片时未启动 js.erb 文件

> ID：12900532
> 
> 赞同：1
> 
> 时间：2012-10-15T17:05:59.143
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, fancybox, simple-form

我在一个花式盒子里有这个表格：

```
<%= simple_form_for(@message, :remote => true, :html => {:multipart => true}, :url => { :controller => "users/messages", :action => "create"} ) do |f| %>
 <%= f.error_notification %>
 <%= f.input :subject, :input_html => { :maxlength => 500} %>
 <%= f.input :message_image, :as => :file %>
 <%= f.button :submit, t('.send_message'), :class => 'btn-large btn-primary', "data-disable-with" => t('.send_message'), :confirm => t('.sure_send_message') %>
<% end %> 
```

这是我的创建操作：

```
def create
 @message = Message.new(params[:message])
 respond_to do |format|
  if @message.save
   format.js { render :partial => "users/messages/templates/sent_by_user/create" }
  else
   format.js { render :partial => "users/messages/templates/sent_by_user/nosave" }
  end
 end 
end 
```

如果我不尝试上传图片，文件`create.js.erb`或文件工作正常`nosave.js.erb`

如果我尝试上传图像，则不会呈现此文件。

但是在我的日志中我可以看到：

```
Processing by Users::MessagesController#create as JS
  Parameters: {"message"=>{"message_image"=>#<ActionDispatch::Http::UploadedFile:0xf7a85c8 @original_filename="cara_enfadada.jpg", @content_type="image/jpeg", @headers="Content-Disposition: form-data; name=\"message[message_image]\"; filename=\"cara_enfadada.jpg\"\r\nContent-Type: image/jpeg\r\n", @tempfile=#<File:/tmp/RackMultipart20121015-21710-6oxtn2>>, "subject"=>"estrella de neutronessssssssssss"}, "commit"=>"Enviar mensaje", "utf8"=>"✓", "authenticity_token"=>"mfSsl0HafWoW86YiO2Hj7zMepAITZlHHBtUqW0wzubU=", "remotipart_submitted"=>"true", "X-Requested-With"=>"IFrame", "X-Http-Accept"=>"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01", "locale"=>"es"} 
```

和

```
Rendered users/messages/templates/sent_by_user/_nosave.js.erb (0.2ms)
Completed 200 OK in 498ms (Views: 1.5ms | Solr: 0.0ms) 
```

在 google chrome 控制台上，我收到下一个警报：

```
Resource interpreted as Document but transferred with MIME type text/javascript: 
```

**我正在使用 remotipart gem 但我没有找到错误...错误在哪里？谢谢**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:14:51.743

我永远不会执行 js.erb 因为人们可以使用 ajax 直接上传文件（在你的情况下是图像）

您可能想考虑**remotipart**或**pupload**或**jqueryfile_upload**或**uplodify** 来实现

我确定 remotipart 使用 iframe

上传使用运行时支持html5或flash

上传使用闪存

不确定 jqueryfile_upload 从未尝试过

祝你好运

# spring - 弹簧安全注销处理程序不起作用

> ID：12900534
> 
> 赞同：2
> 
> 时间：2012-10-15T17:06:03.790
> 
> 标签：spring, grails, spring-security

我有 grails 插件 spring-security-core-1.2.1

我在 grails-app/conf/spring/resources.groovy 中将安全事件侦听器注册为 spring bean：

```
securityEventListener(LoggingSecurityEventListener) 
```

并在 grails-app/conf/Config.groovy 中添加两个内容：

```
grails.plugins.springsecurity.useSecurityEventListener = true
grails.plugins.springsecurity.logout.handlerNames =
    ['rememberMeServices',
            'securityContextLogoutHandler',
            'securityEventListener'] 
```

我的日志/注销监听器

```
class LoggingSecurityEventListener implements ApplicationListener<AbstractAuthenticationEvent>, LogoutHandler {

            void onApplicationEvent(AbstractAuthenticationEvent event) {
                System.out.println('appEvent')
            }

            void logout(HttpServletRequest request, HttpServletResponse response,
                            Authentication authentication) {
                System.out.println('logout')
            }

} 
```

在 ApplicationEvent 上运行良好，但注销不起作用可能是什么问题？

或者您可以告诉如何获取所有日志记录用户

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:13:52.560

当你设置

```
grails.plugins.springsecurity.useSecurityEventListener = true 
```

spring 安全插件将注册它自己的事件侦听器，称为`securityEventListener`. 查找的处理程序`handlerNames`可能正在让插件注册一个而不是你的。尝试将您的 bean 重命名为：

```
loggingSecurityEventListener(LoggingSecurityEventListener) 
```

并替换`handlerNames`为

```
grails.plugins.springsecurity.logout.handlerNames = 
    ['rememberMeServices',
     'securityContextLogoutHandler',
     'loggingSecurityEventListener'] 
```

注意：配置属性名称已更改 ( `plugins`-> `plugin`)。如果您使用的是 grails spring-security 插件 2.0 或更高版本，请使用：

```
grails.plugin.springsecurity.logout.handlerNames 
```

# paypal - ActiveMerchant PaypalExpressGateway 参考交易

> ID：12900536
> 
> 赞同：0
> 
> 时间：2012-10-15T17:06:05.307
> 
> 标签：paypal, activemerchant

有没有办法使用 ActiveMerchant 的 PaypalEpressGateway 对任意金额进行计费，而无需每次都将用户送回 Paypal？看起来该`reference_transaction`方法可能支持使用计费协议，但文档并没有真正指定它需要什么。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-16T15:54:58.323

您可以联系 PayPal 支持团队，他们将指导您

联系电子邮件是 ppmts@paypal.com

# arrays - " Request.QueryString "索引超出了数组的范围。

> ID：12900537
> 
> 赞同：1
> 
> 时间：2012-10-15T17:06:11.407
> 
> 标签：arrays, vb.net, query-string, indexoutofboundsexception

到目前为止，我只通过查询字符串发送一个空数组。

```
selectPONumber=[] 
```

不知道为什么我会收到此错误。堆栈跟踪将 Next 指向此。

```
If context.Request.QueryString("selectPONumber").Count <> 0 Then
    For u = 1 To request.QueryString("selectPONumber").Count
        selectPONumber.Add(request.QueryString("selectPONumber")(u))
    Next
End If 
```

如果 .Count 为 0，它是如何通过 if 的？我的查询字符串格式不正确吗？

如果它有值，它看起来像

```
selectPONumber=[value1, value2,...] 
```

提前谢谢了！

**额外学分**

是的，vb.net 在使用 [] 时没有将 selectPONumber 读取为数组。只需要做 selectPONumber=value1, value2,...

非常感谢您的上述和其他！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:11:48.610

你是说你的查询字符串看起来像这样吗？

```
mysite/mypage.aspx?selectPONumber=[] 
```

如果是这样，您将传递字符串 "[]" 和`Context.Request.QueryString("selectPONumber").Count == 2`. 它将评估为 0 `mysite/mypage.aspx?selectPONumber=`。

此外，VB.NET 数组是从零开始的。采用：

```
For u = 0 To request.QueryString("selectPONumber").Count-1 
```

# linux - 在 Unix/Linux 中判断两个文件是否具有相同内容的最快方法？

> ID：12900538
> 
> 赞同：288
> 
> 时间：2012-10-15T17:06:13.090
> 
> 标签：linux, file, unix, diff

我有一个 shell 脚本，我需要在其中检查两个文件是否包含相同的数据。我对很多文件执行此操作，并且在我的脚本中，该`diff`命令似乎是性能瓶颈。

这是行：

```
diff -q $dst $new > /dev/null

if ($status) then ... 
```

是否有更快的方法来比较文件，也许是自定义算法而不是默认算法`diff`？

* * *

## 回答 #1

> 赞同：475
> 
> 时间：2012-10-15T17:15:56.240

我相信`cmp`会在第一个字节差异处停止：

```
cmp --silent $old $new || echo "files are different" 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2015-10-01T01:01:55.730

我喜欢@Alex Howansky 为此使用了'cmp --silent'。但我需要正面和负面的回应，所以我使用：

```
cmp --silent file1 file2 && echo '### SUCCESS: Files Are Identical! ###' || echo '### WARNING: Files Are Different! ###' 
```

然后我可以在终端中运行它或使用 ssh 来检查文件与常量文件。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2020-09-20T06:45:11.837

要快速**安全地**比较任意两个文件：

```
if cmp --silent -- "$FILE1" "$FILE2"; then
  echo "files contents are identical"
else
  echo "files differ"
fi 
```

它可读、高效，适用于任何文件名，包括`"` $()`

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2018-11-28T23:27:21.577

因为我很烂并且没有足够的声望点，所以我无法将此花絮添加为评论。

但是，如果您要使用该`cmp`命令（并且不需要/不想冗长），您可以获取退出状态。根据`cmp`手册页：

> 如果 FILE 为“-”或缺失，则读取标准输入。如果输入相同，则退出状态为 0，如果不同，则为 1，如果出现故障，则为 2。

因此，您可以执行以下操作：

```
STATUS="$(cmp --silent $FILE1 $FILE2; echo $?)"  # "$?" gives exit status for each comparison

if [[ $STATUS -ne 0 ]]; then  # if status isn't equal to 0, then execute code
    DO A COMMAND ON $FILE1
else
    DO SOMETHING ELSE
fi 
```

编辑：感谢大家的评论！我在这里更新了测试语法。但是，如果您正在寻找与此答案在可读性、样式和语法方面类似的内容，我建议您使用 Vasili 的答案。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-15T18:38:15.063

对于没有不同的文件，任何方法都需要完全读取这两个文件，即使读取是过去的。

没有替代。因此，在某个时间点创建哈希或校验和需要读取整个文件。大文件需要时间。

文件元数据检索比读取大文件快得多。

那么，是否有任何文件元数据可用于确定文件不同？文件大小 ？甚至只是读取文件一小部分的文件命令的结果？

文件大小示例代码片段：

```
 ls -l $1 $2 | 
  awk 'NR==1{a=$5} NR==2{b=$5} 
       END{val=(a==b)?0 :1; exit( val) }'

[ $? -eq 0 ] && echo 'same' || echo 'different' 
```

如果文件大小相同，那么您将无法读取完整的文件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-08-29T11:02:48.227

您可以通过 sha256 等校验和算法进行比较

```
sha256sum oldFile > oldFile.sha256

echo "$(cat oldFile.sha256) newFile" | sha256sum --check

newFile: OK 
```

如果文件不同，结果将是

```
newFile: FAILED
sha256sum: WARNING: 1 computed checksum did NOT match 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-11-09T17:53:09.537

使用 Raspberry Pi 3B+ 进行一些测试（我使用的是覆盖文件系统，并且需要定期同步），我对 diff -q 和 cmp -s 进行了自己的比较；请注意，这是来自 /dev/shm 内部的日志，因此磁盘访问速度不是问题：

```
[root@mypi shm]# dd if=/dev/urandom of=test.file bs=1M count=100 ; time diff -q test.file test.copy && echo diff true || echo diff false ; time cmp -s test.file test.copy && echo cmp true || echo cmp false ; cp -a test.file test.copy ; time diff -q test.file test.copy && echo diff true || echo diff false; time cmp -s test.file test.copy && echo cmp true || echo cmp false
100+0 records in
100+0 records out
104857600 bytes (105 MB) copied, 6.2564 s, 16.8 MB/s
Files test.file and test.copy differ

real    0m0.008s
user    0m0.008s
sys     0m0.000s
diff false

real    0m0.009s
user    0m0.007s
sys     0m0.001s
cmp false
cp: overwrite âtest.copyâ? y

real    0m0.966s
user    0m0.447s
sys     0m0.518s
diff true

real    0m0.785s
user    0m0.211s
sys     0m0.573s
cmp true
[root@mypi shm]# pico /root/rwbscripts/utils/squish.sh 
```

我跑了几次。cmp -s 在我使用的测试盒上的时间始终稍短。所以如果你想使用 cmp -s 在两个文件之间做一些事情......

```
identical (){
  echo "$1" and "$2" are the same.
  echo This is a function, you can put whatever you want in here.
}
different () {
  echo "$1" and "$2" are different.
  echo This is a function, you can put whatever you want in here, too.
}
cmp -s "$FILEA" "$FILEB" && identical "$FILEA" "$FILEB" || different "$FILEA" "$FILEB" 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-23T00:59:59.433

也尝试使用 cksum 命令：

```
chk1=`cksum <file1> | awk -F" " '{print $1}'`
chk2=`cksum <file2> | awk -F" " '{print $1}'`

if [ $chk1 -eq $chk2 ]
then
  echo "File is identical"
else
  echo "File is not identical"
fi 
```

cksum 命令将输出文件的字节数。请参阅“人 cksum”。

# python - 当分隔符可能存在和不存在时，在列表列表中拆分分隔符

> ID：12900540
> 
> 赞同：0
> 
> 时间：2012-10-15T17:06:19.517
> 
> 标签：python, list, loops, split, delimiter

在分隔存在和不存在“，”分隔符的列表时，是否可以绕过 if 语句？当存在“，”时，我想在下面的列表列表中分隔每个列表。但是，有些列表没有“，”。

```
oldcode = [['a, b'], ['a'], ['a,b,c']]

oldcode_split = []

for code in oldcode:
    oc = code.split(',')
    oldcode_split.append(oc)
print oldcode_split 
```

我想要这个结果：

```
oldcode_split = [['a','b'], ['a'], ['a','b','c']] 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T17:08:24.163

是的，有可能，使用简单的列表理解：

```
In [63]: lis = [['a, b'], ['a'], ['a,b,c']]

In [64]: [x[0].split(',') for x in lis]
Out[64]: [['a', ' b'], ['a'], ['a', 'b', 'c']] 
```

使用`map()`：

```
In [66]: map(lambda x:x[0].split(','),lis)
Out[66]: [['a', ' b'], ['a'], ['a', 'b', 'c']] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:05:00.770

```
 python 3.2

    1\. [("".join(i)).split(",")for i in oldcode]

    2\. import re

     [re.split("\W+",str(i).strip())[1:-1]for i in o] 
```

### 虽然我过去使用的方法效果不太好。但多样性就是美。

# android - 在 SQLite 中使用直接查询？

> ID：12900541
> 
> 赞同：0
> 
> 时间：2012-10-15T17:06:25.353
> 
> 标签：android, sqlite

我目前正在研究 SQLite，我发现它使用 ContentValues 等各种类进行插入和更新......我想知道我是否必须遵循给定的方式或者我可以编写一个普通的 SQL 查询并使用 db.execSQL() 方法执行它们？它会不会给我的数据库带来任何不一致，因为所有这些“额外”步骤不会停止查询流程，我觉得如果我们直接使用查询会更快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:38:37.100

您可以使用`db.execSQL`除了`select`命令或任何其他返回数据的 SQL 命令（`db.rawQuery()`用于此目的）执行您想要的任何 SQL 命令。使用的类是帮助类，使您可以轻松地操作 DB（尝试插入 100 行，每行 20 列`ContentValues`，`db.execSQL`您就会明白这一点）。对于小型表，它不会有太大差异（并且您不会导致不一致），但是，对于具有依赖于用户界面或使用计算的输入的大型表，拥有像 ContentValues 这样的类及其辅助方法可能很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:44:14.667

是的，你绝对可以像使用这种方式使用

```
 myDB.execSQL("INSERT INTO MyTable VALUES ('fffff', 'numb', 20)"); 
```

插入值，但仅当您将数据库用于小型查询时。使用直接方法也存在一些缺陷，这些缺陷使用 ContentValues 删除 例如，尝试使用此方法将 blob 插入数据库，在将检索到的数据转换为位图时，您将得到一个空位图。但是当您使用 ContentValues 插入时，您将获得正确的数据，即您将能够将其转换为位图。

# python - 解密从电子邮件附加的 gpg 文件 (file.pgp)

> ID：12900542
> 
> 赞同：2
> 
> 时间：2012-10-15T17:06:25.070
> 
> 标签：python, email-attachments, gnupg

我正在使用 email.Message 类和 gnupg 库来：

1 - 解析从 Twisted imap4 客户端获取的电子邮件字符串。

2 - 获取附件，一个 .pgp

3 - 解密它。

我可以解密典型的邮件内容，如：

```
-----BEGIN PGP MESSAGE-----
Version: PGP 9
(...)
-----END PGP MESSAGE----- 
```

但依恋的事情真的让我的生活变成了地狱。

好吧，我尝试了很多不同的方法，但最合乎逻辑的应该是这样的：

```
message = email.message_from_string(content)
if message.is_multipart():
    attachment = message.get_payload(1)
    gpg = gnupg.GPG(gnupghome=settings.PGP_PATH)
    return gpg.decrypt_file(attachment.get_payload(), passphrase=settings.PGP_PASSPH) 
```

附件 var 第一行是：

```
From nobody Mon Oct 15 18:54:12 2012
Content-type: application/octet-stream; 
 name="No_Norm_AMLT_908_1210201201.txt.pgp"
Content-Disposition: attachment; filename="No_Norm_AMLT_908_1210201201.txt.pgp"
Content-Transfer-Encoding: base64 
```

然后是所有加密的东西。

无论如何......这真的很奇怪，有些东西我不明白。如果我从普通邮件客户端软件（即 Thunderbird）下载附件，我会得到一个看起来像二进制的 .pgp 文件（如果我用纯文本编辑器编辑它会出现奇怪的字符），我可以使用 bash 命令对其进行解密：

```
gpg --decrypt No_Norm_AMLT_908_1210201201.txt.pgp 
```

我不知道如何使用 email.Message 类和 gnupg 获得相同的结果（文件解密），我试图将附件的有效负载保存到文件中，这与从 Thunderbird 下载的不同，我可以'不要解密它，我也尝试将它放入StringIO，并用base64对其进行编码。

我从 gpg 得到的消息是：

```
[GNUPG:] NODATA 1
[GNUPG:] NODATA 2
gpg: decrypt_message failed: eof 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T09:06:30.677

好的解决了！我不得不：

```
base64.decodestring(attachment.get_payload()) 
```

然后使用 gpg 解密它，然后工作。这可以通过标题弄清楚：

```
Content-Transfer-Encoding: base64 
```

最终代码是：

```
message = email.message_from_string(content)
if message.is_multipart():
    attachment = message.get_payload(1)
    gpg = gnupg.GPG(gnupghome=settings.PGP_PATH)
    return gpg.decrypt_file(base64.decodestring(attachment.get_payload()),
                            passphrase=settings.PGP_PASSPH) 
```

# python - 您可以在 Python 的 ConfigParser 上为部分而不是实例设置默认值吗？

> ID：12900544
> 
> 赞同：3
> 
> 时间：2012-10-15T17:06:34.357
> 
> 标签：python

您可以通过将 dict 传递给 ConfigParser 初始化来获得默认值。

```
config = ConfigParser.ConfigParser({"test": "ok"}) 
```

但是这个默认值是实例范围的。第 1 部分的默认值如何与第 2 部分不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T18:07:46.163

创建您自己的子类，并使用覆盖的吸气剂？像这样的东西？

```
class MyConfigParser(ConfigParser):
    my_defaults = {
            'Section 1': 'spam',
            'Section 2': 'eggs',
    }

    def get(self, section, key):
        try:
            return ConfigParser.get(self, section, key)
        except ConfigParser.NoSectionError:
            if section in self.my_defaults:
                self.add_section(section)
                self.set(section, key, self.my_defaults[section])
                return self.my_defaults[section]
            else:
                raise
        except ConfigParser.NoOptionError:
            if section in self.my_defaults:
                self.set(section, key, self.my_defaults[section])
                return self.my_defaults[section]
            else:
                raise 
```

# .net - 为了使用文化信息，我必须在代码中添加什么新内容？

> ID：12900546
> 
> 赞同：0
> 
> 时间：2012-10-15T17:06:41.623
> 
> 标签：.net, cultureinfo

```
EmpCLass.dtDOB = Convert.ToDateTime(txtdob.Text, new CultureInfo("en-US")); 
```

错误 m 得到：

```
The type or namespace name 'CultureInfo' could not be found(are you missing a using directive or an assembly reference) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:19:10.143

乍一看，您似乎缺少全球化参考。确保您的代码中有以下 using 语句：

```
using System.Globalization; 
```

# c# - Windows 7/8、Direct3D9、10 和 11 - 效果/着色器

> ID：12900547
> 
> 赞同：1
> 
> 时间：2012-10-15T17:06:42.357
> 
> 标签：c#, windows-8, directx, directx-9, directx-10

目前，我正在为 Windows 8 商店、Windows 8 桌面和 Windows 7 开发应用程序。该应用程序应该在平板电脑和“普通”Windows 7/8 设备上顺利运行。所以，我从工作中得到了一台平板电脑并在上面安装了 Windows 8，只是为了意识到令人毛骨悚然的英特尔图形媒体加速器 (600) 只支持 DirectX 9.0c。

所以，我现在尝试了几个小时让我的 DirectX10/11 效果/着色器在 DirectX9 上运行，但似乎没有任何效果。使用 NVidia 的 FxComposer 进行的测试显示，DirectX9 效果运行良好。

我正在使用 SharpDX / C# 进行编程，并且技术 10 和技术 11 都是有效的（MyTechnique.IsValid == true）。要加载效果，我使用这些代码行：

```
var EffectByteCode  = ShaderBytecode.CompileFromFile("DirectX/Shaders/"+FxFile, "fx_5_0", ShaderFlags.None, EffectFlags.None);
var Effect      = new Effect(GraphicsProvider.Device, EffectByteCode, EffectFlags.None);
mEffect             = FxEffect;
mTechnique11            = mEffect.GetTechniqueByName("main_11"); //works
mTechnique10            = mEffect.GetTechniqueByName("main_10"); //works
mTechnique9             = mEffect.GetTechniqueByName("main_9"); //doesn't work 
```

我在这里粘贴了效果源代码：http: [//pastebin.com/KPxBN1DD](http://pastebin.com/KPxBN1DD) ..排除了“main_11”和“main_10”，在我的测试中，我将它们注释掉了，所以我只是删除了那些评论块..我认为dx9应该理解这个非常简单的代码..

所以我的最后一个问题是： - 参数“fx_5_0”对于加载技术、技术 10 和技术 11 是否有效？- 我的着色器代码正确吗？还是我做错了什么？- 我是否必须指定任何其他/附加信息/功能/参数来加载 DX9 技术？- 也许它是SharpDX的一个错误？我现在想看看这个代码..

编辑：试图使问题更清楚一点..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T00:01:10.970

Windows 8 Metro 不支持旧版效果框架（因为不支持 D3DCompiler_xx.dll），因此您最好使用其他解决方案。此外，Effect 已被 Microsoft 弃用，不再受支持。

旧的 Direct3D9 技术（使用 vs_2_0 或 ps_2_0 编译）不存储在使用 fx_5_0 编译的 FX 文件中（只需检查 fxc.exe 编译器的输出，您不会看到它们）。

您必须使用 vs_4_0_level_9_x 或 ps_4_0_level_9_x 才能使用技术 10/11 语法编译它们以获得 9.x 下级硬件支持。此外，如果您的所有原始着色器都可以与 vs_4_0_level_9_x 一起使用，并且您没有针对 10.0 或 11.1 的任何特定优化版本，那么您不必编译 main_10 或 main_11，因为 level_9_x 着色器正在从 9 开始的任何硬件上工作。 x 到 11.x。

您可能可以看看 SharpDX.Toolkit，它还不是官方的，但它支持一个效果框架（带有一些 XNA 库存效果，如 BasicEffect 或 SpriteBatch）。该工具包的测试版将于本月晚些时候推出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T18:04:40.100

尝试用 COLOR0 替换 SV_TARGET 语义。到目前为止，我从未在 D3D9 着色器中看到 SV_TARGET 语义。

# javascript - 如何刷新 KendoUI DropDownList？

> ID：12900548
> 
> 赞同：4
> 
> 时间：2012-10-15T17:06:42.683
> 
> 标签：javascript, asp.net-mvc, telerik, kendo-ui

我有一个需要更新的剑道 ui 网格。所以我有以下标记：

我调用以下脚本来填充下拉列表：

```
 // An Ajax call to load the selected hover into the controls
    $.ajax({
        type: 'POST',
        url: '/Reports/HoverManager/GetHoversForDropDown',
        data: { sectionId: sectionId },
        error: function(response){
            $('.hover-manager .error').html(response.responseText).fadeIn(500).delay(5000).fadeOut(500);
        },
        success: function(response){

            $('.hover-manager #hoverSelect').kendoDropDownList({  
                animation: false,
                dataTextField: "Name",
                dataValueField: "ID",
                dataSource: response.hovers,
                change: hoverDownDownChange,
            }).data('kendoDropDownList').value(hoverId);    

        }
    }); 
```

一旦页面加载。我调用相同的脚本来刷新下拉列表。我在源代码中注意到数据源包含新数据，但下拉列表是隐藏的。

更新剑道下拉列表的正确方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T19:21:07.883

您只需初始化 kendo DropDownList 一次，并且每次要刷新数据时都应使用**[dataSource.data()](http://docs.kendoui.com/api/framework/datasource#data)**方法。

就像是 ：

```
$('#hoverSelect').kendoDropDownList({  
            animation: false,
            dataTextField: "Name",
            dataValueField: "ID",                
            change: hoverDownDownChange,
        }).data('kendoDropDownList').value(hoverId); 

$.ajax({
    type: 'POST',
    url: '/Reports/HoverManager/GetHoversForDropDown',
    data: { sectionId: sectionId },
    error: function(response){
        $('.hover-manager .error').html(response.responseText).fadeIn(500).delay(5000).fadeOut(500);
    },        success: function(response){

        $('#hoverSelect').data('kendoDropDownList').dataSource.data(response.hovers);    

    }
}); 
```

# facebook-opengraph - 如何在 facebook 开放图形动作故事中获取上部文本？

> ID：12900549
> 
> 赞同：0
> 
> 时间：2012-10-15T17:06:46.223
> 
> 标签：facebook-opengraph

在此处查看 Facebook 文档中的操作链接故事示例：[https](https://developers.facebook.com/docs/opengraph/actionlinks/) ://developers.facebook.com/docs/opengraph/actionlinks/ 。请注意，这不是关于操作链接的问题，而是关于本页示例的其他方面的问题；我没有使用操作链接，只是发布打开的图形操作。

在“带有动作链接的故事”示例中，动作和下面的动作对象之间有一行文本；这条线是“你必须试一试！好吃！” 这行文本没有出现在第二个示例“单击操作链接后的故事”中。

如何让该行文本出现？我有动作帖子正在工作，但我只能在第二个示例中得到结果。

我注意到在我的操作定义中，在“可选属性”下有一个名为“消息”的字段。我尝试设置它，但它没有出来。我还应该设置其他什么来使用这个额外的文本字段吗？此文本字段是否仅在您使用操作链接时可用，或者我可以在没有它们的情况下使用它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:17:53.247

“消息”字段中设置的文本以您希望在时间线上作为个性化消息的方式出现在活动中，但您的 opengraph 操作应通过“用户消息”属性获得批准。

# jquery - 谷歌地图地理编码 - 减少小数位数

> ID：12900550
> 
> 赞同：1
> 
> 时间：2012-10-15T17:06:49.473
> 
> 标签：jquery, google-maps, google-maps-api-3

虽然我喜欢谷歌地图的准确性，但我想知道修改他们的 jquery 代码以限制返回的小数位数是多么容易。

这是我正在使用的代码：http: [//jsfiddle.net/Rr5PL/9/](http://jsfiddle.net/Rr5PL/9/)

如何在纬度/经度上返回 5 个小数位而不是目前的 15 个奇数？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:10:47.817

试试这个：http: [//jsfiddle.net/Rr5PL/11/](http://jsfiddle.net/Rr5PL/11/)

```
$(latval).val(marker.getPosition().lat().toFixed(5));
$(longval).val(marker.getPosition().lng().toFixed(5)); 
```

# iphone - 通过 UIManagedDocument 加速将对象插入核心数据？

> ID：12900553
> 
> 赞同：2
> 
> 时间：2012-10-15T17:06:51.513
> 
> 标签：iphone, cocoa-touch, core-data

我正在使用`UIManagedDocument`. 然后我`NSManagedObject`在循环中向数据库添加大约 1000 个（s）。我最初使用以下方法在后台线程中处理对象的数据：

```
dispatch_queue_t backgroundQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0);
dispatch_async(backgroundQueue, ^{
    // PROCESS OBJECTS HERE
    ...
    ... 
```

在将它们从后台线程添加到 Core Data 之前：

```
NSManagedObjectContext *moc = [[self managedDocument] managedObjectContext];
[moc performBlock:^{
    // ADD TO CORE DATA
    ...
    ... 
```

使用：

```
// CREATE
Fruit *fruit = [NSEntityDescription insertNewObjectForEntityForName:@"Fruit" inManagedObjectContext:context];
// POPULATE
[fruit setName:name];
[fruit setAge:age];
[fruit setType:type];
... 
```

**我的问题是：**

对 1000 多个对象执行上述操作目前大约需要 2.2 秒，在插入所有对象之前，我不会对 Core Data 进行任何保存，因此它全部在内存中完成，没有 I/O 开销。如您所见，我的所有处理都是在后台线程上完成的，但是当我将新对象插入核心数据时，我必须使用 performBlock: 以确保在 UIManagedDocument 最初所在的主线程上完成插入创建的。

我想知道的是，有没有一种方法可以加快插入对象的速度，可能是通过将多个 NSManagedObjects 一起“批处理”并一次性添加它们，或者这将花费与什么相同的时间我现在正在做（它仍在添加 1000 多个对象）。

我确实读过一些关于创建新上下文然后将其与 NSManagedDocument 上下文合并的内容，但我不确定这是否合适或如果合适的话该怎么做。任何帮助/信息将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T02:49:41.460

1) 将上下文中的撤消管理器设置为 nil：

```
[moc setUndoManager:nil] 
```

如果您在保存期间从不撤消，则不需要撤消信息。

2）您已经通过一次保存添加多个对象来进行批处理。

3) 尝试更小的批量。最后一次大保存可能会有问题，尽管 1000 应该没问题。

4) 如果您更改批量大小，您还需要尝试释放您创建的对象。

# php - 如何编写 PHP 重定向脚本

> ID：12900554
> 
> 赞同：0
> 
> 时间：2012-10-15T17:06:57.613
> 
> 标签：php, url, redirect

如何在 URL 中添加链接时创建将重定向到自定义 URL 的 PHP 脚本。例如，当用户访问此内容时：

```
http://mydomain.com/link.php?=http://www.google.com 
```

它应该立即将它们重定向到谷歌。

理想情况下，是否可以确保点击本身来自本地？

我知道这很可能是一个非常基本的 PHP 代码，但请注意，我对它的了解非常有限，这限制了我编写它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:09:13.730

```
http://mydomain.com/link.php?url=http://www.google.com

<?php
 header("Location: {$_GET['url']}");
?> 
```

这个？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T17:12:47.040

您可以使用 $_SERVER 变量的 HTTP_REFERER 来检查它是否来自本地域。

参考： http: [//php.net/manual/en/reserved.variables.server.php](http://php.net/manual/en/reserved.variables.server.php)

对于重定向，请尝试使用以下

```
http://mydomain.com/link.php?r=http://www.google.com
header("Location:".$_GET['r']); 
```

参考：http: [//in3.php.net/manual/en/function.header.php](http://in3.php.net/manual/en/function.header.php)

我希望以下内容对您有用，您可以将 $domain 变量硬编码为 mydomain.com

```
$url = "http://www.php.net/index.html";
$domain = str_ireplace('www.', '', parse_url($url, PHP_URL_HOST));
$refDomain = str_ireplace('www.', '', parse_url($_SERVER["HTTP_REFERER"], PHP_URL_HOST));

if(strcmp($domain, $refDomain) == 0)
{
     //your code goes here
     header("Location:".$_GET['r']);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:27:04.220

好的，我想在这里添加一个完整的答案。

您可以使用`header`像 MrSil 所说的那样发送重定向标头，

```
header("Location: $url"); // will redirect to $url! 
```

如果您想阻止其他人使用您的重定向脚本，您可以执行以下操作：

```
$ref = $_SERVER['HTTP_REFERER'];
$host = parse_url($ref, PHP_URL_HOST);
if($host !== "mydomain.com"){
  // out side request
} 
```

但是，`HTTP_REFERER`很容易被欺骗。那么，什么是更好的检查呢？

[CSRF](http://en.wikipedia.org/wiki/Cross-site_request_forgery)保护。它可能看起来有点矫枉过正，而且它*也不*是做这些事情的**完美方式，但它有帮助。**

另外，我认为不存在完美的解决方案。

阅读[本文](http://www.thespanner.co.uk/2007/08/20/protection-against-csrf/)以获取有关 CSRF 的更多信息。

# android - Android短信广播监听器不工作

> ID：12900555
> 
> 赞同：2
> 
> 时间：2012-10-15T17:06:59.127
> 
> 标签：android, sms, broadcastreceiver

甚至 Log.d 也没有被调用。找不到错误。我看过[Android-SMS 广播接收器](https://stackoverflow.com/questions/4117701/android-sms-broadcast-receiver)，[Android - Listen For Incoming SMS Messages](https://stackoverflow.com/questions/7089313/android-listen-for-incoming-sms-messages)。过去 24 小时左右，我一直在寻找解决方案。请查看并告诉我哪里错了。

不抛出异常。`SmsListener`在我的包文件夹中，放置所有其他活动。

**更新**添加`android:enabled="true"`到接收器。然后也没有工作。

我的清单中有：

```
<uses-permission android:name="android.permission.READ_SMS" />
<uses-permission android:name="android.permission.WRITE_SMS" />
<uses-permission android:name="android.permission.RECEIVE_SMS" />

<receiver android:name=".SmsListener" android:exported="false">
     <intent-filter android:priority="2147483647">
         <action android:name="android.provider.Telephony.SMS_RECEIVED" />
     </intent-filter>
</receiver> 
```

SmsListener.Java 代码：

```
public class SmsListener extends BroadcastReceiver {

@Override
public void onReceive(Context context, Intent intent) {

    Log.d(MainActivity.TAG,
            "in Receiver. intent.getAction():" + intent.getAction());

    if (intent.getAction()
            .equals("android.provider.Telephony.SMS_RECEIVED")) {
        Bundle bundle = intent.getExtras(); // ---get the SMS message passed
                                            // in---
        SmsMessage[] msgs = null;
        String msg_from;
        if (bundle != null) {
            // ---retrieve the SMS message received---
            try {
                Object[] pdus = (Object[]) bundle.get("pdus");
                msgs = new SmsMessage[pdus.length];
                for (int i = 0; i < msgs.length; i++) {
                    msgs[i] = SmsMessage.createFromPdu((byte[]) pdus[i]);
                    msg_from = msgs[i].getOriginatingAddress();
                    String msgBody = msgs[i].getMessageBody();
                    NotifyMe(context, msg_from, msgBody);
                }
            } catch (Exception e) {
                // Log.d("Exception caught",e.getMessage());
            }
        }
    }
}
private void NotifyMe(Context context, String msg_from, String msgBody) {
     // do something
}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T17:56:59.453

现在问题已经解决了。将清单中的接收器修改为

```
<receiver android:name=".SmsListener" >
        <intent-filter android:priority="999" >
            <action android:name="android.provider.Telephony.SMS_RECEIVED" />
        </intent-filter>
</receiver> 
```

这个对我有用。希望有人从中受益。感谢大家的帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T17:37:32.670

您是否尝试通过代码注册接收器？例如，下面是我在我的一个项目中是如何做到的——它在我的情况下是有效的。

**短信接收类**

```
public class SMSReceiver extends BroadcastReceiver
{
    @Override
    public void onReceive(Context context, Intent intent)
    {
        Object[] pduArray = (Object[]) intent.getExtras().get("pdus");
        SmsMessage[] messages = new SmsMessage[pduArray.length];
        for (int i = 0; i < pduArray.length; i++) messages[i] = SmsMessage.createFromPdu((byte[]) pduArray[i]);

        String SideNumber = messages[0].getDisplayOriginatingAddress();
        long Timestamp = messages[0].getTimestampMillis();

        StringBuilder bt = new StringBuilder();
        for (SmsMessage message : messages) bt.append(message.getMessageBody());

        String Smsbody = bt.toString();
    }
} 
```

**服务类 - 它注册广播接收器**这只是一个例子，您可以在您的活动中注册广播接收器。

```
public class AService extends Service
{
  private SMSReceiver smsReceiver;
  final IntentFilter smsFilter = new IntentFilter("android.provider.Telephony.SMS_RECEIVED");

  @Override
    public void onCreate()
    {
     smsFilter.setPriority(1000);
     this.smsReceiver = new SMSReceiver();
     this.registerReceiver(this.smsReceiver, smsFilter);
    }
} 
```

**AndroidManifest.xml 的一部分**

```
<uses-permission android:name="android.permission.RECEIVE_SMS" />
<uses-permission android:name="android.permission.READ_SMS" />

<service android:name=".AService" android:exported="false"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:19:30.373

您的清单 android.permission.RECEIVE_SMS 中是否有此权限？

这是基本的，但请确保

# c# - Shockwave Flash 对象不支持 MouseWheel 事件

> ID：12900566
> 
> 赞同：3
> 
> 时间：2012-10-15T17:07:28.173
> 
> 标签：c#, axshockwaveflash

我有一个 Windows 窗体应用程序，它执行一个简单的任务：用户在主窗体中选择一个视频，应用程序会弹出一个新窗体，其中 Shockwave Flash 对象再现它。

我现在想做的是当用户滚动鼠标滚轮时在电影时间轴中移动。问题是，Flash 对象一弹出就从表单中窃取焦点，并且它不支持鼠标滚轮事件。

有没有办法做到这一点，除了挂钩 MouseWheel 事件并在弹出窗口具有焦点时将其重定向到应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T18:39:44.140

Flash 显示的窗口属于不同的进程。这使得处理消息变得困难，您至少需要一个低级鼠标钩子才能在鼠标消息消失到另一个进程之前查看它。

样板代码[可在此处获得](http://blogs.msdn.com/b/toub/archive/2006/05/03/589468.aspx)。请注意，它有一个错误会阻止它在 .NET 4 及更高版本上运行，请参阅[此答案](https://stackoverflow.com/a/3684292/17034)以了解解决方法。

# sql-server - 将服务器上的 SQL 数据库中的数据导入 localhost 上的 SQL 数据库

> ID：12900567
> 
> 赞同：5
> 
> 时间：2012-10-15T17:07:32.013
> 
> 标签：sql-server, import

我们有一个数据库，其中包含大量数据（每个表大约 40 万条记录）。我希望能够在此数据库上调试存储过程，但是我没有权限在它所在的服务器上执行此操作。

因此，我需要在 localhost 上创建数据库的副本并从那里进行调试。

但是.. 由于创建的脚本太大，SQL Server Management Studio 无法打开。

如果一个位于本地主机上而另一个不在，有没有办法将数据从一个数据库直接导入另一个数据库？有人告诉我，安全问题不应该是导入/导出数据的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:10:37.207

只需创建源数据库的二进制备份（例如，使用 SQL Server Management Studio，右键单击数据库，然后选择`Tasks -> Back Up`），然后将该`.bak`文件导入本地安装 - 再次使用 Management Studio，右键单击“数据库”节点并选择`Restore Database`。

唯一可能阻止您执行此操作的是，如果您在本地运行 SQL Server Express，并且源数据库的总大小超过了 Express 版本的大小限制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T17:12:12.730

如果可以从计算机连接到服务器数据库，则可以使用 SQL Server Management Studio，右键单击数据库，菜单选项任务，然后复制数据库。您将看到一个简单的向导，询问源数据库和目标数据库。

您还可以通过 SQL Server Management Studio 创建备份并在您的计算机上还原。

# objective-c - 如何在 NSToolbar 中使用默认颜色选择器？

> ID：12900572
> 
> 赞同：0
> 
> 时间：2012-10-15T17:07:47.473
> 
> 标签：objective-c, xcode, macos, cocoa

我正在学习可可。这是我的简单 OS X 应用程序：

![在此处输入图像描述](../Images/1ca8ca66d6bea8b50b9deb8d3af8dbba.png)

它包含一个自定义视图，其中白色矩形被淹没，一个工具栏和一个滑块。我想通过单击工具栏中的“颜色”项并在调色板中选择新颜色来更改矩形的填充颜色。

如何从调色板中获取新颜色？我知道它有“NSToolbarShowColorsItem”标识符，但不知道如何使用它。

你能帮我么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:29:16.690

您可能应该考虑通过几个基本的 Cocoa 教程来了解基本的 Cocoa 概念。

需要查看的一些资源：

*   [可可开发中心](http://cocoadevcentral.com/)
*   [可可基础指南](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CocoaFundamentals/Introduction/Introduction.html)
*   [CocoaDev 教程](http://cocoadev.com/wiki/CocoaTutorials)

# c# - 阻止代码并等待事件处理程序触发？

> ID：12900574
> 
> 赞同：3
> 
> 时间：2012-10-15T17:07:49.407
> 
> 标签：c#, .net, events, event-handling, blocking

我正在编写一个使用 3rd 方库来处理一些数据的应用程序。在一个非常简化的示例中，我有一个方法作为这样的任务运行：

```
private void ProcessListOfItems(List<string> items)
{ 
    while (items.Count > 0)
    {
        3rdPartyLibObject.Process(items[0]);
        items.Remove(0);
    }
} 
```

如您所见，我的代码当前的编写方式是，只要 Process() 方法返回，我就会从列表中删除每个项目。但是一个项目的处理可能会失败，我需要知道是否会发生这种情况。不幸的是，Process() 方法不会返回 bool 值来指示项目是否已成功处理，而是会触发 ProcessingComplete 和 ProcessingFailed 事件。我有事件处理程序连接到这些事件，如下所示：

```
3rdPartyLibObject.ProcessingComplete += obj_ProcessingSuccess;
3rdPartyLibObject.ProcessingFailed += obj_ProcessingFailed;

private void obj_ProcessingSuccess(object sender, 3rdPartyLibObject.ProcessingEventArgs e)
{
    this.Invoke(new ProcessedHandler(OnProcessed), new object[] { true });
}

private void obj_ProcessingFailed(object sender, 3rdPartyLibObject.ProcessingEventArgs e)
{
    this.Invoke(new ProcessedHandler(OnProcessed), new object[] { false });
}

private void OnProcessed(bool success)
{
    if (success)
    {
        Debug.WriteLine("Item was processed succesfully!");
    }
    else
    {
        Debug.WriteLine("Failed to process item!");
    }
} 
```

我想做的是在调用 3rdPartyLibObject.Process() 之后立即设置我的代码块，直到其中一个事件处理程序触发，这样我才能知道该项目是否无法处理（以及我是否应该将其从列出与否）。我猜这可能并不少见，但我以前从未遇到过。处理这种情况是否存在普遍认可的最佳实践？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-15T17:15:59.660

就个人而言，我会将其包装成`Task<bool>`，如下所示：

```
Task<bool> Process3rdParty(ThirdPartyLibObject thirdParty, string item)
{
    var tcs = new TaskCompletionSource<bool>();

    thirdParty.ProcessingComplete += (o, e) => tcs.SetResult(true);
    thirdParty.ProcessingFailed += (o, e) => tcs.SetResult(false);

    thirdParty.Process(item);

    return tcs.Task;
} 
```

然后你可以这样称呼它：

```
private void ProcessListOfItems(List<string> items)
{ 
    while (items.Count > 0)
    {
        var task = Process3rdParty(thirdPartyLibObject.Process(items[0]);
        if (task.Result)
            items.Remove(0);
    }
} 
```

如果您稍后决定希望它异步运行或一次处理多个项目（如果第三方库支持这一点），这也会简化事情。这也很容易转移到 C# 5 的 async/await 支持以使整个事情异步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:18:15.853

这会起作用吗：

```
private bool itemProcessed = false;

private void ProcessListOfItems(List<string> items)
{ 
    while (items.Count > 0)
    {
        3rdPartyLibObject.Process(items[0]);
        if (itemProcessed)
        {
            items.Remove(0);
        }
    }
}

private void obj_ProcessingSuccess(object sender,    3rdPartyLibObject.ProcessingEventArgs e)
{
    this.itemProcessed = true;
}

private void obj_ProcessingFailed(object sender, 3rdPartyLibObject.ProcessingEventArgs e)
{
    this.itemProcessed = false;
} 
```

假设事件都在同一个线程上触发，则应在处理下一个项目之前调用处理程序。

# jquery - 每次单击链接时如何向左滚动 div？

> ID：12900575
> 
> 赞同：0
> 
> 时间：2012-10-15T17:07:49.813
> 
> 标签：jquery, css

我从某个地方获取了这段代码并对其进行了调整。我设法向左滚动 400px。但是我希望每次单击链接时它都会向左滚动。我正在使用的脚本是：

```
$('.masternav a').bind('click',function(event){
  var $anchor = $(this);
  $('html, body ').stop().animate({
  scrollLeft: (400)}, 1000);
  event.preventDefault();
}); 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:09:39.703

你可能想要这个：

```
$('.masternav a').bind('click',function(event){
            var $anchor = $(this);
            $('html, body ').stop().animate({
                scrollLeft: '+=40'}, 1000);
            event.preventDefault();
        }); 
```

每次单击时，这将滚动 40 像素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:11:25.350

如果为值提供了前导 += 或 -= 字符序列，则通过从属性的当前值中加上或减去给定数字来计算目标值。所以试试这个：

```
$('.masternav a').bind('click',function(event){
   var $anchor = $(this);
   $('html, body ').stop().animate({
            scrollLeft: "+=400")}, 1000);
            event.preventDefault();
}); 
```

祝你好运 ！！

# c++ - 当显式指定模板参数时，为什么 GCC 会产生一个奇怪的错误并试图调用错误的方法？

> ID：12900578
> 
> 赞同：8
> 
> 时间：2012-10-15T17:07:59.687
> 
> 标签：c++, templates, gcc, c++11

我有一个`submitAsync`接受模板`std::function`作为参数的函数：

```
template <typename Ret, typename... Args>                                                                                                                                                     
Future<Ret> submitAsync(const function<Ret (Args...)> &func, Args&&... args); 
```

但是，在传递 lambda 时，隐式模板参数推导不起作用（类似于[此处](https://stackoverflow.com/questions/7950680/how-can-i-pass-a-lambda-c11-into-a-templated-function)的问题，因此我必须创建一个更通用的函数，将函数作为模板参数接受，然后将其传递给原始函数：

```
template <typename Func, typename... Args>
auto submitAsync(Func &&func, Args&&... args) -> // Line 82, where the strange error occurs
    Future<
        typename enable_if<
            is_convertible<
                Func, function<decltype(func(args...)) (Args...) >
            >::value ,  decltype(func(args...))
        >::type
    > {
    typedef decltype(func(args...)) ReturnType;
    return submitAsync<ReturnType, Args...>(function<ReturnType (Args...)>(func), forward<Args>(args)...);
} 
```

使用 Clang 可以很好地编译，但使用 GCC 返回以下错误：

```
src/Scheduler.hpp: In substitution of ‘template<class Func, class ... Args> Future<typename std::enable_if<std::is_convertible<Func, std::function<decltype (func(MCServer::Scheduler::startThread::args ...))(Args ...)> >::value, decltype (func(args ...))>::type> MCServer::Scheduler::submitAsync(Func&&, Args&& ...) [with Func = int; Args = {}]’:
src/Scheduler.hpp:91:109:   required from ‘Future<typename std::enable_if<std::is_convertible<Func, std::function<decltype (func(MCServer::Scheduler::startThread::args ...))(Args ...)> >::value, decltype (func(args ...))>::type> MCServer::Scheduler::submitAsync(Func&&, Args&& ...) [with Func = MCServer::MinecraftServer::init()::<lambda()>&; Args = {}; typename std::enable_if<std::is_convertible<Func, std::function<decltype (func(MCServer::Scheduler::startThread::args ...))(Args ...)> >::value, decltype (func(args ...))>::type = int]’
src/MinecraftServer.cpp:237:37:   required from here
src/Scheduler.hpp:82:10: error: expansion pattern ‘#‘nontype_argument_pack’ not supported by dump_expr#<expression error>’ contains no argument packs 
```

这首先表明

```
return submitAsync<ReturnType, Args...>(function<ReturnType (Args...)>(func), forward<Args>(args)...); 
```

这应该是调用`submitAsync(const function<Ret (Args...)> &, Args&&...)`，实际上是试图调用`submitAsync(Func &&func, Args&&... args)`，这当然不起作用，因为`func`被传递的类型是`int`。错误的最后一部分我也不明白，`expansion pattern ‘#‘nontype_argument_pack’ not supported by dump_expr#<expression error>’ contains no argument packs`可能是编译器错误（第 82 行是函数签名的主要部分，我在其中添加了注释来标记它）？

奇怪的是，当我删除调用中的显式模板参数时`submitAsync`，替换这一行：

```
return submitAsync<ReturnType, Args...>(function<ReturnType (Args...)>(func), forward<Args>(args)...); 
```

有了这个：

```
return submitAsync(function<ReturnType (Args...)>(func), forward<Args>(args)...); 
```

GCC 正确编译它。那么，为什么 GCC 在指定模板参数时调用错误的函数，即使它在允许推断参数时工作正常？谁能告诉我第 82 行的奇怪错误是什么？

编辑：忘了提，我使用的是 GCC 4.7.2

编辑2：[这里的解决方案和解释](https://stackoverflow.com/a/12942974/1436226)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T20:37:51.477

经过进一步的测试，我意识到没有显式模板参数的 Clang 和 GCC 实际上并没有像我希望的那样工作。在这两种情况下，该函数只是将自己作为第一个适合参数的函数调用。这是由于编译器决定将`submitAsync`函数作为模板参数的匹配比使用`const std::function&`. `submitAsync`在将其更改为通过引用获取函数后，它现在可以正常工作：

```
template <typename Ret, typename... Args>
Future<Ret> Scheduler::submitAsync(function<Ret (Args...)> func, Args&&... args) 
```

# c - 在 Chrome 的 NPAPI 窗口插件中使用 Windows raw_input

> ID：12900585
> 
> 赞同：1
> 
> 时间：2012-10-15T17:08:35.290
> 
> 标签：c, windows, google-chrome, npapi

我有一个可以独立运行的应用程序。它使用原始输入处理所有键盘/鼠标输入。切换到 NPAPI 客户端窗口插件时，我通过`WM_KEYDOWN`键盘接收输入，而我的设置应该禁用它们，更糟糕的是，我没有收到任何`WM_INPUT`键盘的原始输入事件。其他一切正常，包括窗口中的 D3D9 渲染。

这是我大致设置窗口的方法（很长）：

```
...
SetWindowLongPtr(Application_hWnd, GWL_WNDPROC, (LONG_PTR)&Application_WndProc);
...

DEV_BROADCAST_DEVICEINTERFACE notificationFilter;
GUID hid = { 0 };
RAWINPUTDEVICE rid[4] = { 0 };

rid[1].usUsagePage = 0x01; // HID_USAGE_PAGE_GENERIC (in WDK)
rid[1].usUsage = 0x06; // HID_USAGE_GENERIC_KEYBOARD (in WDK)
rid[1].dwFlags = RIDEV_NOLEGACY;//RIDEV_DEVNOTIFY;
rid[1].hwndTarget = Application_hWnd; // capture only for this window

RegisterRawInputDevices(rid, sizeof(rid) / sizeof(rid[0]), sizeof(rid[0]));
... other raw device detection and related HID stuff 
```

接收：

```
case WM_INPUT:
{
     if (GET_RAWINPUT_CODE_WPARAM(wParam) == RIM_INPUT)
     {
            RAWINPUT raw = { 0 };
            UINT dwSize = sizeof(raw);

            if (GetRawInputData((HRAWINPUT)lParam, RID_INPUT, &raw, &dwSize, sizeof(RAWINPUTHEADER)) > 0)
            {
                switch (raw.header.dwType)
                {
                case RIM_TYPEKEYBOARD:
                    // never reaches here 
```

为了清楚起见，此处省略了错误检查，但在任何地方都不会报告错误。然而它似乎对键盘没有影响，但我确实收到了鼠标的 WM_INPUT。

任何人在 NPAPI 中都有一个成功工作的原始输入键盘？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:46:49.773

我会尝试在浏览器给你的地方创建你自己的子 HWND，你可以更好地控制正在发生的事情。

# selenium - Selenium RC 和 Internet Explorer 7，带有用于 HTTPS 和 HTTP 连接的 rspec

> ID：12900590
> 
> 赞同：3
> 
> 时间：2012-10-15T17:08:56.990
> 
> 标签：selenium, https, rspec, proxy, internet-explorer-7

我们使用 rspec 测试我们的 Rails Web 应用程序，并在我们的 rspec 测试中使用 selenium-client（gem 版本 1.2.18）API 让 selenium RC 服务器（版本 2.21.0）引导 AP 下的 Internet Explorer 7 来测试我们的应用程序。

在我们为我们的登录和注册过程引入 HTTPS 之前，这一直非常有效。现在用户被重定向到登录和注册表单的安全版本，然后被重定向回不安全的 HTTP 站点。

为了让我们的 selenium 测试与 HTTPS 和 Internet Explorer 7 一起使用，我们使用“*iexploreproxy”而不是“*iexplore”设置 selenium 驱动程序，并使用端口 4444。我们还安装了 Cyber​​Villans SSL 证书，如下所述[http://blog .mogotest.com/2010/04/13/how-to-accept-self-signed-ssl-certificates-in-selenium/](http://blog.mogotest.com/2010/04/13/how-to-accept-self-signed-ssl-certificates-in-selenium/)。我们使用 -trustALLSSLCertificates 运行 selenium rc 服务器。这解决了自签名 SSL 证书问题（请注意 selenium RC > 2.21 不起作用，因为错误设置了错误的有效起始日期）。

之后，我们在运行测试时收到“Permission Denied”错误。我们发现这是由于[http://wiki.openqa.org/display/SEL/Selenium+Core+FAQ](http://wiki.openqa.org/display/SEL/Selenium+Core+FAQ)中描述的相同起源问题，在“为什么通过 HTTPS 访问我的网站时出现权限被拒绝错误？ ”。这个问题可以通过调整 Internet Explorer 7 代理设置并使用 localhost:4444 通过 selenium RC 服务器路由所有内容来解决。它可以工作，但问题是每次测试运行后代理设置都会重置。

我的第一个问题是：如何使这些设置在 Internet Explorer 7 中持久存在？我阅读了有关 IE 的自定义配置文件，但我还没有找到如何为 rspec 测试设置它。我还阅读了有关 proxy.pac 文件的信息，但在谷歌上搜索解决方案没有成功。

下一个问题是，在运行我们的测试时，我们还会遇到 selenium 的“拒绝访问”错误。我不知道如何解决这些问题以及它们发生的原因。所以我的第二个问题是：如何在所描述的设置下摆脱那些。

# java - 这个 Java 正则表达式代码在做什么？

> ID：12900592
> 
> 赞同：1
> 
> 时间：2012-10-15T17:09:00.090
> 
> 标签：java, regex

我刚刚在我们代码库的“Utils”类型的类中找到了这个方法。它是很久以前由不再为我们工作的开发人员编写的。它在做什么？它返回什么？！？当然，没有 JavaDocs 或注释。

```
public static String stripChars(String toChar, String ptn){
    String stripped = "";
    stripped = toChar.replaceAll(ptn, "$1");
    return stripped.trim();
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:15:43.877

本质上，这是一个非常短的别名。这：

```
stripChars(a, b) 
```

相当于：

```
a.replaceAll(b, "$1").trim() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T17:17:51.547

它似乎将“toChar”中与正则表达式“ptn”匹配的所有内容替换为“toChar”中匹配的第一个组

正则表达式有组的概念，例如匹配“year 2012”并替换为“year 1012”，或者“year 2006”替换为“year 1007”（将第一个20改为10）可以通过替换来完成

"year 20([0-9][9-9])" 与 "year 20$1" -- 即匹配整个字符串，然后将其替换为 "year 20"，后跟第一组 ( `$1`)。该组是括号中的第一件事。

无论如何，您的方法然后将“toChar”中与“ptn”匹配的所有内容替换为正则表达式“ptn”中的第一组。因此，给定 stripChars("year 2012", "year 20([0-9][9-9]"); 您将只收到“12”，因为整个文本将匹配并仅被第一组替换。

然后它会触发任何前导或尾随空格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T17:14:41.263

它只是`replacing`一个带有自己`subset`匹配字符的字符串，然后从两端修剪空格。

**例子**

因此，如果您希望将一个单词替换为该单词的一系列数字

使用正则表达式`\b.*?(\d*).*?\b`

然后繁荣，你的`replaceAll`方法会给出这些结果

```
hey123wow->123
what666->666
how888->888 
```

`$0`指整个匹配的字符串，即 `hey123wow`, `what666`,`how888`在本例中

`$1`指的是`(\d*)`本例中的 group.ie 即`123`, `666`,`888`

`$2`将指本示例中不存在的第二组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T17:16:04.663

作为参数方法传递的模式字符串似乎包含一个匹配组，并且对全部替换的调用将把整个匹配替换为与第一个组匹配的部分的模式。您应该查找此方法的调用层次结构，以查找传递给该方法的一些正则表达式以及正在处理的字符串，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T17:18:49.140

```
toChar.replaceAll(ptn, "$1"); 
```

它将所有出现的`ptn`in替换为我们不知道它在哪里`toChar`的捕获组。`$1`

捕获组是内部的模式`brackets ()`：-

对于以下正则表达式中的 EG：-

`"(\\d+)(cd)"`

*   `$0`表示完全匹配
*   `$1`表示第一个捕获组 ( `\\d+`)
*   `$2`表示第二个捕获组 ( `cd`)

    ```
    String str1 = "xyz12cd";

    // This will replace `12cd` with the first capture group `12`
    str1 = str1.replaceAll("(\\d+)(cd)", "$1"); 
    System.out.println(str1); 
    ```

想了解更多`Regular Expression`，可以参考以下链接：-

*   [http://www.vogella.com/articles/JavaRegularExpressions/article.html](http://www.vogella.com/articles/JavaRegularExpressions/article.html)
*   [http://docs.oracle.com/javase/tutorial/essential/regex/](http://docs.oracle.com/javase/tutorial/essential/regex/)

# c++ - 将 CStringW 插入 std::wostringstream 时出现问题

> ID：12900593
> 
> 赞同：4
> 
> 时间：2012-10-15T17:09:01.077
> 
> 标签：c++, unicode, mfc, wostringstream

我正在将 MFC 程序从 MBCS 转换为 Unicode。我发现插入运算符 << 与 CStringA 和 CStringW 实例的工作方式不同。

```
// char
std::ostringstream c_oss;
CStringA c_s("Hello");
c_oss << c_s;
TRACE("%s\n", c_oss.str().c_str());

// wchar_t
std::wostringstream w_oss;
CStringW w_s(L"World");
w_oss << w_s;
TRACE(L"%s\n", w_oss.str().c_str()); 
```

我希望这会打印“Hello\nWorld\n”，但它会打印“Hello\n14,5E6,B38\n”。也就是说，它打印的是 w_s 数据的地址而不是数据。

如果我调试到 w_oss << w_s，我可以看到插入 const void* 的重载被选中，而不是插入 const wchar_t* 的重载。它适用于 char 版本。如果我明确应用大小写 (LPCTSTR) 或 (const wchar_t*)，它适用于 wchar_t 版本。

任何想法为什么 wchar_t 版本与 char 版本的工作方式不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:50:03.147

的宽字符版本`operator<<`是一个模板，因此需要精确的参数匹配。没有用户定义的转换，例如`CStringW::operator wchar_t*()`隐式执行。

OTOH`void*`相同运算符的版本不是模板，并且愉快地使用用户定义的转换运算符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T18:08:23.037

考虑到 VS2010 SP1，我发现在`<ostream>`标头中存在`std::ostringstream`and的重载`const char*`：

```
template<class _Traits> inline
    basic_ostream<char, _Traits>& operator<<(
        basic_ostream<char, _Traits>& _Ostr,
        const char *_Val)
    {    // insert NTBS into char stream
         ... 
```

`std::wostringstream`但是和似乎没有类似的重载`const wchar_t*`。

如果将其添加到源代码中，发送`CStringW`with`operator<<`似乎可以工作（我个人的偏好：使用`CString::GetString()`字符串流的方法和`operator<<`）：

```
namespace std {

template<class _Traits> inline
    basic_ostream<wchar_t, _Traits>& operator<<(
    basic_ostream<wchar_t, _Traits>& _Ostr,
    const wchar_t *_Val)
{
    ATLTRACE("It's me, the new overload!\n");

    typedef wchar_t _Elem;

    //
    // *** Copy and paste *** the source code from the following overload:
    //
    // template<class _Elem,
    //  class _Traits> inline
    //    basic_ostream<_Elem, _Traits>& operator<<(
    //    basic_ostream<_Elem, _Traits>& _Ostr, const _Elem *_Val)
    //

    //
    // NOTE: I don't want to infringe any copyright.
    //
    // Moderators please delete the following lines if they
    // infringe any copyright.
    //

    typedef basic_ostream<_Elem, _Traits> _Myos;

    ios_base::iostate _State = ios_base::goodbit;
    streamsize _Count = (streamsize)_Traits::length(_Val);  // may overflow
    streamsize _Pad = _Ostr.width() <= 0 || _Ostr.width() <= _Count
        ? 0 : _Ostr.width() - _Count;
    const typename _Myos::sentry _Ok(_Ostr);

    if (!_Ok)
        _State |= ios_base::badbit;
    else
    {   // state okay, insert
        _TRY_IO_BEGIN
            if ((_Ostr.flags() & ios_base::adjustfield) != ios_base::left)
                for (; 0 < _Pad; --_Pad)    // pad on left
                    if (_Traits::eq_int_type(_Traits::eof(),
                        _Ostr.rdbuf()->sputc(_Ostr.fill())))
                    {   // insertion failed, quit
                        _State |= ios_base::badbit;
                        break;
                    }

                    if (_State == ios_base::goodbit
                        && _Ostr.rdbuf()->sputn(_Val, _Count) != _Count)
                        _State |= ios_base::badbit;

                    if (_State == ios_base::goodbit)
                        for (; 0 < _Pad; --_Pad)    // pad on right
                            if (_Traits::eq_int_type(_Traits::eof(),
                                _Ostr.rdbuf()->sputc(_Ostr.fill())))
                            {   // insertion failed, quit
                                _State |= ios_base::badbit;
                                break;
                            }
                            _Ostr.width(0);
                            _CATCH_IO_(_Ostr)
    }

    _Ostr.setstate(_State);
    return (_Ostr);
}

} // namespace std 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T18:10:08.017

我想，nm的答案是正确的。官方的解释相当模糊，但含义相同（[MSDN about IO with std::wcout](http://msdn.microsoft.com/en-us/library/72b2swax.aspx)）：

> 没有强制转换， cs 被视为 void* 并且 wcout 打印对象的地址。这种行为是由模板参数推导和重载解析之间的微妙交互引起的，它们本身是正确的并且符合 C++ 标准。

# objective-c - 如何通过苹果libobjc.dll在mingw64-x86中使用clang编译objective-c源代码？

> ID：12900596
> 
> 赞同：2
> 
> 时间：2012-10-15T17:09:03.683
> 
> 标签：objective-c, windows, gcc, runtime, clang

在windows平台上编译objective-c源代码时遇到问题。当然在windows平台上编译objective-c源码，我们通常使用gnustep环境（gcc objecitve-c编译器.gnustep libojc动态库.gnustep基础框架...等等）。

但我想要一个干净的环境尝试编译器objective-c，并使用不同的libobjc库。

从 mac os x 10.6 开始。苹果将​​ macosx 系统移至 x86 平台（不再支持 ppc），并通过可可技术重写系统应用程序。包括 iTunes。

和 iTunes 有 windows 版本。

通过在安装 iTunes 后搜索系统文件夹。我在以下位置找到了任何支持 dll 文件： `C:\Program Files (x86)\Common Files\Apple\Apple Application Support`

顺便说一句，我的系统是 Windows 7 x86_64。

我发现它有：

```
ApplePushService.dll
AppleVersions.dll
APSDaemon_main.dll
ASL.dll
AVFoundationCF.dll
CFNetwork.dll
CoreAudioToolbox.dll
CoreFoundation.dll
CoreGraphics.dll
CoreMedia.dll
CoreText.dll
CoreVideo.dll
Foundation.dll
icudt46.dll
icuin40.dll
icuuc40.dll
JavaScriptCore.dll
libcache.dll
libdispatch.dll
libicuin.dll
libicuuc.dll
libtidy.dll
libxml2.dll
libxslt.dll
MediaToolbox.dll
objc.dll
pthreadVC2.dll
QTMovieWin.dll
QuartzCore.dll
SQLite3.dll
VideoToolbox.dll
WebKit.dll
WebKitQuartzCoreAdditions.dll
YSCrashDump.dll
YSUtilities.dll
zlib1.dll 
```

看起来，苹果将这些低级框架实现到 Windows 平台。

```
CFNetwork.framework -> CFNetwork.dll 

CoreGraphics.framework -> CoreGraphics.dll

Foundation.framework -> Foundation.dll

libobjc.a.dylib -> objc.dll

WebKit.framework -> WebKit.dll 
```

所以，我认为使用苹果的 libobjc 发行版更好（iTunes 运行良好）。其他库文件也很有用。

我想为 Objective-c 初学者（我的同学和我）建立一个学习环境。

所以我复制 objc.dll 并将其重命名为 libobjc.dll

使用 mingw 工具“pexports”将 libobjc.dll 的 def 导出到 libobjc.def，然后使用 Visual Studio 命令工具“lib.exe”将 .def 文件转换为 libobjc.lib。

然后我下载

*   mingw64 的 x86（32 位）编译器 dng 预编译包。
*   mingw64 的 clang+llvm(32 位) 编译器 dng 预编译包。
*   mingw64的msys环境预编译包。

将这 3 个软件包安装到系统。然后将 libobjc.dll,libobjc.lib 复制到 /lib（在 windows 平台上，.a 和 .lib 使用相同的 bin 格式）。

然后我写了一个示例objective-c源代码。代码在这里：file:test.m

```
#import <stdio.h>

@interface Foo {
    int count;
}

+ (void)fooWithBar;

@end

@implementation Foo

+ (void)fooWithBar {
    printf("abc");
}

@end

int main(){
    [Foo fooWithBar];
    return 0;
} 
```

只需编译它：

`clang test.m`

发生错误，然后使用 -v 选项显示详细信息：

```
clang version 3.1 (branches/release_31)
Target: i686-w64-mingw32
Thread model: posix
 "c:/mingw64w32/bin/clang.exe" -cc1 -triple i686-w64-mingw32 -S -disable-free -main-file-name test.m -mrelocation-model static -mdisable-fp-elim -mconstructor-aliases -target-cpu pentium4 -target-linker-version 2.20.51.0.2 -momit-leaf-frame-pointer -v -resource-dir "c:/mingw64w32/bin\\..\\lib\\clang\\3.1" -fmodule-cache-path "C:/Users/Joe/AppData/Local/Temp\\clang-module-cache" -fno-dwarf-directory-asm -fdebug-compilation-dir C:/MINGW64-X86-MSYS-20111123/home/Joe -ferror-limit 19 -fmessage-length 0 -mstackrealign -fno-use-cxa-atexit -fgnu-runtime -fobjc-runtime-has-arc -fobjc-runtime-has-weak -fobjc-fragile-abi -fobjc-exceptions -fdiagnostics-show-option -o C:/Users/Joe/AppData/Local/Temp/test-709512.s -x objective-c test.m
clang -cc1 version 3.1 based upon LLVM 3.1 default target i686-w64-mingw32
ignoring nonexistent directory "/usr/local/include"
ignoring nonexistent directory "c:/mingw64w32/bin/../lib/clang/3.1/../../../x86_64-w64-mingw32/include"
ignoring nonexistent directory "/mingw/include"
ignoring nonexistent directory "c:/mingw/include"
ignoring nonexistent directory "/usr/include"
#include "..." search starts here:
#include <...> search starts here:
 c:/mingw64w32/bin/../lib/clang/3.1/include
 c:/mingw64w32/bin/../lib/clang/3.1/../../../i686-w64-mingw32/include
 c:/mingw64w32/bin/../lib/clang/3.1/../../../include
End of search list.
 "c:/mingw64w32/bin/i686-w64-mingw32-gcc.exe" -v -c -o C:/Users/Joe/AppData/Local/Temp/test-709513.o -x assembler C:/Users/Joe/AppData/Local/Temp/test-709512.s
Using built-in specs.
COLLECT_GCC=c:/mingw64w32/bin/i686-w64-mingw32-gcc.exe
Target: i686-w64-mingw32
Configured with: /home/drangon/work/mingw-w64-dgn_32/source/gcc/configure --host=i686-w64-mingw32 --target=i686-w64-mingw32 --disable-nls --enable-languages=c,c++,objc,obj-c++ --with-gmp=/home/drangon/work/mingw-w64-dgn_32/build/for_target --enable-twoprocess --disable-libstdcxx-pch --disable-win32-registry --prefix=/home/drangon/work/mingw-w64-dgn_32/target --with-sysroot=/home/drangon/work/mingw-w64-dgn_32/target
Thread model: win32
gcc version 4.7.2 20120823 (prerelease) (GCC) 
COLLECT_GCC_OPTIONS='-v' '-c' '-o' 'C:/Users/Joe/AppData/Local/Temp/test-709513.o' '-mtune=generic' '-march=pentiumpro'
 c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/bin/as.exe -v -o C:/Users/Joe/AppData/Local/Temp/test-709513.o C:/Users/Joe/AppData/Local/Temp/test-709512.s
GNU assembler version 2.23.51 (i686-w64-mingw32) using BFD version (GNU Binutils) 2.23.51.20120823
COMPILER_PATH=c:/mingw64w32/bin/../libexec/gcc/i686-w64-mingw32/4.7.2/;c:/mingw64w32/bin/../libexec/gcc/;c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/bin/
LIBRARY_PATH=c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/;c:/mingw64w32/bin/../lib/gcc/;c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/lib/../lib/;c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../lib/;c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/lib/;c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../
COLLECT_GCC_OPTIONS='-v' '-c' '-o' 'C:/Users/Joe/AppData/Local/Temp/test-709513.o' '-mtune=generic' '-march=pentiumpro'
 "c:/mingw64w32/bin/i686-w64-mingw32-gcc.exe" -v -o a.out C:/Users/Joe/AppData/Local/Temp/test-709513.o
Using built-in specs.
COLLECT_GCC=c:/mingw64w32/bin/i686-w64-mingw32-gcc.exe
COLLECT_LTO_WRAPPER=c:/mingw64w32/bin/../libexec/gcc/i686-w64-mingw32/4.7.2/lto-wrapper.exe
Target: i686-w64-mingw32
Configured with: /home/drangon/work/mingw-w64-dgn_32/source/gcc/configure --host=i686-w64-mingw32 --target=i686-w64-mingw32 --disable-nls --enable-languages=c,c++,objc,obj-c++ --with-gmp=/home/drangon/work/mingw-w64-dgn_32/build/for_target --enable-twoprocess --disable-libstdcxx-pch --disable-win32-registry --prefix=/home/drangon/work/mingw-w64-dgn_32/target --with-sysroot=/home/drangon/work/mingw-w64-dgn_32/target
Thread model: win32
gcc version 4.7.2 20120823 (prerelease) (GCC) 
COMPILER_PATH=c:/mingw64w32/bin/../libexec/gcc/i686-w64-mingw32/4.7.2/;c:/mingw64w32/bin/../libexec/gcc/;c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/bin/
LIBRARY_PATH=c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/;c:/mingw64w32/bin/../lib/gcc/;c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/lib/../lib/;c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../lib/;c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/lib/;c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../
COLLECT_GCC_OPTIONS='-v' '-o' 'a.out' '-mtune=generic' '-march=pentiumpro'
 c:/mingw64w32/bin/../libexec/gcc/i686-w64-mingw32/4.7.2/collect2.exe --sysroot=/home/drangon/work/mingw-w64-dgn_32/target -m i386pe -Bdynamic -o a.out c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/lib/../lib/crt2.o c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/crtbegin.o -Lc:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2 -Lc:/mingw64w32/bin/../lib/gcc -Lc:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/lib/../lib -Lc:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../lib -Lc:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/lib -Lc:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../.. C:/Users/Joe/AppData/Local/Temp/test-709513.o -lmingw32 -lgcc_eh -lgcc -lmoldname -lmingwex -lmsvcrt -ladvapi32 -lshell32 -luser32 -lkernel32 -lmingw32 -lgcc_eh -lgcc -lmoldname -lmingwex -lmsvcrt c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/crtend.o
C:/Users/Joe/AppData/Local/Temp/test-709513.o:fake:(.text+0x4d): undefined reference to `objc_lookup_class'
C:/Users/Joe/AppData/Local/Temp/test-709513.o:fake:(.text+0x62): undefined reference to `objc_msg_lookup'
C:/Users/Joe/AppData/Local/Temp/test-709513.o:fake:(.text+0x9e): undefined reference to `__objc_exec_class'
c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/bin/ld.exe: C:/Users/Joe/AppData/Local/Temp/test-709513.o: bad reloc address 0x14 in section `.data'
c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/bin/ld.exe: final link failed: Invalid operation
collect2.exe: error: ld returned 1 exit status
clang: error: linker (via gcc) command failed with exit code 1 (use -v to see invocation) 
```

通过谷歌搜索，我发现 objc_lookup_class 是在 gnustep 的 libobjc 库中定义的方法。在苹果的 libojbc.dll 的 .def 文件中：“libojbc.def”，我发现了另一个名为“objc_lookUpClass”的方法。google 再搜索一下。所以，apple 的 libojbc 与 gnustep 的 libobjc 不同。苹果的 libojbc 使用 NextStep 库 interface.gnustep 做了一个不同的。

`man gcc`

gcc 对此有两种选择。

`-fgnu-runtime`. 这是 gcc 的默认选项，使用 gnu 风格的运行时。
`-fnext-runtime`，这使用下一步（现在是苹果）风格运行。

所以我将下一步样式选项传递给clang（或gcc？）。 `clang -fnext-runtime`

编译 .o 到 .s 没有错误。似乎 ld.exe 从苹果的 libobjc 库文件中找到了它需要的所有方法。但是另一个错误发生了，使用 -v 选项，这里有详细信息：

```
clang version 3.1 (branches/release_31)
Target: i686-w64-mingw32
Thread model: posix
 "c:/mingw64w32/bin/clang.exe" -cc1 -triple i686-w64-mingw32 -S -disable-free -main-file-name test.m -mrelocation-model static -mdisable-fp-elim -mconstructor-aliases -target-cpu pentium4 -target-linker-version 2.20.51.0.2 -momit-leaf-frame-pointer -v -resource-dir "c:/mingw64w32/bin\\..\\lib\\clang\\3.1" -fmodule-cache-path "C:/Users/Joe/AppData/Local/Temp\\clang-module-cache" -fno-dwarf-directory-asm -fdebug-compilation-dir C:/MINGW64-X86-MSYS-20111123/home/Joe -ferror-limit 19 -fmessage-length 0 -mstackrealign -fno-use-cxa-atexit -fobjc-fragile-abi -fobjc-exceptions -fdiagnostics-show-option -o C:/Users/Joe/AppData/Local/Temp/test-467378.s -x objective-c test.m
clang -cc1 version 3.1 based upon LLVM 3.1 default target i686-w64-mingw32
ignoring nonexistent directory "/usr/local/include"
ignoring nonexistent directory "c:/mingw64w32/bin/../lib/clang/3.1/../../../x86_64-w64-mingw32/include"
ignoring nonexistent directory "/mingw/include"
ignoring nonexistent directory "c:/mingw/include"
ignoring nonexistent directory "/usr/include"
#include "..." search starts here:
#include <...> search starts here:
 c:/mingw64w32/bin/../lib/clang/3.1/include
 c:/mingw64w32/bin/../lib/clang/3.1/../../../i686-w64-mingw32/include
 c:/mingw64w32/bin/../lib/clang/3.1/../../../include
End of search list.
 "c:/mingw64w32/bin/i686-w64-mingw32-gcc.exe" -fnext-runtime -v -c -o C:/Users/Joe/AppData/Local/Temp/test-467379.o -x assembler C:/Users/Joe/AppData/Local/Temp/test-467378.s
Using built-in specs.
COLLECT_GCC=c:/mingw64w32/bin/i686-w64-mingw32-gcc.exe
Target: i686-w64-mingw32
Configured with: /home/drangon/work/mingw-w64-dgn_32/source/gcc/configure --host=i686-w64-mingw32 --target=i686-w64-mingw32 --disable-nls --enable-languages=c,c++,objc,obj-c++ --with-gmp=/home/drangon/work/mingw-w64-dgn_32/build/for_target --enable-twoprocess --disable-libstdcxx-pch --disable-win32-registry --prefix=/home/drangon/work/mingw-w64-dgn_32/target --with-sysroot=/home/drangon/work/mingw-w64-dgn_32/target
Thread model: win32
gcc version 4.7.2 20120823 (prerelease) (GCC) 
COLLECT_GCC_OPTIONS='-fnext-runtime' '-v' '-c' '-o' 'C:/Users/Joe/AppData/Local/Temp/test-467379.o' '-mtune=generic' '-march=pentiumpro'
 c:/mingw64w32/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/bin/as.exe -v -o C:/Users/Joe/AppData/Local/Temp/test-467379.o C:/Users/Joe/AppData/Local/Temp/test-467378.s
GNU assembler version 2.23.51 (i686-w64-mingw32) using BFD version (GNU Binutils) 2.23.51.20120823
C:/Users/Joe/AppData/Local/Temp/test-467378.s: Assembler messages:
C:/Users/Joe/AppData/Local/Temp/test-467378.s:4: Error: unknown pseudo-op: `.lazy_reference'
C:/Users/Joe/AppData/Local/Temp/test-467378.s:57: Error: bad or irreducible absolute expression
C:/Users/Joe/AppData/Local/Temp/test-467378.s:57: Error: junk at end of line, first unrecognized character is `,'
C:/Users/Joe/AppData/Local/Temp/test-467378.s:67: Error: bad or irreducible absolute expression
C:/Users/Joe/AppData/Local/Temp/test-467378.s:67: Error: junk at end of line, first unrecognized character is `,'
C:/Users/Joe/AppData/Local/Temp/test-467378.s:76: Error: bad or irreducible absolute expression
C:/Users/Joe/AppData/Local/Temp/test-467378.s:76: Error: junk at end of line, first unrecognized character is `,'
C:/Users/Joe/AppData/Local/Temp/test-467378.s:92: Error: bad or irreducible absolute expression
C:/Users/Joe/AppData/Local/Temp/test-467378.s:92: Error: junk at end of line, first unrecognized character is `,'
C:/Users/Joe/AppData/Local/Temp/test-467378.s:99: Error: bad or irreducible absolute expression
C:/Users/Joe/AppData/Local/Temp/test-467378.s:99: Error: junk at end of line, first unrecognized character is `,'
C:/Users/Joe/AppData/Local/Temp/test-467378.s:107: Error: bad or irreducible absolute expression
C:/Users/Joe/AppData/Local/Temp/test-467378.s:107: Error: junk at end of line, first unrecognized character is `,'
C:/Users/Joe/AppData/Local/Temp/test-467378.s:123: Error: bad or irreducible absolute expression
C:/Users/Joe/AppData/Local/Temp/test-467378.s:123: Error: junk at end of line, first unrecognized character is `,'
C:/Users/Joe/AppData/Local/Temp/test-467378.s:128: Error: bad or irreducible absolute expression
C:/Users/Joe/AppData/Local/Temp/test-467378.s:128: Error: junk at end of line, first unrecognized character is `,'
C:/Users/Joe/AppData/Local/Temp/test-467378.s:133: Error: bad or irreducible absolute expression
C:/Users/Joe/AppData/Local/Temp/test-467378.s:133: Error: junk at end of line, first unrecognized character is `,'
C:/Users/Joe/AppData/Local/Temp/test-467378.s:137: Error: bad or irreducible absolute expression
C:/Users/Joe/AppData/Local/Temp/test-467378.s:137: Error: junk at end of line, first unrecognized character is `,'
C:/Users/Joe/AppData/Local/Temp/test-467378.s:146: Error: bad or irreducible absolute expression
C:/Users/Joe/AppData/Local/Temp/test-467378.s:146: Error: junk at end of line, first unrecognized character is `,'
clang: error: assembler (via gcc) command failed with exit code 1 (use -v to see invocation) 
```

我不知道汇编语言。但似乎汇编应用程序无法理解这个 .s 文件。所以我使用 -S 选项来保留 .s 文件。one 与 -fgnu-runtime 是铿锵的。另一个是-fnext-runtime。

//test.s ,clang 带有 -fgnu-runtime 选项

```
 .def     __c_Foo__fooWithBar;
    .scl    3;
    .type    32;
    .endef
    .text
    .align    16, 0x90
__c_Foo__fooWithBar:
    pushl    %ebp
    movl    %esp, %ebp
    subl    $16, %esp
    movl    12(%ebp), %eax
    movl    8(%ebp), %ecx
    leal    L_.str, %edx
    movl    %ecx, -4(%ebp)
    movl    %eax, -8(%ebp)
    movl    %edx, (%esp)
    calll    _printf
    movl    %eax, -12(%ebp)
    addl    $16, %esp
    popl    %ebp
    ret

    .def     _main;
    .scl    2;
    .type    32;
    .endef
    .globl    _main
    .align    16, 0x90
_main:
    pushl    %ebp
    movl    %esp, %ebp
    pushl    %esi
    subl    $20, %esp
    calll    ___main
    leal    L_.class_name, %eax
    movl    $0, -8(%ebp)
    movl    %eax, (%esp)
    calll    _objc_lookup_class
    leal    _.objc_selector_list, %ecx
    movl    %eax, (%esp)
    movl    %ecx, 4(%esp)
    movl    %eax, -12(%ebp)
    calll    _objc_msg_lookup
    movl    $0, %ecx
    leal    _.objc_selector_list, %edx
    movl    -12(%ebp), %esi
    movl    %esi, (%esp)
    movl    %edx, 4(%esp)
    movl    %ecx, -16(%ebp)
    calll    *%eax
    movl    -16(%ebp), %eax
    addl    $20, %esp
    popl    %esi
    popl    %ebp
    ret

    .def     _.objc_load_function;
    .scl    3;
    .type    32;
    .endef
    .align    16, 0x90
_.objc_load_function:
    .cfi_startproc
    pushl    %ebp
Ltmp2:
    .cfi_def_cfa_offset 8
Ltmp3:
    .cfi_offset %ebp, -8
    movl    %esp, %ebp
Ltmp4:
    .cfi_def_cfa_register %ebp
    pushl    %eax
    leal    ___unnamed_1, %eax
    movl    %eax, (%esp)
    calll    ___objc_exec_class
    addl    $4, %esp
    popl    %ebp
    ret
    .cfi_endproc

    .data
L_.str:
    .asciz     "abc"

    .globl    ___objc_class_name_Foo
    .align    4
___objc_class_name_Foo:
    .long    0

L___unnamed_2:
    .asciz     "count"

L___unnamed_3:
    .asciz     "i"

    .globl    ___objc_ivar_offset_value_Foo.count
    .align    4
___objc_ivar_offset_value_Foo.count:
    .long    0

    .align    4
_.ivar.offsets:
    .long    ___objc_ivar_offset_value_Foo.count

    .lcomm    _.objc_property_list,8,8
L___unnamed_4:
    .asciz     "v8@0:4"

L___unnamed_5:
    .asciz     "fooWithBar"

    .align    16
_.objc_method_list:
    .long    0
    .long    1
    .long    L___unnamed_5
    .long    L___unnamed_4
    .long    __c_Foo__fooWithBar

    .align    8
_.objc_ivar_list:
    .long    1
    .long    L___unnamed_2
    .long    L___unnamed_3
    .long    0

    .globl    ___objc_ivar_offset_Foo.count
    .align    4
___objc_ivar_offset_Foo.count:
    .long    _.objc_ivar_list+12

L_.class_name:
    .asciz     "Foo"

    .globl    __OBJC_METACLASS_Foo
    .align    16
__OBJC_METACLASS_Foo:
    .long    0
    .long    0
    .long    L_.class_name
    .long    0
    .long    18
    .long    72
    .long    0
    .long    _.objc_method_list
    .long    0
    .long    0
    .long    0
    .long    0
    .long    0
    .long    1
    .long    0
    .long    0
    .long    0
    .long    0

    .lcomm    _.objc_protocol_list,8,8
    .globl    __OBJC_CLASS_Foo
    .align    16
__OBJC_CLASS_Foo:
    .long    __OBJC_METACLASS_Foo
    .long    0
    .long    L_.class_name
    .long    0
    .long    17
    .long    4
    .long    _.objc_ivar_list
    .long    0
    .long    0
    .long    0
    .long    0
    .long    _.objc_protocol_list
    .long    0
    .long    1
    .long    _.ivar.offsets
    .long    _.objc_property_list
    .long    1
    .long    1

    .section    .rdata$__objc_class_ref_Foo,"r"
    .linkonce discard
    .globl    ___objc_class_ref_Foo
    .align    4
___objc_class_ref_Foo:
    .long    ___objc_class_name_Foo

    .data
L___unnamed_6:
    .asciz     "AnotherHack"

L___unnamed_7:
    .asciz     "__ObjC_Protocol_Holder_Ugly_Hack"

    .lcomm    _.objc_protocol_list1,8,8
    .align    16
___unnamed_8:
    .long    L___unnamed_6
    .long    L___unnamed_7
    .long    0
    .long    0
    .long    _.objc_protocol_list1

    .section    .rdata$.objc_sel_namefooWithBar,"r"
    .linkonce discard
    .globl    _.objc_sel_namefooWithBar
_.objc_sel_namefooWithBar:
    .asciz     "fooWithBar"

    .data
    .align    8
_.objc_selector_list:
    .long    _.objc_sel_namefooWithBar
    .long    L___unnamed_4
    .zero    8

    .align    16
___unnamed_9:
    .long    1
    .long    _.objc_selector_list
    .short    1
    .short    1
    .long    __OBJC_CLASS_Foo
    .long    ___unnamed_8
    .long    0
    .long    0

L_.objc_source_file_name:
    .asciz     "./test.m"

    .align    8
___unnamed_1:
    .long    8
    .long    16
    .long    L_.objc_source_file_name
    .long    ___unnamed_9

    .section    .ctors,"w"
    .align    4
    .long    _.objc_load_function 
```

//test.s ,clang 带有 -fnext-runtime 选项

```
 .objc_class_name_Foo=0
    .globl .objc_class_name_Foo
    .lazy_reference .objc_class_name_Foo

    .def     _2B__5B_Foo_20_fooWithBar_5D_;
    .scl    3;
    .type    32;
    .endef
    .text
    .align    16, 0x90
_2B__5B_Foo_20_fooWithBar_5D_:
    pushl    %ebp
    movl    %esp, %ebp
    subl    $16, %esp
    movl    12(%ebp), %eax
    movl    8(%ebp), %ecx
    leal    L_.str, %edx
    movl    %ecx, -4(%ebp)
    movl    %eax, -8(%ebp)
    movl    %edx, (%esp)
    calll    _printf
    movl    %eax, -12(%ebp)
    addl    $16, %esp
    popl    %ebp
    ret

    .def     _main;
    .scl    2;
    .type    32;
    .endef
    .globl    _main
    .align    16, 0x90
_main:
    pushl    %ebp
    movl    %esp, %ebp
    subl    $16, %esp
    calll    ___main
    movl    $0, %eax
    movl    $0, -4(%ebp)
    movl    L_OBJC_CLASS_REFERENCES_, %ecx
    movl    L_OBJC_SELECTOR_REFERENCES_, %edx
    movl    %ecx, (%esp)
    movl    %edx, 4(%esp)
    movl    %eax, -8(%ebp)
    calll    _objc_msgSend
    movl    -8(%ebp), %eax
    addl    $16, %esp
    popl    %ebp
    ret

    .data
L_.str:
    .asciz     "abc"

    .section    __TEXT,__cstring,cstring_literals,"w"
L_OBJC_METH_VAR_NAME_:
    .asciz     "fooWithBar"

L_OBJC_METH_VAR_TYPE_:
    .asciz     "v8@0:4"

L_OBJC_CLASS_NAME_:
    .asciz     "Foo"

    .section    __OBJC,__cls_meth,regular,no_dead_strip,"w"
    .align    4
L_OBJC_CLASS_METHODS_Foo:
    .long    0
    .long    1
    .long    L_OBJC_METH_VAR_NAME_
    .long    L_OBJC_METH_VAR_TYPE_
    .long    _2B__5B_Foo_20_fooWithBar_5D_

    .section    __OBJC,__meta_class,regular,no_dead_strip,"w"
    .align    4
L_OBJC_METACLASS_Foo:
    .long    L_OBJC_CLASS_NAME_
    .long    0
    .long    L_OBJC_CLASS_NAME_
    .long    0
    .long    2
    .long    48
    .long    0
    .long    L_OBJC_CLASS_METHODS_Foo
    .long    0
    .long    0
    .long    0
    .long    0

    .section    __TEXT,__cstring,cstring_literals,"w"
L_OBJC_METH_VAR_NAME_1:
    .asciz     "count"

L_OBJC_METH_VAR_TYPE_2:
    .asciz     "i"

    .section    __OBJC,__instance_vars,regular,no_dead_strip,"w"
    .align    4
L_OBJC_INSTANCE_VARIABLES_Foo:
    .long    1
    .long    L_OBJC_METH_VAR_NAME_1
    .long    L_OBJC_METH_VAR_TYPE_2
    .long    0

    .section    __OBJC,__class,regular,no_dead_strip,"w"
    .align    4
L_OBJC_CLASS_Foo:
    .long    L_OBJC_METACLASS_Foo
    .long    0
    .long    L_OBJC_CLASS_NAME_
    .long    0
    .long    1
    .long    4
    .long    L_OBJC_INSTANCE_VARIABLES_Foo
    .long    0
    .long    0
    .long    0
    .long    0
    .long    0

    .section    __OBJC,__cls_refs,literal_pointers,no_dead_strip,"w"
    .align    4
L_OBJC_CLASS_REFERENCES_:
    .long    L_OBJC_CLASS_NAME_

    .section    __OBJC,__message_refs,literal_pointers,no_dead_strip,"w"
    .align    4
L_OBJC_SELECTOR_REFERENCES_:
    .long    L_OBJC_METH_VAR_NAME_

    .section    __TEXT,__cstring,cstring_literals,"w"
L_OBJC_CLASS_NAME_3:
    .zero    1

    .section    __OBJC,__symbols,regular,no_dead_strip,"w"
    .align    4
L_OBJC_SYMBOLS:
    .long    0
    .long    0
    .short    1
    .short    0
    .long    L_OBJC_CLASS_Foo

    .section    __OBJC,__module_info,regular,no_dead_strip,"w"
    .align    4
L_OBJC_MODULES:
    .long    7
    .long    16
    .long    L_OBJC_CLASS_NAME_3
    .long    L_OBJC_SYMBOLS 
```

我相信关键问题来自 .s 文件的创建方式。

谁能帮我解决这个问题？虽然使用这些 .dll 文件无法创建业务应用程序。

但是通过使用这些.dll，我们可以在window平台上搭建一个更好的可可学习环境。所有框架的 windows 版本都比 gnustep 更稳定和有用。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T03:02:06.963

嗯，首先这违反了 iTunes EULA，所以无论是否商业，你都不应该这样做。

第二个问题是 clang/gcc 中的 -fnext-runtime 仅在 Darwin 上起作用，它缺少适用于 Windows 和其他操作系统的各种零碎。我会（受过教育）猜测并假设 -fgnu-runtime 对于链接苹果自己的框架是无用的。

如您所见，-fnext-runtime 在 Windows 上发出 Darwin 特定的汇编程序命令，例如 .lazy_reference，这不是一个好的开始。

这是 gcc 中 -fnext-runtime 的情况，现在很长一段时间，没有人在非达尔文系统的主线中维护 -fnext-runtime。

我粗略的理解是，Apple 实际上并没有直接在 Windows 上使用 clang，他们将 Objective-C 重写为 C 并使用 Visual Studio 为 Windows 编译。

您可以开始对 clang 进行一些严肃的黑客攻击，或者不要打扰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-06T04:57:17.703

我试着做和你最近一样的事情，我发现了类似的结果。核心（技术而非法律）问题是`-fnext-runtime`在 Windows 上不受支持，并且可能永远不会受到支持。我马上就到`-fgnu-runtime`。

无论您在 Windows 上编写的 Objective-C 程序多么基本，您最终都会得到未解决的引用。查看这些`.dll`文件，您会发现它们根本不包含链接在 Windows 上使用 Clang 编译的 Objective-C 程序所需的一些核心方法。（如果没记错的话，我能够编译一个至少只有 2 个未解析引用的程序）。

所以在`-fnext-runtime`不支持的基础上，可以试试`-fgnu-runtime`GCC。当然，您失去了与所有 Apple 库的兼容性，但您*确实*可以在 Windows 上运行 Objective-C 程序。GCC 最近升级了他们的 Objective-C 运行时，使其与 Apple 的 Objective-C 运行时几乎相同，因此兼容性现在已不再是问题。

同样，您没有获得 Apple 的库，您必须自己编写它们（任何接受者？）但运行时以相同的方式工作。[制作自己的`NSObject`](http://www.mikeash.com/pyblog/friday-qa-2013-01-25-lets-build-nsobject.html)（尽管查看[Apple 的实现](http://www.opensource.apple.com/source/objc4/objc4-532/runtime/NSObject.mm)会有所帮助）和[Constant String @"..." 对象](http://gcc.gnu.org/onlinedocs/gcc/Constant-string-objects.html)需要一些工作，但是一旦拥有它们，您就可以构建自己的 Windows 兼容的 Objective-C 框架。根据经验，我可以告诉你，这绝对是可能的。

# objective-c - UIScrollView 闪烁固定子视图

> ID：12900600
> 
> 赞同：1
> 
> 时间：2012-10-15T17:09:25.787
> 
> 标签：objective-c, ios, uiscrollview

我使用以下代码在我的 UIScrollView 后代中制作“固定”行标题。它适用于模拟器，但不幸的是，它在 iPad 上闪烁。（在行标题视图的左侧，出现和消失的白色 1px 线。）有什么可以改进的？

```
- (void)initSubviews
{
    const int ROW_COUNT = 20;
    rowHeaderViews = [[NSMutableArray alloc]initWithCapacity:ROW_COUNT];
    rowViews = [[NSMutableArray alloc]initWithCapacity:ROW_COUNT];

    [self setContentSize:CGSizeMake(2000, [self frame].size.height)];

    for (int i = 0; i < ROW_COUNT; i++)
    {
        UIView *header = [self createRowHeaderViewForRowNum:i];
        [rowHeaderViews addObject:header];

        UIView *row = [self createRowViewForRowNum:i];
        [rowViews addObject:row];

        [self addSubview:row];
        [self addSubview:header];
    }
    [self layoutSubviews];
}

- (void)layoutSubviews
{
    int x = [self contentOffset].x;
    for (UIView *view in rowHeaderViews) {
        [view setFrame:CGRectMake(x, view.frame.origin.y, view.frame.size.width, view.frame.size.height)];
    }
}

- (UIView *)createRowHeaderViewForRowNum: (int)rowNum
{
    UILabel *view = [[UILabel alloc]initWithFrame:CGRectMake(0, rowNum * 20, 200, 20)];
    [view setBackgroundColor:[UIColor colorWithWhite:0.8*(20-rowNum)/20 alpha:1]];
    [view setText:[NSString stringWithFormat:@"Row Header %d", rowNum]];
    return view;
}

- (UIView *)createRowViewForRowNum: (int)rowNum
{
    UILabel *view = [[UILabel alloc]initWithFrame:CGRectMake(200, rowNum * 20, 1800, 20)];
    [view setBackgroundColor:[UIColor colorWithRed:rowNum/20.0 green:0 blue:0 alpha:1]];
    [view setText:[NSString stringWithFormat:@"Row Content %d", rowNum]];
    return view;
} 
```

非常感谢您的帮助！

**编辑**：iPad 有一个 Retina 显示屏。将模拟器与“普通”iPad 一起使用时，它不会闪烁。将模拟器切换到“Retina display”iPad 时，也会出现这种闪烁。也许这与点/像素差异有关？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:47:34.507

我自己发现了这个错误。对不起，打扰你。以防其他人遇到同样的问题： contentOffset.x 是一个浮点值，包含 0.5 用于 Retina 显示器的值。将其分配给 int 变量会`layoutSubviews`导致问题。这是修复（注意我用 'CGFloat' 替换了 'int'）：

```
- (void)layoutSubviews
{
    CGFloat x = [self contentOffset].x;
    for (UIView *view in rowHeaderViews) {
        [view setFrame:CGRectMake(x, view.frame.origin.y, view.frame.size.width, view.frame.size.height)];
    }
} 
```

# sql-server - 如何创建一个 SQL Server 视图，该视图将返回使用游标或存储过程的复杂 SQL 的结果？

> ID：12900605
> 
> 赞同：0
> 
> 时间：2012-10-15T17:09:50.427
> 
> 标签：sql-server

我有一个包含时间表的表，每个间隔都是该表中的一条记录（即 8:00 到 5:00。周一到周五将是该表中的 5 条记录）。我一直在研究一种可以轻松检测 SQL 查询中的重复项的方法，该查询可以创建为视图。我有一个使用游标和临时表完成工作的 SQL 查询，但游标在视图中不起作用。

我什至创建了一个存储过程来填充临时表，但我真正想做的是从视图中调用存储过程并显示结果。

如果我执行存储过程，它确实会返回预期的结果，但是我需要能够从 Select 语句中看到结果。我不能让我的用户直接执行存储过程。

这是 SP 的代码。

```
CREATE PROCEDURE Report_Duplicate_Schedules
AS
BEGIN
    DECLARE @Number1 AS INT, @Count1 AS INT, @ST1 AS INT, @ET1 AS INT
    DECLARE @Number2 AS INT, @Count2 AS INT, @ST2 AS INT, @ET2 AS INT
    DECLARE @Count3 AS INT

    CREATE TABLE #SchedulesDuplicates (ScheduleName NVARCHAR(100), ScheduleNumber INT, DuplicateSchedule NVARCHAR(100), DuplicateNumber INT, StartTime INT, StopTime INT);

    DECLARE Step1 CURSOR
        FOR (SELECT DISTINCT [Number], COUNT(*) AS [Count] FROM [Schedules] GROUP BY [Number])
    OPEN Step1
    FETCH NEXT FROM Step1 INTO @Number1, @Count1
    WHILE @@FETCH_STATUS = 0
    BEGIN
        DECLARE Step2 CURSOR
            FOR (SELECT [Number], COUNT(*) AS [Count] FROM [Schedules] WHERE [Number] > @Number1 GROUP BY [Number])
        OPEN Step2
        FETCH NEXT FROM Step2 INTO @Number2, @Count2
        WHILE @@FETCH_STATUS = 0
        BEGIN
            IF @Count1 = @Count2
            BEGIN
                --PRINT CAST(@Number1 AS VARCHAR(50)) + N' - ' + CAST(@Count1 AS VARCHAR(50)) + N' - ' + CAST(@Number2 AS VARCHAR(50)) + N' - ' + CAST(@Count2 AS VARCHAR(50))
                SELECT @Count3 = COUNT(*) FROM 
                (SELECT [Number], [StartTime], [StopTime] FROM [Schedules] WHERE [Number] = @Number1) AS z,
                (SELECT [Number], [StartTime], [StopTime] FROM [Schedules] WHERE [Number] = @Number2) AS y
                WHERE z.[StartTime] = y.[StartTime] AND z.[StopTime] = y.[StopTime]
                IF @Count1 = @Count3
                BEGIN
                    --PRINT CAST(@Number1 AS VARCHAR(50)) + N' - ' + CAST(@Count1 AS VARCHAR(50)) + N' - ' + CAST(@Number2 AS VARCHAR(50)) + N' - ' + CAST(@Count2 AS VARCHAR(50)) + N' - ' + CAST(@Count3 AS VARCHAR(50))
                    INSERT INTO #SchedulesDuplicates ([ScheduleName], [ScheduleNumber], [DuplicateSchedule], [DuplicateNumber], [StartTime], [StopTime]) (SELECT DISTINCT u.[Name], u.[Number], v.[Name], v.[Number], v.[StartTime], v.[StopTime] FROM (SELECT [Name], [Number], [StartTime], [StopTime] FROM [Schedules] WHERE [Number] = @Number1) AS u, (SELECT [Name], [Number], [StartTime], [StopTime] FROM [Schedules] WHERE [Number] = @Number2) AS v)
                END
            END
            FETCH NEXT FROM Step2 INTO @Number2, @Count2
        END 
        CLOSE Step2
        DEALLOCATE STEP2
        FETCH NEXT FROM Step1 INTO @Number1, @Count1
    END
    CLOSE Step1
    DEALLOCATE Step1

SELECT * FROM #SchedulesDuplicates

DROP TABLE #SchedulesDuplicates

END
GO 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:18:40.823

您可以尝试以下技巧：

```
SELECT *
FROM OPENQUERY(MyServerName, 'SET FMTONLY OFF EXEC database.dbo.procedure') 
```

几点注意事项：

*   应该在服务器上启用 DATAACCESS 选项
*   正确的列元数据检索最需要 SET FMTONLY
*   过程应该在开头有 SET NOCOUNT ON 语句，没有它元数据检索失败

* * *

但是，我建议您逐行重写此处理逻辑以设置基于代码的代码，这很容易适应普通视图。表值用户定义函数也可以完成这项工作。

# javascript - KineticJS 不会在 Internet Explorer 中加载

> ID：12900608
> 
> 赞同：2
> 
> 时间：2012-10-15T17:10:04.510
> 
> 标签：javascript, kineticjs

我遇到了一个非常烦人的问题 - 我刚刚在 KineticJS 中制作了一个可爱的脚本 - [http://test.manwe.cz/kolac.php](http://test.manwe.cz/kolac.php)

正如您所看到的，它在 Chrome/FF 中完美运行，但在 IE 中它只是说我不能使用方法“indexOf”并指向 Kineticjs.js 内的某个地方......我得到了最新的 KineticJS 版本，我试图调试它看起来问题出在 Kinetic.Stage 构造函数中。当我将其注释掉时，它可以工作（但显然没有其他工作）感谢您的帮助，我有点绝望。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T00:05:14.327

那么我也有同样的问题。所以我想出的最好的方法是在 javascript 中添加额外的方法。

```
 if (!Array.prototype.indexOf)
    {
      Array.prototype.indexOf = function(elt /*, from*/)
      {
        var len = this.length;

        var from = Number(arguments[1]) || 0;
        from = (from < 0)
             ? Math.ceil(from)
             : Math.floor(from);
        if (from < 0)
          from += len;

        for (; from < len; from++)
        {
          if (from in this &&
              this[from] === elt)
            return from;
        }
        return -1;
      };
    } 
```

这将解决 indexOf 问题，但是这会带来另一个问题。最新版本似乎添加了get“Property”（）和set“Property”（）。

我的“猜测”是使用这行代码的 kinecticJS 的一些内部工作原理：

```
 this.context = this.element.getContext('2d'); 
```

“以我的拙见”应该在哪里

```
 this.setContext(this.getElement().getContext('2d')); 
```

我的另一个“猜测”是这不能通过更改几行代码来解决。不过，我对此并不完全确定。我刚刚开始研究这个问题。我可能会建议降级版本，但我不确定这是否能解决问题。

更新：

所以再看一点，我发现这篇文章 [HTMLCanvas 'getContext' is not a supported property or method](https://stackoverflow.com/questions/9307159/htmlcanvas-getcontext-is-not-a-supported-property-or-method) 这意味着我以前的“猜测”都不正确。总结一下你最需要的就是你的html头数据中的这一行：

```
<meta http-equiv="X-UA-Compatible" content="chrome=1, IE=edge"> 
```

这解决了我在 IE 中遇到的问题（版本 9.0.8112.16421）

# java - 测试一个巨大的分解方法及其内部辅助方法

> ID：12900613
> 
> 赞同：2
> 
> 时间：2012-10-15T17:10:15.473
> 
> 标签：java, unit-testing, testing, tdd

我最近一直在写很多单元测试。有一种情况我找不到干净的解决方案......

假设您有一种方法：

```
public void bigMethod() {
    // a lot of code goes in here
} 
```

为了让你的生活更轻松和代码更简洁，你通常会将这样的野兽分解为更小的内部方法：

```
public void bigMethod() {
    a();
    b();
    c();
    // etc.
} 
```

您可以独立测试所有内部方法（a()、b()、c() 等）。问题是 bigMethod() 也应该进行测试，但它唯一要做的就是链接其他一些方法的调用，并且这些方法已经过彻底测试！

您如何处理这种情况？你不能不测试 bigMethod()，因为你需要确保 a()、b() 和 c() 是按正确的顺序调用的。但是为 bigMethod() 编写测试会导致大量重复测试。每次都减少这种重复会很麻烦，因为你会经常这样做。

我想到的一个想法是：

```
public void bigMethod() {
    helperA.a();
    helperB.b();
    helperC.c();
    // etc.
} 
```

在这种情况下，您测试每个帮助程序类，然后确保 bigMethod() 按顺序调用它们。很好很干净，但是在项目中引入了很多非常小的类。

帮助测试忍者！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:20:41.977

通常，最佳实践是让您的单元测试测试`bigMethod()`，因为它是公开的方法，并且测试不知道内部的私有辅助方法。

`bigMethod()`正如您所指出的，如果您重构.

所以我的建议是重写你的测试以专注于`bigMethod()`然后不必担心代码重复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:26:22.427

您找不到好的解决方案的原因是将方法拆分为连续的部分并没有真正改善事情。事实上，它可能使调试变得更加困难，因为您必须跨方法边界共享状态，可能使用实例变量。

我知道这不是您想听到的答案，但是如果您真的想改进代码，您将退后一步，重新分析所做的事情`bigMethod`并重写它，将其各种功能分成具有适当接口的类。理想情况下，您还会重构`bigMethod`被调用的位置，但我意识到这可能超出了您分配的任务的范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T17:29:01.643

**首先，如果和是公共方法`a()`，则以下所有文本都是有意义的。`b()``c()`**

`bigMethod()`测试关注内部调用的后果，意思是调用`a()`后面跟着`b()`和后面跟着`c()`。

**这完全是另一种情况，而不是独立测试这些方法中的每一个。**

所以根据我的说法，添加一个特定的测试`bigMethod()`并没有揭示一些重复，而是一个新的有趣的案例来检查：**内部调用的协作**。

我会保留您的第一个代码版本并对其进行测试:)

实际上，这似乎是项目交付中类似的常见问题：

假设三个项目分别开发并最终收集起来。

三种可能的做法：

*   仅独立测试三个项目
*   等待单独测试三个项目的混合
*   测试这两种方式！

从逻辑上讲，希望有第三种可能性；单元测试也是如此。

`a()`或`b()`或`c()`可能有意外的行为，但不会阻止`bigMethod()`获得预期的结果，相反，`bigMethod()`尽管独立方法的测试成功，但可能会产生意外的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T09:04:18.983

我认为解决方案对您来说不清楚的原因是因为您没有真正考虑并定义`a()`,`b()`和的性质`c()`。您肯定需要弄清楚以下哪一项`a()`，`b()`并且`c()`是：

1.  内部的，不可分割的子部分`bigMethod()`在它之外没有任何意义。

2.  作为类公共契约一部分的方法，有助于其凝聚力，并且可以独立于外部调用。

3.  毕竟不属于该类的方法。将它们取出将有利于班级的凝聚力，并使它们更容易重复使用。

一旦你弄清楚了，如何测试它们的答案就很容易了。

1.  只需`bigMethod()`像原子块一样进行测试，不要试图摆弄其内部子部分的可见性范围以使其可测试。

2.  测试`a()`，`b()`并且`c()`独立。然后进行测试`bigMethod()`，使用部分模拟并验证子方法是否以正确的顺序调用。您还可以 test`bigMethod()`的结果，使其更像是集成测试而不是单元测试，但您提到了重复问题。

3.  测试`a()`，`b()`并且`c()`独立。然后进行测试`bigMethod()`，对其对象使用模拟并验证`bigMethod()`与这些对象的对话是否正确。

# c# - 在 C# 中优化 if 语句 (a > 0 && b > 0 && a + b == c)

> ID：12900616
> 
> 赞同：8
> 
> 时间：2012-10-15T17:10:31.793
> 
> 标签：c#, optimization, if-statement

我目前正在做一些涉及邻接矩阵的图形计算，并且我正在优化它的每一点。

我认为可以优化的指令之一是标题中的指令，它的原始形式：

```
if ((adjMatrix[i][k] > 0) && (adjMatrix[k][j] > 0) && (adjMatrix[i][k] + adjMatrix[k][j] == w)) 
```

但为方便起见，我将坚持标题中提供的表格：

```
if (a > 0 && b > 0 && a + b == c) 
```

我不喜欢的是 > 0 部分（作为邻接矩阵，在它的初始形式中它只包含 0 和 1，但随着程序的进行，零被替换为从 2 开始的数字，直到不再有零。

我已经做了一个测试并删除了 a 和 b 的 > 0 部分，并且有显着的改进。超过 60088 次迭代**减少了 792ms**，从 3672ms 减少到 2880ms，这是原始时间的 78%，这对我来说非常好。

所以我的问题是：你能想出某种方法来优化这样的语句并在 C# 中获得相同的结果吗？也许一些按位运算或类似的东西，我对它们不太熟悉。

回答你脑海中闪过的每一个想法，即使它不合适。我会自己做速度测试，然后告诉你结果。

**编辑：**这是一个编译器，我将自己在我的计算机上运行它。我刚才描述的不是我抱怨的问题/瓶颈。当前形式的程序可以很好地满足我的需求，但我只是想推动它前进并使其尽可能基本和优化。希望这能澄清一点。

**编辑**我相信提供完整的代码是一件有用的事情，所以在这里，但请记住我在下面用粗体字说的话。**我想严格专注于 if 语句**。该程序本质上采用邻接矩阵并存储所有存在的路线组合。然后根据一些系数进行排序和修剪，但是这个我没有包括在内。

```
int w, i, j, li, k;
int[][] adjMatrix = Data.AdjacencyMatrix;
List<List<List<int[]>>> output = new List<List<List<int[]>>>(c);

for (w = 2; w <= 5; w++)
{
    int[] plan;

    for (i = 0; i < c; i++)
    {
        for (j = 0; j < c; j++)
        {
            if (j == i) continue;
            if (adjMatrix[i][j] == 0)
            {
                for (k = 0; k < c; k++) // 11.7%
                {
                    if (
                        adjMatrix[i][k] > 0 && 
                        adjMatrix[k][j] > 0 && 
                        adjMatrix[i][k] + adjMatrix[k][j] == w) // 26.4%
                    {
                        adjMatrix[i][j] = w;

                        foreach (int[] first in output[i][k])
                            foreach (int[] second in output[k][j]) // 33.9%
                            {
                                plan = new int[w - 1];
                                li = 0;

                                foreach (int l in first) plan[li++] = l;
                                plan[li++] = k;
                                foreach (int l in second) plan[li++] = l;

                                output[i][j].Add(plan);
                            }
                    }
                }

                // Here the sorting and trimming occurs, but for the sake of
                // discussion, this is only a simple IEnumerable<T>.Take()
                if (adjMatrix[i][j] == w)
                    output[i][j] = output[i][j].Take(10).ToList();
            }
        }
    }
} 
```

**添加了带有探查器的注释以优化构建**。

顺便说一句，正是通过这段代码获得了计时结果（没有排序和修剪，这大大增加了执行时间）。我的测量中没有其他零件。在这段代码之前有一个 Stopwatch.StartNew() ，之后有一个 Console.WriteLine(EllapsedMilliseconds) 。

如果你想知道大小，邻接矩阵有 406 行/列。所以基本上只有 for 指令组合起来执行很多次迭代，所以我没有很多优化选项。速度目前不是问题，但我想确保我准备好了。

**为了排除“优化其他部分”的问题，这个主题也有讨论的余地，但对于这个具体问题，我只想找到一个抽象问题/概念的解决方案。它可以帮助我和其他人了解 C# 编译器如何工作以及如何处理 if 语句和比较，这就是我的目标。**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T17:14:35.743

您可以替换为`a>0 && b>0`带`(a-1)|(b-1) >= 0`符号的变量*a*和*b*。

同样，条件`x == w`可以表示为`(x - w)|(w - x) >= 0`，因为`x != w`表达式的左侧或右侧部分将切换符号位，该符号位由按位*或*保留。所有放在一起的东西都将被`(a-1)|(b-1)|(a+b-w)|(w-a-b) >= 0`表达为一个单一的比较。

或者，将概率按递增顺序排列可能会带来轻微的速度优势：

哪个更有可能`(a|b)>=0`？`(a+b)==w`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-15T17:32:29.593

我不知道 C# 优化这样的事情有多好，但尝试存储 `adjMatrix[i][k]`和`adjMatrix[k][j]`在临时变量中不读取两次内存并不难。看看这是否会以任何方式改变事情。

很难相信算术和比较运算是这里的瓶颈。很可能是内存访问或分支。理想情况下，应该以线性方式访问内存。你能做点什么让它更线性吗？

看到更多代码来提出更具体的建议会很好。

**更新：**您可以尝试使用二维数组 ( `int[,]`) 而不是锯齿状数组 ( `int[][]`)。这可能会提高内存局部性和元素访问速度。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-15T17:31:29.033

逻辑测试的顺序可能很重要（如其他答案中所述）。由于您使用的是短路逻辑测试（&& 而不是 &），因此从左到右评估条件，并且它发现的第一个为假的，将导致程序停止评估条件并继续执行（没有执行`if`块）。因此，如果有一种情况比其他情况更有可能发生`false`，则应该首先出现，下一个应该是下一个最有可能出现的情况`false`，依此类推。

另一个很好的优化（我怀疑这确实是您提高性能的原因——而不是简单地放弃一些条件）是将您从数组中提取的值分配给局部变量。

您正在使用`adjMatrix[i][k]`两次（以及`adjMatrix[k][j]`），这迫使计算机挖掘数组以获取值。相反，在 if 语句之前，每次都将它们中的每一个设置为一个局部变量，然后对这些变量进行逻辑测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T18:04:45.580

除非你调用一个函数，否则你不会优化条件。这是毫无意义。但是，如果您真的想记住一些简单的事情

检查条件是否为零（或不为零），是否设置了最高位（或未设置）并且比较（== 或！=）本质上是 a - b 并检查其是否为零（==0） （！= 0）。所以 a 是无符号的，那么 a>0 与 a!=0 相同。如果 a 已签名，则 a<0 非常好（这使用对最高位的检查）并且比 a<=0 更好。但无论如何，只要知道这些规则可能会有所帮助。

还要启动一个分析器，您会看到条件占 001% 的时间。如果有的话，您应该询问如何编写不需要条件的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-15T17:50:43.070

我同意其他人的观点，他们认为这个简单的语句不太可能是您的瓶颈，并建议在您决定优化此特定行之前进行分析。但是，作为一个理论实验，你可以做几件事：

1.  零检查：检查`a != 0 && b != 0`可能会比`a >= 0 && b >= 0`. 由于您的邻接矩阵是非负的，因此您可以安全地执行此操作。

2.  重新排序：如果测试`a + b == c`更快，请先尝试使用此测试，然后再`a`单独`b`测试。我怀疑这会更快，因为加法和相等检查比零检查更昂贵，但它可能适用于您的特定情况。

3.  避免双重索引：使用 ILDASM 或等效方法查看生成的 IL，以确保数组索引仅被取消引用一次，而不是两次。如果不是，请尝试在检查之前将它们放入局部变量中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-15T18:22:53.377

你考虑过颠倒逻辑吗​​？

```
if (a > 0 && b > 0 && a + b == c) 
```

可以改写为：

```
if (a == 0 || b == 0 || a + b != c) continue; 
```

由于如果任何语句为假，您不想在循环中执行任何操作，因此请尝试尽快中止（如果运行时很聪明，我假设）。

最重的操作应该放在最后，因为如果第一个语句为真，则不需要检查其他语句。我认为添加是最重的部分，但分析它可能会讲述一个不同的故事。

但是，我自己并没有描述过这些场景，而且对于这些微不足道的条件，它甚至可能是一个缺点。看到你的发现会很有趣。

# python-sphinx - 将 CSS 和角色应用于文本块而不是 Sphinx 中的内联跨度

> ID：12900626
> 
> 赞同：14
> 
> 时间：2012-10-15T17:10:53.697
> 
> 标签：python-sphinx, restructuredtext

有[一个先前的问题](https://stackoverflow.com/q/4669689/)解释了如何向某些 reStructuredText 添加颜色跨度。

回顾一下这个过程：

首先，你有这个角色。

```
.. role:: red

An example of using :red:`interpreted text` 
```

它翻译成如下。

```
<p>An example of using <span class="red">interpreted text</span></p> 
```

现在，你有了 red 类，你可以使用 CSS 来改变颜色。

```
.red {
    color:red;
} 
```

如果你想要跨越多行的文本，你怎么做？例如：

```
.. role:: red

:red:`paragraph 1

      paragraph 2

      paragraph 3` 
```

其中第 1、2 和 3 段都将是“红色”。如果我尝试这样做，我会收到警告消息：

> 警告：没有结束字符串的内联解释文本或短语引用起始字符串。

它不会创建跨度并将 ":red:" 插入到文本中。它只是不将其解释为字符串（如警告所示）。

基本上，这可以在 reStructuredText 中完成，如果可以，怎么做？

我正在使用狮身人面像 1.1.3。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-23T20:58:38.247

有很多方法可以做到这一点，但其中一种是使用`class`指令：

```
.. class:: red

    This is a paragraph.

    This is another paragraph. 
```

大多数 docutils HTML 编写者会将其作为类 html 属性放入 html 输出中，然后您可以使用 CSS 对其进行样式设置。

但是，尤其是在 Sphinx中，至少在某些情况下，您可能需要使用`rst-class`而不是。`class`见：[https ://www.sphinx-doc.org/en/2.0/usage/restructuredtext/basics.html](https://www.sphinx-doc.org/en/2.0/usage/restructuredtext/basics.html)

此外，RestructuredText 中的许多块级元素都采用一个`:class:`参数，该参数的作用几乎相同。

# mongoose - MongooseJS：防止 .populate() 将字段设置为 NULL？

> ID：12900628
> 
> 赞同：4
> 
> 时间：2012-10-15T17:11:00.863
> 
> 标签：mongoose

我有一个 Mongoose 模型，其属性引用另一个模型（即，单独集合中的文档）。引用的文档并不总是存在（例如，它已被删除）。在这种情况下，如果我调用 model.someProp.populate()，model.someProp 被设置为 NULL。

是否可以修改 .populate() 的行为，如果找不到引用文档，则保留原始字段值而不是将其设置为 NULL？

# asp.net - 如何更改网格视图大小

> ID：12900631
> 
> 赞同：0
> 
> 时间：2012-10-15T17:11:10.613
> 
> 标签：asp.net, vb.net

嘿伙计们，我在更改 gridview 的长度和宽度时遇到了麻烦。它是绑定的，每次我在设计器或代码中更改大小时，它都会不断重置。问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:43:14.783

您是否尝试将大小更改为大于最大值或小于最小值的大小？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:50:08.257

对于自定义客户端大小，您需要创建一个 CSS 类，其中包含要分配给表格的大小。

您所要做的就是在客户端检查框架生成的 html，然后为其编写 CSS 规则。

例如，没有任何样式的 vanilla gridview 会生成以下 HTML：

```
<table cellspacing="0" rules="all" border="1" id="MainContent_GridView1" 
   style="border-collapse:collapse;"> 
```

所以在你的 CSS 中，你可以写：

```
#MainContent-GridView{
   height: your_height_px;
   width : your_width_px;
} 
```

如果需要，您可以通过为其分配一个 css 类来执行相同的操作。（这就是我要走的路线，这样我就可以根据需要将 css 应用于尽可能多的 gridviews/tables ......）

# javascript - 通过 javaScript 将“tap”添加到 Html

> ID：12900635
> 
> 赞同：0
> 
> 时间：2012-10-15T17:11:34.663
> 
> 标签：javascript, jquery, html

我想通过java脚本将点击添加到html按钮，以便它启动`Onclick`功能。我尝试了下一个代码：

```
$("#mydiv").html('bind("'tap'", Onclick)'); 
```

没有添加到 html 中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:13:56.973

大多数移动浏览器将点击转换为点击事件。所以只需使用

```
$("#mydiv").click(function(){ 
    // do stuff 
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T17:14:53.093

`.bind()`您可以使用该方法绑定点击事件。

```
$("#mydiv").bind('tap', tapHandler); 

function tapHandler()
{
  // handle tap ...
} 
```

# android - 是否最好使用 Activity.onAttachFragment 或 Fragment.onAttach 在 Activity 和嵌套片段之间进行通信？

> ID：12900640
> 
> 赞同：27
> 
> 时间：2012-10-15T17:12:02.093
> 
> 标签：android, design-patterns, android-fragments

Android 文档建议从一个 Activity 到一个托管的 Fragment 进行通信，该 Fragment 可以定义一个回调接口并要求宿主 Activity 实现它。基本模式涉及`onAttach`在您的片段中实现，并将活动转换为回调接口。请参阅[http://developer.android.com/guide/components/fragments.html#CommunicatingWithActivity](http://developer.android.com/guide/components/fragments.html#CommunicatingWithActivity)。

这是一个为片段提供一些初始化数据以及监听导航回调的示例。

```
public class HostActivity extends Activity implements FragmentHost {
  @Override
  UiModel getUiModel() {
    return mUiModel;
  }
  @Override
  FragmentNavListener getNavListener() {
    return mNavListener;
  }
...
}

public class HostedFragment extends Fragment {
  @Override
  public void onAttach(Activity activity) {
    super.onAttach(activity);
    if (activity instanceof FragmentHost) {
      FragmentHost host = (FragmentHost) activity;
      setUiModel(host.getUiModel());
      setNavListener(host.getFragmentNavListener());
    }
  }
  ...
} 
```

将此与`onAttachFragment`在主机活动中使用以显式初始化片段进行比较：

```
public class HostActivity extends Activity {
  @Override
  public void onAttachFragment(Fragment fragment) {
    super.onAttachFragment(fragment);
    if (fragment instanceof HostedFragment) {
      HostedFragment hostedFragment = ((HostFragment) fragment);
      hostedFragment.setUiModel(mUiModel);
      hostedFragment.setNavListener(mNavListener);
    }
  }
  ...
} 
```

对我来说，第一种模式似乎有一些缺点：

1.  它使片段更难从不同的活动中使用，因为所有这些活动都必须实现所需的接口。我可以想象给定片段实例不需要由主机活动完全配置的情况，但所有潜在的主机活动都需要实现主机接口。
2.  对于不熟悉正在使用的模式的人来说，这会使代码稍微难以理解。在 onFragmentAttached 中初始化片段似乎更容易理解，因为初始化代码位于创建片段的同一类中。
3.  使用像 Robolectric 这样的库进行单元测试变得更加困难，因为在调用 onAttach 时，您现在必须实现 FragmentHost 而不仅仅是调用 onAttach(new Activity()。

对于那些从事过分散交流活动的人，您认为哪种模式更可取，为什么？`onAttachFragment`从主机活动中使用有缺点吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T23:08:08.437

我不能亲自谈论测试，但片段/活动回调接口通信有替代方案。

例如，您可以使用事件总线来解耦片段和您的活动。可以在此处找到出色的事件总线：

[Otto - Square 的活动巴士](https://github.com/square/otto)

Square 的一些非常有才华的工程师正在积极开发它。您还可以使用打包在 Android 支持库中的 LocalBroadcastManager。

[本地广播管理器](http://developer.android.com/reference/android/support/v4/content/LocalBroadcastManager.html)

来自 Square 的 Eric Burke 有一个演示文稿，他提到了两者，可以在这里找到：

[Android 应用剖析](http://www.slideshare.net/burkeeric/android-app-anatomy)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-07-09T04:12:45.467

**更新**：根据最新指南，我们应该使用**sharedViewModel**类在片段和活动之间进行通信。

但是，如果您不使用 viewModel 并使用回调，您仍然应该**考虑删除 onAttachFragment 回调，因为它**现在已被弃用。

**而在 onAttachFragment 上，建议的方法是使用addFragmentOnAttachListener 向**与该事务关联的 fragmentManager 添加一个侦听器。

请参见下面的示例：

```
 childFragmentManager.addFragmentOnAttachListener { _, fragment ->
        if (fragment is RetryDialogFragment) {
           //Do your work here.
        }
    } 
```

您还应该注意添加此侦听器的位置。您很可能希望在执行片段事务之前添加此侦听器，并且应确保您不会多次添加侦听器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-20T21:04:31.117

我`Fragment.onAttach(...)`在上一个项目中使用了该模式。我看到两个优点：

1.  您可以尽早检查托管活动是否实现了所需的接口，如果没有则抛出异常
2.  分离片段后保留托管上下文引用的风险较小

为了利用 2.，您不能像在代码示例中那样存储对`UiModel`and的引用。`NavListener`相反，每当您想与这些实例进行交互时，您应该使用类似`((FragmentHost) getActivity).getNavListener().onNav(this)`或的代码`((FragmentHost) getActivity).onNav(this)`。如果您想避免持续转换，您可以将片段主机存储在您设置为 null 的字段中`onDetach(...)`作为中间方法。

我同意从创建它的活动中初始化一个片段似乎更直观。

说了这么多，我将在我当前的项目中完全跳过片段。以下帖子很好地反映了我从上一篇文章中吸取的教训：[https ://corner.squareup.com/2014/10/advocating-against-android-fragments.html](https://corner.squareup.com/2014/10/advocating-against-android-fragments.html)

# php - Preg_replace 没有正确替换

> ID：12900642
> 
> 赞同：4
> 
> 时间：2012-10-15T17:12:07.400
> 
> 标签：php, mysql, preg-replace

我正在处理我的一个项目，人们可以将一些 php 代码添加到我的数据库中。使用 SyntaxHighlighter 显示这些即时消息。我使用 preg_replace 来转义 pre 标记中的所有 < 括号。这是必需的，因此 syntaxhighlighter 可以正确呈现代码。它适用于php标签和东西..

这是我从数据库中呈现输入的代码：

```
 public function renderPre($input) // Function to escape html brackets within PRE tags. 
{
    $temp = preg_replace('/<pre>(.*?)<\/pre>/ise', "'<pre>' . htmlspecialchars('$1') . '</pre>'", $input);  
    return str_replace('<pre>', '<pre class=\'brush: php\'>', $temp);
} 
```

一旦括号被转义，我会在 pre 标签中添加一个类来激活荧光笔。

在我的数据库中，代码存储如下：

```
<pre><?php
foreach ($tutorial as $row)
{
    echo "<h1>".$row['title']."</h1>";
    echo $this->content_model->renderPre($row['intro']);
    echo $this->content_model->renderPre($row['body']);
}
?></pre> 
```

现在在我的实际页面上，从数据库中检索代码并显示在荧光笔中，这是输出：

```
<?php
foreach ($tutorial as $row)
{
    echo \"<h1>\".$row['title'].\"</h1>\";
    echo $this->content_model->renderPre($row['intro']);
    echo $this->content_model->renderPre($row['body']);
}
?> 
```

在 H1 标签所在的行，它添加了一些额外的斜杠 ( \ ) 我不知道为什么会这样。它必须与渲染函数中的 /ise 有关。

有谁知道如何解决这个问题？

谢谢！！

编辑 ：

从数据库中检索内容的代码：

```
 public function get_tutorial()
    {
        $sql = "Select
  tutorial.*,
  category.name,
  category.slug As slug1
From
  tutorial Inner Join
  category On tutorial.category_id = category.id
  WHERE tutorial.slug = '".$this->uri->segment(3)."'
  ";

  $query = $this->db->query($sql);
  return $query->result_array();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:31:12.210

尝试

```
public function renderPre($input) // Function to escape html brackets within PRE tags. 
{
    $input = htmlspecialchars_decode($input);
    $temp = preg_replace('/<pre>(.*?)<\/pre>/ise', "'<pre>' . htmlspecialchars('$1') . '</pre>'", $input);  
    return str_replace('<pre>', '<pre class=\'brush: php\'>', $temp);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:26:11.810

谢谢大家的回答。我通过在 renderpre 函数中添加 stripslashes 让它正常工作：

```
 public function renderPre($input) // Function to escape html brackets within PRE tags. 
{
    $temp = preg_replace('/<pre>(.*?)<\/pre>/ise', "'<pre>' . htmlspecialchars('$1') . '</pre>'", $input);  
    return str_replace('<pre>', '<pre class=\'brush: php\'>', stripslashes($temp));
} 
```

# c# - 在内存中存储部分共享字符串集合的最有效方法

> ID：12900644
> 
> 赞同：1
> 
> 时间：2012-10-15T17:12:14.130
> 
> 标签：c#, arrays, string, memory, recursion

我有一个递归 C# 应用程序，它遍历一棵树，并且只要最后一个节点等于 X，就需要维护链中所有节点的历史记录。

例如，我在下面搜索单词 MATCH

```
Root
 |
 |-Node1
 |   |-Sub1
 |   |-MATCH
 |
 |-Node2
 |   |-Node22
 |   |-Node33
 |   |   |-MATCH
 |   |-Node3
 |
 |-Node3
 |   |-Node88
     |-MATCH 
```

注意 Node3 是 Node2 的兄弟。我的目标是确定根与遇到 MATCH 的每条路径之间的父子关系。这意味着生成以下输出：

```
 Root -> Node1 -> MATCH
   Root -> Node2 -> Node33 -> MATCH
   Root -> Node2 -> Node3  -> MATCH
   Root -> Node3 -> MATCH 
```

进行编码的正确方法是什么？

我立即看到，任何跟踪深度或长路径的尝试都会导致大部分内存被用于跟踪没有价值的路径。唯一有价值的路径是上面列出的找到匹配项的路径

我的目标是在 Azure 表或 Blob 存储上实现这一点……每个 IO 查询每批 100 行，在层次结构中每个级别最多查询 20,000 行。

我敢肯定这已经完成了，但不知道它会叫什么..

**问题**

我应该如何引用内存中的字符串，以便它们消耗最少的 RAM？

**示例答案：**

使用带有 ref 参数的结构...或...

```
Struct MyMemoryData
{
    public string PreviousNode {get;set;}
    public string NodeName {get;set;}
}

void MyRecursion(MyMemoryData searchStack, List<string> nodesToQuery)
{
    foreach(var str in nodesToQuery)
    {
        var newToDoList = GetChildNodes(str);

        searchStack.PreviousNode = searchStack.CurentNode;
        searchStack.CurrentNode = str;
        MyRecursion(searchStack, newToDoList);
    }
} 
```

或将 ref 保存到结构

```
 Struct MyMemoryData
    {
        public MyMemoryData PreviousNode {get;set;}  // this line was changed: Type is MyMemoryData
        public string NodeName {get;set;}
    }

    void MyRecursion(MyMemoryData searchStack, List<string> nodesToQuery)
    {
        foreach(var str in nodesToQuery)
        {
            var newToDoList = GetChildNodes(str);

            searchStack.PreviousNode = searchStack;  // this line was changed: Saving the object instead of the value
            searchStack.CurrentNode = str;
            MyRecursion(searchStack, newToDoList);
        }
    } 
```

或者只是将其全部保存在这样的列表中：

```
void MyRecursion(List<string> searchStack, List<string> nodesToQuery)
{
    foreach(var str in nodesToQuery)
    {
        var newToDoList = GetChildNodes(str);

        searchStack.Add(str);
        MyRecursion(searchStack, newToDoList);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:44:42.320

你打算有多少级别？栈的大小应该受树的深度影响，而不是每一层的项目数。

```
void MyRecursion(Stack<string> searchStack, List<string> nodesToQuery)
{
    foreach(var str in nodesToQuery)
    {
        var newToDoList = GetChildNodes(str);

        searchStack.Push(str);
        MyRecursion(searchStack, newToDoList);
        searchStack.Pop(); // make sure to get pop off the current once you are no longer on this level
    }
} 
```

编辑：老实说，我认为您可能需要考虑一种迭代方法。您的大部分内存将`newToDoList`存储在每个递归级别。如果您可以按顺序遍历树（想想`XmlReader`哪个是向前的）并以这种方式维护堆栈，那么您可能会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T18:55:27.760

听起来您正在寻找一种地图缩减算法。

其他人提到[MapReduce](http://en.wikipedia.org/wiki/MapReduce)是一种潜在的选择。有些人已经在 Azure 中使用它。

那里有许多文章/算法，例如[此链接](http://www.ccs.neu.edu/home/rjw/csu390-f06/HowTo/How-to-Create-Mapping-Reductions.pdf)，可以帮助您制作自己的文章/算法。

# jquery - jquery - 将 ID 引用更改为数值

> ID：12900649
> 
> 赞同：0
> 
> 时间：2012-10-15T17:12:34.847
> 
> 标签：jquery, html

我正在使用 HTML 5 和 jquery v1.8.2 来触发一个事件，当您到达文章页面的末尾时弹出一个项目。虽然效果很好，但我想看看是否可以用数字调用（像素/百分比）替换可触发的 id (#last) 事件。

此代码旨在用于文章页面。当您接近文章结尾时，会弹出一个模式。目前，也让模态框弹出，它正在查找 id (#last) 的高度并根据 id 为 #last 的元素的高度进行弹出。我要做的就是：不要使用 id 来触发事件，而是使用数值。例如，当页面从顶部滚动 66% 时，触发弹出模式事件。

这是代码：

```
$(function() {
$(window).scroll(function(){
var distanceTop = $('#last').offset().top - $(window).height();
if  ($(window).scrollTop() > distanceTop)
$('#toolbar-btm-button').fadeIn('slow').animate({bottom: '0'},"slow");
else 
$('#toolbar-btm-button').animate({bottom: '-44px'},"fast");    
});
}); 
```

我尝试用像素和百分比值替换#last，但它似乎无法正常工作。这是我尝试过的，但没有奏效：

```
$(function() {
$(window).scroll(function(){
var distanceTop = $('66%').offset().top - $(window).height();
if  ($(window).scrollTop() > distanceTop)
$('#toolbar-btm-button').fadeIn('slow').animate({bottom: '0'},"slow");
else 
$('#toolbar-btm-button').animate({bottom: '-44px'},"fast");    
});
}); 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:21:53.223

尝试这样的事情：

```
$(function() {
    $(window).scroll(function() {
        var distanceTop = $('body').height() - $(window).height();
        if ($(window).scrollTop() > (distanceTop * 0.6)) {
            $('#toolbar-btm-button').fadeIn('slow').animate({
                bottom: '0'
            }, "slow");
        } else {
            $('#toolbar-btm-button').animate({
                bottom: '-44px'
            }, "fast");
        }
    });
});​ 
```

# eclipse - 安装 Ecore 工具 SDK 时遇到问题

> ID：12900653
> 
> 赞同：1
> 
> 时间：2012-10-15T17:12:48.740
> 
> 标签：eclipse, eclipse-emf, eclipse-emf-ecore, emf

我正在使用 Eclipse Juno EE，但无法安装 Ecore Tools SDK。我已经尝试了一切，到处搜索，我找不到解决方案。我尝试通过安装新软件管理器，市场，我什至下载了存档文件（当我尝试使用来自站点的存档安装它时，它告诉我没有找到任何软件）。在搜索时，我发现了那篇文章： http: [//www.eclipse.org/forums/index.php/t/354109/](http://www.eclipse.org/forums/index.php/t/354109/)这个家伙“Cedric Brun”提供了一个安装链接（[http://download.eclipse.org /modeling/emft/ecoretools/updates/1.1/201205140421](http://download.eclipse.org/modeling/emft/ecoretools/updates/1.1/201205140421)）。我尝试了链接，安装了 SDK（至少我是这么认为的），但是现在当我单击新建时...没有带有选项的 Ecore Tools 文件夹，我无法创建 Ecore Diagrams。有人有解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T18:50:13.300

由于我正在运行 Eclipse 建模包，它已经安装，但检查更新站点“Juno - [http://download.eclipse.org/releases/juno](http://download.eclipse.org/releases/juno) ”会显示“建模”类别下的“Ecore Tools SDK” .

您是否尝试过从该仓库安装？ [http://download.eclipse.org/releases/juno](http://download.eclipse.org/releases/juno)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-10T23:18:08.120

要安装 Ecore Tool，请转到帮助 -> 安装新软件并使用以下链接之一：

*   对于日食火星[http://download.eclipse.org/ecoretools/updates/releases/3.0.1/mars](http://download.eclipse.org/ecoretools/updates/releases/3.0.1/mars)
*   对于旧版本 [http://download.eclipse.org/modeling/emft/ecoretools/updates/1.2/201306071421](http://download.eclipse.org/modeling/emft/ecoretools/updates/1.2/201306071421)

请注意，安装后可以通过以下方式制作新的生态图：

*   File->New->Other...Ecore Tool->Ecore Diagram
*   File->New->Other...Other->Ecore Diagram
*   通过上下文菜单 - 右键单击​​ .ecore 文件并选择 Initialize Ecore Diagram...

你也可以去 Help->Install New Software... 选择你的 Eclipse 发布站点并在 Modeling 下检查 Ecore 的 Diagram Editor (SDK) 你可能需要 Eclipse Modeling Framework SDK。

# python - Google App Engine 后端 Python

> ID：12900655
> 
> 赞同：3
> 
> 时间：2012-10-15T17:12:59.857
> 
> 标签：python, google-app-engine, backend

我在让后端在 Google App Engine Python 中运行时遇到问题。

在我的 app.yaml 中，我添加了这个处理程序：

```
- url: /backend/.*
  script: backend.app
  login: admin 
```

在 backend.app 中，我为“/”定义了一个处理程序。

我的 backends.yaml 看起来像这样：

```
backends:
- name: dbops
  options: dynamic 
```

在我的前端应用程序中，我添加了一个任务队列来调用后端：

```
taskqueue.add(url='/backend/', target='dbops') 
```

当我查看日志时，我看到的只是 404 错误，并且后端没有显示在后端部分下，但是如果我在实例下查看，则会启动一个新实例。任何人都得到了任何指导，因为后端的文档并不是很有帮助。

**编辑**

在下面 Alex 的帮助下，我已经在后端运行了代码。我错过了部署到后端的步骤。

```
appcfg.py backends ./ update dbops 
```

现在我在管理界面中看到后端实例运行良好，但任务队列不断返回 404 错误，我确定我做错了什么愚蠢的错误。

我在我的 backend.py 中配置处理程序是否与我在我的 frontend.py 中配置的一样？我可以访问后端实例的 frontend.py 中定义的处理程序，但不能访问 backend.py 中定义的处理程序。

**2012 年 10 月 17 日**编辑****

 **经过一番挖掘，我发现我的通配符处理程序在我的后端处理程序之前列在 apps.yaml 中。所以现在后端处理程序有点工作。我将此进程定义为管理员处理程序，但它仍然超时。

为什么这不起作用？它总是返回 405 错误并不断重试。

taskqueue.add(url='/backend/', target='dbops')

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T17:57:28.347

`/backend`永远不会匹配`/backend/.*`模式。您应该在末尾添加一个斜杠：

```
taskqueue.add(url='/backend/', target='dbops') 
```

此外，在您的后端，您可能应该做同样的事情并在`/backend/`.**

# python - Python PIL 错误地解码 TIFF 颜色（使用不正确的颜色空间）？

> ID：12900656
> 
> 赞同：14
> 
> 时间：2012-10-15T17:13:00.623
> 
> 标签：python, python-imaging-library, tiff

当我`PIL==1.1.7`用来加载 TIFF 图像时，它似乎弄错了色彩空间：

![错误的色彩空间转换](../Images/a4c776d83ed54ef2ce2888e083ad6c4c.png)

这是怎么回事？

*   `.tiff`是使用创建的`convert test.jpg test.tiff`（但似乎也发生在其他 tiff 文件中）
*   可在以下网址找到： http: [//hul.wolever.net/dump/test.tiff](http://hul.wolever.net/dump/test.tiff)
*   时的输出`PIL.Image.DEBUG = True`：

```
>>> 从 PIL 导入图像
>>> Image.DEBUG = True
>>> Image.open("/tmp/test.tiff").show()
标签：ImageWidth（256）-类型：短（3）-值：（560，）
标签：ImageLength（257）-类型：短（3）-值：（401，）
标签：BitsPerSample (258) - 类型：短 (3) - 值：(8, 8, 8)
标签：压缩（259）-类型：短（3）-值：（7，）
标签：PhotometricInterpretation（262）-类型：短（3）-值：（2，）
标签：FillOrder (266) - 类型：短 (3) - 值：(1,)
标签：DocumentName (269) - 类型：ascii (2) - 值：/tmp/lemur.tiff
标签：StripOffsets (273) - 类型：long (4) - 值：(8, 9282, 18712, 28312, 38000, 48730, 59052, 70406, 83010, 95978, 108967, 121029, 133136, 1455555, 1574179, 15741943, , 191157, 202954, 214664, 226914, 238919, 250547, 261871, 273282, 284453)
标签：方向（274）-类型：短（3）-值：（1，）
标签：SamplesPerPixel（277）-类型：短（3）-值：（3，）
标签：RowsPerStrip（278）-类型：短（3）-值：（16，）
标签：StripByteCounts (279) - 类型：long (4) - 值：(9274, 9430, 9600, 9688, 10730, 10322, 11354, 12604, 12968, 12989, 12062, 12107, 12419, 11856, 10878, 1178, 11742 , 11797, 11710, 12250, 12005, 11628, 11324, 11411, 11171, 2541)
标签：XResolution (282) - 类型：有理数 (5) - 值：((1207959552, 16777216),)
标签：YResolution (283) - 类型：理性 (5) - 值：((1207959552, 16777216),)
标签：PlanarConfiguration（284）-类型：短（3）-值：（1，）
标签：ResolutionUnit（296）-类型：短（3）-值：（1，）
标签：PageNumber (297) - 类型：短 (3) - 值：(0, 1)
标签：JPEGTables（347）-类型：未定义（7）-值：????C??

???}!1AQa"q2??#B??R??$3br?  
%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz??????????????????????????????????????????? ????????????????????????????????????
标签：YCbCrSubSampling (530) - 类型：短 (3) - 值：(2, 2)
*** 概括 ***
- 压缩：JPEG
- photometric_interpretation：2
- 平面配置：1
- 填充订单：1
- 尺寸：（560、401）
格式键：('II', 2, 1, 1, (8, 8, 8), ())
- 原始模式：RGB
- pil模式：RGB

```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-18T05:15:59.953

这很可能是因为您的 TIFF 图像包含由 Adob​​e Photoshop 生成的压缩 JPEG 数据，该数据使用特殊标记来指示正确的色彩空间。我猜 PIL 不知道这个标记（至少在嵌入 TIFF 的 JPEG 中），所以它假设图像在 YCbCr 颜色空间中（我们可以在屏幕截图中看到）。

[请参阅此处](https://stackoverflow.com/questions/8747904/extract-jpeg-from-tiff-file)的详细答案，我相信这正是您的情况。

您可能的解决方案是使用其他方法（没有压缩的 JPEG 数据）转换您的 JPEG。例如，如果 PIL 能够正确打开您的 JPEG，您可以使用 PIL 重写 TIFF：

```
from PIL import Image
img = Image.open("test.jpg")
tif = Image.new("RGB", img.size)
tif.paste(img)
tif.save('result.tiff') 
```

# sql - 如何在递归查询中获取项目的级别和计数

> ID：12900658
> 
> 赞同：1
> 
> 时间：2012-10-15T17:13:05.603
> 
> 标签：sql, sql-server, sql-server-2008

```
WITH cte(folder_id, parent_id, folder_name)
AS
(
    select folder.folder_id, folder.parent_id, folder.folder_name
    FROM Folder_Table [folder] 
        JOIN File_Table [file] on [folder].[folder_id] = [file].[folder_id]
    union all
    select Folder_Table.folder_id,Folder_Table.parent_id,Folder_Table.folder_name
    from cte 
        join Folder_Table on cte.parent_id = Folder_Table.folder_id
)
SELECT distinct * FROM cte 
```

在这个查询中，如果有孩子，我需要获取项目的级别和该级别的孩子的数量

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:23:12.290

获取`Level`很容易：

```
WITH cte(folder_id, parent_id, folder_name, level)
AS
(
    SELECT
       folder.folder_id, folder.parent_id, folder.folder_name, Level = 0
    FROM 
       Folder_Table [folder] 
    INNER JOIN 
       File_Table [file] on [folder].[folder_id] = [file].[folder_id]

    UNION ALL

    SELECT 
       Folder_Table.folder_id, Folder_Table.parent_id, Folder_Table.folder_name, CTE.Level + 1
    FROM
       cte 
    INNER JOIN 
       Folder_Table on cte.parent_id = Folder_Table.folder_id
)
SELECT DISTINCT * FROM cte 
```

但是计算孩子的数量相当棘手——你几乎必须“预览”任何给定级别的下一个级别；我想不出任何简单的方法来做到这一点，对不起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T23:16:08.180

我假设您只想在文件夹中有文件时才包括孩子的数量。另外，我假设最顶层的文件夹将具有与 parent_id 相同的 folder_id。

```
WITH cte (folder_id, parent_id, folder_name) AS
(
   SELECT folder.folder_id, folder.parent_id, folder.folder_name
   FROM Folder_Table [folder] JOIN File_Table [file] ON [folder].[folder_id] = [file].[folder_id]
   WHERE [folder].parent_id = [folder].folder_id
   UNION ALL
   SELECT folder.folder_id, folder.parent_id, folder.folder_name
   FROM cte JOIN Folder_Table [folder] ON cte.folder_id = folder.parent_id
   WHERE folder.parent_id != folder.folder_id
)
SELECT parent_id, COUNT(1) as [Number of children]
 FROM cte
WHERE folder_id != parent_id
GROUP BY parent_id 
```

请注意，当该文件夹中没有文件时，查询不会返回父文件夹，但是通过在 Folder_Table 和 File_Table 之间的连接中使用 LEFT OUTER JOIN 来更改这一点相当容易

要获取级别，它将与上面的查询非常相似：

```
WITH cte (folder_id, parent_id, folder_name, level) AS
(
   SELECT folder.folder_id, folder.parent_id, folder.folder_name, 0
   FROM Folder_Table [folder] JOIN File_Table [file] ON [folder].[folder_id] = [file].[folder_id]
   WHERE [folder].parent_id = [folder].folder_id
   UNION ALL
   SELECT folder.folder_id, folder.parent_id, folder.folder_name, level+1
   FROM cte JOIN Folder_Table [folder] ON cte.folder_id = folder.parent_id
   WHERE folder.parent_id != folder.folder_id
)
SELECT * FROM cte 
```

# c# - 是否可以通过 jQuery Ajax 将 ObjectDataSource 传递给 Web 方法？

> ID：12900661
> 
> 赞同：0
> 
> 时间：2012-10-15T17:13:27.820
> 
> 标签：c#, asp.net, web-services, objectdatasource

是否可以`ObjectDataSource`通过 jquery ajax 将一个传递给 Web 方法？

jQuery 阿贾克斯：

```
jQuery.ajax(
{
    type: "POST",
    url: '<%= ResolveUrl("~/Webservices/LoadActivities.asmx/LoadMoreData") %>',
    //data: data,
    data: '{"ObjectDataSource1":' + JSON.stringify(jQuery('<%= ObjectDataSource1.ClientID %>')) + '}',
    contentType: "application/json; charset=utf-8",
    dataType: "json",

}); 
```

对象数据源：

```
 <asp:ObjectDataSource ID="ObjectDataSource1" runat="server" SelectMethod="GetActivities" TypeName="MyMethodLocation" >
            <SelectParameters>
                <asp:Parameter Name="top" DefaultValue="10" Type="Int32" />
            </SelectParameters>
        </asp:ObjectDataSource> 
```

网络方法：（LoadActivities.asmx）

```
[System.Web.Script.Services.ScriptService]
public class LoadActivities : System.Web.Services.WebService
{

    [WebMethod]
    public void LoadMoreData(ObjectDataSource ObjectDataSource1) 
    {
        // MANIPULATE OBJECT DATA SOURCE
    }
} 
```

如果我没有正确传递对象，则在执行 Web 方法时会显示“对象引用未设置为对象的实例”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T10:58:54.033

我不禁认为像这样操作 ObjectDataSource 控件很糟糕。

如果我是对的，您希望在页面上没有完整回发的情况下删除或提高数据源的上限。

在这种情况下，您应该使用 ObjectDataSource 的内置功能（例如，使用 ControlParameter 根据控件值设置上限值或在 OnSelecting 事件上设置上限值）结合另一种方式来刷新数据（例如用 UpdatePanel 包围 gridview 并在回调中调用 DataBind 方法）。

# gridview - 网格视图中的滚动条

> ID：12900665
> 
> 赞同：0
> 
> 时间：2012-10-15T17:13:54.960
> 
> 标签：gridview

我`overflow:scroll;`用来创建一个网格视图的滚动条。但是，这会在右侧创建滚动条。是否可以在 gridview 的左侧创建滚动条？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T00:23:05.633

从 ASP.NET 论坛试试[这个](http://forums.asp.net/post/2365564.aspx)，有方向属性要设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-18T09:52:54.673

[Total GridView 的惊人链接](http://msdn.microsoft.com/en-us/library/vstudio/ms228113%28v=vs.90%29.aspx)

# php - 客户端和服务器端验证 - PHP 和 JavaScript

> ID：12900668
> 
> 赞同：0
> 
> 时间：2012-10-15T17:13:58.760
> 
> 标签：php, javascript, forms, validation

> **可能重复：**
> [JavaScript：客户端与服务器端验证](https://stackoverflow.com/questions/162159/javascript-client-side-vs-server-side-validation)

我是 PHP Web 应用程序开发的初学者。我最近开发了一个用于 Intranet 的 Web 应用程序，大约有**25 个**用户在使用该系统。系统中的所有 HTML 表单都使用 JavaScript 和 jQuery 库进行验证，并且客户端机器支持 JavaScript。是否需要再次验证服务器上的每个表单，还是 JavaScript 验证就足够了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:16:45.037

简单来说，JS 验证是*不够*的。用户可以很容易地在其客户端上禁用 JS，并绕过您的验证。即使您使用 AJAX 提交用户数据（因此需要启用 JS），聪明的用户也可以轻松地向您的服务器构建自己的 HTTP 请求，再次绕过您的验证。

为此，如果您想完全确保输入系统的所有数据都经过验证，则必须在服务器上完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:15:13.150

由于可以关闭 Javascript，因此从逻辑上可以得出客户端不可信。因此，您将不得不在服务器端再次验证。

对于这样的问题要记住的基本规则：

> 客户端安全不是。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T17:15:48.690

Javascript 验证是不够的。使用 curl 等软件绕过客户端 JS 验证以生成您自己的 HTTP POST 请求是微不足道的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T17:15:49.780

我想这取决于提交的数据会发生什么，但我认为出于安全原因在服务器端验证输入始终是一个好习惯。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-16T12:30:48.030

试试这个，最好最简单。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
 <script src="http://code.jquery.com/jquery-latest.js"></script>
  <script type="text/javascript" src="http://jzaefferer.github.com/jquery-validation/jquery.validate.js"></script>
<style type="text/css">
* { font-family: Verdana; font-size: 96%; }
label { width: 10em; float: left; }
label.error { float: none; color: red; padding-left: .5em; vertical-align: top; }
p { clear: both; }
.submit { margin-left: 12em; }
em { font-weight: bold; padding-right: 1em; vertical-align: top; }
</style>
 <script>
  $(document).ready(function(){
  $("#commentForm").validate();
  });
  </script>

</head>
<body>

 <form class="cmxform" id="commentForm" method="get" action="">
 <fieldset>
   <legend>A simple comment form with submit validation and default messages</legend>
  <p>
 <label for="cname">Name</label>
 <em>*</em><input id="cname" name="name" size="25" class="required" minlength="2" />
  </p>
  <p>
    <label for="cemail">E-Mail</label>
  <em>*</em><input id="cemail" name="email" size="25"  class="required email" />
  </p>
  <p>
 <label for="curl">URL</label>
 <em>  </em><input id="curl" name="url" size="25"  class="url" value="" />
  </p>
  <p>
    <label for="ccomment">Your comment</label>
    <em>*</em><textarea id="ccomment" name="comment" cols="22"  class="required">      </textarea>
  </p>
   <p>
    <input class="submit" type="submit" value="Submit"/>
   </p>
 </fieldset>
 </form>
 </body>
 </html> 
```

编码快乐！！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-15T17:16:03.610

是的，您应该验证服务器端的所有数据。Javascript 验证是不可信的。

# php - 如何使用 Dropbox 作为使用 PHP 上传文件的主机？

> ID：12900675
> 
> 赞同：0
> 
> 时间：2012-10-15T17:14:41.263
> 
> 标签：php, hosting, dropbox

所以我正在一个带有一些简单管理区域的小型网站上工作。在管理区域，应该可以上传/下载/更新全局目录的文件。问题是我的 php 程序没有对服务器的写权限，并且数据库的大小限制为 100mb，这还不够。因此，我认为将文件存储在专用的 Dropbox 帐户或其他东西中会很好。

我的问题是：

*   用 PHP 为这个 Dropbox 帐户编写一个 Web 界面会相当容易吗？
*   为此目的，是否有 Dropbox 的替代品？
*   任何其他想法如何处理这种情况？

编辑：我对 Dropbox 的问题是它的 API 使用 OAuth。但是由于我想为所有用户而不是每个用户帐户连接到一个全局帐户，这似乎不合适，我什至不知道是否可以通过这种方式进行身份验证。提到的所有链接都使用此 API，因此需要通过重定向进行用户身份验证。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:19:20.260

是的，您可以使用保管箱帐户。试试[PhpDropboxUploader](http://wiki.dropbox.com/DropboxAddons/PHPDropboxUploader)。它也在[Dropbox Wiki中提到](http://www.dropboxwiki.com/PHP_Dropbox_Uploader)

```
require 'DropboxUploader.php';

$uploader = new DropboxUploader('email.address.used.to.log.in.to.dropbox@example.com', 'dropbox-password');
$uploader->upload('file-to-be-uploaded', 'destination-folder-in-dropbox'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:19:08.093

对于您的第一个问题，确实有一个 PHP SDK 不是官方的，但仍列在 Dropbox 网站上： [https](https://www.dropbox.com/developers/reference/sdk) ://www.dropbox.com/developers/reference/sdk 和 [https://github.com/BenTheDesigner/Dropbox](https://github.com/BenTheDesigner/Dropbox)

顺便说一句，你确定你不能创建一个 PHP 有写权限的目录吗？

# mysql - 基础数据库设计场景

> ID：12900677
> 
> 赞同：0
> 
> 时间：2012-10-15T17:14:51.303
> 
> 标签：mysql, sql, database, database-design

**问题定义：**公司希望通过提出一些问题来衡量客户对其产品的满意度。公司的产品数据存储在“产品”表中，每个产品商店的客户数据存储在“客户”表中，每个产品商店的问题存储在问题表中。如下所示：

> 产品：[id，名称]
> 
> 客户：[ id, product_id(fk), name ]
> 
> 问题：[ id, product_id(fk), text ]

问题是，考虑到每个客户只能回答其产品的问题，我们如何设计一个表格来存储每个客户的答案。例如，如果您的答案是这样的：

> customer_answer:[ id, customer_id(fk), question_id(fk), answer]

那么它是错误的，因为如果我们的表的样本数据如下所示：

> 产品： [ 1, "椅子" ], [ 2, "桌子" ]
> 
> 客户：[1、1、“安东尼·奎恩”]、[2、2、“玛丽莲·梦露”]
> 
> 问题：[ 1, 1，“对这个产品有什么建议吗？” ], [ 2, 1, “你觉得这把椅子怎么样？” ]

那么**可能会有**一个包含以下数据的行：

> customer_answer: [ 1, 2, 1, '不，谢谢' ]

这是错误的，因为 id #2 的客户没有 product_id #1，所以它可能是这个问题的错误表。

在这种情况下我们能做什么？

没关系，但顺便说一句，我正在使用 mysql 来解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:20:34.320

您应该在 customer_answer 表中定义 customer_id 和 product_id 的外键约束，并引用 customer 表中的 id 和 product_id 列，以强制仅存储客户问题的答案。

```
CREATE TABLE customer_answer
(
    id  INT,
    customer_id INT,
    product_id INT, 
    answer VARCHAR(128),
)
ALTER TABLE customer_answer
ADD CONSTRAINT FK_Customer_Answer_To_Customer FOREIGN KEY (customer_id, product_id) REFERENCES customer(id, product_id) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T17:31:12.557

这是代理键损害而不是帮助您的数据库设计的情况。此外，您可能应该有一个单独的客户表来唯一地列出客户。

这是一个快速设计，它从表中删除代理键，其中代理键的存在使得执行参照完整性变得更加困难。关键的变化是 CustomerProducts（我已将您的 Customers 表重命名）现在使用 CustomerID、ProductID 作为 PRIMARY KEY，从而可以强制执行答案和拥有的产品之间关系的完整性。

```
 Products:         ProductID, Name 
                       (PK = ProductID)
 Customers:        CustomerID, Name 
                       (PK = CustomerID)
 CustomerProducts: CustomerID, ProductID 
                       (PK = CustomerID, ProductID)
                       (FK = CustomerID REFERENCES Customers)
                       (FK = ProductID  REFERENCES Products)
 Questions:        ProductID, QuestionText 
                       (PK = ProductID, QuestionText)
                       (FK = ProductID REFERENCES Products)
 Answers:   CustomerID, ProductID, QuestionText 
                       (FK CustomerID, ProductID REFERENCES CustomerProducts)
                       (FK ProductID, QuestionText REFERENCES Questions) 
```

注意：如果您对使用大的 VARCHAR 字段 QuestionText 作为问题 PK 和答案 FK 的一部分感到不舒服（特别是因为内容可能会改变），您可以在此处重新引入代理键，或者更好地添加一列 QuestionNo 到在单个产品中提供问题排序；然后将 ProductID, QuestionNo 设为主键和外键。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T17:37:09.597

注 2`CustomerQuestion`表中的 FK：FK1`{CustomerID, ProductID}`和 FK2`{ProductID, QuestionID}`

![在此处输入图像描述](../Images/feb6417913648e0ba4136aa471939b8e.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T17:21:30.233

我认为这应该是应用程序数据层（例如 MVC 架构中的模型）的工作，在插入数据之前进行必要的检查。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T17:30:37.790

或者，您可以尝试在插入“customer_answer”时编写 MySQL 触发器，该触发器将检查您尝试添加的新组合（产品 ID 和客户 ID）是否存在于客户表中，如果是，则继续，如果不是你可以恢复的。

# java - Mongo Spring Data“外”键

> ID：12900680
> 
> 赞同：0
> 
> 时间：2012-10-15T17:14:54.710
> 
> 标签：java, json, spring, mongodb

我正在使用[Spring Data](http://www.springsource.org/spring-data/mongodb)来管理我的 MongoDB 数据库。

在一个集合中，我有 2 个 ObjectId 字段，_id 和另一个引用另一个集合中的实例的字段。

我的收藏类是这样的：

```
public class CollectionA
{
private ObjectId id;
private String collectionADescription
private ObjectId collectionBId
} 
```

使用这样指定的类，我可以成功地将“外键”作为 $oid 插入。

问题是我收到以下绑定错误：

> 字段“collectionBId”上的对象“collectionA”中的字段错误：拒绝值 []；代码 [typeMismatch.collectionA.collectionBId,typeMismatch.collectionBId,typeMismatch.org.bson.types.ObjectId,typeMismatch]; 参数 [org.springframework.context.support.DefaultMessageSourceResolvable：代码 [collectionA.collectionBId，collectionBId]；论据 []; 默认消息 [collectionBId]]；默认消息 [无法将类型“java.lang.String”的属性值转换为属性“collectionBId”所需的类型“org.bson.types.ObjectId”；嵌套异常是 java.lang.IllegalStateException：无法将类型 [java.lang.String] 的值转换为属性“collectionBId”所需的类型 [org.bson.types.ObjectId]：找不到匹配的编辑器或转换策略]

如果我将 collectionBId 变量设置为 String 变量将作为字符串插入而不是 $oid

我怎样才能做到这一点？

比

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-27T13:20:08.113

如果你真的想要数据存储中的关系，你应该使用 Spring Data MongoDB [@DBRef](http://static.springsource.org/spring-data/data-mongodb/docs/current/reference/html/mapping-chapter.html#mapping-usage-references)注释。但我建议您重新考虑/重新设计您的架构，以支持使用嵌入式文档。也许[这个](http://docs.mongodb.org/manual/core/data-modeling/)文档会帮助你设计更好的模式。

# jquery - JQuery 自动完成不会绑定到 document.ready 中的元素

> ID：12900694
> 
> 赞同：0
> 
> 时间：2012-10-15T17:15:55.443
> 
> 标签：jquery, jquery-ui, jquery-ui-autocomplete

我有一系列在服务器端生成的文本框。他们的 id 以一个可区分的数字结尾，如下所示：

ictContractNumber_0、ictContractNumber_1 等

当页面加载时，我想让这些文本框自动完成框，所以我在文档中使用以下代码准备好：

```
$('[id^="ictContractNumber_"]').autocomplete({
    source: function(request, response){
      GetContract(request.term, response);
    }
}); 
```

我遇到的问题是页面加载时它不起作用。我在文档中的所有其他代码都准备好了，所以我知道它正在运行，它只是不起作用。

奇怪的是，我可以在 Firebug 控制台中手动运行这段代码，然后它就可以正常工作了！

我难住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:03:20.620

好吧，我让它工作了。我不认为这是一个真正的解决方案，但它是一种解决方法。我只是使用类而不是 id 来选择元素并且有效。这是工作代码：

```
$('.ibaContractSearch').autocomplete({
  source: function(request, response){
    GetContract(request.term, response);
  }
}); 
```

# java - 异步调用如何获取JNI接口指针（JNIEnv *）

> ID：12900695
> 
> 赞同：80
> 
> 时间：2012-10-15T17:15:57.330
> 
> 标签：java, c, multithreading, java-native-interface

我了解到JNI接口指针（JNIEnv *）只在当前线程中有效。假设我在本机方法中启动了一个新线程；它如何将事件异步发送到 Java 方法？因为这个新线程不能引用（JNIEnv *）。为 (JNIEnv *) 存储全局变量显然不起作用？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-10-15T17:35:48.250

您可以使用 获取指向 JVM( `JavaVM*`)的指针[`JNIEnv->GetJavaVM`](http://docs.oracle.com/javase/1.5.0/docs/guide/jni/spec/functions.html#wp23168)。您可以安全地将该指针存储为全局变量。[`AttachCurrentThread`](http://docs.oracle.com/javase/1.5.0/docs/guide/jni/spec/invocation.html#attach_current_thread)稍后，在新线程中，如果您在 C/C++ 中创建新线程，或者只是在 java 代码中创建线程，您可以使用将新线程附加到 JVM [`GetEnv`](http://docs.oracle.com/javase/1.5.0/docs/guide/jni/spec/invocation.html#GetEnv)，我不认为这是因为 JNI 会传递给您一个`JNIEnv*`then 和你不会有这个问题。

```
 // JNIEnv* env; (initialized somewhere else)
    JavaVM* jvm;
    env->GetJavaVM(&jvm);
    // now you can store jvm somewhere

    // in the new thread:
    JNIEnv* myNewEnv;
    JavaVMAttachArgs args;
    args.version = JNI_VERSION_1_6; // choose your JNI version
    args.name = NULL; // you might want to give the java thread a name
    args.group = NULL; // you might want to assign the java thread to a ThreadGroup
    jvm->AttachCurrentThread((void**)&myNewEnv, &args);
    // And now you can use myNewEnv 
```

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2012-10-15T17:47:39.157

在使用 JNI 从 Java 到 C++ 的同步调用中，“环境”已经由 JVM 设置，但是从任意 C++ 线程向另一个方向前进，它可能还没有

因此，您需要按照以下步骤操作

*   使用获取 JVM 环境上下文`GetEnv`
*   如有必要，使用附加上下文`AttachCurrentThread`
*   使用正常调用该方法`CallVoidMethod`
*   使用分离`DetachCurrentThread`

完整的例子。注意我过去在我的[博客上更详细地写过这个](http://www.adamish.com/blog/archives/327)

```
JavaVM* g_vm;
env->GetJavaVM(&g_vm);

void callback(int val) {
    JNIEnv * g_env;
    // double check it's all ok
    int getEnvStat = g_vm->GetEnv((void **)&g_env, JNI_VERSION_1_6);
    if (getEnvStat == JNI_EDETACHED) {
        std::cout << "GetEnv: not attached" << std::endl;
        if (g_vm->AttachCurrentThread((void **) &g_env, NULL) != 0) {
            std::cout << "Failed to attach" << std::endl;
        }
    } else if (getEnvStat == JNI_OK) {
        //
    } else if (getEnvStat == JNI_EVERSION) {
        std::cout << "GetEnv: version not supported" << std::endl;
    }

    g_env->CallVoidMethod(g_obj, g_mid, val);

    if (g_env->ExceptionCheck()) {
        g_env->ExceptionDescribe();
    }

    g_vm->DetachCurrentThread();
} 
```

# c++ - 使用 C++ 从 MJPEG 流中捕获视频

> ID：12900696
> 
> 赞同：5
> 
> 时间：2012-10-15T17:15:58.350
> 
> 标签：c++, c, opencv, ffmpeg, mjpeg

我想使用 C++ 捕获 MJPEG 流。我有哪些选择？我已经尝试过支持 FFMPEG 的 OpenCV，但 icvCreateFileCapture_FFMPEG_p 总是返回 null（超时几秒钟后）。我可以自己编写一个 HTTP 客户端吗？

问候，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T17:19:26.953

M-JPEG 很容易捕捉。您向服务器发送一个 HTTP 请求并以`multipart/x-mixed-replace`格式 (Content-Type) 读回无限响应。然后将其拆分为帧，这些帧是自包含的 JPEG 文件……子标题可能包含也可能不包含其他信息，例如时间戳。

您可能会发现这也是相关且有用的：[如何在 C++ 中解析 MJPEG HTTP 流？](https://stackoverflow.com/questions/4801933/how-to-parse-mjpeg-http-stream-within-c)

# jquery - Yii：CJuiDatePicker 字段值未使用 JS 设置为 null

> ID：12900707
> 
> 赞同：0
> 
> 时间：2012-10-15T17:16:38.743
> 
> 标签：jquery, yii

我正在使用 CJuiDatePicker 输入字段作为日期值。用户输入后，我需要将其设置为空白。我在我的 JS 例程中使用了以下所有选项，但似乎没有任何效果。奇怪的是我可以从日期字段中选择值但不能将其设置为空白。我无法隐藏它，因为后续输入需要日期字段。

```
$('#dateFieldId').val('');
$('#dateFieldId').val("");
$('#dateFieldId').val(null);
$('#dateFieldId').val()=null; 
```

以下是我生成 CJuiDatePicker 的代码片段：

```
$this->widget('zii.widgets.jui.CJuiDatePicker', array(
'model'=>$model,
'attribute'=>'history_date',
'options'=>array('changeMonth'=>'true','changeYear'=>'true','yearRange'=>'-70:+0'),             
)); 
```

有小费吗....？

提前致谢。

问候

费萨尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T23:40:00.477

正如您在评论中提到的，您正在动态添加元素。jQuery 事件处理程序（例如`.change()`）不会附加到动态添加的事件。

您需要使用[on() 和委托事件](http://api.jquery.com/on/)。在页面上选择一个永久元素 -`$('body')`通常应该可以工作，但性能方面，最好选择更下方的东西，也许是表单周围的包装器？

对于您的输入项，您需要以下内容：

```
$('<parentSelector>').on('change', '#calendarSelector', function() { 
    $(this).val() = '';
}) 
```

parentSelector 在 DOM 中比输入元素更高，并且是在页面加载时存在的元素，可能是表单 ID 或其他东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:29:56.850

我不明白为什么这不起作用？

```
<script>
    $(function(){
        $("#dateFieldId").change(function(){
            $(this).val("");
        });
    });
</script> 
```

清除输入后，可能正在设置图形日期选择器上的日期选择。

或者，datepicker API 有一个回调函数。[查看文档](http://api.jqueryui.com/datepicker/)，应该有一个 after_select 或回调函数可用

# c# - 访问 Microsoft.Office.Interop.Outlook.MailItem 的属性

> ID：12900708
> 
> 赞同：1
> 
> 时间：2012-10-15T17:16:41.670
> 
> 标签：c#, outlook, vsto, office-interop, outlook-addin

我正在处理 Outlook 插件应用程序，但无法正确访问`MailItem`对象的属性。例如，如果我在“收件人”框中键入电子邮件地址，则以下代码不会在调试器中返回任何值：

当我尝试在即时窗口中检查收件人计数属性时，我收到以下错误：

```
mailItem.Recipients.Count 
```

> *'System.Linq.ParallelEnumerable.Count(System.Linq.ParallelQuery, System.Func)' 是一个'方法'，在给定的上下文中是无效的*

我怎样才能访问这些属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T13:29:24.430

**命令窗口**或**即时窗口**将`Recipients`集合视为，而`object`不是特定的 Outlook 嵌入类型 ( *`Outlook.Recipients`*)。解决此问题的唯一方法是`dynamic`在访问其成员之前创建类型。

### `((object)MailItem.Recipients).Count`产生错误：

> （*`System.Linq.ParallelEnumerable.Count(System.Linq.ParallelQuery, System.Func)' 是一个“方法”，在给定的上下文中无效*）。

### `((Outlook.Recipients)MailItem.Recipients).Count`生成以下错误建议您使用[`dynamic`](http://msdn.microsoft.com/en-us/library/dd264736.aspx)：

> *嵌入式互操作类型“Microsoft.Office.Interop.Outlook.Recipients”在“MyOutlookAddIn.dll”和“Outlook.dll”中定义。调试时不支持对此类对象的某些操作。在“嵌入互操作类型”属性设置为 false 的情况下调试或构建时，请考虑将此对象转换为“动态”类型。*

### 这就是您访问 ComObjects`Outlook.Recipients`属性的目的：

```
((dynamic)MailItem.Recipients).Count 
```

# windows-installer - installshield和windowsinstaller有什么区别

> ID：12900710
> 
> 赞同：6
> 
> 时间：2012-10-15T17:16:47.133
> 
> 标签：windows-installer, installshield

Installshield 将创建可以在 msi 或 rpm 等中的软件包。Windows 安装程序是否也会创建 msi 和 rpm 文件？或者这是一个嵌入在 Windows 操作系统中的工具，它需要运行 msi 文件，对吗？我的意思是，我们将使用 install shield 创建 msi 文件，然后我们将其提供给客户，他们将在其操作系统中嵌入的 windows 安装程序的帮助下安装 msi 并生成 exe 文件，对吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T17:40:18.750

InstallShield（以及其他，例如 Advanced Installer 和 InstallAware）是帮助开发人员创建 Windows 安装包（MSI 文件）的工具。Visual Studio 也能够生成 MSI 文件，尽管有些人发现 Visual Studio 工具缺少某些功能。

[Wikipedia 上有一篇关于该主题的相当不错的文章，您可能会觉得很有趣](http://en.wikipedia.org/wiki/Windows_Installer)。

Windows 安装程序包含在 Windows 操作系统中。

一般的想法是，您作为开发人员将您的软件（可执行文件和其他依赖项）打包到一个 MSI 文件中，最终用户可以使用该文件通过 Windows Installer 在他们的计算机上安装产品。

随着您更多地参与创建、测试和调试 MSI，您会发现该主题还有很多其他内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-15T19:27:38.290

Windows Installer 是 Windows 操作系统的一项服务，它是任何最新版本的 Windows 的一部分。Windows Installer 的目的是支持安装、更新或维护（即修复）已开发为在 Windows 上运行的应用程序。如果您是面向 Windows 的应用程序的开发人员，则可以考虑将您的应用程序作为 Windows Installer 程序包提供给用户，以利用 Windows Installer 的功能来部署和服务您的应用程序。Windows Installer 服务在线记录在桌面开发者中心：[Windows Installer](http://msdn.microsoft.com/En-US/Library/Windows/Desktop/c91119b9-59d5-4a33-91cd-d3ba63659d12)

Windows Installer 用于桌面应用程序，而不是用于安装 Windows 应用商店应用程序的技术。

Windows Installer 程序包具有 .msi 扩展名，您还会看到称为“MSI”的 Windows Installer。虽然 SDK 中包含一个编辑工具，但使用起来很困难，但大多数开发人员更喜欢使用第三方 MSI 包创建工具。InstallShield 是一个非常流行的工具，在这个 InStallSite[网站](http://www.installsite.org/)上对这个工具和其他工具进行了详细的讨论和比较。WiX 是一种开源创作工具，可在 SourceForge[站点](http://sourceforge.net/projects/wix/)获得。

在考虑哪种工具最适合您的项目时，您可能应该同时查看工具的文档和底层的 Windows Installer 服务。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-15T17:41:04.040

MSI 是 Windows 提供的平台服务。它使用关系数据库 (.MSI) 来表达安装程序的行为。

InstallShield 是一个品牌名称，可以指代任意数量的产品和项目类型。MSI 是 InstallShield Limited Edition、Express、Professional 和 Premiere 支持的一种或多种项目类型的输出。

Windows Installer XML (WiX) 等其他工具也可以生成 MSI，wixpie 和 wixedit 等工具可以提供帮助。

# c++ - 减小控制台尺寸

> ID：12900713
> 
> 赞同：3
> 
> 时间：2012-10-15T17:16:56.240
> 
> 标签：c++, winapi, console-application

我在更改控制台大小时遇到​​问题。这是我的代码：

```
BOOL setConsole(int x, int y)
{
hStdin = GetStdHandle(STD_INPUT_HANDLE); 
hStdout = GetStdHandle(STD_OUTPUT_HANDLE); 
if (hStdin == INVALID_HANDLE_VALUE || 
    hStdout == INVALID_HANDLE_VALUE) 
{
    MessageBox(NULL, TEXT("GetStdHandle"),
        TEXT("Console Error"), MB_OK);
    return false;
}

SMALL_RECT windowSize = {0, 0, x-1, y-1};

// Change the console window size:
SetConsoleWindowInfo(hStdout, TRUE, &windowSize);

COORD c = { x, y};

//Change the internal buffer size:
SetConsoleScreenBufferSize(hStdout, c);

SetConsoleDisplayMode(hStdout,CONSOLE_FULLSCREEN_MODE, &c);

return true;
} 
```

当我尝试放大控制台时，它工作得很好。当一个参数小于前一个参数时，什么也不会发生。怎么了？

@edit：经过一些测试，我注意到，如果我一次更改一个参数，则可以调整大小（缩小）。示例（假设控制台为 100x100）

```
 setConsole(90,90); //dosen't work.
 setConsole(90,100);
 setConsole(90,90); // works perfectly 
```

为什么？！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T18:33:53.253

`SetConsoleScreenBufferSize`更改控制台内部缓冲区的大小。更改它对控制台窗口范围没有影响。`SetConsoleWindowInfo`如果您需要对控制台的可见部分（缓冲区）产生影响，请调用。

窗口缓冲区不能小于内部缓冲区，减少它也会减少内部缓冲区，但反之则不行。

如果您`SetConsoleScreenBufferSize`在 COORDS 中使用非法值（例如，高度/宽度太小）调用，则通常会出现错误`87 'invalid argument'.`

试试这个代码：

```
#include <iostream>
#include <windows.h> 

using namespace std;

void SetWindow(int Width, int Height) 
{ 
    _COORD coord; 
    coord.X = Width; 
    coord.Y = Height; 

    _SMALL_RECT Rect; 
    Rect.Top = 0; 
    Rect.Left = 0; 
    Rect.Bottom = Height - 1; 
    Rect.Right = Width - 1; 

    HANDLE Handle = GetStdHandle(STD_OUTPUT_HANDLE);      // Get Handle 
    SetConsoleScreenBufferSize(Handle, coord);            // Set Buffer Size 
    SetConsoleWindowInfo(Handle, TRUE, &Rect);            // Set Window Size 
} 

int main(void) 
{     
    SetWindow(80,40);
    int dx=1,i=5,l=0;

     while(l<5)
     {
        i=i+dx;
        if( (i<1) || (i>10)){ dx=-dx; l++;}

        SetWindow(10*i,5*i);
        Sleep(100);

     }

  cout<<" \nPress any key to continue\n";
  cin.ignore();
  cin.get();
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-16T14:19:08.733

晚会迟到了...

从 MSDN 和一些测试可以设计，屏幕缓冲区不能设置为小于窗口的范围或窗口的范围大于屏幕缓冲区。

一种技巧是在更改缓冲区大小之前将窗口缩小到最小：

```
static void
set_console_size(HANDLE screen_buffer, SHORT width, SHORT height)
{
    assert(screen_buffer != NULL);
    assert(width > 0);
    assert(height > 0);

    COORD const size = { width, height };
    BOOL success;

    SMALL_RECT const minimal_window = { 0, 0, 1, 1 };
    success = SetConsoleWindowInfo(screen_buffer, TRUE, &minimal_window);
    CHECK(success);

    success = SetConsoleScreenBufferSize(screen_buffer, size);
    CHECK(success);

    SMALL_RECT const window = { 0, 0, size.X - 1, size.Y - 1 };
    success = SetConsoleWindowInfo(screen_buffer, TRUE, &window);
    CHECK(success);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-22T14:57:54.180

试试这个代码：

```
system("mode 650"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-02T00:12:23.953

我在 2012 年 10 月 15 日修改了“Software_Designer”提供的代码，并创建了一个命令行实用程序来设置控制台大小和滚动缓冲区。

[我使用 DEV C++ ( http://www.bloodshed.net/devcpp.html](http://www.bloodshed.net/devcpp.html) )编译它。

[https://sourceforge.net/projects/wa2l-wintools/](https://sourceforge.net/projects/wa2l-wintools/)中包含一个可执行文件。我希望这有帮助。

```
/*
 * consolesize.cpp - set console size and buffer dimensions
 *
 * [00] 02.07.2016 CWa  Initial Version
 *
 * inspired by: http://stackoverflow.com/questions/12900713/reducing-console-size
 *
 */

#include <iostream>
#include <windows.h> 

using namespace std;

// SetWindow(Width,Height,WidthBuffer,HeightBuffer) -- set console size and buffer dimensions
//
void SetWindow(int Width, int Height, int WidthBuffer, int HeightBuffer) { 
    _COORD coord; 
    coord.X = WidthBuffer; 
    coord.Y = HeightBuffer; 

    _SMALL_RECT Rect; 
    Rect.Top = 0; 
    Rect.Left = 0; 
    Rect.Bottom = Height - 1; 
    Rect.Right = Width - 1; 

    HANDLE Handle = GetStdHandle(STD_OUTPUT_HANDLE);      // Get Handle 
    SetConsoleScreenBufferSize(Handle, coord);            // Set Buffer Size 
    SetConsoleWindowInfo(Handle, TRUE, &Rect);            // Set Window Size 
}  // SetWindow

// main(Width,Height,WidthBuffer,HeightBuffer) -- main
//
int main(int argc, char *argv[]) {     
    int width = 80;
    int height = 25;
    int wbuffer = width + 200;
    int hbuffer = height + 1000;

    if ( argc == 5 ){
        width = atoi(argv[1]);
        height = atoi(argv[2]);
        wbuffer = atoi(argv[3]);
        hbuffer = atoi(argv[4]);
    } else if ( argc > 1 ) {
        cout << "Usage: " << argv[0] << " [ width height bufferwidth bufferheight ]" << endl << endl;
        cout << "  Where" << endl;
        cout << "    width            console width" << endl;
        cout << "    height           console height" << endl;
        cout << "    bufferwidth      scroll buffer width" << endl;
        cout << "    bufferheight     scroll buffer height" << endl;
        return 4;
    }    

    SetWindow(width,height,wbuffer,hbuffer);
    return 0;
} 
```

# php - 如何使用特定于最后一行的条件在循环中回显特定数据

> ID：12900715
> 
> 赞同：2
> 
> 时间：2012-10-15T17:17:00.897
> 
> 标签：php, mysql, loops, accounting

对于会计系统，我使用的是 PHP 和 MySQL。我有两个表“GROUP”和“ACHEADS”。

在 GROUP 表中，我有：

```
---------------------
| id (AI) |  group  |
---------------------
|    1    | Group 1 |
|    2    | Group 2 |
--------------------- 
```

在 ACHEADS 表中，我有：

```
-----------------------------------------
| id (AI) |  ac_head    | amount | j_id |
-----------------------------------------
|    1    | Something 1 |  2000  |   1  |
|    2    | Something 2 |  1000  |   1  |
|    3    | Something 3 |  5000  |   2  |
|    4    | Something 4 |  4000  |   2  |
|    5    | Something 5 |  8000  |   2  |
----------------------------------------- 
```

我已将这两个表加入为 GROUP.id <<->> ACHEADS.j_id

现在我需要像这样预览数据：

```
----------------------------------------------
Particulars               | Details | Total  |
----------------------------------------------
Group 1                   |         |        |
 Something 1              |    2000 |        |
 Something 2              |    1000 |   3000 |
----------------------------------------------
Group 2                   |         |        |
 Something 3              |    5000 |        |
 Something 4              |    4000 |        |
 Something 5              |    8000 |  17000 |
----------------------------------------------
GRAND TOTAL               |         |  20000 |
------------------------------------========== 
```

### 挑战

1.  该表将是动态的，并将在 PHP 循环中生成（我正在使用 WHILE 循环）
2.  记住：这是一张桌子，如果我错过了 td 的回显，那么这张桌子就会散架

### 问题

*   当我使用循环时，它会准确地回显 Details td 上的数据。但是根据 j_id 的详细信息行的总和也在每个 td 中回显

在这里预览：

```
----------------------------------------------
Particulars               | Details | Total  |
----------------------------------------------
Group 1                   |         |        |
 Something 1              |    2000 |   3000 |
 Something 2              |    1000 |   3000 |
----------------------------------------------
Group 2                   |         |        |
 Something 3              |    5000 |  17000 |
 Something 4              |    4000 |  17000 |
 Something 5              |    8000 |  17000 |
---------------------------------------------- 
```

### 我的想法

*   如果我可以检查它是否是查询的最后一个数据，如果是 isset，则用它的 td 回显总金额。（但请记住挑战#2）
*   它需要一个foreach循环吗？

### 我失败了

*   我尝试检查 max(id)，它在 SQL 中工作正常，但不能在循环内的条件下使用它。

（如果你还是不能理解我，那么在第二阶段，我会发布我的代码。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:28:40.117

我会做2个循环：

1.  取自`id`_`GROUP`
2.  取自基于`amount`_`ACHEADS``j_id`

这看起来像（未经测试的代码）：

```
echo '<table><tr><td>Particulars</td><td>Details</td><td>Total</td></tr>';

$total = 0;

$q1 = "SELECT id FROM `GROUP`";
$res1 = mysqli_query($q1);
while($row1 = mysqli_fetch_assoc($res1)) {
    echo 

    $group_total = 0;
    $j_id = $row1[id];

    $q2 = "SELECT ac_head, amount FROM ACHEADS WHERE j_id = $j_id";
    $res2 = mysqli_query($q2);
    while($row2 = mysqli_fetch_assoc($res1)) {

        echo '<tr><td>' . $row2[ac_head] . '</td>';
        echo '<td>' . $row2[amount] . '</td></tr>';

        $group_total = $group_total + $row2[amount];
        $total = $total + $row[amount];
    }

   echo '<tr><td colspan="3" align="right">' . $group_total . '</td></tr>';
}

echo '<tr><td>GRAND TOTAL</td>';
echo '<td colspan="2" align="right">' . $total . '</td></tr>';
echo "</table>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T06:19:49.127

njk 摇滚！
它工作得很好。非常感谢，兄弟 - 它对我帮助很大，我无法解释。
这是我的最终代码：

```
<tr style="background: #000; color:#fff;">
<th style="width:150px;">Particulars</th>
<th>Details</th>
<th>Amount</th>
</tr>

<tr>
<td>Opening Balance</td>
<td></td>
<td>500000</td> <!-- till not dynamic -->
</tr>

<?php
$total = 0;
$se = "SELECT * FROM group";
$res = mysql_query($se) or die (mysql_error());
while ($row = mysql_fetch_array($res))
{
?>

<tr>
<td colspan="3" style="font-weight:bold;"><?php echo $row['group']; ?></td>
</tr>

<tr>
<?php
$group_total = 0;
$se1 = "SELECT ac_head, amount FROM `acheads` WHERE `j_Id` = '".$row['id']."'";
$res1 = mysql_query($se1) or die (mysql_error());
while ($row1 = mysql_fetch_array($res1))
{
$group_total = $group_total + $row1['amount'];
?>
<td><?php echo $row1['ac_head']; ?></td>
<td><?php echo $row1['amount']; ?></td>
<td>&nbsp;</td>
</tr>

<?php
}
echo '<tr><td colspan="3" align="right">' . $group_total . '</td></tr>';
}
?>
</table>
</code> 
```

# batch-file - 批处理文件变量

> ID：12900716
> 
> 赞同：0
> 
> 时间：2012-10-15T17:17:02.623
> 
> 标签：batch-file

我有这段代码可以回显变量名...

```
set filename=
set filename=%1 
```

...`%1`从 cmd 输入的命令在哪里

但是，当我再次运行这个批处理文件时，它仍然具有与以前相同的值。当我再次运行它时，它具有先前输入的值。如何清除变量，以便当我再次运行程序时，它会接收该输入而不是之前的输入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:32:15.587

取决于您的 Windows 版本

设置本地

可能会为您解决问题

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T17:35:03.507

我会这样写：

```
@echo off
setlocal
::set filename=
set "filename=%1"
pause 
```

那应该行得通。

# php - 带附件的php和soap

> ID：12900719
> 
> 赞同：1
> 
> 时间：2012-10-15T17:17:06.267
> 
> 标签：php, soap, attachment

我是 PHP 和 Web 服务的新手。我需要将文件发送到 Web 服务，但我找不到正确的方法。WS 现在将文件作为来自 java 代码的变量 (dh)，如下所示：

```
QName qnameAttachment = new QName("xsd:ASCII");
call.registerTypeMapping(DataHandler.class, qnameAttachment, JAFDataHandlerSerializerFactory.class, JAFDataHandlerDeserializerFactory.class);
DataHandler dh = new DataHandler(new FileDataSource(this.idh)); 
```

然后 dh 变量被发送到 WS（SOAP 调用）并且 WS 生成这个 XML 标记：

```
<dh href="cid:2643CE40EEF7B2F167ED283AE8BC6326" xsi:type="xsd:ASCII"/> 
```

我现在正在尝试用 PHP 编写一个代码，它能够做同样的事情，但我找不到正确的解决方案。我试图通过“base64_encode”函数对文件进行编码：

```
 $dh = base64_encode($tarfile); 
```

$dh 假设一个类似于“cnwicubnweiv87723re2”的值。然后我尝试将 $dh 变量作为普通字符串传递给 WS，但结果如下：

```
<dh> cnwicubnweiv87723re2 </dh> 
```

WS 不将变量识别为标签的属性。我将 $dh 作为普通字符串发送显然是错误的，而且我不知道如何传递它以让 WS 知道将其用作属性。

有人能帮助我吗？

# c# - 解析表达式

> ID：12900720
> 
> 赞同：1
> 
> 时间：2012-10-15T17:17:11.027
> 
> 标签：c#, .net, parsing

我有一些`List<ObjectId>`名为“ids”的集合。我想允许用户为“ids”创建灵活的过滤器。

我想创建一个文本框，用户必须在其中写入过滤器字符串。例如：

```
item => item.ClassName == "Rectangle" 
```

我需要这个表达式适用于“ids”上的每个项目。如何尝试解析它以进行验证？如何在我的代码中为每个“ids”项目运行它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:24:58.527

为什么不创建一个扩展 List 的类，然后您可以创建 get 方法，例如：

```
public class ObjectIdCollection : List<ObjectId>
{
    public ObjectIdCollection() { }
    public ObjectId this[string classname]
    {
        get
        {
            foreach(ObjectId id in this) if(id.ClassName == classname) return id;
            return null;
        }
    }
} 
```

这将返回具有指定类名的第一个 Id，如果没有找到则返回 null

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:27:42.727

您可以利用[动态 LINQ](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:41:53.573

它们是许多可用的[lambda 表达式解析器](http://code.google.com/p/lambda-parser/downloads/detail?name=Zhucai.LambdaParser.dll&can=2&q=)。

使用以下逻辑来解析和执行基于文本框（Say `txtFilter`）过滤器字符串。

```
var ids = new List<ObjectId> 
             { 
                new ObjectId { ClassName = "Rectangle1", ID = 1 }, 
                new ObjectId { ClassName = "Rectangle2", ID = 2 } 
             };

string code = txtFilter.Text; (Ex: "item => item.ClassName == \"Rectangle1\"" ;)

Func<ObjectId, bool> func = ExpressionParser.Compile<Func<ObjectId, bool>>(code);      

ids.ForEach(obejctId => 
        {
            Console.WriteLine(func.Invoke(obejctId));
        }); 
```

输出是

```
 True
  False 
```

# asp.net - 如何强制浏览器转到服务器端而不是从浏览器缓存中获取数据

> ID：12900722
> 
> 赞同：3
> 
> 时间：2012-10-15T17:17:29.267
> 
> 标签：asp.net, firefox, browser-cache

问题是Firefox在单击后退按钮时显示“文档已过期”。有没有办法重新请求数据？

我在 msdn 上阅读：如果您将 NoCache 或 ServerAndNoCache 传递给 SetCacheability 方法以防止请求浏览器在其历史文件夹中缓存页面，则每当用户单击后退或前进按钮时，都会请求新版本的响应.

```
 Response.Cache.SetCacheability(HttpCacheability.NoCache); 
```

我不知道如何在代码隐藏中使用它或者这会有帮助。？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T10:50:00.497

在文档的部分应用这些`<meta>`标签。`<head>``HTML`

```
<HTML>
<HEAD>
    <!-- no cache headers -->
    <meta http-equiv="Cache-Control" content=" no-store, no-cache, must-revalidate, pre-check=0, post-check=0, max-age=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="-1">
    <meta http-equiv="no-cache">
    <!-- end no cache headers -->
</HEAD>
<BODY>
    <!-- Body Here -->
</BODY>
</HTML> 
```

参考：[如何防止 Internet Explorer 中的缓存](http://support.microsoft.com/kb/234067)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T18:53:29.077

如果你使用 FF：

*   打开新页面“关于：配置”
*   查找参数 network.http.use-cache
*   切换它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:31:08.147

如果您想为整个站点处理它，您应该能够在 IIS 中设置过期和缓存，但否则`Page_Load`在生命周期中这样做可能为时已晚。

# xcode - Xcode - 项目参考与复制 .a 文件

> ID：12900728
> 
> 赞同：1
> 
> 时间：2012-10-15T17:17:56.383
> 
> 标签：xcode

我已经为 iOS 开发一年多了，在最近的几个项目中，我一直在使用其他项目，例如 RestKit 或 SSZipArchive 等等。在执行这些项目时，我会将这些项目作为交叉引用包含在我的主项目下方的工作区中。

我对这个过程感到困惑的是，这与我遇到的任何其他语言都不同。通常，在其他语言中，我从项目（例如 .dll 或 .jar）中获取已编译的输出文件，并且这些文件包含在项目中。我知道当您在 Xcode 中构建静态库时，生成的文件是 lib*.a 文件。

保持这些项目交叉引用而不是仅仅将 lib*.a 文件复制到项目中的原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:42:24.370

> 保持这些项目交叉引用而不是仅仅将 lib*.a 文件复制到项目中的原因是什么？

听起来您正在谈论将库项目添加为子项目。这样做的原因是在您的项目和子项目之间建立依赖关系。如果对子项目进行了更改，Xcode 将重建您的主项目，以便合并最新版本的库。

# iphone - ios：在 UIButton 中以编程方式编辑的内容居中

> ID：12900735
> 
> 赞同：0
> 
> 时间：2012-10-15T17:18:19.223
> 
> 标签：iphone, ios, uibutton, alignment

我有一个 UIbutton，里面有一些居中的文本。当我以编程方式更新文本时，使用：`button.titleLabel.text = newValue;`它不再居中，而是它有一个非常奇怪的位置（不居中，也不左对齐）......我怎样才能让按钮更新文本以水平居中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:20:37.967

UIButton 的标题应该使用 setTitle:forState: 方法设置。

# java - 将数组作为参数传递给 SOAPMessage Java

> ID：12900739
> 
> 赞同：0
> 
> 时间：2012-10-15T17:18:27.643
> 
> 标签：java, xml, web-services, soap

我正在尝试为获取 int[] 作为参数并在执行一些操作后返回它的 WS 创建一个 webService 客户端。

问题是，当我创建 SOAPMessage 请求时，我不知道如何将数组添加到 SOAPMessage。

我发现的唯一和平代码来自 OREILY 的 Java 和 SOAP 一书，它使用了这两个导入

导入 org.apache.soap。*; 导入 org.apache.soap.rpc。*;

创建 SOAPMessage 但它们不包含在 java 6 的标准版本中。

当我尝试测试 WebService 时，我在传递数组时没有得到有关 SoapMessage 结构的信息

```
<?xml version="1.0" encoding="UTF-8"?>
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
    <S:Header/>
    <S:Body>
        <ns2:dataTransfer xmlns:ns2="http://bigDataTransferPKG/"/>
    </S:Body>
</S:Envelope> 
```

这是代码，因为它是从 netbeans7.2 自动创建的

```
@WebService(serviceName = "bigDataTransferService")
@Stateless()
public class bigDataTransferService {

    /**
     * Web service operation
     */
    @WebMethod(operationName = "dataTransfer")
    public int[] dataTransfer(@WebParam(name = "data") int[] data) {
        //TODO write your implementation code here:
        return data;
   }
} 
```

相反，当我测试一个以 2 int 作为参数的 Web 服务时，我得到了这个

```
<?xml version="1.0" encoding="UTF-8"?>
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
    <S:Header/>
    <S:Body>
        <ns2:sum xmlns:ns2="http://additionerPKG/">
            <number1>23</number1>
            <number2>32</number2>
        </ns2:sum>
    </S:Body>
</S:Envelope> 
```

所以我也不知道肥皂请求应该如何创建，更不用说如何创建它了:)

我有点迷茫，我希望我能很好地解释它以理解我:)

先感谢您

# c# - 使用 CCW 的 ASP.NET MVC3 AntiForgery 令牌

> ID：12900741
> 
> 赞同：0
> 
> 时间：2012-10-15T17:18:43.910
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-3, c#-4.0

我有一些遗留应用程序当前正在将基本信息发布到 MVC3 表单。我想将其分离到 GET 并传递查询字符串中的值。很容易。但是，我想在请求中添加一个防伪令牌。首先，这似乎是一个不错的选择吗？其次，是否有从非 MVC3 模块到 MVC3 表单实现此类功能的示例？

我的另一种选择是加密查询字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:33:04.540

由 ASP.NET 实现的 Anti-Forgery Token 旨在作为一种防止 CSRF（即 corss-site-request-forgery）的机制，并且仅适用于 HTTP `POST`。

由于您正在实现`GET`基于“API”的此令牌将不起作用（请注意限制，例如查询字符串的长度）。

我不确定您的目标到底是什么......根据您的目标，解决方案是加密或签署查询字符串或两者兼而有之。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:33:15.363

你可以在这个 mvc3 动作中发布你想要的每个帖子。您只需确保您的 postdata 与服务器端对象匹配。是的，为了安全起见，您必须使用防伪令牌。

例如，在 javascript 中，您可以使用 jQuery 制作这样的帖子。如您所见，我不使用表单，而只是使用一些 javascript 代码。Mvc 可以完美地处理这个问题。

```
$.ajax({
    type: 'POST',
    url: urlToYourMvcAction,
    data: {
        name: 'John Doe',
        age: 25
    }, 
    success: successCalback,
    error: errorCallback);

public class Person
{
    public int Id { get; set; }
    public string Name { get; ;set }
    public int Age { get; set; }
}

public class PersonController : Controller
{
    [HttpPost]
    public ActionResult Add(Person person)
    {
          //Your code
    }
} 
```

您可以在旧版应用程序中使用 c# WebClient 对象轻松发出相同的发布请求。您可以使用 fiddler 或开发人员工具来检查请求并传入发布帖子所需的正确参数。

哦，当请求变大时，使用获取请求会给您带来麻烦。帖子是用来发送数据到服务器的。Gets 用于从服务器获取数据。

# javascript - 向下滚动时自动加载内容

> ID：12900744
> 
> 赞同：8
> 
> 时间：2012-10-15T17:18:59.110
> 
> 标签：javascript, jquery, django, django-templates

我正在 django/webfaction 上创建一个博客。我的主页目前默认显示 4 个帖子（帖子限制为 4 on `queryset`in `urls.py`）。现在，一旦用户到达页面底部，我想再加载四篇文章，并继续这样做，直到到达最后一篇文章。如何做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-15T17:23:36.477

如果您想在到达文档的最底部时加载您的内容，请使用以下代码：

```
$(window).scroll(function()
{
    if($(window).scrollTop() == $(document).height() - $(window).height())
    {
          // load your content
    }
}); 
```

如果您想在底部达到 100 像素之前加载内容使用

```
var loading= false;
$(window).scroll(function() {
    if (!loading && ($(window).scrollTop() >  $(document).height() - $(window).height() - 100)) {
        loading= true;

        // your content loading call goes here.

        loading = false; // reset value of loading once content loaded
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T17:23:29.307

你可以试试这样的..

```
var processScroll = true;
$(window).scroll(function() {
    if (processScroll  && $(window).scrollTop() > $(document).height() - $(window).height() - 100) {
        processScroll = false;
        // your functionality here
        processScroll = true;
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T17:39:58.550

您可以进行 Ajax 调用以获取有关元素“onscroll”事件的更多帖子（在您的情况下可能在 body 上）。您可以使用此处记录的 jquery 的“.scroll()”进行相同的调用：http: [//api.jquery.com/scroll/](http://api.jquery.com/scroll/)

您可能可以维护一个 previous-top 语句来确定当前滚动的方向。

# php - 如果可爆炸/否则

> ID：12900747
> 
> 赞同：0
> 
> 时间：2012-10-15T17:19:11.260
> 
> 标签：php

我有一个字符串，它可能包含也可能不包含逗号。如果是这样，我希望它爆炸成一个数组；如果不是，我仍然希望将字符串保存到新标识符中。我的代码显然不起作用。有人有更好的想法吗？

```
if(explode(",", $_SESSION['shoparea']))
{
    $areas = explode(",", $_SESSION['shoparea']);
} else {
     $areas = $_SESSION['shoparea'];
} 
```

此操作的正确语法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T17:21:02.530

```
if(strpos($_SESSION['shoparea'], ',') !== false) {
    $areas = explode(',', $_SESSION['shoparea']);
} else {
     $areas = $_SESSION['shoparea'];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T17:22:32.797

一切都可以爆炸，如果没有分隔符的实例，它就会变成一个单例数组，所以它可能更简单

```
$result = explode(",", $_SESSION['shoparea']);
if (count($result) == 1)
   $areas = $result[0];
else
   $areas = $result; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T17:21:02.717

您可以使用[http://php.net/strpos](http://php.net/strpos)函数来确保存在“，”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T17:21:12.577

所有你需要的是

```
$_SESSION['shoparea'] = "xx"; // Test value .. 

if (!$areas = explode(",", $_SESSION['shoparea'])) {
    $areas = array($_SESSION['shoparea']);
} 
```

输出

```
array
  0 => string 'xx' (length=2) 
```

**注意：`$areas`需要始终是数组..如果您使用的是循环，您可能会遇到问题，所以我转换了它..**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-15T17:23:24.290

例如，你可以这样做

```
$areas = $_SESSION['shoparea'];
if(strpos($areas, ',') !== false) {
    $areas = explode(",", $areas);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-15T17:21:40.970

```
if (substr_count($_SESSION['shoparea'], ',') > 0) {
    $areas = explode(",", $_SESSION['shoparea']);
}
else {
    $areas = $_SESSION['shoparea'];
} 
```

# php - PHP 等效于 ASP.NET 表单身份验证

> ID：12900748
> 
> 赞同：2
> 
> 时间：2012-10-15T17:19:12.513
> 
> 标签：php, forms-authentication

我想在 PHP 驱动的站点中利用与 ASP.NET 表单身份验证类似的功能。我知道我可以使用“本土”类型的东西（意味着从头开始构建一些东西），但我想看看其他选择。我在这个运行 Linux 的特定项目的托管 Web 服务器上，所以我无权添加我想要的任何扩展，但我正在运行带有 Http 的 PHP 5.4，并且 OAuth 扩展可用（还有其他的，但它们是围绕电子邮件和图像）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:28:33.400

据我了解表单身份验证，这是 ASP 如何跨站点跟踪特定用户的方式？我建议使用 PHP 的会话。有大量的教程和示例代码，您可以从中获得很大的优势。

[http://onlamp.com/pub/a/php/2001/04/26/sessions.html](http://onlamp.com/pub/a/php/2001/04/26/sessions.html)

只需学习基本概念。

[http://php.net/manual/en/function.session-start.php](http://php.net/manual/en/function.session-start.php)

PHP 允许您启动会话，然后保存和调用会话变量。

```
session_start();
$_SESSION['variable'] = 'this will be on the next page if i start the session';
if(!$_SESSION['mylogincheck']) die(header('Location: loggedout.php')); 
```

# svn - TortoiseSVN 警告：您正在尝试将工作副本重新定位到同一存储库中的不同路径

> ID：12900749
> 
> 赞同：2
> 
> 时间：2012-10-15T17:19:15.103
> 
> 标签：svn, tortoisesvn, svn-externals

最近我一直在尝试`svn:externals`并开始在执行`SVN Update`.

> Z:\Projects\workB\trunk
> 
> 无法重新定位“Z:\Projects\workB\trunk”，因为它不是工作的根
> 
> 复制; 尝试重新定位 'Z:\Projects\workB'

![在此处输入图像描述](../Images/a2e64dfb9cbcdf852ae6d079aaaa1d18.png)

正如[这个页面](http://tortoisesvn.net/docs/nightly/TortoiseSVN_en/tsvn-dug-relocate.html)所暗示的，我通过上下文菜单执行`TortoiseSVN → Relocate`。`Z:\Projects\workB`然后我得到这个消息框。

> 您似乎正在尝试将您的工作副本重新定位到同一存储库中的不同路径。
> 
> 来自：file:///Z:/repos/repoB
> 
> 收件人：file:///Z:/repos/repoB

![在此处输入图像描述](../Images/f88093122bcdd86aeee8c53862fd5c8d.png)

这是正常的吗？尽管警告消息显示不同的路径，但两者`From:`和`To:`路径都是相同的。我想知道是否可以在这里按“是”。

这可能是相关的：[Problem trying relocate WC to new repository](https://stackoverflow.com/questions/3565284/problem-trying-to-relocate-wc-to-new-repository)

* * *

[更新]

为了解释我做了什么导致第一个错误（无法重新定位等），当前目录结构是这样的。

> Z:\repos\repoA
> 
> Z:\repos\repoB
> 
> Z:\项目\workB

`Z:\Projects\workB`是对存储库的检出`repoB`。我通过以下步骤创建`svn:externals`了一个。`Z:\Projects\workB`（我尝试将整个主干文件夹及其内容从 to 导入`repoA`。`Z:\Projects\workB\trunk`我想这样做是有原因的，但这将是一个漫长的故事。）

1.  右键单击`Z:\Projects\workB`并选择`TortoiseSVN -> Properties`

2.  `New -> Externals`

3.  按下`New...`

4.  为本地路径输入“trunk”，为 URL 输入“file:///Z:/repos/repoA/trunk”并关闭设置窗口。

    ![在此处输入图像描述](../Images/7e5920bc0553fcc37ddbc82e8e018ab1.png)

5.  右键单击`Z:\Projects\workB`并选择`SVN Commit...`并按确定以应用外部定义。提交通过了。

6.  要查看是否导入了外部文件，我右键单击`Z:\Projects\workB`并选择`SVN Update`

我得到了第一个错误，说尝试重新定位。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:40:29.060

不不不！

永远不要使用`file:///`URL——尤其是在共享项目中。这很糟糕，很糟糕，这不是一个好主意。

如果不出意外，请使用该`svnserve`过程启动 Subversion 服务器。这相当简单，没有人可以直接访问您的 Subversion 存储库目录。

该`file://`URL 在使用 Subversion 时很好用，但绝不应在实际项目中使用。如果您想要一个开源 Subversion 服务器，请查看 CollabNet 的[Subversion Edge 。](http://www.collab.net/downloads/subversion)`http://`这将允许您在 Windows 服务器上提供您的存储库。另一个流行的是[VisualSVN Server](http://www.visualsvn.com/server/licensing/)。它不是开源的，但很多人喜欢设置 Subversion 存储库的免费版本。

* * *

你没有提供太多信息。您是否意识到在 Subversion 中您可以在工作目录中签出您想要处理的文件？例如：

```
 C:> cd C:\workdir
 C:> svn co file:///Z:/Projects/workB/trunk workB-trunk 
```

这将在 C:\workdir\workB-trunk 上创建一个本地副本。这是您可以玩弄文件的地方。请注意您的存储库与您签出的文件的位置不同。我有一种感觉，这就是为什么你会看到*搬迁*的东西。

要使用`svn:externals`，您需要将该`svn:externals`属性放在项目的目录中：

```
 C> cd \workdir\workB-trunk
 C> svn propset svn:externals "^/Z:/Projects/WorkC/trunk workC" .
 C> svn update 
```

这会将最新版本`file:///Z:/Projects/WorkC/trunk`的 workB-trunk 放入您的工作副本中。提交更改，每个人在结帐时都会得到这个`file://Z:/Projects/WorkC/trunk`。

* * *

## 解决方案

万一……你碰巧有一个文件：///Z:/repos/repoB/trunk？如果是这样，您正在尝试将 repoA 检出到主干中，其中主干已经是 repoB 中的目录。

在这种情况下，只需删除`file:///Z:/repos/repoB/trunk`.

# c# - Entity Framework Code First 映射情况

> ID：12900758
> 
> 赞同：0
> 
> 时间：2012-10-15T17:19:42.370
> 
> 标签：c#, entity-framework, ef-code-first

我正在尝试使用 EF 4.3 Code First 将现有应用程序（使用纯 ADO.Net）移植到新应用程序。值得一提的是，这是我第一次使用 EF。

基本上我有一个供应商表，但有两个专业化表，其属性特定于两种类型的供应商。

这是现有数据库的样子：

```
create table Supplier(
id_supplier int not null identity
--Bunch of other attributes
);

create table Individual(
id_individual int not null --not identity, gets the same value as the Supplier table
--Attributes specific to individuals
);

alter table Individual add constraint fk_individual_supplier
foreign key(id_individual) references Supplier(id_supplier);

create table Corporation(
id_corporation int not null --not identity, gets the same value as the Supplier table
--Attributes specific to corporations
);

alter table Corporation add constraint fk_corporation_supplier
foreign key(id_corporation) references Supplier(id_supplier); 
```

因此，如表格所示，供应商可以是个人或公司。

现有的应用程序是这样的：

*   抽象类供应商及其属性
*   类从供应商派生的个体及其附加属性
*   类 Corporation 派生自 Supplier 及其附加属性

Ado.Net 代码当前用于接收供应商对象，如果传递的对象是个人类型，则在个人表上生成记录，如果传递的对象是公司类型，则在公司表上生成记录。

因此，供应商上的每条记录都将在个人或公司上具有匹配的记录。此外，个人和公司表没有任何其他数据库表的外键。相反，关系都与供应商表。生成 ID 的表是供应商。

如何使用 Code First 进行映射？

起初我考虑保留我的结构，我的意思是，Supplier 抽象类以及由此派生的个人和公司。因为我需要实体首先在供应商表上插入（生成标识字段），所以个人和公司模型类似乎都将映射到供应商表。

但是它怎么可能接收抽象类并根据类型插入到任一专业化表中呢？如果没有自定义 SQL，我认为这是不可能的，这让我认为我的方法是错误的。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T08:58:52.133

这听起来像“每个类型的表”继承（TPT）。使用 TPT 有一个基表，其中的列对于所有派生类型都是通用的，并且每个派生类型的表都具有特定于类型的列。实体框架支持此模型。有关如何使用数据注释和流畅映射的示例，请参阅[这篇出色的博客文章。](http://weblogs.asp.net/manavi/archive/2010/12/28/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-2-table-per-type-tpt.aspx)

# java - 在 java 中，我将如何检查用于输入成绩的数组的输入验证（不能为负数，不能超过 100）

> ID：12900761
> 
> 赞同：0
> 
> 时间：2012-10-15T17:20:31.173
> 
> 标签：java, arrays, validation, loops

到目前为止，我已经尝试创建一个 while 循环，只有在输入的数组值是“正确”的值（0 到 100 之间）时才会退出。Wich 意味着如果输入的值是负数或像字符这样的随机值，则循环应该重复。

到目前为止，我的代码只有在输入的所有成绩都不正确时才有效。如果我输入 0、100 和 -2，它仍然会通过，即使 -2 应该会导致循环重复。我需要修改什么以仅允许将 0 到 100 之间的值输入到数组中？

到目前为止的代码：

```
//Input validation for grades
int g = 0;

while(g >= 0)
{
  System.out.print("Please Enter the Students' Grades: ");
  for (int c = 0; c < studentGrades.length; c++)
  {
    studentGrades[c] = input2.nextInt();

    if (studentGrades[c] >= 0 && studentGrades[c] <= 100)
    {
       g = -1;
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:23:36.117

在此代码段中：

```
studentGrades[c] >= 0 && studentGrades[c] <= 100 
```

...您是说如果输入的等级大于或等于 0 且小于或等于 100，则将 g 设置为 -1（并退出循环）。

因此，基本上，每次输入有效成绩时，您的循环都会退出。你做了与你想要的相反的事情。尝试`!`在您的条件之前添加一个来否定它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:31:20.200

这应该做

```
 outer:
        while(g >= 0) {
            System.out.print("Please Enter the Students' Grades: ");

            for (int c = 0; c < studentGrades.length; c++) {
                studentGrades[c] = input2.nextInt();
                System.out.println(" input is "+studentGrades[c]);
                if (studentGrades[c] <= 0 || studentGrades[c] >= 100) {
                    break outer;
                }
            }
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:23:57.893

移动你的`while loop`内部`for loop`，因为我想你想验证你的`input`成绩`index`： -

你的条件应该是`g < 0`。此外，您在 if 中使用了反向条件。您正在设置`g = -1`正确的输入。你需要改变你的条件`if`。

```
for (int c = 0; c < studentGrades.length; c++) {

    g = -1; // Set to invalid to get your while run first time.

    while(g < 0) {
        System.out.print("Please Enter the Students' Grades: ");
        studentGrades[c] = input2.nextInt();

        // Check invalid grade -> negative or more than 100
        if (studentGrades[c] < 0 || studentGrades[c] > 100) {
            g = -1;

        } else {
            // Break while if correct grade has been entered. Continue with next index
            break;  
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T17:24:31.607

在将下一个添加到数组之前进行检查。如果超出范围，请要求另一个值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T17:27:05.743

您需要翻转逻辑，当前您的`g`标志以“无效”开始（意味着如果`g`没有更改，则循环继续），当您找到有效成绩时，您将其标记`g`为有效。

相反，在`while`循环的顶部设置`g`为`-1`，然后`0`在提供的任何成绩无效时将其设置回，例如：

```
int g = 0;
while(g >= 0) {
    g = -1;
    System.out.print("Please Enter the Students' Grades: ");
    for (int c = 0; c < studentGrades.length; c++) {
        studentGrades[c] = input2.nextInt();
        if (studentGrades[c] < 0 || studentGrades[c] > 100) {
            g = 0;
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-15T17:28:24.040

我认为这是你想要实现的（你也可以增强它）

```
int[] values = new int[5]; //modify this according to your size
int index = 0;
do {
    int value;
    do {
        System.out.println("Enter value " + (index + 1) + ": ");                
        value = input.nextInt();
    } while (value < 0 || value > 100); //make sure each value is valid
    values[index++] = value; //add value to the array
} while(index < values.length); //make sure you get all the values 
```

如果不需要 for 循环，那么我认为这样看起来会更好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-15T17:29:43.590

`studentGrades.length`无论如何，这段代码看起来都会循环直到它得到值，如果`while`循环重复，它将永远重复，因为`g`没有重新初始化。

我认为这一定是一个家庭作业问题，所以我将把修复错误的实际编码留给你作为练习。

# razor - Nancy.ViewEngines.Razor v0.12.1.0 是否支持布局视图和 _ViewStart？

> ID：12900769
> 
> 赞同：10
> 
> 时间：2012-10-15T17:20:42.493
> 
> 标签：razor, nancy

我正在使用 Nuget 上的当前版本 v0.12.1.0 来了解 Nancy，我想使用 Razor 视图引擎。

Razor 视图引擎 v0.12.1.0 是否支持 Layout 和 _ViewStart？

例如

我有以下内容`~/Views/_ViewStart.cshtml`

```
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
} 
```

以及以下内容`~/Views/Shared/_Layout.cshtml`

```
@inherits Nancy.ViewEngines.Razor.NancyRazorViewBase<dynamic>
<!DOCTYPE html>
<html>
<head>
    @RenderSection("head", false)
</head>
<body>
    @RenderBody()
</body>
</html> 
```

但是当我点击主页时，我得到的只是我设置的视图的内容`~/Views/Home/Index.cshtml`

```
<h1>Home</h1> 
```

我的主页模块如下所示：

```
public class Home : NancyModule
{
    public Home()
        : base("")
    {
        Get["/"] = _ => View["Index"];
    }
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2014-01-08T22:41:40.737

从 Nancy v0.20 开始，现在支持 _ViewStart 文件。

作为提示，在引用您的布局文件时，不要在位置前面加上`~/`. 只需具有以下内容，否则您将获得空引用异常。

```
@{
    Layout = "Views/Shared/_Layout.cshtml";
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-15T20:22:55.780

`_ViewStart`不是我们（目前）支持的，但`Layout`绝对支持按次观看

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T19:53:54.870

据我所知，简单的答案是否定的。

一个更详细的答案，来自我所做的有限研究。

在 MVC 2 中，Microsoft 添加了一个 System.Web.Razor dll，其中包含 Razor 解析器和代码生成器。_ViewStart 功能是在 MVC 3 中添加的，在该版本中，Microsoft 没有创建新的 System.Web.Razor dll。相反，他们将新的解析器和代码生成器嵌入到 System.Web.Mvc.Razor 命名空间下的新 System.Web.Mvc dll 中。我不确定这种变化背后的原因，也许是为了简化部署。

Nancy Razor 视图引擎引用了原始的 razor 解析器和代码生成器，因此无法访问 MVC 3 中 Razor 的任何新功能。我没有与 NancyFx 人员进行任何讨论，也没有看到（之后快速搜索）GitHub上的任何问题或谷歌组中的讨论，所以我不知道他们是否打算改变视图引擎。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-19T03:02:33.787

我想补充一下答案，因为我花了大约一天的时间试图弄清楚这一点：。

```
Nancy.RequestExecutionException: Oh noes! ---> System.NullReferenceException: Object reference not set to an instance of an object.
   at Nancy.ViewEngines.DefaultViewCache.GetOrAdd[TCompiledView](ViewLocationResult viewLocationResult, Func`2 valueFactory)
   at Nancy.ViewEngines.Razor.RazorViewEngine.GetOrCompileView(ViewLocationResult viewLocationResult, IRenderContext renderContext, Assembly referencingAssembly, Type passedModelType)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute5[T0,T1,T2,T3,T4,TRet](CallSite site, T0 arg0, T1 arg1, T2 arg2, T3 arg3, T4 arg4)
   at CallSite.Target(Closure , CallSite , RazorViewEngine , ViewLocationResult , IRenderContext , Assembly , Object )
   at Nancy.ViewEngines.Razor.RazorViewEngine.GetViewInstance(ViewLocationResult viewLocationResult, IRenderContext renderContext, Assembly referencingAssembly, Object model)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute5[T0,T1,T2,T3,T4,TRet](CallSite site, T0 arg0, T1 arg1, T2 arg2, T3 arg3, T4 arg4)
   at Nancy.ViewEngines.Razor.RazorViewEngine.<>c__DisplayClass27.b__26(Stream stream)
   at Nancy.Responses.MaterialisingResponse.PreExecute(NancyContext context) 
```

与 Richard Banks 的回答类似 - Nancy 不会解析 Views/_ViewStart.cshtml 文件中的默认布局路径（即：~/Views/Shared/_Layout.cshtml）。~/ 在 Nancy 的视图解析器中没有被解释。

您可以删除 ~/ 部分，或注释掉默认布局并手动指定每个视图的布局。我做后者的原因是，即使您已取消视图中的布局，Nancy 仍会执行 _Layout.cshtml。

# android - android水平滚动视图

> ID：12900777
> 
> 赞同：9
> 
> 时间：2012-10-15T17:21:13.133
> 
> 标签：android, horizontal-scrolling

我是 android 开发的初学者，我正在尝试创建一个包含不同布局的水平滚动视图。

我面临的错误是：水平滚动视图只能容纳一个直接的孩子。请提前告知谢谢

```
<HorizontalScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tool"
        android:id="@+id/horizontalScrollView1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:fillViewport="true" >

         <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:orientation="horizontal"
            android:background="#ff0000">

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="fill_parent"
                android:orientation="horizontal"
                android:background="#ff0000">

            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="fill_parent"
                android:orientation="horizontal"
                android:background="#00ff00">

            </LinearLayout>

        </LinearLayout>

    </HorizontalScrollView> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-15T17:27:13.327

不仅水平而且任何垂直滚动视图也会给出这个错误。该错误意味着滚动视图应该只有一个孩子，并且该孩子可以包含任意数量的子孩子。

所以底线是 thios 你应该只让一个直接的孩子来滚动视图，并在那个孩子中只做你的布局

```
 <HorizontalScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tool"
    android:id="@+id/horizontalScrollView1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:fillViewport="true" >

     <LinearLayout

        android:id="@+id/directchild"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:orientation="horizontal"
        android:background="#ff0000">

    </LinearLayout>

</HorizontalScrollView> 
```

现在在 directchild 布局中创建您想要的布局。然后您不会收到任何错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-21T09:32:38.330

嗨，这个错误是因为 scrollview 只能在 direcxt child 上托管。采用相对或线性布局并在其中写入所有布局

# iphone - 在 AR Vuforia Sdk 中无触摸播放视频

> ID：12900778
> 
> 赞同：0
> 
> 时间：2012-10-15T17:21:15.767
> 
> 标签：iphone, objective-c, xcode, augmented-reality, qcar-sdk

我正在使用 Vuforia sdk 开发 AR 项目并遵循 VideoPlayBack 示例项目，我只想播放不带触摸的视频，我的意思是当标记检测时，视频就会播放。`[videoPlayerHelper[touchedTarget] play:NO fromPosition:VIDEO_PLAYBACK_CURRENT_POSITION];`当标记检测到但它运行的视频大于标记大小时，我正在这样做。我很困惑，请帮助我，这对我有很大帮助。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T10:42:32.540

我不是 iphone 开发人员我是 android 开发人员，我通过查找标记是否正在跟踪来做到这一点，一旦它开始跟踪，你就可以开始播放视频并暂停丢失的跟踪，我对这个 android 问题的回答在[**这里**](https://stackoverflow.com/a/13208335/1206201).希望这将至少清除逻辑。

# sdk - 在一组迭代中加载总点数的最快方法？

> ID：12900781
> 
> 赞同：0
> 
> 时间：2012-10-15T17:21:22.823
> 
> 标签：sdk, rally

我正在创建一个应用程序，该应用程序在逐次迭代的基础上绘制接受点的总数，与该迭代中接受的所有点进行比较（无论项目如何）。目前，我正在使用带有过滤器的 WsapiDataStore 调用来仅从选定的迭代中提取。但是，这需要提取迭代中的所有用户故事，然后将每个用户故事的 Plan Estimate 字段相加。它可以工作，但是提取数据需要很长时间（大约 20-30 秒），我认为这些数据可能可以在一次调用中被查询。我的想法是正确的，还是这真的是最简单的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T17:44:53.563

Rally 的 API 不支持服务器端聚合。不幸的是，将这些数据拉入本地内存是进行此类计算的唯一方法。

# jquery - 需要 Jquery Tip 工具

> ID：12900789
> 
> 赞同：-3
> 
> 时间：2012-10-15T17:21:51.653
> 
> 标签：jquery, tooltip

我正在使用 Jquery。我喜欢用户关于哪个插件最适合我需要的一些建议。我的页面上有超链接。我喜欢做的是将鼠标悬停在超链接上，我喜欢出现工具提示。它应该做一个 JSON 并从服务器获取数据以显示。

我查看了 QTip (jquery.qtip-1.0.0-rc3.min.js) 但无法让它工作，因为从网上阅读它可能是错误的。

只是想知道是否还有其他我可以使用的常用插件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:26:58.537

jQuery ui 1.9 tooltip 可能达到你的要求

[http://jqueryui.com/tooltip/#custom-content](http://jqueryui.com/tooltip/#custom-content)

您可以设置来自服务器的自定义内容。

# ruby-on-rails - "rails new project_name" 在 OSX 上创建空项目目录

> ID：12900792
> 
> 赞同：1
> 
> 时间：2012-10-15T17:21:57.877
> 
> 标签：ruby-on-rails, macos

我正在尝试创建一个新的 rails 项目，但出现以下错误，并且我的新项目目录为空！我[在 rails github repo 上发现了一个问题，](https://github.com/rails/rails/issues/6868)但他们建议的解决方案是删除项目目录中的空格。我的项目目录中没有空格，因此此解决方案不适用。如果我错过了什么并且可以提供更多信息，请告诉我。很感谢任何形式的帮助！

```
$ rails new bookmarks_app
  create  
  Could not find "README" in any of your source paths. Your current source paths are: 
  /Users/Jared/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/generators/rails/app/templates
$ ls
bookmarks_app
$ ls bookmarks_app/
$ pwd
  /Users/Jared/Desktop/Sandbox/website
$ rails --version
  Rails 3.2.8
$ ruby --version
  ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-darwin12.2.0] 
```

操作系统：OSX

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:41:49.640

我在安装过程中弄混了一些东西，因为我试图使用 macports 和 rvm 却没有完全理解它们是如何工作的。我能够重新安装 ruby​​ 和 rails，它现在正在工作。

删除旧的 Ruby 文件/安装：

```
sudo rm -rf ~/.rvm
brew uninstall ruby
sudo rm /usr/local/bin/ruby 
```

安装 Ruby 和 Rails：

```
brew install ruby
gem install bundler
gem install rails 
```

# css - 试图针对前 5 个孩子并失败了

> ID：12900793
> 
> 赞同：0
> 
> 时间：2012-10-15T17:21:58.563
> 
> 标签：css, css-selectors

有了这个

```
a:nth-child(n)::before
{
    content: "› ";
}

a:nth-child(n+1)::before
{
    content: "›› ";
}

a:nth-child(n+2)::before
{
    content: "››› ";
}

a:nth-child(n+3)::before
{
    content: "›››› ";
}

a:nth-child(n+4)::before
{
    content: "››››› ";
} 
```

我想得到

› a1

>> a2

››› a3

›››› a4

››››› a5

但它不起作用...需要帮助，也尝试使用 1,2,3,4,5 而不是 n+1 等...但这也不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:34:26.380

你已经在做的应该可以工作，即使它可能不是最好的方法。

这是一个[编辑后的版本](http://jsfiddle.net/gionaf/sY6Zc/)：

```
a {
    display:block;
}
a:nth-child(1):before {
    content: "› ";
}
a:nth-child(2):before {
    content: "›› ";
}
a:nth-child(3):before {
    content: "››› ";
}
a:nth-child(4):before {
    content: "›››› ";
}
a:nth-child(5):before {
    content: "››››› ";
}​ 
```

使用此 HTML：

```
<a href="#">1</a><a href="#">2</a>
<a href="#">3</a><a href="#">4</a>
<a href="#">5</a>​ 
```

但不适用于此：

```
<a href="#">1</a><a href="#">2</a>
<a href="#">3</a><a href="#">4</a>
<div>5</div>
<a href="#">6</a>​ 
```

So, unless your layout is exactly the first one, you probably want to use [nth-of-type](http://www.w3schools.com/cssref/sel_nth-of-type.asp).

You can also use [a single colon `:before`](http://www.impressivewebs.com/before-after-css3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:26:13.433

我想我还没有太多使用该功能，但似乎你必须指定`n+1`为你的第一个并从那里开始：

```
a:nth-child(n+1)::before
{
  content: "› ";
}

a:nth-child(n+2)::before
{
  content: "›› ";
}

a:nth-child(n+3)::before
{
  content: "››› ";
}

a:nth-child(n+4)::before
{
  content: "›››› ";
}

a:nth-child(n+5)::before
{
  content: "››››› ";
} 
```

演示：http: [//jsbin.com/aboxop/1](http://jsbin.com/aboxop/1)

来源：http: [//jsbin.com/aboxop/1/edit](http://jsbin.com/aboxop/1/edit)

编辑：另外，正如@GionaF 在他的评论中所说，这只会在某些浏览器中得到支持。（那些支持 CSS 选择器级别 3 的）

# android - 如何在 android 中获取 pin 号密码键盘？

> ID：12900795
> 
> 赞同：6
> 
> 时间：2012-10-15T17:22:11.890
> 
> 标签：android, passwords, numbers, android-edittext

我需要一个 PIN 上的数字键盘`EditText`。我尝试使用

```
android:inputType="number|textPassword" 
```

这会调出数字键盘，但字符不是密码字符。

如何获得显示密码字符的数字键盘`EditText`？

该应用程序在 2.2 及更高版本上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:37:21.480

你应该看看这里： [Edittext set for password with phone number input? （安卓）](https://stackoverflow.com/questions/2017674/edittext-set-for-password-with-phone-number-input-android)

它声明 `android:password`已弃用，但这是唯一的方法，因为`android:inputType="phone|textPassword"`被忽略了......

```
<EditText
    android:id="@+id/EditText01"
    android:layout_height="wrap_content"
    android:layout_width="fill_parent"
    android:password="true"
    android:inputType="phone" 
/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-10T17:57:59.423

在我的 styles.xml 中，这两个似乎对我有用：

```
<item name="android:inputType">numberPassword</item>
<item name="android:password">true</item> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T00:03:41.923

这有效：

```
 <EditText
         android:id="@+id/pinEdit"
         android:layout_width="match_parent"
         android:layout_height="wrap_content"
         android:layout_margin="4dp"
         android:digits="1234567890"
         android:inputType="textPassword"
         android:maxLength="4" >

         <requestFocus />
     </EditText> 
```

如果数字对你有用。

编辑：啊，我明白了，它没有调出数字键盘……回到绘图板。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-07T09:56:33.213

使用：“numberSigned|numberPassword”

# iad - 如何在xcode中同时实现滑动导航菜单和iAd？

> ID：12900799
> 
> 赞同：1
> 
> 时间：2012-10-15T17:22:47.177
> 
> 标签：iad, submenu

我正在尝试使用 github 上的 JWSlideMenu 项目和bannerView Controller 一起实现滑动菜单。这两个代码都想成为 AppDelegate.m 中的根视图控制器，但我只能实现一个？有什么办法吗？

例子

```
self.window.rootViewController = slideMenu; 
```

或者

```
 self.window.rootViewController = _bannerViewController; 
```

任何帮助，将不胜感激。

# python - Python 3：创建一个字母金字塔

> ID：12900800
> 
> 赞同：0
> 
> 时间：2012-10-15T17:22:48.423
> 
> 标签：python, python-3.x

我正在尝试创建一个高度为 291 行的文本金字塔。我的意思是：

```
Here is an example of a pyramid of height 6:   
 -----a-----    
----bcd----   
---efghi---  
--jklmnop--  
-qrstuvwxy-  
zabcdefghij  

Notice:   
-- each line has the same number of characters  
-- the letters a-z form the pyramid, and are re-used. 
```

到目前为止，我所拥有的是：

```
letters="abcdefghijklmnopqrstuvwxyz"
#(291*2)-1
for i in range (581): 
```

我真的很想学习如何做到这一点，因此将不胜感激任何帮助或朝着正确方向前进，而不是答案本身:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T17:28:43.030

```
from itertools import cycle, islice

letters = "abcdefghijklmnopqrstuvwxyz"
height = 6
width = height*2-1

it = cycle(letters)
for count in range(1, width+1, 2):
    print(''.join(islice(it, count)).center(width, '-')) 
```

此解决方案使用[***itertools***](http://docs.python.org/dev/library/itertools.html)模块。
该[**`cycle`**](http://docs.python.org/dev/library/itertools.html#itertools.cycle)函数创建了一个迭代器，它无限地重复我们的字母序列，并[**`islice`**](http://docs.python.org/dev/library/itertools.html#itertools.islice)用于`count`每次从中获取下一个字母（因为它们被逐个字符地吐出，我们用 将它们变成一个字符串）。所以我们有下一行，但没有破折号。剩下的很简单：就是它。`''.**[join](http://docs.python.org/dev/library/stdtypes.html#str.join)**(...)`[**`center`**](http://docs.python.org/dev/library/stdtypes.html#str.center)

* * *

另一个非常相似的解决方案，只是没有*itertools*：

```
letters = "abcdefghijklmnopqrstuvwxyz"
height = 6
width = height*2-1

buf = ""
def next_letters(n):
    global buf, letters
    while len(buf)<n:
        buf += letters
    ret, buf = buf[:n], buf[n:]
    return ret

for count in range(1, width+1, 2):
    print(next_letters(count).center(width, '-')) 
```

( `buf`buffer) 变量将保存序列中的下一个字母。该`next_letters`函数将检查其中是否有足够的字母并根据需要对其进行扩展，然后返回其第一个`n`字母并“删除”它们。

让我们看看它如何与“调试版本”一起工作：

> ```
> letters = "abcdefghijklmnopqrstuvwxyz"
> height = 6
> width = height*2-1
> 
> buf = ""
> def next_letters(n):
>     global buf, letters
>     print("Requested {} letters. Buffer is '{}'".format(n, buf))
>     while len(buf)<n:
>         buf += letters
>         print("Buffer was extended to '{}'".format(buf))
>     ret, buf = buf[:n], buf[n:]
>     print("Returned '{}'; buffer is now '{}'".format(ret, buf))
>     return ret
> 
> for count in range(1, width+1, 2):
>     print(next_letters(count).center(width, '-')) 
> ```
> 
> 要求 1 封信。缓冲区是 ''
> 缓冲区被扩展为 'abcdefghijklmnopqrstuvwxyz'
> 返回 'a'; 缓冲区现在是 'bcdefghijklmnopqrstuvwxyz'
> -----a-----
> 请求 3 个字母。缓冲区是 'bcdefghijklmnopqrstuvwxyz'
> 返回 'bcd'; 缓冲区现在是 'efghijklmnopqrstuvwxyz'
> ----bcd----
> 请求 5 个字母。缓冲区是 'efghijklmnopqrstuvwxyz'
> 返回 'ef​​ghi'；缓冲区现在是 'jklmnopqrstuvwxyz'
> ---efghi---
> 请求 7 个字母。缓冲区是 'jklmnopqrstuvwxyz'
> 返回 'jklmnop'; 缓冲区现在是 'qrstuvwxyz'
> --jklmnop--
> 请求 9 个字母。缓冲区是'qrstuvwxyz'
> 返回'qrstuvwxy'；缓冲区现在是“z”
> -qrstuvwxy-
> 请求了 11 封信。缓冲区为 'z'
> 缓冲区已扩展为 'zabcdefghijklmnopqrstuvwxyz'
> 返回 'zabcdefghij'; 缓冲区现在是 'klmnopqrstuvwxyz'
> zabcdefghij

# gem - Windows 上的 Puppet gem 提供程序

> ID：12900802
> 
> 赞同：1
> 
> 时间：2012-10-15T17:22:55.957
> 
> 标签：gem, puppet

我正在使用 Puppet Agent for Windows 3.0 版，并且我试图将**gem**提供程序与以下资源一起使用

```
package { 'nokogiri':
    ensure => '1.5.5',
    provider => 'gem'
} 
```

似乎当我执行**应用**命令时，gem 安装在 ruby​​ 1.8.7 目录中，该目录捆绑在 Windows 的 puppet 客户端安装程序中。

我正在尝试在 Windows 上安装 Ruby 1.9.3 作为单独的包，可用于其他目的。

```
class ruby{

file {'ruby':
    name => 'C:\Temp\rubyinstaller-1.9.3-p194.exe',
    ensure => present,
    source => 'V:\shardata\Puppet\rubyinstaller-1.9.3-p194.exe'
}

exec { 'ruby':
        command => 'C:\Temp\rubyinstaller-1.9.3-p194.exe /verysilent /dir="C:\ruby" /tasks="assocfiles,modpath"',
        require => File["ruby"]
    }

package { 'nokogiri':
    ensure => 'latest',
    provider => 'gem',
    require => Exec['ruby']
}

} 
```

我应该在 Windows 上使用 Exec 资源类型而不是 package/gem 组合吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T13:34:00.640

当我要安装多个 rubies 时，我使用 rvm (http://rvm.io)。它非常容易安装并处理设置您的环境、红宝石和宝石集。我建议明确设置您的 ruby​​（1.9.3 或 1.8.7 等）和 gemset 并采购 rvm 以确保设置您的环境。

# hadoop - Hadoop重用Job对象

> ID：12900809
> 
> 赞同：0
> 
> 时间：2012-10-15T17:23:22.337
> 
> 标签：hadoop, reset, jobs

我有一个作业池，我从中检索作业并启动它们。模式类似于：

```
 Job job = JobPool.getJob();
    job.waitForCompletion();
    JobPool.release(job); 
```

当我尝试重用作业对象时遇到问题，因为它甚至没有运行（很可能是因为它的状态是：已完成）。因此，在下面的代码片段中，第二个`waitForCompletion`调用会打印作业的统计信息/计数器，并且不执行任何其他操作。

```
 Job jobX = JobPool.getJob();
    jobX.waitForCompletion();
    JobPool.release(jobX);

    //.......

    Job jobX = JobPool.getJob();
    jobX.waitForCompletion(); // <--- here the job should run, but it doesn't 
```

当我说作业实际上没有运行时，我是对的吗，因为 hadoop 将其状态视为已完成并且它没有尝试运行它？如果是，您知道如何重置作业对象以便我可以重用它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T22:07:23.547

The [Javadoc](http://hadoop.apache.org/docs/mapreduce/current/api/org/apache/hadoop/mapreduce/Job.html) includes this hint that the jobs should only run once

> The set methods only work until the job is submitted, afterwards they will throw an IllegalStateException.

I think there's some confusion about the job, and the view of the job. The latter is the thing that you have got, and it is designed to map to at most one job running in hadoop. The view of the job is fundamentally light weight, and if creating that object is expensive relative to actually running the job... well, I've got to believe that your jobs are simple enough that you don't need hadoop.

Using the view to submit a job is potentially expensive (copying jars into the cluster, initializing the job in the JobTracker, and so on); conceptually, the idea of telling the jobtracker to "rerun " or "copy ; run ", makes sense. As far as I can tell, there's no support for either of those ideas in practice. I suspect that hadoop isn't actually guaranteeing retention policies that would support either use case.

# ruby - Perl AES 与 Ruby AES

> ID：12900816
> 
> 赞同：-1
> 
> 时间：2012-10-15T17:23:43.210
> 
> 标签：ruby, perl, encryption, aes

我无法让 Perl 和 Ruby 就 CBC AES 达成一致：

**Perl**

```
use Crypt::CBC;
use MIME::Base64::Perl;

my $cipher = Crypt::CBC->new(
        -key         => 'd2cb415e067c7b13',
        -iv          => 'e36dc751d0433f05', #random 16chars!!!!!! shold NOT repeat between requests
        -cipher      => 'OpenSSL::AES',     #this is same as Rijndael
        -literal_key => 1,        
        -header      => "none",
        -keysize     => 16
  );  

$encypted = $cipher->encrypt("a really really long long text has differrent results???");
$base64 = encode_base64($encypted);

print("Ciphertext(b64): $base64");

$de_base64 = decode_base64($base64);
$decrypted = $cipher->decrypt($de_base64);
$c = $cipher->finish; 
```

> 密文（b64）：qz4eSQaFkQUkDOyJSbZf5W03HoldwtgvTLq0yJFRViKJnytf3PVSCGW2CYDjO+tRqV20oxeB2VPa 7NqN1TDSNQ==

节后有一个换行符`2VPa`，末尾有一个换行符

**红宝石**

```
require 'openssl'
require 'digest/sha2'
require 'base64'

message = "a really really long long text has differrent results???" 
cipher = OpenSSL::Cipher.new('aes-128-cbc')

# digest the key, iv and hmac_key so we have 16-byte length 
# also, it looks more of a funky password
# prepare cipher
cipher.encrypt
cipher.key = aes_key = "d2cb415e067c7b13"
cipher.iv = aes_iv = "e36dc751d0433f05"

encrypted = cipher.update(message)
encrypted << cipher.final()
b64_encoded = Base64.encode64(encrypted).encode('utf-8') #strict_encode64 guarantees no newlines, encode64 is default

puts "AES Key        : '#{aes_key}'"
puts "AES IV         : '#{aes_iv}'"
puts "Ciphertext(b64): '#{b64_encoded}'" 
```

> 密文（b64）：'qz4eSQaFkQUkDOyJSbZf5W03HoldwtgvTLq0yJFRViKJnytf3PVSCGW2CYDj O+tRqV20oxeB2VPa7NqN1TDSNQ=='

注意前后的`newlines`字符`CYDj``==`

我看过以下内容：[Perl & Ruby exchange AES encrypted information](https://stackoverflow.com/questions/1628566/perl-ruby-exchange-aes-encrypted-information)，但我没有使用`padding=0`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T17:27:19.757

换行符在 Base64 中并不重要。您从两种语言中得到完全相同的结果。

虽然绝对没有理由这样做，但您可以让 Perl 版本返回与 Ruby 版本相同的字符串，如下所示：

```
$base64 = encode_base64($encypted, '');
$base64 =~ s/\G.{60}\K/\n/sg; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T17:26:45.127

该`encode_base64`函数采用第二个参数，称为“eol”（行尾），默认情况下为“\n”。

> 返回的编码字符串被分成每行不超过 76 个字符的行，并且它将以 $eol 结尾，除非它为空

尝试：

```
$base64 = encode_base64($encypted, ''); 
```

反而。

# c - 将txt文件的每个字符存储到数组中

> ID：12900823
> 
> 赞同：1
> 
> 时间：2012-10-15T17:24:11.017
> 
> 标签：c

我想要做的是读取一个 txt 文件并将我的文件的每个字符存储在一个带有 char 成员的结构中。

这是我的代码：

```
typedef struct charClass {
  char simbolo;
  int freq;
} charClass; 
```

这是 main 的重要部分：

```
 input = fopen("testo1.txt", "r");  

 fseek(input, 0, SEEK_END); //Mi posiziono alla fine del file
 int dim = ftell(input); //Ottengo il puntatore corrente (n char)
 fseek(input, 0, SEEK_SET); //Rimetto il puntatore all'inizio del file

 char tmpChar;
 charClass *car;
 car = malloc(dim*sizeof(int));

 int i = 0;

 while (!feof(input)) {
   tmpChar = getc(input);
   car[i].simbolo = tmpChar; 
   printf("\n%c", car[i].simbolo);
   car[i].freq++; 
   i++;
 } 
```

它崩溃了。

我试图在网上搜索，但没有找到答案。

我也尝试使用 fscanf 和 strcpy，但无法正常工作。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:26:06.457

您没有为 charClass 结构分配足够的空间。尝试用这个替换 malloc：

```
car = malloc(dim * sizeof(charClass)); 
```

另外，我不确定您使用索引 i 索引的内容。您似乎没有创建一个 charClasses 数组...？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:38:42.227

从代码的外观来看，您正在尝试存储某个字符在文件中出现的次数。为此，我建议您编写一个哈希函数并将其存储到一个哈希表中。这将更快，更不容易出错。

```
struct hash_blob{
   char character;
   int freq;
};
static struct hash_blob hashTable[52]; /*[A-Za-z]*//*Extend this size to include special characters*/

void setZero()
{
    int i = 0;
    for(i = 0; i < 52; i++) hashTable[i].freq = 0;
}
int compute_hash(char ch)
{
    if(ch >= 'A' && ch <= 'Z'){
       return ch-'A';
    }
    if(ch >= 'a' && ch <= 'z'){
       return ch - 'a' + 26;
    }
}

void add_hash(char ch)
{
    int loc = compute_hash(ch);
    hashTable[loc].character = ch;
    hashTable[loc].number++;
}

int main(int argc, char *argv[])
{
    int ch;
    char filename = "testo1.txt";
    FILE *f = (FILE *)fopen(filename,"r");
    if(f == NULL)return 1;
    while((ch = getc(f)) != EOF){
       add_hash(ch);
    }
    for(ch = 0; ch < 52; ch++)
    {
         printf("The number of times %c appears in the file is: %d times\n",hashTable[ch].character, hashTable[ch].number);  
    }
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:32:27.367

您可以通过初始化 char 数组并使用 fgets() 函数轻松完成此操作。

```
char buffer[50];
while(fgets(buffer,50,fp))//fp is the file pointer
  {
 /*Code for checking buffer elements and you can store them in your chosen array*/
  } 
```

# java - 如何将 HTTP 请求转发回浏览器？代理 Java

> ID：12900825
> 
> 赞同：0
> 
> 时间：2012-10-15T17:24:23.237
> 
> 标签：java, http, proxy, request

```
final int portNumber = 8128;
String str;

int start = 0;
int endSg = 0;
int endCom = 0;

String ReqWeb=null;

System.out.println("Creating server socket on port " + portNumber);
ServerSocket serverSocket = new ServerSocket(portNumber);

BufferedReader inFromServer;
OutputStream out;
PrintWriter outw;   
Socket forwardSocket = null;

while (true)
{
    Socket socket = serverSocket.accept();              //get client request
    String from = socket.getInetAddress().toString();
    System.out.println("Accepted connection from " + from);
    OutputStream os = socket.getOutputStream();
    PrintWriter pw = new PrintWriter(os, true);
    pw.println("What's your request?");

    BufferedReader br = new BufferedReader(new InputStreamReader(socket.getInputStream()));

    //System.out.println(str);
    while((str = br.readLine())!=null){
        System.out.println(str);     
        if(str!=null){
            start = str.indexOf("Host: ") + 6;
            endSg = str.indexOf(".sg", start) + 3;
            endCom = str.indexOf(".com", start) + 4;
            if(((endSg>3)||(endCom>4))&&(start>4)){
                if(endSg>3)
                    ReqWeb = str.substring(start, endSg);
                else if(endCom>3)
                    ReqWeb = str.substring(start, endCom);              
            }

        }
    }
    System.out.println(ReqWeb);

    if(ReqWeb!=null){
        //ReqWeb = str.substring(start);
        System.out.println(ReqWeb);
        forwardSocket = new Socket(ReqWeb, 80);
    }

    pw.println(str);
    pw.println(ReqWeb);     
    //socket.close();

    if(forwardSocket!=null){
        inFromServer = new BufferedReader(new InputStreamReader(forwardSocket.getInputStream()));
        out = forwardSocket.getOutputStream();
        outw = new PrintWriter(out, false);
        outw.print(str);
    }

} 
```

### 输出 ：

```
Creating server socket on port 8128
Accepted connection from /127.0.0.1
null
Accepted connection from /127.0.0.1
GET (http://)stackoverflow.com/questions/12900825/how-do-i-forward-the-http-request-back-to-the-browser-proxy-java HTTP/1.0
Host: stackoverflow.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:15.0) Gecko/20100101 Firefox/15.0.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Proxy-Connection: close
Pragma: no-cache 
```

现在这是我得到的输出，我应该存储在字节数组中以将其发送回服务器以请求页面吗？我仍然无法转发此请求）：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:29:53.570

您需要为预期目标打开另一个套接字（根据 firefox 的请求）并在那里发送请求。保持连接到 firefox 的套接字打开，因为当您从预期目标获得响应时，您将从目标读取它并将其写回 firefox。根据您在 Firefox 中的流水线设置，连接可能会关闭或发出更多请求。

# git - zlib 在共享主机上安装 GIT 时出错

> ID：12900826
> 
> 赞同：4
> 
> 时间：2012-10-15T17:24:26.487
> 
> 标签：git, unix, zlib

我正在尝试按照本指南将 git 安装到我的 UK2 共享托管服务器上：

[http://www.randallkent.com/development/install-git-on-a-cpanel-shared-hosting-account](http://www.randallkent.com/development/install-git-on-a-cpanel-shared-hosting-account)

当我收到以下错误时，我必须执行最后几个步骤“make”和“make install”：

```
config.status: executing config.mak.autogen commands
* new build flags
CC credential-store.o
In file included from credential-store.c:1:
cache.h:19:18: warning: zlib.h: No such file or directory
In file included from credential-store.c:1:
cache.h:21: error: expected specifier-qualifier-list before ‘z_stream’
make: *** [credential-store.o] Error 1 
```

我的托管服务提供商为我启用了 zlib 压缩，但我仍然无法安装 git。

有什么我遗漏的东西还是在我的托管服务器上不可能？

非常感谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-25T14:25:11.430

看来你必须安装zlib。如果您使用的是 Centos，请使用安装 zlib`yum install zlib-devel` 如果您使用的是 Debian，请使用安装 zlib `apt-get install zlib1g-dev`。如果您想从 [http://www.zlib.net/](http://www.zlib.net/)获取源 grep并安装它，如果您这样做，请确保您的系统中有 git。注意：如果您从 aptitude 包管理器或存储库安装 git，它将自动安装依赖项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-09-24T14:00:00.587

你只需要使用 ./configure --with-zlib={your zlib path}

它帮助我用这个选项编译 git。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-19T13:06:27.960

我与托管在其服务器上的客户端有同样的问题。但幸运的是，cpanel 带有一个 GIT 版本。它位于“/usr/local/cpanel/3rdparty/bin/git”

你可以在这里看到一个修复：http: [//www.codefuel.co.uk/cpanel-git-resolved/](http://www.codefuel.co.uk/cpanel-git-resolved/)

# .net - 将内置 UserProfile 映射到表中的 UserProfileId 列

> ID：12900829
> 
> 赞同：0
> 
> 时间：2012-10-15T17:24:37.143
> 
> 标签：.net, asp.net-mvc-3, entity-framework

我有一个有定义的表故事

```
public class Tale
{
    public int Id { get; set; }
    public string Title { get; set; }
    public string Text { get; set; }
    public DateTime ReleaseDate { get; set; }

    public int enum_TaleAuthorTypeId { get; set; }
    public virtual enum_TaleAuthorType enum_TaleAuthorType { get; set; }

    public int CommentableId { get; set; }
    public virtual Commentable Commentable { get; set; }
} 
```

当我在控制台中键入“update-database”时，我与 CommentableId 的一列和 enum_TaleAuthorTypeId 的一列有很好的关系。

现在，我想添加 UserProfile 并尝试输入如下内容：

```
public int UserProfileId { get; set; }
public virtual UserProfile UserProfile { get; set; } 
```

但是在添加迁移之后，我有这个：

```
AddColumn("dbo.Tales", "UserProfileId", c => c.Int(nullable: false));
AddColumn("dbo.Tales", "UserProfile_UserId", c => c.Int()); 
```

我应该如何只获得一列的价值？为什么要创建两列？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T22:23:03.547

问题在于，按照惯例，EF 期望主键为`UserProfile`，`Id`但您将其设置为`UserId`.

您可以更改 in 的属性名称，`UserId`以便`UserProfile`EF`Id`按约定推断键，或者覆盖约定并保留`UserId`为主键。

您可以使用属性覆盖约定，例如

```
[ForeignKey("UserProfileId")]
public virtual UserProfile UserProfile { get; set; } 
```

或使用 Fluent API，例如

```
protected override void OnModelCreating(ModelBuilder modelBuilder)
{
    modelBuilder.Entity<Tale>()
                .HasRequired(a => a.UserProfile)
                .WithMany()
                .HasForeignKey(u => u.UserProfileId);

} 
```

# asp.net-mvc - MVC 4 HttpPostedFileBase 始终为空

> ID：12900830
> 
> 赞同：1
> 
> 时间：2012-10-15T17:24:39.153
> 
> 标签：asp.net-mvc, razor

无论我尝试什么，我的帖子图像始终为空或对象引用未设置为对象的实例。

我有一个映射到表格的帖子类和图像类（首先使用 EF 代码）

这是我的代码：

看法：

```
<h2>Create</h2>
@using (Html.BeginForm("Create", "Admin", FormMethod.Post, new{ enctype =         "multipart/form-data" }))
{

@Html.ValidationSummary(true)

@Html.LabelFor(post => post.Post.Blog)
@Html.DropDownListFor(post => post.Post.BlogId, Model.BlogList)
@Html.LabelFor(post => post.Post.Category)
@Html.DropDownListFor(post => post.Post.CategoryId, Model.CategoryList)

@Html.LabelFor(post => post.Post.Title)
@Html.EditorFor(post => post.Post.Title)
<br />

@Html.LabelFor(post => post.Post.Content)
@Html.EditorFor(post => post.Post.Content)
    <br />
<input type="file" name="uploadImage" value="Upload" />
<input type="submit" value="Create" />
} 
```

行动方法：

```
 [HttpPost]
    public ActionResult Create(Post post, HttpPostedFileBase image)
    {

        if (ModelState.IsValid)
        {
            var postBlog = _repository.Blogs.Single(b => b.BlogId == post.BlogId);
            post.Created = DateTime.Now;
            postBlog.Posts.Add(post);

                PostImage newImage = new PostImage()
                                         {
                                             MimeType = image.ContentType,
                                             ImageData = new byte[image.ContentLength],
                                             PostId = post.PostId
                                         };
                _repository.AddImage(newImage);

            _repository.Save();
            return RedirectToAction("Index");

        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T17:30:32.190

嗬！问题是我在输入元素中设置了“值”，你只需要输入 type="file" name="Image" /> 就可以正确绑定

# performance - 如何优化这个 OpenCL Sobel 过滤器内核？

> ID：12900835
> 
> 赞同：3
> 
> 时间：2012-10-15T17:25:24.547
> 
> 标签：performance, optimization, opencl

我为 3x3 Sobel 滤波器编写了一个 OpenCL 内核，目前它在 2k x 2k 图像上以大约 17 毫秒的速度运行。这并不像我希望的那么快。有人对如何提高速度有任何建议吗？[我已经遵循了优化内核清单](http://software.intel.com/en-us/articles/tips-and-tricks-for-kernel-development/)上的大部分建议。我的处理器是 Intel i5-3450。工作组大小为 8x8，工作项的数量为高 x 宽 / 16，在我运行的图像上为 2048 x 128。

```
__kernel void localCacheSobelFilter(
  const __global char16* src, 
  __write_only __global float16* angle, 
  __write_only __global float16* mag, 
  const int width, 
  const int height)
{
  // Cache the data we're looking at in __local space
  const int row = get_global_id(0);
  const int col = get_global_id(1);

  const int cacheRow = get_local_id(0) + 1;
  const int cacheCol = get_local_id(1) + 1;

  __local char16 cache[BLOCK_SIZE + 2][BLOCK_SIZE + 2];

  cache[cacheRow][cacheCol] = src[ indexOf(row, col) ];

  // --- Deal with the boundary conditions
  // This adds in the rows above and below the local block,
  // ignoring the corners.
  const bool atTopRow = (cacheRow == 1);
  const bool atBottomRow = (cacheRow == BLOCK_SIZE);

  if(atTopRow) {
    cache[0][cacheCol] = src[ indexOf(row - 1, col) ];

  } else if (atBottomRow) {
    cache[BLOCK_SIZE + 1][cacheCol] = src[ indexOf(row + 1, col) ];
  }

  // This adds in the columns to the left and right of the local block,
  // ignoring the corners.
  const bool atLeftCol = (cacheCol == 1);
  const bool atRightCol = (cacheCol == BLOCK_SIZE);

  if(atLeftCol) { 
    cache[cacheRow][0].sf = src[ indexOf(row, col - 1) ].sf;

  } else if (atRightCol) {
    cache[cacheRow][BLOCK_SIZE + 1].s0 = src[ indexOf(row, col + 1) ].s0;
  }

  // Now finally check the corners
  const bool atTLCorner = atTopRow && atLeftCol;
  const bool atTRCorner = atTopRow && atRightCol;
  const bool atBLCorner = atBottomRow && atLeftCol;
  const bool atBRCorner = atBottomRow && atRightCol;

  if(atTLCorner) {
    cache[0][0].sf = src[ indexOf(row - 1, col - 1) ].sf;

  } else if (atTRCorner) { 
    cache[0][BLOCK_SIZE + 1].s0 = src[ indexOf(row - 1, col + 1) ].s0;

  } else if (atBLCorner) {
    cache[BLOCK_SIZE + 1][0].sf = src[ indexOf(row + 1, col - 1) ].sf;

  } else if (atBRCorner) {
    cache[BLOCK_SIZE + 1][BLOCK_SIZE + 1].s0 = src[ indexOf(row + 1, col + 1) ].s0;
  }

  barrier(CLK_LOCAL_MEM_FENCE); 

  //===========================================================================
  // Do the calculation

  //  [..., pix00]  upperRow  [pix02, ...]
  //  [..., pix10]  centerRow [pix12, ...]
  //  [..., pix20]  lowerRow  [pix22, ...]
  const char pix00 = cache[cacheRow - 1][cacheCol - 1].sf;
  const char pix10 = cache[cacheRow    ][cacheCol - 1].sf;
  const char pix20 = cache[cacheRow + 1][cacheCol - 1].sf;

  const char16 upperRow  = cache[cacheRow - 1][cacheCol];    
  const char16 centerRow = cache[cacheRow    ][cacheCol];
  const char16 lowerRow  = cache[cacheRow + 1][cacheCol];

  const char pix02 = cache[cacheRow - 1][cacheCol + 1].s0;
  const char pix12 = cache[cacheRow    ][cacheCol + 1].s0;              
  const char pix22 = cache[cacheRow + 1][cacheCol + 1].s0;

  // Do the calculations for Gy
  const char16 upperRowShiftLeft = (char16)(upperRow.s123456789abcdef, pix02);
  const char16 upperRowShiftRight = (char16)(pix00, upperRow.s0123456789abcde);

  const char16 lowerRowShiftLeft = (char16)(lowerRow.s123456789abcdef, pix22);
  const char16 lowerRowShiftRight = (char16)(pix20, lowerRow.s0123456789abcde);

  const float16 Gy = convert_float16(
    (upperRowShiftLeft + 2 * upperRow + upperRowShiftRight)
    - (lowerRowShiftLeft + 2 * lowerRow + lowerRowShiftRight));

  // Do the calculations for Gx
  const char16 centerRowShiftLeft = (char16)(centerRow.s123456789abcdef, pix12);
  const char16 centerRowShiftRight = (char16)(pix10, centerRow.s0123456789abcde);

  const float16 Gx = convert_float16(
    (upperRowShiftRight + 2 * centerRowShiftRight + lowerRowShiftRight)
    - (upperRowShiftLeft + 2 * centerRowShiftLeft + lowerRowShiftLeft));

  // Find the angle and magnitude
  angle[ indexOf(row, col) ] = 0.0; //atan2(Gy, Gx);
  mag[ indexOf(row, col) ] = ALPHA * max(Gx, Gy) + BETA * min(Gx, Gy);
} 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T07:38:20.350

在您的内核中，您有很多“如果”来避免边缘效应。但是对于 99% 的时间来说，这是耗时且无用的。我认为您可以更改 NDRangeKernel 中的全局工作大小并使用偏移量来避免边缘效应。

例如：偏移 = {1,1,0} GlobalWorkSize = { width-2, height-2,0}

# javascript - jQuery 文件上传不显示预览

> ID：12900836
> 
> 赞同：7
> 
> 时间：2012-10-15T17:25:25.537
> 
> 标签：javascript, jquery, file-upload, coffeescript

[jQuery File Upload](http://blueimp.github.com/jQuery-File-Upload/)插件当前不显示所选文件。有谁知道我可以如何解决这个问题？

我已经实现了“自定义”模板（见下文）；注意我不需要显示以前上传的材料，因此没有下载模板。

我已经检查（通过日志记录）`add`正在调用回调，并且正在调用`uploadTemplate`函数并返回预期值——由于某种原因，这些值根本没有附加到表示表中。

```
$('#fileupload').fileupload(
  acceptFileTypes: /(\.|\/)(gif)$/i
  uploadTemplateId: null
  downloadTemplateId: null
  uploadTemplate: (obj) ->
    rows = $()
    $.each(obj.files, (idx, file) ->
      temp = "<tr class='template-upload fade'><td class='preview'><span class='fade'></span></td><td class='name'></td>'<td class='size'></td>"
      if (file.error)
        temp += "<td class='error' colspan='2'></td>"
      else
        temp += "<td><div class='progress'><div class='bar' style='width:0%;'></div></div></td><td class='start'><button>Start</button></td>"
      temp += "<td class='cancel'><button>Cancel</button></td></tr>"
      row = $(temp)
      row.find('.name').text(file.name)
      row.find('.size').text(obj.formatFileSize(file.size))
      rows = rows.add(row)
      )
    return rows
  downloadTemplate: ->
    return $()
) 
```

**更新 10/16/2012** 我在文件上传的初始化中添加了以下内容：

```
 process: [{action: 'load', fileTypes: /^image\/(gif|jpeg|png)$/, maxFileSize: 2000000}, {action: 'resize', maxWidth: 1920, maxHeight: 1200, minWidth: 800, minHeight: 600}, {action: 'save'}] 
```

这确实会启动加载图像的尝试，但不幸的是，该尝试会导致以下错误。有谁知道是什么原因和/或如何解决它？

`Uncaught TypeError: undefined (loadImage) is not a function jquery.fileupload-fp.js:87`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-26T16:10:40.960

问题在于加载依赖项的顺序；[Load Image](https://github.com/blueimp/JavaScript-Load-Image)需要在其他核心依赖项之前加载。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-02-18T02:10:03.777

以正确的顺序加载依赖项解决了我的问题

*   加载图像/加载图像.js
*   加载图像/加载图像 ios.js
*   加载图像/加载图像方向.js
*   加载图像/加载图像-meta.js
*   加载图像/加载图像exif.js
*   加载图像/加载图像exif-map.js

    （或使用缩小版）

*   jquery.iframe-transport.js

*   jquery.fileupload.js
*   jquery.fileupload-process.js
*   jquery.fileupload-image.js
*   jquery.fileupload-audio.js
*   jquery.fileupload-video.js
*   jquery.fileupload-validate.js
*   jquery.fileupload-ui.js tmpl.js
*   画布到blob.js

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T16:44:23.207

您是否安装了为 JQuery 文件上传列出的所有要求？

根据[README](https://github.com/blueimp/jQuery-File-Upload)，可选要求之一是

[JavaScript 加载图像函数](https://github.com/blueimp/JavaScript-Load-Image)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-04-08T16:46:20.700

## 我的问题

它在 Mac 上运行良好，但在 Windows 上的 FireFox 和 IE 中无法运行

## 部分固定

我发现`bootstrap.js`在我的案例中包含了两次，一次在头文件中，第二次在 jquery 文件上传插件中。删除头文件中的那个将其修复到预览在页面刷新时显示但仍未显示的程度（`bootstrap.js`从 jquery 插件中删除并没有解决问题顺便说一句）

## 完全固定

挖掘了更多并尝试注释掉可能导致问题（冲突）的 .js 文件。`typeahead.bundle.min.js`通过从头文件中删除完全解决了我的问题。当添加图像而不需要刷新页面时，预览会在 IE 和 Firefox 中显示。

我还注释掉了`jquery-ui.js`页面上不需要的 btw，并发现了另一个重复的 js 文件以及清理过程的一部分。

## 密码错误

如果您将上传的文件存储在数据库中，如果数据库凭据错误，它将显示上传过程但不会看到预览。修复数据库凭据将修复预览问题。

# c# - 从 MediaElement 控件读取自定义编码网络流

> ID：12900837
> 
> 赞同：2
> 
> 时间：2012-10-15T17:25:26.793
> 
> 标签：c#, xaml, windows-8

我正在开发一个**Windows 8 Windows Store 应用程序 (XAML/C#)**，其中有一个***MediaElement***控件。*MediaElement*控件将*Uri*或*IRandomAccessStream*作为源。

在我的情况下，我有**一个指向自定义编码资源的 URI**作为输入（并且流是无穷无尽的，所以我需要能够在下载时读取它）。

我想做的是将我的*MediaPlayer*的源设置为我的 url，让播放器处理下载，但在需要读取某些内容时调用它，以便我可以动态解码它。

在 Silverlight 中，*[MediaStreamSource](http://msdn.microsoft.com/en-us/library/system.windows.media.mediastreamsource%28v=vs.95%29.aspx)*似乎是要走的路，但它在 WinRT 中[不存在（尽管存在轻量级实现示例](http://code.msdn.microsoft.com/windowsapps/MediaStreamSource-media-dfd55dff)）。

设置它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:21:40.800

[媒体扩展示例](http://code.msdn.microsoft.com/windowsapps/Media-extensions-sample-7b466096)应该是您正在寻找的。它解释了如何提供自己的解码器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T12:09:04.757

这是解决方案：我从微软的“ [MediaStreamSource 媒体扩展示例](http://code.msdn.microsoft.com/windowsapps/MediaStreamSource-media-dfd55dff)”开始，然后在 C# 中实现了我自己的*MediaStreamSource类。*然而，使用自定义媒体流源，我无法重用现有的下载机制，因此我基于 WinRT 的 HttpClient 类创建了自己的下载机制，效果很好。

最终配方是：

*   实现您的自定义媒体流源，以便 MediaElement 可以读取您的文件，
*   使用 HttpClient 类发出 HTTP 请求以逐块下载我的流并将其通过我的媒体源传递给我的媒体元素。

# mysql - 为什么在“JOIN (SELECT)”语句中使用别名会导致错误？

> ID：12900838
> 
> 赞同：0
> 
> 时间：2012-10-15T17:25:26.447
> 
> 标签：mysql, mysql-error-1054, mysql-error-1052, mysql-5.5

我正在使用 MySQL 5.5.16

我有以下查询，它本身就可以正常工作。

```
SELECT DISTINCT i.id, 
CASE WHEN e.date >  '2012-10-16'
THEN e.date
ELSE  '9999-99-99'
END AS date, 
CASE WHEN e.date >  '2012-10-16'
THEN time
ELSE  '99-99-99'
END AS time
FROM items AS i
LEFT JOIN expiration AS e ON ( e.item_id = i.id ) 
WHERE (
(
data >=  '2012-10-16'
AND e.valid=1
)
OR i.never_expires=1
)
AND i.valid=1
ORDER BY date ASC , time ASC 
LIMIT 0 , 10 
```

但是，当我将它包含在更大的查询中时，我得到一个错误`Column 'date' in where clause is ambiguous`。这是一个示例，上面的查询位于 a 内`JOIN`：

```
SELECT i.id, i.title, i.never_expires, 
CASE WHEN e.date>  '2012-10-16'
THEN e.date
ELSE  '9999-99-99'
END AS date, 
CASE WHEN e.date >  '2012-10-16'
THEN e.time
ELSE  '99-99-99'
END AS time, i.item_price AS price
FROM items AS i
LEFT JOIN expiration AS e ON ( e.item_id = i.id )
JOIN (
  SELECT DISTINCT i.id, 
  CASE WHEN e.date >  '2012-10-16'
  THEN e.date
  ELSE  '9999-99-99'
  END AS date, 
  CASE WHEN e.date >  '2012-10-16'
  THEN time
  ELSE  '99-99-99'
  END AS time
  FROM items AS i
  LEFT JOIN expiration AS e ON ( e.item_id = i.id ) 
  WHERE (
  (
  data>=  '2012-10-16'
  AND e.valid=1
  )
  OR i.never_expires=1
  )
  AND i.valid=1
  ORDER BY date ASC , time ASC 
  LIMIT 0 , 10
) AS ilist ON (i.id=ilist.id) 
WHERE (
(
date >=  '2012-10-16'
AND e.valid=1
)
OR i.never_expires=1
)
AND i.valid=1
ORDER BY dateASC , time ASC 
```

为什么它声称这`date`是模棱两可的？

PS我试过用a替换内部查询`date`的一部分，但这只会引发另一个错误......`AS date``inner_date``Unknown column 'inner_date' in 'where clause'`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T17:30:05.603

您正在将具有名为 的列的`expiration`表连接`date`到本身具有名为 的列（来自`CASE`表达式）的物化表`date`。`date`您应该使用您`WHERE`打算引用的任何表的别名来限定子句中的使用。

任何一个：

```
WHERE (
(
ilist.date >=  '2012-10-16'
AND e.valid=1
) 
```

或者：

```
WHERE (
(
e.date >=  '2012-10-16'
AND e.valid=1
) 
```

# c++ - libssh2 远程 ncurses 应用程序

> ID：12900839
> 
> 赞同：0
> 
> 时间：2012-10-15T17:25:27.343
> 
> 标签：c++, c, ncurses, libssh2

我正处于设计应用程序的初始阶段，该应用程序将使用 libssh2 库通过 ssh 连接到远程服务器。我想要的功能之一是能够与远程 ncurses 应用程序交互。我了解当连接 libssh2 并执行命令时，我将返回一个字符串，该字符串表示远程系统上命令的输出。但是，如果该命令启动 ncurses（图形）应用程序会怎样。我会得到什么输出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:31:19.187

只要您在另一端请求 pty，您的 ncurses 程序就会向您发送大量控制序列，指示光标位置、颜色等……您最终要做的是在为了与 ncurses 应用程序交互，因此您可能会搜索 vt100 终端仿真或类似的东西。

# xml - XSLT 转换不适用于包含组合标记的 XML 文件，例如 和一些特定的属性

> ID：12900840
> 
> 赞同：0
> 
> 时间：2012-10-15T17:25:28.840
> 
> 标签：xml, xslt, namespaces

我们正在尝试转换一个 XML 文件，该文件是 WMS 上的 GetCapabilities 操作的结果，但是组合的名称标签会引发错误，更准确地说，名称由两个单词组成的标签用冒号分隔，如以下来源：

1)

```
<OnlineResource xlink:type="simple" xlink:href="http://www.ign.es/wms-inspire/ign-base?SERVICE=WMS&"/> 
```

2)

```
<OnlineResource xlink:type="simple" xlink:href="http://www.ign.es/wms-inspire/ign-base?SERVICE=WMS&"/> 
```

3)

```
<inspire_vs:ExtendedCapabilities>
<inspire_common:MetadataUrl xsi:type="inspire_common:resourceLocatorType">
<inspire_common:URL>http://www.ign.es/csw-inspire/srv/es/csw?SERVICE=CSW&VERSION=2.0.2&REQUEST=GetRecordById&outputSchema=http://www.isotc211.org/2005/gmd&ElementSetName=full&ID=spaignwms_www.ign.es_wms-inspire_ignbase_2011</inspire_common:URL>
<inspire_common:MediaType>application/vnd.ogc.csw.GetRecordByIdResponse_xml
</inspire_common:MediaType>
</inspire_common:MetadataUrl>
<inspire_common:SupportedLanguages xsi:type="inspire_common:supportedLanguagesType">
<inspire_common:DefaultLanguage>
<inspire_common:Language>spa</inspire_common:Language>
</inspire_common:DefaultLanguage>
<inspire_common:SupportedLanguage>
<inspire_common:Language>eng
</inspire_common:Language>
</inspire_common:SupportedLanguage>
</inspire_common:SupportedLanguages>
<inspire_common:ResponseLanguage>
<inspire_common:Language>spa</inspire_common:Language>
</inspire_common:ResponseLanguage>
</inspire_vs:ExtendedCapabilities> 
```

还有属性： xmlns="http://www.opengis.net/wms", xlink="http://www.w3.org/1999/xlink", xsi="http://www.w3.org /2001/XMLSchema-instance" 包含在标签中，避免它正常工作：

```
<WMS_Capabilities srv="http://schemas.opengis.net/iso/19139/20060504/srv/srv.xsd" gmd="http://schemas.opengis.net/iso/19139/20060504/gmd/gmd.xsd" gco="http://schemas.opengis.net/iso/19139/20060504/gco/gco.xsd" inspire_vs="http://inspire.ec.europa.eu/schemas/inspire_vs/1.0" gml="http://schemas.opengis.net/gml" inspire_common="http://inspire.ec.europa.eu/schemas/common/1.0" version="1.3.0" updateSequence="2619" xmlns="http://www.opengis.net/wms" xlink="http://www.w3.org/1999/xlink" xsi="http://www.w3.org/2001/XMLSchema-instance" schemaLocation="http://www.opengis.net/wms http://inspire.ec.europa.eu/schemas/inspire_vs/1.0/inspire_vs.xsd"> 
```

目前，使转换工作的唯一方法是编辑原始 XML 以消除冲突部分，这种解决方案没有多大意义，因此欢迎任何解决此不便的想法

这是一个简单的 XSL 文件：

```
<?xml version="1.0" encoding="UTF-8"?>

<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/">
<html>
<head>
</head>
<body>
<h1>Get Capabilities Operation:</h1>
    <table border="1">
    <tr>
    <td> <xsl:value-of select="WMS_Capabilities/Service/Title"/> 
        <!--  it is not able to take the content that is within the label "Title"-->
    </td> 
    </tr>
    </table>
</body>
</html>
</xsl:template>
</xsl:stylesheet> 
```

这是 XML 文件的一部分

```
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="ign-base.xsl"?>

<WMS_Capabilities xmlns:srv="http://schemas.opengis.net/iso/19139/20060504/srv/srv.xsd" 
xmlns:gmd="http://schemas.opengis.net/iso/19139/20060504/gmd/gmd.xsd" 
xmlns:gco="http://schemas.opengis.net/iso/19139/20060504/gco/gco.xsd" 
xmlns:inspire_vs="http://inspire.ec.europa.eu/schemas/inspire_vs/1.0" 
xmlns:gml="http://schemas.opengis.net/gml" 
xmlns:inspire_common="http://inspire.ec.europa.eu/schemas/common/1.0" 
version="1.3.0" updateSequence="2619" xmlns="http://www.opengis.net/wms" 
xmlns:xlink="http://www.w3.org/1999/xlink" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.opengis.net/wms http://inspire.ec.europa.eu/schemas/inspire_vs/1.0/inspire_vs.xsd">  
  <Service>
    <Name>WMS</Name>
    <Title>Mapa base de España del Instituto Geográfico Nacional</Title>
    <Abstract>Servicio Web de Mapas conforme al perfil INSPIRE de ISO19128-WMS 1.3.0 que permite acceder a cartografía procedente de diversas bases de datos geográficos del  IGN España. Para escalas pequeñas se usa la Base Cartográfica Numérica 1:200.000 (BCN200) y datos estructurados procedentes del  SIGNA (Sistema de Información Geográfica NAcional); para escalas intermedias se usa la Base Topográfica Nacional 1:25.000 (BTN25) junto con la Base Cartográfica Numérica 1:25.000 (BCN25); para escalas grandes, información procedente del callejero oficial Cartociudad. Se muestra información geográfica perteneciente a los siguientes anexos de Inspire: 1) Nombres geográficos, Unidades administrativas, Direcciones, Redes de transporte, Hidrografía, Lugares protegidos (pertenecientes al Anexo I);  2) Elevaciones y Cubierta terrestre (pertenecientes al Anexo II); 3) Edificios, Servicios de utilidad pública y estatales, Instalaciones de producción e industriales e Instalaciones agrícolas y de acuicultura (pertenecientes al Anexo III). También se muestra información que bien por los tipos de objetos espaciales o la geometría que se utiliza para representarlos están fuera de Inspire. Son los siguientes: Paises, Fondo cartográfico, Manazanas urbanas, Aeropuertos y las capas contenidas en los grupos de capas Puertos, Islas y Sombreado. El resto de capas se han agrupado constituyendo grupos de capas equivalentes a capas Inspire cuya denominación es conforme con la Directiva INSPIRE 2007/2/EC (nombre, título y estilo Inspire por defecto). Todas las capas tienen asociado un estilo de visualización definido por el IGN y además, si pertenece a Inspire, el estilo Inspire por defecto.</Abstract>
    <KeywordList>
      <Keyword>WMS</Keyword>
      <Keyword>IDEE</Keyword>
      <Keyword>BCN200</Keyword>
      <Keyword>BCN25</Keyword>
      <Keyword>BTN25</Keyword>
      <Keyword>Cartografía</Keyword>
      <Keyword vocabulary="ISO 19119 geographic services taxonomy, version 2.3">infoMapAccessService</Keyword>
      <Keyword vocabulary="ISO 19119 geographic services taxonomy, version 2.3">infoManagementService</Keyword>
      <Keyword>España</Keyword>
      <Keyword>SIGNA</Keyword>
      <Keyword>Topográfico</Keyword>
      <Keyword>View</Keyword>
      <Keyword>WMS 1.3.0</Keyword>
      <Keyword>OGC</Keyword>
    </KeywordList>
    <OnlineResource xlink:type="simple" xlink:href="http://www.ign.es"/>
    <ContactInformation>
      <ContactPersonPrimary>
        <ContactPerson/>
        <ContactOrganization>Instituto Geográfico Nacional</ContactOrganization>
      </ContactPersonPrimary>
      <ContactPosition>PointOfContact</ContactPosition>
      <ContactAddress>
        <AddressType>Postal</AddressType>
        <Address>General Ibáñez de Íbero, 3</Address>
        <City>Madrid</City>
        <StateOrProvince>España</StateOrProvince>
        <PostCode>28003</PostCode>
        <Country>España</Country>
      </ContactAddress>
      <ContactVoiceTelephone>+34 91 597 96 61</ContactVoiceTelephone>
      <ContactFacsimileTelephone>+34 91 597 97 64</ContactFacsimileTelephone>
      <ContactElectronicMailAddress>ign@fomento.es</ContactElectronicMailAddress>
    </ContactInformation>
    <Fees>no conditions apply</Fees>
    <AccessConstraints>licencia</AccessConstraints>
  </Service>
  <Capability>
    <Request>
      <GetCapabilities>
        <Format>text/xml</Format>
        <DCPType>
          <HTTP>
            <Get>
              <OnlineResource xlink:type="simple" xlink:href="http://www.ign.es/wms-inspire/ign-base?SERVICE=WMS&amp;"/>
            </Get>
            <Post>
              <OnlineResource xlink:type="simple" xlink:href="http://www.ign.es/wms-inspire/ign-base?SERVICE=WMS&amp;"/>
            </Post>
          </HTTP>
        </DCPType>
      </GetCapabilities>
      <GetMap>
        <Format>image/png</Format>
        <Format>application/atom+xml</Format>
        <Format>application/pdf</Format>
        <Format>application/vnd.google-earth.kml+xml</Format>
        <Format>application/vnd.google-earth.kmz</Format>
        <Format>image/gif</Format>
        <Format>image/jpeg</Format>
        <Format>image/svg+xml</Format>
        <Format>image/tiff</Format>
        <DCPType>
          <HTTP>
            <Get>
              <OnlineResource xlink:type="simple" xlink:href="http://www.ign.es/wms-inspire/ign-base?SERVICE=WMS&amp;"/>
            </Get>
          </HTTP>
        </DCPType>
      </GetMap>
      <GetFeatureInfo>
        <Format>text/html</Format>
        <DCPType>
          <HTTP>
            <Get>
              <OnlineResource xmlns:xlink="http://www.w3.org/1999/xlink" xlink:type="simple" xlink:href="http://www.ign.es/wms-inspire/ign-base?SERVICE=WMS&amp;"/>
            </Get>
            <Post>
              <OnlineResource xmlns:xlink="http://www.w3.org/1999/xlink" xlink:type="simple" xlink:href="http://www.ign.es/wms-inspire/ign-base?SERVICE=WMS&amp;"/>
            </Post>
          </HTTP>
        </DCPType>
      </GetFeatureInfo>
    </Request>
    <Exception>
      <Format>XML</Format>
      <Format>INIMAGE</Format>
      <Format>BLANK</Format>
    </Exception>
    <inspire_vs:ExtendedCapabilities>
      <inspire_common:MetadataUrl xsi:type="inspire_common:resourceLocatorType">
        <inspire_common:URL>http://www.ign.es/csw-inspire/srv/es/csw?SERVICE=CSW&amp;VERSION=2.0.2&amp;REQUEST=GetRecordById&amp;outputSchema=http://www.isotc211.org/2005/gmd&amp;ElementSetName=full&amp;ID=spaignwms_www.ign.es_wms-inspire_ignbase_2011</inspire_common:URL>
        <inspire_common:MediaType>application/vnd.ogc.csw.GetRecordByIdResponse_xml</inspire_common:MediaType>
      </inspire_common:MetadataUrl>
      <inspire_common:SupportedLanguages xsi:type="inspire_common:supportedLanguagesType">
        <inspire_common:DefaultLanguage>
          <inspire_common:Language>spa</inspire_common:Language>
        </inspire_common:DefaultLanguage>
        <inspire_common:SupportedLanguage>
          <inspire_common:Language>eng</inspire_common:Language>
        </inspire_common:SupportedLanguage>
      </inspire_common:SupportedLanguages>
      <inspire_common:ResponseLanguage>
        <inspire_common:Language>spa</inspire_common:Language>
      </inspire_common:ResponseLanguage>
    </inspire_vs:ExtendedCapabilities>
    <Layer>
      <Title>Mapa base de España del Instituto Geográfico Nacional</Title>
      <Abstract>Servicio Web de Mapas conforme al perfil INSPIRE de ISO19128-WMS 1.3.0 que permite acceder a cartografía procedente de diversas bases de datos geográficos del  IGN España. Para escalas pequeñas se usa la Base Cartográfica Numérica 1:200.000 (BCN200) y datos estructurados procedentes del  SIGNA (Sistema de Información Geográfica NAcional); para escalas intermedias se usa la Base Topográfica Nacional 1:25.000 (BTN25) junto con la Base Cartográfica Numérica 1:25.000 (BCN25); para escalas grandes, información procedente del callejero oficial Cartociudad. Se muestra información geográfica perteneciente a los siguientes anexos de Inspire: 1) Nombres geográficos, Unidades administrativas, Direcciones, Redes de transporte, Hidrografía, Lugares protegidos (pertenecientes al Anexo I);  2) Elevaciones y Cubierta terrestre (pertenecientes al Anexo II); 3) Edificios, Servicios de utilidad pública y estatales, Instalaciones de producción e industriales e Instalaciones agrícolas y de acuicultura (pertenecientes al Anexo III). También se muestra información que bien por los tipos de objetos espaciales o la geometría que se utiliza para representarlos están fuera de Inspire. Son los siguientes: Paises, Fondo cartográfico, Manazanas urbanas, Aeropuertos y las capas contenidas en los grupos de capas Puertos, Islas  y Sombreado. El resto de capas se han agrupado constituyendo grupos de capas equivalentes a capas Inspire cuya denominación es conforme con la Directiva INSPIRE 2007/2/EC (nombre, título y estilo Inspire por defecto). Todas las capas tienen asociado un estilo de visualización definido por el IGN y además, si pertenece a Inspire, el estilo Inspire por defecto.</Abstract>
      <CRS>EPSG:4258</CRS>
      <CRS>EPSG:4326</CRS>
      <CRS>CRS:84</CRS>
      <CRS>EPSG:23029</CRS>
      <CRS>EPSG:23030</CRS>
      <CRS>EPSG:23031</CRS>
      <CRS>EPSG:25828</CRS>
      <CRS>EPSG:25829</CRS>
      <CRS>EPSG:25830</CRS>
      <CRS>EPSG:25831</CRS>
      <CRS>EPSG:4230</CRS>
      <EX_GeographicBoundingBox>
        <westBoundLongitude>-179.90</westBoundLongitude>
        <eastBoundLongitude>179.90</eastBoundLongitude>
        <southBoundLatitude>-89.90</southBoundLatitude>
        <northBoundLatitude>84.00</northBoundLatitude>
      </EX_GeographicBoundingBox>
      <Layer>
        <Name>GN.GeographicalNames</Name>
        <Title>Nombres geográficos</Title>
        <Abstract>Representación de datos espaciales correspondientes al tema "Nombres Geográficos" del Anexo I de la directiva INSPIRE.</Abstract>
        <CRS>EPSG:23029</CRS>
          <CRS>EPSG:23030</CRS>
          <CRS>EPSG:23031</CRS>
          <CRS>EPSG:25828</CRS>
          <CRS>EPSG:25829</CRS>
          <CRS>EPSG:25830</CRS>
          <CRS>EPSG:25831</CRS>
          <CRS>EPSG:4230</CRS>
          <EX_GeographicBoundingBox>
            <westBoundLongitude>-19.00</westBoundLongitude>
            <eastBoundLongitude>5.00</eastBoundLongitude>
            <southBoundLatitude>27.00</southBoundLatitude>
            <northBoundLatitude>44.00</northBoundLatitude>
          </EX_GeographicBoundingBox> 
```

以及带有完整 XML 答案的服务链接

[http://www.ign.es/wms-inspire/ign-base?request=GetCapabilities&service=WMS](http://www.ign.es/wms-inspire/ign-base?request=GetCapabilities&service=WMS)

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:30:30.613

您没有显示包含 WMS_Capabilities 等的 Xml 文档。如果 Service 和 Title 在同一个命名空间中，这样的事情应该会有所帮助：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:ns=""http://www.opengis.net/wms"">

<xsl:template match="/">
<html>
<head>
</head>
<body>
<h1>Get Capabilities Operation:</h1>
    <table border="1">
    <tr>
    <td> <xsl:value-of select="ns:WMS_Capabilities/ns:Service/ns:Title"/> 
        <!--  it is not able to take the content that is within the label "Title"-->
    </td> 
    </tr>
    </table>
</body>
</html>
</xsl:template>
</xsl:stylesheet> 
```

我将 namespace-uri 与“ns”前缀链接起来，并使用 XPath 表达式中的前缀来指示元素属于与前缀关联的命名空间。

# c# - JavascriptSerializer 反序列化成 Json 需要一个完整的类吗？

> ID：12900841
> 
> 赞同：0
> 
> 时间：2012-10-15T17:25:29.840
> 
> 标签：c#, json, serialization, javascriptserializer

使用 in 中的`Deserialize`方法时`JavascriptSerializer`，您的目标类中需要什么？

例如，我有一个包含人员的 JSON 字符串。每个人都包含一个姓名、年龄和性别。如果我只需要从这条消息中获取姓名和年龄，我的目标班级还需要性别部分吗？反序列化是否知道如何只从 JSON 字符串中获取现有字段并留下其他字段？以下是否可行（请注意，personinfo 中没有性别）？

```
List<person> mypeople = JavascriptSerializer.Deserialize <List<person>>(jsonstring);

class person
    {
        public List<personinfo> personinfo{ get; set; }
    }
class personinfo
    {
        public string name { get; set; }
        public int age { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T18:26:04.070

Deserialize() 了解如何忽略部分字符串。您只需在目标类中指定所需的字段。

我还发现这个问题的内容非常有用，因为我是 C# 新手——[使用 System.Web.Script.Serialization.JavascriptSerializer 反序列化 JSON——如何？](https://stackoverflow.com/questions/1450513/using-system-web-script-serialization-javascriptserializer-to-deserialize-json)

# assembly - 在 x86 中将 ASCII 十六进制数转换为 32 位二进制整数

> ID：12900846
> 
> 赞同：0
> 
> 时间：2012-10-15T17:25:54.147
> 
> 标签：assembly, x86, hex, base-conversion

所以我正在读取用户的 8 位输入，并将其保存到一个变量中。例如：

输入一个 8 位十六进制数：1ABC5678

所以，然后我循环遍历 1ABC5678 十六进制数，从数字 0-9 中减去 48，从 AF 中减去 55，以获得输入的数字表示。但这似乎是错误的。我的目标是将 8 位十六进制转换为八进制。我已经知道如何从二进制转换为八进制，那就是通过屏蔽和移动 32 位二进制数字。但我的问题是我获取二进制文件的方法是错误的。

我在英特尔 IA-32 上编码。x86。

### 更新数据

### 现在我得到了一个 32 位二进制变量名二进制文件。我想将其转换为八进制。关于如何移动 3by3 以获得正确的八进制数的任何想法？

到目前为止，这是我的代码：

```
; Now we have the Binary digits saved into the binary variable
; Lets convert into octal

octal_init:
mov     ecx, 11             ; initialize count
mov     edi, octal             ; point to start of new string
mov     eax, [binary]               ; get a character
MOV     edx, 00000000000000000000000000000000b ;Clear EDX

octal_cont:
MOV     dl, al
SHL     dl, 5
SHR     dl, 5

octal_top:
mov     [edi], dl               ; store char in new string
inc     edi                     ; update dest pointer
SHR     eax, 3
dec     ecx                     ; update char count
jnz     octal_cont                  ; loop to top if more chars 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T05:13:06.417

其中一些问题是：

*   输入字符串是换行符终止的，而不是空值终止的
*   一些逻辑错误

你可以这样写：

```
L1_init:
mov     ecx, 8                  ; initialize count
mov     esi, buf                ; point to start of buffer
mov     edi, binary             ; point to start of new string

L1_top:
mov     al, [esi]               ; get a character
inc     esi                     ; update source pointer

cmp       al, '0'               ; Compare al with ascii '0'
...
or        dl, al                           ; Merge in the four bits just computed
loop      L1_top                          ; Loop back for next byte to convert

mov     [edi], edx               ; store char in new string

L1_end: 
```

请注意，您已经检查过您有 8 个字符，因此无需在循环中再次执行此操作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-15T17:37:45.890

将 Hex 字符串转换为 int 值的最简单方法是使用 strtol()、strtoll() 或 strtoimax()：

```
#include <inttypes.h>
#include <stdlib.h>

intmax_t     max;
long         l;
long long    ll;
const char * str = "1ABC5678";

max = strtoimax(str, NULL, 16);
l   = strtol(str, NULL, 16);
ll  = strtoll(str, NULL, 16); 
```

或者，如果您愿意，也可以手动编写代码：

```
int          pos;
long         l;
const char * str = "1ABC5678";

l = 0;
for(pos = 0; str[pos]; pos++)
{
    l = l << 4; // each Hex digit represents 4 bits

    // convert ASCII characters to int value
    if ((str[pos] >= '0') && (str[pos] <= '9'))
       l += (str[pos] - '0') & 0x0F;
    else if ((str[pos] >= 'A') && (str[pos] <= 'F'))
       l += (str[pos] - 'A' + 10) & 0x0F;
    else if ((str[pos] >= 'a') && (str[pos] <= 'f'))
       l += (str[pos] - 'a' + 10) 0x0F;
}; 
```

# .net - .Net 2.0 X .Net 4.0 运算符重载

> ID：12900847
> 
> 赞同：1
> 
> 时间：2012-10-15T17:26:05.223
> 
> 标签：.net, overloading, operator-keyword

因为下面的代码有效。“Net 2.0”并不起作用。“网络4.0”？不添加方法有什么解决办法

```
Public Shared Operator >(ByVal variante1 As Double, ByVal variante2 As MyClass1) As Boolean
Public Shared Operator <(ByVal variante1 As Double, ByVal variante2 As MyClass1) As Boolean 
```

错误消息：重载解析失败，因为没有可访问的 '>' 对这些参数最具体：'公共共享运算符 >(variante1 As MyClass1，variante2 As MyClass1) As Boolean': Not most specific Public Shared Operator >(left as Double, right as Double) As Boolean': 不是最具体的

* * *

```
Public Class Form1

    Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load

      Dim value1 As New MyClass1
      Dim value2 As Double = 0

      Dim result As Boolean = value2 > value1

    End Sub
End Class

Public Class MyClass1

    Public Shared Operator >(ByVal variante1 As MyClass1, ByVal variante2 As MyClass1) As Boolean
        Return True
    End Operator

    Public Shared Operator <(ByVal variante1 As MyClass1, ByVal variante2 As MyClass1) As Boolean
        Return True
    End Operator

    Public Shared Widening Operator CType(ByVal valor As Double) As MyClass1
        Return New MyClass1(valor)
    End Operator

    Public Shared Widening Operator CType(ByVal valor As MyClass1) As Double
        Return 0
    End Operator

    Public Sub New()
    End Sub

    Public Sub New(valor As Double)
    End Sub

End Class 
```

# knockout.js - 将 ko.observableArray 绑定到 { value, text } 选项列表

> ID：12900851
> 
> 赞同：0
> 
> 时间：2012-10-15T17:26:06.727
> 
> 标签：knockout.js, ko.observablearray

这个[jsFiddle](http://jsfiddle.net/zneYc/)为我的目标显示了不正确的代码。我希望每次用户选择将这一天添加/删除到除日列表中的某一天。使用淘汰赛 2.1.0。

HTML：

```
<ul data-bind="foreach: bydayOptions">
    <li>
        <input type="checkbox" name="byday" data-bind="attr: {value: value, checked: $parent.byday().indexOf(value) >= 0}, event: {change: $parent.bydayHandler(value)}">
        <label data-bind="for: value"><b data-bind="text: $data.text"></b></label>
    </li>
</ul>

<b data-bind="text: ko.toJSON(byday())"></b>
​ 
```

JavaScript：

```
var viewModel = function(args) {
    var self = this;
    self.byday = ko.observableArray(args.byday);

    self.bydayOptions = [{
        text: "Monday",
        value: "Mon"
    }, {text: "Tuesday",
        value: "Tue"
    }, {text: "Wednesday",
        value: "Wed",
    }, {text: "Thursday",
        value: "Thu"
    }, {text: "Friday",
        value: "Fri"
    }, {text: "Saturday",
        value: "Sat"
    }, {text: "Sunday",
        value: "Sun"
    }];

    self.bydayHandler = function(d){
        console.debug(">>> inside the byday Handler");
        console.log(self.byday());
        if(d !== undefined){
            if(self.byday().indexOf(d) >= 0){
                self.byday().splice(self.byday().indexOf(d), 1);
            } else {
                self.byday().push(d);
            }
        }
    };
};

ko.applyBindings(new viewModel({byday: ["Mon"]})); 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:37:59.933

淘汰赛[检查](http://knockoutjs.com/documentation/checked-binding.html)绑定为您处理了很多。不需要事件处理程序。

这是一个更新的小提琴：http: [//jsfiddle.net/daedalus28/pmMZW/](http://jsfiddle.net/daedalus28/pmMZW/)

# shell - 使用 VBS 在后台运行批处理文件，不断收到“找不到文件”

> ID：12900854
> 
> 赞同：3
> 
> 时间：2012-10-15T17:26:16.280
> 
> 标签：shell, vbscript, arguments

我正在尝试运行使用 VBS 隐藏的批处理文件。我已经搜索了高低，但无论我做什么，我都无法让我的工作:(

这是我的代码：

```
If WScript.Arguments.Item(2) = "TV" Then
Set WShShell = WScript.CreateObject("WScript.Shell")
WShShell.Run "extractscipt.bat " & chr(34) & WScript.Arguments.Item(0) & chr(34) & " " & chr(34) & WScript.Arguments.Item(1) & chr(34) & " " & chr(34) & WScript.Arguments.Item(2) & chr(34), 0
    Set WShShell = Nothing
End If 
```

我不断收到的错误是“找不到文件”。

我的 bat 文件本身可以完美运行，我只是使用这个 VB 脚本来隐藏命令窗口。我包括的两个论点是路径，所以我需要引用它们:) 我希望你能帮助我。

这是我的 extractscript.bat 文件的内容：

```
set fromdir=%1
set name=%2
set label=%3
set todir=F:\%name%

if %label%==EXTRACT (
if not exist %todir% mkdir %todir%
"C:\Program Files\7-Zip\7z.exe" x "%fromdir%\*.rar" -o"%todir%"
exit
)
exit 
```

如果您对如何将这两个文件合并到一个隐藏程序中也有任何想法；）

* * *

# 编辑/更新

所以事实证明我需要添加完整路径，并且我在我的代码中也发现了一些错误。我不必添加 chr(34) ( " )，这只会把它搞砸:) 这是我正在使用的工作代码，以防有人也需要这个答案:)

```
If WScript.Arguments.Item(2) = "TV" Then
    Set WShShell = WScript.CreateObject("WScript.Shell")
    WShShell.Run """C:\Program Files (x86)\uTorrent\extractscript.bat"" "& WScript.Arguments.Item(0) & " " & WScript.Arguments.Item(1) & " " & WScript.Arguments.Item(2), 0
    Set WShShell = Nothing
End If 
```

# jquery - 获取复选框选定行的值

> ID：12900858
> 
> 赞同：1
> 
> 时间：2012-10-15T17:26:26.087
> 
> 标签：jquery, datatables

我通过这样做得到了复选框的价值

```
$('input:checked', oTable.fnGetNodes()).each(function(i){

            console.log(this);

        }); 
```

它给了我

```
<input type="checkbox" class="datatableCheckbox"> 
```

但是如何在同一行的数据表的其他列中获取其他值？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:29:37.807

> *如何在同一行的数据表的其他列中获取其他值？*

假设您正在处理一个 HTML 表格，那么您可以简单地获取最接近的`tr`并找到相应`td`的

```
$('input:checked', oTable.fnGetNodes()).each(function(i){
    console.log($(this)
       .closest('tr') //get the enclosing tr
       .find('td:eq(1)'));  //find any using td:eq(<index>)
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:29:13.057

在你的循环中试试这个：

```
$(this).closest('tr').find('input[type="checkbox"]').each(function(i, checkbox){
    console.log($(checkbox).val());
}); 
```

或者，如果您想要来自所有表单元素的值：

```
$(this).closest('tr').find(':input').each(function(i, input){
    console.log($(input).val());
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:29:17.273

试试这个

```
$(oTable.fnGetNodes()).find('td').each(function(i){

      console.log(this);  // This will give you the td for each row..

}); 
```

假设`oTable.fnGetNodes()`返回表中的**tr**

# r - 在 R 中编写“查找和替换某些空单元格”功能

> ID：12900860
> 
> 赞同：0
> 
> 时间：2012-10-15T17:26:27.247
> 
> 标签：r, data-manipulation

我有一个大致如下所示的数据框：

```
March_created_at    March_email March_type  April_created_at April_email    April_type
3/11/12 7:28    jeremy@asynk.ch PushEvent   4/1/12 4:03                     PushEvent
3/11/12 7:28    jeremy@asynk.ch PushEvent   4/1/12 4:03                     PushEvent
3/11/12 7:28    jeremy@asynk.ch PushEvent   4/1/12 4:03                     PushEvent
3/11/12 7:28    jeremy@asynk.ch PushEvent   4/1/12 7:03     high            IssuesEvent
3/11/12 11:06   medium          PushEvent   4/1/12 13:57    medium          PushEvent
3/11/12 11:06   medium          PushEvent   4/1/12 13:57    medium          PushEvent
3/11/12 11:06   medium          PushEvent   4/1/12 13:57    medium          PushEvent
3/11/12 12:46                   PushEvent   
3/11/12 12:46                   PushEvent   
3/11/12 12:46                   PushEvent 
```

完整的数据集可以在[这里](https://github.com/aronlindberg/VOSS-Sequencing-Toolkit/blob/master/rubinius_rubinius_sequencing/output.csv)以 CSV 文件的形式找到

现在，我正在使用一个函数（感谢 Hadley Wickham）用字符串（例如“high”和“medium”）替换某些电子邮件地址。

```
# the find-and-replace function
replace_all <- function(df, pattern, replacement) {
  char <- vapply(df, function(x) is.factor(x) || is.character(x), logical(1))
  df[char] <- lapply(df[char], str_replace_all, pattern, replacement)  
  df
}

# the function call
df.new <- replace_all(df, fixed("bford@engineyard.com"), "core") 
```

但是，有些单元格没有写入任何内容（例如“March_email”列中的第 8-10 行）。*如果*以下条件成立，我想找到所有这些单元格并用字符串“low”替换它们：

*同月附有日期（例如第8-10行的“March_created_at”列中有日期，因此“March_email”中的空单元格表示缺少需要替换的数据）

这意味着如果在电子邮件列中有空白单元格的那一行没有附加日期（例如，4 月的第 8-10 列），则不应在那里替换任何内容。根本没有该范围的数据。

我怎样才能在 R 中做到这一点？

**附录：**这是数据集头部的 dput()：

```
structure(list(March_created_at = c("2012-03-11 07:28:04", "2012-03-11 07:28:04", 
"2012-03-11 07:28:04", "2012-03-11 07:28:19", "2012-03-11 07:28:19", 
"2012-03-11 07:28:19"), March_actor_attributes_email = c("jeremy@asynk.ch", 
"jeremy@asynk.ch", "jeremy@asynk.ch", "jeremy@asynk.ch", "jeremy@asynk.ch", 
"jeremy@asynk.ch"), March_type = c("PushEvent", "PushEvent", 
"PushEvent", "PushEvent", "PushEvent", "PushEvent"), April_created_at = c("2012-04-01     04:03:13", 
"2012-04-01 04:03:13", "2012-04-01 04:03:13", "2012-04-01 07:03:11", 
"2012-04-01 07:03:11", "2012-04-01 07:03:11"), April_actor_attributes_email = c("", 
"", "", "high", "high", "high"), April_type = c("PushEvent", 
"PushEvent", "PushEvent", "IssuesEvent", "IssuesEvent", "IssuesEvent"
), May_created_at = c("2012-05-01 00:16:05", "2012-05-01 00:16:05", 
"2012-05-01 00:16:05", "2012-05-01 01:03:19", "2012-05-01 01:03:19", 
"2012-05-01 01:03:19"), May_actor_attributes_email = c("john.firebaugh@gmail.com", 
"john.firebaugh@gmail.com", "john.firebaugh@gmail.com", "mitch.tishmack@gmail.com", 
"mitch.tishmack@gmail.com", "mitch.tishmack@gmail.com"), May_type = c("PushEvent", 
"PushEvent", "PushEvent", "IssueCommentEvent", "IssueCommentEvent", 
"IssueCommentEvent"), June_created_at = c("2012-06-01 00:25:05", 
"2012-06-01 00:25:05", "2012-06-01 00:25:05", "2012-06-01 00:42:29", 
"2012-06-01 00:42:29", "2012-06-01 00:42:29"), June_actor_attributes_email =     c("michaelklishin@me.com", 
"michaelklishin@me.com", "michaelklishin@me.com", "", "", ""), 
    June_type = c("IssueCommentEvent", "IssueCommentEvent", "IssueCommentEvent", 
    "PushEvent", "PushEvent", "PushEvent"), July_created_at = c("2012-07-01 13:46:20", 
    "2012-07-01 13:46:20", "2012-07-02 11:53:37", "2012-07-02 11:53:37", 
    "2012-07-02 12:27:30", "2012-07-02 12:27:30"), July_actor_attributes_email = c("medium", 
    "medium", "ryoqun@gmail.com", "ryoqun@gmail.com", "ryoqun@gmail.com", 
    "ryoqun@gmail.com"), July_type = c("PushEvent", "PushEvent", 
    "CreateEvent", "CreateEvent", "PushEvent", "PushEvent"), 
    August_created_at = c("2012-08-01 00:04:09", "2012-08-01 00:04:09", 
    "2012-08-01 00:04:42", "2012-08-01 00:04:42", "2012-08-01 00:05:04", 
    "2012-08-01 00:05:04"), August_actor_attributes_email = c("jeremy@asynk.ch", 
    "jeremy@asynk.ch", "jeremy@asynk.ch", "jeremy@asynk.ch", 
    "jeremy@asynk.ch", "jeremy@asynk.ch"), August_type = c("IssueCommentEvent", 
    "IssueCommentEvent", "IssuesEvent", "IssuesEvent", "IssueCommentEvent", 
    "IssueCommentEvent"), September_created_at = c("2012-09-01 18:12:24", 
    "2012-09-01 18:12:24", "2012-09-01 23:51:18", "2012-09-01 23:51:18", 
    "2012-09-02 00:34:54", "2012-09-02 00:34:54"), September_actor_attributes_email = c("ryoqun@gmail.com", 
    "ryoqun@gmail.com", "ryoqun@gmail.com", "ryoqun@gmail.com", 
    "ryoqun@gmail.com", "ryoqun@gmail.com"), September_type = c("CommitCommentEvent", 
    "CommitCommentEvent", "CreateEvent", "CreateEvent", "PushEvent", 
    "PushEvent"), October_created_at = c("2012-10-01 07:48:38", 
    "2012-10-01 10:01:40", "2012-10-01 10:01:43", "2012-10-01 10:17:00", 
    "2012-10-01 16:08:29", "2012-10-01 18:06:46"), October_actor_attributes_email = c("medium", 
    "medium", "medium", "medium", "", "core"), October_type = c("PushEvent", 
    "IssuesEvent", "PushEvent", "PushEvent", "ForkEvent", "PullRequestEvent"
    )), .Names = c("March_created_at", "March_actor_attributes_email", 
"March_type", "April_created_at", "April_actor_attributes_email", 
"April_type", "May_created_at", "May_actor_attributes_email", 
"May_type", "June_created_at", "June_actor_attributes_email", 
"June_type", "July_created_at", "July_actor_attributes_email", 
"July_type", "August_created_at", "August_actor_attributes_email", 
"August_type", "September_created_at", "September_actor_attributes_email", 
"September_type", "October_created_at", "October_actor_attributes_email", 
"October_type"), row.names = c(NA, 6L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:31:40.093

我认为原则上任何一个都应该起作用。

```
1)
df2[df2$March_actor_attributes_email == "" & df2$March_created_at !="","March_actor_attributes_email"] <- "low"

2)
df2$March_actor_attributes_email <- ifelse(df2$March_actor_attributes_email == "" & df2$March_created_at !="", "low", df2$March_actor_attributes_email) 
```

棘手的部分是日期列。您可能希望确保该字段实际上包含一个日期，而不是仅仅包含非空白，但这取决于您如何构建事物。

# montecarlo - 球体上的蒙特卡罗模拟：无偏随机步骤

> ID：12900861
> 
> 赞同：5
> 
> 时间：2012-10-15T17:26:32.617
> 
> 标签：montecarlo

我正在用球体上的粒子进行 Metropolis Monte Carlo 模拟，并且对给定时间步长内的随机运动有疑问。

我知道要在球体上获得均匀分布的随机点，首先使用天真的最简单的方法是不够的（使用具有恒定 R 的球面坐标并选择随机角度 theta 和 phi），但必须例如使用这些方法之一：http: [//mathworld.wolfram.com/SpherePointPicking.html](http://mathworld.wolfram.com/SpherePointPicking.html)

查看球体上蒙特卡洛的另一个代码，我看到了一种相当复杂的生成随机移动的方法：选择一个随机粒子，计算将其移动到北极的旋转矩阵，找到一个小于一定长度的随机笛卡尔向量并移动将其指向北极，对笛卡尔向量进行归一化，然后将其旋转回原始粒子位置附近。

这一切都是为了得到一个无偏的新随机位置。尽管我怀疑它与详细的平衡有关，但我并不完全理解其中的原理。但我的感觉是应该有一种更简单（即更快）的方法来做到这一点。实际上，直觉上我觉得在这种情况下可以找到两个小的随机角度 theta 和 phi 并将它们添加到粒子的位置 - 或者这会是一个错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:32:40.693

您描述的算法背后的基本原理是将点映射到极点，生成切平面，以通常的方式均匀生成笛卡尔向量，然后将其映射回球体，最终反转旋转。由于切平面是导数，因此对于大球体和小步长，这是一个很好的近似值。

我们能做得更好吗？或者至少窃取别人的代码？也许。[考虑一下：由于MathWorld 上的那篇文章，](http://mathworld.wolfram.com/SpherePointPicking.html)您已经可以在球体上生成均匀分布的随机点。

不失一般性，您可以将当前点视为球体的一极。如果你使用 MathWorld 算法生成一个随机点，你就知道生成的点在任何方位角的概率是一致的。

然后问题被简化为在给定两个点的 phi/theta 值的情况下找到球体上的方位，然后沿该方位的大圆路线生成一个增量表面距离的新点。

对于这个新版本的问题，您可以通过导入您喜欢的 GIS 或[投影](http://trac.osgeo.org/proj/wiki/GeodesicCalculations)库并使用地球的球形模型（具有适当的缩放比例）来获得所需的所有代码。

许多人似乎[将此站点](http://williams.best.vwh.net/avform.htm#Crs)称为在球形导航方面拥有大量出色的数学知识。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:19:34.873

我想自己使用评论来回答上面的评论，但我不能使用为评论保留的有限空间来回答。如果这违反了准则，我很抱歉。

既然你问了，万一其他人在这里结束 - 我确实对这个问题有一些新的见解：

这里我们真正需要担心的是细节平衡；如果 P(a) 是处于状态 a 的概率并且 P(a->b) 是转换到状态 b 的概率，那么详细的平衡需要 P(a)P(a->b)=P(b) P(b->a)。

Metropolis 算法基本上通过使 P(a->b)=1 如果 P(b)/P(a) > 1 和 P(a->b)=P(b)/P(a) 来满足这一点。在我的（量子力学）系统中，我使用 P(a)~|psi(a)|^2，波函数的平方（在统计力学应用中，我猜我们会使用 P(a)~exp[-beta*E]） .

在一个球体上使用它的问题是从角度空间 {theta,phi}={t,p} 中的均匀分布获得的步骤如下：假设我们在一个具有给定角度 t 的点（一个测量角度从北极沿 z 轴）。从表面元素 dS=sin(t) dt dp 我们看到，如果我们的随机角位移是 Dt 和 Dp，则选择的新试验点位于区域 S=4*Dp*sin(Dt)*sin(t) 内，所以选择给定点 p_b 的机会是 ~1/S ~ 1/sin(t)。

除了评估 |psi(a)|^2 之外，尝试给定点的概率当然会影响 P(a->b)；事实上，我们看到它会将后者除以因子 sin(t)。因此，保存详细平衡的一种简单方法是乘以相同的： P(a->b) --> P(a->b)sin(t) 其中 t 是粒子 a 的 theta 角。

这将恢复详细的平衡。另一个问题是这将如何影响收敛等，因为两极附近的粒子现在有小步长但接受概率大。

# c# - 动态生成时如何检索已单击的按钮

> ID：12900864
> 
> 赞同：1
> 
> 时间：2012-10-15T17:26:48.647
> 
> 标签：c#, .net, wpf, button, mvvm

好吧，我是一名 C++ 开发人员，目前我正在开发 WPF 应用程序，看起来这是一个棘手的情况。我已经动态生成了一组按钮、标签等，其中文本框和按钮都相互绑定。我之前在 C++ 代码中完成了此操作，现在我需要在 WPF 应用程序中执行此操作。

**XAML：**

```
<ListBox x:Name="myViewChannelList" HorizontalAlignment="Stretch" Height="Auto" ItemsSource="{Binding VoltageCollection}" Margin="0" VerticalAlignment="Stretch" Width="Auto" >
            <ListBox.Resources>
                <convert:BooleanToVisibilityConverter x:Key="booltovisibility"/>
            </ListBox.Resources>

            <ListBox.ItemTemplate>
                <DataTemplate >
                    <Grid Visibility="{Binding IsAvailable, Converter={StaticResource booltovisibility}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="170"  />
                            <ColumnDefinition />
                            <ColumnDefinition  />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <Label Grid.Column="0" Content="{Binding ChannelName}" Margin="50,20,0,0"></Label>

                        <Grid Grid.Column="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Column="0" Text="{Binding VoltageText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Height="25" Width="50" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="170,20,0,0" />
                            <Button Grid.Column="1" Content="Set" Height="25" CommandParameter="{Binding VoltageText}" Command="{Binding VoltageCommand}" Width="50" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="20,20,0,0" ></Button>
                        </Grid>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox> 
```

**视图模型：**

```
private ICommand m_voltageCommand;

    public ChannelList()
    {
         m_voltageCommand = new DelegateVoltageCommand(x => SetCommandExecute(x));
    }

public void Initialize()
{
    VoltageCollection = new ObservableCollection<VoltageModel> { new VoltageModel() { ChannelName = "", IsAvailable = false, VoltageText = String.Empty, VoltageCommand = m_voltageCommand },
                                                                 new VoltageModel() { ChannelName = "VDD__Main", IsAvailable = true, VoltageText = String.Empty, VoltageCommand = m_voltageCommand }, 
                                                                 new VoltageModel() { ChannelName = "VDD__IO__AUD", IsAvailable = true, VoltageText = String.Empty, VoltageCommand = m_voltageCommand }, 
                                                                 new VoltageModel() { ChannelName = "VDD__CODEC__AUD", IsAvailable = true, VoltageText = String.Empty, VoltageCommand = m_voltageCommand } 
                                                               }; 
}

ObservableCollection<VoltageModel> _voltages;
public ObservableCollection<VoltageModel> VoltageCollection
{
    get
    {
        return _voltages;
    }
    set
    {
        _voltages = value;
        OnPropertyChanged("VoltageCollection");
    }
} 

// Event when SET Button is clicked
public void SetCommandExecute(object voltageText)
{       
    string value = voltageText.ToString();
    int val = Convert.ToInt32(value);
} 
```

因此，它会生成 Button + Textbox + Label 3 次，如`Initialize()`方法所示。现在`VoltageCommand = m_voltageCommand`给我在文本框中输入的文本，它调用电压文本`SetCommandExecute(object voltageText)`给我输入值的方法。

**模型：**

```
string voltageText = string.Empty;
    public string VoltageText
    {
        get
        {
            return voltageText;
        }

        set
        {
            voltageText = value;
            OnPropertyChanged("VoltageText");
        }
    }

**C++ Code:**

// Since we have 3 channels, channel maintains count
if(button == m_setButton[channel])
{
    unsigned cmd = 0x0300;
    int numBytes = 0;

    cmd |= (channel & 0xFF);
            // Some code 
```

在这里，它告诉用户哪个按钮已被单击，并采用`channe`l 的值，即如果单击第二个按钮则`channel = 2`。

在这里，我需要实现用 C++ 编写的代码。如何获取频道，即点击了哪个按钮。看看`cmd |= (channel & 0xFF);`，它使用了`channel`值。如何在我的应用程序中实现它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T09:45:42.747

您可以简单地将 ID 属性添加到您的 VoltageBoardChannel 类。

```
int index ; 
public int ID 
{ 
    get 
    { 
        return index; 
    } 

    set 
    { 
        index = value; 
        OnPropertyChanged("ID"); 
    }
} 
```

然后将您的 CommandParameter Binding 更改为`CommandParameter="{Binding}"`，`CommandParameter="{Binding VoltageText}"`您现在不仅会收到 Text，还会收到现在拥有 ID 的 VoltageBoardChannel 类的实例。

**在您的命令执行方法中**

```
public void DoSomethingExecute(object param) 
{ 
    VoltageBoardChannel result = param as VoltageBoardChannel; 
    string value = result.VoltageText;
    int index = result.ID;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:19:34.827

这是您实现 MVVM 的基本问题：

*ViewModel 永远不应该知道 View；它应该可以独立于任何 View 元素进行测试*

在您的 SetCommandExecute 方法中，期望执行一些从视图发送的基于文本的工作。如果你要为 SetCommandExecute 方法编写一个单元测试，只使用来自 ViewModel 其他部分的信息，你会传入什么？

相反，您的 SecCommandExecute 应该是：

```
SetCommandExecute(object voltageModel)
{
    VoltageModel myModel = voltageModel as VoltageModel; // Cast the model to the correct object type
    if (myModel != null)
    { // myModel will be null of voltageModel is not a VoltageModel instance
        // TODO: Whatever work you need to do based on the values of the myModel
    }
} 
```

您的 XML 应为：

```
<Button Grid.Column="1" Content="Set" Height="25" CommandParameter="{Binding }" Command="{Binding VoltageCommand}" Width="50" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="20,20,0,0" ></Button> 
```

这是如何运作的？那么它归结为DataContext。由于网格中每条线的 DataContext 都是一个电压模型，因此您可以直接绑定到它的几个属性。例子`Text="{Binding VoltageText ...}"`

数据网格中的每一项都有每行的对象实例的隐含 DataContext。由于每一行都绑定到 VoltageModel 的一个实例，因此您可以直接在代码中使用该事实。View 知道它正在使用哪些 ViewModel 属性和实例，并且可以将用户操作的特定电压模型“向下”传递给 ViewModel。

推理：

当您的命令事件运行时，它应该传入 VoltageModel 对象，这使您可以直接访问所有实例属性。请记住，这是最佳实践，因为您希望能够对`SetCommandExecute`方法进行单元测试，而不需要视图传递一些文本、解析它、在视图上找到一些控件以及所有这些东西。

简而言之：ViewModel 应该是完全独立的，并且能够基于仅 ViewModel 可用的数据运行所有单元测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:38:19.667

我自己只做了一点WPF。当我将数据绑定到控件时，我可以通过某种方式将该数据项与其他数据项唯一区分开来。

伪代码：

```
private void Button_Clicked(object sender, EventArgs e) {
  MyType obj = (MyType)listView1.SelectedItem[0];
  if (obj.UniqueItem == whatINeed) {
    DoStuffFunction();
  }
} 
```

我不知道这是否适用于您的情况，但这就是我解决问题的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T17:46:34.583

嗨，而不是将电压文本绑定到命令参数，而是将按钮绑定到它，您可以从 ButtonDataContext 或通过将 ListBox 的 SelectedItem 绑定到 ViewModel 属性来获取电压文本。我希望这会有所帮助。

```
<ListBox x:Name="lb">
        <ListBoxItem>
            <Button x:Name="btn" CommandParameter="btn" Command="{Binding MyCommand}" VerticalAlignment="Bottom" Height="30"/>
        </ListBoxItem>
        <ListBoxItem>
            <Button  CommandParameter="{Binding SelectedIndex, ElementName=lb}" Command="{Binding MyCommand}" VerticalAlignment="Bottom" Height="30"/> 
        </ListBoxItem>
    </ListBox>

 public MainWindow()
    {
        InitializeComponent();
        DataContext = this;
    }
    private ICommand _myCommand;
    public ICommand MyCommand { get { return _myCommand ?? (new CommandHandler((o) => FireCommand(o),()=> true)); } }
    public void FireCommand(object obj)
    {
        var a = lb.SelectedIndex; 
    }

public class CommandHandler:ICommand
{
        private Action<object> del;
        public CommandHandler(Action<object> action, Func<bool> b=null)
        {
            del = action;
        }

        #region ICommand Members

        public bool CanExecute(object parameter)
        {
            return true;
        }

        public event EventHandler CanExecuteChanged;

        public void Execute(object parameter)
        {
            del(parameter);
        }

        #endregion
} 
```

您可以尝试以上两种方法之一。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T17:43:06.877

您已经将电压文本框绑定到一个属性，因此不需要将该值作为命令参数传递。相反，您可以将源指定为命令：

```
<Button CommandParameter="TheButton" /> 
```

在你的命令处理程序的实现中：

```
public void SetCommandExecute(object source)
{       
    string source = source as string;

    if (source == "TheButton")
    {
       int val = Convert.ToInt32(this.VoltageText);
    }
} 
```

# sql - tsql: xml 节点转换错误

> ID：12900865
> 
> 赞同：0
> 
> 时间：2012-10-15T17:26:50.060
> 
> 标签：sql, sql-server, casting, xml-parsing

我需要做什么才能容纳 Xml 文档中的传入值，这些值最终被写入为十进制（18,5）、整数或标签中可能没有数据的唯一标识符 [尽管不是 NULL 数据--正如我发现的困难方式]，或标签中的文本数据。似乎我解决了一个问题，但又创建了另一个问题！：-\ 我收到错误消息：将 varchar 值“7800.00000”转换为数据类型 int 时转换失败，从字符串转换为唯一标识符时转换失败。我该如何纠正？

这是带有数据的 xml 片段的示例：

```
<Products>
  <Product>
      <AgreementId>2439</AgreementId>
      <Difference>0.00400</Difference>
      <DispatchedQuantity>7800.00000</DispatchedQuantity>
      <Freight>0.01560</Freight>
      <ProductGUID>d475165c-0031-41f6-ad44-cecb73dfd2de</ProductGUID>
      <ShortName>U_B5Not Specif_No2_U</ShortName>
    </Product>
  </Products 
```

这是在存储过程中处理它的代码：

```
 SELECT
       l.OrderId,
       l.OrderLiftId,
       cast(n.x.value('AgreementId[1]', 'varchar(20)') as int),
       CAST(CASE WHEN n.x.value('Difference[1]', 'varchar(20)') = '' THEN 0 ELSE  COALESCE(n.x.value('Difference[1]', 'varchar(20)'), '0.00') END AS decimal(18,5)),
       CAST(CASE WHEN n.x.value('DispatchedQuantity[1]', 'varchar(20)') = '' THEN 0 ELSE  COALESCE(n.x.value('DispatchedQuantity[1]', 'varchar(20)'), '0.00') END AS decimal(18,5)),
       CAST(CASE WHEN n.x.value('Freight[1]', 'varchar(20)') = '' THEN 0 ELSE  COALESCE(n.x.value('Freight[1]', 'varchar(20)'), '0.00') END AS decimal(18,5)),
       cast(n.x.value('ProductGUID[1]', 'varchar(40)') as uniqueidentifier),
       n.x.value('ShortName[1]', 'varchar(100)')
  FROM @lines as l
   CROSS APPLY l.lineprods.nodes('/Products/Product') as n(x); 
```

**更新：这一行——**

```
 CAST(CASE WHEN n.x.value('DispatchedQuantity[1]', 'varchar(20)') = '' THEN 0 ELSE  COALESCE(n.x.value('DispatchedQuantity[1]', 'varchar(20)'), '0.00') END AS decimal(18,5)), 
```

需要改为：

```
 CAST(CASE WHEN n.x.value('DispatchedQuantity[1]', 'varchar(20)') = '' THEN 0 ELSE  COALESCE(n.x.value('DispatchedQuantity[1]', 'decimal(18,5)'), '0.00') END AS decimal(18,5)), 
```

容纳非数字/非空值和我希望是小数的第一个非空值——如果我得到其他一些虚假值，它仍然可能会爆炸。关于如何处理的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:26:37.200

尝试这个。

```
declare @xml xml 

select @xml = '
<Products>
  <Product>
      <AgreementId>2439</AgreementId>
      <Difference>aaa</Difference>
      <DispatchedQuantity>7800.00000</DispatchedQuantity>
      <Freight>0.01560</Freight>
      <ProductGUID>d475165c-0031-41f6-ad44-cecb73dfd2de</ProductGUID>
      <ShortName>U_B5Not Specif_No2_U</ShortName>
    </Product>
  </Products>'

select
    CALC2.Agreement,
    CALC2.[Difference],
    CALC2.DispatchedQuantity,
    CALC2.ProductGUID,
    CALC2.Freight,
    CALC.ShortName
from @xml.nodes('/Products/Product') as n(x)
    outer apply
    (
        select
            isnull(n.x.value('AgreementId[1]', 'varchar(20)'), '0') as Agreement,
            isnull(n.x.value('Difference[1]', 'varchar(20)'), '0.00000') as     [Difference],
            isnull(n.x.value('DispatchedQuantity[1]', 'varchar(20)'), '0.00000') as DispatchedQuantity,
            n.x.value('ProductGUID[1]', 'varchar(40)') as ProductGUID,
            isnull(n.x.value('Freight[1]', 'varchar(20)'), '0.00000') as Freight,
            n.x.value('ShortName[1]', 'varchar(100)') as ShortName
    ) as CALC
    outer apply
    (
        select
            case when CALC.Agreement not like '%[^0-9]%' then cast(CALC.Agreement as int) else null end as Agreement,
            case when CALC.[Difference] not like '%[^0-9]%' then cast(CALC.[Difference] as decimal(18,5)) else null end as [Difference],
            case when CALC.DispatchedQuantity not like '%[^0-9]%' then null else cast(CALC.DispatchedQuantity as decimal(18,5)) end as DispatchedQuantity,
            cast(CALC.ProductGUID as uniqueidentifier) as ProductGUID,
            case when CALC.Freight not like '%[^0-9]%' then null else cast(CALC.Freight as decimal(18,5)) end as Freight
    ) as CALC2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:11:16.353

我想[ISNUMERIC](http://msdn.microsoft.com/en-us/library/ms186272.aspx)函数可以解决问题。

```
CASE WHEN ISNUMERIC(n.x.value('DispatchedQuantity[1]', 'varchar(max)')) = 0 THEN 0 ELSE ... END 
```

但是，我不明白您为什么在将 xml 转换为十进制之前将其提取为 varchar(20)。确定数据是数字后，您可以简单地使用：

```
n.x.value('DispatchedQuantity[1]', ' decimal(18,5)') 
```

我用于测试的完整 SQL：

```
DECLARE @XML XML
SET @XML = '<Products>
              <Product>
                  <AgreementId>2439</AgreementId>
                  <Difference>0.00400</Difference>
                  <DispatchedQuantity>7800.00000</DispatchedQuantity>
                  <Freight>0.01560</Freight>
                  <ProductGUID>d475165c-0031-41f6-ad44-cecb73dfd2de</ProductGUID>
                  <ShortName>U_B5Not Specif_No2_U</ShortName>
                </Product>
                <Product>
                  <AgreementId>2439</AgreementId>
                  <Difference></Difference>
                  <DispatchedQuantity>INVALID NUMBER</DispatchedQuantity>
                  <Freight>INVALID FREIGHT</Freight>
                  <ProductGUID>INVALID GUID</ProductGUID>
                  <ShortName>U_B5Not Specif_No2_U</ShortName>
                </Product>
              </Products>'

SELECT  [AgreementId] = CAST(n.x.value('AgreementId[1]', 'varchar(20)') AS INT),
        [Difference] = CAST(CASE WHEN ISNUMERIC(n.x.value('Difference[1]', 'varchar(max)')) = 0 THEN 0 ELSE n.x.value('Difference[1]', 'decimal(18, 5)') END AS DECIMAL(18,5)),
        [DispatchedQuantity] = CAST(CASE WHEN ISNUMERIC(n.x.value('DispatchedQuantity[1]', 'varchar(max)')) = 0 THEN 0 ELSE n.x.value('DispatchedQuantity[1]', 'decimal(18, 5)') END AS DECIMAL(18,5)),
        [Freight] = CAST(CASE WHEN ISNUMERIC(n.x.value('Freight[1]', 'varchar(20)')) = 0 THEN 0 ELSE n.x.value('Freight[1]', ' decimal(18,5)') END AS DECIMAL(18,5)),
        [ProductGUID] = CASE WHEN ProductGUID LIKE Expression + '%' OR ProductGUID LIKE '{' + Expression + '}' THEN CAST(ProductGUID AS UNIQUEIDENTIFIER) END,
        [ShortName] = n.x.value('ShortName[1]', 'varchar(100)')
FROM    @XML.nodes('/Products/Product') AS n(x)
        CROSS APPLY 
        (   SELECT  [ProductGUID] = n.x.value('ProductGUID[1]', 'varchar(40)') ,
                    [Expression] = REPLACE('00000000-0000-0000-0000-000000000000', '0', '[0-9a-fA-F]') COLLATE Latin1_General_BIN 
        ) Expr 
```

**编辑**

我已经编辑了上面的查询以允许无效的 GUID（在[Martin Smith](https://stackoverflow.com/a/12694703/1048425)的帮助下）

如果您使用的是 SQL-Server 2012，那么您可以使用[TRY_CONVERT](http://msdn.microsoft.com/en-us/library/hh230993.aspx)：

```
SELECT  [AgreementId] = TRY_CONVERT(INT, n.x.value('AgreementId[1]', 'varchar(20)')),
        [Difference] =TRY_CONVERT(DECIMAL(18, 5), n.x.value('Difference[1]', 'varchar(max)')),
        [DispatchedQuantity] = TRY_CONVERT(DECIMAL(18, 5), n.x.value('DispatchedQuantity[1]', 'varchar(max)')),
        [Freight] = TRY_CONVERT(DECIMAL(18, 5), n.x.value('Freight[1]', 'varchar(20)')),
        [ProductGUID] = TRY_CONVERT(UNIQUEIDENTIFIER, n.x.value('ProductGUID[1]', 'varchar(40)')),
        [ShortName] = n.x.value('ShortName[1]', 'varchar(100)')
FROM    @XML.nodes('/Products/Product') AS n(x) 
```

# android - 计算当前位置和点之间的距离

> ID：12900866
> 
> 赞同：1
> 
> 时间：2012-10-15T17:26:49.963
> 
> 标签：android, gps, location, distance, latitude-longitude

> **可能重复：**
> [Android：Location.distanceTo 无法正常工作？](https://stackoverflow.com/questions/531324/android-location-distanceto-not-working-correctly)

我正在尝试计算用户位置（驾驶员或移动位置）与固定纬度经度之间的距离。但是，文本不显示结果，只显示 TextView。

每当用户到达固定纬度经度的某个半径时，图像视图就会变为另一个可绘制对象。我已经尝试这样做一个多星期了。有帮助吗？

* * *

主要代码：

```
 public  void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.lights);

    //placing location
    LocationManager loc = (LocationManager)getSystemService(Context.LOCATION_SERVICE); 
    Location location = loc.getLastKnownLocation(LocationManager.GPS_PROVIDER);
    double clong = location.getLongitude();  
    double clat = location.getLatitude();    //current longitude and latitude

    double latitude=0.305085;
    double longitude=101.70506;     //fixed location

    double dist = Math.sqrt(Math.pow((111.3 * (latitude - clat)),2) + Math.pow((71.5 * (longitude - clong)),2)) * 1000;

if(dist<1000){
    calculate(dist);

    tvDis = (TextView)findViewById(R.id.distance);

    tvDis.setText(dist+"m");

}

 }

 public void calculate(double x){
    ImageView light = (ImageView)findViewById(R.id.imageView1);

    if (x<1000){

        light.setImageResource(R.drawable.icon_yellow);

        if(x<500){
            light.setImageResource(R.drawable.icon_red);
        }
    }
    else{
        light.setImageResource(R.drawable.icon_green);
    }

} 
```

* * *

我尝试将 1000 更改为更大的数字，但仍然没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:39:04.253

来自开发者网站

```
public static void distanceBetween (double startLatitude, double startLongitude, double endLatitude, double endLongitude, float[] results) 
```

[http://developer.android.com/reference/android/location/Location.html](http://developer.android.com/reference/android/location/Location.html)

# liferay - Liferay 6.1 在文档和媒体 portlet 中为不同用户自定义角色和权限

> ID：12900871
> 
> 赞同：0
> 
> 时间：2012-10-15T17:27:17.670
> 
> 标签：liferay, customization, portlet

我是liferay的新手。我有一个问题。我有 3 个子组织（组织 A、B 和 C），每个组织都有各自的用户。例如分别为 UA1、UB2、UC3。

现在我想自定义文档和媒体portlet的权限，使UA1可以上传/下载他的文档。但是组织 A 中的另一个用户（例如 UA4）无法访问 UA1 的文档。同时用户 UB2 和 UC3 可以看到用户 UA1 的文档或为她添加新文档。

我可以通过创建角色和权限来实现这一点吗？我尝试了很多组合，但它不起作用。

我怎样才能做到这一点。请务必让我知道。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T07:10:48.150

这里我们有两种情况 1.同一组织的用户无法查看同一组织的其他用户添加的图像。可以通过创建自定义资源操作说（SCOPE_INDIVIDUAL）并管理它的权限来实现。2.其他组织的用户可以通过创建一个角色并定义权限来查看我可以管理的内容。

# spring-mvc - 如何在使用 Dojo 的 Spring WebFlow 项目中提交页 面之前检查所需的复选框

> ID：12900877
> 
> 赞同：0
> 
> 时间：2012-10-15T17:27:35.380
> 
> 标签：spring-mvc, dojo, spring-webflow, spring-js

如何使用 Dojo (dijit) 在 Spring WebFlow 项目中制作所需的复选框。

我想知道如何制作提交下一页时所需的复选框。

如果用户没有单击复选框选项之一，我不希望提交工作。谢谢。用户需要单击或同时单击复选框来提交页面。

```
 <%@ taglib prefix="c" uri="http://java.sun.com/jstl/core"%>
    <%@ taglib prefix="fmt" uri="http://java.sun.com/jstl/fmt"%>
    <%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>

    <style type="text/css" media="screen">
     @import url("<c:url value="/resources/dojo/resources/dojo.css"/>");
     @import url("<c:url value="/resources/dijit/themes/claro/claro.css"/>");
    </style>     

    <script djconfig="parseOnLoad: true"
     src="<c:url value="/resources/dojo/dojo.js"/>" type="text/javascript"></script>
    <script type="text/javascript"
     src="<c:url value="/resources/spring/Spring.js" />"> </script>
    <script type="text/javascript"
     src="<c:url value="/resources/spring/Spring-Dojo.js" />"></script>
    <script type="text/javascript">dojo.require("dojo.parser");</script>

    <html>
    <head>
    <title>Spring 3.0 MVC - Web Flow Example</title>
    </head>
    <body class="claro">
        <h2>CheckBox Test</h2>
        <p>
        <p>
        <form:form commandName="customer" id="customer">
            <input type="hidden" name="_flowExecutionKey"
                value="${flowExecutionKey}" />
            <div id="container">
                <table>
                    <tr>
                        <td><font color=red><form:errors path="sex" /></font><b>Do you have a kid(s) of the follow sex type:</b></td>
                        <td><form:checkbox path="sex" id="sex" value="MALE" /> MALE |  
                            <form:checkbox path="sex" id="sex" value="FEMALE" />FEMALE
                            <script type="text/javascript">
                                dojo.query("#sex input[type='checkbox']").forEach(function(element){
                                    Spring.addDecoration(new Spring.ElementDecoration({
                                        elementId: element.id,
                                        widgetType : "dijit.form.CheckBox",
                                        widgetAttrs : { checked : element.checked, required : true,
                                            validate: function (){
                                                   if(dojo.query("INPUT[type='checkbox']", 'customer').filter(function(n){return n.checked;}).length > 0){return true;} else {alert('choose a type');return false;}
                                              }
    }
                                    }));
                                });
                            </script>
                            </td></tr>
                            </table>
            </div>
            <p>
            <input type="submit" name="_eventId_submit" id="submit" value="Submit" />
            <input type="submit" name="_eventId_cancel" value="Cancel" />
            <p>
            <script type="text/javascript">
                Spring.addDecoration(new Spring.ValidateAllDecoration({
                    elementId : 'submit',
                    event : 'onclick'
                }));
            </script>
        </form:form>
    </body>
    </html> 
```

屏幕应如下所示：

![在此处输入图像描述](../Images/5b9387262fc1ce490ed8d6b3ef5578b0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:02:01.447

我得到了它的工作......我必须改变我的jsp以匹配以下内容

```
<%@ taglib prefix="c" uri="http://java.sun.com/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jstl/fmt"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>

<style type="text/css" media="screen">
 @import url("<c:url value="/resources/dojo/resources/dojo.css"/>");
 @import url("<c:url value="/resources/dijit/themes/claro/claro.css"/>");
</style>     

<script djconfig="parseOnLoad: true"
 src="<c:url value="/resources/dojo/dojo.js"/>" type="text/javascript"></script>
<script type="text/javascript"
 src="<c:url value="/resources/spring/Spring.js" />"> </script>
<script type="text/javascript"
 src="<c:url value="/resources/spring/Spring-Dojo.js" />"></script>
<script type="text/javascript">dojo.require("dojo.parser");</script>

<html>
<head>
<title>Spring 3.0 MVC - Web Flow Example</title>
</head>
<body class="claro">
    <h2>CheckBox Test</h2>
    <p>
    <p>
    <form:form commandName="customer" id="customer">
        <input type="hidden" name="_flowExecutionKey"
            value="${flowExecutionKey}" />
        <div id="container">
            <table>
                <tr>
                    <td><font color=red><form:errors path="sex" /></font><b>Do you have a kid(s) of the follow sex type:</b></td>
                    <td><form:checkbox path="sex" id="MALE" value="MALE" /> MALE |
                        <script type="text/javascript">
                                            Spring.addDecoration(new Spring.ElementDecoration(
                                                {
                                                    elementId : 'MALE',
                                                    widgetType : "dijit.form.CheckBox",
                                                    widgetModule : "dijit.form.CheckBox",
                                                    validate: function (){
                                                           if(dojo.query('INPUT[name=sex]', 'customer').filter(function(n){return n.checked;}).length > 0){return true;} else {alert('choose a type');return false;}
                                                      },
                                                    widgetAttrs : {
                                                        value : "MALE",
                                                        required : true,
                                                        promptMessage : "For Retired"
                                                    }
                                                }));
                            </script>  
                        <form:checkbox path="sex" id="FEMALE" value="FEMALE" />FEMALE
                        <script type="text/javascript">
                                            Spring.addDecoration(new Spring.ElementDecoration(
                                                {
                                                    elementId : 'FEMALE',
                                                    widgetType : "dijit.form.CheckBox",
                                                    widgetModule : "dijit.form.CheckBox",
                                                    widgetAttrs : {
                                                        value : "FEMALE",
                                                        required : true,
                                                        promptMessage : "For Retired"
                                                    }
                                                }));
                            </script>
                        </td></tr>
                        </table>
        </div>
        <p>
        <input type="submit" name="_eventId_submit" id="submit" value="Submit" />
        <input type="submit" name="_eventId_cancel" value="Cancel" />
        <p>
        <script type="text/javascript">
            Spring.addDecoration(new Spring.ValidateAllDecoration({
                elementId : 'submit',
                event : 'onclick'
            }));
        </script>
    </form:form>
</body>
</html> 
```

# python - cx_freeze 构建的应用程序未在 Windows 7 中显示系统托盘图标

> ID：12900885
> 
> 赞同：0
> 
> 时间：2012-10-15T17:28:36.757
> 
> 标签：python, windows-7, pyqt4, cx-freeze, systray

我使用 PyQt 和 cx_freeze 构建了一个具有系统托盘图标的应用程序，但是该图标没有显示在 Windows 7 的系统托盘中（该应用程序在那里并且正在运行，但只是一个空白点 - 没有图标）。现在它在其他计算机上的 Windows XP 中运行良好，只是在 win 7 中没有。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T06:12:19.723

```
icon = QtGui.QIcon('blah.png')
self.tray_icon = QtGui.QSystemTrayIcon(self)
self.tray_icon.setIcon(icon)
self.tray_icon.setVisible(True)
self.tray_icon.show() 
```

这应该有效。但是在win XP中，您似乎只需要“self.tray_icon.setIcon(icon)”而不是“.setVisible(True)”或“.show()”就可以工作，这是我遇到的问题。我还创建了一个继承 QtGui.QApplication 的类并添加了：

```
icon = QtGui.QIcon('blah.png')
self.setWindowIcon(icon) 
```

不幸的是，我不知道上面是什么完全解决了这个问题，因为我没有一台 Win 7 电脑来进行个性测试，所以我做了霰弹枪方法，它奏效了。

# objective-c - 自定义 UITableViewCells UITextField 强引用还是弱引用？

> ID：12900896
> 
> 赞同：0
> 
> 时间：2012-10-15T17:29:19.273
> 
> 标签：objective-c, ios, uitableview, automatic-ref-counting

我正在务实地设置一个带有 uitextfields、uisegmentedcontrols 等的 tableview。

这是一个例子

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {

    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

    //NSLog(@"creating a new %@", CellIdentifier);

    if([CellIdentifier isEqualToString:@"ID"]) {

       UITextField *newTextField = [[UITextField alloc] initWithFrame:CGRectMake(80, 5, 215, 34)];
        self.idField = newTextField;
        [cell addSubview:self.idField];

    }
} 
```

如您所见，我正在为所有这些文本字段创建属性并将它们分配给新创建的字段。

我的问题是我应该使用 (nonatomic, strong) 还是 (nonatomic, weak) ？

```
@property(nonatomic, weak) UITextField *idField;
//Or
@property(nonatomic, strong) UITextField *idField; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:43:55.247

您根本不应该为这些文本字段创建成员变量。您需要第二个文本字段做什么？也许另一种单元格样式就足以满足您的目的？例如`UITableViewCellStyleValue1`，`UITableViewCellStyleValue2`或`UITableViewCellStyleSubtitle`？

但是如果你需要一个自定义的，只需为其分配一个标签（例如 tableViewCell 的行），然后通过`viewWithTag:`. 如果您想直接访问，请考虑自定义 UITableViewCell 子类。

直接回答您的问题：这里可能是一个弱引用就足够了，因为 textField 被添加到一个单元格上，它不会在任何时候被释放（因为它将被重用）。

# .net - 为什么不应该将我的分布式 .NET 4.0 应用程序迁移到 .NET 4.5？

> ID：12900899
> 
> 赞同：0
> 
> 时间：2012-10-15T17:29:39.157
> 
> 标签：.net, .net-4.0, upgrade, .net-4.5

[我已阅读.NET Framework 4.5 中的应用程序兼容性中](http://msdn.microsoft.com/en-us/library/hh367887.aspx)列出的重大更改列表。将 .NET 4.0 应用程序迁移到 .NET 4.5 的最大问题似乎是 .NET 4.5 应用程序无法在 XP 上运行。如果我可以确信这永远没有必要，那么将分布式应用程序从 .NET 4.0 迁移到 .NET 4.5 时最大的担忧是什么？列出的任何问题是否比看起来更重要？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:45:56.757

即使没有已知的兼容性问题，迁移应用程序通常也是有风险的。在这种情况下，当存在已知的重大更改时，我会避免迁移。

一个简单的测试不会揭示应用程序可能表现不同的特定情况。

# javascript - 捏放大，缩小 - Android 平台上 Web 的 Javascript/jQuery/jQuery 移动事件？

> ID：12900913
> 
> 赞同：9
> 
> 时间：2012-10-15T17:30:11.250
> 
> 标签：javascript, android, jquery-mobile, dom-events

捏放大和缩小涉及的 Javascript 或 jQuery 或 jQuery 移动事件是什么？我正在尝试捕获这些事件以放大和缩小 div 内的图像，而不会影响网站的整个布局。[检测捏合的最简单方法](https://stackoverflow.com/questions/11183174/simplest-way-to-detect-a-pinch)适用于 iPad，但不适用于 Android。

在 Android 网络平台上检测相同的等效方法是什么？

任何帮助表示赞赏。

**编辑：**我一直在尝试[touchy.js](https://github.com/HotStudio/touchy)，它适用于对图像进行放大和缩小，但是**如果无法通过手指滑动或类似的方式访问图像的一部分，则放大图像是没有用的**。

例如，考虑以下代码：

```
 <div style=" border: 1px solid blue; width: 560px; overflow:scroll;">
      <p>&nbsp;</p>
      <img id="image" src="images/tux.png" alt="my image" style=" border: 1em solid gray;" />
    </div> 
```

我需要将图像留在 div 内，并且用户在放大后应该能够在图像周围移动。但是使用此代码，我必须在空白区域（由段落标签创建）上滑动手指才能水平转到图像的不同部分。垂直方向也是如此（您必须在网页上的空白处滑动手指才能看到图像长度）。我想说的是，*在图像内滑动动作没有任何效果*，而用户**希望**在放大图像后这样做。

没有示例很难解释，我尝试创建[http://jsfiddle.net/Debarupa/8peaf/](http://jsfiddle.net/Debarupa/8peaf/)但它不能像我希望的那样工作，因为我无法编辑头部的元数据。我需要补充：

```
 <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1" /> 
```

使整个网页不可缩放。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-15T20:11:39.333

您可以通过监控用户的手势并跟踪他们手指的接触点来计算自己的比例。

就像是：

```
var tracks = [];
$myElement.on("touchmove", function (event) {

    //only run code if the user has two fingers touching
    if (event.originalEvent.touches.length === 2) {

        //track the touches, I'm setting each touch as an array inside the tracks array
        //each touch array contains an X and Y coordinate
        tracks.push([ [event.originalEvent.touches[0].pageX, event.originalEvent.touches[0].pageY], [event.originalEvent.touches[1].pageX, event.originalEvent.touches[1].pageY] ]);
    }
}).on("touchstart", function () {
    //start-over
    tracks = [];
}).on("touchend", function () {
    //now you can decide the scale that the user chose
    //take the track points that are the closest and determine the difference between them and the points that are the farthest away from each other
}); 
```

但是，如果您想使用预制的东西，那么我建议您查看 Touchy：[https ://github.com/HotStudio/touchy](https://github.com/HotStudio/touchy)

# php - 在 Symfony2 项目中找不到类“PHPUnit_Framework_TestCase”

> ID：12900916
> 
> 赞同：5
> 
> 时间：2012-10-15T17:30:22.220
> 
> 标签：php, symfony, phpunit

我正在 symfony2 中开发一个项目，而且我是单元测试的新手。

我已经通过 PEAR 安装了 PHPUnit 3.6.10，当我输入 phpunit 命令时，它可以在终端上运行。

我按照 SensioLab 的建议（[http://symfony.com/doc/current/book/testing.html](http://symfony.com/doc/current/book/testing.html)）编写了我的第一个测试类，但是当我使用命令时

```
php -c app src/My/CalendarBundle/Tests/Calendar/CalendarTest.php 
```

我有

```
Fatal error: Class 'PHPUnit_Framework_TestCase' not found in /Library/WebServer/Documents/calendar/src/My/CalendarBundle/Tests/Calendar/CalendarTest.php on line 7 
```

这是我的测试课：

```
<?php
namespace My\CalendarBundle\Tests\Calendar;

use My\CalendarBundle\Calendar\Calendar;

class CalendarTest extends \PHPUnit_Framework_TestCase
{
    public function testGetNextMonth()
    {
        $calendar = new Calendar('09', '2012', null);        
        $result = $calendar->getNextMonth();

        $this->assertEquals(10, $result);
    }
} 
```

我读了这个讨论[为什么，致命错误：在...中找不到类'PHPUnit_Framework_TestCase'？](https://stackoverflow.com/questions/6065730/why-fatal-error-class-phpunit-framework-testcase-not-found-in)但是 symfony 文档并没有说包含 PHPUnit ......

我做错了什么？谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-04-07T14:51:07.340

我刚刚遇到了类似的问题（使用 DoctrineFixturesBundle），并通过**将 PHPUnit 添加到 Symfony 来**解决它（而不是通过 PEAR 安装 PHPUnit）。

对我有用的是：

1）添加`"phpunit/phpunit": "4.0.*"`到`require`部分`composer.json`：

```
{
    "require": {
        ...
        "phpunit/phpunit": "4.0.*"
    }
} 
```

2）从命令行运行：

```
php composer.phar update phpunit/phpunit 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T02:02:28.483

万一有人遇到类似的问题。

1-按照以下[过程安装](http://symfony.com/doc/master/contributing/code/tests.html)**PHPUnit**：

```
$ pear config-set auto_discover 1
$ pear install pear.phpunit.de/PHPUnit 
```

2- 如此处所述运行您的[测试](http://symfony.com/doc/master/book/testing.html)：

```
$ phpunit -c app/ src/My/CalendarBundle/Tests/Calendar/CalendarTest.php 
```

该`-c app/`选项将在`app/`目录中查找配置文件。这个配置文件是`app/phpunit.xml.dist`.

# android - Android：尝试导入项目并继续获取无法执行 dex：错误

> ID：12900920
> 
> 赞同：1
> 
> 时间：2012-10-15T17:30:43.123
> 
> 标签：android

我导入了一个 android 项目，看起来一切正常（我可以看到项目中的所有文件）。当我尝试运行它时，出现以下错误无法执行 dex：Java 堆空间 Java 堆空间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:48:41.323

在此[线程](https://stackoverflow.com/questions/5943712/conversion-to-dalvik-format-failed-unable-to-execute-dex-java-heap-space)中引用[@JohnnyLambada](https://stackoverflow.com/users/9648/johnnylambada)尝试

修改`-XmsAm`和`-XmxBm`参数，`eclipse.ini`使它们足够大。默认值为`-Xms40m` `-Xmx384m`. 尝试将它们都更改为`-Xms512m` `-Xmx512m`并重新启动 Eclipse 以查看是否有帮助。如果没有，请继续增加值并重新启动 eclipse，直到发生以下两种情况之一：

您的构建完成。Eclipse 不会重新启动，因为您没有足够的内存。eclipse.ini 位于`/etc/eclipse.ini`Ubuntu 中（假设您从 Ubuntu 存储库安装了 Eclipse）或搜索您将 eclipse For Windows 放在哪里。

# wordpress - 使用 Vim 或类似工具查找 Wordpress 钩子和过滤器

> ID：12900921
> 
> 赞同：1
> 
> 时间：2012-10-15T17:30:43.850
> 
> 标签：wordpress, bash, unix, vim

Wordpress 允许您使用“钩子”和“过滤器”扩展其核心。例如，为了在执行过程的早期执行一些事情，我可以写

```
add_action( 'init', function() { // Do something } ); 
```

过滤器的工作方式类似。定义一个钩子的函数是`do_action`，所以创建一个核心开发者写的init钩子

```
do_action( 'init' ); 
```

do_action 接受这个钩子没有展示的几个可选参数。过滤器的函数名称是 add_filter 和 apply_filter。

假设我正在浏览某个插件的源代码，它使用了来自其中一个源文件的钩子，但我不知道是哪一个。找到它的最简单方法是什么？

在 Vim 中，我经常使用 ctags，我希望可以做类似的事情，只是我可以给出过滤器或钩子名称，而不是给出函数名称。有任何想法吗？

（如果不能在 Vim 中完成，比如 ctags，第二好的是运行一个命令来为我定位脚本。如果这是最好的解决方案，这也是可以接受的）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:48:58.437

> 假设我正在浏览某个插件的源代码，它使用了来自其中一个源文件的钩子，但我不知道是哪一个。找到它的最简单方法是什么？

我使用 grep。没有它就无法工作。`grep`得到我想要的任何东西。`grep -Rni "do_action( 'init'" *`应该找到'init'钩子。如果需要，您可以在搜索字符串中使用正则表达式，并告诉它忽略特定文件和/或目录。我尝试过其他选择，但从未在其他任何地方出售过。`grep`又快又干净。

这不是“Vim”答案，但您确实说过“或类似”:)

[在http://adambrown.info/p/wp_hooks/version/3.4](http://adambrown.info/p/wp_hooks/version/3.4)也有一个非常好的钩子数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-08T13:29:28.260

我最近不得不这样做很多，所以我写[了一个小的 Vim 插件](https://github.com/borzhemsky/wp-hook-finder)来简化这个过程。

只需将插入符号放在挂钩或过滤器的名称上，按`Leader`+`f`查找挂钩函数，或按`Leader`+`F`查找挂钩/过滤器定义。

安装：

```
cd ~/.vim/bundle && git clone https://github.com/borzhemsky/wp-hook-finder.git 
```

将键绑定添加到 ~/.vimrc：

```
nnoremap <Leader>f :FindWPHook<CR>
nnoremap <Leader>F :FindWPHookDef<CR> 
```

**站点注释：**写这篇文章告诉我，是的，人们会使用`add_filter`钩子来定义钩子`do_action`，因此手动搜索事件可能容易出错。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T20:09:35.147

从基本到相当复杂：

**GREP**

已经解释过了。

**来自 Vim 或 VIMGREP 的 GREP**

如果您已经在 Vim 中，您可以使用该`:vimgrep`命令或其姊妹`:grep`：

```
:vim "do_action( 'init' )" **/*.php | copen 
```

请参阅让您进行递归搜索`:help starstar`的通配符。在使用时使用内部方法，嗯…… 。后者可能更快。`**``:vimgrep``:grep``grep`

**CTAGS**

假设您已经`ctags`安装，索引可以在 shell 或 Vim 中完成：

```
$ ctags -R . <-- in the shell
:!ctags -R . <-- in Vim 
```

并且查询只是一个问题`:tag do_action`。阅读`:help tags`以获得深入的解释。

**CSCOPE**

假设您已经`cscope`安装，您可以直接从 shell 使用它：

```
$ cscope -R *.php 
```

创建索引后，您可以在`cscope`的界面中搜索并在编辑器中打开所选文件。

假设你的 Vim 带有 cscope 支持，你必须：

1.  创建索引，`:!cscope -bR *.php`

2.  找到索引，`:cs add cscope.out`

3.  *f*找到*d*定义，`:cs f d do_action`

还有其他专门的工具，例如[Codesearch](https://code.google.com/p/codesearch/)或[GNU Global](http://www.gnu.org/software/global/)，但我认为您实际上并不需要比普通`grep`的或最多`ctags`.

# intellij-idea - 如何在 IntelliJ IDEA 中设置环境变量？

> ID：12900923
> 
> 赞同：11
> 
> 时间：2012-10-15T17:30:50.973
> 
> 标签：intellij-idea, environment-variables

如何（在哪里？）我可以使用 IntelliJ 想法设置环境变量？

例如，我期待设置`$APP_HOME`（我的测试依赖）。

请问这个可以在哪里做？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-15T17:40:42.247

大多数运行配置都有设置环境变量的选项：

![在此处输入图像描述](../Images/5424796806c7865d6a55ee55df6f4a6a.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:39:45.160

构建设置窗口有一个配置选项卡，其中包含更改环境变量的选项。

[http://www.jetbrains.com/idea/webhelp/run-debug-configuration-application.html](http://www.jetbrains.com/idea/webhelp/run-debug-configuration-application.html)

否则，您可以使用系统系统调用或 java 语言本身在运行时更改它们。

[如何从 Java 设置环境变量？](https://stackoverflow.com/questions/318239/how-do-i-set-environment-variables-from-java)

# ios - Twitter反向认证错误

> ID：12900924
> 
> 赞同：4
> 
> 时间：2012-10-15T17:30:52.923
> 
> 标签：ios, twitter, ios6, oauth-2.0, iphone-5

注意：我使用的代码可以在 iOS 5 上完美运行。什么也没有变。

在通过 twitter 反向身份验证的动作时，我收到此错误：

```
<?xml version="1.0" encoding="UTF-8"?>
<errors>
<error code="89">Error processing your OAuth request: invalid signature or token</error>
</errors> 
```

我检查以确保我的令牌和其他凭据有效。这里唯一的区别是我使用的是 iPhone 5，和/或我使用的是 iOS 6。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T08:40:37.220

我发现，在 iPhone 5 上，TWRequest 只是没有将 oauth_token 添加到授权标头中。希望这将很快得到解决...

更新：从我的 iPhone 上删除我的 Twitter 帐户后，它现在似乎可以工作了。我还从 Safari 中清除了我的缓存（也许这也可以解决）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-22T23:01:07.067

在我的 iOS 7 设备上，当手机上存储的 Twitter 用户名/密码（可从“设置”应用程序访问）过时/不正确时，就会发生这种情况。

我很困惑，因为它适用于某些帐户而不适用于其他帐户。您将知道帐户信息是否错误，因为它会在您访问“设置”应用程序中的帐户后立即告诉您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T14:43:48.677

**首先要检查**：确保您的服务器没有因为长度太长而拒绝令牌。这对我来说是个问题。出于某种原因，iPhone 5 上的令牌比 iPhone 4 长。

**要检查的第二件事**：您是否已注册您的 Twitter 应用程序以使用反向身份验证？你需要得到许可。

*您的应用程序的密钥尚未启用反向身份验证权限*

请参阅有关此的文档。[https://dev.twitter.com/docs/ios/using-reverse-auth](https://dev.twitter.com/docs/ios/using-reverse-auth) 如果您没有使用反向认证的权限，它将无法工作。

# ruby-on-rails - 如何使用 ruby on rails 3.2 将 ajax 添加到 jquery-ui 滑块

> ID：12900925
> 
> 赞同：2
> 
> 时间：2012-10-15T17:30:55.060
> 
> 标签：ruby-on-rails, ruby, ajax, jquery-ui, slider

所以我正在关注这个过时的关于使用带有 rails 3 beta 的 jquery-ui 滑块的教程，因为它是我发现的唯一一个。

我的观点有剧本

```
<p>
  <p>Showing all stocks between <span id="x_low_selected"><%= @price_range.first %></span> and <span id="x_high_selected"><%= @price_range.last %></span></p>
</p>
<div id="x_slider"></div>
<ul id="x_stock_list">
<%= render 'map' %>
</ul>
<script type="text/javascript">
  $(function() {
  $("#x_slider").slider( { 
    range: true,
    step: 1,
    max: <%= @price_range.last %>,
    min: <%= @price_range.first %>,
    values: [<%= @price_range.first %>, <%= @price_range.last %> ],
    stop: function(event, ui) {
    var prices = $('#x_slider').slider('option', 'values');
    $('#x_low_selected').html(prices[0]);
    $('#x_high_selected').html(prices[1]);
    $.ajax({
        url: 'http://localhost:3000/users',
        type: "GET",
        data: { low: prices[0], high: prices[1] },
        dataType: 'json'
    });
   }
  });
});
</script> 
```

价格模型法

```
def self.low_high_prices
  [User.minimum(:start), User.maximum(:end)]
end 
```

以及 ajax 应该调用的控制器中的 index 方法

```
def index
  @users = User.all
  unless params[:low] && params[:high]
    @users = User.all
    @json = User.all.to_gmaps4rails do |user, marker|
    marker.infowindow "<a href=/users/#{user.id}> #{user.name} </a>"
    marker.title user.name
  end
else
  @json = User.where("start >= params[:low] AND end <= params[:high]).to_gmaps4rails do |user, marker|
    marker.infowindow "<a href=/users/#{user.id}> #{user.name} </a>"
    marker.title user.name
  end
end
@price_range = User.low_high_prices
  respond_to do |format|
    format.html # index.html.erb
    format.json { render json: @users }
  end
end 
```

有谁知道为什么当滑块停止滑动时没有将 ajax 调用发送到控制器？不确定我是否可以使用 :remote => true 因为滑块是在 div 内生成的。

谢谢

另外我目前正在使用带有 ruby​​ 1.9.7 的 rails 3.2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T22:09:44.043

我猜你的电话正在通过控制器，并且控制器正在返回 JSON 数据。

问题是您的`$.ajax`呼叫对收到的 JSON 数据没有任何作用。

您需要添加一个回调函数来处理在 ajax 调用中以某种方式传回的 JSON 数据：

```
$.ajax({
    url: 'http://localhost:3000/users',
    type: "GET",
    data: { low: prices[0], high: prices[1] },
    dataType: 'json',
    success: function (data) {
        alert("Success: " + data);
        //do something with the data here.
    }
}); 
```

此外，查看控制器代码，它只会传回`@users`JSON 数据中的内容，而不是内容`@json`或其他任何内容 - 不确定这是否是您的意图。

# android - YYY 项目在其构建路径上没有任何 GWT SDK

> ID：12900928
> 
> 赞同：1
> 
> 时间：2012-10-15T17:31:12.500
> 
> 标签：android, eclipse, gwt, maven

Eclipse 向我报告了一个问题：

> 项目 XXX 在其构建路径上没有任何 GWT SDK

...而且我很难弄清楚这个问题来自哪里以及如何解决它。

您需要知道的第一件事是，我正在从事的项目不是 GWT 项目，也从来都不是 GWT 项目。相反，这是一个 android 项目，它使用 Maven POM 来组织其设置。

GWT 在 POM 中没有提到，“.classpath”或“.project”中也没有提到 - 或者，就此而言，在我的项目根目录下的任何文件中的任何地方都没有提到。

所以 Eclipse 在某些方面显然被误导了。[此处输入链接描述](https://stackoverflow.com/questions/8540620/the-project-xxx-does-not-have-any-gwt-sdks-on-its-build-path "这个类似的问题")中的标准答案似乎都不适用于我的情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T22:26:13.437

我最终想通了。事实证明，团队的另一位成员在 .project 文件中发现了一个与 gwt 相关的违规行。他们修复并提交了他们的更改，这就是为什么我在那里看不到任何东西。同时，我的 Eclipse 从未发现有问题的行已被删除，所以我必须做的是右键单击问题选项卡中的问题并删除该特定问题。从此，我的Eclipse不再迷茫。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-01T16:37:50.153

您可能希望将以下行放入`.classpath`文件中

```
<classpathentry kind="con" path="com.google.gwt.eclipse.core.GWT_CONTAINER"/> 
```

然后右键单击您的**项目**并选择**刷新**（或简单地`F5`）。

在此之后，转到您的**项目**并选择**clean**。它应该会自动重建您的所有项目。

# c# - SQL中的数据分组

> ID：12900930
> 
> 赞同：7
> 
> 时间：2012-10-15T17:31:23.090
> 
> 标签：c#, sql, entity-framework

我正在使用 C# 和 EF5.0 开发一个小项目，我需要对一些数据进行分组。假设我在建筑物中有列表，如下所示。

```
+----------+--------Columns Table--+------+------+
| ColumnID |ColumnName|Width|Length|Height|number| 
+----------+----------+-----+------+------+------+
|        1 |   C101   |  50 |   70 | 250  | 1    |  
|        2 |   C102   |  70 |   70 | 250  | 1    |    
|        3 |   C103   |  70 |   60 | 250  | 1    |    
|        4 |   C104   |  90 |   70 | 250  | 1    |     
|        5 |   C105   |  40 |   50 | 250  | 1    |     
|        6 |   C106   |  50 |   70 | 250  | 1    |    
|        7 |   C107   |  50 |   60 | 250  | 1    |    
|        8 |   C108   |  70 |   70 | 250  | 1    |     
+----------+----------+-----+------+------+------+ 
```

我需要一个 C# 代码来查看上述分组的数据，如下所示：

```
+----------+---Groupped Columns Table-----+------+
|G_ColumnID|ColumnName|Width|Length|Height|number| 
+----------+----------+-----+------+------+------+
|        1 |C(101-106)|  50 |   70 | 250  | 2    |  
|        2 |C(102-108)|  70 |   70 | 250  | 2    |    
|        3 |   C103   |  70 |   60 | 250  | 1    |    
|        4 |   C104   |  90 |   70 | 250  | 1    |     
|        5 |   C105   |  40 |   50 | 250  | 1    |         
|        6 |   C107   |  50 |   60 | 250  | 1    |            
+----------+----------+-----+------+------+------+ 
```

我更喜欢线索而不是确切的解决方案。

**编辑：**下面的代码显示了我当前的状态。我想我可以使用此代码找到具有相同高度、宽度和长度的列。但我不确定如何为该组生成一个新名称。

```
using (pehlivanEntities context = new pehlivanEntities())
{           
     foreach (var item in context.table1)
     {               
          int id = item.ColumnID;
          foreach (var item2 in context.table1)
          {
               int id2 = item2.ColumnID;
               if (id != id2)
               {
                   if (item.Width == item2.Width)
                   {
                       if (item.Length == item2.Length)
                       {
                            if (item.Height == item2.Height)
                            {
                               //Alter item.ColumnName
                               //increase item.number by one
                               //Remove item2
                            }
                       }
                   }
               }
          }
     }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T17:37:48.497

好吧，您将从对复合键进行分组开始：

```
var groups = myData.GroupBy(d => new{d.Width, d.Length, d.Height}) 
```

然后

```
groups
 .Select(g => new {
    g.Key.Width, 
    g.Key.Length, 
    g.Key.Height, 
    columnNames = g.Select(x => x.ColumnName),
    number = g.Count()}) 
```

`columnNames`然后在字段上进行一些字符串操作

# javascript - 使用保存的密码使输入元素内的标签消失

> ID：12900934
> 
> 赞同：1
> 
> 时间：2012-10-15T17:31:40.230
> 
> 标签：javascript, html, css

我在输入字段中放置了标签，以便在背景中显示说明性文本，当用户在字段中键入时，文本消失。我正在使用此处解释的示例：[如何在 <input> 元素内创建标签？](https://stackoverflow.com/questions/781473/how-to-create-a-label-inside-an-input-element) 特别是在[http://attardi.org/](http://attardi.org/)

当密码被浏览器保存时，例如在谷歌浏览器中，文本变得像这张图片一样乱码（目前在我的本地计算机上）： ![显示和保存的密码文本](../Images/64ec045310ce5bac97f581a383d74594.png)

已保存密码的背景文本不会消失。任何帮助将不胜感激 - 谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T17:34:29.393

您还可以利用新`placeholder`属性。[在这里阅读](http://www.w3schools.com/html5/att_input_placeholder.asp)。

不过不`IE`支持。

选项 2 将使用`Jquery`. 由于您已经在使用`Jquery`该`label`解决方案，因此您可以添加代码来检查文档加载后`value`的`input`，然后相应地显示或隐藏`label`。

此代码将进入[文档就绪函数](http://api.jquery.com/ready/)：

```
$(function() {
    // Handler for .ready() called.
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:06:27.670

只需使用`placeholder`属性——它就是这么简单：

```
<input type="email" placeholder="email" /> 
```

从字面上看，就是这样；浏览器将处理该行为。

是的，它不能在 IE 中工作（直到 IE10 发布）——但无论如何你已经在字段旁边有了标签，所以 IE 用户不会无法分辨哪个字段是哪个字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T23:43:44.073

我进一步调查，这仅发生在 Google Chrome 而不是 Mozilla Firefox 中。我的设置是正确的，看起来它实际上可能是 Chrome 中的一个错误。查看问题日志：[http ://code.google.com/p/chromium/issues/detail?id=117661](http://code.google.com/p/chromium/issues/detail?id=117661)

当 Chrome 尝试执行密码自动保存过程并且不查看是否有以前输入的值时，占位符属性也会发生这种情况。

感谢大家的投入。

# ruby - Sidekiq 工作人员比 Resque 慢

> ID：12900935
> 
> 赞同：1
> 
> 时间：2012-10-15T17:31:43.967
> 
> 标签：ruby, heroku, amazon-ec2, resque, sidekiq

我在生产中尝试使用 sidekiq 和我的 resque 系统。现在我知道这不是一个苹果与橘子的比较，但我在 heroku 工人上运行的 resque 工作大约需要 4 秒才能完成。我在一个带有 sidekiq 的亚马逊大型实例上只运行了 50 个线程，相同的作业平均需要 18 秒左右。使用第三方 api 的工作非常繁重，所以我假设我的瓶颈只是我的网络连接，但我只是想看看是否有人对我如何更好地配置 sidekiq 有建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-10T09:50:49.990

只有使用 jruby 或 rubinius，Sidekiq 工作人员才能并行工作，因为 ruby​​ mri 具有全局解释器锁定

只有将 jruby 或 rubinious 与线程安全库一起使用，Sidekiq 工作人员才能更快地工作，这不会阻止他们使用的资源。所以使用sidekiq而不是resque的主要原因是节省内存

# c# - 截断的二十面体平铺对象

> ID：12900938
> 
> 赞同：2
> 
> 时间：2012-10-15T17:31:51.920
> 
> 标签：c#, unity3d, hexagonal-tiles

我正在尝试制作一个截断的二十面体，尽管有更多的细分（所以更多的六边形） ![在此处输入图像描述](../Images/2cea1488190cc7f23b674defb78e7d38.png) 在我使用它的游戏中，每个五边形和六边形都是一个单独的对象。因此，在生成二十面体之后，我只需使用生成的点在其上放置一个五边形或一个六边形（而不是查找每个三角形的中间部分，我这样做是因为我需要它们成为单独的对象无论如何。）我对此有一些疑问，谷歌并没有真正的帮助，所以我希望这里有一些聪明的人：D

开始了：

1.  我确定每边的长度相等吗？
2.  由于每个六边形/五边形都是一个单独的对象，我需要旋转它们以使它们正确定位，对此有什么帮助吗？
3.  假设我有半径为 1（一）的六边形/五边形，我必须将它们放在中间多远？（Basecly，我的六边形/五边形的半径和截断的二十面体的半径之间的关系是什么。）

这是我的第一个测试，我生成了一个二十面体，然后在每个点上放置一个五边形模型，我旋转它使其指向远离中间的方向。正如您所看到的，它们仍然需要旋转才能组合在一起（问题 2），并且它们到中间的距离也必须经过调整（问题 3）。

![在此处输入图像描述](../Images/c9d13c4c48a56398971628110c5b99f0.png)

我也会继续努力，尽管所有的帮助都将不胜感激！（我是在 Unity 中使用 c# 制作的，所以如果你提供示例代码，如果你使用它会非常棒。）

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T08:01:09.057

好吧，不是您问题的答案，但也许值得考虑：

从现成的 Blender、Maya、... 足球模型开始会不会更容易，例如[Blend Swap](http://www.blendswap.com/blends/misc-objects/soccer-ball/)上的这个模型，根据您的需要进行更改。或者自己做，因为有几个 YouTube 教程。然后你会有更多的选择，比如 LOD、材质。您可以在 Blender 中将每个五边形/六边形作为单个对象进行设计，因此它将被导入 Unity。

# php - jquery 发布和响应操作

> ID：12900940
> 
> 赞同：1
> 
> 时间：2012-10-15T17:32:06.237
> 
> 标签：php, javascript, jquery, post

我有一个这样的 jquery 帖子

```
<script type = "text/javascript" >
$(document).ready(function() {
    $('#find').click(function() {
        var amount = $('#amount').val();
        $.ajax({
            type: "POST",
            contentType: "application/x-www-form-urlencoded;charset=utf-8",
            url: "questions.php",
            data: {
                'amount': amount
            },
            success: function(data) {
                $('#results').show();
                $('#results').html(data);
            }
        });
    });
});
</script> 
```

并且成功的数据有一个这样的php数组

```
Array ( [0] => mpla mpla [1] => mplum mplum .... 
```

如何在屏幕上显示项目之前使用 jquery 或 javascript 获取项目。

我只想要链接的文本

```
mpla mpla -->that is a link

mplum mplum -->that is a link too 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:35:51.370

在你的 php.ini 文件中。做一个：

```
echo json_encode( YOUR ARRAY ); 
```

将您的 jQuery $.ajax 设置数据类型设置为 json。

在您的成功功能中，您现在可以使用

```
success : function(data){
    // data is now a javascript array
    var st = data.join(" ");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:35:03.210

首先，您需要将其转换为 json 格式...

然后您可以使用`$.each`循环访问它们

```
$.each(data , function(i , value){

    console.log( 'Index - ' + i + ' = ' + value );
}); 
```

# ruby-on-rails - 为什么不能在控制器测试中使用路由器路径？

> ID：12900941
> 
> 赞同：2
> 
> 时间：2012-10-15T17:32:09.687
> 
> 标签：ruby-on-rails, ruby, rspec, routes

为什么在 Rails 3 中测试控制器时不能使用路由器路径？

我明白`get :new`翻译成`{controller: 'sessions', action: 'new'}`，但为什么不`signin_path`翻译成同样的东西？例如：

```
# routes.rb
match 'signin', to: 'sessions#new'

# sessions_spec.rb
it "renders the 'new' template" do
  get signin_path
  response.should render_template :new
end 
```

产生：

```
No route matches {:controller=>"sessions", :action=>"/signin"} 
```

如果有办法像在应用程序中那样使用路由器语法来测试路由，例如`get signin_path`代替`{ get: 'http://app.com/signin/' }`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T18:46:17.883

一开始我也很难理解这一点。让我试着解释一下我是如何理解它的。

我假设您的引导线如下所示：

```
describe SessionsController do 
```

在控制器规范中，控制器类是您的主题，而不是路由系统。这就是为什么您应该在控制器中测试单个操作方法，而不是通向它们的路由。换句话说，即使您更改了路由，控制器规范也应该仍然有效。

所以你甚至不应该这样做：

```
it "renders the 'new' template" do
  get 'http://app.com/signin/'
  response.should render_template :new
end 
```

你应该这样做：

```
it "renders the 'new' template" do
  get :new
  response.should render_template :new
end 
```

然后，RSpec 会以某种方式确定您要尝试的路线。我注意到，当我搞砸某些东西时，它会给我一个路由错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T17:56:38.813

在你的 routes.rb 中试试这个

`match 'signin' => 'sessions#new', :as => :signin`

# gwt - GWT 捕获拖放事件

> ID：12900945
> 
> 赞同：2
> 
> 时间：2012-10-15T17:32:22.527
> 
> 标签：gwt, drag-and-drop

我正在尝试捕获拖放事件。现在我正在捕获这些事件，将 dom 处理程序添加到我的 RootLayoutPanel：

```
dragOverHandler = RootLayoutPanel.get().addBitlessDomHandler(this, DragOverEvent.getType());
dropHandler = RootLayoutPanel.get().addBitlessDomHandler(this, DropEvent.getType()); 
```

问题是这段代码在显示弹出窗口时没有捕获事件，并且拖放在弹出窗口本身或其周围的玻璃上。

我也尝试过使用本机预览处理程序，但似乎没有在拖放事件上调用它：

```
Event.addNativePreviewHandler(new Event.NativePreviewHandler() {            
    @Override
    public void onPreviewNativeEvent(NativePreviewEvent event) {
        GWT.log(event.getNativeEvent().getType());  
    }
}); 
```

是否有直接的方法来捕获我的应用程序中的所有拖放事件？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T18:12:06.690

尝试使用`RootPanel.get()`而不是`RootLayoutPanel.get()`.

仅供参考，`RootLayoutPanel.get()`将`RootLayoutPanel`单例添加到`RootPanel.get()`; `RootPanel.get()`将文档包装`<body>`在 a`RootPanel`中，因此它应该捕获所有内容（前提是*主体*填充了视口，这是`RootLayoutPanel`确保的）。

# javascript - 行为/样式分离 - 如何为 CSS 和 JavaScript 使用 ID、类和自定义属性？

> ID：12900948
> 
> 赞同：1
> 
> 时间：2012-10-15T17:32:29.127
> 
> 标签：javascript, jquery, html, css, jquery-selectors

我想阐明设计人员/开发人员工作流程方面的良好实践。

这是我的观察，如果我错了，请告诉我：CSS 和 JS 应该使用相同的属性没有根本原因。与 html 标签关联的事件与应用于它的样式无关，将它们分开将有助于开发人员和设计人员的维护。

我的问题是：为什么两者之间没有严格的区分？我知道我们可以自由地为 JavaScript 使用自定义属性，并为 CSS 保留 ID、类和 HTML 标记名称，但是 jQuery 中的一切似乎都是为了使用它们。例如 ：

```
$("#myid").html("Test");
$("#myid").addClass("clickable");
$("#myid").removeClass("clickable");
if($("#myid").hasClass("clickable")) var clickable = true; 
```

等等 为什么会这样？

附带问题：仅对 JavaScript 使用自定义属性是否存在一些性能问题？

```
$('[event="clickable"]').html("Test"); 
```

Roy Tomeij 的这篇文章[http://roytomeij.com/2012/dont-use-class-names-to-find-HTML-elements-with-JS.html](http://roytomeij.com/2012/dont-use-class-names-to-find-HTML-elements-with-JS.html)在 stackoverflow 中提到：[JS 和 CSS 的单独 ID 和类](https://stackoverflow.com/questions/9260004/separate-id-and-class-for-js-and-css/)似乎建议不要在 Javascript 中使用类，但这就是我目前发现的所有内容，我想扩大讨论范围。

对于 CSS 和 JavaScript 来说，拥有这两项是很有价值的：唯一 ID 和多个类，但是当我想到它时，我们可以拥有 div，例如

```
 <div css_id="mydiv" css_class="green" js_id="unique_element" js_class="other_event"> 
```

以及假设的 CSS 属性和 jQuery 函数，例如

```
div#mydiv{margin_top:20px;} //reads from css_id attributes
div.green{color:green;} //reads from css_class attributes

$("#unique_element").click(function(){alert("Clicked!")}) //reads from js_id attributes
$(".other_event").click(function(){alert("Congratulations!")}) //reads from js_class attributes 
```

并且以同样的方式

```
$("#unique_element").addClass("clickable2"); //add a value to the js_class attribute 
```

谢谢你们！我不打算为了探索改进团队工作流程的方法而重新发明一切。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T18:06:49.000

我想你可以回答你自己的问题。看起来像这样的标记有什么好处？

```
 <div css_id="mydiv" css_class="green" js_id="unique_element" js_class="other_event"> 
```

对我来说，它看起来很混乱，更难处理。理论上，内容为王，一开始你有一个标记精美的语义 HTML 文档。深思熟虑后，您根据其中的内容添加语义类名称和 ID。使用这些 ID 和类，您可以分别使用 CSS 和 JavaScript 将设计和功能装订到您的文档中。

要回答您的其他问题，[JavaScript 的 ID 更快](https://stackoverflow.com/questions/5029254/is-id-selector-faster-than-class-selector-when-it-is-cached-in-jquery)。如果您使用的是 JQuery，那么如果您将 DOM 引用缓存为变量（如果您引用一个以上的元素时应该始终这样做），则性能可以忽略不计。例如，`var $myclass = $('.myclass');`您可以在此处阅读有关[选择器性能](http://www.componenthouse.com/article-19)的更多信息。

对于 CSS，许多人建议尽可能避免使用 ID 进行样式设置。您可以阅读有关 specificity 的[规范](http://www.w3.org/TR/CSS21/cascade.html)，但基本上使用大量 id 会导致一些与 using 相同（尽管不太极端）的问题`!important`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T18:46:04.883

我见过的最好的是：

```
<div class="button button-primary js-modal-popup"> 
```

本质上 - 添加一个带有`js-`前缀的类，这样你就可以区分你的风格类和你的 jQuery 钩子。它允许您创建任意数量的 ID 或类，而不会限制您的样式也与操作相关联。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T18:15:04.430

*CSS 和 JS 应该使用相同的属性没有根本原因。*

这是真的。它们是两种不同的语言……所以，是的。没有“根本原因”为什么他们应该使用相同的属性。

*然而，jQuery 中的一切似乎都是为了使用它们。*

不过，我不认为这是真的。JQuery 具有特定的功能`class`，等等，因为它们是现有的`CSS`属性。但它对自定义属性也有相同的功能，所以这里没有不对称性。我不认为这可以用作 Jquery 使用`CSS`属性而不是自定义属性的证据。

至于您的性能问题或使用哪个问题，我认为 bookcasey 充分回答了这些问题。

# c - C - scanf 行为不端

> ID：12900949
> 
> 赞同：0
> 
> 时间：2012-10-15T17:32:31.140
> 
> 标签：c, scanf

当使用第一个 scanf() 并且您回答 Y 时，第二个 scanf() 直接跳到“未选择选项。退出...”。当密钥文件大于源文件并且最后一个 scanf 正常工作时，也会出现该消息。所以我在这里不知所措，怎么了？（代码编译得很好，所以请随意尝试）

编辑：至少发布一个理由对投票者有帮助。我不是一个很好的程序员，只是想在这里学习。

```
#include <stdio.h>
#include <stdlib.h>
#include <sys/stat.h>

int main(int argc, char **argv)
{
struct stat statbuf;
struct stat keybuf;

int key;
int data;
int output;
int count;
char ans;
FILE * keyfile;
FILE * sourcefile;
FILE * destfile;

if(argc<4)
{
printf("OTP-Bunny 1.0\n");
printf("USAGE: OTP <source file> <output file> <keyfile>\n");
return (0);
}

/* Check number of arguments. */
if(argc>4)
{
printf("Too many arguments.\n");
printf("USAGE: OTP <source file> <output file> <keyfile>\n");
return(1);
}

/* Check if sourcefile can be opened. */
if((sourcefile = fopen(argv[1], "rb"))== NULL)
{
printf("Can't open source file.\n");
printf("Please enter a valid filename.\n");
printf("USAGE: OTP <source file> <output file> <keyfile>\n");
perror("Error");
return (1);
}

/* Get size of sourcefile */
fstat(fileno(sourcefile), &statbuf); 

/* Check if keyfile can be opened. */
if((keyfile = fopen(argv[3], "rb"))== NULL)
{
printf("Can't open keyfile.\n");
printf("Please enter a valid filename.\n"); 
printf("USAGE: OTP <source file> <output file> <keyfile>\n");
perror("Error");
return(1);
}                               

/* Get size of keyfile */
fstat(fileno(keyfile), &keybuf);

/* Check if keyfile is the same size as, or bigger than the sourcefile */
if((keybuf.st_size) < (statbuf.st_size))
{
printf("Source file is larger than keyfile.\n");
printf("This significantly reduces cryptographic strength.\n");
printf("Do you wish to continue? (Y/N)\n");
scanf("%c", &ans);
if(ans == 'n' || ans == 'N')
{
return (1);
}
if(ans == 'y' || ans == 'Y')
{
    printf("Proceeding with Encryption/Decryption.\n");
    }
else
{
printf("No option selected. Exiting...\n");
return (1);
}
}   

/* Check if destfile can be opened. */
if((keyfile = fopen(argv[2], "wb"))== NULL)
{
printf("Can't open output file.\n");
perror("Error");
return(1);                  
}    

/* Open destfile. */
destfile=fopen(argv[2], "wb");

/* Encrypt/Decrypt and write to output file. */
while(count < (statbuf.st_size))
{
key=fgetc(keyfile);
data=fgetc(sourcefile);

output=(key^data);

fputc(output,destfile);
count++;
}

/* Close files. */
fclose(keyfile);
fclose(sourcefile);
fclose(destfile);

printf("Encryption/Decryption Complete.\n");

/* Delete keyfile option. */
printf("Do you wish to delete the keyfile? (Y/N)\n");
scanf("%c", &ans);
if(ans == 'y' || ans == 'Y')
{
if ( remove(argv[3]) == 0)
    {
    printf("File deleted successfully.\n");
    }
else
    {
    printf("Unable to delete the file.\n");
    perror("Error");
    return(1);
    }
}

if(ans == 'n' || ans == 'N')
{
return(0);
}
else
{
printf("No option selected. Exiting...\n");
}
return(0);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T17:37:50.230

实际上，`scanf()`它的行为是正确的，但要正确使用它是一个非常棘手的功能，并且您的期望很容易与其记录的行为不同。

您的第一个`scanf()`调用读取一个字符，将换行符留在后面。

您的第二个`scanf()`电话读取换行符，因为那是下一个......导致问题。

您可以使用`" %c"`;修复代码 前导空白跳过（可选）空白。

一般来说，更好的解决方法是使用`fgets()`或等效的组合（`readline()`可能在 POSIX 2008 中）和`sscanf()`. `fgets()`用;将一行数据读入内存 用 分析它`sscanf()`。这样，您也可以更好地报告错误；您拥有用户键入的所有可用于错误报告的信息。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-15T17:37:37.200

这是 scanf 的标准行为，即仅在遇到空格或换行符时才接受输入，并将 \n 留在输入缓冲区中，作为下一条语句的输入。

您可以在每次调用后使用 cin.ignore() 来避免它，除非您使用的是严格的 c 而不是 c++。在那种情况下，使用可能是 fgets 会好得多

# wpf - BeginInvoke 可以和 BackgroundWorker 做同样的事情吗？

> ID：12900950
> 
> 赞同：0
> 
> 时间：2012-10-15T17:32:32.153
> 
> 标签：wpf, asynchronous, backgroundworker, begininvoke

BeginInvoke 可以和 BackgroundWorker 做同样的事情吗？我的意思是最终不是都有相同的目标，即在不同的线程中执行异步操作吗？

如果我有一个 WPF 窗口 .. 并且我想使用这两种方法访问数据库。效果会一样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:39:20.997

您可以将 BackgroundWorker 替换为 BeginInvoke，但它需要一些额外的代码 BackgroundWorker 以非常友好的方式包装了后台线程的管理。

BeginInvoke 当然可以处理异步工作。它的级别有点低，所以你有更多的灵活性（代价是必须自己做更多的工作）。

# java - 如果我可以在静态块中运行代码，为什么需要 main() 方法？

> ID：12900952
> 
> 赞同：-4
> 
> 时间：2012-10-15T17:32:42.327
> 
> 标签：java, main, conventions

我知道这个事实 main() 方法是由技术定义的程序的起点。但是我们仍然可以在没有 main 方法的情况下完成整个事情而不会出现任何错误。我有这个代码

```
 public class WithoutMain {

        int x=10;
        int y=20;

        void show() {
            System.out.println(x);
            System.out.println(y);
        }

        static {
            WithoutMain t=new WithoutMain();
            t.show();
            System.exit(0);
        }

    } 
```

我可以不用main方法写这个程序，那为什么一定要有main方法呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:35:13.980

据我所知，如果没有 main 方法，您的应用程序将无法启动。即使你在那里写的把戏也没有。你真的试过了吗？

[JLS (§8.7)](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.7)说：

> **8.7\. 静态初始化器**
> 
> 类中声明的静态初始化程序在类初始化时执行（第 12.4.2 节）。与类变量的任何字段初始化器（第 8.3.2 节）一起，静态初始化器可用于初始化类的类变量。

由于没有入口点，因此没有加载单个类，这意味着具有静态初始化程序的类不会加载。所以静态初始化程序不会调用。

* * *

其他信息：

如果你不创建 main 方法，你的程序就没有入口点。这在有人编写库（例如：Java Mail）时使用。库本身不必启动。使用该库的应用程序必须创建一个 main 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T17:36:43.637

允许您传递参数并返回一个值......使用`main(String[] argv)`静态块做它不会。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T17:38:22.483

您可以在没有入口点的情况下运行程序，`main()`但不能在没有入口点的情况下运行`exe`或`jar`归档。
main方法是程序的默认入口点，可以独立运行jar文件。
如果您不尝试生成需要独立启动的程序，则不需要它 - 例如，其他程序引用的 jar 或网站。
借助这个`main()`，您可以传递参数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T17:35:56.393

在 Java 语言中，当您使用 Java 解释器执行一个类时，运行时系统首先调用该类的 main() 方法。然后 main() 方法调用运行应用程序所需的所有其他方法。

# facebook - Facebook API - 检索 URL 的喜欢

> ID：12900953
> 
> 赞同：1
> 
> 时间：2012-10-15T17:32:51.470
> 
> 标签：facebook, json, api, request, facebook-fql

我正在尝试通过 FQL 执行此操作，但我认为我正在从错误的数据库或其他东西中检索信息。

使用这个 FB Like iframe 来“喜欢”一个 URL：

```
<iframe src="//www.facebook.com/plugins/like.php?href=http://shop.sinkorswimbrand.com/product/sink-or-swim-snapback&amp;send=false&amp;layout=button_count&amp;width=46&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21" onclick="javascript:updateLikes();" style="border:none; overflow:hidden; width:46px; height:21px;" allowtransparency="true" frameborder="0" scrolling="no"></iframe> 
```

使用此 FQL URL 检索 URL 上的 JSON 信息：

```
https://api.facebook.com/method/fql.query?query=select total_count,like_count,comment_count,share_count,click_count from link_stat where url='http://shop.sinkorswimbrand.com/product/sink-or-swim-snapback'&format=json 
```

返回： ---**注意：我自己确定“喜欢”这个。**

```
[{"total_count":0,"like_count":0,"comment_count":0,"share_count":0,"click_count":0}] 
```

对 Facebook 的 API 有更多经验的人有这方面的经验吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:54:48.037

问题出在您的 og:meta 标签中。此标记位于您生成的源代码的第 31 行：

```
<meta property="og:url" content="http://www.sinkorswimbrand.com" /> 
```

这告诉 Facebook 将此页面的所有喜欢汇总到 `www.sinkorswimbrand.com`结果中。

[如果您查看URL 的调试器结果](https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fshop.sinkorswimbrand.com%2Fproduct%2Fsink-or-swim-snapback)的“重定向路径”部分，您可以看到这一点。

如果您想为每个单独的产品页面点赞，则需要为网站的每个页面使用唯一的`og:url`标签。

此外，您正在使用已弃用的 url 进行 FQL 查询。你应该使用`https://graph.facebook.com/fql?q=...`

# android - 在拖动视图时执行动画

> ID：12900954
> 
> 赞同：1
> 
> 时间：2012-10-15T17:32:52.107
> 
> 标签：android, android-animation

我有一个包含 2 个图像视图的视图，该视图使用 ondraglistener 在屏幕上移动它们并且一切正常。我现在正在尝试为其中一个图像视图设置动画，但我不确定这种效果是否可行。

动画可以正常工作，但我无法让它在被拖动的同时仍然保持动画效果。看起来一旦开始拖动，视图就会冻结，直到拖动完成。关于如何实现这一点或是否有可能的任何指示？谢谢你的建议。

编辑：看起来我将不得不覆盖 DragShadowBuilder 所以我想下一个问题是你是否可以将动画视图发送到 DragShadowBuilder ...

编辑：我猜你根本不能用 DragShadowBuilder 来做到这一点，所以试图通过覆盖 onTouch 来做到这一点......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T17:19:52.527

所以这里的一个解决方案是覆盖 onTouch 并在单击第一次“按下”时启动动画，然后在触摸移动时根据运动事件的 getX 和 getY 更新边距（或使用 x/y 平移）然后当“修饰”时，只需停止动画。此外，on touch 必须在包装视图上，而不是在您正在重置布局参数的视图上。如果有人正在寻找更具体的解释，我可以发布代码。

# php - 在我的一个页面上显示来自 php 文件的表单 - 如何？

> ID：12900955
> 
> 赞同：0
> 
> 时间：2012-10-15T17:32:53.340
> 
> 标签：php, jquery, html, contact-form, ticket-system

我在这个问题上花了一个星期，它可能真的很简单......

我在我的网站上使用 osTicket（开源支持票证系统）。我想在我的一个页面上使用ticketform 作为联系表。我只想显示表单 id="ticketForm"（请参见下面的代码），因为我不希望打开所有其余代码（带有支持中心主页、打开新工单、检查工单状态按钮等的菜单） .php 文件 - 我尝试使用 iframe，但问题太多，而且 iframe 不是一个好方法。

我想使用这部分（我没有显示所有代码，因为我认为代码中有一些敏感信息 - 希望没关系）：

```
<form id="ticketForm" enctype="multipart/form-data" action="open.php" method="post">
   <input type="hidden" value=......... etc. code for name, email, attachment fields, captcha etc.</form> 
```

来自：www.mysite.com...../support/open.php

并显示在：www.mysite.com...../contact.html

这样我就得到了一个与我在该页面上的文本融为一体的联系表格。

有什么简单的方法可以做到这一点吗？请保持温和（不要以为我知道您认为理所当然的事情）-我不是编码员:o）谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:38:22.793

在`contact.html`执行以下操作：

```
$('#result').load('/path/to/open.php #ticketForm'); 
```

这将从 open.php 检索带有 id 的表单`ticketForm`，并将其放置`result`在您的 contact.html 页面中带有 id 的 div 中。

请参阅jquery 方法的[**加载页面片段**](http://api.jquery.com/load/#loading-page-fragments)部分。`.load()`

**更新：**
您应该将上面的代码放在`<body>`您的contact.html中的document.ready处理程序中，如下所示：

```
<script type="text/javascript"> 
    $(document).ready(function() {
       $('#result').load('/path/to/open.php #ticketForm');
    });
</script> 
```

# jquery - 从按钮 onclick 调用颜色框

> ID：12900962
> 
> 赞同：0
> 
> 时间：2012-10-15T17:33:12.617
> 
> 标签：jquery, lightbox, colorbox

晚安。我正在使用 Colorbox，但我有一个问题：例如，我有一个从 1 到 10 的 colorbox 图像列表。

如何通过单击不同的按钮打开带有起始图像为图片编号 5/10 的颜色框？

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:37:39.467

又快又脏：

```
$('a').eq(5).click(); 
```

只需选择您通常单击图像 5 的 a-tag 并触发单击它。

# wpf - 如何将用户控件内的按钮绑定到另一个 ViewModel

> ID：12900967
> 
> 赞同：1
> 
> 时间：2012-10-15T17:33:30.420
> 
> 标签：wpf, datacontext

我正在开发基于 WPF 和 MVVM 的项目。我有一些 UserControl（summaryView），它有 DataContext 到 ViewModel（SummaryVM）。我想在 summaryView 中放置一个按钮并将按钮 DataContex 设置为另一个 viewModel(MainWindowViewModel) 但它对我不起作用。

这是 ViewModel 的 NameSpace

```
xmlns:vm="clr-namespace:ContentSync.ViewModel" 
```

这是我的按钮

```
<Button HorizontalAlignment="Left" Width="100" Height="30" Margin="0,20" DataContex=... Command="{Binding ModifyUserSettingsCommand}">Modify</Button> 
```

该命令`ModifyUserSettingsCommand`位于 MainWindowViewModel 和但我不知道如何将它绑定到我的按钮。我想我需要设置它的 DataContext 但我没有成功弄清楚什么是正确的语法

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:16:38.777

添加到 UserControl 资源：

```
 <UserControl.Resources>
        <vm:MainWindowViewModel x:Key="btnViewModel" />
 </UserControl.Resources> 
```

通过这种方式，您必须将 DataContext 分配给 Button：

```
DataContext="{StaticResource btnViewModel}" 
```

# php - 如何使用复选框删除php中的多行？

> ID：12900969
> 
> 赞同：1
> 
> 时间：2012-10-15T17:33:39.503
> 
> 标签：php, checkbox, delete-row

```
 <form action="<?php echo $_SERVER['PHP_SELF'];?>" style="display:inline"  method="post">
    <input type="submit" name="del" value="Delete">

    <br>

    <?php

    $con=mysql_connect("localhost","root") OR DIE ("cant connect to server".mysql_error());

    mysql_select_db("bedanshare") OR DIE ("cannot select db".mysql_error());

    $stud=mysql_query("SELECT * FROM studentreg");

    $count=mysql_num_rows($stud);

    echo "<table border='1'>";
    echo "<th><center />#</th>"; 
    echo "<th><center />Student Number</th>";
    echo "<th><center />First Name</th>";
    echo "<th><center />Last Name</th>";
    echo "<th><center />E-mail</th>";
    echo "<th><center />Username</th>";
    echo "<th><center />Password</th>"; 

    while($row=mysql_fetch_array($stud))
    {
    echo "<tr>";?>
    <td><input name='checkbox[]' type='checkbox' id='checkbox[]' value="<?php echo $row['ID']; ?>">
    <?php
    echo "<td><center />".$row['ID']."</td>";
    echo "<td><center />".$row['Fname']."</td>";
    echo "<td><center />".$row['Lname']."</td>";
    echo "<td><center />".$row['EmailAddress']."</td>";
    echo "<td><center />".$row['Username']."</td>";
    echo "<td><center />".$row['Password']."</td>";  
    echo "</tr>";
    }
    echo "</table>";

    if($del)
    {
    for($i=0;$i<$count;$i++)
    {
    $id=$checkbox[$i];
    $dels=mysql_query("DELETE FROM studentreg WHERE ID='$id'");
    }

    }

    ?>

    </form> 
```

为什么代码不删除行？:( 请帮助。似乎没有数据受到影响。ID 是我的主键，但是当我单击删除时，没有任何反应。我认为我的查询没有错。顺便说一句，我使用复选框删除多行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:36:10.220

有一个条件：

```
if($del) 
```

只有当它为真时，它才会进入循环并开始删除行。`$del`问题是您的代码中没有定义该变量。

**编辑：** 将您的条件更改为：

```
if(array_key_exists('del',$_POST)) 
```

并更改下一行，从：

```
$id=$checkbox[$i]; 
```

至：

```
$id=$_POST['checkbox'][$i]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-24T07:12:06.853

在您的代码中有两个错误。1\. $del 是未定义的变量。2\. $checkbox[] 是未定义的变量。

您必须修改上面的代码，如下所示：

```
if(isset($_POST['delete']))   // Not if($del)
$id = $_POST['checkbox'][$i]; // Not $id=$checkbox[$i]; 
```

# javascript - 一页布局缓动在 Internet Explorer 9 中不起作用

> ID：12900970
> 
> 赞同：1
> 
> 时间：2012-10-15T17:33:41.097
> 
> 标签：javascript, jquery, easing

我在让我的一页布局锚链接在 Internet Explorer 中工作时遇到了麻烦。

我正在使用带有 Easing 插件的 jQuery 转到我网页上的锚点，这适用于 Chrome，当我在 Internet Explorer (9) 中对其进行测试时，发生了这种情况：

Internet Explorer 在页面底部发出警告说需要启用 ActiveX 元素，当我单击其中一个链接时，我被带到锚点，但没有动画（而且它也出现错误，因为我使用的是固定标题）。

当我激活 ActiveX 元素时，单击链接时什么也没有发生。

这是我的代码：

```
<script>
    $(function(){
        $('ul.nav a, .top-logo a').bind('click',function(event){
            var $anchor = $(this);
            var $section = $($anchor.attr('href'));
            if(!$section.length){ return } 

            $('body').stop().animate({
                scrollTop: $section.offset().top-139
            }, 1500,'easeInOutExpo');

            event.preventDefault();
        })
    })
</script> 
```

谁能帮我解决这个问题？

干杯!

# apache - 是否可以通过发送大量无效文件（404）请求来填充 Apache 日志文件？

> ID：12900971
> 
> 赞同：-4
> 
> 时间：2012-10-15T17:33:45.147
> 
> 标签：apache

如果是，我的 error_log 文件可以有多大？

之后，Apache 会从文件中删除最旧的日志，还是 Apache 会停止记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:42:29.747

在任何文件系统中都有一个最大文件大小，在达到该大小后，apache 无法附加到它。但是提出这么多请求可能需要几十年的时间（100-150 字节将附加在每个文件未找到错误上）

# java - 添加新服务时，我所有的 Restful Web 服务都停止工作

> ID：12900975
> 
> 赞同：1
> 
> 时间：2012-10-15T17:34:27.587
> 
> 标签：java, web-services, google-app-engine, web-applications, jersey

好的，我有一个包含两个 RESTful Web 服务类 Login.class 和 Subscribe.class 的包。当我将它们部署到应用程序引擎并对其进行测试时，它们可以正常工作。现在，我将一个新的服务类名称 User s.class 添加到包中，现在当我调用它们时，我的服务都不起作用，我收到内部服务器错误。

```
com.sun.jersey.spi.inject.Errors processErrorMessages: The following errors and warnings have been detected with resource and/or provider classes: 
```

严重：产生媒体类型冲突。资源方法 public javax.ws.rs.core.Response com.ppsjamaica.webservices.PPSUsers.getUserById(java.lang.Long) 和 public javax.ws.rs.core.Response com.ppsjamaica.webservices.PPSUsers.getUserByUsernamePassword( java.lang.String,java.lang.String) 可以产生相同的媒体类型

```
Uncaught exception from servlet 
```

com.sun.jersey.spi.inject.Errors.processErrorMessages (Errors.java:170) 处的 com.sun.jersey.spi.inject.Errors$ErrorMessagesException

我的订阅课程是：

```
 @Path ("/subscriber")
public class Subscribe {

    @GET
    @Produces (MediaType.APPLICATION_JSON)
    public Response getSubscriber (@QueryParam("email")String email)
    {
        EntityManager entityManager = EMF.getInstance ().createEntityManager ();

        /*
         * Sends back a BAD_REQUEST HTTP status
         * if email query parameter is empty
         */
        if (email.isEmpty ())
            return Response.status(Status.BAD_REQUEST).build ();

        try
        {
            Query query = entityManager.createQuery ("SELECT FROM Subscriber WHERE email= :emailParam");
            query.setParameter("emailParam", email);
            return Response.status(Status.OK).entity((Subscriber) query.getSingleResult ()).build (); 
        }
        catch (NoResultException e)
        {
            return Response.status (Status.NOT_FOUND).build ();
        }

    }//end Subscriber method
} 
```

我的登录类是：

```
 @Path ("/login")
public class Login {

    @GET
    @Produces (MediaType.APPLICATION_JSON)
    public User authenticate (@QueryParam("username") String username, @QueryParam("password")String password)
    {
        User user = new User ();
        return user;
    }//end authenticate method

    @GET
    @Path ("/Subscriber")
    @Produces (MediaType.APPLICATION_JSON)
    public Response getSubsriber (@QueryParam("email") String email)
    {
        EntityManager entityManager = EMF.getInstance ().createEntityManager();

        try
        {
            Query query = entityManager.createQuery("SELECT FROM Subscriber WHERE email= :emailParam");
            query.setParameter("emailParam", email);

            Subscriber subscriber = (Subscriber)query.getSingleResult();
            return Response.status(Status.OK).entity(subscriber).build ();
        }
        catch(Exception e)
        {
            throw new RuntimeException (e);
        }
    }//end getSubsriber method
}//end Login class 
```

我的用户类是：

```
@Path ("/users")
public class Users {

    /**
     * Gets all User objects from datastore. Returns
     * NOT_FOUND HTTP Response status if no result
     * found and OK HTTP Response status if it does with
     * a list of User objects. 
     * 
     * URL: domain-name/services/users/all
     * 
     * @author Mario Dennis
     * @return Response
     */
    @GET
    @Path ("/all")
    @Produces(MediaType.APPLICATION_JSON)
    public Response getAllUsers ()
    {
        try
        {
            EntityManager entityManager = EMF.getInstance().createEntityManager();
            Query query = entityManager.createQuery("SELECT FROM User");

            @SuppressWarnings("unchecked")
            List<User> user = (List<User>) query.getSingleResult ();
            GenericEntity<List<User>> entity = new GenericEntity<List<User>>(user){};

            return Response.status(Status.OK).entity(entity).build ();
        }
        catch (NoResultException e)
        {
            return Response.status(Status.NOT_FOUND).build ();
        }
    }//end getAllUsers method

    /**
     * Gets User object with user name and password specified from
     * datastore. Returns NOT_FOUND HTTP Response status if no result
     * found and OK HTTP Response status if it is found and BAD_REQUEST
     * if parameter supplied is empty.
     * a list of User objects. 
     * 
     * URL: domain-name/services/users/{username}&{password}
     * 
     * @author Mario Dennis
     * @return Response
     */
    @GET
    @Produces (MediaType.APPLICATION_JSON)
    public Response getUserByUsernamePassword (@QueryParam("username")String username,@QueryParam("password") String password)
    {
        /*
         * Sends back a BAD_REQUEST HTTP status
         * if email query parameter is empty
         */
        if (username.isEmpty() || password.isEmpty())
            return Response.status(Status.BAD_REQUEST).build ();

        try
        {
            EntityManager entityManager = EMF.getInstance().createEntityManager ();
            Query query = entityManager.createQuery ("SELECT FROM User WHERE user_name= :usernameParam AND password= :passwordParam");
            query.setParameter("usernameParam", username);
            query.setParameter("passwordParam",password);
            User user = (User) query.getSingleResult ();

            return Response.status(Status.OK).entity(user).build ();
        }
        catch (NoResultException e)
        {
            return Response.status(Status.NOT_FOUND).build ();
        }
    }//end getUserByUsernamePassword method

    /**
     * Gets User object with id specified from datastore. 
     * Returns NOT_FOUND HTTP Response status if no result
     * found and OK HTTP Response status if it is found and 
     * BAD_REQUEST if parameter supplied is empty.
     * a list of User objects. 
     * 
     * URL: domain-name/services/users/{id}
     * 
     * @author Mario Dennis
     * @return Response
     */
    @GET
    @Produces (MediaType.APPLICATION_JSON)
    public Response getUserById (@QueryParam("id")Long id)
    {
        /*
         * Sends back a BAD_REQUEST HTTP status
         * if email query parameter is empty.
         */
        if (id == null)
            return Response.status(Status.BAD_REQUEST).build ();

        try
        {
            EntityManager entityManager = EMF.getInstance ().createEntityManager ();
            User user = entityManager.find(User.class,id);

            /*
             * Checks if user was found. Return a NOT_FOUND
             * HTTP status if user was not located. 
             */
            if (user == null)
                return Response.status(Status.NOT_FOUND).build ();

            else
                return Response.status(Status.OK).entity(user).build();
        }
        catch (NoResultException e)
        {
            return Response.status(Status.NOT_FOUND).build ();
        }
    }//end getUserById method

    /**
     * Save User object to database. Return NOT_MODIFIED
     * HTTP status if persisting of object failed. Otherwise
     * return OK HTTP status if it was successful.
     * 
     * URL: domain-name/services/users/{JSON}
     * 
     * @author Mario Dennis
     * @param user
     * @return Response
     */
    @POST
    @Consumes  (MediaType.APPLICATION_JSON)
    public Response saveUser (User user)
    {
        try
        {
            EntityManager entityManager = EMF.getInstance().createEntityManager();
            entityManager.getTransaction ().begin();
            entityManager.persist(user);
            entityManager.getTransaction().commit();

            return Response.status(Status.OK).build ();
        }
        catch(Exception e)
        {
            return Response.status(Status.NOT_MODIFIED).build ();
        }
    }//end saveUser method

}//end Users class 
```

当我删除用户类并上传回来时，其他两个服务又开始工作了。这是什么原因造成的？web.xml

```
 <!-- Jersey Framework mapping -->
   <servlet>
        <servlet-name>RESTful</servlet-name>
        <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
        <init-param>
          <param-name>com.sun.jersey.config.property.packages</param-name>
          <param-value>com.ppsjamaica.webservices</param-value>
        </init-param>
  </servlet>
  <servlet-mapping>
        <servlet-name>RESTful</servlet-name>
        <url-pattern>/service/*</url-pattern>
  </servlet-mapping>
    <!-- end Jersey Framework mapping --> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:49:44.237

请永远不要设计要求用户在 URI 中输入密码的服务。

On why it is failing: both methods use the same URI template (note the fact that each of them injects different query parameters does not mean they are mapped to a different URI - it is the value of `@Path` annotation that matters - and it is the same for both). You have to disambiguate them by mapping them to a different URI template.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:57:25.847

方法是创建一个继承自的自定义异常`WebApplicationException`；您可以[在此处查看更多详细信息](https://stackoverflow.com/questions/583973/jax-rs-jersey-how-to-customize-error-handling)。您不应该直接抛出 a `RuntimeException`，因为容器不知道它是否是预期的行为。

另一种方法是注释您的自定义异常（直接继承自`RuntimeException`），`@ApplicationException`尽管我不知道这是否是在 JAX-RS 中执行此操作的方法；仅在 EJB 中。

# php - 如何使用 PHP 或 .htaccess 从另一个站点获取图像？

> ID：12900977
> 
> 赞同：1
> 
> 时间：2012-10-15T17:34:44.837
> 
> 标签：php, .htaccess, imagemagick, gd, gravatar

好的，这就是我想要做的。

在我的网站上，我上传了一组用作头像的图像。这些网站通常要求不同的大小，并且对他们接受什么样的 URL 非常挑剔。

我想要做的是从 Gravatar 服务器获取 Gravatar 图像，并使用自定义 URL、动态或缓存提供它。

我的 Gravatar 网址为 100x100px 的图像：

```
http://gravatar.com/avatar/b6e428090e62182266a4e9dd87297ee1.png?s=100 
```

我想为网站提供的东西，或多或少：

```
http://alenonimo.com.br/avatar/avatar100.png 
```

现在让我解释一下我在这里试图解决的问题，因为它很有趣。

一些网站接受第三方的头像图像 URL，如 phpBB 等。他们也有他们喜欢的不同尺寸，如 100x100 像素、120x120 像素、200x200 像素等。但是，如果 URL 上带有“s”变量，他们拒绝接受 Gravatar URL，该变量定义了所提供图像的大小来自 Gravatar。默认大小始终为 80x80 像素，没有该选项。

所以我想为这些网站提供 Gravatar 图像并在 URL 上定义大小，以某种方式它不会注意到来自 Gravatar 的图像生成器。我希望这些网站认为图像实际上来自我的网站。它可以让我为那些不接受 Gravatar 的网站设置大小，幸运的是，我只需转到 Gravatar 就可以一次更改所有这些网站上的所有头像图像。

我很确定它可以使用 Apache 的 RewriteEngine 来完成，但我缺乏代码来完成它。我在网上找到的所有示例都将内容从同一站点重定向到同一站点的其他位置，但事实并非如此。我还想确保 size 属性或多或少是一个有效的数字，而不是接受任何东西。因此，一个名为“100.png”的文件可以，但“banana.png”则不行。

这本身会很有趣，但它发生了另一件事。如果网站不接受 PNG 文件但接受 JPG 或 GIF 文件怎么办？可能不会发生在只显示图像的网站上，但如果我也可以向从 URL 上传的网站提供图像，那对我来说会很有趣。此外，即使 Gravatar 离线，确保某些内容也能显示出来也可能很有趣，比如缓存系统。这可以通过 PHP 实现，但我不确定它会有多复杂。

有人可以帮我解决 RewriteEngine 规则吗？或者甚至给我一些关于如何制作这个 PHP 脚本的指导？这里的其他人会不会很有趣？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:49:35.363

在这里，您需要让您的服务器侦听扩展名为 .png 的 .php 文件，这可以使用 .htacces 轻松完成

```
RewriteEngine on
RewriteRule ^avatar/([a-z,A-Z,0-9,-_]+)$ index.php?avatar_param=$1 
```

php脚本

```
<?php

if(isset($_GET['avatar_param']))
{
    $avatar_size = filter_var($_GET['avatar_param'],FILTER_SANITIZE_NUMBER_INT);
    $user_email_hash = 'b6e428090e62182266a4e9dd87297ee1';

    $get_gravar_image = 'http://gravatar.com/avatar/'.$user_email_hash.'.png?s='.$avatar_size;
    echo '<img src="'.$get_gravar_image.'" />';
}

  ?> 
```

通过查看您提供的 url 结构，我使用数字作为图像的大小，只需使用上面的代码即可。

只需尝试使用 url 中的大小，您会发现它是动态的并且工作方式很好

演示

[http://thetutlage.com/demo/avatarProblem/avatar/avatar100.png](http://thetutlage.com/demo/avatarProblem/avatar/avatar100.png)

# java - 通用类型创建者

> ID：12900980
> 
> 赞同：0
> 
> 时间：2012-10-15T17:35:10.937
> 
> 标签：java, generics, casting

> **可能重复：**
> [Java 泛型：无法将 List<SubClass> 转换为 List<SuperClass>？](https://stackoverflow.com/questions/3246137/java-generics-cannot-cast-listsubclass-to-listsuperclass)

我想在一些基类上创建函数，创建它的继承类。

我试过这个：

```
class BaseFormat
{
    // Some variables

    public BaseFormat(string txt)
    {
        // Do something
    }

    public static <T> ArrayList<T extends BaseFormat> getTextFormat(String[] txt)
    {
        ArrayList<T> list = new ArrayList<T>();
        for (int i = 0; i < txt.length; i++)
        {
            list.add(new T(txt[i])); // ERROR
        }
        return list;
    }
}

class FooFormat extends BaseFormat
{
    // Some variables

    public FooFormat (string txt)
    {
        // Do something
    }
} 
```

和这个：

```
class BaseFormat
{
    // Some variables

    public BaseFormat(string txt)
    {
        // Do something
    }

    public static ArrayList<BaseFormat> getTextFormat(String[] txt)
    {
        ArrayList<T> list = new ArrayList<T>();
        for (int i = 0; i < txt.length; i++)
        {
            list.add(new BaseFormat(txt[i]));
        }
        return list;
    }
} 
```

但是当我尝试转换数组时，我收到一个错误。这是我的代码：

```
String[] txts = ...; // Some texts
ArrayList<FooFormat> list = (ArrayList<FooFormat>) BaseFormat.getTextFormat(txts); // Casting ERROR 
```

那么我该怎么做，但仍然保持通用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:42:37.243

尝试做

```
 ArrayList<BaseFormat> list = (ArrayList<BaseFormat>) BaseFormat.getTextFormat(txts); 
```

然后在迭代时，您可以通过检查 instanceOf 运算符将项目向下转换为 FooFormat

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:50:31.527

您是否尝试执行以下操作

```
class BaseFormat { }

class FooFormat extends BaseFormat { }

class FormatUtils {
    public static <T extends BaseFormat> List<T> getTextFormat(String[] txt, Class<T> clazz) {
        List<T> list = new ArrayList<T>();
        //... 
                T t = clazz.newInstance(); //create instance using reflection
                //...
        return list;
    }
} 
```

做

```
List<FooFormat> list = FormatUtils.getTextFormat(new String[]{}, FooFormat.class); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:51:53.930

因此，您将允许动态类型的泛型与允许覆盖方法的继承混合在一起。您真正想要的是将创建包装字符串与创建列表分开。

```
class BaseFormat
{
  // derived classes override this method to provide their own implementations
  public abstract BaseFormat wrapText(String[] txt);

  public ArrayList<? extends BaseFormat> getTextFormat(String[] txt)
  {
    ArrayList<? extends BaseFormat> list = new ArrayList<BaseFormat>();
    for (int i = 0; i < txt.length; i++)
    {
        list.add(wrapText(txt);
    }
    return list;
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T17:57:13.450

您必须将类型作为参数传递给静态方法，然后可能使用反射来调用`Class.newInstance`. 类型擦除意味着编译后您将没有具体的类型 T，这就是您无法编译的原因`new T(...)`

# random - R中的随机组生成器

> ID：12900985
> 
> 赞同：1
> 
> 时间：2012-10-15T17:35:42.230
> 
> 标签：random, selection, variable-assignment

我有一个由来自不同学校和教室的 250 名学生组成的数据集。对于实验设计，我想以随机方式生成 35 个组，其中包含大约 35 个组。每组 7 名学生，然后在第一次活动后，将学生尽可能随机分成 25 组，每组 10 名学生。是否有关于如何在 R 中执行此操作的包和示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:52:03.320

如果在第一次和第二次活动中学生所在的小组之间没有关系，那么这就是同样的问题两次。

假设一个学生一次只能属于一个组，只需打乱数组并根据您的组大小拉出元素，直到没有更多的剩余。

```
students=1:250;
rand_students=sample(students,length(students)); 
```

# c# - WPF窗口中的透明PNG

> ID：12900988
> 
> 赞同：7
> 
> 时间：2012-10-15T17:35:55.490
> 
> 标签：c#, wpf, xaml

我尝试将具有透明度的 PNG 图像应用到整个窗口中，但窗口始终是白色的。

有什么线索可以看到 PNG 的透明度吗？

谢谢！

**C＃**

```
public SplashScreen()
        {
            InitializeComponent();

            var myBrush = new ImageBrush();
            var image = new Image
            {
                Source = new BitmapImage(
                    new Uri(
                        "pack://application:,,,/MyApp;component/Images/Logo.png"))
            };
            myBrush.ImageSource = image.Source;
            Background = myBrush;

        } 
```

**XAML**

```
<Window x:Class="MyApp.SplashScreen"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Topmost="True"
        Title="SplashScreen" Height="400" Width="400" WindowStartupLocation="CenterScreen" WindowStyle="None" 
           BorderThickness="5" ShowInTaskbar="False" ResizeMode="NoResize" >
    <Grid Name="MainGrid">
        <Label FontSize="10" Height="20" Foreground="White" Margin="0,0,0,0" Padding="10,0,0,5" Name="statusLabel"  VerticalAlignment="Bottom"></Label>
        <TextBlock  Visibility="Collapsed"  FontSize="10" Foreground="White"   Margin="18,110,18,30" Name="appInfo" TextAlignment="Center">

        </TextBlock>
        <TextBlock Visibility="Collapsed"  FontSize="20" Foreground="White"   Margin="0,83,0,90" Name="version" TextAlignment="Center">

        </TextBlock>
    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-15T17:38:05.947

[这里](http://blogs.interknowlogy.com/2007/06/20/transparent-windows-in-wpf-2/)有很多信息。我想你缺少的那块`AllowsTransparency="True"`在你的窗户上。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-06T00:50:45.850

我的窗口上有一个默认背景，如果没有在窗口上设置 Background="Transparent"（可能是由于 Expression Blend），这对我不起作用，以防万一有人遇到类似的问题。

# wpf - WPF：GroupBox.SetResourceReference 突然使其继承 TemplateParent.Foreground

> ID：12900991
> 
> 赞同：1
> 
> 时间：2012-10-15T17:36:04.803
> 
> 标签：wpf, foreground, groupbox

当我发现这个奇怪的现象时，我正在制作一个 UserControl。如果我使用 C# 代码在 UserControl 的模板中放置一个 GroupBox，然后在 GroupBox 上进行任何 SetResourceReference 调用，那么 GroupBox 突然继承了 TemplateParent（我的 UserControl）的前景。

到目前为止，我已经找到了针对这种情况的以下要求：

*   UserControl 基本类型无关紧要
*   受影响的模板子必须是 GroupBox（但不一定是第一个模板子）
*   GroupBox 的前景可以在模板中显式设置，覆盖继承
*   必须使用来自 GroupBox 的某种引用调用
*   只有 Foreground 属性似乎受到影响

这是我的示例代码：

MainWindow.xaml：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:my="clr-namespace:WpfApplication1"
        Title="MainWindow" Height="350" Width="350">
    <Window.Resources>
        <Thickness x:Key="TestPadding">5</Thickness>
        <Style TargetType="{x:Type GroupBox}">
            <Setter Property="Foreground" Value="Red" />
            <Setter Property="Background" Value="Orange" />
        </Style>
    </Window.Resources>
    <Grid>
        <my:TestControl Foreground="Blue" Background="Purple" />
    </Grid>
</Window> 
```

测试控制.cs：

```
using System;
using System.ComponentModel;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Media;
using System.Windows.Media.Effects;
using System.Windows.Markup;

namespace WpfApplication1
{
    public class TestControl : UserControl
    {
        public TestControl()
        {
            FrameworkElementFactory group = new FrameworkElementFactory(typeof(GroupBox));
            group.SetValue(GroupBox.ContentProperty, "My Child");
            group.SetResourceReference(GroupBox.MarginProperty, "TestPadding");
            this.SetValue(TestControl.TemplateProperty, new ControlTemplate(typeof(TestControl)) { VisualTree = group });
        }
    }
} 
```

**你们怎么看，这是我应该向微软报告的错误吗？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T12:31:35.853

我不认为这是微软的问题。事实上，我认为它工作正常。您正在为您的 TestControl 在代码后面定义一个模板，并且您正在将一个 GroupBox 设置为模板的根元素。这里发生的情况是您的 UserControl.Foreground 属性与作为模板根的 GroupBox 不同，然后 GroupBox（作为 GroupBox）将采用从资源（在本例中为窗口的资源）继承的前景。

如果你想解决这个问题，你可以做一些类似“TemplateBindings”的事情，下面的代码会像 TemplateBinding 一样为你工作：

```
namespace WpfApplication1
{
    public class TestControl : UserControl
    {
        public TestControl()
        {
            FrameworkElementFactory group = new FrameworkElementFactory(typeof(GroupBox));
            group.SetValue(GroupBox.ContentProperty, "My Child");
            group.SetResourceReference(GroupBox.MarginProperty, "TestPadding");

            //This line will work as a TeplateBinding
            group.SetBinding(GroupBox.ForegroundProperty, new Binding() { Path = new PropertyPath("Foreground"), RelativeSource = RelativeSource.TemplatedParent });

            this.SetValue(TestControl.TemplateProperty, new ControlTemplate(typeof(TestControl)) { VisualTree = group });
        }
    }
} 
```

希望这个答案对你有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-21T19:25:13.753

我已联系 Microsoft WPF 开发团队。他们承认这是一个错误，但将其列为低优先级并且不太可能修复。

我对这个示例的解决方法：使用另一个控件来执行 *.SetResourceReference 调用来执行填充，而不是 GroupBox。

# php - 确保 url 不重复

> ID：12900994
> 
> 赞同：0
> 
> 时间：2012-10-15T17:36:13.823
> 
> 标签：php

我正在建立一个网站，人们可以在其中提交他们的博客地址。我想做的是，当他们提交博客时，让我检查数据库以查看它是否已经在数据库中。

我遇到的问题是有人可以将网址写为 "http://blog.com" 或 "http://www.blog.com" 。

我检查网址是否重复的最佳方法是什么？

我想我会检查网址是否有“http://”和“www”，并检查“www”之后的部分，但我觉得这会很慢，因为我有 3000 多个网址。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:44:31.947

`www.blog.com``blog.com` *可能*是也可能不是两个完全不同的博客。例如，`example.blogspot.com`和`blogspot.com`是两个完全不同的站点。`www.`与其他任何子域一样，它只是一个普通的子域，并且没有关于它应该如何表现的规则。域之后的路径也是如此；`example.com/blorg`并且`example.com/foobarg`可能是两个独立的博客。

因此，您想向给定的 URL 发出 HTTP 请求，并查看它是否重定向到某个地方。通常有*一个*规范的 URL，并`www.blog.com`重定向到`blog.com`或相反。因此，深入研究[curl 扩展](http://php.net/curl)或任何其他喜欢的 HTTP 请求模块，向给定的 URL 发出请求，并找出它解析到的规范 URL。

您可能还想使用解析整个 URL[`parse_url`](http://php.net/parse_url)并仅将主机名和路径一起作为唯一标识符，而忽略方案或查询参数等其他违规行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:41:07.250

我将创建一个实现一些比较接口（c#）的 Url 对象。

所以你可以这样做。

```
 var url = new Url("http://www.someblog.nl");
 var url2 = new Url("http://someblog.nl");

if (url == url2)
{
    throw new UrlNeedsToBeUniqueException();
} 
```

您可以使用一些正则表达式来实现比较功能，或者总是去掉 www。在开始比较之前，用字符串替换 url 的一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:14:13.947

> Dis-calmer ：这是出于实验目的，它可以指导您使用您想要使用的最佳格式

我认为您应该只保存域和子域.. 我将演示这个简单脚本的意思

图像 一个数组

```
$urls = array('http://blog.com',
        'http://somethingelse.blog.com',
        'http://something1.blog.com',
        'ftp://blog.com',
        'https://blog.com',
        'http://www.blog.com',
        'http://www.blog.net',
        'blog.com',
        'somethingelse.blog.com'); 
```

如果你跑

```
$found = array();
$blogUrl = new BlogURL();
foreach ( $urls as $url ) {
    $domain = $blogUrl->parse($url);
    if (! $domain) {
        $blogUrl->log("#Parse can't parse  $url");
        continue;
    }

    $key = array_search($domain, $found);

    if ($key !== false) {
        $blogUrl->log("#Duplicate $url same as {$found[$key]}");
        continue;
    }

    $found[] = $domain;
    $blogUrl->log("#new $url has  $domain");
}

var_dump($found); 
```

输出

```
array
  0 => string 'blog.com' (length=8)
  1 => string 'somethingelse.blog.com' (length=22)
  2 => string 'something1.blog.com' (length=19)
  3 => string 'blog.net' (length=8) 
```

如果你想看看内部工作

```
echo "<pre>";
echo implode(PHP_EOL, $blogUrl->getOutput()); 
```

输出

```
blog.com Found in http://blog.com
#new http://blog.com has  blog.com
somethingelse.blog.com Found in http://somethingelse.blog.com
#new http://somethingelse.blog.com has  somethingelse.blog.com
something1.blog.com Found in http://something1.blog.com
#new http://something1.blog.com has  something1.blog.com
#error domain not found in ftp://blog.com
#Parse can't parse  ftp://blog.com
blog.com Found in https://blog.com
#Duplicate https://blog.com same as blog.com
www.blog.com Found in http://www.blog.com
#Duplicate http://www.blog.com same as blog.com
www.blog.net Found in http://www.blog.net
#new http://www.blog.net has  blog.net
#Fixed blog.com to 
#Fixed http://blog.com to http://blog.com
blog.com Found in http://blog.com
#Duplicate blog.com same as blog.com
#Fixed somethingelse.blog.com to 
#Fixed http://somethingelse.blog.com to http://somethingelse.blog.com
somethingelse.blog.com Found in http://somethingelse.blog.com
#Duplicate somethingelse.blog.com same as somethingelse.blog.com 
```

使用的类

```
class BlogURL {
    private $output;

    function parse($url) {
        if (! preg_match("~^(?:f|ht)tps?://~i", $url)) {
            $this->log("#Fixed $url to ");
            $url = "http://" . $url;
            $this->log("#Fixed $url to $url");
        }

        if (! filter_var($url, FILTER_VALIDATE_URL)) {
            $this->log("#Error $url not valid");
            return false;
        }
        preg_match('!https?://(\S+)+!', $url, $matches);
        $domain = isset($matches[1]) ? $matches[1] : null;

        if (! $domain) {
            $this->log("#error domain not found in $url");
            return false;
        }
        $this->log($domain . " Found in $url");

        return ltrim($domain, "w.");
    }

    function log($var = PHP_EOL) {
        $this->output[] = $var;
    }

    function getOutput() {
        return $this->output;
    }
} 
```

# c# - 将文件保存到（网络应用程序）谷歌驱动器而不通知用户

> ID：12900996
> 
> 赞同：2
> 
> 时间：2012-10-15T17:36:21.293
> 
> 标签：c#, asp.net, google-api, google-drive-api

我正在编写一个程序，使用户能够将文档上传到我的项目谷歌驱动器中，场景如下：

用户 A 登录 BlitzDoc。他将一个文档（使用 BlitzDoc 的上传页面）上传到 BlitzDoc 的 Gdrive。

在用户 A 上传后，她/他会看到以下内容：

“BlitzDoc 正在请求以下权限： • 查看和管理您使用此应用打开或创建的 Google Drive 文件 o 查看您使用此应用打开的 Google Drive 中的文件 保存对您使用此应用打开的文件的更改 创建新文件使用此应用在 Google 云端硬盘上“</p>

问题是 BLitzDoc 没有在用户 A 的驱动器上存储/使用任何东西（它只是获取上传的 Doc 并将其存储在 BlitzDoc 自己的驱动器帐户中）。那么为什么 Gdrive 会通知用户这是正在发生的事情呢？

有没有办法在不让 gdrive 发布这样的消息的情况下实现上述场景？（我希望我很清楚..）

# c - 如何将 POST 编辑的字符串验证为有效的 UTF-8（在 C 中）？

> ID：12900997
> 
> 赞同：2
> 
> 时间：2012-10-15T17:36:24.757
> 
> 标签：c, utf-8, http-post

我们有一个 CGI 程序，它处理 POST-ed 表单。一些 POST-ed 文本可以包含非 ASCII 字符——浏览器已经将这些字符转换为 UTF-8。

我需要“强化”程序以拒绝无效字符串——其中非 ASCII 字符串也不是有效的 UTF-8 字符串。

我想，我会依赖 mbstowcs()：

```
setlocale(LC_CTYPE, "en_US.UTF-8");
unilen = mbstowcs(NULL, foo, 0);
if (unilen == (size_t)-1) {
    ... report an error ...
} 
```

但是，我很难验证该方法——它可以接受有效的字符串，但我无法想出一个*无效*的字符串来拒绝它......

请有人确认这是一种正确的方法和/或建议替代方法吗？

请注意，我不关心转换的实际结果——一旦我确信该字符串是有效的 UTF-8，我会将其复制到电子邮件中（使用 UTF-8 字符集）并让收件人的电子邮件程序处理它。我打扰验证的唯一原因是确保表单不用于传播*任意*二进制文件（例如病毒）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:00:04.163

功能文档说

“如果遇到无效的多字节字符，则返回 (size_t)-1 值。”

所以我相信你的验证非常好。就个人而言，我总是发现这个值因无效数据而损坏。你可以提交一个任意长度的十六进制序列来确定。

如果您有疑问并需要进一步验证，gnu iconv 是一个不错的选择

[SO上的utf-8验证](https://stackoverflow.com/questions/115210/utf-8-validation)

# java - java web启动时间

> ID：12900998
> 
> 赞同：1
> 
> 时间：2012-10-15T17:36:25.913
> 
> 标签：java, datetime, time, timezone, java-web-start

更新后运行JWS应用时，时区设置不正确，重启后应用时区设置正确。

主要方法...

```
logger.info("TimeZone=" + TimeZone.getDefault());
logger.info("Date=" + new Date());
logger.info("Timestamp=" + new Timestamp(new Date().getTime())); 
```

***首次运行（升级后）：***

```
2012-10-15 16:51:49,529 [javawsApplicationMain]  INFO - TimeZone=sun.util.calendar.ZoneInfo[id="UTC",offset=0,dstSavings=0,useDaylight=false,transitions=0,lastRule=null]
2012-10-15 16:51:49,531 [javawsApplicationMain]  INFO - Date=Mon Oct 15 16:51:49 UTC 2012
2012-10-15 16:51:49,531 [javawsApplicationMain]  INFO - Timestamp=2012-10-15 16:51:49.531 
```

***第二次运行（来自缓存）：***

```
2012-10-15 19:52:44,798 [javawsApplicationMain]  INFO - TimeZone=sun.util.calendar.ZoneInfo[id="GMT+03:00",offset=10800000,dstSavings=0,useDaylight=false,transitions=0,lastRule=null]
2012-10-15 19:52:44,798 [javawsApplicationMain]  INFO - Date=Mon Oct 15 19:52:44 GMT+03:00 2012
2012-10-15 19:52:44,798 [javawsApplicationMain]  INFO - Timestamp=2012-10-15 19:52:44.798 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:50:25.223

在您的应用程序的某个地方，`TimeZone.setDefault(TimeZone zone)`将在第一次运行和第二次运行之间被调用。

请检查代码库或在上述方法上添加断点并在调试器中运行您的应用程序，您将找到调用位置。