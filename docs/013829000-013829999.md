# StackOverflow 问答 13829000-13829999

# php - 用 PHP（和 APC）类互斥体（竞争条件）？

> ID：13829004
> 
> 赞同：0
> 
> 时间：2012-12-11T21:44:29.417
> 
> 标签：php, mutex, race-condition

我需要对某些操作进行互斥。在我的服务器上，我安装了 APC。

是否有任何批准的类来获取和释放互斥锁？如果已经有“官方”解决方案，我会避免重新发明轮子。

请注意，我知道我可以使用`flock`，但我不想回退到文件系统来获取互斥锁

就像是：

```
$m = new Mutex;
$m->lock();
  //> Do stuff
$m->unlock(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T21:58:35.450

更高版本的 PHP 具有内置的 Mutex 类。如果您在 *nix 系统上，还请在文档中查找“信号量函数”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T16:53:20.147

您可能想[在 php 中尝试我的 Mutex 实现](https://github.com/arvenil/ninja-mutex)。它支持多种适配器——flock、memcache、mysql。目前没有 apc 实现，因为无法在多个 Web 服务器上使用它 - 但您可能总是很容易添加它并发送拉取请求。

[https://github.com/arvenil/ninja-mutex](https://github.com/arvenil/ninja-mutex)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-25T15:24:32.220

用 APC 实现互斥库通常是无稽之谈。互斥锁/锁最有用的应用是分布式环境和多实例……但 APC 是机器本地的。

要在分布式 DB 中实现可靠的多实例 Mutex 信令，您需要使用 FileSystem (S3) 或共享的 REDIS 或 MEMCACHED 服务（DB 可以执行工作但速度较慢）。

Ninja Mutex 不推荐用于分布式环境。

我而是使用这个库： [https](https://github.com/cheprasov/php-redis-lock) ://github.com/cheprasov/php-redis-lock 它已经过我的测试，并且适用于多个 PHP-FPM 实例、Redis 和 MongoDB 集群。

如果您想了解更多信息，请阅读有关此的官方 redis 文档： [https ://redis.io/topics/distlock](https://redis.io/topics/distlock)

# html - jquery mobile - 页面不刷新

> ID：13829006
> 
> 赞同：2
> 
> 时间：2012-12-11T21:44:31.060
> 
> 标签：html, css, jquery-mobile

我有 3 页：

通过单击第 1 页上的“过滤器”按钮，它会将您带到第 2 页。单击第 2 页上的“灰色按钮”会将您带到第 3 页。单击第 2 页上的“红色按钮”将带您回到第 1 页。

但是在所有这些转换过程中，页面失去了它们的样式。

我尝试在 page1 上添加此代码，但似乎效果不佳：

```
$(document).bind('pagechange', function() {
          $('.ui-page-active .ui-listview').listview('refresh');
          $('.ui-page-active :jqmData(role=content)').trigger('create');
        }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T17:18:07.957

似乎当用户单击 jQuery Mobile 驱动的站点中的链接时，导航系统的默认行为是使用该链接的 href 来制定 Ajax 请求（而不是允许浏览器的默认链接行为以完整的方式请求该 href页面加载）。

这意味着当通过 Ajax 加载页面时，引用页面头部的任何脚本和样式都不会产生任何影响，但是如果通过 HTTP 正常请求页面，它们就会执行。

所以我尝试合并样式，并在每个页面的头部引用相同的样式表和脚本集。这解决了这个问题。

[http://jquerymobile.com/demos/1.0/docs/pages/page-scripting.html](http://jquerymobile.com/demos/1.0/docs/pages/page-scripting.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:54:00.513

如果您使用 Windows 8 导航，当您从一个页面导航到另一个页面时，将加载新页面 css，如果任何 css 选择器具有相同名称，则新 css 将有效。当你回来时，你可能会失去这种风格。

尝试为每个页面和子页面使用 css 命名空间： [https ://www.google.com.br/search?q=css+namespace](https://www.google.com.br/search?q=css+namespace)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T07:33:01.433

我不确定您使用什么逻辑导航到 page2 或 page3

您可以尝试 changePage 功能导航到不同的页面..

```
 $.mobile.changePage("page2.html", { allowSamePageTransition: true, 
transition: "slide", reloadPage: true }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T17:34:57.817

当您使用 pageChange 时，将对那个 url 发出一个 Ajax 请求，并且它只会加载具有 data-role="page" 的 div 内的内容。因此，您从该元素中获得的所有内容都将被忽略（JS 和 CSS）。

# hibernate - 奇怪的行为：在生成的 sql 上休眠 3 个倒置列值。多对多 JPA

> ID：13829007
> 
> 赞同：1
> 
> 时间：2012-12-11T21:44:31.600
> 
> 标签：hibernate, many-to-many

拥有，

```
class RadicadoOficio {
    @ManyToMany(fetch=FetchType.LAZY)
@JoinTable(name="cor_radicado_localidad", joinColumns=@JoinColumn(name="ano_radicado"), @JoinColumn(name="num_radicado")}, inverseJoinColumns=@JoinColumn(name="interno_localidad")})
private List<Localidad> localidades;
}

class Localidad {// does not reference RadicadoOficio. unidirectional relationship } 
```

asume ano_radicado 是一个 int （ano 在某种程度上意味着年份），而 num 是一个字符串（实际上是一个可以包含字母的“数字”）

生成 sql: delete from cor_radicado_localidad where ano_radicado=2012 and num_radicado=AX33

这是好事。

但是，如果您在 RadicadoOficio 中更改 joinColumns 的顺序，即：

```
joinColumns=@JoinColumn(name="num_radicado"), @JoinColumn(name="ano_radicado")}, 
```

你得到：从 cor_radicado_localidad 中删除，其中 ano_radicado=AX33 和 num_radicado=2012

那很糟。

据我所知，映射中连接列的顺序应该无关紧要，并且在两种情况下生成的 SQL 应该是相同的。我错过了什么？tnx

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:32:48.163

**映射中连接列的顺序如果**后跟*referencedColumnName*参数无关紧要。这意味着如果您隐式指定连接表中的哪一列引用其他表上的哪一列，您将不会有任何问题。

因此，请考虑按如下方式更改您的注释：

```
@JoinTable(name="cor_radicado_localidad", joinColumns={@JoinColumn(name="ano_radicado" ,referencedColumnName="ano_radicado" ), @JoinColumn(name="num_radicado",referencedColumnName="num_radicado")}, inverseJoinColumns=@JoinColumn(name="interno_localidad")}) 
```

您的第一个示例只是偶然运行*良好。*仅仅是因为**ano_radicado**和**num_radicado**列在**Radicado**表中的顺序相同。

Hibernate 不够聪明，无法区分列名及其在其他表中对应的引用列，换句话说，这实际上是不可能的，因为您可能在连接表中使用了一些不同的名称。看这个例子：

```
Table foo
firstId  :(int)
secondId :(int)

Table bar
firstId :(int)

Table foo_bar
foo_secondId :(int)
foo_firstId :(int)
bar_firstId :(int) 
```

# sql - “简单”的解密在 100% 的情况下都不起作用

> ID：13829010
> 
> 赞同：2
> 
> 时间：2012-12-11T21:44:50.403
> 
> 标签：sql, sql-server, tsql, encryption

我有两个功能。一个加密函数和一个解密函数（见下文）。解密功能不能 100% 使用特定的单词，我无法弄清楚原因。有人可以帮我解决这个问题吗？在函数到位后，我正在使用以下 select 语句测试这两个函数。

```
select [dbo].[ufn_EncryptString]('Test1') --This string works
select [dbo].[ufn_DecryptString]('Ôæõ÷µ') 

select [dbo].[ufn_EncryptString]('diaz-mayo') --This string doesn't work 
select [dbo].[ufn_DecryptString]('äêãý±òçĀ÷') 
```

您会认为它与“-”有关，但在某些情况下，它只是一个没有空格或特殊字符的普通名称，并且无法解密字符串。

请参阅以下功能：

```
 CREATE FUNCTION [dbo].[ufn_EncryptString] ( @pClearString VARCHAR(100) )
    RETURNS NVARCHAR(100) AS
    BEGIN

    DECLARE @vEncryptedString NVARCHAR(100)
    DECLARE @vIdx INT
    DECLARE
 @vBaseIncrement INT

    SET @vIdx = 1
    SET @vBaseIncrement = 128
    SET @vEncryptedString = ''

    WHILE @vIdx <= LEN(@pClearString)
    BEGIN
        SET @vEncryptedString = @vEncryptedString + 
                                NCHAR(ASCII(SUBSTRING(@pClearString, @vIdx, 1)) +

      @vBaseIncrement + @vIdx - 1)
        SET @vIdx = @vIdx + 1
    END

    RETURN @vEncryptedString

END
GO

CREATE FUNCTION [dbo].[ufn_DecryptString] ( @pEncryptedString NVARCHAR(100) )
RETURNS VARCHAR(100) AS
BEGIN

DECLARE @vClearString VARCHAR(100)
DECLARE @vIdx INT
DECLARE @vBaseIncrement INT

SET @vIdx = 1
SET @vBaseIncrement = 128
SET @vClearString = ''

WHILE @vIdx <= LEN(@pEncryptedString)
BEGIN
    SET @vClearString = @vClearString + 

            CHAR(UNICODE(SUBSTRING(@pEncryptedString, @vIdx, 1)) - 

        @vBaseIncrement - @vIdx + 1)
    SET @vIdx = @vIdx + 1
END

RETURN @vClearString

END
GO 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T22:15:50.823

我认为您的功能运行良好，您的示例就是问题所在。

```
select [dbo].[ufn_DecryptString]('äêãý±òçĀ÷') 
```

不起作用......但是以下工作正常：

```
select [dbo].[ufn_DecryptString](N'äêãý±òçĀ÷') 
```

`N`注意字符串文字的前导？由于您的输入参数实际上是一个 UNICODE 字符串，因此您需要在文字前面加上前缀，`N`以防止它被转换为 ASCII 字符串......

来自[MSDN](http://msdn.microsoft.com/en-us/library/aa223981%28v=sql.80%29.aspx)：

> Unicode 常量用前导 N 指定：N'A Unicode string'。

否则，当它转换为 ASCII 时，您实际上是在传递`äêãý±òçA÷`......只有`Ā`字符没有在`CHAR`文字中表示，这就是您的问题断断续续的原因。

# .net - System.Web.Razor API 文档

> ID：13829012
> 
> 赞同：2
> 
> 时间：2012-12-11T21:45:00.553
> 
> 标签：.net, documentation, system.web

> 此类型/成员支持 .NET Framework 基础结构，不打算直接从您的代码中使用。

任何人都可以谈论[`System.Web.Razor.*`](http://msdn.microsoft.com/en-us/library/gg538131%28v=vs.111%29.aspx)命名空间被污染的事实吗？

这似乎是不负责任的，如果不是侮辱的话。我想了解这个决定背后的理由，我对任何 .NET 贡献者的问题是，为什么？

**附录**
我在[这里](https://stackoverflow.com/questions/12185975/where-is-the-documentation-of-system-web-razor-v2)发表评论后提出了这个问题。虽然相似，但我的问题的意图不同；但是，如果有人可以协助链接问题的 OP，我相信他会很感激。

# linux - 用于 sysfs 的 libudev 与 libsensors

> ID：13829014
> 
> 赞同：1
> 
> 时间：2012-12-11T21:45:04.143
> 
> 标签：linux, linux-device-driver, sensors, android-sensors

我在 Linux 机器上有一个温度传感器。温度传感器信息在 sysfs 中可用。

我想从 C 应用程序中获取这些温度读数。

我已经浏览网页一段时间了，无法确定我是否应该使用 libudev.h 或 sensors.h（来自 lm-sensors libsensors 库）。

我应该使用libudev.h 还是sensors.h？使用其中一个有缺点吗？

这些是我找到的满足我需求的最佳链接：

libudev：[http ://www.signal11.us/oss/udev/](http://www.signal11.us/oss/udev/)

libsensors：[http ://linux.die.net/man/3/libsensors](http://linux.die.net/man/3/libsensors)

lm-sensors 网站已关闭（不知道为什么！）。

问候， 马赫迪

# java - 合并排序字符串数组

> ID：13829015
> 
> 赞同：-1
> 
> 时间：2012-12-11T21:45:07.243
> 
> 标签：java, string, sorting, merge

我在这个网站和其他地方看到了很多合并排序的例子，但是用一个 int 数组而不是一个字符串数组，但我想知道是否有人有一个使用字符串数组的合并排序的例子，因为我有一个测试即将到来，只是想要要熟悉它！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T21:53:14.410

如果您的代码适用于整数数组，请将代码更改为使用 String 的 compareTo 来比较您的字符串...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T21:48:36.383

对字符串数组进行合并排序与对整数数组进行合并排序几乎完全相同。主要区别在于：

1.  数据类型需要从 更改`String`为`int`（显然）。
2.  该算法需要使用[`String.compareTo()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#compareTo%28java.lang.String%29)并将结果与​​零进行比较，而不是使用整数比较。

# r - 安装 ggplot2 时遇到问题

> ID：13829017
> 
> 赞同：0
> 
> 时间：2012-12-11T21:45:49.143
> 
> 标签：r, installation, packages

这是我的输出：

```
install.packages("ggplot2", dependencies = TRUE)

Installing package(s) into ‘/home/username/R/x86_64-redhat-linux-gnu-library/2.13’
(as ‘lib’ is unspecified)

Warning in install.packages :
  package ‘ggplot2’ is not available (for R version 2.13.1) 
```

我对包“sp”也有同样的问题，不知道该怎么做。在 Fedora 内核版本 2.6.35.14-106.fc14.x86_64 中工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-09-17T20:32:25.583

最新`ggplot2`版本取决于 R >= 3.0。[您可以在CRAN](https://cran.r-project.org/web/packages/ggplot2/index.html)查看可用的 R 版本以获取当前版本的`ggplot2`.

# c# - 通过新形式发送 tcp 命令

> ID：13829018
> 
> 赞同：0
> 
> 时间：2012-12-11T21:45:58.097
> 
> 标签：c#, winforms, tcpclient, networkstream

我能够在 C# 中打开 TcpClient 连接，打开网络流，并成功发送命令。我能够使用用户名和密码登录。然后发送一些命令来控制系统，它工作正常。

如果我创建一个新表单，如何向我已经打开的流发送命令？

我想打开一个新表单并让用户按下按钮，这些按钮将通过我已经打开的流发送命令。我不确定如何执行此操作，因为如果我再次尝试打开相同的流，我会遇到错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:00:42.183

您应该创建一个单独的类来封装与网络相关的行为。您的 TcpClient 将在该类中实例化。然后，您可以将对该类的引用传递给其构造函数中的新表单，也可以使用[单例](http://msdn.microsoft.com/en-us/library/ff650316.aspx)模式。

请注意，将不相关的行为（例如 GUI 和网络）分开是一个[好主意](http://en.wikipedia.org/wiki/Single_responsibility_principle)。

# ios - MonoTouch SecKeyChain.Add 返回 SecStatusCode.Param

> ID：13829024
> 
> 赞同：5
> 
> 时间：2012-12-11T21:46:25.783
> 
> 标签：ios, xamarin.ios

我正在尝试保存这样的记录：

```
var testRecord = new SecRecord(SecKind.GenericPassword)
{
    CreationDate = DateTime.UtcNow,
    MatchCaseInsensitive = false,
    Service = "MyService",
    Label = "MyService",
    Account = "User",
    Generic = NSData.FromString("test", NSStringEncoding.UTF8),
};
SecKeyChain.Add(testRecord); 
```

...但是当我在模拟器中运行它时，我得到了 SecStatusCode.Param。根据[文档](http://iosapi.xamarin.com/index.aspx?link=T:MonoTouch.Security.SecStatusCode)，该代码表示​​“传递的参数无效或不完整”，但我没有看到[其他人](https://stackoverflow.com/questions/4852108/store-and-read-password-to-from-keychain-using-monotouch)没有明显成功的任何缺失或异常。

即使将 CreationDate、Invisible、Description、Comment、Accessible*和*ValueData 属性添加到 SecRecord（某些如[本示例](https://github.com/xamarin/monotouch-samples/blob/master/Keychain/Main.cs)中）也无济于事 - 仍然获得 SecStatusCode.Param。

是否有任何不明显的事情可能导致返回 Param 状态代码？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-12T18:09:48.853

我在尝试使用钥匙串时遇到了很多麻烦。我终于开始在应用程序中存储用户凭据。这是我所拥有的：

```
 SecRecord existingRec = new SecRecord (SecKind.GenericPassword) { 
            Service = Keychain.USER_SERVICE, 
            Label = Keychain.USER_LABEL 
        };

        var record = new SecRecord (SecKind.GenericPassword) {
            Service = Keychain.USER_SERVICE, 
            Label = Keychain.USER_LABEL, 
            Account = username,
            ValueData = NSData.FromString (password),
            Accessible = SecAccessible.Always
        };

        SecStatusCode code = SecKeyChain.Add (record);
        if (code == SecStatusCode.DuplicateItem) {
            code = SecKeyChain.Remove (existingRec);
            if (code == SecStatusCode.Success)
                code = SecKeyChain.Add (record);
        } 
```

Keychain 是一个带有常量的静态类，所以我不必重新输入字符串。

你和我唯一不同的是`CreationDate`/`MatchCaseInsensitive`属性和 NSData 的编码。也许在没有这些的情况下尝试一下，看看它是否有效？如果是这样，请将它们分别添加回来，看看是什么导致了问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-11T15:10:12.097

这可能是因为您在模拟器上运行 - 在这种情况下，您需要在当前构建配置的项目选项中添加一个 Entitlements plist 以使钥匙串访问工作。

# eclipse - Eclipse 中的 OpenGL ES 和 MinGW for Windows

> ID：13829025
> 
> 赞同：0
> 
> 时间：2012-12-11T21:46:27.990
> 
> 标签：eclipse, opengl-es, mingw

我想在 Eclipse 中编译 OpenGL ES 程序，以便在类似 PowerVR 的模拟器中使用。我用 MinGW 安装了 Eclipse，可以制作一个基本的 C++ hello-world 可执行文件，所以这是一个好的开始。我找到了这些 OpenGL ES[示例](http://code.google.com/p/opengles-book-samples/wiki/Instructions)并且希望能够在 Eclipse 中构建它们，所以我想下一步是让 Eclipse 构建一个 OpenGL ES 应用程序。这些示例希望我使用 Visual Studio，但我对使用它不感兴趣。我的主要目标是桌面和 Android，所以我认为坚持使用 Eclipse 将证明是有益的。我看到有许多像 GLEW 这样的库对制作 OpenGL 图形应用程序有很大帮助，但我猜这些库不能为移动平台的 OpenGL ES 编译——除非这是一个糟糕的假设。我来自曾经使用 OpenGL 和 glut 来制作 OpenGL 应用程序的背景。我想我对如何着手开始编写既适用于桌面平台又适用于移动平台的东西感到困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T02:30:13.703

我最终下载了用于 OpenGL ES 的 ARM MALI[模拟器](http://www.malideveloper.com/opengl-es-20-emulator.php)，经过一些配置以使其在 Eclipse 中构建，我想我现在正在路上。它构建起来相当容易，并且使用包含的 dll 文件，我可以让它在 Windows 下运行；所以现在我可以开始为 OpenGL ES 编程，并确保它可以在支持 OpenGL ES 的移动平台上工作——我没有 Android 设备，也没有 mac 电脑，所以这看起来很理想。我想最终当我决定为桌面编程并更好地了解 OpenGL ES 2.0 中可用的内容时，我将安装 GLEW 和 GLUT，这些内容也可用于标准 OpenGL。

# ruby-on-rails - Rails 控制器没有选择匹配的模型和方法

> ID：13829032
> 
> 赞同：0
> 
> 时间：2012-12-11T21:46:52.303
> 
> 标签：ruby-on-rails, pluralize

所以我的 Rails 控制器由于某种原因不能（正常）工作。

当我第一次打开控制器文件时，我首先注意到了一些有趣的事情。

![Vim 语法高亮](../Images/9d87bb55b532d64ebbc1505ddafc45ca.png)

将此与正常的语法突出显示进行比较。（还要注意名字过长）

![普通语法高亮](../Images/4358fd21ddc6cac54fd85b4e6ade9531.png)

这是我尝试在其中一个视图中创建链接时遇到的错误。

```
ActionView::Template::Error (undefined method `new_voyage_at_port_log_entries_path' for #<#<Class:0x007fb1c5921a98>:0x007fb1c81a32a0>): 
```

这是我在路线中插入它的证明。

```
resources :voyage_at_port_log_entries 
```

我确实通过创建手动路由来让它工作，但这有点尴尬，我以后可能会预见到问题。为什么 ActionView 可能不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T21:46:52.303

呃！路线是为单数版本创建的。

所以...

```
new_voyage_at_port_log_entry_path 
```

作品！

但是...语法突出显示仍然关闭...嗯...不重要但很奇怪...可能有不同的复数引擎？

# c# - 如何将多个选定值从一个列表框中添加到第二个 asp.net 列表框

> ID：13829036
> 
> 赞同：0
> 
> 时间：2012-12-11T21:46:59.730
> 
> 标签：c#, asp.net

我有两个列表框，我试图将多个值从一个传递到另一个。asp.net 代码

```
<asp:UpdatePanel ID="userButtonPanel" runat="server" UpdateMode="Conditional">
                                <ContentTemplate>
                                    <asp:LinkButton Text=">>" ID="lbtn_add" CssClass="button advButtons addRemButton"
                                        runat="server" OnClick="addMappedUser_Click" />
                                    <asp:LinkButton Text="<<" ID="lbtn_remove" CssClass="button advButtons addRemButton"
                                        runat="server" OnClick="removeMappedUser_Click" />
                                </ContentTemplate>
                            </asp:UpdatePanel>
                        </div>
                        <div>
                            <asp:Label ID="lbl_MappedUSers" Text="Mapped Users" runat="server" />
                            <asp:ListBox ID="listMappedUsers" runat="server" SelectionMode="Multiple" CssClass="listboxMappedUsers"  />
                        </div>
                    </div>
                </div>
                <input id="cbUserList" type="hidden" runat="server" value="" />
                <input id="cbUserRoleID" type="hidden" runat="server" value="" />
            </ContentTemplate>
        </asp:UpdatePanel> 
```

在单击事件时，`addMappedUser_Click`我评估 listAllUsers 列表框以查看选择了哪些项目并创建这些项目的列表

```
protected void addMappedUser_Click(object sender, EventArgs e)
        {
            List<ListItem> selectedItems = listAllUsers.Items.Cast<ListItem>().Where(i => i.Selected).ToList();
            List<AddedUsers> newusers = new List<AddedUsers>();
            foreach (var item in selectedItems)
            {
                AddedUsers au = new AddedUsers();
                au.UserID = item.Value;
                au.UserName = item.Text;
                newusers.Add(au);
            }

            MoveSelectedItems(newusers, listAllUsers);
        } 
```

创建该列表后，将其传递给`MoveSelectedItems Method`

```
protected void MoveSelectedItems(List<AddedUsers> from, ListBox to)
        {

            if (from.Count == 0)
            {
                return;
            }

            SecurityUserRole sur = new SecurityUserRole();

            ListItem item = new ListItem();
            foreach (var i in from)
            {
                item.Value = i.UserID;
                item.Text = i.UserName;             
                if (listAllUsers.Items.Contains(item))
                {
                    listAllUsers.Items.Remove(item);
                    listMappedUsers.Items.Add(item);
                }  

                sur.SecurityUserId = Convert.ToInt32(i.UserID);
                sur.SecurityRoleId = Convert.ToInt32(RoleID);
                MappedUser.Add(sur);
                Session["MappedUser"] = MappedUser;
                checkMappingButtons(listMappedUsers, listAllUsers);
                editUserUpdatePanel.Update();
            }
        } 
```

我遇到困难的地方是将用户添加到第二个列表框（listMappedUsers.Items.Add）当我设置断点时，我可以看到每个值都通过（例如“201”、“202”、“203” ) 但是，当更新面板更新时，列表框将仅列出 203 个 3 次。

有人可以帮助我了解我缺少什么以及为什么最后一个值是列表框中出现的唯一值而不是以前的前辈？

提前致谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T21:50:50.137

在你的最后一段代码中，你需要`ListItem`在你的`foreach`. 就像现在一样，您`item`在`foreach`.

```
protected void MoveSelectedItems(List<AddedUsers> from, ListBox to)
    {

        if (from.Count == 0)
        {
            return;
        }

        SecurityUserRole sur = new SecurityUserRole();

        ListItem item;
        foreach (var i in from)
        {
            item = new ListItem();
            item.Value = i.UserID;
            item.Text = i.UserName;             
            if (listAllUsers.Items.Contains(item))
            {
                listAllUsers.Items.Remove(item);
                listMappedUsers.Items.Add(item);
            }  

            sur.SecurityUserId = Convert.ToInt32(i.UserID);
            sur.SecurityRoleId = Convert.ToInt32(RoleID);
            MappedUser.Add(sur);
            Session["MappedUser"] = MappedUser;
            checkMappingButtons(listMappedUsers, listAllUsers);
            editUserUpdatePanel.Update();
        }
    } 
```

# node.js - 如何获取在 NodeJS 中执行的脚本的文件名？

> ID：13829037
> 
> 赞同：47
> 
> 时间：2012-12-11T21:47:02.263
> 
> 标签：node.js

如何获取 NodeJS 应用程序中正在执行的脚本的文件名？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-12-11T21:48:32.827

您可以使用变量`__filename`

[http://nodejs.org/docs/latest/api/globals.html#globals_filename](http://nodejs.org/docs/latest/api/globals.html#globals_filename)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-06-11T21:27:20.933

使用模块的`basename`方法`path`：

```
var path = require('path');
var filename = path.basename(__filename);
console.log(filename); 
```

[这](http://nodejs.org/api/path.html#path_path_basename_p_ext)是上面示例的文档。

正如 Dan 指出的，Node 正在开发带有“--experimental-modules”标志的[ECMAScript 模块。](https://nodejs.org/api/esm.html)节点 12 仍然[支持`__dirname`和`__filename`](https://nodejs.org/api/all.html#modules_dirname)同上。

* * *

如果您使用`--experimental-modules`标志，则有[另一种方法](https://stackoverflow.com/questions/46745014/alternative-for-dirname-in-node-when-using-the-experimental-modules-flag)。

另一种方法是获取[当前 ES 模块的路径](https://medium.com/@nodejs/announcing-a-new-experimental-modules-1be8d2d6c2ff)：

```
const __filename = new URL(import.meta.url).pathname; 
```

对于包含当前模块的目录：

```
import path from 'path';

const __dirname = path.dirname(new URL(import.meta.url).pathname); 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-12-11T21:48:51.667

你需要使用`process.argv`. 其中将包含从命令行执行的脚本的名称，该名称可能与您在`__filename`. 哪个合适取决于您的需求。

[http://nodejs.org/docs/latest/api/process.html#process_process_argv](http://nodejs.org/docs/latest/api/process.html#process_process_argv)

# javascript - 组织计划的物理学

> ID：13829038
> 
> 赞同：0
> 
> 时间：2012-12-11T21:47:34.487
> 
> 标签：javascript, html, physics, organization

我一直在尝试创建一些东西（更基本），如下面链接的视频所示：

[http://blog.theclinic.eu/?p=653](http://blog.theclinic.eu/?p=653)（应该在 14:30 开始）

这是 John Maeda 的演讲，他演示了他的名为 Powershop 的应用程序。我一直在尝试重新创建具有相同效果的东西，但我无法弄清楚如何让圆圈保持这样的距离而不会发生碰撞，关于如何接近它的任何建议？

我试图使约束具有最小和最大距离，以便它们跟随，我试图让圆圈轨道，但似乎没有一个看起来像他的。

我正在尝试使用 javascript/HTML5，但我只是想要一些关于该方法的提示或建议！（我的物理/数学知识有限，所以我可能会错过一些明显的概念来应用？）

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T03:11:18.593

如果您正在寻找一个不错的罐头解决方案，而不是从头开始构建所有内容，我建议您查看[Box2D](http://box2d-js.sourceforge.net/)。

您在 Powershop 图形中看到的系统是一个简单的物理模型，其中每个“球”或“节点”或你所拥有的都是排斥所有其他球/节点的带电物体。如果您将系统建模为由自由旋转的线连接的点的集合，您所要做的就是了解一些物理知识，以便使用 Box2D 获得这种效果。即，同电荷排斥。

应该就这么简单。您将约束一组点，以便每个点都必须保持在距中心 L 的长度内，这将是所有球旋转的手臂模型。然后，您将为每个点赋予完全相同的电荷，它们将相互排斥并以良好的弹性效果均匀分布。

（你获得创意的部分是你想如何添加一个全新的点集合，比如当你的 Powershop 演讲中的演讲者点击一个节点时。）

# java - 报警管理器日历

> ID：13829039
> 
> 赞同：1
> 
> 时间：2012-12-11T21:47:38.683
> 
> 标签：java, android, alarmmanager, android-calendar

关于警报管理器的问题我有这个代码

```
Calendar cal = Calendar.getInstance();
    cal.add(Calendar.SECOND, 5);
     Integer prof=t.getProfile();
    String prof2=prof.toString();
    Intent intent = new Intent(this, AlarmActivity.class);
    intent.putExtra("prof",(String)prof2);
    PendingIntent pendingIntent = PendingIntent.getActivity(this,(int)t.getId(), intent, PendingIntent.FLAG_CANCEL_CURRENT);
    AlarmManager am =
            (AlarmManager)getSystemService(Activity.ALARM_SERVICE);
    am.set(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(),
            pendingIntent); 
```

它尚未完成......我知道我可以使用 cal.set(Calendar.MINUTES,minutes); 设置日历的时间 几个小时都一样。。

但是我如何设置日期？例如 - 星期一？day_of_week 设置了吗？如果是这样 - 范围是 0-6 还是 1-7？最低值是周一还是周日？

另外，如果我要进行重复活动（每周一次）-我应该制作新日历并设置星期几/小时/分钟吗？还是我应该使用 getInstance() 并更改一周中的小时/分钟/天？

关于报警管理器。当你发出警报时，你给出的 request_code 应该是唯一的。如果我重新启动手机 - 所有请求代码是否都保留在手机的警报管理器中？如果没有 - 如何让他们留下来......如果是 - 我如何在测试时删除不必要的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T21:53:13.233

您还可以使用：

```
cal.add(Calendar.DATE, 7) 
```

将当前日历设置的日历时间设置为一周（并减去等）。

我认为这里可能需要链接到文档：

[http://developer.android.com/reference/java/util/Calendar.html](http://developer.android.com/reference/java/util/Calendar.html)

关于您的第二个问题，没有警报管理器不会在手机重新启动时持续存在，您必须将它们保存在共享首选项或 SQL 中，然后在下次手机（和您的应用程序）重新启动时重新加载警报......

要取消警报，请使用 alarm.cancel(pendingIntent)。您需要自行跟踪的pendingIntents。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T21:52:15.590

可以在[此处](https://stackoverflow.com/questions/4700285/android-how-to-set-an-alarm-to-a-specific-date)找到如何设置日历的示例。此外，Android 开发人员的[API](http://developer.android.com/reference/java/util/Calendar.html)显示了多种设置日期的方法

# php - 提取最后5个产品mysql

> ID：13829046
> 
> 赞同：0
> 
> 时间：2012-12-11T21:48:07.443
> 
> 标签：php, mysql

如何从 mysql 数据库中提取最后添加的 3 个产品（按日期）？

结构体：

```
id  name      date
1    xx     01.01.2001
2    yy     02.02.2002
3    zz     03.03.2003
4    aa     01.01.2004
5    bb     02.02.2005
6    cc     03.03.2006 
```

询问将返回以下行：

```
4    xx     01.01.2004
5    yy     02.02.2005
6    zz     03.03.2006 
```

谁能帮我？ps对不起我的英语:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T21:49:51.073

```
SELECT    id, name, date
FROM      TABLENAME
ORDER BY  date DESC
LIMIT     0, 3 
```

# python - 如果我不从 scrapy 中的爬虫子类化，我该如何关注链接

> ID：13829049
> 
> 赞同：0
> 
> 时间：2012-12-11T21:48:30.827
> 
> 标签：python, django, scrapy

这是我的代码，我的蜘蛛没有关注我有 InitSpider 的子类的链接

```
class TestSpider(InitSpider):
    name = 'login'
    allowed_domains = ['example.com']
    start_urls = ['http://www.example.com']
    rules = (Rule(SgmlLinkExtractor(allow=('example\.com', 'PostSearch'),restrict_xpaths = "//dd[@class='nextPage']"), callback='parse_items', follow=True),)

    def parse_items(self, response):

        hxs = HtmlXPathSelector(response) 
```

*   我正在使用这个例子[https://stackoverflow.com/a/5857202/1894766](https://stackoverflow.com/a/5857202/1894766) *

# java - 在列表视图中填充数据时出现空引用异常

> ID：13829056
> 
> 赞同：1
> 
> 时间：2012-12-11T21:48:55.363
> 
> 标签：java, for-loop, android-listview, mono, android-widget

我想为 listview 构建自定义列表适配器。[我从http://www.wrox.com/WileyCDA/](http://www.wrox.com/WileyCDA/)引用了代码。

我正在为 Android 使用 Mono。

我有这样的课：

```
namespace AnimalList
{
    public class Animal
    {
        public string Name
        {
            get;
            set;
        }

        public string Description
        {
            get;
            set;
        }

        public int Image
        {
            get;
            set;
        }
    } 
```

列出适配器如下：

```
namespace AnimalList
{
    public class AnimalListAdapter : BaseAdapter<Animal>
    {
        Activity context;
        public List<Animal> Animals;

        public AnimalListAdapter(Activity context, List<Animal> animals)
            : base()
        {
            this.context = context;
            this.Animals = animals;
        }

        public override int Count
        {
            get { return this.Animals.Count; }
        }

        public override Animal this[int position]
        {
            get { return this.Animals[position]; }
        }

        public override View GetView(int position, View convertView, ViewGroup parent)
        {
            //Get our object for this position
            var item = this.Animals[position];

            //Try to reuse convertView if it's not  null, otherwise inflate it from our item layout
            // This gives us some performance gains by not always inflating a new view
            // This will sound familiar to MonoTouch developers with UITableViewCell.DequeueReusableCell()
            var view = convertView;

            if (convertView == null || !(convertView is LinearLayout))
                view = context.LayoutInflater.Inflate(Resource.Layout.AnimalItem, parent, false);

            //Find references to each subview in the list item's view
            var imageItem = view.FindViewById(Resource.Id.imageItem) as Android.Widget.ImageView;
            var textTop = view.FindViewById(Resource.Id.textTop) as Android.Widget.TextView;
            var textBottom = view.FindViewById(Resource.Id.textBottom) as Android.Widget.TextView;

            //Assign this item's values to the various subviews
            imageItem.SetImageResource(item.Image);
            textTop.SetText(item.Name, TextView.BufferType.Normal);
            textBottom.SetText(item.Description, TextView.BufferType.Normal);

            //Finally return the view
            return view;
        }

        public override long GetItemId(int position)
        {
            return position;
        }
    } 
```

并将活动列为：

```
 [Activity(Label = "Animal List", MainLauncher = true)]
 public class AnimalListActivity : ListActivity
{
    protected override void OnCreate(Bundle savedInstanceState)
    {
        base.OnCreate(savedInstanceState);

        this.ListAdapter = new AnimalListAdapter(this,
                                                 new List<Animal>() {
            new Animal() { Name = "Elephant", 
                Description = "Big and Gray, but what the hey", 
                Image = Resource.Drawable.Icon },
            new Animal() { Name = "Chinchilla", 
                Description = "Little people of the andes", 
                Image = Resource.Drawable.Icon },
            new Animal() { Name = "Lion", 
                Description = "Cowardly lion, anyone?", 
                Image = Resource.Drawable.Icon },
            new Animal() { Name = "Skunk", 
                Description = "Ello, baby. I am ze locksmith...",
                Image = Resource.Drawable.Icon },
            new Animal() { Name = "Rhino", 
                Description = "Most live to about 60!", 
                Image = Resource.Drawable.Icon },
            new Animal() { Name = "Zebra", 
                Description = "Stripes, not so great for hiding", 
                Image = Resource.Drawable.Icon }
        });         
    }
}} 
```

在将列表填充为以下内容时出现异常：

```
System.NullReferenceException: Object reference not set to an instance of an object. 
```

我不明白出了什么问题？

# jquery - 将数据传递给 jquery.on() 中的函数

> ID：13829061
> 
> 赞同：-2
> 
> 时间：2012-12-11T21:49:08.487
> 
> 标签：jquery

我有以下 jquery 代码：

```
$(document).delegate('.draggable','mousedown', function() {
...
var connected_nodes = $(".linked-to" + node_num);   //all the nodes connected to the selected node
    var lines = $("div[id*='"+node_num+"']");   //all the lines which are connected to selected node
...
$(this).on('mousemove.link', dragNodes);

    function dragNodes(connected_nodes, lines)
    {
... 
```

我正在尝试将 connected_nodes 和 lines 传递给函数。我试着做

```
$(this).on('mousemove.link', dragNodes(connected_nodes, lines)); 
```

然后一切都停止了工作。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T21:58:24.990

*（因为看起来您不想扩展问题。我将尝试回答可用的内容。）*

尝试：

```
$(this).on('mousemove.link', function(){
  dragNodes(connected_nodes, lines);
}); 
```

# gwt-mvp - GWTP 隐藏 URL 中的参数

> ID：13829065
> 
> 赞同：2
> 
> 时间：2012-12-11T21:49:31.857
> 
> 标签：gwt-mvp, gwtp

是否可以隐藏 URL 中的参数？

```
placeManager.revealPlace(new PlaceRequest("show").with("t", "e").with("x", "1"), true); 
```

网址：

```
gwt.codesvr=127.0.0.1%3A9997#show;t=e;x=1 
```

我希望 URL 为 gwt.codesvr=127.0.0.1%3A9997#show。这可能吗？或任何其他方法来做到这一点？

我尝试传递一个事件。但在这种情况下 URL 不会改变。

谢谢， 普拉迪普

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-24T16:36:58.123

在 GWTP 中不可能隐藏 Place(Request)s 的参数，因为 Place 代表浏览器历史记录中的一个状态，并且必须可以（反）序列化到 URL 中/从 URL 中序列化。

由于我不了解您的架构，因此我无法为您提供解决方法的好建议。如果您喜欢脏，只需使用在显示该位置之前初始化的静态字段。

# javascript - Node.js Express 和 Mongoose，在 save() 之后渲染

> ID：13829071
> 
> 赞同：2
> 
> 时间：2012-12-11T21:49:59.860
> 
> 标签：javascript, node.js, asynchronous, express, mongoose

我刚开始通过创建一个简单的博客网站来试验 Node.js Express 和 Mongoose。

我正在尝试构建一些将执行一些简单的数据库操作的路由，但是我对异步函数以及我的代码是否每次都能正确执行感到困惑。

这基本上就是我所拥有的：

```
app.get('/createUser', function(req, resp) {
    var newUser = new User({name: 'abc123', pass: 'password321'});
    newUser.save(function(err){ // will this callback always be called correctly?
        if(err) resp.send('ERROR!');
        resp.send('SUCCESS!');
    });
}); 
```

所以我希望将响应写为“错误！” 对于保存中的任何错误，以及“成功！” 保存成功时。但是，我对这些功能的时间安排感到困惑。get() 函数会在 save() 完成之前返回吗？如果是这样，响应会不会被正确写出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T21:54:56.557

get() 函数将在 save 函数执行之前*完成*，但由于在执行 save 回调之前没有任何内容写入响应，因此在此之前响应对浏览器不可用。

我在您的代码中添加了一些 console.log() 调用，以便您可以查看执行顺序：

```
app.get('/createUser', function(req, resp) {

    console.log('this will print first');

    var newUser = new User({name: 'abc123', pass: 'password321'});
    newUser.save(function(err){ // will this callback always be called correctly?

        console.log('this will print last');

        if(err) {
            resp.send('ERROR!');
        }
        else {
            resp.send('SUCCESS!');
        }
    });

    console.log('this will print second');

}); 
```

# c++ - 将 boost::function 传递给模板；boost::function 是什么类

> ID：13829077
> 
> 赞同：5
> 
> 时间：2012-12-11T21:50:22.373
> 
> 标签：c++, templates, boost, boost-bind, boost-function

我需要将距离函数传递给模板。因此我使用 boost::function 和 boost::bind。但我不明白我必须通过什么**课程距离**：

```
template<class DataType, class Point, class Distance>
class CoverTree
{
    Distance distance;
    ...
    public:
     CoverTree(const Distance& distance) : max_level(default_max_level), min_level(default_max_level), distance(distance) {}
    ...
} 
```

模板作者的示例如下所示：

```
float euclidian(const std::vector<float>& p1, const std::vector<float>& p2)
{
    ...
}
int main(int argc, char** argv)
{
    CoverTree<float, std::vector<float>, float (*const)(const std::vector<float>&, const std::vector<float>&)> tree(&euclidian);
    ...
} 
```

现在这是我的主要内容：

```
int main(int argc, char** argv)
{
    AllData myData;
    boost::function<float (const vector<Frame>::const_iterator&, const vector<Frame>::const_iterator&)> j_dist;
    j_dist = boost::bind(&AllData::jaccard_distance, myData, _1, _2);
    myData.AddData("C:\\...");
    cout<<j_dist(myData.DATAx.begin()+20, myData.DATAx.begin()+40)<<endl; //works fine
    CoverTree<float, vector<Frame>::const_iterator, ???> tree(&j_dist);
    ...
} 
```

首先，有人能解释一下 (*const) 是什么意思，或者我可以在哪里读到这个吗？
第二：我想我写了你需要的一切，告诉你要写什么**？？？**但我不明白。
我已经尝试过：

```
boost::function<float (const vector<Frame>::const_iterator&, const vector<Frame>::const_iterator&) 
```

和

```
float (*const) (const vector<Frame>::const_iterator&, const vector<Frame>::const_iterator&) 
```

但这是很好的尝试和错误:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T21:58:41.263

> 首先，有人能解释一下 (*const) 是什么意思，或者我可以在哪里读到这个吗？

在作者的例子中，距离函数是：

```
float euclidean(const std::vector<float>&, const std::vector<float>&); 
```

传递给`CoverTree`构造函数的参数是该函数的地址，即`&euclidean`，它是一个函数指针类型

```
float (*)(const std::vector<float>&, const std::vector<float>&) 
```

模板参数 for`CoverTree`只是`const`该类型的 - 限定版本。由于 C 和 C++ 中函数的特殊“由内而外”声明符语法，指向该函数类型的 const 指针声明为：

```
float (* const)(const std::vector<float>&, const std::vector<float>&) 
```

这类似于指向 的`const`指针`int`，它被声明为：

```
int* const 
```

在您的情况下，您的类型正确，它是：

```
boost::function<float (const vector<Frame>::const_iterator&, const vector<Frame>::const_iterator&) 
```

让我们使用 typedef 来引用它：

```
typedef boost::function<float (const vector<Frame>::const_iterator&, const vector<Frame>::const_iterator&) distance_func; 
```

但问题是您没有传递该类型的参数，而是传递了指向该类型的指针：

```
CoverTree<float, vector<Frame>::const_iterator, distance_func> tree(&j_dist);
                                                                    ^^^^^^^ 
```

您可以通过以下方式看到这不起作用：

```
distance_func f = &j_dist;  // ERROR! cannot convert distance_func* to distance_func 
```

答案应该是简单地传递正确类型的参数：

```
CoverTree<float, vector<Frame>::const_iterator, distance_func> tree(j_dist);
                                                                    ^^^^^^ 
```

# hash - PDO 准备好的语句中的散列和加盐

> ID：13829081
> 
> 赞同：0
> 
> 时间：2012-12-11T21:50:34.023
> 
> 标签：hash, pdo, sha1, salt

有人可以告诉我在 PDO 准备好的语句中用于散列和加盐的正确格式吗？在担心更复杂的功能之前，我正在从 php 切换并尝试让它在一个简单的 INSERT 语句中工作，而我在网上看到的任何东西都没有奏效。

在 php 中，我正在这样做：`'".sha1($salt + $_POST['password'])."'`

我试过了：

```
$password = '123456'; 
$hash = hash('sha1', $password);
$pass1 = hash('sha1', $salt . $hash . $password); 
```

$salt 在 config.php 中定义，正确引用，并在 php insert 语句中正常工作。

**编辑 -**

这是我正在使用的 INSERT 语句：

```
$stmt = $conn->prepare('INSERT INTO customer_info (fname...) VALUES(:fname...)');
$stmt->bindParam(':fname', $_POST['fname'], PDO::PARAM_STR);
$stmt->execute(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T09:06:58.150

大多数数据库系统没有像样的密码散列函数可用，因此您无法使用 SQL 生成散列值。我不确定“从 PHP 切换”是什么意思，但让开发语言生成哈希，而不是数据库系统。

每个密码的盐应该不同，全局盐不能实现其目的。你的“盐”实际上是一把钥匙（或胡椒），它总是一样的。盐必须与散列值一起存储（明文），您需要将存储的散列与输入密码的散列进行比较。

PHP 5.5 将拥有自己的功能`password_hash()`并`password_verify()`准备就绪，以简化生成 BCrypt 密码哈希。我强烈推荐使用这个优秀的 api，或者它是早期 PHP 版本的[兼容包](https://github.com/ircmaxell/password_compat/blob/master/lib/password.php)。然后我会邀请您在本[教程](http://www.martinstoeckli.ch/hash/hash.html)中阅读更多关于使用盐和胡椒进行正确密码存储的信息。

编辑：

通常带有 PDO 的插入看起来像这样：

```
$password = $_POST['password'];
$hashedPassword = sha1($password . $salt);
$sql = 'INSERT INTO user (name, passwordhash) VALUES (?, ?)';
$sth = $pdo->prepare($sql);
$sth->execute(array('Jack Cornfield', $hashedPassword)); 
```

当然，您的陈述看起来会有所不同，但我不知道您的表格和字段。在示例中，散列的生成是在纯 PHP 中完成的，并将结果`$hash`参数化添加到带有占位符的 sql 语句中。

# django - 过滤存在相关对象的 Django 对象

> ID：13829082
> 
> 赞同：44
> 
> 时间：2012-12-11T21:50:40.487
> 
> 标签：django

这肯定是一个重复的问题，但我找不到其他问题。我正在尝试获取有投诉的照片列表。我不能简单地收到投诉并处理相关照片 - 我需要照片查询集。

这应该有效，但似乎不正确：

```
Photo.objects.filter(complaint__id__gte=0) 
```

这似乎不是最有效的方法：

```
Photo.objects.annotate(Count('complaint')).exclude(complaint__count=0) 
```

有没有更好的办法？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-12-11T21:57:11.490

怎么样 ...

`Photo.objects.filter(complaint__isnull=False)`

来自[https://docs.djangoproject.com/en/dev/topics/db/queries/](https://docs.djangoproject.com/en/dev/topics/db/queries/)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2017-07-13T10:04:32.073

我不确定哪个变体是最好的，但也可以。

`Photo.objects.exclude(complaint=None)`

此处生成的 SQL 查询与 case`.filter(complaint__isnull=False)`不同，但意义相同。

# android - 尝试发布到朋友墙时出现 OAuthException

> ID：13829086
> 
> 赞同：4
> 
> 时间：2012-12-11T21:50:57.767
> 
> 标签：android, facebook

我在尝试使用 Android 中的 Facebook api 向朋友墙发帖时遇到了很多麻烦。这就是我目前所拥有的：

```
if (facebook.isSessionValid()) {
                        String response = facebook.request((userID == null) ? "me" : userID);

                        Bundle params = new Bundle();
                        params.putString("message", "put message here");
                        params.putString("link", "http://mylink.com");    
                        params.putString("caption", "{*actor*} just posted this!");
                        params.putString("description", "description of my link.  Click the link to find out more.");
                        params.putString("name", "Name of this link!");
                        params.putString("picture", "http://mysite.com/picture.jpg");

                        response = facebook.request(((userID == null) ? "me" : userID) + "/feed", params, "POST");       

                        Log.d("Tests",response);
                        if (response == null || response.equals("") || 
                                response.equals("false")) {
                            Log.v("Error", "Blank response");
                        }
                    } else {
                        // no logged in, so relogin
                        Log.d("1234567890", "sessionNOTValid, relogin");

                    }
                }catch(Exception e){
                    e.printStackTrace();
                } 
```

但这会返回此错误：

```
12-11 21:34:06.604: D/FACEBOOK RESPONSE(14954): {"error":{"message":"(#200) Feed story publishing to other users is disabled for this application","type":"OAuthException","code":200}} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-12T00:14:48.203

您可能最近创建了这个 Facebook 应用程序，这意味着 2013 年 2 月的重大更改已启用。

[二月的重大变化](https://developers.facebook.com/roadmap/)包括：

> 移除通过 Graph API 向朋友墙发帖的功能
> 
> 我们将删除通过 Graph API 向用户朋友的墙发帖的功能。具体来说，针对 [user_id]/feed 的 [user_id] 与会话用户不同的帖子，或 target_id 用户与会话用户不同的 stream.publish 调用将失败。如果您想允许人们发布到他们朋友的时间线，请调用提要对话框。通过用户提及标签或动作标签包含朋友的故事将显示在朋友的时间线上（假设朋友批准标签）。有关详细信息，请参阅此博客文章。

我们将从 2 月开始禁用此功能，如果您希望启用它（仅在 2 月之前暂时启用），请转到您的应用仪表板 > 设置 > 高级 > 禁用“2013 年 2 月重大更改”

但是，我强烈建议不要这样做，因为从 2 月开始，此功能将导致您的应用再次抛出相同的错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-31T09:37:10.067

我有可能对您有所帮助的解决方案，我将它用于我的代码并且它工作正常..

私人无效publishFeedDialog（字符串friend_uid）{

```
 try{
            Session mCurrentSession = Session.getActiveSession();

            SessionTracker mSessionTracker = new SessionTracker(
                    getBaseContext(), new StatusCallback() {
                        public void call(Session session, SessionState state,
                                Exception exception) {
                        }
                    }, null, false);
            String applicationId = Utility
            .getMetadataApplicationId(getBaseContext());
            mCurrentSession = mSessionTracker.getSession();

            if (mCurrentSession == null
                    || mCurrentSession.getState().isClosed()) {
                mSessionTracker.setSession(null);
                Session session = new Session.Builder(getBaseContext())
                .setApplicationId(applicationId).build();
                Session.setActiveSession(session);
                mCurrentSession = session;
            }

            if (!mCurrentSession.isOpened()) {
                Session.OpenRequest openRequest = null;
                openRequest = new Session.OpenRequest(
                        NewFriendList.this);

                if (openRequest != null) {
                    openRequest
                    .setDefaultAudience(SessionDefaultAudience.FRIENDS);
                    openRequest.setPermissions(Arrays.asList("email", "publish_actions"));
                    openRequest
                    .setLoginBehavior(SessionLoginBehavior.SUPPRESS_SSO);

                    mCurrentSession.openForPublish(openRequest);
                }
            }

            if (regobj != null && friend_uid != null ) {

                final Activity activity = this;
                Bundle params = new Bundle();
                //This is what you need to post to a friend's wall
                params.putString("from", "" + regobj.MyFBID);
                params.putString("to", friend_uid);
                //up to this
                params.putString("name", "Facebook SDK for Android");
                params.putString("caption", "Build great social apps and get more installs.");
                params.putString("description", "The Facebook SDK for Android makes it easier and faster to develop Facebook integrated Android apps.");
                params.putString("link", "https://developers.facebook.com/android");
                params.putString("picture", "https://raw.github.com/fbsamples/ios-3.x-howtos/master/Images/iossdk_logo.png");
                WebDialog feedDialog = (new WebDialog.FeedDialogBuilder(this, mCurrentSession, params))
                        .setOnCompleteListener(new OnCompleteListener() {

                        @Override
                        public void onComplete(Bundle values, FacebookException error) {
                            if (error == null) {
                                // When the story is posted, echo the success
                                // and the post Id.
                                final String postId = values.getString("post_id");
                                if (postId != null) {
                                    Toast.makeText(activity,
                                        "Posted story, id: "+postId,
                                        Toast.LENGTH_SHORT).show();
                                } else {
                                    // User clicked the Cancel button
                                    Toast.makeText(activity, 
                                        "Publish cancelled", 
                                        Toast.LENGTH_SHORT).show();
                                }
                            } else if (error instanceof FacebookOperationCanceledException) {
                                // User clicked the "x" button
                                Toast.makeText(activity, 
                                    "Publish cancelled", 
                                    Toast.LENGTH_SHORT).show();
                            } else {
                                // Generic, ex: network error
                                Toast.makeText(activity, 
                                    "Error posting story", 
                                    Toast.LENGTH_SHORT).show();
                            }
                        }

                    }).build();
                feedDialog.show();
            }
    }catch(Exception e)
    {
        Log.d("Error", ""+e.toString());
    }
} 
```

此代码仅适用于一个用户，如果要将其发送给多个用户，则可以使用 RequestsDialogBu​​ilder 而不是 WebDialog。

# python - 将 Twitter XML 日期转换为 Python 日期对象

> ID：13829087
> 
> 赞同：3
> 
> 时间：2012-12-11T21:51:00.123
> 
> 标签：python, xml, date, datetime, twitter

我正在尝试将 Twitter 的“created_at”标签信息从 XML 文件转换为 Python 中的日期对象。我拼凑了一些代码，这些代码可以让我大部分时间到达那里，但是当我尝试将找到的日期与其他日期对象进行比较时，它就崩溃了。这是我到目前为止所拥有的：

```
import time
from datetime import datetime

#Twitter part removed... generates a list of dates from the XML called date_list

#Takes the first item from the list (date_list) and converts it to a string
date_str = str(date_list[0])

#Takes the string (date_str) and converts it to datetime
time_struct = time.strptime(date_str, "%a %b %d %H:%M:%S +0000 %Y")
date_datetime = datetime.fromtimestamp(time.mktime(time_struct))

#Converts datetime to just date
date = date_datetime.date()

if date_datetime < datetime.now():
    print "yes"

if date < datetime.date.today():
    print "yes, also" 
```

至于输出，我得到一个是，然后最后一行出现“AttributeError：'method_descriptor'对象没有属性'today'”。

我尝试将导入更改为“导入日期时间”，但随后出现以下错误`AttributeError: 'module' object has no attribute 'fromtimestamp'`并且没有输出。

似乎我导入日期时间并且代码的 fromtimestamp 部分停止工作，或者我导入“从日期时间导入日期时间”并且我无法创建日期对象？我已经看到其他线程可以帮助您从 Twitter 日期到日期时间，但是您如何一直到日期（没有分钟、秒等）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T21:55:29.757

尝试`datetime.now().date()`或`datetime.today().date()`代替。否则，你还需`from datetime import date`要做`date.today()`

# java - 返回数组中的最大值？

> ID：13829088
> 
> 赞同：0
> 
> 时间：2012-12-11T21:51:03.603
> 
> 标签：java, arrays, return-value

我有一个关于这个问题的作业

编写一个函数 maxArray，它接收一个双精度数组并返回数组中的最大值。使用这个功能

```
double maxArray(double dar[], int size); 
```

* * *

我做了他想做的事，但我在 main 方法中的调用语句有问题！

这是我的代码：

```
public class Q3 {

    public static void main(String[] args) {
        double dar[] = { 22.5 , 10.23 , 15.04 , 20.77 };
        double max = maxArray(dar,4);
        System.out.println("the largest number is : " + max);
    }

    double maxArray(double dar[], int size) {
        double maxV = 0;
        for (int i = 0; i < dar.length; i++) {
            if (dar[i] > maxV ) {         
                maxV = dar[i];          
            }
        }
        return maxV;
    } 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T21:52:58.303

你不能调用你的方法的原因是`main()`你的方法不是。`main()``static`

将其更改为：

```
static double maxArray(double dar[], int size) 
```

当您使用它时，请删除它，`size`因为它不是必需的。

可能还值得注意的是，如果数组包含负数，您的方法将失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T21:53:40.030

您的**maxArray**方法**是非静态**方法。如果没有类的实例，您无法从静态方法访问非静态方法，您应该创建类的实例并调用 maxArray 方法

```
double max = new Q3().maxArray(dar,4); 
```

或者，您可以始终将您的 maxArray 方法标记为静态并直接从 main 方法调用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T21:57:54.923

您的问题是您试图从静态的 main 方法调用非静态方法 maxArray。这是一个问题，因为只能从类的实例调用非静态方法，而静态方法是通过类本身调用的。

要么让你的 maxArray 成为一个静态方法，要么在你的 main 方法中初始化一个 Q3 对象，然后像这样调用 maxArray 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-11T21:53:37.730

声明你的`maxArray`as `static`，这样你就可以从静态方法访问它`main()`

或者

您创建类的实例并从对象中调用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-11T21:59:24.007

你的方法必须是静态的，所以你必须说

```
static double maxArray(double dar[], int size) 
```

这里有一些提示你可以如何改进你的方法：因为你没有使用一次值“size”，你可以把它扔掉或者`i < dar.length`用`i < size`.

此外，`maxV`在 maxArray 方法中进行初始化时，您可能希望使用数组的第一个值 ( `double maxV = dar[0]`)，因为如果数组中的所有双精度数均为负数，则数字 0 的 maxV 将是最高的。（您也可以通过说 来使用可能的最低双精度值`double maxV = Double.MIN_NORMAL`）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-11T22:35:10.273

1）使你的方法静态
2）记住在java中使用 BigDecimal 类来做任何十进制算术。

# java - JSON 到 xlsx 转换器

> ID：13829091
> 
> 赞同：-1
> 
> 时间：2012-12-11T21:51:09.967
> 
> 标签：java, linux, json, excel

是否有某个工具已经可以做到这一点？我看过这个链接：

[所以链接](https://stackoverflow.com/questions/7172158/converting-json-to-xls-csv-in-java)

但是没有给出相关的答案，还有链接，SO链接和转换器，用于xlsx到JSON，但没有找到相反的任何东西

转换示例：

JSON：

```
{
"name" : "Joe",
"_id" : 7
} 
```

电子表格：

```
name  Joe
_id   7 
```

'name' 和 'joe' 位于相邻但独立的单元格\列中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:10:55.983

我不知道任何通用 API 来完成这项工作。但是，如果您已经为您的 json 提供了一个“映射器”，您可以使用 apache [POI API](http://poi.apache.org/)轻松生成 xls。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T16:40:07.160

我正在关闭它，我决定一直使用 json 而不是尝试来回转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-18T12:37:16.553

您可以使用[Alasql](http://github.com/agershun/alasql)控制台实用程序轻松完成此操作：

```
node alacon "select * into json('cities.json') from xlsx('cities.xlsx',{headers:true})" 
```

要使用 Alasql 控制台实用程序，请安装[Node.js](http://nodejs.org/)，然后安装[Alasql npm 包](https://www.npmjs.com/package/alasql)。

# perl - 在 mojolicious 中测试 JSON PUT 请求

> ID：13829092
> 
> 赞同：2
> 
> 时间：2012-12-11T21:51:12.920
> 
> 标签：perl, testing, mojolicious

我正在为使用 Mojolicious 框架开发的应用程序创建测试用例。我正在测试路由以对进行的 REST 调用做出适当的响应。我使用 JSON 作为服务器和客户端之间的通信方式。为了测试和请求`GET`，我使用以下函数`POST``DELETE`

`GET : get_ok()`
`POST: post_json_ok()`
`DELETE: delete_ok()`

但是因为`PUT`我无法使用`put_ok()`. 我使用 put_ok() 的例子是我

`my $t = Test::Mojo->new;`
`$t->put_ok('this/is/url/to/resource'=>{ "element" => "modified value"})->status_is(204)`

每次都得到一个错误的请求状态（400），所以测试失败。我`Test::Mojo`用于测试我的应用程序。

附加信息：

`$t->put_ok('http://localhost:3000/application/instances/system/test'=>{"model" => "testing put"})->status_is(204);`

`PUT`这是对尝试的请求的确切测试。是正在尝试更改为
`model`的资源的属性，并且预期的状态响应是.`test``testing put``204`

到控制器的映射是通过 `$r->route('/application/instances/system/:id, id => qr/[A-Za-z0-9 ]+/ -> via('put') ->to(controller => 'system', action => 'update_sys');`
此路由调用控制器中的`update_sys`方法完成的，这`system`就是资源的定位方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T02:50:41.223

实际上，在与 SRI 讨论 IRC 之后，他向我指出了一个几乎与您在[文档](http://mojolicio.us/perldoc/Test/Mojo)中的需求相同的示例。

```
# Test custom transaction
my $tx = $t->ua->build_json_tx('/user/99' => {name => 'sri'});
$tx->req->method('PUT');
$t->tx($t->ua->start($tx))
  ->status_is(200)
  ->json_is('/message' => 'User has been replaced.'); 
```

所以这应该适合你！

**后记：**

您可能有兴趣知道这次讨论带来了一些进展：Mojolicious 的下一个版本（版本 3.66）现在将为此目的提供更简洁的语法，即新[`request_ok`](http://mojolicio.us/perldoc/Test/Mojo#request_ok)方法。上面的例子可以重写为

```
my $tx = $t->ua->build_json_tx('/user/99' => {name => 'sri'});
$tx->req->method('PUT');
$t->request_ok($tx)
  ->status_is(200)
  ->json_is('/message' => 'User has been replaced.'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T18:22:10.163

你能分享你的'this/is/url/to/resource'路线的定义吗？服务器返回 400，因此您的应用程序中的 Mojo::Controller 似乎不了解您发送的内容...

# excel - 应用程序定义或对象定义错误 - Excel VBA

> ID：13829094
> 
> 赞同：1
> 
> 时间：2012-12-11T21:51:24.233
> 
> 标签：excel, vba

以下代码在粗体线上给了我一个应用程序定义或对象定义的错误。我设定范围；但是，显然excel无法读取它。我不确定为什么会出现该错误。任何帮助深表感谢！谢谢。

```
Public Sub specialattention()
'Loop to check whether issue needs spcial attention
Dim n As Variant
Dim nend As Range
Dim nrng As Range
Dim nnow As Date
Dim ninterval As Integer
ninterval = Sheets("Ranges").Range("AB3").Value
nnow = Sheets("Issues Database").Range("N5").Value
Set nend = Sheets("Issues Database").Range("M1048576").End(xlUp)
Set nrng = Sheets("Issues Database").Range("M6", nend)
For Each n In nrng
    If n.Value = "1" And nnow - n.Offset(0, 1).Value >= ninterval Then
        n.Offset(0, 2).Value = "1"
    Else
        n.Offset(0, 2).Value = "0"
    End If
    'Color Cells that need special attention
    If n.Offset(0, 2).Value = "1" Then
            Dim xrng1 As Range
            Dim xrng2 As Range
            Set xrng1 = n.Offset(0, -11)
            Set xrng2 = n.Offset(0, -1)
            **Sheets("Issues Database").Range(xrng1, xrng2).Interior.ColorIndex = 19**
        Else
            Dim xrng3 As Range
            Dim xrng4 As Range
            Set xrng3 = n.Offset(0, -11)
            Set xrng4 = n.Offset(0, -1)
            **Sheets("Issues Database").Range(xrng2, xrng3).Interior.ColorIndex = 2**
        End If
    Next
    End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:20:38.173

只要传递给 .Range 的范围是有效范围，您的代码就应该可以工作。

根据您的代码，第一个实例：

`Sheets("Issues Database").Range(xrng1, xrng2).Interior.ColorIndex = 19` 应该没事。

但是，您的第二个实例：

`Sheets("Issues Database").Range(xrng2, xrng3).Interior.ColorIndex = 2`正在引用不在范围内的范围，因为您正在重用`xrng2`在不同逻辑路径中定义的范围。

可以将您的第二个问题行更新为此：

`Sheets("Issues Database").Range(xrng3, xrng4).Interior.ColorIndex = 2`会给你你预期的行为。

# colors - JPEG 压缩是否确保文件中只有源颜色？

> ID：13829095
> 
> 赞同：3
> 
> 时间：2012-12-11T21:51:28.757
> 
> 标签：colors, compression, jpeg

如果我的图像中的色域受到限制（以遵守 CMYK 色域），是否将我的文件保存为 JPEG 确保不会将新颜色引入保存的文件中？由于 JPEG 是有损的，而且有时看起来像是在压缩中使用了混合颜色，我担心可能会引入色域外的颜色。或者压缩中使用的颜色是否仅限于被压缩源的调色板？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T21:56:28.200

不，这不能保证。“有损”压缩的一个方面是可以在解压缩时以不同于源的方式恢复颜色。如果您想要精确的色彩再现，则需要使用无损格式（例如 PNG）。

# iphone - 将 NSDefaults 字符串添加到 InAppSettingsKit

> ID：13829099
> 
> 赞同：0
> 
> 时间：2012-12-11T21:52:03.810
> 
> 标签：iphone, ios, inappsettingskit

我希望能够更改Settings.bundle`DefaultValue`中的一个单元格。`UITableView`我主要是想把这个...

`userEmail = [defaults objectForKey:@"username"];`

...进入 plist。

我这样做是因为我希望我的应用程序在设置中显示用户的电子邮件，以便他们知道他们正在使用什么帐户。

这是我想要更改的部分 plist 数据。

```
<dict>
            <key>IASKTextAlignment</key>
            <string>IASKUITextAlignmentRight</string>
            <key>DefaultValue</key>
            <string>EMAIL</string>
            <key>Key</key>
            <string>email</string>
            <key>Title</key>
            <string>Email</string>
            <key>Type</key>
            <string>PSTitleValueSpecifier</string>
        </dict> 
```

我该怎么做？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T08:39:03.757

您不能动态更改 Settings.bundle 中的 plist，因为它属于只读（就沙盒而言）应用程序包。

您可能想要做的是在您的启动过程中或其他地方修改当前`[[NSUserDefaults standardUserDefaults] setObject:@"the username" forKey:@"username"]`值`-application:didFinishLaunchingWithOptions:`。

然后更改将反映在 IASK 和系统设置中。

# mongodb - db 输出中的 max 字段是什么意思？ .stats()?

> ID：13829103
> 
> 赞同：2
> 
> 时间：2012-12-11T21:52:12.767
> 
> 标签：mongodb

我正在查看的输出，`db.system.profile.stats()`我很好奇该`max`字段在返回的文档中的含义（运行 mongodb 2.2.2）。

这是一个例子：

```
> db.system.profile.stats()
{
    "ns" : "mydb.system.profile",
    "count" : 2476,
    "size" : 1012284,
    "avgObjSize" : 408.83844911147014,
    "storageSize" : 1052672,
    "numExtents" : 2,
    "nindexes" : 0,
    "lastExtentSize" : 4096,
    "paddingFactor" : 1,
    "systemFlags" : 0,
    "userFlags" : 0,
    "totalIndexSize" : 0,
    "indexSizes" : {

    },
    "capped" : true,
    "max" : 2147483647,
    "ok" : 1
} 
```

db.collection.stats()`max`的[官方 mongodb 文档](http://docs.mongodb.org/manual/reference/collection-statistics/)中没有提及。

也许这与`system.profile`封顶系列有关。尽管 max 绝对不是上限集合的最大大小，因为 (1)`max`显示的是一个巨大的数字，并且 (2) 我的集合不会超过 2500 个左右的文档，并且总大小远小于这个。

有什么想法吗？

谢谢，凯文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T21:59:19.217

`max`是上限集合的可选设置，它也限制集合中的文档*数量*，而不仅仅是限制字节数 ( `size`)。

[请参阅此处](http://docs.mongodb.org/manual/reference/javascript/#db.createCollection)的文档。

# asp.net - 动态添加水印文本到图像而不将图像保存到服务器

> ID：13829106
> 
> 赞同：0
> 
> 时间：2012-12-11T21:52:21.160
> 
> 标签：asp.net, image, watermark

我在我的服务器上的这个文件夹中有一张图片：\images\freemedia\largethumbs\test.png

在我的 default.aspx 页面上，我有一个图像控件：

```
<asp:Image ID="Image1" runat="server" /> 
```

当访问者请求default.aspx页面时，我想从服务器获取test.png图像，在右下角添加水印文本“hello world”。我不想将带水印的图像保存到服务器，因为我想节省存储空间并且仍然想访问原始图像。从显示给访问者的图像中，他最好不能推导出原始文件名，因此不应允许他看到原始文件名是 test.png。

我在 Google 上搜索了很多，但所有示例都将带水印的图像保存到磁盘，这是我不想要的。

我已经有一个httphandler：

```
Public Class pichandler : Implements IHttpHandler

Public Sub ProcessRequest(ByVal context As HttpContext) Implements IHttpHandler.ProcessRequest
    Dim data As Byte()
    Dim fName As String 

    Using w As New generaltablesTableAdapters.freemediaTableAdapter
        fName = w.GetDataById(i)(0).medialink.ToString
    End Using
    data = My.Computer.FileSystem.ReadAllBytes(context.Server.MapPath("~/images/freemedia/thumbs/" & fName))

    ' --> how can I add a watermark text to the image here?!?!?!?

    context.Response.ContentType = "image/jpeg"
    context.Response.BinaryWrite(data)
End Sub

End Class 
```

有没有人有关于如何做到这一点的代码示例？

如果有另一种方法可以做到这一点，那也很好。但请展示我如何将带水印的图像作为最终 HTML 的一部分提供。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:28:05.730

由于您使用的是 asp.net，因此您不妨使用[HttpHandler](http://msdn.microsoft.com/en-us/library/system.web.ihttphandler.aspx)。

这是一个示例，创建一个新的通用处理程序，我们将其命名为**ImageHandler**，代码可以像这样简单：

```
public class ImageHandler : IHttpHandler
{
    public void ProcessRequest(HttpContext context)
    {
        // Clear response and set content type to image.
        context.Response.Clear();
        context.Response.ContentType = "image/jpeg";

        // Create your image, however you want it. Server.MapPath and so on.
        var image = Bitmap.FromFile(@"C:\Images\image.jpg");

        // And save it to the OutputStream.
        image.Save(context.Response.OutputStream, ImageFormat.Jpeg);
    }

    public bool IsReusable
    {
        get { return false; }
    }
} 
```

然后像这样使用它：

```
<asp:Image ID="Image1" ImageUrl="~/ImageHandler.ashx" runat="server" /> 
```

当然你也可以像这样发送一些*QueryString*参数：

```
<asp:Image ID="Image1" ImageUrl="~/ImageHandler.ashx?filename=myimage.jpg" runat="server" /> 
```

然后只需`context.Request.QueryString["filename"]`在 ImageHandler 中使用。

* * *

**更新：**

在评论之后，这是添加水印的方法：

```
Public Sub ProcessRequest(ByVal context As HttpContext) Implements IHttpHandler.ProcessRequest
    Dim watermarkText As String = "Copyright"
    Dim fName As String 

    Using w As New TopTrouwen.generaltablesTableAdapters.freemediaTableAdapter
        fName = w.GetDataById(i)(0).medialink.ToString
    End Using

    ' Create image directly from the path
    Dim image = Drawing.Image.FromFile(context.Server.MapPath("~/images/freemedia/thumbs/" & fName))
    Dim font As New Font("Tahoma", 16, FontStyle.Regular, GraphicsUnit.Pixel)

    'Adds a transparent watermark 
    Dim color As Color = Drawing.Color.FromArgb(50, 0, 0, 0)
    Dim brush As New SolidBrush(color)
    Dim gr As Graphics = Graphics.FromImage(image)

    ' Measure the watermark text so we can offset it's width and height
    Dim watermarkSize = gr.MeasureString(watermarkText, font)

    ' Create the point where the watermark text should be printed
    Dim point As New Point(image.Width - watermarkSize.Width, image.Height - watermarkSize.Height)

    gr.DrawString(watermarkText, font, brush, point)
    gr.Dispose()

    context.Response.ContentType = "image/jpeg"
    image.Save(context.Response.OutputStream, ImageFormat.Jpeg)
End Sub 
```

# mysql - MySQL：在 JOIN 语句中使用 NULL 作为通配符

> ID：13829110
> 
> 赞同：2
> 
> 时间：2012-12-11T21:52:42.480
> 
> 标签：mysql, sql, null, inner-join

我有一个包含完美定义的项目的表和第二个表，其中可能包含模糊/贪婪的订单，因为 NULL 需要此参数的所有可用值。

```
items
+-----------------------+
| item_id | color | size |
|---------+-------+------|
|    1    |  blue |    8 |
|    2    |   red |    6 |
|    3    | green |    7 |
|    4    | black |    6 |
+------------------------+

orders
+-------------------------+
| order_id | color | size |
|----------+-------+------|
|     1    |   red |    6 |
|     2    | green |    8 |
|     3    |  NULL |    6 |
|     4    |  blue | NULL |
|     5    |  NULL | NULL |
+-------------------------+ 
```

是否有一种有效的方法来生成填写所有订单所需的完整项目列表？

```
+--------------------+
| order_id | item_id |
|----------+---------|
|     1    |    2    |
|     3    |    2    |
|     3    |    4    |
|     4    |    1    |
|     5    |    1    |
|     5    |    2    |
|     5    |    3    |
|     5    |    4    |
+--------------------+ 
```

在我看来，一个 INNER JOIN 应该能够做到这一点，但这样的事情显然不考虑 NULL 值作为*订单*表中的贪婪通配符的可能性：

```
SELECT order_id, item_id
FROM orders
INNER JOIN items ON orders.color = items.color AND orders.size = items.size 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T21:56:52.567

尝试以下操作：

```
SELECT order_id, item_id
FROM orders
INNER JOIN items ON (orders.color IS NULL OR orders.color = items.color)
    AND (orders.size IS NULL OR orders.size = items.size) 
```

让我知道这是否有帮助，或者我是否误解了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T22:12:34.207

如果您重写条件，`JOIN`您可以获得所需的结果：

```
SELECT order_id, item_id
FROM orders
JOIN items
    ON ((orders.color = items.color OR orders.color IS NULL)
        AND (orders.size = items.size OR orders.size IS NULL)) 
```

但是，orders 表应该看起来更像这个查询的结果，而不是当前的 orders 表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T22:13:16.810

您可以为此使用该`IFNULL`功能：

```
SELECT order_id, item_id
  FROM orders
  JOIN items ON IFNULL(orders.color, items.color) = items.color
            AND IFNULL(orders.size, items.size) = items.size 
```

如果 orders 中的值为 null，那么它将使用 items 中的值（因此匹配）。

# .htaccess - htaccess RewriteRule 图像文件夹

> ID：13829112
> 
> 赞同：1
> 
> 时间：2012-12-11T21:52:50.160
> 
> 标签：.htaccess, mod-rewrite

现在我在我的 .htaccess 中使用这个代码

```
RewriteRule   /images(.*)  /images/$1
RewriteRule   /css(.*)  /css/$1
RewriteRule   /js(.*)  /js/$1 
```

但是当我添加了一些使用相同文件夹但不在根文件夹但在其子文件夹上的第三方插件时出现问题，所以我现在需要更改它，使其仅适用于文件夹 /images/ 而不适用于示例 /plugins/myplugin/templates/images/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:50:45.473

尝试合并`^`表示字符串开头的正则表达式符号：

```
RewriteRule   ^/?images(.*)  /images/$1
RewriteRule   ^/?css(.*)  /css/$1
RewriteRule   ^/?js(.*)  /js/$1 
```

现在这些将仅匹配 URL，例如：

```
http://mysite.com/imagessomething.jpg
http://mysite.com/csssomething.css
http://mysite.com/jssomething.js 
```

但不是当它们在子文件夹中时。

# facebook - 洞察力 -> 用户 -> 用户趋势上显示的内容

> ID：13829115
> 
> 赞同：5
> 
> 时间：2012-12-11T21:53:04.030
> 
> 标签：facebook, api, facebook-fql

我希望 API 调用返回与用户下的洞察页面上的每日新用户的用户趋势图中显示的完全相同的数据。我无法弄清楚显示的是哪个指标，因为明显的选择（application_installation_adds 或 application_installation_adds_unique）返回的值根本与该图不匹配。请让我知道是否可以查看生成该图表的数据的位置。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-18T23:45:56.537

在当前版本的[Platform Insights](https://developers.facebook.com/docs/platforminsights)中，大多数图表的角落都有一个带有一些选项的小选择器，其中一个选项是向您显示用于生成该图表的 API 调用（尽管您需要使用自己的访问令牌）。

API 调用都记录在这里：[https ://developers.facebook.com/docs/graph-api/reference/app/app_insights](https://developers.facebook.com/docs/graph-api/reference/app/app_insights)

这是一个显示在前端的示例以及 Active Login Users 指标的相应 API 调用：

![平台洞察图](../Images/c724f70cfdf348c4b9a176be5fd31230.png)

“API 示例”打开此对话框： ![API 示例的屏幕截图](../Images/c2123b27da21952ac90e804cc3863989.png)

[特别是对于新用户， App Insights API](https://developers.facebook.com/docs/graph-api/reference/app/app_insights)中指标的当前名称称为`initial_permission_grants`

示例调用：

```
https://graph.facebook.com/v2.2/<APP ID>/app_insights?metric_key=initial_permission_grants 
```

示例响应 [部分]：

```
{
  "data": [
    {
      "time": "2014-12-12T08:00:00+0000", 
      "value": "0"
    }, 
    {
      "time": "2014-12-13T08:00:00+0000", 
      "value": "0"
    }, 
    {
      "time": "2014-12-14T08:00:00+0000", 
      "value": "0"
    }, 
    {
      "time": "2014-12-15T08:00:00+0000", 
      "value": "1"
    }, 
    {
      "time": "2014-12-16T08:00:00+0000", 
      "value": "0"
    }, 
    {
      "time": "2014-12-17T08:00:00+0000", 
      "value": "0"
    }, 
    {
      "time": "2014-12-18T08:00:00+0000", 
      "value": "0"
    }
  ]
} 
```

进行 API 调用时来自 Insights 的相应图表： ![在此处输入图像描述](../Images/8c884d152bc6a25503463ce368cd43b2.png)

# c# - 如何计算特定操作（预定义函数）需要完成的时间？

> ID：13829116
> 
> 赞同：2
> 
> 时间：2012-12-11T21:53:04.220
> 
> 标签：c#, time, progress-bar

我一直想知道所有具有进度条的程序如何几乎准确地知道完成操作（以及程序工作的整个处理）所需的时间，从而能够将其与进度条进行映射。

在 C# 中，我在处理进度条时总是会遇到困难。我得出的结论是，没有通用的解决方案，是吗？

我不是在问这个：

“例如：你怎么知道`File.ReadAllBytes(path)`读取一个文件需要多少时间？简单，在它之前启动一个秒表，然后停止并读取它之后的时间。但这只是在你的计算机上，在你的 CPU 上，在你的磁盘上！- 1MB的读数会和你的机器和其他的大多不同”

我在问我怎么知道一件事在进入它之前需要多长时间才能完成？我的意思是，我必须知道在执行之前需要多少时间`File.ReadAllBytes()`，以便进度条可以在方法执行期间相应地步进。

一种愚蠢的做法是做两次！开始运行，计算时间，然后再次运行，但这次你踩了进度条（lol）

我不知道复杂性是否与此有关。我在编写自己的方法和函数时使用 big-O，而不是在处理预定义函数时。

编辑：只是一个例子：我制作了一个异或文件并用异或形式覆盖它的程序。现在这涉及 1-将文件的字节读取到字节数组。对它们进行 2 异或运算。3-将它们再次写回文件。现在如果我想使用进度条，我怎样才能知道这些操作需要多少时间，以便我可以相应地增加进度条？

我对此的解决方案是使用一个全局变量（如 prgBar），将 XORing 分配给一个单独的线程，并且每次我从我从文件中读取的字节数组中异或一个字节时，在该线程中递增“prgBar”，然后在主线程中，我使用了一个计时器，我所做的每个滴答声：`prgressBar.Value = prgBar` 我遇到了这个问题，它甚至不准确，它可能开始晚了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:03:54.773

您所描述的是[停机问题](http://en.wikipedia.org/wiki/Halting_problem)。长话短说，您无法判断任意过程何时结束，但您可以进行猜测。

例如，假设您有 1MB 需要传输。如果一次传输一个字节，然后在每个字节之后更新进度条，那么它看起来会很流畅。还可以显示基于过去的时间估计。例如，如果我花了 1 秒来移动 1MB 的 10%，那么我应该在 9 秒内完成。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T22:29:27.230

快速的回答是“他们没有”。你有没有见过在 20 秒内从“还剩 20 分钟”跳到“还剩 5 分钟”的进度条？还是那些说“还剩0:00”然后就坐在那里的人？

* * *

更好的答案是“他们估计”。我能想到的有两种形式，但我没有做任何广泛的研究。不过，他们都使用过去的表现来估计未来的进展。

第一种形式适用于一系列具有相似复杂性但任意长度的离散任务，例如文件复制/删除。您从一个较低的基本估计或“正在计算...”消息开始，然后在每个文件完成后，您根据复制/删除所有文件所需的时间重新估计需要多长时间，因此远的。例如，如果你要删除 2000 个文件，而前 5`{400, 200, 900, 100, 400 ms}`个文件在向您的用户显示“还剩 13 分钟”（798 秒）的进度条。它可能不准确，但如果你每隔几个文件就不断地修改它，它会进展得相当顺利。

第二种形式是任务的长度及其复杂性已知（并且变化很大），但速度仍然未知，例如使用安装程序。在这种情况下，您可以通过在测试中多次运行安装程序并弄清楚不同组件的时间之间的关系来做出估计。这可能像比较各个步骤以得出公式一样复杂，或者像仅将安装时间百分比分配给每个阶段一样简单。然后，当用户进行安装时，您知道前 2% 的组件需要 X 秒的持续时间，因此估计还剩 50*X 秒。这就是为什么安装人员似乎经常徘徊或跳来跳去的原因 - 他们正在等待比平时花费更长的时间，或者他们发现他们不需要在您的系统上执行步骤。

* * *

最后，这只是一个估计。百分比可能很难（“我在第 1/5 步，所以显示完成了 20%”），但持续时间永远不可能。有关这背后的理论，请参阅 Jbecwar 的回答。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T22:07:32.357

您必须自己计算操作的完整性，并且并不总是可以准确地完成。要读取文件，您可以执行诸如获取行数，计算您已阅读的行数，然后执行当前/总计以显示进度之类的操作。对于更复杂的操作，这实际上效果更好。

假设您有一个包含 1000 个对象的数组，需要处理这些对象的数据。您在 for 循环中执行此操作，因此进度条可以简单地显示`i/array.length`. 该`ReadAllBytes`示例不好，因为无法获取该任务的进度。.NET 方法将返回所有字节，因此您只能知道任务何时开始和完成，更不用说任务会如此之快以至于不需要进度条。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-12T03:09:17.347

实际上，您应该分批读取文件（例如，每次 20KB），这样您就可以在每批之后增加进度条

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-11T22:02:09.877

您是对的，除非您考虑将进度条用作“我仍在处理”栏，否则进度条没有万能的。可以让进度条一遍又一遍地从 0 更新到 100（最大值）。

有时您会知道自己的进展情况，并可以将其报告给用户。

让我们举个`File.ReadAllBytes(path)`例子：

您应该能够获得文件的大小。您还可以通过递增变量来确定到目前为止已读取的字节数。通过做一些简单的数学运算，您可以使用 bytesRead/bytesInFile 来获得完成的百分比。通过每 500 毫秒计时一次的计时器将此情况报告给用户，您应该会看到带有适当反馈的进度条。

# r - 如何为点添加颜色以表示另一个变量的值

> ID：13829127
> 
> 赞同：1
> 
> 时间：2012-12-11T21:53:48.927
> 
> 标签：r, colors, maps, points

```
library(maps)
map("state","California")
points(map$x,map$y) 
```

我使用上面的命令创建了一个地图，其中包含代表房屋位置的点。如何在地图上的这些点上添加颜色以表示另一个变量 Z 的值（例如代表房屋价值）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T22:34:36.243

```
library(maps)
map("state","California") 
```

做一些测试数据。我已将数据名称从更改为`map`，`mappts`因此它不会与基本功能发生冲突。将数据命名为与函数相同的名称并不是一个好主意。

```
dput(mappts)
structure(list(x = c(-121.837504273717, -119.288648121568, -116.37566966197
), y = c(40.0189660554, 36.8188807085794, 34.5400320525101)), .Names = c("x", 
"y"), row.names = c(NA, -3L), class = "data.frame")
mappts$z <- c(1,2,3)

> mappts
          x        y
1 -121.8375 40.01897
2 -119.2886 36.81888
3 -116.3757 34.54003 
```

添加一`z`列

```
mappts$z <- c(1,2,3)
points(mappts,col=mappts$z,pch=19) 
```

![带我去天堂城吧](../Images/eb648614d795f7357537d7d6f4ae7f6f.png)

如果您的`z`列没有整齐地分组，您可能需要先重新编码。

如果您想手动指定颜色，可以`palette`通过以下方式进行编辑：

```
palette(c("blue","pink","green")) 
```

...然后您可以使用以下方法重置：

```
palette("default") 
```

# php - Sdk Glacier php超时

> ID：13829130
> 
> 赞同：0
> 
> 时间：2012-12-11T21:53:58.637
> 
> 标签：php, amazon-web-services, amazon-glacier

在播放了一些小测试文件后，我想上传一个更大的文件，大约 200 MB，但我总是遇到超时异常，然后我尝试上传一个 30 MB 的文件，同样的情况发生了。我认为超时是30秒，可以告诉冰川客户端等到上传完成吗？

这是我使用的代码：

```
$glacier->uploadArchive(array(
            'vaultName'          => $vaultName,
            'archiveDescription' => $desc
            'body'               => $body
        )); 
```

我用其他文件测试过，同样的情况，然后我尝试了一个4MB的小文件，操作成功，我以为分割文件并一个一个上传，然后又在第三个左右出现超时异常出去。

我还尝试使用以下代码进行多重上传

```
$glacier = GlacierClient::factory(array(
            'key'    => 'key',
            'secret' => 'secret',
            'region' => Region::US_WEST_2
        ));

$multiupload = $glacier->initiateMultipartUpload(array(
    'vaultName' => 'vaultName',
    'partSize' => '4194304'
));

// An array for the suffixes of the tar file
foreach($suffixes as $suffix){
$contents = file_get_contents('file.tar.gz'.$suffix);
$glacier->uploadMultipartPart(array(
    'vaultName' => 'vaultName',
    'uploadId' => $multiupload->get('uploadId'),
    'body' => $contents
));
}

$result=$glacier->completeMultipartUpload(array(
    'vaultName' => 'vaultName',
    'uploadId' => $multiupload->get('uploadId'),
));

echo $result->get('archiveId'); 
```

它错过了参数范围，我不认为我完全理解这个多部分上传是如何工作的，但我认为我会遇到同样的超时异常。所以我的问题就像我之前所说的那样。可以告诉冰川客户端等到上传完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-22T23:58:53.140

超时听起来像 Jimzie 所说的脚本超时。

至于使用 Glacier 客户端，您应该查看[官方 AWS PHP 开发人员博客中的这篇博文](http://blogs.aws.amazon.com/php/post/Tx7PFHT4OJRJ42/Uploading-Archives-to-Amazon-Glacier-from-PHP)`UploadPartGenerator`，其中展示了如何使用该对象向 Glacier 进行分段上传。如果您在不同的请求/进程中进行部分上传，您还应该记住`UploadPartGenerator`该类可以序列化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T16:44:12.530

这听起来有点像脚本超时。尝试

```
set_time_limit (120); 
```

就在 foreach 循环内部。这将为您的每个多部分文件提供两分钟的 PHP 健全计时器。

# php - json 消息中返回的值与数据库中存储的值不同

> ID：13829132
> 
> 赞同：0
> 
> 时间：2012-12-11T21:54:11.627
> 
> 标签：php, android, google-maps

我的应用程序在数据库中为用户存储了一些经纬度，这些用于查询 Maps Api。问题是我没有从 api 得到预期的结果。

来自 Api 的 json 响应在某些部分包括用户的 lat/lng。我注意到的是，json 中的 lat/lng 与存储在我的数据库中的不同。例如：这些到我数据库中的条目：21.7694003 39.5593724 在json消息中返回如下：21.75072 39.53207

这对我来说是一个主要问题，因为我正在尝试使用谷歌方向 api 来获取两点之间的距离，而我得到的结果是错误的。

我在php中使用了file_get_contents()方法，我使用的url是这样的：

```
$url= 'http://maps.googleapis.com/maps/api/directions/json?origin='.$nlatend.','.$nlonend.'&destination='.$olatend.','.$olonend.'&region=gr&sensor=false&mode=walking'; 
```

其中 $nlonend、$nlatend 等是包含 lng/lng 坐标的变量。

谷歌可能会四舍五入这些坐标，标准程序，并且我的问题是由其他原因引起的，但我认为这是它的根源。如果有人可以提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:49:13.583

纬度和经度的小数点后 5 位等于赤道处大约 10 米。随着纬度向两极移动，经度值变小（60° 时为 5.57 米） 。参见[**Wiki**](http://en.wikipedia.org/wiki/Wikipedia%3aWikiProject_Geographical_coordinates#Precision)。

这几乎与[**GPS**](http://wiki.xkcd.com/geohashing/GPS_accuracy) 系统一样准确。

谷歌地图[**地理编码**](https://developers.google.com/maps/documentation/geocoding/#Results)结果的精度为小数点后 7 位。（赤道 10 厘米）

如果您要求精确到小数点后 7 位。您需要将相关代码作为**编辑**发布到您的问题。

# ruby-on-rails - 不要使用carrierwave和unicorn在生产中安装'fog' gem

> ID：13829133
> 
> 赞同：0
> 
> 时间：2012-12-11T21:54:12.033
> 
> 标签：ruby-on-rails, carrierwave, unicorn, fog

我正在尝试将 Fog 与 Carrierwave 一起使用，并且在 Unicorn 日志中收到此错误。我的 gemfile 和 NodeImageUploader 调用中有雾

```
storage :fog 
```

**宝石文件**

```
source 'http://rubygems.org'

gem 'rails', '3.2.8'
gem 'bcrypt-ruby', '3.0.1'
gem 'jquery-rails'
gem 'fog', '1.8.0'
gem 'bootstrap-sass', '~> 2.2.1.1'
gem 'devise'
gem 'omniauth-facebook'
gem 'rails-backbone'
gem 'simple_form'
# gem 'newrelic_rpm'
# gem 'client_side_validations'
gem 'inherited_resources'
gem 'friendly_id', '~> 4.0.1'
gem 'carrierwave'
gem 'activeadmin'
gem 'meta_search', '>= 1.1.0.pre'
gem 'will_paginate'
gem 'bootstrap-will_paginate'
gem 'faker', '1.0.1'
gem 'rack-contrib'
gem 'soulmate', :git => "git://github.com/allotrop/soulmate.git", :require => 'soulmate/server'
gem 'httparty'
gem 'mini_magick'
gem 'mime-types'
gem 'redis'
gem 'pg', '0.12.2'
gem 'nokogiri', '1.5.5'
# gem "rmagick"

group :development, :test  do 
  gem 'rspec-rails', '2.11.0'
  gem 'guard-rspec', '0.5.5'
end

group :development do
  gem 'annotate', ">=2.5.0"
  #gem 'open-uri'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  # gem 'therubyracer', :platform => :ruby
  gem 'uglifier', '>= 1.0.3'
end

group :test do
  gem 'capybara', '1.1.2'
  gem 'guard-spork', '0.3.2'
  gem 'spork', '0.9.0'
  gem 'factory_girl_rails', '1.4.0'
  gem 'rb-inotify', '0.8.8'
  gem 'libnotify', '0.5.9'
  gem 'database_cleaner', '0.7.0'
  gem 'email_spec'
end

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
gem 'unicorn'

# Deploy with Capistrano
gem 'capistrano'

# To use debugger
 gem 'debugger', group: [:development, :test]
# gem 'rubber'
# gem 'open4' 
```

**配置/carrierwave.rb**

```
CarrierWave.configure do |config|
config.fog_credentials = {

 :aws_access_key_id => 'xxxx'
 :aws_secret_access_key => 'yyyy'
 :provider => 'AWS'
}
config.fog_directory = 'example-uploads'
config.fog_public = true
end 
```

做`bundle show fog`给我 `/home/deployer/apps/allotrop/shared/bundle/ruby/1.9.1/gems/fog-1.3.1`

此外，我可以`remote_image_url`在生产的 rake 任务中使用 Carrierwave 的方法，以成功将图像保存到 S3。但是，当我尝试获取我的应用程序的任何页面时，我会收到此错误。

**独角兽日志**

```
 E, [2012-12-11T20:49:28.872957 #23518] ERROR -- : You don't have the 'fog' gem installed (RuntimeError)
/home/deployer/apps/allotrop/shared/bundle/ruby/1.9.1/gems/carrierwave-0.7.1/lib/carrierwave/uploader/configuration.rb:73:in `eval'
/home/deployer/apps/allotrop/shared/bundle/ruby/1.9.1/gems/carrierwave-0.7.1/lib/carrierwave/storage/fog.rb:3:in `<top (required)>'
 (eval):1:in `storage'
/home/deployer/apps/allotrop/shared/bundle/ruby/1.9.1/gems/carrierwave-0.7.1/lib/carrierwave/uploader/configuration.rb:73:in `eval'
/home/deployer/apps/allotrop/shared/bundle/ruby/1.9.1/gems/carrierwave-0.7.1/lib/carrierwave/uploader/configuration.rb:73:in `storage'
/home/deployer/apps/allotrop/releases/20121211204621/app/uploaders/node_image_uploader.rb:24:in `<class:NodeImageUploader>'
/home/deployer/apps/allotrop/releases/20121211204621/app/uploaders/node_image_uploader.rb:5:in `<top (required)>'
/home/deployer/apps/allotrop/shared/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
/home/deployer/apps/allotrop/shared/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in requi>
/home/deployer/apps/allotrop/shared/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependenc>
/home/deployer/apps/allotrop/shared/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
/home/deployer/apps/allotrop/shared/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:359:in `require_or_loa>
/home/deployer/apps/allotrop/shared/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:502:in `load_mis 
```

如果我将上传器切换到`storage :file`甚至`storage :fog`在开发中使用时，该应用程序也可以正常工作。我哪里错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T14:33:07.913

在尝试在一天的大部分时间里解决这个问题之后，我按照[Ryan Bates 的 Railscasts 零停机部署一集](http://railscasts.com/episodes/373-zero-downtime-deployment)的步骤解决了这个问题。他提到的更改是`preload_app`在您的独角兽模板中添加并使用 USR2 信号来重启独角兽。

**独角兽变种erb**

```
# Load rails+github.git into the master before forking workers
# for super-fast worker spawn times
preload_app true

before_fork do |server, worker|

  # Disconnect since the database connection will not carry over
  if defined? ActiveRecord::Base
    ActiveRecord::Base.connection.disconnect!
  end

  ##
  # When sent a USR2, Unicorn will suffix its pidfile with .oldbin and
  # immediately start loading up a new version of itself (loaded with a new
  # version of our app). When this new Unicorn is completely loaded
  # it will begin spawning workers. The first worker spawned will check to
  # see if an .oldbin pidfile exists. If so, this means we've just booted up
  # a new Unicorn and need to tell the old one that it can now die. To do so
  # we send it a QUIT.
  #
  # Using this method we get 0 downtime deploys.

  old_pid = "#{server.config[:pid]}.oldbin"
  if File.exists?(old_pid) && server.pid != old_pid
    begin
      Process.kill("QUIT", File.read(old_pid).to_i)
    rescue Errno::ENOENT, Errno::ESRCH
      # someone else did our job for us
    end
  end
end

after_fork do |server, worker|
  ##
  # Unicorn master loads the app then forks off workers - because of the way
  # Unix forking works, we need to make sure we aren't using any of the parent's
  # sockets, e.g. db connection
  # Start up the database connection again in the worker

  if defined?(ActiveRecord::Base)
    ActiveRecord::Base.establish_connection
  end

  # Redis and Memcached would go here but their connections are established
  # on demand, so the master never opens a socket
end 
```

**unicorn_init.erb**

```
restart|reload)
  sig USR2 && echo reloaded OK && exit 0
  echo >&2 "Couldn't reload, starting '$CMD' instead"
  run "$CMD"
  ;; 
```

然后你需要运行`cap:unicorn:setup unicorn:stop unicorn:start`. 如果有人遇到此问题，我强烈建议您查看有关[Capistrano 食谱](http://railscasts.com/episodes/337-capistrano-recipes)和[零停机时间部署](http://railscasts.com/episodes/373-zero-downtime-deployment)的 Railscasts 。

# c# - 如何在不违反 MVVM 约定的情况下调用 3rd 方控件上的方法？

> ID：13829136
> 
> 赞同：1
> 
> 时间：2012-12-11T21:54:20.053
> 
> 标签：c#, mvvm, telerik, mvvm-light, windows-phone-8

我的具体问题是尝试从我的 ViewModel 执行 Telerik DataBoundListBox 方法 StopPullToRefreshLoading(true)。困难在于我不想通过将应用程序逻辑放在后面的代码中来打破 MVVM 约定。

我对 MVVM 比较陌生，我不确定与视图控件上的方法交互的正确约定是什么。我已经对该主题进行了多次搜索，但尚未找到可以应用于我的情况的解决方案。我怀疑我可能已经找到了答案，但我没有得出正确的结论。

这似乎是第 3 方控制的常见情况，但也许我只是没有以正确的方式考虑这个问题。

我正在使用 MVVM Light 构建我的第一个 Windows 8 Phone 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T23:09:31.743

很多人都非常纠结，认为在关注 MVVM 时，你不能在后面的代码中包含代码！！！事实并非如此，像 MVVM 这样的设计模式可以使代码更易于维护。如果某些内容仅与 UI 直接相关并且不关心 viewmodel 类中的信息，那么一定要把它放在后面的代码中。当我使用第三部分控件时，我遇到了同样的情况，有时没有其他选项比将代码放在后面的代码中更糟糕或更糟糕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T23:36:03.630

首先，我同意 Chris McCabe 的观点，设计模式是一个指导方针、一个框架、一个建议。它们不是生死攸关的规则。话虽如此，您应该能够在不将“真实”业务逻辑引入 UI 的情况下加入两者（VM/Telerik）。

第一种可能性是在控制器上使用事件。UI 可以订阅此事件以将调用转发到 Telerik 控件；但是，UI*不应*决定何时调用它。

```
class MyModel {
    public event EventHandler StopRefreshLoading;
}

class myForm : Form {

    public myForm(MyModel data)
    {
        data.StopRefereshLoading += (o, e) => this.CustomControl.StopPullToRefreshLoading(true);
        // ... etc
    } 
```

坦率地说，我更喜欢使用接口来处理这种类型的行为。然后控制器很容易强制实现更新到新的合同要求。缺点是接口在复杂的 UI 中可能变得过于冗长，从而难以为其编写测试。

```
interface IMyModelView {
    void StopRefreshLoading();
}

class myForm : Form, IMyModelView {

    void IMyModelView.StopRefreshLoading()
    {
        this.CustomControl.StopPullToRefreshLoading(true);
    } 
```

无论你往哪个方向走，都可能会出现一些违反 UI 设计模式的情况；然而，在现实世界中，严格遵守特定模式是没有意义的。这些模式有助于使代码更加可靠、可测试、灵活等等。决定你为什么使用一个模式，你将能够评估何时可以安全地违反该模式。

# java - 更新在 Azure 上的计算实例中运行的应用程序

> ID：13829137
> 
> 赞同：0
> 
> 时间：2012-12-11T21:54:21.533
> 
> 标签：java, scala, azure, playframework

我已经成功部署了一个使用 Play 运行 Scala 的 Web 应用程序！Windows Azure 计算实例上的框架。一切都很好。为此，我使用 Eclipse 插件来部署应用程序。

我的问题是如何处理应用程序的生命周期？当我想更新我的应用程序时，我应该怎么做？创建一个新的登台实例，从 Eclipse 部署它，然后进行切换？这听起来非常麻烦和缓慢，尤其是对于小补丁/改进。或者有没有办法只上传代码？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T04:14:53.180

我建议上传到登台，使用登台 URL 进行测试，然后交换 VIP。满意后，删除旧部署（现在处于暂存状态）。VIP 交换提供用户稳定性，并维持用户的会话，直到所有会话耗尽。

# paypal - Paypal Payments Pro API 密钥

> ID：13829142
> 
> 赞同：0
> 
> 时间：2012-12-11T21:54:49.413
> 
> 标签：paypal, api-key

我找不到我的 Paypal Payments Pro API 密钥的密钥在哪里。（我有一个 Pro 帐户）我需要进行**DirectPayment**，有人知道在哪里可以找到正确的密钥吗？

我在**“我的个人资料”>“我的销售费用”>“API 访问**”下知道这一点，上面 写着：“*管理 API 凭据以集成 PayPal Express Checkout。* ”

但这仅适用于**Express Checkout**而非**Direct Payment**。那是我用于直接付款的 API 信息吗？因为似乎我无法让它表现出来。我需要启用其他设置吗？

我不断收到的错误是：

```
Payment Error: This transaction cannot be processed due 
to an invalid merchant configuration. 
```

悬崖笔记：我已经让它在沙盒上工作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T00:03:12.907

我认为您会感到困惑（别担心，您不是唯一一个），因为 PayPal 最近更改了他们所有的术语。

它曾经被称为 Website Payments Pro，它使用了 DoDirectPayment 和 Express Checkout。这与他们多年前从 Verisign 收购的 PayFlow Gateway 完全不同。

现在，他们已经放弃了网站这个词，所以他们只称它为 Payments Pro，他们实际上是将人们放入 PayFlow Manager 系统而不是“旧”的 DoDirectPayment 系统。

从您在此处所说的内容来看，您实际上是在使用新的 Payments Pro 进行设置。这意味着您将使用 PayFlow 网关而不是 DoDirectPayment 来集成信用卡处理。PayFlow 使用您的 manager.paypal.com 凭据，而不是您正在寻找的标准 PayPal API 凭据。

然后，要添加 Express Checkout，您将按照您在此处看到的说明进行操作，这会生成您将用于这些 API 调用的标准样式（用户名、密码和签名）。

综上所述，从技术上讲，当您被批准使用新的 Payments Pro 时，您应该有权访问所有 API（PayFlow 和常规 PayPal），并且当您生成“用于 Express Checkout”的 API 凭证时，这些相同凭据应该（理论上）也适用于直接命中 PayPal 的任何其他 API。不过，我不能保证。

所以……你该怎么办？好吧，您需要切换到 PayFlow 网关进行集成，或者如果您只想使用 DoDirectPayment，则需要致电 PayPal 并请求他们将您的帐户从新的 Payments Pro 3.0 转换为旧的 Website Payments Pro 1.0 .

2.0 实际上被称为 Payments Pro PayFlow 版，这让事情变得更加混乱。

希望有帮助。

# arrays - Mac OS X 下 Fortran 中的虚拟内存管理

> ID：13829145
> 
> 赞同：1
> 
> 时间：2012-12-11T21:54:58.423
> 
> 标签：arrays, macos, memory-management, fortran, swap

我正在编写一个 Fortran 90 程序（使用 gfortran 编译）以在 Mac OS X 下运行。我有 13 个数据数组，每个数组包含大约 0.6 GB 的数据一次内存中的所有 13 个数组，我基本上是在尝试使用所有 8 GB，鉴于其他系统需求，我知道这是不可能的。所以我知道数组会被交换。我不知道的是操作系统如何管理它。尤其是，

当操作系统需要为其他数据结构腾出空间时，操作系统是否会换掉整个数据结构（例如数组），或者它是否更愿意逐页进行？也就是说，它是否根据数组的哪些部分最近最少访问来交换部分数组？

答案可能决定我如何组织数组。如果部分数组可以被换出，那么我可以将所有内容存储在一个巨大的数组中（通过索引来选择我需要的 13 个子数组中的哪一个）并相信操作系统可以有效地管理所有内容。否则，我可能会保留单独且不同的数组，每个数组都可以舒适地适应可用的物理内存。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:24:10.910

操作系统通常不会意识到用户内存中的结构（如数组）。我知道的大多数操作系统，包括 Mac OS X，都是逐页换出内存的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T11:27:48.373

尽管该过程通常被错误地称为*交换*，但在 x86 以及许多现代架构上，操作系统执行*分页*到仍然称为交换设备的东西（主要是由于历史原因）。每个进程的虚拟内存空间被划分为页和一个特殊的表，称为进程页表，它保存了虚拟内存中的页和物理内存中的帧之间的映射。每个页面可以被映射或不被映射。进一步的映射页面可以存在或不存在。访问未映射的页面会导致分段错误。访问不存在的页面会导致页面错误，这将由操作系统进一步处理 - 它从交换设备中获取页面并将其安装到物理内存中的帧中（如果有的话）。x86 和当今几乎所有其他广泛使用的架构上的标准页面大小为 4 KiB。此外，现代 MMU（内存管理单元，通常是 CPU 的组成部分）支持大页面（例如

因此，与您的数据结构相比，分页确实是细粒度的，并且通常对操作系统的执行方式有松散的控制或没有任何控制。尽管如此，大多数 Unices 允许您使用 C API 向内存管理器提供指令和提示，该 C API 可在`<sys/mman.h>`头文件中找到。有一些功能可以让您锁定内存的某个部分并防止操作系统将其分页到磁盘。有一些功能可以让您向操作系统提示某种内存访问模式是预期的，以便它可以优化进出页面的方式。您可以将这些与明确开发的数据结构结合起来，以实现对分页的一些控制并获得给定操作系统的最佳性能。

# java - 如何为每个键/上下文/客户创建一个对象的单个实例？

> ID：13829146
> 
> 赞同：0
> 
> 时间：2012-12-11T21:55:00.333
> 
> 标签：java, design-patterns

我需要创建一个类，其实例每个键/上下文/客户仅存在一次。

我不知道我是否过度思考问题和解决方案。任何建议或指导都会非常有帮助。下面显示的是我正在尝试做的一个简化示例。

为了使帖子保持较小，我删除了接口和抽象类。您应该能够编译此代码

我正在使用初始化时间来查找两个实例是相同还是不同。

**基类**

```
package com.SomeCompany2.ps.stackOverflow.question;

import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;

public class CheckClass{
    protected String intializationTime;

    public CheckClass(){
        setIntializationTime();
    }

    private void setIntializationTime() {
        final Date date = new Date();
        final DateFormat formatter = new SimpleDateFormat("HH:mm:ss:SSS");
        this.intializationTime = formatter.format(date);
    }

    public String getIntializationTime(){
        return this.intializationTime;
    }

    public boolean isMatch(){
        return false;
    }
} 
```

**确保只存在一个实例的类工厂。**

```
package com.SomeCompany2.ps.stackOverflow.question;

import java.util.HashMap;
import java.util.Map;

public class CheckClassFactory{
    private CheckClassFactory(){}

    private static class CheckClassHolder   {
        private static final Map<String, CheckClass> mapping    = new HashMap<String, CheckClass>();

        private static CheckClass getInstance(final String key){
            if (!mapping.containsKey(key)){
                final CheckClass INSTANCE   = new CheckClass();
                mapping.put(key, INSTANCE);
            }
            return mapping.get(key);
        }

        public static void removeInstance(final String key){
            mapping.remove(key);
        }
    }

    public static CheckClass getInstance(final String key){
        return CheckClassHolder.getInstance(key);
    }

    public static void removeInstance(final String key){
        CheckClassHolder.removeInstance(key);
    }
} 
```

我确实想到的问题之一是，当调用“removeInstance”并将实例从地图中删除时，实例会被销毁吗？

还有一种更简单的方法或已知的模式来完成这项任务吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:15:26.043

有几种方法可以改进。

您的工厂维护 [key, instance] 的映射就足够了，但`mapping`如果您有多个线程，您可能希望将访问包装在同步块中。

您不需要`initializationTime`查看它们是否不同 - 因为每个键只有一个实例，您可以使用默认值`equals`（或`==`），因为构造由工厂控制。

# objective-c - 使用最简单的方法将数据（字符串）从子 VC 传递到父 VC

> ID：13829151
> 
> 赞同：1
> 
> 时间：2012-12-11T21:55:20.587
> 
> 标签：objective-c, ios

使用最简单的方式将数据（字符串）从子视图控制器传递到父 VC。我尝试了几种方法，但迷路了，谁能告诉我最好的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T22:44:15.787

斯里坎特是正确的。如果你有一个从视图控制器（我们的“第一个”视图控制器）到另一个（我们的“第二个”视图控制器）的 segue，那么您需要做的就是在第二个视图控制器中创建一个指向第一个视图控制器的属性。您只需让第一个视图控制器确保在它执行转换之前设置该指针。完成后，第二个控制器可以更新属性或调用第一个控制器的方法。

有关详细信息，请参阅*View Controller Programming Guide*中的在[触发 Segue 时配置目标控制器](http://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/ManagingDataFlowBetweenViewControllers/ManagingDataFlowBetweenViewControllers.html#//apple_ref/doc/uid/TP40007457-CH8-SW4)以获取有关如何在第二个视图控制器中设置属性的信息（在这种情况下，该属性将是指向第一个控制器的弱指针）. 然后，正如 Srikanth 所说，第二个控制器可以使用该指针来更新第一个控制器中的属性。*`prepareForSegue`*

 *`weak`因此，在您的第二个视图控制器中，有一个指向第一个视图控制器的属性（请注意，它应该是）：

在 SecondViewController.h 中：

```
@class FirstViewController;

@interface SecondViewController : UIViewController

@property (nonatomic, weak) FirstViewController *firstViewController;

@end 
```

然后在 FirstViewController.m 中：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"YourSegueIdentifierHere"])
    {
        [segue.destinationViewController setFirstViewController:self];
    }
} 
```

因此，例如，如果您的第一个视图控制器具有以下属性`favoriteColor`：

```
@interface FirstViewController : UIViewController

@property (nonatomic, strong) NSString *favoriteColor;

@end 
```

然后，第二个视图控制器可以使用它的`firstViewController`属性来更新 this `favoriteColor`，如下所示：

```
self.firstViewController.favoriteColor = @"Blue"; 
```

清楚地：

1.  将`FirstViewController`和替换`SecondViewController`为适当的类名；

2.  确保您的第二个视图控制器的 .m 文件执行`#import`第一个视图控制器的 .h；和

3.  确保您在 Interface Builder 中为从第一个控制器到第二个控制器的 segue 指定了一个 segue 标识符，并调整`prepareForSegue`上述内容，替换`YourSegueIdentifierHere`为您的标识符。

* * *

在 iOS 6 中，您还可以通过 unwind segue 来完成此操作。您只需让`prepareForSegue`第二个视图控制器更新展开转场的目标控制器（即第一个控制器）的属性。好的是展开转场可以返回任意数量的关卡，所以对于更复杂的场景，它非常好。不过，它只是 iOS 6 或更高版本。

要进行 unwind segue，首先必须在第一个视图控制器中定义一个 unwind 动作（通过`IBAction`返回类型和`UIStoryboardSegue`参数的组合来识别），例如：

```
- (IBAction)done:(UIStoryboardSegue *)segue
{
    // do any clean up you want
} 
```

然后，第二个（或第三个或...）视图控制器可以通过`control`在 Interface Builder 中从按钮拖动到场景 Dock 中的退出图标来创建展开转场。您可以让您从中展开的控制器执行逻辑`prepareForSegue`以将信息传递回第一个视图控制器。

* * *

顺便说一句，您使用了术语“父”和“子”，但我想澄清一下，我假设您不是在谈论更高级的[视图控制器包含](http://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html#//apple_ref/doc/uid/TP40007457-CH18-SW6)主题，其中视图控制器正在调用其他视图控制器以促进单个信息屏幕的呈现（而不是在应用程序中的不同场景之间转换）。正如 rdelmar 在我们下面的评论中指出的那样，严格来说，术语“父”和“子”控制器更恰当地暗示了一个正在使用视图控制器包含。

显然，如果您正在使用视图控制器包含，那么显然对 segues`prepareForSegue`等的讨论不适用。此外，正确实现的容器视图控制器保证子控制器可以实际使用 的`UIViewController`属性`parentViewController`，而无需定义我们自己的属性来引用父级。您需要做的就是转换/定义`parentViewController`为正确的子类，然后您可以非常轻松地访问您的子类属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T21:57:17.627

最好的方法是在 id 或 UIViewController 类型的子视图控制器中拥有一个属性。在创建子视图时将该值设置为父视图控制器。

一旦您可以访问子视图控制器中的父视图控制器，您就可以访问其方法或属性。*

# ssas - 使用 MDX 语句在 SSAS 中创建多维数据集计算以将每月目标分配到每日级别

> ID：13829155
> 
> 赞同：4
> 
> 时间：2012-12-11T21:55:36.823
> 
> 标签：ssas, mdx, cube, measure

我有一个目标多维数据集事实表，目标是每月级别（1 月 = 300，2 月 = 450，3 月 = 350 等）

在使用月份作为连接时，它与我的多维数据集中的日期维度相连接，但是维度粒度处于日级别。

我想要做的是创建一个计算，以便将每月目标平均分配给当月的日子，因此 1 月的每一天都有 300/31 Feb 450/28 等的目标。

然后，我希望能够将此计算的度量用作我的目标，并将其用作每日/每月/每季度/年度目标。

我认为这应该可以通过 MDX 语句（或者可能使用一些计算量度的一些语句）来实现，但我对它并不熟悉。

那么这种方法会起作用吗？ mdx 会是什么样子？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T16:21:30.140

如果您有能力对源 OLTP/staging 数据库进行更改，那么如果您需要在该级别报告，最好将 Targets 事实表的粒度更改为每天。如果您的 OLTP 数据库中有一个日期维度表，您可以使用视图来执行此操作，方法是将您的每月事实表连接到月份属性上的日期维度，然后将目标值平均分配到该月的几天中。

如果您使用的是 SQL Server，并且您的 OLTP 架构如下所示：

```
CREATE TABLE dimDate (
    Date Date,
    YearMonth Integer,
    ...
)

CREATE TABLE factMonthlyTarget (
   YearMonth Integer,
   Value Integer,
   ...
) 
```

您的新事实视图将类似于以下内容：

```
CREATE VIEW factDailyTarget AS
   SELECT 
      dimDate.Date,
      factMonthlyTarget.Value / Months.DaysPerMonth AS Value
   FROM
      factMonthlyTarget, 
      dimDate, 
      (
         SELECT YearMonth, COUNT(*) AS DaysPerMonth
         FROM dimDate
         GROUP BY YearMonth
      ) Months
   WHERE factMonthlyTarget.YearMonth = Months.YearMonth
         AND Months.YearMonth = dimDate.YearMonth 
```

# java - org.hibernate.event.def.EventCache 不支持空实体是什么意思？

> ID：13829157
> 
> 赞同：3
> 
> 时间：2012-12-11T21:55:38.930
> 
> 标签：java, sql-server, hibernate, hsqldb, dbunit

我在尝试保存实体时遇到错误。我只有在启动服务器时才会收到此错误，而不是在使用 dbunit 运行单元测试时。

我正在尝试保存一个关联。我的单元测试应该与我在手动测试时遇到的情况完全相同。我在之前不存在任何关系的关系的一端添加了一个新实体。

我将 HSQLDB 与单元测试一起使用，而 Web 应用程序正在使用 SQL Server。

我进行的搜索并未证明是富有成效的。对消息的解释将证明非常有用。

这是测试用例（效果很好！）：

```
 @Test
      @DatabaseSetup(value="MobileWebsiteTest.saveMobilewebsiteMobilecolorswatchmapuserdefined_NewUserSwatch.xml", type=DatabaseOperation.REFRESH)
    public void saveMobilewebsiteMobilecolorswatchmapuserdefined_NewUserSwatch() {
        // given
        Integer mobileWebsiteId = 569;
        Mobilecolorswatchmapuserdefined expected = MobilecolorswatchmapuserdefinedBuilder.init().build();

        // when
        Mobilewebsite result = service.saveMobilewebsiteMobilecolorswatchmapuserdefined(mobileWebsiteId, expected);

        // then
        assertNotNull("The Mobilewebsite user defined swatch should not be null", result.getMobilecolorswatchmapuserdefined());
        assertNotNull("The Mobilewebsite user defined swatch id should not be null.", result.getMobilecolorswatchmapuserdefined().getMobileColorSwatchMapUserDefinedId());
        assertEquals("The result aside property should be equivalent to the expected aside property.", expected.getAside(), result.getMobilecolorswatchmapuserdefined().getAside());
        assertEquals("The result SiteName property should be equivalent to the expected SiteName property.", expected.getSiteName(), result.getMobilecolorswatchmapuserdefined().getSiteName());
    } 
```

这是服务（注意：我目前在已经存在关联的情况下进行删除/保存 - 这应该是一对一的，但是是遗留的）：

```
@Override
@Transactional
public Mobilewebsite saveMobilewebsiteMobilecolorswatchmapuserdefined(Integer mobileWebsiteId, Mobilecolorswatchmapuserdefined related_swatchmap) {
    log.debug("saveMobilewebsiteMobilecolorswatchmapuserdefined(Integer mobileWebsiteId=[" + mobileWebsiteId + "],  Mobilecolorswatchmapuserdefined related_swatchmap=[" + related_swatchmap + "])");

    Mobilewebsite mobilewebsite = mobilewebsiteDAO.findMobilewebsiteByPrimaryKey(mobileWebsiteId, -1, -1);
    Calendar now = Calendar.getInstance();

    if (mobilewebsite.getMobilecolorswatchmapuserdefined() != null) {
        this.deleteMobilewebsiteMobilecolorswatchmapuserdefined(mobilewebsite.getMobileWebsiteId(), mobilewebsite.getMobilecolorswatchmapuserdefined().getMobileColorSwatchMapUserDefinedId());
    }

    related_swatchmap.setCreatedDtstamp(now);
    related_swatchmap.setLastUpdatedDtstamp(now);

    related_swatchmap.addToMobilewebsites(mobilewebsite);
    **related_swatchmap = mobilecolorswatchmapuserdefinedDAO.store(related_swatchmap);**

    mobilewebsite.setMobilecolorswatchmapuserdefined(related_swatchmap);
    mobilewebsite = mobilewebsiteDAO.store(mobilewebsite);
    mobilewebsiteDAO.flush();

    return mobilewebsite;
} 
```

堆栈跟踪指向上面突出显示的行：`mobilecolorswatchmapuserdefinedDAO.store(related_swatchmap);`。

堆栈跟踪是：

```
2012-12-11 15:14:11.192 59464 [http-8080-2] ERROR  - Unexpected error occurred
org.apache.wicket.WicketRuntimeException: Method onFormSubmitted of interface org.apache.wicket.markup.html.form.IFormSubmitListener targeted at [ [Component id = form1]] on component [ [Component id = form1]] threw an exception
    at org.apache.wicket.RequestListenerInterface.internalInvoke(RequestListenerInterface.java:270)
    at org.apache.wicket.RequestListenerInterface.invoke(RequestListenerInterface.java:216)
    at org.apache.wicket.request.handler.ListenerInterfaceRequestHandler.invokeListener(ListenerInterfaceRequestHandler.java:248)
    at org.apache.wicket.request.handler.ListenerInterfaceRequestHandler.respond(ListenerInterfaceRequestHandler.java:234)
    at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:781)
    at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
    at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:255)
    at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:212)
    at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:283)
    at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:185)
    at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:241)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.wicket.RequestListenerInterface.internalInvoke(RequestListenerInterface.java:260)
    ... 22 more
**Caused by: java.lang.NullPointerException: null entities are not supported by org.hibernate.event.def.EventCache**
    at org.hibernate.event.def.EventCache.containsKey(EventCache.java:80)
    at org.hibernate.event.def.DefaultMergeEventListener.mergeTransientEntity(DefaultMergeEventListener.java:361)
    at org.hibernate.event.def.DefaultMergeEventListener.entityIsTransient(DefaultMergeEventListener.java:303)
    at org.hibernate.event.def.DefaultMergeEventListener.onMerge(DefaultMergeEventListener.java:258)
    at org.hibernate.event.def.DefaultMergeEventListener.onMerge(DefaultMergeEventListener.java:84)
    at org.hibernate.impl.SessionImpl.fireMerge(SessionImpl.java:859)
    at org.hibernate.impl.SessionImpl.merge(SessionImpl.java:843)
    at org.hibernate.impl.SessionImpl.merge(SessionImpl.java:847)
    at org.hibernate.ejb.AbstractEntityManagerImpl.merge(AbstractEntityManagerImpl.java:682)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:365)
    at $Proxy44.merge(Unknown Source)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240)
    at $Proxy44.merge(Unknown Source)
    at org.skyway.spring.util.dao.AbstractJpaDao.merge(AbstractJpaDao.java:61)
    at org.skyway.spring.util.dao.AbstractJpaDao.store(AbstractJpaDao.java:48)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    at $Proxy76.store(Unknown Source)
    **at com.telventdtn.aghostmobile.service.MobilewebsiteServiceImpl.saveMobilewebsiteMobilecolorswatchmapuserdefined(MobilewebsiteServiceImpl.java:342)**
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    at $Proxy77.saveMobilewebsiteMobilecolorswatchmapuserdefined(Unknown Source)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.wicket.proxy.LazyInitProxyFactory$JdkHandler.invoke(LazyInitProxyFactory.java:416)
    at org.apache.wicket.proxy.$Proxy4.saveMobilewebsiteMobilecolorswatchmapuserdefined(Unknown Source)
    at com.telventdtn.aghostmobile.ArrangeColorsThemePage$SubmitButtonHandler.onSubmit(ArrangeColorsThemePage.java:126)
    at com.telventdtn.aghostmobile.markup.html.form.ObservableButton.notifyObservers(ObservableButton.java:20)
    at com.telventdtn.aghostmobile.markup.html.form.ButtonFactory$1.onSubmit(ButtonFactory.java:34)
    at org.apache.wicket.markup.html.form.Form.delegateSubmit(Form.java:1151)
    at org.apache.wicket.markup.html.form.Form.process(Form.java:834)
    at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:762)
    at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:692)
    ... 27 more 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T17:22:09.757

我有类似的经验，其中表定义了一个`nullable`列，但域类将其标记为`not nullable`. 尝试使用 保存对象`nulls`，并且确实保留了该对象，但随后因该错误而失败。希望这可以帮助。

# java - Java和mysql查询检查结果是否为空

> ID：13829159
> 
> 赞同：4
> 
> 时间：2012-12-11T21:55:45.903
> 
> 标签：java, mysql

```
ResultSet zoeken = stat.executeQuery("SELECT * FROM leden WHERE naam = '" + text + "'");
if (zoeken.getRow() == 0){
   System.out.println("hi");
}
while( zoeken.next() ){
   System.out.println(zoeken.getString(1) + zoeken.getString(2) + zoeken.getString(3));
} 
```

我正在使用它来检查结果`zoeken`是否为空，但它会抛出一个异常，说明这样做是非法的，无论它是否有效。

检查结果是否为空的更好解决方案是什么

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-11T21:58:33.183

> // 我正在使用它来检查结果“zoeken”是否为空，但它会抛出一个异常，说明这样做是非法的。不管它是否有效

**在调用ResultSet.next()**之前不要调用[**ResultSet.getRow()**](http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSet.html#next%28%29)。

**来自 API：**

> ResultSet 对象维护一个指向其当前数据行的游标。最初，光标位于第一行之前。next 方法将光标移动到下一行，因为当 ResultSet 对象中没有更多行时它返回 false，所以可以在 while 循环中使用它来遍历结果集。

```
 ResultSet zoeken = stat.executeQuery("SELECT * FROM leden WHERE naam = '" + text + "'");
       boolean val = zoeken.next(); //next() returns false if there are no-rows retrieved 
        if(val==false){
            System.out.println("zoken is empty"); //prints this message if your resultset is empty
         }
        while(val){// only runs when there are rows in the resultset
           System.out.println(zoeken.getString(1) + zoeken.getString(2) + zoeken.getString(3));
          val=zoeken.next(); //updating val again to check if there are rows in result set
        } 
```

如果您的结果集为**空** `zoeken.next()`将返回**false**在这种情况下您的 while 循环将不会执行。

## 一个建议

使用[**PreparedStatement**](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html)而不是简单的 Statement。简单的语句会导致**SQL 注入**，也可以减轻编写复杂查询的痛苦。下面是使用 PreparedStatement 的示例代码。

```
String yourquery ="Select whatever From table where col1= ? and col2 =?"
PreparedStatement stmnt = Conn.preparedStatement(yourquery);
stmnt.setString(1, "val1");
stmnt.setString(2, "val2"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T21:56:50.813

使用`next()`方法

```
boolean hasNext = zoeken.next(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-08T03:27:14.587

以下代码将为您工作

```
if(!zoeken.first() && !zoeken.next())//if fist and next records are empty
{
System.out.println("Result set is empty");
}
else
{
System.out.println("Result set is not empty");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-11T22:03:29.570

根据[next()](http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSet.html#next%28%29)你必须先使用 next 然后 getRow()

```
ResultSet zoeken = stat.executeQuery("SELECT * FROM leden WHERE naam = '" + text + "'");
while( zoeken.next() ){
    int rowNum = zoeken.getRow();
    System.out.println(zoeken.getString(1) + zoeken.getString(2) + zoeken.getString(3));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-11T22:27:40.550

不使用 Result Set next() 您无法检查大小或 resultSet 周期。

ResultSet 游标最初位于第一行之前。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-14T18:24:25.627

我知道 OP 可能不再需要这些信息，但如果有人偶然发现这一点，我会同意 @PermGenError 所说的一切，尽管我觉得给定代码的解决方案更优雅，但使用准备好的语句将是：

```
PreparedStatement ps = conn.prepareStatement("SELECT * FROM leden WHERE naam = ?");
ps.setString(title);
ResultSet rs = ps.executeQuery();

if (rs.next()) {
    do {
        System.out.println(zoeken.getString(1) + zoeken.getString(2) + zoeken.getString(3));
    } while (rs.next());
} else {
    System.out.println("hi");
} 
```

我已经徒手写了这个，所以请原谅任何错误或者如果它没有编译。我只是觉得这更清楚并减少了局部变量的使用。如果至少有一行，请打印该行并继续执行此操作，直到没有更多行，否则说“嗨”。但我想你会想说一些比“嗨”更有用的东西，也许是“没有找到结果”消息或其他东西。

# ios - Xcode Save for Enterprise or Ad-Hoc Deployment 失败 - “代码签名操作失败”

> ID：13829161
> 
> 赞同：0
> 
> 时间：2012-12-11T21:55:47.773
> 
> 标签：ios, xcode, code-signing, ad-hoc-distribution

从今天开始，我无法在 .ipa 中导出/保存应用程序。每次尝试，我都会在签名时收到一条消息：

无效的参数被传递给 codesign。Arguments were: --sign 351424d48e1f5c926f2fc268f1a286d14faefb77 --force --preserve-metadata=identifier,entitlements,resource-rules /var/folders/nl/0q4kl6ws57j3cx3pbzgfqjph0000gn/T/8860C8DC-DF6C-425D-9ED6-643BCD543AB5-1576-0000059990815932/Test.应用/测试

可能是问题所在？

我该如何解决？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T03:34:45.670

您是否安装了一些自签名应用程序用于辞职破解 ipa？

[如果你这样做了，我可以帮忙，在这里](http://imi.im/post/2012-12-26/40046118177)查看我的修复

# c++ - 什么是 Microsoft 支持的用于检索线程地址的 API

> ID：13829162
> 
> 赞同：1
> 
> 时间：2012-12-11T21:55:49.600
> 
> 标签：c++, windows, winapi, msdn

我目前
`NtQueryInformationThread(.., ThreadQuerySetWin32StartAddress, addr, ..)`用于获取线程地址`addr`。
msdn[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684283%28v=vs.85%29.aspx)说

> NtQueryInformationThread 可能在未来版本的 Windows 中被更改或不可用

还，

> 请注意，在 Windows Vista 之前的 Windows 版本上，返回的起始地址仅在线程开始运行之前是可靠的。

检索线程地址的建议方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:12:10.113

NtQueryXxxx 函数组是未记录的内部 Windows 内核函数。直到微软被迫在与美国司法部的和解中记录他们。他们这样做了，但保留在任何未来版本的 Windows 中更改其实施的权利，这是允许他们在 Windows 上进行创新所必需的。并保留不必使该函数在内核中的预期用途之外实际有用的权利。

警告非常准确，线程启动后，您将无法从此函数中获得可用的线程起始地址。它将指向*真正的*起始地址，即 ntdll.dll 中名为 __RtlUserThreadStart() 的内部帮助函数。当你有 Windows 的调试符号时，你可以在任何堆栈跟踪中看到它。*每个*启动线程的起始地址相同。

字写在墙上。不要使用它。

# c++ - Visual Studio 2010 中的“其他包含目录”不起作用

> ID：13829163
> 
> 赞同：1
> 
> 时间：2012-12-11T21:55:59.517
> 
> 标签：c++, visual-studio, visual-studio-2010

我在这个问题上敲了一段时间，所以我想我会发布。我有两个库项目，其中 Project2 在以下目录结构中使用/引用 Project1。

```
c:\code\Library\Project1
c:\code\Library\Project2 
```

两者都是图书馆项目。我已将 Project2 中的路径包含在 Properties>Configuration Properties>C/C++>General>'Additonal Include Directories' 中。它读到`..\Project1; %(AdditionalIncludeDirectories)`

现在 Project2 中有一个文件，其中 #includes 文件存在于 project1 文件夹中。尽管已包含上述路径，但仍然出现错误：

```
1>c:\code\Library\Project2\MyTestDlg.cpp(6): fatal error C1083: Cannot open include file: 'GraphCtrl.h': No such file or directory 
```

奇怪的是，如果我不更改原始项目名称，类似的设置也会起作用。这些项目最初位于它们链接良好的文件夹中。

```
c:\code\Library\Project1 1.0.0
c:\code\Library\Project2 1.0.0 
```

我正在做的是从项目文件夹中删除最后一个版本名称（并再次将它们重新链接在一起），但这已成为一场噩梦！有什么建议么？

ps 我对此做了很多研究，这似乎与目录的长度有关，但我认为我在限制方面做得很好。以前较长的文件夹名称有效而较短的文件夹名称无效，这表明长度不是问题。

添加在：

以下是我在使用实际文件名时遇到的实际错误：问题之一是它仍然以全名引用旧库，`GraphCtrlLib 1.0.0.0`即使我已经完全删除它并且找不到它的更多引用。我这可能与此错误无关。

```
1>Build started 12/11/2012 5:16:02 PM.
1>C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.Targets(1200,9): warning : The referenced project '..\Graph\Graph.vcxproj' does not exist.
1>InitializeBuildStatus:
1>  Touching "Debug\ViewerLib.unsuccessfulbuild".
1>ClCompile:
1>  All outputs are up-to-date.
1>  OpenViewerDlg.cpp
1>c:\code\libraries\viewerlib\viewerdlg.cpp(6): fatal error C1083: Cannot open include file: 'GraphCtrl.h': No such file or directory 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T23:25:43.023

终于解决了问题。我在记事本中打开了 .vcxproj 文件，并将旧路径的所有引用更改为新路径并保存。这解决了问题。

这是由于项目文件是只读的，VC2010 没有正确更新它。我一直在对项目属性进行更改，我可以通过回读它们来判断它们是我想要的，但是当我关闭项目并重新加载它时，它又回到了更改之前的状态。因此，这些更改从未得到应用。VS2010 并没有告诉我它不能保存或应用更改，但会接受它们并且永远不会应用它们！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-04T14:09:55.490

我意识到这是一个老话题，但我想我会添加我的解决方案，以防未来的搜索者有相同的特定场景。

在我的例子中，附加的包含目录被定义为属性页中的用户宏（通过视图、属性管理器访问，然后右键单击项目、属性）。但是，尽管在那里更新了值，但实际上并没有保存属性页（即使 C++、命令行属性显示了正确的路径 (!)）。必须从源代码管理中检出 .props 文件并保存它，然后重新构建 - 最后找到该目录中的包含文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-12-17T16:42:43.987

添加这个答案，以防其他人需要它。我在 VS 2015 中遇到了同样的问题。

我通过编辑 .vcxproj 文件解决了这个问题。

在其中我搜索“路径”

然后将您的包含目录路径添加到它。

# video - FFmpeg 添加空白帧

> ID：13829164
> 
> 赞同：1
> 
> 时间：2012-12-11T21:56:01.187
> 
> 标签：video, ffmpeg, frames

我正在使用此命令在给定一组帧和音频的情况下生成视频：

```
ffmpeg -y -i index%2d.jpg -i audio.mp3 -acodec copy -vcodec mjpeg -s 1680x1050 -aspect 16:9 result.avi 
```

它的效果很棒，问题是，如果我的索引有缺口怎么办？

或者相反，我没有间隙，但想要一个间隙，即输出视频中的空白帧。

给定此命令以及不带间隙的图像索引或带间隙的图像（无论哪个选项是最好的）以生成带间隙的视频？

示例：我有 im1.jpg img2.jpg，我想生成 im1.jpg 空白、空白 im2.jpg（4 帧）这是一个示例，我不想要 4 帧视频 :-)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T08:32:25.577

如果您的意思是全黑或全白屏幕，则使用空白，您可以生成这些图像并将其与您需要的插槽中的其他图像一起使用！

# ajax - 使用 ajax 在服务器上上传 blob

> ID：13829166
> 
> 赞同：0
> 
> 时间：2012-12-11T21:56:07.900
> 
> 标签：ajax, file-upload, twitter-bootstrap, blob

谁能告诉我如何通过 ajax 调用在服务器上存储 blob？我尝试了很多东西，但没有一个有效。而且我找不到任何关于此的好信息。

这是我要发送 blob 的地方

```
class Ajax extends CI_Controller {

function __construct()
{
    parent::__construct();
    $this->load->helper('url');
    $this->load->helper('form_helper');
    $this->load->library('tank_auth');

}

public function saverecording()
{
    $status = "";
    $msg = "";
    $file_element_name = 'komaan';
    if ($status != "error")
    {
          $config['upload_path'] = '../../upload/audio/recordings/';
          $config['allowed_types'] = 'wav';
          $this->load->library('upload', $config);
          if (!$this->upload->do_upload($file_element_name))
          {
             $status = 'error';
             $msg = $this->upload->display_errors('', '');
             echo '<script>
             console.log("this is not working");</script>';
          }
          else
          {
             $data = $this->upload->data();
             echo '<script>
             console.log("this is ");</script>';
             //$file_id = $this->files_model->insert_file($data['file_name'], $_POST['title']);
          }
          @unlink($_FILES[$file_element_name]);
       }
} 
```

**新编辑**：感谢您的耐心，我对网络开发很陌生。我弄清楚了问题所在。正如我所说，我从 javascript 代码中获得了一个 blob 文件：

```
recorder.exportWAV(function(blob) {
            console.log(blob);
            $('userfile').val(blob);
            $.ajaxFileUpload({
            url :  "../ajax/saverecording/", 
            secureuri      :false,
            fileElementId  :'userfile',
                dataType : blob.type,
                data: blob,
                success: function(data, status) {
                    if(data.status != 'error')
                        alert("hoera!");
                    alert(data.msg);
                }
            });
        }); 
```

$('userfile').val(blob); 给我一个“未捕获的错误：InvalidStateError：DOM Exception 11”为什么？

谢谢

卡特里妮

# mysql - MySQL OUTER JOIN 与基于日期的 COUNTS

> ID：13829170
> 
> 赞同：0
> 
> 时间：2012-12-11T21:56:31.723
> 
> 标签：mysql, sql

在 MySQL 中，我想对表`table1`和`table2`.

我只想获取今天和昨天的相关计数`table2`，`code`但我也希望能够看到`code`计数为 0 的其他类型。这就是我到目前为止所拥有的

```
SELECT h.code, count(h.code) as count, h.timestamp
FROM table1 h LEFT OUTER JOIN table2 o ON h.code= o.code 
GROUP BY h.code 

UNION 

SELECT h.code, count(h.code) as count, h.timestamp
FROM table1 h RIGHT OUTER JOIN table2 o ON h.code= o.code 
GROUP BY h.code 
```

所以我想申请这样的东西

```
WHERE h.timestamp >= CURRENT_DATE - INTERVAL 1 
```

但也包括 table1 中的所有记录，但计数为 0

我希望这是有道理的，希望有人能提供帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:23:28.203

```
SELECT 
 h.code, 
 count(case h.code is null then 0 else 1 end) as count, 
 h.timestamp
FROM table1 h LEFT OUTER JOIN table2 o ON h.code= o.code 
WHERE h.timestamp >= CURRENT_DATE - INTERVAL 1
group by h.code 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:27:17.740

> 所以我想申请这样的东西
> 
> WHERE h.timestamp >= CURRENT_DATE - INTERVAL 1
> 
> 但也包括 table1 中的所有记录，但计数为 0

如所写，您将结果复制到`h.code= o.code`. 所以它值得`WHERE h.code is null`在第二个查询中做。因此，这意味着对于该查询，我们不想应用 where 条件，`h`因此我们只需将其添加到第一个查询。

```
SELECT h.code, count(h.code) as count, h.timestamp
FROM table1 h LEFT OUTER JOIN table2 o ON h.code= o.code 
 WHERE h.timestamp >= CURRENT_DATE - INTERVAL 1
GROUP BY h.code 

UNION ALL

SELECT h.code, count(h.code) as count, h.timestamp
FROM table1 h RIGHT OUTER JOIN table2 o ON h.code= o.code 
WHERE h.code is null
GROUP BY h.code 
```

如果出于某种原因您想将日期标准应用于`h`且`o`仅当有记录时，`o`则第一个 where 子句将是

```
WHERE h.timestamp >= CURRENT_DATE - INTERVAL 1
      AND
      (o.timestamp >= CURRENT_DATE - INTERVAL 1
        or o.code is null) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T22:03:12.747

嗯，你有所有代码的表吗？

```
select codes.code, coalesce(t.cnt) as cnt
from (select distinct code
      from table1
     ) codes left outer join
     (select code, count(*) as cnt
      from table1
      where timestamp >= CURRENT_DATE - INTERVAL 1
      group by code
     ) t
     on codes.code = t.code 
```

该查询比必要的要复杂一些，因为它确实需要一个代码表作为查询的第一部分。如果您只有一个表，这可能是一种更简单的形式：

```
select code,
       sum(case when timestamp >= CURRENT_DATE - INTERVAL 1 then 1 else 0 end) as cnt
from table1
group by code 
```

# freepascal - 遍历子字符串的多个实例的字符串 - freepascal 或 delphi

> ID：13829173
> 
> 赞同：4
> 
> 时间：2012-12-11T21:56:51.140
> 
> 标签：freepascal, lazarus

平台：Lazarus 1.1、FreePascal 2.7.1、Win 7 32 位。

我有一个字符串值如下：

```
FileName[12345][45678][6789].jpg 
```

默认情况下（假设这是默认行为 0），我的程序当前从文件名最右侧的最后一对方括号中提取最后一组数字，即 6789。它使用以下代码执行此操作：

```
if chkbxOverrideUniqueID.Checked then
   IDOverrideValue := StrToInt(edtToggleValue.Text);   
// User is happy to find the right most unique ID
if not chkbxOverrideUniqueID.Checked then      
  LastSquareBracket := RPos(']', strFileName);
  PreceedingSquareBracket := RPosEx('[', strFileName, LastSquareBracket) + 1;
  strFileID := AnsiMidStr(strFileName, PreceedingSquareBracket, LastSquareBracket - PreceedingSquareBracket)
else // User doesn't want to find the rightmost ID. 
  // and now I am stuck! 
```

但是，我现在为用户添加了一个选项来指定非默认行为。例如，如果他们输入“1”，则表示“从最右边的 ID 中查找第一个 ID”。例如 [45678]，因为 [6789] 是默认行为 0，请记住。如果他们输入 2，我希望它找到 [12345]。

我的问题：请问如何调整上面的代码来实现这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-11T22:17:35.133

以下代码将仅返回括号中的数值：

```
uses
  StrUtils;

function GetNumber(const Text: string; Index: Integer): string;
var
  I: Integer;
  OpenPos: Integer;
  ClosePos: Integer;
begin
  Result := '';
  ClosePos := Length(Text) + 1;
  for I := 0 to Index do
  begin
    ClosePos := RPosEx(']', Text, ClosePos - 1);
    if ClosePos = 0 then
      Exit;
  end;
  OpenPos := RPosEx('[', Text, ClosePos - 1);
  if OpenPos <> 0 then
    Result := Copy(Text, OpenPos + 1, ClosePos - OpenPos - 1);
end; 
```

如果您希望该值包括这些括号，请将最后一行替换为：

```
Result := Copy(Text, OpenPos, ClosePos - OpenPos + 1); 
```

# c# - EF 和链接表

> ID：13829178
> 
> 赞同：1
> 
> 时间：2012-12-11T21:57:22.060
> 
> 标签：c#, entity-framework

我想我在这里遗漏了一些简单的东西。我收到错误消息：

> “违反 PRIMARY KEY 约束 'PK_FeatureTypes'。无法在对象 'dbo.FeatureTypeCodes' 中插入重复键。重复键值为 (28)。\r\n语句已终止”

我有一个 FeatureType - (Mountain, Lake, River, etc.) 的查找/链接表，它已经填充了数据并定义为：

```
[Table("FeatureTypeCodes")]
public class FeatureTypeCode {
    [DatabaseGenerated(DatabaseGeneratedOption.None)] 
    public int FeatureTypeCodeID { get; set; }
    public string Name { get; set; }
} 
```

这链接到我的位置表/对象，如下所示：

```
[Table("Places")]
public class Place {
    [DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int PlaceID { get; set; }
    public string Name { get; set; }
    public FeatureTypeCode FeatureTypeCode { get; set; }
    public ICollection<PlaceCoordinate> PlaceCoordinates { get; set; }
} 
```

然后我像这样从旧数据库中加载它们（它是我的转换代码的一部分）：

```
foreach (DataRow r in table.Rows) {
        int ftID = Convert.ToInt32(r["FeatureTypeId"]);
        Place temp = new Place {
                PlaceID = Convert.ToInt32(r["PlaceID"]),
                Name = r["PlaceName"].ToString(),
                FeatureTypeCode = featureTypeCodeRepository.FeatureTypeCodes.FirstOrDefault(o=>o.FeatureTypeCodeID == ftID)
            };
            places.Add(temp);
        } 
```

当它在保存地点时尝试插入具有与现有对象相同 ID 的新 FeatureType 对象时，会生成错误。我的想法是，通过从上下文中加载 FeatureType，它不会尝试在保存 Place 对象时插入新的 FeatureType。我显然错了，但我错过了一些简单的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:09:36.703

我不认为你在你的`featureTypeCodeRepository`和`places.Add(temp);`. 所以我认为基本上 EF 不会跟踪 FeatureTypeCodes，因为它是由一个上下文加载并由另一个上下文保存的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T00:12:22.260

虽然我认为 Simon Edström 是正确的 (+1)，但您也可以考虑在您的课程中公开原始外键字段（类似于`FeatureTypeId`？）`Place`。然后你可以简单地设置

```
FeatureTypeId = ftID; 
```

如果您不确定 FK 字段值是否真的存在于表中，您可以使用即使它具有不同的上下文`FeatureTypeCodes`来查询它的存在。`featureTypeCodeRepository`使用`Any()`是最便宜的方法：

```
var exists = featureTypeCodeRepository.FeatureTypeCodes
                 .Any(o => o.FeatureTypeCodeID == ftID) 
```

在实体框架中这样做并不少见。仅由引用（like `Place.FeatureTypeCode`）组成的关系称为*独立关联*，即具有引用和原始 FK 属性*外键关联的关联*。Julia Lerman 在她的书*DbContext 中*说

> 除非您有充分的理由不公开外键属性，否则通过包含它们将为您省去很多痛苦

# c# - ASP.NET 中的可编辑 GridView

> ID：13829183
> 
> 赞同：2
> 
> 时间：2012-12-11T21:57:39.617
> 
> 标签：c#, asp.net, gridview

我正在寻找一些帮助来开始在 ASP 中创建可编辑的 GridView，我已经在表单应用程序中完成了所有工作。现在我的计划是使用 ASP.NET 将其转换为 Web 应用程序。我会说不太难，但我的 GridViews 只是遇到了一些问题。所以这是我当前的应用程序所做的以及我希望它在 ASP 中做的事情：

我创建了多个 GridView，只有一列。然后在此列上，将在应用程序启动时添加行，在数据库中找到应该添加的行数。其中一些行将填充数据库中的数据，一些将留空。我已经有了这方面的代码，只需要将其转换为与 ASP 一起使用。我希望用户能够编辑所有这些行，包括那些为空的行。这些列没有什么花哨的，用户只能在其中输入数字。

因为我对 ASP 完全陌生，所以我不知道如何创建一个 GridView，它具有空的可编辑行。也许这很简单，但是非常感谢您朝正确的方向点头！如果需要更多信息，请告诉我

[我想在 ASP.NET 中做什么](http://postimage.org/image/n880wyplp/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:41:36.087

`GridView`自 .NET 在 WebForms 下发布以来，它是一长串控件中最强大的控件之一，它被广泛使用，以至于有数以千计的示例和教程可以做几乎所有事情。

自从我学习 GridView 的优点以来，我一直依赖 2 个网站，今天我将把它们作为我的答案。

一个，*我再也找不到*了，类似于**The GridView Guy**，这是一个可爱的网站，提供了最好的教程来提升 .NET 控件来完成几乎所有工作。

The Seconds 是著名的[Matt Berseth](http://mattberseth.com/)，[他的所有教程](http://mattberseth.com/blog)不仅围绕着`GridView`其他控件，还围绕着其他控件。

> [http://mattberseth.com/blog/gridview/](http://mattberseth.com/blog/gridview/)

* * *

有更多的教程可以解决这个问题，比如：

*   [http://www.codeproject.com/Articles/16769/Full-featured-Editable-GridView-Control](http://www.codeproject.com/Articles/16769/Full-featured-Editable-GridView-Control)
*   [http://www.dotnetspark.com/kb/643-how-to-editupdatedelete-gridview.aspx](http://www.dotnetspark.com/kb/643-how-to-editupdatedelete-gridview.aspx)
*   [http://aspnet-with-c-sharp.blogspot.dk/2011/02/fully-editable-gridview-in-aspnet-2.html](http://aspnet-with-c-sharp.blogspot.dk/2011/02/fully-editable-gridview-in-aspnet-2.html)

您只需要跟进，如果您发现无法攀爬的墙，请确保附近有人可以帮助您，只需向我们展示您需要做什么，以及您尝试过什么。

# sites - jQuery 可以在 FireFox 中使用，但不能在带有 Google 站点小工具的 Chrome 中使用

> ID：13829184
> 
> 赞同：1
> 
> 时间：2012-12-11T21:57:53.027
> 
> 标签：sites

请原谅我的无知，但我对 jQuery、HTML、Javascript 等完全陌生。网络背景。

我正在将一个 html 文件插入到 Google 网站的 Google 小工具中。它应该做的是显示 4 个显示部分图片的框和一个用于展开图片的按钮。当您单击按钮时，该框应该会放大并显示整个图片以及一些文本。当我有这一行时，这在 Firefox 中运行良好：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script> 
```

但不是铬。

我已将所有这些必要的文件上传到我的 Google 云端硬盘中，以便在我的 Google 站点中正常工作。我已经在我的驱动器中共享了 jQuery.js 文件并将其复制到我的 html 文件中。当我用这一行替换上面的行时：

```
<script type="text/javascript" src="https://docs.google.com/a/chartwellreit.ca/uc?id=0B7EcQSX7GqjAREtlOXBOQmVRaUE"></script> 
```

它在 Chrome 中运行良好，但在 FireFox 中却不行。

如果您需要更多信息，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:37:58.013

[https://developers.google.com/speed/libraries/devguide#jquery](https://developers.google.com/speed/libraries/devguide#jquery)

要加载托管库，请复制该库的 HTML 片段（如下所示）并粘贴到您的网页中。例如，要加载 jQuery，请嵌入以下代码段：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script> 
```

网页中的片段。

# java - Grails 2.1.1 - 如何使用 AstTransformer 开发插件？

> ID：13829189
> 
> 赞同：3
> 
> 时间：2012-12-11T21:58:05.523
> 
> 标签：java, grails, grails-plugin, abstract-syntax-tree, grails-2.0

我想将自动注入的对象替换`log`为 type`org.apache.commons.logging.Log`的对象`org.slf4j.Logger`，以便我可以在 Logback 中正确使用它。

因此，我需要创建一个`...Transformer`类（用 Java 编写）——这就是我在“grails-user”邮件列表中从 Graeme Rocher 那里得到的。我也知道我必须将这个`...Transformer`类打包到一个插件中，并使其成为一个 *.jar 存档，我可以将其加载`lib/`到插件的文件夹中。但是我想我在这里做错了，因为我有这个类，以及一个`META-INF`包含该`MANIFEST.MF`文件的文件夹以及另一个文件夹，该文件夹`services`包含以下文件，该文件`org.codehaus.groovy.transform.ASTTransformation`仅包含一个字符串：类的规范名称`...Transformer`。

现在，如果我尝试做`grails clean`一切都很好，但是如果我尝试运行`grails package-plugin`控制台会出现`java.lang.ClassNotFoundException`.

从 Stacktrace 剪辑：

```
| Packaging Grails application...

| Error Fatal error during compilation org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed:

Could not instantiate global transform class my.package.ast.LoggingTransformation specified at jar:file:/C:/Source/MyGrailsAST/lib/replace-logging-logback-ast.jar!/META-INF/services/org.codehaus.groovy.transform.ASTTransformation  because of exception java.lang.ClassNotFoundException: my.package.ast.LoggingTransformation

1 error

org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed:

Could not instantiate global transform class my.package.ast.LoggingTransformation specified at jar:file:/C:/Source/MyGrailsAST/lib/replace-logging-logback-ast.jar!/META-INF/services/org.codehaus.groovy.transform.ASTTransformation  because of exception java.lang.ClassNotFoundException: my.package.ast.LoggingTransformation 
```

有没有人对处理 Grails 插件有一些经验，`AstTransformer`可以给我一些建议吗？有没有我至今没见过的好教程？

请告诉我 ;）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T15:44:35.850

因此，经过一些研究、浏览并最终在 Grails 邮件列表中询问（请参阅邮件列表存档：[http](http://grails.1312388.n4.nabble.com/Grails-user-f1312389.html) ://grails.1312388.n4.nabble.com/Grails-user-f1312389.html ，我找到了解决方案。

我的目标是创建一个**Globals ASTTransformation**，将一个`org.slf4j.Logger`对象而不是通常的`org.apache.commons.logging.Log`对象注入到每个 Artefact 类中而无需注释。

所以，这里是步骤：

我创建了类似于[https://github.com/grails/grails-core/blob/master/grails-logging/src/main/groovy/org/codehaus/groovy/grails/compiler/logging/LoggingTransformer.java](https://github.com/grails/grails-core/blob/master/grails-logging/src/main/groovy/org/codehaus/groovy/grails/compiler/logging/LoggingTransformer.java)的 Java 类但是用我自己的`org.slf4j.Logger`对象实现。将 Java.class 放在以下包下至关重要：`org.codehaus.groovy.grails.compiler`as

> Grails 会扫描此包中带有 @AstTransformer 注释的类。（*格雷姆·罗彻*）

`MANIFEST.MF`并将其与文件夹中的文件一起打包到 JAR中`META-INF/`。*正如Graeme Rocher*`META-INF/services`所说，不需要包含所有内容的目录：

 *> 你不需要 META-INF/services 的东西，我会删除它，因为它可能会使事情复杂化。

所以，我猜这个陈述与我的具体问题更相关，因为我`@AstTransformer`的插件中只有一个类，但这只是一个猜测。而且我还没有搜索有关此主题的更多信息。*也许这里需要这个的其他一些开发人员可以做一些研究并在这个线程中分享他的解决方案......*

JAR 应该被导入插件并放在`lib/`目录下。在这之后你应该可以做`grails clean`,`grails compile`和`grails package-plugin`。

如果您想像`log`我一样替换实现，您应该从指定项目的类路径中排除`grails-logging`和`grails-plugin-log4j`JAR。这是在`BuildConfig.groovy`文件中完成的：

```
inherits("global") {
  excludes "grails-plugin-log4j", "grails-logging"
} 
```

现在安装你的插件`grails install-plugin \path\to\plugin.zip`，一切都应该按预期工作。

希望这可以帮助...*

# jquery - 隐藏父 DIV 如果 是空的

> ID：13829190
> 
> 赞同：1
> 
> 时间：2012-12-11T21:58:07.380
> 
> 标签：jquery

我知道这必须非常简单，但我一直在用头撞墙。我的 HTML 是：

```
<div class="awardsparent">
<h4>AWARDS</h4>
<ul class="awards"><li></li></ul>
</div> 
```

如果 ul.awards li 为空，我正在尝试隐藏容器 div.awardsparent。这是我的 jQuery 代码：

```
$(function() {          
  if($('ul.awards li:empty')) {
  $('div.awardsparent').hide();
    }
}); 
```

谢谢！如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:00:23.413

尝试：

```
if ($('ul.awards li').is(':empty')) {
    $('div.awardsparent').hide();
}​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/Z6HeG/)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-11T22:02:33.067

从技术上讲，您甚至可能不需要 if 测试，只需让 jQuery 的空选择器发挥作用即可。

这一个班轮应该做到这一点。

`$("ul.awards li:empty").closest('div.awardsparent').hide()`

**编辑：**空选择器我的意思是如果`$("ul.awards li:empty")`返回一些东西，那么它会隐藏父级，但如果选择是空的，它会默默地忽略它，`closest()`因为没有任何东西可以应用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T21:59:38.640

尝试使用`.length`，如：

```
if ($("ul.awards li:empty").length) 
```

# c++ - C++ 定时器实现

> ID：13829191
> 
> 赞同：1
> 
> 时间：2012-12-11T21:58:09.477
> 
> 标签：c++, timer, clock

我正在尝试在 C++ 中实现一个“计时器”功能，以便程序在几秒钟后执行某些*操作。*然而，我得到了意想不到的结果。

```
short e, sum;
clock_t start;
double duration=0;

for (e=0; e<4; e++) {
    start = clock();
    while (duration < 1) {

        duration = (clock() - start)/(double)CLOCKS_PER_SEC;
    }
    cout << duration;
    duration = 0;
    sum += e;
    /* Calculate EPOCH error */
    cout << e;
}
cout << "\n" << e<< "\n"; 
```

我期望的结果是：

*   每秒控制台输出，后跟 e (0,1,2,3)
*   在执行结束时，我希望总和为 0+1+2+3 = 6，

获得的结果：

*   控制台输出后跟 e，在执行完成时全部放在一起
*   总和 = 6

我发现不确定的是，为什么程序会在执行完成之前打印到控制台，而不是像预期的那样每秒打印一次？

干杯，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:05:15.580

您的问题是循环期间未刷新输出流。实际上将文本写入控制台有点昂贵。因此，输入被缓冲，并且仅在刷新发生时才写入控制台。刷新流可以通过流来完成`std::flush`：

```
 cout << e<<std::flush; 
```

`std::endl`除了添加换行符之外，还将刷新流（写入`\n` **也**可以这样做，但这不能保证）。

作为旁注：您可能需要考虑在数字之间添加某种分隔符以使输出可读。

# javascript - 获取文件上传到隐藏文本框的值

> ID：13829192
> 
> 赞同：0
> 
> 时间：2012-12-11T21:58:19.453
> 
> 标签：javascript, jquery, html

我试图在选择文件后立即将值或文件路径从 html 文件上传控件获取到隐藏的输入文本框。

```
<input type="file" name="some_name" id="file" />
<input type="text" name="text_name" id="abc" style="display:none;" value=""/> 
```

我的脚本看起来像：

```
$('#file').live('change', function(){ alert("yes"); }); 
```

所以我得到了警告框，但我想将隐藏输入字段的值更改为我选择的文件的路径。非常感谢解决此问题的任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-11T22:02:40.707

通常你用 获得一个元素的值`$('#elementId').val()`，但在 an 的情况下`<input type="file">`你不能，因为安全限制。没有办法知道本地文件路径（至少没有一个在所有浏览器上都能始终如一地工作）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T22:07:54.700

要获取上传控件的文件路径，`<input type='file'>`您可以执行以下操作：

```
var value = $('#elementID').val();
var value = value.substr(value.lastIndexOf('\\') + 1); 
```

这将修剪文件名之前的任何文件路径。在 IE 和 Firefox 的情况下是完整的文件路径，在 Chrome 和 Safari 的情况下是`C:\Fake Path`.

请参阅相关的 jsfiddle：

[小提琴](http://jsfiddle.net/A8ysN/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T22:04:52.740

行得通吗？

```
$('#file').change(function() {
  $('#abc').val($(this).val());
}); 
```

我想它没有：见 bfavaretto 回答。

# objective-c - ReactiveCocoa 0.10.0 中的 selectMany 在哪里

> ID：13829198
> 
> 赞同：1
> 
> 时间：2012-12-11T21:59:06.357
> 
> 标签：objective-c, cocoa, reactive-programming

ReactiveCocoa API 最近发生了一些重大变化，我在 0.10.0 版本中找不到 selectMany 运算符的替代函数。

```
// RACSubscribableProtocol.h in version 0.8.2
// Gets a new subscribable for every `next` and sends `next` when any of those
// subscribables do.
- (RACSubscribable *)selectMany:(id<RACSubscribable> (^)(id x))selectBlock; 
```

我看到 RACSubscribable 变成了 RACSignal 但它没有 selectMany 运算符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T07:49:10.207

答案是`-[RACStream flattenMap:]`

感谢[https://github.com/ReactiveCocoa/ReactiveCocoa/issues/176的回复](https://github.com/ReactiveCocoa/ReactiveCocoa/issues/176)

# javascript - 在 Safari 扩展中使用 jQuery

> ID：13829210
> 
> 赞同：-1
> 
> 时间：2012-12-11T22:00:10.453
> 
> 标签：javascript, jquery, macos, safari, safari-extension

由于某种原因，我的 global.html 文件中的 jquery 对我不起作用。

这是我的 global.html 文件中的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.js"></script>
    <title>Hello World</title>
    <meta name="generator" content="myHTMLEdit | www.myownapp.com" />
    <script type="text/javascript">

    function performCommand(event)
    {
        if (event.command === "alert") {
        alert("event fired...");

            var $x = $("meta[property=og:image]").attr("content");
            alert($x);
            alert("completed.");
        }
    }
    function validateCommand(event)
    {
        if (event.command === "alert") {
            event.target.disabled = !event.target.browserWindow.activeTab.url;
        }
    }
    safari.application.addEventListener("command", performCommand, true);
    safari.application.addEventListener("validate", validateCommand, true);
    </script>
</head>
<body>
</body>
</html> 
```

我正在使用警报来查看我的 jquery 是否正常工作。它会提醒“事件触发......”但会停在那里（没有第二个警报）。但是，如果我删除两行 jquery，则会弹出两个警报。我正在创建一个工具栏项，当我单击它时，如果可以帮助您解决此问题，则会触发该事件。

按检查全局页面时只有一个错误

![错误](../Images/f62d80e1368aa5c80727f2ac52ccc400.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T13:54:56.677

您的选择器语法无效。如果您检查[此 JS](http://jsfiddle.net/H8Pxe/)并检查您的 javascript 控制台，您将看到错误消息

```
Uncaught Error: Syntax error, unrecognized expression: meta[property=og:image] 
```

我不知道你的`meta`标签是什么样子，但如果它像小提琴一样，选择器就像

```
$('meta[og="image"]') 
```

正如您在[jQuery 参考](http://api.jquery.com/attribute-equals-selector/)中看到的那样。

*未来问题的注意事项：如果您发布完整的错误消息而不是仅包含部分错误消息的图像，这将更容易解决。*

# python - 在python中计算JSON对象

> ID：13829211
> 
> 赞同：0
> 
> 时间：2012-12-11T22:00:13.930
> 
> 标签：python, json, object, count

我想计算结果 JSON 对象的数量：我该怎么办？

我有这个功能：（问题出在“for i in r:”）

```
import urllib
import json
from classes import ricerca_IMDB

def search_IMDB (titolo):
    sito='http://www.omdbapi.com/?s='+titolo

    r=0
    r=json.loads(urllib.urlopen(sito).read())

    i=0
    filmList = []
    try:
        for i in r:
            filmList.append(ricerca_IMDB(r['Search'][i]['Title'], r['Search'][i]['Year'], r['Search'][i]['imdbID']))
    except:
        filmList = []

    return filmList 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:03:13.083

你已经*完全*搞砸了你的类型处理。迭代一个序列会[产生元素](http://docs.python.org/2/tutorial/controlflow.html#for-statements)。

```
for i in r['Search']:
  filmList.append(ricerca_IMDB(i['Title'], i['Year'], i['imdbID'])) 
```

# php - 在 xml 上使用 xpath 接收此错误：调用非对象上的成员函数 getAttribute()

> ID：13829215
> 
> 赞同：0
> 
> 时间：2012-12-11T22:00:28.953
> 
> 标签：php, xml, xpath, xml-parsing

我正在使用 xpath 在我的 xml 中查询“名称为“FT”的结果项，但我知道某些结果项没有，因为它是实时提要。我能否为这些“非对象”分配一个值所以我可以将它们输入到我的 mysql 以及返回的值中吗？

以下是我的 xml 的部分结果项：

```
 <live>
    <Match ct="0" id="771597" LastPeriod="2 HF" LeagueCode="19984" LeagueSort="1"              LeagueType="LEAGUE" startTime="15:00" status="2 HF" statustype="live" type="2" visible="1">

        <Home id="11676" name="Manchester City" standing="1"/>
    <Away id="10826" name="Newcastle United" standing="3"/>

        <Results>
        <Result id="1" name="CURRENT" value="1-1"/>
            <Result id="2" name="FT" value="1-1"/>
            <Result id="3" name="HT" value="1-0"/>
        </Results>
    </Match>

    <Match ct="0" id="771599" LastPeriod="1 HF" LeagueCode="19984" LeagueSort="1" LeagueType="LEAGUE" startTime="16:00" status="2 HF" statustype="live" type="2" visible="1">

        <Home id="11678" name="Norwich City" standing="1"/>
    <Away id="10828" name="West Ham United" standing="3"/>

    <Results>
            <Result id="1" name="Current" value="2-3"/>
            <Result id="2" name="HT" value="1-3"/>
        </Results>
    </Match>
    </live> 
```

我正在尝试通过以下 php 获取所有名称为 'FT' 的分数：

```
$result = $xpath->query('./Results/Result[@name="FT"]', $match);
    $halftimescore = $result->item(0)->getAttribute("value"); 
```

我也改变了上面的：

```
 $result = $xpath->query('./Results/Result[@name="FT"]', $match);

      if($result->length > 0) {
      $halftimescore = $result->item(0)->getAttribute("value");
} 
```

这消除了错误，但我得到 FT 值 1-1、3-0，对于非对象，它重复 3-0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T09:53:19.283

您的 xpath 查询似乎是在`$matches`.

如果 current 没有 FT 结果，如果您没有在循环开始时初始化它的值，则保持前一个的值是`<Match>`正常的。`$halftimescore`

您需要`$halftimescore`为每个初始化`<Match>`

```
$halftimescore = null;
$result = $xpath->query('./Results/Result[@name="FT"]', $match);
if($result->length > 0) {
  $halftimescore = $result->item(0)->getAttribute("value");
} 
```

或者使用 else 语句：

```
$result = $xpath->query('./Results/Result[@name="FT"]', $match);
if($result->length > 0) {
  $halftimescore = $result->item(0)->getAttribute("value");
} else {
  $halftimescore = null;
} 
```

顺便说一句，由于一场比赛只能有一个 FT 分数，我会用它`$result->length === 1`来测试 xpath 结果。

# iphone - iphone -- 尽管 ARC 内存泄漏

> ID：13829216
> 
> 赞同：-5
> 
> 时间：2012-12-11T22:00:36.317
> 
> 标签：iphone, objective-c, ios, memory-management, xcode4.5

尽管启用了自动引用计数，但我遇到了内存泄漏。

我做了一些调试，发现应用程序获取此输出的问题： `*** error: can't allocate region*** set a breakpoint in malloc_error_break to debug`

我追踪到这一点：

```
if (currentTime < 60) {
    currentTimeMin = 0;
    ct.text = [NSString stringWithFormat:@"%i:%i", currentTimeMin, currentTime];
}
if (currentTime >= 60) {
    currentTimeMin = 1;
    ct.text = [NSString stringWithFormat:@"%i:%i", currentTimeMin, currentTime -60];
}
if (currentTime >= 120) {
    currentTimeMin = 2;
    ct.text = [NSString stringWithFormat:@"%i:%i", currentTimeMin, currentTime -120];
}
if (currentTime >= 180) {
    currentTimeMin = 3;
    ct.text = [NSString stringWithFormat:@"%i:%i", currentTimeMin, currentTime -180];
}
if (currentTime >= 240) {
    currentTimeMin = 4;
    ct.text = [NSString stringWithFormat:@"%i:%i", currentTimeMin, currentTime -240];
}
if (totalTime < 60) {
    totalTimeMin = 0;
    tt.text = [NSString stringWithFormat:@"%i:%i", totalTimeMin, totalTime];
}
if (totalTime >= 60) {
    totalTimeMin = 1;
    tt.text = [NSString stringWithFormat:@"%i:%i", totalTimeMin, totalTime -60];
}
if (totalTime >= 120) {
    totalTimeMin = 2;
    tt.text = [NSString stringWithFormat:@"%i:%i", totalTimeMin, totalTime -120];
}
if (totalTime >= 180) {
    totalTimeMin = 3;
    tt.text = [NSString stringWithFormat:@"%i:%i", totalTimeMin, totalTime -180];
}
if (totalTime >= 240) {
    totalTimeMin = 4;
    tt.text = [NSString stringWithFormat:@"%i:%i", totalTimeMin, totalTime -240];
} 
```

我认为问题出在标签上： ct 和 tt 但我不确定，似乎也无法弄清楚原因。直到一天前我对 UITableVIews 进行了一些试验，一切都运行良好。

此致！马丁

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:19:37.833

这段代码是否在循环中？如果是，您需要将代码放入自动释放池中。

```
while(someStuff) {
    @autoreleasepool {
        //Your code here
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:27:44.280

那段代码不应该导致泄漏。你的错误在别处。启用保护 malloc 并阅读有关调试和分析 Objective-c 的信息。

# android - 如何禁用/启用进度对话框按钮

> ID：13829220
> 
> 赞同：5
> 
> 时间：2012-12-11T22:00:52.770
> 
> 标签：android, progressdialog

我想显示一个进度对话框，它只会在需要时显示“关闭”按钮，例如当进度值达到其最大值时。在那个“关闭”按钮上，我想关闭对话框。我用否定按钮制作了进度对话框，当用户单击它时我可以将其关闭，但我不希望“关闭”按钮在我想要或进度完成时一直可见/启用。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-26T21:53:43.560

为了建立纪尧姆的评论和卡里姆的回答，您可以隐藏/显示或启用/禁用 ProgressDialog 上的按钮，如下所示：

```
ProgressDialog dlg = new ProgressDialog(this);
dlg.setButton(ProgressDialog.BUTTON_NEUTRAL, 
              "Close", 
              new DialogInterface.OnClickListener() {                   
                        @Override
                        public void onClick(DialogInterface dialog, int which) {
                            //button click stuff here
                        }
                    });

dlg.show();    
dlg.getButton(ProgressDialog.BUTTON_NEUTRAL).setEnabled(false);
//or alternatively
//dlg.getButton(ProgressDialog.BUTTON_NEUTRAL).setVisibility(View.INVISIBLE); 
```

`Button`任务完成后，您可以稍后启用。一定要`getButton`在你打电话后打电话`show`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T00:19:55.927

您应该使用 ProgressBar 和 Button 构建自定义对话框。然后使用 Button.setVisibility(View.VISIBLE) 和 Button.setVisibility(View.INVISIBLE)

# jquery - .html() 的 Jquery 翻转问题

> ID：13829223
> 
> 赞同：0
> 
> 时间：2012-12-11T22:01:19.813
> 
> 标签：jquery, wordpress, twitter-bootstrap

所以我有一段 jquery 假设从子菜单中获取 html 并将其显示为翻转（见图）。问题是，根据[.html 文档](http://api.jquery.com/html/)，所有 .html() 所做的只是返回该元素的 html，我需要在获取该 html 后“重新编译”：

```
jQuery('#adminmenu li.wp-not-current-submenu.wp-has-submenu, .folded #adminmenu li.wp-has-submenu').popover({       
    title: function() {
        var title = jQuery(this).find('a.menu-top').html();
        return title;
    },
    content: function() {
        var submenu = jQuery(this).find('.wp-submenu').html();
        return submenu;
    },
    trigger: 'hover'
}); 
```

其中显示：

[![](../Images/486e9c7148a85115069ce6897760daa2.png)](https://i.stack.imgur.com/Cni4k.png)

我希望这可以呈现在框内显示的 html。你们中的一些人可以说是的，我正在使用 twitter 引导带。我粘贴的功能负责给我你看到的翻转效果 - 有明显的故障。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:23:02.843

尝试添加`html: true`选项...

```
.popover({  
    html: true,
    title: function() {
    ... etc ...
    }
}) 
```

# java - Java & JTar - 如何使用 JTar 在文件夹中添加文件？

> ID：13829225
> 
> 赞同：1
> 
> 时间：2012-12-11T22:01:21.590
> 
> 标签：java, windows

Windows - 我正在尝试使用 JTar 库创建一个新的 Tar 文件，其中包含以下内容......

```
MyTarFile.tar--|
               |--MyFolder--|
                            |--MyFile.zip 
```

我可以在 MyTarFile 的根目录中使用文件夹和 zip 文件创建它，但我不知道（我环顾四周）如何创建该文件夹并在其中包含 zip 文件。我需要知道 TarEntry(s) 使用什么（文件对象）（它是一个用于文件夹，一个用于文件......还是一个用于两者？）以及 InputStream 应该是什么样子（我相信zip 文件只有一个，但不确定）。我正在尝试创建一个文件来模仿现有格式，因此我无法选择只是丢失该文件夹，因为使用该文件的软件会寻找它。我可以将 zip 文件添加到实际文件系统上的 MyFolder 文件夹中（同样，这是在 Windows 上），然后再进行 taring 或不...任何工作都可以。

我已经尝试过完整路径和相对路径（似乎 InputStream 必须有完整路径）但没有运气。除了切换库之外，其他想法都用完了（也许 JTar 不支持这一点）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:32:06.020

在没有看到您已经写过的内容的情况下，这是我回答的最佳尝试。我对 JTar 不熟悉，但是在查看了他们[主页](http://code.google.com/p/jtar/)上的示例后，我编写了一个快速测试程序，该程序创建了一个 tar，其中一个文件位于 tar 的根目录中，一个文件位于 tar 的目录中，我相信是你正在尝试做的事情。您感兴趣的代码是这样的：

```
TarEntry tarEntry = new TarEntry(new File("/Users/userGuy/Documents/students.xml"),"students.xml");
TarEntry otherTarEntry = new TarEntry(new File("/Users/userGuy/Documents/students2.xml"),"inner-dir/students2.xml"); 
```

请注意，第二个 tar 条目`otherTarEntry`是使用相对路径作为构造`entryName`函数中的参数进行实例化的`TarEntry`。这是一个名称不佳的参数，因为从技术上讲，它是 tar 中文件的路径，*而*不仅仅是名称。

使用上面的示例文件名，您的代码可能如下所示：

```
TarEntry tarEntry = new TarEntry(new File("<path to file>"),"MyFolder/MyFile.zip"); 
```

# export - 用spring mvc显示标签库

> ID：13829226
> 
> 赞同：2
> 
> 时间：2012-12-11T22:01:25.210
> 
> 标签：export, displaytag

我正在使用 spring mvc 开发一个 portlet。我正在使用显示标签库导出数据 excel、csv、xml 等。

我正在列出像上面这样的真实值，

1.  ad Soyad（列名）

2.  尔迪卡亚

    3.serkan gurbuz

我的jsp文件这个，

```
 <%@ page buffer = "16kb" %>
<%@ taglib prefix="portlet" uri="http://java.sun.com/portlet_2_0"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ page contentType="text/html" isELIgnored="false"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<%@taglib uri="http://www.springframework.org/tags" prefix="spring" %>
<%@ taglib prefix="display" uri="http://displaytag.sf.net" %>
<%@ taglib prefix="h" uri="http://java.sun.com/jsf/html" %>

 <display:table  name="userList"  export="true" > 

    <display:column property="ad" title="ID" sortable="true" headerClass="sortable" />
    <display:column property="soyad" sortable="true" headerClass="sortable" />

</display:table> 
```

当我单击 excel、csv 或 xml 时出现错误

在返回导出的数据之前无法重置响应。您没有使用导出过滤器。确保在 display:table 之前没有使用其他 jsp 标签，或参考 displaytag 文档了解如何配置导出过滤器（需要 j2ee 1.3）。

我已经 2 天没有解决错误。我正在使用显示 1.2 jar 和其他所需的 jar。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-06T07:25:34.737

您需要在`web.xml`. 这将有助于将内容转换为预期的格式。阅读以下链接以了解详细信息。

[导出过滤器？那是什么？](http://displaytag.sourceforge.net/11/export_filter.html)

# javascript - 具有多个参数的节点纤程/未来回调

> ID：13829227
> 
> 赞同：2
> 
> 时间：2012-12-11T22:01:33.983
> 
> 标签：javascript, node.js, future, node-fibers

期货如何处理具有多个参数的回调？这对于我可以用于期货的几乎所有用途都至关重要。github 示例显示它只处理一个参数。

[Github 自述文件](https://github.com/laverdet/node-fibers)中的示例是

```
var fileNames = readdir('.').wait(); 
```

但是 mysql 调用之类的东西呢

```
client.query("select * from employees", function(err, results, fields) {
    // callback function returns employees array
    callback(results);
}); 
```

我如何使用期货方法获得这三个（ `err`、、`results`和） ？`fields``wait()`

**编辑**

实验告诉我，回调的第一个参数，在这种情况下`err`，总是被视为错误，如果值是真实的，就会被抛出。第二个参数被赋值。尽我所能忽略任何进一步的论点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-12T07:03:39.067

为 client.query 创建一个包装器，返回一个包含两个结果的*数据*参数。

```
 client.prototype.query2 = function ( sql, callback ) {
      this.query(sql,
              function(err, results, fields) {
                  var data={result:result, fields:fields};
                  callback(err,data);
              }
 }; 
```

我最近创建了比“futures”更简单的抽象，也是基于 Fibers。我还没有使用真实世界的数据库示例测试我的代码。请尝试一下，如果可以的话帮我测试一下：[https ://github.com/luciotato/waitfor](https://github.com/luciotato/waitfor)

# c++ - 100% 确定的快速素性测试？

> ID：13829229
> 
> 赞同：5
> 
> 时间：2012-12-11T22:01:39.750
> 
> 标签：c++, algorithm, math, primes, gmp

我将 GMP（带 MPIR）用于任意大小的数据类型。我也使用了它的素数测试函数，它使用了 Miller-Rabin 方法，但它并不准确。这就是我想要解决的问题。

通过使用蛮力和 sqrt 方法，我能够确认数字 18446744073709551253 是素数。

有没有办法以 100% 的准确率检查大数是否为素数？

*   它不应该使用太多的内存/存储空间，几兆字节是可以接受的。

*   它应该比我使用的 sqrt 方法更快。

*   它应该适用于大小至少为 64 位或更大的数字。

*   最后，它应该是 100% 准确的，没有可能！

我有什么选择？

虽然我可以使用蛮力方法（对于 64 位数字），但出于兴趣，我想要更快、更大。此外，64 位数字检查太慢：总共 43 秒！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-11T22:07:04.193

对于非常大的数字，[AKS 素数测试](http://en.wikipedia.org/wiki/AKS_primality_test)是一种确定性素数测试，运行时间为 O(log ^(7.5) n log log n)，其中 n 是感兴趣的数字。这比 O(√n) 算法要快得多。但是，该算法具有较大的常数因子，因此在您的数字变得相当大之前它是不实用的。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-12T13:23:04.033

一般来说，100% 的确定性在物理计算机上是不可能的，因为某些组件在不可见的情况下发生故障并且最后给出的答案不正确的可能性很小但有限。鉴于这一事实，您可以运行足够多的概率 Miller-Rabin 测试，以证明数字复合的概率远小于硬件发生故障的概率。测试高达 1 in 2^256 的确定性水平并不难：

```
boolean isPrime(num)
  limit <- 256
  certainty <- 0
  while (certainty < limit)
    if (millerRabin returns notPrime)
      return false
      exit
    else
      certainty <- certainty + 2
    endif
  endwhile
  return true
end isPrime 
```

这将测试该数字是否为素数，确定性为 2 ^ 256 中的 1。每个 MR 测试将确定性增加四倍。我已经看到了由此产生的素数，称为“工业强度素数”，对于所有实际目的来说都足够好，但对于理论上的数学确定性来说还不够。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-16T07:22:46.537

证明的方法取决于您要证明的素数的类型（例如，梅森素数有证明素数的特殊方法仅适用于它们）和十进制数字的大小。如果您正在查看数百个数字，那么只有一种解决方案，尽管不够充分：AKS 算法。对于足够大的素数，它明显比其他素数证明算法快，但是当它变得有用时，它会花费很长时间，以至于它真的不值得麻烦。

大数的素性证明仍然是一个尚未充分解决的问题。如果是这样，EFF 奖项将全部颁发，密码学将出现一些问题，不是因为素数列表，而是因为用于找到它们的方法。

我相信，在不久的将来，会出现一种证明素数的新算法，它不依赖于预先生成的直到 n 的平方根的素数列表，并且不会对确保平方根下的所有素数（以及许多非素数）都被用作 n 素数的见证。这种新算法可能依赖于比解析数论使用的数学概念简单得多的数学概念。素数中有模式，这是肯定的。识别这些模式完全是另一回事。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-12T14:01:31.347

对于小*n*，试分工；那里的限制可能在 10^12 左右。对于稍大的*n*，有各种研究（参见 Gerhard Jaeschke 和 Zhou Zhang 的作品）计算各种 Miller-Rabin 基集合的最小伪素数；这将带你到大约 10^25。在那之后，事情变得艰难。

素数证明的“大炮”是 APRCL 方法（它可能被称为雅可比和或高斯和）和 ECPP 方法（基于椭圆曲线）。两者都很复杂，所以你会想找到一个实现，不要自己写。这些方法都可以处理几百位数的数字。

AKS方法被证明是多项式时间，并且易于实现，但比例常数很高，因此在实践中没有用处。

如果您可以分解*n* -1，甚至部分分解它，Pocklington 的方法可以确定*n*的素数。Pocklington 的方法本身很快，但因式分解可能不会。

对于所有这些，您希望在尝试证明某个数字之前合理地确定它是素数。如果你的数不是素数，所有这些方法都会正确地确定这一点，但首先它们会浪费很多时间来试图证明一个合数是素数。

我的博客上有[AKS](http://programmingpraxis.com/2012/10/05/aks-primality-prover-part-2/)和[Pocklington](http://programmingpraxis.com/2012/09/28/pocklingtons-n-1-primality-prover/)的实现。

# scala - 以交互模式从 Scala 启动外部控制台应用程序

> ID：13829230
> 
> 赞同：2
> 
> 时间：2012-12-11T22:01:39.607
> 
> 标签：scala

我正在使用 scala.sys.process 从我的 Scala 代码中启动一个外部控制台应用程序。但是，当控制台应用程序需要用户输入时，我遇到了障碍。

基本上，当我启动控制台应用程序时

```
Seq("powershell" , "myConsoleApp.exe").run 
```

myConsoleApp.exe 不会在它自己的“窗口”中启动。当我检查任务管理器时，我可以看到控制台应用程序正在运行。如果没有实际的窗口，我就无法真正键入任何内容。

我知道 Scala 可以将程序输出返回到 String 或 Stream[String] - 我猜 Scala 也可能能够通过管道输入到外部进程。

但是我真的不想在 Scala 中重写这样的逻辑，因为它们都已经在外部程序中可用了。

我想知道是否有办法在自己的窗口中启动外部控制台程序？或者这是 scala.sys.process 的一个缺点。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T21:59:40.507

经过一番谷歌搜索后，我发现我的问题更多地在于我称之为 powershell 的方式。这是一个适合我的解决方案：

```
Seq("powershell", "Start-Process", "myConsoleApp.exe") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T00:54:23.737

改编自这个 Java 答案[Show the CMD window with Java](https://stackoverflow.com/questions/666699/show-the-cmd-window-with-java)

```
import scala.sys.process._   
Seq("cmd", "/c", "start", "PowerShell.exe", "myConsoleApp.exe") run 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T01:01:09.197

这将从 Scala 控制台以交互方式运行，复制和`:paste`

```
val con = System.console
new java.lang.Thread() {
  val in = new java.lang.Thread() {
    override def run() {
      while (true) { 
        Thread.sleep(1)
        if (con.reader.ready)
          con.reader.read()        
      }       
    }
  }
  override def run() { 
    in.start()
    while (true) { 
      Thread.sleep(1000)
      con.printf("\nHai")
    }
  }
}.start() 
```

# php - PHP：MVC 用户身份验证和全局用户对象？

> ID：13829231
> 
> 赞同：2
> 
> 时间：2012-12-11T22:01:50.500
> 
> 标签：php, model-view-controller, authentication

我正在用 PHP 编写我的第一个真正的 MVC 应用程序。我没有使用框架，因为我的应用程序太小了，以至于我认为从头开始编写所有内容会更快。

在我的应用程序中，用户可以注册、登录然后写入/编辑/删除内容。每条内容都通过数据库中的用户标识列引用其所有者。

我现在要实施用户访问限制（从某种意义上说，用户只能查看/编辑/删除他们的 OWN 内容/项目/模型）。我想知道应该在哪里检查“有效访问”以及在哪里实例化用户对象。

我的意思是，我肯定需要有关控制器、模型和视图中当前用户的信息。所以我在考虑是否有一个全局用户对象（在 index.php 中定义）来存储所有用户信息，这样我就可以从应用程序的每个部分轻松访问它。

目前，此代码段授予我的控制器访问用户信息的权限，然后我还将这些信息存储在传递给视图的数据数组中：

```
class Controller {
    protected $data, $id, $user;
    public function __construct($action = null, $data = null) {
        if (User::isLoggedIn()) {
            $this->user = new User($_SESSION['user']);
            $this->data['user'] = $this->user;
        }
    }
} 
```

按照这种模式，我必须将用户信息传递给我创建的每个模型，或者让它们实例化自己的用户对象。

去这里的路是什么？全局用户对象，在每个模型中实例化还是将用户对象作为参数传递给模型和视图？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-12T13:21:07.130

这里有几点需要注意。首先：“然后我还将存储在传递给视图的数据数组中：”

在 MVC 中，视图可以直接访问模型，请在此处查看我的答案[How is MVC should work in CodeIgniter](https://stackoverflow.com/questions/13813046/how-is-mvc-supposed-to-work-in-codeigniter/13821880#13821880)以了解其概述。

其次，您的问题实际上是关于依赖管理的。全局变量（以及扩展的静态变量）是有问题的（[使所有变量成为全局变量，PHP](https://stackoverflow.com/questions/1909647/make-all-variables-global-php)，[全局变量是否坏？](https://stackoverflow.com/questions/484635/are-global-variables-bad)，[静态方法与否？](https://stackoverflow.com/questions/9560484/static-methods-or-not/11933130#11933130)）。首选方法是将完全构造的 $user 对象传递给需要它的类。

```
class Controller {
    protected $data, $id, $user;
    public function __construct(User $user) {
        if ($user->isLoggedIn()) {
    //...
       }
    }
} 
```

但是，在这种情况下，您不能拥有完全构造的用户对象，因为您需要在构造对象之前知道用户是否已登录，因此将映射器、工厂或 DAO 对象传递给构造函数并根据需要创建用户.

```
class Controller {
    protected $data, $id, $user;
    public function __construct(DataMapper $userMapper) {
        if (isset($_SESSION['user'])) {
    $user = $userMapper->find($_SESSION['user']);
       }
    }
} 
```

然而，最后，如果你接受我的第一点，Views 可以直接访问他们的模型，而不是从他们的控制器获取传递的数据，那么你的控制器可能甚至不需要知道用户是否登录。毕竟这是, 领域逻辑因此属于模型。

# javascript - 多次点击调用多个功能的按钮

> ID：13829240
> 
> 赞同：1
> 
> 时间：2012-12-11T22:02:24.103
> 
> 标签：javascript, jquery, function

我有一个带有上一个和下一个按钮的图像滑块。如何将另一个功能添加到下一个按钮以在第二次单击时滑动更多？

JavaScript：

```
$(document).ready(function(){
    var speed = 600;
    $('#navNext').click(function () {
        $('#carousel ul').animate({marginLeft:'-665px'}, speed);
    });

    $('#navPrev').click(function () {
        $('#carousel ul').animate({marginLeft:'1px'}, speed);
    });
}); 
```

HTML：

```
<a id="navNext" href="#" onclick="click(); return false"></a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:15:13.787

为此，您可以使用一个变量来跟踪按钮被单击的次数，在单击另一个按钮时将其重置，并使用该计数来决定动画的速度。

```
var nextClickCount = 0;
$('#navNext').click(function() {
    nextClickCount += 1;
    previousClickCount = 0;
    $('#carousel ul').animate({marginLeft:'-665px'}, nextClickCount * speed);
});
var previousClickCount = 0; //... 
```

# iis - d3 尝试在 IIS 上运行 d3js 示例时出现 406 错误

> ID：13829242
> 
> 赞同：1
> 
> 时间：2012-12-11T22:02:30.090
> 
> 标签：iis, d3.js

我已经设置了一个基本的 IIS 服务器，并试图演示一个 d3js 示例。首先，我使用示例代码创建一个 html 页面：

```
<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
  font: 10px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.bar {
  fill: steelblue;
}

.x.axis path {
  display: none;
}

</style>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script>

var margin = {top: 20, right: 20, bottom: 30, left: 40},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .1);

var y = d3.scale.linear()
    .rangeRound([height, 0]);

var color = d3.scale.ordinal()
    .range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56", "#d0743c", "#ff8c00"]);

var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left")
    .tickFormat(d3.format(".2s"));

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

d3.csv("data.csv", function(error, data) {
  color.domain(d3.keys(data[0]).filter(function(key) { return key !== "State"; }));

  data.forEach(function(d) {
    var y0 = 0;
    d.ages = color.domain().map(function(name) { return {name: name, y0: y0, y1: y0 += +d[name]}; });
    d.total = d.ages[d.ages.length - 1].y1;
  });

  data.sort(function(a, b) { return b.total - a.total; });

  x.domain(data.map(function(d) { return d.State; }));
  y.domain([0, d3.max(data, function(d) { return d.total; })]);

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("Population");

  var state = svg.selectAll(".state")
      .data(data)
    .enter().append("g")
      .attr("class", "g")
      .attr("transform", function(d) { return "translate(" + x(d.State) + ",0)"; });

  state.selectAll("rect")
      .data(function(d) { return d.ages; })
    .enter().append("rect")
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d.y1); })
      .attr("height", function(d) { return y(d.y0) - y(d.y1); })
      .style("fill", function(d) { return color(d.name); });

  var legend = svg.selectAll(".legend")
      .data(color.domain().slice().reverse())
    .enter().append("g")
      .attr("class", "legend")
      .attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });

  legend.append("rect")
      .attr("x", width - 18)
      .attr("width", 18)
      .attr("height", 18)
      .style("fill", color);

  legend.append("text")
      .attr("x", width - 24)
      .attr("y", 9)
      .attr("dy", ".35em")
      .style("text-anchor", "end")
      .text(function(d) { return d; });

});

</script> 
```

然后我创建 data.csv 文件：

```
State,Under 5 Years,5 to 13 Years,14 to 17 Years,18 to 24 Years,25 to 44 Years,45 to 64 Years,65 Years and Over
AL,310504,552339,259034,450818,1231572,1215966,641667
AK,52083,85640,42153,74257,198724,183159,50277
AZ,515910,828669,362642,601943,1804762,1523681,862573
AR,202070,343207,157204,264160,754420,727124,407205
CA,2704659,4499890,2159981,3853788,10604510,8819342,4114496
CO,358280,587154,261701,466194,1464939,1290094,511094
CT,211637,403658,196918,325110,916955,968967,478007
DE,59319,99496,47414,84464,230183,230528,121688
DC,36352,50439,25225,75569,193557,140043,70648
FL,1140516,1938695,925060,1607297,4782119,4746856,3187797
GA,740521,1250460,557860,919876,2846985,2389018,981024
HI,87207,134025,64011,124834,356237,331817,190067
ID,121746,201192,89702,147606,406247,375173,182150
IL,894368,1558919,725973,1311479,3596343,3239173,1575308
IN,443089,780199,361393,605863,1724528,1647881,813839
IA,201321,345409,165883,306398,750505,788485,444554
KS,202529,342134,155822,293114,728166,713663,366706
KY,284601,493536,229927,381394,1179637,1134283,565867
LA,310716,542341,254916,471275,1162463,1128771,540314
ME,71459,133656,69752,112682,331809,397911,199187
MD,371787,651923,316873,543470,1556225,1513754,679565
MA,383568,701752,341713,665879,1782449,1751508,871098
MI,625526,1179503,585169,974480,2628322,2706100,1304322
MN,358471,606802,289371,507289,1416063,1391878,650519
MS,220813,371502,174405,305964,764203,730133,371598
MO,399450,690476,331543,560463,1569626,1554812,805235
MT,61114,106088,53156,95232,236297,278241,137312
NE,132092,215265,99638,186657,457177,451756,240847
NV,199175,325650,142976,212379,769913,653357,296717
NH,75297,144235,73826,119114,345109,388250,169978
NJ,557421,1011656,478505,769321,2379649,2335168,1150941
NM,148323,241326,112801,203097,517154,501604,260051
NY,1208495,2141490,1058031,1999120,5355235,5120254,2607672
NC,652823,1097890,492964,883397,2575603,2380685,1139052
ND,41896,67358,33794,82629,154913,166615,94276
OH,743750,1340492,646135,1081734,3019147,3083815,1570837
OK,266547,438926,200562,369916,957085,918688,490637
OR,243483,424167,199925,338162,1044056,1036269,503998
PA,737462,1345341,679201,1203944,3157759,3414001,1910571
RI,60934,111408,56198,114502,277779,282321,147646
SC,303024,517803,245400,438147,1193112,1186019,596295
SD,58566,94438,45305,82869,196738,210178,116100
TN,416334,725948,336312,550612,1719433,1646623,819626
TX,2027307,3277946,1420518,2454721,7017731,5656528,2472223
UT,268916,413034,167685,329585,772024,538978,246202
VT,32635,62538,33757,61679,155419,188593,86649
VA,522672,887525,413004,768475,2203286,2033550,940577
WA,433119,750274,357782,610378,1850983,1762811,783877
WV,105435,189649,91074,157989,470749,514505,285067
WI,362277,640286,311849,553914,1487457,1522038,750146
WY,38253,60890,29314,53980,137338,147279,65614 
```

当我访问该页面时，什么都没有显示...快速浏览 fiddler 显示 html 内容下载正常（您也可以在 show source 中看到它）。您还可以通过从 url 访问它来直接查看 data.csv 文件

```
http://localhost/data.csv 
```

fiddler 中显示的问题是 d3js 尝试加载 CSV 文件时出现 406 错误。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:57:23.687

您的 HTTP 请求的**Accept**标头包含什么？Apache 可能配置为返回 406，因为 Accept 标头中的值不包括 CSV 返回的任何 MIME 类型。

请参阅 [http://blogs.msdn.com/b/ieinternals/archive/2011/03/27/http-406-not-acceptable-php-ie9-standards-mode-accepts-only-text_2f00_css-for-stylesheets.aspx](http://blogs.msdn.com/b/ieinternals/archive/2011/03/27/http-406-not-acceptable-php-ie9-standards-mode-accepts-only-text_2f00_css-for-stylesheets.aspx)对于有时在浏览器中看到的类似问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-22T01:27:49.687

使用 Visual Studio 在文件的属性中将 csv 文件的构建操作更改为“资源”。

# javascript - 从给定表单/容器中获取所有表单元素并创建可重用对象的函数

> ID：13829248
> 
> 赞同：0
> 
> 时间：2012-12-11T22:03:02.837
> 
> 标签：javascript, jquery, forms

好的，我正在尝试为自己创建一个可重用的函数，我最终可以返回给定容器（例如 div 或特定表单）中所有表单元素的对象。但是，我似乎坚持将实际的容器/表单传递给我的函数，以便它可以在元素上运行。

目前我有：

```
function findAllFormElements(formElem)
{
    //detect all form elemets on the page in a given form/container
    formObj = {};
    $(formElem ':input').each(function(key, val)
    {
        $(document).append(val+'<br>');
    });
    console.log(formObj);
} 
```

其中`formElem`预计是包含元素/表单元素，即：

```
<div class="something">
   <input type="text">
   <input type="text">
   <input type="text">
   <input type="text">
   <select>
     <option></option>
   </select>
   <textarea></textarea>
</div> 
```

或者

```
<form class="something">
   <input type="text">
   <input type="text">
   <input type="text">
   <input type="text">
   <select>
     <option></option>
   </select>
   <textarea></textarea>
</form> 
```

从长远来看，两者都是可接受的容器类型，因为该项目中的某些表单实际上没有表单标签。

授予它我当前的示例并没有完全描述我想要说的内容，因为它会将内容吐出到控制台，并将它们附加到`document`最终结果，但一旦我知道如何`formElem`正确传递参数，我就可以获得所有输入类型从直接`<input>`标签到`<select>`,`textarea`将是所有表单元素的对象，其中 id/name 是对象的键，如果有值的话。无论哪种方式，都只是想弄清楚这种捕获的最佳策略是什么。所以我可以遍历元素并获取这些信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:13:19.037

使用 jQuery `.serializeArray()`，我们可以轻松地抓取这些`<form>`元素并从中创建一个对象......

```
$('form').serializeArray(); // will turn into a key/value object 
```

由于您希望对某些`<div>`集合进行序列化，只需执行以下操作：

```
//turn that div (filled with inputs) into a form element
var tempForm = $('<form />', { html: $('#yourDiv').html() });

var objResult = tempForm.serializeArray(); // now serialize 
```

[jsFiddle 演示](http://jsfiddle.net/K592f/1/)

# java - 当我尝试运行我的 .jar 时，我在 java.library.path 异常中得到一个 no library

> ID：13829249
> 
> 赞同：0
> 
> 时间：2012-12-11T22:03:07.737
> 
> 标签：java, netbeans, jar, java.library.path

我浏览了许多帖子，并尝试了我发现收效甚微的方法。这是设置：

我用 Java 写了一个程序，运行良好，但我们需要切换相机。这台相机兼容吐温（恶心）。我使用 JTwain 重写了程序（非常简单），它在 netbeans 中运行得很好。我构建了它，它在我的计算机上运行得很好。但是，当我尝试传输 .jar（和配套库等）时，它运行良好，直到需要拍摄图像，然后我收到错误：

java.lang.UnsatisfiedLinkError：Java.library.path 中没有 aspireJTwain。

我尝试过引入基本 twain 包，添加系统环境变量，检查 java 发行版。我可以运行 JTwain 测试文件（以确保您拥有 JTwain 并且一切都很好）。

如果有人可以请帮忙，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:30:07.613

您能否检查以确保您已遵循[The Java Developer's Guide to JTwain v9 中的指示](http://asprise.com/product/jtwain/AspriseJTwain-DevGuide.pdf)。

**6.3 软件打包和分发**

> 您需要将两个关于 JTwain 的文件与您自己的二进制代码一起分发。一个是 JTwain.jar，它与任何其他 java 库一样，您只需将其复制并放在类路径中即可。另一个是本地库 AspriseJTwain.dll。“安装”这个 dll 文件有很多方法，您可以： 将包含本机库的文件夹添加到系统路径，或将本机库复制到 jre/bin 目录 - 将库“安装”到 JVM，或复制本地库到特定位置，例如 C:\AspriseJTwain.dll，在调用 SourceManage.instance() 之前，调用： SourceManage.setLibraryPath(“ C:\AspriseJTwain.dll ”);

# matlab - MATLAB刻度线VS网格的颜色

> ID：13829254
> 
> 赞同：2
> 
> 时间：2012-12-11T22:03:22.480
> 
> 标签：matlab, plot

因此，我试图保持 MATLAB 绘图网格的（通常）黑色，但我想将 x 轴和 y 轴颜色更改为白色。如果我做通常的 set(gca, 'xcolor', 'w'); （对于 y 也是如此），它将整个网格更改为白色，这不是我想要的。

是否有捷径可寻？

我在[这里](https://stackoverflow.com/questions/10227412/matlab-grid-lines-with-different-color-on-one-axis)查看了代码，但对我没有多大帮助。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-11T22:26:11.533

作为一个快速破解，你可以用你想要的颜色重新绘制轴并关闭网格：

```
plot(rand(10,1))
grid on

ax = copyobj(gca, gcf);
set(ax,'color','none','xgrid','off', 'xcolor','w', 'ygrid','off', 'ycolor','w') 
```

不优雅但有效：

![在此处输入图像描述](../Images/0f79e6ac4c11285f88bb3ab40a49d413.png)

# ruby - 如何使用捆绑器安装特定于平台的 Ruby 依赖项（宝石）？

> ID：13829256
> 
> 赞同：1
> 
> 时间：2012-12-11T22:03:42.283
> 
> 标签：ruby, bundler, platform

我需要在与 Internet 断开连接的环境中的多个平台上运行我的 Ruby 应用程序，因此我试图通过运行来打包应用程序的依赖项

```
bundle install --deployment 
```

这对第一个平台非常有用，但在后续平台上，它会在供应商/捆绑包中看到 gem，并拒绝重新安装 gem 并构建任何本机扩展。到目前为止，我发现的最好的解决方法是运行

```
bundle install --path <os-arch> 
```

但这需要扩充我的 Ruby 应用程序，以便它为每个平台上的 gem 依赖项提供正确的路径。有没有办法让 Ruby 应用程序无缝/透明？

# ruby-on-rails - Rails：如何在 Thin/Unicorn 等单线程服务器下处理 Thread.current 数据？

> ID：13829257
> 
> 赞同：5
> 
> 时间：2012-12-11T22:03:43.293
> 
> 标签：ruby-on-rails, thread-safety, thin, unicorn

由于 Thin/Unicorn 是单线程的，您如何处理 Thread.current/per-request 存储？

只是运行了一个简单的测试——在一个会话中设置一个键，从另一个会话中读取它——看起来它一直在同一个地方写入/读取。虽然不会在 WEBrick 上发生。

```
class TestController < ApplicationController
  def get
    render text: Thread.current[:xxx].inspect
  end

  def set
    Thread.current[:xxx] = 1

    render text: "SET to #{Thread.current[:xxx]}"
  end
end 
```

尝试添加`config.threadsafe!`到 application.rb，没有变化。

存储每个请求数据的正确方法是什么？

为什么会有使用 Thread.current 进行存储的 gem（包括 Rails 本身和倾斜）？他们如何克服这个问题？

难道 Thread.current 对每个请求*都是*安全的，但在请求后并不清楚，我需要自己做吗？

*   用 Rails 3.2.9 测试

# 更新

总结下面与@skalee 和@JesseWolgamott 的讨论以及我的发现——

Thread.current 取决于运行应用程序的服务器。尽管服务器可能会确保没有两个请求在同一个 Thread.current 上同时运行，但此哈希中的值**可能不会在请求之间被清除**，因此在使用情况下 - 必须将初始值设置为覆盖最后一个值。

有一些著名的 gem 使用 Thread.current，比如 Rails、tilt 和 draper。我*猜*如果它被禁止或不安全，他们就不会使用它。似乎他们都在使用哈希上的任何键之前设置了一个值（甚至在请求结束后将其设置回原始值）。

但总的来说，Thread.current 并不是按请求存储的最佳实践。在大多数情况下，更好的设计会起作用，但在某些情况下，使用`env`会有所帮助。它可以在控制器中使用，也可以在中间件中使用，并且可以注入到应用程序的任何位置。

**更新 2** - 就目前而言，draper 似乎错误地使用了 Thread.current。见[https://github.com/drapergem/draper/issues/390](https://github.com/drapergem/draper/issues/390)

**更新 3** - 该 draper 错误已修复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T12:10:05.017

虽然人们仍然警告不要使用`Thread.current`存储“线程全局”数据，但在 Rails 中可能正确的方法是`Thread.current`使用 Rack 中间件清除对象。Steve Labnik 编写了[request_store](https://github.com/steveklabnik/request_store) gem 来轻松做到这一点。gem 的源代码非常非常小，我建议您阅读它。

有趣的部分转载如下。

```
module RequestStore
  def self.store
    Thread.current[:request_store] ||= {}
  end

  def self.clear!
    Thread.current[:request_store] = {}
  end
end

module RequestStore
  class Middleware
    def initialize(app)
      @app = app
    end

    def call(env)
      RequestStore.clear!
      @app.call(env)
    end
  end
end 
```

请注意，清理*整个* `Thread.current`不是一个好习惯。request_store 基本上在做什么，是跟踪*您的应用程序*存储到 Thread.current 中的密钥，并在请求完成后将其清除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:10:58.387

您通常希望在会话中存储内容。如果你想要一些非常短暂的东西，请参阅[Rails 的 flash](http://guides.rubyonrails.org/action_controller_overview.html#the-flash)。每次请求都会清除它。任何依赖线程的方法都不会在不同的网络服务器上始终如一地工作。

另一种选择是修改`env`哈希：

```
env['some_number'] = 5 
```

BTW Unicorn 不仅仅是单线程的，它是分叉的。每次请求都会产生新进程（尽管听起来很吓人，但在 Linux 上非常有效）。因此，如果您在 Unicorn 中设置任何内容，即使是全局变量，它也不会持续到另一个请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-11T16:52:24.790

使用 , 的警告之一`Thread.current`是，对于重用线程或具有线程池的服务器，在每次请求后进行清理变得非常重要。

这正是[`request_store`](https://github.com/steveklabnik/request_store)gem 所提供的，一个类似的简单 API `Thread.current`，负责在每次请求后清理存储数据。

```
RequestStore[:items] = [] 
```

但请注意，gem 用于`Thread.current`保存 Store，因此它无法在每个请求有多个线程的多线程环境中正常工作。

为了规避这个问题，我实现了一个可以在同一请求的线程之间共享的存储。它被称为[`request_store_rails`](https://github.com/ElMassimo/request_store_rails)，用法非常相似：

```
RequestLocals[:items] = [] 
```

# facebook - facebook 图形 api getUser 返回 0

> ID：13829258
> 
> 赞同：0
> 
> 时间：2012-12-11T22:03:44.797
> 
> 标签：facebook, facebook-graph-api, sdk

我创建新应用程序并尝试获取用户 require_once 'facebook.php';

```
$this->fb = new Facebook(array(
          'appId'  => APPID,
          'secret' => APPSECRET,
          'cookie' => true
        ));
$user = $this->fb->getUser(); 
```

我正在使用新的 sdk 3.2.2。在我的测试环境中它的工作直到今天。但现在它总是返回 0。

有谁能够帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-12T22:11:03.527

例如，仅基于该代码没有登录处理`getLoginUrl()`，除非用户通过登录流程登录，否则`$user`将始终为零。

# c# - C#：MS 图表：SeriesCollection -> InvalidCastException？

> ID：13829259
> 
> 赞同：0
> 
> 时间：2012-12-11T22:03:47.800
> 
> 标签：c#, mschart, excel-interop, .net

在PPT 2010中获取字符系列的正确方法是什么。

我试过了

```
PowerPoint.SeriesCollection mySeriesCollection = (PowerPoint.SeriesCollection)
                                                           myChart.SeriesCollection(1); 
```

引发以下异常

```
Exception Type:        System.InvalidCastException 
```

此外，在 C# 中获取图表系列的正确调用是什么？

如果我尝试这种方式：

```
PowerPoint.Series mySeries = (PowerPoint.Series)myChart.SeriesCollection.Item(1); 
```

我收到以下编译错误：

```
error CS0119: 'Microsoft.Office.Interop.PowerPoint.Chart.SeriesCollection(object)'
is a 'method', which is not valid in the given context 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:01:25.373

你很近；您需要以`SeriesCollection`第一种方式调用该方法，并以第二种方式进行转换。

```
PowerPoint.Series mySeries = (PowerPoint.Series)myChart.SeriesCollection(1); 
```

# apache - apache 安全 https 重定向到非安全页面

> ID：13829270
> 
> 赞同：0
> 
> 时间：2012-12-11T22:04:31.817
> 
> 标签：apache, redirect

如何将 SSL 安全页面[https://www.mysite.com](https://www.mysite.com)的请求重定向 到非安全[http://www.mysite.com](http://www.mysite.com)

我试过这个，但没有奏效。

```
Options +FollowSymLinks
RewriteEngine on

RewriteCond %{HTTPS} on
RewriteRule (.*) http://%{HTTP_HOST}%{REQUEST_URI} 
```

我做了一个 phpinfo() 并在配置 >> apache2handler >> 加载模块部分下查看 mod_rewrite。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T18:23:00.543

将 R（重定向）标志添加到 RewriteRule，如下所示：

```
RewriteRule (.*) http://%{HTTP_HOST}%{REQUEST_URI} [R] 
```

默认情况下，重定向由 HTTP 状态 301 完成。如果你想通过特定的状态码重定向，例如“301 Moved Permanently”，你可以指定任何有效的重定向状态码（3xx）：

```
RewriteRule (.*) http://%{HTTP_HOST}%{REQUEST_URI} [R=301] 
```

检查[文档（Apache 模块 mod_rewrite）](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)了解详细信息。

# .net - 如何使用 ODBC + .net 连接到 Sybase SQL Anywhere v5.0 服务器

> ID：13829274
> 
> 赞同：1
> 
> 时间：2012-12-11T22:04:45.210
> 
> 标签：.net, odbc, sqlanywhere

我有一个旧的 myDemo.db 文件，它是由 Sybase SQL Anywhere 5.0 创建的。我需要创建一个 Windows 应用程序来访问该数据库，我已经尝试了所有可能的连接字符串（使用 ODBC），但没有一个有效。

我已经安装了 Sybase SQL Anywhere 5.0 服务器和客户端应用程序，在本地创建了服务器（通过服务管理器），我可以通过 ISQL 访问，但是当我尝试通过 .net windows 应用程序时，它不起作用。

最近，我安装了 Sybase 最新版本，但是当我尝试使用 Personal Server 应用程序创建 myDemo.db 时，无法正常工作，“myDemo.db 是由不同版本的软件创建的”。

有人可以帮忙吗？我需要使用什么来创建 ODBC 并连接到该数据库？谢谢

尝试使用 ODBC 时出现的错误：

错误 [08001] [Sybase][ODBC 驱动程序]无法连接到数据库服务器
错误 [01000] [Microsoft][ODBC 驱动程序管理器] 驱动程序不支持应用程序请求的 ODBC 行为版本（请参阅 SQLSetEnvAttr）。

代码

```
string conStr = "Driver={Sybase SQL Anywhere 5.0};Dsn=Prima;uid=dba;PWD=test";
OdbcConnection conn = new OdbcConnection(conStr);
conn.Open();

string sql = "select count(*) from ClienteCorretor";
OdbcCommand cmd = new OdbcCommand(sql, conn);
int result = cmd.ExecuteNonQuery();

if (conn.State != ConnectionState.Closed)
    conn.Close(); 
```

# javascript - (javascript) 或 (windows 中的 nodejs) iconv 从 utf-8 到 iso

> ID：13829278
> 
> 赞同：4
> 
> 时间：2012-12-11T22:05:05.003
> 
> 标签：javascript, windows, node.js, character-encoding, iconv

我正在使用 nodejs http.get 方法将数据发布到 php

但是 php 的字符集不是 UTF-8，它是 ISO-8859-9（土耳其语）

所以发布数据没有以正确的方式插入数据库，

这是我的节点 js 文件：

```
var data="ğüşıöç ĞÜŞİÖÇ"
var postdata="isim="+encodeURIComponent(data)+"";

var options2 = 
{
    host: "localhost",
    port: 80,
    path: "/bbb.php",
    method: 'POST',
    headers:{"Host":"localhost","Content-Length": postdata.length,'Content-Type': 'application/x-www-form-urlencoded'}
};

var post_req = http.get(options2, function (res) 
{
  var responseBody='';
  res.on('data', function (d) { responseBody += d; });
  res.on('end', function (d) 
  {
    sys.print(responseBody);
  });
}).on('error', function (e) {sys.print(e.message);});

post_req.write(postdata);
post_req.end(); 
```

这是 php 文件：

```
<?
header('Content-type: text/html; charset=ISO-8859-9');

$dbbaglanti=mysql_connect("localhost", "root", "");
mysql_select_db("db");
mysql_query("SET NAMES 'latin5'");

$isim = $_POST["isim"];
mysql_query("insert into deneme (isim) values ('".$isim."')");
?> 
```

数据被这样插入数据库中： ÄÃ¼ÅÄ±Ã¶Ã§ ÄÃÅÄ°ÃÃ

但我知道如果我在 php 中这样做：

```
$isim = iconv("utf-8","iso-8859-9",$_POST["isim"]); 
```

插入数据没有问题：ğüşıöçĞÜŞİÖÇ

那么我怎样才能以正确的方式做到这一点？我用谷歌搜索了很多次，我无法弄清楚我该怎么做。我知道 nodejs 有一些 iconv 扩展，但它们适用于 linux 而不是 windows。javascript或nodejs（windows）中有没有像iconv这样的方法？或 Windows 的任何扩展？或任何其他建议？

请不要说我将php的字符集更改为utf-8，我无法编辑php，我以localhost为例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:41:47.487

`encodeURIComponent`总是编码为 utf-8 （然后将生成的 utf-8 字节转换为百分比编码），所以我猜你必须使用一个库，或者滚动你自己的。我使用了我的库中的一些代码来制作：

```
var encodeURIComponentLatin5 = (function() {

    var latin5 = [
        0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD
        ,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD
        ,0x0020,0x0021,0x0022,0x0023,0x0024,0x0025,0x0026,0x0027,0x0028,0x0029,0x002A,0x002B,0x002C,0x002D,0x002E,0x002F
        ,0x0030,0x0031,0x0032,0x0033,0x0034,0x0035,0x0036,0x0037,0x0038,0x0039,0x003A,0x003B,0x003C,0x003D,0x003E,0x003F
        ,0x0040,0x0041,0x0042,0x0043,0x0044,0x0045,0x0046,0x0047,0x0048,0x0049,0x004A,0x004B,0x004C,0x004D,0x004E,0x004F
        ,0x0050,0x0051,0x0052,0x0053,0x0054,0x0055,0x0056,0x0057,0x0058,0x0059,0x005A,0x005B,0x005C,0x005D,0x005E,0x005F
        ,0x0060,0x0061,0x0062,0x0063,0x0064,0x0065,0x0066,0x0067,0x0068,0x0069,0x006A,0x006B,0x006C,0x006D,0x006E,0x006F
        ,0x0070,0x0071,0x0072,0x0073,0x0074,0x0075,0x0076,0x0077,0x0078,0x0079,0x007A,0x007B,0x007C,0x007D,0x007E,0xFFFD
        ,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD
        ,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD,0xFFFD
        ,0x00A0,0x00A1,0x00A2,0x00A3,0x00A4,0x00A5,0x00A6,0x00A7,0x00A8,0x00A9,0x00AA,0x00AB,0x00AC,0x00AD,0x00AE,0x00AF
        ,0x00B0,0x00B1,0x00B2,0x00B3,0x00B4,0x00B5,0x00B6,0x00B7,0x00B8,0x00B9,0x00BA,0x00BB,0x00BC,0x00BD,0x00BE,0x00BF
        ,0x00C0,0x00C1,0x00C2,0x00C3,0x00C4,0x00C5,0x00C6,0x00C7,0x00C8,0x00C9,0x00CA,0x00CB,0x00CC,0x00CD,0x00CE,0x00CF
        ,0x011E,0x00D1,0x00D2,0x00D3,0x00D4,0x00D5,0x00D6,0x00D7,0x00D8,0x00D9,0x00DA,0x00DB,0x00DC,0x0130,0x015E,0x00DF
        ,0x00E0,0x00E1,0x00E2,0x00E3,0x00E4,0x00E5,0x00E6,0x00E7,0x00E8,0x00E9,0x00EA,0x00EB,0x00EC,0x00ED,0x00EE,0x00EF
        ,0x011F,0x00F1,0x00F2,0x00F3,0x00F4,0x00F5,0x00F6,0x00F7,0x00F8,0x00F9,0x00FA,0x00FB,0x00FC,0x0131,0x015F,0x00FF
    ];

    var map = {};

    latin5.forEach( function(v,i) {
        map[v] = i;
    });

    function percentEncode( num ) {
        var str = num.toString(16);
        return "%" + (str.length < 2 ? "0" + str : str).toUpperCase(); 
    }

    return function( str ) {
        var code, i = 0, ret = [], cp;

        while( !isNaN( code = str.charCodeAt(i++) ) ) {
            cp = map[code];

            if( !cp || code === 0xFFFD ) {
                continue;
            }

            if(
                65 <= code && code <= 90 ||
                97 <= code && code <= 122 ||
                48 <= code && code <= 57 ||
                45 <= code && code <= 46 ||
                code === 95 ||
                code === 126
            ) {
                ret.push( str.charAt( i-1 ) );
            }
            else {
                ret.push( percentEncode( cp ) );
            }
        }

        return ret.join("");

    };
})();

var data="ğüşıöç ĞÜŞİÖÇ";
var postdata="isim="+encodeURIComponentLatin5(data)+""; 
//"isim=%F0%FC%FE%FD%F6%E7%20%D0%DC%DE%DD%D6%C7" 
```

# javascript - javascript 属性竞争条件

> ID：13829280
> 
> 赞同：0
> 
> 时间：2012-12-11T22:05:13.710
> 
> 标签：javascript, html, cordova

我在 iPhone 和 Android 上有一个 phonegap 项目。从表面上看，这个问题似乎是一种竞争条件，但我不明白它是如何发生的。用户可以单击具有设置对象属性的关闭回调的按钮，然后清除屏幕并加载主菜单。在代码中：

```
button.onclick = function (employee) {
    return function () {
        employee.task = "some task";
        returnToMenu();
    }
}(employees[i]); 
```

用户回到主菜单后，他们可以点击一个按钮，加载一个显示所有用户的屏幕。如果员工设置了该任务属性，则应对该员工的按钮进行额外的格式化。

```
if (employee.task)
    // style the button being created for this employee 
```

不知何故，如果单击速度足够快，则格式化不会完成。如果您单击返回（返回主菜单）并重新加载屏幕，则格式现在已完成。鉴于上面的代码，我看不出`employee.task`在加载菜单后怎么可能返回 undefined 。这里发生了什么？

# c - 具有不同功能的线程间互斥锁

> ID：13829282
> 
> 赞同：0
> 
> 时间：2012-12-11T22:05:19.467
> 
> 标签：c, synchronization, pthreads, mutex

问题：与我的其他问题之一类似，[其他问题](https://stackoverflow.com/questions/13672456/slightly-complicated-thread-synchronization) 我正在尝试用 C 语言创建一个程序，该程序允许我搜索具有可变线程数量的 10 个文本文件以找到最大的 Prime。它还应该有一个管理器线程，允许读取工作线程的最大素数（而不是修改它）。Manager 线程还发布所有工作线程找到的最大素数，以便工作线程可以读取并使用它。工作线程必须将其本地最大素数发布到全局数组（privateLargestPrime），并且在这样做之前他们必须锁定它，以便管理线程在工作线程更新它之前不会读取它。

奇怪的部分：当工作线程想要调用锁时，当我逐步执行我的程序时，它会将线程切换到需要锁并被授予锁的管理器，然后它会继续循环使工作线程挨饿。我不确定这是怎么回事。如果我能对这个问题有所了解，将不胜感激。

```
/*
 * The Reason for Worker Initialization + Manager Initialization is that we need both types of threads to exist at the same time
 * so I just combined them into one loop, although I believe that they could have been created seperatly.
 * Basically just call pthread_Join at the end
 */

    #include <stdio.h>
    #include <stdlib.h>
    #include <math.h>
    #include <pthread.h>
    #include <time.h>
    #include <string.h>
    #include <fileTest.h>

    clock_t Start, End;
    double elapsed = 0;
    pthread_cond_t managerVar;
    pthread_mutex_t mutex;
    unsigned int globalLargestPrime = 0;
    int numThreads = 1;//Number of Threads
    int LINES_PER_THREAD;
    pthread_cond_t *WorkerConditionaVar;
    pthread_cond_t *ManagerConditionaVar;
    unsigned int *privateLocalLargest;//will need to be changed
    int *statusArray;

    FILE *fileOut;
    typedef enum{
      FREE,
      IN_USE
    }lrgstPrm;
    lrgstPrm monLargestPrime;//create enum
    lrgstPrm workerLargestPrime;//create enum

    typedef enum{
      Finished,
      Not_Finished
    }Status;
    Status is_Finished;

    typedef struct threadFields{
      int id;
      int StartPos;//gets seek for worker thread
      int EndPos;
    }tField;

    int ChkPrim(unsigned int n){
      unsigned int i;
      unsigned int root = sqrt(n);
      for(i=2; i<root; i++){
            if(n % i == 0)
              return 0;

         }
      //printf("%d \n", isPrime);
      return 1;
    }

    void *Worker(void *threadStruct){//Create Threads
      struct threadFields *info = threadStruct;
      int index;
      int id = info->id;
      unsigned int currentNum = 0;
      int Seek = info->StartPos;
      unsigned int localLargestPrime = 0;
      char *buffer = malloc(50);
      int isPrime = 0;

        while(Seek<info->EndPos){
        for(index = 0; index < 1000; index++){//Loop 1000 times
        fseek(fileOut,Seek*sizeof(char)*20, SEEK_SET);
        fgets(buffer,20,fileOut);
        Seek++;
        currentNum = atoi(buffer);
        if(currentNum>localLargestPrime && currentNum > 0){
          isPrime = ChkPrim(currentNum);
          if( isPrime == 1)
            localLargestPrime = currentNum;
        }
      }

        //while(monLargestPrime == IN_USE)
        //pthread_cond_wait(&monitor[id], &mutex);//wait untill mutex is unlocked
        //monLargestPrime = IN_USE;
        //Critical Zone
        //printf("Entering Critical Zone My ID: %d\n",id);

        /*Should Lock the Private Largest Prime from any other thread using it*/
        if(pthread_mutex_lock(&mutex) != 0)//Lock
          printf("Failed To Lock");
        while(workerLargestPrime == IN_USE)//Wait untill Workers largest prime is free
          pthread_cond_wait(ManagerConditionaVar, &mutex);
        workerLargestPrime = IN_USE;//Local Largest is in use
        privateLocalLargest[id] = localLargestPrime;//Assign Local Largest to each workers Shared Variable
        workerLargestPrime = FREE;
        pthread_cond_signal(ManagerConditionaVar);//Signal to any waiting thread that wants to touch(read) this workers privateLocalLargest
        pthread_mutex_unlock(&mutex);

        /*
        pthread_mutex_lock(&mutex);
       while(workerLargestPrime == FREE){
         workerLargestPrime = IN_USE;
         //pthread_cond_wait(&managerVar,&mutex);
        */
        if(localLargestPrime < globalLargestPrime)
          localLargestPrime = globalLargestPrime;
        /*
       workerLargestPrime = FREE;
       pthread_mutex_unlock(&mutex);

       // for(index = 0; index < numThreads; index++)
         // if(index != id)
           // pthread_cond_signal(&monitor[id]);//signal all threads that mutex is unlocked
        //monLargestPrime = FREE;
        //printf("Exiting Critical Zone My ID: %d\n",id);
    */
        //pthread_mutex_unlock(&mutex);
       }//End of While
    statusArray[id] = 1;
    void *i = 0;
    return i;
    }

    void *manager(){
        int index, MlocalLargestPrime;

        while(is_Finished==Not_Finished){
        /*Should Lock the Private Largest Prime from any other thread using it*/
            if(pthread_mutex_lock(&mutex) != 0)//Lock
              printf("Failed To Lock");
            while(workerLargestPrime == IN_USE)//Wait untill Workers largest prime is free
              pthread_cond_wait(ManagerConditionaVar, &mutex);
            workerLargestPrime = IN_USE;//Local Largest is in use
            //Critical Zone
            for(index =0; index < numThreads; index++)
                  if(privateLocalLargest[index] > MlocalLargestPrime)
                    MlocalLargestPrime = privateLocalLargest[index];
            //Critical Zone
            workerLargestPrime = FREE;
            pthread_cond_signal(ManagerConditionaVar);//Signal to any waiting thread that wants to touch(read) this workers privateLocalLargest
            pthread_mutex_unlock(&mutex);
    /*
       pthread_mutex_lock(&mutex);
       while(workerLargestPrime == FREE){
         workerLargestPrime = IN_USE;
         globalLargestPrime = MlocalLargestPrime;
         workerLargestPrime = FREE;
         pthread_cond_signal(&managerVar);

       }
       pthread_mutex_unlock(&mutex);
    */
       /*check if workers have finished*/
    for(index = 0; index < numThreads; index++)
      if(statusArray[index] == 0)
        is_Finished = Not_Finished;
    }
        void *i = 0;
        return i;
       }

    int main(){
      //setFile();
      LINES_PER_THREAD = (getLineNum()/numThreads);
      fileOut = fopen("TextFiles/dataBin.txt", "rb");
      Start = clock();
      //pthread_t managerThread;
      pthread_t threads[numThreads];
      pthread_cond_t monitor[numThreads];
      pthread_cond_t managerCon;
      WorkerConditionaVar = monitor;//Global Pointer points to the array created in main
      ManagerConditionaVar = &managerCon;
      unsigned int WorkerSharedVar[numThreads];
      privateLocalLargest = WorkerSharedVar;
      pthread_mutex_init(&mutex, NULL);
      int finishedArr[numThreads];
      statusArray = finishedArr;
      is_Finished = Not_Finished;
      int index;

          /*Worker Initialization + Manager Initialization*/
          pthread_cond_init(&managerCon,NULL);
          /*Worker Thread Struct Initalization*/
          tField *threadFields[numThreads];//sets number of thread structs
          rewind(fileOut);
          for(index = 0; index < numThreads; index++){//run through threads; inizilize the Struct for workers
              pthread_cond_init(&monitor[index], NULL);//Initialize all the conditional variables
              threadFields[index] = malloc(sizeof(tField));
              threadFields[index]->id = index;
              threadFields[index]->StartPos = index*LINES_PER_THREAD;// Get Position for start of block
              threadFields[index]->EndPos = (index+1)*LINES_PER_THREAD-1;// Get Position for end of block
        }
          /*Worker Thread Struct Initalization*/

          for(index = 0; index<numThreads+1; index++)
            if(index == numThreads)//Last Thread is Manager Thread
              pthread_create(&threads[index],NULL,manager,NULL);//Create Manager
            else//Worker Threads
              pthread_create(&threads[index],NULL,Worker,(void *)threadFields[index]);//Pass struct to each worker

          for(index = 0; index<numThreads+1; index++)
            pthread_join(threads[index], NULL);
          /*Worker Initialization + Manager Initialization*/

      /*Destroy the mutexes & conditional signals*/
          for(index = 0; index < numThreads; index++){
             pthread_cond_destroy(&WorkerConditionaVar[index]);
             }
          pthread_cond_destroy(&managerCon);

      pthread_mutex_destroy(&mutex);
    End = clock();
    elapsed = ((double) (End - Start)) / CLOCKS_PER_SEC;

    printf("This is the Time %f\n", elapsed);
    printf("This is the Largest Prime Number: %u", globalLargestPrime);
    return 0;
    }

  [1]: https://stackoverflow.com/questions/13672456/slightly-complicated-thread-synchronization 
```

还有另一个 C 源代码，我只使用一种方法，它是给我 10 个文本文件的行数，我也会发布它（但不是必需的）：

```
/*
 * fileTest.c
 *
 *  Created on: Dec 8, 2012
 *      Author: kevin
 *
 *  count number of lines
 *  divide by number of threads
 *  get the positions to hand to each thread
 *  to get positions, one needs to get the number of lines per thread,
 *  add number of lines to each: Seek*sizeof(char)*10, SEEK_SET.
 *  and hand out these positions to each thread
 *
 */

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <pthread.h>
#include <time.h>
#include <string.h>

  FILE *filesIn[10], *fileOut;
  int Seek;

void createText(){
  FILE *fOUT = fopen("data9.txt", "w");
  int i;
  srand(time(NULL));
  for(i=0; i<10000; i++)
  fprintf(fOUT, "%d\n",rand()%9000);
  fclose(fOUT);
}

void setFile(){
  int index;
  Seek = 0;
  char *buffer = malloc(50);
  filesIn[0] = fopen("TextFiles/primes1.txt", "r");//read Text
  filesIn[1] = fopen("TextFiles/primes2.txt", "r");//read Text
  filesIn[2] = fopen("TextFiles/primes3.txt", "r");//read Text
  filesIn[3] = fopen("TextFiles/primes4.txt", "r");//read Text
  filesIn[4] = fopen("TextFiles/primes5.txt", "r");//read Text
  filesIn[5] = fopen("TextFiles/primes6.txt", "r");//read Text
  filesIn[6] = fopen("TextFiles/primes7.txt", "r");//read Text
  filesIn[7] = fopen("TextFiles/primes8.txt", "r");//read Text
  filesIn[8] = fopen("TextFiles/primes9.txt", "r");//read Text
  filesIn[9] = fopen("TextFiles/primes10.txt", "r");//read Text
  fileOut = fopen("TextFiles/dataBin.txt", "wb");//write in bin

for(index = 0; index < 10; index++)//Run through 10 files
  while(!feof(filesIn[index])){

    fscanf(filesIn[index],"%s", buffer);//take line from input
    fseek(fileOut,Seek*sizeof(char)*20, SEEK_SET);
    fputs(buffer,fileOut);//Print line to output file
    Seek++;
  }
  fclose(filesIn[0]);
  fclose(filesIn[1]);
  fclose(filesIn[2]);
  fclose(filesIn[3]);
  fclose(filesIn[4]);
  fclose(filesIn[5]);
  fclose(filesIn[6]);
  fclose(filesIn[7]);
  fclose(filesIn[8]);
  fclose(filesIn[9]);
  fclose(fileOut);
}

void getFile(){
  int Seek = 0;
  int currentSeek = 0;
  int currentNum = 0;
  int localLargestPrime = 0;
  char *buffer = malloc(50);
  fileOut = fopen("TextFiles/dataBin.txt", "rb");
  rewind(fileOut);
  while(!feof(fileOut)){
  fseek(fileOut,Seek*sizeof(char)*20, SEEK_SET);
  fgets(buffer,10,fileOut);
  Seek++;
  currentNum = atoi(buffer);
  if(currentNum>localLargestPrime)
        if(ChkPrim(currentNum) == 1){
          localLargestPrime = currentNum;
          currentSeek = Seek*sizeof(char)*20;
          printf("the current seek is: %d\n", currentSeek);
        }
  }
  printf("This is the largest Prime: %d\n", localLargestPrime);
}

int getLineNum(){
  Seek = 0;
  int index;
  char c;
  filesIn[0] = fopen("TextFiles/primes1.txt", "r");//read Text
  filesIn[1] = fopen("TextFiles/primes2.txt", "r");//read Text
  filesIn[2] = fopen("TextFiles/primes3.txt", "r");//read Text
  filesIn[3] = fopen("TextFiles/primes4.txt", "r");//read Text
  filesIn[4] = fopen("TextFiles/primes5.txt", "r");//read Text
  filesIn[5] = fopen("TextFiles/primes6.txt", "r");//read Text
  filesIn[6] = fopen("TextFiles/primes7.txt", "r");//read Text
  filesIn[7] = fopen("TextFiles/primes8.txt", "r");//read Text
  filesIn[8] = fopen("TextFiles/primes9.txt", "r");//read Text
  filesIn[9] = fopen("TextFiles/primes10.txt", "r");//read Text
  for(index = 0; index < 10; index++)
    while((c = fgetc(filesIn[index])) != EOF)
      if(c == '\n')
        Seek++;

  return Seek;
} 
```

[在此处输入链接描述](https://stackoverflow.com/questions/13672456/slightly-complicated-thread-synchronization)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:00:11.490

您似乎过度同步访问`globalLargestPrime`. 但是，与其试图解决这个问题，可能会有更好的方法将每个线程的值传达给管理器——只需让线程函数将它找到的值作为强制转换返回`unsigned int`到`void*`. 然后管理器可以通过等待`pthread_join()`每个线程完成来收集这些值。

类似于以下伪代码：

```
void *Worker(void *threadStruct)
{
    unsigned int largest_prime;

    // do whatever you need to do to find the largest prime in the set of numbers
    //  this thread has to deal with
    //
    // Note that nothing here should require synchronization, since the data should be
    //  completely independent of other threads

    return (void*) largest_prime;
}

 void *manager()
 {
    unsigned int largest_prime = 0;

    // do whatever to spin up the threads and keep track of them in a
    //  pthread_t[] array...

    // now wait for the threads to finish up and keep deal with the value
    //  each thread has found:
    for each (pthread* p in the pthread_t[]) { // remember - pseudo code
        void* result = 0;

        // get the result that thread found
        pthread_join( p, &result);
        unsigned int thread_prime = (unsigned int) result;

        if (largest_prime < thread_prime) {
            largest_prime = thread_prime;
        }
    }

    printf("largest prime: %u\n", largest_prime);
 } 
```

现在您所有的同步问题都由`pthread_join()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T06:28:34.420

按照你的问题，我认为你可以而且应该不用锁。

使用全局数组从工作线程更新 Manager 线程。由于工作线程每个线程将写入单独的数组索引，因此每个数组索引只有一个写入器。主线程可以继续从同一个数组中读取。

对迄今为止找到的最大素数使用一个全局变量（在所有线程中共享）。对于这个变量，主线程是唯一的写入者，工作线程都是读取者。

一致性不会成为问题，因为它只有一个变量。如果有更多变量需要一起更新，您需要担心锁定。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T19:16:16.297

好的，所以我用我的条件变量做了一些时髦的事情（我有太多了！）所以在这里我将发布我的答案：

```
/*
 * The Reason for Worker Initialization + Manager Initialization is that we need both types of threads to exist at the same time
 * so I just combined them into one loop, although I believe that they could have been created seperatly.
 * Basically just call pthread_Join at the end
 */

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <pthread.h>
#include <time.h>
#include <string.h>
#include "fileTest.h"

clock_t Start, End;
double elapsed = 0;
pthread_cond_t managerVar;
pthread_mutex_t mutex;
unsigned int globalLargestPrime = 0;
int *numThreads;//Number of Threads ptr
int LINES_PER_THREAD;
pthread_cond_t *WorkerConditionaVar;
pthread_cond_t *ManagerConditionaVar;
unsigned int *privateLocalLargest;//will need to be changed
int *statusArray;

FILE *fileOut;
typedef enum{
  FREE,
  IN_USE
}lrgstPrm;
lrgstPrm managerLargestPrime;//create enum
lrgstPrm workerLargestPrime;//create enum

typedef enum{
  Finished,
  Not_Finished
}Status;
Status is_Finished;

typedef struct threadFields{
  int id;
  int StartPos;//gets seek for worker thread
  int EndPos;
}tField;

int ChkPrim(unsigned int n){
  unsigned int i;
  unsigned int root = sqrt(n);
  for(i=2; i<root; i++){
        if(n % i == 0)
          return 0;

     }
  //printf("%d \n", isPrime);
  return 1;
}

void *Worker(void *threadStruct){//Create Threads
  struct threadFields *info = threadStruct;
  int index;
  int id = info->id;
  unsigned int currentNum = 0;
  int Seek = info->StartPos;
  unsigned int localLargestPrime = 0;
  char *buffer = malloc(50);
  int isPrime = 0;

    while(Seek<info->EndPos){
    for(index = 0; index < 1000; index++){//Loop 1000 times
    fseek(fileOut,Seek*sizeof(char)*20, SEEK_SET);
    fgets(buffer,20,fileOut);
    Seek++;
    currentNum = atoi(buffer);
    if(currentNum>localLargestPrime && currentNum > 0){
      isPrime = ChkPrim(currentNum);
      if( isPrime == 1)
        localLargestPrime = currentNum;
    }
  }
/*Here is where I block the manager thread read while I Write*/
    pthread_mutex_lock(&mutex);
    while(workerLargestPrime == IN_USE)
      pthread_cond_wait(WorkerConditionaVar,&mutex);
    //Critical Zone
    privateLocalLargest[id] = localLargestPrime;
    //Critical Zone
    pthread_cond_signal(WorkerConditionaVar);
    pthread_mutex_unlock(&mutex);
/*Here is where I block the manager thread read while I Write*/

/*I need to wait here until it is free to read the Managers Shared variable (GlobaLargestPrime)*/
    pthread_mutex_lock(&mutex);
      while(managerLargestPrime == IN_USE)
        pthread_cond_wait(ManagerConditionaVar,&mutex);
      //Critical Zone
    if(localLargestPrime < globalLargestPrime)
      localLargestPrime = globalLargestPrime;
      //Critical Zone
    pthread_cond_signal(ManagerConditionaVar);
    pthread_mutex_unlock(&mutex);
/*I need to wait here until it is free to read the Managers Shared variable (GlobaLargestPrime)*/
   }//End of While
statusArray[id] = 1;
return NULL;
}

void *manager(){
    int index;
    int ManagerLocalLargest = 0;

    while(is_Finished==Not_Finished){
/*I need to wait here until it is free to read the workers Shared variable (PrivateLocalLargest)*/
      pthread_mutex_lock(&mutex);
      while(workerLargestPrime == IN_USE)
        pthread_cond_wait(WorkerConditionaVar,&mutex);
      //Critical Zone
      for(index = 0; index < *numThreads; index++)
        if(privateLocalLargest[index] > ManagerLocalLargest)
          ManagerLocalLargest = privateLocalLargest[index];
      //Critical Zone
      pthread_cond_signal(WorkerConditionaVar);
      pthread_mutex_unlock(&mutex);

/*Here is where I block the worker thread read while I Write*/
      pthread_mutex_lock(&mutex);
            while(managerLargestPrime == IN_USE)
              pthread_cond_wait(ManagerConditionaVar,&mutex);
            //Critical Zone
            for(index = 0; index < *numThreads; index++)
              if(privateLocalLargest[index] > globalLargestPrime)
                globalLargestPrime = privateLocalLargest[index];
            //Critical Zone
            pthread_cond_signal(ManagerConditionaVar);
            pthread_mutex_unlock(&mutex);
/*Here is where I block the worker thread read while I Write*/

   /*check if workers have finished*/
for(index = 0; index < *numThreads; index++){
  is_Finished = Finished;
  if(statusArray[index] != 1){
    is_Finished = Not_Finished;
    }
  }
}
    return NULL;
   }

 int main(int argc, char *argv[]){
  //setFile();
int argument;
switch(argc){

case 1:
  printf("You didn't Type the number of threads you wanted... \n");
  printf("argument format: [# of Threads]\n");
  return -1;
  break;
case 2:
  if(strcmp(argv[1],"--help") == 0){
      printf("argument format: [# of Threads]\n");
      return 0;
  }
  else
    argument = atoi(argv[1]);
  break;
}
  printf("The number of threads is %d\n", argument);
  numThreads = &argument;
  LINES_PER_THREAD = (getLineNum()/(*numThreads));
  fileOut = fopen("TextFiles/dataBin.txt", "rb");
  //pthread_t managerThread;
  pthread_t threads[*numThreads];
  pthread_cond_t monitor[*numThreads];
  pthread_cond_t managerCon;
  WorkerConditionaVar = monitor;//Global Pointer points to the array created in main
  ManagerConditionaVar = &managerCon;
  unsigned int WorkerSharedVar[*numThreads];
  privateLocalLargest = WorkerSharedVar;
  pthread_mutex_init(&mutex, NULL);
  int finishedArr[*numThreads];
  statusArray = finishedArr;
  is_Finished = Not_Finished;
  int index;

      /*Worker Initialization + Manager Initialization*/
      pthread_cond_init(&managerCon,NULL);
      /*Worker Thread Struct Initalization*/
      tField *threadFields[*numThreads];//sets number of thread structs
      rewind(fileOut);
      for(index = 0; index < *numThreads; index++){//run through threads; inizilize the Struct for workers
        privateLocalLargest[index] = 0;
          pthread_cond_init(&monitor[index], NULL);//Initialize all the conditional variables
          threadFields[index] = malloc(sizeof(tField));
          threadFields[index]->id = index;
          threadFields[index]->StartPos = index*LINES_PER_THREAD;// Get Position for start of block
          threadFields[index]->EndPos = (index+1)*LINES_PER_THREAD-1;// Get Position for end of block
    }
      /*Worker Thread Struct Initalization*/
      Start = clock();
      for(index = 0; index<*numThreads+1; index++)
        if(index == *numThreads)//Last Thread is Manager Thread
          pthread_create(&threads[index],NULL,manager,NULL);//Create Manager
        else//Worker Threads
          pthread_create(&threads[index],NULL,Worker,(void *)threadFields[index]);//Pass struct to each worker

      for(index = 0; index<*numThreads+1; index++)
        pthread_join(threads[index], NULL);
      /*Worker Initialization + Manager Initialization*/

  /*Destroy the mutexes & conditional signals*/
      for(index = 0; index < *numThreads; index++){
         pthread_cond_destroy(&WorkerConditionaVar[index]);
         }
      pthread_cond_destroy(&managerCon);

  pthread_mutex_destroy(&mutex);
End = clock();
elapsed = ((double) (End - Start)) / CLOCKS_PER_SEC;

printf("This is the Time %f\n", elapsed);
printf("This is the Largest Prime Number: %u\n", globalLargestPrime);
return 0;
} 
```

我还解决了需要硬编码的线程数和条件变量的问题，现在它可以作为参数输入。感谢大家的支持。

PS。我注意到拥有 2 个线程并不能加快进程（我认为它会）而且我的电脑是双核的。这可能是因为互斥锁和所有阻塞。我还注意到，线程越多，他们处理数据所需的时间就越长...... hrmm，如果有人看到这个并且可以给我一些见解，请pm我或写评论。谢谢（其他 c 文件保持不变）。

# ajax - jquery mobile可折叠和galaxy tab 10.1 json响应给出随机响应

> ID：13829283
> 
> 赞同：27
> 
> 时间：2012-12-11T22:05:19.787
> 
> 标签：ajax, json, jquery, jquery-mobile, collapsable

jquery mobile 和解析 json 的新手 - 做了很多研究但无济于事。已尝试在 settimeout 功能中延迟 10 秒

我的应用程序在我的三星 Galaxy s2 上正常运行，但在我的三星 Galaxy 平板电脑 10.1 上，它执行以下操作。

使用最新`jquery 1.2.0`和`jquery-1.7.2`

我打电话`getlocations2.php`，如果我退回四个或更少的物品，可折叠套装会正确打开和关闭。如果我退回 5 件或更多物品：

1.  我点击顶部可折叠以展开它 - 没有任何反应
2.  我点击第二个可折叠的 h3 并打开第一个可折叠的
3.  之后，它可以随机重新扩展 h3，但通常是最后一个被触摸且无法打开的 h3。
4.  它可以在短时间内正常工作。

感谢您的任何提示：

代码 ：

```
function doajax2($vurl,$vdata,$vtype,$vfrom){   
    $.ajax({
        url: $vurl,
        dataType: 'json',
        data:$vdata,
        async: false,
        success: function(rtndata) {
            $.mobile.hidePageLoadingMsg(); //alert(result.toSource())   
            rtndata2=(JSON.stringify(rtndata, null, 4));
            rtndata2=rtndata2.substring(13);
            rtndata2=rtndata2.slice(0, -2)

            var res = eval(rtndata2);           
            $('.displaylocations').html('');    
            g_html=res[0].brand;

            if (res[0].id> -1){
                g_html=g_html+'<div data-role="collapsible-set" data-theme="f" >';
                for (var i=0;i<res.length;i++){
                //for (var i=0;i<6;i++){            
                    lochtml('loc',i,res[i].locid,res[i].loccode1,res[i].head,res[i].desc,res[i].lang,res[i].lat1,res[i].long1,res[i].img1,res[i].limit);        
                }
                g_html=g_html+'</div>';
            }

            console.log('g_html'+g_html);
            $('.displaylocations').css('display','none');           
            $(".displaylocations").html(g_html);    
                    //  $(".displaylocations").html(str);   

            setTimeout(function(){ //make sure displaylocations has been updated
                $('#lhead2').html('Tuhura <span lang="en">Locations</span>');
                $('.displaylocations').trigger('create');
                $('.displaylocations').css('display','block');
                $( ".displaylocations" ).collapsibleset( "refresh" );

            },300);
        },
        error: function(faildata){
            switch ($vfrom) {
                case "region"   : $("#lhead3").html('Region Info Unavailable...');break
                case "locs"     :   $("#lhead2").html('Locations Unavailable...');break;
            }
        }
    });
}

function lochtml($vtype,$vno,$locid,$loccode1,$head,$desc,$vlang,$vlat1,$vlong1,$img1,$limit) {
console.log('lochtml '+$desc);
        g_html=g_html+  "<div class='locgoh'>";
        g_html=g_html+      '<a href="#" onclick="getsitedetails('+"'gps','"+$locid+"','"+$loccode1+"','s','sites','"+$vlang+"',1,0,'x',"+$vlat1+","+$vlong1+')">';
        g_html=g_html+ '<img src="http://tuhtop.co.nz/images/rightarrow.png" width="30px" height="30px" /></a>';                                                                            
        g_html=g_html+  '</div>';
        g_html=g_html+'<div data-role="collapsible" class="loccollapse" data-theme="f" div="coldiv">';              
        g_html=g_html+  '<h3>'+$head+'</h3>';                                               
        g_html=g_html+  '<p><div class="locli0">';                                  
        g_html=g_html+      '<span class="li1">' +$desc+ '</span>';                     
        g_html=g_html+      '<span class="li2"><a href="#" onclick="getsitedetails('+"'gps','"+$locid+"','"+$loccode1+"','s','sites','"+$vlang+"',1,0,'x',"+$vlat1+","+$vlong1+')">';
        g_html=g_html+      '<img src=\''+$img1+'\' width=\'120"\' height=\'120\' alt=\''+$img1+'\'/></a>';         
        g_html=g_html+      '</span>';      
        g_html=g_html+  '</div></p>';       
        g_html=g_html+'<div class="clearfloat"></div>';             
        g_html=g_html+'</div>';

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-15T02:45:07.080

如果我错了，请纠正我，据我在阅读您的代码时所知，可能存在多个问题

首先，**g_html**变量的引用，为什么不在函数**lochtml**和for循环中返回html，像这样构建HTML，它更具可读性

```
 for (var i=0;i<res.length;i++){
        g_html=g_html+lochtml('loc',i,r...)
    } 
```

其次，**g_html**的初始值被设置为**res[0].brand**，它的值是多少？

第三，这是为可折叠集 div 生成的内容：

```
 the res[0].brand above 
    <div data-role="collapsible-set" data-theme="f">
        <div class='locgoh'>
            <a ...>
                <img />
            </a>
        </div>
        <div data-role="collapsible" class="loccollapse" data-theme="f" div="coldiv">
            <h3>...</h3>
            <p>...</p>
            <div class="clearfloat"></div>
        </div>
        ...
        ...
    </div> 
```

这不是 jQuery Mobile 对 data-role="collapsible-set" 内容的期望，我认为应该只有**<div data-role="collapsible">**在**<div data-role="collapsible-set"内>**。我建议你把**<div class='locgoh'> 移到****<h3>**里面

 **第四，是否需要**<div class="clearfloat">**？您是否将标签**p**浮动在可折叠的内部？我之前在一些 jQM 小部件中使用“float”时遇到了一些问题。此外，如果 clearfloat 不需要在那里，最好将其删除。

最后，我认为**collapsibleset('refresh')**应该在**<div data-role="collapsible-set">**而不是其容器上*调用。***

# php - 允许用户将域下的子域指向 IP 地址的脚本是否可行？

> ID：13829284
> 
> 赞同：0
> 
> 时间：2012-12-11T22:05:28.070
> 
> 标签：php, ip

如果可能的话，这将如何创建？它只能在 cPanel 中创建，还是可以制作一个脚本供用户使用而无需登录 cPanel 以允许他们创建自己的域？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:10:45.497

子*域*只是 DNS 服务器配置中的一个条目。您可能可以通过在文件中添加一堆行或完全添加新文件来更新配置。这实际上取决于 DNS 服务器软件，也许您使用的软件也有一个通过 TCP 套接字更新的 API。

此外，如果目标 IP 是共享的（因此您使用基于名称的虚拟主机），或者它是不同的，也许您希望 HTTP 服务器侦听该 IP 上的端口 80。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:13:43.457

根据您的托管/服务器设置，这应该是可能的：

1.  添加通配符域 CNAME 记录`*.yourdomain.com`；
2.  使用重写规则将所有流量定向`anything.yourdomain.com`到 php 脚本以处理请求；
3.  在 php 脚本中做任何你想做的事情：使用`header`重定向，在 iframe 中显示另一个页面等。

# php - SQL 语法有问题

> ID：13829288
> 
> 赞同：0
> 
> 时间：2012-12-11T22:06:03.607
> 
> 标签：php, mysql, sql, syntax

我不断收到此错误：

Query1 失败：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“d41d8cd98f00b204e9800998ecf8427e”“d41d8cd98f00b204e9800998ecf8427e”、“d41d8cd”附近使用正确的语法

这是我正在使用的代码：

```
 <?php

     $payment = $_GET['payment'];
     if($payment){
include("connection.php");
$CardHolder = md5($_POST["CardHolder"]);
$CardType = md5($_POST["CardType"]);
$CardNumber = md5($_POST["CardNumber"]);
$SecurityCode = md5($_POST["SecurityCode"]);
$ExpiryDate = md5($_POST["ExpiryDate"]);
$PurchaseID = $_SESSION['purchaseid'];
$Email = $_SESSION['user'];

$sql = "INSERT INTO Payment (CardHolder, CardType, CardNumber, SecurityCode, ExpiryDate, PurchaseID, Email) VALUES (\"$CardHolder\", \"$CardType\", , \"$CardNumber\" \"$SecurityCode\", \"$ExpiryDate\", \"$PurchaseID\", \"$Email\")";
$result = mysqli_query($con, $sql) or die('Query1 failed: ' . mysqli_error($con));;

if($result){
    echo "<p>Your Payment has been Accepted. You are now being redirected to the to the HomePage.</p>
      <meta http-equiv=\"refresh\" content=\"1;URL=index.php\" />";

     } else {
         echo "<p>Payment Failed, Please try again later.</p>";
     }
}

      ?> 
```

我不确定我做错了什么。提前感谢您的支持。

编辑：使用提供的答案后，我现在收到此错误 Query1 失败：列数与第 1 行的值计数不匹配。只是为了让你们知道我有一个 PaymentID，即 Auto INCREMENT。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:10:38.413

我相信你的逗号放错了位置（2 在 CardType 之后，0 在 CardNumber 之后）。

```
\"$CardType\", , \"$CardNumber\" \"$SecurityCode\", 
```

话虽如此，您会受到 SQL 注入攻击，并且有更好的方法使用准备好的语句和绑定参数进行插入。以此为起点[。](http://php.net/manual/en/class.mysqli-stmt.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T22:07:17.740

看来您有一个没有价值的额外列：

```
$sql = "INSERT ... VALUES (\"$CardHolder\", \"$CardType\", , \"$CardNumber\"
                                                          ^
```

我建议您改用单引号。

```
$sql = "INSERT INTO Payment (CardHolder, CardType, CardNumber, SecurityCode, ExpiryDate, PurchaseID, Email) VALUES ('$CardHolder', '$CardType', '$CardNumber', '$SecurityCode', '$ExpiryDate', '$PurchaseID', '$Email')"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T22:07:23.870

后面有两个逗号`CardType`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-11T22:07:59.140

替换为：

```
$sql = "INSERT INTO Payment (CardHolder, CardType, CardNumber, SecurityCode, ExpiryDate, PurchaseID, Email) VALUES (\"$CardHolder\", \"$CardType\", \"$CardNumber\", \"$SecurityCode\", \"$ExpiryDate\", \"$PurchaseID\", \"$Email\")"; 
```

# javascript - JavaScript 去除元音

> ID：13829289
> 
> 赞同：12
> 
> 时间：2012-12-11T22:06:04.760
> 
> 标签：javascript, string, replace

我正在尝试去除字符串中的元音。我知道我应该使用`str.replace`，但我对如何将它变成一个跨度感到困惑。

这更像是我想做的事情：

编写一个 JavaScript 函数，该函数接受一个字符串`s`并返回该字符串，该字符串等效于`s`但删除了所有 ASCII 元音。例如：`(“Hello World”)`返回：`"Hll wrld"`

请帮忙！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-12-11T22:08:29.347

`.replace(/[aeiou]/ig,'')`是你所需要的全部。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-12-11T22:14:53.140

要替换元音，您可以使用简单的正则表达式：

```
function removeVowels(str) {
  return str.replace(/[aeiou]/gi, '');
} 
```

至于把它变成一个跨度的部分，不是 100% 确定你的意思，但可能是这样的：

```
<span id="mySpan">Hello World!</span>
<script>
  var span = document.getElementById('mySpan');
  span.innerHTML = removeVowels(span.innerHTML);
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T22:10:05.660

`string.replaceAll("[aeiou]\\B", "")`

# windows-phone-8 - 是否可以将命令直接绑定到应用栏按钮？

> ID：13829292
> 
> 赞同：6
> 
> 时间：2012-12-11T22:06:21.420
> 
> 标签：windows-phone-8

我正在为 windows phone 创建一个 MVVM 风格的应用程序。使用常规按钮，您可以将从 ICommand 继承的任何内容绑定到 xaml 按钮上的 Command 属性，如下所示：

手机应用栏中的按钮（“shell：ApplicationBarIconButton”）似乎不存在命令属性。有没有人想出如何将他们的点击事件绑定到命令？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-11T22:23:20.587

直接从 SDK 中是不可能的，但 AppBarUtils 库（[http://nuget.org/packages/AppBarUtils](http://nuget.org/packages/AppBarUtils)或[http://appbarutils.codeplex.com/](http://appbarutils.codeplex.com/)）运行良好。

codeplex 站点有不同场景的示例代码，例如重用或切换页面中的应用栏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-24T11:59:30.613

我不明白如何使用选择的解决方案，所以我选择了另一个解决方案。您只需通过 nuget 添加库。它是[BindableApplicationBar](https://bindableapplicationb.codeplex.com/)

然后，您只需添加以下内容，而不是普通的应用程序栏。

```
<bindableApplicationBar:Bindable.ApplicationBar>
        <bindableApplicationBar:BindableApplicationBar >
            <bindableApplicationBar:BindableApplicationBarButton
                Text="Refresh"
                IconUri="/Images/refresh.png"
                Command="{Binding RefreshCommand}" />
        </bindableApplicationBar:BindableApplicationBar> 
```

遗憾的是智能感知没有重新识别标签。否则，它就像一个魅力。

# jquery - jQuery - 基于选项关键字而不是值禁用选择选项

> ID：13829293
> 
> 赞同：2
> 
> 时间：2012-12-11T22:06:22.687
> 
> 标签：jquery, html, select, disabled-input

我有这个 HTML 选择代码：

```
​&lt;select name="loc_code">
  <option value="">Select</option>
  <option value="loc1">Loc1 status ON</option>
  <option value="loc2">Loc2 status ON</option>
  <option value="loc3">Loc3 status OFF</option>
  <option value="loc4">Loc4 status ON</option>
</select>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

所以，我在禁用基于文本名称而不是值的选项下拉菜单时遇到问题。我只需要禁用包含状态 OFF 的选项。

我试图从 StackOverflow 上发布的其他类似问题中修改此 jQuery 代码，但显然它是错误的：

```
$("select[name="loc_code"] option:selected").text(function() {
  var $thisOption = $(this);
  var valueToCompare = "OFF";

  if($thisOption.val() == valueToCompare) {
    $thisOption.attr("disabled", "disabled");
  }
});​ 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-11T22:09:16.287

为什么不这样做：

```
$('select[name=loc_code] option').each(function() {
    if ($(this).text().indexOf('OFF') >= 0) $(this).attr('disabled', 'disabled');
});​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/pxD7U/)**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-11T22:13:59.397

您可以使用[包含](http://api.jquery.com/contains-selector/)选择器

```
$('select[name="loc_code"] option:contains(OFF)').prop('disabled',true);​ 
```

[http://jsfiddle.net/CALe7/](http://jsfiddle.net/CALe7/)

# c# - 将 SelectListItem 转换为 IEnumerable 列表

> ID：13829294
> 
> 赞同：1
> 
> 时间：2012-12-11T22:06:31.290
> 
> 标签：c#, asp.net-mvc

我正在尝试将 a 传递`SelectListItem`给视图。可以在带有日期范围的 JavaScript 对话框的视图中查看此复选框列表。

从以下代码中，该方法`ReadLogFile`返回一个正确的`SelectListItem`. 我从我的控制器操作方法中调用此方法。我的实体包含一个名为`RunDatesDisplay`List`IEnumerable`的属性。我可以将此属性创建为选择列表项，但我不想`System.Web.Mvc`在我的域项目中引用命名空间？

问题是我无法将选择列表项转换为`IEnumerable`我的实体中的列表以传递给视图。我创建了一个列表视图模型，并在视图中调用编辑器模板来呈现复选框。

我只需要帮助才能将选择列表项正确传递给视图。例如，我应该将传递`SelectListItem`给模型属性，还是应该首先将我的 selectlistitem 绑定到 selectlist？`ViewBag``ViewBag.RunDatesDisplay = items(selectlistitem)`

实体：

```
public class RunLogEntry
{

    public int ID { get; set; }

    public int RunID { get; set; }

    [NotMapped]
    public bool? LoadFileAttached { get; set; }

    [NotMapped]
    public bool? OutFileAttached { get; set; }

    [NotMapped]
    public string AttachedLoadListFileName { get; set; }

    [NotMapped]
    public string AttachedOutputFileName { get; set; }

    [NotMapped]
    public List<RunLogEntryTestExceptionDisplay> TestExceptionDisplay { get; set; }

    [NotMapped]
    public IEnumerable<RunLogEntryDatesDisplay> RunDatesDisplay { get; set; }
} 
```

进行一些处理并返回一个选择列表项的方法：

```
public static List<SelectListItem> ReadLogFile(List<string> fileNames)
{
    //Get collection of files and send to parser file by file:
    LogFile lf = new LogFile();

    var items = new List<SelectListItem>();
    foreach (var minDate in minDates)
    {
       var item = new SelectListItem() { Value = minDate.ToString(), Text = String.Format("{0} - {1}", minDate, minDate.AddMinutes(30)) };
        items.Add(item);
    }

    return items;
} 
```

控制器动作（我没有包含动作的全部代码）

```
//3\. Send log file name collection to parser
if (logFiles != null && logFiles.Count > 0)
{
    var items = new List<SelectListItem>();

    items = FileImport.ReadLogFile(logFiles);
    **RunLogEntry.RunDatesDisplay = FileImport.ReadLogFile(logFiles);** 
```

视图模型：

```
public class RunLogRunDatesViewModel
{
    public IEnumerable<SelectListItem> RunLogRunDates { get; set; }
} 
```

编辑器模板

```
@model RunLog.Domain.Entities.RunDatesDisplay 

<tr>
    <td>
        @Html.DisplayFor(x => x.RunDate)
    </td>
</tr> 
```

最后是我的观点：

```
<div id="runDatestreeview" title="Dialog Title" style="font-size: 10px; font-weight: normal;
            overflow: scroll; width: 800px; height: 450px; display: none;">
    <table class="grid" style="width: 600px; margin: 3px 3px 3px 3px;">
        <thead>
            <tr>
                <th>
                    Run Dates:
                </th>
            </tr>
        </thead>
        <tbody>
            @if (Model.RunDatesDisplay != null)
            {
                @Html.EditorFor(x => x.RunDatesDisplay)
            }
        </tbody>
    </table>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:26:23.527

您可以创建具有两个属性的自定义类型，或者只使用`Tuple`类，所以您 `ReadLogFile`可能是这样的

```
public static List<Tuple<string,string>> ReadLogFile(List<string> fileNames)
{
   ...
   var items = new List<Tuple<string,string>>();
   foreach (var minDate in minDates)
   {
      var item = new Tuple<string, string>(minDate.ToString(), String.Format("{0} - {1}", minDate, minDate.AddMinutes(30));
      items.Add(item);
   }

   return items;
} 
```

您的型号：

```
public class RunLogRunDatesViewModel
{
       public SelectList RunLogRunDates { get; set; }
} 
```

和你的控制器：

```
var model = new RunLogRunDatesViewModel();
List<Tuple<string,string>> items = FileImport.ReadLogFile(logFiles);
model.RunLogRunDates = new SelectList(items, "Item1", "Item2"); 
```

SelectList 将尝试从“Item1”获取值，从“Item2”获取文本

或者，正如我在开始时所说，您可以创建具有两个属性的简单类以避免使用元组

**UPDATE1** 在 .Net 2.0-3.5 中，您可以为其创建简单的包装器：

```
public class Tuple<T1,T2>
{
    public T1 Item1 {get;set;}
    public T2 Item2 {get;set;}
} 
```

# python - Python 读取 wsdl 不起作用

> ID：13829296
> 
> 赞同：1
> 
> 时间：2012-12-11T22:06:50.050
> 
> 标签：python, wsdl

我正在尝试使用此代码从 wsdl 获取数据。

查询网站的 zipid("60630") 工作正常，但在我的代码中它给出的错误为

“无效的邮编”

```
wsdlFile = 'http://wsf.cdyne.com/WeatherWS/Weather.asmx?wsdl'
wsdlObject = WSDL.Proxy(wsdlFile)
wsdlObject.show_methods()
zipid = "60630"
result = wsdlObject.GetCityWeatherByZIP(ZIP=zipid)
print result[1] 
```

有人可以帮助这里有什么问题以及为什么代码不能正常工作。

谢谢 ！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:02:18.780

问题可能是您的客户端发送了服务器不理解的请求。似乎您正在使用`SOAPpy`，这是我尝试时发送的请求：

```
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope
  SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"
  xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"
  xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance"
  xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"
  xmlns:xsd="http://www.w3.org/1999/XMLSchema"
>
<SOAP-ENV:Body>
<GetCityWeatherByZIP SOAP-ENC:root="1">
<v1 xsi:type="xsd:string">60630</v1>
</GetCityWeatherByZIP>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

在使用时比较[`suds`](http://pypi.python.org/pypi/suds-jurko/0.4.1.jurko.4)：

```
from suds.client import Client
cli = Client("http://wsf.cdyne.com/WeatherWS/Weather.asmx?wsdl")
cli.service.GetCityWeatherByZIP(ZIP=60630) 
```

它产生：

```
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:ns0="http://ws.cdyne.com/WeatherWS/"
    xmlns:ns1="http://schemas.xmlsoap.org/soap/envelope/"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
  <SOAP-ENV:Header/>
  <ns1:Body>
    <ns0:GetCityWeatherByZIP>
      <ns0:ZIP>60630</ns0:ZIP>
    </ns0:GetCityWeatherByZIP>
  </ns1:Body>
</SOAP-ENV:Envelope> 
```

（使用wireshark捕获）

第二个请求从服务器返回一个有效结果。

我不太了解 SOAPpy，无法提出解决此问题的方法，但也许您可以考虑将客户端库切换为 suds。

# barcode - zxing 支持哪些可扫描的条码格式是可用开源的？

> ID：13829309
> 
> 赞同：2
> 
> 时间：2012-12-11T22:08:08.700
> 
> 标签：barcode, zxing, barcode-scanner

我正在开发一个 android 应用程序，在其中我生成数据矩阵并允许用户使用 zxing 输入它们来扫描它们。

但是，出现了一个许可证问题，询问 zxing 扫描的所有格式是否都可用开源。

这与应用程序 zxing 无关，而是它扫描的格式。所有这些格式都可以在某些或其他开源许可下使用吗？如果不是，哪些可扫描格式是开源可用的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:46:28.683

是的，都是开放的，否则就不会实施。例如，MS Tag 不存在。Data Matrix 在发明时最初是专利和专有的，但此时是 ISO 标准 16022 并且是公共领域。例如，QR 码也发生了类似的事情。

# linux - Shell GNU-Screen -X Stuff 问题

> ID：13829310
> 
> 赞同：8
> 
> 时间：2012-12-11T22:08:14.973
> 
> 标签：linux, bash, shell, printf, gnu-screen

```
OPTIONS="java -Xms1024M -Xmx1024M -jar craftbukkit.jar"
PROCESS=server01

screen -dmS $PROCESS $OPTIONS nogui             # Starting the application
screen -x $PROCESS -X stuff `printf "stop\r"`   # Closing the application
screen -x $PROCESS                              # Attaching to the terminal of the application 
```

该应用程序在开始时运行良好，但是`stuff 'printf "stop/r"'` 当我刚启动时它似乎不起作用，等待一段时间然后尝试使用上面的命令停止它。但奇怪的是，如果我这样做`screen -x $PROCESS`并分离（`ctrl-A & ctrl-D`）然后我使用`Stop`它确实有效的命令。那么有没有办法`stuff printf`没有`screen -x $PROCESS`？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-14T00:01:41.083

添加参数**-p 0**应该可以修复它。像这样的东西：

```
screen -x $PROCESS -p 0 -X stuff `printf "stop\r"` 
```

（来自屏幕文档：-p window 如果存在，则预选命名窗口。）

# constraints - 选择满足多个不等式约束的最大子集的任何快速方法？

> ID：13829313
> 
> 赞同：1
> 
> 时间：2012-12-11T22:08:23.410
> 
> 标签：constraints, subset

所以我在二维平面中有一组向量（在本例中为像素），我需要选择这些向量的最大（最长）子集，受三个约束：x_i - x_j <= a, y_i - y_j < = a 对于所有 i != j 和一些用户定义的阈值 a，以及每对不同像素之间的光谱角 <= b，对于其他一些阈值 b。基本上，表示每个像素的光谱数据的向量之间的余弦距离（具体来说，就是归一化点积的 arccos）。

每当我看到子集时，我都会自动想到指数时间复杂度，但必须有一种方法可以利用约束，对吧？

# objective-c - UIAppearanceProxy 背景图片错误

> ID：13829317
> 
> 赞同：1
> 
> 时间：2012-12-11T22:08:36.080
> 
> 标签：objective-c, ios, uiappearance

我正在为 UIToolBar、UINavigationController、UISegmentedControl、UIBarButtonItem 等使用 UIAppearance 选择器，我偶尔会看到一些非常奇怪的行为。

不知何故，这几乎就像 UIControls 在某些操作后重置自己一样。这是我的意思的屏幕截图。基本上，就好像他们不再拥有图像一样。如果我单击控件或旋转以重置它们，它们最终会重置，但我不知道是什么原因造成的。

任何帮助深表感谢。

提前致谢。

![在此处输入图像描述](../Images/f45b3d9251a5fcfa33306d83318cb25a.png)

# php - 根据长度值数组创建元素行

> ID：13829318
> 
> 赞同：1
> 
> 时间：2012-12-11T22:08:37.427
> 
> 标签：php, arrays, split

有没有一种巧妙的方法可以根据长度数组将数组拆分为块？

输入：

```
$start = range(0, 30);
$length = [3, 7, 2, 12, 6]; 
```

期望的输出：

```
[
    [0, 1, 2],  // 3
    [4, 5, 6, 7, 8, 9, 10],  // 7
    [11, 12],  // 2
    [13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24],  // 12
    [25, 26, 27, 28, 29, 30],  // 6
]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-11T22:12:24.393

使用[**`array_splice`**](http://php.net/manual/en/function.array-splice.php)：

```
$target = array(); // or use []  in PHP 5.4
foreach($length as $i) {
    $target[] = array_splice($start, 0, $i);
} 
```

[**尝试一下。**](http://ideone.com/DLLQcG)

请注意，这会改变`$start`！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T22:15:51.277

这很容易通过以下方式完成：

### 代码：

```
$target = array();
$offset = 0;

foreach ($length as $lengthValue) {
    $target[] = array_slice($start, $offset, $lengthValue);
    $offset += $lengthValue;
}
var_dump($target); 
```

### 解释：

您在这里所做的是使用该`array_slice()`方法（非常类似于`substr`）来提取数组的一部分，然后将其插入到目标数组中。每次增加偏移量可以让函数记住下次使用哪一个。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-11T22:10:53.047

我认为 array_chunk() 函数可以做到这一点。这是有关它的更多信息[http://php.net/manual/en/function.array-chunk.php](http://php.net/manual/en/function.array-chunk.php)

# php - 多查询 Mysqli php

> ID：13829322
> 
> 赞同：0
> 
> 时间：2012-12-11T22:08:53.583
> 
> 标签：php, mysqli

当前，查询提取 Managed_Funds。如何从我想要的第二个查询中提取研究？还是这个版本不够先进，无法满足我的要求？

我是 MYSQLi 的新手。

```
<?php

$ID_CARTERA= '8';

$link = mysqli_connect("localhost","carteras_admin","","carteras_bdcarteras");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$query  = "SELECT    

      C.DES_CARTERA_CC  Managed_Funds,      
      A.ANOMES_DESDE Date_Since,
      A.ANOMES_HASTA Final_Date
FROM      det_personas_carteraadmin A
      JOIN mcarteras B  ON ( A.ID_PERSONA = B.COD_ADMINISTRADOR )
      JOIN mcarteras C  ON ( C.ID_CARTERA = A.ID_CARTERA )
WHERE     A.ID_PERSONA = B.COD_ADMINISTRADOR
AND       A.`ANOMES_HASTA`    <>   'A Hoy'
AND       B.`ID_CARTERA`      = $ID_CARTERA;
";
$query .= "SELECT    A.DES_ESTUDIOS Studies
FROM      det_personas_estudios A
      JOIN mcarteras B  ON ( A.ID_PERSONA = B.COD_ADMINISTRADOR )
WHERE     B.ID_CARTERA = $ID_CARTERA

";

/* execute multi query */
if (mysqli_multi_query($link, $query)) {
    do {
        /* store first result set */
        if ($result = mysqli_store_result($link)) {
            while ($row = mysqli_fetch_array($result)) {
                printf("%s\n", $row['Managed_Funds']);
            }
            mysqli_free_result($result);
        }
        /* print divider */
        if (mysqli_more_results($link)) {
            printf("-----------------\n");
        }
    } while (mysqli_next_result($link));
}

/* close connection */
mysqli_close($link);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:24:07.710

您需要单独执行查询

```
/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$query  = "SELECT ... ";

/* execute multi query */
if (mysqli_multi_query($link, $query)) {...}

$query  = "SELECT ... ";

/* execute multi query */
if (mysqli_multi_query($link, $query)) {...}

/* close connection */
mysqli_close($link); 
```

或者你的意思是这个？

```
$query  = "SELECT    
       C.DES_CARTERA_CC  Managed_Funds,      
      A.ANOMES_DESDE Date_Since,
      A.ANOMES_HASTA Final_Date,
      A.DES_ESTUDIOS Studies # <------ extra line here
FROM      det_personas_carteraadmin A
      JOIN mcarteras B  ON ( A.ID_PERSONA = B.COD_ADMINISTRADOR )
      JOIN mcarteras C  ON ( C.ID_CARTERA = A.ID_CARTERA )
WHERE     A.ID_PERSONA = B.COD_ADMINISTRADOR
AND       A.`ANOMES_HASTA`    <>   'A Hoy'
AND       B.`ID_CARTERA`      = $ID_CARTERA;
"; 
```

# c++ - getline() 并从文本文件中读取数据

> ID：13829323
> 
> 赞同：-1
> 
> 时间：2012-12-11T22:08:53.323
> 
> 标签：c++

我在下面编码的程序应该列出每个学生支付的所有款项，显示已支付和未付的金额

我需要以下部分的帮助：

```
void payment()
{
    // Display message asking for the user input
    std::cout << "List all payment made by each student, show amount paid and outstanding." << std::endl;

    // Read from text file and Display list of payment

    std::ifstream infile;               // enable to open, read in and close a text file
    float StudentCode;                  // to store the student enrolment number
    float Amount;                       // to store the amount of money
    float Type;                         // to store information on type of payment made
    float Outstanding;                  // to store amount of money is due

    infile.open("Payment.txt");         // open a text file called Payment

    if (!infile)                 
    {
        std::cout << "Item list is empty" << std::endl;     // if the file is empty it output the message
    } 
    else 
    {
        std::cout << "List of Payment: " << std::endl;
        std::cout << "" << std::endl;
        std::cout << "Enrolment No." << "Amount" << "Outstanding" << std::endl;

        // If there is Student Code that has the same number, it need to combined the amount it paid 
        // For an example 
        // Student Code: 12 Amount: 25
        // Student Code: 12 Amount: 50
        // so it should display the following when the program runs:
        // Student Code: 12 Amount: 75

        while(!infile.eof())            // output the description of the text file onto the screen
        {
            getline(infile,StudentCode,Amount);

            Outstanding = Amount - 100;

            std::cout << StudentCode << Amount << "$" << Outstanding << std::endl;
            //iter++;
        }
        std::cout << "End of list\n" << std::endl;
    }

    infile.close();         // close the text file  
} 
```

getline 部分有什么问题：

```
getline(infile,StudentCode, Amount); 
```

此外，该程序不应显示重复的学生代码，而是结合其支付的金额。我在评论部分解释的地方

```
// If there is Student Code that has the same number ..... 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:13:00.120

[`getline`](http://www.cplusplus.com/reference/string/getline/)将流中的一行读入字符串。你想要做的，更像是这样

```
while (infile >> StudentCode >> Amount) {
    // process values
} 
```

如果要汇总所有金额，则必须先累积，然后循环收集的值并打印它们

```
std::map<int, float> amountsPaid;
int studentCode;
float amount;
// accumulate amounts
while (infile >> studentCode >> amount) {
    amountsPaid[studentCode] += amount;
}

// loop through map and print all entries
for (auto i = amountsPaid.begin(); i != amountsPaid.end(); ++i) {
    float outstanding = i->second - 100;
    std::cout << i->first << ": " << i->second << "$, " << outstanding << '\n';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T22:16:17.713

这里有几个问题。一种是`getline`将一行文本读入单个`std::string`变量，而不是多个`float`字段。

为此，您可以尝试

```
infile >> StudentCode >> Amount; 
```

第二个问题是

```
while(!infile.eof()) 
```

不会检查下一个输入是否可以工作，但如果上*一个*输入尝试失败，因为它到达文件结尾。

标准方法是将这些组合成

```
while (infile >> StudentCode >> Amount)
{
    // do something with the code and amount
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T22:15:34.200

您对 getline 的调用似乎不正确。

该文件指出

```
istream& getline ( istream& is, string& str, char delim ); 
```

但是你给它

```
getline(istream&, float, float); 
```

您应该尝试将该行作为字符串读取，然后解析出 2 个浮点数。

由于您使用的是 c++，如果文件格式正确，您可以重定向 cin，它会更容易。你可以做类似的事情

```
while (infile >> StudentCode) {
  infile >> Amount;
} 
```

# ajax - 页面刷新后Jquery Mobile提交按钮不起作用

> ID：13829324
> 
> 赞同：0
> 
> 时间：2012-12-11T22:08:56.367
> 
> 标签：ajax, jquery-mobile

我有一个带有弹出 div 的单页标记，其中包含用户可以用来更新他/她的帐户信息的表单。提交表单后，弹出窗口关闭，页面刷新，显示位于 li 内的更新信息（这似乎有效）。问题是，如果用户返回并尝试再次更新，则弹出窗口中的按钮不会提交。

在此先感谢您的任何建议！！！

Javascript

```
$('#updateadmin').click(function() {
var admin = $('#adminform').serializeArray();
/*alert(admin);*/
$.ajax({
type: "POST",
url: 'adminupdate.php',
data: admin,
success: function(data) {
            if(data=="success") {
                $('#admindiv').popup('close');
                $.mobile.changePage('companyinfo.php', { 
                    allowSamePageTransition: true,
                    transition: 'none',
                    reloadPage: true,
                    changeHash: false
                });
            } else {
                $('#adminupdatestatus').html(data).css({color: "red"}).fadeIn(1000);
            }
         }
});
return false;
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-11T22:33:12.527

听起来`#updateadmin`链接/按钮位于重新加载的页面上，如果是这种情况，那么您应该委托您的事件处理程序，以便它始终影响 DOM 中的匹配元素，而不仅仅是在代码运行时。

你会改变这个：

```
$('#updateadmin').click(function() { 
```

对此：

```
$(document).on("click", "#updateadmin", function() { 
```

这是有效的，因为您现在将事件处理程序附加到`document`始终存在的元素上。当事件到达`document`元素时，会检查它们最初触发的元素是否与我们作为第二个参数放置的选择器匹配`.on()`。

文档`.on()`：[http ://api.jquery.com/on](http://api.jquery.com/on)

# emr - 将文件从 S3 复制到 Amazon EMR 上的 maprfs

> ID：13829330
> 
> 赞同：1
> 
> 时间：2012-12-11T22:09:15.200
> 
> 标签：emr, mapr

有谁知道使用 Amazon 的 S3Distcp 工具和在 EMR 上运行的 MapR 是否存在问题？我正在尝试使用它，但在 /mnt/var/log/hadoop/steps 中不断出现以下异常：

```
Exception in thread "main" java.lang.RuntimeException: Unable to delete directory hdfs:/tmp/e9333a37-f400-4982-9687-326e33d9b37d/files
at com.amazon.external.elasticmapreduce.s3distcp.S3DistCp.deleteRecursive(S3DistCp.java:606)
at com.amazon.external.elasticmapreduce.s3distcp.S3DistCp.run(S3DistCp.java:464)
at com.amazon.external.elasticmapreduce.s3distcp.S3DistCp.run(S3DistCp.java:216)
at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)
at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:79)
at com.amazon.external.elasticmapreduce.s3distcp.Main.main(Main.java:12)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.hadoop.util.RunJar.main(RunJar.java:186)
Caused by: java.io.IOException: Incomplete HDFS URI, no host: hdfs:/tmp/e9333a37-f400-4982-9687-326e33d9b37d/files
at org.apache.hadoop.hdfs.DistributedFileSystem.initialize(DistributedFileSystem.java:85)
at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:1416)
at org.apache.hadoop.fs.FileSystem.access$100(FileSystem.java:69)
at org.apache.hadoop.fs.FileSystem$Cache.getInternal(FileSystem.java:1450)
at org.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:1432)
at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:232)
at com.amazon.external.elasticmapreduce.s3distcp.S3DistCp.deleteRecursive(S3DistCp.java:603) 
```

我用来提交作业步骤的命令行是：

```
elastic-mapreduce --jobflow $JOB_ID --jar s3://us-east-1.elasticmapreduce/libs/s3distcp/1.latest/s3distcp.jar \
--args '--src,s3n://PVData/raw, \
--dest,/PVData/raw' 
```

对于 --dest 参数，我也尝试了 maprfs:///PVData/raw 和 hdfs:///PVData/raw ，但它们也不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T01:43:14.683

我在 MapR 论坛 (http://bit.ly/S7gzcv) 上得到了这个问题的答案。问题是我需要使用 s3distcp 的 --tmpDir 参数将临时目录指定为 maprfs:///tmp

# java - Java SecretKeySpec 的 C# 等价物是什么

> ID：13829332
> 
> 赞同：12
> 
> 时间：2012-12-11T22:09:31.300
> 
> 标签：java, c#, cryptography, sha1, hmac

我有以下用 Java 编写的代码

```
Mac mac = Mac.getInstance("HmacSHA1");
String secretKey ="sKey";
String content ="Hello";

byte[] secretKeyBArr = secretKey.getBytes();    
byte[] contentBArr = content.getBytes();

SecretKeySpec secret_key = new SecretKeySpec(secretKeyBArr,"HmacSHA1");
byte[] secretKeySpecArr = secret_key.getEncoded();

mac.init(secret_key);

byte[] final = mac.doFinal(contentBArr); 
```

我想在 C# 中做同样的例子。所以，我写了以下代码

```
HMACSHA1 hmacsha1 = new HMACSHA1();
string secretKey = "sKey";
string content = "Hello";

byte[] secretKeyBArr = Encoding.UTF8.GetBytes(secretKey);
byte[] contentBArr = Encoding.UTF8.GetBytes(content);

hmacsha1.Key = secretKeyBArr;
byte[] final = hmacsha1.ComputeHash(contentBArr); 
```

最终结果并不相同。secretKeyBArr 和 contentBArr 是字节数组，它们的值在两个示例中相同。未知的是传递给 mac.init() 的 SecretKeySpec。那么，什么是 C# 中的等价类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:20:26.960

结果是相同的，但默认情况下 Java 使用有符号字节，而 C# 使用无符号字节。

此外，`SecretKeySpec`它本身通常不会更改基础数据。例如，您需要在 a 中放置一个 DES 密钥规范，`SecretKeyFactory`以确保正确设置奇偶校验位（在结果中`SecretKey`）。所以不需要等价物，因为类本身除了包装数据外几乎没有什么作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-01T19:56:32.510

我正在从不提供 .net 实现的提供商（cardinity）实现信用卡支付方式。我正在寻找类似的东西并最终编写自己的东西，因为我的谷歌技能似乎是......

我需要的是 javax.crypto.mac 的 base64 字符串

我支持以下方法：

```
enum EncryptionMethods
{
    None=0,
    HMACSHA1,
    HMACSHA256,
    HMACSHA384,
    HMACSHA512,
    HMACMD5
} 
```

我已经通过以下方式实现了您上面的代码、SecretKeySpec 和 Mac（您需要 System.Security.Cryptography.ProtectedData）：

```
internal class Protected
{
    private  Byte[] salt = Guid.NewGuid().ToByteArray();

    protected byte[] Protect(byte[] data)
    {
        try
        {
            return ProtectedData.Protect(data, salt, DataProtectionScope.CurrentUser);
        }
        catch (CryptographicException)//no reason for hackers to know it failed
        {
            return null;
        }
    }

    protected byte[] Unprotect(byte[] data)
    {
        try
        {
            return ProtectedData.Unprotect(data, salt, DataProtectionScope.CurrentUser);
        }
        catch (CryptographicException)//no reason for hackers to know it failed
        {
            return null;
        }
    }
}

internal class SecretKeySpec:Protected,IDisposable
{
    readonly EncryptionMethods _method;

    private byte[] _secretKey;
    public SecretKeySpec(byte[] secretKey, EncryptionMethods encryptionMethod)
    {
        _secretKey = Protect(secretKey);
        _method = encryptionMethod;
    }

    public EncryptionMethods Method => _method;
    public byte[] SecretKey => Unprotect( _secretKey);

    public void Dispose()
    {
        if (_secretKey == null)
            return;
        //overwrite array memory
        for (int i = 0; i < _secretKey.Length; i++)
        {
            _secretKey[i] = 0;
        }

        //set-null
        _secretKey = null;
    }
    ~SecretKeySpec()
    {
        Dispose();
    }
}

internal class Mac : Protected,IDisposable
{
    byte[] rawHmac;
    HMAC mac;
    public Mac(SecretKeySpec key, string data)
    {

        switch (key.Method)
        {
            case EncryptionMethods.HMACMD5:
                mac = new HMACMD5(key.SecretKey);
                break;
            case EncryptionMethods.HMACSHA512:
                mac = new HMACSHA512(key.SecretKey);
                break;
            case EncryptionMethods.HMACSHA384:
                mac = new HMACSHA384(key.SecretKey);
                break;
            case EncryptionMethods.HMACSHA256:
                mac = new HMACSHA256(key.SecretKey);

            break;
            case EncryptionMethods.HMACSHA1:
                mac = new HMACSHA1(key.SecretKey);
                break;

            default:                    
                throw new NotSupportedException("not supported HMAC");
        }
        rawHmac = Protect( mac.ComputeHash(Cardinity.ENCODING.GetBytes(data)));            

    }

    public string AsBase64()
    {
        return System.Convert.ToBase64String(Unprotect(rawHmac));
    }

    public void Dispose()
    {
        if (rawHmac != null)
        {
            //overwrite memory address
            for (int i = 0; i < rawHmac.Length; i++)
            {
                rawHmac[i] = 0;
            }

            //release memory now
            rawHmac = null;

        }
        mac?.Dispose();
        mac = null;

    }
    ~Mac()
    {
        Dispose();
    }
} 
```

我已经通过以下方式在 OAuthSigner 类中实现了这一点：

```
public override string ComputeSignature(string plainTextToEncode, string consumerSecret)
{
    var key = PercentEncode(consumerSecret) + "&";
    try
    {
        using (var secretKey = new SecretKeySpec(key.GetBytes(), EncryptionMethods.HMACSHA1))
        using (Mac mac = new Mac(secretKey, plainTextToEncode))
        {
            return mac.AsBase64();
        }
    }
    finally
    {
        key = null;//free memory, remove sensitive data
    }
} 
```

然后，这不是您要求的，但我需要一个辅助方法，因为我将文本发送到这样的 Web 服务，并且我将其包括在内，因为有些人可能会复制代码：

```
public static String PercentEncode(string textToEncode)
{

    return string.IsNullOrEmpty(textToEncode)
        ?""
        : UrlEncoder.Default.Encode(Cardinity.ENCODING.GetString(Cardinity.ENCODING.GetBytes(textToEncode)))
            .Replace("+", "%20").Replace("*", "%2A")
            .Replace("%7E", "~");

} 
```

UrlEncoder 类来自 System.Text.Encodings.Web，您可能需要添加引用。

名为 Cardinity 的类实现了我用于 Cardinity 的 Encoding 的“捷径”

```
public abstract class Cardinity
{
    ...
    public static String API_BASE = "https://api.cardinity.com";
    public static String API_VERSION = "v1";
    public static String VERSION = "0.1";
    public static String ENCODING_CHARSET = "UTF-8";
    public static Encoding ENCODING => Encoding.UTF8;
} 
```

由于 Java 经常使用 string.GetBytes，我为此添加了一个扩展方法，我在上面的*key.GetBytes()*中调用它，这是扩展代码：

```
public static byte[] GetBytes(this string sender)=>
            Cardinity.ENCODING.GetBytes(sender); 
```

我的测试方法，我已经复制了 Cardinity [API](https://github.com/cardinity/cardinity-sdk-java/blob/master/src/test/java/com/cardinity/oauth/OAuthHmacSignerTest.java)传递的值，没有任何问题。

```
private OAuthSigner signer;
public HmacOAuthSigner_Test()
{
    signer = new HmacOAuthSigner();
}

[TestMethod]
public void Test_HmacOAuthSigner_ComputeSignature_DefaultText()
{
    var expects = "PxkffxyQh6jsDNcgJ23GpAxs2y8=";
    var test_data = "justsomerandommessage";
    var secretkey = "yvp0leodf231ihv9u29uuq6w8o4cat9qz2nkvs55oeu833s621";

    var actual = signer.ComputeSignature(test_data, secretkey);
    Assert.AreEqual(expects, actual, $"Expecting {test_data} to return {expects} received {actual}");
} 
```

HmacOAuthSigner 的完整实现在这里，它实现了一个带有 PercentEncode 方法的抽象类。

```
public class HmacOAuthSigner : OAuthSigner
{
    public override string ComputeSignature(string signatureBaseString, string consumerSecret)
    {
        var key = PercentEncode(consumerSecret) + "&";
        var secretKey = new SecretKeySpec(key.GetBytes(), EncryptionMethods.HMACSHA1);
        using (Mac mac = new Mac(secretKey, signatureBaseString))
        {
            return mac.AsBase64();
        }
    }

    public override string GetSignatureMethod()
    {
        return "HMAC-SHA1";
    }
} 
```

以及我用作所有实现合同的抽象类：

```
public abstract class OAuthSigner
{
    /// <summary>
    /// Signature method used
    /// </summary>
    /// <returns>a string that tells the implementation method</returns>
    public abstract string GetSignatureMethod();

    /// <summary>
    /// computes the signature that is used with the encryption based on the keys provided by cardinity
    /// </summary>
    /// <param name="signatureBaseString">The secret string that services as a base</param>
    /// <param name="consumerSecret">The consumer key as specified in the API settings</param>
    /// <returns>signature string computed by the provided parameters using the signature method</returns>
    public abstract string ComputeSignature(String signatureBaseString, String consumerSecret);

    /// <summary>
    /// Encode a string into a format expected by Cardinity
    /// </summary>
    /// <param name="textToEncode">The text that is to be encoded</param>
    /// <returns>web encoded string ready for using to send to Cardinity</returns>
    public static String PercentEncode(string textToEncode)
    {

        return string.IsNullOrEmpty(textToEncode)
            ?""
            : UrlEncoder.Default.Encode(Cardinity.ENCODING.GetString(Cardinity.ENCODING.GetBytes(textToEncode)))
                .Replace("+", "%20").Replace("*", "%2A")
                .Replace("%7E", "~");

    }
} 
```

# c# - 使用 LINQ to SQL 从同一视图插入多个表

> ID：13829341
> 
> 赞同：0
> 
> 时间：2012-12-11T22:10:04.477
> 
> 标签：c#, sql-server, linq

我刚刚在 SQL Server 2008 中设计了我的数据库，现在我开始实际实施我有以下问题：我有一个视图（一个 aspx 页面），它提交一个学生注册到一个机构。此页面插入与大约 3 个表（学生/父母和地址）有关。如何使用 linq to sql 同时将收集到的详细信息插入 3 个表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:50:06.667

您将拥有三个插入语句。如果您需要它们全部失败或成功，请将它们放入事务中。

```
using (var transaction = new TransactionScope())
{
  try
  {
    //insert statements

    transaction.Complete();
  }
} 
```

# javascript - SVG：在悬停时将填充颜色应用于“蒙版”图像

> ID：13829347
> 
> 赞同：2
> 
> 时间：2012-12-11T22:10:49.193
> 
> 标签：javascript, jquery, css, svg

我`clipPath`用来对图像应用不同的“蒙版”效果。

如何在悬停时用颜色填充剪切的图像？我已经尝试`:hover`在 CSS 中使用，但这似乎不起作用，除非我针对的是不正确的元素。

我在这个项目中使用 jQuery，所以如果需要 JS 解决方案，我可以依靠 jQuery。

这是我正在使用的 HTML：

```
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100">
  <defs>
    <clipPath id="ellipse">
      <ellipse cx="50" cy="35.5" rx="49.5" ry="35" />
    </clipPath>
    <clipPath id="hexagon">
      <polygon points="25, 0  75, 0 100, 43.30127018922193 75, 86.60254037844386  25, 86.60254037844386  0, 43.30127018922193"/>
    </clipPath>
    <clipPath id="rectangle">
      <rect x="0" y="0" width="100" height="70"></rect>
    </clipPath>
  </defs>
  <g>
    <image preserveAspectRatio="none" x="0" y="0" width="100%" height="100%" xlink:href="http://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Bucephala-albeola-010.jpg/800px-Bucephala-albeola-010.jpg" id="clippy" clip-path="url(#hexagon)">
  </g>
</svg> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-12T00:22:54.713

您可能希望使用滤镜效果在悬停时为图像提供一些颜色（[请参阅 Tinkerbin](http://tinkerbin.com/vIB6xTpL)）：

```
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100">
  <style type="text/css">
    image:hover {
      filter:url(#Matrix);
    }
  </style>
  <defs>
    <clipPath id="ellipse">
      <ellipse cx="50" cy="35.5" rx="49.5" ry="35" />
    </clipPath>
    <clipPath id="hexagon">
      <polygon points="25, 0  75, 0 100, 43.30127018922193 75, 86.60254037844386  25, 86.60254037844386  0, 43.30127018922193"/>
    </clipPath>
    <clipPath id="rectangle">
      <rect x="0" y="0" width="100" height="70"></rect>
    </clipPath>
    <filter id="Matrix" filterUnits="objectBoundingBox" 
            x="0%" y="0%" width="100%" height="100%">
      <feColorMatrix type="matrix" in="SourceGraphic"
           values="1 0 0 0 .5 
                   .1 .9 0 0 0 
                   .1 0 .9 0 0 
                   0 0 0 1 0"/>
    </filter>
  </defs>
  <g>
    <image preserveAspectRatio="none" x="0" y="0" width="100%" height="100%" xlink:href="http://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Bucephala-albeola-010.jpg/800px-Bucephala-albeola-010.jpg" id="clippy" clip-path="url(#hexagon)">
  </g>
</svg> 
```

**编辑：**关于过滤器的一些解释：

应用的滤镜会改变每个光栅像素的颜色。它取其原始颜色值，将 指定的矩阵应用于`<feColorMatrix>`颜色向量，生成的颜色向量成为显示的颜色。

**矩阵是如何工作的？**

该矩阵由四行组成。第一行计算新的红色分量，第二行计算绿色分量，第三行计算蓝色分量，第四行计算 alpha。

每行的五个数字是什么意思？第一个数字乘以原始颜色的红色分量，第二个乘以绿色，第三个蓝色，第四个 alpha。将所有四个乘积相加，并将行中的第五个值也相加（作为不依赖于任何原始颜色分量的常数）。

让我们看一下上面的示例：假设我们有一个灰色像素，其颜色值如下

```
rgba(25%,25%,25%,1) 
```

产生的红色值是多少？计算红色值的第一行是

```
1 0 0 0 .5 
```

我们计算如下：

```
 1*r   + 0*g   + 0*b   + 0*a + .5
= 1*.25 + 0*.25 + 0*.25 + 0*1 + .5 = .75 
```

这意味着，生成的像素红色分量为 75%。其他分量以类似方式计算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T00:34:51.930

不确定这是否正是您想要的。鼠标事件不会发送到剪贴区之外的区域。又快又脏，在 IE9 中工作，例如没有在 FF 中测试过。

```
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100">
    <script type="application/ecmascript">
        function fillit(evt) {
            document.getElementById('fillarea').setAttribute('display', 'visible');
        }

        function emptyit(evt) {
            document.getElementById('fillarea').setAttribute('display', 'none');
        }
    </script>
    <defs>
        <clipPath id="ellipse">
            <ellipse cx="50" cy="35.5" rx="49.5" ry="35" />
        </clipPath>
        <clipPath id="hexagon">
            <polygon points="25, 0  75, 0 100, 43.30127018922193 75, 86.60254037844386  25, 86.60254037844386  0, 43.30127018922193" />
        </clipPath>
        <clipPath id="rectangle">
            <rect x="0" y="0" width="100" height="70"></rect>
        </clipPath>
    </defs>
    <g>
        <image preserveAspectRatio="none" x="0" y="0" width="100%" height="100%" 
               xlink:href="http://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Bucephala-albeola-010.jpg/800px-Bucephala-albeola-010.jpg" 
               id="clippy" clip-path="url(#hexagon)" onmouseover="fillit(evt)" />
        <rect x="0" y="0" width="100%" height="100%" fill="red" display="none" 
              id="fillarea" clip-path="url(#hexagon)" onmouseout="emptyit(evt)" />
    </g>
</svg> 
```

# excel - excel最新n行

> ID：13829353
> 
> 赞同：0
> 
> 时间：2012-12-11T22:11:04.297
> 
> 标签：excel, excel-formula, worksheet-function

我正在尝试检索非空白的最新 6 行的值。正如你在图片中看到的，我会得到从 54 到 39 的所有值，但是如果两个空白单元格有数字，那么计数将在 45 处停止。

维苏莱

![在此处输入图像描述](../Images/bb206c932f0aaaae4e707e0a87824bc6.png)

在另一个选项卡上，我有一个`INDEX`函数试图获取这些数字，但仅适用于找到的第一个值。例如，这给出`54`了第一个值。 `=INDEX(Database!b5:b50,MATCH(TRUE,INDEX((Database!b5:b50<>0),0),0))`

我想扩展它并使用它来调用任何`nth`值，最好是前 6 个。所以每次我更新日期并添加新值时，前 6 个单元格都会自动更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:19:02.830

你快到了。只需将 +n 添加到外部 INDEX 公式的最后一个参数。例如，这将获取下一个项目 51：

```
=INDEX(database!B5:B50,MATCH(TRUE,INDEX((database!B5:B50<>0),0),0)+1) 
```

# c# - 实体框架 - 在没有设置访问器的情况下定义 get

> ID：13829354
> 
> 赞同：0
> 
> 时间：2012-12-11T22:11:10.357
> 
> 标签：c#, get, ef-code-first, set, entity-framework-5

我在 Visual Studio 2012 中创建了一个新的类库项目，以定义数据类，以便首先使用实体​​框架代码创建新的数据库。所以我创建了3个类：

产品如下：

```
namespace MyClassLibrary
{
    public class Product
    {
        public virtual int ID { get; set; }
        public virtual string Name { get; set; }
    }
} 
```

类别如下：

```
using System.Collections.Generic;

namespace MyClassLibrary
{
    public class Department
    {
        public virtual int ID { get; set; }
        public virtual string Name { get; set; }
        public virtual ICollection<Product> Products { get; set; }
    }
} 
```

和 ICategoryDataSource 作为下一个：

```
using System.Linq;

namespace MyClassLibrary
{
    public class ICategoryDataSource
    {
        IQueryable<Product> Products { get; }
        IQueryable<Category> Categories { get; }
    }
} 
```

在最后一堂课中，我收到下一条错误消息：“MyClassLibrary.ICategoryDataSource.Products.get”必须声明一个主体，因为它没有标记为抽象或外部。自动实现的属性必须同时定义 get 和 set 访问器。

我在这里不需要设置器，请告知如何避免使用设置访问器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:14:53.333

根据最后代码部分中的名称，我假设您想`ICategoryDataSource`成为一个接口，而不是一个类：

```
using System.Linq;

namespace MyClassLibrary
{
    public interface ICategoryDataSource
    {
        IQueryable<Product> Products { get; }
        IQueryable<Category> Categories { get; }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T22:35:58.903

您永远不能在**只有**自动 getter 或自动 setter 的具体类中拥有自动属性。您如何将数据放入该属性以便能够将其提取出来？

但是，您*可以*在抽象类或接口中执行此操作，它们都有效地表示“我不在乎数据如何进入这里，我只需要可以将其拉出”。

可能您需要的是私人二传手。

```
public IQueryable<Product> Products { get; private set; } 
```

在任何课程中都是完全有效的。

# javascript - 当在装有 Windows Vista 的新启动计算机上的 Chrome 中打开我的 asp.net 站点时，网页加载非常缓慢/vista 会停止一段时间？

> ID：13829356
> 
> 赞同：0
> 
> 时间：2012-12-11T22:11:20.167
> 
> 标签：javascript, asp.net, google-chrome, windows-vista

当在装有 Windows Vista 的新启动计算机上的 Chrome 中打开我的 asp.net 站点时，网页加载非常缓慢/vista 会停止一段时间？它在带有chrome的windows7中运行良好。可能是 chrome 和 Vista 有问题，还是我的网站有问题？

# android - Android 对话框根视图

> ID：13829357
> 
> 赞同：1
> 
> 时间：2012-12-11T22:11:23.693
> 
> 标签：android, layout, dialog

我在 Android 中有一个对话框，作为我使用此文件的布局：

```
<?xml version="1.0" encoding="utf-8"?> <ListView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

</ListView> 
```

在我需要向这个 ListView 添加一个适配器的活动中，我有这个：

```
@Override
protected Dialog onCreateDialog(int id) {
    switch(id){
    case ADDPLAYERDIALOG:{
        Dialog d = new Dialog(this);            
        d.setContentView(R.layout.training_dialog);
        ListView lv = (ListView) d.getCurrentFocus().getRootView(); 
        ListAdapter adapter = new ArrayAdapter<String>(getBaseContext(), android.R.layout.simple_list_item_1, createNamesList());   
        lv.setAdapter(adapter);     

    return d;
    }
    }
    return super.onCreateDialog(id);
} 
```

我在这里得到一个 NullPointerException：

```
 ListView lv = (ListView) d.getCurrentFocus().getRootView(); 
```

我没有这个 ListView 小部件的 id，因为它是一个布局 XML 文件，我不能只写`lv = d.findViewById(R.id.listview);`

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:22:03.273

您可以通过 xml 轻松设置 id。你使用`android:id`标签。

您的 listview 节点应如下所示：

```
<ListView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" 
    android:id = "@+id/listview">
</ListView> 
```

现在你`lv = d.findViewById(R.id.listview);`应该工作了。

# validation - MVC.NET：在控制器和服务（业务）层之间共享验证规则

> ID：13829358
> 
> 赞同：1
> 
> 时间：2012-12-11T22:11:29.180
> 
> 标签：validation, asp.net-mvc-4

我正在做一个项目，我们有多个 UI（视图）模型，其中包含`DataAnnotations`用于验证的属性，主要用于输入，例如必填字段、长度、正则表达式等）：

```
[Required]
public int Order { get; set; }
[Required]
[MaxLength(150)]
public string Title { get; set; } 
```

在将对象交给服务层之前，控制器会检查 ModelState 以确保对象有效。

现在，服务层还验证对象以适应未来可能需要新控制器支持其他输出格式或其他实用程序来批量导入对象的更改。

**我的问题是：**知道在控制器处理 UI 模型和服务层处理业务对象的地方应该分离关注点，因此，我不想将 UI 模型对象传递给服务层，最好的方法是什么？重用 UI 模型对象中的验证规则？还是应该使用服务层中的代码来复制它们？或者也应该`DataAnnotations`添加到业务对象中？

我**首先使用 EF 模型**，所以我没有看到将这些注释添加到自动生成的 POCO 的简单方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:26:52.517

为什么不使用 FluentValidation？这样，您可以为每个视图模型创建一个验证器，并在需要时在您的 UI 层和服务层中运行它们。它还消除了使用验证属性装饰视图模型的需要。[http://fluentvalidation.codeplex.com/](http://fluentvalidation.codeplex.com/)

# wordpress - 优惠券代码存储在哪里？

> ID：13829360
> 
> 赞同：0
> 
> 时间：2012-12-11T22:11:32.407
> 
> 标签：wordpress, jigoshop

对于 Jigoshop Wordpress 插件，优惠券代码存储在数据库的哪个位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-01T18:51:06.833

老问题，但仍然需要答案。优惠券代码作为自定义帖子类型存储在`wp_posts`表中。他们使用的自定义帖子类型是`shop-coupon`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-21T16:38:37.397

Select * from [DB TABLE NAME] where post_type='shop_coupon'

# sql - 您如何将数字表与具有许多子句的实际表复杂连接，这些子句依赖于数字表中的数据？

> ID：13829361
> 
> 赞同：0
> 
> 时间：2012-12-11T22:11:32.540
> 
> 标签：sql, plsql

我有一个数字表（包含从网站传入的 some_table_line_ids 的 PLSQL 集合）。

然后我有 some_table 也有列 -> config_data, config_state

我想从数字表中的所有 table_id 中提取所有具有相同 table_id 的行。

我还想拉入与从第一部分拉入的每条记录具有相同 config_data 的所有行。

所以它是一种父/子关系。这可以在两个 for 循环中完成，方法是通过光标中的 id 选择一行，然后另一个 for 循环选择等于父配置数据的每一行。每个循环我都在每一行上执行数据操作。

我想将这两个组合成一个具有我需要的所有表 ID 的单个游标。那会是什么样子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:20:41.937

您只想对不同的因素进行复杂的联接。就像是：

```
select st2.*
from numbers n join
     some_table st
     on st.table_id = n.table_id join
     some_table st2
     on st2.config_data = st.config_data 
```

很可能，您实际上想要：

```
select distinct st.* 
```

因为否则您可能会有重复项。或者，您可能想要：

```
select n.table_id, st.config_data, st2.* 
```

因此，您知道哪个原始值负责引入该行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T13:44:15.910

我使用 start with 和 connect by prior 解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T22:26:26.007

您将数组描述为 PL/SQL 集合。如果您使用 SQL 类型，则可以使用 TABLE 函数将其包含在 FROM 子句中。

```
create type some_table_line_id_nt as table of number; 
```

就像是：

```
select s.*
from some_table s
      join table(some_table_line_ids) t
          on s.id = t.column_value 
```

（我没有提供完整的解决方案，因为您没有提供足够的表结构和数据详细信息。）

# python - 如何修补 SUDS python

> ID：13829363
> 
> 赞同：1
> 
> 时间：2012-12-11T22:11:33.860
> 
> 标签：python, soap

我正在尝试使用带有 SUDS 的 Python 对 Cisco AXL 接口进行 SOAP 调用。类似于“[有效的 SOAP 调用在 Python SUDS 中不起作用](https://stackoverflow.com/questions/4578802/valid-soap-call-not-working-in-python-suds.)”。我也关注了答案。但是，我仍然遇到同样的错误`Item not valid`

因为我有 SUDS4.1，所以我没有在 SUDS 上应用任何补丁。我在想可能是补丁可以解决我的问题。所以我想知道我应该应用什么补丁以及如何应用补丁。

# php - 加载外部 XML 并使用 PHP 保存

> ID：13829364
> 
> 赞同：0
> 
> 时间：2012-12-11T22:11:40.940
> 
> 标签：php, xml

我想加载并保存一个`XML`不断变化的外部文件，例如“http://something.com/file.xml”

有时文件不可用，因为服务器超载或停机，我想改用这个文件，如果下一次加载可用则重新保存它也让人们知道他们正在阅读的文件是备份文件，因为原始文件不是可用的。

我阅读了有关 simplexml_load_file 和 DOMDocument 的信息，但我不知道哪个是更好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:27:09.820

```
$url = "http://www.test.com/xmlfile.xml";
$timeout = 10;

$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, $url);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($curl, CURLOPT_CONNECTTIMEOUT, $timeout);

try {
    $response = curl_exec($curl);
    curl_close($curl);

    // success! Let's parse it and perform whatever action necessary here.
    if ($response !== false) {
        /** @var $xml SimpleXMLElement */
        $xml = simplexml_load_string($response);
        $xml->saveXML("tofile.xml");
    } else {
        // Warn the user here
    }
} catch (Exception $ex) {
    // Let user's know that there was a problem
    curl_close($curl);
} 
```

# r - 将多个绘图和数据面板导出到 *.png（在样式 layout() 中在 R 中工作）

> ID：13829365
> 
> 赞同：4
> 
> 时间：2012-12-11T22:11:52.693
> 
> 标签：r, plot

我正在尝试使用 .png 设备或 .pdf 设备将多个数据面板和 1 个绘图导出为单个图像，但我没有遇到任何成功。我可以使用 R 原生绘图设备在 R 中生成我想要的图像，但是当我尝试直接生成相同的图像时，我得到了我没有预料到的结果。

这是我的示例代码

```
testMat <- matrix(1:20, ncol = 5)##  create data
testMatDF <- as.data.frame(testMat)
names(testMatDF) <- c("Hey there", "Column 2", 
         "Some * Symbols", "And ^ More", 
         "Final Column")
rownames(testMatDF) <- paste("Group", 1:4)

library(gplots) ##  gplots needed for textplot()
layout(matrix(c(1, 1, 2, 3, 3, 3),  2, 3, byrow = TRUE))
curve(dnorm, -3, 4)
textplot(testMat)
textplot(testMatDF)
##  produces what I want within R

layout(matrix(c(1, 1, 2, 3, 3, 3),  2, 3, byrow = TRUE))
png(file='plot1.png')
curve(dnorm, -3, 4)
textplot(testMat)
textplot(testMatDF)
dev.off()
##  only the last function texplot(testMatDF) gets output, not what I anticipated 
```

我也尝试过`mfrow()`图形参数但没有成功。

```
par(mfrow= c(3, 1))
png(file='plot2.png')
curve(dnorm, -3, 4)
textplot(testMat)
textplot(testMatDF)
dev.off()
##  only the last function texplot(testMatDF) gets output 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-11T22:17:30.017

如果您将呼叫移至`par`或`layout`在打开图形设备之后，它应该可以正常工作。

```
png(file='plot2.png')
par(mfrow= c(3, 1))
curve(dnorm, -3, 4)
textplot(testMat)
textplot(testMatDF)
dev.off() 
```

# ruby-on-rails - 如何从 Rails 视图触发 javascript 函数？

> ID：13829370
> 
> 赞同：0
> 
> 时间：2012-12-11T22:12:14.670
> 
> 标签：ruby-on-rails, unobtrusive-javascript

我在我的视图中有这张图片，我想在点击时链接到一个javascript函数（准确地说是coffeescript：

```
<%= image_tag("minus_un.png", {:id =>"entree-show-minus-2", :title => "test bouteille", :onclick => "EditCount(" + @entree.id.to_s + ")"}) %> 
```

在我的`.js.coffee`文件中，我有这个：

```
EditCount = (id) ->
  console.log "coin_" + id.to_s 
```

但是单击图像会收到错误消息`Uncaught ReferenceError: EditCount is not defined`。为什么找不到？和以下`jQuery(document).ready ->`都正确执行。

另外，我想知道这是否是正确的方法。通过这样做，我在视图中引用了 JS 函数，我不确定这是不是正确的不显眼的 javascript。
另一种方法是使用`$("#entree-show-minus-2").live("click", {block} )`语法。它可以工作，但这意味着我必须从 DOM 中的某些元素中检索所需的参数，这似乎很乏味。

最佳做法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:29:53.510

使用您的替代方法并通过图像标签上的数据属性传递参数。

# java - 对复杂数组进行排序

> ID：13829371
> 
> 赞同：-2
> 
> 时间：2012-12-11T22:12:17.137
> 
> 标签：java, arrays, function, sorting

我的作业中有问题说：

> 给定一个元素全为 0（零）或 1（一）的未排序数组，编写代码对数组进行排序，使所有的 0 首先出现，然后是所有的 1。您可以假设“num_elements”总是准确地指示数组中的元素数量。请使用以下函数头：

```
void sort_elements(int array[], int num_elements); 
```

# 我真的不知道他的意思是什么，他想要两个数组还是一个。请给我解释一下。

**我做到了：DI 不敢相信自己，我使用了 2 个 for 循环，其中有 2 个 if .. 谢谢大家的帮助 <3 <3**

```
public class Q4 {

    public static void main (String []args){

         int Sky[]={0,0,1,1,0,1};
         sort_elements(Sky,Sky.length);          
       }

      public static void  sort_elements(int array[],int num_elements){
         for ( int i=0; i < num_elements ; i++){
            if ( array[i]==0){
               System.out.println(array[i]);
            }
        }

         for ( int i=0; i<num_elements ; i++){
            if ( array[i]==1){
               System.out.println(array[i]);
            }
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:16:15.620

1) 保持左右两个指针。
2) 开始向右遍历左指针，直到遇到 1。
3) 将右指针向左开始，直到遇到 0。
4) 设置 array[left] = 0, array[right] = 1
5) 继续这样做，直到左右指针收敛。
6) 由于我们只需要遍历数组一次，因此排序发生在 O(n) 时间内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:15:40.807

从问题陈述中可以清楚地看出，您的函数应该`array`就地排序。

至于实际实现这一点，请阅读[count sort](http://en.wikipedia.org/wiki/Counting_sort)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T22:18:09.523

如果我正在实施这个，我只需要一行：

```
Arrays.sort(array); 
```

# backup - Packages/User 目录中存储了什么？

> ID：13829376
> 
> 赞同：0
> 
> 时间：2012-12-11T22:12:48.103
> 
> 标签：backup, sublimetext2

[如何保存/恢复 Sublime Text 2 配置/插件以迁移到另一台计算机？](https://stackoverflow.com/questions/11365948/how-to-save-restore-sublime-text-2-configs-plugins-to-migrate-to-another-compute)声明，要备份 Sublime Text 2 安装，用户应该保留`~/Packages/User`目录（从他们正在使用的任何操作系统上的用户本地数据文件夹中）。

但是，[http://andrew.hedges.name/blog/2012/01/19/sublime-text-2-more-sublime-with-a-drop-of-dropbox](http://andrew.hedges.name/blog/2012/01/19/sublime-text-2-more-sublime-with-a-drop-of-dropbox)和大多数其他使用 Dropbox 同步 Sublime 设置的演练指定三个目录`~/Packages`：`~/Installed Packages`和`~/Pristine Packages`。

备份 just`~/Packages/User`和其他 3 个目录之间的功能区别是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T18:05:37.867

我认为 Packages/User 是您*应该*放置设置的地方（根据 Sublime 的**[官方](http://www.sublimetext.com/docs/2/settings.html)**和**[非官方](http://docs.sublimetext.info/en/latest/customization/settings.html)**文档）。但是，有些人不时将它们放在其他文件夹中。

Dropbox 的建议可能是对不良做法的一种对冲。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T07:43:28.213

从[这里](http://docs.sublimetext.info/en/latest/extensibility/packages.html)：

`Installed Packages`是：

> 您将在数据目录中找到此目录。它包含已安装的每个 sublime-package 的副本。用于恢复包。

这些是作为 sublime-packages 安装的包。我不认为包控制使用这个，但如果你安装一些东西作为一个崇高的包，也许你想保留它？

`Pristine Packages`是：

> 您将在数据目录中找到此目录。它包含每个发货和核心包的副本。用于恢复包。

因此，本质上是一个`.sublime-package`文件列表，用于在您破坏某些内容时进行恢复。

`Packages`是：

Sublime Text 使用的包，或者作为 sublime 的一部分安装，或者作为插件安装。

`User`是：

用户目录是您的个人目录，包含配置、附加片段等。

以下是我个人对保存内容的看法，如果您愿意，请随时忽略它。

我不得不同意只保存用户目录的帖子，因为如果尚未安装，Package Control 将获取列表中的所有插件。我在那篇文章中没有看到这一点，但是您还可以将存储库（通过指定 URL）添加到 Package Control，这允许您在提交到 Package Control 的软件包之外安装软件包，但仍托管在某个地方。我可以看到`Packages`完全保存目录的一个论点是，如果您使用的插件不在任何地方托管（尽管这些插件可能会`Packages`毫无问题地移动到目录中）。

`Installed Packages`and`Pristine Packages`用于恢复包，所以我认为不需要这些，但我敢肯定它存在一些用例。

无论如何，意识到我在最后有点跑题了，但希望在那之前的一切都有助于澄清。

# c++ - Visual Studio 2008 中的“缺少类型说明符”错误

> ID：13829377
> 
> 赞同：0
> 
> 时间：2012-12-11T22:12:50.647
> 
> 标签：c++

以下代码行

```
int translateCorners(IpPairVec &matches, const CvPoint src_corners[4], CvPoint dst_corners[4]); 
```

导致此错误

> 错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数

我正在使用 Visual Studio 2008。有人知道这是什么原因吗？

# php - Codeigniter 2.1 - 每月统计数据库中的数据

> ID：13829378
> 
> 赞同：1
> 
> 时间：2012-12-11T22:12:58.397
> 
> 标签：php, mysql, codeigniter, codeigniter-2

我有一个小的日历页面，您可以在其中单击特定月份并获取该月的所有文章。有几个月没有文章，我想避免用户点击那个月却发现它是空的部分。我如何计算一年中每个月的所有文章，然后在视图部分显示数据？

文章的数据库是这样的：

```
articles
id_articles -> **number**
title -> **varchar**
text -> **text**
date_created -> timestamp (CURRENT_TIMESTAMP - MM/DD/YYYY HH:MM:SS ) 
```

HTML 代码：

```
<nav id="arcive" class="clearfix">
        <ul>
            <li>
                <a role=slide rel=2012 class="current" >2012</a>
                <ul rel=2012 class="month">
                    <li>
                        <a href="#">December</a>
                        <a href="#">November</a>
                        <a href="#">October</a>
                        <a href="#">September</a>
                        <a href="#">August</a>
                        <a href="#">July</a>
                        <a href="#">Jun</a>
                        <a href="#">May</a>
                        <a href="#">April</a>
                        <a href="#">March</a>
                        <a href="#">February</a>
                        <a href="#">January</a>
                    </li>
                </ul>
            </li>
    </ul>
    </nav> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T00:41:13.590

动态创建菜单的 PHP 是这样的：

```
$year = '2012'; // set this to whatever the year to be queried is

$sql = 'SELECT GROUP_CONCAT(MONTH(`date_created`)) `date_created`  '
     . 'FROM `articles` '
     . 'WHERE YEAR(`date_created`) = ' . (int) $year; // typecast for security

// run query to return list of numeric months with articles
$query = $this->db->query($sql);  
$result = $query->row();
$months = explode(',', $result->date_created);

$articles_per_month = array_count_values($months); // get count of articles per each month    

for ($i = 1; $i <= 12; $i++) // Loop Through 12-months
{
    $month_name = date('F', mktime(0, 0, 0, $i)); // Get the name of the month from the numeric month

    echo (in_array($i, $months)) // Check to see if articles for month, if so create link otherwise SPAN
        ? "<a href='/calendar/month/$i'>$month_name (" . $articles_per_month[$i] . ")</a>\n" // print link with number of articles
        : "<span>$month_name</span>\n";
} 
```

这将创建菜单，如果一个月没有文章，则会在 SPAN 标签中打印出月份名称，如果有文章，则会打印出该月作为链接以及该月的文章数量。

# python - 为什么要在 Python 中断言语句？

> ID：13829381
> 
> 赞同：2
> 
> 时间：2012-12-11T22:13:06.983
> 
> 标签：python, assert

> **可能重复：**
> [python 的设计：为什么断言是语句而不是函数？](https://stackoverflow.com/questions/13390401/design-of-python-why-is-assert-a-statement-and-not-a-function)

在 Python 3 中，print 变成了一个函数。有 assert 是一个声明的好处是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T22:15:50.597

用于优化。如果使用 -O 选项运行 Python 脚本，则不会为断言语句生成代码。如果 assert 是一个函数，这是不可能的。

请参阅[有关 assert 的文档](http://docs.python.org/3/reference/simple_stmts.html#the-assert-statement)，其中引用了此行为。

# functional-programming - 什么是绑定事件？

> ID：13829393
> 
> 赞同：2
> 
> 时间：2012-12-11T22:13:52.940
> 
> 标签：functional-programming, ocaml

我正在学习[Jason Hickey 的 Objective Caml 简介](http://www.cs.caltech.edu/courses/cs134/cs134b/book.pdf)。

* * *

我有几个简单的问题：

**是什么`binding`？**

**是什么`occurrences`？**

**是什么`binding occurrences`？**

* * *

我问这些问题是因为这本书说：

![在此处输入图像描述](../Images/b86763c5e605a6a8b180d17f41f8a417.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T22:18:55.803

我没有读过这篇文章，只是一个谦虚的实践者（不是理论家），但我很确定我知道这些术语的含义。

绑定是名称与值的关联。

出现是名称在表达式中的一次出现。如果名称出现两次，则出现两次。

绑定事件是名称在某个位置的出现，导致它绑定到一个值。在`let x = 4 in x + 2`第一次出现中`x`是绑定出现，第二次只是出现。

**编辑**：引用的文本告诉您的是，当名称出现在模式中时，模式的成功匹配会导致名称绑定到一个值。

# jquery - 在链接下添加一个 div

> ID：13829400
> 
> 赞同：0
> 
> 时间：2012-12-11T22:14:36.843
> 
> 标签：jquery

我试图`div`在单击链接时在链接下添加一个，然后在单击下一个链接后使该框消失，然后在下一个链接下放置另一个 div 框。

这是我正在研究的小提琴：http: [//jsfiddle.net/d0okie0612/geJM3/](http://jsfiddle.net/d0okie0612/geJM3/)

HTML：

```
<div id="blackbar">
    <a class="link" href="#">Click here</a>
    <a class="link2" href="#">Click here</a>
    <a class="link3" href="#">Click here</a>
</div> 
```

JavaScript：

```
$('a.link').on('click', function (e) {
    e.preventDefault();
    $('<div class="whitebar"><p>1</p></div>').appendTo('div#blackbar');
});

$('a.link2').on('click', function (e) {
    e.preventDefault();
    $('<div class="whitebar2"><p>2</p></div>').appendTo('div#blackbar');
});

$('a.link3').on('click', function (e) {
    e.preventDefault();
    $('<div class="whitebar3"><p>3</p></div>').appendTo('div#blackbar');
}); 
```

​​​​​​​​​​​​​​​​​​​​​​​​​​

```
#blackbar  { background: black; width: 900px; height: 200px;}
.whitebar  { background: white; width: 40px; height: 30px; border: solid purple; z-index: 1000;}
.whitebar2 { background: white; width: 40px; height: 30px; border: solid purple; z-index: 1000; position: absolute; left: 90px;}
.whitebar3 { background: white; width: 40px; height: 30px; border: solid purple; z-index: 1000; position: absolute; left: 190px;}
a { color:white;} 
```

我还在学习 jQuery，我相信这段代码可以改进。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:18:13.493

```
$('#blackbar a').on('click', function(e){
    e.preventDefault();
    $('.whitebar').remove()
    $('<div />', {'class': 'whitebar', html: '<p>'+($(this).index()+1)+'</p>'})
        .appendTo('div#blackbar').css('left', $(this).offset().left);
});
​ 
```

[**小提琴**](http://jsfiddle.net/geJM3/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T22:23:12.983

尝试这个

**JS**

```
$('a').on('click', function(e){
    e.preventDefault();
    var $this = $(this);
    var classname = $(this).data('classname'); 
    var index = $this.index() + 1;
    var html = '<div class="dot '+classname + '"><p>' + index + '</p></div>';
    $('#blackbar').find('.dot').remove().end().append(html);

}); 
```

**HTML**

```
<div id="blackbar">
<a class="link" href="#" data-classname="whitebar">Click here</a>
<a class="link2" href="#" data-classname="whitebar2">Click here</a>
<a class="link3" href="#" data-classname="whitebar3">Click here</a>
</div>​ 
```

**CSS**

```
#blackbar{background: black; width: 900px; height: 200px;}

.dot
{
    background: white; 
    width: 40px; 
    height: 30px;
    border: solid purple;
    z-index: 1000;
}

.whitebar2
{
    position: absolute;
    left: 90px;
}

.whitebar3
{
    position: absolute;
    left: 190px;
}
a{color:white} 
```

​</p>

**[检查小提琴](http://jsfiddle.net/sushanth009/geJM3/7/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T22:24:22.037

```
<div id="blackbar">
   <a class="link" href="#">Click here</a>
   <div class="whitebar"><p>1</p></div>    
   <a class="link2" href="#">Click here</a>
   <div class="whitebar2"><p>2</p></div>        
   <a class="link3" href="#">Click here</a>
   <div class="whitebar3"><p>3</p></div>        
</div> 
```

```
$('#blackbar a').on('click', function(e){
    e.preventDefault();
    $(this).siblings('div').hide().end().next().show()
}); 
```

[http://jsfiddle.net/x2ByZ/](http://jsfiddle.net/x2ByZ/)

# php - 在 Web 服务器/浏览器上下文中初始化 PHP 类

> ID：13829402
> 
> 赞同：0
> 
> 时间：2012-12-11T22:14:45.623
> 
> 标签：php

我正在编写一个与数据库对话的脚本，并转换内容并将其放入 XML 文件中。

我正在尝试利用最佳实践，并且作为库重用的一部分，我发现以下类是有益的：

### Symfony 组件：

*   Yaml ：用于解析和加载数据库信息。，
*   DI Container：用于注入依赖项

### 其他：

*   PHPExcel，*令人惊叹*的Excel 库
*   Doctrine DBAL 获得一个简单的 PDO 包装器
*   在测试期间获得简单模拟的嘲弄

我的核心业务类`ExcelExporter`需要所有这些文件相互协调地运行。我还需要一个可以通过自己的类初始化并注入这些依赖项的地方。

我对在哪里执行此操作感到困惑。如果我正在构建一个网页，我会说我会将初始化和配置过程放在 index.php 中，最后在用户在浏览器中加载 index.php 时调用 ExcelExporter 来完成它的工作。这个引导过程有更好的方法吗？最常见的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:55:09.533

You should totaly use [Composer](http://getcomposer.org/doc/00-intro.md) for this task.

It will handle **vendors and autoloading** for you.

Here is a quick setup:

```
curl -s https://getcomposer.org/installer | php
php composer.phar init
php composer.phar require symfony/dom-crawler:dev-master doctrine/dbal:2.4.x-dev
php composer.phar install 
```

You will have a `vendor` directory with your dependencies. Then the bootstrap file is simply initializing what you have to do. Autoloading is handled by Composer:

```
// Then add this on top of your bootstrap file
require 'vendor/autoload.php'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T22:30:03.057

我假设您没有使用任何框架。仅使用交响乐组件。如果您使用的是框架，它将由框架完成。但是对于 vanila 框架，您需要

1.  应用程序的单一入口点（例如`index.php`）
2.  `bootstrap.php`加载初始类和外部资源的文件。许多框架使用这个引导文件。只要看看你会发现它们的文件结构。这个名字可能不是`bootstrap.php`。
3.  加载应用程序后，使用自动加载器加载按需类。这个[自动加载器](http://php.net/manual/en/function.spl-autoload-register.php)应该在引导时初始化。

    ```
    function my_autoloader($class) {
        include 'classes/' . $class . '.class.php';
    }
    spl_autoload_register('my_autoloader'); 
    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-16T06:10:17.837

根据 Damien 的回答，我发现 Composer 提供了最简单的方法来做到这一点。

现在，我的`ExportExcel`班级住在`src/`目录中。我的目录结构是：

```
源/
小贩/
索引.php
引导程序.php
作曲家.json

```

在 内`composer.json`，我还要求它为我加载我的课程：

```
{
    “名称”：“adityamenon/excel_export”，
    "description": "将数据导出为自定义 Excel 工作表格式",
    “要求”： {
        “symfony/依赖注入”：“2.2.x-dev”，
        “symfony/yaml”：“2.1.x-dev”，
        “教义/dbal”：“2.4.x-dev”，
        “嘲笑/嘲笑”：“开发大师”，
        “CodePlex/PHPExcel”：“1.7.8”
    },
    “自动加载”：{
        “psr-0”：{“ExportExcel”：“src/”}
    },
    “作者”：[
        {
            "name": "aditya menon",
            “电子邮件”：“adityamenon90@gmail.com”
        }
    ]
}

```

我只需要运行`$ composer install` 所有依赖项就可以神奇地出现在`vendor/`.

PSR-0 很容易理解。我刚刚创建了一个文件`ExportExcel.php`，其中包含一个命名空间类，名为`ExportExcel`：

```
namespace ExportExcel;

class ExportExcel {

    public function __construct(\ExportExcel\DbConvenience $db_convenience)
    {
        $this->DbConvenience = $db_convenience;
    }

    public function writeExcelFile()
    {
        // ...do stuff here
    }

} 
```

最后，这是 bootstrap.php，它负责自动加载我需要的东西以及注入依赖项：

```
<?php

// composer autoloads dependencies
// also configured to load from src/
$loader = require('vendor/autoload.php');

// load configuration (only db right now)
use Symfony\Component\Yaml\Yaml;
$yaml_config = Yaml::parse('config.yml');

// load the database
$db_config = new Doctrine\DBAL\Configuration();
$conn = Doctrine\DBAL\DriverManager::getConnection($yaml_config, $db_config);

// load the convenience classes
$DbConvenience = new ExportExcel\DbConvenience($conn);

// use the dependency injector to load the exporter with DB
use Symfony\Component\DependencyInjection\ContainerBuilder;
use Symfony\Component\DependencyInjection\Reference;
$sc = new ContainerBuilder();

$sc->setParameter('dbconvenience.class', 'ExportExcel\DbConvenience');
$sc->setParameter('exportexcel.class', 'ExportExcel\ExportExcel');

$sc
    ->register('dbconvenience', '%dbconvenience.class%')
    ->addArgument($conn);

$sc
    ->register('exportexcel', '%exportexcel.class%')
    ->addArgument(new Reference('dbconvenience'));

// here's the most important class of 'em all
$ExportExcel = $sc->get('exportexcel'); 
```

**最后**在 index.php 中，第一行是`require('bootstrap.php');`，然后我就走了。我可以使用 $ExportExcel->doStuff(); 调用 ExportExcel 中的函数；

请随时添加评论并缩短/改进此答案。解决这个难题有点困难，需要阅读一些内容，但事后看来一切都很清楚。

# css - 在 Visual Studio 2012 中添加样式规则对话框

> ID：13829403
> 
> 赞同：1
> 
> 时间：2012-12-11T22:14:47.227
> 
> 标签：css, visual-studio-2012

刚刚注意到 VS2012 中缺少显示 CSS-outline 的添加样式规则对话框，或者我缺少 MS 所做的一些更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:55:54.683

[这在此处](http://social.msdn.microsoft.com/Forums/en-US/vssetup/thread/80538b67-a458-4140-8373-dabfebb2ba25)的 MSDN 论坛上进行了讨论。

> 据我所知，样式菜单已从 VS2012 移出，但是，您可以从工具栏中获取构建样式功能。转到视图->工具栏->样式表。
> 
> 但是，您仍然无法获得 VS2010 中可用的“添加样式规则”选项。如果您觉得它对您来说是一项非常重要的功能，您可以考虑在此处的 Microsoft UserVoice 网站上提交一个功能请求：http: [//visualstudio.uservoice.com/forums/121579-visual-studio](http://visualstudio.uservoice.com/forums/121579-visual-studio)

# excel - 用户窗体列表框问题

> ID：13829415
> 
> 赞同：1
> 
> 时间：2012-12-11T22:15:48.633
> 
> 标签：excel, vba

我创建了一个“RightToLeft”属性为 True 的用户表单。我创建了一个“TextAlign”属性为“3 - fmTextAlignRight”的列表框。列表框包含两列和两行，其文本长度超过列表框大小，因此我设置了“ColumnWidths”属性以查看所有文本。

我有两个问题：

1.  打开用户窗体时，我看到第二列的末尾而不是第一列。

![第一个问题](../Images/9d1d0203a8844d777d7936f2cef13ed5.png)

2.  我有一个 SpinButton，它在行之间交换。当我的行数超过列表框高度时，当我在限制的行之间交换时，我看到两行具有相同的值。

![第二个问题](../Images/649027f0e803c004f25ba92725d5ba0b.png)

我的旋转按钮的 VBA 代码：

```
Private Sub SpinButton1_SpinDown()
    Call SwapBetweenTwoLines(False, ListBox1)
End Sub

Private Sub SpinButton1_SpinUp()
    Call SwapBetweenTwoLines(True, ListBox1)
End Sub

Sub SwapBetweenTwoLines(up As Boolean, listbox)
    Dim index As Integer, new_index As Integer
    index = listbox.ListIndex
    If (((up = True) And (index > 0)) Or _
        ((up = False) And (index < listbox.ListCount - 1))) Then
        If (up = True) Then
            new_index = index - 1
        Else
            new_index = index + 1
        End If

        Dim key As String, value As String
        key = listbox.Column(0, index)
        value = listbox.Column(1, index)
        listbox.Column(0, index) = listbox.Column(0, new_index)
        listbox.Column(1, index) = listbox.Column(1, new_index)
        listbox.Column(0, new_index) = key
        listbox.Column(1, new_index) = value
        listbox.Selected(new_index) = True
    End If
End Sub 
```

谢谢您的帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T22:38:36.990

好吧，我已经成功解决了第二个问题。

我应该在插入值之前写最后一个命令（listbox.Selected(new_index) = True），而不是之后。

有人有解决第一个问题的方法吗？

谢谢...

# asp.net - 在 asp.net 中发送电子邮件的计时器

> ID：13829420
> 
> 赞同：0
> 
> 时间：2012-12-11T22:15:53.737
> 
> 标签：asp.net, email

我的网站中有一些用户有一个有截止日期的任务。我想在他们的截止日期结束时给他们发电子邮件。但此操作必须自动执行。有没有办法制作这样的东西？我应该在asp中使用全局，还是有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:31:04.570

您确实应该编写计划任务或 Windows 服务来执行此类操作。如果没有请求，ASP.NET 网站会很高兴地进入休眠状态，并且您真的不希望在 Web 服务器上有长时间运行的线程。

（有一个“[技巧](http://www.codeproject.com/Articles/12117/Simulate-a-Windows-Service-using-ASP-NET-to-run-sc)”使用缓存过期来获得对您的代码的预定回调，如果您不能使用下面的选项，请尝试它。）

编写一个端点（如 /CheckTaskDeadline.ashx 之类的 URL），调用该端点时将检查任务截止日期并触发操作（发送电子邮件）。添加一个计划任务，该任务每 5 分钟或每小时（在接近截止日期时可靠触发所需的任何粒度）向端点发出请求。使用[curl](http://curl.haxx.se/download.html)或[wget](http://gnuwin32.sourceforge.net/packages/wget.htm)来“ping”该 URL。

如果您无权访问机器，有时您可以使用虚拟主机的配置面板创建计划任务。如果你不这样做，请好好问他们:-)。一个好的托管服务提供商应该能够为您提供帮助。否则，请考虑将应用程序移至另一台主机，或获得单独的“ping”服务，例如[Pingdom](https://www.pingdom.com/)。

# c# - Silverlight 5 中的 TextBox 未更新

> ID：13829421
> 
> 赞同：0
> 
> 时间：2012-12-11T22:15:57.247
> 
> 标签：c#, silverlight-4.0, silverlight-5.0

我迁移了应用程序 pro SilverLight 5 以及客户端。此更新后，文本框不会更新客户端数据，即使实现 INotifyPropertyChanged。

在 SILVERLIGHT 4 应用程序中也是如此，细节通常在 RaisePropertyChanged 后及时显示在文本框中。

关注我的文本框：

```
<TextBox Width="43" MaxLength="4" slf:TextBoxFilterService.Filter="PositiveInteger"
    IsEnabled="{Binding DadosServicoEnabled}" Margin="6,0" Text="{Binding
    Path=HoraDataEntradaVeiculo, ValidatesOnDataErrors=True,Mode=TwoWay, 
    Converter={StaticResource HoraConverter}}"/> 
```

关注属性

```
public string _HoraDataEntradaVeiculo;
public string HoraDataEntradaVeiculo
{
    get
    {
        return _HoraDataEntradaVeiculo;
    }
    set
    {
        _HoraDataEntradaVeiculo = value;
        this.RaisePropertyChanged("HoraDataEntradaVeiculo");    
    }
} 
```

有人可以告诉我版本 5 更新是否改变了方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T02:32:28.380

在升级到 Silverlight 5 后，这曾经发生在我身上。当从 IDE 运行并使用 IDE 启动的浏览器页面时，它会无法更新。如果您从 IDE 运行项目，然后启动自己的浏览器并浏览到正在测试的页面，则 TextBox 应该会按预期更新。

现在我的项目似乎已经解决了。也许你还没有安装更新，或者我现在很幸运。

# c# - 指定泛型函数的类型

> ID：13829424
> 
> 赞同：0
> 
> 时间：2012-12-11T22:16:15.310
> 
> 标签：c#, .net, generics

我有以下简单的功能：

```
private static Nullable<T> CastValue<T>(object val)
 where T : struct
{
    if (!(val is DBNull))
    {
        return (T) val;
    }
    return null;
} 
```

我想在迭代数据表的行/列时调用它，如下所示：

```
var table = CreateTable();
foreach (DataRow row in table.Rows)
{
    foreach (DataColumn column in table.Columns)
    {
        Type type = column.DataType;
        CastValue<type>(row[column]);
    }
} 
```

但是，我收到以下错误：

> 找不到类型或命名空间名称“type”（您是否缺少 using 指令或程序集引用？）

有没有办法使用在运行时确定的泛型参数调用泛型函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:20:42.057

你不能¹因为泛型参数是在编译时解析的，而列的类型只会在运行时知道。

由于您没有对结果*做*任何事情，因此`CastValue`不清楚您要完成什么，但是应该不需要强制转换，因为`row[column]`应该已经是列数据类型的实例。

* * *

¹您可以进行反思，但我看不出它对您的情况有何帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T22:21:34.237

我认为您需要制作该函数的非通用版本。如果您考虑一下，如果您传入了错误的类型，它将最终导致运行时错误，因此通过泛型化您不会得到任何东西。

# jakarta-ee - 将 JavaEE 应用程序扩展到 1.000.000 个并发用户

> ID：13829426
> 
> 赞同：5
> 
> 时间：2012-12-11T22:16:17.500
> 
> 标签：jakarta-ee, web-applications, scalability

我有一个 JavaEE 应用程序： 1 使用 EJB 和 SOAP 的 EAR；一些使用 Servlet 的 WAR。目前，EAR 部署在 Glassfish 3.1.2（社区版）中，而 WAR 部署在 tomcat 或 Glassfish 服务器上。

该应用程序由 MySQL 数据库支持，主要是在数据库中进行一些琐碎的数据处理。几乎没有静态内容。在当前架构中，几乎没有请求可以由战争本身来回答，并且总是涉及 EAR（可能通过一些重新设计来改变这一点）。

这对于 20 个并发用户是开箱即用的，并且在一个中型服务器上为多达 200 个并发用户调整了一些 http 线程池。

我现在必须扩展应用程序以应对 1.000.000 个用户（这不是一个乐观的猜测，而是对业务的现实需求；大多数“用户”将是部署在现场的设备）。

如何扩展此应用程序以处理 1.000.000 个并发用户？尤其：

*   我是否应该能够让单个 glassfish 服务器为超过 200-500 个用户提供服务（对于要求不高的 web 应用程序）？如果是，我应该瞄准什么？
*   glassfish 集群似乎是一种选择，但它的规模有多大？即便如此，运行 1000-2000 台服务器（即使在云中）听起来对我来说也不是很吸引人。
*   如果 tomcat/glassfish 是错误的答案，有什么替代方案？
*   目前瓶颈是 webapp，但我认为在某个阶段数据库也可能成为问题。MySQL 扩展到这样的规模有多好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-04T05:56:24.713

希望您能在以下 URL 中找到一些有用的信息。

[http://highscalability.com/blog/category/example](http://highscalability.com/blog/category/example)

# javascript - 使用 JavaScript / jQuery 在 textarea 中渲染乘法和除法符号

> ID：13829427
> 
> 赞同：1
> 
> 时间：2012-12-11T22:16:18.040
> 
> 标签：javascript, jquery

我正在开发一个非常简单的数学编辑器，我希望用户能够通过单击按钮输入 [÷] 和 [×]。我已将这些字符直接放入代码中。它们呈现为错误。当我尝试使用**÷** 或**×** textarea 显示*÷* 或*×* 而不是 [÷] 或 [×]。我有 CSS 将字体设置为 Arial。

代码接收一个调用的参数`newSymbol`，然后附加它：

```
var textArea = $('#symbolsTextArea');
textArea.val(textArea.val() + newSymbol); 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T22:22:58.177

使用 unicode 字符而不是 HTML 特殊字符。

```
textArea.val(function(i, val) {
    return val + "\u00f7";
}); 
```

***演示：http:*** [//jsfiddle.net/QcjCZ/](http://jsfiddle.net/QcjCZ/)

* * *

或者，如果您更容易记住 HTML 序列，请创建 HTML 到 unicode 的映射：

```
var symbol = {
    "&divide;":"\u00f7",
    "&times;": "\u00d7"
}; 
```

并像这样使用它：

```
textArea.val(function(i, val) {
    return val + symbol["&divide;"];
}); 
```

# vhdl - 何时使用“case”，何时使用“with select”

> ID：13829430
> 
> 赞同：2
> 
> 时间：2012-12-11T22:16:31.033
> 
> 标签：vhdl

假设我们要输出一个 4 位数字 (swr) 到 7 段显示器 (seg)。在第一种方法中，我使用 case 语句：

```
process (swr)
begin  
   case swr is
     when "0000" => seg<="1000000";
     when "0001" => seg<="1111001";

     -- and so on...

     when others => seg<="-------";
   end case;
end process; 
```

或者我可以使用“with select”语句（这次不在进程中）：

```
with swr select
  seg<= "1000000" when "0000",
  "1111001" when "0001" ,

  -- and so on...

  "-------" when others; 
```

你能告诉我这两种方法有什么区别吗？（一个比另一个快？或者使用更多的逻辑门？或者......）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:59:03.953

不同的是，一个是顺序语句，必须出现在进程内部，而另一个是并发语句，出现在进程之外。选定的信号分配（使用 swr select ...）本质上是用于创建过程以及适当的敏感度列表和案例语句的简写概念。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T11:31:49.753

他们会产生基本相同的逻辑（或者至少如果他们不这样做，我会提交一个错误:)

As far as the simulator goes they should have the same effect too - the second form creates an implicit process sensitive to `swr` which is the same as your more explicit first form.

# c++ - 对字符串使用小于比较运算符

> ID：13829434
> 
> 赞同：21
> 
> 时间：2012-12-11T22:16:48.260
> 
> 标签：c++, operator-overloading, string-comparison, stdstring

我正在关注 C++ 的教程并查看字符串并使用 , 等运算符进行重载`+=`。`==`目前`!=`我有一个简单的 if 语句：

```
if(s1 < s2)
    cout << s2 <<endl;
else
  if(s2 < s1)
    cout << s1 << endl;
  else
    cout << "Equal\n"; 
```

但这是如何工作的，程序如何决定哪个字符串大于另一个字符串？环顾四周，我发现了一个基本的模板声明：

```
template<class charT, class traits, class Allocator>
bool operator< ( const basic_string<charT,traits,Allocator>& lhs,
                 const basic_string<charT,traits,Allocator>& rhs ); 
```

这是否定义了如何`<`工作？如果是这样，是什么`<charT,traits,Allocator>`意思/做什么？

以下运算符对字符串也有任何意义吗？`-=`和`*=`

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-11T22:18:14.797

字符串上的小于运算符对字符串进行字典比较。这以与按字典顺序列出字符串相同的方式比较字符串，一般化以适用于具有非字母字符的字符串。

例如：

```
"a" < "b"
"a" < "ab"
"A" < "a"             (Since A has ASCII value 65; a has a higher ASCII value)
"cat" < "caterpillar" 
```

有关更多信息，请查看**[`std::lexicographical_compare`](http://en.cppreference.com/w/cpp/algorithm/lexicographical_compare)**小于运算符通常调用的算法。

至于`-=`and `*=`，这些运算符都不是在字符串上定义的。定义的唯一“算术”运算符是`+`and `+=`，它们执行字符串连接。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T22:18:12.043

比较运算符实现字符串的[字典顺序](http://en.wikipedia.org/wiki/Lexicographical_order)。

`-=`并且`*=`没有为字符串定义。

# string - C 编程：Strlen()、字符串、字符问题

> ID：13829437
> 
> 赞同：0
> 
> 时间：2012-12-11T22:17:01.910
> 
> 标签：string, scanf

我在将一个人的姓名首字母的字符存储到一个结构如下的文件中的 char 数组（字符串）中时遇到问题：

```
AB Albert Bumble
FG Fred Goofoff
GF Gary Flintstone
DD Donald Duck 
```

char finitlett[MAX] 将存储首字母的所有首字母，AFG D。 char sinitlett[MAX] 将存储首字母的所有首字母，BGF D。

问题是当我打印 strlen(finitlett) 时，数字大于文件中的条目数。

这是我创建的用于检索条目并将它们放入数组中的代码，如下所示：

```
void readf(char finitlett[], char sinitlett[], char name[][80])
{
    char fileName[20] = "text.dat";
    FILE*inFile = NULL;

    inFile = fopen(fileName, "r");

    if (inFile == NULL)
    {
     printf("Error in opening the file %s\n", fileName);
     exit(0);
    }

    int i = 0;
    while(fscanf(inFile, "%c%c%80[^\n]\n", &finitlett[i], &sinitlett[i], &name[i]) != EOF){
        printf("Initials : %c%c | Name : %s\n", finitlett[i], sinitlett[i], name[i]);
        i++;
    }

    fclose(inFile);
    printf("Number of entries: %d\n", i);
    printf("Length of array: %d\n", strlen(finitlett));
    printf("Length of array: %d\n", strlen(sinitlett));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:24:29.490

确保使用 '\0' 字符初始化数组。strlen 通过查找第一个 '\0' 字符来工作，如果您的数组没有完全填充这些以 strlen 开头的字符，则可能会将 char 数组中留下的“垃圾数据”作为字符串的一部分进行计数。

# eclipse - jpa的多模块maven项目依赖问题

> ID：13829458
> 
> 赞同：0
> 
> 时间：2012-12-11T22:18:24.587
> 
> 标签：eclipse, maven, jpa, spring-mvc

我在多模块 Maven 项目中遇到错误。我尝试通过 eclipse run 作为选项运行“maven install”。

```
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building mysite-entities 0.0.1-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-resources-plugin:2.5:resources (default-resources) @ mysite-entities ---
[debug] execute contextualize
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /home/thomas/spring/mysite-parent/mysite-entities/src/main/resources
[INFO] 
[INFO] --- maven-compiler-plugin:2.3.2:compile (default-compile) @ mysite-entities ---
[INFO] Compiling 11 source files to /home/thomas/spring/mysite-parent/mysite-entities/target/classes
[INFO] -------------------------------------------------------------
[ERROR] COMPILATION ERROR : 
[INFO] -------------------------------------------------------------
[ERROR] /home/thomas/spring/mysite-parent/mysite-entities/src/main/java/com/mysite/entities/Mcc.java:[5,24] package javax.persistence does not exist
[ERROR] /home/thomas/spring/mysite-parent/mysite-entities/src/main/java/com/mysite/entities/Mcc.java:[6,24] package javax.persistence does not exist
[ERROR] /home/thomas/spring/mysite-parent/mysite-entities/src/main/java/com/mysite/entities/Mcc.java:[8,1] cannot find symbol
symbol: class Entity
@Entity 
```

mcc.java：

```
package com.mysite.entities;

import java.io.Serializable;

import javax.persistence.Entity;
import javax.persistence.Id;

@Entity
public class Mcc implements Serializable
{
    /**
     * 
     */
    private static final long serialVersionUID = 4146710247449711520L;

    @Id
    private Long id;

    private String name;

    public Long getId()
    {
        return id;
    }

    public void setId(Long id)
    {
        this.id = id;
    }

    public String getName()
    {
        return name;
    }

    public void setName(String name)
    {
        this.name = name;
    }
} 
```

我的 pom.xml 包括：

```
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-entitymanager</artifactId>
</dependency>
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-validator</artifactId>
</dependency> 
```

我检查了引入的 Maven 依赖项，它们包括 hibernate-jpa-2.0-api-1.0.1.Final.jar ，它又包括所有必要的类。

为什么我会收到这个 Maven 错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:13:01.013

实际上存在对`javax.persistence`. 这与 JPA 实现（在您的情况下为 Hibernate）一起使用。

将此添加到您的`pom.xml`

```
<dependency>
   <groupId>javax.persistence</groupId>
   <artifactId>persistence-api</artifactId>
   <version>1.0</version>
   <optional>true</optional>
</dependency> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T23:25:59.097

在某处找到这篇文章，发现这摆脱了警告消息。

复制到`slf4j-api-VERSION.jar`_`logback-classic-VERSION.jar``%JAVA_HOME%\jre\lib\ext`

*   `slf4j-api-VERSION.jar`位于`%M2_REPOSITORY%\org\slf4j\slf4j-api\VERSION\`

*   `logback-classic-VERSION.jar`位于`%M2_REPOSITORY%\ch\qos\logback\logback-classic\VERSION\`

*   如果不使用 logback-classic，则至少`slf4j-log4j12`, `slf4j-simple`,`slf4j-jdk14`或`logback-classic`绑定必须在 rhw 类路径中。

# javascript - 如何在页面中注入的函数表达式中使用变量？

> ID：13829461
> 
> 赞同：3
> 
> 时间：2012-12-11T22:18:46.053
> 
> 标签：javascript, google-chrome-extension, content-script

我正在尝试通过 Chrome 扩展内容脚本将函数注入网页：

```
function inject(code) {
    var actualCode = '(' + code + ')();';
    var script = document.createElement('script');
    script.textContent = actualCode;
    (document.head||document.documentElement).appendChild(script);
    script.parentNode.removeChild(script);
}

var myObj = person;  // myObj/person is passed in from elsewhere
var fn = function() {
    alert(myObj.name);
};
inject(fn); // myObj undefined 
```

我的问题是，由于 fn 是一个函数表达式，我不能传入 myObj.personName。所以我的问题是，如何构造一个包含变量的函数表达式？我是否改为进行某种字符串连接？

我还尝试将对象传递给函数，如下所示：

```
function inject(code, myObj) {
    var actualCode = '(' + code + ')(' + myObj +');';
    ... 
```

但这不起作用，并导致“Uncaught SyntaxError: Unexpected identifier”错误。

相关：[使用内容脚本将代码插入页面上下文](https://stackoverflow.com/questions/9515704/building-a-chrome-extension-inject-code-in-a-page-using-a-content-script)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:55:13.233

你的方法几乎是正确的。问题是以下

```
var code = '(' + func + ')(' + myObj + ');'   // results in
var code = '(function(){})([object Object])' 
```

要解决这个问题，只需使用[`JSON.stringify`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify)：

```
var code = '(' + func + ')(' + JSON.stringify(myObj) + ');'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T22:20:39.473

尝试：

```
var actualCode = new Function( code )(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T22:50:35.067

您可以[使用](http://developer.chrome.com/extensions/content_scripts.html#host-page-communication)[`window.postMessage`](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage).

将这样的代码注入页面

```
window.addEventListener('message', function messageInvoker(e) {
    if (e.data.extKey !== 'myKey') return; // some kind of check so you only worry about your own extension
    window[e.data.fn].apply(window, e.data.params);
}, false); 
```

从您的分机中，

```
window.postMessage({extKey: 'myKey', fn: 'userFunction', params: ['a','b','c']}, '*'); 
```

# android - Android OnTouchListener 调度一个线程来定位光标

> ID：13829462
> 
> 赞同：0
> 
> 时间：2012-12-11T22:18:51.107
> 
> 标签：android, android-edittext, ontouchlistener, cursor-position

在“ [In Android EditText how to get the cursor position in an OnTouchListener after it is set](https://stackoverflow.com/q/9996015/1888216) ”上发布的答案表明，将来可以安排一个线程为 100MS 给 Android 时间来更新 EditText 光标位置。没有提供如何实现这一点的代码。我已经尝试使用 Toast 来显示光标位置的以下测试代码。更新触摸后不显示光标位置。有人可以更正此代码，以便在 mText.setSelection(cursor) 中提供触摸位置吗？

```
OnTouchListener otl = new OnTouchListener() {
                    @Override
                    public boolean onTouch(View v, MotionEvent evt) {
                    Runnable r = new Runnable()
                        {
                            public void run() 
                            {
                                int cursor = mText.getSelectionStart();
                                Toast.makeText(getApplicationContext(), "Cursor=" + cursor, Toast.LENGTH_SHORT).show();
                                mText.setSelection(cursor);
                            }
                        };
                        Handler handler = new Handler();
                        handler.postDelayed(r, 1500);
                        return true;
                    }
                 };
                mText.setOnTouchListener(otl); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T18:00:38.580

我放弃了安排未来的线程来给 Android 时间来更新光标位置。我找到了一种更好的方法来抑制软键盘，并且仍然可以在 EditText 框中显示闪烁的光标。我编写了一个 onTouchListener 并返回 true 以禁用键盘，而不是使用“mText.setInputType(InputType.TYPE_NULL)”。然后我必须从运动事件中获取触摸位置，以将光标设置到正确的位置。

这是我使用的代码：

```
 mText = (EditText) findViewById(R.id.editText1);
  OnTouchListener otl = new OnTouchListener() {
  @Override
  public boolean onTouch(View v, MotionEvent event) {
      switch (event.getAction()) {
      case MotionEvent.ACTION_DOWN:
          Layout layout = ((EditText) v).getLayout();
          float x = event.getX() + mText.getScrollX();
          int offset = layout.getOffsetForHorizontal(0, x);
          if(offset>0)
              if(x>layout.getLineMax(0))
                  mText.setSelection(offset);     // touch was at end of text
              else
                  mText.setSelection(offset - 1);
          break;
          }
      return true;
      }
  };
  mText.setOnTouchListener(otl); 
```

# github - 如果您不是贡献者/所有者，如何在 GitHub 中的问题上贴标签？

> ID：13829466
> 
> 赞同：250
> 
> 时间：2012-12-11T22:19:04.297
> 
> 标签：github

我已经在 GitHub 上提交了一个项目的问题，该问题不是我的，我也不是贡献者，但我找不到标记我的问题的方法。有没有办法给它贴上标签，或者这只适用于贡献者？

* * *

## 回答 #1

> 赞同：271
> 
> 时间：2012-12-11T22:22:58.193

它仅适用于贡献者。

这样，您可以避免随机的人分配错误的标签并弄乱您的类别。

但是，如果您可以以某种方式提出标签，那将很有用。然后您可以将问题标记为您认为是错误的问题，因此所有者可以确认这一点。许多人建议在标题中使用标签：`[proposed Label] actual title`

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2015-07-12T10:50:44.757

**GitHub 问题模板标签（`.github/ISSUE_TEMPLATE/XXX.md`，2018 年 12 月）**

[https://help.github.com/en/articles/creating-issue-templates-for-your-repository](https://help.github.com/en/articles/creating-issue-templates-for-your-repository)

问题模板功能更老，但从 2018 年 12 月更新[https://github.blog/changelog/2018-12-05-issue-template-automation-improvements/](https://github.blog/changelog/2018-12-05-issue-template-automation-improvements/)现在可以自动为模板分配标签，并且已经成为解决这个问题的好方法。

使用此功能，存储库管理员可以创建一组问题模板，并为每个模板分配一组标签。

然后，每当用户创建新问题时，即使是非管理员，也可以在其中一个模板之间进行选择，如果他们这样做，标签就会被分配！

我喜欢这种方法，因为它有效地允许您确定任何人都可以创建的标签子集，同时仍然可能仅为协作者保留其他标签。

这是我的一个测试仓库，你可以自由地创建问题来测试它：[https ://github.com/cirosantilli/test-git-web-interface/issues/new](https://github.com/cirosantilli/test-git-web-interface/issues/new)

可以从 GitHub 的 repo Settings 选项卡创建模板，但即使您从那里执行它也只会在`.github/ISSUE_TEMPLATE`目录下生成魔术文件，请参见例如：[https ://github.com/cirosantilli/test-git-web-interface/tree /7f2bb195ff303a037499c1c349b3c89158221674/.github/ISSUE_TEMPLATE](https://github.com/cirosantilli/test-git-web-interface/tree/7f2bb195ff303a037499c1c349b3c89158221674/.github/ISSUE_TEMPLATE)这很好，因为它在存储库中保留了更多的存储库元数据。

该目录可能包含以下内容：

.github/ISSUE_TEMPLATE/bug.md

```
---
name: bug
about: Use this template to report existing bugs.
title: 'Bug'
labels: bug

--- 
```

.github/ISSUE_TEMPLATE/feature-request.md

```
---
name: feature-request
about: Use this template to request new features.
title: 'Feature request'
labels: feature-request

--- 
```

**旧答案**

我已将此请求提交给[https://github.com/isaacs/github/issues/148](https://github.com/isaacs/github/issues/148)`support@github.com`并指出了这个问题。

[@jdennes](https://github.com/jdennes)以通常的中立回答：

> 我已在我们的功能请求列表中为该项目添加了 +1 以供考虑。

这证实了这是不可能的。

让我们向天堂提出这个问题，直到他们这样做！

# umbraco - Umbraco - 将数据从表面控制器传递到视图

> ID：13829468
> 
> 赞同：0
> 
> 时间：2012-12-11T22:19:16.077
> 
> 标签：umbraco

我正在创建这个联系表格，您可以在文档中找到它：http: [//our.umbraco.org/documentation/Reference/Mvc/forms](http://our.umbraco.org/documentation/Reference/Mvc/forms)

问题是，在我的操作中，我正在向 ViewData 集合添加一些数据，但我无法进入视图。

这是动作：

```
public ActionResult ProcessForm(ContactFormModel model)
{
    if (!ModelState.IsValid) {
        // do something here
        return CurrentUmbracoPage();
    }    
    // process form
    // set success flag
    ViewData("SuccessMessage") = "We will be contacting you soon..";
    return RedirectToCurrentUmbracoPage();
} 
```

这是视图：

```
<h1>@ViewData("SuccessMessage")</h1> 
```

它将返回此错误：

> 编译错误，错误消息：CS0103：当前上下文中不存在名称“ViewData”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T09:05:07.547

ViewData 应该设置和调用使用`ViewData["some key"]`，而不是`ViewData("some key")`。这是因为 ViewData 本质上是一个字典，而不是`ControllerBase`类的方法。

[有关其使用的详细说明，](http://weblogs.asp.net/scottgu/archive/2007/12/06/asp-net-mvc-framework-part-3-passing-viewdata-from-controllers-to-views.aspx)请参见此处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T13:35:06.147

这将不起作用，因为您正在重定向另一个视图/操作，并且不会访问此 ViewData。

如果你想这样做，渲染一个局部视图。

# android - 检查正在运行的进程的广播接收器？

> ID：13829469
> 
> 赞同：0
> 
> 时间：2012-12-11T22:19:17.637
> 
> 标签：android, broadcastreceiver, process

我找不到任何此类接收器的示例...

我想创建一个广播接收器来检查定义的进程是否已启动以及何时停止以计算进程运行的时间。

如果您为我提供指导、教程或小示例以了解如何创建它，我将很高兴。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:19:54.420

抱歉，没有用于启动和停止进程的广播。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:40:50.163

如果您可以编辑有问题的流程，您可以随时编辑流程，以便它现在可以在流程开始和停止时发出广播。然后你可以使用你的广播接收器来计算开始和停止之间的时间。

如果您可以编辑相关流程，则可以使用持久变量来跟踪流程的启动和停止时间。或者即使你不能编辑进程，你也可以用一个瘦包装器替换所有对进程的调用，它使用持久变量来存储进程的开始时间，实际调用进程，最后存储停止时间。进程停止。

如果您既不能编辑流程也不能编辑对流程的调用，这是不可能的。

# android - 将 jar 文件从 libs/ 添加到 Android.mk

> ID：13829473
> 
> 赞同：7
> 
> 时间：2012-12-11T22:19:40.643
> 
> 标签：android, android-make

我*几乎在*[在 Android.mk 中添加外部 jar 引用中](https://stackoverflow.com/questions/2598293)找到了答案，但我还没有找到答案。

我的项目在 libs/ 目录中包含 commons-io-2.4.jar 和 jsch-0.1.49.jar。一切都在eclipse中构建得很漂亮。现在我想编写一个 Android.mk 文件来自动构建我的项目。

我的 Android.mk 看起来像这样，但它不起作用。

```
LOCAL_PATH:= $(call my-dir)
include $(CLEAR_VARS)

LOCAL_SRC_FILES := $(call all-java-files-under, src)

LOCAL_PACKAGE_NAME := MyProject
LOCAL_CERTIFICATE := platform

LOCAL_STATIC_JAVA_LIBRARIES := jsch-0.1.49 commons-io-2.4

LOCAL_PROGUARD_FLAGS      := -include $(LOCAL_PATH)/proguard.flags

include $(BUILD_PACKAGE)

LOCAL_STATIC_JAVA_LIBRARIES := libs
LOCAL_PREBUILT_STATIC_JAVA_LIBRARIES := libs:jsch-0.1.49 libs:commons-io-2.4

include $(BUILD_MULTI_PREBUILT) 
```

我敢肯定我弄错了一点秘方，但我想不通。

Android.mk 文件有很好的参考吗？我能找到的只是使用 ndk 的食谱。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-11T23:50:54.117

好的，几个小时的谷歌搜索和试验似乎找到了解决方案。
在此处记录以供其他人查找：

关键是

1.  `LOCAL_STATIC_JAVA_LIBRARIES`用我要包含的库的符号名称定义，例如`libjsch`
2.  执行`CLEAR_VARS`（为什么？）
3.  定义`LOCAL_PREBUILT_STATIC_JAVA_LIBRARIES`为`libjsch:<path-to-jar-file>`
4.  包括`BUILD_MULTI_PREBUILT`.

（测试表明任何符号名称（例如“foo”）都可以正常工作，只要它在两个声明中匹配。）

```
LOCAL_PATH:= $(call my-dir)
include $(CLEAR_VARS)

LOCAL_SRC_FILES := $(call all-java-files-under, src)

LOCAL_PACKAGE_NAME := MyProject

LOCAL_STATIC_JAVA_LIBRARIES := libjsch

include $(BUILD_PACKAGE)

include $(CLEAR_VARS)

LOCAL_PREBUILT_STATIC_JAVA_LIBRARIES := libjsch:libs/jsch-0.1.49.jar

include $(BUILD_MULTI_PREBUILT) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-10-15T08:47:55.033

非常感谢爱德华福尔克。我刚刚解决了我的问题，你再次感谢我，这是我的代码。关键字“lib”是一场噩梦。

```
LOCAL_PATH:= $(call my-dir)
include $(CLEAR_VARS)

LOCAL_MODULE_TAGS := optional

LOCAL_SRC_FILES := $(call all-subdir-java-files)

LOCAL_PACKAGE_NAME := MDM

LOCAL_STATIC_JAVA_LIBRARIES := libandroid-async-http libgcm libjson-simple

LOCAL_JAVA_LIBRARIES += telephony-common mms-common

LOCAL_CERTIFICATE := platform

include $(BUILD_PACKAGE)

include $(CLEAR_VARS)

LOCAL_PREBUILT_STATIC_JAVA_LIBRARIES := libandroid-async-http:libs/android-async-http-1.4.4.jar libgcm:libs/gcm.jar  libjson-simple:libs/json-simple-1.1.1.jar 

include $(BUILD_MULTI_PREBUILT) 
```

# algorithm - 处理闭区间的数据结构

> ID：13829476
> 
> 赞同：8
> 
> 时间：2012-12-11T22:19:51.753
> 
> 标签：algorithm, data-structures

当我发现我无法处理的问题时，我正在学习测试：

> 设计一个用于处理（闭合）区间的数据结构，它将提供三个操作：
> 
> Insert(x,y) - 添加区间 [x, y]
> 
> Remove(x,y) - 删除区间 [x, y]
> 
> Count(x,y) - 计算纯粹包含在区间 [x, y] 内的区间数
> 
> x,y 是从 1 到 n 的整数。所有操作最多花费时间 O((log n) ² )

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T16:47:18.633

这可以使用**[Fenwick 树](http://en.wikipedia.org/wiki/Fenwick_tree)**和基于**[分段树](http://en.wikipedia.org/wiki/Segment_tree)***的数据结构在 O(log^2 n) 时间和 O(nlog n) 空间中解决，分段树在每个节点内都*包含一个内部树。前者用于有效地查找和更新给定范围内的点数；后者用于有效地查找和更新跨越给定点的段数。基本思想是计算给定查询范围内的段端点，然后针对跨越一个或两个端点的段进行调整。

该算法基于以下观察：对于给定的查询范围 (a, b)，

> nContained = (h - nStraddlingOne) / 2

其中 nContained 是 (a, b) 包含的区间数，h 是 (a, b) 中任一类型（开始或结束）的区间端点数，nStraddlingOne 是仅包含 a 或只有 b。任何时间间隔的“数据库”在这里称为 D。

Fenwick 树允许您使用 O(n) 表在 O(log n) 时间内计算两个整数索引 (a, b) 之间的总点数。它还允许 O(log n) 的插入和删除。我们将每个间隔的两个端点添加到它，并用它在 O(log n) 时间内计算 h。

## 计数交叉口

我们的其他数据结构与线段树非常相似，但有两个主要区别：我们不是从输入的区间集推断区间的起点和终点，而是将终点集取为介于 1 和n 包括在内，并且没有“开集”（这是为了简化以后添加新区间）；我们以特定方式存储每个节点的间隔集。

为简单起见，假设 n 是 2 的幂（如果不是，只需选择 2 的下一个最大幂——这将导致小于 n 的增加，因此时间复杂度不会改变）。令 T 是一棵完全二叉树，每个位置都有一个叶节点 1 <= i <= n。（这棵树总共有 2n - 1 个节点。）每个叶节点代表一个位置。每个非叶子节点代表其下所有叶子节点位置的并集，它必须形成一个长度为2的幂的区间。称该区间为节点v Int(v)。（注意：因为这个二叉树是完整的，它可以“隐式”表示，就像二叉堆通常一样，以节省空间。）

对于 T 的每个节点 v，都有一组称为 Span(v) 的区间。（我们实际上只存储它们最右边的端点。） Span(v) 是 D 中所有区间的集合，它

1.  包含 Int(v)，并且
2.  不包含 Int(parent(v))。

在每个顶点 v 中，我们仅将 Span(v) 中区间的最右边端点存储在按此端点排序 的**自平衡二叉树中，其中每个节点都增加了后代节点的数量。****也就是说，“外部”树的每个节点都包含一个“内部”树。** 这对于使我们能够有效地计算有多少间隔完全包含给定的查询间隔是必要的。

段树上的基本查询操作是确定包含给定点 x 的区间集，这很容易更改为计数而不是报告单个区间。操作很简单：设置v为根，

1.  将 Span(v) 中的区间数加到总数中。
2.  如果 v 是叶子，则停止。
3.  否则，假设 v 的左右孩子分别是 u 和 w。如果 x 包含在 Int(u) 中，则在 u 上递归，否则在 w 上递归。

给定一个查询区间(a, b)，上述查询可以执行两次，一次针对a，一次针对b。将 nStraddlingAtLeastOne 设置为两个查询的计数之和。请注意，每个节点的计数可以在 O(1) 时间内完成——它只是存储 Span(v) 的自平衡二叉树的根节点的计数字段。

## 双重穿越！

困难（最终阻碍了我在 O(log n) 算法上的早期尝试，我花了一些时间）是我们还需要计算同时跨越查询的*两个*端点（a，b）的间隔数。为此，我们再次从根处的 v 开始，并对 a（查询的起点）执行修改后的查询，其中步骤 1 替换为：

1.  计算 Span(v) 中右端点 >= b 的区间数，并将其添加到总数中。

由于自平衡二叉树，这个计数步骤可以在 O(log n) 时间内执行。由于每个树级别最多需要 2 个这样的计数操作，这就是将时间复杂度推高到 O(log^2 n) 的部分。将 nContaining 设置为此查询的总数。我们可以使用计算 nStraddlingOne

> nStraddlingOne = nStraddlingAtLeastOne - nContaining

使用 nStraddlingOne 和从 Fenwick 树计算的 h，我们现在可以根据顶部的等式计算 nContained。

## 添加和删​​除间隔

更新也是 O(log^2 n)，因为更新 Fenwick 树是 O(log n)，并且使用以下算法将区间 (x, y) 添加到段树需要 O(log^2 n) 时间，以 v 开头：

1.  如果 (x, y) 包含 Int(v)，则将 y 添加到存储 Span(v) 右端点的自平衡二叉树并停止。
2.  否则，假设 v 的左右孩子分别是 u 和 w。
    *   如果 (x, y) 与 Int(u) 重叠，则在 u 上递归。
    *   如果 (x, y) 与 Int(w) 重叠，则在 w 上递归。

上面的遍历只访问了segment树中的O(log n)个节点，因为每个添加的区间都会出现在任何树级别上最多2个节点的区间集中，每个区间最多使用2log(n)个空间。请参阅[分段树上的 Wikipedia 页面以](http://en.wikipedia.org/wiki/Segment_tree#Structure_description)获取证明和进一步解释。删除间隔使用类似的算法。在节点处向自平衡二叉树中的每次插入或删除都需要 O(log n) 时间，总共需要 O(log^2 n) 时间。

## 空间使用

空间使用量为 O(nlog n)，因为段树中有 O(log n) 个树级别，每个级别可能需要空间用于包含每个可能端点的内部树节点的 2 个实例。特别注意，即使有 O(n^2) 个可能的不同区间，我们也只存储每个区间的最右边的端点，所以这不是问题。同样因为我们存储计数，添加现有间隔的第二个副本只会导致计数增加——它不会导致任何新的节点分配。Fenwick 树仅使用 O(n) 空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T08:33:29.510

请参阅[范围树](http://en.wikipedia.org/wiki/Range_tree)。查询的时间复杂度为 O(log ^d n + k)。这里 d 是维度，n 是存储在树中的点数，k 是查询**报告**的点数。

但是我们只需要计数而不报告分数。所以我认为如果在每个节点上保持子节点的数量（实际上是叶子的数量，因为实际的点存储在叶子中），这个 k 可以被消除，留下 O(log ² n)。插入和删除也是 O(log ² n)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T05:07:56.643

一个区间树适合这里，例如[https://github.com/ekg/intervaltree/blob/master/IntervalTree.h](https://github.com/ekg/intervaltree/blob/master/IntervalTree.h)看到这个代码，它提供了一个 findContained 看起来 O(log(n))，除了删除是更复杂但肯定可以在 O(log(n)) [http://en.wikipedia.org/wiki/Interval_tree#Deletion中完成](http://en.wikipedia.org/wiki/Interval_tree#Deletion)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-11T05:56:37.810

有时可以使用简单的排序集：
- 数据集中的区间有一些已知的**最大**长度，
- 另外，与集合中 x 个数据点的总值范围相比，这个最大长度并不太大。

在这种情况下，只使用简单的排序集就足够了：
- 仅使用间隔的 向它添加`x dimension`间隔。
- 像这样查询它：`get intervals with their x dimension in range [x', y'] and then filter out the few intervals that have their y dimension crossing the y' limit`。

给定上述关于具有已知**最大**长度的数据属性的相同前提条件，该逻辑**可以扩展为也执行类似区间树的查询**，其中查询不要求“纯粹**包含**在区间内的数据”，而是要求“数据**重叠**给定的间隔”。在这种情况下，查询将是：
- `get intervals with their x dimension in range [x' - maximum interval range, y' + maximum interval range] and then filter out the few intervals that actually are outside of requested range`。

# iphone - 将照片/图像发送到应用程序

> ID：13829477
> 
> 赞同：-1
> 
> 时间：2012-12-11T22:19:51.140
> 
> 标签：iphone, ios

有谁知道是否可以在此屏幕上获取您的应用程序？还是只有苹果才有这种能力？

我进行了一些搜索，但找不到任何相关内容，我什至不确定该屏幕的名称。

我是新手，所以我不能发布图片......但基本上在 iPhone 5 上，打开一张图片。单击带有一个箭头的矩形图标。弹出的菜单就是我正在谈论的菜单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:28:49.163

不幸的是，苹果没有在照片应用程序中列出任何第三方应用程序，即使是注册了可以打开此类文件的事实的应用程序也是如此。

[如果您需要此功能，请使用Apple 的错误报告工具提交](http://bugreporter.apple.com)增强请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:29:41.723

要直接回答您的问题，没有办法将您的应用程序列入该列表。

出于某种原因，Apple 使用自己的活动表处理图像。

要从相机胶卷中获取图像，请查看[UIImagePickerController](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html)

# r - 在 R 上使用具有不同数据框的单个模型创建重复预测

> ID：13829479
> 
> 赞同：0
> 
> 时间：2012-12-11T22:19:54.580
> 
> 标签：r, function, loops, prediction, confidence-interval

我希望有一个人可以帮助我。

我想使用具有不同数据的一个模型执行多个预测。

我创建了 100 个数据框，其中包含从另一个数据框排序的 60 个观察值，如下所示：

```
mtz100<-replicate(100,aracaboot[sample(nrow(aracaboot), size=60, replace=T),] 
```

好的，现在我想用我的模型拟合 100 个新模型，并创建新的 100 个数据框。

在此之后，我想预测栅格图层。

有人可以给出一个在 R 中自动化的起点吗？

解决方案：

```
RasterImgs <- list()
lenght(RasterImgs) <- 100              

 for(i in 1:100) {
     DataNew <- data[sample(1:nrow(data),60,replace=T),]
     Model <- glm(DataNew, ....)
     List <- Model
     RasterImgs[i] <- predict(list,....)
      } 
```

感谢@Señor O 的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:37:46.533

我认为你的方法现在有点偏离。这样做`sample(nrow(dataframe),60)`不会给你想要的效果，因为`nrow`返回一个数字（不是向量）。所以你想这样做`sample(1:nrow(dataframe),60.....`。

`for`如果您对索引进行采样，我不知道比使用简单循环更好的方法：

```
List <- list()
lenght(List) <- 100              ## Growing a list inside a loop is inefficient

for(i in 1:100) {
    DataNew <- Data[sample(1:nrow(Data),60,replace=T),]
    Model <- glm(DataNew....)
    List[i] <- Model
    } 
```

# java - 保存txt文件时找不到文件错误

> ID：13829484
> 
> 赞同：0
> 
> 时间：2012-12-11T22:20:37.210
> 
> 标签：java, file-io, runtime-error, java.util.scanner, filenotfoundexception

我的文件保存算法有问题。

```
error:
dec 11, 2012 4:56:18 PM tetris.FileIO loadHighscores
SEVERE: null
java.io.FileNotFoundException: file:\C:\Users\Koen\Dropbox\2TI\vgo\Eindwerk\Tetris\build\classes\tetris\LineHighscores.txt (De syntaxis van de bestandsnaam, mapnaam of volumenaam is onjuist)
    at java.io.FileInputStream.open(Native Method)
    at java.io.FileInputStream.<init>(FileInputStream.java:138)
    at java.util.Scanner.<init>(Scanner.java:656)
    at tetris.FileIO.loadHighscores(FileIO.java:44)
    at tetris.FileIO.getLineScores(FileIO.java:31)
    at tetris.FileIO.main(FileIO.java:69)

Exception in thread "main" java.lang.NullPointerException
    at tetris.FileIO.loadHighscores(FileIO.java:49)
    at tetris.FileIO.getLineScores(FileIO.java:31)
    at tetris.FileIO.main(FileIO.java:69)
Java Result: 1
BUILD SUCCESSFUL (total time: 0 seconds) 
```

我知道出了什么问题，这是一个小型俄罗斯方块游戏的保存算法。

文件保存在：

```
...\Eindwerk\Tetris\build\classes\tetris\LineHighscore.txt
...\Eindwerk\Tetris\build\classes\tetris\TimeHighscore.txt

```

我在这个类中添加了一个主类。将其粘贴到您的 ide 中并运行它，我收到很多错误

```
public class FileIO   {
    private File file;
    private Scanner filescScanner, lineScanner;
    private Writer fileWriter, lineWriter;
    private String[][] data;

    public FileIO () {
        String[][] data = new String[100][1];
    }
    public String[][] getLineScores(){
        return this.loadHighscores(this.getClass().getResource("LineHighscores.txt").toString());
    }
    public String[][] getTimeScores(){
        return this.loadHighscores(this.getClass().getResource("TimeHighscores.txt").toString());
    }

    public String[][] loadHighscores(String path){
        int x=0;
        String test = "";
        file = new File(path);

        try {
            filescScanner = new Scanner(file);
        } catch (FileNotFoundException ex) {
            Logger.getLogger(FileIO.class.getName()).log(Level.SEVERE, null, ex);
        }
        System.out.println(file.toString());
        while((test=filescScanner.nextLine())!=null) {

            lineScanner = new Scanner(test);
            lineScanner.useDelimiter("-/-");
            System.out.println(lineScanner);
            System.out.println(lineScanner.toString());
            data[x][0]=lineScanner.next();//name    
            data[x][1]=lineScanner.next();//data   
            x++;

        }
        lineScanner.close();
        filescScanner.close();
        return data;

    }

    public static void main(String[] args){
        FileIO file = new FileIO();
        System.out.println(file.getLineScores());

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:34:59.717

问题是您没有将有效路径传递给`new File`. `this.getClass().getResource("LineHighscores.txt")`返回一个 URL 对象。然后，您将获得 URL 对象的字符串表示形式。

但是在调用 时`new File(String)`，构造函数需要一个路径名，而不是包含 file:// URL 的字符串。由于“file:\C:\Users\Koen\Dropbox\2TI\vgo\Eindwerk\Tetris\build\classes\tetris\LineHighscores.txt”不是有效的 Windows 路径名，因此会引发异常。

有几种方法可以解决这个问题。一个简单的方法是使用`getResourceAsStream`而不是`getResource().toString()`. 然后改变

```
public String[][] loadHighscores(String path){
    int x=0;
    String test = "";
    file = new File(path);

    try {
        filescScanner = new Scanner(file);
    } catch (FileNotFoundException ex) {
        Logger.getLogger(FileIO.class.getName()).log(Level.SEVERE, null, ex);
    } 
```

到

```
public String[][] loadHighscores(InputStream resourceStream){
    int x=0;
    String test = "";

    filescScanner = new Scanner(resourceStream); 
```

这将允许您直接从输入文件中读取。并且`loadHighScores`不再关心数据是来自实际文件还是来自其他位置。如果您需要从类路径上的 jar 文件中读取资源，这会很方便。您将无法直接将其作为文件读取，但使用 getResourceAsStream 可以为您提供内容。

# css - css - 100% div 和固定大小的 div 从此过上幸福的生活？

> ID：13829491
> 
> 赞同：1
> 
> 时间：2012-12-11T22:21:23.397
> 
> 标签：css, screen-resolution

基本上，我试图在 300 像素（宽度）处设置一个固定大小的右侧边栏，并且在中心有 100% 的宽度，考虑到它旁边的 300 像素。

此外，我试图弄清楚如何将 100% 宽度的 div 放置在 100% 宽度的容器 div 中，我在下面包含了我想要实现的图像：

**基本理念**

![在此处输入图像描述](../Images/2aa729f5b2c51d1fb1a20045a4ebfcdf.png)

例如，这可能是在 1440 x 900 的屏幕分辨率上看到的

**使其可调整大小**

![在此处输入图像描述](../Images/7f3d627cefdf993a5d879cc8da14dfa9.png)

而这可能是在 1024 x 768 的屏幕分辨率上看到的

正如你所看到的，一切都保持在彼此的比例内。任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T04:54:52.433

我能够让它与它一起工作。很可能有更好的方法来做到这一点，但它看起来像你描述的那样。

代码：[https ://gist.github.com/4274099](https://gist.github.com/4274099)

结果：[http ://codepen.io/joe/full/wgJdm](http://codepen.io/joe/full/wgJdm)

关键是“伪造”#left（黄色）内部 div 的 100% 宽度，方法是将其绝对定位在 #sidebar 父级中，并将其右侧设置为等于 #right div 的宽度。

# django - 将 django SimpleLazyObject 传递给队列时芹菜任务失败

> ID：13829495
> 
> 赞同：1
> 
> 时间：2012-12-11T22:21:49.670
> 
> 标签：django, celery

我正在 `Django 1.4.1 + RabbitMQ 3(broker) + Celery3.0.12`为 Web 应用程序和任务处理运行堆栈。两台服务器，一台用于网络，一台仅用于任务。

当我将请求中的用户对象传递给 celery 任务时出现问题，该任务将失败。因为用户对象未能取消腌制。

经过一番研究，我发现我从请求中收集的用户对象是一个`SimpleLazyObject`无法通过网络的对象。

走走走走跟不经过一样容易`SimpleLazyObject`，我们该如何妥善处理呢？

# c# - LINQ方法在不循环的情况下查找特定键的值？（在 C# 中解析 json）

> ID：13829496
> 
> 赞同：0
> 
> 时间：2012-12-11T22:22:01.207
> 
> 标签：c#, json, linq, json.net

我正在使用 json.net (Newtonsoft) 库来解析 API json 响应。我只需要 id 值和 rank 值。json 看起来像这样：

```
{"items":
    [
        {"fields":
            {"entry":
                [
                    {"key":"Customer","value":"ABC Electronics"},
                    {"key":"Status","value":"Untouched"},
                    {"key":"Amount","value":"$1000"},
                    {"key":"rank","value":"3.0"}
                ]
            },
            "id":"1001",
            "owner":"dave@sales123.com"
        },
        {"fields":
            {"entry":
                [
                    {"key":"Customer","value":"General Products"},
                    {"key":"Status","value":"Developing"},
                    {"key":"Amount","value":"$6000"},
                    {"key":"rank","value":"6.0"}
                ]
            },
            "id":"1002",
            "owner":"john@sales123.com"
        }
    ]
} 
```

我的类中有一个方法，它发出请求，遍历 json 并获取 id 和 rank，然后将这些值作为新的 RankScore 对象添加到 List 类成员。我的问题是，是否有更好的方法来找到条目数组中键 ==“排名”的“值”，而不仅仅是循环遍历它并检查每个键。我找不到任何 LINQ 方式？

```
public void MakeRequest(apiURL) {
    var requestUrl = new Uri(apiUrl, "/ranks/0");
    HttpWebRequest request = WebRequest.Create(requestUrl) as HttpWebRequest;
    request.Credentials = new NetworkCredential(this.Username, this.Password);

    using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
    {
        using (var reader = new StreamReader(response.GetResponseStream()))
        {
            var token = JObject.Parse(reader.ReadToEnd());
            var items = token["items"];
            foreach (var item in items)
            {
                var id = item.Value<string>("id");
                var entries = item["fields"]["entry"];
                string rank = null;

                // **** Is there a better way to do this? ****
                foreach (var entry in entries) 
                {
                    if (entry.Value<string>("key") == "rank")
                    {
                        rank = entry.Value<string>("value");
                        break;
                    }
                }
                var ranking = new RankScore(int.Parse(id), rank);
                this.Ranks.Add(ranking);
            }

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:26:41.250

如果您计划为每个 JSON 结果查找多个值，那么将数据放入数据结构中可能是值得的，这样可以更有效地搜索您要查找的内容。例如，您可以创建一个`Dictionary`将键映射到值的方法，但是如果您只想搜索一次数据结构，那么创建它`Dictionary`会比您正在做的工作更多，所以您应该留下您的代码事情是这样的。

您可能会减少执行您想要的操作所需的代码量（乍一看，一些简化很明显），但搜索所有内容的底层算法不会改变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T22:34:43.747

简单的回答，不。你可以让其他东西为你做一些循环，但这并不意味着你会想出一个使用 LINQ 性能更好的解决方案（它也只是循环集合）。

如果您的目标只是清理可以序列化为对象的代码，那么您的代码中将有一个更简单的循环（当然 json.NET 会进行大量循环）；

```
for (int i = 0; i < Obj.items.Length; i++)
{
    Obj.items[i].id //do something with this here
} 
```

虽然我个人不建议这样做。我喜欢简单的方法。另一个（愚蠢的）想法是使用 RegEx。您的行数会更少，但性能会更差。基本上，您不会删除迭代，您可以使用抽象来完成其中的一些，但实际上没有意义。我会坚持你所拥有的，除非你要对 json 做更多的事情。如果您打算在其他地方使用 json 做更多事情，那么我将序列化为一个对象。

# ruby - 将 .class 文件路径添加到 JRuby 运行命令行

> ID：13829500
> 
> 赞同：1
> 
> 时间：2012-12-11T22:22:40.737
> 
> 标签：ruby, class, compiler-construction, command, jruby

我在文件夹中有 2 个文件：`~/hello.rb`和`~/help.rb`. hello.rb 需要 help.rb。我已将它们编译到 ~/build/ 文件夹中：

```
jrubyc -t build/ . 
```

当我用 jruby 运行 hello.rb 时，jruby 在 ~/ 中搜索 help.class，但我想告诉它在 ~/build/ 文件夹中查找。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T04:09:56.627

不太确定您要做什么，但这似乎是您要问的...

```
require 'build/help' 
```

或者，我们使用`-I`开关在运行时包含路径：

```
jruby -Ibuild hello.rb 
```

# java - 如何使用 java 作为服务器流式传输音乐？

> ID：13829511
> 
> 赞同：1
> 
> 时间：2012-12-11T22:23:28.280
> 
> 标签：java, stream, webserver, mp3

我正在为http尝试一个简单的java代码，如果我使用带有文件位置的chrome（http://localhost:8888/somefile.mp3）它工作正常，但如果我在iphone上使用safari，它会抛出错误： java.net.SocketException: Broken pipe 但如果我使用 LAMP 或任何 php 服务器，它工作正常。我怎样才能让它与java一起工作？

这是http服务器：

```
package com.streamternet;

import java.io.BufferedReader;
import java.io.DataOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStreamReader;
import java.net.InetAddress;
import java.net.ServerSocket;
import java.net.Socket;
import java.net.URLDecoder;
import java.util.StringTokenizer;

public class HTTPServer extends Thread {

static final String HTML_START =
        "<html>" +
                "<title>HTTP Server in java</title>" +
                "<body>";

static final String HTML_END =
        "</body>" +
                "</html>";

Socket connectedClient = null;
BufferedReader inFromClient = null;
DataOutputStream outToClient = null;

public HTTPServer(Socket client) {
    connectedClient = client;
}

public void run() {

    try {

        System.out.println( "The Client "+
                connectedClient.getInetAddress() + ":" + connectedClient.getPort() + " is connected");

        inFromClient = new BufferedReader(new InputStreamReader (connectedClient.getInputStream()));
        outToClient = new DataOutputStream(connectedClient.getOutputStream());

        String requestString = inFromClient.readLine();
        String headerLine = requestString;

        StringTokenizer tokenizer = new StringTokenizer(headerLine);
        String httpMethod = tokenizer.nextToken();
        String httpQueryString = tokenizer.nextToken();

        StringBuffer responseBuffer = new StringBuffer();
        responseBuffer.append("<b> This is the HTTP Server Home Page.... </b><BR>");
        responseBuffer.append("The HTTP Client request is ....<BR>");

        System.out.println("The HTTP request string is ....");
        while (inFromClient.ready())
        {
            // Read the HTTP complete HTTP Query
            responseBuffer.append(requestString + "<BR>");
            System.out.println(requestString);
            requestString = inFromClient.readLine();
        }

        if (httpMethod.equals("GET")) {
            if (httpQueryString.equals("/")) {
                // The default home page
                sendResponse(200, responseBuffer.toString(), false);
            } else {
                //This is interpreted as a file name
                String fileName = httpQueryString.replaceFirst("/", "");
                fileName = URLDecoder.decode(fileName);
                fileName="/"+fileName;
                if (new File(fileName).isFile()){
                    sendResponse(200, fileName, true);
                }
                else {
                    sendResponse(404, "<b>The Requested resource not found ....</b>", false);
                }
            }
        }
        else sendResponse(404, "<b>The Requested resource not found ...." +
                "Usage: http://127.0.0.1:5000 or http://127.0.0.1:5000/</b>", false);
    } catch (Exception e) {
        e.printStackTrace();
    }
}

public void sendResponse (int statusCode, String responseString, boolean isFile) throws Exception {

    String statusLine = null;
    String serverdetails = "Server: Java HTTPServer";
    String contentLengthLine = null;
    String fileName = null;
    String contentTypeLine = "Content-Type: text/html" + "\r\n";
    FileInputStream fin = null;

    if (statusCode == 200)
        statusLine = "HTTP/1.1 200 OK" + "\r\n";
    else
        statusLine = "HTTP/1.1 404 Not Found" + "\r\n";

    if (isFile) {
        fileName = responseString;
        fin = new FileInputStream(fileName);
        contentLengthLine = "Content-Length: " + Integer.toString(fin.available()) + "\r\n";
        if (!fileName.endsWith(".htm") && !fileName.endsWith(".html"))
            contentTypeLine = "Content-Type: audio/mpeg\r\n";
    }
    else {
        responseString = HTTPServer.HTML_START + responseString + HTTPServer.HTML_END;
        contentLengthLine = "Content-Length: " + responseString.length() + "\r\n";
    }

    outToClient.writeBytes(statusLine);
    outToClient.writeBytes(serverdetails);
    outToClient.writeBytes(contentTypeLine);
    outToClient.writeBytes(contentLengthLine);
    outToClient.writeBytes("Connection: close\r\n");
    outToClient.writeBytes("\r\n");

    if (isFile) 
        sendFile(fin, outToClient);
    else 
        outToClient.writeBytes(responseString);

    outToClient.close();
}

public void sendFile (FileInputStream fin, DataOutputStream out) throws Exception {
    byte[] buffer = new byte[1024] ;
    int bytesRead;

    while ((bytesRead = fin.read(buffer)) != -1 ) {
        out.write(buffer, 0, bytesRead);
        out.flush();
    }
    fin.close();
}

public static void main (String args[]) throws Exception {

    ServerSocket Server = new ServerSocket (8888);

    System.out.println ("TCPServer Waiting for client on port 8888");

    while(true) {
        Socket connected = Server.accept();
        (new HTTPServer(connected)).start();
    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T01:01:19.840

首先，这不是*流式传输*，这只是一个普通的 HTTP 请求-响应对话。看看你的服务器，它似乎在很多方面都被破坏了，甚至很难说为什么 Chrome 会设法下载任何东西。

我在[网上放了一个最小的 HTTP 服务器](http://pastebin.com/mrrP3tiC)，只是为了好玩。它远未完成，它不可配置并且仅支持`GET`请求，但是我认为如果您不想依赖其他服务器或框架，这是一个很好的起点。它只能给出两种响应：`200 OK`和`404 NOT FOUND`。在 CLASSPATH 上搜索资源，并与基于扩展的 MIME 类型信息一起发送到客户端。您可能想要添加 MP3 MIME，但请注意，这只是一个玩具，仅用于展示 HTTP 的基础知识。

编码：

```
public class TinyHTTPServer {

    public static void main(String[] args) throws IOException {

        ServerSocket server = new ServerSocket(8888);

        while (true) {
            final Socket connection = server.accept();
            new Thread(new Runnable(){
                public void run() {
                    RequestHandler handler = new RequestHandler();
                    handler.handle(connection);
                }
            }).start();
        }
    }

    public static class RequestHandler {

        public void handle(Socket socket) {
            try {
                Scanner scanner = new Scanner(socket.getInputStream(), "US-ASCII");
                String path = getPath(scanner.nextLine());

                Response response = find(path);

                PrintStream out = new PrintStream(socket.getOutputStream());

                for (String header : response.headers) {
                    out.print(header);
                    out.print("\r\n");
                }

                out.print("\r\n");
                if (response.url != null)
                    writeEntity(response.url.openStream(), socket.getOutputStream());
                out.print("\r\n");

                out.flush();
            } catch (Exception exception) {
                exception.printStackTrace();
            } finally {
                try {
                    socket.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }

        private String getPath(String requestLine) throws IOException {
            Matcher matcher = Pattern.compile("GET (/\\S*) HTTP/1\\.1").matcher(requestLine);
            matcher.find();
            return matcher.group(1);
        }

        private Response find(String path) {

            if (path.equals("/"))
                path = "/index.html";

            Response response = new Response();
            URL url = RequestHandler.class.getResource(path);

            if (url == null) {
                response.headers.add("HTTP/1.1 404 NOT FOUND");
            } else {
                response.url = url;
                response.headers.add("HTTP/1.1 200 OK");

                String type = "application/octet-stream";
                String extension = url.toString();

                if (extension.endsWith(".mp3"))
                    type = "audio/mp3";
                else if (extension.endsWith(".html"))
                    type = "text/html; charset=utf-8";

                response.headers.add("Content-Type: " + type);
            }

            return response;
        }

        private void writeEntity(InputStream in, OutputStream out) throws IOException {
            byte[] buffer = new byte[1024];
            int read = -1;

            while ((read = in.read(buffer, 0, buffer.length)) > -1) {
                out.write(buffer, 0, read);
            }
        }

    }

    public static class Response {

        public List<String> headers = new LinkedList<String>();
        public URL url;

    }
} 
```

# php - php (joomla) 邮件添加 %22、%40、%0A 等内容

> ID：13829513
> 
> 赞同：1
> 
> 时间：2012-12-11T22:23:33.243
> 
> 标签：php, email, joomla1.5, sendmail

我的 joomla 网站上有一个联系表 - 但由于某种原因，电子邮件突然开始出现 %22、%40、%0A 之类的东西，而不是符号？

我尝试过使用 htmlspecialchars_decode 和其他一些选项，但除了使用 str_replace 之外似乎无法摆脱它们，但显然这不会摆脱所有字符。谁能帮我吗？不知道为什么突然变了。

这是我的联系表格：

```
<form name="contact" id="contact">
  <div id="contactForm">
    <div class="information">
      <div class="__left">Name: *</div>
      <div class="__right"><input type="text" name="name" id="name" class="inputbox required" /></div>
    <div class="clear"></div>
    </div>
    <div class="information">
      <div class="__left">Email: *</div>
      <div class="__right"><input type="text" name="email" id="email" class="inputbox required email" /></div>
    <div class="clear"></div>
    </div>
    <div class="information">
      <div class="__left">Phone: *<br /><em>(Please include area code - XX XXXX XXXX)</em></div>
      <div class="__right"><input type="text" name="phone" id="phone" class="inputbox required phone" /></div>
    <div class="clear"></div>
    </div>
    <div class="information">
      <div class="__left">Message: *</div>
      <div class="__right"><textarea name="message" id="message" rows="10" class="inputbox required"></textarea></div>
    <div class="clear"></div>
    </div>
    <div class="__right"><input type="submit" name="submit" id="submit" value="Submit" class="button" /></div>
    <div class="clear"></div>
  </div>
</form> 
```

这是php：

```
$name       = htmlspecialchars_decode(JRequest::getVar('e_name'));
        $email      = htmlspecialchars_decode(str_replace('%40','@',JRequest::getVar('e_email')));
        $phone      = htmlspecialchars_decode(JRequest::getVar('e_phone'));
        $body       = htmlspecialchars_decode(str_replace('%0A','<br />',JRequest::getVar('e_message')));

        //send an email             
        $emailto        = $emailto;
        $emailfrom      = $email;
        $emailfromname  = $name;
        $subject        = $subject;

        # prepare email body text
        $message = '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
        <html xmlns="http://www.w3.org/1999/xhtml">
        <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>'. $subject .'</title>
        </head>
        <body>
        <p>'. $body .'</p>
        <hr />
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="300" align="left" valign="top">Name:</td>
            <td align="left" valign="top">'. $name .'</td>
          </tr>
          <tr>
            <td align="left" valign="top">&nbsp;</td>
            <td align="left" valign="top">&nbsp;</td>
          </tr>
          <tr>
            <td align="left" valign="top">Email:</td>
            <td align="left" valign="top">'. $email .'</td>
          </tr>
          <tr>
            <td align="left" valign="top">&nbsp;</td>
            <td align="left" valign="top">&nbsp;</td>
          </tr>
          <tr>
            <td align="left" valign="top">Phone:</td>
            <td align="left" valign="top">'. $phone .'</td>
          </tr>
        </table>
        </body>
        </html>';

        // send email
        if (JUtility::sendMail($emailfrom, $emailfromname, $emailto, $subject, $message, 1, $cc, $bcc, $attachment, $replyto, $replytoname)) {
            $response[] = 1;        
        } else {
            $response[] = 0;
        }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:26:25.403

使用[urlencode](http://php.net/manual/en/function.urlencode.php)或[urldecode](http://php.net/manual/en/function.urldecode.php)

干杯:)

# c# - 在内存中创建的工作区 - 无法访问符号信息

> ID：13829516
> 
> 赞同：0
> 
> 时间：2012-12-11T22:23:55.107
> 
> 标签：c#, roslyn

我正在为单元测试目的在内存中创建一个工作区，但我无法访问某个 InvocationExpression 的符号信息（这是我正在测试的 CodeIssue 所必需的）。这是一个失败的测试的简化示例。请帮忙？

```
 var solution =
            Solution.Create(SolutionId.CreateNewId())
                    .AddCSharpProject(Title, Title, out projectId)
                    .AddMetadataReference(projectId, MetadataReference.CreateAssemblyReference("mscorlib"))
                    .AddMetadataReference(projectId, MetadataReference.CreateAssemblyReference("Microsoft.CSharp"))
                    .AddMetadataReference(projectId, MetadataReference.CreateAssemblyReference("System"))
                    .AddMetadataReference(projectId, MetadataReference.CreateAssemblyReference("System.Core"))
                    .AddMetadataReference(projectId, MetadataReference.CreateAssemblyReference("System.Web"))
                    .AddDocument(projectId, "MyFile.cs",
                        @"using System.Web;
                        public partial class _Default : Page
                        {
                            protected void Page_Load(object sender, EventArgs e, string s)
                            {
                                Response.Write(""hello"");
                            }
                        }"
                    , out documentId);

        var mydocument = solution.GetDocument(documentId);
        var tree = mydocument.GetSyntaxTree();
        var model = mydocument.GetSemanticModel();
        var responseWriteLine = tree.GetRoot().DescendantNodesAndSelf().First(x => x.GetLocation().GetLineSpan(false).StartLinePosition.Line == 5 && x is InvocationExpressionSyntax);

        Assert.IsNotNull(model.GetSymbolInfo(responseWriteLine.Expression).Symbol); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T06:45:59.970

我在缺少的代码片段中添加了一些用法。

```
 var solution =
            Solution.Create(SolutionId.CreateNewId())
                    .AddCSharpProject(Title, Title, out projectId)
                    .AddMetadataReference(projectId, MetadataReference.CreateAssemblyReference("mscorlib"))
                    .AddMetadataReference(projectId, MetadataReference.CreateAssemblyReference("Microsoft.CSharp"))
                    .AddMetadataReference(projectId, MetadataReference.CreateAssemblyReference("System"))
                    .AddMetadataReference(projectId, MetadataReference.CreateAssemblyReference("System.Core"))
                    .AddMetadataReference(projectId, MetadataReference.CreateAssemblyReference("System.Web"))
                    .AddDocument(projectId, "MyFile.cs",
                        @"using System;
                        using System.Web;
                        using System.Web.UI;

                        public partial class _Default : Page
                        {
                            protected void Page_Load(object sender, EventArgs e, string s)
                            {
                                Response.Write(""hello"");
                            }
                        }"
                    , out documentId);

            var mydocument = solution.GetDocument(documentId);
            var tree = mydocument.GetSyntaxTree();
            SemanticModel model = (SemanticModel)mydocument.GetSemanticModel();

            var responseWriteLine = tree.GetRoot().DescendantNodes().OfType<InvocationExpressionSyntax>().First();
            Assert.IsNotNull(model.GetSymbolInfo(responseWriteLine.Expression).Symbol); 
```

# c# - File.Copy() 和符号链接

> ID：13829522
> 
> 赞同：9
> 
> 时间：2012-12-11T22:24:24.127
> 
> 标签：c#, .net, exception-handling, io, symlink

我想将一个文件复制到一个新的文件名。有时源文件可能是一个符号（文件）链接，用

```
mklink C:\MyPath\ThisIsASymbolicLink.xml C:\MyPath\ThisIsTheOriginal.xml 
```

我正在使用这段代码：

```
string from = @"C:\MyPath\ThisIsASymbolicLink.xml";
string to = @"C:\MyPath\WantCopyOfOriginalFileHere.xml";
File.Copy(from, to, true); 
```

但是，我收到 IOException

> 系统无法解析文件名。

当`from`文件真的是一个符号链接时。

对于源文件可能是真实文件或文件符号链接的情况，我该如何编写代码？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-12T01:48:12.333

扩展这篇[博文](http://chrisbensen.blogspot.com/2010/06/getfinalpathnamebyhandle.html)，我创建了扩展方法，它们采用 DirectoryInfo 或 FileInfo 可以引用原始链接或符号链接，并返回一个字符串，指示原始文件的完全限定路径名。

**应用程序代码**

应用代码修改如下：

```
// Works whether or not file is a symbolic link
string from = 
    new FileInfo(@"C:\MyPath\ThisIsASymbolicLink.xml").GetSymbolicLinkTarget(); 
```

**扩展方法代码**

```
 private const int FILE_SHARE_READ = 1;
    private const int FILE_SHARE_WRITE = 2;

    private const int CREATION_DISPOSITION_OPEN_EXISTING = 3;

    private const int FILE_FLAG_BACKUP_SEMANTICS = 0x02000000;

    // http://msdn.microsoft.com/en-us/library/aa364962%28VS.85%29.aspx
    [DllImport("kernel32.dll", EntryPoint = "GetFinalPathNameByHandleW", CharSet = CharSet.Unicode, SetLastError = true)]
    public static extern int GetFinalPathNameByHandle(IntPtr handle, [In, Out] StringBuilder path, int bufLen, int flags);

    // http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx
    [DllImport("kernel32.dll", EntryPoint = "CreateFileW", CharSet = CharSet.Unicode, SetLastError = true)]
    public static extern SafeFileHandle CreateFile(string lpFileName, int dwDesiredAccess, int dwShareMode,
    IntPtr SecurityAttributes, int dwCreationDisposition, int dwFlagsAndAttributes, IntPtr hTemplateFile);

    public static string GetSymbolicLinkTarget(this FileSystemInfo symlink)
    {
        using (SafeFileHandle fileHandle = CreateFile(symlink.FullName, 0, 2, System.IntPtr.Zero, CREATION_DISPOSITION_OPEN_EXISTING, FILE_FLAG_BACKUP_SEMANTICS, System.IntPtr.Zero))
        {
            if (fileHandle.IsInvalid)
                throw new Win32Exception(Marshal.GetLastWin32Error());

            StringBuilder path = new StringBuilder(512);
            int size = GetFinalPathNameByHandle(fileHandle.DangerousGetHandle(), path, path.Capacity, 0);
            if (size < 0)
                throw new Win32Exception(Marshal.GetLastWin32Error());
            // The remarks section of GetFinalPathNameByHandle mentions the return being prefixed with "\\?\"
            // More information about "\\?\" here -> http://msdn.microsoft.com/en-us/library/aa365247(v=VS.85).aspx
            if (path[0] == '\\' && path[1] == '\\' && path[2] == '?' && path[3] == '\\')
                return path.ToString().Substring(4);
            else
                return path.ToString();
        }
    } 
```

**单元测试**

```
[TestClass]
public class SymlinkTest
{
    [TestInitialize]
    public void SetupFiles()
    {
        if (!File.Exists(@"C:\Temp\SymlinkUnitTest\Original.txt")) throw new Exception("Run Symlinksetup.bat as Admin to create test data.");
    }

    [TestMethod]
    public void OrdinaryFile()
    {
        string file = @"C:\Temp\SymlinkUnitTest\Original.txt";
        string actual = new FileInfo(file).GetSymbolicLinkTarget();
        Assert.IsTrue(actual.EndsWith(@"SymlinkUnitTest\Original.txt"));
    }

    [TestMethod]
    public void FileSymlink()
    {
        string file = @"C:\Temp\SymlinkUnitTest\Symlink.txt";
        string actual = new FileInfo(file).GetSymbolicLinkTarget();
        Assert.IsTrue(actual.EndsWith(@"SymlinkUnitTest\Original.txt"));
    }

    [TestMethod]
    public void OrdinaryDirectory()
    {
        string dir = @"C:\Temp\SymlinkUnitTest";
        string actual = new DirectoryInfo(dir).GetSymbolicLinkTarget();
        Assert.IsTrue(actual.EndsWith(@"SymlinkUnitTest"));
    }

    [TestMethod]
    public void DirectorySymlink()
    {
        string dir = @"C:\Temp\SymlinkUnitTest";
        string actual = new DirectoryInfo(dir).GetSymbolicLinkTarget();
        Assert.IsTrue(actual.EndsWith(@"SymlinkUnitTest"));
    }
} 
```

**用于创建单元测试数据的批处理文件**

*必须以管理员身份运行... mklink 的要求。*

```
@Echo Off
Echo Must be run as Administrator (due to mklink)
mkdir C:\Temp
mkdir C:\Temp\SymlinkUnitTest
c:
cd C:\Temp\SymlinkUnitTest

echo Original File>Original.txt
mklink Symlink.txt Original.txt

mklink /D C:\Temp\SymlinkUnitTest\SymDir C:\Temp\SymlinkUnitTest 
```

# jquery - 如何在滚动时加载数据

> ID：13829523
> 
> 赞同：-2
> 
> 时间：2012-12-11T22:24:23.607
> 
> 标签：jquery, ajax, asynchronous

现在，我做了这样的事情：[tutorial @9lessons.info](http://www.9lessons.info/2009/07/load-data-while-scroll-with-jquery-php.html)

它在向下滚动窗口时加载数据并且工作正常。但我试图得到类似的东西：`when you scroll a div, then it loads the data.`

请帮我解决这个问题或将我引导到任何有教程的链接，它解释了如何做 a`data download`并在滚动 div 时将其添加到 DOM。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:29:21.217

有很多可能的解决方案。例如，您可以获取`scrollTop`文档的 ，当它到达时`height of the document`-`viewport height`您知道您在页面的底部。那是天线宝宝伪代码中的自定义方法。但也许您可以将[jQuery](http://jquery.com)与[Twitter bootstrap #scrollspy](http://twitter.github.com/bootstrap/javascript.html#scrollspy)结合使用。

我还发现了这个： [当用户向下滚动到内容时，如何加载内容？](https://stackoverflow.com/questions/9247907/how-do-i-make-content-load-when-the-user-scrolls-down-to-it)其中有一个可能的重复项，指的是[如何根据用户滚动加载网页内容](https://stackoverflow.com/questions/5020351/how-to-load-the-web-page-content-based-on-user-scrolling)，指的是[在用户向下滚动时](https://stackoverflow.com/questions/183782/loading-content-as-the-user-scrolls-down)加载内容和[加载内容作为元素滚动到视图](https://stackoverflow.com/questions/1464968/load-content-as-an-element-scrolls-into-view)中和[在滚动时使用 ajax 加载内容和在滚动时](https://stackoverflow.com/questions/3283669/loading-content-with-ajax-while-scrolling)重新[加载新内容](https://stackoverflow.com/questions/3584088/reloading-new-content-while-scrolling)

在评论中可以找到以下链接：

*   [http://gbin1.com/technology/jquerynews/20111017jquerypluginwaypoints/infinite-scroll/](http://gbin1.com/technology/jquerynews/20111017jquerypluginwaypoints/infinite-scroll/)
*   [http://www.appelsiini.net/projects/lazyload](http://www.appelsiini.net/projects/lazyload)
*   [http://johnpolacek.github.com/scrollorama/](http://johnpolacek.github.com/scrollorama/)

也许这可以在某种程度上帮助你。我只是好奇，你自己有没有试过谷歌？

**编辑**：我在 Smashing Magazine 的 Facebook 页面上发现[了这篇](http://www.html5rocks.com/en/tutorials/speed/scrolling/)文章，您可能会发现它很有趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:29:00.827

您不能单独使用 PHP 来执行此操作，因为服务器上的 PHP 在为页面源提供服务后，完全不知道客户端 UI 中发生了什么。

# javascript - 画布中的“DOM 异常 18”

> ID：13829525
> 
> 赞同：5
> 
> 时间：2012-12-11T22:24:29.083
> 
> 标签：javascript, html, canvas, svg

我正在拍摄 SVG 图像，将其绘制到画布上，并尝试通过 toDataURL 将其导出，但 Chrome 向我抛出了 DOM Exception 18 安全错误。我知道问题是因为我使用数据 URI 方案（data:image/svg+xml;base64）将 SVG 图像绘制到画布上，所以我猜浏览器将其视为跨域（即安全问题），但我想不出任何其他方法可以将我的 SVG 内容放到画布上。我无法托管它，因为 SVG 内容是动态的，并且在需要通过 toDataURL 导出之前先进行操作。

我阅读了此处提出的其他一些类似问题，但找不到任何解决我的问题的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:31:21.087

在 Chrome 中，将*任何*SVG 绘制到 a 上`canvas`都会污染它，因为 SVG*可能*包含 a `foreignObject`，[这是错误](https://code.google.com/p/chromium/issues/detail?id=68568)。Chrome 还存在[数据 URI 方案和`canvas`](https://code.google.com/p/chromium/issues/detail?id=58999)的问题，因此您遇到了双重打击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-09T17:53:10.057

我也有同样的问题。作为一种解决方法，我使用[SVG to HTML5 Canvas Converter](http://www.professorcloud.com/svg-to-canvas/)将 svg 转换为画布调用。

# python - Python sys.path - 附加 PYTHONPATH

> ID：13829526
> 
> 赞同：8
> 
> 时间：2012-12-11T22:24:34.357
> 
> 标签：python

在开始之前，我已经尝试了一段时间来完成它，但我没有运气。我正在尝试创建自己的 python 包，我将在我的项目中的单独文件中导入其中的模块。我试图通过'sys'将我的项目目录添加到pythonpath，但mod_wsgi仍然无法识别它：

```
import sys
sys.path.append('/var/www/')

from core.core import main 
```

尝试时：

> ImportError：没有名为 core.core 的模块

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-11T22:41:52.603

如果您的核心文件夹中没有该文件`__init__.py`，则不会将其识别为包。

因此，解决方案是`__init__.py`在您的核心文件夹中添加一个文件。

如果您已经添加了问题可能是绝对路径...具有绝对路径的核心文件夹：

1.  /var/www/核心
2.  /var/www/YourProject/core

如果您必须执行第二个选项：`sys.path.append('/var/www/YourProject')`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-20T15:14:32.350

You need to explicitly set PYTHONPATH with you root directory.

# jquery - jquery 事件未针对从 jquery 模板生成的 html 触发

> ID：13829528
> 
> 赞同：0
> 
> 时间：2012-12-11T22:24:42.527
> 
> 标签：jquery, razor, asp.net-mvc-4, jquery-templates

我对 Jquery 有点陌生并且遇到了这个问题。

这是我的 javascript

```
$(document).ready(function () {

    $("input.selected").change(function () {

        var cbid = $(this).attr('id');

        var id = cbid.substring(3);

        var base = window.location.host;

        if ($(this).is(':checked')) {
            $.ajax({
                type: "Get",
                url: "/api/SPChoices/" + id,
                success: function (data) {
                    alert("Choice succesfully saved.");
                },
                error: function (data) {
                    alert("This user cannot be added.");
                }
            });
        }
        else {
            $.ajax({
                type: "Delete",
                url: "/api/SPChoices/" + id,
                success: function (data) {
                    alert("Choice succesfully removed." + data);
                },
                error: function (data) {
                    alert("This user cannot be deleted");
                }
            });

        }
    });

    $.ajax({
        type: "Get",
        url: "/api/SPChoices",
        data: "{'Count':'7'}",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (msg) {
            ApplyTemplate(msg);
        }
    });

}); 
```

而应用模板生成代码的html。这是正确生成的。

```
function ApplyTemplate(msg) {

    $("#HBsTemplate").tmpl(msg).appendTo("#Container");

}

</script>

<script id="HBsTemplate" type="text/x-jquery-tmpl"> 
<div>
            <div style=" float:left">
            <img id="imgChooseHBpp" src="/Images/2.png" alt="alt text" />
            </div>
            <div>
                <h3>${HostedBuyer.Name}</h3>
                <p>templ</p>
                <input class='selected' type='checkbox' {{if IsSelected}}         checked="yes" {{/if}}   id='cb_${HostedBuyer.id}' />
            </div>
</div>
</script> 
```

我的问题是更改复选框不会触发事件。

如果我在服务器上的 razor 中生成上述 html，但当我在客户端生成上述 html 时，它可以正常工作吗？

我错过了什么？？请帮忙。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:26:15.623

必须使用jQuery 的[.on()](http://api.jquery.com/on/)功能来连接在加载时不发生的事件。

# javascript - for 循环条件是否优化？

> ID：13829530
> 
> 赞同：2
> 
> 时间：2012-12-11T22:25:06.833
> 
> 标签：javascript, optimization, compiler-construction, for-loop

几年前，我听说每次循环运行时都会评估 for 循环的条件部分。此外，访问财产的成本相对较高。

从那时起，我养成了将 for 循环编写为的习惯：

```
var data = [1,2,3,4,5,6];
for (var i=0, l=data.length; i<l; i++) {
    // do stuff
} 
```

这是不需要的优化吗？现代 Javascript 编译器/解释器是否已经优化了条件部分，因此不会多次访问长度属性？

这到底有多大的影响？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:27:04.417

> 这是不需要的优化吗？

是的，几乎总是如此。我确信每个 JavaScript 实现都有`O(1)`复杂性来获取长度。我能想象到的唯一一个你真正想要使用即使是最微小的优化的地方是游戏引擎。但是，如果您编写一个“普通”的 JavaScript 应用程序，这真的无关紧要——如果没有这种优化，您的代码会更易于阅读。

您还需要查看与循环主体相比可能存在的性能损失。它很可能涉及访问其他变量、您正在迭代的元素的属性，甚至修改 DOM（这通常非常昂贵）。

如果在大多数情况下循环性能是一个大问题，那么您可以很确定供应商不会实现`Array.prototype.forEach()`每次“迭代”都会带来函数调用的开销 - 与 DOM 操作相比（这在 jQuery 的情况下尤其可能`.each()`是使用）即使是便宜的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T22:29:26.873

除了 ThiefMaster 所说的之外，使用以下内容迭代数组是很常见的：

```
var arr = [1, 2, 3];
arr.forEach(function(el, i) {
   //...
}); 
```

或者

```
$.each(arr, function(i, el){
   //...
}); 
```

如果每次迭代调用一个*完整的函数*通常是可以接受的，那么检查数组的长度几乎肯定是可以接受的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T22:31:10.917

看看这个：[https ://blogs.oracle.com/greimer/entry/best_way_to_code_a](https://blogs.oracle.com/greimer/entry/best_way_to_code_a)

在 Mozilla 中：

```
for (var i=0; i<arr.length; i++) //4ms
for (var i=0, len=arr.length; i<len; i++) //3ms 
```

我认为这是一个lycorn问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-01T04:08:52.073

这种特殊情况非常普遍，可以安全地假设它已经过优化。例如，在 Java 中，for 循环在他们的文档中被列为他们将优化边界检查的唯一情况（在 java 中这是一件昂贵的事情）。

我建议以另一种方式看待它：如果可以想象的最常见情况没有优化，那么很可能还有许多其他情况您的特定引擎没有优化......这么多的想法手动优化似乎有点可笑。

# python - App Engine 请求在生产中出现用户 cookie 失败（Python）

> ID：13829533
> 
> 赞同：0
> 
> 时间：2012-12-11T22:25:35.997
> 
> 标签：python, google-app-engine, cookies, urllib2

我使用应用引擎调用另一个域上的服务并将该数据返回给应用引擎。该服务需要一个 cookie，所以我将它添加到标头请求中。这适用于我的本地 DEV 环境，但是当我部署到应用程序引擎生产时，当 cookie 应用于标头时，它不会返回数据。

```
recent_url = urllib2.build_opener()
recent_url.addheaders.append(('Cookie', 'dk_rv_pro_cd=UN75ES9000FXZA'))
recent = json.loads(recent_url.open("http://www.samsung.com/us/function/recentlyViewedYourDevices.do").read()) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T01:03:58.640

问题是 urllib2 使用应用引擎的 urlfetch 服务，当以这种方式传递时，它不处理 cookie。遇到类似问题的用户的这篇博文可能会有所帮助：[http ://everydayscripting.blogspot.nl/2009/08/google-app-engine-cookie-handling-with.html](http://everydayscripting.blogspot.nl/2009/08/google-app-engine-cookie-handling-with.html)

# devise - Devise + OmniAuth + Google_Apps：我如何“覆盖”现有的 Google Apps 域表单？

> ID：13829534
> 
> 赞同：0
> 
> 时间：2012-12-11T22:25:36.683
> 
> 标签：devise, omniauth, google-apps

[根据 Devise 人员提供的示例](https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview)，我已在我的应用程序中将 Devise + OmniAuth 与omniauth-google-apps 策略集成。这一切都适用于以下用户流程。

*   转到我的标准登录页面
*   点击使用 Google Apps 登录
*   在 users/auth/google_apps 的表单中输入 Google Apps 域（标准 OmniAuth 表单）
*   登录到 Google Apps（在身份验证后向 omniauth_callbacks 发起标准回调）
*   用户现在已登录到我的应用程序 - 万岁！

但是，我想用我自己的表单（这是用户提交他或她的 Google Apps 域的表单）“覆盖”标准的权宜之计 OmniAuth Google Apps 身份验证表单。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T19:33:49.097

好的，在研究了一段时间之后，我想我已经找到了一个很好的解决方案。我并没有“覆盖”标准的权宜之计 OmniAuth Google Apps 身份验证表单本身，但这就是我所做的。

`google_apps`我在现有的操作中添加了一个操作`SessionsController`

```
# sessions_controller.rb
def google_apps
  @title = 'Sign In with Google Apps'

  respond_to do |format|
    format.html
  end
end 
```

我添加了一个自定义视图来询问用户她的 Google Apps 域（请注意，表单只是将域发布到与 OmniAuth 表单相同的位置

```
-# google_apps.html.haml
= form_tag user_omniauth_authorize_path(:google_apps) do
  %p
    = url_field_tag 'domain', nil, placeholder: 'example.com'
  = link_to_submit_form 'Sign In' 
```

顺便说一句，如果您有更好的解决方案，请发布您的答案。

# orchardcms - Orchard CMS 中的自定义部件--可以访问字段，但不能使用此类型创建项目

> ID：13829535
> 
> 赞同：0
> 
> 时间：2012-12-11T22:25:40.207
> 
> 标签：orchardcms

我在 Orchard 模块中制作了一个自定义部件，在我的 Orchard 网站上，它显示为自定义部件。另外，当我用这个部分创建一个新的内容项时，这个部分的字段会显示出来，我可以输入输入。不幸的是，当我保存/发布此项目时，我收到“页面不存在”的错误消息。有没有其他人遇到过这个问题？我的猜测是数据库错误；由于零件的类型都在网站上公开，我怀疑这是问题所在。

# servicestack - ServiceStack - 域和子域的身份验证

> ID：13829537
> 
> 赞同：3
> 
> 时间：2012-12-11T22:25:59.410
> 
> 标签：servicestack

我想在域 (domain.com) 的根目录上托管 ServiceStack 身份验证提供程序，并为整个域 (sub1.domain.com、sub2.domain.com) 进行身份验证。

是否可以用我自己的替换默认实现，`ICookies`以便我可以在 cookie 中设置域？

我看到它`HttpResponseWrapper`实例化了默认实现，所以我猜不是。

还有另一种方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T20:18:59.837

我通过以下[拉取请求](https://github.com/ServiceStack/ServiceStack/pull/375)解决了我的问题。

在 Web.config 中，您可以为 cookie 指定域。ServiceStack 覆盖了这个值，但现在如果指定了它，ServiceStack 将不理会它。

```
<configuration>
  <system.web>
    <httpCookies domain=".domain.com" />
  </system.web>
</configuration> 
```

# maven - Maven 万无一失：附加到 argLine

> ID：13829538
> 
> 赞同：16
> 
> 时间：2012-12-11T22:26:05.680
> 
> 标签：maven, maven-3, maven-surefire-plugin

我有 2 个配置文件可能会或可能不会一起用于运行一组测试。它们每个都需要不同的 vmargs 才能运行，但如果它们一起使用，则可以将它们相互附加。

我正在寻找一种将 argLine 设置为其当前值加上我设置的串联的方法。

我希望它会像

```
<argLine>${argLine} -DnewVMArg</argLine> 
```

有没有类似的事情我可以做到这一点？

我尝试修复它，导致 maven 陷入递归循环。它记录在下面。

我最近的尝试是`<my.argLines></my.argLines>`全局定义一个属性，然后在配置文件中修改它。

在每个配置文件的属性块中，我将覆盖属性设置为：

```
<my.argLines>${my.argLines} -myUniqueToProfileArgs</my.argLines> 
```

在配置文件的每个安全配置中，我设置`<argLines>`为：

```
<argLines>${my.argLines}</argLines> 
```

这在逻辑上适合我，但它评估的方式显然不会网格化。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-01-11T16:27:33.063

`-DnewVMArg`在里面定义你的默认参数，`argLine`如下所示：

```
<properties>
    <customArg/>
    <argLine>${customArg} -DnewVMArg</argLine>
</properties> 
```

定义配置文件参数

```
<profiles>
    <profile>
        <id>profile1</id>
        <properties>
            <customArg>-DmyUniqueToProfile1Args</customArg>
        </properties>
    </profile>
    <profile>
        <id>profile2</id>
        <properties>
            <customArg>-DmyUniqueToProfile2Args</customArg>
        </properties>
    </profile>
</profiles> 
```

不需要额外的插件配置

```
<build>
    <plugins>
        <plugin>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.16</version>
            <configuration/>
        </plugin>
.... 
```

我已经测试过这个配置，我的结果如下。

默认

```
mvn surefire:test -X 
```

结果

```
(...)java -jar -DnewVMArg (...) 
```

目标与配置文件

```
mvn surefire:test -X -Pprofile1 
```

结果

```
(...)java -DmyUniqueToProfile1Args -DnewVMArg -jar (...) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-11T16:17:08.700

如果您只处理 -D 系统属性，则可以使用 <systemPropertyVariables> 而不是 <argLine>，然后它们将自然组合。其中一个配置文件可能具有：

```
<systemPropertyVariables>
    <propertyFromProfile1>value1</propertyFromProfile1>
</systemPropertyVariables> 
```

和第二个配置文件：

```
<systemPropertyVariables>
    <propertyFromProfile2>value2</propertyFromProfile2>
</systemPropertyVariables> 
```

此外，值得一提的是，这种方法允许您在子 pom 中覆盖来自父 pom 的单个属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-17T13:40:25.613

正如您所发现的，属性不能引用自身。

您需要为每个配置文件定义不同的属性，最后在您的肯定调用中将它们连接起来：

```
<properties>
  <!-- it is a good idea not to use empty or blank properties -->
  <first.props>-Dprofile1Active=false</first.props>
  <second.props>-Dprofile2Active=false</second.props>
</properties>
...
    <!-- surefire configuration -->
    <argLine>${first.props} ${second.props}</argLine>    
...
<profile>
  <id>first</id>
  <properties>
    <first.props>-myUniqueToProfile1Args</first.props>
  </properties>
</profile>
<profile>
  <id>second</id>
  <properties>
    <second.props>-myUniqueToProfile2Args</second.props>
  </properties>
</profile> 
```

另请注意非空默认值。Maven 有一些令人惊讶的处理方式。为了安全起见，请使用无害的非空白默认值（请参阅[Maven 中的“Null”与“empty”参数](https://stackoverflow.com/questions/7773134/null-versus-empty-arguments-in-maven)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-08T13:49:22.437

Eclipse：窗口 -> 首选项 -> TestNG -> Maven 取消选中“argLine”。

# javascript - 通过单击而不是悬停使用工具提示

> ID：13829539
> 
> 赞同：-3
> 
> 时间：2012-12-11T22:26:05.227
> 
> 标签：javascript, jquery, html, tooltip, qtip

有没有办法让 javascript 工具提示只在您单击一个元素时才显示，而不是简单地将鼠标悬停在它上面？

我有

```
 var selection = canvas.selectAll("circle").data(data);

selection.enter().append("circle")

canvas.append("svg:circle")

    selection
      .attr("title", my qtip stuff)
      .on("click", function(d, i){
          /*How to make qtip show up here*/
       }) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:49:12.423

由于您的代码块提到`qtip`，我假设您使用的是[qTip jQuery 插件](http://craigsworks.com/projects/qtip/)。

当您调用时，`.qtip()`您可以指定哪些事件将激活它，如下所示：

```
$(your_selector).qtip({
    show: 'click',
    hide: 'click'
}); 
```

# css - IE7浮动清除定义列表

> ID：13829541
> 
> 赞同：0
> 
> 时间：2012-12-11T22:26:07.350
> 
> 标签：css, css-float, internet-explorer-7

我有一个定义列表，我想用标签/定义对彼此相邻显示。

以下代码在所有现代浏览器中都能正常工作。我试图让它在 IE7 中工作，但 dd 值不尊重先前清除的 dt。我还需要做什么才能让它们像在 chrome 或 ff 中那样堆叠。

```
<style type="text/css">
   .label-value-list {
    }
   .label-value-list dt {
      float: left;
      clear: left;
      width: 100px;
   }
   .label-value-list dd {                           
      float: left;
   }
</style>

<dl class="label-value-list">
   <dt>First Label</dt>
   <dd>This is the first value</dd>

   <dt>Second Label</dt>
   <dd>I should be below the first value<br/>and I have two lines</dd>

   <dt>Third Label</dt>
   <dd>I should be below the second value</dd>
</dl> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:43:28.857

添加

```
*:first-child+html .label-value-list dd {
   float: none;
   display: inline-block;
} 
```

到你的 CSS。

见[http://jsfiddle.net/FFMvY/1/](http://jsfiddle.net/FFMvY/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:30:46.707

`float`为每个/对删除`DD`或使用自己的自我清除。顺便说一句，在第二种情况下，使用而不是.`DL``DT``DD``display: table``float`

# javascript - Google Maps Marker onclick 并在特定缩放级别上拖动

> ID：13829543
> 
> 赞同：2
> 
> 时间：2012-12-11T22:26:13.750
> 
> 标签：javascript, google-maps-api-3, overlay, draggable, google-maps-markers

我有两个问题。首先，我想用按钮在我的谷歌地图中添加标记，但我不知道我的错在哪里。其次，我的地图应该只能在缩放级别 16 上拖动。我希望有人可以帮助我解决我的问题。这是我的代码。

```
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<style type="text/css">
  html { height: 100% }
  body { height: 100%; margin: 0px; padding: 0px }
  #map_canvas { height: 100% }
</style>
<script type="text/javascript"
    src="http://maps.google.com/maps/api/js?sensor=true">
</script>
<script type="text/javascript">
  function initialize() {
    var latlng = new google.maps.LatLng(52.502648,13.529278);
    var myOptions = {
      zoom: 15,
      center: latlng,
      disableDefaultUI: true,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      center: new google.maps.LatLng(52.502648, 13.529278),
      minZoom: 15,
      maxZoom: 16
    };
    var map = new google.maps.Map(document.getElementById("map_canvas"),
        myOptions);

    var strictBounds = new google.maps.LatLngBounds(
    new google.maps.LatLng(52.50, 13.525),
    new google.maps.LatLng(52.506, 13.534)
    );

    // Listen for the dragend event
    google.maps.event.addListener(map, 'dragend', function() {
        if (strictBounds.contains(map.getCenter())) return;

    // We're out of bounds - Move the map back within the bounds

    var c = map.getCenter(),
         x = c.lng(),
         y = c.lat(),
         maxX = strictBounds.getNorthEast().lng(),
         maxY = strictBounds.getNorthEast().lat(),
         minX = strictBounds.getSouthWest().lng(),
         minY = strictBounds.getSouthWest().lat();

     if (x < minX) x = minX;
     if (x > maxX) x = maxX;
     if (y < minY) y = minY;
     if (y > maxY) y = maxY;

     map.setCenter(new google.maps.LatLng(y, x));
   });

   // Listen for the dragend event
    google.maps.event.addListener(map, 'bounds_changed', function() {
        if (strictBounds.contains(map.getCenter())) return;

    // We're out of bounds - Move the map back within the bounds

    var c = map.getCenter(),
         x = c.lng(),
         y = c.lat(),
         maxX = strictBounds.getNorthEast().lng(),
         maxY = strictBounds.getNorthEast().lat(),
         minX = strictBounds.getSouthWest().lng(),
         minY = strictBounds.getSouthWest().lat();

     if (x < minX) x = minX;
     if (x > maxX) x = maxX;
     if (y < minY) y = minY;
     if (y > maxY) y = maxY;

     map.setCenter(new google.maps.LatLng(y, x));
   });

   var imageBounds = new google.maps.LatLngBounds(
    new google.maps.LatLng(52.4952, 13.5189),
    new google.maps.LatLng(52.51, 13.53957)
    );

    var marker = new google.maps.Marker({
        position: new google.maps.LatLng(52.503971,13.52073),
        map:map,
        title:"Hello World!"
    });

    marker.setMap(map);

    var groundoverlay = new google.maps.GroundOverlay('pics/karte2.png', imageBounds);
    groundoverlay.setMap(map);
    groundoverlay.setOpacity(1);

  }

var wcs = [
    ['Klo1', 52.504971, 13.52063, 1],
    ['Klo2', 52.504071, 13.53023, 2],
];

var gastro = [
    ['Cafeteria', 52.504541,13.529014, 1],
    ['Imbiss', 52.500121,13.532913, 2],
];

    function setMarkers(map,locations){
        for (var i=0; i < locations.length; i++) {
            var loc = locations[i];
            var locLatLng = new google.maps.LatLng(loc[1], loc[2]);
            var locmarker = new google.maps.Marker({
                position:locLatLng,
                map:map,
                title: loc[0],
                zIndex: loc[3]
            });
        };

        locmarker.setMap(map);
    }

    /*google.maps.event.addListener(map, 'zoom_changed', function() {
        if (map.zoom!=15){map.setOptions({draggable:true});}
        else map.setOptions({draggable:false});
    });*/

</script>
</head>
<body onload="initialize()">
  <div id="map_canvas" style="width:480px; height:560px"></div>
  <form name="Test" action="">
  <input type="button" value="WCs" onclick="setMarkers(map,wcs)">
  <input type="button" value="Gastro" onclick="setMarkers(map,gastro)">
  </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T02:19:36.117

您可以指定“可拖动”属性：

```
var myOptions = {
  zoom: 15,
  center: latlng,
  disableDefaultUI: true,
  mapTypeId: google.maps.MapTypeId.ROADMAP,
  center: new google.maps.LatLng(52.502648, 13.529278),
  minZoom: 15,
  maxZoom: 16,
  draggable : false
};
var map = new google.maps.Map(document.getElementById("map_canvas"),
    myOptions); 
```

和这个：

```
google.maps.event.addListener(map, "zoom_changed", function() {
  map.setOptions({
    draggable : map.getZoom() == 16
  });
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T23:03:25.827

我在您的代码中添加了一些代码。请检查差异。

```
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<style type="text/css">
  html { height: 100% }
  body { height: 100%; margin: 0px; padding: 0px }
  #map_canvas { height: 100% }
</style>
<script type="text/javascript"
    src="http://maps.google.com/maps/api/js?sensor=true">
</script>
<script type="text/javascript">
  function initialize() {
    var latlng = new google.maps.LatLng(52.502648,13.529278);
    var myOptions = {
      zoom: 15,
      center: latlng,
      disableDefaultUI: true,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      center: new google.maps.LatLng(52.502648, 13.529278),
      minZoom: 15,
      maxZoom: 16
    };
    var map = new google.maps.Map(document.getElementById("map_canvas"),
        myOptions);

    var strictBounds = new google.maps.LatLngBounds(
      new google.maps.LatLng(52.50, 13.525),
      new google.maps.LatLng(52.506, 13.534)
    );

    // Listen for the dragend event
    google.maps.event.addListener(map, 'dragend', function() {
        if (strictBounds.contains(map.getCenter())) return;

    // We're out of bounds - Move the map back within the bounds

    var c = map.getCenter(),
         x = c.lng(),
         y = c.lat(),
         maxX = strictBounds.getNorthEast().lng(),
         maxY = strictBounds.getNorthEast().lat(),
         minX = strictBounds.getSouthWest().lng(),
         minY = strictBounds.getSouthWest().lat();

     if (x < minX) x = minX;
     if (x > maxX) x = maxX;
     if (y < minY) y = minY;
     if (y > maxY) y = maxY;

     map.setCenter(new google.maps.LatLng(y, x));
   });

   // Listen for the dragend event
    google.maps.event.addListener(map, 'bounds_changed', function() {
        if (strictBounds.contains(map.getCenter())) return;

    // We're out of bounds - Move the map back within the bounds

    var c = map.getCenter(),
         x = c.lng(),
         y = c.lat(),
         maxX = strictBounds.getNorthEast().lng(),
         maxY = strictBounds.getNorthEast().lat(),
         minX = strictBounds.getSouthWest().lng(),
         minY = strictBounds.getSouthWest().lat();

     if (x < minX) x = minX;
     if (x > maxX) x = maxX;
     if (y < minY) y = minY;
     if (y > maxY) y = maxY;

     map.setCenter(new google.maps.LatLng(y, x));
   });

   var imageBounds = new google.maps.LatLngBounds(
    new google.maps.LatLng(52.4952, 13.5189),
    new google.maps.LatLng(52.51, 13.53957)
    );

    var marker = new google.maps.Marker({
        position: new google.maps.LatLng(52.503971,13.52073),
        map:map,
        title:"Hello World!"
    });

    google.maps.event.addListener(map, "zoom_changed", function() {
      marker.setDraggable(map.getZoom() == 16);
    })

    //var groundoverlay = new google.maps.GroundOverlay('pics/karte2.png', imageBounds);
    //groundoverlay.setMap(map);
    //groundoverlay.setOpacity(1);

    var wcBtn = document.getElementById("btn_WCs");
    google.maps.event.addDomListener(wcBtn, "click", function() {
      setMarkers(map,wcs);
    });

    var gastroBtn = document.getElementById("btn_Gastro");
    google.maps.event.addDomListener(gastroBtn, "click", function() {
      setMarkers(map,gastro);
    });
  }

var wcs = [
    ['Klo1', 52.504971, 13.52063, 1],
    ['Klo2', 52.504071, 13.53023, 2],
];

var gastro = [
    ['Cafeteria', 52.504541,13.529014, 1],
    ['Imbiss', 52.500121,13.532913, 2],
];

    function setMarkers(map,locations){
        for (var i=0; i < locations.length; i++) {
            var loc = locations[i];
            var locLatLng = new google.maps.LatLng(loc[1], loc[2]);
            var locmarker = new google.maps.Marker({
                position:locLatLng,
                map:map,
                title: loc[0],
                zIndex: loc[3]
            });
        };

        locmarker.setMap(map);
    }

</script>
</head>
<body onload="initialize()">
  <div id="map_canvas" style="width:480px; height:560px"></div>
  <form name="Test" action="">
  <input type="button" value="WCs" id="btn_WCs">
  <input type="button" value="Gastro" id="btn_Gastro" >
  </form>
</body>
</html> 
```

# sql-server-2008 - TSQL 拆分函数跳过重复项

> ID：13829551
> 
> 赞同：0
> 
> 时间：2012-12-11T22:26:45.667
> 
> 标签：sql-server-2008, tsql

我怎样才能让这个跳过重复？

列可以是一；二；三；二

想分开；跳过后两个（任何重复）

```
CREATE FUNCTION dbo.Split2
(
    @RowData varchar(max),
    @SplitOn varchar(5)
)  
RETURNS @RtnValue table 
(
    Id int identity(1,1),
    Data varchar(8000)
) 
AS  
BEGIN 
    Declare @Cnt int
    Set @Cnt = 1

    While (Charindex(@SplitOn,@RowData)>0)
    Begin
        Insert Into @RtnValue (data)
        Select 
            Data = ltrim(rtrim(Substring(@RowData,1,Charindex(@SplitOn,@RowData)-1)))

        Set @RowData = Substring(@RowData,Charindex(@SplitOn,@RowData)+1,len(@RowData))
        Set @Cnt = @Cnt + 1
    End

    Insert Into @RtnValue (data)
    Select Data = ltrim(rtrim(@RowData))

    Return
END 
```

回答

```
CREATE FUNCTION dbo.Split2
(
    @RowData varchar(max),
    @SplitOn varchar(5)
)  
RETURNS @RtnValue table 
(
    Id int identity(1,1),
    Data varchar(8000)
) 
AS  
BEGIN 
    Declare @Data varchar(8000)
    Declare @Cnt int
    Set @Cnt = 1 

    While (Charindex(@SplitOn,@RowData)>0)
    Begin
        set @Data = ltrim(rtrim(Substring(@RowData,1,Charindex(@SplitOn,@RowData)-1)))
        IF NOT EXISTS (SELECT * FROM @RtnValue WHERE data = @Data) 
        BEGIN
           INSERT INTO @RtnValue (data)
           VALUES (@Data)
        END
        Set @RowData = Substring(@RowData,Charindex(@SplitOn,@RowData)+1,len(@RowData))
        Set @Cnt = @Cnt + 1
    End
    set @Data = ltrim(rtrim(@RowData))
    IF NOT EXISTS (SELECT * FROM @RtnValue WHERE data = @Data) 
    BEGIN
       INSERT INTO @RtnValue (data)
       VALUES (@Data)
    END

    Return
END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:46:56.973

在插入 while 循环之前检查。添加`IF NOT EXISTS`如下；

```
DECLARE @temp VARCHAR(100) --declare a temp variable

While (Charindex(@SplitOn,@RowData)>0)
Begin

   SELECT @temp = ltrim(rtrim(Substring(@RowData,1,Charindex(@SplitOn,@RowData)-1)))

   IF NOT EXISTS (SELECT * FROM @RtnValue WHERE data = @temp) 
   BEGIN
       INSERT INTO @RtnValue (data)
       VALUES (@temp)
   END

   Set @RowData = Substring(@RowData,Charindex(@SplitOn,@RowData)+1,len(@RowData))
   Set @Cnt = @Cnt + 1
End 
```

**编辑：**添加一个 IF 条件来检查存在

# bash - 使用函数和 if 语句的 Bash 脚本中的无限循环

> ID：13829553
> 
> 赞同：0
> 
> 时间：2012-12-11T22:27:00.973
> 
> 标签：bash, function, shell, loops, if-statement

试图了解这里发生了什么以及为什么？

首先调用名为“why”的函数，然后结果应该是对该函数的另一个调用或完全退出。预期的结果永远无法在 if 语句下方运行循环，这可能是 if-else-fi 语句或 if-elif-else-fi 并且无关紧要。

问题是为什么它回显结束？

我不明白为什么最后一个回声能够被调用。

```
why ()  {
  read -p 'Loop now?  [y/n]' answer
      case $answer in
        y | Y | yes | YES ) answer="y";;
        *) exit;;
       esac
}

if [ $answer = 'y' ]
then
    why
fi
why 
echo "End" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T01:36:40.123

您在调用的程序部分没有循环`why`。你是这个意思吗？

```
while true; do
  why ">" y n
  if [ $answer = y ]; then
    do something
  else
    do something else
  fi
done
echo "I'll never get here" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T18:43:17.157

if 语句认为它在函数完成时自行完成。在这个例子中得到了更好的展示，并且脚本不会循环回到 echo 开始。

```
echo start
why ()  {
  read -p 'Loop now?  [y/n]' answer
      case $answer in
        y | Y | yes | YES ) answer="y";;
        *) echo 'Invalid response -- exiting now'
           exit;;
       esac
}

answer=y

if [ $answer = 'y' ]
then

    why
    echo "Ok done running the if statement ready to exit the condition now"
fi 
```

所以来回循环一个函数来包装 if 语句，如下所示：

```
echo start
why ()  {
  read -p 'Loop now?  [y/n]' answer
      case $answer in
        y | Y | yes | YES ) answer="y";;
        n | N | no | NO ) answer="n";;
        *) echo 'Invalid response -- exiting now'
           exit;;
       esac
  ifFunction
}

ifFunction () { 
  if [ $answer = 'y' ]
  then

    why
    echo "yes"
  elif [ $answer = 'n' ]
  then
    echo "to bad looping anyway"
    why
  else
    echo "else nothing but another question"
    why
  fi
}
why
echo never 
```

所以答案是它已经完成了该功能，现在按预期继续执行脚本，在提供的示例中，它会回显 end 作为下一个要完成的任务。

# charts - SSRS 2008 R2“重置”折线图 RunningValue 跨组

> ID：13829556
> 
> 赞同：0
> 
> 时间：2012-12-11T22:27:07.567
> 
> 标签：charts, ssrs-2008, ssrs-grouping

我有一个带有折线图叠加层的堆积条形图。该图表有 2 个类别组（细分和季度）。折线图是段类别中的 RunningValue。

我需要能够在段类别的每个实例中“重置”折线图。现在它将第一个分组中的最后一个点和第二个分组中的第一个点视为连续的，并用一条线将这两个点连接在一起。当线穿过类别组边界时，我想不画线。

下图。

![折线图图像](../Images/3b28276d947c75bbe1150225f6988792.png)

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T03:53:15.663

为段类别的每个实例创建一条线。

# php - 给定一个 URL 找到联系链接

> ID：13829559
> 
> 赞同：0
> 
> 时间：2012-12-11T22:27:23.750
> 
> 标签：php, regex, html-parsing, web-scraping

我有一个 url，我必须在 url 中找到一个联系链接。

所以我所做的是使用 simple_html_dom.php 循环遍历所有 a 标签，如果它包含单词“contact”或“advertis”，那么它就是联系人 url。但这实际上非常缓慢。

所以我现在想做的是使用 curl 抓取页面（没问题，将来甚至是多卷曲），如果链接包含“联系人”或“广告”，则尝试在抓取结果 aa href 链接中查找正则表达式.

我会使用 preg_match_all 但正则表达式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:30:47.233

```
preg_match_all('/\<a href\=\"(.*?(contact|advertis)+.*?)\"\>(.+?)\<\/a>/m', $page, $matches); 
```

# events - SpreadsheetGear Grid：删除或插入行或列的事件？

> ID：13829562
> 
> 赞同：1
> 
> 时间：2012-12-11T22:27:53.310
> 
> 标签：events, grid, spreadsheetgear

正如标题所说，这些操作是否存在事件，例如删除行或列、插入行或列或更改单元格中的文本？如果没有，我会非常失望。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T06:00:25.363

当您删除或插入行或列时，WorkbookView 类的[RangeChanged 事件会触发。](http://www.spreadsheetgear.com/support/help/spreadsheetgear.net.7.0/SpreadsheetGear2012.Windows.Forms~SpreadsheetGear.Windows.Forms.WorkbookView~RangeChanged_EV.html)例如，如果您删除一个列，您可以从 RangeChangedEventArgs 中看到该列的地址。

```
public void workbookView1_RangeChanged(object sender, RangeChangedEventArgs e)
{
    //if column D is deleted, address = "$D:$D"
    string address = e.Range.Address
} 
```

处理在单元格中输入的文本的一个有用事件是WorkbookView 类的[CellEndEdit 事件，该事件在用户完成编辑单元格时触发。](http://www.spreadsheetgear.com/support/help/spreadsheetgear.net.7.0/SpreadsheetGear2012.Windows.Forms~SpreadsheetGear.Windows.Forms.WorkbookView~CellEndEdit_EV.html)

```
private void workbookView1_CellEndEdit(object sender, CellEndEditEventArgs e)
{
  IRange range = e.RangeSelection;
  string entry = e.Entry;
} 
```

# regex - 使用正则表达式查找单词

> ID：13829563
> 
> 赞同：1
> 
> 时间：2012-12-11T22:27:53.280
> 
> 标签：regex, matlab

我有一条推文，我需要找到主题标签所说的内容。如何使用正则表达式隔离并保存以“#”开头并以“”结尾的所有内容？我正在使用 MatLab。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-11T22:57:34.077

当您不熟悉正则表达式时，使用起来可能会很困难。

这是查找主题标签的一种方法：

```
tweet = 'it is fun to post on #stackoverflow, really';
regexp(tweet,'#(\w+)','tokens','once')
ans = 
    'stackoverflow' 
```

做什么`#(\w+)`？我们用 来查看“单词”字符（没有空格，没有标点符号）`\w`，并指定我们至少需要其中一个`+`。单词必须以 . 开头`#`。我们使用括号来指示我们想要返回哪个部分，以及`tokens`返回匹配项的选项（我不在乎主题标签在推文中的位置）。我设置了选项`once`，以便`regexp`只查找一个主题标签；如果您希望推文中有多个主题标签，请不要这样做，但请注意输出将是一个字符串元胞数组。

# sql - 用于调查的棘手 SQL Server 数据透视表

> ID：13829565
> 
> 赞同：1
> 
> 时间：2012-12-11T22:28:13.423
> 
> 标签：sql, sql-server, tsql, pivot, unpivot

我有一个包含以下数据的 SQL Server 视图：

```
ID   clientID  surveyID    questionID     q_optionID   q_ans_text
-----------------------------------------------------------------
1       1          1           1            NULL            Yes
2       1          1           2             18             NULL 
3       1          1           3             19             NULL
4       2          1           1            NULL             No
5       2          1           2             18             NULL
6       2          1           3             19             NULL
7       3          2           1            NULL            Yes 
8       3          2           2             15             NULL 
9       3          2           3             13             NULL 
```

我希望结果是这样的：

```
ClientID  SurveyID   Q1    Q2    Q3  
------------------------------------
   1          1     Yes    18    19   
   2          1      No    18    19   
   3          2     Yes    15    13 
```

忽略条件`NULL`值并将正确答案放在列中的位置。我看过数据透视表示例，但它们似乎专注于单列数据透视表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:40:27.063

为了执行此转换，您将需要`UNPIVOT`然后`PIVOT`数据。`UNPIVOT`将从您的 和 列中获取值并将`q_optionID`其 `q_ans_text`转换为两列，其中一列具有值和列名。

有两种方法可以做到`PIVOT`这一点，可以使用静态版本对所有值进行硬编码，也可以使用动态 sql。为了`UNPIVOT`获得数据，您需要确保数据具有相同的数据类型，因此可能需要进行转换。

**静态枢轴：**

```
select clientid, surveyid, 
    questionid,
    value,
    col
  from
  (
    select clientid, surveyid, questionid,
      cast(q_optionID as varchar(4)) q_optionID,
      q_ans_text
    from yourtable
  ) s
  unpivot
  (
    value
    for col in (q_optionID, q_ans_text)
  ) un 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c042f/4)

反透视结果：

```
| CLIENTID | SURVEYID | QUESTIONID | VALUE |        COL |
---------------------------------------------------------
|        1 |        1 |          1 |   Yes | q_ans_text |
|        1 |        1 |          2 |    18 | q_optionID |
|        1 |        1 |          3 |    19 | q_optionID |
|        2 |        1 |          1 |    No | q_ans_text |
|        2 |        1 |          2 |    18 | q_optionID |
|        2 |        1 |          3 |    19 | q_optionID |
|        3 |        2 |          1 |   Yes | q_ans_text |
|        3 |        2 |          2 |    15 | q_optionID |
|        3 |        2 |          3 |    13 | q_optionID | 
```

然后，您将应用于`PIVOT`结果以获得最终产品。

```
select *
from
(
  select clientid, surveyid, 
    'Q'+cast(questionid as varchar(10)) question,
    value
  from
  (
    select clientid, surveyid, questionid,
      cast(q_optionID as varchar(4)) q_optionID,
      q_ans_text
    from yourtable
  ) s
  unpivot
  (
    value
    for col in (q_optionID, q_ans_text)
  ) un
) src
pivot
(
  max(value)
  for question in (Q1, Q2, Q3)
) piv 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c042f/5)

**动态枢轴：**

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME('Q'+cast(questionid as varchar(10))) 
                    from yourtable
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT clientid, surveyid,' + @cols + ' from 
             (
                select clientid, surveyid, 
                  ''Q''+cast(questionid as varchar(10)) question,
                  value
                from
                (
                  select clientid, surveyid, questionid,
                    cast(q_optionID as varchar(4)) q_optionID,
                    q_ans_text
                  from yourtable
                ) s
                unpivot
                (
                  value
                  for col in (q_optionID, q_ans_text)
                ) un
            ) x
            pivot 
            (
                max(value)
                for question in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c042f/6)

**UNION ALL/聚合与案例版本：**

现在，如果您在没有的系统中工作，`PIVOT`则可以使用`UNION ALL`to和带有to`UNPIVOT`的聚合函数：`CASE``PIVOT`

```
select clientid, surveyid,
  max(case when questionid = 1 then value end) Q1,
  max(case when questionid = 2 then value end) Q2,
  max(case when questionid = 3 then value end) Q3
from
(
  select clientid, surveyid, questionid, cast(q_optionID as varchar(10)) value, 'q_optionID' col
  from yourtable
  union all
  select clientid, surveyid, questionid, q_ans_text value, 'q_ans_text' col
  from yourtable
) unpiv
group by clientid, surveyid 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c042f/7)

这三个都将产生相同的结果：

```
| CLIENTID | SURVEYID |  Q1 | Q2 | Q3 |
---------------------------------------
|        1 |        1 | Yes | 18 | 19 |
|        2 |        1 |  No | 18 | 19 |
|        3 |        2 | Yes | 15 | 13 | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T22:59:21.830

没有明确的 unpivot 的示例。不过，这仍然是一个非常有用的技术！

```
Select
  clientID, 
  SurveyID, 
  [1] as Q1, 
  [2] as Q2,
  [3] as Q3
From (
  Select
    clientID,
    surveyID,
    questionID,
    IsNull(Cast(q_optionID as varchar(10)), q_ans_text) answer
  From
    Answers
) a
Pivot (
  Max(answer)
  For questionID In ([1], [2], [3])
) p 
```

[http://sqlfiddle.com/#!6/8552a/8](http://sqlfiddle.com/#!6/8552a/8)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-26T16:53:11.743

```
select
  clientid, surveyid,
  max(case when questionid = 1 then coalesce(q_ans_text, cast(q_optionID as char)) else null end) as Q1,
  max(case when questionid = 2 then coalesce(q_ans_text, cast(q_optionID as char)) else null end) as Q2,
  max(case when questionid = 3 then coalesce(q_ans_text, cast(q_optionID as char)) else null end) as Q3
 from yourtable
 group by clientid, surveyid 
```

[http://sqlfiddle.com/#!18/9163ba/11](http://sqlfiddle.com/#!18/9163ba/11)

# wpf - WPF 4.0 验证错误

> ID：13829566
> 
> 赞同：0
> 
> 时间：2012-12-11T22:28:21.457
> 
> 标签：wpf, validation, datagrid

我们最近将 .NET 3.5 SP1 应用程序升级到 .NET 4.0 并注意到验证似乎已在所有控件中打开（或报告），例如绑定到模型中 int 属性的 TextBox 的 Text 属性现在将获得红色边框输入字母时围绕它。

在 3.5 中，在其中写一个字母不会高度带有红色边框的文本框，它会被默默地忽略。

在 4.0 中，这在 DataGrid 中给我们带来了问题，因为它现在将整个网格更改为只读，直到用户在之前静默清除值时修复错误。如果该行随后以编程方式被删除，则整个网格将保持只读状态。

既然我们不使用WPF验证框架，有没有办法恢复3.5的行为呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T00:52:52.573

我认为你得到这种行为是因为你有`ValidatesOnDataExceptions=True`你的绑定。将其设置为 false 或留空应该可以解决问题（AFAIK，默认为 false）。

# routing - 无需重新加载即可更新动态段

> ID：13829571
> 
> 赞同：1
> 
> 时间：2012-12-11T22:29:12.083
> 
> 标签：routing, ember.js

我想用两条路线创建“搜索”页面：

`/`index - 默认路由
`/:time/:filter`搜索 - 用户输入一些参数后的路由，segment`filter`被手动序列化/反序列化

目前我正在使用这些路由之间进行转换`transitionTo`，但是我想停止这样做，因为它会重新渲染（重新插入？）整个应用程序。

我想要做的：更改 url（表单`/`或`/:time/:filter`只是更新`:time`和`:filter`分段），但保留应用程序的当前状态。

这样的事情可能吗？

Ember.js 版本：1.0.0-PRE.2
JsFiddle：http: [//jsfiddle.net/hKzG9/2/](http://jsfiddle.net/hKzG9/2/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T14:25:26.193

您正在寻找的技术是嵌套插座。一个模板可以有任意数量的出口，插入一个出口的模板也可以有自己的出口。在您的示例中，您始终在进入新状态时连接应用程序模板插座。这就是导致整个应用程序重绘的原因。

实际上，您想要的是 HomeView 的模板也有一个出口。您将使用 HomeView 实例填充应用程序模板中的插座，该实例现在具有自己的插座。当您执行搜索（并进入`search`状态）时，您会将 HomeView 模板内的插座与另一个视图连接以显示结果。

我已经更新了你的小提琴以反映这一点：http: [//jsfiddle.net/hKzG9/3/](http://jsfiddle.net/hKzG9/3/)

你`data-template-name="app-page-home"`现在有一个`{{outlet}}`部分，我已经添加了`data-template-name="app-results"`一个匹配的视图和控制器。

在`search`您将看到的状态下，我现在打电话`router.get('homeController').connectOutlet('results')`而不是`router.get('applicationController').connectOutlet('home')`第二次打电话。

这将使已经可见的搜索控件不会重新绘制，并将为搜索结果插入一个新区域。

# javascript - 动态填充 Twitter Bootstrap Typeahead

> ID：13829574
> 
> 赞同：1
> 
> 时间：2012-12-11T22:29:26.310
> 
> 标签：javascript, twitter-bootstrap

如果我将静态数组作为源，Typeahead 可以工作，但是当我尝试使用函数生成数组时，它不会填充其下拉列表。

```
$("#mix-artist" ).typeahead({
        source: function(query, process) {
            Mix.searchArtist(query);
        },          
        minLength: 3,
    }); 
```

源函数：

```
searchArtist: function(query) {
    $.get(API_MAIN_URL, {a: "search.artists", q: query}, 
        function(data) {
            artists = [];
            query = query.toLowerCase();
            if (data['aData']) {
                for (var i = 0; i <= data['aData'].length; i++) {
                    if (data['aData'][i] && data['aData'][i]['sName'].toLowerCase().indexOf(query) == 0) {
                        artists.push(data['aData'][i]['sName']);
                    }
                }
            }
            console.log(artists);
            return artists;
        });
} 
```

源函数的示例输出：

```
["Arcangel", "Arc Angels", "Arcade Fire", "Arctic Monkeys", "Archers of Loaf", "Architecture in Helsinki", "Archie Shepp", "Arcade", "Arch Enemy", "Arcadia", "Archie Eversole"] 
```

我该怎么做才能提前输入接受这个数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:35:38.357

你需要你的`searchArtist`函数来接受`process`回调。而不是返回数组，您应该调用`process(artists)`.

# javascript - Jquery，选择id然后选择部分相似的id

> ID：13829580
> 
> 赞同：0
> 
> 时间：2012-12-11T22:29:40.257
> 
> 标签：javascript, jquery, css-selectors

我正在努力做到这一点，因此当您单击特定图像时，该图像将隐藏，然后相应的 youtube 视频 iframe 将显示并向下滑动。我已经完成了这项工作，但我想压缩此代码，因此我不必为每个图像/视频组合输入它。我将如何将其变成一小段代码，自动应用于带有#something_click 的图像并使用#something_slide 匹配视频？

```
$(document).ready(function(){   

$('#abcd_click').click(function(evt){
    evt.preventDefault();
    $(this).hide();
$('#abcd_slide').before("<br />").slideDown('slow');
});

$('#efgh_click').click(function(evt){
evt.preventDefault();
$(this).hide();
$('#efgh_slide').before("<br />").slideDown('slow');
}); 
```

不断地不断地不断地......

编辑：不确定这是否是最好、最干净或最快的方法，但我确实使用一些答案的组合来做到这一点。谢谢大家！

```
<script type="text/javascript">
$(document).ready(function(){   
$('img[id$="_click"]').click(function(evt) {
        evt.preventDefault();
        var thisId = $(this).attr('id');
        var videoID = thisId.split('_')[0];
        $(this).hide();
        $('#'+videoID+'_slide').before('<br />').slideDown('slow');   
   });        
});    
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:31:21.043

使用类名而不是 ID。这就是他们的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:43:43.533

假设您想对页面上的所有图像执行此操作，以下是一般执行此操作的一种方法：

```
$(document).ready(function(){   

    $('img').click(function(evt) {
        var thisId = $(this).attr("id");
        if(thisId && thisId.indexOf("_click") != -1)
        {
           var videoId = thisId.split("_")[0];
           evt.preventDefault();
            $(this).hide();
            $("#"+videoId+"_slide").before("<br />").show().slideDown('slow');

        }
    });
});​ 
```

[这](http://jsfiddle.net/ZgGBL/1/)是一个示例小提琴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T22:31:43.807

您可以使用“结束于”选择器：

```
$('[id$="_click"]') 
```

上面抓取了所有 id 以“_click”结尾的元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-11T22:39:15.740

用 为元素分配一个通用类和一个`data-`属性`id=abcd_click`，调用它`data-slide`，并用它来存储要滑动的元素的ID。然后用`.data()`它来检索它。使用这种方法，您可以为所有实例使用一个事件处理程序：

HTML：

```
<a href="#" class="clicker" id="abcd_click" data-slide="abcd_slide">
    <img src="whatever.gif">
</a> 
```

jQuery：

```
$('.clicker').click(function(evt){
    evt.preventDefault();
    $(this).hide();
    $('#'+$(this).data('slide')).before("<br />").slideDown('slow');
}); 
```

# wcf - 如何配置 WCF REST 以使用 SSL？

> ID：13829582
> 
> 赞同：2
> 
> 时间：2012-12-11T22:29:40.600
> 
> 标签：wcf, rest, ssl

我有一个运行良好的 WCF REST-ful JSON 服务。当我尝试将其用于 HTTPS 时，就会出现问题。Web.config 如下：

```
 <system.serviceModel>
    <bindings>
      <webHttpBinding>
        <binding name="StreamedRequestWebBinding" bypassProxyOnLocal="true" useDefaultWebProxy="false" hostNameComparisonMode="WeakWildcard" sendTimeout="10:15:00" openTimeout="10:15:00" receiveTimeout="10:15:00" maxReceivedMessageSize="2147483647" maxBufferSize="2147483647" maxBufferPoolSize="2147483647" transferMode="StreamedRequest">
          <security mode="Transport">
            <transport clientCredentialType = "None"  />
          </security>
          <readerQuotas maxArrayLength="2147483647" maxStringContentLength="2147483647" />
        </binding>
      </webHttpBinding>
    </bindings>
    <services>
      <service name="WcfRESTFullJSON.Service1" behaviorConfiguration="ServiceBehaviour">
        <endpoint address="" binding="webHttpBinding" bindingConfiguration="StreamedRequestWebBinding" contract="WcfRESTFullJSON.IService1" />
        <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="ServiceBehaviour">
          <serviceMetadata httpsGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>
      <endpointBehaviors>
        <behavior name="web">
          <!--Him-->
          <webHttp automaticFormatSelectionEnabled="true" />
        </behavior>
      </endpointBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" aspNetCompatibilityEnabled="true" />
  </system.serviceModel> 
```

我在 IIS 上配置了一个自制的证书。在客户端我有：

```
WebClient WC;
...
WC.UploadData(URL, "POST", asciiBytes); 
```

我们得到什么：

```
The remote server returned an error: (500) Internal Server Error. 
```

可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:48:17.547

问题已解决。这是对以下行中端点行为的缺失引用 ...endpoint **behaviorConfiguration="web"** address="" binding="webHttpBinding" bindingConfiguration="StreamedRequestWebBinding" contract="WcfRESTFullJSON.IService1"... 在 Web 中。配置如下。感谢各位朋友的帮助！最终在[使用 WCF 服务实现 REST 的 5 个重要原则一文中找到了解决方案](http://www.codeproject.com/Articles/283550/Implementing-5-important-principles-of-REST-using#h)

```
 <services>
  <service name="WcfRESTFullJSON.Service1" behaviorConfiguration="ServiceBehaviour">
    <endpoint  behaviorConfiguration="web" address="" binding="webHttpBinding" bindingConfiguration="StreamedRequestWebBinding" contract="WcfRESTFullJSON.IService1" />
    <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
  </service>
</services>
<behaviors>
  <serviceBehaviors>
    <behavior name="ServiceBehaviour">
      <serviceMetadata httpsGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="false" />
    </behavior>
  </serviceBehaviors>
  <endpointBehaviors>
    <behavior name="web">
      <!--Him-->
      <webHttp automaticFormatSelectionEnabled="true" />
    </behavior>
  </endpointBehaviors> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-10T15:27:49.873

```
 See Complete config file
<configuration>   <system.web>
        <compilation debug="true" targetFramework="4.0" />
        <webServices>
          <protocols>
            <add name="HttpsGet"/>
            <add name="HttpsPost"/>
          </protocols>
        </webServices>   </system.web>   <system.serviceModel>
        <services>
          <service  name="RESTTEST.RestTestService" behaviorConfiguration="ServiceBehavior">

            <endpoint address="" binding="webHttpBinding" 
                      contract="RESTTEST.IRestTestService" 
                      bindingConfiguration="sslBinding"
                      behaviorConfiguration="web"
                      ></endpoint>
            <endpoint address="mex"
                  binding="mexHttpsBinding"
                  contract="IMetadataExchange" />
          </service>
        </services>
        <behaviors>
          <serviceBehaviors>
            <behavior name="ServiceBehavior">
              <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before
    deployment -->
              <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true"/>
              <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before
    deployment to avoid disclosing exception information -->
              <serviceDebug includeExceptionDetailInFaults="true"/>
            </behavior>
          </serviceBehaviors>
          <endpointBehaviors>
            <behavior name="web">
              <webHttp/>
            </behavior>
          </endpointBehaviors>
        </behaviors>
        <bindings>
          <webHttpBinding>
            <binding name="sslBinding" crossDomainScriptAccessEnabled="true">
              <security mode="Transport">
              </security>
            </binding>
          </webHttpBinding>    
          </bindings>
        <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="false">
        </serviceHostingEnvironment>
        <standardEndpoints>
          <webHttpEndpoint>
            <standardEndpoint crossDomainScriptAccessEnabled="true"></standardEndpoint>
          </webHttpEndpoint>
          <webScriptEndpoint>
            <standardEndpoint name="" crossDomainScriptAccessEnabled="true" />
          </webScriptEndpoint>
        </standardEndpoints>   </system.serviceModel>   <system.webServer>
        <modules runAllManagedModulesForAllRequests="true" />
        <httpProtocol>
          <customHeaders>
            <add name="Access-Control-Allow-Origin" value="*" />
            <add name="Access-Control-Allow-Headers" value="Content-Type" />
          </customHeaders>
        </httpProtocol>   </system.webServer> </configuration> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T21:01:02.407

由于 SSL 是 HTTP 下的协议，因此通常无需在 web.config 中配置任何额外内容（只有一个新绑定）。如果您使用 SSL，另一件会发生变化的事情是端口……您可能需要更新防火墙或检查您的请求是否发送到正确的端口。

# jquery - jQuery - $.data() - 从另一个函数访问时数据丢失 - 返回未定义

> ID：13829584
> 
> 赞同：1
> 
> 时间：2012-12-11T22:29:56.607
> 
> 标签：jquery

我正在尝试将 javascript 对象存储在列表元素中，这似乎工作正常，直到我尝试从另一个函数访问该数据。

这是我的 jsfiddle：http: [//jsfiddle.net/RaUxB/2/](http://jsfiddle.net/RaUxB/2/)

这是我的javascript：

```
var showData = function (li) {
    // get the stored data
    var d = $.data(li, 'testData');
    if (typeof(d) === 'undefined')
        alert ('showData() - data is undefined!');
    else
        alert ('showData() - number: [' + d.number+ '], text: [' + d.text + ']');
};

var doStuff = function () {
    $('#list').children().each(function(ix, item) {
        showData(item);
    });
};

$(document).ready(function() {
    // create a list item
    var li = $('<li>List Item 1 - Click Me!</li>').appendTo('#list');

    // store some data in it
    $.data(li, 'testData', {number:1, text:'test 1'});

    // show the data - this works!!!
    showData(li);

    // assign a click handler that will also show the data
    $(li).click(function() {
        showData(this); // this doesn't work!!!
    });
}); 
```

这是我的 HTML：

```
<ul id="list"></ul>
<p><a href="#" onclick="javascript:doStuff();return(false);">Try This Way</a></p> 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:31:39.540

`$.data`接受一个原始对象，而不是代表 DOM 元素的 jQuery 对象。

调用`$.data($(...))`将数据与该 jQuery 对象包装器相关联，而不是元素。

您应该使用`$(...).data()`，这将起作用。
或者，传递`elem[0]`to`$.data()`以在任何地方对原始 DOM 元素进行操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:36:56.520

这是因为当您最初调用 时`.showData(li)`，**LI**是`.data()`存储在其上的那个。

尝试将此添加到您的`.click()`活动中：

您应该将数据存储到 -this- 元素上。

```
$(li).click(function() {
    // store some data into THIS - now the correct .data will be stored
    $.data(this, 'testData', {number:1, text:'test 1'});
          // ^^

    showData(this); // this (now has data) and will work
}); 
```

[jsFiddle 演示](http://jsfiddle.net/Xtwru/1/)

# database - 如何使 Oracle 用逗号而不是制表符分隔结果？

> ID：13829585
> 
> 赞同：0
> 
> 时间：2012-12-11T22:30:01.373
> 
> 标签：database, oracle

我一直在寻找解决方案，但找不到直接的答案。

我希望我的 oracle select 语句根据逗号分隔列。所以，假设我有一个这样的查询：

从人员中选择 *

```
Results:
Name Age 
Bob  4
Sam  5
Joe  7 
```

我希望结果是：

```
Bob,4
Sam,5
Joe,7 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:37:22.477

使用串联 ||，并选择它们之间的逗号值。

```
SELECT NAME || ',' || AGE
FROM
(
    SELECT 'BOB' NAME, 4 AGE FROM DUAL
    UNION ALL
    SELECT 'SAM' NAME, 5 AGE FROM DUAL
    UNION ALL
    SELECT 'JOE' NAME, 7 AGE FROM DUAL
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T13:01:32.160

这是正确的查询：

```
SELECT NAME||','||AGE FROM PEOPLE; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T22:34:06.133

根据[AskTom](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3ap11_question_id:88212348059)：

```
ops$tkyte@8i> create or replace procedure dump_table_to_csv( p_tname in varchar2,
  2                                                 p_dir   in varchar2,
  3                                                 p_filename in varchar2 )
  4  is
  5      l_output        utl_file.file_type;
  6      l_theCursor     integer default dbms_sql.open_cursor;
  7      l_columnValue   varchar2(4000);
  8      l_status        integer;
  9      l_query         varchar2(1000)
 10                      default 'select * from ' || p_tname;
 11      l_colCnt        number := 0;
 12      l_separator     varchar2(1);
 13      l_descTbl       dbms_sql.desc_tab;
 14  begin
 15      l_output := utl_file.fopen( p_dir, p_filename, 'w' );
 16      execute immediate 'alter session set nls_date_format=''dd-mon-yyyy hh24:mi:ss'' 
';
 17  
 18      dbms_sql.parse(  l_theCursor,  l_query, dbms_sql.native );
 19      dbms_sql.describe_columns( l_theCursor, l_colCnt, l_descTbl );
 20  
 21      for i in 1 .. l_colCnt loop
 22          utl_file.put( l_output, l_separator || '"' || l_descTbl(i).col_name || '"' 
);
 23          dbms_sql.define_column( l_theCursor, i, l_columnValue, 4000 );
 24          l_separator := ',';
 25      end loop;
 26      utl_file.new_line( l_output );
 27  
 28      l_status := dbms_sql.execute(l_theCursor);
 29  
 30      while ( dbms_sql.fetch_rows(l_theCursor) > 0 ) loop
 31          l_separator := '';
 32          for i in 1 .. l_colCnt loop
 33              dbms_sql.column_value( l_theCursor, i, l_columnValue );
 34              utl_file.put( l_output, l_separator || l_columnValue );
 35              l_separator := ',';
 36          end loop;
 37          utl_file.new_line( l_output );
 38      end loop;
 39      dbms_sql.close_cursor(l_theCursor);
 40      utl_file.fclose( l_output );
 41  
 42      execute immediate 'alter session set nls_date_format=''dd-MON-yy'' ';
 43  exception
 44      when others then
 45          execute immediate 'alter session set nls_date_format=''dd-MON-yy'' ';
 46          raise;
 47  end;
 48  /

Procedure created.

ops$tkyte@8i> exec dump_table_to_csv( 'emp', '/tmp', 'tkyte.emp' ); 
```

# ruby-on-rails - Ruby \ Rubygems 他们如何决定加载哪些gem？

> ID：13829592
> 
> 赞同：1
> 
> 时间：2012-12-11T22:30:41.367
> 
> 标签：ruby-on-rails, ruby, rubygems

这是更多好奇的问题，而不是问题。当系统上存在多个版本时，使用命令时选择哪些版本`require`？故事的背景是：我正在`bundler`项目（不是Rails项目）中实现gem。我没有问题，但其他开发人员有问题，经过快速调查，我意识到我没有使用

```
require "bundler/setup" 
```

这基本上加载了捆绑的宝石。快速修复，但它让我想知道通过 ruby​​gems 的 ruby​​ 如何决定使用哪些宝石。由于 Ruby 应用程序使用了其中一个 gem 的旧版本，而不是新版本，因此代码损坏了。这意味着它不使用“最新”的宝石，那么它背后的逻辑是什么？

**更新**

为了进一步解释这个问题，假设你有宝石`foo-1.0.1`，`foo-1.0.2`当你说，`require 'foo'`红宝石如何知道要加载哪个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T15:01:48.520

在 Ruby 中，你`require`是一个*文件*而不是一个*gem*。如果在当前加载路径上找不到该文件，Rubygems 将在已安装的 gems 中搜索具有该名称的文件，如果找到，则 gem 被*激活*（意味着它被添加到 laod 路径）并且文件是然后需要。`lib`通常，gem 在其目录中会有一个同名的文件。只能激活一个版本的 gem。

*被激活的 gem是与任何其他已激活 gem 兼容*的最新版本。通常这只是意味着将激活安装的最新版本，但如果您已经激活了一些声明依赖于您尝试激活的早期版本的 gem 的 gem，则可能不是这种情况。

例如，如果您已经安装`foo-1.0.1`并`foo-1.0.2`安装了，那么`require 'foo'`（假设他们有一个`foo.rb`在其`lib`目录中命名的文件并且没有其他 gem）将导致版本 1.0.2 被激活。但是，如果您还有`bar`一个依赖于的 gem，则在激活之后`1.0.1`调用将导致 1.0.1 of被激活。`require 'foo'``bar``foo`

此外，如果您尝试以其他顺序要求它们，`require 'foo'; require 'bar';`那么您将得到类似

```
Gem::LoadError: Unable to activate bar-1, because foo-2 conflicts with foo (= 1) 
```

这里不能激活`bar`，这取决于 1.0.1 的版本，`foo`因为你已经激活了 1.0.2 的版本`foo`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:33:14.457

如果没有 Bundler，您必须指定所需的每个 gem。例如，

```
require 'my_gem'
require 'my_other_gem' 
```

* * *

但是，Bundler 可以让您使用`Gemfile`

如果这是你的`Gemfile`

```
gem 'my_gem'
gem 'my_other_gem' 
```

调用这将包括所有宝石

```
require 'bundler/setup' 
```

# mysql - 为什么我必须优化表？

> ID：13829595
> 
> 赞同：3
> 
> 时间：2012-12-11T22:30:50.070
> 
> 标签：mysql, database

我有一个相当大的表，其中包含大约 300 万条记录。当运行一个非常简单的查询时，将这个表连接到其他几个表（都带有索引和/或主键），查询大约需要 25 秒才能完成！“Handler_read_next”的价值约为700万！

> 按键顺序读取下一行的请求数，如果您正在查询具有范围约束的索引列或正在执行索引扫描，则会增加。

自从这张桌子开始变大以来，这个问题才开始出现。

现在，如果我对该表执行“优化表”，查询将在大约 0.02 秒内运行，“Handler_read_next”的值约为 1500。

差异怎么会如此极端，我真的需要设置一个预定的查询，每周优化一次这个表吗？尽管如此，我还是想知道这背后的含义以及mysql为什么会这样。当然，这个表中的行被删除和更新了很多，但是它是否应该在一周内变得如此严重，以至于查询从 0.02 秒变为 25 秒？

编辑：请求后，这里出现了有问题的查询：

```
SELECT *
FROM budget_expenses 
  JOIN budget_categories 
    ON  budget_categories.BudgetAreaId = budget_expenses.BudgetAreaId 
    AND budget_categories.BudgetCategoryId = budget_expenses.BudgetCategoryId
  LEFT JOIN budget_types 
    ON  budget_types.BudgetAreaId = budget_expenses.BudgetAreaId 
    AND budget_types.BudgetCategoryId = budget_expenses.BudgetCategoryId 
    AND budget_types.BudgetTypeId = budget_expenses.BudgetTypeId
WHERE budget_expenses.BudgetId = 1 
  AND budget_expenses.ExpenseDate >= '2012-11-25' 
  AND budget_expenses.ExpenseDate <= '2012-12-24' 
  AND budget_expenses.BudgetAreaId = 2 
ORDER BY budget_expenses.ExpenseDate DESC, 
         budget_expenses.ExpenseTime IS NULL ASC, 
         budget_expenses.ExpenseTime DESC 
```

`(BudgetAreaId, BudgetCategoryId)`是中的主键，`budget_categories`是`(BudgetAreaId, BudgetCategoryId, BudgetTypeId)`中的主键`budget_types`。在`budget_expenses`这 3 个键中是索引，也`ExpenseDate`有一个索引。此查询返回大约 20 行。

显示创建表：

```
CREATE TABLE `budget_areas` (
  `BudgetAreaId` int(11) NOT NULL,
  `Name` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`BudgetAreaId`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1

CREATE TABLE `budget_categories` (
  `BudgetAreaId` int(11) NOT NULL,
  `BudgetCategoryId` int(11) NOT NULL AUTO_INCREMENT,
  `Name` varchar(255) DEFAULT NULL,
  `SortOrder` int(11) DEFAULT NULL,
  PRIMARY KEY (`BudgetAreaId`,`BudgetCategoryId`),
  KEY `BudgetAreaId` (`BudgetAreaId`,`BudgetCategoryId`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1

CREATE TABLE `budget_types` (
  `BudgetAreaId` int(11) NOT NULL,
  `BudgetCategoryId` int(11) NOT NULL,
  `BudgetTypeId` int(11) NOT NULL,
  `Name` varchar(255) DEFAULT NULL,
  `SortId` int(11) DEFAULT NULL,
  PRIMARY KEY (`BudgetAreaId`,`BudgetCategoryId`,`BudgetTypeId`),
  KEY `BudgetAreaId` (`BudgetAreaId`,`BudgetCategoryId`,`BudgetTypeId`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1

 CREATE TABLE `budget_expenses` (
  `ExpenseId` int(11) NOT NULL AUTO_INCREMENT,
  `BudgetId` int(11) NOT NULL,
  `TempId` int(11) DEFAULT NULL,
  `BudgetAreaId` int(11) DEFAULT NULL,
  `BudgetCategoryId` int(11) DEFAULT NULL,
  `BudgetTypeId` int(11) DEFAULT NULL,
  `Company` varchar(255) DEFAULT NULL,
  `ImportCompany` varchar(255) DEFAULT NULL,
  `Sum` double(50,2) DEFAULT NULL,
  `ExpenseDate` date DEFAULT NULL,
  `ExpenseTime` time DEFAULT NULL,
  `Inserted` datetime DEFAULT NULL,
  `Changed` datetime DEFAULT NULL,
  `InsertType` int(1) DEFAULT NULL,
  `AccountId` int(11) DEFAULT NULL,
  `BankCardId` int(11) DEFAULT NULL,
  PRIMARY KEY (`ExpenseId`),
  KEY `BudgetId` (`BudgetId`),
  KEY `AccountId` (`AccountId`),
  KEY `Company` (`Company`) USING BTREE,
  KEY `ExpenseDate` (`ExpenseDate`),
  KEY `BudgetAreaId` (`BudgetAreaId`),
  KEY `BudgetCategoryId` (`BudgetCategoryId`),
  KEY `BudgetTypeId` (`BudgetTypeId`),
  CONSTRAINT `budget_expenses_ibfk_1` FOREIGN KEY (`BudgetId`) REFERENCES `budgets`    (`BudgetId`)
) ENGINE=InnoDB AUTO_INCREMENT=3604462 DEFAULT CHARSET=latin1 
```

复制粘贴后，我在budget_categories 表上从MyIsam 更改为Innodb。

编辑：从 myisam 到 innodb 的变化没有任何区别。查询现在非常慢，在我优化budget_expenses 表后仅12 小时！

这是查询的解释，现在大约需要 9 秒：

[http://jsfiddle.net/dmVPY/1/](http://jsfiddle.net/dmVPY/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T07:58:52.117

Ahhh MyISAM....

Try changing the table type (aka 'storage engine') to InnoDB instead.

If you do this, make sure innodb_buffer_pool_size in your my.cnf is [a sensible value](http://www.mysqlperformanceblog.com/2007/11/03/choosing-innodb_buffer_pool_size/) - the default is too small.

# php - PHP Trait 调用继承函数

> ID：13829598
> 
> 赞同：10
> 
> 时间：2012-12-11T22:31:08.220
> 
> 标签：php, inheritance, traits

我有一个特质

```
trait Foo{

    protected static function foo(){
        echo 'Hello';
    }
} 
```

和一堂课

```
class Bar{
    use Foo;

    private static function foo(){
        Foo::foo();

        echo ' World!';
    }
} 
```

我不能使用`Foo:foo()`. 我该怎么做才能达到预期的效果？

**编辑**

使用

```
use Foo {foo as parentFoo}

private static function foo(){

    self::parentFoo();

    echo ' World!';

} 
```

成功了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-11T22:49:06.607

你可以这样做：

```
class Bar{

    use Foo {
        Foo::foo as foofoo;
    }

    private static function foo(){

        self::foofoo();

        echo ' World!';

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:48:39.737

您是否允许将特征方法 foo 重命名为 fooo？

如果是，请在遵循静态调用语法之前在您的类方法主体中将 Foo::foo() 替换为 Foo::foo() （通过在特征函数定义中添加 static 关键字）

```
<?php

trait Foo 
{
    protected static function Fooo()
    {
        echo 'Hello';
    }
}

class Bar 
{
    use Foo;

    private static function foo() 
    {
        self::fooo();

        echo ' World!';
    }

    public static function expose() 
    {
        echo self::foo();
    }
}

echo Bar::expose(); 
```

编辑：

显然，我的问题的答案是“不，您不允许重命名特征方法”，对于这种情况，您已经指出了与 PHP 中嵌入的本机冲突解决相关的解决方案：http: [//php.net /manual/en/language.oop5.traits.php#language.oop5.traits.conflict](http://php.net/manual/en/language.oop5.traits.php#language.oop5.traits.conflict)

# iphone - 使用 Tiled For Iphone 更正地图设置

> ID：13829602
> 
> 赞同：0
> 
> 时间：2012-12-11T22:31:23.117
> 
> 标签：iphone, cocos2d-iphone

所以我正在使用平铺来为我的新 iPhone 游戏创建关卡。

在为 iphone 创建平铺地图时，正确的地图大小为 50x50，平铺大小为 32x32。

问题在于这些尺寸的瓷砖对于我需要的东西来说太小了。

所以我尝试将设置加倍以映射大小 100x100 和平铺大小 64x64 但没有运气..

任何熟悉这样做的人？

目标是我希望瓷砖更大并占用更多的屏幕空间。如果您没有正确设置，地图将无法正确显示在屏幕上，其中一半将被挂起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T09:41:28.280

有两件事需要考虑：你的瓦片大小必须与 Tiled 中的瓦片大小设置相匹配，否则它们将无法正确对齐。如果将图块大小加倍为 64x64，则还必须将图块集图像的大小加倍。

另一件事是屏幕上有多少瓷砖。如果你将 480 除以 64，你会得到 7.5，这意味着 7 个半瓷砖在水平方向上适合屏幕（假设横向模式）。如果这是您需要的，您必须确保平铺大小可被 iPad 上的 480x320 和 1024x768 或宽屏设备上的 568x320 清楚地整除。

# c# - 循环遍历只有一个位字段的按位枚举值

> ID：13829609
> 
> 赞同：1
> 
> 时间：2012-12-11T22:31:55.570
> 
> 标签：c#, reflection, enums

我在类似于以下的代码中定义了多个标志枚举

```
[Flags]
public enum Colors
{
   None = 0,
   Red = 1,
   Green = 2,
   Blue = 4, 
   Purple = Red | Blue,
   Brown = Red | Green,
} 
```

以下代码产生以下输出

```
Colors color1 = Colors.Red | Colors.Blue;
Colors color2 = Colors.Purple;
string s1 = color1.ToString(); // Sets s1 to "Purple"
string s2 = color2.ToString(); // Sets s2 to "Purple" 
```

我想要一种输出按位枚举的各个位的方法，即使定义了匹配的组合。

```
private void Foo()
{
  Colors color1 = Colors.Red | Colors.Blue;
  Colors color2 = Colors.Purple;
  string s1 = CreateColumnString(color1); // Sets s1 to "Red|Blue"
  string s2 = CreateColumnString(color2); // Sets s2 to "Red|Blue"
} 
```

我想我可以遍历枚举的所有值并检查该值是否是 2 的幂。但我不知道如何获得 Enum 参数的潜在价值。

```
private string CreateColumnString(object value)
{
 //is this an enum with Flags attribute?
 if (value is Enum  && value.GetType().GetCustomAttributes(typeof(FlagsAttribute), true).Length > 0)
 {
    Enum e = (Enum)value;
    //Get a list of Enum values set in this flags enum
    IEnumerable<Enum> setValues = 
      Enum.GetValues(value.GetType())
          .Cast<Enum>()
          .Where(eachEnum => IsPowerOfTwo(eachEnum) && value.HasFlag(eachEnum)); 

    return string.Join("|", setValues);
 }
 else
 {
    return value != null ? value.ToString() : string.Empty;
 }
 return str;
}

private static bool IsPowerOfTwo(Enum e)
{
   int x = (int)e; //ERROR cannot convert type 'System.Enum' to 'ulong'
   return (x != 0) && ((x & (x - 1)) == 0);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T23:05:06.757

可能有更好的方法可以做到这一点，但这应该可以满足您的需求：

```
private static string AsString<T>(this T values)
{
    Enum v = (Enum)Convert.ChangeType(values, typeof(Enum));
    Array array = Enum.GetValues(typeof(T));
    IEnumerable<Enum> setFlags = array
        .Cast<Enum>()
        .Where(c => v.HasFlag(c) && IsDistinctValue(c));

    return values.Equals(default(T))
        ? default(T).ToString()
        : string.Join("|", setFlags.Where(c => Convert.ToInt32(c) != 0).Select(c => c.ToString()));
}

private static bool IsDistinctValue(Enum value)
{
    int current = Convert.ToInt32(value) >> 1;
    while (current > 0)
    {
        if ((Convert.ToInt32(value) & current) != 0)
        {
            return false;
        }
        current >>= 1;
    }

    return true;
} 
```

它将基本上列出设置标志的值，除了那些“包含”其他标志的值。它通过获取正在测试的值，将其递减到零并检查原始值是否将该递减值设置为标志来计算出这一点。最后，它将删除“ `None`”值，除非没有设置标志。

像这样使用它：

```
Colors c = Colors.Purple;
Console.WriteLine(c.AsString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:37:48.267

您可以使用以下[`HasFlag`方法](http://msdn.microsoft.com/en-us/library/system.enum.hasflag.aspx)：

```
.Where(e.HasFlag) 
```

但是，我认为您的`Enum.GetValues`调用还将获得您的枚举类型名称的多位值。

编辑：

这是您可能开始工作的另一种方法：

```
if (Enum.GetUnderlyingType(e.GetType()) != typeof(int))
  throw new NotImplementedException();

var list = new List<Enum>();
for (int i = 1; i != 0; i <<= 1)
{
  var eachEnum = (Enum)(Enum.ToObject(e.GetType(), i));
  if (e.HasFlag(eachEnum))
    list.Add(eachEnum);
}

return string.Join(" | ", list); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T23:54:08.777

这是另一种方法。我认为您拥有的选择越多越好:)

```
public static class EnumHelpers
{
    public static string ToStringExtended<T>(this Enum e)
    {
        if (!(e.GetType().GetCustomAttributes(typeof(FlagsAttribute), true).Length > 0))
            return e.ToString();

        List<string> eNames = new List<string>();
        foreach (T fish in Enum.GetValues(typeof(T)))
        {
            Enum num = fish as Enum;
            if (e.HasFlag(num) && Convert.ToInt32(fish) != 0 && Convert.ToInt32(fish) != Convert.ToInt32(e))
                eNames.Add(fish.ToString());
        }

        return eNames.Count > 1 ? String.Join("|", eNames.ToArray()) : e.ToString();
    }
} 
```

用法几乎与 Fredirk 提出的相同：

```
Colors c = Colors.Purple;
Console.WriteLine(c.ToStringExtended<Colors>());
// Output : Red|Blue 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-22T22:00:58.067

不计算方法签名的 4 行代码的答案。

```
 private static string CreateColumnString(Colors value)
    {
        // This is how we do it in embedded programming in C
        // In C we wouldn't need to convert, but alas in C# we do
        // So first ... 
        var num = Convert.ToByte(value);  
        // ToUint16 would work as well, but ToByte makes your intentions clearer

        // Then bitwise '& 'every bit position you care about to compose your string
        // For example: 0b0011 & 0b1111 = 0b0011    (3 AND 15 = 3)
        var s = (num & 1) > 0 ? "Red"   : "";
        s = (num & 2) > 0 ? s + "|Green": s;
        return (num & 2) > 0 ? s + "|Blue" : s;
    } 
```

# node.js - 在 nodejs 中使用回调，promise

> ID：13829612
> 
> 赞同：2
> 
> 时间：2012-12-11T22:32:14.677
> 
> 标签：node.js, callback

嗨stackoverflow社区，我正在尝试理解nodejs中的异步编码，特别是我试图在拨打电话后将结果传回主函数

我环顾四周，发现这可以通过使用来完成

1.  回调
2.  承诺（据我所知，承诺已从 nodejs 中删除，因此需要使用 NPM 包添加库）

无论如何回到主要问题，我已经厌倦了实现回调方法，但我做错了。请帮忙

下面的代码是我为回调尝试的一些示例，但外部结果从未运行。基本上我希望将计算结果返回给 r。

```
function calc (n1, n2 , r){

    r = n1 + n2;
    console.log("inside result %s",r);
}

calc(1,2,function(r){
    console.log("outside result %s",r);}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T08:52:15.943

只是上一个答案的变体，显示了回调效果：

```
function calc (n1, n2 , result){
    var r = n1 + n2;
    console.log("The first result is %s, ",r);
    console.log("but for the final one we have to wait 2 seconds ...");
    setTimeout(function() { //waits 2 seconds
        r = r * r;
        console.log('Done!');
        result(r);
    }, 2000);
}

calc(1,2,function(num){
    console.log("The final result is %s",num);
});
console.log('... waiting, waiting ...'); //this shows up AFTER the first result but BEFORE the final one 
```

问候。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-12T23:46:40.523

核心 nodeJS 库中不使用 Promise。Promise 与回调一起被考虑，但由于没有达成共识，回调被选为更容易理解和更少开销。（当我第一次学习回调时，回调绝非易事）

在 nodeJS 中，一般的做法是回调函数以 an`err`作为第一个参数，然后返回值。上面的`calc`函数应该是这样的

```
function calc(a, b, callback) {
  if (tired)
    callback("Too tired to think.");   // error return
  else
    callback(null, a + b);             // success, note the null
} 
```

调用它

```
calc(1, 2, function(err, sum) {
  if (err)
     console.error(err);
  else
     console.log("Sum is " + sum);
}); 
```

请注意，`function(err, sum)`它作为`callback`参数传递给`calc`. 要检查是否发生错误，只需执行 即可`if (err)`，否则成功。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T22:33:46.127

```
r = n1 + n2; 
```

这会为参数分配一个新值`r`。

您要调用该函数：

```
r(n1 + n2); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-19T07:11:06.387

让我分享一下我在 Oodles Technologies 工作时学到的东西。让我们举个例子。

假设有四个函数**functionCall**，**doSomeworkOne**，**doSomeworkTwo**，**doSomeworkTwo**，它们正在执行一些 IO 任务。

函数doSomeworkThree functionCall 依赖doSomeworkOne，doSomeworkOne 依赖doSomeworkTwo，doSomeworkTwo 依赖doSomeworkThree。为了使这些同步，回调函数在所有函数中作为参数传递。

```
function functionCall(data, callback){
    ...........
    ...........
    doSomeworkOne(data, callback);
}

function doSomeworkOne(data, callback){
    ...........
    ...........
    doSomeworkTwo(otherData, callback);        
}

function doSomeworkTwo(otherData, callback){
    ...........
    ...........
    doSomeworkThree(otherData, callback);
}

<span style="font-size:16px;"><span style="font-family:arial,helvetica,sans-serif;"> function doSomeworkThree(otherData, callback){
    ...........
    ...........
    callback(result);
}
</span></span>

function callback(data){
    return data
} 
```

**另一方面，**回调很好。**回调的主要问题是：嵌套在回调内部，嵌套在回调内部。在嵌套回调中，测试/维护代码非常困难。**

 **承诺来了。Promise 为我们提供了一种更简洁、更健壮的异步代码处理方式。而不是使用回调。并且使用 Promise 处理错误也非常容易。

```
function functionCall(data){
    doSomeworkOne(data).then(function(data){
        return doSomeworkTwo(data);
    }).then(function(data){
        return     doSomeworkThree(data);
    }).catch(function(e) {
        // error handle    
    });
}

function doSomeworkOne(data){
    retrun new Promise(function(resolve, reject){
        ...........
        ...........
        if(error){
            reject(error);        
        }else{
            resolve(success);
        }
    })        
}

function doSomeworkTwo(data){
    retrun new Promise(function(resolve, reject){
        ...........
        ...........
        if(error){
            reject(error);        
        }else{
            resolve(success);
        }
    })        
}

function doSomeworkThree(data){
    retrun new Promise(function(resolve, reject){
        ...........
        ...........
        if(error){
            reject(error);        
        }else{
            resolve(success);
        }
    })        
} 
```

**注意：** Promise 和 Callbacks 没有根本的不同。在您想要执行一系列操作的嵌套回调中建议使用 Promise。我希望这能帮到您。谢谢。**

# visual-studio-2010 - 我正在尝试使用使用 FormatWith() 的函数，但在 C# 中出现错误

> ID：13829613
> 
> 赞同：0
> 
> 时间：2012-12-11T22:32:26.160
> 
> 标签：visual-studio-2010, c#-4.0

我正在尝试构建一个电子邮件模板。我得到了假设的工作示例，但我在尝试让 FormatWith() 解决其中一个函数时遇到问题。

```
private static string PrepareMailBodyWith(string templateName, params string[] pairs)
{
    string body = GetMailBodyOfTemplate(templateName);

    for (var i = 0; i < pairs.Length; i += 2)
    {
        // wonder if I can bypass Format with and just use String.Format
        body = body.Replace("<%={0}%>".FormatWith(pairs[i]), pairs[i + 1]);
        //body = body.Replace("<%={0}%>",String.Format(pairs[i]), pairs[i + 1]);
    }
    return body;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:44:41.900

对我来说，它看起来像是一种[扩展方法](http://msdn.microsoft.com/en-us/library/vstudio/bb383977.aspx)。

您需要引用扩展方法位于文件顶部的命名空间。

例子：

```
namespace MyApp.ExtensionMethods
{
    public class MyExtensions
    {    
        public static string FormatWith(this string target, params object[] args) 
        { 
            return string.Format(Constants.CurrentCulture, target, args); 
        }    
    }
} 
```

...

```
using MyApp.ExtensionMethods;

...

private static string PrepareMailBodyWith(string templateName, params string[] pairs)
{
    string body = GetMailBodyOfTemplate(templateName);

    for (var i = 0; i < pairs.Length; i += 2)
    {
        // wonder if I can bypass Format with and just use String.Format
        body = body.Replace("<%={0}%>".FormatWith(pairs[i]), pairs[i + 1]);
        //body = body.Replace("<%={0}%>",String.Format(pairs[i]), pairs[i + 1]);
    }
    return body;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T14:05:12.743

我发现使用 .Replace() 然后跳过所有其他的箍更容易。谢谢你的建议。

```
 string email = emailTemplate
        .Replace("##USERNAME##", userName)
        .Replace("##MYNAME##", myName); 
```

这似乎是我的电子邮件模板问题的最简单解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T22:54:39.443

Try using `String.Format()` instead, like you suggested...

```
body = body.Replace(String.Format("<%={0}%>", pairs[i]), String.Format("<%={0}%>", pairs[i+1]); 
```

This assumes you want both the search string and the replacement string to be formatted.

# javascript - 动态扩展隐藏溢出的元素

> ID：13829614
> 
> 赞同：1
> 
> 时间：2012-12-11T22:32:38.377
> 
> 标签：javascript, html, css, overflow

我有一个带有 的元素`overflow: hidden`，我想在单击时展开它。

这就是我到目前为止所拥有的。

[http://jsfiddle.net/up6bW/2/](http://jsfiddle.net/up6bW/2/)

它确实扩展了元素，但不像它应该的那样。它不应该将元素推到它下面，而是重叠并隐藏它。我可以通过使用来部分完成这项工作`position: absolute`，但这会使下一个元素折叠到顶部。

这可以通过仅在单击的元素上使用 CSS 来完成吗？其他元素不应调整。
或者，如果是，则应使用 JavaScript 自动计算。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:49:15.420

这是您可能需要的示例：http: [//jsfiddle.net/up6bW/39/](http://jsfiddle.net/up6bW/39/)

我所做的只是在您的下拉 Div 上设置 position:absolute ，然后在其他 div 中的第一个在顶部填充以补偿绝对定位造成的空间损失：

首先，您可以稍微更改第二个 div 以添加一个类：

```
<div class="a" onclick="z(this)">click here click here click here click here click here</div>
<div class="second">1234567890</div>
<div>1234567890</div>
<div>1234567890</div>
<div>1234567890</div>
<div>1234567890</div> 
```

​ 然后把 CSS 改成这样：

```
body {
    margin: 10px;
}

div {
    width: 150px;
    font-family: sans-serif;
    font-size: 16px;
    line-height: 20px;
    margin-bottom: 10px;
    word-break: break-all;
}

div.a {
    cursor: pointer;
    color: tomato;
    height: 20px;
    overflow: hidden;
    position:absolute;
}
.second{
    padding:25px 0px 0px 0px;       
}​ 
```

您要扩展的 div 将具有绝对定位，然后第二个 div 将有足够的填充来弥补第一个 div。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T23:11:35.430

另一种解决方案还可能涉及将 div 包装在容器中，如下所示：

HTML：

```
<div class="container">
    <div class="a" onclick="z(this)">
        click here click here click here click here click here
    </div>
</div>
<div>1234567890</div>
<div>1234567890</div>
<div>1234567890</div>
<div>1234567890</div>
<div>1234567890</div> 
```

CSS：

```
body { margin: 10px; }

div { font-family: sans-serif; font-size: 16px; line-height: 20px; margin-bottom: 10px; width: 150px; word-break: break-all; }

div.a { color: tomato; cursor: pointer; height: 20px; overflow: hidden; }
.container { height: 20px; overflow: visible; } 
```

JS：

```
function z (a) {
    a.style.cssText = a.style.border ? "" : "\
        background: #fff;\
        border: 1px solid #ccc;\
        height: auto;\
        margin-left: -5px;\
        margin-top: -5px;\
        padding: 4px;\
        position: absolute;\
        ";
}; 
```

[在这里演示](http://jsfiddle.net/retaF/8/)

显然，出于演示原因添加 HTML 元素并不理想，但我认为它比 JavaScript 替代方案更好。

在 IE7+、Chrome 和 Firefox 中测试

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T22:37:46.397

将元素放在一起**需要**绝对定位。您可以`padding-top`在第一个元素上放置一些以补偿重叠的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-12T02:30:10.470

我正在使用这个解决方案，它会自动将填充添加到下一个元素。

[http://jsfiddle.net/up6bW/47/](http://jsfiddle.net/up6bW/47/)

HTML

```
<div class="a" onclick="z(this)">click here click here click here</div>
<div>1234567890</div>
<div>1234567890</div>
<div>1234567890</div>
<div class="a" onclick="z(this)">click here click here click here</div>
<div>1234567890</div>
<div>1234567890</div>
<div>1234567890</div>
<div class="a" onclick="z(this)">click here click here click here</div> 
```

CSS

```
div {
    font-family: sans-serif;
    font-size: 16px;
    line-height: 20px;
    width: 150px;
    word-break: break-all;
}

div.a {
    color: tomato;
    cursor: pointer;
    height: 20px;
    overflow: hidden;
} 
```

JavaScript

```
function z (a) {

    // nextElementSibling equivalent
    var b = a.nextSibling;
    while (b && b.nodeType != 1)
        b = b.nextSibling;

    if (b)
        b.style.cssText = b.style.paddingTop ? "" : "padding-top: " + a.clientHeight + "px";

    a.style.cssText = a.style.border ? "" : "\
        background: #fff;\
        border: 1px solid #ccc;\
        height: auto;\
        margin-left: -5px;\
        margin-top: -5px;\
        padding: 4px;\
        position: absolute;\
        ";

}; 
```

# c# - BindingSource 与 DataGridView 组合框

> ID：13829621
> 
> 赞同：4
> 
> 时间：2012-12-11T22:33:22.833
> 
> 标签：c#, winforms

我知道您可以将`BindingSource`对象与 DataGridView 一起使用。

是否可以在其中一列中有一个组合框并仍然利用`BindingSource`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-11T22:39:14.973

是的，它是 - 看看[C# 中带有 DataGridView 的 ComboBox](http://khanrahim.wordpress.com/2010/04/13/combobox-with-datagridview-in-c/)：

> 将 ComboBox 与 DataGridView 结合使用不再那么复杂，但在进行一些数据驱动的软件开发时几乎是必须的。
> 
> ![在此处输入图像描述](../Images/0451f6e7336e700ca3e1b700ccd9c7e1.png)
> 
> 我已经创建了一个像这样的 DataGridView。现在，我想在 DataGridView 中显示“Month”和“Item”而不是“MonthID”和“ItemID”。

本质上，本文描述的是将组合框与单独的绑定源绑定——在本例中，是一个验证表，存储位置`MonthID`和`MonthName`存储位置，月份名称基于原始数据中的 id 显示。

在这里，他设置了 Month 数据源，从月份表中进行选择，然后`BindingSource`从返回的数据中创建一个。

```
//Month Data Source
string selectQueryStringMonth = "SELECT MonthID,MonthText FROM Table_Month";
SqlDataAdapter sqlDataAdapterMonth = new SqlDataAdapter(selectQueryStringMonth, sqlConnection);
SqlCommandBuilder sqlCommandBuilderMonth = new SqlCommandBuilder(sqlDataAdapterMonth);
DataTable dataTableMonth= new DataTable();
sqlDataAdapterMonth.Fill(dataTableMonth);
BindingSource bindingSourceMonth = new BindingSource();
bindingSourceMonth.DataSource = dataTableMonth; 
```

然后他将月份 ComboBoxColumn 添加到 DataGridView，使用上面创建`DataSource`的`BindingSource`：

```
//Adding  Month Combo
DataGridViewComboBoxColumn ColumnMonth = new DataGridViewComboBoxColumn();
ColumnMonth.DataPropertyName = "MonthID";
ColumnMonth.HeaderText = "Month";
ColumnMonth.Width = 120;
ColumnMonth.DataSource = bindingSourceMonth;
ColumnMonth.ValueMember = "MonthID";
ColumnMonth.DisplayMember = "MonthText";
dataGridViewComboTrial.Columns.Add(ColumnMonth); 
```

最后，他将 绑定`DataGridView`到原始数​​据。

# reporting-services - 查找功能有效，直到部署

> ID：13829624
> 
> 赞同：2
> 
> 时间：2012-12-11T22:33:33.277
> 
> 标签：reporting-services, ssrs-2008

我正在使用 Visual Studio Reporting Services 2008，但遇到了一个恼人的问题。我在表格中有一个单元格，它使用一个数据集中的查找来查找要在另一个数据集中显示的信息。代码如下：

```
=Lookup(Fields!place_id.Value,
        Fields!id.Value,
        Fields!name.Value,
        "Centres") 
```

和来自一个数据集（Dataset1），另一个来自数据集“Centres” `place_id`。`id`这在预览中可以正常工作，但在部署之后就不行了。当我尝试部署时，我收到一条错误消息（其中 textbox22 是有问题的单元格）：

> 文本框“Textbox22”的值表达式引用字段“名称”。报表项表达式只能引用当前数据集范围内的字段，或者如果在聚合内，则只能引用指定的数据集范围。

当然，通过在表达式中有“中心”，这*就是*指定的范围。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T03:53:42.350

根据您共享的信息，我可以说您的 SSRS 开发版本是 SSRS2008R2，您的报表服务器版本是 SSRS2008。由于SSRS2008 及更低版本不支持**Lookup 功能。**这就是您在部署中遇到此错误而预览工作正常的原因。

有关查找函数的任何其他信息，您可以查看[查找函数](http://www.bi-rootdata.com/2012/10/lookup-function-in-ssrs.html)

# ruby - 使用 `+=` 和 `send` 方法

> ID：13829636
> 
> 赞同：5
> 
> 时间：2012-12-11T22:34:23.493
> 
> 标签：ruby, send

如何使用`send`with `+=`？

```
a = 20; a.send "+=", 10
undefined method `+=' for 20:Fixnum

a = 20; a += 10
=> 30 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-11T22:39:45.250

恐怕你不能。`+=`不是方法，而是语法糖。

见[http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_expressions.html](http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_expressions.html)

它说

> 与许多其他语言一样，Ruby 有一个语法快捷方式：a=a+2 可以写成 a+=2。

你能做的最好的事情是：

```
>> a = 20
=> 20
>> a = a.send "+", 10
=> 30
>> a
=> 30 
```

# python - Matplotlib：是否可以在不创建子图的情况下创建具有给定 y 偏移的新轴？

> ID：13829637
> 
> 赞同：4
> 
> 时间：2012-12-11T22:34:27.143
> 
> 标签：python, matplotlib, axis, sankey-diagram

借助 Matplotlib 中的sankey **-** **toolbox**，我们可以自动绘制 sankey-diagrams： sankey-object 的位置是根据其先验对象的位置自动计算的，不能手动给出；并且当一个 sankey-diagram 被初始化时，第一个 sankey-object 的位置将被分配一个轴的输入。（（0,0）点将是该对象的中心点）

 **情况如下：我想绘制两个具有给定 y 偏移的 sankey 图，并且应该连接两个图的几个端口。因此，需要在同一个子图中具有 y 偏移的两个坐标系。我已经尝试了“ **add_axes** ”方法，但是使用这种方法会创建一个新的子图，并且会出现图形缩放问题。

现在的问题是：是否可以在不创建子图的情况下创建具有给定 y 偏移的新坐标系？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T09:12:45.837

不是一个完整的答案，但它可能会帮助您找到解决方案： `sankey.add()`支持`transform`关键字参数。根据您的图形，创建一个新`transform`实例，并将其用于图形的移动部分：

```
offset = transforms.ScaledTranslation(0.0, 0.5, fig.dpi_scale_trans)
new_transform = ax.transData + offset
sankey.add(flows=[-0.25, 0.15, 0.1], fc='#37c959', label='two',
           orientations=[-1, -1, -1], prior=0, connect=(0, 0),
           transform = new_transform) 
```

为了创建新的变换，辅助函数`matplotlib.transforms.offset_copy()`也可能有用：

```
new_transform = offset_copy(ax.transData, fig=fig,
                            x = 0.05, y=0.10, units='inches') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T15:52:35.537

问题解决了。我编写了**Affine2DBase** -class 的子类来根据给定的变换对象（例如**ax.transData**对象）进行坐标转换。它适用于我的程序......希望对其他人有所帮助。

```
class coordinateTranslation(Affine2DBase):
    def __init__(self, dx, dy, transform, **kwargs):
        Affine2DBase.__init__(self,**kwargs)
        self._dx = dx
        self._dy = dy
        self._transform = transform
        self._mtx = None
        self._inverted = None
    def __repr__(self):
        return "coordinateTranslation(%r, %r)" % (self._dx, self._dy)
    def get_matrix(self):
        dx, dy = self._transform.transform((self._dx, self._dy))
        dx_zero, dy_zero = self._transform.transform((0, 0))
        dx -= dx_zero; dy -= dy_zero
        self._mtx = np.array([[1.0, 0.0, dx],
                              [0.0, 1.0, dy],
                              [0.0, 0.0, 1.0]], np.float_)
        self._inverted = None
        return self._mtx
    get_matrix.__doc__ = Affine2DBase.get_matrix.__doc__ 
```**

# objective-c - Tapku 日历不显示

> ID：13829640
> 
> 赞同：3
> 
> 时间：2012-12-11T22:34:39.090
> 
> 标签：objective-c, ios6, tapku

我已经使用以下步骤将 Tapku 日历库安装到我的项目中：[Tapku 日历演示在 xCode4/iOS5 中不起作用](https://stackoverflow.com/questions/8190516/tapku-calendar-demo-does-not-work-in-xcode4-ios5)

太好了，它进口得很好。没有错误，什么都没有。但是日历并没有出现，即使是那些它运行的`loadView`功能。出现切换按钮[尽管在这种情况下我没有使用它们进行切换]。

***这是重要的注意事项：***

此代码（来自实现）：

```
NSLog(@"Toggle called!");

// If calendar is off the screen, show it, else hide it (both with animations)
NSLog(@"y and x = %f & %f", _calendar2.frame.origin.y, _calendar2.frame.origin.x);

NSLog(@"height and width = %f & %f", _calendar2.frame.size.height, _calendar2.frame.size.width); 
```

正在产生：

```
2012-12-11 17:16:46.294 MyApp[29078:c07] Toggle called!
2012-12-11 17:16:46.295 MyApp[29078:c07] y and x = 0.000000 & 0.000000
2012-12-11 17:16:46.295 MyApp[29078:c07] height and width = 0.000000 & 0.000000 
```

请注意 y 和 x 是如何为零的，即使我已将它们设置为 1。就像 _calender2 不保存任何东西一样？

***这是课程：***

**日历控件视图.h：**

```
#import <UIKit/UIKit.h>
#import "TKCalendarMonthView.h"

@interface CalendarViewController : UIViewController <TKCalendarMonthViewDelegate,TKCalendarMonthViewDataSource> {
    TKCalendarMonthView *calendar;
    struct CGRect cframe;
}

@property(strong, nonatomic) TKCalendarMonthView *calendar2;

@end 
```

**日历控件视图.m**

```
#import "CalendarViewController.h"

@implementation CalendarViewController

static int calendarShadowOffset = (int)-20;

@synthesize calendar2 = _calendar2;

#pragma mark -
#pragma mark View Lifecycle

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization.
        _calendar2 =    [[TKCalendarMonthView alloc] init];
        _calendar2.delegate = self;
        _calendar2.dataSource = self;
    }
    return self;
}

- (void)loadView {
    // Costruct the view because we aren't using a

    //int statusBarHeight = 20;
    CGRect applicationFrame = (CGRect)[[UIScreen mainScreen] applicationFrame];
    self.view = [[UIView alloc] initWithFrame:CGRectMake(0, 0, applicationFrame.size.width, applicationFrame.size.height)];
    //self.view.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
    self.view.backgroundColor = [UIColor grayColor];

    // Add top left menu button to toggle calendar

    UIImage *menuButtonImage = [UIImage imageNamed:@"btn-calendar.png"];
    UIImage *menuButtonImageHighlighted = [UIImage imageNamed:@"btn-calendar-highlighted.png"];
    UIButton *menuButton = [UIButton buttonWithType:UIButtonTypeCustom];
    [menuButton setImage:menuButtonImage forState:UIControlStateNormal];
    [menuButton setImage:menuButtonImageHighlighted forState:UIControlStateHighlighted];
    menuButton.frame = CGRectMake(0, 0, menuButtonImage.size.width, menuButtonImage.size.height);
    UIBarButtonItem *menuBarButton = [[UIBarButtonItem alloc] initWithCustomView:menuButton];
    [menuButton addTarget:self action:@selector(toggleCalendar) forControlEvents:UIControlEventTouchUpInside];
    self.navigationItem.leftBarButtonItem = menuBarButton;

    //[menuBarButton release];

    // Add view button to toggle calendar
    UIButton *toggleButton = [[UIButton alloc] initWithFrame:CGRectMake(50, 300, 220, 50)];
    toggleButton.backgroundColor = [UIColor darkGrayColor];
    toggleButton.titleLabel.font = [UIFont systemFontOfSize:12];
    toggleButton.titleLabel.textColor = [UIColor whiteColor];
    [toggleButton setTitle:@"Toggle Calendar" forState:UIControlStateNormal];
    [toggleButton addTarget:self action:@selector(toggleCalendar) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:toggleButton];
    //[toggleButton release];

    UIButton *toggleButton2 = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, 220, 50)];
    toggleButton2.backgroundColor = [UIColor darkGrayColor];
    toggleButton2.titleLabel.font = [UIFont systemFontOfSize:12];
    toggleButton2.titleLabel.textColor = [UIColor whiteColor];
    [toggleButton2 setTitle:@"Toggle Calendar2" forState:UIControlStateNormal];
    [toggleButton2 addTarget:self action:@selector(toggleCalendar) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:toggleButton2];

    cframe = CGRectMake(1, 1, _calendar2.frame.size.width, _calendar2.frame.size.height);

    // Add Calendar to just off the top of the screen so it can later slide down
    _calendar2.frame = cframe;
    // Ensure this is the last "addSubview" because the calendar must be the top most view layer
    [self.view addSubview:_calendar2];
    [_calendar2 reload];
    [_calendar2 setHidden:NO];
    _calendar2.alpha = 1.0;
    NSLog(@"Done getting calender there!");

}

- (void)viewDidLoad {
    [super viewDidLoad];
}

// Show/Hide the calendar by sliding it down/up from the top of the device.
- (void)toggleCalendar {

    NSLog(@"Toggle called!");

    // If calendar is off the screen, show it, else hide it (both with animations)
    NSLog(@"y and x = %f & %f", _calendar2.frame.origin.y, _calendar2.frame.origin.x);

    NSLog(@"height and width = %f & %f", _calendar2.frame.size.height, _calendar2.frame.size.width);

}

#pragma mark -
#pragma mark TKCalendarMonthViewDelegate methods

- (void)calendarMonthView:(TKCalendarMonthView *)monthView didSelectDate:(NSDate *)d {
    NSLog(@"calendarMonthView didSelectDate");
}

- (void)calendarMonthView:(TKCalendarMonthView *)monthView monthDidChange:(NSDate *)d {
    NSLog(@"calendarMonthView monthDidChange");
}

#pragma mark -
#pragma mark TKCalendarMonthViewDataSource methods

- (NSArray*)calendarMonthView:(TKCalendarMonthView *)monthView marksFromDate:(NSDate *)startDate toDate:(NSDate *)lastDate {
    NSLog(@"calendarMonthView marksFromDate toDate");
    NSLog(@"Make sure to update 'data' variable to pull from CoreData, website, User Defaults, or some other source.");
    // When testing initially you will have to update the dates in this array so they are visible at the
    // time frame you are testing the code.
    NSArray *data = [NSArray arrayWithObjects:
                     @"2011-01-01 00:00:00 +0000", @"2011-01-09 00:00:00 +0000", @"2011-01-22 00:00:00 +0000",
                     @"2011-01-10 00:00:00 +0000", @"2011-01-11 00:00:00 +0000", @"2011-01-12 00:00:00 +0000",
                     @"2011-01-15 00:00:00 +0000", @"2011-01-28 00:00:00 +0000", @"2011-01-04 00:00:00 +0000",
                     @"2011-01-16 00:00:00 +0000", @"2011-01-18 00:00:00 +0000", @"2011-01-19 00:00:00 +0000",
                     @"2011-01-23 00:00:00 +0000", @"2011-01-24 00:00:00 +0000", @"2011-01-25 00:00:00 +0000",
                     @"2011-02-01 00:00:00 +0000", @"2011-03-01 00:00:00 +0000", @"2011-04-01 00:00:00 +0000",
                     @"2011-05-01 00:00:00 +0000", @"2011-06-01 00:00:00 +0000", @"2011-07-01 00:00:00 +0000",
                     @"2011-08-01 00:00:00 +0000", @"2011-09-01 00:00:00 +0000", @"2011-10-01 00:00:00 +0000",
                     @"2011-11-01 00:00:00 +0000", @"2011-12-01 00:00:00 +0000", nil];

    // Initialise empty marks array, this will be populated with TRUE/FALSE in order for each day a marker should be placed on.
    NSMutableArray *marks = [NSMutableArray array];

    // Initialise calendar to current type and set the timezone to never have daylight saving
    NSCalendar *cal = [NSCalendar currentCalendar];
    [cal setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0]];

    // Construct DateComponents based on startDate so the iterating date can be created.
    // Its massively important to do this assigning via the NSCalendar and NSDateComponents because of daylight saving has been removed
    // with the timezone that was set above. If you just used "startDate" directly (ie, NSDate *date = startDate;) as the first
    // iterating date then times would go up and down based on daylight savings.
    NSDateComponents *comp = [cal components:(NSMonthCalendarUnit | NSMinuteCalendarUnit | NSYearCalendarUnit |
                                              NSDayCalendarUnit | NSWeekdayCalendarUnit | NSHourCalendarUnit | NSSecondCalendarUnit)
                                    fromDate:startDate];
    NSDate *d = [cal dateFromComponents:comp];

    // Init offset components to increment days in the loop by one each time
    NSDateComponents *offsetComponents = [[NSDateComponents alloc] init];
    [offsetComponents setDay:1];

    // for each date between start date and end date check if they exist in the data array
    while (YES) {
        // Is the date beyond the last date? If so, exit the loop.
        // NSOrderedDescending = the left value is greater than the right
        if ([d compare:lastDate] == NSOrderedDescending) {
            break;
        }

        // If the date is in the data array, add it to the marks array, else don't
        if ([data containsObject:[d description]]) {
            [marks addObject:[NSNumber numberWithBool:YES]];
        } else {
            [marks addObject:[NSNumber numberWithBool:NO]];
        }

        // Increment day using offset components (ie, 1 day in this instance)
        d = [cal dateByAddingComponents:offsetComponents toDate:d options:0];
    }

    //[offsetComponents release];

    return [NSArray arrayWithArray:marks];
}

#pragma mark -
#pragma mark Memory Management

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
}

- (void)viewDidUnload {
    [super viewDidUnload];
}

- (void)dealloc {
    //[super dealloc];
}

@end 
```

我正在运行 XCode 4.5.2 和 iOS6

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T21:08:33.990

移动行：

```
 _calendar2 =    [[TKCalendarMonthView alloc] init];
    _calendar2.delegate = self;
    _calendar2.dataSource = self; 
```

从`initWithNib...`到开头`loadView`，然后将日历视图添加到控制器的视图中：

```
- (void)loadView {

    [super loadView];

    // Costruct the view because we aren't using a xib file

    _calendar2 =    [[TKCalendarMonthView alloc] init];
    _calendar2.delegate = self;
    _calendar2.dataSource = self;

   [self.view addSubview:_calendar2];

   // rest of the method unchanged.... 
```

确实，由于您没有使用笔尖，`initWithNib...`因此不会调用；`loadView`然后负责创建视图。

# ios - 我可以使用 CMake 为 XCode (OCUnit) 创建 iOS 单元测试目标吗？

> ID：13829642
> 
> 赞同：3
> 
> 时间：2012-12-11T22:34:48.373
> 
> 标签：ios, xcode, xcode4, cmake

我目前使用 CMake 为我的静态库和应用程序目标创建我的 iOS xcode 项目。现在也想从 CMake 创建单元测试目标，但还没有找到任何关于 CMake 是否支持这个或如何创建 octest 目标的资源。

我可以从 CMake 创建它吗？如果是这样，你能解释一下怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-27T14:05:26.193

不，CMake 不支持 iOS 上的单元测试。此外，您不能在 iOS 上运行单独的可执行文件。

一种解决方案可能是将您的单元测试编译成静态库而不是可执行文件，然后将它们链接到您的 XCTests 或 OCTests。您可以通过为函数创建别名`main`并隐藏所有其他符号来使用链接器做一些魔术。

您必须自己实现的所有测试属性。

# javascript - 如何检查表是否有具有特定id jquery的行

> ID：13829644
> 
> 赞同：6
> 
> 时间：2012-12-11T22:35:02.180
> 
> 标签：javascript, jquery, html, json, asp.net-mvc-3

如何使用 jQuery 检查表是否包含具有特定 id 的行？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-11T22:37:30.433

只是

```
if($('#rowID').length){

  } 
```

应该够了。。

**页面上的ID**是唯一的.. 所以这个检查应该做..

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-11T22:35:57.860

```
if ($('table#uniqueID').find('#rowID').length > 0) { 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-11T22:40:17.260

一旦你有了表格，没有 jQuery 就更容易和更快了。

```
var table = $('table')[0];
if (table.rows["theId"])
    alert("Has the row!"); 
```

***演示：http:*** [//jsfiddle.net/wUKyk/](http://jsfiddle.net/wUKyk/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-11T22:37:31.790

```
if ($("#elementID").length) { ... } 
```

ID 是唯一的，因此只需检查 ID 是否存在`length`就足够了

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-11T22:36:02.120

```
var hasRowX = $table.find('#rowX').length; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-24T00:53:25.690

为了扩展“我讨厌懒惰”给出的答案，如果所讨论的行具有“名称”属性而不是“id”，这也有效。IE：

```
var table = $('table')[0];
if (table.rows["theName"])
    alert("Has the row!"); 
```

# scala - 将包作为另一个导入

> ID：13829646
> 
> 赞同：6
> 
> 时间：2012-12-11T22:35:08.093
> 
> 标签：scala, import, package

假设我有一个 Scala 项目，在 package 下有一堆案例类`com.example.a.b.c`。我想将所有这些类导入一个包`com.example.c`（其中包含更多不冲突的案例类），以便在我的项目中的其他任何地方，我只需要`import com.example.c._`使用来自`com.example.c`和的每个案例类`com.example.a.b.c`。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-11T23:25:41.040

有关于添加一个可以做你想做的事情的*导出机制的讨论，但尚不清楚这是否会发生。*

无论如何，目前唯一的办法是

*   定义每个类的类型
*   设置一个等于每个对象的 val

例如，

```
package bar
case class Foo(i: Int) {} 
```

需要在另一个包中模仿

```
package object baz {
  type Foo = bar.Foo
  val Foo = bar.Foo
} 
```

面对这种情况，人们通常只会满足于额外的一两次进口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T22:51:41.443

scala 中的 import 语句只是告诉编译器在哪里可以找到其他类（如 java 中的类），而不像 C/C++ 中的 #include 指令，其中编译器会物理复制整个头文件。如果您想使用来自 的案例类`com.example.a.b.c`，您应该从它们自己的包中导入它们，因为这是常规方式。

# asp.net-mvc - 剃刀代码以编程方式隐藏全局菜单项？

> ID：13829648
> 
> 赞同：3
> 
> 时间：2012-12-11T22:35:10.340
> 
> 标签：asp.net-mvc, razor

我是一位经验丰富的 .NET 程序员，但我对整个 Web 编程这件事还是新手。我的 ASP.NET MVC 网站有一个全局布局，其中包括一些我想在控制器代码动态检测的条件下隐藏的内容（页面顶部的菜单链接）。

我的倾向 - 使用我迄今为止所了解的工具的简单方法 - 将 Boolean HideGlobal 值推入 ViewBag，并将全局标记放在我想隐藏在 @ 中的 _Layout.cshtml if (ViewBag.HideGlobal){} 块。

我只是想知道这是否是“正确”的方法，还是出于对我来说尚不明显的原因，我应该使用一些 Razor 魔法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-11T23:40:52.000

我不喜欢在动作返回的视图之外使用动作的视图模型。在这种情况下使用基本视图模型感觉非常笨拙。

我相信仅使用包含指定全局菜单应如何显示的逻辑的单独（子）操作会更清晰、更明显。此操作返回全局菜单视图。从您的布局页面调用该操作。

或者，您可以为确定菜单状态的整个标题创建一个操作——或者执行 if/else 以呈现全局菜单的部分视图。

下面的示例封装了标题/全局菜单的需求，并提供了一种面向未来的更改标题/菜单的方法，对代码基础结构（基本视图模型）的影响最小。

**~/Controllers/LayoutController.cs**

```
public class LayoutController : Controller
{
    [ChildActionOnly]
    public ActionResult Header()
    {
        var model = new HeaderViewModel();
        model.ShowGlobalMenu = ShowGobalMenu();

        return View(model);
    }
} 
```

**~/Views/Layout/Header.cshtml**

```
@model HeaderViewModel
@{
    Layout = "";
}

<header>
    <a href="/">Home</a>

    @if(Model.ShowGlobalMenu)
    {
        <ul>
            <li><a href="#">Link</a></li>
            <li><a href="#">Link</a></li>
            <li><a href="#">Link</a></li>
            <li><a href="#">Link</a></li>
        </ul>
    }
</header> 
```

**~/Views/Shared/_Layout.cshtml**

```
<html>
    <body>
        @Html.Action("Header", "Layout")

        <p>Stuff</p>
    </body>
</body> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-11T22:53:05.720

您所描述的（将 bool 放入 ViewBag 中）可以正常工作。但就个人而言，我喜欢强类型模型体验，所以当我想要拥有像您在主/布局页面中描述的那样的 UI 逻辑时（几乎总是如此），我更喜欢将这些标志放入基本模型中我的其他模型继承自。

```
public class BaseModel
{
     public bool HideGlobal { get; set; }
} 
```

在 _Layout.cshtml 页面的顶部，我指定我期待一个 BaseModel：

```
@model Company.Project.BaseModel 
```

当然，其他视图可能需要其他模型类型，但如果它们使用此布局，则这些模型类型应派生自 BaseModel。

最后，当我想检查标志，而不是在 ViewBag 中有一个神秘的、未记录的字段时，我有模型中可爱的智能感知和感觉良好的强类型成员：

```
@if (!Model.HideGlobal)
{
    <div>...</div>
} 
```

编辑：我可能应该补充一点，通常还有一个基本控制器，其工作是填充 BaseModel 中的字段。我的通常是这样的：

```
public class BaseController : Controller
{
    protected override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        var result = filterContext.Result as ViewResultBase;
        if (result != null)
        {
            var baseModel = result.Model as BaseModel;
            if (baseModel != null)
            {
                //Set HideGlobal and other BaseModel properties here
            }
        }
    }
} 
```

这里的第一个答案，要温柔:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-12T00:03:34.500

这种类型的东西通常基于用户权限，这在操作过滤器而不是基本控制器中会更好。

是的，您必须使用`ViewData`or`ViewBag`但它实际上不是视图/模型的一部分，它在您的 _layout.cshtml 中更高

**动作过滤器**

```
public class UserAccessAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting( ActionExecutingContext filterContext ) {
        var hasAccessToMenu = /* Code */;

        filterContext.Controller.ViewData["GlobalVisible"] = hasAccessToMenu;
    }
} 
```

**查看 (_layout.cshtml)**

```
@if(ViewData["GlobalVisible"])
{
    <ul>
        <li><a href="#">Link</a></li>
        <li><a href="#">Link</a></li>
        <li><a href="#">Link</a></li>
        <li><a href="#">Link</a></li>
    </ul>
} 
```

这为您提供了将这个逻辑从控制器中分离出来的优势，因为它是全局的，这很重要。

*我也在`ViewData`我的例子中使用过，但使用`ViewBag`也一样好。*

# objective-c - 无法从 CGPDFOperator C 函数中读取/写入 Objective-C 类的属性

> ID：13829649
> 
> 赞同：0
> 
> 时间：2012-12-11T22:35:22.553
> 
> 标签：objective-c, c, cgpdfdocument, pdf-parsing

好的，所以我正在使用从`CGPDFScanner`. 这些函数位于一个名为的类中，该类`PDFContentStreamProcessor`的`NSMutableArray`属性名为`myArray`

ARC 已启用，但我在此类的构建阶段做了一个例外。

```
void RandomCallbackOperatorFunction(CGPDFScannerRef s, void *info) {
    PDFContentStreamProcessor * searcher = (PDFContentStreamProcessor*)info;
    [searcher setMyArray:[[NSMutableArray alloc] initWithObjects:@"aString",@"AnotherString", nil]];
    NSLog(@"arraylength:%i",searcher.myArray.count);
} 
```

它可以很好地找到文本、整数和对象，但如果我不能将它们存储在任何地方，我就无法对这些值做太多事情。有任何想法吗？

我也试过这样：

```
[(PDFContentStreamProcessor*)info setMyArray:[[NSMutableArray alloc] initWithObjects:@"aString",@"AnotherString", nil]]; 
```

...也没有运气

# spring-mvc - 无法在 Spring 表单选择标记中保存外键

> ID：13829650
> 
> 赞同：1
> 
> 时间：2012-12-11T22:35:25.207
> 
> 标签：spring-mvc

我正在尝试保存在选择标记中具有外键但始终为空的表单。当我使用检查元素时，它会发布选定的 id，所以我不能说这是表单的问题。有人可以帮忙吗。形式

```
 <form:select path="categoryId">
            <form:option value="0" label="   -- Please Select --" />
            <form:options items="${categoryList}"  itemValue="categoryId" itemLabel="categoryName"/>
    </form:select> 
```

控制器

```
@RequestMapping(value = "product", method = RequestMethod.POST)
public String addNewProduct(@ModelAttribute("product") Product product, Model model){
    model.addAttribute("product", product);
    purchaseOrderService.addProduct(product);
    return "categories";
} 
```

JPA

```
@Transactional(propagation = Propagation.REQUIRED)
    public boolean saveProduct(Product product) {
        EntityManager em = getEm();
        em.persist(product);
        return true;
    } 
```

持久性对象

```
@ManyToOne(fetch=FetchType.LAZY)
@JoinColumn(name = "CATEGORY_ID", referencedColumnName = "CATEGORY_ID")
private Category categoryId; 
```

错误

```
java.lang.NoClassDefFoundError: org/hibernate/exception/LockTimeoutException
org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1328)
org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1300)
org.hibernate.ejb.TransactionImpl.commit(TransactionImpl.java:80)
org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:512)
org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:754)
org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:723)
org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:394)
org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:120)
org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
$Proxy34.addProduct(Unknown Source)
com.logicalideas.purchaseorder.ProductController.addNewProduct(ProductController.java:30)
sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
java.lang.reflect.Method.invoke(Method.java:601)
org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:213)
org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:126)
org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96)
org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617)
org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578)
org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80)
org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)
javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

根本原因

java.lang.ClassNotFoundException: org.hibernate.exception.LockTimeoutException org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1711) org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556) org .hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1328) org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1300) org.hibernate.ejb.TransactionImpl.commit(TransactionImpl.java:80) org.springframework .orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:512) org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:754) org.springframework.transaction.support.AbstractPlatformTransactionManager。commit(AbstractPlatformTransactionManager.java:723) org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:394) org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:120) org.springframework.aop。 framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172) org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202) $Proxy34.addProduct(Unknown Source) com.logicalideas.purchaseorder.ProductController.addNewProduct(ProductController. java:30) sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) sun.reflect.DelegatingMethodAccessorImpl。调用(DelegatingMethodAccessorImpl.java:43) java.lang.reflect.Method.invoke(Method.java:601) org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:213) org.springframework.web。 method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:126) org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96) org.springframework.web.servlet.mvc.method. annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617) org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578) org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter。句柄（AbstractHandlerMethodAdapter.java:80） org.springframework.web.servlet.DispatcherServlet.doDispatch（DispatcherServlet.java:923） org.springframework.web.servlet.DispatcherServlet.doService（DispatcherServlet.java:852） org.springframework.web。 servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882) org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789) javax.servlet.http.HttpServlet.service(HttpServlet.java:641) javax.servlet. http.HttpServlet.service(HttpServlet.java:722)servlet.FrameworkServlet.doPost(FrameworkServlet.java:789) javax.servlet.http.HttpServlet.service(HttpServlet.java:641) javax.servlet.http.HttpServlet.service(HttpServlet.java:722)servlet.FrameworkServlet.doPost(FrameworkServlet.java:789) javax.servlet.http.HttpServlet.service(HttpServlet.java:641) javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T15:03:09.120

当您解决第一个问题（ClassNotFound）时，我认为现在可以了。

对于你的第二个问题：

> 好吧，这已经消除了错误，但它现在有一个奇怪的行为，即使我在产品控制器中并尝试保存具有选定类别（FK）的新产品，它也会创建一个新类别。然后它将这个新创建的 categoryId 添加到 product.categoryId 中，它与您选择的类别（名称，而不是 id）重复。我真的希望我没有让任何人感到困惑。我真的很感激一些。

这不是同一个问题。我认为您误解了 Hibernate 的工作方式。当你让 Spring 机制在这种情况下映射对象时，它总是会创建一个新的 categoryId 对象。另一方面，通过另一种方式，您可以让 Spring 理解它们是相同的，但是在尝试编辑类别时会遇到麻烦。

这里的问题是您依赖 Spring 来映射正确的 Hibernate 对象——Spring 映射并不总是好的。相反，我认为您可以将“idOfCategory”之类的参数发送到服务器，通过该 ID 获取 CategoryId 对象，然后将类别设置为您新创建的产品。更好的方法是您只从客户端传输一个 DTO 对象 (ProductDTO)，然后在服务器端创建一个成熟的 Hibernate Product 对象。

例如：

```
@RequestMapping(value = "product", method = RequestMethod.POST)
public String addNewProduct(@ModelAttribute("productDTO") ProductDTO productDTO, Model model){
    model.addAttribute("product", product);
    Product product = new Product(productDTO);
    CategoryId id = productService.getCategoryById(productDTO.getCategoryId());
    product.setCategoryId(id);
    purchaseOrderService.addProduct(product);
    return "categories";
} 
```

# android - 在布局之间共享一些 XML

> ID：13829651
> 
> 赞同：2
> 
> 时间：2012-12-11T22:35:26.300
> 
> 标签：android

我想`LinearLayout`在手机版本的应用程序上制作垂直的东西，在平板电脑上制作水平的东西。

有问题的视图位于指定整个视图的大型 XML 文件中。

*天真*的方法是将文件从复制并粘贴`res/layout`到`res/layout-sw600dp`. 我这样做了，它有效。但是，这意味着如果我想进行其他 UX 更改，我知道必须维护**两个文件。**这是低效的。

抽象出有问题的 LinearLayout 的最简单方法是什么？

我看过[自定义组件](http://developer.android.com/guide/topics/ui/custom-components.html#basic)，但它比我想去的更远。我不想为此进行代码更改，它应该在 XML 更改中自包含。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:47:43.860

您可以使用 <include> 和 <merge> 标签重复使用布局。

这样做，您可以在 sw600dp 和布局文件夹中拥有不同的容器，包括相同的通用布局。

官方文档[在这里](http://developer.android.com/training/improving-layouts/reusing-layouts.html)

# r - Excel重叠间隔与一种vlookup

> ID：13829654
> 
> 赞同：0
> 
> 时间：2012-12-11T22:35:37.853
> 
> 标签：r, excel, intervals, overlap, vlookup

这是数据的片段，其中有很多，并解释了我想要做什么： [文件](https://skydrive.live.com/redir?resid=CEC7696F3B5BFBC6!391&authkey=!AOyJ7_mzmDZRNu8)

基本上，我有许多具有间隔的数据子集（由 1、2 ... 在单独的列中标记）。我需要知道相同两个子集中的间隔是否重叠，如果是，那么我需要将与列 EG 中的集合相关联的值（列 C）粘贴到与间隔重叠的 JK 列中的间隔旁边FG。问题是 FG 列中的区间与 JK 列中的多个区间重叠。

我一直在尝试用
=if(or(and(x>=a,x<=b),and(a>=x,a<=y)),"Overlap","Do not overlay"来解决这个问题)

但问题是我找不到针对多个重叠执行此操作的方法。如果您认为这不能在 excel 中完成并且知道该怎么做（例如 R），请告诉我。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:21:05.083

在 Excel 中尝试复制 L4 中的这个公式

`=IFERROR(INDEX(C$4:C$100,MATCH(1,INDEX((J4<=G$4:G$100)*(K4>=F$4:F$100)*(I4=E$4:E$100),0),0)),"No overlap")`

这将找到每个子集中的第一行（如果有），其中 F/G 间隔与当前行 J/K 间隔重叠，如果不存在这样的行，您将得到“无重叠”

# iis - 来自 ASP.net 的 SSIS 包不适用于客户端，但适用于服务器

> ID：13829664
> 
> 赞同：1
> 
> 时间：2012-12-11T22:36:21.090
> 
> 标签：iis, permissions, ssis

**环境描述**

我有一个从 asp.net 执行的 SSIS 任务，该包通过 UNC 路径从 excel 文件中获取数据，并将数据放入 sql server 数据库中。我已将 SSIS 部署到文件系统，它具有 Windows 身份验证数据库连接，并且 IIS 用户具有数据库访问权限。我可以作为用于托管 Web 应用程序的 AppPoolUser 登录并打开/修改有问题的文件，以便获得这些基本权限。Web App 是在 x86 中编译的。

**当它工作时：**

*   在我的用户或 appPool 用户下的服务器上的浏览器中从 Web 应用程序运行时
*   在通过 BIDS 运行的服务器上以我的身份登录时
*   在通过 BIDS 运行的服务器上以 AppPoolUser 身份登录时
*   使用 AppPoolUser 从服务器上的计划任务运行时

**当它不起作用时：**

*   从客户端浏览器运行时，即不是具有 IIS 托管 asp.net 应用程序的机器

**我的问题**

客户端和服务器有什么不同，我该如何让它工作？我的印象是，在运行 Web 应用程序时，所有连接都通过 AppPool 用户，所以它应该在包含的任何机器服务器上表现相同？

**返回客户端浏览器的错误**

SSIS 错误代码 DTS_E_OLEDBERROR。发生 OLE DB 错误。错误代码：0x80004005。OLE DB 记录可用。来源：“Microsoft Office Access 数据库引擎”Hresult：0x80004005 描述：“Microsoft Office Access 数据库引擎无法打开或写入文件 '\\myserver\My folder\myfile.xlsx'。它已被其他用户以独占方式打开，或者您需要获得查看和写入其数据的权限。”。SSIS 错误代码 DTS_E_CANNOTACQUIRECONNECTIONFROMCONNECTIONMANAGER。对连接管理器“MyExcelFileConnection”的 AcquireConnection 方法调用失败，错误代码为 0xC0202009。在此之前可能会发布错误消息，其中包含有关 AcquireConnection 方法调用失败原因的更多信息。组件“Excel Source”(1) 验证失败并返回错误代码 0xC020801C。一个或多个组件验证失败。任务验证期间出现错误。

**c#代码运行SSIS包**

```
 string pkgLocation;
        Package pkg;
        Application app;
        DTSExecResult pkgResults;
        string result = string.Empty;
        string dtsErrors = string.Empty;

        try
        {
            pkgLocation = packagePath;
            app = new Application();
            pkg = app.LoadPackage(pkgLocation, null);
            pkgResults = pkg.Execute();

            foreach (DtsError local_DtsError in pkg.Errors)
                dtsErrors += " " + local_DtsError.Description;

            result = pkgResults.ToString();
        }
        catch (Exception exception)
        {
            result = exception.Message;
        } 
```

# c# - 字典 vs 列表 vs 数组的速度和功能

> ID：13829665
> 
> 赞同：2
> 
> 时间：2012-12-11T22:36:24.957
> 
> 标签：c#, .net, list, dictionary, listbox

我正在使用 .NET 4.5 在 C# 中编写应用程序。我的应用程序读取和写入硬件设备使用的二进制文件。该文件正好是 5,000,000 字节，由 100,000 个 50 字节的“块”组成。每个 50 字节的块将包含一个 ASCII 编码的字符串（可能只是一个空字符串）。设备需要文件布局，因此可以通过确定偏移量（索引 * 50 字节，然后读取/写入接下来的 50 字节）来访问任何字符串。

我的 WinForms 应用程序需要能够：

*   从文件中加载所有 100,000 个字符串并在 UI（列表框）中显示它们
*   添加、编辑或删除字符串
*   以正确的格式重写二进制文件

注意事项：

1.  二进制文件中的大量数据最初是我不想向用户显示的空字符串，但仍需要在我的数据结构中，以便我可以正确地重写文件。
2.  在添加新字符串之前，我需要确保有可用空间来允许它（即，至少有一个 50 字节的空块）。如果没有，那么用户将需要“删除”现有字符串，以便为要添加的新字符串腾出空间。
3.  在幕后，添加、修改和删除字符串是相同的操作。添加只是将 50 字节的空数据更改为 50 字节的字符串数据，而删除则相反。
4.  除空字符串外，不应存储重复的字符串，因此我需要某种方法来遍历我的数据结构，以确保在添加或编辑字符串以匹配现有字符串之前字符串不存在。

所以我需要一个数据结构来保存文件中的所有数据，我正在努力在字典、列表或数组之间做出决定。鉴于上述警告，我不认为直接将任何数据结构绑定到 UI 是一个可行的解决方案。所以我*认为*我需要在该数据结构和列表框之间使用大量代码来实现某种伪绑定。如果是这种情况，从功能的角度来看，哪种数据结构（字典、列表、数组等）最有用，并提供最佳折衷：使用这种大小的数据集（100,000 个最多 50 个 ASCII 字符的字符串）的速度每个）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:42:30.150

如果性能很关键，最好的方法是测试它。编写一个快速而肮脏的应用程序，以所有三种方式完成关键工作，然后将其包装在一个循环中，完成 10,000 次，看看哪个更快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-11T22:43:23.737

字典在这里似乎没有必要，因为您没有任何键来索引您的数据。
列表适用于添加/删除项目，但这显然也不是必需的。
所以我会去一个字符串数组

编辑：重新考虑存在的多个空字符串，如果空字符串与填充字符串的比率不低，我可以建议可能的优化。
我们可以使用整数数组作为映射，而不是只包含填充字符串的字典

**警告：需要测试**

```
int[] keys = new int[100];  // Just 100 to test the idea
Dictionary<int, string> data = new Dictionary<int, string>();

AddItem(keys, 32, data, "Position 32 34567890123456789012345678901234567890");
AddItem(keys, 40, data, "Position 40 34567890123456789012345678901234567890");
AddItem(keys, 10, data, "Position 10 34567890123456789012345678901234567890");
AddItem(keys, 25, data, "Position 25 34567890123456789012345678901234567890");
AddItem(keys, 99, data, "Position 99 34567890123456789012345678901234567890");
AddItem(keys, 0, data, "Postion 00 234567890123456789012345678901234567890");
AddItem(keys, 18, data, "Position 18 34567890123456789012345678901234567890");

foreach(int x in keys)
{
    if(x == 0)
        Console.WriteLine("Empty string");
    else
        Console.WriteLine(data[x]);
}

void AddItem(int[] keys, int keyPos, Dictionary<int, string> data, string message)
{
    int count = data.Count;
    data.Add(count, message);
    keys[keyPos] = count;
}
void RemoveItem(int[] keys, int keyPos, Dictionary<int, string> data)
{
    int x = keys[keyPos];
    data.Remove(x);
    keys[keyPos] = 0;
}
void UpdateItem(int[] keys, int keyPos, Dictionary<int, string> data, string message)
{
    int x = keys[keyPos];
    data[x] = message;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T22:53:43.997

即使有 100,000 个条目，我认为您也不必过于担心性能。（编辑：我的意思是，在 I/O 或数据更改方面的性能。您的 GUI 绑定可能会遇到问题）

以最简单的方式对其进行编程，使您可以最轻松地更改业务逻辑和 GUI 绑定。甚至可以考虑创建您自己的类，该类简单地为您的 GUI 包装一个`List`（`Array`或其他）具有标准公共接口的隐藏此实现细节的 GUI。

一旦您的 GUI 运行并且所有 I/O 都运行良好（理想情况下，有一些不错的单元测试套件），那么您就可以开始进行基准测试/分析并找出瓶颈所在。

编辑：考虑到您的要求，这种自定义/包装的数据结构可能是理想的。它可以主动了解您数据的某些方面。例如，当它被加载/读取时，它可以检查是否有空间可用于新字符串，所以当用户去添加更多时，你已经知道是否可以。它可以维护一个`HashSet`使用过的唯一字符串，因此您可以很好地 O(1) 查找重复的字符串，依此类推。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-24T16:46:40.967

实际上，字典是存储数据的最佳选择。键是要存储的字符串，值是它的位置。您可以通过字典的大小来跟踪您的可用空间。

对于您的列表框，您首先将字典转换为数组，然后将该数组用作列表框的后备存储。这将是您在应用程序启动时支付的一次性速度惩罚，但会大大提高您的 UI 响应速度并满足基础数据存储的其他要求。

添加/删除操作在字典上执行，该字典快速处理重复检查，如果您对底层字典进行更改而不是重建数组，您可以快速直接更新数组。

# jquery - 如何将 jQuery 添加到 HTML 页面？

> ID：13829667
> 
> 赞同：16
> 
> 时间：2012-12-11T22:36:32.057
> 
> 标签：jquery

我被赋予了这段代码以放置在我的 html 页面中，但我对 javascript 一无所知，所以我不知道将它放置在哪里以及放置它的类型。

```
$('input[type=radio]').change(function() {

$('input[type=radio]').each(function(index) {
  $(this).closest('tr').removeClass('selected');
});

$(this).closest('tr').addClass('selected');
}); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-11T22:41:09.917

**包括 jQuery 库**

那是jQuery代码。您首先需要确保已加载 jQuery 库。如果您自己不托管库文件，您可以从[jQuery CDN](https://code.jquery.com/)热链接一个：

```
<script src="//code.jquery.com/jquery-1.11.3.min.js"></script> 
```

您可以在该`<head>`部分中执行此操作，但只要在您的 jQuery 代码之前加载它就可以了。

进一步阅读：

*   [为什么我应该为 jQuery 使用 Google 的 CDN？](https://stackoverflow.com/questions/2180391/why-should-i-use-googles-cdn-for-jquery)
*   [用于 jQuery 的 Microsoft CDN 还是 Google CDN？](https://stackoverflow.com/questions/1447184/microsoft-cdn-for-jquery-or-google-cdn)

* * *

**将代码放在页面中**

将您的代码放在`<script>`标签内。它可以插入到`<head>`或中的任何位置`<body>`。如果将它放在`<input>`and`<tr>`标记之前（如代码中所引用），则必须使用[**`$(document).ready()`**](http://learn.jquery.com/using-jquery-core/document-ready/)以确保在代码运行之前存在这些元素：

```
$(document).ready(function() {
    // put your jQuery code here.
}); 
```

如果您希望页面内容尽快加载，您可能希望将其放置在尽可能靠近`</body>`关闭标记的位置。但另一种常见的做法是将所有 JavaScript 代码放在该`<head>`部分中。这是您的选择，具体取决于您的编码风格和需求。

*建议：*与其将 JS/jQuery 代码直接嵌入 HTML 页面，不如考虑将代码放在单独的 .js 文件中。这将允许您在其他页面上重用相同的代码：

```
<script src="/path/to/your/code.js"></script> 
```

进一步阅读：

*   [将 Javascript 放在 HTML 文件中的什么位置？](https://stackoverflow.com/questions/196702/where-to-place-javascript-in-a-html-file)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-11T22:42:02.523

您需要将其包装在脚本标签中：

```
<script type='text/javascript'> ... your code ... </script> 
```

话虽如此，执行此代码时很重要。如果您将它放在页面中它所挂钩的 HTML 元素之前，那么脚本将在 HTML 实际呈现在页面中之前运行，因此它将失败。

将这种类型的代码包装在“文档就绪”块中是常见的做法，如下所示：

```
<script type='text/javascript'>
$(document).ready(function() {

... your code...

}}
</script> 
```

这可确保在执行代码之前整个页面已在浏览器中呈现。`<head>`将代码放在页面的部分中也是一种最佳做法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T22:40:38.430

在您的`<head></head>`标签内添加...

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script>
$(document).ready(function(){
    $('input[type=radio]').change(function() {

    $('input[type=radio]').each(function(index) {
        $(this).closest('tr').removeClass('selected');
    });

        $(this).closest('tr').addClass('selected');
    });
});
</script> 
```

编辑：内部的放置`<head></head>`不是唯一的选择......这可以很容易地放置在结束`</body>`标记之前。出于放置原因，我通常会尝试将我的 JavaScript 放在其中`head`，但在某些情况下它会减慢页面渲染速度，因此有些人会推荐后一种方法（在关闭之前`body`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-29T21:50:16.147

您可以使用以下任何方法包含 JQuery：

*   **使用带有 CDN 的 jQuery 链接**

> `<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>`

*   **从这里下载 Jquery 并包含在您的项目中**

> *   [http://jquery.com/download/](http://jquery.com/download/)
> *   [https://code.jquery.com/](https://code.jquery.com/)

*   **使用此链接下载最新版本**

> *   [http://code.jquery.com/jquery-latest.min.js](http://code.jquery.com/jquery-latest.min.js)（不要在生产服务器上使用这个链接）

* * *

您的代码位置可能看起来像这样

*   在使用它之前应该包含您的 Jquery，否则它会引发错误

```

```
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script>
$(document).ready(function(){
    $('input[type=radio]').change(function() {

    $('input[type=radio]').each(function(index) {
        $(this).closest('tr').removeClass('selected');
    });

        $(this).closest('tr').addClass('selected');
    });
});
</script> 
```

```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-04-03T00:40:15.810

Include javascript using script tags just before your ending body tag. Preferably you will want to put it in a separate file and link to it to keep things a little more organized and easier to read. Theres a simple article here that will show you how [http://www.selftaughtweb.com/how-to-include-javascript/](http://www.selftaughtweb.com/how-to-include-javascript/)

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2012-12-11T22:42:53.957

您需要将此代码包装在标签中并放在页面末尾。或者创建 JS 文件（例如 test.js），在上面写下这段代码并在页面的末尾加上这个标签

# javascript - 访问 JSON 提要中的嵌套对象并处理未定义

> ID：13829669
> 
> 赞同：2
> 
> 时间：2012-12-11T22:36:35.987
> 
> 标签：javascript, jquery, json, undefined

我的问题是这样的：

我有一个端点，它将返回包含名为的结构的 JSON：`the_data_i_want`

如果服务器检测到有一个值，`the_data_i_want`那么它会返回如下内容：

```
{
    "sample": {
        "title": "The Title",
        "foo": {
            "Bar": {
                "Baz": {
                    "Qux": {
                        "the_data_i_want": "DATA PARTY!!!!"
                    }
                }
            }
        }
    }
} 
```

如果服务器检测到它`the_data_i_want`是空的，它返回的 JSON 看起来像这样：

```
{
    "sample": {
        "title": "The Title"
    }
} 
```

我的问题是，因为链的任何部分`sample.foo.Bar.Baz.Qux.the_data_i_want`我都是`undefined`我最终通过json结构对每个步骤进行这些疯狂的检查链，我首先查看它是否未定义，然后如果不是，我尝试下一个下一个，直到我到达`the_data_i_want`，这似乎是错误的。

**问题：**

有没有“正确”的方法来处理这个问题？即使嵌套任意深，我该怎么办？我愿意使用 jQuery。

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:55:48.210

可能这可能有效..但可能有更好的方法..

在这种方法中，我将所有键都放在一个数组中，并在循环中检查它们。

```
var obj = {
    "sample": {
        "title": "The Title",
        "foo": {
            "Bar": {
                "Baz": {
                    "Qux": {
                        "the_data_i_want": "DATA PARTY!!!!"
                    }
                }
            }
        }
    }
};

var arr = ["foo", "Bar", "Baz", "Qux", "the_data_i_want"];
var arr1 = ["foo", "Bar", "Baz", "Qux", "the_data_i_want", "ding"];

checkKey('Object 1' , arr);
checkKey('Object 2 ' ,arr1);

function checkKey(str ,arr) {
    if (obj && obj.sample) {
        var k = obj.sample;
        var i = 0;
        for (var i = 0; i < arr.length; i++) {
            if (k[arr[i]]) {
                k = k[arr[i]];
                if (i === arr.length - 1) {
                    alert('Data Found :: ' + k);
                }
            }
            else {
                alert('No such Key in :: ' + str );
                break;
            }
        }
    }
    else {
         alert('No such Key in :: ' + str );
    }
}​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/ZN9UM/1/)**

# google-maps-api-3 - 从 KML 获取 infowindow 的描述时出现问题

> ID：13829671
> 
> 赞同：2
> 
> 时间：2012-12-11T22:36:39.590
> 
> 标签：google-maps-api-3, infowindow

对 Google 混搭有点陌生。我在我们的网络服务器 (http://www.madisonareampo.org/maps/BRT_National.kmz) 上有一个 KML，可以在 Google 地图上绘图。

我有一个谷歌地图混搭，我想要一个信息窗口通过点击事件显示 KML 描述字段的内容。KML 文件是使用 ArcGIS 从地理数据库中导出的。

当我单击 KML 文件中的标记时，没有返回任何内容。

```
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Google Maps JavaScript API v3 Example: Street View Layer</title>
    <link href="/maps/documentation/javascript/examples/default.css" rel="stylesheet">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBvkXCNOcIGLKZVgFtIykSQEbEk0db1XxY&sensor=false">
    </script>
    <script>

      function initialize() {
        var BRT = new google.maps.LatLng(40.380028, -93.440917);
        var mapOptions = {
          center: BRT,
          zoom: 3,
          overviewMapControl: true,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(
            document.getElementById('map_canvas'), mapOptions);

        var layer= new google.maps.KmlLayer('http://www.madisonareampo.org/maps/BRT_National.kmz',
          { suppressInfoWindows: true,
            map: map });

        google.maps.event.addListener(layer, 'click', function(kmlEvent) {
          showInContentWindow(kmlEvent.featureData.description);
        });

        function showInContentWindow(text) {
          var content = "<div style='margin-left:-20px;border:2px dotted #897823;'>" + text +  "</div>";
          var infowindow = new google.maps.InfoWindow({
            content: content 
          })
        }

        var panoramaOptions = {
          position: BRT,
          pov: {
            heading: 34,
            pitch: 10,
            zoom: 1
          }
        };
        var panorama = new google.maps.StreetViewPanorama(document.getElementById('pano'),panoramaOptions);
        map.setStreetView(panorama);
      }
    </script>
  </head>
  <body onload="initialize()">
    <div id="map_canvas" style="width: 650px; height: 400px"></div>
    <div id="pano" style="position:absolute; left:660px; top: 8px; width: 650px; height: 400px;"></div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T09:20:48.863

[InfoWindows](https://developers.google.com/maps/documentation/javascript/reference?hl=fr-FR#InfoWindow)需要一个`position`属性，您必须调用`open(map)`它才能将其绑定到地图。这是您的代码的工作版本：

```
google.maps.event.addListener(layer, 'click', function(kmlEvent) {
  showInContentWindow(kmlEvent.latLng, kmlEvent.featureData.description);
});

function showInContentWindow(position, text) {
  var content = "<div style='margin-left:-20px;border:2px dotted #897823;'>" + text +  "</div>";
  var infowindow = new google.maps.InfoWindow({
    content: content, 
    position: position
  })
  infowindow.open(map);
} 
```

# google-bigquery - 如何命名包含点的表格列？

> ID：13829677
> 
> 赞同：1
> 
> 时间：2012-12-11T22:37:11.760
> 
> 标签：google-bigquery

我注意到，如果我将列名重命名为 include `.`，例如 ，`device.name`它将`device_name`在 BigQuery 中自动转换为。

```
select Device device.name from mydataset.DeviceTable limit 10 
```

无论如何我可以在列名中使用点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:59:25.510

点保留用于指示嵌套。您可以通过 json 导入（例如`{device: {name "foo"}}`）导入嵌套数据。

查询结果变平，因此查询结果中的点会变成下划线。

# ios - Cocos2d 绘图 App 制作线条

> ID：13829680
> 
> 赞同：0
> 
> 时间：2012-12-11T22:37:30.450
> 
> 标签：ios, cocos2d-iphone

我正在制作一个非常简单的绘图应用程序。我使用 ccTouchMoved 事件绘制了线条。我将所有触摸移动的点放入一个数组中，然后使用 for 循环在所有点之间画一条线。现在，当我抬起手指并开始新的线条绘制时，我不想加入这些点。我也得到了那个部分，但现在每当我开始新的绘图时，整个屏幕都会闪烁。

```
//
//  HelloWorldLayer.mm
//  DrawPuppets
//
//  Created by Mohammad Azam on 12/11/12.
//  Copyright __MyCompanyName__ 2012\. All rights reserved.
//

// Import the interfaces
#import "DrawPuppetLayer.h"
#import "AppDelegate.h"
#import "PhysicsSprite.h"

enum {
    kTagParentNode = 1,
};

#pragma mark - HelloWorldLayer

@interface DrawPuppetLayer()
-(void) initPhysics;
-(void) addNewSpriteAtPosition:(CGPoint)p;
-(void) createMenu;
@end

@implementation DrawPuppetLayer

+(CCScene *) scene
{
    // 'scene' is an autorelease object.
    CCScene *scene = [CCScene node];

    // 'layer' is an autorelease object.
    DrawPuppetLayer *layer = [DrawPuppetLayer node];

    // add layer as a child to scene
    [scene addChild: layer];

    // return the scene
    return scene;
}

-(id) init
{
    if( (self=[super init])) {

        // enable events

        self.isTouchEnabled = YES;
        self.isAccelerometerEnabled = YES;
        index = -1;

        canvas = [[NSMutableArray alloc] init];

        // init physics
        [self initPhysics];

        [self scheduleUpdate];
    }
    return self;
}

-(void) draw
{

    if([lineDrawing.points count] > 1)
    {

    for(int i = 0; i<([canvas count]) ;i++)
    {
        LineDrawing *drawing = (LineDrawing *) [canvas objectAtIndex:i];

        for(int j=0;j<[drawing.points count] - 1;j++)
        {

        LinePoint *firstPoint = (LinePoint *) drawing.points[j];
        LinePoint *secondPoint = (LinePoint *) drawing.points[j + 1];

        CGPoint point1 = [[CCDirector sharedDirector] convertToGL:CGPointMake(firstPoint.x, firstPoint.y)];

        CGPoint point2 = [[CCDirector sharedDirector] convertToGL:CGPointMake(secondPoint.x, secondPoint.y)];

        ccDrawLine(point1, point2);
        }

    }

    }

    //
    // IMPORTANT:
    // This is only for debug purposes
    // It is recommend to disable it
    //
    [super draw];

    ccGLEnableVertexAttribs( kCCVertexAttribFlag_Position );

    kmGLPushMatrix();

    world->DrawDebugData();

    kmGLPopMatrix();
}

-(void) ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{

    lineDrawing = [[LineDrawing alloc] init];
    lineDrawing.points = [[NSMutableArray alloc] init];

    [canvas addObject:lineDrawing];

}

-(void)ccTouchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {

    UITouch *touch = [touches anyObject];
    CGPoint point = [touch locationInView: [touch view]];

    LinePoint *linePoint = [[LinePoint alloc] init];
    linePoint.x = point.x;
    linePoint.y = point.y;

    [lineDrawing.points addObject:linePoint];

}

- (void)ccTouchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    //Add a new body/atlas sprite at the touched location
    for( UITouch *touch in touches ) {
        CGPoint location = [touch locationInView: [touch view]];

        location = [[CCDirector sharedDirector] convertToGL: location];

    }
}

@end 
```

谁能发现我的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T01:23:53.137

尝试将其全部访问到纹理，有时您的点数组会变得太大而无法很好地绘制

```
-(void)ccTouchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    // get the node space location of our touch
    CGPoint location    = [self getNodeSpaceTouchLocationFromUIEvent:event];

    // draw with our current location and a random colour
    [_canvas begin]; // our rendertexture instance

    // do your drawing here
    [_pen drawPenWithPosition:location andColour:_colour];  

    // end capturing the current pen state
    [_canvas end];
} 
```

这是一个为 iOSDevUK 2012 编写的简单[示例项目](http://www.abitofcode.com/download/source/simpledrawing.zip)，它在 Cocos2d v1 中使用 GL_POINTS，并且基于我们在开发[SketchShare时采用的方法](http://www.youtube.com/watch?v=ARyXKIjY378)

# objective-c - Objective-C 问题 - 上课前的预期标识符或“（”

> ID：13829689
> 
> 赞同：1
> 
> 时间：2012-12-11T22:38:06.723
> 
> 标签：objective-c, compiler-construction

在我的头文件 GuiController.h 中：

```
#import <Cocoa/Cocoa.h>
#import <APPKit/NSTextField.h>
#import "ClientSocket.h"
#import "UploaderThread.h"
#import "DownloaderThread.h"

/**
 * SER 321 Foundations of Distributed Applications
 * see http://pooh.poly.asu.edu/Cst420
 * @author Christopher Sosa (smoothpinkjazz@gmail.com), ASU Polytechnic, Software Engineering
 * @version December 2012
*/

@class AppDelegate; //compiler error
@interface GuiController : NSObject {
    AppDelegate * appDelegate;
    NSSound *sound;
    NSString *port;
    NSString *host;
    ClientSocket *mainSock;
    ClientSocket *songSock;
    UploaderThread *uploader;
    int ident;
    NSTextField *albTB;
    NSComboBox *titCB;
    NSTextField *authTB;

}
- (id) initWithDelegate: (AppDelegate*) theDelegate
               host: (NSString*) hostName
               port: (NSString*) portNum;
- (void) dealloc;

- (void) saveLib;
- (void) restoreLib;
- (void) addMD;
- (void) removeMD;
- (void) refreshMD;
- (void) playMD;
- (void) comboBoxSelectionDidChange: (NSNotification*)notification;
- (void) debug: (NSString*) aMessage;
@end 
```

我标记了引发错误的行，即使似乎没有错误。我 99% 确定编译器抛出错误只是因为它感觉像它。你能找出问题所在吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:42:53.300

检查你的`DownloaderThread.h`文件。最后你可能有一个错误。

或者，`GuiController.h`从未编译为 Obj-C 或 Obj-C++ 的源文件导入。尽管如果是这种情况（在一个导入的标头中），我会更快地出现错误。

# c++ - const HANDLE 真的是 const 吗？

> ID：13829691
> 
> 赞同：1
> 
> 时间：2012-12-11T22:38:24.367
> 
> 标签：c++, windows, visual-c++, handle

据我所知，HANDLE 只是一个数字，指的是某种“系统资源表”。这个句柄 const 正确吗？我猜不是因为它只是用来访问像数组索引这样的表。位图示例：尽管 HBITMAP 被声明为 const，但我可以更改位图的内容吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:56:24.543

HANDLE 是 (AFAIR) int 的 typedef，因此 const HBITMAP 与 const int 相同。

从这个意义上说，即使位图的句柄是 const，您也可以更改位图的内容，因为 const 指的是句柄而不是实际的位图（将其视为指向变量类的 const 指针。）

但：

无论如何，您的问题没有实际意义，因为：

*   句柄是 Win32 API 的一个特性，它是 C api 而不是 C++（在 C 获得 const 之前创建）。
*   无论如何，您不能直接更改位图（或由句柄表示的任何其他“对象”）。句柄是对 Win32 结构的不透明引用，只能通过用于处理（没有双关语）“对象”的适当 Win32 API 调用来操作。

我将“对象”放在引号中，因为句柄指的是概念对象（概念的软件表示）而不是实际的 C++ 对象，再次因为 Win32 是 C API。

# asp.net - 将主题应用于母版页？

> ID：13829692
> 
> 赞同：1
> 
> 时间：2012-12-11T22:38:26.990
> 
> 标签：asp.net, .net, asp.net-3.5

我知道一般主题不能应用于母版页。但我想知道可能有一些技巧或方法可以做到这一点。在我的情况下，我不想将这些应用到整个站点，而只是应用到应用程序上。因为在应用程序中有很多页面我不能手动完成。在我的情况下，我也无法继承页面类。请有任何建议。这个项目在 Asp.net 3.5 中

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:47:36.227

显然，如果您不能从基类继承，则以编程方式执行此操作的唯一方法是使用 HTTP 模块。

查看以下博客以获取解释：[为 MasterPage 设置主题（来自代码）](http://bloggingabout.net/blogs/rick/archive/2007/10/20/howto-set-the-theme-for-a-masterpage-from-code.aspx)

在您的情况下，您应该先检查页面的母版页，然后再设置页面的主题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-26T12:31:16.913

您可以在 Global.asax 文件中添加此代码：

```
void Application_PreRequestHandlerExecute(object src, EventArgs e)
{
    Page p = this.Context.Handler as Page;
    if (p != null)
    {
        p.PreInit += (s, ev) =>
        {
            DevExpress.Web.ASPxClasses.ASPxWebControl.GlobalTheme = "Aqua";
        };
    }
} 
```

# javascript - 如何 $watch 对列表的更改？

> ID：13829703
> 
> 赞同：3
> 
> 时间：2012-12-11T22:39:29.173
> 
> 标签：javascript, angularjs

# [小提琴](http://jsfiddle.net/_nth/HEzxZ/7/)

我有一个列表，我希望在它发生变化时得到通知。一个简单的`$watch`表达式不起作用，我猜这是因为 angular 正在检查引用相等，而不是结构相等。

```
<html ng-app>
    <head>
    </head>
    <body ng-controller="Root">
        <h1>Base Angular Fiddle</h1>
        Times changed: {{timesChanged}}
        <ul>
            <li ng-repeat="name in names">{{name}}</li>
            <li><button ng-click="names.push('another name')">Add</button></li>
        </ul>
    </body>
</html>
​

​function Root($scope) {
    $scope.timesChanged = 0;
    $scope.names = ['foo', 'bar', 'baz'];
    $scope.$watch('names', function() {
        $scope.timesChanged++;
    });
}​ 
```

我希望会发生的是，`'names'`每次调用时都会调用 for 的回调`names.push()`。是否有为此推荐的解决方法？或者我只是没有`$watch`正确使用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-11T23:05:23.233

您是对的，出于性能原因，默认情况下进行角度检查以供参考。引用与相等的使用取决于 $watch 函数的第三个参数的值，如您[在 docs](http://docs.angularjs.org/api/ng.$rootScope.Scope#$watch)中所见。只需将其设置为 true（默认情况下为 false），您的小提琴就可以工作了 -[就在这里，工作正常。](http://jsfiddle.net/HEzxZ/1/)

改变：

```
$scope.$watch('names', function() {
        $scope.timesChanged++;
    }, true); 
```

编辑 - 性能影响：

根据变量的大小和复杂性，比较两个数组/对象的效率显然非常低（因此默认情况下通过参考角度进行检查）。还有一种替代方法——观察数组的长度。这有明显的局限性——改变一个元素不再触发 $watch 功能——但可以非常快。这是一个[更新的小提琴](http://jsfiddle.net/HEzxZ/8/)！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T20:58:32.567

只是一个快速的补充：

如果你想看更多*特别*的东西，你可以这样做：

```
$scope.$watch(function() {
    // Define what you are watching for
    // For example convert your array into a string
    return String($scope.names);
}, function(newValue, oldValue) {
    // Do something cool.
}); 
```

这绝对没有那么快，`names.length`但您可以四处玩耍并找到一个复杂的解决方案。

如果有人有兴趣，我会使用修改后的 Duff 设备进行快速散列：http: [//jsfiddle.net/flek/mfKT6/1/](http://jsfiddle.net/flek/mfKT6/1/)如果您正在处理大量数据，此散列方法也可以更新为错误响应式（例如仅每隔 2 或 3 个字符散列）

# c++ - 重载比较运算符 == C++

> ID：13829704
> 
> 赞同：0
> 
> 时间：2012-12-11T22:39:35.653
> 
> 标签：c++, compiler-errors, operator-overloading, comparator

我有一个带有 3 个实例变量的基类 Person。Person(string name, unsigned long id, string email) 和一个继承 Person 并有一个新实例的派生类 Student var year Student(string name, unsigned long id,int year,string email): Person(name,id,email ) 和一位无需描述的班主任。

然后有一个名为 eClass 的类

我想重载比较运算符 == 并在编译我的 .cpp 时在函数 bool exists() 中使用该运算符我有那个错误

**错误：无法在'eClass 中定义成员函数'Student::operator=='** 任何人都可以帮助我吗？

我也不明白**const**

在我的代码的那个功能中。那是做什么的？

bool Student::operator==(const Student* &scnd) **const** {... ... ...}

```
eClass{
  private:
  Teacher* teacher;
  string eclass_name;
  Student* students[MAX_CLASS_SIZE];
  unsigned int student_count;

   public:
   eClass(Teacher* teach, string eclsnm){
   teacher=teach;
   eclass_name=eclsnm;
  }
   bool Student::operator==(const Student* &scnd)const{
         return(getID==scnd.getID
         &&getName==scnd.getName
         &&getYear==scnd.getYear
         &&getEmail==scnd.getEmail);

   }
   bool exists(Student* stud){
       for(int i=0; i<MAX_CLASS_SIZE;++i){
       if(stud==students[i]){return TRUE;}
       }
       return FALSE;
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:44:06.533

您正在尝试在 eClass 中声明 Student 比较方法。您显示的 operator== 基本上应该属于 Student，而不是 eClass。在这种情况下， const 将保证指针不会以任何方式更改，当您希望简单地比较两个对象时绝对不希望这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T23:26:34.480

您应该将比较运算符移动到`Student`类中，仅使用引用（而不是对指针的引用），最后您在方法调用中缺少大括号

```
class Student : public Person {
public:
   bool operator==(const Student &scnd)const{
         return getID()==scnd.getID()
         && getName()==scnd.getName()
         && getYear()==scnd.getYear()
         && getEmail()==scnd.getEmail();
   }
}; 
```

但是你真正应该做的是将比较运算符的一部分移到`Person`班级并在你的学生班级中使用它

```
class Person {
public:
   bool operator==(const Person &scnd)const{
         return getID()==scnd.getID()
         && getName()==scnd.getName()
         && getEmail()==scnd.getEmail();
   }
};

class Student : public Person {
public:
   bool operator==(const Student &scnd)const{
         return Person::operator==(scnd)
         && getYear()==scnd.getYear();
   }
}; 
```

在您的`exists()`方法中，您将指针与学生进行比较。您不需要比较运算符即可。

# cloud-foundry - openstack iaas 上的 cloudfoundry - 了解堆栈

> ID：13829705
> 
> 赞同：0
> 
> 时间：2012-12-11T22:39:36.313
> 
> 标签：cloud-foundry, iaas

我正在使用 Openstack 作为 IaaS 候选者评估 cloudfoundry（私有云选项）。我有以下设置，但看起来我缺少一些连接 -

1.  我将安装 OpenStack
2.  在 openstack（ubuntu 10.4 映像）上的一个 VM 上，我将安装 cloudfoundry cloud_controller
3.  在 openstack 上的其他多个虚拟机上，我将安装 cloudfoundry DEA
4.  我理解这称为云代工厂的多主机安装
5.  现在，当我使用 VMC（有 5 个实例请求）将应用程序推送到 cloudfoundry 时，其中一个 Cloudfoundry DEA 将在其自身上生成 5 个 VM，并在所有 5 个 cloudfoundry VM 上部署/运行该应用程序
6.  这意味着我有 5 个我的应用程序正在运行
7.  我可以通过单个 URL 访问应用程序，cloudnfoundry 控制器/路由器会将请求路由到我的应用程序的一个正在运行的实例
8.  现在为了扩展基础设施，我可以重新配置我的 openstack 实例并使用新配置重新启动它们（即更大的容量、更多的 RAM 等）
9.  为了扩展应用程序，我可以简单地将更多实例添加到 cloudfoundry vmc push 命令

很抱歉这篇文章，但请建议这是否是一个有效的理解（如果你们有更好的选择 - 基本上我们正在为开发人员寻找一个可扩展的应用程序和基础设施）

非常感谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T20:42:14.127

Vcap OSS 问题最好直接转到[vcap 开发站点](https://groups.google.com/a/cloudfoundry.org/forum/?fromgroups#!forum/vcap-dev)，我建议您从那里开始。

# asp.net - 对象 ' 的 SELECT 权限被拒绝 '，数据库' '，模式'dbo'。- ASP.NET/SQL 服务器

> ID：13829709
> 
> 赞同：5
> 
> 时间：2012-12-11T22:39:44.800
> 
> 标签：asp.net, sql-server

我有一个数据库“样本”。Active Directory (AD) 中有一个名为“CORPHQ\King”的用户。我已按照以下步骤操作：

```
1) Go to SQL Server Management Studio (2005) and "Security -> Logins".
2) Right Click -> New Login
3) Login Name : CORPHQ\King
4) Selected "Windows Authentication"
5) Default database - "Sample".
6) Under "User Mapping" section, Selected the "Sample" database, User as "CORPHQ\King" and selected "dbo" as default schema.
7) Selected "db_owner" as "Database role membership for - Sample". 
```

现在在 ASP.NET 应用程序的 WEB.CONFIG 中，我确实有：

```
<connectionStrings>
    <add name="DB" connectionString="Data Source=128.127.126.25; database=Sample; user=corphq\King; password=XXXXXXXXXXX; Integrated Security=SSPI;" providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

现在，当我运行 ASP.NET 应用程序时，我收到了提到的错误：

```
Error:

The SELECT permission was denied on the object 'tbl_Student', database 'Sample', schema 'dbo' 
```

我认为用户“CORPHQ\King”拥有“db_owner”对“Sample”数据库的访问权限。我对么 ？我在哪里失踪？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T22:48:44.820

由于您`Integrated Security`在连接字符串中指定，因此在使用 Windows 身份验证时不应指定用户名和密码。

相反，您将使用运行 ASP.NET 的任何域帐户进行身份验证，这可能是网络服务帐户。

您的应用程序可能以与 完全不同的用户身份连接`CORPHQ\King`，并且此其他登录没有此操作的权限。

有关更多详细信息，请参阅[如何：在 ASP.NET 2.0 中使用 Windows 身份验证连接到 SQL Server](http://msdn.microsoft.com/en-us/library/ff647396.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T22:46:32.597

您可能已授予它连接数据库的权限，但应该有进一步的步骤来授予用户特定权限，例如对该数据库中的表的 SELECT、INSERT、UPDATE 和 DELETE。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-12T05:25:43.720

解决这个问题的方法是打开 dbo 模式转到属性并单击查看数据库权限链接。授予数据库选择，删除 DOMAIN\MACHINENAME$ 的编辑权限。用户。

# macos - Mac 更改 IP 总长度字段

> ID：13829712
> 
> 赞同：4
> 
> 时间：2012-12-11T22:39:57.223
> 
> 标签：macos, sockets, ip, wireshark

我正在使用 Mac 10.6.8 中的套接字进行编程。每当我收到一个数据包时，它都会从 IP 标头开始。我一直在使用 Wireshark 来分析传入的数据包，我注意到我机器的套接字实现会不断地更改 IP 标头中的“总长度”字段。具体来说，它将减去 IP 标头长度并反转字节（从网络到主机顺序）。

例如，这是 Wireshark 报告的 IP 标头的开头：

```
45 c0 00 38 ... 
```

分解如下：

*   4 位 (0x4)：IP 版本：4
*   4 位 (0x5)：IP 标头长度：5 个字（20 字节）
*   8 位 (0xc0)：区分服务标志
*   16位（0x0038）：总长度：56字节

但是，当我打印为同一个数据包填充的缓冲区内容时`recvfrom`，我得到了不同的 lede：

```
ssize_t recvbytes = recvfrom(sock->fd, buffer, size, /*flags=*/0,
  (struct sockaddr*)src, &src_len); 
```

返回

```
45 c0 24 00 ... 
```

*   4 位 (0x4)：IP 版本：4
*   4 位 (0x5)：IP 标头长度：5 个字（20 字节）
*   8 位 (0xc0)：区分服务标志
*   16 位（0x2400）：总长度：9216 字节（？！）

我发现在访问缓冲区之前，套接字实现是读取总长度，减去 IP 标头长度，然后按主机顺序（我机器上的小端序）而不是网络顺序（大端序）写回. 在此示例中，这意味着：

*   读取总长度：0x0038 = 56
*   减去标题长度：56 - 20 = 36
*   按主机顺序写回：36 = 0x0024（大端）= 0x2400（小端=我机器上的主机顺序）

问题变得更糟。它不仅会改变最外层 IP 标头的总长度。它还将更改内部 IP 报头的总长度字段，例如，埋在 ICMP“超时”消息中的字段（它必须包括丢弃数据包的原始 IP 报头）。更有趣的是，它不会从内部标头中减去 IP 标头长度；它只是颠倒了字节顺序。

这是否发生在其他人身上？它是我不知道的标准的一部分吗？有没有办法修复我机器的套接字实现以停止篡改数据包？Wireshark 如何解决这个问题？

提前感谢您的考虑。

编辑：我的代码和 Makefile[在 GitHub 上可用](https://github.com/thejohnfreeman/netutils)。我编写了一个`fixip_osx`函数来验证 IP 校验和：

[https://github.com/thejohnfreeman/netutils/blob/master/lib/ip.c](https://github.com/thejohnfreeman/netutils/blob/master/lib/ip.c)

```
void fixip_osx(struct ip* ip) {
  /* Something on my Mac subtracts the header length from `ip_len` and stores
   * it in host order (little endian). */
  u16_t ip_hdrlen = ip->ip_hl << 2;
  u16_t ip_totlen = ip->ip_len + ip_hdrlen;
  ip->ip_len = htons(ip_totlen);
} 
```

但是，当有效负载包含另一个 IP 标头时，验证 ICMP 校验和仍然是一个问题。

无论我使用 Clang 3.2（从主干构建）还是 GCC 4.7（MacPorts 端口）编译都存在问题，所以我认为问题在于套接字实现（与 Mac OS 一起打包）或 Mac OS X 本身。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T14:31:26.303

BSD 平台套件（不包括 OpenBSD）以主机字节顺序显示 IP 偏移量和长度。接收到的网络字节顺序中存在的所有其他平台。这是一个“功能”，在[IP(4) - Internet Protocol](http://www.unix.com/man-page/FreeBSD/4/ip/) (FreeBSD, [OS X](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man4/ip.4.html) ) 的手册页中有引用。

> ip_len 和 ip_off 字段必须按主机字节顺序提供。所有其他字段必须按网络字节顺序提供。

`packet length - IP header length`在 FreeBSD/NetBSD 中IP 长度可以相等。

参考：*Stevens/Fenner/Rudolph，Unix Network Programming Vol.1，p.739*

我必须通过 PGM 网络协议的用户空间实现来处理这些异常，具体代码：

[https://code.google.com/p/openpgm/source/browse/trunk/openpgm/pgm/packet_parse.c#76](https://code.google.com/p/openpgm/source/browse/trunk/openpgm/pgm/packet_parse.c#76)

检测 AutoConf 实际上很烦人，我认为所有软件包都在每个平台上进行了硬编码。我看到了本周针对这个问题提出的错误报告（[错误地检测到标头字节顺序配置选项）。](https://code.google.com/p/openpgm/issues/detail?id=27)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T23:31:23.427

Mac 本身不太可能这样做。如果是这样，那将从根本上破坏 IP 协议。更有可能的是捕获数据包并将它们传送到`recvfrom()`（大概您正在执行混杂的网络捕获，对吗？）是在 Mac 完成处理数据之后转换数据的原因。ireshark 在较低级别上运行，可以访问实际的网络数据。

# jquery - Jquery Ajax请求不发送帖子数据

> ID：13829713
> 
> 赞同：2
> 
> 时间：2012-12-11T22:40:02.340
> 
> 标签：jquery, ajax, json, post, knockout.js

我正在使用 Jquery`$.ajax`方法成功地进行 AJAX 调用，因为它发布到的文件正在被调用和执行。但是，没有发送 POST 数据。我要做的就是发送数据并让文件接收它；我不在乎返回数据。

我尝试将其更改为 GET，但没有产生结果。我在收到的 URL 中传递了 GET 数据（显然，我猜）。我也尝试过更改我发送的数据类型......这些都没有让我知道我做错了什么。我也在这里浏览了许多具有类似标题的问题，但似乎没有任何东西可以解决这个问题。虽然我确信这很简单。

其他可能相关的变量：我正在使用 Knockout JS。我正在使用 .htaccess 重定向在 /public 文件夹中创建单个入口点。

事不宜迟，代码如下：

## page.html

```
<button data-bind="click: save">Save</button> 
```

如果你对 KOJS 不熟悉，它基本上只是在单击时调用函数 save。我很确定这工作正常。

## 模型.js

```
self.save = function() {
    var jsonData = ko.toJSON(self.tasks);
    $.ajax("http://test.local.com/js/post.php", {
        data: jsonData,
        type: "post", contentType: "application/json",
        success: function(result) { alert(jsonData) }
    });
}; 
```

该警报给了我一个格式很好的 JSON 对象，比如

```
[{"title": "Clean up the dog"},{"title": "Warm up the old pasta"}] 
```

这是帖子文件，我想，我的错误在哪里？$_POST 数组为空。如果我将其更改为以 GET 形式发送，那也是空的。我在代码中添加注释来解释事情。

## post.php

```
if (isset($_POST)) {
  //It does get inside this if. That's good at least, right?

  $my_file = 'file.txt';
  $handle = fopen($my_file, 'w') or die('Cannot open file:  '.$my_file);
  //It will make this file.

  fwrite($handle, print_r($_POST));
  //Prints "1" without the quotes

  foreach ($_POST as $key => $value) {
    fwrite($handle, 'your data: '.$value.'; ');
  }
  //Prints nothing
} 
```

关于为什么这不会发送任何 POST 数据的任何想法？我敢肯定这很傻。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T22:50:06.997

您的问题是您设置`data`为 JSON 字符串。根据文档 jQuery 不会处理字符串数据，只有对象[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

而是使用`ko.toJS`获得一个干净的 JS 对象，这应该让你走上正确的道路。

[编辑]

我刚刚注意到您也在设置 contentType ...为此，您将无法使用`$_POST`var。相反，您需要从`file_get_contents("php://input")`“应该”获取原始 JSON 字符串的数据。从那里你应该能够使用 PHP`json_decode`将它变成一个真正的 PHP 对象。

# c++ - 在 C++ 中将 const 引用传递给临时字符串对象是否安全？

> ID：13829714
> 
> 赞同：1
> 
> 时间：2012-12-11T22:40:04.860
> 
> 标签：c++

考虑函数 f

```
void f(const std::string& s) {
    ...
} 
```

使用固定字符串调用 f 是否安全，如下所示：

```
f("abc"); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-11T22:44:32.073

`std::string`隐式构造 from的生命周期`"abc"`是直到调用`f()`结束。只要您在`f()`结束后不将该参考保留在其他地方，它就非常安全。

```
std::string const *pstr;

void f(std::string const &s)
{
    s.length(); // safe. s has an instance backing
                // it for the lifetime of this function.

    pstr = &s; // still technically safe, but only if you don't
               // dereference pstr after this function completes.
}

f("abc");

pstr->length(); // undefined behavior, the instance
                // pstr pointed to no longer exists. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T22:44:45.257

Assuming you don't store a reference or a pointer to the argument somewhere and hope that it is still around once you returned from the function, it should be OK: when the function is called, a temporary `std::string` is created which is around for the time the function is executed.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T22:43:09.173

函数返回后不使用是安全的。

因此，使用它来初始化另一个字符串对象（在函数返回之前）也是安全的，即使这个字符串对象的寿命更长（并且使用时间更长）。

# c# - 选中复选框后删除面板

> ID：13829719
> 
> 赞同：0
> 
> 时间：2012-12-11T22:40:34.363
> 
> 标签：c#, methods, checkbox

我有一个生成多个面板的代码，每个面板都包含一些标签和组合框。每个面板中包含的控件之一是一个复选框，我需要做的是，当用户选中该复选框时，该复选框所在的整个面板将被删除。在生成面板的 foreach 循环中，可以使用名称“Strip”访问面板本身。在这个循环之外，如果我要传输所有必要的参数（或参数，不确定这里的术语），它会在它的标签之一“呼号”之后被调用，所以当我需要将它的名字放到一个方法中时，我设置为参数“callsign.Text”。现在，这是我的 Checkbox 生成代码：

```
CheckBox check = new CheckBox();
check.Location = new Point(270, 10);
check.Name = "check:" + callsign.Text;
check.CheckedChanged += new System.EventHandler(CheckCheckedChanged(callsign.Text));
Strip.Controls.Add(check); 
```

这里是方法 CheckCheckedChanged 的​​定义：

```
public void CheckCheckedChanged(string callsign, object sender, EventArgs e)
{
} 
```

...首先，我在一行出现错误`check.CheckedChanged += new System.EventHandler(CheckCheckedChanged(callsign.Text));` 它说，“方法没有重载`CheckCheckedChanged`需要 1 个参数”。我不知道怎么了，所以这是我的第一个问题。第二个是 - 我不知道如何编写删除以 callsign.Text 命名的特定面板的方法，如果我只写“callsign dispose”，那么我想它不会起作用。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:46:14.430

您需要做的第一件事是`string callsign`从事件处理程序中删除参数。这就是导致编译器错误的原因。因此，您的方法签名将如下所示：

```
public void CheckCheckedChanged(object sender, EventArgs e) 
```

其次，您需要更改事件附加到事件处理程序的方式：

```
check.CheckedChanged += new System.EventHandler(CheckCheckedChanged(callsign.Text)); 
```

会变成：

```
check.CheckedChanged += new System.EventHandler(CheckCheckedChanged); 
```

接下来，您要将代码放入事件处理程序中以获取复选框的状态并相应地设置面板的可见性。您将使用面板的名称替换面板。

```
public void CheckCheckedChanged(object sender, EventArgs e)
{
    CheckBox checkbox = sender as CheckBox;
    if (checkbox != null)
    {
        ((Panel)checkbox.Parent).Visible = !checkbox.Checked;  // replace this with your panel
    }
} 
```

# php - 通过 PHP 调用 xmlhttp.onreadystatechange=function()

> ID：13829723
> 
> 赞同：0
> 
> 时间：2012-12-11T22:40:53.557
> 
> 标签：php, xmlhttprequest, onreadystatechange

所以，这里是问题：

我正在尝试处理传递 ID 字段的 PHP 文件中的一些编辑。PHP 文件正在成功构建 HTML 页面并显示它，但嵌入的 javascript 调用的某些部分无法正常工作。

如果我注释掉调用 echo ' xmlhttp.onreadystatechange=function(){'; 我收到所有警报。

一旦我取消注释 xmlhttp.onreadystatechange=function() 块，什么都不起作用。

任何帮助将不胜感激 - 以下是完整的代码块：

```
echo '<script type="text/javascript">';
echo 'function populateRoomDropDown(building)';
echo '{';
echo '  alert("Started...");';
echo '  if(window.XMLHttpRequest){';
echo '      xmlhttp = new XMLHttpRequest();';
echo '      alert("Building ID: "+building);';
echo '  }';
echo '  else{';
echo '      xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");';
echo '      alert("IE Browser");';
echo '  }';
echo '  xmlhttp.onreadystatechange=function(){';
echo '      alert("Inside onready...()");';
echo '          if (xmlhttp.readyState==4 && xmlhttp.status==200){';
echo '          alert("Inside onready...()");';
echo '          document.getElementById("displayRooms").innerHTML=xmlhttp.responseText;';
echo '          }';
echo '  }';
echo '  alert("Near end...");';
echo '  xmlhttp.open("GET","../db_queries/getRoomsDropDown.php?buildingID="+building,true);';
echo '  xmlhttp.send();';
echo '  alert("End...");';
echo '}';
echo '</script>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:54:29.503

Try:

```
echo '<script type="text/javascript">';
echo 'function populateRoomDropDown(building)';
echo '{';
echo '  alert("Started...");';
echo '  if(window.XMLHttpRequest){';
echo '      xmlhttp = new XMLHttpRequest();';
echo '      alert("Building ID: "+building);';
echo '  }';
echo '  else{';
echo '      xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");';
echo '      alert("IE Browser");';
echo '  }';
echo '  xmlhttp.open("GET","../db_queries/getRoomsDropDown.php?buildingID="+building,true);';
echo '  xmlhttp.onreadystatechange=function(){';
echo '      alert("Inside onready...()");';
echo '          if (xmlhttp.readyState==4 && xmlhttp.status==200){';
echo '          alert("Inside onready...()");';
echo '          document.getElementById("displayRooms").innerHTML=xmlhttp.responseText;';
echo '          }';
echo '  }';
echo '  alert("Near end...");';
echo '  xmlhttp.send();';
echo '  alert("End...");';
echo '}';
echo '</script>'; 
```

I moved `xmlhttp.open("GET","../db_queries/getRoomsDropDown.php?buildingID="+building,true);` above `xmlhttp.onreadystatechange=function()`

# visual-studio-2010 - Visual Studios 2010 Windows Phone 7 到 XNA 4.0

> ID：13829727
> 
> 赞同：1
> 
> 时间：2012-12-11T22:41:08.980
> 
> 标签：visual-studio-2010, windows-phone-7, sdk, development-environment, xna-4.0

我目前在学校使用 Microsoft Visual Studio 2010。我最近完成了一个 Window Phone 7 平台的项目，现在正在开发一个 XNA3D 项目，但是我似乎无法将我的 SDK 环境从 WP7 更改为 XNA。

我打开了以前使用 XNA 框架启动的项目，但 Visual Studios 使用 Windows Phone 7 打开，而不是 XNA。我尝试创建一个新项目并将其创建为 XNA 4.0，但是当 Visual Studios 加载我的工作区时，它仍在使用屏幕顶部下拉菜单中的 Windows Phone 7 标题。该程序仍会加载所需的 XNA 框架，并将我的程序作为 XNA 运行，并且不会加载 Windows Phone 7 模拟器，所以这不是一个大问题，但它是一个烦恼，而且两者都没有我自己，我的老师也解决不了。我玩过一些设置和属性，但似乎没有任何改变。VS2010 甚至不允许我单击下拉箭头并选择 XNA，它是灰色的。

我要问的是，以前有没有人遇到过这个问题，如果有，您是如何解决的？或者，你知道我该如何解决这个问题并继续我的作业吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-09T05:57:28.240

Visual Studio 使用唯一的 projectID 标识项目。我想这就是你的情况。我强烈建议您将 Visual Studio 更新到 2012，这很好，您也可以在那里使用 XNA。[这](https://stackoverflow.com/questions/10881005/how-to-install-xna-game-studio-on-visual-studio-2012)是解释细节的stackoverflow问题。它也可以解决您的问题。

还有另一种方法，您可以创建新的 XNA 项目并将所有文件链接到该项目。大多数事情都在那里工作。通常我会在创建 [Monogame] ( [http://monogame.net/](http://monogame.net/) )时这样做，这*是 XNA 的一个不错的开源端口*。

我希望我能正确理解您的问题并能够回答。如果需要任何具体或更多细节，请告诉我。

# regex - 关于数字的正则表达式

> ID：13829729
> 
> 赞同：-1
> 
> 时间：2012-12-11T22:41:16.517
> 
> 标签：regex

如果我只想包含不超过 31 的数字，这个正则表达式是否有效？

'[^0-9>31]+ 或者它也会返回字母字符，我也必须以某种方式排除它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:43:59.500

您的正则表达式接受一个或多个字符，每个字符都不是以下之一

```
0 1 2 3 4 5 6 7 8 9 > 
```

你想要的是：

```
/^(?:[0-9]|[12][0-9]|3[01])$/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T22:51:36.570

正则表达式不是文本的声波螺丝刀，能够神奇地做你可能想要的一切。正则表达式中没有任何内容可以检查数字的值。

您需要做的是两个步骤，这里用 Perl 编写。

```
$ok = ($s =~ /^\d{1,2}$/) && ($s < 31); 
```

这将检查`$s`字符串开头 ( `^`)、一位或两位数字 ( `\d{1,2}`) 以及字符串结尾 ( `$`) 的值。如果这是真的，那么它还会检查 的数值`$s`是否小于 31。

是的，您可以使用 Ray Toal 的回答中这样的复杂正则表达式：

```
/^(?:[0-9]|[12][0-9]|3[01])$/ 
```

但这远不那么可读。

# jasper-reports - 查找表中的列数

> ID：13829731
> 
> 赞同：0
> 
> 时间：2012-12-11T22:41:24.240
> 
> 标签：jasper-reports

我想知道如何知道在*iReport*中创建的表中的列数。变量**COLUMN_COUNT**返回行数，但我想知道列数。

有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T12:25:35.760

[***JasperReports Ultimate Guide***](http://jasperreports.sourceforge.net/JasperReports-Ultimate-Guide-3.pdf)的引述：

# `BUILT-IN REPORT VARIABLES`

`**COLUMN_NUMBER**
This variable contains the current column number. For example, on a report with three columns, the possible values are 1, 2, and 3\. The variable restarts from 1 and runs up to the defined number of columns for each page in the generated document.

**COLUMN_COUNT**
This variable contains the number of records that were processed when generating the current column.

**PAGE_NUMBER**
This variable’s value is its current page number. At the end of the report-filling process, it will contain the total number of pages in the document. It can be used to display both the current page number and the total number of pages using a special feature of JasperReports text field elements, the evaluationTime attribute. You can see this happening in most of the samples. Check the /demo/samples/jasper sample for an example.

**REPORT_COUNT**
After finishing the iteration through the data source, this report variable contains the total number of records processed.

**PAGE_COUNT**
This variable contains the number of records that were processed when generating the current page.

**GroupName_COUNT**
When declaring a report group, the engine automatically creates a count variable that calculates the number of records that make up the current group (that is, the number of records processed between group ruptures). The name of this variable is derived from the name of the group it corresponds to, suffixed with the _COUNT sequence. It can be used like any other report variable, in any report expression, even in the current group expression, as shown in the BreakGroup group of the /demo/samples/jasper sample).`

# c# - 在 xUnit.net 中的所有测试之前和之后运行一次代码

> ID：13829737
> 
> 赞同：99
> 
> 时间：2012-12-11T22:42:10.200
> 
> 标签：c#, automated-tests, xunit.net

TL；DR - 我正在寻找 xUnit 的 MSTest 等价物`AssemblyInitialize`（也就是我喜欢的 ONE 功能）。

具体来说，我正在寻找它，因为我有一些 Selenium 烟雾测试，我希望能够在没有其他依赖项的情况下运行。我有一个 Fixture 将为我启动 IisExpress 并在处置时将其杀死。但是在每次测试之前这样做会极大地膨胀运行时。

我想在测试开始时触发此代码一次，并在最后处理它（关闭进程）。我怎么能这样做呢？

即使我可以通过编程方式访问诸如“当前正在运行多少测试”之类的内容，我也可以弄清楚一些事情。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2015-11-18T11:05:50.577

截至 2015 年 11 月，xUnit 2 已经发布，因此有一种规范的方式可以在测试之间共享功能。它记录[在这里](https://xunit.github.io/docs/shared-context.html#collection-fixture)。

基本上你需要创建一个做夹具的类：

```
 public class DatabaseFixture : IDisposable
    {
        public DatabaseFixture()
        {
            Db = new SqlConnection("MyConnectionString");

            // ... initialize data in the test database ...
        }

        public void Dispose()
        {
            // ... clean up test data from the database ...
        }

        public SqlConnection Db { get; private set; }
    } 
```

带有该`CollectionDefinition`属性的虚拟类。此类允许 Xunit 创建一个测试集合，并将给定的夹具用于该集合的所有测试类。

```
 [CollectionDefinition("Database collection")]
    public class DatabaseCollection : ICollectionFixture<DatabaseFixture>
    {
        // This class has no code, and is never created. Its purpose is simply
        // to be the place to apply [CollectionDefinition] and all the
        // ICollectionFixture<> interfaces.
    } 
```

然后，您需要在所有测试类中添加集合名称。测试类可以通过构造函数接收夹具。

```
 [Collection("Database collection")]
    public class DatabaseTestClass1
    {
        DatabaseFixture fixture;

        public DatabaseTestClass1(DatabaseFixture fixture)
        {
            this.fixture = fixture;
        }
    } 
```

它比 MsTests 更冗长，`AssemblyInitialize`因为您必须在每个测试类上声明它属于哪个测试集合，但它也更具可模块化性（并且使用 MsTests 您仍然需要在您的类上放置一个 TestClass）

注意：样本取自[文档](https://xunit.github.io/docs/shared-context.html#collection-fixture)。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2018-11-04T17:23:20.123

要在程序集初始化时执行代码，可以这样做（使用 xUnit 2.3.1 测试）

```
using Xunit.Abstractions;
using Xunit.Sdk;

[assembly: Xunit.TestFramework("MyNamespace.MyClassName", "MyAssemblyName")]

namespace MyNamespace
{   
   public class MyClassName : XunitTestFramework
   {
      public MyClassName(IMessageSink messageSink)
        :base(messageSink)
      {
        // Place initialization code here
      }

      public new void Dispose()
      {
        // Place tear down code here
        base.Dispose();
      }
   }
} 
```

另请参阅[https://github.com/xunit/samples.xunit/tree/master/AssemblyFixtureExample](https://github.com/xunit/samples.xunit/tree/master/AssemblyFixtureExample)

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2013-02-19T06:03:42.703

创建一个静态字段并实现一个终结器。

您可以使用 xUnit 创建一个 AppDomain 来运行您的测试程序集并在完成时将其卸载的事实。卸载应用程序域将导致终结器运行。

我正在使用这种方法来启动和停止 IISExpress。

```
public sealed class ExampleFixture
{
    public static ExampleFixture Current = new ExampleFixture();

    private ExampleFixture()
    {
        // Run at start
    }

    ~ExampleFixture()
    {
        Dispose();
    }

    public void Dispose()
    {
        GC.SuppressFinalize(this);

        // Run at end
    }        
} 
```

编辑：访问测试中使用的夹具`ExampleFixture.Current`。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-12-19T15:41:38.257

在今天的框架中是不可能的。这是 2.0 计划的功能。

为了在 2.0 之前完成这项工作，您需要对框架进行重大的重新架构，或者编写自己的运行程序来识别您自己的特殊属性。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-06-14T02:00:14.253

我使用[AssemblyFixture](https://github.com/kzu/xunit.assemblyfixture) ( [NuGet](https://www.nuget.org/packages/xunit.assemblyfixture/) )。

它的作用是提供一个`IAssemblyFixture<T>`接口，该接口替换`IClassFixture<T>`您希望对象生命周期作为测试程序集的任何位置。

例子：

```
public class Singleton { }

public class TestClass1 : IAssemblyFixture<Singleton>
{
  readonly Singletone _Singletone;
  public TestClass1(Singleton singleton)
  {
    _Singleton = singleton;
  }

  [Fact]
  public void Test1()
  {
     //use singleton  
  }
}

public class TestClass2 : IAssemblyFixture<Singleton>
{
  readonly Singletone _Singletone;
  public TestClass2(Singleton singleton)
  {
    //same singleton instance of TestClass1
    _Singleton = singleton;
  }

  [Fact]
  public void Test2()
  {
     //use singleton  
  }
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-10-14T21:07:26.930

我对在所有 xUnit 测试结束时没有执行任务的选项感到非常恼火。这里的一些选项不是很好，因为它们涉及更改所有测试或将它们放在一个集合下（意味着它们会同步执行）。但是 Rolf Kristensen 的回答为我提供了获取此代码所需的信息。它有点长，但您只需将其添加到您的测试项目中，无需其他代码更改：

```
using Siderite.Tests;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Reflection;
using System.Text;
using Xunit;
using Xunit.Abstractions;
using Xunit.Sdk;

[assembly: TestFramework(
    SideriteTestFramework.TypeName,
    SideriteTestFramework.AssemblyName)]

namespace Siderite.Tests
{
    public class SideriteTestFramework : ITestFramework
    {
        public const string TypeName = "Siderite.Tests.SideriteTestFramework";
        public const string AssemblyName = "Siderite.Tests";
        private readonly XunitTestFramework _innerFramework;

        public SideriteTestFramework(IMessageSink messageSink)
        {
            _innerFramework = new XunitTestFramework(messageSink);
        }

        public ISourceInformationProvider SourceInformationProvider
        {
            set
            {
                _innerFramework.SourceInformationProvider = value;
            }
        }

        public void Dispose()
        {
            _innerFramework.Dispose();
        }

        public ITestFrameworkDiscoverer GetDiscoverer(IAssemblyInfo assembly)
        {
            return _innerFramework.GetDiscoverer(assembly);
        }

        public ITestFrameworkExecutor GetExecutor(AssemblyName assemblyName)
        {
            var executor = _innerFramework.GetExecutor(assemblyName);
            return new SideriteTestExecutor(executor);
        }

        private class SideriteTestExecutor : ITestFrameworkExecutor
        {
            private readonly ITestFrameworkExecutor _executor;
            private IEnumerable<ITestCase> _testCases;

            public SideriteTestExecutor(ITestFrameworkExecutor executor)
            {
                this._executor = executor;
            }

            public ITestCase Deserialize(string value)
            {
                return _executor.Deserialize(value);
            }

            public void Dispose()
            {
                _executor.Dispose();
            }

            public void RunAll(IMessageSink executionMessageSink, ITestFrameworkDiscoveryOptions discoveryOptions, ITestFrameworkExecutionOptions executionOptions)
            {
                _executor.RunAll(executionMessageSink, discoveryOptions, executionOptions);
            }

            public void RunTests(IEnumerable<ITestCase> testCases, IMessageSink executionMessageSink, ITestFrameworkExecutionOptions executionOptions)
            {
                _testCases = testCases;
                _executor.RunTests(testCases, new SpySink(executionMessageSink, this), executionOptions);
            }

            internal void Finished(TestAssemblyFinished executionFinished)
            {
                // do something with the run test cases in _testcases and the number of failed and skipped tests in executionFinished
            }
        }

        private class SpySink : IMessageSink
        {
            private readonly IMessageSink _executionMessageSink;
            private readonly SideriteTestExecutor _testExecutor;

            public SpySink(IMessageSink executionMessageSink, SideriteTestExecutor testExecutor)
            {
                this._executionMessageSink = executionMessageSink;
                _testExecutor = testExecutor;
            }

            public bool OnMessage(IMessageSinkMessage message)
            {
                var result = _executionMessageSink.OnMessage(message);
                if (message is TestAssemblyFinished executionFinished)
                {
                    _testExecutor.Finished(executionFinished);
                }
                return result;
            }
        }
    }
} 
```

亮点：

*   程序集：TestFramework 指示 xUnit 使用您的框架，该框架代理到默认框架
*   SideriteTestFramework 还将执行器包装到自定义类中，然后包装消息接收器
*   最后，执行 Finished 方法，其中包含运行的测试列表和来自 xUnit 消息的结果

在这里可以做更多的工作。如果你想在不关心测试运行的情况下执行一些东西，你可以从 XunitTestFramework 继承并只包装消息接收器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-02-01T12:13:26.460

您可以使用 IUseFixture 接口来实现这一点。此外，您的所有测试都必须继承 TestBase 类。您还可以直接从测试中使用 OneTimeFixture。

```
public class TestBase : IUseFixture<OneTimeFixture<ApplicationFixture>>
{
    protected ApplicationFixture Application;

    public void SetFixture(OneTimeFixture<ApplicationFixture> data)
    {
        this.Application = data.Fixture;
    }
}

public class ApplicationFixture : IDisposable
{
    public ApplicationFixture()
    {
        // This code run only one time
    }

    public void Dispose()
    {
        // Here is run only one time too
    }
}

public class OneTimeFixture<TFixture> where TFixture : new()
{
    // This value does not share between each generic type
    private static readonly TFixture sharedFixture;

    static OneTimeFixture()
    {
        // Constructor will call one time for each generic type
        sharedFixture = new TFixture();
        var disposable = sharedFixture as IDisposable;
        if (disposable != null)
        {
            AppDomain.CurrentDomain.DomainUnload += (sender, args) => disposable.Dispose();
        }
    }

    public OneTimeFixture()
    {
        this.Fixture = sharedFixture;
    }

    public TFixture Fixture { get; private set; }
} 
```

编辑：修复新夹具为每个测试类创建的问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-19T17:50:24.057

您的构建工具是否提供这样的功能？

在 Java 世界中，当使用[Maven](http://maven.apache.org/)作为构建工具时，我们会使用[构建生命周期的适当阶段](http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#Lifecycle_Reference)。例如，在您的情况下（使用类似 Selenium 的工具进行验收测试），可以充分利用`pre-integration-test`和阶段在一个人的s`post-integration-test`之前/之后启动/停止 webapp 。`integration-test`

我很确定可以在您的环境中设置相同的机制。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-02-24T00:35:26.140

**Jared Kells**描述的方法 在 Net Core 下不起作用，因为不能保证会调用终结器。而且，事实上，上面的代码并没有调用它。请参见：

[为什么 Finalize/Destructor 示例在 .NET Core 中不起作用？](https://stackoverflow.com/questions/44732234/why-does-the-finalize-destructor-example-not-work-in-net-core)

[https://github.com/dotnet/runtime/issues/16028](https://github.com/dotnet/runtime/issues/16028)

[https://github.com/dotnet/runtime/issues/17836](https://github.com/dotnet/runtime/issues/17836)

[https://github.com/dotnet/runtime/issues/24623](https://github.com/dotnet/runtime/issues/24623)

所以，基于上面的好答案，这就是我最终做的事情（根据需要替换保存到文件）：

```
public class DatabaseCommandInterceptor : IDbCommandInterceptor
{
    private static ConcurrentDictionary<DbCommand, DateTime> StartTime { get; } = new();

    public void ReaderExecuted(DbCommand command, DbCommandInterceptionContext<DbDataReader> interceptionContext) => Log(command, interceptionContext);

    public void NonQueryExecuted(DbCommand command, DbCommandInterceptionContext<int> interceptionContext) => Log(command, interceptionContext);

    public void ScalarExecuted(DbCommand command, DbCommandInterceptionContext<object> interceptionContext) => Log(command, interceptionContext);

    private static void Log<T>(DbCommand command, DbCommandInterceptionContext<T> interceptionContext)
    {
        var parameters = new StringBuilder();

        foreach (DbParameter param in command.Parameters)
        {
            if (parameters.Length > 0) parameters.Append(", ");
            parameters.Append($"{param.ParameterName}:{param.DbType} = {param.Value}");
        }

        var data = new DatabaseCommandInterceptorData
        {
            CommandText = command.CommandText,
            CommandType = $"{command.CommandType}",
            Parameters = $"{parameters}",
            Duration = StartTime.TryRemove(command, out var startTime) ? DateTime.Now - startTime : TimeSpan.Zero,
            Exception = interceptionContext.Exception,
        };

        DbInterceptorFixture.Current.LogDatabaseCall(data);
    }

    public void NonQueryExecuting(DbCommand command, DbCommandInterceptionContext<int> interceptionContext) => OnStart(command);
    public void ReaderExecuting(DbCommand command, DbCommandInterceptionContext<DbDataReader> interceptionContext) => OnStart(command);
    public void ScalarExecuting(DbCommand command, DbCommandInterceptionContext<object> interceptionContext) => OnStart(command);

    private static void OnStart(DbCommand command) => StartTime.TryAdd(command, DateTime.Now);
}

public class DatabaseCommandInterceptorData
{
    public string CommandText { get; set; }
    public string CommandType { get; set; }
    public string Parameters { get; set; }
    public TimeSpan Duration { get; set; }
    public Exception Exception { get; set; }
}

/// <summary>
/// All times are in milliseconds.
/// </summary>
public record DatabaseCommandStatisticalData
{
    public string CommandText { get; }
    public int CallCount { get; init; }
    public int ExceptionCount { get; init; }
    public double Min { get; init; }
    public double Max { get; init; }
    public double Mean { get; init; }
    public double StdDev { get; init; }

    public DatabaseCommandStatisticalData(string commandText)
    {
        CommandText = commandText;
        CallCount = 0;
        ExceptionCount = 0;
        Min = 0;
        Max = 0;
        Mean = 0;
        StdDev = 0;
    }

    /// <summary>
    /// Calculates k-th moment for n + 1 values: M_k(n + 1)
    /// based on the values of k, n, mkn = M_k(N), and x(n + 1).
    /// The sample adjustment (replacement of n -> (n - 1)) is NOT performed here
    /// because it is not needed for this function.
    /// Note that k-th moment for a vector x will be calculated in Wolfram as follows:
    ///     Sum[x[[i]]^k, {i, 1, n}] / n
    /// </summary>
    private static double MknPlus1(int k, int n, double mkn, double xnp1) =>
        (n / (n + 1.0)) * (mkn + (1.0 / n) * Math.Pow(xnp1, k));

    public DatabaseCommandStatisticalData Updated(DatabaseCommandInterceptorData data) =>
        CallCount == 0
            ? this with
            {
                CallCount = 1,
                ExceptionCount = data.Exception == null ? 0 : 1,
                Min = data.Duration.TotalMilliseconds,
                Max = data.Duration.TotalMilliseconds,
                Mean = data.Duration.TotalMilliseconds,
                StdDev = 0.0,
            }
            : this with
            {
                CallCount = CallCount + 1,
                ExceptionCount = ExceptionCount + (data.Exception == null ? 0 : 1),
                Min = Math.Min(Min, data.Duration.TotalMilliseconds),
                Max = Math.Max(Max, data.Duration.TotalMilliseconds),
                Mean = MknPlus1(1, CallCount, Mean, data.Duration.TotalMilliseconds),
                StdDev = Math.Sqrt(
                    MknPlus1(2, CallCount, Math.Pow(StdDev, 2) + Math.Pow(Mean, 2), data.Duration.TotalMilliseconds)
                    - Math.Pow(MknPlus1(1, CallCount, Mean, data.Duration.TotalMilliseconds), 2)),
            };

    public static string Header { get; } =
        string.Join(TextDelimiter.VerticalBarDelimiter.Key,
            new[]
            {
                nameof(CommandText),
                nameof(CallCount),
                nameof(ExceptionCount),
                nameof(Min),
                nameof(Max),
                nameof(Mean),
                nameof(StdDev),
            });

    public override string ToString() =>
        string.Join(TextDelimiter.VerticalBarDelimiter.Key,
            new[]
            {
                $"\"{CommandText.Replace("\"", "\"\"")}\"",
                $"{CallCount}",
                $"{ExceptionCount}",
                $"{Min}",
                $"{Max}",
                $"{Mean}",
                $"{StdDev}",
            });
}

public class DbInterceptorFixture
{
    public static readonly DbInterceptorFixture Current = new();
    private bool _disposedValue;
    private ConcurrentDictionary<string, DatabaseCommandStatisticalData> DatabaseCommandData { get; } = new();
    private static IMasterLogger Logger { get; } = new MasterLogger(typeof(DbInterceptorFixture));

    /// <summary>
    /// Will run once at start up.
    /// </summary>
    private DbInterceptorFixture()
    {
        AssemblyLoadContext.Default.Unloading += Unloading;
    }

    /// <summary>
    /// A dummy method to call in order to ensure that static constructor is called
    /// at some more or less controlled time.
    /// </summary>
    public void Ping()
    {
    }

    public void LogDatabaseCall(DatabaseCommandInterceptorData data) =>
        DatabaseCommandData.AddOrUpdate(
            data.CommandText,
            _ => new DatabaseCommandStatisticalData(data.CommandText).Updated(data),
            (_, d) => d.Updated(data));

    private void Unloading(AssemblyLoadContext context)
    {
        if (_disposedValue) return;
        GC.SuppressFinalize(this);
        _disposedValue = true;
        SaveData();
    }

    private void SaveData()
    {
        try
        {
            File.WriteAllLines(
                @"C:\Temp\Test.txt",
                DatabaseCommandData
                    .Select(e => $"{e.Value}")
                    .Prepend(DatabaseCommandStatisticalData.Header));
        }
        catch (Exception e)
        {
            Logger.LogError(e);
        }
    }
} 
```

然后`DatabaseCommandInterceptor`在测试的某个地方注册一次：

```
DbInterception.Add(new DatabaseCommandInterceptor()); 
```

我也更喜欢调用`DbInterceptorFixture.Current.Ping()`基础测试类，尽管我认为这不是必需的。

该界面`IMasterLogger`只是一个强类型的包装器`log4net`，所以只需将其替换为您最喜欢的。

的值`TextDelimiter.VerticalBarDelimiter.Key`是公正的`'|'`，它位于我们所说的闭集中。

PS如果我搞砸了统计数据，请发表评论，我会更新答案。

# netbeans-7 - java.lang.ClassFormatError：类文件中“列表”的 LVTT 条目

> ID：13829738
> 
> 赞同：0
> 
> 时间：2012-12-11T22:42:10.803
> 
> 标签：netbeans-7, weblogic-10.x

我有一个 Web 应用程序：IDE Netbeas 7.2 Weblogic server 11 g

这个 WApp 在 Tomcat 7.0.22 上编译运行

并且在 Weblogic 上也编译但不运行。错误：

**java.lang.ClassFormatError：类文件 [file.class] 中“列表”的 LVTT 条目**

任何的想法？？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:53:46.647

尝试使用`-g:none`. 也许这有助于解决变量表中的错误。

有关 javac 选项，请参见[此处](http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/javac.html#options)。

# css - 将鼠标悬停在点击离开触摸屏平板电脑/移动设备上

> ID：13829747
> 
> 赞同：3
> 
> 时间：2012-12-11T22:43:17.307
> 
> 标签：css

我有以下菜单，可以在桌面上完美运行。将鼠标悬停在项目上时，会出现二级菜单。

在平板电脑/移动设备上，这是点击/触摸

我希望在平板电脑/移动设备上单击时菜单悬停效果（触摸平板电脑）消失。

例如ipad，当点击我的列表时，二级菜单显示，但当点击离开菜单时需要它消失

这可能吗？

CSS：

```
* {outline:none; border:none; margin:0; padding:0; font:14px arial,sans-serif;}
body {background: url(images/bg.gif) repeat;}
#top {background: url(images/top_tile.png) repeat-x; height:140px; width:100%;}
.wrap {width:980px; margin:0 auto;}
#top1 {height:60px;}
.logo {padding-top:10px;}
#menu {height:48px;}
/*NAV*/
#nav{
    list-style:none;
    font-weight:bold;
    /* Clear floats */
    float:left;
    width:100%;
}
#nav li{
    float:left;
    margin-right:10px;
    position:relative;
}
#nav a{
    display:block;
    padding:20px 25px 7px 15px;
    color:#333;
    height:25px;
    text-decoration:none;
}
#nav a:hover{
    color:#fff;
    background:#ff9900;
    text-decoration:none;
}

/*--- DROPDOWN ---*/
#nav ul{
    background:#fff; 
    list-style:none;
    position:absolute;
    left:-9999px; 
    min-width:200px;
    border-radius:0px 0px 3px 3px;
    border:1px solid #ccc;
}
#nav ul li{
    padding-top:1px; 
    float:none;
    background:#fff;
    }
#nav ul a{
    white-space:nowrap; 
    font-size:13px;
    color:#666;
    padding: 10px 0px 5px 15px;
}
#nav li:hover ul{ 
    left:0; 

}
#nav li:hover a{
    background:#ff9900;
    text-decoration:none;
}
#nav li:hover ul a{
    text-decoration:none;
    background:#fff;

}
#nav li:hover ul li a:hover{
    background:#ff9900;
    color:#fff;
} 
```

HTML：

```
<body>
    <div id="top">
        <div id="top1" class="wrap"><img src="images/logo.gif" class="logo" /></div>
            <div id="menu" class="wrap">
                <ul id="nav">
                    <li><a href="#">My Lists</a>
                        <ul>
                            <li><a href="#">List 1</a></li>
                            <li><a href="#">List 2</a></li>
                            <li><a href="#">List 3</a></li>
                            <li><a href="#">View all Lists</a></li>
                        </ul>
                    </li>
                    <li><a href="/pages/following">Following</a>
                        <ul>
                            <li><a href="#">Follow 1</a></li>
                            <li><a href="#">Follow 2</a></li>
                            <li><a href="#">Follow 3</a></li>
                            <li><a href="#">View all Follows</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</body> 
```

[小提琴](http://jsfiddle.net/5mtJr/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T02:29:45.930

```
$(document).click(function() {
alert("me");
});

$(".myDiv").click(function(e) {
e.stopPropagation(); // This is the preferred method.
return false;        // This should not be used unless you do not want
                     // any click events registering inside the div
}); 
```

---正如这里提到的。[单击页面上的任何位置时jQuery隐藏元素](https://stackoverflow.com/questions/714471/jquery-hide-element-when-clicked-anywhere-on-the-page)

# twitter-bootstrap - 我可以在 twitter 引导程序中使用不同的网格系统吗？

> ID：13829750
> 
> 赞同：1
> 
> 时间：2012-12-11T22:43:40.293
> 
> 标签：twitter-bootstrap

是否可以将不同的网格系统（例如语义.gs）与 twitter bootstrap 一起用于布局目的？

我想我可以尝试一下，但我希望有人有经验。

——阿迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:53:51.847

Yes, you can, but you might lose some advantages of Twitter Bootstrap, especially if you need to do responsive. You can create a page with your box layout and assign classes of another grid system to your divs and still use TB's form, typography, navigation and other classes. Probably you don't want to use the top navigation or footer parts because those are quite closely linked to the grid layout but even that would be possible.

The question is rather, do you really want to have multiple dependencies in your project? If you're not worried about that, go ahead!

# php - Json 不工作

> ID：13829752
> 
> 赞同：-4
> 
> 时间：2012-12-11T22:43:43.533
> 
> 标签：php, javascript, ajax, json

我正在尝试从数据库中提取随机字符串，然后通过 json 传输它。

但是，我显然被困在这里。

```
<?php

print_r ($return['user_id']);
json_encode($return);

?> 
```

和 ajax/js

```
$(document).ready(function() {
     $.getJSON('initiate.php', function(data) {
        $("#chat-area").html(data);
     });   
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T22:46:38.993

它不能与：

1.  将`print_r`垃圾（即非 JSON）转储到客户端和 JSON 解析器
2.  你实际上并没有`echo`收到 JSON 数据。

所以，你想要的是这样的：

```
<?php
// obviously $return needs to contain something. otherwise
// you'll most likely get a notice which is "garbage" too
echo json_encode($return);
?> 
```

修复服务器端代码后，您还需要修复 JavaScript。`data`是一个对象，因此将其设置为某个元素的 HTML 内容没有多大意义。您可能需要该对象的某些属性：

```
$.getJSON('initiate.php', function(data) {
    $("#chat-area").html(data.whatever);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T22:46:19.913

这是错误的：

```
print_r ($return['user_id']);    // invalidates the json output
json_encode($return);            // does not do much...
// should be:
echo json_encode($return); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T22:49:58.867

请务必设置内容类型并仅回显 json。

```
<?php
    //fill $whatever_you_want
    header('content-type: application/json');
    echo json_encode($whatever_you_want);
?> 
```

# java - Java 泛型 SuppressWarnings("unchecked") 之谜

> ID：13829753
> 
> 赞同：11
> 
> 时间：2012-12-11T22:43:49.150
> 
> 标签：java, generics, java-7, suppress-warnings, unchecked

为什么代码替代（1）编译时没有警告，而代码替代（2）会产生“未经检查的强制转换”警告？

两者的共同点：

```
class Foo<T> {
    Foo( T [] arg ) {
    }
} 
```

备选方案 (1)：

```
class Bar<T> extends Foo<T> {
    protected static final Object [] EMPTY_ARRAY = {};

    @SuppressWarnings("unchecked")
    Bar() {
         super( (T []) EMPTY_ARRAY );
    }
} 
```

备选方案 (2)：

```
class Bar<T> extends Foo<T> {
    @SuppressWarnings("unchecked")
    Bar() {
         super( (T []) EMPTY_ARRAY );
    }

    protected static final Object [] EMPTY_ARRAY = {};
} 
```

备选方案 (2) 产生：

```
javac -Xlint:unchecked Foo.java Bar.java 
Bar.java:4: warning: [unchecked] unchecked cast
             super( (T []) EMPTY_ARRAY );
                           ^
  required: T[]
  found:    Object[]
  where T is a type-variable:
    T extends Object declared in class Bar
1 warning 
```

这是：

```
java version "1.7.0_07"
Java(TM) SE Runtime Environment (build 1.7.0_07-b10)
Java HotSpot(TM) 64-Bit Server VM (build 23.3-b01, mixed mode) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T22:46:33.000

我在 JLS 中找不到任何东西，`@SuppressWarnings`（[JLS 9.6.3.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-9.html#jls-9.6.3.5)）和未经检查的警告（[JLS 5.1.9](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.1.9)）部分似乎没有任何可能导致此问题的问题。我的猜测（没有自己测试您的 SSCE）是您在编译器中发现了一个错误。我建议[向 Oracle 提交错误报告](http://bugs.sun.com/)并将报告链接添加到您的问题中。

简而言之，类中成员的顺序应该完全独立于警告的处理方式。它可能只是未经检查的警告代码的边缘情况，也可能是一个更大的问题。

同时，您可以通过首先做您应该做的事情来消除所有问题，并动态生成空数组而不是强制转换现有数组，如[本问题](https://stackoverflow.com/questions/529085/java-how-to-generic-array-creation)所述。

**编辑**

> 如果我的`EMPTY_ARRAY`那是一个`static final`.

不要再做它`static final`了，并`Class<T>`在你的构造函数中提供一个：

```
@SuppressWarnings("unchecked") // Still need this
public Bar(Class<T> clazz) {
    super((T[]) Array.newInstance(clazz, 0));
} 
```

Java 几乎从不使用`final`变量的值来发出警告，除非出现死代码。否则，你会遇到这样的边缘情况：

```
class Bar<T> extends Foo<T> {
    // Is it really empty?
    protected static final Object [] EMPTY_ARRAY = SomeOtherClass.getEmptyArray();

    @SuppressWarnings("unchecked")
    Bar() {
         super( (T []) EMPTY_ARRAY );
    }
} 
```

他们必须将该逻辑写入编译器。对于像“空数组”这样的边缘情况来说，这是不必要的复杂化，此外，这样的转换最终都是代码异味。

除了该答案之外，您可能还有另一个选择是使用 var args。`Foo`：

```
class Foo<T> {
    Foo( T ... arg ) {
    }
} 
```

并且`Bar`：

```
class Bar<T> extends Foo<T> {

    Bar() {
         super();
    }
} 
```

[这应该可行，并且它消除了所有强制转换、空数组、警告等。在此处](https://stackoverflow.com/q/12534531/646634)查看有关 var args 及其可能调用的更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-11T23:38:55.323

我可以在我的 Windows 7 64b 机器上模拟这种奇怪的行为：

*   `Java(TM) SE Runtime Environment (build 1.7.0_02-b13)`
*   `OpenJDK Runtime Environment (build 1.8.0-ea-lambda-nightly-h1669-20121030-b63-b00)`

这意味着**OpenJDK**和**Oracle JDK**都受到影响，**JDK7**和**JDK8**都受到影响（是的，您已经可以下载它了）。

Eclipse，因为它使用自己的 JDT 编译器，所以没有这个问题。

所以看起来这确实是一个`javac`错误。如果你报告它，请让我更新。

## 编辑：

我还在我的计算机上找到了一个**JDK6**安装，所以我尝试了一个，实际上，它在两种情况下都没有警告，这是**正确的行为**：

*   `Java(TM) SE Runtime Environment (build 1.6.0_23-b05)`

* * *

虽然我的 Windows 是 64b，但所有所说的 JDK 都只有 32b。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-23T18:50:22.513

这是 Oracle 和 OpenJDK 7 和 8 中的一个错误。

您不能（不应该）通过重新排序类中的声明来获得编译警告/错误。

运行时错误，是的；编译器错误，没有。

这是[**错误 8016636**](http://bugs.java.com/bugdatabase/view_bug.do?bug_id=8016636)（感谢提交），但一年多没有任何活动。

不幸的是，这在 Oracle 的错误跟踪器中并不少见。

* * *

额外的怪异：

*   如果`EMPTY_ARRAY`is not则禁止警告`final`。

*   具有讽刺意味的是，如果您使用非数组（例如`Object EMPTY_ARRAY = new Object()`. （但不要那样做......）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-11T23:22:44.110

我能够通过这个简化的设置重现该行为：

```
class Bar<T> {
   @SuppressWarnings("unchecked")
   Bar() {
      T[]dummy = (T[]) EMPTY_ARRAY;
   }

   private static final Object [] EMPTY_ARRAY = {};
} 
```

正如布赖恩所建议的，这似乎是编译器中的一个错误。此外，此行为仅限于数组 - 将 EMPTY_ARRAY 替换为 an`Object`并将其强制转换为 a`T`不会按预期发出警告。

```
java version "1.7.0_09"
Java(TM) SE Runtime Environment (build 1.7.0_09-b05)
Java HotSpot(TM) 64-Bit Server VM (build 23.5-b02, mixed mode) 
```

# smtp - Powershell 脚本在 Powershell 中有效，但在任务计划程序中失败

> ID：13829756
> 
> 赞同：3
> 
> 时间：2012-12-11T22:44:10.013
> 
> 标签：smtp, powershell-2.0

我有一个通过 SMTP 发送电子邮件的 PowerShell 脚本。该脚本在 Powershell ISE 中运行良好，但在任务计划程序中失败。我在 Windows Server 2012 上。我在此服务器上使用完全相同的设置运行其他 Powershell 脚本，但这些脚本不发送电子邮件。我在任务计划程序中看到的返回代码是 (0xFFFD0000)，我找不到任何相关信息。我将任务设置为以最高权限运行，并且我检查了执行策略是否为 RemoteSigned。有人遇到过这个吗？

这是任务中的命令：

```
powershell -f "c:\scripts\EmailTest.ps1" 
```

这是脚本：

```
$EmailFrom = "user@domain.com"
$EmailTo = "someone@somewhere.com"
$Subject = "Email Subject" 
$Body = @"
Person,

Some message here

Thanks,
User
"@

$SMTPServer = "smtp.domain.com" 
$SMTPClient = New-Object Net.Mail.SmtpClient($SmtpServer, 25) 
$SMTPClient.Credentials = New-Object System.Net.NetworkCredential("user@domain.com", "password"); 
$SMTPClient.Send($EmailFrom, $EmailTo, $Subject, $Body) 
```

更新：我能够解决这个问题。显然我在脚本中有一行被注释掉了。我不确定为什么这会导致错误，但是一旦我删除了注释掉的行，它在任务计划程序中运行良好。评论看起来像这样，就在上面脚本中另一个 $EmailTo 声明的下方：

```
#$EmailTo = "someone@somewhere.com" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-03-26T18:48:24.690

在查看类似问题时，我发现了另一个可能的问题。我无法将 PowerShell 脚本作为任务计划程序操作执行，即使该脚本在以目标用户身份登录 Windows 并在 PowerShell 中运行时正确运行。

当我使用我认为是正常的 PowerShell 引用规则在任务的操作参数中指定脚本时，任务计划程序会始终显示 0xFFFD0000 错误：

```
-ExecutionPolicy Bypass -File 'D:\full path\to\script.ps1' 
```

当我将使用的引号从单引号更改为双引号时，PowerShell 默许并且任务计划程序立即启动任务并且没有问题：

```
-ExecutionPolicy Bypass -File "D:\full path\to\script.ps1" 
```

进入命令提示符并执行完整命令立即发现问题：

```
D:\>C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy Bypass -File 'D:\full path\to\script.ps1'

Processing -File ''D:\full path\to' failed: The given path's format is not supported. Specify a valid path for the -File parameter. 
```

注意路径前两个单引号和后一个单引号的奇怪用法。

故事的寓意：当将脚本的完整路径作为命令行参数提供给 PowerShell 时，请*使用双引号！*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-30T13:00:10.803

我收到了同样的错误，最终我遇到了一个不同的问题 - 目录设置中的可选开始没有应用。

本质上，我正在运行一个 .bat 文件 - c:\tasks\process.bat

这个 .bat 文件引用了 tasks 目录中的多个 ps1 脚本，并且引用只是按文件名（不是完整目录）。在任务计划程序的操作选项卡上，有一个我没有填充的开始（可选）字段。将其设置为 c:\tasks 允许引用正常运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-02T13:07:01.753

首先，您必须检查您机器上配置的“ExecutionPolicy”。为此，请通过以下链接检查默认值[https://technet.microsoft.com/en-us/library/hh847748.aspx](https://technet.microsoft.com/en-us/library/hh847748.aspx)

我使用以下命令解决了我的问题：在“添加参数”选项上，我输入了：

*"-Executionpolicy Bypass -command "& 'T:\deleteOldMessages.ps1'"*

![1](../Images/09a4700460297bed000410b8a00cf5d2.png)

和

![1](../Images/92edb55b84553faf7b6057ca33515ebd.png)

# winforms - 基于 2 列值的 Infragistics Grid ColumnFilter 过滤

> ID：13829763
> 
> 赞同：2
> 
> 时间：2012-12-11T22:44:53.987
> 
> 标签：winforms, infragistics, ultrawingrid

我有 2 列 x 和 Y。我需要根据 2 列的值过滤网格。例如：假设我的过滤条件为真，那么它应该检查两列的值，如果任何一列的值为真，它就不应该过滤该行。如果没有一个值为真，则应过滤该行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-12T22:16:24.523

我可以想到一个快速的解决方案。下面的代码将在 2 列上设置普通过滤器，然后您只需更改列 LogicalOperator。

```
 private void Filter() {
        Infragistics.Win.UltraWinGrid.FilterCondition fc = new Infragistics.Win.UltraWinGrid.FilterCondition();
        fc.CompareValue = "someValue1";
        fc.ComparisionOperator = Infragistics.Win.UltraWinGrid.FilterComparisionOperator.Equals;
        ultraGrid1.DisplayLayout.Bands[0].ColumnFilters["col_x"].FilterConditions.Add(fc);

        Infragistics.Win.UltraWinGrid.FilterCondition fc2 = new Infragistics.Win.UltraWinGrid.FilterCondition();
        fc2.CompareValue = "someValue2";
        fc2.ComparisionOperator = Infragistics.Win.UltraWinGrid.FilterComparisionOperator.Equals;
        ultraGrid1.DisplayLayout.Bands[0].ColumnFilters["col_y"].FilterConditions.Add(fc2);

        // set the logical operator of the columns on the band
        ultraGrid1.DisplayLayout.Bands[0].ColumnFilters.LogicalOperator = Infragistics.Win.UltraWinGrid.FilterLogicalOperator.Or;
    } 
```

这是你要找的吗？

# objective-c - NSFetchedResultsController 缺少一些对象

> ID：13829767
> 
> 赞同：6
> 
> 时间：2012-12-11T22:45:56.217
> 
> 标签：objective-c, ios, core-data

我面临一个奇怪的问题，即 NSFRC fetchedObjects 数组返回的不是它应该返回的所有对象。为了给你一些背景信息，我的应用程序有几个列表视图控制器，每个控制器都有一个 NSFRC。我正在更新委托方法 controllerDidChangeContent 中的列表视图。我面临的问题如下：在后台 MOC 中存储对象并保存后，调用了 controllerDidChangeContent，但我刚刚保存在后台线程中的对象没有显示在 NSFRC 中。这是我用来检查的一段代码：

```
- (void)controllerDidChangeContent:(NSFetchedResultsController *)controller {
    NSManagedObjectContext *context = controller.managedObjectContext;
    NSError *error = nil;
    NSArray *array = [context executeFetchRequest:controller.fetchRequest error:&error];
    if (nil != array) {
        NSUInteger count = MIN(controller.fetchedObjects.count, array.count);
        for (NSUInteger index=0; index<count; index++) {
            NSManagedObject *a = array[index];
            NSManagedObject *b = controller.fetchedObjects[index];
            // Here you will see that sometimes the objects don't match
            NSLog(@"%d: %@ <--> %@", index, [[a body] text], [[b body] text]);
        }
    }
} 
```

我期望 NSFRC fetchedObjects 数组与手动 executeFetchRequest 返回的数组相同（我正在使用 NSFRC fetchRequest 手动获取数据）。然而，这种情况并非如此。手动 executeFetchRequest 返回比 NSFRC fetchedObjects 更多的对象。有谁知道发生了什么？我已经关闭了 NSFRC 上的缓存，但报告了相同的行为。

谢谢！

=== 更新 ====

关于该问题的一些更新。我认为 Core Data 中存在错误，因为我能够从 NSFRC 中看到一些不一致的结果，而且能够通过涉及“触摸”相关对象的解决方法来解决问题。这是一个解释正在发生的事情的场景：

想象以下核心数据模型，其中： - 有 Cat 对象和 Master 对象。- 一只猫可以有一个或多个主人。- 主人可以拥有一只或多只猫。- 创建第一个 NSFRC（我们称之为 NSFRC_A）以获取所有具有名为“Master_A”的主人的猫。谓词是 { ANY master.name == "Master_A" }。- 创建第二个 NSFRC（我们称其为 NSFRC_B）以获取所有具有名为“Master_B”的主人的猫。谓词是 { ANY master.name == "Master_B" }。- 有一个仅在 UI 线程中使用的主托管对象上下文 - 为每个后台线程创建了一个后台托管对象上下文，使用与主托管对象上下文相同的持久存储。

一只名为“Cat_A”的猫在后台创建并分配给主人“Master_A”。后台上下文保存后，主上下文相应更新。此时，NSFRC_A 通知其委托发生了变化并正确报告“Cat_A”。

稍后，在后台线程中，同一只猫“Cat_A”被分配了主人“Master_B”。后台上下文保存后，主上下文相应更新。此时，NSFRC_A 通知其代表该更改并正确报告“Cat_A”。NSFRC_B 还通知其代表该更改，但不报告“Cat_A”（它从其 fetchedObjects 中丢失）。但是，如果我使用与 NSFRC_B 相同的 fetchRequest 手动执行提取，我可以看到“Cat_A”被返回。奇怪的是，返回的“Cat_A”实例被标记为错误，这解释了为什么 NSFRC_B 没有返回“Cat_A”，因为它在内存中看不到它。

这是一个错误，因为当来自后台线程的更改合并到主上下文中时，我可以通过简单地将“Cat_A”关系记录到 master 来修复该行为：日志记录基本上触及对象并强制将其实现到内存中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:37:05.753

这个问题似乎是 NSFRC 的限制。根据 Apple 论坛 (https://devforums.apple.com/message/765374) 上的这个帖子：“限制是实体 A 的获取结果控制器不会总是捕捉到实体 B 的更新，这会导致谓词改变。”。为了解决这个问题，我必须在它被合并到主线程之前弄脏我正在寻找的对象：然后 NSFRC 检测到该更改。

# python - Python Mako 模板 - 如何根据上下文中的值动态决定调用哪个 def 或函数？

> ID：13829769
> 
> 赞同：3
> 
> 时间：2012-12-11T22:46:04.593
> 
> 标签：python, templates, mako

我会在 Mako 文件中执行以下操作：

```
%for operation in operation_list:
    ${operation['name']}
    ${${operation['name']}Body()}
%endfor

<%def name="operationOneBody()">
   some stuff
</%def>

<%def name="operationTwoBody()">
   some other stuff
</%def> 
```

基本上，我期望上下文将包含名称为“operationOne”和“operationTwo”的操作，我想动态决定插入哪个 Mako Def。

在这一行`${${operation['name']}Body()}`中，想法是内部 ${} 标记`${operation['name']}`将解析为“operationOne”，然后是“operationTwo”等等，所以外部 ${} 看起来就像`${operationOneBody()}`第一次通过循环，`${operationTwoBody()}`第二次通过，等等——这将导致适当的 defs 被调用，最终将在这些地方填充我想要的实际内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-11T23:23:34.020

您可以将函数放入由操作名称键入的字典中。我认为这应该做你想要的：

```
<% operations = { 'one': operationOneBody, 'two': operationTwoBody } %>

%for operation in operation_list:
    ${operation['name']}
    ${operations[operation['name']]()}
%endfor

<%def name="operationOneBody()">
   some stuff
</%def>

<%def name="operationTwoBody()">
    some other stuff
</%def> 
```

# javascript - 更改事件 IE 7-8 与其他事件中的检查值

> ID：13829771
> 
> 赞同：1
> 
> 时间：2012-12-11T22:46:15.583
> 
> 标签：javascript, jquery, internet-explorer-8

有谁知道为什么这段代码会在 FF、Chrome 和 IE9 中打印出 true 而在 IE 7-8 中打印出 false ？当然还有如何使它保持一致。

```
$("#cb1").on("change", function(e) {
    $("#value").text(e.target.checked);
});

$("#cb1").trigger("click"); 
```

HTML是

```
<input type="checkbox" id="cb1" />
<div id="value"></div> 
```

我还准备了一个[jsfiddle](http://jsfiddle.net/beradrian/WkGUr/8/)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:57:50.003

它在 IE 中返回 false 的原因是由于事件的时间/顺序。

在 IE 中触发 change 事件时，还没有设置 checked 属性。

一旦该事件竞争，然而它已经被设置并且 .checked 将返回 true。

我不相信这是实现这一点的最佳方法，但要回答你的问题......

根据您现有的代码包装实际设置， setTimeout 调用中的文本将延迟其执行。

这意味着当代码执行此更改时，即使已经完成，也将设置选中的属性，并且将看到“正确”/所需的行为。

我在这里更新了你的小提琴[http://jsfiddle.net/WkGUr/16/](http://jsfiddle.net/WkGUr/16/)

```
$("#cb1").on("change", function(e) {
    setTimeout(function() {
        $("#value").text(e.target.checked);
    }, 0);
});

$("#cb1").trigger("click"); 
```

# python - 为 Mac App Store 捆绑 wxPython 应用程序，无需 ppc 代码（二进制）

> ID：13829773
> 
> 赞同：0
> 
> 时间：2012-12-11T22:46:17.323
> 
> 标签：python, wxpython, mac-app-store, py2app, universal-binary

我已经开发了（过去 7 年）一个 wxPython 应用程序，它想通过 Mac App Store 分发。我正在使用 Python2.7 和 wxPython2.9.4（可可）。该应用程序是使用 py2app 捆绑的。到目前为止一切看起来都不错。问题是 Application Loader 拒绝了 Package，因为 py2app 捆绑了这个动态库“libwx_osx_cocoau-2.9.4.0.0.dylib”，它显然包含 ppc 代码，并且提交必须仅是 intel。

如何在没有 ppc 代码的情况下捆绑此应用程序？

py2app 的 --arch="intel" 参数不能解决这个问题。

我怎样才能做到这一点？捆绑包的其余部分都可以。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T14:07:47.953

你试过使用[`lipo`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/lipo.1.html)吗？

```
lipo -remove ppc libwx_osx_cocoau-2.9.4.0.0.dylib -output libwx_osx_cocoau-2.9.4.0.0.dylib.intel 
```

然后您可以查看新的输出库是否仍然可以正常工作（当然要重命名为原始名称）

如果加载程序接受，您可以将其添加到您的构建脚本中，以便在每次构建后删除 ppc。

# android - Android onTouchEvent 错误

> ID：13829775
> 
> 赞同：-1
> 
> 时间：2012-12-11T22:46:19.017
> 
> 标签：android

当我运行我的应用程序时，MenuView 显示正常，但是当我单击帮助图像所在的位置时，应用程序会强制关闭....

主要活动：

```
public class MainActivity extends Activity {

private static final String TAG = MainActivity.class.getSimpleName();

MenuView menuView;
HelpView helpView;
GameView gameView;

Handler myHandler = new Handler(){
    public void handleMessage(Message msg) {

        if(msg.what == 2){
            if(menuView != null){
                menuView = null;
            }
            MainActivity.this.setContentView(menuView);
            new Thread(){
                public void run(){
                    Looper.prepare();
                    gameView = new GameView(MainActivity.this);
                    Looper.loop();
                }
            }.start();
        }
        else if(msg.what == 3){
            initHelpView();
        }

    }
}; 

public void initHelpView(){
    helpView = new HelpView(this);
    this.setContentView(helpView);
}

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, 
            WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(new MenuView(this));
    Log.d(TAG, "View added");
    new Thread(){
        public void run(){
            Looper.prepare();
            menuView = new MenuView(MainActivity.this);
        }
    }.start();
}

@Override
protected void onDestroy() {
    Log.d(TAG, "Destroying...");
    super.onDestroy();
}

@Override
protected void onStop() {
    Log.d(TAG, "Stopping...");
    super.onStop();
}

    } 
```

菜单视图：

```
public class MenuView extends SurfaceView implements
  SurfaceHolder.Callback {
private static final String TAG = MenuView.class.getSimpleName();

private MenuViewThread thread;
private MainActivity activity;

public MenuView(Context context) {
    super(context);
    getHolder().addCallback(this);
    thread = new MenuViewThread(getHolder(),this);
    setFocusable(true);
}

@Override
public void surfaceChanged(SurfaceHolder holder, int format, int width,
        int height) {

}

@Override
public void surfaceCreated(SurfaceHolder holder) {
    thread.setRunning(true);
    thread.start();

}

@Override
public void surfaceDestroyed(SurfaceHolder holder) {

    Log.d(TAG, "Surface is being destroyed");
     boolean retry = true;
     while (retry){
         try {
             thread.join();
             retry = false;
         }catch ( InterruptedException e){
             //try again shutting down the thread
         }
     }

}

protected void onDraw(Canvas canvas) {
     canvas.drawBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.background), 0,0,null);
     canvas.drawBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.opensound), 105,240,null);
     canvas.drawBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.help), 225,240,null);
     canvas.drawBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.exit), 345,240,null);
     canvas.drawBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.startgame), 190,150,null);

}

public boolean onTouchEvent(MotionEvent event) {
    if(event.getAction() == MotionEvent.ACTION_DOWN){

        if(event.getX()>225 && event.getX()<255 + 30
                && event.getY()>240& event.getY() <270 + 30){
            activity.myHandler.sendEmptyMessage(3);
        }else {
            Log.d(TAG, "Coords: x=" + event.getX() + ",y=" + event.getY());
        }
    }return super.onTouchEvent(event);

}

    } 
```

菜单视图线程：

```
public class MenuViewThread extends Thread {
private static final String TAG = MenuViewThread.class.getSimpleName();

private MenuView menu;
private SurfaceHolder surfaceHolder;
private boolean running;

public void setRunning(boolean running){
    this.running = running;
}

public MenuViewThread( SurfaceHolder surfaceHolder, MenuView menu){
    super();
    this.surfaceHolder = surfaceHolder;
    this.menu = menu;
}

@Override
public void run() {
      Canvas canvas;
      while (running) {
       canvas = null;
       // try locking the canvas for exclusive pixel editing on the surface
       try {
        canvas = this.surfaceHolder.lockCanvas();
        synchronized (surfaceHolder) {
         // update game state
         // draws the canvas on the panel
         this.menu.onDraw(canvas);
        }
       } finally {
        // in case of an exception the surface is not left in
        // an inconsistent state
        if (canvas != null) {
         this.surfaceHolder.unlockCanvasAndPost(canvas);
        }
       } // end finally
      }
}

    } 
```

这个应用程序看起来没有错误，但是当我点击图像时它出错了，有人有什么问题吗？

日志猫：

```
12-12 06:50:20.792: D/MainActivity(1342): View added
12-12 06:50:24.312: D/AndroidRuntime(1342): Shutting down VM
12-12 06:50:24.312: W/dalvikvm(1342): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
12-12 06:50:24.312: E/AndroidRuntime(1342): FATAL EXCEPTION: main
12-12 06:50:24.312: E/AndroidRuntime(1342): java.lang.NullPointerException
12-12 06:50:24.312: E/AndroidRuntime(1342):     at com.example.demo.MenuView.onTouchEvent(MenuView.java:75)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at android.view.View.dispatchTouchEvent(View.java:3766)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:863)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:863)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1671)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1107)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at android.app.Activity.dispatchTouchEvent(Activity.java:2086)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1655)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1785)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at android.os.Looper.loop(Looper.java:123)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at android.app.ActivityThread.main(ActivityThread.java:4627)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at java.lang.reflect.Method.invokeNative(Native Method)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at java.lang.reflect.Method.invoke(Method.java:521)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
12-12 06:50:24.312: E/AndroidRuntime(1342):     at dalvik.system.NativeStart.main(Native Method)
12-12 06:50:39.443: D/dalvikvm(1342): GC_FOR_MALLOC freed 6747 objects / 375136 bytes in 64ms 
```

新的日志猫：

```
12-12 07:11:15.433: I/Process(1461): Sending signal. PID: 1461 SIG: 9
12-12 07:15:58.392: D/MainActivity(1491): View added
12-12 07:16:08.022: D/MenuView(1491): Surface is being destroyed
12-12 07:16:14.212: I/dalvikvm(1491): threadid=3: reacting to signal 3
12-12 07:16:14.222: I/dalvikvm(1491): Wrote stack traces to '/data/anr/traces.txt'
12-12 07:16:26.433: D/MainActivity(1501): View added
12-12 07:16:28.153: D/MenuView(1501): Coords: x=224.0,y=250.0
12-12 07:16:29.113: D/MenuView(1501): Surface is being destroyed
12-12 07:16:35.072: I/dalvikvm(1501): threadid=3: reacting to signal 3
12-12 07:16:35.072: I/dalvikvm(1501): Wrote stack traces to '/data/anr/traces.txt'
12-12 07:16:53.493: D/dalvikvm(1501): GC_FOR_MALLOC freed 7084 objects / 359392 bytes in 72ms 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T22:53:03.093

```
java.lang.NullPointerException
    at com.example.demo.MenuView.onTouchEvent(MenuView.java:75) 
```

看起来你忘记初始化了`activity`。

* * *

也许您可以在构造函数中传递 Activity：

```
public MenuView(Context context, Activity activity) {
    ...
    this.activity = activity; 
} 
```

* * *

**另外**
虽然我不确定这种方法是否有效。您在不同线程上使用 UI 元素的概念：

```
new Thread(){
    public void run(){
        Looper.prepare();
        gameView = new GameView(MainActivity.this);
        Looper.loop();
    }
}.start(); 
```

应该抛出 CalledFromWrongThreadException。看起来这个线程不需要为 Looper 准备，因为您正在尝试在 Activity 中使用 Handler。

# mobile - 如何在 Drupal 6 主题模板中检测移动设备？

> ID：13829790
> 
> 赞同：1
> 
> 时间：2012-12-11T22:48:02.700
> 
> 标签：mobile, drupal-6, responsive-design

实现响应式主题的挑战是只为您希望定位的设备插入 VIEWPORT 标签。就我而言，我想为移动类设备添加标签，但不是平板电脑。

我正在尝试在我的主题 template.php 顶部使用条件 HEAD 来完成此操作：

```
if (getIsMobile()) {drupal_set_html_head('<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0">');}

function getIsMobile()
{
    $RE_MOBILE = '/(nokia|iphone|android|motorola|^mot\-|softbank|foma|docomo|kddi|up\.browser|up\.link|htc|dopod|blazer|netfront|helio|hosin|huawei|novarra|CoolPad|webos|techfaith|palmsource|blackberry|alcatel|amoi|ktouch|nexian|samsung|^sam\-|s[cg]h|^lge|ericsson|philips|sagem|wellcom|bunjalloo|maui|symbian|smartphone|midp|wap|phone|windows ce|iemobile|^spice|^bird|^zte\-|longcos|pantech|gionee|^sie\-|portalmmm|jig\s browser|hiptop|^ucweb|^benq|haier|^lct|opera\s*mobi|opera\*mini|320x320|240x320|176x220)/i';

    $_isMobile = (isset($_SERVER['HTTP_X_WAP_PROFILE']) || isset($_SERVER['HTTP_PROFILE']) || preg_match($RE_MOBILE, $_SERVER['HTTP_USER_AGENT']));
    return $_isMobile;
} 
```

上面的用户代理字符串故意省略了 iPad。

乍一看，这工作正常，但在生产模式下似乎“超时”。在节点编辑等一些经过身份验证的活动之后，在适用的移动设备上查看站点时，VIEWPORT 标记将不再包含在内。我还不能确定发生这种情况的确切条件，但我怀疑这与页面缓存（打开为“正常”）有关。刷新所有缓存会暂时修复该行为。

谁能建议这种方法或替代方法可能有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T13:40:48.637

你的怀疑是正确的。这与页面缓存有关。

随着 Drupal 的页面缓存设置为“正常”，每个页面都建立在匿名用户的第一个视图之上，并缓存在 {cache_page} 表中。后续查看同一页面的匿名用户将从缓存表中获得该页面，直到缓存过期。

因此，**如果第一个访问 Page-X 的匿名用户在您的列表中有一个用户代理，则该页面将被构建并使用 viewport 标记进行缓存。随后的匿名访问者将获得带有视口标签的页面，无论他们的用户代理如何，直到缓存过期并被重建。**然后该过程重新开始。

简单的答案是禁用页面缓存。但我不建议即使对于流量非常小的站点。

更好的解决方案是将这个逻辑移动到客户端；那是javascript。假设 jQuery 已经加载，您可以使用它为您的设备列表附加元视口标签：

```
<head>
  <script>
    if (navigator.userAgent.match(/(nokia|iphone|android|motorola|^mot\-|softbank|foma|docomo|kddi|up\.browser|up\.link|htc|dopod|blazer|netfront|helio|hosin|huawei|novarra|CoolPad|webos|techfaith|palmsource|blackberry|alcatel|amoi|ktouch|nexian|samsung|^sam\-|s[cg]h|^lge|ericsson|philips|sagem|wellcom|bunjalloo|maui|symbian|smartphone|midp|wap|phone|windows ce|iemobile|^spice|^bird|^zte\-|longcos|pantech|gionee|^sie\-|portalmmm|jig\s browser|hiptop|^ucweb|^benq|haier|^lct|opera\s*mobi|opera\*mini|320x320|240x320|176x220)/i)) {
      $('head').append( '<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0">' );
    }
  </script>
</head> 
```

以上将进入您主题的 page.tpl.php 文件。

# compiler-construction - 使用 nvcc CUDA 编译器时，有哪些可能导致分段错误的原因？

> ID：13829791
> 
> 赞同：1
> 
> 时间：2012-12-11T22:48:03.290
> 
> 标签：compiler-construction, cuda, segmentation-fault, nvcc

我有一个 CUDA 类，我们称之为它`A`，在头文件中定义。我编写了一个测试内核，它创建了一个 class 的实例`A`，它可以很好地编译并产生预期的结果。

此外，我有我的主 CUDA 内核，它也可以很好地编译并产生预期的结果。但是，当我将代码添加到主内核以实例化 class 的实例时`A`，nvcc 编译器会因分段错误而失败。

**更新：**

澄清一下，分段错误发生在编译期间，而不是在运行内核时。我用来编译的行是：

```
`nvcc --cubin -arch compute_20 -code sm_20 -I<My include dir> --keep kernel.cu` 
```

`<My include dir>`包含一些实用程序头文件的本地路径的路径在哪里。

我的问题是，在花费大量时间隔离展示行为的最小示例之前（由于代码库相对较大，这不是微不足道的），有没有人遇到过类似的问题？如果内核太长或使用太多寄存器，nvcc 编译器是否有可能失败并死掉？

如果诸如寄存器计数之类的问题会以这种方式影响编译器，那么我将需要重新考虑如何实现我的内核以使用更少的资源。这也意味着将事情精简到最小的例子可能会使问题消失。但是，如果这甚至不可能，我不想在死胡同上浪费时间，而是会尝试将事情减少到一个最小的例子，并向 NVIDIA 提交错误报告。

**更新：**

根据@njuffa 的建议，我在`-v`启用标志的情况下重新运行了编译。输出以以下内容结束：

```
#$ ptxas  -arch=sm_20 -m64 -v  "/path/to/kernel_ptx/kernel.ptx"  -o "kernel.cubin" 
Segmentation fault
# --error 0x8b -- 
```

这表明问题是由于`ptxas`程序无法从`ptx`文件生成 CUDA 二进制文件造成的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-05-15T07:22:12.237

`ptxas`这似乎是 CUDA 5.0汇编程序中某种真正的错误。它已报告给 NVIDIA，我们可以假设它是在提出问题并添加此答案后三年多的某个时间修复的。

[此答案已从评论中收集并添加为社区 wiki 条目，以将此问题从未回答的问题列表中删除]

# multithreading - 在单个核心 Azure 辅助角色上使用多个线程的原因

> ID：13829792
> 
> 赞同：1
> 
> 时间：2012-12-11T22:48:07.130
> 
> 标签：multithreading, azure, azure-worker-roles

我有一个 Azure 工作者角色在一个超小的实例中运行。它所做的只是将存储队列中的所有消息出列，并将它们以 100 个块的形式插入到表存储中。

我想知道在插入这些块时生成多个线程是否有意义，即使实例只是一个核心。我的想法是，由于插入是一个异步过程（尽管我正在使用使其看起来同步的 API 调用），所以可能核心花费最多的时间是等待，我可能会看到并行插入的性能提升。

插入进入 10 个表分区，因此跨分区并行化非常容易。那是我最好的选择吗？我可以使用 PLINQ 来执行此操作吗？我知道 PLINQ 根据内核数量优化线程使用，那么在这种情况下它甚至会产生多个线程吗？如果我使用插入调用的异步版本，当对表存储的调用返回时，这不会产生多个线程的效果吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T15:18:07.440

您可以产生多个线程，它可能会运行得更快。正如您所指出的，大部分时间都花在 I/O 上，因此 CPU 可以在它们之间切换。

但是，使用异步版本的调用（Begin/End 样式调用，或者`DoSomethingAsync()`如果您使用 .NET 4.5 和最新的 SDK，则使用较新样式的调用）会执行得更好。在幕后，这些调用使用 I/O 完成端口，这是一种更有效的处理 I/O 的方式。那里可能有一些很好的比较，但我自己的非正式测试发现异步方法要快 10 倍左右。

# java - Java异常日志中+number的含义

> ID：13829795
> 
> 赞同：2
> 
> 时间：2012-12-11T22:48:23.543
> 
> 标签：java

在这些异常日志行中：

```
Exception: java/lang/NullPointerException
at as.<init>(+95)
at fw.c(+8)
at bl.a(+27)
at bl.a(+116)
at gk.a(+110)
at bz.n(+28)
at bz.commandAction(+755)
at javax.microedition.lcdui.Displayable.callKeyPressed(Displayable.java:1161)
at javax.microedition.lcdui.Canvas.callKeyPressed(Canvas.java:1070) 
```

`(+95)`, `(+8)`, `(+755)`...等是什么意思？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T22:50:40.410

这些是传播异常的指令的偏移量（在每个类中抛出）。顺便说一句，代码看起来很模糊。

# html - HTML5 在我的情况下使用

> ID：13829796
> 
> 赞同：2
> 
> 时间：2012-12-11T22:48:30.530
> 
> 标签：html, figure

在这种情况下我应该怎么做：

```
 <figure>
            <a href="#" class="portfolio-item">
                <div class="picture"><img src="images/portfolio/recent-01.jpg" alt=""/><div class="image-overlay-link"></div></div>
                <figcaption class="item-description">
                    <h5>Mountain Landscapes</h5>
                    <span>Photography</span>
                </figcaption>
            </a>
        </figure> 
```

我不能在“a”元素之外使用“figcaption”，但我想在文本区域和图像上都悬停。也许“文章”会更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-12-30T00:45:31.000

为什么不按照[Alohchi](https://stackoverflow.com/questions/13829796/html5-figure-usage-in-my-case#comment19041433_13829796)`a`的建议使用外部图形？这是有效的：

```
<a href="#" class="portfolio-item">
    <figure>
        <div class="picture">
            <img src="images/portfolio/recent-01.jpg" alt=""/>
            <div class="image-overlay-link"></div>
        </div>
        <figcaption class="item-description">
            <h5>Mountain Landscapes</h5>
            <span>Photography</span>
        </figcaption>
    </figure>
</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T04:07:03.360

根据您的 CSS 的外观，您可以将每个图像和标题包含在单独的锚标记中，如下所示：

```
<figure>
    <div class="picture">
        <a href="#" class="portfolio-item">
            <img src="images/portfolio/recent-01.jpg" alt=""/>
            <div class="image-overlay-link"></div>
        </a>
    </div>
    <figcaption class="item-description">
        <a href="#" class="portfolio-item">
            <h5>Mountain Landscapes</h5><span>Photography</span>
        </a>
    </figcaption>
</figure> 
```

或者您可以将图片 div 容器类放在锚点或图像标签中，这样您就不需要包含 div。

如果您只想要一些悬停效果，您也可以只使用 CSS，并定位 .picture:hover 选择器并将锚标记保留在 figcaption 上。取决于你需要什么。

为了回答您的`article`建议，这就是[W3C 所称的联合内容](http://www.w3.org/html/wg/drafts/html/master/single-page.html#the-article-element)。相反，您可以尝试[`section`](http://www.w3.org/html/wg/drafts/html/master/single-page.html#the-section-element)，它提供了一个元素来指定您将包含在大纲中或主题相似的文档片段——如果您要走那条路。

# c++ - C++ 将时间 ET 转换为 CET 或其他

> ID：13829800
> 
> 赞同：0
> 
> 时间：2012-12-11T22:48:48.517
> 
> 标签：c++, timezone, converter

我正在解析带有日期和时间的文件。假设我有以下格式的日期和时间：

```
2009/07/18 10:48:39 CET (value in txt-file) 
```

这是在 ET：

```
2009/07/18 4:48:39 ET (could also be the value i parsed) 
```

有没有在时间/日期之间转换的解决方案？也许提升？

在 boost 文档中找不到有用的信息。

假设我想在 C++ 中从 CET 到 ET 或 ET 到 EST 或 CET 到 EST，你会怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:33:43.553

[strftime](http://www.cplusplus.com/reference/ctime/strftime/)`struct tm*`允许您使用日期时间格式字符（%Y、%m、%d 等）打印出对象。

您可以做的是`struct tm*`通过解析您的输入数据来加载一个对象（假设它是常规的，这应该不需要很多代码），然后根据您的时区转换使用一些自定义逻辑修改 tm 结构的各个部分（添加小时，然后检查您是否需要根据新的小时值更新日期），然后通过 strftime 以您想要的格式打印此日期时间值。不像 php 中可用的 strptime/strftime 函数那么简单，但仍然是一个解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-24T15:02:48.703

我推荐[https://github.com/google/cctz](https://github.com/google/cctz)

另请注意，“CET”和“ET”不是实时时区标识符。它们可能是某个时区的缩写，但它们并不能唯一标识实际时区。如果您对文件中的数据有一定的控制权，则应将“CET”和“ET”更改为数字 UTC 偏移值，例如由`%z`from `strftime()`(and `cctz::Format()`) 生成的值。数字 UTC 偏移量和 Y/M/DH:M:S 字段将让您正确解析出确切的时间瞬间。

# jquery - 是否可以让 Twitter Bootstrap 下拉菜单淡入？

> ID：13829805
> 
> 赞同：15
> 
> 时间：2012-12-11T22:49:00.830
> 
> 标签：jquery, drop-down-menu, twitter-bootstrap, fadein

我试图让 Twitter Bootstrap 上的标准导航栏下拉菜单淡入而不是仅仅出现。我已经尝试添加类`fade`，`in`但它似乎并没有消失。这是我的小提琴[http://jsfiddle.net/byronyasgur/5zr4r/10/](http://jsfiddle.net/byronyasgur/5zr4r/10/)。

我已经尝试过另一种方式 - 例如[这个问题](https://stackoverflow.com/questions/12115833/adding-a-slide-effect-to-bootstrap-dropdown)的答案，但由于某种原因，我无法使用 jquery 定位下拉触发器。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-03-19T20:10:46.800

玩弄这个，看起来 CSS 动画效果最好。

```
.open > .dropdown-menu {
  animation-name: slidenavAnimation;
  animation-duration:.2s;
  animation-iteration-count: 1;
  animation-timing-function: ease;
  animation-fill-mode: forwards;

  -webkit-animation-name: slidenavAnimation;
  -webkit-animation-duration:.2s;
  -webkit-animation-iteration-count: 1;
  -webkit-animation-timing-function: ease;
  -webkit-animation-fill-mode: forwards;

  -moz-animation-name: slidenavAnimation;
  -moz-animation-duration:.2s;
  -moz-animation-iteration-count: 1;
  -moz-animation-timing-function: ease;
  -moz-animation-fill-mode: forwards;
}
@keyframes slidenavAnimation {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@-webkit-keyframes slidenavAnimation {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
} 
```

您可以添加其他 CSS 属性以制作更复杂的动画。例如，我一直在玩 left: -30 -> left: 0。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-10-12T21:20:44.483

我想提交一个现代的、纯 CSS 的方法：

```
.dropdown-menu.fade {
  display: block;
  opacity: 0;
  pointer-events: none;
}
.open > .dropdown-menu.fade {
  pointer-events: auto;
  opacity: 1;
} 
```

这允许`.fade`处理过渡动画，但`.open`控制不透明度和指针状态。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-12-27T05:18:11.300

在 Bootstrap 4 中对 Jason Featheringham 的[答案进行了小调整。](https://stackoverflow.com/a/33090416/4179720)

```
.dropdown-menu.fade {
   display: block;
   opacity: 0;
   pointer-events: none;
}

.show > .dropdown-menu.fade {
   pointer-events: auto;
   opacity: 1;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-12-11T23:08:45.190

也许用 jQuery 做这样的事情：

```
$(function() {
    $('.dropdown-toggle').click(function() {
        $(this).next('.dropdown-menu').fadeToggle(500);
    });
});​ 
```

你可以在这里检查小提琴：http: [//jsfiddle.net/5zr4r/15/](http://jsfiddle.net/5zr4r/15/)

**更新：**我忘了说你应该`fade` `in`从`ul`.

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-01-02T21:15:54.563

我也找到了很好的解决方案：

```
// Add slideDown animation to dropdown
$('.dropdown').on('show.bs.dropdown', function(e){
  $(this).find('.dropdown-menu').first().stop(true, true).slideDown();
});

// Add slideUp animation to dropdown
$('.dropdown').on('hide.bs.dropdown', function(e){
  $(this).find('.dropdown-menu').first().stop(true, true).slideUp();
}); 
```

示例：[http ://codepen.io/danielyewright/pen/EvckL](http://codepen.io/danielyewright/pen/EvckL)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-29T21:40:07.600

你可以试试这个：

```
// Add fadeToggle animation to dropdown       
$('.dropdown').on('show.bs.dropdown', function(e) {   
  $(this).find('.dropdown-menu').first().stop(true, true).fadeToggle(500); 
}); 

// Add fadeToggle animation to dropdown 
$('.dropdown').on('hide.bs.dropdown', function(e) { 
  $(this).find('.dropdown-menu').first().stop(true, true).fadeToggle(500); 
}); 
```

它利用 Bootstrap 现有的`show.bs.dropdown`和`hide.bs.dropdown`功能，将下拉效果更改为“淡入”而不是“出现”。如果您想要“幻灯片”生效，您也可以更改`fadeToggle()`为。`slideDown()`希望这可以帮助。

这是小提琴：http: [//jsfiddle.net/ck5c8/](http://jsfiddle.net/ck5c8/)

# mysql - Ruby on Rails：将搜索查询保存在数据库中的最佳方式

> ID：13829807
> 
> 赞同：0
> 
> 时间：2012-12-11T22:49:09.470
> 
> 标签：mysql, ruby-on-rails, database

对于我正在帮助开发的 RoR 应用程序，我需要将所有搜索查询保存在数据库中，以便以后进行分析。

我现在的计划是创建一个 Result 模型和表，并将每个搜索查询的文本以及用户 ID、时间等保存在该表中。

但是，该应用程序有大约 15,000 个用户，所以我担心单表方法在解析该数据时不会非常有效。（数据库是通过 MySQL 设置的，如果有的话。）

我只是偏执吗？是否有处理这种事情的 Ruby gem，或者我可以采取更好的方法？

任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T23:01:56.583

您可以尝试以下几种方法： 1\. 启用 mysql 查询日志记录，然后分析这些日志 [http://dev.mysql.com/doc/refman/5.1/en/query-log.html](http://dev.mysql.com/doc/refman/5.1/en/query-log.html) 2\. 使用 key=>value存储（想到redis）以您描述的类似方式记录搜索查询

如果您决定采用第二种方法，我将在您要跟踪的模型上创建一个异步观察者

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T00:44:24.230

答案取决于你想对数据做什么。

如果您的用户不需要访问此内容，并且您没有进行实时分析，请将他们从您的应用程序中转储出来，然后将他们放入另一个数据库中，以便对您的内容进行分析。

如果您想将某些东西集成到您的应用程序中，请尝试使用单个 mysql 表。

除非您的服务器很小或者您的用户是疯狂的活跃搜索者，否则它应该可以正常工作。在某个时候，您可能希望清除旧记录并将它们保存在其他地方。

# mysql - Mysql 语法似乎是正确的

> ID：13829809
> 
> 赞同：1
> 
> 时间：2012-12-11T22:49:14.273
> 
> 标签：mysql, syntax, syntax-error

所以......我收到了：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'key = '48f9f4a3f5e10c63804400f320f46e26'' at line 1 
```

所以我在网页上反映给自己，上面写着：

```
SELECT * FROM email_confirm WHERE email = 'censored@gmail.com' AND key = '48f9f4a3f5e10c63804400f320f46e26' 
```

我没有看到这个问题。

MySQL 版本是 5.1.65-cll

答：KEY是mysql中的保留字。需要`backticks`！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:51:57.250

键是保留字。使用反引号来逃避它。

```
... `key` = '48f9...' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T22:52:29.870

`key`是 MySQL 关键字。由于它也是您的字段的名称，请用适当的符号将其括起来：

```
SELECT * FROM `email_confirm` WHERE `email` = 'censored@gmail.com' AND `key` = '48f9f4a3f5e10c63804400f320f46e26'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T22:53:47.617

我认为 key 是保留字。改用`key`。

# c++ - 为什么我得到一个包括 ?

> ID：13829810
> 
> 赞同：0
> 
> 时间：2012-12-11T22:49:15.577
> 
> 标签：c++, iostream

我一直在尝试将 iostream 导入自定义块，我添加了该行

```
 #include <iostream.h> 
```

在 .h 文件和 .cc 文件中，但出现错误：

> 致命错误：iostream.h：没有这样的文件或目录

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T22:55:37.303

标题`iostream`是`<iostream>`，不是`<iostream.h>`。您收到的错误表明编译器正在寻找`iostream.h`，这表明您可能包含了错误的标头。

尝试将标题更改为`<iostream>`，看看是否可以解决问题。更一般地，请确保您不包含任何`.h`以

希望这可以帮助！

# mysql - 优先考虑 SQL WHERE 子句

> ID：13829811
> 
> 赞同：5
> 
> 时间：2012-12-11T22:49:38.610
> 
> 标签：mysql, sql, select, where

基本上我想这样做：

```
SELECT * FROM `table` WHERE x = 'hello' OR x = 'bye' LIMIT 1'; 
```

我希望它返回 1 个值，但要优先考虑第一个 where 子句的结果。因此，如果存在 x 列的值为“hello”的行，它将不会返回“bye”值的结果。如果“hello”值不存在，它将返回“bye”值的结果。

想不出办法来做到这一点，即使它看起来相当微不足道。有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-11T22:55:39.490

一种方法是使用`order by`：

```
SELECT *
FROM `table`
WHERE x = 'hello' OR x = 'bye'
order by (case when x = 'hello' then 1 else 2 end)
LIMIT 1' 
```

“1”和“2”只是用于确定行优先级的任意数字。'hello' 的值得到“1”，因此它们在其他值之前排序。

# javascript - 在 OOP Javascript 中设置类的高度和宽度

> ID：13829812
> 
> 赞同：0
> 
> 时间：2012-12-11T22:49:41.520
> 
> 标签：javascript, oop, class, size

我是 javascript 中 OOP 编码的初学者。

我正在尝试设置班级的大小。但是我的代码中有一个错误。

```
 (function($) {

    Block = function() {
        var self = this;
        this.el = $('<div></div>');
    }

    Block.prototype.appendTo = function(parent) {
        this.el.appendTo(parent);
    }

    Block.prototype.setSize = function(width, height) {
        var self = this;
        this.width = width;
        this.height = height;
    }

})(jQuery); 
```

这就是我所说的类：

```
var block1 = new Block();
block1.appendTo('body').setSize(100,100); 
```

在控制台中我得到：

```
Uncaught TypeError: Cannot call method 'setSize' of undefined 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T23:08:38.853

您正在`setSize`调用`appendTo`. 但是，`appendTo`不返回任何内容 ( `undefined`)，因此当您尝试调用它时会引发错误`setSize`。

解决方案是从函数中返回`Block`对象`appendTo`，如下所示：

```
(function($) {

    Block = function(width, height) {
        this.el = $('<div></div>');
        if (width !== undefined && height !== undefined) {
            this.width = width;
            this.height = height;
        }
    }

    Block.prototype.appendTo = function(parent) {
        this.el.appendTo(parent);
        return this;
    }

    Block.prototype.setSize = function(width, height) {
        this.width = width;
        this.height = height;
    }

})(jQuery); 
```

# javascript - 玩！框架从 Javascript 访问 Play 变量

> ID：13829814
> 
> 赞同：2
> 
> 时间：2012-12-11T22:49:44.540
> 
> 标签：javascript, playframework, global-variables

我是 Play 框架 (1.2) 的新手，但我想知道并希望我能正确地表达这个问题......我有一个 Play 变量，它存储用户当前正在查看的页面的哪个部分（“_section”）。有没有办法从 .js 函数访问该变量？

更新：

```
You can store objects for js as well from play:

    <script type="text/javascript">
          window.mytestarray = new Array();
     </script>

       #{list 0..links.size()-1, as:'i'}

   {%
    router = play.mvc.Router;
    url = router.reverse(_section + '.' + links[i]).url;
   %}

      <script  type="text/javascript">
           window.mytestarray.push("${url}")
      </script>

   <li js_sub_nav_name="${ _section}" >  <!-- MC class="#{if i == 0}first#{/if}"-->
   <a href="${url}" class="${lines[i]}#{if _page == links[i]} active#{/if}">&{'header.nav.'+_section+'.'+links[i]+'.html'}</a>

   </li>
  #{/list}
  </ul>
 #{/if} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T23:15:49.653

您可以在视图文件中创建一个 javascript 全局变量，并从其他 javascript 文件访问该变量：

```
#my view
...
<script type="text/javascript>
window._section = "${_section}";
</script> 
```

然后从一个javascript文件中：

```
if (_section == ...) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-12T11:22:52.410

使用 html5 数据属性，例如：

```
<div id="yourSection" data-section="${_section}">
...your section contents...
</div> 
```

# git - 如何访问 GitHub 图表部分中的数据？

> ID：13829815
> 
> 赞同：1
> 
> 时间：2012-12-11T22:49:49.117
> 
> 标签：git, github

我想从 GitHub 图表部分访问数据。例如，我[对此数据](https://github.com/rubinius/rubinius/graphs/contributors)感兴趣。其中一些数据可通过 githubarchive.org 访问，但并不完全相同 - GitHub 图表中有一些我想在 githubarchive.org 无法帮助我的信息（例如 2011 年分叉或贡献者的绝对数量）。此外，我似乎无法从 GitHub API 获得这些数据——因为我只获得了最近的分叉或贡献者数量，而不是 2011 年 3 月 1 日的历史数据。

那么，如何访问 GitHub 图表部分中的信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:04:56.673

github 图中的所有数据都是从存储库中的提交生成的。

克隆存储库，然后遍历每个提交以获取所需的数据。

# c - Creating and initializing an array of user defined type in C

> ID：13829819
> 
> 赞同：1
> 
> 时间：2012-12-11T22:50:23.930
> 
> 标签：c, arrays, pointers, malloc, command-line-arguments

I've recently started learning C, so apologies if my question is very basic or unclear.

I'm passing 3 command line values to my program. ( TYPE , LENGTH , VAL). Using these values I want to create an array on the heap of type TYPE and length LENGTH and have all elements initialized to VAL. So for example

float 8 4 : will create a float array with 8 elements each of which will have a value of 4.

char 4 65 : will create a char array with 4 elements, each of which will have a value of 'A'.

Determining the length is straight forward. But I'm struggling to determine how to initialize the pointer to the array and the VAL.

The following is what I've attempted so far (unsuccessfully). I'm initializing a char pointer, however I know this is incorrect as I may need a float or int pointer instead. I'm also using a switch statement based on the first character of the TYPE, to me this seems very hacky.

```
int main (int argc, char *argv[]){

        int LENGTH;
        char *ptr;

        LENGTH = atoi ( argv[2] );

        switch( *argv[1] ){
                case 'f':
                        printf("Type is float\n");
                        ptr = (float *)malloc(LENGTH * sizeof(float));
                        break;
                case 'c':
                        printf("Type is char\n");
                        ptr = (char *)malloc(LENGTH * sizeof(char));
                        break;
                case 'i':
                        printf("Type is int\n");
                        ptr = (int *)malloc(LENGTH * sizeof(int));
                        break;
                default:
                        printf("Unrecognized type");
                        break;
        }

        while( i < arrayLength ){
                *ptr[i] = *argv[3];
                i++;
        }

        free ( ptr );

        return 0;
} 
```

I can also see issues with the initialization element of the problem. The initial value is dependent on the TYPE so made need to be converted.

What I'm wondering is, without knowing the TYPE beforehand, how can I create the pointer or initialize the values? I'm probably looking at this issue from the wrong direction completely, so any advice would be greatly appreciated.

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:06:06.063

When want a variable in C that can hold different types, you need to use a union like:

```
typedef union {
    float f;
    int i;
    char c;
} arg_type; 
```

Then a variable declared `arg_type argument;` will be large enough to hold the largest member of the union. They are accessed like structure members, for example:

```
argument.f = 0.0;
argument.c = '\n';
argument.i = 12; 
```

However, you need to keep track of what type you did store in there because the compiler can't know which you used. Once the union is defined, you can do

```
char var_type = 'f';
arg_type *p = mallocLENGTH * sizeof(arg_type);
p[0].f = atof(argv[i]) 
```

This is kind of a pain to ensure that you've got it correct though. For example:

```
argument.f = 1234.56;
putchar(argument.c); 
```

will compile but its behavior is undefined. It's often easier to leave things in argv character form and save the parsing until you want to work with a specific type.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T23:19:55.587

Here is the code modified to do what you asked (see notes below):

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h> // for memset()

int main (int argc, char *argv[]){

        int LENGTH;
        int i;

        void *ptr = NULL;

        if(argc < 4)
        {
            fprintf(stderr, "Usage: %s type len data\n", argv[0]);
            return 1;
        }

        LENGTH = atoi ( argv[2] );

        switch( *argv[1] ){
                case 'f':
                        printf("Type is float\n");
                        ptr = (float *)malloc(LENGTH * sizeof(float));
                        for(i = 0; i < LENGTH; i++)   // Cannot use memset in that case: memset(3) only works with integers.
                            ((float *)ptr)[i] = (float)atof(argv[3]);
                        for(i = 0; i < LENGTH; i++)
                            printf("[%d]: %lf\n", i, ((float *)ptr)[i]);
                        break;
                case 'c':
                        printf("Type is char\n");
                        ptr = (char *)malloc(LENGTH * sizeof(char));
                        memset(ptr, (char)atoi(argv[3]), LENGTH);
                        for(i = 0; i < LENGTH; i++)
                            printf("[%d]: %c\n", i, ((char *)ptr)[i]);
                        break;
                case 'i':
                        printf("Type is int\n");
                        ptr = (int *)malloc(LENGTH * sizeof(int));
                        memset(ptr, (int)atoi(argv[3]), LENGTH);
                        for(i = 0; i < LENGTH; i++)
                            printf("[%d]: %d\n", i, ((int *)ptr)[i]);
                        break;
                default:
                        printf("Unrecognized type\n");
                        break;
        }

        if(ptr == NULL)
            return 1;

        free ( ptr );

        return 0;
} 
```

Still, as others pointed out, doing so is pointless. The reason why types are used is to know two things:

1.  The size of the data
2.  How to interepret it

What you are trying to achieve here is a clumsy attempt to do the job of the OS.

To be clear: memory is a contiguous storage and the OS marks it as "allocated" when it is (by functions like `malloc(3)`). When it does so, the program has to know the type of a data to know what to read (a pointer is merely an address), and how to interpret it (`int`s are not stored the same way that `float`s are).

If you are genuinely interested in learning such things (how data is stored, how computer works more generally, and at a lowest level than in C#), I'd recommend you to read:

1.  [MIPS assembly tutorial](http://www.cs.ucsb.edu/~franklin/64/lectures/mipsassemblytutorial.pdf) (first relevant answer from google, any MIPS asm course would be okay)

2.  [x86 Assembly, 6th ed.](https://rads.stackoverflow.com/amzn/click/com/013602212X) if you got the money for it.

Also, if you want to test MIPS assembly, [mars](http://courses.missouristate.edu/kenvollmar/mars/) is a MIPS assembly simulator that works ok (and is free).

I'm glad to see that people are still trying to learn C.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T22:58:25.057

It's difficult to write such generic things in C. C++ is more appropriate. But if you need it in C, then what I would do is declare 3 different pointers, float*, int*, char*. I would allocate and initialize the one corresponding to the user input. Bear in mind, though, that you will need to carry with you some variable to flag what the chosen type is throughout the entire program, and use `if` statements whenever you need to use the array.

# document-root - 如何将文档根目录从根目录更改为 public_html

> ID：13829820
> 
> 赞同：0
> 
> 时间：2012-12-11T22:50:26.073
> 
> 标签：document-root, public-html

为了测试，我将我的网站托管在 000webhost.com 的免费服务器上，它们有一个目录结构：-

（根文件夹） \

（公共文件夹）\public_html

此目录结构可以将所有库文件保存在根文件夹中，并将所有公共数据保存在 \public_html 中，因此我相应地开发了我的网站，我的最终结构如下所示：-

```
/
/include(this folder contains library files)
/logs(log files)
/public_html
/public_html/index.php
/public_html/home.php
/public_html/and other public files 
```

在 000webhost 上，只有 public_folder 可以通过 url 访问，我的 url 看起来像 www.xample.com/index.php 或 www.example.com/home.php 一样干净整洁

但是在完成开发后，我将网站移动到从 go-daddy.com 购买的共享主机，现在他们没有任何此类目录权限，所有文件都保存在根文件夹中，并且可以通过 url 访问，url 也变成了： - www.example.com/public_html/home.php 或 www.example.com/public_html/index.php 我应该如何将 url 请求重新重定向到 public_html 文件夹，以使库文件无法供公众访问并使 url 整洁干净.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-03T15:39:31.660

Godaddy 是否允许您访问 Apache？

如果是这样，您可以修改文档根目录，使公用文件夹与库和日志文件夹处于同一级别。

否则，您将与许多其他使用共享主机的人处于相同的境地，并且必须用文件保护您的文件夹`.htaccess`。

# c# - 从单独程序集中的基类继承时标记 XAML 设计器无效

> ID：13829821
> 
> 赞同：0
> 
> 时间：2012-12-11T22:50:28.720
> 
> 标签：c#, wpf, visual-studio, xaml, designer

我正在尝试在 Visual Studio 中创建一系列 WpfUserControl。我有一个名为的基类，它负责处理驻留在“核心”库中`BindableBase`的所有样板文件。当我尝试在 XAML 中设置数据上下文时，我`INotifyPropertyChanged`所有的 ViewModel 都继承自：`BindableBase`

```
<UserControl.DataContext>
    <local:MyViewModel />
</UserControl.DataContext> 
```

我收到设计器“无效标记”错误。当我检查我的代码时，我被告知*命名空间 [UI 命名空间] 中不存在名称“MyViewModel”。* 我知道这不是真的，因为我可以毫无问题地构建和运行项目，这只是我缺少的设计时功能。

我已经将问题追溯到我的`BindableBase`班级，该班级位于单独的程序集中。如果我用我的 ViewModel 和 View 将它移动到程序集，一切都会很好，但是当我将它移回“核心”命名空间时，设计时功能会中断。

有没有办法解决这个问题？移动我的`BindableBase`类不是一种选择，因为我们有多个 UI 程序集都必须引用该类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T01:17:43.560

我有时也有这个问题。我通常在重新启动并重新打开解决方案后尝试清理和重建我的解决方案。如果失败，我删除有问题的代码，保存并重新启动 Visual Studio，重新打开解决方案并重新键入代码，然后在必要时执行清理并重建。

# c++ - 如何使用 boost::bind 将返回 int 的函数转换为返回 bool 的函数？

> ID：13829824
> 
> 赞同：0
> 
> 时间：2012-12-11T22:50:36.583
> 
> 标签：c++, boost, boost-bind

我有以下内容：

```
 struct A{
  virtual int derp(){ 
      if(herp()) return 1; 
      else return 0; 
   }
  void slurp(){
    boost::function<bool(int x, int y)> purp = /** boost bind derp to match lvalue sig  **/;
  }
 } 
```

有任何想法吗？我想创建基本上调用derp并忽略传入的（x，y）的函数prup。

我需要类似的东西

```
bool purp(int x, int y){ return derp(); } 
```

但想避免将其创建为成员函数，而是尽可能在本地创建它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:20:33.997

如果 C++11 可用，请考虑使用 lambda。否则，您可以使用 Boost.Lambda：

```
boost::function<bool(int x, int y)> purp = !!boost::lambda::bind(&A::derp, this); 
```

`int`这使用to的标准转换`bool`。

`A::derp`如果你想要一个特定的返回值`true`，那么使用`==`. 例如，假设您希望返回值 3 为`true`：

```
boost::function<bool(int x, int y)> purp = boost::lambda::bind(&A::derp, this) == 3; 
```

**编辑：**完整示例：

```
#include <iostream>

#include <boost/function.hpp>
#include <boost/lambda/lambda.hpp>
#include <boost/lambda/bind.hpp>

struct A {
    virtual int derp() {
        std::cout << "within A::derp()\n";
        return 0;
    }
    void slurp() {
        boost::function<bool(int x, int y)> purp = !!boost::lambda::bind(&A::derp, this);
        std::cout << (purp(3, 14) ? "true" : "false") << '\n';
    }
};

int main()
{
    A a;
    a.slurp();
} 
```

输出：

```
在 A::derp() 内
错误的

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T23:11:47.947

我不太确定 boost::bind 库以及如何处理您的情况，但如果您有启用 C++ 的环境，您可以使用 lambda 代替绑定：

```
auto purp = [=](int,int) -> bool { return derp(); };
// alternatively:
//std::function<bool(int,int)> purp = [](int,int)->bool{return derp();}; 
```

有了 lambda 支持，突然绑定似乎不是一个很好的工具 :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T23:16:51.887

```
boost::function<bool(int x, int y)> purp = boost::bind(&A::derp, this); 
```

只要`derp`返回值可以隐式转换为`bool`. 你会在 VC++ 中得到这个恼人的警告：`"warning C4800: 'int' : forcing value to bool 'true' or 'false' (performance warning)"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-11T23:02:45.930

布尔真/假在 C 实现中只是一个整数，你当然可以写一些东西来做到这一点。我不明白这样做的意义或为什么函数包含在结构中。主要问题是为什么要让函数接受参数以便可以忽略它们？为什么不让函数返回 bool 而不是 int ？

# javascript - jquery java script 图像阴影

> ID：13829828
> 
> 赞同：0
> 
> 时间：2012-12-11T22:51:05.670
> 
> 标签：javascript, jquery

我有一张图片，我想限制这张图片上的可点击区域。我希望用户只点击特定区域。我想在这个可点击区域之外获得一个更暗的视图。我如何使用 java 脚本和/或 jquery 来实现这一点。亲切的问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:03:27.813

实现可点击区域的方法有很多：使用图片地图： [http ://en.wikipedia.org/wiki/Image_map](http://en.wikipedia.org/wiki/Image_map)

看看这个网站： http: [//odyniec.net/projects/imgareaselect/](http://odyniec.net/projects/imgareaselect/)

或使用 div 和 z-index。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T23:13:51.607

这可能很困难，但是如果您先使用 a 来确定可点击区域，则可以使用 jquery 执行以下操作：

1.  将鼠标悬停在映射区域上时，显示一个透明的黑色 div，与图像大小相同。（这会使图像变暗）
2.  在其上放置另一个 div，其尺寸与图像相同。（这包含新图像的小地图大小的容器）
3.  在最后一个的内部放置另一个 div，使其大小和位置与您的映射区域相同。（这将包含原始图像 - 未变暗）
4.  再次将图像放置在最后一个 div 的内部并将其定位，使其与原始图像对齐。

这应该显示出您正在谈论的内容。

如果它比这更复杂，我相信我们都需要一个例子和这些图像的所有结果。我认为没有足够的细节来给你一个真正的答案。

# c# - 每次打开 Class.designer.cs 都会发生变化

> ID：13829829
> 
> 赞同：1
> 
> 时间：2012-12-11T22:51:16.500
> 
> 标签：c#, .net-4.0, user-controls, .net-3.5

所以我有一个愚蠢的小问题，我希望这将是一个简单的解决方案。

所以我有一个自定义的用户控件，它基本上只包含一个选项卡控件和一个选项卡（大多只是用作设计选项卡的绘图板）。今天我将我的项目从 VS2008-.net3.5 移到了 VS2010-.net4.0 并且大部分情况下一切看起来都很完美，除了这个自定义用户控件。

每次我在设计器中打开它时，它的名称旁边都会带有 *。如果我保存它，在 VS 中关闭页面然后再次打开它，它又回来了！

我比较了之前和之后，它正在做一些愚蠢的小事情，比如将我的 SplitContainer SplitterDistance 设置为随机长度，并重新排列控件在 Designer.cs 中定义的顺序。这真的很烦人，因为每次打开它都会提示保存并使用源代码控制。并且它一直将其设置为关闭的位置并将控件推离屏幕侧面几个像素。

我尝试手动设置分切机距离，所以到处都有很多空间，但每次打开时它都会做同样的事情。

任何帮助，将不胜感激。

问候，赖特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-09T08:35:22.087

最近为了解决一个类似的问题，我追踪到在设计器生成的“InitializeComponent”方法中设置事件处理程序。

我对 SizeChanged 事件进行了事件处理，经过大量实验，我发现这是问题的原因。所以每当表单的 InitializeComponent 中有一行

someControl.SomeEvent += MyEventHandler

我将它移到构造函数中，就在调用 InitializeComponent 之后。

# ruby - ruby Process.spawn stdout => 管道缓冲区大小限制

> ID：13829830
> 
> 赞同：4
> 
> 时间：2012-12-11T22:51:21.187
> 
> 标签：ruby, process, buffer, pipe, spawn

在 Ruby 中，我使用 Process.spawn 在新进程中运行命令。我已经打开了一个双向管道来从生成的进程中捕获标准输出和标准错误。这很有效，直到写入管道的字节（命令的标准输出）超过 64Kb，此时命令永远不会完成。我认为管道缓冲区大小已被击中，并且对管道的写入现在被阻止，导致该过程永远不会完成。在我的实际应用程序中，我正在运行一个长命令，该命令有很多标准输出，我需要在进程完成时捕获和保存。有没有办法提高缓冲区大小，或者更好的是刷新缓冲区以免达到限制？

```
cmd = "for i in {1..6600}; do echo '123456789'; done"  #works fine at 6500 iterations.

pipe_cmd_in, pipe_cmd_out = IO.pipe
cmd_pid = Process.spawn(cmd, :out => pipe_cmd_out, :err => pipe_cmd_out)

Process.wait(cmd_pid)
pipe_cmd_out.close
out = pipe_cmd_in.read
puts "child: cmd out length = #{out.length}" 
```

**更新** Open3::capture2e 似乎确实适用于我展示的简单示例。不幸的是，对于我的实际应用程序，我还需要能够获得生成进程的 pid，并控制何时阻止执行。一般的想法是我分叉一个非阻塞进程。在这个分叉中，我产生了一个命令。我将命令 pid 发送回父进程，然后等待命令完成以获取退出状态。命令完成后，退出状态将发送回父级。在父级中，每 1 秒循环一次，检查数据库中的控制操作，例如暂停和恢复。如果它得到一个控制动作，它会向命令 pid 发送适当的信号以停止，继续。当命令最终完成时，父级点击救援块并读取退出状态管道，并保存到 DB。这是我的实际流程：

```
#pipes for communicating the command pid, and exit status from child to parent
pipe_parent_in, pipe_child_out = IO.pipe
pipe_exitstatus_read, pipe_exitstatus_write = IO.pipe

child_pid = fork do
    pipe_cmd_in, pipe_cmd_out = IO.pipe
    cmd_pid = Process.spawn(cmd, :out => pipe_cmd_out, :err => pipe_cmd_out)
    pipe_child_out.write cmd_pid  #send command pid to parent
    pipe_child_out.close
    Process.wait(cmd_pid)
    exitstatus = $?.exitstatus
    pipe_exitstatus_write.write exitstatus  #send exitstatus to parent
    pipe_exitstatus_write.close
    pipe_cmd_out.close
    out = pipe_cmd_in.read
    #save out to DB
end

#blocking read to get the command pid from the child
pipe_child_out.close
cmd_pid = pipe_parent_in.read.to_i

loop do
    begin
        Process.getpgid(cmd_pid)  #when command is done, this will except
        @job.reload #refresh from DB

        #based on status in the DB, pause / resume command
        if @job.status == 'pausing'
            Process.kill('SIGSTOP', cmd_pid)
        elsif @job.status == 'resuming'
            Process.kill('SIGCONT', cmd_pid)
        end
    rescue
        #command is no longer running
        pipe_exitstatus_write.close
        exitstatus = pipe_exitstatus_read.read
        #save exit status to DB
        break
    end
    sleep 1
end 
```

注意：我不能让父级轮询命令输出管道，因为父级将被阻塞等待管道关闭。它将无法通过控制回路暂停和恢复命令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T18:21:45.380

此代码似乎可以满足您的要求，并且可能具有说明性。

```
cmd = "for i in {1..6600}; do echo '123456789'; done"

pipe_cmd_in, pipe_cmd_out = IO.pipe
cmd_pid = Process.spawn(cmd, :out => pipe_cmd_out, :err => pipe_cmd_out)

@exitstatus = :not_done
Thread.new do
  Process.wait(cmd_pid); 
  @exitstatus = $?.exitstatus
end

pipe_cmd_out.close
out = pipe_cmd_in.read;
sleep(0.1) while @exitstatus == :not_done
puts "child: cmd out length = #{out.length}; Exit status: #{@exitstatus}" 
```

一般来说，在线程之间共享数据（@exitstatus）需要更多的小心，但它在这里有效，因为它只在初始化之后由线程写入一次。（事实证明 $?.exitstatus 可以返回 nil，这就是我将其初始化为其他内容的原因。）对 sleep() 的调用甚至不可能执行一次，因为它上面的 read() 直到产生才会完成进程已关闭其标准输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T23:03:03.650

事实上，您的诊断可能是正确的。您可以在等待进程结束时在管道上实现一个选择和读取循环，但很可能您可以使用 stdlib 更简单地获得您想要的东西[`Open3::capture2e`](http://ruby-doc.org/stdlib-1.9.3/libdoc/open3/rdoc/Open3.html#method-c-capture2e)。

# php - 根据 $_GET 结果执行 MYSQL 查询

> ID：13829834
> 
> 赞同：0
> 
> 时间：2012-12-11T22:51:42.387
> 
> 标签：php, mysql

当用户单击我的项目页面上的项目时，它会将他们带到使用 $_GET 传递项目品牌和型号的空白页面模板。

当该用户单击以使用我的数据库中的产品详细信息填充空白页面时，我想执行另一个 MYSQL 查询。我想使用型号（唯一 ID）检索单行以使用信息填充页面。我已经尝试了几件事，但遇到了一点困难。

在我的空白项目页面上，我有

```
 $brand = $_GET['Brand'];
                $modelnumber = $_GET['ModelNumber'];

                $query = mysql_query("SELECT * FROM items WHERE `Model Number` = '$modelnumber'");
                $results = mysql_fetch_row($query);

                echo $results; 
```

我认为在型号周围有 '' 会造成麻烦，但是没有它们，我会收到警告：mysql_fetch_row() 期望参数 1 是资源，布尔给定错误。

我的数据库列看起来像

品牌 | 型号 | 价格 | 说明 | 图片

我尝试过的其他一些事情包括

```
$query = mysql_query("SELECT * FROM item WHERE Model Number = $_GET['ModelNumber']"); 
```

这给了我一个语法错误。我还尝试连接 $_GET 这给了我一个 mysql_fetch_row() 期望参数 1 是资源，布尔给定错误

这让我相信我也会错误地显示结果。我不确定我是否需要将它放在一个 where 循环中，就像我在上一页显示数据库中的所有项目一样，因为这只是显示一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:00:40.410

首先，请注意对您的问题的第一条评论。你肯定想添加某种环境，至少 mysql_real_escape_string，尽管 PDO 或 Mysqli 会更受欢迎。

其次，在得到你问题的真正答案之前，让我们了解更多关于你的错误的信息。

尝试以下操作：

```
$brand = mysql_real_escape_string($_GET['Brand']);
$modelnumber = mysql_real_escape_string($_GET['ModelNumber']);

$query = mysql_query("SELECT * FROM items WHERE `Model Number` = '$modelnumber'")OR die(mysql_error());
$results = mysql_fetch_row($query);

var_dump($results); 
```

mysql_error 告诉我们幕后发生了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T23:01:50.183

似乎您的“结果”为单个变量提取了太多信息。另外，我不认为你的表应该有带空格的列名，我建议用破折号或下划线填充它们。

这是我的建议：

```
$qry = mysql_query("SELECT * FROM items WHERE Model_Number = '$modelnumber'"); //REMEMBER TO MAKE THE CHANGE "Model Number" -> "Model_Number"
while($row = mysql_fetch_array($qry)){
    $brand = $row['Brand'];
    $modelnumber = $row['Model_Number'];
    $price = $row['Price'];
    $description = $row['Description'];
    $image = $row['Image'];
} 
```

这将使用您表中的任何内容填充所有这些变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T23:09:09.627

如果您使用 mysql_fetch_row 它只会返回对应于获取行的字符串的数字数组，如果没有更多行，则返回 FALSE [http://php.net/mysql_fetch_row](http://php.net/mysql_fetch_row)

如果您需要检索该行内的数据。您需要使用 mysql_fetch_array()

也尝试使用 mysql_error();

```
 $results = mysql_fetch_row($query) or die(mysql_error()); 
```

您将看到您的代码产生的错误输出

# wix - 使用 XSLT 进行 WiX 3.6 过滤

> ID：13829839
> 
> 赞同：1
> 
> 时间：2012-12-11T22:52:19.293
> 
> 标签：wix, wix3.6

我正在过滤我项目中的所有 .pdb 文件。在互联网上，我看到了几个如何使用 XSLT 执行此操作的示例（因为我不是 XSLT 大师，所以我复制了一些并尝试了一些）。当我有以下 XSLT 脚本时：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:wix="http://schemas.microsoft.com/wix/2006/wi">
  <xsl:output method="xml" indent="yes" />
  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
  </xsl:template>
  <xsl:key name="service-search" match="wix:Component[contains(wix:File/@Source, '.pdb')]" use="@Id" />
  <xsl:template match="wix:ComponentRef[key('service-search', @Id)]" />
</xsl:stylesheet> 
```

但是当我使用预构建事件命令执行此操作时：

```
call "C:\Program Files (x86)\WiX Toolset v3.6\bin\heat.exe" dir "..\bin" -t Filter.xslt -sfrag -cg "WebBinaries" -gg -srd -var "var.$(ProjectName).TargetDir" -dr "WebBin" -out "$(SolutionDir)\Deployment\$(ProjectName).binaries.wxs" 
```

我收到以下错误：找到孤立组件......对 pdb 文件的引用已正确删除，但对已删除组件的引用仍然存在

当我改变

```
<xsl:template match="wix:ComponentRef[key('service-search', @Id)]" /> 
```

到

```
<xsl:template match="wix:ComponentRef[key('service-search', @Id)]" /> 
```

我收到另一个错误：未解析的对符号的引用............在部分片段中

有谁知道如何解决这个问题？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T20:37:42.110

我用以下 xslt 修复了它：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:wix="http://schemas.microsoft.com/wix/2006/wi">
  <xsl:output method="xml" indent="yes" />
  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
  </xsl:template>
  <xsl:key name="service-search" match="wix:Component[contains(wix:File/@Source, '.pdb')]" use="@Id" />
  <xsl:template match="wix:Component[key('service-search', @Id)]" />
  <xsl:template match="wix:ComponentRef[key('service-search', @Id)]" />
</xsl:stylesheet> 
```

# c# - 将相关列（如果有）提取到 NpgsqlException 或其他约束违规的有效方法

> ID：13829840
> 
> 赞同：0
> 
> 时间：2012-12-11T22:52:27.150
> 
> 标签：c#, nhibernate, npgsql

大家好，感谢阅读。

我正在使用 NHibernate 和 PostgreSQL，基本上我想做两件事：

1.  在将实体持久保存在数据库中时，为错误提供用户友好的消息
2.  调整 UI 以显示特定部分中的错误（因此，如果名称必须是唯一的并且用户介绍了一个已经存在的名称，我想将错误显示为名称文本框的工具提示或其他任何内容）。

所以我认为找到约束检查失败的列会很有用，我正试图找到一种干净的方法来做到这一点。例如，当字段未通过“非空”约束时，NHibernate 会抛出 PropertyValueException，并且此（异常）类有一个名为“PropertyName”的属性，它告诉我未通过约束的属性。这是我想要得到的，但是获取列听起来更容易，我想我可以从列名中获取相关属性。

那么，有没有一种（干净的）方法可以从 NpgsqlException 中提取相关列？或者使用 NHibernate 类似的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T09:36:39.847

有用于此目的的钩子 ISqlExceptionConverter。配置它

```
config.SetProperty(NHibernate.Cfg.Environment.SqlExceptionConverter, typeof(MyNpgSqlExceptionConverter)); 
```

或者

```
using NHibernate.Cfg.Loquacious;

config.DataBaseIntegration(d => d.ExceptionConverter<MyNpgSqlExceptionConverter>()); 
```

并像这样实现它

```
class MyNpgSqlExceptionConverter : ISQLExceptionConverter
{
    public Exception Convert(AdoExceptionContextInfo adoExceptionContextInfo)
    {
        var npgsqlException = (NpgsqlException)adoExceptionContextInfo.SqlException;

        switch (npgsqlException.Code)
        {
            case "<errorcode for duplicate key>":
                return new WhateverException(...);
                break;
            default:
                break;
        }
    }
} 
```

# jquery - 如何将 UTC 日期时间转换为本地时间 Jquery

> ID：13829844
> 
> 赞同：0
> 
> 时间：2012-12-11T22:52:59.290
> 
> 标签：jquery, asp.net

我将 2012 年 12 月 11 日下午 1 点（我在安大略省，这是美国东部标准时间）插入 Web 表单并将其发布到我的**本地 Web 服务器**，然后将其转换为**UTC**时间（Asp.Net start_date = CDate(start_date).ToUniversalTime ）之前我将它保存在数据库中。UTC 时间是数据库字段中的下午 6 点。我使用以下代码（见下文）将保存的 UTC 日期时间转换为用户，并愉快地显示下午 1 点（GMT-5:00）。

当我在加利福尼亚的生产服务器上发布下午 1 点的同一时间时，数据库中保存的时间是晚上 9 点。所以 GMT-8:00 应该在客户端的浏览器上给我下午 1 点。通过生产服务器显示的时间是**晚上 7 点**？为什么以及是否有解决办法？

我通过 asp.net json 从数据库返回值，然后使用 moment.js 将其转换为 UTC 数字，然后运行 ​​utcToLocal 函数。**如何显示预期的下午 1 点？**

```
 function utcToLocal(utc) {
            // Create a local date from the UTC string
            var t = new Date(Number(utc));

            // Get the offset in ms
            var offset = t.getTimezoneOffset() * 60000;

            // Subtract from the UTC time to get local
            t.setTime(t.getTime() - offset);

            // do whatever
            var d = [t.getFullYear(), t.getMonth(), t.getDate()].join('/');
            d += ' ' + t.toLocaleTimeString();
            return d;
        }

    //.format("YYYY-MM-DD h:mm a")
        function Get_History(filter_date, msg) {
            //div_history

            var jsonText = JSON.stringify({
                filter_date: filter_date, UserID: userid
            });

            $.ajax({
                type: "POST",
                url: "cc_m.aspx/getHistory",
                data: jsonText,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data.d != "0") {
                        var obj = $.parseJSON(data.d);
                        $('.div_history').html('');
                        $.each(obj, function (index, value) {
                            $('.div_history').append(                                    
                                "<div class='grid_history' style='border: solid 1px silver;'>" +                                               
                                "Group: " + value.Group_Name + "<br/>" +
                                "Teacher: " + value.Teacher + "<br/>" +
                                "Child: " + value.Child_Name + "<br/>" +
                                "Category: " + value.Category + "<br/>" +
                                "Item: " + value.Item + "<br/>" +
                                "From: " + utcToLocal(moment.utc(value.Start_Date)) + "<br/>" +
                                "To: " + utcToLocal(moment.utc(value.End_Date)) + "<br/>" +
                                "Note: " + value.Other + "<br/>" +
                                "Status: " + value.Status + "<br/>" +
                                "<fieldset data-role='controlgroup' data-type='horizontal' data-mini='true' >" +
                                "<button class='send_item' rel='" + value.id_Group + "' data-icon='envelope' data-theme='b' >Send</button>" +
                                "<button class='edit_item' rel='" + value.id + "' data-icon='edit' data-theme='a' >Edit</button>" +
                                "<button class='reset_item' rel='" + value.id + "' data-icon='repeat' data-theme='a' >Reset</button>" +
                                "<a data-role='button' class='delete_item' rel='" + value.id + "' data-icon='remove' data-theme='a' href='#popup_delete' data-rel='dialog'>Delete</a><br/>" +
                                "</fieldset></div><br/>"    

                            );
                            $(".div_history").trigger("create");
                            //on add history update msg at top of page to NEW RECORD! or ACTIVITY RECORDS SENT! or ACTIVITY RESET TO PENDING! and scroll to top
                            //if (msg.length > 0) {
                            $(".grid_msg").html(msg);
                            //}
                        });

                        }
                    } //end success
            });

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T00:03:39.787

我最终使用以下内容在服务器上转换了 UTC，并使用以下内容将日期（作为字符串）返回给客户端应用程序......

```
Public Shared Function GetJson(ByVal dt As DataTable) As String

    Dim serializer As System.Web.Script.Serialization.JavaScriptSerializer = New System.Web.Script.Serialization.JavaScriptSerializer()
    Dim rows As New List(Of Dictionary(Of String, Object))
    Dim row As Dictionary(Of String, Object)

    For Each dr As DataRow In dt.Rows
        row = New Dictionary(Of String, Object)
        For Each col As DataColumn In dt.Columns

            If col.ColumnName = "Start_Date" Or col.ColumnName = "End_Date" Then
                'insert default date
                Dim convertedDate As String = TimeZoneInfo.ConvertTimeFromUtc(dr(col), TimeZoneInfo.FindSystemTimeZoneById("Pacific Standard Time"))
                row.Add(col.ColumnName, convertedDate)
            Else
                row.Add(col.ColumnName, dr(col))
            End If

        Next
        rows.Add(row)
    Next
    Return serializer.Serialize(rows)
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T09:52:34.967

也许更简单的方法是使用[https://github.com/GregDThomas/jquery-localtime](https://github.com/GregDThomas/jquery-localtime)上的插件- 它只需要服务器传递给客户端的 UTC 字符串，然后使用本地时区的客户端知识来呈现给用户。

# jquery - Fancybox 弹出窗口和 cookie 不起作用

> ID：13829847
> 
> 赞同：3
> 
> 时间：2012-12-11T22:53:08.083
> 
> 标签：jquery, fancybox, shopify

我一直在 shopify 网站上通过 fancybox 安装表单，同时使用 cookie 仅在第一次访问时显示。我在加载页面时遇到花式框出现问题，但是如果我取出花式框代码，表单会内联加载到页面上。这让我怀疑我在调用fancybox时做错了什么。另外，我认为 cookie 不能正常工作。我没有通过 Firebug 看到它们。

这是我的 index.liquid 底部的代码

```
 <script type="text/javascript">
    jQuery(document.ready(function() {
        if ($.cookie('rrp8')) {
         // it hasn't been 120 days yet
      } else {
          $.fancybox(
   '<div id="home-pop"><p style="text-align: left;">Sign up here for updates on new classes, future dates &amp; more</p><form action="https://www.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8" method="POST"><input type="hidden" name="oid" value="00DU0000000J1yb" /><input type=hidden name="oid" value="00DU0000000J1yb"><input type=hidden name="retURL" value="http://cdn.shopify.com/s/files/1/0149/4308/files/pop-up-thanks.png?76"><input type=hidden name="LeadSource" value="Training Store"><div><table><tbody><tr><td><label for="first_name">First Name:</label><br><input id="first_name" type="text" name="first_name" size="26" maxlength="40" />&nbsp;<br></td></tr><tr><td><label for="last_name">Last Name:</label><br><input id="last_name" type="text" name="first_name" size="26" maxlength="40" />&nbsp;<br></td></tr><tr><td><label for="email">Email:</label><br><input  id="sf_email" maxlength="80" name="email" size="26" type="text" /><br></td></tr><tr><td><label for="company">Company:</label><br><input  id="company" maxlength="40" name="company" size="26" type="text" /><br></td></tr><tr><td><input type="submit" name="submit" value="Submit"></td></tr></tbody></table></div></form></div>',
             {
                 'autoDimensions'    : true,
                 'width'             : 570,
                 'height'            : 530,
                 'transitionIn'      : 'fade',
                 'transitionOut'     : 'fade'
              }
          );
       }
   });
   // set cookie to expire in 120 days
   $.cookie('rrp8', 'true', { expires: 120});
   </script> 
```

这是theme.liquid中的代码

```
 <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js" type="text/javascript"></script>
    {{ 'jquery.mousewheel-3.0.4.pack.js' | asset_url | script_tag }}
    {{ 'jquery.fancybox-1.3.4.pack.js' | asset_url | script_tag }}
    {{ 'jquery.cookie.js' | asset_url | script_tag }}
    {{ 'jquery.fancybox-1.3.4.css' | asset_url | stylesheet_tag }} 
```

我在shopify论坛上发布了这个，但我还没有收到回复。我希望有人可以提供帮助。

*更新* 当我将以下“简化”代码添加到纯 html 文件时，fancybox 工作。当我将它添加到 Shopify 时，什么也没有出现。我认为我的错误在shopify的某个地方，只是不知道在哪里。$(function(){ var myContent = '在这里注册以获取有关新课程、未来日期等的更新

名字：

姓氏：

电子邮件：

公司：

';

```
 $.fancybox(myContent,
                 {
                     'autoDimensions'    : true,
                     'width'             : 570,
                     'height'            : 530,
                     'transitionIn'      : 'fade',
                     'transitionOut'     : 'fade'
                  }
              );
    });

    </script>
    </head>
    <body>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T22:11:16.757

为了回答您让 cookie 部分工作的问题，我修改了您的 jsfiddle，它似乎工作正常。

我所做的只是确保包含 jquery cookie 插件。

也许您的 jquery.cookie javascript 文件没有加载？您是否检查过 firebug/chrome 的检查器以确保所有资源都在加载？

> ```
> <script src="http://cdn.jsdelivr.net/jquery.cookie/1.3/jquery.cookie.js"></script> 
> ```

您可以像我上面那样从 CDN 加载它，或者从 github 下载它：[https ://github.com/carhartl/jquery-cookie/blob/master/jquery.cookie.js](https://github.com/carhartl/jquery-cookie/blob/master/jquery.cookie.js)

# JSFiddle

[http://jsfiddle.net/DigitalBiscuits/Wp6LT/2/](http://jsfiddle.net/DigitalBiscuits/Wp6LT/2/)

运行一次小提琴并显示表单，再次运行它，警报将指示已找到 cookie。

# 顺便一提...

您可能应该更新您正在使用的 jQuery 版本。我们现在是 1.8，但你的已经回到 1.4

这是 1.8 的 CDN：

> ```
> <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script> 
> ```

# c++ - How do I return a value of an overloaded binary operator

> ID：13829848
> 
> 赞同：0
> 
> 时间：2012-12-11T22:53:08.910
> 
> 标签：c++, c++11

> **Possible Duplicate:**
> [How to deduce the type of the functor’s return value?](https://stackoverflow.com/questions/12005749/how-to-deduce-the-type-of-the-functors-return-value)

Given the following examples:

```
<type>& operator+(const <type>& rhs) {
   // *this.data + rhs
} 
```

How do I return the value of the summation in an object of type < type>?

If I code:

```
<type>& operator+(const <type>& rhs) {
   <type> cell;
   switch(rhs.type {
   case DOUBLE:
   {
     cell.data = (double)cell.data + (double)rhs.data;  
   }
   return cell;
} 
```

I return a temporary stack value, and receive an error message.

If I code:

```
<type>& operator+(const <type>& rhs) {
  *this.data = *this.field + rhs.data;
  return *this;
} 
```

I overwrite this which is not the intent of the addition.

This is just an example. The 'real' code requires that I be able to add (subtract, ...) any number of input data types, which in it's turn requires that the return value is able to accommodate any on of several types, which it can and does.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-11T22:56:03.597

`operator+`应该按值返回，而不是按引用返回。由于操作员不应该修改左侧或右侧，您需要第三个对象来修改。您必须在函数内部创建那个。而且由于您不能返回对局部变量的引用，因此最好的办法是按值返回。

```
<type> operator+(const <type> &rhs) {
  <type> sum = *this;
  sum.data = sum.data + rhs.data;
  return sum;
} 
```

相反，`operator+=`它应该通过引用返回，因为`+=`无论如何都应该修改左侧。

```
<type> &operator+= (const <type> &rhs) {
    this->data += rhs.data;
    return *this;
} 
```

然后你可以`+`根据`+=`.

```
<type> operator+(const <type> &rhs) {
  <type> sum = *this;
  return sum += rhs;
} 
```

此外，通常`operator+`将作为非成员函数实现，以便左右两侧的转换都能正常工作。与左侧的成员函数转换不一样。

```
<type> operator+(<type> lhs, const <type> &rhs) {
    return lhs += rhs;
} 
```

加上这种方式，您可以按价值取左侧，并可能利用复制/移动省略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:57:02.937

最简单也可能是最好的方法是将返回类型从 更改`<type>&`为`<type>`。

# objective-c - 在 for 循环中使用 CGPoint 的动画

> ID：13829849
> 
> 赞同：0
> 
> 时间：2012-12-11T22:53:12.460
> 
> 标签：objective-c, xcode, animation, cgpoint

我正在尝试制作一个动画，当一个人在屏幕上从 A 点点击到 B 点时，对象应该从 A 点慢慢地（水平）滑过（水平）到 B 点。顺便说一下，我是动画新手。

```
 [UIView animateWithDuration:10
                              delay:0
                            options:nil
                         animations:^ {

                             if(magnifier != nil){
                                 [magnifier removeFromSuperview];

                             }

                             magnifier = [[MagnifierView alloc] init];

                             magnifier.viewToMagnify = imageView;
                             magnifier.touchPoint = newPoint;
                             [imageView addSubview:magnifier];
                             [magnifier setNeedsDisplay];                             
                         } 
                         completion:nil]; 
```

但由于某种原因，它正在向上移动，然后最终到达 B 点。有点奇怪。

我怎样才能正确地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T22:54:57.637

不要使用循环。只需使用您拥有的动画块。

*   在块之前，将对象设置为点 A。
*   在块中，将其设置为 B 点。块将使其动画。
*   此外，在动画块之外初始化您的对象。

例子：

```
// initialize your object outside the block
magnifier = [[MagnifierView alloc] init];
[magnifier setFrame:CGRectMake(0, 0, 100, 100)]; // for example, start at 0, 0 (width and height set to 100 for demo purposes)
[imageView addSubview:magnifier];

[UIView animateWithDuration:10
 delay:0
 options:nil 
 animations:^ {

    // inside the animation block, put the location you want the magnifier to move to
    [magnifier setFrame:CGRectMake(500, 0, 100, 100)]; // for example, move to 500, 0

} 
completion:^(BOOL finished) {

    // do anything you need after here

}]; 
```

`UIViewAnimationOptionCurveEaseInOut`如果您想要在动画的开始和结束时使用缓动效果，或者`UIViewAnimationOptionCurveLinear`如果您想要一个没有缓动的等时动画（还有其他可用的，请查找 UIViewAnimationOptions），您也可以设置选项。

# objective-c - 将 GameCenter 添加到仅限横向的 cocos2d 应用程序后，iOS 6 出现错误

> ID：13829851
> 
> 赞同：1
> 
> 时间：2012-12-11T22:53:32.217
> 
> 标签：objective-c, ios, cocos2d-iphone, orientation, game-center

我遇到了这里描述的问题： [https](https://devforums.apple.com/thread/165384?tstart=0) ://devforums.apple.com/thread/165384?tstart= 0 我的应用程序在尝试加载 GameCenter 登录屏幕时崩溃，因为屏幕是纵向的，而我的应用程序只支持横向。我已经尝试了上述线程中描述的所有解决方案，以及以下线程中的所有解决方案： [Crash on presenting UIImagePickerController under iOS 6.0](https://stackoverflow.com/questions/12522491/crash-on-presenting-uiimagepickercontroller-under-ios6/12575058#12575058) And here: [http://www.cocos2d-iphone.org/forum/topic/36639](http://www.cocos2d-iphone.org/forum/topic/36639)

任何解决方案都不起作用。要么崩溃仍然发生，要么登录工作正常，然后我的应用程序在横向和纵向之间自由旋转，或者它将自己锁定为纵向并搞砸了整个 UI。

我想要的是让 GameCenter 登录以纵向工作，然后让应用程序中的其他所有内容以横向工作。

这是我的应用程序中包含的所有旋转方法。这些来自 appdelegate.m 中的 myNavigationController 实现：

```
 -(NSUInteger)supportedInterfaceOrientations {

    // iPhone only
    if( [[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone )
        return UIInterfaceOrientationMaskLandscape;

    // iPad only
    return UIInterfaceOrientationMaskLandscape;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // iPhone only
    if( [[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone )
        return UIInterfaceOrientationIsLandscape(interfaceOrientation);

    // iPad only
    // iPhone only
    return UIInterfaceOrientationIsLandscape(interfaceOrientation);
}

-(BOOL)shouldAutorotate{

    return NO;
 } 
```

从 appDelegate.m 中的 AppController 实现：

```
 - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return UIInterfaceOrientationIsLandscape(interfaceOrientation);
} 
```

包含在 RootViewController.m 中：

```
 -(BOOL)shouldAutorotate{
        return NO;
}

- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskLandscapeRight|UIInterfaceOrientationMaskLandscapeLeft;
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
    return UIInterfaceOrientationLandscapeRight;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
        return NO;
    }

#if GAME_AUTOROTATION==kGameAutorotationNone
    return ( interfaceOrientation == UIInterfaceOrientationPortrait );

#elif GAME_AUTOROTATION==kGameAutorotationCCDirector
    if( interfaceOrientation == UIInterfaceOrientationLandscapeLeft ) {
        [[CCDirector sharedDirector] setDeviceOrientation: kCCDeviceOrientationLandscapeRight];
    } else if( interfaceOrientation == UIInterfaceOrientationLandscapeRight) {
        [[CCDirector sharedDirector] setDeviceOrientation: kCCDeviceOrientationLandscapeLeft];
    }

#elif GAME_AUTOROTATION == kGameAutorotationUIViewController
#else
#error Unknown value in GAME_AUTOROTATION

#endif // GAME_AUTOROTATION
    // Shold not happen
    return NO;
}

kGameAutorotationUIViewController

#if GAME_AUTOROTATION == kGameAutorotationUIViewController
-(void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{

    CGRect screenRect = [[UIScreen mainScreen] bounds];
    CGRect rect = CGRectZero;

    if(toInterfaceOrientation == UIInterfaceOrientationPortrait || toInterfaceOrientation == UIInterfaceOrientationPortraitUpsideDown)
        rect = screenRect;

    else if(toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft || toInterfaceOrientation == UIInterfaceOrientationLandscapeRight){
        rect.size = CGSizeMake( screenRect.size.height, screenRect.size.width );
    }

    CCDirector *director = [CCDirector sharedDirector];
    UIView *glView = [[CCDirector sharedDirector] view];;
    float contentScaleFactor = [director contentScaleFactor];

    if( contentScaleFactor != 1 ) {
        rect.size.width *= contentScaleFactor;
        rect.size.height *= contentScaleFactor;
    }
    glView.frame = rect;
}
#endif // GAME_AUTOROTATION == kGameAutorotationUIViewController 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:51:01.057

几天前刚刚在这里回答了这个问题： [Cocos 2d 2.0 shouldAutorotate not working？](https://stackoverflow.com/questions/13718761/cocos-2d-2-0-shouldautorotate-not-working/13736022#13736022)

有关于您需要做什么才能使其在该答案中起作用的说明。希望这可以帮助！

# amazon-web-services - 人们如何通过 amazon Auto Scaling 组中的缩减来处理连接丢失？

> ID：13829854
> 
> 赞同：9
> 
> 时间：2012-12-11T22:53:39.520
> 
> 标签：amazon-web-services

据我了解，当 Amazon Auto Scaling 组缩减规模时，任何打开到已终止实例的连接都会丢失 - 没有正常终止。

我想知道其他人是如何处理这个问题的。

我的想法是连接的发起者应该处理失败，因为它应该能够处理实例失败而不是被故意终止的情况。

有什么想法吗？

谢谢，

皮特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-08-23T15:11:51.063

如果您使用的是负载均衡器，您可以在“实例”选项卡上打开连接耗尽选项。它允许您设置在终止实例之前等待连接关闭的时间。最大值为 3600 秒。请参阅[https://aws.amazon.com/blogs/aws/elb-connection-draining-remove-instances-from-service-with-care/](https://aws.amazon.com/blogs/aws/elb-connection-draining-remove-instances-from-service-with-care/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T19:17:33.573

您通常在自动扩展的实例前使用弹性负载均衡器 (ELB)。负载均衡器将停止向即将终止的实例发送请求。例如，如果您使用以下格式：

```
as-put-scaling-policy MyScaleDownPolicy --auto-scaling-group MyAutoScalingGroup  --adjustment=-1 --type ChangeInCapacity  --cooldown 300 
```

您将有足够的时间让您的实例在终止之前完成对它的请求的处理。

在此处查看更多详细信息：http: [//docs.amazonwebservices.com/AutoScaling/latest/DeveloperGuide/US_SetUpASLBApp.html](http://docs.amazonwebservices.com/AutoScaling/latest/DeveloperGuide/US_SetUpASLBApp.html)

请注意，您应该对这些实例有一个 ELB 组。来自[AWS Auto-scaling 文档](http://docs.amazonwebservices.com/AutoScaling/latest/DeveloperGuide/AS_Concepts.html)：

> 在 Auto Scaling 确定要终止哪个特定实例后，它会检查该实例是否属于 Elastic Load Balancing 组。如果是这样，Auto Scaling 会指示负载均衡器从负载均衡组中删除实例并等待删除完成。如果 Auto Scaling 确定实例不属于 Elastic Load Balancing 组，则 Auto Scaling 会尝试通过运行系统关闭脚本来终止实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-28T06:45:44.623

我这样做的方式是使用生命周期挂钩。这可以在一定时间内中断终止过程（默认为 1 小时）。

它旨在在您的工作完成后恢复，但超时适用于 hacky 连接耗尽。

> 您可以选择将处于此状态的 Auto Scaling 组实例添加到 Terminating:Wait 状态。此状态允许您在这些实例终止之前访问它们。

来源：[http ://docs.aws.amazon.com/AutoScaling/latest/DeveloperGuide/AutoScalingGroupLifecycle.html](http://docs.aws.amazon.com/AutoScaling/latest/DeveloperGuide/AutoScalingGroupLifecycle.html)

缺点：通过 CLI 设置，但还不错。

如何做到这一点： [http ://docs.aws.amazon.com/AutoScaling/latest/DeveloperGuide/adding-lifecycle-hooks.html](http://docs.aws.amazon.com/AutoScaling/latest/DeveloperGuide/adding-lifecycle-hooks.html)

创建 IAM 时，您将需要此策略：

```
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Action": [
        "autoscaling:PutLifecycleHook",
        "autoscaling:DeleteLifecycleHook",
        "autoscaling:RecordLifecycleActionHeartbeat",
        "autoscaling:CompleteLifecycleAction",
        "autoscaling:DescribeAutoscalingGroups",
        "autoscaling:DescribeLifecycleHooks",
        "autoscaling:PutInstanceInStandby",
        "autoscaling:PutInstanceInService",
        "iam:AddRoleToInstanceProfile",
        "iam:CreateInstanceProfile",
        "iam:CreateRole",
        "iam:PassRole",
        "iam:ListInstanceProfiles",
        "ec2:Describe*"
      ],
      "Effect": "Allow",
      "Resource": "*"
    }
  ]
} 
```

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-30T01:23:24.610

EC2/AutoscalingGroups 的搜索空间没有解决方案。我不认为等待从 ELB 中删除完成意味着等待现有连接关闭。ELB 确实强制执行自己的不可配置超时，但即使假设当 ELB 报告任何打开的连接时该组将等待该超时也是乐观的。

一个可能的答案是扩展到其他 AWS 产品，例如 SQS 和 SNS。这两个可以代表大部分终止策略，因为它们也可以由 CloudWatch 警报触发。缺少的部分是工人选择、冷却时间和重置警报。

# javascript - Resource requests from webpages fail, but direct request work

> ID：13829856
> 
> 赞同：0
> 
> 时间：2012-12-11T22:53:41.897
> 
> 标签：javascript, html, apache, http, centos

I've installed CentOS and LAMP on an old desktop at home to practice system administration and webadmining, but I'm running into a strange problem.

I have a webpage that's no more than:

```
<!DOCTYPE html>
<html
    <head>
        <script type="text/javascript" src="test.js"></script>
    </head>
    <body>
    </body>
</html> 
```

The chrome console is telling me that the request for test.js is failing. When I right click the link it gives and open it in a new tab, it correctly shows.

Is there a setting in apache that I need to set for this to work?

edit: Only thing in the logs is about the favicon

edit:

Some additional details: I'm accessing via the local ip of the machine, external script and stylesheet requests work, and all the files are in the same directory.

edit: Using fiddler, it looks like chrome isn't even sending out the request for the files.

edit: The response headers for the webpage include "Connection: close"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:04:03.580

确保包含该 HTML 代码的文件和 test.js 位于同一目录中。我怀疑这就是问题所在。

如果您双击系统上的文件，它不会通过 apache 打开。如果您通过 则打开 html `http://localhost/test.html` chrome 将搜索到 test.js 中 `http://localhost/test.js`

# entity-framework - EntityFramework 5 - Change Initial Order of Items in Collection (NavigationProperty)

> ID：13829863
> 
> 赞同：0
> 
> 时间：2012-12-11T22:54:16.780
> 
> 标签：entity-framework, entity-framework-5

is it possible to change the item's order in a collection that is a navigationProperty?

sample:

A Entity "Order" has many "Item" Entities. One to Many Relation.

i want that all items of an order a sorted by the name. How could i do that without a query on the DbSet? I want that the items are sorted after i load them into the context.

Is this possible to manipulate the generated SQL Query from the EF to add a ORDER BY ?

Thx for the help!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:25:10.847

不可以。当您以任何方式处理项目时（例如，为了展示），您必须这样做。

# objective-c - Application sound volume mac os

> ID：13829868
> 
> 赞同：2
> 
> 时间：2012-12-11T22:54:39.093
> 
> 标签：objective-c, macos, audio, applescript, volume

I want to know if there is any way to get the sound volume of a specific application and change it, or to get all the applications that have a sound output in mac.

I want to know if i can do that using objective-c, C, or C++.

I have tried applescripts but i found it hard to depend on applescripts, because not all applications give that access through applescript, and even if so, i will not be able to treat all applications in the same way, because that will depend on how the applescript was written.

I do not want an exact answer, i just want a clue or a way i can search in

Thanks in advance

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T08:23:24.993

一些应用程序在它们的 AppleScript 字典中有一个属性。

```
tell application "iTunes"
    sound volume -- 0 to 100
end tell

tell application "QuickTime Player"
    audio volume of document 1 -- 0.0 to 1.0
end tell 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:36:59.467

你为什么不改变系统音量呢？以下是 AppleScript：

```
set volume output volume 40
return output volume of (get volume settings) 
```

如果你愿意，你可以使用 NSAppleScript 来执行这些单行代码，尽管也应该有一种直接的方法来做到这一点。

# python - why use str() is better than __str__()

> ID：13829869
> 
> 赞同：2
> 
> 时间：2012-12-11T22:54:44.653
> 
> 标签：python

Some time ago I asked one question, and a lot of people suggested me to change `__str__()` to `str(some object)`.

for example:

```
e_address   = f_name+l_name+year.__str__()+day.__str__() 
```

Change to :

```
e_address   = f_name+l_name+str(year)+str(day) 
```

So my question is why it is better? Are there any performance difference, or it is more pythonic way of programming?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-11T22:55:50.533

`__str__()``str()`是如果存在则调用的钩子方法。如果没有定义这样的方法，该`str()`函数将退回到合理的默认值。钩子是用来覆盖默认行为的，你不应该假设它们总是被实现。

此外，仅使用`str()`可调用对象更具可读性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-11T22:56:05.407

打字更少，代码更容易阅读。

# node.js - why servername:port does not work why localhost:port in node.js works?

> ID：13829870
> 
> 赞同：0
> 
> 时间：2012-12-11T22:54:47.520
> 
> 标签：node.js

I am node newbie. I have a windows server, where I am running node.js with [webserver.js](https://gist.github.com/2573391). Start the node with webserver.js. Fireup the IE and when I tried localhost:port/index.html, the page shows properly in the IE. Now if I change the localhost to servername:port/index.html, IE is unable to display the page ('IE cannot display the webpage with you can try diagnose connection problem). Is there anything I need to enable in node so it is available outside localhost? I have jenkins runs on the same server, I did not do anything and it shows up properly with the server name. Just curious.

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T17:53:07.357

我的问题是，我使用了链接中的代码，在链接中它使用了 IP 地址，我将其更改为服务器名称，现在我可以使用服务器和正确的 url 来访问链接。希望这可能对其他人有所帮助。我没有改变使用 netstat。

# coldfusion - Does IntelliJ Community Edition support CFML plugin?

> ID：13829874
> 
> 赞同：2
> 
> 时间：2012-12-11T22:55:13.327
> 
> 标签：coldfusion, intellij-idea

I know the premium edition has a CFML plugin, but does the Community Edition? I really need to get away form using Eclipse. If all else fails I can use the Premium trial for the time being.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T23:03:16.687

此插件仅在 IntelliJ IDEA Ultimate Edition 中可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-06T10:41:17.827

CFML/Coldfusion 插件不适用于 IntelliJ 社区版。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-12T22:27:47.523

我会使用 Sublime Text 2，这里有[Sublime Text 2](http://www.sublimetext.com/2)

有一个非常好的 ColdFusion 插件可供它使用，更不用说它拥有的整个插件生态系统了。

# javascript - MongoDB: How to make sure that Javascript is waiting for processes?

> ID：13829876
> 
> 赞同：2
> 
> 时间：2012-12-11T22:55:15.573
> 
> 标签：javascript, mongodb, benchmarking, wait, measurement

I asked myself, whether javascript (concerning mongoDB) waits for the execution of mongoDB processes.

For example:

Im inserting documents like

```
for (i=0; i<=myarray.length -1; i++)
{
        db.mycol.insert(myarray[i]);
} 
```

If I check the col status directly after that only see a few documents in the db or even 0\. (e.g. instead of 100 only 29 or 0). When I execute the sleep() function with e.g. sleep(10000) I can see all may inserted documents.

So my question is, how can I make sure, that javascript waits for the complete insert? Or how can I measure that? At the moment I'm using

```
start = new Date().getTime();

for (i=0; i<=myarray.length -1; i++)
{
        db.mycol.insert(myarray[i]);
}
end = new Date().getTime();
time = end - start; 
```

But if the insert-process isn't completed, the measurement of that function seems senseless to me.

edit:

by using `db.getLastError({w:1});`

I receive to following error:

uncaught exception: getlasterror failed: { "singleShard" : "replica2/ip:port,ip:port", "n" : 0, "lastOp" : NumberLong("5824731790958395692"), "connectionId" : 111744, "assertion" : "wrong type for field (w) 3 != 2", "assertionCode" : 13111, "errmsg" : "db assertion failure", "ok" : 0 } failed to load: ... myscript.js

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T23:18:55.460

如果您想等到 MongoDB 写入数据，您可以[`getLastError`](http://docs.mongodb.org/manual/reference/commands/#getLastError)使用您希望等待的任何选项进行调用。

像这样：

```
start = new Date().getTime();
for (i=0; i<=myarray.length -1; i++) {
    db.mycol.insert(myarray[i]);
}
db.getLastError({w:1});
end = new Date().getTime();
time = end - start; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T11:49:53.397

尝试这个：`db.getLastError({w: majority});`

# android - google maps not showing on android device

> ID：13829877
> 
> 赞同：5
> 
> 时间：2012-12-11T22:55:20.163
> 
> 标签：android, google-maps

Android device only shows tiles for map. Seems to be widely reported. I followed the instructions of this link:

```
https://developers.google.com/maps/documentation/android/start 
```

I did the following:

1) In Eclipse, I signed in Release Mode. I select File > Export. Selected Export Android Application, and clicked Next. Created a new keystore. Then uploaded the apk to google play.

2) Android app worked on device but map didnt show. It just showed tiles.

3) So I followed the instructions in the link above.

4) I located the keystore file that I created above. My keystore is called ziggy.keystore and alias is ziggy keystore.

5) I ran this in terminal on Mac OSX:

```
keytool -list -v -keystore ziggy.keystore -alias ziggy\ keystroke 
```

6) The above command produces output that includes a line that contains the certificate's SHA-1 fingerprint. The fingerprint is the sequence of 20 two-digit hexadecimal numbers separated by colons.

7) Now that I have the signing certificate fingerprint, I created a project for the application in the Google APIs Console. In a browser, I navigated to [https://code.google.com/apis/console/](https://code.google.com/apis/console/)

8) I clicked Create Project. I named it API project. I see a list of APIs and services in the main window.

9) I scroll down until I see Google Maps Android API v2\. To the right of the entry, I clicked the switch indicator so that it is on. I agreed to the terms of service and clicked accept.

10) In the left navigation bar, I clicked API Access. In the resulting page, I clicked Create New Android Key. In the resulting dialog, I entered the SHA-1 fingerprint, then a semicolon, then the application's package name.

11) I copied the API key. I opened my application's manifest, contained in the file AndroidManifest.xml. And add the following element as a child of the element, by inserting it just before the closing tag :

```
<meta-data
    android:name="com.google.android.maps.v2.API_KEY"
    android:value="your_api_key"/> 
```

* Note that I used my real api key.

12) I added this as well:

```
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>

<permission
      android:name="com.otl.AndroidRemoteApp1.permission.MAPS_RECEIVE"
      android:protectionLevel="signature"/>
    <uses-permission android:name="com.otl.AndroidRemoteApp1.permission.MAPS_RECEIVE"/>

<uses-feature
android:glEsVersion="0x00020000"
android:required="true"/> 
```

13) Then in my ShowMapActivity.java:

```
 super.onCreate(savedInstanceState);
    setContentView(R.layout.show_map);
            mapView = (MapView) findViewById(R.id.mapview);

    myMapController = mapView.getController();  
    mapView.setBuiltInZoomControls(true);

    Drawable marker=getResources().getDrawable(android.R.drawable.star_big_on);
            ... 
```

14) Then in my show_map.xml file:

```
<com.google.android.maps.MapView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mapview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:clickable="true"
    android:state_enabled="true" 
    android:apiKey="my_api_key"
/> 
```

* I replaced my_api_key with the real key.

So I followed all the instructions and then when I downloaded the app on an android device, it did not show the map. It just shows the tiles thing, which has been reported before.

I'm not sure what step I missed to get this to work.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T01:34:02.947

配置步骤对我来说看起来不错。

但我认为你正在以一种老式的方式与图书馆互动。我知道文档说 MapView 可以添加和控制到活动中，但我会尝试使用新的[GoogleMap](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/GoogleMap)和[MapFragment](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/MapFragment)方法。我不确定库的 V2 对“扩展 MapActivity 和处理 MapView”的支持程度

这是它的文档：[https ://developers.google.com/maps/documentation/android/map#add_a_map_to_an_android_application](https://developers.google.com/maps/documentation/android/map#add_a_map_to_an_android_application)

你试过了吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T07:52:33.040

感谢您非常详尽的描述。问题是您使用的是 Android v2 API 的设置过程 f，但使用的是 v1 API 中的类。由于现在不推荐使用 v1，因此强烈建议您使用 v2。如果您按照有关使用 Google Play 服务构建的其余说明进行操作，则应该没问题。

# c# - 将其拆分为数组

> ID：13829890
> 
> 赞同：2
> 
> 时间：2012-12-11T22:55:52.360
> 
> 标签：c#, string

我有这串代理地址，它们用空格分隔，但是 x400 和 x500 将空格处理成它们的地址。拆分它的最佳方法是什么。

例如

```
smtp:john@a-mygot.com smtp:john@b-mygot.com smtp:john@c-mygot.com X400:C=us;A= ;P=mygot;O=Exchange;S=John;G=Gleen; SMTP:john@mygot.com 
```

预期结果：

```
smtp:john@a-mygot.com
smtp:john@b-mygot.com
smtp:john@c-mygot.com
X400:C=us;A= ;P=mygot;O=Exchange;S=John;G=Gleen;
SMTP:john@mygot.com 
```

谢谢，

编辑，

```
 string mylist = "smtp:john@a-mygot.com smtp:john@b-mygot.com smtp:john@c-mygot.com X400:C=us;A= ;P=mygot;O=Exchange;S=John;G=Gleen; SMTP:john@mygot.com X500:/o=Example/ou=USA/cn=Recipients of  /cn=juser smtp:myaddress";

        string[] results = Regex.Split(mylist, @" +(?=\w+:)");
        foreach (string part in results)
        {
            Console.WriteLine(part);
        } 
```

结果

```
smtp:john@a-mygot.com
smtp:john@b-mygot.com
smtp:john@c-mygot.com
X400:C=us;A= ;P=mygot;O=Exchange;S=John;G=Gleen;
SMTP:john@mygot.com
X500:/o=Example/ou=USA/cn=Recipients of  /cn=juser
smtp:myaddress 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-11T23:06:34.610

这是一个应该匹配协议前空格的正则表达式。尝试像这样插入它`Regex.Split`：

```
string[] results = Regex.Split(input, @" +(?=\w+:)"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T23:10:33.883

```
int index = smtp.indexOf("X400") ;
string[] smtps = smtpString.SubString(0,index).Split(" ") ;
int secondIndex  = smtpString.indexOf("SMTP");
string xfour = smtpString.substring(index,secondIndex);
string lastString = smtpString.indexOf(secondIndex) ; 
```

应该可以工作，如果字符串格式是这样的..如果我没有搞砸索引..虽然你可能想检查索引是否不是-1

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T23:19:21.777

试试这个：

```
public static string[] SplitProxy(string text)
        {
            var list = new List<string>();
            var tokens = text.Split(new char[] { ' ' });
            var currentToken = new StringBuilder();

            foreach (var token in tokens)
            {
                if (token.ToLower().Substring(0, 4) == "smtp")
                {
                    if (currentToken.Length > 0)
                    {
                        list.Add(currentToken.ToString());
                        currentToken.Clear();
                    }

                    list.Add(token);
                }
                else
                {
                    currentToken.Append(token);
                }
            }

            if (currentToken.Length > 0)
                        list.Add(currentToken.ToString());

            return list.ToArray();
        } 
```

它按空格将字符串拆分为标记，然后一一遍历它们。如果令牌以 smtp 开头，则将其添加到结果数组中。如果不是，则将该标记与以下标记连接以创建一个条目，然后将其添加到结果数组中。应该适用于任何有空格且不以 smtp 开头的东西。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-11T23:00:35.090

我认为以下行应该可以完成工作

```
var addrlist = variable.Split(new char[] { ' ' },StringSplitOptions.RemoveEmptyEntries); 
```

# prolog - 会员谓词问题，换一美元

> ID：13829893
> 
> 赞同：1
> 
> 时间：2012-12-11T22:56:03.110
> 
> 标签：prolog, declarative

我是 Prolog 中的一个完整的菜鸟。我正在做一个任务，我创建一个零钱计数器，总计`S`（以美分为单位），0 <= S <= 100。所以我需要显示半美元、四分之一、一角硬币、五分钱的数量。

这是我的代码：

```
change(S,H,Q,D,N,P) :-
            member(H,[0,1,2]),      /* Half-dollars */      
            member(Q,[0,1,2,3,4]),  /* quarters */  
            member(D,[0,1,2,3,4,5,6,7,8,9,10]) ,    /* dimes */    
            member(N,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]), 
            /* ^^ nickels ^^ */

            S is 50*H + 25*Q +10*D + 5*N,
            S =< 100,
            P is 100-S. 
```

所以我的问题是当我尝试计算`?- change(87,0,3,D,1,P).`我输入的金额是 87 美分并且我需要 3 个季度和 1 个镍时......我收到一个错误说明`uncaught exception: error(existence_error(procedure,change/6),top_level/0)`

在我最后的 3 行代码中，我认为我正在正确处理给定的金额。我需要对给定的金额制定额外的规则吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:15:12.277

你错过了美分！我建议使用 between/3 来表示范围：

```
...,
between(0,100,Cents),
...,

...,
S is 50*H + 25*Q +10*D + 5*N + Cents,
..., 
```

测试：

```
?- change(87,H,Q,D,N,Cents,P).
H = Q, Q = D, D = N, N = 0,
Cents = 87,
P = 13 ;
H = Q, Q = D, D = 0,
N = 1,
Cents = 82,
P = 13 ; 
```

WRT`error(existence_error...`我认为你需要编译你的脚本......

# database - 如何留下加入计数？

> ID：13829896
> 
> 赞同：0
> 
> 时间：2012-12-11T22:56:05.650
> 
> 标签：database, sqlite

```
select DISTINCT(cctv_id), cctv.[name] from points_cctv left join cctv on points_cctv.[cctv_id] = cctv.[id] 
```

我想计算`points_cctv`where的记录数`points_cctv.[cctv_id] = cctv.[id]`并将其显示为上述查询中的附加列。当我插入`count(points_cctv.[cctv_id])`时，它只会给我一行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T23:06:48.890

```
select cctv_id, cctv.[name], count(cctv_id)
from points_cctv left join cctv on points_cctv.[cctv_id] = cctv.[id]
group by cctv_id, cctv.name 
```

# c# - 读取 xml 文件并将数据用作标签

> ID：13829899
> 
> 赞同：-3
> 
> 时间：2012-12-11T22:56:25.340
> 
> 标签：c#, xml, winforms, visual-studio-2010, c#-4.0

我正在使用 Visual Studio 2010 创建一个 Windows 表单，用于从 xml 文件中读取数据并在表单中显示它。任何与使用此信息动态更改标签或文本框内容相关的代码将不胜感激。目前我可以读入一个 xml 文件并在控制台中显示一些内容。

感谢您抽出时间来阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T23:02:27.287

加载 Xml 后，您需要做的就是设置`.Text`TextBox 或 Label 控件的属性：

```
string xmlData = "<xml>\r\n<tag>This is my xml</tag></xml";
myTextBox.Text = xmlData; 
```

您说您可以让 Xml 内容显示在控制台中，您只需将输出定向到 WinForm 控件，而不是控制台。此外，如果您使用 a `TextBox`，您需要将其[`Multiline`属性](http://msdn.microsoft.com/en-us/library/12w624ff%28v=vs.100%29.aspx)设置为`true`.

您可以在 MSDN 上阅读有关[TextBox 控件](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox%28v=vs.100%29.aspx)和[Label 控件的更多信息。](http://msdn.microsoft.com/en-us/library/system.windows.forms.label%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T23:08:11.790

使用 XML 解析器提取元素

[http://msdn.microsoft.com/en-us/library/cc189056(v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/cc189056(v=vs.95).aspx)

然后使用控件属性 textBox.text = someString

# jquery - jQuery 伪类表达式

> ID：13829900
> 
> 赞同：0
> 
> 时间：2012-12-11T22:56:31.347
> 
> 标签：jquery, css, unique, pseudo-class

每次单击按钮时，我都使用一个按钮来创建一个新的 div。最终，我需要为每个新的 div 设置一个唯一的 ID，但现在我需要更改某些子元素的 CSS。除了使用伪类表达式，有没有办法使用 jQuery，我可以分配一个唯一的 ID 号，并使用该 ID 来更改创建的新 div 的 CSS？

这是我的代码：

```
 $("button[type=email]").click(function(){
    $("<ul />")
        .html('<div id="friend"><b>Friend Name<b><a class="close closethis tooltip" data-tooltip="Remove persona"><i class="icon-remove"></i></a></div>')
                .appendTo("#drag-area");

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:00:39.440

您不需要首先创建 ID ..

您可以使用`.eq() selector`来定位`specific div`ul..

```
$('#drag-area').find('ul').eq(2).find('div').addClass('yourClass'); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/kNu6V/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T23:04:56.030

您可以在使用 jQuery 的任何时候使用 JavaScript。因此，您可以创建一个计数器 ( `var i = 0;`)，在 id ( `id="friend'+i+'">`) 中使用该计数器，然后递增该计数器`i++;`。

# java - 货币的四舍五入双值

> ID：13829902
> 
> 赞同：0
> 
> 时间：2012-12-11T22:56:34.310
> 
> 标签：java, android, double, bigdecimal

将值舍入以在 textView 中显示时遇到很多麻烦。

我基本上想把它四舍五入到小数点后两位，但目前我得到了很多不同的数字。

我正在玩 BigDecimal 但到目前为止还没有运气......

```
public void calc() {
        BigDecimal bd = new BigDecimal(subTotal);
        bd.setScale(2, BigDecimal.ROUND_DOWN);
        total.setText(String.valueOf(bd));
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T23:00:14.377

试试下面的代码：

```
double roundTwoDecimals(double d) {
    DecimalFormat twoDForm = new DecimalFormat("#.##");
    return Double.valueOf(twoDForm.format(d));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T23:20:24.333

以下为我工作

```
BigDecimal bd = new BigDecimal(subTotal);
bd = bd.setScale(2, BigDecimal.ROUND_HALF_UP);
total.setText(String.valueOf(bd));
// Input: 9.888888 -> Output: 9.89
// Input: 9f -> Output: 9.00 
```

# mysql - 在检查结果中的值时选择 count(*)

> ID：13829905
> 
> 赞同：-2
> 
> 时间：2012-12-11T22:57:01.987
> 
> 标签：mysql, sql

```
SELECT COUNT(*) as Count, IF(sch.HomeTeamID = 34,true,false) AS Hawaii
FROM schedule sch 
JOIN schools s ON s.ID = 83 
WHERE (sch.HomeTeamID = 83 OR sch.AwayTeamID = 83)
AND sch.SeasonID = 4 
```

我正在尝试使用 count() 来简化我的结果，但还包括一个字段，该字段表示任何结果的特定列是否包含某个值。这可能吗？我基本上想要一个包含我需要的所有信息的行响应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:01:38.533

如果您要计算主队 34 次，请执行以下操作：

```
SELECT 
    COUNT(*) as Count, 
    sum(sch.HomeTeamID = 34) AS Hawaii_home_count
... 
```

顺便说一句，条件的简洁求和仅在mysql中有效，因为在mysql中true为1，false为0，所以sum(condition)计算它为true的次数（其他数据库需要使用case语句）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T23:04:17.450

使用have子句怎么样？

```
SELECT COUNT(*) as Count
FROM schedule sch 
JOIN schools s ON s.ID = 83 
WHERE (sch.HomeTeamID = 83 OR sch.AwayTeamID = 83)
AND sch.SeasonID = 4
Having sch.HomeTeamID = 34 
```

# android - Android - 长椭圆文本视图覆盖下一个文本视图

> ID：13829908
> 
> 赞同：2
> 
> 时间：2012-12-11T22:57:05.933
> 
> 标签：android, android-layout, textview

我有列表视图。Row 有 2 个（将来还会有更多）文本视图。我的目标是，如果第一个文本太长，则应显示椭圆，但第二个文本视图应始终可见。我暂时通过列解决了这个问题（权重和文本视图的百分比权重）。但我的目标是：当文本很短时，第二个文本视图应该出现在第一个文本视图旁边（参见第一个附加屏幕，它是假的 - 由第一个文本视图的硬编码 maxwidth 创建）。问题是当第一个文本太长时，第二个文本就会消失。我已经尝试了许多线性布局、相对布局、子布局等配置，但最后我卡住了。任何想法？这是行的简单 xml：

```
<LinearLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/TextView01"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:ellipsize="end"
        android:singleLine="true"
        android:text="Some very very long long long long long long long"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/TextView02"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="#C03518"
        android:text="10"
        android:textAppearance="?android:attr/textAppearanceMedium" />
</LinearLayout> 
```

这是带有 relativelayout 的代码，它也不起作用：

```
<RelativeLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/TextView01"
        android:layout_alignParentLeft="true"
    android:ellipsize="end"
    android:singleLine="true"           
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Some very very long long long long long long long"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/TextView02"
        android:layout_toRightOf="@id/TextView01"
        android:layout_alignParentRight="true"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="#C03518"
        android:text="10"
        android:textAppearance="?android:attr/textAppearanceMedium" />
</RelativeLayout> 
```

![目标](../Images/21a3b29853e99b0fce737da9d45f810e.png)

![现实](../Images/9610801a442ab5f029514de5ba92587e.png)

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T00:14:45.673

您还可以使用这样的自定义流布局：http: [//karimvarela.com/2012/12/01/android-creating-a-flowlayout/](http://karimvarela.com/2012/12/01/android-creating-a-flowlayout/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T17:41:36.460

您需要为列设置权重。像这样的东西：

```
<LinearLayout
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:orientation="horizontal" >

<TextView
    android:id="@+id/TextView01"
    android:layout_width="0"
    android:layout_height="wrap_content"
    android:layout_weight="9"
    android:ellipsize="end"
    android:singleLine="true"
    android:text="Some very very long long long long long long long"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<TextView
    android:id="@+id/TextView02"
    android:layout_width="0"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:background="#C03518"
    android:text="10"
    android:textAppearance="?android:attr/textAppearanceMedium" />
</LinearLayout> 
```

这意味着第一列将占据屏幕的 90%，第二列将占据 10%。或者，您可以使用表格布局并将stretch_columns 设置为0,1。就像是 ：

```
<TableLayout
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:orientation="horizontal"
android:stretch_columns="0,1" >

<TableRow>

<TextView
android:id="@+id/TextView01"
android:layout_width="0"
android:layout_height="wrap_content"
android:layout_weight="9"
android:ellipsize="end"
android:singleLine="true"
android:text="Some very very long long long long long long long"
android:textAppearance="?android:attr/textAppearanceMedium" />

<TextView
android:id="@+id/TextView02"
android:layout_width="0"
android:layout_height="wrap_content"
android:layout_weight="1"
android:background="#C03518"
android:text="10"
android:textAppearance="?android:attr/textAppearanceMedium" />

</TableRow>

</TableLayout> 
```

# iis - 使用 mklink 创建的符号链接不适用于 IIS7.5——Windows 7

> ID：13829909
> 
> 赞同：4
> 
> 时间：2012-12-11T22:57:10.100
> 
> 标签：iis, windows-7, iis-7.5, symlink

因此，在我的 IIS 根目录 (c:\inetpub\wwwroot) 中，我使用以下命令创建了指向网络驱动器的符号链接：

mdlink /D truthuniversal "U:\Truth Universal Full Site\public"

符号链接创建得很好，如果我发出`cd truthuniversal`命令，在 IIS 根目录中，我确实最终进入了“U:\Truth Universal Full Site\public”目录区域。

我的问题是当我输入：

```
http://localhost/truthuniversal 
```

在我的浏览器地址栏中，IIS 不提供位于公共目录中的索引页。相反，我收到以下错误：

应用程序“默认网站”中的服务器错误

Internet Information Services 7.5 错误摘要 HTTP 错误 404.0 - 未找到 您要查找的资源已被删除、名称已更改或暂时不可用。

请指教。

-TU

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-11T23:13:38.903

您需要在 IIS 中创建到该目录的虚拟目录映射，以便它提供页面。在 IIS 中，右键单击“默认网站”，然后单击“添加虚拟目录”。此外，这样做，您甚至没有理由需要符号链接。只需将其映射到目标即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-08-03T20:21:18.583

我同意 IIS 中的虚拟目录可能是您想要的，但如果您想最大限度地减少 IIS 维护，请考虑以下事项：

代替目录符号链接：mklink /D
尝试**目录连接：mklink /J**

这对我有用，并且网络应用程序能够写入同一目录。

```
mklink /J App_Data d:\shared\App_Data 
```

在 Windows Server 2008 R2 上为我工作。

# javascript - 如何根据右列是否存在更改页面的css

> ID：13829913
> 
> 赞同：-1
> 
> 时间：2012-12-11T22:57:33.577
> 
> 标签：javascript, css, sharepoint

我正在寻找一种基于共享点布局的右列是否有内容来动态更改css的方法。

目前，如果该列为空，则该列会优雅地隐藏，并且左列将展开以填充。如果右栏为空，我有一个需要扩展以填充页面的 Web 部件。

有两批css会很好。如果右列有内容，则定义 Web 部件的大小，如果没有，则定义 Web 部件的大小。我研究了如何使 webpart 动态化，但它是一个图片幻灯片，带有用于控件的浮动元素和顶部的文本，如果没有 css 调整以将浮动元素重新对齐，它就不会优雅地展开。

如果您知道任何很棒的教程或示例。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:08:18.763

这为我做到了：

```
jQuery.fn.exists = function(){return this.length>0;}  
  if ($('.pageRightColumn table').exists()) {       
      $('div#innerfade-holder').addClass('innerfadeholder_RC'); 
      $('#portfolio IMG').addClass('portfolioIMG_RC'); 
      $('#portfolio div.description').addClass('description_RC');
      $('#portfolio div.transbox').addClass('transbox_RC');
      $('table#controlBarContainer').addClass('controlBarContainer_RC');
  } else {
      $('div#innerfade-holder').addClass('innerfadeholder_FULL'); 
      $('#portfolio IMG').addClass('portfolioIMG_FULL'); 
      $('#portfolio div.description').addClass('description_FULL');
      $('#portfolio div.transbox').addClass('transbox_FULL');
      $('table#controlBarContainer').addClass('controlBarContainer_FULL');
  } 
```

});

# javascript - 如何在Javascript中形成嵌套对象

> ID：13829914
> 
> 赞同：1
> 
> 时间：2012-12-11T22:57:35.137
> 
> 标签：javascript, treeview

我正在尝试使用 JavaScript 动态形成如下所示的嵌套树对象，有人可以告诉我实现这一目标的最佳方法吗？

```
 var contextpath= {
        text: "TreeRoot",
        items: [ {
            text: "subgroup1" ,
            items: [ {
                text: "subgroup2",
                items: [ {
                    text: "subgroup3",
                    items: [ {
                        text: "subgroup4",
                        items: [ {
                            text: "subgroup5"
                        }]
                    }]
                }]
            }]
        }]
    }; 
```

我有分隔字符串，我试图将其转换为对象（可用作树组件的 dat 源）。

var path="TreeRoot|subgroup1|subgroup2";

尝试实现类似下面的内容，但使用较少数量的变量进行递归/循环。

```
 var contextpathText= {};
    contextpathText.text ="TreeRoot";

    var childObject={};
    var items=[];
    childObject.text ="subgroup1";
    items.push(childObject);
    contextpathText.items=(items); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:14:02.720

您需要一个深度计数器并存储您正在使用的对象的当前级别。

```
var obj = {text:''}, parent, child, i = 0;
obj.text = 'TreeRoot';
parent = obj;
while (++i <= 5) {
    if (parent.items === undefined) parent.items = []; // because you don't have an items on the last subgroup you can't put it in the object literal
    child = {text: 'subgroup'+i};
    parent.items.push(child);
    parent = child;
}
parent = child = null; // cleanup
obj; 
```

[jsbeautified](http://jsbeautifier.org/) `JSON.stringify(obj)`现在是

```
{
    "text": "TreeRoot",
    "items": [{
        "text": "subgroup1",
        "items": [{
            "text": "subgroup2",
            "items": [{
                "text": "subgroup3",
                "items": [{
                    "text": "subgroup4",
                    "items": [{
                        "text": "subgroup5"
                    }]
                }]
            }]
        }]
    }]
} 
```

* * *

编辑分隔字符串

```
var path = 'TreeRoot|subgroup1|subgroup2';

var obj = {text:''}, parent, child, levelText = path.split('|').reverse();
obj.text = levelText.pop() || '';
parent = obj;
while (levelText.length > 0) {
    child = {text: levelText.pop()};
    if (!parent.items) parent.items = [];
    parent.items.push(child);
    parent = child;
}
obj; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T23:18:29.110

击败我，但我使用了以下代码：

```
var contextpath = { text: "TreeRoot", items: []}

var items = contextpath.items;

for(var i = 1; i <= 5; i++) {
    items.push({ text: "subgroup" + i, items: []});
    items = items[0].items;
} 
```

对于这类事情，父子命名法肯定更清晰，但我想表明您不必先将新对象声明为变量，您只需推送对象字面量即可。

哎呀，刚才注意到您想要的结构中没有 items 数组。我的代码创建了备用，所以你最终得到

```
// snip
                text: "subgroup4",
                    items: [ {
                        text: "subgroup5",
                        items: []
                    }]
// etc. 
```

# css - 试图让 3 个 div 漂浮在屏幕的整个长度上，而中间 div 是动态的

> ID：13829916
> 
> 赞同：4
> 
> 时间：2012-12-11T22:57:52.190
> 
> 标签：css, positioning, html

**CSS 标记：**

```
body {
    margin: 0;
    background:#FFAA00;
}
#left {
    position: relative;
    background: url(footer_bg_social2.png) repeat-x 0 -70px;
    overflow:hidden;
    height: 70px;
}
#right {
    position: relative;
    background: url(footer_bg_social2.png) repeat-x 0 -70px;
    overflow:hidden;
    height: 70px;
}
#tab-seperator {
    height: 70px;
}
#tab-seperator div.tab-wrapper {
    position: relative;
    height: 70px;
    float:left;
}
#tab-seperator ul {
    position: relative;
    float: left;
    margin: 0;
    padding: 0;
}
#tab-seperator ul li {
    float:left;
    display:block;
    height: 70px;
    line-height: 70px;
    vertical-align:middle;
}
#tab-seperator ul li.start {
    background: url(footer_bg_social2.png) no-repeat 0 0;
    width:22px
}
#tab-seperator ul li.content {
    background: url(footer_bg_social2.png) repeat-x 0 -140px;
}
#tab-seperator ul li.end {
    background: url(footer_bg_social2.png) no-repeat -248px 0;
    width:22px
} 
```

**HTML 标记：**

```
<div id="tab-seperator">    
    <div id="left"> </div>       
    <div class="tab-wrapper">
        <ul>                
            <li class="start"></li>
            <li class="content">testing..length</li>
            <li class="end"></li>                                
        </ul>        
    </div>  
    <div id="right"> </div>    
</div> 
```

因此，我希望让左右 div 构成页面的整个宽度，大小取决于中间部分的增长时间。有问题让它工作......上面的解决方案是让两行都构成整个页面宽度，当然我希望这一切都在 1 行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T00:16:46.273

您可以使您的 div 显示为表格单元格。这是我执行它的方式：

```
#tab-seperator{
width:100%;
display:table;
}

#left {
width:auto;
display:table-cell;
}

.tab-wrapper {
width:1000px; /* Whatever you want the main container to be */
display:table-cell;
}

#right {
width:auto;
display:table-cell;
} 
```

[你可以在这里](http://beta.mybattlereport.com/)看到一个活生生的例子 只需检查元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T00:11:53.113

您可以通过`.start`为.`.end``.content` `li`

```
<div id="tab-seperator">    
    <div id="left"> </div>       
    <div class="tab-wrapper">
        <ul id="oneline">                
            <li class="start">[start]</li>
            <li class="content">[testing..length]</li>
            <li class="end">[end]</li>                                
        </ul>        
    </div>  
    <div id="right"> </div>    
</div>

#oneline {display:table;width:100%;background:#555;}
.start, .content, .end {display:table-cell;}
.content {width:50%;background-color:#777;} 
```

在这里查看它的实际操作：[http ://codepen.io/joe/pen/Ffzqm](http://codepen.io/joe/pen/Ffzqm)

# node.js - 如何使用 mongo 从数组中删除项目？

> ID：13829917
> 
> 赞同：0
> 
> 时间：2012-12-11T22:57:57.260
> 
> 标签：node.js, mongodb, node-mongodb-native

我想从数组中原子地删除一个项目。我正在考虑使用 findAndModify 但我不确定它是如何工作的。任何关于如何从文档中的数组中原子地删除项目的指导将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:30:31.367

您可以在or中使用[`$pull`](http://docs.mongodb.org/manual/reference/operator/pull/)运算符：`update``findAndModify`

```
db.collection.update({_id: id}, {$pull: {foo: 'bar'}}); 
```

这将从文档匹配`'bar'`的数组字段中删除元素。`foo``{_id: id}`

# google-apps-script - 复制电子表格时 Google Script 保留触发器

> ID：13829918
> 
> 赞同：0
> 
> 时间：2012-12-11T22:57:59.910
> 
> 标签：google-apps-script, google-spreadsheet-api

好的，所以我正在为我的工作做一个项目。我们正在使用 Google Drive 来跟踪工单。事情是这样的：

1) 您填写描述您的工单的申请表。2) 谷歌脚本将生成信息从请求表转换为请求报告并创建一个跟踪表 3) 人员通过填写跟踪表在工作订单上签字。

很简单，但麻烦就来了。我最初将所有工单合并到一个电子表格中，您将输入工单的 ID，但人们总是在输入正确的 # 时出错，因此我的老板希望每个工单都有自己单独的跟踪表。一旦这个新流程实施，她希望我尽可能少地接触它。

这就是问题所在，我使用了一个跟踪表单模板，其中包含所有 Google 脚本代码，但触发器无法复制。我尝试使用请求表单代码来运行跟踪表单代码，但它太复杂并且容易出错。我尝试将 onOpen 代码（将为项目经理创建一个菜单以授权触发器）写入模板，希望它能复制过来，但这也不起作用。

有人可以告诉我如何解决这个问题吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T04:03:56.467

当制作电子表格/脚本的新副本时，通过资源菜单创建的触发器不会保留。认为你会想以[编程](https://developers.google.com/apps-script/managing_triggers_programmatically)方式创建它们，然后它们会（仍然需要为它运行一个函数并授权）。

就像是...

```
function myFunction() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  ScriptApp.newTrigger('logDate').forSpreadsheet(ss).onFormSubmit().create();
}

function logDate() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var s = ss.getSheetByName('Sheet1');
  s.getRange('A1').setValue(new Date());
}; 
```

# python - 从矩阵中打印出值

> ID：13829920
> 
> 赞同：2
> 
> 时间：2012-12-11T22:58:16.507
> 
> 标签：python, regex, linux, bash

我有一个任务会随着时间的推移消耗仲裁 CPU 和内存。它给了我一个执行以下 linux 命令的输出：

`mpstat -u 1 -P ALL`

输出如下所示：

```
02:22:14 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest   %idle
02:22:15 PM  all    4.51    0.00    0.11    0.00    0.00    0.00    0.00    0.00   95.37
02:22:15 PM    0    0.00    0.00    1.00    0.00    0.00    0.00    0.00    0.00   99.00
02:22:15 PM    1   **78.22**    0.00    0.99    0.00    0.00    0.00    0.00    0.00   20.79

02:22:15 PM    2    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
02:22:15 PM    3    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
02:22:15 PM    4    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM    5    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM    6    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
02:22:15 PM    7    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM    8    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM    9    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM   10    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM   11    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM   12    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM   13    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM   14    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM   15    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
02:22:15 PM   16    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM   17    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM   18    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM   19    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
02:22:15 PM   20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM   21    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM   22    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
02:22:15 PM   23    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00 
```

我想在 bash/python/perl 中每 20 秒获取位于第 4 列和第 3 行 a[3][4] 的值，即 78.22。所以我想要的脚本将执行 mpstat 命令并打印出指定列中的值，并根据它创建图形的值。我正在考虑在 .dat 文件中附加所需的值并运行 gnuplot 或创建图形的应用程序。

关于如何去的任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-11T23:03:39.633

您可以使用 获取第 3 行和第 4 个单元格`awk`。以下代码从`mpstat`的输出中获取此单元格，并将其与当前 UNIX 时间戳一起附加到统计文件中。

```
mpstat -u 1 -P ALL | awk 'NR==4 {print systime(), $4}' >> stats.txt 
```

要每 20 秒运行一次此命令：

```
watch -n 20 "mpstat -u 1 -P ALL | awk 'NR==4 {print systime(), \$4}' >> stats.txt" 
```

然后绘制`gnuplot`：

```
cat stats.txt | gnuplot -p -e 'set datafile separator " "; plot "-" using 1:2 with lines' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T05:12:15.243

尝试以下

```
#!/bin/bash
function _mpstat() {
    while :; do
        arr=( $(mpstat -P 1 | tail -n 1) )
        echo "${arr[3]}"
        sleep 20
    done >> file.txt
}
_mpstat &
echo "_mpstat PID: $!" 
```

**解释**

*   `while :; do`无限循环
*   `$(mpstat -P 1 | tail -n 1)`mpstat 只有 cpu 1`-P 1`和 tail`-n 1`最后一行，返回值`$()`
*   `arr=( ... )`命令返回值到数组
*   `echo "${arr[3]}"`回显数组索引 3
*   `sleep 20`睡眠 20 秒
*   `>> file.txt`将标准输出发送到 while 循环块内的文件。
*   `_mpstat &`将函数发送到后台进程`&`
*   `echo "_mpstat PID: $!`返回函数的 PID

您可以 grep PID 以显示其父级并在需要时终止两者。

# google-app-engine - 非关系数据库 (NoSQL) 中的建模排名（分数）

> ID：13829923
> 
> 赞同：1
> 
> 时间：2012-12-11T22:58:26.107
> 
> 标签：google-app-engine, database-design, nosql, ranking, amazon-simpledb

我使用的是 Google App Engine，所以我使用的是非关系数据库 (NoSQL)。我的问题是：

使用他们的分数来建模排名（玩家排名）的最佳选择是什么？

例如，我的球员是：

```
Player { String name, int score} 
```

我想知道一个球员的排名（位置），也想得到前 10 名球员，但我怀疑哪个是最好的方法。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-12T01:15:42.513

如果您的分数已编入索引，则可以轻松进行数据存储查询并按排序顺序获取玩家。所以如果你想要前 10 名球员，那是非常微不足道的。

获得任意玩家的排名真的很难。我想说，如果可以，请避免使用它，如果不能，请找到绕过它的黑客方法。

例如，如果您有 50,000 名玩家，而 PlayerX 排名第 12,345 位，唯一知道的方法是查询所有玩家，并检查每个玩家，保持计数，直到找到 PlayerX。

一种技巧可能是将玩家排名存储在玩家实体中，并使用每隔几个小时运行一次的 cron 作业对其进行更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-04T07:03:39.457

[Redis](http://redis.io/)有一个内置的解决方案：

首先添加几个有分数的成员：

```
redis>  ZADD myzset 1 "one"
(integer) 1
redis>  ZADD myzset 2 "two"
(integer) 1
redis>  ZADD myzset 3 "three"
(integer) 1 
```

获得“二”的等级：

```
redis>  ZREVRANK myzset "one"
(integer) 2 
```

（索引从 0 开始）

如果您想要当前订单：

```
redis>  ZREVRANGE myzset 0 -1
1) "three"
2) "two"
3) "one" 
```

请参阅redis 文档中的[ZREVRANGE](http://redis.io/commands/zrevrange)和[ZREVRANK](http://redis.io/commands/zrevrange)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T03:09:35.790

您可以像这样设置 index.yaml：

```
- kind: Player
  properties:
  -  name: score
     direction: ascending 
```

要获得玩家的分数，您只需对玩家进行传球（同时保持计数）并缓存结果以加快对该玩家的进一步搜索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-11T23:18:32.060

JSON 中的一个合适的表示是：

```
"players" : [
    {
        "name" : "John",
        "score" : 15
    },
    {
        "name" : "Swadq",
        "score" : 7
    },
    {
        "name" : "Jane",
        "score" : 22
    }
] 
```

有关如何排序的示例：

*   PHP：[如何在 PHP 中按给定键的值对关联数组的数组进行排序？](https://stackoverflow.com/questions/1597736/how-to-sort-an-array-of-associative-arrays-by-value-of-a-given-key-in-php)
*   JavaScript：[如何按 PHP 中给定键的值对关联数组的数组进行排序？](https://stackoverflow.com/questions/1597736/how-to-sort-an-array-of-associative-arrays-by-value-of-a-given-key-in-php)
*   JavaScript 通用排序：[http ://www.breakpar.com/bkp/home.nsf/0/87256B280015193F87256C8D00514FA4](http://www.breakingpar.com/bkp/home.nsf/0/87256B280015193F87256C8D00514FA4)

# ajax - document.write() 和 AJAX 有什么关系？

> ID：13829925
> 
> 赞同：-1
> 
> 时间：2012-12-11T22:58:33.653
> 
> 标签：ajax, document.write

我不熟悉 AJAX。

是否`document.write()`广泛用于 AJAX 技术？

他们之间有什么关系吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T23:03:35.117

`document.write()`和 AJAX 真的是对立的。AJAX 通常用于根据同步调用的结果更新一些 DOM 元素，而`document.write()`如果在页面加载后使用，实际上将清除整个文档的内容，并将其替换为传递给功能。

# vb6 - 在 MS access 2007 中将 PDF 文件传输到 ftp 服务器

> ID：13829932
> 
> 赞同：0
> 
> 时间：2012-12-11T22:59:25.280
> 
> 标签：vb6, ftp, ms-access-2007, inet

我正在尝试将 pdf 文件上传到 ftp 服务器。我已经通过访问 wininet dll 进行了尝试，但没有成功。

在 MS Access 2007 VB6 中执行此操作的最佳方法是什么？我可以调用 .net dll，但这是我最后的手段。

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T11:06:09.127

如果您的意思是 VB6，那么有一个控件可以用于 FTP 功能。转到项目/组件并将“Microsoft Internet 传输控制”添加到您的项目中。它相当容易使用，但类似...

```
 Inet.UserName = "Username"
    Inet.Password = "Password"
    Inet.Protocol = icFTP
    Inet.RemoteHost = "123.123.123.123"

    Inet.Execute , "put " & sFileToTransfer & " " & sFilenameOnRemoteHost

    While Inet.StillExecuting
        DoEvents
    Wend 
```

完成后检查 Inet.ResponseCode

如果您的意思是 Ms/Access 中的 VBA，那么您可以写出一个小批处理文件，然后执行它。

# jquery - 提高滚动速度 - jQuery

> ID：13829936
> 
> 赞同：0
> 
> 时间：2012-12-11T22:59:57.433
> 
> 标签：jquery, html, jscrollpane

我正在为我为某人创建的网站修改 html5/jQuery 视频播放器。到目前为止，一切进展顺利。我有一个小问题，播放列表的滚动速度非常缓慢，这里是代码；

```
/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
(function(a){function d(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=!0,g=0,h=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),h=e,c.axis!==undefined&&c.axis===c.HORIZONTAL_AXIS&&(h=0,g=-1*e),c.wheelDeltaY!==undefined&&(h=c.wheelDeltaY/120),c.wheelDeltaX!==undefined&&(g=-1*c.wheelDeltaX/120),d.unshift(b,e,g,h),(a.event.dispatch||a.event.handle).apply(this,d)}var b=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var c=b.length;c;)a.event.fixHooks[b[--c]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=b.length;a;)this.addEventListener(b[--a],d,!1);else this.onmousewheel=d},teardown:function(){if(this.removeEventListener)for(var a=b.length;a;)this.removeEventListener(b[--a],d,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery) 
```

您可以在此处查看视频播放器； [http://design.jarethmusic.com/](http://design.jarethmusic.com/)

如您所见，播放列表上的滚动速度非常慢，任何解决此问题的想法都是完美的。

问候约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T05:31:12.360

尝试用这个替换代码：

```
/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
(function(a){function d(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=!0,g=0,h=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/10),c.detail&&(e=-c.detail/3),h=e,c.axis!==undefined&&c.axis===c.HORIZONTAL_AXIS&&(h=0,g=-1*e),c.wheelDeltaY!==undefined&&(h=c.wheelDeltaY/10),c.wheelDeltaX!==undefined&&(g=-1*c.wheelDeltaX/10),d.unshift(b,e,g,h),(a.event.dispatch||a.event.handle).apply(this,d)}var b=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var c=b.length;c;)a.event.fixHooks[b[--c]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=b.length;a;)this.addEventListener(b[--a],d,!1);else this.onmousewheel=d},teardown:function(){if(this.removeEventListener)for(var a=b.length;a;)this.removeEventListener(b[--a],d,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery) 
```

# objective-c - 选择器变黑，然后应用程序崩溃（有时）

> ID：13829938
> 
> 赞同：0
> 
> 时间：2012-12-11T23:00:04.550
> 
> 标签：objective-c, ios, xcode, uipickerview

我有许多文本字段，它们以选择器视图的形式提供预定义值的选择。有时，通常在填充了很多文本框后，选择器变黑，然后应用程序崩溃。

我似乎无法重现该问题，它只是偶尔发生......由一些用户报告。当我从别人那里拿到这个代码时，也许我错过了什么？

这是文本框/选择器的自定义类的代码

```
- (id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super initWithCoder:aDecoder];
    if (self) {
        self.touchEnabled = YES;
        self.textField = nil;
        self.editableTextField = nil;
        __selectedValue = @"";
        self.pickerView = nil;
        self.button = nil;
        self.textValue = nil;
        self.otherSelected = NO;
        self.backgroundColor = [UIColor clearColor];
        self.userInteractionEnabled = YES;
        self.values = [NSArray arrayWithObjects:@"Value1", @"Value2", @"Other", nil];
    }
    return self;
}

- (void)layoutSubviews
{
    if (self.textField == nil) {
        UITextField *textField = [[UITextField alloc] initWithFrame:CGRectMake(0, 0, self.frame.size.width, 31.0f)];
        textField.borderStyle = UITextBorderStyleRoundedRect;
        textField.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;
        textField.font = [UIFont systemFontOfSize:12.0f];

        UIPickerView *pickerView = [[UIPickerView alloc] init];
        [pickerView sizeToFit];
        pickerView.delegate = self;
        pickerView.dataSource = self;
        pickerView.showsSelectionIndicator = YES;
        if (self.textValue != nil && ![self.textValue isEqualToString:@""]) {
            textField.text = self.textValue;
            int matchedIndex = -1;
            int otherIndex = -1;
            for (int i = 0; i < self.values.count; i++) {
                NSString *value = [self.values objectAtIndex:i];
                if ([value isEqualToString:@"Other"]) {
                    otherIndex = i;
                }
                if ([self.textValue isEqualToString:[self.values objectAtIndex:i]]) {
                    matchedIndex = i;
                }
            }
            if (matchedIndex > -1) {
                [pickerView selectRow:matchedIndex inComponent:0 animated:NO];
            } else if (otherIndex > -1) {
                [pickerView selectRow:otherIndex inComponent:0 animated:NO];
            }
        }
        textField.inputView = pickerView;
        self.pickerView = pickerView;

        UIToolbar *accessoryView = [[UIToolbar alloc] init];
        [accessoryView sizeToFit];
        accessoryView.barStyle = UIBarStyleBlackOpaque;
        accessoryView.tintColor = [UIColor grayColor];
        UIBarButtonItem *spacer = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
        UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] initWithTitle:@"Done" style:UIBarButtonItemStyleDone target:self action:@selector(pickerDone:)];
        self.doneButton = doneButton;
        accessoryView.items = [NSArray arrayWithObjects:spacer, doneButton, nil];
        textField.inputAccessoryView = accessoryView;

        [self addSubview:textField];
        self.textField = textField;
    }

    if (self.button == nil) {
        UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
        button.backgroundColor = [UIColor clearColor];
        button.frame = self.bounds;
        [button addTarget:self action:@selector(buttonPressed:) forControlEvents:UIControlEventTouchUpInside];
        [self addSubview:button];
        self.button = button;
    }
}

- (void)buttonPressed:(id)sender
{
    if (self.fieldDelegate != nil) {
        [self.fieldDelegate performSelector:@selector(fieldBeganEditing:) withObject:self];
    }
    if (self.otherSelected) {
        self.doneButton.action = @selector(textFieldDone:);
        self.textField.inputView = nil;
    } else {
        self.doneButton.action = @selector(pickerDone:);
        self.textField.inputView = self.pickerView;
    }
    [self.textField becomeFirstResponder];
}

- (void)textFieldDone:(id)sender
{
    LogCmd();
    [self.textField resignFirstResponder];
    self.textField.inputView = self.pickerView;
    self.doneButton.action = @selector(pickerDone:);
    [self.textField becomeFirstResponder];
}

- (void)pickerDone:(id)sender
{
    LogCmd();
    NSString *value = [self.values objectAtIndex:[self.pickerView selectedRowInComponent:0]];
    if (!self.otherSelected) {
        self.textField.text = value;
        __selectedValue = value;
    }
    [self.textField resignFirstResponder];
}

/*- (void)setValues:(NSArray *)values
 {
 _values = values;
 [self.pickerView reloadAllComponents];
 }*/

#pragma mark - UITextFieldDelegate

- (void)textFieldDidEndEditing:(UITextField *)textField
{
    LogCmd();
}

#pragma mark - UIPickerViewDelegate

- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:      (NSInteger)component
{
    NSString *value = [self.values objectAtIndex:row];
    if ([value isEqualToString:@"Other"]) {
        self.otherSelected = YES;
        self.textField.text = @"";
        __selectedValue = @"";

        [self.doneButton setAction:@selector(textFieldDone:)];       
        self.textField.inputView = nil;
        [self.textField resignFirstResponder];
        [self.textField becomeFirstResponder];
        //[self.textField performSelector:@selector(becomeFirstResponder) withObject:nil afterDelay:0.2];
    } else {
        self.otherSelected = NO;
        self.textField.text = value;
        __selectedValue = value;
    }
}

- (NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:   (NSInteger)component
{
    return [self.values objectAtIndex:row];
}

#pragma mark - UIPickerViewDataSource

- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component
{
    return self.values.count;
}

- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView
{
    return 1;
} 
```

# java - 无法将 coredump 转换为 hprof

> ID：13829942
> 
> 赞同：2
> 
> 时间：2012-12-11T23:00:12.287
> 
> 标签：java, coredump, hprof, jmap

我有一个 core.31690 文件，我想将其转换为 hprof。我试过了：`jmap -dump:format=b,file=mydump.hprof /usr/bin/java core.31690`但我得到了以下信息：

```
Attaching to core core.31690 from executable /usr/bin/java, please wait...
Exception in thread "main" java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at sun.tools.jmap.JMap.runTool(JMap.java:179)
    at sun.tools.jmap.JMap.main(JMap.java:110)
Caused by: sun.jvm.hotspot.debugger.UnmappedAddressException
    at sun.jvm.hotspot.debugger.PageCache.checkPage(PageCache.java:208)
    at sun.jvm.hotspot.debugger.PageCache.getData(PageCache.java:63)
    at sun.jvm.hotspot.debugger.DebuggerBase.readBytes(DebuggerBase.java:217)
    at sun.jvm.hotspot.debugger.linux.LinuxDebuggerLocal.readCInteger(LinuxDebuggerLocal.java:482)
    at sun.jvm.hotspot.debugger.linux.LinuxAddress.getCIntegerAt(LinuxAddress.java:69)
    at sun.jvm.hotspot.utilities.CStringUtilities.getString(CStringUtilities.java:61)
    at sun.jvm.hotspot.HotSpotTypeDataBase.readVMTypes(HotSpotTypeDataBase.java:128)
    at sun.jvm.hotspot.HotSpotTypeDataBase.<init>(HotSpotTypeDataBase.java:85)
    at sun.jvm.hotspot.bugspot.BugSpotAgent.setupVM(BugSpotAgent.java:568)
    at sun.jvm.hotspot.bugspot.BugSpotAgent.go(BugSpotAgent.java:494)
    at sun.jvm.hotspot.bugspot.BugSpotAgent.attach(BugSpotAgent.java:348)
    at sun.jvm.hotspot.tools.Tool.start(Tool.java:169)
    at sun.jvm.hotspot.tools.HeapDumper.main(HeapDumper.java:77)
    ... 6 more 
```

我尝试在网上查找，但找不到任何东西。任何指针？

# multithreading - QtConcurrent 线程很慢！！我究竟做错了什么？

> ID：13829949
> 
> 赞同：1
> 
> 时间：2012-12-11T23:00:34.903
> 
> 标签：multithreading, qt, thread-safety, qtsql, qtconcurrent

为什么我`qtconcurrent::run()`的调用和通过对象调用成员函数一样慢？

（例如：`QtConcurrent::run(&db, &DBConnect::loadPhoneNumbers)`和调用一样慢`db.loadPhoneNumbers()`）

阅读下面的进一步解释

我一直在尝试通过创建一个线程`QtConcurrent::run`来帮助加快将数据发送到 SQL 数据库表的速度。我正在获取一个 QMap 成员变量并遍历它以将每个键 + 值发送到数据库。

QtConcurrent::run() 调用的成员函数：

```
void DBConnect::loadPhoneNumbers()
{

//m_phoneNumbers is a private QMap member variable in DBConnect
qDebug() << "\t[!] Items to send: " << m_phoneNumbers.size();

QSqlQuery query;
qDebug() << "\t[!] Using loadphonenumbers thread: " << QThread::currentThread();
qDebug() << "\t[!] Ideal Num of Threads: " << QThread::idealThreadCount();

bool isLoaded = false;

QMap<QString,QString>::const_iterator tmp = m_phoneNumbers.constBegin();

while(tmp != m_phoneNumbers.constEnd())
{
    isLoaded = query.exec(QString("INSERT INTO "+m_mtable+" VALUES('%1','%2')").arg(tmp.key()).arg(tmp.value()));

    if(isLoaded == false)
    {
        qDebug() << "\r\r[X] ERROR: Could\'t load number " << tmp.key() << " into table " << m_mtable;
        qDebug() << query.lastError().text();
    }

    tmp++;
}

} 
```

调用线程的 main.cpp 部分

```
DBConnect db("QODBC", myINI.getSQLServer(),C_DBASE,myINI.getMTable(), myINI.getBTable());
db.startConnect();

//...more code here

     qDebug() << "\n[*] Using main thread: " << QThread::currentThread() << endl;

         //....two qtconcurrent::run() threads started and finished here (not shown)

         qDebug() << "\n[*] Sending numbers to Database...";
         QFuture<void> dbFuture = QtConcurrent::run(&db, &DBConnect::loadPhoneNumbers);
         dbFuture.waitForFinished(); 
```

**我对情况的理解**

据我了解，该线程将在与主线程分开的新线程池下运行。我所看到的情况并非如此（请注意，在此之前还有 2 个其他 QtConcurrent::run() 调用用于数据库，在继续数据库调用之前全部完成）

现在我考虑使用 QtConcurrent::map() / mapped() 但无法让它与 QMap 一起正常工作。（找不到任何可以帮助的例子，但除此之外......只是一个仅供参考，以防有人问我为什么不使用一个）

一直在做一些“调试”工作来找出发生了什么，在我的测试中，我使用 QThread::currentThread() 来查找我当前正在从哪个线程进行调用。这就是我程序中的各个线程正在发生的事情。（所有 qtconcurrent::run() 调用都是在 main.cpp 中进行的，仅供参考......不确定这是否有区别）

```
Check what is main thread: on QThread(0x5d2cd0)
Run thread 1: on QThread(0x5dd238, name = "Thread (pooled)")
Run thread 2: on QThread(0x5d2cd0)
Run thread 3 (loadPhoneNumbers function): on QThread(0x5d2cd0) 
```

如上所示，除了第一次`qtconcurrent::run()`调用外，其他一切都在主线程上（oO）

**问题：**

据我了解，我所有的线程（全部`qtconcurrent::run`）都应该在他们自己的线程上（只有第一个是）。这是真的还是我错过了什么？

其次，我的 loadPhoneNumebrs() 成员函数线程安全吗？（因为我没有改变我所看到的任何东西）

**最大的问题：** 为什么我的`loadPhoneNumbers()` `qtconcurrent::run`调用和我刚刚调用成员函数一样慢？（例如：`db.loadPhoneNumbers()`与 qtconcurrent::run() 版本一样慢）

**任何帮助深表感谢！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T00:30:34.130

线程不会神奇地加快速度，它们只是让你可以在后台发生时继续做其他事情。当您调用时`waitForFinished()`，您的主线程将不会继续，直到加载电话号码线程完成，基本上否定了这一优势。根据实现，这可能就是你`currentThread()`显示与 main 相同的原因，因为等待已经发生。

在速度方面可能更重要的是构建一个插入列表中所有值的单个查询，而不是为每个值单独查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T19:47:35.537

根据 QtSql 文档：

> 只能在创建它的线程内使用连接。不支持在线程之间移动连接或从不同线程创建查询。

无论如何它都可以工作，因为 ODBC 本身支持对单个 ODBC 句柄的多线程访问。但是由于您只使用一个连接，因此所有查询都可能由 ODBC 序列化，就好像只有一个线程一样（例如，请参阅[Oracle 的 ODBC 驱动程序所做的事情](http://msdn.microsoft.com/en-us/library/windows/desktop/ms716381%28v=vs.85%29.aspx)）。

`waitForFinished()`调用一个私有函数`stealRunnable()`，顾名思义，它从`QFuture`队列中获取一个尚未启动的任务，并在当前线程中运行它。

# iphone - 钛存储套件模块错误

> ID：13829953
> 
> 赞同：1
> 
> 时间：2012-12-11T23:00:42.140
> 
> 标签：iphone, objective-c, module, in-app-purchase, titanium

嗨，我正在使用钛中的商店套件模块。代码工作正常，直到我添加购买产品的行我的代码如下

```
 var Storekit = require('ti.storekit'); 
Storekit.requestProducts([ 'com.example.qld.inapp' ], function (evt) {
if (!evt.success) {
    alert('ERROR: We were not able to get the product!');
}
else if (evt.invalid) {
    alert('ERROR: We requested an invalid product!');
}
else {
    alert(evt.products[0]);
   Storekit.purchase(evt);
}
}); 
```

当我添加购买行时，它会出现以下错误

```
[ERROR] Exception in event callback: {
line = 14;
message = "*** -[__NSArrayM objectAtIndex:]: index 1 beyond bounds [0 .. 0]";
sourceId = 173081376;
sourceURL = "file://localhost/Users/aadilf/Library/Application%20Support/iPhone%20Simulator/5.0/Applications/C7C55347-5965-4C58-9624-8A41837459D4/QLD%20Best%20Bets.app/home.js";
  } 
```

因为在我无法解决此错误之前我还没有完成目标 c

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T00:36:54.507

您没有指定要购买的对象。您正在购买活动本身（其中包含一个状态以及零个、一个或多个产品）。

```
Storekit.purchase(evt.products[0]); 
```

# node.js - 从模块调用的nodejs

> ID：13829955
> 
> 赞同：1
> 
> 时间：2012-12-11T23:00:48.990
> 
> 标签：node.js

我怎么知道用 node 编写的脚本被 require 调用了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T23:09:07.647

从[节点文档](http://nodejs.org/docs/latest/api/modules.html#modules_accessing_the_main_module)：

> ## 访问主模块
> 
> 当一个文件直接从 Node 运行时，require.main 被设置为它的模块。就是说可以通过测试直接判断一个文件是否已经运行过
> 
> ```
>  require.main === module 
> ```
> 
> 对于文件 foo.js，如果通过节点 foo.js 运行，则为 true，如果通过 require('./foo') 运行，则为 false。
> 
> 因为module提供了一个filename属性（一般相当于__filename），所以可以通过检查require.main.filename来获取当前应用的入口点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T07:09:40.617

您可以检查对象`parent`的属性`module`。如果 require 调用的`module.parent`模块将返回调用者模块，否则`module.parent`为 null。

# svn - SVN：移动一个文件，然后添加一个旧名称的文件

> ID：13829957
> 
> 赞同：0
> 
> 时间：2012-12-11T23:00:52.970
> 
> 标签：svn, refactoring

我正在重构一个使用`SVN`. 当前代码有 2 个类，比如`Model`和`Model_ext`（每个都有一个`.hh`文件和一个`.cpp`文件），它们不是相互派生的。`Model`不应该被扩展，但它实现了一个特定的模型。

我想创建一个抽象基类，但这个更合乎逻辑的名称是`Model`. 特定于当前实现的模型的代码`Model`应该移动到一个`Model_A`派生自它的类中。同样，`Model_ext`应该重命名`Model_B`但这不是问题。

从版本控制的角度来看，我想`Model`转向`Model_A`：

```
svn mv Model.cpp Model_A.cpp 
```

（对于头文件也是如此）以表明这`Model_A.cpp`是新版本`Model.cpp`（并且它将具有本地修改）。

当然，我还必须添加新的`Model.cpp`. 有可能还是会混淆`SVN`？

我知道可以修改`Model.cpp`、添加`Model_A.cpp`（不使用`svn mv`）和提交这两个文件，但这会破坏新旧文件之间的所有`Model.cpp`链接`Model_A.cpp`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T00:09:36.643

刚刚尝试了以下...

```
$ svn move file.txt new.file.txt
A         new.file.txt
D         file.txt
$ vi file.txt
$ svn add file.txt
A         file.txt
$ svn status
R         file.txt
A         new.file.txt
$ svn commit -m"test"
Replacing      file.txt
Adding         new.file.txt
Transmitting file data .
Committed revision 5. 
```

似乎对我有用。

# windows - 检查线程是否在 Windows 中处于活动状态

> ID：13829958
> 
> 赞同：0
> 
> 时间：2012-12-11T23:00:54.107
> 
> 标签：windows, multithreading

我最近尝试编写代码来检查 Windows 中的线程是否处于活动状态。我搜索了这个论坛，发现了这样的讨论：[如何检查进程或线程是否处于活动状态，或者在 C++ 中没有给出它们的 ID？](https://stackoverflow.com/questions/8083847/how-to-check-if-a-process-or-thread-is-alive-or-not-given-their-ids-in-c).

我知道我可以使用 OpenThread API。但是，它似乎在我的代码中不起作用，如下所示。

```
DWORD WINAPI myThread( LPVOID lpParam )
{
    cout<<"child thread"<<endl;
    return 0;
}

int main(void)
{
    DWORD  lTldID = 0;
    HANDLE lTldHD = CreateThread(NULL, 0, myThread, 0, 0, &lTldID);

    WaitForSingleObject(lTldHD, INFINITE);
    HANDLE lHD = OpenThread(0x0040, FALSE, lTldID);
    return 1;
} 
```

我希望 HANDLE lHD 应该为 NULL，因为线程“myThread”应该在调用 OpenThread() 时完成。但是，我总是得到 NOT NULL 值，例如 0x00000068。我不知道为什么会这样。任何想法？

谢谢，小莫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-17T10:49:47.740

```
BOOL WINAPI GetExitCodeThread(
  _In_  HANDLE  hThread,
  _Out_ LPDWORD lpExitCode
); 
```

该函数立即返回。如果指定的线程没有终止并且函数成功，返回的状态是`STILL_ACTIVE`。

# css - 嵌套选择器性能影响和 LESS

> ID：13829959
> 
> 赞同：8
> 
> 时间：2012-12-11T23:00:56.593
> 
> 标签：css, performance, optimization, css-selectors, less

在过去的 1.5 小时里，我一直在阅读这方面的内容，但仍然找不到简明而*果断*的答案。

据我了解，浏览器从右到左解析 CSS 选择器。

这意味着一个长的 CSS 选择器，例如：

```
.card .container .businesscard .pinfo li.pinfo-box span:first-child 
```

是 SO 中出现过的效率最低的代码行之一。

首先，我对这个正确吗？

其次，我正在使用 LESS 设计一个丰富的 UI，它最终会从我正在编码的嵌套设计中产生这种庞大的选择器。

可以做些什么来避免这种选择器？仅依靠类和 ID？但是，如果您不能编写嵌套 CSS，那么使用 LESS 的目的又是什么？

感谢您的意见。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-11T23:11:31.040

那是对的。浏览器从右到左评估选择器。它将尝试找到一个`span`内部的 a`li.pinfo-box`等等。

编写 LESS 时要遵循的一条经验法则是：**不要嵌套超过 3-4 层。**

这将防止您的选择器变大，而您仍然可以从 LESS 中的嵌套功能中受益。

“无用”嵌套的一个很好的例子是样式列表。有时我会这样写选择器：

`#wrapper .blog-post ul`,`#wrapper .blog-post ul li`

真的有必要指定`li` **必须**在 a 内`ul`吗？写起来可能就够了：

`#wrapper .blog-post li`

所有这一切都很高兴知道。但是：在尝试优化您的网站性能时，这并不是要深入研究的第一件事。花一些时间减少请求的数量或其他东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-11T23:12:57.787

除非您有非常不寻常的内容，否则选择器解析和匹配不太可能是一个重要因素。我建议使用任何可维护的东西并完成工作，直到测试显示性能问题为止。然后我会拿出一个分析器（在 OSX 上我会使用 Instruments，但应该有一个适用于大多数平台的不错的）并将它附加到浏览器；如果选择器匹配在配置文件中显示很高，那么考虑用更快的选择器替换慢速选择器（id 选择器绝对是一个不错的选择）。

# objective-c - 如何像 iPhoto 一样将 UIImageView 的滚动限制在 UIImage 的范围内？

> ID：13829960
> 
> 赞同：1
> 
> 时间：2012-12-11T23:00:57.070
> 
> 标签：objective-c, ios, uiscrollview, uiimageview, uiimage

这是 iPhoto 中的图像：

![在此处输入图像描述](../Images/3eb81d1b7b1114d55e1c25b52d2ceafa.png)

这是 iPhoto 左上角的放大图：

![在此处输入图像描述](../Images/c4c9eaeb7e2cf44ca50c4e86ac544d3f.png)

这是我的应用程序中的相同图像：

![在此处输入图像描述](../Images/347a7f8129b0b7aaf2b904440527efe3.png)

在这里它被放大到我的应用程序的左上角：

![在此处输入图像描述](../Images/60cb39ea417186bbd2b4f4dd6720d074.png)

如何丢失图像周围多余的灰色空间并将滚动限制在 UIImage 的边界（如 iPhoto）？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:22:25.720

因此，除了使用 3rd 方库之外，我还使用以下方法解决了这个问题：

[IOS。如何将 UIScrollview 滚动限制在有限的范围内？](https://stackoverflow.com/questions/10905953/ios-how-do-i-restrict-uiscrollview-scrolling-to-a-limited-extent)，将答案调整为以下方法，我希望这些方法可以自我解释：

```
- (CGRect) methodThatGetsImageSizeOnScreen
{

float frameHeight;
float frameWidth;
float frameXOrigin;
float frameYOrigin;

float threshold;
BOOL thisImageTouchesLeftAndRight;

UIInterfaceOrientation thisOrientation = self.interfaceOrientation;

if (UIInterfaceOrientationIsLandscape(thisOrientation)){

    threshold = 748.0/1024.0;

    if ((self.imageToPresent.size.height == self.imageToPresent.size.width) | ((self.imageToPresent.size.height/self.imageToPresent.size.width) > threshold)){

        thisImageTouchesLeftAndRight = NO;

        frameWidth = (748/self.imageToPresent.size.height)*self.imageToPresent.size.width;
        frameHeight = 748;
        frameXOrigin = (1024-frameWidth)/2;
        frameYOrigin = 0;
    }
    else
    {
        thisImageTouchesLeftAndRight = YES;

        frameWidth = 1024;
        frameHeight = (1024/self.imageToPresent.size.width)*self.imageToPresent.size.height;
        frameXOrigin = 0;
        frameYOrigin = (748-frameHeight)/2;
    }
}
else {

    threshold = 768.0/1004.0;

    if ((self.imageToPresent.size.height == self.imageToPresent.size.width) | ((self.imageToPresent.size.width/self.imageToPresent.size.height) > threshold)){

        thisImageTouchesLeftAndRight = YES;

        frameWidth = 768;
        frameHeight = (768/self.imageToPresent.size.width)*self.imageToPresent.size.height;
        frameXOrigin = 0;
        frameYOrigin = (1004-frameHeight)/2;
    }
    else
    {
        thisImageTouchesLeftAndRight = NO;

        frameWidth = (1004/self.imageToPresent.size.height)*self.imageToPresent.size.width;
        frameHeight = 1004;
        frameXOrigin = (768-frameWidth)/2;
        frameYOrigin = 0;
    }

}

CGRect theRect = CGRectMake(frameXOrigin, frameYOrigin, frameWidth, frameHeight);

return theRect;
}

#pragma mark - UIScrollViewDelegate

- (void) scrollViewDidScroll:(UIScrollView*)scroll{

UIInterfaceOrientation thisOrientation = self.interfaceOrientation;

float largeDimension;
float smallDimension;

if (UIInterfaceOrientationIsLandscape(thisOrientation)){

    largeDimension = 1024;
    smallDimension = 748;
}
else{

    largeDimension = 1004;
    smallDimension = 768;

}

CGPoint offset = scroll.contentOffset;

CGRect results = [self methodThatGetsImageSizeOnScreen];

float frameHeight = results.size.height;
float frameYOrigin = results.origin.y;

float frameWidth = results.size.width;
float frameXOrigin = results.origin.x;

//So, we start the limiting of a landscape image in portrait (in the y direction) when we exceed the following criteria:

if((frameHeight*self.scrollView.zoomScale) > largeDimension){

    if(offset.y < self.scrollView.zoomScale*frameYOrigin) offset.y = self.scrollView.zoomScale*frameYOrigin;

    if(offset.y > ((self.scrollView.zoomScale*frameYOrigin)+(frameHeight*self.scrollView.zoomScale)-largeDimension)) offset.y = ((self.scrollView.zoomScale*frameYOrigin)+(frameHeight*self.scrollView.zoomScale)-largeDimension);

}

if((frameWidth*self.scrollView.zoomScale) > largeDimension){

    if(offset.x < self.scrollView.zoomScale*frameXOrigin) offset.x = self.scrollView.zoomScale*frameXOrigin;

    if(offset.x > ((self.scrollView.zoomScale*frameXOrigin)+(frameWidth*self.scrollView.zoomScale)-largeDimension)) offset.x = ((self.scrollView.zoomScale*frameXOrigin)+(frameWidth*self.scrollView.zoomScale)-largeDimension);

}

    // Set offset to adjusted value
    scroll.contentOffset = offset;

//Remember you may want your minimum zoomScale set in viewDidLoad or viewWillAppear

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T23:06:46.323

您可以使用执行此操作的库。试试[MWPhotoBrowser](https://github.com/mwaterfall/MWPhotoBrowser)。

# r - Roxygen 如何处理中缀二元运算符（例如 %in%）？

> ID：13829961
> 
> 赞同：6
> 
> 时间：2012-12-11T23:01:00.683
> 
> 标签：r, roxygen, roxygen2

作为一个简单而具体的例子：

```
#' Inverse Value Matching
#' 
#' Complement of \code{%in%}. Returns the elements of \code{x} that are
#' not in \code{y}.
#' @usage x %nin% y
#' @param x a vector
#' @param y a vector
#' @export
"%nin%" <- function(x, y) {
  return( !(x %in% y) )
} 
```

但是，当我尝试构建一个包时，该功能似乎被忽略了，并且没有生成任何文档。

[在http://cran.r-project.org/doc/manuals/r-release/R-exts.html#Documenting-functions](http://cran.r-project.org/doc/manuals/r-release/R-exts.html#Documenting-functions)似乎有一个关于二进制中缀函数的单行简介，但我很难解析它的时间，以及它对 Roxygen 文档的影响。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-11T23:10:37.393

您需要转义`%`使用部分中的 s。另外，我认为您可能需要指定一个`rdname`

```
#' Inverse Value Matching
#' 
#' Complement of \code{%in%}. Returns the elements of \code{x} that are
#' not in \code{y}.
#' @usage x \%nin\% y
#' @param x a vector
#' @param y a vector
#' @export
#' @rdname nin
"%nin%" <- function(x, y) {
  return( !(x %in% y) )
} 
```

* * *

这是我在个人包中的一个功能。我认为我从未真正使用过该功能，但`roxygenize`确实创建了一个帮助文件并且包通过了`R CMD check`.

```
#' percent in
#' 
#' calculate the percentage of elements of \code{table} that are in \code{x}
#' 
#' @param x vector or NULL: the values to be matched
#' @param table vector or NULL: the values to be matched against
#' @return percentage of elements of \code{x} that are in \code{table}
#' @author gsee
#' @usage x \%pctin\% table
#' @examples
#' letters[1:10] %pctin% letters[1:3] # 30% of the second arg ar in the first
#' @export
#' @rdname PctIn
"%pctin%" <- function(x, table) length(x[x %in% table])/length(x) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-08T10:47:24.240

我在使用`roxygen`（说到`roxygen`not `roxygen2`）和中缀运算符时遇到了困难。以下是我的设置（`R`2.15.1、0.1-3 `roxygen`）。

第一个解决方案：编辑`Rd`每个中缀运算符（应该是 ）的文件，并在,和部分中`grapes ... grapes.Rd`的 each 用一个斜杠转义。`%``\alias``\usage``\name`

第二种解决方案：在中缀运算符的文档中指定标签 @name 和 @usage 并将`%`. 这是一个例子：

```
##' Concatenates two strings
##'
##' @name \%+\%
##' @usage \%+\%(x, y)
##' @title Concatenation operator.
##' @param a String.
##' @param b String.
##' @return Same as paste0(a, b).
"%+%" <- function(a, b) paste(a, b, sep = "") 
```

# math - python整数逼近

> ID：13829962
> 
> 赞同：2
> 
> 时间：2012-12-11T23:01:14.130
> 
> 标签：math, python-3.2

在 python 中，该函数`math.log(1000, 10)`返回
2.9999999998 或某个近似值（几乎每三个整数都会这样做）

这首先有点搞砸了，尽管我想没有太多（除法测试除外）可以做。
其次，这当然不是我想要的价值，我应该如何进行？转换为 int 显然会返回 2 而不是 3... 那么使用什么方法将舍入到最近的 int 呢？在这种情况下，一般来说，请。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T20:52:28.027

有人在我接受之前删除了他/她的答案，所以我写了我的，这不过是一个摘要。

我喜欢的两个选项：

在这种特殊情况下，由于操作是`math.log(1000, 10)`，因此可以将其替换为`math.log10(1000)`显示更高精度的操作。

在更一般的情况下，round(math.log(1000, 10)) 会将 2.999... 舍入为整数 3，因此这将是所要求的更多。

# ios - iOS后台Region Location更新

> ID：13829963
> 
> 赞同：0
> 
> 时间：2012-12-11T23:01:22.163
> 
> 标签：ios, background, location, monitoring, region

我正在构建一个带有区域监控的应用程序。它在前台工作正常，但是一旦应用程序在后台发送，它的行为就不像预期的那样：它确实调用了 didEnter 和 didExit 但一旦它开始执行回调它就会停止。在这些回调方法中，我需要轮询服务器并保持 didExitRegion 和/或 didEnterRegion 状态。一旦我再次将应用程序置于前台，任何排队的请求都会启动并完成。任何想法？我在 iphone 4 上使用 ios5.1 和 ios6

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T18:00:33.377

当你在后台被调用时

```
- (void)locationManager:(CLLocationManager *)manager didEnterRegion:(CLRegion *)region 
```

（或...退出）

只需设置服务器调用所需的任何内容（变量、服务器的有效负载等）。在实际发送开始之前

```
self.bgTaskId = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:^{
    [[UIApplication sharedApplication] endBackgroundTask:self.bgTaskId];
    self.bgTaskId = UIBackgroundTaskInvalid;
    somelogger(@"ran out of time for background task");

    // remember that we failed for the next time the app comes to the foreground
}]; 
```

然后使用您选择的 HTTP 框架进行实际发送，并在完成处理程序中重置后台任务

```
[[UIApplication sharedApplication] endBackgroundTask:self.bgTaskId]; 
```

使用 AFNetworking 的示例：

```
[self.httpClient postPath:@"state" parameters:@{@"abc": abc, @"value": val, @"h": h, @"app":myAppName , @"version": myAppVersion }
    success:^(AFHTTPRequestOperation *operation, id responseObject) {
      if (operation.response.statusCode != 200) {
          DDLogVerbose(@"response was not 200\. error: %i", operation.response.statusCode);

      } else {
          DDLogVerbose(@"success");

      }

      [[UIApplication sharedApplication] endBackgroundTask:self.bgTaskId];

    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {
      DDLogVerbose(@"request error %@, current retry count %d", error, retryCount );

      // start our own retry mechanism
      if (retryCount < MAX_RETRIES) {
          retryCount++;
          double delayInSeconds = RETRY_INTERVAL * (1 + (double)retryCount/10);
          dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);
          dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
              // try again
          });
      } else {
          // final
          [[UIApplication sharedApplication] endBackgroundTask:self.bgTaskId];

          // remember failure when app comes back to foreground
      }

    }]; 
```

我正在使用一个

```
@property (assign, nonatomic) UIBackgroundTaskIdentifier bgTaskId; 
```

存储背景标识符。

整个机制在[http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW28中进行了解释](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW28)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T23:06:29.053

如果你想活下去，你必须要求额外的时间。请参阅有关后台模式的 applle 文档。有一种方法。通常，您不会“被允许”在任何任务的后台保持活动状态。仅适用于特定的，例如 GPS。尝试在每次区域更新后请求额外的后台时间。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-11T23:21:11.503

如果您尚未将“位置”添加到 Info.plist 的 UIBackgroundModes。作为第二个想法，我会使用广受欢迎且具有后台支持的[AFNetworking 。](https://github.com/AFNetworking)这意味着它将处理设置参数以告诉操作系统它将“在我回去睡觉之前完成这件事”。

![在此处输入图像描述](../Images/5019b1d08dc7122d0e9375ac78ff813b.png)

# razor - 在 MVC 4 中，在提交时将客户端 DropDown 值分配给模型属性

> ID：13829966
> 
> 赞同：1
> 
> 时间：2012-12-11T23:01:35.743
> 
> 标签：razor, asp.net-mvc-4, visual-studio-2012

我在视图中有 1 个客户端下拉菜单。Dropdowns 的内容是从 Js 文件中加载的。在提交时，我希望将选定的下拉值分配给模型属性并将其发送给控制器。

模型

```
public class TestMe
{
   public int Id { get; set; }
   public string Name {get; set; }
} 
```

控制器

```
[HttpPost]
public ActionResult Edit (TestMe viewModel)
{
 ....
} 
```

看法

```
<select name="Id">
    <option value="0">High</option>
    <option value="1">Medium</option>
    <option value="2">Low</option>
</select> 
```

MVC 4，剃刀，C#.Net Visual Studio 2012。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T23:13:09.423

**为什么不通过 Html Helpers 生成此下拉列表？**

无论如何，只需确保您的客户端下拉列表位于表单标签中，并将其名称与您的模型属性名称一样，一切都应该正常工作。

我想你有这样的东西。

```
public class TestMe{
   public int Id { get; set; }
   public string Name {get; set; }
} 
```

并且您的下拉列表代表 Id 属性，您的控制器操作是：

```
[HttpPost]
public ActionResult Edit (TestMe viewModel)
{
....
} 
```

**然后您的下拉列表应该具有带有“Id”值的名称属性。**

```
<select name="Id" id="Id">
<option value="10">10</option>
.......
</select> 
```

# sql - Excel 没有正确读取 sql 导出的 csv

> ID：13829970
> 
> 赞同：0
> 
> 时间：2012-12-11T23:01:47.770
> 
> 标签：sql, datetime, csv, sqlcmd

我有一个批处理文件，它调用 sqlcmd 来运行命令，然后将数据导出为 csv。例如，在单元格中查看时，会显示经过的日期，`35:30.0`但如果单击它，则公式栏会显示`1/1/1900 2:45:00 PM`。我需要在单元格中显示完整的时间戳。有任何想法吗？

批处理文件如下

```
sqlcmd -S server -U username -P password -d database -i "D:\path\sqlScript.sql"  -s "," > D:\path\report.csv -I -W -k 1 
```

脚本如下。现在我目前将它们转换为 varchars，但这仅仅是因为我尝试对其进行一些更改。Varchar 也不起作用。

```
SET NOCOUNT ON;

select top(10)BO.Status,
cast(tradeDate AS varchar) AS Trade_Date,
CAST(closingTime AS varchar) AS Closing_Time,
CAST(openingTime AS varchar) AS openingTime 
```

来自各种表格的巨大复杂连接

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T02:44:19.373

您可以在日期字符串之前或之后添加任何 Excel 无法识别的字符作为字段分隔符（我使用了冒号），当文件打开或导入 Excel 时，该字符串将被保留。

或者，您可以按原样进行导入，只需在 Excel 中为日期单元格设置自定义格式：“m/d/yyyy hh:mm:ss A/P”应该可以完成这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T02:17:06.733

也许[csv2odf](http://csv2odf.sourceforge.net)会工作。它有一个 -d 选项，允许您指定 csv 文件中日期的格式。它还使用模板 (xlsx)，您可以格式化日期在 Excel 中的显示方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T23:35:38.710

这不是更多的excel格式问题吗？有什么方法可以让您准确检查 SQL 返回的内容？您在导入向导对话框中为日期列的单元格格式选择了什么？（如果您只是直接在 Excel 中打开 CSV，请尝试改用“文本数据”导入）

# java - 如何使用嵌入的 Glassfish 提供静态内容？

> ID：13829974
> 
> 赞同：2
> 
> 时间：2012-12-11T23:01:59.203
> 
> 标签：java, glassfish-embedded

我正在尝试设置 Glassfish 嵌入了一个实现 REST API 的 WAR 项目，然后是一些调用它的静态 Javascript 内容。我得到了要部署的 WAR，并且 REST API 可用于“/Users”的上下文根。

如何使用 Glassfish 提供上下文根为“/”的静态内容。例如，如果用户请求[http://myserver.com/Users/some-REST-call](http://myserver.com/Users/some-REST-call)它会路由到 WAR 应用程序，而[http://myserver.com/somefile.js](http://myserver.com/somefile.js)从某个目录提供静态文件？

到目前为止，这是我的主类文件：

```
public class Main{
    public static void main(String[] args) throws Exception {
        String port = System.getenv("PORT");
        port = port != null ? port : "8080";
        GlassFishProperties gfProps = new GlassFishProperties();
        gfProps.setPort("http-listener", Integer.parseInt(port));

        GlassFish glassfish = GlassFishRuntime.bootstrap().newGlassFish(gfProps);
        glassfish.start();

        Deployer deployer = glassfish.getDeployer();

        deployer.deploy(new File("target/Users-Rest.war"));
    }
} 
```

PS 我知道理想情况下你会使用 Apache 来提供静态内容，但是，我正在使用 Glassfish 嵌入来尝试部署到 Heroku。非常感谢您的帮助！

# android - Android：仅当日期较新时才更新 Sqlite

> ID：13829976
> 
> 赞同：0
> 
> 时间：2012-12-11T23:02:05.640
> 
> 标签：android, sql, database, datetime

我有一个表，其中包含一行值 String datetime() 和一个 id（以及更多）。

现在我想更新 WHERE id = xx 并且仅当 my.Datatime 比存储的日期时间更新时。我怎样才能做到这一点？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:03:58.233

如果“你的日期时间”是 '2012-12-12'，那么

```
WHERE id = xx
  and '2012-12-12' > Datatime 
```

# c# - C# 生产者-消费者队列中的 ArgumentException

> ID：13829980
> 
> 赞同：4
> 
> 时间：2012-12-11T23:02:21.233
> 
> 标签：c#, multithreading

![在此处输入图像描述](../Images/3de20e2c718b34e1c3f5d03b50dde9d9.png)我有一个如下的生产者/消费者队列，但我得到了`ArgumentWException`.

以下是代码：

```
public class ProducerConsumer<T> where T : class
    {
        #region Private Variables
        private Thread _workerThread;
        private readonly Queue<T> _workQueue;
        private  object _enqueueItemLocker = new object();
        private  object _processRecordLocker = new object();
        private readonly Action<T> _workCallbackAction;
        private AutoResetEvent _workerWaitSignal;
        #endregion

        #region Constructor
        public ProducerConsumer(Action<T> action)
        {
            _workQueue = new Queue<T>();
            _workCallbackAction = action;

        }
        #endregion
        #region Private Methods 
        private void ProcessRecord()
        {
            while (true)
            {               
                T workItemToBeProcessed = default(T);
                bool hasSomeWorkItem = false;
                lock (_processRecordLocker)
                {
                    hasSomeWorkItem = _workQueue.Count > 0;

                    if (hasSomeWorkItem)
                    {
                        workItemToBeProcessed = _workQueue.Dequeue();
                        if (workItemToBeProcessed == null)
                        {
                            return;
                        }
                    }
                }
                if (hasSomeWorkItem)
                {
                    if (_workCallbackAction != null)
                    {
                        _workCallbackAction(workItemToBeProcessed);
                    }
                }
                else
                {
                    _workerWaitSignal.WaitOne();
                }
            }
        }
        #endregion

        #region Public Methods
        /// <summary>
        /// Enqueues work item in the queue.
        /// </summary>
        /// <param name="workItem">The work item.</param>
        public void EnQueueWorkItem(T workItem)
        {
            lock (_enqueueItemLocker)
            {               
                _workQueue.Enqueue(workItem);

                if (_workerWaitSignal == null)
                {
                    _workerWaitSignal = new AutoResetEvent(false);
                }

                _workerWaitSignal.Set();
            }
        }
        /// <summary>
        /// Stops the processer, releases wait handles.
        /// </summary>
        /// <param name="stopSignal">The stop signal.</param>
        public void StopProcesser(AutoResetEvent stopSignal)
        {
            EnQueueWorkItem(null);

            _workerThread.Join();
            _workerWaitSignal.Close();
            _workerWaitSignal = null;

            if (stopSignal != null)
            {
                stopSignal.Set();
            }
        }
        /// <summary>
        /// Starts the processer, starts a new worker thread.
        /// </summary>
        public void StartProcesser()
        {
            if (_workerWaitSignal == null)
            {
                _workerWaitSignal = new AutoResetEvent(false);
            }
            _workerThread = new Thread(ProcessRecord) { IsBackground = true };
            _workerThread.Start();
        }
        #endregion
    } 
```

另一类是：

```
public class Tester
{
    private readonly ProducerConsumer<byte[]> _proConsumer;
    public Tester()
    {
        _proConsumer = new ProducerConsumer<byte[]>(Display);
    }
    public void AddData(byte[] data)
    {
        try
        {
            _proConsumer.EnQueueWorkItem(recordData);
        }
        catch (NullReferenceException nre)
        {

        }
    }
    public void Start()
    {
        _proConsumer.StartProcesser();
    }

    private static object _recordLocker = new object();

    private void Display(byte[] recordByteStream)
    {
        try
        {
            lock (_recordLocker)
            {
                Console.WriteLine("Done with data:" + BitConverter.ToInt32(recordByteStream, 0));

            }

        }
        catch (Exception ex)
        {

        }

    }
} 
```

我的主要功能：

```
class Program
    {
        private static Tester _recorder;
        static void Main(string[] args)
        {
            _recorder = new Tester();
            _recorder.StartRecording();

            for (int i = 0; i < 100000; i++)
            {
                _recorder.AddRecordData(BitConverter.GetBytes(i));              
            }

            Console.Read();
        }
    } 
```

知道为什么我会得到异常，我应该怎么做才能避免这种情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-11T23:07:31.380

您的类在其当前实现中不是线程安全的。您在`Enqueue`( `lock (_enqueueItemLocker)`) 和`Dequeue`( `lock (_processRecordLocker)`) 调用中使用了两个不同的对象，这会在`Queue<T>`.

为了安全地使用队列，您需要在两个调用中锁定*相同的对象实例。*

如果您使用的是 .NET 4，我建议您使用`ConcurrentQueue<T>`or`BlockingCollection<T>`代替，因为这些将消除您的代码中对锁的需求，因为它们是线程安全的。

# jquery - 让 div 'fadeOut' 然后在不同的地方'fadeIn'

> ID：13829986
> 
> 赞同：3
> 
> 时间：2012-12-11T23:03:05.257
> 
> 标签：jquery, jquery-ui

所以这里是交易。我正在尝试构建交互式列表（就像 ToDo 列表一样）。我的任务是单击“div.item”时应该从“容器”中消失（淡出），然后在“垃圾桶”中淡入。这是代码，但是当我运行它时，所有动画都发生在“垃圾桶”中。我试图设置一个变量等于我的“.item”并用它进行操作，仍然没有结果。

```
<script type="text/javascript" src="createList.js">

  $(document).on('click', '.item', function (){
        $(this).fadeOut('slow');
        $(this).appendTo('#shoppingChart').fadeIn('slow');
    });
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:23:41.913

您需要制作动画，然后运行该函数以追加 -

```
$(document).on('click', '.item', function (){
    $(this).fadeOut('slow',function () {
         $(this).appendTo('#shoppingChart').fadeIn('slow');
    });
});​ 
```

**编辑**——工作示例[——http://jsfiddle.net/jmsessink/NHtv4/](http://jsfiddle.net/jmsessink/NHtv4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T23:25:17.127

淡入淡出方法是非阻塞的，因此它们不会阻止后续方法的发生。如果您希望等到他们完成后再继续，请使用他们的回调：

```
// Listen for any click on an img within #desktop
$("#desktop").on("click", "img", function () {
    // Fade that image out over a second
    $(this).fadeOut(1000, function () {
        // When fade is complete, move item and fade-in
        $(this).appendTo("#trash").fadeIn();
    });
});​​​​​​​​​​​​​ 
```

演示：http: [//jsfiddle.net/9U2dP/](http://jsfiddle.net/9U2dP/)

您还可以使用延迟：

```
// Listen for any click on an img within #desktop
$("#desktop").on("click", "img", function () {
    // When our hide instruction is done
    $.when($(this).hide(1000)).done(function(item){
        // Append the item to #trash, and fade it into view
        $(item).appendTo("#trash").fadeIn(1000);
    });
}); 
```

演示：http: [//jsfiddle.net/9U2dP/3/](http://jsfiddle.net/9U2dP/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T23:11:12.430

您必须等待动画完成，然后将项目附加到垃圾桶，然后淡入。

这是一个工作演示：http: [//jsbin.com/ipovic/1/edit](http://jsbin.com/ipovic/1/edit)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-11T23:13:47.603

[***jsFiddle 演示***](http://jsfiddle.net/A7GLb/1/)

淡入淡出操作是异步的，所以调用方法只是触发动作——下一次调用不会等待它完成。[要显示动画的两个部分，请使用 JavaScript 的原生setTimeout 方法](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)将后续动作延迟一个时间常数。

此示例代码为淡出动作分配 1 秒，在该点之后的任何位置停止动画，然后适当地触发淡入动作。

```
$(document).on('click', '.item', function (){
    var $this = $(this);
    $this.fadeOut('slow');
    setTimeout(function() {
        $this.stop()
            .appendTo('#shoppingChart')
            .fadeIn('slow');
    }, 1000);
});​ 
```

# html - 以播放 Flash 启动网站，最后以常规网站继续

> ID：13829998
> 
> 赞同：-1
> 
> 时间：2012-12-11T23:03:57.090
> 
> 标签：html, flash

我想以 Flash 电影作为介绍来开始我的网站。闪存完成后，我想继续访问我的常规网站。我有 Flash 电影（全屏）和网站。我只是找不到正确的连接。任何人的任何想法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T23:19:07.877

在意识到这一点之前，先了解一下 SEO。

有几种方法可以实现这种“seofriendly”。

这是我的解决方案：构建您的 HTML 页面。添加然后通过“JW-Player”全屏将您的视频添加到容器 eG 中：

```
<div id="myvideo" style="width: 100%; height: 100%; z-index:10">...your video...</div> 
```

非常重要：html 应该存在于您的视频下。

JS-Player 有一个很棒的 JS 框架，它有一个“onfinish_video”事件。当您的视频结束时，您可以隐藏您的容器（“#myvideo”）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T23:24:37.793

在介绍动画完成后，您可以简单地离开介绍页面。

为此，请在`Frame`Flash Intro 的最后一段中添加以下代码：

如果您使用的是 AS3：

```
navigateToURL(new URLRequest("*add your page's URL here*"),"_self"); 
```

如果您使用的是 AS2：

```
getURL("*add your page's URL here*", "_blank"); 
```

您可以为您的页面定义一个完整的 http:// URL，或者如果 html/php 文件位于同一目录中，只需将文件名放在那里：

```
navigateToURL(new URLRequest("abc.html"),"_self"); 
```