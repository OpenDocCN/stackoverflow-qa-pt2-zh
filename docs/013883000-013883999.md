# StackOverflow 问答 13883000-13883999

# php - 将mysql查询数据存储为变量并通过表单在另一个页面上回显信息

> ID：13883000
> 
> 赞同：1
> 
> 时间：2012-12-14T16:55:36.953
> 
> 标签：php, html, mysql

我想回显数组“名称”的一部分，然后在它旁边有一个提交按钮，该按钮重定向到一个新页面，该页面回显数组的其余部分，例如。地址，电话号码等。但是重定向时信息会丢失。有没有办法解决这个问题。这段代码应该解释我的意思。

第 1 页：

```
<?php
   $info = mysql_query ("SELECT * FROM table WHERE name= 'something'");
   $info = mysql_fetch_assoc($info));
?>

<html>
  <form action='page2.php' method='POST'>
    <?php echo $info['name']; ?>
    <input type='submit' value='see other details'>
  </form>
</html> 
```

第2页：

```
<?php
   echo $info['address'].$info['address'].$info['address'];
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T16:57:43.407

> 重定向时信息会丢失。有没有办法解决这个问题

是的，使用 PHP 会话。将您的数组存储为`$_SESSION['info']`，它将在下一页上可用。不要忘记`session_start()`在两页上。

第 1 页：

```
<?php
   session_start();
   $info = mysql_query ("SELECT * FROM table WHERE name= 'something'");
   $info = mysql_fetch_assoc($info));
   $_SESSION['info'] = $info;
?> 
```

第2页：

```
<?php
   session_start();
   $info = $_SESSION['info'];
   echo $info['address'].$info['address'].$info['address'];
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T17:29:02.397

除非这是您尝试做的一个大大简化的版本，否则没有理由在这里使用表单。您没有将任何数据发布到表单，只是使用它来访问另一个页面，这在技术上就是链接的用途。这不是对表格的公然错误使用，但也不是全部--正确--。

只需通过指向下一页的链接来回显该值。您可以使用 jQuery 按钮之类的东西来设置 a:link 的样式，如果需要的话，甚至可以使用图像来模仿按钮。

因此，例如：

```
<?php
   $info = mysql_query ("SELECT * FROM table WHERE name= 'something'");
   $info = mysql_fetch_assoc($info));
?>

<html>
    <?php echo $info['name']; ?>
    <a href="page2.php">Submit</a>
</html> 
```

另一种选择是做两个堆叠的 div 并在单击按钮时显示/隐藏它们。它需要一点 jQuery 或 javascript，但消除了中间对服务器的影响，从而提供更流畅的用户体验。如果没有更多关于你想要做什么的细节，很难说什么是最好的。

最后，请记住，虽然会话确实有效，但可能存在问题。例如，一些公司和人员关闭会话（或完全阻止会话），因此不能 100% 依赖它们。特别是 IE（在某些版本中）解释了用户选择阻止 cookie 来阻止会话。如果他们在两个选项卡中打开您的应用程序，则可能会使值混淆并导致不良结果。至少，它可能会导致您的应用程序抛出各种吓唬用户的对话框，即使它们真的没什么大不了的。

# c++ - 在qt窗口的一小部分查看图像

> ID：13883001
> 
> 赞同：0
> 
> 时间：2012-12-14T16:55:39.403
> 
> 标签：c++, image, qt

我知道如何在[Qt jpg 图像显示](https://stackoverflow.com/questions/1357960/qt-jpg-image-display)的完整窗口中查看图像，但我需要显示 200x300px 大小的图像。这意味着我需要程序读取 jpg 图像并将其调整大小并在放置在窗口一侧的小框中查看它。我不知道我应该为此放置哪个小部件以及执行此操作的方法。有人可以指出我一些教程或给出简单的建议。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:17:58.417

加载图像后，例如：

```
QImage img;
img.loadFromData(data); 
```

使用 QImage::scaled() 创建它的缩放副本并将其分配给自身。例子：

```
img = img.scaled(200, 300, Qt::KeepAspectRatio, Qt::SmoothTransformation); 
```

根据需要调整标志（请参阅有关可用标志的 QImage::scaled() 文档。）

然后，您可以显示它。最简单的方法是将其设置为 QLabel 上的像素图：

```
QLabel label;
label.setPixmap(QPixmap::fromImage(img)); 
```

您可能希望为 QLabel 设置固定大小，但这取决于您如何处理应用程序中的整体布局。

# mysql - mySQL 查询 - 在指定省份后从记录中删除所有内容

> ID：13883003
> 
> 赞同：1
> 
> 时间：2012-12-14T16:55:52.777
> 
> 标签：mysql

再次提前感谢这个。

我有一个表，其中包含一个地址记录，我试图将其分解为各个部分。不幸的是，我收到的数据在各个条目中输入的不一致，但我相信有一个一致的元素可以用来清理。

我基本上想在列出省（AB，SK）之后（包括）之后从 MailingAddress 列中删除所有人：

表：联系信息

邮寄地址：1234 Something Street, AB A1B 2C4

会成为

邮寄地址：东西街 1234 号，

我不想删除“，”，因为它用于很多街道地址信息。我可能必须运行两次查询，因为我还想删除该省以“SK”开头的条目。

你们非常乐于助人，我非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:11:29.927

如果你能分开`,`那可能是最好的。你可以这样做：

```
UPDATE contactinfo
SET MailingAddress = CONCAT(SUBSTRING_INDEX(MailingAddress, ',', 1), ',') 
```

请注意，我添加了尾随逗号，但我不清楚您为什么需要它。如果你真的不需要它，只需删除包装`CONCAT`功能。

如果您需要根据省代码删除，您可以这样做

```
UPDATE contactinfo
SET MailingAddress = TRIM(SUBSTRING_INDEX(MailingAddress, 'AB', 1));
UPDATE contactinfo
SET MailingAddress = TRIM(SUBSTRING_INDEX(MailingAddress, 'SK', 1)); 
```

请注意，您必须在 MailingAddress 字段上设置区分大小写的排序规则，这样才能使上述操作生效，否则查询将无法区分`AB`、`ab`、`Ab`和`aB`. 显然那里可能有许多地址，`ab`因此这确实会导致更新数据时出现问题。

当然，在您做任何事情之前，请备份您的表格。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-14T17:05:01.413

删除 MailingAddress 列中包含省名 SK 或 AB 的记录：

```
delete from contactinfo where MailingAddress like '%, SK%' 
or MailingAddress like '%, AB%' 
```

# powershell - Powershell if -notlike 问题

> ID：13883010
> 
> 赞同：1
> 
> 时间：2012-12-14T16:56:12.670
> 
> 标签：powershell, powershell-2.0, powershell-1.0

我正在尝试检查计算机列表并查看它们是否缺少哪些补丁，这由于某种原因给我带来了麻烦。我敢肯定我忽略了一些简单的事情，但非常感谢您的帮助，谢谢。

```
$Computers = "TrinityTechCorp"
$HotFixes = Get-Content HotFixes.csv

ForEach ($Computer in $Computers) {
    $Comparison = get-hotfix -ComputerName $Computer | Select HotFixID
    ForEach ($HotFix in $HotFixes) {
        IF ($Comparison -NotLike "*$HotFix*") {
            Write-Host "$Computer missing $HotFix"
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T17:20:51.907

从

```
$Comparison = get-hotfix -ComputerName $Computer | Select HotFixID 
```

`$Comparison`将是具有`HotFixId`属性的对象的集合。

如果您希望它们作为字符串的集合，您必须执行以下操作：

```
$Comparison = get-hotfix -ComputerName $Computer | Select -expand HotFixID 
```

# magento - 在 getProductCollection 中添加自定义 sql，或插入地理位置公式

> ID：13883014
> 
> 赞同：4
> 
> 时间：2012-12-14T16:56:22.183
> 
> 标签：magento, geolocation

我尝试在以下文章的帮助下按地理位置数据对 magento 中的产品列表进行排序：[https](https://developers.google.com/maps/articles/phpsqlsearch_v3?hl=hu-HU) ://developers.google.com/maps/articles/phpsqlsearch_v3?hl=hu-HU 。

我在我的模块中覆盖了 Mage_Catalog_Block_Product_List 以便我可以访问这行代码：

```
$this->_productCollection = $layer->getProductCollection(); 
```

拥有 _productCollection 对象后，我想将公式添加为“虚拟”属性“距离”，以便可以使用它对查询进行排序。这是我的想法：

```
$this->_productCollection = $layer-&gt;getProductCollection()
->addAttributeToSelect('distance','I insert my custom formula here')
->addAttributeToSort('distance','DESC'); 
```

我知道 API 不是用来处理这种语法的，但我认为它可以帮助人们理解这个想法。

这是我要添加的公式：

> SELECT ( 3959 * acos( cos( 弧度(37) ) * cos( 弧度( lat ) ) * cos( 弧度( lng ) - 弧度(-122) ) + sin( 弧度(37) ) * sin( 弧度( lat ) ) ) ) 作为距离

知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T22:40:19.340

如果`lat`和`lng`是您产品的属性，您可以使用 addExpressionAttributeToSelect()：

```
$this->_productCollection
->addExpressionAttributeToSelect('distance', '(select ... {{lat}} ... {{lng}} ... )', array('lat'=>'lat', 'lng'=>'lng')); 
```

在自定义选择查询中，`lat`需要`lng`用双括号括起来（如图）。确保您的选择语句在括号内。

# git - 使用 git 维护多子模块项目

> ID：13883015
> 
> 赞同：2
> 
> 时间：2012-12-14T16:56:24.067
> 
> 标签：git, github, fuelphp

我正在使用 FuelPHP 框架与另外两个团队成员一起开发一个网站。我想使用 git 来维护项目，但是我在处理配置时遇到了一些麻烦。当我使用`oil`安装 FuelPHP 时，它会安装主框架以及来自 github 的几个子模块。文档根目录中的`.git/config`文件如下所示：

```
[core]
        repositoryformatversion = 0
        filemode = true
        bare = false
        logallrefupdates = true
        ignorecase = true
[remote "origin"]
        fetch = +refs/heads/*:refs/remotes/origin/*
        url = git://github.com/fuel/fuel.git
[branch "1.4/master"]
        remote = origin
        merge = refs/heads/1.4/master
[submodule "docs"]
        url = git://github.com/fuel/docs.git
[submodule "fuel/core"]
        url = git://github.com/fuel/core.git
[submodule "fuel/packages/auth"]
        url = git://github.com/fuel/auth.git
[submodule "fuel/packages/email"]
        url = git://github.com/fuel/email.git
[submodule "fuel/packages/oil"]
        url = git://github.com/fuel/oil.git
[submodule "fuel/packages/orm"]
        url = git://github.com/fuel/orm.git
[submodule "fuel/packages/parser"]
        url = git://github.com/fuel/parser.git 
```

我在远程服务器上有一个裸存储库设置，我想在其中维护这个项目。我希望能够从 github 为 FuelPHP 及其子模块提取更新，同时还能够将任何更改推送到裸存储库，以便我的团队成员和生产服务器可以从中提取。到目前为止，我遇到了一堵砖墙。

这是我到目前为止所做的：

在服务器上：

```
$ mkdir websitename.git
$ cd websitename.git
$ git init --bare 
```

在我的本地机器上：

```
$ curl get.fuelphp.com/oil | sh
$ oil create websitename
$ cd websitename/
$ git remote add reponame ssh://git@example.com:2222/httpd/www/websitename.git
$ git push reponame 1.4/master 
```

我得到这个回应：

```
Counting objects: 14422, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (4375/4375), done.
Writing objects: 100% (14422/14422), 2.20 MiB | 3.82 MiB/s, done.
Total 14422 (delta 9816), reused 14410 (delta 9810)
To ssh://haroldbr@haroldinc.com:2222/home/haroldbr/public_html/crude.git
 * [new branch]      1.4/master -> 1.4/master 
```

然后，再次在服务器上：

```
$ git clone -l --no-hardlinks /httpd/www/websitename.git /httpd/www/websitename 
```

这给了我这个错误：

```
Cloning into 'websitename'...
done.
warning: remote HEAD refers to nonexistent ref, unable to checkout. 
```

显然我有一个配置问题，但我不知道它是什么。我希望能够使用`git`. 我设想它的工作方式如下：

在我的本地机器上：

```
$ git pull origin 1.4/master
$ git push reponame --all 
```

在服务器上：

```
$ cd websitename/
$ git pull 
```

在一个完美的世界中，这将从 github 拉取 FuelPHP 的所有更新及其包，并推送所有这些更新，以及对裸存储库中`app/`或`public/`裸存储库中文件的任何更改。我想要做的甚至可能吗？我是否需要在其中设置存储库`app/`并`public/`单独维护它们？我无法从裸仓库克隆的配置有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T20:09:42.830

这里有一个关于如何使用 git 维护 FuelPHP 网站项目的截屏视频：http://blip.tv/fuelphp/creating-a-fuelphp-application-repository-5688973 [，](http://blip.tv/fuelphp/creating-a-fuelphp-application-repository-5688973)但它不包括推送到裸存储库.

假设您已经在 ssh://example.com/path/to/project.git 设置了一个新的裸存储库，您可以按照以下步骤设置您的项目。从您的本地机器：

```
git clone -b 1.4/master --recursive git://github.com/fuel/fuel.git /path/to/project
cd /path/to/project
rm -R .git
rm .gitmodules
rm -R docs
git init
git submodule add git://github.com/fuel/core.git fuel/core
git submodule add git://github.com/fuel/auth.git fuel/packages/auth
git submodule add git://github.com/fuel/email.git fuel/packages/email
git submodule add git://github.com/fuel/oil.git fuel/packages/oil
git submodule add git://github.com/fuel/orm.git fuel/packages/orm
git submodule add git://github.com/fuel/parser.git fuel/packages/parser
git add .
git commit -m "Initial commit"
git remote add origin master ssh://example.com/path/to/project.git
git push origin master 
```

然后，您可以转到生产服务器并从远程存储库中递归克隆以获取整个项目：

```
git clone --recursive ssh://example.com/path/to/project.git /path/to/production 
```

然后，您将能够跟踪项目的更改，同时保持以下能力：

```
git submodule update --recursive 
```

这将使您了解最新的 FuelPHP 软件包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T20:28:06.347

您已成功克隆，但您只需要检查您想要的分支。由于您没有在裸仓库中定义 head，因此它会向您发出警告。

此外，`git clone --recursive`应该完成一次，这也将获得您的子模块。从那时起，您可以执行 a`git pull`后跟 a`git submodule update`

# c# - 如何验证复合控件

> ID：13883017
> 
> 赞同：3
> 
> 时间：2012-12-14T16:56:24.817
> 
> 标签：c#, asp.net, user-controls, servercontrols

好吧，这有点复杂。

我有一个包含文本框、必填字段验证器和一个按钮的复合控件。它公开了一个名为 ValidationGroup 的属性。

它将 ValidationGroup 属性应用于 textbox 、必填字段验证器和按钮。

一切正常。

当我取出按钮并将其放在具有相同验证组的表单中时，问题就开始了。

理想情况下它应该工作。但事实并非如此。有人说复合控件有自己的命名容器，所以这是行不通的。

如果这是真的，我不明白为什么？我的意思是他们有相同的验证组！

无论如何，有谁知道如何解决这个问题？

这是我的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Security.Permissions;
using System.Text;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using FCC.Web.UI.CustomControl;
using System.Xml;

namespace FCC.Web.UI.CustomControl
{
    [AspNetHostingPermission(SecurityAction.Demand, Level = AspNetHostingPermissionLevel.Minimal)]
    [AspNetHostingPermission(SecurityAction.InheritanceDemand, Level = AspNetHostingPermissionLevel.Minimal)]
    [DefaultProperty("Value")]
    [ValidationProperty("Value")]
    [ToolboxData("<{0}:ValidationTextBox runat=server></{0}:ValidationTextBox>")]
    public class ValidationTextBox : CompositeControl, IDynamicControl
    {

        #region-- privatess --
        private TextBox textBox1;
        private RequiredFieldValidator requiredFieldValidator1;
        private RegularExpressionValidator regularExpressionValidator1, maxlengthValidator,integerValidator,decimalValidator;
        private string validationClasses, validationGroup, validationExpression, xmlElementName;
        private bool isRequired;
        private int maxlength;
        #endregion

        #region-- properties -- The following properties are deleted to child controls

        #region-- textbox --

        [Bindable(true)]
        [Category("Appearance")]
        [DefaultValue("")]
        [Localizable(true)]
        [Description("Text displayed on the textbox")]
        public string Value
        {
            get
            {
                EnsureChildControls();
                return textBox1.Text;
            }
            set
            {
                EnsureChildControls();
                textBox1.Text = value;
            }
        }

        [Bindable(true)]
        [Category("Styles")]
        [Themeable(true)]
        [DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Content)]
        [PersistenceMode(PersistenceMode.InnerProperty)]
        [Localizable(true)]
        public Style TextBoxStyle
        {
            get
            {
                EnsureChildControls();
                return textBox1.ControlStyle;
            }
            set
            {
                EnsureChildControls();
                //textBox1.Attributes["style"] = value;
                textBox1.ControlStyle.MergeWith(value);
            }
        }

        [Bindable(true)]
        [Category("Styles")]
        [Localizable(true)]
        public string TextBoxCssClass
        {
            get
            {
                EnsureChildControls();
                return textBox1.CssClass;
            }
            set
            {
                EnsureChildControls();
                textBox1.CssClass = value;
            }
        }

        [Bindable(true)]
        [Category("Appearance")]
        [DefaultValue("")]
        [Localizable(true)]
        public TextBoxMode TextMode
        {
            get
            {
                EnsureChildControls();
                return textBox1.TextMode;
            }
            set
            {
                EnsureChildControls();
                textBox1.TextMode = value;
            }
        }

        [Bindable(true)]
        [Category("Default")]
        [DefaultValue("")]
        [Localizable(true)]
        public int MaxLength
        {
            get
            {
                EnsureChildControls();
                return maxlength;
            }
            set
            {
                EnsureChildControls();

                if (value > 0)
                {
                    maxlength = value;

                    textBox1.MaxLength = value;

                    maxlengthValidator.Enabled = true;

                    //maxlengthValidator.ValidationExpression = "^[a-zA-Z.]{0," + value + "}$";
                    maxlengthValidator.ValidationExpression = @"^[\s\S]{0," + value + "}$";
                    maxlengthValidator.ErrorMessage = "Maximum allowed charaters: " + value;
                }
            }
        }

        [Bindable(true)]
        [Category("Default")]
        [DefaultValue("")]
        [Localizable(true)]
        public bool IsInteger
        {
            get
            {
                EnsureChildControls();
                return integerValidator.Enabled;
            }
            set
            {
                EnsureChildControls();

                if (value == true) // Is Integer
                {
                    integerValidator.Enabled = true;
                    regularExpressionValidator1.Enabled = false;
                    maxlengthValidator.Enabled = false;
                    decimalValidator.Enabled = false;
                }
                else
                {
                    integerValidator.Enabled = false;
                }
            }
        }

        [Bindable(true)]
        [Category("Default")]
        [DefaultValue("")]
        [Localizable(true)]
        [Description("Error message that appears when textbox contain invalid integer")]
        public string InvalidIntegerErrorMessage
        {
            get
            {
                EnsureChildControls();
                return integerValidator.ErrorMessage.IsNullOrEmpty() ? "Invalid Number" : integerValidator.ErrorMessage;
            }
            set
            {
                EnsureChildControls();
                integerValidator.ErrorMessage = value;
            }
        }

        [Bindable(true)]
        [Category("Default")]
        [DefaultValue("")]
        [Localizable(true)]
        public bool IsDecimal
        {
            get
            {
                EnsureChildControls();
                return decimalValidator.Enabled;
            }
            set
            {
                EnsureChildControls();
                if (value == true)
                {
                    decimalValidator.Enabled = true;
                    integerValidator.Enabled = false;
                    regularExpressionValidator1.Enabled = false;
                    maxlengthValidator.Enabled = false;
                }
                else
                {
                    decimalValidator.Enabled = false;
                }
            }
        }

        [Bindable(true)]
        [Category("Default")]
        [DefaultValue("")]
        [Localizable(true)]
        [Description("Error message that appears when textbox contain invalid decimal number")]
        public string InvalidDecimalErrorMessage
        {
            get
            {
                EnsureChildControls();
                return decimalValidator.ErrorMessage.IsNullOrEmpty() ? "Invalid Number" : decimalValidator.ErrorMessage;
            }
            set
            {
                EnsureChildControls();
                decimalValidator.ErrorMessage = value;
            }
        }

        [Bindable(true)]
        [Category("Default")]
        [DefaultValue("")]
        [Localizable(true)]
        [Description("Name of XmlElement")]
        public string XmlElementName
        {
            get
            {
                EnsureChildControls();
                return xmlElementName;
            }
            set
            {
                EnsureChildControls();
                xmlElementName = value;
            }
        }

        [Bindable(true)]
        [Category("Default")]
        [DefaultValue("")]
        [Localizable(true)]
        public string XmlElements
        {
            get
            {
                EnsureChildControls();
                return string.Format("<{0}>{1}</{0}>",XmlElementName,textBox1.Text);
            }
        }

        #endregion

        #region--required validation --

        [Bindable(true)]
        [Category("Appearance")]
        [DefaultValue("")]
        [Localizable(true)]
        [Description("Error message that appears when text box is empty")]
        public String RequiredErrorMessage
        {
            get
            {
                EnsureChildControls();
                return requiredFieldValidator1.ErrorMessage.IsNullOrEmpty() ? "Required Field" : requiredFieldValidator1.ErrorMessage;
            }
            set
            {
                EnsureChildControls();
                requiredFieldValidator1.ErrorMessage = value;
            }
        }

        [Bindable(true)]
        [Category("Default")]
        [Localizable(true)]
        [Description("bool, representing text in the textbox is required field or not")]
        public bool IsRequired
        {
            get
            {
                EnsureChildControls();
                return isRequired;
            }
            set
            {
                EnsureChildControls();
                isRequired = value;
                requiredFieldValidator1.Enabled = value;
            }
        }

        #endregion

        #region-- regular expression validation --

        [Bindable(true)]
        [Category("Appearance")]
        [DefaultValue("")]
        [Localizable(true)]
        [Description("Error message that appears when textbox contain invalid format string")]
        public String RegularExpressionErrorMessage
        {
            get
            {
                EnsureChildControls();
                return regularExpressionValidator1.ErrorMessage.IsNullOrEmpty() ? "Invalid Text" : regularExpressionValidator1.ErrorMessage;
            }
            set
            {
                EnsureChildControls();
                regularExpressionValidator1.ErrorMessage = value;
            }
        }

        [Bindable(true)]
        [Category("Default")]
        [DefaultValue("")]
        [Localizable(true)]
        [Description("Regular expression. Leave blank if you dont want to implement.")]
        public string RegularExpression
        {
            get
            {
                EnsureChildControls();
                return validationExpression;
            }
            set
            {
                EnsureChildControls();

                validationExpression = value;
                regularExpressionValidator1.ValidationExpression = value;
                regularExpressionValidator1.Enabled = true;

                integerValidator.Enabled = false;
                decimalValidator.Enabled = false;
            }
        }

        #endregion

        #region--common--
        [Bindable(true)]
        [Category("Default")]
        [DefaultValue("")]
        [Localizable(true)]
        [Description("cssClasses that apply to all validators")]
        public string ValidationErrorCssClass
        {
            get
            {
                EnsureChildControls();
                return validationClasses;
            }
            set
            {
                EnsureChildControls();
                validationClasses = value;

                requiredFieldValidator1.CssClass = value;
                regularExpressionValidator1.CssClass = value;
                maxlengthValidator.CssClass = value;
            }
        }

        [Bindable(true)]
        [Category("Default")]
        [DefaultValue("")]
        [Localizable(true)]
        [Description("Validation group for the textbox and inbuilt validations")]
        public string ValidationGroup
        {
            get
            {
                EnsureChildControls();
                return validationGroup;

            }
            set
            {
                EnsureChildControls();
                validationGroup = value;

                requiredFieldValidator1.ValidationGroup = value;
                regularExpressionValidator1.ValidationGroup = value;
                maxlengthValidator.ValidationGroup = value;
                textBox1.ValidationGroup = value;
            }
        }
        #endregion

        #endregion

        #region -- blank properties--
        public string EmptyText { get; set; }
        public string CommaSeparatedData { set; get; }
        public bool ShowDefaultItem { get; set; }
        public string DropDownCssClass { get; set; }
        #endregion

        protected override void RecreateChildControls()
        {
            EnsureChildControls();
        }

        protected override void CreateChildControls()
        {
            Controls.Clear();

            #region--textbox--
            textBox1 = new TextBox();
            textBox1.ID = "textbox1";
            //textBox1.CssClass = TextBoxClass;
            textBox1.Style[HtmlTextWriterStyle.VerticalAlign] = "middle";

            //if (!validationGroup.IsNullOrEmpty())
            //{
            //    textBox1.ValidationGroup = validationGroup;
            //}
            #endregion

            #region--required field validator--
            requiredFieldValidator1 = new RequiredFieldValidator();
            requiredFieldValidator1.ID = "validator1";
            requiredFieldValidator1.ErrorMessage = RequiredErrorMessage;
            requiredFieldValidator1.CssClass = validationClasses;
            requiredFieldValidator1.Display = ValidatorDisplay.Dynamic;
            requiredFieldValidator1.ControlToValidate = textBox1.ID;
            requiredFieldValidator1.Enabled = false;
            requiredFieldValidator1.SetFocusOnError = true;
            //if (isRequired)
            //{
            //    requiredFieldValidator1.Enabled = true;
            //}

            //if (!validationGroup.IsNullOrEmpty())
            //{
            //    requiredFieldValidator1.ValidationGroup = validationGroup;
            //}

            #endregion

            #region-- regular expression validator--
            regularExpressionValidator1 = new RegularExpressionValidator();
            regularExpressionValidator1.ID = "validator2";
            regularExpressionValidator1.Enabled = false;
            regularExpressionValidator1.ErrorMessage = RegularExpressionErrorMessage;
            regularExpressionValidator1.CssClass = validationClasses;
            regularExpressionValidator1.Display = ValidatorDisplay.Dynamic;
            regularExpressionValidator1.ControlToValidate = textBox1.ID;
            regularExpressionValidator1.SetFocusOnError = true;
            //if (!validationGroup.IsNullOrEmpty())
            //{
            //    regularExpressionValidator1.ValidationGroup = validationGroup;
            //}
            #endregion

            #region -- maxlength validation --
            maxlengthValidator = new RegularExpressionValidator();
            maxlengthValidator.ControlToValidate = textBox1.ID;
            maxlengthValidator.ID = "validator3";
            maxlengthValidator.Enabled = false;
            maxlengthValidator.CssClass = validationClasses;
            maxlengthValidator.Display = ValidatorDisplay.Dynamic;
            maxlengthValidator.SetFocusOnError = true;

            //if (!validationGroup.IsNullOrEmpty())
            //{
            //    maxlengthValidator.ValidationGroup = validationGroup;
            //}

            #endregion

            #region--integer Validation--
            integerValidator = new RegularExpressionValidator();
            integerValidator.ID = "integervalidator";
            integerValidator.Enabled = false;
            integerValidator.ErrorMessage = InvalidIntegerErrorMessage;
            integerValidator.CssClass = validationClasses;
            integerValidator.Display = ValidatorDisplay.Dynamic;
            integerValidator.ControlToValidate = textBox1.ID;
            integerValidator.SetFocusOnError = true;
            integerValidator.ValidationExpression=@"^\d+$";
            #endregion

            #region -- decimal validation--
            decimalValidator = new RegularExpressionValidator();
            decimalValidator.ID = "decimalvalidator";
            decimalValidator.Enabled = false;
            decimalValidator.ErrorMessage = InvalidDecimalErrorMessage;
            decimalValidator.CssClass = validationClasses;
            decimalValidator.Display = ValidatorDisplay.Dynamic;
            decimalValidator.ControlToValidate = textBox1.ID;
            decimalValidator.SetFocusOnError = true;
            decimalValidator.ValidationExpression = @"(^\d*\.?\d*[1-9]+\d*$)|(^[1-9]+\d*\.\d*$)";

            #endregion

            this.Controls.Add(textBox1);
            this.Controls.Add(requiredFieldValidator1);
            this.Controls.Add(regularExpressionValidator1);
            this.Controls.Add(maxlengthValidator);
            this.Controls.Add(integerValidator);
            this.Controls.Add(decimalValidator);
        }

        protected override void OnLoad(EventArgs e)
        {
            EnsureChildControls();
            base.OnLoad(e);
        }

        protected override void Render(HtmlTextWriter writer)
        {
            AddAttributesToRender(writer);

            textBox1.RenderControl(writer);
            requiredFieldValidator1.RenderControl(writer);
            regularExpressionValidator1.RenderControl(writer);
            maxlengthValidator.RenderControl(writer);
            integerValidator.RenderControl(writer);
            decimalValidator.RenderControl(writer);

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:09:14.927

我不知道为什么会发生这种情况的答案，但是您可以通过向控件添加一个公共方法来解决问题，该方法将其验证作为布尔值返回，然后在页面中添加 a`CustomValidator`并放置如下内容：

```
args.IsValid = yourControl.publicMethod() 
```

在其中，我现在无法对其进行测试，但我敢打赌它应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T18:43:08.020

我无法重现该问题。复合控件*确实*实现`INamingContainer`了，但这不会影响验证组。您能否提供一个小代码示例来帮助我们进行故障排除？

这是对我有用的代码：

**复合控制**

```
public class RequiredTextBox : CompositeControl
{
    private TextBox _textBox = new TextBox { ID = "T" };
    private RequiredFieldValidator _validator =
        new RequiredFieldValidator { ID = "V", ControlToValidate = "T", ErrorMessage = "*" };

    public string Text
    {
        get { return _textBox.Text; }
        set { _textBox.Text = value; }
    }

    public string ValidationGroup
    {
        get { return _validator.ValidationGroup; }
        set { _validator.ValidationGroup = value; }
    }

    protected override void CreateChildControls()
    {
        this.Controls.Add(_textBox);
        this.Controls.Add(_validator);
    }
} 
```

**ASPX**

```
<form id="form1" runat="server">
    <asp:ValidationSummary runat="server" ID="ValidationSummary" /> 
    <ctl:RequiredTextBox runat="server" ID="TextBox" ValidationGroup="VG" />
    <asp:Button runat="server" ID="SubmitButton" Text="Submit" ValidationGroup="VG" />
</form> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T02:33:34.400

尝试这个：

```
[ValidationProperty("Text")]
[DefaultProperty("Text")]
[ToolboxData("<{0}:Class1 runat=server></{0}:Class1>")]
public class Class1: CompositeControl
{
    private TextBox txtbox = new TextBox();
    private RequiredFieldValidator rfv = new RequiredFieldValidator();

    public string Text
    {
        //this will trigger validator inside
        get
        {
            this.rfv.Validate();
            return this.txtbox.Text; //you may need too loop each textbox to check if it's empty and return empty string, if so.
        }
    } 
```

现在按钮触发复合控件内的验证器。我试过这个并成功了。

# sql - Oracle PLSQL 按状态或范围进行分组检查

> ID：13883022
> 
> 赞同：2
> 
> 时间：2012-12-14T16:57:05.413
> 
> 标签：sql, plsql, group-by, grouping

这是我在这里的第一篇文章。我正在处理支票，我在 Oracle 11g 数据库中有这个

```
 WITH cheques AS (
    SELECT 1 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 2 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 3 ch_no,'T' ch_status FROM dual UNION ALL
    SELECT 4 ch_no,'T' ch_status FROM dual UNION ALL
    SELECT 5 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 6 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 7 ch_no,'C' ch_status FROM dual UNION ALL
    SELECT 8 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 9 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 10 ch_no,'C' ch_status FROM dual UNION ALL
    SELECT 11 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 12 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 13 ch_no,'X' ch_status FROM dual UNION ALL
    SELECT 14 ch_no,'X' ch_status FROM dual UNION ALL
    SELECT 15 ch_no,'T' ch_status FROM dual UNION ALL
    SELECT 16 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 17 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 18 ch_no,'I' ch_status FROM dual UNION ALL
    SELECT 19 ch_no,'I' ch_status FROM dual UNION ALL
    SELECT 20 ch_no,'U' ch_status FROM dual
 ) 
```

我希望以这种方式获得它们：

```
Status  Min Max
U   1   2
U   5   6
U   8   9
U   11  12
U   16  17
U   20  20
C   7   7
C   10  10
T   3   4
T   15  15
X   13  14
I   18  19 
```

因此，在 Reporting Services 2008 中，我将能够像这样显示它们：

```
U       C       T       X       I   
Min Max Min Max Min Max Min Max Min Max
1   2   7   7   3   4   13  14  18  19
5   6   10  10  15  15              
8   9                               
11  12                              
16  17                              
20  20 
```

这里的问题是如何获得这个，如何根据他们的状态获得每张支票的最小值和最大值？我已经搜索过，但我找不到任何东西。

对不起我的英语不好。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:08:42.853

这不是一个简单的问题，需要许多步骤。

1.  用于`lag`在每个连续块的开头设置一个“标志`ch_no`”`ch_status`
2.  用作`sum`分析`order by`（将默认窗口更改为`unbounded preceeding`）为每个连续块提供唯一标识符
3.  最后使用正则`group by`计算每个块的`min`&`max`

**查询**：

```
WITH cheques AS (
    SELECT 1 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 2 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 3 ch_no,'T' ch_status FROM dual UNION ALL
    SELECT 4 ch_no,'T' ch_status FROM dual UNION ALL
    SELECT 5 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 6 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 7 ch_no,'C' ch_status FROM dual UNION ALL
    SELECT 8 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 9 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 10 ch_no,'C' ch_status FROM dual UNION ALL
    SELECT 11 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 12 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 13 ch_no,'X' ch_status FROM dual UNION ALL
    SELECT 14 ch_no,'X' ch_status FROM dual UNION ALL
    SELECT 15 ch_no,'T' ch_status FROM dual UNION ALL
    SELECT 16 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 17 ch_no,'U' ch_status FROM dual UNION ALL
    SELECT 18 ch_no,'I' ch_status FROM dual UNION ALL
    SELECT 19 ch_no,'I' ch_status FROM dual UNION ALL
    SELECT 20 ch_no,'U' ch_status FROM dual
 )
select ch_status, min(ch_no), max(ch_no)
from( select ch_no, ch_status, sum(changed_flag) over (order by ch_no) as grp
      from( select ch_no, ch_status, 
                   decode(ch_status,lag(ch_status) over(order by ch_no),0,1) 
                     as changed_flag
            from cheques ) )
group by ch_status, grp
order by ch_status, min(ch_no) 
```

**结果**：

```
| CH_STATUS | MIN(CH_NO) | MAX(CH_NO) |
---------------------------------------
|         C |          7 |          7 |
|         C |         10 |         10 |
|         I |         18 |         19 |
|         T |          3 |          4 |
|         T |         15 |         15 |
|         U |          1 |          2 |
|         U |          5 |          6 |
|         U |          8 |          9 |
|         U |         11 |         12 |
|         U |         16 |         17 |
|         U |         20 |         20 |
|         X |         13 |         14 | 
```

*SQL小提琴[在这里](http://sqlfiddle.com/#!4/d41d8/5248)*

# hadoop - HBase 批量加载异常

> ID：13883023
> 
> 赞同：1
> 
> 时间：2012-12-14T16:57:09.337
> 
> 标签：hadoop, hbase, illegalstateexception

我可以使用 Java 程序生成 HFile，但是每当我尝试将它们导入到我的 HBase 表中时，我都会收到附加错误。当我使用完整批量加载而不是使用我的 Java 程序时，我得到了同样的错误。

如果有人可以在这里帮助我，那将是一个很大的帮助。我已经坚持了几天了，它开始变得非常令人沮丧。

亲切的问候，彼得扬

**例外：**

```
12/12/14 17:46:23 WARN mapreduce.LoadIncrementalHFiles: Skipping non-directory hdfs://localhost:9000/hadoopdir/user/data/output/hfiles/test/_SUCCESS
12/12/14 17:46:23 INFO hfile.CacheConfig: Allocating LruBlockCache with maximum size 241.7m
12/12/14 17:46:23 INFO util.ChecksumType: Checksum using org.apache.hadoop.util.PureJavaCrc32
12/12/14 17:46:23 INFO util.ChecksumType: org.apache.hadoop.util.PureJavaCrc32C not available. 
12/12/14 17:46:23 ERROR mapreduce.LoadIncrementalHFiles: Unexpected execution exception during splitting
java.util.concurrent.ExecutionException: java.lang.IllegalStateException: The value of the hbase.metrics.showTableName conf option has not been specified in SchemaMetrics
at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:252)
at java.util.concurrent.FutureTask.get(FutureTask.java:111)
at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles.groupOrSplitPhase(LoadIncrementalHFiles.java:333)
at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles.doBulkLoad(LoadIncrementalHFiles.java:232)
at POC.HBaseTest.TestHBaseRun.run(TestHBaseRun.java:67)
at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)
at Main.Main.main(Main.java:27)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.apache.hadoop.util.RunJar.main(RunJar.java:156)
Caused by: java.lang.IllegalStateException: The value of the hbase.metrics.showTableName conf option has not been specified in SchemaMetrics
at org.apache.hadoop.hbase.regionserver.metrics.SchemaMetrics.getEffectiveTableName(SchemaMetrics.java:607)
at org.apache.hadoop.hbase.regionserver.metrics.SchemaMetrics.getInstance(SchemaMetrics.java:333)
at org.apache.hadoop.hbase.regionserver.metrics.SchemaConfigured.getSchemaMetrics(SchemaConfigured.java:185)
at org.apache.hadoop.hbase.io.hfile.HFileReaderV2.close(HFileReaderV2.java:441)
at org.apache.hadoop.hbase.io.hfile.HFileReaderV2.close(HFileReaderV2.java:419)
at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles.groupOrSplit(LoadIncrementalHFiles.java:410)
at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles$2.call(LoadIncrementalHFiles.java:323)
at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles$2.call(LoadIncrementalHFiles.java:321)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
at java.util.concurrent.FutureTask.run(FutureTask.java:166)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
at java.lang.Thread.run(Thread.java:722)
Error: java.lang.IllegalStateException: The value of the hbase.metrics.showTableName conf option has not been specified in SchemaMetrics 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-17T10:59:41.620

终于找到了解决办法。

我确保 under `$HBASE_HOME/conf`- 文件夹位于我的 Java 应用程序的类路径中，并且在我添加的代码`SchemaMetrics.configureGlobally(conf)`中设置了在度量名称中使用表名的标志。

我希望这可以帮助以后的人。

编辑：我发现后一件事是我必须使用 HBase 0.94.3 做的事情。

# jquery - 如何在 CSS3 和 JQuery（IE 兼容）中做一些代码？

> ID：13883025
> 
> 赞同：1
> 
> 时间：2012-12-14T16:57:10.983
> 
> 标签：jquery, html, css

现在，我要解决这个问题——用 html 和 css3 编码决定创建一些东西，当你将鼠标悬停在图片上时，它会放大，然后转动并消失，并且那里有一些信息。

不幸的是，我注意到 Internet Explorer 版本 5 到 8 提到“css3”当然拒绝服从。走捷径，所以我决定使用 JQuery，特别是使用 hoverpulse (malsup.com/jquery/hoverpulse/)

在谷歌浏览器中，CSS3、JQuery 和 Internet Explorer 可以正常工作——不是（不知何故我也很惊讶）——我每个人都得到了十几个不同的图像，但它们都在增长。

我很抱歉 pastebin，但我不能粘贴所有代码，因为它使用了太多的 html 标签或其他东西。

这是我制作的所有代码（HTML）：http: [//pastebin.com/Tak7YKpY](http://pastebin.com/Tak7YKpY) 和 CSS3（pastebin 也是）： http: [//pastebin.com/3xprvmeY](http://pastebin.com/3xprvmeY)

问题是 - 如何修复它并让它转身消失，因为我看到这可能有问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:11:53.970

如果您只想更改大小，我会使用 jquery 来更改悬停时的 css 属性。

```
$("#img_id_here").mouseover(function()
{
    $(this).css('width', '200px');
}); 
```

如果您想使用完全不同的图像，出于响应或其他目的，我会使用纯 css。

```
<style type="text/css">
.img:hover /* you should apply img class to your image. */
   {
      /* whatever you want to do  */
   }
</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T17:06:12.970

根据 CSS 问题，尝试创建应使用 CSS2 的其他 CSS 文件。jQuery 在 ie7、8 和 9 中应该可以正常工作

# web-services - 配置 ASP.NET Web API 为空值发送空标签

> ID：13883031
> 
> 赞同：2
> 
> 时间：2012-12-14T16:57:49.487
> 
> 标签：web-services, asp.net-web-api, xmlserializer

我是 ASP.NET Web API 的新手。

我已将我的应用程序配置为使用 XMLSerializer 作为

```
GlobalConfiguration.Configuration.Formatters.XmlFormatter.UseXmlSerializer
                                                                    = true; 
```

为了简单起见，说我的控制器返回类 Account 的一个实例

```
public class Account
{
  public int AccountId {get;set;}

  public string AccountName {get;set;} 

  public string AccountNickName {get;set;}
} 
```

*当AccountNickName*（可选）具有值时，我得到这个作为 XML 响应

```
<Account>
 <AccountId>1</AccountId>
 <AccountName>ABAB</AccountName>
 <AccountNickName>My Account</AccountNickName>
</Account> 
```

当*AccountNickName*（可选）为`null`

```
<Account>
 <AccountId>1</AccountId>
 <AccountName>ABAB</AccountName>
</Account> 
```

**如果值为 null，则 XML 输出会跳过*AccountNickName标记。***

我的问题是：

1.  如何配置序列化程序以发送封闭标签而不是跳过属性

2.  并且有没有办法在应用程序级别而不是在类级别上配置它

**更新：**

我知道您可以使用 JsonSerializerSetting 来配置 JsonFormatter ，您也可以使用[XMLSerializer](http://code.msdn.microsoft.com/Using-JSONNET-with-ASPNET-b2423706)来做到这一点吗？

我不想在类上添加属性/装饰器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:56:16.813

在这里做了一个快速测试，我发现如果你不这样做：

```
GlobalConfiguration.Configuration.Formatters.XmlFormatter.UseXmlSerializer                                                                   = true; 
```

默认情况下，null 值将被序列化为实际元素。

您明确想要配置它还有另一个原因吗？将该值设置为“true”将导致 Web API 使用“XmlSerializer”而不是默认的“DataContractSerialier”类。

如果请求包含适当的“Content-Type”标头，表明需要 XML 响应，Web API 将为给定请求返回 XML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:26:41.617

如果你把它放在你的属性上，即使它为 null，XmlSerializer 也会写出该属性： `[XmlElement(IsNullable = true)]`。

```
public class Account
{
    public int AccountId { get; set; }
    public string AccountName { get; set; }

    [XmlElement(IsNullable = true)]
    public string AccountNickName { get; set; }
} 
```

xml:

```
<Account xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <AccountId>123</AccountId>
    <AccountName>John Doe</AccountName>
    <AccountNickName xsi:nil="true"/>
</Account> 
```

# linux - Linux 安装重新打包

> ID：13883035
> 
> 赞同：1
> 
> 时间：2012-12-14T16:58:10.097
> 
> 标签：linux, ubuntu, development-environment, kubuntu

我正在寻找一种在全新的 linux 安装中构建开发环境（IDE、数据库等）的方法，然后将该设置重新打包到可以安装在其他机器上的安装中（新开发人员）。有谁知道任何工具可以做到这一点？我正在使用 Kubuntu。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:35:38.367

我建议您构建自己的`.deb`软件包。在该包中，您可以添加所需的所有依赖项和程序。我认为这将是最干净的解决方案，具有版本等一些好处。

我们在公司中将其与[FAI](http://fai-project.org/)结合使用。

**更新：**

你熟悉`.deb`包吗？如果可能，我们通常使用 Ubuntu 附带的软件包。

无论如何，假设您有一些不在 Ubuntu 存储库中的软件，例如带有一些预安装插件和其他花哨的东西的 Eclipse。我将通过简化的分步说明为您提供一个想法。

*   下载 Eclipse
*   将 eclipse 存档解压到`/tmp/eclipse`
*   配置eclipse并安装一些插件

至此，您的 Eclipse 安装就可以使用了。所以现在让我们创建一个`.deb`包含该 Eclipse 安装的文件。有很多教程如何创建 debian 包，我将向您展示一个简单的方法。

*   在某个地方创建一个文件夹，您将在其中打包您的东西。我会用`/home/user/packages/eclipse`
*   在该文件夹中创建一个文件夹`DEBIAN`
*   将您的 Eclipse 安装复制`/tmp/eclipse/`到`/home/user/packages/eclipse/opt/development/eclipse`
*   在 DEBIAN 文件夹中创建三个文件`control`：`postinst`和`postrm`

将类似以下内容放入控制文件中：

```
Package: eclipse
Version: 1.0
Architecture: all
Maintainer: Your Name <somethat@somewhere.com>
Depends: openjdk-7-jdk
Section: development
Priority: optional
Description: Eclipse with some plugins 
```

在`postinst`您从 Eclipse 可执行文件中创建一个符号链接以表示`/usr/local/bin/eclipse`.

在`postrm`您删除该符号链接。

现在你应该有一个如下的目录结构：

```
eclipse
├── DEBIAN
│   ├── control
│   ├── postinst
│   └── postrm
└── opt
    └── development
        └── eclipse
            ├── about_files
            ├── about.html
            ├── artifacts.xml
            ├── configuration
            ├── dropins
            ├── eclipse
            ├── eclipse.ini
            ├── epl-v10.html
            ├── features
            ├── icon.xpm
            ├── libcairo-swt.so
            ├── notice.html
            ├── p2
            ├── plugins
            └── readme 
```

更改`/home/user/packages`并执行`dpkg-deb --build eclipse .`您现在应该已经`eclipse_1.0_all.deb`准备好安装在其他计算机上的 eclipse debian 软件包 ( )。

下一步是设置 APT 存储库:)

将包复制到新计算机并运行`dpkg -i <packagename>`以安装包。

希望我能帮上忙。

[HOWTO 构建 debian 二进制包](http://tldp.org/HOWTO/html_single/Debian-Binary-Package-Building-HOWTO/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T22:07:12.560

嗯，我没有读过太多关于 Ubuntu 中 KDE 的好东西。无论如何，如果（这是一个很大的 IF）您想研究 openSUSE，可以使用 SUSE 工作室：[http](http://susestudio.com/) ://susestudio.com/查看此常见问题解答：[http ://susestudio.com/help/faq.html](http://susestudio.com/help/faq.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:01:07.910

看看[预播](https://help.ubuntu.com/12.04/installation-guide/i386/preseed-using.html)。这是一种允许您预先定义安装流程的技术。

# android - ListView 元素上下文菜单

> ID：13883037
> 
> 赞同：0
> 
> 时间：2012-12-14T16:58:14.057
> 
> 标签：android, listview, contextmenu, element

我有一个包含一些元素的 ListView。我想检索我运行上下文菜单的元素的 ID（通过长按）。但以下代码：

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_adapter);

    /*non relevant code was omitted*/
    registerForContextMenu(this.getListView());

}

    @Override
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo info){

    Log.i("view", String.valueOf(v.findFocus().getId()) );

    super.onCreateContextMenu(menu,  v, info);
    getMenuInflater().inflate(R.menu.activity_adapter_context_menu, menu);
} 
```

返回始终相同的 id，即 ListView 视图的 id，而不是 ListView 元素的 id。我尝试了其他一些选择，但找不到解决方案。如何整理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:03:58.163

为 listView 设置 onItemClickListener。在覆盖方法上，获取视图 id

```
@Override
public void onItemClick(AdapterView<?> adapterView, View view, int position, long id) {

    String id = view.getId().toString();

    //open context menu now
    view.showContextMenu();
} 
```

注意：仅注册一次上下文菜单。

```
regsiterForContextMenu(listView); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T17:20:35.533

如果你想获取列表项 id 然后使用

```
lv.setOnItemLongClickListener(new OnItemLongClickListener() {

            @Override
            public boolean onItemLongClick(AdapterView<?> arg0, View arg1,
                    int arg2, long arg3) {
                // TODO Auto-generated method stub
                return false;
            }
        }); 
```

# c - 大小为 37 的数组

> ID：13883043
> 
> 赞同：4
> 
> 时间：2012-12-14T16:58:35.900
> 
> 标签：c, linux, macos, posix

```
typedef char    __darwin_uuid_string_t[37]; 
```

这段代码不包括 MacOS10.8/user/include/sys/_types.h 我想知道为什么这里是数字 37，而不是 2 的幂？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-14T17:00:59.417

**[UUID](http://en.wikipedia.org/wiki/Universally_unique_identifier)**的长度为**36 个字符**，因此形成 37 个字符的字符串，包括末尾的空字符。

> UUID 是一个 16 字节（128 位）的数字。在其规范形式中，UUID 由 32 个十六进制数字表示，显示在由连字符分隔的五组中，格式为 8-4-4-4-12，总共 36 个字符（32 个数字和四个连字符）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T17:01:07.600

一个 UUID 包含 36 个字符加上终止的 0 字节。

例如（来自[维基百科页面](http://en.wikipedia.org/wiki/Universally_unique_identifier)）：`550e8400-e29b-41d4-a716-446655440000`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:01:49.070

36 个字符的 UUID（32 位数字加上 4 个“-”分隔符），加上 0 终止符。

我假设。

并非所有事物都必须是 2 的幂。

# exception - Symfony 2 移除工厂服务？

> ID：13883049
> 
> 赞同：0
> 
> 时间：2012-12-14T16:58:54.200
> 
> 标签：exception, symfony, dependency-injection, symfony-2.1

Symfony 会自动删除工厂服务吗？

不知道发生了什么，但我的包正在正确加载`service.xml`文件：

```
<services>
    <service id="gremo_subscription_factory"
        class="%gremo_subscription_factory.class%" public="false">
        <argument>%gremo_subscription.interval%</argument>
    </service>
    <service id="gremo_subscription" class="%gremo_subscription.class%"
        factory-service="gremo_subscription_factory"
        factory-method="getSubscription">
    </service>
</services> 
```

这是由扩展类完成的：

```
public function load(array $configs, ContainerBuilder $container)
{
    $processor = new Processor();
    $configuration = new Configuration();

    $config = $processor->processConfiguration($configuration, $configs);
    $loader = new XmlFileLoader($container,
        new FileLocator(__DIR__.'/../Resources/config'));

    $loader->load('services.xml');
} 
```

服务定义`gremo_subscription_factory`存在（`var_dump`容器显示服务定义）在包中。但是，当我尝试`gremo_subscription`从另一个包访问服务（例如，从控制器）时：

```
$subscription = $this->get('gremo_subscription'); 
```

我得到了例外：

> 您请求了一个不存在的服务“gremo_subscription_factory”。

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:40:25.843

您不应该将 设置`gremo_subscription_factory`为私有。

删除`public="false"`服务上的标志。

# asp.net-mvc - 如何实现以模型属性为条件的部分视图？

> ID：13883054
> 
> 赞同：3
> 
> 时间：2012-12-14T16:59:08.693
> 
> 标签：asp.net-mvc, asp.net-mvc-4, knockout.js, client-side, dynamic-html

我有这个例子的功能要求：

> *   “公民身份”由 3 个单选按钮组成，即“南非公民”、“非南非人，有工作许可”和“非南非人，没有工作许可”。
> *   “工作许可证号码”是一个自由文本字段，限制为 15 个字符，在“公民”字段中选择“非南非人，有工作许可证”时激活

我想为诸如“工作许可证号”之类的字段编辑器创建某种通用容器，它可以根据其他模型属性启用或禁用其包含的编辑器，例如本例中的“公民身份”。这在第一次检索时很容易实现并渲染视图模型。

但是，当用户更改“公民身份”的值时，事情会变得复杂。只有 UI 字段发生了变化，没有模型属性，但是决定是否启用“工作许可证号”的容器依赖于模型属性。

我只看到两个解决方案：

1.  使用客户端（可能是 JavaScript）视图模型，从服务器端视图模型构建，可能是 Knockout.js 场景。然后绕过正常的表单提交，一次性提交整个客户端模型。

2.  当用户更改“Citizenship”值时，使用 ajax 调用更新服务器端模型，并更新依赖于“Citizenship”值的所有视图部分。这使事情变得复杂，因为我必须有一个“工作”和一个“承诺”模型服务器端。持久化小更改的工作模型，例如仅“公民身份”，然后当用户单击保存时，将所有更改移动到“已提交”模型并持久化到数据存储中。

对于那些理解我的意思的人，我可以使用哪些其他方式来实现这一点，或者我该如何改进我上面概述的技术？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T03:05:43.480

我认为这种情况非常适合使用淘汰赛的客户端解决方案，正如您在第一个建议的解决方案中提到的那样。Knockout 使得以声明方式进行这种客户端 UI 操作变得非常容易。用户完成表单后，您只需将客户端视图模型对象序列化为 JSON 并将其 POST 到您的服务层。

您提出的第二个解决方案的吸引力要小得多。它的缺点包括：

1.  它需要服务器回发只是为了更新 UI，这是一种不太理想的用户体验
2.  您的服务器域模型现在必须有一个工作且已提交的模型，这增加了复杂性

使用 MVVM 模式通过敲除和客户端 javascript 视图模型实现这一点的代码非常简单：

```
<div data-bind = "text: name"></div>
<input type="radio" name="citizenship" value="yes" data-bind="checked: citizenship">South African Citizen<br/>
<input type="radio" name="citizenship" value="nowithoutworkpermit" data-bind="checked: citizenship">Non South African, no work permit<br />
<input type="radio" name="citizenship" value="nowithworkpermit" data-bind="checked:     citizenship">Non South African, with work permit<br />
<div id="workpermit" data-bind="visible: citizenship() === 'nowithworkpermit'">
    <input type="text" name="workpermitinumber" />Work Permit number
</div>

<script src="/Scripts/knockout-2.2.0.js" ></script>
<script>
    var MyApp = MyApp || {};
    MyApp.ViewModel = {
        citizenship: ko.observable(""),
        name: ko.observable("John")
    };
    ko.applyBindings(MyApp.ViewModel);
</script> 
```

在此示例中，我在 MyApp.ViewModel 中创建了一个视图模型。该模型有两个属性：姓名和公民身份。我已经将“citizenship”属性绑定到单选按钮的“checked”属性，以及显示工作许可证号文本框的“visible”属性。

当用户选中一个单选按钮时，敲除将更新视图模型的“citizenship”属性。视图模型属性中的这种更改将反过来通过淘汰“可见性”绑定更新工作许可 div 的可见性 css 属性。当用户准备好提交表单时，您只需将 MyApp.ViewModel 序列化为 JSON 并通过网络发送。

淘汰赛的文档非常出色（[请参见此处](http://knockoutjs.com/documentation/introduction.html)），我认为它非常适合您要完成的工作。

# html - IE 9 中的兼容模式

> ID：13883056
> 
> 赞同：0
> 
> 时间：2012-12-14T16:59:16.913
> 
> 标签：html, css, internet-explorer, html-validation

我正在寻找可以帮助我使我的网页与 IE 7、8、9 兼容的解决方案。

我继承了页面，如果在 IE 7 中呈现，则没有问题。但是，如果我在 IE 8,9 中渲染它，页面将无法正确渲染。

我已经修复了页眉和内容。但在某些情况下，我仍然无法正确渲染。我正在通过 W3C 验证器运行 CSS 和 HTML 并消除问题。

有什么方法可以告诉我为什么页面在兼容模式下运行以及有什么问题？

**更新** 我在系统 html 标头中：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd"> 
```

或者

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

在这里定义：http: [//www.w3.org/QA/2002/04/valid-dtd-list.html](http://www.w3.org/QA/2002/04/valid-dtd-list.html)

由于 html5 还不是标准的，我不确定使用它是否对我有好处，并且在与旧版本的 IE 战斗之后

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:05:34.297

你有没有包括`doctype`？省略 doctype 会强制 IE 以兼容模式呈现页面。在顶部输入 HTML5 doctype 看看会发生什么

`<!DOCTYPE html>`

您可以分享指向您的标记的链接吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:45:32.110

我的解决方案是：

```
<meta http-equiv="X-UA-Compatible" content="IE=7" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:02:23.360

您使用任何 CMS 吗？一般来说，您应该浮动并清除您的 div（谈论相对定位的元素）。如果有必要为 ie7 和 8 创建额外的 css 文件（不要忘记检查 ie9）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T18:16:17.740

您是否尝试过 IE Compat Inspector 工具？[http://ie.microsoft.com/testdrive/HTML5/CompatInspector/](http://ie.microsoft.com/testdrive/HTML5/CompatInspector/)

[在http://ie.microsoft.com/testdrive/HTML5/CompatInspector/help/post.htm](http://ie.microsoft.com/testdrive/HTML5/CompatInspector/help/post.htm)有一个用户指南

还有一个 IE 兼容性测试工具，但看起来需要安装[http://msdn.microsoft.com/en-us/library/windows/desktop/ff966512(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ff966512(v=vs.85).aspx)

# coldfusion - CFSavecontent 中的 CFContent 标签提示用户下载 .cfm 文件

> ID：13883060
> 
> 赞同：1
> 
> 时间：2012-12-14T16:59:25.620
> 
> 标签：coldfusion

我编写了一个 ColdFusion 文件，它从数据库中获取一些数据并将其存储在一个数组中并填充一些变量。然后我将其格式化为 html 表并将其输出到保存在服务器上的 excel 文件中。

我遇到的问题是当页面被访问时，文件被写入，但浏览器也被提示下载 cfm 文件。比如我访问页面( `bla/bla/get_open_today.cfm`) 文件是写的，但是浏览器也想下载`get_open_today.cfm`。有谁知道是什么导致了这个问题？

这是输出到excel的代码：

```
<!--- Export to XLS file --->
<cfsavecontent variable="saveContent1">
<cfcontent type="application/msexcel">
<cfoutput>
<table border="1">
</tr>
<th >Hall ID</th>
<th >Room Number</th>
<th >Room Type</th>
<th >In Date</th>
<th >Clean Date</th>
<th >Comments</th>
</tr>
</cfoutput>
<cfoutput>
<cfloop index="x" from="1" to="#ArrayLen(myarray)#">
    <tr><td>#myarray[x][1]#</td><td> #myarray[x][2]# </td><td>#myarray[x][3]# </td><td>#myarray[x][4]#                                  </td><td>#myarray[x][5]#</td><td>#myarray[x][6]#</td></tr>
</td>
</cfloop>
    <tr>
        <td> </td>
        <td> </td>
        <td> </td>
        <td> </td>
    </tr>
    <tr>
        <td>One Bedroom</td>
        <td>#oneBR#</td>
        <td>Units Assigned</td>
        <td>#unitsAssigned#</td>
    </tr>
    <tr>
        <td>Two Bedroom</td>
        <td>#twoBR#</td>
        <td>Units Unassigned</td>
        <td>#unitsUnassigned#</td>
    </tr>
    <tr>
        <td>Three Bedroom</td>
        <td>#threeBR#</td>
        <td>Total Units</td>
        <td>#totalUnits#</td>
    </tr>
</cfoutput>

</table>
</cfsavecontent>
<cffile action="write" mode="777" output="#saveContent1#" file="Example/www/BFILES/Unit_Report.xls"> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T17:07:03.627

**删除[cfcontent](http://cfdocs.org/cfcontent)** - 这是将页面的内容类型标头设置为未处理的类型，从而提示浏览器提供下载。

cfcontent 的目的是向客户端发送信息——在 cfsavecontent 内部使用没有任何效果，因为 savecontent 只是对大字符串执行 cfset 的一种方便方式。

您不能使用 / 不需要 cfcontent 将 HTML 保存为 XLS 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T17:26:18.590

当 MS 发布 Office 2007 时，使用 html 表格标签进行 Excel 导出的技术成为一种糟糕的做事方式。它仍然有效，但不是很好。

幸运的是有更好的方法。ColdFusion 的更高版本具有 cfspreadsheet 标签。如果您的版本不够新，Ben Nadel 的博客有一个指向 Apache POI 的链接，您可以使用该链接。

# javascript - SecurityError：在画布中加载图像，对其进行修改并创建 dataURL

> ID：13883064
> 
> 赞同：3
> 
> 时间：2012-12-14T16:59:30.020
> 
> 标签：javascript, html, canvas

我正在尝试使用 HTML5 引入图像文件，将其绘制到画布上，对其进行一些操作，然后返回 dataURL 以便我可以引用这个新生成的图像。

这是图像加载代码的示例：

```
<canvas id="myCanvas" style="border:1px solid #c3c3c3;">
    Your browser does not support the canvas element.
</canvas>

<script type="text/javascript">
    c = document.getElementById("myCanvas");
    cxt = c.getContext("2d");

    var img=new Image();
    img.src = "http://www.google.com/images/srpr/logo3w.png";
    //img.src = 'image/placemark.png';
    img.onload = function() {
        cxt.drawImage(img, 0, 0);
    }

    console.log(c.toDataURL());
</script> 
```

因此，对于这样的代码， c.toDataURL() 的日志是一个空白画布，可能是因为`log()`调用是在`draw()`函数完成之前执行的。相反，如果我将该日志调用移到内部，则会`draw()`收到 JavaScript 错误：`SecurityError: The operation is insecure`

相反，如果我使用本地图像并将其放入`log`函数`draw`中，我会在那里得到预期的输出 - 但函数外部仍然是空白画布

我想我的实际问题是：如何将外部图像加载到画布上，然后以某种方式修改它的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:02:42.967

如果您想进行任何类型的图像修改，则需要在托管图像的服务器上设置跨源，使其成为[启用 CORS的图像。](https://developer.mozilla.org/en-US/docs/CORS_Enabled_Image)

如果未在服务器端设置此项，则唯一的其他选择是通过与脚本位于同一域的服务器端代理下载图像。只要图像来自同一个域，您就可以对其进行修改。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-03-05T16:26:18.980

我的代码没有安全错误：

```
<pre>
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="WebForm1.aspx.cs" Inherits="WebApplication2.WebForm1" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>

<script src="Scripts/jquery-2.1.0.min.js"></script>

<script type="text/javascript">
    function WindowsLoad()
    {
        var c = document.getElementById("myCanvas");
        var cxt = c.getContext("2d");

        var img = new Image();
        img.src = "http://www.google.com/images/srpr/logo3w.png";
        //img.src = 'image/placemark.png';
        img.onload = function () {
            cxt.drawImage(img, 0, 0);
        }

        console.log(c.toDataURL());
    }   
</script>

<body onload="WindowsLoad();">
    <form id="form1" runat="server">
        <div>
            <canvas id="myCanvas">
            </canvas>
        </div>
    </form>
</body>
</html>
</pre> 
```

# c++ - 隐式转换为 std::string

> ID：13883067
> 
> 赞同：16
> 
> 时间：2012-12-14T16:59:49.113
> 
> 标签：c++, string, operator-overloading

> **可能重复：**
> [通过隐式转换为字符串流式传输对象时重载解析失败](https://stackoverflow.com/questions/6677072/overload-resolution-failure-when-streaming-object-via-implicit-conversion-to-str)

我知道这样做不是一个好主意，但我真的很想知道下面的代码无法编译的原因（即为什么“没有可接受的转换”）：

```
#include <iostream>
#include <string>

class Test
{
public:
    operator std::string () const;
};

Test::operator std::string () const
{
    return std::string("Test!");
}

int main ()
{
    std::string str = "Blah!";
    std::cout << str << std::endl;

    Test test;

    str = test;//implicitly calls operator std::string without complaining

    std::cout << str << std::endl;

    std::cout << test;//refuses to implicitly cast test to std::string

    return 0;
} 
```

在 Visual Studio 2010 上，我收到此错误：“ `error C2679: binary '<<' : no operator found which takes a right-hand operand of type 'Test' (or there is no acceptable conversion)`”

运算符是否为了使用它而`<<`隐式转换为其他东西？`std::string`如果是，我需要在我的类中重载什么运算符才能使这样的事情起作用？我拒绝相信我实际上需要使用`operator char *`.

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-14T17:05:33.267

`operator<<(std::basic_ostream&, std::basic_string)`是一个函数模板，并且在模板参数推导过程中不考虑用户定义的转换。你需要`operator<<`为你的班级超载。

当然，另一种选择是演员表

```
std::cout << static_cast<std::string>(test); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-14T17:09:51.830

问题在于这`std::string`是模板的特化，`std::basic_string<char>`而所需的重载`operator<<`本身就是模板：

```
template<class charT, class traits, class Allocator>
basic_ostream<charT, traits>&
    operator<<(basic_ostream<charT, traits>&& os,
               const basic_string<charT,traits,Allocator>& str); 
```

为了用于模板参数推导，用户定义的类型必须完全匹配；不考虑转换。

您将需要`operator<<`为您的类提供重载，或显式转换为`std::string`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-14T17:15:23.113

通常，这取决于`<<`类的流插入运算符是具体函数还是模板。

作为`<<`一个具体的函数，找到了重载，并完成了转换（只要它不模棱两可）：

```
#include <iostream>
using namespace std;

template< class CharType >
struct String {};

ostream& operator<<( ostream& stream, String<char> const& s )
{
    return (stream << "s");
}

struct MyClass
{
    operator String<char> () const { return String<char>(); }
};

int main()
{
    cout << "String: " << String<char>() << endl;
    cout << "MyClass: " << MyClass() << endl;
} 
```

但是，`<<`作为函数模板，模板匹配找不到匹配项，然后不会尝试通过用户定义的运算符进行转换：

```
#include <iostream>
using namespace std;

template< class CharType >
struct String
{
};

template< class CharType >
ostream& operator<<( ostream& stream, String< CharType > const& s )
{
    return (stream << "s");
}

struct MyClass
{
    operator String<char> () const { return String<char>(); }
};

int main()
{
    cout << "String: " << String<char>() << endl;
    cout << "MyClass: " << MyClass() << endl;       // !Oops, nyet! Not found!
} 
```

在您的情况下，`std::string`实际上只是一个`typedef`for `std::basic_string<char>`。

修复：`<<`为您的类定义一个运算符，或者，如果您想避免头文件依赖（考虑构建时间），定义一个转换为 eg `char const*`，或者，最简单并且我推荐的，*将该转换命名*为显式调用。

显式是好的，内式是坏的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T17:04:32.690

我认为您需要覆盖的运算符是 "<<" 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-14T17:05:07.277

您需要覆盖该`operator<<`方法。

```
std::ostream & operator <<(std::ostream & os, const Test & t) {
    return os << std::string(t);
} 
```

# php - ABBYY 云 OCR

> ID：13883070
> 
> 赞同：0
> 
> 时间：2012-12-14T17:00:04.823
> 
> 标签：php, html, ocr, abbyy, abbyy-cloud-ocr

使用 ABBYY 提供的 php 示例[http://pastebin.com/SeN8mdya](http://pastebin.com/SeN8mdya)我已经能够将图像转换为文本。奇迹般有效。现在我正在尝试使用 Web 界面在移动设备上拍照并将其发送到 ABBYY ocr 服务并返回结果文本。我的拍照代码：

```
<!doctype html>
<html>
    <head>
        <title>Camera access on mobile web!</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta http-equiv="content-type" content="text/html;charset=utf-8" />
        <style type="text/css">
            #container {
                margin:0 auto;
                padding:0;
                width:200px;
            }
            div.message {
                background-color:green;
                border-radius:4px;
                color:white;
                display:none;
                padding:5px 0;
                text-align:center;
                width:100%;
            }
        </style>
    </head>
    <body>
        <div id="container">
            <img src="logo-mobile.png" id="lunchbox-logo" />
            <div class="message"><strong>Thanks for the submission!</strong></div>
            <p>Submit your receipt straight from your web browser!!</p>

            <form method="POST" enctype="multipart/form-data" action="http://cloud.ocrsdk.com/processImage?language=english&exportFormat=txt">
                <input type="file" accept="image/*" name="receipt[data]">
                <input type="button" onClick="submitReceipt();" value="Submit">    
            </form>
        </div>

        <script type="text/javascript">
            function submitReceipt(){
                var token = 'NEVER-COMMIT-TOKENS :)';
                var file = document.getElementsByName('receipt[data]')[0].files[0];

                fd = new FormData();
                fd.append('access_token', token);
                fd.append('receipt[data]', file);

                req = new XMLHttpRequest();
                req.open('POST', 'http://cloud.ocrsdk.com/processImage?language=english&exportFormat=txt');
                req.send(fd);

                document.getElementsByClassName('message')[0].style.display = "block";

            }  
        </script>
    </body>
</html> 
```

两者都彼此独立工作。我希望相机页面将图片提交给ABBYY并等待返回结果然后显示。我所有的尝试都打破了它。再次感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:03:22.953

您最终无意中在这里提交的是上传文件的文件名，而不是文件内容。现在有很多奇特的方法来获取文件的内容，但是跳过你正在做的所有花哨的 AJAX 东西，删除`onClick`处理程序，然后正常提交表单会简单得多。

# php - Jquery Ajax 未正确接收 php 响应

> ID：13883074
> 
> 赞同：1
> 
> 时间：2012-12-14T17:00:16.930
> 
> 标签：php, jquery, ajax, json

我正在从 php 向 jquery 发送 JSON 响应：

```
foreach ( $obj as $o )
{ 
 $a[ $o->key] = utf8_encode($o->id);
}    
die(json_encode($a)); 
```

我的 html/jquery 代码是：

```
$.ajax({
  type:'POST',
  url: "imoveis/carrega_bairros",
  data: ({cidade:10}),  
  dataType:"json",                        
  success: function(ret)
  { alert(ret)      
    if(ret.success)
    {   
      // ...
    }
    else
     alert("error");
  }
}); 
```

json 响应是完美的（我在控制台上得到它），但是 jquery 正在接收一个 NULL ret 对象并警告“错误”。有什么问题？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:04:17.353

在 PHP 文件的顶部添加 JSON 标头：

```
header('Content-type: application/json'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-16T06:15:15.860

用这个：-

```
<?php
$temp = array();
foreach ( $obj as $o )
{ 
 $temp[ $o->key] = utf8_encode($o->id);
 $a[] = $temp;
}    
die(json_encode(array('valid' => true,'content'=>$a)));
?> 
```

在javascript中：-

```
$.ajax({
    type:'POST',
    url: "imoveis/carrega_bairros",
    data: ({cidade:10}),  
    dataType:"json",                        
    success: function(ret)
    { 
        if(ret.valid == true)
        {
            // get your array as
            var arr = ret.content;
            alert(arr)
        }
        else
        {
            alert('error occured');
        }
    }
}); 
```

# php - 正则表达式 URI 路由

> ID：13883079
> 
> 赞同：0
> 
> 时间：2012-12-14T17:00:39.427
> 
> 标签：php, regex, routing

我正在创建一个简单的 PHP 路由类。我想检查 REQUEST_URI 的 RegEx 模式，例如：

```
foreach($routes AS $pattern) {
    $captures = NULL;
    if(preg_match($uri, $pattern, $captures)) { /* do something */ }
} 
```

但是如果我有太多的路线，这段代码会检查它们太久。有没有更快速的方法来做到这一点？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:43:36.790

不，您必须遍历它们。

更大的问题是为什么你认为“代码会检查它们太久”？你试过了吗？你有多少条路线？这听起来像是过早的优化，当您实际上不知道它是否不够快时，您会担心使事情变得更快。

尝试很多模式，看看实际需要多长时间。如果这是一个问题，那么它是值得追求的。否则，这只是浪费你的时间。

# c# - 如何发现绑定配置以在 Web 服务中进行身份验证

> ID：13883082
> 
> 赞同：2
> 
> 时间：2012-12-14T17:01:04.437
> 
> 标签：c#, vb.net, web-services, wsdl

我在 Visual Studio 2010 中创建了一个客户端来使用 Web 服务，使用 WSDL 自动创建代理类。在开发环境中，没关系，工作正常，因为它不需要在这个环境中进行身份验证。

我遇到的问题是该服务在测试和生产（真正的工作）环境中具有身份验证。WSDL 没有描述它。它们都使用相同的开发环境的 WSDL。

如果我尝试在测试环境中使用浏览器查看 WSDL，将“？WSDL”放在端点地址之后，它不会像开发环境一样返回 WSDL。它返回一个身份验证表单，一个普通的 html，并在通知用户和密码后返回 WSDL（与开发环境相同）。

我制作了这样的 app.config 绑定配置：

```
<wsHttpBinding>
          <binding name="WebServiceSoapAuth" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00" allowCookies="true" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"  maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Mtom" textEncoding="utf-8"  useDefaultWebProxy="true">
            <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384"/>
            <security mode="None">
              <transport clientCredentialType="Basic" proxyCredentialType="None" realm=""/>
              <message clientCredentialType="UserName" algorithmSuite="Default"/>
            </security>
          </binding>  
        </wsHttpBinding> 
```

如果我使用由 VS 2010 自动创建的 basicHttpBinding（在开发环境中工作），我的服务使用者会返回“无法验证或授权安全令牌”，如预期的那样。

更改为 wsHttpBinding（上面的代码），它返回“响应消息的内容类型 text/html；charset=utf-8 与绑定的内容类型（application/soap+xml；charset=utf-8）不匹配。如果使用自定义编码器，请确保正确实现 IsContentTypeSupported 方法。响应的前 1024 个字节为：" 后跟表单身份验证 html 代码。

我不知道我必须使用什么绑定配置。

我使用 SoapUI 测试了服务消耗，并且在两种环境中都可以工作，并且它使用身份验证工作，我只需要通知用户、密码并且需要将“WSS-Password Type”请求配置更改为“PasswordText”（只通知用户和密码我有“无法验证或授权安全令牌”返回）。

我很抱歉我的英语不好，我不流利，如果我在问题类别或格式方面犯了一些错误。

**编辑：**我无法在具有身份验证的环境中可视化 wsdl 文件。当我在地址后面加上？WSDL 时，它给了我一个验证表格（来自 Ensemble InterSystems 软件的表格），而不是 wsdl。

**我使用 SoapUI 测试了服务消耗，并且在两种环境中都可以工作，并且它使用身份验证工作，我只需要通知用户、密码并且需要将“WSS-Password Type”请求配置更改为“PasswordText”（只通知用户和密码我有“无法验证或授权安全令牌”返回）。**

为什么它不能使用自动生成的类，只是通知用户并通过？有人有想法吗？什么绑定配置相当于 SoapUI 配置的“WSS-Password Type”等于“PasswordText”？（我想这就是为什么我只通知用户和密码它不起作用的关键）

**编辑 2**：soap 消息的正文没问题。我在制作标题时遇到了麻烦。它可能是这样的：

`<soapenv:Header> <wsse:Security soapenv:mustUnderstand="1" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"> <wsse:UsernameToken wsu:Id="UsernameToken-5"> <wsse:Username>USERNAME</wsse:Username> <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">PASSWORD</wsse:Password> <wsse:Nonce EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">E1XqZ2v8IDaTBzfF3j/TOA==</wsse:Nonce> <wsu:Created>2012-12-21T12:24:23.380Z</wsu:Created> </wsse:UsernameToken> </wsse:Security> </soapenv:Header>`

正如我所说，我无法访问服务器，它在我的客户那里。我只知道它是用java制作的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:14:06.950

首先，您应该检查客户端是否使用与服务器相同的绑定。例如，如果您的客户端使用 wsHttpBinding 但指向使用 basicHttpBinding 的服务，那么它几乎在所有情况下都会出错。

其次，您将安全模式设置为 none，这意味着它不会使用传输或消息安全，我认为这不是您想要的。如果你想使用

```
<transport clientCredentialType="Basic" proxyCredentialType="None" realm=""/> 
```

和

```
<message clientCredentialType="UserName" algorithmSuite="Default"/> 
```

那么您应该将安全模式设置为 TransportWithMessageCredential。这将使用 HTTPS 的传输安全性和用于身份验证的消息安全性。其他安全模式将仅使用其中一种 clientCredentialType（传输将使用传输 clientCredentialType，而消息将使用消息 clientCredentialType）。

希望这可以帮助 ：）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T16:54:15.737

我必须手动创建一个 http webrequest，并且必须手动创建 xml 并将其传递给请求。postData 变量来自手动创建的 xml。

```
 Dim byteArray As Byte() = Encoding.UTF8.GetBytes(postData)
    Dim req As HttpWebRequest = DirectCast(WebRequest.Create("http://site.customer/ens/qa/customer.bs.ws.service.cls"), HttpWebRequest)
    req.Method() = "POST"
    req.UserAgent = "Apache-HttpClient/4.1.1 (java 1.5)"
    req.ContentType = "text/xml;charset=UTF-8"
    req.ContentLength = byteArray.Length
    req.KeepAlive = True
    req.Host = "site.customer"
    req.AutomaticDecompression = 3
    req.Headers.Add("SOAPAction", "http://www.tempuri.org/customer.bs.ws.service.function") 
```

# api - 使用 RestSharp 发布压缩 JSON 字符串的正确方法是什么？

> ID：13883088
> 
> 赞同：7
> 
> 时间：2012-12-14T17:01:16.593
> 
> 标签：api, http, rest, restsharp

我想在`POST`某处使用 RestSharp。我正在发布直接 JSON（而不是 POCO）。因为我发布的是纯 JSON，所以我相信我需要使用此解决方法而不是设置`Body`：

```
request.AddParameter(
    "application/json", myJsonString, ParameterType.RequestBody); 
```

**当我不压缩 JSON 时，**这很好用。当我这样做时，使用这个：

```
request.Headers.Add("Content-Encoding", "gzip");
request.AddParameter(
    "application/json", 
     GZipStream.CompressString(myJsonString), 
     ParameterType.RequestBody); 
```

这行不通。我单步执行了代码，在 中`RestClient::ConfigureHttp`，我看到：

```
http.RequestBody = body.Value.ToString(); 
```

由于我在一个字节数组中给出，`body.Value`设置为`System.Byte[]`

RestSharp 有没有办法在 POST 请求中处理压缩的 json 字符串？

# excel - 是否可以根据在 Excel 中过滤源表中的行来过滤数据透视表使用的数据？

> ID：13883092
> 
> 赞同：1
> 
> 时间：2012-12-14T17:01:21.600
> 
> 标签：excel, pivot-table, vba

我在 Excel 2007 中开发了一个仪表板，它使用工作表中的一个源表（在我们的数据仓库中填充了一个查询）和多个数据透视表，在这些数据上形成不同的横截面。

我在近一百个公式中使用 GETPIVOTDATA 来为我的仪表板中的特定指标提供正确的值。

这一切都很好。但是，我现在收到了为 5 个不同部分制作仪表板的问题。正如您可以想象的那样，我不想为此创建 5 个不同的工作簿，并且需要在所有这些工作簿上维护仪表板逻辑。

所以我的问题如下。是否可以自动（通过 VBA 或任何其他方式）过滤我的源表中的结果，该表是我的数据透视表的源，因此也是我的仪表板值的源。

如此示意性地：

DATABASE_VIEW --> SOURCE_TABLE --> 12 个数据透视表 --> 100 个 GETPIVOTDATA 函数

最好我想加载 source_table 中的所有段（我的数据库上的一个视图），然后过滤源表中的数据，从而为我的枢轴过滤 source_dat。通过这种方式，我可以（无需重新查询数据库）在仪表板中的段之间快速更改（仅刷新数据透视表）。

源表中的数据具有可用于过滤的列：CUSTOMER_SEGMENT。

任何帮助表示赞赏。

杰弗里

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:13:46.453

您可以通过 VBA 操作所有外部数据连接和内部数据透视表。

为了使它成为你的双重学习者，我建议使用“记录宏”按钮，然后更改数据透视表中的过滤器，并稍微更改 SQL 查询。

您现在将看到在录制的宏中说明了该数据透视表/查询的相关属性。过滤器和 SQL 只是 VBA 代码中的字符串，因此您可以更改某些位以获得不同的过滤器或`"WHERE Cust_ID = " comboboxCust.Value`类型的东西。

通过 VBA 代码来更改过滤器和 SQL 通常比让所有这些都与标准 Excel 工具（函数、参数、链接过滤器……）交互相关更快。

# windows-8 - Windows 8 设置用户帐户图像

> ID：13883096
> 
> 赞同：0
> 
> 时间：2012-12-14T17:01:32.917
> 
> 标签：windows-8, console-application, user-accounts

我正在尝试编写一个小型 CONSOLE（不是 Metro 风格）应用程序，以快速将当前用户的用户帐户图像更改为我在一堆笔记本电脑上运行的设置脚本的选择图像。

它们都是 Windows 8 并且（因为它的发布时间不长）我找不到大量关于它的信息。我确实设法弄清楚您需要使用[Windows.System.UserProfile](http://msdn.microsoft.com/en-us/library/windows/apps/br241881.aspx)对象来执行此操作，但我找不到任何有关如何在控制台应用程序中执行此操作的文档。

想法？建议？

# php - php多维数组if循环

> ID：13883097
> 
> 赞同：2
> 
> 时间：2012-12-14T17:01:34.400
> 
> 标签：php, if-statement, multidimensional-array

我有一个像这样的多维数组

```
$array['value'][1][1] 
```

现在我想像这样实现if循环

```
if ($value = $array['value'][1][1]) {
echo "It works";
} 
```

现在，如果我分配诸如`[1][1],[2][1]`.

是否可以比较整个数组。

我的意思是如果数组看起来像

`array[value][1][1],array[value][2][1],..........,array[value][n][1]`

`It works`应该得到回应。

我试过这样。

```
if ($value = $array['value'][][]) {
echo "It works";
} 
```

但它不起作用。谁能给我正确的语法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:06:48.387

我不确定这是否是您要查找的内容，但您可以尝试此功能 $value is 1 在您的情况下

```
function($array,$value)
    foreach($array['amazon'] as $val){
        if($value != $val[1])return FALSE;
    }
    return TRUE;
} 
```

该函数通过 $array['amazon'][*] 运行并检查每个值的条件。如果发现任何返回 FALSE

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:31:43.140

根据您对您要完成的工作的评论，我*认为*以下内容可能会解决您的困境。让我知道我是否走错了方向或有任何其他问题/疑虑。

```
<?php
$forms = array(
    'amazon' => array(
        0 => array(
            1 => 111,
        ),
        1 => array(
            1 => 222,
        ),
        2 => array(
            1 => 333
        )
    )
);

$value = 333;

$it_works = False;
foreach($forms['amazon'] as $array) {
    if($array[1] == $value) {
        $it_works = True;
        break;
    }
}

if($it_works === True) {
    print 'It Works!';
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:05:37.543

```
function check() {
    for($i = 0; $i < count($array[$value]); $i++) {
        if($value != $array[$value][$i][1])
            return FALSE;
    }
    echo 'It works!';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T17:07:53.390

你可以试试这个：

```
$itWorks = true;

for( $a = 0; $a < sizeof( $array[value] ); $a ++ ){
    if ( $value != $array[value][$a][1] ){
        $itWorks = false;
        break;
    }
}

if( $itWorks ){
    echo "It works";
} 
```

当然，您必须将 [value] 替换为合法值

# excel - vbsript 和 excel 删除除最后一个以外的所有工作表

> ID：13883100
> 
> 赞同：4
> 
> 时间：2012-12-14T17:01:41.767
> 
> 标签：excel, vbscript

我正在尝试删除最后一个 Excel 中的所有工作表并保存它然后移动它的位置。我无法完成工作，因为它会删除所有其他工作表，但会出现错误和超出范围错误。

```
Set objExcel = CreateObject("Excel.Application")

objExcel.Visible = True
objExcel.DisplayAlerts = False

Set objWorkbook = objExcel.Workbooks.Open("C:\M-tek 10-31-12_Tony.xlsx")
i = objWorkbook.Worksheets.Count

Do while i = i
i = i - 1
objWorkbook.Worksheets(i).Delete
Loop 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:38:59.383

您的循环将是无限的，因为您的条件永远不会是错误的（`i`将*始终*等于`i`）。因此，您需要更改循环以从最后一个工作表开始，然后向后工作到第一个工作表。你快到了。

```
count = objWorkbook.Worksheets.Count - 1

For i = count To 1 Step -1
    objWorkbook.Worksheets{i}.Delete
Next 
```

那应该可以（实际上确实可以，我刚刚测试过）。

# jquery - iOS上的jQuery Mobile - 点击事件的错误目标

> ID：13883101
> 
> 赞同：0
> 
> 时间：2012-12-14T17:01:46.993
> 
> 标签：jquery, ios, jquery-mobile, uiwebview, tap

我正在努力在 iOS 上的 UIWebView 中显示一些文本。我想获取用户点击的 HTML 元素的内容。例如，如果他点击段落，弹出窗口会显示段落内容。我正在使用 jQuery Mobile 来实现这一点。这就是我正在做的事情：

```
$('body').tap(function(e) {
    var tappedElement = $(e.target);

    alert(tappedElement.text());  
}); 
```

它适用于第一次点击。第二次点击无论它在哪里，都会返回相同的文本。

该事件似乎没问题，但第二次点击的目标属性是错误的。在第三次点击时，一切都恢复正常，依此类推......我在这里错过了什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:32:54.393

您可以尝试这种方法：

```
$('*').bind('touchstart', function(e) {
    //this will prevent all elements below the clicked item from firing as well.  
    event.stopPropagation();
    //display element text if available
    alert($(this).text());
}); 
```

# android - SQLite 不写列

> ID：13883103
> 
> 赞同：-1
> 
> 时间：2012-12-14T17:01:53.623
> 
> 标签：android

我这样做：

```
DatabaseHelper dbHelper = new DatabaseHelper(context);
dbHelper.getWritableDatabase();
String sql = "insert into "+getTableName()+("+DatabaseHelper.PRODUCT_MARK+",
         "+DatabaseHelper.PRODUCT_NAME+") 
          VALUES ('"+input.getMark()+"','"+input.getName()+"')";
System.out.println(sql);
getDatabase().execSQL(sql); 

dbHelper.close(); 
```

系统打印

```
12-14 16:53:33.857: I/System.out(1350): insert into product (pMark,name) 
            VALUES ('aaaaa ','zz') 
```

但是，当我从 db 中读取属性标记时，该属性标记没有被评估……我的错误在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:08:41.830

`getWritableDatabase`返回一个`Database`对象，应按如下方式使用：

`Database db = dbHelper.getWritableDatabase(context);`

然后你可以执行你的SQL：

`db.execSQL(...);`

# c# - 我如何通过预加载字段更改 Enabled= 属性

> ID：13883105
> 
> 赞同：2
> 
> 时间：2012-12-14T17:01:53.980
> 
> 标签：c#

我想修改`PXUIField Enabled=false/true`使用现有的布尔字段

```
public abstract class lastBatNbr : PX.Data.IBqlField
{
}

protected String _LastBatNbr;
[PXDBString(10, IsFixed = true)]
[PXUIField(DisplayName = "Last Batch Nbr")] 

public virtual String LastBatNbr
{
    get
    {
    return this._LastBatNbr;
    }
    set
    {
    this._LastBatNbr = value;
    }
} 
```

# javascript - mailto：在 Chrome 中卸载 html5 视频的锚链接

> ID：13883107
> 
> 赞同：3
> 
> 时间：2012-12-14T17:02:01.180
> 
> 标签：javascript, html, google-chrome, video, html5-video

我有一个非常简单的页面，带有一个`<video>`标签和一个电子邮件锚链接：http:
[//jsfiddle.net/6GquX/3/](http://jsfiddle.net/6GquX/3/)

单击 Chrome（OS X 10.8 + Win7，23.0.1271.97）中的电子邮件链接会调用`beforeunloadchange`事件并导致视频卸载，这不是预期的结果。

奇怪的是，如果我让视频缓冲一下然后单击电子邮件链接，视频会继续播放并且不会卸载。

据我所知，这只发生在 Chrome 中，我真的很茫然。`document.location.href = "mailto:foo@bar.com"`访问任何 HTML5 视频播放器站点（videojs、flowplayer 等），启动 HTML5 视频，然后立即在开发控制台中模拟电子邮件点击会产生相同的错误。

但是，我倾向于认为这是视频编码的方式，因为我无法使用从 YouTube 的 HTML5 播放器下载的视频重新创建上述内容：http:
[//jsfiddle.net/6GquX/4/](http://jsfiddle.net/6GquX/4/)（[来源](http://www.youtube.com/embed/WkfgL5P3fw4?html5=1&autoplay=1&vq=medium))

**1\. YouTube 是否有可能以特定的方式对他们的视频进行编码来解决这个问题？**
**2\. 我可以采用任何策略/技巧来解决这个问题吗？**

**更新：**

该问题似乎与视频的比特率有关。将上面的 flowplayer 示例重新编码为 300kbps 可以解决问题。（400kbps 的视频仍然存在同样的问题，不确定确切的阈值是多少）

300kbps 示例：http: [//jsfiddle.net/6GquX/7/](http://jsfiddle.net/6GquX/7/)

希望这将在 Chrome 的未来版本中得到解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:29:25.343

我刚刚遇到了您似乎在描述自己的错误。我的解决方法是在有人单击 mailto 链接后再次播放视频。

```
$('.email').click(function(e){
    e.preventDefault();
    document.location.href = $(this).attr('href');
    setTimeout(
        function(){
            // video.js handle (insert whatever call you want to play the video)
            _V_.players.video.play();
        },
        2000
    );
}); 
```

# matlab - Matlab抛硬币模拟

> ID：13883108
> 
> 赞同：3
> 
> 时间：2012-12-14T17:02:06.807
> 
> 标签：matlab, random, plot, percentage

我必须在 Matlab 中编写一些代码来模拟掷硬币 150 次。我必须计算硬币落在正面的次数并创建一个向量来给出正面的运行百分比。

然后我必须列出试验次数、随机“翻转”和正面的运行百分比。我假设随机“翻转”意味着该试验的正面或反面。

我还必须创建一个折线图，其中 x 轴为试验，y 轴为概率（百分比）。我假设百分比只是获得正面的百分比。

对不起，如果这篇文章很长。我认为现在提供详细信息将使我更容易看到我试图用代码做什么。我还没有创建表格或绘图，因为我什至不确定如何为实际问题编写代码。

```
NUM_TRIALS = 150;
trials = 1:NUM_TRIALS;
heads = 0;
t = rand(NUM_TRIALS,1);
percent_h = zeros(size(t));

for i = trials

    if (t(i) < 0.5)
        heads = heads + 1;
        percent_h = heads./trials; 
    end   
end

flips = t;

disp('Number of Trials, Random flips, Heads Percentage')
disp([trials', flips, percent_h'])
plot(trials,percent_h)
title('Trial Number vs. Percent Heads')
xlabel('Trial number')
ylabel('Percent Heads') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:10:08.603

您的代码实际上非常接近回答您的问题，但我看到了一些问题。

*   `t`您应该按当前试用号进行索引。
*   同样，`percent_h`应相应地编制索引。这也应该预先分配。
*   不知道`z`应该代表什么...
*   要制作情节，只需使用`plot`. `xlabel`会给 x 轴`ylabel`和 y 轴一个标签。`title`将为情节命名。
*   你应该除以`i`，而不是试验。

因此，您的代码应该看起来像这样。有很多方法可以简化它，但我会尽可能地保留您的代码。

```
NUM_TRIALS = 150;
trials = 1:NUM_TRIALS;
heads = 0;
t = rand(NUM_TRIALS,1);

percent_h=zeros(size(t));

for i = trials

    if (t(i) < 0.5)
        heads = heads + 1;
    end
    percent_h(i) = heads/i;  
end
plot(trials,percent_h)
xlabel('Trial Number')
ylabel('Percent Heads')
title ('Trial Number vs Percent Heads') 
```

![在此处输入图像描述](../Images/d6925081de29ab31ddb868f90abcaed2.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T10:19:45.147

正如@PearsonArtPhoto 所暗示的，您实际上可以通过利用其他一些 MATLAB 函数更简单地解决这个问题。首先，您可以使用[RANDI](http://www.mathworks.com/help/matlab/ref/randi.html)生成抛硬币作为正面抛硬币。然后，您可以使用[CUMSUM](http://www.mathworks.com/help/matlab/ref/cumsum.html)来获取累计正面数。将此元素明智地除以`1:n`得到正面的累积分数。

```
n=150;
ishead = randi([0,1],1,n);
plot(cumsum(ishead)./(1:n)); 
```

# java - Jogl 显示不显示

> ID：13883109
> 
> 赞同：1
> 
> 时间：2012-12-14T17:02:12.433
> 
> 标签：java, opengl, jogl

我正在尝试为我教授的 3D 图形课程寻找一个在 IBM 或 Mac 上使用 NetBeans 工作的 openGL 库。JOGL 似乎是一个不错的选择。我尝试加载 JGears 演示。尽管代码似乎在运行（所有 Graphics2D 组件都显示），但齿轮是不可见的。据我所知，Animator 甚至没有调用 display 方法。

# php - PHP 字符串编码问题 - 出现额外字符

> ID：13883110
> 
> 赞同：0
> 
> 时间：2012-12-14T17:02:15.777
> 
> 标签：php, html, utf-8, character-encoding

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T20:13:35.817

You have not shared much information in your question, but according to the sample you gave:

```
↑ (has been imported as) â†‘ 
```

This looks like you had already stored it as UTF-8 into the export file but while importing you told the file would be Windows-1252 encoded. It then was re-encoded a second time into UTF-8.

```
↑                                 UTF8: \xE2\x86\x91    UPWARDS ARROW (U+2191)

â  - Windows 1252     \xE2 226    UTF8: \xC3\xA2        LATIN SMALL LETTER A WITH CIRCUMFLEX (U+00E2)
†  - Windows 1252     \x86 134    UTF8: \xE2\x80\xA0    DAGGER (U+2020)
‘  - Windows 1252     \x91 145    UTF8: \xE2\x80\x98    LEFT SINGLE QUOTATION MARK (U+2018) 
```

In MySQL the name of the `Windows 1252` character set is `latin1` (cp1252 West European, [specific differences documented](http://dev.mysql.com/doc/refman/5.5/en/charset-we-sets.html)), for a full list please see [Character Sets and Collations That MySQL Supports](http://dev.mysql.com/doc/refman/5.0/en/charset-charsets.html).

That is why the solution in [the related Q&A works](https://stackoverflow.com/q/11436594/367456).

# .net - 上下文菜单中的“以管理员身份运行”不提示输入密码，我该如何从命令提示符处执行此操作

> ID：13883118
> 
> 赞同：1
> 
> 时间：2012-12-14T17:02:40.107
> 
> 标签：.net, windows, acl, privileges, administration

从 Windows 资源管理器以管理员身份启动程序时，我可以右键单击它并选择“以管理员身份运行”，它就可以正常工作。

但是，从我目前所见的一切来看，为了能够从 C# ( `System.Diagnostics.Process`) 或 cmd 运行程序，您需要为“管理员”帐户指定密码。

所以，我的问题是，如何像“以管理员身份运行”一样以编程方式运行（没有密码提示）？

**更新**

我有一个使用“以管理员身份运行”上下文菜单选项以管理员身份运行的程序。在这个程序中，我使用 运行一个批处理脚本`System.Diagnostics.Process`，*但是*这个批处理脚本似乎没有以管理员权限运行。

那么，如何使用`System.Diagnostics.Process`以管理员权限运行以编程方式执行的批处理脚本呢？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:07:06.713

您可以：

1.  关闭 UAC。检查有关如何操作的链接：http: [//windows.microsoft.com/en-US/windows-vista/Turn-User-Account-Control-on-or-off](http://windows.microsoft.com/en-US/windows-vista/Turn-User-Account-Control-on-or-off)这样您就不必再以管理员身份运行了。

2.  右键单击cmd并以管理员身份运行。

3.  检查此链接以了解如何以管理员身份执行进程：[How to start a Process as administrator mode in C#](https://stackoverflow.com/questions/2532769/how-to-start-a-process-as-administrator-mode-in-c-sharp)

# sql - SQL 选择如果然后

> ID：13883121
> 
> 赞同：0
> 
> 时间：2012-12-14T17:03:07.913
> 
> 标签：sql, select, if-statement

该表包含同一个人的许多行，所有列都包含相同的数据。例如：

```
FullName       Gender     DOB
---------------------------------
Mary Jones     Female     2012-05-01 
```

我想为每个人选择一行以显示在报告中。我认为最简单的方法可能是我们使用 if 语句来检查下一行是否与第一行相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:14:57.277

正如其他人所说，由于所有行都相同，您可以使用 distinct 关键字：

```
SELECT DISTINCT <columns>
FROM table 
```

但是，您可能会发现这些重复记录的原因是表中的某处至少有一列不同。在这种情况下，您可能需要改用 GROUP BY：

```
SELECT <columns>
FROM table
GROUP BY <columns> 
```

如果您需要显示不属于分组列的数据，您只需列出在 GROUP BY 子句中匹配的列，然后您必须使用聚合函数或子查询将唯一列中的数据带入选择列表. GROUP BY 查询可能会变得非常复杂并让您头疼。

如果这些列确实始终如一，那么您的架构或应用程序设计中的某些内容是不正确的。您很少会在表中拥有真正重复的记录，这更有可能意味着出现了问题。

最后，我需要评论一下您的 IF/THEN 请求。*这个想法太离谱了。*SQL 具有基于*SET*或*声明性*的编程风格。*使用 IF/THEN 之类的程序*工具思考问题只会带来麻烦。即使您确实需要条件表达式，在 SQL 语句中执行此操作的方法也是通过`CASE`表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:06:40.367

如果所有列中的数据都相同，则可以使用`DISTINCT`关键字：

```
SELECT DISTINCT FullName, Gender, DOB
FROM yourtable 
```

这将检查所有字段中的数据是否是唯一的，删除任何重复项。

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/1084e/1)

另一种写法是`GROUP BY`在所有字段上使用 a ：

```
SELECT FullName, Gender, DOB
FROM yourtable
GROUP BY FullName, Gender, DOB 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:06:48.993

您应该改用 distinct 子句。如果所有列实际上完全相同。

```
select distinct FullName, Gender, DOB
  from <your_table_name>; 
```

有重复的行通常是出现问题的迹象（可能是数据被多次加载）。您可能需要进行调查才能了解实际原因。

# windows - 如何绑定键盘按钮以在 Windows 中执行其他操作

> ID：13883122
> 
> 赞同：1
> 
> 时间：2012-12-14T17:03:08.023
> 
> 标签：windows, keyboard, keyboard-shortcuts, bind

我想知道是否可以在 Windows 中绑定任何键盘键来执行操作。

我想要的动作是，当我按下“？” 然后它只是自动输入一个文本“你好，这是新世界”。这可能吗？如果是这样，请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:55:41.530

这里有几个地方可以开始研究。

您正在寻找的功能类似于键盘记录器的设计。不同之处在于您打算使用密钥而不是观察它并让它通过

[http://www.securelist.com/en/analysis/204792178/Keyloggers_Implementing_keyloggers_in_Windows_Part_Two](http://www.securelist.com/en/analysis/204792178/Keyloggers_Implementing_keyloggers_in_Windows_Part_Two)

[使用 Windows 挂钩的 C++ 自定义热键](https://stackoverflow.com/questions/8698616/c-custom-hot-keys-using-windows-hooks)

[http://www.apriorit.com/our-company/dev-blog/132-keystroke-monitoring](http://www.apriorit.com/our-company/dev-blog/132-keystroke-monitoring)

# ios - IOS - 以特定方向加载 Nib 视图

> ID：13883125
> 
> 赞同：1
> 
> 时间：2012-12-14T17:03:16.640
> 
> 标签：ios, rotation, nib

我有一个以表格形式添加的视图： `[currentView addSubview: viewController.view];`

如果视图是这样添加 的，`[self presentModalViewController: viewController]`那么从横向和纵向模式下，视图总是可以正常显示。

但是，我不能使用模态，因为视图需要具有透明背景并且模态将其转换为黑色。

使用第一种方法的问题是笔尖总是以纵向模式加载，如果当前方向是纵向，则一切正常，我可以毫无问题地旋转到横向。

当我的设备处于横向模式时，视图再次加载为纵向，因此它不适合屏幕。

我尝试调用旋转委托方法：didRotateWithOrientation、willRotateWithOrientation、willAnimateRotation .. 等，但是它们不会旋转我的视图。

有什么方法可以在特定方向加载笔尖或在将视图添加到我的其他视图之前旋转视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:48:54.713

不幸的是，我认为这是不可能的，至少在 iOS 4 中是这样。

看看这个答案：

[https://stackoverflow.com/a/4869207/472344](https://stackoverflow.com/a/4869207/472344)

您最好创建一个自定义视图并添加它而不是视图控制器。

# java - 在java中实现具有多个消费者和单个生产者的缓存

> ID：13883127
> 
> 赞同：0
> 
> 时间：2012-12-14T17:03:28.467
> 
> 标签：java, caching, producer

我的要求是维护一个固定大小的缓存，它为基于 Java 的 Web 应用程序中的多个消费者和单个生产者提供支持。我的数据是这样的：

键 1，键 2，值

123，ABC，列表1

123，定义，列表2

234，xyz，列表3

客户端或消费者将根据 key1 和 key2 查询此缓存。因此，如果多个消费者尝试同时访问相同 key1 和 2 的缓存，他们都应该从缓存中获取相同的数据作为响应。

我正在寻找可能使用的最佳数据结构。另请注意，缓存大小是固定的，因此如果生产者在尝试插入记录之前应该删除第一个元素（如果缓存已满）。

我目前在地图中使用地图。即键 1 用于外部映射，键 2 用于内部映射。但是，我需要查看它以获取我认为效率低下的信息。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:14:27.390

首先，我会将您的缓存扁平化为单个、2 个组件键（即将 key1 和 key2 组合成一个复合键类）。

其次，我会使用现有的缓存实现而不是重新发明轮子。对于“简单”的用法，您可以同步对 LinkedHashMap 的访问（您可以使用该`removeEldestEntry()`方法按大小限制）。如果您需要更复杂的线程处理，那么我会看看[ehcache](http://ehcache.org/)或[Guava](http://code.google.com/p/guava-libraries/wiki/CachesExplained)之类的东西（在其他答案中提到）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T17:15:29.870

查看[Guava](http://code.google.com/p/guava-libraries/wiki/CachesExplained)，这是 Google 提供的一个有用的实用程序库，其中包含一些出色的缓存功能。特别是，它支持最大大小，并将自动处理驱逐。

至于 2 键问题，为什么不将 Guava 缓存（或任何实现）包装在另一个类中，该类采用 2 键并从组合中生成单个键，例如：

```
public class MyCache<Key, Value> {
    private final Cache<CacheKey, Value> guavaCache = CacheBuilder.build()

    public void put(Key keyOne, Key keyTwo, Value value) {
        cache.put(new CacheKey(keyOne, keyTwo), value);
    }

    public Value get(Key keyOne, Key keyTwo) {
        return cache.getIfPresent(new CacheKey(keyOne, keyTwo));
    }

    private static final class CacheKey {
        private final Key keyOne;
        private final Key keyTwo;

        CacheKey(Key keyOne, Key keyTwo) {
             this.keyOne = keyOne;
             this.keyTwo = keyTwo;
        }

        @Override
        public int hashCode() {
            int hash = keyOne == null ? 0 : keyOne.hashCode();
            return hash + 31 * keyTwo == null ? 0 : keyTwo.hashCode();
        }

        @Override
        public boolean equals(Object o) {
            // implementation omitted
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:26:38.453

我建议使用负载因子 1`Map`以所需大小备份自定义实现，`ConcurrentHashMap`并在内部有一个计数器，以确保您的包装`ConcurrentHashMap`不包含超过您希望它包含的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T21:01:30.240

您可以为这两个键维护两个 ConcurrentHashMaps，或者如果没有发生冲突的可能性则维护一个。要记住最旧的键，您可以维护一个队列，其中包含两个最旧的键，以便在达到缓存大小限制时删除。

# c - 使用 Visual Studio 2010 的 pdcurses 链接

> ID：13883130
> 
> 赞同：4
> 
> 时间：2012-12-14T17:03:34.507
> 
> 标签：c, visual-studio-2010, curses, pdcurses

这让我大吃一惊。我只是想将[pdcurses](http://pdcurses.sourceforge.net/)（即 Windows 的 ncurses）包含到测试程序中。联动虽然失败了。

使用 Visual Studio 2010。

我完全知道设置正确的链接附加库路径并列出库本身。没有喜悦。

我已经尝试了 pdcurses 网站上的各种预构建。没有这样的运气。

我当然求助于从源头构建。按照规定从 Visual Studio 命令提示符使用 nmake。建好了。纳达在链接上。

我错过了什么。星期五可能太晚了...

下面的输出：

```
1>------ Build started: Project: test, Configuration: Debug x64 ------
1>Build started 14/12/2012 16:24:32.
1>InitializeBuildStatus:
1>  Touching "x64\Debug\test.unsuccessfulbuild".
1>ClCompile:
1>  main.c
1>C:\dep\pdcurses\curses.h(160): warning C4005: 'MOUSE_MOVED' : macro redefinition
1>          C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\include\wincon.h(101) : see previous definition of 'MOUSE_MOVED'
1>main.c(73): warning C4133: 'function' : incompatible types - from 'unsigned short [20]' to 'const char *'
1>ManifestResourceCompile:
1>  All outputs are up-to-date.
1>main.obj : error LNK2019: unresolved external symbol endwin referenced in function main
1>main.obj : error LNK2019: unresolved external symbol wgetch referenced in function main
1>main.obj : error LNK2001: unresolved external symbol __imp_stdscr
1>main.obj : error LNK2019: unresolved external symbol refresh referenced in function main
1>main.obj : error LNK2019: unresolved external symbol printw referenced in function main
1>main.obj : error LNK2019: unresolved external symbol initscr referenced in function main
1>C:\proj\test.exe : fatal error LNK1120: 6 unresolved externals
1>
1>Build FAILED.
1>
1>Time Elapsed 00:00:01.47 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T17:39:33.223

行。我觉得比较傻。这是后代的解决方案...

分布式 pdcurses 二进制文件是*32bit*。我试图为*64bit*构建。

从根本上说，我忘记了连接的第一条规则：不要混合和匹配架构。

更具体地说，当尝试从源代码构建时：

1) 小心启动错误的 Visual Studio 命令提示符。“工具”菜单中的默认选项是 x86 选项。如果您只是尝试运行 cl.exe，您会发现这一点。

相反，从开始菜单运行提示：`Microsoft Visual Studio 2010->Visual Studio Tools->Visual Studio x64 Win64 Command Prompt (2010)`

调用构建然后通过 cd'ing 到 pdcurses 目录/win32a 并键入：

```
nmake -f vcwin32.mak DLL=pdcurses.dll 
```

此外，2) 在编译 pdcurse 之前更改 pdcurses Windows makefile (vcwin32.mak) 的第 111 行：

```
cvtres /MACHINE:X64 /NOLOGO /OUT:pdcurses.obj pdcurses.res 
```

（注意：即 X64 架构！）

现在一切都是一致的。将构建 pdcurses 库。它将与我在 x64 上构建的测试应用程序链接（如原始输出所示）。

# c# - 使用cmd通过c#编译一个.asm文件

> ID：13883137
> 
> 赞同：1
> 
> 时间：2012-12-14T17:04:01.630
> 
> 标签：c#, cmd, masm

我想通过c#编译一个放在masm的bin文件夹中的.asm文件。我尝试了多种方法，如process.start，但没有任何帮助。它打开cmd但命令“ml”从不执行。它要么打开pwb。 exe（MASM）或记事本中的'file.asm'。我将这些参数提供给CMD **“path\ml file.asm”**，手动工作正常。**ml 是用于编译 .asm 文件的命令**。我使用的方法之一是

```
System.Diagnostics.Process process = new System.Diagnostics.Process();
System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();
startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
startInfo.FileName = @"C:\WINDOWS\system32\cmd.exe";
startInfo.Arguments = "C:\Users\Hassan\Documents\Visual Studio 2010\Projects\FYP\FYP\MASM611\BIN\ml file.asm";

process.StartInfo = startInfo;
process.Start(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:07:44.000

如果你想以这种方式开始这个过程，你需要在路径周围加上引号，因为有空格：

```
startInfo.Arguments = @"""C:\Users\Hassan\Documents\Visual Studio 2010\Projects\FYP\FYP\MASM611\BIN\ml"" file.asm"; 
```

（在逐字字符串文字中，通过将双引号加倍来包含双引号。）

或者，如果`ml`实际上是一个可执行文件（我对 masm 一无所知），您可以使用：

```
startInfo.FileName = @"C:\Users\Hassan\Documents\Visual Studio 2010\Projects\FYP\FYP\MASM611\BIN\ml.exe";
startInfo.Arguments = "file.asm"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T17:07:03.017

要启动“cmd.exe”并运行另一个程序，您需要使用`/c`开关。

> /C 执行字符串指定的命令，然后终止

所以你需要：

```
startInfo.Arguments = "/c \"C:\Users\Hassan\Documents\Visual Studio 2010\Projects\FYP\FYP\MASM611\BIN\ml.exe\" file.asm"; 
```

我为路径中的空格添加了额外的引号。

如果您不需要通过命令提示符运行它 - “cmd.exe” - 那么您可以将“ml.exe”的路径放入并将`FileName`“file.ml”作为`Arguments`.

# javascript - 在未来几天或几个月内执行操作

> ID：13883138
> 
> 赞同：1
> 
> 时间：2012-12-14T17:04:05.233
> 
> 标签：javascript, email, meteor, futuretask

我正在尝试找出将来执行任务的最佳方式，例如向用户发送电子邮件。

我的想法是在需要发送电子邮件时存储（与用户数据一起存储在数据库中），并每天检查用户需要发送哪些电子邮件，并使用 Meteor 的 Timer 功能。

```
// 7 hours in millisec.
Meteor.setTimeout( function() {
    Meteor.call( "sendReminderEmail", ... );
}, 2.52e+7 ); 
```

我看到的问题是设置了太多的计时器，并阻碍了性能。什么是好的解决方案？

**编辑：**基本上我的用例包括用户创建一个事件，他们将其设置为长期事件或短期事件（基于天、周或月），并且他们会根据持续时间收到对该事件的跟进。

我想我可以每小时检查一次，但这似乎是一个同等成本的问题。有没有流星特定的方法来做到这一点？或者只是一个更好的概念？

**Edit2：**好的，我意识到准确性对我的问题并不重要，所以我正在考虑为每个时区设置一个计时器，它会发送大量电子邮件。如果用户有一个长期事件并且他们的提醒是在本周，那么现在就发送它。基本上它取决于事件的持续时间和用户的时区。

**所以我更新的问题是，我如何每天运行一些东西，记住我的问题？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:16:46.217

假设您想在今天上午 9 点执行代码，现在是上午 8 点，您可以创建超时以匹配目标时间的分钟数，然后创建 1 小时的间隔，并在每次执行时检查时间是否为上午 9 点，如果是， 执行。

在这个小规模示例中，我`executeMe()`在时钟显示 9 秒时执行：

现场测试：http: [//jsbin.com/ikulok/4/edit](http://jsbin.com/ikulok/4/edit)

```
<body>
Last run: <span id="time"></span><br>
Next execution: <span id="target"></span>
<script type="text/javascript">
    function executeMe(){
      alert("9 seconds!");
    }
    var timeout = null;
    var interval = null;
    function timer(){
      var now = new Date();
      document.getElementById('time').innerHTML = now;
      document.getElementById('target').innerHTML = new Date(now.getTime()+ 1000);
      //console.log("timer()", now);

      if(now.getSeconds() == 9)
        setTimeout("executeMe();",1); // async

      if(interval == null)
        interval = setInterval("timer()",1000);
    }

    var now = new Date();
    var target = new Date(now.getFullYear(),now.getMonth(),now.getDate(),now.getHours(),now.getMinutes(),now.getSeconds()+1,0);
    //console.log("now", now);
    //console.log("target", target);
    //console.log("diff", target.getTime() - now.getTime());
    document.getElementById('target').innerHTML = target;
    timeout = setTimeout("timer()", target.getTime() - now.getTime() );
  </script> 
```

* * *

如果你想运行`timer()`每小时而不是每秒，只需调整`target`和`setInterval()`当然你的条件

现场测试：http: [//jsbin.com/ikulok/3/edit](http://jsbin.com/ikulok/3/edit)

```
<body>
  Last run: <span id="time"></span><br>
  Next execution: <span id="target"></span>
<script type="text/javascript">
    function executeMe(){
      alert("1:20am!");
    }
    var timeout = null;
    var interval = null;
    function timer(){
      var now = new Date();
      document.getElementById('time').innerHTML = now;
      document.getElementById('target').innerHTML = new Date(now.getTime()+ 1*60*60*1000);
      //console.log("timer()", now);

      if(now.getHour() == 1)
        setTimeout("executeMe();", 20*60*1000); // !!!! this will execute at 1:20am

      if(interval == null)
        interval = setInterval("timer()",1*60*60*1000); // !!!! repeat every hour
    }

    var now = new Date();

    // !!!! targeting next exact hour
    var target = new Date(now.getFullYear(),now.getMonth(),now.getDate(),now.getHours(),now.getMinutes()+1,0,0);
    //console.log("now", now);
    //console.log("target", target);
    //console.log("diff", target.getTime() - now.getTime());
    document.getElementById('target').innerHTML = target;
    timeout = setTimeout("timer()", target.getTime() - now.getTime() );
  </script>
</body> 
```

# php - 如何通过 cms block magento 在产品页面上添加产品属性

> ID：13883139
> 
> 赞同：0
> 
> 时间：2012-12-14T17:04:06.403
> 
> 标签：php, magento

我有以下设置：

一个 cms 页面，其内容显示在产品页面上。（通过调用模板 phtml 文件中的 cms 块）

我不想触碰产品页面的 phtml 文件，这样我可以保证我的模板升级安全（我买了模板）

除了出现在具有其他属性的部分中的 sku 之外，我还想在产品页面中显示产品 sku 编号，这是默认设置。

由于模板已经提供了 cms 块以使内容出现在产品定价附近（这是我希望 sku 出现的位置），我想我会尝试通过调用 cms 中的 phtml 文件来获取 cms 块中的 sku堵塞。

我创建了一个 phtml 文件，如下所示：

```
app/design/frontend/default/mytheme/template/page/getSku.phtml 
```

我在其中放置了以下代码（这应该是获取产品 sku）：

```
<?php
    //get product sku
    echo $_product->getAttributeText('sku');
?> 
```

我在 cms 块中放置了以下内容（调用 phtml 文件）：

```
{{block type="core/template" template="page/getSuk.phtml"}} 
```

**错误：** 我的页面没有完全显示，（似乎页面没有完全呈现。）

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T17:03:00.373

我在这里找到了答案： [Calling an attribute in a CMS block in magento](https://stackoverflow.com/questions/13710077/calling-an-attribute-in-a-cms-block-in-magento?rq=1)

它涉及首先使用以下内容在 phtml 页面上获取产品模型：

```
<?php       
   $_prodID = Mage::registry('current_product')->getId();
   $_product = Mage::getModel('catalog/product')->load($_prodID );
?> 
```

只有这样，您才能按如下方式访问属性：

```
echo $_product->getData('sku') 
```

# mkmapview - MKMapView 图像叠加绘制倒置

> ID：13883140
> 
> 赞同：0
> 
> 时间：2012-12-14T17:04:14.457
> 
> 标签：mkmapview, cgcontext, cgimage, mkoverlay, mkmaprect

我目前正在创建一个应用程序，该应用程序需要在地图上绘制大量不同大小的叠加层。该应用程序当前抓取 2 个地图点，这些地图点代表覆盖层应位于的边界框的角。然后我将这些转换为 MKMapRect 以在 MKOverlay 类中使​​用。叠加层绘制在正确的位置，但图像似乎垂直翻转，当我尝试应用 CGAffineTransformMakeRotation(180) 时，我可以看出这一点，图像出现在正确的位置，但书写是倒退的。

如果有人可以帮助我弄清楚它为什么这样做，将不胜感激，请参阅下面的代码。

设置代码：

```
 // First grab the overlay co-ordinates
    double left = [[self.storedWildMapObject.arrayBBox objectAtIndex:0] doubleValue], bottom = [[self.storedWildMapObject.arrayBBox objectAtIndex:1] doubleValue], right = [[self.storedWildMapObject.arrayBBox objectAtIndex:2] doubleValue], top = [[self.storedWildMapObject.arrayBBox objectAtIndex:3] doubleValue];

// Store these in 2 coordinates representing top left / bot right
    CLLocationCoordinate2D upperLeftCoord =
    CLLocationCoordinate2DMake(top,left);

    CLLocationCoordinate2D lowerRightCoord =
    CLLocationCoordinate2DMake(bottom,right);

//Convert to map points
    MKMapPoint upperLeft = MKMapPointForCoordinate(upperLeftCoord);

    MKMapPoint lowerRight = MKMapPointForCoordinate(lowerRightCoord);

// Work out sizes
    double rightToLeftDiff = lowerRight.y - upperLeft.y;
    double topToBottDiff = lowerRight.x - upperLeft.x;

    MKMapRect bounds = MKMapRectMake(upperLeft.x, upperLeft.y, topToBottDiff, rightToLeftDiff);

// Add to overlay
    MKMapOverlay *mapOverlay = [[MKMapOverlay alloc] initWithMapRect:bounds andCoord:upperLeftCoord];
    [self.mapV addOverlay:mapOverlay]; 
```

// 地图叠加

```
- (id)initWithMapRect:(MKMapRect)rect andCoord:(CLLocationCoordinate2D)coord
{
    self = [super init];

    if (self)
    {
        self.centerPos = coord;
        self.mkMapRect = rect;
    }
    return self;
}

-(CLLocationCoordinate2D)coordinate
{
    return self.centerPos;
}

- (MKMapRect)boundingMapRect
{    
    return self.mkMapRect;
} 
```

// MapOverlayView

```
- (id)initWithOverlay:(id <MKOverlay>)overlay andImage:(UIImage *)img
{
    self = [super initWithOverlay:overlay];
    if (self)
    {
        self.image = img;
    }
    return self;
}

/** Degrees to Radian **/
#define degreesToRadians( degrees ) ( ( degrees ) / 180.0 * M_PI )

/** Radians to Degrees **/
#define radiansToDegrees( radians ) ( ( radians ) * ( 180.0 / M_PI ) )

- (void)drawMapRect:(MKMapRect)mapRect zoomScale:(MKZoomScale)zoomScale inContext:(CGContextRef)ctx
{    
    CGImageRef imageReference = self.image.CGImage;

    MKMapRect theMapRect    = [self.overlay boundingMapRect];
    CGRect theRect           = [self rectForMapRect:theMapRect];
    CGRect clipRect     = [self rectForMapRect:mapRect];

    CGContextAddRect(ctx, clipRect);
    CGContextClip(ctx);
    //CGContextRotateCTM(ctx, degreesToRadians(180.0f));

    CGContextDrawImage(ctx, theRect, imageReference);
} 
```

以防万一它有助于我也有一个调试器打印出 MapOverlayView 中使用的 MapRect：

```
 (lldb) p theMapRect
(MKMapRect) $17 = {
  (MKMapPoint) origin = {
    (double) x = 1.27662e+08
    (double) y = 7.86099e+07
  }
  (MKMapSize) size = {
    (double) width = 8.12378e+06
    (double) height = 1.27474e+07
  }
} 
```

下面是它的样子：

![在此处输入图像描述](../Images/991ec2ae51e3d71ab4eb4b40ed1f30c4.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T14:42:10.457

在这里找到的答案似乎使用相同的 mapRect 以正确的方式绘制我的图像：

[https://stackoverflow.com/a/3599448/1090024](https://stackoverflow.com/a/3599448/1090024)

所以我现在正在使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T04:29:16.680

您是否已验证存储的wildmap 对象的坐标是否符合您期望的顺序？

# string - for循环内的变量在每次迭代时都没有重新初始化？

> ID：13883142
> 
> 赞同：3
> 
> 时间：2012-12-14T17:04:19.520
> 
> 标签：string, c++-cli, scope

我有一个 C++/CLI 项目，它在 for 循环中声明了一个 String^ 变量，但没有对其进行初始化。在第一次迭代中，变量被设置为某个值。在每次后续迭代中，它似乎都保留了先前的值。每次通过循环时，本地范围内的变量不应该初始化为 null （或等效）吗？这也发生在 int 上。此外，除非我将警告级别设置为 W4，否则编译器不会警告可能未初始化的值，即使那样它也只会警告 int 而不是 String^。

这是显示行为的示例代码。

```
#include "stdafx.h"
using namespace System;

int main(array<System::String ^> ^args)
{
    for(int n = 0; n < 10; n++)
    {
        String^ variable;
        int x;

        switch(n)
        {
        case 1:
            variable = "One";
            x = 1;
            break;
        case 5:
            variable = "Five";
            x = 5;
            break;
        }

        Console::WriteLine("{0}{1}", variable, x);
    }
} 
```

这个的输出将是

```
One, 1
One, 1
One, 1
One, 1
Five, 5
Five, 5
Five, 5
Five, 5
Five, 5 
```

Am I completely misunderstanding how locally scoped variables are supposed to be initialized? Is this a "feature" unique to managed C++? If I convert this to C# the compiler will warn about both variables, even at the base warning level.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:17:57.870

Disclaimer: I know C and C++ pretty well; C++/CLI, not so much. But the behavior you're seeing is essentially the same that I'd expect for a similar program in C or C++.

`String^` is a *handle* to a `String`, similar to a *pointer* in C or C++.

Unless C++/CLI adds new rules for initialization of handles, a block-scope variable of type `String^` with no explicit initialization will initially have a garbage value, consisting of whatever happened to be in that chunk of memory.

Each iteration of the loop conceptually creates and destroys any variables defined between the `{` and `}`. And each iteration *probably* allocates its local variables in the same memory location (this isn't required, but there's no real reason for it not to do so). The compiler could even generate code that allocates the memory on entry to the function.

So on the first iteration of your loop, `variable` is set to `"One"` (or rather, to a handle that refers to `"One"`), that's the value printed by `Console::WriteLine`. No problem there.

On the second iteration, `variable` is allocated in the same memory location that was used for it on the first iteration. No new value is assigned to it, so it retains the value that was stored in that memory location on the first iteration. The same thing happens with `x`.

You cannot count on the previous value being retained, and your program's behavior is undefined. If your goal were to write a correctly working program, rather than to understand how this incorrect program behaves, the solution would be to ensure that all your variables are properly initialized before they're used.

If you did the initial assignment on the second iteration rather than the first, the program would likely crash on the first iteration -- though even that's not guaranteed.

As for why the compiler doesn't warn about this, I don't know. I hesitate to suggest a compiler bug, but this could be one.

Also, even with high warning levels enabled, warning about uninitialized variables requires control flow analysis that may not be done by default. Enabling both warnings *and* a high level of optimization might give the compiler enough information to warn about both `variable` and `x`.

It still seems odd that it warns about `x` and not about `variable` with `W4`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T12:33:58.233

C++/CLI is only an **extension/superset** of **standard C++** so it complies with most of its specifications, extending it only to fit with the CLI (~.Net) requirements.

> Shouldn't a variable in local scope be initialized to null (or equivalent) each time thru the loop?

AFAIK the C++ standard does not define the way local loop variables should be initialized.

So, to avoid any overhead, compilers usually don't use specific local memory management for loops : see this SO question : [Is there any overhead to declaring a variable within a loop? (C++)](https://stackoverflow.com/questions/982963/is-there-any-overhead-to-declaring-a-variable-within-a-loop-c)

> Am I completely misunderstanding how locally scoped variables are supposed to be initialized?
> 
> Is this a "feature" unique to managed C++

So no, this is not a feature or special behavior : your C++/CLI compiler is only using standard C++ practices.

> If I convert this to C# the compiler will warn about both variables, even at the base warning level.

C# and AFAIK Java try hard to avoid any undefined behaviors, so they force you to initialize local variables before they are used.

Here is the CIL resulting from the compilation (I've done some formatting and commenting to make this bunch of text understandable :)) :

```
.locals init (int32 V_0, int32 V_1, string V_2, int32 V_3)
//                   ^          ^           ^          ^
//                   n          x        variable     tmp

// initialization of "n"
IL_0000:  ldc.i4.0
IL_0001:  stloc.0
IL_0002:  br.s       IL_0008

// loop starts here

// post iteration processing
IL_0004:  ldloc.0
IL_0005:  ldc.i4.1
IL_0006:  add
IL_0007:  stloc.0

// stop condition check
IL_0008:  ldloc.0
IL_0009:  ldc.i4.s   10
IL_000b:  bge.s      IL_003e

// initialization of temporary "tmp" variable for switch
IL_000d:  ldloc.0
IL_000e:  stloc.3

// check if "tmp" is 3
IL_000f:  ldloc.3
IL_0010:  ldc.i4.1
// if so go to "variable" intialization
IL_0011:  beq.s      IL_0019

// check if "tmp" is 5
IL_0013:  ldloc.3
IL_0014:  ldc.i4.5
IL_0015:  beq.s      IL_0023

// go to display
IL_0017:  br.s       IL_002b

// initialization of "variable"
IL_0019:  ldstr      "One"
IL_001e:  stloc.2
... 
```

So the variable is indeed never implicitly manipulated by the code generated by the compiler.

# node.js - nodejs的远程部署脚本？

> ID：13883151
> 
> 赞同：0
> 
> 时间：2012-12-14T17:04:38.947
> 
> 标签：node.js, deployment

我正在寻找一种通过命令行脚本轻松部署 nodejs 应用程序的方法。

我找到了一种解决方案： [https ://github.com/Skookum/nimbus](https://github.com/Skookum/nimbus)

我还听说整个事情都可以用 git 和 post commit hooks 来完成。

人们会推荐什么？

编辑：我将它部署到我自己的盒子里，我有根

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T23:42:48.750

You have two options on a self hosted setup.

1.  Do it all yourself

    This entails git post-receive hooks. In short you setup your production box to host a copy of your repository, on your local machine you setup a remote, let's call the remote `production`.

    Now when you run `git push production master` on your local machine, the updates are sent and the server executes the post-receive hook on your server which runs whatever you wish.

    Actions you may want are: checking out/writing the data in the repo to files/folders (the git repo on the server is stored as a bare repo); restarting your webserver; notifying you that there's been a deployment etc.

    I'd suggest reading up on it at [http://git-scm.com/book/en/Customizing-Git-Git-Hooks](http://git-scm.com/book/en/Customizing-Git-Git-Hooks) and taking a look at a few tutorials, this one (http://ryanflorence.com/deploying-websites-with-a-tiny-git-hook/) looks prety legit.

2.  Use a service to manage it for you, [http://www.deployhq.com/](http://www.deployhq.com/) is the only one that springs to mind but I'm sure there's other.

Good Luck and Happy Hacking :)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2019-03-18T20:53:04.083

有一个名为 shipit.js ( [https://github.com/shipitjs/shipit](https://github.com/shipitjs/shipit) ) 的工具允许您执行不同的部署任务，例如：

*   将代码从 repo 移动到服务器
*   重新启动服务器
*   安装 node_modules
*   等等

您创建一个配置文件，然后运行：`npx shipit deploy`并执行您指定的所有任务。如果发生故障，它具有回滚机制。

有一个很好的截屏视频：[https](https://youtu.be/8PpBySjkWEM) ://youtu.be/8PpBySjkWEM 。

# spring - 使用 RestTemplate.postForLocation 的文件上传进度条

> ID：13883161
> 
> 赞同：7
> 
> 时间：2012-12-14T17:05:27.963
> 
> 标签：spring, upload, progress-bar, multipart, resttemplate

我有一个将文件上传到 REST 服务的 Java 桌面客户端应用程序。

对 REST 服务的所有调用都使用 Spring RestTemplate 类处理。

我希望实现一个进度条并取消功能，因为正在上传的文件可能非常大。

我一直在寻找一种在网络上实现此功能的方法，但没有运气。

我尝试实现自己的 ResourceHttpMessageConverter 并替换 writeInternal() 方法，但是在实际发布请求之前，似乎在某种缓冲操作期间调用了此方法（因此在发送之前一次性读取流）。

我什至尝试过覆盖 CommonsClientHttpRequestFactory.createRequest() 方法并使用特殊的 writeRequest() 方法实现我自己的 RequestEntity 类，但是会出现同样的问题（在实际发送帖子之前已读取所有流）。

我找错地方了吗？有没有人做过类似的事情。

我在网上读到的很多关于实现进度条的内容都谈到了关闭上传，然后使用单独的 AJAX 请求轮询 Web 服务器的进度，这似乎是一种奇怪的方式。

非常感谢任何帮助或提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2022-01-08T20:20:14.440

这是一个古老的问题，但它仍然是相关的。

> 我尝试实现自己的 ResourceHttpMessageConverter 并替换 writeInternal() 方法，但是在实际发布请求之前，似乎在某种缓冲操作期间调用了此方法（因此在发送之前一次性读取流）。

你走在正确的轨道上。此外，您还需要在 RestTemplate 的 HttpRequestFactory 上禁用请求正文缓冲，如下所示：

```
HttpComponentsClientHttpRequestFactory clientHttpRequestFactory = new HttpComponentsClientHttpRequestFactory();
clientHttpRequestFactory.setBufferRequestBody(false);
RestTemplate restTemplate = new RestTemplate(clientHttpRequestFactory); 
```

这是一个[使用 RestTemplate 跟踪文件上传进度的工作示例。](https://github.com/spring-projects/spring-android/issues/35)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-21T20:17:31.757

关于这个应用程序是什么，或者它是如何工作的没有太多细节，所以这个反应是模糊的，但我相信你可以做这样的事情来跟踪你的上传进度。

如果这确实是一个 Java 客户端应用程序（即不是 HTML/JavaScript，而是一个 Java 程序）并且您确实让它将文件作为流上传，那么您应该能够通过计算正在传输的数组中的字节数来跟踪您的上传进度在流缓冲区中，并将其与文件对象的总字节数进行比较。

当你得到文件时，得到它的大小。

```
Integer totalFile = file.getTotalSpace(); 
```

无论您在哪里以流的形式传输，都可能将字节添加到某种输出缓冲区

```
byte[] bytesFromSomeFileReader =  [whatEverYouAreUsingToReadTheFile];

    ByteArrayOutputStream byteStreamToServer = new ByteArrayOutputStream();
    Integer bytesTransmitted = 0;

    for (byte fileByte : bytesFromSomeFileReader) {
        byteStreamToServer.write(fileByte);
            //
            //  Update your progress bar every killo-byte sent.
            //
        bytesTransmitted++;
        if( (bytesTransmitted % 1000) = 0) {
            someMethodToUpdateProgressBar();
        }
    } 
```

# java - 无法捕获的 ChuckNorrisException

> ID：13883166
> 
> 赞同：600
> 
> 时间：2012-12-14T17:05:39.320
> 
> 标签：java, exception, exception-handling, aop

[是否可以在Java](http://en.wikipedia.org/wiki/Java_%28programming_language%29)中构造一段代码，使假设的无法`java.lang.ChuckNorrisException`捕获？

想到的想法是使用例如拦截器或[面向方面的编程](http://en.wikipedia.org/wiki/Aspect-oriented_programming)。

* * *

## 回答 #1

> 赞同：318
> 
> 时间：2012-12-14T17:27:27.823

我没有尝试过，所以我不知道[JVM](http://en.wikipedia.org/wiki/Java_virtual_machine)是否会限制这样的东西，但也许你可以编译 throws 的代码，但在运行时提供一个*不扩展 Throwable*`ChuckNorrisException`的类定义。`ChuckNorrisException`

 *更新：

它不起作用。它会生成一个验证错误：

```
Exception in thread "main" java.lang.VerifyError: (class: TestThrow, method: ma\
in signature: ([Ljava/lang/String;)V) Can only throw Throwable objects
Could not find the main class: TestThrow.  Program will exit. 
```

更新 2：

实际上，如果您禁用字节码验证器，您可以让它工作！( `-Xverify:none`)

更新 3：

对于那些从家里跟随的人，这里是完整的脚本：

创建以下类：

```
public class ChuckNorrisException
    extends RuntimeException // <- Comment out this line on second compilation
{
    public ChuckNorrisException() { }
}

public class TestVillain {
    public static void main(String[] args) {
        try {
            throw new ChuckNorrisException();
        }
        catch(Throwable t) {
            System.out.println("Gotcha!");
        }
        finally {
            System.out.println("The end.");
        }
    }
} 
```

编译类：

```
javac -cp . TestVillain.java ChuckNorrisException.java 
```

跑：

```
java -cp . TestVillain
Gotcha!
The end. 
```

注释掉“extends RuntimeException”并*仅**重新编译`ChuckNorrisException.java`*：

```
javac -cp . ChuckNorrisException.java 
```

跑：

```
java -cp . TestVillain
Exception in thread "main" java.lang.VerifyError: (class: TestVillain, method: main signature: ([Ljava/lang/String;)V) Can only throw Throwable objects
Could not find the main class: TestVillain.  Program will exit. 
```

不经验证运行：

```
java -Xverify:none -cp . TestVillain
The end.
Exception in thread "main" 
```

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2012-12-15T12:16:53.727

深思熟虑后，我成功创建了一个无法捕获的异常。然而，我选择将其命名为`JulesWinnfield`Chuck，而不是 Chuck，因为它是一种蘑菇云铺设母亲的例外。此外，它可能与您的想法不完全一样，但肯定不会被抓住。观察：

```
public static class JulesWinnfield extends Exception
{
    JulesWinnfield()
    {
        System.err.println("Say 'What' again! I dare you! I double dare you!");
        System.exit(25-17); // And you shall know I am the LORD
    }
}

public static void main(String[] args)
{       
    try
    {
        throw new JulesWinnfield();
    } 
    catch(JulesWinnfield jw)
    {
        System.out.println("There's a word for that Jules - a bum");
    }
} 
```

*瞧！*未捕获的异常。

输出：

> 跑：
> 
> 再说“什么”！我赌你！我量你不敢！
> 
> Java 结果：8
> 
> 构建成功（总时间：0 秒）

当我有更多的时间时，我会看看我是否还能想出其他的东西。

另外，检查一下：

```
public static class JulesWinnfield extends Exception
{
    JulesWinnfield() throws JulesWinnfield, VincentVega
    {
        throw new VincentVega();
    }
}

public static class VincentVega extends Exception
{
    VincentVega() throws JulesWinnfield, VincentVega
    {
        throw new JulesWinnfield();
    }
}

public static void main(String[] args) throws VincentVega
{

    try
    {
        throw new JulesWinnfield();
    }
    catch(JulesWinnfield jw)
    {

    }
    catch(VincentVega vv)
    {

    }
} 
```

导致堆栈溢出 - 同样，异常仍然未被捕获。

* * *

## 回答 #3

> 赞同：85
> 
> 时间：2012-12-14T17:15:14.427

对于这样的异常，显然必须使用`System.exit(Integer.MIN_VALUE);`构造函数中的 a ，因为如果抛出这样的异常就会发生这种情况；）

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2012-12-14T17:09:10.307

任何代码都可以捕获 Throwable。所以不，您创建的任何异常都将成为 Throwable 的子类，并且会被捕获。

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2012-12-15T19:01:16.470

```
public class ChuckNorrisException extends Exception {
    public ChuckNorrisException() {
        System.exit(1);
    }
} 
```

（当然，*从技术上讲*，这个异常实际上从未被抛出，但`ChuckNorrisException`不能抛出一个正确的——它首先抛出你。）

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2012-12-14T17:17:13.820

您抛出的任何异常都必须扩展 Throwable，因此它总是可以被捕获。所以答案是否定的。

如果你想让它难以处理，你可以重写方法`getCause(), getMessage()`, `getStackTrace()`,`toString()`来抛出另一个`java.lang.ChuckNorrisException`.

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2012-12-18T22:56:28.737

我的回答是基于@jtahlborn 的想法，但它是一个完整的[Java](http://en.wikipedia.org/wiki/Java_%28programming_language%29)程序，可以打包到[JAR](http://en.wikipedia.org/wiki/JAR_%28file_format%29)文件中，甚至可以作为[Web 应用程序](http://en.wikipedia.org/wiki/Web_application)的一部分部署到您最喜欢的应用程序服务器上。

首先，让我们定义`ChuckNorrisException`类，这样它就不会从一开始就崩溃 JVM（Chuck 真的很喜欢崩溃 JVM BTW :)

```
package chuck;

import java.io.PrintStream;
import java.io.PrintWriter;

public class ChuckNorrisException extends Exception {

    public ChuckNorrisException() {
    }

    @Override
    public Throwable getCause() {
        return null;
    }

    @Override
    public String getMessage() {
        return toString();
    }

    @Override
    public void printStackTrace(PrintWriter s) {
        super.printStackTrace(s);
    }

    @Override
    public void printStackTrace(PrintStream s) {
        super.printStackTrace(s);
    }
} 
```

现在去`Expendables`上课来构造它：

```
package chuck;

import javassist.*;

public class Expendables {

    private static Class clz;

    public static ChuckNorrisException getChuck() {
        try {
            if (clz == null) {
                ClassPool pool = ClassPool.getDefault();
                CtClass cc = pool.get("chuck.ChuckNorrisException");
                cc.setSuperclass(pool.get("java.lang.Object"));
                clz = cc.toClass();
            }
            return (ChuckNorrisException)clz.newInstance();
        } catch (Exception ex) {
            throw new RuntimeException(ex);
        }
    }
} 
```

最后是`Main`班级踢一些屁股：

```
package chuck;

public class Main {

    public void roundhouseKick() throws Exception {
        throw Expendables.getChuck();
    }

    public void foo() {
        try {
            roundhouseKick();
        } catch (Throwable ex) {
            System.out.println("Caught " + ex.toString());
        }
    }

    public static void main(String[] args) {
        try {
            System.out.println("before");
            new Main().foo();
            System.out.println("after");
        } finally {
            System.out.println("finally");
        }
    }
} 
```

使用以下命令编译并运行它：

```
java -Xverify:none -cp .:<path_to_javassist-3.9.0.GA.jar> chuck.Main 
```

您将获得以下输出：

```
before
finally 
```

毫不奇怪 - 毕竟这是一个回旋踢:)

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2012-12-14T20:55:14.863

在构造函数中，您可以启动一个重复调用的线程`originalThread.stop (ChuckNorisException.this)`

线程可以反复捕获异常，但会一直抛出异常，直到它死亡。

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2012-12-14T17:09:38.367

不可以。Java 中的所有异常都必须是子类`java.lang.Throwable`，尽管这可能不是一个好习惯，但您可以像这样捕获每种类型的异常：

```
try {
    //Stuff
} catch ( Throwable T ){
    //Doesn't matter what it was, I caught it.
} 
```

有关更多信息，请参阅[java.lang.Throwable](http://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html "可投掷的")文档。

如果您试图避免[检查异常](http://en.wikipedia.org/wiki/Exception_handling#Checked_exceptions)（必须显式处理的异常），那么您将希望继承 Error 或 RuntimeException。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2014-04-19T10:42:44.850

实际上接受的答案并不是那么好，因为Java需要在没有验证的情况下运行，即代码在正常情况下无法运行。

AspectJ 来拯救**真正的解决方案**！

**异常类：**

```
package de.scrum_master.app;

public class ChuckNorrisException extends RuntimeException {
    public ChuckNorrisException(String message) {
        super(message);
    }
} 
```

**方面：**

```
package de.scrum_master.aspect;

import de.scrum_master.app.ChuckNorrisException;

public aspect ChuckNorrisAspect {
    before(ChuckNorrisException chuck) : handler(*) && args(chuck) {
        System.out.println("Somebody is trying to catch Chuck Norris - LOL!");
        throw chuck;
    }
} 
```

**示例应用：**

```
package de.scrum_master.app;

public class Application {
    public static void main(String[] args) {
        catchAllMethod();
    }

    private static void catchAllMethod() {
        try {
            exceptionThrowingMethod();
        }
        catch (Throwable t) {
            System.out.println("Gotcha, " + t.getClass().getSimpleName() + "!");
        }
    }

    private static void exceptionThrowingMethod() {
        throw new ChuckNorrisException("Catch me if you can!");
    }
} 
```

**输出：**

```
Somebody is trying to catch Chuck Norris - LOL!
Exception in thread "main" de.scrum_master.app.ChuckNorrisException: Catch me if you can!
    at de.scrum_master.app.Application.exceptionThrowingMethod(Application.java:18)
    at de.scrum_master.app.Application.catchAllMethod(Application.java:10)
    at de.scrum_master.app.Application.main(Application.java:5) 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2012-12-22T08:32:20.403

该主题的一个变体是令人惊讶的事实，即您可以从 Java 代码中抛出未声明的检查异常。由于它没有在方法签名中声明，因此编译器不会让您自己捕获异常，尽管您可以将其捕获为 java.lang.Exception。

这是一个帮助类，它可以让你抛出任何东西，无论是否声明：

```
public class SneakyThrow {
  public static RuntimeException sneak(Throwable t) {
    throw SneakyThrow.<RuntimeException> throwGivenThrowable(t);
  }

  private static <T extends Throwable> RuntimeException throwGivenThrowable(Throwable t) throws T {
    throw (T) t;
  }
} 
```

现在`throw SneakyThrow.sneak(new ChuckNorrisException());`确实抛出了 ChuckNorrisException，但编译器抱怨

```
try {
  throw SneakyThrow.sneak(new ChuckNorrisException());
} catch (ChuckNorrisException e) {
} 
```

如果 ChuckNorrisException 是已检查的异常，则捕获未抛出的异常。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2012-12-18T08:19:17.127

`Is it possible to construct a snippet of code in java that would make a hypothetical java.lang.ChuckNorrisException uncatchable?`

是的，答案是：设计你的`java.lang.ChuckNorrisException`，使它不是`java.lang.Throwable`. 为什么？不可投掷的对象根据定义是不可捕获的，因为您永远无法捕获永远无法投掷的东西。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2012-12-15T12:01:31.087

Java 中唯一`ChuckNorrisException`的 s 应该是`OutOfMemoryError`and `StackOverflowError`。

您实际上可以“捕获”它们，即 a`catch(OutOfMemoryError ex)`将在抛出异常的情况下执行，但该块将自动将异常重新抛出给调用者。

我不认为这`public class ChuckNorrisError extends Error`有诀窍，但你可以试一试。我没有找到关于扩展的文档`Error`

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2012-12-15T04:39:23.933

您可以将 ChuckNorris 保持在内部或私密状态，然后封装他或吞下他……

`try { doChuckAction(); } catch(ChuckNorrisException cne) { /*do something else*/ }`

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2012-12-15T23:53:16.143

Java 中异常处理的两个基本问题是，它使用异常的类型来指示是否应该基于它采取行动，并且假定任何基于异常采取行动的事物（即“捕获”它）都可以解决基础条件。如果有一种方法可以让异常对象决定应该执行哪些处理程序，以及到目前为止已经执行的处理程序是否已经清理了足够的东西以使当前方法满足其退出条件，这将是有用的。虽然这可以用来产生“无法捕获”的异常，但两个更大的用途是（1）产生只有当它们被真正知道如何处理它们的代码捕获时才会被视为已处理的异常，`finally``FooException`在 a 展开期间的`finally`块期间`BarException`，两个异常都应向上传播调用堆栈；两者都应该是可捕获的，但应继续展开直到两者都被捕获）。不幸的是，我认为没有任何方法可以使现有的异常处理代码以这种方式工作而不破坏事物。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-01-09T00:37:23.377

很容易在当前线程上模拟未捕获的异常。这将触发未捕获异常的常规行为，从而在语义上完成工作。但是，它不一定会停止当前线程的执行，因为实际上没有抛出异常。

```
Throwable exception = /* ... */;
Thread currentThread = Thread.currentThread();
Thread.UncaughtExceptionHandler uncaughtExceptionHandler =
    currentThread.getUncaughtExceptionHandler();
uncaughtExceptionHandler.uncaughtException(currentThread, exception);
// May be reachable, depending on the uncaught exception handler. 
```

这在（非常罕见的）情况下实际上很有用，例如当需要正确`Error`处理时，但该方法是从捕获（并丢弃） any 的框架调用的`Throwable`。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-04-18T01:23:38.533

在 中调用 System.exit(1) `finalize`，然后从所有其他方法中抛出异常的副本，以便程序退出。*

# javascript - 怎么去掉onClick，以后再添加呢？

> ID：13883167
> 
> 赞同：1
> 
> 时间：2012-12-14T17:05:40.603
> 
> 标签：javascript, jquery, html

我需要一种方法来启用和禁用任何元素。禁用意味着将不透明度设置为 0.6 并删除 onClick 回调。启用含义将不透明度设置为 1 并再次添加回调。

我的前两次尝试惨遭失败，这些`callback` 方法只是堆叠起来，而不是在每次单击后运行一次，而是运行越来越多次。

```
function disableElement(element){
    var el = $('#'+element); 
    el.css('opacity','0.6');
    el.on('click',null);     //this doesn't work
            el.removeAttr('onClick'); // this doesn't help either.

}

function enableElement(element,callback){
    var el = $('#'+element); 
    el.css('opacity','1');
    el.on('click',callback);            
} 
```

然后我尝试使用 el.data：

```
disableElement:function(element){
        var el = $('#'+element); 
        el.css('opacity','0.6');
        el.data('element-enabled','false');
        //el.click(function (){
        //  alert('disabled');
        //});           
    },

    enableElement:function(element,callback){
        console.log('enabling');
        var el = $('#'+element);
        console.log(el);
        if(el.data('element-enabled') == "true")
            return;
        console.log("setOpacity");   
        el.css('opacity','1');
        el.data('element-enabled','true');
        el.click(function(){
            if(el.data('element-enabled') == "true")
                callback();
        }); 

    } 
```

现在它们不会堆叠，只要我不禁用它。如果我禁用然后再次启用它，它会被堆叠。这意味着，如果我多次运行 enableElement 回调不会堆叠。但是一旦我运行 disableElement 然后 enableElement，如果我点击该项目，它会发生两次。

能以某种方式实现吗？

**更新**

那很接近。关闭对我有用，但我还必须在 enableElement 上将其删除。有时我必须调用它两次，所以它仍然在堆叠。终于成功了，谢谢！

```
disableElement:function(element){
    var el = $('#'+element); 
    el.css('opacity','0.6');        
    el.off('click');

},

enableElement:function(element,callback){       
    var el = $('#'+element);
    el.off('click');                    
    el.css('opacity','1');      
    el.on('click',callback);    

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T17:06:51.240

要删除事件，只需使用`.off()`

```
el.off('click'); 
```

要重新添加事件，您可以这样做

```
el.on('click',callback); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T17:07:09.303

您需要使用`.off`as in `.off('click')`。这将删除该`click`类型的所有绑定事件。 [文档`.off`](http://api.jquery.com/off/)

请注意，如果您使用`.off`它不会返回事件或任何东西，并且您不能简单地重新绑定`.on`. 但是，由于您已在单独的函数中定义了回调，因此您可以重新绑定为`.on('click', function_name)`. 这只是需要注意的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T17:07:54.873

取消绑定将删除分配给某个事件的对象的所有处理程序：

```
$('#foo').unbind('click'); 
```

您还可以通过将其添加为第二个参数来将其设置为某些特定函数

```
$('#foo').unbind('click', myfunctionname); 
```

# mysql - 从 MySQL 中的每个“group by”类别中检索任意数量的随机行

> ID：13883170
> 
> 赞同：6
> 
> 时间：2012-12-14T17:05:42.707
> 
> 标签：mysql, select, random, group-by

我在 MySQL 中有一个包含列名的表`category`。我正在尝试编写一个查询，该查询将从每个返回 2 条随机记录`category`。

这是我用来从每个列中获取`category`最高值的2 条记录的代码`rating`：

```
SELECT e1.* 
FROM   entries AS e1 
WHERE  (SELECT Count(*) 
        FROM   entries AS e2 
        WHERE  e2.category = e1.category 
               AND e1.rating <= e2.rating) <= 2 
ORDER  BY category, 
          rating DESC 
```

查看此链接以查看包含一些示例数据和上述查询的表： [http ://sqlfiddle.com/#!9/bab8e/1](http://sqlfiddle.com/#!9/bab8e/1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:35:09.270

我通过按类别列和随机数对表格进行排序来实现您想要的结果。然后，我为每行分配一个递增的数字，每次类别更改时从 1 开始。然后，我只返回 rowNum 小于或等于 2 的结果。如果您想返回 3 个随机行，只需将其更改为小于或等于 3，依此类推。

```
SELECT entry_id, 
       category, 
       rating 
FROM   (SELECT @currank := IF(@category = category, @currank + 1, 1) AS rowNum, 
               @category := category                                 AS categoryVar, 
               e1.* 
        FROM   (SELECT *, 
                       (SELECT @currank := 0) r 
                FROM   entries 
                ORDER  BY category, 
                          Rand()) AS e1)AS e2 
WHERE  rownum <= 2 
ORDER  BY category, 
          rating; 
```

这是一个 sqlfiddle 链接，就像您在问题中发布的那样： [http ://sqlfiddle.com/#!9/bab8e/37/0](http://sqlfiddle.com/#!9/bab8e/37/0)

* * *

请注意，同样的查询可以很容易地调整为返回一组非随机的记录。例如，如果您想`rating`从每个返回前 5 个，`category`您可以更改

`ORDER BY category,rand()`

至

`ORDER BY category, rating DESC`

和改变

`WHERE rownum <= 2`
至

`WHERE rownum <= 5`

# php - 如何在 Disqus 中创建类别

> ID：13883173
> 
> 赞同：1
> 
> 时间：2012-12-14T17:06:02.127
> 
> 标签：php, disqus

我需要在 Disqus 中创建一些类别。我试图用 Javascript 来做，但它不能做，因为需要 POST 请求，但 JSONP 只适用于 GET 请求。之后，我尝试在服务器端使用 CURL，有我的代码

```
public function createDisqusCategory($title, $forum)
{
    $access_token = ACCESS_TOKEN;
    $secret_key = SECRET_KEY;
    $public_key = PUBLIC_KEY;

    $url = 'https://disqus.com/api/3.0/categories/create.json';
    $ch = curl_init($url);
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_HTTPHEADER,array('Content-Type: application/json'));
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_POSTFIELDS, "access_token=$access_token&api_secret=$secret_key&api_key=$public_key&forum=$forum&title=$title");
    $result = curl_exec($ch);
    curl_close($ch);
    return $result;
} 
```

它响应`{"code": 22, "response": "You do not have admin privileges on forum '...'"}`

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:50:44.020

您的应用程序是否将默认访问权限设置为“读取、写入和*管理论坛*”？如果没有，您需要在 POSTFIELDS 中添加“范围”参数，或者在应用程序设置中设置默认访问权限以管理论坛。这是我们关于范围的文档：http: [//disqus.com/api/docs/permissions/](http://disqus.com/api/docs/permissions/)

另一方面，Disqus 中的类别仅限于与 API 一起使用，因此除非您使用自定义脚本查询评论/线程，否则它在任何方面都没有用。如果你是，我还建议将其保持在最多 5 个类别，否则它会真正减慢查询速度。

# queue - 基于循环数组的队列

> ID：13883176
> 
> 赞同：0
> 
> 时间：2012-12-14T17:06:07.933
> 
> 标签：queue

我可以知道有没有办法从循环数组中的某个索引中取出一个项目？

示例想象这是一个圆形数组...

> > 1---2--3---4-5---6--7-8
> > |11|76|45|32|32|16|21|8|
> 
> 出列索引 3
> 
> > 1---2--3---4-5---6--7-8
> > |11|76|45|32|32|16|21|8|
> > 
> > 1---2--3---4-5---6--7-8
> > |11|76|EM|32|32|16|21|8|
> 
> EM 代表空。
> 
> 出列索引 8
> 
> > 1---2--3---4-5---6---7--8
> > |11|76|EM|32|32|16|21|EM|

有办法吗？还是我需要将它们全部转移到一起然后才能工作？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:52:37.500

在大多数编程语言中，当您想删除一个元素时，您必须移动所有后续元素。但是，大多数编程语言都没有提供像“循环数组”这样的概念。

如果使用链表而不是数组，则可以将出队之前的元素中的链接更改为指向后续元素（出队之后）。这适用于线性链表和循环链表。

# html - 为什么，确切地说，绝对定位从相对祖先继承？

> ID：13883179
> 
> 赞同：0
> 
> 时间：2012-12-14T17:06:11.080
> 
> 标签：html, css, position, positioning

这是[这个问题](https://stackoverflow.com/questions/6725754/why-does-absolute-positioning-within-container-require-container-to-be-relative)的几乎重复，但那里的答案似乎都没有真正解释这个的基本原理，这就是我真正想要的。

我知道绝对定位的元素会检查父系树，直到它们遇到具有绝对、固定或相对定位的东西，然后将自己 w/r/t 放置到该元素。

我的问题是：相对定位（相对于静态的，比如说）我错过了什么会使这变得直观？作为一个新手，从我（完全无知）的角度来看，这感觉非常武断，所以我渴望专家在这里提供帮助。声明某个元素相对的行为是否也使其成为 X，其中 X 是子项继承其右上角的合乎逻辑的东西？*没有设置top*、*right*、*bottom*或*left*的相对定位元素本质上是静态元素，还是在更深层次上是某种根本不同的动物？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:12:55.807

如果您阅读[规范](http://www.w3.org/TR/CSS21/visuren.html#propdef-position)，它是有道理的：

> 框的位置（可能还有大小）由“顶部”、“右侧”、“底部”和“左侧”属性指定。**这些属性指定相对于盒子的包含块的偏移量。**绝对定位的盒子从正常流程中取出。这意味着它们对后面的兄弟姐妹的布局没有影响。此外，尽管绝对定位的框有边距，但它们不会与任何其他边距一起折叠。

我在适当的部分添加了重点。绝对定位的元素被它们的*包含块偏移*

[包含块](http://www.w3.org/TR/CSS21/visuren.html#containing-block)指定：

> 在 CSS 2.1 中，许多框的位置和大小是相对于称为包含块的矩形框的边缘计算的。一般来说，生成的盒子充当后代盒子的包含块；我们说一个盒子为它的后代“建立”了包含块。短语“盒子的包含块”是指“盒子所在的包含块”，而不是它生成的那个。

相对位置建立了一个新*的包含块，*因此绝对定位在其中的任何东西都相对于它的包含块的左上角。

不幸的是，这并没有完全进入推理“为什么”......因为你必须挖掘 W3C 的会议记录才能找出（也许）。所以我们能给你的最好的答案是“规范是这样说的”。

# asp.net-mvc - 无法托管 Web 应用程序

> ID：13883181
> 
> 赞同：0
> 
> 时间：2012-12-14T17:06:13.143
> 
> 标签：asp.net-mvc, iis

1.  我在 Visual Studio 2010 中使用 mvc 3 创建了一个新的 Web 应用程序。我仍在使用 aspx 视图引擎。

2.  我已将文件（bin、内容、脚本、视图、global.asax、web.config）复制到 C:\inetpub\wwwroot -文件夹。我已经手动完成了，使用发布-> 文件系统（在 VS 中）和构建部署包（在 VS 中）

3.  我已将 iis 7.5（win 7 x64）中的应用程序池设置为 .net 4.0 和集成模式。

4.  我创建了一个新站点，它使用上面的文件夹 C:\inetpub\wwwroot 和应用程序池。

5.  我尝试运行该网站并得到以下信息： 6-i set permition for iis user

错误摘要 Internet Information Services 7.5 错误摘要 HTTP 错误 500.19 - 内部服务器错误 请求的页面无法访问，因为该页面的相关配置数据无效。详细错误信息模块 IIS Web Core Notification Unknown Handler Not yet determined Error Code 0x80070005 Config Error 由于权限不足，无法读取配置文件 Config File \?\C:\Inetpub\vhosts\n-clinic.ir\httpdocs\web.config

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:47:46.440

关于您的错误消息，我最关心的是该行

> 由于权限不足，无法读取配置文件

听起来像是网站目录权限的经典案例。尝试为“每个人”添加读/写访问权限。如果这样可以解决问题，请尝试找出实际使用的用户并相应地重新调整您的文件夹权限。

以下链接也可能有助于追查错误原因：http:

[//support.microsoft.com/kb/942055](http://support.microsoft.com/kb/942055)

# c# - 版本对象错误地比较了两个版本

> ID：13883184
> 
> 赞同：3
> 
> 时间：2012-12-14T17:06:41.723
> 
> 标签：c#, asp.net, .net, version, compareto

我正在使用 Version 对象来针对两个版本号运行 CompareTo 并在版本 >= versionA 时使 X 发生。

我的问题是，在下面的代码中，CompareTo 声明 VersionB 大于 VersionA。

```
Version versionA = new Version("2.12");
Version versionB = new Version("2.121");

switch (versionB.CompareTo(versionA))
                {
                    case 0: // Equal To
                        _doThis = true;
                        break;
                    case 1: // Greater Than
                        _doThat = true;
                        break;
                    case 2: // Less Than
                        _doNothing = true;
                        break;
                } 
```

此比较适用于案例 2。我正在使用正则表达式来匹配传递给该方法的固件版本，如您在此处看到的：

^\S+\s(?(\d+.*)+)\s*.*$

我将接受类似于“2.12 版”的内容，这个正则表达式将只留下“2.12”，然后将其初始化为一个版本对象。

任何人都知道为什么 .NET 告诉我 2.12 版比 2.121 版更新吗？

* * *

编辑：

我已将我的代码更改为如下：

```
Version versionA = new Version("2.12");
Version versionB = new Version("2.121");

if (versionB.CompareTo(versionA) >= 0)
{
     _doThis = true;
} 
```

它工作正常。现在，如果我将“2.11”与“2.121”进行比较，它也会返回 1。这个比较不应该返回 -1 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T17:28:12.723

Version 类为比较运算符提供了运算符重载，为什么不使用它们呢？它确实使代码的意图更加清晰。

这意味着你可以简单地写：

```
if(versionB >= versionA) {
  _doThis = true;
} 
```

对我来说，这比调用 CompareTo 并检查返回值的符号要清楚得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T17:26:23.040

Version.CompareTo(Version) 返回一个有符号整数

```
negative means it's before
zero the same
positive after. 
```

结果的幅度越大，版本之间的距离就越远。

摆脱开关，或先条件返回 compareto。

# apache - 如何将 Apache 配置为不记录某些 cookie？

> ID：13883190
> 
> 赞同：2
> 
> 时间：2012-12-14T17:06:58.700
> 
> 标签：apache

我有 Apache 作为代理运行，我想将 cookie 字符串记录为通过代理发出的请求的一部分，但我有一些我想排除的 cookie，因为它们包含敏感信息。

我知道 Apache mod_log_config 允许使用以下命令记录整个 cookie 字符串：

```
 %{Cookie}i 
```

我可以使用以下命令记录一个特定的 cookie：

```
 %{Foobar}C 
```

但我想记录*除*某些 cookie 之外的所有内容（如果存在）。我尝试的一种可能的策略是使用 SetEnvIf 与 %{FOO}e 结合使用，它会打印一个环境变量，例如：

```
 SetEnvIf = Cookie "(.*?)(Foobar=([^\s;]*;? ?))?(.*)" FILTERED_COOKIES=$1$4 
```

和

```
 %{FILTERED_COOKIES}e 
```

如果 Foobar 存在于 cookie 字符串中，这很有效，但如果 Foobar 不存在，如果只记录一个“-”，那么我不会得到所有其他 cookie。

我的正则表达式可能很差，但它似乎在匹配的情况下工作，但 Apache 在不匹配的情况下似乎没有正确处理它。

除了编写自定义 Apache mod，有没有办法排除 cookie 被记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-09T08:08:36.533

一种方法是使用多种日志格式。在您的主配置文件中：

```
SetEnvIf Cookie "(.*?)(Foobar=([^\s;]*;? ?))?(.*)" FILTERED_COOKIES=$1$4
LogFormat "%h %l %u %t \"%r\" %>s %b %{Cookie}i" common
LogFormat "%h %l %u %t \"%r\" %>s %b %{FILTERED_COOKIES}e" filtered 
```

然后在您的 VirtualHost 中，添加如下内容：

```
CustomLog logs/access_log filtered env=FILTERED_COOKIES
CustomLog logs/access_log common env=!FILTERED_COOKIES 
```

# r - R Project 和 MQL4 将 R 中的预测对象转换为向量

> ID：13883196
> 
> 赞同：4
> 
> 时间：2012-12-14T17:07:08.513
> 
> 标签：r, mql4, 7-bit

我在 R 中使用预测包，这会创建一个预测对象。

我想将预测转换为向量，以便我可以使用 7 位包装器并在 MQL4 代码中使用 R。

示例预测代码：

```
> forecast(fit, h=5)
     Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
1057       1.605098 1.602110 1.608087 1.600528 1.609668
1058       1.605109 1.600891 1.609327 1.598658 1.611561
1059       1.604868 1.599723 1.610012 1.597000 1.612735
1060       1.604978 1.599037 1.610919 1.595892 1.614065
1061       1.605162 1.598511 1.611813 1.594990 1.615335 
```

我希望能够以某种方式将这些预测、lo 80、hi 80 等存储在向量中，这样我就可以将它们从 R 中拉出并进入 MQL4 以用于指标。

我试过：

```
> test1 <- forecast(fit, h=5)
> test1
     Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
1057       1.605098 1.602110 1.608087 1.600528 1.609668
1058       1.605109 1.600891 1.609327 1.598658 1.611561
1059       1.604868 1.599723 1.610012 1.597000 1.612735
1060       1.604978 1.599037 1.610919 1.595892 1.614065
1061       1.605162 1.598511 1.611813 1.594990 1.615335 
```

但是，如果我尝试提取预测，我会得到：

```
> test1$Forecast
NULL 
```

如果我运行 head 结构显示为：

```
> head(test1)
$method
[1] "ARIMA(2,1,2)                   "

$model
Series: mt4test$close 
ARIMA(2,1,2)                    

Coefficients:
          ar1      ar2     ma1     ma2
      -0.5030  -0.9910  0.4993  0.9783
s.e.   0.0123   0.0089  0.0202  0.0140

sigma^2 estimated as 5.437e-06:  log likelihood=4897.31
AIC=-9784.61   AICc=-9784.55   BIC=-9759.81

$level
[1] 80 95

$mean
Time Series:
Start = 1057 
End = 1061 
Frequency = 1 
[1] 1.605098 1.605109 1.604868 1.604978 1.605162

$lower
          80%      95%
[1,] 1.602110 1.600528
[2,] 1.600891 1.598658
[3,] 1.599723 1.597000
[4,] 1.599037 1.595892
[5,] 1.598511 1.594990

$upper
          80%      95%
[1,] 1.608087 1.609668
[2,] 1.609327 1.611561
[3,] 1.610012 1.612735
[4,] 1.610919 1.614065
[5,] 1.611813 1.615335 
```

任何帮助，将不胜感激。它使我无法继续进行修补哈哈。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:25:19.450

函数`forecast()`产生列表。使用函数`str()`，您可以检查此对象的结构，并使用函数`names()`查看此列表中每个元素的名称。

```
library(forecast)
fit <- Arima(WWWusage,c(3,1,0))
test1<-forecast(fit)

names(test1)
[1] "method"    "model"     "level"     "mean"      "lower"     "upper"     "x"        
[8] "xname"     "fitted"    "residuals"

 #to extract forecast
test1$mean

Time Series:
Start = 101 
End = 110 
Frequency = 1 
 [1] 219.6608 219.2299 218.2766 217.3484 216.7633 216.3785 216.0062 215.6326 215.3175 215.0749

 #or as vector
as.vector(test1$mean)
 [1] 219.6608 219.2299 218.2766 217.3484 216.7633 216.3785 216.0062 215.6326 215.3175 215.0749

 #to extract upper interval
test1$upper

           80%      95%
 [1,] 223.5823 225.6582
 [2,] 228.5332 233.4581
 [3,] 232.7151 240.3585
 .... .... ....
[10,] 260.7719 284.9625

 #to extract lower interval
test1$lower

 #to extract only 95% upper interval
test1$upper[,2] 
```

# c++ - g++ (MinGW)、C++11 和 SSE

> ID：13883199
> 
> 赞同：2
> 
> 时间：2012-12-14T17:07:14.280
> 
> 标签：c++, gcc, c++11, mingw

当我尝试编译下一个简单的代码示例时：

```
echo "#include <cmath>" | g++ -x c++ -c - -m64 -mfpmath=both -std=gnu++11 -o /dev/null 
```

（与`-m64`选项一起被激活（默认情况下）使用**SSE**（比如**AVX**））。

出现以下错误消息：

```
In file included from <stdin>:1:0:
c:\mingw64\bin\../lib/gcc/x86_64-w64-mingw32/4.7.2/../../../../include/c++/4.7.2/cmath:1040:11: error: '::double_t' has not been declared
c:\mingw64\bin\../lib/gcc/x86_64-w64-mingw32/4.7.2/../../../../include/c++/4.7.2/cmath:1041:11: error: '::float_t' has not been declared 
```

这是一个错误吗？

如果没有`-mfpmath=both`选项，则不会发生错误。

我的解决方法是将`-D__FLT_EVAL_METHOD__=2`（`-Wp,-w`如果`-Werror`存在，因为“重新定义”警告）添加到**g++**的选项列表。我认为这是一种肮脏的方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T14:57:03.773

此错误是在 mingw-w64 主干上的错误提交。我为此写了一个错误报告。谢谢！

# php - 您如何使用 javascript 处理附加的 HTML ID？

> ID：13883200
> 
> 赞同：0
> 
> 时间：2012-12-14T17:07:14.250
> 
> 标签：php, javascript, html, wysiwyg, nicedit

这行 javascript 将 WYSIWYG 编辑器分配给具有 HTML ID 'description' 的元素。

```
 new nicEditor({fullPanel : true}).panelInstance('description') 
```

WYSIWYG 编辑器然后覆盖文本区域。

```
 <textarea 

   id="description[<?php echo $pid ?>]" 
   name="description[<?php echo $pid?>]" 

 </textarea> 
```

但是 ID 标签会在遍历所有描述时发生变化。描述的当前 $pid 附加到 ID 标签。（描述 1、描述 2 等）

您如何修改 javascript 以处理每个附加的 ID 名称？

```
new nicEditor({fullPanel : true}).panelInstance('description.???') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:13:37.750

niEditor 看起来不支持分配给类，您最好使用带有[选择器选项的](http://www.tinymce.com/wiki.php/Configuration%3aselector)[TinyMCE](http://www.tinymce.com/)并将相同的类分配给每个文本区域。

# javascript - 幻灯片 div。jQuery

> ID：13883201
> 
> 赞同：0
> 
> 时间：2012-12-14T17:07:15.733
> 
> 标签：javascript, jquery

我正在使用此代码将 div 从屏幕上滑出：

```
 $('.box').click(function() {

            $(this).animate({
                 left: '-50%'
             }, 500, function() {
            $(this).css('left', '150%');
            $(this).appendTo('#container');
            });

            $(this).next().animate({
                 left: '50%'
            }, 500);
       }); 
```

html:

```
 <div id="container">

     <div id="box1" class="box">Div #1</div>
     <div id="box2" class="box">Div #2</div>
     <div id="box3" class="box">Div #3</div>

      </div> 
```

css：.box {位置：绝对；左：150%；左边距：-25%；}

```
 #box1 {

         left: 50%;
       } 
```

它工作得很好。但是当我点击最后一个 div 时，第一个又回来了，我可以再次遍历所有 div。

我希望它在最后一个 div 出现时停止。你能给我一些关于我如何做到这一点的提示吗？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:09:05.220

我想你正在寻找[`.one()`](http://api.jquery.com/one/)

```
$('.box').one('click' , function() { 
```

此外，更好的做法是缓存重复出现的选择器以减少查询**DOM的次数**

```
$('.box').one('click', function() {
    var $this = $(this);
    if (this.id !== 'box3') {
        $this.animate({
            left: '-50%'
        }, 500, function() {
            $this.css('left', '150%');
            $this.appendTo('#container');
        });

        $this.next().animate({
            left: '50%'
        }, 500);
    }
});​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/mLBMf/2/)**

# c - gengetopt 和 Automake

> ID：13883202
> 
> 赞同：0
> 
> 时间：2012-12-14T17:07:22.990
> 
> 标签：c, autotools, automake, getopt

我试图在我的**Makefile.am文件中包含****cmdline.c**文件的生成（来自 gengetopt 的默认值）。

 **该文件当前如下所示：

```
bin_PROGRAMS = myprog

myprog_SOURCES = main.c cmdline.c
myprog_DEPENDENCIES = gen_cmdline $(myprog_SOURCES) # somewhere I read that setting DEPENDENCIES inhibits automake from calculating those

gen_cmdline:
    gengetopt < myprog.ggo 
```

但是，如果我只修改**myprog.ggo**，则**cmdline.c**及其所有依赖项都不会重新编译。我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T20:37:51.727

是`gen_cmdline`.PHONY 目标吗？如果`gengetopt`创建一个名为 的文件`cmdline.c`，那么您的 Makefile.am 应该如下所示：

```
bin_PROGRAMS = myprog

myprog_SOURCES = main.c cmdline.c
BUILT_SOURCES = cmdline.c
cmdline.c: myprog.ggo
    gengetopt < $(srcdir)/myprog.ggo 
```**

# ios - 带有类别的 iOS NSXMLParser 值，即。 在表格视图中

> ID：13883203
> 
> 赞同：0
> 
> 时间：2012-12-14T17:07:26.907
> 
> 标签：ios, xml, xml-parsing, tableview, xcode4.5

我有一个 XML，它将代表一个产品目录，其中每个产品都属于一个类别。IE：

```
<Product category="ABC">
 <Item_number>123</Item_number>
</Product>

<Product category="ABC">
 <Item_number>456</Item_number>
</Product>

<Product category="XYZ">
 <Item_number>789</Item_number>
</Product> 
```

我创建了一个类来存储数据，然后将一个实例放入数组中。* 然后将其显示到 tableview 上。目前，tableview 显示 Item_numbers 列表：D

我想要实现的是相同的，但我希望有 2 页。具有非重复（唯一）类别（即 ABC、XYZ）的主表视图，在第二页 - 详细表视图上，它将显示属于所选类别的 item_number。像这样 ..

主表视图：

```
ABC >
XYZ > 
```

详细表格视图（选择“ABC”）：

```
123
456 
```

(1) 最好的方法是什么？

(2) 我想我的第一个障碍是从“ABC”类别中解析出值

```
 <Product category="ABC"> 
```

在我的实现中，当我简单地调用时，我得到了空白（当 XML 中有一个类别时以某种方式解析一个值有点不同）

```
cell.textLabel.text = product.product; 
```

(3) 第二个是我如何存储数据（或者我可以保持相同的方法*），其中详细的 Tableview 页面可以由用户从第一页选择单个类别来引用。

* * *

didStartElement 的当前实现

```
- (void) parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict {
        if ( [elementName isEqualToString:@"Product"] ){
            self.currentProduct = [[Product alloc] init];
            self.storeCharacters = NO;
        } else  if ([elementName isEqualToString:@"Item_Number"]) {
            [self.currentString setString:@""];
            self.storeCharacters = YES;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:30:12.040

关于解析`category`，那是[`didStartElement`](http://developer.apple.com/library/ios/documentation/cocoa/reference/NSXMLParserDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/NSXMLParserDelegate/parser%3adidStartElement%3anamespaceURI%3aqualifiedName%3aattributes%3a)从`attributes`字典中检索的 when `elementName`is `@"Product"`。

就“最佳方法”而言，您只需要决定您的数据结构。我可能会建议构建一个 NSMutableArray，它是一个类别字典条目数组，每个类别一个，字典中的一个对象将是该类别中的一个产品数组。

一旦你有了这个结构，回答你的第三个问题可能是显而易见的。

* * *

好的，首先，您的 XML 确实需要一个外部标记，例如：

```
<Products>
    <Product category="ABC">
        <Item_number>123</Item_number>
        <Description>Coffee table</Description>
    </Product>

    <Product category="ABC">
        <Item_number>456</Item_number>
        <Description>Lamp shade</Description>
    </Product>

    <Product category="XYZ">
        <Item_number>789</Item_number>
        <Description>Orange chair</Description>
    </Product>
</Products> 
```

其次，假设您想要一个类别数组，并且对于每个类别，您想要一个产品数组，实现可能如下所示。首先，您需要一些属性，一个用于最终结果，另外两个用于解析期间使用的临时变量：

```
// this is our final result, an array of dictionaries for each categor

@property (nonatomic, strong) NSMutableArray *categories;

//  these are just temporary variables used during the parsing

@property (nonatomic, strong) NSMutableString *parserElementValue;
@property (nonatomic, strong) NSMutableDictionary *parserProduct; 
```

然后这些`NSXMLParserDelegate`方法可能如下所示：

```
#pragma mark - NSXMLParser delegate methods

- (void)parserDidStartDocument:(NSXMLParser *)parser
{
    self.categories = [NSMutableArray array];
}

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
{
    NSArray *subElementNames = @[@"Item_number", @"Description"];

    if ([elementName isEqualToString:@"Product"])
    {
        // get the name of the category attribute

        NSString *categoryName = [attributeDict objectForKey:@"category"];
        NSAssert(categoryName, @"no category found");

        // search our array of dictionaries of cateogries to see if we have one with a name equal to categoryName

        __block NSMutableDictionary *parserCurrentCategory = nil;
        [self.categories enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
            if ([categoryName isEqualToString:[obj objectForKey:@"name"]])
            {
                parserCurrentCategory = obj;
                *stop = YES;
            }
        }];

        // if we didn't find one, let's create one and add it to our array of cateogires

        if (!parserCurrentCategory)
        {
            parserCurrentCategory = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                    categoryName, @"name",
                                    [NSMutableArray array], @"items",
                                    nil];
            [self.categories addObject:parserCurrentCategory];
        }

        // Now let's add an entry to the items array for the product being added

        self.parserProduct = [NSMutableDictionary dictionary];
        [[parserCurrentCategory objectForKey:@"items"] addObject:self.parserProduct];
    }
    else if ([subElementNames containsObject:elementName])
    {
        self.parserElementValue = [NSMutableString string];
        [self.parserProduct setObject:self.parserElementValue forKey:elementName];
    }
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
{
    if (self.parserElementValue)
        [self.parserElementValue appendString:string];
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
{
    if ([elementName isEqualToString:@"Product"])
    {
        self.parserProduct = nil;
    }
    else if (self.parserElementValue)
    {
        self.parserElementValue = nil;
    }
}

- (void)parserDidEndDocument:(NSXMLParser *)parser
{
    // all done, do whatever you want, just as reloadData for your table

    NSLog(@"%s categories = %@", __FUNCTION__, self.categories);
}

- (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError
{
    NSLog(@"%s error=%@", __FUNCTION__, parseError);
} 
```

# javascript - jQuery $(document).ready 在 phpfox 中不起作用

> ID：13883207
> 
> 赞同：1
> 
> 时间：2012-12-14T17:07:36.370
> 
> 标签：javascript, jquery, dom, javascript-events, phpfox

我正在开发一个 PHPFox 模块，我在其中使用 jQuery 插件对一系列图像进行分页。当我访问模块时，插件不起作用，但其余的 js 代码没有问题。唯一不起作用的代码是放在*$(document).ready*事件中的代码。如果我刷新页面插件开始工作。

我认为问题是由 CMS 的缓存引起的，因为加载模块时没有重新加载 DOM。我试图将 de $(document).ready 更改为 window.onload 但我遇到了同样的问题。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T11:57:22.153

最后我找到了解决方案：

要在 phpfox 中加载 jQuery 函数，您必须使用传统和标准*$(document).ready的 sintax* *$Behaviour.onLoadEvents = function(){rest of the code} insted*

# extjs - Sencha 命令 + 错误评估 http://localhost/Production/app.js 并显示消息：TypeError: Cannot call method 'substring' of undefined

> ID：13883208
> 
> 赞同：2
> 
> 时间：2012-12-14T17:07:38.087
> 
> 标签：extjs, command, substring

我在这里试图找出如何解决这个小问题。

我一直在使用 Sencha Touch v2.1 来创建我所有的视图和东西。之后，我开始使用 Sencha Command v3.0.0.250 来提高我的应用程序的性能，但是在 Sencha C. 自己做生意并尝试打开 index.html（抛出 IIS）之后发生类似的事情。（使用铬）

“使用消息评估 http://localhost/Production/app.js 时出错：TypeError：无法调用未定义的方法‘子字符串’”

这是怎么回事？什么子字符串在谈论？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T10:49:25.223

确保您在控制台中没有看到任何警告消息，因为您必须`requires`在构建它之前添加您将使用的类。

# c# - 将 object[] 运行时转换为自定义类型数组

> ID：13883209
> 
> 赞同：1
> 
> 时间：2012-12-14T17:07:39.040
> 
> 标签：c#, reflection

我正在制作一个用于在 WPF 中定义对象的工具，以便可以将它们序列化为 JSON 以测试我们的 REST 服务。它使用反射将所有属性拉入 GUI，并根据输入生成 JSON。除了我定义的类型数组的属性之外，这对所有东西都非常有效。我正在使用该`object.InvokeMember()`方法来完成此操作。

问题是，您必须将对象数组作为参数传递给它。当它只是一件事时，它很好，但是当它是一个数组时，它会抛出一个异常，因为对象数组没有被强制转换为属性的类型。这很难解释。

一些代码：

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    object obj = new MyType();
    List<list<object>> list = new List<List<object>>();
    object[] ob = new object[] { list.ToArray() };
    obj.GetType().InvokeMember(
        "MyOtherTypes",
        BindingFlags.Instance | BindingFlags.Public | BindingFlags.SetProperty,
        Type.DefaultBinder,
        obj,
        ob);
    UpdateJson(obj);
}

public class MyType
{
    public MyOtherType[] MyOtherTypes { get; set; }
}

public class MyOtherType
{
    public int SomeProperty { get; set; }
} 
```

我相信读到这里的人都会感到困惑，所以请提出问题。

更多代码，修改非数组类型的示例。这部分工作正常：

```
object[] ob = new object[] { obj };
obj.GetType().InvokeMember(
    "SomePropertyThatIsNotAnArray", 
    BindingFlags.Instance | BindingFlags.Public | BindingFlags.SetProperty,
    Type.DefaultBinder, 
    obj, 
    ob);
UpdateJson(obj); 
```

一直在尝试这样的事情，但同样的交易，不能将 object[] 转换为 MyType[]

```
MethodInfo castMethod = this.GetType().GetMethod("Cast").MakeGenericMethod(
    obj.GetType().MakeArrayType());
object castedObject = castMethod.Invoke(
    null, 
    new object[] { list[someIndex].ToArray() });
obj.GetType().InvokeMember(
    "SomePropertyThatIsNotAnArray",
    BindingFlags.Instance | BindingFlags.Public | BindingFlags.SetProperty,
    Type.DefaultBinder, 
    obj, 
    castedObject);

public static T Cast<T>(object o)
{
    return (T)o;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:10:49.193

如果您的意思是将集合的每个元素都转换为对象，您可以使用 LINQ：

```
list.Cast<object>().ToArray(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:30:17.040

好像你只是做了太多的演员......任何`[]`都是`object`:)

将顶部代码更改为此...

```
 private void Button_Click(object sender, RoutedEventArgs e)
{
    object obj = new MyType();
    List<object> list = new List<object>();
    list.Add(obj);
    foreach (object o in obj in list){
    obj.GetType().InvokeMember(
        "MyOtherTypes",
        BindingFlags.Instance | BindingFlags.Public | BindingFlags.SetProperty,
        Type.DefaultBinder,
        obj,
        ob);
    UpdateJson(obj);
    }
} 
```

它真的需要一个`List`然后就这样做

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    object obj = new MyType();
    List<list<object>> list = new List<List<object>>();
    object ob = (object) list;
    obj.GetType().InvokeMember(
        "MyOtherTypes",
        BindingFlags.Instance | BindingFlags.Public | BindingFlags.SetProperty,
        Type.DefaultBinder,
        obj,
        ob);
    UpdateJson(obj);
} 
```

# .net - C#/C++ 中的 GC 和非托管代码

> ID：13883212
> 
> 赞同：1
> 
> 时间：2012-12-14T17:07:47.043
> 
> 标签：.net, c#-4.0, visual-c++, c++-cli

我有一个愚蠢的问题。如果我在 C++ 中有一个数组，我用它来存储对各种 C# 对象的许多引用（我猜是 IntPtrs，还没有那么远），C# 中的 GC 怎么知道不收集这些对象? 我的意思是，标记和扫描算法无法看到非托管代码结构，对吧？那么，如果对这些 C# 对象的唯一引用在这个结构中，我是否不需要做一些额外的事情来告诉 GC 不要收集它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:12:28.810

是的，您必须特别注意确保您的对象不仅保持活动状态并且不受 GC 影响，而且还没有被 GC 移动。

看看： [http ://dotnet.dzone.com/news/net-memory-control-use-gchandl](http://dotnet.dzone.com/news/net-memory-control-use-gchandl)

# jquery-ui - 如何以编程方式调用 jQuery UI Draggable 拖动开始？

> ID：13883214
> 
> 赞同：26
> 
> 时间：2012-12-14T17:07:53.550
> 
> 标签：jquery-ui, jquery, jquery-ui-draggable

在鼠标处于向下位置之后和释放之前，我创建了一个新的 jQuery 元素。（鼠标按下后）。

我想`dragging`使用 jQuery UI 以编程方式触发新元素，以便它会随着我的鼠标移动自动开始拖动。我不想释放然后再次单击鼠标。

我尝试了以下...

```
var element = $("<div />");
element.appendTo("body").draggable().trigger("mousedown"); 
```

...但是这不起作用。

有没有人对如何做到这一点有任何建议？

* * *

**更新：经过一番搜索后，**[这个问题](https://stackoverflow.com/questions/8759884/jquery-how-to-fire-the-drag-event-while-mouse-is-still-down) 的海报也有同样的问题。但是，建议的解决方案归结为...

```
$("body").on("mousedown", function(e) { 
  $("<div />").draggable().appendTo("body").trigger(e);
}); 
```

...不再在最新版本的 jQuery 和 jQuery-UI 中工作，而是生成最大调用堆栈超出错误。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-07-02T05:27:52.767

可拖动插件期望其 mousedown 事件使用其命名空间并指向可拖动对象作为目标。在事件中修改这些字段适用于 jQuery 1.8.3 和 jQuery UI 1.9.2。

```
$("body").on("mousedown", function(e) { 
  var div = $("<div />").draggable().appendTo("body");
  e.type = "mousedown.draggable";
  e.target = div[0];
  div.trigger(e);
}); 
```

在这里演示：http: [//jsfiddle.net/maCmB/1/](http://jsfiddle.net/maCmB/1/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-09-26T20:41:26.840

### 更新：

请参阅[下面的模糊BSc 答案](https://stackoverflow.com/a/24523473/4019986)。这是执行此操作的正确方法。

* * *

这完全是一个hack，但它似乎可以解决问题：

```
 var myDraggable = $('#mydraggable').draggable();

  // Yeah... we're going to hack the widget
  var widget = myDraggable.data('ui-draggable');
  var clickEvent = null;

  myDraggable.click(function(event){
      if(!clickEvent){
        widget._mouseStart(event);
        clickEvent = event;
      }
      else {
        widget._mouseUp(event);
        clickEvent = null;
      }
    });

  $(document).mousemove(function(event){
    console.log(event);
    if(clickEvent){
      // We need to set this to our own clickEvent, otherwise
      // it won't position correctly.
      widget._mouseDownEvent = clickEvent;
      widget._mouseMove(event);
    }
  }); 
```

[这是笨蛋](http://plnkr.co/edit/SO2AFVRXvN0NWbrzCUP1)

我的示例使用了一个已经存在的元素而不是创建一个元素，但它应该类似地工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-15T15:59:19.483

在鼠标悬停时创建您的可拖动功能

```
$('#futureDragableElement').mouseover(function() {
  $(this).draggable();
}); 
```

由于可拖动初始化已经完成，您的第一次鼠标点击将被考虑在内

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-14T17:13:39.817

您必须将 mousedown 事件绑定到相关元素，然后才能触发该事件。

来自[http://api.jquery.com/trigger/](http://api.jquery.com/trigger/)

> 当相应的事件发生时，任何附加了 .bind() 或其快捷方法的事件处理程序都会被触发。但是，可以使用 .trigger() 方法手动触发它们。对 .trigger() 的调用以与用户自然触发事件相同的顺序执行处理程序：

```
$('#foo').bind('click', function() {
      alert($(this).text());
    });
    $('#foo').trigger('click'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-15T06:48:26.937

如果您在活动期间创建元素并且该元素不太复杂，则不需要黑客。您可以简单地将draggable 设置为发生mousedown 的元素，并使用draggable 辅助属性来创建一个将成为您的新元素的辅助。在 dragStop 上，将助手克隆到 dom 中您想要的位置。

```
$('body').draggable({
  helper: function() {
    return '<div>your newly created element being dragged</div>';
  },
  stop: function (e,ui) {
    ui.helper.clone().appendTo('body');
  }
}); 
```

当然你需要为助手设置位置，所以鼠标就在上面。这只是一个非常基本的例子。

# zend-framework - 如何通过 Zend 中的路由阻止目标 URL？

> ID：13883219
> 
> 赞同：2
> 
> 时间：2012-12-14T17:08:09.757
> 
> 标签：zend-framework, routing, seo, action, router

我在 Zend 中有一个基本的路由，例如：

*   url -> /faq（控制器常见问题，默认操作索引）
*   url -> /faq/index（控制器常见问题，操作索引）

这个 url 应该有相同的内容，一个重复的内容 (SEO)，我想阻止 url /faq/index 并抛出 404。

如果有人知道该怎么做... THX ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T08:42:08.997

您总是可以执行以下操作：

```
public function preDispatch()
{
if ($this->_request->getActionName() == 'index') {
            throw new Zend_Controller_Action_Exception;
        }
} 
```

但这总是取决于情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T11:06:01.837

你也可以使用路由器（[Zend_Controller_Front](http://framework.zend.com/manual/1.12/en/zend.controller.front.html)）：

```
// add to your Route file
    $Router = Zend_Controller_Front::getInstance()->getRouter(); 
    $Router->addRoute('frotendPage', new Zend_Controller_Router_Route_Static(
       '/faq', array(
          'module' => 'frontend',
          'controller' => 'page',
          'action' => 'faq')
     )); 
```

# .htaccess - 在文件夹内使用 .htaccess 进行重定向

> ID：13883223
> 
> 赞同：0
> 
> 时间：2012-12-14T17:08:26.603
> 
> 标签：.htaccess

我对 .htaccess 的 url 有疑问。我需要所有的网址，例如： http: [//mywebsite.com/api/something](http://mywebsite.com/api/something)转到我的 api/index.php 因为我需要从这个地方编写一个路由系统。.htacces 必须在 api/ 文件夹内。

我在这里尝试做的是一个路由系统，它根据使用的 url 在 api/index.page 中包含不同的内容。

例如，如果我去[http://mywebsite.com/api/activity](http://mywebsite.com/api/activity)我想包含一个特定文件而不更改 url。

你认为有可能吗？你知道 .htaccess 的内容吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T10:16:07.770

我终于自己找到了解决方案，所以我发布了解决方案，以后可能会对其他人有所帮助：

```
<IfModule mod_rewrite.c>
RewriteEngine on
RewriteRule (.*) index.php [PT,QSA]
</IfModule> 
```

# ios - for 语句 xcode 中的更多表达式

> ID：13883224
> 
> 赞同：-1
> 
> 时间：2012-12-14T17:08:35.193
> 
> 标签：ios, xcode

我想在 for 语句中包含更多语句。现在我这样做：

```
for (UIImageView* img in imageArray){
for (UITextField* txt in messagename){

}} 
```

...但是以这种方式它多次重复代码，所以我尝试了这个：

```
for (UIImageView* img in imageArray)||(UITextField* txt in messagename) 
```

但它不起作用！

编辑：

```
for (UIImageView* img in imageArray)||(UITextField* txt in messagename) {

    img.hidden = YES;

    CABasicAnimation* anim = [CABasicAnimation animationWithKeyPath:@"transform.rotation"];
    [anim setToValue:[NSNumber numberWithFloat:0.0f]];
    [anim setFromValue:[NSNumber numberWithDouble:M_PI/80]]; // rotation angle
    [anim setDuration:0.1];
    [anim setRepeatCount:NSUIntegerMax];
    [anim setAutoreverses:YES];
    //[img.layer addAnimation:anim forKey:@"iconShake"];

    UIImage *tmpImage = [UIImage imageNamed:@"message small type 2.png"];
    CGRect cellRectangle;
    cellRectangle = CGRectMake(20, img.frame.origin.y + 45, 710, 60);
    UIImageView *dragger = [[Draggable alloc] initWithFrame:cellRectangle];
    [dragger setImage:tmpImage];
    [dragger setUserInteractionEnabled:YES];

    [self.view addSubview:dragger];

    [wobbleImage addObject: dragger];

    Draggable* sharedSingleton = [Draggable sharedManagerDraggable];
    sharedSingleton.namePassedToDraggable = txt.text;

    dragger.tag = img.tag;

    dragger.layer.cornerRadius = 10; // this value vary as per your desire
    dragger.clipsToBounds = YES;

    [dragger.layer addAnimation:anim forKey:@"iconShake"];

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:17:28.387

如果两个数组总是有相同数量的对象，那么您可能想要的是：

```
NSUInteger count = imageArray.count;
for (NSUInteger i = 0; i < count; i++) {
    UIImageView *img = imageArray[i];
    UITextField *txt = messagename[i];

    // rest of code
} 
```

# javascript - 将函数绑定到按钮数组元素的事件“onclick”

> ID：13883225
> 
> 赞同：1
> 
> 时间：2012-12-14T17:08:34.893
> 
> 标签：javascript, jquery, function, onclick

序言：我是意大利人，对不起我的英语不好。

这是我的问题：

我想为一组按钮分配一个功能。

我需要向函数发送一个参数。

这是我尝试过的代码：

```
function test(atxt) {
    var buttons = $('.tblButton');

    for (var i = 0; i < buttons.length; i++) {
        buttons[i].onClick(sayHello(atxt));
    }
}

function sayHello(txt){alert('hello' + txt)}; 
```

...收到以下错误：

```
Uncaught TypeError: Object #<HTMLButtonElement> has no method 'onClick' 
```

你能告诉我哪里出错了，我该如何解决？

编辑：我需要迭代，因为我需要按钮的 'id 作为函数的参数，所以我需要做`buttons[i].onClick(sayHello(buttons[i].id))`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T17:10:28.060

```
buttons[i].onClick(sayHello(atxt)); 
```

应该是

```
$(buttons[i]).on('click', function() { sayHello(atxt) }); 
```

如果您想获取**当前按钮 ID**，那么我认为您正在寻找这个..

```
for (var i = 0; i < buttons.length; i++) {
     $(buttons[i]).on('click', function() { sayHello(this.id) });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:40:52.927

如果要遍历所有按钮，则必须使用`.each()`jquery 的处理程序：

```
$(function(){
  $(".tblButton").each(function () {
    $(this).click(function(){
       alert($(this).attr('id'));
    }); 
  });
}); 
```

签出 jsbin：http: **[//jsbin.com/usideg/1/edit](http://jsbin.com/usideg/1/edit)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:16:08.323

这对您的示例不起作用：您是否有其他迭代原因？

```
function test(atxt) {
    $('.tblButton').on('click',function(){sayHello(atxt);});
}

function sayHello(txt){alert('hello' + txt)}; 
```

或者，如果元素是静态的并且存在，则可选：

```
function test(atxt) {
    $('.tblButton').click(function(){sayHello(atxt);});
}

function sayHello(txt){alert('hello' + txt)}; 
```

替代方法：只需更改为这种样式：

```
var txt = "fred";
var atext = "hello" + txt;

function sayHello(atext) {
    alert(atext);
}
$('.tblButton').on('click', function() {
    sayHello(atext);
});
//below here just to demonstrate
$('.tblButton').eq(0).click();//fires with the fred
txt = "Johnny";// new text
atext = 'hello' + txt;
$('.tblButton').eq(1).click();//fires the Johnny 
```

看到它在这里工作：http: [//jsfiddle.net/dFBMm/](http://jsfiddle.net/dFBMm/)

所以根据你的笔记：这个标记和代码：

```
<button class="tblButton" id="Ruth">Hi</button>
<button class="tblButton" id="Betty">Hi again</button>

$('.tblButton').on('click', function() {
    alert("Hello "+$(this).attr("id"));
});
$('.tblButton').eq(0).click();//fires with the Ruth
$('.tblButton').eq(1).click();//fires the Betty 
```

[http://jsfiddle.net/dFBMm/1/](http://jsfiddle.net/dFBMm/1/)

# javascript - IE8 不支持 extjs4 中的斜体标签

> ID：13883229
> 
> 赞同：0
> 
> 时间：2012-12-14T17:08:46.277
> 
> 标签：javascript, extjs, extjs4, extjs4.1, extjs3

我正在尝试使我的字体斜体。它适用于除 IE8 之外的所有浏览器。是否有解决此问题的方法？这是jsfddle：

```
 {
                xtype: 'text',
                padding: '64 0 0 0',    
                text: "Logged in as:",
                textAlign:'left',
                style : "color:#3E546B;font-style:italic;font-size: 11px;",
                width: 140
            } 
```

[http://jsfiddle.net/YeyET/1/](http://jsfiddle.net/YeyET/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:29:07.277

我认为您真正需要的不是文本，而是显示字段。

这在 IE、Chrome 和 FF 中运行良好：

```
{
    xtype: 'displayfield',
    padding: '64 0 0 0', 
    fieldLabel:  'Logged in as:',                  
    value: 'Lucas',
    textAlign:'left',
    labelCls: 'ital',
    width: 140
} 
```

看看它在 jsfiddle.net 中的样子：http: [//jsfiddle.net/lontivero/YeyET/6/](http://jsfiddle.net/lontivero/YeyET/6/)

# c++ - Serendipity 书商软件程序 C++

> ID：13883230
> 
> 赞同：1
> 
> 时间：2012-12-14T17:08:48.803
> 
> 标签：c++

这是我正在从事的一个项目，它来自我用来学习 C++ 的书——“从 C++ 开始”。我目前对项目的收银部分有疑问。它要求用户输入图书的日期、数量、isbn、书名和价格。然后，它会询问用户是否希望输入另一本书。无论他们键入“y”还是“n”，它都会继续到程序的下一部分。我真的不知道为什么在我输入“y”进入另一本书后for循环不重复。此外，日期在显示时最后会出现垃圾，这是我需要修复的另一件事。任何帮助，将不胜感激。肯定有更多问题，但主要问题在于第一个 for 循环中的收银员功能。我没有'

```
/*
 *  mainmenu.cpp
 *  Serendipity Booksellers software
 *
 *  Created by Abraham Quilca on 9/5/12.
 *  Copyright 2012 __MyCompanyName__. All rights reserved.
 *
 */

#include<iostream>
#include<iomanip>
#include<cstring>
#include"mainmenu.h"
using namespace std;

char bookTitle[20][51],
 isbn[20][14],
 author[20][31],
 publisher[20][31],
 dateAdded[20][11];
int qtyOnHand[20];
double wholesale[20];
double retail[20];;

int main()
{
    int choice;

do
{
    cout << "\t\t   Serendipity Booksellers"<< endl;
    cout << "\t\t\t  Main Menu" << endl << endl;
    cout << "\t\t1\. Cashier Module" << endl;
    cout << "\t\t2\. Inventory Database Module" << endl;
    cout << "\t\t3\. Report Module" << endl;
    cout << "\t\t4\. Exit" << endl << endl;
    cout << "\t\tEnter your choice: ";
    cin >> choice;
    cout << endl;
    switch (choice)
    {
        case 1:
            cashier();
            break;
        case 2:
            invmenu();
            break;
        case 3:
            reports();
            break;
        case 4:
            continue;
            break;
        default:
            cout << "\t\tPlease enter a number in the range 1-4." << endl << endl;
    }
}   
while(choice != 4);
cout << "\t\tYou selected item 4." << endl;
return 0;
}

// Cashier function

void cashier()
{
    char again;
    char date[8];
    int quantity[20] = {0};
    char ISBN[20][20] = {0};
    char title[20][40] = {0};
    float price[20] = {0}, bookTotal[20] = {0}, subtotal, total, tax;
    const float tax_rate = .06;

    cout << "Serendipity Booksellers" << endl;
    cout << " Cashier Module" << endl << endl;

    for(int count = 0; count < 20; count++)
    {
        cout << "Date: ";
        cin >> date;
        cout << "Quantity of Book: ";
        cin >> quantity[count];
        cout << "ISBN: ";
        cin >> ISBN[count];
        cout << "Title: ";
        cin.ignore();
        cin.getline(title[count], 40);
        cout << "Price: ";
        cin >> price[count];
        bookTotal[count] = quantity[count] * price[count];
        subtotal += price[count];
        cout << "Would you like to enter another book? (Y/N) ";
        cin >> again;
        if(again == 'N' || 'n')
            count = 21; // This line will end the for loop
    }
    // Calculating tax and total
    tax = subtotal * tax_rate;
    total = subtotal + tax;

    cout << "\n\nSerendipity Booksellers" << endl << endl;
    cout << "Date:" << date << endl << endl;
    cout << "Qty\t ISBN\t\t "
        << left << setw(40) << "Title" << "Price\t Total" << endl
        <<     "-------------------------------------------------------------------------------"
        << endl << endl;
    for(int count = 0; count < 20; count++)
    {
        cout << quantity[count] << "\t " << ISBN[count] << "   " << left << setw(40) << title[count] 
        << setprecision(2) << fixed << "$" << setw(6) << price[count] << " $" << setw(6) << bookTotal[count]
        << endl << endl;
    }
    cout << "\t\t\t Subtotal" << "\t\t\t\t         $" << setw(6) << subtotal << endl;
    cout << "\t\t\t Tax" << "\t\t\t\t                 $" << setw(6) << tax<< endl;
    cout << "\t\t\t Total" "\t\t\t\t                 $" << setw(6) << total << endl << endl;
    cout << "Thank You for Shopping at Serendipity!" << endl << endl;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:11:13.613

```
if(again == 'N' || 'n') 
```

这并不像你认为的那样。像这样看：

```
if((again == 'N') || ('n')) 
```

是`again == N`真的还是`n`真的？Well`n`永远是真的（它是一个`char`非零值），所以你的循环总是会立即结束。你想要的是：

```
if(again == 'N' || again == 'n') 
```

`break`此外，您可以使用恰当命名的关键字跳出循环：

```
if (again == 'N' || again == 'n') {
  break;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:12:48.460

循环的问题是这一行：

```
 if(again == 'N' || 'n') 
```

C++ 不知道您的意思是要检查`again`这两个字符。相反，它尝试`again == 'N'`失败，然后尝试`'n'`，它 - 不为零 - 评估为真。

相反，请尝试：

```
if (again == 'N' || again == 'n')
  break; 
```

# balanced-payments - 如何最好地计算市场中的销售税（即，有多个卖家）？

> ID：13883242
> 
> 赞同：3
> 
> 时间：2012-12-14T17:09:28.627
> 
> 标签：balanced-payments

我们为多个卖家处理订单（典型的“市场”场景）。是否有 API 或服务可以为我们的用例正确计算销售税？

我只想提供卖家（1 个或多个）的位置和买家的位置，并获得正确的税率以评估相应的行项目。

我评估过的大多数产品（TaxCloud 就是其中之一）似乎在这个用例中失败了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:05:12.817

我正在为单一卖家和多买家的情况实施 TaxCloud 解决方案。您可以利用 TaxCloud 来确定税费，方法是为市场中的每个卖家创建一个帐户，为每个卖家配置关联，然后使用适当的 API 密钥/ID 对来根据卖家查找商品的税费。

不幸的是，这意味着如果购物车中有来自多个卖家的商品，您将不得不拨打多个电话。

# ant - Ant 构建文件为 selenium 测试用例生成 JAR 并运行它

> ID：13883248
> 
> 赞同：0
> 
> 时间：2012-12-14T17:09:57.197
> 
> 标签：ant, jar, junit, automation, selenium-rc

我有一个使用 Junit 框架的 selenium 自动化测试项目。现在我正在使用 ant 构建文件来编译项目并运行它并生成报告。

该项目有我正在从 ant 构建文件执行的测试套件，即：TestSuite1 TestSuite2 TestSuite3 等等。

但是，我想要的是将此项目转换为 JAR 文件并一一运行 JAR 文件中的测试套件。

目的是我可以创建项目的 JAR 文件并将 JAR 文件提供给客户端，以便不再需要编译项目，并且客户端直接从 JAR 文件执行测试套件，系统上只有 JRE 和客户端不需要 JDK。

我需要知道如何制作两个构建文件：

1) 构建项目并将其转换为 JAR。我将使用它来构建 JAr 文件。

2) 提供给客户端的构建文件，它只会执行 JAR 文件并收集报告。

我正在使用 JUnit 框架。

免责声明：我是蚂蚁新手...... :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T12:19:22.920

我想这与硒无关，而是与项目的建设有关。

1）Ant 今天有点过时了，你应该看看 Maven（特别是如果你是 ant 新手）。它是更新、更强大的集成和构建工具。您将能够使用它轻松生成 jar 文件。您还将对[selenium maven 插件](http://mojo.codehaus.org/selenium-maven-plugin/)感兴趣，它将为您启动 Selenium 服务器。

2）我想你的测试套件是 JUnit 测试。为了能够使用 JRE 从 jar 中运行它，您需要在某个类中创建“public static void main(String[] args)”方法以使其可运行。您将从这里运行您的 Selenium 客户端实例。您还需要从这里启动 Selenium 服务器，它也应该作为库打包到您的 jar 中。

# sql - 使用 Group By 子句进行自加入得到“Invalid Identifier”错误

> ID：13883249
> 
> 赞同：0
> 
> 时间：2012-12-14T17:09:57.073
> 
> 标签：sql, group-by, self-join

我正在尝试整理一个`Self Join`using`Group By`子句，以查看哪个人在各自的工作中获得最高的报酬，但我不断收到此错误 `00904\. 00000 - "%s: invalid identifier"`

以下是我目前正在尝试修复的代码：

```
Select a.*,b.sal
From EMP a,(Select job,MAX(sal)
            From EMP
            Group By job) b
Where a.empno = b.empno 
```

我做了一些研究，但找不到任何与我正在做的事情有关的东西（也许是因为我正在做的事情太简单了？），但我仍在寻找任何能够为我指明正确方向的东西。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:13:07.153

您没有`empno`在子查询中返回的名为的列。我认为您想要这样的东西，它将`max(sal)`根据工作为每个员工返回：

```
Select a.*, b.sal
From EMP a
inner join
(
  Select job, MAX(sal) sal
  From emp
  Group By job
) c
   on a.job = b.job 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T17:13:38.353

试试这个：

```
Select a.*
From EMP a
INNER JOIN
( 
   Select job, MAX(sal) MaxSal
   From EMP
   Group By job
) b ON a.job = b.job AND a.sal = b.MaxSal 
```

# excel - Excel VBA，工作表中的代码不起作用

> ID：13883255
> 
> 赞同：3
> 
> 时间：2012-12-14T17:10:18.910
> 
> 标签：excel, vba, worksheet

我在 sheet1 中有以下代码（注意 - 此代码在 woksheet 对象中，而不是工作簿对象或模块中）：

```
Private Sub Worksheet_Change(ByVal Target As Range)
Dim r As Integer
r = ActiveCell.Row
Cells(r - 1, 7).Value = Now()
ActiveWorkbook.save
End Sub 
```

有人可以告诉我为什么： 1\. ActiveWorkbook.save 在上面不起作用 - 它会陷入无限循环；2\. 为什么我不能按 F8 单步执行代码

我试图将 ActiveWorkbook.save 放在一个单独的模块中，然后从工作表中的代码中调用该函数，但这也陷入了无限循环。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:20:59.203

您需要禁用事件以避免无限循环

```
Private Sub Worksheet_Change(ByVal Target As Range)
application.enableevents=false
    Cells(target.row - 1, 7).Value = Now()
application.enableevents=true

ActiveWorkbook.save
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:23:01.193

导致无限循环是因为当您使用当前日期更新单元格时，这会导致工作表更改事件再次调用事件代码。您需要禁用事件，如下所示：

```
Private Sub Worksheet_Change(ByVal Target As Range)

Dim r As Integer
r = ActiveCell.Row

Application.EnableEvents = False    
Cells(r - 1, 7).Value = Now()    
Application.EnableEvents = True    
ActiveWorkbook.Save

End Sub 
```

# python - 当这个字符串的行尾有数字时，为什么这个正则表达式不排除该行

> ID：13883257
> 
> 赞同：1
> 
> 时间：2012-12-14T17:10:29.553
> 
> 标签：python, regex

我正在尝试扫描文档并确定文档各部分的开始和结束位置。有时，文档有一个目录，其中列出了我不想捕获 TOC 的页码，因为它不能识别文档的一部分。我已经搞砸了一段时间，并且被困在了一些事情上。我似乎无法避免使用行号从目录中捕获行

这是正则表达式

```
verbose_item_pattern_3 = re.compile(r"""
  ^            # begin match at newline
  \t*          # 0-or-more tabspace
  [ ]*         # 0-or-more blank space
  I            # a capital I
  [tT][eE][mM] # one character from each of the three sets this allows for unknown case
  \t*          # 0-or-more tabspace
  [ ]*         # 0-or-more blankspace
  \d{1,2}      # 1-or-2 digits
  [.]?         # 0-or-1 literal .
  \(?          # 0-or-1 literal open paren
  [a-e]?       # 0-or-1 letter in the range a-e
  \)?          # 0-or-1 closing paren
  .*           # any number of unknown characters so we can have words and punctuation
  [^0-9]       # anything but [0-9]
  $           # 1 newline character
  """, re.VERBOSE|re.MULTILINE) 
```

这是我不想捕获的行的示例

```
test_string='\nItem 6\.       TITLE ITEM 6..................................................25\n' 
```

这是我想要捕捉的一个例子

```
test_string='\nItem 6\.       TITLE ITEM 6 maybe other words here who knows  \n' 
```

但是当我跑步时

```
re.findall(verbose_item_pattern_3,test_string) 
```

结果是

```
['Item 6\.       TITLE ITEM 6..................................................25\n'] 
```

现在对我来说有趣的是，如果我的测试字符串是这个

```
test_string='PART I\nItem 1\.       TITLE ITEM 1...................................................1\nItem 2\.       TITLE ITEM 2..................................................21\n' 
```

并使用 re.findall(verbose_item_pattern_3,test_string) 运行它

结果更接近我想要的但仍然不正确

```
['Item 2\.       TITLE ITEM 2..................................................21\n'] 
```

不应该有任何东西被捕获

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:25:24.267

您的正则表达式匹配是因为三件事。

1.  大部分都是可选的，所以非常不具体
2.  有一个`.*`吃掉整条线，所以你的最后一个条件`[^0-9]`永远不会出现，那是因为：
3.  换行符本身*满足* `[^0-9]`，因此`[^0-9]`即使该行以数字结尾，也可以成功匹配。

最小的变化是在最后使用负面的后视：

```
verbose_item_pattern_3 = re.compile(r"""
  ^            # start-of-line
  \t*          # 0-or-more tabspace
  [ ]*         # 0-or-more blank space
  I            # a capital I
  [tT][eE][mM] # one character from each of the three sets this allows for unknown case
  \t*          # 0-or-more tabspace
  [ ]*         # 0-or-more blankspace
  \d{1,2}      # 1-or-2 digits
  [.]?         # 0-or-1 literal .
  \(?          # 0-or-1 literal open paren
  [a-e]?       # 0-or-1 letter in the range a-e
  \)?          # 0-or-1 closing paren
  .*           # any number of unknown characters so we can have words and punctuation
  $            # end-of-line
  (?<![0-9])   # NOT preceded by a decimal digit (via look-behind)
  """, re.VERBOSE|re.MULTILINE) 
```

请注意，两者`^`都不是`$`实际匹配换行符。它们匹配( )*之后*`^`的位置或( ) 换行符*之前的位置。*`$`换行符本身绝不是匹配的一部分。

出于这个原因，`start-of-line`我已将他们的评论更改为更准确。`end-of-line`

另请注意，即使在`$`. 这样做有助于防止回溯，使正则表达式更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T17:25:34.860

如果我理解正确，您希望您的示例字符串不匹配，因为该行中的最后一个字符是一个数字，并且您的正则表达式以`[^0-9]$`.

这行为不正确的原因是它`$`会在 a 之前匹配`\n`，但也会在字符串的最后匹配。这里最终发生的是`.*`匹配数字，然后`[^0-9]`匹配`\n`, 并`$`匹配字符串末尾。考虑以下示例，该示例使用捕获组来展示其工作原理：

```
>>> re.match(r'(.*)([^0-9])$', '...12\n').groups()
('...12', '\n') 
```

要解决此问题，您可以`[^0-9]`通过将其更改为来防止匹配换行符`[^0-9\n]`：

```
verbose_item_pattern_3 = re.compile(r"""
  ^            # begin match at newline
  \t*          # 0-or-more tabspace
  [ ]*         # 0-or-more blank space
  I            # a capital I
  [tT][eE][mM] # one character from each of the three sets this allows for unknown case
  \t*          # 0-or-more tabspace
  [ ]*         # 0-or-more blankspace
  \d{1,2}      # 1-or-2 digits
  [.]?         # 0-or-1 literal .
  \(?          # 0-or-1 literal open paren
  [a-e]?       # 0-or-1 letter in the range a-e
  \)?          # 0-or-1 closing paren
  .*           # any number of unknown characters so we can have words and punctuation
  [^0-9\n]     # anything but [0-9] and line breaks
  $           # 1 newline character
  """, re.VERBOSE|re.MULTILINE) 
```

示例（使用上述正则表达式）：

```
>>> verbose_item_pattern_3.findall('\nItem 6\.       TITLE ITEM 6.....25\n')
[]
>>> verbose_item_pattern_3.findall('\nItem 6\.       TITLE ITEM 6.....\n')
['Item 6\.       TITLE ITEM 6.....'] 
```

# regex - 使用 Applicative Functor 匹配至少 3 个 Scala 正则表达式中的 1 个

> ID：13883262
> 
> 赞同：4
> 
> 时间：2012-12-14T17:10:49.603
> 
> 标签：regex, scala, scalaz, applicative

我有三个 Scala 正则表达式，我需要测试它们中的任何一个是否与给定的字符串匹配。

我知道我可以做到以下几点：

```
val matches = R1.findFirstIn(myString).isDefined ||
              R2.findFirstIn(myString).isDefined ||
              R3.findFirstIn(myString).isDefined 
```

但我相信有一种方法可以使用[Scalaz](https://github.com/scalaz/scalaz)库中的 Applicative Functor 或 Monad 来做到这一点。

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T17:37:58.150

这是 的“第一个”（或“最后一个”）幺半群实例下的总和`Option`。在 Scalaz 7 中，您可以编写：

```
import scalaz._, Scalaz._

val R1 = "[a-c]".r
val R2 = "[d-f]".r
val R3 = "[g-i]".r

val m: Option[String] = List(R1, R2, R3).map(_.findFirstIn("test").first).suml 
```

或者，或者：

```
val r1m = R1.findFirstIn("test").first
val r2m = R2.findFirstIn("test").first
val r3m = R3.findFirstIn("test").first

val m: Option[String] = r1m |+| r2m |+| r3m 
```

请注意，这两种解决方案都返回匹配本身，`isDefined`如果您想要与实现中相同的行为，您当然可以调用它。

* * *

附带说明一下，`|+|`这里的第一个 monoid 实例只是`orElse`在标准库中，因此您可以在没有 Scalaz 的情况下几乎一样简洁地编写它：

```
List(R1, R2, R3).map(_.findFirstIn("test")).reduce(_ orElse _) 
```

这当然不是反对使用 Scalaz 的理由，因为它让我们更清晰地捕捉抽象，并提供了一种优雅的方式来改变关于`Some`返回第一个还是最后一个的行为。

# jquery - 使用ajax加载时div不调整高度

> ID：13883263
> 
> 赞同：2
> 
> 时间：2012-12-14T17:10:52.217
> 
> 标签：jquery, height, responsive-design

所以...

我想创建一个完全响应的网站，我们在其中推荐最好的移动应用程序。我将应用程序放在 json 字符串中，并使用 $.ajax 方法通过 jquery 将其加载到内容 div 中（实际上是一个部分，使用 HTML5）。

```
<section id="content-wrapper" class="colums cols-12">
    <section id="content" class="gratisapps centered clearfix cols-12">
    </section>
</section> 
```

为了使这个网站具有响应性（第一个 960px 固定宽度，对于较小的屏幕我想使用流畅的布局），我使用了 12 列网格。页眉和页脚随浏览器宽度一起缩放，但内容不会。我相信这与我的内容容器没有高度这一事实有关，尽管所有应用程序都加载在其中。

```
var _gratisApps;
function inladenApplicaties(){
$.ajax({
    type:"GET",
    dataType:"JSON",
    contenttype: "application/json",
    cache:false,
    url: "../_data/gratisapps.json",
    success:function(data){
        if(data != null && data.apps != null){
            //GET PORTFOLIOITEMS FROM JSON STRING
            _nieuweApps = data.apps;
            //VISUALIZE PORTFOLIOITEMS
            vizuGratisApplicaties();
        }
    },
    error:function(xhr, result, error){
        alert(result + " " + error);
    }
});
}
function vizuGratisApplicaties(){
var content = "";
$.each(_nieuweApps, function(key, nieuweApp){
    if(nieuweApp.soort == "nieuw")
    {   var queryString = nieuweApp.title.replace(/\s+/g, '%20');
        content += '<section class="app colums cols-2 clearfix">'
        + '<a href="detailpage.html?q=' + queryString + '">'
        + '<figure><img class="app-image" src="' + nieuweApp.image + '" /></figure>'
        + '<figcaption><h4>' + nieuweApp.title + '</h4></figcaption>' 
        + '</a>'
        + '</section>';
    }
});
$('#content.gratisapps').append(content);
} 
```

所有这些部分都向左浮动，宽度为 14.58333%。有没有人有这个问题的解决方案/知道另一种解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T14:40:25.490

你能提供更多信息吗？你如何扩展你的内容？会不会是因为注入的内容是在最初加载 DOM 之后生成的？

# sql-server - SQL Server DataSet 将更改同步回 SQL Server

> ID：13883266
> 
> 赞同：0
> 
> 时间：2012-12-14T17:10:59.747
> 
> 标签：sql-server, visual-studio-2012, strongly-typed-dataset

我有一个我认为很容易的问题，但我无法弄清楚。

我正在使用从 SQL Server 生成的类型化数据集在 Visual Studio 2012 中工作。我在 Visual Studio 中的一个表中添加了一列（有一个选项），但我不知道如何将该更改同步回服务器。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:16:10.790

如果没有自定义，类型化数据集无法为您执行 DDL 修改。如果您正在开始一个新项目，我建议您查看 EntityFramework 的“代码优先”功能以实现此功能。

# linked-list - 你能在这个链表代码中发现 4 个错误吗？

> ID：13883267
> 
> 赞同：2
> 
> 时间：2012-12-14T17:11:04.797
> 
> 标签：linked-list, nodes

我刚拿到我的测试，我只能发现 2 并且我们的教授在返回时没有给我们正确的答案..想知道你们是否可以帮助我发现此代码中的 4 个错误以获取链接列表...

```
int main() {
  struct node 
 {
     int data;
     node * next; 
 }

// create empty list
node * list;

// insert six nodes at front of list
node *n;
for (int i=0;i<=5;i++)
{
  n = new node;
  n->data = i;
  n->next = list;
}
// print list
n = list;
while (!n) 
{
  cout << n->data << "  ";
  n = n->next; 
}
cout << endl; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T17:23:30.073

*   `struct node``;`在它的声明末尾丢失
*   `list`未初始化为`NULL`
*   `list`插入节点后不指向头部
*   未检查节点分配是否成功
*   打印循环不正确 - 应该`while(n)`代替`while(!n)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T17:18:07.613

你需要初始化列表

```
 list = NULL; 
```

您总是将 n->Next 分配给列表，但从不给列表一个值。

```
for (int i=0;i<=5;i++)
{
  n = new node;
  n->data = i;
  n->next = list;
  list=n;
} 
```

它应该没有！否则它不会打印任何东西。

```
while (!n) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T17:29:27.213

在我的脑海中（有些已经被其他人注意到了......）：

1.  没有定义`;`后`struct`
2.  `list`未初始化
3.  `list`分配给每个`next`指针，但从未更新
4.  `n`分配的（未初始化的）值`list`会丢弃您迄今为止所做的任何事情（内存泄漏）
5.  `main()`缺少结尾`}`（如果您没有发布更多内容，可能不是错误）
6.  循环中的错误条件`while`- 仅循环 while`n == 0`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T17:26:09.307

错误

1.`node * list`

由于所有节点都指向同一个指针。他们都只指向一个项目（它不会成为一个列表）

2.`while(!n)`

应该是 while(n) 否则不会打印任何内容

3.list 永远不会分配给任何东西

`node * list`创建一个空列表，但此列表未初始化为 null

4.`struct node`漏掉分号；

5.Post初始化`node * list`仍然是空的，无处可去。现在所有节点都指向它，代码分解为无政府状态！

# android - Android 模拟器 - 如何在模拟器中查看从计算机传输到模拟器的文件

> ID：13883271
> 
> 赞同：2
> 
> 时间：2012-12-14T17:11:30.260
> 
> 标签：android, android-emulator, emulation

我已将文件从计算机推送到模拟器的 SD 卡中。我需要在模拟器中查看该文件。但该文件未列出。我不知道如何找到它的路径。我的意思是我们在模拟器中没有类似“我的文件”的东西。那么我们如何查看文件呢？图片正在画廊中列出。但是对于其他文件呢？请帮助我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T17:16:54.760

DDMS 视图有一个“文件资源管理器”选项卡。在其中您将看到文件结构。检查`/mnt/sdcard`（或类似）您的文件。有一些图标可以让您在模拟器中推送和/或拉取文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-14T18:53:23.217

我要做的是下载一个文件资源管理器应用程序 apk（[在](http://www.lysesoft.com/products/andexplorer/)这里你可以得到一个）。然后按照[这些](https://stackoverflow.com/questions/3480201/how-do-you-install-an-apk-file-in-the-android-emulator)说明在您的模拟器上安装 apk。使用它直接在模拟器上浏览文件。

# css - 在按钮链接中添加 css

> ID：13883272
> 
> 赞同：1
> 
> 时间：2012-12-14T17:11:38.180
> 
> 标签：css, button

如何在按钮中添加链接样式。所以，我有一个链接样式：

```
a:link {color:#FFFFFF;}
a:visited {color:#FFFFFF;}
a:hover {color:#FFFFFF;}
a:active {color:#FFFFFF;} 
```

如何将此样式与此按钮 css 集成。

```
button {
text-decoration: none;
text-shadow: 0 1px 0 #000000;
font: bold 11px Helvetica, Arial, sans-serif;
color: #FFFFFF;
line-height: 17px;
height: 18px;
display: inline-block;
float: left;
margin: 5px;
padding: 5px 6px 4px 6px;
background: #F3F3F3;
border: solid 1px #D9D9D9;
border-radius: 2px;
-webkit-border-radius: 2px;
-moz-border-radius: 2px;
 -webkit-transition: border-color .20s;
 -moz-transition: border-color .20s;
 -o-transition: border-color .20s;
 transition: border-color .20s;
height: 29px !important;
cursor: pointer;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:16:49.313

如果您想将相同的样式应用于多个元素（和元素的类型），那么您应该使用类。

```
.link:link {color:#FFFFFF;}
.link:visited {color:#FFFFFF;}
.link:hover {color:#FFFFFF;}
.link:active {color:#FFFFFF;}

.button { all of your button styles } 
```

然后在需要时一起使用它们：

```
<input type="button" class="link button" value="I'm a button" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:29:47.717

使用`button a:link, button a:hover, button a:visited, button a:active`.

但是在按钮内有一个链接有什么意义呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:19:02.720

我不太了解这个问题，但也许这可以为您服务：

```
INPUT:hover {background: yellow;}
INPUT:focus {background: #FF99FF;}
INPUT:focus:hover {background: #99FF99;} 
```

或者

```
INPUT:focus:hover {
text-decoration: none;
text-shadow: 0 1px 0 #000000;
font: bold 11px Helvetica, Arial, sans-serif;
color: #FFFFFF;
line-height: 17px;
height: 18px;
display: inline-block;
float: left;
margin: 5px;
padding: 5px 6px 4px 6px;
background: #F3F3F3;
border: solid 1px #D9D9D9;
border-radius: 2px;
-webkit-border-radius: 2px;
-moz-border-radius: 2px;
 -webkit-transition: border-color .20s;
 -moz-transition: border-color .20s;
 -o-transition: border-color .20s;
 transition: border-color .20s;
height: 29px !important;
cursor: pointer;

} 
```

# javascript - 使用 CSS 按钮打开 Visual Lightbox

> ID：13883273
> 
> 赞同：0
> 
> 时间：2012-12-14T17:11:43.050
> 
> 标签：javascript, jquery, lightbox, href

昨天，我问了一个与 Fancybox 相关的问题，有人非常乐于助人地向我展示了我丢失的作品。不过，现在我弄清楚了所有这些，我意识到……Fancybox 并不是我想要的。相反，我决定使用 Visual Lightbox (v5.0)，因为对于基本的页面查看器来说，一旦打开控件，如何处理这些控件就更明显了。

话虽如此，我已经使用我昨天学到的信息让一切工作完美 - 多个画廊，集成缩略图启动等 - 一切都很完美！我现在想做的是能够从 CSS 按钮启动每个缩略图的独特灯箱画廊。我已经阅读了几十个似乎相关的问题，但我阅读的所有技巧都不适用于我的。

所以我们开始吧。按钮的 CSS：

```
 <style type="text/css">
a.bigbutton {   
    style="border-radius: 3px;
    display: inline-block;
    cursor: pointer;
    line-height: normal;
    box-shadow:inset 0px 1px 1px #3f3f3f;
    width:100%;
    height:32px;
    padding-top:6px;
    display:inline-block;
    text-align:center;
    font-size:16px;
    color:#fff !important;
    text-transform:uppercase;
    background:#2b2b2b;
    font-family: 'Oswald', sans-serif;
} 
```

现在按钮的 HTML：

```
 <a href="album-detail.html" class="bigbutton">VIEW PHOTOS</a> 
```

VLB 画廊保留其股票 ID “vlightbox1”、“vlightbox2”等。

显然，我不能覆盖“bigbutton”类，否则按钮将无法正确显示。同样，我尝试将“bigbutton”类链接到灯箱触发器，但我显然写错了。

一如既往，非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:21:29.907

您不能抓住锚点并将处理程序附加到单击事件吗？

```
var btns = document.getElementsByClassName("bigbutton");
for(var i=0;i<btns.length;i++){
    btns[i].addEventListener("click", (function(e){

        // .. do trigger code here

    }), false); // this only handles W3C due to addEventListener
} 
```

另外，我不太确定“覆盖 'bitbutton' 类”是什么意思，但元素上可以有多个类。

```
<a href="album-detail.html" class="bigbutton mysecond_class">VIEW PHOTOS</a> 
```

================== 编辑=======================

查看该站点的代码，您似乎需要更改链接的 href 以及 textnode。最后，代码应如下所示：

```
<div id='vlightbox1'>
    <a href='path/to/my/image1.jpg' class='vlightbox1 bigbutton' title='my title'>
      <img src='path/to/my/image1.jpg' />
    </a>
    <a href='path/to/my/image2.jpg' class='vlightbox1 bigbutton' title='my second title'>
      <img src='path/to/my/image2.jpg' />
    </a>
</div> 
```

# javascript - 为什么用户必须单击两次才能启用 JQuery UI Slider 的键盘控制

> ID：13883274
> 
> 赞同：1
> 
> 时间：2012-12-14T17:11:51.910
> 
> 标签：javascript, jquery, jquery-ui

我在这里实现了一个自定义滑块：http: [//jsfiddle.net/4wZ8d/](http://jsfiddle.net/4wZ8d/)

它的工作方式是滑块手柄最初是隐藏的，当用户单击滑块上的任意位置时，手柄就会出现，方法是：

```
$("a.ui-slider-handle").hide();
$("a.ui-slider-handle").show(); 
```

`left`然而，用户必须在他/她使用键盘（即或`right`键）移动手柄之前至少在滑块上单击两次。

有人知道是什么导致了这种行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:18:33.520

尝试添加：

```
$("a.ui-slider-handle").focus(); 
```

后

```
$("a.ui-slider-handle").show(); 
```

也许你只需要元素来获得焦点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:19:01.753

如果滑块有焦点，您只能使用箭头键移动滑块。简单添加：

```
$("a.ui-slider-handle").show().focus(); 
```

请注意，如果滑块失去焦点，箭头键将再次禁用。如果您希望他们无论如何都做出回应，您将不得不绑定`.keypress`或类似的`document`东西，但这可能不是最好的主意。

# mysql - 需要通过运算符“-”在mysql中拆分参数

> ID：13883276
> 
> 赞同：2
> 
> 时间：2012-12-14T17:12:09.257
> 
> 标签：mysql

作为Mysql`**359616044513513-2574**` 参数，我的要求是通过**“-”**操作符分割这个参数并将它们存储到两个变量中，比如 `dev=359616044513513 and id=2574` 我如何在MYSQL的存储过程中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:19:41.377

您可以使用 MySQL 的[`SUBSTRING_INDEX()`](http://dev.mysql.com/doc/en/string-functions.html#function_substring-index)功能：

```
DELIMITER ;;

CREATE PROCEDURE my_proc(IN my_param TEXT) BEGIN
  DECLARE dev TEXT DEFAULT SUBSTRING_INDEX(my_param, '-',  1);
  DECLARE id  TEXT DEFAULT SUBSTRING_INDEX(my_param, '-', -1);

  -- etc.
END;;

DELIMITER ; 
```

# python - 如何使用 Python 在 NLTK 中使用 Stanford Parser

> ID：13883277
> 
> 赞同：93
> 
> 时间：2012-12-14T17:12:20.070
> 
> 标签：python, parsing, nlp, nltk, stanford-nlp

是否可以在 NLTK 中使用斯坦福解析器？（我不是在谈论斯坦福 POS。）

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2014-03-08T13:03:36.997

请注意，此答案适用于 NLTK v 3.0，而不适用于更新的版本。

当然，在 Python 中尝试以下操作：

```
import os
from nltk.parse import stanford
os.environ['STANFORD_PARSER'] = '/path/to/standford/jars'
os.environ['STANFORD_MODELS'] = '/path/to/standford/jars'

parser = stanford.StanfordParser(model_path="/location/of/the/englishPCFG.ser.gz")
sentences = parser.raw_parse_sents(("Hello, My name is Melroy.", "What is your name?"))
print sentences

# GUI
for line in sentences:
    for sentence in line:
        sentence.draw() 
```

输出：

> [Tree('ROOT', [Tree('S', [Tree('INTJ', [Tree('UH', ['Hello'])]), Tree(',', [',']),树（'NP'，[树（'PRP$'，['My']），树（'NN'，['name']）]），树（'VP'，[树（'VBZ'，[ 'is']), Tree('ADJP', [Tree('JJ', ['Melroy'])])]), Tree('.', ['.'])])]), Tree(' ROOT', [Tree('SBARQ', [Tree('WHNP', [Tree('WP', ['What'])]), Tree('SQ', [Tree('VBZ', ['is' ]), Tree('NP', [Tree('PRP$', ['your']), Tree('NN', ['name'])])]), Tree('.', ['? '])])])]

**注意 1：** 在这个例子中，解析器和模型 jar 都在同一个文件夹中。

**笔记2：**

*   stanford解析器的文件名是：stanford-parser.jar
*   stanford 模型的文件名是：stanford-parser-xxx-models.jar

**注 3：** englishPCFG.ser.gz 文件可以在 models.jar 文件中找到***（*** /edu/stanford/nlp/models/lexparser/englishPCFG.ser.gz）。请使用来存档管理器“解压缩”models.jar 文件。

**注意 4：** 确保您使用的是 Java JRE（运行时环境）**1.8**，也称为 Oracle JDK 8。否则您将得到：不支持的 major.minor 版本 52.0。

# 安装

1.  [从： https](https://github.com/nltk/nltk) ://github.com/nltk/nltk下载 NLTK v3 。并安装 NLTK：

    须藤 python setup.py 安装

2.  您可以使用 NLTK 下载器获取 Stanford Parser，使用 Python：

    ```
    import nltk
    nltk.download() 
    ```

3.  试试我的例子！（不要忘记更改 jar 路径并将模型路径更改为 ser.gz 位置）

**或者：**

1.  下载并安装 NLTK v3，同上。

2.  从（**当前版本**文件名为 stanford-parser-full-2015-01-29.zip）下载最新版本：http: [//nlp.stanford.edu/software/lex-parser.shtml#Download](http://nlp.stanford.edu/software/lex-parser.shtml#Download)

3.  提取standford-parser-full-20xx-xx-xx.zip。

4.  创建一个新文件夹（在我的示例中为“jars”）。将提取的文件放入此 jar 文件夹：stanford-parser-3.xx-models.jar 和 stanford-parser.jar。

    如上所示，您可以使用环境变量 (STANFORD_PARSER & STANFORD_MODELS) 指向此“jars”文件夹。我使用的是 Linux，所以如果你使用 Windows，请使用类似：C://folder//jars。

5.  使用存档管理器 (7zip) 打开 stanford-parser-3.xx-models.jar。

6.  浏览jar文件；edu/stanford/nlp/models/lexparser。再次提取名为“englishPCFG.ser.gz”的文件。记住您提取此 ser.gz 文件的位置。

7.  创建 StanfordParser 实例时，您可以提供模型路径作为参数。这是模型的完整路径，在我们的例子中是 /location/of/englishPCFG.ser.gz。

8.  试试我的例子！（不要忘记更改 jar 路径并将模型路径更改为 ser.gz 位置）

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2015-12-06T00:45:28.640

## 已弃用的答案

以下答案已弃用，请使用[https://stackoverflow.com/a/51981566/610569](https://stackoverflow.com/a/51981566/610569)上的解决方案，用于 NLTK v3.3 及更高版本。

* * *

## 已编辑

注意：以下答案仅适用于：

*   NLTK 版本 >=3.2.4
*   斯坦福工具编译自 2015-04-20
*   Python 2.7、3.4 和 3.5（尚未正式支持 Python 3.6）

由于这两种工具的变化都很快，而且 API 可能在 3-6 个月后看起来非常不同。请将以下答案视为暂时的，而不是永恒的解决方案。

**有关如何使用 NLTK 连接斯坦福 NLP 工具的最新说明，请始终参考[https://github.com/nltk/nltk/wiki/Installing-Third-Party-Software ！](https://github.com/nltk/nltk/wiki/Installing-Third-Party-Software)**

* * *

## TL;博士

```
cd $HOME

# Update / Install NLTK
pip install -U nltk

# Download the Stanford NLP tools
wget http://nlp.stanford.edu/software/stanford-ner-2015-04-20.zip
wget http://nlp.stanford.edu/software/stanford-postagger-full-2015-04-20.zip
wget http://nlp.stanford.edu/software/stanford-parser-full-2015-04-20.zip
# Extract the zip file.
unzip stanford-ner-2015-04-20.zip 
unzip stanford-parser-full-2015-04-20.zip 
unzip stanford-postagger-full-2015-04-20.zip

export STANFORDTOOLSDIR=$HOME

export CLASSPATH=$STANFORDTOOLSDIR/stanford-postagger-full-2015-04-20/stanford-postagger.jar:$STANFORDTOOLSDIR/stanford-ner-2015-04-20/stanford-ner.jar:$STANFORDTOOLSDIR/stanford-parser-full-2015-04-20/stanford-parser.jar:$STANFORDTOOLSDIR/stanford-parser-full-2015-04-20/stanford-parser-3.5.2-models.jar

export STANFORD_MODELS=$STANFORDTOOLSDIR/stanford-postagger-full-2015-04-20/models:$STANFORDTOOLSDIR/stanford-ner-2015-04-20/classifiers 
```

然后：

```
>>> from nltk.tag.stanford import StanfordPOSTagger
>>> st = StanfordPOSTagger('english-bidirectional-distsim.tagger')
>>> st.tag('What is the airspeed of an unladen swallow ?'.split())
[(u'What', u'WP'), (u'is', u'VBZ'), (u'the', u'DT'), (u'airspeed', u'NN'), (u'of', u'IN'), (u'an', u'DT'), (u'unladen', u'JJ'), (u'swallow', u'VB'), (u'?', u'.')]

>>> from nltk.tag import StanfordNERTagger
>>> st = StanfordNERTagger('english.all.3class.distsim.crf.ser.gz') 
>>> st.tag('Rami Eid is studying at Stony Brook University in NY'.split())
[(u'Rami', u'PERSON'), (u'Eid', u'PERSON'), (u'is', u'O'), (u'studying', u'O'), (u'at', u'O'), (u'Stony', u'ORGANIZATION'), (u'Brook', u'ORGANIZATION'), (u'University', u'ORGANIZATION'), (u'in', u'O'), (u'NY', u'O')]

>>> from nltk.parse.stanford import StanfordParser
>>> parser=StanfordParser(model_path="edu/stanford/nlp/models/lexparser/englishPCFG.ser.gz")
>>> list(parser.raw_parse("the quick brown fox jumps over the lazy dog"))
[Tree('ROOT', [Tree('NP', [Tree('NP', [Tree('DT', ['the']), Tree('JJ', ['quick']), Tree('JJ', ['brown']), Tree('NN', ['fox'])]), Tree('NP', [Tree('NP', [Tree('NNS', ['jumps'])]), Tree('PP', [Tree('IN', ['over']), Tree('NP', [Tree('DT', ['the']), Tree('JJ', ['lazy']), Tree('NN', ['dog'])])])])])])]

>>> from nltk.parse.stanford import StanfordDependencyParser
>>> dep_parser=StanfordDependencyParser(model_path="edu/stanford/nlp/models/lexparser/englishPCFG.ser.gz")
>>> print [parse.tree() for parse in dep_parser.raw_parse("The quick brown fox jumps over the lazy dog.")]
[Tree('jumps', [Tree('fox', ['The', 'quick', 'brown']), Tree('dog', ['over', 'the', 'lazy'])])] 
```

* * *

## 在长：

**首先**，必须注意***斯坦福 NLP 工具是用 Java 编写的，***而***NLTK 是用 Python 编写的***。NLTK 连接工具的方式是通过命令行界面调用 Java 工具。

**其次**，`NLTK`自 3.1 版以来，斯坦福 NLP 工具的 API 发生了很大变化。因此建议将您的 NLTK 包更新到 v3.1。

**第三**，`NLTK`Stanford NLP Tools 的 API 围绕着各个 NLP 工具，例如[Stanford POS tagger](http://nlp.stanford.edu/software/tagger.shtml)、[Stanford NER Tagger](http://nlp.stanford.edu/software/CRF-NER.shtml)、[Stanford Parser](http://nlp.stanford.edu/software/lex-parser.shtml)。

对于 POS 和 NER 标注器，它**不**包含[**Stanford Core NLP package**](http://nlp.stanford.edu/software/corenlp.shtml)。

对于Stanford Parser，这是一个特殊情况，它同时包含Stanford Parser 和Stanford Core NLP（就我个人而言，我没有在NLTK 中使用后者，我宁愿遵循@dimazest 在[http://www.eecs 上的演示。 qmul.ac.uk/~dm303/stanford-dependency-parser-nltk-and-anaconda.html](http://www.eecs.qmul.ac.uk/~dm303/stanford-dependency-parser-nltk-and-anaconda.html) )

**请注意，从 NLTK v3.1 开始，不推荐使用`STANFORD_JAR`and`STANFORD_PARSER`变量，不再使用**

* * *

## 更长的：

## 步骤1

**假设您已在操作系统上正确安装了 Java。**

现在，安装/更新您的 NLTK 版本（参见[http://www.nltk.org/install.html](http://www.nltk.org/install.html)）：

*   **使用点子**：`sudo pip install -U nltk`
*   **Debian 发行版**（使用 apt-get）：`sudo apt-get install python-nltk`

**对于 Windows**（使用 32 位二进制安装）：

1.  安装 Python 3.4： http: [//www.python.org/downloads/](http://www.python.org/downloads/)（避免使用 64 位版本）
2.  安装 Numpy（可选）： http: [//sourceforge.net/projects/numpy/files/NumPy/](http://sourceforge.net/projects/numpy/files/NumPy/)（指定pythnon3.4的版本）
3.  安装 NLTK： http: [//pypi.python.org/pypi/nltk](http://pypi.python.org/pypi/nltk)
4.  测试安装：开始>Python34，然后输入import nltk

（**为什么不是 64 位？**见[https://github.com/nltk/nltk/issues/1079](https://github.com/nltk/nltk/issues/1079)）

* * *

然后出于偏执，重新检查你`nltk`在 python 中的版本：

```
from __future__ import print_function
import nltk
print(nltk.__version__) 
```

或者在命令行上：

```
python3 -c "import nltk; print(nltk.__version__)" 
```

确保您看到`3.1`的是输出。

如果你更偏执，请检查所有你最喜欢的斯坦福 NLP 工具 API 是否可用：

```
from nltk.parse.stanford import StanfordParser
from nltk.parse.stanford import StanfordDependencyParser
from nltk.parse.stanford import StanfordNeuralDependencyParser
from nltk.tag.stanford import StanfordPOSTagger, StanfordNERTagger
from nltk.tokenize.stanford import StanfordTokenizer 
```

（**注意**：上面的导入只会**确保**您使用的是包含这些 API 的正确 NLTK 版本。在导入中没有看到错误并不意味着您已成功配置 NLTK API 以使用斯坦福工具）

* * *

## 第2步

现在您已经检查了是否拥有正确版本的 NLTK，其中包含必要的斯坦福 NLP 工具接口。您需要下载并提取所有必要的斯坦福 NLP 工具。

**TL;DR**，在 Unix 中：

```
cd $HOME

# Download the Stanford NLP tools
wget http://nlp.stanford.edu/software/stanford-ner-2015-04-20.zip
wget http://nlp.stanford.edu/software/stanford-postagger-full-2015-04-20.zip
wget http://nlp.stanford.edu/software/stanford-parser-full-2015-04-20.zip
# Extract the zip file.
unzip stanford-ner-2015-04-20.zip 
unzip stanford-parser-full-2015-04-20.zip 
unzip stanford-postagger-full-2015-04-20.zip 
```

在 Windows/Mac 中：

*   [从http://nlp.stanford.edu/software/lex-parser.shtml#Download](http://nlp.stanford.edu/software/lex-parser.shtml#Download)下载并解压缩解析器
*   从[http://nlp.stanford.edu/software/tagger.shtml#Download](http://nlp.stanford.edu/software/tagger.shtml#Download)下载并统一**FULL VERSION标记器**
*   [从http://nlp.stanford.edu/software/CRF-NER.shtml#Download](http://nlp.stanford.edu/software/CRF-NER.shtml#Download)下载并统一 NER 标记器

* * *

## 第 3 步

设置环境变量，使 NLTK 可以自动找到相关的文件路径。您必须设置以下变量：

*   将适当的斯坦福 NLP`.jar`文件添加到 `CLASSPATH`环境变量中。

    *   例如对于 NER，它将是`stanford-ner-2015-04-20/stanford-ner.jar`
    *   例如对于 POS，它将是`stanford-postagger-full-2015-04-20/stanford-postagger.jar`
    *   例如对于解析器，它将是`stanford-parser-full-2015-04-20/stanford-parser.jar`解析器模型的 jar 文件，`stanford-parser-full-2015-04-20/stanford-parser-3.5.2-models.jar`
*   将适当的模型目录添加到`STANFORD_MODELS`变量中（即可以找到保存预训练模型的目录）

    *   例如对于 NER，它将在`stanford-ner-2015-04-20/classifiers/`
    *   例如对于 POS，它将在`stanford-postagger-full-2015-04-20/models/`
    *   例如对于解析器，不会有模型目录。

[`STANFORD_MODELS`](https://github.com/nltk/nltk/blob/develop/nltk/tag/stanford.py#L55)在代码中，看到它在附加模型名称之前搜索目录。另请参阅，API 还会自动尝试在操作系统环境中搜索[`CLASSPATH](https://github.com/nltk/nltk/blob/develop/nltk/tag/stanford.py#L115)）

**请注意，从 NLTK v3.1 开始，`STANFORD_JAR`变量已弃用且不再使用**。以下 Stackoverflow 问题中的代码片段可能不起作用：

*   [斯坦福依赖解析器设置和 NLTK](https://stackoverflow.com/questions/34053021/stanford-dependency-parser-setup-and-nltk)
*   [斯坦福解析器的 nltk 接口](https://stackoverflow.com/questions/21652251/nltk-interface-to-stanford-parser)
*   [将 stanford pos tagger 导入 nltk 时遇到问题](https://stackoverflow.com/questions/7344916/trouble-importing-stanford-pos-tagger-into-nltk)
*   [Python Nltk 中的斯坦福实体识别器（无壳）](https://stackoverflow.com/questions/30745714/stanford-entity-recognizer-caseless-in-python-nltk)
*   [如何使用 Stanford NLP Tagger 和 NLTK 提高速度](https://stackoverflow.com/questions/23322674/how-to-improve-speed-with-stanford-nlp-tagger-and-nltk)
*   [如何获得 stanford NLTK python 模块？](https://stackoverflow.com/questions/19694106/how-can-i-get-the-stanford-nltk-python-module)
*   [斯坦福解析器和 NLTK 窗口](https://stackoverflow.com/questions/29200007/stanford-parser-and-nltk-windows)
*   [带有 NLTK 的斯坦福命名实体识别器 (NER) 功能](https://stackoverflow.com/questions/18371092/stanford-named-entity-recognizer-ner-functionality-with-nltk)
*   [带有 NLTK 的斯坦福解析器产生空输出](https://stackoverflow.com/questions/32056719/stanford-parser-with-nltk-produces-empty-output)
*   [在 NLTK 中使用斯坦福 NER 标记器提取人员和组织列表](https://stackoverflow.com/questions/30664677/extract-list-of-persons-and-organizations-using-stanford-ner-tagger-in-nltk)
*   [在 NLTK Python 中使用斯坦福 POS 标记器时出错](https://stackoverflow.com/questions/22930328/error-using-stanford-pos-tagger-in-nltk-python)

**TL; Ubuntu 上第 3 步的 DR**

```
export STANFORDTOOLSDIR=/home/path/to/stanford/tools/

export CLASSPATH=$STANFORDTOOLSDIR/stanford-postagger-full-2015-04-20/stanford-postagger.jar:$STANFORDTOOLSDIR/stanford-ner-2015-04-20/stanford-ner.jar:$STANFORDTOOLSDIR/stanford-parser-full-2015-04-20/stanford-parser.jar:$STANFORDTOOLSDIR/stanford-parser-full-2015-04-20/stanford-parser-3.5.2-models.jar

export STANFORD_MODELS=$STANFORDTOOLSDIR/stanford-postagger-full-2015-04-20/models:$STANFORDTOOLSDIR/stanford-ner-2015-04-20/classifiers 
```

（**对于 Windows**：有关设置环境变量的说明，请参阅[https://stackoverflow.com/a/17176423/610569 ）](https://stackoverflow.com/a/17176423/610569)

在启动 python 之前，您**必须**如上所述设置变量，然后：

```
>>> from nltk.tag.stanford import StanfordPOSTagger
>>> st = StanfordPOSTagger('english-bidirectional-distsim.tagger')
>>> st.tag('What is the airspeed of an unladen swallow ?'.split())
[(u'What', u'WP'), (u'is', u'VBZ'), (u'the', u'DT'), (u'airspeed', u'NN'), (u'of', u'IN'), (u'an', u'DT'), (u'unladen', u'JJ'), (u'swallow', u'VB'), (u'?', u'.')]

>>> from nltk.tag import StanfordNERTagger
>>> st = StanfordNERTagger('english.all.3class.distsim.crf.ser.gz') 
>>> st.tag('Rami Eid is studying at Stony Brook University in NY'.split())
[(u'Rami', u'PERSON'), (u'Eid', u'PERSON'), (u'is', u'O'), (u'studying', u'O'), (u'at', u'O'), (u'Stony', u'ORGANIZATION'), (u'Brook', u'ORGANIZATION'), (u'University', u'ORGANIZATION'), (u'in', u'O'), (u'NY', u'O')]

>>> from nltk.parse.stanford import StanfordParser
>>> parser=StanfordParser(model_path="edu/stanford/nlp/models/lexparser/englishPCFG.ser.gz")
>>> list(parser.raw_parse("the quick brown fox jumps over the lazy dog"))
[Tree('ROOT', [Tree('NP', [Tree('NP', [Tree('DT', ['the']), Tree('JJ', ['quick']), Tree('JJ', ['brown']), Tree('NN', ['fox'])]), Tree('NP', [Tree('NP', [Tree('NNS', ['jumps'])]), Tree('PP', [Tree('IN', ['over']), Tree('NP', [Tree('DT', ['the']), Tree('JJ', ['lazy']), Tree('NN', ['dog'])])])])])])] 
```

* * *

或者，您可以尝试在 python 中添加环境变量，正如前面的答案所建议的那样，但您也可以直接告诉解析器/标记器初始化为您保存`.jar`文件和模型的直接路径。

如果您使用以下方法，则无需设置环境变量，**但是**当 API 更改其参数名称时，您将需要相应更改。***这就是为什么设置环境变量比修改 python 代码以适应 NLTK 版本更可取的原因。***

例如（**不设置任何环境变量**）：

```
# POS tagging:

from nltk.tag import StanfordPOSTagger

stanford_pos_dir = '/home/alvas/stanford-postagger-full-2015-04-20/'
eng_model_filename= stanford_pos_dir + 'models/english-left3words-distsim.tagger'
my_path_to_jar= stanford_pos_dir + 'stanford-postagger.jar'

st = StanfordPOSTagger(model_filename=eng_model_filename, path_to_jar=my_path_to_jar) 
st.tag('What is the airspeed of an unladen swallow ?'.split())

# NER Tagging:
from nltk.tag import StanfordNERTagger

stanford_ner_dir = '/home/alvas/stanford-ner/'
eng_model_filename= stanford_ner_dir + 'classifiers/english.all.3class.distsim.crf.ser.gz'
my_path_to_jar= stanford_ner_dir + 'stanford-ner.jar'

st = StanfordNERTagger(model_filename=eng_model_filename, path_to_jar=my_path_to_jar) 
st.tag('Rami Eid is studying at Stony Brook University in NY'.split())

# Parsing:
from nltk.parse.stanford import StanfordParser

stanford_parser_dir = '/home/alvas/stanford-parser/'
eng_model_path = stanford_parser_dir  + "edu/stanford/nlp/models/lexparser/englishRNN.ser.gz"
my_path_to_models_jar = stanford_parser_dir  + "stanford-parser-3.5.2-models.jar"
my_path_to_jar = stanford_parser_dir  + "stanford-parser.jar"

parser=StanfordParser(model_path=eng_model_path, path_to_models_jar=my_path_to_models_jar, path_to_jar=my_path_to_jar) 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2018-08-23T08:39:16.087

从 NLTK v3.3 开始，用户应**避免**使用来自 的斯坦福 NER 或 POS 标记器`nltk.tag`，并**避免**使用来自`nltk.tokenize`.

而是使用新的`nltk.parse.corenlp.CoreNLPParser`API。

请参阅[https://github.com/nltk/nltk/wiki/Stanford-CoreNLP-API-in-NLTK](https://github.com/nltk/nltk/wiki/Stanford-CoreNLP-API-in-NLTK)

* * *

（避免仅链接答案，我已从下面的 NLTK github wiki 粘贴了文档）

首先，更新您的 NLTK

```
pip3 install -U nltk # Make sure is >=3.3 
```

然后下载必要的 CoreNLP 包：

```
cd ~
wget http://nlp.stanford.edu/software/stanford-corenlp-full-2018-02-27.zip
unzip stanford-corenlp-full-2018-02-27.zip
cd stanford-corenlp-full-2018-02-27

# Get the Chinese model 
wget http://nlp.stanford.edu/software/stanford-chinese-corenlp-2018-02-27-models.jar
wget https://raw.githubusercontent.com/stanfordnlp/CoreNLP/master/src/edu/stanford/nlp/pipeline/StanfordCoreNLP-chinese.properties 

# Get the Arabic model
wget http://nlp.stanford.edu/software/stanford-arabic-corenlp-2018-02-27-models.jar
wget https://raw.githubusercontent.com/stanfordnlp/CoreNLP/master/src/edu/stanford/nlp/pipeline/StanfordCoreNLP-arabic.properties 

# Get the French model
wget http://nlp.stanford.edu/software/stanford-french-corenlp-2018-02-27-models.jar
wget https://raw.githubusercontent.com/stanfordnlp/CoreNLP/master/src/edu/stanford/nlp/pipeline/StanfordCoreNLP-french.properties 

# Get the German model
wget http://nlp.stanford.edu/software/stanford-german-corenlp-2018-02-27-models.jar
wget https://raw.githubusercontent.com/stanfordnlp/CoreNLP/master/src/edu/stanford/nlp/pipeline/StanfordCoreNLP-german.properties 

# Get the Spanish model
wget http://nlp.stanford.edu/software/stanford-spanish-corenlp-2018-02-27-models.jar
wget https://raw.githubusercontent.com/stanfordnlp/CoreNLP/master/src/edu/stanford/nlp/pipeline/StanfordCoreNLP-spanish.properties 
```

# 英语

仍然在`stanford-corenlp-full-2018-02-27`目录中，启动服务器：

```
java -mx4g -cp "*" edu.stanford.nlp.pipeline.StanfordCoreNLPServer \
-preload tokenize,ssplit,pos,lemma,ner,parse,depparse \
-status_port 9000 -port 9000 -timeout 15000 & 
```

然后在 Python 中：

```
>>> from nltk.parse import CoreNLPParser

# Lexical Parser
>>> parser = CoreNLPParser(url='http://localhost:9000')

# Parse tokenized text.
>>> list(parser.parse('What is the airspeed of an unladen swallow ?'.split()))
[Tree('ROOT', [Tree('SBARQ', [Tree('WHNP', [Tree('WP', ['What'])]), Tree('SQ', [Tree('VBZ', ['is']), Tree('NP', [Tree('NP', [Tree('DT', ['the']), Tree('NN', ['airspeed'])]), Tree('PP', [Tree('IN', ['of']), Tree('NP', [Tree('DT', ['an']), Tree('JJ', ['unladen'])])]), Tree('S', [Tree('VP', [Tree('VB', ['swallow'])])])])]), Tree('.', ['?'])])])]

# Parse raw string.
>>> list(parser.raw_parse('What is the airspeed of an unladen swallow ?'))
[Tree('ROOT', [Tree('SBARQ', [Tree('WHNP', [Tree('WP', ['What'])]), Tree('SQ', [Tree('VBZ', ['is']), Tree('NP', [Tree('NP', [Tree('DT', ['the']), Tree('NN', ['airspeed'])]), Tree('PP', [Tree('IN', ['of']), Tree('NP', [Tree('DT', ['an']), Tree('JJ', ['unladen'])])]), Tree('S', [Tree('VP', [Tree('VB', ['swallow'])])])])]), Tree('.', ['?'])])])]

# Neural Dependency Parser
>>> from nltk.parse.corenlp import CoreNLPDependencyParser
>>> dep_parser = CoreNLPDependencyParser(url='http://localhost:9000')
>>> parses = dep_parser.parse('What is the airspeed of an unladen swallow ?'.split())
>>> [[(governor, dep, dependent) for governor, dep, dependent in parse.triples()] for parse in parses]
[[(('What', 'WP'), 'cop', ('is', 'VBZ')), (('What', 'WP'), 'nsubj', ('airspeed', 'NN')), (('airspeed', 'NN'), 'det', ('the', 'DT')), (('airspeed', 'NN'), 'nmod', ('swallow', 'VB')), (('swallow', 'VB'), 'case', ('of', 'IN')), (('swallow', 'VB'), 'det', ('an', 'DT')), (('swallow', 'VB'), 'amod', ('unladen', 'JJ')), (('What', 'WP'), 'punct', ('?', '.'))]]

# Tokenizer
>>> parser = CoreNLPParser(url='http://localhost:9000')
>>> list(parser.tokenize('What is the airspeed of an unladen swallow?'))
['What', 'is', 'the', 'airspeed', 'of', 'an', 'unladen', 'swallow', '?']

# POS Tagger
>>> pos_tagger = CoreNLPParser(url='http://localhost:9000', tagtype='pos')
>>> list(pos_tagger.tag('What is the airspeed of an unladen swallow ?'.split()))
[('What', 'WP'), ('is', 'VBZ'), ('the', 'DT'), ('airspeed', 'NN'), ('of', 'IN'), ('an', 'DT'), ('unladen', 'JJ'), ('swallow', 'VB'), ('?', '.')]

# NER Tagger
>>> ner_tagger = CoreNLPParser(url='http://localhost:9000', tagtype='ner')
>>> list(ner_tagger.tag(('Rami Eid is studying at Stony Brook University in NY'.split())))
[('Rami', 'PERSON'), ('Eid', 'PERSON'), ('is', 'O'), ('studying', 'O'), ('at', 'O'), ('Stony', 'ORGANIZATION'), ('Brook', 'ORGANIZATION'), ('University', 'ORGANIZATION'), ('in', 'O'), ('NY', 'STATE_OR_PROVINCE')] 
```

# 中国人

启动服务器略有不同，仍然从 stanford-corenlp-full-2018-02-27 目录：

```
java -Xmx4g -cp "*" edu.stanford.nlp.pipeline.StanfordCoreNLPServer \
-serverProperties StanfordCoreNLP-chinese.properties \
-preload tokenize,ssplit,pos,lemma,ner,parse \
-status_port 9001  -port 9001 -timeout 15000 
```

在 Python 中：

```
>>> parser = CoreNLPParser('http://localhost:9001')
>>> list(parser.tokenize(u'我家没有电脑。'))
['我家', '没有', '电脑', '。']

>>> list(parser.parse(parser.tokenize(u'我家没有电脑。')))
[Tree('ROOT', [Tree('IP', [Tree('IP', [Tree('NP', [Tree('NN', ['我家'])]), Tree('VP', [Tree('VE', ['没有']), Tree('NP', [Tree('NN', ['电脑'])])])]), Tree('PU', ['。'])])])] 
```

# 阿拉伯

启动服务器：

```
java -Xmx4g -cp "*" edu.stanford.nlp.pipeline.StanfordCoreNLPServer \
-serverProperties StanfordCoreNLP-arabic.properties \
-preload tokenize,ssplit,pos,parse \
-status_port 9005  -port 9005 -timeout 15000 
```

在 Python 中：

```
>>> from nltk.parse import CoreNLPParser
>>> parser = CoreNLPParser('http://localhost:9005')
>>> text = u'انا حامل'

# Parser.
>>> parser.raw_parse(text)
<list_iterator object at 0x7f0d894c9940>
>>> list(parser.raw_parse(text))
[Tree('ROOT', [Tree('S', [Tree('NP', [Tree('PRP', ['انا'])]), Tree('NP', [Tree('NN', ['حامل'])])])])]
>>> list(parser.parse(parser.tokenize(text)))
[Tree('ROOT', [Tree('S', [Tree('NP', [Tree('PRP', ['انا'])]), Tree('NP', [Tree('NN', ['حامل'])])])])]

# Tokenizer / Segmenter.
>>> list(parser.tokenize(text))
['انا', 'حامل']

# POS tagg
>>> pos_tagger = CoreNLPParser('http://localhost:9005', tagtype='pos')
>>> list(pos_tagger.tag(parser.tokenize(text)))
[('انا', 'PRP'), ('حامل', 'NN')]

# NER tag
>>> ner_tagger = CoreNLPParser('http://localhost:9005', tagtype='ner')
>>> list(ner_tagger.tag(parser.tokenize(text)))
[('انا', 'O'), ('حامل', 'O')] 
```

# 法语

启动服务器：

```
java -Xmx4g -cp "*" edu.stanford.nlp.pipeline.StanfordCoreNLPServer \
-serverProperties StanfordCoreNLP-french.properties \
-preload tokenize,ssplit,pos,parse \
-status_port 9004  -port 9004 -timeout 15000 
```

在 Python 中：

```
>>> parser = CoreNLPParser('http://localhost:9004')
>>> list(parser.parse('Je suis enceinte'.split()))
[Tree('ROOT', [Tree('SENT', [Tree('NP', [Tree('PRON', ['Je']), Tree('VERB', ['suis']), Tree('AP', [Tree('ADJ', ['enceinte'])])])])])]
>>> pos_tagger = CoreNLPParser('http://localhost:9004', tagtype='pos')
>>> pos_tagger.tag('Je suis enceinte'.split())
[('Je', 'PRON'), ('suis', 'VERB'), ('enceinte', 'ADJ')] 
```

# 德语

启动服务器：

```
java -Xmx4g -cp "*" edu.stanford.nlp.pipeline.StanfordCoreNLPServer \
-serverProperties StanfordCoreNLP-german.properties \
-preload tokenize,ssplit,pos,ner,parse \
-status_port 9002  -port 9002 -timeout 15000 
```

在 Python 中：

```
>>> parser = CoreNLPParser('http://localhost:9002')
>>> list(parser.raw_parse('Ich bin schwanger'))
[Tree('ROOT', [Tree('NUR', [Tree('S', [Tree('PPER', ['Ich']), Tree('VAFIN', ['bin']), Tree('AP', [Tree('ADJD', ['schwanger'])])])])])]
>>> list(parser.parse('Ich bin schwanger'.split()))
[Tree('ROOT', [Tree('NUR', [Tree('S', [Tree('PPER', ['Ich']), Tree('VAFIN', ['bin']), Tree('AP', [Tree('ADJD', ['schwanger'])])])])])]

>>> pos_tagger = CoreNLPParser('http://localhost:9002', tagtype='pos')
>>> pos_tagger.tag('Ich bin schwanger'.split())
[('Ich', 'PPER'), ('bin', 'VAFIN'), ('schwanger', 'ADJD')]

>>> pos_tagger = CoreNLPParser('http://localhost:9002', tagtype='pos')
>>> pos_tagger.tag('Ich bin schwanger'.split())
[('Ich', 'PPER'), ('bin', 'VAFIN'), ('schwanger', 'ADJD')]

>>> ner_tagger = CoreNLPParser('http://localhost:9002', tagtype='ner')
>>> ner_tagger.tag('Donald Trump besuchte Angela Merkel in Berlin.'.split())
[('Donald', 'PERSON'), ('Trump', 'PERSON'), ('besuchte', 'O'), ('Angela', 'PERSON'), ('Merkel', 'PERSON'), ('in', 'O'), ('Berlin', 'LOCATION'), ('.', 'O')] 
```

# 西班牙语

启动服务器：

```
java -Xmx4g -cp "*" edu.stanford.nlp.pipeline.StanfordCoreNLPServer \
-serverProperties StanfordCoreNLP-spanish.properties \
-preload tokenize,ssplit,pos,ner,parse \
-status_port 9003  -port 9003 -timeout 15000 
```

在 Python 中：

```
>>> pos_tagger = CoreNLPParser('http://localhost:9003', tagtype='pos')
>>> pos_tagger.tag(u'Barack Obama salió con Michael Jackson .'.split())
[('Barack', 'PROPN'), ('Obama', 'PROPN'), ('salió', 'VERB'), ('con', 'ADP'), ('Michael', 'PROPN'), ('Jackson', 'PROPN'), ('.', 'PUNCT')]
>>> ner_tagger = CoreNLPParser('http://localhost:9003', tagtype='ner')
>>> ner_tagger.tag(u'Barack Obama salió con Michael Jackson .'.split())
[('Barack', 'PERSON'), ('Obama', 'PERSON'), ('salió', 'O'), ('con', 'O'), ('Michael', 'PERSON'), ('Jackson', 'PERSON'), ('.', 'O')] 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2013-01-17T09:58:37.843

## 已弃用的答案

以下答案已弃用，请使用[https://stackoverflow.com/a/51981566/610569](https://stackoverflow.com/a/51981566/610569)上的解决方案，用于 NLTK v3.3 及更高版本。

* * *

## 已编辑

从当前的斯坦福解析器 (2015-04-20) 开始， 的默认输出`lexparser.sh`已更改，因此下面的脚本将不起作用。

但是这个答案是为了遗留的缘故而保留的，它仍然可以与[http://nlp.stanford.edu/software/stanford-parser-2012-11-12.zip](http://nlp.stanford.edu/software/stanford-parser-2012-11-12.zip)一起使用。

* * *

## 原始答案

我建议你不要乱用 Jython，JPype。让python做python的东西，让java做java的东西，通过控制台得到Stanford Parser的输出。

在你的主目录中安装了[Stanford Parser](http://nlp.stanford.edu/software/stanford-parser-2012-11-12.zip)`~/`之后，只需使用这个 python 配方来获取平括号解析：

```
import os
sentence = "this is a foo bar i want to parse."

os.popen("echo '"+sentence+"' > ~/stanfordtemp.txt")
parser_out = os.popen("~/stanford-parser-2012-11-12/lexparser.sh ~/stanfordtemp.txt").readlines()

bracketed_parse = " ".join( [i.strip() for i in parser_out if i.strip()[0] == "("] )
print bracketed_parse 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-12-18T18:16:21.007

斯坦福解析器有python接口

[http://projects.csail.mit.edu/spatial/Stanford_Parser](http://projects.csail.mit.edu/spatial/Stanford_Parser)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-08-21T19:28:10.540

斯坦福核心 NLP 软件页面有一个 python 包装器列表：

[http://nlp.stanford.edu/software/corenlp.shtml#Extensions](http://nlp.stanford.edu/software/corenlp.shtml#Extensions)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-09-11T02:54:54.243

请注意，此答案适用于 NLTK v 3.0，而不适用于更新的版本。

这是对danger98的代码的改编，适用于windoze上的nltk3.0.0，并且可能还有其他平台，根据您的设置调整目录名称：

```
import os
from nltk.parse import stanford
os.environ['STANFORD_PARSER'] = 'd:/stanford-parser'
os.environ['STANFORD_MODELS'] = 'd:/stanford-parser'
os.environ['JAVAHOME'] = 'c:/Program Files/java/jre7/bin'

parser = stanford.StanfordParser(model_path="d:/stanford-grammars/englishPCFG.ser.gz")
sentences = parser.raw_parse_sents(("Hello, My name is Melroy.", "What is your name?"))
print sentences 
```

请注意，解析命令已更改（请参阅 www.nltk.org/_modules/nltk/parse/stanford.html 上的源代码），并且您需要定义 JAVAHOME 变量。我试图让它在 jar 中原位读取语法文件，但到目前为止还没有做到这一点。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-12-14T17:25:37.610

如果我没记错的话，斯坦福解析器是一个 Java 库，因此您的服务器/计算机上必须运行 Java 解释器。

我曾经在服务器上使用过它，并结合了一个 php 脚本。该脚本使用 php 的 exec() 函数对解析器进行命令行调用，如下所示：

```
<?php

exec( "java -cp /pathTo/stanford-parser.jar -mx100m edu.stanford.nlp.process.DocumentPreprocessor /pathTo/fileToParse > /pathTo/resultFile 2>/dev/null" );

?> 
```

我不记得这个命令的所有细节，它基本上打开了fileToParse，解析它，并将输出写入resultFile。然后 PHP 将打开结果文件以供进一步使用。

命令的结尾将解析器的详细信息设置为 NULL，以防止不必要的命令行信息干扰脚本。

我对 Python 不太了解，但可能有一种方法可以进行命令行调用。

这可能不是您希望的确切路线，但希望它能给您一些启发。祝你好运。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-08-01T16:11:06.027

您可以使用 Stanford Parsers 输出在 nltk (nltk.tree.Tree) 中创建树。

假设 stanford 解析器为您提供了一个文件，其中每个句子都有一个解析树。然后这个例子可以工作，虽然它可能看起来不是很pythonic：

```
f = open(sys.argv[1]+".output"+".30"+".stp", "r")
parse_trees_text=[]
tree = ""
for line in f:
  if line.isspace():
    parse_trees_text.append(tree)
tree = ""
  elif "(. ...))" in line:
#print "YES"
tree = tree+')'
parse_trees_text.append(tree)
tree = ""
  else:
tree = tree + line

parse_trees=[]
for t in parse_trees_text:
  tree = nltk.Tree(t)
  tree.__delitem__(len(tree)-1) #delete "(. .))" from tree (you don't need that)
  s = traverse(tree)
  parse_trees.append(tree) 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-04-08T16:41:39.210

请注意，此答案适用于 NLTK v 3.0，而不适用于更新的版本。

由于没有人真正提及并且不知何故让我很困扰，这是在 python 中使用斯坦福解析器的另一种方法：

```
stanford_parser_jar = '../lib/stanford-parser-full-2015-04-20/stanford-parser.jar'
stanford_model_jar = '../lib/stanford-parser-full-2015-04-20/stanford-parser-3.5.2-models.jar'    
parser = StanfordParser(path_to_jar=stanford_parser_jar, 
                        path_to_models_jar=stanford_model_jar) 
```

这样，您就不必再担心路径的事情了。

对于那些不能在 Ubuntu 上正确使用它或在 Eclipse 中运行代码的人。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-03-06T16:30:57.210

我在 Windows 机器上，您可以像从命令一样正常运行解析器，但在不同的目录中，因此您不需要编辑 lexparser.bat 文件。只需输入完整路径即可。

```
cmd = r'java -cp \Documents\stanford_nlp\stanford-parser-full-2015-01-30 edu.stanford.nlp.parser.lexparser.LexicalizedParser -outputFormat "typedDependencies" \Documents\stanford_nlp\stanford-parser-full-2015-01-30\stanford-parser-3.5.1-models\edu\stanford\nlp\models\lexparser\englishFactored.ser.gz stanfordtemp.txt'
parse_out = os.popen(cmd).readlines() 
```

对我来说，棘手的部分是实现如何从不同的路径运行 java 程序。必须有更好的方法，但这有效。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-12-11T03:46:27.080

请注意，此答案适用于 NLTK v 3.0，而不适用于更新的版本。

这是阿尔瓦斯答案的Windows版本

```
sentences = ('. '.join(['this is sentence one without a period','this is another foo bar sentence '])+'.').encode('ascii',errors = 'ignore')
catpath =r"YOUR CURRENT FILE PATH"

f = open('stanfordtemp.txt','w')
f.write(sentences)
f.close()

parse_out = os.popen(catpath+r"\nlp_tools\stanford-parser-2010-08-20\lexparser.bat "+catpath+r"\stanfordtemp.txt").readlines()

bracketed_parse = " ".join( [i.strip() for i in parse_out if i.strip() if i.strip()[0] == "("] )
bracketed_parse = "\n(ROOT".join(bracketed_parse.split(" (ROOT")).split('\n')
aa = map(lambda x :ParentedTree.fromstring(x),bracketed_parse) 
```

**笔记：**

*   在`lexparser.bat` 您需要将所有路径更改为绝对路径以避免java错误，例如“找不到类”

*   我强烈建议您在 windows 下应用此方法，因为我在页面上尝试了几个答案，并且所有方法将 python 与 Java 通信都失败了。

*   如果您在 Windows 上取得成功，希望收到您的来信，并希望您能告诉我您是如何克服所有这些问题的。

*   在 python 包装器中搜索 stanford coreNLP 以获取 python 版本

* * *

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2015-08-28T10:31:03.000

请注意，此答案适用于 NLTK v 3.0，而不适用于更新的版本。

关于在 NLTK 和 Python 中使用 Stanford Parser 的危险89 的全面答案的轻微更新（或简单的替代）

使用 stanford-parser-full-2015-04-20、JRE 1.8 和 nltk 3.0.4 (python 2.7.6)，您似乎不再需要从 stanford-parser-xxx-models 中提取 englishPCFG.ser.gz .jar 或设置任何 os.environ

```
from nltk.parse.stanford import StanfordParser

english_parser = StanfordParser('path/stanford-parser.jar', 'path/stanford-parser-3.5.2-models.jar')

s = "The real voyage of discovery consists not in seeking new landscapes, but in having new eyes."

sentences = english_parser.raw_parse_sents((s,))
print sentences #only print <listiterator object> for this version

#draw the tree
for line in sentences:
    for sentence in line:
        sentence.draw() 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-10-18T00:45:28.537

请注意，此答案适用于 NLTK v 3.0，而不适用于更新的版本。

由于声誉问题，我不能将此作为评论，但由于我花了（浪费？）一些时间来解决这个问题，我宁愿分享我的问题/解决方案，让这个解析器在 NLTK 中工作。

在[alvas的](https://stackoverflow.com/a/34112695/5303618)**出色** 回答中，提到：

> 例如对于解析器，不会有模型目录。

这导致我错误地：

*   不小心我投入的价值`STANFORD_MODELS` （只关心我的`CLASSPATH`）
*   保留`../path/tostanford-parser-full-2015-2012-09/models directory`* 几乎为空*（或使用名称与 nltk 正则表达式不匹配的 jar 文件）！

如果像我一样的 OP 只是想使用解析器，那么当不下载其他任何东西（没有 POSTagger、没有 NER，...）并按照所有这些说明进行操作时，我们仍然会遇到错误，这可能会令人困惑。

最终，对于任何`CLASSPATH`给定的（遵循该线程答案中的示例和解释），我仍然会收到错误消息：

> NLTK 无法找到 stanford-parser-(\d+)(.(\d+))+-models.jar！设置 CLASSPATH 环境变量。有关更多信息，请参阅 stanford-parser-(\d+)(.(\d+))+-models.jar，

见： http: [//nlp.stanford.edu/software/lex-parser.shtml](http://nlp.stanford.edu/software/lex-parser.shtml)

或者：

> NLTK 无法找到 stanford-parser.jar！设置 CLASSPATH 环境变量。有关 stanford-parser.jar 的更多信息，请参阅： http: [//nlp.stanford.edu/software/lex-parser.shtml](http://nlp.stanford.edu/software/lex-parser.shtml)

*不过*，重要的是，如果我调用函数并完全指定所有参数和路径，我可以正确加载和使用解析器，如下所示：

```
stanford_parser_jar = '../lib/stanford-parser-full-2015-04-20/stanford-parser.jar'
stanford_model_jar = '../lib/stanford-parser-full-2015-04-20/stanfor-parser-3.5.2-models.jar'    
parser = StanfordParser(path_to_jar=stanford_parser_jar, 
                    path_to_models_jar=stanford_model_jar) 
```

## 单独解析器的解决方案：

因此，错误来自`NLTK`以及它是如何使用提供的`STANFORD_MODELS`和`CLASSPATH`环境变量来查找 jar 的。为了解决这个问题`*-models.jar`，具有正确格式（以匹配`NLTK`代码中的正则表达式，因此没有 -corenlp-....jar）的 , 必须位于由`STANFORD_MODELS`.

即，我首先创建了：

```
mkdir stanford-parser-full-2015-12-09/models 
```

然后添加`.bashrc`：

```
export STANFORD_MODELS=/path/to/stanford-parser-full-2015-12-09/models 
```

最后，通过复制`stanford-parser-3.6.0-models.jar`（或相应版本）到：

```
path/to/stanford-parser-full-2015-12-09/models/ 
```

我可以`StanfordParser`使用`CLASSPATH`指向`stanford-parser.jar`. 实际上，您可以`StanfordParser`不带参数调用，默认值就可以了。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-03-18T08:21:13.900

## 已弃用的答案

以下答案已弃用，请使用[https://stackoverflow.com/a/51981566/610569](https://stackoverflow.com/a/51981566/610569)上的解决方案，用于 NLTK v3.3 及更高版本。

* * *

# 已编辑

注意：以下答案仅适用于：

*   NLTK 版本 ==3.2.5
*   斯坦福工具自 2016-10-31 编译
*   Python 2.7、3.5 和 3.6

由于这两种工具的变化都很快，而且 API 可能在 3-6 个月后看起来非常不同。请将以下答案视为暂时的，而不是永恒的解决方案。

有关如何使用 NLTK 连接斯坦福 NLP 工具的最新说明，请始终参考[https://github.com/nltk/nltk/wiki/Installing-Third-Party-Software ！](https://github.com/nltk/nltk/wiki/Installing-Third-Party-Software)

# TL;博士

以下代码来自[https://github.com/nltk/nltk/pull/1735#issuecomment-306091826](https://github.com/nltk/nltk/pull/1735#issuecomment-306091826)

在终端：

```
wget http://nlp.stanford.edu/software/stanford-corenlp-full-2016-10-31.zip
unzip stanford-corenlp-full-2016-10-31.zip && cd stanford-corenlp-full-2016-10-31

java -mx4g -cp "*" edu.stanford.nlp.pipeline.StanfordCoreNLPServer \
-preload tokenize,ssplit,pos,lemma,parse,depparse \
-status_port 9000 -port 9000 -timeout 15000 
```

在 Python 中：

```
>>> from nltk.tag.stanford import CoreNLPPOSTagger, CoreNLPNERTagger
>>> from nltk.parse.corenlp import CoreNLPParser

>>> stpos, stner = CoreNLPPOSTagger(), CoreNLPNERTagger()

>>> stpos.tag('What is the airspeed of an unladen swallow ?'.split())
[(u'What', u'WP'), (u'is', u'VBZ'), (u'the', u'DT'), (u'airspeed', u'NN'), (u'of', u'IN'), (u'an', u'DT'), (u'unladen', u'JJ'), (u'swallow', u'VB'), (u'?', u'.')]

>>> stner.tag('Rami Eid is studying at Stony Brook University in NY'.split())
[(u'Rami', u'PERSON'), (u'Eid', u'PERSON'), (u'is', u'O'), (u'studying', u'O'), (u'at', u'O'), (u'Stony', u'ORGANIZATION'), (u'Brook', u'ORGANIZATION'), (u'University', u'ORGANIZATION'), (u'in', u'O'), (u'NY', u'O')]

>>> parser = CoreNLPParser(url='http://localhost:9000')

>>> next(
...     parser.raw_parse('The quick brown fox jumps over the lazy dog.')
... ).pretty_print()  # doctest: +NORMALIZE_WHITESPACE
                     ROOT
                      |
                      S
       _______________|__________________________
      |                         VP               |
      |                _________|___             |
      |               |             PP           |
      |               |     ________|___         |
      NP              |    |            NP       |
  ____|__________     |    |     _______|____    |
 DT   JJ    JJ   NN  VBZ   IN   DT      JJ   NN  .
 |    |     |    |    |    |    |       |    |   |
The quick brown fox jumps over the     lazy dog  .

>>> (parse_fox, ), (parse_wolf, ) = parser.raw_parse_sents(
...     [
...         'The quick brown fox jumps over the lazy dog.',
...         'The quick grey wolf jumps over the lazy fox.',
...     ]
... )

>>> parse_fox.pretty_print()  # doctest: +NORMALIZE_WHITESPACE
                     ROOT
                      |
                      S
       _______________|__________________________
      |                         VP               |
      |                _________|___             |
      |               |             PP           |
      |               |     ________|___         |
      NP              |    |            NP       |
  ____|__________     |    |     _______|____    |
 DT   JJ    JJ   NN  VBZ   IN   DT      JJ   NN  .
 |    |     |    |    |    |    |       |    |   |
The quick brown fox jumps over the     lazy dog  .

>>> parse_wolf.pretty_print()  # doctest: +NORMALIZE_WHITESPACE
                     ROOT
                      |
                      S
       _______________|__________________________
      |                         VP               |
      |                _________|___             |
      |               |             PP           |
      |               |     ________|___         |
      NP              |    |            NP       |
  ____|_________      |    |     _______|____    |
 DT   JJ   JJ   NN   VBZ   IN   DT      JJ   NN  .
 |    |    |    |     |    |    |       |    |   |
The quick grey wolf jumps over the     lazy fox  .

>>> (parse_dog, ), (parse_friends, ) = parser.parse_sents(
...     [
...         "I 'm a dog".split(),
...         "This is my friends ' cat ( the tabby )".split(),
...     ]
... )

>>> parse_dog.pretty_print()  # doctest: +NORMALIZE_WHITESPACE
        ROOT
         |
         S
  _______|____
 |            VP
 |    ________|___
 NP  |            NP
 |   |         ___|___
PRP VBP       DT      NN
 |   |        |       |
 I   'm       a      dog 
```

有关斯坦福 API 的更多信息，请查看[http://www.nltk.org/_modules/nltk/parse/corenlp.html](http://www.nltk.org/_modules/nltk/parse/corenlp.html) 。看看文档字符串！

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-12-16T09:20:48.473

我花了好几个小时终于为 Windows 用户找到了一个简单的解决方案。基本上它是 alvas[现有答案](https://stackoverflow.com/a/34112695/4566277)的总结版本，但对于那些刚接触斯坦福 NLP 并且是 Window 用户的人来说，它很容易理解（希望如此）。

**1）**下载你想使用的模块，比如NER，POS等。在我的例子中，我想使用NER，所以我从[http://nlp.stanford.edu/software/stanford-ner-2015-下载了模块04-20.zip](http://nlp.stanford.edu/software/stanford-ner-2015-04-20.zip)

**2）**解压文件。

**3)**从解压后的文件夹中设置环境变量（classpath 和 stanford_modules）。

```
import os
os.environ['CLASSPATH'] = "C:/Users/Downloads/stanford-ner-2015-04-20/stanford-ner.jar"
os.environ['STANFORD_MODELS'] = "C:/Users/Downloads/stanford-ner-2015-04-20/classifiers/" 
```

**4)**设置 JAVA 的环境变量，就像安装 JAVA 的地方一样。对我来说它在下面

```
os.environ['JAVAHOME'] = "C:/Program Files/Java/jdk1.8.0_102/bin/java.exe" 
```

**5）**导入你想要的模块

```
from nltk.tag import StanfordNERTagger 
```

**6）**调用解压缩文件夹中分类器文件夹中存在的预训练模型。最后添加“.gz”作为文件扩展名。对我来说，我想使用的模型是`english.all.3class.distsim.crf.ser`

```
st = StanfordNERTagger('english.all.3class.distsim.crf.ser.gz') 
```

**7)**现在执行解析器！！我们完成了！

```
st.tag('Rami Eid is studying at Stony Brook University in NY'.split()) 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2017-09-14T09:39:55.697

我正在使用 nltk 版本 3.2.4。以下代码对我有用。

```
from nltk.internals import find_jars_within_path
from nltk.tag import StanfordPOSTagger
from nltk import word_tokenize

# Alternatively to setting the CLASSPATH add the jar and model via their 
path:
jar = '/home/ubuntu/stanford-postagger-full-2017-06-09/stanford-postagger.jar'
model = '/home/ubuntu/stanford-postagger-full-2017-06-09/models/english-left3words-distsim.tagger'

pos_tagger = StanfordPOSTagger(model, jar)

# Add other jars from Stanford directory
stanford_dir = pos_tagger._stanford_jar.rpartition('/')[0]
stanford_jars = find_jars_within_path(stanford_dir)
pos_tagger._stanford_jar = ':'.join(stanford_jars)

text = pos_tagger.tag(word_tokenize("Open app and play movie"))
print(text) 
```

输出：

```
[('Open', 'VB'), ('app', 'NN'), ('and', 'CC'), ('play', 'VB'), ('movie', 'NN')] 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-09-03T08:04:07.300

基于神经模型的斯坦福解析器的新开发，使用 Tensorflow 训练，最近可用作 python API。这个模型应该比基于 Java 的模型要准确得多。您当然可以与 NLTK 管道集成。

[链接](https://stanfordnlp.github.io/stanfordnlp/index.html)到解析器。Ther 存储库包含 53 种语言的预训练解析器模型。

# java - 使用处理程序创建频闪、闪烁背景

> ID：13883284
> 
> 赞同：0
> 
> 时间：2012-12-14T17:12:34.473
> 
> 标签：java, android, android-layout

我正在尝试在我的应用程序的背景中制作频闪效果。我读到处理程序会工作得最好，但我只是不确定如何应用它们。我看到了[这个帖子](https://stackoverflow.com/questions/12810705/how-do-i-make-a-layout-background-flashing-in-android)

```
 public boolean onTouch(View v, MotionEvent event) {

    final int DELAY = 100;

    if(event.getAction() == MotionEvent.ACTION_UP) {

        RelativeLayout fondo = (RelativeLayout) findViewById(R.id.fondo);

        ColorDrawable f = new ColorDrawable(0xff00ff00);
        ColorDrawable f2 = new ColorDrawable(0xffff0000);
        ColorDrawable f3 = new ColorDrawable(0xff0000ff);
        ColorDrawable f4 = new ColorDrawable(0xff0000ff);

        AnimationDrawable a = new AnimationDrawable();
        a.addFrame(f, DELAY);
        a.addFrame(f2, DELAY);
        a.addFrame(f3, DELAY);
        a.addFrame(f4, DELAY);
        a.setOneShot(false);

        fondo.setBackgroundDrawable(a); // This method is deprecated in API 16
        // fondo.setBackground(a); // Use this method if you're using API 16
        a.start();
     }
     return true;
} 
```

我需要做什么来解决这个问题？有没有办法在没有处理程序的情况下做到这一点？

```
 package com.example.converter;

import android.app.Activity;
import android.graphics.drawable.AnimationDrawable;
import android.graphics.drawable.ColorDrawable;
import android.view.MotionEvent;
import android.view.View;
import android.widget.RelativeLayout;

public class Savannah extends Activity {

    RelativeLayout r = (RelativeLayout) findViewById(R.layout.activity_savannah);
    r.setOnTouchListener=(new OnTouchListener() {

        @Override
        public boolean onTouch(View view, MotionEvent event) {

            final int DELAY = 100;

            if (event.getAction() == MotionEvent.ACTION_UP) {

                RelativeLayout fondo = (RelativeLayout) findViewById(R.layout.activity_savannah);

                ColorDrawable f = new ColorDrawable(0xff00ff00);
                ColorDrawable f2 = new ColorDrawable(0xffff0000);
                ColorDrawable f3 = new ColorDrawable(0xff0000ff);
                ColorDrawable f4 = new ColorDrawable(0xff0000ff);

                AnimationDrawable a = new AnimationDrawable();
                a.addFrame(f, DELAY);
                a.addFrame(f2, DELAY);
                a.addFrame(f3, DELAY);
                a.addFrame(f4, DELAY);
                a.setOneShot(false);

                fondo.setBackgroundDrawable(a); // This method is deprecated
                                                // in API
                                                // 16
                // fondo.setBackground(a); // Use this method if you're
                // using API 16
                a.start();
            }
            return true;
        }
    });
} 
```

这就是我所拥有的，但 seontouch 侦听器正在标记错误，就像 ontouch 视图视图运动事件一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:51:53.110

这是我测试自己并完美运行的代码：

```
RelativeLayout r = (RelativeLayout) findViewById(R.id.relativeLayout1);
    r.setOnTouchListener(new OnTouchListener() {

        @Override
        public boolean onTouch(View v, MotionEvent event) {

            final int DELAY = 100;

            if (event.getAction() == MotionEvent.ACTION_UP) {

                RelativeLayout fondo = (RelativeLayout) findViewById(R.id.relativeLayout1);

                ColorDrawable f = new ColorDrawable(0xff00ff00);
                ColorDrawable f2 = new ColorDrawable(0xffff0000);
                ColorDrawable f3 = new ColorDrawable(0xff0000ff);
                ColorDrawable f4 = new ColorDrawable(0xff0000ff);

                AnimationDrawable a = new AnimationDrawable();
                a.addFrame(f, DELAY);
                a.addFrame(f2, DELAY);
                a.addFrame(f3, DELAY);
                a.addFrame(f4, DELAY);
                a.setOneShot(false);

                fondo.setBackgroundDrawable(a); // This method is deprecated
                                                // in API
                                                // 16
                // fondo.setBackground(a); // Use this method if you're
                // using API 16
                a.start();
            }
            return true;
        }
    }); 
```

# java - 在这种情况下，为什么枚举比 HashMap 更有用？

> ID：13883287
> 
> 赞同：4
> 
> 时间：2012-12-14T17:12:47.487
> 
> 标签：java, class, enums, hashmap

这似乎是一个常见问题，但建议框中的所有项目都没有准确解释我的疑惑。在[这个链接](https://stackoverflow.com/questions/13882566/better-way-to-map-from-string-constants-to-int-constants-in-java)中，每个人都建议使用枚举类型（我现在已经研究过，但之前从未使用过）。我正要建议简单地使用 HashMap 并阅读答案以查看 Enum ( [http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html](http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html) ) 实际上是否是一个更好的答案。根据 oracle 上的链接，“您应该在需要表示一组固定常量的任何时候使用枚举类型。” 所以，是的。

我的问题是……为什么？是不是更多的是形成一个他们不会改变的合同？这是获得某些类功能的更短的方法吗？表现如何？为什么这与在同一个类中定义常量有什么不同？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T17:19:34.887

类型安全确实是一个很好的理由：当您将 String 传递给方法时，它可以是任何东西。如果你传递一个枚举，你确定它是合法值之一。如果可能性有限，枚举是好的。如果您需要扩展值，则 HashMaps 很好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-14T17:18:03.310

枚举实例是对象，就像任何其他对象一样封装数据和行为。通过传递枚举实例，任何人都可以调用它的方法。例如，如果您将 Map 键作为字符串传递，则您无法对键执行任何有用的操作。此外，代码的类型安全性和自文档化程度较低，因为 String 很可能与应有的完全不同。

什么是最易读的？

```
public int countDays(Set<Month> months, int year) {
    int count = 0;
    for (Month month : months) {
        count += month.getDays(year);
    }
    return count;
} 
```

或者

```
public int countDays(Set<String> months, int year) {
    int count = 0;
    for (String month : months) {
        int days = monthMap.get(month);
        if (month.equals(Months.FEBRUARY)) {
            days = computeDaysInFebruary(year);
        }
        count += days;
    }
    return count;
} 
```

如果我在集合中传递的不是月份名称怎么办？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-14T17:19:59.993

枚举是一种非常有限的数据类型，它可以让你将可能的值限制在一个集合中并在编译时避免其他值，所以如果你犯了错误，它甚至不会*编译*。HashMap 可以让您插入许多无效值，努力在运行时检测到它们，但当然它无论如何都会编译。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-14T17:18:31.210

你说的所有理由都非常正确。

枚举更有效，因为它存储为不可变的值列表，并且不必像字典那样支持尽可能多的操作。此外，枚举实例只是在内部存储为单个数字，并且可以像定义自己的“静态最终整数”列表一样使用。

此外，它们增加了类型安全性，因为您不必担心将实际数值与表示某些选项的整数进行比较；枚举只能与其他枚举进行比较。它也不能像字典那样被修改，所以你知道在编译时给出的值在运行时是相同的。

但是，我相信，最重要的原因是它增加了语义价值。这正是枚举的目的——定义一组不变的选项并将自己限制在这些选项中。如果您使用枚举，每个人都将能够直观地理解您正在尝试做什么。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-14T17:20:01.040

hashmap 使用大量内存，即使您有恒定的时间查找和插入，仍然需要进行良好的处理。必须计算散列，然后必须解决冲突的插槽等......而枚举通常仅存储在 4 个字节中，是类型安全的，高效，并且对其他程序员来说很明显你正在使用它。

另一个好处是您可以轻松地在枚举值之间使用位算术来表示其他值。Windows API 经常这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-14T17:16:18.217

在我看来，它们只是更快地声明和使用，而且，正如 oracle 所说，它们更适合常量。枚举无法修改，所以我猜它们的资源使用量较小。

# php - 将数组键作为字段值插入 - mysql/php

> ID：13883291
> 
> 赞同：2
> 
> 时间：2012-12-14T17:12:55.357
> 
> 标签：php, mysql

我有多个命名键，每个键都分配了一个 0 到 5 之间的值。

我创建了一个数组和数组过滤器，以仅保留已分配值 > 0 的键。从数组中删除任何 0 值对。

我需要的是一种在同一个表中插入键名和分配为单独字段的值的方法。

列名称是技能名称和值。

提交后的数组：

`Array ( [Academics] => 2 [Animal_Ken] => 3 [Athletics] => 2 [Awareness] => 0 [Blood_Sense] => 0 [Brawl] => 0 [Craft] => 0 [Dodge] => 0 [Empathy] => 0 [Enigma] => 0 [Etiquette] => 0 [Expression] => 0 [Finance] => 0 [Firearms] => 0 [Intimidation] => 0 [Investigation] => 0 [Larceny] => 0 [Law] => 0 [Leadership] => 0 [Linguistics] => 0 [Malkavian_Time] => 0 [Medicine] => 0 [Melee] => 0 [Occult] => 0 [Performance] => 0 [Politics] => 0 [Science] => 0 [Scrounge] => 0 [Security] => 0 [Stealth] => 0 [Streetwise] => 0 [Subterfuge] => 0 [Survival] => 0 [submit_skills] => Add Skills )`

过滤后的数组：

`Array ( [Academics] => 2 [Animal_Ken] => 3 [Athletics] => 2 )`

现在我需要为每个数组索引插入 Skill_name = key, value = value。

有任何想法吗？

**编辑**

在接受建议后，我得到的一切似乎都正常运行。

现在我遇到的问题是，名称中包含空格的任何键现在默认都带有下划线。

例如：Animal Ken --> Animal_Ken .. 数据库因此拒绝插入。

有什么办法可以去掉下划线并再次将其留作空格？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T17:15:23.083

使用 foreach 并包含密钥。

带有[PDO](http://php.net/manual/en/book.pdo.php)参数化查询的示例：

```
$stmt = $db->prepare("INSERT INTO table(skill_name, value) VALUES(:skill_name,:value)");

foreach($myArray as $key => $value)
{
   // insert: $key = Academics, $value = 2
   $stmt->execute(array(':skill_name ' => $key, ':value' => $value));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:54:13.307

正如 MrCode 建议的那样，foreach 是要走的路。请参阅下面使用内置 mysqli_query PHP 函数的程序方法。

```
// start building query
$q = "INSERT INTO table (skill_name, value) VALUES";

// loop through array, adding values to query
foreach($array as $key => $value) {
    $q .= " ('$key', $value),";
}

// remove the last comma
$q = substr($q, 0, -1);

// run query
mysqli_query($your_db_connection, $q); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-17T01:13:06.327

找到了我编辑的答案。

```
function fixArrayKey(&$arr)
{
    $arr=array_combine(array_map(function($str){return str_replace("_"," ",$str);},array_keys($arr)),array_values($arr));
    foreach($arr as $key=>$val)
    {
        if(is_array($val)) fixArrayKey($arr[$key]);
    }
} 
```

向路人提供道具，以在[此处](https://stackoverflow.com/questions/13391869/replacing-array-key-spaces-with-underscores-in-multidimensional-array)找到的相关文章中发布此内容：

# java - 在 Java 中将 ExecutorService 变成守护进程

> ID：13883293
> 
> 赞同：88
> 
> 时间：2012-12-14T17:13:09.400
> 
> 标签：java, multithreading, threadpool, executorservice, java-threads

我在 Java 1.6 中使用 ExecutoreService，只需通过

```
ExecutorService pool = Executors.newFixedThreadPool(THREADS). 
```

当我的主线程完成时（以及线程池处理的所有任务），这个池将阻止我的程序关闭，直到我明确调用

```
pool.shutdown(); 
```

我可以通过某种方式将此池使用的内部线程管理转换为守护线程来避免调用它吗？或者我在这里错过了什么。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2012-12-14T17:21:22.663

可能最简单和首选的解决方案在[Marco13 的答案](https://stackoverflow.com/a/29453160/1393766)中，所以不要被投票差异（这个答案比这个答案早几年）或接受标记所迷惑（这只是意味着这个解决方案适合 OP 情况，而不是一般来说最好） .

* * *

您可以使用`ThreadFactory`将 Executor 中的线程设置为守护进程。这将以某种方式影响执行程序服务，它也将成为守护线程，因此如果没有其他非守护线程，它（以及由它处理的线程）将停止。这是一个简单的例子：

```
ExecutorService exec = Executors.newFixedThreadPool(4,
        new ThreadFactory() {
            public Thread newThread(Runnable r) {
                Thread t = Executors.defaultThreadFactory().newThread(r);
                t.setDaemon(true);
                return t;
            }
        });

exec.execute(YourTaskNowWillBeDaemon); 
```

* * *

但是如果你想得到 executor 来完成它的任务，同时`shutdown()`在应用程序完成时自动调用它的方法，你可能想用[Guava 的](https://github.com/google/guava) [`MoreExecutors.getExitingExecutorService`](https://google.github.io/guava/releases/snapshot-jre/api/docs/com/google/common/util/concurrent/MoreExecutors.html#getExitingExecutorService-java.util.concurrent.ThreadPoolExecutor-long-java.util.concurrent.TimeUnit-).

```
ExecutorService exec = MoreExecutors.getExitingExecutorService(
        (ThreadPoolExecutor) Executors.newFixedThreadPool(4), 
        100_000, TimeUnit.DAYS//period after which executor will be automatically closed
                             //I assume that 100_000 days is enough to simulate infinity
);
//exec.execute(YourTask);
exec.execute(() -> {
    for (int i = 0; i < 3; i++) {
        System.out.println("daemon");
        try {
            TimeUnit.SECONDS.sleep(1);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2015-04-05T01:19:32.943

已经有一个内置功能用于创建一个`ExecutorService`在一段时间不活动后终止所有线程：您可以创建一个`ThreadPoolExecutor`，将所需的时间信息传递给它，然后调用`allowCoreThreadTimeout(true)`这个执行器服务：

```
/**
 * Creates an executor service with a fixed pool size, that will time 
 * out after a certain period of inactivity.
 * 
 * @param poolSize The core- and maximum pool size
 * @param keepAliveTime The keep alive time
 * @param timeUnit The time unit
 * @return The executor service
 */
public static ExecutorService createFixedTimeoutExecutorService(
    int poolSize, long keepAliveTime, TimeUnit timeUnit)
{
    ThreadPoolExecutor e = 
        new ThreadPoolExecutor(poolSize, poolSize,
            keepAliveTime, timeUnit, new LinkedBlockingQueue<Runnable>());
    e.allowCoreThreadTimeOut(true);
    return e;
} 
```

> 编辑参考评论中的备注：注意，这个线程池执行器不会在应用程序退出时自动关闭。执行器会在应用退出后继续运行，但不会超过`keepAliveTime`. 如果根据具体的应用程序要求，`keepAliveTime`必须超过几秒钟，[Pshemo 的答案](https://stackoverflow.com/a/13883412/3182664)中的解决方案可能更合适：当线程设置为守护线程时，它们将在应用程序退出时立即结束.

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2015-04-08T16:35:06.230

我会使用 Guava 的 ThreadFactoryBuilder 类。

```
ExecutorService threadPool = Executors.newFixedThreadPool(THREADS, new ThreadFactoryBuilder().setDaemon(true).build()); 
```

[如果您还没有使用 Guava，我会使用 ThreadFactory 子类，如Pshemo 答案](https://stackoverflow.com/a/13883412/1024576)顶部所述

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-08-19T22:22:23.937

如果您只想在一个地方使用它，那么您可以内联`java.util.concurrent.ThreadFactory`实现，例如对于您将编写的具有 4 个线程的池（示例显示为 lambda，假设 Java 1.8 或更高版本）：

```
ExecutorService pool = Executors.newFixedThreadPool(4,
        (Runnable r) -> {
            Thread t = new Thread(r);
            t.setDaemon(true);
            return t;
        }
); 
```

但是我通常希望我所有的 Thread 工厂都产生守护线程，所以我添加了一个实用程序类，如下所示：

```
import java.util.concurrent.ThreadFactory;

public class DaemonThreadFactory implements ThreadFactory {

    public final static ThreadFactory instance = 
                    new DaemonThreadFactory();

    @Override
    public Thread newThread(Runnable r) {
        Thread t = new Thread(r);
        t.setDaemon(true);
        return t;
    }
} 
```

这使我可以轻松地传递`DaemonThreadFactory.instance`给`ExecutorService`例如

```
ExecutorService pool = Executors.newFixedThreadPool(
    4, DaemonThreadFactory.instance
); 
```

或使用它轻松地从 a 启动*守护进程*线程`Runnable`，例如

```
DaemonThreadFactory.instance.newThread(
    () -> { doSomething(); }
).start(); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-12-14T17:14:42.207

是的。

您只需要创建自己的`ThreadFactory`类来创建守护线程而不是常规线程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-09T18:17:05.983

此解决方案类似于@Marco13，但不是创建我们自己的`ThreadPoolExecutor`，而是可以修改由`Executors#newFixedThreadPool(int nThreads)`. 就是这样：

```
ExecutorService ex = Executors.newFixedThreadPool(nThreads);
 if(ex instanceof ThreadPoolExecutor){
    ThreadPoolExecutor tp = (ThreadPoolExecutor) ex;
    tp.setKeepAliveTime(time, timeUnit);
    tp.allowCoreThreadTimeOut(true);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-21T11:08:03.900

这并不能*完全*回答手头的问题，但它可能很有用：

正如其他人评论的那样，您可以创建 DaemonThreadFactory，内联或作为实用程序类。

通过继承 Runnable，您可以从上述工厂获取生成的 DaemonThread，以在单独生成的非守护线程中执行整个可运行单元。在正常情况下，即使 Executor 中使用的守护线程被指定为关闭，这个非守护线程也会完成。

这是一个小例子：

```
import static java.util.concurrent.TimeUnit.*;

import java.time.*;
import java.time.format.DateTimeFormatter;
import java.util.concurrent.*;

public class ScheduleStackOverflow {

    private static final DateTimeFormatter DTF_HH_MM_SS = DateTimeFormatter.ofPattern("HH:mm:ss.SSS");

    private static final class ThreadRunnable implements Runnable {

        private final Runnable runnable;

        public ThreadRunnable(final Runnable runnable) {
            this.runnable = runnable;
        }
        @Override
        public void run() {
            final Thread delegateThread = new Thread(this.runnable);
            /**/         delegateThread.setDaemon(false); // TODO Try changing this to "true"
            /**/         delegateThread.start();
        }
    }

    public static void main(final String[] args) throws InterruptedException {

        final     ThreadFactory daemonThreadFactory = (daemonRunnable) -> {
            final Thread        daemon = new Thread   (daemonRunnable);
            /**/                daemon.setDaemon(true);
            return              daemon;
        };

        final Runnable runnable = new ThreadRunnable(() -> {
            System.out.println(DTF_HH_MM_SS.format(LocalTime.now()) + " daemon=" + Thread.currentThread().isDaemon() + " Scheduling...");

            sleep(5, SECONDS);

            System.out.println(DTF_HH_MM_SS.format(LocalTime.now()) + " daemon=" + Thread.currentThread().isDaemon() + " Schedule done.");
        });

        Executors
        .newSingleThreadScheduledExecutor(daemonThreadFactory)
        .scheduleAtFixedRate(runnable, 0, Duration.ofSeconds(10).toNanos(), NANOSECONDS);

        sleep(12, SECONDS);

        System.out.println(DTF_HH_MM_SS.format(LocalTime.now()) + " Main CLOSED!");
    }

    private static void sleep(final long timeout, final TimeUnit timeunit) {
        try {timeunit.sleep(timeout);} catch (InterruptedException e) {}
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-07-04T20:39:29.690

您可以使用 Guava 的 ThreadFactoryBuilder。我不想添加依赖项，我想要 Executors.DefaultThreadFactory 的功能，所以我使用了组合：

```
class DaemonThreadFactory implements ThreadFactory {
    final ThreadFactory delegate;

    DaemonThreadFactory() {
        this(Executors.defaultThreadFactory());
    }

    DaemonThreadFactory(ThreadFactory delegate) {
        this.delegate = delegate;
    }

    @Override
    public Thread newThread(Runnable r) {
        Thread thread = delegate.newThread(r);
        thread.setDaemon(true);
        return thread;
    }
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-04-08T17:36:05.020

如果您有已知的任务列表，则根本不需要守护线程。提交所有任务后，您只需在 ExecutorService 上调用 shutdown()。

当你的主线程完成后，使用 awaitTermination() 方法让提交的任务有时间完成。当前提交的任务将被执行，一旦完成，线程池将终止其控制线程。

```
for (Runnable task : tasks) {
  threadPool.submit(task);
}
threadPool.shutdown();
/*... do other stuff ...*/
//All done, ready to exit
while (!threadPool.isTerminated()) {
  //this can throw InterruptedException, you'll need to decide how to deal with that.
  threadPool.awaitTermination(1,TimeUnit.SECOND); 
} 
```

# c++ - c++向量emplace_back更快？

> ID：13883299
> 
> 赞同：5
> 
> 时间：2012-12-14T17:13:37.907
> 
> 标签：c++, vector

如果我有课

```
class foo {
 public:
  foo() { // spend some time and do something. }
 private:
   // some data here
} 
```

现在我有一个foo的向量，我想把这个向量放到另一个向量中

```
vector<foo> input; // assume it has 5 elements
vector<foo> output; 
```

这两条线有什么性能差异吗？

```
output.push_back(input[0])
output.emplace_back(input[0]) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-14T17:20:01.350

> 这两条线有什么性能差异吗？

不，两者都将使用复制构造函数初始化新元素。

`emplace_back`使用多于（或少于）一个参数进行构造时可能会带来好处：

```
output.push_back(foo{bar, wibble}); // Constructs and moves a temporary
output.emplace_back(bar, wibble);   // Initialises directly 
```

真正的好处`emplace`不在于性能，而在于允许在容器中创建不可复制（在某些情况下是不可移动）元素。

# c# - App.config c# 中需要的嵌套自定义处理程序

> ID：13883302
> 
> 赞同：0
> 
> 时间：2012-12-14T17:13:54.767
> 
> 标签：c#, asp.net, .net, nested, app-config

> **可能重复：**
> [如何在 app.config 中创建自定义配置部分？](https://stackoverflow.com/questions/1316058/how-to-create-custom-config-section-in-app-config)

我正在努力从我的 app.config 文件中读取自定义部分。有人可以帮助我吗？我在 app.config 中有一个嵌套自定义部分，最多 6 个级别。

我的 App.config

```
<configuration>
   <Parent>
       <mySystem>
           <mySystemContainers>
               <mySystemContainer name="one" >
                    <mySystems> 
                        <clear/>
                            <System Name="name" GroupName="Group1"/>
                            <System Name="name2" GroupName="Group1"/> 
                     </mySystems>
              </mySystemContainer> 
        </mySystem> 
     </Parent>
 </configuration> 
```

# asp.net-mvc-3 - ASP.Net MVC 如何从控制器确定要使用的视图？

> ID：13883306
> 
> 赞同：1
> 
> 时间：2012-12-14T17:14:04.043
> 
> 标签：asp.net-mvc-3, actionresult

我有一个返回 ActionResult 的控制器。具体来说，它`return View(someViewModel)`在方法结束时调用。这是方法签名：

```
protected ActionResult SomeControllerMethod(AViewModel someViewModel) 
```

我随后从`AViewModel`( `AnInheritedViewModel`) 继承，向该类添加了一些新属性，现在将其传递给`SomeControllerMethod`.

现在，在此方法末尾的 return 语句中，我收到一个关于如何找不到视图的错误。这很公平，但我不确定这一切默认情况下是如何工作的。

视图名称 MVC 告诉我它正在寻找不要与控制器方法或模型类型的名称对齐。按照相同的模式，也没有与原始模型名称对应的视图。所以我不确定 MVC 是如何决定要使用哪个视图的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T17:16:45.217

当你

```
public ActionResult SomeControllerMethod()
{
    return View();
} 
```

MVC 尝试查找名为“SomeControllerMethod.cshtml”的视图。它使用方法的名称作为查找视图文件的指南。

您可以通过以下方式覆盖它：

```
public ActionResult SomeControllerMethod()
{
    return View("MyView");
} 
```

并且 MVC 将因此尝试找到“MyView.cshtml”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T17:36:28.487

另外请务必注意存在的视图`/Views/Shared`（默认情况下，MVC 也会搜索此文件夹）。但最烦人的是当操作方法使用 重命名时`ActionNameAttribute`，例如：

```
[ActionName("Bob")]
public ActionResult MyMethod()
{
    return View();
} 
```

在这种情况下，MVC 将寻找一个名为“Bob”的视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T17:37:06.240

> 当用户在浏览器中输入 URL 时，MVC 应用程序使用 Global.asax 文件中定义的路由规则来解析 URL 并确定控制器的路径。然后控制器确定适当的操作方法来处理请求。默认情况下，请求的 URL 被视为包含控制器名称后跟操作名称的子路径。例如，如果用户输入 URL [http://contoso.com/MyWebSite/Products/Categories](http://contoso.com/MyWebSite/Products/Categories)，子路径是/P​​roducts/Categories。默认路由规则将“Products”作为控制器的前缀名，必须以“Controller”结尾（如ProductsController）。它将“类别”视为操作的名称。因此，路由规则调​​用 Products 控制器的 Categories 方法来处理请求。如果 URL 以 /Products/Detail/5 结尾，则默认路由规则将“Detail”作为操作的名称，并调用 Products 控制器的 Detail 方法来处理请求。默认情况下，URL 中的值“5”将作为参数传递给 Detail 方法。以下示例显示了一个具有 HelloWorld 操作方法的控制器类。

```
public class MyController : Controller
{
    public ActionResult HelloWorld()
    {
        ViewData["Message"] = "Hello World!";
        return View();
    }
} 
```

参考： http: [//msdn.microsoft.com/en-us/library/dd410269 (v=vs.98).aspx](http://msdn.microsoft.com/en-us/library/dd410269(v=vs.98).aspx)

# android - 顺序显示位图，“像视频一样”

> ID：13883308
> 
> 赞同：1
> 
> 时间：2012-12-14T17:14:10.227
> 
> 标签：android, bitmap, ffmpeg

我试图在我的应用程序中重现不支持 android 的视频（如 .wmv 视频），实际上我能够抓取每一帧并创建它的位图。

所以，现在，我试图在 VideoView（或任何其他视图）中依次显示这些位图，就像视频一样。

一些代码：

```
while (true) {
                frame = frameGrabber.grab();
                if (frame == null)
                    break;
                frame2 =
                        IplImage.create(frame.width(), frame.height(),
                                opencv_core.IPL_DEPTH_8U, 4);
                opencv_imgproc.cvCvtColor(frame, frame2,
                        opencv_imgproc.CV_BGR2RGBA);

                bm =
                        Bitmap.createBitmap(frame2.width(),
                                frame2.height(), Bitmap.Config.ARGB_8888);
                bm.copyPixelsFromBuffer(frame2.getByteBuffer());
                canvas = new Canvas(bm);
                mVideoView.draw(canvas);
                canvas.save(); 
```

看起来我可以抓取视频的每一帧（使用 ffmpeg），但我只是不知道如何显示它们。

顺便说一句，我已经尝试将此视频编码为 .mp4 文件并在 VideoView 上播放，但处理整个视频需要很长时间（1 小时），所以，现在，我正在尝试显示它立即，无需对其进行编码 .mp4 （或任何其他 android 支持的视频）

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-15T07:33:00.323

您可以使用 AnimationDrawable 。它会起作用的。

一点点文档[在这里](https://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-15T15:34:38.057

您可以使用 FFplay 实时回放您的图像序列。您无需先将其编码为视频文件。

假设您的文件被命名为 image1.bmp、image2.bmp、image3.bmp ... 等，并且您想以每秒 30 帧的速度播放它们，请尝试：

`ffplay -framerate 30 -i image%d.bmp`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T18:12:30.427

我不确定你的问题是什么。

现在您的画布已填充（假设已正确填充），您可以通过调用其 draw(Canvas) 方法在 SurfaceView 上绘制它。

不过我对结果很好奇，因为如果你需要花这么多时间来编码完整的视频，这可能意味着你的编码很长，所以你可能有严重的帧率问题（或者视频可能非常长？）。

# ruby-on-rails-3.2 - 在 Rails 中，如何访问富连接的另一端？

> ID：13883313
> 
> 赞同：0
> 
> 时间：2012-12-14T17:14:48.633
> 
> 标签：ruby-on-rails-3.2, relationship

当我在 rails 控制台中输入“Student.find(1).togethers”时，我得到了这个数组：

```
=> [#<Together id: 1, student_id: 1, teacher_id: 1, summary: "good", created_at: "2012-12-12 01:56:05", updated_at: "2012-12-12 01:56:05">] 
```

现在我如何使用**“teacher_id：1”**访问老师？？？？

我想做类似的事情：

```
Student.find(1).teacher 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:15:37.493

```
Student.find(1).togethers.each{|t| t.teacher} 
```

如果你有`belonge_to :teachers`Together模型，这应该可以正常工作，

理想情况下，`Student.find(1).teacher` 您应该定义“学生有很多老师`through`在一起”

# objective-c - 键盘以横向显示，ipad 以纵向显示

> ID：13883319
> 
> 赞同：0
> 
> 时间：2012-12-14T17:15:18.137
> 
> 标签：objective-c, ios4

我的 keboard 出现在横向，但 ipad 是纵向的，横向时出现在横向

我有 2 个 xib，在横向 xib 中有 viewDidLoad 中的代码：

```
 CGAffineTransform rotate = CGAffineTransformMakeRotation(1.57079633);
    [self.view setTransform:rotate]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:31:07.907

答案就在你的问题中。你用你的代码旋转你的屏幕。

```
CGAffineTransform rotate = CGAffineTransformMakeRotation(1.57079633); [self.view setTransform:rotate]; 
```

正是这样做的。1.57079633 同M_PI/2，同90°

删除代码或取消注释

```
// CGAffineTransform rotate = CGAffineTransformMakeRotation(1.57079633); [self.view setTransform:rotate]; 
```

# android - 如何通过我自己的 Android 应用程序与 Facebook 的 API 交互？

> ID：13883323
> 
> 赞同：2
> 
> 时间：2012-12-14T17:15:32.390
> 
> 标签：android, facebook

我希望使用我的 Android 应用程序的人能够登录`Facebook`或访问特定的个人资料。如何与 Facebook 的应用程序交互，以便我可以打开它并要求它打开我指定的某些页面（而不是每次登录 Facebook 时显示的“主页”）？

编者注：假定为 Android，因为问题被标记为“android”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:18:49.533

通读本[指南](https://developers.facebook.com/docs/howtos/androidsdk/3.0/login-with-facebook/)以开始使用 Android Facebook SDK...

这是Android SDK的[主页](https://developers.facebook.com/android/)

所以澄清一下，您是否希望您的应用程序的用户从您的应用程序中查看特定的 Facebook 内容？或者您想从您的应用程序将它们链接到 Facebook 应用程序中的特定内容？即，个人资料页面。

无论哪种方式，请查看[此 SO 页面](https://stackoverflow.com/questions/13107857/android-facebook-intent-to-show-profile-with-class-com-facebook-katana-profileta/13107858#13107858)，了解有关在 Android 应用程序中使用 Intent 链接到 Facebook 应用程序内容的新方法的详细信息。

# windows-7 - VMWare Windows 7 来宾中的巨大时间漂移

> ID：13883324
> 
> 赞同：5
> 
> 时间：2012-12-14T17:15:39.340
> 
> 标签：windows-7, time, vmware, ntp, drift

我在 VMWare 中运行 Windows 7 来宾，它每分钟损失多达 5 秒。我在大约 25 分钟前通过 Windows 重新同步了时间，到目前为止它已经丢失了 00:01:20。这显然是不一致的，因为我经常发现时钟与其他计算机不同步大约 2 分钟。同一 VM 上的 Redhat 来宾与使用同一域时间服务器的其他计算机保持同步。我环顾四周，发现有人推荐使用 VMWare 同步工具，也有人建议使用来宾 Windows 同步工具。如此大的漂移似乎很荒谬，并导致在各种机器上运行的软件出现问题。

我要问的是，有谁知道可能导致这种情况的原因以及我可以采取哪些措施来缓解这种情况？我怀疑 VMWare 正在以某种方式改变时钟，但不同的客户操作系统没有经历它的事实让我怀疑这种怀疑。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T17:29:17.323

**为什么会这样？**

我认为这是因为主机物理硬件的属性无法在虚拟硬件中完全准确地体现出来，同时仍然在 x86 平台上提供虚拟化（在该平台上高效的虚拟化多年来被认为是不可能的），尤其是提供高性能和低高架。更具体地说，一个因素应该是物理和逻辑 CPU 之间的时钟速度和电源管理的变化。我认为物理 CPU 的 CPU 时钟速度可能会有所不同，但 VMware 提供的逻辑 CPU 并未显示这一点。IIRC TSC（时间戳计数器）寄存器搞砸了，这尤其让 Windows 感到困惑。

VMware 在他们通常的彻底工程中，有一篇*31 页*的综合文章，介绍了 VM 计时的工作原理以及它可能遇到的问题：http: [//www.vmware.com/files/pdf/techpaper/Timekeeping-In-VirtualMachines .pdf](http://www.vmware.com/files/pdf/techpaper/Timekeeping-In-VirtualMachines.pdf)。第 14 页讨论了 Windows 计时

另见： http: [//pelican.rsvs.ulaval.ca/mediawiki/index.php/VMWare_tips_and_tricks#Power_saving_.28SpeedStep.2C_C-states.2C_P-States.2C....29](http://pelican.rsvs.ulaval.ca/mediawiki/index.php/VMWare_tips_and_tricks#Power_saving_.28SpeedStep.2C_C-states.2C_P-States.2C....29)

为什么这个硬件上的这个虚拟机这么糟糕？我不知道; 我希望我能在那里帮助你。同一台机器上是否有其他 Windows 虚拟机？他们的表现如何？

**如何修复它：**

如果您有准确的主机时间，那么我很确定一个适当的解决方案是让 VMware Tools 时间每 60 秒同步一次。（如果您没有准确的主机时间，请参阅本节末尾以了解如何进行设置。）

将其放在 VM 的 .vmx 文件中：

```
tools.syncTime = true
tools.syncTime.period = 60   #Every 60 seconds is supposed to be the default, but this forces it to 60 second just in case. 
```

如果你愿意，你可以让它每秒与主机同步：

```
tools.syncTime.period = 1 
```

[http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=1318](http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=1318)

完成此操作后，请确保 Windows 未与硬件 TOD 时钟同步。如果也尝试与之同步，则可能会导致问题，如 VMware 文档中详细说明的那样。VMware 表示他们默认禁用此功能，但它可能已再次启用，特别是如果您一直在尝试不同的修复。

另外，恕我直言，微软的时间同步是无止境的。由于您在同一台主机上有一个 Linux 来宾，我会在那里设置 NTP 并让它保持主机时钟是最新的。

**更多解决方案信息：**

这是一组很好的答案，可以让 VM 保持良好的时间同步，即使它是针对 Linux VM 的，以及偶尔会出现问题原因的额外答案： [如何保持 VMWare VM 的时钟同步？](https://stackoverflow.com/questions/276965/how-to-keep-a-vmware-vms-clock-in-sync)

这是一篇旧文章，尽管提到了 Linux VM，但我怀疑它会起作用：http: [//vmblog.com/archive/2007/08/24/help-vmware-fixing-time-keeping-problems-with-the-guest-os .aspx](http://vmblog.com/archive/2007/08/24/help-vmware-fixing-time-keeping-problems-with-the-guest-os.aspx)

# javascript - 在 text_field_tag 中运行 javascript

> ID：13883325
> 
> 赞同：1
> 
> 时间：2012-12-14T17:15:39.247
> 
> 标签：javascript, ruby-on-rails-3, security, jquery-select2, textfield

我现在对 javascript/jQuery 和 rails 有点陌生，并且正在使用带有 select2-rails 的 text_field_tag 来创建带有自动完成功能的标记等。

它现在工作得很好，但只是出于好奇，我放置了

<脚本>alert("hello");</script>

（没有空格）在文本框中，弹出警报。这不是很不安全吗？我应该添加什么来阻止 javascript 在该 text_field 中执行吗？

编辑:: 这是我在该页面上的 javascript 应用到我的 text_field_tag：

```
$(document).ready(function() {  
    $("#filter-in-postkey-select2").select2( {  
        width                   : "450px",   
        placeholder             : "No postkeys. Add some here now!",  
        minimumInputLength      : 1,  
        maximumSelectionSize    : 5,  
        tags                    : ["red", "brown", "green"],  
        tokenSeparators         : [",", " "]  
    });  
}); 
```

我的文本字段很简单：

```
<%= text_field_tag "filter-in-postkey-select2" %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T20:35:50.373

[您可以使用XSS_terminate](https://github.com/look/xss_terminate)之类的插件来转义用户的输入

那么它就像在您的模型中执行此操作一样简单：

```
class YourModel < ActiveRecord::Base
  xss_terminate :except => [ :your_input_field_to_be_exempt ]
end 
```

# hadoop - 有没有一种有效的方法来查找给定键的序列文件？

> ID：13883328
> 
> 赞同：0
> 
> 时间：2012-12-14T17:15:58.107
> 
> 标签：hadoop, sequencefile

我的 map-reduce 作业将最终结果写入序列文件。是否有任何有效的方法来查找给定键的序列文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:54:00.110

如果从映射器发出的键与减速器中的相同键输出，那么您可以通过使用的分区器运行您的搜索键（哈希分区器是默认值），传递键和最初运行作业的减速器数量。这应该为您提供密钥发送到的减速器编号，因此应该包含它的 part-r-xxxxx 文件。

# c++ - 《MFC/C++ Socket编程..》如何连接服务器和客户端？

> ID：13883329
> 
> 赞同：2
> 
> 时间：2012-12-14T17:15:59.630
> 
> 标签：c++, networking, mfc

我使用了 MFC/C++ 套接字编程的代码，但它只有在我在同一台 PC 上制作服务器和客户端时才有效，但是当我在不同的 PC 上使用客户端时，它无法找到服务器并且连接失败。我不知道我使用的服务器的本地 IP 或代码是否有问题，请提供帮助:)！

以下代码是服务器端：-

```
#include <afx.h>
#include <afxext.h>
#include <afxsock.h>
#include <iostream>

using namespace std;

int main() 
{
    AfxWinInit(::GetModuleHandle(NULL), NULL, ::GetCommandLine(), 0);
    AfxSocketInit();
    CSocket serverSocket;
    serverSocket.Create(3333);
    serverSocket.Listen();
    CSocket clientSocket;

    while(serverSocket.Accept(clientSocket))
    {
        CString s;

        while(s!="bye")
        {
            char msg[128];

            if(clientSocket.Receive(msg, 128)<0)break;

            s = msg;
            cout<<"Client: "<<msg<<endl;
            sprintf_s(msg, 128, "Your msg (%d letter) arrived successfully.",
            strlen(msg));
            clientSocket.Send(msg, 128);

            if(s=="shutdown")exit(0);
        }

        clientSocket.Close();
    }

    return 0;
} 
```

客户端的以下代码：-

```
 #include <afx.h>
 #include <afxext.h>
 #include <afxsock.h>
 #include <iostream>

 using namespace std;

int main()
{
    AfxWinInit(::GetModuleHandle(NULL), NULL, ::GetCommandLine(), 0);
    AfxSocketInit();
    CSocket clientSocket;
    clientSocket.Create();

    if(clientSocket.Connect("192.168.1.2", 3333))
    {
        cout<<"Connected to server."<<endl;
        CString s;

        while(s!="bye" && s!="shutdown")
        {
            char msg[128];
            cin.getline(msg, 128);
            s = msg;
            clientSocket.Send(msg, 128);

            if(clientSocket.Receive(msg, 128)<0)break;

            cout<<msg<<endl;
        }
    }
    else
    {
       cout<<"Cannot find server."<<endl;
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:21:48.307

尝试连接到客户端中的另一个服务器地址**而不是**您当前的固定地址怎么样？

```
if(clientSocket.Connect("192.168.1.2", 3333)) 
```

PS 最好在程序中为地址和端口号等设置参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T11:18:22.970

先绑定服务器socket

```
serverSocket.Bind(3333) 
```

然后听。

# objective-c - Objective-C – 使用包含其名称的字符串访问 extern const？

> ID：13883330
> 
> 赞同：2
> 
> 时间：2012-12-14T17:16:03.090
> 
> 标签：objective-c, constants, extern, static-variables

我在 SomeClass.h 中定义了一个类外常量：

```
extern NSString *const SCImportantString;

@interface SomeClass

@end 
```

并在 SomeClass.m 中赋值：

```
NSString *const SCImportantString = @"All your base are belong to us.";

@implementation SomeClass

@end 
```

有没有办法通过带有名称的字符串来访问这个外部常量？我知道使用该`valueForKey:`方法可以使用类和即时变量。

在使用不同的构建配置时这样做会变得非常有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:21:32.700

如果得到你所说的，没有内置的方法可以从字符串中获取 const 指针值......所以没有 NSConstantFromName(@"xy)

你可以自己做

```
NSString *const SCConstantByName(NSString *name) {
    if[(name isEqualToString:@"SCImportantString"])
        return SCImportantString;
} 
```

或者对于许多人来说有一个静态的字典......就像 localizables 也可以工作：

```
NSString *const SCConstantByName(NSString *name) {
    id dict = nil;
    if(!dict) {
        dict = @{@"SCImportantString", SCImportantString};

    return dict[name];
} 
```

# python - 测试类变量是否重复定义

> ID：13883339
> 
> 赞同：1
> 
> 时间：2012-12-14T17:16:37.320
> 
> 标签：python

这是一个简单的例子：

```
class KEY(object):
    A = 'a'
    A = 'b'
    B = 'b' 
```

有没有办法测试“A”是否在“KEY”类中重复定义，而不管分配的值如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:11:01.427

如果您使用的是 Python 3，则可以使用`dict`仅允许设置不存在的键的子类和`__prepare__`元类的方法来干净地执行此操作。[更多信息在这里](https://stackoverflow.com/a/10763270/416467)。在 Python 2 中更难。[我写了一个可怕的黑客](https://stackoverflow.com/a/10762966/416467)来实现它，但有一些限制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T17:38:46.570

这是一个回答的尝试：

# 类变量不起作用

您无法控制这些的重新定义。基本上，这`metaclass`就是创建你的类的方法，它通过了`dict`= `attribute`> `value`。我们可以说“已经太晚了”。

# 使用实例变量

您可以控制在类实例化之后发生的事情`a.b = c`，所以您可以做的是：

```
class RedefinitionMixin(object):
    def __setattr__(self, k, v):
        if hasattr(self, k):
            raise Exception('Attribute redefinition!')
        super(RedefinitionMixin, self).__setattr__(k, v)

class KEY(RedefinitionMixin, object):
    def __init__(self):
        self.A = 'a'
        self.A = 'b'
        self.B = 'b' 
```

如果您已经覆盖，这可能会导致一些意外行为`__setattr__`！

请注意，这**仅**在您实际实例化该类的情况下才有效。
为了规避使用实例的问题，您可以实现一个`singleton`模式。

* * *

总的来说，我不会推荐这种解决方案，但这是我现在能想到的最好的解决方案。

# javascript - javascript localStorage.clear() 关于代码更新

> ID：13883344
> 
> 赞同：2
> 
> 时间：2012-12-14T17:16:45.103
> 
> 标签：javascript, local-storage

这个概念看起来很简单，但现在实现逻辑似乎令人生畏。

我在我的应用程序中使用 localStorage，我想在更新代码时清除它。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T17:31:30.223

您可以将代码版本存储在脚本中，并在加载脚本时进行比较：

```
var version = "1.0.4"; // remember to update this
if(localStorage.getItem("version") != version){
  localStorage.clear();
  localStorage.setItem("version", version);
}

$(function(){
  ... 
```

如果您不想手动跟踪版本，可以通过散列脚本生成“版本”。一个好的散列是在易于实现（这有点排除 MD5，除非你愿意获取一个库）、散列大小（你不想在 localStorage 中存储脚本的副本）和它的检测能力之间取得平衡（所以字符串长度可能不够）。

不用说，删除任何单个更改的所有存储可能过于谨慎，因此我建议手动版本跟踪方法，或者（更好）重构应用程序，以便它可以使用以前的版本数据。

# iis - IIS7.5 中的多个网站和/或证书

> ID：13883346
> 
> 赞同：0
> 
> 时间：2012-12-14T17:16:47.893
> 
> 标签：iis, https, certificate

我目前在 https 中有一个网站（Windows 2008 R2、IIS 7.5），它为多个国家/地区托管应用程序。我有一个域名的网络服务器证书，比如说 a.com。[不同国家/地区通过https://abc.com/FR](https://abc.com/FR)、[https://abc.com/US](https://abc.com/US)、[https://abc.com/UK](https://abc.com/UK)访问其网站... FR、US 和 UK 只是网络下方的目录根文件夹。

现在我想设置一个可以使用证书（和 DNS 名称）的环境，例如 us.abc.com、fr.abc.com 和 uk.abc.com。使多个指向同一个 IP 的 DNS 条目不成问题。我是否需要与每个域名关联的 3 个 Web 证书（我的公司不提供通配符证书）并使 3 个不同的网站监听不同的端口？如何不强制用户输入不同于 443 的 SSL 端口？除了 us.abc.com、fr.abc.com 和 uk.abc.com，我什至还需要一个通用（不包括国家名称 -> 类似 generic.abc.com 之类的）证书，我可以继续工作前！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T21:40:46.680

如果你做 3 个 ip 地址，你可以为每个 ip 地址使用一个标准的 SSL 证书。由于必须管理多个证书，这可能会变得复杂。

或者，您可以获得一个[主题备用名称证书（SAN 证书）](http://www.ssl.com/certificates/ucc)，它允许您在一个证书上拥有多个域。然后，您可以为 3 个域使用 1 个 IP 地址，或者将此证书导出到 3 个 IP 地址（如果这是您要采用的路径）。[此外，您可以使用SSLTools Manager](http://www.ssltools.com/manager)在 Windows 上轻松创建包含多个域的证书签名请求。

# java - 使用 Python 查找图中两个顶点（节点）之间的所有路径

> ID：13883350
> 
> 赞同：0
> 
> 时间：2012-12-14T17:17:19.830
> 
> 标签：java, python, graph, python-2.7, graph-algorithm

我有以下 Python 代码，它与有向图完美配合。我的问题是如何修改代码以找到所有路径而**忽略**边缘的方向。

例如，如果我们有以下连接：

1->2

3->2

我的代码不会返回 1 到 3 之间的路径，这是预期的。但是忽略边缘的方向，代码应该找到从 1 到 3 的路径。

我希望代码忽略方向并找到两个给定节点之间的所有路径。

我尝试了建议的解决方案，它的效果非常好，解决方案是：“*最简单的解决方案可能是通过为图中的每个 A->B 添加弧 B->A 来预处理您的图表。* ”

**我真正想要的是修改算法本身以按原样处理图形。**

**蟒蛇代码：**

```
# a sample graph
graph = {'A': ['B', 'C','E'],
             'B': ['A','C', 'D'],
             'C': ['D'],
             'D': ['C'],
             'E': ['F','D'],
             'F': ['C']}

class MyQUEUE: # just an implementation of a queue

    def __init__(self):
        self.holder = []

    def enqueue(self,val):
        self.holder.append(val)

    def dequeue(self):
        val = None
        try:
            val = self.holder[0]
            if len(self.holder) == 1:
                self.holder = []
            else:
                self.holder = self.holder[1:]   
        except:
            pass

        return val  

    def IsEmpty(self):
        result = False
        if len(self.holder) == 0:
            result = True
        return result

path_queue = MyQUEUE() # now we make a queue

def BFS(graph,start,end,q):

    temp_path = [start]

    q.enqueue(temp_path)

    while q.IsEmpty() == False:
        tmp_path = q.dequeue()
        last_node = tmp_path[len(tmp_path)-1]
        #print tmp_path
        if last_node == end:
            print "VALID_PATH : ",tmp_path
        for link_node in graph[last_node]:
            if link_node not in tmp_path:
                new_path = []
                new_path = tmp_path + [link_node]
                q.enqueue(new_path)

BFS(graph,"A","D",path_queue) 
```

**-------------代码的输出--------**

```
['A', 'B', 'D'] 
['A', 'C', 'D']
['A', 'E', 'D']
['A', 'B', 'C', 'D']
['A', 'E', 'F', 'C', 'D'] 
```

**注意：我标记了 Java，以防有人对 Java 中的相同问题有解决方案**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:22:47.697

`B->A`最简单的解决方案可能是通过为图中的每个内容添加弧来预处理您`A->B`的图表。然后你应该能够按原样使用你的算法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T18:20:20.740

每种算法都使用特定的数据结构和该数据结构所代表的明确图。特定的数据结构也是表示特定类型图形的好选择。

例如，如果你有（你有）表示有向图的邻接表，并且你希望你的算法将它用作表示无向图的数据结构，你可以这样做，但它会非常无效，只是因为找出节点之间是否存在边“A”和节点“B”表示确定“B”是否位于代表“A”的相邻节点的行中，以及“A”是否位于代表“B”的相邻节点的行中。因此，如果您想仅使用数据结构来识别与节点“A”相邻的所有节点，而无需进行一些预处理，则搜索完整的邻接列表需要时间。

在您的情况下`for link_node in graph[last_node]:`，用一些更复杂的表达式替换行，该表达式遍历整个邻接列表。

**编辑：** 我想到了另一个想法，您也可以即时“预处理”您的图表。我的意思是，每当您的算法涉及边缘“A”->“B”时，它也会将边缘“B”->“A”添加到您的图表中。一个缺点是如果已经添加了一些边，您需要额外的数据结构来保存信息，相反，您必须只添加有趣的边。

# c# - 如果导航回上一页，代码会从中断的地方继续吗？

> ID：13883352
> 
> 赞同：0
> 
> 时间：2012-12-14T17:17:24.063
> 
> 标签：c#, windows-8, windows-store-apps

我想做这样的事情：

```
private async Task<KeyValuePair<string, string>> SelectAPlatypus()
{
    KeyValuePair<string, string> kvp;
    Frame.Navigate(typeof(DuckbillPage));
. . . 
```

...然后在用户从 DuckbillPage 导航回来后，在省略号点所在的位置继续执行代码。这行得通吗？或者以这种方式离开页面后，返回它是否只带您返回 NavigatedTo() 事件，而不返回到先前的代码？

如果是这样，创建一个类似弹出窗口的页面内对话框是一个可行/可行的选项（而不是导航到不同的页面）？

我知道我可以在原始页面的 NavigatedTo() 事件中检查条件或变量状态，但我不想比我必须的更“聪明”。我试图避免制作一批鲁布·戈德堡意大利面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:35:20.027

无论 Frame 是否导航，该方法的其余部分都将执行。您可以编写一个模态对话框来显示而不是导航。

使用任务作为模态对话框的 Show() 方法，您可以暂停代码执行并等待对话框关闭，然后再执行该方法的其余部分。

# html - 拖动以旋转 SVG:g 组

> ID：13883356
> 
> 赞同：4
> 
> 时间：2012-12-14T17:17:39.757
> 
> 标签：html, svg, rotation, d3.js, transform

我的目标是拥有一个`svg:ellipse`可用于调整大小和旋转的四个控制点。如果将旋转变换应用于椭圆本身，我的代码可以正常工作，但我想将旋转应用于容器`svg:g`，以便控制点同时旋转而无需大量额外代码。当我将变换应用于组时，我假设旋转行为不正常，因为我没有正确考虑变换后的坐标。

见这里：http: [//jsfiddle.net/PbKYn/3/](http://jsfiddle.net/PbKYn/3/)

请注意，角度在旋转开始附近的正值和负值之间闪烁，并且鼠标旋转 2pi 只会旋转形状 1pi。（不过我不认为我的`angleBetweenPoints`函数有问题，因为如果我将旋转应用于 the`<ellipse>`而不是`<g>`，则旋转是完美的。）

我究竟做错了什么？谢谢-

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-15T08:29:00.907

[http://jsfiddle.net/PbKYn/5/](http://jsfiddle.net/PbKYn/5/)

修复将旋转角度从更改`angleBetweenPoints`为`currentAngle + angleBetweenPoints`（伪）。我认为这意味着在应用旋转之后，坐标也进行了转换，`angleBetweenPoints`本质上是给出`dTheta`而不是`theta`. 乐叹息。

# c# - 覆盖列表框 SelectedItem 的 WindowsTheme 颜色

> ID：13883357
> 
> 赞同：2
> 
> 时间：2012-12-14T17:17:47.310
> 
> 标签：c#, wpf, colors, listbox, windows-themes

我有一个列表框，该列表框具有[此线程](https://stackoverflow.com/questions/2138200/change-background-color-for-selected-listbox-item)中所述的自定义选定项目颜色。只要我使用的是 Windows 7 主题，它就可以很好地工作。如果我使用 windows 经典主题，背景颜色是深蓝色，这使得黑色文字难以辨认。

有没有办法覆盖与 Windows 主题相关的默认颜色？我们在应用程序中使用的颜色是由我们的单色调色板驱动的，不应受任何特定主题的影响。

例子：

![在此处输入图像描述](../Images/18b62e649e7c409153a1195f4ec32fb8.png)

VS

![在此处输入图像描述](../Images/94c96d1760da0b4a23826f39eab551c3.png)

# c# - 创建仅包含每个条目之一的列表

> ID：13883365
> 
> 赞同：0
> 
> 时间：2012-12-14T17:18:08.253
> 
> 标签：c#, asp.net-mvc-3

我有一个例程，我正在访问数据库中的表并从数据创建模型。

数据库表 TblUNote

```
 ID      Quarter      Year      SubID      Data
       1          1        2007       245      DataPoint1
       2          1        2007       245      Datapoint2
       3          1        2007       245      Datapoint3
       4          1        2007       247      DataPoint1
       5          1        2007       247      Datapoint2
       6          1        2007       247      Datapoint3
       7          1        2007       249      DataPoint1
       8          1        2007       249      Datapoint2 
```

常规是

```
 public RData[] GetData(int Q, int Y)
       {
          using (Entities be = new Entities())
          {
             List<RData> nlist = new List<RData>();

             List<TblUNote> info = be.TblUNotes.Where(a => a.Quarter == Q && a.Year == Y).ToList();
             foreach (var item in info)
             {
                 Rdata newmodel = new RData()
                 {
                    //create model
                 };
             }
             nlist.Add(newmodel);
          }
          return(nlist).ToArray();
       } 
```

这可行，但现在我需要对其进行修改，以便为每个 SubID 创建一个模型条目。我曾尝试使用 .Distinct() 但我只是得到相同的数据。我尝试使用 .First() 但无论我将它放在数据库调用的哪个位置，我都会收到错误消息。我需要模型列表

```
 RData Model

     Item1    Quarter = 1,   Year = 2007,  SubID = 245,   Data = DataPoint1
     Item2    Quarter = 1,   Year = 2007,  SubID = 247,   Data = DataPoint1
     Item3    Quarter = 1,   Year = 2007,  SubID = 249,   Data = DataPoint1 
```

问题是我没有什么可以比较 SubID 的。我认为 .Distinct() 会给我一种方法来做到这一点。我确信 .First 应该但是如何将它集成到数据库调用中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:22:09.590

您可以使用 GroupBy，并获取每个组的第一项：

```
be.TblUNotes
  .Where(a => a.Quarter == Q && a.Year == Y)
  .GroupBy(m => m.SubId)
  .Select(g => g.FirstOrDefault())//or g.OrderBy(m => m.Data).FirstOrDefault(), for example, I don't know which item you wanna take
  .ToList(); 
```

# visual-studio-2010 - Visual Studio 2010 在启动时崩溃

> ID：13883371
> 
> 赞同：8
> 
> 时间：2012-12-14T17:18:39.877
> 
> 标签：visual-studio-2010, tfs

我们多年来一直在这台机器（服务器 2003）上使用 vs 2010，现在 Visual Studio 刚开始在启动时崩溃。根本没有办法运行它，它每次都会崩溃。

我试过 Devenv.exe /SafeMode、resetsettings 等，结果相同。我试过重新安装vs2010，我试过卸载它并重新安装，同样的事情。

事件日志说它与团队基础服务器有关：

* * *

EventType clr20r3、P1 devenv.exe、P2 10.0.30319.1、P3 4ba1fab3、P4 microsoft.teamfoundation.common、P5 10.0.0.0、P6 502e379e、P7 4b6、P8 45、P9 system.missingmethodexception、P10 NIL。

* * *

堆栈跟踪也有错误：

* * *

```
Application: devenv.exe
Framework Version: v4.0.30319
Description: The process was terminated due to an unhandled exception.
Exception Info: System.MissingMethodException
Stack:
   at Microsoft.VisualStudio.TeamFoundation.TeamFoundationHost+AuthenticateWorker.WorkCompleted(System.Object, System.Object, System.ComponentModel.AsyncCompletedEventArgs)
   at Microsoft.TeamFoundation.Common.TfsBackgroundWorkerManager.worker_RunWorkerCompleted(System.Object, System.ComponentModel.RunWorkerCompletedEventArgs)
   at System.ComponentModel.BackgroundWorker.OnRunWorkerCompleted(System.ComponentModel.RunWorkerCompletedEventArgs)
   at System.ComponentModel.BackgroundWorker.AsyncOperationCompleted(System.Object)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(System.Delegate, System.Object, Int32)
   at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(System.Object, System.Delegate, System.Object, Int32, System.Delegate)
   at System.Windows.Threading.DispatcherOperation.InvokeImpl()
   at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(System.Object)
   at System.Threading.ExecutionContext.runTryCode(System.Object)
   at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode, CleanupCode, System.Object)
   at System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object)
   at System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)
   at System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object)
   at System.Windows.Threading.DispatcherOperation.Invoke()
   at System.Windows.Threading.Dispatcher.ProcessQueue()
   at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr, Int32, IntPtr, IntPtr, Boolean ByRef)
   at MS.Win32.HwndWrapper.WndProc(IntPtr, Int32, IntPtr, IntPtr, Boolean ByRef)
   at MS.Win32.HwndSubclass.DispatcherCallbackOperation(System.Object)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(System.Delegate, System.Object, Int32)
   at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(System.Object, System.Delegate, System.Object, Int32, System.Delegate)
   at System.Windows.Threading.Dispatcher.InvokeImpl(System.Windows.Threading.DispatcherPriority, System.TimeSpan, System.Delegate, System.Object, Int32)
   at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr, Int32, IntPtr, IntPtr) 
```

* * *

我们确实使用了 TFS，并且没有遇到任何问题。
关于为什么会发生这种情况的任何想法，更重要的是，我该如何解决这个问题？如果没有 tfs 组件，似乎没有任何方法可以启动 Visual Studio，无论如何我们都需要 tfs。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-10-01T23:58:31.033

以下为我工作

1.  关闭所有VS实例

2.  转到 [系统驱动器]:\Users[用户名]\AppData\Roaming\Microsoft\VisualStudio\10.0

3.  从上述文件夹中删除所有文件和文件夹。

并重新打开VS，一切都应该恢复正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:56:54.700

我卸载了 Power Tool（没用）我安装了最新的 Power Tool（没用）我卸载了 TFS（它开始工作）然后我再次安装了 TFS（它仍然工作:)）

谢谢，顺便说一下，Windows 事件日志中的详细错误消息是：

故障桶 3292093736，类型 5 事件名称：CLR20r3 响应：不可用 Cab Id：0

问题签名：P1：devenv.exe P2：10.0.30319.1 P3：4ba1fab3 P4：Microsoft.TeamFoundation.Common P5：10.0.0.0 P6：502e379e P7：4b6 P8：45 P9：System.MissingMethodException P10：

附加的文件：

这些文件可能在此处可用：C:\Users\rahiljm\AppData\Local\Microsoft\Windows\WER\ReportArchive\Critical_devenv.exe_1e501d4117b8b2664a23a63826807fb1d894270_1b9a7992

分析符号：重新检查解决方案：0 报告 ID：f92dcd0f-91aa-11e2-8682-8c89a571d971 报告状态：0

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-27T11:55:51.300

在被迫重新安装 Visual Studio 2010 以使 BizTalk 2010 ESB 正常工作后，我遇到了这个问题。

我无法下载 KB2581206，因为它似乎不再有有效内容。然而，有一个替代下载也可以完成这项工作......

[http://www.microsoft.com/en-us/download/details.aspx?id=29082](http://www.microsoft.com/en-us/download/details.aspx?id=29082)

...这是 Visual Studio 2010 SP1 Team Foundation Server 兼容性 GDR。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-16T21:22:05.510

看起来问题是与已安装的 Team Foundation Server 2010 Power Tools 不兼容的 Windows 更新。当我安装最新版本的电动工具时，VS 停止崩溃。

[http://visualstudiogallery.msdn.microsoft.com/c255a1e4-04ba-4f68-8f4e-cd473d6b971f](http://visualstudiogallery.msdn.microsoft.com/c255a1e4-04ba-4f68-8f4e-cd473d6b971f)

我已经删除了所有这些，但我猜......谁知道......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-07T09:27:51.793

我有同样的问题。

我重新安装了 Visual Studio SP1 并卸载了 Net Framework 所有语言包。在那个问题解决之后。

# java - 可以从其构造函数的参数中推断出类的泛型类型参数吗？

> ID：13883372
> 
> 赞同：2
> 
> 时间：2012-12-14T17:18:38.940
> 
> 标签：java, generics

这是我想做的事情：

我有一个接口服务如下：

```
public interface Service<A extends Object, R extends Object> {
    R run(A a);
} 
```

现在，我想链接两个这样的服务，同时保持它的通用性：

```
public class Link<A, R> implements Service<A, R> {

    private Service<A, X> s1; // fail
    private Service<X, R> s2; // fail

    public <X> Link(Service<A, X> s1, Service<X, R> s2) {
        this.s1 = s1;
        this.s2 = s2;
    }

    @Override
    public R run(A a) {
        return s2.run(s1.run(a));
    }
} 
```

我要解决的问题是将泛型类型 X 分配给类 Link，但我希望通过其构造函数而不是通过类声明来推断。

它是如何实现的？

编辑：

我解决此问题的方法是通过执行链接过程的实用程序静态方法：

```
public static <A, I, R> Service<A, R> link(final Service<A, I> s1, final Service<I, R> s2) {
    return new Service<A, R>() {
        @Override
        public R run(A a) throws Exception {
            I intermediate = s1.run(a);
            return s2.run(intermediate);
        }
    };
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T17:19:27.087

你不能有一个泛型类型`X`，它是你的类的一部分（不是为每个方法调用重新选择）而不是它的声明的一部分。

当然，您可以隐藏不安全的强制转换并确保您的程序可以工作，但在 Java 类型系统的限制下，这实际上是您仅有的两个选择。

不过，我会做的不是提供`Link`构造函数，而是提供静态工厂方法

```
public static <A, X, R> Service<A, R> link(Service<A, X> s1, Service<X, R> s2) {
  return new Link<A, X, R>(s1, s2);
} 
```

...确保`X`自动推断并且永远不会逃脱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T20:06:17.387

为了获得更好的协方​​差，您可以像这样调整上述答案：

```
public class Link <F, X, T>  implements Service <F, T> {
    private final Service<F, ? extends X> from;
    private final Service <X, ? extends T> to;

    public Link(Service <F, ? extends X> from, Service <X, ? extends T> to) {
        this.from = from;
        this.to = to;
    }

    @Override
    public T run (F input) {
        return to.run (from.run (input));
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:39:36.273

这将起作用：

```
public class Link<A, R, X> implements Service<A, R> {

    private Service<A, X> s1; 
    private Service<X, R> s2; 

    public Link(Service<A, X> s1, Service<X, R> s2) {
        this.s1 = s1;
        this.s2 = s2;
    }

    @Override
    public R run(A a) {
       return s2.run(s1.run(a));
    }
} 
```

# playframework-2.0 - 在 playframework 2.0 中安装模块 - 想要在 play 2.0 中包含 morphia

> ID：13883374
> 
> 赞同：1
> 
> 时间：2012-12-14T17:18:40.783
> 
> 标签：playframework-2.0

如何在 Play Framework 2.0 中安装模块 ... play install 似乎不起作用。

似乎代码必须放在框架下的模块目录中。但是我下载的插件都没有模块目录？

我想让 Play framework 2.0 与 Mongodb 一起工作。最好用

```
morphia.db.seeds="127.0.0.1:27017"
%prod.morphia.db.name=yabe
morphia.db.name=dev
morphia.id.type=Long
morphia.defaultWriteConcern=SAFE
morphia.collection.upload=fs
morphia.logger=false 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:38:04.260

我认为您将 Play 1 和 2 混合在一起。Play 安装和`%prod`配置文件来自 play 1。两个 play 版本彼此不兼容，因此模块。

有一个[play 2 plugins 列表](https://github.com/playframework/Play20/wiki/Modules)。在 play 2 中有一个[morphia 示例应用程序](https://github.com/leodagdag/play2-morphia-plugin/tree/master/samples/yabe)。要安装该模块，您必须调整您的[Build.scala](https://github.com/leodagdag/play2-morphia-plugin/blob/master/samples/yabe/project/Build.scala)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-19T16:30:01.487

还有 playMongoDemo 是你想要一个适用于 2.0 的 Morphia 版本：[https ://github.com/czihong/playMongoDemo](https://github.com/czihong/playMongoDemo)

我有一个拉取请求，将内容更新为 2.1.4：[https ://github.com/subdigit/playMongoDemo](https://github.com/subdigit/playMongoDemo)

虽然如果/一旦它被接受，请使用主仓库。

# vb.net - 如何获取所有摄像机的列表？

> ID：13883375
> 
> 赞同：1
> 
> 时间：2012-12-14T17:18:44.763
> 
> 标签：vb.net, camera

我现在有这个代码：

```
Public Touchless As New TouchlessLib.TouchlessMgr
Public Camera1 As TouchlessLib.Camera = Touchless.Cameras.ElementAt(0) 
```

但它只有一台相机。谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:25:41.017

看起来`Touchless.Cameras`是一个相机列表，通过这样做，`Cameras.ElementAt(0)`您可以明确地从列表中选择第一个。

尝试这个：

```
Public cameras() As TouchlessLib.Camera = Touchless.Cameras 
```

然后您可以使用`cameras(0)`访问第一个摄像头、`cameras(1)`第二个摄像头，以此类推。

或者你可以像这样循环相机：

```
For Each cam As TouchlessLib.Camera In Touchless.Cameras
    ' do what you want with cam
next 
```

# iphone - 在 ios6 中解析 csv

> ID：13883385
> 
> 赞同：0
> 
> 时间：2012-12-14T17:19:04.650
> 
> 标签：iphone, ios, ipad, csv, ios6

我已经尝试过这种方法来解析 csv 并且我得到了值，但是如果任何字段在双引号“”中并且在“45,34,555”内有一个逗号，那么它将在 3 个字段中分隔值，它只是一个字段。应该如何我修改以下代码以获得所需的结果。

```
 NSMutableArray *contentArray = [NSMutableArray array];
    NSString *filePath = [[NSBundle mainBundle] pathForResource:@"test" ofType:@"csv"];

    NSError*  error;
    NSString* Data = [NSString stringWithContentsOfFile:filePath encoding:NSUTF8StringEncoding error:&error ];

    if (Data)
    {
        NSArray *myText = [Data componentsSeparatedByString:@","];
        NSInteger idx;
        for (idx = 0; idx < myText.count; idx++) {
            NSString *data =[myText objectAtIndex:idx];
            NSLog(@"%@", data);
            id x = [NSNumber numberWithFloat:0+idx*0.002777778];
            id y = [NSDecimalNumber decimalNumberWithString:data];
            [contentArray addObject:
             [NSMutableDictionary dictionaryWithObjectsAndKeys:x, @"x", y, @"y",nil]];
        }
        self.dataForPlot = contentArray;

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:24:24.350

为此，您应该查看 NSScanner。您需要检测是否收到双引号，如果是，则扫描直到结束引号并将其视为一个单元。如果你得到一个冒号，那么你就知道你得到了下一列。

# git - 一些 git 子模块不会克隆

> ID：13883386
> 
> 赞同：0
> 
> 时间：2012-12-14T17:19:23.343
> 
> 标签：git, vim, version-control, git-submodules, pathogen

我正在使用 git + 病原体来跟踪我的 vim 插件。我的 .vim 文件夹中有一个 git repo，我所有的插件都在该`bundle`文件夹中。

要添加一个新插件，我会这样做：

```
git submodules add git://github.com/plugin.git bundle/plugin 
```

它适用于大多数插件（它将新的 repo 克隆到指定的位置，我对我的 vim 很满意）。

但是，对于某些存储库，它根本不起作用。不工作是指：

*   运行后`git submodules add`它不会输出任何东西（与克隆信息不同）。
*   在中创建一个空文件夹`bundle/plugin`
*   .gitmodules 和 .git/config*已*更新以反映更改（打开 .gitmodules 您可以看到新的存储库，就像所有其他存储库一样）

我被告知我应该`git submodule init && git submodule update`在添加一个新的子模块后运行。是否有可能忘记这样做可能会导致问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T20:13:22.557

子模块需要在 3 个地方注册。确保这些设置正确：

1.  `.gitmodules`文件有一个条目
2.  `.git/config`有一个条目
3.  `git ls-tree sha1`子模块所在的树对应于子模块中的提交

# xcode - 如何以编程方式为 iphone5 截屏？

> ID：13883390
> 
> 赞同：0
> 
> 时间：2012-12-14T17:19:26.500
> 
> 标签：xcode, ios6, screenshot, capture

我希望在我的应用程序中有一个用于图像的“保存”按钮。问题是，iPhone 5 和 iPhone 4 的图像模糊。这是我现在使用的代码。

对于 iPhone 4 和 4s 用户，其：

```
if(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone)
{
    CGSize result = [[UIScreen mainScreen] bounds].size;
    if(result.height == 480)
    {
        CGRect screenRect = [[UIScreen mainScreen] bounds];
        UIGraphicsBeginImageContext(screenRect.size);
        CGContextRef ctx = UIGraphicsGetCurrentContext();
        [[UIColor blackColor] set];
        CGContextFillRect(ctx, screenRect);
        [self.view.layer renderInContext:ctx];
        UIImage *img = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();

        CGImageRef imageRef = CGImageCreateWithImageInRect([img CGImage], CGRectMake (0, 20, self.view.bounds.size.width, (self.view.bounds.size.height - 40)));

        //save photo to photoAlbum
        UIAlertView *message = [[UIAlertView alloc] initWithTitle:@"Saved!"
                                                          message:@"Image has been Saved, don't forget to Share!"
                                                         delegate:nil
                                                cancelButtonTitle:@"OK"
                                                otherButtonTitles:nil];
        [message show];

        UIImage *image = [UIImage imageWithCGImage:imageRef];
        CGImageRelease(imageRef);

        // Request to save the image to camera roll
        UIImageWriteToSavedPhotosAlbum(image, self, nil, nil);        } 
```

对于 iPhone 5 用户，我有：

```
 if(result.height == 568)
    {
        CGRect screenRect = [[UIScreen mainScreen] bounds];

        if ([[UIScreen mainScreen] respondsToSelector:@selector(scale)])
            UIGraphicsBeginImageContextWithOptions(screenRect.size, NO, [UIScreen mainScreen].scale);
        else
            UIGraphicsBeginImageContext(screenRect.size);
        CGContextRef ctx = UIGraphicsGetCurrentContext();
        [[UIColor blackColor] set];
        CGContextFillRect(ctx, screenRect);
        [self.view.layer renderInContext:ctx];
        UIImage *img = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();

        CGImageRef imageRef = CGImageCreateWithImageInRect([img CGImage], CGRectMake (0, 40, self.view.bounds.size.width, (self.view.bounds.size.height - 150)));

        //save photo to photoAlbum
        UIAlertView *message = [[UIAlertView alloc] initWithTitle:@"Saved!"
                                                          message:@"Image has been Saved, don't forget to Share!"
                                                         delegate:nil
                                                cancelButtonTitle:@"OK"
                                                otherButtonTitles:nil];
        [message show];

        UIImage *image = [UIImage imageWithCGImage:imageRef];
        CGImageRelease(imageRef);
        // Request to save the image to camera roll
        UIImageWriteToSavedPhotosAlbum(image, self, nil, nil);        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:21:13.583

也许您可以尝试设置/取消设置抗锯齿上下文选项`CGContextSetShouldAntialias()`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T17:22:38.110

您可能正在捕获非视网膜 320x480 屏幕截图。请注意， 的`bounds`以`UIScreen`点为单位**，**而不是像素。

# c# - 在循环内部与外部定义变量

> ID：13883392
> 
> 赞同：3
> 
> 时间：2012-12-14T17:19:33.840
> 
> 标签：c#, memory, memory-management

我想知道在每一对循环代码中，某个版本是否比第二个版本消耗更少的内存，以及在某些版本中我们是否为每个循环周期中的变量分配新空间是真的。

注意：2 很明显，1 和 3 更有趣..

**1** .

```
While(!exit)
{
  int x = 5;
} 
```

相对：

```
int x= 0;
While(!exit)
{
  x = 5;
} 
```

* * *

参考类型的相同问题： **2**。

```
While(!exit)
{
      Point p = new Point();
      p.x = 5;
} 
```

相对：

```
Point p = new Point();
While(!exit)
{
      p.x = 5;
} 
```

* * *

**3** . 没有分配的引用类型类似于 1?:

```
While(!exit)
{
      Point p = point1;
} 
```

相对：

```
Point p = null;
While(!exit)
{
   p = point1;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T17:27:48.357

编译器决定您的函数需要多少堆栈存储位置，并将尽其所能减少这种需求。就像是：

```
{
   int a;
   ...
}
{
   int b;
   ...
} 
```

似乎需要两个存储位置，但编译器可以看到第一个永远不会在第一个范围之外使用，并且可以将位置重新用于 b。

它还可以看到它可以完全取消堆栈存储并在寄存器中执行整个操作。

无论是否循环，单个变量声明都定义了一个存储位置。永远不会为循环的每次迭代创建一个新的存储位置。

一般来说，这不是您需要关心的事情。

请注意，“调试”构建可能会在堆栈上为声明的每个变量生成单独的存储位置，以便在调试时更轻松地查看这些变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T17:25:49.197

没关系。编译器对其进行了优化，因此它保持不变。在 C# 等编译语言中，它根本不应该影响性能。例如，在 Java 中，最好只声明一次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:28:24.377

正确的判断方法是反汇编，看代码。您会看到对每个的引用。

链接到 MSDN 的方法：http: [//msdn.microsoft.com/en-us/library/f7dy01k1.aspx](http://msdn.microsoft.com/en-us/library/f7dy01k1.aspx)

该代码在 CIL 中非常易读。只需搜索函数名称，您就会看到对 new 等的调用。

# jquery - 如果选中的复选框为真，则单击按钮使 div 可见使用 jquery

> ID：13883395
> 
> 赞同：1
> 
> 时间：2012-12-14T17:19:58.513
> 
> 标签：jquery

我有 32 个复选框（checkbox1、checkbox2、checkbox3.... checkbox32）和 32 个 div（div1、div2、div3 .....div32）和一个 asp:Button。

在按钮单击时，如果 checkbox1 检查为 true，则需要使 div1 可见，如果 checkbox2 检查为 true，则 div2 可见，如果 checkbox3 检查为 true，则 div3 可见，依此类推。

```
<div class="CheckBoxDiv ">
        <asp:CheckBox ID="checkBox1" runat="server"  />

    </div>
        <asp:CheckBox ID="checkBox2" runat="server"  />

    </div>        .
                  .
                  .

<asp:Button ID="buttonShowData" runat="server" Text="Show data" class="ShowDataButton"  />

<div id="div1" runat="server" visible="false">
               ......
</div>
<div id="div2" runat="server" visible="false">
               ......
</div>
                    .
                    . 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:22:19.220

```
$("button").on('click', function () {
    $(":checkbox").each(function (idx) {
       if ($(this).is(":checked")) {
          $("div").eq(idx + 1).show();
       }
       else {
          $("div").eq(idx + 1).hide();
       }
    });
}); 
```

这会遍历所有复选框并显示/隐藏所有可用 div 中的相应 div。您很可能想要使用更具体的选择器。

# java - 拦截器刚刚在欢迎页面之前调用

> ID：13883402
> 
> 赞同：1
> 
> 时间：2012-12-14T17:20:36.480
> 
> 标签：java, authentication, struts2, interceptor, interceptorstack

我的自定义拦截器存在很大问题。

问题不在于它里面的代码，问题是当我第一次打开我的网站时，拦截器只是被调用，我的意思是当显示欢迎页面时。

但是，如果我做了一些必须执行操作的事情，比如登录或直接在导航栏上写一个 url 以打开另一个页面（如果拦截器正在工作，它应该重定向到登录页面，但它会重定向到我在url) 拦截器没有被调用，因为它的第一行是 println 并且日志没有显示它。

我的 struts.xml 配置是这样的：

```
<struts>
<constant name="struts.devMode" value="true" />
    <constant name="struts.custom.i18n.resources" value="global" />
    <constant name="struts.convention.default.parent.package" value="restful"/>
    <constant name="struts.action.extension" value=","/>
    <constant name="struts.ui.theme" value="simple" />

    <package name="restful"  extends="rest-default, struts-default"> 
        <result-types>
            <result-type name="tiles" class="org.apache.struts2.views.tiles.TilesResult"/>
        </result-types>
     </package>

     <package name="basicstruts2" extends="struts-default">   
        <interceptors>
            <interceptor name="authorization" class="org.letter.ltr.scripts.AuthInterceptor" />
            <interceptor-stack name="myStack">
                <interceptor-ref name="defaultStack">
                    <param name="exception.logEnabled">true</param>
                    <param name="exception.logLevel">ERROR</param>
                </interceptor-ref>
                <interceptor-ref name="authorization">
                    <param name="excludeActions">index,login,privacypolicy,login-input</param>
                </interceptor-ref>
            </interceptor-stack>
        </interceptors>

        <default-interceptor-ref name="myStack"/>

        <default-action-ref name="index" />

        <global-results>
            <result name="authentication_required">/WEB-INF/content/index.jsp</result>
        </global-results>

        <action name="index">
            <result name="login">index.jsp</result>
        </action>

</package>
</struts> 
```

拦截器代码：

```
public class AuthInterceptor extends AbstractInterceptor implements{
private String authenticationSessionField = "authenticated";
private static final String authenticationRequiredResult = "authentication_required";
private Set excludeActions = Collections.EMPTY_SET; 

@Override
public String intercept (ActionInvocation invocation) throws Exception {
    System.out.println("---Inside interceptor.....");

    Map session = invocation.getInvocationContext().getSession();
    String actionName = invocation.getProxy().getActionName();

    Object authenticationObject = session.get(authenticationSessionField);
    if(excludeActions.contains(actionName) || 
            (authenticationObject != null && 
            authenticationObject instanceof Boolean && 
            authenticationObject.equals(Boolean.TRUE))){
        return invocation.invoke();
    } 
    else return authenticationRequiredResult;

}

public void setAuthenticationSessionField(String authenticationSessionField){
    this.authenticationSessionField = authenticationSessionField;
}
public void setExcludeActions(String values){
    if(values != null)
        this.excludeActions = TextParseUtil.commaDelimitedStringToSet(values);
}
} 
```

日志的一些行：

```
2012-12-14 18:10:33,796 DEBUG com.opensymphony.xwork2.DefaultActionProxy.debug:68 - Creating an DefaultActionProxy for namespace / and action name 
2012-12-14 18:10:33,844 DEBUG com.opensymphony.xwork2.interceptor.I18nInterceptor.debug:68 - intercept '//' { 
2012-12-14 18:10:33,844 DEBUG com.opensymphony.xwork2.interceptor.I18nInterceptor.debug:68 - applied invocation context locale=es_ES
2012-12-14 18:10:33,845 DEBUG com.opensymphony.xwork2.interceptor.I18nInterceptor.debug:68 - before Locale=es_ES
2012-12-14 18:10:33,898 DEBUG com.opensymphony.xwork2.conversion.impl.InstantiatingNullHandler.debug:68 - Entering nullPropertyValue [target=[com.opensymphony.xwork2.ActionSupport@7b1e8d, com.opensymphony.xwork2.DefaultTextProvider@138be8d], property=struts]
2012-12-14 18:10:33,917 DEBUG com.opensymphony.xwork2.util.LocalizedTextUtil.debug:68 - Resource bundles reloaded
2012-12-14 18:10:33,921 DEBUG org.apache.struts2.interceptor.FileUploadInterceptor.debug:68 - Bypassing //
2012-12-14 18:10:33,922 DEBUG com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.debug:68 - Setting static parameters {}
2012-12-14 18:10:33,926 DEBUG com.opensymphony.xwork2.interceptor.ParametersInterceptor.debug:68 - Setting params NONE
2012-12-14 18:10:33,926 DEBUG com.opensymphony.xwork2.interceptor.ParametersInterceptor.debug:68 - Setting params 
2012-12-14 18:10:33,931 DEBUG org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.debug:68 - Validating // with method execute.
2012-12-14 18:10:33,982 DEBUG com.opensymphony.xwork2.validator.ValidationInterceptor.debug:68 - Invoking validate() on action com.opensymphony.xwork2.ActionSupport@7b1e8d
2012-12-14 18:10:33,987 DEBUG com.opensymphony.xwork2.interceptor.PrefixMethodInvocationUtil.debug:68 - cannot find method [validateExecute] in action [com.opensymphony.xwork2.ActionSupport@7b1e8d]
2012-12-14 18:10:33,987 DEBUG com.opensymphony.xwork2.interceptor.PrefixMethodInvocationUtil.debug:68 - cannot find method [validateDoExecute] in action [com.opensymphony.xwork2.ActionSupport@7b1e8d]
---Inside interceptor.....
2012-12-14 18:10:33,992 DEBUG org.apache.struts2.dispatcher.ServletDispatcherResult.debug:68 - Forwarding to location /WEB-INF/content/index.jsp

...

2012-12-14 18:10:46,398 DEBUG com.opensymphony.xwork2.DefaultActionProxy.debug:68 - Creating an DefaultActionProxy for namespace / and action name tablon
2012-12-14 18:10:46,399 DEBUG com.opensymphony.xwork2.interceptor.I18nInterceptor.debug:68 - intercept '//tablon' { 
2012-12-14 18:10:46,399 DEBUG com.opensymphony.xwork2.interceptor.I18nInterceptor.debug:68 - applied invocation context locale=es_ES
2012-12-14 18:10:46,400 DEBUG com.opensymphony.xwork2.interceptor.I18nInterceptor.debug:68 - before Locale=es_ES
2012-12-14 18:10:46,417 DEBUG com.opensymphony.xwork2.conversion.impl.InstantiatingNullHandler.debug:68 - Entering nullPropertyValue [target=[org.letter.ltr.action.TablonAction@1ea8209, com.opensymphony.xwork2.DefaultTextProvider@138be8d], property=struts]
2012-12-14 18:10:46,424 DEBUG com.opensymphony.xwork2.util.LocalizedTextUtil.debug:68 - Resource bundles reloaded
2012-12-14 18:10:46,427 DEBUG org.apache.struts2.interceptor.FileUploadInterceptor.debug:68 - Bypassing //tablon
2012-12-14 18:10:46,427 DEBUG com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.debug:68 - Setting static parameters {}
2012-12-14 18:10:46,428 DEBUG com.opensymphony.xwork2.interceptor.ParametersInterceptor.debug:68 - Setting params NONE
2012-12-14 18:10:46,429 DEBUG com.opensymphony.xwork2.interceptor.ParametersInterceptor.debug:68 - Setting params 
2012-12-14 18:10:46,430 DEBUG org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.debug:68 - Validating //tablon with method execute.
2012-12-14 18:10:46,449 DEBUG com.opensymphony.xwork2.validator.ValidationInterceptor.debug:68 - Invoking validate() on action org.letter.ltr.action.TablonAction@1ea8209
2012-12-14 18:10:46,449 DEBUG com.opensymphony.xwork2.interceptor.PrefixMethodInvocationUtil.debug:68 - cannot find method [validateExecute] in action [org.letter.ltr.action.TablonAction@1ea8209]
2012-12-14 18:10:46,450 DEBUG com.opensymphony.xwork2.interceptor.PrefixMethodInvocationUtil.debug:68 - cannot find method [validateDoExecute] in action [org.letter.ltr.action.TablonAction@1ea8209]
2012-12-14 18:10:46,450 DEBUG com.opensymphony.xwork2.DefaultActionInvocation.debug:68 - Executing action method = execute 
```

PS：新代码

我修改了 struts.xml 中的包定义，如下所示：

```
<package name="basicstruts2" extends="struts-default" namespace="/"> 
```

现在，当我尝试直接访问一个 url 并且我没有通过身份验证时，它会触发。但是，如果我尝试进行身份验证，则会出现错误：

```
2012-12-14 18:59:02,351 ERROR org.apache.struts2.dispatcher.Dispatcher.error:38 -Could not find action or result /ltr/login
No result defined for action com.opensymphony.xwork2.ActionSupport and result success 
```

前段时间我遇到了另一个问题。我会尝试解决它。但问题是，这个问题已经解决了。问题似乎是包命名空间。

上下文路径是 /ltr（IDE 日志）

```
Start is in progress...
start?path=/ltr
OK - Arrancada aplicación en trayectoria de contexto /ltr 
```

![在此处输入图像描述](../Images/42242a49ad02ea60600e032021c0f04c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:41:08.603

您确定其他操作在自定义拦截器堆栈的同一包中吗？

您的拦截器不是线程安全的，但它应该是；我不知道谁和在哪里设置`authenticationSessionField`字段，但是将其声明为类范围是错误的方法。

我写了[一篇关于创建自定义登录拦截器的小文章](http://andrealigios.blogspot.it/2012/08/struts2-write-your-own-interceptor-for.html)，请随意阅读：）

代码（和英文）不是最好的，但它工作得很好，至少它可以传达这个想法......

# powershell - PowerShell 中的自定义 RoboCopy 进度条

> ID：13883404
> 
> 赞同：32
> 
> 时间：2012-12-14T17:20:52.477
> 
> 标签：powershell

我对每天从服务器复制大量文件的 PowerShell 脚本感兴趣，并且我对实现控制台中的进度条感兴趣，例如

`File copy status - XX% complete.`

在`XX%`换行符之后更新同一行而不是换行符。我现在决定使用 RoboCopy。我目前有

`ROBOCOPY 'C:\Users\JMondy\Desktop\Sample1' 'C:\Users\JMondy\Desktop\Sample2' *.* /E /IS /NFL /NJH`

你下一步怎么做？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2014-01-18T20:52:57.410

我编写了一个名为 PowerShell 的函数`Copy-WithProgress`，它可以实现您的目标。由于您特别声明您使用的是 robocopy，因此我构建了一个 PowerShell 函数来封装 robocopy 功能（至少是其中的一部分）。

请允许我向您展示它是如何工作的。我还[录制并发布了一段 YouTube 视频，](http://www.youtube.com/watch?v=z9KeYa842rc)演示了该功能的设计方式以及调用测试运行的方式。

功能分为区域：

*   常见的 robocopy 参数
*   暂存（计算 robocopy 作业大小的位置）
*   复制（robocopy 作业开始的地方）
*   进度条（监控 robocopy 进度的地方）
*   函数输出（输出一些有用的统计数据，用于脚本的其余部分）

该函数有几个参数。

*   **Source** : 源目录
*   **目的地**：目标目录
*   **Gap**：robocopy 支持的“包间间隙”，以毫秒为单位，人为减慢复制速度，用于测试）
*   **ReportGap**：检查 robocopy 进度的时间间隔（以毫秒为单位）

在脚本的底部（函数定义之后），是如何调用它的完整示例。它应该可以在您的计算机上运行，​​因为一切都是可变的。有五个步骤：

1.  生成随机源目录
2.  生成目标目录
3.  调用`Copy-WithProgress`函数
4.  创建一些额外的源文件（模拟随时间的变化）
5.  再次调用该`Copy-WithProgress`函数，并验证仅复制更改

这是函数输出的截图。`-Verbose`如果您不想要所有调试信息，可以省略该参数。A`PSCustomObject`由函数返回，它告诉您：

1.  复制了多少字节
2.  复制了多少文件

![Copy-WithProgress PowerShell 函数](../Images/562575eafc277e8f1fa8077ec46c1fa6.png)

这是PowerShell ISE 和 PowerShell 控制台主机中的**PowerShell 进度条的屏幕截图。**

![PowerShell 进度条 (ISE)](../Images/e29d4cdce186e0a206bba2661f5c1534.png)

![PowerShell 进度条（控制台主机）](../Images/37b0b74722d59c405db80b483495ee4c.png)

这是代码：

```
function Copy-WithProgress {
    [CmdletBinding()]
    param (
            [Parameter(Mandatory = $true)]
            [string] $Source
        , [Parameter(Mandatory = $true)]
            [string] $Destination
        , [int] $Gap = 200
        , [int] $ReportGap = 2000
    )
    # Define regular expression that will gather number of bytes copied
    $RegexBytes = '(?<=\s+)\d+(?=\s+)';

    #region Robocopy params
    # MIR = Mirror mode
    # NP  = Don't show progress percentage in log
    # NC  = Don't log file classes (existing, new file, etc.)
    # BYTES = Show file sizes in bytes
    # NJH = Do not display robocopy job header (JH)
    # NJS = Do not display robocopy job summary (JS)
    # TEE = Display log in stdout AND in target log file
    $CommonRobocopyParams = '/MIR /NP /NDL /NC /BYTES /NJH /NJS';
    #endregion Robocopy params

    #region Robocopy Staging
    Write-Verbose -Message 'Analyzing robocopy job ...';
    $StagingLogPath = '{0}\temp\{1} robocopy staging.log' -f $env:windir, (Get-Date -Format 'yyyy-MM-dd HH-mm-ss');

    $StagingArgumentList = '"{0}" "{1}" /LOG:"{2}" /L {3}' -f $Source, $Destination, $StagingLogPath, $CommonRobocopyParams;
    Write-Verbose -Message ('Staging arguments: {0}' -f $StagingArgumentList);
    Start-Process -Wait -FilePath robocopy.exe -ArgumentList $StagingArgumentList -NoNewWindow;
    # Get the total number of files that will be copied
    $StagingContent = Get-Content -Path $StagingLogPath;
    $TotalFileCount = $StagingContent.Count - 1;

    # Get the total number of bytes to be copied
    [RegEx]::Matches(($StagingContent -join "`n"), $RegexBytes) | % { $BytesTotal = 0; } { $BytesTotal += $_.Value; };
    Write-Verbose -Message ('Total bytes to be copied: {0}' -f $BytesTotal);
    #endregion Robocopy Staging

    #region Start Robocopy
    # Begin the robocopy process
    $RobocopyLogPath = '{0}\temp\{1} robocopy.log' -f $env:windir, (Get-Date -Format 'yyyy-MM-dd HH-mm-ss');
    $ArgumentList = '"{0}" "{1}" /LOG:"{2}" /ipg:{3} {4}' -f $Source, $Destination, $RobocopyLogPath, $Gap, $CommonRobocopyParams;
    Write-Verbose -Message ('Beginning the robocopy process with arguments: {0}' -f $ArgumentList);
    $Robocopy = Start-Process -FilePath robocopy.exe -ArgumentList $ArgumentList -Verbose -PassThru -NoNewWindow;
    Start-Sleep -Milliseconds 100;
    #endregion Start Robocopy

    #region Progress bar loop
    while (!$Robocopy.HasExited) {
        Start-Sleep -Milliseconds $ReportGap;
        $BytesCopied = 0;
        $LogContent = Get-Content -Path $RobocopyLogPath;
        $BytesCopied = [Regex]::Matches($LogContent, $RegexBytes) | ForEach-Object -Process { $BytesCopied += $_.Value; } -End { $BytesCopied; };
        $CopiedFileCount = $LogContent.Count - 1;
        Write-Verbose -Message ('Bytes copied: {0}' -f $BytesCopied);
        Write-Verbose -Message ('Files copied: {0}' -f $LogContent.Count);
        $Percentage = 0;
        if ($BytesCopied -gt 0) {
           $Percentage = (($BytesCopied/$BytesTotal)*100)
        }
        Write-Progress -Activity Robocopy -Status ("Copied {0} of {1} files; Copied {2} of {3} bytes" -f $CopiedFileCount, $TotalFileCount, $BytesCopied, $BytesTotal) -PercentComplete $Percentage
    }
    #endregion Progress loop

    #region Function output
    [PSCustomObject]@{
        BytesCopied = $BytesCopied;
        FilesCopied = $CopiedFileCount;
    };
    #endregion Function output
}

# 1\. TESTING: Generate a random, unique source directory, with some test files in it
$TestSource = '{0}\{1}' -f $env:temp, [Guid]::NewGuid().ToString();
$null = mkdir -Path $TestSource;
# 1a. TESTING: Create some test source files
1..20 | % -Process { Set-Content -Path $TestSource\$_.txt -Value ('A'*(Get-Random -Minimum 10 -Maximum 2100)); };

# 2\. TESTING: Create a random, unique target directory
$TestTarget = '{0}\{1}' -f $env:temp, [Guid]::NewGuid().ToString();
$null = mkdir -Path $TestTarget;

# 3\. Call the Copy-WithProgress function
Copy-WithProgress -Source $TestSource -Destination $TestTarget -Verbose;

# 4\. Add some new files to the source directory
21..40 | % -Process { Set-Content -Path $TestSource\$_.txt -Value ('A'*(Get-Random -Minimum 950 -Maximum 1400)); };

# 5\. Call the Copy-WithProgress function (again)
Copy-WithProgress -Source $TestSource -Destination $TestTarget -Verbose; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-15T22:15:07.827

这些解决方案很棒，但是一种快速简便的方法可以轻松获得所有文件的浮动进度，如下所示：

```
robocopy <source> <destination> /MIR /NDL /NJH /NJS | %{$data = $_.Split([char]9); if("$($data[4])" -ne "") { $file = "$($data[4])"} ;Write-Progress "Percentage $($data[0])" -Activity "Robocopy" -CurrentOperation "$($file)"  -ErrorAction SilentlyContinue; } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-11T23:11:49.847

你绝对必须使用robocopy吗？

如果没有，您可以为每个文件调用此线程中的代码：[大文件复制期间的进度（复制项目和写入进度？）](https://stackoverflow.com/questions/2434133/progress-during-large-file-copy-copy-item-write-progress)

或者，使用从 powershell 调用的 robocopy 的 /L 开关来获取 robocopy 将复制的文件列表，并使用 for-each 循环通过该复制功能运行每个文件。

您甚至可以嵌套写入进度命令，以便报告“文件 x of y - XX% 完成”

像这样的东西应该可以工作，需要对子目录做一些工作（我怀疑不仅仅是将 -recurse 添加到 gci 命令），但会让你朝着正确的方向前进。

注意：我在手机上写这个，代码还未经测试......

```
function Copy-File {
param( [string]$from, [string]$to)
$ffile = [io.file]::OpenRead($from)
$tofile = [io.file]::OpenWrite($to)
Write-Progress `
    -Activity ("Copying file " + $filecount + " of " + $files.count) `
    -status ($from.Split("\")|select -last 1) `
    -PercentComplete 0
try {
    $sw = [System.Diagnostics.Stopwatch]::StartNew();
    [byte[]]$buff = new-object byte[] 65536
    [long]$total = [long]$count = 0
    do {
        $count = $ffile.Read($buff, 0, $buff.Length)
        $tofile.Write($buff, 0, $count)
        $total += $count
        if ($total % 1mb -eq 0) {
            if([int]($total/$ffile.Length* 100) -gt 0)`
                {[int]$secsleft = ([int]$sw.Elapsed.Seconds/([int]($total/$ffile.Length* 100))*100)
                } else {
                [int]$secsleft = 0};
            Write-Progress `
                -Activity ([string]([int]($total/$ffile.Length* 100)) + "% Copying file")`
                -status ($from.Split("\")|select -last 1) `
                -PercentComplete ([int]($total/$ffile.Length* 100))`
                -SecondsRemaining $secsleft;
        }
    } while ($count -gt 0)
$sw.Stop();
$sw.Reset();
}
finally {
    $ffile.Close()
    $tofile.Close()
    }
}

$srcdir = "C:\Source;
$destdir = "C:\Dest";
[int]$filecount = 0;
$files = (Get-ChildItem $SrcDir | where-object {-not ($_.PSIsContainer)});
$files|foreach($_){
$filecount++
if ([system.io.file]::Exists($destdir+$_.name)){
                [system.io.file]::Delete($destdir+$_.name)}
                Copy-File -from $_.fullname -to ($destdir+$_.name)
}; 
```

就我个人而言，我将此代码用于 USB 记忆棒的小副本，但我在 powershell 脚本中使用 robocopy 进行 PC 备份。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-01-19T13:16:40.707

这是我最终用于此类任务的代码片段：

```
$fileName = 'test.txt'
$fromDir  = 'c:\'
$toDir    = 'd:\'

$title = $null
&robocopy "$fromDir" "$toDir" "$fileName" /z /mt /move /w:3 /r:10 /xo | %{
    $data = $_.Split("`t")
    if ($title -and $data[0] -match '\d+(?=%)') {
        Write-Progress $title -Status $data -PercentComplete $matches[0]
    }
    if($data[4]) {$title = $data[4]}
}
Write-Progress $title -complete 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-06T14:42:36.410

这是 RoboCopy 的本机 PowerShell **GUI**版本。（没有EXE文件）

我希望它对某人有所帮助。

![在此处输入图像描述](../Images/ed0f7b7447dcb897607bcdc137e3ae4c.png)

[https://gallery.technet.microsoft.com/PowerShell-Robocopy-GUI-08c9cacb](https://gallery.technet.microsoft.com/PowerShell-Robocopy-GUI-08c9cacb)

仅供参考：有没有人可以将 PowerCopy GUI 工具与 Copy-WithProgress 栏相结合？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-22T13:14:33.617

进度条很好，但在复制数百个文件时，显示进度会减慢操作速度，在某些情况下会减慢速度。这是 robocopy 帮助说明 /MT 标志将输出重定向到日志以获得更好性能的原因之一。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-06T14:04:01.660

我最终根据 Amrinder 的建议答案使用了这个：

```
robocopy.exe $Source $Destination $PatternArg $MirrorArg /NDL /NJH /NJS | ForEach-Object -Process {
    $data = $_.Split([char]9);
    if (($data.Count -gt 4) -and ("$($data[4])" -ne ""))
    {
        $file = "$($data[4])"
        Write-Progress "Percentage $($data[0])" -Activity "Robocopy" -CurrentOperation "$($file)" -ErrorAction SilentlyContinue; 
    }
    else
    {
        Write-Progress "Percentage $($data[0])" -Activity "Robocopy" -CurrentOperation "$($file)"
    }
}
# Robocopy has a bitmask set of exit codes, so only complain about failures:
[int] $exitCode = $global:LastExitCode;
[int] $someCopyErrors = $exitCode -band 8;
[int] $seriousError = $exitCode -band 16;
if (($someCopyErrors -ne 0) -or ($seriousError -ne 0))
{
    Write-Error "ERROR: robocopy failed with a non-successful exit code: $exitCode"
    exit 1
} 
```

仅供参考，比尔

# javascript - Javascript 对未定义的最短检查，如果它被分配了一个默认值

> ID：13883407
> 
> 赞同：3
> 
> 时间：2012-12-14T17:21:03.250
> 
> 标签：javascript

如果将参数或充满属性的对象传递给函数，检查未定义的参数并为未定义的参数提供默认值很有用。

如果不使用像 jQuery 范围这样的库函数，那么执行这种分配默认值的最短代码是什么？

这是我能想到的最短的：

```
var test;
var output = (typeof test != "undefined") ? test : "Default"; 
```

在有人建议之前：

```
var test;
var output = test || "Default"; 
```

这不适用于 false、0 或 ""

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T17:22:07.573

尝试这个：

```
var output = test != null ? test : "Default"; 
```

伊格：

```
null == undefined // true
null == null // true
null == 0 // false
null == "" //false
null == false // false 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-12T17:01:16.240

好的，所以如果*“未定义”*它是最长的类型值，那么检查对象存在的最短方法是

```
!(typeof console).charAt(8) 
```

其中*“控制台”*是我们检查的对象。 *.charAt(8)*将返回空字符串 "" 如果 object 不是*"undefined"*，则等于*false* 这是旧 IE 支持的安全方式。但是如果你只需要现代浏览器的支持，你可以只使用

```
if(!(typeof console)[8]) { doWork(); } 
```

检查对象是否已定义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-05T08:40:19.137

[https://github.com/jed/140bytes/wiki/Byte-saving-techniques](https://github.com/jed/140bytes/wiki/Byte-saving-techniques)是你的朋友：

```
var output = test===[]._ ? "Default" : test; 
```

更短：

```
var output=test===[]._?"Default":test; 
```

运算符和标记之间不需要空格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-02-09T15:03:16.513

在 ES2021 中，现在可以使用[Nullish coalescing operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator)。

用法：

```
const str = null ?? 'default string';
console.log(str);
// expected output: "default string"

const num = 0 ?? 42;
console.log(num);
// expected output: 0

const bool = false ?? true;
console.log(bool)
// expected output: false 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-14T17:26:28.720

你可以试试这个：

```
var output = if(test === undefined) ? test: "Default"; 
```

如果您知道您永远不会传递`0`, `false`, 或`""`作为有效参数，您可以将其简化为：

```
var output = if(test) ? test : "Default"; 
```

然而，这涉及到 JavaScript 中神秘的“真假”部分。通过让`===`您使用类型比较进行相等性检查。

希望这可以帮助。

# php - 用接口捕获异常。

> ID：13883408
> 
> 赞同：6
> 
> 时间：2012-12-14T17:21:03.443
> 
> 标签：php, exception, interface, try-catch, catch-block

我对 PHP 中的异常处理有疑问。

我有很多例外，它们的含义相同：找不到东西。所有这些异常都实现了接口（*不是类*）`NotFoundException`。所以我的问题是：可以检查异常是否在 catch-block 实现了接口。我知道我可以将 NotFoundException 接口更改为一个类，但某些异常已经扩展为另一个异常。（例如：`CategoryNotFoundException`扩展`CategoryException`和实现`NotFoundException`）。

为什么我需要这个接口？当一个页面正在显示并且一些实现该接口的异常将抛出一个 Error404 应该显示。例子：

```
$userPage = $_GET["page"];
try{
    showPage($userPage);
} catch (){ //How to catch the `NotFoundException` interface?
    showPage("Error404");
} catch (Exception $e){
    showPage("Error500"); //Something is wrong...
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-14T22:07:33.450

只需指定您要捕获的异常类（或接口）：

```
try {
    showPage($userPage);
} catch (NotFoundException $e) {
    showPage("Error404");
} catch (Exception $e) {
    showPage("Error500");
} 
```

# javascript - 在 phonegap 构建中更改权限

> ID：13883410
> 
> 赞同：1
> 
> 时间：2012-12-14T17:21:11.077
> 
> 标签：javascript, android, cordova, build

我试图测试 phonegap 的相机/文件上传功能，并直接从他们在 phonegap 构建中的文档编译示例应用程序。但是，我意识到由于权限我没有成功。如何在 phonegap 构建项目中添加相机/文件上传权限？我注意到您必须添加一个 config.xml 文件，但是 androidmanifest 呢？我对此真的很陌生，找不到一个很好的例子。

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:28:53.147

尝试将其添加到清单文件的顶部...

```
<uses-permission android:name="android.permission.CAMERA"/>   
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.INTERNET"> 
```

# google-maps - 谷歌路线规划器缩放中心

> ID：13883414
> 
> 赞同：0
> 
> 时间：2012-12-14T17:21:30.813
> 
> 标签：google-maps, google-maps-api-3

我在我的网站上使用 Google 路线规划器，旁边有方向面板。当您点击某个旅程的某个部分时，它会在地图上放大，但不会居中。是否可以将其置于地图中间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T04:52:36.390

单击面板时，没有实现任何控制任何内容的选项。

但是你可以做什么：当你点击面板时，信息窗口就会打开。您可以创建自己的 infoWindow 对象并将其作为 infoWindow 选项传递给方向渲染器。

然后你就可以控制信息窗口了。观察 infoWindow 的 domready 事件（它将在 infoWindow 打开之前触发），并将地图的中心设置为 infoWindow 的 getPosition() 方法返回的值。

```
// Show directions
if(!Demo.iw){
  Demo.iw=new google.maps.InfoWindow();
  google.maps.event
    .addListener(Demo.iw,'domready',
                 function(){Demo.map.setCenter(this.getPosition());});
}
Demo.dirRenderer.setOptions({
                    map         : Demo.map,
                    panel       : Demo.dirContainer,
                    infoWindow  : Demo.iw,
                    directions  : dirResult
}); 
```

# php - 内置编码/解码功能，支持密钥，而不是 mcrypt

> ID：13883418
> 
> 赞同：0
> 
> 时间：2012-12-14T17:21:48.577
> 
> 标签：php

php是否有任何用于编码和解码字符串的内置函数，我希望它非常简单，mcrypt可以完成这项工作，但我仍然不需要顶级加密。除了urlencode（）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:25:37.810

看看[OpenSSL](http://us2.php.net/manual/en/book.openssl.php)

```
$key = file_get_contents('keyfile');
openssl_private_encrypt($data, $encrypted, $key);
openssl_private_decrypt($data, $decrypted, $key); 
```

# c# - 异步运行例程，即使执行在子线程中保持？

> ID：13883422
> 
> 赞同：0
> 
> 时间：2012-12-14T17:21:59.247
> 
> 标签：c#

我正在开发一个 UDP 侦听器 Windows 应用程序，一旦 UDP 消息到达应用程序，我将创建一个新的专用线程，该线程执行与此 udp 消息相关的例程。

该例程被异步调用。

为什么异步？

主要是为了保持 UDP 即将到来的顺序，因为异步调用在线程池中排队（如果我让每个线程同步运行则不是这种情况）。

我的问题：

*   即使该例程在子线程中运行，异步运行例程也是一个好主意吗？
*   如果是的话，我是否应该为此异步调用实施 IsBusy 最佳实践，即使它是一种“一劳永逸”的模式？

我希望我能很好地解释我想要实现的目标

为我糟糕的英语道歉

问候

xPridex

注意：这不是准确的代码，我删除了很多关于 lisibity 的细节。

```
/// <summary>
/// Launch SendNotificationToEBSECW treatment.
/// </summary>
/// <param name="sender">object : UDPmsg_t_Mapping</param>
private void StartPrepared(object sender)
{
            mainThread = new Thread(new ParameterizedThreadStart(EntryPointV3));
            mainThread.Start(sender);
}

private readonly object _sync = new object();
private bool _myTaskIsRunning = false;

public bool IsBusy
{
  get { return _myTaskIsRunning; }
}

public void DoWorkAsynch(Tuple.Create(x,y))
{
  MyTaskWorkerDelegate worker = new MyTaskWorkerDelegate(EntryPointV3);
  AsyncCallback completedCallback = new AsyncCallback(MyTaskCompletedCallback);

  lock (_sync)
  {
    if (_myTaskIsRunning)
      throw new InvalidOperationException("currently busy.");

    AsyncOperation async = AsyncOperationManager.CreateOperation(null);
    worker.BeginInvoke(Tuple.Create(x,y), completedCallback, async);
    _myTaskIsRunning = true;
  }
}

private void MyTaskCompletedCallback(IAsyncResult ar)
{
  // get the original worker delegate and the AsyncOperation instance
  MyTaskWorkerDelegate worker =
    (MyTaskWorkerDelegate)((AsyncResult)ar).AsyncDelegate;
  AsyncOperation async = (AsyncOperation)ar.AsyncState;

  // finish the asynchronous operation
  worker.EndInvoke(ar);

  // clear the running task flag
  lock (_sync)
  {
    _myTaskIsRunning = false;
  } 

  // raise the completed event
  AsyncCompletedEventArgs completedArgs = new AsyncCompletedEventArgs(null,
    false, null);
  async.PostOperationCompleted(
    delegate(object e) { OnMyTaskCompleted((AsyncCompletedEventArgs)e); },
    completedArgs);
}

public event AsyncCompletedEventHandler MyTaskCompleted;

protected virtual void OnMyTaskCompleted(AsyncCompletedEventArgs e)
{
  if (MyTaskCompleted != null)
    MyTaskCompleted(this, e);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:37:36.183

该代码显然没有任何问题，但我确实有一些评论：

*   `new Thread`不使用线程池，它总是创建一个新的专用线程。
*   由于线程调度、已完成的工作以及您无法控制的其他事情，创建新的专用线程或使用线程池都不会确保线程按顺序完成。

如果您必须按接收顺序处理消息，则不应在单独的线程中处理每条消息。相反，将每条消息添加到队列中，并在后台线程中按顺序处理队列中的每个项目。

线程没有任何内置方式在完成或返回结果时提醒其创建者。如果您想这样做，请使用`System.MulticastDelegate.BeginInvoke`; 使用线程池。如果您想在线程运行时获得中间结果，请使用`BackgroundWorker`.

# php - 使下拉列表中的第一个值（'-select-'）为空

> ID：13883423
> 
> 赞同：2
> 
> 时间：2012-12-14T17:22:04.557
> 
> 标签：php, forms, codeigniter

我们有一个包含一些可选值的表单，这些值包含在下拉列表中。当新用户打开表单时，下拉列表中的默认值应为“-select-”。用户选择的值会发送到我们的数据库。现在一切正常，除了我们没有将“-select-”列为第一个选项，默认值是我们数据库中列出的第一个选项。

我正在尝试添加“-select-”，但是当我提交仍然选择“-select-”的表单时收到数据库错误。

```
<div class="control-group">
<label class="control-label">Pricing Profile: </label>
<div class="controls">
    <?php 
    echo form_dropdown('pricing_profile_id', $pricing_profiles, 
              $profile->pricing_profile_id,' class="span3" id="pricing_profile_id" ');
    ?>
</div>
</div> 
```

我尝试在“echo form_dropdown”上方添加此文本，但它似乎不起作用：

```
array_unshift($pricing_profiles, array(0 => "-select-")); 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:25:39.427

HTML 不像 PHP 那样支持“空”值，因为它是一种标记语言 (XML)，而不是像 PHP 这样的编程语言。

因此，您不能给它一个 NULL 值。最接近它的方法是在 PHP 中查找“NULL”值并将其值设置为 NULL，或者简单地允许选项的值为空白，在 PHP 中将空白评估为 NULL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T17:23:54.193

1.  将“选择”作为列表中的一项选择
2.  将 select 的值设为“”（即无值），例如： `( '' => 'Select' )`
3.  在表单上运行表单验证（无论如何你都应该这样做）。将下拉列表设为“必需”
4.  如果用户没有选择任何东西，表单验证就会失败，因为他们没有“选择”一些东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T19:26:58.267

在您填充 $pricing_profiles 的控制器中添加选择。例如，如果您将数据传递给 $data 中的视图，它将如下所示：

```
$data['pricing_profiles'] = whatever you are doing to populate this array;
$data['pricing_profiles'][0] = '-select-'; 
```

然后在您的表单验证中，您执行一个回调函数

```
$this->form_validation->set_rules('pricing_profile_id','Pricing Profile',callback_checkPricingProfile);

function checkPricingProfile($pricing_profile_id)
{
    if($pricing_profile_id==0)
    {
       return false;
    }
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T20:48:14.287

所以我是公司的 CEO，而我的 CTO 今天不在（现在公司里只有我们两个人，所以我尽可能地尝试编码），这就是我问这个问题的原因。然而结果他进来了，我们看了答案，都非常感谢！通过我们的控制器设置方式，我们找到了一个稍微不同的解决方案。

在我们添加的视图文件中：

```
array_unshift($pricing_profiles, "-select-"); 
```

在控制器中，我们创建了一个名为 $companies_profiles_data 的数组，它包含多个值，其中之一是 price_profile_id。我们在设置值的行中添加了一个三元运算符。

```
'pricing_profile_id' => (strcmp($this-> input-> post('pricing_profile_id'),'0')==0) 
? NULL : $this-> input-> post('pricing_profile_id'), 
```

# symfony - Symfony2 500 对共享主机的响应

> ID：13883427
> 
> 赞同：2
> 
> 时间：2012-12-14T17:22:08.703
> 
> 标签：symfony, shared-hosting

我有一个正在运行的 Symfony2 应用程序在我的本地服务器上运行，我想上传到我的共享主机。当我尝试在共享主机上打开网站时，我收到 500 响应。

我执行以下步骤：

1.  清除缓存（“php app/console cache:clear”和“php app/console cache:clear --env=prod”）
2.  上传 /app、/src、/vendor、/web 到共享主机
3.  使 /logs 和 /cache 可写（以及所有子文件夹/文件）

当我打开“www.mydomain.com/app.php”时，我收到 500 响应。当我打开“www.mydomain.com/app_dev.php”时，Symfony 给出了（预期的和正确的）消息，我不允许打开这个文件。

/logs/prod.log 为空。

我无法清除共享托管服务器上的缓存，因为我没有 SHH 访问权限。我只能清除本地服务器上的缓存，然后上传文件。

我没有更改我的 /web/.htaccess 文件，它在其中：

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ app.php [QSA,L]
</IfModule> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T19:31:25.423

问题似乎是命令`php app/console cache:clear" and "php app/console cache:clear --env=prod`没有完全清除缓存文件夹。

如果运行该命令的用户无权删除 app/cache/ 中的文件/文件夹，则可能会发生这种情况。手动删除此文件夹的内容可以解决问题 ( `rm -rf app/cache/*`)。

# ruby-on-rails - 如何使用 ActiveRecord 获取包含 2 条相关记录的记录列表？

> ID：13883429
> 
> 赞同：1
> 
> 时间：2012-12-14T17:22:12.487
> 
> 标签：ruby-on-rails, ruby, activerecord, arel

假设我有 2 个模型：

```
class Person < ActiveRecord::Base
  has_many :addresses
end
class Address < ActiveRecord::Base
  belongs_to :person
end 
```

我想得到所有恰好有 2 个地址的人。是否有一种简单的 ActiveRecord/Arel 方法可以使用子查询来执行此操作？我不想使用 counter_cache 来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:33:57.373

这对我有用（使用 Rails 3，PostGreSQL）：

```
Patient.joins(:interventions).group('patients.id').having('count(patient_interventions.id) = 2') 
```

**在您的情况下，以下内容应返回恰好具有 2 个地址的人员：**

```
Person.includes(:addresses)
      .select('persons.*')
      .group('persons.id')
      .having('count(addresses.id) = 2')
# Note use :joins instead of :includes if you don't want the addresses data 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T17:39:24.377

@MrYoshiji 的回答很好，但有时您可能更喜欢做两个查询。另一种方法：

```
person_ids = Address.select('person_id, count(person_id) as cnt').group('person_id').having('cnt = 2').pluck(:person_id)
Person.find person_ids 
```

# regex - 使用正则表达式匹配相同长度的子字符串

> ID：13883432
> 
> 赞同：2
> 
> 时间：2012-12-14T17:22:21.690
> 
> 标签：regex, perl

我有一个类似于找到“匹配括号”的挑战，但我想这是一个更简单的挑战。例如，像“xAAAyBBBz”这样的字符串应该匹配，因为有 3 个 A 和 3 个 B。但是，“xAAyBBBz”不应该匹配，因为有一个“不匹配”B。字符串有任意长度，它应该是一个单一的正则表达式。我可以使用正则表达式中的评估（毕竟是 Perl），我可以（应该！）完全避免正则表达式。但现在我很好奇了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:32:25.543

```
^[^AB]*(A(?:[^AB]*|(?-1))B)[^AB]*\z 
```

 *```
^
[^AB]*       # "x"
(
  A
  (?:
    [^AB]*   # "y"
  |
    (?-1)
  )
  B
)
[^AB]*       # "z"
\z 
```

捕获组`(A(?:[^AB]*|(?-1))B)`匹配`A`开头的 a 和`B`结尾的 a。在这两者之间，可能有任意数量的非（`A`或`B`）字符，或者第一个捕获组的模式可能在此位置（`(?-1)`）递归匹配。这保证了`A`s 和`B`s 是平衡的。*

# java - lucene 对常见 NLP 任务的支持

> ID：13883433
> 
> 赞同：0
> 
> 时间：2012-12-14T17:22:29.093
> 
> 标签：java, lucene, nlp, text-mining, opennlp

我正在从事一个文本挖掘项目，该项目计划稍后集成 Lucene。我当前的实现将 openNLP 用于常见的 NLP 任务，例如标记化、构建 n-gram 特征。我很想知道Lucene是否可以支持这些功能？与 openNLP 相比，Lucene 是否可以实现对大规模文档集合的高效率？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T22:20:31.007

1.  Lucene provides tokenization and n-gram analysis.
2.  If your Lucene documents have one or more categories, then you can implement a Hyperpipes classifier by counting the number of each category your hits fall into, then awarding the category with the most hits as the category of your query. (I'm sure there are other classifiers you could implement -- Hyperpipes just happened to come to mind as it kind of falls out of the wash from using a search engine as the backend.)
3.  Since Lucene is a library, you can use it from a GUI, a command-line program, or a service (daemon).

# ios - （自动布局）容器视图调整大小但子视图不

> ID：13883435
> 
> 赞同：5
> 
> 时间：2012-12-14T17:22:41.107
> 
> 标签：ios, uiview, autolayout, container-view

我在使用带有容器视图的自动布局时遇到了一些问题（在这两种情况下：使用从 ios5 使用的视图包含模式和一个简单的容器视图）。

我有一种自定义的 Master Detail 控制器，我可以在一些用户操作后调整左容器的大小，并且关联右控制器必须相应地调整未使用的新空间。

对于“详细”控制器，我使用 Xib 设置控制器并使用自动布局，我在其中有一些视图。在视觉格式中，它们会是这样的：

*   五：|[headerView][contentView][footerView]|
*   H:|[headerView]
*   H:|[内容视图]
*   H:|[页脚视图]

这只是理解问题的一种表示。

如果我尝试调整细节 controller.view 框架的大小，它会正确扩展，但子视图不会。

在该控制器的 - (void)viewDidLayoutSubviews 方法中，我尝试手动设置框架并且有效，但我认为这不是正确的事情，因为我使用的是自动布局！

如果我有一个通用视图和一个包含图像视图的子视图，如果我使用自动布局从 xib 定义该视图，如果我在设置视图后运行时更改框架子视图（edample 的图像视图）不调整大小，则此问题再次出现.

任何人都可以帮助我吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-20T12:59:02.680

根据您对约束的描述，我认为所描述的行为正是您告诉它要做的事情。

请注意，您的水平约束要求视图与其超级视图的左侧齐平。然而，他们没有说明他们应该如何与超级视图的右侧相关联。因此，改变超级视图的宽度并没有做任何事情；它们只是与左侧尺寸保持齐平，并保持其内部约束提供的任何宽度。

如果您希望视图使用其超级视图调整大小，则需要在尾端添加约束。具体来说，您的约束可能如下所示：

```
H:|[headerView]|
H:|[contentView]|
H:|[footerView]| 
```

或者，也许您希望它们仅在超级视图太窄时缩小，否则不要一直延伸到它上面。然后你可以这样做：

```
H:|[headerView]-(>=10)-|
H:|[contentView]-(>=10)-|
H:|[footerView]-(>=10)-| 
```

无论如何，您的问题的根源似乎是视图不以任何方式绑定到超级视图的右边缘，并且这不以任何方式绑定到它的宽度。添加这些约束应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-21T18:35:58.490

如果您的视觉格式的视图介于“|”之间 （这是你的情况）

```
CGSize fittingSize = [container systemLayoutSizeFittingSize: UILayoutFittingCompressedSize];
container.frame = CGRectMake(0, 150, 320, fittingSize.height); 
```

# javascript - ICanHaz.js 只是不起作用

> ID：13883436
> 
> 赞同：0
> 
> 时间：2012-12-14T17:22:41.567
> 
> 标签：javascript, templates, icanhaz.js

从 ICanHaz 示例（略微修改的版本： http: [//icanhazjs.com/](http://icanhazjs.com/)）：

模板：

```
<script id="user" type="text/html">
  <div>
    <p class="name">Hello I'm {{ name }}</p>
    <p><a href="http://twitter.com/{{ twitter }}">@{{ twitter }}</a></p>
  </div>
</script> 
```

编码：

```
 var user_data, user;

        user_data = {
            name: "Henrik Joreteg",
            twitter: "HenrikJoreteg",
            employer: "&yet",
            job_title: "JS nerd"
        };

        user = ich.user(user_data, true);
        console.log(user.toString()); 
```

控制台输出为：

```
 <div>
        <p class="name">Hello I'm </p>
        <p><a href="http://twitter.com/">@</a></p>
 </div> 
```

如您所见，它读取模板但不执行替换。我不知道如何调试它，这是最简单的用例。我在控制台中没有看到任何错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T21:59:55.007

事实证明，问题出在我正在使用的 django 框架和 ICanHaz.js 之间的标签冲突中。解决方案是安装 django-icanhaz 应用程序，它不仅可以解决问题，还可以将 icanhaz.js 模板存储为单独的文件。

# c# - 将目标 c 方法转换为 c# stringWithFormat:@"%@%.0f%@"

> ID：13883441
> 
> 赞同：0
> 
> 时间：2012-12-14T17:22:57.597
> 
> 标签：c#, objective-c, nstimeinterval, stringwithformat

好的，我正在努力将一些客观的 c 代码转换为 c#，这就是我所拥有的。

```
NSTimeInterval now = [[NSDate date] timeIntervalSince1970];

NSData * formattedstring= [[NSString stringWithFormat:@"%@%.0f%@", string1, now, string2] dataUsingEncoding:NSUTF8StringEncoding]; 
```

所以我创建了一个辅助类，我有这个：

```
var authTime = GetTimeIntervalSince1970(DateTime.Now);

var authDataString = String.Format("{0}{1}{2]",username, authTime, password); 
```

所以，我的问题是“%.0f”和“dataUsingEncoding:NSTimeInterval”。我知道第一部分与格式化“now”参数有关，我需要做些什么来确保我在 c# 中做同样的事情，有人可以向我详细解释或指导我我应该阅读的文章/博客？

谢谢！

更新：好吧，伙计们，我搞砸了，很抱歉我复制和粘贴错误，这是我困惑的一方。dataUsingEncoding:NSTimeInterval 应为：dataUsingEncoding:NSUTF8StringEncoding。所以我已经修复了这个帖子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:36:05.227

```
var authDataString = String.Format("{0}{1:F0}{2}",username, authTime, password); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:45:06.360

Objective-C 代码的第二行由两部分组成：

```
NSString *tmp = [NSString stringWithFormat:@"%@%.0f%@", string1, now, string2]; 
```

和

```
NSData *formattedstring = [tmp dataUsingEncoding:NSTimeInterval]; 
```

第一部分生成一个字符串。`NSTimeInterval`是`typedef`ed to `double`，所以`%.0f`基本上格式化`now`（例如 from `3.1415926`to `@"3"`）的地板。因此，假设您`GetTimeIntervalSince1970`返回一个浮点数，C# 中的等价物是

```
string tmp = string.Format("{0}{1:F0}{2}", username, authTime, password); 
```

然而，第二部分令人困惑。`dataUsingEncoding:`接受一个`NSStringEncoding`参数，但`NSTimeInterval`不是**可用的**[内置常量](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)之一。事实上，这很可能甚至不应该编译，因为`NSTimeInterval`它是一个`typedef`, 并且不能（隐式）转换为整数。我认为`NSData`大致相当于`System.Byte[]`在 C# 中，但是否需要转换字符串取决于您的具体需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:48:40.700

1.  对于“%.0f”，您可以阅读 Apple 的文档（它只是 ANSI C 的`printf`格式加上任何对象的 %@）：

    *   [格式化字符串对象](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/FormatStrings.html "格式化字符串对象")

    *   [字符串格式说明符](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html#//apple_ref/doc/uid/TP40004265-SW1 "字符串格式说明符")

2.  至于`dataUsingEncoding:NSTimeInterval`，我不认为原来的 Objective-C 代码是正确的。`NSString`的`dataUsingEncoding:`方法的签名是这样的：

    `- (NSData *)dataUsingEncoding:(NSStringEncoding)encoding`

    可能的值在`encoding`这里定义：[String Encodings](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/doc/c_ref/NSStringEncoding "NSString 类参考#NSStringEncoding")，在这里传递`NSTimeInterval`as`NSStringEncoding`没有意义。

# c# - 在 DevExpress 网格中拖放

> ID：13883444
> 
> 赞同：0
> 
> 时间：2012-12-14T17:23:02.590
> 
> 标签：c#, drag-and-drop, grid, devexpress

我正在尝试将拖放功能实现到 DevExpress 网格中。我尝试的第一种方法不起作用，因为该`dragdrop`方法没有受到影响。我是否必须让它由`mouseDown`事件触发，或者我该如何去做。示例将不胜感激。到目前为止，我尝试的是：

```
private void gridFields_DragDrop(object sender, DragEventArgs e)
{
    GridControl grid = sender as GridControl;
    GridView view = grid.MainView as GridView;
    GridHitInfo srcHitInfo = e.Data.GetData(typeof(GridHitInfo)) as GridHitInfo;
    GridHitInfo hitInfo = view.CalcHitInfo(grid.PointToClient(new Point(e.X, e.Y)));
    int sourceRow = srcHitInfo.RowHandle;
    int targetRow = hitInfo.RowHandle;
    MoveRow(sourceRow, targetRow);
}

private void MoveRow(int sourceRow, int targetRow)
{
    if (sourceRow == targetRow || sourceRow == targetRow + 1)
        return;

    GridView view = gridFieldView;
    DataRow row1 = view.GetDataRow(targetRow);
    DataRow row2 = view.GetDataRow(targetRow + 1);
    DataRow dragRow = view.GetDataRow(sourceRow);
    decimal val1 = (decimal)row1[OrderFieldName];
    if (row2 == null)
        dragRow[OrderFieldName] = val1 + 1;
    else
    {
        decimal val2 = (decimal)row2[OrderFieldName];
        dragRow[OrderFieldName] = (val1 + val2) / 2;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:32:33.707

抱歉，我想将其添加为评论，但不允许我这样做。

我假设您希望允许用户通过拖动来在 [WinForms] 网格中上下移动行。您实际上认为需要设置 MouseDown 事件是正确的。此外，您还需要 MouseMove 事件。

试试这个指南！[http://tv.devexpress.com/Content/XtraGrid/XtraGridDragRowsBetweenGrids/XtraGridDragRowsBetweenGrids.pdf](http://tv.devexpress.com/Content/XtraGrid/XtraGridDragRowsBetweenGrids/XtraGridDragRowsBetweenGrids.pdf)

如果您无法访问它，请告诉我。

**更新**

试试这些。它们是针对我的需求的，但我认为你应该能够重新利用它们。

```
 /// <summary>
    /// Drag n drop mouse down
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    private void Grid_MouseDown(object sender, System.Windows.Forms.MouseEventArgs e)
    {
        GridView view = sender as GridView;
        downHitInfo = null;

        GridHitInfo hitInfo = view.CalcHitInfo(new Point(e.X, e.Y));
        if (Control.ModifierKeys != Keys.None) return;
        if (e.Button == MouseButtons.Left && hitInfo.InRow && hitInfo.HitTest != GridHitTest.ColumnEdge
            && hitInfo.HitTest != GridHitTest.RowDetailEdge && hitInfo.HitTest != GridHitTest.RowEdge)
        {
            downHitInfo = hitInfo;
        }
    }

    /// <summary>
    /// Drag n drop mouse move, kicks off DragDrop
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    private void Grid_MouseMove(object sender, System.Windows.Forms.MouseEventArgs e)
    {
        GridView view = sender as GridView;
        if (e.Button == MouseButtons.Left && downHitInfo != null)
        {
            Size dragSize = SystemInformation.DragSize;
            Rectangle dragRect = new Rectangle(new Point(downHitInfo.HitPoint.X - dragSize.Width / 2,
                downHitInfo.HitPoint.Y - dragSize.Height / 2), dragSize);

            if (!dragRect.Contains(new Point(e.X, e.Y)))
            {
                this.gridControl.DoDragDrop(downHitInfo, DragDropEffects.All);
                downHitInfo = null;
            }
        }
    } 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-19T09:04:59.030

```
GridHitInfo hitInfo = view.CalcHitInfo(new Point(e.X, e.Y)); 
```

你调用的对象是空的。

# javascript - 从 JavaScript 中的用户输入生成复杂的文本模板

> ID：13883446
> 
> 赞同：0
> 
> 时间：2012-12-14T17:23:12.900
> 
> 标签：javascript, jquery, templates, text, generator

我正在构建一个 Web 应用程序，它基本上由几个选择、几个复选框和一个输入文本字段组成。每个选择包含超过 4 个选项。在用户选择他们的选项、填写文本输入、勾选所有可能的复选框并按下提交后，文本区域中会生成一个模板文本。生成的文本基本上是一个使用用户指定的所有选项的模板。在一个简单的形式中，它可以是这样的：

1.  用户从选择中选择“蓝色”和“你好”，不选中任何复选框，并在输入文本字段中写入“约翰”。
2.  然后生成的文本是：

`Hello, John, you have a blue car.`

现在，上面的例子比我生成的文本的实际复杂程度低了大约 100 倍。问题来了：最好的编码方式是什么？目前，我选择了带有大量静态文本和大量 IF 语句的丑陋嵌套 switch 语句。但它有一个限制，因为如果我增加更多复杂性，我将达到扩展当前 switch 语句的限制，并且还希望避免创建另一个级别的 switch 语句。

是生成所有可能的文本变体的最佳方式（我猜至少有 200-250 并且只需运行一个返回选定模板的 switch 语句（但是这会使更改应用于一个单词/句子/etc. 一场噩梦）？或者我应该抽象所有的选择并只使用变量构建最终文本（例如使用上面的示例：$greeting、$name、$middle $color $object。）？生成的最佳实践是什么？文本？

这不是 JavaScript 特有的，而是我正在使用的，因此欢迎提出如何在 JS 中执行此操作的建议。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:13:01.740

一种方法是使用 JSON 建立数据模型。您的 UI 会更新数据模型中的值，然后在每次更改后输出整个内容。这样你就可以跳过很多逻辑。

[jQuery 模板](http://net.tutsplus.com/tutorials/javascript-ajax/quick-tip-an-introduction-to-jquery-templating/)可以帮助完成这项工作：

# c#-4.0 - 通过c#项目访问wamp server www目录

> ID：13883451
> 
> 赞同：0
> 
> 时间：2012-12-14T17:23:20.007
> 
> 标签：c#-4.0, wamp

我需要执行以下操作：将 c# 项目中的图像（屏幕截图）保存到目录，并使用 wamp 服务器在 html/php 页面上显示此图像。

现在我可以执行以下操作之一： - 将图像保存到 wamp 的 www 目录（在这种情况下，我需要从 c# 项目中知道该目录在哪里） - 将图像保存在项目的 bin 目录中（在这种情况下，我的 html/ php 页面需要知道这个项目的 bin 目录在哪里） - 将图像保存在上面提到的 2 之外的某个目录中（在这种情况下，项目和 wamp 都需要知道这个目录在哪里）

这样做最合适的方法是什么，我应该如何进行编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:26:22.010

允许用户配置图像的位置。使用 xampp www 位置作为默认值。

# mysql - 使用 load data infile 的最低数据库权限

> ID：13883452
> 
> 赞同：5
> 
> 时间：2012-12-14T17:23:20.530
> 
> 标签：mysql, permissions, privileges, load-data-infile, mysqlimport

我正在使用 mysqlimport 将表中的数据替换为 TSV 文件中的值。一切正常（使用 DB 超级用户名和密码导入数据），所以现在我想将其锁定，以便执行导入的数据库用户只能影响我要替换的单个表。

我知道我需要在*.* 为了使用“LOAD DATA INFILE”（mysqlimport 包装），但我无法找到我可以授予数据库的最小权限集。

我试过了;

```
grant FILE on *.* to ...
grant ALL on dbname.tablename to .... 
```

但是当我运行 mysqlimport 时，这给了我一个错误；

```
mysqlimport: Error: Access denied for user ... 
```

有谁知道是否可以隔离数据库以便该用户只能更改相关表，还是我必须允许他们更广泛的访问权限才能使 mysqlimport 成为可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:29:49.327

不幸的是，FILE 权限没有绑定到数据库，它是执行 INFILE 操作所需的全局 Mysql 权限。

见[http://dev.mysql.com/doc/refman/5.1/en/privileges-provided.html#priv_file](http://dev.mysql.com/doc/refman/5.1/en/privileges-provided.html#priv_file)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:18:00.270

要回答我自己的问题，我认为如果不使用有权在数据库中删除和创建任何表的数据库用户，就不可能使用 mysqlimport 替换表中的数据。

mysqlimport 使用您正在加载的文件的名称来决定数据进入哪个表，因此它需要能够删除和重新创建*任何*表是有意义的，而不仅仅是我*希望*它能够替换的表。

遗憾。

# objective-c - animateWithDuration 如何知道要制作什么动画？

> ID：13883461
> 
> 赞同：4
> 
> 时间：2012-12-14T17:24:16.927
> 
> 标签：objective-c, ios

我只是第一次学习一些基本的 Objective-C 和 iOS 开发，所以请多多包涵。我非常熟悉其他语言的 lambdas 概念，但这是我第一次使用 Objective-C 块。

所以，按照 UIKit 动画教程，我想我会通过动画背景颜色来扩展它。我写了这个：

```
- (void) setBG: (float)r g:(float)g b:(float)b duration:(float)secs
{
    [UIView animateWithDuration:secs delay:0.0 options:0
                     animations:^{
                         [self setBackgroundColor: [UIColor colorWithRed:r green:g blue:b alpha:1.0]];
                     }
                     completion:nil];
} 
```

所以，我预计需要以某种方式告诉`animateWithDuration`哪些变量需要动画。我从一个为位置（so、x 和 y）设置动画的示例开始，并认为我可能需要对 3 个变量进行动画处理。

然而，令我惊讶的是，这“刚刚奏效”。不知何故，语言似乎已经自动确定我想要动画`r`,`g`和`b`. 编译器实际上是否在自省该块？这里发生了什么？如何`animateWithDuration`知道我希望它随着时间的推移修改哪些变量？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:32:06.790

编译器不会以这种方式解释您的代码。这完全由`UIView`班级完成。

我显然不知道确切的内部实现，但一种可能的方法是`shouldAnimate`在`UIView`. 类`animateWithDuration:...`方法可以在执行您传递的动画块之前打开此标志。a 的动画属性的 setter 方法`UIView`可能会检查这个标志来决定它是否需要动画：

```
- (void)setBackgroundColor:(UIColor *)newColor {
    if (shouldAnimate) {
        // set up and start animation.
    } else {
        _backgroundColor = newColor;  // just set without animating.
    }
    [self setNeedsDisplay];
} 
```

执行完动画块后，`animateWithDuration:...`finally 会再次关闭该标志，因此当您`UIView`在动画块之外设置任何属性时，它不会被动画化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T19:44:26.213

该类`UIView`具有跟踪您是否在动画块内以及动画参数是什么的私有变量。

各种`UIView`属性的设置器检查该状态。如果 setter 发现它在动画块内被调用，它会为该属性创建一个动画。（动画是`CABasicAnimation`附加视图层的一个实例。）

[*UIView 类参考*](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW131)中列出了动画属性：

*   `frame`
*   `bounds`
*   `center`
*   `transform`
*   `alpha`
*   `backgroundColor`
*   `contentStretch`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T19:38:00.257

`UIView animateWithDuration`在开始状态（原始值）和结束状态（您在动画块中设置的值）之间使用线性插值。想象一下变量值随时间变化的图表。使用所需的持续时间和两个点，它在（0 秒，起始值）和（持续时间，结束值）之间创建一条线。随着动画的播放，值会根据沿线随时间移动的点进行更新。

所以，我相信颜色被分解成值（rgb 是一个合乎逻辑的猜测）。我们有每个元素的开始值和结束值，它会随着动画持续时间而变化。

# delphi - 如何抛出 Delphi 无法捕获的异常？

> ID：13883462
> 
> 赞同：4
> 
> 时间：2012-12-14T17:24:20.250
> 
> 标签：delphi, exception, exception-handling

是否可以在 Delphi 中构建一段代码，使假设的 EChuckNorrisException 无法捕获？

对于我刚刚发现的 Java 编程语言，这在[Uncatchable ChuckNorrisException中得到了](https://stackoverflow.com/questions/13883166/uncatchable-chucknorrisexception)**“是”的回答**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-14T17:38:58.587

不。在 Delphi 中，可以**引发**任何对象（`TObject`后代），尽管按照惯例，这通常仅限于从基`Exception`类继承的对象。并且可以创建一个可以捕获*任何东西的通用异常处理程序。*

大多数试图以某种方式报告信息的包罗万象的异常处理程序如下所示：

```
try
...
except
  on E: Exception do
    ...
end; 
```

因此，如果您提出的东西不是从 下降的`Exception`，它将通过这种风格而不会被抓住。

但是，也可以这样写：

```
try
...
except
  ...
end; 
```

这种异常处理程序不会得到任何东西。

如果您引发了一个没有在任何地方捕获的异常，程序将立即终止并出现错误。`Halt`如果这是预期的效果，则可以通过使用非零错误代码调用来做同样的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T14:04:22.863

有时，调用应用程序的异常处理程序也不会捕获在 dll 中引发但未在该 dll 中捕获的异常。我想知道是否可以在不使用 dll 的情况下模仿这种行为？

# c++ - 两个伴随的类层次结构——一个好的设计模式？

> ID：13883465
> 
> 赞同：2
> 
> 时间：2012-12-14T17:24:28.143
> 
> 标签：c++

以下是 C++ 中的良好设计模式吗？

```
 Pet               PetOwner
     |                   |
 ---------         --------------
 |       |         |            |
Cat     Dog     CatOwner     DogOwner 
```

换句话说，**两个伴随的类层次结构**。你见过这样做吗，这是否被认为是一种好的做法？

让我进一步澄清。这种设计当然遵循“开闭”的原则。在可以轻松添加新事物（新的`Horse`和`HorseOwner`子类）的意义上它是“开放的”，而在无需修改现有代码就可以添加新事物的意义上它是“封闭的”。

这两个附带的层次结构的目的是，例如，`PetOwner`具有`feed()`虚拟功能，并且`Pet`具有`make_hungry_sound()`虚拟功能。此外，`Cat`是用特定的`CatOwner`.

有没有更好的设计模式可以取代像这样的两个相关层次结构？我问的原因是我想知道在扩展事物时要求人们同时添加**两个类是否被认为是一种好习惯。**好像有点半信半疑...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:34:28.173

似乎是一个非常主观的问题。答案可能很多（如果您在问题中添加更多信息，答案可能会更多），所以我将根据问题中可用的内容发表评论：

假设`PetOwner`要做的不仅仅是`feed()`，是的，拥有它是合理的。例如，您不会饲养每只宠物，也不会让每只宠物都参加选美比赛。如果`PetOwner`只需要喂食，那么只需要一个具体的类就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T17:30:25.850

就我而言，不，宠物的设计已经存在，但宠物主人没有理由具体说明，最终会变得模棱两可/过于复杂。创建一个可以容纳所有类型宠物的宠物主人，然后创建与所有宠物相关的功能将是一个更好的设计。

```
//in class petOwner
pet *animal;

//user wants a dog...
animal = new dog; //you now have a dog 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:33:43.093

您应该只拥有一个 PetOwner 并以 pet 及其子类为食的双重调度。宠物知道他必须吃什么。实施以宠物为食。

# arrays - Drupal访问und数组

> ID：13883467
> 
> 赞同：1
> 
> 时间：2012-12-14T17:24:34.957
> 
> 标签：arrays, drupal-7, undefined

我正在尝试使用以下代码读取键索引**UND数组：**

```
dsm( $node->$settings['field'][$node->language] ); 
```

设置数组包含以下内容：

```
Array
(
    [id] => 70
    [type] => event
    [field] => field_event_form_s_
) 
```

但是，我收到以下错误：

```
Notice: Undefined property: stdClass::$f in webform_questionnaire_validation_init() (line 27 of /var/www/mysite/sites/all/modules/anthonynolan/webform_questionnaire_validation/webform_questionnaire_validation.module). 
```

***更新***

根据要求，第 27 行的代码：

```
dsm( $node->$settings['field'][$node->language] ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T16:43:22.323

你应该使用`$node->{$settings['field']}[$node->language]`.

我尝试使用以下测试代码，它可以工作。

```
$node = new stdClass();
$node->language = 'und';
$node->field_event_form_s_ = array(
  'und' => array( 0 => 'Bingo!'),
);

$settings = array(
  'field' => 'field_event_form_s_'
);

dsm($node->{$settings['field']}[$node->language]); 
```

当我用我替换最后一行时，`dsm($node->$settings['field'][$node->language]);`我得到以下错误，就像你一样：

> 注意：未定义的属性：eval() 中的 stdClass::$f（/Library/WebServer/Documents/dr72/sites/all/modules/devel/devel.module(1285) 的第 11 行：eval() 的代码）。

# cordova - 归档分发时找不到Phonegap CDVViewController.h

> ID：13883471
> 
> 赞同：4
> 
> 时间：2012-12-14T17:25:08.480
> 
> 标签：cordova, cordova-2.0.0

我在**Xcode 4.5.2****的 Cordova/Phonegap 2.2 版中**遇到了这个问题。这是一个**新项目**- 所以立即开始，文件夹中没有任何内容被修改。当我在调试模式下构建时，一切正常。当我尝试在分发模式（AdHoc 或 App Store）下*构建归档时，我收到此错误：*****`www`****

 *****```
'Cordova/CDVViewController.h' file not found 
```

我可以发布任何进一步的信息来帮助澄清情况吗？

我已经尝试过几次从头开始（根据我见过的一些类似问题的建议）以及卸载和重新安装 Xcode 以获得良好的效果。我的 Xcode*派生数据*位置设置为*唯一*（根据另一个类似的问题）。我也`update_cordova_subproject`对项目进行了无效果。

非常感谢这里的任何帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T01:22:39.917

几周前我遇到了*同样的问题，我做了一些研究，试图找出原因和解决方案，但最终尝试了不同的方法，然后突然随机地，它就奏效了。*究竟是什么使它起作用-我不知道，但我建议您**采用跟踪和错误方法**并尝试以下方法

我按照相关性（解决您的问题的可能性）以及复杂性（升序）列出了以下**建议的解决方案**

## 方法一

转到**BuildSettings** > **Header** > **Search Paths**并添加以下行：

```
$(OBJROOT)/UninstalledProducts/include 
```

更多信息/建议可以在[这里找到](https://stackoverflow.com/questions/12184767/phonegap-cdvviewcontroller-h-file-not-found-when-archiving-for-ios/12596916)

## 方法二

出于某种原因，在升级到新的 2.x 版本的 Cordova 时，似乎**缺少 Cordova 中的依赖项。**这被认为是 Cordova 2.x更改了iOS 项目中引用*框架的方式的原因。*尝试按照 [本文的步骤](http://outof.me/embedding-cordovalib-in-your-iosphonegap-app-project/)

## 方法 3

如果 A1 和 A2 未能解决您的问题，则您收到的错误消息可能具有一定的误导性，迫使人们寻找其他潜在原因的**替代方法。****证书**和代码签名身份将是下一个要研究的地方。尝试**从 keychain/xcode**中删除它们，从*临时门户中***撤消**它们，**重新创建**新的并将它们添加到您的 Xcode 项目中。尝试存档，看看它是否有效。

 ***## 方法 4

确保您的**主项目**和**CordovaLib.xcodeproj**都设置为**Build Active Architecture Only**

## 其他建议

*您可能已经尝试过其中的一种或多种，​​但只是为了确保*

1.  **从全新安装**重新安装cordova ，在最新版本的Xcode上显式安装命令行工具（在执行此操作之前退出Xcode）****
***   **在删除当前包含的所有内容后，**将旧项目 www 文件夹复制到新命令行创建的 www 文件夹中*******   运行时密切关注**错误控制台**，看看是否有任何错误可能进一步帮助确定此问题的根源。****

 ****如果这些提议的解决方案都没有解决您的问题，请告诉我，那么我们只需要**更深入地挖掘，直到找到可行的**解决方案。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-10-24T03:28:29.210

**Xcode 6.x**

添加`$(OBJROOT)/UninstalledProducts/include`到 BuildSettings->Header Search Paths

**Xcode 7.x**

添加`$(OBJROOT)/UninstalledProducts/$(PLATFORM_NAME)/include`到 BuildSettings->Header Search Paths

这对我有用。希望它可以帮助你..

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-22T15:42:39.477

在尝试了我能找到的所有解决方案（包括乔纳森为这个问题发布的解决方案）但没有成功后，我已经解决了我的问题。希望添加到其他人列表中的这个答案会帮助其他人。如果我的回答不适用于您的类似情况，请查看以下由 Jonathan 发布的列表，该列表是其他可能解决方案的完整列表。

我有些独特的情况：在Phonegap 2.0 之前的版本中（当我能够编译时），我为AdHoc 和AppStore 创建了一个**自定义构建配置**。我们的默认设置是“Debug”和“Release”，并且创建了我的两个自定义配置，因此当我从 AppStore 版本切换到 AdHoc 构建时，我不必切换代码签名证书。

问题/解决方案：在 2.0 Phonegap 之后，我们有一个 CordovaLib.xcodeproj 子项目的实例（这是新的）......这意味着如果我要在我的主项目中使用自定义构建，我必须添加那个自定义也在这个子项目中构建配置。

Project Navigator >> 单击 CordovaLib.xcodeproj >> 单击*项目*CordovaLib >> Configurations >> 确保您要使用的任何构建都存在（按名称）在此列表中。假设您已经在过去创建了这些自定义构建配置的主项目中处理了此问题，则无需进一步配置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-01T06:02:15.293

I encountered this problem when using Cordova 2.7.0 on xcode 4.6.2 and fixed it by changing the setting for the build location for derived data:

Go to xcode->preferences Clicked advanced button under derived data Select unique

The reason I encountered this problem was because I was restarting a new 'version' of an old project as a new project in xcode, and after creating it I changed the bundle identifier to match my old project (Doing this allows you to submit your new project as an update of your old project in the app store). The default setting for derived data was Legacy, so it was looking for the cordova files using the original bundle identifier, not the new one.

Hope this helps someone that may encounter something similar************

# sql - SQL获取每个国家/地区人们工作的平均工资

> ID：13883474
> 
> 赞同：-1
> 
> 时间：2012-12-14T17:25:18.433
> 
> 标签：sql, sql-server, database, sql-server-2008

**微软 SQL 服务器 2008**

一个工人住在某个国家，可能有不止一份工作，有不止一份薪水。

我想得到每个国家个人总工资的平均值。

*表：*

1) 国家(country_id, name)

2) 人(ssn, name,country_id)

3）工作（ssn，job_title，薪水）

**[国家]**

*   1、美国
*   2、德国

**[人们]**

*   010101，约翰，1
*   020202，李，1
*   030303，哈利，2

**[工作]**

*   010101, 老师, 3200
*   010101, 建设者, 1500
*   020202, 演员, 45000
*   020202, 歌手, 200000
*   030303, 生产者, 120000

## **需要的查询结果：**

*每个国家的平均值（每个国家）=每个工人总工资的总和）/工人数量*

*国家 - 平均工资*

*   美国 - 124850
*   德国 - 120000

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:30:32.733

尝试这个：

```
SELECT c.name, sum(j.salary)/count(distinct p.ssn) as Avg_Sal 
FROM Countries c
INNER JOIN people p ON c.country_id = p.country_id
INNER JOIN Jobs j on p.ssn = j.ssn
group by c.name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:35:12.397

这应该适合你：

```
select Salary / count(c.name) AvgSalary, c.Name
from people p
inner join 
(
  select sum(salary) Salary, p.country_id
  from jobs j
  left join people p
    on j.ssn = p.ssn
  group by p.country_id
) sal
  on p.country_id = sal.country_id
left join countries c
  on p.country_id = c.country_id
group by salary, c.Name; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/d27ed/11)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:35:16.343

这将完全做到，

```
with
country as
(select c.country_id,c.name name,p.ssn ssn from countries c,people p where c.country_id=p.country_id),
sal1 as
(select sum(salary) salary,j.ssn ssn from people p,jobs j where p.ssn=j.ssn group by j.ssn)
select country.name,avg(sal1.salary) from sal1,country where sal1.ssn=country.ssn group by country.name; 
```

[sqlfiddle](http://sqlfiddle.com/#!3/d27ed/36)

使用 with 子句将更具可读性和可理解性。

# javascript - 事件侦听器不适用于新添加的表列

> ID：13883476
> 
> 赞同：0
> 
> 时间：2012-12-14T17:25:20.050
> 
> 标签：javascript, jquery, html

我有一个加载的基本 HTML 表。结构因上传的 CSV 文件的内容而异。表格列需要是可拖动的（为此我使用了一个名为 Dragtable 的插件）。然后我有添加行和列的方法。添加列方法如下所示：

```
function addCol(tblId) {
 var tblHeadObj = document.getElementById(tblId).tHead;
 for (var h=0; h < tblHeadObj.rows.length; h++) {
    var newTH = document.createElement('th');
    tblHeadObj.rows[h].appendChild(newTH);
    colCount = (tblHeadObj.rows[h].cells.length);
    newTH.innerHTML = 'Col ' + colCount;
 }

 var tblBodyObj = document.getElementById(tblId).tBodies[0];
 for (var i=0; i<tblBodyObj.rows.length; i++) {
    var newCell = tblBodyObj.rows[i].insertCell(-1);
    newCell.innerHTML = "*null*";
 }
} 
```

问题是当我添加一个新列时，我不能再拖动该列将其放置在不同的位置。我还有一个表标题的 onclick 处理程序，它允许用户在单击第 th 元素时删除一列。这也不适用于新添加的列。基本上，所有事件侦听器都不会添加到新列上。

我尝试隐藏和显示表格和页面，但不起作用。我想我需要一种刷新表格的方法，但找不到有效的方法。

像这样的东西：

```
var table = document.getElementById("grid");
table.refresh (); 
```

有没有办法做到这一点？还是我添加列的方式有问题，这可能是未附加事件侦听器的原因？

**编辑**

删除列方法如下：（使用适当的事件委托**编辑）****这解决了删除列方法的问题。我仍然无法拖动和排序新列**

```
$("table").delegate("th:not(:first)", "click", function() {
   var index = this.cellIndex;
   $(this).closest('table').find('tr').each(function() {
     this.removeChild(this.cells[ index ]);
   });  
} 
```

关于 Dragtable 列排序，我只是将可拖动类添加到我的表中。我不确定事件侦听器的外观：

```
<table id = "grid" class="draggable"></table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:43:55.233

您应该为此使用事件委托。您应该做的是向表本身添加一个事件侦听器，该侦听器检查`.target`事件对象的属性以查看事件是否针对标题并采取适当的操作。

除了事件委托方法之外，您可以进行的另一个简单修复是在添加新行时简单地附加处理程序：

```
newTH.addEventListener("click", function(){
     //this should be your event listener
}) 
```

[*正如 j08691 所指出的，您可能错误地标记了 jQuery，所以我现在不添加任何 jQuery 代码*]

# iced-coffeescript - 无法通过 map 或 reduce 等理解获得 iced-coffee-script

> ID：13883485
> 
> 赞同：0
> 
> 时间：2012-12-14T17:25:46.967
> 
> 标签：iced-coffeescript

总而言之，我今天发现了 iced-coffee-script，很高兴看到有人尝试为异步编程设计一种更具可读性的咖啡脚本方言。

尽管使用 map 和 reduce 函数之类的理解，或者更简单的 do/for，但我无法工作。例如...的输出

```
square = (x, callback) ->
  setTimeout ->
      callback x * x
    , 5000

console.log [ 1..10 ].map (x) ->
  await square x, defer y
  y 
```

...只是一个未定义的数组！我错过了什么？先感谢您。

贾塞科

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T00:17:02.617

我是冰的新手，但这是我的理解：

使用 await 和 defer 实际上并不会停止控制流，您的函数将照常返回。所以 .map 正在为每个元素返回“未定义”。

这是串行版本，如上：

```
foo = []
for x in [ 1..10 ]
  await square x, defer y
  foo.push y 
```

如果你想并行执行，它是这样的：

```
foo = []
await
  for x,i in ([ 1..10 ])
    square x, defer foo[i] 
```

请注意，我将 [1..10] 范围括在括号中。这是为了将范围扩展到一个数组，所以我们可以在循环内获取索引，在这里解释：[https ://github.com/jashkenas/coffee-script/issues/2586](https://github.com/jashkenas/coffee-script/issues/2586)

.push 在这里不起作用，因为通常不能保证回调按您想要的顺序返回。

有很多其他方法可以做到这一点，但我认为这是完成您在上面尝试做的最简洁的方法。请注意，如果它是一个大循环，它将首先分配整个数组，这可能效率低下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T06:32:26.280

我会将我的 2 美分添加到@doubledriscoll 的答案中，这样您就可以更好地了解这里实际发生的情况。让我们将您的代码示例翻译成常规的 javascript，所以这段代码：

```
console.log [ 1..10 ].map (x) ->
  await square x, defer y
  y 
```

相当于：

```
console.log([1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map(function(x) {
  return square(x, function(y) {
    return y;
  });
}); 
```

它将打印`square`函数返回的事物数组，即`undefined`.

# c++ - 如何将数组添加到列表中？

> ID：13883488
> 
> 赞同：1
> 
> 时间：2012-12-14T17:25:52.573
> 
> 标签：c++, list, stl

*我有一个名为vertices*的数组，它的声明如下：

```
 CPoint vertices[11]; 
```

然后我有一个名为 _m_ElementList_ 的列表

```
 std::list<CPoint[11]> m_ElementList; 
```

使用*AddElement()*我想向这个列表中添加元素，每个元素都是一个*CPoint*对象数组（即与顶点类型相同）

```
void AddElement(CPoint* vertices)
   { m_ElementList.push_back(vertices); } 
```

* * *

由于某种原因不起作用，它告诉我没有函数实例与参数列表匹配 - 为什么会这样，我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:33:36.633

使用原始数组和指针的*想法*一开始是错误的。您已经在使用`std::list`（即您似乎了解标准容器），那么为什么不`std::vector<CPoint>`也使用呢？它会让你的生活变得轻松：

```
std::list<std::vector<CPoint>> m_ElementList; 
```

接着 ：

```
void AddElement(std::vector<CPoint> vertices)  //C++11
{ 
    m_ElementList.push_back(std::move(vertices));  //move
} 
```

如果您的编译器不支持 C++11，则按引用传递：

```
void AddElement(std::vector<CPoint> const & vertices) //C++03
{ 
    m_ElementList.push_back(vertices);  //copy
} 
```

作为旁注，我认为`AddVertices`这将是一个更好的名字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:19:04.927

您可以将数组称为数组本身或指向第一个元素的指针。例如：

```
CPoint vertices[11];

// address of the first element
p_vertices = &vertices; 
```

或者

```
// allocate
CPoint * vertices = new CPoint[11];

// deallocate
delete [] veritices; 
```

如果您采用后一种方法，您可以简单地将您的向量声明为：

```
std::vector<CPoint*> m_elementList 
```

并插入为：

```
void AddElement(CPoint* points) 
{ 
   m_elementList.push_back(points);
} 
```

如果您需要将点数更改为 11 以外的值，这也有一点优势，因为动态分配允许使用变量代替常量。但是，您需要仔细控制对向量、它包含的数组和元素的访问，以强制正确使用。

顺便说一句，混合和匹配 STL 和 C 风格的指针完全没问题，特别是如果您希望传递相当多的数据结构并且复制元素是不可取的或昂贵的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:33:45.417

```
 std::list<CPoint[11]> m_ElementList; 
```

您声明列表类型错误，<> 括号定义列表包含的类型，而不是多少元素，正确的声明将是：

```
std::list<CPoint> m_ElementList; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T17:36:36.420

问题在于 CPoint 后面的括号。模板的目的是提供类的类型（或更重要的是，类的大小），而不是数量。尝试：

```
std::list<CPoint> m_ElementList; 
```

# matlab - 删除 MATLAB 中具有相同值的所有行

> ID：13883489
> 
> 赞同：2
> 
> 时间：2012-12-14T17:25:53.753
> 
> 标签：matlab, matlab-deployment, delete-row

我有一个这样的矩阵：

```
1 2 4
4 5 6
1 2 4
7 9 6
1 2 4 
```

我想删除相同的行。我的新矩阵应该是

```
4 5 6
7 9 6 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-17T06:30:34.723

基于`unique( ,'rows')`@tayler 的更完整的解决方案是

```
[uA, ~, ui] = unique(A, 'rows'); % we have a single copy of each row.
% it is now left to determine which row is duplicate 
n = hist( ui, 1:max(ui) );
sel = n == 1; % pick only indices that appear once
uA = uA(sel, :); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-14T17:42:24.763

一个好的起点是：

```
b = unique(A, 'rows') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T17:32:55.823

您可以尝试从所有其他行中减去一行，如果任何行包含全零，您就知道它包含重复的元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-16T15:52:56.727

我认为这个脚本可能会做你想做的事：

```
B= A;
position = 1;
condition = true;
bSize = size(B,1);
while (position < bSize)
    [~,~,ic] = unique(B,'rows');
    changes = find(ic(position:end,:)== ic(position));
    if (length(changes)>1)
        B(changes+position-1,:)= [];
        bSize = size(B,1);
    else
        position = position+1;
    end
end
disp(B) 
```

# objective-c - 我应该如何构建我的对象结构来平衡集合类和对象

> ID：13883493
> 
> 赞同：1
> 
> 时间：2012-12-14T17:26:16.547
> 
> 标签：objective-c, oop, object, collections

不太清楚如何解释这个，但这里有......

我正在为我的数据（在 Objective-C 中）构建一个对象结构，使其具有以下内容：

*   一个`Companies`集合类
    *   其中包含许多`Company`对象
        *   每一个都有一个`Users`集合类
            *   其中包含许多`User`对象

目的是获得关于对象（即`companyID`, `companyName`）的数据，以及关于集合类（`addCompany:`, `deleteCompany:`）的方法。

我真正想做的是构建类，以便我可以进行以下调用：

```
[[companies getCompanyWithID:1] addUserWithName:@"Duncan"]; 
```

但要做到这一点，我需要将该方法`addUserWithName:`放在公司集合类上。

对我来说这没有意义 - 添加/修改/删除/获取用户的方法应该在`Users`集合类上，而不是在`Companies`集合类上。

如果我将这些函数放在它们相关的集合类上，那么我必须编写相同的语句，如下所示：

```
[[companies getCompanyWithID:1].users addUserWithName:@"Duncan"]; 
```

但它读起来并不那么好——因为它`.users`在中间潜伏着一个令人讨厌的东西。

我是不是真的很愚蠢并且错过了一些明显的东西（我从未上过技术学校，所以很可能我错过了你们都知道的一些基本知识）。

任何帮助，非常感谢你们。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:58:00.987

我可能误解了您的担忧，但我认为这不是问题。您的用户管理方法将是 on `Company`， not `Companies`，这通常是可接受的模式。

让我们假设您有四个类：`Companies`/`Company`和`Users`/ `User`。现在我们可以定义一个方法：

```
@interface Companies
- (Company *)companyWithID:(NSUInteger)id;
@end 
```

这表示`Companies`该类可以`Company`通过其 ID 将您返回。（旁注：在 Objective-C 中，我们很少使用`get...`访问器方法的前缀 - 在这种情况下，只需使用您想要的东西开始方法`company...`。）

从这里开始的传统做法是让您的`Company`类公开大量公共 API 来管理用户。您可能会执行以下操作：

```
@interface Company
- (void)addUserWithName:(NSString *)name;
@end 
```

反过来，`Company`该类将负责了解`Users`集合的内部工作原理，包括根据需要对其进行修改。考虑到这一点，您可以编写：

```
@implementation Company
- (void)addUserWithName:(NSString *)name {
    [self.users addObject:name]; // self.users is of type `Users *`
}
@end 
```

这样，您就可以避免向类的`.users`外部客户端公开`Company`- 您只需将`add...`消息转发。

您甚至可以进一步采用这种策略，并说`Users`集合类是一个实现细节，*永远*不需要向`Company`该类的客户公开。相反，您可以`Users`根据更标准的系统集合对象为您的集合提供访问器：

```
@interface Company
- (NSSet *)users;
- (void)addUserWithName:(NSString *)name;
- (void)removeUserWithName:(NSString *)name;
// and so on...
@end 
```

这种思维过程的绝对极端会导致你完全摆脱你的`Users`类，而只使用系统类来直接在你的`Company`类上管理用户集合。一方面，这将让 Xcode 推断和建议（通过自动完成）某些非常适合此模式的方法 - 请查看 Key-Value Coding Programming Guide 的[KVC 合规性](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/KeyValueCoding/Articles/Compliant.html)部分以了解此类方法。另一方面，您可能有更多的复杂性没有出现在您的问题中，因此`Users`您的用例可能需要该类。

# java - 800x480 的宽高比

> ID：13883497
> 
> 赞同：0
> 
> 时间：2012-12-14T17:26:26.543
> 
> 标签：java, android, graphics, andengine, game-center

我知道这对于平面设计师来说可能是一个非常简单的问题，但我似乎无法弄清楚。

我正在创建一个游戏，游戏相机的宽度和高度为 800x480。

那么，就我的纵横比而言，这意味着什么？图形应该如何设计？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:39:38.650

800x480 是 Android 设备上最常见的分辨率。您的纵横比将是：5:3（与 800:480 相同，只是以最简单的形式表示）。您的所有图形都应在大小为 800x480 的合成上创建，而不是在运行游戏时拉伸图形。

我建议您在编写 Android 游戏时也看看支持更多的手机屏幕。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:29:12.567

纵横比为 5:3，但我认为图形不必更改。此外，如果您正在开发一款安卓游戏，请考虑不同的手机屏幕尺寸。

# html - 为 html 创建离线搜索引擎

> ID：13883501
> 
> 赞同：3
> 
> 时间：2012-12-14T17:26:42.103
> 
> 标签：html, search-engine, offline

我正在非 Internet 连接的网络上为我的公司创建知识库网站。我根本不是网络开发人员，所以我使用基本的 css/html 代码来构建网页。我已经创建了必要的页面、主页、软件问题、网络问题和创建页面。

创建页面有一个表单，我们的任何系统管理员都可以在其中存放问题/解决方案并将其提交到知识库。

我正在寻找某种代码，允许我在网页上放置一个搜索引擎，以便系统管理员可以输入问题并在我们的知识库中搜索以找到问题（如果它之前发生并提交） .

该知识库还提供其他帮助，例如操作方法页面。EX：如何在 Windows 中创建帐户。

搜索引擎将在知识库目录中的所有页面中搜索关键字。对我来说似乎很简单。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:34:59.423

### 尝试[使用 FullProof](https://reyesr.github.io/fullproof/) *浏览器的 javascript 搜索引擎库*

从他们的[网站](https://reyesr.github.io/fullproof/)：

> **Fullproof**是一个 JavaScript 库，可在浏览器中提供高质量的全文搜索。
> 
> 如果您的 web 应用程序设计为离线工作，使用 HTML5 离线功能，或者因为您的应用程序在可能断开连接的移动设备上运行，这特别有意义。

### 特征：

*   可用的布尔和评分搜索引擎，具体取决于您的应用程序需要的搜索类型
*   自动 HTML5 存储检测和优雅降级，具有可配置的基于约束的功能系统。目前管理 WebSQL、IndexedDB 和 Memory 数据存储。
*   完整的 unicode 支持和规范化、变音符号删除、词干和语音算法（目前可用于英语和法语） 可配置且非常易于扩展的解析和令牌规范化系统
*   易于集成，零外部依赖，约 100k 缩小

### 截屏

[![](../Images/91f726e796201bfe45a4ff4e48bff950.png)](https://i.stack.imgur.com/eq0Yh.png)
[（来源：[github.com](http://reyesr.github.com/fullproof/img/sc-colors.png)）]

### 笔记

这为您提供了您想要的一切，但每次将内容放入 KB 时，您都需要不断更新数据库。

# jquery - 选择 Selectable 的元素时的奇怪行为

> ID：13883502
> 
> 赞同：0
> 
> 时间：2012-12-14T17:26:52.400
> 
> 标签：jquery, jquery-ui, selectable, jquery-ui-selectable

[小提琴](http://jsfiddle.net/5NekR/5/)

在这个 Selectable 中，每个`<li>`都有一个嵌套的`<div>`.

```
<ol id="selectable">
    <li>
        <div>
            i love foo
        </div>
    </li>

    <li>
        <div>
            bar is awesome
        </div>
    </li>
</ol> 
```

现在，如果我**单击**或**ctrl 单击**一个元素，则`<li>`获取一个`ui-selected`类，但嵌套的 div 只是保持一个`ui-selectee`.

但是，如果我用**鼠标拖动单击**，那么 the`<li>`和 nested`<div>`都会获得`ui-selected`该类。

为什么这里有区别？它是一个错误还是只是我忽略的东西？

# objective-c - iOS 屏幕截图但不阻塞主线程

> ID：13883511
> 
> 赞同：2
> 
> 时间：2012-12-14T17:27:41.223
> 
> 标签：objective-c, ios, cocoa-touch, uikit, quartz-2d

苹果在这里提供了一个捕获屏幕的源代码：http: [//developer.apple.com/library/ios/#qa/qa1703/_index.html](http://developer.apple.com/library/ios/#qa/qa1703/_index.html)

但是，如果我不断地捕捉，UI 在渲染上下文时会变得非常慢。当我试图将它分派到不同的线程时，它会工作一段时间，但由于内存泄漏而崩溃。原因是它使用的一些 UIKit 调用不是线程安全的，只能在主线程中使用。

我正在寻找一种不同的方式来捕获屏幕而不使用 UIKIT 并使用纯 Quartz2d 代替。这是我所做的，但是当它捕获时，它会颠倒过来，图像并排翻倍，如果使用 iPAD 视网膜，图像在屏幕的 1/6 左右非常小：

```
CGSize imageSize = [[UIScreen mainScreen] bounds].size;
size_t bytesPerRow = imageSize.width * 5;

CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

CGContextRef context = CGBitmapContextCreate(buffer, imageSize.width, imageSize.height, 5, bytesPerRow, colorSpace,
                                             kCGImageAlphaNoneSkipFirst | kCGBitmapByteOrderDefault);

for (UIWindow *window in [[UIApplication sharedApplication] windows])
{
    // Render the layer hierarchy to the current context
    [[window layer] renderInContext:context];

}

CGContextRelease(context);
CGColorSpaceRelease(colorSpace); 
```

有谁知道如何创建具有正确比例和适当坐标转换的适当上下文？

或者我的代码有什么问题？

或者有没有更好的方法在主线程之外做到这一点？

谢谢

# .net - 如何使用 WebMatrix 的 Json Helper 创建自定义 JSON？

> ID：13883516
> 
> 赞同：1
> 
> 时间：2012-12-14T17:28:09.167
> 
> 标签：.net, json, code-first, webmatrix, helpers

到目前为止，我已经看到了 WebMatrix 的 Json Helper 的基本用法，例如在[这里](http://www.mikesdotnetting.com/Article/160/WebMatrix-Working-With-The-JSON-Helper)和[这里](http://msdn.microsoft.com/en-us/library/system.web.helpers.json%28v=vs.111%29.aspx)。这些示例显示了如何将 List 直接转换为简单的 JSON，但我想知道如何创建更自定义的 JSON。

我要说的是，这些示例将 List 编码为如下所示的 JSON：

```
[
  {obj1_property1 : obj1_value1,...}, 
  {obj2_property1 : obj2_value1,...}, 
  ...., 
  {objN_property1 : objN_value1,...}
] 
```

我要创建的内容如下：

```
{
  customProperty1 : customPropertyValue1, 
  customProperty2 : customPropertyValue2, 
  entries : [
    {obj1_property1 : obj1_value1,...}, 
    {obj2_property1 : obj2_value1,...}, 
    ...., 
    {objN_property1 : objN_value1,...}
  ]
} 
```

如何使用 Json Helper 创建这种 JSON？还是我需要使用其他东西？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T13:18:53.163

如果您没有找到更好的方法，那么设置一个独立的剃须刀页面 .cshtml 非常容易，如下所示。然后 URL 直接返回一个 JSON 字符串。

```
@{
    // write whatever C# code is necessary to get object data
    ...
}

{
    "customProperty1":"@cp1",
    "customProperty2":"@cp2",
    ...
} 
```

# c++ - Qt：在 QTreeView 中以自定义方式显示文件系统

> ID：13883518
> 
> 赞同：1
> 
> 时间：2012-12-14T17:28:21.307
> 
> 标签：c++, qt, qt4, filesystems

我正在开发 Qt 应用程序，我需要在`Qtreeview`. 基本上我的想法是自定义文件系统，使可移动驱动器属于一个部分，而本地驱动器属于另一个部分。我尝试使用它来实现它，`QFSFileEngine`但在某种程度上我已经成功了。这是代码：

```
pSystemSecondaryModel = new QFileSystemModel(this);
pSystemSecondaryModel->setRootPath(QDir::currentPath());

list = QFSFileEngine::drives();
for(int i = 0; i < list.size(); i++)
{
    qDebug() << list.at(i).absoluteDir();
}

m_model = new QStandardItemModel(0,0);

QList<QStandardItem *> LocalItem;
LocalItem.insert(0,new QStandardItem("Local Drives"));
LocalItem.at(0)->setEditable(false);
m_model->insertRow(0,LocalItem);

QList<QStandardItem *> RemovableItem;
RemovableItem.insert(0,new QStandardItem("Removable Drives"));
RemovableItem.at(0)->setEditable(false);
m_model->insertRow(1,RemovableItem);

for (int i = 0; i < list.count(); i++)
{
    QString str = list.at(i).absolutePath();
    Localchild = new QStandardItem(str);
    QStandardItem* LocalparentItem = m_model->item(0,0);
    Localchild->setEditable(false);
    LocalparentItem->appendRow(Localchild);
}

QStandardItem* Removablechild = new QStandardItem();
QStandardItem* RemovableparentItem = m_model->item(1,0);
Removablechild->setEditable(false);
RemovableparentItem->appendRow(Removablechild);
ui->PrimTreeView->setModel(m_model); 
```

当我运行该应用程序时，它显示本地驱动器和可移动驱动器根节点。在本地驱动器节点下，我发现所有 C:D:E: 等都是子驱动器，而可移动驱动器似乎是空的，即没有任何子驱动器。这是当前输出的场景：

```
- Local Drives
   C:/
   D:/
   E:/

- Removable Drives 
```

但是当我点击每个驱动器时，我根本看不到子目录。`Windows`理想情况下，当我单击 C:/ 时，我应该能够看到`Program Files`文件夹等。它完全是空的。我怎样才能实现它？请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:55:47.403

您可能知道，您根本没有使用您`QFileSystemModel`的，只是`QStandardItemModel`用您查找的手动条目填充 a 。

如果您的目标是呈现文件系统列表的自定义分组，您可能会尝试使用多个 `QFileSystemModel`实例，并为每个驱动器设置根。因此，您将继续设置顶级驱动器，但对于每个驱动器，您可能需要将模型设置为该根。然后在这些项目和它们的私有模型之间创建一个映射。

然后，您可能必须重新实现 index、hasChildren、rowCount、columnCount 以及其他一些只读方法，以检查这些驱动器的模型。因此，例如，如果模型需要知道是否`C:/`有子模型，则您`hasChildren()`必须查找该索引到隐藏`C:/`根模型的映射，并对该模型进行子计数。

另一种方法是子类化`QStandardItemModel`（或`QAbstractItemModel`）并自己做文件系统列表，而不是使用`QFileSystemModel`. 这将允许您只设置固定的根项目，即类别和驱动器号，然后在列表展开或折叠时检查它们。同样，这将需要对模型进行子类化，这并不总是 Qt 初学者的良好体验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T23:38:03.863

如果我误解了你的问题，请原谅我，但我认为你正在寻找类似的[东西](https://www.youtube.com/watch?v=92biLZST6Vg&list=SP2D1942A4688E9D63&index=49)

# sql - 使用链接表连接到数据库

> ID：13883519
> 
> 赞同：3
> 
> 时间：2012-12-14T17:28:22.823
> 
> 标签：sql, sql-server, ms-access

我想使用 Access 连接到 SQL Server，例如链接表。但是，数据库保存在共享驱动器上的共享文件夹中。当我创建数据源时，它是特定于机器的，因此其他机器上的用户无法访问它。

有没有一种方法可以使用连接字符串从 SQL Server 连接表，就像使用传递查询一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:44:00.070

首次创建到 SQL Server 的 ODBC 链接时，您可以使用 DSN。然后稍后更改`.Connect`链接的属性`TableDef`以使用无 DSN 连接。（有关详细信息，请参阅[使用无 DSN 连接](http://www.accessmvp.com/djsteele/DSNLessLinks.html)。）

下面是一个工作 ODBC 链接到不依赖于 DSN 的 SQL Server 的示例。请注意，该`.Connect`属性是单个文本字符串，我将该字符串拆分为分号以使其更易于阅读。

```
? Replace(CurrentDb.TableDefs("dbo_tblFoo").Connect, ";", ";" & vbCrLf)
ODBC;
DRIVER=SQL Server;
SERVER=HP64\SQLEXPRESS;
Trusted_Connection=Yes;
APP=2007 Microsoft Office system;
DATABASE=testbed 
```

或者，您可以使用[DoCmd.TransferDatabase 方法](http://msdn.microsoft.com/en-us/library/office/ff196455.aspx)和无 DSN 连接字符串来创建链接。

无论哪种方式，您的用户都不需要 DSN 来使用这些链接表。

# qgis - 如何使用带有 QGIS 的插件生成器创建 make 文件？

> ID：13883521
> 
> 赞同：2
> 
> 时间：2012-12-14T15:36:50.657
> 
> 标签：qgis, plugins, windows-7

我正在使用插件“plugin builder”来生成模板。插件生成器也在生成一个`make`文件。我正在使用 Windows 7 的计算机上工作，并尝试`make`使用 Windows (MS Dos) 的命令行执行该文件。但是，这不起作用。这意味着如果我理解正确，我`*.ui`和我的`*.qrc`文件不会编译为 python。

我能做些什么？我对电脑或编程不是很熟悉，所以我希望能找到一个能给我一个简单易懂的答案的人。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T16:01:55.647

在 osgeo4w Shell 中运行代码

并按照此处的步骤操作：

[http://www.qgisworkshop.org/html/workshop/plugins_tutorial.html](http://www.qgisworkshop.org/html/workshop/plugins_tutorial.html)

如果 osgeo4w shell 不起作用，请先将 qtcore4.dll 和 qtgui4.dll 复制到 windows 系统目录

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T11:52:56.300

“make”默认在 linux 中工作，因为它是其构建系统的一部分。对于 Windows，您可以尝试从以下链接下载 GNU Make Setup

[GNU 建立链接](http://gnuwin32.sourceforge.net/packages/make.htm)

之后，您应该能够从您的 dos 提示符运行“make”

# javascript - 当它还具有 runat="server" 时，如何使用 JavaScript 更改 html值属性

> ID：13883527
> 
> 赞同：1
> 
> 时间：2012-12-14T17:28:44.643
> 
> 标签：javascript, silverlight, dom

我正在使用 Silverlight 应用程序，当加载到浏览器中时，它会设置一个带有值的 html`<param>`标记（位于 silverlight`<object>`标记内）。稍后在执行 SL 应用程序期间，我需要更改 `<param>`标签。我试图通过简单地调用一个客户端javascript函数来实现这一点，该函数通过它的id获取param标签，然后调用objById.setAttribute(value,"my new value")。这就是奇怪的地方。根据将属性设置为新值后显示属性值的警报消息，以这种方式设置属性似乎有效。但是，当我在关闭警报对话框后在浏览器上查看源代码时，我仍然会在网页源代码中看到旧值。知道为什么源视图不会显示新值吗？param 标记确实有一个`runat="server"`属性，因为它最初是由 Silverlight 应用程序在加载时设置的。runat=server 属性在这里会导致问题吗？

HTML：

```
<div id="silverlightControlHost">
  <object id="silverlightObject" data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="100%" height="100%">
    <param .../>
    <param .../>
    <param .../>
    <param name="initParams" id="Ip" runat="server" />
    ... 
```

Javascript：

```
function refreshInitParams(newParams) {
  var slObjIp = document.getElementById("Ip");

  //Display Initial Value
  alert(slObjIp.getAttribute("value").toString());
  //Set New Value
  slObjIp.setAttribute("value", "New Value");
  //Display new value
  alert(slObjIp.getAttribute("value").toString());
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:38:13.137

解析 HTML 时，浏览器会根据原始文本构建[文档对象模型](http://en.wikipedia.org/wiki/Document_Object_Model)(DOM)。这有点类似于*编译*计算机程序，因为它以浏览器可以快速找到所需信息并使整体浏览器体验流畅的方式组织信息。例如，如果您调用`document.getElementById()`，浏览器不会再次重新解析所有 HTML，它只会查找相关元素的 ID 索引（可能是哈希表）。

出于这个原因，当您*更新*DOM 元素时，`setAttribute`在您的情况下，浏览器只更新 DOM。没有理由重新生成构建 DOM 的 HTML；这将毫无意义，并造成不必要的开支。因此，如果您查看浏览器源代码，您将不会看到任何反映的 DOM 更改。您只会看到最初来自服务器的源。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:32:48.333

我假设您在 IE 中使用“查看源代码”。
页面的来源在加载后不会改变。在查看源代码时，即使通过 javascript 更改页面上的文本也不会显示。

如果您希望即时查看源代码更改，请在其他浏览器（例如 Chrome）中使用 Inspect Element。它将向您显示通过脚本所做的任何更改。

# vb.net - 等效对象的字典不起作用，还是我做错了什么？

> ID：13883529
> 
> 赞同：1
> 
> 时间：2012-12-14T17:28:51.217
> 
> 标签：vb.net

假设我有一堂课

```
Public Class Person
Public Name As String
Public Rank As String
End Class 
```

然后我有一本字典，它使用这些类作为键。我有两个 Person 对象，每个对象在 Name 和 Rank 中都有相同的字符串值，但我发现它们没有被视为相同的键。字典不能这样用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:38:11.537

默认情况下，字典不知道如何比较您的用户制作的类。它不*只是*比较类中的所有字段。如[Dictionary<TKey,TValue> 的备注部分](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)所述：

> 如果类型 TKey 实现 System.IEquatable 泛型接口，则默认相等比较器使用该实现。

您的 person 类必须实现`IEquatable<T>`接口，该接口由一个`Equals(Person)`方法组成，如果两个实例应该被视为相等，该方法将返回 true。此外，如[IEquatable<T> 的备注中所述](http://msdn.microsoft.com/en-us/library/ms131187.aspx)：

> 如果您实现了 IEquatable，您还应该重写 和 的基类实现，`Object.Equals(Object)`以便`GetHashCode`它们的行为与`IEquatable<T>.Equals`方法的行为一致。

# django - 使用 Django 1.5 进行身份验证

> ID：13883539
> 
> 赞同：5
> 
> 时间：2012-12-14T17:29:46.347
> 
> 标签：django

我目前正在测试 django 1.5 及其自定义 USer 模型，但我有一些理解问题，我在我的帐户应用程序中创建了一个 User 类，它看起来像：

```
class User(AbstractBaseUser):
    email = models.EmailField()
    activation_key = models.CharField(max_length=255)
    is_active = models.BooleanField(default=False)
    is_admin = models.BooleanField(default=False)

    USERNAME_FIELD = 'email' 
```

我可以正确注册一个用户，该用户存储在我的 account_user 表中。现在，我该如何登录？我试过了

```
def login(request):
    form = AuthenticationForm()
    if request.method == 'POST':
        form = AuthenticationForm(request.POST)
        email =  request.POST['username']
        password = request.POST['password'] 
        user = authenticate(username=email, password=password)
        if user is not None:
            if user.is_active:
                login(user)
            else:
                message = 'disabled account, check validation email'
                return render(
                        request, 
                        'account-login-failed.html', 
                        {'message': message}
                )
    return render(request, 'account-login.html', {'form': form}) 
```

但是用户是 None 它呈现登录表单:(为什么我的 autheticate 返回我 None ？知道吗？

表格.py

```
class RegisterForm(forms.ModelForm):
    """ a form to create user"""
    password = forms.CharField(
            label="Password",
            widget=forms.PasswordInput()
    )
    password_confirm = forms.CharField(
            label="Password Repeat",
            widget=forms.PasswordInput()
    )
    class Meta:
        model = User
        exclude = ('last_login', 'activation_key')

    def clean_password_confirm(self):
        password = self.cleaned_data.get("password")
        password_confirm = self.cleaned_data.get("password_confirm")
        if password and password_confirm and password != password_confirm:
            raise forms.ValidationError("Password don't math")
        return password_confirm

    def clean_email(self):
        if User.objects.filter(email__iexact=self.cleaned_data.get("email")):
            raise forms.ValidationError("email already exists")
        return self.cleaned_data['email']

    def save(self):
        user = super(RegisterForm, self).save(commit=False)
        user.password = self.cleaned_data['password']
        user.activation_key = generate_sha1(user.email)
        user.save()

        return user 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-15T17:38:42.477

Django[文档](https://docs.djangoproject.com/en/1.5/topics/auth/#customizing-the-user-model)有一个使用新自定义用户的非常好的示例。

从您的代码中，我看到唯一缺少的是自定义身份验证后端。

我有一个名为 auth.py 的文件。方法“authenticate”和“get_user”是必需的。

```
from models import User as CustomUser

class CustomAuth(object):

    def authenticate(self, username=None, password=None):
        try:
            user = CustomUser.objects.get(email=username)
            if user.check_password(password):
                return user
        except CustomUser.DoesNotExist:
            return None

    def get_user(self, user_id):
        try:
            user = CustomUser.objects.get(pk=user_id)
            if user.is_active:
                return user
            return None
        except CustomUser.DoesNotExist:
            return None 
```

然后必须在您的设置文件中指定身份验证后端

```
AUTHENTICATION_BACKENDS = ('apps.accounts.auth.CustomAuth') 
```

# intellij-idea - IDEA数据库添加

> ID：13883541
> 
> 赞同：1
> 
> 时间：2012-12-14T17:29:46.963
> 
> 标签：intellij-idea

为什么我没有像屏幕截图那样添加数据库的按钮？所有插件都已启用。

![在此处输入图像描述](../Images/a8c38f6ab34f7f221a8044bc14abc7f9.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T23:18:47.447

这是 IDEA 12.0 版本中的一个[已知错误](http://youtrack.jetbrains.com/issue/IDEA-88255)。它将在下一次更新中修复。现在，您可以在`Database`工具窗口内右键单击并从上下文菜单中添加数据源。

![添加](../Images/6bf414f5eb255e887c38c7ca53f60e32.png)

# python - 具有字典理解的“分组依据”聚合函数

> ID：13883549
> 
> 赞同：2
> 
> 时间：2012-12-14T17:30:25.667
> 
> 标签：python, list-comprehension

我有一系列对（名称，分数），具有重复的名称。我想获得每个名字的最高分。名称标签本身对于最终结果是可选的。这是一个有效的实现：

```
from collections import defaultdict
scores = (('eyal', 76), ('alex', 50), ('oded', 90), ('eyal', 100), ('alex', 99))
distinct = defaultdict(set)
for score in scores:
    distinct[score[0]].add(score[1])
max_scores = [max(distinct[k]) for k in distinct]
print (max_scores) 
```

我想知道，这可以使用字典理解一步完成吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T17:34:21.840

```
In [22]: dict(sorted(scores))
Out[22]: {'alex': 99, 'eyal': 100, 'oded': 90} 
```

这是基于观察到的，一旦我们对元组进行排序，我们只想保留每个名称的**最后一个**`dict()`元组，并且做得很好。

或者，

```
In [16]: [max(vals) for _,vals in itertools.groupby(sorted(scores), lambda x:x[0])]
Out[16]: [('alex', 99), ('eyal', 100), ('oded', 90)] 
```

这更冗长，但也更笼统。例如，它可以很容易地适应计算*平均*分数，而第一个解决方案不能。

# c - he->h_addr_list[0] 总是默认接口吗？

> ID：13883552
> 
> 赞同：2
> 
> 时间：2012-12-14T17:30:31.713
> 
> 标签：c, networking, network-programming

在 gethostbyname 调用中，将 gethostname 的结果传递给它。我得到一个指向 hostent 结构的指针。如果 localhost 有多个接口，那么该主机发送多播时使用的默认接口是零索引吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:42:21.410

不，没有特定的结果排序。它们甚至不一定对应于同一台机器的接口；它们可能是许多单独的机器，为 dns 名称提供循环服务。

# javascript - script type="text/html" 的现代用途是什么？这个例子被认为是好的用途吗？

> ID：13883553
> 
> 赞同：35
> 
> 时间：2012-12-14T17:30:37.343
> 
> 标签：javascript, css, html, templates

是不是...

```
<script type="text/html" id="this-content1">
<h1>This Header Info One</h1>
<p>This content one. . .</p>
</script>
<script type="text/html" id="this-content2">
<h1>This Header Info Two</h1>
<p>This content two. . .</p>
</script> 
```

...并使用 jQuery 根据当今标准中的选择器良好实践来交换内容？

我刚刚开始使用**script type="text/html"...**来允许动态更改我的内容，并且正在寻找很多方法来做到这一点。是否有来源可以解释这种情况的发展方向以及这种做法是否有任何标准化。

我看到类似的代码...

```
<div class="thumbnail">
            <# if ( data.uploading ) { #>
                <div class="media-progress-bar"><div></div></div>
            <# } else if ( 'image' === data.type ) { #>
                <img src="{{ data.size.url }}" draggable="false" />
            <# } else { #>
                <img src="{{ data.icon }}" class="icon" draggable="false" />
            <# } #>
        </div> 
```

...嵌套在脚本 type="text/html" 标记中，真的不知道为什么要这样写。也刚刚在骨干上弄湿了我的喙，如果只是想在一页中添加内容交换，这看起来有点沉重。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-14T21:11:01.600

根据[script 标签的 HTML5 规范，](http://www.w3.org/TR/html5/the-script-element.html#the-script-element)与设置为任何有效 MIME 类型`<script>`的属性一起使用是完全可以的。`type`这包括 MIME 类型，如`text/html`or `text/plain`。

根据[script 标签的 HTML4 规范](http://www.w3.org/TR/html4/interact/scripts.html)，它不太好：

> “作者可以将两种类型的脚本附加到 HTML 文档：那些在加载文档时执行一次 [和 t] 每次特定事件发生时执行的软管”

您不需要骨干模板。您可以使用例如 jQuery 或我个人最喜欢的[Mustache.js](http://mustache.github.com)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T21:14:42.497

我假设您想保存一部分 HTML 以供以后使用。将非脚本数据放在脚本标签中是没有意义的。做 Facebook 做的事！

```
<code class="hide" id="code1"><!--
  <p>My HTML here</p>
  <script>My Javascript here</script>
--></code> 
```

然后你可以稍后获取 HTML 并在以后做任何你想做的事情：

```
var html = document.querySelector('#code1').innerText.slice(5, -5) 
```

在您正确处理它们之前，不会执行里面的脚本。

一些注意事项：

*   不知道 innerText 和其他文本函数之间的区别是什么
*   我认为您不能只将脚本标签插入 DOM。不知道 jQuery 是如何做到的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-18T20:41:37.050

***这只是为了通过一些服务器端渲染将数据直接嵌入到 HTML***

根据 Mozilla - 您还可以通过在 type 属性中指定有效的非 JavaScript MIME 类型，使用该属性将数据嵌入到带有服务器端呈现的 HTML 中。 [https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script)

例子 ：

```
<!-- Generated by the server -->
<script id="data" type="application/json">{"userId":1234,"userName":"John Doe","memberSince":"2000-01-01T00:00:00.000Z"}</script>

<!-- Static -->
<script>
  const userInfo = JSON.parse(document.getElementById("data").text);
  console.log("User information: %o", userInfo);
</script> 
```

# javascript - JSON日期转换为时间字符串

> ID：13883561
> 
> 赞同：0
> 
> 时间：2012-12-14T17:31:17.053
> 
> 标签：javascript, datetime

遇到一个我无法理解的 JavaScript 日期异常。

我有一个通过 WebAPI 返回的日期/时间：'2012-12-13T12:17:06.080'。这是当地时间（-7 UTC）。

通过 JavaScript 运行此日期时

```
var d = new Date('2012-12-14T05:32:05.543');
alert(d.toTimeString()); 
```

返回**22:32:05 MST**

然后做

```
var d = new Date('2012-12-14T05:32:05.543');
alert(d.toLocaleTimeString()); 
```

**晚上 10:32:05**返回

 **每个 JavaScript 文档的 toTimeString/toLocaleTimeString() 说它应该只提取时间部分，那么为什么时间会改变？我应该怎么做才能让它返回正确的时间部分**05:32:05**而不会创建所谓的不需要的函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:34:00.213

当您给`Date()`构造函数一个 ISO8601 时间戳字符串时，它*总是*将其解释为 UTC。

并非所有浏览器的行为方式都相同，有些浏览器根本不喜欢这些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:22:54.043

这是解决您的问题的方法：

> 获取日期的部分并手动构造日期对象。

我附上了一个展示[http://jsbin.com/iduzaz/3/watch的 JSBin](http://jsbin.com/iduzaz/3/watch)**

# routing - cakephp $this->redirect 在子域内不起作用

> ID：13883562
> 
> 赞同：0
> 
> 时间：2012-12-14T17:31:22.557
> 
> 标签：routing, cakephp-1.3, cakephp-2.0

我正在尝试从

```
sub.domain.com/login 
```

到位置

```
sub.domain.com/dashboard 
```

在 cake php 中使用`$this->redirect()`但我被重定向回

```
sub.domain.com/login 
```

请帮忙

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T09:26:42.117

Have you ever considered the possibility that you are not logged in?!

I will first need to authenticate with the server and then go to `/dashboard`. The sub-domain has nothing to do with this.

# flash - Flash Crossdomain.xml 安全性

> ID：13883568
> 
> 赞同：1
> 
> 时间：2012-12-14T17:31:52.943
> 
> 标签：flash, security, crossdomain.xml

如何从 crossdomain.xml 文件中隐藏 IP 地址并授予对所有客户端 IP 的访问权限以从 Web 服务器应用程序访问服务器数据。

这是一个例子

以下是客户端IP 121.171.1.181 121.171.1.182 121.171.1.183 121.171.1.184

以上所有客户端都安装了 demo.swf，其中包含以下 url *http://www.test.com/data.txt*文件以获取要在 demo.swf 文件中使用的数据

注意：（我在生产场景中有100个客户端IP）

Web 服务器*www.test.com*和以下 crossdomain.xml 位于根目录

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd">  
<cross-domain-policy>
    <allow-access-from domain="121.171.1.181" secure="false" to-ports="80" />
    <allow-access-from domain="121.171.1.182" secure="false" to-ports="80" />
    <allow-access-from domain="121.171.1.183" secure="false" to-ports="80"  />
    <allow-access-from domain="121.171.1.184" secure="false" to-ports="80"  />
        <allow-http-request-headers-from domain="121.171.1.181" headers="*"  secure="false"/>
        <allow-http-request-headers-from domain="121.171.1.182" headers="*" secure="false" />
        <allow-http-request-headers-from domain="121.171.1.183" headers="*" secure="false" />
        <allow-http-request-headers-from domain="121.171.1.184" headers="*" secure="false" />
</cross-domain-policy> 
```

问题：安全扫描软件扫描显示 crossdomain.xml 文件中标识的内部 IP 地址。

如何在 crossdomain.xml 文件中隐藏 IP 地址并允许所有客户端访问*http://www.test.com/data.txt*文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:09:03.003

所以，我不太确定为什么您的安全扫描软件*会关心*该文件中的 IP 地址，但我会假设它确实如此，并尝试给您一个可能的答案。

不必使用 IP 地址的一种方法是创建 DNS 记录作为标识符，而不是使用 IP 地址。DNS 在生活中的目的是让您输入诸如“www.microsoft.com”而不是“65.55.57.27”之类的内容。

因此，如果您有权访问 DNS 服务器，理论上您可以将 DNS 地址分配给那些讨厌的 IP 地址，然后将 DNS 名称而不是 IP 地址放入文件中。

因此，如果您将 DNS 设置为映射：

```
 121.171.1.181 to node1.mydomain.com
 121.171.1.182 to node2.mydomain.com 
```

等等...然后您的 XML 可能如下所示：

```
<?xml version="1.0"?>
 <!DOCTYPE cross-domain-policy SYSTEM "http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd">  
 <cross-domain-policy>
     <allow-access-from domain="node1.mydomain.com" secure="false" to-ports="80" />
     <allow-access-from domain="node2.mydomain.com" secure="false" to-ports="80" />
     <allow-access-from domain="node3.mydomain.com" secure="false" to-ports="80"  />
     <allow-access-from domain="node4.mydomain.com" secure="false" to-ports="80"  />
         <allow-http-request-headers-from domain="node1.mydomain.com" headers="*"  secure="false"/>
         <allow-http-request-headers-from domain="node2.mydomain.com" headers="*" secure="false" />
         <allow-http-request-headers-from domain="node3.mydomain.com" headers="*" secure="false" />
         <allow-http-request-headers-from domain="node4.mydomain.com" headers="*" secure="false" />
 </cross-domain-policy> 
```

祝你好运，亚当霍夫曼

[http://www.stratospher.es](http://www.stratospher.es) - 我的 Windows Azure 博客 @stratospher_es - Twittererer

# data-binding - Kendo UI 网格可以绑定到 JSON 序列化的 Microsoft.NET System.Data.DataTable

> ID：13883570
> 
> 赞同：0
> 
> 时间：2012-12-14T17:31:59.867
> 
> 标签：data-binding, kendo-ui

Kendo UI 网格可以直接绑定到 JSON 序列化的 Microsoft.NET System.Data.DataTable 吗？当序列化为 JSON 时，System.Data.DataTable 成为一个对象数组，每个对象中都有重复的字段名：

```
 [{"name":"joe", "age":40},
      {"name":"pam", "age":33}] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:41:17.810

是的。Kendo UI 网格可以绑定到任何具有“记录”数组的 JSON 对象。例如：

```
$("#grid").kendoGrid({
   dataSource: [
      {"name":"joe", "age":40},
      {"name":"pam", "age":33}
   ]      
}); 
```

这是一个现场演示：http: [//jsbin.com/edokun/1/edit](http://jsbin.com/edokun/1/edit)

# ios - 自动布局中断 UIView 动画

> ID：13883571
> 
> 赞同：7
> 
> 时间：2012-12-14T17:32:04.620
> 
> 标签：ios, uiviewanimation, autolayout, cgpoint

努力让我的应用程序同时在 iPhone 5 和较小的 iPhone 上运行。很高兴需要 iOS6 并使用 Autolayout，因为这很好用。

但是，该应用程序有 4 个按钮会定期交换位置，因此我为每个按钮分配了与数组不同的位置，然后使用以下内容为移动设置动画：

```
[UIView animateWithDuration:0.5 animations:^{
    button1.center = [[locations objectAtIndex:0] CGPointValue];
    button2.center = [[locations objectAtIndex:1] CGPointValue];
    button3.center = [[locations objectAtIndex:2] CGPointValue];
    button4.center = [[locations objectAtIndex:3] CGPointValue];
}]; 
```

这不适用于自动布局。没有什么变化。我得到的最好的结果是它会动画到一个位置然后立即弹回。

但是，当我删除 Autolayout 时，所有按钮都在较小的 iPhone 上被挤压，并且因为我使用的是由 iPhone 5 尺寸设置的点，所以它们最终会降低，将底行从屏幕上移开。我最初从 Interface Builder 获得了不同的 CGPoint 数字，但它们是“错误的”，尽管我认为它们是“错误的”，因为它们是 Autolayout 使用的数字。该数组只是为了让您可以看到：

```
buttonLocations = [NSArray arrayWithObjects:
        [NSValue valueWithCGPoint:CGPointMake(57, 523)],
        [NSValue valueWithCGPoint:CGPointMake(109, 523)],
        [NSValue valueWithCGPoint:CGPointMake(57, 471)],
        [NSValue valueWithCGPoint:CGPointMake(109, 471)],
        nil]; 
```

我应该怎么做才能解决这个问题？为每个尺寸的设备设置不同的点似乎不是很有效。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-06-06T23:28:37.507

解决方案是动画项目变换属性，而不是它的位置。

该位置将由自动布局设置，您不想与之抗争。然而，屏幕上的实际位置将是它的“正确”（由自动布局设置）位置，由它的 transform 属性偏移。

所以你可以说 button.transform = CGTransformMake(x,y) 它会出现 x 和 y 偏离它的中心位置。

有多种 CGWhatever 宏可以轻松进行这些转换，您只需在动画块中更改它们即可移动项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T18:03:33.547

一种方法是使用自动布局系统，并为约束的“常量”值设置动画。在下面的示例代码中，我在水平行中有三个按钮，每个按钮都有一个对超级视图的前沿约束，这就是我制作的动画。side1、side2 和 side3 是这些约束的 IBOutlets，而 button1、button2 和 button3 是 3 个按钮的出口。

```
-(void)animateButton {
    [self.view removeConstraint:self.side1];
    [self.view removeConstraint:self.side2];
    [self.view removeConstraint:self.side3];

    NSLayoutConstraint *con1 = [NSLayoutConstraint constraintWithItem:self.button1 attribute:NSLayoutAttributeLeading relatedBy:0 toItem:self.view attribute:NSLayoutAttributeLeading multiplier:1 constant:114];
    NSLayoutConstraint *con2 = [NSLayoutConstraint constraintWithItem:self.button2 attribute:NSLayoutAttributeLeading relatedBy:0 toItem:self.view attribute:NSLayoutAttributeLeading multiplier:1 constant:213];
    NSLayoutConstraint *con3 = [NSLayoutConstraint constraintWithItem:self.button3 attribute:NSLayoutAttributeLeading relatedBy:0 toItem:self.view attribute:NSLayoutAttributeLeading multiplier:1 constant:20];

    [self.view addConstraints:@[con1,con2,con3]];
    [UIView animateWithDuration:2 animations:^{
        [self.view layoutIfNeeded];
    }];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-15T21:37:24.293

您可以通过对代码进行很少的更改来解决此问题。与其交换按钮位置，不如交换它们的布局约束。您可以使用 cocoapod SBP 通过导入此类别来交换布局约束

```
 #import "UIViewController+SBP.h" 
```

然后用这个方法

```
 - (void)switchViewConst:(UIView*)firstView secondView:(UIView*)secondView durationInSeconds:(double)durationInSeconds 
```

[这是一个视频教程](https://www.youtube.com/watch?v=8KVKXlh6sKI)。

# javascript - 在 Ruby on Rails 中创建一个变量以在 Javascript 中使用

> ID：13883576
> 
> 赞同：1
> 
> 时间：2012-12-14T17:32:39.097
> 
> 标签：javascript, ruby-on-rails-3

> **可能重复：**
> [在 Javascript 中使用 Ruby 变量（在应用程序视图中）](https://stackoverflow.com/questions/13673227/using-ruby-variable-in-javascript-in-app-view)

有没有办法在 Ruby on Rails 视图中创建一种变量，以便稍后在 javascript 标记中使用它？

我想做这样的事情：

```
 <p>
    <%  test=Build.where("result = 1").count(:result) %> of the builds succeeded.
    </p>

<%= javascript_tag do %>

            console.log(test);

<% end %> 
```

有没有办法做到这一点？这是行不通的。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:49:10.400

如果可能的话，我会将逻辑移到控制器中，也可以看看 gon gem：[https ://github.com/gazay/gon](https://github.com/gazay/gon)

**编辑：**我读错了你的问题。

```
# Controller
@test = Build.where("result = 1").count(:result)

# View
<%= javascript_tag do %>

    console.log(<%= @test %>);

<% end %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T17:38:40.500

您可以使用 <%= %> 访问 erb 中的任何 ruby​​ 变量

既然您想将其显示为字符串，请执行

```
console.log('<%= Build.where("result = 1").count(:result) %>'); 
```

# google-app-engine - Bean不保存列表gae的状态

> ID：13883583
> 
> 赞同：0
> 
> 时间：2012-12-14T17:33:30.033
> 
> 标签：google-app-engine, jsf, primefaces, javabeans

当您按下命令按钮时，列表项目应从一个列表添加到另一个列表。第一次，它工作正常，项目移动，但第二次新的替换以前添加的，字符串字段工作正常。当它在本地运行时，它工作正常，但上传到 cloude 没有。

**豆**

```
@ManagedBean
@SessionScoped
public class SmsBean implements Serializable {

    private static final long serialVersionUID = 1L;

    private List<SelectItem> listOfDevices=new LinkedList<SelectItem>();
    private List<SelectItem> listOfSelectedDevices=new LinkedList<SelectItem>();
    private List<Device> toAdd=new LinkedList<Device>();
    private List<Device> toDelete=new LinkedList<Device>();

    public SmsBean(){
         List<Entity> entities = Datastore.getTotalDevices();
         if(entities!=null){
            for(Entity et :entities){
                Device device=new Device((String)et.getProperty(DEVICE_DEVICE_NAME_PROPERTY),(String)et.getProperty(DEVICE_MAIL_PROPERTY),(String)et.getProperty(DEVICE_REG_ID_PROPERTY));
                listOfDevices.add(new SelectItem(device));

            }
         }

    }

    public void addDevices(){
        int temp=0;
        for(Device dev:toAdd){
            for(int j=0;j<listOfDevices.size();j++){
                if(((Device)listOfDevices.get(j).getValue()).equals(dev)){
                    temp=j;
                    break;                  
                }
            }
            listOfSelectedDevices.add(listOfDevices.get(temp));
            listOfDevices.remove(temp);

        }
        toAdd.clear();
    }

    public void deleteDevices(){
        int temp=0;
        for(Device dev:toDelete){
            for(int j=0;j<listOfSelectedDevices.size();j++){
                if(((Device)listOfSelectedDevices.get(j).getValue()).equals(dev)){
                    temp=j;
                    break;      
                }
            }
            listOfDevices.add(listOfSelectedDevices.get(temp));
            listOfSelectedDevices.remove(temp);

        }
        toDelete.clear();
    }

} 
```

**看法**

```
 <h:panelGrid columns="4" style="height:100%">
                            <p:selectManyMenu style="height:230px;width:150px;"
                                id="selectedDevices" value="#{smsBean.toDelete}"
                                converter="deviceConverter">
                                <f:selectItems value="#{smsBean.listOfSelectedDevices}" />
                            </p:selectManyMenu>

                            <p:commandButton actionListener="#{smsBean.deleteDevices}"
                                icon="ui-icon ui-icon-circle-triangle-e" process="@form"
                                update="devices" title="Icon Only" />

                            <p:commandButton actionListener="#{smsBean.addDevices}"
                                process="@form" update="selectedDevices"
                                icon="ui-icon ui-icon-circle-triangle-w" title="Icon Only" />

                            <p:selectManyMenu id="devices" value="#{smsBean.toAdd}"
                                converter="deviceConverter" style="height:230px;width:150px;">
                                <f:selectItems value="#{smsBean.listOfDevices}" />
                            </p:selectManyMenu>

                        </h:panelGrid> 
```

# qt - (Qt) 一键点击后窗口不可用

> ID：13883588
> 
> 赞同：0
> 
> 时间：2012-12-14T17:33:54.597
> 
> 标签：qt, user-interface, button, opencv, click

我有一个带有许多按钮的窗口。每个触发一个子程序（使用 Opencv API 编写）。每个子程序在窗口上显示图像和内容。

问题是，当我关闭这些窗口（通过小红叉）时，所有按钮都变得无法点击。所以如果我想启动另一个程序，我将不得不退出主窗口并再次运行它。

换句话说，我希望能够运行所有的子程序，而不必每次都重新开始。

这是 GUI 的代码：

.cpp

```
#include "fenprincipale.h"
#include "ui_fenprincipale.h"
#include<highgui.h>
 #include<cv.h>
 #include <moyenetmedian.h>
#include<morpho.h>
#include<tracking.h>
#include<contour.h>
#include<QApplication>

FenPrincipale::FenPrincipale(QWidget *parent) :
QWidget(parent),
ui(new Ui::FenPrincipale)

{
ui->setupUi(this);
MoyenEtMedian *moyenEtMedian = new MoyenEtMedian;
morpho * mor = new morpho;
tracking * tra= new tracking;
contour * cont= new contour;

QObject::connect(ui->bMoyMed, SIGNAL( clicked() ), moyenEtMedian, SLOT( exec() ),    Qt::AutoConnection );
QObject::connect(ui->bMorph, SIGNAL( clicked() ), mor, SLOT( exec() ), Qt::AutoConnection );
QObject::connect(ui->bTrack, SIGNAL( clicked() ), tra, SLOT( exec() ), Qt::AutoConnection );
QObject::connect(ui->bCont, SIGNAL( clicked() ), cont, SLOT( exec() ), Qt::AutoConnection );

}

 FenPrincipale::~FenPrincipale()
{
 delete ui;
} 
```

。H ：

```
 #ifndef FENPRINCIPALE_H
  #define FENPRINCIPALE_H

    #include <QWidget>
    #include <QApplication>

    namespace Ui {
    class FenPrincipale;
     }

    class FenPrincipale : public QWidget
   {
     Q_OBJECT

  public:
     explicit FenPrincipale(QWidget *parent = 0);
      void switch_callback(int);
      void execMoyMed (void);

  ~FenPrincipale();

 private:
   Ui::FenPrincipale *ui;
   };

    #endif // FENPRINCIPALE_H 
```

主要课程：

```
 #include <QCoreApplication>
  #include <QApplication>
  #include <QtGui>
   #include <QWidget>
   #include "fenprincipale.h"

    int main(int argc, char *argv[])
   {
        QApplication a(argc, argv);
        FenPrincipale fenetre;
        fenetre.show();
        return a.exec();

     } 
```

**“ moyenetmedian** ”的插槽实现：

```
 void MoyenEtMedian::exec(void)
{
    const char* name = "Filtres";
    IplImage* img = cvLoadImage( "C:/Users/XELTINFO/ProjetVision/image.png" );
    IplImage* out = cvCreateImage( cvGetSize(img), IPL_DEPTH_8U, 3 );
    cvNamedWindow( name, 1 );
    cvShowImage(name, out);

    // Create trackbar
    cvCreateTrackbar2( "Filtre", name, &g_switch_value, 1,  &MoyenEtMedian::switch_callback, this );

    while( 1 ) {
        switch( filterInt ){
            case 0:
                cvSmooth( img, out, CV_BLUR, 7, 7 );
                break;
            case 1:
                cvSmooth( img, out, CV_MEDIAN, 7, 7 );
                break;
                    }
        if(filterInt != lastfilterInt){
            cvShowImage(name, out);
            lastfilterInt = filterInt;
        }
        if( cvWaitKey( 15 ) == 27 )
            break;
    }

    cvReleaseImage( &img );
    cvReleaseImage( &out );
    cvDestroyWindow( name );

  } 
```

类声明：

```
 #ifndef MOYENETMEDIAN_H
   #define MOYENETMEDIAN_H
   #include "ui_fenprincipale.h"
    #include<QObject>

     class MoyenEtMedian : public QObject
    {
   Q_OBJECT
public:
      MoyenEtMedian();
      static void switch_callback(int position, void*);

     public slots :
         void exec(void);

      };

   #endif // MOYENETMEDIAN_H 
```

所有类的类声明和插槽实现都非常相似。如果这还不够，我会添加其余的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T20:19:03.443

因此，当将 Qt 与 OpenCV 一起使用时，我会使用 Qt 的计时器而不是 while 循环来设置轮询。

这里有一个很好的使用 QTimers 与 OpenCV 对象交互的教程：

[http://www.youtube.com/watch?v=0ONxIy8itRA](http://www.youtube.com/watch?v=0ONxIy8itRA)

跳到 35 或 38 分钟，看看他是如何编写课程的。

基本上，您让 Qt 进行等待和计时，而不是使用带有等待调用的 while 循环进行计时。

如果可能，让 Qt 创建窗口，并将 OpenCV 窗口嵌套到 Qt 的窗口中，以便 Qt 可以管理窗口上的事件。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:54:22.560

您正在阻止 exec() 插槽中的事件循环，因为它不会立即返回。相反，您应该继承 QWidget 并覆盖 keyPressEvent() 以从 Qt 的事件循环中获取键盘输入，而不是执行您当前拥有的忙循环。

# android - Android 中的 ScrollView 问题中的 ListView

> ID：13883591
> 
> 赞同：0
> 
> 时间：2012-12-14T17:33:57.350
> 
> 标签：android, android-layout, android-listview, android-scrollview

这是我的 XML 布局。我的滚动视图中有一个列表视图。如果我将列表视图高度更改为 wrap_content 它不起作用，我将手动设置高度。而且，如果数据增长超出其隐藏的限制。我看到很多答案来解决这个问题。为我的情况解决它的最佳选择是什么？

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight="1"
    android:focusableInTouchMode="true" >

    <LinearLayout
        android:id="@+id/store_scroller"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical" >

        <RelativeLayout
            android:layout_width="match_parent"
            android:layout_height="45dp"
            android:background="#c6c6c6"
            android:padding="10dp" >

            <TextView
                android:id="@+id/textView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                layout_alignParentLeft="true"
                android:text="Stores"
                android:textSize="20dp" />

            <TextView
                android:id="@+id/merchant_count_textView"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentRight="true"
                android:text="0 Results" />
        </RelativeLayout>
        <Gallery
            android:id="@+id/gallery1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:drawSelectorOnTop="true"
            android:gravity="left"
            android:listSelector="@color/gridviewlistselector"
            android:paddingLeft="10dp"
            android:paddingRight="20dp"
            android:paddingTop="10dp"
            android:spacing="10dp" />

        <RelativeLayout
            android:layout_width="match_parent"
            android:layout_height="55dp"
            android:background="#c6c6c6"
            android:padding="10dp" >

            <TextView
                android:id="@+id/textView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                layout_alignParentLeft="true"
                android:text="Products"
                android:textSize="20dp" />

            <Spinner
                android:id="@+id/filter_spinner"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginLeft="40dp"
                android:layout_toRightOf="@+id/textView1" />

            <TextView
                android:id="@+id/product_count_textView"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentRight="true"
                android:text="0 Results" />
        </RelativeLayout>

        <ListView
            android:id="@+id/list"
            android:layout_width="fill_parent"
            android:layout_height="4800dp"
            android:layout_weight="1"
            android:drawSelectorOnTop="true"
            android:listSelector="@color/gridviewlistselector"
            android:orientation="vertical" />
    </LinearLayout>
</LinearLayout>

</ScrollView> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T17:39:06.383

简短的回答：您不能（不应该）将 a`ListView`包裹在`ScrollView`.

长答案：正如 Romain Guy（谷歌自己的 UI 专家）曾经说过的那样：

> 使用 ListView 使其不滚动非常昂贵，并且违背了 ListView 的全部目的。你不应该这样做。只需使用 LinearLayout 代替。

通过[“如何将 ListView 放入 ScrollView 而不折叠？”引用](https://stackoverflow.com/a/3496042/860212) .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-05T08:20:31.060

代替使用 ScrollView 中的列表视图，您可以制作单独的布局，您可以在其中定义所需的组件。然后你可以使 ListView 的布局变得更加复杂。您可以使用以下代码：

```
LayoutInflater inflater = LayoutInflater.from(this);
View LTop = inflater.inflate(R.layout.header_tolistview, null);
listview.addHeaderView(LTop); 
```

# algorithm - 将实数转换为部首

> ID：13883594
> 
> 赞同：7
> 
> 时间：2012-12-14T17:34:02.070
> 
> 标签：algorithm, math, language-agnostic

假设我有一个实数。对于整数 a 和 b，我想用 a+sqrt(b) 形式的东西来近似它。但我不知道 a 和 b 的值。当然，我更愿意得到一个小的 a 和 b 值的近似值。让我们暂时不定义“好”和“小”的含义。这些术语的任何合理定义都可以。

有没有一种理智的方法可以找到它们？类似于用于查找小数的分数逼近的连[分数算法。](http://en.wikipedia.org/wiki/Continued_fraction)有关分数问题的更多信息，请参见[此处](https://stackoverflow.com/questions/95727/how-to-convert-floats-to-human-readable-fractions)。

编辑：澄清一下，这是一个任意实数。我只有一堆数字。因此，根据我们想要的近似值的好坏，a 和 b 可能存在也可能不存在。蛮力自然不是特别好的算法。我能想到的最好的方法是开始将整数添加到我的实数中，对结果进行平方，然后查看我是否接近整数。几乎是蛮力，并不是一个特别好的算法。但是，如果没有更好的存在，这本身就会很有趣。

编辑：显然 b 必须为零或正数。但 a 可以是任何整数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-14T18:49:59.763

不需要连分数；只需计算所有“小”值的平方根`b`（直到您认为仍然“足够小”的任何值），删除小数点之前的所有内容，然后将它们全部排序/存储（连同`b`生成它的那个）。

然后，当您需要逼近一个实数时，找到其小数部分最接近实数小数部分的部首。这给了你`b`- 选择正确`a`的就是一个简单的减法问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-14T18:36:58.530

这实际上更像是一个数学问题，而不是一个计算机问题，但要回答这个问题，我认为你是对的，你可以使用连分数。你要做的是首先将目标数表示为连分数。例如，如果要近似 pi (3.14159265)，则 CF 为：

3: 7, 15, 1, 288, 1, 2, 1, 3, 1, 7, 4 ...

下一步是为平方根创建一个 CF 表，然后将表中的值与目标值的小数部分进行比较（此处为：7、15、1、288、1、2、1、3、1、 7、4...)。例如，假设您的表格只有 1-99 的平方根。然后你会发现最接近的匹配是 sqrt(51)，它的 CF 为 7: 7,14 重复。7,14 最接近 pi 的 7,15。因此，您的答案将是：

平方（51）-4

作为给定 ab < 100 的最接近的近似值，相差 0.00016。如果您允许更大的 b，那么您可以获得更好的近似值。

使用 CF 的优点是它比使用双精度数或使用浮点数更快。例如，在上述情况下，您只需比较两个整数（7 和 15），您还可以使用索引来快速找到表中最近的条目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T20:53:46.583

这可以使用[混合整数二次规划](http://en.wikipedia.org/wiki/Quadratic_programming)非常有效地完成（尽管没有运行时保证，因为 MIQP 是 NP 完全的。）

定义：

```
d := the real number you wish to approximate
b, a := two integers such that a + sqrt(b) is as "close" to d as possible
r := (d - a)^2 - b, is the residual of the approximation 
```

目标是最小化`r`。将您的二次程序设置为：

```
x := [ s b t ]
D := | 1 0 0 |
     | 0 0 0 |
     | 0 0 0 |
c := [0 -1 0]^T
with the constraint that s - t = f (where f is the fractional part of d) 
and b,t are integers (s is not) 
```

这是一个凸的（因此是最优解的）混合整数二次程序，因为`D`它是半正定的。

一旦`s,b,t`被计算，只需使用 , 得出答案`b=b`，`s=d-a`并且`t`可以忽略。

您的问题可能是 NP 完全的，如果是这样证明会很有趣。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-15T00:27:42.193

之前的一些答案使用时间或空间复杂度 O(n) 的方法，其中 n 是将被接受的最大“小数”。相比之下，以下方法在时间上是 O(sqrt(n))，在空间上是 O(1)。

假设正实数`r = x + y`，其中`x=floor(r)`和`0 ≤ y < 1`。我们想`r`通过一个数字来近似的形式`a + √b`。如果`x+y ≈ a+√b`then `x+y-a ≈ √b`，那么`√b ≈ h+y`对于一些整数偏移量`h`，并且`b ≈ (h+y)^2`。为了使 b 成为整数，我们希望最小化`(h+y)^2`所有符合条件的小数部分`h`。最多有 的`√n`合格值`h`。请参阅以下 python 代码和示例输出。

```
import math, random

def findb(y, rhi):
    bestb = loerror = 1;
    for r in range(2,rhi):
        v = (r+y)**2
        u = round(v)
        err = abs(v-u)
        if round(math.sqrt(u))**2 == u: continue
        if err < loerror:
            bestb, loerror = u, err
    return bestb

#random.seed(123456)     # set a seed if testing repetitively
f = [math.pi-3] + sorted([random.random() for i in range(24)])
print ('    frac     sqrt(b)       error       b')
for frac in f:                   
    b = findb(frac, 12)
    r = math.sqrt(b)
    t = math.modf(r)[0]         # Get fractional part of sqrt(b)
    print ('{:9.5f}  {:9.5f}  {:11.7f}  {:5.0f}'.format(frac, r, t-frac, b)) 
```

（注 1：此代码为演示形式；参数为`findb()`，`y`小数部分`r`，和`rhi`，最大小数的平方根。您可能希望更改参数的用法。注 2：代码行
`if round(math.sqrt(u))**2 == u: continue`
防止`findb()`返回 的完美平方值`b`，但值 b=1 除外，因为没有完美平方可以提高 b=1 提供的精度。）

示例输出如下。中间省略了大约十几行。第一个输出行显示此过程产生`b=51`表示 的小数部分`pi`，这与其他一些答案中报告的值相同。

```
 frac     sqrt(b)       error       b
  0.14159    7.14143   -0.0001642     51
  0.11975    4.12311    0.0033593     17
  0.12230    4.12311    0.0008085     17
  0.22150    9.21954   -0.0019586     85
  0.22681   11.22497   -0.0018377    126
  0.25946    2.23607   -0.0233893      5
  0.30024    5.29150   -0.0087362     28
  0.36772    8.36660   -0.0011170     70
  0.42452    8.42615    0.0016309     71
   ...
  0.93086    6.92820   -0.0026609     48
  0.94677    8.94427   -0.0024960     80
  0.96549   11.95826   -0.0072333    143
  0.97693   11.95826   -0.0186723    143 
```

在程序末尾添加以下代码后，还会出现如下所示的输出。这显示了 pi 小数部分的更接近的近似值。

```
frac, rhi = math.pi-3, 16
print ('    frac        sqrt(b)         error          b     bMax')
while rhi < 1000:
    b = findb(frac, rhi)
    r = math.sqrt(b)
    t = math.modf(r)[0]         # Get fractional part of sqrt(b)
    print ('{:11.7f}  {:11.7f}  {:13.9f}  {:7.0f}  {:7.0f}'.format(frac, r, t-frac, b,rhi**2))
    rhi = 3*rhi/2

    frac        sqrt(b)         error          b     bMax
  0.1415927    7.1414284   -0.000164225       51      256
  0.1415927    7.1414284   -0.000164225       51      576
  0.1415927    7.1414284   -0.000164225       51     1296
  0.1415927    7.1414284   -0.000164225       51     2916
  0.1415927    7.1414284   -0.000164225       51     6561
  0.1415927  120.1415831   -0.000009511    14434    14641
  0.1415927  120.1415831   -0.000009511    14434    32761
  0.1415927  233.1415879   -0.000004772    54355    73441
  0.1415927  346.1415895   -0.000003127   119814   164836
  0.1415927  572.1415909   -0.000001786   327346   370881
  0.1415927  911.1415916   -0.000001023   830179   833569 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-14T18:32:18.287

我不知道这种问题是否有任何标准算法，但它确实引起了我的兴趣，所以这是我尝试开发一种找到所需近似值的算法。

拨打有问题的真实号码`r`。然后，首先我假设它`a`可能是负数，在这种情况下，我们可以减少问题，现在只需要找到一个`b`使得 的小数部分`sqrt(b)`是 的小数部分的良好近似值`r`。现在让我们写成`r`整数和`r = x.y`小数部分。`x``y`

```
Now:
b = r^2
  = (x.y)^2
  = (x + .y)^2
  = x^2 + 2 * x * .y + .y^2
  = 2 * x * .y + .y^2 (mod 1) 
```

我们现在只需要（大约）找到一个`x`这样的。`0 = .y^2 + 2 * x * .y (mod 1)`

将其填充`x`到上面的公式中，我们得到`b`，然后可以计算`a`为`a = r - b`。（当然，所有这些计算都必须仔细四舍五入。）

现在，我暂时不确定是否有办法在`x`不强制使用的情况下找到它。但即便如此，人们也可以简单地使用一个简单的循环来找到一个`x`足够好的。

我正在考虑这样的事情（半伪代码）：

```
max_diff_low = 0.01 // arbitrary accuracy
max_diff_high = 1 - max_diff_low
y = r % 1
v = y^2
addend = 2 * y
x = 0
while (v < max_diff_high && v > max_diff_low)
    x++;
    v = (v + addend) % 1
c = (x + y) ^ 2
b = round(c)
a = round(r - c) 
```

现在，我认为这个算法相当有效，同时甚至允许您指定所希望的近似精度。可以将其变成 O(1) 算法的一件事是计算所有的`x`并将它们放入查找表中。如果只关心`r`（例如）的前三位十进制数字，则查找表将只有 1000 个值，即只有 4kb 的内存（假设使用 32 位整数）。

希望这完全有帮助。如果有人发现算法有任何问题，请在评论中告诉我，我会修复它。

**编辑：** 经过反思，我收回了我对效率的主张。事实上，据我所知，不能保证上述算法会终止，即使终止，也可能需要很长时间才能找到一个`x`可以充分解决方程的非常大的算法。

人们可能会跟踪`x`迄今为止发现的最佳算法，并随着时间的推移放宽准确度范围，以确保算法快速终止，但可能会以准确度为代价。

如果简单地预先计算一个查找表，这些问题当然是不存在的。

# mysql - 如何根据用户声誉计算输入的重要性/权重？

> ID：13883595
> 
> 赞同：0
> 
> 时间：2012-12-14T17:34:04.913
> 
> 标签：mysql, rdbms, weighted, weighted-average

我有几个系统，其中包含用户表以及某种形式的业力/重量/声誉。有时是用户发布的帖子数量，有时是用户在网站上的所有活动中收到的赞成/反对票数。

```
USER {
    id int
    name string
    karma int
} 
```

如何使用这些数字来计算该用户的“体重”或“权限”？例如，一位老会员的投票往往比新用户的 4 票更有价值。

我正在考虑将所有成员的总积分/业力/声誉相加，然后尝试得出 1-100 的比例。

```
SUM(user.points) / COUNT(user.*) = average user points 
```

然后像

```
CEIL(userA.points / average user points) = their weight on an issue 
```

但是，这种方式也需要有一条曲线，因为我不希望有 5,000 个帖子/业力的人超过 20 个新用户的投票。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T09:32:12.993

可能有一些资源可以为此提供参数，但您可能应该确切地决定您想要什么，而不是使用一些预定义的模型。我建议您定义一些规则，哪些用户集应该是等效的，或者哪些应该相互超过（例如 10 0 业力用户 = 1 5k 业力用户）（等效性更容易使用），这将很快为某些用户生成参数选择的方程。

使用对数（如前所述），一些（分数）幂（如平方根）甚至只是线性的都可以工作。

我建议类似`newKarma = a.karma^b + c`, 解决起来应该不难`a`,`b`和`c`. 我建议你选择`b`而不是试图计算它。使用新用户（karma = 0）应该很容易解决这个问题。猜测值以接近您想要的值可能比数学确定它们更容易（因为一些规则一起不适合任何简单的方程）。

请注意，`c`以上是对业力的抵消，这将使许多新用户比高业力用户更多的总业力。您可能还想考虑`a.(karma + c)^b`，或`a.(karma + c)^b + d`。分析您定义的规则应该告诉您使用哪一个。

**更新：**为`c`

**编辑：**您有一些 SQL 选项。临时表（带有总和）实际上可能是最快的。您也可以只使用视图。尽管我不确定，但也可以在同一张表上进行连接。使用视图看起来像：（对于某些选择的 a、b、c 和 d）（您可能还想向视图添加索引）

```
Votes(issueID, userID) // table structure
User(userID, karma, ...) // table structure

CREATE VIEW Sums AS
SELECT issueID, SUM(1*POWER(karma + 2, 3) + 4) AS sumVal
FROM Votes JOIN User ON User.userID = Votes.userID
GROUP BY issueID 
```

询问：

```
SELECT (1*POWER(karma + 2, 3) + 4)/sumVal AS influenceOnIssue
FROM Votes JOIN User ON User.userID = Votes.userID
  JOIN Sums on Sums.issueID = Votes.issueID
WHERE Votes.userID = @UserID AND Votes.issueID = @IssueID 
```

简化可能是有一个计算列 =`1*POWER(karma + 2, 3) + 4`

更快的选择是在插入/更新时计算派生业力，方法是增加一列并使用触发器，或者只是在调用插入/更新之前计算，然后使用新值调用插入/更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:17:20.113

从数学上讲，最好的办法是通过相关用户的百分位排名的对数来加权。但是，这在 SQL 中是很痛苦的。

更简单的方法是作弊并假设平均值与中位数相同（在统计上这是一个非常糟糕的假设，但在编程上更简单）：

```
 SELECT 1 - log10(SELECT COUNT (*) FROM user 
 WHERE (SUM(user.points) / COUNT(user.*)) < user.points)  
 / SELECT (COUNT (*) from user)) 
```

这样一来，你前 10% 的业力将产生普通用户的一倍半影响，几乎是菜鸟影响的两倍。显然，更改日志基数会扩展这一点，其中自然日志（mysql 中的 log()）会给上层 10% 的人带来 3 倍于菜鸟的影响，以及两倍于平均水平的影响。Log2() 更加极端。（注意：需要减法，因为对数将为负数。）

如果您想要更严重的效果，您可以尝试对日志进行平方。（注意：平方使对数平方为正，因此此处适合加法。）

如果你想要一个超精确的规则，你可以进入标准偏差，但是 sql 变得繁琐和缓慢。这完全取决于你想去兔子洞多远......

# asp.net - ASP.NET-Parser 错误：3d 方 DLL 的格式无效

> ID：13883598
> 
> 赞同：0
> 
> 时间：2012-12-14T17:34:22.320
> 
> 标签：asp.net, parsing

我收到一个我不明白的错误 - 尽管消息中使用了很多词;-(

我在德语窗口中运行，所以我翻译了一些味精*（文本后用斜体字）*

该文件是有效的 - 我已经从一个也使用该 DLL 的工作项目中复制了整个目录结构。所以可能是某些路径信息在某处是错误的等等。

Serverfehler 在 der Anwendung '/refdb' 中。Parserfehler *Parser error* Beschreibung: Beim Verarbeiten einer Resource, die für diese Anforderung erforderlich ist, ist ein Fehler aufgetreten。Überprüfen Sie folgende Fehlerinformationen und ändern Sie die Quelldatei entsprechend。

Parser-Fehlermeldung: Das Format der Datei 'PeterBlum.DES' ist ungültig。*PeterBlum.DES 的文件格式无效*

奎尔费勒：

Zeile 1: <%@ Register tagPrefix="des" assembly="PeterBlum.DES" namespace="PeterBlum.DES" %> Zeile 2: <%@ Register tagPrefix="despval" assembly="PeterBlum.DES.NativeToDES" namespace ="PeterBlum.DES.NativeToDES" %> Zeile 3: <%@Page Language="apl" Debug="true" Inherits="COPA" src="COPA_MS.dws" %>

Quelldatei: C:\Inetpub\wwwroot\ciwrefdb\refdb01.aspx Zeile: 1

Überwachung beim Laden der Assembly：Mit folgenden Informationen kann bestimmt werden，warum die Assembly 'PeterBlum.DES' nicht geladen werden konnte。

=== 预绑定状态信息 === LOG: DisplayName = PeterBlum.DES (Partial) LOG: Appbase = file:///C:/Inetpub/wwwroot/ciwrefdb LOG: Initial PrivatePath = bin

# 调用程序集：（未知）。

LOG：此时未将策略应用于引用（私有、自定义、部分或基于位置的程序集绑定）。日志：策略后参考：PeterBlum.DES 日志：尝试下载新 URL 文件：///C:/WINDOWS/Microsoft.NET/Framework/v1.1.4322/Temporary ASP.NET Files/refdb/e4095c5f/e6e8b1fa/PeterBlum .DES.DLL。日志：正在尝试下载新的 URL 文件：///C:/WINDOWS/Microsoft.NET/Framework/v1.1.4322/Temporary ASP.NET Files/refdb/e4095c5f/e6e8b1fa/PeterBlum.DES/PeterBlum.DES.DLL。日志：正在尝试下载新的 URL 文件：///C:/Inetpub/wwwroot/ciwrefdb/bin/PeterBlum.DES.DLL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:54:41.140

嗯，经过一番谷歌搜索后，我尝试将 web.config 中的“位置路径”条目移到开头，从而解决了这个问题。我很高兴它的工作原理和困惑，这可能会导致......

# knockout.js - 不调用 knockoutjs 自定义绑定更新方法

> ID：13883600
> 
> 赞同：0
> 
> 时间：2012-12-14T17:34:29.720
> 
> 标签：knockout.js

**更新**我已将代码移至 jsFiddle [http://jsfiddle.net/TnSV6/13/](http://jsfiddle.net/TnSV6/13/)

当`edit`被调用时，模型设置为视图模型并打开对话框。但是，当`save`或被`undo`调用时，模式设置为 null 但对话框不会关闭。

如果我在 jqDialog 处理程序中明确使用 jquery 来使取消链接和 ajax 完成事件关闭对话框，我可以完成这项工作，但这感觉有点骇人听闻，因为`jqDialog.update`应该管理打开/关闭。

似乎没有开始将呼叫转移到`jqDialog.update()`。但我不确定这是在哪里被阻止的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T15:18:01.753

是的，我上面说的实际上是问题所在。在你`with`的 observable 里面已经被解包了，所以你只是在处理`SettingShipmentDate.workOrder`. 自定义绑定不知道持有它的实际可观察​​对象。

一个简单的解决方法就是这样写：

```
<!-- ko with: SettingShipmentDate.workOrder -->
<div data-bind="jqDialog: $parent.SettingShipmentDate.workOrder, dialogOptions: {close: $root.SettingShipmentDate.undo}" data-title="Set Shipment Date"> 
```

现在您的绑定被传递给 observable`workOrder`而不仅仅是它的内容，并且您在绑定`update`函数中所做的展开将能够创建依赖项。

示例：http: [//jsfiddle.net/rniemeyer/Y4JbP/](http://jsfiddle.net/rniemeyer/Y4JbP/)

否则，您可以对其进行一些重构，以将`with`语句移到`div`它的内部或内部。虽然，`with`目前正在防止值为空。

# c# - 如何为我的应用程序在 C:\ProgramData 中创建的文件授予所有用户创建、读取和修改权限？

> ID：13883601
> 
> 赞同：0
> 
> 时间：2012-12-14T17:34:29.140
> 
> 标签：c#, .net, permissions, user-accounts

我的应用程序基本上会在其中创建一个 XML 文件`C:\ProgramData\MyAppFolder`并在其中转储配置设置。

我甚至需要允许标准用户有权向这些配置文件添加或删除设置。现在我看到标准用户只有读取/执行权限，但没有“完全控制”。

我已经看到其他问题正在通过修改该特定文件夹的权限的方法得到解答，但我不想更改默认权限级别，因为它可能会被系统管理员重置。

如果`C:\ProgramData`不能将访问权限授予所有用户，是否有最适合应用程序需求的文件夹？

编辑：

我最初的问题可能具有误导性。我不想授予用户权限，而是允许应用程序在所有用户运行时修改 XML 文件。

决定：

我认为在 ProgramData 中创建文件夹时更改权限是唯一的选择。

如果这是不可能的，CommonDocuments 就是要走的路。

谢谢夏娃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:39:20.770

我会在`Environment.SpecialFolder`枚举中使用一个文件夹。

例子：

```
var path = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:55:38.773

假设您有一个应用程序的安装程序，您的安装程序可以在您的应用程序将具有读/写访问权限的公共 appdata 目录（又名 C:\ProgramData）中创建一个子文件夹。根据您选择的安装技术，您也可以设置该文件夹的权限，尽管这可能有点矫枉过正。我知道使用[WiX](http://wixtoolset.org/)基本上你所要做的就是每台机器安装并确保创建子文件夹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T17:39:39.413

不应允许用户向该目录写入任意数据。这相当于普通用户能够修改`C:\Users\AllUsers`目录。如果用户需要修改这个目录，你就有严重的设计缺陷，应该重新考虑这种方法。应该发生的事情是为用户提供 GUI 界面以与之交互，该界面在幕后操纵这些值而不给他们直接访问权限，类似于大多数编程语言中 getter/setter 的工作方式。不用说，当普通用户可以为其他用户破坏系统时，这是一个非常大的安全漏洞。

**更新**

> 我不想让用户直接访问该文件。我的问题可能具有误导性。我想让程序完全控制文件，即使它由所有用户运行。我实际上是在这样做：“为用户提供了 GUI 界面来与之交互，在幕后操纵这些值，而不给他们直接访问权限”

这篇[文章](http://weblogs.asp.net/kennykerr/archive/2006/09/29/Windows-Vista-for-Developers-_1320_-Part-4-_1320_-User-Account-Control.aspx) 有太多信息无法在此处发布，将提供有关保持安全以不泄漏权限的详细信息。您要做的第一件事是确保您的应用程序用户在自己的组中，并且不能登录/拥有任何特殊权限。您可以做的是将这个组添加到具有写入权限的目录中，这将允许该应用程序执行这些任务。如果这是不可能的，您将需要在 UAC 中工作，以免破坏系统的安全性，如上文所述。

**第二次更新**

> 感谢您的链接。关于其他可以完成这项工作的文件夹的任何建议，而不是弄乱权限？

当然，您可以将其写入应用程序写入的目录中，即`C:\Program Files\Some Awesome Program`，这会将所有内容保存在一个地方，您只需担心您的用户/组以及安装它的人允许的任何内容。它还可以防止其他人弄乱它，除非他们当然是管理员。

# asp.net-mvc - MVC 错误路径中的非法字符。

> ID：13883604
> 
> 赞同：0
> 
> 时间：2012-12-14T17:34:40.220
> 
> 标签：asp.net-mvc

有人可以告诉我我是否走在正确的轨道上？我试图显示我的查询，但出现错误。我有两个具有相同参数的文本框，并且该参数被声明为 IEnumerable。

```
 [HttpPost]
        public ActionResult Orders1(IEnumerable<int> order)
        {
            using (CostcoEntities1 context = new CostcoEntities1())
            {
                var query = string.Empty;

                foreach (var orderID in order)
                {

                        query = (from a in context.CM_Checkout_Details
                                 where a.CheckoutDetails_ID == orderID
                                 select a).ToString();
                }
                return View(query);
            }
        } 
```

这就是我的控制器的样子。我正在尝试读取文本框中的两个数字（Id）并根据这些 id 显示数据。

```
@using (Html.BeginForm("Orders1", "Track", FormMethod.Post))
{
         @Html.TextBox("order")<br />
         @Html.TextBox("order")
        <input type="submit" value="Submit" />
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:44:07.500

首先，更改文本框的名称，使它们不相同：

```
@using (Html.BeginForm("Orders1", "Track", FormMethod.Post))
{
         @Html.TextBox("order1")<br />
         @Html.TextBox("order2")
        <input type="submit" value="Submit" />
} 
```

接下来，更改您的操作方法的签名：

```
[HttpPost]
public ActionResult Orders1(string order1, string order2) 
```

例如，MVC 的模型绑定将尝试将 order1 和 order2 匹配到 Request.Form 中的内容，这应该获取文本框的值。

# ruby - 更少挂起 Sinatra 应用程序

> ID：13883605
> 
> 赞同：7
> 
> 时间：2012-12-14T17:34:47.540
> 
> 标签：ruby, sinatra, less

我正在尝试将 Bootstrap 添加到 Sinatra 应用程序。我已经设置了编译路径`bootstrap.less`和`responsive.less`. 在 Web 浏览器中分别加载两个样式表按预期工作。但是当我尝试在 html 页面中使用它们时，我的应用程序会挂起。我只能用 停止应用程序`kill -9`。

似乎不知何故，较少的导入和多个样式表会导致应用程序挂起。我能够隔离问题：

**应用程序.rb**

```
require 'rubygems'
require 'bundler/setup'

require 'sinatra'
require 'less'

get '/' do
  haml :index
end

get '/style1.css' do
  less :style1, :paths => ['views'] 
end

get '/style2.css' do
  less :style2, :paths => ['views'] 
end 
```

**意见/index.haml**

```
!!! 5
%html
  %head
    %title Hello World
    %link{'rel' => 'stylesheet', 'href' => 'style1.css', 'type' => 'text/css'}
    %link{'rel' => 'stylesheet', 'href' => 'style2.css', 'type' => 'text/css'}
  %body
    %h1 Hello World
    %p Hello World 
```

**视图/style1.less**

```
@import "mixins.less";
@import "shadows.less";

@color: #00eeff;

h1 {
  color: @color;
} 
```

**视图/mixins.less**

```
.box-shadow(@shadow) {
  -webkit-box-shadow: @shadow;
  -moz-box-shadow: @shadow;
  box-shadow: @shadow;
} 
```

**视图/shadows.less**

```
h1 {
  .box-shadow(6px 6px 3px #888);
} 
```

**意见/style2.less**

```
@color: #ccff00;

p {
  color: @color;
} 
```

访问索引页面会挂起 Sinatra。`style2.less`如果我在 html 页面或内联`shadows.less`或页面加载`mixins.less`中`style1.less`按预期注释掉。

知道可能是什么问题或如何进一步调试吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:29:39.247

我拿走了你的文件并对它们做了一些小改动：

*   我重命名为`style2.css`，`style2.less`以便可以在其上使用 Less，并最终使用正确的 css 语法下载 style2.css ---它不适用于其他扩展。
*   而且，我告诉 Less 搜索指令的路径是 Sinatra 的视图路径：`Less.paths << settings.views`.

因此，通过这些更改，Sinatra 应用程序停止挂起。

# linux - linux下如何找出空闲物理内存量（c语言）

> ID：13883606
> 
> 赞同：1
> 
> 时间：2012-12-14T17:34:56.133
> 
> 标签：linux, memory-management

假设我想缓存某些计算，但将其同步到磁盘会导致 I/O 损失，这将超过缓存的整个目的。

这意味着，我需要能够找出剩余多少物理 RAM（包括缓存内存，假设我可以将其推出并允许一些松弛应该缓冲增加）。我查看了 /proc/meminfo 并知道如何读出它。我不太确定如何组合这些数字来得到我想要的。不需要代码，一旦我知道我需要什么，我就可以自己编写代码。

我不会在它需要运行的盒子上有根，但否则它应该相当安静。没有大量的磁盘 I/O，没有其他进程突然占用大量内存。该操作系统是一个相当新的 linux，启用了过度使用。这需要在不明显触发 OOM 杀手的情况下工作。

数字不需要精确到兆字节，我假设它大约在 1 到 7 gib 范围内，具体取决于盒子，但接近 100 mb 会很棒。

如果估计在较小的方面犯错，那肯定会更好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:38:40.223

Unices 具有标准`sysconf()`功能（[OpenGroups 手册页](http://pubs.opengroup.org/onlinepubs/009695399/functions/sysconf.html)、[Linux 手册页](http://linux.die.net/man/3/sysconf)）。

使用此函数，您可以获得总物理内存：

```
unsigned long long ps = sysconf(_SC_PAGESIZE);
unsigned long long pn = sysconf(_SC_AVPHYS_PAGES);
unsigned long long availMem = ps * pn; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T21:58:02.317

作为 H2CO3 答案的替代方案，您可以从 /proc/meminfo 读取。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-02-10T11:39:11.937

对我来说，statfs 运行良好。

```
#include <sys/vfs.h>

struct statfs buf;
size_t available_mem;
if ( statfs( "/", &buf ) == -1 ) 
    available_mem = 0;
else 
    available_mem = buf.f_bsize * buf.f_bfree; 
```

# java - 如何在 Java 客户端中读取来自 servlet 的响应？

> ID：13883608
> 
> 赞同：4
> 
> 时间：2012-12-14T17:35:00.017
> 
> 标签：java, servlets

我有一个 Java 应用程序：

-此应用程序发送一个字符串：

```
HttpClient httpClient = new DefaultHttpClient();

    try {
        HttpPost request = new HttpPost(url);
        StringEntity params = new StringEntity(xml);
        request.addHeader("content-type", "application/x-www-form-urlencoded");
        request.setEntity(params);
        HttpResponse response = httpClient.execute(request);

        // handle response here...
        String res= response.toString();
        System.out.println("RESPONSE=>\n"+response); //where i read the response
    } catch (Exception ex) {
        // handle exception here
    } finally {
        httpClient.getConnectionManager().shutdown();
    } 
```

我在我的 servlet 中使用这个字符串，我只想发送一个字符串响应。

```
response.setContentType("text/html;charset=UTF-8");
    PrintWriter out = response.getWriter();
    out.print("TEST"); 
```

但是当我阅读回复时，我只有我的标题：

```
RESPONSE=>
HTTP/1.1 200 OK [X-Powered-By: Servlet/3.0 JSP/2.2 (GlassFish Server Open Source Edition 3.1.2.2 Java/Oracle Corporation/1.7), Server: GlassFish Server Open Source Edition 3.1.2.2, Content-Type: text/html;charset=UTF-8, Content-Length: 83, Date: Fri, 14 Dec 2012 17:17:07 GMT] 
```

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:38:40.863

您使用错误的方法来阅读您的回复日期。来电：

```
String res= response.toString(); 
```

只是为您提供 Response 对象的字符串表示形式，而不是它包含的数据。Apache Http Commons 库有一个实用程序类，可以轻松读取响应，称为`EntityUtils`. 改用它来读取整个响应正文。不要忘记在执行此操作之前您需要验证请求是否实际成功完成：

```
if(response.getStatusLine().getStatusCode() == 200) {
    final String res = EntityUtils.toString(response.getEntity());
} 
```

# javascript - Greasemonkey 是否允许通过 @require 加载本地 JavaScript？

> ID：13883610
> 
> 赞同：10
> 
> 时间：2012-12-14T17:35:10.547
> 
> 标签：javascript, greasemonkey, require

我尝试包含一些本地 Javascript（与 GM 脚本位于同一文件夹中），在这两种情况下，脚本都无法加载，并且脚本似乎停止工作，直到我重新启动浏览器，即使删除了带有 @require 的行.

我都试过了

```
// @require file://script.js 
```

然后

```
// @require file:///full/path/to/script.js 
```

并且这两个选项都不起作用。

Greasemonkey 是否禁止加载本地 Javascript，还是需要一些额外的设置才能启用它？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-15T02:53:32.733

是的，你可以`@require`和`@resource`本地文件，但语法必须是正确的。此外，如果脚本安装在服务器外并尝试`@require`使用本地文件，则`extensions.greasemonkey.fileIsGreaseable`必须`true`在[*about:config*](http://kb.mozillazine.org/About:config)中设置。

对于与脚本在**同一文件夹**中的JS ：

```
// @require  Local_Require_1.js 
```

或使用**相对路径**：

```
// @require  resources/Local_Require_2.js 
```

完整**路径** ：

```
// @require  file:///D:/Local_Require_3.js 
```

不要忘记 Windows 上的驱动器号。

请注意，该`@require`指令的任何或所有部分都可能区分大小写，具体取决于您的操作系统。所以，完全匹配大小写。

另请注意，在实时编辑脚本时，尤其是更改`@require`指令时，脚本有时可能会静默停止工作。如果发生这种情况，请关闭目标页面选项卡，卸载并重新安装脚本。

# fpga - chdir 不适用于 Spartan 6 SP605 FPGA

> ID：13883611
> 
> 赞同：0
> 
> 时间：2012-12-14T17:35:11.110
> 
> 标签：fpga, xilinx, chdir, spartan

我正在开发一个使用 Spartan 6 FPGA 评估套件的项目。

我遇到的问题是尝试更改 CF 卡上的目录时，软件无法构建工作堆栈。

目录是“a:\\setup”，它被传递给 sysace_chdir(const char *path) 函数。当我尝试添加一些打印代码来调试问题时，没有注册任何更改。在 SDK 中，我有 MicroblazeProc_hw_platform，然后是我的项目，然后是standalone_bsp_0 项目，其中包含 sysace_chdir() 函数。当我构建所有项目时，简单的打印语句（我使用 xil_printf() 进行输出）不会显示在输出中。

任何帮助都会很棒。

PS - 我使用 COM 端口连接到 SDK 中的 FPGA，并且其他打印语句在初始化其他东西（如 UART）期间确实得到输出，所以这不是输出到终端或任何东西的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T20:01:47.730

我想我弄清楚了问题所在。

我将卡插入 USB 读卡器并使用 FAT32 文件系统对其进行格式化。

至于 BSP 中的 cnages，我无法弄清楚，但代码现在可以更改目录。

奇怪的是，代码执行后，如果我拔出CF卡插入我的电脑，我看不到新创建的目录。我不知道为什么。

# google-maps - 带有路径的动态 Google 地图的 URL

> ID：13883615
> 
> 赞同：2
> 
> 时间：2012-12-14T17:35:22.500
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers, google-maps-api-2

我想构建一个动态地图的 URL（即，到您可以平移和缩放的普通 Google 地图界面，而不是静态地图的图像），该地图上具有从经纬度坐标绘制的路径。

类似的问题被问到了无法解决我的问题的答案：

[如何从静态地图 URL 获取动态地图？](https://stackoverflow.com/questions/10275618/how-to-obtain-dynamic-google-map-url-have-static-map-url)：这家伙想在地图上添加一些标记（它们之间的线会形成我想要的路径），并被告知使用 URL 参数是不可能的。

[如何从静态地图 URL 获取动态地图？](https://stackoverflow.com/questions/7102264/how-to-obtain-dynamic-google-map-url-of-a-specific-map-i-have-static-map-url): 是的，这个人问了同样的问题。他被告知只需稍微更改 URL，但如果您按照 URL 访问动态地图，您会发现它不会绘制静态地图中看到的内容（例如，许多参数被忽略和剥离）。

[对于 KML 输出，如何在 Google 地图 URL 中的源地址和目标地址之间添加航点？](https://stackoverflow.com/questions/8787674/how-to-pass-waypoints-between-source-and-destination-lat-and-long-in-kml-url-for)`saddr`：我知道我可以用、`daddr`和询问行车路线`+to:`，但我只想要一条折线路径，而不是行车路线。

我已经看到许多指向[http://mapki.com/wiki/Google_Map_Parameters](http://mapki.com/wiki/Google_Map_Parameters)的链接记录了 URL 参数，但是该站点已经消失了，而且似乎没有其他文档（甚至是官方文档）能与[这个人的乏味工作相提并论](http://www.seomoz.org/ugc/everything-you-never-wanted-to-know-about-google-maps-parameters)。

那么这是不可能的吗？行车路线是我能做的最好的吗？

谢谢您的考虑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T22:54:11.597

你可以做的最好的你已经在这里找到了：[http ://www.seomoz.org/ugc/everything-you-never-wanted-to-know-about-google-maps-parameters](http://www.seomoz.org/ugc/everything-you-never-wanted-to-know-about-google-maps-parameters)

创建一个包含所需特征（标记、折线、标记等）的 KML，并将 KML 文件的 URL 作为 q 参数传递给 google-maps。

KML 文件可以即时创建，因此您可以将要素的详细信息传递给创建 KML 的脚本。

# python - contourf() 将日期时间对象的二维数组作为轴中断

> ID：13883616
> 
> 赞同：1
> 
> 时间：2012-12-14T17:35:27.120
> 
> 标签：python, datetime, numpy, matplotlib

我正在使用`matplotlib`'s`contourf`函数将`z`数据显示为`x`和的函数`y`。如果和是一维数组，我可以使用对象`numpy`数组`datetime`作为 x 轴。但是，当我将我的和数组设为二维时，会在二维对象数组上中断。示例如下：`x``y``x``y``contourf``datetime`

```
import numpy as np
from datetime import datetime,timedelta
import matplotlib.pyplot as plt

x = np.array([datetime(2012,12,12),datetime(2012,12,13),datetime(2012,12,14)])
y = np.arange(10)
z = np.random.random((10,3))

plt.contourf(x,y,z) 
```

此示例有效并产生了预期的结果。但是，如果我这样做：

```
x = np.tile(np.reshape(x,( 1,3)),(10,1))
y = np.tile(np.reshape(y,(10,1)),( 1,3)) 
```

所以`x`,`y`和`z`都是 shape `(10,3)`，`contourf(x,y,z)`产生这个回溯：

```
Traceback (most recent call last):
  File "./test_2d_datetime.py", line 14, in <module>
    plt.contourf(x,y,z)
  File "/home/disk/mako/milan/epd/epd-7.3-1-rh5-x86_64/lib/python2.7/site-packages/matplotlib/pyplot.py", line 2206, in contourf
    ret = ax.contourf(*args, **kwargs)
  File "/home/disk/mako/milan/epd/epd-7.3-1-rh5-x86_64/lib/python2.7/site-packages/matplotlib/axes.py", line 7322, in contourf
    return mcontour.QuadContourSet(self, *args, **kwargs)
  File "/home/disk/mako/milan/epd/epd-7.3-1-rh5-x86_64/lib/python2.7/site-packages/matplotlib/contour.py", line 1106, in __init__
    ContourSet.__init__(self, ax, *args, **kwargs)
  File "/home/disk/mako/milan/epd/epd-7.3-1-rh5-x86_64/lib/python2.7/site-packages/matplotlib/contour.py", line 700, in __init__
    self._process_args(*args, **kwargs)
  File "/home/disk/mako/milan/epd/epd-7.3-1-rh5-x86_64/lib/python2.7/site-packages/matplotlib/contour.py", line 1119, in _process_args
    x, y, z = self._contour_args(args, kwargs)
  File "/home/disk/mako/milan/epd/epd-7.3-1-rh5-x86_64/lib/python2.7/site-packages/matplotlib/contour.py", line 1166, in _contour_args
    x,y,z = self._check_xyz(args[:3], kwargs)
  File "/home/disk/mako/milan/epd/epd-7.3-1-rh5-x86_64/lib/python2.7/site-packages/matplotlib/contour.py", line 1194, in _check_xyz
    x = np.asarray(x, dtype=np.float64)
  File "/home/disk/mako/milan/epd/epd-7.3-1-rh5-x86_64/lib/python2.7/site-packages/numpy/core/numeric.py", line 235, in asarray
    return array(a, dtype, copy=False, order=order)
TypeError: float() argument must be a string or a number 
```

如果我使用二维值数组`matplotlib.dates.date2num()`而不是`datetime`对象，`contourf()`则按预期工作。

我遇到的问题有补救措施吗？我在 64 位 Linux 上使用 Python`2.7.3`和 matplotlib 。`1.1.0`

# android - Android NFC 无法写入 Mifare DesFire 卡

> ID：13883620
> 
> 赞同：3
> 
> 时间：2012-12-14T17:35:53.130
> 
> 标签：android, nfc, mifare

我正在尝试使用 Galaxy S3 将一些数据写入 Mifare DesFire 卡，其中包含以下几行：

```
private byte[] wrapMessage (byte command, byte[] parameters) throws Exception {
    ByteArrayOutputStream stream = new ByteArrayOutputStream();

    stream.write((byte) 0x90);
    stream.write(command);
    stream.write((byte) 0x00);
    stream.write((byte) 0x00);
    if (parameters != null) {
        stream.write((byte) parameters.length);
        stream.write(parameters);
    }
    stream.write((byte) 0x00);

    return stream.toByteArray();
}

boolean isoDepWrite(Tag tag) {
      IsoDep idTag = IsoDep.get(tag);
      idTag.setTimeout(5000);

      String info = "";
      DesfireProtocol dfp = new DesfireProtocol(idTag);
      try {
          idTag.connect();
          info += "Connected to IsoDep Tag...\n";

          int[] appList = dfp.getAppList();
          dfp.selectApp(appList[0]);
          info += "Selected app no: " + appList[0] + "..\n";

          int[] fileList = dfp.getFileList();
          info += "Selected file no: " + fileList[0] + "\n";

          byte[] params = {(byte)fileList[0], 
                           (byte)0x0, (byte)0x0, (byte)0x0, 
                           (byte)0x2, (byte)0x0, (byte)0x0,
                           (byte)0x41, (byte)0x41};
          byte[] message = wrapMessage((byte) 0x3d, params);

          byte[] result = idTag.transceive(message);
          info += "Result bytes: " + convertByteArrayToHexString(result) + "\n";

          toast(info);
          return true;
      } catch (IOException e) {
          info += "Could not connect to IsoDep Tag...\n";
      } catch (Exception e) {
          info += "Error messages: " + e.getMessage() + " -- " + e.getLocalizedMessage() + "\n";
      }

      toast(info);
      return false;
  } 
```

沟通后得到的信息是：

```
Connected to IsoDep tag...
Selected app no: 1109742 // that shows I connected to an Application
Transceieve result bytes: 91 9e  // PARAMETER ERROR 
```

我可以连接并读取该应用程序的文件，但是在我尝试写入后，该文件中的字节为 0。0x9E 是 PARAMETER_ERROR，所以我在包装/排列字节时做错了什么，有任何字节样本或想法吗？

**编辑：**我尝试了@nemo 推荐的字节：

```
{0x3d, fileList[0], 0x0, 0x0, 0x0, 0x2, 0x0, 0x0, 0x41, 0x41} 
```

现在我得到“67 00”作为结果字节，这意味着*长度错误*并且文件保持不变，只有 0。

**最后编辑：**我只是通过以下方式创建了一个新的字节数组：

```
wrapMessage(0x3d, rest of the bytes in the list @nemo recommended) 
```

它终于奏效了。我用上面的工作改变了旧的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T01:10:40.390

我认为你的`Write`命令错了，但这是在黑暗中开枪。

根据官方DESFire文档（尝试搜索`M075031`）`WriteData`定义如下：

```
WriteData(FileNo, Offset, Length, Data) 
```

作为字节流，它看起来像这样：

```
WriteCmd FileNo  Offset (3 byte)  Length (3 byte)  Data (0 to 52 byte)
[0x3D]   [0x00]  [0x00 0x00 0x00] [0x00 0x00 0x00] [0x00 ... 0x00] 
```

甚至可以比 52 字节多写 59 字节，但这在这里并不重要。

IMO，您应该使用 WriteCmd 所需的数据创建一个新数组，如下所示：

```
{0x3d, fileList[0], 0x0, 0x0, 0x0, 0x2, 0x0, 0x0, 0x41, 0x41} 
```

它应该将 2 (0x2) 个字节（0x41 和 0x41）写入由`fileList[0]`.

**编辑：**更新偏移量，顺序是 LSB 到 MSB。

# android - 通过 adb shell 设置系统时间格式

> ID：13883624
> 
> 赞同：5
> 
> 时间：2012-12-14T17:36:28.520
> 
> 标签：android, adb

我正在尝试编写一个简单的表单实用程序来配置附加的 android 设备。我需要执行的一项操作是更改系统时区、时间和时间格式。

我通过以下方式设置系统时区：

```
adb shell setprop persist.sys.timezone "America/Chicago" 
```

通过更改时间

```
adb shell date -s YYYYMMDD.HHmmss 
```

现在我需要设置设备的 12/24 小时格式，但我不知道该怎么做。它需要通过 adb 来完成。任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-09-22T19:13:43.620

```
IF "%time:~0,1%"==" " (
    SET mynow=%date:~-4,4%%date:~-10,2%%date:~-7,2%.0%time:~1,1%%time:~3,2%%time:~6,2%
) ELSE (
    set mynow=%date:~-4,4%%date:~-10,2%%date:~-7,2%.%time:~0,2%%time:~3,2%%time:~6,2%
)

REM sourced from:
REM http://developer.android.com/reference/android/provider/Settings.System.html

REM STILL NEED
REM font scale = 1.25  (display -> font size = extra large)
REM screen lock = none (security -> screen lock)
REM scheduled power off 10:30pm daily  (scheduled power on & off

REM allow apps from unknown sources (settings-> developer options)
adb shell settings put secure install_non_market_apps 1

REM ... (settings-> developer options)
adb shell settings put global stay_on_while_plugged_in 3

REM display off after 30 minutes (settings-> display)
adb shell settings put system screen_off_timeout 1800000

REM display Font Scale X-Large (settings-> display)
REM write setting not working, read setting works fine
REM adb shell settings put system font_scale 1.25

REM set default rotation state to horizontal
adb shell settings put system user_rotation 0

REM use 12 hour format (settings->date & time)
adb shell settings put system time_12_24 12

REM Automatic date & time = use network provided (settings->date & time)
REM adb shell settings put global auto_time 1
REM Automatic date & time = OFF (settings->date & time)
adb shell settings put global auto_time 0

REM Automatic time zone = use network provided time-zone (settings->date & time)
REM adb shell settings put global auto_time_zone 1
REM Automatic time zone = OFF (settings->date & time)
adb shell settings put global auto_time_zone 0

REM set Date & Time
adb shell su 0 date -s %mynow% 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-14T21:57:58.120

启用 24 小时时间格式的命令是：

```
adb shell settings put system time_12_24 24 
```

# markdown - 是否可以让 MarkdownDeep 或 MarkdownSharp 像 Pandoc 一样处理混合的 HTML/Markdown？

> ID：13883627
> 
> 赞同：1
> 
> 时间：2012-12-14T17:36:46.713
> 
> 标签：markdown, markdownsharp, markdowndeep

将以下 HTML 片段与 Markdown 混合。

```
<section class="section alt">
# Hello
</section> 
```

使用[Pandoc 在线翻译](http://johnmacfarlane.net/pandoc/try)`Markdown (strict) -> Html`，您将获得以下 HTML：

```
<section class="section alt">
<h1 id="hello">Hello</h1>
</section> 
```

[对MarkdownDeep](http://www.toptensoftware.com/markdowndeep/dingus)做同样的事情，你会得到这个 HTML：

```
<p></p><section class="section alt"><p></p>
<h1>Hello</h1>
<p></p></section><p></p> 
```

注意所有疯狂的`<p>`标签！？MarkdownSharp 也是如此。 *公平地*说，我认为 Pandoc 在这里不符合规范，其他两个库可能是正确的（更新：Pandoc在这里[故意不符合规范](http://johnmacfarlane.net/pandoc/README.html#raw-html)（参见下面 John 的评论））。但是，Pandoc 方法在 IMO 上要好得多。

是否可以让 MarkdownDeep 或 MarkdownSharp 表现得像 Pandoc？如果没有，是否有替代的 .NET markdown 实现/解决方案可以像这样工作？（我需要包含和 ILMerge 所以不能使用 Pandoc）。

# javascript - 如果鼠标悬停在 DIV 上，则保持显示

> ID：13883629
> 
> 赞同：2
> 
> 时间：2012-12-14T17:37:01.047
> 
> 标签：javascript, jquery

我有以下 jQuery 代码（取自此处某处的另一个问题）：

```
$(document).ready(function(){
    $("#profile_dropdown").mouseenter(function(){
        clearTimeout($(this).data('timeoutId'));
        $("#profile_dropdown_content").fadeIn("slow");
    }).mouseleave(function(){
        var someElement = $("#profile_dropdown");
        var timeoutId = setTimeout(function(){
            $("#profile_dropdown_content").fadeOut("slow");
        }, 650);
        //set the timeoutId, allowing us to clear this trigger if the mouse comes back over
        someElement.data('timeoutId', timeoutId); 
    });
}); 
```

`#profile_dropdown_content`但是，它按预期工作 -如果鼠标移到它上面，我不知道如何保持显示。如果鼠标移出当然如何使它淡出...

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:42:00.503

嵌套`#profile_dropdown_content`在`#profile_dropdown`容器内部并使用悬停事件。

jsfiddle：http: [//jsfiddle.net/UsWYq/1/](http://jsfiddle.net/UsWYq/1/)

**JS**

```
$(document).ready(function(){
    $("#profile_dropdown").hover(function(){
        clearTimeout($(this).data('timeoutId'));
        $("#profile_dropdown_content").fadeIn("slow");
    }, function(){
        var someElement = $("#profile_dropdown");
        var timeoutId = setTimeout(function(){
            $("#profile_dropdown_content").fadeOut("slow");
        }, 650);
        //set the timeoutId, allowing us to clear this trigger if the mouse comes back over
        someElement.data('timeoutId', timeoutId); 
    });
}); 
```

**HTML**

```
<div id="profile_dropdown">
    <div class="inner">Hover Me</div>
    <div id="profile_dropdown_content">Display Me</div>
</div>
<div id="profile_dropdown"></div> 
```

**CSS**

```
#profile_dropdown {
    background:whitesmoke;
    float:left;
}
#profile_dropdown .inner {
    height:100px;
    width:100px;
}
#profile_dropdown_content {
    display:none;
    background:red;
    height:100px;
    width:100px;
} 
```

**选项 2**

您可以做的另一件事是 CSS3 过渡：http: [//jsfiddle.net/Ezxm5/](http://jsfiddle.net/Ezxm5/)

```
#profile_dropdown {
    background:whitesmoke;
    float:left;
}
#profile_dropdown:hover #profile_dropdown_content {
    display:block;
    opacity:1;
    height:100px;
}
#profile_dropdown .inner {
    height:100px;
    width:100px;
}
#profile_dropdown_content {
    opacity:0;
    background:red;
    height:0;
    width:100px;
    overflow:hidden;
    -webkit-transition: opacity 0.4s ease-in, height 0.4s ease-out;
    -moz-transition: opacity 0.4s ease-in, height 0.4s ease-out;
    -ms-transition: opacity 0.4s ease-in, height 0.4s ease-out;
    -o-transition: opacity 0.4s ease-in, height 0.4s ease-out;
    transition: opacity 0.4s ease-in, height 0.4s ease-out;
}​
​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T17:50:12.217

将元素包装在另一个中，`div`然后将`mouseenter`and`mouseleave`函数绑定到包装器。

**模拟 HTML**

```
<div id="profile_wrapper">
    <div id="profile_dropdown">Profile Dropdown</div>
    <div id="profile_dropdown_content">This is some information about me.  I write code all day long.</div>
</div> 
```

**Javascript**

```
$(document).ready(function(){
    $("#profile_wrapper").mouseenter(function(){
        clearTimeout($(this).data('timeoutId'));
        $("#profile_dropdown_content").fadeIn("slow");
    }).mouseleave(function(){
        var someElement = $("#profile_dropdown");
        var timeoutId = setTimeout(function(){
            $("#profile_dropdown_content").fadeOut("slow");
        }, 650);
        //set the timeoutId, allowing us to clear this trigger if the mouse comes back over
        someElement.data('timeoutId', timeoutId);
    });
}); 
```

[http://jsfiddle.net/H7Hvf/1/](http://jsfiddle.net/H7Hvf/1/)

# ios - 如何将 NSString 编码为 Euc-kr

> ID：13883638
> 
> 赞同：1
> 
> 时间：2012-12-14T17:37:44.380
> 
> 标签：ios, encoding, nsstring

我正在努力将`NSString`变量编码为 Euc-kr 类型... :(
我必须通信的数据库服务器基于 Euc-kr，所以我别无选择，只能这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:55:08.207

上面的答案几乎是正确的，但由于 EUC-KR 不是 NSString 编码，您首先必须从 CF 土地获取编码。像这样的东西：

```
NSUInteger encoding = CFStringConvertEncodingToNSStringEncoding(kCFStringEncodingEUC_KR);
const char * eucKRString = [string cStringUsingEncoding:encoding]; 
```

# javascript - extjs4 中的 afterLabelTextTpl 用法

> ID：13883645
> 
> 赞同：0
> 
> 时间：2012-12-14T17:38:15.403
> 
> 标签：javascript, extjs, extjs4, extjs4.1

我需要在字段标签之后显示图像。我想看看我是否可以使用 afterLabelTextTpl。但是没有在网上找到如何使用它的示例。

这是我想要做的事情的一个想法。有人可以在语法上纠正我吗..

```
 {
                                    xtype: 'combobox',
                                    fieldLabel: 'Role',
                                    editable:false,
                                    store: roles_store, 
                                    triggerAction:'all',
                                    name: 'role_id',
                                    valueField: 'role_id',
                                    displayField:'role_name',
                                    afterLabelTextTpl : function() {

                                        {
                                            xtype: 'image',
                                            src:'../www/css/slate/btn/question.png',
                                            padding: '5 0 0 0',
                                            cls:'pointer',
                                            listeners: {
                                                el:{
                                                    click: function() {
                                                        Ext.create('Ext.tip.Tip', {
                                                            closable:true,
                                                            padding: '0 0 0 0',
                                                            maxWidth:300,
                                                            html: "<b>read-only</b>: Has read access to all pages, but can make no changes.<br><br><b>user</b>: Can edit rules and commit to production.<br><br><b>admin</b>: Can edit rules, commit to production, and add/delete users.<br><br> "+supertext
                                                        }).showAt([810, 340]);
                                                    }
                                                }
                                            }

                                        }
                                    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:49:06.697

它是一个 XTemplate 实例或一个字符串。

从[文档](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.Labelable-cfg-afterLabelTextTpl)：

> 要在标签文本之后的字段标记中插入的可选字符串或 XTemplate 配置。如果使用 XTemplate，组件的渲染数据将用作上下文。

所以一个字符串 "Hello" 会做，或者[XTemplate](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.XTemplate)会接受的任何东西

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:01:24.663

这`afterLabelTextTpl`是一个模板配置，这意味着它需要一个字符串、一个字符串数组或一个实例`Ext.XTemplate`并使用它来生成 HTML。

没有通过 XTemplate 创建组件的内置方法（尽管论坛成员创建了一个名为[CTemplate](http://www.sencha.com/forum/showthread.php?148066 "模板")的扩展来允许这样做）。所以如果你想使用纯 Ext JS，你需要做更多的工作。

**注意：**我无法访问 Ext JS 4.1.3，所以下面是一个近似值，基于我对 4.1.0 的经验。您可能需要调整代码以使其恰到好处，但它应该提供足够的起点。

第 1 步：设置您的 afterLabelTextTpl。尝试这样的事情：

```
afterLabelTextTpl:'<img id="combo_icon" style="padding-top:5px" class="pointer" src="../www/css/slate/btn/question.png"/>' 
```

那应该会显示您的图标。

第 2 步：添加点击监听器。有两种方法可以解决这个问题。这两种方法都假定您有一个名为`My.Name.Space.onImageClick`. 显然，您可以用您想要的任何名称替换此名称。这是功能：

```
My.Name.Space.onImageClick = function(){
    Ext.create('Ext.tip.Tip', {
        closable: true,
        padding:  0,
        maxWidth: 300,
        html:     '<b>whatever you want here</b>'
    }).showAt([810, 340]);
}; 
```

一种方法是将侦听器直接添加到 DOM。

```
'<img onclick="My.Name.Space.onImageClick();" /* the rest of the HTML here */ />' 
```

另一种方法是添加监听器，`Ext.dom.Element`这可能是更好的选择。你的组合框配置中需要这样的东西：

```
listeners: {
    afterrender: function(me){
        var imgEl = Ext.get("combo_icon");
        if(imgEl){
            imgEl.on("click", My.Name.Space.onImageClick);
        }
    }
} 
```

如果您在使其正常工作时遇到具体问题，请发表评论，我会帮助澄清我能做的。

# apache - Apache Prefork 与 Worker MPM

> ID：13883646
> 
> 赞同：120
> 
> 时间：2012-12-14T17:38:24.077
> 
> 标签：apache

查看 Apache 配置文件，我看到 Prefork 和 Worker MPM 已定义。有什么区别，Apache 使用的是哪一个？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2012-12-20T08:38:46.730

Prefork 和 worker 是 apache 提供的两种类型的 MPM。两者都有其优点和缺点。

默认情况下，mpm 是 prefork，它是线程安全的。

Prefork MPM 使用多个子进程，每个子进程都有一个线程，每个进程一次处理一个连接。

Worker MPM 使用多个子进程，每个子进程有很多线程。每个线程一次处理一个连接。

有关更多详细信息，您可以访问[https://httpd.apache.org/docs/2.4/mpm.html](https://httpd.apache.org/docs/2.4/mpm.html)和[https://httpd.apache.org/docs/2.4/mod/prefork.html](https://httpd.apache.org/docs/2.4/mod/prefork.html)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-06-15T08:14:50.487

Apache 的多处理模块 (MPM) 负责绑定到机器上的网络端口、接受请求并分派子进程来处理请求 ( [http://httpd.apache.org/docs/2.2/mpm.html](http://httpd.apache.org/docs/2.2/mpm.html) )。

它们与任何其他 Apache 模块一样，只是***在任何时候都必须将一个且只有一个 MPM 加载到服务器中***。MPM 在配置期间被选择，并通过使用带有配置脚本的参数***编译到服务器***中，其中是所需 MPM 的名称。`--with-mpm=NAME``NAME`

Apache 将为每个操作系统使用默认的 MPM，除非在编译时选择了不同的 MPM（例如在 Windows`mpm_winnt`上默认使用）。以下是操作系统及其默认 MPM 的列表：

*   操作系统`beos`
*   网络软件 `mpm_netware`
*   操作系统/2`mpmt_os2`
*   Unix/Linux `prefork`（[Apache 版本 ≥ 2.4 的](https://httpd.apache.org/docs/2.4/mpm.html#defaults)[***更新***](https://httpd.apache.org/docs/2.4/mpm.html#defaults)：`prefork`、、`worker`或`event`，取决于平台功能）
*   视窗`mpm_winnt`

要检查哪些模块被编译到服务器中，请使用命令行选项`-l`（[这里](http://httpd.apache.org/docs/2.2/programs/httpd.html)是文档）。例如，在 Windows 安装中，您可能会得到如下信息：

```
> httpd -l
Compiled in modules:
  core.c
  mod_win32.c
  mpm_winnt.c
  http_core.c
  mod_so.c 
```

从 2.2 版开始，这是[可用核心功能和 MPM 模块的列表](http://httpd.apache.org/docs/2.2/mod/)：

*   `core`- 始终可用的核心 Apache HTTP Server 功能
*   `mpm_common`- 由多个多处理模块 (MPM) 实现的一组指令
*   `beos`- 这个多处理模块针对 BeOS 进行了优化。
*   `event`- 标准工作者 MPM 的实验变体
*   `mpm_netware`多处理模块实现专为 Novell NetWare 优化的线程网络服务器
*   `mpmt_os2`用于 OS/2 的混合多进程、多线程 MPM
*   `prefork`实现一个非线程的、预分叉的 Web 服务器
*   `mpm_winnt`- 这个多处理模块针对 Windows NT 进行了优化。
*   `worker`- 实现混合多线程多进程 Web 服务器的多处理模块

`prefork`现在，到和之间的区别`worker`。

[MPM](http://httpd.apache.org/docs/2.2/mod/prefork.html) _[`prefork`](http://httpd.apache.org/docs/2.2/mod/prefork.html)

> 实现了一个非线程的、预分叉的 Web 服务器，它以类似于 Apache 1.3 的方式处理请求。它适用于需要避免线程以与非线程安全库兼容的站点。它也是隔离每个请求的最佳 MPM，这样单个请求的问题不会影响到任何其他请求。

[`worker`MPM](http://httpd.apache.org/docs/2.2/mod/worker.html)实现了一个混合多进程多线程服务器并提供了更好的性能，因此它应该是首选，除非使用包含非线程安全库的其他模块（另请参阅[此](https://serverfault.com/questions/383526/how-do-i-select-which-apache-mpm-to-use)[讨论](https://serverfault.com/questions/45042/which-to-install-apache-worker-or-prefork-what-are-the-dis-advantages-of-eac)或有关 Serverfault 的此讨论）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-12-14T18:29:37.073

Take a look at [this](https://serverfault.com/questions/231628/apache-mpms-worker-vs-prefork) for more detail. It refers to how Apache handles multiple requests. Preforking, which is the default, starts a number of Apache processes (2 by default here, though I believe one can configure this through httpd.conf). Worker MPM will start a new thread per request, which I would guess, is more memory efficient. Historically, Apache has used prefork, so it's a better-tested model. Threading was only added in 2.0\.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-11-24T06:16:02.920

对于 CentOS 6.x 和 7.x（包括 Amazon Linux），请使用：

```
sudo httpd -V 
```

这将显示哪些 MPM 已配置。prefork、worker 或事件。Prefork 是较早的线程安全模型。Worker 是多线程的，并且 event 支持 php-mpm，这应该是一个更好的处理线程和请求的系统。

但是，根据配置，您的结果可能会有所不同。我在 php-mpm 中看到了很多不稳定性，并且没有任何速度改进。一个激进的蜘蛛可以很容易地耗尽 php-mpm 中的最大子进程。

prefork、worker 或 event 的设置在 sudo nano /etc/httpd/conf.modules.d/00-mpm.conf 中设置（对于 CentOS 6.x/7.x/Apache 2.4）。

```
# Select the MPM module which should be used by uncommenting exactly
# one of the following LoadModule lines:

# prefork MPM: Implements a non-threaded, pre-forking web server
# See: http://httpd.apache.org/docs/2.4/mod/prefork.html
#LoadModule mpm_prefork_module modules/mod_mpm_prefork.so

# worker MPM: Multi-Processing Module implementing a hybrid
# multi-threaded multi-process web server
# See: http://httpd.apache.org/docs/2.4/mod/worker.html
#LoadModule mpm_worker_module modules/mod_mpm_worker.so

# event MPM: A variant of the worker MPM with the goal of consuming
# threads only for connections with active processing
# See: http://httpd.apache.org/docs/2.4/mod/event.html
#LoadModule mpm_event_module modules/mod_mpm_event.so 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-06-05T04:59:13.057

您可以通过发出以下命令来判断 Apache 使用的是 preform 还是 worker

```
apache2ctl -l 
```

在结果输出中，查找提及 prefork.c 或 worker.c

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-03-09T13:46:38.187

它很容易在 RHEL7 上的 Apache 2.4 中的 prefork 或 worker mpm 之间切换

通过执行检查 MPM 类型

```
sudo httpd -V

Server version: Apache/2.4.6 (Red Hat Enterprise Linux)
Server built:   Jul 26 2017 04:45:44
Server's Module Magic Number: 20120211:24
Server loaded:  APR 1.4.8, APR-UTIL 1.5.2
Compiled using: APR 1.4.8, APR-UTIL 1.5.2
Architecture:   64-bit
Server MPM:     prefork
  threaded:     no
    forked:     yes (variable process count)
Server compiled with....
 -D APR_HAS_SENDFILE
 -D APR_HAS_MMAP
 -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)
 -D APR_USE_SYSVSEM_SERIALIZE
 -D APR_USE_PTHREAD_SERIALIZE
 -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT
 -D APR_HAS_OTHER_CHILD
 -D AP_HAVE_RELIABLE_PIPED_LOGS
 -D DYNAMIC_MODULE_LIMIT=256
 -D HTTPD_ROOT="/etc/httpd"
 -D SUEXEC_BIN="/usr/sbin/suexec"
 -D DEFAULT_PIDLOG="/run/httpd/httpd.pid"
 -D DEFAULT_SCOREBOARD="logs/apache_runtime_status"
 -D DEFAULT_ERRORLOG="logs/error_log"
 -D AP_TYPES_CONFIG_FILE="conf/mime.types"
 -D SERVER_CONFIG_FILE="conf/httpd.conf" 
```

现在更改 MPM 编辑以下文件并取消注释所需的 MPM

```
 /etc/httpd/conf.modules.d/00-mpm.conf 

# Select the MPM module which should be used by uncommenting exactly
# one of the following LoadModule lines:

# prefork MPM: Implements a non-threaded, pre-forking web server
# See: http://httpd.apache.org/docs/2.4/mod/prefork.html
LoadModule mpm_prefork_module modules/mod_mpm_prefork.so

# worker MPM: Multi-Processing Module implementing a hybrid
# multi-threaded multi-process web server
# See: http://httpd.apache.org/docs/2.4/mod/worker.html
#
#LoadModule mpm_worker_module modules/mod_mpm_worker.so

# event MPM: A variant of the worker MPM with the goal of consuming
# threads only for connections with active processing
# See: http://httpd.apache.org/docs/2.4/mod/event.html
#
#LoadModule mpm_event_module modules/mod_mpm_event.so 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-05-14T19:28:44.320

Apache 定义了 2 种类型的 MPM（多处理模块）：

1：Prefork 2：工人

默认情况下，Apacke 配置为预分叉模式，即非线程预分叉 Web 服务器。这意味着每个 Apache 子进程都包含一个线程并一次处理一个请求。因此，它消耗更多的资源。

Apache 还拥有将 Apache 转变为多进程、多线程 Web 服务器的 worker MPM。Worker MPM 使用多个子进程，每个子进程有很多线程。

# opengl - 帧缓冲对象支持

> ID：13883652
> 
> 赞同：4
> 
> 时间：2012-12-14T17:38:57.667
> 
> 标签：opengl, fbo

大多数仍在使用的 OpenGL 2.0 和 2.1 显卡是否支持帧缓冲区对象（通过 GL_ARB_framebuffer_object 或 GL_EXT_framebuffer_object 扩展）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-15T07:14:57.120

根据我的经验，他们确实如此。

在 nVidia 中，至少可以追溯到 GeForce FX 5xxx（支持 OpenGL 2.0）的 GPU 支持 FBO，我怀疑甚至更旧的显卡也支持。

在老到只支持 OpenGL 2.0 的 ATI GPU 中，我见过像 HD 2400 和 X1300 这样的 GPU，它们都支持 FBO。

在 Intel GPU 中，我认为主要是 HD Graphics 系列完全支持 OpenGL 2.0，而且我见过的所有 HD Graphics GPU 都支持 FBO。我还看到了其他一些支持 2.0 和 FBO 的 GPU，包括某些版本的 965，以及称为“Eaglelake”的东西。不过，我不确定为什么只有一些 965 支持 OpenGL 2.0。这可能是驱动程序问题。

另一方面，我还没有找到任何*不*支持 FBO 的兼容 2.0 的 GPU。

我希望这个纯粹的经验性答案有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-23T14:06:52.753

我会说是的。我的英特尔 GMA 950 的 Windows 7 驱动程序（至少）非正式地公开了 OpenGL 2.0 功能，并且通过 EXT_framebuffer_object 扩展支持帧缓冲区对象。

# java - android - 计时器不从零开始

> ID：13883656
> 
> 赞同：1
> 
> 时间：2012-12-14T17:39:04.703
> 
> 标签：java, android, chronometer

我正在尝试在 android 中制作一个包含小时和毫秒的秒表。我的计时器总是从 7:00:00.000 或 24 小时制 19:00:00.000 开始。这是代码：

```
public class MainActivity extends Activity {
   TextView tv;
   long init,now,time;

   @Override
   public void onCreate(Bundle savedInstanceState) {
       //...
       myChronometer.setOnChronometerTickListener(new OnChronometerTickListener() {
            public void onChronometerTick(Chronometer cArg) {
                SimpleDateFormat timeFormat = new SimpleDateFormat("hh:mm:ss.S");
                now=System.currentTimeMillis();
                time=now-init;
                String s2 = timeFormat.format(time);
                tv.setText(s2);
            }
        });
       final ImageButton buttonStart = (ImageButton)findViewById(R.id.start);
       buttonStart.setOnClickListener(new Button.OnClickListener(){
       @Override
       public void onClick(View v) {
           init=System.currentTimeMillis();
           myChronometer.setBase(init);
           myChronometer.start();
       }});

   }

} 
```

有没有办法从零开始计时并从那里继续计时？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:31:04.780

The 7 hour difference is likely due to your timezone. SimpleDateFormat uses your system's timezone by default, whereas System.currentTimeMillis() gives you the time in UTC.

This should fix your problem, in onChronometerTick():

```
SimpleDateFormat timeFormat = new SimpleDateFormat("H:mm:ss.S");
timeFormat.setTimeZone(TimeZone.getTimeZone("UTC"));
now=System.currentTimeMillis(); 
```

Notice I changed hh to H in your format string.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T18:00:27.440

在我看来，计时器使用当前时间作为开始。您可能不应该使用

```
init=System.currentTimeMillis(); 
```

如果你想从 0 开始，但是

```
init=0; 
```

希望这可以帮助

# php - 如何从 php 中的会话数组中取消设置特定键值

> ID：13883660
> 
> 赞同：-1
> 
> 时间：2012-12-14T17:39:07.853
> 
> 标签：php, arrays, session

我有一个用于预订产品的预订车，在某些时候，用户可以从他们的购物车中删除特定产品。

我需要帮助从会话数组中删除产品，因为我在尝试删除产品时不断收到错误消息“致命错误：无法取消设置字符串偏移”。

这是删除的代码

```
 <?php

if(isset($_GET['inh_arr_key']) && isset($_GET['c_id'])) {

$inh_arr_key = $_GET['inh_arr_key'];
$del_c_id = $_GET['c_id'];

unset($_SESSION['inh_cart'][$inh_arr_key]);

$inh_cart = $_SESSION['inh_cart'];

// Parse the cart session variable
$inh_arr = explode(',',$inh_cart);  

if (array_key_exists($inh_arr_key, $inh_arr)) {
    echo '<p class="err_msg">Unable to delete selected course from your In-house course booking cart.</p>';
}
else{

$del_inh_query_course_info = @mysql_query("select * from inhouse_prod where id='".$del_c_id."'");
$del_inh_course_det = @mysql_fetch_assoc($del_inh_query_course_info);   
$del_inh_course_title = $del_inh_course_det['title'];

    echo '<p class="ok_msg"><strong>'.$ex_inh_course_title.'</strong> has been deleted from your In-house course booking cart.</p>';    
}

}

?> 
```

我已经获取并附加了每个产品数组键和值。所以这是由 $_GET 检索的，它们在这些变量中

```
$inh_arr_key = $_GET['inh_arr_key'];
$del_c_id = $_GET['c_id']; 
```

只是为了提供有关该问题的更多详细信息，这里是将产品添加到购物车的代码，它工作正常

```
<?php

$c_id = $_GET['c_id'];

session_name("inh_cart");

session_start();

$inh_cart = $_SESSION['inh_cart'];
if ($inh_cart) {

$get_inh_arr = explode(',',$inh_cart);

if(in_array($c_id, $get_inh_arr)){ 
$inh_cart = $inh_cart;

?>
    <script language="javascript">
    window.location = "user_allc_booking.php?ex_inh_cid=<?php echo $c_id; ?>";
    </script>
<?php

}
else {
$inh_cart .= ','.$c_id;
}

} else {
$inh_cart = $c_id;
}
$_SESSION['inh_cart'] = $inh_cart;

?>
    <script language="javascript">
    window.location = "user_allc_booking.php";
    </script>
<?php

$inh_query_course_info = @mysql_query("select * from inhouse_courses where id='".$c_id."'");
$inh_course_det = array();
$inh_course_det = @mysql_fetch_assoc($inh_query_course_info);   
$inh_course_title = $inh_course_det['title'];

?> 
```

如果例如购物车包含 3 个产品，如果我执行 var_dump($_SESSION['inh_cart']);

输出将是：

```
string(8) "20,48,24" 
```

真的需要删除产品的代码有什么问题。需要帮助。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:42:26.153

由于某种原因，此时它似乎`$_SESSION['inh_cart']`是一个字符串，因此它试图取消设置`$inh_arr_key`不允许的字符串索引处的字符。

看起来你把它作为一个逗号分隔的列表......所以为了做你的 unset，你需要在调用 unset 之前爆炸它。

但这是一种不好的方法。在混淆索引方面，你留下了很大的错误空间。你应该把它变成一个数组，让 php 序列化/反序列化它作为正常会话行为的一部分。此外，不要对键使用通用的有序数字索引，而是使用每个产品独有的东西，例如 SKU 或数据库记录中的主键。

所以把它放在一起...

将东西添加到购物车：

```
$c_id = $_GET['c_id'];

session_name("inh_cart");

session_start();

if(!isset($_SESSION['inh_cart']) {
  // if we dont have a cart - initialize it as an array
  $_SESSION['inh_cart'] = array();
}

$inh_cart &= $_SESSION['inh_cart'];

if(in_array($c_id, $inh_cart)): ?> 
    <script language="javascript">
       window.location = "user_allc_booking.php?ex_inh_cid=<?php echo $c_id; ?>";
    </script>
<?php else: 

   // just append the item to the array 
   $inh_cart[] = .$c_id;

endif; ?>

<script language="javascript">
    window.location = "user_allc_booking.php";
</script>

<?php

// not sure what youre trying to do here but ok...
$inh_query_course_info = @mysql_query("select * from inhouse_courses where id='".$c_id."'");
$inh_course_det = array();
$inh_course_det = @mysql_fetch_assoc($inh_query_course_info);   
$inh_course_title = $inh_course_det['title'];

?> 
```

然后从购物车中删除：

```
<?php
// all processing at the top - easier to read -
// use the $error variable to tell what message to display
$error = false;

if(!isset($_GET['c_id'])) {
  $error = true;
} else {

  $del_c_id = $_GET['c_id'];
  $del_key = array_search($del_c_id, $_SESSION['inh_cart']);

  if($del_key) {
      unset($_SESSION['inh_cart'][$delkey]);

      // get the course info
      $del_inh_query_course_info = @mysql_query("select * from inhouse_prod where id='".$del_c_id."'");
      $del_inh_course_det = @mysql_fetch_assoc($del_inh_query_course_info);   
      $del_inh_course_title = $del_inh_course_det['title'];
  } else {
     $error = true;
  }
}
?>

<?php if($error): ?>
    <p class="err_msg">Unable to delete selected course from your In-house course booking cart.</p>
<?php else: ?>
    <p class="ok_msg"><strong> <?php echo $ex_inh_course_title ?></strong> has been deleted from your In-house course booking cart.</p>
<?php endif; ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:48:53.043

我的猜测是你的错误在这里：

```
unset($_SESSION['inh_cart'][$inh_arr_key]); 
```

您似乎有一个逗号分隔的值作为`$_SESSION['inh_cart']`. 它是一个字符串，而不是一个数组。因此，您`[]`在字符串上使用语法本质上是在执行以下操作：

```
unset `$_SESSION['inh_cart']` at position starting at [some string value] ($inh_arr_key) 
```

当然，该字符串没有 [some string value] 的偏移量，因为它的偏移量是严格的数字。

您需要使用 '$_SESSION['inh_cart']` 作为数组。

此外，您可能不想通过`$_GET`. 这是一个非常糟糕的主意，因为当有人使用前进/后退按钮浏览您的网站时，他们会（在他们的脑海中随机地）看到他们的购物车发生了变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:41:55.093

您可以尝试确保密钥存在。

```
if (array_key_exists($inh_arr_key, $_SESSION['inh_cart'])) {
    unset($_SESSION['inh_cart'][$inh_arr_key]);
} 
```

根据@prodigitalson 确保`$_SESSION['inh_cart']`数组不是字符串。

# haskell - 如何简化修改用户状态的 Parsec 规则

> ID：13883664
> 
> 赞同：0
> 
> 时间：2012-12-14T17:39:19.103
> 
> 标签：haskell, monads, parsec

在学习 Parsec 时，我发现有些冗长的规则，例如

```
type PhonemeClassMap = Map Char String
type ContextElement = Parser String

phonemeContext :: Parsec String PhonemeClassMap ContextElement
phonemeContext = do
    c <- lower
    return $ char c 
```

可以通过将函数提升`char`到`Parsec`/ `ParsecT`monad 来简化。

```
phonemeContext :: Parsec String PhonemeClassMap ContextElement
phonemeContext = liftM char lower 
```

现在我正在尝试简化修改用户状态的规则：

```
import Data.Map (insert)

phonemeClassDefinition :: Parsec String PhonemeClassMap ()
phonemeClassDefinition = do
    upperChar <- upper
    lowerChars <- char ':' >> spaces >> many1 lower
    modifyState (insert upperChar lowerChars) 
```

我可以轻松提升`insert :: Char -> String -> PhonemeClassMap -> PhonemeClassMap`以进行以下改进：

```
phonemeClassDefinition = do
    f <- liftM2 insert upper (char ':' >> spaces >> many1 lower)
    modifyState f 
```

有没有办法将这两种表达方式合二为一？相同的提升技术不适用于`modifyState :: Monad m -> (u -> u) -> ParsecT s u m ()`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T21:20:21.413

在这种情况下，您正在寻找单子绑定`>>= :: Monad m => (a -> m b) -> m a -> m b`，它允许您应用一个函数，该函数接受一个纯函数`a`并将单子动作返回给单子`a`（即“通过”单子应用函数）。这个函数实际上是 monadic 类型类的一个组成部分，并且是`<-`符号`do`desugar 到引擎盖下的内容。

（旁注，与`liftM2`, `liftM3`... 不同，为了方便起见，似乎没有预定义`bindM2 :: Monad m => (a -> b -> m c) -> m a -> m b -> m c`（或`bindM3`等）。（[Hoogle 画了一个空白](http://www.haskell.org/hoogle/?hoogle=Monad+m+%3D%3E+%28a+-%3E+b+-%3E+m+c%29+-%3E+m+a+-%3E+m+b+-%3E+m+c)。））

此外，Parsec 解析器通常（在风格上和其他方面）受益于使用其 Applicative 和 Functor 实例，而不仅仅是它的 Monad 实例，特别是（ /的`<$>`别名）和 monadic & :[和](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Applicative.html#v%3a-60--42--62-)[&](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Applicative.html#v%3a-60--42--62-)的各种（半）等价物。`fmap``liftM``ap``>>`[`<*>``<*``*>`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Applicative.html#v%3a-60--42--62-)

```
phonemeContext = char <$> lower

phonemeClassDefinition = (insert <$> upper <*> (char ':' *> spaces *> many1 lower)) >>= modifyState 
```

（请注意，@melpomene`=<<`只是`flip (>>=)`，即交换了参数。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T17:44:24.937

```
modifyState =<< liftM2 insert upper (char ':' >> spaces >> many1 lower) 
```

# git - 在 git 将新分支合并到我的总分支时遇到特定问题

> ID：13883676
> 
> 赞同：0
> 
> 时间：2012-12-14T17:40:11.600
> 
> 标签：git, version-control, git-tower

> **可能重复：**
> [在 git 合并冲突中，如何保留正在合并的版本？](https://stackoverflow.com/questions/13885390/in-git-merge-conflicts-how-do-i-keep-the-version-that-is-being-merged-in)

我的机器上有两个本地 git 分支——一个名为“v2”的分支和一个名为“master”的分支。

我想将“v2”分支合并到“master”分支中。当我执行合并时，我必须一一解决许多冲突。

我遇到的问题是“master”分支文件具有“v2”分支没有的附加代码。如何保留“master”分支文件而不是文件的“v2”分支版本？

Git Tower 针对这些类型的冲突提供给我的选项是：

*   将 FILENAME 标记为手动解析
*   通过保留 FILENAME 来解决
*   通过删除文件名解决
*   恢复他们的 FILENAME 版本
*   在外部应用程序中打开

据我了解，“保留”文件的选项意味着保留“v2”版本（被合并的那个），“删除”文件意味着不添加“v2”版本（而是保留现有的“主”版本）。但是，当我使用此选项时，它实际上从存储库中完全删除了该文件。

**对于这些类型的冲突，如何保留“master”分支文件而不是文件的“v2”分支版本？**

* * *

编辑：我正在将 v2 合并到 master 中，而 master 已签出并且 head 分支。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:09:41.017

由于您将*其他东西*（v2 aka theirs）合并到 master 中，您可以“保留”文件（指“我们的”），将文件保留在 master 上。

请记住，git repos 是独立的；您可以通过备份来简单地测试这样的东西（将您的存储库的整个包含文件夹复制到其他地方，或者 ZIP/TAR 它），然后尝试一下。如果它没有产生您想象的结果，并且您无法使用 git 工具撤消它，只需删除并恢复您的备份！:D

# virus - 二进制和交替表示转换

> ID：13883678
> 
> 赞同：1
> 
> 时间：2012-12-14T17:40:24.747
> 
> 标签：virus, malware, representation, virus-definitions

在[这篇](http://www.cacs.louisiana.edu/~walenste/pubs/2007-iciw-walenstein-mathur-chouchane-lakhotia.pdf "变质恶意软件的设计空间")关于变质病毒的出版物中，我发现了这个分类：

> 变形恶意软件可能是***二进制转换器***或***替代表示转换器***。前一个类转换执行的二进制图像，而后一个类以更高级别的表示形式携带其代码，用于转换。

我没有找到这两个术语的精确定义。我想知道是否有每个人的通用定义，或者在我的论文中介绍分类的通用上下文。

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T15:41:45.210

**Binary-Transformer**更常用的术语是 `Binary Code Obfuscation`或简单`Binary Obfuscation` （在规避恶意软件静态分析和检测方面发挥重要作用）。一些花药也使用术语`Post-compilation obfuscation`[*]。该术语`Binary Obfuscation`也用于逆向工程中用于无辜目的（恢复源文件）。[[1]](http://www.defcon.org/images/defcon-17/dc-17-presentations/defcon-17-sean_taylor-binary_obfuscation.pdf) [[2]](http://www.utd.edu/~hamlen/cs6V81fa12/mimimorphism.pdf) [[3]](http://www.cs.arizona.edu/solar/papers/obf-signal.pdf)

而对于**Alternate-Representation-Transformer**术语`Assembly Level Obfuscation`, `Source Code Obfuscation`( 或`Source Obfuscation`)，您可以使用`Mnemonic Level Obfuscation`, `Code Obfuscation`。

[阅读这篇分类文章](http://www.intel-assembler.it/portale/5/assembler-obfuscation/assembler-obfuscation-code.asp)以找到有用的常用术语。

（但我不确定`Post-compilation obfuscation`）

* * *

论文写作不是精确的科学。不同的作者使用不同的（稀有）词来防止匹配概率。很多时候，我的论文/期刊仅仅因为演示而被拒绝，而不是因为技术缺陷。

# asp.net-mvc - 列表属性未由 EF 更新

> ID：13883680
> 
> 赞同：1
> 
> 时间：2012-12-14T17:40:29.913
> 
> 标签：asp.net-mvc, entity-framework, many-to-many

好的，这可能是我错了的概念，但无论如何......（MVC3）我有一个带有列表属性的实体。我的 CRUD 视图通过 Ajax 帖子向控制器发送 JSon 表示。一切都很好，除了当我发布该实体的更新时，列表属性根本没有更新。实体的所有简单属性都已更新，但（正如我想象的那样）更新树不包括 List 属性。如何让 EF 了解列表中的这些更改？

这是到目前为止的一些代码：

```
 [HttpPost]
    public JsonResult Edit(Lote lote)
    {
            //Given the IDs present in lote.Documentos, load the List of Documentos
            if (lote.Documentos != null)
            {
                List<Documento> ldoc = new List<Documento>();
                foreach (var d in lote.Documentos)
                {
                    ldoc.Add(db.Documentos.Find(d.IDDocumento));
                }
                lote.Documentos.Clear();
                foreach (var d in ldoc)
                {
                    lote.Documentos.Add(d);
                }
            }

            //Now, clear all the previous errors
            foreach (var modelValue in ModelState.Values)
            {
                modelValue.Errors.Clear();
            }
            //And re-validate the model
            ValidateModel(lote);

            if (ModelState.IsValid)
            {
                if (lote.IDLote > 0)
                {
                    //Updating
                    db.Entry(lote).State = EntityState.Modified;
                }
                else
                {
                    //Inserting
                    db.Lotes.Add(lote);
                }
                db.SaveChanges();
                CustomMessages.Sucesso(TempData, "Informações salvas com sucesso.", 10000);
                return Json(new { Success = 1, IDProprietario = lote.IDLote, ex = "" });
            }
            else
            {
                return Json(new { Success = 0, ex = "Falha na rotina de armazenamento das informações"});
            } 
```

这些就是类本身：

```
public class Lote
{
    [Key]
    public int IDLote { get; set; }

    (... lots of properties ...)

    [Display(Name = "Documentos")]
    public List<Documento> Documentos { get; set; }
}

public class Documento
{
    //---=== ATRIBUTOS ===---
    [Key]
    public int IDDocumento { get; set; }

    [Required]
    [MaxLength(60)]
    public string Nome { get; set; }

    public List<Lote> Lotes { get; set; }
} 
```

由于这是一个多对多的关系，我也得到了这个：

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove
        <System.Data.Entity.ModelConfiguration.Conventions.PluralizingTableNameConvention>();

        modelBuilder.Entity<Lote>()
            .HasMany(t => t.Documentos)
            .WithMany(t => t.Lotes)
            .Map(m =>
            {
                m.ToTable("LoteDocumento");
                m.MapLeftKey("IDLote");
                m.MapRightKey("IDDocumento");
            });
(... and some other stuff) 
```

对此有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:32:00.897

尝试更改此行：

```
ldoc.Add(db.Documentos.Find(d.IDDocumento)); 
```

至

```
ldoc.Add(db.Documentos.Include("Lotes").FirstOrDefault(x => x.IDDocumento == d.IDDocumento)); 
```

您需要确保您正在更改的关系/对象实际上附加到您当前的数据库上下文。否则实体框架将无法跟踪对它们所做的更改。

[此链接根据对象上下文对其进行了解释，但我认为相同的规则适用于 DBcontext。](http://msdn.microsoft.com/en-us/library/vstudio/bb896271%28v=vs.100%29.aspx)

如果这不起作用，请告诉我，因为我真的在努力更好地理解 EF 的工作方式。

好的，找到了更多有用的链接：

[ObjectStateManager 中已存在具有相同键的对象。ObjectStateManager 无法跟踪具有相同键的多个对象](https://stackoverflow.com/questions/6033638/an-object-with-the-same-key-already-exists-in-the-objectstatemanager-the-object)

[实体框架和连接池](https://stackoverflow.com/questions/3653009/entity-framework-and-connection-pooling/3653392#3653392)

当您执行时`Include("Lotes")`，将与您的 Documentos 相关的 lotes 添加到 DBContext。实体框架现在正在跟踪这些对象。在您的代码的更下方，您正在使用这一行将它们重新添加到上下文中，`db.Entry(lote).State = EntityState.Modified;`无论如何，这是我的猜测。

基于上面的链接，我会尝试重新编写你所拥有的（未编译）：

```
[HttpPost]
public JsonResult Edit(Lote lote)
{
    //get old Lote from DB
    var oldLote = db.Lotes.include("Documentos").FirstOrDefault(x => x.IDLote == lote.IDLote);

    //update
    if(oldLote != null)
    {
        //refresh any other properties that you may have changed on it.
        db.Entry(oldLote).CurrentValues.SetValues(lote);

        //not sure if you will even need this section any more but then you can...
        oldLote.Documentos.Clear();
        foreach (var d in lote.Documentos)
        {
            oldLote.Documentos.Add(db.Documentos.include("Lotes").FirstOrDefault(x => x.IDDocumento == d.IDDocumento));
        }
    }    
    else //add
    {
        //not sure if this will work
        foreach (var d in lote.Documentos)
        {
            db.Entry(d).State = EntityState.Modified;
        }

        db.Lotes.Add(lote);
    }

    //then just save changes.  EF is already tracking all your objects and changes.
    db.SaveChanges();
.... 
```

# c++ - 在不使用预编译头文件的 C++ 项目中编译 C 文件？

> ID：13883686
> 
> 赞同：48
> 
> 时间：2012-12-14T17:41:00.227
> 
> 标签：c++, c, visual-c++, compiler-errors, precompiled-headers

我可以在我的 C++ 项目中禁用 .c 文件的预编译头吗？

当我想将 .C 文件添加到我的程序中以用于 C 语言中的脚本虚拟/抽象机器时，我遇到了这些错误：

错误 1 ​​错误 C1853: 'Release\pluginsa.pch' 预编译头文件来自以前版本的编译器，或者预编译头文件是 C++ 并且您从 C 中使用它（反之亦然） Z:\Profile\Rafal\Desktop \samod\source\amx\amx.c 1 1 插件a

所有其他的东西都是 C++ 并使用我的预编译头文件。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2012-12-14T17:45:04.017

在*解决方案资源管理器*窗口中，右键单击 *.c 文件并选择*Properties*。转到*C / C++ -> Precompiled Headers*并将*Precompiled Header*选项设置为*Not Using Precompiled Headers*。

另外，除非你真的需要预编译的头文件，否则我会说在项目范围内关闭它。

另一种选择是将 C 文件编译为 C++ 并继续使用预编译的头文件。为此，请右键单击项目名称（或每个 .c 文件名），然后将*C / C++ -> Advanced -> Compiles As*设置为*Compile as C++ code*。

# ios - 如何使用 Mantle 在 NSArray 中指定子对象类型

> ID：13883693
> 
> 赞同：27
> 
> 时间：2012-12-14T17:41:26.403
> 
> 标签：ios, frameworks, github-mantle

如果我有一本像

```
{
  name: "Bob",
  cars: [
    { make: "ford", year: "1972" },
    { make: "mazda", year: "2000" }
  ],
} 
```

和两个模型，如：

```
@interface CarModel : MTLModel

@property (nonatomic, strong) NSString *make;
@property (nonatomic, strong) NSString *year;

@end

@interface PersonModel : MTLModel

@property (nonatomic, strong) NSString *name;
@property (nonatomic, strong) NSArray *cars;

@end 
```

如何使用 Mantle 以使我的人物模型中的汽车阵列成为 CarModels？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-14T18:45:28.900

啊想通了。我需要添加一个私有方法：

```
+ (NSValueTransformer *)carsTransformer
{
    return [NSValueTransformer mtl_externalRepresentationArrayTransformerWithModelClass:[CarModel class]];
} 
```

并确保我使用了：

```
[PersonModel modelWithExternalRepresentation:dict]; 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-07-24T08:59:46.533

`+[NSValueTransformer mtl_externalRepresentationArrayTransformerWithModelClass:]`已弃用。新的 API 是`+[NSValueTransformer mtl_JSONArrayTransformerWithModelClass:]`.

切换到新的 API 后，模型可以使用提供的默认初始化程序进行初始化，例如`MTLJSONAdapter`.

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-06-09T14:33:13.267

关于：

```
[NSValueTransformer mtl_JSONArrayTransformerWithModelClass:CarModel.class]; 
```

这种方法现在似乎已被弃用。我在我的代码中使用了这个新方法，它似乎工作得很好：

```
[MTLJSONAdapter arrayTransformerWithModelClass:CarModel.class]; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-04-22T08:35:15.163

```
+ (NSValueTransformer *)carsJSONTransformer {
    return [NSValueTransformer mtl_JSONArrayTransformerWithModelClass:CarModel.class];
} 
```

[在这里](http://www.objc.at/mantle)阅读更多

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-02T09:36:34.663

```
+[NSValueTransformer mtl_JSONArrayTransformerWithModelClass:] 
```

此方法已弃用。新方法是：

```
 + (NSValueTransformer *)carsTransformer
    {
        return [MTLJSONAdapter arrayTransformerWithModelClass:[CarsModel class]];
    } 
```

# coldfusion - cfexecute 命令行

> ID：13883696
> 
> 赞同：3
> 
> 时间：2012-12-14T17:41:48.270
> 
> 标签：coldfusion, wkhtmltopdf, coldfusion-8, coldfusionbuilder, cfexecute

我刚刚安装了[wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)，它将网页转换为 pdf。

我可以像这样从服务器上的命令行运行它：

```
wkhtmltopdf http://www.google.co.uk c:\google.pdf 
```

wkhtmltopdf 添加到 path 环境变量中。exe的真实路径是C:\Program Files\wkhtmltopdf\wkhtmltopdf.exe

我现在想使用 cfexecute 在 ColdFusion 8 上运行它。

```
<cfexecute name="c:\Program Files\wkhtmltopdf\wkhtmltopdf.exe"
        arguments="wkhtmltopdf http://www.google.com c:\google.pdf"
        timeout="10" /> 
```

我尝试了一些不同的变化，但似乎无法让它发挥作用。

我也收到了一些“错误 5 访问被拒绝”的消息，但我知道这仍然可能是语法问题而不是权限问题。

任何人都可以看到我的代码有问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T18:06:00.327

好的，它工作正常！...

```
<cfexecute name="c:\Program Files\wkhtmltopdf\wkhtmltopdf.exe" 
        arguments="http://www.google.com C:\google.pdf"
        timeout="10" /> 
```

语法与我在 Windows 中运行的命令行有点不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T14:00:38.057

您知道 ColdFusion 能够将 HTML 转换为内置的 PDF 吗？请参阅[cfdocument 标记](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Tags_d-e_05.html)。

这是一个应该可以工作的非常简单的示例：

```
<cfhttp method="get" url="http://www.google.com" timeout="10" />
<cfif cfhttp.StatusCode EQ "200 OK">
    <cfdocument format="PDF" localurl="false">
        <cfoutput>#cfhttp.FileContent#</cfoutput>
    </cfdocument>
<cfelse>
    <p>http request failed [<cfoutput>#cfhttp.StatusCode#</cfoutput>]</p>
</cfif> 
```

我不知道 PDF 转换器所需的功能范围，但对于简单的转换，`cfdocument`标签工作得很好。

# c - (C) realloc 数组按项修改数据_pointed_

> ID：13883704
> 
> 赞同：0
> 
> 时间：2012-12-14T17:42:24.917
> 
> 标签：c, arrays, pointers, realloc

(C) realloc数组修改items*指向的数据*

你好，

我想分享一个不错的奇怪错误 ;-) 需要一些初步解释：

首先，我有一种字符串类型，`PString`它保存它们的大小（和一个哈希值），然后是一个带有字节的灵活数组成员。这是构造函数的类型和种类（最后的 printfl 语句是调试）：

```
typedef struct {
   size_t   size;
   uint     hash;
   char     bytes[];
} PString;

// offset from start of pstring struct to start of data bytes:
static const size_t PSTRING_OFFSET = sizeof(size_t) + sizeof(uint);

PString * pstring_struct (string str, size_t size, uint hash) {
   // memory zone
   char *mem = malloc(PSTRING_OFFSET + size * sizeof(char));
   check_mem(mem);

   // string data bytes:
   memcpy(mem + PSTRING_OFFSET, str, size);
   mem[PSTRING_OFFSET + size] = NUL;

   // pstring struct:
   PString * pstr = (PString *) mem;
   pstr->size = size;
   pstr->hash = hash;

   printfl("*** str:'%s' (%u) --> pstr:'%s' (%u) 0x%X",
   str, size, pstr->bytes, pstr->size, pstr);   ///////////////////////
   return pstr;
} 
```

[欢迎对这个结构发表任何评论：我完全不确定是否做对了，在这里。这是我第一次使用灵活的数组成员，我找不到在*分配*的结构中使用它们的示例。]

其次，这些 pstrings 存储在字符串池中，这意味着一组实现为哈希表。像往常一样，用于冲突的“桶”（在哈希和取模之后）是单元的简单链表，每个单元都包含一个 pstring*指针*和一个指向下一个单元的指针。唯一的特殊细节是单元格本身存储在一个数组中，而不是在堆上的任何地方分配 [1]。希望图片清晰。这是 的定义`Cell`：

```
typedef struct SCell {
   PString        * pstr;
   struct SCell   * next;
} Cell; 
```

一切似乎都运行良好，包括对池本身的一系列测试。现在，在测试 pstring 例程（搜索）时，我注意到一个字符串发生了变化。经过一番研究，我终于猜到问题与池增长有关，并且最终可以完全减少围绕单元阵列增长的问题（因此，在将单元重新分配到列表之前）。以下是围绕此增长的调试打印行，`show_pool`生成输出的例程副本（仅显示字符串）和输出本身：

```
static void pool_grow (StringPool * pool, uint n_new) {
    ...
   // Grow arrays:
   show_pool(pool);  /////////////////////
   pool->cells = realloc(pool->cells, pool->n_cells * sizeof(Cell));
   check_mem(pool->cells);
   show_pool(pool);  ////////////////////
   ...

static void show_pool (StringPool * pool) {
   if (pool->n == 0) {
      printfl("{}");
      return;
   }

   printf("pool          : {\"%s\"", pool->cells[0].pstr->bytes);

   PString * pstr;
   uint i;
   for (i = 1; i < pool->n; i++) {
      pstr = pool->cells[i].pstr;
      printf(", \"%s\"", pstr->bytes);
   }

   printl("}");
}

// output:
pool          : {"", "abc", "b", "abcXXXabcXXX"}
pool          : {"", "abc", "b", "abcXXXabcXXXI"} 
```

如您所见，存储的最后一个字符串有一个额外的字节“I”。由于同时我只是调用 realloc，我发现自己在进一步调试时有点受阻；努力思考无助于揭开这个谜团。（请注意，单元格只保存 pstring*指针*，那么增长单元格数组如何改变字符串字节？）另外，我被以下事实吓到了，因为 printf 在神秘的“I”之后似乎有一个非常方便的 NUL停在那里。

谢谢你。你能帮我吗？

[1] 这里没有特别的理由这样做，使用字符串池。我通常这样做是为了免费获得一个有序的集合或地图，以及参考的位置。（唯一的开销是除了桶数组之外，单元数组必须增长，但可以通过预先确定维度来减少增长的数量。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:55:09.627

由于`size`不包括空终止符，

```
 mem[PSTRING_OFFSET + size] = NUL; 
```

是无效的。其他所有问题都源于此。

# java - 如何检查 HashMap 的唯一变量？

> ID：13883706
> 
> 赞同：0
> 
> 时间：2012-12-14T17:42:27.727
> 
> 标签：java

我编写了代码来查找 HashMap 中的唯一变量，但它似乎不起作用？我希望能够打印每种香肠类型的频率。

```
 if(sausagesEaten.isEmpty()) { //if the HashMap is empty
        System.out.println("No sausages have been eaten");
        System.out.println("======================================================="); ; 
    }
    else{
        HashMap<ArrayList, String> sausagesEaten = new HashMap<ArrayList, String>();
        for (String key : sausagesEaten) {
              System.out.println(key + ": " + Collections.frequency(saustype, key));
        }
        System.out.println(" ");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T02:03:06.270

您不能直接迭代 a `HashMap`。以下是您*可以*执行的操作：

```
Map<K,V> map = new HashMap<K,V>(); // whatever K and V are

for (K key : map.keySet())
{
    // iterates over all the keys in random order
}

for (V value : map.values())
{
    // iterates over all the values, in random order
} 
```

此外，使用可变对象（例如 an`ArrayList`作为映射的键）是非常不正统和危险的，如

```
HashMap<ArrayList, String> sausagesEaten = new HashMap<ArrayList, String>(); 
```

将其放入地图后，如果以任何方式修改其内容，都会破坏地图，并且可能无法检索它。我想你的意思是

```
HashMap<String, ArrayList> sausagesEaten = new HashMap<String, ArrayList>(); 
```

`sausagesEaten`此外，在您的代码中，您在子句中重新声明`else`，隐藏同名的成员变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T17:55:46.403

假设您的代码中已经有一个名为 sausagesEaten 的填充 HashMap。

改变：

```
 if(sausagesEaten.isEmpty()) { //if the HashMap is empty
    System.out.println("No sausages have been eaten");
    System.out.println("======================================================="); ; 
}
else{
    HashMap<ArrayList, String> sausagesEaten = new HashMap<ArrayList, String>();
    for (String key : sausagesEaten) {
          System.out.println(key + ": " + Collections.frequency(saustype, key));
    }
    System.out.println(" ");
} 
```

至：

```
 if(sausagesEaten.isEmpty()) { //if the HashMap is empty
    System.out.println("No sausages have been eaten");
    System.out.println("======================================================="); ; 
}
else{
    for (String key : sausagesEaten) {
          System.out.println(key + ": " + Collections.frequency(saustype, key));
    }
    System.out.println(" ");
} 
```

通过重新声明变量，它是本地范围并自动为空。

编辑：为正确的迭代添加了更改。

```
Iterator it = sausagesEaten.entrySet().iterator();
while (it.hasNext()) {
    Map.Entry pairs = (Map.Entry)it.next();
    System.out.println(pairs.getKey() + " = " + pairs.getValue());
} 
```

# c# - 如何更改 WCF 合同名称？

> ID：13883707
> 
> 赞同：0
> 
> 时间：2012-12-14T17:42:36.123
> 
> 标签：c#, .net, visual-studio-2010, wcf

从宿主项目中，我在哪里更改 WCF 服务使用的合同名称？我右键单击项目中的服务引用并选择了属性，这仅显示文件夹名称。我进入了配置服务，但那里没有关于合同的任何内容。

当我显示项目中的所有文件并打开服务时，Reference.svcmap > Reference.cs，大约在中途，我看到：

```
[System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "4.0.0.0")]
[System.ServiceModel.ServiceContractAttribute(Namespace="http://mysite.com/services/", ConfigurationName="MyServiceReference.IMyService")]
public interface IMyService { 
```

ConfigurationName 是出现在 app.config/web.config 中的合约名称。但这可能不是更新它的正确位置。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:47:04.990

您可以在定义服务的位置指定 ConfigurationName。就像在地图上一样：

```
[ServiceContract(ConfigurationName="NewName")]
public interface IMyService {
    ...
} 
```

# android - 不幸的是，应用程序在启动动态壁纸期间停止了

> ID：13883709
> 
> 赞同：0
> 
> 时间：2012-12-14T17:42:50.643
> 
> 标签：android

在我没有编译时错误，所以我尝试在模拟器螺母上运行我的代码，不幸的是我不知道如何跟踪 logcat，我在这里放置我的 logcat，任何人都可以帮助我找到问题

```
12-14 23:02:20.816: D/dalvikvm(845): Not late-enabling CheckJNI (already on)
12-14 23:02:21.516: D/dalvikvm(845): newInstance failed: no <init>()
12-14 23:02:21.556: D/AndroidRuntime(845): Shutting down VM
12-14 23:02:21.556: W/dalvikvm(845): threadid=1: thread exiting with uncaught exception (group=0x409961f8)
12-14 23:02:21.666: E/AndroidRuntime(845): FATAL EXCEPTION: main
12-14 23:02:21.666: E/AndroidRuntime(845): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.sri.alinwallpaper/com.sri.alinwallpaper.MyPoint}: java.lang.InstantiationException: can't instantiate class com.sri.alinwallpaper.MyPoint; no empty constructor
12-14 23:02:21.666: E/AndroidRuntime(845):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1879)
12-14 23:02:21.666: E/AndroidRuntime(845):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1980)
12-14 23:02:21.666: E/AndroidRuntime(845):  at android.app.ActivityThread.access$600(ActivityThread.java:122)
12-14 23:02:21.666: E/AndroidRuntime(845):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1146)
12-14 23:02:21.666: E/AndroidRuntime(845):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-14 23:02:21.666: E/AndroidRuntime(845):  at android.os.Looper.loop(Looper.java:137)
12-14 23:02:21.666: E/AndroidRuntime(845):  at android.app.ActivityThread.main(ActivityThread.java:4340)
12-14 23:02:21.666: E/AndroidRuntime(845):  at java.lang.reflect.Method.invokeNative(Native Method)
12-14 23:02:21.666: E/AndroidRuntime(845):  at java.lang.reflect.Method.invoke(Method.java:511)
12-14 23:02:21.666: E/AndroidRuntime(845):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
12-14 23:02:21.666: E/AndroidRuntime(845):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
12-14 23:02:21.666: E/AndroidRuntime(845):  at dalvik.system.NativeStart.main(Native Method)
12-14 23:02:21.666: E/AndroidRuntime(845): Caused by: java.lang.InstantiationException: can't instantiate class com.sri.alinwallpaper.MyPoint; no empty constructor
12-14 23:02:21.666: E/AndroidRuntime(845):  at java.lang.Class.newInstanceImpl(Native Method)
12-14 23:02:21.666: E/AndroidRuntime(845):  at java.lang.Class.newInstance(Class.java:1319)
12-14 23:02:21.666: E/AndroidRuntime(845):  at android.app.Instrumentation.newActivity(Instrumentation.java:1023)
12-14 23:02:21.666: E/AndroidRuntime(845):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1870)
12-14 23:02:21.666: E/AndroidRuntime(845):  ... 11 more
12-14 23:02:25.496: I/Process(845): Sending signal. PID: 845 SIG: 9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:06:56.020

您可能需要为您的`MyPoint`类提供一个不带参数的构造函数。

就像是

```
public MyPoint() {
    super();
} 
```

发布您的整个代码，以便我们确认是这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:14:40.337

您可以使用 MyPoint() 类对象，并且您不初始化该对象

# javascript - 在jQuery中减慢location.reload（）？

> ID：13883713
> 
> 赞同：1
> 
> 时间：2012-12-14T17:43:09.223
> 
> 标签：javascript, show-hide, jquery

有没有办法放慢速度`location.reload()`？

目前我`.toggle("slow")`在一些和`.hide("slow")`其他中使用 in 来显示模态动画。其中一个函数调用刷新，但动画在重新加载之前没有完成。它开始并完成一半，然后就被切断了。我喜欢让它等到动画完成然后重新加载。

```
$(".modal-box button").click(function(){
    $(".modal-box").hide("slow");
    if ($(this).is("#reset")){
        location.reload();
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:46:15.610

相反，您应该为动画定义一个回调函数，该函数将在动画实际完成时运行。

```
$(".modal-box button").click(function(){
    var self = this; //keep the correct scope
    $(".modal-box").hide("slow", function() {
        if ($(self).is("#reset")){
            location.reload();
        }
    });   
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T17:47:04.363

```
$(".modal-box button").click(function(){
    var self = this;
    $(".modal-box").hide("slow", function(){
        if ($(self).is("#reset")){
            location.reload();
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T17:45:16.193

只需将其设为动画的回调即可：

```
$(".modal-box").hide('slow', location.reload); 
```

# java - 如何在 servlet 中使用 Google 地图？

> ID：13883714
> 
> 赞同：0
> 
> 时间：2012-12-14T17:43:18.523
> 
> 标签：java, javascript, jsp, google-maps, servlets

我是 servlet 和 jsp 的新手，我想使用 Java servlet 或 JSP 制作一个简单的应用程序，使用 Google 地图获取某些地方的位置，然后进行一些计算，然后在网页的地图上显示结果。我可以使用这个请求地点搜索：

`https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=-33.8670522%2C151.1957362&radius=500&types=bus_station&sensor=false&key=YOURAPIKEY.`

它返回一个 JSON 数组，但我不知道如何在 java 代码中调用此链接。或如何将位置从 java 脚本发送到 servlet。

只是我想应用用java编写的算法并从谷歌地图调用数据也返回地图上的输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:47:10.450

您可以使用[URLConnection](http://docs.oracle.com/javase/tutorial/networking/urls/readingWriting.html)从 Java 代码调用链接，使用[XMLHTTPRequest](http://www.w3schools.com/xml/xml_http.asp)将位置从浏览器 (javascript) 发送到 servlet。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T17:52:28.207

使用 HTMLUnit：[http ://htmlunit.sourceforge.net/](http://htmlunit.sourceforge.net/)

它将模拟浏览器操作，因此您可以发布您想要的任何内容并使用适当的方法处理回调。

```
 WebClient webClient = new WebClient();
  webClient.setThrowExceptionOnScriptError(false);

  try {
     UnexpectedPage page = webClient.getPage(url);
     InputStream inputStream = page.getInputStream();
     // Read the stream
  } catch (IOException e) {
     e.printStackTrace();
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-23T16:30:24.083

**使用 Google Maps 和 Ajax (V2 !!)**将地图集成到您的 Java Web 应用程序中

 **[https://today.java.net/pub/a/today/2006/10/25/integrating-google-maps-into-web-application.html](https://today.java.net/pub/a/today/2006/10/25/integrating-google-maps-into-web-application.html)**

# python - 如何使用 I²C 将 Arduino Uno 与 Raspberry Pi 连接

> ID：13883715
> 
> 赞同：4
> 
> 时间：2012-12-14T17:43:28.820
> 
> 标签：python, arduino, raspberry-pi, i2c

我正在尝试使用 I²C 通过[I²C](http://en.wikipedia.org/wiki/I%C2%B2C)接口将数据从[Arduino Uno](http://arduino.cc/en/Main/ArduinoBoardUno)发送到[Raspberry Pi](http://en.wikipedia.org/wiki/Raspberry_Pi)。这是我使用的代码。

在阿杜诺：

```
#include <Wire.h>
unsigned int watt;
unsigned int watt1;
byte watt2;
byte watt3;
void setup()
{
    Wire.begin(30);
    Wire.onRequest(requestEvent);
    Serial.begin(9600);
}

void loop() {
    delay(100);
    int sensorValue = analogRead(A0);
    int sensorValue1 = analogRead(A1);
    watt = sensorValue * (5 / 1023) * 2857;
    watt1 = sensorValue1 * (5 / 1023) * 2857;
    watt2 = map(watt, 0, 4294967295, 0, 255);
    watt3 = map(watt1, 0, 4294967295, 0, 255);
    Serial.println(watt2);
    Serial.println(watt3);
}

void requestEvent()
{
    Wire.write(watt2);
    delay(30);
    Wire.write(watt3);
} 
```

在树莓派中：

```
import smbus
import time
bus = smbus.SMBus(0)
address = 0x1e
while (1):
    watt=bus.read_byte_data(address,1)
    watt2=bus.read_byte_data(address,2) 
```

我收到以下错误。

> 回溯（最后一次调用）：
> 文件 "/home/pi/i2ctest.py" ，第 8 行，在 <module>
> watt = bus.read_byte_data(address,1)
> IOError: [Errno 5] Input/Output error

我该如何解决？此外，除了 SMBus 库之外，在 Raspberry Pi 中使用 I²C 是否还有其他选择？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:23:11.107

如果您有一个带有 2.0 版板的 Raspberry Pi，您需要使用 I²C 总线 1，而不是总线 0，因此您需要更改使用的总线编号。在这种情况下，行

```
bus = smbus.SMBus(0) 
```

会成为

```
bus = smbus.SMBus(1) 
```

您可以使用 i2ctools 包中的 i2cdetect 程序检查设备是否存在于总线上。尝试

```
i2cdetect 0 -y 
```

在总线 0 上寻找 Arduino。运行

```
i2cdetect 1 -y 
```

在总线 1 上查找它。当然，必须运行 Arduino 程序才能使其正常工作。这也将确认 Arduino 存在于预期的地址。

您还需要确保您拥有使用 I²C 的适当权限，因此请从该`i2c`组成员的帐户运行您的 Python 程序。

# mercurial - 如何找到合并到 Mercurial 中另一个分支的分支的最新变更集

> ID：13883718
> 
> 赞同：0
> 
> 时间：2012-12-14T17:43:42.377
> 
> 标签：mercurial

我在`dev`命名分支中有一些匿名分支，最终将合并到`default`分支中。如何找到`dev`已经合并到`default`分支中的分支的最新变更集？

这就是我想出的：

1.  我首先显示`default`分支中的所有合并：

    ```
    merge() and branch(default) 
    ```

2.  我真正想要的是他们在`dev`分支机构的父母：

    ```
    parents(merge() and branch(default)) and branch(dev) 
    ```

3.  这给了我所有`dev`合并到`default`分支中的变更集。现在我只是添加`max`以获得最新的。这是最终的表达式：

    ```
    max(parents(merge() and branch(default)) and branch(dev)) 
    ```

问题是我认为这个查询太大了。是否可以通过更简单的查询获得这些信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T20:05:43.467

我认为这会做到：

```
max(p2(branch(default)) & branch(dev)) 
```

它获取分支`dev`上变更集的第二个父项的变更集，并获取最新的变更集。`default``max`

不过，这只是一个较短的条件（因为该`p2`条件有效地结合了查询的`parent`and `merge`，因为如果您不是合并，则不能成为第二个父项）。

# azure - 以编程方式启动/停止 Azure 报告服务

> ID：13883720
> 
> 赞同：1
> 
> 时间：2012-12-14T17:43:47.463
> 
> 标签：azure, reporting-services

我有一个客户希望将他们的 SSRS 实例迁移到 Azure，以使临时报告可用于 Internet。由于它们的规模和预算，让 Azure 报告服务 100% 运行并不是真正可行的选择。

理想情况下，我们希望能够启动服务、运行报告、发布报告，然后以最少的手动过程停止服务。该报告的大多数用户并不精通技术。

新的 Azure 管理门户不允许管理 Reporting 服务，旧的管理门户只有创建/销毁实例。所以它总是打开或什么都没有。

有没有其他人冒险进入这个兔子洞并通过 Azure API 自动化该过程，或者这甚至可能吗？

# android - Android seekbar 更改文本+格式editText

> ID：13883722
> 
> 赞同：0
> 
> 时间：2012-12-14T17:43:50.677
> 
> 标签：android

当 seekbar 更改时，我想更新 editText 并更改进度（这已成功实现）。现在我如何以 $currency 格式格式化 editText 值，例如 $200,000。搜索栏与此类似。

```
 SeekBar sk=(SeekBar)findViewById(R.id.seekBar1);

    final EditText tv=(EditText)findViewById(R.id.EditText1);

    sk.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {

                 public void onStopTrackingTouch(SeekBar arg0) {
                       // TODO Auto-generated method stub

                 }

                 public void onStartTrackingTouch(SeekBar arg0) {
                       // TODO Auto-generated method stub

                 }

                 public void onProgressChanged(SeekBar arg0, int arg1, boolean arg2) {
                       // TODO Auto-generated method stub
                       tv.setText("Seek bar value is"+ arg1);

                 }
          }); 
```

我只想知道在哪里格式化editText以将天数显示为$ 200,000 ..当seekbar更改时？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:47:55.697

您可以使用[`DecimalFormat`](http://docs.oracle.com/javase/6/docs/api/java/text/DecimalFormat.html)

```
public void onProgressChanged(SeekBar arg0, int arg1, boolean arg2) {
    // TODO Auto-generated method stub

    DecimalFormat df = new DecimalFormat("$###,###");

    String value = df.format(arg1);

    System.out.println(value);
    // will output "$200,000"  if arg1 = 200000    

    tv.setText("Seek bar value is "+ value);
} 
```

# c# - 与现有 Oracle 安装一起部署 Oracle Instant Client

> ID：13883728
> 
> 赞同：1
> 
> 时间：2012-12-14T17:44:11.597
> 
> 标签：c#, asp.net-mvc, oracle, odp.net

我开发了一个使用实体框架访问 Oracle 数据库的新应用程序。使用最新版本的 ODP.NET，这在本地按预期工作。我现在正尝试将此应用程序部署在运行许多其他遗留应用程序的生产服务器上。理想情况下，我希望我的新应用程序能够使用它自己的 ODP.NET / Oracle dll，而不必更改产品服务器上现有的 Oracle 安装。

我遵循了本指南：

[http://jeremybranham.wordpress.com/2011/04/25/oracle-instant-client-with-odp-net/](http://jeremybranham.wordpress.com/2011/04/25/oracle-instant-client-with-odp-net/)

根据评论，这似乎取得了一些成功。

但是，尝试创建实体对象时出现以下异常：

**外部异常**

```
Exception has been thrown by the target of an invocation. 
```

**内部异常**

```
The type initializer for 'Oracle.DataAccess.Client.OracleClientFactory' threw an exception.
at System.RuntimeFieldHandle.GetValue(RtFieldInfo field, Object instance, RuntimeType fieldType, RuntimeType declaringType, Boolean& domainInitialized)
at System.Reflection.RtFieldInfo.InternalGetValue(Object obj, Boolean doVisibilityCheck, Boolean doCheckConsistency)
at System.Reflection.RtFieldInfo.GetValue(Object obj)
at System.Data.Common.DbProviderFactories.GetFactory(DataRow providerRow)
at System.Data.Common.DbProviderFactories.GetFactory(String providerInvariantName)
at System.Data.EntityClient.EntityConnection.GetFactory(String providerString)
at System.Data.EntityClient.EntityConnection.ChangeConnectionString(String newConnectionString)
at System.Data.EntityClient.EntityConnection..ctor(String connectionString)
at System.Data.Objects.ObjectContext.CreateEntityConnection(String connectionString)
at System.Data.Objects.ObjectContext..ctor(String connectionString, String defaultContainerName)
at MyAppMVC.Models.DataModels.STSProcedureEntities..ctor()
at MyAppMVC.Services.MyService.GetPersons(String lastName) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T13:44:09.273

尽管您似乎通过安装额外的客户端解决了您的问题，但您可能已经在 app / web.config 文件中添加了以下配置。

```
 <system.data>
    <DbProviderFactories>
      <remove invariant="Oracle.DataAccess.Client" />
      <add name="Oracle Data Provider for .NET" invariant="Oracle.DataAccess.Client" description="Oracle Data Provider for .NET"
           type="Oracle.DataAccess.Client.OracleClientFactory, Oracle.DataAccess, Version=2.112.3.0, Culture=neutral, 
           PublicKeyToken=89b483f429c47342"/>
    </DbProviderFactories>
  </system.data> 
```

并将二进制文件放在本地 bin 文件夹中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T15:35:23.620

在这里回答我自己的问题。我们最终安装了 Oracle 的第二个版本，使用将新版本放入 client_2 文件夹的默认设置。

*   D:\oracle\product\11.2.0\client（旧版）
*   D:\oracle\product\11.2.0\client_2（新版本）

唯一的附加安装步骤是将之前的 TNSNAMES.ORA 文件放入新的 client_2 中。该文件使用上面的文件路径位于 client\network\admin 中。

因为我们所有的应用程序都设置为专门寻找其正确的 Oracle 版本 (SpecificVersion=true)，所以大部分工作都无需修改。对于那些没有的，我们必须将旧版本的 Oracle.DataAccess.dll（来自客户端，而不是 client_2）放入该应用程序的 bin 文件夹中。

# c# - Visual Studio 中的 ANTLR 语法高亮显示 DSL

> ID：13883732
> 
> 赞同：7
> 
> 时间：2012-12-14T17:45:02.287
> 
> 标签：c#, visual-studio, antlr, syntax-highlighting, dsl

我有一个定义 DSL（领域特定语言）的 ANTLR 语法。这个语法比较简单。它正在解析语言并输出 C 代码以创建一个非常基本的翻译器。

该语言旨在用于 C# 应用程序（输入某种控件，无论是 RichTextBox 还是自定义控件），并且一个要求是该语言的语法突出显示。我搜索了互联网，希望能找到一些关于如何完成此任务的信息，或者找到一种工具来让我自己更轻松一些。

在没有找到太多信息之后，我最好的假设是我需要使用 ANTLR 生成的词法分析器来查看标记并相应地为它们着色。这是正确的行动路径，还是有其他方法/工具可以为自定义域特定语言提供语法突出显示？如果这是正确的方法，我该如何识别特定的令牌？

如果我遗漏了任何重要信息，请询问！谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T20:09:03.427

我成功地将[AvalonEdit](http://www.codeproject.com/Articles/42490/Using-AvalonEdit-WPF-Text-Editor)用于我的一个类似项目。我刚刚创建了一个带有正确语法突出显示的小编辑器。

在您的项目中启动和运行它非常简单快捷。您只需为其提供一个简单的 XML 文件来记录您的 DSL 的语法，并且您将拥有一个开箱即用的彩色输出作为 WPF 控件。

自从我使用以来，他们似乎增加了完成设施，虽然我没有这方面的经验，但我怀疑如果质量与着色相同，它也做得很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T19:44:52.030

> 该语言旨在用于 C# 应用程序（输入某种控件，无论是 RichTextBox 还是自定义控件），并且一个要求是该语言的语法突出显示。

考虑使用[Scintilla](http://www.scintilla.org)进行控制。它是用于 IDE 样式文本编辑的文本控件。[Notepad++](http://notepad-plus-plus.org/)使用它来进行文本控制，就像它起源的 SciTE IDE 一样。我在一个用 C# 编写的小型自定义 IDE 项目中使用了它，使用了一个非官方的 .NET 特定版本——我认为它是[ScintillaNET](https://scintillanet.codeplex.com/)。

Scintilla 支持自定义关键字突出显示以及各种可编程功能，如波浪线下划线等。

* * *

如果您有一个更喜欢使用的控件，我认为使用小型 ANTLR 词法分析器为您生成标记是合理的。每个标记都包含行号、起始字符位置、源文本和标记类型——您需要知道要突出显示什么以及如何突出显示的所有内容。每次更改文本时，唯一的麻烦就是通过词法分析器运行文本。有一些有效的方法可以做到这一点，而无需重新分析整个文档，但仍然需要牢记这一点。

# php - Yii::app()->name 是否缓存在 yii 上？

> ID：13883735
> 
> 赞同：3
> 
> 时间：2012-12-14T17:45:12.283
> 
> 标签：php, yii

Yii::app()->name 是否缓存在 yii 上？经常使用它好吗？我决定在我的布局上使用自定义页面标题，并在我的控制器上使用它。

```
$this->pageTitle = Yii::app()->name . ":" . $action 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-14T18:13:22.023

它没有*被缓存*缓存，但可以随心所欲地使用它。从[指南](http://www.yiiframework.com/doc/guide/1.1/en/basics.application)：

> 应用程序对象由入口脚本实例化为单例。通过 Yii::app() 可以在任何地方访问应用程序单例。

所以对象已经存在，你只是访问它来读取`name`属性。

* * *

**更新**：为了更好地理解这一点，让我们跟踪[应用程序生命周期](http://www.yiiframework.com/doc/guide/1.1/en/basics.application#application-life-cycle "http://www.yiiframework.com/doc/guide/1.1/en/basics.application#application-life-cycle")：

*   入口脚本*index.php*创建应用程序，[使用`Yii::createWebApplication`](http://www.yiiframework.com/doc/api/1.1/YiiBase#createWebApplication-detail "http://www.yiiframework.com/doc/api/1.1/YiiBase#createWebApplication-detail").
*   `Yii::createWebApplication`调用[`Yii::createApplication`](http://www.yiiframework.com/doc/api/1.1/YiiBase#createApplication-detail "http://www.yiiframework.com/doc/api/1.1/YiiBase#createApplication-detail")，然后创建一个新的 CWebApplication 对象，这意味着它的**构造函数**（[在父 CApplication 中定义](http://www.yiiframework.com/doc/api/1.1/CApplication#__construct-detail "http://www.yiiframework.com/doc/api/1.1/CApplication#__construct-detail")）被调用。**此构造函数设置应用程序单例对象**：

    ```
    Yii::setApplication($this); 
    ```

    然后它执行生命周期的前 4 个步骤，它们是（来自[上面的应用程序生命周期链接](http://www.yiiframework.com/doc/guide/1.1/en/basics.application#application-life-cycle "http://www.yiiframework.com/doc/guide/1.1/en/basics.application#application-life-cycle")）：

    1.  [使用CApplication::preinit()](http://www.yiiframework.com/doc/api/1.1/CApplication#preinit "http://www.yiiframework.com/doc/api/1.1/CApplication#preinit")预初始化应用程序；IE：`$this->preinit();`
    2.  设置类自动加载器和错误处理；IE[`$this->initSystemHandlers();`](http://www.yiiframework.com/doc/api/1.1/CApplication#initSystemHandlers-detail "http://www.yiiframework.com/doc/api/1.1/CApplication#initSystemHandlers-detail")
    3.  注册核心应用组件；IE[`$this->registerCoreComponents();`](http://www.yiiframework.com/doc/api/1.1/CApplication#registerCoreComponents-detail "http://www.yiiframework.com/doc/api/1.1/CApplication#registerCoreComponents-detail")
    4.  加载应用程序配置；即[`$this->configure($config);`](http://www.yiiframework.com/doc/api/1.1/CModule#configure-detail "http://www.yiiframework.com/doc/api/1.1/CModule#configure-detail")。这设置了`name`.
    5.  附加行为；即 加载静态应用组件；ie用ie 初始化应用程序[`$this->attachBehaviors($this->behaviors);`](http://www.yiiframework.com/doc/api/1.1/CComponent#attachBehaviors-detail "http://www.yiiframework.com/doc/api/1.1/CComponent#attachBehaviors-detail")
        [`$this->preloadComponents();`](http://www.yiiframework.com/doc/api/1.1/CModule#preloadComponents-detail "http://www.yiiframework.com/doc/api/1.1/CModule#preloadComponents-detail")
        `CApplication::init();`[`$this->init();`](http://www.yiiframework.com/doc/api/1.1/CWebApplication#init-detail "http://www.yiiframework.com/doc/api/1.1/CWebApplication#init-detail")

    创建的应用程序**对象**由`createApplication`to返回`createWebApplication`。

*   然后使用相同的**对象**调用入口脚本中的[`run()`方法：](http://www.yiiframework.com/doc/api/1.1/CApplication#run-detail "http://www.yiiframework.com/doc/api/1.1/CApplication#run-detail")

    ```
    Yii::createWebApplication($config)->run(); 
    ```

    然后该`run`方法执行生命周期的其余部分：

    1.  (6) 发起`onBeginRequest`事件；IE：`$this->onBeginRequest(new CEvent($this));`

    2.  (7) 处理用户请求（带[`$this->processRequest();`](http://www.yiiframework.com/doc/api/1.1/CWebApplication#processRequest-detail "http://www.yiiframework.com/doc/api/1.1/CWebApplication#processRequest-detail")）：

        *   收集有关请求的信息；
        *   创建一个控制器；
        *   运行控制器；

            因此，当您的控制器正在运行时，如果您调用在构造函数中创建并设置`Yii::app()`的**相同对象**`createApplication`，则会使用，因此不会创建新对象，并且只是从现有对象中获取属性。

    3.  (8) 发起`onEndRequest`事件；IE：`$this->onEndRequest(new CEvent($this));`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-11T10:52:22.687

> 经常使用它好吗？

不，这不好，因为如果有一天您需要修改您的应用名称，那么您在每个控制器中更改它都会有问题。我想更好的方法是`Yii::$app->name`直接在`layout`.

在您的布局开始时，可​​能在`views/layout/main.php`添加

```
Yii::$app->name = Yii::$app->name . ':' . Yii::$app->getView()->id; 
```

# php - URL 路由和目录重定向

> ID：13883736
> 
> 赞同：0
> 
> 时间：2012-12-14T17:45:13.850
> 
> 标签：php, apache, url-routing, slim

考虑以下与 PHP 框架 (Slim Framework v2.0.0) 一起使用的代码行：

```
$app->get( '/bootstrap/(:page/?)', function ( $page = NULL ) use ( $app ) {
    if ( $page == NULL ) {
        $page = 'index';
    }
    $app->render( 'bootstrap-tests/' . $page . '.tpl' );
}); 
```

在 XAMPP 上运行它可以像预期的那样工作：

/bootstrap 重定向到 /bootstrap/

/bootstrap/ 工作正常

/bootstrap/css-tests 工作正常

现在，在生产服务器上运行完全相同的代码，`/bootstrap`停止工作（不再重定向到 /bootstrap/）和 404s。

生产服务器是 Linux 服务器。我在那里查看了 .htaccess 指令（以便将它们与 XAMPP 进行比较），但没有看到任何关于重定向的特别之处。

我不确定这是框架的事情还是 Apache 的事情。欢迎比我在框架和 URL 路由方面更有经验的人提供任何反馈。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-06T17:42:15.790

您的开发环境应该与生产环境相匹配。否则，您还不如在生产中进行开发。您只是通过不使它们相同来引入一罐蠕虫。查看Virtualbox。使用 Vagrant for Virtual Box，您可以在几分钟内轻松启动 VM。

# javascript - 引导选项卡：订阅事件

> ID：13883739
> 
> 赞同：0
> 
> 时间：2012-12-14T17:45:21.623
> 
> 标签：javascript, events, twitter-bootstrap, tabs

我对js的了解非常有限。我已经阅读了官方文档和网络上的几个主题。我还是有一些问题。我需要以编程方式显示选项卡，因为在显示选项卡时我必须执行一些操作。

根据 twitter bootstrap 文档，这里有一小段代码：

```
 <ul id="tabs" class="nav nav-tabs">
        <li><a href="#state">State</a></li>
        <li><a href="#graph">Graph</a></li>
        <li><a href="#setup">Setup</a></li>
    </ul>
    <div class="tab-content">
        <div id="state" class="tab-pane fade">
        </div>
        <div id="graph" class="tab-pane fade">
        </div>  
        <div id="setup" class="tab-pane fade">
        </div>
    </div>

<script src="http://code.jquery.com/jquery-latest.js"></script>

<script>
$('#tabs a').click(function (e) {
  e.preventDefault();
  console.log("Activating a tab");
  $(this).tab('show');
})

$('a[data-toggle="tab"]').on('shown', function (e) {
    console.log("Tab activated");
    e.target // activated tab
    e.relatedTarget // previous tab
})
</script> 
```

第一个脚本激活每个选项卡 - 它正在工作。第二个应该订阅 'shown' 事件，并且 e.target 应该包含已激活选项卡的引用。

我收到第一条控制台消息（“激活选项卡”），但没有收到第二条消息。所以我敢打赌，我缺少正确订阅该活动的一些东西。

我无法理解的两个问题。为了让这些东西正常工作，我不能使用 js 来激活选项卡，而只能依赖引导数据切换项。另一个奇怪的事情是只有'show'事件会触发，'shown'不会。你知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T21:54:24.643

您需要添加`data-toggle="tab"`到您的链接。所以你的第一部分应该重写如下

```
<ul id="tabs" class="nav nav-tabs">
    <li><a data-toggle="tab" href="#state">State</a></li>
    <li><a data-toggle="tab" href="#graph">Graph</a></li>
    <li><a data-toggle="tab" href="#setup">Setup</a></li>
</ul> 
```

然后您应该能够`Tab activated`在控制台中看到您的消息。

# go - 使用 Go 中单独文件中定义的代码

> ID：13883743
> 
> 赞同：0
> 
> 时间：2012-12-14T17:45:45.577
> 
> 标签：go

假设我有一个项目的代码分布在多个文件中。有没有其他方法可以在项目文件中引用此类代码，而无需经历整个构建和安装过程？例如，在单个项目中，我可能在文件 A 中有一个 Foo 类型的实现，我可能想在同一个项目中的文件 B 中使用这种类型。有没有办法去做那件事

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:02:37.913

我不清楚您到底在问什么，但是关于[“声明和范围”](http://golang.org/ref/spec#Declarations_and_scope)的语言规范的这一部分可能是相关的和/或有帮助的。另一个更普通的相关信息来源可能是[“如何编写 Go 代码”](http://golang.org/doc/code.html)。

编辑 - 扩展现在扩展的问题：

如果“package a”声明了类型`Foo`——那么，b/c`Foo`以大写字母开头——`Foo`由.export*导出*。`a`然后在“包 b”中，人们会写`import "a"`，然后可以在“包 b”中引用该类型`a.Foo`。

# php - 获取未指定的 $_POST 数据

> ID：13883744
> 
> 赞同：2
> 
> 时间：2012-12-14T17:46:05.750
> 
> 标签：php, post

我想知道是否可以在不指定键的情况下获取 POST 数据，就像使用 print_r($_GET) 一样，前提是 URL 中有参数。

例如，如果“my-page.php”对名为“destination-page.php”的页面有一个表单操作，但表单中的输入具有随机名称，“destination-page.php”将如何选择这些值并回应他们？我尝试了 print_r($_POST) 没有成功。

我的页面.php

```
<!DOCTYPE HTML>
<html>
<body>

<form name="foobar" method="POST" action="destination-page.php">
    Input 1: <input type="text" name="<? echo substr(md5(mt_rand()), rand(4,12)); ?>" />
    Input 2: <input type="text" name="<? echo substr(md5(mt_rand()), rand(4,12)); ?>" />
    <input type="submit" />
</form>

</body>
</html> 
```

目标页面.php

```
<!DOCTYPE HTML>
<html>
<body>
<?
    $values_array = array();

    foreach($_POST as $val)
        $values_array[$i++] = $val;

    echo(http_post_data('http://www.foobar.com/destination-page.php', $values_array));
?>
</body>
</html> 
```

任何输入表示赞赏。显然，这个问题更多是基于“这可能吗？” 而不是“这是务实的吗？”。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:49:04.773

您快到了！试试这个：

```
foreach($_POST as $key => $value)  {
    echo "POST " . $key . " = " . $value;   
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T17:50:50.927

由于[$_POST](http://php.net/manual/en/reserved.variables.post.php)是一个数组，您也可以将它用作任何其他数组。虽然我会将循环更改为

```
foreach($_POST as $val)
    $values_array[] = $val; 
```

对于[http_post_data](http://php.net/manual/en/function.http-post-data.php)，您必须`data`以字符串形式给出。如果您想使用该数组，请查看[http_post_fields](http://php.net/manual/en/function.http-post-fields.php)。

# ruby-on-rails - 链接到具有属性的命名范围

> ID：13883746
> 
> 赞同：-2
> 
> 时间：2012-12-14T17:46:10.650
> 
> 标签：ruby-on-rails, named-scope

经过一个下午的网络搜索。我得问你。

在我的应用程序中，我有一个与一个或多个平台相关联的游戏列表。我想向用户提出一些基于平台的过滤器。

我知道我必须使用具有属性的命名范围。但我不知道如何制作链接

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:22:56.817

如果您使用`:has_and_belongs_to_many`惰性方法来执行此操作，则获取所有平台并游戏所有游戏的 uniq 数组：

```
@games = @plataforms.map(&:games).uniq 
```

如果您使用`:has_many`：

```
# in your game model
scope :by_plataforms, lambda { |plataforms_ids| where(:plataform_id => plataforms_ids) } 
```

示例调用：`Game.by_plataforms([1, 2, 3])`

**编辑**

要创建路由，您可以使用 GamesController 中的参数按平台过滤：

```
def index
  @games = params[:plataform] ? Plataform.find(params[:plataform]).games : Game.all
end 
```

在意见中：

```
<%= link_to games_path(:plataform => @plataform.id) %> 
```

# visual-studio - Visual Studio 生成事件 xml 展开

> ID：13883749
> 
> 赞同：0
> 
> 时间：2012-12-14T17:46:32.290
> 
> 标签：visual-studio, post-build-event

我在构建后事件中调用一个工具来创建 MAML 文档。该工具具有可以是 XML 的参数。问题是当我在构建后事件中使用 xml 时，它会被扩展：

```
my_tool "blah <codeInline>test</codeInline>" 
```

扩展为

```
my_tool "blah <codeInline xmlns="http://schemas.microsoft.com/developer/msbuild/2003">test</codeInline>" 
```

这是一个大问题，因为添加了 " （另外我很确定 xmlns 在这里不是正确的）。

如何防止 Visual Studio 创建 xmlns？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:47:57.813

使用变量：

```
SET CODE_INLINE=codeInline
my_tool "blah <%CODE_INLINE%>test</%CODE_INLINE%>" 
```

请注意，SET 不能放在 IF / FOR / ... 内，否则变量将不包含任何内容。

# jquery - ASP.NET MVC 在回发时保留下拉列表的值

> ID：13883750
> 
> 赞同：0
> 
> 时间：2012-12-14T17:46:41.743
> 
> 标签：jquery, asp.net-mvc

我是 ASP.NET MVC 的新手。我正在视图上显示记录列表。还有一个下拉列表，用于控制要在页面上显示的记录数，选项为 10、20 和 50。

为了实现这一点，我正在使用 jquery 更改事件触发我的控制器对下拉更改的操作。以下是我的 java 脚本代码：-

```
$('select[name="pagingCount"]').on('change', function (ev) {
            ev.preventDefault();
            var pagingCount = $('select[name="pagingCount"]').val();
            var url = '@Url.Action("Action","Controller")?pagingCount=' + pagingCount;
            window.location = url;
        }); 
```

它工作正常。但我想在页面重新加载后保留选定的值。我不知道该怎么做？由于下拉不属于任何模型属性。任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:04:21.780

您应该能够根据`pagingCount`url 中的参数设置下拉列表的值

```
function getParameterByName(name)
{
  name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
  var regexS = "[\\?&]" + name + "=([^&#]*)";
  var regex = new RegExp(regexS);
  var results = regex.exec(window.location.search);
  if(results == null)
    return "";
  else
    return decodeURIComponent(results[1].replace(/\+/g, " "));
}
$(function(){
  $('select[name="pagingCount"]').val(getParameterByName("pagingCount"));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:59:35.707

您可能已经在您的操作方法中使用了 pagingCount 参数。

您现在需要做的就是将该值传递给您的视图（最好通过在您的 ViewModel 中设置属性）并让视图在下拉列表中设置选定的值。

# symfony - FOSUserBundle 禁止编辑用户名

> ID：13883753
> 
> 赞同：0
> 
> 时间：2012-12-14T17:46:49.537
> 
> 标签：symfony, fosuserbundle

如何禁止在 FOSUserBundle 中编辑用户名？

现在我可以进入个人资料编辑页面并更改用户名。例如，如何仅允许 ROLE_ADMIN 这样做？

但允许在个人资料中编辑电子邮件。

找到解决方案：

```
class ProfileFormType extends BaseType
{
public function buildForm(FormBuilderInterface $builder, array $options)
{
    parent::buildForm($builder, $options);

    $builder->remove('username');
}

public function getName()
{
    return 'goock_user_profile';
}
} 
```

它安全吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:21:05.647

In order for you to allow only ROLE_ADMIN to edit a form field, you'll need to pass the "security.context" service into your form type, and then do something like the following

```
if ($this->securityContext->isGranted('ROLE_ADMIN')) {
   $builder->add('username');
}

//or if username is already added

if (!$this->securityContext->isGranted('ROLE_ADMIN')) {
   $builder->remove('username');
} 
```

# cucumber - Cucumber 无法为文件加载“yml”编程语言

> ID：13883754
> 
> 赞同：5
> 
> 时间：2012-12-14T17:46:50.853
> 
> 标签：cucumber, yaml, watir-webdriver, rubymine

当我尝试使用 watir-webdriver 步骤定义运行 Cucumber 场景时出现以下错误：

```
Failed to load 'yml' programming language for file .../features/support/config.yml:
cannot load such file -- cucumber/yml_support/yml_language
* .../features/support/config.yml [NOT SUPPORTED]
* .../features/support/lib/configuration.rb 
```

我的 config.yml 文件的内容如下：

```
:browser: :chrome
:url: http://example.com 
```

以上显然是有效的yaml。

我不明白为什么 Cucumber 说这不受支持。有什么想法吗？？

另外 - 似乎这可能是一个 RubyMine 问题，因为当我通过终端运行黄瓜功能时，我没有看到这个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-24T10:03:14.953

我已经面临这个问题。但是我修改了 yaml 文件的键和值。现在它工作正常。

您能否在您的 yaml 文件中尝试以下内容。

> 浏览器：铬
> 
> 网址：“ [http://example.com](http://example.com) ”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-05T10:39:27.030

try in this manner

```
browser: chrome
url: http://example.com 
```

and for browser you will need to convert the string into symbol like this

```
browser.to_sym 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-04T15:15:47.920

在详细模式下运行时，您可能会在控制台日志中看到此错误。

以非详细模式运行它。

# php - 如何在不刷新的情况下获得相同的输入值

> ID：13883755
> 
> 赞同：0
> 
> 时间：2012-12-14T17:46:49.017
> 
> 标签：php, ajax

我有输入类型和按钮，当我需要通过 ajax 单击下一个图像来选择项目时，我将获取该项目的 id 并将其放入输入类型，我不会使用它来打印该项目

```
<input name="print" type="submit" id="print" value="Print" class="css3buttonblue"  onclick="window.open('BillsPrint.php?bills_ID=<?php echo $_POST['bills_ID']?>', '_blank')" /> 
```

这里的问题我无法从输入类型中获取 id 值`'BillsPrint.php?bills_ID=<?php echo $_POST['bills_ID']?>'`

如何在`BillsPrint.php?bills_ID=<?php echo $_POST['bills_ID']?>`不刷新页面的情况下将 id 放在此链接上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:55:40.420

为什么不直接使用`this`来访问元素本身。
无论如何你都在使用 JavaScript，所以这应该是安全的：

```
'BillsPrint.php?bills_ID=<?php echo $_POST['bills_ID']?>&input_id=' + this.id 
```

# c# - 带有表达式树的你好世界

> ID：13883756
> 
> 赞同：3
> 
> 时间：2012-12-14T17:46:56.580
> 
> 标签：c#, .net, lambda, linq-expressions

我正在尝试掌握表达式树。我想我会先编写一个简单的`helloWorld`函数来创建 a `StringBuilder`， appends `"Helloworld"`，然后输出字符串。这是我到目前为止所拥有的：

```
var stringBuilderParam = Expression.Variable
    typeof(StringBuilder), "sb");

var helloWorldBlock =
    Expression.Block( new Expression[]
        {
            Expression.Assign(
                stringBuilderParam, 
                Expression.New(typeof(StringBuilder))),
            Expression.Call(
                stringBuilderParam,
                typeof(StringBuilder).GetMethod(
                    "Append",
                    new[] { typeof(string) }),
                new Expression[]
                    {
                        Expression.Constant(
                            "Helloworld", typeof(string))
                    }),
            Expression.Call(
                stringBuilderParam,
                "ToString",
                new Type[0],
                new Expression[0])
        });

var helloWorld = Expression.Lamda<Func<string>>(helloWorldBlock).Compile();

Console.WriteLine(helloWorld);
Console.WriteLine(helloWorld());
Console.ReadKey(); 
```

`Compile()`投掷_`InvalidOperationException`

> 从范围“”引用的“System.Text.StringBuilder”类型的变量“sb”，但未定义

显然，我不会以正确的方式解决这个问题。有人可以指出我正确的方向吗？

* * *

显然，我意识到这样做`Console.WriteLine("HelloWorld");`会更简单一些。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:06:27.047

您需要指定变量`BlockExpression`才能使用它们。只需调用[另一个重载](http://msdn.microsoft.com/en-us/library/dd324074.aspx)：

```
var helloWorldBlock =
    Expression.Block(
        new ParameterExpression[] {stringBuilderParam},
        new Expression[]
            {
                Expression.Assign(
                    stringBuilderParam,
                    Expression.New(typeof (StringBuilder))),
                Expression.Call(
                    stringBuilderParam,
                    typeof (StringBuilder).GetMethod(
                        "Append",
                        new[] {typeof (string)}),
                    new Expression[]
                        {
                            Expression.Constant(
                                "Helloworld", typeof (string))
                        }),
                Expression.Call(
                    stringBuilderParam,
                    "ToString",
                    new Type[0],
                    new Expression[0])
            }); 
```

# google-app-engine - 无法访问我的新 apppot 应用

> ID：13883757
> 
> 赞同：1
> 
> 时间：2012-12-14T17:46:57.553
> 
> 标签：google-app-engine, gwt

我在 google appengine 中创建了一个新的 apppot 应用程序。但是当尝试通过其 url 访问该应用程序时，它返回 404 错误。是否需要进行任何其他设置？

以下是我的应用程序网址[应用程序](http://inspironinventory.appspot.com/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:09:36.700

您需要使用一些代码部署应用程序。

# php - 通过 php 将 JSON 对象的多个版本发送到 JQuery 的最佳方式

> ID：13883759
> 
> 赞同：0
> 
> 时间：2012-12-14T17:47:01.010
> 
> 标签：php, jquery, json

我想在读取文本文件时发送 JSON 对象的多次迭代。我想读取文件并将每次迭代存储在一个对象中。我在客户端的目标是遍历对象。我的以下方法是否理想？

```
<?php

$myFile = $_GET['filename'];

$file = fopen($myFile, "r");
$$response = "[ ";

$data = array();
$json = array();
while (!feof($file))
{
   $row = array();
   $currentLine = fgets($file);
   $parts = explode(" ", $currentLine);
   $length = sizeof($parts);
      $time = $parts[0];
      $where = $parts[$length-1];
   $json['where'] = $where;
   $json['time'] = $time;   
   $data[] = $json;
}

echo json_encode($data);
?> 
```

# java - 使用java的HTML解析器的简单CSS属性

> ID：13883765
> 
> 赞同：-4
> 
> 时间：2012-12-14T17:47:29.217
> 
> 标签：java, html, css, regex, parsing

我试图解析简单`<font>`标签的样式属性并将其转换回简单的 html 属性。例如，我有这个字符串`<font style="font-family:tahoma;font-size:24px;color:#9900CC;">`，我想以某种方式将其转换为`<font size="24" color="#9900CC" face="tahoma">`我知道这可以用正则表达式完成，但我不知道怎么做？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T09:15:47.170

所以这是迄今为止我所做的最简单的解决方案，它是一个肮脏的解决方案，但它就像一个魅力：

```
static public String convertCSSFonttoHTML(String css)
{

    List<List<String>> allFontTags = regexFindMultiStrings("<font[^>]*(style=['\"][^'\"]+['\"])[^>]*>", css);
    String allAttributes = "";

    for(int y=0; y<allFontTags.size(); y++)
    {
        String style = allFontTags.get(y).get(0);
        String size = regexFindString("font-size:([^0-9]+)", style);
        String color = regexFindString("color:([^;]+);", style);
        String face = regexFindString("font-family:([^;]+)", style);

        if(!size.isEmpty())
             allAttributes += "size=\""+size+"\" ";

        if(!color.isEmpty())
             allAttributes += "color=\"" + color + "\" ";

        if(!size.isEmpty())
             allAttributes += "face=\""+face+"\"";

        //do replacements to the first occurance
        css = css.replaceFirst(style, allAttributes);

        //empty atts
        allAttributes = "";
    }

    //Log.e("Regex", css);

    return css;

} 
```

# sql - 如果该表包含相关数据，Netezza SQL 将加入该表

> ID：13883766
> 
> 赞同：5
> 
> 时间：2012-12-14T17:47:29.543
> 
> 标签：sql, netezza

我正在尝试根据指定时间范围内的某些列连接表。我已经尝试了几种方法，但都无法解决这个问题。

我从一个简单的查询开始：

```
SELECT *
FROM admin.mktdmtunit c
WHERE c.unitid IN ('2756')
AND c.calledofftime between to_timestamp('2012-12-05 05:00:01','yyyy-mm-dd hh:mi:ss') 
    AND to_timestamp('2012-12-06 05:00:00','yyyy-mm-dd hh:mi:ss') 
```

返回 1 行。

然后我添加另一个表：

```
 SELECT *
    FROM admin.mktdmtunit c
    INNER JOIN admin.mktmanualdispatch_all mrd 
    ON c.unitid = mrd.unitid
    where c.unitid in ('2756')
    AND (c.calledofftime between to_timestamp('2012-12-05 05:00:01','yyyy-mm-dd hh:mi:ss') 
        and to_timestamp('2012-12-06 05:00:00','yyyy-mm-dd hh:mi:ss')
        OR mrd.effectivetime  between to_timestamp('2012-12-05 05:00:01','yyyy-mm-dd           hh:mi:ss') 
            and to_timestamp('2012-12-06 05:00:00','yyyy-mm-dd hh:mi:ss')) 
```

根据该 unitid 的 mrd 表中的 4 个条目返回 4 行。但这些都与那个日期无关，所以我不想看到这些信息。

所以我尝试了这个：

```
SELECT *
FROM admin.mktdmtunit c
where c.unitid in ('2756')
AND c.calledofftime between to_timestamp('2012-12-05 05:00:01','yyyy-mm-dd hh:mi:ss') 
    and to_timestamp('2012-12-06 05:00:00','yyyy-mm-dd hh:mi:ss')
OR (exists(SELECT mrd.effectivetime 
    FROM admin.mktmanualdispatch_all mrd 
    WHERE mrd.effectivetime  between to_timestamp('2012-12-05 05:00:01','yyyy-mm-dd hh:mi:ss') 
        and to_timestamp('2012-12-06 05:00:00','yyyy-mm-dd hh:mi:ss')
    AND c.unitid = mrd.unitid) 
```

但这给出了一个错误，说它在最后一行的“mrd.unitid”之前需要一个“，”。

所以我也试过这个：

```
SELECT *
FROM admin.mktdmtunit c
INNER JOIN admin.mktmanualdispatch_all mrd 
    ON
    mrd.effectivetime  between to_timestamp('2012-12-05 05:00:01','yyyy-mm-dd hh:mi:ss') 
        and to_timestamp('2012-12-06 05:00:00','yyyy-mm-dd hh:mi:ss')
    AND c.unitid = mrd.unitid
where c.unitid in ('2756')
AND c.calledofftime between to_timestamp('2012-12-05 05:00:01','yyyy-mm-dd hh:mi:ss') 
    and to_timestamp('2012-12-06 05:00:00','yyyy-mm-dd hh:mi:ss') 
```

但这不会返回任何行。

需要明确的是，我从这个特定查询中想要的是 1 行，其中包含基于 c.callofftime 的信息，并且没有从另一个表中提取的信息，因为没有基于 mrd.effective 时间的相关数据。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T21:22:27.610

发帖人已经回答了，但是，是的，离开加入第二个表并在连接逻辑中包含 mrd.effectivetime 标准，这样如果不存在，您将收到 NULL。这将允许您维护主表中的核心信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-24T01:31:36.027

注意：为简洁起见，我只是将您的“2012 年 12 月 5 日凌晨 5 点至 2012 年 12 月 6 日凌晨 5 点”条件称为“= 12 月 5 日”。

第二个查询：倒数第二行的 OR 意味着它将加入 unitid 上的表并将结果限制为 unitid = 2756，并进一步将行限制为 mktdmtunit.callofftime 或 mktmanualdispatch_all.effectivetime = 12 月 5 日（或两者都 = 12 月 5 日）。您将返回 4 行，因为 mktmanualdispatch_all 中有 4 行 unitid = 2756。

第四个查询 AND 的这些日期时间条件：返回的行必须同时具有 callofftime = Dec 5th 值 AND Effectivetime = Dec 5th。我不确定您想要哪种逻辑或两种逻辑，但我认为它是 EITHER，因为您似乎希望这会返回一些行。

第三个查询的语法错误 - 我认为这是因为您缺少右括号。您打开两个：“OR (exists(SELECT mrd.effectivetime ...”但只关闭一个：“... AND c.unitid = mrd.unitid)”

我建议

```
SELECT c.*
  FROM admin.mktdmtunit c
 where c.unitid in ('2756')
   AND (   (c.calledofftime between to_timestamp('2012-12-05 05:00:01',
                                                 'yyyy-mm-dd hh:mi:ss') 
                                and to_timestamp('2012-12-06 05:00:00',
                                                 'yyyy-mm-dd hh:mi:ss') 
           )
        OR (exists (SELECT mrd.effectivetime 
                      FROM admin.mktmanualdispatch_all mrd 
                     WHERE (mrd.effectivetime  between 
                             to_timestamp('2012-12-05 05:00:01','yyyy-mm-dd hh:mi:ss') 
                         and to_timestamp('2012-12-06 05:00:00','yyyy-mm-dd hh:mi:ss')
                           )
                       AND c.unitid = mrd.unitid
                    )
           )
       ) ; 
```

这将返回 mktdmtunit 的所有列，其中 unitid 为 2756，并且 calledofftime 在 12 月 5 日日期时间范围内，或者 mktmanualdispatch_all.effectivetime 在 12 月 5 日日期时间范围内，

# java - 生成其他脚本的脚本

> ID：13883767
> 
> 赞同：1
> 
> 时间：2012-12-14T17:47:34.663
> 
> 标签：java, python, shell, networking, scripting

我正在研究这个网络项目，我需要为此创建许多 shell 脚本来一次从多个节点到多个节点运行“tc”、“arp”和“ping”等工具。我需要为许多节点生成几个这样的脚本。所以我需要为每个场景和配置创建许多脚本，每个脚本都略有不同。此外，我的工作还涉及 Mininet。我需要创建 python 脚本来在那里生成许多自定义拓扑。硬编码这么多长脚本很痛苦。

所以我想知道自动创建这些脚本的最佳方法是什么？是否可以使用另一个 shell 脚本生成这些 shell/python 脚本？或者我应该使用 Java 生成这些？哪种方法最简单？在我开始工作之前只是想听听你的意见。谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:53:56.610

当然有可能，这是一个带有[bash](/questions/tagged/bash "显示标记为“bash”的问题")脚本的最小示例：

`create_a_script.sh`：

```
#!/bin/bash

echo -e \
'#!/bin/bash

ls
echo "Hello World!"' > hello.sh

chmod +x hello.sh 
```

您可以在终端中运行它，如下所示：

```
$ chmod +x create_a_script.sh
$ ./create_a_script.sh 
```

它会将以下内容写入`hello.sh`同一目录中调用的文件中：

```
#!/bin/bash

ls
echo "Hello World!" 
```

列出当前工作目录中的文件，然后打印“Hello World！” 在退出之前。

试试看：

```
$ ./hello.sh 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:14:33.160

这是一个 python 函数，它创建一个用于在 Excel 中设置超链接的脚本。新脚本在特定页面打开特定 pdf。该函数所属的较大程序每次运行会生成数十个甚至数百个这样的脚本，除了传递给该函数的 args 之外，所有这些脚本都是相同的。当用户关闭 Excel 并退出程序时，它们都会自动删除：

```
def makeOpener(pdf, page):
    '''makes a pyw file to use to hyperlink in excel'''
    t = 'c:/temp'
    if not os.path.isdir(t):
        os.makedirs(t)
    tempfile.tempdir = t
    py = tempfile.NamedTemporaryFile(suffix='.pyw', delete=False)

    lst = ['import subprocess, win32api',
           'pdf = r"' + pdf + '"',
           'page = "' + str(int(page)) + '"',
           '_, exe = win32api.FindExecutable(pdf)', 
           'opts = "page=" + page', 
           'clst = [exe, "/A", opts, "/N", pdf]', 
           'DP = 0x00000008', 
           'subprocess.Popen(clst, shell=False, creationflags=DP)'
           ]
    py.write('\n'.join(lst))       
    py.close()
    return py.name 
```

麦克风

# asp.net - 使用 ASP:CompareValidator 将 ASP:DropDownList 与文字值进行比较

> ID：13883768
> 
> 赞同：0
> 
> 时间：2012-12-14T17:47:42.530
> 
> 标签：asp.net, html-select, comparevalidator

我们正在实现一个 ASP:CompareValidator，但它没有像我们预期的那样工作。

在表单上有一个 ASP:DropDownList，其中 DropDown 中的一项是：

```
<Please select a class> 
```

该文本还包括角括号。

我们要确保用户从 DropDown 中选择了某些内容，因此我们不希望在 DropDown 显示时保存数据：

```
<Please select a class> 
```

您能否检查我的标记并告诉我为什么当用户单击更新按钮时会显示验证错误消息？

```
<asp:TemplateField HeaderText="Class:">
    <EditItemTemplate>
        <asp:DropDownList 
            ID="DropDownListClass" 
            Runat="server"
            DataSourceID="SqlDataSourceClasses"
            DataTextField = "ClassName"
            DataValueField="ID"
            SelectedValue='<%# Bind("ClassID") %>'
            ForeColor="Blue">
        </asp:DropDownList>

        <asp:CompareValidator 
            runat="server" 
            id="ClassMustBeSelected" 
            controltovalidate="DropDownListClass" 
            ValueToCompare="<Please select a class>"
            operator="Equal" 
            type="String" 
            errormessage="Please select a class!">
        </asp:CompareValidator>
    </EditItemTemplate>
</asp:TemplateField> 
```

DropDown 的值来自此数据源：

```
<asp:SqlDataSource 
    ID="SqlDataSourceClasses" 
    runat="server" 

    ConnectionString="<%$ ConnectionStrings:Knowledge Academy %>" 

    SelectCommand=
        "SELECT '' AS ID, '<Please select a class>' AS ClassName, '' AS Grade
   UNION SELECT ID, ClassName + ' *** Grade: ' + Grade AS ClassName, Grade 
           FROM Classes
       ORDER BY 2, 3">
</asp:SqlDataSource> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:56:30.420

在提交表单之前必须在其中包含值的字段应使用必填字段验证器。

[http://msdn.microsoft.com/en-us/library/e78xxk8k(v=VS.71).aspx](http://msdn.microsoft.com/en-us/library/e78xxk8k(v=VS.71).aspx)

请注意以下来自微软

**注意 如果输入控件为空，则不调用验证函数并且验证成功。使用RequiredFieldValidator 控件来防止用户跳过输入控件。**

因此，您需要一个必填字段验证器和一个比较验证器才能正常工作（尽管通常只需将列表留空（未选中）并使用必填字段验证器通常是已完成的。

# c# - 将 ThreadStatic 字段与任务一起使用

> ID：13883769
> 
> 赞同：4
> 
> 时间：2012-12-14T17:47:43.383
> 
> 标签：c#, thread-safety, task-parallel-library

**开始编辑**

执行此操作的“正确”方法（4.5 之前）是使用此处概述的 SynchronizationContext：http: [//msdn.microsoft.com/en-us/magazine/gg598924.aspx](http://msdn.microsoft.com/en-us/magazine/gg598924.aspx)

我相信在 4.5 SynchronizationContext 中会使用 async/await 关键字自动为您处理，但还没有做足够的工作来确认。

在 4.0 中，您可能希望利用“TaskScheduler.FromCurrentSynchronizationContext”来捕获当前线程的上下文（在我的例子中，这将包括 HttpContext，但 BCL 的各个部分提供了类似的构造）。

**结束编辑**

首要问题是：

**以下是与任务共享“上下文”的“安全”机制吗？**

在不涉及太多细节的情况下，在我的用例中，不可能将上下文直接推送到操作中。

```
public static class ContextCaller{
    [ThreadStatic]
    public static object SharedState;

    public static Task InvokeWithContext(this Action theAction){
        //We're still running in the "outer" context, 
        //so we can collect a variable and store it in the thread-static
        //field by closing it into the task.
        var context = new object();

        var t = new Task(()=>{
            try{
                //close in the context
                SharedState = context;
                theAction();
            }
            finally{
                //teardown the shared state.
                SharedState = null;
            }
        });
        t.Start();
        return t;
    }
} 
```

现在客户端代码：

```
//client code:
Action doWork = ()=>{
    var state = ContextCaller.SharedState;
    //do work on state, potentially throwing an exception in the process.
};

//cause the task to be invoked with some data available only on this thread.
doWork.InvokeWithContext(); 
```

根据我对任务与线程之间关系的理解，以上内容应该是安全的，因为：

1.  一项任务将在一个线程上运行（假设该操作不会产生额外的任务/线程）。
2.  ThreadStatic 字段在执行“theAction()”之前设置，并且“finally”保证在调用“theAction()”之后重置此字段，无论结果如何。

除了显式关闭“theAction”的参数之外，还有其他更好的模式来定义任务的上下文吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T22:59:04.260

我看不出您的代码不能正常工作的任何技术原因。

但我也认为这样做是一种不好的做法，只有在没有其他方法的情况下，我才会使用这样的东西。而且我认为添加另一个需要`Action<object>`（或者甚至更好，使用强类型参数）的方法重载不应该是一个重大变化。

# css - 如何在 IE 7 和 IE 8 中隐藏特定的 CSS 行

> ID：13883774
> 
> 赞同：3
> 
> 时间：2012-12-14T17:48:19.037
> 
> 标签：css, internet-explorer

所以我一直在尝试让一些 CSS 下拉菜单在 IE 7 和 8 中工作

它们在其他浏览器上运行良好。

网址是：[http ://hanling.focusww.com](http://hanling.focusww.com)

我有一个 css 块，并且包含一些我想从 IE 7 和 8 中隐藏的行

我在最后用“*”标记了这些行。

```
#menu a:visited {
  color:#f9f6e0;
  display:block;
  font-weight:700;
  padding-bottom:10px; //kill this in ie *
  padding-left:12px;
  padding-right:12px;
  padding-top:10px;  //kill this in ie *
} 
```

有人可以向我指出一篇解释如何做到这一点的文章吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-14T17:53:31.133

您可以通过以下简单方式做到这一点`IE conditional comments`：

**HTML**

```
<!--[if IE 7]> <html class="ie7"> <![endif]-->
<!--[if IE 8]> <html class="ie8"> <![endif]--> 
```

**CSS**

```
#menu a:visited {
  color:#f9f6e0;
  display:block;
  font-weight:700;
  padding-bottom:10px; //kill this in ie *
  padding-left:12px;
  padding-right:12px;
  padding-top:10px;  //kill this in ie *
}

.ie7 #menu a:visited,
.ie8 #menu a:visited, {
  padding-bottom: 0; //kill this in ie *
  padding-top: 0;  //kill this in ie *
} 
```

..或者也可以使用`CSS-Hacks`更多：[http ://www.webdevout.net/css-hacks#in_css](http://www.webdevout.net/css-hacks#in_css)

```
#menu a:visited {
 color:#f9f6e0;
 display:block;
 font-weight:700;
 padding-bottom:10px; 
 padding-bottom:0\9; //kill this in ie *
 padding-left:12px;
 padding-right:12px;
 padding-top:10px;  
 padding-top:0\9; //kill this in ie *
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:50:19.520

您可以使用 IE 条件注释，不能在 IE 中隐藏特定样式，甚至 @yckart 链接也很酷，但最好使用特定样式表

```
<!--[if IE 7]>
    Only Shows Up In IE7
    <link href="#" rel="stylesheet" type="text/css" />
<![endif]-->

<!--[if IE 8]>
    Only Shows Up In IE8
    <link href="#" rel="stylesheet" type="text/css" />
<![endif]--> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T18:01:05.787

我会这样做：

```
#menu a:visited {
 color:#f9f6e0;
 display:block;
 font-weight:700;
 padding-bottom:10px; 
 padding-bottom:0\9; //IE 8 and below
 padding-left:12px;
 padding-right:12px;
 padding-top:10px;  
 padding-top:0\9; //IE 8 and below 
```

}

如果这些是您唯一需要的特定于 IE 的样式，那么这可能比使用条件样式表更容易。

# objective-c - UITextField 内容到另一个 UItextField

> ID：13883775
> 
> 赞同：0
> 
> 时间：2012-12-14T17:48:28.763
> 
> 标签：objective-c, ios, uitextfield

我有一个要求，我需要将内容从一个 UITextField 复制到同一屏幕上的另一个 UITextField。这就像一个别名，一旦用户开始输入，我就应该开始复制内容。我正在使用方法`(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string`

问题是我还必须实现删除内容的逻辑。我很确定有一个更方便的机制。

任何帮助将不胜感激。

非常感谢，马科斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:54:07.380

要更新你的字符串，它是这样的：

```
NSString *str = textField.text;
str = [str stringByReplacingCharactersInRange:range withString:string]; 
```

之后分配`str`给您的其他文本字段，就可以了。

# ssrs-2008 - 数据集多用途问题

> ID：13883777
> 
> 赞同：0
> 
> 时间：2012-12-14T17:48:37.847
> 
> 标签：ssrs-2008

我有一个从存储过程加载的数据集。它有田野。

```
DisplayID INT,
Display VARCHAR(45),
Default BIT 
```

我有一个名为 DisplayFields 的参数，它是一个多值参数。对于可用值，我将 ValueField 设置为*DisplayID*，将 Label 字段设置为*Display*字段。

我希望默认选择是数据集中*Default = 1*的每条记录。有谁知道如何做到这一点？

**编辑 1**

我有一个存储过程。我用来填充数据集的。我添加了第二个数据集，其中包含基于*默认*字段的过滤器。我不喜欢这个解决方案，因为我相信我会调用该存储过程两次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T17:00:19.380

If you always have at least one default value than you can implement such functionality as:

```
WITH TestData AS
(
    SELECT 0 AS ID, 'always default' AS Name, 1 AS IsDefaultValue
    UNION ALL
    SELECT 1 AS ID, 'test1' AS Name, 0 AS IsDefaultValue
    UNION ALL
    SELECT 2 AS ID, 'test2' AS Name, 1 AS IsDefaultValue
    UNION ALL
    SELECT 3 AS ID, 'test3' AS Name, 0 AS IsDefaultValue
    UNION ALL
    SELECT 4 AS ID, 'test4' AS Name, 1 AS IsDefaultValue
)
SELECT ID, 
       Name, 
       IsDefaultValue,
       CASE
            WHEN IsDefaultValue = 0
            THEN ID
            -- return id of always default value
            ELSE 0
       END AS DefaultID        
FROM TestData 
```

Then in SSRS side you should add available value as ID and default as DefaultID. But we can't have in set of default values some value which isn't presented in set of available values (that's why we use "always default value"), in this case default selection won't work and you should call SP twice.

# javascript - 使用 Google Apps 脚本和 HtmlService 将对象传递给模板

> ID：13883779
> 
> 赞同：0
> 
> 时间：2012-12-14T17:48:37.860
> 
> 标签：javascript, object, google-apps-script

所以我在一个谷歌电子表格中有一个植物列表，我想用 HTML 呈现。我有一个脚本，它将收集对象或数组中的信息，数组的每个元素都是一个对象。每个植物都有一个 3 位 id，用作对象和数组中的键，如下所示： object[143].create_date = 12/15/2012 array[143].create_date = 12/15/2012

对象和数组都被正确创建。

问题：

```
var pRet = HtmlService.createTemplateFromFile('Plant Listing'); 
```

我无法使用 HtmlService 和 html 模板将数据转换为 html。当使用对象的形式

```
pRet.data = myObject; 
```

在 html 模板代码中，例如：

```
<? for(var x in data) { ?>
<? data[x].create_date ?> 
```

呈现为 TypeError：无法从 null 读取属性“create_date”。但是，如果我像这样将数据传递给模板：

```
pRet.Data = myObject[143]; 
```

然后呈现的 html 循环并显示 id 为 143 的植物的数据元素。如果我使用将植物作为植物 id 的数组索引返回的函数，那么我得到一个数组，其中元素 0 到 99 未定义具有任何数据的第一个元素是元素 100，对应于 id 为 100 的植物。

我将预读表中的数据呈现为对象的代码返回一个包含元素列表的对象，如下所示：

```
{143={stage_7=-1.0, index=20.0, stage_5=-1.0, stage_6=-1.0, stage_3=1.0, current_stage=1.0, strain=1.0, stage_4=0.0, location=1.0, stage_1=51.0, stage_2=61.0, id=143.0, create_date=Sat Dec 08 2012 00:00:00 GMT-0700 (MST), group=null} 
```

并且将数据集作为以植物 id 为索引的数组返回的代码返回此值，其中前 100 个元素为空，因为第一个植物索引为 100：

```
{stage_7=-1.0, index=1.0, stage_5=-1.0, stage_6=-1.0, stage_3=5.0, current_stage=2.0, strain=1.0, stage_4=-1.0, location=2.0, stage_1=Mon Jul 09 23:00:00 PDT 2012, stage_2=56.0, id=100.0, create_date=Sat Dec 08 2012 00:00:00 GMT-0700 (MST), group=null} 
```

问题：我可以尝试将数据从电子表格获取到呈现的 html 的其他方法是什么？我最初的想法是放弃将元素放在植物 id 的数组或对象索引中的想法。另一种选择是使用数组并检查模板文件中的空条目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T23:03:24.783

HtmlService 中有一个已知错误，您无法将子属性分配给模板上的对象。所以这失败了：

```
var = HtmlService.createTemplate();
t.x = {};
t.x.y = 1;  // This throws no error, but t.x.y will still be undefined! 
```

然而，这有效：

```
var = HtmlService.createTemplate();
var x = {};
x.y = 1;
t.x = x;    // t.x.y will now correctly be 1 
```

我们知道问题出在哪里，并计划解决它，但这并不重要，需要一些时间才能推出。

# mysql - 此 SQL 语句出现错误 1064？

> ID：13883789
> 
> 赞同：-1
> 
> 时间：2012-12-14T17:49:10.160
> 
> 标签：mysql, sql, join

```
SELECT `news_posts`.`ID` , `category`.`ID` , `news_posts`.`Title` , `news_posts`.`Author` , `news_posts`.`Time` , `news_posts`.`Cat_ID` , `news_posts`.`Tags` , `news_posts`.`imageLocation` , `news_posts`.`thumbLocation` , `category`.`name`
FROM `news`.`category`
LEFT JOIN `category`.`ID` = `news_posts`.`Cat_ID`
LIMIT 0 , 30 
```

这是它带来的错误

> *1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以了解在 '. `Cat_ID`LIMIT 0, 30' 在第 16 行*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:50:34.453

您缺少表名`news_posts`和`ON`关键字。它应该是：

```
...
FROM `news`.`category`
LEFT JOIN news_posts ON `category`.`ID`  ...
... 
```

像这样：

```
SELECT 
  `news_posts`.`ID` , `category`.`ID` , 
  `news_posts`.`Title` , `news_posts`.`Author` , 
  `news_posts`.`Time` , `news_posts`.`Cat_ID` , 
  `news_posts`.`Tags` , `news_posts`.`imageLocation` , 
  `news_posts`.`thumbLocation` , `category`.`name`
FROM `news`.`category`
LEFT JOIN news_posts ON `category`.`ID` = `news_posts`.`Cat_ID`
LIMIT 0 , 30 
```

# ios - 是否可以开发一个使用仅为设备构建的框架的 Ti iOS 模块？

> ID：13883790
> 
> 赞同：0
> 
> 时间：2012-12-14T17:49:13.823
> 
> 标签：ios, module, titanium, xcode4.5

我的模块构建成功，但我尝试在 Titanium Studio 中使用该模块并直接安装到设备上。当模块测试工具构建失败时，我遇到了相同类型的“SystemExit：65”错误。当然，我不能使用测试工具，因为模块使用的框架只是为 arm 架构/而不是 i386 构建的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:38:40.813

您可以从生成的项目和构建脚本中删除 i386 支持。然后自己从 Xcode 运行。不过，你是靠自己的。更好的选择是获得包含 i386 的二进制文件。

# java - 如何将 @Override toString 与接口对象的 ArrayList 一起使用？

> ID：13883792
> 
> 赞同：0
> 
> 时间：2012-12-14T17:49:24.027
> 
> 标签：java, interface, arraylist

我对接口的理解是它们不能包含方法定义，只能包含签名和常量声明。我有一个包含接口对象集合的数组列表。在这种情况下，它看起来像：

列表< StoreItem > items = new ArrayList< StoreItem >();

StoreItem 是我的界面，如下所示：

```
public interface StoreItem {
//Operations
public String getMaker();
public Patron getItemBuyer();
public Date getManufactureDate();
public String getManufacturer();
public String getProductName();
public void setItemBuyer(Patron purchase);
    } 
```

我有一种方法可以创建一个新项目并将其添加到列表中。它似乎工作正常，因为我在单元测试中没有遇到任何问题，也没有发现异常。但是我有一个经典的新手问题，我想打印数组列表以亲眼看到内容，并且我知道我需要覆盖 StoreItem 的 toString 方法。但是 StoreItem 是一个接口，显然它不会让我在接口内做这样的事情。我还有一个实现这个接口的抽象类，以及那个抽象类的三个子类。我正在将这些子类之一的对象创建为 StoreItem，因此我尝试在此子类中执行 toString 覆盖。我不能让它工作。我试过了：

```
public String toString(){
    return super.productName();
} 
```

它不喜欢它，因为在抽象超类中 productName 是私有的，并且为了项目而需要。我决定继续将 productName 更改为 protected ，只是为了看看它是否仍然有效。打印列表时，我仍然只是获取内存位置（类似于@d9sdf83j）。所以我将它设置回私有并尝试让 toString 在返回时使用超类中的 getter 方法，所以：

```
public String toString(){
    return super.getProductName();
} 
```

我仍然只是得到内存位置。我不知道这是否足以描述正在发生的事情以及我正在尝试做的事情。我希望这个错误足够基本，以至于比我更聪明的人可以发现它并指出它，但如果需要，我可以添加更多代码。提前致谢。

我仍然无法让它工作。我将添加实际的类，看看是否有帮助。

```
public abstract class AbstractStoreItem implements StoreItem{

//attributes
private String product;
private Date manufactureDate;
private String manufacturer;
private String distibutor;
private Patron buyer;

//operations
public AbstractStoreItem(String product, String manufacturer, String distibutor, Date manufactureDate) {
    this.product = product;
    this.manufactureDate = manufactureDate;
    this.manufacturer = manufacturer;
    this.distibutor = distibutor;
}

@Override
public String toString() {
    return this.product;

}

@Override
public String getManufacturer() {
    // TODO Auto-generated method stub
    return manufacturer;
}

@Override
public Patron getBuyer() {
    // TODO Auto-generated method stub
    return buyer;
}

@Override
public Date getManufactureDate() {
    // TODO Auto-generated method stub
    return manufacturerDate;
}

@Override
public String getDistributor() {
    // TODO Auto-generated method stub
    return distributor;
}

@Override
public String getProduct() {
    // TODO Auto-generated method stub
    return product;
}

@Override
public void setBuyer(Patron buyer) {
    this.buyer= buyer;

} 
```

}

这是抽象类的子类。这是我要添加到列表中的对象：

```
public class Widget extends AbstractStoreItem{

//attributes
private Type type;
private int unitQuantity;

//operations
public Widget(String product, String manufacturer, String distributor, Date manufactureDate, Type gearType, int unitQuantity){
    super(product, manufacturer, distributor, manufactureDate);

    this.type = gearType;
    this.unitQuantity = unitQuantity;
}

public Type getType(){
    return type;
}

public int getUnitQuantity(){
    return unitQuantity;
}

@Override
public void setBuyer(Patron Buyer) {
    // TODO Auto-generated method stub

}

@Override
public String toString() {
    return super.getManufacturer();
} 
```

}

不确定如何处理 toString 方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:51:12.527

您需要在实现 要添加的实例`toString`的类中覆盖`StoreItem``List`

```
interface StoreItem {
    String name();
}

static class Pen implements StoreItem {

    @Override
    public String name() {
        return Pen.class.getName();
    }

    @Override
    public String toString() {
        return "Pen to String";
    }

}

public static void main(String[] args) {
    List<StoreItem> items= new ArrayList<StoreItem>();
    items.add(new Pen());
    System.out.println(items);
} 
```

将打印

```
 [Pen to String] 
```

# oracle - Oracle 存储过程 - 根据可选参数动态生成选择语句

> ID：13883794
> 
> 赞同：2
> 
> 时间：2012-12-14T17:49:26.400
> 
> 标签：oracle, stored-procedures, plsql

```
create or replace
PROCEDURE get_txn_by_account_id(
p_ACCOUNT_ID IN txn.ACCOUNT_ID%TYPE DEFAULT NULL
) 

IS

BEGIN
FOR x IN (SELECT * FROM txn where account_id=p_ACCOUNT_ID)
LOOP
    dbms_output.put_line(x.txn_ID || ', ' || x.txn_VER_NB);

END LOOP;
END get_txn_by_account_id; 
```

我的存储过程基于一个输入作为搜索条件发出选择并输出搜索结果。我的输入是 ACCOUNT_ID。我想添加 4 个额外的输入参数（param_a、param_b、param_c、param_d）——其中至少两个是可选的。

所以我可能会改变我的存储过程声明

```
PROCEDURE get_txn_by_account_id(
p_ACCOUNT_ID IN txn.ACCOUNT_ID%TYPE DEFAULT NULL,
p_PARAM_A IN txn.PARAM_A%TYPE DEFAULT NULL,
p_PARAM_B IN txn.PARAM_B%TYPE DEFAULT NULL,
p_PARAM_C IN txn.PARAM_C%TYPE DEFAULT NULL,
p_PARAM_D IN txn.PARAM_D%TYPE DEFAULT NULL
) 
```

因此，根据传递给存储过程的可选参数，我的 SELECT 可能具有不同数量的查询参数。

例如，

```
FOR x IN (SELECT * FROM txn where account_id=p_ACCOUNT_ID, param_a=p_PARAM_A, param_b=p_PARAM_B, param_c=p_PARAM_C, param_d=p_PARAM_D)
FOR x IN (SELECT * FROM txn where account_id=p_ACCOUNT_ID, param_a=p_PARAM_A, param_c=p_PARAM_C, param_d=p_PARAM_D)
FOR x IN (SELECT * FROM txn where account_id=p_ACCOUNT_ID, param_a=p_PARAM_A, param_b=p_PARAM_B, param_d=p_PARAM_D) 
```

或者

```
FOR x IN (SELECT * FROM txn where account_id=p_ACCOUNT_ID, param_a=p_PARAM_A, param_b=p_PARAM_B) 
```

等等

我遇到了麻烦 - 如何对我的存储过程进行编码，以便 SELECT 语句根据传递给存储过程的可选参数进行更改 - 也许是一个字符串构建器，它根据传入过程的可选参数构建查询语句，然后在查询中使用结果字符串？我不确定这是否可能。当然这是一个常见问题 - 有人有什么建议吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T17:56:53.303

```
FOR x IN ( SELECT * 
           FROM txn 
           WHERE account_id=p_ACCOUNT_ID
             AND (p_PARAM_A is null or param_a=p_PARAM_A)
             AND (p_PARAM_B is null or param_b=p_PARAM_B)
             AND (p_PARAM_C is null or param_c=p_PARAM_C)
             AND (p_PARAM_D is null or param_d=p_PARAM_D) ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T17:56:05.850

您可以使用以下技巧：

```
select * from FOO
where
  COLUMN_1 = nvl(pParam1, COLUMN_1)
  and COLUMN_2 = nvl(pParam2, COLUMN_2)
  and ... 
```

这确保了如果`pParam1`是`null`，您的条件总是计算为`true`。等等。

# xml - 什么 xsl 对日期范围内的元素求和？

> ID：13883795
> 
> 赞同：1
> 
> 时间：2012-12-14T17:49:28.343
> 
> 标签：xml, xslt, xslt-1.0, xslt-2.0

xml 摘录（[http://pastebin.com/HDrmzctC](http://pastebin.com/HDrmzctC)上的完整示例 xml ）：

```
<log>
  <event>
    <when>2012-10-26T21:32:52</when>
    <what>
      <item>food</item>
      <money>10</money>
    </what>
  </event>
  <event>
    <when>2012-10-26T21:32:52</when>
    <what>
      <item>beer</item>
      <money>20</money>
    </what>
  </event>
  <event>
    <when>2012-10-27T21:32:52</when>
    <what>
      <item>food</item>
      <money>10</money>
    </what>
  </event>
  <event>
    <when>2012-10-27T21:32:52</when>
    <what>
      <item>beer</item>
      <money>20</money>
    </what>
  </event>

  <event>
    <when>2012-11-26T21:32:52</when>
    <what>
      <item>food</item>
      <money>11</money>
    </what>
  </event>
  <event>
    <when>2012-11-26T21:32:52</when>
    <what>
      <item>beer</item>
      <money>22</money>
    </what>
  </event>
  <event>
    <when>2012-11-27T21:32:52</when>
    <what>
      <item>food</item>
      <money>11</money>
    </what>
  </event>
  <event>
    <when>2012-11-27T21:32:52</when>
    <what>
      <item>beer</item>
      <money>22</money>
    </what>
  </event>

</log> 
```

期望产量：
2012-10 食品 20
2012-10 啤酒 40
2012-11 食品 22
2012-11 啤酒 44

还是因为xml设计错误而导致xsl不简单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:14:36.307

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kEventByDateItem" match="event"
      use="concat(substring(when, 1,7), '+', what/item)"/>

 <xsl:template match=
  "event
     [generate-id()
     =
      generate-id(key('kEventByDateItem',
                       concat(substring(when, 1,7), '+', what/item)
                       )[1]
                  )
      ]">
     <xsl:value-of select="concat('&#xA;',substring(when, 1,7), ' ', what/item, ' ')"/>
     <xsl:value-of select=
      "sum(key('kEventByDateItem',
             concat(substring(when, 1,7), '+', what/item)
             )/what/money)"/>
 </xsl:template>
 <xsl:template match="text()"/>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<log>
  <event>
    <when>2012-10-26T21:32:52</when>
    <what>
      <item>food</item>
      <money>10</money>
    </what>
  </event>
  <event>
    <when>2012-10-26T21:32:52</when>
    <what>
      <item>beer</item>
      <money>20</money>
    </what>
  </event>
  <event>
    <when>2012-10-27T21:32:52</when>
    <what>
      <item>food</item>
      <money>10</money>
    </what>
  </event>
  <event>
    <when>2012-10-27T21:32:52</when>
    <what>
      <item>beer</item>
      <money>20</money>
    </what>
  </event>

  <event>
    <when>2012-11-26T21:32:52</when>
    <what>
      <item>food</item>
      <money>11</money>
    </what>
  </event>
  <event>
    <when>2012-11-26T21:32:52</when>
    <what>
      <item>beer</item>
      <money>22</money>
    </what>
  </event>
  <event>
    <when>2012-11-27T21:32:52</when>
    <what>
      <item>food</item>
      <money>11</money>
    </what>
  </event>
  <event>
    <when>2012-11-27T21:32:52</when>
    <what>
      <item>beer</item>
      <money>22</money>
    </what>
  </event>

</log> 
```

**产生想要的正确结果：**

```
2012-10 food 20
2012-10 beer 40
2012-11 food 22
2012-11 beer 44 
```

**说明**：

正确使用带有复合键的**[Muenchian 分组方法。](http://www.jenitennison.com/xslt/grouping/muenchian.html)**

# php - Magento 1.6 添加新地址模板

> ID：13883797
> 
> 赞同：1
> 
> 时间：2012-12-14T17:49:39.797
> 
> 标签：php, xml, magento

我正在尝试向 Magento 1.6 添加一个新的地址模板，这样我就可以在我的货件 PDF 中输出为标签格式化的地址，并保持标准的 PDF 地址格式。

到目前为止，我已将文件 app/code/core/Mage/Customer/etc/config.xml 复制到本地代码池，并从现有模板中复制了 xml 并将其重命名为 . 以下是 config.xml 的相关部分

**代码：** app/code/core/Mage/Customer/etc/config.xml

**第一部分：**

```
 <customer>
        <address>
            <formats>
                <text translate="title" module="customer">
                    <title>Text</title>
                </text>
                <oneline translate="title" module="customer">
                    <title>Text One Line</title>
                </oneline>
                <html translate="title" module="customer">
                    <title>HTML</title>
                    <htmlEscape>true</htmlEscape>
                </html>
                <pdf translate="title" module="customer">
                    <title>PDF</title>
                </pdf>
                <js_template template="title" module="customer">
                    <title>JavaScript Template</title>
                </js_template>
                <add_label template="title" module="customer">
                    <title>Address Label</title>
                </add_label>
            </formats>
        </address>
    </customer> 
```

**第二部分：**

```
 <address_templates>
            <text>
                {{depend prefix}}{{var prefix}} {{/depend}}{{var firstname}} {{depend middlename}}{{var middlename}} {{/depend}}{{var lastname}}{{depend suffix}} {{var suffix}}{{/depend}}
                {{depend company}}{{var company}}{{/depend}}
                {{if street1}}{{var street1}}
                {{/if}}
                {{depend street2}}{{var street2}}{{/depend}}
                {{depend street3}}{{var street3}}{{/depend}}
                {{depend street4}}{{var street4}}{{/depend}}
                {{if city}}{{var city}},  {{/if}}{{if region}}{{var region}}, {{/if}}{{if postcode}}{{var postcode}}{{/if}}
                {{var country}}
                T: {{var telephone}}
                {{depend fax}}F: {{var fax}}{{/depend}}
                {{depend vat_id}}VAT: {{var vat_id}}{{/depend}}
            </text>
            <oneline>{{depend prefix}}{{var prefix}} {{/depend}}{{var firstname}} {{depend middlename}}{{var middlename}} {{/depend}}{{var lastname}}{{depend suffix}} {{var suffix}}{{/depend}}, {{var street}}, {{var city}}, {{var region}} {{var postcode}}, {{var country}}</oneline>
            <html>
                {{depend prefix}}{{var prefix}} {{/depend}}{{var firstname}} {{depend middlename}}{{var middlename}} {{/depend}}{{var lastname}}{{depend suffix}} {{var suffix}}{{/depend}}&lt;br/&gt;
                {{depend company}}{{var company}}&lt;br /&gt;{{/depend}}
                {{if street1}}{{var street1}}&lt;br /&gt;{{/if}}
                {{depend street2}}{{var street2}}&lt;br /&gt;{{/depend}}
                {{depend street3}}{{var street3}}&lt;br /&gt;{{/depend}}
                {{depend street4}}{{var street4}}&lt;br /&gt;{{/depend}}
                {{if city}}{{var city}},  {{/if}}{{if region}}{{var region}}, {{/if}}{{if postcode}}{{var postcode}}{{/if}}&lt;br/&gt;
                {{var country}}&lt;br/&gt;
                {{depend telephone}}T: {{var telephone}}{{/depend}}
                {{depend fax}}&lt;br/&gt;F: {{var fax}}{{/depend}}
                {{depend vat_id}}&lt;br/&gt;VAT: {{var vat_id}}{{/depend}}
            </html>
            <pdf>
                {{depend prefix}}{{var prefix}} {{/depend}}{{var firstname}} {{depend middlename}}{{var middlename}} {{/depend}}{{var lastname}}{{depend suffix}} {{var suffix}}{{/depend}}|
                {{depend company}}{{var company}}|{{/depend}}
                {{if street1}}{{var street1}}
                {{/if}}
                {{depend street2}}{{var street2}}|{{/depend}}
                {{depend street3}}{{var street3}}|{{/depend}}
                {{depend street4}}{{var street4}}|{{/depend}}
                {{if city}}{{var city}},|{{/if}}
                {{if region}}{{var region}}, {{/if}}{{if postcode}}{{var postcode}}{{/if}}|
                {{var country}}|
                {{depend telephone}}T: {{var telephone}}{{/depend}}|
                {{depend fax}}&lt;br/&gt;F: {{var fax}}{{/depend}}|
                {{depend vat_id}}&lt;br/&gt;VAT: {{var vat_id}}{{/depend}}|
            </pdf>
            <js_template>#{prefix} #{firstname} #{middlename} #{lastname} #{suffix}&lt;br/&gt;#{company}&lt;br/&gt;#{street0}&lt;br/&gt;#{street1}&lt;br/&gt;#{street2}&lt;br/&gt;#{street3}&lt;br/&gt;#{city}, #{region}, #{postcode}&lt;br/&gt;#{country_id}&lt;br/&gt;T: #{telephone}&lt;br/&gt;F: #{fax}&lt;br/&gt;VAT: #{vat_id}</js_template>
            <add_label>
                {{depend prefix}}{{var prefix}} {{/depend}}{{var firstname}} {{depend middlename}}{{var middlename}} {{/depend}}{{var lastname}}{{depend suffix}} {{var suffix}}{{/depend}}|
                {{depend company}}{{var company}},|{{/depend}}
                {{if street1}}{{var street1}},{{/if}}
                {{depend street2}}{{var street2}},|{{/depend}}
                {{depend street3}}{{var street3}},|{{/depend}}
                {{depend street4}}{{var street4}},|{{/depend}}
                {{if city}}{{var city}},|{{/if}}
                {{if region}}{{var region}}, {{/if}}{{if postcode}}{{var postcode}}{{/if}}|
                {{var country}}|
            </add_label>
        </address_templates> 
```

然后我将 app/code/core/Mage/Sales/Model/Order/Pdf/Shipment.php 复制到本地代码池，并尝试使用以下代码输出我的新地址模板。

**代码：** app/code/core/Mage/Sales/Model/Order/Pdf/Shipment.php

```
$shippingAddress = $this->_formatAddress($order->getShippingAddress()->format('add_label'));

$this->y = 170;
foreach ($shippingAddress as $value){
    $page->drawText(strip_tags(ltrim($value)), 40, $this->y, 'UTF-8');
    $this->y -=10;
} 
```

但是输出的不是我的新地址模板，它似乎是某种默认模板。我已经刷新了缓存，但这并没有改变任何东西。有谁知道我哪里出错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T14:52:47.627

**！已解决 Magento 1.7.0.2 - 目前未在 v1.6 中尝试！**

受您帖子的启发，我找到了一个自己的地址模板的解决方案。

这是我的模块配置，只是一个演示模块

```
<?xml version="1.0" encoding="UTF-8"?>
<config>
    <modules>
        <NAMESPACE_MODULE>
            <version>0.1.0</version>
        </NAMESPACE_MODULE>
    </modules>
    <global>

        ...

        <customer>
            <address>
                <formats>
                    <html_special translate="title" module="customer">
                        <title>HTML special</title>
                        <htmlEscape>true</htmlEscape>
                    </html_special>
                </formats>
            </address>
        </customer>

        ...

    </global>

    ...

    <default>
        <customer>
            <address_templates>
                <html_special><![CDATA[
MY SPECIAL HTML ADDRESS
{{depend company}}{{var company}}<br />{{/depend}}
{{depend prefix}}{{var prefix}} {{/depend}}{{var firstname}} {{depend middlename}}{{var middlename}} {{/depend}}{{var lastname}}{{depend suffix}} {{var suffix}}{{/depend}}<br/>
{{if street1}}{{var street1}}<br />{{/if}}
{{depend street2}}{{var street2}}<br />{{/depend}}
{{depend street3}}{{var street3}}<br />{{/depend}}
{{depend street4}}{{var street4}}<br />{{/depend}}
{{if postcode}}{{var postcode}} {{/if}}{{if city}}{{var city}}{{/if}}<br/>
{{var country}}<br/>
{{depend telephone}}Tel: {{var telephone}}{{/depend}}
{{depend fax}}<br/>Fax: {{var fax}}{{/depend}}
                ]]></html_special>
            </address_templates>
        </customer>
    </default>

</config> 
```

我猜你没有把它`<address>...</address>`放入`<global>`块中？！

# ruby - Watir - 查找具有属性值的特定子项的父 div

> ID：13883800
> 
> 赞同：2
> 
> 时间：2012-12-14T17:50:04.977
> 
> 标签：ruby, watir

我是 Ruby 和 Watir 的新手。我有以下示例html结构：

```
<div class="class1">
    <a class="class2" title="theTestTitle" href="#">
    <ul class="the-summary">
        <li class="class3">
        <li class="class4">
        <li class="class5">
        <li class="class6">
    </ul>
</div> 
```

我的目标是测试以下 div 中的内容，但首先我需要让该 div 进行测试。有没有办法使用链接属性标题来找到我需要的 div。所以在上面的例子中找到子链接有title="theTestTitle"的div？

另外，在变量中有这个 div 之后，我可以使用 xpath 来搜索那个 div 还是？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:19:28.937

`parent`您可以获取链接，然后使用以下方法获取其父级：

```
browser.link(:title, 'theTestTitle').parent 
```

或者您可以使用 xpath 直接获取 div：

```
#In Watir-classic:
browser.div(:xpath, '//div[./a[@title="theTestTitle"]]')

#In Watir-webdriver:
browser.element(:xpath, '//div[./a[@title="theTestTitle"]]').to_subtype 
```

# php - Magento：通过安装脚本将属性/列添加到销售表

> ID：13883803
> 
> 赞同：0
> 
> 时间：2012-12-14T17:50:17.053
> 
> 标签：php, magento, magento-1.7

通过安装脚本向 magento 中的销售和/或报价表添加新属性的正确方法是什么：

1.  利用`Mage_Sales_Model_Entity_Setup`
2.  利用`Mage_Sales_Model_Resource_Setup`

然后使用以下哪种方法：

1.  `addColumn()`
2.  `addAttribute()`

它们似乎都允许添加新属性，所以我想知道哪个是正确的，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T01:20:47.220

查看代码，区别在于：

addColumn 来自从 Mage_Sales_Model_Entity_Setup 中的 getConnection 返回的 DB\Adapter，它只不过是在表中添加一列。

如果启用了平面实体，则 Mage_Sales_Model_Resource_Setup 中的 addAttribute 仅用于添加列，否则它只是在 Mage_Eav_Model_Entity_Setup 中调用 addAttribute ，它会执行许多操作，包括检查属性是否已存在、验证数据、添加属性选项并将属性插入到 eav_attribute桌子。

回答你的问题。添加列可能仅用于将列添加到您自己的表中。您可能应该使用属性来扩展销售订单和报价对象。

有关在 Mage\Sales\sql\sales_setup 中为 addAttribute 添加属性的正确方法示例。

这是我的一个例子：

```
$installer->addAttribute('order', 'your_attribute_name', array(
    'group'             => 'General', // Defaults to General
    'type'              => 'int',
    'default'           => 0,
    'grid'              => true,
    'required'          => false,
    'visible'           => true,
    'backend'           => '',
    'frontend'          => '',
    'label'             => 'My Attribute',
    'note'              => 'description goes here.',
    'input'             => 'select',
    'class'             => '',
    'source'            => 'eav/entity_attribute_source_boolean',
    'global'            => Mage_Catalog_Model_Resource_Eav_Attribute::SCOPE_GLOBAL,
    'visible'           => true,
    'required'          => false,
    'user_defined'      => false,
    'default'           => 0,
    'searchable'        => false,
    'filterable'        => true,
    'comparable'        => false,
    'visible_on_front'  => false,
    'unique'            => false,
    'apply_to'          => 'simple,virtual,configurable,bundle',
)); 
```

# javascript - Backbone.js 无法识别变量

> ID：13883804
> 
> 赞同：1
> 
> 时间：2012-12-14T17:50:18.110
> 
> 标签：javascript, backbone.js

我正在尝试`Backbone.js`在网页中使用。

当我链接到`.js`文件时，我在**第 225 行**`version 0.9.9`收到以下错误。

 **```
 TypeError _ is undefined
 _.extend(Backbone,Events); 
```

但是，在**第 40 行**`_`定义

 **```
 var _ = root._; 
```

并且该变量声明不在循环或条件语句中。

为什么第 225 行不能识别第 40 行声明的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:51:37.177

[Backbone.js](http://backbonejs.org/)依赖于[Underscore.js](http://underscorejs.org/)****

# mysql - mySQL从一列中的两列中删除重复名称

> ID：13883807
> 
> 赞同：1
> 
> 时间：2012-12-14T17:50:28.360
> 
> 标签：mysql

提前谢谢了。

我的表中有两列：
表：contactinfo
列：家乡，MailingAddress

列 Hometown 和 MailingAddress 包含重复的（呃！）信息，其中 Hometown 列出“城市”，MailingAddress 列出“1234 Street, City”

我想从 MailingAddress 中删除与家乡匹配的城市，以便我可以从：

家乡：城市
邮寄地址：1234 Street, City

至

家乡：城市
邮寄地址：1234 Street,

我不想删除“，”，因为某些 MailingAddress 条目在街道地址信息中有逗号。

再次感谢你们这些了不起的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:47:59.110

我会用这个：

```
UPDATE contactinfo
SET MailingAddress = replace(MailingAddress, CONCAT(', ', Hometown), ',')
WHERE MailingAddress LIKE CONCAT('%, ', Hometown) 
```

这将选择所有以`MailingAddress`结尾的行，并仅用 a`, City`替换每次出现的（因此您必须确保仅在字符串末尾出现一次）。`, City``,``, City`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:19:00.680

看看 MySQL 字符串函数： [http ://dev.mysql.com/doc/refman/5.0/en/string-functions.html](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html)

假设您已经确定了违规记录，您应该能够更新新的城市和地址字段（使用临时字段以免更改源数据）。你可以这样做：

```
UPDATE contactinfo
SET new_MailingAddress = SUBSTRING_INDEX(MailingAddress, ',' 1) 
WHERE id IN [SELECT offending records] 
```

不是最优雅的，但应该给你一个起点。查看所有其他字符串函数，看看哪些最适合您的需求。我相信你也可以对更多有问题的数据做一些正则表达式。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T18:04:33.147

我不知道您使用的是什么脚本，但您需要先获取匹配的行，然后为每一行使用脚本中的字符串函数删除重复项，然后更新相应的行。

查询以按您的标准选择（如果我理解正确的话）：

```
SELECT * FROM contactinfo WHERE MailingAddress LIKE CONCAT('%', Hometown) 
```

# jquery - ASP.NET MVC：如果客户端验证通过，则禁用提交按钮

> ID：13883808
> 
> 赞同：8
> 
> 时间：2012-12-14T17:50:29.423
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-4

我有一个启用**客户端验证**的简单 MVC4 表单：

```
 @{ Html.EnableClientValidation(); }
 @{ Html.EnableUnobtrusiveJavaScript(); }
 @using (Html.BeginForm("Search", "Search", FormMethod.Post, new { id = "frmMain" }))
    {
      @Html.AntiForgeryToken() .....
      <input type="submit" value="Search" id="btnSubmit" /> 
```

当用户单击提交**并且客户端上的所有验证都通过时**，我希望按照下面的 jQuery 禁用提交按钮。我如何知道验证是否在我的 jQuery 脚本中通过了客户端？

```
<script type="text/javascript">

$(document).ready(function () {
    $('input[type=submit]').click(function (e) {
        $(this).attr('disabled', true);
        $(this).attr('value', 'Working');
        $('#frmMain').submit();
    });
}); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-05-09T11:20:18.130

从控制器操作返回部分时我遇到了一些问题。相反，我连接到提交函数并检查表单是否有效，如下所示：

```
 $('form').submit(function () {
            if ($(this).valid()) {
                $('#order-form-submit-button').attr("disabled", true).val("wait...");
            }
        }); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-14T18:09:10.680

您可以将此代码挂接到表单验证器中。只要确保它在 jquery.validator.unobtrusive 之后执行。

```
<script>
    $("#you-form-id").data("validator").settings.submitHandler = function(form) {
         $("#submit-button").attr("disabled",true).val("Working");
         form.submit();
    };
</script> 
```

# javascript - AJAX 不更新变量

> ID：13883813
> 
> 赞同：5
> 
> 时间：2012-12-14T17:51:06.900
> 
> 标签：javascript, ajax, jquery, asynchronous

### jQuery

我正在发出一个 AJAX 请求，该请求`foo`使用来自服务器的响应来更新变量 ( ) 的值。这是我正在使用的代码：

```
//## My variable ##

var foo = "";

//## Send request ##

$.ajax({
    url: "/",
    dataType: "text",
    success: function(response) {
        foo = "New value:" + response;
    },
    error: function() {
        alert('There was a problem with the request.');
    }
});

//## Alert updated variable ##

alert(foo); 
```

问题是 的值`foo`仍然是一个空字符串。我知道这不是服务器端脚本的问题，因为我要么会收到错误警报，要么至少会收到 string `"New value:"`。

这是一个演示问题的 JSFiddle：http: [//jsfiddle.net/GGDX7/](http://jsfiddle.net/GGDX7/)

为什么价值`foo`不变？

* * *

### 纯JS

我正在发出一个 AJAX 请求，该请求`foo`使用来自服务器的响应来更新变量 ( ) 的值。这是我正在使用的代码：

```
//## Compatibility ##

var myRequest;
if (window.XMLHttpRequest) {
    myRequest = new XMLHttpRequest();
} else if (window.ActiveXObject) {
    myRequest = new ActiveXObject("Microsoft.XMLHTTP");
}

//## My variable ##

var foo = "";

//## Response handler ##

myRequest.onreadystatechange = function() {
    if (this.readyState === 4) {
        if (this.status === 200) {
            foo = "New value:" + this.responseText;
        } else {
            alert('There was a problem with the request.');
        }
    }
};

//## Send request ##

myRequest.open('GET', "response.php");
myRequest.send();

//## Alert updated variable ##

alert(foo); 
```

问题是 的值`foo`保持为空字符串。我知道这不是服务器端脚本的问题，因为我要么会收到错误警报，要么至少会收到 string `"New value:"`。

这是一个演示问题的 JSFiddle：http: [//jsfiddle.net/wkwjh/](http://jsfiddle.net/wkwjh/)

为什么价值`foo`不变？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T17:53:26.913

在您提醒 的值时`foo`，成功处理程序尚未触发。由于重新分配变量的是成功处理程序，因此它的值仍然是一个空字符串。

事件的时间线如下所示：

1.  `foo`分配了空字符串
2.  创建并发送 AJAX 请求。
3.  的值`foo`被警告。（请注意，`foo`尚未更改）
4.  AJAX 请求完成。
5.  `foo = "New value:" + this.responseText;`

由于我们想在它发生变化`foo` *后*提醒它的值，解决方案是将提醒放在成功回调中。

现在它将在收到 AJAX 响应后执行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T17:52:31.647

“AJAX”中的（第一个）**A**代表**异步**。事务不会立即发生，因此您`alert()`会在远程调用完成之前相当长的一段时间内发生。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-14T17:54:35.290

问题是您的警报在请求完成之前被触发。试试这个代码：

我已经将 alert 放到了 的回调函数中`$.ajax`，这意味着回调函数只会在`.ajax`部分完成后触发。这将传输新数据，设置变量，然后警告它，而不是同时调用请求和警告变量。

```
$.ajax({
    url: "/",
    dataType: "text",
    success: function(response) {
        foo = "New value:" + response;
        alert(foo);
    },
    error: function() {
        alert('There was a problem with the request.');
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T17:54:53.387

问题很简单...

```
alert(foo); 
```

将在处理请求时执行，并且`foo`不会被更改。

如果你这样做：

```
$.ajax({
    url: "/",
    dataType: "text",
    success: function(response) {
        foo = "New value:" + response;
        alert(foo);
    },
    error: function() {
        alert('There was a problem with the request.');
    }
}); 
```

你会看到它按预期工作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-14T17:55:56.520

您的警报在 Ajax 请求完成之前执行。试试下面的。var foo = "";

```
$.ajax({
    url: "/",
    dataType: "text",
    success: function(response) {
        foo = "New value:" + response;

        alert(foo);
    },
    error: function() {
        alert('There was a problem with the request.');
    }
}); 
```

# jsf - 显示站点当前浏览级别的 JSF 组件？

> ID：13883817
> 
> 赞同：0
> 
> 时间：2012-12-14T17:51:16.270
> 
> 标签：jsf

我不是设计专家，情况是：

我想向我的用户展示被访问的实际路径。我说的是具有 N 个级别的类别，例如我有一个级别，例如：

*   城市 > 汽车 > 进口车
*   城市 > 汽车 > 民族品牌

我希望我的用户能够看到他们当前在 Imported Cars 中，如果他们希望直接在 City 中单击并返回到根类别。

不知道这个怎么称呼？- 我想有一些 JSF 组件来管理这种类型的递归列表。

# c# - 文本框不显示给定的字符串

> ID：13883820
> 
> 赞同：0
> 
> 时间：2012-12-14T17:51:24.153
> 
> 标签：c#, string, textbox, savefiledialog

我的问题的标题似乎比我的问题更简单。我正在做的是试图将一个字符串放入我的文本框中，但它不会进入。我通过将字符串从一个类传递到另一个类然后另一个来做到这一点。可以这么说，有点像从梯子上涓涓细流。字符串从这里开始：

```
public static void FilePath(string fileName)
{
    string fn = fileName;
    PicForm.FileName(fn);
} 
```

`fileName`正在从 中`saveFileDialog`拉出`FilePath(sd.FileName)`。然后它移动到`PicForm.FileName()`，如下所示：

```
public static void FileName(string fileName)
{
    string fn = fileName;
    AddAtt aa = new AddAtt(Form1.con);
    aa.AddScan(fn);            
} 
```

从那里将其发送到`aa.AddScan()`，如下所示：

```
public void AddScan(string fileName)
{
    textBox7.Text = fileName;
} 
```

显然，这是要将字符串输入到文本框中，但事实并非如此。现在我添加了 MessageBoxes 来检查以确保刺痛到这里并且 textBox7.Text 被正确设置为 string(fileName)。MessageBoxes 显示代码有效。但是文本框说的不同。我还尝试了另一种使用 AddScan() 的方法。我将它添加到另一个使用 openFileDialog 的按钮。看起来像这样：

```
private void button3_Click(object sender, EventArgs e)
{
    string Chosen_File = "";
    openFileDialog1.InitialDirectory = "C:";
    openFileDialog1.FileName = "";

    if (openFileDialog1.ShowDialog() == DialogResult.Cancel)
    {
        MessageBox.Show("Operation Cancelled");
    }
    else
    {
        Chosen_File = openFileDialog1.FileName;
        //textBox7.Text = Chosen_File;
        AddScan(Chosen_File);
    }
} 
```

现在，当我`AddScan()`从该单击事件中调用时，textBox7 会正确显示文本。我的问题是为什么它以一种方式工作而不是另一种方式。在我看来，代码应该可以工作。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:26:32.273

在 FileName 函数中，当您确实需要使用该类的现有实例来设置文本框中的文本时，您正在创建 AddAtt 类的新实例。

# objective-c - UITapGestureRecognizer 不适用于 UILabel

> ID：13883823
> 
> 赞同：0
> 
> 时间：2012-12-14T17:51:38.557
> 
> 标签：objective-c, ios

我正在尝试将 UITapGestureRecognizer 添加到 UILabel 中，如果用户有新公告，它将从状态栏向下动画。我希望用户能够单击标签并直接转到公告。UITapGetureRecognizer 不工作。这是我正在做的事情：

```
+(void)animateDown:(NSString *)title view:(UIViewController *)view color:(UIColor *)color time:(NSTimeInterval)duration
{
    view = view.navigationController.visibleViewController;
    if (currentlyDisplayed == NO) {
        if (color == nil) color = customGreen;
        UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0 ,-40, 320, 40)];
        label.text = title;
        label.font = [UIFont fontWithName:@"STHeitiTC-Medium" size:18];
        label.backgroundColor = color;//customBlue;//[UIColor colorWithRed:0.0993145 green:0.0957361 blue:0.562879 alpha:.8f];
        label.layer.cornerRadius = 15.0f;
        [label setTextAlignment:NSTextAlignmentCenter];
        [label setMinimumFontSize:12];
        [label setAdjustsFontSizeToFitWidth:YES];
        [label sizeToFit];
        label.textColor = [UIColor whiteColor];
        if ([color isEqual:customBlue]) {
            UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(onTap:)];
            tap.numberOfTapsRequired = 1;
            tap.numberOfTouchesRequired = 1;
            label.userInteractionEnabled = YES;
            [label addGestureRecognizer:tap];
        }
        [view.view addSubview:label];
        [view.view bringSubviewToFront:label];
        currentlyDisplayed = YES;
        [UIView animateWithDuration:.5f delay:0 options:UIViewAnimationOptionAllowUserInteraction|UIViewAnimationOptionCurveEaseIn animations:^{
            label.frame = CGRectMake(0, 0, 320, 40);
        }completion:^(BOOL finished) {
            CGFloat dur;
            if (duration == 0)  {
                dur = .5f;
            }else {
                dur = duration;
            }

            [UIView animateWithDuration:1 delay:dur options:UIViewAnimationOptionAllowUserInteraction|UIViewAnimationOptionCurveEaseOut animations:^{
                label.frame = CGRectMake(0,-40,320,40);
            }completion:^(BOOL finished) {
                if (finished) [label removeFromSuperview];
                currentlyDisplayed = NO;
            }];
        }]; 
    }else {
        NSMethodSignature *sig = [[self class] methodSignatureForSelector:@selector(animateDown:view:color:time:)];
        NSInvocation *invocation = [NSInvocation invocationWithMethodSignature:sig];
        [invocation setSelector:@selector(animateDown:view:color:time:)];
        [invocation setTarget:self];
        [invocation setArgument:&title atIndex:2];
        [invocation setArgument:&view atIndex:3];
        [invocation setArgument:&color atIndex:4];
        [invocation setArgument:&duration atIndex:5];
        [NSTimer scheduledTimerWithTimeInterval:0.5 invocation:invocation repeats:NO];
    }
}

- (IBAction)onTap:(UIPanGestureRecognizer *)recognizer {
    [[NSNotificationCenter defaultCenter] postNotification:[NSNotification notificationWithName:@"announcementTapped" object:nil]];
    NSLog(@"tapped");
} 
```

onTap 方法永远不会被调用......它进入 if 语句......参见图片： ![在此处输入图像描述](../Images/225c1aa57fb68ca69f51d0ec9e88cd7c.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-14T18:05:16.377

它无法识别触摸，因为它在`UIView`动画块中被点击。

尝试`UIViewAnimationOptionAllowUserInteraction`在动画时添加选项参数。

* * *

## 编辑

问题是`UIView`' 层的实际位置在最终目的地。你想要做的是检查它`presentationLayer`是否在被点击的位置。

为了解决这个问题，您可以将手势添加到主视图而不是实际标签，然后点击检查触摸位置是否在标签的`presentationLayer`:

```
- (IBAction)onTap:(UITapGestureRecognizer *)tapGestureRecognizer {
    CGPoint point = [tapGestureRecognizer locationInView:tapGestureRecognizer.view];
    BOOL labelTapped = [self.label.layer.presentationLayer hitTest:point] != nil;
    if (labelTapped) {
        // do something
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-02-12T15:57:01.567

您需要检查`Userinteraction`的属性`UILabel`是真还是假，如果它是假的，然后将其设置为真。您还可以检查您的故事板或 xib 文件内部并相应地检查它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T17:58:48.140

```
UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(onTap:)];  
//...//
- (IBAction)onTap:(UIPanGestureRecognizer *)recognizer { 
```

更改您的`onTap`签名以匹配您的 GestureRecognizer 类`UITap...`

# c++ - make_unique 不编译

> ID：13883824
> 
> 赞同：9
> 
> 时间：2012-12-14T17:51:49.050
> 
> 标签：c++, visual-studio-2010, visual-c++, c++11, variadic-templates

我正在尝试创建和使用`make_unique`for ，与[此处描述](http://en.cppreference.com/w/cpp/memory/shared_ptr/make_shared)的for`std::unique_ptr`相同。Herb Sutter[提到](http://herbsutter.com/gotw/_102/)了可能的实现，如下所示：`std::make_shared``std::shared_ptr` `make_unique`

```
template<typename T, typename ...Args>
std::unique_ptr<T> make_unique( Args&& ...args )
{
    return std::unique_ptr<T>( new T( std::forward<Args>(args)... ) );
} 
```

它似乎对我不起作用。我正在使用以下示例程序：

```
// testproject.cpp : Defines the entry point for the console application.
#include "stdafx.h"

#include <iostream>
#include <memory>
#include <utility>

struct A {
  A(int&& n) { std::cout << "rvalue overload, n=" << n << "\n"; }
  A(int& n)  { std::cout << "lvalue overload, n=" << n << "\n"; }
};

template<typename T, typename ...Args>
std::unique_ptr<T> make_unique( Args&& ...args ) {
  return std::unique_ptr<T>( new T( std::forward<Args>(args)... ) );
}

int main() {
  std::unique_ptr<A> p1 = make_unique<A>(2); // rvalue
  int i = 1;
  std::unique_ptr<A> p2 = make_unique<A>(i); // lvalue
} 
```

编译器（我使用的是 VS2010）给了我以下输出：

```
1>d:\projects\testproject\testproject\testproject.cpp(15): error C2143: syntax error : missing ',' before '...'
1>d:\projects\testproject\testproject\testproject.cpp(16): error C2065: 'Args' : undeclared identifier
1>d:\projects\testproject\testproject\testproject.cpp(16): error C2988: unrecognizable template declaration/definition
1>d:\projects\testproject\testproject\testproject.cpp(16): error C2059: syntax error : '...'
1>d:\projects\testproject\testproject\testproject.cpp(22): error C2143: syntax error : missing ';' before '{'
1>d:\projects\testproject\testproject\testproject.cpp(22): error C2447: '{' : missing function header (old-style formal list?) 
```

此外，如果您将`make_unique`实现替换为以下内容

```
template<class T, class U>
std::unique_ptr<T> make_unique(U&& u) {
  return std::unique_ptr<T>(new T(std::forward<U>(u)));
} 
```

（取自[此](http://en.cppreference.com/w/cpp/utility/forward)示例），它可以编译并正常工作。

谁能告诉我有什么问题？在我看来，VS2010`...`在模板声明中遇到了一些问题，我不知道该怎么办。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-14T18:03:05.900

可变参数模板在 Visual C++ 11 的已发布版本中不可用。但是，您可以使用大量复制/粘贴不同数量参数的代码来模拟参数扩展，或者使用 Microsoft 自己的实现中使用的相同编译器技巧“伪变量”。来自 Herb Sutter 博客的评论：http: [//herbsutter.com/gotw/_102/#comment-6428](http://herbsutter.com/gotw/_102/#comment-6428)

```
#include <memory> // brings in TEMPLATE macros.

#define _MAKE_UNIQUE(TEMPLATE_LIST, PADDING_LIST, LIST, COMMA, X1, X2, X3, X4)  \
\
template<class T COMMA LIST(_CLASS_TYPE)>    \
inline std::unique_ptr<T> make_unique(LIST(_TYPE_REFREF_ARG))    \
{    \
    return std::unique_ptr<T>(new T(LIST(_FORWARD_ARG)));    \
}

_VARIADIC_EXPAND_0X(_MAKE_UNIQUE, , , , )
#undef _MAKE_UNIQUE 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-14T17:55:04.123

根据[MSDN](http://msdn.microsoft.com/en-gb/library/vstudio/hh567368.aspx)，Visual C++ 2010 或 2012 不支持可变参数模板。

# nhibernate - NHibernate - 由分配的 guid 生成的在 Save() 上被覆盖

> ID：13883826
> 
> 赞同：1
> 
> 时间：2012-12-14T17:51:55.637
> 
> 标签：nhibernate, fluent-nhibernate

谁能告诉我为什么即使我有这个映射：

```
mapping.Id().GeneratedBy.Assigned(); 
```

我自己分配我的实体的ID

打电话后

```
Session.Save(entity) 
```

导致新的 Guid 与我在实体上分配的 Guid 不同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-15T13:05:32.680

Soo.. 下载了 NHibernate 和 Fluent NHibernate 源并努力让它们编译，然后我偶然发现：

```
s.Save(entity, entity.Id); 
```

这迫使它似乎使用提供的 ID。

现在我感到困惑和沮丧，很想知道为什么你需要为某些分配的 id 实体而不是为其他实体这样做......

**赫伦夫**

原来它是以下之间的区别：

```
mapping.Id().GeneratedBy.Assigned(); 
```

和

```
mapping.Id(x => x.Id).GeneratedBy.Assigned(); 
```

前者被接受但被忽略......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:35:23.437

我经常使用分配的 GUID 没有问题。我认为您应该在设置器上为您的 Id 属性设置一个断点，并在更改调用堆栈时检查它。

# matlab - 尝试在初始化 matlab 编译的共享 dll 时调用 mkl 例程

> ID：13883827
> 
> 赞同：0
> 
> 时间：2012-12-14T17:52:11.833
> 
> 标签：matlab, initialization

我有一个调用 MATLAB (v7.0.4) 编译器生成的 dll 的项目。同一个项目还调用了一些 MKL Intel Fortran 2011 例程。该程序抱怨有冲突的 mkl 库试图初始化，因为当我也直接使用更新的 MKL 库中的一些 MKL 例程时，MATLAB 有自己的（在这种情况下是旧的）mkl 库。确切的消息是“OMP abort: initializing libguide40.lib but found libiomp5md.dll already initialized”。INTEL 建议的不太理想的修复方法是设置环境变量 KMP_DUPLICATE_LIB_OK = TRUE 来克服这种情况。我想要一个更合适的解决方案。

自然，这个问题只会在项目调用 MKL 例程时出现，而 Matlab 编译的 dll 已经初始化但尚未终止（使用 Initialize 和 Terminate）。如果我事先在 Matlab 编译的 dll 上调用 Terminate，mkl 例程调用会正常工作。但是，对 Matlab 编译的 dll 和 MKL 的调用是交织在一起的，并且 matlab 编译的 dll 不接受在应用程序中多次使用 Initialize 和 Terminate，因此我无法卸载 matlab dll 以避免出现冲突的 mkl 库调用 MKL 例程，然后重新加载 dll 以进行更多 matlab dll 调用。如果我不止一次使用 matlab 编译的 dll 的接口方法 mclInitializeApplication 和 mclTerminateApplication 程序会崩溃，如果我多次使用 Initialize 和 Terminate，程序将无限期地挂在 Initialize 调用上。我不能使用 mclInhibitShutdown() 因为这不会终止 dll，而我需要这样做才能调用 MKL 例程而不会与 mkl 库发生冲突。

有没有办法在同一个应用程序中重复卸载和重新加载 Matlab 编译的 dll 以避免这种冲突的 mkl 库？我在我的项目和 Matlab 编译的 dll 之间添加了另一个 dll“链接”，但这也没有解决它。所以我的项目调用了一个“链接”dll，它又调用了 Matlab 编译的 dll，我尝试终止 Matlab 编译的 dll，然后释放“链接”dll，但由于某种原因，我仍然无法重新加载 Matlab 编译的 dll。

有关如何处理此问题的任何建议？我是新手，所以我的描述可能不是很准确。

谢谢，萨默。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:59:45.147

两者实际上都是 OpenMP 的运行时库（后来更新和更高级）`libguide40.dll`。`libiomp5md.dll`不推荐使用`KMP_DUPLICATE_LIB_OK = TRUE`，因为它可能会导致性能问题甚至挂起。我只能想到一种可能的解决方案：

切换到较新版本的 MATLAB。使用更高版本的 MATLAB `libiomp5md.dll`，因此您的应用程序可以`libiomp5md.dll`与 MATLAB 附带的链接。

# css - Codeiginter 在 flashdata 上设置样式？如何？可能的？

> ID：13883828
> 
> 赞同：0
> 
> 时间：2012-12-14T17:52:10.530
> 
> 标签：css, codeigniter

打印出来时是否可以在 flashdata 中设置 css 样式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:54:34.930

我的回答很简单：是的

[这是一个火花](http://getsparks.org/packages/flash_message/versions/HEAD/show)，它将所有闪存数据功能包装到一个出色的消息系统中，包括 css 样式。

基本上，您可以修改 flashdata 输出，因此无论何时输出“flashdata”，您都可以在任一侧包含 a`<div class="flash">`和。`</div>`

然后只需根据需要设置 Flash CSS 样式即可。

# javascript - 查找与特定元素相交的所有元素 - RaphaelJs

> ID：13883829
> 
> 赞同：0
> 
> 时间：2012-12-14T17:52:17.180
> 
> 标签：javascript, raphael

我的画布中有多个元素。我想找到与当前选择的元素相交/重叠的所有元素。

有没有办法在 raphael Js 中找到这个？

**编辑** 为了进一步澄清，假设我通过 getByID() 获得一个元素，有没有办法让我获得与它相交的**所有**元素（已经存在于画布中）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T04:05:25.657

再想一想，我认为最好的解决方案应该是将元素转换为路径，然后比较它们是否相交。（我在我的例子中使用了 jQuery，但你可以很容易地在没有 jQuery 的情况下做到这一点）。

```
intersectArray=new Array();  
paper.forEach(function (e) {
    isIntersection=Raphael.pathIntersection(currentElement.attr("path"), e.attr("path"));  //Need to check with currentElement
    if(!jQuery.isEmptyObject(isIntersection)) intersectArray[]=e.node.id; //assuming e has got ID. You can put any identifier for e.
} 
```

我不认为你可以`rect`得到`circle`一条路径。但是编写一个转换`rect`为路径的函数非常容易（因为您知道 x,y 您需要做的就是添加宽度和高度的组合）。使用`circle`此[链接](https://groups.google.com/forum/?fromgroups=#!topic/raphaeljs/6gH8TiOWlAw)。

我希望在 Raphael 中嵌入一个可以做到这一点的功能，但正如小丑所说：“现在*不能依赖任何人，你必须自己做所有事情，不是*吗！”。只是在开玩笑。RaphaelJs 真是太棒了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T14:28:38.600

您将需要使用[`Raphael.isBBoxIntersect`](http://raphaeljs.com/reference.html#Raphael.isBBoxIntersect)which 接受边界框作为参数（从[`Element.getBBox`](http://raphaeljs.com/reference.html#Element.getBBox).

```
// Creates canvas 320 × 200 at 10, 50
var paper = Raphael(10, 50, 320, 200);
// Creates circle at x = 50, y = 40, with radius 10
var circle = paper.circle(50, 40, 10);
// Sets the fill attribute of the circle to red (#f00)
circle.attr("fill", "#f00");
// Sets the stroke attribute of the circle to white
circle.attr("stroke", "#fff");

var circle2 = paper.circle(60, 40, 10);
// Sets the fill attribute of the circle to red (#f00)
circle2.attr("fill", "blue");
// Sets the stroke attribute of the circle to white
circle2.attr("stroke", "#fff");

alert(
  Raphael.isBBoxIntersect(
    circle.getBBox(),
    circle2.getBBox()
  )
); 
```

此代码工作示例：http: [//jsbin.com/uwiyeg/1/edit](http://jsbin.com/uwiyeg/1/edit)

**升级版**。有[`getIntersectionList`](http://msdn.microsoft.com/en-us/library/ie/ff972182%28v=vs.85%29.aspx)SVG 方法“返回其渲染内容与提供的矩形相交的图形元素列表”。但这似乎并非所有浏览器都支持。

# c++ - 具有相同概念的类太多

> ID：13883830
> 
> 赞同：2
> 
> 时间：2012-12-14T17:52:18.497
> 
> 标签：c++, class, interface

我有 5 个用作运算符的类：

```
TurnOn , TurnOff , PushBox , Exit , Enter 
```

对于每种类型，我都有一个包含该类型描述的字符串。

例如 ：

```
class Places {

enum Type { Room1 ,Room2 ,Room3 ,Room4 };

// more stuff

};
TurnOn turnOn(Places::Room1);
string turnOnString = "TurnOn(Room1)" ; 
```

我想将信息存储在地图中，因此每个运营商都有 5 张地图：

```
map <string , TurnOn > opeatorTurnOn;
map <string , TurnOff > opeatorTurnOff ;
map <string , PushBox > opeatorTPushBox ;
map <string , Exit > opeatorExit ;
map <string , Enter > opeatorEnter ; 
```

但现在我有 5 个具有相同概念的映射：一个带有其运算符的字符串。

如何将运算符存储在一张地图中，这样我就不必持有 5 张具有相同概念的地图？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:10:25.377

这取决于您的操作员类是如何实现的（我们的信息很少），但我会制作一张可调用的地图，类似于以下内容：

```
#include <iostream>
#include <functional>
#include <map>

struct op1
{
    void operator()(int i) { std::cout << "op1::operator() " << i << "\n"; }
};

struct op2
{
    void operator()(int i) { std::cout << "op2::operator() " << i << "\n"; }
};

int main()
{
    std::map<std::string, std::function<void(int)>> ops;
    ops["1"] = op1{};
    ops["2"] = op2{};
    ops["1"](42);
    ops["2"](42);
} 
```

如果您不使用`operator()`重载，您也可以始终将操作包装在 lambdas 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T17:55:08.870

使它们都从一个基类继承，存储指向基类的指针并使用多态性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T17:58:13.537

您不能将异构数据类型存储在映射（或任何其他 STL 容器）中。

最简单的解决方法是将它们全部从一个基类中子类化，并将基类存储在您的地图中。

编辑：我没有注意到避免多态性的愿望（虽然，我真的不明白为什么）。无论如何，我认为 boost::any 或 boost::variant 可能会对你有所帮助。您可以将它们全部存储为 boost::any。 [http://www.boost.org/doc/libs/1_52_0/doc/html/any.html](http://www.boost.org/doc/libs/1_52_0/doc/html/any.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T18:00:31.810

`boost::variant`通常用于此类事情。

# iphone - 从 UITextField 获取数据后，我的类的实例成员返回 null

> ID：13883831
> 
> 赞同：0
> 
> 时间：2012-12-14T17:52:21.330
> 
> 标签：iphone, ios

我有一个有两个 NSString 数据成员的类

头文件

```
@interface WebSiteFavorites : NSObject

@property (strong, nonatomic) NSString *titleName;
@property (strong, nonatomic) NSString *url;`

- (id) initWithTitleName: (NSString *)titleName url: (NSString *)url;

@end 
```

我有一个使用此类作为其数据源的 TVC，并且我在 appDelegate 中对我的类的一些实例进行了硬编码，以填充可以工作的 TV。在电视上，我有一个添加按钮，其中包含到 VC 的模态转换。在这个视图控制器中，我有两个文本字段，用户在其中输入名称和 url，然后我使用协议和委托来更新 TVC（我不太明白）。我的问题是，在文本字段中输入所需信息后，我的类实例为空。

这是我的代码

标题 @interface WebSiteFavoritesAddFavoritesViewController : UIViewController

```
@property (strong, nonatomic) WebSiteFavorites *favorites;

@property (weak, nonatomic) IBOutlet UITextField *titleTextField;
@property (weak, nonatomic) IBOutlet UITextField *urlTextField;

@property (strong) id<WebSiteFavoritesDelegate> delegate;

- (IBAction)titleTextFieldChanged;
- (IBAction)urlTextFieldChanged;

- (IBAction)doneButtonTapped:(id)sender;
- (IBAction)cancelButtonTapped:(id)sender;

@end 
```

执行

```
@implementation WebSiteFavoritesAddFavoritesViewController

@synthesize favorites = _favorites;
@synthesize urlTextField = _urlTextField;
@synthesize titleTextField = _titleTextField;

- (IBAction)titleTextFieldChanged
{
    self.favorites.titleName = self.titleTextField.text;

}

- (IBAction)urlTextFieldChanged
{
   self.favorites.url = self.urlTextField.text;

}

- (IBAction)doneButtonTapped:(id)sender
{  
    [self.delegate newFavoriteAdded:self.favorites];
    [self dismissModalViewControllerAnimated:YES];
}

- (IBAction)cancelButtonTapped:(id)sender
{
    [self dismissModalViewControllerAnimated:YES];
}

#pragma mark UITextFieldDelegate
- (BOOL)textFieldShouldReturn:(UITextField *)textField
{
    [textField resignFirstResponder];
    return YES;
}
@end 
```

在 IBAction 方法之后，我使用了断点并且收藏夹为空。我也有一些关于协议和代表的问题，只是为了理解。我为我的协议创建了一个单独的头文件，我的 TVC 符合协议，在我的 VC 中我创建了委托，您可以在我发布的代码中看到它。在我的 TVC 中，我已经实现了协议中的功能。这是正确的顺序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:34:15.893

您必须实例化`favorites`. 如果不实例化对象，则不会保存您分配给它们的值。

所以你必须做...

```
favorites=[[WebSiteFavorites alloc] init]; 
```

或者当您有另一种方法`initWithTitleName:url:`时，请使用它来实例化。

希望这可以帮助！

# c# - 跟踪内部用户经常访问的页面以备将来使用

> ID：13883834
> 
> 赞同：0
> 
> 时间：2012-12-14T17:52:33.577
> 
> 标签：c#, asp.net, settings, webpage

我正在重新设计我们的 Intranet 站点，我想要包括的项目之一是个人快速跳转到每个用户定期访问的前 3 个最常访问的页面。

我不确定如何跟踪最常访问的页面，也不确定应该如何存储它，无论是个人设置还是数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:56:18.317

我会使用数据库。如果您使用的是母版页，您可以在该页面的数据库中存储一个键/值对以及他们访问该页面的次数的计数器。在母版页的 Page_Load 上，如果该页不是 PostBack，则在数据库中插入/更新计数器。这将是最简单的方法。我会提供一个代码示例，但这非常复杂，而且会过大。

# javascript - 擦除 raphael.js 中的路径？

> ID：13883839
> 
> 赞同：1
> 
> 时间：2012-12-14T17:52:49.677
> 
> 标签：javascript, html, svg, raphael, paint

查看 raphael.js 的[文档](http://raphaeljs.com/reference.html)后，我只能找到用于“擦除”纸张的[Paper.clear()](http://raphaeljs.com/reference.html#Paper.clear)和[Element.attr({'clip-rect':...})](http://raphaeljs.com/reference.html#Element.attr)方法。前者会擦除整张纸，而后者会剪切部分现有元素。

是否可以模仿实际的擦除工具擦除纸张中的“路径”？

还是有更好的库更适合实现简单的 MS Paint/Photoshop 克隆？

# ios - 背景图像没有延伸整个屏幕的高度

> ID：13883840
> 
> 赞同：0
> 
> 时间：2012-12-14T17:53:01.557
> 
> 标签：ios, ios5

我的模拟器中出现了这个：

![在此处输入图像描述](../Images/912c0a7eace653adc65f6ff1a46b1c75.png)

而且我不确定为什么背景图像不会一直延伸到屏幕下方。

一种可能性是，由于某种原因，默认情况下，模拟器从水平视图开始，我必须将其向左移动才能看到我发布的图像。

也许解决方法是将默认设置为纵向视图？我该如何设置？我实际上不确定为什么突然有一天我开始默认使用水平视图而不是纵向视图。

谢谢，亚历克斯

编辑：

这是我设置背景图像的方法：

```
- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];

    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone)
    {
        //load iphone image
        UIImageView *imgView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"building"]];
        imgView.frame = self.view.bounds; // to set the frame to your view's size
        [self.view addSubview:imgView];
        [self.view sendSubviewToBack:imgView];
    }
    else
    {
        //load ipad image
        UIImageView *imgView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"building@2x"]];
        imgView.frame = self.view.bounds; // to set the frame to your view's size
        [self.view addSubview:imgView];
        [self.view sendSubviewToBack:imgView];
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:03:49.737

不，这不是原因，因为您正确获得了状态栏。您是使用 InterfaceBuilder 还是以编程方式添加 UIImageView？

如果您使用的是 IB，您如何设置背景图像？如果您`UIImageView`以编程方式添加您在框架中设置的大小？或者，也许您正在使用模式来设置背景颜色？

也许你的 XIB 有水平方向？

请使用属性检查器或一些代码发布来自 XIB 的屏幕截图。

***编辑***：

首先，你没有`@2x`正确使用。这是由 Xcode 图像标签管理的 iPhone 常规或 iPhone Retina。

这就是为什么你有一个错误：

```
imgView.frame = self.view.bounds; 
```

边界与框架不同。尝试使用：

```
imgView.frame = self.view.frame; 
```

这就是为什么：[视图的框架和视图的绑定+ iPhone之间的区别](https://stackoverflow.com/questions/3960051/difference-between-views-frame-and-views-bound-iphone)

> 框架是视图在其父视图中的位置，使用父视图的坐标系。
> 
> 边界是它在自己的坐标系中的位置和大小。

这是一个很好的解释。因此，当您使用边界时，您可能会混淆宽度和高度。尝试`NSLog`它或`po`在调试器中，你会看到。

# objective-c - 将 NSString 中的每个字符与字符集合进行比较

> ID：13883844
> 
> 赞同：0
> 
> 时间：2012-12-14T17:53:08.273
> 
> 标签：objective-c, nsstring, nscharacterset

我的意图是分析用户在文本字段中的输入并检查他是否使用了任何符号。

例如，用户的输入是“/ardv/*k”，我需要一个变量来表示用户输入了 3 个符号。

我不明白如何使用 NSRange 来搜索字符串，因为它会在找到第一个匹配项时立即停止。

此外，NSSet 与 characterAtIndex 选择器不兼容。

isEqualTo：没用。

这是我所做的，但我想知道如果可能的话，如何使这段代码更简单：

```
 ...
    NSString *testThisString = @"/ardv/*k";        
    NSCharacterSet *unknownFlags1 = [NSCharacterSet punctuationCharacterSet];
    NSCharacterSet *unknownFlags2 = [NSCharacterSet symbolCharacterSet];
    NSCharacterSet *unknownFlags3 = [NSCharacterSet whitespaceCharacterSet];

    int count = 0;
    for (int i = 0; i < [testThisString length]; i++) {
    if ([unknownFlags1 characterIsMember:[testThisString characterAtIndex:i]] |
   [unknownFlags2 characterIsMember:[testThisString characterAtIndex:i]] | 
   [unknownFlags3 characterIsMember:[testThisString characterAtIndex:i]]) {
        count++;
    }
}
    NSLog(@"There are %d unknowns", count);
  ... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:09:52.227

要检查一个字符串是否包含属于某个集合的任何字符，您只需执行以下操作：

```
NSString *testString = @"hello$%^";
NSRange r = [testString rangeOfCharacterFromSet:[NSCharacterSet punctuationCharacterSet]];
if (r.location != NSNotFound) {
    // the string contains a punctuation character
} 
```

如果您想知道标点符号的所有位置，只需使用不同的输入范围继续搜索即可。就像是：

```
NSRange searchRange = NSMakeRange(0, [testString length]);
while (searchRange.location != NSNotFound) {
    NSRange foundRange = [searchString rangeOrCharacterFromSet:[NSCharacterSet punctuationCharacterSet] options:0 range:searchRange];
    searchRange.location = foundRange.location + 1;
    searchRange.length = [testString length] - searchRange.location;
    if (foundRange.location != NSNotFound) {
        // found a character at foundRange.location
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:09:02.493

> 此外，NSSet 与 characterAtIndex 选择器不兼容。

```
- (BOOL)characterIsMember:(unichar)aCharacter;
- (unichar)characterAtIndex:(NSUInteger)index; 
```

它们都是 unichar 的，所以你可以这样做。你做得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T18:21:50.360

坦率地说，我只是遍历字符串的字符，单独检查每个字符，然后通过 if-ladder 或类似的方法运行每个字符以检查您的“符号”。可能比使用 rangeOfCharactersFromSet 的任何 kluge 更快，并且更容易理解和维护。

提示：仅从字符串中提取字符一次，并将其放入`unichar`临时文件中，而不是重复`characterAtIndex`多次。更快更清晰。

此外，如果您正在处理的字符集是 ASCII（即，字符值小于等于 127），您可以组成一个位或字节数组来指示每个字符的有效性。（您甚至可以对更宽的字符执行此操作，但映射数组会变得更大。）不如 NSCharacterSet 优雅，但您可以将所有条件折叠到一个对象中。（您也可以将所有条件折叠到一个 NSCharacterSet 中，但它需要提取位图并将它们组合在一起。）

# python - 我的 OSQA 用户在更改密码后无法访问其身份验证设置

> ID：13883845
> 
> 赞同：-1
> 
> 时间：2012-12-14T17:53:09.433
> 
> 标签：python, django, osqa

一些用户抱怨他们无法访问 OSQA 上的身份验证设置页面。他们收到 500 错误。[请参阅屏幕截图](http://i.stack.imgur.com/Eq6Q9.png)但是，只有在他们完成“我忘记了密码”或更改密码之后。
看日志，具体报错是：

```
UnboundLocalError: local variable name 'name' referenced before assignment 
```

有没有其他人经历过这个？如果是这样，我该如何解决它。
预先感谢您的帮助。！！

日志中的堆栈跟踪如下（抱歉格式不正确）：

```
DIRECTORY/forum/templatetags/extra_tags.py TIME: 2012-12-13 09:23:31,419 MSG:extra_tags.py:render:312 Error in declare tag, when evaluating:    questions.children_count('answer')
DIRECTORY/apps/django/lib/python2.6/site-packages/django/core/handlers/base.py TIME: 2012-12-14 12:40:31,086 MSG: base.py:handle_uncaught_exception:209 Internal Server Error: /osqa/account/9/authsettings/
Traceback (most recent call last):
  File "DIRECTORY/apps/django/lib/python2.6/site-packages/django/core/handlers/base.py", line 111, in get_response
    response = callback(request, *callback_args, **callback_kwargs)
  File "DIRECTORY/apps/osqa/forum/views/auth.py", line 348, in auth_settings
    'name': name,
UnboundLocalError: local variable 'name' referenced before assignment
DIRECTORY/apps/osqa/forum/views/meta.py TIME: 2012-12-14 12:40:31,093 MSG: meta.py:error_handler:200 
        error executing request:
        PATH: /osqa/account/9/authsettings/
        USER: USER (1)
        METHOD: GET
        POST PARAMETERS:
            None
        GET PARAMETERS:
            None
        HTTP HEADERS:
            mod_wsgi.listener_port: 8080
    HTTP_REFERER: URL/osqa/users/9/USER
            mod_wsgi.listener_host: 
    SERVER_SOFTWARE: Apache
        SCRIPT_NAME: /osqa
        mod_wsgi.handler_script: 
    SERVER_SIGNATURE: 
    REQUEST_METHOD: GET
    PATH_INFO: /account/9/authsettings/
    SERVER_PROTOCOL: HTTP/1.1
    QUERY_STRING: 
    HTTP_ACCEPT_CHARSET: ISO-8859-1,utf-8;q=0.7,*;q=0.3
    HTTP_USER_AGENT: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11
    HTTP_CONNECTION: keep-alive
    HTTP_COOKIE: sessionid=REDACTED; csrftoken=REDACTED
    SERVER_NAME: SERVERNAME
    REMOTE_ADDR: SERVERIP
    mod_wsgi.request_handler: wsgi-script
    wsgi.url_scheme: http
    PATH_TRANSLATED: DIRECTORY/apache2/htdocs/account/9/authsettings/
    SERVER_PORT: 8080
    wsgi.multiprocess: True
    mod_wsgi.input_chunked: 0
    SERVER_ADDR: SERVERIP
    DOCUMENT_ROOT: DIRECTORY/apache2/htdocs
    mod_wsgi.process_group: 
    SCRIPT_FILENAME: DIRECTORY/apps/osqa/scripts/osqa.wsgi
    SERVER_ADMIN: you@example.com
    wsgi.input: <mod_wsgi.Input object at 0x46feab0>
    HTTP_DNT: 1
    HTTP_HOST: SERVER:8080
    wsgi.multithread: False
    mod_wsgi.callable_object: application
    REQUEST_URI: /osqa/account/9/authsettings/
    HTTP_ACCEPT: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
    wsgi.version: (1, 1)
    GATEWAY_INTERFACE: CGI/1.1
    wsgi.run_once: False
    wsgi.errors: <mod_wsgi.Log object at 0x487c4f0>
    REMOTE_PORT: 51455
    HTTP_ACCEPT_LANGUAGE: en-US,en;q=0.8
    mod_wsgi.version: (3, 3)
    mod_wsgi.application_group: localhost:8080|/osqa
    mod_wsgi.script_reloading: 1
    wsgi.file_wrapper: <built-in method file_wrapper of mod_wsgi.Adapter object at 0x47bf0a8>
    CSRF_COOKIE: REDACTED
    HTTP_ACCEPT_ENCODING: gzip,deflate,sdch

    COOKIES:
             csrftoken: REDACTED
    sessionid: REDACTED

    EXCEPTION INFO:
        Traceback (most recent call last):
      File "DIRECTORY/apps/django/lib/python2.6/site-packages/django/core/handlers/base.py", line 111, in get_response
        response = callback(request, *callback_args, **callback_kwargs)
      File "DIRECTORY/apps/osqa/forum/views/auth.py", line 348, in auth_settings
        'name': name,
    UnboundLocalError: local variable 'name' referenced before assignment 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:17:13.990

查看 的源代码`osqa`，可以在您遇到问题的行周围找到以下内容（行号与您的不同，但这可能是由于版本差异）：

```
347     for k in auth_keys:
348         provider = AUTH_PROVIDERS.get(k.provider, None)
349
350         if provider is not None:
351             name =  "%s: %s" % (provider.context.human_name, provider.context.readable_key(k))
352         else:
353             from forum.authentication.base import ConsumerTemplateContext
354             "unknown: %s" % ConsumerTemplateContext.readable_key(k)
355 
356         auth_keys_list.append({
357         'name': name,
358         'id': k.id
359         }) 
```

看起来在第 354 行，我们应该有`name = "unknown: %s" % ConsumerTemplateContext.readable_key(k)`，但有人忘记了`name =`。

我不能 100% 确定这一点，因为我并不真正了解`osqa`这一点，但如果我们保持原样，这个语句不会做任何事情。此外，您的错误是 100% 可重现的，前提是您可以确定为什么`k.provider`不在 中`AUTH_PROVIDERS`，我想这一定*很不*常见。

* * *

您可能想[在`osqa`'s bug tracker](http://jira.osqa.net/secure/Dashboard.jspa)提交错误。为了在短期内解决您的问题，您可以：

*   找出你`provider`的原因`None`。（显然，由存在 和不对应于任何一个`auth_key`的电流引起的问题）。`user``AUTH_PROVIDERS`
*   自己修复代码中的那一行。

# java - 循环中 IF 的优雅解决方案

> ID：13883847
> 
> 赞同：2
> 
> 时间：2012-12-14T17:53:15.773
> 
> 标签：java, performance, optimization

最近我写了这样的东西：

```
public void doSomething(boolean b1, boolean b2){
   while(true){
      if(b1){
         doThis();
      }
      if(b2){
         doThat();
      }
   }
} 
```

但我真的不喜欢这个解决方案，因为在每次迭代中，您都必须检查 2 个布尔值。因此，作为可能的解决方案，我可以想象在每个循环之前用 ifs 编写 4 个 while 循环，但由于显而易见的原因，这很不利于可维护性。你有什么建议可以让这段代码变得更好更有效吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-14T17:59:50.653

这看起来像过早的优化。

**这是一个思维陷阱。**

在您的申请完成并正确之前，不要担心这样的细节。然后，如果它不够快，就拿出一个分析器，看看程序的时间花在了哪里。

不要浪费脑力去优化可能不引人注目的事情。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-14T18:02:52.507

从性能的角度来看，因为`b1`并且没有在方法中修改，[分支预测](https://stackoverflow.com/a/11227902/829571)`b2`和/或 JIT 编译极有可能优化测试，并且实际条件检查几乎不会（如果有的话）惩罚该方法的性能.

如果不是`if(b1)`你，`if(getB1())`那么可能会有更多的改进空间。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-14T20:43:58.580

CPU 设计者已经想到了这一点。这称为分支预测。这样做是有效地跳过通常不被调用的分支。这意味着 CPU 将动态删除未使用的分支，几乎不会影响性能。唯一的影响是当预测出错时，因为“回滚”可能很复杂。在你的情况下，布尔值不会改变，所以你不应该看到问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-14T18:09:44.640

我同意这是过早的优化，但是如果您的语言对短路评估有保证，那么您可以使用另一种构造。由于 java 不允许您将`void`返回类型转换为`boolean`，因此您需要修改`doThis()`并`doThat()`返回`boolean`。

```
public void doSomething(boolean b1, boolean b2){
    while(true){
        b1 && doThis(),
        b2 && doThat();
    }
} 
```

仅当`(x && foo())`的值为真时才会执行该函数`x`，否则将启动短路评估。

您必须非常小心，您的编译器不会仅仅优化整个表达式，因为实际上没有分配任何值。

在所有情况下都可以避免两种比较的真正可能的优化是在内部循环中使用 switch 语句。

```
public void doSomething(boolean b1, boolean b2){
    int state = (b1 ? 1 : 0) + (b2 ? 2 : 0);
    while(true){
        switch (state){
            case 1: doThis(); break;
            case 3: doThis();
            case 2: doThat();
            default:
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-14T17:55:10.670

```
public void doSomething(boolean b1, boolean b2){
   while(true){
      if(b1 && b2)  
      {  
        doThis();  
        doThat();  
      }
      else if(b1){
         doThis();
      }
      else if(b2){
         doThat();
      }

   }
} 
```

编译器将对此进行优化，并且不会在循环中命中每个 if / else if 块。类似于 switch 语句。回顾潜在的逻辑，如果`b1`和`b2`是真的，你想要`doThis`和`doThat`。否则只有一个是正确的，并且逻辑与以前相似。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2012-12-14T17:59:42.400

我想你可以将 if 语句移到 while 之外，就像这样

```
if (b1) {
    while (true) {
        doThis();
    }
}
if (b2) {
    while (true) {
        doThat();
    }
} 
```

但是您实际上并没有获得任何好处，因为您仍然必须评估使 while 循环重复的条件，并且您必须执行两倍于原始代码的频率。

# javascript - 如何在javascript中实现函数createCookie

> ID：13883849
> 
> 赞同：3
> 
> 时间：2012-12-14T17:53:17.227
> 
> 标签：javascript, jquery, facebook, html, popup

所以我有这个脚本（一个倒数计时器，当达到零时关闭“#fb-popupdiv”div）：

```
var dom = {};
dom.query = jQuery.noConflict(true);
var time = 11;
window.setInterval(test, 1000);
function test()
{
    time -=1;
    dom.query('#my_timer').html(time); 
    if(time == 0)        
    {
        dom.query('#fb-popupdiv').remove();
    }
} 
```

有什么办法可以结合这个吗？：

```
function createCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
   else var expires = "";
   document.cookie = name+"="+value+expires+"; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
       if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);

    }
    return null;
}

function eraseCookie(name) {
    createCookie(name,"",-1);
}​ 
```

让我解释。我正在制作一个likebox popup div，我希望访问我网站的用户在一天内只看到一次弹出窗口（因此，他们不会一次又一次地访问我的网站，多次看到它）。所以我试图想办法结合这两个脚本来实现这一点。

这是我到目前为止所得到的：

HTML：

```
<div id="fb-popupdiv">
<div id="fb-popup">
<h1 class="fb-title">To continue, click "Like" button</h1>
<p style="background:#fff;padding-bottom:20px;">
<iframe src="//www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2FBlindGuardianArgentina&amp;width=457&amp;height=263&amp;show_faces=true&amp;colorscheme=light&amp;stream=false&amp;border_color=%23fff&amp;header=false" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:457px; height:263px;" allowTransparency="true"></iframe>
<span class="fb-closebutton">Or wait <span id="my_timer"></span> seconds.</span>
</p>
</div>
</div> 
```

CSS：

```
#popupdiv{position:absolute;display:none;}
#fb-popupdiv{display:block;top:180px;left:278.5px;width:500px;height:355px;position:fixed;background-image:url('http://i.imgur.com/IHT1l.png');margin:0;overflow-y:auto;z-index:999999;text-align:center;border:10px solid rgba(82, 82, 82, .7);border-radius:8px;}
#fb-popup{background-color:#fff;overflow:none;z-index:999999;height:227px;}
.fb-title{background:#6D84B4 none repeat scroll 0 0;border-top:1px solid #3B5998;border-left:1px solid #3B5998;border-right:1px solid #3B5998;color:white !important;padding:5px !important;margin:0 !important;font:normal 14px "Lucida Sans Unicode", "Lucida Grande", sans-serif !important;}
.fb-closebutton{float:right;font:normal 11px/2.5em Arial, sans-serif !important;padding:5px 15px 20px 0;background:#fff;width:97%;text-align:right;color:#000 !important;}
#my-timer{width:400px;background:#fff; margin:0 auto;padding:5px 0px 5px 0px;} 
```

这是可能的，还是我做错了？

我是新手，对不起。

提前致谢！

PS：请原谅我糟糕的英语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T17:58:23.797

你考虑过[jquery.cookie](https://github.com/carhartl/jquery-cookie)插件吗？

```
if (!$.cookie('daily_popup')) {
    // Code to show modal/popup; e.g. show_modal();
    $.cookie('daily_popup', 1, {expires: 1});
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:00:47.510

查看插件：

[https://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

然后你可以这样做：

```
$.cookie("test", 1); 
```

删除：

```
$.cookie("test", null); 
```

此外，要在 cookie 上设置一定天数（此处为 10）的超时时间：

```
$.cookie("test", 1, { expires : 10 }); 
```

如果省略 expires 选项，则 cookie 成为会话 cookie，并在浏览器退出时被删除。

涵盖所有选项：

```
$.cookie("test", 1, {
   expires : 10,           //expires in 10 days

   path    : '/',          //The value of the path attribute of the cookie 
                           //(default: path of page that created the cookie).

   domain  : 'jquery.com',  //The value of the domain attribute of the cookie
                           //(default: domain of page that created the cookie).

   secure  : true          //If set to true the secure attribute of the cookie
                           //will be set and the cookie transmission will
                           //require a secure protocol (defaults to false).
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T18:07:47.777

听起来您在询问更多关于如何使用 cookie 代码以便每天只显示一次的信息。这是基本的逻辑。

在你的 CSS 中有这个，所以默认情况下弹出窗口不可见：

```
#fb-popupdiv {display: none;} 
```

然后，添加这个 javascript：

```
dom.query(document).ready(function() {
    var val = readCookie("popupAlreadyShown");
    if (!val) {
        createCookie("popupAlreadyShown", 1, 1);
        // use your code here to show the popup here
        dom.query("#fb-popupdiv").show();
    } else {
        // popup was already shown less than 1 day ago
        // because cookie still exists
        // do anything else you might want to do here
    }
}); 
```

# cocos2d-x - 在 CCTextFieldTTF 上获取文本尺寸

> ID：13883850
> 
> 赞同：0
> 
> 时间：2012-12-14T17:53:25.763
> 
> 标签：cocos2d-x, cclabelttf

嗨，我想知道 CCTextFieldTTF 内文本的宽度，但我找不到办法，我想要这个宽度，所以我可以在那个位置移动 CCLabelTTF，这样它就可以像 CCTextFieldTTF 的光标

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:44:09.730

怎么样：

```
float labelWidth = label.contentSize.width; 
```

;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:59:19.027

所以我想出了一个真正有效的想法

在 CCTextFieldTTF.h 中声明一个新方法

```
float getTextDimensions(); 
```

在你的 .cpp

```
float CCTextFieldTTF::getTextDimensions()
{
    return CCLabelTTF::getContentSize().width;
} 
```

并且知道只需调用您的 CCTextFieldTTF 对象

```
m_pTextField->getTextDimensions() 
```

随心所欲

# ruby-on-rails - Rails Fullcalendar：将自定义参数添加到源 URL

> ID：13883859
> 
> 赞同：0
> 
> 时间：2012-12-14T17:54:06.037
> 
> 标签：ruby-on-rails, fullcalendar

我有一个在 Rails 中工作的 Fullcalendar。我还在事件表中添加了额外的字段和获取用户输入的模式。保存记录时，会自动将当前用户的user_id保存在事件表中。

我想让日历显示只有 current_user 的事件。

现在 calendar.js.coffee 文件有这个用于获取事件数据：

```
 eventSources: [{
  url: '/events',
}], 
```

如何修复它，以便只显示 current_user 的事件数据？我是否在事件控制器中放置了一些代码？还是咖啡代码中的某些内容？

我应该在控制器的 json 部分添加一些选择代码吗？

```
 class EventsController < ApplicationController
  # GET /events
  # GET /events.json
  def index
    @events = Event.scoped
    @events = Event.between(params['start'], params['end']) if  (params['start'] && params['end'])
   respond_to do |format|
  format.html # index.html.erb
  format.json { render :json => @events }
  end
end 
```

以下似乎不起作用：

```
 format.json { render :json => @events, :user_id => current_user.id } 
```

谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:39:42.283

你是在正确的方式；）`for_user`在事件模型中使用一个范围（我命名它，如果需要我可以发布关于这个范围的代码）来检索特定用户的事件。

```
def index
  @events = Event.scoped
  @events = @events.between(params['start'], params['end']) if  (params['start'] && params['end'])
  @events = @events.for_user(params[:user_id]) if params[:user_id].present?
  respond_to do |format|
    format.html # index.html.erb
    format.json { render :json => @events }
  end
end 
```

现在您需要将 a 传递`params[:user_id]`给 index 操作，这可能是`current_user.id`您的情况；）

```
eventSources: [{
  url: '/events',
  data: { user_id: current_user.id }
}], 
```

**警告：安全问题**

这样做将使您能够将任何 user_id 放入 URL 并查看其他用户的数据。添加对 index 操作的验证，以确保您只能访问 current_user 的数据：

```
@events = @events.for_user(params[:user_id]) if params[:user_id].present? && params[:user_id] == current_user.id 
```

# c# - 将一个方法传递给另一个方法

> ID：13883863
> 
> 赞同：0
> 
> 时间：2012-12-14T17:54:13.467
> 
> 标签：c#, reflection

我希望能够在另一种方法中指定一种方法。

就像是

```
public class Binder
{
    public void Bind(whatShouldIWriteHere?)
    {
        // do stuff with the MethodInfo
    }
} 
```

这样我就可以做到：

```
public class A
{
    public void DoIt(string tmp)
    {
    }
}

var binder = new Binder()
binder.Bind<A>(x => x.DoIt); 
```

代替：

```
var method = typeof(A).GetMethod("DoIt");
binder.Bind(method); 
```

那可能吗？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:59:43.710

将方法作为委托传递并使用 Delegate.Method 属性。

在您的情况下，Binder.Bind 就像：

```
public void Bind(Delegate del)
{
    var info = del.Method;
    //Add your logic here.
} 
```

并将方法传递给它：

```
var binder = new Binder();
var instance = new A();
binder.Bind(new Action<string>(instance.DoIt)) 
```

# php - PHP 克隆孩子

> ID：13883864
> 
> 赞同：2
> 
> 时间：2012-12-14T17:54:15.207
> 
> 标签：php, clone

我有一个对象，它是一个基本的树。我需要对其进行深层复制，并发现自己实现了 __clone 方法。成功的代码是：

```
function __clone() {
    $object = new CustomXML($this->rootElement);
    foreach ($this->elements as $key => $element) {
        $this->elements[$key] = clone $this->elements[$key];
        $object->elements[$key] = $this->elements[$key];
    }
    $object->attributes = $this->attributes;
    $object->value = $this->value;
    $object->allowHTML = $this->allowHTML;
    $object->endTag = $this->endTag;
    $object->styles = $this->styles;
    $object->childID = $this->childID;

    return $object;
} 
```

我的问题是......为什么我必须使用

```
$this->elements[$key] = clone $this->elements[$key];
$object->elements[$key] = $this->elements[$key]; 
```

为什么我不能只使用

```
$object->elements[$key] = clone $this->elements[$key]; 
```

使用第二个仍然会留下对孩子的引用。为什么是这样？$this->elements 中的值属于同一类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:13:54.760

`__clone()`在*已创建的对象浅表副本*上调用。[请参阅文档](http://php.net/manual/en/language.oop5.cloning.php)

PHP 将浅拷贝所有属性并创建一个新对象，而不调用其构造函数（类似于序列化和反序列化）。然后 PHP 调用*新*对象，以便您可以`__clone()`根据自己的想法对其进行*修改。*因为它*修改*了对象，所以它不应该返回任何东西。

 ***你的代码（如果你总是想要一个深拷贝）应该是这样的：

```
 function __clone() {
        foreach ($this->children as $key => $child) {
            $this->children[$key] = clone $this->children[$key];
        }
   } 
```

但是我**强烈建议您不要这样做**！不要依赖`clone`关键字，而是添加方法以显式返回克隆对象（例如，[`DOMNode::cloneNode()`](http://php.net/manual/en/domnode.clonenode.php)。这将让您控制副本应该是浅的还是深的。如果您只是使用`clone`，则无法控制它。

这是一个例子：

```
interface DeepCopyable
{
    /**
     * Return a copy of the current object
     *
     * @param $deep bool If TRUE, return a deep copy
     * @return object
     */
    public function copy($deep=false);
}

class TreeNode implements DeepCopyable
{
    private $I_AM_A_CLONE = false;
    protected $children = array();

    function __clone() {
        $this->I_AM_A_CLONE = true;
    }

    public function addChild(Copyable $child) {
        $this->children[] = $child;
    }

    public function copy($deep=false) {
        $copy = clone $this;
        if ($deep) {
            foreach ($this->children as $n => $child) {
                $copy->children[$n] = $child->copy($deep);
            }
        }
        return $copy;
    }
}

$a = new TreeNode();
$a->addChild(new TreeNode());
var_dump($a);
var_dump($a->copy());
var_dump($a->copy(true)); 
```

此示例还说明了*正确*使用`__clone()`. **当克隆对象的私有或受保护属性不应与原始属性相同时，**您需要添加克隆魔术方法。例如，如果您`id`在一个对象上有一个应该是唯一的属性，您可能希望确保克隆不会具有相同的 ID，并且您永远不想调用代码来控制它。或“脏”标志，或其他任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:37:44.920

经过长时间的回顾，我创建了一个测试场景，并意识到我根本不了解克隆方法。

考虑这个示例代码：

```
<?php
    class A {
        function __construct($value = "1") {
            $this->value = $value;
            $this->children = array();
        }

        function addChild() {
            $this->children[] = new A(count($this->children));
        }

        function __clone() {

            foreach ($this->children as $key => $child) {
                $this->children[$key] = clone $this->children[$key];
                //$object->children[$key] = clone $this->children[$key];
            }
        }
    }

    $a = new A();
    $a->addChild();

    $b = clone $a;

    var_dump($b);
    $b->value = "test";
    $b->children[0]->value = "test2";

    var_dump($a);
    var_dump($b); 
```

**正在调用`$b`**clone 方法，而不是在 $a 上。所以本质上，调用`$this->children[$key] = clone $this->children[$key];`就是破坏引用。在这里返回一个值是没有意义的。总之，我的代码应该是这样的：

```
foreach ($this->elements as $key => $element) {
    $this->elements[$key] = clone $this->elements[$key];
} 
```

你可能会说调用`$b = clone $a;`相当于做：

```
$b = $a;
$b->__clone(); 
```***

# typescript - TypeScript 没有编译时错误

> ID：13883870
> 
> 赞同：1
> 
> 时间：2012-12-14T17:54:36.523
> 
> 标签：typescript

我无法在 VS 2012 中获得 TypeScript 的编译时错误或成功构建。我在我的项目文件中使用它：

```
<Target Name="BeforeBuild">
    <Exec Command="&quot;$(PROGRAMFILES)\Microsoft SDKs\TypeScript\0.8.0.0\tsc --module amd -target ES5         &quot; @(TypeScriptCompile ->'&quot;%(fullpath)&quot;', ' ')" IgnoreExitCode="true" />
</Target> 
```

例如错误应该是这样的：

> Greeter.ts(7,26)：提供的参数与调用目标的任何签名都不匹配

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:28:19.000

你的关闭`&quot;`是错误的。应该：

`Command="&quot;$(PROGRAMFILES)\Microsoft SDKs\TypeScript\0.8.0.0\tsc&quot; module amd -target ES5 @(TypeScriptCompile ->'&quot;%(fullpath)&quot;', ' ')" IgnoreExitCode="true" />`

# java - 如何使用 CompareTo 按升序和降序对 PlaneMap 进行排序

> ID：13883871
> 
> 赞同：0
> 
> 时间：2012-12-14T17:54:38.933
> 
> 标签：java, hashmap, compareto

我试图按升序和降序对我的飞机进行排序。我有一个飞机的哈希图，我想比较它们，以便我可以通过按 timeLimitBeforeLand 对地图进行排序来获得下一架飞机和最后一架飞机。我写了一个 compareTo 方法，它看起来像：

```
//---------------------------------------------------------------------------------------
//  CompareTo() used with the Comparable implementation.
//---------------------------------------------------------------------------------------
        public int compareTo(Object arg0) 
        {
            if((arg0 != null) && (arg0 instanceof Plane))
            {
            Plane p = (Plane) arg0;
            return (int)Math.ceil(this.timeLimitBeforeLand - p.getLimitBeforeLand());
            }
            return 0;
        } 
```

CompareTo 需要 timeLimitBeforeLand：

```
// ---------------------------------------------------------------------------------------
//      Name:        getTimeLimitBeforeLand.
//      Description: Get the time before every plane is going to land.
//---------------------------------------------------------------------------------------
        public double getTimeLimitBeforeLand()
        {
        double fuelConsumption;
        double timeLimitBeforeLand = 0;

        for (TreeMap<String, Plane> theEntry : airlineMap.values()) {
        for (Plane aPlane : theEntry.values()) {
        if (aPlane.getPlaneType() == aPlane.getPlaneType().AIRBUS) {
        System.out.println(" ");
        System.out.println(aPlane);
        fuelConsumption = 2;
        timeLimitBeforeLand = (double) (aPlane.getFuelRemaining() / fuelConsumption);
        System.out.println(timeLimitBeforeLand + " minutes to land.");
        System.out.println(" ");
        } else if (aPlane.getPlaneType() == aPlane.getPlaneType().CORPORATE) {
        System.out.println(" ");
        System.out.println(aPlane);
        fuelConsumption = 3;
        timeLimitBeforeLand = (aPlane.getFuelRemaining() / fuelConsumption);
        System.out.println(timeLimitBeforeLand + " minutes to land.");
        System.out.println(" ");
        } else if (aPlane.getPlaneType() == aPlane.getPlaneType().PRIVATE) {
        System.out.println(" ");
        System.out.println(aPlane);
        fuelConsumption = 4;
        timeLimitBeforeLand = (double) (aPlane.getFuelRemaining() / fuelConsumption);
        System.out.println(timeLimitBeforeLand + " minutes to land.");
        System.out.println(" ");
        }
        }
        }
        return timeLimitBeforeLand;
        } 
```

到目前为止，我在 mainApp 中的尝试：

```
TreeMap<String, PlaneStore> map = new TreeMap<String, PlaneStore>();

        ArrayList<Plane> copyList = new ArrayList<Plane>(map.);

        Plane comp = new Plane();

        Collections.sort(copyList, plane); 
```

飞机类：

```
//---------------------------------------------------------------------------------------
//  Name:           Imports. 
//  Description:    To allow the use of different Java classes.
//---------------------------------------------------------------------------------------
import java.io.Serializable;
//---------------------------------------------------------------------------------------
//Name:         Class declaration. 
//---------------------------------------------------------------------------------------
public class Plane implements Comparable, Serializable
{   
//---------------------------------------------------------------------------------------
//  Variable declarations.
//---------------------------------------------------------------------------------------
    private String flightNumber;
    public String airlineName;
    private double fuelRemaining;
    private int overdue;
    private int passengerNumber;
//---------------------------------------------------------------------------------------
//  Enum declaration.
//---------------------------------------------------------------------------------------
    private AIRPLANETYPE planeType;
    private boolean isLanded = false;
    public double timeLimitBeforeLand;
//---------------------------------------------------------------------------------------
//  Enum Constuctor.
//---------------------------------------------------------------------------------------
    public enum AIRPLANETYPE
    {
        AIRBUS("1"), CORPORATE("2"), PRIVATE("3");

        private String planeName;

        private AIRPLANETYPE(String planeName)
        {
            this.planeName = planeName;
        }

        public String getPlaneName()
        {
            return this.planeName;
        }
    }
//---------------------------------------------------------------------------------------
//  Constructor.
//---------------------------------------------------------------------------------------
    public Plane(String flightNumber, String airlineName,
           double fuelRemaining, int overdue, int passengerNumber, 
           AIRPLANETYPE planeType, boolean isLanded) 
    {
        this.flightNumber = flightNumber;
        this.airlineName = airlineName;
        this.fuelRemaining = fuelRemaining;
        this.passengerNumber = passengerNumber;
        this.overdue = overdue;
        this.planeType = planeType;
        this.isLanded = isLanded;
    }
//---------------------------------------------------------------------------------------
//  Getters and Setters.
//---------------------------------------------------------------------------------------
    public String getAirlineName() 
    {
        return airlineName;
    }
    public void setAirlineName(String airlineName) 
    {
        this.airlineName = airlineName;
    }
    public void setOverdue(int overdue) 
    {
        this.overdue = overdue;
    }
    public int getOverdue()
    {
        return overdue;
    }
    public String getFlightNumber() 
    {
        return flightNumber;
    }
    public void setFlightNumber(String flightNumber) 
    {
        this.flightNumber = flightNumber;
    }
    public double getFuelRemaining() 
    {
        return fuelRemaining;
    }
    public void setFuelRemaining(double fuelRemaining) 
    {
        this.fuelRemaining = fuelRemaining;
    }
    public int getPassengerNumber() 
    {
        return passengerNumber;
    }
    public void setPassengerNumber(int passengerNumber) 
    {
        this.passengerNumber = passengerNumber;
    }
    public AIRPLANETYPE getPlaneType() 
    {
        return planeType;
    }
    public void setPlaneType(AIRPLANETYPE planeType) 
    {
        this.planeType = planeType;
    }
    public boolean isLanded() 
    {
        return isLanded;
    }
    public void setLanded(boolean isLanded)
    {
        this.isLanded = isLanded;
    }
    public double getLimitBeforeLand() 
    {
        return timeLimitBeforeLand;
    }

public void setTimeLimitBeforeLand(double timeLimitBeforeLand) 
{
this.timeLimitBeforeLand = timeLimitBeforeLand;
}

//---------------------------------------------------------------------------------------
//  CompareTo() used with the Comparable implementation.
//---------------------------------------------------------------------------------------
    public int compareTo(Object arg0) 
    {
        if((arg0 != null) && (arg0 instanceof Plane))
        {
        Plane p = (Plane) arg0;
        return (int)Math.ceil(this.timeLimitBeforeLand - p.getLimitBeforeLand());
        }
        return 0;
    }
//---------------------------------------------------------------------------------------
//  toString().
//---------------------------------------------------------------------------------------
    public String toString() 
    {
        return "Plane: flightNumber=" + flightNumber + "."
                + " airlineName=" + airlineName + "."
                + " fuelRemaining=" + fuelRemaining + " litres."
                + " overdue=" + overdue + " minutes."
                + " passengerNumber="+ passengerNumber + "."
                + " airplaneType=" + planeType +
                "hasLanded=" + isLanded+ ".\n";
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:52:28.457

in 的第二个参数`Collections.sort`是[Comparator](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDIQFjAA&url=http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html&ei=LnTLULf2MqyLyAHex4CgBQ&usg=AFQjCNGq5QD14DknHWGkxEjB0Bs8HoqnRQ&bvm=bv.1355325884,d.cWE)而不是`Plane`. 由于我没有看到 Comparator 的提及，您应该能够使用自然顺序（由 Plane 对象中的 compareTo 方法定义）并且在`Collections.sort`

**编辑**：除非您刚刚排除了该代码，否则您不会创建任何 Plane 实例，并且您在这里使用的是空集合...

```
 TreeMap<String, PlaneStore> map = new TreeMap<String, PlaneStore>();
   ArrayList<Plane> copyList = new ArrayList<Plane>(map.); 
```

并且您将按 PlaneStores 进行排序，因此您必须获取`Plane`每个 PlaneStore 中的所有 s 并将它们添加到您的`copyList`排序之前。

我会考虑更多地研究每个[集合](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Collections.html)，并确定最适合您需要的集合。

# c# - 如何定义仅与某些控制器一起使用的菜单以及当存在某些模型时 ASP.NET MVC4

> ID：13883874
> 
> 赞同：0
> 
> 时间：2012-12-14T17:54:51.003
> 
> 标签：c#, asp.net-mvc-4

我有一个子菜单，我只想在使用某些控制器并且存在某个模型时才显示。我创建了一个部分并尝试在 _Layout.cshtml 中呈现它，但我收到一条错误消息，指出传递的模型项是类型......但是这个字典需要类型的项目......

我可以将菜单放在控制器的每个视图中，并传递正确类型的模型，但这似乎不太灵活。

目前我正在检查我的模型在 _submenu 部分中是否为空

```
@if(Model != null) 
```

然而，这会让任何类型的模型通过，然后当它是错误的类型时它会出错。

我认为最好的方法是指定我的 @Html.Partial 仅在使用某些控制器时运行。或者有没有办法验证模型类型，如果传递给视图的模型不正确，代码就不会运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:10:39.640

听起来你需要你的模型是动态的（[查看这个网站](http://blogs.msdn.com/b/rickandy/archive/2011/01/28/dynamic-v-strongly-typed-views.aspx)以获取更多信息），然后在你的视图中你可以检查模型的类型并采取相应的行动：

```
@model dynamic

@{
    ViewBag.Title = "IndexNotStonglyTyped";
}

<h2>Index Not Stongly Typed</h2>

<p>
@if(Model is MyType) {
   <span>got myType!</span>
}

</p> 
```

注意：原始示例取自上述网站。

# android - BitmapFactory.decodeFile 返回 null - 写入或读取文件的问题？

> ID：13883876
> 
> 赞同：2
> 
> 时间：2012-12-14T17:55:00.770
> 
> 标签：android, bitmap

这是我将位图保存到 sdcard 的代码：

```
public static boolean savePhoto(String fileName, Bitmap photo) {
    deleteOldPhotos();
    File sdCardPath = new File(MyApplication.getSDCardPathForPhotos());
    if (!sdCardPath.exists())
        sdCardPath.mkdirs();
    File destination = new File(sdCardPath, fileName);
    try {
        FileOutputStream out = new FileOutputStream(destination);
        photo.compress(Bitmap.CompressFormat.JPEG, 100, out);
        out.flush();
        out.close();
        return true;
    } catch (Exception e) {
        e.printStackTrace();
        return false;
    }
} 
```

这用于从 sdcard 中检索它并转换为 Base64 字符串：

```
public static String getEncodedPhoto(String filename) {
    File photoPath = new File(MyApplication.getSDCardPathForPhotos(), filename);
    if (photoPath.exists()) {
        Bitmap photo = BitmapFactory.decodeFile(photoPath.getAbsolutePath());
        setBugSenseExtraCrashData(filename, photoPath, photo);
        ByteArrayOutputStream stream = new ByteArrayOutputStream();
        photo.compress(Bitmap.CompressFormat.JPEG, 100, stream);
        byte[] photoByteArray = stream.toByteArray();
        String photoBase64 = Base64.encodeToString(photoByteArray, Base64.DEFAULT);
        return photoBase64;
    } else
        return null;
} 
```

我已经搜索了整个 stackoverflow 并找到了与此问题相关的答案，问题是所提出的问题是引用一个静态图像/文件。在我的情况下，系统正在生产中，有时我得到 Bugsense 告诉我`photo`对象为 null 并且 NullPointerException 被抛出`photo.compress(Bitmap.CompressFormat.JPEG, 100, stream);`。该文件存在是因为它通过了`photoPath.exists()`.

我做错了什么？问题出在save方法还是load方法上？有什么帮助或建议吗？

# ruby-on-rails - 本地化月份名称 - 日历 Railscasts #213

> ID：13883878
> 
> 赞同：14
> 
> 时间：2012-12-14T17:55:06.490
> 
> 标签：ruby-on-rails, localization, calendar

我正在尝试 railscasts 第 213 集的教程日历。我添加了 es.yml 但没有用。我尝试使用 en.yml 上的替换词来本地化月份名称，例如

```
en:
  date:

    month_names: [~, Enero, Febrero, Marzo, Abril, Mayo, Junio, Julio, Agosto, Septiembre, Octubre, Noviembre, Diciembre]
    abbr_month_names: [~, Ene, Feb, Mar, Abr, May, Jun, Jul, Ago, Sep, Oct, Nov, Dic] 
```

也不工作

在 html.erb 上

```
<h2 id="month"><%= @date.strftime("%B %Y") %></h2> 
```

我想改变这个

![在此处输入图像描述](../Images/27c5083b4a6810888c35c7c348f85004.png)

有人帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-14T17:56:57.553

您应该使用`localize`I18n 的方法（缩写为`l`）：

```
<h2 id="month"><%= l(@date) %></h2> 
```

然后你可以自己设置不同的格式：http: [//guides.rubyonrails.org/i18n.html#adding-date-time-formats](http://guides.rubyonrails.org/i18n.html#adding-date-time-formats)

```
# config/locales/es.yml
es:
  date:
    formats:
      short: "%B %Y"
      default: "%D %m, %Y" 
```

并像这样使用它：

```
<h2 id="month"><%= l(@date, format: :short) %></h2> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-29T16:20:18.833

只是想澄清一下，如果您使用活动记录，只需将字符串`datetime`值转换为`date`对象，如下例所示。

```
en:
  date:
    formats:
      default: "%Y-%m-%d"
      short: "%b %d"
      long: "%B %d, %Y"
    enter code here 
```

`<%= l(post.the_created_at.to_date, format: :long) %>`

# android - 播放短 .wav 文件 - Android

> ID：13883883
> 
> 赞同：16
> 
> 时间：2012-12-14T17:55:11.730
> 
> 标签：android, button, media-player, wav

我想在触摸按钮后播放声音。MediaPlayer 工作正常，但我在某处读到这个库是长 .wav（如音​​乐）。

有没有更好的方法来播放短 .wav（2-3 秒）？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-14T19:34:57.023

SoundPool[是](http://developer.android.com/reference/android/media/SoundPool.html)正确的类。下面的代码是如何使用它的示例。这也是我在我的几个应用程序中用来管理声音的代码。您可以根据自己的喜好（或在记忆允许的情况下）使用尽可能多的声音。

```
public class SoundPoolPlayer {
    private SoundPool mShortPlayer= null;
    private HashMap mSounds = new HashMap();

    public SoundPoolPlayer(Context pContext)
    {
        // setup Soundpool
        this.mShortPlayer = new SoundPool(4, AudioManager.STREAM_MUSIC, 0);

        mSounds.put(R.raw.<sound_1_name>, this.mShortPlayer.load(pContext, R.raw.<sound_1_name>, 1));
        mSounds.put(R.raw.<sound_2_name>, this.mShortPlayer.load(pContext, R.raw.<sound_2_name>, 1));
    }

    public void playShortResource(int piResource) {
        int iSoundId = (Integer) mSounds.get(piResource);
        this.mShortPlayer.play(iSoundId, 0.99f, 0.99f, 0, 0, 1);
    }

    // Cleanup
    public void release() {
        // Cleanup
        this.mShortPlayer.release();
        this.mShortPlayer = null;
    }
} 
```

您可以通过调用来使用它：

```
SoundPoolPlayer sound = new SoundPoolPlayer(this); 
```

在您的 Activity 的 onCreate() 中（或之后的任何时间）。之后，播放声音简单的呼叫：

```
sound.playShortResource(R.raw.<sound_name>); 
```

最后，一旦你完成了声音，调用：

```
sound.release(); 
```

以释放资源。

# mysql - 具有 ALL PRIVILEGES 的 MySQL 用户可以登录但不能运行查询

> ID：13883886
> 
> 赞同：0
> 
> 时间：2012-12-14T17:55:39.687
> 
> 标签：mysql, permissions, plesk

我们已将 Plesk 机器配置为使用外部 MySQL 服务器。这样做时，我们已将所有权限 WITH GRANT OPTION 授予 psaadmin 用户，因此我们能够创建远程数据库和用户就好了。但是，我们创建的用户（即“wordpress_user”）不能在远程服务器上运行选择语句。

在检查 MySQL 服务器上的权限时，'wordpress_user' 拥有数据库本身的所有权限。我可以使用该用户登录 phpMyAdmin，并且可以使用该用户登录远程服务器控制台。只有当我尝试以该用户身份运行任何查询时，才会收到“错误 1045 (28000)：用户拒绝访问”错误。

我检查的所有内容似乎都表明用户拥有完全权限。我还按照文档的指示使用了 FLUSH PRIVILEGES。我重新启动了 Plesk，重新启动了 MySQL，仍然没有。

任何人都可以帮忙吗？请？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T22:37:31.387

我能够找到问题所在。显然，有问题的查询是具有特定权限的视图？常规选择等工作正常（我没有意识到）。我能够删除并重新创建视图，现在效果很好。

# java - 按下时按钮似乎没有响应

> ID：13883891
> 
> 赞同：1
> 
> 时间：2012-12-14T17:55:56.630
> 
> 标签：java, swing, jframe, border-layout

再次，大家好。我的加密代码有更多问题 - 按下的按钮似乎没有注册。检测按钮按下的代码如下。

```
@Override
public void actionPerformed(ActionEvent e) {
    if (e.getSource() == enc && !in.getText().equalsIgnoreCase("")) {
        out.setText(EncDec.e(in.getText(), 5));
        System.out.println("Button pressed (Encrypt)");
    }
    else if(e.getSource() == dec && !in.getText().equalsIgnoreCase("")) {
        out.setText(EncDec.d(in.getText()));
        System.out.println("Button pressed (Decrypt)");
    }
} 
```

这个问题确实与这个问题有关[，](https://stackoverflow.com/questions/13881444/solved-only-one-component-shows-up-in-jframe)并且感谢 Pshemo 让我知道 :)当我按下按钮时，

我`System.out.println()`可以告诉我，当我按下以下任一按钮时，控制台不会打印任何内容。如果您需要更多信息，请询问，我很乐意添加。

我尝试添加`addActionListener()`代码，但我不知道如何使用它...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:05:50.010

我建议在评估任一条件之前放置一个日志语句，以查看 ActionEvent 实际上是否正确触发。如果是，请尝试输出操作源以确保按下了正确的按钮。

否则，我将首先检查您的两个按钮是否正在注册添加的 actionListener....“enc.addActionListener();”。

如果看起来不错，我会尝试在 setText 行周围放置一个 try/catch，以查看“EncDec.e”或“EncDec.d”是否抛出某种异常。

无论如何都要尝试一些东西！:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T18:13:16.670

我认为这个问题与[这个](https://stackoverflow.com/questions/13881444/solved-only-one-component-shows-up-in-jframe)有关。

您需要做的就是将您的类的对象（实现`ActionListener`）添加`addActionListener`到您的按钮中，例如：

```
EncDecExample decExample = new EncDecExample();
enc.addActionListener(decExample);
dec.addActionListener(decExample);
enc.setVisible(true);
dec.setVisible(true); 
```

# sql - 选择按列总和排序的两个查询的交集

> ID：13883900
> 
> 赞同：3
> 
> 时间：2012-12-14T17:56:30.193
> 
> 标签：sql, sqlite

我有三个表如下：

```
documents (id, content) 
words (id, word) 
word_document (word_id, document_id, count) 
```

单词表包含所有文档中出现的所有单词，word_document 将单词与文档以及该文档中该单词的计数相关联。

我想编写一个查询来搜索两个单词，并只返回两个单词都按文档中两个单词的计数总和排序的文档。

例如

```
DocA: green apple is not blue
DocB: blue apple is blue
DocC: red apple is red 
```

现在搜索**apple**和**blue**返回：

```
DocA, 3
DocB, 2 
```

因为：

```
DocA contains both words and 3 of them
DocB contains both words and 2 of them
DocC only contains one word 
```

我成功使用了**intersect**但它不返回计数和也没有顺序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:04:48.613

我认为应该这样做：

```
select a.document_id, a.count + b.count
from 
(
 select document_id, count
 from word_document
 where word_id = 'apple'
 group by document_id
) a 
INNER JOIN 
(
 select document_id, count
 from word_document
 where word_id = 'blue'
 group by document_id
) b 
ON a.document_id = b.document_id
ORDER BY a.count + b.count 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T21:03:52.803

对于那些想要这个的人，这只适用于：

```
select wd.document_id, (wd.count + d.count) as tcount from word_document as wd
join words as w on w.id = wd.word_id
join
(select document_id, count from word_document 
join words on words.id = word_document.word_id
where words.word = "apple") d on d.document_id=wd.document_id
where w.word = "blue" order by tcount desc 
```

您可以从内部查询创建临时表并在其上执行外部。它可以递归地完成更多的单词。

# dojo - Dijit：为什么我会收到“未捕获的错误：无效模板”？

> ID：13883902
> 
> 赞同：4
> 
> 时间：2012-12-14T17:56:46.380
> 
> 标签：dojo

据我所知，我有一个看起来不错的 dijit，但它`Uncaught Error: Invalid template`每次都在提高。我一直无法弄清楚为什么。所有变量（例如`${variableName}`在小部件中正确定义。

这是小部件：

```
<div class="${classPrefix}-wrapper">
    <div class="${classPrefix} flair" dojoAttachPoint="flairNode"></div>
    <div class="${classPrefix}-count hidden" dojoAttachPoint="countWrapperNode">
        <div class="count" dojoAttachPoint="countNode">0</div>
    </div>
    <div class="${classPrefix} ${secondaryClass} action hidden" dojoAttachPoint="secondaryClickNode" dojoAttachEvent="onclick:_onSecondaryClick">
        <div class="${classPrefix}-inner"></div>
        <div class="${classPrefix}-icon"></div>
    </div>
    <div class="${classPrefix} ${primaryClass} action" dojoAttachPoint="primaryClickNode" dojoAttachEvent="onclick:_onPrimaryClick">
        <div class="${classPrefix}-inner"></div>
        <div class="${classPrefix}-icon"></div>
    </div>
    <div class="${classPrefix}-message hidden" dojoAttachPoint="messageNode"></div>
</div>
<div class="${actionPromptNodeClass}" dojoAttachPoint="actionPromptMessageNode">
    <span dojoAttachPoint="actionPromptMessage">${actionPromptText}</span>
    <span dojoAttachPoint="actionCompletedMessage" class="hidden">${actionCompletedText</span>
</div> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-14T18:02:15.480

找到了我的问题的答案。事实证明，Dijit 中只能有一个根节点。我在文档中错过了这个，[但它在本教程的底部](http://dojotoolkit.org/reference-guide/1.8/dijit/_TemplatedMixin.html#common-pitfalls)：

> 常见的陷阱
> 
> *   确保模板中只有一个根节点
> *   不要以评论开始或结束您的模板，因为这意味着您在技术上有两个节点
> *   避免`</div>`在模板末尾出现尾随

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:01:47.813

模板中可能只有一个根元素。将您的模板包装进去`<div></div>`，它应该可以工作。

# c - Minifilter驱动程序：如何在打开时替换文件内容？

> ID：13883903
> 
> 赞同：2
> 
> 时间：2012-12-14T17:56:48.327
> 
> 标签：c, windows, driver, minifilter

我有一个顶级微过滤器驱动程序和一个用户模式服务，类似于 [Scanner MSDN 示例](http://code.msdn.microsoft.com/windowshardware/Scanner-File-System-426c8cbe)。

我希望我的用户模式服务`A.txt`在记事本中打开文件内容时替换它。

因此，在`IRP_MJ_CREATE`操作后回调中，我正在向服务发送通知并等待它将新数据写入文件。
但是服务无法打开`A.txt`，因为它已经被记事本锁定了。

如何允许我的服务在不使用内核[FltWriteFile](http://msdn.microsoft.com/en-us/library/windows/hardware/ff544610%28v=vs.85%29.aspx)的情况下写入数据？
这样做的最佳方法是什么？

也许取消文件打开，让服务写入数据并使用相同的参数重新打开它而不离开操作后回调？
也许我应该在预操作中覆盖所需的访问权限？

---
任何信息将不胜感激。如果您认为这个问题缺乏细节，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T07:28:15.940

不要在 PostOperation 中通知您的服务，而是在 PreOperation 回调中执行此操作。到您在 PostOperation 中执行此操作时，Notepad.exe 文件将已经打开，这就是在您的服务中打开失败的原因。

此外，如果您还没有这样做，则必须在 PreOperation 中等待服务将新数据写入文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-26T21:28:18.733

我真的不同意**Rogan 的**回答，因为该文件很可能被记事本之前的任何其他进程锁定。这不是这里的问题，或者至少不是你应该如何看待这个问题。

如果你想让记事本对 A.txt 有一定的看法，只需使用记事本的 FILE_OBJECT 并从内核自己编写。请记住使用**ObReferenceObjectByPointer**并请求**WRITE**访问权限。由于访问模式将是内核模式，因此您将被允许。

或者，如果您真的希望它由您的服务完成，请自己从驱动程序打开文件并为您的服务提供句柄。从内核模式打开文件可能会抑制共享模式等，您需要阅读**FltCreateFileEx2**的文档以确保您拥有所有必要的参数。在您刚刚打开的 FileObject 上使用**ObOpenObjectByPointer并访问模式 UserMode。**确保您将通过**KeStackAttachProcess**连接到您的用户模式的进程地址空间。

PostCreate 中的操作顺序：

1.  **FltCreateFileEx2**（the_file、ignore_share_access 等）
2.  **KeStackAttachProcess** (your_service_eprocess)
3.  **ObOpenObjectByPointer** (UserMode=access_mode) -> 现在你的 um 进程有了文件的句柄
4.  **KeUnstackDetachProcess** ()
5.  将**HANDLE**指针发送到用户模式进程，因为它现在可以使用它。
6.  等待用户模式服务写入数据并关闭句柄取消引用获得的 FileObject 以及关闭来自**FltCreateFileEx2**的句柄。
7.  让创建去记事本
8.  利润。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-21T05:14:47.227

//声明

```
PFLT_CALLBACK_DATA Data //Note: you get this in preOperation as argument so dont need to defined explicitly

PFLT_FILE_NAME_INFORMATION nameInfo=NULL;//must be declared
NTSTATUS status;

if(KeCurrentIrql()==PASSIVE_LEVEL)// file operation should be performed in IRQL PASSIVE_LEVEL
{

status=FltGetFileNameInformation(Data,FLT_FILE_NAME_OPENED |FLT_FILE_NAME_qUERY_ALWAYS_ALLOW_CACHE_LOOKUP,&nameInfo);

if(NT_SUCCESS(status))
{
 status = FltParseFileNameInformation(nameInfo);
}
} 
```

//现在你有了nameInfo结构中的文件信息。

//您可以获得文件信息，例如阅读上述使用结构的文档将帮助您更多地了解它们。特别是 PFLT_FILE_NAME_INFORMATION 。

# javascript - jQuery双多选组合框

> ID：13883904
> 
> 赞同：0
> 
> 时间：2012-12-14T17:56:48.923
> 
> 标签：javascript, jquery

我有一个功能，可以将价值从一个组合框带到另一个。

```
product.bind('click', function() 
        {
            var t = ($(this).hasClass('prevbtn'))? 0 : 1;
            if(t)
            {
                unsel.find('option').each(function()
                {
                    if($(this).is(':selected')) 
                    {
                        jQuery(this).attr('selected',true);
                        var op = sel.find('option:first-child');
                        sel.append($(this));
                    }
                }); 
            } 
            else 
            {
                sel.find('option').each(function()
                {
                    if($(this).is(':selected')) 
                    {
                        jQuery(this).attr('selected',false);
                        unsel.append($(this));
                    }
                });
            } 
```

有没有办法将值从 unsel 框传递到 sel 框而不从 unsel 框中删除？我想要做的是人们能够将尽可能多的 unsel 值传递到 sel 框中，只要他们愿意。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:35:05.870

我自己解决了这个问题：

```
sel.append($(this).clone()); 
```

这已经足够了。

# java - 通过 Socket 读取 TCP-Destination

> ID：13883909
> 
> 赞同：2
> 
> 时间：2012-12-14T17:57:00.450
> 
> 标签：java, android, sockets, tcp, ip

我正在编写一个 Android 应用程序。我将一个端口转发到我的应用程序并使用套接字监听它。我正在接收数据，但只有 TCP 层上的层上的数据。这不是问题，但现在我需要原始目标 IP，但它应该在 TCP 层中。那么你知道，有没有一种简单的方法来获得这个IP？或者有没有一种简单的方法来设置一个套接字来获得比 TCP 更多的层？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:13:28.793

如果您在 NAT 设备上转发 TCP 端口，那么您要查找的信息在 NAT 后的目的地不可用，因为需要将 IP 标头中的目的地地址覆盖到私有地址才能使其正常工作。

# csv - 用逗号读取字符串会自动用引号括起来

> ID：13883910
> 
> 赞同：0
> 
> 时间：2012-12-14T17:57:04.073
> 
> 标签：csv, groovy

我正在解析一个制表符分隔的文件，其中一些列中包含逗号。带有逗号的每一列都用引号括起来，这会破坏稍后尝试搜索这些值（不带引号）的一些代码。例如，如果 csv 文件中的原始值为“A, B, C”，则现在将其存储为“A, B, C”。

如何自动删除/转义这些额外的引号？

谢谢

我用来读取文件的代码是：

```
genresMap = [:] 
new File(runtime_dir + 'file.csv').eachLine {
    def line -> column = line.split("\t");
    genresMap[column[0].toString()] = column[1];
} 
```

# javascript - sencha android 原生应用和 facebook sdk

> ID：13883913
> 
> 赞同：0
> 
> 时间：2012-12-14T17:57:14.507
> 
> 标签：javascript, android, facebook, facebook-javascript-sdk, sencha-touch-2

我的 sencha 应用程序有问题，它使用 facebook sdk javascript 登录，当然在浏览器中它可以完美运行，因为 facebook 授权了域名。但是当我把我的应用程序变成一个原生的 android 应用程序时，facebook 拒绝了应用程序，说给定的 url 是不允许的。

我已尝试将其授权为本机 android 应用程序，从我使用的密钥库获取密钥哈希，然后将其放入 facebook 应用程序但没有成功，也许我错过了一些东西，我将不胜感激任何帮助，为我指明正确的方向

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:38:33.190

我使用 dave johnson 创建的 phonegap 和 phonegap 的 facebook connect 插件解决了这个问题

它在 git hub

[https://github.com/davejohnson/phonegap-plugin-facebook-connect/](https://github.com/davejohnson/phonegap-plugin-facebook-connect/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-15T04:49:50.093

您需要使用 FB JavaScript 库，而不是连接...最好的办法是查看 ST2 示例目录中的 Jog With Friends 以了解如何处理集成

# regex - 在两个字符串正则表达式中查找 URL

> ID：13883916
> 
> 赞同：0
> 
> 时间：2012-12-14T17:57:33.007
> 
> 标签：regex

我有一个包含组织名称及其 URL 的长 HTML 文件。代码中每个组织的“部分”由“组织”一词划分，后跟大量代码，其 URL 位于该代码内，并以“组织”一词结尾。

例如：

组织——大量代码（URL 位于内部某处）——组织

我曾尝试使用正则表达式来搜索和提取 URL，但无济于事。

```
organization(?<Protocol>\w+):\/\/(?<Domain>[\w@][\w.:@]+)\/?[\w\.?=%&=\ @/$,]*organization 
```

我怀疑我的问题在于我试图通过使用“组织”一词来划分对 URL 的搜索，但我不确定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:19:49.000

您当前的正则表达式正在搜索夹在两个“组织”实例之间的内容。如果“组织”和您的 URL 之间可能存在字符，您需要为任何实例 ( `.*?`) 引入非贪婪匹配，并且如果混合中有换行符，则需要使用`(?:.|\n)*?`.

所以你的正则表达式变成：
`organization`**`(?:.|\n)*?`**`(?<Protocol>\w+):\/\/(?<Domain>[\w@][\w.:@]+)\/?[\w\.?=%&=\ @/$,]*`**`(?:.|\n)*?`**`organization`

（由于**粗体**插入，这错误地*看起来*有空格，但实际上没有。如果选择它并复制/粘贴，它将正确粘贴而没有空格）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:14:43.950

从这里尝试第 1 组：

```
organization.*\b(\w+://[\w.?%&=@/$,-]+).*?organization 
```

# c# - 页面重新加载是否会导致帖子？

> ID：13883917
> 
> 赞同：0
> 
> 时间：2012-12-14T17:57:55.053
> 
> 标签：c#, html, forms, post, webmatrix

快速的问题，我已经尝试自己解决这个问题，但是当试图弄清楚页面为什么或如何重新加载以及做/不做它应该做的事情时，会话变量的使用可能会令人困惑。

在任何（非脚本）情况下，页面重新加载（使用 JavaScript、f5、ctrl+f5、浏览器重新加载按钮等）是否会导致表单重新发布？

（这与在 C# 代码中使用 IfPost 分支有关，如下面的示例代码）：

```
if(IsPost)
{
    //stuff that only executes if the previous request was a post.
} 
```

我只是需要知道这里会发生什么，这样我才能正确诊断我的会话状态问题。

谢谢你的帮助！

（另外，对不起，如果我过度简化了这个问题。我意识到它“可能”比一个简单的答案所能提供的更复杂）。

****** *** ** ******更新****** ** *** ** *** ** ***** 另外，我在 StackOverflow 上查找了这个问题的副本，但我什么也没看到，所以如果这是一个重复的问题，我深表歉意。**

 **这里的两个答案都是很好的答案。我接受了也为我的问题提供了解决方案的答案，虽然 PRG 不是“唯一”的方法，但它似乎可能是最好的。这似乎也是处理客户端用户友好性的一种日益增长的方式，而且恕我直言，这似乎是一个很好的习惯。

谢谢你给我看！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T18:00:13.680

是的。如果页面是使用 POST 数据加载的，则会发生这种情况。为了防止这种情况，您需要实现该[`POST/REDIRECT/GET`模式](http://en.wikipedia.org/wiki/Post/Redirect/Get)。

> Post/Redirect/Get (PRG) 是一种 Web 开发设计模式，可以防止一些重复的表单提交，为用户代理（用户）创建更直观的界面。PRG 以可预测的方式支持书签和刷新按钮，不会创建重复的表单提交。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T17:59:30.133

是的。如果有人手动刷新浏览器，它会询问他们是否要再次发送表单数据。这将导致该代码被执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-05T13:03:29.910

处理此问题的一种方法是使用令牌。

1.  发送一个随机字符串以及发布数据
2.  将此随机字符串存储在某处
3.  检查发布数据时，请确保存储的字符串与发布请求中的字符串相同。
4.  如果为真，则处理请求。
5.  生成新令牌

如果有人刷新并重新发送发布数据，您在发布请求中的令牌将不同于您单独存储的令牌，因为您在步骤 5 中生成了一个新令牌**

# events - 带有布尔值的 DependencyProperties：False 导致事件不触发

> ID：13883918
> 
> 赞同：0
> 
> 时间：2012-12-14T17:57:56.750
> 
> 标签：events, xaml, user-controls, windows-runtime

所以我为我的 xaml 用户控件创建了一个 bool 依赖属性。但是，当该值在 xaml 中设置为 false 时，它​​不会在 xaml 中设置为 true 时触发事件。无论如何，我怎样才能让它触发事件？

```
public static readonly DependencyProperty AvailableProperty =
    DependencyProperty.Register("Available", typeof(bool), typeof(DetailPannel),
    new PropertyMetadata(null, onAvailablePropertyChanged));

public bool Available
{
    get { return (bool)GetValue(AvailableProperty);  }
    set { SetValue(AvailableProperty, value); }
}

private async static void onAvailablePropertyChanged(DependencyObject d,   DependencyPropertyChangedEventArgs e)
{
    var obj = d as DetailPannel;
    bool avaible = (bool.Parse(e.NewValue.ToString())); 
    if(avaible == false )
    {            
        obj.PreviewImage.Source = await ConvertToGreyscale(obj.PreviewImage);
        obj.StateRelatedImage.Source = new BitmapImage(new Uri("ms-appx:///icon.png")); 
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T21:58:34.980

该值`null`对于 bool 属性无效。更改您的 PropertyMetadata 以指定`false`或`true`作为默认值：

```
public static readonly DependencyProperty AvailableProperty =
    DependencyProperty.Register("Available", typeof(bool), typeof(DetailPannel),
    new PropertyMetadata(false, onAvailablePropertyChanged)); 
```

您的 PropertyChanged 处理程序中的代码看起来也很可疑。不要使用`bool.Parse`，而只是`e.NewValue`转换为`bool`：

```
private async static void onAvailablePropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
{
    var obj = d as DetailPannel;
    var available = (bool)e.NewValue; 

    if (!available)
    {
        ...
    }
} 
```

# c# - WAVE 文件中缺少“fmt”

> ID：13883924
> 
> 赞同：-1
> 
> 时间：2012-12-14T17:58:34.147
> 
> 标签：c#, wave

我正在我的***跨平台应用程序框架***中实现音频，并且在开始使用波形文件时遇到了一些麻烦。

```
UInt32 type = rd.ReadUInt32();
UInt32 size = rd.ReadUInt32();
UInt32 waveType = rd.ReadUInt32();
UInt32 fmtType = rd.ReadUInt32();

if (type != MAGIC_RIFF || waveType != MAGIC_WAVE || fmtType != MAGIC_fmt)
{
    throw new InvalidDataException("Data is not of WAVE format");
} 
```

“fmt”幻数不正确，它实际上是**0x4b4e554a**。Windows-Media-Player 可以轻松播放文件，但我没有找到任何信息这个块可能是什么。根据定义，“fmt”块必须出现。
如果我加载另一个文件，则会出现“fmt”块，那么该块实际包含什么信息（不能是数据块，因为它的值是**0x61746164**。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-14T18:16:59.597

**fmt**块不需要是标头之后的第一个块。有一个简单的解决方案可以跳过**header**和**fmt**块之间的块：

```
UInt32 fmtType = rd.ReadUInt32();

while (fmtType != MAGIC_fmt)
{
    rd.ReadBytes(rd.ReadInt32());
    fmtType = rd.ReadUInt32();

} 
```

# intellij-idea - IntelliJ 12 + Gradle 1.3 - 基本 Gradle 语法似乎不起作用

> ID：13883925
> 
> 赞同：13
> 
> 时间：2012-12-14T17:58:42.260
> 
> 标签：intellij-idea, gradle

我正在尝试在 IntelliJ Idea (Ultimate) v12 中使用 Gradle 集成。

似乎即使正确配置了 $GRADLE_HOME，也无法识别诸如“应用”、“依赖关系”等基本语法。

![在此处输入图像描述](../Images/8e9e0ed5a4cc8ad754a138ea11f5a9c7.png)

我似乎解决方案应该很简单。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T19:31:08.050

IntelliJ IDEA 目前不为 Gradle 构建脚本提供语法补全。你得到的只是标准的 Groovy 支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T17:24:17.577

直到今天早上我都遇到了同样的问题。我做了以下步骤，它自己解决了：

*   将根 build.gradle 文件（我们有几个）添加到 JetGradle 选项卡并刷新
*   更新到 IDEA 12.0.1（它重新启动并重新索引）

我认为做第一个并重新启动可能就足够了，但我不确定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-16T22:43:43.247

我正在使用 Intellij 13 并且遇到了类似的问题。我注意到的是，从 Intellij 创建一个新项目（即新的 Groovy 项目或 Gradle 项目），我得到了语法错误标记。我还注意到它在引入 Gradle 依赖项方面做得不好。

另一方面，如果我通过已经创建的 build.gradle 文件导入项目，语法错误标记就会消失，并且依赖项似乎可以更好地发挥作用。不确定这是否适合您。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-11T15:42:02.260

使用 Intellij 14 和 Gradle 2.3，我发现在我的项目设置中添加`{$GRADLE_HOME}/lib`和`{$GRADLE_HOME}/lib/plugins`作为库可以消除所有警告，例如“依赖项不能应用于 groovy.lang.Closure”。

# c# - Asp.net webservice总是从soap ui接收空值

> ID：13883928
> 
> 赞同：0
> 
> 时间：2012-12-14T17:58:52.820
> 
> 标签：c#, asp.net, web-services, asmx

我正在从肥皂 UI 发布下面的消息，并且我总是在 web 服务中收到空值。无论我从soap UI 发布什么消息，它都只作为null。

```
<?xml version="1.0" encoding="UTF-8"?>
<env:Envelope xmlns:env="http://schemas.xmlsoap.org/soap/envelope/">
<env:Header/>
<env:Body>
Test
</env:Body>
</env:Envelope> 
```

下面是我的简单WebService

```
[WebService(Namespace = "http://test.com/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.ComponentModel.ToolboxItem(false)]
public class TestService : System.Web.Services.WebService {

    [WebMethod]
    public int TestMethod(string message)
    {
        try
        {
            File.WriteAllText("D:\\abc.xml", message);
            return 0;
        }
        catch (Exception ex)
        {
            return 1;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:17:37.183

You're not specifying which method to call or the parameters of that method in your body. You'll need something like this:

```
<env:Body>
  <m:TestMethod xmlns:m="http://tempuri.org">
    <message>Test</message>
  </m:TestMethod>
</env:Body> 
```

# android - 如何在android中使用convax API将图像放置在点（x，y）上？

> ID：13883929
> 
> 赞同：0
> 
> 时间：2012-12-14T17:59:01.510
> 
> 标签：android

我想在代码中的以下点放置一个小图像

{

```
 nineVline=new Point[2];

    p1=new Point(9*splitWidth,0);
    p2=new Point(9*splitWidth,height);
    nineVline[0]=p1;
    nineVline[1]=p2; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:45:47.807

```
LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(30, 30);
layoutParams.setMargins(p1.x,p1.y,0,0);

yourImageView.setLayoutParams(layoutParams); 
```

**此代码未经测试...

如果您使用相对布局，则相应更改。

# asp.net-mvc-3 - MVC3 在当前视图上显示搜索结果（未创建任何新视图）

> ID：13883930
> 
> 赞同：0
> 
> 时间：2012-12-14T17:59:21.117
> 
> 标签：asp.net-mvc-3, search, view

我正在从数据库中提取一些数据并将其显示在[此示例](http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4)中的列表中。我想在页面顶部实现搜索，以搜索页面上重复的数据的值。[此示例](http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4)为搜索页面创建一个新视图。是否可以在不为搜索结果创建新视图的情况下在当前视图上实现搜索。

我不介意用新的观点来做，但我只是想知道

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T07:44:56.860

视图不需要关心你在后台使用数据做什么。它只是以格式化的漂亮方式显示您发送给它的任何内容。因此，在搜索框中提供参数然后在单击搜索按钮时将其推送到控制器肯定没有错。然后控制器将对您的模型或存储库执行请求以过滤数据，最终返回加载了它找到的数据的视图，就像在初始加载时一样（现在数据比以前少）。不需要为此创建一个完全不同的视图，该视图只是您返回数据的模板。

# google-sheets - 从数组公式返回单个单元格

> ID：13883933
> 
> 赞同：20
> 
> 时间：2012-12-14T17:59:36.813
> 
> 标签：google-sheets

我想从这个公式中得到一个值，即收盘价：

```
=GoogleFinance("NASDAQ:AAPL", "close", "12/13/2012",  1, 1) 
```

相反，此公式填充 2 个标题行（日期、关闭），然后填充两个值（日期和关闭值 $529.69）。有没有办法只返回关闭值并将其放置在公式的单元格中？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-14T20:32:10.160

您可以使用[INDEX](https://support.google.com/drive/bin/static.py?hl=en&topic=25273&page=table.cs&tab=1240292)功能：

`=INDEX(GoogleFinance("NASDAQ:AAPL";"close";"12/13/2012";1;1);2;2)`

# arrays - 在 C# 中创建一个数组数组

> ID：13883943
> 
> 赞同：0
> 
> 时间：2012-12-14T17:59:57.263
> 
> 标签：arrays, c#-4.0, collections

嗨如何创建一个数组数组，如

```
 EDIT: [[1,"aaaaaa",1],[2,"bbbbbbb",2],[3,"ccccccc",3]] 
```

从列表中

```
IList<TestList>

public class TestList
    {
        public int x{ get; set; }
        public string Name { get; set; }
        public int y{ get; set; }    

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:05:40.127

如果我了解您在寻找什么，这应该可以解决问题：

```
IList<TestList> testList;

public class TestList
{
    public int x{ get; set; }
    public string Name { get; set; }
    public int y{ get; set; }
}

var newList = testList.Select(t => new object[] { t.x, t.Name, t.y});
var myArrayOfArrays = newList.ToArray(); 
```

# windows-8 - Windows 8 模拟器捕捉状态

> ID：13883945
> 
> 赞同：0
> 
> 时间：2012-12-14T18:00:04.333
> 
> 标签：windows-8

如何使用 Windows 8 模拟器进入快照状态？我收到了来自 Windows 8 商店的通知，说我的软件仅在快照模式下崩溃。有谁知道为什么切换模式会导致我的软件崩溃？这是我背后的代码：

```
namespace MenuFinderWin8.Pages
{

public sealed partial class RestaurantHomePage : MenuFinderWin8.Common.LayoutAwarePage
{
    MenuFinderAppServiceClient serviceClient;
    RestaurantRepository repository;
    Geolocator _geolocator = null;
    ObservableCollection<RestaurantLocation> items;

    public RestaurantHomePage()
    {
        this.InitializeComponent();
        if (!Network.IsNetwork())
        {
            return;
        }
        repository = new RestaurantRepository();
        serviceClient = new MenuFinderAppServiceClient();
        _geolocator = new Geolocator();
        items = new ObservableCollection<RestaurantLocation>();
        BindData();
    }

    void btnAbout_Click(object sender, RoutedEventArgs e)
    {
        Flyout f = new Flyout();
        LayoutRoot.Children.Add(f.HostPopup); // add this to some existing control in your view like the root visual

        // remove the parenting during the Closed event on the Flyout
        f.Closed += (s, a) =>
        {
            LayoutRoot.Children.Remove(f.HostPopup);
        };

        // Flyout is a ContentControl so set your content within it.
        SupportUserControl userControl = new SupportUserControl();
        userControl.UserControlFrame = this.Frame;
        f.Content = userControl;
        f.BorderBrush = new SolidColorBrush(Windows.UI.Color.FromArgb(255, 223, 58, 51));
        f.Width = 200;
        f.Height = 200;
        f.Placement = PlacementMode.Top;
        f.PlacementTarget = sender as Button; // this is an UI element (usually the sender)

        f.IsOpen = true;
    }

    void btnSearch_Click(object sender, RoutedEventArgs e)
    {
        Flyout f = new Flyout();
        LayoutRoot.Children.Add(f.HostPopup); // add this to some existing control in your view like the root visual

        // remove the parenting during the Closed event on the Flyout
        f.Closed += (s, a) =>
        {
            LayoutRoot.Children.Remove(f.HostPopup);
        };

        // Flyout is a ContentControl so set your content within it.
        RestaurantSearchUserControl userControl = new RestaurantSearchUserControl();
        userControl.UserControlFrame = this.Frame;
        f.Content = userControl;
        f.BorderBrush = new SolidColorBrush(Windows.UI.Color.FromArgb(255, 223, 58, 51));
        f.Width = 600;
        f.Height = 400;
        f.Placement = PlacementMode.Top;
        f.PlacementTarget = sender as Button; // this is an UI element (usually the sender)

        f.IsOpen = true;

    }

    void btnViewFavorites_Click(object sender, RoutedEventArgs e)
    {
        App.DataMode = Mode.SavedRestaurant;
        if (repository.GetGroupedRestaurantsFromDatabase().Count() == 0)
        {
            MessageDialog messageDialog = new MessageDialog("You have no saved restaurants.", "No Restaurants");
            messageDialog.ShowAsync();
        }
        else
        {
            this.Frame.Navigate(typeof(RestaurantSearchDetails));
        }
    }

    private async void BindData()
    {
        try
        {
            items = await serviceClient.GetSpecialRestaurantsAsync();

            List<RestaurantLocation> myFavs = repository.GetRestaurantLocations();
            foreach (var a in myFavs)
            {
                items.Add(a);
            }

            this.DefaultViewModel["Items"] = items;
        }
        catch (Exception)
        {
            MessageDialog messsageDialog = new MessageDialog("The MenuFinder service is unavailable at this time or you have lost your internet connection. If your internet is OK, please check back later.", "Unavailable");
            messsageDialog.ShowAsync();
            btnAbout.IsEnabled = false;
            btnSearch.IsEnabled = false;
            btnViewFavorites.IsEnabled = false;
        }
        myBar.Visibility = Windows.UI.Xaml.Visibility.Collapsed;
    }

    /// <summary>
    /// Populates the page with content passed during navigation.  Any saved state is also
    /// provided when recreating a page from a prior session.
    /// </summary>
    /// <param name="navigationParameter">The parameter value passed to
    /// <see cref="Frame.Navigate(Type, Object)"/> when this page was initially requested.
    /// </param>
    /// <param name="pageState">A dictionary of state preserved by this page during an earlier
    /// session.  This will be null the first time a page is visited.</param>
    protected override void LoadState(Object navigationParameter, Dictionary<String, Object> pageState)
    {
        // TODO: Assign a bindable collection of items to this.DefaultViewModel["Items"]
    }

    private void itemGridView_ItemClick_1(object sender, ItemClickEventArgs e)
    {
        App.CurrentRestaurantLocation = e.ClickedItem as RestaurantLocation;
        if (App.CurrentRestaurantLocation != null)
        {
            Order order = repository.AddOrder(DateTime.Now, string.Empty, App.CurrentRestaurantLocation.ID);
            App.CurrentOrder = order;
            App.DataMode = Mode.Menu;
            this.Frame.Navigate(typeof(RootViewPage));
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:18:54.073

响应“如何使用 Windows 8 模拟器进入快照状态？” - 我发现在模拟器中捕捉最简单的方法是使用键盘快捷键，即 Windows 键 + 。（时期）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:15:19.213

错误可能在您的 XAML 中，而不是在后面的代码中。如果您使用了模板但删除或修改了其中一个元素中的名称，则引用该元素的 KeyFrame 无法获取该元素，因此会引发异常。

在您的 XAML 中搜索类似的内容

```
<VisualState x:Name="Snapped">
                <Storyboard>... 
```

并删除属性等于不存在元素的`ObjectAnimationUsingKeyFrames`标签。`Storyboard.TargetName`

关于如何在模拟器上进入捕捉模式，与在 PC 中相同，只需从顶部抓住应用程序并将其滑动到一边，同时按住点击。

# ssis - 导入/导出向导在导出到 Excel 时失败

> ID：13883954
> 
> 赞同：2
> 
> 时间：2012-12-14T18:00:30.950
> 
> 标签：ssis, bids

我正在使用 SSIS 导入/导出向导将表从 sql server 导出到 Excel。在“继续”步骤中，我在每条记录中都会收到一个关于类型转换的警告图标。如果我忽略，则在最后一个屏幕中单击“完成”后导出失败。

我在 Stack Overflow 中对此进行了搜索，但无法获得相关答案...

SQL 表字段及其类型如下：

```
CREATE SomeTable
(
    EmpId numeric(9)
,   Name varchar(50)
,   Address varchar(50)
,   ContactNo varchar(50)
); 
```

出现的错误写在下面

> 复制到`tblSSISFlatImport`（错误）消息错误 0xc0202009：数据流任务 1：SSIS 错误代码 DTS_E_OLEDBERROR。发生 OLE DB 错误。错误代码：0x80004005。（SQL Server 导入和导出向导）错误 0xc0209029：数据流任务 1：SSIS 错误代码 DTS_E_INDUCEDTRANSFORMFAILUREONERROR。“输入“目标输入”(39)”失败，因为发生错误代码 0xC020907B，并且“输入“目标输入”(39)”上的错误行处置指定错误失败。指定组件的指定对象发生错误。在此之前可能会发布错误消息，其中包含有关失败的更多信息。（SQL Server 导入和导出向导）
> 
> 错误 0xc0047022：数据流任务 1：SSIS 错误代码 DTS_E_PROCESSINPUTFAILED。处理输入“Destination Input”(39) 时，组件“Destination - tblSSISFlatImport”(28) 上的 ProcessInput 方法失败，错误代码为 0xC0209029。已识别的组件从 ProcessInput 方法返回错误。该错误是特定于组件的，但该错误是致命的，将导致数据流任务停止运行。在此之前可能会发布错误消息，其中包含有关失败的更多信息。（SQL Server 导入和导出向导）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T23:04:02.727

我以前见过这个错误，它可能是由几件事造成的。

1) 确保在数据转换转换编辑器中，字段名称、地址和联系人编号的数据类型设置为“Unicode 字符串 [DT_WSTR]，长度为 50，以便从 SQL Server 转换为 Excel。

2）如果您在服务器上工作，请确保将 Run64BitRuntime 设置为 True（否则将其设置为 False）。这可以通过右键单击包名称（窗口右侧解决方案资源管理器下的第一项），选择属性，然后在配置属性下调试来检查。

3) 在 Data Flow 选项卡下，双击源 OLE DB 项，选择 Connection Manager 并通过选择底部的 Preview 来验证是否正在拉取值。您可能没有正确提取数据，从而导致转换步骤失败。

4) 最后，比较数据转换输入与数据转换输出之间的设置。这是通过选择数据转换任务并选择属性下的“显示高级编辑器”的超链接来完成的。当窗口打开时，选择选项卡“输入和输出属性”。在左侧窗格中，展开输入列和输出列文件夹以查看三个字段。通过选择一个字段，您可以查看属性。确保长度正确并且正确定义了数据类型属性。如前所述，每个的输出应该是长度为 50 的“Unicoce 字符串 [DT_WSTR]”。

希望这可以帮助。

# .htaccess - Android/iOS htaccess 检测和重定向

> ID：13883955
> 
> 赞同：3
> 
> 时间：2012-12-14T18:00:33.477
> 
> 标签：.htaccess, user-agent, redirect

如何配置`htaccess`文件将 android 客户端重定向到一个 URL 并将 iPhone 客户端重定向到另一个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-14T18:05:44.257

你当然可以！您所要做的就是查看用户代理并在满足条件时执行重定向。

```
RewriteEngine On

RewriteCond %{HTTP_USER_AGENT} "android" [NC]
RewriteRule ^(.*)$ /android/$1 [L,QSA]

RewriteCond %{HTTP_USER_AGENT} "iphone|ipod|ipad" [NC]
RewriteRule ^(.*)$ /ios/$1 [L,QSA] 
```

让我分解一下这里发生了什么。首先，我们确保`RewriteEngine`已打开（v.important）。这些`RewriteCond`行是必须满足的条件才能执行其后的规则。在我们的例子中，条件是在发出请求的设备的用户代理中出现某些关键字。第一个条件匹配单词“android”，第二个条件匹配任何字符串“iphone”、“ipod”、“ipad”。文本匹配是使用[正则表达式](http://www.regular-expressions.info/reference.html)完成的。

每行之后的行`RewriteCond`是根据他们的设备进行 URL 重写（在最终用户看来是重定向）的实际规则。该规则说接受整个请求（再次使用正则表达式）并添加到开头`/android`or `/ios`。您看到的`$1`代表正在重写的实际请求字符串。

*   **`[NC]`**表示匹配不区分大小写（无大小写）。IE `Android == aNdroid`, `IOS == iOS`, 等等...
*   **`[L]`**表示当前规则是最后一条，不执行其他条件或规则。如果您只是在寻找 android 和 ios 设备之间的区别，那么您也许可以使用简单的`android`或`iphone/ipad/ipod`. 如果您想检测特定设备，则必须更具体地匹配它的用户代理。

# java - Hibernate + PostgreSQL：空布尔值返回为“真”

> ID：13883956
> 
> 赞同：3
> 
> 时间：2012-12-14T18:00:35.203
> 
> 标签：java, hibernate, postgresql, jpa, boolean

我们在 Hibernate + PostgreSQL 上遇到了一个奇怪的错误：

我们有一个以前在 Firebird、MySQL 和 Derby 上测试过的 Hibernate 3.6 应用程序，现在我们正试图让它在 PosgreSQL 9.2 上工作；我们遇到了在以前的数据库中没有发生的各种奇怪的问题，其中，有一个错误，即在数据库中具有*空*值的可空布尔字段被 Hibernate 加载为*true*，而不是*null*。持久类的对应属性都是*java.lang.Boolean*，没有额外的注释。

关于什么可能导致这种行为的任何想法？

- - 编辑 - -

终于有时间做一个更完整的调试：结果证明根本不是 Hibernate 错误，而是在我们代码库的一个角落里埋藏了一个 LoadEventListener。:P

无论如何，感谢您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T20:51:37.133

首先，确保这不是测试其他 PostgreSQL 版本的错误。

你试过 PostgreSQL 9.1 吗？9.2 很新。9.1更稳定。

当发布新的 SGBD 版本时，Hibernate 和其他的持久性框架会引发一些错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T01:39:49.193

终于有时间做一个更完整的调试：结果证明根本不是 Hibernate 错误，而是在我们代码库的一个角落里埋藏了一个 LoadEventListener。:P

无论如何，感谢您的建议。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-14T18:10:52.187

我唯一的猜测是，由于 PostgreSQL 可以将空值存储为“未知”，因此当它转换回 java.lang.Boolean 时，该值以某种方式被映射为“真”。

虽然完全是疯狂的猜测。

# php - 检查财产是否存在，如果它确实建立在财产之上

> ID：13883958
> 
> 赞同：1
> 
> 时间：2012-12-14T18:00:47.417
> 
> 标签：php, foreach, object-properties

我有以下 PHP 代码：

```
$alignments = new StdClass();

        if ($query->num_rows > 0)
        {
            foreach($query->result() as $row){
                $alignments->{$row->table_id} = new StdClass();

                $alignments->{$row->table_id}->table_id = isset($row->table_id)?$row->table_id:NULL;
                $alignments->{$row->table_id}->title = isset($row->title)?$row->title:NULL;
                $alignments->{$row->table_id}->url = isset($row->url)?$row->url:NULL;
                $alignments->{$row->table_id}->state_id = isset($row->state_id)?$row->state_id:NULL;
                $alignments->{$row->table_id}->cross_discipline_alignment = isset($row->cross_discipline_alignment)?$row->cross_discipline_alignment:NULL;
                $alignments->{$row->table_id}->common_core = isset($row->common_core)?$row->common_core:NULL;
                $alignments->{$row->table_id}->grade_level = isset($row->grade_level)?$row->grade_level:NULL;
                $alignments->{$row->table_id}->indicators = new StdClass();
                $alignments->{$row->table_id}->indicators->{$row->indicator_id} = new StdClass();
                $alignments->{$row->table_id}->indicators->{$row->indicator_id}->indicator_id = isset($row->indicator_id)?$row->indicator_id:NULL;
                $alignments->{$row->table_id}->indicators->{$row->indicator_id}->indicator = isset($row->indicator)?$row->indicator:NULL;
                $alignments->{$row->table_id}->indicators->{$row->indicator_id}->key = isset($row->key)?$row->key:NULL;
                $alignments->{$row->table_id}->indicators->{$row->indicator_id}->extra_data = isset($row->extra_data)?$row->extra_data:NULL;
                $alignments->{$row->table_id}->indicators->{$row->indicator_id}->uri_k5 = isset($row->uri_k5)?$row->uri_k5:NULL;
                $alignments->{$row->table_id}->indicators->{$row->indicator_id}->uri_612 = isset($row->uri_612)?$row->uri_612:NULL;
            }

            return $alignments;
        } 
```

问题是，在 foreach 循环中，如果有多个相同的项目，`$row->table_id`则设置循环中的最后一个（忽略所有其他项目）。我已经尝试过了`!isset($alignments->{row->table_id})`，它仍然是压倒一切的。我想说如果变量`$alignments->{$row->table_id}`存在，使用它，如果不存在，将其设置为`new StdClass()`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:11:06.267

也许你需要像这样包装你的初始化：

```
if (!property_exists($alignment, $row->table_id)) {
  $alignments->{$row->table_id} = new StdClass();
} 
```

# ios - IOS项目中的类型名称错误和其他

> ID：13883960
> 
> 赞同：0
> 
> 时间：2012-12-14T18:00:57.290
> 
> 标签：ios

我正在尝试按照他们在此处编写的说明将 iOS-ngn-stak 项目链接到我的应用程序： [http](http://code.google.com/p/idoubs/wiki/Building_iDoubs_v2_x) ://code.google.com/p/idoubs/wiki/Building_iDoubs_v2_x 但有这些新错误，请提供任何帮助 ![在此处输入图像描述](../Images/89710050a3fa70959ebee7adfba28c59.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:04:11.913

看起来它没有将代码视为 C++，而仅将其视为 C/objC。

将使用项目头文件的 m 个文件重命名为 mm 以使其成为 objC++

例如你的 ViewController.m 到 ViewController.mm

# java - Spring Transaction 中是否需要异常处理？

> ID：13883966
> 
> 赞同：5
> 
> 时间：2012-12-14T18:01:29.377
> 
> 标签：java, spring, exception-handling, transactions

我对事务的异常处理有疑问。为了清楚地说明我的问题，我想展示我的配置：

```
<bean id="transactionManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
</bean>

<tx:annotation-driven transaction-manager="transactionManager" />

<bean id="transactionInterceptor" abstract="true" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
    <property name="transactionManager" ref="transactionManager" />
    <property name="transactionAttributeSource">
        <bean class="org.springframework.transaction.annotation.AnnotationTransactionAttributeSource" />
    </property>
</bean>

<bean id="baseService" abstract="true">
    <property name="daoProvider" ref="daoProvider" />
</bean>

<bean id="customerService" parent="transactionInterceptor">
    <property name="target">
        <bean class="com.edfx.adb.service.CustomerService" parent="baseService" />
    </property>
</bean>

<bean id="daoProvider" class="com.edfx.adb.dao.provider.DaoProvider">   
    <property name="customerDao" ref="customerDao" />
</bean>

<bean id="customerDao" class="com.edfx.adb.dao.CustomerDao">
    <constructor-arg value="#{T(com.edfx.adb.persist.entity.Customer)}" />
    <property name="sessionFactory" ref="sessionFactory" />
</bean> 
```

活动事务类是：

```
@Transactional
public class CustomerService extends BaseService implements ICustomerService {

    @Transactional(readOnly = true)
    public Customer getCustomerById(String id) {
        return getDaoProvider().getCustomerDao().getCustomerById(id);
    }

    @Transactional(readOnly = false, propagation = Propagation.REQUIRED, rollbackFor = { Throwable.class })
    public void addNewCustomer(CustomerDTO customerDTO) {
        Customer customer = new Customer();

        customer.setCustomerId(customerDTO.getCustomerId());
        customer.setCustomerName(customerDTO.getCustomerName());
        customer.setActive(customerDTO.isActive());

        getDaoProvider().getCustomerDao().save(customer);
    }
} 
```

我的疑惑在于方法`addNewCustomer`。我已经设置了`rollbackFor = { Throwable.class }`。

它是如何工作的？

我还需要显式处理异常，例如：

```
@Transactional(readOnly = false, propagation = Propagation.REQUIRED, rollbackFor = { Throwable.class })
public boolean addNewCustomer(CustomerDTO customerDTO) {
    Customer customer = new Customer();

    customer.setCustomerId(customerDTO.getCustomerId());
    customer.setCustomerName(customerDTO.getCustomerName());
    customer.setActive(customerDTO.isActive());

    try {
        getDaoProvider().getCustomerDao().save(customer);
    } catch (Throwable throwable) {
        return false;
    }

    return true;
} 
```

我通过从客户表中删除一列强制创建了一个异常，但是该异常没有在 try-catch 块中捕获，而是我可以从调用该`addNewCustomer`方法的托管 bean 中捕获该异常。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-14T18:26:55.777

这是 Spring 文档的摘录

> 在其默认配置中，Spring Framework 的事务基础结构代码仅在运行时、未经检查的异常情况下将事务标记为回滚；也就是说，当抛出的异常是 RuntimeException 的实例或子类时。（错误也会 - 默认情况下 - 导致回滚）。从事务方法抛出的检查异常不会导致默认配置中的回滚。

您设置了 rollbackFor = Throwable.class，现在 Spring 将为任何异常/错误回滚。默认情况下，不管我们喜不喜欢，Spring 只会对 RuintimeException 进行回滚，否则提交

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-14T18:03:31.323

Spring 框架只抛出 RuntimeExceptions，从技术上讲，您永远不必捕获任何异常。

# jquery - 当网页向下滚动时，中心屏幕上的 Div 不居中

> ID：13883975
> 
> 赞同：0
> 
> 时间：2012-12-14T18:02:18.577
> 
> 标签：jquery

如何使网站上的 div 居中？我有这样的脚本：

```
$(document).ready( function(){    

    $('.cod').click(function() {
    var div_name = $(this).attr('id');

    $('#overlay_window').load('/templates/' + div_name + '_template.php', function(){
    var div_width = $('#'+div_name+'-overlay').width();
    var div_height = $('#'+div_name+'-overlay').height();
    $('#overlay_window').css("width", ""+div_width+"px")
    $('#overlay_window').css("height", ""+div_height+"px")
    var div2_width = $('#overlay_window').width();
    var div2_height = $('#overlay_window').height();
    var window_width = $(window).width();
    var window_height = $(window).height();

    var widthoffset = (window_width - div2_width) / 2;  
    var heightoffset = (window_height - div2_height) / 2;   
    $('#overlay_window').css("left", "" + (widthoffset) + "px");
    $('#overlay_window').css("top", "" + (heightoffset + 750) + "px");
    $('#overlay_background').fadeIn(800);
    $('#overlay_window').fadeIn(800);
    });
    });

    }); 
```

但是它将div从页面顶部居中，如果它向下滚动它会出现在顶部而不是我滚动的地方，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:09:14.163

`position: fixed`无论用户滚动到哪里，为什么不直接标记并保留它呢？那么你就不需要任何形式的 js 诡计了。

但是，为了回答您当前的问题，您似乎提供了一次居中，您永远不会对窗口的滚动事件做出反应：

```
 $(window).scroll(function() { $('#divID').center(); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:11:17.897

你可以`position:fixed;`在你的`#overlay_window`. 此 div 将固定到窗口中的某个位置，而不是文档中。

# html - 简单的 CSS 让 IE 9 出现问题

> ID：13883977
> 
> 赞同：1
> 
> 时间：2012-12-14T18:02:40.097
> 
> 标签：html, css

我有这个 CSS 代码：

```
html {
    overflow-y: scroll;
}

body {
    background-color: #e4e4e4;
    font-size: 12px;
    font-family: Verdana, 'Lucida Grande', Arial, Sans-Serif;
    line-height: 1.6;
    color: #555;
}

#wrapper {
    width:950px;
    position: relative;
    margin: 20px auto;
    background-color: #fff;
    border: 1px solid #333;
    -webkit-border-radius: 10px;
       -moz-border-radius: 10px;
            border-radius: 10px;
} 
```

在 Chrome 中它可以完美运行，包装器位于任何屏幕分辨率的中间并具有曲线边框。

但是对于IE9来说非常大的麻烦，包装器粘在左边，边框不显示等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:17:54.567

请参阅这篇关于圆角和 IE 9 - [IE9 边框半径的帖子](https://stackoverflow.com/questions/7369796/ie9-border-radius)

PS - 在我的虚拟机上的 IE9 中去解决这个问题，而 jsfiddle 在 IE9 中不起作用，哈哈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:04:36.243

认为你需要这个

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

将其粘贴在`<head></head>`标签之间

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T18:20:45.207

您是否指定了正确的文档类型？这只是猜测，因为您没有共享任何 HTML 代码。

# android - 在android上的不同按钮上检测两个滚动

> ID：13883979
> 
> 赞同：0
> 
> 时间：2012-12-14T18:02:43.943
> 
> 标签：android

好吧，所以，我有一个视图，上面有两个 Button。

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<LinearLayout 
    android:id="@+id/linear"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal">

<Button
    android:id="@+id/botonno"
    android:layout_width="130dp"
    android:layout_height="match_parent"
    android:background="@drawable/red_button"
    android:layout_weight="0.5"
    android:text="NON"
    android:textColor="#FFF"
    android:textSize="30sp"
    android:textStyle="bold" />

<Button
    android:id="@+id/botonoui"
    android:layout_width="130dp"
    android:layout_height="match_parent"
    android:background="@drawable/green_buton"
    android:layout_weight="0.5"
    android:text="OUI"
    android:textColor="#FFF"
    android:textSize="30sp"
    android:textStyle="bold" /> 
```

我需要的是用户将同时触摸两个按钮，但我需要检测他/她是否在“ouiButton”或“nonButton”上滚动。

我尝试过使用 onGestureListener，但它没有检测到任何东西.....有人知道吗？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:40:57.470

尝试 ：

```
Button ouiButton = (Button) view.findByViewId(R.id.botonoui);
ouiButton.didTouchFocusSelect(); 
```

或者

```
ouiButton.setOnGenericMotionListener(new OnGenericMotionListener() {
//Insert code here
}); 
```

# python - 使用 python 日志记录在日志中插入空行的最佳方法是什么？

> ID：13883982
> 
> 赞同：3
> 
> 时间：2012-12-14T18:03:07.243
> 
> 标签：python, logging

我目前做

```
# three extra blank lines per srh for debug log
logging.info('')
logging.info('')
logging.info('') 
```

但这使得代码臃肿，有没有更好的办法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-27T23:50:02.517

这不是一个真正的空行，但有时我会使用它：

```
logging.info('-' * 80) 
```

# django - 是否可以仅显示管理站点的调试错误页面？

> ID：13883983
> 
> 赞同：1
> 
> 时间：2012-12-14T18:03:24.113
> 
> 标签：django

`DEBUG = False`在你的settings.py中，如果有错误等，它会显示templates/500.html 。

使用`DEBUG = True`，django 的开发错误页面将显示并为您（开发人员）提供有用的错误消息和调试信息

**问：在我拥有的生产环境中`DEBUG = False`，有没有办法为仅在 Django /admin 站点中发生的错误显示“开发错误页面”？**

例如，不需要向管理员用户显示漂亮的错误页面，而且我可以更快地解决问题，因为管理员可以将错误复制并粘贴并通过电子邮件发送给我，而不是我必须通过 SSH 连接到多个应用程序服务器并检查日志

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:06:46.910

使用[哨兵](http://getsentry.com/welcome/)（也可以作为您自己托管的[开源项目提供）。](https://github.com/getsentry/sentry)它将收集所有错误（无论它们发生在哪里），为您提供详细的追溯，并为您通知和跟踪错误。

所有这一切`DEBUG = False`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T20:33:38.570

Django 的 DEBUG 设置会执行其他操作（例如记录每个 SQL 查询），这将很快消耗您的服务器内存，但确定为什么不按您的喜好处理异常？

Django 的漂亮异常有很多代码可以清理和自省，`django.views.debug`但它应该直接吐出一个简单的异常。

只需创建一个使用该`process_exception`钩子的中间件。

[https://docs.djangoproject.com/en/dev/topics/http/middleware/?from=olddocs#process_exception](https://docs.djangoproject.com/en/dev/topics/http/middleware/?from=olddocs#process_exception)

```
class MyExceptionHandler(object):
    def process_exception(self, request, exception):
        if request.path.startswith('/admin/'):
             return http.HttpResponse(
                      "We've encountered an exception in the /admin/ pages!") 
```

您可以随意返回尽可能多的调试信息。

# java - 阻止为启动应用程序打开 CommandPrompt 窗口

> ID：13883984
> 
> 赞同：0
> 
> 时间：2012-12-14T18:03:24.570
> 
> 标签：java, windows, startup, command-prompt

我有一个应该在操作系统启动时运行的 Java 应用程序。
它在 Windows XP Professional 上运行，我添加了注册表项`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run`并将其用作键值：

```
java -jar "C:\path\to\app.jar" 
```

但这`CommandPrompt`会在启动时打开窗口！
如何在不打开命令提示符窗口的情况下在启动时运行我的应用程序？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T14:01:10.073

```
javaw -jar "C:\path\to\app.jar" 
```

相关/重复

[使用命令行参数启动 .jar 文件（但没有控制台窗口）](https://stackoverflow.com/questions/711370/launch-jar-files-with-command-line-arguments-but-with-no-console-window)

[java和javaw的区别](https://stackoverflow.com/questions/12129505/difference-between-java-and-javaw)

# asp.net - CSS中的图像路径

> ID：13883985
> 
> 赞同：0
> 
> 时间：2012-12-14T18:03:25.847
> 
> 标签：asp.net, css, asp.net-mvc-4, background-image, less

我正在使用一些 CSS 框架并尝试显示图标（使用具有*background-image*属性的类选择器）。可以说，我的文件结构是：

```
Content / site.css
Content / Folder1  / framework.css
Content / Folder1  / Folder2       / framework-images.css
Content / Folder1  / Folder2       / framework-icon1.png 
```

**site.css**看起来像：

```
@include "Folder1/framework.css";
... 
```

**framework.css**像：

```
@include "Folder2/framework-images.css";
... 
```

**框架图像.css**是：

```
.selector {
    background-image: url("icon1.png");
} 
```

但是当我试图添加到我的 html 元素类“选择器”时，Firefox 开发工具显示它试图从这里加载图标：

```
http://localhost:1234/Content/~/Content/Folder1/Folder2/icon.png 
```

虽然正确的路径是（**我对吗？**）：

```
~/Content/Folder1/Folder2/icon.png 
```

要不就

```
http://localhost:1234/Content/Folder1/Folder2/icon.png 
```

那么哪里会出错呢？如何告诉客户使用正确的路径？

PS 如果重要的话，我使用的是 dotless (Less css)。换句话说，所有**.css**实际上都是**.less**。

PPS 这是 ASP.NET MVC4 应用程序。

**更新：** 正如@djfarrelly 指出的那样，问题出在*background-image: url(...)*中的路径不正确。我已将其更改为：

```
background-image: url("/Content/Folder1/Folder2/Icon1.png"); 
```

它开始工作了。但我还是很困惑。谁能解释为什么没有完整路径指定它不能工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:22:23.413

您对图像的所有引用都应参考您网站中的根文件夹，以避免混淆。您是否尝试将您的 css 更改为从根目录引用：

```
.selector {
    background-image: url("/Content/Folder1/Folder2/icon1.png");
} 
```

如果你包括`/`应该清理它。

**编辑：** 我最初发布这个 w/`../`而不是正确`/`引用根文件夹。

# ruby-on-rails - 使用 Sorcery gem 使用自定义参数登录 Facebook oauth

> ID：13883986
> 
> 赞同：0
> 
> 时间：2012-12-14T18:03:26.337
> 
> 标签：ruby-on-rails, facebook, oauth, sorcery

我正在尝试将自定义参数传递给 Facebook oauth url 以将其返回到回调中。我知道这是可能的，但我正在使用 Sorcery gem，我需要动态设置参数，我的意思是我不能在 sorcery.rb 初始化文件中定义它，就像现在一样：

```
Rails.application.config.sorcery.configure do |config|
  config.facebook.callback_url = ENV['FACEBOOK_CALLBACK_URL']
 ...
end 
```

我需要在我的控制器中定义，我该如何使用这个 gem？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T02:13:19.863

我还没有找到这个文档，但它有效，所以只需放入你的控制器：

```
::Sorcery::Controller::Config.facebook.callback_url = ENV['FACEBOOK_CALLBACK_URL'] + "param1=foo" 
```

并且 param1 将在身份验证后发回给您 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T10:35:41.643

使用[oAuth Dialog](http://developers.facebook.com/docs/reference/dialogs/oauth/)`state`中列出的参数。

> 用于维护请求和回调之间的应用程序状态的唯一字符串。

Facebook 将重定向回该网站：

```
YOUR_REDIRECT_URI#
    access_token=USER_ACCESS_TOKEN
   &expires_in=NUMBER_OF_SECONDS_UNTIL_TOKEN_EXPIRES
   &state=YOUR_STATE_VALUE 
```

# database - postgresql：重新计算表上的行 ID

> ID：13883991
> 
> 赞同：1
> 
> 时间：2012-12-14T18:03:51.420
> 
> 标签：database, postgresql, rdbms

我的表中有 id 列，即：

```
 id     BIGSERIAL NOT NULL PRIMARY KEY, ... 
```

在删除了某些行之后，该表的 id 不一致，例如 1、10、11、12 ... 即实际行数与 pg 的序列 ID 不符...我想我应该以某种方式重新计算行，对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T03:41:39.977

如果您想要无间隙、连续的标识符，请不要使用 a`SERIAL`或`BIGSERIAL`( `SEQUENCE`)。这是一个常见问题解答。序列不仅不会重复使用已删除的 ID，而且即使您不删除任何内容，它们中也可能存在间隙，因为在事务回滚或数据库不干净重新启动后会丢弃 ID。

搜索“postgresql 无间隙序列”。

[我在这里](https://stackoverflow.com/questions/9984196/rails-postgres-does-not-re-use-deleted-ids-but-mysql-does/9985219#9985219)写了一点。

如果您使用合成密钥，您应该只关心一个 ID 是否等于另一个 ID。不要试图比较它们来说“A 和 B 之间有多少个 ID”；`SEQUENCE`这对生成的ID没有意义。

# jquery - 检测输入某个类的输入元素

> ID：13883994
> 
> 赞同：12
> 
> 时间：2012-12-14T18:04:12.780
> 
> 标签：jquery, class, keypress, enter

我需要检测何时有人在具有特定类的文本输入中点击“输入”。

我的jQuery如下：

```
$('input.large').keypress(function (e) {
    if(e.which ==13)
        console.log("pressed enter");
}); 
```

我的 HTML 是这样的：

```
<tr><td> Personal Name </td></tr>
<tr><td> <input type='text' class='large'> </td></tr>

<tr><td> Email</td></tr>
<tr><td> <input type='text' class='large'> </td></tr> 
```

当我给出字段 ID 并尝试`$('#elementid').keypress`它时，它起作用了。但这行不通。我没有控制台输出。我错过了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-14T18:20:28.100

您可以在其中使用实时（[.on()](http://api.jquery.com/on/)）事件（我认为这更好）。它将允许您检测与选择器匹配的当前和未来元素。`document``keydown``keydown`

**HTML**：

```
<strong>Personal Name</strong>
<input type='text' class='large' /><br />

<strong>Email</strong>
<input type='text' class='large' />
​ 
```

**JS**（jQuery 1.7+）：

注意：`.which`, `.code`,`.charCode`和`.keyCode`现已[弃用](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent)。使用以下新解决方案：

```
jQuery(document).on('keydown', 'input.large', function(ev) {
    if(ev.key === 'Enter') {
        // Will change backgroundColor to blue as example
        this.style.backgroundColor = '#EFF';

        // Avoid form submit
        return false;
    }
}); 
```

**jsFiddle**：http: [//jsfiddle.net/david_proweb/fjgvhubn/2/](http://jsfiddle.net/david_proweb/fjgvhubn/2/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T18:19:21.930

检查这个：http: **[//jsfiddle.net/EJyyr/](http://jsfiddle.net/EJyyr/)**

使用了这个html：

```
<tr><td> Personal Name </td></tr>
<tr><td> <input type='text' class='large' id='a'> </td></tr>

<tr><td> Email</td></tr>
<tr><td> <input type='text' class='large' id='b'> </td></tr> 
```

这是jQuery`which logs the input text id`

```
$('.large').keypress(function (e) {
   if(e.which ==13)
    console.log($(this).attr('id'));
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-06T20:02:37.003

感谢大卫罗德里格斯的解释。它有很大帮助。我不得不升级我的 JQuery 库并且 .live() 函数停止正常工作。

您可以将其用于以下

单击 select_all_checkboxes 输入类型复选框时选择表单的所有复选框输入：

```
jQuery(document).on("click", "#select_all_checkboxes", function(){
    var chk = this.checked;
    $('input[id=selectAll]').each(function(){
        this.checked = chk;
    });
}); 
```

当用户使用选项卡或单击具有类名“email”的任何字段离开字段时调用函数“checkMail”：

```
jQuery(document).on("blur", 'input.email', function(event){
    var email = $(this).val();
    if (!checkMail(email)) {
        alert("Invalid email.");
        $(this).focus();
    }
}); 
```