# StackOverflow 问答 15966000-15966999

# javascript - Kendo Panelbar - 向面板添加复选框以选择多个面板标题

> ID：15966000
> 
> 赞同：0
> 
> 时间：2013-04-12T07:57:22.530
> 
> 标签：javascript, checkbox, kendo-ui, panelbar

我想要实现的是将复选框添加到面板标题中，就像我创建`PanelBar`的以下[小提琴中一样。](http://jsfiddle.net/5nX8r/31/)

下面是html：

```
<ul id='panelbar'>
    <li class='k-state-active'> <span class='k-link k-state-selected'>Tab 1 <input type="checkbox" class="cbSelect"/></span>
        <div>Test 1</div>
    </li>
    <li> <span class='k-link k-state-selected'> Tab2 <input type="checkbox" class="cbSelect"/></span>
        <div>Test 2</div>
    </li>
</ul> 
```

我发现当您尝试选中复选框时，该选项卡会打开。

**单击复选框时是否可以禁用单击选项卡的 onclick 方法？**

*如果是这样，关于如何实现这一目标的任何想法？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:14:19.800

只是防止传播：

```
$("#panelbar").on("click", "input.cbSelect", function(evt) {
    evt.stopPropagation();
}) 
```

请参阅：[jsFiddle](http://jsfiddle.net/5nX8r/33/)。

# php - MySQL 更新查询 - 按行号

> ID：15966010
> 
> 赞同：0
> 
> 时间：2013-04-12T07:58:04.760
> 
> 标签：php, mysql

我想在达到特定行号时更新 MySQL 表中的一行

这有点令人困惑，因为记录的实际行号不是表中的列。

并且没有迭代 rows 的问题，因为我们没有像中那样迭代数组`mysql_fetch_array()`

所以，如果我想更新——比如表的第三行，查询会是什么样子？

我是 MySQL 的菜鸟

非常感谢您的帮助！:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:34:41.010

```
$link = mysqli_connect("localhost", "my_user", "my_password", "my_db");
$query = "SELECT MyColoumn FROM Mytable";
$result = mysqli_query($link, $query);

$row_needed = 3; //Your needed row e.g: 3rd row
for ($i=1,$i=$row_needed,$i++) {
$row = mysqli_fetch_array($result); 
}
// now we are in 3rd row
$query = "UPDATE MyColumn FROM MyTable SET MyColumn = '".$MyColumnUpdate."' WHERE MyColumn = '".$row['MyColumn']."' ";
$result = mysqli_query($link, $query);
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:07:30.207

试试这个查询

```
UPDATE 
   tbl a, 
   (Select 
       @rn:=@rn+1 as rowId, 
       tbl.* 
   from 
       tbl 
   join 
       (select @rn:=0) tmp) b
SET 
   a.columnName = <VALUE>
WHERE 
   b.rowId = <rowNumber> AND
   a.id = b.id; 
```

**注意**id 列必须是唯一的，您可以使用该表的主键...

## **[SQLFIDDLE](http://sqlfiddle.com/#!2/18f8f7/1)**

# java - 我的 Eclipse 插件创建了无穷无尽的工作区构建循环，可能与工作相关

> ID：15966014
> 
> 赞同：4
> 
> 时间：2013-04-12T07:58:14.573
> 
> 标签：java, eclipse, build, eclipse-plugin, workspace

我创建了一个插件来挂钩保存操作并创建一个已编辑 javascript 文件的缩小 javascript 文件。你可以在这个问题中看到完整的代码：[eclipse plugin does not work after update to juno (eclipse 4)](https://stackoverflow.com/questions/15159755/eclipse-plugin-does-not-work-after-update-to-juno-eclipse-4)

问题是，自从 Juno 以来，这个插件在工作空间构建过程中创建了无限循环。它首先开始缩小我根本没有更改的文件。该文件在构建中创建了一个无限循环。当它完成缩小文件时，它会启动一个新的工作区构建并再次缩小文件，依此类推。但一段时间后情况会变得更糟，尤其是在新的日食开始时。突然间，它缩小了十几个我从未接触过的文件。如果我卸载我的插件，然后让 eclipse 构建工作区，重新安装我的插件它再次工作。但过了一会儿，这一切又开始了。

我认为这与我处理创建文件的工作方式有关，见下文。也许朱诺在这里发生了一些变化？但我找不到任何有关此的信息。

```
Job compileJob = new Job("Compile .min.js") {
 public IStatus run(IProgressMonitor monitor) {
        public IStatus run(IProgressMonitor monitor) {
            byte[] bytes = null;
            try {
                bytes = CallCompiler.compile(fullLocation.toString(), CallCompiler.SIMPLE_OPTIMIZATION).getBytes();

                InputStream source = new ByteArrayInputStream(bytes);
                if (!newFile.exists()) {
                    newFile.create(source, IResource.NONE, null);
                } else {
                    newFile.setContents(source, IResource.NONE, null);
                }
            } catch (IOException e) {
                e.printStackTrace();
            } catch (CoreException e) {
                e.printStackTrace();
            }
            return Status.OK_STATUS;
        }
};
compileJob.setRule(newFile.getProject());
compileJob.schedule(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T21:58:02.073

您需要设置`newFile`为派生。派生文件是在构建期间由工作区隐式创建的文件，应该在清理期间将其擦除（因为它可以在下一次构建期间恢复）。

您可以调用该`setDerived`方法`IResource`：

```
org.eclipse.core.resources.IResource.setDerived(boolean, IProgressMonitor) 
```

或者当您创建文件时，可以将其创建为派生文件，但调用如下：

newFile.create（流，IResource.DERIVED，监视器）；

但是，您`DERIVED`不能通过 setContents 设置标志，在这种情况下您必须显式调用`setDerived(true)`。

从文档：

> **派生**资源是在翻译、编译、复制或以其他方式处理其他文件的过程中创建的常规文件或文件夹。派生资源不是原始数据，可以从其他资源重新创建。从版本和配置管理中排除派生资源是司空见惯的，否则它们会在每个用户重新生成这些不断变化的文件的版本时使团队存储库变得混乱。

# visual-studio-2010 - 在 Visual Studio 中设置用于调试的内存限制

> ID：15966015
> 
> 赞同：14
> 
> 时间：2013-04-12T07:58:22.090
> 
> 标签：visual-studio-2010

在我正在处理的应用程序中，在某些情况下，内存使用量会飙升，有效地锁定了我的计算机。我不认为这是内存泄漏，也没有错误，它只是需要太多的内存。任务管理器中的内存使用率跃升至 99%，Windows 停止工作，迫使我重新启动。

是否可以设置 VS 在调试时可以使用的最大内存量？我不是在寻找一种让它更快耗尽内存的方法，我只是想保持一些内存可用，以便 Windows 可以继续工作。

*   视觉工作室 2010
*   视窗 7 64b
*   8GB 内存
*   C# .NET

* * *

编辑：
我不是在问如何修复内存泄漏。我正在尝试限制 VS 调试器使用的内存。例如，我的 PC 有 8GB RAM，但我的应用程序必须在具有 2GB RAM 的 PC 上运行。所以我想将 VS 配置为只使用 2GB。如果应用程序尝试分配 2.0001GB，我希望 VS 告诉它没有更多内存（可能导致崩溃）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-04-17T05:59:50.290

这不完全是您正在寻找的答案，但它可能对其他人有所帮助，所以我发布：我会尝试以下操作：1）下载[Oracle Virtualbox](https://www.virtualbox.org/wiki/VirtualBox) 2）从 Microsoft Sysinternals下载[Disk2VHD.exe](https://technet.microsoft.com/en-us/sysinternals/ee656415.aspx) 3）使用克隆您的系统Disk2VHD 4) 使用所需的内存限制配置 VM。

通过这种方式，您可以限制任务使用的 RAM 和 CPU，并且可能更容易从您描述的情况中恢复。

# ajax - ajax按钮调用yii分页点击事件

> ID：15966019
> 
> 赞同：1
> 
> 时间：2013-04-12T07:58:31.963
> 
> 标签：ajax, yii, pagination

几天前我刚刚学习 Yii 为公司开发一个网站。现在我有一些关于 Yii 分页的问题，我真的需要你的帮助。

目前我可以进行 Yii 分页。但是，我需要在分页区域之外创建一个按钮。每次，我单击该按钮，它会调用 ajax 来加载下一页或上一页（如果当前页是最后一页）。

**这是我的模型：**

```
public function getListDesc()
{
    $arrPlace = array(0 => '--- --- --- ---');  
    $criteria=new CDbCriteria;
    $criteria->select='t.*,pi.path path';
    $criteria->join='JOIN places_images pi ON t.id=pi.places_id';
    $criteria->group = 't.id';
    $criteria->compare('t.deleted', '<>1', false);
    $criteria->compare('t.status',1);
    $criteria->compare('outlet','Outlet 1');
    $criteria->order = 't.id DESC';
    return new CActiveDataProvider('Places', array(
        'criteria'=>$criteria,
        'pagination' => array(
        'pageSize' => 2
        )
    ));
} 
```

**这是我的索引页面的一部分，称为该模型：**

```
<?php                               
    $this->widget('zii.widgets.CListView', array(
       'id' => 'places-list-right',
       'dataProvider'=> Places::model()->getListAsc(),
        'summaryText'=>'',
        'pager' => array(
        'header' => '',
        'prevPageLabel' => '<<',
        'nextPageLabel' => '>>',
        ),                       
      'itemView'=>'_fea_oulet',)
    );
?> 
```

**这是 _fea_oulet.php 文件：**

```
<div class="place_img" id="<?=$data->id?>">
        <div class="plusimage">
            <a href="javascript:void(0);" onclick="randnew();">
                <img alt="<?=$data->id?>" src="<?php echo Yii::app()->request->baseUrl; ?>/images/9life-show-more-images.png" style="border:none;border-radius:0;-webkit-border-radius: 0; -moz-border-radius:0">
            </a>
        </div>
        <?php echo CHtml::image("timthumb.php?src=".$data->path."&w=294&h=294&zc=1&q=100",$data->title);?>
        <div class="featitle">
            <h3><span><?php 
                    if(strlen($data->title) > 30) {
                        echo CHtml::encode(mb_substr($data->title,0,30,'UTF-8')) . '...';
                    }
                    else{
                        echo CHtml::encode($data->title);
                    }
                ?></span>
                <a href="javascript:void(0);" class="plusinfo"><img src="<?php echo Yii::app()->request->baseUrl; ?>/images/9life-show-more-green.png" style="border:none;border-radius:0;-webkit-border-radius: 0; -moz-border-radius:0"></a>
            </h3>
        </div>

    </div> 
```

任何帮助表示赞赏。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T09:35:59.773

您可以覆盖[CLinkPager](http://www.yiiframework.com/doc/api/1.1/CLinkPager)类并在小部件的调用`MyLinkPager`中使用您自己的实现，`CListView`指定它的[pager](http://www.yiiframework.com/doc/api/1.1/CBaseListView#pager-detail)属性，如下所示：

```
$this->widget('zii.widgets.CListView', array(
    'id' => 'places-list-right',
    'dataProvider' => Places::model()->getListAsc(),
    'summaryText' => '',
    'pager' => array(
        'class' => 'MyLinkPager',
        'header' => '',
        'prevPageLabel' => '<<',
        'nextPageLabel' => '>>',
    ),                       
    'itemView' => '_fea_oulet'
)); 
```

`run()`方法`CLinkPager`是页面按钮渲染发生的地方，因此您可以直接覆盖此方法。或者，如果您想与其他页面按钮一起查看自定义按钮，则可以通过将自定义按钮添加到数组来覆盖[createPageButtons()方法。](http://www.yiiframework.com/doc/api/1.1/CLinkPager#createPageButtons-detail)`$buttons`

# ios - 按住自定义 UIButton 时更改深灰色突出显示的颜色？

> ID：15966021
> 
> 赞同：39
> 
> 时间：2013-04-12T07:58:34.880
> 
> 标签：ios, objective-c, uibutton, tint

我有一个自定义`UIButton`，它是一个云、透明的黑白 .png 文件，没有关闭状态，只有一个图像。当用手指轻敲并按住它时，它会变成深灰色。我正在尝试将那种深灰色改为不那么压抑的东西。该按钮在视图中打开，而不是在选项卡栏、工具栏或导航控制器中。

我已经尝试过设置`tintColor`（文档有帮助地告诉我，它只适用于“某些”类型的按钮，没有说明是哪一个）。

我还尝试更改在 Interface Builder 中可以找到的与突出显示颜色、默认状态等相关的所有内容。没有任何改变。

我什至尝试为按钮的`UIControlStateHighlighted`状态设置自己的图像，但即使这样，当我将手指放在它上面时，也会出现深灰色的覆盖层。

我怎样才能改变这种颜色？我在 SO 上查看了许多其他问题，但无法找到适合我的解决方案。任何帮助将不胜感激！

**编辑：**我使用一个类别解决了这个问题，该类别`UIImage`添加了一种方法，用于`CoreGraphics`将色调应用于提供的`UIImage`. 然后我将那个图像设置为亮点，一切都很好。似乎很多箍拉改变颜色苹果应该让我们改变，但c'est la vie。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-04-12T08:00:53.397

您说您为该`UIControlStateHighlighted`州设置了自定义图像。这*应该*禁用默认行为。

如果您仍然有问题，您可以通过将`adjustsImageWhenHighlighted`属性设置为`NO`并使用您想要的任何自定义效果来禁用此效果。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2013-11-04T16:06:16.337

如果 adjustsImageWhenHighlighted = NO 不起作用，请将 Button-Type 设置为自定义（IB 或以编程方式）。

默认按钮类型：系统，更改突出显示按钮的行为。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2017-03-14T12:58:44.320

斯威夫特 3：

```
myButton.adjustsImageWhenHighlighted = false 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-19T03:00:27.800

当按钮每次按下时都以灰色突出显示时，我遇到了与自定义 UIButton 类似的问题。我通过子类化 UIButton 解决了这个问题，在实现中我覆盖了一个方法，(void)setHighlighted: 方法并将其保持为空：

```
- (void)setHighlighted:(BOOL)highlighted
{
   // Leave empty to prevent super from doing whatever
   // that it is doing to show the grey highlight.
} 
```

这停止了​​任何类型的突出显示，因为我没有在该方法中做任何事情。如果您要做的只是删除任何突出显示效果，这是一种更好的方法。

所以在你的代码中，创建一个 UIButton 的子类，重写 setHighlighted 方法，然后让你的自定义按钮成为这个自定义类的子类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-27T10:46:25.450

您可以编写一个自定义按钮来执行此操作

```
class ActionButton: UIButton {

  var originalBackgroundColor: UIColor!

  override var backgroundColor: UIColor? {
    didSet {
      if originalBackgroundColor == nil {
        originalBackgroundColor = backgroundColor
      }
    }
  }

  override var isHighlighted: Bool {
    didSet {
      guard let originalBackgroundColor = originalBackgroundColor else {
        return
      }

      backgroundColor = isHighlighted ? originalBackgroundColor.darken() : originalBackgroundColor
    }
  } 
```

# java - Eclipse - Error: is not recognized

> ID：15966039
> 
> 赞同：0
> 
> 时间：2013-04-12T07:59:31.517
> 
> 标签：java, html, eclipse, wicket

In my eclipse html Editor, I see these errors `- Error: <wicket:panel> is not recognized!` I have included in the html tag the following but it is not still helping

```
 <html xmlns:wicket="http://wicket.apache.org/dtds.data/wicket-xhtml1.4-strict.dtd"> 
```

Can anyone suggest a solution? Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T11:16:23.610

To use the latest xsd try the following snippet

```
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:wicket="https://git-wip-us.apache.org/repos/asf/wicket/repo?p=wicket.git;a=blob_plain;f=wicket-core/src/main/resources/META-INF/wicket-1.5.xsd;hb=master"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:10:29.083

I always use pretty much the same tag but with the xmlns added.

```
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:wicket="http://wicket.apache.org/dtds.data/wicket-xhtml1.4-strict.dtd"> 
```

Hope it helps.

# android - 在 SqlLite 数据库程序中没有找到这样的表错误

> ID：15966043
> 
> 赞同：0
> 
> 时间：2013-04-12T07:59:51.940
> 
> 标签：android, sqlite

我创建了一个 SqlLite 数据库程序，但每次它显示以下错误

> 没有找到这样的表

请告知为什么显示错误。

```
public static final String TOWN_ID="_id";
public static final String TOWN_NAME="name";
public static final String DISTT_ID="disttidd";
private static final String TAG="DbaAdapter";
private static final String DATABASE_NAME="mydb";
private static final String DATABASE_TABLE="tableetown";
private static final int DATABASE_VERSION=2;
private static final  String DATABASE_CREATE="create table "+DATABASE_TABLE+"("+TOWN_ID+" int primary key ,"+TOWN_NAME+" text not null,"+DISTT_ID+" text not null)";
private final Context context;
private DatabaseHelper DBhelper;
private static SQLiteDatabase db;

public tableTown(Context ctx){
    this.context=ctx;
    DBhelper=new DatabaseHelper(context);

}
/* db=DBhelper.getWritableDatabase();
      return this;
 * 
 */
private static class DatabaseHelper extends SQLiteOpenHelper{
    DatabaseHelper(Context context){
        super(context,DATABASE_NAME,null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        // TODO Auto-generated method stub
        db.execSQL(DATABASE_CREATE);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub
        Log.w(TAG,"Upgrading database from version " + oldVersion +" to "+ newVersion+", which will destroy all old data");
       db.execSQL("DROP TABLE IF EXISTS tableTown");
       onCreate(db);
    }
}
public tableTown open() throws SQLException {
    db=DBhelper.getWritableDatabase();
    return this;

    // TODO Auto-generated method stub

}
public Cursor fetchAllDistt() {
    // TODO Auto-generated method stub
    Cursor mCursor = db.query(DATABASE_TABLE, new String[] {TOWN_ID,TOWN_NAME,DISTT_ID}, null, null, null, null, null);

      if (mCursor != null) {
       mCursor.moveToFirst();
      }
      return mCursor;
}
public void close() {
    // TODO Auto-generated method stub
    DBhelper.close();
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-20T22:08:05.827

如果您的应用程序在 onUpgrade 中崩溃，那么 Volodymyr Yatsykiv 回答了您的问题。尝试将其更改为

`@Override public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) { db.execSQL("DROP TABLE IF EXISTS " +DATABASE_TABLE); onCreate(db); }`

并确保使用 DATABASE_TABLE 而不是硬编码表名。

如果它仍然崩溃，请提供完整的日志。

最好的祝愿。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:30:32.183

在你的创建里面写这个：

```
String DATABASE_CREATE = "CREATE TABLE " + DATABASE_TABLE + "("
            + TOWN_ID + " INTEGER PRIMARY KEY," + TOWN_NAME + " TEXT NOT NULL,"
            + DISTT_ID + " TEXT NOT NULL" + " )";
    db.execSQL(DATABASE_CREATE); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T09:01:40.283

我在这种情况下使用[SQLiteManager](http://www.coderzheaven.com/2011/04/18/sqlitemanager-plugin-for-eclipse/)。

在 onCreate 中放置一个断点，确保该行被执行。然后，切换到 DDMS 视图并使用插件找出问题所在。

希望这会有所帮助，亚龙

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-12T08:14:48.597

尝试这个：

```
String DATABASE_CREATE="create table "+DATABASE_TABLE+"("+TOWN_ID+" integer primary key ,"+TOWN_NAME+" text not null,"+DISTT_ID+" text not null);"; 
```

放 ”;” 到 DATABASE_CREATE 字符串的末尾。

寻找这个：

```
private static final String DATABASE_TABLE="tableetown"; 
```

和这个：

```
db.execSQL("DROP TABLE IF EXISTS tableTown"); 
```

表名不同！

# memory - cudaMemGetInfo 在 GTX 690 的两台设备上返回相同数量的可用内存

> ID：15966046
> 
> 赞同：2
> 
> 时间：2013-04-12T08:00:00.987
> 
> 标签：memory, cuda, multi-gpu

我在尝试追踪内存使用情况时遇到了 Geforce GTX 690 的问题。一个简单的测试程序：

```
BOOST_AUTO_TEST_CASE(cudaMemoryTest) {

size_t mem_tot_0 = 0;
size_t mem_free_0 = 0;
size_t mem_tot_1 = 0;
size_t mem_free_1 = 0;

unsigned int mem_size = 100*1000000;

float* h_P = new float[mem_size];
for(size_t i = 0; i < mem_size; i++) {
    h_P[i] = 0.f;
}

cudaSetDevice(0);
cudaDeviceReset();
cudaMemGetInfo  (&mem_free_0, & mem_tot_0);
std::cout<<"Free memory before copy dev 0: "<<mem_free_0<<std::endl;

cudaSetDevice(1);
cudaDeviceReset();
cudaMemGetInfo  (&mem_free_1, &mem_tot_1);
std::cout<<"Free memory before copy dev 1: "<<mem_free_1<<std::endl;

cudaSetDevice(0);
float* P;
cudaMalloc((void**)&P, mem_size*sizeof(float));
cudaMemcpy((void*)P, h_P,  mem_size*sizeof(float), cudaMemcpyHostToDevice);

cudaSetDevice(0);
cudaMemGetInfo(&mem_free_0, & mem_tot_0);
std::cout<<"Free memory after copy  dev 0: "<<mem_free_0<<std::endl;

cudaSetDevice(1);
cudaMemGetInfo(&mem_free_1, &mem_tot_1);
std::cout<<"Free memory after copy dev 1: "<<mem_free_1<<std::endl;

BOOST_CHECK(mem_free_0 != mem_free_1);

cudaError_t err;
err = cudaGetLastError();
if(err!=cudaSuccess)
    std::cout<<"an error occurred"<<std::endl;

cudaSetDevice(0);
destroyMem(P);
delete [] h_P;
} 
```

测试打印出来：

```
1>  Free memory before copy dev 0: 1733173248
1>  Free memory before copy dev 1: 1688424448
1>  Free memory after copy  dev 0: 1289940992
1>  Free memory after copy dev 1: 1289940992     
CudaUtilsTest.cpp(47): error in "cudaMemoryTest": check mem_free_0 != mem_free_1 failed 
```

问题是分配后设备 1 上的空闲内存量与设备 0 上的完全一样，这不应该是这种情况，因此问题必须在 cudaMemGetInfo 和/或 cudaSetDevice 中。任何人都在同样的问题上运行，或者有人可以指出测试中是否存在其他根本性的错误？

在 Windows 7、Visual Studio 2010、Cuda SDK 5.0 上运行代码，使用代码生成进行编译：compute_30,sm_30

编辑 22.4.2013

我继续试验这个问题，似乎 cudaSetDevice 工作正常，可以从 cudaGetDevice 调用的结果中得到验证。我在内存分配测试之后添加了设备 0 的重置，并且似乎 cudaMemGetInfo 返回的可用内存大小对于两个设备来说再次相同。我已经在自己的代码中检查了 cuda_error_t 的所有返回值，并且所有函数调用都返回 cudaSuccess。有没有人在上面描述的设置中遇到过与 GTX 690 类似的问题？

最新测试代码：

```
BOOST_AUTO_TEST_CASE(cudaMemoryTest) {
size_t mem_tot_0 = 0;
size_t mem_free_0 = 0;
size_t mem_tot_1 = 0;
size_t mem_free_1 = 0;

int device_num = 0;

unsigned int mem_size = 100*1000000;

float* h_P = new float[mem_size];
for(size_t i = 0; i < mem_size; i++) {
    h_P[i] = 0.f;
}

cudaSetDevice(0);
cudaGetDevice(&device_num);
cudaDeviceReset();
cudaMemGetInfo  (&mem_free_0, & mem_tot_0);
std::cout<<"Free memory before copy dev 0: "<<mem_free_0<<" Device: "<<device_num<<std::endl;
cudaDeviceSynchronize();

cudaSetDevice(1);
cudaGetDevice(&device_num);
cudaDeviceReset();
cudaMemGetInfo  (&mem_free_1, & mem_tot_1);
std::cout<<"Free memory before copy dev 1: "<<mem_free_1<<" Device: "<<device_num<<std::endl;
cudaDeviceSynchronize();

cudaSetDevice(0);
cudaGetDevice(&device_num);
float* P;
cudaMalloc((void**)&P, mem_size*sizeof(float));
cudaMemcpy((void*)P, h_P,  mem_size*sizeof(float), cudaMemcpyHostToDevice);
cudaMemGetInfo(&mem_free_0, & mem_tot_0);
std::cout<<"Free memory after copy  dev 0: "<<mem_free_0<<" Device: "<<device_num<<std::endl;
cudaDeviceSynchronize();

cudaSetDevice(1);
cudaGetDevice(&device_num);
cudaMemGetInfo(&mem_free_1, &mem_tot_1);
std::cout<<"Free memory after copy dev 1: "<<mem_free_1<<" Device: "<<device_num<<std::endl;
cudaDeviceSynchronize();

BOOST_CHECK(mem_free_0 != mem_free_1);

cudaError_t err;
err = cudaGetLastError();
if(err!=cudaSuccess)
    std::cout<<"an error occurred"<<std::endl;

// Reset only device 0 and check both
cudaSetDevice(0);
cudaGetDevice(&device_num);
cudaDeviceReset();
cudaMemGetInfo  (&mem_free_0, & mem_tot_0);
std::cout<<"Free memory after second reset of device 0, dev 0: "<<mem_free_0<<" Device: "<<device_num<<std::endl;
cudaDeviceSynchronize();

cudaSetDevice(1);
cudaGetDevice(&device_num);
cudaMemGetInfo  (&mem_free_1, & mem_tot_1);
std::cout<<"Free memory after second device reset of device 0, dev 1: "<<mem_free_1<<" Device: "<<device_num<<std::endl;
cudaDeviceSynchronize();

delete [] h_P;
    } 
```

测试输出：

```
1>  Free memory before copy dev 0: 1794379776 Device: 0
1>  Free memory before copy dev 1: 1751728128 Device: 1
1>  Free memory after copy  dev 0: 1351696384 Device: 0
1>  Free memory after copy dev 1: 1351696384 Device: 1
1>  CudaUtilsTest.cpp(353): error in "cudaMemoryTest": check mem_free_0 != mem_free_1 failed
1>  Free memory after second reset of device 0, dev 0: 1751728128 Device: 0
1>  Free memory after second device reset of device 0, dev 1: 1751728128 Device: 1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-01-28T17:38:41.840

这已通过更改 WDDM 驱动程序设置解决，如下所示：

> 从 NVIDIA 控制面板的“3D 设置”->“配置多 GPU、环绕声、PhysX”中切换“禁用多 GPU 模式”。

[此答案从评论中添加为社区 wiki 条目，以将问题从 CUDA 标签的未回答队列中删除]

# linux - 从 CUPS 打印 Windows (samba) 打印队列的作业状态

> ID：15966051
> 
> 赞同：0
> 
> 时间：2013-04-12T08:00:19.870
> 
> 标签：linux, printing, samba, smb, cups

我们有一台带有共享打印机 (printer1) 的 Windows 机器，可用作 smb://winpc/printer1

当从 CUPS 向 smb://winpc/printer1 发送作业时，该作业离开 CUPS 队列并被标记为已成功打印，即使尚未打印（该作业仍然存在于 Windows 打印队列中）。

有没有办法从 CUPS 查询 Windows 上打印队列的作业状态？或者，当作业离开 Windows 打印队列时，是否可以从 CUPS 触发成功打印事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T08:46:43.380

这是有关问题的附加信息。我曾经为 Adzail 工作并创建了 nodeJS 脚本来利用这个问题。[https://gist.github.com/vodolaz095/5325917](https://gist.github.com/vodolaz095/5325917)但它无法跟踪 Windows 共享打印机的状态。无论如何，我希望这会有所帮助

# freebase - 什么属性会为我获取某个主题的 Wikipedia 描述？

> ID：15966055
> 
> 赞同：1
> 
> 时间：2013-04-12T08:00:31.240
> 
> 标签：freebase, mql

我知道一个主题的 /common/topic/description 属性。当我访问特定主题的页面时，一个主题有很多此属性的实例。以下哪些是来自维基百科的描述（如果存在某个主题）？

基本目标是获取主题的描述，如果主题存在，则优先考虑 Wikipedia 描述。

主题的什么属性可以帮助我获取这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:54:09.743

如果您`/common/topic/description`从[主题 API](https://developers.google.com/freebase/v1/topic-overview)请求，您将看到引文数据，告诉您描述来自维基百科。

[https://www.googleapis.com/freebase/v1/topic//m/09c7w0?filter=/common/topic/description](https://www.googleapis.com/freebase/v1/topic//m/09c7w0?filter=/common/topic/description)

```
{
 "id": "/m/09c7w0",
 "property": {
  "/common/topic/description": {
   "valuetype": "string",
   "values": [
    {
     "text": "The United States of America, commonly called the United States and America, is a federal...",
     "lang": "en",
     "creator": "/user/wikirecon_bot",
     "project": "wikirecon",
     "dataset": "/m/0kj4zz_",
     "citation": {
      "provider": "Wikipedia",
      ...
} 
```

# user-interface - 在 wix v3.8 中使用 bundle 时如何只显示一个安装程序 ui？

> ID：15966061
> 
> 赞同：2
> 
> 时间：2013-04-12T08:01:03.487
> 
> 标签：user-interface, wix, bundle

我制作了一个包含 .net 和 msi 以及 wix v3.8 捆绑包的 exe 安装程序。安装程序会在安装时显示两个 UI，一个是 bundle，另一个是 msi。用户要求是安装程序显示一个 UI。我作为追随者的代码：

```
<Chain>
  <ExePackage Id="DoNetFull" Name =".NET Framework 4.0 full runtime" Cache="no" Compressed="yes" PerMachine="yes" Vital="yes"  SourceFile="Resource\dotNetFx40_Full_x86_x64.exe"
              InstallCommand="/q /norestart" Permanent="yes"  DetectCondition="Netfx4FullVersion AND (NOT VersionNT64 OR Netfx4x64FullVersion)">
    <ExitCode Behavior="forceReboot"/>
  </ExePackage>
  <MsiPackage Id="WinApp" Compressed="yes" DisplayInternalUI="yes" ForcePerMachine="yes" SourceFile="Resource\WinAppSetup.msi" Vital="yes" InstallCondition="NOT VersionNT64"></MsiPackage>
</Chain> 
```

MsiPackage 的 DisplayInternalUI 必须设置为是，因为有几个交互式对话框。我该怎么做？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T03:46:37.740

您需要编写一个仅在您需要时显示的自定义 BA。默认的 wixstdba 将在整个安装过程中显示 UI，尽管 MSI UI 在运行时应该显示在顶部。

更新：您可以在 WiX 工具集源代码中找到自定义 BA 的示例`src\Setup\WixBA`。这是一个 WPF UI，但您可以使用它来了解如何构建自己的自定义解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T19:56:20.367

您可以在`silent install`这里阅读：
[http](http://wix.sourceforge.net/manual-wix3/install_directx9.htm)
://wix.sourceforge.net/manual-wix3/install_directx9.htm和这里[http://msdn.microsoft.com/en-us/library/ee942965.aspx](http://msdn.microsoft.com/en-us/library/ee942965.aspx)

# java - 使用 JGraphX 移动单元格

> ID：15966063
> 
> 赞同：1
> 
> 时间：2013-04-12T08:01:13.380
> 
> 标签：java, graph, jgraph

我正在使用 jgraphx 1.12.0.2，并且正在尝试从代码中重新排列图形的顶点。代码看起来像这样：

```
Object[] roots = graph.getChildCells(graph.getDefaultParent(), true, false);
graph.getModel().beginUpdate();
for (int i = 0; i < roots.length; i++) {
    Object[] root = {roots[i]};
    graph.moveCells(root, i * 10 + 5, 50);
    /* these two lines were added because I thought they might help with the problem */
    /* with or without them, the result is the same */
    graph.getView().clear(root, true, true);
    graph.getView().validate();
 }
 graph.refresh();
 graph.getModel().endUpdate(); 
```

当然，问题是细胞没有移动到指定的位置。可能是什么问题呢？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T07:59:03.260

您不需要刷新、清除或验证。如果您选择正确的操作，一切都会为您完成。值得完整阅读[用户手册的第 2 部分](http://jgraph.github.io/mxgraph/docs/manual_javavis.html)，它解释了核心模型 API 方法。

在这种情况下，您希望`model.setGeometry()`在`begin/end update`. 但请确保不要使用从 getGeometry 获得的几何对象，您必须使用新对象或从 getter 中复制的对象。就地更改模型对象会破坏撤消模型。

# c - 为什么下面的输出？

> ID：15966065
> 
> 赞同：-9
> 
> 时间：2013-04-12T08:01:14.197
> 
> 标签：c, visual-c++, gcc

我正在使用 gcc 并编写了一个小程序，如下所示：

```
#include<stdio.h>

void doing(){
    char buf[4096 + 1];
    printf("buf %d\n", buf);
    printf("buf %f\n", buf);
    printf("buf %d\n", (unsigned) buf);
    printf("buf %s\n", buf+2);
    printf("buf %d\n", buf+2);

}

int main (void){
    char buf[4096 + 1];
    printf("(unsigned) buf %d\n", (unsigned) buf);
    doing();
    printf("(unsigned) buf %d\n", (unsigned) buf);
    return 0;
} 
```

程序的输出是：

```
(unsigned) buf 2268303
buf 2264159
buf 0.000000
buf 2264159
buf
buf 2264161
(unsigned) buf 2268303 
```

我不知道为什么将 2268303 打印为整数以及这个 2268303 值来自哪里，一个函数将值作为 2268303 和另一个 2264159

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:09:10.070

请阅读 C 基础知识。你会得到你的答案。

关于，

> 一个函数给出的值为 2268303 和另一个 2264159

请注意，一个 char buf[] 在 main() 中声明，另一个在 do() 中。两者都有不同的存储空间，并且都将在各自的范围内工作。[读取 C 中的变量范围]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T09:19:56.020

让我们把它分解一下，看看我们可以对每一行代码说些什么，一个接一个：

```
int main (void){
    char buf[4096 + 1]; 
```

您声明一个`char[4097]`, 通常通过在`main`输入时调整堆栈指针来分配在堆栈上。数组的内容是不确定的。

```
 printf("(unsigned) buf %d\n", (unsigned) buf); 
```

数组类型的表达式，除非它是地址 ( `&`)`sizeof`或`_Alignof`运算符的操作数，或者是用于初始化字符数组的字符串文字，否则将转换为指向数组第一个元素的指针 (6.3.2.1 p. 3 )，所以这条线相当于

```
 printf("(unsigned) buf %d\n", (unsigned) &buf[0]); 
```

获取 中第一个字节的地址`buf`，将其转换为`unsigned`并将结果数字打印为有符号整数。请注意，如果结果`unsigned`值不能表示为`int`. 指针的转换`&buf[0]`是`unsigned`实现定义的，并且可能会调用未定义的行为（6.3.2.3 p. 6）。通常，`sizeof(unsigned)`指针值的字节被解释为无符号整数（通常包括指针的大小不小于 的大小`unsigned`）。在你的情况下，结果是

```
(unsigned) buf 2268303 
```

被打印出来了。下一个

```
 doing(); 
```

那么让我们看看`doing`：

```
void doing(){
    char buf[4096 + 1]; 
```

另一个`char[4097]`是声明的，通常是通过在`doing`进入时调整堆栈指针来分配的。这个数组的内容也是不确定的。

```
 printf("buf %d\n", buf); 
```

`buf`同样， type的表达式`char[4097]`被转换为 a `char*`，即`&buf[0]`，并且传递给`printf`which 需要一个`int`参数。类型不匹配会调用未定义的行为，通常`sizeof(int)`指针值的字节被解释为有符号整数。结果是输出

```
buf 2264159 
```

这强烈暗示`buf`in`doing`已分配 4144 字节远离`main`'s 并且堆栈向下增长。

```
 printf("buf %f\n", buf); 
```

我们再次进行了数组到指针的转换，现在`printf`需要一个`double`参数，但得到一个`char*`. 更多未定义的行为，表现是

```
buf 0.000000 
```

被打印。一般无法回答这个问题（毕竟，这是未定义的行为），在 64 位系统上，常见的行为是`printf`指针或整数类型的参数在通用寄存器中传递，浮点参数在浮点寄存器中，这样`printf`就可以读取一个浮点寄存器——它恰好包含一个 0 值。

```
 printf("buf %d\n", (unsigned) buf); 
```

此行与 的对应行具有相同的语义`main`，但由于它是不同的数组`buf`，因此转换得到的（无符号）整数是不同的。

```
buf 2264159 
```

它打印与第一个`printf`in相同`doing`，这并不奇怪（但不能保证，因为涉及未定义的行为）。

```
 printf("buf %s\n", buf+2); 
```

`buf`转换为`&buf[0]`，然后将 2 添加到其中，得到`&buf[2]`. 这被传递给`printf`，由于`%s`转换，它需要一个指向`char`作为参数的以 0 结尾的数组的指针。这是`printf`整个程序中唯一的调用，其中`printf`第二个参数的类型与转换说明符所期望的类型完全匹配。但是 的内容`buf`是不确定的，所以如果数组中没有 0 字节，就会导致`printf`. 然而，显然`buf[2]`是 0，所以只是

```
buf 
```

被打印出来了。

```
 printf("buf %d\n", buf+2); 
```

`buf + 2`再次评估为，并且在期望的`&buf[2]`地方传递。类型不匹配会调用未定义的行为，但输出`printf``int`

```
buf 2264161 
```

表明没有发生任何恶意事件，并且由于`&buf[2]`落后 两个字节`&buf[0]`，因此打印的数字比`doing`'s first中打印的数字大两个`printf`。

```
} 
```

返回`main`：

```
 printf("(unsigned) buf %d\n", (unsigned) buf); 
```

该行与第一个`printf`调用相同`main`，因此它具有相同的语义，如上所述，

```
(unsigned) buf 2268303 
```

并产生相同的输出。

```
 return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:09:09.310

如果您使用`%p`，您将获得`hex`价值。您还需要重新审视[范围](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=%2Fcom.ibm.xlcpp8l.doc%2Flanguage%2Fref%2Fzexscope_c.htm)。也通过[这些](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=%2Fcom.ibm.xlcpp8l.doc%2Flanguage%2Fref%2Faryin.htm) [链接](http://pw1.netcom.com/~tjensen/ptr/pointers.htm)。

```
(unsigned) buf 2268303 // You have defined this in main its a local array so it has                      
                       //2268303 as address. And for an array the array name acts as a 
                       //pointer too
buf 2264159            // You have defined this in fn doing, it is local to that function     
                       //and has a different address (it is a different array than the one 
                       //in your main) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T08:14:30.800

这是解释：

这：

```
printf("buf %d\n", buf); 
```

将打印“buf”数组中第一个元素的地址（内存位置）

这：

```
printf("buf %f\n", buf); 
```

将尝试从“buf”数组中第一个元素的地址读取浮点数，printf 可能返回零，因为它不知道如何处理它。

这：

```
printf("buf %d\n", (unsigned) buf); 
```

将与第一个 printf 执行相同的操作，因为“buf”的地址始终大于或等于零。

这：

```
printf("buf %s\n", buf+2); 
```

将尝试从“buf”数组中第一个元素的地址读取浮点数，printf 可能会返回一个空字符串，因为它不知道如何处理它。

最后：

```
printf("buf %d\n", buf+2); 
```

返回“buf”数组中第三个元素的位置

***需要注意的重要一点：*** 您声明的两个“buf”数组（一个在 main 中，另一个在 do() 中）是两个不同的数组，即使您给它们提供了相同的名称。在doing() 里面的“buf”指的是你在那里创建的那个，在main 里面的“buf”也指的是你在那里创建的那个。这就是为什么从内部做或主要打印时得到两个不同地址的原因

# php - html重定向后调用JQuery .load

> ID：15966068
> 
> 赞同：0
> 
> 时间：2013-04-12T08:01:31.020
> 
> 标签：php, javascript, jquery, html, redirect

我正在编写一个应用程序，我想通过减少导航所需的点击量来使用户更加友好。目前页面加载如下：

```
<a class='pageloader' name='page1.html'>Page 1</a>

<script>
    $('.pageloader').click(function(){
        // Load the page that the user clicked on by taking the name property and appending it to includes/
        $('.content').load("pages/" + this.name);
    });
</script> 
```

基本上，这采用点击链接的名称，并将内容 div 的内容替换为文件中与 name 属性匹配的任何内容。

现在我唯一的问题是我无法将人们重定向到使用 HTML 的页面，因为唯一具有正确样式的页面是 index.php。显然，我现在在操作完成后将人们重定向到 index.php，但我想将他们重定向到特定页面。

我想过打电话

```
$('.content').load('pages/edit-plein.php'); 
```

（此代码位于写入文件的 .php 脚本中）

但这只会给我一个错误，因为它找不到 .content div。

有人知道将用户重定向到我想要的页面的好方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:31:00.410

据我了解，当您共享指向您网站上特定子页面的链接时，您希望加载正确的内容（在该 div 内），但由于其样式只能共享您的 index.php 的链接。

我建议您在 URL 中添加一个变量，例如

```
index.php?page=edit-plein 
```

然后使用 PHP 获取该 var 并创建对页面加载器的 JS 调用，如下所示：

```
<?php
if ( $_GET['page'] != '' ) {
    echo '<script>$(".content").load("pages/'. $_GET['page'] .'");</script>';
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:40:33.893

这不是链接的好方法：

```
<a class='pageloader' name='page1.html'>Page 1</a> 
```

也许你可以试试这个：

```
<a href="javascript:void(0);" class="pageloader" id="page1">Page 1</a>
<a href="javascript:void(0);" class="pageloader" id="page2">Page 2</a> 
```

而JS必须是这样的：

```
$('.pageloader').click(function(){
  $('.content').load("pages/" + $(this).attr('id') + ".html");
}); 
```

我希望这能解决你的问题。

# lucene - 按字段之一的字符串长度对查询进行排序

> ID：15966077
> 
> 赞同：1
> 
> 时间：2013-04-12T08:01:55.073
> 
> 标签：lucene, ravendb, lucene.net

在 RavenDB（build 2330）中，我试图按索引项之一的字符串长度对结果进行排序。

```
var result = session.Query<Entity, IndexDefinition>()
                    .Where(condition)
                    .OrderBy(x => x.Token.Length); 
```

然而，结果看起来是未排序的。这在 RavenDB 中是否可行（或通过 Lucene 查询），如果可以，语法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T10:08:13.113

您需要向 IndexDefinition 添加一个字段以进行排序，并将[SortOption 定义](http://ravendb.net/docs/2.0/client-api/querying/static-indexes/customizing-results-order)为 Int 或更合适的内容（但是您不想使用默认的 String ）。

如果您想像在示例中一样使用 Linq API，则需要在索引的 Map 函数中添加一个名为 Token_Length 的字段（请参阅 Matt 的评论）：

```
from doc in docs
     select new
     {
         ...
         Token_Length = doc.TokenLength
     } 
```

然后您可以使用 Linq API 进行查询：

```
var result = session.Query<Entity, IndexDefinition>()
                    .Where(condition)
                    .OrderBy(x => x.Token.Length); 
```

或者，如果您真的希望将该字段称为 TokenLength（或 Token_Length 以外的其他名称），您可以使用 LuceneQuery：

```
from doc in docs
     select new 
     {
         ...
         TokenLength = doc.Token.Length
     } 
```

你会这样查询：

```
var result = session.Advanced.LuceneQuery<Entity, IndexDefinition>()
                    .Where(condition)
                    .OrderBy("TokenLength"); 
```

# mysql - 从 MySQL 表中的点计算质心

> ID：15966080
> 
> 赞同：2
> 
> 时间：2013-04-12T08:01:58.653
> 
> 标签：mysql, geospatial, centroid

在 MySQL 表中，我有一列“点”地理空间数据类型。是否可以直接在 MySQL 中计算所有行的所有点值的质心？

我的项目的目的是将地图的中心放在它包含的点的中心。

MySQL 文档中给出了一种可能的解决方案：[Centroid(mpoly)](http://dev.mysql.com/doc/refman/5.5/en/geometry-property-functions.html#function_centroid)。但这意味着我必须在外部用编程语言连接所有点的值，然后将结果查询发送回 MySQL。这对我来说听起来很古怪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-29T06:25:46.917

质心只是平均 X 和 Y 值的交集，因此以下应该有效：

```
SELECT
    POINT( AVG(X(geographic_location)), AVG(Y(geographic_location)) )
FROM poles 
```

# xquery - 如何在一个 XmlQuery 中进行两个转换操作？

> ID：15966082
> 
> 赞同：0
> 
> 时间：2013-04-12T08:02:03.200
> 
> 标签：xquery

有人可以给我举个例子，如何一个接一个地进行两个 XmlQuery 转换？我在数据库中有 XML 列，它包含两个子节点序列。我需要在两个序列中进行替换。两个序列都放置在同一嵌套级别上。

如果我进行两个 xmlquery 操作，它可以正常工作。但问题是我需要每行遍历我的表并进行更新。所以，我宁愿有 1 XmlQuery 不做两个更新周期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T11:55:40.677

我必须使用括号内的所有修改操作，用逗号分隔。

答案是 dropbox 上的修改 sql： [https ://dl.dropboxusercontent.com/u/39957296/xmlquery.sql](https://dl.dropboxusercontent.com/u/39957296/xmlquery.sql)

# facebook - 如何使用 Facebook Feed Dialog 添加多张图片

> ID：15966083
> 
> 赞同：1
> 
> 时间：2013-04-12T08:02:04.970
> 
> 标签：facebook, feed

Facebook Feed Dialog 对象的属性“picture”只允许一张图片的 url。

添加多个 meta og:image 不是诀窍。

使用已弃用的 sharer.php，可以选择使用 meta og:image 定义的多个图像。

是否可以使用 Facebook Feed Dialog 对象添加多个图像？

# jquery - 在鼠标悬停jquery上停止动画

> ID：15966085
> 
> 赞同：0
> 
> 时间：2013-04-12T08:02:21.810
> 
> 标签：jquery

如何在鼠标悬停时停止动画并在鼠标悬停时重新启动我尝试了以下代码，但它不起作用：

```
var containerheight = 0;
var numbercount = 0;
var liheight;
var index = 1;
function callticker() {
    jQuery("#news-container1 ul").animate({
        "margin-top": (-1) * (liheight * index)
    }

    , 2500);
    if (index != numbercount - 1) {
        index = index + 1;
    }
    else {
        index = 0;
    }
    timer = setTimeout("callticker()", 3600);
}       
jQuery(document).ready(function() {
var timer=null;
jQuery('#news-container1').height("42px");
jQuery('#news-container1').css("overflow","hidden");
    numbercount = jQuery("#news-container1 ul li").size();
    liheight = jQuery("#news-container1 ul li").outerHeight();
    containerheight = jQuery("#news-container1 ul  li").outerHeight() * numbercount;
    jQuery("#news-container1 ul").css("height", containerheight);
    timer = setTimeout("callticker()", 3600);   

jQuery("#news-container1 ul").mouseover(function(){
    clearTimeout(timer ); 

 }).mouseout(function(){
    timer = setTimeout("callticker()", 3600);   
 })

}); 
```

JSfiddle 链接[http://jsfiddle.net/3Y3qq/](http://jsfiddle.net/3Y3qq/)

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:19:40.333

尝试将全局变量放入`doc ready`并通过它`callticker()`：

```
function callticker(index, liheight, numbercount) {
    jQuery("#news-container1 ul").animate({
        "margin-top": (-1) * (liheight * index)
    }, 2500);
    if (index != numbercount - 1) {
        index = index + 1;
    } else {
        index = 0;
    }
    timer = setTimeout("callticker()", 3600);
}       
jQuery(document).ready(function() {
   var timer=null;
   var index = 1;
   var numbercount = jQuery("#news-container1 ul li").size();
   var liheight = jQuery("#news-container1 ul li").outerHeight();
   var containerheight = jQuery("#news-container1 ul  li").outerHeight() * numbercount;
        timer = setTimeout(function(){
                    callticker(index, liheight, numbercount);
                }, 3600);   
   jQuery("#news-container1 ul").css("height", containerheight);
   jQuery('#news-container1').height("42px");
   jQuery('#news-container1').css("overflow","hidden");

   jQuery("#news-container1 ul").mouseover(function(){
       clearTimeout(timer); 
    }).mouseout(function(){
       timer = setTimeout(function(){
                   callticker(index, liheight, numbercount);
               }, 3600);   
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:19:51.460

我认为您应该使用[mouseenter](http://api.jquery.com/mouseenter/)和[mouseleave](http://api.jquery.com/mouseleave/)方法：

```
jQuery(document).ready(function($) { //note the $

    $("#news-container1 ul").mouseenter(function(){
        clearTimeout(timer); 
        $("#news-container1 ul").stop(); //use this to stop the animation
     }).mouseleave(function(){
        timer = setTimeout("callticker()", 3600);   
     });

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:20:05.693

这将起作用：[链接](http://jsfiddle.net/3Y3qq/2/)

我做了什么：

改为`setTimeout("callticker()",3600)`_`setTimeout(callticker,3600)`

并将变量 timer 更改为超级全局变量，以便函数可以访问它。

```
var containerheight = 0,
    numbercount = 0,
    liheight,
    index = 1,
    timer = null;

function callticker() {
    jQuery("#news-container1 ul").animate({
        "margin-top": (-1) * (liheight * index)
    }

    , 2500);
    if (index != numbercount - 1) {
        index = index + 1;
    } else {
        index = 0;
    }
    timer = setTimeout(callticker, 3600);
}
jQuery(document).ready(function () {
    jQuery('#news-container1').height("42px");
    jQuery('#news-container1').css("overflow", "hidden");
    numbercount = jQuery("#news-container1 ul li").size();
    liheight = jQuery("#news-container1 ul li").outerHeight();
    containerheight = jQuery("#news-container1 ul  li").outerHeight() * numbercount;
    jQuery("#news-container1 ul").css("height", containerheight);
    timer = setTimeout(callticker, 3600);

    jQuery("#news-container1 ul").mouseover(function () {
        clearTimeout(timer);

    }).mouseout(function () {
        timer = setTimeout(callticker, 3600);
    })

}); 
```

# geolocation - 如何在桌面浏览器上准确定位用户当前的地理位置？

> ID：15966089
> 
> 赞同：2
> 
> 时间：2013-04-12T08:02:37.647
> 
> 标签：geolocation

Geolocation API 及其`getCurrentPosition`方法只能使用 WIFI 路由器信息和 IP 地址。在我所在的印度，IP 地址和位置之间似乎没有对应关系。

有时它显示我在浦那 - 有时在海得拉巴 - 但我在孟买。但是当我在我的移动设备上使用相同的 gMaps 应用程序时，它能够准确地对我的位置进行三角测量，这太棒了。

但是对于我正在构建的拼车应用程序，我需要用户使用他们的笔记本电脑和台式电脑自动注册并输入他们当前的位置。我该怎么做呢？

仅供参考：我在 Mac OSx 上使用 chrome

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T08:12:18.673

地理定位的准确度基本上有四个级别：

*   GPS，适用于带有 GPS 接收器的设备
*   GSM，用于连接到手机网络的移动设备
*   WiFi，适用于 WiFi 网络听力范围内的设备 - 注意，只有通过谷歌街景车辆或消费者通过真正的 GPS 接收器从设备中众包信息，对该区域进行了调查，才能保证准确度。
*   IP 地址 - ISP 被分配了许多块，并且通常按区域分配这些块。在 IP 范围稀缺的世界部分地区（即不在北美），您可以看到电话网络将连接到不同的本地集线器的位置。

听起来这是您仅在台式机上看到的最后一种情况，这意味着您附近的 WiFi 网络尚未经过足够的信心调查，因此地理定位无法正常工作。

# java - Java 构造函数基础：没有当前值的对象和字段

> ID：15966095
> 
> 赞同：0
> 
> 时间：2013-04-12T08:02:47.630
> 
> 标签：java, object, constructor, field

我有几个关于 Java 构造函数的问题：

1.  你应该如何初始化/创建类所依赖的对象？例如，我的“时间”类中有一个 DateTime 对象。我应该有一个`private DateTime _date;`字段作为类的一部分，然后坚持`_date = new DateTime();`在构造函数中吗？还是用相关方法初始化这个对象更好？

2.  如果在创建类的新对象时应该未初始化字段（即稍后在对象上调用类的方法时设置它们的值），您会怎么做？在构造函数中，我是否将它们初始化为 null 或一些无意义的值？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:05:28.637

从根本上说，这两个问题的答案都是：这取决于你。

1.  如果你这样做`private DateTime _date = new DateTime();`，这将作为实例构造的一部分发生，就好像它在构造函数中一样（它将在构造函数中的分步代码运行之前立即发生）。我在 JLS 中找不到直言不讳的说法（这并不意味着它不存在），但它会[在第 8 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.3.2)和/或[第 15](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.9)节中的某个地方。因此，无论是在声明中还是在构造函数中，都是您的调用。它的优点是，如果您有多个构造函数，则无论调用哪个构造函数都会发生；它的缺点是在多个地方都有施工规范。

2.  作为 Java 语言定义的一部分，根据它们的类型，它们被隐式初始化为`null`、`0`、`false`等（它们的“[默认值”）。](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.5)因此，如果您想要清晰、强调、可读性等等，您可以*显式地*将它们初始化为`null`等，但这不是必需的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:12:11.047

在回答您的第二个问题时，您可以`null`在构造函数中显式设置作为对象的字段。但是，这不是必需的，因为如果您不构造或创建对象，它将自动设置为`null`. 例如，

```
 Public class MyClass {
     private User user;

     public MyClass(){
         this.user; 
     }
 } 
```

上面的构造函数是一样的：

```
public MyClass(){
    this.user = null;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T08:16:20.777

构造函数的主要职责是确保实例的设置遵循类不变量（除非它抛出异常）。如果要求字段为非空，则不变量可能会更简单。一般来说，您要避免使用`null`. NPE**真的很**常见，而且不应该如此。

（我也强烈建议坚持标准的 Java 约定。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-12T08:21:54.897

1.  老实说：我总是以不同的方式处理它。有时我在声明时设置变量（如 TJ Crowder），有时在构造函数中，很少有构造`initDefaults()`函数调用的方法，pl
2.  我建议永远不要将字段初始化为无意义的值。阅读该字段时，您无法确定它是无意义的还是故意的。您应该为您的整个系统定义一个`null`值的含义或（如果您无法避免）一个特殊的“默认”值，以及方法如何返回值，例如*Robert Martin*建议宁愿返回一个空数组而不是`null`一个空列表（这样你就可以避免 NPE）。

祝你好运 ：-）

# javascript - 我的下拉列表中的错误

> ID：15966101
> 
> 赞同：0
> 
> 时间：2013-04-12T08:03:12.087
> 
> 标签：javascript, option, onchange

得到一个错误，但不知道什么是错的。

```
HTMLCode += "<option value='" + m + "' onchange=\"window.open('availability.jsp?month=" + m + "\>" + maand[m].toString() + "</option>"; 
```

错误：非法转义字符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:05:09.653

MONTH)) + "\ >" + maand 我相信你这里有一个不需要的空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:05:20.203

您必须在这部分代码中用另一个 \ 转义 \

```
today.get(Calendar.MONTH)) + "\ >" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:10:38.353

您在`window.open`函数中丢失了右引号和右括号：

```
HTMLCode += "<option value='" + m + "' onchange=\"window.open('availability.jsp?month=" + m + "')\>" + maand[m].toString() + "</option>"; 
```

# android - 向onactivityresult android传递或接收参数

> ID：15966102
> 
> 赞同：2
> 
> 时间：2013-04-12T08:03:13.533
> 
> 标签：android, android-activity, android-camera-intent

我有一个相机应用程序，带有多个相机按钮。代码如下。

```
class btnTakePhotoClicker implements Button.OnClickListener
{       
    int k;
    public btnTakePhotoClicker(int k) {
        this.k = k;
    }

    @Override
    public void onClick(View v) {   
        capture_img = (ImageButton)view.get(k).findViewById(R.id.clickme);
        capture_img.setClickable(false);
        Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
        startActivityForResult(cameraIntent, CAMERA_PIC_REQUEST);
    }
}

@Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);                      
        if (requestCode == CAMERA_PIC_REQUEST) {
            capture_img = (ImageButton)view.get(cameraIndex[idx]).findViewById(R.id.clickme);
            Bitmap thumbnail = (Bitmap) data.getExtras().get("data");                                   
            capture_img.setImageBitmap(thumbnail);          
        }
    } 
```

现在我想将索引 k 传递给 onactivityResult。请指导如何做同样的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:05:34.190

从您的内部课程`int k`转到您的活动课程。然后在`btnTakePhotoClicker`使用`YourActivity.this.k = k`

# ios - iOS 中的 If-Modified-Since 请求

> ID：15966106
> 
> 赞同：2
> 
> 时间：2013-04-12T08:03:28.550
> 
> 标签：ios, get, synchronization

我尝试将本地数据与服务器同步。是否可以在 IOS 中使用获取“if-Modified-Since”请求？

```
If-Modified-Since = "If-Modified-Since" ":" HTTP-date 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T08:05:36.943

您可以使用以下命令设置 HTTP 字段`NSMutableURLRequest`：

```
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
[request setValue:@"Your string" forHTTPHeaderField:@"If-Modified-Since"];
// ... 
```

然后您可以检查响应的状态代码并专门查找`304`（未修改）。

# perl - 使用 Perl 在同一个 CSV 文件中合并 CSV 中的 3 列

> ID：15966111
> 
> 赞同：0
> 
> 时间：2013-04-12T08:03:38.167
> 
> 标签：perl, csv

*我在CSV*文件中有以下 3 列，我想使用*Perl*脚本将它们合并到第一列本身。

第 1 列：32：
第 2 列：注释
第 3 列：测试

输出应在第 1 列中为：
32:annotate test

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:15:40.227

[Text::CSV_XS](https://metacpan.org/module/Text%3a%3aCSV_XS)在我看来是要走的路。比任何基于 、regexp 等的自制解决方案更不容易出错`split`，速度快，而且它的界面应该使您的问题的解决方案变得微不足道。

# algorithm - 元素构成连续序列的最长子数组

> ID：15966113
> 
> 赞同：17
> 
> 时间：2013-04-12T08:03:41.677
> 
> 标签：algorithm

给定一个未排序的正整数数组，求排序后元素连续的最长子数组的长度。你能想到一个 O(n) 的解决方案吗？

例子：

{10, 5, 3, 1, 4, 2, 8, 7}，答案是 5。

{4, 5, 1, 5, 7, 6, 8, 4, 1}，答案是 5。

对于第一个例子，子数组{5, 3, 1, 4, 2}在排序后可以形成一个最长的连续序列1,2,3,4,5。

对于第二个示例，子数组 {5, 7, 6, 8, 4} 是结果子数组。

我可以想到一种方法，对于每个子数组，检查 (maximum - minimum + 1) 是否等于该子数组的长度，如果为真，则它是一个连续子数组。取最长的。但它是 O(n^2) 并且不能处理重复。

有人可以提供更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T12:24:01.427

**解决 O(n) 中没有重复**的原始问题的算法。也许，它可以帮助某人开发处理重复的 O(n) 解决方案。

输入：[a1, a2, a3, ...]

将原始数组映射为对，其中第一个元素是一个值，第二个元素是数组的索引。

数组：[[a1, i1], [a2, i2], [a3, i3], ...]

使用一些 O(n) 算法（例如计数排序）对这个对数组进行排序，以便*按值*进行整数排序。我们得到另一个数组：

数组：[[a3, i3], [a2, i2], [a1, i1], ...]

其中 a3, a2, a1, ... 按排序顺序排列。

通过对的排序数组运行循环

在线性时间内，我们可以检测到连续的数字组 a3、a2、a1。连续的组定义是下一个值 = 上一个值 + 1。在该扫描期间，保持当前组大小 ( **n** )、索引的最小值 ( **min** ) 和索引的当前总和 ( **actualSum** )。

在连续组内的每个步骤上，我们可以估计索引的总和，因为它们创建了具有第一个元素**min**、 step **1**和到目前为止看到的组大小**n**的算术级数。这个总和估计可以使用算术级数公式在 O(1) 时间内完成：

估计总和 = (a1 + an) * n / 2;

估计总和 = (min + min + (n - 1)) * n / 2;

估计总和 = min * n + n * (n - 1) / 2；

如果在连续组内的某个循环步骤上估计总和等于实际总和，则到目前为止看到的连续组满足条件。**将n**保存为当前最大值结果，或在当前最大值和**n**之间选择最大值。

如果在值元素上我们不再看到连续组，则重置所有值并执行相同操作。

代码示例：[https ://gist.github.com/mishadoff/5371821](https://gist.github.com/mishadoff/5371821)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-01T14:32:22.800

这将需要对数据进行两次传递。首先创建一个哈希映射，将整数映射到布尔值。我更新了我的算法以不使用来自 STL 的地图，我很肯定它在内部使用排序。该算法使用散列，并且可以轻松更新任何最大或最小组合，甚至可能是整数可以获得的所有可能值。

```
#include <iostream>

using namespace std;
const int MINIMUM = 0;
const int MAXIMUM = 100;
const unsigned int ARRAY_SIZE = MAXIMUM - MINIMUM;

int main() {

bool* hashOfIntegers = new bool[ARRAY_SIZE];
//const int someArrayOfIntegers[] = {10, 9, 8, 6, 5, 3, 1, 4, 2, 8, 7};
//const int someArrayOfIntegers[] = {10, 6, 5, 3, 1, 4, 2, 8, 7};
const int someArrayOfIntegers[] = {-2, -3, 8, 6, 12, 14,  4, 0, 16, 18, 20};
const int SIZE_OF_ARRAY = 11;

//Initialize hashOfIntegers values to false, probably unnecessary but good practice.
for(unsigned int i = 0; i < ARRAY_SIZE; i++) {
    hashOfIntegers[i] = false;
}

//Chage appropriate values to true.
for(int i = 0; i < SIZE_OF_ARRAY; i++) {
    //We subtract the MINIMUM value to normalize the MINIMUM value to a zero index for negative numbers.
    hashOfIntegers[someArrayOfIntegers[i] - MINIMUM] = true;
}

int sequence = 0;
int maxSequence = 0;
//Find the maximum sequence in the values
for(unsigned int i = 0; i < ARRAY_SIZE; i++) {

    if(hashOfIntegers[i]) sequence++;
    else sequence = 0;

    if(sequence > maxSequence) maxSequence = sequence;
}

cout << "MAX SEQUENCE: " << maxSequence << endl;
return 0;
} 
```

基本思想是将哈希映射用作桶排序，这样您只需对数据进行两次传递。这个算法是 O(2n)，而这又是 O(n)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T12:53:14.130

在它的数学集合定义中查看数组*S ：*

> *S* = U [j = 0] ^k (*我[j]* )

其中*I [j]*是不相交的整数段。您可以设计一个特定的区间树（基于您喜欢的红黑树或自平衡树:)）以将数组存储在此数学定义中。节点和树结构应如下所示：

```
struct node {
    int d, u;
    int count;
    struct node *n_left, *n_right;
} 
```

这里，d 是整数段的下界，u 是上界。添加以处理数组中可能的重复项：当尝试在树中插入一个已经存在的元素时，我们将增加找到它的节点`count`的值，而不是什么都不做。`count`

```
struct root {
    struct node *root;
} 
```

树只会存储**不相交**的节点，因此，插入比经典的红黑树插入要复杂一些。插入间隔时，您必须扫描现有间隔的潜在溢出。在您的情况下，由于您只会插入单例，因此不应增加太多开销。

给定三个节点 P、L 和 R，L 是 P 的左孩子，R 是 P 的右孩子。然后，您必须强制 Lu < Pd 和 Pu < Rd（当然，对于每个节点，d <= u） .

插入整数段 [x,y] 时，必须找到“重叠”段，即满足以下不等式之一的区间 [u,d]：

> y >= d - 1
> 或
> x <= u + 1

如果插入的区间是单例`x`，那么您最多只能找到 2 个重叠区间节点 N1 和 N2 使得`N1.d == x + 1`和`N2.u == x - 1`。然后你必须合并这两个区间并更新计数，这样你就可以得到 N3 `N3.d = N2.d`，`N3.u = N1.u`和`N3.count = N1.count + N2.count + 1`。由于 和 之间`N1.d`的`N2.u`增量是两个分段不相交的最小增量，因此您**必须**具有以下条件之一：

*   N1 是 N2 的右孩子
*   N2 是 N1 的左孩子

所以插入仍然会在`O(log(n))`最坏的情况下。

从这里开始，我无法弄清楚如何处理初始序列中的顺序，但这里有一个可能很有趣的结果：如果输入数组定义了一个*完美*的整数段，那么树只有一个节点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-12T12:00:50.373

**UPD2：**以下解决方案是针对不需要子数组连续的问题。我误解了问题陈述。不删除这个，因为有人可能有一个基于我的想法，可以解决实际问题。

* * *

这是我想出的：

创建一个字典的实例（它被实现为哈希表，在正常情况下给出 O(1)）。键是整数，值是整数的哈希集（也是 O(1)） - `var D = new Dictionary<int, HashSet<int>>`。

遍历数组`A`并为每个`n`带有索引的整数`i`做：

1.  检查键`n-1`和`n+1`是否包含在`D`.
    *   如果两个键都不存在，请执行`D.Add(n, new HashSet<int>)`
    *   如果只有一个键存在，例如`n-1`，做`D.Add(n, D[n-1])`
    *   如果两个键都存在，请执行`D[n-1].UnionWith(D[n+1]); D[n+1] = D[n] = D[n-1];`
2.  `D[n].Add(n)`

现在遍历每个键`D`并找到具有最大长度的哈希集（查找长度为 O(1)）。最大的长度将是答案。

据我了解，*最坏情况*的复杂性将是 O(n*log(n))，这仅仅是因为`UnionWith`操作。我不知道如何计算平均复杂度，但它应该接近 O(n)。如果我错了，请纠正我。

**UPD：**要说代码，这是 C# 中的测试实现，它在 OP 的两个示例中都给出了正确的结果：

```
var A = new int[] {4, 5, 1, 5, 7, 6, 8, 4, 1};
var D = new Dictionary<int, HashSet<int>>();

foreach(int n in A)
{
    if(D.ContainsKey(n-1) && D.ContainsKey(n+1))
    {
        D[n-1].UnionWith(D[n+1]);
        D[n+1] = D[n] = D[n-1];
    }
    else if(D.ContainsKey(n-1))
    {
        D[n] = D[n-1];
    }
    else if(D.ContainsKey(n+1))
    {
        D[n] = D[n+1];
    }
    else if(!D.ContainsKey(n))
    {
        D.Add(n, new HashSet<int>());
    }

    D[n].Add(n);
}

int result = int.MinValue;
foreach(HashSet<int> H in D.Values)
{
    if(H.Count > result)
    {
        result = H.Count;
    }
}

Console.WriteLine(result); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-12T11:59:32.647

不要抱太大希望，这只是部分答案。

我很有信心这个问题在`O(n)`. 不幸的是，我无法证明这一点。

**如果**有办法在小于的时间内解决它`O(n^2)`，我怀疑该解决方案基于以下策略：

1.  确定`O(n)`（或者可能`O(n log n)`）是否*存在*一个连续的子数组，正如你用至少`i`元素描述的那样。让我们称之为谓词`E(i)`。
2.  `i`使用二分法来找到`E(i)`保持的最大值。

该算法的总运行时间将是`O(n log n)`（或`O(n log^2 n)`）。

这是我能想出的将问题简化为另一个问题的唯一方法，该问题至少有可能比原始公式更简单。但是，我找不到`E(i)`在小于的时间内计算的方法`O(n^2)`，所以我可能完全离开了......

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-05-01T05:47:24.300

这是考虑问题的另一种方式：假设您有一个仅由 1 和 0 组成的数组，您想找到最长连续运行的 1。这可以通过对 1 进行游程编码（忽略 0）在线性时间内完成。为了将您的原始问题转换为这个新的运行长度编码问题，您需要计算一个新数组 b[i] = (a[i] < a[i+1])。这不必显式地完成，您可以隐式地完成它以实现具有恒定内存需求和线性复杂度的算法。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2013-04-12T11:54:31.667

## 以下是 3 个可接受的解决方案：

第一个`O(nlog(n))`在时间和`O(n)`空间上，第二个`O(n)`在时间和`O(n)`空间上，第三个`O(n)`在时间和`O(1)`空间上。

1.  构建一个`binary search tree`然后[按顺序](http://en.wikipedia.org/wiki/Tree_traversal#In-order)遍历它。
    保留 2 个指针，一个用于最大子集的开始，一个用于结束。`max_size`在迭代树时保持值。这是一个`O(n*log(n))`时间和空间的复杂性。

2.  您始终可以在线性时间内对使用[计数排序](https://stackoverflow.com/questions/749585/sorting-in-linear-time)设置的数字进行排序并遍历数组，这意味着`O(n)`时间和空间复杂度。

3.  假设没有溢出或大整数数据类型。假设数组是一个数学集（没有重复值）。您可以在`O(1)`内存中执行此操作：

    *   计算数组的总和和数组的乘积
    *   假设您拥有原始集合的最小值和最大值，请找出其中的数字。完全是`O(n)`时间复杂度。

# javascript - 如何将样式元素添加到 div 并使用 javascript 将其删除

> ID：15966118
> 
> 赞同：0
> 
> 时间：2013-04-12T08:04:04.653
> 
> 标签：javascript, jquery

当用户单击按钮触发事件时，我想向 div 元素添加 margin-left css 样式，然后在用户再次单击按钮时将其删除。

这是 div 元素：

```
<div id="container" class="content"> 
```

Javascript 应将其更改为：

```
<div id="container" class="content" style="margin-left:354px"> 
```

理想情况下使用动画，使其看起来向左滑动而不是跳跃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:06:39.703

在事件监听器中试试这个：

```
var cont = document.getElementById("container");
cont.style.marginLeft = cont.style.marginLeft === "354px" ? "auto" "354px"; 
```

这不会对其进行动画处理。您可以考虑为此使用 CSS：

```
#container {
    transition: margin-left ease 500ms;
} 
```

但是，如果您想支持旧版浏览器和 IE9，请选择 soyuka 的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:12:53.450

试试这个解决方案我刚刚进入 JSBin：http: [//jsbin.com/oyemen/1/edit](http://jsbin.com/oyemen/1/edit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:07:01.303

在发布这样的问题之前，您应该阅读[手册...](http://api.jquery.com/animate)

```
$('.content').animate({'margin-left':'354px'}, 1000); 
//where 1000 is the animation time in ms 
```

回滚：

```
$('.content').animate({'margin-left':'auto'}); //or your previous value 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-12T08:09:50.093

您可以[`jQuery.animate`](http://api.jquery.com/animate/)与`margin-left`css 属性一起使用。的第二个参数`animate`是持续时间（以毫秒为单位）。还有许多其他设置可以更好地控制动画（例如，缓入或缓出）。

```
$('#container').animate({'margin-left':'354px'},3000); 
```

并将其移回相反的方向

```
$('#container').animate({'margin-left':'0px'},3000); 
```

现场示例：http: [//jsfiddle.net/xdpCs/1/](http://jsfiddle.net/xdpCs/1/)

# php - 梨 PHPunit 不适用于 netbeans 7

> ID：15966124
> 
> 赞同：0
> 
> 时间：2013-04-12T08:04:18.063
> 
> 标签：php, netbeans, phpunit, pear, netbeans-7

我已经从 pear 安装了骨架生成器和 phpunit，并且已经在 netbeans 设置中指向了它们的批处理文件。但是如果我尝试创建 phpunit test 它会显示以下错误。似乎找不到某个文件。但是当我安装它时，它安装得很好。如何修复它以便 phpunit 可以与 netbeans php 一起使用？

> PHP 警告：require_once(ezc/Base/base.php)：无法打开流：E:\wamp\bin\php\php5.4.3\pear\SebastianBergmann\PHPUnit\SkeletonGenerator\autoload.php 中没有这样的文件或目录第 49 行 PHP 堆栈跟踪： PHP 1\. {main}() E:\wamp\bin\php\php5.4.3\phpunit-skelgen:0 PHP 2\. require() E:\wamp\bin\php\php5.4.3 \phpunit-skelgen:41 PHP 致命错误：require_once(): 无法在 E 中打开所需的 'ezc/Base/base.php' (include_path='.;E:\wamp\bin\php\php5.4.3\pear') :\wamp\bin\php\php5.4.3\pear\SebastianBergmann\PHPUnit\SkeletonGenerator\autoload.php 在第 49 行 PHP 堆栈跟踪：PHP 1\. {main}() E:\wamp\bin\php\php5.4.3 \phpunit-skelgen:0 PHP 2.require() E:\wamp\bin\php\php5.4.3\phpunit-skelgen:41

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T09:27:42.220

您的代码似乎依赖或使用 EZ 组件。

您还需要通过 PEAR 安装 ezComponents。

# objective-c - 页面滑动时的ECSlidingViewController resignFirstResponder

> ID：15966133
> 
> 赞同：1
> 
> 时间：2013-04-12T08:05:12.760
> 
> 标签：objective-c, xcode, resignfirstresponder, ecslidingviewcontroller

`resignFirstResponder`当页面滑动时我需要`ECSlidingViewController`.

如果我使用`UIPanGestureRecognizer`它。那是覆盖`ECSlidingViewController`和使用后不能滑动页面。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-10T22:32:26.423

您无需更改现有代码。相反，您应该观察 使用的通知名称之一`ECSlidingViewController`，例如`ECSlidingViewUnderLeftWillAppear`。要注册，请在视图控制器的初始化中执行以下操作：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(slidingViewUnderLeftWillAppear:) name:ECSlidingViewUnderLeftWillAppear object:nil]; 
```

然后，实现一个像这样的方法：

```
- (void)slidingViewUnderLeftWillAppear:(NSNotification *)notification {
    [self.view endEditing:YES];
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:05:12.760

我自己也找到了办法。可能有人像我一样需要它。

这就是解决方案：

在 ECSlidingViewController.m 文件中找到该行

```
-(void)updateTopViewHorizontalCenterWithRecognizer:(UIPanGestureRecognizer *)
recognizer 
```

并添加该行

```
[self.view endEditing:TRUE]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-02T05:25:40.563

如果有人使用“SWRevealViewController”，您可以添加

```
[self.view endEditing:YES]; 
```

在下面

*   (void)revealToggleAnimated:(BOOL)动画

它会像一种享受一样工作！

# php - 简单的 MySQL SELECT 失败，错误 1054 Unknown Column

> ID：15966137
> 
> 赞同：3
> 
> 时间：2013-04-12T08:05:14.643
> 
> 标签：php, mysql, select

我对这个问题进行了研究，到目前为止，我在 MySQL 手册、MySQL 错误报告、Stack Overflow 或其他论坛中读到的任何内容都没有帮助。

我有一个简单的 mysql 选择查询：

```
SELECT * FROM `Toyota` WHERE `Toyota`.`CollisionEstimatingID` = '22028589'; 
```

此查询失败，mysql 错误代码 1054

> 子句`Toyota.CollisionEstimatingID`中的未知列`WHERE`

此列确实存在，我已经检查了数据库、表和列的拼写至少 30 次。我什至删除了我的数据库并重新导入。我试过用反引号和不带反引号，有别名和没有别名'我试过用显式命名的 table.column 语法，没有显式语法，我试过混合和匹配我所有的东西提到（表上的反引号，而不是列上的反引号，列上的但不是表名），似乎没有任何效果。当我从 Ubuntu 12.04 上的 mysql CLI 执行它时它失败了，它从我的 PHP 5.3 代码中失败了，它在 phpMyAdmin 内部失败了。我准备翻转桌子。

当我尝试这个时：

```
SELECT * FROM `Toyota`; 
```

这工作没有任何问题？天哪，MySQL真是个逗比……

这是源自于的表设置`show create database Toyota;`

```
CREATE TABLE `Toyota` (
  `CollisionEstimatingID` varchar(255) DEFAULT NULL,
  `OE_part_number` varchar(255) DEFAULT NULL,
  `Price` varchar(255) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1 
```

一个有趣的注释——我想知道它是否可能是字符编码问题？`show create table Toyota`通过使用并删除除“CollisionEstimatingID”之外的所有内容，我确实让它在 phpMyAdmin 中工作一次，并使用它来形成 SELECT 语句。但是当我尝试剪切和粘贴时，没有骰子。

我尝试使用 utf8 字符集重新创建数据库和表，看看是否有帮助，但没有帮助。我尝试将文本从 phpMyAdmin 窗口复制到我的源代码中——在列名的开头产生了一些时髦的字符——有点像这样：`>>?CollisionEstimatingID`只是它是一个带有变音符号的“i”+一个双右 V 形和一个颠倒的问号。

我难住了。有人想测试他们的编程勇气并帮助兄弟吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:50:05.740

像“ï»¿”？

这是 UTF-8 BOM (en.wikipedia.org/wiki/Byte_order_mark)。

您可能需要先清理输入文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:56:06.563

您的代码没有任何问题，因为我已经对我的 SQL Server 进行了一些测试。可以试试这个

```
SELECT * FROM Toyota WHERE Toyota.CollisionEstimatingID = '22028589' 
```

# joomla3.0 - Joomla Extension Komento 安装不创建数据库表

> ID：15966138
> 
> 赞同：0
> 
> 时间：2013-04-12T08:05:15.457
> 
> 标签：joomla3.0

我正在尝试安装一个名为[Komento](http://stackideas.com/docs/komento.html)的 Joomla 3.0 插件。当我转到 Extensions->Extension Manager->Upload Package File 并从上传包文件选项卡（对于 Joomla 2.5-3.0）中选择扩展名时，它会给出错误

```
An error has occurred.
SQL=SHOW FIELDS FROM `komento_activities` 
```

我的数据库中不存在表 komento_activities。看起来好像它正在尝试创建它，但不能。我在日志中看不到任何错误。扩展网站不提供针对此问题的任何故障排除。

有没有人有任何故障排除建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T10:09:15.833

您是否联系过他们的客户支持并向他们发送了一张票？我有他们的经验，他们非常友好和乐于助人。

看起来 Joomla 在您的网站上创建表格时遇到了权限问题，您绝对应该在他们的官方页面上联系他们的客户支持。

# php - Symfony 2.1 - 在控制器中切换 Monolog 通道

> ID：15966140
> 
> 赞同：10
> 
> 时间：2013-04-12T08:05:23.487
> 
> 标签：php, logging, symfony-2.1, monolog

我想登录到与通常的 dev.log 或 prod.log 不同的文件

我知道这可以通过不同的通道来完成，并且我在多个服务中使用了它，但是我不太清楚在控制器中切换 Monolog 通道。

在服务中，您只需通过服务定义中的属性定义通道`tags`，但是如何在控制器中执行此操作，或者在特定操作中更好地执行此操作？

我知道一个可能的解决方案是：[Symfony 2 : Log into a specific file](https://stackoverflow.com/questions/8241528/symfony-2-log-into-a-specific-file)

但是定义两个新服务只是为了记录到自定义文件似乎有点过头了。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-12T08:28:34.560

做到这一点的唯一方法是将[控制器定义为服务](http://symfony.com/doc/current/cookbook/controller/service.html)并注入带有自定义通道的自定义记录器。

由于通道是自动创建的，目前没有其他方法，但这是一个有趣的请求，您不是第一个，所以我[在 MonologBu​​ndle 上创建了一个问题，](https://github.com/symfony/MonologBundle/issues/39)以允许在捆绑配置级别定义通道。这样，您可以使用从控制器中获取正确的记录器`$this->get('monolog.logger.mychannel')`（如果通道存在，您已经可以这样做，但如果您想要控制器的自定义通道而没有其他用途）。

**更新：**

从 symfony/monolog-bundle 2.4.0 开始，您可以将其他通道定义为：

```
monolog:
    channels: ["foo", "bar"] 
```

然后您可以将其检索为`$this->get('monolog.logger.mychannel')`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-02-06T19:12:13.503

我知道这是一篇较旧的帖子，但我在使用 symfony/monolog-bundle 2.1.x 时遇到了类似的需求。我似乎无法在其他线程中准确找到我需要的东西，所以我在这里记录我的解决方案，即创建一个使用自定义通道的记录器容器。

在 config.yml

```
monolog:
    handlers:
        user_actions:
            type: stream 
            path:  "%kernel.logs_dir%/%kernel.environment%-user-actions.log"
            level: info 
            channels: [user_actions] 
```

在我的包的 services.yml

```
acme.logger.user_actions:
    class: Acme\MyBundle\Monolog\UserActionsLogger
    arguments: ['@logger']
    tags:
        - { name: monolog.logger, channel: user_actions } 
```

在 src/Acme/MyBundle/Monolog/UserActionsLogger.php

```
<?php

namespace Acme\MyBundle\Monolog;

class UserActionsLogger
{
    public $logger;

    public function __construct($logger)
    {
        $this->logger = $logger;
    }
} 
```

然后，您可以将记录器容器注入另一个服务：

```
acme.user.authenticationhandler:
    class: %acme.user.authenticationhandler.class%
    public: false
    arguments:  ['@router', '@security.context', '@acme.logger.user_actions'] 
```

或者，您可以有选择地将记录器容器用作任何控制器中的服务：

```
$userActionsLogger = $this->get('acme.logger.user_actions'); 
```

然后您可以通过以下方式访问实际的记录器：

```
$userActionsLogger->logger->info('A thing happened!') 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-23T10:06:42.373

我目前正在使用 symfony/monolog-bundle 2.3.0 并且以下代码有效。

配置在`config.yml`

```
monolog:
    handlers:
        main:
            type:  stream
            path:  %kernel.logs_dir%/%kernel.environment%.log
            level: info
        doctrine:
            type:  stream
            path:  %kernel.logs_dir%/doctrine_%kernel.environment%.log
            level: debug
            channels: doctrine 
```

在控制器上

```
$doctrineLogger = $this->get('monolog.logger.doctrine'); 
```

希望能帮助到你。

# wso2 - 在自定义类调解器中获取属性的值

> ID：15966144
> 
> 赞同：0
> 
> 时间：2013-04-12T08:05:29.737
> 
> 标签：wso2, wso2esb

我正在创建一个代理，在其中我正在创建一个使用 x-path 表达式从请求正文中获取数据的属性。我写的属性是：

```
<property xmlns:xs="http://www.openoandm.org/xml/ISBM/" name="ChannelURI" expression="//xs:ChannelURI" scope="default" type="STRING"/> 
```

现在我已经调用了一个类中介，我将这个属性的值传递给它。所以在我的班级调解员中，我写了

```
public String channelUriFromProp = String.valueOf(context.getProperty("ChannelURI")); 
```

所以现在如果我将任何字符串值传递给 ChannelURI 属性，我可以在我的类中介字符串 channelUriFromProp 中获取该值。

但真正的问题是，当我从请求中传递空值时

```
<body>
 <p:OpenPublicationSession xmlns:p="http://www.openoandm.org/xml/ISBM/">
  <!--Exactly 1 occurrence-->
  <xs:ChannelURI xmlns:xs="http://www.openoandm.org/xml/ISBM/"></xs:ChannelURI>
 </p:OpenPublicationSession>
</body> 
```

然后当我在类中介代码中打印 channelUriFromProp 的值时，我得到

```
<xs:ChannelURI xmlns:xs="http://www.openoandm.org/xml/ISBM/"/> 
```

而不是得到 null 或空。我在这里做错了什么？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:26:41.847

你的xpath错了，应该是这样的..

```
<property xmlns:xs="http://www.openoandm.org/xml/ISBM/"  xmlns:p="XXXXXXXXX"  name="ChannelURI" expression="//p:OpenPublicationSession/xs:ChannelURI" 
```

# java - 为什么 ErrorCollector 在声明的时候要求赋值？

> ID：15966146
> 
> 赞同：2
> 
> 时间：2013-04-12T08:05:32.080
> 
> 标签：java, junit, errorcollector

检查许多 XML 字符串，我经常使用 ErrorCollector 构造。但我仍然不明白它是如何工作的。

当我声明一个 ErrorCollector 时，我必须立即分配它：

```
@Rule
public ErrorCollector collector= new ErrorCollector(); 
```

如果我想在每次测试之前刷新收集器，我正在分配一个作业

```
collector= new ErrorCollector(); 
```

在@Before 方法中。但是因此声明处的第一个赋值是多余的。但我无法删除它。

这个必须分配的任务是什么意思？它是如何工作的？我想，@Rule 只是关于声明？

@Matthew Farwell 在[什么是 Groovy 类中 @Rule(JUnit) 声明和赋值的逻辑](https://stackoverflow.com/questions/15943145/what-is-the-logic-of-rulejunit-declaration-and-assignment-in-a-groovy-class/15950781?noredirect=1#15950781)说“在 Java 中，JUnit 运行器检查 @Rule 注释是否应用于公共非静态字段或公共非静态方法它返回一个 TestRule 或 MethodRule。” 但是这里检查的不是声明，而是分配，它是在构建和测试构建之后发生的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T10:25:36.593

与 JUnit 中的 most / all 一样`@Rule`，它们在每个测试之前`refreshed`或之前自动进行。`cleared`因此，您只需将其声明为`@Rule`上面列出的 a 即可。`@Before`你不需要在你的方法中对它做任何事情。我们的想法是，JUnit 将`ErrorCollector`在每次测试之前和之后调用。在每次测试之前，`ErrorCollector`可以初始化自身（清除任何先前存储的错误）。每次测试后，如果收集到错误，它会报告错误。

这是[ErrorCollector的来源](http://javasourcecode.org/html/open-source/junit/junit-4.10/org/junit/rules/ErrorCollector.java.html)

来自评论：

必须分配它，因为 JUnit 必须具有要使用的规则的实例。否则该对象将为空。请记住，JUnit 代码使用反射来获取带有 @Rule 注释的 Object 实例，并使用 instanceof 来确定它是 TestRule 还是 MethodRule。我相信 @Before 方法是在 Statement 中调用的，因此在调用 Rule 之后

从马修法威尔：

当您运行 JUnit 测试时，例如 FooTest，运行程序将为每个测试方法创建一个 FooTest 实例。因此，如果您使用 public ErrorCollector collector= new ErrorCollector(); 如上所述，那么每个测试方法都会自然地重新实例化一次。

结论：确保不要在测试之间保存状态！当然，无论如何您都不应该这样做，因为不能保证订单。

谢谢马特！

# php - 用 htaccess 重写 URI 到相关的 PHP 文件

> ID：15966154
> 
> 赞同：0
> 
> 时间：2013-04-12T08:06:18.453
> 
> 标签：php, .htaccess

我有一个这样的URI：

```
http://my.domain.com/clientarea/verify/ 
```

我希望它重写这个：

```
http://my.domain.com/verify.php 
```

我的意思是当第一个 URi 被调用时，它会在根路径显示 verify.php 的结果。

有谁知道我该怎么做？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T13:42:39.280

在后面添加这个`RewriteEngine on`：

```
RewriteRule ^clientarea/verify/$ /verify.php 
```

# jquery - 选择下拉框选项时交换类

> ID：15966155
> 
> 赞同：0
> 
> 时间：2013-04-12T08:06:19.523
> 
> 标签：jquery, css, class, drop-down-menu

我有一个下拉框，其中包含“垂直”和“水平”选项。

```
<select class="nav-select">
    <option id="one" value="1">Vertical</option>
    <option id="two" value="2">Horizontal</option>
</select> 
```

当从下拉框中选择一个选项时，我希望它将类“body-wrap Horizo​​ntal-nav”更改为“body-wrap vertical-nav”。

```
<div class="body-wrap vertical-nav"> 
```

到目前为止，我已经编写了一些 jQuery，但似乎无法让它工作。有人可以告诉我哪里出错了吗？

```
$(document).ready(function () {

    if ($('.nav-select option').hasId("two")) {
        $("body div").addClass('body-wrap horizontal-nav');       
    } 
    else if ($('.nav-select option').hasId("one") {
        $("body div").addClass('body-wrap vertical-nav');
    }

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:11:51.473

我不认为`hasID()`是一个真正的 jQuery 函数。

无论如何，即使是这样，那也是错误的方法：您只检查一次， on `$(document).ready()`。您应该在每次选择更改时检查，可能是这样的：

```
$('.nav-select').change(function() {
  if ($(this).val() == 1) {
    $('div.body-wrap').removeClass('horizontal-nav').addClass('vertical-nav');
  } else {
    $('div.body-wrap').removeClass('vertical-nav').addClass('horizontal-nav');
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:09:43.893

您需要删除其中一个类：

```
$(document).ready(function () {
    if ($('.nav-select option').hasId("two")) {
        $("body div").removeClass('vertical-nav').addClass('horizontal-nav');       
    } 
    else if ($('.nav-select option').hasId("one") {
        $("body div").removeClass('horizontal-nav').addClass('vertical-nav');
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:11:13.427

**试试这个删除旧类添加新类**

```
$(document).ready(function () {
    if ($('.nav-select option').hasId("two")) {
        $("body div").removeClass('vertical-nav').addClass('horizontal-nav');       
    } 
    else if ($('.nav-select option').hasId("one") {
        $("body div").removeClass('horizontal-nav').addClass('vertical-nav');
    }
}); 
```

# c++ - 在 C++ 中以正确的编码获取字符串

> ID：15966156
> 
> 赞同：3
> 
> 时间：2013-04-12T08:06:23.113
> 
> 标签：c++, winapi, encoding, utf-8, character-encoding

我之前问过类似的问题。但我仍然在 c++ 中的编码方面遇到麻烦。我尽量描述问题。

我有一个 c++ 客户端，通过 TCP 与 c# 服务通信。现在我需要在消息框（Win32 API）中显示来自服务的消息。c# 服务发送的字节是 UTF-8 编码的。

重要的是要知道，c++ 客户端只能在 Windows 系统上运行。

这是接收字节并显示文本的代码：

```
 char buffer[1024];
    int receivedBytes = recv(socketHandle, buffer, sizeof(buffer) - 1, 0);
    char str[receivedBytes];
    for (int index = 0; index < receivedBytes; index++)
    {
        str[index] = buffer[index];
    }

    MessageBox(mainWindow, (LPCTSTR)str, (LPCTSTR) "Fehler", MB_OK|MB_ICONERROR); 
```

如果文本包含像 üäö 这样的字符，它们不会以正确的方式显示在消息框中。我该怎么做才能在 c++ 中以 UTF-8 字符串形式接收消息？是否有可能将 char[] 转换为 UTF-8 字符串？

谢谢帮助

托比

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-12T08:16:27.677

如果要在 Windows 中显示 unicode 字符，则需要将 UTF8 字符串转换为 UTF16（旧 UCS2），因为这是 unicode 标准 Windows 句柄。您可以使用[MultiByteToWideChar](http://msdn.microsoft.com/en-us/library/windows/desktop/dd319072%28v=vs.85%29.aspx)函数来做到这一点。

还要确保在包含 Windows 标头之前设置 #define UNICODE，以便 MessageBox 指向 MessageBoxW 或显式使用 MessageBoxW。

# python - Python 多处理

> ID：15966157
> 
> 赞同：2
> 
> 时间：2013-04-12T08:06:28.630
> 
> 标签：python, multiprocessing

我有一个包含二进制编码字符串的大列表，我以前在单个函数中处理过这些字符串，如下所示：

```
""" just included this to demonstrate the 'data' structure """
data=np.zeros(250,dtype='float32, (250000,2)float32')

def func numpy_array(data, peaks):
rt_counter=0
    for x in peaks:
        if rt_counter %(len(peaks)/20) == 0:
            update_progress()
        peak_counter=0
        data_buff=base64.b64decode(x)
        buff_size=len(data_buff)/4
        unpack_format=">%dL" % buff_size
        index=0
        for y in struct.unpack(unpack_format,data_buff):
            buff1=struct.pack("I",y)
            buff2=struct.unpack("f",buff1)[0]
            if (index % 2 == 0):
                data[rt_counter][1][peak_counter][0]=float(buff2)
            else:
                data[rt_counter][1][peak_counter][1]=float(buff2)
                peak_counter+=1
            index+=1
        rt_counter+=1 
```

我一直在阅读多处理，并认为我想尝试一下，看看是否可以大幅提高性能，我将我的函数重写为 2（助手和“调用者”），如下所示：

```
def numpy_array(data, peaks):
    processors=mp.cpu_count #Might as well throw this directly in the mp.Pool (just for clarity for now)
    pool = mp.Pool(processes=processors)
    chunk_size=len(peaks)/processors
    for i in range(processors):
        counter = i*chunk_size
        chunk=peaks[i*chunk_size:(i+1)*chunk_size-1]
        pool.map(decode(data,chunk,counter))

def decode(data,chunk,counter):
    for x in chunk:
        peak_counter=0
        data_buff=base64.b64decode(x)
        buff_size=len(data_buff)/4
        unpack_format=">%dL" % buff_size
        index=0
        for y in struct.unpack(unpack_format,data_buff):
            buff1=struct.pack("I",y)
            buff2=struct.unpack("f",buff1)[0]
            if (index % 2 == 0):
                data[counter][1][peak_counter][0]=float(buff2)
            else:
                data[counter][1][peak_counter][1]=float(buff2)
                peak_counter+=1
            index+=1
        print data[counter][1][10][0]
        counter+=1 
```

该程序运行但仅使用 100-110% 的 CPU（根据顶部），一旦它应该完成它就会`TypeError: map() takes at least 3 arguments (2 given)`向我抛出，任何对多进程有更多经验的人都可以给我一个关于要注意什么的提示（即可能导致TypeError）？什么可能导致我的 CPU 使用率低？

**-- 合并答案后的代码 --**

```
def decode((data,chunk,counter)):
    print len(chunk), counter
    for x in chunk:
        peak_counter=0
        data_buff=base64.b64decode(x)
        buff_size=len(data_buff)/4
        unpack_format=">%dL" % buff_size
        index=0
        for y in struct.unpack(unpack_format,data_buff):
            buff1=struct.pack("I",y)
            buff2=struct.unpack("f",buff1)[0]
            if (index % 2 == 0):
                data[counter][1][peak_counter][0]=float(buff2)
            else:
                data[counter][1][peak_counter][1]=float(buff2)
                peak_counter+=1
            index+=1
        counter+=1

def numpy_array(data, peaks):
    """Fills the NumPy array 'data' with m/z-intensity values acquired
    from b64 decoding and unpacking the binary string read from the 
    mzXML file, which is stored in the list 'peaks'.

    The m/z values are assumed to be ordered without validating this
    assumption.

    Note: This function uses multi-processing
    """
    processors=mp.cpu_count()
    pool = mp.Pool(processes=processors)
    chunk_size=int(len(peaks)/processors)
    map_parameters=[]
    for i in range(processors):
        counter = i*chunk_size
        chunk=peaks[i*chunk_size:(i+1)*chunk_size-1]
        map_parameters.append((data,chunk,counter))
    pool.map(decode,map_parameters) 
```

到目前为止，这个最新版本“有效”，它在进程中填充数组（数组包含值），但是一旦所有进程完成访问数组，就会产生零值，因为每个进程都获得了数组的本地副本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:14:45.803

像这样的东西应该工作

请注意，`pool.map`每次调用都需要一个函数和该函数的参数列表。在您的原始示例中，您只是在`numpy_array`函数中调用它。

该函数必须只有一个参数，因此将参数打包成一个元组，并在`decode`其中使用看起来很奇怪的双括号（称为元组解包）。

```
def numpy_array(data, peaks):
    processors=4
    pool = mp.Pool(processes=processors)
    chunk_size=len(data)/processors
    print range(processors)
    map_parameters = [] # new
    for i in range(processors):
        counter = i*chunk_size
        chunk=peaks[i*chunk_size:(i+1)*chunk_size-1]
        map_parameters.append((data,chunk,counter)) # new
    pool.map(decode, map_parameters) # new

def decode((data,chunk,counter)): # changed
    for x in chunk:
        peak_counter=0
        data_buff=base64.b64decode(x)
        buff_size=len(data_buff)/4
        unpack_format=">%dL" % buff_size
        index=0
        for y in struct.unpack(unpack_format,data_buff):
            buff1=struct.pack("I",y)
            buff2=struct.unpack("f",buff1)[0]
            if (index % 2 == 0):
                data[counter][1][peak_counter][0]=float(buff2)
            else:
                data[counter][1][peak_counter][1]=float(buff2)
                peak_counter+=1
            index+=1
        print data[counter][1][10][0]
        counter+=1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:15:10.400

该错误在您的`numpy_array`函数中：

```
for i in range(processors):
    counter = i*chunk_size
    chunk=peaks[i*chunk_size:(i+1)*chunk_size-1]
    pool.map(decode(data,chunk,counter)) 
```

问题是你是`map`按顺序调用的，所以你一次只运行一个进程。另外，我认为您在`map`签名`pool.map(f(*args))`为`map(f, ['list', 'of', 'data'])`.

我会使用一个部分，这样你就不会创建副本，`data`因为我假设数组非常大或将来可能会更大。

这应该是：

```
import functools
decode_with_data = functools.partial(decode, data)
args = []
for i in range(processors):
    counter = i * chunk_size
    chunk = peaks[1*chunk_size:(i+1)*chunk_size-1]
    args.append(chunk, counter)
pool.map(decode_with_data, args) 
```

# objective-c - KVO：+keyPathsForValuesAffecting 不适用于 NSObjectController 的（子类）

> ID：15966158
> 
> 赞同：5
> 
> 时间：2013-04-12T08:06:28.930
> 
> 标签：objective-c, cocoa, key-value-observing, nsarraycontroller, nsobjectcontroller

我有一个支持 KVO 的类（称为它`Observee`），它的`affectedValue`动态属性受属性的影响`affectingValue`。属性之间的依赖关系由实现`+keyPathsForValuesAffectingAffectedValue`方法定义。

将值设置为`affectingValue`通知`affectedValue` 已按我的预期更改， **除非** `Ovservee`是`NSObjectController`. 完整示例如下：

```
@interface Observee : NSObject // or NSObjectController
@property (readonly, strong, nonatomic) id affectedValue;
@property (strong, nonatomic) id affectingValue;
@property (strong, nonatomic) NSArrayController *arrayController;
@end

@implementation Observee

@dynamic affectedValue;
- (id)affectedValue { return nil; }

+ (NSSet *)keyPathsForValuesAffectingAffectedValue {
  NSLog(@"keyPathsForValuesAffectingAffectedValue called");
  return [NSSet setWithObject:@"affectingValue"];
}

@end

@interface AppDelegate : NSObject <NSApplicationDelegate>
@property (strong, nonatomic) Observee *observee;
@end

@implementation AppDelegate

- (void)applicationDidFinishLaunching:(NSNotification *)notification {
  self.observee = [[Observee alloc] init];
  [self.observee addObserver:self
                  forKeyPath:@"affectedValue"
                     options:NSKeyValueObservingOptionNew
                     context:NULL];
  NSLog(@"setting value to affectingValue");
  self.observee.affectingValue = @42;
}

- (void)observeValueForKeyPath:(NSString *)keyPath
                      ofObject:(id)object
                        change:(NSDictionary *)change
                       context:(void *)context {
  NSLog(@"affected key path = %@", keyPath);
}

@end 
```

`Observee`该示例工作正常，并在派生时输出如下`NSObject`：

```
keyPathsForValuesAffectingAffectedValue called
setting value to affectingValue
affected key path = affectedValue 
```

但是当`Observee`派生时`NSObjectController`：

```
keyPathsForValuesAffectingAffectedValue called
setting value to affectingValue 
```

（请注意，“受影响的密钥路径 = 受影响的值”不存在。）

似乎`keyPathsForValuesAffectingAffectedValue`在这两种情况下都调用了它，但在后者中它是无操作的。

此外，任何涉及 (subclass of) 实例的关键路径`NSObjectController`都不会影响其他关键路径，例如：

```
@implementation SomeObject

// `someValue` won't be affected by `key.path.(snip).arrangedObjects`
+ (NSSet *)keyPathsForValuesAffectingSomeValue {
  return [NSSet setWithObject:@"key.path.involving.anNSArrayController.arrangedObjects"];
}

@end 
```

在这种情况下，如何声明关键路径之间的依赖关系？而且，为什么这整件事会发生？

（是的，我知道`will/didChangeValueForKey:`和朋友们，但是用（另一个）setter 包裹每一个影响关键路径是可怕的，我想避免它。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-17T13:57:36.393

`NSController`及其子类充满了 KVO 的“黑魔法”和意想不到的行为。（再举一个例子，它们不尊重某些 KVO 选项`NSKeyValueObservingOptionPrior`，如 它们的存在主要是为了支持 Cocoa 绑定。尽管乍一看绑定可能看起来只是 KVO 之上的语法糖，但您可以看到（通过覆盖绑定到对象的 KVO 支持方法并在其中设置断点）实际上还有很多事情要做而不是一个简单的 KVO 观察。

请[向 Apple 提交错误，](http://bugreport.apple.com)以增加他们修复（或至少记录）此类问题/行为的可能性。

# ios - 带有 iOS 5 问题的 sqlite

> ID：15966165
> 
> 赞同：2
> 
> 时间：2013-04-12T08:06:56.440
> 
> 标签：ios, ios5, sqlite

好的，就是这样，我有以下查询

```
INSERT INTO 'FoodListTBL' ('AutoNo','CHOCals','PrtCals', 'FatCals','CHOgram','PrtGram','FatGram','CatId', 'TimeTypeId','TotalCals','Visibl', 'IsActive','NameAr','NameEn','CountryId', 'TotalPerUnit','UnitId','PreferedBread1', 'PreferedMilk1','PreferedVeg1','PreferedFat1', 'PreferedFruit1','CauseAllergy','AllergyCatId', 'TotalLikes','NameDescEn','NameDescAr','ChoPerUnit','PrtPerUnit','FatPerUnit','Quantity','PreferedBread2','PreferedMilk2', 'PreferedVeg2','PreferedFat2', 'PreferedFruit2','IV','UV','InsertDate','InsertUser') VALUES (818,0,0, 45, 0, 0, 5, 17, 1, 45,1, 1, 'زبدة قليلة الدسم', 'Butter reduced fat', 0, 45, 14, 0, 0, 0, 0, 0, 0, 0, 0, 'Butter reduced fat', 'زبدة قليلة الدسم', 0, 0, 45, 1, 0, 0, 0, 0, 0, 492, 0, '-', '-' ),(819,0,0, 45, 0, 0, 5, 17, 1, 45,1, 1, 'زبدة', 'Butter regular', 0, 45, 4, 0, 0, 0, 0, 0, 0, 0, 0, 'Butter regular', 'زبدة', 0, 0, 45, 1, 0, 0, 0, 0, 0, 493, 1475, '-', '-') 
```

此查询在 iOS 6.X 上成功执行并在任何低于 5.X 的 iOS 上失败，考虑到其他表上的任何其他插入查询在任何 iOS 上成功完成

我已经尝试了两个插入代码，这是其中之一

```
if(sqlite3_prepare_v2(database, [query UTF8String], -1, &compiledStatement, NULL) == SQLITE_OK) 
{   
    if(SQLITE_DONE != sqlite3_step(compiledStatement))
        NSLog( @"Error while inserting data: '%s'", sqlite3_errmsg(database));
    else NSLog(@"New data inserted");

    sqlite3_reset(compiledStatement);       
}else
{
    NSLog( @"Error while inserting '%s'", sqlite3_errmsg(database));
}
sqlite3_finalize(compiledStatement) 
```

这两种情况的结果是

> 插入 'near ",":syntax error' 时出错

老化此查询对除 iOS < 6.0 之外的所有内容均有效

任何线索表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T11:20:40.040

3.7.11 之前的 SQLite 不支持多记录`INSERT`语法。

使用多个`INSERT`命令，或使用 插入记录`INSERT ... SELECT ... UNION ALL ...`。

# mysql - Perl 模块实例化 + DBI + Forks “Mysql 服务器已经消失”

> ID：15966168
> 
> 赞同：4
> 
> 时间：2013-04-12T08:07:16.783
> 
> 标签：mysql, perl, fork, dbi

我编写了一个 perl 程序，将 csv 中的记录解析为 db。

该程序运行良好，但花了很长时间。所以我决定分叉主要的解析过程。

经过一番与 fork 的争论后，它现在运行良好并且运行速度提高了大约 4 倍。主要的解析方法是数据库密集型的。出于利益考虑，对于每条解析的记录，都有以下数据库调用：

1 - 检查唯一生成的 base62 对于 baseid 映射表是唯一的 2 - 有存档检查以查看记录是否已更改 3 - 记录插入到数据库中

问题是当解析器在分叉模式下运行时，我开始出现“Mysql has gone away”错误，所以经过多次摆弄后，我想出了以下 mysql 配置：

```
#
# * Fine Tuning
#
key_buffer              = 10000M
max_allowed_packet      = 10000M
thread_stack            = 192K
thread_cache_size       = 8
myisam-recover         = BACKUP
max_connections        = 10000
table_cache            = 64
thread_concurrency     = 32
wait_timeout           = 15
tmp_table_size  = 1024M

query_cache_limit       = 2M
#query_cache_size        = 100M
query_cache_size = 0
query_cache_type = 0 
```

这似乎在解析器运行时解决了问题但是，当下一个模块在主解析器之后运行时，我现在得到一个“Mysql 服务器已经消失”。

奇怪的是，导致问题的模块涉及对当前只有 3 条记录的表进行非常简单的 SELECT 查询。直接作为测试运行（而不是在解析器之后）它工作正常。

我尝试在解析器模块运行后添加 4 分钟的暂停 - 但我得到了同样的错误。

我有一个主要的 DBConnection.pm 模型： package DBConnection;

```
use DBI;
use PXConfig;

sub new {
    my $class    = shift;
    ## MYSQL Connection
    my $config = new PXConfig();
    my $host     = $config->val('database', 'host');
    my $database = $config->val('database', 'db');
    my $user     = $config->val('database', 'user');
    my $pw       = $config->val('database', 'password');
    my $dsn      = "DBI:mysql:database=$database;host=$host;"; 
    my $connect2 = DBI->connect( $dsn, $user, $pw,  );
    $connect2->{mysql_auto_reconnect} = 1;
    $connect2->{RaiseError} = 1;
    $connect2->{PrintError} = 1;
    $connect2->{ShowErrorStatement} = 1;
    $connect2->{InactiveDestroy} = 1;

    my $self     = {
        connect => $connect2,
    };
    bless $self, $class;
    return $self;
} 
```

然后所有模块，包括分叉的解析器模块，使用以下命令打开与数据库的连接：

```
package Example;

use DBConnection;

sub new {
    my $class    = shift;
    my $db       = new DBConnection;
    my $connect2 = $db->connect();
    my $self     = {
        connect2 => $connect2,
    };
    bless $self, $class;
    return $self;
} 
```

问题是如果我有调用 Module2.pm 的 Module1.pm 调用 Module3.pm 并且它们每个都实例化与数据库的连接，如上所示（即在构造函数中），那么它们是使用不同的数据库连接还是相同的联系？

我想知道的是脚本是否需要 6 个小时才能完成，如果对数据库连接的顶层调用正在使较低级别的数据库连接超时，即使较低级别的模块正在建立其“自己的”连接。

试图找到问题非常令人沮丧，因为我只能在运行很长的解析过程后重现错误。

很抱歉这个问题很长，提前感谢任何能给我任何想法的人。

* * *

## 更新 1：

这是实际的分叉部分：

```
my $fh = Tie::Handle::CSV->new( "$file", header => 1 );
while ( my $part = <$fh> ) {
    if ( $children == $max_threads ) {
        $pid = wait();
        $children--;
    }
    if ( defined( $pid = fork ) ) {
        if ($pid) {
            $children++;
        } else {
            $cfptu = new ThreadedUnit();
            $cfptu->parseThreadedUnit($part, $group_id, $feed_id);
        }
    }
} 
```

然后是 ThreadedUnit：

```
package ThreadedUnit;

use CollisionChecker;
use ArchiveController;
use Filters;
use Try::Tiny;
use MysqlLogger;

sub new {
    my $class    = shift;
    my $db       = new DBConnection;
    my $connect2 = $db->connect();
    my $self     = {
        connect2 => $connect2,
    };
    bless $self, $class;
    return $self;
}

sub parseThreadedUnit {
    my ( $self, $part, $group_id, $feed_id ) = @_;
    my $connect2 = $self->{connect2};

    ## Parsing stuff

    ## DB Update in try -> catch
    exit();
} 
```

因此，据我了解，分叉后正在调用数据库连接。

但是，正如我上面提到的，上面概述的分叉代码可以正常工作。下一个不起作用的模块是从控制器模块运行的，该控制器模块一次只通过每个工作模块运行（解析器就是其中之一） - 控制器模块不会在其构造或任何地方创建数据库连接别的。

* * *

## 更新 2

我忘了提到，如果我只解析少量文件而不是完整队列，解析器之后的“问题”模块中不会出现任何错误。

因此，就好像密集的分叉解析和访问数据库使其在正常的非分叉进程结束一段时间后无法使用。

当解析器运行在 Mysql 状态下完成时，我唯一注意到的是 Threads_connected 位于 500 左右，并且在一段时间内没有减少。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:27:15.030

这取决于您的程序的结构，这从问题中不清楚。

如果你在你之前创建了数据库连接`fork`，Perl 将为每个进程制作一个数据库连接对象的副本。如果两个进程尝试使用相同的数据库连接同时访问数据库，这可能会导致问题。

另一方面，如果您在`fork`ing 之后创建 DB 连接，则每个模块都会有自己的连接。这应该可以，但是如果模块 x 创建一个连接，然后等待很长时间让模块 y 中的进程完成，然后尝试使用该连接，您可能会遇到超时问题。

总之，这就是你想要的：

*   在您所在的位置没有任何打开的连接`fork`。子进程应该创建自己的连接。
*   仅在您想使用它之前打开一个连接。如果您的程序中有一个点需要等待，请在等待完成后打开连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:39:36.003

阅读 dan1111 的答案，但我怀疑您正在连接然后分叉。当子进程完成时，DBI 连接句柄超出范围并关闭。正如 dan1111 所说，出于他所说的所有原因，您可以更好地与孩子建立联系。阅读有关DBI 中的[InactiveDestroy](http://search.cpan.org/~timb/DBI-1.625/DBI.pm#InactiveDestroy)和[AutoInactiveDestroy](http://search.cpan.org/~timb/DBI-1.625/DBI.pm#AutoInactiveDestroy)的信息，这将帮助您了解正在发生的事情。

# actionscript-3 - 如果两个精灵可见，做点什么（AS3）

> ID：15966170
> 
> 赞同：0
> 
> 时间：2013-04-12T08:07:22.530
> 
> 标签：actionscript-3, flash, sprite

我正在创造一个像游戏一样的记忆。我构建了所有的桌面，卡片生成。我现在每人有两张卡。

我正在尝试做对删除系统。

我显示要查找的颜色的函数如下所示：

```
private function onClick(e:MouseEvent):void
        {
            if (vueDos)
            {
                vueDos          = !vueDos;

                faceCarte       = new Sprite();
                faceCarte.graphics.lineStyle(2,0x000000,.5);
                faceCarte.graphics.beginFill(clr);
                faceCarte.graphics.drawRoundRect(8,8,this.width - 16, this.height - 16, 10,10);
                faceCarte.graphics.endFill();

                var _t:TextField    = new TextField();
                _t.selectable       = false;
                _t.antiAliasType    = "advanced";
                _t.autoSize         = "left";
                _t.defaultTextFormat= new TextFormat(maFont.fontName,24,0x000000);
                _t.text             = couleur;
                _t.x                = (this.width - _t.width)/2
                _t.y                = (this.height - _t.height) >> 1;

                faceCarte.addChild(_t);
                faceCarte.cacheAsBitmap = true;
                this.addChild(faceCarte);
            }

            if(!vueDos) 
        } 
```

它是否存在一个函数来查看卡片的颜色是否可见（faceCarte），并将可见点卡限制为两个然后 removeChild faceCart。

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:33:47.377

您必须自己制作这样的功能。最好将`couleur`属性分配给卡片本身，而不是将其放入 TextField 并忘记。这样您就可以打开第一张卡，获取该属性，然后打开第二张卡并将该卡的属性与您收到的属性进行比较，如果匹配，两张卡都将被删除。

# android - 如何在带有终端的ubuntu下使用sqlite？

> ID：15966174
> 
> 赞同：0
> 
> 时间：2013-04-12T08:07:44.367
> 
> 标签：android, database, sqlite, contact

我只想知道如何获取 android loacal-app Contact' 数据库，我想用终端检查 raw_contact 或数据表。我需要什么工具或订单是什么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:55:19.113

根据我从您的问题中了解到的情况，您想使用 CLI 工具来检查 Android 联系人的数据库。AFAIK 数据库本身应该位于

```
/data/data/com.android.providers.contacts/databases/contacts2.db 
```

但是可能会根据制造商而改变吗？

至于在您的 Ubuntu 安装中使用本地工具，您首先需要获取平台 SDK 以使用[ADB](http://developer.android.com/tools/help/adb.html)从您的设备中提取数据库，然后使用本地工具来操作或检查数据库。**注意：您的设备需要 root 才能提取数据库。**

例如，在 SQLite 网站上，他们为 Linux 提供了一个二进制文件来检查数据库。它可以位于此处：[http](http://www.sqlite.org/download.html) ://www.sqlite.org/download.html但我确信由于 SQLite 是一个开放标准，还有更多的浮动。

希望这能回答你的问题。

# javascript - 意外的标识符错误，javascript

> ID：15966175
> 
> 赞同：0
> 
> 时间：2013-04-12T08:07:49.903
> 
> 标签：javascript

我收到了一个意外的标识符`float farenheitFloat = parseFloat(farenheit)`

不能为我的生活弄清楚为什么。有什么帮助吗？

一点背景......`validateFarenheit(farenheit)`正在工作。

```
function convertFarenheit() {
    var farenheit = document.getElementById('farenheit').value;
    if (validateFarenheit(farenheit)) {
        float farenheitFloat = parseFloat(farenheit);
        //float celsius = (farenheitFloat - 32) * (5/9);
        //float celsiusFormatted = parseFloat(Math.round(celsius * 100) / 100).toFixed(2);
        //alert(celsiusFormatted);  
    }
    return;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:09:37.337

问题出在这一行：

`float farenheitFloat = parseFloat(farenheit);`

JavaScript中没有`float`类型（或任何严格的类型声明）之类的东西。

将其更改为：

`var farenheitFloat = parseFloat(farenheit);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:09:30.360

在 javascript 中，您总是通过以下方式声明变量

```
var myVariable; 
```

你不指定一个喜欢的类型`float`，但总是说`var`。

# java-me - 如何在 j2me 应用程序中制作生日提醒

> ID：15966180
> 
> 赞同：0
> 
> 时间：2013-04-12T08:08:13.360
> 
> 标签：java-me

我想为 java 设备创建生日提醒。那么你能告诉我当用户在我的应用程序中输入日期时可以使用什么来提醒生日吗？？请回答..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T10:49:03.410

您将使用 JSR 75 PIM API。这是一篇关于它的好文章：[http](http://www.oracle.com/technetwork/systems/pim5-155424.html)
://www.oracle.com/technetwork/systems/pim5-155424.html 检查“添加 PIM 项”。

# facebook - 是否可以使用 facebook api 从我的帐户在其他用户墙上发布

> ID：15966188
> 
> 赞同：0
> 
> 时间：2013-04-12T08:08:36.777
> 
> 标签：facebook, post

我有一个要求，我需要从我的 webapp fb 帐户发布到我的 webapp 用户的 fb 墙（在询问用户许可后）。我已经看到其他示例，其中 webapp 代表用户发布到用户的墙上。在我的情况下，我必须从 webapp fb 帐户发布到用户墙，而不是代表用户发布。

这种情况可能吗？如果可能，请向我提供详细信息。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:59:30.833

自 2013 年 2 月 6 日起，Facebook 已弃用发布到好友墙的功能。在这篇[博文中也宣布了同样的](https://developers.facebook.com/blog/post/2012/10/10/growing-quality-apps-with-open-graph/)内容。如果您想允许人们从您的应用发布到他们朋友的时间线，您可以调用[提要对话框](https://developers.facebook.com/docs/reference/dialogs/feed/)。

# php - Zend_db 将字符串限制为 255 个字符？

> ID：15966189
> 
> 赞同：0
> 
> 时间：2013-04-12T08:08:43.347
> 
> 标签：php, sql, zend-framework

当我想将`SELECT a vachar(4000)`数据从 SQL Server 传输到 PHP 时，我遇到了麻烦。事实上，当我执行时，`$db->query`我的字符串限制为 255 个字符。

我试图投射数据，但什么也没发生，它仍然被截断。从 SQL Server 我的请求没有问题。
我还尝试将我的数据子串化为许多限制为 255 个字符的子数据，但这没有用。

我认为这是一个问题`Zend_Db_Table`。是否有任何参数可以强制它获取所有数据？

# java - 如何自动增加字符串/整数以提高效率？

> ID：15966190
> 
> 赞同：1
> 
> 时间：2013-04-12T08:08:43.390
> 
> 标签：java, arraylist

说这是我的代码：

```
String name = in1.next();
int highNumber = in1.nextInt();
int lowNumber = in1.nextInt();

System.out.println(name +" " + highNumber +" " + lowNumber); 
```

`name`如果不是 12 ，有没有办法可以在前面添加一个数字？或者有没有办法创建一个`ArrayList`做同样的事情？

我需要从一个文件中获取 12 行，每行都带有`name`, `highNumber`，并且`lowNumber` 我希望能够单独操作每个等式，也可以完全操作。

文件：

```
Edward 33 22
Billy  22 14
Fred   44 43
Jim    12  1
Andy   3   2
... 
```

预期输出：

```
Name             High             Low             Average            Range
--------------------------------------------------------------------------
Billy             22                14             18                  8
...

Total Averages
Total Highs
Total Lows 
```

替代做这样的事情：

```
String name2 = in1.next();
int highNumber2 = in1.nextInt();
int lowNumber2 = in1.nextInt();
String name3 = in1.next();
int highNumber3 = in1.nextInt();
int lowNumber3 = in1.nextInt();
String name4 = in1.next();
int highNumber4 = in1.nextInt();
int lowNumber4 = in1.nextInt();
...
String name12 = in1.next();
int highNumber12 = in1.nextInt();
int lowNumber12 = in1.nextInt(); 
```

我被限制使用`Scanner`and `PrintWriter`。:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:34:01.773

您可以将每一行的数据存储在这样的对象中

```
public class Record {
    private String name;
    private Integer high;
    private Integer low;

    public Record(String name, Integer high, Integer, low) {
        this.name = name;
        this.high = high;
        this.low = low;
    }

    public Record(String line) {
        String[] parts = line.split(" ");
        name = parts[0].trim();
        high = new Integer(parts[1].trim());
        low = new Integer(parts[2].trim());
    }

    public String getName() {
        return name;
    }

    public Integer getHigh() {
        return high;
    }

    public Integer getLow() {
        return low;
    }

    public Integer getAvg() {
        return (high + low) / 2;
    }

    public Integer getRange() {
        return (high - low);
    }

    public String toString() {
        return name + '\t' + high + '\t' + low  +'\t' + getAvg() + '\t' + getRange();
    }
} 
```

然后将从文件中读取的行填充到新的 Record 对象中，将它们附加到列表中，最后遍历列表以打印表

```
List<Record> records = new ArrayList<Record>();
String name;
Integer high;
Integer low;

for(int i = 0; i < 12; i++) {
    name = in1.next();
    high = in1.nextInt();
    low = in1.nextInt();

    records.add(new Record(name, high, low));
}

for(Record record : records) {
    System.out.println(record);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T09:01:11.590

```
Scanner in=new Scanner(new File(""));
System.out.println("Id\tName\tHigh\tLow\tAvg\tRange");
int id=1;
while(input.hasNext())
{
String name=input.next();
int high=input.nextInt();
int low=input.nextInt();
System.out.println(id+"\t"+name+"\t"+high+"\t"+low+"\t"+((high+low)/2)+"\t"+(high-low));
id++;
} 
```

你期待这个吗？？？给更多细节..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:27:19.820

可能是一条阅读线？

```
BufferedReader File = new BufferedReader(new FileReader(FileOpen));   
     String str;
     str = File.readLine( ); 
```

当第一行读取然后再做 readLine() with a boule for(){}

# c - 尽管使用了宏，但 Doxygen 中的文档 C？

> ID：15966198
> 
> 赞同：1
> 
> 时间：2013-04-12T08:09:20.897
> 
> 标签：c, macros, doxygen

我在 C 源文件中有宏，可以生成函数声明以及结构。

我决定使用 doxygen 来记录它们，但只要我的源文件没有明确包含声明，doxygen 就不会生成适当的文档。

这是一个小例子；我有一个宏，它是类声明的***一种***习惯用法：

```
#define CLASS(x) \
typedef struct _##x x; \
typedef struct _##x *P##x; \
typedef struct _##x **PP##x; \
typedef struct _##x 
```

所以不要写：

```
 /**
  * \struct _Vector
  * \brief the vector structure handles stuff to store data accessible by an index.
  */
typedef struct _Vector {
    /*@{*/
    Container   container;      /**< inherits from container */
    size_t      allocated_size; /**< the total allocated size of a vector (private usage) */
    void*       elements;       /**< pointer to the allocated memory space (private usage) */
    /*@}*/
} Vector, *PVector; 
```

我可以改写：

```
/**
  * \struct _Vector
  * \brief the vector structure handles stuff to store data accessible by an index.
  */
CLASS(Vector) {
    /*@{*/
    Container   container;      /**< inherits from container */
    size_t      allocated_size; /**< the total allocated size of a vector (private usage) */
    void*       elements;       /**< pointer to the allocated memory space (private usage) */
    /*@}*/
}; 
```

但是对于第二种情况，doxygen 不会生成有关我的结构成员的文档。

我如何才能找到解决此类问题的合规解决方案？

# c# - 文本的工具提示可能吗？

> ID：15966205
> 
> 赞同：0
> 
> 时间：2013-04-12T08:09:45.937
> 
> 标签：c#, visual-studio

我想知道以下是否可能：

将工具提示添加到特定文本（代码编辑器），例如：

```
var ToolTip1 = new System.Windows.Forms.ToolTip
{
    AutomaticDelay = 5000,
    AutoPopDelay = 50000,
    InitialDelay = 100,
    ReshowDelay = 500
};

ToolTip1.SetToolTip(rtb, "Represents text as a series of Unicode characters");*/ 
```

但是在这样的文本中：

![在此处输入图像描述](https://i.stack.imgur.com/NqrAN.png)

我想知道怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:15:31.117

您必须在属性上方添加 XML 文档，如下所示：

```
/// <summary>
/// Add your description here
/// </summary>
public String[] xm = { "XmlReadNode", "XmlWriteNode" } 
```

编辑：澄清问题后更新

```
/// <summary>
/// Your write description
/// </summary>
private const string write = "XmlWriteNode";

/// <summary>
/// Your read description.
/// </summary>
private const string read = "XmlReadNode";

/// <summary>
/// Add your object description here
/// </summary>
public String[] xm = 
{
    read, write 
}; 
```

# android - 膨胀类片段时出错-sherlockactionbar google map v2

> ID：15966207
> 
> 赞同：0
> 
> 时间：2013-04-12T08:09:54.543
> 
> 标签：android, actionbarsherlock, google-maps-android-api-2, actionbarsherlock-map

我正在尝试使用 SherlockActivtiyBar 在片段内开发 Google Android Map v2。

我有这个错误：

```
04-12 10:01:26.830: E/AndroidRuntime(1089): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.it.michele.ab.map/it.michele.prova.MainActivity}: android.view.InflateException: Binary XML file line #7: Error inflating class fragment 
```

你能帮助我吗？

我做错了什么？

这是我的 Eclipse 项目：

[http://www.michelepierri.it/project.zip](http://www.michelepierri.it/project.zip)

这是我的代码：
SherlockMapFragment.java

```
package com.actionbarsherlock.app;

    import android.app.Activity;
    import android.support.v4.app.Watson.OnCreateOptionsMenuListener;
    import android.support.v4.app.Watson.OnOptionsItemSelectedListener;
    import android.support.v4.app.Watson.OnPrepareOptionsMenuListener;

    import com.actionbarsherlock.app.SherlockFragmentActivity;
    import com.actionbarsherlock.internal.view.menu.MenuItemWrapper;
    import com.actionbarsherlock.internal.view.menu.MenuWrapper;
    import com.actionbarsherlock.view.Menu;
    import com.actionbarsherlock.view.MenuInflater;
    import com.actionbarsherlock.view.MenuItem;
    import com.google.android.gms.maps.SupportMapFragment;

    public class SherlockMapFragment extends SupportMapFragment implements OnCreateOptionsMenuListener, OnPrepareOptionsMenuListener, OnOptionsItemSelectedListener {
        private SherlockFragmentActivity mActivity;

        public SherlockFragmentActivity getSherlockActivity() {
            return mActivity;
        }

        @Override
        public void onAttach(Activity activity) {
            if (!(activity instanceof SherlockFragmentActivity)) {
                throw new IllegalStateException(getClass().getSimpleName() + " must be attached to a SherlockFragmentActivity.");
            }
            mActivity = (SherlockFragmentActivity)activity;

            super.onAttach(activity);
        }

        @Override
        public void onDetach() {
            mActivity = null;
            super.onDetach();
        }

        @Override
        public final void onCreateOptionsMenu(android.view.Menu menu, android.view.MenuInflater inflater) {
            onCreateOptionsMenu(new MenuWrapper(menu), mActivity.getSupportMenuInflater());
        }

        @Override
        public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
            //Nothing to see here.
        }

        @Override
        public final void onPrepareOptionsMenu(android.view.Menu menu) {
            onPrepareOptionsMenu(new MenuWrapper(menu));
        }

        @Override
        public void onPrepareOptionsMenu(Menu menu) {
            //Nothing to see here.
        }

        @Override
        public final boolean onOptionsItemSelected(android.view.MenuItem item) {
            return onOptionsItemSelected(new MenuItemWrapper(item));
        }

        @Override
        public boolean onOptionsItemSelected(MenuItem item) {
            //Nothing to see here.
            return false;
        }
    } 
```

MainActivity.java

```
 package it.michele.prova;

import com.actionbarsherlock.app.SherlockFragmentActivity;

import android.os.Bundle;
import android.app.Activity;
//import android.view.Menu;
import com.actionbarsherlock.view.*;

import com.example.it.michele.ab.map.R;
import com.example.it.michele.ab.map.R.layout;
import com.example.it.michele.ab.map.R.menu;
//import com.google.android.gms.maps.*;

public class MainActivity extends SherlockFragmentActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, (android.view.Menu) menu);
        return true;
    }

} 
```

activity_main.xml

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/root"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <fragment
        android:id="@+id/fragment_map"
        android:name=".ui.fragments.MapFragment"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:tag="tag_fragment_map" />

    <fragment
        android:id="@+id/fragment_help"
        android:name=".ui.fragments.HelpFragment"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:tag="tag_fragment_help" />
</FrameLayout> 
```

![在此处输入图像描述](https://i.stack.imgur.com/1yVzZ.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-15T16:01:52.597

我花了几天时间试图解决这个问题。就我而言，我没有在我的 android 清单中引用 open GL es v2 - 一旦我把它放在那里，错误就消失了，我的地图也出现了。如果该语句尚不存在，请将其添加到您的 android 清单权限中-这可能会为您解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:13:52.900

通常，如果您`fragment/class not found error`在使用地图时收到消息，那么您的问题可能是因为缺少对该库的良好参考，`google-play-services`因为`MapFragment`/`SupportMapFragment`是该库的一部分：

检查你的`Android Dependencies`文件夹是否`(blue)`在`google-play-services` `(orange)`里面，你会发现有这个类的`com.google.android.gms.maps`包：`(green)``MapFragment``(red)`

![在此处输入图像描述](https://i.stack.imgur.com/rizxV.png)

如果不是这种情况，您可以查看我写的这篇博文的前 3 个步骤，以了解如何正确引用这个包：

[谷歌地图 API V2](http://blog-emildesign.rhcloud.com/?p=435)

# c# - 如何在 .Net MVC 中使用 jQuery 数据表和控制器内的 HTML 渲染实现服务器端处理

> ID：15966208
> 
> 赞同：2
> 
> 时间：2013-04-12T08:09:54.567
> 
> 标签：c#, jquery, .net, asp.net-mvc, datatables

我想创建一种可重用的方式，将出色的[jQuery](http://www.datatables.net/)数据表插件与 .Net MVC 一起用于我所有包含表的视图。现在，我已经弄清楚了这个插件的服务器端处理是如何工作的，以及我需要如何编写我的控制器逻辑来提供适当的响应。

问题从渲染 html 开始。例如，我需要在“人员表”中每个人的名字旁边渲染一张图片。但是，当我在搜索框中输入内容时，它仍应按这些人的姓名正确搜索。

现在，使用 Razor 视图引擎，这很容易，您可以编写如下内容：

```
@foreach (var person in people)
{
    <tr>
        <td>
            <span>@person.Name</span>
            <img src="@person.ImgUrl" title="@person.Name"/>
        </td>
    </tr>
} 
```

问题是这需要在服务器端呈现为 JSON。您将有一个控制器来处理 jQuery 数据表 AJAX 请求并返回包含数据表所需的所有内容的有效 JSON 对象。但是，您无法从控制器中的视图访问片段。我在这里看到的唯一选择是为需要呈现某些特定 HTML 的每一列创建部分视图。（对于常见的用例，比如操作按钮，我可以编写 HTML 助手）

这就是问题所在。我很犹豫是否为每个 HTML 列的每个表创建部分视图。

这里的问题是控制器需要以某种方式访问​​显示逻辑来创建 JSON，而显示逻辑通常写在视图中。我的选择仅限于使用部分视图并将其呈现为控制器中的字符串，或者将我的显示逻辑（它们是 lambda 表达式）存储在某种服务器会话或缓存中并从控制器中获取它。最后一种方法的最大缺点是会话或缓存似乎太不稳定而无法依赖。

所以，重申一下：

1.  **我想使用带有 AJAX服务器端处理**的 jQuery 数据表插件来显示一个实体表。
2.  我想使用 Razor 视图引擎**在我的视图中编写我的显示逻辑**
3.  我想在我的控制器中**处理**jQuery 数据表 AJAX**请求**
4.  **我想以某种方式**访问在我的控制器**中写入视图中的每列显示逻辑**，以构建 JSON 响应。这是因为某些列可以具有自定义 HTML、加载部分内容等。

我真的很坚持这一点，如果在 Stackoverflow 上有类似的问题，请指出我，因为我还没有找到它们。

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T12:22:07.787

我不确定我是否完全遵循这个问题，但我认为你可以很容易地解决这个问题。与其尝试让控制器引用不起作用的视图，不如让 jQuery 在 Ajax 请求中将控制器所需的参数传递回。然后控制器可以使用这些参数来发送正确的 JSON 响应。

我认为你被困在第 2 点：

> 我想使用 Razor 视图引擎在我的视图中编写我的显示逻辑

这对于 datatables.net 来说很难做到，因为显示逻辑是在 javascript 中的。您可以使用 JS 模板插件（如[mustache](http://mustache.github.io/)）并将其写入您的视图中。然后在您的 datatables.net js 中，您可以将 JSON 插入模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-08T14:32:45.833

这个问题很老，但它可能会帮助其他也会解决这个问题的人。我有很好的解决方案。

我有 html 助手（AjaxTable，Column），它在页面加载时创建一个描述表（AjaxTable）的对象。该对象存储在会话中。所有 ajax 请求都在通用控制器中处理，该控制器使用存储的对象来创建响应。它支持分页、排序和过滤。

示例用法：

在控制器中：

```
public ActionResult Odeslane()
{
    return View(db.Dotaz.Where( ... /* select all data which should be displayed in the table */ ));
} 
```

在视图中：

```
@model IQueryable<Dotaz>

@using (Html.AjaxTable(Model, new { id = "dotazTable" }))
{
    Html.Column(Model, @<th>@Html.DisplayNameFor(model => item.Autor.JmenoPrijmeniAUzivatelskeJmeno)</th>, 
    @<td>
        <input type="hidden" name="id" value="@item.DotazId" />
        @if (item.AutorId != null) { 
            @Html.DisplayFor(model => item.Autor.JmenoPrijmeniAUzivatelskeJmeno)
        }
        else
        {
            @Html.DisplayFor(model => item.AnonymMail)
        }
    </td>, 
    d => d.AutorId != null ? d.Autor.Jmeno + " " + d.Autor.Prijmeni + " (" + d.Autor.UserName + ")" : d.AnonymMail);

    Html.Column(Model, @<th>@Html.DisplayNameFor(model => item.Nazev)</th>, @<td>@Html.DisplayFor(model => item.Nazev)</td>, d => d.Nazev );

    Html.Column(Model, @<th>@Html.DisplayNameFor(model => item.DatumVzniku)</th>, @<td>@Html.DisplayFor(model => item.DatumVzniku)</td>, d => d.DatumVzniku );
} 
```

执行：

帮手：

```
 public static IDisposable AjaxTable<T>(this HtmlHelper htmlHelper, IQueryable<T> items, object htmlAttributes) where T : new()
    {
        var attrs = HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes);
        // TODO: replace CommonAjaxActionUrl with url of the common ajax action
        return new AjaxTableDisposable<T>(htmlHelper, items, CommonAjaxActionUrl, attrs);
    }

    public static MvcHtmlString Column<T, TKey>(this HtmlHelper htmlHelper, IEnumerable<T> items, Func<T, HelperResult> th, Func<T, HelperResult> td, Expression<Func<T, TKey>> keySelector) where T : new()
    {
        var obj = htmlHelper.ViewContext.TempData["AjaxTable"];
        AjaxTableDisposable<T> table = obj as AjaxTableDisposable<T>;
        table.Column(th, td, keySelector);
        return MvcHtmlString.Empty;
    } 
```

AjaxTable一次性：

```
public class AjaxTableDisposable<T> : IDisposable where T : new()
{
    private HtmlHelper htmlHelper;
    private ViewContext viewContext;
    private AjaxTable<T> table;

    public AjaxTableDisposable(HtmlHelper htmlHelper, IQueryable<T> items, string ajaxUrl, RouteValueDictionary attrs)
    {
        // akce na zacatku
        this.htmlHelper = htmlHelper;
        viewContext = htmlHelper.ViewContext;
        viewContext.TempData["AjaxTable"] = this;
        if (!attrs.ContainsKey("id")) attrs["id"] = "AjaxTable" + Guid.NewGuid().ToString("N");
        table = new AjaxTable<T>() { AjaxUrl = ajaxUrl, Attrs = attrs, Items = items };
    }

    public void Column<TKey>(Func<T, HelperResult> th, Func<T, HelperResult> td, Expression<Func<T, TKey>> keySelector)
    {
        AjaxTableColumn<T> col = new AjaxTableColumn<T>() { Th = th, Td = td, KeySelector = keySelector, KeyType = typeof(TKey) };
        col.OrderData = (IQueryable<T> data, bool asc) => asc ? data.OrderBy(keySelector) : data.OrderByDescending(keySelector);
        table.Columns.Add(col);
    }

    // When the object is disposed (end of using block), write "end" function
    public void Dispose()
    {
        // akce na konci
        viewContext.TempData.Remove("AjaxTable");
        viewContext.Writer.Write(htmlHelper.Partial("DisplayTemplates/AjaxTable", table));
        string tableId = table.Attrs["id"].ToString();
        StoreInSession(table);  // TODO: you have to implement the StoreInSession method
    }
} 
```

AjaxTable 模板：

```
@model IAjaxTable
@{
    RouteValueDictionary attrs = Model.GetAttrs();
    string tableId = attrs["id"].ToString();
    string cls = attrs.ContainsKey("class") ? " " + attrs["class"] : "";
}

<table id="@tableId" class="@{ ViewContext.Writer.Write(cls); }"@{
    foreach (var attr in attrs)
    {
        if (attr.Key != "id" && attr.Key != "class")
        {
            ViewContext.Writer.Write(" "+attr.Key+"="+"\""+attr.Value+"\"");
        }
    }
}>
    <thead>
        <tr>
            @for (int i = 0; i < Model.GetColumnsCount(); i++ )
            {
                Model.GetTh(i).WriteTo(ViewContext.Writer);
            }
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script type="text/javascript">
    $(document).ready(function () {

        var dt = $('#@tableId').DataTable({
        serverSide: true,
        ajax: function (data, callback, settings) {
                data["tableId"] = "@tableId";
                $.ajax({
                    dataType: 'json',
                    url: "@Model.GetAjaxUrl()",
                    type: "POST",
                    success: callback,
                    data: data
                });
        },
        ...
    });
});
</script> 
```

AjaxTable 类：

```
public class AjaxTable<T> : IAjaxTable where T : new()
{
    public List<AjaxTableColumn<T>> Columns { get; set; }
    public T Row { get; set; }
    public String AjaxUrl { get; set; }
    public RouteValueDictionary Attrs { get; set; }
    public IQueryable<T> Items { get; set; }

    public AjaxTable()
    {
        Columns = new List<AjaxTableColumn<T>>();
        Row = new T();
    }

    public HelperResult GetTh(int column)
    {
        return Columns[column].Th.Invoke(Row);
    }

    public string GetAjaxUrl()
    {
        return AjaxUrl;
    }

    public RouteValueDictionary GetAttrs()
    {
        return Attrs;
    }

    public int GetColumnsCount()
    {
        return Columns.Count;
    }

    public object DefaultAjaxAction()
    {
        var total = Items.Count();
        IQueryable<T> data = Search(Items, ParamSearchValue, ParamSearchRegex);
        var filtered = data.Count();
        data = Columns[ParamOrderColumn].OrderData(data, ParamOrderDirAscending);
        data = data.Skip(ParamStart).Take(ParamLength);
        return CreateAjaxResponse(data, total, filtered);
    }

    public IQueryable<T> Search(IQueryable<T> data, string search, bool regex)
    {
        if (search == null || search == "") return data;
        Expression orExpression = null;
        IReadOnlyCollection<ParameterExpression> parameters = null;
        foreach (var col in Columns)
        {
            if (col.KeyType == typeof(string))
            {
                Expression<Func<T, string>> keySelector = (Expression<Func<T, string>>) col.KeySelector;
                Expression compare = Expression.Call(keySelector.Body, typeof(String).GetMethod("Contains"), Expression.Constant(search));
                if (orExpression == null)
                {
                    orExpression = compare;
                    parameters = keySelector.Parameters;
                }
                else
                {
                    orExpression = Expression.OrElse(compare, orExpression);
                }
            }
        }
        if (orExpression != null)
        {
            Expression<Func<T, bool>> whereExpr = Expression.Lambda<Func<T, bool>>(orExpression, parameters);
            UnifyParametersVisitor visitor = new UnifyParametersVisitor();
            whereExpr = visitor.UnifyParameters(whereExpr);
            data = data.Where(whereExpr);
        }
        return data;
    }

    public object CreateAjaxResponse(IQueryable<T> data, int recordsTotal, int recordsFiltered)
    {
        Dictionary<string,object> obj = new Dictionary<string,object>();
        obj.Add("draw", HttpContext.Current.Request.Params["draw"]);
        obj.Add("recordsTotal", recordsTotal);
        obj.Add("recordsFiltered", recordsFiltered);
        List<T> dataList = data.ToList();
        String[][] cell = new String[dataList.Count()][];
        int rowIndex = 0;
        foreach (T row in dataList)
        {
            cell[rowIndex] = new String[Columns.Count];
            int colIndex = 0;
            foreach (var column in Columns)
            {
                StringWriter sw = new StringWriter();
                column.Td.Invoke(row).WriteTo(sw);
                cell[rowIndex][colIndex++] = sw.ToString();
                sw.Dispose();
            }
            rowIndex++;
        }
        obj.Add("data", cell);
        return obj;
    }

    public int ParamStart { get { return Int32.Parse(HttpContext.Current.Request.Params["start"]); } }
    public int ParamLength { get { return Int32.Parse(HttpContext.Current.Request.Params["length"]); } }
    public int ParamOrderColumn { get { return Int32.Parse(HttpContext.Current.Request.Params["order[0][column]"]); } }
    public bool ParamOrderDirAscending { get { return HttpContext.Current.Request.Params["order[0][dir]"] == "asc"; } }
    public string ParamSearchValue { get { return HttpContext.Current.Request.Params["search[value]"]; } }
    public bool ParamSearchRegex { get { return HttpContext.Current.Request.Params["search[regex]"] == "true"; } }
} 
```

AjaxTableColumn 类：

```
public class AjaxTableColumn<T>
{
    public Func<T, HelperResult> Th { get; set; }
    public Func<T, HelperResult> Td { get; set; }

    public Expression KeySelector { get; set; }     // typ: Expression<Func<T,?>>, typicky neco jako: (T t) => t.Key

    public Type KeyType { get; set; }
    public OrderDataDelegate OrderData { get; set; }
    public delegate IQueryable<T> OrderDataDelegate(IQueryable<T> data, bool asc);

} 
```

IAjaxTable 接口：

```
public interface IAjaxTable
{
    HelperResult GetTh(int column);
    string GetAjaxUrl();
    RouteValueDictionary GetAttrs();
    int GetColumnsCount();
    object DefaultAjaxAction();
} 
```

统一参数访问者：

```
public class UnifyParametersVisitor : ExpressionVisitor
{
    private IEnumerable<ParameterExpression> parameters;

    public Expression<TDel> UnifyParameters<TDel>(Expression<TDel> expression)
    {
        parameters = expression.Parameters;
        return (Expression<TDel>) Visit(expression);
    }

    protected override Expression VisitParameter(ParameterExpression node)
    {
        foreach (var param in parameters)
        {
            if (param.Name == node.Name)
            {
                return param;
            }
        }
        return base.VisitParameter(node);
    }
} 
```

用于创建 ajax 响应的控制器 - 想法：您必须通过 tableId 在会话中找到 AjaxTable 实例，然后返回 Json(ajaxTable.DefaultAjaxAction())。确保在用户注销时清除会话。

更新：今天我遇到了我的方法的一个限制：你不能在表格单元格中使用一些 html 助手（使用模板，渲染部分视图......），但它可以解决！您必须为每个 http 请求创建新的 htmlHelper 实例并使用它而不是标准的“Html”，例如使用这个 html 助手：

```
 public static HtmlHelper<object> CurrentHtml(this HtmlHelper html)
    {
        var ch = (HtmlHelper<object>)HttpContext.Current.Items["currentHtml"];
        if (ch == null)
        {
            var context = new HttpContextWrapper(HttpContext.Current);
            var routeData = new RouteData();
            routeData.Values["controller"] = "Home";    // you can use any controller here
            var controllerContext = new ControllerContext(new RequestContext(context, routeData), new HomeController());
            var view = ViewEngines.Engines.FindView(controllerContext, "Index", null);
            ch = new HtmlHelper<object>(new ViewContext(controllerContext, view.View, new ViewDataDictionary(), new TempDataDictionary(), TextWriter.Null), new ViewPage());
            HttpContext.Current.Items["currentHtml"] = ch;
        }
        return ch;
    } 
```

# regex - Visual Studio 用正则表达式查找和替换，用下划线替换空格

> ID：15966213
> 
> 赞同：1
> 
> 时间：2013-04-12T08:10:21.253
> 
> 标签：regex, visual-studio-2010, replace

我在 c# 中有一个很大的文本列表，想要用作枚举列表。例如：

```
Zone Status Message
Zones Snapshot Message
Partition Status Message
Partitions Snapshot Message
Supported transition message flags
System Status Message
X-10 Message Received
Log Event Message
Keypad Message Received 
```

现在我想使用 Visual Studio 中的查找和替换对话框在所有单词中添加下划线而不是空格，例如

```
Zone_Status_Message
Zones_Snapshot_Message 
```

如何使用正则表达式或通配符来实现这一点？这真的会为我节省很多时间。

提前致谢。

编辑：
由于我从中获取文本的源文档格式不正确，这些单词也可以有空格和前后。因此，只有在空格在 2 个单词之间时才应添加下划线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:12:14.023

如果您只想匹配字母数字单词之间的空格，请搜索`> <`并将全部替换为`_`.

在 VS 正则表达式（直到 2010 版）中，`>`表示“单词末尾的位置”和`<`“单词开头的位置”。

在 VS 2012 及更高版本中，该正则表达式可以写为`\b \b`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:37:40.263

在 VS 2010 中，要替换字母数字字符之间的空格，您可以使用

**查找** `{:a} {:a}`
**替换为的内容** `\1_\2`

确保`Use Regular expressions`选中。

**全部替换**

# php - 从 jQuery-ui 滑块中获取值

> ID：15966214
> 
> 赞同：-5
> 
> 时间：2013-04-12T08:10:25.097
> 
> 标签：php, jquery, jquery-ui

我使用了 jQuery UI 中的滑块。我创建了滑块，它工作正常。

现在我需要获取滑块的值并将其分配给一个变量，以便我可以将其保存在数据库中。

你能解释一下我该怎么做吗？

如何使用此变量将其保存到数据库（我使用 PHP）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:12:37.560

要获取滑块的值，您可以执行以下操作：

```
var val = $("#sliderID").slider("value"); 
```

检查[文档](http://api.jqueryui.com/slider/#method-value)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:12:24.667

尝试这个：

```
$("#slider").slider({
  value: 100,
  min: 0,
  max: 500,
  step: 50,
  slide: function (event, ui) {
    $("#amount").val("$" + ui.value);
  }
});
$("#amount").val("$" + $("#slider").slider("value")); 
```

[**在这里演示**](http://jsfiddle.net/2XNjq/)

# ios - CALayer & drawRect

> ID：15966219
> 
> 赞同：6
> 
> 时间：2013-04-12T08:10:38.510
> 
> 标签：ios, uiview, calayer

In [View and Window Architecture](http://developer.apple.com/library/ios/#documentation/windowsviews/conceptual/viewpg_iphoneos/WindowsandViews/WindowsandViews.html) is stated, quote:

*Views work in conjunction with Core Animation layers to handle the rendering and animating of a view’s content. Every view in UIKit **is backed by a layer object** (usually an instance of the CALayer class), which manages the backing store for the view and handles view-related animations.*

Farther in the "The View Drawing Cycle" section is stated:

*The UIView class uses an on-demand drawing model for presenting content. When a view first appears on the screen, the system asks it to draw its content. **The system captures a snapshot of this content** and uses that snapshot as the view’s visual representation.*

Does that mean, that the content drawn in a view in its drawRect method call, is captured in a snapshot in saved in its backing core animation layer?

If not, where do this content snapshot "reside"?

If not, does that mean that CALayer is used to render "static" content, content that doesn't change very often, and drawRect is used to render content that changes often, for example in a game app?

p.s.

The questions are not related to any particular code implementation.

I just want to understand the ios view-layer architecture.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-12T08:26:11.367

> Does that mean, that the content drawn in a view in its drawRect method call, is captured in a snapshot in saved in its backing core animation layer?

Yes. Everything uses layers under the hood. UIView's `-drawRect` will capture what you draw and (as far as I know) set the `content` on a sublayer of the view. It might even do this on the main layer object. That's where the 'snapshot' is saved.

> If not, does that mean that CALayer is used to render "static" content, content that doesn't change very often, and drawRect is used to render content that changes often, for example in a game app?

How often the content changes doesn't really affect the choice. There is not much difference in using drawRect vs. manually creating `CALayer`s. It depends on how you want to organize the sub-elements in your views, or if you want to create low level reusable layer objects without the details of `UIView` (e.g. `CATextLayer`). If you have various different sub-elements to draw then you may split them into different layers with their own custom drawing code. If you just have one simple piece of content to draw, you can do that all in a single `drawRect` implementation.

Having said this, you do need to be aware that each layer will end up being a separate GPU "element", so there can be performance benefits to reducing the number of layers you have, or using the `shouldRasterize`+`rasterizationScale` properties of a parent layer. This will take a snapshot of an entire layer hierarchy and create a single rasterized image to be rendered instead of n separate ones.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:18:33.447

> Does that mean, that the content drawn in a view in its drawRect method call, is captured in a snapshot in saved in its backing core animation layer?

Two words: "implementation details"

> If not, does that mean that CALayer is used to render "static" content, content that doesn't change very often, and drawRect is used to render content that changes often, for example in a game app?

Not exactly. Layers are very good at animating content (as hinted by the framework name Core *Animation*). drawRect is good for advanced drawing but can be to slow to redraw every frame (obviously depending on what your are drawing).

I didn't see any mention of [the Core Animation Programming Guide](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html) in your question. It is a good place to learn more about the layer part of views.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:29:37.367

Every UIView has an underlying CALayer (which is what actually gets rendered on the screen).

A CALayer is just a bitmap (holds pixels). When you call setNeedsDisplay to your view the CALayer gets marked for redrawing. At the end of the run loop, after events are processed, a CGContextRef gets created and the drawRect delegate gets called. You then draw things to the created context which then gets copied into the bitmap and ultimately composited with other layers to be displayed on the screen.

So yes, the "snapshot" is stored in the CALayer. This is just an optimization so that the layers don't have to redraw themselves unless they're flagged to be redrawn (with setNeedsDisplay).

# sorting - Python：对字典的值进行排序，其值是元组列表？

> ID：15966220
> 
> 赞同：0
> 
> 时间：2013-04-12T08:10:43.050
> 
> 标签：sorting, dictionary, tuples

我想对字典进行排序，其中我有一个字符串键，但我的值是元组列表。例如，假设我们有一个字典，其中每个人都映射到他们对不同学科的评分，其中 d.items() 将返回：

```
('Person':[("Math",5),("Chemistry",10),("History",2)]) 
```

有什么办法可以按字母顺序对每个键的值进行排序？例如，d['Person'] 现在会返回：

```
('Person':[(Chemistry",10),("History",2),("Math",5)]) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:17:22.210

我的解决方案：

```
arr = {
    'Person': [("Math",5),("Chemistry",10),("History",2)]
}

def customKey(a):
    return a[0]

for i in arr.keys():
    arr[i] = sorted(arr[i], key=customKey)

print arr 
```

# ruby-on-rails-3.1 - Rails - 如何对电子邮件使用“has_secure_password”技术

> ID：15966221
> 
> 赞同：0
> 
> 时间：2013-04-12T08:10:47.473
> 
> 标签：ruby-on-rails-3.1

Rails 3.1.0 - Ruby 1.8.6

我正在尝试创建一个注册页面。我遇到了这个“has_secure_password”，它基本上可以让你输入两次密码并检查它们是否正确。

我也想使用这种技术来检查电子邮件地址。如果不可能，我让用户输入他们的电子邮件两次并检查它们是否匹配的最简单方法是什么？

请帮忙。我是个铁轨菜鸟。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T07:25:46.680

Rails 有一个`validates_confirmation_of`内置的验证。如果你的模型有

```
class User < ActiveRecord::Base
   attr_accessor :email_confirmation
   validates_confirmation_of :email
end 
```

然后，您只需要在表单中添加一个电子邮件确认文本字段，rails 就会检查它们是否匹配。

# matlab - Matlab中的稀疏3D矩阵

> ID：15966222
> 
> 赞同：0
> 
> 时间：2013-04-12T08:10:55.897
> 
> 标签：matlab, matrix, 3d, sparse-matrix

我正在使用 Matlab。我有一个 3d rgb 直方图，它存储每个`(r, g, b)`值的像素数。3d 矩阵非常稀疏。有没有办法在 Matlab 中处理稀疏的 3d 矩阵？我将有义务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-11-08T08:03:44.760

您最初的问题不是很清楚，因此我对其进行了重新表述，以使其更易于理解、可搜索和有用。我现在正在回答您的问题，以便将其从未回答列表中删除。

众所周知，Matlab 不直接处理 3D 矩阵。一种解决方法是使用稀疏矩阵的元胞数组。

假设您要创建一个仅包含元素`(1, 1, 1)`and的稀疏矩阵，`(1, 3, 50)`并假设`A(1, 1, 1) = 1`and `A(1, 3, 10) = 54`。您可以执行以下操作：

```
mySp{1}  = sparse(3, 3);
mySp{10} = sparse(3, 3);

mySp{1}(1, 1) = 3;
mySp{10}(1, 3) = 54; 
```

这样，

```
>> mySp

mySp = 

    [3x3 double]    []    []    []    []    []    []    []    []    [3x3 double] 
```

可以看出，`mySp`是一个`10`元素数组。第一个和第十个元素是稀疏矩阵，而其他元素是空的。非空的第一个和第十个稀疏矩阵可以恢复为

```
temp1 = mySp{1};
temp2 = mySp{10}; 
```

返回

```
>> temp1

temp1 =

   (1,1)        3 
```

和

```
temp2 =

   (1,3)       54 
```

# java - Java ComponentResized - 检测用户是否调整了窗口大小或以编程方式调整了大小

> ID：15966223
> 
> 赞同：0
> 
> 时间：2013-04-12T08:11:00.240
> 
> 标签：java, swing, resize, componentlistener

我有一个 JFrame，我在其中删除和添加组件，每次执行此操作时，我都会相应地调整框架的大小。我添加了一个组件侦听器，但它当然是由用户调整窗口大小和我的 setSize() 方法触发的。
有什么方法可以从 ComponentEvent 中查看用户是否调整了窗口大小还是我通过 setSize() 进行了调整？
我找到的可能解决方案是：
1\. 使用一个标志 - 布尔调整大小 - 我在 setSize() 之前将其设置为 true，之后设置为 false。
2.添加mouseDragged监听器，比较拖动前后的大小。
第二个绝对不是一个好的选择。第一个可以工作，但我想知道我是否可以通过简单的方式找到用户是否是调整窗口大小的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T14:57:04.210

> 我相应地调整框架的大小

使用 pack() 有什么问题？

> 我删除和添加组件，每次我这样做，

那么这就是你应该设置布尔值的地方：

```
programResize == true:
panel.add(...);
frame.setSize(...); // this should cause the ComponentListener to fire
// the ComponentListener would then use programResize == false; 
```

或者更好的选择可能是：

```
component.removeComponentListener(...);
panel.add(...);
frame.setSize(...);
component.addComponentListener(...); 
```

我更喜欢这种方法，因为基于手动更新的所有逻辑都包含在一个地方，并且不需要定义布尔变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:50:30.157

> 有什么方法可以从 ComponentEvent 中查看用户是否调整了窗口大小还是我通过 setSize() 进行了调整？

是的，使用 Swing Timer 重置的布尔标志

*   在用户调整窗口大小的情况下，ComponentListener 每个像素触发一个新事件，一堆事件

*   通过确定 contianer set(Xxx)Size 这个事件是否只触发一次

关于来自 ComponentListner 的事件的示例

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.util.Vector;

public class ComponentEventDemo extends JPanel
        implements ComponentListener, HierarchyListener,
        ItemListener {

    private JFrame frame;
    private static final long serialVersionUID = 1L;
    private JTextArea display;
    private JLabel label;
    private JButton button = new JButton("Change Size");
    private String newline = "\n";

    public ComponentEventDemo() {
        display = new JTextArea();
        display.setEditable(false);
        JScrollPane scrollPane = new JScrollPane(display);
        scrollPane.setPreferredSize(new Dimension(350, 200));
        label = new JLabel("This is a label", JLabel.CENTER);
        label.addComponentListener(this);
        JCheckBox checkbox = new JCheckBox("Label visible", true);
        checkbox.addItemListener(this);
        checkbox.addComponentListener(this);
        button.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                Dimension dim = frame.getPreferredSize();
                if (!dim.equals(new Dimension(800, 600))) {
                    frame.setPreferredSize(new Dimension(800, 600));
                    frame.pack();
                } else {
                    frame.setPreferredSize(new Dimension(400, 300));
                    frame.pack();
                }
            }
        });
        JPanel panel = new JPanel(new GridLayout(1, 3));
        panel.add(label);
        panel.add(checkbox);
        panel.add(button);
        panel.addComponentListener(this);
        frame = new JFrame("ComponentEventDemo");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(scrollPane, BorderLayout.CENTER);
        frame.add(panel, BorderLayout.PAGE_END);
        frame.pack();
        frame.setVisible(true);
    }

    @Override
    public void itemStateChanged(ItemEvent e) {
        if (e.getStateChange() == ItemEvent.SELECTED) {
            label.setVisible(true);
            label.revalidate();
            label.repaint();
        } else {
            label.setVisible(false);
        }
    }

    protected void displayMessage(String message) {
        //If the text area is not yet realized, and
        //we tell it to draw text, it could cause
        //a text/AWT tree deadlock. Our solution is
        //to ensure that the text area is realized
        //before attempting to draw text.
        // if (display.isShowing()) {
        display.append(message + newline);
        display.setCaretPosition(display.getDocument().getLength());
        //}
    }

    @Override
    public void componentHidden(ComponentEvent e) {
        //displayMessage(e.getComponent().getClass().getName() + " --- Hidden");
    }

    @Override
    public void componentMoved(ComponentEvent e) {
        //displayMessage(e.getComponent().getClass().getName() + " --- Moved");
    }

    @Override
    public void componentResized(ComponentEvent e) {
        displayMessage(e.getComponent().getClass().getName() + " --- Resized ");
    }

    @Override
    public void componentShown(ComponentEvent e) {
        //displayMessage(e.getComponent().getClass().getName() + " --- Shown");
    }

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                ComponentEventDemo componentEventDemo = new ComponentEventDemo();
            }
        });
    }

    @Override
    public void hierarchyChanged(HierarchyEvent e) {
        displayMessage(e.getComponent().getClass().getName() + " --- Hierarchy changed");
    }
} 
```

# c++ - 保存调试状态以跳过长计算

> ID：15966228
> 
> 赞同：0
> 
> 时间：2013-04-12T08:11:21.013
> 
> 标签：c++, debugging, visual-studio-2012, save

我有一个 c++ 程序，它以库完成的“繁重”计算开始。在发布模式下大约需要 10 秒，但在调试模式下大约需要 15 分钟。所以，没有任何技巧，如果我想调试程序的其余部分，我必须浪费最初的时间。

一种可能的解决方案是在发布模式下保存计算结果并在调试模式下使用预处理器指令读取它们：

```
#ifdef _DEBUG
    read_result_from_file();
#else
    do_heavy_computation();
    save_result_to_file();
#endif 
```

但我想知道是否存在其他解决方案。例如，是否可以保存调试会话的状态，以便从第二次开始我可以在初始计算后开始调试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:29:21.357

许多 IDE 可以将不同的调试选项分配给不同的（子）项目/库，甚至分配给不同的翻译单元。如果你使用 make 和/或命令行编译器，你有类似的选项。因此，根据 IDE，您可以将繁重的设置计算放入其自己的库中，并始终在发布模式下编译该库（或 TU），除非您当然想调试计算本身。

这样，您可以调试程序的其他部分，但具有完全优化的计算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:35:25.697

您的长时间运行很可能（至少部分）是由于迭代器中的额外调试代码和 STL 中的相关函数。查看[迭代器调试](http://msdn.microsoft.com/en-us/library/vstudio/hh697468.aspx)的 MS 页面。

这可能不会花费您的 15 分钟到 10 秒，但它可能会将其缩短到比 15 分钟更接近 10 秒的时间。

# android - 安卓应用中的计费服务

> ID：15966229
> 
> 赞同：0
> 
> 时间：2013-04-12T08:11:26.250
> 
> 标签：android, google-play, in-app-billing

我编写了带有计费服务的应用程序，该应用程序在 Google Play 商店中。

今天，我想更新我的代码，但我在 gen 中有错误。

我删除了 gen ，我有这个错误：

IMarketBillingService.java 已被删除！重新创建 IMarketBillingService.java！

请帮我。怎么修？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:32:37.627

参考这个答案[https://stackoverflow.com/a/13563708/1441666](https://stackoverflow.com/a/13563708/1441666)

右键单击项目 -> 属性 -> Java 编译器到 1.6 -> 应用 -> 是，它将自动重建项目，这将解决上述问题。

你也可以试试这个选项

您可能会尝试使用默认编译选项。

*   右键单击（或按住 Control 单击）项目并选择“属性”

*   选择“Java 编译器”取消选中“启用项目特定设置”

*   Eclipse 会提示重新编译，应该没问题。

# python - python 一行将dict中列表的值保存到列表

> ID：15966231
> 
> 赞同：5
> 
> 时间：2013-04-12T08:11:39.790
> 
> 标签：python

我想在一行中写下 for 循环：

```
d = {'a': [1, 2, 3], 'b': [5, 6, 7], 'c': [9, 0]}

my_list = []
for k, v in d.items():
    for x in v:
        my_list.append(x) 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-12T08:13:03.610

```
>>> d = {'a': [1, 2, 3], 'b': [5, 6, 7], 'c': [9, 0]}
>>> [y for x in d.values() for y in x]
[1, 2, 3, 9, 0, 5, 6, 7] 
```

这是一个嵌套[列表推导](http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions)。为了展示它是如何工作的，你可以把它分成几行来查看它的结构作为嵌套`for`循环。它从左到右。

```
[y 
 for x in d.values() 
 for y in x] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:13:58.953

```
list(itertools.chain(*d.values())) 
```

正如@jamylak 建议的那样，以下方法可能更有效，因为它避免了`*`操作员完成的完全解包：

```
list(itertools.chain.from_iterable(d.values())) 
```

在 python 2.x 中，使用`.itervalues`代替`.values`, 以避免不必要的列表复制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T08:33:27.427

怎么样

```
ll = []
for l in d.values(): 
    ll.extend(u) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T08:25:09.073

使用运算符重载 -

```
sum(d.values(), []) 
```

# php - 如何在sql中同时使用插入、更新、删除查询？

> ID：15966239
> 
> 赞同：1
> 
> 时间：2013-04-12T08:12:03.180
> 
> 标签：php, mysql, sql

刚刚卡住了，如何在单个表单中使用多个查询来执行不同的查询。

例如：

![在此处输入图像描述](https://i.stack.imgur.com/YMISR.png) 如图所示，表 1 有记录。

我正在做的是：

从表 1 中提取前 3 条记录并以表单（前端）的形式显示，当此过程消失时..

我需要同时，这发生在没有刷新和没有用户数据或任何前端干扰的情况下。

一旦向用户查看此数据：

我需要：

同时，这 3 条记录从表 1 复制到表 2。如 Roll_no 和 Name。

然后，从表 1 中删除这 3 条记录。

我这样做是为了防止重复数据之类的。

所以任何代码都会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:22:37.513

您的问题很不清楚，但您似乎担心执行多个查询的数据完整性。您需要的是使用[事务](http://en.wikipedia.org/wiki/Database_transaction)将一组命令组合在一起。这样要么所有命令都会成功，要么您的数据库不会受到任何命令的影响。

# c# - 在 Parallel.foreach 中等待

> ID：15966240
> 
> 赞同：9
> 
> 时间：2013-04-12T08:12:06.400
> 
> 标签：c#, async-await, task-parallel-library, parallel.foreach

我有一个将在 Parallel.Foreach 中使用的异步方法。在异步方法中有等待任务。但是，在测试中，似乎没有等待行为，等待任务没有完成。有什么问题？下面是代码。

```
public void method1()
{
  Ilist<string> testList = new IList<string>(){"1","2","3"};
  Parallel.ForEach(testList, ()=>
  {
       method2();
  });
}
public async void method2()
{
   await Task.run(()=>{  some other codes here });  
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-01-06T17:33:09.257

回答晚了，但看起来您正在尝试并行执行 CPU 密集型工作，而不是异步执行 I/O 密集型工作。`Parallel.ForEach`正在照顾你的并行性，所以不需要Task.Run，​​并且`async`/`await`在这里没有任何收获。我建议从 method2 中删除这些位，因此整个事情简化为：

```
public void method1()
{
    Ilist<string> testList = new IList<string>(){"1","2","3"};
    Parallel.ForEach(testList, ()=>
    {
        method2();
    });
}
public void method2()
{
    // some other (plain old synchronous) code here
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T08:29:00.357

`void async`方法是“一劳永逸”，没有办法等待它们完成。在`method2`您的并行循环中调用时，它会立即返回，因此您的循环仅确保在`method2`循环完成之前创建任务。

您可以将返回类型更改`method2`为`Task`which 将允许您等待操作结果，例如

```
public async Task method()
{
     await Task.Run(() { some other code here });
} 
```

您可以在循环中等待

```
method2().Wait(); 
```

虽然这样做并不比`method2`直接在你的 foreach 委托中运行任务主体更好。

# javascript - 如何在 d3 JavaScript 库中设置拖动行为的 Origin (drag.origin)

> ID：15966256
> 
> 赞同：10
> 
> 时间：2013-04-12T08:12:45.293
> 
> 标签：javascript, d3.js, drag

我正在尝试使用 d3 框架为由 HTML 文本和背景矩形组成的组实现拖动行为。我能够让它工作，尽管当不设置 drag.origin 时，由于鼠标位置/元素坐标偏移，我可以看到明显的跳跃。[d3 wiki 页面](https://github.com/mbostock/d3/wiki/Drag-Behavior)上 的具体描述方式虽然该页面描述了如何设置拖动的 Origin，但我并没有正确理解如何在我的示例中实现它。我尝试了两种不同的方法：使用元素将元素组合在一起并定义新元素保持 tose。在第一种情况下，我必须使用翻译功能，我什至不知道如何获取组的坐标。

```
var svg = d3.select("body").append("svg")
  .attr("width", 960)
  .attr("height", 500);

var group = svg.append("svg:g")
  .attr("transform", "translate(10, 10)")
  .attr("id", "group");

var rect1 = group.append("svg:rect")
  .attr("rx", 6)
  .attr("ry", 6)
  .attr("x", 5/2)
  .attr("y", 5/2)
  .attr("id", "rect")
  .attr("width", 250)
  .attr("height", 125)
  .style("fill", 'white')
  .style("stroke", d3.scale.category20c())
  .style('stroke-width', 5);

var html1 = group.append("foreignObject")
  .attr("x", 50)
  .attr("y", 25)
  .attr("width", 200)
  .attr("height", 100)
  .attr("id", "fobject")
  .style("border-color", d3.scale.category20c())
  .append("xhtml:div")
  .style("font", "14px 'Helvetica Neue'")
  .html("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec eu enim quam.");

var innerSvg = svg.append("svg")
  .attr("x", 500)
  .attr("y", 10)
  .attr("id", "innerSvg");

var rect2 = innerSvg.append("svg:rect")
  .attr("rx", 6)
  .attr("ry", 6)
  .attr("x", 5/2)
  .attr("y", 5/2)
  .attr("id", "rect")
  .attr("width", 250)
  .attr("height", 125)
  .style("fill", 'white')
  .style("stroke", d3.scale.category20c())
  .style('stroke-width', 5);

var html2 = innerSvg.append("foreignObject")
  .attr("x", 50)
  .attr("y", 25)
  .attr("width", 200)
  .attr("height", 100)
  .attr("id", "fobject")
  .style("border-color", d3.scale.category20c())
  .append("xhtml:div")
  .style("font", "14px 'Helvetica Neue'")
  .html("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec eu enim quam.");

var drag1 = d3.behavior.drag()
    .on("drag", function(d,i) {
        d3.select(this).attr("transform", function(d,i){
            return "translate(" + [ d3.event.x,d3.event.y ] + ")"
        })
    });

var drag2 = d3.behavior.drag()
    .on("drag", function(d,i) {
        d3.select(this)
        .attr("x", d3.event.x)
        .attr("y", d3.event.y);
    });

group.call(drag1);
innerSvg.call(drag2); 
```

我将非常感谢任何解释，自然我在这里准备了一个工作示例：http: [//jsfiddle.net/Y8y7V/](http://jsfiddle.net/Y8y7V/)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-12T08:26:38.647

您只需要`origin()`相应地设置功能。在第二种情况下这很简单，在第一种情况下有点困难，因为您使用坐标和变换。基本模式（对于第二种情况）如下所示：

```
 .origin(function() { 
        var t = d3.select(this);
        return {x: t.attr("x"), y: t.attr("y")};
    }) 
```

[在这里](http://jsfiddle.net/Y8y7V/1/)更新了 jsfiddle 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-30T18:15:16.760

group 元素没有 x/y 属性 - 没问题！创建一个：

```
var node = svg.append("g")
            .attr('x',x_1)
            .attr('y',y_1)
            .attr("class","node")
            .attr("name","Node_A")
            .attr("transform","translate(" + x_1 + ", " + y_1 +")")
            .call(drag); 
```

什么时候，来自 Lars 的 .origin 函数将起作用

并且不要忘记在拖动时更新 x,y 属性：

```
function dragged() {

    d3.select(this).attr("transform","translate(" + d3.event.x + ", " + d3.event.y +")");
    d3.select(this).attr("x",d3.event.x);
    d3.select(this).attr("y",d3.event.y);
} 
```

# .net - 数据集 XML 序列化到内存流

> ID：15966257
> 
> 赞同：1
> 
> 时间：2013-04-12T08:12:47.310
> 
> 标签：.net, xml-serialization

我有一个强类型的 DataSet 和一个用 xsd.exe 生成的相应类。

我想通过 XML 序列化/反序列化将 DataSet 内容传递给匹配的类。

如果我使用类似的东西：

```
MyStronglyTypedDataSet ds = new MyStronglyTypedDataSet();
//... fill the dataset...
ds.WriteXml(@"C:\Temp\somedata.xml");

FileStream fs = new FileStream(@"C:\Temp\somedata.xml", FileMode.Open);
XmlSerializer serial = new XmlSerializer(typeof(MyDataSetMatchingClass));
MyDataSetMatchingClass myObj = (MyDataSetMatchingClass)serial.Deserialize(fs); 
```

一切正常，但我不想使用临时文件，所以我尝试了：

```
MyStronglyTypedDataSet ds = new MyStronglyTypedDataSet();
//... fill the dataset...
MemoryStream dump = new MemoryStream();
ds.WriteXml(dump);

XmlSerializer serial = new XmlSerializer(typeof(MyDataSetMatchingClass));
MyDataSetMatchingClass myObj = (MyDataSetMatchingClass)serial.Deserialize(dump); 
```

但是反序列化器抱怨缺少根 XML 节点。任何人都知道一种方法来告诉 XmlWriter 附加根节点，或反序列化器忽略丢失的根节点或任何其他解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:29:11.843

你没有倒带。这是一个非常常见的问题（请参阅[有多少种方式可以弄乱 IO？](http://marcgravell.blogspot.ie/2013/02/how-many-ways-can-you-mess-up-io.html) - 查找“在内存中缓冲数据时遇到的问题”）。放：

```
dump.Position = 0; 
```

在写入（序列化）和读取（反序列化）之间。

# jquery - 更改顶部 div 高度但低于项目不改变位置

> ID：15966264
> 
> 赞同：0
> 
> 时间：2013-04-12T08:12:59.797
> 
> 标签：jquery, css, html

有一些浮动 div 相互重叠。当用户将鼠标悬停在它们上面时，高度会随着 jQuery 命令增加：

```
 $(".concert").hover(function () {
        $(this).parent().find(".concert[opened='opened'] .concertbody").animate({ height: "0px" }, { duration: 400, queue: false });
        $(this).parent().find(".concert[opened='opened'] .concertHeader .middle").css("background-image", "url(Images/concert-header-back.png)");
        $(this).parent().find(".concert[opened='opened'] .concertbody").css("border", "none");
        $(this).parent().find(".concert[opened='opened'] .concertbody .concertDetails").css("visibility", "hidden");

        $(this).find(".concertbody").animate({ height: "276px" }, { duration: 400, queue: false });
        $(this).find(".concertHeader .middle").css("background-image", "url(Images/concert-header-back-hover.png)");
        $(this).find(".concertbody").css("border", "1px solid whitesmoke");
        $(this).find(".concertbody .concertDetails").css("visibility", "visible");
        $(this).parent().find(".concert[opened='opened']").removeAttr("opened");
        $(this).attr("opened", "opened");
    }); 
```

布局还可以，其他 div 下降，但是当我使用 firebug 并检查其他 div 标签时，位置没有改变。

页面的 Html ：

```
 <div class="parent">
                <div class="concert" id="ct1">
                    <div class="concertHeader">

                        <div class="middle">
                            <span class="concertName">کنسرت همایون شجریان</span>
                            <span class="concertCity">تهران</span>
                        </div>

                    </div>
                    <div class="concertbody">
                        <div class="concertDetails">

                            <span>محل دیدار : سالن همایش های بین المللی میلاد تهران</span>
                            <select class="test2">
                                 <option value="1">16:30</option>
                                <option value="2">18:50</option>
                            </select>
                            <select class="test">
                                 <option value="1">بیست و هشتم اردیبهت ماه نود و دو</option>
                                <option value="2">بیست و هشتم اردیبهت ماه نود و دو</option>
                                <option value="3">بیست و هشتم اردیبهت ماه نودو دو</option>
                            </select>

                        </div>
                    </div>
                </div>
                <div class="concert" id="ct2">
                    <div class="concertHeader">

                        <div class="middle">
                            <span class="concertName">کنسرت همایون شجریان</span>
                            <span class="concertCity">تهران</span>
                        </div>

                    </div>
                    <div class="concertbody">
                        <div class="concertDetails"></div>
                    </div>
                </div>
                <div class="concert" id="ct3">
                    <div class="concertHeader">

                        <div class="middle">
                            <span class="concertName">کنسرت همایون شجریان</span>
                            <span class="concertCity">تهران</span>
                        </div>

                    </div>
                    <div class="concertbody">
                        <div class="concertDetails"></div>
                    </div>
                </div>
                <div class="concert" id="ct4">
                    <div class="concertHeader">
                        <div class="middle">
                            <span class="concertName">کنسرت همایون شجریان</span>
                            <span class="concertCity">تهران</span>
                        </div>
                    </div>
                    <div class="concertbody">
                        <div class="concertDetails"></div>
                    </div>
                </div>
                <div class="concert" id="ct5">
                    <div class="concertHeader">
                        <div class="middle">
                            <span class="concertName">کنسرت همایون شجریان</span>
                            <span class="concertCity">تهران</span>
                        </div>

</div> 
```

和 CSS ：

```
.container {
    width: 972px;
    height: 532px;
    margin-right: auto;
    margin-left: auto;
    border: 1px solid white;
    border-radius: 5px;
}

.parent {
    width: 324px;
    height: 490px;
    float: right;
}

    .parent .concert {
        width: 324px;
        height: 40px;
        margin: 2px;
    }

.middle {
    --background-image:url("../Images/concert-header-back.png");
    background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2JmYmZiZiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlNWU1ZTUiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
    background: -moz-linear-gradient(top, rgba(191,191,191,1) 0%, rgba(229,229,229,1) 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(191,191,191,1)), color-stop(100%,rgba(229,229,229,1))); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, rgba(191,191,191,1) 0%,rgba(229,229,229,1) 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, rgba(191,191,191,1) 0%,rgba(229,229,229,1) 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top, rgba(191,191,191,1) 0%,rgba(229,229,229,1) 100%); /* IE10+ */
    background: linear-gradient(to bottom, rgba(191,191,191,1) 0%,rgba(229,229,229,1) 100%); /* W3C */
    width: 320px;
    height: 40px;
    float: right;
    border-radius: 5px;
}

.concertHeader:hover .middle {
    width: 320px;
    height: 40px;
    float: right;
}

.rightSide {
    background-image: url("../Images/concert-header-right-side.png");
    width: 5px;
    height: 40px;
    float: right;
}

.leftSide {
    background-image: url("../Images/concert-header-left-side.png");
    width: 5px;
    float: right;
    height: 40px;
}

.concertName, .concertCity {
    font-size: 8pt;
    color: Black;
    margin-top: 16px;
}

.concertName {
    width: 250px;
    display: inline-block;
    margin-right: 10px;
}

.concertCity {
    margin-right: 5px;
}

.concertbody {
    height: 0px;
    width: 318px;
    margin-right: 0px;
    margin-top: 1px;
    margin-bottom: 1px;
    border-radius: 5px;
} 
```

这个问题我该怎么办？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T09:38:20.277

`.parent .concert { width: 324px; margin: 2px; }`

[http://jsfiddle.net/yxMSz/](http://jsfiddle.net/yxMSz/)

你在 .parent .concert 上有一个固定的高度

如果需要，您可以添加一个最小高度。

# .net - 结合 WCF 服务

> ID：15966270
> 
> 赞同：0
> 
> 时间：2013-04-12T08:13:14.077
> 
> 标签：.net, wcf, c#-4.0

我有两个 WCF 服务。它们都有一对 Class.cs 和 IClass.cs 文件（类和接口）。

现在我想以某种方式创建一个新接口，它将继承最初两个接口的所有操作并将它们公开为一个。我可以用 C# (.NET 4.0) 做到这一点吗？

我读过一些关于 WCF 路由服务的内容。那是唯一的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T10:38:28.417

您可以通过实现可以拥有与服务一样多的[通道工厂](http://msdn.microsoft.com/en-us/library/ms576132.aspx)的类来做单个 wcf 客户端，但它会创建一个责任太大的沉重对象。

如果您只想要一个类来调用服务，您可以尝试创建[通用服务代理](http://philmunro.wordpress.com/2012/02/15/creating-a-wcf-service-proxy-with-channelfactory/)。使用示例：

```
using (var proxy = new ServiceProxy<IClass1>())
{
  proxy.Channel.Foo();
} 
```

# html - 在线留言： 对比 对比

> ID：15966272
> 
> 赞同：3
> 
> 时间：2013-04-12T08:13:18.327
> 
> 标签：html, semantics

我正忙着写一个在线聊天，虽然我使用哪一个并不重要，因为我可以用 CSS 为它们设置任何我想要的样式，我非常想使用最好的消息标签。

我的第一个想法是使用 an ，`<ol>`因为消息是*按时间排序的*。但是，Facebook 使用`<ul>`s，而 Google 聊天使用`<div>`s。Twitter 确实使用`<ol>`.

那么，哪个在语义上是正确的？而且，哪个最适合使用屏幕阅读器的用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:38:25.747

`div`只要。`<ul><ol>`是列表。聊天消息不是有序列表，很明显。如果您在每条消息附近不需要项目符号/点/其他标记 - 它们也不是无序列表。

同样使用`div`您不需要重置列表的默认样式=您将编写的 CSS 代码更少。

# c++ - 在 Visual C++ 和 Python 之间交换数据

> ID：15966273
> 
> 赞同：0
> 
> 时间：2013-04-12T08:13:20.843
> 
> 标签：c++, python, controls, pipe

这里的故事，

我有一个运行车辆模拟器的 Visual C++ 代码。模拟器以矢量形式捕获车辆的状态，并且可以从键盘或手动（通过代码）接收控制输入（例如转向角、踏板）。我的目标是自动化车辆控制，但是，我已经在 Python 中实现了控制类。

我想将车辆的状态从 C++ 代码输入到 python 类，其中完成了一些处理。然后，python 类应该输出相应的控制输入，以供 C++ 代码接收。

有没有简单的方法来实现这一目标？我读过类似的帖子，但对我来说都不清楚。

我想到的一种方法是使用文件，两个类都读取和写入文件，从中获取车辆状态和控制输入，但是，这可能会带来繁琐的同步问题！

流水线也是可行的，但看起来很复杂，除非你能提供一个很好的简单解决方案:) :)

底线是，我希望 C++ 类和 python 类在相互交换数据的同时同时运行。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:44:33.577

You can use [Boost::Python](http://www.boost.org/doc/libs/1_53_0/libs/python/doc/index.html) to wrap your C++ code.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:51:26.453

如果您需要同时运行这两个程序，那么没有简单的方法可以做到这一点，您必须在两个独立的进程之间实现异步通信机制。

实现此目的的一种方法是使用套接字。这样，如果需要，您的控制器和 C++ 应用程序可以在不同的机器上运行。

在 C++ 方面，您可以让您的应用程序围绕`boost::asio` 从 Python 控制应用程序读取消息并发送响应。请参阅：[提升 Asio](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio.html)

对于 python 方面，请参阅：[Python 套接字 HowTo](http://docs.python.org/2/howto/sockets.html)

笔记：

`boost::python`将允许您从 Python 调用 C++ 和从 C++ 调用 Python。

`SWIG`也可用于包装 C++ 类，以便可以从 Python 调用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:30:50.883

你能试试吗`ctypes`（[见这里](http://docs.python.org/2/library/ctypes.html)）？

要从 C++ 调用 python 中的东西，您可以使用[Python API](http://docs.python.org/2/c-api/intro.html)。

# php - 将服务器 MYSQL DB 转换为 SQLite DB

> ID：15966278
> 
> 赞同：0
> 
> 时间：2013-04-12T08:13:29.373
> 
> 标签：php, mysql, sqlite

我在服务器上有一个巨大的数据库，我需要 SQLite 中的数据库，以便我可以在我的 android 应用程序和 ios 应用程序中使用它。

当我转到 phpmyadmin 并在服务器上选择我的数据库时，我得到了一种解决方案，我将表一一导出到 CSV 文件中，然后将它们一一导入到我的 SQLite 浏览器中以获取所有表（然后更正列名和通过编辑每个表格列手动键入）。

通过这种方式，我将其作为 .sqlite 数据库在应用程序中使用。

但我想了解更多关于以下几点：

1.  他们是大多数开发人员用来将他们的数据库转换为 SQLite 数据库的某种后端应用程序。（如果是，那么他们使用什么样的东西）

2.  是他们的任何 PHP 脚本可以做这些事情。（如果是，那么使用什么脚本以及如何使用？）。

3.  他们是否有任何其他简单的方法来处理从服务器获取 SQLite DB 的问题。（如果是，那么有什么可能的方法来做到这一点？）。

任何人都可以让我对此有所了解吗？

# asp.net - 如何根据大小和日期从文件夹中删除文件

> ID：15966286
> 
> 赞同：3
> 
> 时间：2013-04-12T08:14:09.987
> 
> 标签：asp.net, file, directory

假设我在一个文件夹中有 4 个文件。昨天的 2 个文件（第一个文件 - 1 mb 第二个文件 - 2mb）和今天的 2 个文件（第一个文件 - 5 mb 第二个文件 - 10 mb）。

首先，我想检查每个文件的日期，据此，最小大小的文件将从文件夹中删除。

在我的代码中，我删除了所有具有最小大小的文件，但我想删除每天具有最小大小的文件。

这是我的代码：

```
private void DeleteFiles()
{
    var di = new DirectoryInfo("E:\\UploadFiles");
    var files = di.GetFiles().GroupBy(f => f.LastWriteTime.Date);

    foreach (var fileGrp in files)
    {
        var maxFile = fileGrp.Max(r => r.Length);
        foreach (FileInfo file in fileGrp.Where(r => r.Length < maxFile))
        {
            file.Delete();
        }
      }
    }
    protected void Button1_Click(object sender, EventArgs e)
    {
        this.DeleteFiles();
    } 
```

这段代码运行良好，首先我根据日期对文件进行分组，然后删除除最大文件之外的所有文件。现在我想要的是，如果同一日期有 4 个大小相同的文件，我想删除这些文件并根据时间只将其中一个存储在文件夹中。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-19T19:56:33.673

您如何按大小（从小到大）然后按最后写入时间（从旧到最新）对文件进行排序，然后删除直到只剩下一个（最大的，或者如果所有大小都相同，则为最新的）：

```
private void DeleteFiles()
{
    var di = new DirectoryInfo("E:\\UploadFiles");
    var files = di.GetFiles().GroupBy(f => f.LastWriteTime.Date);

    foreach (var fileGrp in files)
    {  
        int fileCount = fileGrp.Count();
        foreach (FileInfo f in fileGrp.OrderBy(a => a.Length).ThenBy(a => a.LastWriteTime))
        {
            if (fileCount > 1)
            {
                f.Delete();
                fileCount--;
            }
            else break;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-18T16:03:16.223

我认为应该这样做。在删除当天的文件后重新捕获文件，并删除除最新文件之外的所有文件：

```
private void DeleteFiles() {
    var di = new DirectoryInfo("E:\\UploadFiles");
    var files = di.GetFiles().GroupBy(f => f.LastWriteTime.Date);

    foreach (var fileGrp in files) {
        DateTime currentDay = fileGrp.First().LastWriteTime.Date;
        var maxFile = fileGrp.Max(r => r.Length);
        foreach (FileInfo file in fileGrp.Where(r => r.Length < maxFile)) {
            file.Delete();
        }
        var filesCurrentDay = di.GetFiles()
             .Where(f => f.LastWriteTime.Date == currentDay.Date);
        var maxFileTime = fileGrp.Max(r => r.LastWriteTime.ToFileTimeUtc());
        foreach (FileInfo file in filesCurrentDay 
                   .Where(r => r.LastWriteTime.ToFileTimeUtc() < maxFileTime)) {
           file.Delete();
        }
    }
    protected void Button1_Click(object sender, EventArgs e) {
        this.DeleteFiles();
    }
} 
```

上面固定为不按大小分组，最初有第二个按大小分组，您的要求不需要。

# c# - 扩展方法如何工作

> ID：15966287
> 
> 赞同：4
> 
> 时间：2013-04-12T08:14:11.923
> 
> 标签：c#, asp.net, extension-methods

我想了解扩展方法是如何工作的？我们可以在非静态类中定义扩展方法吗？

*

> 为什么我们将扩展方法放在静态类中？

*

根据 MSDN，

> **他们的第一个参数指定方法操作的类型，参数前面是this修饰符。仅当您使用 using 指令将命名空间显式导入源代码时，扩展方法才在范围内。
> 
> **

**这个**操作符在这里的作用是什么，它如何将该扩展方法与该参数相关联？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-12T08:16:12.447

不，您不能在非静态类上定义扩展方法。

这`this`是允许在实例上调用静态扩展方法的语法糖。但归根结底，扩展方法只不过是静态类中的静态方法。

所以基本上：

```
var test = myInstance.MyExtensionMethod(); 
```

是相同的

```
var test = MyExtensionClass.MyExtensionMethod(myInstance); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T08:26:06.573

> **这个**操作符在这里的作用是什么，它如何将该扩展方法与该参数相关联？

在这个上下文`this`中不是一个操作符，它是一个修饰符。`this`它可能被称为其他东西，它与在正常方法调用中引用当前对象的对象无关。

修饰符的作用是告诉编译器这实际上是一个扩展方法而不是一个标准的静态方法，这样当你以一种*看起来*`this`像实例方法调用的方式调用它时它不会报错，尽管它不是。

 ** * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-12T08:22:10.860

它们是方法成为扩展方法的 4 个要求：

*   它必须在静态类中声明
*   它必须是静态的（如果遇到第一个，这实际上总是正确的）
*   必须公开
*   它必须有第一个参数用`this`关键字标记

所以你不能在非静态类中定义扩展方法。

整个扩展方法功能是某种语法糖。以下扩展方法声明于`MyClass`：

```
// The following extension methods can be accessed by instances of any  
// class that is or inherits MyClass. 
public static class Extension
{
    public static void MethodA(this MyClass myInterface, int i)
    {
        Console.WriteLine
            ("Extension.MethodA(this IMyInterface myInterface, int i)");
    }
} 
```

可以通过两种方式调用：

```
var myClassObject = new MyClass();

Extension.MethodA(myClassObject); 
```

或者

```
myClassObject.MethodA(); 
```

但是，无论如何，第二个将由编译器转换为第一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-12T08:24:30.677

不，扩展方法必须在静态类中，这只是规则。允许在任何地方定义扩展方法是可能的，但为了更容易找到它们，不允许将它们埋在具有许多其他代码的类中。

关键字用于扩展方法的`this`第一个参数，以指定它是扩展方法。

（常规方法的内部实现也将对象的引用作为第一个参数，因此编译器对扩展方法所做的只是将它们添加到类中的其他方法中。）*

# javascript - 在下拉更改事件中在 dhtmlx 调度程序中设置自定义时间

> ID：15966297
> 
> 赞同：1
> 
> 时间：2013-04-12T08:14:39.973
> 
> 标签：javascript, scheduler, dhtmlx

我正在使用 dhtmlx 调度程序。我想在灯箱中的选择框更改事件上设置自定义时间。例如。我在下拉列表中有服务，并为每个服务分配了特定时间。所以在更改此下拉列表时我想分配一次。

我也想隐藏一个时间部分。如果我隐藏时间部分，它会显示时间和日期的未捕获错误。

请帮我解决这个问题。以下是我的代码的网址

[http://pastebin.com/mjuHRCR3](http://pastebin.com/mjuHRCR3)

我附上了相同 [http://i.stack.imgur.com/sXapk.png的屏幕截图](http://i.stack.imgur.com/sXapk.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-07T10:46:58.697

选择控件的配置可以具有**onchange**属性，您可以在那里为选择框分配 onchange 处理程序

```
{..., type:"select", onchange:function(e) {} }, 
```

可以使用设置灯箱值**scheduler.formSection**方法 设置灯箱值[http://docs.dhtmlx.com/scheduler/api__scheduler_formsection.html](http://docs.dhtmlx.com/scheduler/api__scheduler_formsection.html)

> 我也想隐藏一个时间部分。如果我隐藏时间部分，则显示时间和日期未捕获的错误。

如果您的日期选择器控件为事件设置了正确的日期值，则缺少时间段控件不会导致任何错误。您可以设置使用**map_to:"auto"**选项，并在 datepicker 控件的**get_values**方法中分配所有值。类似于此示例中的操作方式 [http://docs.dhtmlx.com/scheduler/custom_lightbox_editor.html#example](http://docs.dhtmlx.com/scheduler/custom_lightbox_editor.html#example)

# ios - Phonegap 2.2.0 iOS文件传输错误代码2

> ID：15966298
> 
> 赞同：1
> 
> 时间：2013-04-12T08:14:41.720
> 
> 标签：ios, xcode, html, cordova

```
saricsarda2[326:15b03] Multi-tasking -> Device: YES, App: YES
saricsarda2[326:15b03] -[CDVFileTransfer download:] [Line 313] File Transfer downloading file...
saricsarda2[326:15b03] File Transfer Finished with response code 200
saricsarda2[326:15b03] -[CDVFileTransferDelegate connectionDidFinishLoading:] [Line 437] Write file file:///Users/Pannako/Library/Application%20Support/iPhone%20Simulator/6.1/Applications/954E4293-9125-43B0-91F4-811C51291CCC/saricsarda2.app/www/data.json
saricsarda2[326:15b03] FileTransferError {
    code = 2;
    "http_status" = 200;
    source = "http://gastromania.hu/images/restaurants/214/mobile/data.json";
    target = "file:///Users/Pannako/Library/Application%20Support/iPhone%20Simulator/6.1/Applications/954E4293-9125-43B0-91F4-811C51291CCC/saricsarda2.app/www/data.json";
}
saricsarda2[326:15b03] [LOG] Phonegap - download error source http://gastromania.hu/images/restaurants/214/mobile/data.json
saricsarda2[326:15b03] [LOG] Phonegap - download error target file:///Users/Pannako/Library/Application%20Support/iPhone%20Simulator/6.1/Applications/954E4293-9125-43B0-91F4-811C51291CCC/saricsarda2.app/www/data.json
saricsarda2[326:15b03] [LOG] Phonegap - upload error code2 
```

这有什么问题？我试图在互联网上找到一些信息，有点我找不到任何东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:31:27.343

在这一行：

```
target = "file:///Users/Pannako/Library/Application%20Support/iPhone%20Simulator/6.1/Applications/954E4293-9125-43B0-91F4-811C51291CCC/saricsarda2.app/www/data.json"; 
```

您正在尝试在应用程序文件夹中写入，但这是不允许的，您应该将信息保存到 de Documents 文件夹中，在[另一个问题](https://stackoverflow.com/questions/10945375/phonegap-ios-how-to-get-app-documents-folder-full-path)中，您可以看到如何获取对它的引用，然后更改：

```
file:///Users/Pannako/Library/Application%20Support/iPhone%20Simulator/6.1/Applications/954E4293-9125-43B0-91F4-811C51291CCC/saricsarda2.app 
```

带有 Documents 目录的路径

# visual-studio-2010 - 尝试在 Visual Studio 2010 中运行经典 ASP 网站时出错

> ID：15966305
> 
> 赞同：2
> 
> 时间：2013-04-12T08:15:06.020
> 
> 标签：visual-studio-2010, iis, asp-classic

我有一个通过 IIS 部署的经典 ASP 网站。我从 Visual Studio 2010 中的同一位置打开该网站（为了调试，按照[此处](http://www.codeproject.com/Articles/28792/Debugging-Classic-ASP-VBScript-in-Visual-Studio-20)提到的步骤 问题是，当我在 Visual Studio 中按 F5 时，它给我一个错误说“你的服务器不支持调试 asp net 或 atl..." 我可以从 IIS 浏览该站点，但我想在 Visual Studio 中打开它以调试它。这个问题的可能原因和解决方案可能是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T04:11:21.507

F5 对经典 ASP 站点没有任何好处（f5 将尝试编译一个 .NET 站点然后访问它）。

我将假设您正在尝试在运行站点的同一台机器上调试站点。使用 Visual Studio.NET 调试“经典”ASP 的方式是附加到运行站点的进程。最简单的方法是使用*即时 (JIT)*功能：在代码中插入一条`stop`语句（`debugger`在 jscript 中）——点击该行应启动服务器端“遇到“脚本调试”类型的错误。做你要调试吗？” 对话框，提供可用调试器的建议。

试试这个并报告发生了什么 - 配置该机器可能需要一些额外的步骤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:22:09.320

您使用的是 IIS 7 吗？如果是这样，您应该选择服务器选项“启用服务器端调试”......它应该在站点的属性窗口中，使用 IIS 管理控制台。一旦你这样做了，当你通过 Visual Studio 运行服务器时，它应该使用相关代码打开另一个调试模式的解决方案。

# sqlite - SVN - SQLite - 磁盘 I/O 错误

> ID：15966308
> 
> 赞同：6
> 
> 时间：2013-04-12T08:15:17.090
> 
> 标签：sqlite, svn

尝试提交到我的 SVN 存储库时，出现以下错误：

```
Working copy 'Z:\prace-pj\projects\other\CopyRT' locked. 
```

所以我运行`clean up`命令然后提交成功，但是在响应消息的末尾，出现以下错误：

```
Error bumping revisions post-commit (details follow): 
disk I/O error, executing statement 'RELEASE   s11' 
```

现在，当我尝试更新存储库时，它说它仍然被锁定。当我清理并尝试再次更新时，我收到如下错误：

```
disk I/O error, executing statement 'RELEASE   s2'
sqlite: disk I/O error 
```

我应该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-13T09:03:48.653

供其他人参考，我刚刚遇到同样的错误，发现我的一个日志文件占用了我所有的空间（并且由于没有可用空间而无法写入硬盘）。

运行（以确保您有足够的磁盘空间）

```
df -h 
```

然后我只需要运行：

```
svn cleanup 
```

这为我解决了错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T03:55:06.833

你有没有尝试过：

```
svn unlock --force path/to/workingcopy 
```

? 如果问题出在存储库本身，似乎它可以指向一个 url...我之前只通过 tortoise gui 使用过解锁操作，但我认为它只是包装了 svn 命令。

希望有帮助

# php - GD 图像调整大小不起作用 PHP

> ID：15966311
> 
> 赞同：0
> 
> 时间：2013-04-12T08:15:19.767
> 
> 标签：php, gd, thumbnails

我有以下代码：

```
$biggest = ($width > $height) ? $width : $height;
    $newWidth = 0;
    $newHeight = 0;

    if($biggest > $divSize){
        echo "BIGGEST<br />";
        $scale = $divSize/$biggest;
        $newWidth = floor($width * $scale);
        $newHeight = floor($height * $scale);
    } else if($biggest < $divSize){
        echo "DIVSIZE<br />";
        $scale = $biggest/$divSize;
        $newWidth = floor($width * $scale);
        $newHeight = floor($height * $scale);
    } 

    echo "SCALE: ".$scale."<br />";
    echo "BIGGEST: ".$biggest."<br />";
    echo "WIDTH: ".$width."<br />";
    echo "HEIGHT: ".$height."<br />";
    echo "NEWWIDTH: ".$newWidth."<br />";
    echo "NEWHEIGHT: ".$newHeight."<br />";

    $sourceImage = imagecreatefromstring(file_get_contents($fileName)); 
    $thumb = imagecreatetruecolor($newWidth, $newHeight);           
    imagecopyresampled($thumb, $sourceImage, 0, 0, 0, 0, $newWidth, $newHeight, $width, $height);
    imagedestroy($sourceImage); 
```

这段代码适用于某些图像，但不适用于所有图像。

我有一个尺寸为 64 x 64 的 div。

对于某些图像，它们可以完美缩放，但对于某些图像，输出图像的高度也是 64 像素，例如 32 像素。

我不知道是什么导致了这个问题。

如果您需要更多信息，请询问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T22:03:31.497

您的功能很好，但有时您的图像应该具有静态大小（这可以避免破坏某些网页的设计）。

在这种情况下，您可以使用此功能。它调整图像大小以适应定义的宽度/高度，如果图像与所需缩略图的比例不同，则将未使用的可用空间设置为透明。

```
function resizePreservingAspectRatio($img, $targetWidth, $targetHeight)
{
    $srcWidth = imagesx($img);
    $srcHeight = imagesy($img);

    // Determine new width / height preserving aspect ratio
    $srcRatio = $srcWidth / $srcHeight;
    $targetRatio = $targetWidth / $targetHeight;
    if (($srcWidth <= $targetWidth) && ($srcHeight <= $targetHeight))
    {
        $imgTargetWidth = $srcWidth;
        $imgTargetHeight = $srcHeight;
    }
    else if ($targetRatio > $srcRatio)
    {
        $imgTargetWidth = (int) ($targetHeight * $srcRatio);
        $imgTargetHeight = $targetHeight;
    }
    else
    {
        $imgTargetWidth = $targetWidth;
        $imgTargetHeight = (int) ($targetWidth / $srcRatio);
    }

    // Creating new image with desired size
    $targetImg = imagecreatetruecolor($targetWidth, $targetHeight);

    // Add transparency if your reduced image does not fit with the new size
    $targetTransparent = imagecolorallocate($targetImg, 255, 0, 255);
    imagefill($targetImg, 0, 0, $targetTransparent);
    imagecolortransparent($targetImg, $targetTransparent);

    // Copies image, centered to the new one (if it does not fit to it)
    imagecopyresampled(
       $targetImg, $img, ($targetWidth - $imgTargetWidth) / 2, // centered
       ($targetHeight - $imgTargetHeight) / 2, // centered
       0, 0, $imgTargetWidth, $imgTargetHeight, $srcWidth, $srcHeight
    );

    return $targetImg;
} 
```

用法示例：

```
$gd = imagecreatefromjpeg("images/image5.jpg");
$resized = resizePreservingAspectRatio($gd, 100, 100);
header("Content-type: image/png");
imagepng($resized); 
```

这个图片 ：

![在此处输入图像描述](https://i.stack.imgur.com/MAOww.jpg)

变成：

![在此处输入图像描述](https://i.stack.imgur.com/PngWu.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:13:02.570

没关系。

我自己想通了。

我简化了缩放缩略图的代码：

```
$biggest = ($width > $height) ? $width : $height;
$newWidth = 0;
$newHeight = 0;
$scale = ($biggest >= $thumbSize) ? $thumbSize/$biggest : $biggest/$thumbSize;

$newWidth = floor($width * $scale);
$newHeight = floor($height * $scale);       

$sourceImage = imagecreatefromstring(file_get_contents($fileName)); 
$thumb = imagecreatetruecolor($newWidth, $newHeight);           
imagecopyresampled($thumb, $sourceImage, 0, 0, 0, 0, $newWidth, $newHeight, $width, $height);
imagedestroy($sourceImage); 
```

也许有人可以使用这个。

# mysql - mysql中的select语句

> ID：15966314
> 
> 赞同：1
> 
> 时间：2013-04-12T08:15:24.243
> 
> 标签：mysql

我创建了 2 个外键为“skuCode”的表 我的选择语句应该从联合表中检索数据。但我无法从 productDetails 表中检索数据。

下面是表格：

```
CREATE TABLE productItem (
skuCode VARCHAR(8),
productName VARCHAR(32),
productDesc VARCHAR(128),
unitPrice DECIMAL(18,4),
qty INT,
size CHAR(1),
bigImage1 VARCHAR(32),
smallImage2 VARCHAR(32) DEFAULT NULL,
category VARCHAR(32),
PRIMARY KEY (skuCode)
 ) ENGINE INNODB;

CREATE TABLE productDetails (
detailsId INT AUTO_INCREMENT,
skuCode VARCHAR(8),
status VARCHAR(32),
line1 VARCHAR(128) DEFAULT NULL,
line2 VARCHAR(128) DEFAULT NULL,
line3 VARCHAR(128) DEFAULT NULL,
line4 VARCHAR(128) DEFAULT NULL,
line5 VARCHAR(128) DEFAULT NULL,
line6 VARCHAR(128) DEFAULT NULL,
line7 VARCHAR(128) DEFAULT NULL,
line8 VARCHAR(128) DEFAULT NULL,
line9 VARCHAR(128) DEFAULT NULL,
line10 VARCHAR(128) DEFAULT NULL,
PRIMARY KEY (detailsId),
FOREIGN KEY (skuCode) REFERENCES productItem (skuCode)
  ) ENGINE INNODB; 
```

下面是我的 SELECT 语句：

```
 $sql = "SELECT productItem.productDesc, productItem.skuCode, productItem.unitPrice, productDetails.line1 FROM productItem, productDetails WHERE productItem.skuCode = productDetails.skuCode ='".mysql_real_escape_string($_GET["skuCode"])."';"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:17:01.700

尝试这个：

```
SELECT 
   productItem.productDesc, 
   productItem.skuCode, 
   productItem.unitPrice, 
   productDetails.line1 
FROM 
  productItem
INNER JOIN productDetails 
  ON productItem.skuCode = productDetails.skuCode 
WHERE productItem.skuCode ='".mysql_real_escape_string($_GET["skuCode"])."' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:21:42.090

我建议使用 INNER JOIN：

```
SELECT productItem.productDesc, productItem.skuCode, productItem.unitPrice, productDetails.line1
FROM productItem INNER JOIN productDetails ON productItem.skuCode = productDetails.skuCode
WHERE productDetails.skuCode = '".mysql_real_escape_string($_GET["skuCode"])."' 
```

但是，如果您更喜欢使用 WHERE 连接表：

```
SELECT productItem.productDesc, productItem.skuCode, productItem.unitPrice, productDetails.line1
FROM productItem, productDetails WHERE productItem.skuCode = productDetails.skuCode
AND productDetails.skuCode = '".mysql_real_escape_string($_GET["skuCode"])."' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:22:04.290

```
 $sql = "SELECT 
   productItem.productDesc, 
   productItem.skuCode, 
   productItem.unitPrice,
   productDetails.line1 
FROM 
productItem JOIN 
 productDetails ON productItem.skuCode = productDetails.skuCode WHERE productItem.skuCode = '".mysql_real_escape_string($_REQUEST['skuCode'])."'"; 
```

尝试上面的代码，这将给出正确的结果。`$_GET['skuCode']`并且还检查通过 echo it的值是什么。您可以使用 $_REQUEST 而不是 $_GET。

# windows - Windows批处理结合咖啡脚本，复制和丑化

> ID：15966316
> 
> 赞同：1
> 
> 时间：2013-04-12T08:15:34.427
> 
> 标签：windows, command-line, batch-file, coffeescript

所以我试图编写一个很好的批处理文件来组合我的 javascript 库，组合和编译我的 .coffee 文件，组合这两个结果，然后用丑陋的方法缩小它。但是我的批处理文件遇到了一些问题；在我的咖啡命令之后，批处理文件停止运行。我没有收到任何错误或其他东西。

这是我的文件结构

```
batch.bat
src/
     coffee/
             1.coffee
             2.coffee
     js/
             1.js
             2.js 
```

这是我的批处理文件的内容

```
mkdir temp
coffee --output temp --join coffee.js --compile src\coffee
copy /b src\js temp\javascript.js
copy /b temp\javascript.js+temp\coffee.js temp\min.js
uglifyjs -o  javascript.js temp\min.js 
```

正如我所说，当我从控制台运行它时，mkdir 命令被执行，咖啡脚本运行并完成，然后批处理就停止了。我手动测试了这些命令，并且这些命令本身就像我期望的那样工作。

这是我在控制台中看到的结果：

```
C:\User>mkdir temp
C:\User>coffee --output temp --join coffee.js --compile src\coffee
C:\User>_ 
```

我的想法是，咖啡命令可能异步运行，而复制命令找不到要组合的所需文件，然后由于缺少文件而无法执行其他命令。到目前为止我还没有找到解决这个问题的方法..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T09:02:22.317

关键在于你的术语——咖啡——`SCRIPT`

因为它显然是一个 BATCH 文件，所以你需要`CALL`它

```
mkdir temp
CALL coffee --output temp --join coffee.js --compile src\coffee
copy /b src\js temp\javascript.js
copy /b temp\javascript.js+temp\coffee.js temp\min.js
uglifyjs -o  javascript.js temp\min.js 
```

如果你愿意，你也可以`CALL`这样`UGLIFYJS`做——但因为它是最后一个命令，所以没有什么区别。

CALL 设置返回位置以在脚本完成时恢复处理。

# .net - 在 VS 2010 中编辑源时如何停止在 tfs 中自动签出

> ID：15966318
> 
> 赞同：2
> 
> 时间：2013-04-12T08:15:49.673
> 
> 标签：.net, version-control

我是 tfs 的新手。我正在通过右键单击签出文件并在解决方案资源管理器中签出。但是，如果尝试更改任何文件，它会自动签出。如何防止这种情况？

我需要将锁定类型设置为**阻止其他用户签入和签出**

如何做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-12T08:21:47.100

VS->Tools>Options>在options下选择Source Control。在源代码管理下选择环境。现在在签入项目下->编辑->选择注意

![在此处输入图像描述](https://i.stack.imgur.com/0C98e.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:19:35.513

工具 | 中有一个设置 选项 | 源代码管理 | 控制自动检出已编辑文件的环境

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:20:37.930

在 Windows 资源管理器中找到该文件，并通过关闭只读标志来修改它的属性。

不建议这样做，因为 Visual Studio 不会阻止您修改文件，也不会在您执行代码签入时将其签入。

Visual Studio 检测文件更改的一种方法是，当您的 TFS 连接从脱机状态变为联机时，向导运行以查找解决方案中的非只读文件，然后将这些文件标记为已签出。

# wpf - 使用 datatemplate 将 viewmodel 的集合绑定到 tabcontrol

> ID：15966325
> 
> 赞同：0
> 
> 时间：2013-04-12T08:16:25.587
> 
> 标签：wpf, data-binding, tabcontrol, infragistics

我面临标签控件绑定到视图模型集合的问题，类似于[这篇文章](http://www.infragistics.com/community/forums/p/37015/400076.aspx)

```
<Window.Resources>
  <ViewModel:MainViewModel x:Key="MainViewModel" />
  <DataTemplate DataType="{x:Type local:Foo1}">
    <local:UserControl1 />
  </DataTemplate>
  <DataTemplate DataType="{x:Type local:Foo2}">
    <local:UserControl2 />
  </DataTemplate>
  <DataTemplate DataType="{x:Type local:Foo3}">
    <local:UserControl3 />
  </DataTemplate>
</Window.Resources>
<igDock:XamDockManager x:Name="dm">
  <igDock:XamDockManager.Panes>
    <igDock:SplitPane>
      <igDock:ContentPane>
        <ContentControl>
          <local:Foo />
        </ContentControl>
      </igDock:ContentPane>
    </igDock:SplitPane>
  </igDock:XamDockManager.Panes>
</igDock:XamDockManager>
<DockPanel>
  <igDock:XamDockManager x:Name="dockManager">
    <igDock:TabGroupPane DataContext="{StaticResource ResourceKey=MainViewModel}"
                         SelectedIndex="{Binding SelectedTabIndex}">
      <igExtensions:ContentPaneFactory.PaneFactory>
        <igExtensions:ContentPaneFactory ItemsSource="{Binding TabCollection}"
                                         HeaderPath="Title"
                                         ContentPath="." />
      </igExtensions:ContentPaneFactory.PaneFactory>
    </igDock:TabGroupPane>
  </igDock:XamDockManager>
</DockPanel> 
```

但正如上面文章中提到的，我看到视图模型被构建了两次。当我尝试填充可观察选项卡集合时，首先在 MainViewModel 中，当我尝试导航到 tabitem 时。

我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-27T06:12:54.783

我相信这个问题已经在您链接的 Infragistics 论坛主题中得到了回答。

如果您还有其他问题，我建议您在 IG 论坛中提问，因为您可以从 IG 专家那里得到答案。

# hibernate - EJBException：bean 遇到了非应用程序异常

> ID：15966327
> 
> 赞同：3
> 
> 时间：2013-04-12T08:16:40.160
> 
> 标签：hibernate, junit, hsqldb, openejb

我有这个东西的股票。除了这个，我所有的单元测试都运行良好。我已经有一个豆子：

```
@Entity
@Table(name = "tbl_place", uniqueConstraints = @UniqueConstraint(columnNames = "manager_id"))
public class PlaceBean implements java.io.Serializable {

    @Id
    @GeneratedValue(strategy = IDENTITY)
    @Column(name = "place_id", unique = true, nullable = false)
    public Integer getPlaceId() {
       return this.placeId;
    }

    public void setPlaceId(Integer placeId) {
       this.placeId = palceId;
    }
........
} 
```

然后我有道。然后在我的测试中，我这样做了......

```
@EJB
private MyDao myDao;

@Test
public void testSomething(){
PlaceBean placeBean = new PlaceBean();
    placeBean.setOwnerId(1);
    placeBean.setCategoryId(1);
    placeBean.setProfile("world");

    myDao.makePersistent(placeBean);
    assertNotNull(placeBean);
} 
```

findAll() 没有问题。唯一的问题是插入时。我正在使用 HSQL 进行单元测试。我可以说我的配置没问题，因为其他测试工作正常。

在对此进行单元测试时，这是跟踪：

```
 javax.ejb.EJBException: The bean encountered a non-application exception; nested exception is: 
        org.hibernate.exception.SQLGrammarException: could not prepare statement
        at org.apache.openejb.core.ivm.BaseEjbProxyHandler.convertException(BaseEjbProxyHandler.java:363)
        at org.apache.openejb.core.ivm.BaseEjbProxyHandler.invoke(BaseEjbProxyHandler.java:283)
        at $Proxy62.makePersistent(Unknown Source)
        at com.sprasia.rest.dao.nstudio.MyDaoTest.testSomething(MyDaoTest.java:63)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
        at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
        at org.junit.runners.BlockJUnit4ClassRunner.runNotIgnored(BlockJUnit4ClassRunner.java:79)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:71)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
        at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
        at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)
        at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
        at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
        at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
        at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
        at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
        at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
        at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
    Caused by: org.hibernate.exception.SQLGrammarException: could not prepare statement
        at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:82)
        at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:49)
        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:125)
        at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:188)
        at org.hibernate.engine.jdbc.internal.StatementPreparerImpl.prepareStatement(StatementPreparerImpl.java:117)
        at org.hibernate.id.IdentityGenerator$GetGeneratedKeysDelegate.prepare(IdentityGenerator.java:89)
        at org.hibernate.id.insert.AbstractReturningDelegate.performInsert(AbstractReturningDelegate.java:55)
        at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2966)
        at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:3477)
        at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:81)
        at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:362)
        at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:203)
        at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:183)
        at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:167)
        at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:321)
        at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:286)
        at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:192)
        at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:125)
        at org.hibernate.ejb.event.EJB3SaveOrUpdateEventListener.saveWithGeneratedId(EJB3SaveOrUpdateEventListener.java:71)
        at org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.saveWithGeneratedOrRequestedId(DefaultSaveOrUpdateEventListener.java:204)
        at org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.entityIsTransient(DefaultSaveOrUpdateEventListener.java:189)
        at org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.performSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:114)
        at org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:90)
        at org.hibernate.internal.SessionImpl.fireSaveOrUpdate(SessionImpl.java:734)
        at org.hibernate.internal.SessionImpl.saveOrUpdate(SessionImpl.java:726)
        at org.hibernate.internal.SessionImpl.saveOrUpdate(SessionImpl.java:722)
        at com.sprasia.rest.dao.GenericHbDao.makePersistent(GenericHbDao.java:75)
        at com.sprasia.rest.dao.impl.nstudio.MyDaoImpl.makePersistent(MyDaoImpl.java:1)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at org.apache.openejb.core.interceptor.ReflectionInvocationContext$Invocation.invoke(ReflectionInvocationContext.java:181)
        at org.apache.openejb.core.interceptor.ReflectionInvocationContext.proceed(ReflectionInvocationContext.java:163)
        at org.apache.openejb.cdi.CdiInterceptor.invoke(CdiInterceptor.java:128)
        at org.apache.openejb.cdi.CdiInterceptor.access$000(CdiInterceptor.java:43)
        at org.apache.openejb.cdi.CdiInterceptor$1.call(CdiInterceptor.java:64)
        at org.apache.openejb.cdi.CdiInterceptor.aroundInvoke(CdiInterceptor.java:70)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at org.apache.openejb.core.interceptor.ReflectionInvocationContext$Invocation.invoke(ReflectionInvocationContext.java:181)
        at org.apache.openejb.core.interceptor.ReflectionInvocationContext.proceed(ReflectionInvocationContext.java:163)
        at org.apache.openejb.monitoring.StatsInterceptor.record(StatsInterceptor.java:176)
        at org.apache.openejb.monitoring.StatsInterceptor.invoke(StatsInterceptor.java:95)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at org.apache.openejb.core.interceptor.ReflectionInvocationContext$Invocation.invoke(ReflectionInvocationContext.java:181)
        at org.apache.openejb.core.interceptor.ReflectionInvocationContext.proceed(ReflectionInvocationContext.java:163)
        at org.apache.openejb.core.interceptor.InterceptorStack.invoke(InterceptorStack.java:138)
        at org.apache.openejb.core.stateless.StatelessContainer._invoke(StatelessContainer.java:237)
        at org.apache.openejb.core.stateless.StatelessContainer.invoke(StatelessContainer.java:189)
        at org.apache.openejb.core.ivm.EjbObjectProxyHandler.synchronizedBusinessMethod(EjbObjectProxyHandler.java:253)
        at org.apache.openejb.core.ivm.EjbObjectProxyHandler.businessMethod(EjbObjectProxyHandler.java:248)
        at org.apache.openejb.core.ivm.EjbObjectProxyHandler._invoke(EjbObjectProxyHandler.java:92)
        at org.apache.openejb.core.ivm.BaseEjbProxyHandler.invoke(BaseEjbProxyHandler.java:279)
        ... 28 more
    Caused by: java.sql.SQLSyntaxErrorException: user lacks privilege or object not found: TBL_PLACE
        at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
        at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
        at org.hsqldb.jdbc.JDBCPreparedStatement.<init>(Unknown Source)
        at org.hsqldb.jdbc.JDBCConnection.prepareStatement(Unknown Source)
        at org.apache.commons.dbcp.DelegatingConnection.prepareStatement(DelegatingConnection.java:508)
        at org.apache.commons.dbcp.DelegatingConnection.prepareStatement(DelegatingConnection.java:508)
        at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$2.doPrepare(StatementPreparerImpl.java:119)
        at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:182)
        ... 83 more
    Caused by: org.hsqldb.HsqlException: user lacks privilege or object not found: TBL_PLACE
        at org.hsqldb.error.Error.error(Unknown Source)
        at org.hsqldb.error.Error.error(Unknown Source)
        at org.hsqldb.SchemaManager.getTable(Unknown Source)
        at org.hsqldb.ParserDQL.readTableName(Unknown Source)
        at org.hsqldb.ParserDQL.readRangeVariableForDataChange(Unknown Source)
        at org.hsqldb.ParserDML.compileInsertStatement(Unknown Source)
        at org.hsqldb.ParserCommand.compilePart(Unknown Source)
        at org.hsqldb.ParserCommand.compileStatement(Unknown Source)
        at org.hsqldb.Session.compileStatement(Unknown Source)
        at org.hsqldb.StatementManager.compile(Unknown Source)
        at org.hsqldb.Session.execute(Unknown Source)
        ... 89 more 
```

# java - KeyBindings 在 JApplet 中无法正常工作

> ID：15966328
> 
> 赞同：1
> 
> 时间：2013-04-12T08:16:49.320
> 
> 标签：java, swing, applet, key-bindings, japplet

该类用于在您按空格键时启动我制作的游戏，然后在游戏结束屏幕中按空格键时重新启动空格。当我按空格键并按预期启动游戏时，它第一次起作用，但是当我通过屏幕进入游戏并按空格键时，什么也没有发生。我试图扩展 JFrame 而不是 JApplet，然后它工作得很好。

这是我的代码：

```
package Game;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class GameTest extends JApplet{
    private PAPITest papi;
    private TestPane panel;
    private boolean inMenu = true;
    private ImageIcon ii;
    private Image image;

    public void init(){
        setFocusable(true);
        requestFocusInWindow();
        requestFocus();
        ii = new ImageIcon("Ball Jump.png");
        image = ii.getImage();
        papi = new PAPITest();
        panel = new TestPane();
        add(panel);
        setSize(600,600);
        setVisible(true);
    }

    public void paint(Graphics g){
        if(inMenu == true){
            Graphics2D g2D = (Graphics2D) g;
            g2D.drawImage(image, 0, 0, this);
            repaint();
        }
    }

    public class TestPane extends JPanel {

        public TestPane() {
            InputMap im = getInputMap(WHEN_IN_FOCUSED_WINDOW);
            ActionMap am = getActionMap();

            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_SPACE, 0, false), "pressed");
            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_SPACE, 0, true), "released");

            am.put("pressed", new AbstractAction() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    if(inMenu == true){
                        inMenu = false;
                        remove(panel);
                        papi.setSize(600,600);
                        papi.setAlive(true);
                        add(papi);            
                        setVisible(true); 
                    }

                    if (papi.isAlive() != true){ 
                        remove(papi);
                        papi = new PAPITest();
                        papi.setSize(600,600);
                        add(papi);
                        setVisible(true);
                        repaint();    
                    } 
                }
            });

            am.put("released", new AbstractAction() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    if(inMenu == true){
                        inMenu = false;
                        remove(panel);
                        papi.setSize(600,600);
                        papi.setAlive(true);
                        add(papi);            
                        setVisible(true); 
                    }

                    if (papi.isAlive() != true){ 
                        remove(papi);
                        papi = new PAPITest();
                        papi.setSize(600,600);
                        add(papi);
                        setVisible(true);
                        repaint();    
                    }
                }
            });

            setFocusable(true);
            requestFocusInWindow();        
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(600, 600);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2D = (Graphics2D) g;
            g2D.drawImage(image, 0, 0, this);
            repaint();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T14:49:29.723

不要覆盖 JApplet 的 paint() 方法。

```
public void paint(Graphics g){
    if(inMenu == true){
        Graphics2D g2D = (Graphics2D) g;
        g2D.drawImage(image, 0, 0, this);
        repaint();
    }
} 
```

自定义绘画在 JPanel 的 paintComponent() 方法中完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:23:45.540

你`JPanel`是阻止`KeyListener`

`KeyListener`只有当它们注册到的组件是可聚焦的并且具有焦点时才会响应事件。

您应该改用[键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)。它们允许您注册对键的兴趣，即使它们注册的组件没有直接焦点。

此外，您应该调用`super.paint`，事实上，您根本不应该覆盖`paint`顶级容器的方法。

创建一个自定义`JPanel`并覆盖它的`paintComponent`方法（确保调用`super.paintComponent`）并替换您要添加到小程序的面板

**工作示例**

这是一个基于您提供的代码的工作示例，现在缺少编码，所以我不得不将其注释掉，但还有一大堆东西只是......奇怪......

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GridBagLayout;
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.KeyEvent;
import javax.swing.AbstractAction;
import javax.swing.ActionMap;
import javax.swing.ImageIcon;
import javax.swing.InputMap;
import javax.swing.JApplet;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.KeyStroke;

public class GameTest extends JApplet {

//    private PAPITest papi;
    private TestPane panel;
    private boolean inMenu = true;
    private ImageIcon ii;
    private Image image;

    public void init() {
// Don't need any of this, this will still focus from our control pane
//        setFocusable(true);
//        requestFocusInWindow();
//        requestFocus();
        setLayout(new BorderLayout());
        ii = new ImageIcon("Ball Jump.png");
        image = ii.getImage();
//        papi = new PAPITest();
        panel = new TestPane();
        add(panel);
        // Useless, the size of applet is actually normally defined by the html tags
//        setSize(600, 600);
//        setVisible(true);
    }

//    This is a very bad idea
//    This is not double buffered and you are over painting the applets
//    content.  Use a CardLayout and a series of JPanels to provide this
//    functionality or the Glass Pane...
//    You MUST call super.paint!!
//    public void paint(Graphics g) {
//        if (inMenu == true) {
//            Graphics2D g2D = (Graphics2D) g;
//            g2D.drawImage(image, 0, 0, this);
//            repaint();
//        }
//    }

    public class TestPane extends JPanel {

        public TestPane() {
            InputMap im = getInputMap(WHEN_IN_FOCUSED_WINDOW);
            ActionMap am = getActionMap();

            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_SPACE, 0, false), "pressed");
            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_SPACE, 0, true), "released");

            am.put("pressed", new AbstractAction() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    System.out.println("Space Pressed");
                    if (inMenu == true) {
                        inMenu = false;
//                        Removing the panel will remove the key binings...
//                        remove(panel);

//                        Don't have this code...
//                        Set size will have no effect as the layout manager
//                        apply it's own sizing based on the components
//                        preferred size...
//                        papi.setSize(600, 600);
//                        papi.setAlive(true);
//                        This seems a bit pointless, cause you just removed the "panel"
//                        which this now been added to...
//                        add(papi);

//                        Why call this when you've just removed it??
//                        setVisible(true);
                    }

//                    if (papi.isAlive() != true) {
//                        remove(papi);
//                        papi = new PAPITest();
//                        papi.setSize(600, 600);
//                        add(papi);
//                        setVisible(true);
//                        repaint();
//                    }
                }
            });

            am.put("released", new AbstractAction() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    System.out.println("Space Released");
                    if (inMenu == true) {
                        inMenu = false;
//                        remove(panel);
//                        papi.setSize(600, 600);
//                        papi.setAlive(true);
//                        add(papi);
//                        setVisible(true);
                    }

//                    if (papi.isAlive() != true) {
//                        remove(papi);
//                        papi = new PAPITest();
//                        papi.setSize(600, 600);
//                        add(papi);
//                        setVisible(true);
//                        repaint();
//                    }
                }
            });

            setFocusable(true);
            requestFocusInWindow();
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(600, 600);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2D = (Graphics2D) g;
//            Don't have the image...
//            g2D.drawImage(image, 0, 0, this);
            repaint();
        }
    }
} 
```

# bash - 将标准输出保存到 5 分钟文件中的最简单方法

> ID：15966332
> 
> 赞同：2
> 
> 时间：2013-04-12T08:17:02.913
> 
> 标签：bash, file, logging, stdout

我有进程，我想知道如何将其输出文本流保存到每 5 分钟创建的文件/日志中。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:38:51.460

看看他的网站上发布的解决方案：

[http://www.linuxquestions.org/questions/linux-server-73/logging-via-stdin-527771/](http://www.linuxquestions.org/questions/linux-server-73/logging-via-stdin-527771/)

或者这个问题：

[https://serverfault.com/questions/327237/programme-that-accepts-stdin-then-writes-to-a-datetime-stamped-file](https://serverfault.com/questions/327237/programme-that-accepts-stdin-then-writes-to-a-datetime-stamped-file)

# c - 无法存储密钥：在 cgi-bin 下运行 c 程序时出现系统错误

> ID：15966333
> 
> 赞同：0
> 
> 时间：2013-04-12T08:17:05.533
> 
> 标签：c, apache, memcached, libmemcached

当我在 CentOS 6.4 上从命令行运行以下程序时，我得到了预期的结果，但是当我将它作为 Apache cgi 运行时，我`Couldn't store key: SYSTEM ERROR`出错了。我正在通过同一个用户运行 Memcached、Apache 和程序。

我可能做错了什么？

```
 #include<stdio.h>
    #include<string.h>
    #include <libmemcached/memcached.h>

    int main(int argc, char **argv) {
        memcached_server_st *servers = NULL;
        memcached_st *memc;
        memcached_return rc;
        char *key= "keystring";
        char *value= "keyvalue";
        char *key1= "keystring1";
        char *value1= "keyvalue1    ";

        memc= memcached_create(NULL);
        servers= memcached_server_list_append(servers, "localhost", 11211, &rc);
        rc= memcached_server_push(memc, servers);

        printf("Content-Type: text/plain;charset=us-ascii\n\n");

        if (rc == MEMCACHED_SUCCESS)
            printf("Added server successfully\n");
        else
            printf("Couldn't add server: %s\n",memcached_strerror(memc, rc));

        rc= memcached_set(memc, key, strlen(key), value, strlen(value), (time_t)0, (uint32_t)0);

        if (rc == MEMCACHED_SUCCESS)
            printf("Key stored successfully\n");
        else
        printf("Couldn't store key: %s\n",memcached_strerror(memc, rc));

        char *keys[]= {"keystring", "keystring1"};
        size_t key_length[]= {9, 10};
        unsigned int x;
        uint32_t flags;

        char return_key[MEMCACHED_MAX_KEY];
        size_t return_key_length;
        char *return_value;
        size_t return_value_length;

        rc= memcached_mget(memc, keys, key_length, 2);

        x= 0;

     if (rc == MEMCACHED_SUCCESS)
      {
            while ((return_value= memcached_fetch(memc, return_key, &return_key_length,
                                              &return_value_length, &flags, &rc)))
            {
                if (rc == MEMCACHED_SUCCESS)
                {
                  printf("Key %s returned %s\n",return_key, return_value);
                }
            }
        }

        return 0;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T06:14:37.380

最后通过禁用 SELINUX 摆脱了错误。

# python - 压缩文件上的高效 numpy.fromfile ？

> ID：15966335
> 
> 赞同：10
> 
> 时间：2013-04-12T08:17:09.133
> 
> 标签：python, numpy, zip, fromfile

我有一些大（甚至压缩到 10GB 左右）文件，其中包含一个 ASCII 标头，然后原则上每个大约 3MB 的 numpy.recarrays，我们称它们为“事件”。我的第一种方法如下所示：

```
f = gzip.GzipFile(filename)
f.read(10000) # fixed length ascii header
event_dtype = np.dtype([
        ('Id', '>u4'),                # simplified
        ('UnixTimeUTC', '>u4', 2), 
        ('Data', '>i2', (1600,1024) ) 
        ])
event = np.fromfile( f, dtype = event_dtype, count=1 ) 
```

但是，这是不可能的，因为 np.fromfile 需要一个真正的 FILE 对象，因为它确实进行了低级调用（找到了一张很旧的票[https://github.com/numpy/numpy/issues/1103](https://github.com/numpy/numpy/issues/1103)）。

所以据我了解，我必须这样做：

```
s = f.read( event_dtype.itemsize )
event = np.fromstring(s, dtype=event_dtype, count=1) 
```

是的，它有效！但这不是非常低效吗？不是为 s 分配了内存，并为每个事件收集垃圾吗？在我的笔记本电脑上，我达到了 16 个事件/秒，即 ~50MB/秒

我想知道是否有人知道一种聪明的方法，一次分配内存，然后让 numpy 直接读入该内存。

顺便提一句。我是一名物理学家，所以……在这个行业还是个新手。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-12T23:26:28.410

@Bakuriu 可能是正确的，这可能是一个微优化。你的瓶颈几乎肯定是IO，然后就是解压。两次分配内存可能并不重要。

但是，如果您想避免额外的内存分配，您可以使用`numpy.frombuffer`将字符串视为 numpy 数组。

这避免了重复内存（字符串和数组使用相同的内存缓冲区），但默认情况下，数组将是只读的。然后，如果需要，您可以将其更改为允许写入。

在您的情况下，它就像替换为一样`fromstring`简单`frombuffer`：

```
f = gzip.GzipFile(filename)
f.read(10000) # fixed length ascii header
event_dtype = np.dtype([
        ('Id', '>u4'),                # simplified
        ('UnixTimeUTC', '>u4', 2), 
        ('Data', '>i2', (1600,1024) ) 
        ])
s = f.read( event_dtype.itemsize )
event = np.frombuffer(s, dtype=event_dtype, count=1) 
```

只是为了证明使用这种方法不会复制内存：

```
import numpy as np

x = "hello"
y = np.frombuffer(x, dtype=np.uint8)

# Make "y" writeable...
y.flags.writeable = True

# Prove that we're using the same memory
y[0] = 121
print x # <-- Notice that we're outputting changing y and printing x... 
```

这产生：`yello`而不是`hello`.

无论在这种特殊情况下它是否是一个重要的优化，它都是一种需要注意的有用方法。

# shell - 通过命令行删除重复的电子邮件？

> ID：15966338
> 
> 赞同：0
> 
> 时间：2013-04-12T08:17:16.760
> 
> 标签：shell, command-line, command

我在文本文件中有两个电子邮件列表：

emails.txt - 订阅我的时事通讯的人 blacklist.txt - 取消订阅的人

我现在正在更改时事通讯软件。显然，我不想给决定退订的人发电子邮件。有没有办法通过命令行检查 blacklist.txt 中列出的任何电子邮件当前是否在我的 emails.txt 文件中，以及是否要删除它们？

注意：所有电子邮件都在单独的行上。我知道如何通过使用`sort`and删除重复项，`uniq`但这仍然至少将其中一个留在文件中。我需要将 blacklist.txt 中包含的电子邮件从 emails.txt 中删除，并将清理后的电子邮件列表输出到 clean.txt

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:26:47.047

`grep -v`(with **`-F and -w`**) 是一种方法。你仍然可以尝试`comm`..

也`awk`可以这样做：

```
awk 'NR==FNR{a[$0]++;next}!a[$0]' black.txt email.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:18:47.533

您可以`grep`为此使用：

```
grep -vwF -f blacklist.txt emails.txt 
```

它只会显示 `emails.txt`不在`blacklist.txt`.

*   `grep -v`反转找到的结果。
*   `grep -f`获取一个文件作为要比较的模式
*   `grep -w`比较完整的单词
*   `grep -F`匹配精确字符串

# ios - 如果我想实现推送通知，我必须多久向服务器发送一次设备令牌？

> ID：15966343
> 
> 赞同：2
> 
> 时间：2013-04-12T08:17:22.617
> 
> 标签：ios, objective-c, push-notification, apple-push-notifications

我想在我的应用程序中使用 Apple 推送通知服务。我阅读了几个教程，但仍然不明白一些东西。据说我需要定期向服务器发送设备令牌（在我的情况下，它是用 PHP 编写的服务器）。但是我多久发送一次以及如何生成设备令牌？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-12T08:21:44.873

您应该在每次应用启动时注册推送通知（使用`registerForRemoteNotificationTypes`）。您应该在每次更改时将设备令牌本地存储在您的应用程序中并将其发送到您的服务器。您应该将获得`didRegisterForRemoteNotificationsWithDeviceToken`的设备令牌与您存储的最后一个设备令牌进行比较。通过这种方式，您可以保存一些对服务器的调用（因为实际上设备令牌很少更改）。

这是注册码（取自 Apple Push Notifications Programming Guide）：

```
- (void)applicationDidFinishLaunching:(UIApplication *)app {

   // other setup tasks here....

    [[UIApplication sharedApplication] registerForRemoteNotificationTypes:(UIRemoteNotificationTypeBadge | UIRemoteNotificationTypeSound)];

}

// Delegation methods

- (void)application:(UIApplication *)app didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)devToken {

    const void *devTokenBytes = [devToken bytes];

    self.registered = YES;

    [self sendProviderDeviceToken:devTokenBytes]; // custom method

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T08:20:14.907

您应该在每次应用启动或激活时发送它，因为它可能随时更改。设备令牌在成功注册到 Apple 服务器后由推送通知 API 提供给您。

# php - Javascript 不影响由另一个脚本加载的内容

> ID：15966345
> 
> 赞同：2
> 
> 时间：2013-04-12T08:17:43.277
> 
> 标签：php, javascript

我正在使用 jQuery 为该表单上的 datepicker 元素加载一个 php 表单和 bootstrap.js；此代码位于文件 script.js 中：

```
$(document).ready(function() {

    // load form via ajax when button is clicked is submitted
    $('.add-opportunity .open').on('click', function() {

        // get form
        $('.add-opportunity').load('add_opportunity.php'); 
    });

    // datepicker
$('#datepicker').datepicker();        
}); 
```

使用这种格式，日期选择器不起作用。但是，如果我将 jQuery 放在 php 文件中，也放在 document(ready) 中，它会正常运行。我想将我所有的 javascript 保存在单独的文件中。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:30:50.167

您的绑定是在加载表单之前进行的。相反，一旦您的表单在 onload 事件的回调中加载，您应该绑定日期选择器。

```
$('.add-opportunity').load('add_opportunity.php', function(){
    // datepicker
    $('#datepicker').datepicker();  
}); 
```

# powershell-2.0 - powershell：通过过滤列出OU中组的成员

> ID：15966349
> 
> 赞同：0
> 
> 时间：2013-04-12T08:18:10.747
> 
> 标签：powershell-2.0

我在这里的第一篇文章虽然这个网站已经有一段时间是一个宝贵的资源了。

我正在尝试列出不属于某个组的用户列表，其中搜索库是一个 OU。

我试过这个命令：

```
Get-ADUser -server SERVER01 -filter {memberof -ne gg_group_I_need_to_search} -SearchBase "OU=ou1,OU=ou2,DC=1,DC=2,DC=3,DC=com" 
```

-server 参数在那里，因为我需要查询另一个域。此命令返回错误，但我似乎无法在语法中找到错误。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T11:13:29.987

只是一个工作过滤器的例子（IMO ......但我现在无法测试它）：

```
-Filter "-not (memberOf -eq 'CN=MyGroupToSearch,CN=Users,DC=int,DC=contoso,DC=com')" 
```

该组必须是一种`DN`形式。

# plsql - pl/sql 包/程序找不到数据错误

> ID：15966351
> 
> 赞同：0
> 
> 时间：2013-04-12T08:18:15.803
> 
> 标签：plsql

执行过程时，我没有遇到数据发现错误。但该行实际上存在于表中。请帮助我。

```
**Code**
*CREATE OR REPLACE PACKAGE BODY SCOTT."TRUNC_ANALYZE_PKG"
as
PROCEDURE TRUNC_TABLE(v_owner in varchar2, v_tab_name IN VARCHAR2) AS
    t_owner varchar2(30) ;
BEGIN
   -- Truncate only EMP tables
   SELECT     owner
     INTO     t_owner
     FROM     all_tables
    WHERE     table_name = upper(v_tab_name)
                and owner in ('EMP') ;
execute immediate ('TRUNCATE TABLE EMP.'||upper(v_tab_name)) ;
  EXCEPTION
      WHEN NO_DATA_FOUND
      THEN
              RAISE_APPLICATION_ERROR(-20023, v_tab_name||' Schema name or Table name is not valid. '||SUBSTR(SQLERRM,1,500));
      WHEN OTHERS
      THEN
              RAISE_APPLICATION_ERROR(-20023, v_tab_name||SUBSTR(SQLERRM,1,500));
END TRUNC_TABLE;
PROCEDURE ANALYZE_TABLE(v_owner in varchar2, v_tab_name IN VARCHAR2) AS
 v_tab_owner varchar2(30) := upper(v_owner) ;
 v_tab_name2 varchar2(30) := upper(v_tab_name) ;
BEGIN
dbms_ddl.analyze_object('TABLE',v_tab_owner,v_tab_name2,'ESTIMATE','',20,'');
exception
   when others then
      /* Raise the error to the calling proc id
required. */
      raise;
END ANALYZE_TABLE;
END TRUNC_ANALYZE_PKG;
/* 
```

**错误信息：**

```
SQL> exec SCOTT.DBA_PKG.TRUNC_TABLE('EMP','EMPLOYEE');
BEGIN DBA_PKG.TRUNC_TABLE('EMP','EMPLOYEE'); END;

*
ERROR at line 1:
ORA-20023: STG_FIRMINFO Schema name or Table name is not valid. ORA-01403: no
data found
ORA-06512: at "EIB_USER.DBA_PKG", line 21
ORA-06512: at line 1 
```

但实际上 EMPLOYEE 表存在于 all_tables 中。我无法破解为什么会捕获此异常。请帮助我。

谢谢，波瓦。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-17T08:43:46.750

当您**在过程中选择时**：： `select count(*) into xx from all_tables`xx 是您可以选择的表数。

但是当您**在 sql developer** :: 中选择时， `select count(*) into xx from all_tables`xx 是数据库中所有表的数量。

因此，在您的情况下，您必须`grant "select any table" to scott`

# javascript - 标签“javascript：”会导致任何问题吗？

> ID：15966352
> 
> 赞同：12
> 
> 时间：2013-04-12T08:18:20.073
> 
> 标签：javascript, jslint, jshint

JSLint 和 JSHint 在遇到标识符与以下正则表达式匹配的标记语句时都会发出警告：

```
/^(?:javascript|jscript|ecmascript|vbscript|mocha|livescript)\s*:/i 
```

例如，以下代码片段从 JSLint 生成“JavaScript URL”警告，并从 JSHint 生成“标签 'javascript' 看起来像 javascript url”警告（函数包装器是不必要的，但 JSLint 不喜欢没有功能的标记语句-scoped 并引发不同的警告）：

```
function example(x, y) {
javascript:
    while (x) {
        while (y) {
            break javascript;
        }
    }
} 
```

据我所知，没有浏览器关心它，即使它立即出现在书签中的“javascript：”协议之后。例如，以下内容似乎总是有效（只需像任何书签一样粘贴到地址栏中）：

```
javascript:(function () { javascript:for(var i = 0; i < 2; i++) { alert(i); break javascript; } }());

javascript:javascript:for(var i = 0; i < 2; i++) { alert(i); break javascript; } 
```

标签标识符“javascript：”（或任何其他与该正则表达式匹配的字符串）是否会导致任何问题（可能是某些古老的浏览器？），从而保证生成的警告？为什么会产生这些警告？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T01:20:49.777

我主要是在这里猜测，但请考虑一下：

*   `javascript:`不是一个实际的协议；
*   除了小书签以外的任何地方都不需要它（否则它被假定为标签）；
*   警告说它“*看起来像*一个 javascript url”。

我认为 JSLint 暗示`javascript:`伪协议不好，任何与它相似或可能与它混淆的东西也是如此。它会引起任何问题吗？严格来说，[也许是在 IE 上](http://crisp.tweakblogs.net/blog/313/the-useless-javascript-pseudo-protocol.html)（也许只有 oldIE）。但是，正如我所说，`javascript:`标签可能会与伪协议*混淆*，而 JSLint 不喜欢任何可能混淆的东西。所以，这可能是一个解释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T04:08:50.163

bfavaretto 所说的可能是真的，尤其是最后一个要点，但还要注意`javascript:`伪协议是不鼓励的。

MDN 提到了这一点：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/void#JavaScript_URIs](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/void#JavaScript_URIs)

“但是请注意，`javascript:`不鼓励使用伪协议而不是其他替代方案，例如不引人注目的事件处理程序。”

一篇关于为什么的文章：http: [//into-the-zen.blogspot.com/2010/04/dont-use-javascript-pseudo-protocol.html](http://into-the-zen.blogspot.com/2010/04/dont-use-javascript-pseudo-protocol.html)

“IE6会产生一些副作用……”

# javascript - 使用 javascript 添加换行符

> ID：15966353
> 
> 赞同：2
> 
> 时间：2013-04-12T08:18:23.017
> 
> 标签：javascript, html

我正在为学校做作业。我的一切都按应有的方式工作。唯一错误的是输出的格式。我不明白为什么我会收到按原样格式化的输出。我正在使用 javascript，我正在创建节点并将它们作为子元素附加。我的主要目标是对每条信息进行格式化并放在自己的行上。这是我的 javascript 函数。

```
function createUserid()

     {
     var firstString = window.prompt ( "Enter first name", "" ); 
             //documentwrite
              var lower = firstString.toLowerCase();
             // firstString.substring(0,4)
             // firstString.concat
     var lastString = window.prompt ( "Enter last name", "" );
     var lowlast = lastString.toLowerCase();
     var socialString = window.prompt ( "Enter social security number without dashes", "" );

     var ln = lowlast.substring(0,4);       //first 4 of last name
     var ls = socialString.substring(5,9);  //last 4 of social
     var fs = socialString.substring(0,5);  //first 5 of social
     var fn = lower.substring(0,4);         //first 4 of first name

             //var user = docoument.write("<p>" + "Username: " + lastString +
             //var pass = <p>"Password: " +

             //var myDiv = document.getElementById('here');
             //myDiv.innerHTML = ____ ;

        var e = document.getElementById('info');
        var o = document.getElementById('here');

        //creating 2 elements: p, br
        var newPara = document.createElement('p');
        var tBR = document.createElement('br');

        //prepare text nodes
        var first = document.createTextNode('First name: ' + firstString);
        var last = document.createTextNode('Last name: ' + lastString);
        var social = document.createTextNode('Social Security #: ' + socialString);
        var userN = document.createTextNode('Username: ' + ln + ls);
        var passW = document.createTextNode('Password: ' + fs + fn);

        //put together paragraph            
        newPara.appendChild(first);
        newPara.appendChild(tBR);
        newPara.appendChild(last);
        newPara.appendChild(tBR);
        newPara.appendChild(social);
        newPara.appendChild(tBR);
        newPara.appendChild(userN);
        newPara.appendChild(tBR);
        newPara.appendChild(passW); 

        //insert into div id of info
        document.getElementById('info').appendChild(newPara);

        o.style.display = 'none';
        e.style.display = 'block';      

    } 
```

这是我收到的输出![在此处输入图像描述](https://i.stack.imgur.com/dPN6S.jpg)

这就是输出的样子。![在此处输入图像描述](https://i.stack.imgur.com/5IXrK.jpg)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-12T08:21:16.303

您一次又一次地附加相同的节点。

```
newPara.appendChild(first);
    newPara.appendChild(tBR);
    newPara.appendChild(last);
    newPara.appendChild(tBR);  <--- this node gets moved, since you append it again.
    newPara.appendChild(social);
    newPara.appendChild(tBR);
    newPara.appendChild(userN);
    newPara.appendChild(tBR);  <--- this is where tBR will be at last.
    newPara.appendChild(passW); 
```

而是这样做：

```
 var first = document.createTextNode('First name: ' + firstString + '<br/>'); 
```

或这个 ：

```
 newPara.appendChild(first);
        newPara.appendChild(document.createElement('br'));
        newPara.appendChild(last);
        newPara.appendChild(document.createElement('br'));  
 ................................. 
```

此处的文档： [https ://developer.mozilla.org/en-US/docs/DOM/Node.appendChild](https://developer.mozilla.org/en-US/docs/DOM/Node.appendChild)

> 将一个节点添加到指定父节点的子节点列表的末尾。如果节点已经存在，则将其从当前父节点中删除，然后添加到新的父节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:25:33.167

如果`child`已经插入，[`element.appendChild(child)`](https://developer.mozilla.org/en-US/docs/DOM/Node.appendChild)则在将其插入新位置之前将其从原来的位置移除。

用于[`node.cloneNode(true)`](https://developer.mozilla.org/en-US/docs/DOM/Node.cloneNode)制作孩子的副本，或者只是[`document.createElement('br')`](https://developer.mozilla.org/en-US/docs/DOM/document.createElement)一次又一次地使用（可能循环使用以避免重复自己）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:24:15.537

尝试这个：

```
var first = document.createTextNode('First name: ' + firstString + '<br>');
var last = document.createTextNode('Last name: ' + lastString + '<br>');
var social = document.createTextNode('Social Security #: ' + socialString + '<br>');
var userN = document.createTextNode('Username: ' + ln + ls + '<br>');
var passW = document.createTextNode('Password: ' + fs + fn + '<br>'); 
```

# python - 如何让 setup.py 安装多个顶级包？

> ID：15966354
> 
> 赞同：2
> 
> 时间：2013-04-12T08:18:23.343
> 
> 标签：python, build, installation, setuptools, distutils

我有一个 python 包，我想像这样组织：

```
root/
    setup.py
    package1/
        __init__.py
        package2/
            __init__.py
        package3/
            __init__.py 
```

我想`setup.py`将`package1`, `package2`, 和作为顶级包安装`package3`到正确的目录中，以便我可以执行`site-packages/`

```
import package1
import package2
import package3 
```

没有问题。也许这需要多个`setup.py`文件？

但最重要的是，我希望最终能够通过执行`pip install root`. 我该怎么做呢？最好是`distutils`-only 解决方案，尽管 setuptools 也可以。

谢谢！乌里

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2020-02-26T11:56:01.527

你可以试试

```
packages=['package1', 'package2', 'package3'],
package_dir={
    'package2': 'package1',
    'package3': 'package1',
}, 
```

告诉 distutils 包 2 和 3 位于 package1 中。

完整的 setup.py 可能如下所示：

```
#!/usr/bin/env python

from distutils.core import setup

setup(name='root',
      version='1.0',
      description='Root package',
      author='Me',
      author_email='me@example.org',
      url='https://example.org/root',
      packages=['package1', 'package2', 'package3'],
      package_dir={
          'package2': 'package1',
          'package3': 'package1',
      },
) 
```

`python -m pip install ./root`将包安装到您要查找的结构中，这样

```
import package1
import package2
import package3 
```

工作。

作为证明，这就是`ls package*`site-packages 目录中的样子：

```
package1:
__init__.py __pycache__

package2:
__init__.py __pycache__

package3:
__init__.py __pycache__ 
```

这是`root-1.0.dist-info/RECORD`文件：

```
package1/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
package1/__pycache__/__init__.cpython-37.pyc,,
package2/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
package2/__pycache__/__init__.cpython-37.pyc,,
package3/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
package3/__pycache__/__init__.cpython-37.pyc,,
root-1.0.dist-info/INSTALLER,sha256=zuuue4knoyJ-UwPPXg8fezS7VCrXJQrAP7zeNuwvFQg,4
root-1.0.dist-info/METADATA,sha256=Z1crlNNrRhJwO6O2ujtNsCo9rURrPoZGE0--ZhuBZsU,190
root-1.0.dist-info/RECORD,,
root-1.0.dist-info/WHEEL,sha256=g4nMs7d-Xl9-xC9XovUrsDHGXt-FT0E17Yqo92DEfvY,92
root-1.0.dist-info/top_level.txt,sha256=svjaZCiNfClr21KxGb71MTR7bWON1-VZRPiPgM0FjV4,27 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T09:33:01.763

我觉得让您的开发文件/文件夹结构更紧密地代表部署结构会更干净。

这意味着，我会将所有三个包放在同一级别，而不是嵌套它们。

如果您随后希望能够通过其中一个导入所有三个，则可以在单个 setup.py 文件中设置依赖项。

# c - 在 Windows 上编译套接字程序时 mingw 中的错误

> ID：15966357
> 
> 赞同：0
> 
> 时间：2013-04-12T08:18:31.383
> 
> 标签：c, sockets, mingw

我在 mingw 上收到此错误：pr1.c 是文件名

我遇到了一些问题，然后像这样添加了库，但现在出现了这些错误：

```
$ gcc pr1.c -o pr1.exe -lwsock32 -lws2_32

pr1.c: In function 'main':
pr1.c:54:2: warning: incompatible implicit declaration of built-in function 'b
zero' [enabled by default]
C:\Users\rak\AppData\Local\Temp\ccMtb7Wt.o:pr1.c:(.text+0xc9): undefined refe
rence to `inet_pton'
C:\Users\rak\AppData\Local\Temp\ccMtb7Wt.o:pr1.c:(.text+0xe2): undefined refe
rence to `bzero'
C:\Users\rak\AppData\Local\Temp\ccMtb7Wt.o:pr1.c:(.text+0x1b5): undefined ref
erence to `bzero'
C:\Users\rak\AppData\Local\Temp\ccMtb7Wt.o:pr1.c:(.text+0x224): undefined ref
erence to `bzero'
c:/mingw/bin/../lib/gcc/mingw32/4.7.2/../../../../mingw32/bin/ld.exe: C:\Users\rak\AppData\Local\Temp\ccMtb7Wt.o: bad reloc address 0x20 in section `.eh_frame'
c:/mingw/bin/../lib/gcc/mingw32/4.7.2/../../../../mingw32/bin/ld.exe: final link
 failed: Invalid operation
collect2.exe: error: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:32:41.830

```
#include <string.h> 
```

错误消息告诉您 gcc 具有`bzero`内置功能。但是如果没有原型在范围内，您的用法被认为是指返回一个`int`（默认返回类型）的函数。所以它与内置函数不匹配，gcc 只是将责任传递给链接器，链接器同样找不到这样的函数。添加头文件以便编译器找到正确的原型。

您可能需要*启用* `bzero`以下内容：

```
#define _BSD_SOURCE 
```

如果这不能消除`bzero`错误，那么你真的应该放弃它并使用`memset`.

对于`inet_pton`，您还需要：

```
#include <arpa/inet.h> 
```

这篇关于 Windows 上的套接字编程的说明也可能很有用：[来自 Beej's Guide](http://www.beej.us/guide/bgnet/output/html/singlepage/bgnet.html#windows)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:26:47.127

`bzero`是一个非标准函数，它已被弃用并从 POSIX 2008 中删除。从手册页`bzero`：

> **符合 4.3BSD**
> 。此函数已弃用（在 POSIX.1-2001 中标记为 LEGACY）：在新程序中使用 memset(3)。POSIX.1-2008 删除了 bzero() 的规范。

因此，正如 cnicutar[建议](https://stackoverflow.com/a/15966381/912144)的那样，您应该`memset`改用：

```
memset(ptr, 0, sizeof *ptr); 
```

作为旁注，请注意如果目标`ptr`包含指针，则上述内容`memset`不会使指针为 NULL，而只是 0，这*可能*与 NULL 不同。

如果是`struct`，最好的方法是这样的：

```
struct something
{
    int a;
    int b;
    char *c;
    int d;
};

struct something var;
...
var = (struct something){0};  /* or NULL if first argument is a pointer */
/* or alternatively */
var = (struct something){ .a = 0 }; 
```

对于 s 数组`struct`，最标准的方法是`for`循环，然后将 s 归零，`struct`如上所述。

* * *

关于`inet_pton`功能，也许[这个问题](https://stackoverflow.com/q/13731243/912144)可以帮助你，建议使用`WSAAddressToString`功能。

# asp.net-mvc - Asp.net MVC AuthorizationFilter 和 AjaxRequests

> ID：15966359
> 
> 赞同：1
> 
> 时间：2013-04-12T08:18:35.937
> 
> 标签：asp.net-mvc, asp.net-mvc-4, action-filter

我有一个授权过滤器类：

```
public class ValidateSessionTokenFilter : IAuthorizationFilter
{
    public void OnAuthorization(AuthorizationContext filterContext)
    {
        if (filterContext.HttpContext.Request.IsAjaxRequest())
        {
            filterContext.Result = new JsonResult
            {
                Data = new { Message = "Session timeout" },
                JsonRequestBehavior = JsonRequestBehavior.AllowGet
            };
            filterContext.HttpContext.Response.StatusCode = (int)HttpStatusCode.Unauthorized;
        }
    }
} 
```

过滤器有效，但问题是即使我强制返回类型为`JsonResult`结果，框架总是返回重定向到登录页面。

有没有办法防止这种行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T09:13:31.760

当您返回 401 时，这是表单身份验证的默认行为。Afaik 在 .Net < 4.5 中没有禁用该行为的设置，因此，除了使用您自己的身份验证系统之外，解决方法是这样的：-返回自定义代码（类似于4100) - 连接 EndRequest 事件然后检查它

```
if (context.Response.StatusCode==4100)
 {
       context.Response.StatusCode=401;
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:03:56.033

这是 HttpStatusCode.Unauthorized 的 MVC 问题，它总是重定向。我们通过返回自定义错误代码来“修复”这个问题。

ps如果你真的需要这个，我可以找到负责这个的代码女巫。

# mysql - 有没有更好的方法来使用表 a 或表 b 中的值？

> ID：15966362
> 
> 赞同：0
> 
> 时间：2013-04-12T08:18:51.493
> 
> 标签：mysql, left-join

我有三个表`orders`：`user_addresses`和`alternate_addresses`。一个用户总是有一个 user_address。一个订单有一个`alternate_address_id`，其中可能包含一个`alternate_address_id`或`NULL`。

现在我的查询看起来像这样：

```
SELECT
  IF(ISNULL(orders.alternate_address_id), a.firstname, u.firstname) AS firstname,
  IF(ISNULL(orders.alternate_address_id), a.lastname, u.lastname) AS lastname
  -- etc.
FROM orders
LEFT JOIN alternate_addresses a ON (
  orders.alternate_address_id IS NOT NULL
  AND orders.alternate_address_id = a.alternate_address_id)
LEFT JOIN user_addresses u ON (
  orders.alternate_address_id IS NULL
  AND orders.user_id = u.user_id) 
```

为每个地址字段做这`IF(ISNULL())`部分似乎有点多余，因为我知道在第一个地址之后我需要使用哪个地址。

有没有更好的方法来做到这一点（我不能改变表格的设计）？

谢谢你的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:25:29.517

```
SELECT a.firstname AS firstname, a.lastname AS lastname, ...
FROM orders
JOIN alternate_addresses a ON (orders.alternate_address_id = a.alternate_address_id)

UNION

SELECT u.firstname AS firstname, u.lastname AS lastname, ...
FROM orders
LEFT JOIN user_addresses u ON (orders.user_id = u.user_id)
WHERE orders.alternate_address_id IS NULL 
```

实际上，drquicksilver 有道理。最好在`addresses`桌子上放一个地址类型的附加列（主要，替代，还有什么？）。现在`alternate_address_id`不需要了，取而代之的是您引用用户的地址之一。`FOREIGN KEY (user_id, address_id) REFERENCES addresses (user_id, address_id)`，或类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:24:10.490

您真正的问题是，`user_addresses`并且`alternate_addresses`是不同的表。因为它们是不同的表，所以很难让 SQL 统一对待它们。

拥有一个可以由用户和（可选）订单引用的单个地址表会更好的设计，然后您将能够设计一个连接到每个订单的正确地址的 JOIN 条件。

# asp.net - sum 同一日期记录的时间差

> ID：15966363
> 
> 赞同：0
> 
> 时间：2013-04-12T08:19:04.707
> 
> 标签：asp.net, sql, sql-server

```
WITH x AS 
(
  SELECT *, 
    rn = ROW_NUMBER() OVER (PARTITION BY PersonRFID ORDER BY DateStamp)
  FROM AISDb
where action = 'IN'
) ,
y As
(
  SELECT *, 
    rna = ROW_NUMBER() OVER (PARTITION BY PersonRFID ORDER BY DateStamp)
  FROM AISDb
where action='OUT'
) 

SELECT y.ID,x.ID,x.PersonName,y.PersonName,x.PersonRFID, DATEDIFF(MINUTE, x.TimeStamp, y.TimeStamp) 
FROM x , y      
where x.PersonRFID = y.PersonRFID
And x.rn=y.rna
AND  cast(x.Datestamp as date) = cast(y.Datestamp as date)
Order By x.PersonName; 
```

当我执行上述查询时，我得到下表：

```
 Datestamp         personName                     ID             TimeDifference

    1/30/2013   Aman Ullah Khan     E2001026770D01432810029D            11
    1/30/2013   Aman Ullah Khan     E2001026770D01432810029D            0
    1/30/2013   Aman Ullah Khan     E2001026770D01432810029D            1
    1/30/2013   Amjad Ali Anjum     E2001026770D024125401476            0
    1/30/2013   Amjad Ali Anjum     E2001026770D024125401476            1
    2/9/2013    Amjad Ali Anjum     E2001026770D024125401476            31
    2/10/2013   Amjad Ali Anjum     E2001026770D024125401476            3
    2/10/2013   Amjad Ali Anjum     E2001026770D024125401476            0
    2/10/2013   Amjad Ali Anjum     E2001026770D024125401476            3 
    1/30/2013   Arif Shah           E2001026770D01852370206D            0
    3/13/2013   Asmat Ullah         E2001026770D007624101DA1          456
    3/20/2013   Asmat Ullah         E2001026770D007624101DA1          558 
```

正如您所看到的，例如，对于人名“amanullah khan”，有 3 条相同日期的记录，即 2013 年 1 月 30 日，但是如果日期相同，我需要一条记录“时差”的总和，我应该得到

```
 1/30/2013   Aman Ullah Khan     E2001026770D01432810029D            14 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:24:30.287

试试这个——

```
SELECT  y.ID ,
            x.ID ,
            x.PersonName ,
            y.PersonName ,
            x.PersonRFID ,
            SUM(DATEDIFF(MINUTE, x.TimeStamp, y.TimeStamp))
    FROM x
    JOIN y ON x.PersonRFID = y.PersonRFID
            AND x.rn = y.rna
            AND CAST(x.Datestamp AS DATE) = CAST(y.Datestamp AS DATE)
    GROUP BY y.ID ,
            x.ID ,
            x.PersonName ,
            y.PersonName ,
            x.PersonRFID
    ORDER BY x.PersonName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:22:35.687

你需要改变如下

```
 SELECT y.ID,x.ID,x.PersonName,y.PersonName,x.PersonRFID,sum(DATEDIFF(MINUTE, x.TimeStamp, y.TimeStamp))
FROM x , y      
where x.PersonRFID = y.PersonRFID
And x.rn=y.rna
AND  cast(x.Datestamp as date) = cast(y.Datestamp as date)
group by
y.ID,x.ID,x.PersonName,y.PersonName,x.PersonRFID
Order By x.PersonName; 
```

# serial-port - OpenBSD 串行 I/O：-lpthead 使 read() 永远阻塞，即使设置了 termios VTIME？

> ID：15966365
> 
> 赞同：1
> 
> 时间：2013-04-11T23:13:14.917
> 
> 标签：serial-port, pthreads, openbsd

我有一个通过 termios 串行 API 使用的 FTDI USB 串行设备。我设置了端口，以便它在半秒内调用 read() 超时（通过使用 VTIME 参数），这在 Linux 和 FreeBSD 上都有效。然而，在 OpenBSD 5.1 上，当没有数据可用时， read() 调用会永远阻塞（见下文。）我希望 read() 在 500 毫秒后返回 0。

谁能想到 termios API 在 OpenBSD 下的行为会有所不同的原因，至少在超时功能方面？

编辑：无超时问题是由链接到 pthread 引起的。无论我是否实际使用任何 pthread、互斥锁等，简单地链接到该库都会导致 read() 永远阻塞，而不是根据 VTIME 设置超时。同样，这个问题只在 OpenBSD 上出现——Linux 和 FreeBSD 按预期工作。

```
if ((sd = open(devPath, O_RDWR | O_NOCTTY)) >= 0)
{
  struct termios newtio;
  char input;

  memset(&newtio, 0, sizeof(newtio));

  // set options, including non-canonical mode
  newtio.c_cflag = (CREAD | CS8 | CLOCAL);
  newtio.c_lflag = 0;

  // when waiting for responses, wait until we haven't received
  // any characters for 0.5 seconds before timing out
  newtio.c_cc[VTIME] = 5;
  newtio.c_cc[VMIN] = 0;

  // set the input and output baud rates to 7812
  cfsetispeed(&newtio, 7812);
  cfsetospeed(&newtio, 7812);

  if ((tcflush(sd, TCIFLUSH) == 0) &&
      (tcsetattr(sd, TCSANOW, &newtio) == 0))
  {
    read(sd, &input, 1); // even though VTIME is set on the device,
                         // this read() will block forever when no
                         // character is available in the Rx buffer
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T13:16:01.810

来自 termios 手册页：

```
 Another dependency is whether the O_NONBLOCK flag is set by open() or
 fcntl().  If the O_NONBLOCK flag is clear, then the read request is
 blocked until data is available or a signal has been received.  If the
 O_NONBLOCK flag is set, then the read request is completed, without
 blocking, in one of three ways:

       1\.   If there is enough data available to satisfy the entire
            request, and the read completes successfully the number of
            bytes read is returned.

       2\.   If there is not enough data available to satisfy the entire
            request, and the read completes successfully, having read as
            much data as possible, the number of bytes read is returned.

       3\.   If there is no data available, the read returns -1, with errno
            set to EAGAIN. 
```

你能检查一下是不是这样吗？干杯。

编辑：OP 将问题追溯到导致读取功能阻塞的 pthread 链接。通过升级到 OpenBSD >5.2，这个问题通过将新的 rthreads 实现更改为 openbsd 上的默认线程库而得到解决。有关[guenther@ EuroBSD2012 幻灯片的更多信息](http://www.openbsd.org/papers/eurobsd2012/guenther-rthreads/slide001.html)

# python - 为什么像 01 这样的数字在 python 交互模式下会出现语法错误

> ID：15966368
> 
> 赞同：5
> 
> 时间：2013-04-12T08:19:30.403
> 
> 标签：python, python-3.x, syntax-error

为什么在 python 交互模式下输入类似数字并按下回车时`01`会出现*语法错误？*`01`

输入时`00`，解释器的计算结果为`0`，但是输入类似 的数字或`01`以`001`a 开头的任何内容*语法错误：*显示无效标记。`0`

 *`1,000`在提示中输入会计算为一个元组，`(1,0)`但`1,001`不会计算为，`(1,1)`而是显示*语法错误*。

为什么 Python 解释器会这样？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-12T08:22:37.863

从历史上看，以零开头的整数文字表示八进制数。这[已在 Python 3 中被废除](http://www.python.org/dev/peps/pep-3127/#removal-of-old-octal-syntax)，取而代之的是不同的语法 ( `0o...`)。

不再接受旧语法，[除非数字完全由零组成](http://docs.python.org/3.1/reference/lexical_analysis.html#integer-literals)：

```
Python 3.3.0 (default, Dec  1 2012, 19:05:43) 
>>> 0
0
>>> 00
0
>>> 01
  File "<stdin>", line 1
    01
     ^
SyntaxError: invalid token 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T08:23:04.377

在 Python 2.x 中，整数文字中的前导零表示它被解释为八进制。这在需要`0o`前缀的 Python 3 中被删除。文字中的前导零作为语法错误留下，因此依赖旧行为的旧代码会大声中断，而不是默默地给出“错误”的答案。*

# c# - 无法反序列化

> ID：15966371
> 
> 赞同：-1
> 
> 时间：2013-04-12T08:19:39.453
> 
> 标签：c#, types, type-conversion

我有这段代码，它从 SQLite 恢复消息队列（序列化）

```
public void Restore()
{
    try
    {
        const string databaseName = @"C:\Code\C#\WcfService\WcfService\mainDB.db3";
        SQLiteConnection connection = new SQLiteConnection(string.Format("Data Source={0};", databaseName));
        connection.Open();
        try
        { 
            SQLiteCommand command = new SQLiteCommand("SELECT * FROM dump ORDER BY DId DESC limit 1", connection);
            SQLiteDataReader reader = command.ExecuteReader();
            while (reader.Read())
            {
                var info = (byte[])reader["DBinaryData"];
                Queue<Message> deserializedData = GetDeserializedMessages(info);
                var data = MergeQueueMessage(deserializedData);
                Logger.Log(data.ToString());
            }
        }
        finally
        {
            connection.Close();
        }
    }
    catch (Exception e)
    {
        Logger.Log(e.Message);
    }
}

    public Queue<Message> GetDeserializedMessages(byte[] source)
    {
        Queue<Message> messages = null;

        using (MemoryStream memoryStream = new MemoryStream(source))
        {
            BinaryFormatter formatter = new BinaryFormatter();

            messages = (Queue<Message>)formatter.Deserialize(memoryStream);
        }
        return messages;
    } 
```

但我有一个问题：无法反序列化来自“DBinaryData”字段的信息；我在数据库中的表包含：

1.  DId（整数，主键）
2.  DTime（文本）
3.  DBinaryData (Blob) // 将消息队列转储为序列化对象

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:23:21.220

尝试：

```
reader["DBinaryData"].ToArray(); 
```

将您的二进制数据序列化为字节[]。

IE

```
byte[] info = reader["DBinaryData"].ToArray(); 
```

# version-control - Lightswitch - 获取修改字段的旧值（数据库值）

> ID：15966373
> 
> 赞同：1
> 
> 时间：2013-04-12T08:19:47.483
> 
> 标签：version-control, visual-studio-lightswitch, rollback, revision-history

我正在开发一个具有某种版本控制的 Lightswitch 应用程序。当用户更改项目并单击保存时，我不想更新数据库中的该行，而是想要一个包含修改后数据的新行，并将原始行恢复为原始状态。我已经设法为使用此代码修改的行创建了新行：

```
 var changeSet = this.DataWorkspace.dataEntity.Details.GetChanges();
        var modified = changeSet.ModifiedEntities.OfType<RuleEntry>();

        foreach (RuleEntry re in modified)
        {

            //Create a new rule entry
            RuleEntry newRuleEntryRevision = this.DataWorkspace.dataEntity.RuleEntries.AddNew();
            newRuleEntryRevision.Country1 = re.Country1;
            newRuleEntryRevision.Family1 = re.Family1;
            newRuleEntryRevision.IP1 = re.IP1;
            newRuleEntryRevision.RuleKey = re.RuleKey;
            newRuleEntryRevision.RuleStatus = re.RuleStatus;
            newRuleEntryRevision.Title = re.Title;
            newRuleEntryRevision.Edited = DateTime.Now;
            newRuleEntryRevision.IsReal = false; 
```

但是在我完成之后，我希望将“re”实体设置回之前的状态，换句话说，它应该具有数据库中的值。

我知道可以像这样设置字段：

```
re.Country1 = Countries.Sweden; 
```

然后只运行 SaveChanges()，但我如何从数据库中获取正确的值？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T09:35:38.200

我做了一些手动挖掘，终于找到了！原始值可以这样找到：

```
re.Country1 = re.Details.Properties.Country1.OriginalValue; 
```

看看我的第一篇文章，看看“re”是什么。

# android - 如何使用 Facebook Android SDK 3.0 在页面的墙上发帖？

> ID：15966376
> 
> 赞同：3
> 
> 时间：2013-04-12T08:19:52.193
> 
> 标签：android, facebook, facebook-graph-api, facebook-android-sdk

我在 fb.com/my_own_app_page 有一个应用页面。现在使用适用于 Android 的 Facebook SDK，我想在 fb.com/my_own_app_page 的墙上发帖。我该如何做到这一点？

由于图形路径设置为`"me/feed"`发布在我们自己的墙上，我尝试将其更改`"my_own_app_page"`为以及`"my_own_app_page/feed"`但这些都不起作用。

如果可能的话，你能给出解决方案吗？

# c# - 使用 Aforge.net.framework 和 c# 即时将图像转换为视频

> ID：15966380
> 
> 赞同：3
> 
> 时间：2013-04-12T08:20:08.500
> 
> 标签：c#, aforge

我们需要使用 ffmpeg 二进制文件和 c# 项目将图像（来自摄像机实时流）动态转换为视频流。

`Aforge.net`我们在我们的系统（windows 7,32 位）中安装了框架 2.2.4.1 并使用`Aforge.video.Ffmpeg`dll 实现了视频录制编码。它工作正常，正如我们预期的那样。然后我们尝试在 64 位系统中工作相同的项目。

它给了我错误

> “无法加载文件或程序集 'AForge.Video.FFMPEG.dll' 或其依赖项之一。不是有效的 Win32 应用程序。（来自 HRESULT 的异常：0x800700C1）”。

我们浏览了一些论坛，找到了将目标平台更改为 x86 以在 32 位上运行的解决方案。但由于某些其他原因，我们应该保留`x64`作为我们的平台目标。根据论坛中的另一篇帖子，我们下载了 64 位`ffmpeg`来自此链接“ [http://ffmpeg.zeranoe.com/builds/](http://ffmpeg.zeranoe.com/builds/) ”的库并将 64 位版本替换`avcodec-53.dll,avdevice-53.dll, avfilter-2.dll,avformat-53.dll, avutil-53.dll, swscale-2.dll`到我的项目输出文件夹中。当我们尝试使用 64 位版本制作 Aforge.video.ffmpeg.dll 时Aforge.net 框架给出的源代码，构建不成功。

我们认为此源代码是为 win32 平台构建的，我们尝试仅通过单独替换 64 位 ffmpeg 二进制文件来获取 Aforge.Video.Ffmpeg dll。我们不确定是否需要包含除 ffmpeg 之外的任何其他依赖文件制作 dll 的二进制文件。是否有任何 Aforge.net 框架设置可用于生成 64 位版本的 Aforge.Video.ffmpeg dll？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-06-19T03:07:19.180

首先，您必须获得 Aforeg.Video.FFMPEG 的 64 位库。它的 URL 是
[https://aforgeffmpeg.codeplex.com/](https://aforgeffmpeg.codeplex.com/)（在写这个 CodePlex 的时候只是说他们正在关闭）。

您还可以从[https://ffmpeg.zeranoe.com/builds/](https://ffmpeg.zeranoe.com/builds/)获取 FFMPEG 库。所有这些 FFMPEG dll 都必须复制到将执行 .exe 或二进制文件的目录。特别注意存在必须避免的 x86 版本。

您必须将您的应用程序编译为 x64（无 AnyCPU）。

而且你必须设置 App.config

`<configuration>` `<startup useLegacyV2RuntimeActivationPolicy="true">` `<supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5.2" />` `</startup>` `<runtime>` `<NetFx40_LegacySecurityPolicy enabled="true" />` `</runtime>` `</configuration>`

这由[https://bydaniel.wordpress.com/2017/05/01/aforge-net-ffmpeg/描述](https://bydaniel.wordpress.com/2017/05/01/aforge-net-ffmpeg/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-25T10:13:07.673

从文档中：您必须针对 x86 进行编译。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-08-31T19:08:25.117

尝试更改框架，将其从 4.0 更改为 3.5 对我有帮助

# java - 如何在 Eclipse Juno 中编译 talend open studio？

> ID：15966382
> 
> 赞同：0
> 
> 时间：2013-04-12T08:20:13.340
> 
> 标签：java, eclipse-rcp, talend

我会在 talend open studio 之上制作 maven eclipse 项目，从 talend svn 获取

[talendforge svn](http://talendforge.org/svn/tos/trunk)

我已经阅读了 talend forge 论坛的指南：

[http://www.talendforge.org/wiki/doku.php?id=dev:run_from_svn](http://talendforge.org/svn/tos/trunk)

，但在程序结束时，我得到 100 个问题：-缺少 eclipse 依赖项-缺少配置文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T09:00:13.147

不确定您是否能够使用 Juno 版本编译 Talend。Talend 5.2 依赖于 Indigo 版本插件。

[Glen Mazza 的博客](http://www.jroller.com/gmazza/entry/weektal_building_tos_data_integration)提供了更好的教程。它为您提供从源代码运行 Talend 所需的所有依赖项。

TalendForge 上的这篇[文章](http://www.talendforge.org/forum/viewtopic.php?id=12873)也会为您提供有趣的反馈，文章#16 提供了指向 Eclipse Indigo 准备包（Linux 平台）的链接。

# google-apps-script - 表单提交事件的范围为空

> ID：15966385
> 
> 赞同：0
> 
> 时间：2013-04-12T08:20:16.933
> 
> 标签：google-apps-script

我有一个在提交表单时运行的脚本。我得到了范围，`event.range`但是每当我尝试对它做任何事情时，它都会返回一个错误，例如

```
TypeError: Cannot find function getA1Notation in object [object Object]. (line 10, file "Code") 
```

有谁能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T03:09:37.787

没有看到你的代码，我不能说你做错了什么，但我可以告诉你，你正在尝试的是可能的。所以我猜你有一些语法混乱。

这是一个对我来说很好的功能。我将其设置为触发如下：

![触发器](https://i.stack.imgur.com/ERv5l.png)

### 代码

```
function test (e) {
  Logger.log( e.range.getA1Notation() );
  Logger.log( e.range.getRow() );
} 
```

### 结果

![日志](https://i.stack.imgur.com/uW4DZ.png)

### 参考

*   电子表格表单从[了解事件提交事件](https://developers.google.com/apps-script/understanding_events)。
*   [类范围](https://developers.google.com/apps-script/reference/spreadsheet/range)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T03:32:18.777

如果我把它正确地放在一起，你需要将**e**更改为**event**或**event**更改为**e**

> 在此之前唯一的事情是函数 setReadableTime( **e** )
> 
> 引发错误的代码是**event** .range.getA1Notation 或 **event** .range.getRow()

# c++ - C++ 宏和 std::ostringstreams

> ID：15966391
> 
> 赞同：1
> 
> 时间：2013-04-12T08:20:34.243
> 
> 标签：c++, string, logging, macros, stringstream

我有一个`Logger`带有公共方法的静态 C++ 类：

```
static std::ostringstream& Log(int sev); 
```

如您所见，该方法评估为 ostringstream，因此我只需键入以下内容即可记录我的内容：

```
Logger::log(MY_SEVERITY) << "hello world"; 
```

由于编译器首先评估 log(MY_SEVERITY)，然后评估整个表达式，我需要第二种方法：

```
static FVResult_t Flush(); 
```

将 ostringstream 的内容实际写入磁盘。Flush() 必须在任何 Log() 调用之前调用，所以每当我想记录一些东西时，我必须依次调用这两种方法：

```
Logger::log(MY_SEVERITY) << "hello world";
Logger::Flush(); 
```

到目前为止，一切都很好。

现在我的问题是，我想编写一个 C++ 宏，它结合了两种方法，让我可以做这样的事情：

```
LOGMACRO(MY_SEVERITY) << "hello world"; 
```

我试过：

```
#define LOGMACRO(lev) \
Logger::Log(lev) \
Logger::Flush(); 
```

然而，正如我所料，C++ 编译器抱怨缺少 ostringstream。如何仅在我的宏中将此类 ostringstream 传递给 Logger::Log(lev)？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:23:08.373

您只能使用以下宏

```
#define LOGMACRO(lev, msg) \
Logger::Log(lev) << msg; \
Logger::Flush(); 
```

使用喜欢

```
LOGMACRO(MY_SEVERITY, "hello world") 
```

但是，我认为，那个功能，或者手动使用`std::endl`，或者使用自己的机械手会更好。

功能可以是这样的

```
inline void log(int severity, const std::string& msg)
{
   Logger::Log(severity) << msg;
   Logger::Flush();
} 
```

接着

```
log(MY_SEVERITY, "Hello!"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:39:00.907

您的问题是宏在“Hello world”流式传输到您的记录器之前正在扩展，导致以下结果：

```
Logger::Log(MY_SEVERITY)
Logger::flush();
<< "hello world" 
```

这不是有效的 C++。

最好的方法是使用宏，例如：

```
#define LOG_ERROR( msg ) \
do { \
    std::ostringstream oss; \
    oss << __func__ << "() ERROR: " << msg; \
    Logger::Log( LEVEL_ERROR ) << oss.str(); \
    Logger::Flush(); \
} while(0) 
```

该宏可以按如下方式使用：

```
void foo()
{
    /// stuff that detects a error
    LOG_ERROR( "Parameter X has an invalid value " << std::hex << x 
               << " should be in the range " << y " - " z" );
} 
```

这将输出一些类似的东西

```
foo() : Parameter X has an invalid value F7  should be in the range 0 - F0 
```

这种机制还意味着您不必担心重置流输出说明符，例如`std::hex`在宏的调用点处`LOG_ERROR`；

或者，它可能值得调查`boost::log`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-25T13:31:35.720

有一个更简单的非宏观解决方案。让我们`Logger::log`成为一个类，有一个`Logger::log::log(int)`构造函数。`Logger::log(MY_SEVERITY)`现在是一个临时的，它一直存在到`Logger::log(MY_SEVERITY) << "hello world";`语句的末尾。

现在定义`Logger::log::~log`并让它调用`Logger::Flush()`.

# entity-framework - 带有 WHERE 条件数组的 Linq to Entities 查询

> ID：15966395
> 
> 赞同：0
> 
> 时间：2013-04-12T08:20:41.743
> 
> 标签：entity-framework, linq-to-entities

当我在带有 OR 条件的 WHERE 子句中有一组参数时，如何创建高效的 Linq-to-Entities 查询？数组长度可以是任何值。

例如：从员工 -> 返回 EmployeeID 为 1、2 或 3 的所有员工。

这样做的愚蠢方法是：

```
For index = 0 To employeeArray.Lenght-1
        FindID = employeeArray(index)
        Dim query = From emp In _context.Employees
                    Where emp.EmployeeID = FindID
                    Select emp
Next 
```

我怎样才能有效地实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:25:47.360

```
Dim query = From emp In _context.Employees
            Where employeeArray.Contains(emp.EmployeeID)
            Select emp 
```

改用`Contains`方法 - 它将转换为`IN`实体框架生成的 SQL 查询中的子句。

# eclipse - eclipse + tomcat 服务器站点错误

> ID：15966399
> 
> 赞同：0
> 
> 时间：2013-04-12T08:20:59.497
> 
> 标签：eclipse, tomcat, resources

我使用 Eclipse Juno 和 tomcat 服务器 7.0.39。

我在 Eclipse 中创建了一个动态 Web 项目，效果很好。项目在服务器上构建和部署并访问 url 并且工作正常。

但是有时当我转到我的应用程序的相同网址时，我会得到这个而不是我的应用程序。（当然网址很好，服务器在;））

![Tomcat失败](https://i.stack.imgur.com/8tyQh.png)

我不得不停止 eclipse，重新启动 tomcat，在代码中没有改变任何东西，现在重新工作正常

对这个问题有任何想法吗？它发生在某个时候，非常烦人。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T06:39:51.313

仍然没有找到原因，但是如果我按一次 CTRL+F5 它将不再起作用，但是如果将 CTRL+F5 保持几秒钟它就会重新工作！

怎么回事？

# sql - from 之后的 2 个表格副本

> ID：15966402
> 
> 赞同：0
> 
> 时间：2013-04-12T08:21:11.493
> 
> 标签：sql, oracle, postgresql

尽管在 PostgreSQL 中工作，为什么这个选择在 Oracle 中不起作用（第三个总和应该与从员工中选择总和（工资）相同）？：

```
select e1.employee_id, e1.department_id, e1.manager_id, e1.salary,
sum(e2.salary), sum(e3.salary)
from employees e1, employees e2, employees e3
where e1.department_id=e2.department_id
group by e1.employee_id, e1.department_id, e1.manager_id, e1.salary  
order by 1,2; 
```

它在 PostgreSQL 中工作，但不是在这里。在 Oracle 中，只有一个副本 e2 没有任何约束（当 e1 是原始表并按其主键分组时），来自：

```
 select e1.employee_id, e1.department_id, e1.manager_id, e1.salary,
    sum(e2.salary)
    from employees e1, employees e2
    where e1.department_id=e2.department_id
    group by e1.employee_id, e1.department_id, e1.manager_id, e1.salary  
    order by 1,2; 
```

甚至没有 where 作为第一个表的每条记录的全部总和（这里没有限制）：

```
 select e1.employee_id, e1.department_id, e1.manager_id, e1.salary,
    sum(e2.salary)
    from employees e1, employees e2
    group by e1.employee_id, e1.department_id, e1.manager_id, e1.salary  
    order by 1,2; 
```

当然，我知道其他替代选择，例如：

```
select employee_id, department_id, manager_id, salary, 
sum(salary) over (partition by department_id) as suma,
sum(salary) over ()
from employees order by 2,3; 
```

或使用子选择：

```
select employee_id, department_id, manager_id, salary, 
(select sum(e2.salary) from employees e2
where e2.department_id=e1.department_id) as suma1,
(select sum(e2.salary) from employees e2) as suma2
from employees e1 order by 1,2; 
```

你知道在 Oracle 中做多个表副本的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:24:17.163

在您的第一个查询中，您创建了一个完整的笛卡尔积，因为您没有设置任何约束以在表之间进行匹配

# asp.net - ASP.NET 打印页面

> ID：15966404
> 
> 赞同：0
> 
> 时间：2013-04-12T08:21:24.833
> 
> 标签：asp.net

```
 <%@ Page Title="" Language="C#"MasterPageFile="~/MasterPage/AdminMaster.master" AutoEventWireup="true"  CodeFile="DemoReport.aspx.cs" Inherits="Reports_DemoReport" %>
    <%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="asp" %>
              <asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">
        <script  type="text/javascript">
        function CallPrint(strid) {
            var prtContent = document.getElementById(strid);
            var strOldOne = prtContent.innerHTML;
            var WinPrint = window.open('', '', 'letf=0,top=0,width=600,height=400,toolbar=0,scrollbars=0,status=0');
            WinPrint.document.write(prtContent.innerHTML);
            WinPrint.document.close();
            WinPrint.focus();
            WinPrint.print();
            WinPrint.close();
        }
</script>
        <div>
        <fieldset>
            <legend>Search Date Wise</legend>
            <table class="auto-style1">
                <tr>

                    <td>From Date</td>
                    <td>:</td>
                    <td>
                        <asp:TextBox runat="server" ID="txtFromDate" Width="100px"></asp:TextBox>
                        &nbsp;<asp:ImageButton runat="server" ID="imgFromDate" ImageUrl="~/_images/Calendar.gif" AlternateText="FromDate" />
                        <asp:CalendarExtender ID="dtpFromDate" runat="server" CssClass=" cal_Theme1" TargetControlID="txtFromDate"
                            Format="MM/dd/yyyy" PopupButtonID="imgFromDate" PopupPosition="BottomLeft" />
                    </td>
                    <td>To Date</td>
                    <td>:</td>
                    <td>
                        <asp:TextBox runat="server" ID="txtToDate" Width="100px"></asp:TextBox>
                        &nbsp;<asp:ImageButton runat="server" ID="imgTodate" ImageUrl="~/_images/Calendar.gif" AlternateText="ToDate" />
                        <asp:CalendarExtender ID="CalendarExtender1" runat="server" CssClass=" cal_Theme1" TargetControlID="txtToDate"
                            Format="MM/dd/yyyy" PopupButtonID="imgTodate" PopupPosition="BottomLeft" />
                    </td>

                    <td>&nbsp;&nbsp;<asp:Button ID="btnGO" Text="GO" runat="server" Width="80px" OnClick="btnGO_Click" /></td>
                    <td><asp:Button ID="btnPrint" runat="server" Text="Print" Width="80px" OnClientClick="CallPrint('printDIV');" /></td>
                </tr>
            </table>
        </fieldset>
    </div>

        <div id="printDIV">
        <fieldset>
            <legend>Complain Histroy</legend>

            <asp:GridView ID="GridView1" runat="server" Width="1250px" AutoGenerateColumns="False" CellPadding="4" EnableModelValidation="True" ForeColor="Black" BackColor="#CCCCCC" BorderColor="#999999" BorderStyle="Solid" BorderWidth="3px" CellSpacing="2">
                <FooterStyle BackColor="#CCCCCC" />
                <HeaderStyle BackColor="Black" Font-Bold="True" ForeColor="White" />
                <PagerStyle BackColor="#CCCCCC" ForeColor="Black" HorizontalAlign="Left" />
                <RowStyle BackColor="White" />
                <SelectedRowStyle BackColor="#000099" Font-Bold="True" ForeColor="White" />
           <Columns>
               <asp:TemplateField HeaderText="Date" ItemStyle-HorizontalAlign="Center">
                   <ItemTemplate>
                       <%#Eval("CurrentDate") %>
                   </ItemTemplate>

<ItemStyle HorizontalAlign="Center"></ItemStyle>
               </asp:TemplateField>

                <asp:TemplateField HeaderText="Superviser" ItemStyle-HorizontalAlign="Center">
                   <ItemTemplate>
                       <%#Eval("SUPERVISER") %>
                   </ItemTemplate>

<ItemStyle HorizontalAlign="Center"></ItemStyle>
               </asp:TemplateField>

                <asp:TemplateField HeaderText="QuarterNo" ItemStyle-HorizontalAlign="Center">
                   <ItemTemplate>
                       <%#Eval("QNUMBER") %>
                   </ItemTemplate>

<ItemStyle HorizontalAlign="Center"></ItemStyle>
               </asp:TemplateField>

                <asp:TemplateField HeaderText="AcknowledgementKey" ItemStyle-HorizontalAlign="Center">
                   <ItemTemplate>
                       <%#Eval(" ACKEY") %>
                   </ItemTemplate>

<ItemStyle HorizontalAlign="Center"></ItemStyle>
               </asp:TemplateField>

                <asp:TemplateField HeaderText="ComplainKey" ItemStyle-HorizontalAlign="Center">
                   <ItemTemplate>
                       <%#Eval("COMPKEY") %>
                   </ItemTemplate>

<ItemStyle HorizontalAlign="Center"></ItemStyle>
               </asp:TemplateField>

                <asp:TemplateField HeaderText="Status" ItemStyle-HorizontalAlign="Center">
                   <ItemTemplate>
                       <%#Eval("STATUS") %>
                   </ItemTemplate>

<ItemStyle HorizontalAlign="Center"></ItemStyle>
               </asp:TemplateField>

           </Columns>

                 </asp:GridView>
        </fieldset>
    </div>

</asp:Content> 
```

我必须只打印页面上的网格视图，打印工作正常，但我想在打印页面上生成动态页眉/页脚。我怎样才能做到这一点。我通常来自java背景，所以如果你正在编写代码，请让它不那么复杂。感谢您的时间考虑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:28:24.253

你可以这样做

```
var prinText="hereaderhtml";
printText+=prtContent.innerHTML;
printText+="footerhtml";
WinPrint.document.write(prtContent.innerHTML); 
```

# vb.net - 监控所有进程的执行

> ID：15966405
> 
> 赞同：0
> 
> 时间：2013-04-12T08:21:29.600
> 
> 标签：vb.net, visual-studio, process, monitoring, monitor

我该怎么做？

我不想使用计时器+一系列流程（因为这是我一直以来的新手方式）我正在寻找更好和改进的东西。

我尝试使用 ManagementEventWatcher，但此代码示例在 Windows 7 中不起作用（我没有收到任何错误，但没有显示 MsgBoxes）：

```
Public Class Form1

Dim WithEvents startWatch As New System.Management.ManagementEventWatcher(New System.Management.WqlEventQuery("SELECT * FROM Win32_ProcessStartTrace"))
Dim WithEvents stopWatch As New System.Management.ManagementEventWatcher(New System.Management.WqlEventQuery("SELECT * FROM Win32_ProcessStopTrace"))

Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles MyBase.Load
    AddHandler startWatch.EventArrived, AddressOf startWatch_EventArrived
    AddHandler stopWatch.EventArrived, AddressOf stopWatch_EventArrived
    startWatch.Start()
    stopWatch.Start()
End Sub

Public Sub startWatch_EventArrived(ByVal sender As Object, ByVal e As System.Management.EventArrivedEventArgs)
    MsgBox("Process started: " & e.NewEvent.Properties("ProcessName").Value)
End Sub

Private Sub stopWatch_EventArrived(ByVal sender As Object, ByVal e As System.Management.EventArrivedEventArgs)
    MsgBox("Process stopped: " & e.NewEvent.Properties("ProcessName").Value)
End Sub

Private Sub Form1_Closing(ByVal sender As Object, ByVal e As System.ComponentModel.CancelEventArgs) Handles MyBase.Closing
    startWatch.Stop()
    stopWatch.Stop()
End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T09:33:35.693

这将获取每个正在运行的进程的名称和 PID，只需修改此代码以获取任何其他信息...

```
 Dim processList As String
 For Each p As Process In Process.GetProcesses()
    processList = processList & " " & p.SessionId & vbNewLine
 Next()
 MsgBox(processList) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-05T05:37:02.560

管理事件观察者可以做你正在寻找的东西。看看： [ManagementEventWatcher.Stop 方法](http://msdn.microsoft.com/en-us/library/system.management.managementeventwatcher.stop%28v=vs.100%29.ASPx)

# javascript - 在 render() 中的主干.js 触发事件

> ID：15966406
> 
> 赞同：5
> 
> 时间：2013-04-12T08:21:31.610
> 
> 标签：javascript, jquery, backbone.js

我在`render`backbone.js 的函数中绑定了一些事件，更具体地说是a `click`，但是，我无法让它工作。

我有一个类似（但非常简化）的设置：

```
App.ProductView = Backbone.View.extend({

className: 'title_products_tab',
el: $('.title_products_tab'),

events: {
    'click .product_list .edit_product' : 'edit', 
```

对于我的主干视图的事件部分。在渲染函数中，我希望触发绑定`.edit_product` `click`事件：

```
render: function(){
        console.log($._data( $('.title_products_tab .product_list .edit_product')[0], "events" ));
        $('.title_products_tab .product_list .edit_product').trigger('click'); 
```

哪个不起作用，`_data`元素未定义，但是，我知道该事件确实起作用，因为我的视图的其余部分相应地起作用。我似乎无法`render`在启动时触发事件或其他任何地方。

我想：

```
this.trigger('click .product_list .edit_product'); 
```

然而，会工作，再次没有运气。

我也听说过，`bindAll`但听说使用它不是一个好主意。

那么我如何，或者更确切地说，何时触发我的主干视图的启动事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:29:47.243

所以你可能会觉得这很有趣（注意：Backbone 的代码）：

```
var View = Backbone.View = function(options) {
  this.cid = _.uniqueId('view');
  this._configure(options || {});
  this._ensureElement();
  this.initialize.apply(this, arguments);
  this.delegateEvents();
}; 
```

尤其是最后一部分。事件是在调用初始化方法**之后**绑定的，所以在调用渲染方法之后。事件尚未绑定。

（我想`delegateEvents`如果你真的需要这样做的话，你可以手动调用）

# sql - SQL优化子父查询

> ID：15966409
> 
> 赞同：0
> 
> 时间：2013-04-12T08:21:42.403
> 
> 标签：sql, sql-server, sql-server-2008

我正在使用 MS Project Server 编写报告，但遇到了问题。我需要总结子父层次结构中的一些字段。总和是叶子中值的总和。我写了一个查询，但它只适用于小数据集。

```
Task - 10
  Task - 2
  Task - 6
    Task - 6
  Task - 2

WITH children AS (
SELECT 
tt.ID, 
CASE '1' WHEN ISNULL(ttt.Id, '1') THEN tt.Value ELSE 0 END as Value,
CASE '1' WHEN ISNULL(ttt.Id, '1') THEN tt.Value2 ELSE 0 END as Value2,
tt.parentid
    FROM [MonitoringExampleDatabase].[dbo].[Table_1] tt
    LEFT JOIN [MonitoringExampleDatabase].[dbo].[Table_1] ttt 
    ON tt.ID = ttt.ParentId

UNION ALL

SELECT t.id, children.value, children.Value2, t.parentid
    FROM children 
    JOIN [MonitoringExampleDatabase].[dbo].[Table_1] t ON children.parentid = t.id
)

SELECT  id, sum(value) as Value, SUM(value2) as Value2
    FROM children 
    GROUP BY id 
```

任何如何优化该查询的想法，现在的问题是递归限制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T11:23:34.103

是否以错误的方式加入第一个 SELECT 的孩子？如果我运行您的代码，我只会得到未汇总的数据：

```
id          Value       Value2
----------- ----------- -----------
1           10          0
2           2           0
3           6           0
4           6           0
5           2           0 
```

虽然这可能是由于我设置表格的方式，如下所示：

```
CREATE TABLE [dbo].[Tasks](
[Id] [int] NULL,
[ParentId] [int] NULL,
[Value] [int] NULL,
[Value2] [int] NULL
) ON [PRIMARY] 
```

如果我像这样重构第一个 SELECT 子项，我会得到我认为的预期结果：

```
WITH children AS (
    SELECT 
      c.ID, 
      c.Value,
      c.Value2,
      c.parentid
    FROM Tasks c
      LEFT JOIN Tasks p
        ON c.ParentId = p.Id

UNION ALL

    SELECT t.id, children.value, children.Value2, t.parentid
        FROM children 
        INNER JOIN Tasks t ON children.parentid = t.id
)

SELECT  id, sum(value) as Value, SUM(value2) as Value2
    FROM children 
    GROUP BY id 
```

结果：

```
id          Value       Value2
----------- ----------- -----------
1           26          0
2           2           0
3           12          0
4           6           0
5           2           0 
```

关于性能，一般来说，如果您有很多级别，递归算法会很慢。为了获得更好的速度，您可以重构为迭代版本，只要您知道最大可能的级别数。

迭代代码不像递归代码那样漂亮或简洁，但可能更容易理解（因此维护）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:41:53.177

您可以`OPTION (MAXRECURSION 0)`在 select 语句的末尾使用来禁用递归限制。

```
WITH children AS 
(
...
)
SELECT  id, sum(value) as Value, SUM(value2) as Value2
FROM children 
GROUP BY id
OPTION (MAXRECURSION 0) 
```

[http://msdn.microsoft.com/en-us/library/ms175972.aspx](http://msdn.microsoft.com/en-us/library/ms175972.aspx)

# python - 具有多线程的 Windows 上的 Python Popen - 无法删除标准输出/标准错误日志

> ID：15966418
> 
> 赞同：6
> 
> 时间：2013-04-12T08:22:04.780
> 
> 标签：python, python-2.7, windows-xp, subprocess, python-multithreading

在 Windows 上使用 python 2.7.4（注意：WinXP - 下面的评论者建议这在 Win7 上正常工作），我有一个脚本，它创建了几个线程，每个线程通过 Popen 运行一个子进程，并将 stdout/stderr 重定向到文件和调用等待（）。每个 Popen 都有自己的 stdout/stderr 文件。在每个进程返回后，我有时必须删除文件（实际上将它们移动到其他地方）。

我发现在所有 wait() 调用返回之前，我无法删除 stdout/stderr 日志。在此之前，我收到“WindowsError: [Error 32] The process cannot access the file because it is being used by another process”。只要至少有一个子进程打开，Popen 似乎就会以某种方式保留 stderr 文件，即使这些文件没有共享。

测试代码在下面重现。

C:\test1.py

```
import subprocess
import threading
import os

def retryDelete(p, idx):
    while True:
        try:
            os.unlink(p)
        except Exception, e:
            if "The process cannot access the file because it is being used by another process" not in e:
                raise e
        else:
            print "Deleted logs", idx
            return

class Test(threading.Thread):
    def __init__(self, idx):
        threading.Thread.__init__(self)
        self.idx = idx

    def run(self):
        print "Creating %d" % self.idx
        stdof = open("stdout%d.log" % self.idx, "w")
        stdef = open("stderr%d.log" % self.idx, "w")
        p = subprocess.Popen("c:\\Python27\\python.exe test2.py %d" % self.idx,
                             stdout=stdof, stderr = stdef)
        print "Waiting %d" % self.idx
        p.wait()
        print "Starting deleting logs %d" % self.idx
        stdof.close()
        stdef.close()
        retryDelete("stderr%d.log" % self.idx, self.idx)
        print "Done %d" % self.idx

threads = [Test(i) for i in range(0, 10)]
for thread in threads:
    thread.start()
for thread in threads:
    thread.join() 
```

c:\test2.py:

```
import time
import sys

print "Sleeping",sys.argv[1]
time.sleep(int(sys.argv[1]))
print "Exiting",sys.argv[1] 
```

如果您运行此程序，您将看到每个 retryDelete() 都在文件访问错误上旋转，直到所有子进程都完成为止。

**更新**：即使没有将 stdof 和 stdef 文件描述符传递给 Popen 构造函数，也会发生此问题。但是，如果 Popen 被删除并且 wait() 被 time.sleep(self.idx) 替换，它不会发生（即删除立即发生）。由于 Popen 似乎对未传递给它的文件描述符有影响，我想知道这个问题是否与句柄继承有关。

**更新**： close_fds=True 给出一个错误（在重定向标准输出/标准错误时在 Windows 上不支持），并且在 wait() 调用之后使用 del p 删除 Popen 对象对问题没有任何影响。

**更新**：使用 sysinternals 进程资源管理器查找具有文件句柄的进程。将测试减少到只有 2 个线程/子线程，并使第二个线程长时间保持打开状态。句柄搜索显示唯一具有 stderr0.log 句柄的进程是父 python 进程，它有两个打开的句柄。

**更新**：对于我当前的紧急使用，我找到了一种解决方法，即创建一个单独的脚本，该脚本将命令行和 stderr/stdout 日志文件作为参数并运行重定向的子进程。然后父级只需使用 os.system() 执行此帮助程序脚本。日志文件随后被成功释放并被删除。但是，我仍然对这个问题的答案很感兴趣。对我来说，这感觉像是一个特定于 WinXP 的错误，但我仍然有可能只是做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-02-07T18:02:19.080

这个问题很老了，这个BUG已经在Python 3.4+上修复了。作为记录，这是我们一直用来解决 python 2.7 或 python 3.3 上的问题的一个 hacky 技巧-

> 这个函数是用纯python（没有外部API）制作的，只适用于Windows！

==> 在启动子进程之前，调用下面的函数

```
def _hack_windows_subprocess():
    """HACK: python 2.7 file descriptors.
    This magic hack fixes https://bugs.python.org/issue19575
    by adding HANDLE_FLAG_INHERIT to all already opened file descriptors.
    """
    # Extracted from https://github.com/secdev/scapy/issues/1136
    import stat
    from ctypes import windll, wintypes
    from msvcrt import get_osfhandle

    HANDLE_FLAG_INHERIT = 0x00000001

    for fd in range(100):
        try:
            s = os.fstat(fd)
        except:
            break
        if stat.S_ISREG(s.st_mode):
            handle = wintypes.HANDLE(get_osfhandle(fd))
            mask   = wintypes.DWORD(HANDLE_FLAG_INHERIT)
            flags  = wintypes.DWORD(0)
            windll.kernel32.SetHandleInformation(handle, mask, flags) 
```

该函数将处理最近打开的 100 个文件描述符，并将其设置为“无继承模式”，从而修复该错误。如果需要，可以增加 100 的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-21T07:31:46.453

您可以尝试更新到 Win7，我知道这是 WinXP 用户中的常见错误。

# iphone - UITableView 不会停止滚动？

> ID：15966419
> 
> 赞同：0
> 
> 时间：2013-04-12T08:22:08.843
> 
> 标签：iphone, ios, objective-c, uitableview, nsfetchedresultscontroller

我正在构建一个由`UITableViewController`+组成的提要`NSFetchedResultsController`。

表格视图的每个单元格都显示一个图像。提要被配置为显示用户尚未看到的图像，即`seen == 0`

我想在用户看到后将每个单元格标记为“已看到”。当然，我这样做是在：

```
- (void)tableView:(UITableView *)tableView didEndDisplayingCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath {
    Item *item = [_fetchedResultsController objectAtIndexPath:indexPath];
    [[ItemStore sharedInstance] seenItem:item];
} 
```

我还希望我的提要在标记为已看到后清理行。我已经实现了以下内容：

```
- (void)controller:(NSFetchedResultsController *)controller didChangeObject:(id)anObject
       atIndexPath:(NSIndexPath *)indexPath forChangeType:(NSFetchedResultsChangeType)type
      newIndexPath:(NSIndexPath *)newIndexPath {

    UITableView *tableView = self.tableView;

    switch(type) {

        case NSFetchedResultsChangeInsert:
            [tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath]
                             withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeDelete:
            [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath]
                             withRowAnimation:UITableViewRowAnimationFade];
            break; 
```

**我目前看到一个错误，如果用户滚动一次，表格将继续无限滚动到下一行。我意识到这`tableView deleteRowsAtIndexPaths`将迫使表格向前滚动 1。结果，已经过去的行将被标记为已从表中删除，并且表将再次向下滚动 1 行。**

有没有办法解决这个问题？

我的理想目标是在当前行上方保留 3-4 行，并且只有在超出该范围时才将其删除。当然，我不希望滚动由于删除而自行滚动。

完整来源：

```
# pragma mark - NSFetchedResultsControllerDelegate

- (void)controllerWillChangeContent:(NSFetchedResultsController *)controller {
    [self.tableView beginUpdates];
}

- (void)controller:(NSFetchedResultsController *)controller didChangeSection:(id <NSFetchedResultsSectionInfo>)sectionInfo
           atIndex:(NSUInteger)sectionIndex forChangeType:(NSFetchedResultsChangeType)type {

    switch(type) {
        case NSFetchedResultsChangeInsert:
            [self.tableView insertSections:[NSIndexSet indexSetWithIndex:sectionIndex]
                          withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeDelete:
            [self.tableView deleteSections:[NSIndexSet indexSetWithIndex:sectionIndex]
                          withRowAnimation:UITableViewRowAnimationFade];
            break;
    }
}

- (void)configureCell:(UITableViewCell *)cell atIndexPath:(NSIndexPath *)indexPath {
    Item *item = [self.fetchedResultsController objectAtIndexPath:indexPath];
    if (item.seen) {
        [self.tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
    }
}

- (void)controller:(NSFetchedResultsController *)controller didChangeObject:(id)anObject
       atIndexPath:(NSIndexPath *)indexPath forChangeType:(NSFetchedResultsChangeType)type
      newIndexPath:(NSIndexPath *)newIndexPath {

    UITableView *tableView = self.tableView;

    switch(type) {

        case NSFetchedResultsChangeInsert:
            [tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath]
                             withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeDelete:
            [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath]
                             withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeUpdate:
            [self configureCell:[tableView cellForRowAtIndexPath:indexPath] atIndexPath:indexPath];
            break;

        case NSFetchedResultsChangeMove:
            [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
            [tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath]withRowAnimation:UITableViewRowAnimationFade];
            break;

    }
}

- (void)controllerDidChangeContent:(NSFetchedResultsController *)controller {
    [self.tableView endUpdates];
} 
```

# javascript - 选中所有复选框并选中数组中的特定复选框

> ID：15966424
> 
> 赞同：-1
> 
> 时间：2013-04-12T08:22:18.467
> 
> 标签：javascript, jquery

我正在使用这个**javascript**函数来检查所有复选框...它工作正常，但如果我想检查特定的复选框 1 或 2 或更多，那么我会得到一个数组，但我没有得到特定的复选框值告诉我是否存在 javascript 或 jQuery 中的任何函数来执行此操作。

```
var checkflag = "false";

function check(field) {
  if (checkflag == "false") {
      for (i = 0; i < field.length; i++) {
          field[i].checked = true;
      }
      checkflag = "true";
      return "Uncheck All";
  } else {
      for (i = 0; i < field.length; i++) {
          field[i].checked = false;
      }
      checkflag = "false";
      return "Check All";
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:55:30.147

你可以用它来检查是否选中

```
$('checkbox')[i].is(':checked');
$('checkbox')[i].not(':checked'); 
```

或者

```
$('checkbox')[i].attr('checked') == 'checked';
$('checkbox')[i].attr('checked') !== 'checked'; 
```

然后我认为这无论如何都有效：

```
field[i].checked == true;
field[i].checked == false; 
```

但你必须使用`==`not`=`

# c++ - Linux上的NPAPI（npruntime）

> ID：15966427
> 
> 赞同：0
> 
> 时间：2013-04-12T08:22:34.233
> 
> 标签：c++, linux, npapi, npruntime

我正在 Linux 平台下开发一个 NPAPI npruntime 插件。我刚刚在 mozilla SDK 的 npruntimeSample 中做了一些修改。我成功构建并生成了我的库，但浏览器（Firefox 和 Chromium）没有检测到插件信息或实例化的对象。我不明白这背后的原因。如果可能的话，一些帮助。

这是我的代码： [我在 github 上的示例代码](https://github.com/AnouarAbdelbari/npruntimle)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T17:57:12.033

据我所知，当前任何 Mozilla 源代码库中都没有 npruntime 示例，因此您必须查看一些旧代码。
我建议尝试更新的示例，例如来自[NPAPI SDK](http://code.google.com/p/npapi-sdk/source/browse/#svn/trunk/samples/unix-basic)或[npsimple](https://github.com/mikma/npsimple)的示例（请注意，您要使用[此拉取请求](https://github.com/mikma/npsimple/pull/1)，因为 xulrunner-sdk 已死）。

此外，如果您不了解它，请查看[FireBreath](http://www.firebreath.org/)以了解简化开发插件的项目。

# jquery - 使用 jquery 选择多个实例

> ID：15966433
> 
> 赞同：1
> 
> 时间：2013-04-12T08:22:55.157
> 
> 标签：jquery

我有这个 jQuery 语句：

```
$(document).ready(function() {
$('#toggle-link').click(function(){
$(this).text($(this).text() == '+' ? '-' : '+');
 $('#box-to-toggle').toggle();

});
}); 
```

我有几个#box-to-toggle 实例，因此当我单击#toogle-link 链接时，该框的每个实例都会打开和关闭。谁能告诉我如何解决这个问题，所以链接只打开同一个 div 中的框。这是html结构。

```
<div id='holder'>
    <div id='toggle-link'>+</div>
    <div id='box-to-toggle'>
        <!-- hide / show content here -->
    </div>
</div>
<div id='holder'>
    <div id='toggle-link'>+</div>
    <div id='box-to-toggle'>
        <!-- hide / show content here -->
    </div>
</div>
<div id='holder'>
    <div id='toggle-link'>+</div>
    <div id='box-to-toggle'>
        <!-- hide / show content here -->
    </div>
</div>
<div id='holder'>
    <div id='toggle-link'>+</div>
    <div id='box-to-toggle'>
        <!-- hide / show content here -->
    </div>
</div> 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T08:25:23.640

多个 id 对您的健康有害，因此请将其更改为 classNames。接着：

```
$(this).parent().find(".box-to-toggle").toggle(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:36:31.617

在您的标记中看到有一些 id 被实例化到单个页面中的多个元素。有多个`#holder, #toggle-link`和`#box-to-toggle`。

如果您将*id*表示法更改为*class*会更好，因此您的标记现在应该将 id 更改为 class：

```
<div class='holder'>
   <div class='toggle-link'>+</div>
   <div class='box-to-toggle'>
       <!-- hide / show content here -->
   </div>
</div>
.....more divs...... 
```

并且 jQuery 只需一个更改就可以了，不要使用类名切换 div，而是可以使用`.next(), .siblings()`：

### 与`.next()`：

```
$('.toggle-link').click(function () {
   var $this = $(this);
   $this.text($this.text() == '+' ? '-' : '+');
   $this.next('.box-to-toggle').toggle();
}); 
```

### 与`.siblings()`：

```
$('.toggle-link').click(function () {
   var $this = $(this);
   $this.text($this.text() == '+' ? '-' : '+');
   $this.siblings('.box-to-toggle').toggle();
}); 
```

和`#`id 符号更改为`.`类符号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T08:40:02.063

正如所有答案所暗示的那样，`id`始终使用唯一并`class`代替`id`您提出的当前问题：

```
$('.toggle-link').click(function () {
    $(this).text($(this).text() == '+' ? '-' : '+');
    $(this).next("div.box-to-toggle").toggle();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T08:28:04.190

使其工作的一种方法是：

```
$(document).ready(function() {
    $('#toggle-link').click(function(){
        var $this = $(this);
        $this
            .text($this.text() == '+' ? '-' : '+')
            .siblings('#box-to-toggle').toggle();
    });
}); 
```

顺便提一句。我认为多个元素共享相同的 ID 不是一个好主意。使用类对我来说更合乎逻辑。

# jsp - 显示多个表格

> ID：15966437
> 
> 赞同：0
> 
> 时间：2013-04-12T08:23:15.303
> 
> 标签：jsp

我有两个单选按钮，其值为 itemwise 和 supplierwise。如果我按项目选择，那么我应该显示一个表格，如果我选择供应商，那么我应该显示另一个表格。我的编码正确显示表格，但表格未显示在同一位置。要将它们显示在相同的位置，我该怎么办？我的代码如下-----

```
<html>
<head>
<script language="javascript">
    function hideTable()
        {

            document.getElementById('item_table').style.visibility = "hidden";
            document.getElementById('supplier_table').style.visibility = "hidden";
        }
        function showItemTable()
        {
            if(document.getElementById("item_selection").checked==true)
            {
                document.getElementById('supplier_table').style.visibility = "hidden";
                document.getElementById('item_table').style.visibility = "visible";
            }
        }
        function showSupplierTable()
        {
            if(document.getElementById("supplier_selection").checked==true)
            {
                document.getElementById('item_table').style.visibility = "hidden";
                document.getElementById('supplier_table').style.visibility = "visible";
            }
        }
</script>
</head>
<body onload="javascript:hideTable()">
    <form name = "form1" method ="post" action="">
        <table border="1"  align="center">
                    <tr>
                        <td>Report Required</td>
                        <td><input type="radio" name="item_selection" id="item_selection" onclick="showItemTable()">Item Wise</td>                
                        <td><input type="radio" name="item_selection" id="supplier_selection" onclick="showSupplierTable()">Supplier Wise</td>    
                    </tr>
                </table>

        <table border="1" bgColor="#9999CC" align="center" id="item_table">
                        <tr>
                            <td  colspan="2">Item Type</td>
                            <td colspan="2"><%=item_typeddListStr%></td>
                        </tr>         
                        <tr>
                            <td  colspan="2">Item Category</td>
                            <td colspan="2"><%=item_categoryddListStr%></td>
                        </tr> 
                        <tr>
                            <td  colspan="2">Item Name</td>
                            <td colspan="2" id='item_code'>  
                                <select name='item_code' >  
                                    <option value='-1'></option>  
                                </select>  
                            </td>
                        </tr>
                        <tr>
                            <td>From Date</td>
                            <td><input type="text" name="indent_date" id="issue_date_first"  size="12"/></td>
                            <td>To Date</td>
                            <td><input type="text" name="indent_date" id="issue_date_second"  size="12"/></td>
                        </tr>
                        <tr>
                            <td colspan="1"><input type ="submit" name ="submit" value ="Get Records" onclick="return validate()"></td>
                            <td colspan="1"><input type ="submit" name ="submit" value ="Generate Report" onclick="return validate()"></td>
                            <td colspan="1"><input type ="submit" name ="submit" value ="Clear Form"></td>
                            <td colspan="1"><input type ="submit" name ="submit" value ="Back"></td>
                        </tr>
                    </table>

            <table border="1" bgColor="#9999CC" align="center" id="supplier_table">
                        <tr>
                            <td  colspan="2">Supplier Name</td>
                            <td colspan="2"><%=supplier_codeddListStr%></td>
                        </tr>
                        <tr>
                            <td colspan="1"><input type ="submit" name ="submit" value ="Get Records" onclick="return validate()"></td>
                            <td colspan="1"><input type ="submit" name ="submit" value ="Generate Report" onclick="return validate()"></td>
                            <td colspan="1"><input type ="submit" name ="submit" value ="Clear Form"></td>
                            <td colspan="1"><input type ="submit" name ="submit" value ="Back"></td>
                        </tr>
                    </table>    
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T09:00:32.900

使用*style.display*代替*style.visibility*

```
document.getElementById('supplier_table').style.display = "none";
// ...
document.getElementById('supplier_table').style.display= "block"; 
```

我还建议使用[jQuery](https://www.google.hu/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CC4QFjAA&url=http://jquery.com/&ei=R81nUZz8HM_Lsgb0u4HoBw&usg=AFQjCNFA7CZ5sWRDhHPuipmhL7zVksjC2A&sig2=LG-jDZNsVXoZxEwACZmdSQ&bvm=bv.45175338,d.Yms)来简化 JS 代码。例如，您可以

```
function swapTables() {
    $("#supplier_table").toggle();
    $("#item_table").toggle();
} 
```

就是这样。

另外，由于这个问题与 HTML/CSS 比 JSP 更相关，您能否添加这些标签？只是为了清楚...

# jquery - div上的jquery滚动动画

> ID：15966442
> 
> 赞同：-1
> 
> 时间：2013-04-12T08:23:34.163
> 
> 标签：jquery, html, css, scroll

当我按下菜单栏中的链接时，我想使用锚点滚动到该 div。

我的 jquery 知识不存在，所以我感谢所有的帮助。这是我正在谈论的网站：http: [//ma-jo.org/](http://ma-jo.org/)

菜单结构：

> 这是我的页眉 这是我的菜单链接：索引、关于、联系人 这是我的页脚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:27:56.840

假设您要`DIV`使用动画滚动到 。您可以使用[jQuery.ScrollTo Plugin](http://demos.flesler.com/jquery/scrollTo/)来完成此任务。

该站点有一些不错的演示，您可以查看。

你是这样做的：在你的`<head></head>`标签中包含这两个 jquery 文件

```
<script src="http://code.jquery.com/jquery-1.9.1.min.js">   <!--JQuery 1.9.1 (Latest) JS-->
<script src="http://demos.flesler.com/jquery/scrollTo/js/jquery.scrollTo-min.js"> <!--Scroll to Plugin--> 
```

现在添加以下 jQuery

```
$(document).ready(function() {
  $('#menu_index a').click(function(){
    $('body').scrollTo( '#footer', 800 );
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:28:09.003

我猜不需要 jQuery。看看这个页面： http: [//www.echocho.com/htmllinks08.htm](http://www.echoecho.com/htmllinks08.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:42:16.077

以下内容可能会给您一个很好的起点。

**HTML**

```
<div id="container">
    <div id="header">
    </div>
    <div id="menu">
        <div id="menu_index">
        <a href="#content_index">index</a>
        </div>
        <div id="menu_overOns">
        <a href="#content_overOns">over ons</a>
        </div>
        <div id="menu_contact">
        <a href="#content_contact">contact</a>
        </div>
    </div>
    <div id="content_all">
        <div id="content_index">
        <a href="#menu">Index</a>
        </div>
        <div id="content_overOns">
        <a href="#menu">overOns</a>
        </div>
        <div id="content_contact">
        <a href="#menu">Contact</a>
        </div>
    </div>
    <div id="footer">
    </div>
</div> 
```

**JS**

```
$(document).ready(function() {
    $('#menu a').on('click', function(ev) { 
        var dest = $(this).attr('href');
        $('#content_all').animate({scrollTop: $(dest).position().top },'slow'); 
        ev.preventDefault();
    });
}); 
```

在 jsfiddle 在这里测试它：http: [//jsfiddle.net/TJr6k/](http://jsfiddle.net/TJr6k/)

# ssl - Errno::ECONNRESET（对等方重置连接 - SSL_connect）

> ID：15966446
> 
> 赞同：2
> 
> 时间：2013-04-12T08:23:37.413
> 
> 标签：ssl, heroku, rackspace

自过去几个小时以来，我们的代码在 heroku 服务器上生成异常。在此之前，它在具有相同代码的同一台服务器上工作正常。

`Errno::ECONNRESET (Connection reset by peer - SSL_connect)`Heroku 服务器是个例外。

我们遇到异常的代码行是：

```
response = http.request(request, json_data) 
```

此异常的可能原因/解决方案可能是什么？

```
 def self.get_response_from_v2(url,json_data)
  http = Net::HTTP.new(url.host, 443)
  http.use_ssl = true
  http.verify_mode = OpenSSL::SSL::VERIFY_NONE
  request = Net::HTTP::Post.new(url.path, {'Content-Type' => 'application/json'})
  request.basic_auth url.user, url.password if url.user
  response = http.request(request, json_data)
  result = JSON.parse(response.body)
  result
end 
```

我们已经尝试了解决方案：

[使用 ruby​​gem 访问 Shopify API 时出现 SSL_connect 错误](https://stackoverflow.com/questions/12443258/ssl-connect-error-when-accessing-shopify-api-with-rubygem)

# css - 根据父级的左边距将 div 彼此相邻放置

> ID：15966447
> 
> 赞同：0
> 
> 时间：2013-04-12T08:23:43.490
> 
> 标签：css, html, positioning

![我想要达到的目标](https://i.stack.imgur.com/Ildvu.png)

图片是我想要实现的。基本上，我正在尝试制作一个包装器 div，并能够根据父包装器最左边部分的左边距在其中放置可变数量的 div。

我希望能够这样说：

```
.div1 { margin-left:5%; }
.div2 { margin-left:30%; }
.div3 { margin-left:85%; } 
```

并实现图中所见。然而，我注意到（我原以为会发生），div 不愿意合作；当我添加 a 时`float:left`，它们似乎相互添加了边距（因为 div2`margin-left:30%`除了 5% 的左边距和 10% 的宽度外，还得到了 a ，这使得 div2 出现在距离包装器最左边的 45% 处。

我意识到我可以只考虑以前的边距，并将 div2 的左边距设置为 30%-15%=15% 并得到正确的结果，但我想知道是否有办法做到这一点左边距？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:26:03.437

不要漂浮它们；相反，将它们绝对定位在某个位置，以便它们在某种意义上“重叠”；边距将以您想要的方式将它们分开。

例子：

```
.green {background-color: green; position: absolute}
.one {width:10%; margin-left:5%}
.two {width:20%; margin-left: 30%}
.three {width:10%; margin-left: 85%} 
```

演示在：

[http://jsfiddle.net/Mu4GU/](http://jsfiddle.net/Mu4GU/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:53:08.723

您可以尝试使用浮动而不使用绝对位置。

HTML

```
<div id="page">
<div id="box1">10%</div>
<div id="box2">25%</div>
<div id="box3">15%</div> 
```

CSS

```
#page{width:100%;height:200px; background-color:#000;}
#box1{height:200px; background-color:red; width:10%; margin-left:5%;float:left;}
#box2{height:200px; background-color:green; width:25%; margin-left:15%;float:left;}
#box3{height:200px; background-color:blue; width:15%; margin-left:30%;float:left;} 
```

演示：http: [//jsfiddle.net/pDxXB/](http://jsfiddle.net/pDxXB/)

# magento - magento 中的自定义属性选项值

> ID：15966448
> 
> 赞同：0
> 
> 时间：2013-04-12T08:23:44.880
> 
> 标签：magento, magento-1.7

我想在管理员的“<strong>管理属性选项”菜单的“<strong>属性选项”中添加一个自定义列。就像管理员中职位列旁边的“价值”列。

**我做了什么 ...**

1.  在数据库中“sort_order”字段旁边的“eav_attribute_option”表中创建了一个名为“value”的新字段。

2.  更改“magento\app\design\adminhtml\default\default\template\catalog\product\attribute\options.phtml”此文件以在“位置”列旁边显示“值”列。

3.  更改此文件“magento\app\code\core\Mage\Eav\Block\Adminhtml\Attribute\Edit\Options\Abstract.php”中的“getOptionValues()”方法以从数据库中获取我的自定义“值”列的数据，并显示在管理端。它以管理员形式显示 db 的默认值。

*** 但是当我想从管理面板保存数据时，数据不会保存在数据库中。谁能帮助我必须更改哪个文件才能将“值”字段的数据保存到数据库中？任何人都可以提供任何解决方案，哪个文件或必须更改的地方？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-02T18:58:56.650

试试这个，去：

*   magento\app\code\core\Mage\Eav\Model\Resource\Entity\Attribute.php

*   当然复制到本地

*   找到“受保护的函数_saveOption”

*   复制“sort_order”的保存或插入方式，查看“$data”数组。

我实际上试图弄清楚这个功能一段时间，你已经给出了需要修改哪些文件的提示，所以谢谢你:)

# java - 使用 Swing 的 JList

> ID：15966463
> 
> 赞同：0
> 
> 时间：2013-04-12T08:24:16.113
> 
> 标签：java, swing, list, jradiobutton

我有一个 3 Jlist，第一个包含应用程序的名称。第二个用于放置要安装的应用程序的名称，第三个用于放置要卸载的应用程序的名称。但它并不美丽。我想要一个列表，每个列表都有两个单选按钮列表，我们可以选择安装或卸载，但我不知道如何在摇摆中做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T10:41:11.553

您可能会查看双列`JTable`，第一列中包含名称，第二列中包含 a `JComboBox`。将`JComboBox`指定或`install`，默认为。此[示例](https://stackoverflow.com/a/7356518/230513)显示如何指定具有. 有关更多信息，请参阅[*如何使用表格*](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#editrender)。[这里](https://stackoverflow.com/a/11173600/230513)提到了一些相关的替代方案。`uninstall``unchanged``unchanged``DefaultCellEditor``JComboBox`[](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#editrender)

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:15:28.120

我没有很清楚地了解情况。
试试这个。
取 2 `JRadioButton`、 1`JButtonGroup`和 3 `JList`。*将这 2 个单选按钮的buttonGroup*属性设置为`JButtonGroup`. 然后在每个单选按钮的事件上编写代码`onClick`以启用相应的 JList 并禁用另一个`JList`。
我希望这将有所帮助。*

# batch-file - 如何编写 DOS 批处理文件以将 1.jpg 重命名为 0001.jpg？

> ID：15966465
> 
> 赞同：0
> 
> 时间：2013-04-12T08:24:18.130
> 
> 标签：batch-file, dos

如何编写 DOS 批处理文件以重命名任何子目录中的多个文件

```
1.jpg
10.jpg
11.jpg
12.jpg
2.jpg
3.jpg
4.jpg
5.jpg
6.jpg
7.jpg
8.jpg
9.jpg 
```

这不是合乎逻辑的安排，我希望它

```
1.jpg
2.jpg
3.jpg
4.jpg
5.jpg
6.jpg
7.jpg
8.jpg
9.jpg
10.jpg
11.jpg
12.jpg 
```

将 000 放在它前面作为>>

```
0001.jpg
0002.jpg
0003.jpg
0004.jpg.... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:38:38.203

```
@ECHO OFF
SETLOCAL enabledelayedexpansion
FOR /l %%i IN (1,1,999) DO (
SET newname=000%%i
SET newname=!newname:~-4!
IF EXIST %%i.jpg ECHO REN %%i.jpg !newname!.jpg
) 
```

由于您的姓名不包含任何非字母数字字符，因此这是一项相当简单的任务。

更改到所需的子目录，在循环中获取数字 1..999，以“000”为前缀，然后获取最后 4 个字符并进行重命名。

我已经包含了一个`ECHO`，所以简单地报告了操作。删除`ECHO`关键字以执行重命名。

`IF EXIST`如果原始名称不存在（这将生成丑陋的错误消息），门将停止尝试重命名，并且如果需要，如果新文件名已经存在，则可以再次门控以防止尝试重命名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:16:34.020

```
@echo off
setlocal EnableDelayedExpansion
for %%a in (*.*) do (
   set name=0000%%a
   if not exist !name:~-8! ECHO ren %%a !name:~-8!
) 
```

您可以在此处查看更通用的方法：[How to override ASCII sort order with about file names when using batch scripts?](https://stackoverflow.com/questions/15911727/how-to-overcome-ascii-sort-order-with-regard-to-file-names-when-using-batch-scri/15916074#15916074) 当文件名可能在数字之前有固定部分时。

# itextpdf - 如何为字体选择最佳大小？

> ID：15966472
> 
> 赞同：2
> 
> 时间：2013-04-12T08:24:41.430
> 
> 标签：itextpdf

我正在基于 itextpdf 中的 PdfPTable 创建一个带有网格表的 pdf 文档。输入数据以 java String[][] 的形式到达，所有单元格都已填充。对于每一列，我遍历所有行以确定显示该列数据所需的最大列。这成为列宽。将所有列宽相加以确定整个表的最大列数。在这一点上，我的意图是计算等宽字体的最佳点大小以完全占据列的宽度。目标是在面对非常动态的输入数据时具有最大的可读性。对于宽列，我最终会得到很多尾随空格，而不是从左到右很好地填充列。列内的左对齐外观是可取的。运行环境是 RHEL5.X 上的 openjdk-1.6.0。

代码已完全启动并运行，但如果列文本完全占据列字段，则外观可能会更好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T11:05:10.780

你的问题我看了三遍，还是没看懂。

让我试着改写一下：*给定一个可用的宽度，我如何定义一段文本的字体大小，使其与可用宽度匹配。*

首先你需要一个`BaseFont`对象。例如：

```
BaseFont bf = BaseFont.createFont(BaseFont.COURIER, BaseFont.WINANSI, BaseFont.NOT_EMBEDDED); 
```

现在您可以在“规范化 1000 单位”中询问基本字体的此字符串的宽度（这些是“字形空间”中使用的单位；有关更多信息，请参阅 ISO-32000-1）：

```
float glyphWidth = bf.getWidth("WHAT IS THE WIDTH OF THIS STRING?"); 
```

现在我们可以将这些“标准化的 1000 单位”转换为以磅为单位的实际大小（实际上是用户单位，但为了简单起见，我们假设 1 个用户单位 = 1 pt）。

例如：文本的宽度“这个字符串的宽度是多少？” 当使用大小为 16pt 的 Courier 时：

```
 float width = glyphWidth * 0.001f * 16f; 
```

你的问题是不同的：你想知道给定的字体大小`width`。这样做是这样的：

```
 float fontSize = 1000 * width / glyphwidth; 
```

我希望这回答了你的问题。如果不是，请改写。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-04-17T11:13:58.277

简单使用遵循语法。

```
PdfPTable table = new PdfPTable(1);
table.setWidthPercentage(100);
table.addCell(new Phrase("Name", FontFactory.getFont(
                    FontFactory.HELVETICA, 8, Font.BOLD))); 
```

# loops - 使用 pygame 模式更改弹跳吃豆人

> ID：15966473
> 
> 赞同：0
> 
> 时间：2013-04-12T08:24:44.867
> 
> 标签：loops, pygame, pacman

RANDOM PACMAN 任务是为 5 个对象（pac man 和 4 个随机移动的幽灵）设置动画，如果 pac man 与一个幽灵碰撞，他会从它身上弹开，幽灵会相互穿过，并且在被 pac man 击中时不受影响。当鼠标单击模式更改，如果 pac man 发生碰撞并且 pac man 不受影响，则幽灵会反弹，如果再次单击鼠标，它将恢复到原始模式。函数 ghost_collision 和 mode_swich 处理这个问题，最后我有一个 if 语句鼠标点击。BUG1我不知道为什么当精灵碰撞时它们有时会变得不动（在两种模式下）。我是否可以用列表和 for 循环替换一些重复的 if 语句？如果是这样怎么办？我尝试制作所有 ghost_boundary 变量的列表，然后使用

```
 For sprite in sprite_list():        
    sprite.left < 0 or sprite.right > WIDTH:
    sprite_velocity[1] = -1 * sprite_velocity[1] 
```

那失败了。

```
import pygame
from random import *

pygame.init()

def ghost_collision():
   # global pacman_up, pacman_right, pacman_velocity why?
    SCREAM.play()
    pacman_velocity[0] = randint(-1,1)
    pacman_velocity[1] = randint(-1,1)
   if pacman_velocity[0] < 0:
        pacman = pygame.image.load(PACMAN_LEFT).convert()
    elif pacman_velocity[0] > 0:
        pacman = pygame.image.load(PACMAN_RIGHT).convert()
    return pacman_velocity

def mode_switch():
    global mode
    blue_right, orange_right, pink_right,\
          red_right, blue, orange, pink, red
    if mode == False:
        mode = True
        blue = pygame.image.load(GHOST_SCARED).convert()
        orange = pygame.image.load(GHOST_SCARED).convert()
        pink = pygame.image.load(GHOST_SCARED).convert()
        red = pygame.image.load(GHOST_SCARED).convert()
    else:
        mode = False
        if blue_right == True:
            blue = pygame.image.load(BLUE_LEFT).convert()
            blue_right = False
    else:
        blue = pygame.image.load(BLUE_RIGHT).convert()
        blue_right = True
    if orange_right == True:
        orange = pygame.image.load(ORANGE_LEFT).convert()
        orange_right = False
    else:
        orange = pygame.image.load(ORANGE_RIGHT).convert()
        orange_right = True
    if pink_right == True:
        pink = pygame.image.load(PINK_LEFT).convert()
        pink_right = False
    else:
        pink = pygame.image.load(PINK_RIGHT).convert()
        pink_right = True
    if red_right == True:
        red = pygame.image.load(RED_LEFT).convert()
        red_right = False
    else:
        red = pygame.image.load(RED_RIGHT).convert()
        red_right = True

PACMAN_LEFT = 'pacman-left.png'#import all necessary images and sounds
PACMAN_RIGHT = 'pacman-right.png'
BLUE_LEFT = 'blue-left.png'
BLUE_RIGHT = 'blue-right.png'
ORANGE_LEFT = 'orange-left.png'
ORANGE_RIGHT = 'orange-right.png'
PINK_LEFT = 'pink-left.png'
PINK_RIGHT = 'pink-right.png'
RED_LEFT = 'red-left.png'
RED_RIGHT = 'red-right.png'
GHOST_SCARED = 'vulnerable.png'
BOUNCE_SOUND = 'Thump.wav'
SCREAM_SOUND = 'pacman_death.wav'
GHOST_WAIL = 'pacman_eatfruit.wav'
SOUND = pygame.mixer.Sound(BOUNCE_SOUND)
SCREAM = pygame.mixer.Sound(SCREAM_SOUND)
WAIL = pygame.mixer.Sound(GHOST_WAIL)
WIDTH = 800
HEIGHT = 600
BACKGROUND_COLOUR = 0, 0, 0
CAPTION = 'Random Pacman'
pacman_up = True#define image direction controlling variables
pacman_right = True
blue_right = False
orange_right = True
pink_right = False
red_right = True
mode = False

frame = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption(CAPTION)
pacman = pygame.image.load(PACMAN_RIGHT).convert()#create sprites and define boundaries
pacman_boundary = pacman.get_rect(center = (300,300))
pacman_velocity = [1, 1]
blue = pygame.image.load(BLUE_LEFT).convert()
blue_boundary = pacman.get_rect(center = (300,300))
blue_velocity = [-1, -1]
orange = pygame.image.load(ORANGE_RIGHT).convert()
orange_boundary = pacman.get_rect(center = (300,300))
orange_velocity = [1, -1]
pink = pygame.image.load(PINK_LEFT).convert()
pink_boundary = pacman.get_rect(center = (300,300))
pink_velocity = [-1, 1]
red = pygame.image.load(RED_RIGHT).convert()
red_boundary = pacman.get_rect(center = (300,300))
red_velocity = [1, 1]

finished = False
while not finished:
    pygame.event.pump()
        for event in pygame.event.get():
        if event.type == pygame.QUIT:
            finished = True
        if event.type == pygame.MOUSEBUTTONUP:
            mode_switch()

    #####################################################

if pacman_boundary.left < 0 or pacman_boundary.right > WIDTH:#pacman bounce code
    SOUND.play()
    pacman_velocity[0] = -1 * pacman_velocity[0]
    if pacman_velocity[0] < 0:
        pacman = pygame.image.load(PACMAN_LEFT).convert()
    elif pacman_velocity[0] > 0:
        pacman = pygame.image.load(PACMAN_RIGHT).convert()
    pacman_velocity[1] = randint(-1,1)

if pacman_boundary.top < 0 or pacman_boundary.bottom > HEIGHT:
    SOUND.play()
    pacman_velocity[1] = -1 * pacman_velocity[1]

if mode == False:        
    if pacman_boundary.colliderect(blue_boundary)\
       or pacman_boundary.colliderect(orange_boundary)\
       or pacman_boundary.colliderect(pink_boundary)\
       or pacman_boundary.colliderect(red_boundary):
        ghost_collision()

    #####################################################

if blue_boundary.left < 0 or blue_boundary.right > WIDTH:#blue bounce code
    blue_velocity[0] = -1 * blue_velocity[0]
    if mode == False:
        if blue_right == True:
            blue = pygame.image.load(BLUE_LEFT).convert()
            blue_right = False
        else:
            blue = pygame.image.load(BLUE_RIGHT).convert()
            blue_right = True

if blue_boundary.top < 0 or blue_boundary.bottom > HEIGHT:
    SOUND.play()
    blue_velocity[1] = -1 * blue_velocity[1]

if mode == True:
    if pacman_boundary.colliderect(blue_boundary):

        blue_velocity[0] = randint(-1,1)
        blue_velocity[1] = randint(-1,1)
        WAIL.play()

#####################################################

if orange_boundary.left < 0 or orange_boundary.right > WIDTH:#orange bounce code
    orange_velocity[0] = -1 * orange_velocity[0]
    if mode == False:
        if orange_right == True:
            orange = pygame.image.load(ORANGE_LEFT).convert()
            orange_right = False
        else:
            orange = pygame.image.load(ORANGE_RIGHT).convert()
            orange_right = True

if orange_boundary.top < 0 or orange_boundary.bottom > HEIGHT:
    SOUND.play()
    orange_velocity[1] = -1 * orange_velocity[1]

if mode == True:
    if pacman_boundary.colliderect(orange_boundary):
        orange_velocity[0] = randint(-1,1)
        orange_velocity[1] = randint(-1,1)
        WAIL.play()

#####################################################

if pink_boundary.left < 0 or pink_boundary.right > WIDTH:#pink bounce code
    pink_velocity[0] = -1 * pink_velocity[0]
    if mode == False:
        if pink_right == True:
            pink = pygame.image.load(PINK_LEFT).convert()
            pink_right = False
        else:
            pink = pygame.image.load(PINK_RIGHT).convert()
            pink_right = True

if pink_boundary.top < 0 or pink_boundary.bottom > HEIGHT:
    SOUND.play()
    pink_velocity[1] = -1 * pink_velocity[1]

if mode == True:
    if pacman_boundary.colliderect(pink_boundary):
        pink_velocity[0] = randint(-1,1)
        pink_velocity[1] = randint(-1,1)
        WAIL.play()

#####################################################

if red_boundary.left < 0 or red_boundary.right > WIDTH:#red bounce code
    red_velocity[0] = -1 * red_velocity[0]
    if mode == False:
        if red_right == True:
            red = pygame.image.load(RED_LEFT).convert()
            red_right = False
        else:
            red = pygame.image.load(RED_RIGHT).convert()
            red_right = True

if red_boundary.top < 0 or red_boundary.bottom > HEIGHT:
    SOUND.play()
    red_velocity[1] = -1 * red_velocity[1]

if mode == True:
    if pacman_boundary.colliderect(red_boundary):
        red_velocity[0] = randint(-1,1)
        red_velocity[1] = randint(-1,1)
        WAIL.play()

#####################################################

pacman_boundary = pacman_boundary.move(pacman_velocity)
blue_boundary = blue_boundary.move(blue_velocity)
orange_boundary = orange_boundary.move(orange_velocity)
pink_boundary = pink_boundary.move(pink_velocity)
red_boundary = red_boundary.move(red_velocity)
frame.fill(BACKGROUND_COLOUR)
frame.blit(pacman, pacman_boundary)
frame.blit(blue, blue_boundary)
frame.blit(orange, orange_boundary)
frame.blit(pink, pink_boundary)
frame.blit(red, red_boundary)
pygame.display.flip()

pygame.quit() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T14:55:07.543

精灵在碰撞后有时会变得不动的原因是这里的代码：

```
pacman_velocity[0] = randint(-1,1)
pacman_velocity[1] = randint(-1,1) 
```

该范围的 randint 意味着您获得的整数值是 -1、0 或 1。
来自文档：( [http://docs.python.org/2/library/random.html](http://docs.python.org/2/library/random.html) )

```
random.randint(a, b)
Return a random integer N such that a <= N <= b 
```

这意味着（理论上）每次发生碰撞时，速度的 x 分量有 1/3 的机会为 0，速度的 y 分量有 1/3 的机会为零。如果您只想选择 1 或 -1，请尝试 random.choice() 函数：

```
pacman_velocity[0] = random.choice((-1, 1))
pacman_velocity[1] = random.choice((-1, 1)) 
```

如果您想将 0 作为一种可能性包括在内，但又想降低其频率，您可以通过以下方式实现：

```
pacman_velocity[0] = random.choice((-1, -1, -1, 0, 1, 1, 1))
pacman_velocity[0] = random.choice((-1, -1, -1, 0, 1, 1, 1)) 
```

您尝试过的这个循环的问题：

```
For sprite in sprite_list():        
    sprite.left < 0 or sprite.right > WIDTH:
    sprite_velocity[1] = -1 * sprite_velocity[1] 
```

是您正在检查精灵是否已通过屏幕的左边界或右边界，但是您不是反转精灵速度的 x 分量，而是反转速度的 y 分量。此外，您没有`if`在条件的开头。试试这个：

```
For sprite in sprite_list:
    if sprite.left < 0 or sprite.right > WIDTH:
       sprite_velocity[0] = -1 * sprite_velocity[0]
    if sprite.top < 0 or sprite.bottom > HEIGHT:
        sprite_velocity[1] = -1 * sprite_velocity[1] 
```

# ruby-on-rails - Devise 现在允许我使用 TestCase 登录

> ID：15966474
> 
> 赞同：1
> 
> 时间：2013-04-12T08:24:51.097
> 
> 标签：ruby-on-rails, devise, mocking, mocha.js, testcase

我正在使用设计登录用户。我想写一些测试来确保一切顺利。我的登录是使用多态关联。

用户可以是雇主或申请人，工作正常。

我正在使用以下代码和 Devise 提供的 sign_in 助手。

```
 def log_in_applicant
    sign_in UserFactory.applicant 
 end 
```

此代码不会登录用户。但是当我进入 Rails 控制台调试器并编写用户登录的代码时！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:24:51.097

Devise 不允许您在 TestCase 中使用 sign_in 助手，因此上面的代码永远不会登录用户。

您将需要使用模拟来模拟已登录的使用。

您可以使用 Mocha Gem 并编写以下代码。

```
 def log_in_applicant
    JobsController.any_instance.stubs(:current_user).returns( UserFactory.applicant)
 end 
```

*   显然，要登录的用户来自 UserFactory。
*   any_instance.stubs(:current_user) - 表示 :current_user 的任何实例，来自设计的助手应该返回
*   .returns(UserFactory.applicant)
*   JobsController 是对您要测试的控制器的引用。它实际上是对 self.current_user 的一种引用。如果您想了解更多信息，请问我:)

# c# - 如何使用属性 IList 对对象进行 json 序列化或 json 反序列化 ?

> ID：15966476
> 
> 赞同：3
> 
> 时间：2013-04-12T08:24:58.820
> 
> 标签：c#, asp.net, asp.net-mvc

我有一个带有接口列表属性的对象。我需要序列化和反序列化这个对象。我正在使用 newton json 进行序列化，它将对象转换为 json，但是当我将这个 json 反序列化为对象时，它的 crate 错误“无法创建实例”。我的课是这样的

```
public class GridFilterModel
{
    public IList<IFilter> Filter { get; set; }       
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:27:48.810

那是因为它不知道使用哪种类型来反序列化一个`IFilter`成（JsonSerializer 默认选择一个`List<>`for `IList<>`） - 您需要在声明中使用这种类型，例如假设`Filter : IFilter`：

```
public IList<Filter> Filter { get; set; } 
```

将序列化和反序列化很好。

**更新以下评论**

如果您不控制过滤器的类型，那么我建议创建一个 DTO，其中包含您关心的所有相关数据，然后对其进行序列化：

```
public class FilterData
{
  public FilterData(IFilter filter)
  {
    // Copy data from filter argument here into local properties.
  }
}

...

public IList<FilterData> FilterData { get; set; } 
```

# android - 如何写入 Drive 应用程序数据文件夹？

> ID：15966480
> 
> 赞同：3
> 
> 时间：2013-04-12T08:25:15.663
> 
> 标签：android, file, google-api, google-drive-api

我正在使用[本教程](https://developers.google.com/drive/appdata)在 Android 上的 Drive 上写作。我在内部存储上有一个文件，我想将它复制到云端硬盘上，如下所示：

```
FileOutputStream fos = openFileOutput(filename,
        Context.MODE_PRIVATE);
fos.write("hello");
fos.close(); 
```

本教程的“将文件插入应用程序数据文件夹”部分说：

```
// File's content.
java.io.File fileContent = new java.io.File(filename);
FileContent mediaContent = new FileContent(mimeType, fileContent);
try {
  File file = service.files().insert(body, mediaContent).execute();
  return file;
//... 
```

我应该怎么做？

编辑：我希望这段代码可以工作，但它不会：

```
// File's content.
java.io.File fileContent = new java.io.File(filename);
FileOutputStream fos = new FileOutputStream(fileContent);
fos.write("hello");
fos.close();
FileContent mediaContent = new FileContent(mimeType, fileContent);
try {
  File file = service.files().insert(body, mediaContent).execute();
  return file;
//... 
```

编辑：

我收到这些错误，我都不知道如何解决：

```
04-15 12:12:24.615: W/AbstractGoogleClient(2272): Application name is not set. Call Builder#setApplicationName.
04-15 12:12:24.615: I/System.out(2272): An error occured: java.io.FileNotFoundException: /filename: open failed: EROFS (Read-only file system) 
```

# sqlite - 如何连接到数据库中的sqlite构建？

> ID：15966489
> 
> 赞同：1
> 
> 时间：2013-04-12T08:25:43.900
> 
> 标签：sqlite, unity3d

在 Unity3d 中，有两种方法可以在构建中包含文件： 1\. 通过声明成员变量来公开对资产的引用，然后在检查器中分配它 2\. 将资产放在“资源”文件夹中，然后通过以下方式加载它们Resources.Load [http://docs.unity3d.com/Documentation/ScriptReference/Resources.html](http://docs.unity3d.com/Documentation/ScriptReference/Resources.html)

我选择了第二个变体。我在 TextAsset 中加载的 myDB.bytes。TextAsset db = Resources.Load("myDB");

现在我想使用 sqlite API 连接到这个数据库。但我只能使用文件名连接到文件，或者在内存中创建新数据库。如何使用现有的 TextAsset 实例将其用作 sqlite 数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T11:35:24.730

这可能会有所帮助。您需要导入数据包。

[http://answers.unity3d.com/questions/188334/unity-sql-database.html](http://answers.unity3d.com/questions/188334/unity-sql-database.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T11:53:40.990

我有一个解决方案。将 Application.dataPath 中的 TextAsset 保存为数据库，并使用文件路径。

```
FileStream fs = File.Open(Application.dataPath + "/db.bytes", FileMode.Create);
BinaryWriter binary = new BinaryWriter(fs);
binary.Write(dbTextAsset.bytes);
fs.Close();

sqlite3_open(Application.dataPath + "/db.bytes"..... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-21T12:58:45.857

由于这是 Google 提供的热门搜索结果之一：

将您的数据库放在文件夹**Assets/StreamingAssets**中。

使用**Application.streamingAssetsPath**引用它。

```
database_path = "URI=file:" + Application.streamingAssetsPath + "/" + database_name;
using (var connection = new SqliteConnection (database_path)) {
            connection.Open();
            //...
} 
```

参考：[https ://docs.unity3d.com/Manual/StreamingAssets.html](https://docs.unity3d.com/Manual/StreamingAssets.html)

* * *

您可能还想查看[https://ornithoptergames.com/how-to-set-up-sqlite-for-unity/](https://ornithoptergames.com/how-to-set-up-sqlite-for-unity/)以获取有关如何从脚本访问数据库的信息。

# c# - 是否有与 FoxPro 的 addbs() 等效的 C#？

> ID：15966494
> 
> 赞同：4
> 
> 时间：2013-04-12T08:26:10.437
> 
> 标签：c#, string, directory, filepath, visual-foxpro

在可视 FoxPro 中。有一个函数 addbs()，你可以向它传递一个字符串。

如果（修剪）字符串的末尾没有反斜杠，它将添加一个。如果有反斜杠，它将返回修剪后的字符串。

```
lcString = 'C:\Example'
lcNewString = addbs(lcString)
?lcNewString

Output:
C:\Example\ 
```

C#中是否有等效函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T08:31:35.610

也许[Path](http://msdn.microsoft.com/en-us/library/system.io.path.aspx)课程可以帮助你？例如 combine() 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:46:26.937

正如其他人已经说过的，您可能想要使用[Path.Combine](http://msdn.microsoft.com/library/system.io.path.combine.aspx)

但是，您可以轻松地创建自己的方法来做到这一点：

```
public string AddBS(string value)
{
    return value.EndsWith("\\") ? value : value + "\\";
} 
```

为了使其更通用，我建议进行如下扩展：

```
public static class StringExtensions
{
    public static string AddSuffix(this string value, string suffix)
    {
        return value.EndsWith(suffix) ? value : value + suffix;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T05:33:25.450

有一个免费的“ ***Visual FoxPro Toolkit for .NET*** ”，它具有 C# 和 VB 库，可将许多 FoxPro 功能引入 .Net。

[http://foxcentral.net/microsoft/vfptoolkitnet.htm](http://foxcentral.net/microsoft/vfptoolkitnet.htm)

> Visual FoxPro Toolkit for .NET 是一个类库，包含超过 225 个 Visual FoxPro 函数，可用于任何 .NET 语言。包含的 VFPToolkitNET.DLL 是一个 .NET 托管代码 DLL（不是 COM 包装器），不需要 Visual FoxPro。支持的函数执行速度非常快，因为它们都是用 .NET 编写并编译成托管代码 .NET DLL。包括参考和教程独立 CHM 帮助文件以及使用相同 CHM 帮助文件的 Visual Studio .NET 集成动态帮助。使用任何 .NET 语言进行编程时，为 VFP 功能启用完整的 IntelliSense 和动态帮助。使用 VFP Toolkit 或 .NET，大多数 Visual FoxPro 函数都可以在 Visual Basic .NET 或任何其他 .NET 语言中使用。STRTOFILE() 之类的函数只需一行代码即可将字符串转换为文件。

此外，它说：

> .NET 的 Visual FoxPro 工具包不教开发人员 Visual Studio .NET 编程，但它确实使开发人员能够更快地进行 .NET 编程，并根据他们熟悉的内容以及这些功能如何减少总体编码的编写更少的代码。它不是伪 VFP 语法，它是“真正的”VFP 语法，并且在 Visual Basic .NET 中最自然地工作，因为它不需要命名空间。仍然必须学习 Windows .NET Framework 和 Visual Basic .NET（或任何 .NET 语言）。该工具包的作用是帮助 Visual FoxPro 开发人员使用 .NET，因为具有这些功能的 .NET 编程的学习曲线要​​快得多。.NET 的 Visual FoxPro 工具包不是任何 .NET 语言的替代品。它补充并增强了 .NET 语言编程的体验和生产力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T08:37:46.630

您可以使用以下代码轻松做到这一点：

```
string lcString = @"C:\Example";

if(!lcString.Substring(lcString.Length -1, 1).Equals(@"\", StringComparison.InvariantCulture))
{
    lcString += @"\";
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-12T12:20:11.120

我总是`path.TrimEnd('\\') + "\\"`在那种情况下使用。由于我经常使用该代码，因此我编写了一个扩展方法：

```
public static string AddTrailingSlash(this string s, char slash = '\\')
{
    return s.TrimEnd(slash) + slash;
} 
```

# html - HTML 按钮上的默认颜色代码

> ID：15966495
> 
> 赞同：3
> 
> 时间：2013-04-12T08:26:11.240
> 
> 标签：html, css

我必须制作一个`<a>`类似于 HTML 按钮的锚点。但我无法在输入类型按钮上找到默认背景颜色。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-12T08:39:07.557

Firefox 使用缩放的灰色 - 从最暗点的 RGB(112,112,112) #707070 到最亮的 RGB(252,252,252) #FCFCFC。

这样的事情可能会接近：

```
/* Note: This gradient may render differently in browsers that don't support the unprefixed gradient syntax */

/* IE10 Consumer Preview */ 
background-image: -ms-linear-gradient(top left, #707070 -50%, #FCFCFC 110.00000000000001%);

/* Mozilla Firefox */ 
background-image: -moz-linear-gradient(top left, #707070 -50%, #FCFCFC 110.00000000000001%);

/* Opera */ 
background-image: -o-linear-gradient(top left, #707070 -50%, #FCFCFC 110.00000000000001%);

/* Webkit (Safari/Chrome 10) */ 
background-image: -webkit-gradient(linear, left top, right bottom, color-stop(-.5, #707070), color-stop(1.1, #FCFCFC));

/* Webkit (Chrome 11+) */ 
background-image: -webkit-linear-gradient(top left, #707070 -50%, #FCFCFC 110.00000000000001%);

/* W3C Markup, IE10 Release Preview */ 
background-image: linear-gradient(to bottom right, #707070 -50%, #FCFCFC 110.00000000000001%); 
```

但是您可能会想尝试使用其中一种各种 CSS 工具来使其恰到好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T08:30:24.023

网页上控件的“默认”颜色因您使用的浏览器和操作系统而异。Mac 控件看起来与 IE 中的 PC 控件非常不同。手机也会以不同的方式显示控件。

让它们看起来相同的最佳方法是通过 css 设置它们的样式，因此请从您喜欢的浏览器中选择一种颜色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T04:37:26.450

颜色值可以是十六进制数或颜色名称。颜色编号以井号为前缀。颜色名称不区分大小写。

[HTML 颜色](http://www.willvick.com/HTML/HTMLColor.aspx)

[HTML 颜色示例](http://www.willvick.com/HTML/HTMLExampleColor.aspx)

# javascript - 复制方法后的不同行为

> ID：15966498
> 
> 赞同：0
> 
> 时间：2013-04-12T08:26:21.847
> 
> 标签：javascript

我期待 getName2 和 getName3 的行为相同，但 getName3 抛出错误（在非严格模式下打印“窗口”）

```
"use strict";

var name = 'The Window';
var object = {
    name : 'The Object',
    getName: function(){
        alert(this.name);
    }
};

object.getName();    // The Object

object.getName2 = object.getName;
object.getName2();    // The Object

(object.getName3 = object.getName)(); // Error: TypeError: this is undefined 
```

此代码源自 N.Zakas 为 Web 开发人员编写的专业 Javascript 第 7 章中的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:32:25.343

函数的上下文取决于*它的调用方式*。在您的最后一个示例中，您使用了一个[分组运算符](http://es5.github.com/#x11.1.6)（一对括号），它返回对 . 引用的函数的引用`object.getName`。它失去了`object`.

然后当您调用该函数时，由于它丢失了上下文`object`并且您在严格模式下运行，因此上下文成为全局对象并且`this`是`undefined`. 您可以强制该函数在上下文中运行`object`，例如，将其显式绑定到它：

```
(object.getName3 = object.getName).bind(object)(); // The Object 
```

# ember.js - 将 emberJs 与 xampp 一起使用

> ID：15966500
> 
> 赞同：-1
> 
> 时间：2013-04-12T08:26:31.373
> 
> 标签：ember.js, xampp

我可以将 emberJS 与 Xampp 一起使用吗？

老实说，我遇到的大多数教程都使用 RoR 作为他们的服务器。所以我真的很难从哪里开始。我想尝试开发一些简单的应用程序，例如注册。但我不知道如何通过 emberjs 使用和访问 mysql 数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T11:35:56.860

是的，您可以将 EmberJS 与 Xampp 一起使用。

事实上，EmberJS 本身运行良好，后面没有服务器。您可以简单地从 Apache 提供您的 Ember 应用程序。这是一篇关于 Ember 应用程序的好文章，它只是独立的，不能在服务器上运行。[http://eviltrout.com/2013/03/23/ember-without-data.html](http://eviltrout.com/2013/03/23/ember-without-data.html)

如果您想访问 MySQL 数据库中的数据，那么您可能需要某种服务器（PHP 或 Ruby on Rails 或 Java 或 Django 等）来访问数据库并使 Web 服务可用于 Ember.js 应用程序互动。

在与服务器通信方面，您可以编写自己的代码来与服务器提供的 Web 服务进行交互，或者如果您希望在某些实体上进行 CRUD，您应该查看 Ember-Data 的附加组件Ember.JS 可帮助您访问一组 Restful Web 服务，以访问持久在服务器上的 CRUD 实体。

如果您对这里感兴趣，这里有一个使用 Node.js 后端的 Ember.JS 应用程序示例。您可以将相同的原则应用于您的 Xampp 堆栈 [https://github.com/trek/ember-todos-with-build-tools-tests-and-other-modern-conveniences](https://github.com/trek/ember-todos-with-build-tools-tests-and-other-modern-conveniences)

2013 年 8 月 30 日更新：Ember-App-Kit 是创建具有内置构建过程和测试的标准化 ember 应用程序结构的绝佳尝试。它实际上生成了甚至不需要托管在服务器堆栈上的静态文件. 您可以将您的应用程序放在 S3 上，或者使用 Apache/Nginx 将其服务器... [https://github.com/stefanpenner/ember-app-kit](https://github.com/stefanpenner/ember-app-kit) Ember-tools 做类似的事情。这两个项目可能会在某个时候合并。[https://github.com/rpflorence/ember-tools](https://github.com/rpflorence/ember-tools)

# c# - C# ASP.NET 使用 TimeSpan 限制登录网站的时间

> ID：15966507
> 
> 赞同：0
> 
> 时间：2013-04-12T08:26:47.607
> 
> 标签：c#, asp.net, datetime, login

全部，

当客户登录我的网站时，我想显示在登录链接超时之前还剩多少时间。

由于某种原因，在 C# 中使用 TimeSpan 结构，我无法弄清楚如何执行此任务：

```
TimeSpan diff = (DateTime.Now - orderDate   ); 
```

当客户登录时，我想向客户展示他/她还有多少时间可以登录......“您还有 3 小时 33 分钟，直到此链接超时。” ...“在此链接超时之前，您有 2 小时 25 分钟的时间”等。

一旦达到 4 小时，当客户登录时，我将把他/她重定向到一个抱歉...链接已超时页面。

所以一些伪代码可能是......

```
if (diff.Hours >= 4)
{
response.redirect("log_in_timed_out.aspx");
}
else
{
lblTimeRemaining.Text = "You have " + diff.Hours + " hours and " + diff.Minutes + " minutes remaining until the link times out.";
} 
```

这个伪代码使小时和分钟计数增加而不是减少到 0。所以我登录并说你有 1 小时 33 分钟、2 小时 12 分钟等，因为 TimeSpan 给了我两个日期之间的差异。我希望它倒计时到 0，例如 3 小时 23 分钟、2 小时 15 分钟、1 小时 5 分钟等。

我如何才能显示客户每次使用 TimeSpan 结构登录并倒计时到 0 时还剩多少时间？

感谢您的任何反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:57:18.983

我建议将所有 internal `DateTime`s 保留在 中`UTC`，并且仅转换为本地时间以进行显示。所以我使用`DateTime.UtcNow`而不是`DateTime.Now`假设`orderTime`也是UTC。

我首先计算链接到期的时间，然后计算到那时还剩多少时间。

```
DateTime expirationTime = orderTime.AddHours(4);
TimeSpan timeRemaining = expirationTime - DateTime.UtcNow;
if(timeRemaining<TimeSpan.Zero)
  Error("Expired");
else
  Write("Remaining {0} hours {1} minutes",timeRemaining.Hours, timeRemaining.Minutes); 
```

为了更好的可测试性，不要调用`DateTime.UtcNow`/`.Now`内联，而是传递值可能很有用。但是由于我不了解您周围的代码和架构，所以我采用了简单的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:56:08.110

像这样，既然你知道限制是 4 小时，把 4 小时加到 orderDate 中，然后只取 UtcNow 之间的差，条件应该变成.....

```
TimeSpan diff = (orderDate.AddHours(4) - DateTime.UtcNow);

if (diff < TimeSpan.Zero)
{
    response.redirect("log_in_timed_out.aspx");
}
else
{
    lblTimeRemaining.Text = "You have " + diff.Hours + " hours and " + diff.Minutes + " minutes remaining until the link times out.";
} 
```

# javascript - 格式化日期？

> ID：15966509
> 
> 赞同：0
> 
> 时间：2013-04-12T08:26:55.127
> 
> 标签：javascript, date, format

我有一个字段，您必须在其中输入日期，但我在该字段上也有一个脚本，它会自动插入当前日期。我遇到的问题是日期的格式类似于 M/DD/YYYY 00:00:00 AM/PM，但我只是希望它像 DD/MM/YY。

顺便说一下，这是我当前的代码：

```
<b>Date of Registration:</b> <input type="text" id="txtregodate" name="regodate">

<script type="text/javascript">
var now = new Date ();
document.getElementById('txtregodate').value = now.toLocaleString();
</script> 
```

有没有办法格式化我以这种方式使用的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:29:16.773

这些东西有一个很棒的图书馆：http: [//momentjs.com/](http://momentjs.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:37:49.150

试试这个...这将给出 DD/MM/YY 格式日期

```
var now = new Date ();
document.getElementById('txtregodate').value = now.getDate() + '/' + (now.getMonth() + 1)+ '/' + (now.getYear()%100); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:38:12.787

（这完全是关于利用`Date`方法（`getDate`, `getMonth`, `getYear`, `getFullYear`）并将它们连接为字符串。基本上就是这样。

```
var now = new Date();
document.getElementById('txtregodate').value = now.getDate()+'/'+(now.getMonth()+1)+'/'+(now.getFullYear()%100); 
```

您可以从[这里获取此信息](http://www.w3schools.com/jsref/jsref_obj_date.asp)

# solr - 在 Solr 中使用“terms”与“select?qt=terms”

> ID：15966517
> 
> 赞同：5
> 
> 时间：2013-04-12T08:27:26.073
> 
> 标签：solr

我对使用 Solr 4.2.0 的“/terms”请求处理程序有困难。

使用 Web 浏览器，以下 url 返回 fieldName INDUSTRY 的术语列表

```
http://localhost:8983/solr/collection1/terms?terms.fl=INDUSTRY&terms.prefix=P&terms=true 
```

另一方面，以下查询不返回任何术语：

```
http://localhost:8983/solr/collection1/select?qt=terms&terms.fl=INDUSTRY&terms.prefix=P&terms=true 
```

我的问题是如何通过“/select” requestHandler 使用“/terms” requestHandler？

Solr 的日志如下（如果对您有任何帮助）

```
Apr 12, 2013 10:21:55 AM org.apache.solr.core.SolrCore execute
INFO: [collection1] webapp=/solr path=/terms params={terms.fl=INDUSTRY&terms=true&terms.prefix=P} status=0 QTime=5 
Apr 12, 2013 10:22:09 AM org.apache.solr.core.SolrCore execute
INFO: [collection1] webapp=/solr path=/select params={terms.fl=INDUSTRY&terms=true&qt=terms&terms.prefix=P} hits=0 status=0 QTime=0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T09:45:45.950

以下步骤解决了上述问题。

首先，在 solrconfig.xml 中，您应该删除“/select” requestHandler 并将 handleSelect 设置为 true。

```
 <requestDispatcher handleSelect="true" > 
```

其次，重新启动 Solr 并且以下查询有效：

```
http://localhost:8983/solr/collection1/select?qt=/terms&terms.fl=INDUSTRY&terms.prefix=P&terms=true 
```

重要提示：注意 qt 参数上的“/terms”，使用“qt=terms”将不起作用..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-15T10:46:54.517

在您的请求处理程序中，您可以添加以下内容：

```
 <lst name="defaults">
         <bool name="terms">true</bool>
    </lst> 

    <arr name="last-components">
        <str>terms</str>
   </arr> 
```

现在您可以使用 terms.fl 从选择请求处理程序中选择您想要的术语：

`http://localhost:8983/solr/select?terms.fl=INDUSTRY`

# c# - 查找导致 WCF 通信异常的 Web 方法

> ID：15966518
> 
> 赞同：0
> 
> 时间：2013-04-12T08:27:29.523
> 
> 标签：c#, wcf

我正在尝试查找负责引发间歇性`System.ServiceModel.CommunicationException`异常的 Web 方法的名称（Web 应用程序有数百个）。

我有一个可以捕获异常的错误处理程序 ( `IErrorHandler`)，但是异常信息并没有将我指向异常的来源。

有什么方法可以确定哪个 Web 方法对异常负责？

唯一的堆栈跟踪信息如下：

> System.ServiceModel.CommunicationException：从管道读取错误：无法识别的错误 109 (0x6d)。---> System.IO.PipeException：从管道读取错误：无法识别的错误 109 (0x6d)。
> 在 System.ServiceModel.Channels.PipeConnection.OnAsyncReadComplete(Boolean haveResult, Int32 error, Int32 numBytes)
> --- 内部异常堆栈跟踪结束 ---
> 在 System.Runtime.AsyncResult.End[TAsyncResult](IAsyncResult 结果)
> 在系统。
> System.ServiceModel.Dispatcher.DuplexChannelBinder.EndTryReceive（IAsyncResult 结果，RequestContext 和 requestContext）处的ServiceModel.Channels.TransportDuplexSessionChannel.TryReceiveAsyncResult.End（IAsyncResult 结果，消息和消息）
> 在 System.ServiceModel.Dispatcher.ErrorHandlingReceiver.EndTryReceive（IAsyncResult 结果，RequestContext& requestContext）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:53:08.660

Visual Studio 2010 可以在调试时捕获异常。您可以捕获任何一组或全部异常。也可以在执行引发异常的操作之前启用捕获。

假设您使用的是 Visual Studio 2010：

1.  在顶部菜单栏中，单击调试，然后单击异常。
2.  单击打开该`Common language runtime exceptions`部分。
3.  向下滚动直到找到`System.ServiceModel`，也单击此打开。
4.  在对应异常的复选框中添加一个勾号

如果可能的话，我还建议在可能导致此错误的方法中添加某种日志记录。这样，更容易确定问题的位置。

# vim - 如何检查 .vimrc 中是否存在交换文件？

> ID：15966528
> 
> 赞同：0
> 
> 时间：2013-04-12T08:28:14.247
> 
> 标签：vim

我在 Windows 的主目录中有 a `task.otl`，它是一种 Todo 列表，使用[vim-outliner](http://www.vim.org/scripts/script.php?script_id=3515)格式。

当启动不带参数的 gvim 时，我会自动加载它。但是，我只想打开一次。所以我想`.vimrc`在新会话中打开它之前检查我的交换文件是否存在。

无论我做什么，

```
 :echo filereadable(expand("$HOME/task.otl")) 
```

总是正确返回`1`。它也适用于我的主目录中的其他文件。

但是，如果我尝试，

```
 :echo filereadable(expand("$HOME/.task.otl.swp")) 
```

它总是返回`0`。（即使文件存在于目录中）

为了完整起见，我也尝试过`glob()`

```
:echo glob(expand("$HOME/task.otl")) 
```

返回完整路径

```
:echo glob(expand("$HOME/.task.otl.swp")) 
```

返回一个空字符串...

进一步的测试： `test.swp`未找到 &`test.fwp`已找到。所以这绝对是扩展的问题。

我试过`set suffixes -= .swp`没有成功。

删除允许使用 glob() 进行查找，但`.swp`不能...`wildignore``test.swp``.task.otl.swp`

所以我的问题是如何测试 Vimscript 中交换文件的存在？也欢迎其他解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T12:02:43.517

wildignore 也会忽略以开头的文件`.`。

我只是设法使用正确的行为

```
:set wildignore-= .* 
```

# mysql - MySQL - GROUP BY 的边缘案例使用

> ID：15966530
> 
> 赞同：0
> 
> 时间：2013-04-12T08:28:21.853
> 
> 标签：mysql, group-by

我对 GROUP BY 的理解是它的标准用途是聚合项目。所以一个典型的例子可能是：

```
select 

count(id),
department,

from table
group by department 
```

以上将计算每个部门的所有 id。

所以，我学会了一个非常有用的（但可能很狡猾！）使用 group by 的技巧。我想知道这种用法是否有任何问题。尽管查询按预期运行[在所有情况下都按预期结果]，但我的蜘蛛侠感觉有点刺痛......

想象一下以下数据集：

```
id  |  user_id  |  cost  |  note
----------------------------------
1         1         120     Test 1
2         1         150     Test 2
3         2         100     Test 3
4         3         120     Test 4 
```

现在，如果我们执行以下 SQL：

```
select * from table
group by user_id 
```

您得到以下结果集。

```
id  |  user_id  |  cost  |  note
----------------------------------
1         1         120     Test 1
3         2         100     Test 3
4         3         120     Test 4 
```

查询显然如下运行：

*   穿过桌子
*   当找到可分组的用户 id 时，忽略后面的用户 id
*   返回此唯一 user_id 项目表

实际上，我得到了一个“独特的”，具有特定的边界，我可以从这个列表中选择 *。此外，通过在 order by 之前对表进行排序，我可以使用它来过滤所有成本。

所以 - 这也是你所期望的......但是：

在上面的示例中 - 假设我实际上确保对于 user_id 1，显示值 120（而不是其他可能的值 - 在本例中为 150）。然后 120 似乎可以保证是响应。然后，该方法可以按字母/数字/其他高级过滤器等顺序进行排序......然后使用这种排序来强制表中的第一项成为“答案”。

我想做的实际查询非常复杂。使用 MIN 或类似的不适合我想要的最终值......但是：这种“订购你的桌子然后使用 group by 获取第一个唯一项目”的方法实际上非常优雅（我认为）。我实际上是在 4 个字段中使用 group by 约束，这与其他 SQL 相结合可以得出正确的答案。

所以。在那长长的背景之后：一个问题！

我使用的所有文档都只讨论了将 group by 与聚合函数一起使用。我似乎找不到 JUST group by 的行为。这让我觉得是两件事之一：

*   未记录的正确（错误）用例
*   我正在使用的任何版本的 mySQL 的意外行为。

那么是哪一个呢？如果这是一个正确但边缘情况的行为，那就太好了。如果我欺骗 SQL 引擎吐出一些东西，那么我没有证据证明这与未来的版本兼容，所以我很难使用它。

提前祝大家好运。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T08:34:53.260

在其他情况下，`RDMS`您不能在不包含在子句中的字段上使用`GROUP BY`没有聚合函数的`GROUP BY`子句，这是有道理的，因为这些字段需要聚合（最小值、最大值、计数等），但在 mysql 中，它允许您使用没有任何聚合函数的字段，并且将向您显示该字段遇到的第一个值。
mysql 的这种行为有利有弊：
- 优点：您可以使用它来获取该字段遇到的第一个值
- 缺点：如果您不知道这种行为，您可能会得到损坏的结果

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T15:39:03.427

在通过上述链接/帮助进行调查后，我认为不幸的是：虽然答案是正确的，但不能保证它是正确的......更准确地说，它是“不确定的”。

在我反复成功使用它之后，我真的有信心内部工作是“先到先得”，但正如规范中所说的那样，这不能保证，所以我不能依赖它。

欢呼帮助大家。对所有评论进行了投票。

# html - Facebook：由于无计划// iframe src 用于类似按钮的问题

> ID：15966533
> 
> 赞同：5
> 
> 时间：2013-04-12T08:28:33.807
> 
> 标签：html, facebook, facebook-like, facebook-javascript-sdk

Facebook [jsssdk](https://developers.facebook.com/docs/reference/javascript/)在加载 iframe 的方式上存在问题。我们的应用程序与 stbuild 捆绑到一个 iOS 应用程序中（除了通过 http 作为 mobiel 网页提供服务）。

在“iOS 模式”下，您的应用程序的来源是`file:///[...]/index.html`. Facebook 无方案的 url 样式对我们来说是破坏性的，因为`//connect.facebook.net/en_US/all.js`转换为`file:///connect...`. 因此，我们将代码段更新为：

```
(function(d, s, id, debug){
   var js, fjs = d.getElementsByTagName(s)[0];
   if (d.getElementById(id)) {return;}
   js = d.createElement(s); js.id = id;
   js.src = "//connect.facebook.net/" + bp.lib.Facebook.getCurrentLocale() + "/all" + (debug ? "/debug" : "") + ".js";
   fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk', /*debug*/ false)); 
```

但是，facebook sdk 将为单个类似按钮创建 iframe。这些也有`<iframe src="//..." >`, 和中断。我没有找到强制 sdk 使用 url 方案的方法。

有人有想法吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T14:57:17.083

您可以`https://`在网页中包含的所有 iframe 代码和其他文件中使用。然后，它仍然可以通过常规`http`连接和`https`连接正常工作。这是防止此类问题的最佳方法。

# sencha-touch - 单击一个常用按钮后如何引用数据视图中的所有记录。在煎茶触摸

> ID：15966534
> 
> 赞同：0
> 
> 时间：2013-04-12T08:28:34.200
> 
> 标签：sencha-touch, sencha-touch-2, sencha-touch-2.1

我有一些记录的数据视图列表。在一个列表中，我显示了 Item_name、item_no、Item_desc 和一个数字字段。列表顶部有一个工具栏，其中有一个用于将记录添加到商店的按钮。用户将在列表中看到记录，然后他将在数字字段中添加他感兴趣的项目的数量。

然后，单击“添加到商店”按钮后，我想将所有记录添加到用户感兴趣的商店（表示在数字字段中具有某些值的记录）。

如何分别为每个数字字段指定一个 ID？我在数据视图列表的数据组件中只声明了一次数字字段。现在我已经给 number 字段提供了一个 id，但它引用了 dataview 列表中最后一条记录的 number 字段。我希望它参考所有数字字段和记录。

另外，在单击常见的添加到存储按钮后，如何针对每个数字字段引用每条记录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T08:47:29.077

如果该字段在 DOM 中重复多次，您不应该使用 ID，而是可以尝试使用“itemId”或使用`class`属性，以便您可以使用组件查询来获取这些字段的列表，例如

```
// Returns all instances of the component with an
// itemId of "whitebox" that is nested at any  level  
// in the items array of mycontainer that have a cls 
// property with a value of "white"
Ext.ComponentQuery.query("mycontainer #whitebox[cls=white]"); 
```

# episerver - 是否可以在 EPiServer 编辑模式之外的页面中使用标签触发“快速编辑”功能？

> ID：15966536
> 
> 赞同：1
> 
> 时间：2013-04-12T08:28:39.277
> 
> 标签：episerver

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T10:04:53.123

这给出了加载当前页面的编辑模式的 URL。将其与快速编辑 URL 进行比较并进行相应调整。

```
string.Format(
  "{0}default.aspx?id={1}&amp;epslanguage={2}&amp;selectededitpaneltab=1",
  UriSupport.AbsoluteUrlFromUIBySettings("edit/"),
  page.PageLink,
  page.LanguageBranch) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T10:33:08.887

约翰是绝对正确的。他的回答很好。

我想分享我的最终结果：

1.  公开创建个人博客。公开我的意思是你真的只是在使用 EPiServers 编辑模式的东西。

    ```
    uxCreatePersonalBlog.NavigateUrl = String.Format("{0}EditPanel.aspx?parent={1}&type=82&epslanguage={2}&mode=simpleeditmode",
        UriSupport.AbsoluteUrlFromUIBySettings("edit/"),
        CurrentPage.PageLink,
        CurrentPage.LanguageBranch);

    uxCreatePersonalBlog.Visible = CurrentPage.QueryDistinctAccess(AccessLevel.Create); 
    ```

2.  公开创建博客项目。

    ```
    uxCreateBlogItem.NavigateUrl = String.Format("{0}EditPanel.aspx?parent={1}&type=80&epslanguage={2}&mode=simpleeditmode",
        UriSupport.AbsoluteUrlFromUIBySettings("edit/"),
        CurrentPage.PageLink,
        CurrentPage.LanguageBranch);

    uxCreateBlogItem.Visible = CurrentPage.QueryDistinctAccess(AccessLevel.Create); 
    ```

3.  公开编辑博客项目。

    ```
    uxEditBlogItem.NavigateUrl = String.Format("{0}Default.aspx?id={1}&epslanguage={2}&mode=simpleeditmode",
        UriSupport.AbsoluteUrlFromUIBySettings("edit/"),
        CurrentPage.PageLink,
        CurrentPage.LanguageBranch);

    uxEditBlogItem.Visible = CurrentPage.QueryDistinctAccess(AccessLevel.Edit); 
    ```

请注意，我已经使用`mode=simpleeditmode`了所有三个按钮。如果您不使用`mode=simpleeditmode`，您将在保存和发布页面后在标题中看到 EPiServer 编辑模式界面。

`epslanguage`如果您的网站只有一种语言，则没有必要。我添加它以防万一将来我们决定将其设为多语言。

`type`是硬编码的。有没有办法以更优雅的方式实现这一点？

# python - 从相关系数中找到 p 值

> ID：15966537
> 
> 赞同：0
> 
> 时间：2013-04-12T08:28:41.410
> 
> 标签：python, python-2.7

我有一本包含相关值的字典，

```
{u'1306': -0.20028268502286309, u'678': nan, u'575': -0.41858161444186959,   u'889': nan, u'984': -1.0, u'258': nan, u'1203': -0.34074604870778746, u'1000': -0.39718585102729265} 
```

如何找到上述结果的 p 值，我使用下面的代码来获取值

```
def calculate_pvalue(self,data,size):
    self.data=data
    self.size=size
    self.pvalue=self.data*math.sqrt((self.size-2)/(1-pow(self.data,2)))
    return(self.pvalue) 
```

我得到的结果如下，

```
{u'1306': -109.51766328031098, u'678': nan, u'1203': -194.16993218970686, u'889': nan, u'984': -inf, u'258': nan, u'575': -246.9217742472556, u'1000': -231.85995387407439} 
```

但我的问题是 p 值必须是概率？如何获得上述相关性的 p 值，我找到相关性的步骤是否正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T09:08:42.797

您正在计算*t*的值，如下所述：[http ://en.wikipedia.org/wiki/Pearson_product-moment_correlation_coefficient#Testing_using_Student.27s_t-distribution](http://en.wikipedia.org/wiki/Pearson_product-moment_correlation_coefficient#Testing_using_Student.27s_t-distribution)

然后，您应该从学生的*t*分布中查找*p*值。

 *请参阅[如何使用 numpy 计算统计“t-test”](https://stackoverflow.com/q/2324438/222914)。*

# permissions - 用户拒绝后再次请求地理位置权限

> ID：15966538
> 
> 赞同：1
> 
> 时间：2013-04-12T08:28:46.483
> 
> 标签：permissions, geolocation

我正在开发一个网站，在该网站中，不分享您的地理位置是一种禁忌。所以我想知道是否可以第二次询问用户是否允许他们分享他们的地理位置，或者让用户手动点击一个按钮来授予他们的权限或类似的东西。我可以想象，作为用户，您不想在第一次访问网站时分享您的地理位置，但是当您熟悉这个概念时，您应该能够更改它。

显然也欢迎任何其他解决此问题的建议

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-02T11:24:13.357

没有出路，因为当用户选择不共享地理位置时，浏览器设置会更改，并且不会进一步询问地理位置。用户可以手动更改设置。从 UI 的角度来看，您可以添加一个显示用户已禁用地理位置共享的模式，并让用户转到设置以更改浏览器首选项。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-12T11:06:24.600

```
function getLocation(){
   if (navigator.geolocation){
       navigator.geolocation.getCurrentPosition(showPosition);
   }
   else{
       message ="Geolocation is not supported by this browser.";
   }
}

<button onclick="getLocation()">Get Location</button> 
```

# profiling - Movable Type mt：具有插值类别的条目非常慢

> ID：15966541
> 
> 赞同：0
> 
> 时间：2013-04-12T08:29:08.940
> 
> 标签：profiling, movabletype

我有一个在 Movable Type 5.2 上运行的站点，我正在尝试简化我的一些模板，其中涉及根据它们也属于另一个类别来过滤当前类别中的条目。

这个模板片段（作为索引模板构建，它只是打印出每个类别中第一个条目的标题，也属于漫画类别）构建速度非常快（1-2 秒），尽管它有点笨拙：

```
<mt:Categories>
 <mt:SetVar name="show" value="1">
 <mt:Entries sort_order="ascend" limit="3">
  <mt:IfCategory label="Comic">
  <mt:If var="show" eq="1">
    Hello, <$mt:EntryTitle$>
    <mt:SetVar name="show" value="0">
  </mt:If>
  </mt:IfCategory>
 </mt:Entries>
</mt:Categories> 
```

我决定使用变量插值来简化它，最终构建需要 142 秒：

```
<mt:Categories>
 <$mt:CategoryLabel setvar="topCat"$>
 <mt:Entries sort_order="ascend" limit="1" category="$topCat AND Comic">
  Hello, <$mt:EntryTitle$>
 </mt:Entries>
</mt:Categories> 
```

如果我在标签上使用`<mt:SetVarBlock name="allCats"><$mt:EntryCategory$> AND Comic</mt:SetVarBlock>`和使用，构建也需要这么长时间。`category="$allCats"``<mt:Entries>`

有谁知道这里发生了什么，以及如何让事情变得更快？我还有一些其他模板，理论上可以从这些代码简化中受益（特别是一个类别模板，我想进一步将其限制为仅在附加类别中的条目），但最终花费太长时间来构建它们.

有没有一种很好的方法来分析 MT 以找出问题在其代码中的位置？我不害怕 Perl，但我也不知道有哪些分析工具可以用于它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T09:14:24.300

## 分析 MT

你可以看看这篇文章：[http ://www.movabletype.org/2008/10/making_it_easier_to_debug_and_test_your_templates.html](http://www.movabletype.org/2008/10/making_it_easier_to_debug_and_test_your_templates.html)

我没有在 5.X 中使用它，所以我不能告诉你它是否仍然有效，但我很想知道。

## 模板示例

使用包含 15,000 个条目和 20 个类别的测试博客，我无法让您的第一个代码块正常工作。首先，我希望您需要测试所有条目，而不仅仅是最后 3 个，以确保结果是严格的。也许一个真正古老的条目是第一个共享这两个类别的条目。

我修改了您的两个代码块，以获得我认为您想要的输出，即列出每个类别的最后一个条目，这些条目也共享一个给定类别（在您的情况下，“漫画”，但在我的测试中，“热门故事”） .

在我的 5.13 安装中，我发现两者之间存在差异`mt:EntryIfCategory`，`mt:IfCategory`尽管[文档](http://www.movabletype.org/documentation/appendices/tags/entryifcategory.html)指出前者已被弃用，而有利于后者。

当我运行这段代码时：

```
<mt:Categories>
  <mt:Var name="show" value="1">
  <mt:Entries lastn="99999">
  <mt:If var="show" eq="1">
    <mt:IfCategory label="Top Story">
Hello, <$mt:EntryTitle$>
      <mt:Var name="show" value="0">
    </mt:IfCategory>
  </mt:If>
  </mt:Entries>
</mt:Categories> 
```

我只得到了其中`Categories`一次迭代的输出，即外部类别与内部类别匹配的迭代。我在想`IfCategory`是测试外`Category`循环的类别，而不是内`Entries`循环的类别。当我更改为 时`EntryIfCategory`，它按预期工作。

所以我的最终代码是这样的（包括我用于计时的一堆代码）：

```
<mt:Section regex_replace="/^[\s]*$/mg","" regex_replace="/\n\n/mg","\n">
<mt:SetVarTemplate name="timingstart">
  <$mt:Date format="%H" setvar="hours"$>
  <$mt:Date format="%M" setvar="minutes"$>
  <$mt:Date format="%S" setvar="seconds"$>
  <$mt:Var name="hours" op="*" value="3600" setvar="hourseconds"$>
  <$mt:Var name="minutes" op="*" value="60" setvar="minuteseconds"$>
  <$mt:Var name="totalseconds" value="$hourseconds"$>
  <$mt:Var name="totalseconds" op="+" value="$minuteseconds" setvar="totalseconds"$>
  <$mt:Var name="totalseconds" op="+" value="$seconds" setvar="totalseconds"$>
  <$mt:Var name="totalseconds" setvar="startseconds"$>
</mt:SetVarTemplate>
<mt:SetVarTemplate name="timingstop">
  <$mt:Date format="%H" setvar="hours"$>
  <$mt:Date format="%M" setvar="minutes"$>
  <$mt:Date format="%S" setvar="seconds"$>
  <$mt:Var name="hours" op="*" value="3600" setvar="hourseconds"$>
  <$mt:Var name="minutes" op="*" value="60" setvar="minuteseconds"$>
  <$mt:Var name="totalseconds" value="$hourseconds"$>
  <$mt:Var name="totalseconds" op="+" value="$minuteseconds" setvar="totalseconds"$>
  <$mt:Var name="totalseconds" op="+" value="$seconds" setvar="totalseconds"$>
  <$mt:Var name="totalseconds" setvar="finishseconds"$>
  <$mt:Var name="finishseconds" op="-" value="$startseconds" setvar="elapsedseconds">
This code block completed in <mt:If name="elapsedseconds" eq="0">less than 1 second<mt:Else name="elapsedseconds" eq="1">1 second<mt:Else><$mt:Var name="elapsedseconds"$> seconds</mt:If>.
</mt:SetVarTemplate>
++++++++++++++++++++++++++++++++++++++++++
<$mt:Var name="timingstart"$>
<mt:Categories>
  <mt:Var name="show" value="1">
  <mt:Entries lastn="99999">
  <mt:If var="show" eq="1">
    <mt:EntryIfCategory label="Top Story">
Hello, <$mt:EntryTitle$>
      <mt:Var name="show" value="0">
    </mt:EntryIfCategory>
  </mt:If>
  </mt:Entries>
</mt:Categories>
<$mt:Var name="timingstop"$>
++++++++++++++++++++++++++++++++++++++++++
<$mt:Var name="timingstart"$>
<mt:Categories>
 <mt:SetVarBlock name="cats"><$mt:CategoryLabel$> AND Top Story</mt:SetVarBlock>
 <mt:Entries lastn="1" category="$cats">
Hello, <$mt:EntryTitle$>
 </mt:Entries>
</mt:Categories>
<$mt:Var name="timingstop"$>
++++++++++++++++++++++++++++++++++++++++++
</mt:Section> 
```

我的输出在两个块中都匹配：

> ++++++++++++++++++++++++++++++++++++++++++++
> 你好，冰球场亮绿灯
> 你好，法官驳回集体谈判法
> 你好，ALRC 探索市中心的酒吧
> 你好，法官驳回集体谈判法
> 你好，无证学生：州内学费对 1 名威斯康星大学学生意味着什么你好，
> 为正当理由冻结
> 你好，Dems 推动沃克健康关怀计划
> 你好，学生会着手 WISPIRG 立法
> 你好，威斯康星大学校园选民身份证法案可能的好处，缺点
> 你好，集会激起群众夺回威斯康星州
> 你好，主要的冬季风暴席卷麦迪逊
> 你好，照片：2011 届毕业生
> 您好，奥巴马周一访问麦迪逊
> 您好，ASM 准备接受 MCSC 的最终上诉
> 您好，奥巴马周一访问麦迪逊
> 您好，共和党领导层任命约翰逊为 3 个主要委员会成员
> 您好，杰米汤姆森获得胚胎研究全球奖
> 您好，推荐工作组新板
> 你好，教员权衡人力资源重新设计计划
> 你好，拉力赛激起人群收回 Wis。
> 这个代码块在 18 秒内完成。
> ++++++++++++++++++++++++++++++++++++++++++++
> 你好，冰球场亮绿灯
> 你好, 法官废除集体谈判法
> 你好，ALRC 探索市中心的酒吧
> 你好，法官废除集体谈判法
> 你好，无证学生：州内学费对 1 名威斯康星大学学生意味着什么
> 你好，出于正当理由冻结
> 你好，民主党推动 Walker 实施医疗保健计划你好 ，
> 学生会着手 WISPIRG 立法
> 威斯康星大学校园
> 你好，集会激起群众夺回威斯康星州。
> 你好，主要冬季风暴席卷麦迪逊
> 你好，照片：2011 届毕业生
> 你好，奥巴马周一访问麦迪逊
> 你好，ASM 准备接受最终的 MCSC 上诉
> 你好，奥巴马周一访问麦迪逊
> 你好，共和党领导层任命约翰逊为 3 个主要委员会成员
> 你好，杰米·汤姆森 (Jamie Thomson) 获得胚胎研究全球奖
> 你好，推荐新板的工作组
> 你好，教师权衡人力资源重新设计计划
> 你好，拉力赛激起人群回收 Wis。
> 这个代码块在 12 秒内完成。
> ++++++++++++++++++++++++++++++++++++++++++++++

请注意，在此安装中，第二个块的运行速度比第一个块快三分之一。为了与您的 152 秒值进行比较，这是我使用 20 个类别和 15,000 个条目所花费的十倍，我需要更多地了解您拥有多少个类别和条目。

# sql-server - sql server 2005 管理错误

> ID：15966543
> 
> 赞同：0
> 
> 时间：2013-04-12T08:29:09.900
> 
> 标签：sql-server, sql-server-2008, sql-server-2005, sql-server-2008-r2

我有一个使用 DBMS Sql server 2008 express 的应用程序。我使用 Microsoft Sql Server Management Studio express 2005 来管理我的数据库。

我创建了新的数据库，我想向它添加新表，但出现了如图所示的错误：

![错误](https://i.stack.imgur.com/9fJ2k.png)

我也有这些服务，只有第一个开始 ![服务](https://i.stack.imgur.com/ETkWc.png)

为什么会出现这个错误？我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:43:45.320

可能是以下链接可能会有所帮助，试试看

[http://harshgupta71.blogspot.in/2013/02/the-specified-module-could-not-be-found.html](http://harshgupta71.blogspot.in/2013/02/the-specified-module-could-not-be-found.html)

或者

[http://www.sqlservercentral.com/Forums/Topic416551-324-2.aspx#bm1438999](http://www.sqlservercentral.com/Forums/Topic416551-324-2.aspx#bm1438999)

# c++ - 从带有字体的字符串中获取像素数据的简单方法

> ID：15966559
> 
> 赞同：1
> 
> 时间：2013-04-12T08:29:42.310
> 
> 标签：c++, fonts

假设我在 RAM 中制作了一个二维数组。是否有任何库可以轻松*直接*绘制到我的数组（而不是将文本绘制到屏幕或 VRAM 中的渲染目标）？

即使我至少可以使用指定的字体获取单个字符的像素数据也会很好。

我对 C++ 比较陌生，所以它需要简单..

如果指定的字体不使用/存储位图，那么它必须为我转换它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:36:51.833

[FreeType](http://www.freetype.org/)是一个在类 BSD 许可下的跨平台开源库，可渲染十几种字体类型（包括 TrueType 和 OpenType），适用于所有主要操作系统。

作为替代方案，您可以使用特定于操作系统的 API 将文本呈现到内存位图（可以像数组一样直接访问）。渲染到屏幕和渲染到内存位图没有区别，您只需要创建一个离屏位图图像并选择它作为目标。在 Windows 中，使用`CreateDIBSection`函数；在 OS X 中，创建`NSBitmapImageRep`对象或使用`CGBitmapContextCreate`函数（在 iOS 中也可用）。在所有这些中，这都是一项非常容易的任务（不到 100 行代码），创建 2-4 个特定于操作系统的文件可能比采用 FreeType 更容易（尤其是如果您已经知道这些 API）。

# java - Apache Camel：重命名 (S)FTP 目标文件以防止覆盖

> ID：15966566
> 
> 赞同：1
> 
> 时间：2013-04-12T08:29:51.053
> 
> 标签：java, apache-camel

我正在尝试设置从一个 SFTP 位置到另一个位置的路由，移动文件（而不是复制）。如果源文件具有相同的名称，我想防止目标文件被覆盖。

我的路线目前看起来像这样：

```
from("sftp://camel@server1/Source?password=camel&delete=true").to("sftp://camel@server2/Target?password=camel"); 
```

我的问题是 Source 中的新文件与之前的同名文件将覆盖 server2 中的目标文件。如果目标已经存在，我如何告诉 Camel 给目标一个新名称？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:37:44.560

从文件[组件](http://camel.apache.org/file2.html)`FileExist`

> 如果已存在同名文件怎么办。可以指定以下值：**Override**、**Append**、**Fail**、**Ignore**和**Move**。覆盖是默认值，它替换现有文件。Append 将内容添加到现有文件。Fail 抛出一个**GenericFileOperationException**，表明已经存在一个文件。Ignore 会默默地忽略问题并且不会覆盖现有文件，而是假设一切正常。Move 选项需要**Camel 2.10.1**及更高版本，并且还需要配置相应的**moveExisting**选项。选项**eagerDeleteTargetFile**可用于控制在移动文件时执行的操作，并且已经存在现有文件，否则会导致移动操作失败。移动选项将在写入目标文件之前移动任何现有文件。

所以你可以抛出异常并捕获它并以不同的名称移动它。

# python - 我如何在 django 中进行长查询

> ID：15966568
> 
> 赞同：0
> 
> 时间：2013-04-12T08:30:16.930
> 
> 标签：python, django

我有这个查询过滤器。但我不知道如何使它工作

```
st = Student.objects.filter(
    if request.GET['student_number']:
        Q(student_number__icontains=request.GET['student_number'])&
    if request.GET['student_region']:
        Q(student_region__icontains=request.GET['student_region']) &
    if request.GET['student_status']:
        Q(student_status__icontains=request.GET['student_status']) &
    if request.GET['student_process']:
        Q(student_process__name__icontains=request.GET['student_process']) & 
```

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T09:24:15.907

您可以像这样动态构建查询：

```
query_list = []
for field_name in ['student_process', 'student_status', 'student_number', 'student_region', ]:
    value = request.GET.get(field_name, None)
    if value:
        query_list.append(Q(**{field_name+'s_icontains': value}))
queryset = Student.objects.filter(reduce(operator.and_, query_list)) 
```

[这是关于该主题的一篇很好的博客文章](http://yuji.wordpress.com/2009/09/12/django-python-dynamically-create-queries-from-a-string-and-the-or-operator/)

# html - 一个宽度为 100% 高度为 100% 的 div 上的边距在另一个宽度为 100% 高度为 100% 的 div 内

> ID：15966570
> 
> 赞同：1
> 
> 时间：2013-04-12T08:30:21.480
> 
> 标签：html, css, margin, centering

我正在建立一个以视频为背景的网站。我希望所有 div 居中且响应迅速，这就是为什么我使用 100% 的宽度和高度。然后我有一个覆盖的 div 使用 jquery 在点击时淡入淡出。我的问题是，在它淡入之后，我似乎无法在这个 div 周围获得均匀的边距。我想要边距的 div 的 id 为“info”。

我的 html 看起来像这样：

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <meta name="description" content=""/>
        <meta name="keywords"content=""/>
        <title></title>
        <link href="css/main.css" rel="stylesheet" type="text/css"/>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script>
$(document).ready(function(){
  $("#btn").click(function(){
    $("#info").fadeToggle("slow");
  });
});
</script>
    </head>
    <header>
        <div id="nav">
            <p><a id="btn" href="#">+</a></p>
        </div>
    </header>
    <body>
        <div id="container">
            <div id="info">
            </div>
        </div>
    </body>
    <video id="video_background" src="vid/147000037.mp4" autoplay>
</html> 
```

和我的CSS：

```
* {
    margin: 0;
    padding: 0;
}

body {
    font-family: "HelveticaNeue-UltraLight","HelveticaNeue-Light","Helvetica Neue",Helvetica,Arial,sans-serif;

}

header {
    z-index: 999;
    display: block;
    height: auto;
    width: 100%;
    position: fixed;
}

header a {
    text-decoration: none;
    font-size: 1.8em;
    color: #000000;
}

#nav {
    position: relative;
    float: right;
    top: 15px;
    right: 20px;
    color: #000000;
}

#container {
    height: 100%;
    width: 100%;
    display: block;
}

#video_background {
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  z-index: -1000;
}

#info {
    height: 100%;
    width: 100%;
    background: rgba(255,255,255,0.97);
    z-index: 900;
    display: none;
    position: fixed;
    margin: 10px;
    vertical-align: center;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T10:31:44.100

由于您的信息框具有固定的定位，您可以省略 CSS 中的高度/宽度和边距，并使用偏移量创建一个具有良好边距的响应式容器。只需将您的`#info`css 更改为以下内容：

```
#info {
   /* omit height & width */
   background: #bada55; /* Just because white on white is tough to see */
   z-index: 900;
   display: none;
   position: fixed;
   /* omit margin and use according offsets */
   top:15px;left:15px;right:15px;bottom:15px;
   vertical-align: center;
} 
```

看到它[在这里工作](http://jsfiddle.net/VU3PU/)。

# symfony - SonataAdminBundle ：显示非粗略（统计）

> ID：15966575
> 
> 赞同：26
> 
> 时间：2013-04-12T08:30:37.277
> 
> 标签：symfony, sonata-admin, symfony-2.2

我正在使用奏鸣曲管理包来生成我的后端，我对此非常满意，我也想使用我的后端来显示统计数据。

我想我可以通过调整包的视图来做到这一点，也许是“standard_layout.html.twig”。

问题是，我找不到例子，甚至找不到人谈论它，所以我想知道，这可能吗？人们谈论它不是因为它太简单了吗？你做了吗 ？

我真的很想有一个后端，所以请赐教！

谢谢你，cpndz

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-04-13T11:32:04.360

是的，有可能。可以使用 Sonata Block 或使用您自己的控制器来完成。

如果你使用你的**控制器**，你可以从默认的 CRUD 控制器重载（一个或多个）动作，渲染结果的样子取决于你。

1.  **`SonataAdminBundle:CRUD`在您的管理服务定义中用您的控制器**AcmeDemoAdminBundle:ProductStatisticsAdmin**替换默认控制器并****删除实体**，因为我们将尝试在没有 CRUD 操作的情况下呈现我们的统计信息。

    ```
    <service id="acme_demo_admin.product_statistics" class="Acme\Bundle\DemoAdminBundle\Admin\ProductStatisticsAdmin">
        <tag name="sonata.admin" manager_type="orm" group="statistics_group" label_catalogue="admin" label="Product Statistics" />
        <argument />
        <argument />
        <argument>AcmeDemoAdminBundle:ProductStatisticsAdmin</argument>
    </service> 
    ```

2.  **`ProductStatisticsAdmin`在`Acme/Bundle/DemoAdminBundle/Admin/ProductStatisticsAdmin.php`. **_** 该类将非常简单，因为我们只需要`list`操作而不需要其他 CRUD 操作。**

     **```
    <?php
    namespace Acme\Bundle\DemoAdminBundle\Admin;

    use Sonata\AdminBundle\Admin\Admin;
    use Sonata\AdminBundle\Route\RouteCollection;

    class ProductStatisticsAdmin extends Admin
    {
        protected $baseRoutePattern = 'product-statistics';
        protected $baseRouteName = 'productStatistics';

        protected function configureRoutes(RouteCollection $collection)
        {
            $collection->clearExcept(array('list'));
        }
    } 
    ```** 
***   **在Sonata 的 CRUDController中**创建控制器**ProductStatisticsAdminController`Acme/Bundle/DemoAdminBundle/Controller/ProductStatisticsAdminController.php`并重载。`listAction()`在此操作中，您可以调用您的数据库并检索统计信息，然后使用您的模板呈现它们。**

     **```
    <?php

    namespace Acme\Bundle\DemoAdminBundle\Controller;

    use Sonata\AdminBundle\Controller\CRUDController as Controller;
    use Symfony\Component\Security\Core\Exception\AccessDeniedException;

    class ProductStatisticsAdminController extends Controller
    {
        public function listAction()
        {
            if (false === $this->admin->isGranted('LIST')) {
                throw new AccessDeniedException();
            }

            //... use any methods or services to get statistics data
            $statisticsData = ...

           return $this->render('AcmeDemoAdminBundle:ProductStatistics:product_statistics.html.twig', array(
                        'statistics_data'  => $statisticsData,
                    ));
        }
    } 
    ```** ***   **创建模板** `product_statistics.html.twig`以生成图表并显示统计信息`Acme/Bundle/DemoAdminBundle/Resources/views/ProductStatistics/product_statistics.html.twig`

    ```
    {% extends base_template %}

    {% block javascripts %}
        {{ parent() }}
        {# put links to javascript libraries here if you need any #}
    {% endblock %}

    {% block content %}
        {# put some html code to display statistics data or use some javascript library to generate cool graphs #}
    {% endblock %} 
    ```**** 

 ***** * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-04-15T10:22:57.723

由于 pulzarraider 向我们解释了这样做的一种方法，我将解释另一种方法。

块捆绑的方式允许以非常强大的方式自定义仪表板。您可以同时关注Block [bundle doc](http://sonata-project.org/bundles/block/master/doc/reference/your_first_block.html)

**1\. 在 Copndz\MyBundle\Block\Service 中创建 StatisticsBlockService.php**

我想通过对存储的数据进行数学运算来显示统计信息：我需要

*   导入实体管理器
*   将属性 $em 添加到服务
*   添加构造函数 __construct，它将调用其父构造函数并使用传入参数的 EntityManager 设置 $em

```
namespace Copndz\MyBundle\Block\Service;
use Symfony\Component\HttpFoundation\Response;
use Sonata\AdminBundle\Form\FormMapper;
use Sonata\AdminBundle\Validator\ErrorElement;
use Sonata\BlockBundle\Model\BlockInterface;
use Sonata\BlockBundle\Block\BaseBlockService;
use Doctrine\ORM\EntityManager;

class StatisticsBlockService extends BaseBlockService
{
    private $em;

    /**
     * {@inheritdoc}
     */
    public function execute(BlockInterface $block, Response $response = null)
    {
        $settings = array_merge($this->getDefaultSettings(), $block->getSettings());

        $myentityrepository = $this->em->getRepository('CopndzMyBundle:MyEntity');
        $myentity = $myentityrepository->find('5');

        return $this->renderResponse('CopndzMyBundle:Block:block_statistics.html.twig', array(
            'block'     => $block,
            'settings'  => $settings,
            'myentity' => $myentity,   
        ), $response);
    }

    /**
     * {@inheritdoc}
     */
    public function validateBlock(ErrorElement $errorElement, BlockInterface $block)
    {
        // TODO: Implement validateBlock() method.
    }

    /**
     * {@inheritdoc}
     */
    public function buildEditForm(FormMapper $formMapper, BlockInterface $block)
    {
        $formMapper->add('settings', 'sonata_type_immutable_array', array(
            'keys' => array(
                array('content', 'textarea', array()),
            )
        ));
    }

    /**
     * {@inheritdoc}
     */
    public function getName()
    {
        return 'Text (core)';
    }

    /**
     * {@inheritdoc}
     */
    public function getDefaultSettings()
    {
        return array(
            'content' => 'Insert your custom content here',
        );
    }

    public function __construct($name, $templating, EntityManager $entityManager)
    {
            parent::__construct($name, $templating);
            $this->em = $entityManager;
    }
} 
```

**2.在MyBundle\Ressources\config\services.yml中创建服务**

```
 sonata.block.service.statistics:
      class: Copndz\MyBundle\Block\Service\StatisticsBlockService
      tags:
        - { name: sonata.block }
      arguments:
        - "sonata.block.service.statistics"
        - @templating
        - @doctrine.orm.entity_manager 
```

**3.在我的config.yml中将这个服务添加到sonata_block**

```
sonata_block:
    default_contexts: [cms]
    blocks:
        sonata.admin.block.admin_list:
            contexts:   [admin]

        sonata.block.service.text:
        sonata.block.service.rss:
        sonata.block.service.statistics: 
```

**4\. 在 Copndz\MyBundle\Ressources\views\Block 中创建模板 block_statistics.html.twig**

```
{% extends sonata_block.templates.block_base %}

{% block block %}
    {{ myentity.name }}
{% endblock %} 
```

**5.最后在config.yml的admin bundle配置中调用服务**

```
sonata_admin:
    dashboard:
        blocks:
            # display a dashboard block
            - { position: left, type: sonata.admin.block.admin_list }
            - { position: right, type: sonata.block.service.statistics } 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-05-12T17:03:59.560

实际上使用块和创建单独的页面有点不同。我认为 OP 正在尝试在奏鸣曲管理员中创建单独的页面。

1.  创建一个控制器，在`routing.yml`文件中配置它的路由，如果您希望 URL 看起来类似于 sonata admin，请设置一个与 sonata admin 的前缀相同的前缀。

2.  渲染模板。这里有两个技巧。

    首先，您需要从奏鸣曲管理员的“布局”模板扩展。如果您在 中进行了更改`config.yml`，请相应地更新代码。[参考](http://sonata-project.org/bundles/admin/master/doc/reference/templates.html)

    ```
    {% extends "SonataAdminBundle::standard_layout.html.twig" %} 
    ```

    现在你会看到奏鸣曲管理员的菜单栏和页脚已经来到这个新页面。但是菜单是空的。要显示菜单，您需要`admin_pool`从控制器传递到模板。

    ```
    $admin_pool = $this->get('sonata.admin.pool');

    return array(
        'admin_pool' => $admin_pool,
        // Other variables to pass to template
    ); 
    ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-19T13:15:12.637

这是您的问题的另一个解决方案：[http ://blog.eike.se/2014/03/custom-page-controller-in-sonata-admin.html](http://blog.eike.se/2014/03/custom-page-controller-in-sonata-admin.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-12T11:41:02.100

我相信您想要实现的目标可以使用 Sonata Admin Bundle 的 Sonata Block Bundle 部分来完成。

Sonata Admin Dashboard 文档[http://sonata-project.org/bundles/admin/2-1/doc/reference/dashboard.html](http://sonata-project.org/bundles/admin/2-1/doc/reference/dashboard.html)

虽然我自己没有做过。****

# asp.net-mvc - 如何使用 oracle 数据提供程序配置 ASP.net MVC 4 应用程序？

> ID：15966576
> 
> 赞同：0
> 
> 时间：2013-04-12T08:30:38.353
> 
> 标签：asp.net-mvc, asp.net-mvc-4, oracle11g

我有 Asp.net mvc 4 应用程序这是一个连接字符串

```
<add name="OracleConnectionString" connectionString="Data Source=localhost;User Id=RABS;Password=*******;Unicode=True" providerName="System.Data.OracleClient"/> 
```

还安装在我的机器上 oracle 11g R2 Express 和 Oracle 数据提供程序 for .net { ODAC 11.2 Release 5 和 Oracle Developer Tools for Visual Studio (11.2.0.3.20)} 从[这里](http://www.oracle.com/technetwork/topics/dotnet/utilsoft-086879.html)

当我创建模型类并生成控制器时，我遇到了这个错误消息，找不到请求的 .net 框架数据提供程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-19T12:37:35.543

You will keep getting errors because the solution is not as simple as changing the connection string. Look at the answers to this similar question: [Use an Oracle database with forms authentication in an MVC3 application](https://stackoverflow.com/questions/8562734/use-an-oracle-database-with-forms-authentication-in-an-mvc3-application?rq=1)

One of the answers suggests taking a look at this tutorial: [http://quysnhat.wordpress.com/2011/09/13/using-membership-with-oracle-database-in-asp-net-mvc-3/](http://quysnhat.wordpress.com/2011/09/13/using-membership-with-oracle-database-in-asp-net-mvc-3/)

# c# - 如何在 asp.net 应用程序中使用命名空间？

> ID：15966579
> 
> 赞同：2
> 
> 时间：2013-04-12T08:30:41.133
> 
> 标签：c#, asp.net, namespaces, access-specifier

如何在相同或不同的命名空间但在同一个应用程序中使用“公共变量”？

例如：

BookStore Web 应用程序中的第一个命名空间

```
namespace BookStore
{
    public partial class index : System.Web.UI.Page
    {
        public string command; // the public variable declared 
```

第二个命名空间，在同一 BookStore 应用程序中

```
namespace Admin.BookStore // here i try to include the BookStore namespace..
{
    public partial class admin : System.Web.UI.Page
    {
        void access()
        {
            command = "something text" ; 
```

在这里，我认为`command`应该在智能感知中看到。我认为因为它是一个公共变量，但它没有出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:37:24.507

在管理类中，您还可以将以下内容添加到文件顶部：

```
Using BookStore; 
```

但是， index 不是静态类，因此您必须拥有该类的实例才能使用命令字段；

```
Index indexInstance = new Index();
indexInstance.command = "something text"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:40:23.593

有很多方法可以做到这一点，但令人担忧的是，您正试图跨页面设置相同的变量——没有会话/静态，这将不起作用。

我的方式（对于初学者）是开始使用类继承。

尝试这个：

```
namespace BookStore
{
    public partial class index : BasePage
    {

    }
}

namespace Admin.BookStore
{
    public partial class index : BasePage
    {
        void access()
        {
            base.command = "something text"; // This accesses the BasePage variable
        }
    }
}

namespace BookStore
{
     public class BasePage : System.Web.UI.Page
     {
          // public static string command { get; set; } // Bad practice IMO
          public string command 
          {
               get {
                   if(Session["command"] != null) return Session["command"].ToString();
                   return String.Empty;
               }
               set {
                   Session["command"] = value;
               }
          }  
     }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:41:09.433

在包含该类的文件中`admin`，滚动到页面顶部并插入该行

```
using BookStore; 
```

请注意，这通常位于您要添加到的文件中的命名空间声明之上。这使您的类/页面对将要使用它的类可见。

要遵循您提供的示例，您现在需要一个类的实例才能访问公共字段：

```
var myIndexObject = new index();
myIndexObject.command = "my value"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T08:59:06.163

要访问不同命名空间中的类，您需要从应用程序根命名空间中指定或“使用”完整的命名空间。

例如：如果您的应用程序根命名空间是`AppNameSpace`：

```
AppNameSpace.BookStore.index.command = "..." 
```

或者

```
using AppNameSpace.BookStore
'
'
'
index.command = "..." 
```

# java - IBM Rapid Application Developer 8.5.1 滚动条不可拖动（企业资源管理器\包资源管理器）+ JSP 上的 Ctrl-F 有时不工作

> ID：15966581
> 
> 赞同：0
> 
> 时间：2013-04-12T08:30:47.127
> 
> 标签：java, eclipse, jsp, ibm-rad

我目前在 Windows 7 64 位上安装了 IBM Rapid Application Developer 8.5.1，我遇到了这两个问题：

*   我无法通过用鼠标在企业资源管理器和包资源管理器上拖动滚动条来滚动。如果我这样做，它会进入第一个状态。我可以使用箭头滚动或通过单击滚动条下方/上方或使用鼠标滚轮滚动
*   使用`Ctrl`+`F`在我的 jsp 中查找某些内容有时不起作用。当我重新启动 IBM RAD 时，它又可以工作了，但是很烦人。

问题：这是 RAD（或 Eclipse？）中的错误还是 Windows 7 的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-25T14:05:39.743

To make scrollbars draggable under windows 7 64bit:

Preferences\General\Appereance => uncheck "Enable animations" and "Enable colored labels". The IDE will issue a restart ("yes"...) and scrollbars will be draggable as expected.

I don't think this will impact ctrl+f, though.

In the end, sounds like an incompatibility between desktop compositing and (old) SWT

# google-apps-script - 谷歌脚本电子邮件

> ID：15966582
> 
> 赞同：1
> 
> 时间：2013-04-12T08:30:47.323
> 
> 标签：google-apps-script

我在下面有一行可以在谷歌脚本中发送带有单词附件的电子邮件，但由于某种原因，只有所有者 [我] 可以运行下面的代码，并且我确实收到了带有附件的电子邮件。对于普通用户，以下代码不会执行，我确实在我的帐户和用户帐户上授权了脚本。由于它对我有用，我认为这一定是授权问题。它也曾经为用户工作。

```
MailApp.sendEmail(email, "Your Files - " + folder.getName(),
        "Please find your files attached.", {attachments: attachFiles}); 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-16T14:36:42.470

您是在连接用户或您（脚本所有者）的权限下运行此脚本吗？如果是这种情况，请将其更改为“用户访问 Web 应用程序”。

你能提供更多细节吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-09T06:05:28.107

如果这是对表格/表格的附加，您可能还需要与用户共享表格。用户尝试访问脚本时是否得到提示？他们看到什么错误信息？

“var email”是一个电子邮件地址还是多个？

如果这是一个已发布的 Web 应用程序，请确保在运行 /dev 时保存并发布最新版本，并且用户会看到 /exec 文件 > 管理版本 保存新版本 发布 > 部署为 Web 应用程序更新最新项目版本

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-15T16:52:18.983

发布或部署时，您是否忘记将执行行为更改为“用户访问 Web 应用程序”？

# keyboard-shortcuts - 在 SQLDeveloper 中快速打开表

> ID：15966586
> 
> 赞同：11
> 
> 时间：2013-04-12T08:30:50.463
> 
> 标签：keyboard-shortcuts, oracle-sqldeveloper

我将 Oracle SQL Developer 用于一个非常大的项目，其中包含大量表。

有没有一种方法可以通过输入表格名称快速打开表格？

例如，在 IntelliJIDEA 中，`ctrl + shift + N`快捷方式会打开一个带有字段的小弹出窗口，我可以在其中键入文件名。显示名称中包含搜索文本的文件，我可以通过点击快速打开其中一个`Enter`。

我知道表格在左侧面板中按字母顺序排序，但我有很多表格，我相信这会节省一些时间。

Oracle SQLDeveloper 中是否有类似的东西？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-12T09:06:32.323

从“视图”菜单中有一个“查找数据库对象”选项，它打开一个（可停靠，我认为默认停靠）窗口；选择连接后，您可以按名称找到任何对象。也许没有你想要的那么快，但我想如果你有空间的话，你可以让那个窗户打开。如有必要，您可以使用通配符。

如果您在 SQL 工作表中，您可以右键单击表名并选择“弹出式描述”，这会在新窗口中打开相同的对象视图，但如果您不知道整个名称，这将无济于事.

刚开始`from`在 SQL 工作表中键入表名（在 ! 之后）将显示一个自动完成的匹配列表，如果您已配置（首选项-> 代码编辑器-> 完成洞察）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-03-21T14:48:50.127

非常老的问题，但我遇到了同样的问题，提供的答案没有打开表格。

在 SQL 工作表中，您可以右键单击表的名称（您必须先编写它！），然后单击“打开声明”。

快捷方式未分配，您可以通过Others -> Open Declaration手动分配。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2016-11-15T11:33:04.703

使用 Ctrl+空格键显示表名的下拉菜单。

# geocoding - iO6 CLGeocoder：总是只返回一个对象

> ID：15966587
> 
> 赞同：1
> 
> 时间：2013-04-12T08:30:50.653
> 
> 标签：geocoding, ios6-maps, apple-maps

在下面的代码中，我总是从地理编码 NSArray *placemarks 中返回一个对象。我做了一个 NSLog 它总是显示为一个对象。无论我在搜索栏中输入什么。

我正在我的 iPhone 5 设备上对其进行测试。我住在旧金山，设备地图工作得很好。即当我输入“星巴克”时，我只得到一个对象，它被称为“Álvaro Obregón，联邦区 01020” 附近至少有 10 家星巴克。

```
-(BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString {

    [geocoder geocodeAddressString:searchString completionHandler:^(NSArray* placemarks, NSError* error)

  if ([placemarks count] > 0) {
        NSLog(@"Number of objects in placemarks %i",placemarks.count);
        for (CLPlacemark* aPlacemark in placemarks)
        {
            self.street = aPlacemark.thoroughfare;
            self.city = aPlacemark.locality;
            self.state = aPlacemark.administrativeArea;
            self.zip = aPlacemark.postalCode;

            NSMutableString *result = [NSMutableString string];
            if (self.street)
                [result appendString:self.street];
            if (self.street && (self.city || self.state || self.zip))
                [result appendString:@", "];
            if (self.city)
                [result appendString:self.city];
            if (self.city && self.state)
                [result appendString:@", "];
            if (self.state)
                [result appendString:self.state];
            if (self.zip)
                [result appendFormat:@" %@", self.zip];
            placemarksArray = [[NSMutableArray alloc]init];
            [self.placemarksArray addObject:result];
            NSLog(@" This is result %@", result);

            [self.searchDisplayController.searchResultsTableView reloadData];
        }
    }

} 
 ]; 
return NO; 
```

}

# php - 模块配置 Zend 框架 2 中的约束模式

> ID：15966590
> 
> 赞同：3
> 
> 时间：2013-04-12T08:30:56.327
> 
> 标签：php, zend-framework, zend-framework2, design-patterns

是否可以将约束模式设置为仅数字和 &？

所以我可以制作一个像这样的网址：`localhost/cms/user/multipledelete/1&2`

我现在有以下配置，但它只允许数字。我希望an`ID`可以是数字和&。

这是我的代码：

```
'route'    => '/user[/:action][/:id][/sort/:order_by][/:order][/page/:page]',
   'constraints' => array(
   'action' => '(?!\bsort\b)(?!\bpage\b)[a-zA-Z][a-zA-Z0-9_-]*',
   'id'     => '[0-9]+',
   'order_by' => '[a-zA-Z][a-zA-Z0-9_-]*',
   'order' => 'asc|desc',
   'page' => '[0-9]+',
 ), 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T08:43:15.333

使用以下模式：

```
[0-9&]+ 
```

像：

```
'constraints' => array(
   'action' => '(?!\bsort\b)(?!\bpage\b)[a-zA-Z][a-zA-Z0-9_-]*',
   'id'     => '[0-9&]+',
   'order_by' => '[a-zA-Z][a-zA-Z0-9_-]*',
   'order' => 'asc|desc',
   'page' => '[0-9]+',
), 
```

# java - 如何从struts json的序列化过程中排除基类

> ID：15966592
> 
> 赞同：4
> 
> 时间：2013-04-12T08:31:13.727
> 
> 标签：java, json, inheritance, serialization, struts2

我可以通过以下方式将属性序列化到基类（2 级）。

```
public class BaseRoot{
 String prop1; //getter and setter
}

public class SubClass extends BaseRoot{
 String prop2; //getter and setter
}

public class ActionClass extends SubClass{
 String prop3; //getter and setter
} 
```

在struts json中，我可以使用序列化所有属性

```
<result type="json">
 <param name="ignoreHierarchy">false</param> //This will allow parent to be serializable
 <param name="excludeProperties">price,description</param> //Exclude parameters
</result> 
```

但我只想序列化类 ActionClass 和 SubClass。我不想序列化 BaseRoot 和其他由 BaseRoot 类扩展的类。我知道我可以排除属性。但我想从序列化中排除整个类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T17:44:46.287

使用默认功能无法做到这一点。

您需要编写自己的结果类型，或者可能是序列化程序，您可以将其插入现有的或新的结果类型——不确定哪个更容易。

也就是说，我发现这个设计/需求有点粗略——也许你想要一个 Presenter、Decorator、Facade 等，而不是试图破解具体的类。

# stack - SIM 900：错误 604 堆栈忙

> ID：15966594
> 
> 赞同：0
> 
> 时间：2013-04-12T08:31:21.637
> 
> 标签：stack, arduino, ip-address, gsm, gprs

我正在使用用于 Arduino 的 SIM 900 GPRS Shield 使用 HTTP 命令发送数据；有时当我使用命令时

```
AT+HTTPACTION=1 
```

我收到错误代码 604，这意味着堆栈忙。有人知道是什么问题吗？

如果我重置电路板，我会收到同样的错误；我注意到如果我关闭并打开GPRS板，以便我收到一个新的IP地址，则不会发生错误，所以就像旧IP地址被“阻止”一样；为什么？

# c - 如何使用字符串赋值结构？

> ID：15966600
> 
> 赞同：-3
> 
> 时间：2013-04-12T08:31:37.017
> 
> 标签：c

代码：

```
#include <stdio.h>
#include <stdlib.h>

struct super_block {
        unsigned short s_ninodes;
        unsigned short s_nzones;
};

#define NR_SUPER 8
struct super_block super_block[NR_SUPER];

int
main()
{
        struct super_block * p;
        struct super_block * s;
        char b_data[] = "2020";

        for(p = &super_block[0] ; p < &super_block[NR_SUPER] ; p++) {
                p->s_ninodes= 0;
                p->s_nzones = 0;
        }

        s = super_block;

        *(s) = *((struct super_block *) b_data);
        printf("%d\n%d\n", s->s_ninodes, s->s_nzones);
        return 0;
} 
```

问题是：我想

```
s->s_ninodes =20 and s->s_nzones=20, how to solve it ? 
```

为什么`"*(s) = *((struct super_block *) b_data);"`不行？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:50:11.967

该`b_data`数组长 5 个字节（“2020”=> 4 个字符加上结尾`\0`）。假设您的结构已打包，并且`sizeof(short) == 2`您的`struct superblock`对象将接收字符串中字符的字节值。在这里，给定常见的 ASCII 值，您可能会得到（以十六进制方式避免字节序讨论）`s->s_ninodes == s->s_nzones == 0x6260`。

如果您想坚持使用这种模糊方法来影响结构中的数据，那么只需尝试使用`short b_data[] = {20,20}`，并祈祷您的结构被打包......（或添加一个`__attribute__((packed))`标记）。无论如何，在没有充分理由的情况下做出这种做作是一种*非常糟糕*`__attribute__((packed))`的做法（通常，充分的理由是检索需要解析的数据流，并且在这种情况下，您最有可能在数据结构定义）。

*编辑*：我不知道为什么，但是在做这些事情时，在我看来，使用`memcpy()`而不是简单的做作使它更清晰（我猜更容易阅读和发现缓冲区溢出）。

# eclipse-emf - 如何将 Xcore 导出到 Ecore？

> ID：15966601
> 
> 赞同：4
> 
> 时间：2013-04-12T08:31:38.550
> 
> 标签：eclipse-emf, ecore, mdd, xcore

使用 Xcore 定义元模型比使用 EMF 和 Ecore 容易得多。问题是我需要将元模型作为 Ecore 文件。是否可以将 Xcore 模型导出到 Ecore 模型？我在 Eclipse 中看不到任何导出选项。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T15:57:50.413

[官方 Wiki](http://wiki.eclipse.org/Xcore#Converting_an_Xcore_Model_to_a_GenModel)描述了如何将Xcore 模型导出到 GenModel。看起来 Ecore 模型也可以做到这一点。特别是因为作者提到：

> [...] Xcore 资源在物理上确实包含一个 GenModel 和一个 Ecore 模型 [...]

# c++ - 在 Visual C++ 6.0 中支持纯 Unicode 语言（最好不使用 Unicode！）

> ID：15966602
> 
> 赞同：2
> 
> 时间：2013-04-12T08:31:55.563
> 
> 标签：c++, visual-c++, visual-c++-6

我们需要决定是否以及如何在大型旧版 Visual C++ 6.0 应用程序中支持格鲁吉亚语。

我们已经通过设置代码页支持主要的东欧语言。格鲁吉亚语虽然没有代码页，但据我所知，它仅通过 Unicode 得到支持。我们的大部分代码都隐含地假设每个字符一个字节，所以实际上我们正在寻找一种解决方法来用 8 位字符表示语言。

就 VC++ 6.0 而言，我的理解是它支持 Unicode，但对话框和资源文件是 8 位文本文件，它们不支持。

那么所有这些都是正确的，如果是这样，是否有任何破解方法可以解决我们的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-02T03:50:20.220

格鲁吉亚语没有代码页。有一些特殊的编码可以将格鲁吉亚字形映射到拉丁语范围，以便与某些 pre-Unicode 字体一起使用，但当然你不能将英语和格鲁吉亚语与单一字体一起使用。

如果你真的不能支持 Unicode，你最好的 hack 选择是发明你自己的 8 位编码。当然，您将没有可以显示它的字体，因此您必须要么在看不到它的情况下使用它，要么添加一些转换以支持 Unicode 字体，或者为您的自定义编码制作自己的自定义字体。

* * *

更新：

如果你真的很幸运，你可能会找到一种合适的字体，它被设计为“扩展 ASCII”，在较高的 128 个字段中带有格鲁吉亚字母字符，例如重音字符在 Latin-1 中。如果格鲁吉亚字符占据较低的 128 个字符，覆盖拉丁/ASCII/英文字符，那么这不是“扩展 ASCII”，并且用处不大。

我不知道这样的字体是否存在。

# sql - 每个表的触发器列表？

> ID：15966604
> 
> 赞同：1
> 
> 时间：2013-04-12T08:32:04.023
> 
> 标签：sql, sql-server, database, tsql, triggers

如何获取与每个表关联的触发器列表？

我试图得到这样的东西：

```
Table 1 – Trigger for Table 1 – Trigger for Table 1 – Trigger for Table 1

Table 2 – Trigger for Table 2 – Trigger for Table 2 – Trigger for Table 2 
```

只要我可以轻松解释数据，就不必采用这种格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:37:14.910

试试这个——

```
SELECT 
      object_name = s.name + '.' + o.name
    , trigger_name = t.name
    , o.type_desc
    , is_insert_trigger = OBJECTPROPERTY(t.[object_id], 'ExecIsInsertTrigger')
    , is_update_trigger = OBJECTPROPERTY(t.[object_id], 'ExecIsUpdateTrigger') 
    , is_delete_trigger = OBJECTPROPERTY(t.[object_id], 'ExecIsDeleteTrigger')
    , t.is_instead_of_trigger
    , t.is_disabled
FROM sys.objects o WITH (NOWAIT) 
JOIN sys.schemas s WITH (NOWAIT) ON o.[schema_id] = s.[schema_id]
JOIN sys.triggers t WITH (NOWAIT) ON o.[object_id] = t.parent_id
WHERE o.[type] = 'U' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:36:49.283

```
SELECT 
 sysobjects.name AS trigger_name 
,USER_NAME(sysobjects.uid) AS trigger_owner 
,s.name AS table_schema 
,OBJECT_NAME(parent_obj) AS table_name 
,OBJECTPROPERTY( id, 'ExecIsUpdateTrigger') AS isupdate 
,OBJECTPROPERTY( id, 'ExecIsDeleteTrigger') AS isdelete 
,OBJECTPROPERTY( id, 'ExecIsInsertTrigger') AS isinsert 
,OBJECTPROPERTY( id, 'ExecIsAfterTrigger') AS isafter 
,OBJECTPROPERTY( id, 'ExecIsInsteadOfTrigger') AS isinsteadof 
,OBJECTPROPERTY(id, 'ExecIsTriggerDisabled') AS [disabled] 
FROM sysobjects 

INNER JOIN sysusers 
ON sysobjects.uid = sysusers.uid 

INNER JOIN sys.tables t 
ON sysobjects.parent_obj = t.object_id 

INNER JOIN sys.schemas s 
ON t.schema_id = s.schema_id 

WHERE sysobjects.type = 'TR' 
```

希望这可以帮助

# java - 比较java中的数组以及索引位置

> ID：15966605
> 
> 赞同：-6
> 
> 时间：2013-04-12T08:32:04.513
> 
> 标签：java, arrays

在一次 Java 面试中，有人问我如何编写代码来比较 Array 元素，以找出有多少元素或索引相等以及有多少元素不相等？有没有一种方法可以在不使用 for 或 while 循环的情况下比较 Java 中的数组值？我想到的第一件事是Arrays类为我们提供了实用方法`equals()`和`deepEquals()`，但最后我无法弥补，请用一个小例子告诉我如何解决这个问题？

```
 int[] i1 = new int[] {1,2,3,4};
 int[] i2 = new int[] {0,5,3,3}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:36:05.127

就像是

```
notEqualCount += Math.abs(i1.length - i2.length);
for(int i=0; i<i1.length && i < i2.length;i++){
  if(i1[i]==i2[i]){
    equalCount++;   
  } 
  else{
    notEqualCount++; 
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:44:41.690

Disclaimer: Did not even bother to compile this and omit any error handling:

```
/*Returns the equal count in int[0] and nonEqualCount in int[1] of the result*/
public static int[] findEqualAndNotEqual(Integer firstArray, Integer secondArray){  
   Set<Integer> set = new HashSet<Integer>(Arrays.asList(firstArray));    
   int equalCount = 0;  
   int nonEqualCount = 0;  
   for(Integer num:secondArray){  
      if(set.contains(num)){
         equalCount++;   
      }
      else{
         nonEqualCount++;
     }  
   }
   return new int[]{equalCount, nonEqualCount};  
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:37:50.010

您可以遍历数组。就像是：

```
int[] array1  =new int[] {1,2,3,4};
int[] array2 = new int[] {0,5,3,3};
int numberOfEqualElements = 0;

for (int i=0; i<array1.length; i++) {
   if (array1[i] == (array2[i])) {
       numberOfEqualElements += 1;
   }
}
system.out.println("The number of elements that are equal is " + numberOfEqualElements); 
```

然后你就会知道不相等的数字就是剩下的。

# c# - 将应用程序与活动目录轻服务集成

> ID：15966611
> 
> 赞同：0
> 
> 时间：2013-04-12T08:32:19.260
> 
> 标签：c#, .net, active-directory

现在我正在尝试构建一个 .net 应用程序（C#），我尝试将我的应用程序与 Windows 活动目录集成以在 AD 中验证用户和密码，因为它仍在开发中。

因此，我决定使用 Active Directory 轻量级目录服务来代替 AD，但问题是我的 PC 没有任何域，它是一台本地计算机。

我真的不知道我要在我的连接字符串中放什么。谁能帮我？并举一些例子，谢谢。任何帮助都会很棒..顺便说一句，我的电脑使用的是 Windows 7，我使用的是 .net 4.5 / MS VS 2012。

这是我的一些代码

C＃ ：

```
string connection =  ConfigurationManager.ConnectionStrings["ADConnection"].ToString();
DirectorySearcher dssearch = new DirectorySearcher(connection);
dssearch.Filter = "(sAMAccountName=" + txtusername.Text + ")";
SearchResult sresult = dssearch.FindOne();
DirectoryEntry dsresult = sresult.GetDirectoryEntry();
lblfname.Text = dsresult.Properties["givenName"][0].ToString();
lbllname.Text = dsresult.Properties["sn"][0].ToString();
lblemail.Text = dsresult.Properties["mail"][0].ToString(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T10:26:21.387

AD LDS（Active Directory 轻型目录服务）不同于成熟的 Active Directory。活动目录包括：

1.  一个数据库，可通过 LDAP 访问
2.  使用数据库存储帐户、组和其他内容的数据库模式
3.  使用上述方法对帐户进行身份验证的身份验证服务。

AD LDS 只是数据库 - 没有帐户、组或身份验证服务。您应该扩展其架构以容纳您想要存储在其中的内容。

因此，您不能使用 AD LDS 进行用户身份验证。我加入了设置测试计算机（可能是虚拟机）、将其配置为域控制器并在其上进行测试的建议。

# javascript - Javascript 正则表达式不起作用

> ID：15966614
> 
> 赞同：0
> 
> 时间：2013-04-12T08:32:32.757
> 
> 标签：javascript, regex

我的网站内容如下。我想获得**activategoldodgbrm**

```
App Namespace</span></div><div class="fsm fcb">activategoldodgbrm</div> 
```

我尝试了下面的代码，但它说匹配不起作用。

```
var pattern = /App Namespace<\/span><\/div><div class="fsm fcb">(.*?)<\/div>/gm;
var match;
while (match = pattern.exec(src)) { 

alert(match[1]);

} 
```

注意：src 包含我的页面源

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:44:37.637

你没有分配任何匹配的东西。

```
var a;
if(a==1){...}
alert(a); // a is null 
```

所以试试这个

```
var pattern = /App Namespace<\/span><\/div><div class="fsm fcb">(.*?)<\/div>/gm;
var match;
while (match = pattern.exec(src)) { // using "=" instead of "=="

alert(match[1]);

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:49:46.113

请从关于 == 和 = 运算符的答案中抽象出来，这是一些误解。首先，我认为您不需要如此复杂的正则表达式。其次，您不需要运行循环。检查这个：

```
var src = 'App Namespace</span></div><div class="fsm fcb">activategoldodgbrm</div>';
alert(/class="fsm fcb">(.+?)</gm.exec(src)[1]); 
```

最后，如果您的 src 实际上是 DOM 节点，最好使用 DOM API 来查找节点并获取它的 innerHTML。

[演示](http://jsfiddle.net/qhmpw/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:59:01.527

我认为您只是误解了`m`修饰符。它确实为您提供了在多行上匹配某些内容的机会，但您必须处理新行（`\r\n`或`\n`）。

考虑这个例子：

```
"</span>\n</div>".match(/.*/m); 
```

这只会给你“”。因为我们忘记考虑这里的新行了。这将抓住所有：

```
"</span>\n</div>".match(/(.|\r?\n)*/m); 
```

所以......因为我们真的不知道里面有什么`src`，我会尝试更通用：

```
var pattern = /App Namespace(?:\r?\n)*<\/span>(?:\r?\n)*<\/div>(?:\r?\n)*<div class="fsm fcb">(?:\r?\n)*(.*?)(?:\r?\n)*<\/div>/gm; 
```

（包括许多新行捕捉）

作为旁注，该点`.`不会捕获换行符。

# php - 连接到 SQL Server 时出现“检索服务器版本失败”错误

> ID：15966622
> 
> 赞同：1
> 
> 时间：2013-04-12T08:33:01.857
> 
> 标签：php, sql-server, sql-server-2008

我只是在开发一些测试代码，只有几行，突然出现这个错误：

> 0][SQL Server]L'impostazione della linguaèstata sostituita con Italiano。) )

所以我删除了迄今为止完成的所有代码，仅用于测试与

```
$connectionInfo = array("Database" => "test", "UID" => "testuser", "PWD" => "somepwd");
$conn = sqlsrv_connect($serverName, $connectionInfo);
if ($conn) {
    echo "yes";
} else {
    die(print_r(sqlsrv_errors(), true));
} 
```

然后我打开 Microsoft 服务器 SQL 管理工作室来检查数据库，一切似乎都很好......有谁知道问题可能出在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-09T15:27:24.727

我遇到了同样的问题，并通过安装 Microsoft SQL Server 2012 Native Client 解决了。

[在http://www.microsoft.com/en-us/download/confirmation.aspx?id=29065](http://www.microsoft.com/en-us/download/confirmation.aspx?id=29065)下载适合您的结构的 Microsoft SQL Server 2012 Native Client

# android - 在 Android 中按比例调整图像视图的大小

> ID：15966623
> 
> 赞同：3
> 
> 时间：2013-04-12T08:33:02.607
> 
> 标签：android, imageview, scale

假设你有这个

```
<ImageView
        android:id="@+id/mainImageView"
        android:layout_width="match_parent"
        android:background="@drawable/mylogo_250px60px"
/> 
```

我想定义高度，以便它根据宽度进行缩放。因此，如果 Android 决定缩放徽标以显示宽度，那么高度也应该增加。

是否也可以定义一些东西，所以当手机从垂直倾斜到水平时，标志会正确缩放吗？

（基本上，徽标位于主要活动的列表视图上方）

我也尝试过使用它，但没有运气（与宽度相比，高度显得低得多。图像未调整大小/高度缩放）

```
<ImageView
        android:id="@+id/mainImageView"
        android:layout_width="match_parent"
        android:background="@drawable/mylogo_250px60px"
        android:layout_height="wrap_content"
        android:scaleType="centerInside"
        android:adjustViewBounds="true"                                       
    /> 
```

如果我在 Eclipse/ADT gui 工具中设计它，徽标会得到 76dp，并且在我的两部测试手机上看起来不错。但是，我认为应该可以简单地适当地缩放图像？

**“固定高度”具有正确的宽度比率**（垂直视图，而不是手机倾斜时） ![在此处输入图像描述](https://i.stack.imgur.com/eHNFu.png)

**与宽度相比，“自动高度”出现错误的比例：** ![在此处输入图像描述](https://i.stack.imgur.com/2f3F1.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-12T08:40:29.447

如下更改您的 imageview 代码

```
 <ImageView
        android:id="@+id/mainImageView"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:src="@drawable/mylogo_250px60px"
        android:scaleType="fitEnd"
        android:adjustViewBounds="true"
    /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:55:52.997

尝试这个：

```
<ImageView
        android:id="@+id/mainImageView"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:src="@drawable/mylogo_250px60px"
        android:scaleType="fitEnd"
        android:adjustViewBounds="true"
        /> 
```

希望它的帮助

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-01-15T17:21:11.650

这工作正常：

```
<ImageView
    android:id="@+id/mainImageView"
    android:layout_width="wrap_content"
    android:background="@drawable/mylogo_250px60px"
    android:layout_height="wrap_content"                                      
/> 
```

唯一的问题：drawable 必须至少与其父对象一样宽。

渲染不会让 ImageView 比其父级更宽：

*   所以它将完全适合宽度
*   它会保持比例（因为 wrap_content）

我通常计算分辨率为 1080x1092（全高清）的手机。

# android - 包装第一个 textView 时，Android（程序化）布局不显示第二个 textView

> ID：15966626
> 
> 赞同：0
> 
> 时间：2013-04-12T08:33:04.277
> 
> 标签：android, android-layout

以编程方式制作的“列表”的结构：

```
ScrollView
->LinearLayout (itemRow)
-->LinearLayout (itemTitle)
--->TextView (title)
--->TextView (price)
--> (other layouts)...
... and start again with itemRow 
```

正确包装标题 TextView 文本时，不显示价格***（免费） 。***

![在此处输入图像描述](https://i.stack.imgur.com/WqyYv.png)

代码：

```
 LayoutParams p=new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.MATCH_PARENT); 

    TextView title=new TextView(ctx);
    title.setText(e.getTitle());
    title.setTextAppearance(ctx, R.style.eList_Title);
    TextView price=new TextView(ctx);
    price.setPadding(2, 1, 1, 1);
    price.setSingleLine(true);
    if (e.getPrice().doubleValue()==0) {
        price.setText('('+getString(R.string.e_free)+')');
        price.setTextColor(colorGreenFree);
    } else {
        price.setText('('+NumberFormat.getCurrencyInstance().format(e.getPrice())+')');
        price.setTextColor(Color.RED);
    }
    LinearLayout llTitle=new LinearLayout(ctx);
    llTitle.setBackgroundResource(R.drawable.gradient_silver_red);
    llTitle.setLayoutParams(llpMatchParentWrapContent);
    llTitle.addView(title);
    llTitle.addView(price); 
```

注意：如果 price.setSingleLine(true); 被删除我得到这个结果：

![在此处输入图像描述](https://i.stack.imgur.com/60dVX.png)

PD：我试过RelativeLayout，也有同样的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:57:06.177

TextView 太宽，将第二个从右侧推开。

实现这一点的更简单方法可能是使用单个 TextView 和一些 HTML 来为“免费”着色。

```
textView.setText(Html.fromHtml(String.format("%s <font color="#00FF00">(%s)</font>", name, gratis))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:52:24.527

感谢亚历克斯的回答，终于这样解决了：

```
 Spannable titleSpan= null;
        String strPrice=null;
        if (e.getPrice().doubleValue()==0) {
            strPrice='('+getString(R.string.e_free)+')';
            titleSpan=new SpannableString(e.getTitle()+strPrice);
            titleSpan.setSpan(new ForegroundColorSpan(Color.GREEN), e.getTitle().length(), e.getTitle().length()+strPrice.length(), Spannable.SPAN_INTERMEDIATE);
        } else {
    strPrice='('+NumberFormat.getCurrencyInstance().format(e.getPrice())+')';
            titleSpan=new SpannableString(e.getTitle()+strPrice);
            titleSpan.setSpan(new ForegroundColorSpan(Color.RED), e.getTitle().length(), e.getTitle().length()+strPrice.length(), Spannable.SPAN_INTERMEDIATE);
        }
        title.setText(titleSpan); 
```

# objective-c-blocks - iOS UIView 动画无法正常工作

> ID：15966627
> 
> 赞同：0
> 
> 时间：2013-04-12T08:33:05.427
> 
> 标签：objective-c-blocks, uiviewanimation

我想创建递归动画。这是我的代码：

```
- (void)startAnimation {
    [UIView animateWithDuration:5.0
                     animations:^{
                         NSLog(@"animation");
                     }
                     completion:^(BOOL finished) {
                         if(!canceled) {
                             NSLog(@"completed");
                             [self startAnimation];
                         }
                     }
     ];
} 
```

```
-(void)viewDidAppear:(BOOL)animated{
     //somewhere in your app, possibly viewDidLoad or viewDidAppear.
     [self startAnimation];
} 
```

ISSUE：**动画**和**完成**同时显示。我的错误在哪里。请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:53:55.967

**尝试这个**

```
[UIView animateWithDuration:5.0
                 delay:3.0
                 animations:^{
                     NSLog(@"animation");
                 }
                 completion:^(BOOL finished) {
                     if(!canceled) {
                         NSLog(@"completed");
                         [self startAnimation];
                     }
                 }
 ]; 
```

# javascript - if 语句仅在数字不低于它时才执行代码

> ID：15966629
> 
> 赞同：0
> 
> 时间：2013-04-12T08:33:08.923
> 
> 标签：javascript

我有一个整数，比如说 9。我想创建一个条件，仅当这个 9 不低于它时才允许用户单击按钮。我该如何处理。

```
if(not lower than 9){
  execute the code here....
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:34:47.287

不幸的是 9 永远是 9。但是如果 9 被分配给一个变量，那么你可以这样做`if (variable >= 9) { .... }`

实际上，考虑到你的情况有多奇怪，它会按照你想要的方式工作

```
if (9) {
   // code
} 
```

一样，`if (true) {`但是那里，9不低于9，等于9，所以它会进入条件。噗。只是不要测试它为0。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T08:36:31.483

假设您在名为 num 的变量中获得了此整数的值，并且按钮 id 为“Btn1”，您可以尝试类似以下的代码：

```
if (num >= 9)
{
    $("#Btn1").removeAttr("disabled");
}
else
{
    $("#Btn1").attr("disabled", "disabled");
} 
```

`.removeAttr("disabled")`将启用按钮，`.attr("disabled", "disabled")`并使按钮禁用。

# android - 将图像设置为全屏 HTML

> ID：15966631
> 
> 赞同：2
> 
> 时间：2013-04-12T08:33:27.363
> 
> 标签：android, css, html

我正在尝试显示填充整个屏幕的图像，我的 HTML 如下所示：

```
<!DOCTYPE html>
<html lang="de">
    <head>
        <meta charset="utf-8" />
        <title></title>
    </head>
    <body>
        <img src="./res/Default.png" width="100%" height="100%"/>   
    </body>
</html> 
```

现在，它看起来几乎无处不在，但它只填满了“HTC Incredible S”屏幕的上半部分。任何人都知道为什么和/或如何修复它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:37:50.433

这将使图像最大化。如果图像大于视口，它将溢出但被隐藏。您永远不会得到图像未覆盖的白色区域。

```
<body>
    <img src="./res/Default.png"/>   
</body>

body {
    overflow: hidden;
}
img {
    min-width: 100%;
    min-height: 100%;
} 
```

[http://jsfiddle.net/bzTNV/2/](http://jsfiddle.net/bzTNV/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T08:38:56.790

你可以这样做

```
top:0;
left:0; 
position:fixed; 
min-width:100%; //keeps it filling the browser window vertically
min-height:100%; //keeps it filling horizontally 
```

[**提琴手**](http://jsfiddle.net/dB7kr/)

[全屏结果](http://jsfiddle.net/dB7kr/embedded/result/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T08:41:02.290

您的问题是因为 body 容器未设置为占用 100% 的窗口。

使用您的代码的示例：http: [//jsfiddle.net/ejTSL/1/](http://jsfiddle.net/ejTSL/1/)

主体样式与`width:100%;height:100%;`img 锚定到浏览器窗口的示例：http: [//jsfiddle.net/9BnGD/2/](http://jsfiddle.net/9BnGD/2/)

尝试：

```
<!DOCTYPE html>
<html lang="de">
    <head>
        <meta charset="utf-8" />
        <title></title>
    </head>
    <body style="width:100%;height:100%">
        <img src="./res/Default.png" width="100%" height="100%" style="position:fixed;top:0;left:0;/>   
    </body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-10T19:04:47.093

我使用这个简单的标记。只需将其粘贴在 html 正文中即可。它可以修改为使用 css 类或在 JQuery 中创建。我没有在所有设备上进行测试，但我没有发现任何这不是响应式和移动友好的。

```
<div id="FullscreenDiv" style="z-index:99999;display:none;position:fixed;background-color:black;top:0px;bottom:0;left:0;right:0">
    <div id="FullscreenDivImg" style="position:fixed;background-color:black;background:url(../Content/Images/Example.png) center center no-repeat;background-size:contain;top:10px;bottom:10px;left:10px;right:10px">
    </div>
</div> 
```

# jquery - 当添加权限为 False 时，Django-grappelli 添加按钮在内联中可见

> ID：15966633
> 
> 赞同：1
> 
> 时间：2013-04-12T08:33:28.827
> 
> 标签：jquery, python, django, django-admin, django-grappelli

我不确定它是我正在做的事情还是它是一个错误，但我在 a `TabularInline`(django admin using grappelli) 中的添加按钮有一些奇怪的行为。我的内联课程是：

```
class FieldInline(admin.TabularInline):
    model = models.Field
    classes = ('grp-collapse grp-closed',)

    fields = ('number', 'year', 'area')
    extra = 0

    def has_add_permission(self, request):
        return False

    def has_delete_permission(self, request, obj):
        return False 
```

添加按钮在内联表单集折叠时出现，但在打开时消失。我曾尝试挖掘所涉及的 jquery，但我对该语言不是很熟悉，所以我不太确定我在寻找什么。

还有其他人得到这种行为吗？有明显的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T13:24:12.080

这是一个错误。我在 github 上打开了一个问题，因为我们将它用作 Grappelli 的问题跟踪器（[https://github.com/sehmaschine/django-grappelli/issues/316](https://github.com/sehmaschine/django-grappelli/issues/316)）。

看了之后：隐藏按钮的可见性是一个 css 问题，用[https://github.com/sehmaschine/django-grappelli/commit/da4d500c5e3b8f8dba5709b0378396131fad361d修复它](https://github.com/sehmaschine/django-grappelli/commit/da4d500c5e3b8f8dba5709b0378396131fad361d)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T13:59:30.913

`The new javascript made this impossible because the "Add Another" button was controlled by max_num, and ignored a value of 0\. The javascript ignored a value of 0 because max_num has a default value of 0, and all the code using it had taken to equating max_num = 0 with being "off". So you can't actually have a maximum of 0\. It's not possible.`

Gabrial Hurley 创建了一个补丁来恢复所需的行为而不会破坏其他任何东西。这是 3 年前的事了，我不知道它是否仍然适用于 Django 1.5。试试看嘛 ：）

[https://code.djangoproject.com/attachment/ticket/13023/13023_inlines_patch.diff](https://code.djangoproject.com/attachment/ticket/13023/13023_inlines_patch.diff)

这是同一错误的票（3年前）：

[https://code.djangoproject.com/ticket/13023](https://code.djangoproject.com/ticket/13023)

来自凯文的经验：

`I ran into the same issue because I had the static admin content in a directory that was outside of django's install. Copying the Django 1.5 static content from django/contrib/admin/static/admin/js/ to STATIC_ROOT/admin/js fixed the issue.`

# windows - Sikuli IDE 终止且没有错误消息

> ID：15966637
> 
> 赞同：1
> 
> 时间：2013-04-12T08:33:48.490
> 
> 标签：windows, sikuli, sikuli-ide

我正在尝试在 32 位 Windows 7 机器上从 IDE 录制 Sikuli 脚本。我从批处理文件开始（正如处理其他问题的几个支持线程所建议的那样），当我尝试“截屏”或记录鼠标操作时，Sikuli IDE 消失了，没有更多的事情发生。

检查正在运行的任务表明 Sikuli IDE 进程仍在运行。

（版本：Sikuli X r930）

有人经历过吗？

（编辑：添加的问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T09:23:34.907

通过删除现有的 Java 安装并安装 Java 1.6.0_33 解决了这个问题。

# objective-c - XCode“无法启动游戏名称，没有这样的文件或目录......”

> ID：15966641
> 
> 赞同：4
> 
> 时间：2013-04-12T08:34:04.913
> 
> 标签：objective-c, xcode

我越来越害怕了

```
Could not launch game name, no such file or directory (/Users/myname/Library/Developer/Xcode/DerivedData/Game_Name-erqxxxxxxxxxgesgegesgesg/Build/Products/Debug-iphoneos/Game Name.app/Game Name) 
```

当我尝试在 iPhone 上运行游戏时。它在模拟器中构建/运行良好，奇怪的是，即使尝试在手机上运行，​​它也会给我一个构建成功的消息，但随后会弹出错误消息。

显然我已经用谷歌搜索了这个问题，我在这里尝试了这个建议[http://dhilipsiva.blogspot.co.uk/2012/07/xcode-could-not-launch-app-no-such-file.html](http://dhilipsiva.blogspot.co.uk/2012/07/xcode-could-not-launch-app-no-such-file.html)但是我仍然遇到同样的问题。

我检查了一下，我的手机使用的是最新版本的 iOS（6.1.x），XCode 也针对最新版本的 iOS。

找不到其他原因造成的。我确实采用了一个原始的 xcode 项目并将它的名称更改为我现在的名称，也许它与此有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:44:45.293

Ok I seemed to have found the issue, it was this (found on here [Xcode suddenly stopped running project on hardware: "Could not launch xxx.app: .. No such file.."](https://stackoverflow.com/questions/11456312/xcode-suddenly-stopped-running-project-on-hardware-could-not-launch-xxx-app?rq=1))

"I found out what it was - while adding device capabilities to the info.plist I had somehow added a new row but not given it a value. – Amino acids"

I had a "required device capabilities" with one item which was "gameKit" but for some reason that was causing it not to work. I've tested similar projects that required gamekit on the phone before and it worked fine. Unless I typed in gameKit incorrectly or something. Anyway that seems to be working.

# c - How do you tell LSHIFT apart from RSHIFT in WM_KEYDOWN events?

> ID：15966642
> 
> 赞同：8
> 
> 时间：2013-04-12T08:34:06.280
> 
> 标签：c, winapi

According to [MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646280%28v=vs.85%29.aspx) wparam should hold the key code. The problem is, when pressing shift, the code is 16(VK_SHIFT), but I need to distinguish between VK_LSHIFT and VK_RSHIFT.

For VK_CONTROL, there seems to be a workaround:

```
if(wParam == VK_CONTROL) {
    if ( lParam&EXTENDED_KEYMASK )
        wParam = VK_RCONTROL;
    else
        wParam = VK_LCONTROL;
} 
```

However, the same won't work for VK_SHIFT:

```
if(wparam == VK_SHIFT) {
    if ( lParam&EXTENDED_KEYMASK )
        wParam = VK_RSHIFT;
    else
        wParam = VK_LSHIFT;
} 
```

In the latter example, it will just always assume LSHIFT.

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-12T17:40:56.280

To distinguish between the left and right versions of the Shift, Ctrl, or Alt keys, you have to use the `MapVirtualKey()` function or the 'extended key' bit in the lParam passed with the virtual key's message. The following function will perform that translation for you - just pass in the virtual keycode and the lParam from the message, and you'll get back the left/right specific virtual keycodes as appropriate:

```
WPARAM MapLeftRightKeys( WPARAM vk, LPARAM lParam)
{
    WPARAM new_vk = vk;
    UINT scancode = (lParam & 0x00ff0000) >> 16;
    int extended  = (lParam & 0x01000000) != 0;

    switch (vk) {
    case VK_SHIFT:
        new_vk = MapVirtualKey(scancode, MAPVK_VSC_TO_VK_EX);
        break;
    case VK_CONTROL:
        new_vk = extended ? VK_RCONTROL : VK_LCONTROL;
        break;
    case VK_MENU:
        new_vk = extended ? VK_RMENU : VK_LMENU;
        break;
    default:
        // not a key we map from generic to left/right specialized
        //  just return it.
        new_vk = vk;
        break;    
    }

    return new_vk;
} 
```

If the virtual keycode passed in isn't one that maps to a left/right version, the original keycode is passed back unchanged. So you can just run the `WM_KEYDOWN`/`WM_KEYUP`/`WM_SYSKEYDOWN`/`WM_SYSKEYUP` message parameters through the function whenever you need to distinguish between the left and right variants.

By using `MapVirtualKey()` you don't need to know the lore about the left-shift and right-shift scancodes being 0x2a and 0x36 - the API takes care of that detail. And if they ever do happen to be different (not that that will ever really happen), Windows will be responsible for dealing with it, not you.

So in your `WM_KEYDOWN`/`WM_KEYUP`/`WM_SYSKEYDOWN`/`WM_SYSKEYUP` handlers you just have to add a line of code that looks like:

```
wparam = MapLeftRightKeys(wparam, lparam); 
```

and the rest of your code can act on the left/right-specific VK codes as if the system message just gave them to you in the first place.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-12T09:38:41.087

There's ancient history behind your question. The original IBM PC keyboard didn't have the right Alt and Ctrl keys. They got added later on the extended keyboard layout, the keyboard controller sends them with the 0xe0 prefix to the scan code to distinguish them as extended keys. But the original keyboard layout always had two shift keys so they have their own non-extended scan codes. Which is why your code doesn't work.

David's answer is a good way to solve your problem. But you actually can get it out of the message, those scan codes are cast in stone by the [Windows logo requirements](http://download.microsoft.com/download/1/6/1/161ba512-40e2-4cc9-843a-923143f3456c/scancode.doc). Available in lParam, the left shift key has scan code 42, the right shift key is 54\. No #define in the windows headers for them unfortunately, that makes it ugly.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-12T08:37:15.830

Call [`GetKeyState`](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms646301.aspx) passing `VK_LSHIFT` or `VK_RSHIFT`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-12T09:19:17.397

"According to MSDN":

> *   VK_LSHIFT
> *   VK_RSHIFT
> *   VK_LCONTROL
> *   VK_RCONTROL
> *   VK_LMENU
> *   VK_RMENU
>     
> 
> These left- and right-distinguishing constants are available to an application only through the GetKeyboardState, SetKeyboardState, GetAsyncKeyState, GetKeyState, and MapVirtualKey functions.

# javascript - 在 jquery 文件上传插件的 fileuploadsend 事件中检索 jqXHR？

> ID：15966643
> 
> 赞同：3
> 
> 时间：2013-04-12T08:34:11.070
> 
> 标签：javascript, jquery, jquery-file-upload

我正在使用拖放来触发我的上传，因此我无法简单地捕获 findupload('send') 的返回以获取 jqXHR。

因此，在“fileuploadsend”事件中，我试图从数据对象中获取 jqXHR 元素，但是 data.jqXHR 似乎未定义？

```
 $('#fileupload')
        .fileupload({
           ...
        }).bind('fileuploadsend', function (e, data) {
            console.log(data)
            console.log(data.jqXHR)
        }); 
```

数据对象显示的输出存在一个 jqXHR 元素，并且是这样的对象：

```
jqXHR: Object
abort: function ( statusText ) {
always: function () {
complete: function () {
done: function () {
error: function () {
fail: function () {
getAllResponseHeaders: function () {
getResponseHeader: function ( key ) {
overrideMimeType: function ( type ) {
pipe: function ( /* fnDone, fnFail, fnProgress */ ) {
progress: function () {
promise: function ( obj ) {
readyState: 4
responseText: "[{"url": "/media/pictures/392_frm_20130412081933_d3fee37c7a654dfca066ca3fa389b491.jpg", "filename": "waves_1600.jpeg", "sortDate": null, "albumId": 67, "published": false, "source_id": "pfi392", "thumbnailUrl": "/media/cache/a1/c1/a1c1d4f74614cf041b29e315a1f9a08a.jpg", "id": 499}]"
setRequestHeader: function ( name, value ) {
state: function () {
status: 200
statusCode: function ( map ) {
statusText: "OK"
success: function () {
then: function ( /* fnDone, fnFail, fnProgress */ ) {
__proto__: Object 
```

然而，无论出于何种原因，console.log(data.jqXHR) 只是给出了未定义的。

如果我运行，`for (k in data) { console.log(k) }`那么 jqXHR 在列表中将无处可见：

```
disabled
create
dropZone
pasteZone
replaceFileInput
singleFileUploads
sequentialUploads
forceIframeTransport
multipart
recalculateProgress
progressInterval
bitrateInterval
formData
add
processData
contentType
cache
url
dataType
fileInput
files
originalFiles
paramName
submit
form
type
formAcceptCharset
uploadedBytes
headers
data
blob
xhr
_bitrateTimer 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-09T06:02:54.033

我使用了 jquery-fileupload 的基本 plus UI 版本。

首先，将 jquery.fileupload.ui.js 的一部分粘贴到我的 javascript 文件上传源中。并修改了一些部分。

```
// Initialize the jQuery File Upload widget:
$('#fileupload').fileupload({
    url: '/common/fileupload',

    // pasted this part, If the file transfer successful
    // 파일 전송에 성공하면
    done: function (e, data) {
        if (e.isDefaultPrevented()) {
            return false;
        }
        var that = $(this).data('blueimp-fileupload') ||
                $(this).data('fileupload'),
            getFilesFromResponse = data.getFilesFromResponse ||
                that.options.getFilesFromResponse,
            files = getFilesFromResponse(data),
            template,
            deferred;
        if (data.context) {
            data.context.each(function (index) {
                var file = files[index] ||
                        {error: 'Empty file upload result'};
                deferred = that._addFinishedDeferreds();
                that._transition($(this)).done(
                    function () {
                        var node = $(this);
                        template = that._renderDownload([file])
                            .replaceAll(node);
                        that._forceReflow(template);
                        that._transition(template).done(
                            function () {
                                data.context = $(this);
                                that._trigger('completed', e, data);
                                that._trigger('finished', e, data);
                                deferred.resolve();

                                // It succeeded in using jqXHR, I was need of file auto increment id,
                                console.log("fileuploadsuccess", data.jqXHR.responseJSON.files_info[0]);
                                // and I called custom callback function.
                                fn_file_callback("fileuploadsuccess", e, data.jqXHR.responseJSON.files_info[0]);
                            }
                        );
                    }
                );
            });
        } else {
            template = that._renderDownload(files)[
                that.options.prependFiles ? 'prependTo' : 'appendTo'
            ](that.options.filesContainer);
            that._forceReflow(template);
            deferred = that._addFinishedDeferreds();
            that._transition(template).done(
                function () {
                    data.context = $(this);
                    that._trigger('completed', e, data);
                    that._trigger('finished', e, data);
                    deferred.resolve();
                }
            );
        }
    },

    // then pasted this part.. If the file remove done.
    // 파일을 삭제하면
    destroy: function (e, data) {
        if (e.isDefaultPrevented()) {
            return false;
        }
        var that = $(this).data('blueimp-fileupload') ||
                $(this).data('fileupload'),
            removeNode = function () {
                that._transition(data.context).done(
                    function () {
                        $(this).remove();
                        that._trigger('destroyed', e, data);

                        // add here, I called custom callback function about file deletion.
                        fn_file_callback("filedeletesuccess", e, data.url.replace("/common/deleteFile/", ""));
                    }
                );
            };
        if (data.url) {
            data.dataType = data.dataType || that.options.dataType;
            $.ajax(data).done(removeNode).fail(function () {
                that._trigger('destroyfailed', e, data);
            });
        } else {
            removeNode();
        }
    }
}); 
```

> 从这里剩下的。

```
// Enable iframe cross-domain access via redirect option:
$('#fileupload').fileupload(
    'option',
    'redirect',
    window.location.href.replace(
        /\/[^\/]*$/,
        '/cors/result.html?%s'
    )
);

if (window.location.hostname === 'localhost:8080') {
    // Demo settings:
    $('#fileupload').fileupload('option', {
        url: '/common/fileupload',
        disableImageResize: /Android(?!.*Chrome)|Opera/
            .test(window.navigator.userAgent),
        maxFileSize: 999000,
        acceptFileTypes: /(\.|\/)(gif|jpe?g|png)$/i
    });
    // Upload server status check for browsers with CORS support:
    if ($.support.cors) {
        $.ajax({
            url: '/common/fileupload',
            type: 'HEAD'
        }).fail(function () {
            $('<div class="alert alert-danger"/>')
                .text('Upload server currently unavailable - ' +
                        new Date())
                .appendTo('#fileupload');
        });
    }
} else {
    // Load existing files:
    $('#fileupload').addClass('fileupload-processing');
    $.ajax({
        // Uncomment the following to send cross-domain cookies:
        //xhrFields: {withCredentials: true},
        url: $('#fileupload').fileupload('option', 'url'),
        dataType: 'json',
        context: $('#fileupload')[0]
    }).always(function () {
        $(this).removeClass('fileupload-processing');
    }).done(function (result) {
        $(this).fileupload('option', 'done')
            .call(this, $.Event('done'), {result: result});
    });
} 
```

祝你好运！

# css - 动态居中一个或两个 DIV

> ID：15966654
> 
> 赞同：0
> 
> 时间：2013-04-12T08:34:44.923
> 
> 标签：css, html, layout, css-float

我正在尝试获取一个具有 3 个 DIVS Left|Center|Right 的页面，它可以在包装 div 的中心显示 Center、Left|Center、Center|Right。

我正在使用 jQuery 切换来切换左、右或两个 DIVS 关闭（显示：无）。我尝试了几种方法都没有成功。如果我制作 DIVS 内联块并使用 align-text: center，那么 DIVS 中的文本会得到不需要的格式。如果我将所有 DIVS 向左浮动，然后使包装 div 宽度：80%；margin: 0 auto;，这只是将它们半居中并添加无用的边距，当重新调整浏览器大小时，如果宽度为 100%，那么其中一个 DIVS 会更快地转到下一行。

前任。[JSFIDDLE](http://jsfiddle.net/cjf4Q/)

HTML

```
<div id="wrapper">
    <div id="left">ONE</div>
    <div id="center">TWO</div>
    <div id="right">THREE</div>
</div> 
```

CSS

```
#wrapper{
    width: 80%;
    margin: 0 auto;
    overflow: auto;
}
#left{
    display: none;
    width: 100px;
    height: 100px;
    background-color: #880000;
    float: left;
}
#center{
    width: 100px;
    height: 100px;
    background-color: #000088;
    float: left;
}
#right{
    width: 100px;
    height: 100px;
    background-color: #008800;
    float: left;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T02:26:05.683

我最终使用的方法是一个带有margin-left的包装器div：auto; 和margin-right：auto;，然后让包装器内的所有div向左浮动。然后，每当发生切换更改时，包装器 div 的宽度通过 JavaScript 设置为其中可见 div 的总和。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-14T06:05:34.730

您所需要的只是设置正确的`display: table/-cell`值。`width`并删除`#wrapper`

```
<div id="wrapper">
    <div id="left">ONE</div>
    <div id="center">TWO</div>
    <div id="right">THREE</div>
</div>

<style>
    #wrapper {display: table; margin: auto; width: auto;}
    #wrapper div {display: table-cell;}
    /* #wrapper #left {display: none} */ /* uncomment to hide just two cells */ 
</style> 
```

[http://jsfiddle.net/cjf4Q/35/](http://jsfiddle.net/cjf4Q/35/) // 3 个单元
[http://jsfiddle.net/cjf4Q/34/](http://jsfiddle.net/cjf4Q/34/) // 2 个单元

此解决方案无需将固定宽度设置为 即可工作`#wrapper`，您可以动态更改尺寸并且它仍然可以正确适配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:59:47.067

像这样的东西？

## html

```
<div id="wrapper">
    <div class="centering">
        <div id="left">ONE</div>
        <div id="center">TWO</div>
        <div id="right">THREE</div>
    </div>
</div> 
```

## CSS

```
#wrapper{
    width: 100%;
    min-width: 320px;
}
.centering{
    margin: 0 auto;
    width: 300px;
}
#left{
    width: 100px;
    height: 100px;
    background-color: #880000;
    float: left;
}
#center{
    width: 100px;
    height: 100px;
    background-color: #000088;
    float: left;
}
#right{
    width: 100px;
    height: 100px;
    background-color: #008800;
    float: left;
} 
```

`#wrapper`您可以添加一个媒体查询来处理当它包含的 div 太小时会发生什么。`min-width`那或者只是像我一样给包装器一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-27T23:10:08.087

如果我没记错的话，我认为这就是您要寻找的东西：

```
#wrapper{
    width: 80%;
    margin: 0 auto;
    position:relative;
    height:100px;
    min-width:300px;
}

#wrapper div{
    top:0;
}

#left{
    display: block;
    width: 100px;
    height: 100px;
    background-color: #880000;
    left: 0px;
   position:absolute;
}
#center{
    width: 100px;
    height: 100px;
    background-color: #000088;
    margin:auto;
    position:relative;
}
#right{
    width: 100px;
    height: 100px;
    background-color: #008800;
    right: 0px;
    position:absolute;
} 
```

# css - css 对于 ipad/mobile 不正确

> ID：15966660
> 
> 赞同：-1
> 
> 时间：2013-04-12T08:34:59.433
> 
> 标签：css, ipad

最近我为当地的一所音乐学校创建了一个网站。一次很好的经历告诉我，我必须在每件事上有所改进并进行大量练习。
[这是链接](http://studioandco.altervista.org/petersday)

起初我想让它响应，但我很快意识到我没有足够的时间和知识。无论如何，我第一次使用 Html 5 和相关措施：桌面导航似乎还可以。

如果我进行 iPad 和移动测试，出现问题：页面右侧的空白区域；页眉、内容和页脚不适合整个空间，尽管我已经为它们设置了宽度：100%。Kindle Fire 和 Opera Mobile 的横向测试中也出现了同样的情况。

我怎么能解决这个问题？我不想让它完全响应，只是为了让容器适合所有设备布局。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T09:59:56.403

要在 ipad 和移动设备上实现 100%，您需要做两件事： • 使用 META 激活视口（我认为仅 100% 并不是必需的，但请尝试）例如：

```
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=0,minimum-scale=1.0,maximum-scale=1.0"> 
```

• 当你有100% 的显示问题后，你就满足了。例如，您的内容具有 100% 的宽度，可以，但您的导航、滑块和旁边是 XXEM 的宽度。

要在 ipad/mobile 等设备上显示 100% 宽度，您需要为此添加新的 CSS。例子 ：

```
/* iPads (landscape) ----------- */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) 
and (orientation : landscape) {
/* Styles */
nav[role="navigation"] {width: 100%;}
}

/* iPads (portrait) ----------- */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) 
and (orientation : portrait) {
/* Styles */
nav[role="navigation"] {width: 100%;}
}

/* iPhone 4 ----------- */
@media
only screen and (-webkit-min-device-pixel-ratio : 1.5),
only screen and (min-device-pixel-ratio : 1.5) {
/* Styles */
nav[role="navigation"] {width: 100%;}
} 
```

# javascript - 在 Heroku 上创建新的 node.js Facebook 应用程序会导致应用程序错误

> ID：15966661
> 
> 赞同：3
> 
> 时间：2013-04-12T08:35:05.933
> 
> 标签：javascript, facebook, node.js, heroku

我刚刚创建了一个全新的 Node.js Facebook 应用程序，托管在 Heroku 上。但是，当我浏览到我的应用程序时，它向我显示以下错误：

![heroku 上的错误信息](https://i.stack.imgur.com/cQ04s.png)

当我将应用程序的副本克隆到我的计算机并检查日志时，我看到以下错误：

[http://pastebin.com/qMYEyWWq](http://pastebin.com/qMYEyWWq)

同样，我还没有接触任何代码。我是 Node.js 的新手，有人对如何解决这个问题有建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:53:59.600

错误代码：

```
SyntaxError: Unexpected token S
2013-04-12T08:24:48.218425+00:00 app[web.1]:     at Object.parse (native) 
```

建议您在解析来自 Facebook 的响应时遇到问题。然后 heroku 关闭与脚本的连接。尝试查看 IncomingMessage 有效负载以获取提示。

```
code=H13 desc="Connection closed without response" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-04T08:15:32.967

我有一个类似的问题。尝试退出 facebook，您可能会看到该应用程序运行良好，但是当您登录时 - 应用程序错误

这也是你的情况吗？

# java - 为什么maven会抛出InvocationTargetException？

> ID：15966662
> 
> 赞同：0
> 
> 时间：2013-04-12T08:35:05.917
> 
> 标签：java, maven, invocationtargetexception

我正在从命令行运行 maven

```
mvn exec:java -Dexec.mainClass=org.xmlcml.svg2xml.analyzer.DocumentListAnalyzer 
   -Dexec.args=. 
```

当我的程序抛出一个 RuntimeException 时，maven 不会抛出这个而是抛出一个`InvocationTargetException`

```
java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.
java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:297)
        at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.RuntimeException: Only one primary allowed for 3 line textL
ineGroup
        at org.xmlcml.svg2xml.text.TextLineGroup.createSuscriptTextLineList(Text
LineGroup.java:181)
        at org.xmlcml.svg2xml.text.TextLineGroup.createHtml(TextLineGroup.java:2
40) 
```

运行 Eclipse 时不会发生这种情况。

为什么会这样？（这让我感到困惑，也让我的用户感到困惑）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:52:01.270

[调用方法](http://docs.oracle.com/javase/tutorial/reflect/member/methodInvocation.html)告诉我们如下： -

> **反射**提供了一种调用类方法的方法。通常，仅当无法在非反射代码中将类的实例强制转换为所需类型时，才需要这样做。
> 
> **使用 调用**方法**`java.lang.reflect.Method.invoke()`。**第一个参数**是`the object instance`调用这个特定方法的位置。（如果方法是静态的，第一个参数应该为 null。）**后续参数**是`method's parameters`.**
> 
>  ****如果底层方法抛出异常**，***它将被***一个`java.lang.reflect.InvocationTargetException`. 可以使用异常链接机制的`InvocationTargetException.getCause()`方法来检索方法的原始异常。**

 **由于堆栈跟踪还告诉我们，`exec:java`也使用了`Reflection`。然后原始异常也被包装。请参考[org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:297)](http://mojo.codehaus.org/exec-maven-plugin/xref/org/codehaus/mojo/exec/ExecJavaMojo.html#297)的源代码以获取更多参考。

我希望这可能会有所帮助。**

# arrays - 如何在 F# 中创建一维、非从零开始的数组

> ID：15966664
> 
> 赞同：1
> 
> 时间：2013-04-12T08:35:06.933
> 
> 标签：arrays, f#

我试图在 F# 中创建一个单维、非从零开始的数组。我需要这样的数组来与用另一种编程语言编写的代码进行互操作。Array2D.createBased 函数旨在创建二维、非从零开始的数组，但 F# 语言缺少 Array.createBased 函数来创建一维、非从零开始的数组。所以，我尝试编写自己的函数，但它不起作用。它的代码在这里：

```
let createBased base1 length1 (initial : 'a) =           
       // the problem is here: System.Array ('a [*]) is not convertible to array ('a []), 
       // so InvalidCastException error is raised at run-time
       let A = Array.CreateInstance (typeof<'a>, [| length1 |], [| base1 |]) :?> 'a [] 

       for i in A.GetLowerBound(0) .. A.GetUpperBound(0) do A.[i] <- initial 
       A 
```

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T10:58:35.677

.NET 通常不支持这些数组（[http://msdn.microsoft.com/en-us/library/x836773a.aspx](http://msdn.microsoft.com/en-us/library/x836773a.aspx) - 感谢链接 eis）。

但是，可以提供一个允许您使用 F# 语法的 hackish 解决方案。

这是一个非常简单的例子

```
open System
type Hack() =
    let A = Array.CreateInstance (typeof<int>, [| 5 |], [| 5 |])
    member x.Item with get(y:int) = A.GetValue(y) and set (v:int) (y:int) = A.SetValue(y,v)

let a = new Hack()
printfn "%A" (a.[8])
a.[8]<-1
printfn "%A" (a.[8]) 
```

# magento - 无法通过 Magento Cms 所见即所得编辑器添加图像

> ID：15966668
> 
> 赞同：4
> 
> 时间：2013-04-12T08:35:21.140
> 
> 标签：magento, wysiwyg

当我尝试通过所见即所得编辑器添加图像并尝试保存页面时，响应时间过长我收到以下错误

```
a:5:{i:0;s:25:"Unsupported image format.";i:1;s:1001:"#0 /var/www/html/project1/lib/Varien/Image/Adapter/Gd2.php(51): Varien_Image_Adapter_Gd2->_getCallback('create')
#1 /var/www/html/project1/app/code/core/Mage/Adminhtml/controllers/Cms/WysiwygController.php(52): Varien_Image_Adapter_Gd2->open('http://121.0.0....')
#2 /var/www/html/project1/app/code/core/Mage/Core/Controller/Varien/Action.php(419): Mage_Adminhtml_Cms_WysiwygController->directiveAction()
#3 /var/www/html/project1/app/code/core/Mage/Core/Controller/Varien/Router/Standard.php(250): Mage_Core_Controller_Varien_Action->dispatch('directive')
#4 /var/www/html/project1/app/code/core/Mage/Core/Controller/Varien/Front.php(176): Mage_Core_Controller_Varien_Router_Standard->match(Object(Mage_Core_Controller_Request_Http))
#5 /var/www/html/project1/app/code/core/Mage/Core/Model/App.php(354): Mage_Core_Controller_Varien_Front->dispatch()
#6 /var/www/html/project1/app/Mage.php(683): Mage_Core_Model_App->run(Array)
#7 /var/www/html/project1/index.php(87): Mage::run('', 'store')
#8 {main}";s:3:"url";s:150:"/index.php/admin/cms_wysiwyg/directive/___directive/e3ttZWRpYSB1cmw9Ind5c2l3eWcvcmd0LXNsaWRlci1pbWcwMS5qcGcifX0,/key/ceed8184f5f336aafcc307f8623aff45/";s:11:"script_name";s:10:"/index.php";s:4:"skin";s:5:"admin";} 
```

即使页面被保存，我也无法在 CMS 编辑器中查看图像

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-09-11T09:44:53.873

问题是 Magento 正在生成一个动态链接，其中包含管理路径。请参阅错误中的第 8 行：`/index.php/admin/cms_wysiwyg/directive/___directive/e3ttZWRpYSB1cmw9Ind5c2l3eWcvcmd0LXNsaWRlci1pbWcwMS5qcGcifX0,/key/ceed8184f5f336aafcc307f8623aff45/`- 这是您的图像的链接，由 WYSIWYG 生成。

由于这个链接最后没有已知的图像扩展名，我假设，你得到的错误是产生的。

**解决方案是只更改 admin 中的一项设置：**

`System -> Configuration -> General -> Content Management -> Use Static URLs for Media Content in WYSIWYG for Catalog`至`Yes`

*我发现此设置已在`/app/code/core/Mage/Cms/Helper/WYSIWYG/Images.php`第 180 行（在 Magento 1.7.0.2 中）签入，并且取决于生成的静态或动态链接。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-27T02:50:21.220

这是一个 Magento 错误，没有考虑特定的商店视图。

的重写方法`getImageHtmlDeclaration()`，`Mage_Cms_Helper_Wysiwyg_Images`修改源代码：

```
$mediaPath = str_replace(Mage::getBaseUrl('media'), '', $fileurl); 
```

*至*

```
$mediaPath = str_replace(Mage::app()->getStore($this->_storeId)->getBaseUrl('media'), '', $fileurl); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-06T09:57:54.193

您是否检查了此服务器上是否启用了 allow_url_fopen ？今天我遇到了同样的问题，改变这个解决了这个问题。

有几种方法可以改变这种情况：

*   php.ini
*   阿帕奇配置
*   虚拟主机配置
*   .htaccess 文件

您必须选择适合您的网络服务器设置的最佳方式。

我通过更改我的 Apache VirtualHost 配置文件来修复它：

```
php_admin_value allow_url_fopen on 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-19T01:35:40.310

编辑包含皮肤文件夹中图像的 cms 页面时会发生异常。因为当我们使用自定义管理主题时，占位符图像在 adminhtml TinyMCE 中不可用。

修复：将占位符图像从 adminhtml/default/default/ 复制到自定义主题，它将停止这样的异常。

```
/skin/adminhtml/default/THEME/images/wysiwyg/skin_image.png 
```

[![TinyMCE 的皮肤图像占位符](https://i.stack.imgur.com/TWeHr.png)](https://i.stack.imgur.com/TWeHr.png)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-10-14T10:07:40.497

我有类似的问题。解决方案是创建文件夹 /media/wysiwyg

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-01-17T13:02:51.613

刷新您的 magento 缓存并刷新所有内容

# iphone - OCUnit - 测试用例失败时中断？

> ID：15966670
> 
> 赞同：1
> 
> 时间：2013-04-12T08:35:23.283
> 
> 标签：iphone, ios, xcode, ipad, ocunit

在调试测试用例失败时，如果执行会在测试用例失败时自动中断，那将非常有用，这样我就可以直接调查失败。所以本质上是一个断点，当断言失败时触发。

有谁知道是否有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T10:49:46.880

有许多解决方案如何实现这一目标，仅举几例：

1.  添加一个符号断点到`[SenTestCase failWithException:]`
2.  覆盖`failWithException:`在一个`SenTestCase`
3.  使用你自己的测试宏，你可以在失败后中断

# c# - PDFsharp页面大小和设置边距问题c#

> ID：15966672
> 
> 赞同：7
> 
> 时间：2013-04-12T08:35:28.873
> 
> 标签：c#, pdfsharp

我正在使用 PDFsharp lib 将图像转换为 pdf。我需要设置页边距和页面大小，所以我从这个论坛得到了一个技巧来设置页面大小和页边距。从这里我得到了我使用的代码，但在两个区域出现错误。这是我得到的代码。

```
page = document.AddPage();
//page.Size = PdfSharp.PageSize.A4;
XSize size = PageSizeConverter.ToSize(PdfSharp.PageSize.A4);
if(page.Orientation == PageOrientation.Landscape)
{
   page.Width  = size.Height;
   page.Height = size.Width;
}
else
{
   page.Width  = size.Width;
   page.Height = size.Height;
}

// default unit in points 1 inch = 72 points
page.TrimMargins.Top = 5;
page.TrimMargins.Right = 5;
page.TrimMargins.Bottom = 5;
page.TrimMargins.Left = 5; 
```

我收到这条线的错误

```
XSize size = PageSizeConverter.ToSize(PdfSharp.PageSize.A4); 
```

所以我需要将其更改为

```
System.Drawing.Size size = PageSizeConverter.ToSize(PdfSharp.PageSize.A4); 
```

现在我的程序编译了，但是当我设置边距时，我收到一个名为 **PdfSharp 的错误，它不包含 TrimMargins 的定义**

这些下面的行不能编译为设置边距。

```
 pdfPage.TrimMargins.Top = 5;
    pdfPage.TrimMargins.Right = 5;
    pdfPage.TrimMargins.Bottom = 5;
    pdfPage.TrimMargins.Left = 5; 
```

我正在使用 pdf sharp 库版本**1.0.898.0**

所以指导我如何设置边距。

## 这是我从图像文件生成pdf的完整代码

```
public static string GeneratePdfFromImage(string source)
        {
            string destinaton = source.Replace("gif", "pdf");
            PdfDocument doc = new PdfDocument();
            PdfPage pdfPage = new PdfPage();
            System.Drawing.Size size = PageSizeConverter.ToSize(PdfSharp.PageSize.A4);
            pdfPage.Orientation = PageOrientation.Portrait;

            pdfPage.Width = size.Width;
            pdfPage.Height = size.Height;
            pdfPage.TrimMargins.Top = 5;
            pdfPage.TrimMargins.Right = 5;
            pdfPage.TrimMargins.Bottom = 5;
            pdfPage.TrimMargins.Left = 5;

            doc.Pages.Add(pdfPage);

            XGraphics xgr = XGraphics.FromPdfPage(doc.Pages[0]);
            XImage img = XImage.FromFile(source);

            try
            {
                xgr.DrawImage(img, 0, 0);
                doc.Save(destinaton);
                doc.Close();
            }
            catch (Exception ex)
            {
                destinaton = "";
            }

            return destinaton;
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T12:47:17.383

您不能使用 PDFsharp 设置边距 - 绘制项目时由您在页面上保留边距。

您复制的代码来自 MigraDoc。MigraDoc 包含在 PDFsharp 中，但在更高级别上工作，您不处理页面，而是处理部分，在这里您可以设置边距。

有关详细信息，请参阅 PDFsharp 和 MigraDoc 的网站：
[http](http://pdfsharp.net/)
: //pdfsharp.net/ 还有一个 PDFsharp 示例显示如何设置页面大小。

使用 PDFsharp 时，您可以在页面上的任何位置绘制图像，还可以指定图像的大小。

# sed - 从大文件中选择数据

> ID：15966673
> 
> 赞同：1
> 
> 时间：2013-04-12T08:35:33.827
> 
> 标签：sed, awk, grep, cut

以下 grep 语句按预期工作。但是如果文件太大（40GB）会花费很多时间

```
grep '^INSERT' test.txt > new.txt 
```

1）有没有其他方法可以快速从该文件中获取所有“INSERT”语句的列表？

2) 是否有任何命令可以快速从该文件中删除前 100 行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T10:22:35.980

```
 sed -n '1,100\!{/^INSERT/p}' test.txt > new.txt & 
```

**您可以使用“ &** ”将进程发送到后台并继续您的工作。使用**ps**命令检查后台进程的状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:45:16.070

You could string comparison instead of a regexp match but with a 40GB there won't be any magic command you still have to check every line:

```
$ awk '$1=="INSERT"' test.txt > new.txt 
```

As for the second question use `sed`:

```
$ sed -i '1,100{d;q}' test.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T08:49:50.843

通过以下方式，第一次操作应该更快：

```
LANG=en_US grep '^INSERT' test.txt > new.txt 
```

（假设您当前正在使用`UTF-8`支持的语言环境）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-12T08:43:50.763

您是在主轴磁盘上执行此操作吗？如果是这样，请尝试使用 SSD。或者，如果您负担得起，请购买一台具有足够 RAM 的机器，以将整个文件放入其中。

# file - 如何关闭文件以供其他处理器使用？

> ID：15966675
> 
> 赞同：0
> 
> 时间：2013-04-12T08:35:47.983
> 
> 标签：file, parallel-processing, multiprocessor

我正在尝试使用命令 os.remove('text.pckl') 删除文件 text.pckl。我已经由其他处理器创建了文件，但出现错误：

WindowsError：[错误 32] 进程无法访问该文件，因为它正被另一个进程使用：'text.pckl'

如何关闭文件以使处理器不再使用它？到目前为止，我已经使用了 file.close() 命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:39:20.173

尝试以下：

```
os.close('text.pckl') 
```

# python - OpenERP 7 用户角色的访问权限

> ID：15966676
> 
> 赞同：1
> 
> 时间：2013-04-12T08:35:48.373
> 
> 标签：python, xml, openerp

我需要为我的模块添加用户并需要对他们进行一些菜单项限制。主要是我创建了用户和管理员角色。在设置 -> 用户 -> 创建用户 -> 访问权限中，我更改了用户或管理员。但对该用户没有影响并且不向他们显示任何菜单项。主菜单项也不会显示。我在 bpl_security.xml 中添加了代码，并将该 xml 文件映射到 openerp.py 文件中。我有什么遗漏吗？请检查我的代码和建议

```
<?xml version="1.0" ?>
<openerp>
    <data>
        <record model="ir.module.category" id="module_checkroll_category">
            <field name="name">Checkroll</field>
            <field name="description">manager-create new products</field>
            <field name="sequence">16</field>
        </record>
        <record id="group_checkroll_user" model="res.groups">
            <field name="name">Checkroll_User</field>
            <field name="category_id" ref="module_checkroll_category" />
        </record>
        <record id="group_checkroll_manager" model="res.groups">
            <field name="name">Checkroll_Manager</field>
            <field name="implied_ids" eval="[(4, ref('group_checkroll_user'))]" />
            <field name="category_id" ref="module_checkroll_category" />
            <field name="users" eval="[(4, ref('base.user_root'))]" />
        </record>
    </data>
</openerp> 
```

我的整个代码[在这里](https://github.com/priyankahdp/openerp.git)上传并查看它的 bpl_view.xml 第 705 行

这里显示了我在 view.xml 中的相关部分

```
<menuitem id="menu_bpl" name="Checkroll/Registration" groups="group_checkroll_manager,group_checkroll_user" />
<menuitem id="menu_bpl_ref" name="Reference" parent="menu_bpl"
groups="group_checkroll_user" />
<menuitem id="menu_bpl_logic" name="Company Specific" parent="menu_bpl"
groups="group_checkroll_manager" /> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T09:38:16.120

我在您的模块中没有找到任何**ir.model.access.csv**访问权限。您必须在您的模块中创建 ir.model.access.csv，我建议您创建一个安全文件夹并将安全相关文件放在那里

喜欢

```
Security
  ----ir.model.access.csv
  ----sale_security.xml 
```

并更改**openerp** .py 文件，例如

'security/sale_security.xml'、'security/ir.model.access.csv'、

并在 ir.model.access.csv 文件中提供如下访问权限：

```
id,name,model_id:id,group_id:id,perm_read,perm_write,perm_create,perm_unlink
access_sale_shop,sale.shop,model_sale_shop,base.group_user,1,0,0,0
access_sale_order,sale.order,model_sale_order,base.group_sale_salesman,1,1,1,0 
```

access_sale_shop 是您访问的 id，它可以是任何您可以写的东西，例如，access_sale_shop1、access_sale_shop2 等。

name 是对象的名称， sale.shop 是您的对象的名称

perm_read,perm_write,perm_create,perm_unlink 用于读取、写入、创建、取消链接你给它 1 表示这个组有权限，0 表示没有权限，就像你给 perm_create 意味着用户可以在这个对象中创建，希望这对你来说清楚

model_id 是您的模型的 ID，这里 model_sale_shop 在您模块中的对象处添加模型，它会像：对于这个对象**bpl.deduction.estate.data**它将是**model_bpl_deduction_estate_data**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:00:19.820

我认为，您还需要检查我们为每个对象分配的访问权限，例如谁可以管理该对象的哪些操作（编辑/删除/创建/读取）。我可以从您那里看到两个组：Checkroll_User 和 Checkroll_Manager，但是您是否为这些组分配了对象的任何访问权限？

# html - 在 HTML 中创建表格

> ID：15966682
> 
> 赞同：2
> 
> 时间：2013-04-12T08:36:07.853
> 
> 标签：html, css

[要在HTML](http://en.wikipedia.org/wiki/HTML)中创建表格，我们使用 <table>、<tr>、<th> 和 <td>。

但现在我经常看到使用 <thead>、<tfoot> 和 <tbody>`。这是一种新的 HTML 方法吗？为什么也需要这个？这样做有什么好处？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:41:23.683

请参阅*[HTML <thead> 标签](http://www.w3schools.com/tags/tag_thead.asp)*。它为浏览器提供了有关表格的更多信息，允许它在显示表格时做出更明智的选择。

例如：在大表格中滚动时，标题可能会锁定在屏幕顶部，因此您无需向上滚动即可了解列的含义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:41:42.293

它们只是用于指定表格的每个部分（正文、页眉和页脚）的新标签。以前只能使用`<th>`标签（标题）。

[使用CSS](http://en.wikipedia.org/wiki/Cascading_Style_Sheets)设置这些元素的样式可能更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T08:45:16.637

首先你应该知道 HTML 已经升级到[HTML5](http://en.wikipedia.org/wiki/HTML5)了。所以以前的 HTML 标签没有你提到的标签，所以 <thead> 用于表头， <tfoot> 用于页脚， <tbody> 在您启动 HTML 页面时与正文相同。

有关更多信息，最好转到*[HTML5 演示和示例](http://html5demos.com/)*。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-12T08:48:42.220

它只是编写[HTML](http://en.wikipedia.org/wiki/HTML)表格标签（正文、标题和页脚）的一种高级方法。

# android - 在 monodroid 项目中使用 jni 发生意外崩溃

> ID：15966684
> 
> 赞同：1
> 
> 时间：2013-04-12T08:36:11.907
> 
> 标签：android, java-native-interface, xamarin.android, xamarin, segmentation-fault

我一直在尝试使用 Xamarin Studio 将一个简单的 hello world NDK 项目导入一个 monodroid 项目。

项目的 NDK 部分可以正常编译和构建，我可以调用本机方法，但是当我尝试使用`JNIEnv`SIGSEGV 访问应用程序崩溃时，请参阅下面的控制台输出和相关代码片段。

```
Very basic console logging
Starting method
Accessing env
Stacktrace:

  at <unknown> <0xffffffff>
  at (wrapper managed-to-native) BasicNDK.Activity1.LogNdk (string) <IL 0x00032, 0xffffffff>
  at BasicNDK.Activity1.<OnCreate>b__0 (object,System.EventArgs) [0x00023] in c:\Users\cbramley\Documents\Visual Studio 2012\Projects\AndroidApplication1\BasicNDK\MainActivity.cs:56
  at Android.Views.View/IOnClickListenerImplementor.OnClick (Android.Views.View) [0x0000c] in /Users/builder/data/lanes/monodroid-mlion-master/bf2b736d/source/monodroid/src/Mono.Android/platforms/android-10/src/generated/Android.Views.View.cs:643
  at Android.Views.View/IOnClickListenerInvoker.n_OnClick_Landroid_view_View_ (intptr,intptr,intptr) [0x00011] in /Users/builder/data/lanes/monodroid-mlion-master/bf2b736d/source/monodroid/src/Mono.Android/platforms/android-10/src/generated/Android.Views.View.cs:614
  at (wrapper dynamic-method) object.6ea2e501-d56c-455b-9c13-849da747461e (intptr,intptr,intptr) <IL 0x00017, 0x00043>
  at (wrapper native-to-managed) object.6ea2e501-d56c-455b-9c13-849da747461e (intptr,intptr,intptr) <IL 0x00023, 0xffffffff>

=================================================================
Got a SIGSEGV while executing native code. This usually indicates
a fatal error in the mono runtime or one of the native libraries 
used by your application.
================================================================= 
```

monodroid 活动代码：

```
 // snipped rest of activity
        [DllImport ("ndksample")]
        static extern void LogNdk ( string w );

        [DllImport ("ndksample")]
        static extern void LogNdkDefaultMessage ();

        protected override void OnCreate ( Bundle bundle )
        {
            base.OnCreate ( bundle );
            SetContentView ( Resource.Layout.Main );

            Button button = FindViewById<Button> ( Resource.Id.myButton );            
            button.Click += delegate
            {
                // launch our NDK code                
                try
                {
                    LogNdkDefaultMessage();
                    LogNdk("Message to log");
                }
                catch (Exception e)
                {
                    Log.Warn("MainShort",e.ToString());
                }    
            };
        } 
```

最后是 NDK 实现：

```
#include <jni.h>
#include <string.h>
#include <android/log.h>

#define DEBUG_TAG "NDK_AndroidNDK1SampleActivity"

void LogNdk(JNIEnv * env, jobject this, jstring logThis)
{
    __android_log_print(ANDROID_LOG_DEBUG, DEBUG_TAG, "Starting method");
    jboolean isCopy;
    __android_log_print(ANDROID_LOG_DEBUG, DEBUG_TAG, "Accessing env");
    const char * szLogThis = (*env)->GetStringUTFChars(env, logThis, &isCopy);
    __android_log_print(ANDROID_LOG_DEBUG, DEBUG_TAG, "NDK:LC: [%s]", szLogThis);
    (*env)->ReleaseStringUTFChars(env, logThis, szLogThis);
    __android_log_print(ANDROID_LOG_DEBUG, DEBUG_TAG, "Finished");
}

void LogNdkDefaultMessage(JNIEnv * env, jobject this)
{
   __android_log_print(ANDROID_LOG_DEBUG, DEBUG_TAG, "Very basic console logging");
} 
```

我已经将问题追踪到这条线路上的崩溃，`const char * szLogThis = (*env)->GetStringUTFChars(env, logThis, &isCopy);`但我不明白是什么原因造成的，有人可以帮我解释一下吗？或者更好的是告诉我如何解决它:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T02:34:09.833

我不是专家，但在我的 monodroid 项目中使用第三方 JNI 库有点挣扎。
这与我使用 BindingLibrary 类型的项目来生成我将在 Monodroid 应用程序上使用的 .jar c#-wrapper 不同。
当 BindingLibrary 项目生成它的代码时，您可以看到如果它必须将一个字符串传递给 JNI 代码，它会这样做：

```
IntPtr intPtr = JNIEnv.NewString ("string here");
...
callJNIMethodPassingString(new JValue (intPtr)); 
```

也许可能有用..或者可能根本没有:)

# php - 无用户操作后自动重定向

> ID：15966686
> 
> 赞同：-2
> 
> 时间：2013-04-12T08:36:28.347
> 
> 标签：php, redirect, codeigniter-2

*T-mobile 已经使用了这个逻辑，但我不知道该怎么做。*

**这是场景：**我登录我的网站，2 分钟内什么都不做，只是坐着看屏幕。在这种情况下，我应该被重定向到会话将被销毁的注销页面。

我怎样才能做到这一点？

网络上的示例基于用户操作，例如**在用户活动之后**检查某事（最后一个活动等） 。

注意：我正在使用 Codeigniter 及其数据库会话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:40:19.127

你需要javascript：

```
<script type="text/javascript">
setTimeout(onUserInactivity, 1000 * 120)
function onUserInactivity() {
   window.location.href = "onUserInactivity.php"
}
</script> 
```

这将在 2 分钟不活动后重定向用户。如果你想让它依赖于鼠标移动，请尝试：

```
<script type="text/javascript">
inactivityTimeout = False
resetTimeout()
function onUserInactivity() {
   window.location.href = "onUserInactivity.php"
}
function resetTimeout() {
   clearTimeout(inactivityTimeout)
   inactivityTimeout = setTimeout(onUserInactivity, 1000 * 120)
}
window.onmousemove = resetTimeout
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:41:18.860

所以，在页面加载

```
$now = mktime();
if($now - $_SESSION['last_activity'] < 120)
{
 $_SESSION['last_activity']=mktime(); 
}else{
 logout();
} 
```

自上次活动以来是否已过去 120 秒？注销他们/销毁他们的会话等。

要让页面在空闲后自动注销，您应该使用 javascript。

如果您希望在没有 javascript 且用户没有任何操作的情况下发生这种情况，请将其放在您的所有视图中：

```
<meta HTTP-EQUIV="REFRESH" content="120; url=http://www.yourdomain.com/logout.php"> 
```

它会在页面上 120 秒后将它们重定向到您的注销屏幕。如果他们点击

# javascript - 有没有 Javascript 的替代品

> ID：15966688
> 
> 赞同：-5
> 
> 时间：2013-04-12T08:36:31.223
> 
> 标签：javascript, html

我的意思是一种独立于 Java 脚本的语言，它可以使用和操作 Html，也可以像 javascript 一样进行计算等

编辑：在浏览器中

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T08:38:40.937

[typescript](http://www.typescriptlang.org/)是微软开发的静态类型替代方案。

[Dart](http://code.google.com/p/dart/) google 改进了 javascript。

[Coffeescript](http://coffeescript.org/)是 javascript 之上的一些语法糖——但可能是三者中最受欢迎的。

javascript nayway 有什么问题？它很棒，虽然一开始有点奇怪。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T08:50:02.963

Javascript 是所有浏览器都支持的唯一脚本语言。

有很多库和插件可以用来生成 Javascript，而无需自己编写所有代码，但最终它们都使用 Javascript。

Micrsoft 还在 Internet Explorer 9 中支持 VBScript。在 IE 10 中，您必须强制页面进入兼容模式才能使用 VBScript。

# c# - 在richtextblock中单击时如何显示图像弹出窗口：Windows 8？

> ID：15966692
> 
> 赞同：0
> 
> 时间：2013-04-12T08:36:40.140
> 
> 标签：c#, xaml, windows-8

如何使用 C# 实现，以便每次单击图像时，它都会显示在弹出窗口中？ [http://farm9.staticflickr.com/8403/8641588811_a87169fe58_b.jpg](http://farm9.staticflickr.com/8403/8641588811_a87169fe58_b.jpg)

```
RichTextBlock richText = d as RichTextBlock;
string xaml = HtmlToXamlConverter.ConvertHtmlToXaml(xhtml, true);
RichTextBlock newRichText = (RichTextBlock)XamlReader.Load(xaml);
richText.Blocks.Clear();
for (int i = newRichText.Blocks.Count - 1; i >= 0; i--)
{
    Block b = newRichText.Blocks[i];
    newRichText.Blocks.RemoveAt(i);
    richText.Blocks.Insert(0, b);
 } 
```

xml内容：

```
<RichTextBlock xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
               xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
               xmlns:control="using:TinTuc.Controls">
    <Paragraph LineStackingStrategy="MaxHeight">Nếu em yêu một chàng trai Sư TửEm sẽ có một người mạnh mẽ, quyết đoán, đầy lòng kiêu hãnh và tự trọng ở bên.</Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">Mang trong mình thuộc tính lửa, sự nhiệt tình, nhiệt huyết của Sư Tử luôn rất lớn nhưng những người thuộc cung hoàng đạo này cũng dễ dàng nổi giận. Nếu em yêu một chàng trai Sư Tử, sẽ ra sao?</Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">Em sẽ có bờ vai vững chắc để dựa những lúc mỏi mệt. Anh biết những bận rộn, những lo toan, cố gắng thường ngày sẽ khiến em cần một người ở bên cạnh, thậm chí chẳng nói gì cả, chỉ cần là nơi cho em dựa vào để quên những khó khăn, nhọc nhằn trước mắt. Với anh, thế là đủ rồi.</Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">Có lúc anh sẽ làm em tổn thương vì những lần nóng giận. Nhưng Sư Tử có trí nhớ của cá, chỉ một chốc thôi là quên hết mọi bực bội trong lòng. Nên những lần anh sai như vậy, mong em hãy góp ý nhỏ nhẹ, đừng giận anh mà bỏ đi.</Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">
        <InlineUIContainer>
            <ImageLoader xmlns="using:TinTuc.Controls" 
                         Source="http://img2.news.zing.vn/2013/04/12/4-15.jpg" 
                         Stretch="Uniform">
                <ImageLoader.LoadingContent>
                    <StackPanel xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
                                Width="420" 
                                MinHeight="250">
                        <ProgressRing VerticalAlignment="Center" 
                                      HorizontalAlignment="Center" 
                                      IsActive="True" 
                                      Width="30" 
                                      Height="30" 
                                      Margin="10,100,10,30" 
                                      Foreground="Red"/>
                    </StackPanel>
                </ImageLoader.LoadingContent>
            </ImageLoader>
        </InlineUIContainer> Sư Tử luôn nhiệt tình nhưng rất dễ nổi giận.
    </Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">Em sẽ có một người mạnh mẽ, quyết đoán, đầy lòng kiêu hãnh và tự trọng ở bên. Những lúc em cần lời khuyên, khi con đường em đi đầy gai nhọn, lúc em vấp ngã cần người nâng dậy, anh sẽ không chỉ là người yêu, mà còn là người anh trai, là người bạn đồng hành để cùng em chia sẻ.</Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">Em sẽ nhận được những sự chăm sóc, sự quan tâm ân cần từ một trái tim ấm áp. Nhưng đôi khi, em sẽ cảm thấy ngạt thở vì sự quan tâm thái quá ấy. Chỉ là anh luôn muốn mang lại mọi điều tốt đẹp nhất cho em mà thôi, đừng bực mình, đừng khó chịu với anh, em nhé!</Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">Em sẽ không được nghe những lời có cánh, sẽ có ít phút giây lãng mạn, ngọt ngào như em mong đợi, anh chỉ có một vòng ôm siết chặt, chỉ có một cái nắm tay ấm áp, chỉ có một đáy lòng thành thật mà đôi khi ngốc nghếch quá chừng thôi…&lt;/Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">Nếu em yêu một chàng trai Sư Tử, hãy dành tình yêu cho mình anh thôi. Sư Tử không bao giờ chấp nhận sự phản bội và những điều dối trá, nên đừng quay lưng giấu diếm anh điều gì dẫu chỉ một lần.</Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">Đôi lúc em sẽ phải yêu chàng trai trẻ con và vô cùng ngang bướng. Hãy làm người lớn bao dung, nhưng nhớ đừng chiều quá, anh hư.</Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">Nếu em yêu một chàng trai Sư Tử, em sẽ có tình yêu của một trái tim chân thành. Tuy có thể anh sẽ giả vờ lạnh lùng, đôi lúc vô tâm, nhưng thực tình anh luôn muốn gần bên em hơn nữa.</Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">Tưởng rằng oai hùng lắm, nhưng khi yêu em, Sư Tử chỉ như chú mèo nhỏ ngoan hiền. Và nếu em “lỡ” yêu phải một chàng trai Sư Tử, ở nơi đó, em sẽ thấy bình yên…&lt;/Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">Theo Tiin</Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight"/>
</RichTextBlock> 
```

# php - explode() into $key=>$value pair

> ID：15966693
> 
> 赞同：38
> 
> 时间：2013-04-12T08:36:40.750
> 
> 标签：php

I have this:

```
$strVar = "key value"; 
```

And I want to get it in this:

```
array('key'=>'value') 
```

I tried it with explode(), but that gives me this:

```
array('0' => 'key',
      '1' => 'value') 
```

The original $strVar is already the result of an exploded string, and I'm looping over all the values of the resulting array.

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-04-12T08:39:46.373

Don't believe this is possible in a single operation, but this should do the trick:

```
list($k, $v) = explode(' ', $strVal);
$result[ $k ] = $v; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-12-03T22:09:02.423

```
$my_string = "key0:value0,key1:value1,key2:value2";

$convert_to_array = explode(',', $my_string);

for($i=0; $i < count($convert_to_array ); $i++){
    $key_value = explode(':', $convert_to_array [$i]);
    $end_array[$key_value [0]] = $key_value [1];
} 
```

Outputs array

```
$end_array(
            [key0] => value0,
            [key1] => value1,
            [key2] => value2
            ) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-12T08:39:13.227

```
$strVar = "key value";
list($key, $val) = explode(' ', $strVar);

$arr= array($key => $val); 
```

**Edit:** My mistake, used split instead of explode but:

> split() function has been DEPRECATED as of PHP 5.3.0\. Relying on this feature is highly discouraged

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-12T08:39:19.903

You can loop every second string:

```
$how_many = count($array);
for($i = 0; $i <= $how_many; $i = $i + 2){
  $key = $array[$i];
  $value = $array[$i+1];
  // store it here
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-12T08:39:28.813

Try this

```
$str = explode(" ","key value");
$arr[$str[0]] = $str[1]; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-12T08:42:45.123

```
$pairs = explode(...);
$array = array();
foreach ($pair in $pairs)
{
    $temp = explode(" ", $pair);
    $array[$temp[0]] = $temp[1];
} 
```

But it seems obvious providing you seem to know arrays and `explode`. So there might be some constrains that you have not given us. You might update your question to explain.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-05-15T16:30:52.653

You can try this:

```
$keys = array();
$values = array();

$str = "key value"; 
$arr = explode(" ",$str);

foreach($arr as $flipper){
   if($flipper == "key"){
      $keys[] = $flipper;
   }elseif($flipper == "value"){
      $values[] = $flipper;
   }
}

$keys = array_flip($keys);
// You can check arrays with
//print_r($keys);
//print_r($values);

foreach($keys as $key => $keyIndex){
  foreach($values as $valueIndex => $value){
       if($valueIndex == $keyIndex){
          $myArray[$key] = $value;
       }
  }
} 
```

I know, it seems complex but it works ;)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-02T15:24:34.170

Another single line:

```
parse_str(str_replace(' ', '=', $strVar), $array); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-02-19T07:03:36.813

If you have more than 2 words in your string, use the following code.

```
 $values = explode(' ', $strVar);

    $count = count($values);
    $array = [];

    for ($i = 0; $i < $count / 2; $i++) {
        $in = $i * 2;
        $array[$values[$in]] = $values[$in + 1];
    }

    var_dump($array); 
```

The `$array` holds oddly positioned word as `key` and evenly positioned word `$value` respectively.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-01-17T13:45:49.830

```
list($array["min"], $array["max"]) = explode(" ", "key value"); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-01-24T11:13:15.427

If you have long list of key-value pairs delimited by the same character that also delimits the key and value, this function does the trick.

```
function extractKeyValuePairs(string $string, string $delimiter = ' ') : array
{
    $params = explode($delimiter, $string);

    $pairs = [];
    for ($i = 0; $i < count($params); $i++) {
        $pairs[$params[$i]] = $params[++$i];
    }

    return $pairs;
} 
```

Example:

```
$pairs = extractKeyValuePairs('one foo two bar three baz');

[
    'one'   => 'foo',
    'two'   => 'bar',
    'three' => 'baz',
] 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-10-11T11:11:38.207

If you have more values in a string, you can use `array_walk()` to create an new array instead of looping with `foreach()` or `for()`. I'm using an anonymous function which only works with PHP 5.3+.

```
// your string
$strVar = "key1 value1&key2 value2&key3 value3";

// new variable for output
$result = array();

// walk trough array, add results to $result
array_walk(explode('&', $strVar), function (&$value,$key) use (&$result) {
    list($k, $v) = explode(' ', $value);
    $result[$k] = $v;
});

// see output
print_r($result); 
```

This gives:

```
Array
(
    [key1] => value1
    [key2] => value2
    [key3] => value3
) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-02-27T01:27:12.420

I am building an application where some informations are stored in a key/value string.

> tic/4/tac/5/toe/6

Looking for some nice solutions to extract data from those strings I happened here and after a while I got this solution:

```
$tokens = explode('/', $token);

if (count($tokens) >= 2) {
    list($name, $val) = $tokens;
    $props[$name] = $val;
}

if (count($tokens) >= 4) {
    list(, , $name, $val) = $tokens;
    $props[$name] = $val;
}

if (count($tokens) >= 6) {
    list(, , , , $name, $val) = $tokens;
    $props[$name] = $val;
}

// ... and so on 
```

*freely inspired by smassey's solution*

This snippet will produce the following kinds of arrays:

```
$props = [
    'tic' => 4,
]; 
```

or

```
$props = [
    'tic' => 4,
    'tac' => 5,
]; 
```

or

```
$props = [
    'tic' => 4,
    'tac' => 5,
    'toe' => 6,
]; 
```

*my two cents*

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2015-07-20T09:56:17.483

Single line for ya:

```
$arr = array(strtok($strVar, " ") => strtok(" ")); 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2016-04-08T11:10:47.747

I found another easy way to do that:

```
$a = array_flip(explode(' ', $strVal)); 
```

# r - 无法将文件读入 R

> ID：15966698
> 
> 赞同：0
> 
> 时间：2013-04-12T08:37:13.617
> 
> 标签：r

我是一个新的 R 用户，我正在尝试将我的文件 P506A-data-time-v3.csv 读入 R，但是它响应：

```
Error in file(file, "rt") : cannot open the connection
In addition: Warning message:
In file(file, "rt") : cannot open file '
P506A
-
data
-
time
.csv': Invalid argument 
```

我将目录更改为计算机上保存文件的文件夹。

所以我查找了其他类似的问题，人们说要使用 choose.file，但我认为我输入正确。R给我的结果是：

```
> file.choose
function (new = FALSE) 
.Internal(file.choose(new))
<bytecode: 0x07c80118>
<environment: namespace:base>
> P506A
Error: object 'P506A' not found
> -
+ data
Error in -data : invalid argument to unary operator
> -
+ timeP506A-data-time-v3<-read.table(file.choose(),header=T,sep="\t") 

Error in -timeP506A - data - time - v3 <- read.table(file.choose(), header = T,  :

  object 'timeP506A' not found

In addition: Warning message:

In read.table(file.choose(), header = T, sep = "\t") :`enter code here`

  incomplete final line found by readTableHeader on 'D:\Uni\114\Probelm Solving 
```

所以这对我来说似乎是一个复杂的问题，所以任何关于如何让 R 读取我的文件的帮助都将非常感激。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T10:15:13.540

尝试以下

```
File = read.csv("P506A-data-time-v3.csv", header = TRUE) 
```

你也可以参考下面的教程

[http://www.cyclismo.org/tutorial/R/input.html#read](http://www.cyclismo.org/tutorial/R/input.html#read)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-23T14:41:08.997

使用 R Studio（最新版本）并正确设置了我的工作区时，我遇到了同样的问题。准确地说，我有：

文件“FILENAME.csv”有幻数“YEAR”，不推荐使用 2 之前的保存版本

所以我将第 1 行第 1 列标题“YEAR”更改为其他内容，问题就消失了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-08T21:30:09.430

我同意其他建议，尽管这里更容易一些。首先执行getwd()。现在是您所需文件所在的文件夹吗？可能不是。希望您使用的是 R Studio。如果是这样，则手动转到控制台旁边的右下面板并单击该面板左上角的文件。然后单击三个点“...”并转到您首选的工作目录。单击确定。然后单击蓝色轮子旁边的“更多”，就在三个点的左侧。然后选择“设置为工作目录”。而已！:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-21T05:50:54.337

很晚但正确的答案我也遇到过这个问题，这不是一个大问题。您必须提供错误的文件名或未提供正确的文件扩展名。

# scala - Scala 模板限制

> ID：15966704
> 
> 赞同：1
> 
> 时间：2013-04-12T08:37:24.350
> 
> 标签：scala, templates

在 Scala 中，是否可以对模板化类型提供任意限制？在我正在处理的特定情况下，我有一个带有两个模板参数的类，如下所示：

```
class TwoWayMap[S,T]( )
{
    ...
} 
```

我正在尝试围绕一对地图进行薄包装，允许用户在两​​个方向上查找键。将两种类型限制为不相同将允许根据类型查找值，从而允许我编写以下两个内容：

```
def apply( t : T )
def apply( s : S ) 
```

但显然，如果类型相同，这不起作用，所以我想限制 S != T

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T09:33:56.763

由于 Java 类型擦除两者`def apply(t: T)`都会`def apply(s: S)`导致`def apply(...: Object)`其中不明确。

因此，即使您会发现`S != T`对此有限制也是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T11:00:40.930

除了 Joa Ebert 写道： 解决此问题的一种可能方法是使用以下`Either`类型：

```
class TwoWayMap[S,T] {
    def apply(k:Either[S,T]):Either[S,T] = k match {
        case Left(s) => Right(tForS(s))
        case Right(t) => Left(sForT(t))
    }
    // ...
} 
```

也许它对你来说太多样板。

# python - git-dulwich：如何合并或变基？

> ID：15966707
> 
> 赞同：1
> 
> 时间：2013-04-12T08:37:34.003
> 
> 标签：python, git, merge, rebase, dulwich

我试着做一个网站来提供一些服务器，比如有目的的协作写作。但我不会创造同样的轮子。所以我选择 git 作为 VCS（版本控制系统）使用[dulwich](http://www.samba.org/~jelmer/dulwich/)。dulwich 的一切都很好，但我没能找到 git 命令的解决方案，比如 'merge' 或 'rebase' 到处理程序分支。有人可以帮助提供一些使用 dulwich 合并和变基 git 分支的提示或示例吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-19T21:47:29.403

正如 Gary 所提到的，dulwich 不提供合并或变基支持，因为要很好地实现这一点很重要。

一种选择是只为合并和变基而掏腰包。

最终，我们希望 Dulwich 支持使用其他合并实现，例如耐心差异，而不是从头开始重做合并。

# javascript - 未捕获的语法错误：意外的令牌（

> ID：15966713
> 
> 赞同：0
> 
> 时间：2013-04-12T08:37:47.507
> 
> 标签：javascript, syntax-error

我收到以下错误：

```
Uncaught SyntaxError: Unexpected token ( /timeline/scripts/collections/events.js?bust=1365755363650:1 
```

这是**/timeline/scripts/collections/events.js**：

```
function () {
    return Backbone.Collection.extend({
        model: Event

    ,   parse: function(data) {
            var parsed = [];
            $(data).find('Event').each(function(index) {
                parsed.push({
                    title: $(this).find('title').text()
                ,   date: $(this).find('date').text()
                ,   content: $(this).find('content').text()
                });
            });
            return parsed;
        }

    ,   fetch: function(options) {
            options = options || {};
            options.dataType = "xml";
            Backbone.Collection.prototype.fetch.call(this, options);
        }
    });
}; 
```

出于某种原因，它令人窒息，`function () {`但我不知道为什么。这是整个文件。谁能解释这有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:39:27.473

你有一个函数*声明*，而不是函数表达式。函数声明必须有名称。

```
function foo () {
    return Backbone.Collection.extend({ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:39:38.417

您不能在不调用匿名函数的情况下声明它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:46:55.823

当一个语法检查器没有给出有用的错误消息时，请尝试另一个。

我通常是 Chrome 开发者工具的粉丝，但在这种情况下，Chrome 并没有给出很好的错误信息。所以我尝试将您的代码粘贴到 Firefox 中，它*更有*帮助：

```
SyntaxError: function statement requires a name
    function () { 
```

[通过将您的代码粘贴到Komodo](http://www.activestate.com/komodo-edit)中，我也收到了同样的错误消息，它在您编辑时会进行实时语法检查。（因为 Komodo 是基于 Firefox 的，所以消息是一样的也就不足为奇了。）

当一个工具没有帮助时，尝试不同的工具是值得的。

# web-services - OC4J 是否支持 JAX-WS？

> ID：15966717
> 
> 赞同：1
> 
> 时间：2013-04-12T08:38:04.700
> 
> 标签：web-services, webserver, jax-ws, oc4j

我得到了文档 [http://docs.oracle.com/cd/B25221_05/web.1013/b14432/intro.htm#BABCDFAD](http://docs.oracle.com/cd/B25221_05/web.1013/b14432/intro.htm#BABCDFAD) 但是我无法理解 OAS(OC4J) 是否支持 JAX-WS。

谢谢，拉胡尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T14:55:56.860

OC4J 没有对 JAX-WS 的本*机*支持，这符合 J2EE 1.4 规范。JAX-WS（类似于 JAX-RPC 2.0）是 Java EE 5 的一个特性，已经包含在 Java SE 6 及更高版本中。

但是，在 OC4J 中可能具有此功能。本文提供了使用 JAX-WS RI API 的一些注意事项[。](http://www.fransvanbuul.net/?p=8)

也可以看看：

*   在 OC4J 中[使用注释组装 Web 服务](http://docs.oracle.com/cd/B25221_05/web.1013/b14434/devannotation.htm)
*   [使用 JAX-WS Web 服务：简史](http://www.accordess.com/wpblog/working-jax-ws-services-history/)
*   [Web 服务提示和技巧：JAX-RPC 与 JAX-WS，第 1 部分](http://www.ibm.com/developerworks/webservices/library/ws-tip-jaxwsrpc/index.html)，来自 IBM developerWorks

# jquery - 页面加载时如何隐藏空白div

> ID：15966719
> 
> 赞同：1
> 
> 时间：2013-04-12T08:38:10.273
> 
> 标签：jquery, html, html-lists, html-table

我正在使用下面的脚本来隐藏空白`div`,`li`和`td`. 它工作正常。我面临的唯一问题是，当页面加载时它显示空白`divs`，`li`并且`td`. 我在这些空白 div 上有一个边框类，在页面加载完成之前它是可见的，这是我不想要的。我想隐藏它，直到这些元素没有填充任何文本或任何内容。

脚本：

```
$(document).ready(function(){
    $("td:empty").css('display', 'none');
    $("div[class='errorMsg']").filter(function(i,v){return $.trim($(v).text()).length == 0;}).css('display', 'none');
    $('li').filter(function(){return $.trim($(this).html()) == '';}).hide()
    $("td[class='noShow']").filter(function(i,v){return $.trim($(v).text()).length == 0;}).css('display', 'none');
  }); 
```

我可以得到任何帮助来修复它。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:40:31.303

一个简单的解决方案是改变你的策略。默认情况下，隐藏 div 并显示那些不为空白的 div。

*更新 ：*

在您的 css 文件中隐藏 div.errorMsg ：

```
div.errorMsg
{
    display : none;
} 
```

然后在你的脚本中修改你的代码如下：

```
$("div[class='errorMsg']").filter(function(i,v){return $.trim($(v).text()).length > 0;}).css('display', 'block'); 
```

或写如下：

```
$("div.errorMsg:not(:empty)").css('display', 'block'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:43:44.003

为什么不这样：

```
var $div2hide = $.trim($("div.errorMsg:empty"));
$div2hide.hide(); 
```

只需获取空的 div 并修剪它的所有空格，如果它是空的，则将其隐藏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T08:44:28.113

您可以在页面加载时隐藏`empty`具有特定类的 div，如下所示：`errorMsg`

```
$(function() {
    $("div.errorMsg:empty").hide();
}); 
```

如果要隐藏`empty`页面上的所有 div：

```
$(function() {
    $("div:empty").hide();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T08:40:15.880

你不能在加载之前修改 dom。但是，如果您真的想这样做，请使用以下方法：

*   默认隐藏 every`div`等`li`。
*   当文档准备好时显示它们（如果它们不为空）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-12T08:41:43.873

基本上，如果一个元素是空的，我们会使用它来隐藏

```
$(function() {
      $("element:empty").hide();
}); 
```

# jsp - 如何在jsp中将IF条件放在<%=exception.getMessage() %>

> ID：15966721
> 
> 赞同：0
> 
> 时间：2013-04-12T08:38:17.960
> 
> 标签：jsp

我在 web.xml 中使用了以下行，因此如果应用程序中发生 GenericException，则可以调用 genericException.jsp。

```
<error-page>
<exception-type>com.example.GenericException</exception-type>
<location>/WEB-INF/jsp/genericException.jsp</location>
</error-page> 
```

我想仅当它是数字时才在我的屏幕上显示 exception.getMessage()。当我尝试使用 ${exception.getMessage()} 在屏幕上打印它时，它不起作用

相反，我不得不使用 <%=exception.getMessage() %> 在屏幕上打印相同的内容。

只有当它是一个数字（基本上是错误代码）时，我才想打印它。
我的问题是我无法检查这是否是数字。有人可以告诉我jsp中的逻辑如何。

到目前为止，我已经使用 c:if test = 将 IF 条件放在 ${exception.getMessage()} 类型的变量上

但无法将 IF 条件置于 <%=exception.getMessage() %>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T08:17:51.447

```
<%@page import="com.example.GenericException"%>
<%@ page contentType="text/html;charset=UTF-8" language="java" isErrorPage="true"%>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head><title>Error Message</title></head>
<body>
<form action="" method="post" >

    <center>
        <br><br>
        <table width="90%" height="100px"
               style="  -moz-border-radius: 8px;  -webkit-border-radius: 8px;border-radius: 8px;border: 2px solid #467aa7;">
            <tr>
                <td style="color:#467aa7;">
                    <% 
                        GenericException e = (GenericException) exception;
                        int code = e.getErrorCode();
                        String message = e.getErrorMessage();

                        if (code != 0) {
                            message = code + " : " + message;
                        }
                    %>

                    <label><%=message %></label>
                </td>
            </tr>
        </table>
    </center>
</form>
</body>
</html> 
```

# opencv - 使用 Openni 从 Kinnect 捕获 RGB 并使用 OpenCV 显示

> ID：15966722
> 
> 赞同：8
> 
> 时间：2013-04-12T08:38:18.717
> 
> 标签：opencv, kinect, rgb, simple-openni

我需要从 Kinnect 相机捕获彩色 RGB 图像，但我想在 OpenCV 中显示它，因为这只是更大程序的一部分。如果你设置了标志，我知道 OpenCV 与 OpenNI 兼容，但是尽管我努力 CMake 找不到 OpenNI2 的路径，所以我无法用 OpenNI 构建 OpenCV。无论如何，我认为知道如何手动将 OpenNI 帧转换为 openCV 帧是件好事，所以我决定采用这种方式。

为了在 OpenNI 中捕获颜色帧，我尝试了以下方法：

```
openni::Device device;  
openni::VideoStream  color;
openni::VideoFrameRef colorFrame;

rc = openni::OpenNI::initialize();
rc = device.open(openni::ANY_DEVICE);
rc = color.create(device, openni::SENSOR_COLOR);
rc = color.start();

color.readFrame(&colorFrame);
const openni::RGB888Pixel* imageBuffer = (const openni::RGB888Pixel*)colorFrame.getData(); 
```

但现在我不明白如何转换为 cv::Mat。

有没有人能做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-12T09:03:52.150

好的，首先你应该将初始化与读取帧的循环分开，这样。

**初始化**

```
openni::Device device;  
openni::VideoStream  color;
openni::VideoFrameRef colorFrame;

rc = openni::OpenNI::initialize();
rc = device.open(openni::ANY_DEVICE);
rc = color.create(device, openni::SENSOR_COLOR);
rc = color.start();

Mat frame; 
```

现在是阅读框架的主循环。您几乎已经完成了所有工作，唯一剩下的就是将缓冲区复制到 openCV Mat。

**循环阅读帧**

```
while (true)
{
   color.readFrame(&colorFrame);
   const openni::RGB888Pixel* imageBuffer = (const openni::RGB888Pixel*)colorFrame.getData();

   frame.create(colorFrame.getHeight(), colorFrame.getWidth(), CV_8UC3);
   memcpy( frame.data, imageBuffer, 3*colorFrame.getHeight()*colorFrame.getWidth()*sizeof(uint8_t) );

   cv::cvtColor(frame,frame,CV_BGR2RGB); //this will put colors right
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-09T03:25:16.850

跟进@Jav_Rock 上面的回答，对于 IR 和 Depth，解决方案是相似的，除了以下内容（分别代替和`SENSOR_COLOR`）：`CV_8UC3``RGB888Pixel`

**深度**

*   传感器类型：`SENSOR_DEPTH`
*   OpenCV 类型：`CV_16UC1`
*   VideoFrameRef 数据：`DepthPixel`

请注意，您可能需要将 VideoStream 的 VideoFormat 的 PixelMode 设置为，`PIXEL_FORMAT_DEPTH_100_UM`否则您的深度图像看起来会很黑。

**红外**

*   传感器类型：`SENSOR_IR`
*   OpenCV 类型：`CV_16UC1`
*   VideoFrameRef 数据：`Grayscale16Pixel`

最后，请注意，深度和 IR 都不需要`cv::cvtColor`调用。

# rotation - 旋转标签上的 HighChart 边框颜色

> ID：15966723
> 
> 赞同：0
> 
> 时间：2013-04-12T08:38:20.653
> 
> 标签：rotation, highcharts, border

我正在玩高图表标签功能。

我尝试了一些边框颜色，它工作正常，除非我使用旋转。

如此[JSFiddle 所示](http://jsfiddle.net/ZZpty/)：

```
dataLabels: {
             align: 'left',
             enabled: true,
             rotation: 270, //if the rotation is 0, the border is working fine.
             x: 2,
             y: -10,
             //added for test purpose :
               borderColor: 'rgba(252, 0, 197, 0.7)',
               borderRadius: 3,
               borderWidth: 2
} 
```

设置旋转时，边框不会以相同的方式应用。

对我来说似乎是一个错误。

你能解释一下，也许可以为这个问题提供一个解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T09:04:30.373

这是已知的错误，在这里向我们的开发人员报告[https://github.com/highslide-software/highcharts.com/issues/1334](https://github.com/highslide-software/highcharts.com/issues/1334)

# certificate - 使用 corona sdk 构建 IOS 应用程序（未安装证书）

> ID：15966725
> 
> 赞同：0
> 
> 时间：2013-04-12T08:38:29.187
> 
> 标签：certificate, coronasdk, provisioning-profile

我正在使用适用于 IOS 的 corona sdk 创建一个应用程序。当我尝试在设备上构建此应用程序时，在代码签名身份下拉菜单中，它向我显示配置文件，但不允许我选择它们，因为它说未安装证书。我按照这些步骤在钥匙串访问中下载了证书并正确放置了配置文件。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-27T10:06:46.893

尝试使用天才版本...从官方网站下载并重试...与 mw 一起工作...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T04:29:58.140

你可以通过——

**[http://jp.anscamobile.com/dev/content/building-devices-iphoneipad/index.html](http://jp.anscamobile.com/dev/content/building-devices-iphoneipad/index.html)**

这将帮助您解决所有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T07:56:40.537

我也在我的应用程序中发现了这个问题。请检查 - 1- 有效的配置文件及其有效证书 2- 从 IDE 关闭您的项目并重新打开 Corona IDE 即 LuaGlider 等。 3- 运行您的应用程序 - 选择文件 - 构建 - iOS 4 - 再次添加代码签名身份。

这些步骤解决了我的问题。

# java - 如何通过反射改变方法行为？

> ID：15966726
> 
> 赞同：31
> 
> 时间：2013-04-12T08:38:31.617
> 
> 标签：java, android, design-patterns, legacy-code

我在一些遗留代码中有一个静态方法，由多个客户端调用。我显然没有选择覆盖它，或者通过依赖注入改变行为。我不允许修改现有的课程。

我现在要做的是使用反射改变行为（该方法 - 具有相同的签名和返回类型）。

是否可以 ？如果没有，任何设计模式都可以拯救我吗？

谢谢 ！

编辑：我可以更改/修改什么有些混乱。我无法更改任何现有的类/方法 - 但我可以向项目添加更多类。我能对现有类做的最好的事情就是注释它们。这一切都是为了避免破坏现有代码中的任何内容——这意味着对一个大项目进行一轮完整的测试。

编辑 2： java.lang.Instrumentation 不适用于 Android - 否则听起来很合适！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-04-12T08:50:08.663

听起来很奇怪的要求...

无论如何，反射不允许你改变代码行为，它只能探索当前代码，调用方法和构造函数，改变字段值，诸如此类。

如果您想实际更改方法的行为，则必须使用字节码操作库，例如 ASM。但这不会很容易，可能不是一个好主意......

可能对您有帮助的模式：

*   如果该类不是最终类并且您可以修改客户端，扩展现有类并使用您想要的行为重载该方法。编辑：只有在方法不是静态的情况下才有效！
*   方面编程：使用 AspectJ 向方法添加拦截器

无论如何，最合乎逻辑的做法是找到修改现有类的方法，变通办法只会使您的代码更加复杂且难以维护。

祝你好运。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-04-12T08:54:49.220

我想你可以看看有一个方法的[Instrumentation](http://docs.oracle.com/javase/6/docs/api/java/lang/instrument/Instrumentation.html)类`redefineClasses(ClassDefintion classDefinition)`。

重新定义可能会改变方法体、常量池和属性。重新定义不得添加、删除或重命名字段或方法，更改方法的签名或更改继承。

希望这可以帮助。

参考资料：[Javadoc](http://docs.oracle.com/javase/6/docs/api/java/lang/instrument/Instrumentation.html#retransformClasses%28java.lang.Class...%29)

# mysql - 单个查询以获取过去 7 天的单个天数，包括计数为 0 的天数

> ID：15966727
> 
> 赞同：2
> 
> 时间：2013-04-12T08:38:34.837
> 
> 标签：mysql, sql

```
SELECT DATE_FORMAT(createdTimestamp, "%D %b") AS date,
       COUNT(id) AS COUNT
FROM registration
WHERE createdTimestamp BETWEEN DATE_SUB(CURDATE(), INTERVAL 7 DAY) AND CURDATE()
GROUP BY DATE(createdTimestamp) 
```

它会显示类似

```
14th Feb - 10
15th Feb - 12
16th Feb - 4
17th Feb - 4
18th Feb - 10
19th Feb - 12
20th Feb - 9 
```

但是如果有一天没有注册它会跳过这一天，我如何用mysql查询将它显示为0？

```
14th Feb - 10
16th Feb - 4
17th Feb - 4
20th Feb - 9 
```

查询可以显示如下

```
14th Feb - 10
15th Feb - 0
16th Feb - 4
17th Feb - 4
18th Feb - 0
19th Feb - 0
20th Feb - 9 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T09:24:19.003

类似的东西（[你需要生成日期表](https://stackoverflow.com/questions/2157282/generate-days-from-date-range)）：

**[SQLFIDDLE示例](http://sqlfiddle.com/#!2/14d8c/7)**

```
select a.Date,
       COALESCE((SELECT cnt
        FROM Table1 t1
        WHERE t1.date = a.Date), 0) as COUNT
from (
    select curdate() - INTERVAL (a.a + (10 * b.a) + (100 * c.a)) DAY as Date
    from (select 0 as a union all select 1 union all select 2 union all select 3 union all select 4 union all select 5 union all select 6 union all select 7 union all select 8 union all select 9) as a
    cross join (select 0 as a union all select 1 union all select 2 union all select 3 union all select 4 union all select 5 union all select 6 union all select 7 union all select 8 union all select 9) as b
    cross join (select 0 as a union all select 1 union all select 2 union all select 3 union all select 4 union all select 5 union all select 6 union all select 7 union all select 8 union all select 9) as c
) a
where a.Date between '2013-02-01' and '2013-03-01' 
ORDER BY a.Date 
```

结果：

```
|                            DATE | COUNT |
-------------------------------------------
| February, 14 2013 00:00:00+0000 |    10 |
| February, 15 2013 00:00:00+0000 |     0 |
| February, 16 2013 00:00:00+0000 |     4 |
| February, 17 2013 00:00:00+0000 |     4 |
| February, 18 2013 00:00:00+0000 |     0 |
| February, 19 2013 00:00:00+0000 |     0 |
| February, 20 2013 00:00:00+0000 |     9 | 
```

您的查询应如下所示：

```
select DATE_FORMAT(a.Date, "%D %b") AS date,
       COALESCE((SELECT COUNT(id)
                 FROM registration
                 WHERE createdTimestamp = a.Date), 0) as COUNT
from (
    select curdate() - INTERVAL (a.a + (10 * b.a) + (100 * c.a)) DAY as Date
    from (select 0 as a union all select 1 union all select 2 union all select 3 union all select 4 union all select 5 union all select 6 union all select 7 union all select 8 union all select 9) as a
    cross join (select 0 as a union all select 1 union all select 2 union all select 3 union all select 4 union all select 5 union all select 6 union all select 7 union all select 8 union all select 9) as b
    cross join (select 0 as a union all select 1 union all select 2 union all select 3 union all select 4 union all select 5 union all select 6 union all select 7 union all select 8 union all select 9) as c
) a
where a.Date between DATE_SUB(CURDATE(), INTERVAL 7 DAY) and CURDATE()
ORDER BY a.Date 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T09:37:01.100

此查询创建一个由 7 个数字组成的序列（从 0 到 6），并使用 curdate 和序列号之间的日期差异提取您需要的数据：

```
SELECT DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL t.DAY DAY), "%D %b") AS date,
   COUNT(r.id) AS COUNT
FROM
  (SELECT 0 AS 'day'
       UNION ALL SELECT 1
   UNION ALL SELECT 2
   UNION ALL SELECT 3
   UNION ALL SELECT 4
   UNION ALL SELECT 5
   UNION ALL SELECT 6) t
LEFT OUTER JOIN registration r ON DATE_SUB(CURDATE(), INTERVAL t.DAY DAY) = r.createdTimestamp
GROUP BY t.DAY 
```

这是[sqlfiddle的链接](http://sqlfiddle.com/#!2/c8a5b/41)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T08:51:49.223

您当前的查询是不可能的。查询不能按不存在的东西分组。您需要生成缺失的数据。

选择您要选择为表格的日期列表，然后将其按日期连接到您的数据，并按生成的日期表中的数据列分组。

编辑：您可以通过这种方式生成要加入的日期表（例如 2 天）：

```
select * from (select subdate(current_date,0)) a union (select subdate(current_date,1) b); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-12T09:31:58.760

要获取日期范围，您可以获取一个整数表（从 0 到 9）并将其与自身连接以获得所需的尽可能大的数字范围，然后使用 DATE_SUB 从中获取日期范围。

然后 LEFT OUTER JOIN 与您当前的表在日期上得到每个日期的计数。

类似于以下内容：-

```
SELECT DATE_FORMAT(aDate, "%D %b") AS fmtdate, COUNT(registration.id) AS COUNT
FROM (SELECT DATE_SUB(CURDATE(), INTERVAL a.i + b.i*10 DAY) AS aDate
FROM integers a, integers b
WHERE (a.i + b.i*10) <= 7) CountRange
LEFT OUTER JOIN registration
ON aDate = DATE(FROM_UNIXTIME(createdTimestamp))
GROUP BY aDate
ORDER BY aDate 
```

（请注意，这最多可以处理 99 天 - 我对整数进行了连接只是为了演示如何扩展范围）

编辑 - 上面的代码使用 FROM_UNIXTIME，因为我假设您的时间戳存储为 unix 时间戳。如果我的假设不正确，很容易删除该函数调用

# date - 使用日期字段对 json 文件进行 Solr 索引时间提升

> ID：15966737
> 
> 赞同：0
> 
> 时间：2013-04-12T08:38:57.627
> 
> 标签：date, time, solr, indexing, solr-boost

我希望在我的 solr 搜索中匹配标题浮动到顶部的最新文档。为了速度，我希望在索引时间（而不是查询时间）完成。

我试图在索引时间使用标题和日期来提高分数（标题被提升但不是日期值？）。文档和一些堆栈流响应表明它可以完成，但怎么做？ [文档日期的 Solr 索引时间提升](https://stackoverflow.com/questions/13970187/solr-index-time-boost-on-document-date)

示例：我在一个 json 文件“datetest.json”中有 4 个文档，它们的标题相同但日期不同。

```
[{ "id": "test02",
    "title": { "boost": 1, "value": [ "test_title"] },
    "last_update":{ "boost": 2, "value": "2013-04-02T00:00:00Z"}},
{ "id": "test01",
    "title": { "boost": 1, "value": [ "test_title"] },
    "last_update":{ "boost": 2, "value": "2013-04-01T00:00:00Z"}},
{ "id": "test03",
    "title": { "boost": 1, "value": [ "test_title"] },
    "last_update":{ "boost": 2, "value": "2013-04-03T00:00:00Z"}},
{ "id": "test04",
    "title": { "boost": 1, "value": [ "test_title"] },
    "last_update":{ "boost": 2, "value": "2013-04-04T00:00:00Z"}}] 
```

datetest.json 提交使用..

> > curl ' [http://localhost.com:8983/solr/update/json?commit=true](http://localhost.com:8983/solr/update/json?commit=true) ' --data-binary @datetest.json -H 'Content-type:application/json'

查询是.. [http://localhost.com:8983/solr/collection1/select?q=test_title](http://localhost.com:8983/solr/collection1/select?q=test_title)

希望结果.. test04->test03->test02->test01

实际结果.. test02->test01->test03->test04

如何告诉 solr 在索引时间的最近日期提升？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T11:39:31.257

```
../collection1/select?q=test_title&sort=last_update desc 
```

工作正常，但这是一个查询时间提升，如果可能的话，我更喜欢索引时间提升。

# vba - 关闭打开的记录集会产生运行时错误

> ID：15966738
> 
> 赞同：4
> 
> 时间：2013-04-12T08:38:59.577
> 
> 标签：vba, excel, database-connection

我有一个在用户窗体的类模块中声明的 ADO 记录集变量。记录集在窗体的激活事件中打开，我试图在窗体的终止事件中使用如下代码关闭它：

```
Private Sub UserForm_Terminate()

If VersionIsReleased Then
    ThisWorkbook.Parent.Quit
Else

    If Not m_rs Is Nothing Then

        If m_rs.State = adStateOpen Then
            m_rs.Close
        End If

        Set m_rs = Nothing
    End If

    Close_CN g_cn
    ThisWorkbook.Application.Visible = True
End If

End Sub 
```

该行`m_rs.Close`产生运行时错误：“在此上下文中不允许操作。”。任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T15:08:29.890

如果在您尝试关闭记录集时正在编辑它，则可能会发生该错误。确保如果您使用`AddNew`或更改任何`Fields().Value`用于`Update`在关闭之前保存编辑的内容。您可以检查该`EditMode`属性以查看记录集处于什么状态。

# c# - 编码的 UI 测试 System.NullReferenceException

> ID：15966739
> 
> 赞同：1
> 
> 时间：2013-04-12T08:39:00.533
> 
> 标签：c#, visual-studio-2010, coded-ui-tests

```
public class portal
{
     public  portal()
    {
    }
     [DataSource ("Microsoft.VisualStudio.TestTools.DataSource.TestCase", "http://alm:8080/tfs/....", "15729", DataAccessMethod.Sequential), TestMethod]

     public static void portalmtm()
     {
         BrowserWindow b = BrowserWindow.Launch(new System.Uri(TestContext.DataRow["portals"].ToString()));
     }

    public static TestContext TestContext
    {
        get
        {
            return testContextInstance;
        }
        set
        {
            testContextInstance = value;
        }
    }
    private static TestContext testContextInstance;

    }
} 
```

当我在 codeduitest (testmethod) System.NullReferenceException 中使用它时会出错：对象引用未设置为对象的实例。问题是什么？我该怎么办？谢谢...

```
 [TestMethod]
    public void Test1()
    {          
        portalmtm();
        this.UIMap....
        this.UIMap....
    }
  public TestContext TestContext
    {
        get
        {
            return testContextInstance;
        }
        set
        {
            testContextInstance = value;
        }
    }
    private TestContext testContextInstance; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T15:01:47.033

类必须用`CodedUITestAttribute`属性装饰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-28T13:53:46.900

将 [TestMethod] 放在这样的方法上方，它应该可以工作。(TestMethod) 没有任何意义，你必须使用方括号。

```
 [TestMethod]
     public static void portalmtm()
     {
         //Code goes here.
     } 
```

顺便说一句，如果您要在其中放置任何自动化测试方法，我很确定它不会是静态的。

# php - 目标-c json php

> ID：15966741
> 
> 赞同：0
> 
> 时间：2013-04-12T08:39:02.440
> 
> 标签：php, objective-c, json

我正在寻找从 iPhone SDK 调用 HTTP_POST 到我服务器上的 php 文件。如果我在下面调用它：

```
 NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://*****/api2/index.php"]];

[request setHTTPMethod:@"POST"];
[request addValue:@"postValues" forHTTPHeaderField:@"METHOD"];

//create data that will be sent in the post
NSMutableDictionary *dictionary = [[NSMutableDictionary alloc] init];
[dictionary setValue:@2 forKey:@"value1"];
[dictionary setValue:@"This was sent from ios to server" forKey:@"value2"];

//serialize the dictionary data as json
NSData *data = [[dictionary copy] JSONValue];

[request setHTTPBody:data]; //set the data as the post body
[request addValue:[NSString stringWithFormat:@"%d",data.length] forHTTPHeaderField:@"Content-Length"];

NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
if(!connection){
    NSLog(@"Connection Failed");
} 
```

服务器上的php代码

```
if ($_SERVER['HTTP_METHOD'] == 'postValues'){ 
$body = $_POST; 
$id;// value1 from dictionary 
$name; // value2 from dictionary
} 
```

请帮助 $id 和 $name

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T09:16:11.200

首先，这个请求的方法是`POST`，不是`postValues`。您所做的只是添加一个带有 name和 value的*标头*，因此，如果您想检查它，您需要查看您正在使用的任何服务器与 PHP 之间的接口。对于 Apache，这是.`METHOD``postValues`[`apache_request_headers()`](http://www.php.net/apache_request_headers)

然后，如果您将 JSON 对象设置为请求的主体，那么您需要读取主体以获取它。为此，您需要阅读`php://input`. 因此，您的示例变为：

```
$body = json_decode(file_get_contents('php://input'), true);
$id = $body['value1'];// value1 from dictionary 
$name = $body['value2']; // value2 from dictionary 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:54:49.667

您可以在查询中发送额外的值（并使用 $_GET 检索）或者您可以将值放在您的 json 数据中。

此外，将 json 作为对象检索的正确方法是：

```
$bodyAsObject = json_decode( file_get_contents('php://input') ); 
```

# python - Google Drive API 导入错误

> ID：15966743
> 
> 赞同：3
> 
> 时间：2013-04-12T08:39:11.017
> 
> 标签：python, google-drive-api, pyopenssl

我正在尝试在**Google Drive API(Oauth2)**的域级别执行身份验证。为此，我参考了谷歌驱动器文档链接，如下所示：

[https://developers.google.com/drive/delegation](https://developers.google.com/drive/delegation)

我已经安装了 openssl 但也出现错误

> > ImportError：尝试导入 SignedJwtAssertionCredentials 时无法导入名称 SignedJwtAssertionCredentials。

完整的回溯如下：

错误 2013-04-16 05:03:52,006 wsgi.py:219] Traceback（最近一次调用最后一次）：文件“C:\Program Files\Google\google_appengine\google\appengine\runtime\wsgi.py”，第 196 行，在 Handle handler = _config_handle.add_wsgi_middleware(self._LoadHandler()) 文件“C:\Program Files\Google\google_appengine\google\appengine\runtime\wsgi.py”，第 255 行，在 _LoadHandler handler = **import**（路径 [0]）文件“C:\Program Files\Google\google_appengine\google\appengine\tools\dev_appserver_import_hook.py”，第 692 行，装饰返回 func（self，*args，**kwargs）文件“C： \Program Files\Google\google_appengine\google\appengine\tools\dev_appserver_import_hook.py"，第 1766 行，在 load_module 中返回 self.FindAndLoadModule(submodule, fullname, search_path) File "C:\Program Files\Google\google_appengine\google\appengine \tools\dev_appserver_import_hook.py”，第 692 行，在装饰中返回 func(self, *args, **kwargs) 文件“C:\Program Files\Google\google_appengine\google\appengine\tools\dev_appserver_import_hook.py”，第 1630 行，在 FindAndLoadModule 描述中）文件“C:\Program Files\Google\google_appengine\google\appengine\tools\dev_appserver_import_hook.py”，第 692 行，在装饰返回 func(self, *args, **kwargs) 文件“C:\Program Files\Google\google_appengine\google\appengine\tools\dev_appserver_import_hook.py”，第 1577 行，在 LoadModuleRestricted 描述中）文件“D:\API \GoogleDrive\myapp\main.py"，第 21 行，从 oauth2client.client 导入 SignedJwtAssertionCredentials ImportError：无法导入名称 SignedJwtAssertionCredentials

谁能告诉我解决方案？

# highcharts - 模拟 iPad 图表上的悬停

> ID：15966756
> 
> 赞同：1
> 
> 时间：2013-04-12T08:39:46.607
> 
> 标签：highcharts

我的客户想在图表上拖动手指，无需点击即可获得工具提示。该应用程序基于 EnyoJS 构建，当手指在其上方移动时，它向 dom 元素发送“移动”事件，并在手指进入和离开元素时发送“进入”/“离开”事件。我有两个问题：

1.  是否有在 Highcharts 3 中启用此功能的配置选项？
2.  如果不是，我如何将自定义事件侦听器附加到该点（或图表但在处理程序中获取点）？

谢谢，马克斯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T12:12:36.690

根据更改日志版本 3.0.1 ( [http://www.highcharts.com/documentation/changelog](http://www.highcharts.com/documentation/changelog) )，您应该可以使用 tooltip.followTouchMove 属性执行此操作：

编辑： [http ://api.highcharts.com/highcharts#tooltip.followTouchMove](http://api.highcharts.com/highcharts#tooltip.followTouchMove)

# c# - NAudio - 从 Stream 播放 MIDI

> ID：15966759
> 
> 赞同：1
> 
> 时间：2013-04-12T08:40:14.780
> 
> 标签：c#, playback, midi, naudio

我正在制作游戏并使用 NAudio 播放声音。我想在后台播放 MIDI 文件以进行音乐循环。在文档中搜索它，一无所获。

如何从流中播放 MIDI 文件？

并循环它？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-01-30T17:23:54.997

[您可以使用DryWetMIDI](https://github.com/melanchall/drywetmidi)轻松完成：

```
using Melanchall.DryWetMidi.Devices;
using Melanchall.DryWetMidi.Core;

// ...

var midiFile = MidiFile.Read("Background music.mid");
// or from stream:
// var midiFile = MidiFile.Read(stream);

var outputDevice = OutputDevice.GetByName("MIDI device to play with");
var playback = midiFile.GetPlayback(outputDevice);

playback.Loop = true;
playback.Start(); 
```

在库文档的[播放](https://melanchall.github.io/drywetmidi/articles/playback/Overview.html)文章中阅读有关播放的更多信息。

# mysql - 由 IonAuth 和 $query->num_rows() 引起的 CodeIgniter 系统问题

> ID：15966764
> 
> 赞同：0
> 
> 时间：2013-04-12T08:40:27.483
> 
> 标签：mysql, codeigniter, ion-auth

请原谅我发布的未`code`格式化的代码。有时无法让四个空间工作。

你好。寻找有关 CodeIgniter 中 num_rows() 函数引起的此错误的一些见解。

```
Fatal error: Call to undefined method CI_DB_mysql_driver::num_rows() in [my controller] 
```

它似乎以某种方式植根于此……可能：

```
A PHP Error was encountered
Severity: 4096

Message: Object of class CI_DB_mysql_driver could not be converted to string

Filename: database/DB_active_rec.php

Line Number: 427 
```

第 427 行显示： $v = ' '.$this->escape($v);

并且来自函数：protected function _where($key, $value = NULL, $type = 'AND ', $escape = NULL)

我正在使用 CodeIgniter 和 IonAuth，当我调用此函数时，问题似乎来自 num_rows()： public function login($identity, $password, $remember=FALSE) { $this->trigger_events('pre_login') ;

```
 if (empty($identity) || empty($password))
    {
        $this->set_error('login_unsuccessful');
        return FALSE;
    }

    $this->trigger_events('extra_where');

    $query = $this->db->select($this->identity_column . ', username, email, id, password, active, last_login')
                      ->where($this->identity_column, $this->db->escape_str($identity))
                      ->limit(1);

    echo $query;

    if ($query->num_rows() === 1)
    {
        $user = $query->row();

        $password = $this->hash_password_db($user->id, $password);

        if ($password === TRUE)
        {
            if ($user->active == 0)
            {
                $this->trigger_events('post_login_unsuccessful');
                $this->set_error('login_unsuccessful_not_active');

                return FALSE;
            }

            $session_data = array(
                'identity'             => $user->{$this->identity_column},
                'username'             => $user->username,
                'email'                => $user->email,
                'user_id'              => $user->id, //everyone likes to overwrite id so we'll use user_id
                'old_last_login'       => $user->last_login
            );

            $this->update_last_login($user->id);

            $this->clear_login_attempts($identity);

            $this->session->set_userdata($session_data);

            if ($remember && $this->config->item('remember_users', 'ion_auth'))
            {
                $this->remember_user($user->id);
            }

            $this->trigger_events(array('post_login', 'post_login_successful'));
            $this->set_message('login_successful');

            return TRUE;
        }
    }

    //Hash something anyway, just to take up time
    $this->hash_password($password);

    $this->increase_login_attempts($identity);

    $this->trigger_events('post_login_unsuccessful');
    $this->set_error('login_unsuccessful');

    return FALSE;
} 
```

我想知道他们在那里使用的查询是否有问题。CI_DB_mysql_driver 上的任何线索都会有所帮助......

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:44:33.690

Change your query code to this:

```
 $this->db->select($this->identity_column . ', username, email, id, password, active, last_login')
                  ->where($this->identity_column, $this->db->escape_str($identity))
                  ->limit(1);
 $query = $this->db->get('YOUR_TABLE_NAME'); 
```

The error was because you did not execute the query but you just generated the SQL code for it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:57:00.877

您已经更改了一些用于测试的内容 - 这不是来自实际来源：

```
 $query = $this->db->select($this->identity_column . ', username, email, id, password, active, last_login')
                  ->where($this->identity_column, $this->db->escape_str($identity))
                  ->limit(1);

echo $query; 
```

从 github 再次拉/下载

# android - SQLiteOpenHelper 在第一次执行时崩溃

> ID：15966768
> 
> 赞同：1
> 
> 时间：2013-04-12T08:40:33.220
> 
> 标签：android, sqlite

当我第一次执行应用程序时，我的 DbHelper 会创建数据库。但是，当我稍后尝试打开数据库时（在同一个应用程序执行期间，在另一个活动中），由于 checkDatabase() 返回 false，因此再次创建数据库，当然，这会产生异常，因为表存在。当我第一次创建数据库时，我打开它并关闭它，所以我猜问题是文件没有刷新（这是第二次 checkDatabase() 返回 false 的唯一原因）。

重要的是，这只发生在第一次执行期间。在“不幸的是，已停止”消息后，数据库访问工作正常。任何想法？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:51:29.730

您可以参考以下代码了解何时创建新数据库，检查现有数据库

```
public class DataBaseHelper extends SQLiteOpenHelper {

private static String DB_PATH;
private static String DB_NAME = "podcastDB.db";
private SQLiteDatabase myDataBase;
private final Context myContext;
SharedPreferences sharedPreferences;

public DataBaseHelper(Context context) {

    super(context, DB_NAME, null, 1);
    this.myContext = context;
    DB_PATH = "/data/data/" + myContext.getPackageName() + "/databases/";

    sharedPreferences = PreferenceManager
            .getDefaultSharedPreferences(myContext);
}

/**
 * Creates a empty database on the system and rewrites it with your own
 * database.
 * */
public void createDataBase() throws IOException {

    // ---Check whether database is already created or not---
    boolean dbExist = checkDataBase();

    if (dbExist) {
    } else {
        this.getReadableDatabase();
        try {
            // ---If not created then copy the database---
            copyDataBase();
        } catch (IOException e) {
            throw new Error("Error copying database");
        }
    }

}

/**
 * Check if the database already exist to avoid re-copying the file each
 * time you open the application.
 * 
 * @return true if it exists, false if it doesn't
 */
private boolean checkDataBase() {
    try {
        String myPath = DB_PATH + DB_NAME;
        File f = new File(myPath);
        if (f.exists())
            return true;
        else
            return false;
    } catch (SQLiteException e) {
        Log.e("Podcast", "There was an error", e);
        return false;
    }
}

/**
 * Copies your database from your local assets-folder to the just created
 * empty database in the system folder, from where it can be accessed and
 * handled. This is done by transfering bytestream.
 * */
private void copyDataBase() throws IOException {

    InputStream myInput = myContext.getAssets().open(DB_NAME);

    String outFileName = DB_PATH + DB_NAME;

    OutputStream myOutput = new FileOutputStream(outFileName);

    byte[] buffer = new byte[1024];
    int length;
    while ((length = myInput.read(buffer)) > 0) {
        myOutput.write(buffer, 0, length);
    }

    myOutput.flush();
    myOutput.close();
    myInput.close();
}

public void openDataBase() throws SQLException {

    // --- Open the database---
    String myPath = DB_PATH + DB_NAME;
    myDataBase = SQLiteDatabase.openDatabase(myPath, null,
            SQLiteDatabase.OPEN_READWRITE);

}

@Override
public synchronized void close() {

    if (myDataBase != null)
        myDataBase.close();

    super.close();

}

@Override
public void onCreate(SQLiteDatabase db) {

}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

}
} 
```

# couchbase - 如何删除存储桶中的所有项目？

> ID：15966769
> 
> 赞同：4
> 
> 时间：2013-04-12T08:40:33.553
> 
> 标签：couchbase

我想知道如何删除 Couchbase 存储桶中的所有项目。我正在使用java客户端。

我试过运行`client.flush()`方法。在存储桶上启用了刷新。但它抛出异常：

```
Exception in thread "Temporary Flusher" java.lang.RuntimeException: Http Error: 401 Reason: Unauthorized Details: No reason given 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T11:56:38.327

CouchBase Server 2.0 中有一个错误。使用`ClusterManager class`管理员凭据

[在这里找到](http://www.couchbase.com/forums/thread/flush-gui-works-not-spy-memcached)

# mysql - 谁能教我连接表的 SQL

> ID：15966773
> 
> 赞同：-2
> 
> 时间：2013-04-12T08:40:41.620
> 
> 标签：mysql, sql, join

我有以下表格：

```
表 1 表 2
id q_id 内容id | w_id | q_id | c_id | 排行
---------------------- ---------------------------- --------------------
95 2046 1=E 123 | 22404 | 2046 | 100 | 1

96 2046 2=G 124 | 22404 | 2046 | 101 | 2

97 2046 3=N 125 | 22404 | 2046 | 102 | 2

98 2046 4=B 126 | 22404 | 2046 | 103 | 2

99 2046 5=V 127 | 22404 | 2046 | 104 | 3

100 2046 A1 128 | 22404 | 2046 | 105 | 3

101 2046 A2 129 | 22405 | 2046 | 100 | 4

102 2046 A3 130 | 22405 | 2046 | 101 | 4

103 2046 A4 131 | 22405 | 2046 | 102 | 1

104 2046 A5 132 | 22405 | 2046 | 103 | 2

105 2046 A6 133 | 22405 | 2046 | 104 | 2

                                    134 | 22405 | 2046 | 105 | 3

```

我需要编写一个 SQL，这样我才能得到以下结果：

```
w_id  | q_id  | A1  | A2  | A3  | A4  | A5  | A6 
--------------------------------------------------- 
22404 | 2046  |  1  |  2  |  2  |  2  |  3  |  3  
22405 | 2046  |  4  |  4  |  1  |  2  |  2  |  3 
```

谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:49:43.977

无需加入这些表。

你可能需要这样的东西：

```
SELECT w_id as W , q_id, 
(select ranking from table2 where w_id = W and c_id = 100) as 100,
(select ranking from table2 where w_id = W and c_id = 101) as 101,
(select ranking from table2 where w_id = W and c_id = 102) as 102,
(select ranking from table2 where w_id = W and c_id = 103) as 103,
(select ranking from table2 where w_id = W and c_id = 104) as 104,
(select ranking from table2 where w_id = W and c_id = 105) as 105
FROM table2; 
```

# javascript - 设置后第一次未找到 Cookie

> ID：15966774
> 
> 赞同：0
> 
> 时间：2013-04-12T08:40:41.800
> 
> 标签：javascript, cookies

在我的本地主机上，我有几页。第一个页面设置了一个cookie来保存一些数据。所有页面都读取 cookie 并显示数据。一切都在 Chrome 和 IE7 中完美运行。我的远程主机上的文件是本地主机上的文件的副本，因此它们完全相同。但是，如果我访问远程主机上的页面，在 Chrome 中找不到 cookie，但在重新加载页面或访问另一个页面后，cookie 正常找到并且数据正确显示。因此，每次JavaScript在上一页设置cookie后直接尝试查找cookie时，都找不到，但在所有下一次都没有问题。如果我使用 IE7 访问远程主机上的页面，则根本找不到 cookie，尽管它似乎设置正确。

谁能解释 localhost 和远程主机之间以及 IE7 和 Chrome 之间的这种行为差异？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:00:21.137

问题解决了。getCookie 函数出现故障，因此只能找到第一个 cookie。由于总是只有一个 cookie 集，因此这个问题从未出现过。添加用于 Google Analytics 的脚本后，设置了更多 cookie，但在 localhost 上并非如此。这解释了本地主机和远程主机之间的行为差​​异。接下来要解释的是，在重新加载未设置它们的页面后，如何在 Chrome 中仍然可以找到 cookie。可能 Chrome 将已经存在的 cookie 放在列表中，而 IE 没有。

# java - GWT RPC AsynCallback 跳过 onSucces 和 onFail 方法

> ID：15966781
> 
> 赞同：1
> 
> 时间：2013-04-12T08:40:58.397
> 
> 标签：java, gwt, asynchronous, callback, rpc

我尝试编写 GWT 应用程序，我需要使用 RPC 从服务器端获取结果。我遵循了 GWT RPC 教程并最终得到了一些商品。但是当我调试我的程序时，我看到我的程序跳过了onFailure和onSuccess方法，所以我得到了nullpointerexception。这是我实现的必要部分。

```
IRecordServiceAsync recordSvc = GWT.create(IRecordService.class);
private class RecordCallBack implements AsyncCallback<Records> {
    public void onFailure(Throwable caught) {
        // TODO Auto-generated method stub
    }

    public void onSuccess(Records result) {
        records = result.getRecords();
    }

}
public void onModuleLoad() {
setFileGridData(getRecords());
.
.
.
}
public HashMap getRecords() {
    recordSvc.getRecords(recordclass, new RecordCallBack());
    return this.records;
} 
```

正如我所说，我的程序跳过了 onFailure 和 onSuccess 部分，因此我的记录值变为空。

感谢帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:53:36.497

你必须*异步*思考。该方法`getRecords()`首先对您的服务进行*异步*调用，然后立即返回该`records`字段，该字段将始终为空（假设到目前为止从未修改过）。

您必须*等待*响应返回（由`onSuccess`/处理`onFailure`）。而且，一般来说，永远不要使用依赖异步调用的 getter，而是将您的应用程序设计`wait`为响应/事件。

在您的情况下，只需将异步调用放入`onModuleLoad()`and only inside `onSuccess()`，使用 the `setFileGridData(result.getRecords())`，完全避免使用 getter。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:46:42.643

您正在创建新的 RecordCallBack。因此将在新实例上调用 onFailure 和 onSuccess。您可以尝试以下操作，而不是这样做

```
public void getRecords() {
    recordSvc.getRecords(recordclass, this);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T09:53:35.810

在所有的解释之后

你的代码应该喜欢

```
onModuleLoad(){
  recordSvc.getRecords(new RecordCallBack<Records>(){

 public void onFailure(Throwable caught) {
        // TODO Auto-generated method stub
    }

    public void onSuccess(Records result) {
        records = result.getRecords();
        setFileGridData(records);
    }

});

} 
```

# java - BurrowsWheeler 变换 (BWT) 的最佳排序算法

> ID：15966785
> 
> 赞同：3
> 
> 时间：2013-04-12T08:41:07.613
> 
> 标签：java, algorithm

我在 Burrows Wheeler Transformation 上遇到了一些问题。这是一个大学项目，但这只是其中很小的一部分。整个项目由 3 种不同的算法组成，用于数据压缩。

我只是想弄清楚在 Burrows Wheeler 转换中用于后缀排序的内存和时间效率最高的排序算法是什么？编码需要尽可能高效。

对于较小的数组，排序不会真正影响它，但是当我们压缩的文本文件变得越来越大时，使用低效的排序算法所消耗的时间确实会破坏时间和内存效率。

任何帮助将不胜感激，在此先感谢！

**编辑**

顺便说一句，我们用 Java 编码，只是意识到我从未提到过。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T10:41:17.650

许多实用的基于 BWT 的压缩工具都基于**DivSufSort**和**MSufSort**。但是它们的性能最差 O(n^2)，您必须在排序之前对数据使用一些预处理方法。

为了获得理论上的最佳时间/空间成本，请尝试**sa-is**和**sa-ds**。

如果你想自己写一个后缀排序算法，我建议你从快速简单的**QSufSort**开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-04T06:17:42.610

正如richselian 所提到的，排序是二次的，而基于后缀数组的算法是线性的。如果您的阵列很小，那没关系，但更大的阵列会产生更好的压缩结果。您可以在这里找到基于后缀数组的 BWT 的完整 java 实现作为示例：[https](https://code.google.com/p/kanzi/source/browse/java/src/kanzi/transform/BWT.java) ://code.google.com/p/kanzi/source/browse/java/src/kanzi/transform/BWT.java （数组高达 16MB）。至于“java很慢”的论点，我会恭敬地不同意。

# java - Stardog 数据库创建给文件未找到异常

> ID：15966789
> 
> 赞同：0
> 
> 时间：2013-04-12T08:41:13.900
> 
> 标签：java, rdf, stardog

我正在使用 java 在stardog 中创建一个新数据库。

当我创建数据库并在 localhost 中导入 RDF 文件时，它的工作。

但是当我在远程服务器中创建数据库时，我得到一个文件未找到同一个 RDF 文件的异常。

请看一下我的代码

```
 System.out.println("start updating db");
    String myDBName = "myDB" ;

    StardogDBMS dbms =
            //StardogDBMS.toServer("snarl://localhost:5820/")
            StardogDBMS.toServer("snarl://myRemoteServer:5820/")
            .credentials("admin", "admin".toCharArray()).login();

    File file = new File("src\\main\\webapp\\test.rdf"))

    System.out.println("creating " + myDBName +" and loading the rdf file" );

    dbms.disk(myDBName).create(file));
    dbms.logout();
    System.out.println("created " + myDBName +" and loaded the rdf file" ); 
```

请帮忙。是否有任何周转，例如将流传递到数据库以导入 RDF 文件。这是我得到的例外。

```
start updating db
creating myDB and loading the rdf file      
File: xxx\xxxx\test.RDF Message: java.io.FileNotFoundException: xxx\xxxx\test.RDF (No such file or directory)
created myDB and loaded the rdf file 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T13:26:49.227

该错误消息表明磁盘数据库的批量加载程序找不到指定的文件。使用 SNARL 协议时，文件不会从客户端传输到服务器进行批量加载，这可能是错误的根源。

如果服务器和客户端都在同一台机器上运行，则服务器读取时您的相对路径可能不正确，该路径将相对于 STARDOG_HOME，并且在这种情况下可能不正确。因此，如果它们都在同一台机器上，请使用绝对路径，它应该可以工作。如果它们位于不同的机器上，请从 CLI 批量加载到带有服务器的机器上。

如果您想使用 HTTP，将传输文件，但由于将文件发送到服务器的网络开销，您将获得较差的批量加载性能。同样，您最好使用服务器在机器上进行批量加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T09:45:35.033

我猜迈克尔回答的是异常的原因。我找到了解决这个问题的方法。

而不是创建数据库和批量加载 RDF/OWL 文件。创建与 stardog 数据库的连接。并通过连接导入 RDF 文件。

示例代码如下

```
System.out.println("start updating db");
String myDBName = "myDB" ;

StardogDBMS dbms =
        //StardogDBMS.toServer("snarl://localhost:5820/")
        StardogDBMS.toServer("snarl://myRemoteServer:5820/")
        .credentials("admin", "admin".toCharArray()).login();

File file = new File("src\\main\\webapp\\test.rdf"))

System.out.println("creating " + myDBName);

dbms.disk(myDBName).create());
dbms.logout();

aConn = ConnectionConfiguration.to(myDBName) // the name of the db to connect to
            .credentials("admin", "admin") // the credentials with which to connect
            .url("snarl://myRemoteServer:5820/")
            .connect(); // now open the connection

    System.out.println("importing files to "+myDBName);
    aConn.begin();
    aConn.add().io().format(RDFFormat.RDFXML).stream(file);     
    aConn.commit();
    System.out.println("files imported to "+myDBName);

    System.out.println("DB Updated"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T12:22:57.337

不知道`dbms.disk(myDBName).create(file));`在做什么很难说，但是您确定它不是在尝试读取`src\\main\\webapp\\test.rdf`本地存在但不在远程服务器上的文件吗？

# c++ - 如何在没有动态内存分配的情况下创建对象数组

> ID：15966801
> 
> 赞同：1
> 
> 时间：2013-04-12T08:41:45.717
> 
> 标签：c++, class, dynamic

我得到了以下代码，其中循环创建了 100 个对象。

我的问题是，

*   为什么我需要在`new`这里使用，因为我事先已经知道我需要多少内存。
*   是否有与我的示例代码相同但没有动态内存分配的代码？（并且不使用 std 容器，例如`vector`）（...class + dynamic momery 一起变得令人困惑）

示例代码：

```
class Particle {...};
Particle *myParticles[ 100 ];

for( int i = 0; i < 100; i++ )
{   
    myParticles[ i ] = new Particle(x,y);          //x and y are randomized for each loop
} 
```

**[更新]：** `class Particle`没有默认构造函数。因此`Particle myParticles[ 100 ];`将不起作用。请注意，可以通过设置默认构造函数，然后创建方法来解决此问题`Particle::setXY (double x, double y)`。

但是有没有办法在不创建新方法的情况下解决这个问题？即只使用构造函数，没有动态内存分配。

我只是觉得奇怪，如果没有动态内存分配，这是无法完成的（？）。还是我必须接受这只是 C++ 语言的一个怪癖的事实？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T09:05:44.813

您不必使用`new`. `Particle`您可以按照自己的建议创建一个 s 数组：

```
Particle myParticles[100]; 
```

问题是，它将是默认构造的，因为您无法指定`(x,y)`仅在运行时可用的参数。因此，您必须提供在构建 a 之后指定此信息的方法`Particle`，例如：

```
for( int i = 0; i < 100; i++ )
{   
    myParticles[i].SetCoords(x,y);          //x and y are randomized for each loop
} 
```

这需要默认构造函数和在构造后配置实例`Particle`的方法。因此，如果代码超出您的控制范围`SetCoords`，它可能不是一个选项。`Particle`

但我真的会考虑使用`vector`，因为它是一个非常方便和有用的东西。如果编程正确，它将非常有效，因为它使用很少数量的动态分配。例如：

```
vector<Particle> myParticles;

myParticles.reserve(100);
for( int i = 0; i < 100; i++ )
{   
    myParticles.push_back(Particle(x,y));          //x and y are randomized for each loop
} 
```

这应该只使用一个分配。这假设它`Particle`是相当轻量级的，可以被复制构造函数复制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T09:04:15.080

```
Particle myParticles[ 100 ]; 
```

将使用默认构造函数 100 次而不是`Particle(x,y)`

因此，真正的问题是您无法将参数传递给数组中的构造函数。

**如果`Particle`没有默认构造函数 `Particle myParticles[ 100 ];`将不会编译**

我们需要更多信息。可能是粒子很大，但我们想对数组进行排序。拥有一个指针数组，您可以交换它，这可能比交换粒子快得多。粒子交换的实现绝非易事。最后，您可以通过复制这些指针来传递调用其他函数的数组……这很复杂。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T09:00:04.110

> **为什么我需要在这里使用 new ，因为我事先已经知道我需要多少内存？**

原因可能是这段代码存在于一个函数中。创建函数本地的数组并返回指向它的指针/引用将导致未定义的行为。所以也许原因是**显式管理创建的数组元素的生命周期**。除非您显示更多代码，否则无法准确判断。

> **是否有与我的示例代码相同但没有动态内存分配的代码？**

一般来说，如果可以选择，

```
Particle myParticle[100]; 
```

比使用动态内存分配更好，更不容易出错。

**好读：**
[为什么 C++ 程序员应该尽量减少“新”的使用？](https://stackoverflow.com/questions/6500313/why-should-new-be-used-as-little-as-possible)

`new`请注意，虽然尽可能地限制使用是好的，但存在的目的`new`是因为它在某些更适合所需行为的情况下是必需的。所以它更像是一匹马。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T12:09:21.070

作为一名 C 程序员，我会这样做：

```
char particle_space[sizeof(Particle) * 100];
Particle *myParticles = (Particle *) particle_space; 
```

然后按以下方式填写：

```
for (int i = 0; i < 100; i++)
    myParticles[i] = Particle(i, i); 
```

我不知道`sizeof`在声明中使用是否是可移植的，或者它是否是 gcc 的扩展，但这对我有用。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-12T09:00:53.337

```
Particle *myParticles[ 100 ]; 
```

是粒子指针数组，而不是粒子。而 myParticles 类型是 Particle** 而不仅仅是 Particle*，这就是您需要分配内存的原因。

```
Particle myParticles[ 100 ]; 
```

确实会创建一个粒子数组，并且不需要内存分配。

# html - HTML4.01 中的 DTD

> ID：15966810
> 
> 赞同：0
> 
> 时间：2013-04-12T08:42:47.523
> 
> 标签：html

DTD（文档类型定义）的目的是定义 XML 文档的合法构建块。那么为什么它在 HTML 4.01 中用作 Doctype 呢？

那么 HTML5 如果不使用 dtd 那么我们如何验证 HTML5 文档呢？我们必须在这里编写自定义 DTD 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T09:02:46.693

> DTD（文档类型定义）的目的是定义 XML 文档的合法构建块。

SGML 文件也是如此。

> 那么为什么它在 HTML 4.01 中用作 Doctype 呢？

因为 HTML 4 是一个 SGML 应用程序，它利用了预先存在的工作来使 SGML 变得有用。

> 那么 HTML5 呢？

HTML 5 的作者决定，由于浏览器供应商都实现了标记汤解析器而不是 SGML 解析器，因此 HTML 5 不会是 SGML 应用程序。

> 如果它不使用 dtd 那么我们如何验证 HTML5 文档。

要验证 HTML 5 文档，您需要使用 HTML 5 验证器而不是一般的 SGML 验证器。

# javascript - 无需 cookie 或本地存储的用户识别

> ID：15966812
> 
> 赞同：141
> 
> 时间：2013-04-12T08:42:53.843
> 
> 标签：javascript, php, http-headers, fingerprinting

我正在构建一个分析工具，我目前可以从他们的用户代理获取用户的 IP 地址、浏览器和操作系统。

我想知道是否有可能在不使用 cookie 或本地存储的情况下检测到同一个用户？我不希望这里有代码示例；只是一个简单的提示，可以进一步了解。

忘了提到如果它是同一台计算机/设备，它需要跨浏览器兼容。基本上我是在设备识别之后，而不是真正的用户。

* * *

## 回答 #1

> 赞同：411
> 
> 时间：2013-04-20T13:38:12.253

**介绍**

如果我理解正确，您需要识别一个您没有唯一标识符的用户，因此您想通过匹配随机数据来确定他们是谁。您不能可靠地存储用户的身份，因为：

*   Cookies 可以删除
*   IP地址可以改变
*   浏览器可以改变
*   浏览器缓存可能被删除

Java Applet 或 Com 对象本来是使用硬件信息散列的简单解决方案，但现在人们非常注重安全性，很难让人们在他们的系统上安装这类程序。这使您无法使用 Cookie 和其他类似工具。

**Cookie 和其他类似工具**

您可能会考虑构建数据配置文件，然后使用概率测试来识别*可能的用户*。可以通过以下某种组合生成对此有用的配置文件：

1.  IP地址
    *   真实 IP 地址
    *   代理IP地址（用户经常重复使用同一个代理）
2.  饼干
    *   HTTP Cookie
    *   会话 Cookie
    *   第三方饼干
    *   Flash Cookies（[大多数人不知道如何删除这些](http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager07.html)）
3.  网络错误（不太可靠，因为错误得到修复，但仍然有用）
    *   PDF错误
    *   闪虫
    *   Java 错误
4.  浏览器
    *   点击跟踪（很多用户每次访问都访问同一系列的页面）
    *   浏览器指纹 - 已安装的插件（人们通常有不同的、有些独特的插件集）
    *   缓存的图像（人们有时会删除他们的 cookie，但会留下缓存的图像）
    *   使用 Blob
    *   URL（浏览器历史记录或 cookie 可能在 URL 中包含唯一的用户 ID，例如[https://stackoverflow.com/users/1226894](https://stackoverflow.com/users/1226894)或[http://www.facebook.com/barackobama?fref=ts](http://www.facebook.com/barackobama?fref=ts)）
    *   [系统字体检测](https://www.browserleaks.com/fonts)（这是一个鲜为人知但通常是唯一的键签名）
5.  HTML5 和 Javascript
    *   [HTML5 本地存储](https://developer.mozilla.org/en-US/docs/DOM/Storage)
    *   HTML5 Geolocation API 和反向地理编码
    *   架构、操作系统语言、系统时间、屏幕分辨率等。
    *   网络信息接口
    *   电池状态 API

当然，我列出的项目只是可以唯一标识用户的几种可能方式。还有很多。

**使用这组随机数据元素来构建数据配置文件，下一步是什么？**

下一步是开发一些[模糊逻辑](http://en.wikipedia.org/wiki/Fuzzy_logic)，或者更好的是[人工神经网络](http://en.wikipedia.org/wiki/Artificial_neural_network)（使用模糊逻辑）。无论哪种情况，想法都是训练您的系统，然后将其训练与[贝叶斯推理](http://en.wikipedia.org/wiki/Bayesian_inference)相结合，以提高结果的准确性。

![人工神经网络](https://i.stack.imgur.com/c79lN.png)

PHP的[NeuralMesh](http://sourceforge.net/projects/neuralmesh/)库允许您生成人工神经网络。要实现贝叶斯推理，请查看以下链接：

*   [使用 PHP 实现贝叶斯推理，第 1 部分](http://www.ibm.com/developerworks/opensource/library/wa-bayes1/)
*   [使用 PHP 实现贝叶斯推理，第 2 部分](http://www.ibm.com/developerworks/web/library/wa-bayes2/)
*   [使用 PHP 实现贝叶斯推理，第 3 部分](http://www.ibm.com/developerworks/web/library/wa-bayes3/)

这时候，你可能会想：

**为什么一个看似简单的任务需要这么多数学和逻辑？**

基本上，因为它*不是一个简单的任务*。实际上，您要实现的是*纯概率*。例如，给定以下已知用户：

```
User1 = A + B + C + D + G + K
User2 = C + D + I + J + K + F 
```

当您收到以下数据时：

```
B + C + E + G + F + K 
```

您本质上要问的问题是：

接收到的数据（B + C + E + G + F + K）实际上是User1还是User2的概率是多少？这两场比赛中哪一场*最*有可能？

为了有效地回答这个问题，您需要了解[频率与概率格式](http://www.ibm.com/developerworks/opensource/library/wa-bayes1/#4)以及为什么[联合概率](http://www.ibm.com/developerworks/opensource/library/wa-bayes1/#5)可能是更好的方法。细节太多了，无法进入这里（这就是我给你链接的原因），但一个很好的例子是[医学诊断向导应用程序](http://www.ibm.com/developerworks/opensource/library/wa-bayes1/#8)，它使用症状的组合来识别可能的疾病。

考虑一下包含您的数据配置文件（上例中的 B + C + E + G + F + K）的一系列数据点作为*症状*，以及未知用户作为*疾病*。通过识别疾病，您可以进一步识别适当的治疗方法（将此用户视为 User1）。

显然，我们已经识别出超过 1 个*症状的**疾病*更容易识别。事实上，我们可以识别的*症状*越多，我们的诊断几乎肯定会越容易和准确。

 ****还有其他选择吗？**

当然。作为替代措施，您可以创建自己的简单评分算法，并将其基于精确匹配。这不如概率有效，但可能更容易实现。

例如，考虑这个简单的分数图表：

```
+-------------+--------+------------+
| 物业 | 重量 | 重要性 |
+-------------+--------+------------+
| 真实IP地址 | 60 | 5 |
| 使用的代理 IP 地址 | 40 | 4 |
| HTTP Cookie | 80 | 8 |
| 会话 Cookie | 80 | 6 |
| 第三方饼干 | 60 | 4 |
| 快闪饼干 | 90 | 7 |
| PDF 错误 | 20 | 1 |
| 闪存错误 | 20 | 1 |
| Java 错误 | 20 | 1 |
| 频繁页面 | 40 | 1 |
| 浏览器指纹 | 35 | 2 |
| 已安装的插件 | 25 | 1 |
| 缓存图像 | 40 | 3 |
| 网址 | 60 | 4 |
| 系统字体检测 | 70 | 4 |
| 本地存储 | 90 | 8 |
| 地理位置 | 70 | 6 |
| 奥尔特 | 70 | 4 |
| 网络信息API | 40 | 3 |
| 电池状态 API | 20 | 1 |
+-------------+--------+------------+

```

对于您可以根据给定请求收集的每条信息，授予相关分数，然后在分数相同时使用*重要性*解决冲突。

**概念证明**

如需简单的概念证明，请查看[Perceptron](http://en.wikipedia.org/wiki/Perceptron)。感知器是一种[RNA 模型](http://en.wikipedia.org/wiki/RNA_world_hypothesis)，通常用于模式识别应用程序。甚至还有一个旧的[PHP 类](http://www.phpclasses.org/package/1702-PHP-Perceptron-implementation-for-pattern-recognition.html)可以完美地实现它，但您可能需要根据您的目的对其进行修改。

尽管是一个很棒的工具，Perceptron 仍然可以返回多个结果（可能的匹配项），因此使用分数和差异比较仍然有助于确定这些匹配项中的*最佳值。*

**假设**

*   存储有关每个用户的所有可能信息（IP、cookie 等）
*   如果结果完全匹配，则将分数增加 1
*   如果结果不完全匹配，则将分数减 1

**期待**

1.  生成 RNA 标签
2.  生成模拟数据库的随机用户
3.  生成单个未知用户
4.  生成未知用户 RNA 和值
5.  系统将合并 RNA 信息并教导感知器
6.  训练感知器后，系统会有一组权重
7.  您现在可以测试未知用户的模式，感知器将生成一个结果集。
8.  存储所有正匹配
9.  首先按分数对匹配项进行排序，然后按差异对匹配项进行排序（如上所述）
10.  输出两个最接近的匹配，或者，如果没有找到匹配，则输出空结果

**概念验证代码**

```
$features = array(
    'Real IP address' => .5,
    'Used proxy IP address' => .4,
    'HTTP Cookies' => .9,
    'Session Cookies' => .6,
    '3rd Party Cookies' => .6,
    'Flash Cookies' => .7,
    'PDF Bug' => .2,
    'Flash Bug' => .2,
    'Java Bug' => .2,
    'Frequent Pages' => .3,
    'Browsers Finger Print' => .3,
    'Installed Plugins' => .2,
    'URL' => .5,
    'Cached PNG' => .4,
    'System Fonts Detection' => .6,
    'Localstorage' => .8,
    'Geolocation' => .6,
    'AOLTR' => .4,
    'Network Information API' => .3,
    'Battery Status API' => .2
);

// Get RNA Lables
$labels = array();
$n = 1;
foreach ($features as $k => $v) {
    $labels[$k] = "x" . $n;
    $n ++;
}

// Create Users
$users = array();
for($i = 0, $name = "A"; $i < 5; $i ++, $name ++) {
    $users[] = new Profile($name, $features);
}

// Generate Unknown User
$unknown = new Profile("Unknown", $features);

// Generate Unknown RNA
$unknownRNA = array(
    0 => array("o" => 1),
    1 => array("o" => - 1)
);

// Create RNA Values
foreach ($unknown->data as $item => $point) {
    $unknownRNA[0][$labels[$item]] = $point;
    $unknownRNA[1][$labels[$item]] = (- 1 * $point);
}

// Start Perception Class
$perceptron = new Perceptron();

// Train Results
$trainResult = $perceptron->train($unknownRNA, 1, 1);

// Find matches
foreach ($users as $name => &$profile) {
    // Use shorter labels
    $data = array_combine($labels, $profile->data);
    if ($perceptron->testCase($data, $trainResult) == true) {
        $score = $diff = 0;

        // Determing the score and diffrennce
        foreach ($unknown->data as $item => $found) {
            if ($unknown->data[$item] === $profile->data[$item]) {
                if ($profile->data[$item] > 0) {
                    $score += $features[$item];
                } else {
                    $diff += $features[$item];
                }
            }
        }
        // Ser score and diff
        $profile->setScore($score, $diff);
        $matchs[] = $profile;
    }
}

// Sort bases on score and Output
if (count($matchs) > 1) {
    usort($matchs, function ($a, $b) {
        // If score is the same use diffrence
        if ($a->score == $b->score) {
            // Lower the diffrence the better
            return $a->diff == $b->diff ? 0 : ($a->diff > $b->diff ? 1 : - 1);
        }
        // The higher the score the better
        return $a->score > $b->score ? - 1 : 1;
    });

    echo "<br />Possible Match ", implode(",", array_slice(array_map(function ($v) {
        return sprintf(" %s (%0.4f|%0.4f) ", $v->name, $v->score,$v->diff);
    }, $matchs), 0, 2));
} else {
    echo "<br />No match Found ";
} 
```

[**输出：**](http://codepad.viper-7.com/tZArzd)

```
Possible Match D (0.7416|0.16853),C (0.5393|0.2809) 
```

**“D”的打印_r：**

```
echo "<pre>";
print_r($matchs[0]);

Profile Object(
    [name] => D
    [data] => Array (
        [Real IP address] => -1
        [Used proxy IP address] => -1
        [HTTP Cookies] => 1
        [Session Cookies] => 1
        [3rd Party Cookies] => 1
        [Flash Cookies] => 1
        [PDF Bug] => 1
        [Flash Bug] => 1
        [Java Bug] => -1
        [Frequent Pages] => 1
        [Browsers Finger Print] => -1
        [Installed Plugins] => 1
        [URL] => -1
        [Cached PNG] => 1
        [System Fonts Detection] => 1
        [Localstorage] => -1
        [Geolocation] => -1
        [AOLTR] => 1
        [Network Information API] => -1
        [Battery Status API] => -1
    )
    [score] => 0.74157303370787
    [diff] => 0.1685393258427
    [base] => 8.9
) 
```

如果 Debug = true 您将能够看到[Input (Sensor & Desired), Initial Weights, Output (Sensor, Sum, Network), Error, Correction and Final Weights](http://codepad.viper-7.com/Ui5Zt0)。

```
+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+------+-----+----+---------+---------+---------+---------+---------+---------+---------+---------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----------+
| o  | x1 | x2 | x3 | x4 | x5 | x6 | x7 | x8 | x9 | x10 | x11 | x12 | x13 | x14 | x15 | x16 | x17 | x18 | x19 | x20 | Bias | Yin | Y  | deltaW1 | deltaW2 | deltaW3 | deltaW4 | deltaW5 | deltaW6 | deltaW7 | deltaW8 | deltaW9 | deltaW10 | deltaW11 | deltaW12 | deltaW13 | deltaW14 | deltaW15 | deltaW16 | deltaW17 | deltaW18 | deltaW19 | deltaW20 | W1 | W2 | W3 | W4 | W5 | W6 | W7 | W8 | W9 | W10 | W11 | W12 | W13 | W14 | W15 | W16 | W17 | W18 | W19 | W20 | deltaBias |
+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+------+-----+----+---------+---------+---------+---------+---------+---------+---------+---------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----------+
| 1  | 1  | -1 | -1 | -1 | -1 | -1 | -1 | 1  | 1  | 1   | 1   | 1   | 1   | 1   | -1  | -1  | -1  | -1  | 1   | 1   | 1    | 0   | -1 | 0       | -1      | -1      | -1      | -1      | -1      | -1      | 1       | 1       | 1        | 1        | 1        | 1        | 1        | -1       | -1       | -1       | -1       | 1        | 1        | 0  | -1 | -1 | -1 | -1 | -1 | -1 | 1  | 1  | 1   | 1   | 1   | 1   | 1   | -1  | -1  | -1  | -1  | 1   | 1   | 1         |
| -1 | -1 | 1  | 1  | 1  | 1  | 1  | 1  | -1 | -1 | -1  | -1  | -1  | -1  | -1  | 1   | 1   | 1   | 1   | -1  | -1  | 1    | -19 | -1 | 0       | 0       | 0       | 0       | 0       | 0       | 0       | 0       | 0       | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0  | -1 | -1 | -1 | -1 | -1 | -1 | 1  | 1  | 1   | 1   | 1   | 1   | 1   | -1  | -1  | -1  | -1  | 1   | 1   | 1         |
| -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --  | --  | --  | --  | --  | --  | --  | --  | --  | --  | --  | --   | --  | -- | --      | --      | --      | --      | --      | --      | --      | --      | --      | --       | --       | --       | --       | --       | --       | --       | --       | --       | --       | --       | -- | -- | -- | -- | -- | -- | -- | -- | -- | --  | --  | --  | --  | --  | --  | --  | --  | --  | --  | --  | --        |
| 1  | 1  | -1 | -1 | -1 | -1 | -1 | -1 | 1  | 1  | 1   | 1   | 1   | 1   | 1   | -1  | -1  | -1  | -1  | 1   | 1   | 1    | 19  | 1  | 0       | 0       | 0       | 0       | 0       | 0       | 0       | 0       | 0       | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0  | -1 | -1 | -1 | -1 | -1 | -1 | 1  | 1  | 1   | 1   | 1   | 1   | 1   | -1  | -1  | -1  | -1  | 1   | 1   | 1         |
| -1 | -1 | 1  | 1  | 1  | 1  | 1  | 1  | -1 | -1 | -1  | -1  | -1  | -1  | -1  | 1   | 1   | 1   | 1   | -1  | -1  | 1    | -19 | -1 | 0       | 0       | 0       | 0       | 0       | 0       | 0       | 0       | 0       | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0        | 0  | -1 | -1 | -1 | -1 | -1 | -1 | 1  | 1  | 1   | 1   | 1   | 1   | 1   | -1  | -1  | -1  | -1  | 1   | 1   | 1         |
| -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --  | --  | --  | --  | --  | --  | --  | --  | --  | --  | --  | --   | --  | -- | --      | --      | --      | --      | --      | --      | --      | --      | --      | --       | --       | --       | --       | --       | --       | --       | --       | --       | --       | --       | -- | -- | -- | -- | -- | -- | -- | -- | -- | --  | --  | --  | --  | --  | --  | --  | --  | --  | --  | --  | --        |
+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+------+-----+----+---------+---------+---------+---------+---------+---------+---------+---------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----------+ 
```

x1 到 x20 表示代码转换的特征。

```
// Get RNA Labels
$labels = array();
$n = 1;
foreach ( $features as $k => $v ) {
    $labels[$k] = "x" . $n;
    $n ++;
} 
```

这是一个[在线演示](http://codepad.viper-7.com/Ui5Zt0)

**使用的类：**

```
class Profile {
    public $name, $data = array(), $score, $diff, $base;

    function __construct($name, array $importance) {
        $values = array(-1, 1); // Perception values
        $this->name = $name;
        foreach ($importance as $item => $point) {
            // Generate Random true/false for real Items
            $this->data[$item] = $values[mt_rand(0, 1)];
        }
        $this->base = array_sum($importance);
    }

    public function setScore($score, $diff) {
        $this->score = $score / $this->base;
        $this->diff = $diff / $this->base;
    }
} 
```

**修改后的感知器类**

```
class Perceptron {
    private $w = array();
    private $dw = array();
    public $debug = false;

    private function initialize($colums) {
        // Initialize perceptron vars
        for($i = 1; $i <= $colums; $i ++) {
            // weighting vars
            $this->w[$i] = 0;
            $this->dw[$i] = 0;
        }
    }

    function train($input, $alpha, $teta) {
        $colums = count($input[0]) - 1;
        $weightCache = array_fill(1, $colums, 0);
        $checkpoints = array();
        $keepTrainning = true;

        // Initialize RNA vars
        $this->initialize(count($input[0]) - 1);
        $just_started = true;
        $totalRun = 0;
        $yin = 0;

        // Trains RNA until it gets stable
        while ($keepTrainning == true) {
            // Sweeps each row of the input subject
            foreach ($input as $row_counter => $row_data) {
                // Finds out the number of columns the input has
                $n_columns = count($row_data) - 1;

                // Calculates Yin
                $yin = 0;
                for($i = 1; $i <= $n_columns; $i ++) {
                    $yin += $row_data["x" . $i] * $weightCache[$i];
                }

                // Calculates Real Output
                $Y = ($yin <= 1) ? - 1 : 1;

                // Sweeps columns ...
                $checkpoints[$row_counter] = 0;
                for($i = 1; $i <= $n_columns; $i ++) {
                    /** DELTAS **/
                    // Is it the first row?
                    if ($just_started == true) {
                        $this->dw[$i] = $weightCache[$i];
                        $just_started = false;
                        // Found desired output?
                    } elseif ($Y == $row_data["o"]) {
                        $this->dw[$i] = 0;
                        // Calculates Delta Ws
                    } else {
                        $this->dw[$i] = $row_data["x" . $i] * $row_data["o"];
                    }

                    /** WEIGHTS **/
                    // Calculate Weights
                    $this->w[$i] = $this->dw[$i] + $weightCache[$i];
                    $weightCache[$i] = $this->w[$i];

                    /** CHECK-POINT **/
                    $checkpoints[$row_counter] += $this->w[$i];
                } // END - for

                foreach ($this->w as $index => $w_item) {
                    $debug_w["W" . $index] = $w_item;
                    $debug_dw["deltaW" . $index] = $this->dw[$index];
                }

                // Special for script debugging
                $debug_vars[] = array_merge($row_data, array(
                    "Bias" => 1,
                    "Yin" => $yin,
                    "Y" => $Y
                ), $debug_dw, $debug_w, array(
                    "deltaBias" => 1
                ));
            } // END - foreach

            // Special for script debugging
             $empty_data_row = array();
            for($i = 1; $i <= $n_columns; $i ++) {
                $empty_data_row["x" . $i] = "--";
                $empty_data_row["W" . $i] = "--";
                $empty_data_row["deltaW" . $i] = "--";
            }
            $debug_vars[] = array_merge($empty_data_row, array(
                "o" => "--",
                "Bias" => "--",
                "Yin" => "--",
                "Y" => "--",
                "deltaBias" => "--"
            ));

            // Counts training times
            $totalRun ++;

            // Now checks if the RNA is stable already
            $referer_value = end($checkpoints);
            // if all rows match the desired output ...
            $sum = array_sum($checkpoints);
            $n_rows = count($checkpoints);
            if ($totalRun > 1 && ($sum / $n_rows) == $referer_value) {
                $keepTrainning = false;
            }
        } // END - while

        // Prepares the final result
        $result = array();
        for($i = 1; $i <= $n_columns; $i ++) {
            $result["w" . $i] = $this->w[$i];
        }

        $this->debug($this->print_html_table($debug_vars));

        return $result;
    } // END - train
    function testCase($input, $results) {
        // Sweeps input columns
        $result = 0;
        $i = 1;
        foreach ($input as $column_value) {
            // Calculates teste Y
            $result += $results["w" . $i] * $column_value;
            $i ++;
        }
        // Checks in each class the test fits
        return ($result > 0) ? true : false;
    } // END - test_class

    // Returns the html code of a html table base on a hash array
    function print_html_table($array) {
        $html = "";
        $inner_html = "";
        $table_header_composed = false;
        $table_header = array();

        // Builds table contents
        foreach ($array as $array_item) {
            $inner_html .= "<tr>\n";
            foreach ( $array_item as $array_col_label => $array_col ) {
                $inner_html .= "<td>\n";
                $inner_html .= $array_col;
                $inner_html .= "</td>\n";

                if ($table_header_composed == false) {
                    $table_header[] = $array_col_label;
                }
            }
            $table_header_composed = true;
            $inner_html .= "</tr>\n";
        }

        // Builds full table
        $html = "<table border=1>\n";
        $html .= "<tr>\n";
        foreach ($table_header as $table_header_item) {
            $html .= "<td>\n";
            $html .= "<b>" . $table_header_item . "</b>";
            $html .= "</td>\n";
        }
        $html .= "</tr>\n";

        $html .= $inner_html . "</table>";

        return $html;
    } // END - print_html_table

    // Debug function
    function debug($message) {
        if ($this->debug == true) {
            echo "<b>DEBUG:</b> $message";
        }
    } // END - debug
} // END - class 
```

**结论**

在没有唯一标识符的情况下识别用户并不是一件简单的事情。它依赖于收集足够数量的随机数据，您可以通过各种方法从用户那里收集这些数据。

即使您选择不使用人工神经网络，我也建议至少使用带有优先级和可能性的简单概率矩阵 - 我希望上面提供的代码和示例能够为您提供足够的帮助。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-04-18T20:32:38.593

这种技术（在没有 cookie 甚至没有 IP 地址的情况下检测相同的用户）称为**浏览器指纹识别**。基本上，您可以尽可能地抓取有关浏览器的信息 - 使用 javascript、flash 或 java（例如安装的扩展程序、字体等）可以获得更好的结果。之后，您可以根据需要存储散列的结果。

这不是万无一失的，但是：

> 83.6% 的浏览器拥有独特的指纹；在启用 Flash 或 Java 的用户中，94.2%。这不包括cookies！

更多信息：

*   [https://panopticlick.eff.org/](https://panopticlick.eff.org/)
*   [https://wiki.mozilla.org/Fingerprinting](https://wiki.mozilla.org/Fingerprinting)
*   [https://www.browserleaks.com/](https://www.browserleaks.com/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-21T11:18:28.600

上面提到的指纹工作，但仍然可能遭受colisions。

一种方法是将 UID 添加到与用户的每次交互的 url 中。

[http://someplace.com/12899823/user/profile](http://someplace.com/12899823/user/profile)

站点中的每个链接都使用此修饰符进行调整。它类似于 ASP.Net 过去在页面之间使用 FORM 数据的方式。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-04-23T14:30:14.990

你调查[过 Evercookie](http://samy.pl/evercookie/)吗？它可能会或可能不会跨浏览器工作。他们网站的摘录。

“如果用户在一个浏览器上获得 cookie 并切换到另一个浏览器，只要他们仍然有本地共享对象 cookie，cookie 就会在两个浏览器中重现。”

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-04-23T13:46:49.923

您可以使用缓存的 png 来执行此操作，它会有点不可靠（不同的浏览器表现不同，如果用户清除缓存，它会失败），但这是一个选项。

1：设置一个数据库，将唯一的用户 ID 存储为十六进制字符串

2：创建一个生成用户ID的genUser.php（或任何语言）文件，将其存储在数据库中，然后从该十六进制字符串的值中创建一个真彩色.png（每个像素将是4个字节）并返回到浏览器。请务必设置内容类型和缓存标头。

3：在HTML或JS中创建一个像`<img id='user_id' src='genUser.php' />`

4：将该图像绘制到画布上`ctx.drawImage(document.getElementById('user_id'), 0, 0);`

5：使用 读取该图像的字节，`ctx.getImageData`并将整数转换为十六进制字符串。

6：这是您的唯一用户 ID，现在缓存在您的用户计算机上。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-21T13:21:04.810

你可以用 etags 做到这一点。虽然我不确定这是否合法，因为一堆诉讼被提起了。

如果您正确警告您的用户，或者您有类似 Intranet 网站的内容，则可能没问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-23T18:49:05.163

您可能会创建一个 blob 来存储设备标识符...

缺点是用户需要下载blob（[您可以强制下载](http://thiscouldbebetter.wordpress.com/2012/12/18/loading-editing-and-saving-a-text-file-in-html5-using-javascrip/)），因为浏览器无法访问文件系统直接保存文件。

参考：

[https://www.inkling.com/read/javascript-definitive-guide-david-flanagan-6th/chapter-22/blobs](https://www.inkling.com/read/javascript-definitive-guide-david-flanagan-6th/chapter-22/blobs)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-24T22:19:13.717

根据你所说的：

> 基本上我在设备识别之后不是真正的用户

最好的方法是发送 MAC 地址，即 NIC ID。

你可以看看这篇文章： [如何在 PHP 中获取已连接客户端的 MAC 和 IP 地址？](https://stackoverflow.com/questions/1420381/how-can-i-get-the-mac-and-the-ip-address-of-a-connected-client-in-php)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-22T19:39:08.090

效率低下，但可能会给你想要的结果，那就是轮询你身边的 API。在客户端有一个后台进程，它会定期发送用户数据。您将需要一个用户标识符来发送到您的 API。一旦你有了它，你就可以发送与该唯一标识符相关的任何信息。

这消除了对 cookie 和本地存储的需要。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-06-20T13:42:32.860

我不敢相信，这里还没有提到[http://browserspy.dk ！](http://browserspy.dk)该站点描述了许多可用于构建分类器的功能（在模式识别方面）。

当然，为了评估这些特性，我特别建议使用 Support Vector Machines 和[libsvm](http://www.csie.ntu.edu.tw/~cjlin/libsvm/)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-03-07T03:23:58.507

在会话期间或跨会话跟踪它们？

如果您的站点是 HTTPS Everywhere，您可以使用 TLS 会话 ID 来跟踪用户的会话

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2014-05-24T23:19:10.493

1.  创建一个跨平台虚拟 (nsapi) 插件，并在用户下载它时（例如登录后）为插件名称或版本生成一个唯一名称。
2.  为插件提供安装程序/根据策略安装它

这将要求用户自愿安装标识符。

安装插件后，任何（启用插件的）浏览器的[指纹](https://wiki.mozilla.org/Fingerprinting#Plugins)都将包含此特定插件。要将信息返回到服务器，需要一种算法来有效地检测客户端的插件，否则 IE 和 Firefox >= 28 用户将需要一个可能的有效标识表。

这需要对可能被浏览器供应商关闭的技术进行相对较高的投资。当您能够说服您的用户安装插件时，可能还会有安装[本地代理](http://www.privoxy.org/)、使用 vpn 或修补网络驱动程序等选项。

不想被识别的用户（或他们的机器）总是会找到一种方法来阻止它。**

# javascript - Node.js 和 Comet

> ID：15966813
> 
> 赞同：7
> 
> 时间：2013-04-12T08:42:54.637
> 
> 标签：javascript, ajax, node.js, comet

基本上，我正在尝试使用 node.js 从头开始​​设置一个基本的彗星服务器和客户端。A 试图用谷歌搜索它应该工作的过程，并且在我测试时它似乎工作正常。然而，一个问题仍然在我的脑海中。首先，我想向您展示代码。

```
var http = require('http');
var sys = require('sys');
var fs = require('fs');
var qs = require('querystring');

var server = http.createServer();

var connections = [];

server.on('request', function(req, res) {

    console.log(req.url);

    if(req.url == '/index') {

        fs.readFile(__dirname + '/index.html', function(err, data){
            if(err) {
                res.writeHead(err, data);
                return res.end('Error loading index.html');
            }

            res.writeHead(200);
            res.end(data);
        });
    } else if(req.url == '/sendData') {
        if (req.method == 'POST') {
            var body = '';
            req.on('data', function (data) {
                body += data;
            });
            req.on('end', function () {

                var POST = qs.parse(body);
                console.log(POST);
                res.writeHead(200);
                res.end("");
                broadcastData(POST);
            });
        }

    } else {
        connections.push(res);
    }
});

function broadcastData(data) {
    for(var i = 0; i < connections.length; i++) {
        connections[i].writeHead(200);
        connections[i].end(JSON.stringify({'message': data}));
    }
}

process.openStdin().addListener('data', function(chunk) {
    for(var i = 0; i < connections.length; i++) {
        connections[i].writeHead(200);
        var message = chunk.toString();
        connections[i].end(JSON.stringify({'message': {'name': message}}));
    }
});

server.listen(4000); 
```

客户端：

```
function doComet() {
    $.getJSON('/', function(events){
        doComet();
        console.log(events);
        $('#content').append(events.message.name);
    });
}

function sendData(data) {
    $.ajax({
        type: "POST",
        url: "/sendData",
        contentType: 'application/javascript; charset=UTF-8',
        data: { name: "John", location: "Boston" }
    }).done(function( msg ) {
        console.log(msg)
    });
} 
```

所以有一个监听器发送我在标准输入上写入的数据，客户端还有一个按钮，它将数据发送到服务器，服务器将其发送给所有客户端。

我的问题是，如果在很短的时间内发生了很多事件怎么办？我的意思是，一旦从服务器获得响应，就会发送另一个 ajax 请求，但是客户端尚未连接时应该有很短的时间，如果在此期间发生某些事情，客户端将没有新数据。

那么我的想法对吗？在这种情况下，我应该以某种方式正确同步数据以确保每个人都能得到它。有谁知道如何正确地做到这一点？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-14T11:56:04.530

Comet 是所有旧的基于 HTTP 的黑客的总称，是我们想要摆脱的短语。WebSockets 是我们想要的地方；浏览器及其他。因此，如果您对构建实时解决方案感兴趣，那么您可能应该首先研究 WebSockets，然后处理诸如 HTTP 流和 HTTP 长轮询之类的后备方案。有关详细信息，请参阅[实时 Web 技术传输机制](http://www.leggetter.co.uk/real-time-web-technologies-guide/realtime-web-technology-transport-mechanisms)。

您提供的示例将被归类为 HTTP 长轮询。

> 如果在很短的时间内发生了很多事件怎么办？我的意思是，一旦从服务器获得响应，就会发送另一个 ajax 请求，但是客户端尚未连接时应该有很短的时间，如果在此期间发生某些事情，客户端将没有新数据

这是 HTTP 长轮询的限制之一，也是为什么 HTTP 流是更好的解决方案，而 WebSockets 更好 - 发送数据时连接不会关闭。对于任何类型的轮询解决方案，您可能需要一个解决方案来确保轮询客户端不会错过轮询请求期间接收和发送的消息。

有几个解决方案：

1.  使用会话来跟踪发送给特定客户端的最后一条消息。当他们重新连接时，检查上次发送了哪些消息，错过了哪些消息并发送。
2.  作为客户端轮询的一部分，发送一个`lastMessageId`. 当服务器收到此消息时，您可以检查这是否是最后一条消息。如果没有，您可以回复任何错过的消息。

实时 Web 技术的复杂性之一是处理所有可能的连接场景。因此，如果您将其作为一种学习体验，那么它绝对是有益且有趣的。但是，如果您正在创建一个应用程序以投入生产，我会推荐一个现有的实时框架。请参阅[实时网络技术指南](http://www.leggetter.co.uk/real-time-web-technologies-guide)。

# java - Java：使用带修饰符的类型化击键

> ID：15966820
> 
> 赞同：0
> 
> 时间：2013-04-12T08:43:38.040
> 
> 标签：java, keyboard-shortcuts

我正在尝试为我的应用程序实现与键盘布局无关的键盘快捷键，例如使用 Ctrl-+ 进行缩放。

我认为这样做的正确方法是：

```
KeyStroke.getKeyStroke(new Character('+'), 0)
KeyStroke.getKeyStroke(new Character('+'), InputEvent.CTRL_DOWN_MASK) 
```

不幸的是，似乎只有第一种方法有效，而我想使用第二行中的修饰键。

有想法该怎么解决这个吗？

这是一个完整的片段：

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.InputEvent;

import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.KeyStroke;

public class KeystrokeTest extends JFrame{
    JLabel label = new JLabel("text");
    public KeystrokeTest(){
        JPanel panel = new JPanel();
        panel.add(label);
        panel.registerKeyboardAction(new ActionListener() {
            public void actionPerformed(ActionEvent arg0) {
                label.setVisible(!label.isVisible());
            }
        }, 
        KeyStroke.getKeyStroke(new Character('+'), InputEvent.CTRL_DOWN_MASK),
        JComponent.WHEN_IN_FOCUSED_WINDOW);
        add(panel);
        setSize(200,200);
    }
    public static void main(String[] args) {
        new KeystrokeTest().setVisible(true);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:54:00.467

试试这条线

```
KeyStroke.getKeyStroke(KeyEvent.VK_PLUS, InputEvent.CTRL_MASK); 
```

# entity-framework - 如何防止相关记录与 EF 5 Code First 中的主记录一起保存？

> ID：15966825
> 
> 赞同：-1
> 
> 时间：2013-04-12T08:43:47.357
> 
> 标签：entity-framework, ef-code-first, entity-framework-5

我有一堂课：

```
public class VehicleMovement: IEntityWithId
{
    public int Id { get; set; }
    public string EmpNo { get; set; }
    public DateTime MovementDate { get; set; }
    public DateTime TempMovementTime { get; set; }
    public TimeSpan MovementTime { get; set; }
    public VehicleMovementType MovementType { get; set; }
    public int MovementTypeId { get; set; }
} 
```

然后我有一些 CsvHelper 代码将 CSV 文件映射到这些`VehicleMovement`对象的集合。`MovementType`在映射过程中，我使用查找函数来确定and的正确值`MovementTypeId`，但是当我尝试`VehicleMovement`使用 'old'保存新的 时，我在实体`VehicleMovementType`上得到一个重复的键异常。`VehicleMovementType`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T13:45:23.383

提示：您不必同时设置`MovementTypeId`和导航属性 ( `MovementType`)，只需将 id 放入（如果实体结构正确连接）。

并且缺少您提供的任何其他信息，

类似的情况可以用例如解决

```
context.Entry(vehicleMovement.MovementType).State = System.Data.EntityState.Unchanged; 
```

如果那是你想要的，我猜。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T04:55:22.647

我使用 a根据传入的 CSV 文件中的描述`VehicleMovementTypeDictionary`来查找我的对象。`VehicleMovementTyoe`我犯了一个错误，即在字典的 thr ctor 中实例化一个新的 DbContext，同时使用原始的 DbContext 来处理翻译的 CSV 记录。

我更改了字典的代码以使用与我的主要导入例程相同的上下文，即

```
public MovementTypeDictionary(ParkPayDbContext dbContext)
{
    foreach (var movementType in dbContext.VehicleMovementTypes)
    {
        Add(movementType.Description, movementType);
    }
} 
```

稍后在主代码中，我传入共享的 DbContect 并解决了所有问题：

```
VehicleMovementReadMap.MovementTypes = new MovementTypeDictionary(_dbContext); 
```

请记住，从不同上下文加载的对象不会被跟踪，当您将它们添加到第一个上下文时，它们看起来是新的、未附加的，并且可以插入。

# sql - 客户显示帐户 SQL 的最大付款

> ID：15966828
> 
> 赞同：1
> 
> 时间：2013-04-12T08:44:05.160
> 
> 标签：sql, sql-server, tsql

我似乎有一个作家阻止的时刻。

我需要一个查询，该查询将在特定日期按客户和帐户返回最大付款。

2 个表，其中一个用于客户和客户数据（客户 1 有 50 个客户），第二个表用于接收付款和日期。

所以我想要一个显示的表格：

```
Client | Account | Paid   | Date
----------------------------------------
   1   | 1234    | £2.99  | 01/11/2012
   2   | 1235    | £4.99  | 08/12/2012 
```

希望这是有道理的！在我的脑海里它应该很简单！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:52:06.397

这个问题很有趣。使用聚合查询解决了这个问题。

SQL 小提琴：[http ://www.sqlfiddle.com/#!3/29256/1/0](http://www.sqlfiddle.com/#!3/29256/1/0)

```
select d.[Client], c.[Account],
max([Paid])as 'PAID', 
d.[Date] 
from Customer c, Data d where
d.[Client] = c.[Client] 
group by d.[Client],c.[Account],d.[Date]; 
```

产生结果：

```
CLIENT  ACCOUNT PAID    DATE
1   Stack   123 January, 01 2013 00:00:00+0000
1   Stack   234 January, 02 2013 00:00:00+0000
1   Stack   33  January, 03 2013 00:00:00+0000
2   Over    674 January, 04 2013 00:00:00+0000
2   Over    2424    January, 05 2013 00:00:00+0000
2   Over    4545    January, 06 2013 00:00:00+0000
3   Flow    22  January, 07 2013 00:00:00+0000
3   Flow    3456    January, 08 2013 00:00:00+0000
3   Flow    445 January, 09 2013 00:00:00+0000 
```

如果我们遇到客户可能拥有多个帐户的情况，并且我们想找到在特定日期支付的最大金额的客户帐户，我们将不得不做一些更复杂的事情：

```
select *
from Customer c2, Data d2, 
(
select d.[Client],
max([Paid])as 'PAID', 
d.[Date] 
from Customer c, 
Data d 
where
d.[Client] = c.[Client] group by d.[Client],d.[Date]
) subQ
where c2.[client] = d2.[client] and
c2.[client] = subQ.[client] and
d2.[Paid] = subQ.[Paid] and
d2.[Date] = subQ.[Date]; 
```

由于您无法将其他列添加到不属于 group by 的查询中 - 请参阅：[http ://technicalsmile.blogspot.gr/2011/04/column-is-invalid-in-select-list.html](http://technicalsmile.blogspot.gr/2011/04/column-is-invalid-in-select-list.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:43:08.647

```
select  
  Customer.name, 
  Account.name as account_name, 
  [date], 
  max(paid) 
from Data,
     Customer,
     Account
where Data.client = Customer.id
  and Data.account = Account.id
group by Customer.name, Account.name, [date] 
```

[http://www.sqlfiddle.com/#!3/93baf/2](http://www.sqlfiddle.com/#!3/93baf/2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:49:01.513

SQL Server 支持`Common Table Expression`和`Windowing Function`. 查询使用`DENSE_RANK()`根据最大`Paid`为每个给出排名值`Account`。所以第一个值是最大值，排名值为`1`。这是您要过滤的值。

假设链接两个表的列是`Client`

```
WITH record
AS
(
    SELECT  a.Client, a.Account, b.Paid, b.Date,
            DENSE_RANK() OVER (PARTITION BY a.Client ORDER BY b.Paid DESC) rn
    FROM    Customer a
            INNER JOIN Data b
                ON a.Client = b.Client
)
SELECT  Client, Account, Paid, Date
FROM    record
WHERE   rn = 1 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/98475/1)
*   [TSQL 排名函数](http://msdn.microsoft.com/en-us/library/ms189798.aspx)

考虑以下记录（来自[SQLFiddle Demo](http://www.sqlfiddle.com/#!3/98475/1)）

**客户表**

```
╔════════╦═════════╗
║ CLIENT ║ ACCOUNT ║
╠════════╬═════════╣
║      1 ║ Stack   ║
║      2 ║ Over    ║
║      3 ║ Flow    ║
╚════════╩═════════╝ 
```

**数据表**

```
╔════════╦══════╦════════════════════════════════╗
║ CLIENT ║ PAID ║              DATE              ║
╠════════╬══════╬════════════════════════════════╣
║      1 ║  123 ║ January, 01 2013 00:00:00+0000 ║
║      1 ║  234 ║ January, 02 2013 00:00:00+0000 ║
║      1 ║   33 ║ January, 03 2013 00:00:00+0000 ║
║      2 ║  674 ║ January, 04 2013 00:00:00+0000 ║
║      2 ║ 2424 ║ January, 05 2013 00:00:00+0000 ║
║      2 ║ 4545 ║ January, 06 2013 00:00:00+0000 ║
║      3 ║   22 ║ January, 07 2013 00:00:00+0000 ║
║      3 ║ 3456 ║ January, 08 2013 00:00:00+0000 ║
║      3 ║  445 ║ January, 09 2013 00:00:00+0000 ║
╚════════╩══════╩════════════════════════════════╝ 
```

* * *

**连接表的结果**

```
╔════════╦═════════╦══════╦════════════════════════════════╗
║ CLIENT ║ ACCOUNT ║ PAID ║              DATE              ║
╠════════╬═════════╬══════╬════════════════════════════════╣
║      1 ║ Stack   ║  123 ║ January, 01 2013 00:00:00+0000 ║
║      1 ║ Stack   ║  234 ║ January, 02 2013 00:00:00+0000 ║ << Expected Output
║      1 ║ Stack   ║   33 ║ January, 03 2013 00:00:00+0000 ║
║      2 ║ Over    ║  674 ║ January, 04 2013 00:00:00+0000 ║
║      2 ║ Over    ║ 2424 ║ January, 05 2013 00:00:00+0000 ║
║      2 ║ Over    ║ 4545 ║ January, 06 2013 00:00:00+0000 ║ << Expected Output
║      3 ║ Flow    ║   22 ║ January, 07 2013 00:00:00+0000 ║
║      3 ║ Flow    ║ 3456 ║ January, 08 2013 00:00:00+0000 ║ << Expected Output
║      3 ║ Flow    ║  445 ║ January, 09 2013 00:00:00+0000 ║
╚════════╩═════════╩══════╩════════════════════════════════╝ 
```

**最终输出**

```
╔════════╦═════════╦══════╦════════════════════════════════╗
║ CLIENT ║ ACCOUNT ║ PAID ║              DATE              ║
╠════════╬═════════╬══════╬════════════════════════════════╣
║      1 ║ Stack   ║  234 ║ January, 02 2013 00:00:00+0000 ║
║      2 ║ Over    ║ 4545 ║ January, 06 2013 00:00:00+0000 ║
║      3 ║ Flow    ║ 3456 ║ January, 08 2013 00:00:00+0000 ║
╚════════╩═════════╩══════╩════════════════════════════════╝ 
```

# ember.js - 修订版 12 中的自定义映射

> ID：15966831
> 
> 赞同：0
> 
> 时间：2013-04-12T08:44:14.057
> 
> 标签：ember.js, ember-data

我已经升级到 Ember-Data rev 12，但不知道如何加载我的 Fixture。我尝试`key' and`在模型上使用 sideLoadAs`，但没有效果。

模型：

```
Sks.User = DS.Model.extend
  kudosReceived: DS.hasMany('Sks.KudoReceived', key: 'kudo_received_ids', sideLoadAs: 'kudos_received')
  name: DS.attr("string")
  email: DS.attr("string") 
```

夹具：

```
Sks.User.FIXTURES = [
  id: 1
  name: 'Joe Doe'
  email: 'joe.doe@gmail.com'
  kudo_received_ids: [1, 2]
  kudos_received: [
    id: 1
    value: 2
    comment: 'Because you are nice to me!'
  ,
    id: 2
    value: 3
    comment: 'It was awesome!'
  ]
] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T11:41:52.963

您的固定装置需要是一个对象数组，而不仅仅是一个数组。还可以尝试将它们拆分为每种类型的单独固定装置：

```
Sks.User.FIXTURES = [{
    id: 1,
    name: 'Joe Doe',
    email: 'joe.doe@gmail.com',
    kudos: [1,2]
}];

Sks.Kudos.FIXTURES = [{
    id: 1,
    value: 2,
    comment: 'Because you are nice to me!'
}, {
    id: 2,
    value: 3,
    comment: 'It was awesome!'
}]; 
```

然后你应该需要一个简单的关系来将两者联系在一起：

```
Sks.User = Ds.Model.extend({
    name: DS.attr('string'),
    email: DS.attr('string'),
    kudos: DS.hasMany('Sks.Kudos')
});

Sks.Kudos = Ds.Model.extend({
    value: DS.attr('number'),
    comment: DS.attr('string'),
    user: DS.belongsTo('Sks.User')
}); 
```

那应该为你做。

# php - PHP解压字符串

> ID：15966832
> 
> 赞同：1
> 
> 时间：2013-04-12T08:44:19.813
> 
> 标签：php, google-drive-api, unzip

我正在通过 API 将 Google Drive 电子表格加载到 PHP 中。该请求返回`XLSX`电子表格，我需要将其解压缩。为了节省我将响应写入临时然后调用，说，`zip_open()`有没有办法可以将这样的方法传递给字符串？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T08:55:48.470

我认为您最好的选择是创建一个临时文件，然后将其解压缩。

```
// Create a temporary file which creates file with unique file name
$tmp = tempnam(sys_get_temp_dir(), md5(uniqid(microtime(true))));

// Write the zipped content inside
file_put_contents($tmp, $zippedContent);

// Uncompress and read the ZIP archive
$zip = new ZipArchive;
if (true === $zip->open($tmp)) {
    // Do whatever you want with the archive... 
    // such as $zip->extractTo($dir); $zip->close();
}

// Delete the temporary file
unlink($tmp); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T08:49:31.370

我会自己写临时文件，但你可能想在这里看到第一条评论：http: [//de3.php.net/manual/en/ref.zip.php](http://de3.php.net/manual/en/ref.zip.php)

* * *

> wdtemp at seznam dot cz 嗨，如果您只有一个字符串中的 ZIP 文件的原始内容，并且您无法在服务器上创建文件（因为安全模式），那么您就可以创建一个文件，然后您可以通过对于 zip_open()，您将很难获得 ZIP 数据的未压缩内容。这可能会有所帮助：我编写了简单的 ZIP 解压缩函数，用于从存储在字符串中的存档中解压缩第一个文件（无论它是什么文件）。它只是解析第一个文件的本地文件头，获取该文件的原始压缩数据并对该数据进行解压缩（通常，ZIP文件中的数据通过'DEFLATE'方法压缩，因此我们将通过gzinflate（ ) 函数然后)。

```
<?php
function decompress_first_file_from_zip($ZIPContentStr){
//Input: ZIP archive - content of entire ZIP archive as a string
//Output: decompressed content of the first file packed in the ZIP archive
    //let's parse the ZIP archive
    //(see 'http://en.wikipedia.org/wiki/ZIP_%28file_format%29' for details)
    //parse 'local file header' for the first file entry in the ZIP archive
    if(strlen($ZIPContentStr)<102){
        //any ZIP file smaller than 102 bytes is invalid
        printf("error: input data too short<br />\n");
        return '';
    }
    $CompressedSize=binstrtonum(substr($ZIPContentStr,18,4));
    $UncompressedSize=binstrtonum(substr($ZIPContentStr,22,4));
    $FileNameLen=binstrtonum(substr($ZIPContentStr,26,2));
    $ExtraFieldLen=binstrtonum(substr($ZIPContentStr,28,2));
    $Offs=30+$FileNameLen+$ExtraFieldLen;
    $ZIPData=substr($ZIPContentStr,$Offs,$CompressedSize);
    $Data=gzinflate($ZIPData);
    if(strlen($Data)!=$UncompressedSize){
        printf("error: uncompressed data have wrong size<br />\n");
        return '';
    }
    else return $Data;
}

function binstrtonum($Str){
//Returns a number represented in a raw binary data passed as string.
//This is useful for example when reading integers from a file,
// when we have the content of the file in a string only.
//Examples:
// chr(0xFF) will result as 255
// chr(0xFF).chr(0xFF).chr(0x00).chr(0x00) will result as 65535
// chr(0xFF).chr(0xFF).chr(0xFF).chr(0x00) will result as 16777215
    $Num=0;
    for($TC1=strlen($Str)-1;$TC1>=0;$TC1--){ //go from most significant byte
        $Num<<=8; //shift to left by one byte (8 bits)
        $Num|=ord($Str[$TC1]); //add new byte
    }
    return $Num;
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:51:57.987

查看 zlib 函数（如果在您的系统上可用）。据我所知，有类似`zlib-decode`（或类似）的东西可以处理原始 zip 数据。

# python - 将 raw_input() 与 map 一起使用时出现意外回显

> ID：15966835
> 
> 赞同：1
> 
> 时间：2013-04-12T08:44:25.860
> 
> 标签：python, python-2.7

在[打代码打高尔夫球](https://codegolf.stackexchange.com/questions/11250/rosetta-stone-challenge-draw-a-box-plot)时，我想使用以下代码从标准输入读取几行数据

```
D:\>cat box.py
n=int(raw_input().split('=')[-1])
data=map(raw_input,range(n))
D:\>box.py
3
01
12
23 
```

令我惊讶的是，每次从标准输入读取数据时，它都会不断回显一系列数字

在将上述代码更改为使用 LC 时，问题不存在。

```
D:\>cat box.py
n=int(raw_input().split('=')[-1])
data=[raw_input() for _ in range(n)]
D:\>box.py
3
1
2
3 
```

知道可能是什么原因吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T08:46:40.333

[`raw_input()`](http://docs.python.org/2/library/functions.html#raw_input) takes an optional argument, the prompt, that gets written to stdout. You are supplying that argument by your use of `map()`.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-12T08:48:47.690

我认为原因是第二个代码块中有 for 循环，而第一个没有这样的限制

# iphone - ALAssetsLibrary doesn't return runloop

> ID：15966843
> 
> 赞同：3
> 
> 时间：2013-04-12T08:44:43.687
> 
> 标签：iphone, objective-c, uicollectionview, alassetslibrary, runloop

i wanna show a `UICollectionView` but i have a problem with loading the images. The `AlAssetsLibrary` doesn't return to the runloop.

I get the output as

`2013-04-12 11:36:25.429 Filmriss[459:907] didReturnWithDefaultRepresentation` `2013-04-12 11:36:25.431 Filmriss[459:907] didReturnWithDefaultRepresentation` `2013-04-12 11:36:25.435 Filmriss[459:907] didReturnWithDefaultRepresentation` `2013-04-12 11:36:25.438 Filmriss[459:907] cellForItemAtIndexPath`
`2013-04-12 11:36:25.450 Filmriss[459:907] cellForItemAtIndexPath`
`2013-04-12 11:36:25.456 Filmriss[459:907] cellForItemAtIndexPath`

The `didReturnWithDefaultRepresentation` method is called after every image. in this method try i reload the Collection-view, but it reloads only after all images are found.

Heres my Code:

```
@implementation PhotoEngine
-(void)startLookingForPhotosBetween:(NSDate*)startDate andEndDate:(NSDate*)endDate
{
 BOOL __block isValid = NO;

NSMutableArray *representationArray = [NSMutableArray new];
ALAssetsLibrary *assetLibrary = [ALAssetsLibrary new];
[assetLibrary enumerateGroupsWithTypes:ALAssetsGroupAll usingBlock:^(ALAssetsGroup *group, BOOL *stop) {
    if (group) {
        [group setAssetsFilter:[ALAssetsFilter allPhotos]];
        [group enumerateAssetsUsingBlock:
         ^(ALAsset *asset, NSUInteger index, BOOL *stop)
         {
             if (!asset && (index == NSNotFound))
             {
                 if ([self.delegate respondsToSelector:@selector(photoEngine:didFinishWithResults:)]) {
                     dispatch_async(dispatch_get_main_queue(), ^{
                         [self.delegate photoEngine:self didFinishWithResults:representationArray];
                     });
                 }
             }
             else {
                 ALAssetRepresentation *defaultRepresentation = [asset defaultRepresentation];

                 NSDate *creationDate = [asset valueForProperty:ALAssetPropertyDate];
                 if (
                     ([startDate compare:creationDate] == NSOrderedAscending) &&
                     ([endDate compare:creationDate] == NSOrderedDescending )
                     ) {
                     isValid = YES;

                 }
                 if(isValid) {

                     [representationArray addObject:defaultRepresentation.url];
                     NSURL *url = defaultRepresentation.url;
                     if ([self.delegate respondsToSelector:@selector(photoEngine:didReturnWithDefaultRepresentation:)]) {
                         dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0), ^{
                             [self.delegate photoEngine:self didReturnWithDefaultRepresentation:url];
                         });
                     }

                 }
             }
         }];
    }
    // group == nil signals we are done iterating.
    else {
        dispatch_async(dispatch_get_main_queue(), ^{

        });
    }
}
                          failureBlock:^(NSError *error) {
                              NSLog(@"error enumerating AssetLibrary groups %@\n", error);
                          }];

}
@end
// didReturnWithDefaultRepresentation this Method is in CollectionView
-(void)photoEngine:(PhotoEngine*)photoEngine didReturnWithDefaultRepresentation:(NSURL   *)defaultRepresentationURL
{
NSLog(@"didReturnWithDefaultRepresentation");
[self.photoDataArray addObject:defaultRepresentationURL];
[self.collectionView reloadData];

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-12T09:27:33.700

首先，必须修复 [self.collectionView reloadData]；在主标题中。

# javascript - 获取所选文本的 xpath

> ID：15966844
> 
> 赞同：1
> 
> 时间：2013-04-12T08:44:44.397
> 
> 标签：javascript, browser

我正在创建一个 epub 图书阅读器。展示这本书后，我想允许用户在书中添加一些注释。

为了显示这本书，我使用了一个加载本地 html 文件的 wpf webbrowser 控件

我想通过创建上下文菜单或显示弹出窗口来操作此控件上的选定文本

我需要使用 javascript 函数获取所选文本的 xpath

```
var uiWebview_xpath = "";

function uiWebview_storeSelection() 
{
    if (typeof window.getSelection != 'undefined')
     {
        var selection = window.getSelection();
        var range = selection.getRangeAt(0);//two range, absolute and relative
        if (range != null) 
        {
            uiWebview_xpath = makeXPath(range.startContainer) + '|' + range.startOffset + '|' + makeXPath(range.endContainer) + '|' + range.endOffset;
            // var x = document.getElementsByName("Hidden1");
            // x.value = uiWebview_xpath;
            return uiWebview_xpath;

        }

}

else if (typeof document.selection != "undefined") {

    if (document.selection.type == "Text") {

        html = document.selection.createRange().htmlText;

    }

    return  html;
}
} 
```

但我发现我没有使用这个函数的第一部分，我得到的只是第二部分返回的 html，我想为这个 html 创建 xPath

```
//http://home.arcor.de/martin.honnen/javascript/storingSelection1.html

function nsResolver(prefix){
    var ns = {
        'mathml' : 'http://www.w3.org/1998/Math/MathML', // for example's sake only
        'h' : 'http://www.w3.org/1999/xhtml'
    };
    return ns[prefix];
}

function makeXPath (node, currentPath) {
    /* this should suffice in HTML documents for selectable nodes, XML with namespaces needs more code */
    currentPath = currentPath || '';
    switch (node.nodeType) {
        case 3:
        case 4:
            return makeXPath(node.parentNode, 'text()[' + (document.evaluate('preceding-sibling::text()', node, nsResolver, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null).snapshotLength + 1) + ']');
        case 1:
            return makeXPath(node.parentNode, node.tagName + '[' + (document.evaluate('preceding-sibling::' + 'h:' + node.tagName, node, nsResolver, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null).snapshotLength + 1) + ']' + (currentPath ? '/' + currentPath : ''));
        case 9:
            return '/' + currentPath;
        default:
            return '';
    }
} 
```

我是编程初学者，我正在寻找指示和帮助，我也想知道 webbrowser 控件的版本是否会影响我得到“document.selection！=”undefined“之间的区别的结果和“window.getSelection！='未定义'”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T10:37:54.603

我曾经遇到过这个问题。您所要做的就是添加 IE 浏览器无法识别的功能。

1.  首先，您必须使用将为您提供对象范围而不是 TextRange的[ierange](https://code.google.com/p/ierange/)

2.  使用为您提供重要功能的[wgxpath ，即 document.evaluate](https://code.google.com/p/wicked-good-xpath/downloads/detail?name=wgxpath.install.js&can=2&q=)

这是我的代码：

```
 function fixIERangeObject(range, win) { //Only for IE8 and below.
        win = win || window;

        if (!range) return null;
        if (!range.startContainer && win.document.selection) { //IE8 and below

            var _findTextNode = function (parentElement, text) {
                //Iterate through all the child text nodes and check for matches
                //As we go through each text node keep removing the text value (substring) from the beginning of the text variable.
                var container = null, offset = -1;
                for (var node = parentElement.firstChild; node; node = node.nextSibling) {
                    if (node.nodeType == 3) {//Text node
                        var find = node.nodeValue;
                        var pos = text.indexOf(find);
                        if (pos == 0 && text != find) { //text==find is a special case
                            text = text.substring(find.length);
                        } else {
                            container = node;
                            offset = text.length - 1; //Offset to the last character of text. text[text.length-1] will give the last character.
                            break;
                        }
                    }
                }
                //Debug Message
                //alert(container.nodeValue);
                return { node: container, offset: offset }; //nodeInfo
            }

            var rangeCopy1 = range.duplicate(), rangeCopy2 = range.duplicate(); //Create a copy
            var rangeObj1 = range.duplicate(), rangeObj2 = range.duplicate(); //More copies :P

            rangeCopy1.collapse(true); //Go to beginning of the selection
            rangeCopy1.moveEnd('character', 1); //Select only the first character
            rangeCopy2.collapse(false); //Go to the end of the selection
            rangeCopy2.moveStart('character', -1); //Select only the last character

            //Debug Message
            // alert(rangeCopy1.text); //Should be the first character of the selection
            var parentElement1 = rangeCopy1.parentElement(), parentElement2 = rangeCopy2.parentElement();

            rangeObj1.moveToElementText(parentElement1); //Select all text of parentElement
            rangeObj1.setEndPoint('EndToEnd', rangeCopy1); //Set end point to the first character of the 'real' selection
            rangeObj2.moveToElementText(parentElement2);
            rangeObj2.setEndPoint('EndToEnd', rangeCopy2); //Set end point to the last character of the 'real' selection

            var text1 = rangeObj1.text; //Now we get all text from parentElement's first character upto the real selection's first character    
            var text2 = rangeObj2.text; //Here we get all text from parentElement's first character upto the real selection's last character

            var nodeInfo1 = _findTextNode(parentElement1, text1);
            var nodeInfo2 = _findTextNode(parentElement2, text2);

            //Finally we are here
            range.startContainer = nodeInfo1.node;
            range.startOffset = nodeInfo1.offset;
            range.endContainer = nodeInfo2.node;
            range.endOffset = nodeInfo2.offset + 1; //End offset comes 1 position after the last character of selection.
        }
        return range;
    }

    function getRangeObject(win) { //Gets the first range object
        win = win || window;
        if (win.getSelection) { // Firefox/Chrome/Safari/Opera/IE9
            try {
                return win.getSelection().getRangeAt(0); //W3C DOM Range Object
            } catch (e) { /*If no text is selected an exception might be thrown*/ }
        }
        else if (win.document.selection) { // IE8
            var range = win.document.selection.createRange(); //Microsoft TextRange Object
            return fixIERangeObject(range, win);
        }
        return null;
    }

        function nsResolver(prefix) {
            var ns = {
                'mathml': 'http://www.w3.org/1998/Math/MathML', // for example's sake only
                'h': 'http://www.w3.org/1999/xhtml'
            };
            return ns[prefix];
        }

        function makeXPath(node, currentPath) {
            /* this should suffice in HTML documents for selectable nodes, XML with namespaces needs more code */
            currentPath = currentPath || '';
            switch (node.nodeType) {
                case 3:
                case 4:
                    return makeXPath(node.parentNode, 'text()[' + (document.evaluate('preceding-sibling::text()', node, nsResolver, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null).snapshotLength + 1) + ']');
                case 1:
                    return makeXPath(node.parentNode, node.tagName + '[' + (document.evaluate('preceding-sibling::' + 'h:' + node.tagName, node, nsResolver, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null).snapshotLength + 1) + ']' + (currentPath ? '/' + currentPath : ''));
                case 9:
                    return '/' + currentPath;
                default:
                    return '';
            }
        }

         var uiWebview_xpath = "";

    function uiWebview_storeSelection() {

    if (typeof window.getSelection != 'undefined') {
    wgxpath.install(window);
    var selection = window.getSelection();
    var range = selection.getRangeAt(0); //two range, absolute and relative
    if (range != null) {
    uiWebview_xpath = makeXPath(range.startContainer) + '|' + range.startOffset + '|' + makeXPath(range.endContainer) + '|' + range.endOffset;
    alert(uiWebview_xpath);
    return uiWebview_xpath;

    }

    }

    else if (typeof document.selection != "undefined") {
        wgxpath.install();
        var range = getRangeObject();
        if (range != null) {
            uiWebview_xpath = makeXPath(range.startContainer) + '|' + range.startOffset + '|' + makeXPath(range.endContainer) + '|' + range.endOffset;
            alert("D"+uiWebview_xpath);
            return uiWebview_xpath;

        }

//        if (document.selection.type == "Text") {

//            html = document.selection.createRange().htmlText;

//            alert(html);

//        }

        return "elsif\n:" + "html\n:" + html;
    }
    } 
```

# c# - c#充气城堡验证签名上的InvalidCastException

> ID：15966846
> 
> 赞同：2
> 
> 时间：2013-04-12T08:45:04.820
> 
> 标签：c#, bouncycastle, signature, ecdsa

我尝试验证 ecdsa (256) 签名，我要做的唯一数据是下面给定格式的公钥、原始数据和签名：

```
 string pubKey_ecdsa = "MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE+noecsW+vdfd8DNo5dsAxU4DOaNt6PGmSCLFo/EvQG4xmVzv464qXvDPIrPN8GtLnubzoa9rtWJD52VlGOpFsA==";

        string data_ecdsa = ";\"4399901526945\";\"AAAA-BBBBBBBBB-123456789000\";\"5010112544615\";\"20130802063109143\";";

        string signature_ecdsa = @"BEcwRQIgJFwnCvm8lRjlRt+G+f4viJktDYVyOiXUd5BJ0V761eECIQDBTHLjJI7KK3FhczEHjunenYWXylDdW91jbS23EmeznA=="; 
```

当我尝试使用充气城堡通过调用来验证签名时：

```
 //Create the public key from string
        AsymmetricKeyParameter pubKey = PublicKeyFactory.CreateKey(Convert.FromBase64String(pubKey_ecdsa));

        // create byte array from string
        byte[] b_signature = Convert.FromBase64String(signature_ecdsa);

        ASCIIEncoding encoder = new ASCIIEncoding();
        byte[] inputData = encoder.GetBytes(data_ecdsa);
        ISigner signer = SignerUtilities.GetSigner("SHA-256withECDSA");
        signer.Init(false, pubKey);
        signer.BlockUpdate(inputData, 0, inputData.Length);

        bool valid =  signer.VerifySignature(b_signature); 
```

我收到一个`InvalidCastException`：

```
Unable to cast object of type 'Org.BouncyCastle.Asn1.DerOctetString'
to type 'Org.BouncyCastle.Asn1.Asn1Sequence'. 
```

在以下行：

```
bool valid =  signer.VerifySignature(b_signature); 
```

所以，签名似乎有问题，但我无法弄清楚。我希望任何人都可以提供一个好主意。

顺便说一句，此示例中提供的数据已被修改，因此签名将被评估为假，如果它可以工作的话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-24T12:00:59.380

这可能为时已晚，但为了以后读者的利益：

DSA 签名应该是包含两个 INTEGER 的 SEQUENCE 的 ASN.1 编码。这里的问题是 b_signature 实际上是一个 OCTET STRING，其中的八位字节是正确的编码。所以有一个额外的“外层”包裹着真实的签名。您可以通过转储结构来看到这一点：

```
Asn1OctetString outer =(Asn1OctetString)Asn1Object.FromByteArray(b_signature);
byte[] inner = outer.GetOctets();

Console.WriteLine(Asn1Dump.DumpAsString(outer));
Console.WriteLine(Asn1Dump.DumpAsString(Asn1Object.FromByteArray(inner))); 
```

对我来说，这打印：

> DER 八位组字符串[71]
> 
> DER Sequence Integer(16446081942964531772961165410855935370418106604815444975891408706004345083361) Integer(87431453076334980518600256741994746667679967157867025465393185500427926877084)

因此，“内部”八位字节看起来被正确编码。现在：

```
bool valid = signer.VerifySignature(inner); 
```

对我来说，这会打印“假”，您说这是预期的，因为数据已被修改。

# android - Integrating JPCT-AE with Vuforia

> ID：15966848
> 
> 赞同：3
> 
> 时间：2013-04-12T08:45:11.893
> 
> 标签：android, rendering, vuforia, jpct

I am Integrating JPCT-AE with Vuforia for as Vuforia sample `ImageTarget` teapot model. I followed the kelmar and Sam Rad's [answer](http://www.stackoverflow.com/questions/15199479/jpct-ae-vuforia/15227205#15227205) and now I am able to render my model as well as teapot but in landscape mode only.

:::::BUT:::::::

When I make changes in `initApplication()` in ImageTarget

```
int screenOrientation = ActivityInfo.SCREEN_ORIENTATION_SENSOR; 
                                        or  ORIENTATION_PORTRATE; 
```

My model starts rendering here and there on the screen which means it's not the way that teapot is rendered. As I understand, we need to change the matrix something to render model in portrait mode.

But I don't know how. If you have any idea, please refer me shortly.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T22:32:49.680

这是来自 Vuforia 示例代码的引用：

```
Set the screen orientation
        //
        // NOTE: It is recommended to set this because of the following reasons:
        //
        //    1.) Before Android 2.2 there is no reliable way to query the
        //        absolute screen orientation from an activity, therefore using 
        //        an undefined orientation is not recommended. Screen 
        //        orientation matching orientation sensor measurements is also
        //        not recommended as every screen orientation change triggers
        //        deinitialization / (re)initialization steps in internal QCAR 
        //        SDK components resulting in unnecessary overhead during 
        //        application run-time.
        //
        //    2.) Android camera drivers seem to always deliver landscape images
        //        thus QCAR SDK components (e.g. camera capturing) need to know 
        //        when we are in portrait mode. Before Android 2.2 there is no 
        //        standard, device-independent way to let the camera driver know 
        //        that we are in portrait mode as each device seems to require a
        //        different combination of settings to rotate camera preview 
        //        frames images to match portrait mode views. Because of this,
        //        we suggest that the activity using the QCAR SDK be locked
        //        to landscape mode if you plan to support Android 2.1 devices
        //        as well. Froyo is fine with both orientations. 
```

我[在运行时更改 Screen.orientation 中](https://developer.vuforia.com/forum/unity-3-extension-technical-discussion/changing-screenorientation-runtime)读到，如果您切换方向，屏幕高度和宽度不会改变。它们与导致错误跟踪的默认方向保持一致。

就我个人而言，我不认为如果你改变方向，你会得到一个好的结果，但为了确保你可以向 Vuforia[支持](https://developer.vuforia.com/forum)询问。团队。自行检查屏幕高度和宽度是否在方向切换期间发生变化。如果是这样，您可以创建`FrameBuffer`新的价值观，我相信这会解决您的问题。

# events - Telerik winforms right-click -> paste event?

> ID：15966856
> 
> 赞同：1
> 
> 时间：2013-04-12T08:45:55.647
> 
> 标签：events, telerik, telerik-grid, copy-paste, radgridview

I need to do something when a cell is modified via pasted content, I don't seem to find any event that gets fired while/after text is pasted into the cell.

I have tried: ValueChanged CellValidating CellPaint CellValuePushed CellValueNeeded Validating

in a desperate attempt of finding out what fires, I know some of those events obviously won't fire.

My problem is that I can't seem to catch the event of paste, I would think and hope there IS an event linked to the action.

Using RadForms 2012Q3 RadGridView control.

Thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-16T13:38:47.937

我知道有点晚了，但是WPF中有三个：

*   已粘贴
*   粘贴
*   粘贴单元格剪贴板内容

我不知道WinForms是否不同......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-08T08:07:01.227

很抱歉加入晚会，使用 Telerik WinForms 来实现粘贴，例如，您有“粘贴”事件（[Telerik Copy/Past/Cut docs](https://docs.telerik.com/devtools/winforms/controls/gridview/copy-paste-cut)）

首先，调用对象上的事件：

```
yourGrid.Pasting += YourGrid_Pasting; 
```

然后检索值并使用它：

```
 private void YourGrid_Pasting(object sender, GridViewClipboardEventArgs e)
    {
        if (Clipboard.ContainsData(DataFormats.Text))
        {
            string data = Clipboard.GetData(DataFormats.Text).ToString();
            if (data != string.Empty)
            {
                // data is your copied text                    
            }
        }
    } 
```

# android - Posting on Facebook wall using Facebook SDK 3

> ID：15966857
> 
> 赞同：1
> 
> 时间：2013-04-12T08:45:59.447
> 
> 标签：android, facebook-graph-api, share

I have no idea why working with this sdk is so complex :(

In my application when user lunches the app for first time, then I get token and user Id.

```
public void OnFacebookLoginButtonClicked() {
        // start Facebook Login
        Session.openActiveSession(SplashScreen.this, true, new Session.StatusCallback() {
            // callback when session changes state
            @Override
            public void call(final Session session, SessionState state, Exception exception) {
                if (session.isOpened()) {
                    // make request to the /me API
                    Request.executeMeRequestAsync(session, new Request.GraphUserCallback() {

                        // callback after Graph API response with user object
                        @Override
                        public void onCompleted(GraphUser user, Response response) {
                            if (user != null) {
                                Log.i(TAG, "User name: " + user.getName() + "!, Login successfully :)");
                                Log.i(TAG, "User id: " + user.getId());
                                Log.i(TAG, "Access token is: " + session.getAccessToken());
                                Log.i(TAG, "Application id: " + session.getApplicationId());

                                SpStorage.setToken(SplashScreen.this, session.getAccessToken());
                                SpStorage.setFacebookUserId(SplashScreen.this, user.getId());

                                registerUser();
                            }
                        }
                    });
                }
            }
        });
    } 
```

It works fine without problem.

Somewhere else in my application (In a fragment), I need to share something on wall of user.

```
private void shareOnFacebook() {
        final Bundle params = new Bundle();

        params.putByteArray("message", "Test".getBytes());
        params.putByteArray("name", "American Virgin".getBytes());
        params.putByteArray("link", "http://bit.ly/12345".getBytes());
        params.putByteArray("description", "A Freshman College Girl on a scholarship from an ...".getBytes());
        params.putByteArray("picture", "http://xxx/MOV1026.jpg".getBytes());

        final Request postToWall = Request.newRestRequest(Session.getActiveSession(),
                "https://graph.facebook.com/<USER_ID>/feed", params, HttpMethod.POST);
        postToWall.setCallback( new Request.Callback() {
            @Override
            public void onCompleted(Response response) {
                Log.i(TAG, response.toString());

            }
        });
        Request.executeBatchAsync(postToWall);
    } 
```

However, my response is:

> 04-12 16:25:29.898: I/VenueFragment(29624): {Response: responseCode: 200, graphObject: null, error: {HttpStatus: 200, errorCode: 101, errorType: null, errorMessage: Invalid application ID.}, isFromCache:false}

Since, warning is saying Application id is not valid I tried following code but result was same.

```
final Request postToWall = Request.newRestRequest(Session.getActiveSession(),
                    "https://graph.facebook.com/APPLICATION_ID/feed", params, HttpMethod.POST); 
```

What do you think? Is it because of permission? If you know any weblog that explain same scenario please tell it to me. I read all content of [Facebook samples](https://developers.facebook.com/docs/howtos/androidsdk/3.0/publish-to-feed/) but all of them was base on Facebook login button. Please forget Facebook samples.

I have no idea why this simple thing is becoming so complex for me :(((((

# symfony - Symfony2 - modify form field with eventListener

> ID：15966859
> 
> 赞同：8
> 
> 时间：2013-04-12T08:46:11.227
> 
> 标签：symfony

I would like as for help. I have a form with dropdown list and I need to modify choices based on external input. I guess it should work well with eventListener

```
$builder->addEventListener(
            FormEvents::PRE_SET_DATA,
            function(FormEvent $event) use($input){
                $form = $event->getForm();

                // get existin form child
                // modify list of choices

            } 
```

All samples I have seen are using FormEvents only to add new field, but I need to modify existing field but I don't know how to access it.

thanks for help

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2015-09-16T13:37:31.323

虽然最初的问题相当老，但让我把它留在这里，以防其他人遇到需要更改字段的特定选项而不必再次复制所有选项：

```
<?php

$builder->addEventListener(FormEvents::PRE_SET_DATA, function (FormEvent $event) {
    $form = $event->getForm();

    // Get configuration & options of specific field
    $config = $form->get('field_to_update')->getConfig();
    $options = $config->getOptions();

    $form->add(
        // Replace original field... 
        'field_to_update',
        $config->getType()->getName(),
        // while keeping the original options... 
        array_replace(
            $options, 
            [
                // replacing specific ones
                'required' => false,
            ]
        )
    );
}); 
```

来源：[https ://github.com/symfony/symfony/issues/8513#issuecomment-21868035](https://github.com/symfony/symfony/issues/8513#issuecomment-21868035)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-29T00:12:59.057

你可以做的是覆盖原来的孩子。

```
$builder->addEventListener(
        FormEvents::PRE_SET_DATA,
        function(FormEvent $event) use($input){
            $form = $event->getForm();

            $form->add($this->factory->createNamed('name_to_override', 'choice', null,
                 array("choices" => array("choice"=>"value"))
                ));

        } 
```

它对我有用。

**注意：**这仅适用于 PHP 5.4，因为`$this`在 PHP 5.3 中不提供闭包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T15:15:50.420

这里有一篇博客文章通过整个动态表单来处理实体关系：[http ://aulatic.16mb.com/wordpress/2011/08/symfony2-dynamic-forms-an-event-driven-approach/](http://aulatic.16mb.com/wordpress/2011/08/symfony2-dynamic-forms-an-event-driven-approach/)

Symfony 网站也有这方面的大部分文档，您只需要编写上面博客文章中完成的 ajax 代码和相应的控制器方法：http: [//symfony.com/doc/current/cookbook/form/dynamic_form_modification.html](http://symfony.com/doc/current/cookbook/form/dynamic_form_modification.html)

# makefile - 为什么这个makefile不起作用？

> ID：15966861
> 
> 赞同：0
> 
> 时间：2013-04-12T08:46:13.350
> 
> 标签：makefile, gnu-make

我是 Makefiles 的新手，我正在尝试编写一个简单的文件，它可以编译和链接这样的变量中列出的所有应用程序：

```
APPLICATIONS = app1 app2 app3 
```

[它们都](http://www.gnu.org/software/make/manual/make.pdf)必须有一个源`.c`文件（

```
APPLICATIONS = one two three

DESTDIR=/home/carles/Develop/xenomai-2.5.6

TOOLCHAIN = arm-linux-gnueabi-gcc

OBJDIR      := bin
OBJS        := $(addprefix $(OBJDIR)/,$(addsuffix .o,$(APPLICATIONS)))
INCLUDE_PATH = $(DESTDIR)/usr/xenomai/include
CFLAGS       = -I$(INCLUDE_PATH) -D_GNU_SOURCE -D_REENTRANT -D__XENO__ -Wall -pipe
POSIX_CFLAGS = -I$(INCLUDE_PATH)/posix
LIB_PATH     = $(DESTDIR)/usr/xenomai/lib
LIBRARIES    = -lnative -lxenomai -lpthread -lrtdk -lrt
LDFLAGS      = $(LIBRARIES) -L$(LIB_PATH)
POSIX_LDFLAGS= -Wl,@$(LIB_PATH)/posix.wrappers -lnative -lpthread_rt -lxenomai -lpthread -lrt -L$(LIB_PATH) 

$(OBJDIR)/%.o : %.c
    @printf '------------------: $< -> $@ : '
    if [ $(TOOLCHAIN) $< -o $(OBJDIR)/$@ $(CFLAGS) $(LDFLAGS) -L$(LIB_PATH) ]
    then
        @echo 'done!'
    fi

all: $(OBJS) | show_config

$(OBJS): | $(OBJDIR)

$(OBJDIR):
    mkdir -p $(OBJDIR)

show_config:
    @echo '------------------: APPLICATIONS : $(APPLICATIONS)'
    @echo '------------------: DESTDIR      : $(DESTDIR)'
    @echo '------------------: INCLUDE PATH : $(INCLUDE_PATH)'
    @echo '------------------: LIB. PATH    : $(LIB_PATH)'
    @echo '------------------: TOOLCHAIN    : $(TOOLCHAIN)'
    @echo '------------------: LIBRARIES    : $(LIBRARIES)'
    @echo '------------------: OBJS         : $(OBJS)'

clean:
    @rm $(OBJDIR) -r -f 
```

当我运行时，`$ make`只创建了目录并`show_config`调用了，但没有创建目标文件，也没有显示错误。这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T13:05:48.303

你有两个规则：

```
$(OBJDIR)/%.o : %.c
    ...

$(OBJS): | $(OBJDIR) 
```

第一个是模式规则，第二个是常规规则。通常它们可以一起工作，但如果源文件 ( `one.c`, `two.c`, three.c`) 不存在，则第一条规则不适用，第二条规则要求构建目录，这就是你所得到的。您不妨将它们结合起来：

```
$(OBJDIR)/%.o : %.c | $(OBJDIR)
    ... 
```

或者更好：

```
$(OBJS): $(OBJDIR)/%.o : %.c | $(OBJDIR)
    ... 
```

一旦你把它理顺，你会发现另一个问题。此规则中的命令：

```
$(OBJDIR)/%.o : %.c
    @printf '------------------: $< -> $@ : '
    if [ $(TOOLCHAIN) $< -o $(OBJDIR)/$@ $(CFLAGS) $(LDFLAGS) -L$(LIB_PATH) ]
    then
        @echo 'done!'
    fi 
```

不要做你认为他们做的事。如果在您的 shell 中工作，第一个 ( `@printf ...`) 将工作；`printf`您应该对此进行测试，如果没有，请尝试`@echo ...`。接下来的四行显然是为了协同工作。但是在 Make 规则中，每一行本身就是一个命令，在它自己的子 shell 中运行，所以这种结构不起作用。您可以将整个内容放在一行中：

```
 if [ $(TOOLCHAIN) ... ]; then @echo 'done!'; fi 
```

**（注意分号。）**这是一条很长的线，所以如果眼睛很难看，您可以使用反斜杠将其分开来表示行继续：

```
 if [ $(TOOLCHAIN) $< -o $(OBJDIR)/$@ $(CFLAGS) $(LDFLAGS) -L$(LIB_PATH) ]; \
  then \
    @echo 'done!'; \
  fi 
```

（请注意，在 . 前面只需要一个 TAB `if`。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:17:45.383

它不起作用，因为文件`one.c`, `two.c`,`three.c`不存在，因此不必构建它们。

# haskell - Haskell中的并行单子映射？像 parMapM 这样的东西？

> ID：15966873
> 
> 赞同：12
> 
> 时间：2013-04-12T08:47:12.277
> 
> 标签：haskell, parallel-processing, monads, state-monad

我正在寻找一种在 ST-Monad 中并行运行两个计算的方法。我正在构建一个相当大的数组（使用 STUArray），我想并行进行。

到目前为止，我已经在 stackoverflow 上找到[了这个](https://stackoverflow.com/questions/5606165/parallel-map-in-haskell)和[这个](https://stackoverflow.com/questions/2233452/how-can-i-use-parmap-with-a-monadic-function)问答，但是第一个不适用于我的情况，因为它只处理纯代码，第二个处理 IO monad - 但我在一个状态线程中。

我还找到了[monad-parallel](http://hackage.haskell.org/packages/archive/monad-parallel/0.5.1/doc/html/Control-Monad-Parallel.html)包，但它要求我有一个 ST 的“MonadParallel”实例。[monad-par](http://hackage.haskell.org/packages/archive/monad-par/0.3.4.1/doc/html/Control-Monad-Par.html)包也只支持纯计算或 IO monad。

有没有办法在 ST 内部进行并行一元计算？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-12T11:45:01.673

首先，你的问题只有两个词：并行和数组 - 我必须建议你看看[**repa**](http://hackage.haskell.org/package/repa)。您还应该查看[**Data Parallel Haskell**](http://www.haskell.org/haskellwiki/GHC/Data_Parallel_Haskell)，因为它有望成为 Haskell 道路上的下一个重要里程碑，并且有[一些伟大的人参与](http://www.youtube.com/watch?v=NWSZ4c9yqW8)了这个项目。

关于您的具体问题，有些库能够完全按照您的要求完成，只需使用`IO`monad、已经命名的[**monad-parallel**](http://hackage.haskell.org/package/monad-parallel)和[**async** with`mapConcurrently`](http://hackage.haskell.org/packages/archive/async/2.0.1.4/doc/html/Control-Concurrent-Async.html#v:mapConcurrently)。您是否考虑过使用[`stToIO`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Control-Monad-ST.html#v:stToIO)逃到`IO`？

还有一个[**提升的异步**](http://hackage.haskell.org/package/lifted-async)库，它扩展了标准版本以使用[`MonadBaseControl`](http://hackage.haskell.org/packages/archive/monad-control/0.3.1/doc/html/Control-Monad-Trans-Control.html#t:MonadBaseControl)，它有一个实例`ST`，所以你可以使用它的版本，`mapConcurrently`或者至少使用它作为实现你自己的灵感。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T09:36:17.113

我不确定您是否可以安全地并行化 ST monad，或者这是否有意义，因为通常情况下，状态 monad 中的计算取决于状态，这是先前计算的结果。

但是，您可以做的是从列表中创建数组，并且列表创建很容易并行，例如通过类似[并行](http://hackage.haskell.org/package/parallel)包`parMap`的东西。

向我们提供有关如何创建数组数据的更多详细信息可能有助于为您提供更好的答案。

# android - How to get View in SimpleOnGestureListener

> ID：15966874
> 
> 赞同：0
> 
> 时间：2013-04-12T08:47:23.063
> 
> 标签：android

I have a class:

```
class MyGestureDetector extends SimpleOnGestureListener {

    @Override

    public void  onLongPress(MotionEvent e) {
   //Do something
    }
 } 
```

How can I get View of wiget, which was longpressed (in my case it's Item in Listview).

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:53:00.517

改为使用`[OnItemLongClickListener](https://developer.android.com/reference/android/widget/AdapterView.OnItemLongClickListener.html)`。

# c++ - 为什么这段代码（malloc）不会产生堆损坏？

> ID：15966877
> 
> 赞同：1
> 
> 时间：2013-04-12T08:48:02.433
> 
> 标签：c++, heap-memory, heap-corruption

```
#include <iostream>

using namespace std;

struct A
{
    int a, b;
};

struct B
{
    int a;
};

int main()
{
    A * pa = (A *)malloc(sizeof(B));
    int c = 5;
    pa -> a = 3;
    cout << pa -> a << endl;
    pa -> b = 0;
    cout << pa -> b << endl;
    cout << c << endl;
    return 0;
} 
```

我使用 VC++ 2012 运行此代码。它不会生成任何错误消息。

我认为 pa -> b 将访问内存块出站。应该发生堆损坏！但实际上，调试和发布模式都没有发生任何事情。

但是由于 int c 紧跟在 A * pa 之后；我认为在内存中，pa -> b 将访问 int c。

程序的输出是：3 4 5

谁能帮忙解释一下？

* * *

如果我添加“免费（pa）；” 在main的最后：+debug模式下，会导致HEAP CORRUPTION ERROR。+在释放模式下，仍然没有任何反应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T09:06:03.100

[未定义的行为](http://en.wikipedia.org/wiki/Undefined_behavior)意味着任何事情都可能发生。特别是，不需要诊断。

查找此类错误的一种实用方法是使用[Valgrind](http://valgrind.org/)之类的工具：

```
$ valgrind ./a.out
a=3
==37240== Invalid write of size 4
==37240==    at 0x100000E1D: main (test.c:22)
==37240==  Address 0x10001b184 is 0 bytes after a block of size 4 alloc'd
==37240==    at 0x5237: malloc (in /usr/local/Cellar/valgrind/3.8.1/lib/valgrind/vgpreload_memcheck-amd64-darwin.so)
==37240==    by 0x100000DD2: main (test.c:19)
==37240== 
==37240== Invalid read of size 4
==37240==    at 0x100000E28: main (test.c:23)
==37240==  Address 0x10001b184 is 0 bytes after a block of size 4 alloc'd
==37240==    at 0x5237: malloc (in /usr/local/Cellar/valgrind/3.8.1/lib/valgrind/vgpreload_memcheck-amd64-darwin.so)
==37240==    by 0x100000DD2: main (test.c:19)
==37240== 
```

Windows 也有类似的工具：[有没有很好的 Valgrind 替代 Windows？](https://stackoverflow.com/questions/413477/is-there-a-good-valgrind-substitute-for-windows)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:02:20.213

只有当您输入一些堆函数时，才能检测到堆损坏。在这种情况下，您只在开始时输入堆函数，此时堆仍未损坏。`pa`在返回之前尝试删除指向的结构`main`，看看会发生什么。

# mongodb - 使用 mongodb-odm 在 @Hash 字段类型中查找值

> ID：15966883
> 
> 赞同：1
> 
> 时间：2013-04-12T08:48:20.563
> 
> 标签：mongodb, symfony-2.1, doctrine-odm

我对 mongoDb 真的很陌生，但我遇到了问题。

我在一个集合中有这个字段：

```
data: [ "data1", "data2" ] 
```

为什么通过控制台进行此查询有效：

db.collection.find({'data': /data1/})

但这不是吗？

```
 $hasData = $this->documentManager->createQueryBuilder('Document\\Collection')
        ->field('data')->equals( new \MongoRegex('/data1/'))
        ->count()
        ->getQuery()
        ->execute(); 
```

我哪里错了？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T09:00:30.450

我已经通过添加另一个歧视来解决：

```
$hasData = $this->documentManager->createQueryBuilder('Document\\Collection')
        ->field('data')->equals( new \MongoRegex('/data1/'))
        ->field('_id')->equals(new \MongoId($user->getId()))
        ->count()
        ->getQuery()
        ->execute(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-27T13:59:39.917

尝试向该字段添加一个 elemMatch() 表达式。

```
->field('my_field')->elemMatch($qb->expr()->field('data')->equals('data1')) 
```

# extjs - extjs - 无法在网格中添加过滤器

> ID：15966886
> 
> 赞同：2
> 
> 时间：2013-04-12T08:48:31.897
> 
> 标签：extjs, filter, grid

我正在尝试做简单的事情，但不知何故它不适合我，在我的网格表中我想添加客户端过滤器（在列中），我尝试了一切并遵循[http://docs.sencha.com/上的代码ext-js/4-0/#!/api/Ext.ux.grid.FiltersFeature](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.ux.grid.FiltersFeature)

我的代码是，

```
var filtersCfg = {
        ftype: 'filters',
        local: true,
        filters: [{
                type: 'string',
                dataIndex: 'Stage'
            }, {
                type: 'string',
                dataIndex: 'Type'
            }]
    };

//grid
var grid =   Ext.create('Ext.grid.Panel', {
        renderTo: Ext.getElementById("leftPanel"),
        store: myStore,
        height: 300,
        filters : [filtersCfg],
        title: "grid view",

        columns: [
             {
                text: 'App',
                sortable: true,
                filterable: true,
                dataIndex: 'Stage'
            },
            {
                text: 'Stage',
                sortable: true,
                filterable: true,
                dataIndex: 'Type',                    
            } 
```

......

点击列排序选项，但没有过滤选项

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T09:46:19.830

您可以使用`Ext.require`.

```
Ext.Loader.setConfig({
    enabled: true,
    paths: {
        'Ext.ux': './ext/ux'
    }
});

Ext.require([
    'Ext.ux.grid.FiltersFeature'
]); 
```

FiltersFeature.js 位于内部`examples\ux\grid`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T12:03:52.070

嗨@A1rPun 我发现我的一些文件已损坏，当我复制新的文件时它起作用了，我认为你的答案是完美的，我们不需要任何 feature/filters.js 文件，只是 extjs 在控制台中抛出了某种错误的错误

# php - 序列号更新和数据库

> ID：15966887
> 
> 赞同：-1
> 
> 时间：2013-04-12T08:48:31.857
> 
> 标签：php, database, wamp

我在数据库中插入了 serail_number 列。当我删除用户时，序列号不会**更新**。删除前，列值：1 2 3 4 以此类推。删除后，列值::: 1 3 4 等等..
我希望它像：删除后，列值：.. 1 2 3 我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:53:08.190

您可以在数据库上创建一个过程。请参阅[stackoverflow.com/q/11739793/1065251](https://stackoverflow.com/q/11739793/1065251)这将删除您的记录并将 auto_increment 设置为可能的最高值。

# php - 登录 phpmyadmin 时出错？

> ID：15966888
> 
> 赞同：0
> 
> 时间：2013-04-12T08:48:39.460
> 
> 标签：php, mysql, sql, phpmyadmin, mysqli

当我使用我的 godaddy 帐户登录到我的数据库时，我收到此错误：

```
Error
#1135 - Can't create a new thread (errno 11); if you are not out of available memory, you can consult the manual for a possible OS-dependent bug 
```

当我尝试连接到我的数据库时，我也会收到此错误。它曾经工作正常，但我添加了另一个表，然后我开始收到此错误。我想我在创建表格时搞砸了。我该如何解决这个问题？phpmyadmin 不让我登录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T16:21:06.603

联系 Godaddy 帮助台。

作为一种解决方法，您可以尝试上传删除相应数据库的 PHP 脚本，然后从浏览器导航到该 PHP。它被执行并消除了数据表......但你不会更接近知道真正的问题是什么。

# powerbuilder - 在 PowerBuilder 中插入行

> ID：15966889
> 
> 赞同：0
> 
> 时间：2013-04-12T08:48:39.467
> 
> 标签：powerbuilder, insertion, datawindow

实际上，我需要验证 DataWindow 控件中新插入的行中的空列。我尝试使用 ItemFocusChanged 事件脚本如下

```
if dwo.name="emp_name" then
    if dw_1.GetItemString(row,"emp_no")= '' then
        MessageBox("E-Ledger","Enter Employee Number")
        dw_1.SetColumn("emp_no")
    end if
end if 
```

但它没有发生。在保存时我尝试了

```
if dw_1.GetItemString(ll_row,"emp_no")= '' then
    MessageBox("E-Ledger","Enter Employee Number")
    dw_1.SetColumn("emp_no")
    return
end if 
```

这也没有发生。请帮助我在 ItemFocusChanged 和保存新插入的行时进行验证。谢谢各位朋友……PVP

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T13:25:25.447

1.  最好在保存之前验证必填字段。我们必须允许用户将焦点从空的必填字段移开——也许，用户希望在填充其他字段后稍后填充它。

2.  必填字段验证是非常常见的任务。它应该由框架自动执行，无需为每个字段编写检查。

3.  如果您仍想在焦点更改时验证空的必填字段，那么最好编写 ItemFocusChanging 脚本，而不是 ItemFocusChanged。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:24:42.163

调用时不会触发 ItemFocusChanged 事件`InsertRow()`，因为`InsertRow()`不会更改当前行。您可以调用[`SetRow()`](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc37783.1250/html/dwref/CCJDFFCD.htm)使其成为当前行，或者[`ScrollToRow()`](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc37783.1250/html/dwref/CCJBHFDGdw.htm)同时使其成为当前行并将其滚动到视图中。

验证的逻辑位置`itemchanged`通常是事件。这将在列失去焦点或手动使用该[`AcceptText()`](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc37783.1250/html/dwref/CAIDFCBI.htm)功能时触发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T16:04:32.047

我认为 ItemFocusChanged 是测试此验证的错误事件，因为如果我单击 emp_no 字段，则此逻辑将永远不会执行。

您没有提到调试中可能会缩小范围的任何保存脚本观察结果，但作为一个疯狂的猜测，我猜此时 emp_no 的实际值为 NULL（可能是列上的 NilIsNull 属性），其中不会通过您编写的测试。你想要的东西更像

```
ls_Value = dw_1.GetItemString(ll_row,"emp_no")
if (ls_Value = '') or IsNull (ls_Value) then
... 
```

并不是说这会处理您在该字段中放置空格，但如果这是要求，您可能可以处理。

祝你好运，

特里。

# c# - 在 Web API Post 方法中序列化 JSON 时出现“内部服务器错误”

> ID：15966895
> 
> 赞同：1
> 
> 时间：2013-04-12T08:49:01.740
> 
> 标签：c#, asp.net-mvc, json, asp.net-web-api, httpclient

我有一个使用 ASP.NET Web API 与客户端通信的服务器。

我在服务器端的模型更详细，客户端的数据更少，所以我使用 [DataContract]/[DataMember] 来匹配两者。

这是服务器端的模型：

```
[DataContract]
public class Discussion
{
    public Discussion()
    {
        this.Posts = new HashSet<Post>();
        this.Members = new HashSet<UserProfile>();
    }

    [DataMember]
    public int DiscussionId { get; set; }

    [DataMember]
    public int AuthorId { get; set; }

    public int CategoryId { get; set; }

    [Required]
    [MinLength(4)]
    [MaxLength(140)]
    [DataMember]
    public string DiscussionSubject { get; set; }

    [Required]
    [MinLength(10)]
    [MaxLength(10000)]
    [DataMember]
    public string DiscussionDescription { get; set; }

    [Required]
    [DataMember]
    public DateTime CreateDate { get; set; }

    [Required]
    [DataMember]
    public DateTime LastChangeDate { get; set; }

    [NotMapped]
    [DataMember]
    public int NumberOfPosts { get { return Posts.Count; } }

    [DataMember]
    public virtual UserProfile Author { get; set; }

    public virtual Category Category { get; set; }

    public virtual ICollection<UserProfile> Members { get; set; }

    public virtual ICollection<Post> Posts { get; set; }
} 
```

这是客户端模型：

```
[DataContract]
public class Discussion
{
    [DataMember]
    public int DiscussionId { get; set; }

    [DataMember]
    public int AuthorId { get; set; }

    [DataMember]
    public string DiscussionSubject { get; set; }

    [DataMember]
    public string DiscussionDescription { get; set; }

    [DataMember]
    public DateTime CreateDate { get; set; }

    [DataMember]
    public DateTime LastChangeDate { get; set; }

    [DataMember]
    public int NumberOfPosts { get; set; }

    [DataMember]
    public virtual UserProfile Author { get; set; }
} 
```

现在，当我发送一个发布请求时，我得到一个内部服务器错误，并且在我调试时甚至没有到达 Post 方法点

```
Discussion discussion = new Discussion
{
    DiscussionSubject = subject,
    DiscussionDescription = description,
};

response = await client.PostAsJsonAsync(requestUri, discussion);
response.EnsureSuccessStatusCode(); 
```

我想问题在于反序列化，因为当我将模型更改为另一个模型时，它很好。很高兴知道当我发送`Get`请求时，一切都正常。

**我该如何解决这个问题，我在哪里可以看到确切的内部服务器错误是什么？**

**编辑：**这是服务器端的 Post 方法：

```
public HttpResponseMessage Post(Discussion discussion) 
```

我希望反序列化在这里自动发生（从接收到的客户端到`Discussion`服务器`Discussion`）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T13:59:39.603

我怀疑你的对象图中有循环引用，显然不能被 JSON 序列化。因此，您的 HTTP 请求永远不会发送到服务器，因为客户端不知道如何 JSON 序列化您的模型。

例如，如果您的`UserProfile`模型引用了该`Discussion`模型，则可能会发生这种情况。而且由于`Discussion`模型引用了`UserProfile`模型，因此您遇到了问题。

要解决此问题，您应该使用视图模型，而不是在 Web API 中公开您的域模型。

# javascript - 你可以在javascript中重载运算符new吗？它会做什么？

> ID：15966896
> 
> 赞同：0
> 
> 时间：2013-04-12T08:49:02.300
> 
> 标签：javascript, function, new-operator

我正在尝试让一个网站在 ie8 上运行。

我找到了以下js代码：

```
var autocompleteAddressController=(function(){
  var my={};
  //...

  my.new=function(val){
    //...
  };
}); 
```

在另一个文件中：

```
var address = autocompleteAddressController.new("#user_address_name"); 

//... 
```

这在最近的浏览器（chrome 和 safari）中运行良好

但它在ie8上中断。我猜 ie8 的 javascript 解析器不支持我们为自定义函数使用保留名称“new”，所以在控制台中我有错误：`expected identifier`在那些表达式上：`my.new=function`和`autocompleteAddressController.new`.

*   你应该这样做吗？
*   它会覆盖`new`运算符还是只是在对象上创建一个函数，就像我在示例中使用的那样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T08:51:36.200

> 它会覆盖`new`运营商吗

不可以。您不能覆盖 JavaScript 中的运算符。

代码所做的只是创建一个`my`恰好具有标识符的方法`new`。这在所有环境中都有效，但仅在 ES5 中通过点符号使用保留字作为属性标识符才有效。您可以使用方括号使其在 IE8 和其他非 ES5 环境中工作：

```
my["new"] = function (val) { /*...*/ }

// And in your other file...

var address = autocompleteAddressController["new"]("#user_address_name"); 
```

* * *

**更新**

稍微扩展一下，这里是 ES5 语法的相关部分。首先，这是[*标识符*生产](http://es5.github.com/#x7.6)：

> *标识符*::
>     *IdentifierName*但不是*ReservedWord*

请注意，标识符不能是保留字（`new`是保留字）。*IdentifierName*产生式只是指定标识符中允许的字符（没有基于保留字的限制）。

[以下是“对象初始化器](http://es5.github.com/#x11.1.5)”（对象字面量）中属性的语法：

> *PropertyName* :
>     *IdentifierName*
>     *StringLiteral*
>     *NumericLiteral*

请注意，它指的是*IdentifierName*，而不是*Identifier*。这是允许使用保留字作为属性标识符的产品。

最后，将该产品与[旧版 ES3 规范](http://www.ecma-international.org/publications/files/ECMA-ST-ARCH/ECMA-262,%203rd%20edition,%20December%201999.pdf)中的产品进行比较：

> *PropertyName* :
>     *标识符*
>     *StringLiteral*
>     *NumericLiteral*

这一次，它使用*Identifier*，而不是*IdentifierName*。由于*标识符*产品不允许使用保留字，因此代码在 ES3 环境中无效。

# wordpress - 用于将自定义字段添加到菜单的 Wordpress 插件

> ID：15966899
> 
> 赞同：0
> 
> 时间：2013-04-12T08:49:12.497
> 
> 标签：wordpress, custom-fields

谁能告诉我是否有一个 Wordpress 插件可以让您自定义菜单字段。

我创建了四个自定义字段：

版本 作者姓名 年份 组别

我希望能够在菜单中显示这些字段的内容。单击将引导您进入该页面。

# php - 如何在 mongodb 查询中使用 mysql 中的数组？

> ID：15966900
> 
> 赞同：0
> 
> 时间：2013-04-12T08:49:12.560
> 
> 标签：php, mysql, mongodb

我搜索 mysql db 并将结果放入 php 数组 ($ID)。

```
 $ID=array();

 while($Rlist=mysql_fetch_array($query_result)){
            $ID[] = $Rlist['ids'];                  
 } 
```

我喜欢在 mongodb 查询中使用 ID 数组。

```
 $list=$collection->find(array("id"=>array('$in'=>[$ID])), array("title" => 1, "detail" => 1, "logo" => 1  ))->limit(50); 
```

你可能会问，我没有成功。我们如何解决这个问题？

更新：这里的问题，php数组格式是：

```
$ID="1,2,3,4"; 
```

但 mongodb 需要如下格式：

```
$ID='1','2','3','4'; 
```

更新 var_dump($ID);

数组（20）{[0]=>字符串（3）“502”[1]=>字符串（4）“1643”[2]=>字符串（4）“3342”[3]=>字符串（4） "6948" [4]=> 字符串(4) "8582" [5]=> 字符串(4) "9420" [6]=> 字符串(5) "10293" [7]=> 字符串(5) "11014 " [8]=> 字符串(5) "12331" [9]=> 字符串(5) "13874" [10]=> 字符串(5) "19430" [11]=> 字符串(5) "48789" [ 12]=>字符串（5）“67190”[13]=>字符串（6）“191315”[14]=>字符串（6）“293354”[15]=>字符串（6）“390314”[16] =>字符串（6）“500715”[17]=>字符串（6）“504151”[18]=>字符串（6）“742853”[19]=>字符串（6）“913465”}

# c# - 使用静态变量的并发

> ID：15966903
> 
> 赞同：5
> 
> 时间：2013-04-12T08:49:28.167
> 
> 标签：c#, concurrency, static

在下面的代码中，如果`GetNextNumber()`两个线程同时调用它，它是否可能向两个线程返回相同的数字？

```
class Counter
{
 private static int s_Number = 0;
 public static int GetNextNumber()
 {
  s_Number++;
  return s_Number;
 }
} 
```

你能解释一下为什么吗？

编辑：如果代码有可能向两个线程返回相同的数字，那么以下是否正确？假设两个线程在等于2`GetNextNumber()`时调用`s_Number`。如果返回相同的值，则该值只能是4。不能是3。对吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-12T08:58:53.300

在处理这样一个简单的计数器时，最好使用[`Interlocked.Increment`](http://msdn.microsoft.com/en-us/library/dd78zt0c.aspx)：

```
private static int s_Number = 0;

public static int GetNextNumber()
{
    return Interlocked.Increment(ref s_Number);
} 
```

这将确保每个线程将返回一个唯一值（只要数字不溢出），并且不会丢失任何增量。

由于原始代码可以分解为以下步骤：

1.  读取现有值`s_Number`
2.  加1
3.  将新值存储到`s_Number`
4.  读`s_Number`
5.  返回读取值

可能发生的场景有：

1.  两个线程在其余线程之前执行第 1 步，这意味着两个线程将读取相同的现有值，递增 1，最终得到相同的值。**失去一个增量**
2.  线程可以在没有冲突的情况下执行步骤 1 到 3，但在两个线程都更新了变量并检索到相同的值之后最终执行步骤 4。**跳过了一个数字**

对于需要*原子*访问更多数据的较大代码段，`lock`语句通常是更好的方法：

```
private readonly object _SomeLock = new object();

...

lock (_SomeLock)
{
    // only 1 thread allowed in here at any one time
    // manipulate the data structures here
} 
```

但是对于这样一段简单的代码，您需要做的就是原子地增加一个字段并检索新值，`Interlocked.Increment`这是更好、更快、更少的代码。

类中还有其他方法[`Interlocked`](http://msdn.microsoft.com/en-us/library/5kczs5b5.aspx)，它们在处理的场景中非常方便。

更详细的解释*丢了一个增量*。

让我们假设`s_Number`在两个线程执行之前从 0 开始：

```
Thread 1                            Thread 2
Read s_Number = 0
                                    Read s_Number = 0
Add 1 to s_Number, getting 1
                                    Add 1 to s_Number, getting 1 (same as thread 1)
Store into s_Number (now 1)
                                    Store into s_Number (now 1)
Read s_Number = 1
                                    Read s_Number = 1
Return read value (1)
                                    Return read value (1) 
```

正如您在上面看到的，最终值`s_Number`应该是 2，其中一个线程应该返回 1，另一个应该返回 2。相反，最终值是 1，两个线程都返回 1。您在这里丢失了一个增量。

跳号详解

```
Thread 1                            Thread 2
Read s_Number = 0
Add 1 to s_Number, getting 1
Store into s_Number (now 1)
                                    Read s_Number = 1
                                    Add 1 to s_Number, getting 2
                                    Store into s_Number (now 2)
Read s_Number = 2
                                    Read s_Number = 2
Return read value (2)
                                    Return read value (2) 
```

这里的最终结果`s_Number`将是 2，这是正确的，但是其中一个线程应该返回 1，而不是它们都返回了 2。

让我们看看原始代码在 IL 级别上的样子。我会将原始代码添加到带有注释的 IL 指令中

```
// public static int GetNumber()
// {
GetNumber:
//     s_Number++;
IL_0000:  ldsfld      UserQuery.s_Number    // step 1: Read s_Number
IL_0005:  ldc.i4.1                          // step 2: Add 1 to it
IL_0006:  add                               //         (part of step 2)
IL_0007:  stsfld      UserQuery.s_Number    // step 3: Store into s_Number
// return s_Number;
IL_000C:  ldsfld      UserQuery.s_Number    // step 4: Read s_Number
IL_0011:  ret                               // step 5: Return the read value
// } 
```

注意，我使用[LINQPad](http://linqpad.net)来获取上面的 IL 代码，启用优化（右下角的小 /o+），如果你想玩代码看看它是如何转换成 IL 的，请下载 LINQPad 并将其提供给这个程序：

```
void Main() { } // Necessary for LINQPad/Compiler to be happy

private static int s_Number = 0;
public static int GetNumber()
{
    s_Number++;
    return s_Number;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-12T08:54:42.033

是的，这是一个场景：

s_number = 0

`Thread A`做`s_number ++`

s_number = 1

`Thread B`做`s_number ++`

s_number = 2

`Thread A`做`return s_number`

`Thread B`做`return s_number`

两个线程都返回 2。

* * *

因此，您应该实现这样的锁定机制：

```
class Counter
{
    private static int s_Number = 0;
    private static object _locker = new object();
    public static int GetNextNumber()
    {
        //Critical section
        return Interlocked.Increment(ref s_Number);
    }
} 
```

锁定机制将防止多个线程同时进入您的临界区。如果您有比简单增量更多的操作，请改用`Lock`块。

编辑：Lasse V. Karlsen 写了一个更深入的答案，解释了更多的低级行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T08:57:34.900

`GetNextNumber`如果我们查看`IL code`为您的类方法生成的方法，很容易看出为什么当两个线程尝试同时访问该方法时可能获得相同的数字

```
class Counter
{
    private static int s_Number = 0;
    public static int GetNextNumber()
    {
        s_Number++;
        return s_Number;
    }
} 
```

下面是生成的 IL 代码，正如您所见，`s_number++`它实际上由三个独立的指令组成，两个线程可以同时访问这些指令，从而获得相同的初始值。

```
Counter.GetNextNumber:
IL_0000:  ldsfld      UserQuery+Counter.s_Number
IL_0005:  ldc.i4.1    
IL_0006:  add         
IL_0007:  stsfld      UserQuery+Counter.s_Number
IL_000C:  ldsfld      UserQuery+Counter.s_Number
IL_0011:  ret 
```

**这是导致两个线程的值相同的场景**

输入并获取 s_Number (IL_0000)的`thread A`值，它加载值 1，但此时，处理器暂停`thread A`并启动`thread B`. 当然，存储在定义的内存位置中的值`s_number`仍然是 0，线程 B 以线程 A 使用的相同值开始。它返回 1。当线程 A 恢复时，它的寄存器恢复为暂停时的状态，所以它将 1 加到 0 并返回与线程 B 相同的结果。

这个类使用lock关键字来阻塞并发

```
class CounterLocked
{
 private static object o;
 private static int s_Number = 0;
 public static int GetNextNumber()
 {
  lock(o)
  {
    s_Number++;
    return s_Number;
  }
 }
}

CounterLocked.GetNextNumber:
IL_0000:  ldc.i4.0    
IL_0001:  stloc.0     // <>s__LockTaken0
IL_0002:  ldsfld      UserQuery+CounterLocked.o
IL_0007:  dup         
IL_0008:  stloc.2     // CS$2$0001
IL_0009:  ldloca.s    00 // <>s__LockTaken0
IL_000B:  call        System.Threading.Monitor.Enter
IL_0010:  ldsfld      UserQuery+CounterLocked.s_Number
IL_0015:  ldc.i4.1    
IL_0016:  add         
IL_0017:  stsfld      UserQuery+CounterLocked.s_Number
IL_001C:  ldsfld      UserQuery+CounterLocked.s_Number
IL_0021:  stloc.1     // CS$1$0000
IL_0022:  leave.s     IL_002E
IL_0024:  ldloc.0     // <>s__LockTaken0
IL_0025:  brfalse.s   IL_002D
IL_0027:  ldloc.2     // CS$2$0001
IL_0028:  call        System.Threading.Monitor.Exit
IL_002D:  endfinally  
IL_002E:  ldloc.1     // CS$1$0000
IL_002F:  ret 
```

为 InterlockIncrement 生成的代码非常简单

```
public static int GetNextNumber()
{
    return Interlocked.Increment(ref s_Number);
}

CounterLocked.GetNextNumber:
IL_0000:  ldsflda     UserQuery+CounterLocked.s_Number
IL_0005:  call        System.Threading.Interlocked.Increment
IL_000A:  ret 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T08:57:17.743

返回 Interlocked.Increment(ref s_Number);

这会做到的。它比使用锁要简单得多。通常，锁定块应该主要用于代码块。

# resharper - Resharper 将 NSubstitute 方法显示为错误

> ID：15966904
> 
> 赞同：0
> 
> 时间：2013-04-12T08:49:30.373
> 
> 标签：resharper, nsubstitute

我们已经使用 VS2012 升级到 Resharper 7.1。然而，Resharper 似乎将 NSubstitute 方法显示为红色，如下图所示，使用 Arg.Any<>：

![在此处输入图像描述](https://i.stack.imgur.com/MLOHz.png)

有谁知道如何解决这个问题？注意：代码编译成功，只是 resharper 的显示就是问题所在。

干杯，比利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T12:04:46.787

清除 ReSharper 缓存应该可以解决问题。只需转到 ReSharper > 选项 > 环境 > 常规 > 清除缓存

![在此处输入图像描述](https://i.stack.imgur.com/RpM5c.png)

# sqlite - 适用于 Windows Phone 8 的 SQLite 数据库，可支持任何 CPU

> ID：15966906
> 
> 赞同：1
> 
> 时间：2013-04-12T08:49:41.373
> 
> 标签：sqlite, windows-phone-8

我正在为 Windows Phone 8 使用 Sqlite 数据库版本 3.7.15，但问题是它只支持 x86 CPU 配置。是否有其他选项可以支持 Windows Phone 8 的任何 CPU 配置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T14:46:35.210

假设您的意思是[Sqlite-net-wp8](https://github.com/peterhuene/sqlite-net-wp8)，那么它包含一个为 x86 或 ARM 平台构建的本机组件。

您必须使用 ARM 构建才能在设备上运行，而 x86 构建才能在模拟器上运行。由于本机代码，您不能使用 AnyCPU 构建。

# javascript - Fine Uploader 和 ServiceStack 设置响应头

> ID：15966915
> 
> 赞同：2
> 
> 时间：2013-04-12T08:50:02.163
> 
> 标签：javascript, file-upload, servicestack, fine-uploader

我正在尝试使用 ServiceStack 作为 Fine Uploader 的端点来上传一些文件。如果将响应设置为内容类型 json/application 即提示下载响应响应，则 IE 会出现令人讨厌的行为，如下所述：

[IE 在提交包含文件的 jQuery 多部分表单数据时尝试下载 json 响应](https://stackoverflow.com/questions/8151138/ie-jquery-form-multipart-json-response-ie-tries-to-download-response)

如何强制 ServiceStack 以文本/纯文本形式响应。我正在尝试这个：

```
 public class UploadFileService : Service
    {
        [AddHeader(ContentType = "text/plain")]
        public object Any(UploadFile request)
        {
            foreach (var uploadedFile in base.RequestContext.Files)
            {
                var test = uploadedFile.FileName;
            }
            return new UploadFileResponse{ Success = true};
        }
    } 
```

但是使用端点时的服务堆栈：

```
/api/UploadFile?format=json 
```

仍将内容类型返回为 application/json

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T13:39:00.837

如果您只想返回一个`plain/text`字符串，则还需要返回一个字符串[，如本例所示](https://github.com/ServiceStack/ServiceStack.UseCases/blob/master/HelloWorld/Global.asax.cs#L75)。因为它是一个 POCO 对象，所以您首先要对其进行序列化（假设为 JSON）：

```
public class UploadFileService : Service
{
    [AddHeader(ContentType = "text/plain")]
    public object Any(UploadFile request)
    {
        foreach (var uploadedFile in base.RequestContext.Files)
        {
            var test = uploadedFile.FileName;
        }
        var dto = new UploadFileResponse { Success = true };
        return dto.ToJson();           
    }
} 
```

否则，您可以直接返回字符串文字，例如：

```
return "{Success:true}"; 
```

# c++ - 对 32 位整数中设置位的计数方法说明

> ID：15966920
> 
> 赞同：2
> 
> 时间：2013-04-12T08:50:10.997
> 
> 标签：c++, c, algorithm, bit-manipulation

[在此链接](http://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetTable)中查看设置位计数的方法，我发现了以下方法

作者说：

> 对 32 位整数 v 中的位数进行计数的最佳方法如下：

```
v = v - ((v >> 1) & 0x55555555);                    // reuse input as temporary
v = (v & 0x33333333) + ((v >> 2) & 0x33333333);     // temp
c = ((v + (v >> 4) & 0xF0F0F0F) * 0x1010101) >> 24; // count 
```

> 最好的位计数方法只需要 12 次操作，这与查找表方法相同，但避免了表的内存和潜在的缓存未命中。它是上述纯并行方法和使用乘法的早期方法（在使用 64 位指令计数位的部分）之间的混合，尽管它不使用 64 位指令。字节中设置的位计数是并行完成的，并且通过乘以 0x1010101 并右移 24 位来计算字节中设置的位的总和。

任何解释这种方法如何计算设置位？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T10:12:50.893

它之所以有效，是因为您可以通过分成两半来计算设置位的总数，计算两半中设置位的数量，然后将它们相加。也称为`Divide and Conquer`范式。让我们详细了解一下。。

```
v = v - ((v >> 1) & 0x55555555); 
```

两位中的位数可以是`0b00`，`0b01`或`0b10`。让我们尝试在 2 位上解决这个问题..

```
 ---------------------------------------------
 |   v    |   (v >> 1) & 0b1010   |   v - x   |
 ---------------------------------------------
   0b00           0b00               0b00   
   0b01           0b00               0b01     
   0b10           0b01               0b01
   0b11           0b01               0b10 
```

这是所需要的，最后一列显示每两位对中设置位的计数。如果这两位数字是`>= 2 (0b10)`然后`and`产生`0b01`，否则它产生`0b00`。

```
v = (v & 0x33333333) + ((v >> 2) & 0x33333333); 
```

这句话应该很容易理解。在第一次操作之后，我们得到了每两位中设置位的计数，现在我们将每 4 位中的计数相加。

```
v & 0b11001100         //masks out even two bits
(v >> 2) & 0b11001100  // masks out odd two bits 
```

然后我们总结上面的结果，给出 4 位中设置位的总数。最后一条语句是最棘手的。

```
c = ((v + (v >> 4) & 0xF0F0F0F) * 0x1010101) >> 24; 
```

让我们进一步打破它..

```
v + (v >> 4) 
```

它与第二条语句类似，我们改为以 4 个为一组来计算设置位。我们知道，由于我们之前的操作，每个半字节都有设置位的计数。让我们看一个例子，假设我们有 byte `0b01000010`。这意味着第一个半字节设置了 4 位，第二个半字节设置了 2 位。现在我们将这些半字节加在一起。

```
0b01000010 + 0b01000000 
```

它在第一个半字节中为我们提供了一个字节中设置位的计数，`0b01100010`因此我们屏蔽了该数字中所有字节的最后四个字节（丢弃它们）。

```
0b01100010 & 0xF0 = 0b01100000 
```

现在每个字节都有设置位的计数。我们需要把它们加在一起。诀窍是将结果乘以`0b10101010`具有有趣属性的结果。如果我们的数字有四个字节 ，`A B C D`它将产生一个包含这些字节的新数字`A+B+C+D B+C+D C+D D`。一个 4 字节的数字最多可以设置 32 位，可以表示为`0b00100000`.

我们现在需要的是第一个字节，它具有所有字节中所有设置位的总和，我们得到它 `>> 24`。该算法是为`32 bit`单词设计的，但可以很容易地针对`64 bit`单词进行修改。

# objective-c - How to fill keywords field for MacOSX app, coded in Xcode?

> ID：15966923
> 
> 赞同：4
> 
> 时间：2013-04-12T08:50:23.947
> 
> 标签：objective-c, xcode, macos, keyword

How is it possible to fill some text in MacOSX Get Info screen's keywords field? For example, Contacts app there has keywords "Address Book" - how is it possible to do it from XCode? ![enter image description here](https://i.stack.imgur.com/hV2yH.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T09:01:06.363

You can add an `MDItemKeywords` entry in your `Info.plist`. It seems that this is only used if you also have this entry in the localized `InfoPlist.strings` file however.

# ruby-on-rails - 循环遍历 View 中的对象列表并使用单个 <%= 打印值

> ID：15966926
> 
> 赞同：0
> 
> 时间：2013-04-12T08:50:29.157
> 
> 标签：ruby-on-rails, loops

我正在使用我的以下代码循环遍历对象列表`View`：

```
<% @myquiz.each do |x| %>
    <div id="myDiv">
        <%= x.quiz_ID %>
    </div>
<% end %> 
```

这很好用，它将 ID 打印到页面上。不过我觉得不用放那么多套`<%`s和`<%=`s会更干净

以下是可取的，但它不起作用：

```
<% @myquiz.each do |x|

    render :text "<div>#{x.quiz_ID}</div>"

end %> 
```

有没有办法`put`在上面的循环中将信息显示在屏幕上，而无需 3 组`<%`标签？以及我想在页面上显示的每个后续值的另一个 <% 标记。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:53:06.253

```
<%= @myquiz.map(&:quiz_ID).join(', ') %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T10:17:24.053

这里有一些提示，只是为了提供一些关于 Ruby 方法的指针。

```
# Original
<%= @myquiz.each do |x|
    puts "<div>" . x.quiz_ID . "</div>"
end %> 
```

`<%= expression %>`将使表达式在 HTML 中可见。因此，您必须操纵表达式的返回值。您正在使用`.each`那里，而为此目的**`.map`**更合适，因为它将返回一个数组，其中包含每个输入变量的块输出。

在块中最后一条语句是**返回值**，不需要打印东西。

最后，数组 like`['A', 'B', 'C']`仍然希望通过一些换行符加入，所以表达式需要加入**`.join('<br />')`.**

这是一团糟，但无论如何，这里是：

```
<%= @myquiz.map {|x| "<div>#{ x.quiz_id }</div>" }.join("<br />").html_safe %>

# or

<%= @myquiz.map(&:quiz_id).map { |id| "<div>#{ id }</div>" }.join("<br />").html_safe %> 
```

**不要在家里这样做。严重地。只需注意 .map 的工作原理，它如何收集返回值（最后一条语句），以及如何连接数组元素以形成字符串。**

*更多选项：*

DHH 会怎么做？大概使用额外的括号，或者将逻辑移动到其他地方（到帮助器或装饰器中）并输出某种`<%= quiz_results %>`.

我会怎么做？看看[**Slim**](http://slim-lang.com/)并`slim-rails`集成它和自动生成`.html.slim`视图。

```
# In a slim view
- @quizzes.each do |quiz|
  div = quiz.id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:58:30.193

用咖喱括号做块

```
<%= @myquiz.each { |x| puts x.quiz_ID } =%> 
```

如果 block 中的语句超过 2，则应该使用 'do-end' 编写 block，这是正确的。

# javascript - 在文档正文中嵌入 Javascript？

> ID：15966929
> 
> 赞同：0
> 
> 时间：2013-04-12T08:50:31.457
> 
> 标签：javascript

您是否将 JS 嵌入到文档的正文中？还是您只将它们全部放在文档的头部/底部？

我一直将它们放在一个站点范围的文件中，但它变得难以管理。我在想使用视图助手有选择地将脚本包含到文档正文中可以很好地工作，但我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T08:51:43.147

尝试使用[RequireJS 之](http://requirejs.org/)类的库来管理您的 .js 文件。这将在您的脑海中添加一个脚本引用，但在必要时包括所有其他文件。如果您需要，这还将支持构建时的捆绑和缩小。

作为旁注；脚本块总是阻止页面加载，因为脚本总是在加载继续之前执行。因此，始终最好使用尽可能少的脚本块，如果有，请将它们放在正文的结束标记之前，以提供最佳的用户体验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:53:44.147

我们遵循的过程是将 JS 文件按逻辑和功能分组到不同的文件中。我们只加载网页所需的那些文件。

如果您的文档可能需要或不需要 JS 文件，我们会使用延迟加载文件，即按需加载文件。Facebook 在其 Bootloader 框架方法中广泛使用了这一概念。

这很容易实现。您的主要任务是将文件拆分为逻辑组。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:58:15.090

我个人会在文档中放入尽可能少的 js 代码。使用模块库 ( [AMD](http://de.wikipedia.org/wiki/Asynchronous_module_definition) ) 模块化您的代码（这也只加载真正需要的代码并且异步执行此操作）。使用不显眼的 javascript 风格将行为与设计分开。（[示例](http://www.ibm.com/developerworks/library/wa-aj-unobtrusive/)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T08:58:56.937

例如，我不能将所有内容都放在外部 JavaScript 中，因为我的服务器端将有关本地化的信息放入 javascript 中。所以我有：

```
<script>
XXX.lang = "de-DE";
</script> 
```

第二件事是在运行时或编译时生成“捆绑”脚本。有很多工具可以做到这一点，例如：yui 压缩器。使用此工具可以在开发环境（许多文件）之前轻松管理您的代码，并在生产站点上拥有一个文件。

# whois - Whois 服务器在 2 或 3 次查询后阻止我的 IP 地址

> ID：15966931
> 
> 赞同：5
> 
> 时间：2013-04-12T08:50:39.000
> 
> 标签：whois

我正在为网站编写域检查器，但我遇到了有趣的问题。

一些 whois 服务器负责像 .WS (whois.worldsite.ws) 或 .CA (whois.cira.ca) 这样的域，每天 2 或 3 次查询后阻止 IP 地址！

对于每天可能有数百万个请求的托管网站来说，这看起来像是一场灾难。

我应该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-05-29T19:05:54.963

相反，有一个非常简单的方法。

如前所述，如果大多数 WHOIS 权威机构认为您在 24 小时内发出过多请求，他们会限制（甚至阻止）您的流量，相反，您可能需要考虑登录全球任何 WHOIS 提供商的 ftp 站点并下载数据库的各个部分，然后编写（或查找）您自己的脚本来处理它们。

我目前使用自己的一台服务器执行此操作，该服务器使用以下 shell 脚本连接（每 24 小时一次）：

```
#!/bin/bash
rm -f delegated-afrinic-latest
rm -f delegated-lacnic-latest
rm -f delegated-arin-latest
rm -f delegated-apnic-latest
rm -f delegated-ripencc-latest
rm -f ripe.db.inetnum
rm -f apnic.db.inetnum
rm -f ripe.db.inetnum.gz
rm -f apnic.db.inetnum.gz
wget ftp://ftp.afrinic.net/pub/stats/afrinic/delegated-afrinic-latest
wget ftp://ftp.lacnic.net/pub/stats/lacnic/delegated-lacnic-latest
wget ftp://ftp.arin.net/pub/stats/arin/delegated-arin-latest
wget ftp://ftp.apnic.net/pub/stats/apnic/delegated-apnic-latest
wget ftp://ftp.ripe.net/ripe/stats/delegated-ripencc-latest
wget ftp://ftp.ripe.net/ripe/dbase/split/ripe.db.inetnum.gz
ftp -n -v ftp.apnic.net <<END
user anonymous anonymous@anonymous.org
binary
passive
get /apnic/whois-data/APNIC/split/apnic.db.inetnum.gz apnic.db.inetnum.gz
bye
END
gunzip ripe.db.inetnum
gunzip apnic.db.inetnum 
```

然后我有一个自定义编写的程序，它将文件解析为自定义数据库结构，然后我的服务器从中进行查询。

由于所有服务器都相互镜像数据，那么您应该能够从一台服务器获取完整的数据集，但如果没有，那么修改上述 shell 脚本以从其他服务器下载数据并不需要太多，他们都回应'ftp.????' 并具有相同的通用文件夹结构。

但是，我无法帮助您使用解析器，因为它包含专有代码，但文件格式（尤其是如果您获得拆分文件）与您在典型的 whois 输出中看到的相同，因此非常容易使用。

google-code 上有一个解析器（这是我下载脚本的地方），名为“ip-country”（我认为），它旨在让您构建自己的 whois 数据库，我构建的数据库稍微复杂一些，因为它也与其他数据结合（因此我的解析器是专有的）

通过像这样下载和处理您自己的数据，您可以绕过供应商施加的任何限制，结果是查询您自己的数据存储很可能比每次都从您的服务器向查询服务器发出请求要快得多有人输入 IP 地址。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T10:33:39.560

没有简单的方法来解决这个问题。您发现的一些 whois 服务器会在几次查询后阻止您。您通常可以为一定数量的查询向他们支付费用。还有另一种可行的方法。由于阻塞是通过 IP 地址完成的，因此您可以编写一个 Java 小程序来运行查询。这样，限制将在用户身上，因此用户将被限制为每天 2-3 次查询，而不是网站。Java Applet 必须经过签名才能允许网络访问。我用 java 写了一个 whois 库，可能对[JFreeWhois有帮助](https://code.google.com/p/jfreewhois/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-04T08:19:09.250

您应该了解错误消息模式并尝试在睡眠一段时间后重复查询。如果它不起作用，则使用不同的 Whois 服务器。当您为网站编写应用程序时，应从客户端完成 Whois 查询。

# flash - 如何将 flex LineSeries 中的数据点拖到图表中的新位置

> ID：15966932
> 
> 赞同：0
> 
> 时间：2013-04-12T08:50:45.417
> 
> 标签：flash, apache-flex, actionscript

我需要将数据点拖到 LineSeries 中的新位置。当用户使用鼠标指针拖动数据点时，它应该动态完成。

我已经尝试过以下选项：dragMoveEnabled="true" dragEnabled="true" dropEnabled="true" 在 flex 的 LineChart 控件中，如下所示。

```
<mx:LineChart id="linechart1" selectionMode="multiple" showAllDataTips="true" showDataTipTargets="true" dragMoveEnabled="true" dragEnabled="true" dropEnabled="true"> 
```

但它不起作用。

任何人都可以告诉如何实现这一目标。

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T22:12:32.047

我认为没有标准的 Flex API 可以解决这个问题。您可以通过控制用户与数据点的交互来以另一种方式实现它。

这是我的解决方案和[工作示例](http://it-skills.su/sosamples/webspark46/linechartdrag/index.html)。

用户可以获取任何数据点并上下拖动。可以使用您拥有的任何系列的 localToDate 方法通过转换鼠标坐标来计算新位置。

重要的一点是要考虑图表位置和绘图实际开始之间的距离。为此，我使用常量 CHART_GUTTERTOP。

编码：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" 
           minWidth="955" minHeight="600">
<fx:Script>
    <![CDATA[
        import mx.charts.events.ChartItemEvent;
        import mx.charts.series.items.LineSeriesItem;
        import mx.collections.ArrayCollection;

        [Bindable]public var expenses:ArrayCollection = new ArrayCollection([
            {Month:"Jan", Profit:2000, Expenses:1500, Amount:450},
            {Month:"Feb", Profit:1000, Expenses:200, Amount:600},
            {Month:"Mar", Profit:2200, Expenses:800, Amount:300},
            {Month:"Apr", Profit:1800, Expenses:400, Amount:400}
        ]);

        private var currentId:int = -1;
        private var currentYField:String;
        private const CHART_GUTTERTOP:int = 20;

        protected function myChart_itemMouseDownHandler(event:ChartItemEvent):void
        {
            if (event.hitData != null)
            {
                var chartItem:LineSeriesItem = event.hitData.chartItem as LineSeriesItem;
                currentId = chartItem.index;
                currentYField = (chartItem.element as LineSeries).yField;
            }
        }

        protected function myChart_itemMouseUpHandler(event:ChartItemEvent):void
        {
            if (currentId != -1)
            {
                var p:Point = new Point(myChart.mouseX, myChart.mouseY  - CHART_GUTTERTOP);
                var d:Array = series1.localToData(p);

                expenses.getItemAt(currentId)[currentYField] = d[1];
                myChart.dataProvider = expenses;
                currentId = -1;
            }
        }
    ]]>
</fx:Script>

<s:Panel x="20" y="20">
    <s:VGroup>
        <mx:LineChart 
            id="myChart" 
            gutterTop="{CHART_GUTTERTOP}"
            dataProvider="{expenses}" 
            showDataTips="true"
            itemMouseDown="myChart_itemMouseDownHandler(event)" 
            itemMouseUp="myChart_itemMouseUpHandler(event)">

            <mx:horizontalAxis>
                <mx:CategoryAxis 
                    dataProvider="{expenses}" 
                    categoryField="Month"/>
            </mx:horizontalAxis>

            <mx:series>
                <mx:LineSeries id="series1" 
                    yField="Profit" 
                    displayName="Profit"/>
                <mx:LineSeries 
                    yField="Expenses" 
                    displayName="Expenses"/>
            </mx:series>
        </mx:LineChart>

        <mx:Legend dataProvider="{myChart}"/>
    </s:VGroup>
</s:Panel>
</s:Application> 
```

# performance - 为二进制搜索预处理一组常量字符串

> ID：15966933
> 
> 赞同：1
> 
> 时间：2013-04-12T08:50:53.617
> 
> 标签：performance, algorithm, sorting, search, data-structures

我有几个字符串的排序列表（大小=K < 1000）。我需要在排序列表中找到数十亿（大小= N）个字符串的插入位置。列表保持不变，字符串被插入到子节点中。

问题是：我目前用的是二分查找，时间成本是O(strlen * NlogK)。但是由于排序列表是恒定的。不知道有没有在小排序列表上的预处理方法让搜索比logK快？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T10:08:36.737

一些不错的替代方案包括[Trie](http://en.wikipedia.org/wiki/Trie)（可能实现为[Patricia trie](http://en.wikipedia.org/wiki/Radix_tree)或[三元搜索树](http://en.wikipedia.org/wiki/Ternary_search_tree)）或[完美哈希表](http://en.wikipedia.org/wiki/Perfect_hash_function)。

编辑：要使用 trie 查找不匹配字符串的“插入位置”，首先用其位置标记每个完整的字符串（您可以在最初构建 trie 时执行此操作）。搜索不匹配的字符串时，您将在字符串中不匹配的第一个索引处检测到这一点。

例如，假设您在包含 CANNOT 和 CATASTROPHE（没有其他相关内容）的 trie 中查找字符串 CAR。您会在 R 处检测到这种不匹配，因为在 A 下方没有 R 子代。但是应该很容易看出该位置周围的字母是 N 和 T。转到 N 然后向下向右会带你到 CANNOT，在那里你可以读出位置。或者，去 T 然后继续往下和左转会给你带来灾难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T17:00:39.830

除了 Chris Okasaki 之外，我可能会建议您为每个树节点（trie 或 patricia）计算相应子树中的叶子数（您可以通过深度优先遍历轻松完成）。

要使用字符串进行查询，请按树和叶子的总和（预先计算的）总和，您在当前位置留下的子树中留下。当您停在某个位置并且您无法在不与查询字符串冲突的情况下继续树路径时，这意味着您找到了该字符串的位置。索引是用总和计算的所有左侧叶子的数量。

# android - 仅在按下“重置”按钮时如何将日期选择器对话框设置为当前时间

> ID：15966934
> 
> 赞同：0
> 
> 时间：2013-04-12T08:50:54.097
> 
> 标签：android, datepicker

我在我的应用程序中使用两个日期选择器来获取“从日期”和“到日期”。当用户第一次单击日历图像按钮（对于两个日期选择器）时，它会显示当前日期，然后单击图像时它再次显示以前选择的日期。

我的问题是我想将两个日期选择器都设置为*仅在按下我的应用程序中的重置按钮时才显示当前日期*。**否则它应该显示以前选择的日期。请帮助我实现它。

在此先感谢。以下是代码：`

```
 DatePickerDialog.OnDateSetListener from_dateListener,to_dateListener;
       .
       .

  from_dateListener = new OnDateSetListener()
  {

      public void onDateSet(DatePicker view, int year, 
              int monthOfYear, int dayOfMonth)
      {
            factiveDate.set(Calendar.YEAR,year) ;
            factiveDate.set(Calendar.MONTH, monthOfYear);
            factiveDate.set(Calendar.DAY_OF_MONTH, dayOfMonth);

            if(currentDate.before(factiveDate)||(currentDate.equals(factiveDate)))
            {
                if(endDateDisplay.getText().toString().isEmpty())
                {
                    updateStartDisplay();
                    //startPickDate.setClickable(false);
                }
                else
                {
                    if(factiveDate.before(toDate)||(factiveDate.equals(toDate)))
                    {
                        updateStartDisplay();
                        //startPickDate.setClickable(false);
                    }
                    else
                    {
                        Toast t=new Toast(getBaseContext());
                        t=Toast.makeText(Next.this, "To date should be less than or eqaul to from date", Toast.LENGTH_LONG);
                        t.setGravity(Gravity.CENTER, 0, 0);
                        t.show();
                    }
                }
            }
            else
            {
                Toast t=new Toast(getBaseContext());
                t=Toast.makeText(Next.this, "Please enter a valid date", Toast.LENGTH_LONG);
                t.setGravity(Gravity.CENTER, 0, 0);
                t.show();

            }

      }

  };

  to_dateListener = new OnDateSetListener()
     {
          public void onDateSet(DatePicker view, int year, 
                  int monthOfYear, int dayOfMonth)
          {
                tactiveDate.set(Calendar.YEAR, year);
                tactiveDate.set(Calendar.MONTH, monthOfYear);
                tactiveDate.set(Calendar.DAY_OF_MONTH, dayOfMonth);

                if(currentDate.before(tactiveDate)||(currentDate.equals(tactiveDate)))
                {
                    Log.d("1st if","true");
                    if(!startDateDisplay.getText().toString().isEmpty())
                    {
                        Log.d("2st if","true");
                        if(tactiveDate.after(fromDate)||(tactiveDate.equals(fromDate)))
                        {
                            Log.d("3st if","true");
                            updateEndDisplay();
                            //endPickDate.setClickable(false);
                        }
                        else
                        {
                            Toast t=new Toast(getBaseContext());
                            t=Toast.makeText(Next.this, "To date should be greater than or equal to from date",Toast.LENGTH_LONG );
                            t.setGravity(Gravity.CENTER, 0, 0);
                            t.show();
                        }
                    }
                    else
                        {
                            updateEndDisplay();
                            //endPickDate.setClickable(false);
                        }
                    }
                else
                {
                    Toast t=new Toast(getBaseContext());
                    t=Toast.makeText(Next.this, "Please enter a valid date", Toast.LENGTH_LONG);
                    t.setGravity(Gravity.CENTER, 0, 0);
                    t.show();
                }

          }
      };

}
private void updateStartDisplay()
{
    startDateDisplay.setText(
            new StringBuilder()
                // Month is 0 based so add 1

                .append(factiveDate.get(Calendar.DAY_OF_MONTH)).append("-")
                .append(factiveDate.get(Calendar.MONTH)+1).append("-")
                .append(factiveDate.get(Calendar.YEAR)).append(" "));

     fromDate=factiveDate; 
     factiveDate=currentDate;
     factiveDate=null;
        //Log.d("msg","date:"+(date.get(Calendar.DAY_OF_MONTH))+(date.get(Calendar.MONTH)+1)+(date.get(Calendar.YEAR)));

    }

  private void updateEndDisplay()
  {
        endDateDisplay.setText(
                new StringBuilder()
                    // Month is 0 based so add 1

                    .append(tactiveDate.get(Calendar.DAY_OF_MONTH)).append("-")
                    .append(tactiveDate.get(Calendar.MONTH) + 1).append("-")
                   .append(tactiveDate.get(Calendar.YEAR)).append(" "));

        toDate=tactiveDate;
        tactiveDate=null;
        //Log.d("msg","date:"+(date.get(Calendar.DAY_OF_MONTH))+(date.get(Calendar.MONTH)+1)+(date.get(Calendar.YEAR)));

  }   

   /* capture our View elements for the end date function */

    @Override
    protected Dialog onCreateDialog(int id) {

        switch(id){
            case DATE_PICKER_FROM:
                    Log.d("current date-on create"," "+(currentDate.get(Calendar.YEAR))+ (currentDate.get(Calendar.MONTH)+1)+ (currentDate.get(Calendar.DAY_OF_MONTH)));
                    return new DatePickerDialog(this, from_dateListener, currentDate.get(Calendar.YEAR), currentDate.get(Calendar.MONTH), currentDate.get(Calendar.DAY_OF_MONTH));

                case DATE_PICKER_TO:
                    return new DatePickerDialog(this, to_dateListener, currentDate.get(Calendar.YEAR), currentDate.get(Calendar.MONTH), currentDate.get(Calendar.DAY_OF_MONTH));
        }
            return null;
    } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:55:56.860

您可以使用 DatePicker 设置默认值

```
dPicker.init((previouslyEnteredDate.getYear() + 1900),
                        previouslyEnteredDate.getMonth(),
                        previouslyEnteredDate.getDate(), null); 
```

希望能帮助到你。

# python - python二叉搜索树

> ID：15966936
> 
> 赞同：0
> 
> 时间：2013-04-12T08:51:04.597
> 
> 标签：python, search, binary-tree, binary-search-tree

出于某种原因，我似乎无法让“查找”方法起作用。我认为这与范围界定问题有关...... root.val 似乎没有在全球范围内更新。我收到一条错误消息，说 AtributeError: 'int' object has no attribute 'val' 这是我目前的代码：

```
class BinaryNode:
    def __init__(self, v):
        self.val = v
        self.leftChild = None
        self.rightChild = None
    def get(self):
        return self.val
    def set(self, v):
        self.val = v
    def getChildren(self):
        children = []
        if self.leftChild != None:
            children.append(self.leftChild)
        if self.rightChild != None:
            children.append(self.rightChild)
        return children

class Tree:
    def __init__(self):
        self.root = None
    def setRoot(self, node):
        self.root = node
    def size(self):
        if self.root == None:
            return 0
    def subtreeSize(node):
        return 1 + sum(subtreeSize(c) for c in node.getChildren())
        return subtreeSize(self.root)

class BinarySearchTree(Tree):
    def insert(self, val):
        self.insertNode(self.root, val)

    def insertNode(self, node, val):
        if node is None:
            self.setRoot(BinaryNode(val))
        elif val <= node.val:
            node.leftChild = insertNode(BinaryNode(val), val)
        elif val > node.val:
            node.rightChild = insertNode(BinaryNode(val), val)
        else:
            node.val = val

    def find(self, val):
        self.findNode(self.root, val)

    def findNode(self, node, val):
        if node is None:
            return False
        elif val == node.val:
            return True
        elif val < node.val:
            self.findNode(val, node.leftChild)
        else:
            self.findNode(val, node.rightChild)

if __name__ == "__main__":
    btree = BinarySearchTree()
    vals = [5]
    for v in vals:
        btree.insert(v)
    tests = [8, 5]
    for t in tests:
        print "find(%i) = %s" % (t, ("True" if btree.find(t) else "False")) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T08:56:02.100

你的方法有两个问题`findNode()`：

1.  递归调用时*交换*了`node`and参数。`val`这会导致您的代码尝试查找`.val`整数值而不是节点。

2.  您忘记返回递归调用结果。

修正方法：

```
def find(self, val):
    return self.findNode(self.root, val)

def findNode(self, node, val):
    if node is None:
        return False
    elif val == node.val:
        return True
    elif val < node.val:
        return self.findNode(node.leftChild, val)
    else:
        return self.findNode(node.rightChild, val) 
```

你的下一个问题是你的`insertNode`方法；您尝试在`insertNode()`其中调用全局函数；那可能应该是`self.insertNode()`。但是，该方法*没有*返回值，因此您最终设置了`node.leftChild`or 。`node.rightChild``None`

您只想将插入点的搜索交给递归调用，无需使用返回值：

```
def insert(self, val):
    if self.root is None:
        self.setRoot(BinaryNode(val))
    else:
        self.insertNode(self.root, val)

def insertNode(self, node, val):
    if val <= node.val:
        if node.leftChild:
            self.insertNode(node.leftChild, val)
        else:
            node.leftChild = BinaryNode(val)
    elif val > node.val:
        if node.rightChild:
            self.insertNode(node.rightChild, val)
        else:
            node.rightChild = BinaryNode(val) 
```

通过这些更改，您的简单测试将打印：

```
find(8) = False
find(5) = True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:52:52.127

一个问题`findNode()`是您缺少`return`陈述。这

```
 elif val < node.val:
        self.findNode(val, node.leftChild)
    else:
        self.findNode(val, node.rightChild) 
```

应该读

```
 elif val < node.val:
        return self.findNode(val, node.leftChild)
    else:
        return self.findNode(val, node.rightChild) 
```

您在`insertNode()`.

# ajax - 如何在 Dajax 或 Dajaxice 中指定同步请求？

> ID：15966946
> 
> 赞同：0
> 
> 时间：2013-04-12T08:51:29.893
> 
> 标签：ajax, django, jquery, dajaxice, dajax

我需要在 Dajax 或 Dajaxice 请求中设置 jQuery.ajax() 的等效“异步”设置，以避免在我的 Dajaxice 回调结束之前继续执行脚本。

```
$(".some_selector").click(
    Dajaxice.apps.forum.forum_com(my_js_callback, {'id':$(this).attr("id")});
    // More js code here.. Here should not continue before call ends. 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T10:11:32.780

好的，我认为这还不可能。为了解决这个问题，我把我的代码放在“my_js_callback”函数中。

# c# - wpf DataGrid - 已添加具有相同键的项目

> ID：15966949
> 
> 赞同：10
> 
> 时间：2013-04-12T08:51:42.497
> 
> 标签：c#, wpf, mvvm, datagrid

我看到很多与此问题相关的帖子，但我找不到解决方案

我有下一个 WPF DataGrid：

```
<DataGrid Grid.Column="1"
          Grid.Row="4"
          AutoGenerateColumns="False"
          ItemsSource="{Binding MapsGrid}"
          SelectedItem="{Binding DataContext.CategoriesSelectedRow, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Mode=OneWayToSource}"
          SelectionMode="Single"
          CanUserReorderColumns="False"
          CanUserResizeColumns="False"
          CanUserDeleteRows="False"
          CanUserResizeRows="False"
          CanUserAddRows="False">
  <DataGrid.Columns>
    <DataGridTemplateColumn Header="Main Category"
                            Width="*">
      <DataGridTemplateColumn.HeaderStyle>
        <Style TargetType="DataGridColumnHeader">
          <Setter Property="HorizontalContentAlignment"
                  Value="Center" />
          <Setter Property="FontSize"
                  Value="16" />
        </Style>
      </DataGridTemplateColumn.HeaderStyle>
      <DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
          <ComboBox ItemsSource="{Binding MainCategoriesColl}"
                    DisplayMemberPath="Category"
                    SelectedItem="{Binding MainCategorySelectedItem,UpdateSourceTrigger=LostFocus, Mode=OneWayToSource}" />
        </DataTemplate>
      </DataGridTemplateColumn.CellTemplate>
    </DataGridTemplateColumn>

    <DataGridTemplateColumn Header="Sub Category"
                            Width="*">
      <DataGridTemplateColumn.HeaderStyle>
        <Style TargetType="DataGridColumnHeader">
          <Setter Property="HorizontalContentAlignment"
                  Value="Center" />
          <Setter Property="FontSize"
                  Value="16" />
        </Style>
      </DataGridTemplateColumn.HeaderStyle>
      <DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
          <ComboBox ItemsSource="{Binding SubCategoriesColl}"
                    DisplayMemberPath="Category"
                    SelectedItem="{Binding SubCategorySelectedItem,  UpdateSourceTrigger=LostFocus, Mode=TwoWay}" />
        </DataTemplate>
      </DataGridTemplateColumn.CellTemplate>
    </DataGridTemplateColumn>
  </DataGrid.Columns>
</DataGrid> 
```

此 DataGrid 包含 2 个组合框。ItemSource 对象是下一个对象：

```
 public class MapsDescModel : NotificationObject, IEqualityComparer<MapsDescModel>, IEquatable<MapsDescModel>
{
    public MapsDescModel(ObservableCollection<MainCategories> mainCategoty)
    {
        MainCategoriesColl = mainCategoty;

    }

    public static event Action OnSelectionHandler;

    private static void OnSelection()
    {
        if (OnSelectionHandler != null)
        {
            OnSelectionHandler();
        }
    }

    private MainCategories _mainCategorySelectedItem;
    public MainCategories MainCategorySelectedItem
    {
        get { return _mainCategorySelectedItem; }
        set
        {
            if (Equals(value, _mainCategorySelectedItem)) return;
            _mainCategorySelectedItem = value;
            RaisePropertyChanged("MainCategorySelectedItem");
            RaisePropertyChanged("SubCategoriesColl");
        }
    }

    private SubCategories _subCategorySelectedItem;
    public SubCategories SubCategorySelectedItem
    {
        get { return _subCategorySelectedItem; }
        set
        {
            if (Equals(value, _subCategorySelectedItem)) return;
            _subCategorySelectedItem = value;
            RaisePropertyChanged("SubCategorySelectedItem");
            OnSelection();

        }
    }

    private ObservableCollection<MainCategories> _mainCategoriesColl;
    public ObservableCollection<MainCategories> MainCategoriesColl
    {
        get { return _mainCategoriesColl; }
        set
        {
            if (Equals(value, _mainCategoriesColl)) return;
            _mainCategoriesColl = value;
            RaisePropertyChanged("MainCategoriesColl");
        }
    }

    //Allow user see N/A category just if is the only subCategory that exists
    public ObservableCollection<SubCategories> SubCategoriesColl
    {
        get
        {
            if (MainCategorySelectedItem != null && MainCategorySelectedItem.SubCategory.Any())
                if (MainCategorySelectedItem.SubCategory.Count() > 1)
                {
                    return Infrastructure.Helpers.ExtensionMethods.ToObservableCollection(
                        MainCategorySelectedItem.SubCategory.AsEnumerable().Where(p => p.Category != Infrastructure.Constants.Constants.NoSubCategory));
                }
                else return Infrastructure.Helpers.ExtensionMethods.ToObservableCollection(
                        MainCategorySelectedItem.SubCategory.AsEnumerable());
            else return new ObservableCollection<SubCategories>();
        }
    }

    public bool Equals(MapsDescModel x, MapsDescModel y)
    {
        try
        {
            if (x.MainCategorySelectedItem == null && y.MainCategorySelectedItem == null)
                return true;
            else if (x.MainCategorySelectedItem == null && y.MainCategorySelectedItem != null ||
                x.MainCategorySelectedItem != null && y.MainCategorySelectedItem == null)
                return false;
            return
                x.MainCategorySelectedItem.MainCatID == y.MainCategorySelectedItem.MainCatID &&
                x.SubCategorySelectedItem.SubCatID == y.SubCategorySelectedItem.SubCatID;
        }
        catch (Exception ex)
        {
            ServiceLocator.Current.GetInstance<Infrastructure.SharedServices.IEnterpriseLibraryLogger>().Log(ex.Message, Category.Exception, Priority.High);
            return false;
        }
    }

    public int GetHashCode(MapsDescModel obj)
    {
            if (Object.ReferenceEquals(obj, null)) return 0;

            if (obj.MainCategorySelectedItem == null || obj.SubCategorySelectedItem == null)
                return 0;
            else return obj.SubCategorySelectedItem.Category.GetHashCode() + obj.MainCategorySelectedItem.GetHashCode();
    }

    public bool Equals(MapsDescModel other)
    {
        return
        this.Equals(this, other);  // use definition from IEqualityComparer<T>
    }

    public override bool Equals(object obj)
    {
        MapsDescModel other = obj as MapsDescModel;
        if (other == null)
            return base.Equals(obj);
        else
            return this.Equals(other);
    }

    public override int GetHashCode()
    {
        MapsDescModel other = this as MapsDescModel;
        if (other == null)
            return base.GetHashCode();
        else
            return this.GetHashCode(other);
    }
} 
```

除了一个烦人的问题外，一切都很好。当我添加 2+ 行时，如果我在附图中的标记区域上单击几次，我会收到以下错误：

```
System.ArgumentException was unhandled
  HResult=-2147024809
  Message=An item with the same key has already been added.
  Source=mscorlib
  StackTrace:
       at System.ThrowHelper.ThrowArgumentException(ExceptionResource resource)
       at System.Collections.Generic.Dictionary`2.Insert(TKey key, TValue value, Boolean add)
       at System.Collections.Generic.Dictionary`2..ctor(IDictionary`2 dictionary, IEqualityComparer`1 comparer)
       at System.Windows.Controls.Primitives.Selector.InternalSelectedItemsStorage..ctor(InternalSelectedItemsStorage collection, IEqualityComparer`1 equalityComparer)
       at System.Windows.Controls.Primitives.Selector.SelectionChanger.ApplyCanSelectMultiple()
       at System.Windows.Controls.Primitives.Selector.SelectionChanger.End()
       at System.Windows.Controls.SelectedItemCollection.EndUpdateSelectedItems()
       at System.Windows.Controls.Primitives.MultiSelector.EndUpdateSelectedItems()
       at System.Windows.Controls.DataGrid.MakeFullRowSelection(ItemInfo info, Boolean allowsExtendSelect, Boolean allowsMinimalSelect)
       at System.Windows.Controls.DataGrid.HandleSelectionForRowHeaderAndDetailsInput(DataGridRow row, Boolean startDragging)
       at System.Windows.Controls.Primitives.DataGridRowHeader.OnClick()
       at System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonDown(MouseButtonEventArgs e)
       at System.Windows.UIElement.OnMouseLeftButtonDownThunk(Object sender, MouseButtonEventArgs e)
       at System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget)
       at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)
       at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)
       at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)
       at System.Windows.UIElement.ReRaiseEventAs(DependencyObject sender, RoutedEventArgs args, RoutedEvent newEvent)
       at System.Windows.UIElement.OnMouseDownThunk(Object sender, MouseButtonEventArgs e)
       at System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget)
       at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)
       at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)
       at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)
       at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)
       at System.Windows.UIElement.RaiseTrustedEvent(RoutedEventArgs args)
       at System.Windows.UIElement.RaiseEvent(RoutedEventArgs args, Boolean trusted)
       at System.Windows.Input.InputManager.ProcessStagingArea()
       at System.Windows.Input.InputManager.ProcessInput(InputEventArgs input)
       at System.Windows.Input.InputProviderSite.ReportInput(InputReport inputReport)
       at System.Windows.Interop.HwndMouseInputProvider.ReportInput(IntPtr hwnd, InputMode mode, Int32 timestamp, RawMouseActions actions, Int32 x, Int32 y, Int32 wheel)
       at System.Windows.Interop.HwndMouseInputProvider.FilterMessage(IntPtr hwnd, WindowMessage msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
       at System.Windows.Interop.HwndSource.InputFilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
       at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
       at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)
       at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)
       at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)
       at System.Windows.Threading.Dispatcher.LegacyInvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs)
       at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)
       at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG& msg)
       at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)
       at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)
       at System.Windows.Threading.Dispatcher.Run()
       at System.Windows.Application.RunDispatcher(Object ignore)
       at System.Windows.Application.RunInternal(Window window)
       at System.Windows.Application.Run(Window window)
       at System.Windows.Application.Run()
       at Malaria.App.Main() in c:\My Projects\Hebrew University\Malaria Management Console\Malaria\obj\Debug\App.g.cs:line 0
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

我认为这可能与我的`GetHashCode`方法有关，但我不确定。我找到了这个链接 [http://leavinsprogramming.blogspot.co.il/2012/08/wpf-datagrid-and-random.html](http://leavinsprogramming.blogspot.co.il/2012/08/wpf-datagrid-and-random.html) 它很好地描述了我的问题，但那里没有解决方案。有谁知道为什么会发生这种异常？

![问题区域](https://i.stack.imgur.com/EgSLt.jpg)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-01-26T19:29:16.457

引用[MSDN 关于 Object.GetHashCode() 的条目](http://msdn.microsoft.com/en-us/library/system.object.gethashcode%28v=vs.110%29.aspx)：

> 一般来说，对于可变引用类型，只有在以下情况下才应该覆盖 GetHashCode：
> 
> *   您可以从不可变的字段计算哈希码；或者
>     
>     
> *   您可以确保当对象包含在依赖于其哈希码的集合中时，可变对象的哈希码不会改变。

您当前的`GetHashCode()`实现调用`GetHashCode(MapsDescModel obj)`，并且该方法取决于在集合中可以更改的可变字段。

更改您的`GetHashCode()`实现以返回不依赖于可变字段的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:55:06.203

我认为 MapsGrid 是一个实体集合，当您添加第二条记录时，第二条记录与第二条相同`[Key]`。

对于您的实体，您应该提供不同的密钥。

# lotus-notes - Notes 应用程序性能受到影响

> ID：15966959
> 
> 赞同：1
> 
> 时间：2013-04-12T08:51:59.317
> 
> 标签：lotus-notes, lotus-domino

我们最近切换到 8.5 服务器。我们还有一个非常复杂的应用程序，它来自 V4.5，只是简单地复制到新的服务器版本，没有任何问题。

但是现在在 8.5 中，我们在打开和创建文档时会遇到性能问题。如前所述，该应用程序具有复杂的表单/视图/脚本，我认为它可能是视图。升级到新服务器版本时与视图有什么关系，或者可以解释任何性能问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T07:54:20.020

我已经看到旧应用程序的性能下降，其中使用更新的 Designer 重新编译 LotusScript 代码解决了这个问题。猜测设计元素包含格式无效的目标代码，并且客户端必须在每次访问时进行编译。

在我的特殊情况下，它是导致延迟的子表单。尝试系统地从主表单和/或操作中删除子表单和脚本，直到问题消失。

*您的应用程序是否使用LotusScript*的共享操作（它们在 V4.5（约 1999 年）中不存在，但可能稍后添加）？至少在视图中，它们会带来性能损失。调用 LotusScript 代理的`@command([ToolsRunMacro])`操作效率更高（或者至少在我上次进行 Lotus 开发时是这样）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T11:28:46.107

“旧”应用程序的性能问题主要来自两个可能的原因：

1) 旧视图索引/全文索引/旧 ODS

由于所有这些结构都比版本改进了很多，因此有一个更新的最佳实践，其中包含：

*   compact -D 删除所有视图索引
*   删除所有全文索引并重新创建它
*   updall -R -C 更新索引

2）旧编译代码（如前所述）：（预）编译代码在不同版本期间发生了变化。尝试“工具 -> 重新编译所有 LotusScript”以摆脱“旧”代码。

除此之外，还有一些（非常少的）函数在 LotusScript-Enigne 中完全重写，并可能导致性能下降。要找出性能不佳的真正原因，您必须分析您的代码。因此，您可以使用 IBM 提供的标准分析方法（[在此处找到](http://www-10.lotus.com/ldd/dominowiki.nsf/dx/02042008043629WEBC4U.htm)）或使用您自己的分析（[如在此处解释](http://de.slideshare.net/CraigSchumann/bp206-lets-give-your-lotusscript-a-tuneup)）。

这应该可以帮助您找到性能问题的原因

# java - 如何在单独的 Eclipse RCP 程序中使用 uDigs mapviewer

> ID：15966960
> 
> 赞同：0
> 
> 时间：2013-04-12T08:52:01.030
> 
> 标签：java, eclipse-rcp, gis

uDig 声称您可以将它用作现有 RCP 应用程序的插件，我想做的是拥有自己的视图和由 GeoServer 支持的地图，我可以添加自己的图层和指向而无需使用uDigs SDK。

即使声明在那里，似乎也没有任何文件可以支持它，那么你是怎么做的呢？

在我看来，uDig 确实是富客户端 GIS 软件的唯一选择，我不喜欢必须使用他们的应用程序框架来访问它的想法。

您的帮助将不胜感激。X

# javascript - 将 JS 逻辑转换为 FTL

> ID：15966971
> 
> 赞同：1
> 
> 时间：2013-04-12T08:52:39.370
> 
> 标签：javascript, freemarker

我有一个 JS 代码，我想在 FTL 上进行转换，这样用户就无法查看它背后的逻辑。这可能吗？

我正在考虑使用 <#if> 和 <#assign> 作为逻辑，但不知道如何开始。找到任何其他资源，看起来 Freemarker 文档很痛苦。

```
 <script type="text/javascript">
    var ref = document.referrer,
        currentPageURL = document.URL,
        expectedURL = "http://127.0.0.1";

    function getUrlVars(href)
    {
        var vars = [], hash;
        var hashes = href.slice(href.indexOf('?') + 1).split('&');
        for(var i = 0; i < hashes.length; i++)
        {
            hash = hashes[i].split('=');
            vars.push(hash[0]);
            vars[hash[0]] = hash[1];
        }
        return vars;
    }

    var googleURL = ref.match(/^https?:\/\/([^\/]+\.)?google\.com(\/|$)/i);
    if ((googleURL && (currentPageURL == expectedURL)) {
        //do stuff.
    }
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T09:06:29.553

好吧，`getUrlVars`似乎并没有在任何地方使用，但是如果您需要请求参数，您可以使用 获取它们`${RequestParameters['test']}`，引用者和当前 url 不可用，因此您需要将它们从后端代码发送到模板引擎。那么那个条件只是一个普通的`<#if $referrerFromJava?matches("^https?:\/\/([^\/]+\.)?google\.com(\/|$)">`. 但是，如果您将所有这些都转移到服务器上，只需在后端代码中执行并将变量发送到 ftl，就像`${isFromGoogle}`

# c# - XAML StackPanel 未从后面的代码更新

> ID：15966974
> 
> 赞同：0
> 
> 时间：2013-04-12T08:52:57.070
> 
> 标签：c#, windows-phone-7, xaml, stackpanel

我在我的 XAML 中创建了一个堆栈面板，现在在 c# 代码中，我将 ListBoxes 添加到该堆栈面板

我的 wp7 应用程序中的 onbuttonClicks 事件。

因此，最初成功添加了 5 个项目，但在下一轮（按钮单击）堆栈面板未更新。而在调试堆栈面板子项时计数为 10。（使用 shift+F9），但 XAML 未更新

我的 C# 代码是：

```
private void BindAvailableItems(JToken jToken)
        {
            if (jToken.Count() > 0)
            {
                for (int i = 0; i < jToken.Count(); i++)
                {
                    ListBoxItem Item = new ListBoxItem();
                    DataTemplate ContentTemplate = Application.Current.Resources["UserAvailableItemsTemplate"] as DataTemplate;
                    Item.ContentTemplate = ContentTemplate;

                    MultiLineItem Content = new MultiLineItem();
                    Content.Line1 = "http://localhost:5141" + jToken[i]["ItemImageUrl"].ToString();

                    Item.Content = Content;

                    stackPnl.Children.Add(Item);   //<---stackPanel

                    stackPnl.UpdateLayout();
                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T03:08:16.777

假设存在可视化问题，这是您的问题。您正在将`ListBoxItem`实例添加到`StackPanel`. 虽然可行，但我认为没有理由这样做。显然因为`StackPanel`控件没有内置的触摸滚动，你看不到新元素。将 替换`StackPanel`为`ListBox`。

# linux - make: 无事可做 first.pdf

> ID：15966975
> 
> 赞同：1
> 
> 时间：2013-04-12T08:52:59.237
> 
> 标签：linux, makefile

我是 linux 和 make 的新手，我编写了一个 makefile 来自动将 .tex 文件编译为 .pdf。但是当我打电话给make时，它说“'first.pdf'没什么可做的”，这是我的makefile：

```
 TEXFILE= first.tex
    PDF= $(TEXFILE:.tex=.pdf)

    .tex.pdf:
            pdflatex $<
    $(PDF):$(TEXFILE)
    view:
            evince $(PDF)
    clean:
            @rm -f \
            $(TEXFILE:.tex=.log) \
            $(TEXFILE:.tex=.aux) \
            $(TEXFILE:.tex=.toc) 
```

谁能告诉我它有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T09:24:32.307

可能，其中一个后缀是未知的。您可以添加`.SUFFIXES`指令：

```
TEXFILE=first.tex
PDF=$(TEXFILE:.tex=.pdf)

.SUFFIXES: .tex .pdf
# etc. 
```

但是，比使用过时的后缀规则更好，您应该使用模式规则：

```
%.pdf : %.tex 
        pdflatex $< 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-04T17:12:14.063

如果将写入拆分为多个 .tex 文件，则会存在此问题。 `make`可以成功，但除非你修改`first.tex`你将得到：

> “‘first.pdf’无事可做

# 用于多个输入更改的 Makefile

```
# ...

# include all text files from current directory
SOURCES := $(shell find . -name '*.tex')
# include files figs directory ...
SOURCES += $(shell find ./figs)

# ...

# add sources here will cause recompilation when something is modified
$(PDF):$(TEXFILE) $(SOURCES)

# some phony targets
.PHONY: all pdf view clean 
```

# c++ - __attribute__((weak)) 和 LD_PRELOAD

> ID：15966978
> 
> 赞同：2
> 
> 时间：2013-04-12T08:53:03.947
> 
> 标签：c++, c, shared-libraries

我希望代码能够在*没有它的情况下运行**具有*某个自编写库的应用程序。因此，如果需要，我会使用并预加载库。我需要能够在不重新编译的情况下做到这一点。不过，如果我静态链接库，一切正常。*`__attribute__ ((weak))`*

 *此外，该库是用 C++ 编写的，而使用它的应用程序可以是 C++ 或 C。

我归结为：

库头`test_lib.h`：

```
#ifdef __cplusplus
extern "C"
#endif
void test_func() __attribute__ ((weak)); 
```

库实现`test_lib.cpp`：

```
#include "test_lib.h"
#include <iostream>
extern "C"
void test_func()
{
    std::cout << "in test_func\n";
} 
```

C测试`test_main.c`：

```
#include <stdio.h>
#include "test_lib.h"

int main(void)
{
    if (test_func){ printf("+\n"); }
    else{ printf("-\n"); }
    return 0;
} 
```

C++ 测试`test_main_cpp.cpp`：

```
#include <iostream>
#include "test_lib.h"

int main(void)
{
    if (test_func){ std::cout << "+\n"; }
    else{ std::cout << "-\n"; }
    return 0;
} 
```

为了您的方便，编译和运行脚本：

```
#!/bin/bash

g++ -shared -fPIC test_lib.cpp -o libtest.so

gcc test_main.c -o test_c
g++ test_main_cpp.cpp -o test_cpp

# output should be "-"
./test_c
./test_cpp

# output should be "+"
LD_PRELOAD=libtest.so ./test_c
LD_PRELOAD=libtest.so ./test_cpp 
```

预期的输出是：

```
-
-
+
+ 
```

我得到的是：

```
-
-
-
- 
```

最后是一些额外的信息：

```
$ uname -a
Linux bermuda-iii 3.8.6-1-ARCH #1 SMP PREEMPT Sat Apr 6 07:27:01 CEST 2013 x86_64 GNU/Linux
$ gcc --version
gcc (GCC) 4.8.0
$ nm libtest.so | grep -i func
0000000000000858 W test_func
$ nm test_c | grep -i func
             w test_func
$ nm test_cpp | grep -i func
             w test_func 
```

所以：(de)mangling 似乎工作正常，`test_func`可执行文件知道该符号。但是“LD_PRELOAD”似乎不起作用。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T09:22:25.167

诀窍是确保应用程序也被编译为与位置无关的代码，否则无法在运行时替换符号：

在链接可执行文件的地方，您需要执行以下操作：

```
gcc -fPIC test_main.c -o test_c 
```

或者

```
g++ test_main_cpp.cpp -o test_cpp 
```

例如

```
$ gcc test_main.c -o test_c -fPIC
$ ./test_c
-
$ LD_PRELOAD=`pwd`/libtest_lib.so ./test_c
+ 
```

通过将主可执行文件编译为与位置无关的代码，它允许在运行时由覆盖库替换弱符号。*

# android - 底部带有 Spinner 的 Android 对话框 => 下拉菜单无法正常工作

> ID：15966983
> 
> 赞同：0
> 
> 时间：2013-04-12T08:53:15.087
> 
> 标签：android, drop-down-menu, dialog, spinner

我有一个简单的对话框，带有一个`EditText`和一个`Spinner`...... Spinner 只有两个项目，位于对话框的底部......

使用下拉模式时，下拉列表中仅显示一项，如果我使用对话框模式，则显示所有项目...

有谁知道解决方案？

这是我的简单布局 - 如果我删除它就不能正常工作`android:spinnerMode="dialog"`......

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:orientation="vertical" >

<EditText
    android:id="@+id/etInput"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" >

    <requestFocus />
</EditText>

<Spinner
    android:id="@+id/spItems"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:spinnerMode="dialog" />

</LinearLayout> 
```

这是对话框代码，没有什么特别的......

```
public PromptAndSpinnerDialog(Context context, int title, int message, String text, int selectedIndex, Integer[] items, int okButtonID)
{
    super(context);
    theContext = context;
    setTitle(title);
    if (message > 0)
        setMessage(message);

    init(text, selectedIndex, items, okButtonID);
}

public PromptAndSpinnerDialog(Context context, int title, String message, String text, int selectedIndex, Integer[] items, int okButtonID)
{
    super(context);
    theContext = context;
    setTitle(title);
    setMessage(message);

    init(text, selectedIndex, items, okButtonID);
}

private void init(String text, int selectedIndex, Integer[] items, int okButtonID)
{
    View v = LayoutInflater.inflate(getContext(), R.layout.dialog_prompt_and_spinner);
    setView(v);

    setPositiveButton(okButtonID, this);
    setNegativeButton(R.string.cancel, this);

    getReferences(v);

    etInput.setText(text);
    etInput.selectAll();

    String[] strings = new String[items.length];
    for (int i = 0; i < items.length; i++)
        strings[i] = theContext.getString(items[i]);

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(theContext, R.layout.sherlock_spinner_item, strings);
    adapter.setDropDownViewResource(R.layout.sherlock_spinner_dropdown_item);
    spItems.setAdapter(adapter);

    if (selectedIndex != -1)
        spItems.setSelection(selectedIndex);
} 
```

# testing - 如何在 AngularJs 中使用私有方法编写可测试的控制器？

> ID：15966989
> 
> 赞同：57
> 
> 时间：2013-04-12T08:53:40.897
> 
> 标签：testing, angularjs, tdd

好的，所以我很长时间以来一直在偶然发现一些问题，我想听听社区其他人的意见。

首先，让我们看一些抽象控制器。

```
function Ctrl($scope, anyService) {

   $scope.field = "field";
   $scope.whenClicked = function() {
      util();
   };

   function util() {
      anyService.doSmth();
   }

} 
```

显然我们在这里：

*   `$scope`注入了一些服务的控制器的常规脚手架
*   附加到范围的一些字段和功能
*   私有方法`util()`

现在，我想在单元测试（Jasmine）中介绍这个类。但是，问题是我想验证当我单击（调用`whenClicked()`）某个项目时，该`util()`方法将被调用。我不知道该怎么做，因为在 Jasmine 测试中，我总是遇到错误，即 mock for`util()`尚未定义或未调用。

**注意：我不是要修复这个特定的例子，我是在问一般测试这样的代码模式。所以请不要告诉我“什么是确切的错误”。我问的是如何做到这一点，而不是如何解决这个问题。**

我一直在尝试多种方法来解决这个问题：

*   显然我不能`$scope`在我的单元测试中使用，因为我没有将此函数附加到该对象（它通常以消息`Expected spy but got undefined`或类似结尾）
*   我尝试通过将这些函数附加到控制器对象`Ctrl.util = util;`，然后验证模拟，`Ctrl.util = jasmine.createSpy()`但在这种情况下`Ctrl.util`没有被调用，因此测试失败
*   我试图改变`util()`以附加到`this`对象并再次嘲笑`Ctrl.util`，但没有运气

好吧，我无法解决这个问题，我希望 JS ninjas 能提供一些帮助，一个工作小提琴将是完美的。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-11-26T20:49:56.567

您提供的控制器函数将被 Angular 用作构造函数；在某些时候，它将被调用`new`以创建实际的控制器实例。如果你真的需要在你的控制器对象中拥有不暴露给 $scope 但可用于间谍/存根/模拟的函数，你可以将它们附加到`this`.

```
function Ctrl($scope, anyService) {

  $scope.field = "field";
  $scope.whenClicked = function() {
    util();
  };

  this.util = function() {
    anyService.doSmth();
  }
} 
```

当您现在调用`var ctrl = new Ctrl(...)`或使用 Angular`$controller`服务来检索`Ctrl`实例时，返回的对象将包含该`util`函数。

你可以在这里看到这种方法：http: [//jsfiddle.net/yianisn/8P9Mv/](http://jsfiddle.net/yianisn/8P9Mv/)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-05-17T18:59:06.110

在范围上命名空间是污染。您要做的是将该逻辑提取到一个单独的函数中，然后将其注入到您的控制器中。IE

```
function Ctrl($scope, util) {

   $scope.field = "field";
   $scope.whenClicked = function() {
      util();
   };
}

angular.module("foo", [])
       .service("anyService", function(...){...})
       .factory("util", function(anyService) {
              return function() {
                     anyService.doSmth();
              };
       }); 
```

现在您可以使用模拟您的 Ctrl**和**“util”进行单元测试。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-05-13T08:41:30.620

我将采用不同的方法。您不应该测试私有方法。这就是为什么它们是私有的 - 这是一个与使用无关的实现细节。

例如，如果您意识到 util 曾在多个地方使用过，但现在，基于其他代码重构，它只在这个地方被调用。为什么有额外的函数调用？只需包含`anyService.doSmith()`在您的内部`$scope.whenClicked()`根据上面的建议，假设您正在测试`util()`被调用，即使您没有更改程序的功能，您的测试也会中断。单元测试的主要价值之一是在不破坏事物的情况下简化重构，所以如果你没有破坏事物，测试就不应该失败。

你需要做的是确保当`$scope.whenClicked`被调用时，`anyService.doSmth()`也被调用。您只需：

```
spyOn(anyService,'doSmith')
scope.whenClicked();
expect(anyService.doSmith).toHaveBeenCalled(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-15T09:49:11.757

我正在添加一个包含我当前方法的答案，希望得到一些评论，并可能引发关于这是否是一个好的解决方案的讨论。

我们将私有函数附加到控制器函数（从而使它们公开，从而启用模拟）。为了避免必须一直重复控制器名称并使语法更具吸引力，我们正在创建`self`包含对控制器函数的引用的对象。所以它变成：

```
function Ctrl($scope, anyService) {

   $scope.field = "field";
   $scope.whenClicked = function() {
      self.util();
   };

   var self = Ctrl; // For the sake of syntax simplicity only

   self.util = function() {
      anyService.doSmth();
   };

} 
```

然后在单元测试中我们现在可以使用：

```
Ctrl.util = jasmine.createSpy("util()");
expect(Ctrl.util).toHaveBeenCalled(); 
```

我仍然不太喜欢这个，但我认为这是最简单的方法。我希望有人会找到更好的方法。

# mysql - 跨平台的 MD5 散列

> ID：15966990
> 
> 赞同：0
> 
> 时间：2013-04-12T08:53:41.420
> 
> 标签：mysql, vb.net, hash, md5

我正在开发的网站使用 MD5 对登录密码进行哈希处理。

一个用户刚刚忘记了他的密码，所以我在数据库中，我将密码设置为我的一个......

```
update users set pass = md5('thiS1smyp4s5w@rd')
where userid = 974 
```

虽然应用程序使用 MD5 散列并且我已经使用 Md5 散列设置了密码，但我仍然无法使用该用户的详细信息登录，我想知道......

散列算法是否跨平台相同，或者它在 .NET 中的完成方式与它在 MySQL 中的工作方式是否会导致散列值不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-24T23:28:18.830

1.  请不要使用 MD5 来散列密码，这不安全；[使用 BCrypt 或 PBKDF2](https://northernoptic.com/2015/09/10/the-lead-developer-lightening-talk-practical-web-security-junade-ali/)。
2.  无论平台如何， MD5 规范[都应该是一致的](http://www.kleinschmidt.com/edi/md5.htm)，也就是说可能导致问题的一件事是输出的十六进制中的字母可能是不同的大小写（例如大写而不是小写），这仅在区分大小写时才重要数据库查询。
3.  也就是说，可以对密码进行加盐以防止[字典攻击](https://en.wikipedia.org/wiki/Dictionary_attack)，加盐哈希与未加盐的哈希完全不同，这要归功于[雪崩效应](https://en.wikipedia.org/wiki/Avalanche_effect)。

# regex - MongoDB反向正则表达式

> ID：15966991
> 
> 赞同：6
> 
> 时间：2013-04-12T08:53:42.990
> 
> 标签：regex, mongodb

我在 MongoDB 中有一个带有正则表达式属性的文档

```
 {
        _id: ObjectId("516023189732da20ce000004"),
        regex: /^(my|your)\s+regex$/
    } 
```

我需要用类似的东西来检索这个文档`db.col.find({regex: 'your regex'})`and `db.col.find({regex: 'my regex'})`。在 MySQL 中，我会这样做：`SELECT * FROM table WHERE 'my regex' REGEXP table.regex`. 如何在 MongoDB 中实现这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-13T15:36:32.560

您可以按以下方式使用 $where 运算符：

```
db.col.find({$where: "\"my regex\".match(this.regex)"}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-11-15T19:07:37.603

正如[@fgalan](https://stackoverflow.com/users/1485926/fgalan)在 2013 年提供的[Jira 票证](https://jira.mongodb.org/browse/SERVER-13902)中所解释的那样，您可以使用您可以使用此查询：`$expr`

```
db.collection.find({
  "$expr": {
    "$regexMatch": {
      "input": "$key",
      "regex": "$regex",
      "options": "i"
    }
  }
}) 
```

[这里的](https://mongoplayground.net/p/1a6spSvU8_Q)例子

有了`$expr`你可以避免`$where`哪些是无效的。

# jquery - 如何在 jquery 中正确编写“不等于”运算符

> ID：15966997
> 
> 赞同：-1
> 
> 时间：2013-04-12T08:54:11.233
> 
> 标签：jquery

我的正文部分有以下代码：

```
<form action="" method="post">
    <select id="fruits" name="fruits">
        <option>Apple</option>
        <option>Mango</option>
        <option>Orange</option>
    </select>
    <select id="color" name="color">
        <option>Red</option>
        <option>Green</option>
        <option>Yellow</option>
    </select>
    <input type="text" id="result" value="" /> 
```

我想要做什么，如果用户从水果中选择苹果或芒果并从第二个下拉菜单中更改颜色，“正确的选择”将出现在#result 输入中。另一方面，如果用户从水果中选择橙色并更改颜色选项，则在#result 输入中不会看到任何变化。所以jquery代码会是这样的：

```
$("#color").change(function() {
    if($("#fruits").val()!="Orange"){ $("#result").val("Right Choice"); }
}); 
```

但不知道为什么，这段代码不能正常工作，选择所有水果正在将#result输入的文本更改为“正确的选择”。但是，如果我按以下方式更改代码，它就可以工作：

```
$("#color").change(function() {
    if($("#fruits").val()=="Orange"){
        /*--do nothing--*/
    }else{
        $("#result").val("Right Choice");
    }
}); 
```

第一个代码和第二个代码都具有相同的逻辑条件，但为什么 jquery 代码不适用于第一种情况？

**更新：**我发现如果我把一个不等于条件，它工作正常，但如果我使用“或”运算符代码不起作用：

```
$("#color").change(function() {
    if($("#fruits").val()!="Orange" || $("#fruits").val()!="Mango"){
        $("#result").val("Right Choice"); 
    }
}); 
```

它不工作，但它正在工作：

```
$("#color").change(function() {
    if($("#fruits").val()!="Orange"){
        $("#result").val("Right Choice"); 
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T09:03:49.207

有几个问题。

1.  如果条件失败，您不会更改文本框的值；这意味着如果它已经显示“正确选择”，那么即使您选择了无效选项（“橙色”），它也不会更新并且仍然会显示“正确选择”。
2.  你不会对`#fruits`元素的值变化做出反应，这意味着如果你选择一种颜色，*然后*选择“橙色”作为水果，它仍然会说“正确的选择”。

您可能应该这样做，同时将`change`事件处理程序绑定到`<select id="fruits">`：

```
$("#color").change(function () {
    if ($("#fruits").val() != "Orange") {
        $("#result").val("Right Choice");
    }
    else {
        $("#result").val("");   
    }
});

$("#fruits").change(function() {
    if(this.value != "Orange") {
        $("#result").val("Right Choice");
    }
    else {
        $("#result").val("");   
    }
}); 
```

我还创建了一个[jsFiddle 演示](http://jsfiddle.net/j8b4s/1/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:04:01.237

像这样的东西

```
$("#color").change(function() {
    if($("#fruits").val()!="Orange"){ 
        $("#result").val("Right Choice"); 
    } else {
        $("#result").val("");
    }
}); 
```

[JS 小提琴演示](http://jsfiddle.net/YmDqA/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:57:24.777

两者是不同的。在您之前的代码中，您与 (!= orange) 进行比较，而在下一个代码中，您将与 (= orange) 进行比较。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T09:06:32.867

这对我来说效果更好（不一定是你想要的）

[演示](http://jsfiddle.net/mplungjan/VPBfj/)

```
$("#color, #fruits").change(function() {
    var val = $("#fruits").val();
    window.console && console.log("fruit:",val);
    $("#result").val(val=="Orange"?"":"Right Choice");
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-12T09:07:52.547

您的代码应该像这样在 jquery 的 dom 就绪功能中打开

```
$(document).ready(function() {
    $("#color").change(function() {
    if($("#fruits").val()!="Orange"){ $("#result").val("Right Choice"); }
    });
}); 
```

# ios - 用于 Google Places API 的 Objective-C + JSON Parse objectForKey

> ID：15966999
> 
> 赞同：2
> 
> 时间：2013-04-12T08:54:18.897
> 
> 标签：ios, objective-c, xcode, json, parsing

我有这个：

```
 //request stuff
NSString *searchString = [NSString stringWithFormat:@"Sydney"];
NSString *urlString = [NSString stringWithFormat:@"https://maps.googleapis.com/maps/api/place/textsearch/json?query=%@&sensor=true&key=mykeynotyours!",searchString];

NSURL *requestURL = [NSURL URLWithString:urlString];
NSURLRequest *request = [NSURLRequest requestWithURL:(requestURL)];

//response
NSData *response = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
NSError *jsonParsingError = nil;
NSDictionary *locationResults = [NSJSONSerialization JSONObjectWithData:response options:0 error:&jsonParsingError];

NSLog(@"%@",locationResults); 
```

这会吐出一些结果，其中第一个是我想要的结果，但我无法像使用其他 API 那样得到 lat 和 lng：

```
NSString *stringLatitude = [locationResults objectForKey:@"lat"]; 
```

我怀疑它正在寻找的键是“结果”键的一个子集，我不知道如何告诉它:-(

结果：

```
 2013-04-12 18:47:49.784 Test[26984:c07] {
"html_attributions" =     (
);
results =     (
            {
        "formatted_address" = "Sydney NSW, Australia";
        geometry =             {
            location =                 {
                lat = "-33.8674869";
                lng = "151.2069902";
            };
            viewport =                 {
                northeast =                     {
                    lat = "-33.4245981";
                    lng = "151.3426361";
                };
                southwest =                     {
                    lat = "-34.1692489";
                    lng = "150.502229";
                };
            };
        }; 
```

感谢任何指导！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T09:05:06.223

您可以使用以下代码访问几何 lat 和 lang

```
NSString *stringLatitude = [[[[[locationResults objectForKey:@"results"] objectAtIndex:0] objectForKey:@"geometry"] objectForKey:@"location"] valueForKey:@"lat"];
NSString *stringLongitude = [[[[[locationResults objectForKey:@"results"] objectAtIndex:0] objectForKey:@"geometry"] objectForKey:@"location"] valueForKey:@"lng"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:20:44.410

用这个

```
 NSString *stringLatitude = [[[[[locationResults objectForKey:@"results" ]objectAtIndex:0] objectForKey:@"geometry"] objectForKey:@"location"] objectForKey:@"lat"];
 NSString *stringLongitude = [[[[[locationResults objectForKey:@"results" ]objectAtIndex:0] objectForKey:@"geometry"] objectForKey:@"location"] objectForKey:@"lng"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-19T20:44:31.133

使用 iOS 7？将此放入您的项目中：[https ://github.com/gdyer/GDGooglePlaces](https://github.com/gdyer/GDGooglePlaces)

然后……就用这个`- (id)initWithPlaceCategory:(NSString *)_category urlStub:(NSString *)_stub lat:(float)\ _lat andLon:(float)_lon;`

映射、解析、查看、方向、共享等都为您处理。