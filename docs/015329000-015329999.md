# StackOverflow 问答 15329000-15329999

# c# - ASP.NET 浏览器缓存导致问题

> ID：15329000
> 
> 赞同：0
> 
> 时间：2013-03-10T23:23:41.340
> 
> 标签：c#, asp.net, browser-cache

我一直在寻找这个问题的答案，但我不确定我问的是否正确。

我正在寻找开发人员在这种情况下会做什么：

我正在开发一个 ASP.NET C# 应用程序。我有 CSS 和 SCRIPT 文件，我正在使用 jQuery。我将我的应用程序安装到 Web 服务器（或者我让我的客户安装它们）。如果我通过添加一些新的 jQuery 或其他东西对我的脚本文件进行了任何更改，我的客户在我进行更新后不会得到这种效果。我认为原因是他们的浏览器将文件缓存在本地计算机上，他们现在确实从服务器下载了新文件。

在我的开发环境中，我在关闭浏览器时清除缓存，在 IE 上，我在选项中告诉它始终从服务器加载。这样在开发时我从来没有缓存过数据。

确保如果我进行更改，这些文件在我进行更新后在客户端计算机上刷新的最佳做法是什么？代码中有什么我可以做的吗？

我真的不想更改文件名并更新我所有的脚本引用。

谢谢，科里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T23:27:21.040

传统方法是将查询字符串参数附加到对 css/script 文件路径的引用的末尾。例如，如果您将内部版本号附加为查询字符串，则软件的每个版本都会对相关资源提出自己的请求。

# android - Android showAlertDialog函数，R.drawable.success和fail

> ID：15329006
> 
> 赞同：3
> 
> 时间：2013-03-10T23:24:53.010
> 
> 标签：android, android-alertdialog, android-drawable

我有一个来自在线示例代码的 showAlertDialog 类，其中一行给了我一个问题：

```
 alertDialog.setIcon((status) ? R.drawable.success : R.drawable.fail); 
```

它告诉我“成功无法解决或不是一个领域”和“失败无法解决或不是一个领域”。有没有我应该拥有/放置这些图标的地方？我在哪里可以找到它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T23:26:26.423

为了便于修复，这些图标应该在您的`res/drawable`文件夹中。如果您从未制作过这些图标，则需要这样做。通过 Photoshop/图像编辑器/来自互联网/任何地方。但它们确实**需要**存在。

它们的文件名（假设为 png 扩展名）应该是：

```
success.png

fail.png 
```

然而，这在不同的设备上看起来很糟糕，因为`drawable`你的drawables的密度独立文件夹。

相反，为 ldpi、mdpi、hdpi 和 xhdpi 制作不同的尺寸，然后将您的图标放在那里。

您的文件夹结构应该是：

```
res/
   drawable-ldpi/
   drawable-mdpi/
   drawable-hdpi/
   drawable-xhdpi/ 
```

有关更多信息，请阅读[支持多个屏幕](http://developer.android.com/guide/practices/screens_support.html)和[为多个屏幕设计](http://developer.android.com/training/multiscreen/index.html)。

# assembly - 汇编器凯撒密码可能与比较错误

> ID：15329011
> 
> 赞同：1
> 
> 时间：2013-03-10T23:26:14.067
> 
> 标签：assembly, syntax, x86, compare, encryption

我对凯撒密码的代码有疑问。我不会将我的评论更改为英语，但无论如何它们并不多。该程序由两个程序组成。一个是对凯撒密码进行编码，另一个是对凯撒密码进行解码。我这样做了，所以当我按 0 时，它应该运行编码部分，当我按 1 时，它应该运行解码部分。

编码程序应该像这样工作`"0" -> "abc" -> "A" -> "bcd"`，而解码则改为“zab”。

糟糕的是，每当我按 0 或 1 时，它都会进行编码或解码。例如，如果有：

```
cmp $'0' , %bl
je LOOP1

cmp $'1' , %bl
je LOOP2 
```

程序将在 0 和 1 编码后运行。如果我像在完整代码上一样更改它，即使我按 0（与 1 相同），它也会运行解码。所以可能比较有错误..

完整代码：

```
SYSCALL = 0X80
STDIN = 0
STDOUT = 1
SYSREAD = 3
SYSWRITE = 4
SYSEXIT = 1
EXIT_SUCCESS = 0

.data
msg_hello: .ascii "0-kodowanie 1-dekodowanie"
msg_hello_len = . - msg_hello

WYBOR_MAXLEN = 1
WYBOR: .space WYBOR_MAXLEN
WYBOR_LEN: .long 0

TEXT_MAXLEN = 64
TEXT: .space TEXT_MAXLEN
TEXT_LEN: .long 0

KEY_MAXLEN = 2
KEY: .space KEY_MAXLEN
KEY_LEN: .byte

.text
.global _start

_start:
#wczytanie powitania
mov $SYSWRITE, %eax
mov $STDOUT, %ebx
mov $msg_hello, %ecx
mov $msg_hello_len, %edx
int $SYSCALL

# wczytanie 01
mov $TEXT_MAXLEN, %edx
mov $TEXT, %ecx
mov $STDIN, %ebx
mov $SYSREAD, %eax
int $SYSCALL

mov %ebx, WYBOR_LEN # wybor

# wczytanie tekstu
mov $TEXT_MAXLEN, %edx
mov $TEXT, %ecx
mov $STDIN, %ebx
mov $SYSREAD, %eax
int $SYSCALL

mov %eax, TEXT_LEN # rzeczywista dlugosc wczytanego tekstu

#wczytywanie klucza
mov $KEY_MAXLEN, %edx
mov $KEY, %ecx
mov $STDIN, %ebx
mov $SYSREAD, %eax
int $SYSCALL

mov %eax, KEY_LEN # dlugosc klucza

xor %edx, %edx
movb KEY, %dl
sub $'A', %edx
add $1, %edx

mov $WYBOR_LEN, %ebx

cmp $'0' , %bl
je LOOP1

#cmp $'1' , %bl
jne LOOP2

#szyfr cezara
#klucz w edx

LOOP1:

mov $0, %ecx # licznik petli
sub $1, TEXT_LEN

ENCRYPTION_LOOP:
mov TEXT(, %ecx, 1), %eax #przesuwamy aktualny znak do rejestru al
cmp $'A', %al
jb DONT_ENCRYPT_CHAR
cmp $'z', %al
ja DONT_ENCRYPT_CHAR
cmp $'Z', %al
jna ENCRYPT_CHAR
cmp $'a', %al
jb DONT_ENCRYPT_CHAR

ENCRYPT_CHAR:
add %edx, %eax
cmp $'z', %al
jae CORRECT_CHAR_CODE
cmp $'a', %al
jae CHAR_CODE_OK
cmp $'Z', %al

ja CORRECT_CHAR_CODE
jmp CHAR_CODE_OK
CORRECT_CHAR_CODE:
sub $26, %al
CHAR_CODE_OK:
movb %al, TEXT(, %ecx, 1)
DONT_ENCRYPT_CHAR:
add $1, %ecx # inkrementacja licznika petli
cmp %ecx, TEXT_LEN
jne ENCRYPTION_LOOP

add $1, TEXT_LEN

jmp WYSWIETL

LOOP2:

mov $0, %ecx # licznik petli
sub $1, TEXT_LEN

DECRYPTION_LOOP:
mov TEXT(, %ecx, 1), %eax #przesuwamy aktualny znak do rejestru al
cmp $'A', %al
jb DONT_DECRYPT_CHAR
cmp $'z', %al
ja DONT_DECRYPT_CHAR
cmp $'Z', %al
jna DECRYPT_CHAR
cmp $'a', %al
jb DONT_DECRYPT_CHAR

DECRYPT_CHAR:
sub %edx, %eax
cmp $'A', %al
jb CORRECT_CHAR_CODE2
cmp $'Z', %al
jbe CHAR_CODE_OK2
cmp $'a', %al
jb CORRECT_CHAR_CODE2
jmp CHAR_CODE_OK2

ja CORRECT_CHAR_CODE2
jmp CHAR_CODE_OK2

CORRECT_CHAR_CODE2:
add $26, %al

CHAR_CODE_OK2:
movb %al, TEXT(, %ecx, 1)

DONT_DECRYPT_CHAR:
add $1, %ecx # inkrementacja licznika petli
cmp %ecx, TEXT_LEN
jne DECRYPTION_LOOP

add $1, TEXT_LEN

jmp WYSWIETL

WYSWIETL:
#wyswietlanie tekstu
mov TEXT_LEN, %edx
mov $TEXT, %ecx
mov $STDOUT, %ebx
mov $SYSWRITE, %eax
int $SYSCALL

EXIT:
# zakonczenie programu
mov $EXIT_SUCCESS, %ebx
mov $SYSEXIT, %eax
int $SYSCALL 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T23:43:08.193

这里有一些错误：

```
#wczytywanie klucza
mov $KEY_MAXLEN, %edx
mov $KEY, %ecx
mov $STDIN, %ebx
mov $SYSREAD, %eax
int $SYSCALL

mov %eax, KEY_LEN # dlugosc klucza

xor %edx, %edx
movb KEY, %dl 
sub $'A', %edx
add $1, %edx

mov $WYBOR_LEN, %ebx ; ebx = number of characters

cmp $'0' , %bl ; bl = and(0xff, number of characters)
je LOOP1

cmp $'1' , %bl ; bl = and(0xff, number of characters)
# jne LOOP2    ; this should be je LOOP2, not jne LOOP2

#szyfr cezara
#klucz w edx

LOOP1: 
```

您不比较密钥，但是`$WYBOR_LEN`，因此：

```
mov $WYBOR_LEN, %ebx 
```

然后，即使碰巧`bl`不是`'0'`( `0x30`) 或`'1'`( `0x31`)，您也没有任何错误处理，因此代码仍然继续到`LOOP1`.

要修复错误，您可以执行以下操作：

```
xor %edx, %edx
movb KEY, %dl
sub $'A', %edx
add $1, %edx

movb KEY, %bl   ; store the value from KEY to bl before comparison.

cmp $'0' , %bl
je LOOP1

cmp $'1' , %bl
je LOOP2

; print here some message to inform user that the input is invalid.

jmp _start

#szyfr cezara
#klucz w edx

LOOP1: 
```

# android - 从相机获取全质量图片并上传？

> ID：15329025
> 
> 赞同：2
> 
> 时间：2013-03-10T23:27:55.650
> 
> 标签：android, image, upload, android-camera

我正在尝试让我的应用上传从手机摄像头拍摄的完整质量图像。我有整个上传工作，除了唯一的问题是生成的图像是一个非常小的位图。我很想获得完整质量的图像。谁能帮我？这是我的代码。

```
public class UploadActivity extends Activity {

    public final static int CAMERA_REQUEST = 1888;
    InputStream is;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_upload);
        Button takePicture = (Button) findViewById(R.id.take_picture_button);
        takePicture.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Intent takePictureIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
                startActivityForResult(takePictureIntent, CAMERA_REQUEST);      
            }
        });
        Button uploadButton = (Button) findViewById(R.id.send_button);
        uploadButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {

            }
        });
    }

    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        ImageView mImageView = (ImageView) findViewById(R.id.ivUserImage);
        Bundle extras = data.getExtras();
        Bitmap mImageBitmap = (Bitmap) extras.get("data");
        mImageView.setImageBitmap(mImageBitmap);
        new fileUpload().execute(mImageBitmap);
    }

    public class fileUpload extends AsyncTask<Object, Void, Void> {
        @Override
        protected Void doInBackground(Object... param) {
            Bitmap bitmapOrg = (Bitmap) param[0];
            ByteArrayOutputStream bao = new ByteArrayOutputStream();
            bitmapOrg.compress(Bitmap.CompressFormat.JPEG, 90, bao);
            byte[] ba = bao.toByteArray();
            String ba1=Base64.encodeBytes(ba);

            ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
            nameValuePairs.add(new BasicNameValuePair("image",ba1));

            try {
                HttpClient httpclient = new DefaultHttpClient();
                HttpPost httppost = new HttpPost("http://example.info/appserver/upload.php");
                httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                HttpResponse response = httpclient.execute(httppost);
                HttpEntity entity = response.getEntity();
                is = entity.getContent();
            } catch(Exception e){
                Log.e("log_tag", "Error in http connection "+e.toString());
            }
            return null;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T23:36:21.390

当您使用从额外读取位图时，您将获得图像的缩略图。

您可以在此处找到使用相机的一个很好的示例：[https ://stackoverflow.com/a/5071133/2045570](https://stackoverflow.com/a/5071133/2045570)

# scala - 字符串插值和宏：如何获取 StringContext 和表达式位置

> ID：15329027
> 
> 赞同：15
> 
> 时间：2013-03-10T23:28:16.540
> 
> 标签：scala, macros, scala-2.10, string-interpolation

我正在尝试使用宏实现自定义字符串插值方法，我需要一些有关使用 API 的指导。

这是我想做的事情：

```
/** expected
  * LocatedPieces(List(("\nHello ", Place("world"), Position()), 
                       ("\nHow are you, ", Name("Eric"), Position(...)))
  */
val locatedPieces: LocatedPieces = 
  s2"""
    Hello $place

    How are you, $name
    """

val place: Piece = Place("world")
val name: Piece = Name("Eric")

trait Piece
case class Place(p: String) extends Piece
case class Name(n: String) extends Piece

/** sequence of each interpolated Piece object with:
  * the preceding text and its location
  */  
case class LocatedPieces(located: Seq[(String, Piece, Position)]) 

implicit class s2pieces(sc: StringContext) {
  def s2(parts: Piece*) = macro s2Impl
}

def impl(c: Context)(pieces: c.Expr[Piece]*): c.Expr[LocatedPieces] = {
  // I want to build a LocatedPieces object with the positions for all 
  // the pieces + the pieces + the (sc: StringContext).parts
  // with the method createLocatedPieces below
  // ???     
} 

def createLocatedPieces(parts: Seq[String], pieces: Seq[Piece], positions: Seq[Position]):
  LocatedPieces = 
  // zip the text parts, pieces and positions together to create a LocatedPieces object
  ??? 
```

我的问题是：

1.  如何访问`StringContext`宏内的对象以获取所有`StringContext.parts`字符串？

2.  我怎样才能抓住每件的位置？

3.  如何调用`createLocatedPieces`上面的方法并具体化结果以获得宏调用的结果？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-11T16:22:59.097

经过几个小时的努力，我找到了一个可运行的解决方案：

```
object Macros {

  import scala.reflect.macros.Context
  import language.experimental.macros

  sealed trait Piece
  case class Place(str: String) extends Piece
  case class Name(str: String) extends Piece
  case class Pos(column: Int, line: Int)
  case class LocatedPieces(located: List[(String, Piece, Pos)])

  implicit class s2pieces(sc: StringContext) {
    def s2(pieces: Piece*) = macro s2impl
  }

  // pieces contain all the Piece instances passed inside of the string interpolation
  def s2impl(c: Context)(pieces: c.Expr[Piece]*): c.Expr[LocatedPieces] = {
    import c.universe.{ Name => _, _ }

    c.prefix.tree match {
      // access data of string interpolation
      case Apply(_, List(Apply(_, rawParts))) =>

        // helper methods
        def typeIdent[A : TypeTag] =
          Ident(typeTag[A].tpe.typeSymbol)

        def companionIdent[A : TypeTag] =
          Ident(typeTag[A].tpe.typeSymbol.companionSymbol)

        def identFromString(tpt: String) =
          Ident(c.mirror.staticModule(tpt))

        // We need to translate the data calculated inside of the macro to an AST
        // in order to write it back to the compiler.
        def toAST(any: Any) =
          Literal(Constant(any))

        def toPosAST(column: Tree, line: Tree) =
          Apply(
            Select(companionIdent[Pos], newTermName("apply")),
            List(column, line))

        def toTupleAST(t1: Tree, t2: Tree, t3: Tree) =
          Apply(
            TypeApply(
              Select(identFromString("scala.Tuple3"), newTermName("apply")),
              List(typeIdent[String], typeIdent[Piece], typeIdent[Pos])),
            List(t1, t2, t3))

        def toLocatedPiecesAST(located: Tree) =
          Apply(
            Select(companionIdent[LocatedPieces], newTermName("apply")),
            List(located))

        def toListAST(xs: List[Tree]) =
          Apply(
            TypeApply(
              Select(identFromString("scala.collection.immutable.List"), newTermName("apply")),
              List(AppliedTypeTree(
                typeIdent[Tuple3[String, Piece, Pos]],
                List(typeIdent[String], typeIdent[Piece], typeIdent[Pos])))),
            xs)

        // `parts` contain the strings a string interpolation is built of
        val parts = rawParts map { case Literal(Constant(const: String)) => const }
        // translate compiler positions to a data structure that can live outside of the compiler
        val positions = pieces.toList map (_.tree.pos) map (p => Pos(p.column, p.line))
        // discard last element of parts, `transpose` does not work otherwise
        // trim parts to discard unnecessary white space
        val data = List(parts.init map (_.trim), pieces.toList, positions).transpose
        // create an AST containing a List[(String, Piece, Pos)]
        val tupleAST = data map { case List(part: String, piece: c.Expr[_], Pos(column, line)) =>
          toTupleAST(toAST(part), piece.tree, toPosAST(toAST(column), toAST(line)))
        }
        // create an AST of `LocatedPieces`
        val locatedPiecesAST = toLocatedPiecesAST(toListAST(tupleAST))
        c.Expr(locatedPiecesAST)

      case _ =>
        c.abort(c.enclosingPosition, "invalid")
    }
  }
} 
```

用法：

```
object StringContextTest {
  val place: Piece = Place("world")
  val name: Piece = Name("Eric")
  val pieces = s2"""
    Hello $place
    How are you, $name?
  """
  pieces.located foreach println
} 
```

结果：

```
(Hello,Place(world),Pos(12,9))
(How are you,,Name(Eric),Pos(19,10)) 
```

我没想到要花这么多时间才能把所有东西放在一起，但那是一段有趣的时光。我希望代码符合您的要求。如果您需要有关特定事物如何运作的更多信息，请查看其他问题及其对 SO 的回答：

*   [有关如何构建 AST 的信息](https://stackoverflow.com/questions/14790115/where-can-i-learn-about-constructing-asts-for-scala-macros)
*   [如何合作`TypeTag`](https://stackoverflow.com/questions/12218641/scala-2-10-what-is-a-typetag-and-how-do-i-use-it)
*   [如何`reify`在 REPL 中使用来获取有关 AST 的信息](https://stackoverflow.com/questions/11055210/whats-the-easiest-way-to-use-reify-get-an-ast-of-an-expression-in-scala)

非常感谢 Travis Brown（见评论），我得到了一个更短的编译解决方案：

```
object Macros {

  import scala.reflect.macros.Context
  import language.experimental.macros

  sealed trait Piece
  case class Place(str: String) extends Piece
  case class Name(str: String) extends Piece
  case class Pos(column: Int, line: Int)
  case class LocatedPieces(located: Seq[(String, Piece, Pos)])

  implicit class s2pieces(sc: StringContext) {
    def s2(pieces: Piece*) = macro s2impl
  }

  def s2impl(c: Context)(pieces: c.Expr[Piece]*): c.Expr[LocatedPieces] = {
    import c.universe.{ Name => _, _ }

    def toAST[A : TypeTag](xs: Tree*): Tree =
      Apply(
        Select(Ident(typeOf[A].typeSymbol.companionSymbol), newTermName("apply")),
        xs.toList)

    val parts = c.prefix.tree match {
      case Apply(_, List(Apply(_, rawParts))) =>
        rawParts zip (pieces map (_.tree)) map {
          case (Literal(Constant(rawPart: String)), piece) =>
            val line = c.literal(piece.pos.line).tree
            val column = c.literal(piece.pos.column).tree
            val part = c.literal(rawPart.trim).tree
            toAST[(_, _, _)](part, piece, toAST[Pos](line, column))
      }
    }
    c.Expr(toAST[LocatedPieces](toAST[Seq[_]](parts: _*)))
  }
} 
```

它对冗长的 AST 结构进行了抽象，其逻辑略有不同但几乎相同。如果您在理解代码的工作原理上有困难，请先尝试理解第一个解决方案。它的作用更加明确。

# git - 如何在不丢失 Git 上一次提交的情况下返回上一次提交？

> ID：15329028
> 
> 赞同：20
> 
> 时间：2013-03-10T23:28:45.243
> 
> 标签：git

这就是我想要做的。我想回到之前的 2 次提交，可能会将在该提交中更改的文件作为新提交带回。但我不想失去我的最后一次提交。我的最后一次提交在代码中有一些错误，但我想暂时保留那个。

我阅读了一些文档，但没有人清楚说明重置头部时会发生什么。例如，您是否会丢失所有提交，直到您要重置（向后）的提交？

我试图了解这一切是如何工作的，但我对 git和`revert`命令感到相当困惑。`reset``checkout`

我意识到我应该隐藏最后一次提交而不是提交，但现在这是另一个故事。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-12T19:20:00.130

如果你想回去，比如之前的 2 次提交，你可以做`git checkout HEAD~2`. 这会让你们都像当时一样。如果你在分支上`master`，`git checkout master`会带你回到现在。但是，如果您想保持当前状态但在那里开始一个新的开发分支，`git checkout -b HEAD~2`将在那里开始一个新的分支。如果您想倒带 master 但又不想丢失当前未完成/损坏的工作，请执行

```
git branch wip           # New branch ends a current tip
git reset --hard HEAD~2  # Old branch rewound, get files from then 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-10T23:39:33.903

`revert`进行新的提交，以恢复旧提交所做的更改。`reset --hard`将当前分支的 HEAD 更改为指定的提交。`checkout`将工作副本切换到指定的分支或提交。

`reflog`当您将分支重置为较旧的提交时，如果新提交不是其他分支的一部分或标签的祖先（尽管它们仍然可以访问），则它们将丢失。

目前尚不清楚您需要做什么，最可能的解决方案是`revert`（完全还原较旧的提交或一系列提交）和`rebase -i`（更改较旧的提交或将其从历史记录中删除）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-19T17:11:26.787

您可以看到最后的哈希值，这些哈希值对于`$ git reflog`在丢失最后一次提交后通过强制从上一次提交进行推送后返回到之前的状态很有用。

还：

```
$ git fsck --no-reflog
$ git show <hash>
$ git checkout -b <new-branch> <hash> 
```

总帐

[来源](https://stackoverflow.com/a/35237463/5279996)

# date - DateTime 格式格式不正确

> ID：15329030
> 
> 赞同：-1
> 
> 时间：2013-03-10T23:29:29.497
> 
> 标签：date, format

我在 XML 中有一个日期时间格式，我正在尝试按如下方式解组这些值：

```
2013-03-17T19:12:14Z -> 2013-03-17 19:12 +0100 
```

我已经使用 Joda`DateTime`和一个`DateTimeAdapter`类来覆盖解组。日期时间格式很奇怪，如下所示：

```
{"iMillis":1363510800000,"iChronology":{"iBase":{"iBase":{"iBase":
{"iMinDaysInFirstWeek":4}},"iParam":{"iZone":{"iTransitions":    
[-9223372036854775808,-3852662325000,-1691964000000,-1680472800000,
-1664143200000,-1650146    400000,-1633903200000,-1617487200000,
-1601848800000,- etc etc. 
```

谁能帮我格式化这个日期？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T12:44:20.857

我无法弄清楚答案，所以我尝试了以下方法：

```
 SimpleDateFormat sd = new SimpleDateFormat("yyyy-MM-dd HH:mm Z");
    DateTime dateTime = new DateTime(v);
    long dateTimeMiliSec = dateTime.getMillis();
    Date date = new Date(dateTimeMiliSec);

    return sd.format(date); 
```

所以 2013-03-17T09:00:00Z 转换为 2013-03-17 09:00 +0000

# javascript - 如何可靠地防止 HTTP 引用者被发送到另一个网站？

> ID：15329032
> 
> 赞同：0
> 
> 时间：2013-03-10T23:29:45.403
> 
> 标签：javascript, http, post, http-headers, privacy

我正在尝试解决在执行 HTTP POST 后填充 HTTP 引用字段的隐私问题。

换句话说，我需要 HTTP POST 从站点 A 检索一些数据，并且想要调用站点 B。我想确保调用站点 (A) 的引用者永远不会显示在对站点 B 的 HTTP 调用中。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:04:11.503

我看不出这有什么问题。首先，使用 HTTPS[行为良好的客户端](https://www.rfc-editor.org/rfc/rfc2616#section-15.1.3)不会将引用者发送到普通的 HTTP 站点。

但解决这个问题的重点是不应该使用 GET 方法传输敏感信息（例如，它可能以日志文件结尾）。您（正确地）使用 POST 将表单发送到站点 A，因此 URI 不应成为隐私问题。如果是这种情况，请删除有问题的数据并将它们放入从 A 提供的表单中，以便它们与 POST 提交一起发送。

最后，我上次检查时，大多数浏览器不发送命名的标头。

# ajax - 在 python/Django 中多次迭代 json 对象

> ID：15329037
> 
> 赞同：3
> 
> 时间：2013-03-10T23:30:31.663
> 
> 标签：ajax, django, django-templates

我正在使用 jquery 循环遍历 json 对象...但是有些似乎不起作用...

这是我的代码，

```
$.ajax({
        type: "GET",  
        url: "/users/",  
     // data: "page="+pageNum,  
        async: false,  
        dataType: 'json',  
        success: function(data){  
//alert("OK AJAX");
           $("#search_btn").remove();
           $('#btnadduser').css('visibility','visible');

$.each(data, function() {
  $.each(this, function(k, v) {
    /// iterate through the objects
            $("#nbody").html("<tr style='background-color:#FFFFFF; font-size:14px;'>             <td>"+data.f.user4.first_name+"</td> <td>"+data.f.user4.last_name+"</td><td>"+data.f.user4.username+"</td> <td>"+data.f.user4.email+"</td> <td>"+data.f.user4.username+"</td> <td>");
              });
           });
        }
    }); 
```

当我在终端中打印 json 对象时，这就是我得到的。

```
{"f": 
     {"user4": {"username": "user4", "first_name": "Alex", "last_name": "kasina", "is_active": true, "email": "alexkasina@gmail.com"},     
      "user5": {"username": "user5", "first_name": "", "last_name": "", "is_active": false, "email": "", }, "user2": {"username":      "user2", "first_name": "", "last_name": "", "is_active": true, "email": ""}, 
      "user3": {"username": "user3", "first_name": "", "last_name": "", "is_active": true, "email": ""}, 
      "user1": {"username": "user1", "first_name": "", "last_name": "", "is_active": true, "email": ""}, 
      "lexx": {"username": "lexx", "first_name": "", "last_name": "", "is_active": true, "email": "tas.ss@df.dc"}}} 
```

我想遍历每个用户设置他们的名字，姓氏，用户名，......请帮忙？

风景

```
@login_required
def users(request):
    from django.core.serializers.json import DjangoJSONEncoder
    from django.forms.models import model_to_dict

    html = User.objects.all()
    f = {}                # initialise the output
    username = 'username'  # one of the fields from myModel
    [f.update({x[username]: x}) for x in [model_to_dict(y) for y in html]]
    result = simplejson.dumps({"f" : f}, cls=DjangoJSONEncoder)
    print result#To see the json object
return HttpResponse(result) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T03:30:39.903

视图.py

```
@login_required
def users(request):
  from django.core.serializers.json import DjangoJSONEncoder
  from django.forms.models import model_to_dict

  html = User.objects.all()
  f = [model_to_dict(x) for x in html]
  return HttpResponse(simplejson.dumps(f), cls=DjangoJSONEncoder) 
```

javascript:

```
var user_list = JSON.parse(data);
for(var i=0; i<user_list.length; i++) {
  var user_name = user_list[i]['username'];
  var first_name = user_list[i]['first_name'];
  var last_name = user_list[i]['last_name'];
  // ...
  // do something with user_name, first_name and last_name...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T19:56:52.597

这行得通！

```
 $.each(data, function(index0, l) {

         $.each(l, function(index1, n) {

             /// iterate through the objects

             var first_name = n.first_name;
             var last_name = n.last_name;
             var surname = n.username;

             // do something with user_name, first_name and last_name... 

            $("#nbody").append("<tr> <td>"+ first_name +"</td> <td>"+ last_name +"</td><td>"+ username +"</td> </tr>");

              });
           }); 
```

# data-structures - 列表和多集有什么区别？

> ID：15329038
> 
> 赞同：7
> 
> 时间：2013-03-10T23:30:32.333
> 
> 标签：data-structures

据我了解，列表和多重集都是有序值的集合，其中值可以出现多次。有什么区别吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-10T23:32:49.443

不，列表和多集是不同的。顺序在列表中很重要，而不是在多集中。

```
(list 1 2 3 2) != (list 2 1 3 2)
(multiset 1 2 2 3) == (multiset 1 3 2 2) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-10T23:54:26.813

除了顺序之外，每个容器都有自己的一组可用方法及其复杂性。例如，在列表中搜索是`o(n)`（您必须检查每个元素，直到找到一个）。搜索`multiset`是`o(log(n))`. 它通常实现为红黑树以适应此要求

# ruby-on-rails - 如何使用 Devise 在 Rails 3.2 中由管理员进行基于浏览器的新用户批准

> ID：15329041
> 
> 赞同：1
> 
> 时间：2013-03-10T23:31:03.407
> 
> 标签：ruby-on-rails, devise, ruby-on-rails-3.2

我使用 Rails 3.2 创建了一个简单的目录，并设计了新用户需要批准才能使用该站点的位置。我按照“[如何：要求管理员在登录前激活帐户](https://github.com/plataformatec/devise/wiki/How-To:-Require-admin-to-activate-account-before-sign_in)”中的说明进行操作，管理员用户现在可以查看已批准用户和未批准用户的不同索引页面列表。到目前为止，一切都很好。

我的问题是用户审批流程。目前我在 Rails 控制台中批准用户。我希望管理员用户能够通过他们的浏览器批准用户。我不知所措。我知道我需要在每个未经批准的用户旁边放置“批准”和“不批准”链接，但那又如何呢？

在摘要中，我知道单击这些链接应该激活用户模型或控制器中的方法，然后使用 flash 重定向，但我已经偏离了我从初学者教程中所知道的内容。

我不确定在我的观点和路线中添加什么。我是否需要一个特殊的隐藏表单，仅当单击“批准”提交按钮并且该按钮是唯一可见元素时才将“已批准”从 false 更改为 true？

如果有人能让我朝着正确的方向开始，我可能会从那里弄清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T19:25:34.987

@sas1ni69 的评论将我带到了[Ruby on Rails link_to With put Method](https://stackoverflow.com/questions/9305753/ruby-on-rails-link-to-with-put-method)，它让我找到了解决方案。

在我看来，我补充说：

```
<%= link_to "approve", approve_user_path(user.id)  %> 
```

在我的路线中，我添加了：

```
match 'users/:id/approve'=> 'users#approve_user', as: 'approve_user' 
```

在我的用户控制器中，我添加了：

```
def approve_user
  user = User.find(params[:id])
  user.approved = true
  if user.save
    flash[:notice] = "#{user.full_name} approved"
  else
    flash[:alert] = "#{user.full_name} approval failure"
  end
  redirect_to :back
end 
```

似乎像一个魅力一样工作！谢谢大家！

# jquery - Kendo ui 数据源：对象不支持属性或方法“_observe”

> ID：15329050
> 
> 赞同：3
> 
> 时间：2013-03-10T23:32:46.333
> 
> 标签：jquery, kendo-ui

我有一个 ASP.NET MVC 4 页面，它使用 Kendo ui 自动完成小部件从服务器检索一些 JSON 信息。

```
@{
  Layout = null;
}

<!DOCTYPE html>

<html>
<head>
  <meta name="viewport" content="width=device-width" />
  <script src="~/Scripts/kendo/jquery.min.js"></script>
  <script src="~/Scripts/kendo/kendo.web.min.js"></script>
  <script>
    $(function () {
      var autocompleteDataSource = kendo.data.DataSource({
        type: "odata",
          transport:
            read: {
              type: "POST",
              contentType: "application/json",
              url: "/",
              data: {
                address: function() {
                  return $("#autocomplete").data("kendoAutoComplete").value();
                }
              },
              dataType: "json"
            }
          },
          schema: {
            data: function (response) {
              return response.data;
            }
          }
        });

        $("#autocomplete").kendoAutoComplete({
          minLength: 2,
          dataSource: autocompleteDataSource,
          change: function () {
            this.dataSource.read();
          }
        });
    });
</script>
</head>
<body>
  <div>
    <input type="text" id="autocomplete" />
  </div>
</body>
</html> 
```

但是当我执行此代码时，我在 kendo.web.min.js 中使用 Internet Explorer 进行初始化时收到此错误：

```
JavaScript runtime error: Object doesn't support property or method '_observe' 
```

我认为显然问题不在服务器页面中，因为当我收到此错误时，它也没有尝试连接到服务器。谢谢你们。

# javascript - Ember.js 推荐的从集合中删除项目并保留到 REST 的方法

> ID：15329058
> 
> 赞同：2
> 
> 时间：2013-03-10T23:33:43.420
> 
> 标签：javascript, rest, ember.js, ember-data

我遵循了 Ember.js 上的 PeepCode 教程，并将其扩展为从选项卡中删除项目。我还在服务器上实现了一个简单的 RESTful 接口来持久化更改，并且正在使用 DS.RESTAdapter。

有2个相关模型：

*   选项卡项
*   Tab，与 TabItem 具有 hasMany 关系

继本教程之后，我向选项卡模板添加了一个简单的删除链接：

```
<script type="text/x-handlebars" data-template-name="tab">
  <ul id="customer-tab">
    {{#each tabItem in tabItems}}
    <li>
      <h3><a href="#" {{ action "removeTabItem" tabItem }}>x</a> {{ tabItem.food.name }} <span>{{ money tabItem.cents}}</span></h3>
    </li>
    {{ else }}
      <li><h3>Click a food to add it</h3></li>
    {{/each}}
    <li id="total">
      <h3>Total <span>{{ money cents }}</span></h3></li>
    </li>
  </ul>
</script> 
```

并且在控制器中

```
App.TabController = Ember.ObjectController.extend({
  removeTabItem: function(tabItem) {
    var store = this.get('store');
    store.transaction();
    var t = store.find(App.TabItem,tabItem.get('id'));
    t.deleteRecord();
    this.get('tabItems').removeObject(tabItem);
    store.commit();
  }
}); 
```

上面的控制器代码是我通过一些反复试验和猜测完成的。“removeObject”调用似乎是从用户界面中正确删除项目所必需的，并且“deleteRecord”调用似乎是必要的，因此“commit”将导致对服务器的DELETE调用。

不过，控制器代码似乎有点冗长，我怀疑我遗漏了一些东西。有没有一种被认为更好的方法，可能更直接地使用“tabItem”，并且使用更少的 API 调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T08:57:57.050

回答我自己的问题：

*   该行：

    ```
    var t = store.find(App.TabItem,tabItem.get('id')); 
    ```

    只是没有必要，我可以只使用传递给方法的 tabItem 。所以我的 TabController 现在是：

    ```
    App.TabController = Ember.ObjectController.extend({
      removeTabItem: function(tabItem) {
        var store = this.get('store');
        store.transaction();
        tabItem.deleteRecord();
        store.commit();
      }
    }); 
    ```

*   Tab 模型与 TabItem 具有“hasMany”关系，但没有自动关系返回，因此当 TabItem 更改（或被删除）时，我怀疑 Tab 在 a 之后不“知道”重绘自身TabItem 已被删除。向 TabItem 添加“belongsTo”关系似乎可以对此进行排序。

    ```
    App.TabItem = DS.Model.extend({
      tab: DS.belongsTo('App.Tab'),
      cents: DS.attr('number'),
      food: DS.belongsTo('App.Food')
    }); 
    ```

# jquery - 加载 Jquery 时出现 jkit 库问题

> ID：15329061
> 
> 赞同：0
> 
> 时间：2013-03-10T23:34:08.130
> 
> 标签：jquery, html, css

在过去的几天里，我一直试图让[Jkit Gallery](http://jquery-jkit.com/commands/gallery.html)从事一个业余项目。即使从头开始，我也不知道我可能在哪里走错了。这是我的[测试页面](http://gabrielpendleton.com/test2/testSite/)Gallery Test 的链接。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:39:57.337

在你的 head 标签中，你需要在加载 jkit 插件之前首先包含 Jquery，

像这样：

```
<script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="js/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="js/jquery.jkit.1.1.21.min.js"></script><style type="text/css"></style> 
```

# c++ - 如何在 Windows 上将 Qt Creator 与 Visual C++ 编译器一起使用？

> ID：15329065
> 
> 赞同：4
> 
> 时间：2013-03-10T23:35:01.407
> 
> 标签：c++, windows, visual-studio, qt, qt-creator

我为 vs2008 和 Qt 插件安装了 Visual Studio 2008、Qt 4.8 库。我可以在 VS2008 中构建 Qt 项目。但这对我来说非常不方便。当我在 Qt creator 中打开 Qt 项目时，它无法编译，因为找不到 qmake。

那么，如何在 Windows 上使用 Qt Creator 构建项目。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-20T17:25:32.840

使用 CMake 构建您的软件。使用 CMake，您可以：

*   - 在持续集成服务器上构建您的项目
*   使用不同的编译器（Microsoft、gcc、clang）进行编译以获得额外的静态检查。
*   使用 creator 作为项目文件打开顶级 CMakeLists.txt。
*   让 CMake 创建 Visual Studio 项目文件。

如果您只想修复 Creator：Qt Creator 需要知道您的 Qt 安装在哪里。在设置菜单中选择绿色的 Qt 符号，单击 Qt 版本并输入 qmake 的路径。然后 Qt Creator 应该准备好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T05:21:52.797

希望这将有助于它通过一些简单的步骤解决安装过程中可能遇到的错误 [http://qtitkvtkhelp.blogspot.in/2012/11/qt-installation-prerequisite-1.html](http://qtitkvtkhelp.blogspot.in/2012/11/qt-installation-prerequisite-1.html)

# java - 无法在 Android 中流式传输 mp3。错误：“无法播放此类音频文件”

> ID：15329068
> 
> 赞同：3
> 
> 时间：2013-03-10T23:35:34.980
> 
> 标签：java, android, audio-streaming

我正在使用 WebViewClient 来显示 .mp3 文件的列表。单击 mp3 文件 url 后，我希望 Android 弹出“使用完成操作”菜单，允许用户选择从哪个媒体播放器流式传输 mp3。

使用以下代码，我可以启动“使用完成操作”菜单并能够选择媒体播放器。不幸的是，每个媒体播放器都会吐出自己版本的“无法播放文件”错误消息。

您在以下代码中看到任何错误吗？谢谢！

```
private class MapWebViewClient extends WebViewClient {        
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        if (url.endsWith(".mp3")) {

            Intent intent = new Intent();  
            intent.setAction(android.content.Intent.ACTION_VIEW);
            File file = null;
            try {
                file = new File(url);
                intent.setDataAndType(Uri.fromFile(file), "audio/*");
                startActivity(intent);
            } catch (NullPointerException e) {
                e.printStackTrace();
            }

            return true;
        } else {
            return super.shouldOverrideUrlLoading(view, url);
        }
    } 
```

# php - PHP SOAP 请求全部小写

> ID：15329069
> 
> 赞同：2
> 
> 时间：2013-03-10T23:35:40.203
> 
> 标签：php, xml, web-services, soap

我创建了一个 Web 服务并使用了 soapUI 来验证它是否正常工作。但是，PHP 客户端在尝试访问它时遇到了致命错误。

我有一个 try/catch 设置，以便我可以查看输出 SOAP 请求并执行`var_dump`. 当我查看请求时`var_dump`，它显示为全小写（甚至是我手动键入 XML 的自定义标头）。

我知道 XML 区分大小写，当我将请求放回soapUI 并正确更改大小写时，我会从 Web 服务获得正确的响应。

什么可能导致 SOAP 请求将所有内容更改为小写？

```
//The WSDL url
$wsurl = "http://domain:port/mywebservice.wsdl";

//Custom header setup
$ws_username = 'myuser';
$ws_password = 'mypass';
$ws_authheader = '<wsse:Security soap:mustUnderstand="1" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
    <wsse:UsernameToken>
        <wsse:Username>'.$ws_username.'</wsse:Username>
        <wsse:Password>'.$ws_password.'</wsse:Password>
    </wsse:UsernameToken>
</wsse:Security>';

//XML SOAP Security variable
$ws_authvars = new SoapVar($ws_authheader,XSD_ANYXML);

//SOAP Security header
$ws_header = new SoapHeader("http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd","Security",$ws_authvars);

//SOAP client - trace is set to true so faults can be backtraced
$ws_client = new SoapClient($wsurl, array('trace'=>true));

//SOAP client parameters
$params = array('PARAM1'=>'123456',
                'PARAM2'=>'ABCDE',
                'PARAM3'=>'ABCD');

try {
    //SOAP response
    $messages = $ws_client->__soapCall('WSMETHOD',array('parameters'=>$params),NULL, $ws_header);
    //print_r($messages);
}
catch (SoapFault $fault) {
    echo "\n";
    print_r($ws_client->__getLastRequest());
    echo "\n";
    var_dump($ws_client);
} 
```

我的 __getLastRequest 返回这个（请注意，字段值保持正确的大小写）：

```
<!--?xml version="1.0" encoding="UTF-8"?-->
<soap-env:envelope xmlns:soap-env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="mynamespaceurl" xmlns:ns2="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
    <soap-env:header>
        <wsse:security soap:mustunderstand="1" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
            <wsse:usernametoken>
                <wsse:username>myuser</wsse:username>
                <wsse:password>mypass</wsse:password>
            </wsse:usernametoken>
        </wsse:security>
    </soap-env:header>
    <soap-env:body>
        <ns1:wsmethod>
            <ns1:param1>123456</ns1:param1>
            <ns1:param2>ABCDE</ns1:param2>
            <ns1:param3>ABCD</ns1:param3>
        </ns1:wsmethod>
    </soap-env:body>
</soap-env:envelope> 
```

确切的 SoapFault：

```
SoapFault exception: [SOAP-ENV:Server] null in C:\inetpub\wwwroot\mydirs\mypage.php:458 
Stack trace:
#0 C:\inetpub\wwwroot\mydirs\mypage.php(458): SoapClient &gt;__soapCall('wsmeth...', Array, NULL, Object(SoapHeader)) 
#1 {main} 
```

它指示的行 (458) 是 $messages = $ws_client->__soapCall

# javascript - javascript函数调用

> ID：15329072
> 
> 赞同：2
> 
> 时间：2013-03-10T23:35:46.430
> 
> 标签：javascript, function

在阅读有关 javascript 函数的信息时，我知道您可以在定义函数后立即调用它：

```
al = function(string){
      alert(string)
}("test"); 
```

但是你不能用空括号做同样的事情：

```
al = function(){
      alert("test")
}(); 
```

相反，您必须将函数转换为函数表达式：

```
al = (function(){
      alert("test")
})(); 
```

为什么会这样，为什么第一个代码示例在没有这种转换的情况下可以正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:05:06.053

您的所有三个示例都或多或少相同。请注意，`al =`没有任何功能，因为这些函数都没有返回任何内容，`al`所以`undefined`. 如果他们确实返回了某些东西，它将被分配给`al`. `al =`前两个表达式在语法上是正确的。

第一个示例的不同之处在于它需要一个参数。其他两个没有，但这对表达式的工作方式没有影响。

括号也可用于表示表达式。例如，`(function () {})()`是有效的语法，但`function () {}()`不是。 `=`也表示一个表达式，所以`variableName = function () {}()`也有效。

# c - 使用 OpenSSL 以编程方式在 X509 证书中输入数据

> ID：15329073
> 
> 赞同：4
> 
> 时间：2013-03-10T23:35:47.163
> 
> 标签：c, cryptography, openssl, x509

我正在尝试创建一个 ecdsa 证书，但我想以编程方式生成它。我正在使用 openssl 和 C 编程。

当我从命令行生成证书时，会要求我回答其他问题以在证书中使用。我想知道如何定义这些问题，以编程方式输入这些数据。

这是我在网上找到的，但我不明白如何插入更多信息，这确实有效：

```
X509 *x; 
x=X509_new(); 
X509_NAME *name = X509_get_subject_name(x); 
X509_set_version(x, 2); 
ASN1_INTEGER_set(X509_get_serialNumber(x), 3); 
X509_gmtime_adj(X509_get_notBefore(x), 0); 
X509_gmtime_adj(X509_get_notAfter(x), (long) 60 * 60 * 24 * 365); 
X509_set_pubkey(x, pk); 
X509_NAME_add_entry_by_txt(name, "C", MBSTRING_ASC, (const unsigned char*) "PT", -1, -1, 0); 
```

我意识到它的`X509_NAME_add_entry_by_txt`功能是国家的答案，但是这个“C”是什么意思？这个函数是怎么组成的？我可以将任何我想要的东西放在“C”和“PT”的位置吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T07:59:08.163

这`C`是表示国家/地区的标准方式，`PT`是葡萄牙的正确选择（有关其他国家/地区选项，请参阅[此列表](http://www.digicert.com/ssl-certificate-country-codes.htm)）。

您可以使用该`X509_NAME_add_entry_by_txt`函数在专有名称中设置其他值，使用正确的前缀：

*   `C`= 国家
*   `ST`= 状态
*   `L`= 地点
*   `O`= 组织
*   `OU`= 组织单位
*   `CN`= 通用名称

只有国家字段有固定的选择范围。

另请参阅手册页上给出的示例：[http ://www.openssl.org/docs/crypto/X509_NAME_add_entry_by_txt.html#EXAMPLES](http://www.openssl.org/docs/crypto/X509_NAME_add_entry_by_txt.html#EXAMPLES)

# vim - vim 中全局操作的一致性

> ID：15329074
> 
> 赞同：4
> 
> 时间：2013-03-10T23:35:50.633
> 
> 标签：vim, sed

考虑这两个 vim 命令

1.  `:% s/one/two/g`
2.  `:% g/found/d`

我想知道为什么`g`信号全局替换和删除需要分别放在最后替换和删除开头。

这些是否遵循我缺少的模式，或者这是 vim 极端情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T00:05:48.753

我猜你对`:g[lobal]`,`:s[ubstitute]`和`:[range]delete`

让我们举个例子：

`g`是一个**标志**：`:s`

*   `:s/foo/bar/` : 只替换当前**行**中的**第一个** `foo``bar`
***   `:s/foo/bar/g` :**全部** `foo`替换`bar`为**当前**行*   `%:s/foo/bar/` ：对于**整个**文件中的每一行，仅将**第一** `foo`行替换为`bar`*   `%:s/foo/bar/g`：用**整个文件** 替换**所有** （所有行）`foo``bar`**

 ****`:g`as **`:global`command** :`:g`可以处理任何命令，不仅`d`

*   `:g/foo/d`: 删除**所有**匹配的行 默认范围是`%`
*   `:%g/foo/d`: 同上
*   `:1,30g/foo/d`：从第 1-30 行，删除所有包含`foo`
*   `:g/foo/normal >>`: 缩进所有匹配的行`foo`（不仅适用于`d`）
*   `:g/foo/y A`: 拉出所有匹配的 ( `/foo/`) 行以进行注册`a`（不仅适用于`d`）

`:d`命令：( `:[range]d[elete]`)

*   `:/foo/d`:`/foo/`这是一个范围。删除下一个匹配行
*   `:%d`：删除所有行（清空文件）
*   `:%/foo/d`: 这个不行。因为你有两个范围（% 和 /foo/）
*   `:/foo/dg`: 这也行不通。没有`dg`命令
*   `:g/foo/d`：这有效，与上面（该`:g`部分）相同，但它来自`:global`命令

我希望你能清楚一点。（或者更困惑？我希望不会.. ^_^）

你可能想看看以下

```
:h :s
:h :g
:h :d
:h range 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T02:51:43.823

稍微不同地解释一下：

## `:% g/found/d`

这里`g`是[:g[lobal]](http://vim.wikia.com/wiki/Power_of_g)的缩写形式，格式如下：

```
:[range]g/pattern/[command] 
```

它的工作原理是：

1.  扫描其中的每一行`[range]`（如果未`[range]`指定，则扫描*所有行*），
2.  标记所有匹配`pattern`，并且
3.  执行给定的`[command]`.

注意：`pattern`在`[range]`执行. *_* `[command]`仅对标记匹配的命令执行`pattern`。

## `:% s/one/two/g`

这里，`g`是`[flags]`from [:s[ubstitution]](http://vimdoc.sourceforge.net/htmldoc/usr_10.html#10.2)命令之一，其格式如下：

```
:[range]s[ubstitute]/pattern/string/[flags] 
```

它的工作原理是：

1.  扫描其中的每一行`[range]`（如果没有`[range]`指定，则只扫描*当前行*），
2.  标记所有匹配`pattern`，
3.  用`pattern`,`string`和
4.  调用`[flags]`（例如，“c”表示确认，“g”表示所有出现）。

注意：与 command 不同，`g`这里是一个*本地化*标志`:s[ubstitution]`，不与其他命令一起*普遍*`:g[lobal]`使用。

## 一起使用`:g[lobal]`_`:s[ubstitute]`

将命令替换`[command]`为，我们得到以下格式：`:g[lobal]``:s[ubstitution]`

```
:[range_g]g/pattern_g/[range_s]s/pattern_s/string_s/[flags] 
```

通过分析，我们了解到以下几点：

1.  我们的世界仅限于`pattern_g`内部的匹配`[range_g]`。
2.  在这个有限的世界里，我们正在执行命令`:s[ubstitute]`。
3.  `:s[ubstitute]`仅当匹配`pattern_s`发生在中时才会执行此操作`[range_s]`。

## 例子：

给定以下文本：

```
stackoverflow.com/
stackexchange.com/
stackoverflow.com 
stackexchange.com
www.stackoverflow.com
www.stackexchange.com
http://www.stackoverflow.com
http://www.stackexchange.com // your cursor is placed here 
```

情况1：`:g/com/d`

```
// all lines are deleted 
```

案例二：`:g/com$/d`

```
stackoverflow.com/
stackoverflow.com/
// all lines containting com at the end are deleted 
```

案例 3：`:g/com$/s/exchange/overflow/g`

```
stackoverflow.com/
stackexchange.com/
stackoverflow.com 
stackoverflow.com // changed
www.stackoverflow.com
www.stackoverflow.com // changed
http://www.stackoverflow.com
http://www.stackoverflow.com // changed 
```

案例 4：`:1,7g/com$/s/exchange/overflow/g`

```
stackoverflow.com/
stackexchange.com/
stackoverflow.com 
stackoverflow.com // changed
www.stackoverflow.com
www.stackoverflow.com // changed
http://www.stackoverflow.com
http://www.stackoverflow.com 
```

案例 5：`:1,7g/com$/4,6s/exchange/overflow/`

```
stackoverflow.com/
stackexchange.com/
stackoverflow.com 
stackoverflow.com // changed
www.stackoverflow.com
www.stackexchange.com
http://www.stackoverflow.com
http://www.stackoverflow.com 
```

案例 6：`:1,7g/com$/4,6s/exchange/overflow/g`

```
stackoverflow.com/
stackexchange.com/
stackoverflow.com 
stackoverflow.com // changed
www.stackoverflow.com
www.stackexchange.com // changed 
http://www.stackoverflow.com
http://www.stackexchange.com 
```

案例 7：`:s/exchange/overflow/g`

```
stackoverflow.com/
stackexchange.com/
stackoverflow.com 
stackexchange.com
www.stackoverflow.com
www.stackexchange.com
http://www.stackoverflow.com
http://www.stackoverflow.com // changed. only current line is executed 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-10T23:41:19.860

`s//g`是全局替换就行了。 `g/`是文档上的全局替换。在第一种情况下，`%s`对整个文档进行替换。如果没有`g`结尾，它仍然会在整个文档上进行替换，但只会在每行的第一个实例上进行。 `%/`是无效的语法，但`://d`将替换找到的下一行，类似于如何`:s//`替换当前行。请注意，您不需要`%g`. 只是`g`在你的例子中会做同样的事情。****

# doxygen - 在 C++ 中注释代码区域以进行 Doxygen 识别

> ID：15329075
> 
> 赞同：0
> 
> 时间：2013-03-10T23:35:59.303
> 
> 标签：doxygen

有没有办法将 Doxygen 可以理解的注释块添加到代码区域（由#pragma 区域描述）？

换句话说，我想在一组函数之前添加一个 Doxygen 可以识别的注释：

```
/**********************//**
* \some-doxygen-tag-here ?
**************************/
#pragma region Demo Functions
.....
.....
#pragma endregion 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T20:01:29.817

Doxygen 模块组可以在这里提供帮助。组可以有文档，您可以标记组的开始和结束。组在输出文档中称为模块（不确定是否可以轻松更改）。

```
/** @defgroup demofuns Demo Functions
 *  Documentation of the following code block, i. e. group.
 *  @{
 */
#pragma region Demo Functions
.....
.....
#pragma endregion
/** @} */ // end of demofuns 
```

请参阅[http://doxygen.org/manual/grouping.html](http://doxygen.org/manual/grouping.html)。

# knockout.js - ko.validation.group 并不总是与显示的错误保持同步

> ID：15329076
> 
> 赞同：1
> 
> 时间：2013-03-10T23:36:06.977
> 
> 标签：knockout.js, knockout-validation

我有一个带有错误集合的视图模型，我将其绑定到 ASP.NET MVC 样式验证摘要。问题是错误收集并不总是与模型的当前状态保持同步。

```
function CostEditViewModel() {
    var self = this;
    self.description = ko.observable().extend({ required: { message: "Please enter the description", params: true } });
    self.amount = ko.observable()
        .extend({ required: { message: "Please enter the amount", params: true } })
        .extend({ number: { message: "The amount is not valid", params: true } });
    self.displayErrors = ko.observable(false);
    self.errors = ko.validation.group(self);

    self.add = function() {
        self.edit(new Cost({ Description: '', Amount: '' } ));
    };

    self.edit = function(cost) {
        self.description(cost.Description());
        self.amount(cost.Amount());
        self.displayErrors(false);

        self.description.isModified(false);
        self.amount.isModified(false);
    };

    self.save = function() {
        if (self.isValid()) {
            DoAjaxSave();
        } else {
            self.displayErrors(true);
        }
    };
} 
```

然后我将错误绑定到 UL

```
<div class="alert alert-error" data-bind="visible: displayErrors() && errors().length > 0">
    <ul data-bind="foreach: errors">
        <li data-bind="text: $data"></li>
    </ul>
</div> 
```

问题是验证摘要中显示的错误并不总是最新的。如果我触发金额错误，则正确的错误在集合中，但如果我触发金额的另一个错误，即使它确实在字段旁边显示正确的错误，它也不会更改错误集合中的内容。为了获得正确的错误集合，一个字段必须在有效和无效之间更改状态。如果字段从一种无效状态更改为另一种无效状态，则错误集合不会更新。

这是我为演示示例而创建的小提琴。

[http://jsfiddle.net/e4LHV/2/](http://jsfiddle.net/e4LHV/2/)

# php - PHP 数组 - 如何在数组中使用多个变量

> ID：15329077
> 
> 赞同：0
> 
> 时间：2013-03-10T23:36:14.120
> 
> 标签：php, arrays, magento, multidimensional-array

我有一个 Magento 的产品导入代码，它将库存（数量）分配给仓库位置（stock_id）。信息是在一个数组中传递的，但是我对数组的工作知识并不是那么快，所以我确定我没有正确地做到这一点。

导入目前是这样完成的，但我确信它不是最有效的，因为我保存了两次产品。

这会将 100 的数量分配给位置 1 (stock_id 1)，保存产品，然后将 200 的数量分配给位置 2 (stock_id 2)，然后再次保存产品。

```
 $stocksData = $product->getStocksData();
        if (!$stockData) {
            $stockData = array();
        }
        $stockData['stock_id'] = 1;
        $stockData['qty'] = 100; 
        $stocksData[$stockId] = $stockData;
        $product->setStocksData($stocksData);

        $product->setCreatedAt(strtotime('now'));
        try {
            $product->save();
            echo "Successful";
        }
        catch (Exception $ex) {
            echo 'There was an error :<br/>' .$ex;
        }

     $stocksData = $product->getStocksData();
            if (!$stockData) {
                $stockData = array();
            }
            $stockData['stock_id'] = 2;
            $stockData['qty'] = 200; 
            $stocksData[$stockId] = $stockData;
            $product->setStocksData($stocksData);

$product->setCreatedAt(strtotime('now'));
try {
    $product->save();
    echo "Successful";
}
catch (Exception $ex) {
    echo 'There was an error :<br/>' .$ex;
} 
```

我想要实现的是设置数组中的所有值并保存一次，因为这会减轻脚本的负担。

我一直在玩这样的东西，但是没有得到任何地方，通常最终会出现错误：

```
 $stocksData = $product->getStocksData();
               if (!$stockData) {
                   $stockData = array();
               }
               $stockData = array(
[$stockData['stock_id'] = 1] => $stockData['qty'] = 100,
[$stockData['stock_id'] = 2] => $stockData['qty'] = 200
);
               $stocksData[$stockId] = $stockData;
               $product->setStocksData($stocksData); 
```

我假设可以将所有这些信息放在一个数组中，但我不确定如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T23:45:47.090

在 php.ini 中有很多方法可以初始化数组。

```
$stocksData = array(
  'key' => 'value',
  'myarr' => array(
    'nested' => 'array',
    1,
  ),
  'id_copy' => $stocksData['id'],
  'qty' => $stocksData['stock_id'] == 1 ? 100 : 200,
); 
```

有关数组语法的完整说明，请查看 php 的[数组文档](http://php.net/manual/en/language.types.array.php)。还要注意我对[三元运算符](http://php.net/manual/en/language.operators.comparison.php)的使用。你可以通过这样说来绕过使用这种语法：

```
if ($stocksData['id'] == 1) {
  $stocksData['qty'] = 100;
}
else {
  $stocksData['qty'] = 200;
} 
```

**编辑：**

对于您组合请求的特定用例，请查看以下内容：

```
$stocksData = $product->getStocksData();
$stocksData[1] = array(
  'stock_id' => 1,
  'qty' => 100,
);
$stocksData[2] = array(
  'stock_id' => 2,
  'qty' => 200,
);
$product->setStocksData($stocksData); 
```

# java - javax.persistence.PersistenceException：org.hibernate.PersistentObjectException：错误

> ID：15329085
> 
> 赞同：3
> 
> 时间：2013-03-10T23:38:16.383
> 
> 标签：java, hibernate, jpa, entitymanager

我在 JPA 项目中有 2 个实体：

一个类别和一个问题。所以每个类别都有一个问题列表，每个问题都是一个类别的一部分（OnetoMany 关系）。我通过两个实体中的设置/添加方法管理双向关系：

问题 ：

```
 @ManyToOne(cascade = CascadeType.ALL)
@JoinColumn(name = "Qcategory")
private Category category;

public void setCategory(Category category) {
 this.category = category;

 if (category != null && !category.getQuestions().contains(this)) {
 category.addQuestion(this);
 }
 } 
```

类别 ：

```
@OneToMany(cascade = { CascadeType.ALL }, mappedBy = "category")
private List<Question> questions= new ArrayList<Question>();

 public void addQuestion(Question question) {
 this.questions.add(question);

 if (question.getCategory() != this) {
 question.setCategory(this);
 }

 } 
```

我首先创建一个类别。

```
Category category1 = new Category();
category1.setName = "exampleCategory"; 
```

我通过我的存储库将其添加到数据库中（以与问题 addOrUpdate 类似的方式添加，如下所示）

之后我创建一个问题

```
Question question1 = new Question(); 
```

我将问题的类别设置为 category1

```
question.setCategory = category1; 
```

在此之后，我还尝试通过调用下面的 addOrUpdate 方法将问题持久化到数据库。然后我得到一个错误：

```
....:javax.persistence.PersistenceException: org.hibernate.PersistentObjectException: detached entity passed to persist: jpa.entities.Category 
```

我使用如下存储库方法：

```
@Override
public boolean addOrUpdate(Question question) {
    EntityManagerFactory emf = JPARepositoryFactory
            .getEntityManagerFactory();
    EntityManager em = emf.createEntityManager();
    EntityTransaction tx = em.getTransaction();
    tx.begin();

    Question tempQuestion = null;
    try {
        if (question.getId() != null) {
            tempQuestion = em.find(Question.class,
                    question.getId());
        }

        if (tempQuestion == null) {
            em.persist(question);
        } else {

            tempQuestion .setCategory(question.getCategory());
            ... (other setters)
            tempQuestion = em.merge(question);
        }
    } catch (Exception e) {
        ....logging...      }
    tx.commit();
    em.close();
    emf.close();
    return true;
} 
```

任何建议都会更受欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T11:48:15.670

因此，您只能在实体上调用 persist 一次。该错误意味着您已经在传入的那个 Question 对象上调用了 persist ，但是您在另一个事务中这样做了。如果要将 Question 对象重新附加到持久性上下文，则需要调用 merge 或从数据库重新加载它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T08:56:39.117

在 persist 或 merge 之前你需要做的是在每个 Question 中设置 Category 引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T09:51:21.563

*[注：这可能不是直接的答案，只是一些观察]*

1.  `EntityManagerFactory`使用每个方法调用进行初始化绝对不是一个好习惯。相反，它应该在应用程序启动期间创建一次。

2.  您正在传递`Category`，这是另一个`addOrUpdate`不处于托管状态的持久性上下文的一部分。

3.  你有什么`cascade=MERGE`/`cascade=PERSIST`或`cascade=ALL`你的关系。

4.  可能，您可以`Category`在当前事务中再次按 id 获取并在`question`持久之前将其设置。

**从文档：**

> 双向关系必须遵循这些规则。
> 
> *   双向关系的反面必须通过使用 @OneToOne、@OneToMany 或 @ManyToMany 注释的 mappedBy 元素引用其拥有方。mappedBy 元素指定实体中作为关系所有者的属性或字段。
> *   多对一双向关系的多方不得定义 mappedBy 元素。多方始终是关系的拥有方。
> *   对于一对一的双向关系，拥有方对应于包含相应外键的一方。
> *   对于多对多双向关系，任何一方都可能是拥有方。

# java - 格式化结果输出字符串

> ID：15329087
> 
> 赞同：1
> 
> 时间：2013-03-10T23:38:44.960
> 
> 标签：java

以下代码提供了正确的输出，但与我需要的格式不完全相同。

**当前代码：**

```
public static void main(String[] args)
{
    Scanner scan = new Scanner(System.in);
    Deck deck = new Deck();
    Card C;

    System.out.println(deck.getTotalCards());
    System.out.print("Number of players: ");
    int players = scan.nextInt();
    System.out.print("Number of cards: ");
    int cards = scan.nextInt();

    for(int k=0; k<players; ++k)
    {
        for(int i =0; i<cards; i++)
        {
            C = deck.drawFromDeck();
            System.out.println("Player "+(k+1) + ": " + C.toString());
        }
    }
    scan.close();
} 
```

**这提供了以下输出：**

```
51 // number of cards in deck

Number of players: 3 //3 - entered by user
Number of cards: 2 // 2- entered by user
Player 1: 4 of Spades
Player 1: Jack of Diamonds
Player 2: 6 of Clubs
Player 2: 2 of Hearts
Player 3: Jack of Clubs
Player 3: 8 of Diamonds 
```

**期望的输出：**

```
51
Number of players: 3 //3 - entered by user
Number of cards: 2 // 2- entered by user
Player 1: 4 of Spades, Jack of Diamonds
Player 2: 6 of Clubs, 2 of Hearts
Player 3: Jack of Clubs, 8 of Diamonds 
```

如何更改我的 for 循环以反映我想要的输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T23:44:59.083

如果您不想自动打印新行，则需要使用 System.out.print() 而不是 System.out.println()。我认为这样的事情会做到这一点：

```
for(int k=0; k<players; ++k)
{
    System.out.print("Player "+(k+1) + ": ");
    for(int i =0; i<cards; i++)
    {
        C = deck.drawFromDeck();
        System.out.print(C.toString());
        if(cards >= 2 && i != cards - 2) {
            System.out.print(", ");
        }
    }
    System.out.print("\n");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T23:46:03.823

在内部循环中，使用`System.out.print()`代替`System.out.println()`. 在外循环结束时，调用`System.out.println()`下一行开始下一个输出。

例如：

```
for (int k = 0; k < players; k++) {
  for (int i = 0; i < cards; i++) {
    if (i == 0) {
      System.out.print("Player "+(k+1) + ": ");
    }
    else {
      System.out.print(",");
    }
    C = deck.drawFromDeck();
    System.out.print(C.toString());
  }
  System.out.println();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-10T23:49:31.613

您需要做的是将每个玩家的输出保存在一个字符串中，然后在内部循环之外打印它。所以像：

```
for(int k=0; k<players; ++k)
    {
        String output = " ";
        for(int i =0; i<cards; i++)
        {
            C = deck.drawFromDeck();
            output+= C.toString() + ",";
        }
        System.out.print("Player " + (k+1) + ": ");
        System.out.println(output);
    } 
```

# .net - MediaFire Rest API 会话签名 SHA1？

> ID：15329092
> 
> 赞同：2
> 
> 时间：2013-03-10T23:39:10.073
> 
> 标签：.net, api, rest, sha1, mediafire

我正在尝试使用他们的 API连接到[MediaFire 。](http://www.mediafire.com)

根据文档，[`get_session_token`](http://developers.mediafire.com/index.php/REST_API#get_session_token)请求所需的参数之一是：

> **signature**：一个 SHA1 哈希字符串，包含以下 4 个元素：电子邮件 + 密码 + application_id + API 密钥。例如email：testemail@domain.com，密码：111111，application_id：9999，API key：abcdefghijklmnopqrst，那么签名计算如下：SHA1('testemail@domain.com1111119999abcdefghijklmnopqrst')

我遇到的问题是 SHA1，我不知道如何将字符串散列到所需的 SHA1。我正在使用 .NET（我尝试了几种方法），但我什至尝试使用 python ( `hashlib.sha1('token').hexdigest()`)，但它不起作用（尝试通过 Internet 浏览器访问）。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T00:35:19.957

这是我在创建一些散列数据的字符串表示时遵循的那种模式：

```
string data = "testemail@domain.com1111119999abcdefghijklmnopqrst";
byte[] bytes = Encoding.UTF8.GetBytes(data);
byte[] hash;

using (SHA1 sha1 = new SHA1Managed())
    hash = sha1.ComputeHash(bytes);

//You would use hashString for the signature parameter.
string hashString = BitConverter.ToString(hash).Replace("-", "").ToLower(); 
```

# backbone.js - 多次调用主干事件

> ID：15329099
> 
> 赞同：1
> 
> 时间：2013-03-10T23:39:55.683
> 
> 标签：backbone.js

我刚刚被 Backbone 弄湿了，我想我有一个容易解决的问题。我有以下视图，这是一个简单的选项卡，单击它会打开一个面板，关闭时会返回一个选项卡：

```
myApp.views.Support = {
    Form: Backbone.View.extend({
        initialize: function () {
            this.el = $('#support');
            this._ensureElement();
        },
        render: function () {
            if (this.$el.hasClass('support-panel')) {
                // close panel
                this.$el.empty();
                this.$el.removeClass('support-panel');
                this.$el.addClass('support-button');
            }
            else {
                // open and populate panel
                var template = _.template(myApp.utils.RenderTemplate('support/default'), {});
                this.$el.removeClass('support-button');
                this.$el.addClass('support-panel');
                this.$el.html(template);
            }

            return this;
        },
        closePanel: function () {
            alert('close event fired');
        },
        events: {
            'click #SubmitFormButton': 'submitForm',
            'click #CloseSupportPanel': 'closePanel'
        },
        submitForm: function (event) {
            alert('form submitted: ' + $('#message'));
        }
    })
} 
```

一切正常，除了每次点击事件发生时“closePanel”被触发+2次。我认为这是我缺少的某种清理，但我不知道是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T23:42:23.707

可能是因为事件正在冒泡。尝试返回`false`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-03T15:30:52.190

我知道这是一个老问题，但它帮助我意识到我的问题是什么。正如 Daniel 所说，返回 false 有效，但我的问题的根本原因是我的标记中有两次 jQuery 选择器，导致创建了两个 jQuery 对象，因此 click 事件触发了两次。

# java - 我无法让谷歌云端点正常工作，我是否调用了正确的公共链接？

> ID：15329101
> 
> 赞同：1
> 
> 时间：2013-03-10T23:40:06.143
> 
> 标签：java, google-app-engine, google-cloud-endpoints

该api标记为：

```
@Api(version = "v1", 
description = "API for interfacing with accounts", 
defaultVersion = AnnotationBoolean.TRUE) 
```

我想调用的方法之一是：

```
@ApiMethod(name = "account.register",
           path = "account",
           httpMethod = HttpMethod.POST)
public void register(HttpServletRequest request, HttpServletResponse response)
{ ... 
```

但我似乎无法弄清楚访问它的网址:(

我尝试发布到 myapp.appspot.com/_ah/api/myapi/v1/account 但它是 404

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T02:11:23.900

一些东西...

1.  我认为通常不会以这种方式使用端点：通过手动发布到 URL。相反，您应该生成一个客户端库（封装了 URL），然后使用该客户端库。

2.  如果您只想检查端点，我听说[API Explorer](https://developers.google.com/apis-explorer/)非常有用。对于您将使用的特定应用程序：

    [https://myapp.appspot.com/_ah/api/explorer](https://myapp.appspot.com/_ah/api/explorer)

    并被重定向到您的应用程序的 APIs Explorer 版本。

3.  对 App Engine 后端的实际调用是这样的路径：`/_ah/spi/MyEndpoint.myMethod`. （**注意：**路径中的`spi`vs。`api`）您尝试构建的实际路径是 Google 的 API 服务基础架构，充当应用程序的前端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T17:56:31.453

端点中没有任何（HttpServletRequest 请求、HttpServletResponse 响应）。最简单的方法是创建你的 java 类（你想要持久化），然后在 java 类的 eclipse 中点并右键单击并选择“google -> generate google cloud endpoint class”然后你就会明白它是如何实现的在不同的场景中看起来。如果要发送参数，则必须添加例如 myMethod(@Named("myName") String name)。但首先检查端点生成，它使一切变得更简单并在这里查看更多信息：[https ://developers.google.com/appengine/docs/java/endpoints/annotations](https://developers.google.com/appengine/docs/java/endpoints/annotations)

# javascript - 如何使用 script 标签将 fabric.js 与 Meteor 一起使用？

> ID：15329102
> 
> 赞同：0
> 
> 时间：2013-03-10T23:40:11.367
> 
> 标签：javascript, meteor, fabricjs

我是流星的新手。我已经设法使用 Meteor 和 Fabric.js 制作了一些简单的程序，但现在我试图同时使用它们，我无法让它工作。

我通过在主 html 文件的头部使用脚本标记来包含 Fabric.js，但是当我从客户端 JS 调用 fabric.Canvas 时，它无法识别该库。我在 Firefox JS 控制台中得到的错误是“ReferenceError: fabric is not defined”。我将 js 文件放在我的公共目录中。

我环顾四周，看到了关于包含节点模块的线程，但我只是想使用 js 文件而不是包含整个模块。我确实在 GitHub 上找到了一个使用 script 标签没有问题的项目：[https](https://github.com/6/realtime-fabric) ://github.com/6/realtime-fabric 我不熟悉 CoffeeScript 所以也许我遗漏了一些东西，但我不认为他做的和我不一样。您能提供的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:21:30.067

将“客户端”目录添加到您的项目中，并将 fabric.js 文件放在那里。Meteor 将这个目录中的文件打包，然后发送给客户端。您不需要在 HTML 中使用脚本标记。

[http://docs.meteor.com/#structuringyourapp](http://docs.meteor.com/#structuringyourapp)

# sql-server - 检查约束 - 如果另一列为真，则仅允许一列为真

> ID：15329103
> 
> 赞同：6
> 
> 时间：2013-03-10T23:40:29.440
> 
> 标签：sql-server, tsql, sql-server-2008-r2, constraints, check-constraints

以下面的示例表为例：

```
CREATE TABLE [dbo].[tbl_Example](
    [PageID] [int] IDENTITY(1,1) NOT NULL,
    [RequireLogin] [bit] NOT NULL,
    [RequireAdmin] [bit] NOT NULL,
    [HideIfLoggedIn] [bit] NOT NULL
) 
```

如何重写上述内容以包括检查约束，如下所示：

*   如果为假，则强制为**假**（`[RequireAdmin]`即**仅**在为**真**时允许为**真**，同时允许为**真**和为**假**`[RequireLogin]`**`[RequireAdmin]`**`[RequireLogin]`**`[RequireLogin]`**`[RequireAdmin]`********
*******   仅当为**False**时才允许`[HideIfLoggedIn]`为**True**`[RequireLogin]`******

 ******* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-11T00:08:06.493

您通常在检查中执行嵌套的 case 语句，以使该类型的逻辑起作用。请记住，支票中的案例必须仍然是评估，因此它将采用以下形式

```
CHECK (case when <exp> then 1 end = 1). 
```

查看您的确切要求，但似乎这也可以工作并且可能更容易阅读：

```
 CREATE TABLE [dbo].[tbl_Example]
 (
    [PageID] [int] IDENTITY(1,1) NOT NULL,
    [RequireLogin] [bit] NOT NULL,
    [RequireAdmin] [bit] NOT NULL,
    [HideIfLoggedIn] [bit] NOT NULL
 )

 ALTER TABLE [dbo].[tbl_Example] ADD CONSTRAINT
     [RequireAdmin] CHECK 
      ((RequireAdmin = RequireLogin) OR 
      (RequireLogin=1));

 ALTER TABLE [dbo].[tbl_Example] ADD CONSTRAINT
      [HideIfLoggedIn] CHECK 
      ((RequireLogin=1 AND HideIfLoggedIn=0) OR 
       (RequireLogin=0 AND HideIfLoggedIn=1) OR 
       (RequireLogin=0 AND HideIfLoggedIn=0)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T00:28:56.150

如果我的代数正确：

```
alter table dbo.Example
add constraint RequireAdmin_RequireLogin_ck
check ( not ( RequireAdmin = 'true' and RequireLogin = 'false' ) ) ;
alter table dbo.Example
add constraint HideIfLoggedIn_RequireLogin_ck
check ( not ( HideIfLoggedIn = 'true' and RequireLogin = 'true' ) ) ; 
```

请注意，这些检查约束是在表级别而不是列级别定义的，因为它们必须引用多个列。由于这个原因，RThomas 的回答不是有效的 Transact-SQL！******

# android - 加密本地数据和 SSO

> ID：15329105
> 
> 赞同：2
> 
> 时间：2013-03-10T23:40:46.720
> 
> 标签：android

我们现在正在开发一个相当企业级的应用程序，任务是在本地磁盘上加密所有数据。目前，这样做的方法是使用登录时输入的用户名/密码来构建加密密钥。这些值始终保存在内存中，因此有人很难破解它（并非不可能，但很困难）。

现在应用程序需要使用 SSO 登录。根据提供者的不同，实现会有所不同，但可以说我们可以想象一些独特的值是由我们的服务器生成的，或者使用来自 AccountManager 的值，或者更奇特的东西. 不管它完成了，我们需要一种方法来从未保存在磁盘上的源值构建加密密钥。如上所述，这些当前是用户名/密码，对于 SSO，可能是以另一种方式生成的。

如果我们一直在线，我们可以依靠服务器将该值保存在数据库中并在登录时返回。但是，此应用程序也应该能够离线运行（当然，在您完成初始登录之后）。

有什么想法吗？我曾探索过只加密整个磁盘，但我们不能真正强制用户这样做，如果已经有大量数据，那将需要很长时间。

有没有办法将这些值保存在操作系统中不易读取的某个位置，即使使用 root 也是如此？例如，如果我们有一个锁屏，有没有办法使用锁屏密码来保存加密数据？据我了解，这是用于磁盘加密的方法，iOS 上也有类似的方法。我在很多地方读到 4 位代码并不是非常安全，但它会非常好，而且比我们现在拥有的要好得多。

还有其他想法吗？我觉得我错过了一些明显的东西。

提前致谢。

# mysql - 如何在MySQL中选择所有以某些数字开头的列数据

> ID：15329109
> 
> 赞同：3
> 
> 时间：2013-03-10T23:41:15.613
> 
> 标签：mysql

这是我的桌子：

```
studentID   lastName  firstName
08422567    Brown     Susan
10356844    Black     Roger
10659475    White     Steven
09463729    Grey      Naomi 
```

我正在尝试选择 ID 以 10 开头的所有学生，所以基本上是 Roger 和 Steven。

以下是我尝试的示例：

```
SELECT * FROM student WHERE studentID='10356844' AND  studentID='10659475'
SELECT * FROM student WHERE studentID='10356844,10659475' 
```

我是否需要为此使用正则表达式，肯定必须有一种更简单的方法来运行这样的查询？将来可能有100个以10开头的数字，我无法将所有这些都添加到一个查询中，这就是为什么我在这里提出这个问题的难点，以便得到正确的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-10T23:42:59.763

不是正则表达式，而是`WHERE studentID LIKE '10%'`. 这`%`是一个通配符，因此它将匹配 ID 以 10 开头的任何学生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:30:14.227

这永远不会成功：

```
SELECT * FROM student WHERE studentID='10356844' AND  studentID='10659475' 
```

因为没有任何行同时具有这两个 studentID 值。不可能。你的意思是：

```
SELECT * FROM student WHERE studentID='10356844' OR  studentID='10659475' 
```

# java - 如何避免Java中脆弱的基类

> ID：15329112
> 
> 赞同：0
> 
> 时间：2013-03-10T23:41:33.653
> 
> 标签：java, inheritance, polymorphism, encapsulation, base-class

我正在研究脆弱的基类问题，发现以下论文很有趣：[https ://www.research.ibm.com/haifa/info/ple/papers/class.pdf](https://www.research.ibm.com/haifa/info/ple/papers/class.pdf)

在这篇论文中，有人认为如果 Java 有一个“密封的”访问修饰符会很棒。不像 C# 中的 'sealed'，相当于 Java 的 'final' 关键字。所提出的密封机制将使得无法将这些密封类扩展到它们的包之外。

然而，我发现的关于 FBC 问题的大部分材料都可以追溯到 90 年代末、00 年代初，所以这让我怀疑“问题”是否不再是一个主要问题。

我知道 Joshua Bloch 提倡限制性地使用继承，尤其是跨库，而且他当然似乎是 Java 权威。

我知道如何通过创建一组从具有私有构造函数的类继承的最终内部类来实现寡态，但这似乎有点不合适。

所提议的密封基本上类似于使类成为默认/包私有，还是在今天的 Java 中实际上存在某种类密封机制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T23:52:42.047

> 然而，我发现的关于 FBC 问题的大部分材料都可以追溯到 90 年代末、00 年代初，所以这让我怀疑“问题”是否不再是一个主要问题。

我认为更重要的是这个问题现在已经被很好地理解了。同样，你不会找到太多最近讨论问题`GOTO`以及如何解决这些问题的论文，不是因为这些问题不再存在，而是因为人们现在知道如何避免它们。

> [提议的类密封机制]与将类设为默认/包私有基本上不是一回事吗？

不可以。包私有类和“密封”类的相似之处在于两者都不能被包外的类扩展，但它们的不同之处在于前者也不能被包外的类*使用*。也就是说——如果一个类`X`是包私有的，那么它包外的一个类甚至不能引用`X`：no `extends X`、no `X x = new X()`、no `Class<X> clazz = X.class`。但是如果它只是密封的，那么不同包中的类不能写`extends X`，但仍然可以写`X x = new X()`等等`Class<X> clazz = X.class`。（同样重要的是`X x = new Y()`，如果`Y`是子类，它仍然可以编写。所以它仍然可以利用`X`的类型层次结构，即使它本身不能扩展`X`。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-16T20:09:09.113

> 我知道如何通过创建一组从具有私有构造函数的类继承的最终内部类来实现寡态，但这似乎有点不合适。

I wouldn't say this technique is *inappropriate* - the real problem is that mainstream OOP languages lack a mechanism to define a type by cases. Doing this conflates cases with types (unless you hide the subclasses by making them private) but it's the only option you have in Java.

* * *

[ruakh's answer](https://stackoverflow.com/a/15329192/1272233) addresses your question about the sealing mechanism so I'll skip that. As for avoiding the Fragile Base Class Problem, [this paper](http://www.cs.cmu.edu/~aldrich/papers/selective-open-recursion.pdf) presents a solution that currently works in Java. The idea is to make all public methods `final` and implement them in terms of `protected` methods. This ensures that subclasses can only override those methods you deem safe.

The problem with inheritance as implemented in mainstream OOP languages is that it's something you have to *opt out of* when it should be something you have to *opt into*. That said, other than defining a type by cases I'm not sure what other use inheritance has that's not better replaced with aggregation/composition.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-11T00:17:12.123

尽管有一个 关于它的[Wikipedia 页面](http://en.wikipedia.org/wiki/Fragile_base_class)，甚至还有一个关于它的[StackOverflow 问题](https://stackoverflow.com/questions/2921397/what-is-the-fragile-base-class-problem)，但实际上并没有像*Fragile Base Class Problem*这样的东西。您找不到任何最近引用它的原因是因为它在 80 年代中期被重命名为*The Incompetent Programmer Problem*。

 *之所以改名，是因为有人终于意识到它描述的问题，在基类中改变一些看似无关紧要的方法，对所有继承的子类都会产生深远的影响，其实不是 oop 的问题，而是**把错误的代码放在你的基类**中。

**如果您想正确编写 oop 代码并且希望使用继承，那么**您肯定必须完全明确地确保您的基类只包含**完全稳定**和**完全可靠的**代码。因为一旦你开始从中派生，你就会陷入困境。如果您发现一旦从基类派生了几次就想更改基类，那么您实际上已经在踢自己的脚了。

摆弄奇怪的私有等级制度并不是答案。*

# java - 平滑 Java 绘制动画

> ID：15329117
> 
> 赞同：1
> 
> 时间：2013-03-10T23:42:15.707
> 
> 标签：java, multithreading, repaint

我想让我的应用程序绘制移动图像比它当前绘制它们的方式更平滑一些。我不知道该怎么做。

这是我的主要游戏线程的样子：

```
@Override
public void run(){
    int delay = 500; //milliseconds
    ActionListener taskPerformer = new ActionListener(){
        @Override
        public void actionPerformed(ActionEvent evt){
            Car car = new Car();
            int speed = (int)(3 + Math.floor(Math.random() * (6 - 3)));
            car.setSpeed(speed);
            MainLoop.this.gameObjects.vehicles.add(car.create("/Media/Graphics/blueCar.png", width - 20, 78));
            car.driveTo(0, 78);
        }
    };
    new Timer(delay, taskPerformer).start();
    try{
        while(true){
            this.repaint();
            for(GameObject go : this.gameObjects.vehicles){
                // loops through objects to move them
                Vehicle vh = (Vehicle) go;
                this.moveVehicle(vh);
                if(vh.getX() <= vh.getDestX()){
                    vh.markForDeletion(true);
                }
            }
            this.gameObjects.destroyVehicles();
            Thread.sleep(1);
        }
    }catch(Exception e){
        e.printStackTrace();
    }
} 
```

这是一种计算项目下一个 x/y 位置的方法

```
protected void moveVehicle(Vehicle vh){
    int cx = vh.getX();
    int dx = vh.getDestX();
    int cy = vh.getY();
    int dy = vh.getDestY();
    // move along x axis
    // getMaxSpeed() = Number between 3 and 6
    if(cx > dx && vh.movingX() == -1){
        vh.setX(cx - vh.getMaxSpeed());
    }else if(cx < dx && vh.movingX() == 1){
        vh.setX(cx + vh.getMaxSpeed());
    }else{
        vh.setX(dx);
    }

    // move along y axis
    // getMaxSpeed() = Number between 3 and 6
    if(cy > dy && vh.movingY() == -1){
        vh.setY(cy - vh.getMaxSpeed());
    }else if(cy < dy && vh.movingY() == 1){
        vh.setY(cy + vh.getMaxSpeed());
    }else{
        vh.setY(dy);
    }
} 
```

这是我的绘画方法：

```
@Override
public void paintComponent(Graphics graphics){
    super.paintComponent(graphics);
    Graphics2D g = (Graphics2D) graphics;

    for(GameObject go : gameObjects.vehicles){
        g.drawImage(go.getSprite(), go.getX(), go.getY(), this);
    }
} 
```

这可能比需要的信息更多，但我想知道，我应该怎么做才能使项目`left -> right` `top -> bottom`尽可能顺利地移动，而不会造成太大的性能损失？

**编辑：请求的 sscce：**

```
package sscce;

import java.awt.Color;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.Timer;

public class Sscce extends JPanel implements Runnable{

    ArrayList<Square> squares = new ArrayList<>();

    public Sscce(){
        JFrame frame = new JFrame();
        frame.setSize(500, 500);
        frame.setLocationRelativeTo(null);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);
        frame.add(this);
        Thread t = new Thread(this);
        t.start();
    }

    public static void main(String[] args){
        new Sscce();
    }

    @Override
    public void run(){
        int delay = 500; //milliseconds
        ActionListener taskPerformer = new ActionListener(){
            @Override
            public void actionPerformed(ActionEvent evt){
                Square squ = new Square();
                Sscce.this.squares.add(squ);
                squ.moveTo(0);
            }
        };
        new Timer(delay, taskPerformer).start();
        while(true){
            try{
                for(Square s : this.squares){
                    int objX = s.getX();
                    int desX = s.getDestX();
                    if(objX <= desX){
                        System.out.println("removing");
                        this.squares.remove(s);
                    }else{
                        s.setX(s.getX() - 10);
                    }
                }
                this.repaint();
                Thread.sleep(30);
            }catch(Exception e){
            }
        }
    }

    @Override
    public void paintComponent(Graphics g){
        super.paintComponent(g);
        for(Square s : squares){
            g.setColor(Color.blue);
            g.fillRect(s.getX(), s.getY(), 50, 50);
        }
    }
}

class Square{

    public int x = 0, y = 0, destX = 0;

    public Square(){
        this.x = 400;
        this.y = 100;
    }

    public void moveTo(int destX){
        this.destX = destX;
    }

    public int getX(){
        return this.x;
    }
    public int getDestX(){
        return this.destX;
    }

    public void setX(int x){
        this.x = x;
    }

    public int getY(){
        return this.y;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:35:25.280

首先请注意，由于某种原因，我在 MacOS 下运行时遇到了问题`JPanel`——`Runnable`我不知道为什么，但这就是我将其移出的原因。

您可能`squares`会在用于绘制时进行更新，这将导致异常（此外，在迭代时从列表中删除元素也不是一个好主意；））

相反，我有两个列表。我有一个模型，列表可以修改，然后是该`paint`方法可以使用的绘制列表。这允许线程在进行绘制过程时修改模型。

为了防止任何冲突，我添加了一个锁，它可以防止一个线程修改/访问绘制列表，而另一个线程将其锁定。

现在。回到真正的问题。您遇到的主要问题不是更新之间的时间量，而是您移动的距离。减少距离（使其变慢）并标准化更新。

大多数人不会注意到超过 25fps 的任何东西，因此尝试做更多的事情只会浪费 CPU 周期并让重绘管理器挨饿，从而阻止它实际更新屏幕。

可以肯定的是，这是一种平衡行为……

```
import java.awt.Color;
import java.awt.EventQueue;
import java.awt.Graphics;
import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.locks.ReentrantLock;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class TestAnimation11 extends JPanel {

    private ArrayList<Square> squares = new ArrayList<>();
    private ReentrantLock lock;

    public TestAnimation11() {
        lock = new ReentrantLock();
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }
                JFrame frame = new JFrame();
                frame.setSize(500, 500);
                frame.setLocationRelativeTo(null);
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setVisible(true);
                frame.add(TestAnimation11.this);
                Thread t = new Thread(new UpdateEngine());
                t.start();
            }
        });
    }

    public static void main(String[] args) {
        new TestAnimation11();
    }

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        Square[] paint = null;
        lock.lock();
        try {
            paint = squares.toArray(new Square[squares.size()]);
        } finally {
            lock.unlock();
        }
        for (Square s : paint) {
            g.setColor(Color.blue);
            g.fillRect(s.getX(), s.getY(), 50, 50);
        }
    }

    public class UpdateEngine implements Runnable {

        private List<Square> model = new ArrayList<>(squares);

        @Override
        public void run() {
            int ticks = 0;
            List<Square> dispose = new ArrayList<>(25);
            while (true) {
                ticks++;
                dispose.clear();
                for (Square s : model) {
                    int objX = s.getX();
                    int desX = s.getDestX();
                    if (objX <= desX) {
                        dispose.add(s);
                    } else {
                        s.setX(s.getX() - 2);
                    }
                }
                model.removeAll(dispose);
                if (ticks == 11) {
                    Square sqr = new Square();
                    sqr.moveTo(0);
                    model.add(sqr);
                } else if (ticks >= 25) {
                    ticks = 0;
                }
                lock.lock();
                try {
                    squares.clear();
                    squares.addAll(model);
                } finally {
                    lock.unlock();
                }
                repaint();
                try {
                    Thread.sleep(40);
                } catch (Exception e) {
                }
            }
        }
    }

    class Square {

        public int x = 0, y = 0, destX = 0;

        public Square() {
            this.x = 400;
            this.y = 100;
        }

        public void moveTo(int destX) {
            this.destX = destX;
        }

        public int getX() {
            return this.x;
        }

        public int getDestX() {
            return this.destX;
        }

        public void setX(int x) {
            this.x = x;
        }

        public int getY() {
            return this.y;
        }
    }
} 
```

# android - 在Android中编写系统文件的最有效方法？

> ID：15329118
> 
> 赞同：0
> 
> 时间：2013-03-10T23:42:17.867
> 
> 标签：android, permissions, system, root

我正在编写一个应用程序来更改类似于 setCpu 的 cpu 调节器。

我遇到的问题有时是在编写调控器文件（系统文件）时，我得到一个 IOException（错误的文件号），它似乎是随机发生的。

我在我的 onCreate 方法中请求 root 并将进程保留为一个字段：

```
private Process suProcess;

public void onCreate(Bundle ...) {
    ...    
    suProcess = Runtime.getRuntime().exec("su");
    ... 
```

当我需要编写系统文件时，这是我的代码：

```
try {
    DataOutputStream out = new DataOutputStream(suProcess.getOutputStream());
    out.writeBytes("echo " + FILE_CONTENTS + " > " + SYSTEM_FILE);
    out.flush();
    out.close();
} catch (IOException e) { 
    e.printStackTrace();
} 
```

这是处理root权限的正确方法吗？为什么我会随机收到 IOException？（有时有效，有时无效）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:28:25.133

显然对这个问题不太感兴趣，但这是我的解决方案。

称呼

```
Runtime.getRuntime().exec("su"); 
```

在 onCreate 中确保用户在使用过程中不必处理 SU 对话框。

然后在编写系统文件时创建另一个 SU 进程（应用程序应该已经有 su 权限）

```
try {
    Process suProcess = Runtime.getRuntime().exec("su");
    DataOutputStream out = new DataOutputStream(suProcess.getOutputStream());
    out.writeBytes("echo " + FILE_CONTENTS + " > " + SYSTEM_FILE);
    out.flush();
    out.close();
} catch (IOException e) { 
    e.printStackTrace();
} 
```

# php - 尝试使用 Facebook Graph API 列出 FB 好友图片

> ID：15329119
> 
> 赞同：-2
> 
> 时间：2013-03-10T23:42:21.370
> 
> 标签：php, facebook, facebook-graph-api

我正在尝试设置一个呼叫，该呼叫将为登录的 facebook 用户列出一定数量的朋友图片。它可以吐出用户的图片，但我无法接到要求 fb 朋友图片的电话。我相信你们可以轻松解决这个问题。这是代码：

```
<?php

    if(!isset($_SESSION['logged_in']))
    {
        ?>

<?php
    }
    else{

        if (!class_exists('FacebookApiException')) {
            require_once('./src/facebook.php' );
        }
        $facebook = new Facebook(array(
                                       'appId' => $appId,
                                       'secret' => $appSecret,
                                       ));

        $fbuser = $facebook->getUser();

        echo $fbuser;

        echo $_SESSION['user_name'];
        echo '<img src="https://graph.facebook.com/'.$fbuser.'/picture">';

        echo '<img src="https://graph.facebook.com/'.$fbuser.'/friends/picture">';

        echo '<a href="?logout=1">Log Out</a>';
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T01:00:21.567

您首先需要获取呼叫的用户好友列表`/me?fields=friends`。然后，您只能将他们的 id 添加到图片网址中，就像您对用户所做的那样：

```
<img src="https://graph.facebook.com/{{friend_id}}/picture"> 
```

# mongodb - 通过 mongodb 进行事件流式传输。获取最后插入的事件

> ID：15329123
> 
> 赞同：1
> 
> 时间：2013-03-10T23:42:30.850
> 
> 标签：mongodb

我使用现有数据库中的数据。这个数据库存储系统事件。我的服务应该通过计时器检查这个数据库，检查是否创建了一些新事件，然后上传并处理。类似于简单的队列实现。

问题是 - 当我检查数据库时，如何每次都获得**新文档。**我不能使用时间戳，因为事件从不同的来源进入数据库，并且事件没有任何顺序。所以我只需要使用插入订单。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T01:42:26.313

有几个选项。

如果它与您的用例匹配，第一个也是最简单的方法是使用上限集合。封顶集合是一个预定义大小的集合，充当一种环形缓冲区。一旦收集已满，它就会开始覆盖文档。为了迭代集合，您只需创建一个“tailable”光标，您将需要某种方式来识别“最后处理的文档”（即使文档中的一个简单的“done”标志也可以工作，但在插入文档时它必须存在） . 如果您确实无法以任何方式修改文档，那么您甚至可以将最后处理的文档保存在某个地方并使用课程时间戳（近似起始位置）并在处理更多文档之前查找最后一个文档。

此解决方案唯一真正的问题是您可以在集合中写入的文档数量受到限制，并且它不会随着时间的推移而增长。您可以对文档执行的写操作有限制（它们不能增长），但听起来不像是在修改文档。

第二种更复杂的选择是使用 oplog。对于独立配置，您仍需要传递 -replSet 选项来创建和使用 oplog。您将不会配置 oplog。在分片配置中，您需要分别跟踪每个“副本集”。oplog 包含一个文档，用于对服务器上的所有集合/文档执行的每个插入、更新、删除操作。每个条目都包含一个时间戳、操作和 id（至少）。以下是每个示例。

插入

```
{ "ts" : { "t" : 1362958492000, "i" : 1 }, 
  "h" : NumberLong("5915409566571821368"), "v" : 2, 
  "op" : "i", 
  "ns" : "test.test", 
  "o" : { "_id" : "513d189c8544eb2b5e000001" } } 
```

删除

```
{ ... "op" : "d", ..., "b" : true, 
   "o" : { "_id" : "513d189c8544eb2b5e000001" } } 
```

更新

```
{ ... "op" : "u", ..., 
  "o2" : { "_id" : "513d189c8544eb2b5e000001" }, 
  "o" : { "$set" : { "i" : 1 } } } 
```

时间戳在服务器上生成，并保证单调递增。这使您可以快速找到感兴趣的文档。

此选项是最强大的，但需要您做一些工作。

我编写了一些演示代码来在一个集合上创建一个“观察者”，这几乎就是你想要的。[您可以在GitHub 上](https://github.com/allanbank/mongodb-tricks)找到该代码。具体看[com.allanbank.mongodb.demo.coordination](https://github.com/allanbank/mongodb-tricks)包中的代码。

HTH，罗伯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:41:26.117

如果您的 _id 是 ObjectId 类型，您实际上可以使用时间戳**：**

```
prefix = Math.floor((new Date( 2013 , 03 , 11 )).getTime()/1000).toString(16)
db.foo.find( { _id : { $gt : new ObjectId( prefix + "0000000000000000" ) } } ) 
```

这样，事件源在哪里或何时发生都无关紧要，只在记录文档插入时才重要（高于上一个计时器）

当然，它是无模式的，您始终可以将 isNew 等字段设置为 true，并结合您的查询/游标将其设置为 false

# javascript - 如何使这个 JavaScript/CSS 随机动画代码更简单？

> ID：15329129
> 
> 赞同：1
> 
> 时间：2013-03-10T23:43:18.363
> 
> 标签：javascript, css, refactoring, document.write

下面的 JavaScript 代码生成 CSS 以使用随机值设置动画。代码复杂且重复。这段代码如何写得更优雅？

```
axis=["X","Y","Z"];
document.write("@keyframes tumble { "+
"12% {transform:rotate"+axis[Math.floor(Math.random()*3)]+"(-"+Math.floor(Math.random()*180)+"deg) rotate"+axis[Math.floor(Math.random()*3)]+
"("+Math.floor(Math.random()*180)+"deg) rotate"+axis[Math.floor(Math.random()*3)]+"("+Math.floor(Math.random()*180)+"deg)}"+
"32% {transform:rotate"+axis[Math.floor(Math.random()*3)]+"(-"+Math.floor(Math.random()*180)+"deg) rotate"+axis[Math.floor(Math.random()*3)]+
"("+Math.floor(Math.random()*180)+"deg) rotate"+axis[Math.floor(Math.random()*3)]+"("+Math.floor(Math.random()*180)+"deg)}"+
"50% {transform:rotate"+axis[Math.floor(Math.random()*3)]+"( "+Math.floor(Math.random()*180)+"deg) rotate"+axis[Math.floor(Math.random()*3)]+
"("+Math.floor(Math.random()*180)+"deg) rotate"+axis[Math.floor(Math.random()*3)]+"("+Math.floor(Math.random()*180)+"deg)}"+
"66% {transform:rotate"+axis[Math.floor(Math.random()*3)]+"( "+Math.floor(Math.random()*180)+"deg) rotate"+axis[Math.floor(Math.random()*3)]+
"("+Math.floor(Math.random()*180)+"deg) rotate"+axis[Math.floor(Math.random()*3)]+"("+Math.floor(Math.random()*180)+"deg)}"+
"84% {transform:rotate"+axis[Math.floor(Math.random()*3)]+"( "+Math.floor(Math.random()*180)+"deg) rotate"+axis[Math.floor(Math.random()*3)]+
"("+Math.floor(Math.random()*180)+"deg) rotate"+axis[Math.floor(Math.random()*3)]+"("+Math.floor(Math.random()*180)+"deg)}"+"}</style>"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T00:25:18.347

我将一步一步地解决答案，并在我进行的过程中与您分享。

第一个简单的步骤是进行一些非常小的重新格式化，以缩短行长并使其更容易查看代码。实际上，此时我可能不会担心行长，但较短的行会在这里显示得更好：

```
axis = [ "X","Y","Z" ];

document.write(
    "@keyframes tumble { "+

    "12% {transform:rotate" +
    axis[Math.floor(Math.random()*3)] +
    "(-" + Math.floor(Math.random()*180) + "deg) rotate" +
    axis[Math.floor(Math.random()*3)] + 
    "(" + Math.floor(Math.random()*180) + "deg) rotate" +
    axis[Math.floor(Math.random()*3)] +
    "(" + Math.floor(Math.random()*180) + "deg)}" +

    "32% {transform:rotate" +
    axis[Math.floor(Math.random()*3)] +
    "(-" + Math.floor(Math.random()*180) + "deg) rotate" +
    axis[Math.floor(Math.random()*3)] + 
    "(" + Math.floor(Math.random()*180) + "deg) rotate" +
    axis[Math.floor(Math.random()*3)] +
    "(" + Math.floor(Math.random()*180) + "deg)}" +

    "50% {transform:rotate" +
    axis[Math.floor(Math.random()*3)] +
    "( " + Math.floor(Math.random()*180) + "deg) rotate" +
    axis[Math.floor(Math.random()*3)] + 
    "(" + Math.floor(Math.random()*180) + "deg) rotate" +
    axis[Math.floor(Math.random()*3)] +
    "(" + Math.floor(Math.random()*180) + "deg)}" +

    "66% {transform:rotate" +
    axis[Math.floor(Math.random()*3)] +
    "( " + Math.floor(Math.random()*180) + "deg) rotate" +
    axis[Math.floor(Math.random()*3)] + 
    "(" + Math.floor(Math.random()*180) + "deg) rotate" +
    axis[Math.floor(Math.random()*3)] +
    "(" + Math.floor(Math.random()*180) + "deg)}" +

    "84% {transform:rotate" +
    axis[Math.floor(Math.random()*3)] +
    "( " + Math.floor(Math.random()*180) + "deg) rotate" +
    axis[Math.floor(Math.random()*3)] + 
    "(" + Math.floor(Math.random()*180) + "deg) rotate" +
    axis[Math.floor(Math.random()*3)] +
    "(" + Math.floor(Math.random()*180) + "deg)}" +

    "}</style>"
); 
```

`<style>`两个项目立即跳出：生成代码的开头似乎缺少一个标签（`</style>`末尾有一个。）并且语句中缺少`var`一个。`axis = ...`

接下来显而易见的是，这两种模式在代码中一遍又一遍地出现：

```
Math.floor(Math.random()*3)

Math.floor(Math.random()*180) 
```

因此，让我们编写一些函数来简化它们，并进行简单的搜索和替换以更改现有代码以使用这些函数：

```
// Return a random integer n in the range 0 <= n < limit
function randInt( limit ) {
    return Math.floor( Math.random() * limit );
}

// Return a random integer n in the range 0 <= n < 3
function rand3() {
    return randInt( 3 );
}

// Return a random integer n in the range 0 <= n < 180
function rand180() {
    return randInt( 180 );
}

var axis = [ "X","Y","Z" ];

// Write a <style> tag to the document with a random animation
document.write(
    "<style>@keyframes tumble { "+

    "12% {transform:rotate" +
    axis[rand3()] +
    "(-" + rand180() + "deg) rotate" +
    axis[rand3()] + 
    "(" + rand180() + "deg) rotate" +
    axis[rand3()] +
    "(" + rand180() + "deg)}" +

    "32% {transform:rotate" +
    axis[rand3()] +
    "(-" + rand180() + "deg) rotate" +
    axis[rand3()] + 
    "(" + rand180() + "deg) rotate" +
    axis[rand3()] +
    "(" + rand180() + "deg)}" +

    "50% {transform:rotate" +
    axis[rand3()] +
    "( " + rand180() + "deg) rotate" +
    axis[rand3()] + 
    "(" + rand180() + "deg) rotate" +
    axis[rand3()] +
    "(" + rand180() + "deg)}" +

    "66% {transform:rotate" +
    axis[rand3()] +
    "( " + rand180() + "deg) rotate" +
    axis[rand3()] + 
    "(" + rand180() + "deg) rotate" +
    axis[rand3()] +
    "(" + rand180() + "deg)}" +

    "84% {transform:rotate" +
    axis[rand3()] +
    "( " + rand180() + "deg) rotate" +
    axis[rand3()] + 
    "(" + rand180() + "deg) rotate" +
    axis[rand3()] +
    "(" + rand180() + "deg)}" +

    "}</style>"
); 
```

如您所见，代码已经简单*多了*。

现在让我们看看这五个相似的代码块之间有什么相同和不同之处。将这些块加载到可以进行逐个字符（行内）差异的程序中会很有帮助。我为此使用[Araxis Merge](http://www.araxis.com/merge/)。[Beyond Compare](http://www.scootersoftware.com/)是另一个不错的选择。这些都是商业产品；毫无疑问，也有很好的免费替代品。

当我们将第一个块与最后一个块进行比较时，Araxis Merge 显示的内容如下：

![Araxis Merge 两个相似代码块的差异](../Images/640f5edb2c67d84d91bfc1683b3bf240.png)

（如果你不喜欢这个字体，不要怪 Araxis；那只是我的个人设置。而带有自动换行的窄宽度只是为了让它适合这里的列。）

我们可以看到只有两个区别：第一行是百分比数字，第三行是`"(-"`vs `"( "`.。事实上，这是所有区块之间仅有的两个区别。

所以，我们现在可以做的是编写一个函数来返回这段代码并让我们插入这两个值。

```
// Return a transform:rotate string with the specified
// percent and flag
function makeTransform( percent, flag ) {
    return (
        percent + "% {transform:rotate" +
        axis[rand3()] +
        "(" + flag + rand180() + "deg) rotate" +
        axis[rand3()] + 
        "(" + rand180() + "deg) rotate" +
        axis[rand3()] +
        "(" + rand180() + "deg)}"
        );
} 
```

现在看那个函数，里面还有一些重复的东西。但在这一点上真的很简单；重复是相当轻微的。不过，既然我们已经完成了，那么让我们看看如何进一步重构该代码：

```
// Return a random axis and degree string
function randAxisDegree( flag ) {
    return axis[rand3()] + "(" + flag + rand180() + "deg)";
}

// Return a transform:rotate string with the specified
// percent and flag
function makeTransform( percent, flag ) {
    return (
        percent + "% {transform:rotate" +
            randAxisDegree(flag) + " rotate" +
            randAxisDegree("") + " rotate" +
            randAxisDegree("") +
        "}"
    );
} 
```

当然，现在我们可能会注意到我之前创建的`rand3()`and`rand180()`函数并不是真正需要的，因为它们现在每个只使用一个地方并且根本不需要是单独的函数。

事实上，回顾代码，这两个函数即使在多个地方*被*`rand3()`调用也并没有真正的帮助：几乎不比 更好`randInt(3)`，或者为了保持同样的简洁性，甚至将这个函数重命名为`rand()`我们可以说`rand(3)`的而不是`rand3()`.

我很想编辑这个答案以从一开始就采用这种方法，但是让我们不管它，以展示重构可以采取的有点弯曲的路径。不过，我们现在将删除它们，并`randInt()`直接从以下位置调用`randAxisDegree()`：

```
// Return a random axis and degree string
function randAxisDegree( flag ) {
    return axis[randInt(3)] + "(" + flag + randInt(180) + "deg)";
} 
```

现在我们可以看到它是如何组合在一起的：

```
// Return a random integer n in the range 0 <= n < limit
function randInt( limit ) {
    return Math.floor( Math.random() * limit );
}

var axis = [ "X", "Y", "Z" ];

// Return a random axis and degree string
function randAxisDegree( flag ) {
    return axis[randInt(3)] + "(" + flag + randInt(180) + "deg)";
}

// Return a transform:rotate string with the specified
// percent and flag
function makeTransform( percent, flag ) {
    return (
        percent + "% {transform:rotate" +
            randAxisDegree(flag) + " rotate" +
            randAxisDegree("") + " rotate" +
            randAxisDegree("") +
        "}"
    );
}

// Write a <style> tag to the document with a random animation
document.write(
    "<style>@keyframes tumble { " +
        makeTransform( 12, "-" ) +
        makeTransform( 32, "-" ) +
        makeTransform( 50, " " ) +
        makeTransform( 66, " " ) +
        makeTransform( 84, " " ) +
    "}</style>"
); 
```

# javascript - 如何使整个 Angular ng-grid 可编辑？

> ID：15329132
> 
> 赞同：0
> 
> 时间：2013-03-10T23:43:45.757
> 
> 标签：javascript, grid, angularjs

使用下面的代码，您可以使列可编辑。

```
cellTemplate: '<input style="width:100%;height:100%;" class="ui-widget input" type="text" ng-readonly="!row.selected" ng-model="COL_FIELD"/>' }, 
```

如何使整个网格可编辑？文档说看看wiki。维基在哪里？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T17:28:16.490

您可以通过在 > v2.0.0 中设置“enableCellEdit: true”和“enableCellSelection: true”来启用 excel 样式模式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T12:17:17.503

GitHub 上的 wiki 位于选项卡的子导航中；查看“问题”等旁边的内容。

# javascript - 当我收到页面访问时，它会自动发送好友请求

> ID：15329135
> 
> 赞同：0
> 
> 时间：2013-03-10T23:44:40.250
> 
> 标签：javascript

所以我试图做到这一点，当有人在网站上查看我的个人资料时：playcraftmc.com/profile/1252121

它使该人自动向我发送好友请求。这是我到目前为止所拥有的。

`<script> Enjin_Profile_Friends.gi().followUser(1252121) </script>`

现在这可行，如果用户登录，它会发送好友请求，但它会不断刷新页面。我对js很陌生，我不知道你是否可以做到，所以它只执行一次脚本。

顺便说一句，我在这个网站上确实有管理员权限，并且这个代码是直接嵌入到网站中的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T23:49:58.783

让我们看看源代码是什么样子的：

```
> Enjin_Profile_Friends.gi().followUser
function(user_id) {
    $.post('/ajax.php?s=friends', {
        op: 'add',
        user_id: user_id
    }, function(result) {
        if (result.error != undefined && result.error) Enjin_Core.alert(result.error);
        else document.location.reload();
    }, 'json');
} 
```

删除您完成需要的部分：

```
function(user_id) {
    $.post('/ajax.php?s=friends', {
        op: 'add',
        user_id: user_id
    }, 'json');
} 
```

它应该工作：

```
<script type="text/javascript">
    $.post('/ajax.php?s=friends', {
        op: 'add',
        user_id: '1252121'
    }, 'json');
</script> 
```

# jquery - Firefox 忽略 AJAX 响应的内容类型

> ID：15329146
> 
> 赞同：2
> 
> 时间：2013-03-10T23:45:43.453
> 
> 标签：jquery, ajax, firefox, cors

我正在使用 jQuery 执行 AJAX 多部分表单上传。这是一个 CORS 请求。

```
// performs a multipart form upload
self.upload = function (path, formData) {
    return $.ajax({
        url: this.createUri(path),
        type: "POST",
        contentType: false,
        processData: false, // otherwise jQuery will convert to application/x-www-form-urlencoded
        data: formData,
        beforeSend: configureRequest
    });
}; 
```

服务器返回一个 JSON 响应，其标头设置如下

```
Content-Encoding    gzip
Content-Length      176
Content-Type        application/json; charset=utf-8 
```

在 Chrome/Safari 中，响应内容作为 JavaScript 对象返回。根据 jQuery 文档：

> dataType：您期望从服务器返回的数据类型。如果没有指定，jQuery 将尝试根据响应的 MIME 类型推断它

在 Firefox 中，响应内容以 a 形式返回，`string`因此它似乎忽略了`Content-Type`标头。我可以通过设置来解决这个问题，`dataType: "json"`但想了解这是否是由我做错的事情引起的，或者是 Firefox 的问题。

从服务器返回的示例 JSON 有效负载：

```
[
    {
        "name": "5711b4bc4cdde896.png",
        "uri": "http://127.0.0.1:10000/devstoreaccount1/001/5711b4bc4cdde896.png",
        "relativePath": "5711b4bc4cdde896.png",
        "contentType": "image/png",
        "sizeInBytes": 299724,
        "lastUpdated": "2013-03-10T23:31:13Z"
    }
] 
```

# objective-c - 如何检索某个视图 (textField) 及其值？

> ID：15329150
> 
> 赞同：2
> 
> 时间：2013-03-10T23:46:10.953
> 
> 标签：objective-c, xcode, macos

所以我的问题是我已经通过代码（不是界面构建器）在 xcode 中创建了一些视图，并为每个视图设置了特定的标签，这是我用来创建 NSTextField 的代码

```
NSTextField* textField;
for(int i=1; i<someNumber; i++)
{
   frame = ...;
   textField = [[NSTextField alloc] initWithFrame: frame];
   textField.tag = i;
   [self.window.contentView addSubview: textField];
   textField.target = self;
} 
```

如您所见，我没有保存每个文本字段，并且在某些时候我想检索特定视图以稍后使用它们的值。所以我的问题是：

1.  如何仅使用标签号检索视图？
2.  检索到 textFields 后如何获取它们的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T23:52:19.943

要使用指定标签获取视图，您可以使用`viewWithTag:`. 要获取文本，您可以使用`stringValue`.

```
NSTextField *textField = (NSTextField *)[self.window.contentView viewWithTag:1];
NSLog(@"%@", [textField stringValue]); 
```

# unit-testing - Junit：小于断言？

> ID：15329151
> 
> 赞同：11
> 
> 时间：2013-03-10T23:46:27.913
> 
> 标签：unit-testing, junit

有什么类似的`assertThat(a, lessThan(b));`吗？我目前正在使用 Junit 4.8.1，但我找不到小于。相反，我必须这样做`assertTrue(a < b)`，但这有一个缺点，它不会在测试日志中打印两个数字。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-10T23:54:21.583

你试过 JUnit + [Hamcrest](https://code.google.com/p/hamcrest/)吗？有关一些示例，请参阅此博客文章 - 它看起来几乎与您发布的内容完全相同：

[JUnit 4 展示 – assertThat 和 Hamcrest Matchers](http://dimitrisli.wordpress.com/2011/04/06/junit-4-showcase-assertthat-and-hamcrest-matchers/)

或者，还有来自[JUnit-addons 项目的](http://junit-addons.sourceforge.net/)[ComparableAssert](http://junit-addons.sourceforge.net/junitx/framework/ComparableAssert.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-12-09T17:24:34.480

You can import Hamcrest like this and use the Matchers.lessThan() method.

```
import static org.junit.Assert.*;
import static org.hamcrest.CoreMatchers.*;

assertThat(foo, Matchers.lessThan(bar)); 
```

# python - 如何使用/安装 gps python 库

> ID：15329152
> 
> 赞同：4
> 
> 时间：2013-03-10T23:46:34.343
> 
> 标签：python, python-2.7, gps

```
root@raspberrypi:~# python
Python 2.7.3 (default, Jan 13 2013, 11:20:46)
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from gps import gps
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: cannot import name gps
>>> exit () 
```

它似乎不起作用。已安装的 debian 软件包：gpsd、gpsd-clients、python-gps、libgps20、libgps-dev

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T02:01:30.540

我在 Ubuntu 机器上试了一下，效果很好：

```
$ python
Python 2.7.3 (default, Sep 26 2012, 21:51:14) 
[GCC 4.7.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from gps import gps
>>> 
```

首先，确保存在以下文件的文件（由于不同而保存目录不同）：

```
/usr/lib/pyshared/python2.7/gps/packet.so
/usr/lib/pyshared/python2.7/gps/clienthelpers.so
/usr/lib/python2.7/dist-packages/gps-3.6.egg-info
/usr/lib/python2.7/dist-packages/gps/misc.py
/usr/lib/python2.7/dist-packages/gps/client.py
/usr/lib/python2.7/dist-packages/gps/fake.py
/usr/lib/python2.7/dist-packages/gps/__init__.py
/usr/lib/python2.7/dist-packages/gps/gps.py 
```

这可以通过运行来完成：

```
dpkg -L python-gps 
```

还要确保`gps.py`在您运行 python 的目录中没有放置任何东西，因为这可能会搞砸导入器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-30T15:21:18.017

It might be useful to add that even after removing gps.py, I had a file called gps.pyc which was also creating this problem. u remove this file and then problem vanishes..

# javascript - 在 Google Apps 脚本的 for 循环中调用函数

> ID：15329153
> 
> 赞同：0
> 
> 时间：2013-03-10T23:46:38.283
> 
> 标签：javascript, google-apps-script

我找到了很多关于在循环中调用函数的信息，但我没有发现任何处理 Google Apps 脚本的东西。我已经阅读了几个教程，并以此为基础编写了代码： http: [//tobyho.com/2011/11/02/callbacks-in-loops/](http://tobyho.com/2011/11/02/callbacks-in-loops/)。

我的真实脚本从 Fusion Table 中提取数据并将其放入 Google Doc 中。我正在尝试用实际名称替换一些 Fusion Table 数值数据，但我需要一个在循环内运行的函数才能使其工作。这是一个简化的场景，它给了我同样的问题。

```
 var big = [];
    var data = [["fname1", "lname1", 2, 1980],["fname2", "lname2", 3, 1989]];

    function loop() {
      for(i in data) {
        Logger.log(big[i] = changeData(data[i][2]));
    }
    }

    function changeData(n) {
      return function() {
        Logger.log(n + "this worked");
      };
    } 
```

当我检查日志时，我得到了两次： function () { Logger.log(n + "this working");}

而不是执行该函数，它只是返回文本。我对 javascript 和 Google Apps 脚本真的很陌生。这是 GAS 问题还是我的代码有问题？任何帮助表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T23:57:47.593

您拥有的 changeData 函数是声明一个函数并返回新函数。

您只需要返回 changeData 函数的结果

```
function changeData(n) {      
    Logger.log(n + "this worked"); 
    return "changed data result";
} 
```

# css - 浮动在使用 CSS 浮动的元素上

> ID：15329156
> 
> 赞同：-1
> 
> 时间：2013-03-10T23:47:01.873
> 
> 标签：css

查看我的示例，以演示我遇到的问题：

[http://jsfiddle.net/zWkse/](http://jsfiddle.net/zWkse/)

```
#mymenu {
    float: left;
    z-index: 59;
    width: 60px;
    background: #000;
    color: #FFF;
}

#myleftcontent {
    width:100px;
    background-color:#fff;
    padding:7px;
    border: 1px solid #d3d3d3;
    float:left;
    padding-bottom: 7px;
    margin-bottom:20px;
}

#myrightcontent {
    float:right;
    width: 100px;
} 
```

在我的网页上，左边是主要内容，右边是一些注释（左右`div`元素）

它们都是`float: left`或`right`。

现在我有一个下拉菜单，当您单击顶部菜单上的锚链接时，它会向下滚动。此菜单在示例中为“mymenu”。

菜单也是一个`float: left`，但我希望它漂浮在现有元素上。

所以它`#mymenu`漂浮在`#myleftcontent`

如何做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T23:57:50.110

好吧，您尚未发布的 y 部分就是它的落下点。该元素需要定位，以便`#mymenu`可以绝对定位，使 i 脱离流动并允许 z-index 发挥作用：http: [//jsfiddle.net/4hGnL/](http://jsfiddle.net/4hGnL/)

```
<div id="menu-container">
    <div id="mymenu">
        MY MENU<br />
        MY MENU
    </div>
</div>
<div id="myleftcontent">
    i gentager successen og giver dig nu chancen for at få én times afslappende aroma therapy massage hos Prani Wellness, der fjerner dine spændinger og får dig i en rus af velvære! 
Thailandsk aroma therapy massagei gentager successen og giver dig nu chancen for at få én times afslappende aroma therapy massage hos Prani Wellness, der fjerner dine spændinger og får dig i en rus af velvære! 
Thailandsk aroma therapy massage
</div>
<div id="myrightcontent">
    i gentager successen og giver dig nu chancen for at få én times afslappende aroma therapy massage hos Prani Wellness, der fjerner dine spændinger og får dig i en rus af velvære! 
Thailandsk aroma therapy massagei gentager successen og giver dig nu chancen for at få én times afslappende aroma therapy massage hos Prani Wellness, der fjerner dine spændinger og får dig i en rus af velvære! 
Thailandsk aroma therapy massage
</div> 
```

使用CSS：

```
#menu-container {
    position: relative;
}
#mymenu {
    float: left;
    z-index: 59;
    width: 60px;
    background: #000;
    color: #FFF;
    position: absolute;
}
#myleftcontent {
    width:100px;
    background-color:#fff;
    padding:7px;
    border: 1px solid #d3d3d3;
    float:left;
    padding-bottom: 7px;
    margin-bottom:20px;
}
#myrightcontent {
    float:right;
    width: 100px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:01:20.260

您希望菜单做的不是浮动，而是实际上具有绝对位置。这会将菜单移出文档流。

```
position:absolute;
z-index:1; 
```

Z-index 确定元素所在的“层”。从技术上讲，您可以假设所有静态和相关元素默认位于第 0 层。

请记住，当涉及到您的 HTML 结构时，这将需要一些计划。绝对元素将相对于其容器定位。因此，如果您将它放在具有相对位置的 div 中，则顶部和左侧 0 点位于该容器的边缘。否则，它将继续上升，直到与窗口完全一致。

我已经用这种新的风格改变更新了你的小提琴[http://jsfiddle.net/zWkse/4/](http://jsfiddle.net/zWkse/4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T23:58:51.680

添加`clear: left;`to`#myleftcontent`会将其移至下方`#mymenu`。

编辑：回答假设“超过”意味着上述。对不起，如果这不是你的意思！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-16T00:40:26.713

您确定要浮动菜单吗？我认为您在绝对定位的正确轨道上，但作为 myleftcontent div 的*子*项并给予适当的：

左：0；顶部：0；

类型参数（或带有一些填充）。并且（如前所述）您希望此菜单具有更高的 z-index。

当然，myleftcontent 不必是绝对定位的。

另见： [http ://www.w3schools.com/css/css_positioning.asp](http://www.w3schools.com/css/css_positioning.asp)

# javascript - Array is.Array if 和 else 语句

> ID：15329157
> 
> 赞同：2
> 
> 时间：2013-03-10T23:47:06.630
> 
> 标签：javascript, jquery, ajax

所以我想写一个`if else`语句，如果`Array.isArray`为假，则显示一条消息。我下面的功能允许用户输入地址，单击`Find ZipCode`并执行此操作。该功能有效，只是如果我输入无效地址，它不会显示我想要的消息，即`invalid zipcode`

在我的 HTML 中，我有：

```
<label>
Address:
      <input name="address" type="text" id="address"></label>
      <input type="button" value="Find ZipCode" id="find">
<p id="output"></p> 
```

和 Javascript：

```
var hello = function(data) {
    var result = ""; // empty string to hold the value
    var address = $("#address").val();

    if (! Array.isArray(data))
    {
        $("#output").html("invalid zipcode");
    }
    else {
        for (var i = 0; i < data.length; i++) 
        {
            var zipcode = data[i].zipcode;
            result += address + " zipcode: " + zipcode;
        }
    $("#output").html(result);

    }
};

$("#find").click(function(){
    var address = $("#address").val();
    $("#output").html("Loading...");            
    $.getJSON("zipcodelookup.php", "address="+address , hello);  
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T23:50:02.603

除非你修改了`Array.prototype`没有`Array.isArray`方法。我想你要找的是`$.isArray`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T23:55:11.500

你也可以像这样测试它是否是一个数组：

```
function isArray(arr) {
    return Object.prototype.toString.apply(arr) === '[object Array]';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T02:43:25.060

在 Javascript 中测试类型以推断其他条件通常是一个坏主意。似乎在这种情况下，如果找到邮政编码，则返回一个数组（某物）。

因此，您得出的结论是，如果您没有得到数组，则找不到邮政编码。这不是特别健壮，服务器最好返回一个更有用的已定义消息或错误代码，例如它可以建议是否找不到邮政编码、输入无效或数据库不存在可用的。

您还可以对返回的数组进行测试以查看它是否具有您想要的功能（即使用功能检测）。

# ajax - 通过ajax将页面加载到div时特殊字符不起作用

> ID：15329160
> 
> 赞同：0
> 
> 时间：2013-03-10T23:47:24.573
> 
> 标签：ajax, character

我正在尝试将我的静态 php 页面更改为 ajax。老实说，我没有太多关于它的信息。

我的问题是：当我将内容加载到 div 中时，我的旧 php 版本工作正常，但是当我使用 ajax 将内容放入 div 时（我实际上发现，你可以在下面找到）意大利字符变成了。

我浏览了其他一些类似的问题，但找不到有用的信息。

我使用标题：

我的 sql 编码是 utf_unicode_ci

而且我还意识到，当我将 php 标头添加为 utf 8 时，我的 php 版本字符也坏了。

我提出任何建议

谢谢

```
<script>

function createRequestObject() 
{
    var returnObj = false;

    if(window.XMLHttpRequest) {
        returnObj = new XMLHttpRequest();
    } else if(window.ActiveXObject) {
        try {
            returnObj = new ActiveXObject("Msxml2.XMLHTTP");

            } catch (e) {
            try {
            returnObj = new ActiveXObject("Microsoft.XMLHTTP");
            }
            catch (e) {}
            }

    }
    return returnObj;
}

var http = createRequestObject();
var target;

// This is the function to call, give it the script file you want to run and
// the div you want it to output to.
function sendRequest(scriptFile, targetElement)
{   
    target = targetElement;
    try{
    http.open('get', scriptFile, true);
        }
    catch (e){
    document.getElementById(target).innerHTML = e;
    return;
    }

    http.onreadystatechange = handleResponse;
    http.send();    
}

function handleResponse()
{   
    if(http.readyState == 4) {      
    try{
        var strResponse = http.responseText;
        document.getElementById(target).innerHTML = strResponse;
        } catch (e){
        document.getElementById(target).innerHTML = e;
        }   
    }
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T23:56:40.263

如果您的页面和 ajax 响应都使用 utf-8，那可能是最好的。您也可以尝试对非 ascii 字符使用 ' '-notation。

# jquery - 自定义 jQuery 水平网站：折叠和展开幻灯片制作自定义下一页按钮

> ID：15329161
> 
> 赞同：0
> 
> 时间：2013-03-10T23:47:33.043
> 
> 标签：jquery, html, pagination

**现场 js-Fiddle 演示链接：http:** [//jsfiddle.net/ivandude/r2UgV/1/](http://jsfiddle.net/ivandude/r2UgV/1/)

正如您所看到的，页面被分成 4 张幻灯片，它们在幻灯片的单击时打开。将鼠标移动到区域上的简单功能，然后单击一个以打开幻灯片的完整功能到目前为止，一切正常。

**不幸的是，当其中一张幻灯片处于全视图时，问题**是试图向前导航（单击下一步按钮）。**[请参阅幻灯片 1（单击打开）并单击 > 箭头]**。我只想想办法导航到下一张幻灯片。我的逻辑思维是只为我唯一的 ID 箭头按钮分配一个 jQuery Click 事件，并告诉 page-1 关闭，而 page-2 在它之后打开 <--- 但是这不起作用。

为了便于编辑和使用，我在上面准备了一个已注释的 jQuery。我认为最好查看下面的页面及其受影响的区域，但是如果您正在阅读并能够帮助我，非常感谢您:) 我已尝试使用 JS Fiddle 和下面的解释使其尽可能简单.

* * *

***按执行顺序：***

1.  在页面加载 > 每个页面（4 张幻灯片之一）通过 CSS **width:25%**设置。他们得到他们的高度来动态地填充浏览器窗口，但在这里并不重要。

2.  在身体负荷上 > 百分比已经发挥了它们的魔力，现在 jQuery 通过 jQuery 将这些百分比转换为可变数据。

    ```
    $("#page-1, #page-2, #page-3, #page-4").each(function() {
    $(this).data("standardWidth", $(this).width());
    }); 
    ```

    它们稍后用于放大（提供预览）到幻灯片的悬停效果。（例如，在不点击的情况下移动鼠标）

3.  当鼠标悬停在幻灯片上时，会发生这种情况：

    ```
    $("#page-1, #page-2, #page-3, #page-4").mouseenter(function() {

    $(this).parent().children().not(this).animate({
        opacity: 0.5,
        width: (($(this).data("standardWidth") - 34)+'px')
    }, 250 );

    $(this).animate({
        opacity: 1,
        width: (($(this).data("standardWidth") + 100)+'px')
    }, 250 );

    }); 
    ```

    没有 mouseleave 事件。

4.  单击幻灯片时会发生这种情况：

    ```
    $("#page-1, #page-2, #page-3, #page-4").click(function() {

    $(this).parent().children().not(this).animate({
        opacity: 0,
        width: ((0)+'px')
    }, 300 );

    $(this).animate({
        opacity: 1,
        width: $(document).width()
    }, 300 );

    }); 
    ```

5.  当然，这是我在单击时尝试制作的唯一按钮，第 1 页将折叠（**宽度为 0？**），第 2 页展开（**宽度为 100%？**），并在某种可行的 jquery 代码中，以便我可以分配每个按钮的自定义功能:)

    ```
    $("#s1-arrow-r").click(function() {

    $("#page-1, #page-3, #page-4").parent().children().stop().animate({
        opacity: 0,
        width: ((0)+'px')
    }, 300 );

    $("#page-2").stop().animate({
        opacity: 1,
        width: $(document).width()
    }, 300 );

    }) 
    ```

我为每个手动下一步按钮制作唯一的 ID 没有问题，因为这个微型网站不会有超过 4 张幻灯片，而且我自己也在进行一些手动学习。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T23:49:27.543

```
RETURN FALSE; 
```

已用于解决此问题。幻灯片不断恢复到其原始状态，这有助于 .click(function() 在关闭之前。如果需要，请联系我以获取更多详细信息...

# google-chrome-extension - 如何在 chrome.downloads.download 方法上发送发布数据？

> ID：15329166
> 
> 赞同：0
> 
> 时间：2013-03-10T23:48:52.953
> 
> 标签：google-chrome-extension

我尝试使用 chrome.downloads.download 方法，我需要将发布数据发送到服务器，我在下载选项上使用 options.body="?keyName=value" 但它不起作用。也许有人更了解api，文档对这个主题不是很明确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-23T17:47:07.283

因为 Chrome 没有为您设置请求内容类型，您可以通过此脚本验证这一点：

```
<?php
header('Content-Type: text/plain; charset="utf-8"');
var_dump($_SERVER['REQUEST_METHOD']);
var_dump($_GET);
var_dump($_POST);
var_dump($_SERVER['CONTENT_TYPE']);
var_dump(file_get_contents('php://input')); // $HTTP_RAW_POST_DATA
?> 
```

因此，您应该使用`parse_str($HTTP_RAW_POST_DATA, $post_params)`来获取参数的值。如果未正确设置内容类型，PHP 将不会解析帖子正文。（application/x-www-form-urlencoded、application/www-url-encoded 等）

# javascript - 使用本机 DOM 的最近祖先匹配选择器？

> ID：15329167
> 
> 赞同：15
> 
> 时间：2013-03-10T23:49:16.380
> 
> 标签：javascript, jquery, standards, w3c, dom-traversal

有人在 DOM api 中处理[jQuery.closest()](http://api.jquery.com/closest/)等价物吗？

看起来[Selectors Level 2 草案](http://www.w3.org/TR/selectors-api2/#matches)添加了`matches()`等效于[jQuery.is()](http://api.jquery.com/is/)，因此本机最接近应该更容易编写。添加`closest()`到选择器出现了吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-05-07T23:38:21.903

建立在 Alnitak 的答案之上。`matchesSelector`这是目前`matches`在 DOM 规范中的工作当前实现。

```
// get nearest parent element matching selector
function closest(el, selector) {
    var matchesSelector = el.matches || el.webkitMatchesSelector || el.mozMatchesSelector || el.msMatchesSelector;

    while (el) {
        if (matchesSelector.call(el, selector)) {
            break;
        }
        el = el.parentElement;
    }
    return el;
} 
```

浏览器支持很棒：[http ://caniuse.com/matchesselector](http://caniuse.com/matchesselector)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-12-04T21:51:02.673

似乎 Chrome 40 将带来此处指定的本机`element.closest()`方法（[http://blog.chromium.org/2014/12/chrome-40-beta-powerful-offline-and.html](http://blog.chromium.org/2014/12/chrome-40-beta-powerful-offline-and.html)）：[https://dom.spec.whatwg .org/#dom-element-closest](https://dom.spec.whatwg.org/#dom-element-closest)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-02-25T15:04:01.127

请参阅[element.closest() 文档](https://developer.mozilla.org/en-US/docs/Web/API/Element/closest)。

用 Element.matches() 实现这样的功能在性能方面似乎不是最优的，因为很明显，matches() 会在您每次测试父母时调用 querySelectorAll() ，而只需一次调用就足以完成这项工作。

这是 MDN 上最接近（）的 polyfill。注意对 querySelectorAll() 的一次调用

```
if (window.Element && !Element.prototype.closest) {
  Element.prototype.closest = 
  function(s) {
      var matches = (this.document || this.ownerDocument).querySelectorAll(s),
          i,
          el = this;
      do {
          i = matches.length;
          while (--i >= 0 && matches.item(i) !== el) {};
      } while ((i < 0) && (el = el.parentElement)); 
      return el;
  };
} 
```

但请记住，像这样实现的功能将无法在未附加的树上正常工作（从 document.documentElement 根分离）

```
//Element.prototype.closestTest = function(s){...as seen above...};

var detachedRoot = document.createElement("footer");
var child = detachedRoot.appendChild(document.createElement("div"));
detachedRoot.parentElement; //null

child.closestTest("footer"); //null

document.documentElement.append(detachedRoot);
child.closestTest("footer"); //<footer> 
```

虽然在 Firefox 51.0.1 中实现的最接近（）似乎与分离树一起工作正常

```
document.documentElement.removeChild(detachedRoot);
child.closestTest("footer"); //null
child.closest("footer"); //<footer> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-11T00:04:13.510

考虑到该功能，这听起来应该很容易，[`matches`](https://developer.mozilla.org/en/docs/Web/API/Element/matches)尽管尚未得到广泛支持：

```
function closest(elem, selector) {
    while (elem) {
        if (elem.matches(selector)) {
            return elem;
        } else {
            elem = elem.parentElement;
        }
    }
    return null;
} 
```

问题是，该`matches`功能没有得到适当的支持。由于它仍然是一个相对较新的 API，它可以`webkitMatchesSelector`在 Chrome 和 Safari 以及`mozMatchesSelector`Firefox 中使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-02T11:41:14.117

使用 element.closest() 我们可以找到最近的祖先匹配选择器。此方法将选择器列表作为参数并返回最近的祖先。根据 Rob 的评论，该 API 将在 chrome 41 和 FF 35 中可用。

正如 whatwg 规范中所解释的那样[https://dom.spec.whatwg.org/#dom-element-closest](https://dom.spec.whatwg.org/#dom-element-closest)

示例：以下 HTML 将显示警报消息“true”

```
<html>
    <body>
        <foo>
            <bar>
                <a id="a">
                    <b id="b">
                        <c id="c"></c>
                    </b>
                </a>
            </bar>
         </foo>
    <script>
        var a = document.getElementById('a');
        var b = document.getElementById('b');
        var c = document.getElementById('c');
        alert(c.closest("a, b")==b);
    </script>
    </body>
</html> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-19T13:11:41.610

一点递归就可以解决问题。

```
// get nearest parent element matching selector
var closest = (function() {
    var matchesSelector = el.matches || el.webkitMatchesSelector || el.mozMatchesSelector || el.msMatchesSelector;

    return function closest(el, selector) {
        return !el ? null :
        matchesSelector.call(el, selector) ? el : closest(el.parentElement, selector);
    };
})(); 
```

# php - 从 MySQL 中检索 SQL 语句并在 PHP 中处理

> ID：15329169
> 
> 赞同：0
> 
> 时间：2013-03-10T23:49:36.290
> 
> 标签：php, sql

我已经成功地将一些 SQL UPDATE 语句保存到 MySQL，现在我想检索它们并让 PHP 处理它们。代码如下。

当我回显 $query 时，我从数据库中获得了正确的 SQL 语句，但是当我尝试处理它们时，我收到一个错误警告：mysqli_query() [function.mysqli-query]: Empty query

这对我来说毫无意义，让我发疯！我是否必须对 $query 做其他事情以便 PHP 可以处理它？

```
 $num_rows = mysqli_num_rows($resultSQL);
if ($num_rows > 0)
{
    while ($row = mysqli_fetch_array($resultSQL))
        {
            $strSQLupd[] = $row['uSQL'];
        }
        foreach ($strSQLupd as $query) {
            $resultSQLupd = mysqli_query($link, 
            $query
            );
            if (!$resultSQLupd)
            {
                $error = 'Error fetching data: ' . mysqli_error($link);
                include 'error.html.php';
                exit();
            }
        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T23:59:26.087

您是否在某处设置了 $link 的值，并且您在此应用程序中执行的操作是否需要它？另外，请记住，这`var_dump($varname);`始终是一个有用的调试工具。

```
 foreach ($strSQLupd as $query) {
        // put a var_dump below
        var_dump($query);
        $resultSQLupd = mysqli_query($query
        );
        if (!$resultSQLupd)
        {
            $error = 'Error fetching data: ' . mysqli_error($link);
            include 'error.html.php';
            exit();
        }
    } 
```

试一试，看看转储到屏幕上的查询字符串。它可能是 null ，这就是产生错误的原因。

# c++ - 是否有专门用于 c++ 的 gdb？

> ID：15329175
> 
> 赞同：0
> 
> 时间：2013-03-10T23:50:04.603
> 
> 标签：c++, stl, gdb

因为用gdb调试c++代码很不方便，尤其是用stl的时候。例如，如果要检查向量中的内容，则需要使用一些代码，例如：

```
print *(myVector._M_impl._M_start)@myVector.size() 
```

结果并不简单。

此外，如果你想打印 std::map，似乎没有简单的方法。

# ember.js - Ember.js 重定向到模板

> ID：15329177
> 
> 赞同：2
> 
> 时间：2013-03-10T23:50:27.730
> 
> 标签：ember.js, ember-router

我有一个匹配列表，当我单击一个时，我想显示匹配。我知道我可以做一个 Master-Detail 样式的页面，当我单击一个时，我可以在同一页面的某处看到插座，但这不是我想要的。

我想要它，以便当我点击一个链接时，它会转到一个全新的匹配页面。我真的不知道该怎么做。

这是我的路线`#/matches`（在咖啡脚本中）

```
App.MatchesRoute = Ember.Route.extend(
  model: ->
    App.Match.find()
) 
```

这是我的`matches.handlebars`

```
<div id="matches">
  {{#each match in controller}}
    {{#linkTo "match" match class="panel six columns"}}
      Match between {{match.player.name}} and {{match.opponent.name}}
    {{/linkTo}}
    <br />
  {{/each}}
</div>

// I know that if I have this outlet, it will render `match.handlebars`
// right here, but I want it to be it's own page.
// {{outlet}} 
```

我只使用 Ember 几天，我发现的所有示例都使用主从视图。

请让我知道我可以从我的代码中提供的任何其他信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T03:42:04.453

**<编辑日期="2013 年 3 月 11 日">**

我已经[**在 GitHub 中推送了这个存储库**](https://github.com/MilkyWayJoe/Ember-Contact-Management-ConceptUI)。这是一个概念应用程序，它使用`renderTemplate`了您所描述的方式。

**</编辑>**

在您的子路由中，使用[`renderTemplate`](http://emberjs.com/guides/routing/rendering-a-template/)钩子来告诉您的应用程序在特定的`{{outlet}}`. 例子：

[源小提琴](http://jsfiddle.net/schawaska/gETyr/)

```
App.Router.map(function() {
    this.resource('matches', { path: 'matches' }, function() {
        this.route('match', { path: 'match/:match_id' });
    });
});

App.MatchesRoute = Em.Route.extend({
    model: function() {
        return App.Match.find();
    },
    setupController: function(controller, model) {
        model = App.Match.find();
        controller.set('content', model);
    },
    renderTemplate: function() {
        this.render('matches', {
            into: 'application'
        })
    }
});

App.MatchesMatchRoute = Em.Route.extend({
    model: function(params) {
        return App.Match.find(params.match_id);
    },
    setupController: function(controller, model) {
        controller.set('content', model);
    },
    renderTemplate: function() {
        this.render('match', {
            into: 'application'
        })
    }
}); 
```

这是设置为将其模板 ( )`MatchesMatchRoute`呈现到模板中。而且由于这个模板只有一个（见下面的把手），我们不必指定任何东西：`matches/match``application``{{outelet}}`

```
<script type="text/x-handlebars">
    <h1>App</h1>
    {{outlet}}
</script>

<script type="text/x-handlebars" data-template-name="matches">
    <h2>Matches</h2>
    <ul>
    {{#each match in controller}}
        <li>
            {{#linkTo matches.match match}}
                {{match.title}}
            {{/linkTo}}
        </li>
    {{/each}}
    </ul>
</script>

<script type="text/x-handlebars" data-template-name="match">
    <h3>{{title}}</h3>
    <p>{{description}}</p>
</script> 
```

如果您有多个插座的场景，则必须对它们进行限制，如下面的车把：

```
<script type="text/x-handlebars">
    <h1>App</h1>
    {{outlet main}}<br />
    {{outlet nested}}
</script> 
```

然后你的路线也必须指定出口。例子：

[源小提琴](http://jsfiddle.net/schawaska/hes8F/)

```
[...route code...]
renderTemplate: function() {

    this.render('content', {
        into: 'application',
        outlet: 'main'
    });

    this.render('buttons', {
        into: 'application',
        outlet: 'nested'
    });

}
[...route code...] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T03:06:27.697

`renderTemplate`您可以在定义路由时使用钩子使模板呈现到不同模板的出口（请参阅指南： [http](http://emberjs.com/guides/routing/rendering-a-template/) ://emberjs.com/guides/routing/rendering-a-template/ ）

对于您的示例，它可能如下所示：

```
App.MatchRoute = Ember.Route.extend({
  renderTemplate: function() {
    this.render({ into: 'matches' });
  }
}); 
```

# c# - 更快的鼠标点击响应？

> ID：15329178
> 
> 赞同：5
> 
> 时间：2013-03-10T23:50:30.610
> 
> 标签：c#, winforms

我正在用 C# 创建一个简单的球和桨程序，并使用鼠标单击来移动桨。为了注册鼠标点击，我有这个

```
 private void Form1_MouseClick(object sender, MouseEventArgs e)
    {
        if (e.Button == MouseButtons.Right)
        {
            paddle.movePaddleRight();
            this.Invalidate();
        }
        if (e.Button == MouseButtons.Left)
        {
            paddle.movePaddleLeft(); 
            this.Invalidate();
        }
    } 
```

问题是它没有记录快速连续的点击。单击一次后，大约需要半秒钟的时间来注册下一次单击（中间的所有单击都丢失）。有没有办法让桨根据每次点击移动并注册每次点击？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-11T00:05:58.570

快速单击会产生 MouseDoubleClick 事件。请改用 MouseDown 事件。

# uac - 除了临时文件夹（在 appdata 中）之外，还有哪些目录？

> ID：15329180
> 
> 赞同：0
> 
> 时间：2013-03-10T23:50:52.067
> 
> 标签：uac

除了 appdata 之外，我是否可以在没有 UAC 权限的情况下将文件拖放到其他目录？或者 AppData 是唯一的位置吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-03T03:33:24.257

用户可以写入其个人资料中的任何位置。例如：

*   `SHGetFolderPath(CSIDL_DESKTOPDIRECTORY)`例如 C:\Users\User0\Desktop
*   `SHGetFolderPath(CSIDL_MYDOCUMENTS)`例如 C:\Users\User0\Documents
*   `SHGetFolderPath(CSIDL_APPDATA)`例如 C:\Users\User0\AppData
*   `SHGetFolderPath(CSIDL_LOCAL_APPDATA)`例如 C:\Users\User0\AppData\Local

以及 Common AppData 文件夹：

*   `SHGetFolderPath(CSIDL_COMMON_APPDATA)`例如 C:\ProgramData

# bash - 使用 sed 将文件名的一部分提取到变量中

> ID：15329183
> 
> 赞同：1
> 
> 时间：2013-03-10T23:51:55.977
> 
> 标签：bash, sed

我有两个问题。我有一个文件夹，其中包含包含 .txt 文件的子文件夹。txt 文件的格式为

```
{title.of.a.book}.V{4 digit year}.{4 digit issue}.txt 
```

例子

```
to.kill.a.mockingbird.V1960.0001.txt 
```

我想提取三个信息：

1.  标题（用空格代替句点）例如：杀死一只知更鸟
2.  卷号 例如：1960
3.  问题编号 例如：0001

这是我到目前为止写的

```
for file in $(find /home/user/books -type f -name '*.txt')
do
    name=$(echo "$file"|sed -e 's/^\(.*\).V.*txt$/\1/')
    volume=$(echo "$file"|sed -e 's/^.*V\(\d{4}\).*$/\1/')
    issue=$(echo "$file"|sed -e 's/^.*\(\d{4}\).txt$/\1/')
    echo "$name" "$volume" "$issue"
done 
```

1.  如何提取 3 条信息来分隔变量
2.  如何`.`用空格替换

我无法决定是先重命名文件（重命名`s/./ /g`） - 还是`$name`之后重命名。

name 变量打印正确，但 volume 和 issue number 变量只是打印文件名...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T00:35:26.120

不需要使用 sed，bash 可以通过参数扩展来处理它。

假设您所有的文本文件都使用上述格式：

```
#!/bin/bash
for file in $(find /home/user/books -type f -name '*.txt'); do
    pre=${file%%.txt}
    pre=${pre//./ }
    name=${pre%% V*}
    volume=${pre##* V}
    volume=${volume%% *}
    issue=${pre##* }
    echo "Name: '$name' Volume: '$volume' Issue: '$issue'"
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T06:20:23.117

[演讲](https://stackoverflow.com/users/1337398/speakr)者的[解决方案](https://stackoverflow.com/a/15329515/15168)可能是最好的，但我仍然是老派，喜欢.`sed`

您可以`sed`在单个`-e`参数中提供多个命令，用分号分隔，或者在多个`-e`参数中；我更经常使用后者。我还将清理名称`find`以删除主要路径。然后你需要决定你是否使用扩展的正则表达式 not，并且你需要在你使用的内容上保持一致。

使用 GNU `sed`4.4.2 (©2012)，我无法获得`\d`识别数字的符号；这里可能有一些愚蠢的东西。

没有扩展的正则表达式（将适用于非 GNU 版本`sed`）：

```
for file in $(find /home/user/books -type f -name '*.txt')
do
    base=$(basename $file .txt)
    name=$(  echo "$base" | sed -e 's/^\(.*\).V.*$/\1/' -e 's/\./ /g') # replace dots
    volume=$(echo "$base" | sed -e 's/^.*V\([0-9]\{4\}\).*$/\1/')
    issue=$( echo "$base" | sed -e 's/^.*\([0-9]\{4\}\)$/\1/')
    echo "$name" "$volume" "$issue"
done 
```

示例书的输出：

```
to kill a mockingbird 1960 0001 
```

使用 GNU`sed`的“扩展正则表达式”模式 ( `-r`)：

```
for file in $(find /home/user/books -type f -name '*.txt')
do
    base=$(basename $file .txt)
    name=$(  echo "$base" | sed -r -e 's/^(.*).V.*$/\1/' -e 's/\./ /g') # replace dots
    volume=$(echo "$base" | sed -r -e 's/^.*V([0-9]{4}).*$/\1/')
    issue=$( echo "$base" | sed -r -e 's/^.*([0-9]{4})$/\1/')
    echo "$name" "$volume" "$issue"
done 
```

使用`\d`符号（不正确的输出）：

```
for file in $(find /home/user/books -type f -name '*.txt')
do
    base=$(basename $file .txt)
    name=$(  echo "$base" | sed -r -e 's/^(.*).V.*$/\1/' -e 's/\./ /g') # replace dots
    volume=$(echo "$base" | sed -r -e 's/^.*V(\d{4}).*$/\1/')
    issue=$( echo "$base" | sed -r -e 's/^.*(\d{4})$/\1/')
    echo "$name" "$volume" "$issue"
done 
```

输出：

```
to kill a mockingbird to.kill.a.mockingbird.V1960.0001 to.kill.a.mockingbird.V1960.0001 
```

# ruby-on-rails - 使用 Spork TestUnit 加载迷你裙

> ID：15329184
> 
> 赞同：0
> 
> 时间：2013-03-10T23:52:10.683
> 
> 标签：ruby-on-rails, spork, minitest, miniskirt

我真的很喜欢 Miniskirt 和 Minitest，但我在每次使用 spork 服务器运行时加载 factory.rb 文件时遇到问题。它去：

```
cannot load such file -- factories (LoadError) 
```

我的 factory.rb 文件与我的 test_helper.rb 一起位于 /test 目录中。

任何提示将不胜感激。

```
require 'rubygems'
require 'spork'

Spork.prefork do
    ...
    require 'factories'
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T22:37:06.700

我花了一点点试错才能让一切正常工作，但我通过切换到 spork-minitest 并使用 guard-minitest 的 master 分支来修复它。这是我的测试套件：

```
group :test, :development do
  gem 'capybara'
  gem 'database_cleaner'
  gem 'awesome_print'
  gem 'turn'
  gem 'guard'
  gem 'guard-spork'
  gem 'guard-minitest', github: 'guard/guard-minitest'
  gem 'guard-livereload'
  gem 'terminal-notifier-guard'
  gem 'capybara_minitest_spec'
  gem 'rb-fsevent', '~> 0.9.1'
  gem "spork-minitest", git: "https://github.com/semaperepelitsa/spork-minitest.git"
  gem 'miniskirt'
  gem 'minitest-spec-rails'
end 
```

无论如何感谢您的帮助。

# mysql - MySQL 帮助 - 哪些员工在一项任务上工作超过 50 小时？使用子查询？

> ID：15329187
> 
> 赞同：0
> 
> 时间：2013-03-10T23:52:25.510
> 
> 标签：mysql, sql

我有 2 张桌子，分配和员工。它们通过 EmployeeNumber 链接，而 HoursWorked 是存储在 assignment 中的一个属性。我已经尝试过了，我得到一个错误，说子查询返回超过 1 行。我究竟做错了什么：

```
SELECT e.FirstName, e.LastName
FROM employee e
WHERE (
    SELECT a.HoursWorked
    FROM assignment a
    WHERE a.HoursWorked > 50); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T23:55:17.043

看起来你正在尝试做这样的事情：

```
SELECT e.FirstName, e.LastName
FROM employee
JOIN assignment on employee.EmployeeNumber = assignment.EmployeeNumber
WHERE assignment.HoursWorked > 50; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T23:56:29.507

`SELECT e.FirstName, e.LastName FROM employee e WHERE e.EmployeeNumber IN ( SELECT EmployeeNumber FROM assignment a WHERE a.HoursWorked > 50);`

# php - 需要帮助将数据从 AS3 发送到 PHP

> ID：15329194
> 
> 赞同：0
> 
> 时间：2013-03-10T23:52:43.823
> 
> 标签：php, mysql, actionscript-3, phpmyadmin

我有一个在 Adob​​e flash actionscript 3 中创建的表单，需要帮助来验证我所做的是否正确......我是 AS3 和 PHP 的新手，因此非常感谢任何帮助和解释......

这是我的 AS3 编码....

```
processing_mc.visible = false;

function checkComplete(evt:MouseEvent):void {

    // Create A new URLVariables instance to store the variable
    var phpVars:URLVariables = new URLVariables();

    // Create a variable (e.g. candidate) to send
    phpVars.userFirstName = firstname_txt.text;
    phpVars.userLastName = lastname_txt.text;
    phpVars.userNumber = number_txt.text;
    phpVars.userEmail = email_txt.text; 
    phpVars.userMsg = msg_txt.text;

    // Create a new URLRequest instance sending data to "ascom01.php"
    var myRequest:URLRequest = new URLRequest("form.php");
    // Send data using the POST method
    myRequest.method = URLRequestMethod.POST;

    var loader:URLLoader = new URLLoader();
    loader.load(myRequest);

loader.addEventListener(Event.COMPLETE, response);
function response(e:Event):void
{
    trace(loader.data);
}

if(!firstname_txt.length) {
status_txt.text = "Please enter your first name";
} else if(!lastname_txt.length) {
status_txt.text = "Please enter your last name";
} else if (!email_txt.length) {
status_txt.text = "Please enter your email";
} else if (!number_txt.length) {
status_txt.text = "Please enter your phone number";
} else {

}

}
// handler for the PHP script completion and return of status
function completeHandler(event:Event):void {

processing_mc.visible = false;
firstname_txt.text = "";
lastname_txt.text = "";
email_txt.text = "";
number_txt.text = "";
msg_txt.text = "";

status_txt.text = event.target.data.return_msg;
}

// Add event listener for submit button click
submit_btn.addEventListener(MouseEvent.CLICK, checkComplete); 
```

这是我刚刚开始工作的 PHP 编码....

```
<?php 
if(isset($_POST['userFirstName']) && isset($_POST['userLastName']) && isset($_POST['userEmail']) && isset($_POST['userNumber']) && isset($_POST['userMsg']))
{
    $userFirstName=strip_tags($_POST['userFirstName']);
    $userLastName=strip_tags($_POST['userLastName']);
    $userEmail=strip_tags($_POST['userEmail']);
    $userNumber=strip_tags($_POST['userNumber']);
    $userMsg=strip_tags($_POST['userMsg']);

    // connect with database. 

    $username="******";
    $password="******";
    $database="b-elite-fitness";

    mysql_connect("localhost","$username","$password") or die (mysql_error());
    mysql_select_db("$database") or die (mysql_error());

    //query for inserting data in database.
    $query="INSERT INTO `formdp` VALUES('NULL','".mysql_real_escape_string($userFirstName)."','".mysql_real_escape_string($userLastName)."','".mysql_real_escape_string($userEmail)."','".mysql_real_escape_string($userNumber)."','".mysql_real_escape_string($userMsg)."')";

    if($query_run=mysql_query($query))
    {
        echo'Data inserted.';
    } else {
        die(mysql_error());
        }

}
?> 
```

任何人都可以帮助我了解两者之间的联系......我在网上查过，每个例子都不一样，无法理解它是如何工作的......

提前感谢DP

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:31:52.447

如果通过连接是指将数据从 AS3 发送到 PHP，那么您想使用[`URLLoader`](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/URLLoader.html)该类。

您已经准备好与`URLRequest`上面的实例一起使用的数据，所以剩下要做的就是通过以下方式发送该数据`URLLoader`：

```
var loader:URLLoader = new URLLoader();
loader.load(myRequest); 
```

您可以通过将侦听器附加[`Event.COMPLETE`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLLoader.html#event%3acomplete)到`URLLoader`. 响应将存储在其[`data`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLLoader.html#data)属性中：

```
loader.addEventListener(Event.COMPLETE, response);
function response(e:Event):void
{
    trace(loader.data);
} 
```

# sql-server-2008 - 当我尝试使用以下脚本删除表时，它似乎不起作用。

> ID：15329197
> 
> 赞同：0
> 
> 时间：2013-03-10T23:53:14.387
> 
> 标签：sql-server-2008, tsql, ddl

我正在尝试从每台服务器中删除表。我的服务器 1 有 3 个数据库，服务器 2 有 6 个，服务器 3 有 8 个。

下面是我编写的 SQL 脚本，用于从特定服务器中的每个数据库执行删除操作。在我执行这些操作之后。

```
DECLARE
   @LoopId     int,
   @Command    varchar(500),
   @tblName varchar(100)

DECLARE @List TABLE
(
   TableName  sysname  not null,
   LoopId     int      not null  identity(1,1)
)

--  Load with tables you wish to drop

INSERT @List (TableName)

SELECT name FROM [Morgage].sys.objects WHERE type = 'u' and name like '%JKL%'
SELECT name FROM [Scorecard].sys.objects WHERE type = 'u'and name like '%JKL%'
SELECT name FROM [Core].sys.objects WHERE type = 'u' and name like '%JKL%'

SET @LoopId = @@rowcount

--  Go through list and process each item
WHILE @LoopId > 0

BEGIN

SET @tblName = (SELECT TableName from @List where LoopId = @LoopId)    
SET @Command = 'Drop table ' + @tblName

execute (@Command)

SET @LoopId = @LoopId - 1
END 
```

上面的查询结果说行受到影响，但是当我去尝试测试时使用下面的查询。我确实看到了一切。我的查询实际上做了什么？我做对了吗？

```
SELECT name FROM [Scorecard].sys.objects WHERE type = 'u'and name like '%JKL%' 
```

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:04:01.667

可能是查询默认不提交。尝试明确指定它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T00:17:05.713

试试这个版本的脚本：-

```
DECLARE
   @LoopId     int,
   @Command    varchar(500),
   @tblName varchar(100),
   @dbName sysname

DECLARE @List TABLE
(
   DBName sysname not null,
   TableName  sysname  not null,
   LoopId     int      not null  identity(1,1)
)

--  Load with tables you wish to drop

INSERT @List (DBName, TableName)

SELECT 'Morgage',name FROM [Morgage].sys.objects WHERE type = 'u' and name like '%JKL%'
UNION
SELECT 'Scorecard',name FROM [Scorecard].sys.objects WHERE type = 'u'and name like '%JKL%'
UNION
SELECT 'Core',name FROM [Core].sys.objects WHERE type = 'u' and name like '%JKL%'

SET @LoopId = @@rowcount

--  Go through list and process each item
WHILE @LoopId > 0

BEGIN

SELECT @tblName = TableName, @dbName=DBName from @List where LoopId = @LoopId

SET @Command = 'USE ' + @dbName + ';if not exists(select 1 from sys.foreign_keys where parent_object_id=object_id(''' + @tblName + ''',''U'')' + char(10) + 'Drop table ' + @tblName + ';'

execute (@Command)

SET @LoopId = @LoopId - 1
END 
```

# excel - Excel 在尝试计算一个或多个公式时耗尽资源

> ID：15329199
> 
> 赞同：11
> 
> 时间：2013-03-10T23:53:41.683
> 
> 标签：excel, excel-2013, vba

我有一本工作簿可以对我的开支做“智能”图表。它已经运行了一年，现在有很多图表和费用。现在，每当我更改任何内容或打开工作簿时，Excel 都会引发资源不足错误。问题是，我有*很多*资源，而且几乎没有使用它们。

```
Win8 64bit w/ 8 core CPU and 32GB of ram
Office 2013 64bit 
```

我有 2 张工作表，第一个名为*Expenses*的工作表有 3 列 [Date,Description,Amount] 和大约 1500 行数据。第二张表有很多（大约 500 个）公式，它们都是相同的，旨在“总结日期 X 和 Y 之间的所有费用，其中描述匹配 - 一些针 -”。我的公式是这样的：

```
=
ABS(
    SUMPRODUCT(
        --(Expenses!A:A >= DATE(2011,12,1)), 
        --(Expenses!A:A < DATE(2012,1,1)), 
        --(ISNUMBER(FIND(C50,Expenses!B:B))),
        Expenses!C:C
    )
) 
```

我可以给 Excel 更多资源吗？（我很高兴它使用了我所有的内存，并占用了我的 CPU 几分钟）。

有没有更有效的方法可以做这个公式？

我知道这个公式正在创建一个大网格并用它掩盖我的费用清单，并且对于每个公式都必须创建这个网格。我应该创建一个宏来更有效地执行此操作吗？如果我有一个宏，我想以某种方式从单元格中调用它

```
=sumExpenses(<startDate>, <endDate>, <needle>) 
```

那可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-07-22T20:50:57.837

我有一个类似的问题，在大约 150 行中有几个数组公式，我得到了这个错误，这真的让我感到困惑，因为真的没有那么多公式要计算。我联系了我们的 IT 人员，他解释了以下内容，其中一些我理解，大部分我不明白：

通常，当计算机尝试处理大量数据时，它会使用多线程计算，即使用计算机欺骗自己认为拥有的所有 8 个处理器。关闭多线程计算时，计算机不会抛出“Excel 资源不足...”错误。

要关闭多线程计算，请转到 Excel 工作簿中的“文件”选项卡并选择“选项”。在出现的框的右侧，选择“高级”并向下滚动到“公式”标题。在该标题下是一个复选框，上面写着“启用多线程计算”。取消勾选它，然后选择“确定”并重新计算您的公式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T01:44:01.627

我尝试创建一个函数，希望能复制您当前的方程在 VBA 中的作用，但有一些差异。由于我不知道您的第二张工作表的细节，因此缓存可能根本无济于事。

如果您的第二张工作表对所有调用都使用相同的日期范围，`sumExpenses`那么它应该会更快一些，因为它会在第一次通过时预先汇总所有内容，如果您的日期范围在整个过程中发生变化，那么它只会白白做很多工作。

```
Public Cache As Object
Public CacheKey As String

Public Function sumExpenses(ByVal dS As Date, ByVal dE As Date, ByVal sN As String) As Variant
Dim Key As String
Key = Day(dS) & "-" & Month(dS) & "-" & Year(dS) & "_" & Day(dE) & "-" & Month(dE) & "-" & Year(dE)

    If CacheKey = Key Then
        If Not Cache Is Nothing Then
            If Cache.Exists(sN) Then
                sumExpenses = Cache(sN)
                Exit Function
            End If
            Set Cache = Nothing
        End If
    End If
    CacheKey = Key
    Set Cache = CreateObject("Scripting.Dictionary")

    Dim Expenses As Worksheet
    Dim Row As Integer
    Dim Item As String

    Set Expenses = ThisWorkbook.Worksheets("Expenses")

    Row = 1

    While (Not Expenses.Cells(Row, 1) = "")
        If Expenses.Cells(Row, 1).Value > dS And Expenses.Cells(Row, 1).Value < dE Then
            Item = Expenses.Cells(Row, 2).Value
            If Cache.Exists(Item) Then
                Cache(Item) = Cache(Item) + Expenses.Cells(Row, 3).Value
            Else
                Cache.Add Item, Expenses.Cells(Row, 3).Value
            End If
        End If
        Row = Row + 1
    Wend

    If Cache.Exists(sN) Then
        sumExpenses = Cache(sN)
    Else
        sumExpenses = CVErr(xlErrNA)
    End If

End Function

Public Sub resetCache()
    Set Cache = Nothing
    CacheKey = ""
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-17T05:55:02.807

这可能有很多原因。我只是希望 Excel 能告诉我们哪个（或更多）“通常的嫌疑人”此时正在犯下占用 RAM 的罪行。

也找

1.  循环引用

2.  碎片化的条件格式（由剪切、粘贴、排序、删除和添加单元格或行引起。

3.  导致#N/A、#REF、#DIV/0 的错误！ETC，

4.  过度使用 volatile 函数 TODAY()、NOW() 等。

5.  使用了太多不同的格式

... 以该顺序

当你在那里时，检查

6.  断开的链接。依赖于来自外部数据的新值的公式可能会返回错误。

7.  任何包含#REF! 的公式。如果你的公式很乱，这些也可能存在。它们不会导致错误标志，但可能会导致一些未报告的错误。如果您的公式满足较早的条件，则公式部分包含#REF！除非其他条件为准，否则不会进行评估。

# objective-c - 如何在通过 HTTP Live Streaming 播放当前文件时加载下一个文件？

> ID：15329201
> 
> 赞同：2
> 
> 时间：2013-03-10T23:53:57.103
> 
> 标签：objective-c, avfoundation, avplayer, http-live-streaming, avqueueplayer

我正在开发一个应用程序，我需要在其中流式传输大量音频文件，每个文件的时间从 5 到 15 秒不等。我想尽可能减少文件之间的加载时间。

主要问题： **有没有办法在当前文件播放最后一段时开始缓冲下一个文件（通过 HLS）？**

AVQueuePlayer 在 iOS 端是一个合适的解决方案吗？

非常感谢详细的解释，因为我是 HTTP Live Streaming 和 AV Foundation 的新手。

相关问题：广播应用程序如何在歌曲之间没有延迟的情况下流式传输音频？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T14:21:15.237

是的，`AVQueuePlayer`是播放通过 HTTP 协议从 Internet 流式传输的音频序列的合适解决方案。

我现在使用`AVQueuePlayer`了很长一段时间，效果很好，歌曲之间没有滞后。这是一个关于如何使用的简单示例`AVQueuePlayer`：

```
NSURL *url1 = [NSURL URLWithString:[urlsToPlay objectAtIndex:0]];
NSURL *url2 = [NSURL URLWithString:[urlsToPlay objectAtIndex:1]];
NSURL *url3 = [NSURL URLWithString:[urlsToPlay objectAtIndex:2]];

self.item1 = [[AVPlayerItem alloc] initWithURL:url1];
self.item2 = [[AVPlayerItem alloc] initWithURL:url2];
self.item3 = [[AVPlayerItem alloc] initWithURL:url3];

self.radioPlayerURLs = [[NSArray alloc] initWithObjects:self.item1,self.item2, self.item3, nil];
self.onDemandPlayer  = [AVQueuePlayer queuePlayerWithItems:self.radioPlayerURLs];
[self.onDemandPlayer play]; 
```

有关详细信息，请参阅 Apple 文档：

[AV基金会](http://developer.apple.com/library/mac/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/02_Playback.html)

[AV队列播放器](http://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVQueuePlayer_Class/Reference/Reference.html#//apple_ref/occ/cl/AVQueuePlayer)

# jquery - 在 Windows Phone 7 和 8 上，jquery mobile 固定页脚不在底部

> ID：15329209
> 
> 赞同：0
> 
> 时间：2013-03-10T23:55:03.560
> 
> 标签：jquery, windows-phone

我正在将我的应用程序转换为也可以在 Windows Phone 7.x 和 8 上运行（它已经在 iPhone 和 Android 上运行）。

我有这个问题，页脚没有显示在最底部，但位于末端上方一点。正如您在图片上看到的那样：[https ://dl.dropbox.com/u/7685276/Footer%20issue.png](https://dl.dropbox.com/u/7685276/Footer%20issue.png)

你们中的任何人都可以帮忙吗？正如我所说，这在 Android 和 iPhone 上不是问题。

它是 jQuery 1.9.1、jQueryMobile 1.3、PhoneGap 2.4。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T13:07:29.813

您可以在 MainPage.xaml 处重置容器的高度，或者重置所有页面内容 div 的高度“我不知道它的名称”以适应屏幕的高度

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-11T11:45:58.723

像这样设置位置：

```
<div data-role="footer" data-position="fixed" style="position: absolute"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-27T16:35:34.007

您必须更改 windows phone 8 中所有 3 种分辨率的视口宽度

以下代码适用于 HTC windows phone 8x

在您的头部部分包含元标记。

```
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1"> 
```

在您的头部部分包含以下样式

```
@media screen and (min-width: 640px) and (max-width: 1024px) and (orientation:portrait) {
    @-ms-viewport { width: 50%; }        
} 
```

您需要为适用于 windows phone 8 的所有 3 种分辨率编写此内容。您可能必须为更高 DPI 手机减小宽度，为更低 DPI 手机增加宽度。

诺基亚 lumia 920 的视口宽度约为 70-80%，诺基亚 Lumia 820 的视口宽度约为 85-95%。但是您需要找出这两款手机的最小宽度和最大宽度。

# c++ - C++程序输出错误的数字

> ID：15329210
> 
> 赞同：1
> 
> 时间：2013-03-10T23:55:06.910
> 
> 标签：c++, floating-point, double

这是我的程序：

```
 #include "stdafx.h"
 #include <iostream>

 using namespace std;

 double areaofcircle(double r)
 {
 return 3.14 * r * r;
 }

 int main()
 {
 cout << areaofcircle(5);
 } 
```

我应该得到“78.5”的输出，但我一直得到“78.512”。到底是怎么回事？！我也试过浮动，但我仍然得到相同的输出。

也只是一个附带问题，我真的需要添加“return 0;”吗？主要功能？

还有一个问题，我需要写“使用命名空间std；”吗？在每个函数内部，或者我可以在所有内容之外编写它，就像我一直在做的那样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:11:16.893

我认为你做错了什么。我在 GCC 编译器上尝试了同样的方法，我得到了 78.5。您使用的是哪个编译器？

关于你的其他问题

1.  从 main 返回程序的状态总是一个好主意。通常，如果一切正常，您可以返回 EXIT_SUCCESS，否则您可以返回 EXIT_FAILURE。

2.  不，没有必要包含 using namespace std。相反，污染标准命名空间是不好的做法。您应该只包括那些您经常使用的功能。

阅读有关 C++ 的更多信息。检查此[链接](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:37:27.420

在 VS 2008 上尝试了一些实验，看看我是否会得到类似的错误。通过将 pi 更改为浮点数，我确实得到了 78.500002622604370，这与您的问题不同但又不同。但是当 pi 是双倍时，我确实得到 78.5。

我建议您让我们知道您正在使用哪个编译器和版本，然后可能有人可以提供帮助。

```
#include "stdafx.h"
#include <iostream>
const double pi = 3.14;

 double areaofcircle(double r)
 {
    return pi * r * r;
 }

int _tmain(int argc, _TCHAR* argv[])
{
    double temp = areaofcircle(5);
    std::cout << temp;
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T00:39:25.713

您正在传递整数 (5) 的文字，因此需要在某处进行隐式转换才能将其转换为双精度。你最好通过 5.0。双精度的 C++ 默认值不需要说明符，因此您的 3.14 很好。（指定浮点数需要 3.14f）。也就是说，我尝试了 5 和 5.0，并且在我的编译器上都得到了 78.5。

您使用 std 命名空间的方式很好，但正如所指出的那样，它确实将所有标准命名空间纳入范围。我在教材中经常看到这一点。最好只使用 `using std::cout;`

或者只是明确地将 std::cout 添加到所有用途中。但是，从编译的角度来看，您执行此操作的方式没有任何“错误”。

# c++ - 左移的负数*总是*用“1”而不是“0”填充吗？

> ID：15329215
> 
> 赞同：0
> 
> 时间：2013-03-10T23:56:06.363
> 
> 标签：c++, .net, biginteger, bit-shift, twos-complement

我正在通过将一些 C++ 函数移植到 .NET 的 BigInteger 来独立研究位移。我注意到当我移动 BigInteger 时，空白被填充了。

我相信这与以二进制补码形式存储的负数有关。

```
BigInteger num = -126;
compactBitsRepresentation = (uint)(int)(num << 16); 
```

这是移位后发生的事情（首先是最高有效位）

```
10000010 will be shifted 16
11111111100000100000000000000000 was shifted 16 
```

我是否应该总是期望类似的位移操作以这种方式起作用？这是否与 OpenSSL 等“bigNumber”的不同语言和实现一致？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:07:08.943

来自[`BigInteger.LeftShift`运营商文档](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.op_leftshift.aspx)：

> 与整数基元的按位左移操作不同，LeftShift 方法保留原始 BigInteger 值的符号。

所以.NET 保证你看到的行为。

我对 bignum 库不太熟悉，但 OpenSSL 的 BIGNUM BN_lshift() 函数的文档说：

> `BN_lshift()`将 a 左移 n 位并将结果放入 r ("r=a*2^n")。`BN_lshift1()`将 a 左移 1 并将结果放入 r ("r=2*a")。

由于该操作是根据乘以 2 的幂来定义的，如果将生成的 BIGNUM 转换为二进制补码（我不知道 BIGNUM 如何在内部表示数字），那么您将看到与 .NET 类似的行为。

如果其他 bignum 库的行为类似，我不会感到惊讶，但如果你想依赖这种行为，你真的需要检查文档。但是，由于移位与乘以或除以 2 的幂非常相似，因此您可以通过使用适当的乘法或除法而不是移位来获得“可移植”行为。那么您需要确保的就是您可以转换为二进制补码表示（这是一个真正独立于移位操作行为的问题）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:45:17.480

> 我是否应该总是期望类似的位移操作以这种方式起作用？

如果有问题的数字格式使用二进制补码来表示负数（很多都这样做），您应该这样做。为了形成一个数字的二进制补码，您将所有位反转并加一，例如：

```
23 is represented as 00010111
-23 is represented as 11101001 (that is, 11101000 + 1) 
```

此外，当您将一个类型转换为更大的类型时，该值通常是符号扩展的，即最左边的位被扩展为更大类型中的额外位。这保留了数字的符号。

所以是的，数字表示用 1 来“填充”数值是很常见的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T00:00:22.450

首先将 10000010 更改为更大的宽度。在这种情况下，4 个字节：

```
10000010 --> 11111111 11111111 11111111 10000010 
```

因为数字是负数，所以你在左边得到 1。

现在左移只需从右侧插入 0 并从左侧抛出位：

```
11111111 11111111 11111111 10000010 << 16 -->
11111111 10000010 00000000 00000000 
```

# android - Android OpenGLES 2.0 纹理映射不起作用

> ID：15329218
> 
> 赞同：1
> 
> 时间：2013-03-10T23:56:21.467
> 
> 标签：android, graphics, opengl-es-2.0, texture-mapping

我正在尝试纹理贴图一些四边形。我可以用纯色渲染四边形就好了。我一直在关注这个页面： http: [//www.learnopengles.com/android-lesson-four-introducing-basic-texturing/](http://www.learnopengles.com/android-lesson-four-introducing-basic-texturing/)

一切都编译并运行，但纹理根本没有被应用。我的代码和链接的页面之间的唯一区别是我不执行 glBindAttribLocation，并且我使用 glDrawElements 而不是 glDrawArrays。

编辑：将我的顶点和 tex 坐标数据转换为使用 glDrawArrays 并没有解决任何问题。

我所有的着色器句柄似乎都是正确的。问题一定出在我的一张画上。如果有人可以帮我调试这个，那就太好了。我尝试设置 gl_FragColor = vec4(texCoord[0], texCoord[1], 1.0f, 1.0f) 只是为了查看 tex 坐标是否正在进入着色器，但是会崩溃。

顶点数据的初始化：

```
static float squareCoords[] = { -0.5f,  0.5f, 0.0f,   // top left
                                -0.5f, -0.5f, 0.0f,   // bottom left
                                 0.5f, -0.5f, 0.0f,   // bottom right
                                 0.5f,  0.5f, 0.0f }; // top right
static float textureCoords[] = { 0.0f, 1.0f,  // top left
                                 0.0f, 0.0f,  // bottom left
                                 1.0f, 0.0f,  // bottom right
                                 1.0f, 1.0f}; // top right

    // initialize vertex byte buffer for shape coordinates
    ByteBuffer bb = ByteBuffer.allocateDirect(squareCoords.length * 4); // (# of coordinate values * 4 bytes per float)
    bb.order(ByteOrder.nativeOrder());
    vertexBuffer = bb.asFloatBuffer();
    vertexBuffer.put(squareCoords);
    vertexBuffer.position(0);

    ByteBuffer tcbb = ByteBuffer.allocateDirect(textureCoords.length * 4);
    tcbb.order(ByteOrder.nativeOrder());
    texCoordBuffer = tcbb.asFloatBuffer();
    texCoordBuffer.put(textureCoords);
    texCoordBuffer.position(0);

    // initialize byte buffer for the draw list
    ByteBuffer dlb = ByteBuffer.allocateDirect(
    // (# of coordinate values * 2 bytes per short)
            drawOrder.length * 2);
    dlb.order(ByteOrder.nativeOrder());
    drawListBuffer = dlb.asShortBuffer();
    drawListBuffer.put(drawOrder);
    drawListBuffer.position(0); 
```

在我的附加着色器代码中：

```
 // get handle to texture coords
    mTexCoordHandle = GLES20.glGetAttribLocation(mProgram, "texCoord");
    MyGLRenderer.checkGlError("glGetAttribLocation");
    Log.i("TEXCOORD SHADER HANDLE", " " + mTexCoordHandle);

    //get handle to texture
    mTexHandle = GLES20.glGetUniformLocation(mProgram, "u_texture");
    MyGLRenderer.checkGlError("glGetUniformLocation");
    Log.i("TEX SHADER HANDLE", " " + mTexHandle); 
```

在我的主要（粒子引擎）绘图中：

```
 // Enable a handle to the triangle vertices
    GLES20.glEnableVertexAttribArray(mPositionHandle);
    // Prepare the triangle coordinate data
    GLES20.glVertexAttribPointer(mPositionHandle, COORDS_PER_VERTEX,
                                 GLES20.GL_FLOAT, false,
                                 0, vertexBuffer);
    GLES20.glEnableVertexAttribArray(mTexCoordHandle);
    GLES20.glVertexAttribPointer(mTexCoordHandle, TEX_COORDS_PER_VERTEX,
                                 GLES20.GL_FLOAT, false,
                                 0, texCoordBuffer);

    // Set the active texture unit to texture unit 0.
    GLES20.glActiveTexture(GLES20.GL_TEXTURE0);

    // Bind the texture to this unit.
    GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureDataHandle);

    // Tell the texture uniform sampler to use this texture in the shader by binding to texture unit 0.
    GLES20.glUniform1i(mTexHandle, 0);  

    for (int t=0;t<mChildsCount;t++) {
        Particle child = (Particle)mChilds[t];
        child.draw(mVMatrix, mProjMatrix);
    }
    // Disable vertex array
    GLES20.glDisableVertexAttribArray(mPositionHandle);
    GLES20.glDisableVertexAttribArray(mTexCoordHandle); 
```

在单个粒子中绘制：

```
//... calculate model-view-projection matrix, send to shader
GLES20.glDrawElements(GLES20.GL_TRIANGLES, mPEngine.drawOrder.length,
                          GLES20.GL_UNSIGNED_SHORT, mPEngine.drawListBuffer); 
```

在我的加载纹理中：

```
public static int loadTexture(final Context context, final int resourceId)
{
    final int[] textureHandle = new int[1];

    GLES20.glGenTextures(1, textureHandle, 0);

    if (textureHandle[0] != 0)
    {
        final BitmapFactory.Options options = new BitmapFactory.Options();
        options.inScaled = false;   // No pre-scaling

        // Read in the resource
        final Bitmap bitmap = BitmapFactory.decodeResource(context.getResources(), resourceId, options);
        if (bitmap == null) {
            throw new RuntimeException("Error decoding bitmap");
        }
        // Bind to the texture in OpenGL
        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureHandle[0]);

        // Set filtering
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST);
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_NEAREST);

        // Load the bitmap into the bound texture.
        GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, 0, bitmap, 0);

        // Recycle the bitmap, since its data has been loaded into OpenGL.
        bitmap.recycle();
    }

    if (textureHandle[0] == 0)
    {
        throw new RuntimeException("Error loading texture.");
    }

    return textureHandle[0];
} 
```

在我的着色器中：

```
private final String vertexShaderCode =
// This matrix member variable provides a hook to manipulate
// the coordinates of the objects that use this vertex shader
    "uniform mat4 uMVPMatrix;" +
    "attribute vec4 vPosition;" +
    "attribute vec2 texCoord;" +
    "varying vec2 texCoordOut;" +
    "void main() {" +
    // the matrix must be included as a modifier of gl_Position
    "  texCoordOut = texCoord; \n" +
    "  gl_Position = uMVPMatrix * vPosition; \n" +
    "}";

private final String fragmentShaderCode =
    "precision mediump float;" +
    "varying vec2 texCoordOut;" +
    "uniform sampler2D u_texture;" +
    "void main() {" +
    " vec4 texColor = texture2D(u_texture, texCoordOut);\n" +
    "  gl_FragColor = texColor;" +
    "}"; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T00:12:51.747

已解决： [Android OpenGL2.0 显示黑色纹理](https://stackoverflow.com/questions/8688980/android-opengl2-0-showing-black-textures?rq=1)

需要向 LOAD_TEXTURE 添加 2 行： `GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_S, GLES20.GL_CLAMP_TO_EDGE); GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_T, GLES20.GL_CLAMP_TO_EDGE);`

事实证明，如果您的纹理大小不是 2 的幂，则这是必需的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-01T02:29:00.750

对于来到这里的 iOS 方面的任何人，此处提供的其他答案也适用。唯一的区别是命令是这样的：

```
 glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE); 
```

此外，请确保启用过滤：

```
 glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST); 
```

我认为这在 2D 中不太实用，但你需要它们

# mysql - 左加入 ON 条件并选择条件差异

> ID：15329220
> 
> 赞同：0
> 
> 时间：2013-03-10T23:56:23.763
> 
> 标签：mysql, sql, join, view

我有三张桌子 {animal, food, animal_food}

```
DROP   TABLE IF EXISTS `tbl_animal`; 
CREATE TABLE `tbl_animal` (
    id_animal       INTEGER     NOT NULL PRIMARY KEY AUTO_INCREMENT,
    name            VARCHAR(25) NOT NULL DEFAULT "no name",
    sex             CHAR(1)     NOT NULL DEFAULT "M",
    size            VARCHAR(10) NOT NULL DEFAULT "Mini",
    age             VARCHAR(10) NOT NULL DEFAULT "born",
    hair            VARCHAR(5 ) NOT NULL DEFAULT "short",
    color           VARCHAR(25) NOT NULL DEFAULT "not defined",
    FOREIGN KEY (sex)           REFERENCES `tbl_sexes`    (sex),
    FOREIGN KEY (tamanio)       REFERENCES `tbl_sizes`    (size),
    FOREIGN KEY (age)           REFERENCES `tbl_ages`     (age),
    FOREIGN KEY (hair)          REFERENCES `tbl_hair_length` (hair_length),
    CONSTRAINT `uc_Info_Animal` UNIQUE (`id_animal`)           
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;

DROP    TABLE IF EXISTS `tbl_food`; 
CREATE TABLE `tbl_food` (
    id_food       INTEGER       NOT NULL PRIMARY KEY,
    type_food     VARCHAR(20)   NOT NULL DEFAULT "Other",
    label         VARCHAR(50)   NOT NULL,
    CONSTRAINT `uc_Info_Food`   UNIQUE  (`id_food`)     
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;

DROP    TABLE IF EXISTS `animal_food`; 
CREATE  TABLE `animal_food` (
    id_animal       INTEGER     NOT NULL,
    food            VARCHAR(50) NOT NULL DEFAULT "",
    quantity        VARCHAR(50) NOT NULL DEFAULT "",        
    times           VARCHAR(50) NOT NULL DEFAULT "",
    description     VARCHAR(50) NOT NULL DEFAULT "",            
    date_last   DATE DEFAULT '0000-00-00 00:00:00',     
    date_water      DATE DEFAULT '0000-00-00 00:00:00',
    CONSTRAINT fk_ID_Animal_Food FOREIGN KEY (id_animal) REFERENCES `tbl_animal`(id_animal)  
) ENGINE=InnoDB  DEFAULT CHARSET=utf8; 
```

我有一个视图，我根据 ID 选择 animal 和 animal_food 中的值列

```
CREATE VIEW `CAT_animal_food` AS
       SELECT a.name, a.sex,a.size,a.age,a.hair,a.color,
              a_f.*  
       FROM  `tbl_animal` a, `animal_food` a_f
       WHERE a.id_animal = a_f.id_animal; 
```

创建一个像上面这样的视图或者加入这些动物和动物食物表会更好吗？

```
SELECT ...
  FROM A.table t1
  JOIN B.table2 t2 ON t2.column = t1.col 
```

例如，这种视图和左连接之间的真正区别是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:07:46.197

`SELECT`两个语句之间的唯一区别是语法风格。两者都执行**INNER JOINS**。换句话说，这种风格使用了所谓的“隐式”语法：

```
SELECT ...
  FROM A.table t1, B.table2 t2
  WHERE t2.column = t1.col 
```

它是“隐含的”，因为该`WHERE`子句隐含了连接条件。此版本使用“显式”语法：

```
SELECT ...
  FROM A.table t1
  JOIN B.table2 t2 ON t2.column = t1.col 
```

大多数人更喜欢看到“显式”语法，因为它使您的代码更易于遵循；连接条件是明确理解的，任何`WHERE`子句都是显而易见的。

当然，这些都与此无关`LEFT JOINS`。 [这是一个著名的链接](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)，对连接类型进行了很好的视觉描述。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-11T00:14:09.043

有一个很大的不同。

使用表列表的老式风格只允许*内部*连接。

此外，在正确连接的 ON 子句中放置非关键条件可以提供更高的性能和功能，而 where 子句无法提供。这样做的主要原因是在进行连接时会评估 ON 子句，但在进行所有连接后才评估 WHERE 子句。

这个主题太复杂了，无法在这里做到公正。

# clojure - 试图让 leiningen 用户配置文件运行 clojure-1.5.0

> ID：15329222
> 
> 赞同：3
> 
> 时间：2013-03-10T23:56:26.567
> 
> 标签：clojure, leiningen

我已经安装了 clojure-1.4.0 和 clojure-1.5.0 并且工作正常。在我的各种 project.clj 文件中，我可以将一个或另一个设置为依赖项，并且 leiningen 会正确选择指定的版本。当我不在项目目录中时，`lein repl`总是运行 clojure-1.4.0。我试图通过将以下内容`profiles.clj`放在我的`~/.lein`目录中来更改默认值：

```
{:user {:dependencies ^:replace [[org.clojure/clojure "1.5.0"]]
        :plugins                [[lein-pprint "1.1.1"]]}} 
```

但是`lein repl`，当不在项目目录中时，仍然运行 clojure-1.4.0，如果我碰巧`lein repl`在`~/.lein`目录中运行，则会出现看似不正确的错误消息：

```
WARNING: user-level profile defined in project files. 
```

我知道我的 project.clj 文件中没有用户配置文件，因为以下命令不打印任何内容

```
find ~ -name project.clj -exec grep ":user" "{}" ';' -print 2> /dev/null 
```

我知道 leiningen 正在读取我的 profiles.clj 文件，因为如果我在文件中故意放置语法错误，我会得到预期的编译器异常。

我已经阅读`lein help profiles`但不能完全弄清楚我做错了什么。

提示，请&谢谢？

# python - 将文件复制到附加其原始前导目录的目录中

> ID：15329223
> 
> 赞同：2
> 
> 时间：2013-03-10T23:56:28.777
> 
> 标签：python, python-3.x, copy, shutil

我想知道python是否提供了一种规范的方法来将文件复制到附加了原始前导目录的目录中，就像这样`cp --parents`做一样。从`cp`手册页：

```
`--parents'
[...]
     cp --parents a/b/c existing_dir

 copies the file `a/b/c' to `existing_dir/a/b/c', creating any
 missing intermediate directories. 
```

`shutil`我在文档中没有看到任何与此相关的内容。当然，我可以`existing_dir`在将任何文件复制到目录之前在目录中创建整个目录结构，但这样做可能会产生开销。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:01:19.483

我终于想出了以下代码。它的作用几乎完全一样`cp --parents`。

```
import os, shutil

def cp_parents(target_dir, files):
    dirs = []
    for file in files:
        dirs.append(os.path.dirname(file))
    dirs.sort(reverse=True)
    for i in range(len(dirs)):
        if not dirs[i] in dirs[i-1]:
            need_dir = os.path.normpath(target_dir + dirs[i])
            print("Creating", need_dir )
            os.makedirs(need_dir)
    for file in files:
        dest = os.path.normpath(target_dir + file)
        print("Copying %s to %s" % (file, dest))
        shutil.copy(file, dest) 
```

像这样称呼它：

```
target_dir = '/tmp/dummy'
files = [ '/tmp/dir/file1', '/tmp/dir/subdir/file2', '/tmp/file3' ]

cp_parents(target_dir, files) 
```

输出是：

```
Creating /tmp/dummy/tmp/dir/subdir
Copying /tmp/dir/file1 to /tmp/dummy/tmp/dir/file1
Copying /tmp/dir/subdir/file2 to /tmp/dummy/tmp/dir/subdir/file2
Copying /tmp/file3 to /tmp/dummy/tmp/file3 
```

可能有更好的方法来处理这个问题，但它确实有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T00:28:07.093

不确定您的具体要求，但听起来`shutil.copytree`适合您。[您可以在此处](http://docs.python.org/3/library/shutil.html)查看完整的文档，但基本上您在示例中需要调用的内容类似于

```
shutil.copytree( 'a/b/c', 'existing_dir/a/b/c' ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-02T17:01:59.907

```
import os
import shutil

files = [ '/usr/bin/ls','/etc/passwd' , '/var/log/daily.out' , '/var/log/system.log' , '/var/log/asl/StoreData' ]

def copy_structure(dst_dir,source_files):
    if not os.path.exists(dst_dir) and os.path.isdir(dst_dir):
        os.mkdir(dst_dir)
    for file in source_files:
        dir_name = os.path.dirname(file)
        final_dir_path = os.path.normpath(dst_dir+dir_name)
        if not os.path.exists(final_dir_path):
            os.makedirs(final_dir_path)            
        if os.path.exists(file): 
            shutil.copy(file,final_dir_path)

copy_structure('/tmp/backup',files) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-21T20:15:04.383

只有 3.6 或更高版本（它使用 f 函数）

这是我对 cp --parents 的实现

首先获取获取 src 目录和文件名的偏移量，以及目录偏移量（有时我想省略 src 文件的第一个文件夹）

然后它提取文件夹和文件名（检查 src_dirs 是因为我注意到当 src 文件没有嵌套在任何文件夹中时它崩溃了）

最后，它在目标文件夹中创建目录树并将文件复制到其中

```
def __copy_parents(src, dest_folder, dir_offset=0):
    ''' Copies src tree into dest, offset (optional) omits n folders of the src path'''
    prev_offset = 0 if dir_offset == 0 else src.replace('/', '%', dir_offset - 1).find('/') + 1
    post_offset = src.rfind('/')

    src_dirs = '' if post_offset == -1 else src[prev_offset:post_offset]
    src_filename = src[post_offset + 1:]

    os.makedirs(f'{dest_folder}/{src_dirs}', exist_ok=True)
    shutil.copy(src, f'{dest_folder}/{src_dirs}/{src_filename}') 
```

# php - PDO 连接抛出超时错误

> ID：15329225
> 
> 赞同：-3
> 
> 时间：2013-03-10T23:56:39.470
> 
> 标签：php, pdo, include

我的 PDO 连接超时有问题，它不是在一个循环中（这是我唯一一次看到超时）只是一个标准连接，然后我稍后在循环中运行它。它给出的错误是：

```
Fatal error: Maximum execution time of 30 seconds exceeded in Connect.php on line 9 
```

这是connect.php ![连接](../Images/d05c879b7fd2b05268f3e1dca9b4a241.png)

这本质上是我包含它的地方 ![包括](../Images/1dc5c1c94fd1dccd6419004e1678cf6c.png)

我也尝试过一次要求，并`print_r`打印：

```
PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) PDO Object ( ) 
Fatal error: Maximum execution time of 30 seconds exceeded in Connect.php on line 9 
```

所以显然存在某种连接，并且显然包含携带变量。此外，我在其他 php 文件中使用了此代码，并且运行良好。从所提供的信息中有什么想法吗？

第 9 行`$conn`是设置的位置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:08:10.393

[从评论扩展] 由于您`print_r()`正下方的`include`运行多次，因此表明整个文件/代码块正在从代码更高的循环中运行多次。您可以尝试执行`dump_backtrace()`并查看代码的实际来源。

超时似乎发生在`connect.php`因为您使用`include`not `include_once`，因此每次循环代码运行时也会重新处理该文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T00:03:04.490

为什么你一遍又一遍地执行相同的查询。你不想做类似的事情：

```
$stmt = $conn->query($your_query);
while(($result = $stmt->fetch()) !== false){
  // do something
} 
```

反而？

# wpf - 如何将 XAML 椭圆用作另一个形状的容器？

> ID：15329230
> 
> 赞同：2
> 
> 时间：2013-03-10T23:56:47.577
> 
> 标签：wpf, xaml, animation

我正在 WPF 中创建一个 UserControl 来模拟眼睛（如卡通眼睛），并将在眼睛内移动“瞳孔”（黑色圆圈）以朝某些方向看。我想使用眼睛的“白色”部分作为眼睛“黑色”部分的容器，这样黑色椭圆会在到达眼睛边缘时被剪掉，而不会只是漂浮在白色椭圆之外。

如何在 WPF/XAML 中执行此操作？

![WPF 眼睛](../Images/012be2a537717388a5fc0008bd0f2973.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T00:22:28.557

您可以使用`Border`一个大`CornerRadius`的作为眼睛的外部部分并在其上创建一个`OpacityMask`以`Border`确保内眼被夹到`Border`

快速示例：

```
<Window x:Class="WpfApplication9.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="121" Width="278" Name="UI">

    <Grid Background="DarkGray" ClipToBounds="True">
        <Border x:Name="opacityMask" CornerRadius="1000" Background="White" />
        <Border CornerRadius="1000" Background="White" >
            <Ellipse  Width="50" Height="50" Fill="Black"/>
            <Border.OpacityMask>
                <VisualBrush Visual="{Binding ElementName=opacityMask}" />
            </Border.OpacityMask>
        </Border>
    </Grid>
</Window> 
```

结果：

![在此处输入图像描述](../Images/59218f3d661c09808a612e216bce8751.png) ![在此处输入图像描述](../Images/ff02febfd45277198e1c4a0bb25d0896.png)

# c++ - 标准::线程 C++。更多线程相同的数据

> ID：15329234
> 
> 赞同：6
> 
> 时间：2013-03-10T23:57:46.157
> 
> 标签：c++, multithreading, c++11, heap-memory, std

我正在使用 Visual Studio 2012 和 C++11。我不明白为什么这不起作用：

```
void client_loop(bool &run)
{
    while ( run );
}

int main()
{
    bool running = true;
    std::thread t(&client_loop,std::ref(running));

    running = false ;
    t.join();
} 
```

在这种情况下，线程循环`t`永远不会结束，但我明确设置`running`为`false`. `run`并且`running`有相同的位置。我试图设置`running`为单个全局变量，但没有任何反应。我也尝试传递一个指针值，但什么也没有。

线程使用相同的堆。我真的不明白。谁能帮我？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-11T00:11:35.150

您的程序具有**Undefined Behavior**，因为它在`running`变量上引入了数据竞争（一个线程写入它，另一个线程读取它）。

您应该使用互斥锁来同步访问，或者`running`进行`atomic<bool>`：

```
#include <iostream>
#include <thread>
#include <atomic>

void client_loop(std::atomic<bool> const& run)
{
    while (run.load());
}

int main()
{
    std::atomic<bool> running(true);
    std::thread t(&client_loop,std::ref(running));

    running = false ;
    t.join();

    std::cout << "Arrived";
} 
```

看一个[实际工作的例子](http://liveworkspace.org/code/4yc7Hy%242280)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:47:11.040

`const`可能不会影响编译器对代码的看法。在单线程应用程序中，该值不会改变（并且这个特定程序毫无意义）。在多线程应用程序中，由于它是原子类型，编译器无法优化负载，所以实际上这里没有真正的问题。这实际上更多是风格问题。由于`main`修改了值并`client_loop`查找该修改，因此我认为该值是`const`.

# joomla - 在 Joomla 中创建已发布的下拉菜单

> ID：15329241
> 
> 赞同：0
> 
> 时间：2013-03-10T23:59:07.577
> 
> 标签：joomla, joomla2.5

```
<field
    name="published"
    type="list"
    label="JSTATUS"
    description="JFIELD_PUBLISHED_DESC"
    class="inputbox"
    filter="intval"
    size="1"
    default="1"
>
    <option value="1">
        JPUBLISHED</option>
    <option value="0">
        JUNPUBLISHED</option>
    <option value="-2">
        JTRASHED</option>
</field> 
```

我在自定义组件的 form.xml 文件中创建了一个 Joomla 下拉列表，以选择项目的发布状态。我毫不掩饰地从 Joomla`com_content`组件中获取了此代码（并将其复制并粘贴到我自己的`form.xml`文件中。但是当它呈现在`edit.php`文件中时（如下所示），您可以看到该项目被设置为未发布。尽管上面的代码明确将默认值设置为 1，这应该对应于已发布。关于为什么/如何解决此问题的任何好主意。我可以轻松地将下拉列表从未发布更改为已发布 - 这样做效果很好。但这只是烦人和我想修复的错误。有什么想法吗？

![这显示了默认情况下未发布的模块](../Images/6391c1e3d0537ad573552be5fd71b238.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T03:19:33.010

尝试查看您的代码是否有任何覆盖，因为这是由 com_content 组件采用的，在设置所有必填字段之前它不会设置为默认值，请仔细检查是否有任何 JS 脚本或 PHP 函数中断您的字段正常行为。

我的另一个想法是翻译可能有问题，所以仔细查看翻译文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T08:42:56.290

您是否使用像 com_content 这样的表/模型方法？如果是这样，当记录不存在时，其字段将设置为默认值（从数据库中读取，因此 int 字段将默认为 0）。

你可以

*   在数据库中设置正确的默认值，
*   检查它们在模型中的值，
*   将 JPUBLISHED 更改为 0 并将 JUNPUBLISHED 更改为 517

虽然后者看起来真的很丑。

# java - 使用 Java 在远程机器上运行命令行

> ID：15329244
> 
> 赞同：0
> 
> 时间：2013-03-10T23:59:28.770
> 
> 标签：java, command-line, runtime.exec

是否可以在远程机器上运行命令行（而不是在托管应用程序的服务器机器上）。

我知道`Runtime.getRuntime().exec("..");`会尝试在服务器机器上运行脚本。我的理解是否正确，有没有办法实现我的需要？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T00:03:18.130

`Runtime.getRuntime().exec`在*本地*机器上启动一个*进程*，而不是远程的。该进程是否代表命令行界面将由运行的可执行文件和底层平台确定。

 *为了在远程机器上调用进程，您需要：

*   调用远程类型命令，如 rsh 或 ssh
*   利用远程第三方库，如[Jsch](http://www.jcraft.com/jsch/)*

# proxy - 现场找ip？

> ID：15329248
> 
> 赞同：0
> 
> 时间：2013-03-11T00:00:13.947
> 
> 标签：proxy

嗨，我想从网上获取一个代理列表并搜索它以找到有效的代理号码和端口。我的问题是当我抓取该网站时，我如何通过它进行搜索，它只识别 ips 和 poorts 并破坏其余部分？到目前为止我所做的一切都在工作，我如何只识别代理号码而不识别其他任何东西？很抱歉，任何帮助将不胜感激，但我是新手:)

```
package proxytester;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.MalformedURLException;
import java.net.URL;

public class ProxyTester{

    public static void main(String[] args) {

try{
    URL grab = new URL("http://www.example.com");
    BufferedReader in = new BufferedReader(
    new InputStreamReader(grab.openStream()));
    String input;
    while ((input = in.readLine()) != null) {
    if(input.charAt(0)=='n'){// the site starts its proxy list with name but this line throws an error
        System.out.println(input);
    }else if(input.charAt(0)== ' '){
        System.out.println("empty");  
    }else
        continue;
    }
    in.close();           
}catch(MalformedURLException aa){
    System.out.println("site error");
}catch (IOException e) {
    System.out.println("io error");
}

    }//end main

}//end main 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:17:52.053

我建议使用正则表达式来查找 IP 地址和端口。这是一个需要的正则表达式：[java regex 匹配 ip 地址和端口号作为捕获的组](https://stackoverflow.com/questions/2908740/java-regex-matching-ip-address-and-port-number-as-captured-groups) 本文解释了如何在 java 中使用正则表达式：[http ://www.mkyong.com/regular-expressions/how-to-validate -ip-address-with-regular-expression/](http://www.mkyong.com/regular-expressions/how-to-validate-ip-address-with-regular-expression/)

# java - java中的空白窗口

> ID：15329250
> 
> 赞同：1
> 
> 时间：2013-03-11T00:00:25.477
> 
> 标签：java, window, trigonometry

我正在编写一个可以在创建的窗口上绘制函数的 java 程序。一切正常，直到我开始弄乱余弦/正弦。我的程序可以编译，但由于某种原因，当我运行它时会出现一个空白窗口。在给定 x 值的情况下，它应该显示带有余弦图的 x 和 y 轴。我整天都在尝试东西，无法弄清楚我的逻辑错误是我的代码。

这是我的代码：

```
import java.util.Scanner;
import javax.swing.JFrame;
import javax.swing.*;
import java.awt.*;
import java.lang.Math;
import java.awt.geom.*;

class PlotGraph extends JFrame{

public void paintComponent(Graphics g){
    Graphics2D g2 = (Graphics2D) g;

    g.drawLine(50, 300, 550, 300); //x axis
    g.drawLine(300, 550, 300, 50); //y axis
    //Orignin x = 300 y = 300

    double xmin, xmax;
    double y;
    xmin =(0);
    xmax = 100;
    double x = xmin;

    double form = Math.cos(x);

    double last_y = 300-(form);

    for (x = xmin+1; x<=xmax; x++){
    double newForm = Math.cos(x);
    y = 300-(newForm);
    g2.draw(new Line2D.Double(x-1+(300), last_y, x+300, y));
    last_y = y;

    }

}

public static void main(String [] args) {

    PlotGraph graph = new PlotGraph();
    graph.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    graph.setSize(600, 600);
    graph.setVisible(true); 
    graph.setTitle("PlotGraph");
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:08:33.427

`JFrame`不是的子类，`JComponent`因此不会覆盖该`paintComponent`方法，因此该方法永远不会被调用。

这就是为什么建议添加`@Override`注释以让编译器执行必要的方法检查的原因。您需要将此功能移动到子类中，`JComponent`不要忘记调用`super.paintComponent(g)`.

*   [定制绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/index.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T00:09:24.880

您没有将要绘制的组件添加到`JFrame`. 您需要做的是让您的`PlotGraph`类扩展`JComponent`，或作为子类的类`JComponent`（`JPanel`或`JContainer`评论中的建议），然后将 的对象添加`PlotGraph`到`JFrame`.

例如：

```
public static void main(String args[]) {

    JFrame frame = new JFrame();
    PlotGraph graph = new PlotGraph();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(600, 600);
    frame.add(graph);
    frame.setVisible(true); 
    frame.setTitle("PlotGraph");
} 
```

您的`PlotGraph`课程应该扩展`JComponent`而不是`JFrame`：

```
class PlotGraph extends JComponent 
```

正如 Legend 所提到的，如果您愿意，您可以扩展您的课程`JPanel`或`JContainer`获得更多功能。

# php - 仅向某些浏览器显示特定格式

> ID：15329253
> 
> 赞同：1
> 
> 时间：2013-03-11T00:00:55.127
> 
> 标签：php, html, audio, browser-detection

我的实验大约进行了 6/10 步。

现在这是一个两部分的问题：

为什么在 chrome mp3 中的 android 4.03 上有效，但在 android 4.04 股票浏览器中却没有？那么什么格式有效呢？

如何为一个而不是另一个浏览器检测生成某个文件，然后是 php“IF”语句？

这是我当前的代码：

```
$dir = '../sound/'; 
$scan = scandir($dir);
$size = sizeof($scan);
$random = rand(1, $size);
$randomFile = $scan[$random];
$fileLocation = $dir. $randomFile;
$explode = explode(".", $randomFile);
$extension = $explode[1]; 
```

这就是我在 html5 音频播放器中显示它的方式：

```
<audio controls>
<source src="<?php echo $fileLocation; ?>"  
type="audio/<?php echo $extension; ?>">
</audio> 
```

那么我怎么说搜索某些浏览器的随机文件 mp3 而不是注入播放器然后搜索 ogg 或我需要的任何其他格式并将其注入同一个播放器但仅适用于某些浏览器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:10:18.470

您根本不需要进行任何浏览器嗅探。为音频提供尽可能多的来源，浏览器[会选择它可以使用的](http://www.w3.org/html/wg/drafts/html/master/embedded-content-0.html#the-source-element "<source> 的 HTML5 规范")来源。

```
<audio controls>
    <source src="<?php echo $fileLocation; ?>.mp3" type="audio/mp3">
    <source src="<?php echo $fileLocation; ?>.ogg" type="audio/ogg">
</audio> 
```

# c++ - 如果我有 X 的素数分解，如何有效地获得 X 的所有除数？

> ID：15329256
> 
> 赞同：1
> 
> 时间：2013-03-11T00:01:31.953
> 
> 标签：c++, python, algorithm, primes, prime-factoring

所以我有用于素数分解和除数获取的算法（很容易在网上搜索），但我不知道如何扩展它以在一个范围内找到这些除数。例如 23 到 49 之间的 100 的所有除数（任意）。但也有一些有效的东西，所以我可以将它扩展到更大范围内的大数字。起初我在考虑使用一个范围大小的数组，然后使用所有素数 <= 上限来筛选该数组中的所有元素以返回一个最终的除数列表，但对于大范围，这也是内存密集型。

有没有一种简单的方法可以直接生成除数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:13:14.107

让`n[i]`成为你的数字的第 i 个`x`因子`i`< `m`。`j`对于任何大于 1 且小于的整数，所有的位`2^m`的乘积是的除数。`n[j[r]]``j[r]``r-th``j``x`

考虑 105。它的因数是`[3, 5, 7]`。所以 3 因子，2^3 是 8：

```
 0  000                = 1
 1  001              7 = 7
 2  010          5     = 5
 3  011          5 * 7 = 35
 4  100      3         = 3
 5  101      3   *   7 = 21
 6  110      3 * 5     = 15
 7  111      3 * 5 * 7 = 105 
```

看？105 的所有可能除数（0 和 7 有点可疑）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T00:54:54.130

由于 Malvolio 正在（间接）进行，如果你想在一个范围内找到因子，我个人不会发现素数分解的用途，我会从 int t = (int)(sqrt(n)) 开始，然后递减直到
1\. t 是一个因素
2\. 完整的 util t 或 t/n 范围已达到（一个标志），然后（两者）已离开该范围

或者，如果您的范围相对较小，请检查这些值本身。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-11T03:15:59.623

如果您知道*n的因数，则可以通过取**n*的因数的幂集的乘积来计算*n*的除数——包括 1 和*n*在内的那些数，它们均分*n*：

 *```
function divisors(n)
    divs := [1]
    for fact in factors(n)
        temp := []
        for div in divs
            if fact * div not in divs
                append fact * div to temp
        divs := divs + temp
    return divs 
```

获得完整的除数列表后，您可以仅选择所需范围内的除数。*

# jquery - 如何使用 jquery 使 twitter 引导单选按钮无法选择

> ID：15329257
> 
> 赞同：0
> 
> 时间：2013-03-11T00:01:31.913
> 
> 标签：jquery, twitter-bootstrap, radio-button

我有一个单选按钮组，如下所示：

```
<div class="btn-group" data-toggle="buttons-radio">
    <a href="#1" class="btn btn-primary btn-andares" data-toggle="tab">1º Andar</a>             
    <a href="#2" class="btn btn-primary btn-andares active" data-toggle="tab">2º Andar</a>                  
    <a href="#3" class="btn btn-primary btn-andares" data-toggle="tab">3º Andar</a>                 
</div> 
```

当我单击任何按钮时，将为我显示当前图像。问题是，当我单击一个已经切换的按钮时，会重新加载当前图像。如何禁用或阻止用户单击已选择的按钮？

我试着用这个：

```
$('.btn-andares').click(function(e) {
        if($(this).is(':checked')) {
            alert("already checked");
        }
    }); 
```

但它不起作用..我还能做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:08:51.463

返回假：

```
$('btn-group').on('click', '.btn-andares', function(e) {
    return !$(this).hasClass('active');
}); 
```

# facebook-ios-sdk - forge.facebook.authorize 返回不正确的 Facebook 令牌到期时间

> ID：15329269
> 
> 赞同：0
> 
> 时间：2013-03-11T00:03:25.967
> 
> 标签：facebook-ios-sdk, facebook-android-sdk, trigger.io, parse-platform

我已经`forge.facebook.authorize()`在我的应用程序中成功使用了几个月来获取 FB auth 令牌。

然而，自从上周某个时间点以来，由于到期时间不正确，我一直无法验证它返回的任何令牌，因此此后无法注册或登录任何 Facebook 用户。

**我必须明确我的代码没有改变**——这个 FB 登录之前工作正常，然后突然停止，之后就没有了。已部署的实时应用程序突然停止让用户使用 Facebook 登录。

来自 forge.facebook.authorize 的回复：

```
[FORGE] '"successfully authorized with FB", 

{"access_token":"....","access_expires":1367922592459}' 
```

然后，我使用此函数将到期秒数转换为 JS 日期对象：

```
function toDateTime(secs) {
    var t = new Date();
    t.setSeconds(secs * -1);
    return t;
}

toDateTime(1367922592459);
> Sun Jun 11 -41335 12:22:41 GMT+0100 (BST) 
```

看到这里，这一年正在展示一些疯狂的东西，绝对是在 Facebook 被发明之前。

所以无论如何，然后我的代码将 FB 身份验证数据传递给 Parse.com 以登录用户，而 Parse.com 显然将其返回为具有无效的到期时间。

该问题出现在使用 trigger.io v1.4.29 和 v1.4.33 构建的 iOS 和 Android 应用程序上

注意：我的网页 ( [http://wewana.com/](http://wewana.com/) ) 上有一个有效的 FB javascript 登录名，它连接到同一个 Facebook 应用程序和同一个 Parse.com 应用程序。此页面没有任何问题，因此 FB 应用程序似乎很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:07:09.083

```
t.setSeconds(secs * -1); 
```

你是故意乘以`-1`吗？我不明白为什么可以预期这会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:02:46.113

```
var d = new Date(1367922592459); 
```

就这样，简单易行。

（由于 JavaScript 以毫秒为单位处理 Date，因此无需做`/1000`任何事情。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:51:21.677

tldr; 我错误地将过期时间戳处理为秒。以毫秒为单位处理它们可以解决问题。显然有问题`toDateTime()`

完整版：一段时间以来，parse.com 一直在接受无效的 FB 到期日期。当用户登录正常时，​​我们不知道有问题。最近 parse 更改了一些内容，因此它们在无效日期上出错，导致我们的登录中断。

我们将秒转换为 JS 日期对象的函数需要更改为基于毫秒的转换。

新的工作功能：

```
function toDateTime(secs) {
    var t = new Date(0);
    t.setUTCSeconds(secs / 1000);
    return t;
} 
```

# google-chrome-extension - 如何获取添加的书签文件夹的 ID？

> ID：15329271
> 
> 赞同：1
> 
> 时间：2013-03-11T00:03:37.127
> 
> 标签：google-chrome-extension, bookmarks

在 的[文档中`chrome.bookmarks`](https://developer.chrome.com/extensions/bookmarks.html)，有一个如何使用它的示例。在示例中，它为扩展创建了一个单独的文件夹：

```
chrome.bookmarks.create({'parentId': bookmarkBar.id,
                         'title': 'Extension bookmarks'},
                        function(newFolder) {
                            console.log("added folder: " + newFolder.title);
                        }); 
```

然后在该文件夹中添加一个书签：

```
chrome.bookmarks.create({'parentId': extensionsFolderId,
                         'title': 'Extensions doc',
                         'url': 'http://code.google.com/chrome/extensions'}); 
```

我的问题是：

你如何获得`extensionsFolderId`参数`parentId`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-11-12T14:14:49.790

定义的回调函数`function(newFolder)`在“扩展书签”文件夹创建后调用。有关创建的文件夹/书签的信息，例如`id`和`title`，可在由`BookmarkTreeNode`标识的中找到`newFolder`。

```
function(newFolder) {
    console.log("added folder: " + newFolder.title + " with id: " + newFolder.id);
} 
```

由于`create()`是异步调用，因此您无法确定何时完成。您不想在创建文件夹之前创建书签，因此从第一个的回调函数中调用第二个。

```
chrome.bookmarks.create({'parentId': bookmarkBar.id,
                         'title': 'Extension bookmarks'},
                        function(newFolder) {
                            console.log("added folder: " + newFolder.title);
                            createBookmark(newFolder.id);
                        });

function createBookmark(extensionsFolderId) {
    chrome.bookmarks.create({'parentId': extensionsFolderId,
                             'title': 'Extensions doc',
                             'url': 'http://code.google.com/chrome/extensions'});
} 
```

# javascript - 构建一个页面间有动画的“单页”网站

> ID：15329277
> 
> 赞同：1
> 
> 时间：2013-03-11T00:04:19.550
> 
> 标签：javascript, jquery, slide, jquery-effects

我很想知道用什么来产生这样的效果，比如这个网站模板：[http ://www.templatemonster.com/demo/43491.html](http://www.templatemonster.com/demo/43491.html)

我希望有一个菜单和背景，而一旦我单击菜单链接，它就会触发新页面滑入视图，而不会被重定向到新页面，从而导致浏览器重新加载新页面等。一些流畅而漂亮的东西。

我不是在寻找代码（除了要使用的函数（如果是 JQuery）），我应该寻找什么效果来使这成为可能？

只需指出我正确的方向:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:52:46.283

有很多方法可以实现您的愿望，但这是我关于如何从概念上实现它的建议：

1.  通过为内容容器**设置动画来为内容设置动画`position`**，这应该会给您的页面带来流畅的感觉。[jQuery 文档](http://api.jquery.com/animate/)应该对此非常清楚。请记住，您要拦截锚点的正常行为，所以要么 要么 要么[`preventDefault()`](http://api.jquery.com/event.preventDefault/)两者`return false`兼而有之。

2.  **使用[AJAX 请求](http://api.jquery.com/jQuery.ajax/)**获取您的内容。您可以使用`href`放在链接中的属性来获取正确的内容。然后使用方法将事件绑定到该`<a>`元素[`.on()`](http://api.jquery.com/on/)。你离开的原因`href`是有一个优雅的后备：如果代码出现问题，如果用户禁用了 javascript，或者只是在非 javascript 友好的浏览器上导航，他仍然可以访问你的内容。

这是实现您所寻找的两个基本步骤。如果您想进一步微调您的网站，请尝试考虑这些事情：

1.  **通过谨慎使用 loading**让您的网站看起来更具响应**`.gif`性。**

***   **不重复服务内容：**检查用户是否点击了当前显示页面的链接，不再获取内容；除了对您的用户来说看起来很愚蠢之外，它还会造成无用的服务器负载（可能微不足道，但仍然如此）。不过，请始终考虑您的用户！告诉他，巧妙地使用 UI 禁用了该链接。

    *   **操纵浏览器历史记录：**使用[history API](https://developer.mozilla.org/en/docs/DOM/Manipulating_the_browser_history)。您的网站将更易于访问、对用户更友好、对 SEO 更友好，并且看起来也更加先进。** 

 *** * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-11T00:23:46.237

现在可以有很多方法..简单的方法（但这不是一种可维护的方法）

是将您的所有网站内容放在一个页面中，并将您认为页面的每个部分包装在一个 div 中，如下所示

```
<div class="home-page">content of home page goes here </div>
<div class="contact-us-page">content of contact us  page goes here </div>

etc... 
```

并使用 jquery 隐藏除主页之外的所有内容

```
$(function(){
   $('.contact-us-page').hide();
   $('.other-page').hide();
}) 
```

当用户点击其他页面的链接让我们说联系我们页面时，您将隐藏父级并滑动联系我们页面

```
$('.contact-us-link').click(function(){
    $('.home-page').hide(1000);
    $('.contact-us-page').show(1000);
}) 
```

就是这样:)

这样做的缺点是不会有路由..

所以要解决这个问题，你必须使用像backbone.js这样的东西，这需要一段时间才能很好地了解它......

这只是一个关于它如何工作的快速想法..**

# python - 如何在我的 heroku 应用程序上安装软件包？

> ID：15329280
> 
> 赞同：0
> 
> 时间：2013-03-11T00:04:45.837
> 
> 标签：python, heroku, virtualenv, pyramid, uuid

我有一个使用 shortuuid ( [https://pypi.python.org/pypi/shortuuid/0.1](https://pypi.python.org/pypi/shortuuid/0.1) ) 的应用程序，当我使用 runapp.py 运行它时，它在本地运行良好：

```
import os

from paste.deploy import loadapp
from waitress import serve

if __name__ == "__main__":
    port = int(os.environ.get("PORT", 5000))
    app = loadapp('config:production.ini', relative_to='.')

    serve(app, host='0.0.0.0', port=port) 
```

但是，当我尝试使用 ../bin/pserve development.ini 运行它时，它不起作用。我收到错误：导入错误：没有名为 shortuuid 的模块。当我把它推到heroku时，我得到了同样的错误。我已将 shortuuid 安装到运行我的应用程序的虚拟环境中，并且只能得出结论，heroku 上没有此安装是导致问题的原因。

我已经尝试用 production.ini 代码替换 development.ini 代码，但它仍然不起作用，所以我假设它是别的东西（可能是 runapp.py 上的 import os 行？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T00:08:00.800

我通常创建一个`requirements.txt`包含包的文件：

```
Flask==0.9
Jinja2==2.6
Werkzeug==0.8.3
distribute==0.6.27
wsgiref==0.1.2

Flask-Cache==0.10.0

gunicorn==0.17.2 
```

您可以使用以下命令创建该文件`pip`：

```
$ pip freeze > requirements.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:07:19.593

将 a`requirements.txt`放在 git repo 的根目录中，并带有所需的依赖项（以 pip/easy-install 格式指定）。

取自[Heroku 网站](https://devcenter.heroku.com/articles/python-pip)的示例：

```
Flask==0.8
Jinja2==2.6
Werkzeug==0.8.3
certifi==0.0.8
chardet==1.0.1
distribute==0.6.24
gunicorn==0.14.2
requests==0.11.1 
```

# c++ - 某个程序的堆栈内存有多大，是否有任何编译器标志可以设置它？

> ID：15329281
> 
> 赞同：13
> 
> 时间：2013-03-11T00:04:55.263
> 
> 标签：c++, c, memory, size, stack

正如标题所述：关于堆栈大小是否有任何一般的“经验法则”。我猜大小会因操作系统、架构、缓存大小、可用 RAM 大小等而有所不同。

*但是，一般可以说什么，或者有什么方法可以找出这个*程序允许使用多少堆栈？作为一个额外的问题，是否有任何方法（使用编译器标志等（这里主要考虑 C/C++，但也更通用））堆栈的大小可以由用户设置为固定大小？

顺便说一句，我完全出于好奇而问，我没有堆栈溢出。:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T00:14:35.493

在 Windows 中，线程的默认堆栈大小为一百万字节，与操作系统等无关。

在托管代码（C#、VB 等）中，您可以使用此 ctor 强制新线程具有不同的堆栈大小：

[http://msdn.microsoft.com/en-us/library/5cykbwz4.aspx](http://msdn.microsoft.com/en-us/library/5cykbwz4.aspx)

要更改 Windows 程序的默认线程的堆栈大小，无论是否托管，都可以使用 editbin 实用程序：

[http://msdn.microsoft.com/en-us/library/xd3shwhf.aspx](http://msdn.microsoft.com/en-us/library/xd3shwhf.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-11T00:07:40.817

是的，您可以设置堆栈大小，它通常是一个链接器标志，它取决于您的工具链（通常由编译器的名称引用）。

*   [对于 Microsoft Visual C++，使用该`/F`选项](http://msdn.microsoft.com/en-us/library/tdkhxaks.aspx)更改大小，并[`DUMPBIN /HEADERS`查看设置是什么](http://support.microsoft.com/kb/177429)。
*   对于 GCC 工具链和大多数其他 Unix 链接器，使用`-Wl,--stack`

您还可以在 StackOverflow 上找到几个现有的问题。

# c - 无法在 linux gcc 中加载 dll

> ID：15329283
> 
> 赞同：0
> 
> 时间：2013-03-11T00:05:00.367
> 
> 标签：c, linux, gcc

我正在尝试使用我制作的 DLL 编译我的代码，当我编写时出现以下错误`./prog`

> ./prog：加载共享库时出错：libctest.so.1：无法打开共享对象文件：没有这样的文件或目录

我按照[这里的教程](http://www.yolinux.com/TUTORIALS/LibraryArchives-StaticAndDynamic.html)进行操作，我的单声道应用程序加载 dll 和调用函数没有问题。本教程的关键部分是

```
gcc -Wall -fPIC -c *.c
gcc -shared -Wl,-soname,libctest.so.1 -o libctest.so.1.0   *.o
mv libctest.so.1.0 /opt/lib
ln -sf /opt/lib/libctest.so.1.0 /opt/lib/libctest.so.1
ln -sf /opt/lib/libctest.so.1.0 /opt/lib/libctest.so 
```

我的 C# 代码可以

```
[DllImport("path/to/CDLL", CallingConvention = CallingConvention.Cdecl)]
public static extern void test(); 
```

我用

```
gcc -Wall -L/opt/lib main.c -lctest -o prog 
```

这是我改变的第一件事。prog.c 到 main.c。从那里我只是运行`./prog`以获取此问题顶部的错误。我以 root 身份执行此操作，因此不应该存在权限问题。我也 chmod 755 这样的。我究竟做错了什么？这是开放使用。我必须创建，`/opt/lib`所以我认为这条路径没有在它应该在的地方注册

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T00:10:43.567

尝试解析库依赖项时，动态链接器默认`ld.so`不会查看。`/opt/lib`您必须告诉链接器非标准库目录或将`/opt/lib`路径添加到您的`prog`二进制文件。

例如

```
LD_LIBRARY_PATH=/opt/lib ./prog 
```

或者，`prog`使用`-rpath`链接器选项链接。这为链接器在解析共享对象的位置时提供了额外的搜索路径。

```
gcc -Wall -L/opt/lib -Wl,-rpath,/opt/lib main.c -lctest -o prog 
```

您可以`ldd`在二进制文件上使用该命令来显示共享库的位置。

```
ldd prog 
```

这将显示当前`libctest.so`无法找到。使用额外的搜索路径，以下命令应该显示所有库都已解析：

```
LD_LIBRARY_PATH=/opt/lib ldd prog 
```

# javascript - 将 setAttribute 替换为 IE 兼容脚本

> ID：15329292
> 
> 赞同：3
> 
> 时间：2013-03-11T00:06:11.737
> 
> 标签：javascript, html, setattribute

我正在尝试创建一个弹出消息，该消息在您确认之前禁用屏幕的其余部分，**仅使用 CSS 和 JavaScript**（并且没有该`alert`功能）。

虽然[http://msdn.microsoft.com/en-us/library/ie/ms536739%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ie/ms536739%28v=vs.85%29.aspx)声明`setAttribute`在 IE8 及更高版本中受支持，但它似乎无法正常工作 - 实际上它似乎根本不起作用。

这是我的代码：

```
<html>

<style type="text/css">

.overlay
{
position: absolute;
left: 0px;
top: 0px;
width: 100%;
height: 100%;
background-color: rgba(0,0,0,0.2);
}

.overlaytext
{
position: absolute;
left: 50%;
margin-left: -150px;
top: 50%;
margin-top: -50px;
width: 300px;
height: 100px;
padding-top: 5px;
background-color: #777777;
color: #000000;
font-size: 20px;
text-align: center;
}

.overlaybutton
{
position: absolute;
left: 50%;
margin-left: -30px;
top: 50%;
margin-top: 20px;
width: 60px;
height: 25px;
border: solid;
border-color: #000000;
border-width: 1px;
background-color: #999999;
color: #000000;
font-size: 20px;
}

</style>

<script type="text/javascript">

function showoverlay(message)
{
var overlay = document.createElement('div');
overlay.setAttribute('id','overlay');
overlay.setAttribute('class','overlay');
document.body.appendChild(overlay);

var overlaytext = document.createElement('div');
overlaytext.setAttribute('id','overlaytext');
overlaytext.setAttribute('class','overlaytext');
overlaytext.innerHTML = message;
document.body.appendChild(overlaytext);

var overlaybutton = document.createElement('input');
overlaybutton.setAttribute('type','button');
overlaybutton.setAttribute('id','overlaybutton');
overlaybutton.setAttribute('class','overlaybutton');
overlaybutton.setAttribute('value','OK');
overlaybutton.setAttribute('onclick','deleteoverlay()');
document.body.appendChild(overlaybutton);
}

function deleteoverlay()
{
var elem = document.getElementById('overlay');
elem.parentNode.removeChild(elem);
elem = document.getElementById('overlaytext');
elem.parentNode.removeChild(elem);
elem = document.getElementById('overlaybutton');
elem.parentNode.removeChild(elem);
}

</script>

<body>

<input type="button" value="Show message" onclick="showoverlay('Message text')"/>

</body>
</html> 
```

它在 Firefox 和 Chrome 中运行良好，但 IE（使用 IE9 测试）似乎忽略了该`setAttribute`方法，因为它只放入文本和按钮，但没有格式化（即`class`未应用）并单击新创建的按钮不删除对象（即要么`id`未应用，要么与删除对象的部分代码存在一些额外的不兼容）。

我试图`setAttribute`像这样替换：

```
<script type="text/javascript">

function showoverlay(message)
{
var overlay = document.createElement('div');
overlay.id = 'overlay';
overlay.class = 'overlay';
document.body.appendChild(overlay);

var overlaytext = document.createElement('div');
overlaytext.id = 'overlaytext';
overlaytext.class = 'overlaytext';
overlaytext.innerHTML = message;
document.body.appendChild(overlaytext);

var overlaybutton = document.createElement('input');
overlaybutton.type = 'button';
overlaybutton.id = 'overlaybutton';
overlaybutton.class = 'overlaybutton';
overlaybutton.value = 'OK';
overlaybutton.onclick = 'deleteoverlay()';
document.body.appendChild(overlaybutton);
}

function deleteoverlay()
{
var elem = document.getElementById('overlay');
elem.parentNode.removeChild(elem);
elem = document.getElementById('overlaytext');
elem.parentNode.removeChild(elem);
elem = document.getElementById('overlaybutton');
elem.parentNode.removeChild(elem);
}

</script> 
```

但这一次它甚至没有添加文本和按钮。

**那么，如何使这个脚本与 IE 兼容，既显示所有元素，又删除它们？**

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-11T00:49:56.240

将此用作您的文档类型

```
<!DOCTYPE html> 
```

然后把它放在文件的头部

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

然后享受使用`setAttribute`和许多其他功能，这将允许在 IE8+ 环境中正常工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-11T00:20:35.047

在第二个示例中设置类的正确方法是：

```
overlaybutton.className = 'overlaybutton'; 
```

这将使类在 IE 中工作。就删除元素而言，我建议重新格式化您的事件处理附件，如下所示：

```
overlaybutton.onclick = deleteoverlay; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T00:09:32.387

我也遇到过这个问题。如果您能够在网站上包含[jQuery](http://jquery.com/download/)，则可以使用`$('#overlay').attr('class', 'overlay');`. jQuery 对于制作跨浏览器兼容的代码非常有用。

# android - 发送带有分片交易的捆绑包

> ID：15329298
> 
> 赞同：25
> 
> 时间：2013-03-11T00:07:38.907
> 
> 标签：android, android-fragments, bundle

这是我的代码不起作用：

// 以这种方式发送包：

```
 String topUser = String.valueOf(scores.get(arg2));

        Bundle data = new Bundle();
        data.putString("userprofile", topUser);

        FragmentTransaction t = getActivity().getSupportFragmentManager()
                .beginTransaction();
        SherlockListFragment mFrag = new ProfileFragment();
        mFrag.setArguments(data);
        t.replace(R.id.main_frag, mFrag);
        t.commit(); 
```

// 以这种方式检索：

```
 Bundle extras = getActivity().getIntent().getExtras();
        userName = extras.getString("userprofile"); 
```

基本上，没有收到数据。我是在正确的轨道上还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-11T00:09:16.523

您应该使用`getArguments()`Fragment 类的方法。所以在你的里面放一些类似下面的东西`Fragment`：

```
Bundle extras = getArguments(); 
```

参考： http: [//developer.android.com/reference/android/app/Fragment.html#getArguments()](http://developer.android.com/reference/android/app/Fragment.html#getArguments())

# django - Django REST Framework：在嵌套对象中定义字段？

> ID：15329301
> 
> 赞同：14
> 
> 时间：2013-03-11T00:07:43.593
> 
> 标签：django, django-models, django-rest-framework

我收到了发生在以下地点的事件：

```
class Event(models.Model):
    title = models.CharField(max_length=200)
    date_published = models.DateTimeField('published date',default=datetime.now, blank=True)
    date_start = models.DateTimeField('start date')
    date_end = models.DateTimeField('end date')
    def __unicode__(self):
        return self.title
    description = models.TextField()
    price = models.IntegerField(null=True, blank=True)
    tags = TaggableManager()
    location = models.ForeignKey(Location, blank=False)

class Location(models.Model):
    location_title = models.CharField(max_length=200)
    location_date_published = models.DateTimeField('published date',default=datetime.now, blank=True)
    location_latitude = models.CharField(max_length=200)
    location_longitude = models.CharField(max_length=200)
    location_address = models.CharField(max_length=200)
    location_city = models.CharField(max_length=200)
    location_zipcode = models.CharField(max_length=200)
    location_state = models.CharField(max_length=200)
    location_country = models.CharField(max_length=200)
    location_description = models.TextField()
    def __unicode__(self):
        return u'%s' % (self.location_title) 
```

我可以通过以下方式获得所有结果：

```
class EventSerializer(serializers.HyperlinkedModelSerializer):
    id = serializers.Field()
    class Meta:
        model = Event
        depth = 2
        fields = ('url','id','title','date_start','date_end','description', 'price', 'location') 
```

哪个输出：

```
 {
            "url": "http://localhost:8000/api/event/3/", 
            "id": 3, 
            "title": "Testing", 
            "date_start": "2013-03-10T20:19:00Z", 
            "date_end": "2013-03-10T20:19:00Z", 
            "description": "fgdgdfg", 
            "price": 10, 
            "location": {
                "id": 2, 
                "location_title": "Mighty", 
                "location_date_published": "2013-03-10T20:16:00Z", 
                "location_latitude": "37.767475", 
                "location_longitude": "-122.406878", 
                "location_address": "119 Utah St, San Francisco, CA 94103, USA", 
                "location_city": "San Francisco", 
                "location_zipcode": "94103", 
                "location_state": "California", 
                "location_country": "United States", 
                "location_description": "Some place"
            }
        }, 
```

但是，我不希望它获取所有字段，因为我不需要所有字段。如何定义应从嵌套对象中检索哪些字段？谢谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-12T09:20:31.517

序列化器可以嵌套，所以做这样的事情......

```
class LocationSerializer(serializers.ModelSerializer):
    class Meta:
        model = Location
        fields = (...)

class EventSerializer(serializers.HyperlinkedModelSerializer):
    id = serializers.Field()
    location = LocationSerializer()

    class Meta:
        model = Event
        fields = ('url','id','title','date_start','date_end','description', 'price', 'location') 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-12-10T11:36:48.033

我去过这个并没有得到完美的解决方案，但我做了一些你可以检查的事情。

此方法不会创建嵌套的序列化程序

```
**class LocationSerializer(serializers.ModelSerializer):**
     class Meta:
          model = Location
          fields = (...)       #does not matter
          exclude = (...)      #does not matter

class EventSerializer(serializers.ModelSerializer):**
    loc_field_1 = serializers.CharField(required=False,*source='location.loc_field_1'*)
    loc_field_2 = serializers.CharField(required=False,*source='location.loc_field_2'*)

    ***#ADD YOUR DESIRE FIELD YOU WANT TO ACCESS FROM OTHER SERIALIZERS***

    class Meta:
        model = Event
        fields =('url','id','title','date_start','date_end','description', 'price', 'location') 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-04-01T22:36:10.277

当我试图弄清楚如何*仅*在嵌套时从序列化程序中排除某些字段时，我发现了这个问题。看起来 Tasawer Nawaz 也有这个问题。你可以通过覆盖来做到这一点`get_field_names`。这是一个基于汤姆克里斯蒂回答的例子：

```
class LocationSerializer(serializers.ModelSerializer):
    class Meta:
        model = Location
        fields = (...)
        exclude_when_nested = {'location_title', 'location_date_published'}  # not an official DRF meta attribute ...

    def get_field_names(self, *args, **kwargs):
        field_names = super(LinkUserSerializer, self).get_field_names(*args, **kwargs)
        if self.parent:
            field_names = [i for i in field_names if i not in self.Meta.exclude_when_nested]
        return field_names

class EventSerializer(serializers.HyperlinkedModelSerializer):
    id = serializers.Field()
    location = LocationSerializer()

    class Meta:
        model = Event
        fields = ('url','id','title','date_start','date_end','description', 'price', 'location') 
```

# python - file.open 不像我认为的那样工作

> ID：15329307
> 
> 赞同：0
> 
> 时间：2013-03-11T00:08:06.400
> 
> 标签：python, file

我的代码是这样的：

```
self.data = open("/myData", "a")
self.data.close()

self.data = open ("myData", "r")

    self.master = Tk()       
    if (self.data.read()is not None):
        print 2
        print self.data.readlines()
        print 1 
```

我通常在 2 和 1 之间得到一个空白打印。

我确实知道 myData 中写了一些东西。我尝试过其他打开 myData 的方法，例如

```
self.data = open ("/myData", "r") 
```

这给了我“权限被拒绝”（是的，我确实对该文件具有读写权限，我检查过）

和

```
self.data = open ("/game-engineering/myData", "r") 
```

这给了我“找不到文件”。

我犯了一些愚蠢的路径错误吗？我确实知道文件不是空的，如果我用手打开它，我会看到里面有什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T00:12:34.777

当您调用时`read`，您“使用”文件（光标移动到文件的末尾） - 因此，当`readlines`被调用时，它会立即命中 EOF 并返回一个空列表。

在大多数情况下（使用 readlines），您可以直接使用它，因为如果文件为空，您将获得一个空列表，因此您永远不会进入迭代。

# mongodb - 如何使用 mongoimport 从 CSV 文件导入 Mongodb ObjectId？

> ID：15329309
> 
> 赞同：15
> 
> 时间：2013-03-11T00:08:21.863
> 
> 标签：mongodb

我正在努力使用 mongoimport 从 CSV 文件中导入 Mongodb 的 ObjectId：

我尝试了所有我能想到的组合和转义方法，但无法从 CSV 正确导入 ObjectId。

首先，我尝试将我从 MongoDB 导出的内容准确导入 CSV。我正在使用 MongoDB 2.2.1。

我刚刚创建了两个集合并在另一个文档中引用了一个文档的 _id：

```
use yourdb
db.createCollection("student")
db.createCollection("class")
db.student.insert({"name":"Peter"})
db.student.find() returns { "_id" : ObjectId("5143af326d44e1ceb372121d"), "name" : "Peter" }
db.class.insert({"student_id": ObjectId("5143af326d44e1ceb372121d"),"name":"II-4"}) 
```

然后我在 shell 中使用了 mongoexport 命令：

```
mongoexport -h localhost:3002 -d yourdb -c classes --csv -f student_id,name > export.txt 
```

生成的 CSV 如下所示：

```
student_id,name
ObjectID(5143af326d44e1ceb372121d),"II-4" 
```

然后我使用以下方法导入了生成的 CSV：

```
mongoimport -h localhost:3002 -d yourdb -c class --type csv --file export.txt --headerline 
```

查询类集合现在返回：

```
db.class.find()
{ "_id" : ObjectId("5143afc66d44e1ceb372121e"), "student_id" :   ObjectId("5143af326d44e1ceb372121d"), "name" : "II-4" }
{ "_id" : ObjectId("5143b44788df173ba096550e"), "student_id" : "ObjectID(5143af326d44e1ceb372121d)", "name" : "II-4" } 
```

如您所见，第二个文档中的 student_id 字段实际上是一个字符串，而不是 MongoDB ObjectId。

我错了，或者 Mongo 无法导入它自己导出的 CSV？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2015-11-03T19:57:03.497

对于尝试从 JSON 插入 ObjectIds 的任何有此问题的人 - 通过对现有数据进行一些修改，这很有可能。

代替：

```
{ "_id" : ObjectId("5143afc66d44e1ceb372121e"),
  "student_id" : ObjectId("5143af326d44e1ceb372121d"),
  "name" : "II-4" } 
```

和：

```
{ "_id" : {"$oid":"5143afc66d44e1ceb372121e"},
  "student_id" : {"$oid":"5143af326d44e1ceb372121d"},
  "name" : "II-4" } 
```

只需使用正则表达式替换 ObjectId 包装。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-02T12:17:15.290

The problem can be reproduced in MongoDB 2.4.1.

The documentation ([http://docs.mongodb.org/manual/reference/mongoimport/](http://docs.mongodb.org/manual/reference/mongoimport/)) states (emphasis by me):

> Note Do not use mongoimport and mongoexport for full instance, production backups because they **will not reliably capture data type information**. Use mongodump and mongorestore as described in “Backup Strategies for MongoDB Systems” for this kind of functionality.

In this discussion [https://groups.google.com/forum/?fromgroups=#!topic/mongodb-user/RcnumM5QyxM](https://groups.google.com/forum/?fromgroups=#!topic/mongodb-user/RcnumM5QyxM) a similar question was answered as this:

> Mongoimport with tsv or csv can **only import strings and numbers**, and not any of the other types specified in [1]. If you do want to import those types, and if you can produce JSON instead of TSV for your import file, that would be a good way to go; otherwise, you can write a post-processing step which converts the strings to the appropriate MongoDB types (based on some knowledge of what the type of value for a given field should be).
> 
> *   Dan
> 
> [1] [http://www.mongodb.org/display/DOCS/Mongo+Extended+JSON](http://www.mongodb.org/display/DOCS/Mongo+Extended+JSON)

# php - 如何使用带有未知多个键的 JSON (PHP)

> ID：15329310
> 
> 赞同：0
> 
> 时间：2013-03-11T00:08:22.157
> 
> 标签：php, json, key

我收到一个 JSON 字符串，它有多个未知键。这很难解释，因为这些 JSON 字符串非常大，我将尝试以最有效的方式分解它们。

当我解码 JSON 字符串时，我使用 PHP 来分解我得到的对象。

```
$data1 = $json->result->map->12313214654[0]
$data2 = $json->result->map->12313214654[2]

$differentdata1 = $json->result->map->12313214655[0] 
```

如您所见，*地图*键后面有不同的小节。这些是数字，非常随机。而且它们的外观也不规则。所以有时只有一个小节（或数字），有时更多。我怎样才能访问它们？我尝试使用 `$datacount = $count($json->result->map)`但它总是显示 1。然后我仍然无法访问映射键的子元素。有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:14:41.823

由于您似乎有未知数量的数组形式的数据，您可以使用循环迭代您的结果[`foreach`](http://php.net/foreach)：

```
foreach ($json->result->map as $key => $dataArray) {
    // $key will be the numeric key, e.g. 12313214654
    // $dataArray will be the array of data you're after
    foreach ($value as $dataIndex => $data) {
        // $dataIndex is the position of $data within the $dataArray
        // $data is the value you were trying to access with $json->result->map->12313214654[n]
        // You do your work with $data here. 
        print_r($data);
    } 
} 
```

# android - HashSet 到 ArrayList 不在 Listview 中显示

> ID：15329311
> 
> 赞同：0
> 
> 时间：2013-03-11T00:08:30.457
> 
> 标签：android, listview, arraylist

所以这个项目快把我逼疯了。感谢 Ahmed Aeon Axan 的最后回答。我以前从未使用过，`HashTables`但从我看过的所有代码来看，这应该可以工作。请告诉我为什么这没有显示在我的`listview`.

在下面的model.java中创建

```
public class Model implements Serializable {
public static final int END_MORNING = 11;  // 11:00AM, inclusive
public static final int END_AFTERNOON = 16;  // 4:00PM, inclusive

private GregorianCalendar startDate;

private ArrayList<GregorianCalendar> datesSmoked = new ArrayList<GregorianCalendar>();
private ArrayList<String> locationsSmoked = new ArrayList<String>();
private ArrayList<String> locations = new ArrayList<String>();
private ArrayList<String> allIncidents = new ArrayList<String>();
private Set<String> newLocArr = new HashSet<String>(locations);
private SimpleDateFormat sdf = new SimpleDateFormat("E, MMM dd");
private ArrayList<String> times = new ArrayList<String>();

public String [] defaultLocations = {"Home", "Work", "Commuting", "School", "Bar", "Restaurant", "Social Gathering", "Other"};
public String [] eachSmoked;

public Model(GregorianCalendar date){
    startDate = date;

    for (String s : this.defaultLocations) {            
        locations.add(s);
    }
}

public Model(){
    this(new GregorianCalendar()); // now
}   

public ArrayList<String> getDates() {
    for (int i = 0; i < datesSmoked.size(); i++) {
        String s = (sdf.format(i));
        times.add(s);
    }
    return times;
}

public List<String> getPlacesSmoked() { 

    for (String key : locations) {

    newLocArr.add(key+ ": " + Collections.frequency(locationsSmoked, key)); 

    }       
    return new ArrayList<String>(newLocArr);
}

public ArrayList<String> getAllIncidentsArray() {

    for (int i = 0; i < datesSmoked.size(); i++) {
        allIncidents.add(getDates().get(i) + ", " + locationsSmoked.get(i));
    }

    return allIncidents;
}

public ArrayList<String> getlocationsArray() {
    return this.locations;
}

public ArrayList<String> getLocationsSmokedArray() {
    return this.locationsSmoked;
}

public ArrayList<GregorianCalendar> getDatesSmokedArray() {
    return this.datesSmoked;
} 
```

***结束model.java的相关代码***

在未显示的位置活动中调用列表视图

```
public class LocationActivity extends Activity {

public static final String SMOKIN_DATA_FILE = "smokin.dat";

public static Model model = null;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_location);

    restoreModel();

    ListView listView = (ListView) findViewById(R.id.location_listview_Id);
    ArrayAdapter<String> listAdapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, model.getPlacesSmoked());      
    listView.setAdapter(listAdapter);
    listAdapter.notifyDataSetChanged();
} 
```

本质上，我试图获取`ArrayList`显示
Home
Home
Home
Home
School
School
School
School的位置Smoked

显示
家庭：4
学校：4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:29:41.983

您的`locTest`列表是空的，因为它在`Model`创建时使用空列表`HashSet` `test1`进行初始化，而该列表使用空`locations`列表进行初始化。

据`List(Collection<?>)`我所知，构造函数正在复制值，而不是指向集合的指针

**快速解决方案**（不确定它是否真的能解决问题）：

```
public Model(GregorianCalendar date){
    startDate = date;
    for (String s : this.defaultLocations) {            
        locations.add(s);
    }           
    // calling setPlacesSmoked to process data
    setPlacesSmoked();
}

public void setPlacesSmoked() {
    // assuming that locations list holds the data needed to process
    for (String key : locations) {
        test1.add(key+ ": " + Collections.frequency(locations, key));           
    }
}

public List<String> getPlacesSmoked() {             
    //return locTest;
    return new ArrayList<String>(test1);
} 
```

预期输出：

```
Home: 1
Work: 1 
Commuting: 1
School: 1
Bar: 1
Restaurant: 1
Social Gathering: 1
Other: 1 
```

但这取决于`locations`内容

# ruby - Ruby 对象缓存

> ID：15329315
> 
> 赞同：5
> 
> 时间：2013-03-11T00:08:54.510
> 
> 标签：ruby, caching, map

我有许多具有唯一 ID 的 Ruby 对象，我目前正在哈希中缓存这些对象。当一个对象被分配一个 ID 时，它会进入 Hash。缓存是完整的，即存在于 Ruby 范围内的每个具有 ID 的对象也应该在缓存中。

但是，一旦对象从所有其他范围消失，我就无法找到从缓存中删除对象的方法。当然，这是因为缓存中包含的对象不会被垃圾回收。

有没有办法解决这个问题？的文档[`WeakRef`](http://www.ruby-doc.org/stdlib-2.0/libdoc/weakref/rdoc/WeakRef.html#label-Example)建议了一个`WeakHash`类，但它似乎不适合实际使用，尽管它非常接近我认为我的项目需要的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T02:09:56.430

类似于 WeakHash 的东西会做到这一点。这是一个更完整的实现，可以处理 Fixnums、Symbols 和 Floats（以及其他不可变类型，如果您将它们添加到列表中）：

```
class WeakHash < Hash
  def []=(k, v)
    if(![Fixnum, Symbol, Float].include? k.class)
      k = WeakRef.new(k)
    end
    if(![Fixnum, Symbol, Float].include? v.class)
      v = WeakRef.new(v)
    end
    super k,v
  end
end 
```

# sql-server - 有没有办法让 Linq 查询选择编码为 Base64 字符串的时间戳字段？

> ID：15329316
> 
> 赞同：0
> 
> 时间：2013-03-11T00:09:10.697
> 
> 标签：sql-server, asp.net-mvc, jquery, linq-to-entities

我们的数据库中有一个并发检查字段，它是一个 SQL 时间戳。

如果我使用剃刀视图

```
@Html.HiddenFor(m => m.DatabaseRowVersion) 
```

它编码为 Base64 字符串并在保存操作中绑定回我的模型。

如果我通过 Json 请求获得该字段

```
Json(queryable.Select(f => new { DatabaseRowVersion = f.DatabaseRowVersion })) 
```

那么生成的 Json 是一个 8 字段字节数组，我无法在 Save 操作中将其绑定回我的模型。有什么方法可以让 Linq to Entities 在序列化之前将字段选择为 Base64 字符串？

我的解决方案是一个看起来很脏的 JavaScript 函数，用于将 8 个字段字节数组转换为 Base64 字符串，但这并不漂亮，我宁愿原始 Json 请求返回已经编码的字段。我尝试过的一切都给了我一个不受支持的 Linq to Entities 函数异常。我不想在内存中做这件事，我想找到某种 Entities.Functions 风格让它在 SQL 服务器上发生。

我不介意这样做的另一种方法是，如果可以让 jQuery 以某种方式发布保存请求，该方式会将 8 字段字节数组绑定到模型中的 byte[]，但我尝试过的一切都不起作用。我已经在帖子上尝试了所有传统的：true 和 contentType: "application/json; charset=utf-8"，但没有成功，就像在 Ajax 帖子中成功绑定数组的其他操作一样。它似乎不像其他数组那样工作，因为模型绑定器似乎期望 Base64 字符串而不是模型上 byte[] 字段的字节数组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T17:06:54.610

我不确定您是否仍在寻找答案，但我设法通过将字节数组转换为字符串并返回来解决此问题：

```
string stringValue = System.Convert.ToBase64String(byteSource);
Byte[] byteValue = System.Convert.FromBase64String(stringSource); 
```

对于您的情况，您可以创建一个 ViewModel 并使用[AutoMapper](https://github.com/AutoMapper/AutoMapper)在您的模型（具有字节数组时间戳）和视图模型（具有字符串时间戳）之间进行映射。

最后，您将使用您的 ViewModel 创建您的视图，并在更新时将您的 ViewModel 映射回您的模型并从那里更新。这样，您的隐藏字段将是一个字符串，并且您不会遇到现在遇到的问题。

Automapper 在 Byte 数组到 String 之间没有隐式转换方法，因此您必须为您的转换器实现类似的东西：

```
public class ByteArrayTypeConverter : ITypeConverter<string, Byte[]>
    {
        public Byte[] Convert(ResolutionContext context)
        {
            string source = (string)context.SourceValue;
            if (source == null)
            {
                source = "";
            }

            Byte[] returnValue = System.Convert.FromBase64String(source);

            return returnValue;
        }
    }

    public class StringTypeConverter : ITypeConverter<Byte[], string>
    {
        public string Convert(ResolutionContext context)
        {
            Byte[] source = (Byte[])context.SourceValue;

            string returnValue = System.Convert.ToBase64String(source);

            return returnValue;
        }
    } 
```

您的 Mapping 初始化程序看起来像这样：

```
Mapper.CreateMap<string, Byte[]>().ConvertUsing(new ByteArrayTypeConverter());
Mapper.CreateMap<Byte[], string>().ConvertUsing(new StringTypeConverter());
Mapper.CreateMap<YourViewModel, YourModel);
Mapper.CreateMap<YourModel, YourViewModel>(); 
```

希望这可以帮助。

# php - 删除每月用户搜索限制 PDO::MYSQL

> ID：15329320
> 
> 赞同：0
> 
> 时间：2013-03-11T00:09:39.360
> 
> 标签：php, pdo, limit, user-input, vbulletin

如何让 PHP 每月删除用户限制

我有这个代码来增加用户搜索限制，如果他们达到他们的限制

```
$search = $db->prepare("SELECT `searched` FROM `search` WHERE `user_id` =:user_id");
$search->bindValue(':user_id', $vbulletin->userinfo['userid'], PDO::PARAM_INT);
$search->execute();
$result = $search->fetch(PDO::FETCH_ASSOC);
if ($result['searched'] >= 100){
    exit('You have reached your search limit for this month.<br>');
}
$addsearch = $db->prepare("UPDATE `evomap`.`search` SET `searched` = :searched + 1 WHERE `search`.`id` =:user_id;");
$addsearch->bindValue(':user_id', $vbulletin->userinfo['userid'], PDO::PARAM_INT);
$addsearch->bindValue(':searched', $result['searched'], PDO::PARAM_STR);
$addsearch->execute();
/* page i want to execute if user has no reached limit */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:22:33.507

您最好有一个带有月份时间戳的列，设置为日期，当用户达到 100 次搜索时，然后检查当前月份是否！= 时间戳。但是您也可以尝试 MySQL 事件。就像是：

```
 DELIMITER $$
  CREATE EVENT search_removal
    ON SCHEDULE EVERY MONTH
    DO
      BEGIN
        UPDATE search SET searched = 0;
      END;
  $$; 
```

# javascript - 创建没有 Master/Detail 的 Kendo UI Hierarchy Grid

> ID：15329322
> 
> 赞同：1
> 
> 时间：2013-03-11T00:10:03.387
> 
> 标签：javascript, jquery, grid, kendo-ui

我有一组从服务器返回的 JSON 对象，如下所示：

[{State: Finished, JobID: 1234, Owner: John}, {State: Finished, JobID: 5678, Owner: Joe}, {State: Active, JobID: 8765, Owner: Jane}, {State: Active, JobID: 4321，所有者：吉尔}]

我想把它放在一个层次结构的剑道 UI 网格中（不可分组，而是如[http:](http://demos.kendoui.com/web/grid/hierarchy.html) //demos.kendoui.c​​om/web/grid/hierarchy.html 所示），主记录为状态（已完成，活动）和详细记录是每个“状态”关联的 JSON 对象的其余部分。由于没有像典型的 CustomerID/OrderID 等那样的主/从关系本身，我不认为网格的 detailInit 函数可以在这里工作（除非我为此创建自己的伪主/从关系？），但如果我错了，请纠正我。无论如何，让我知道我是否有可能在不跳过太多圈以到达终点的情况下做到这一点。在这里或 JSFiddle 中有一个小的工作示例也将是惊人的。：） 谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T01:06:12.070

您是否知道现有列表，`State`或者您可以在与您显示的请求不同的请求中获取它？如果是这样，您可以这样做：

```
var data = [
    {State: "Finished", JobID: 1234, Owner: "John"},
    {State: "Finished", JobID: 5678, Owner: "Joe"},
    {State: "Active", JobID: 8765, Owner: "Jane"},
    {State: "Active", JobID: 4321, Owner: "Jill"}
];

var element = $("#grid").kendoGrid({
    dataSource: {
        data    : [
            {State: "Finished"},
            {State: "Active"}
        ],
        pageSize: 10
    },
    height    : 450,
    sortable  : true,
    pageable  : true,
    detailInit: detailInit,
    columns   : [
        {
            field: "State",
            title: "State"
        }
    ]
});

function detailInit(e) {
    $("<div/>").appendTo(e.detailCell).kendoGrid({
        dataSource: {
            transport: {
                read: function (operation) {
                    operation.success(data);
                }
            },
            pageSize : 6,
            filter   : { field: "State", operator: "eq", value: e.data.State }
        },
        scrollable: false,
        sortable  : true,
        pageable  : true,
        columns   : [
            { field: "State", width: 70 },
            { field: "JobID", title: "JobID", width: 100 },
            { field: "Owner", title: "Owner" }
        ]
    });
} 
```

在这里，我将`data`其用作检索到的内容，但您可以在函数中`DataSource`为您更改.`detailInit``read``url`

如果您不知道现有的列表，`states`您可以在给定结果的情况下实现一个 JavaScript 函数`DataSource`，返回不同的列表`State`。它可以是这样的：

```
var data = null;

// Create a DataSource for reading the data
var dataSource = new kendo.data.DataSource({
    transport: {
        read: function (op) {
            data = ([
                {State: "Finished", JobID: 1234, Owner: "John"},
                {State: "Finished", JobID: 5678, Owner: "Joe"},
                {State: "Active", JobID: 8765, Owner: "Jane"},
                {State: "Active", JobID: 4321, Owner: "Jill"}
            ]);
            initGrid(data);
        }
    }
});
dataSource.read();

// Function that receives all the data and Creates a Grid after eliminating 
// duplicates States
function initGrid(data) {
    var element = $("#grid").kendoGrid({
        dataSource: {
            transport: {
                read: function (operation) {
                    var states = [];
                    var result = [];
                    $.each(data, function (idx, elem) {
                        if (!states[elem.State]) {
                            states[elem.State] = true;
                            result.push({ State: elem.State });
                        }
                    });
                    operation.success(result);
                }
            },
            pageSize : 10
        },
        height    : 450,
        sortable  : true,
        pageable  : true,
        detailInit: detailInit,
        columns   : [
            {
                field: "State",
                title: "State"
            }
        ]
    });
}

// Function that creates the inner Grid and uses originally read 
// data for avoiding going to the server again. 
function detailInit(e) {
    $("<div/>").appendTo(e.detailCell).kendoGrid({
        dataSource: {
            transport: {
                read: function (operation) {
                    operation.success(data);
                }
            },
            pageSize : 6,
            filter   : { field: "State", operator: "eq", value: e.data.State }
        },
        scrollable: false,
        sortable  : true,
        pageable  : true,
        columns   : [
            { field: "State", width: 70 },
            { field: "JobID", title: "JobID", width: 100 },
            { field: "Owner", title: "Owner" }
        ]
    });
} 
```

# bash - 禁用 shell 解析的 here-document

> ID：15329323
> 
> 赞同：3
> 
> 时间：2013-03-11T00:10:18.060
> 
> 标签：bash, heredoc

我需要一个用于上传`TeX`到在线 shell 的此处文档。我不希望外壳对内容做任何事情。以下 MWE 是我迄今为止管理过的最好的。

```
cat << EOF > /tmp/mytex 
\documentclass{article}
\begin{document}
Test mathematics:  $ 2^{10} = 1024$ works but
$e^{i\pi} = -1$ is mangled because no space follows the $e$.
"double" and 'single' quotes should be preserved too.
\end{document}
EOF 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T00:17:23.537

尝试这个：

```
cat << 'EOF' > /tmp/mytex 
\documentclass{article}
\begin{document}
Test mathematics:  $ 2^{10} = 1024$ works but
$e^{i\pi} = -1$ is mangled because no space follows the $e$.
"double" and 'single' quotes should be preserved too.
\end{document}
EOF 
```

[从 bash 参考手册](http://www.gnu.org/software/bash/manual/html_node/Redirections.html)：

> 这里文档的格式是：

```
<<[-]word
         here-document 
delimiter 
```

> 如果 word 中的任何字符被引用，则分隔符是 word 上去除引号的结果，并且 here-document 中的行不展开。

# neo4j - neo4j 空间密码 withinDistance 问题

> ID：15329326
> 
> 赞同：0
> 
> 时间：2013-03-11T00:10:37.787
> 
> 标签：neo4j

我无法`withinDistance`在 Cypher 中正常工作。

我能够毫无问题地使用空间 REST 创建图层、添加几何图形、调用索引和查询`findGeometriesWithinDistance`。

1.  `POST /db/data/ext/SpatialPlugin/graphdb/addEditableLayer {"layer":"yada"}`
2.  `POST /db/data/ext/SpatialPlugin/graphdb/addGeometryWKTToLayer { "layer":"yada","geometry":"LINESTRING (-87.8269667076541 42.5931258671059,-87.8280193743192 42.5930348004394,-87.8284217076519 42.5931722004391)"}`
3.  `POST /db/data/ext/SpatialPlugin/graphdb/addGeometryWKTToLayer {"layer":"yada","geometry":"LINESTRING (-87.8118643076776 42.588086600447,-87.8183341743342 42.5876782004477,-87.818426974334 42.5877468671142)"}`
4.  `POST /db/data/index/node/ {"name":"yada", "config":{"provider":"spatial","wkb":"wkb"}}`
5.  `POST /db/data/ext/SpatialPlugin/graphdb/findGeometriesWithinDistance {"layer":"yada","distanceInKm":2,"pointX":-87.845556,"pointY":42.582222}`

但是，当我`withinDistance`使用 Cypher 调用时，例如

*   `POST /db/data/cypher {"query":"START n=node:yada('withinDistance:[-87.845556,42.582222,10.0]') RETURN n"}`

我回来

```
400 Bad Request
{
  "message" : "only within, WITHINDISTANCE and bbox are implemented.",
  "exception" : "BadInputException",
  "stacktrace" : [ "org.neo4j.server.rest.repr.RepresentationExceptionHandlingIterable.exceptionOnHasNext(RepresentationExceptionHandlingIterable.java:50)", "org.neo4j.helpers.collection.ExceptionHandlingIterable$1.hasNext(ExceptionHandlingIterable.java:60)", "org.neo4j.helpers.collection.IteratorWrapper.hasNext(IteratorWrapper.java:42)", "org.neo4j.server.rest.repr.ListRepresentation.serialize(ListRepresentation.java:58)", "org.neo4j.server.rest.repr.Serializer.serialize(Serializer.java:75)", "org.neo4j.server.rest.repr.MappingSerializer.putList(MappingSerializer.java:61)", "org.neo4j.server.rest.repr.CypherResultRepresentation.serialize(CypherResultRepresentation.java:57)", "org.neo4j.server.rest.repr.MappingRepresentation.serialize(MappingRepresentation.java:42)", "org.neo4j.server.rest.repr.OutputFormat.assemble(OutputFormat.java:179)", "org.neo4j.server.rest.repr.OutputFormat.formatRepresentation(OutputFormat.java:131)", "org.neo4j.server.rest.repr.OutputFormat.response(OutputFormat.java:117)", "org.neo4j.server.rest.repr.OutputFormat.ok(OutputFormat.java:55)", "org.neo4j.server.rest.web.CypherService.cypher(CypherService.java:75)", "java.lang.reflect.Method.invoke(Method.java:601)" ],
  "cause" : {
    "message" : "only within, WITHINDISTANCE and bbox are implemented.",
    "exception" : "UnsupportedOperationException",
    "stacktrace" : [ "org.neo4j.gis.spatial.indexprovider.LayerNodeIndex.query(LayerNodeIndex.java:277)", "org.neo4j.cypher.internal.spi.gdsimpl.GDSBackedQueryContext$$anon$1.indexQuery(GDSBackedQueryContext.scala:83)", "org.neo4j.cypher.internal.executionplan.builders.IndexQueryBuilder$$anonfun$getNodeGetter$2.apply(IndexQueryBuilder.scala:83)", "org.neo4j.cypher.internal.executionplan.builders.IndexQueryBuilder$$anonfun$getNodeGetter$2.apply(IndexQueryBuilder.scala:81)", "org.neo4j.cypher.internal.pipes.StartPipe$$anonfun$internalCreateResults$1.apply(StartPipe.scala:36)", "org.neo4j.cypher.internal.pipes.StartPipe$$anonfun$internalCreateResults$1.apply(StartPipe.scala:35)", "scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)", "org.neo4j.cypher.internal.ClosingIterator$$anonfun$hasNext$1.apply$mcZ$sp(ClosingIterator.scala:36)", "org.neo4j.cypher.internal.ClosingIterator$$anonfun$hasNext$1.apply(ClosingIterator.scala:35)", "org.neo4j.cypher.internal.ClosingIterator$$anonfun$hasNext$1.apply(ClosingIterator.scala:35)", "org.neo4j.cypher.internal.ClosingIterator.failIfThrows(ClosingIterator.scala:86)", "org.neo4j.cypher.internal.ClosingIterator.hasNext(ClosingIterator.scala:35)", "org.neo4j.cypher.PipeExecutionResult.hasNext(PipeExecutionResult.scala:142)", "scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:327)", "scala.collection.convert.Wrappers$IteratorWrapper.hasNext(Wrappers.scala:29)", "org.neo4j.helpers.collection.ExceptionHandlingIterable$1.hasNext(ExceptionHandlingIterable.java:58)", "org.neo4j.helpers.collection.IteratorWrapper.hasNext(IteratorWrapper.java:42)", "org.neo4j.server.rest.repr.ListRepresentation.serialize(ListRepresentation.java:58)", "org.neo4j.server.rest.repr.Serializer.serialize(Serializer.java:75)", "org.neo4j.server.rest.repr.MappingSerializer.putList(MappingSerializer.java:61)", "org.neo4j.server.rest.repr.CypherResultRepresentation.serialize(CypherResultRepresentation.java:57)", "org.neo4j.server.rest.repr.MappingRepresentation.serialize(MappingRepresentation.java:42)", "org.neo4j.server.rest.repr.OutputFormat.assemble(OutputFormat.java:179)", "org.neo4j.server.rest.repr.OutputFormat.formatRepresentation(OutputFormat.java:131)", "org.neo4j.server.rest.repr.OutputFormat.response(OutputFormat.java:117)", "org.neo4j.server.rest.repr.OutputFormat.ok(OutputFormat.java:55)", "org.neo4j.server.rest.web.CypherService.cypher(CypherService.java:75)", "java.lang.reflect.Method.invoke(Method.java:601)" ]
  } 
```

我不确定这种行为是什么时候开始的，但它似乎是最近的事情。我在这里做错了吗？

谢谢，保罗

*   Neo4j 1.9.M05
*   neo4j 空间 0.11
*   jdk1.7.0_17

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-17T14:45:30.867

有一个类似的问题，REST 请求可以工作，但 Cypher 没有。解决方案是以标准方式创建另一个“正常”节点索引（即 lucene 索引，而不是空间索引），并将其命名为与空间索引相同的名称。

在您的示例中，您创建了一个名为 的空间索引`yada`，为了使 Cypher 正常工作，您将执行[此处](http://docs.neo4j.org/chunked/milestone/rest-api-indexes.html)描述的操作并制作标准的 neo4j 节点索引，然后将您的节点添加到其中。

然后您可以通过 Cypher 进行 withinDistance 查询。但是不要指出，这不会让您执行标准的 Cypher 查询，就像`START n=node:yada('*:*') RETURN n;`它只会让您执行空间查询一样。

这是 Windows 上的 Neo4j 1.9。

# python - 处理更改 python 类的“模式”的最佳方法

> ID：15329328
> 
> 赞同：0
> 
> 时间：2013-03-11T00:10:51.577
> 
> 标签：python, class, properties

所以我正在尝试为高级电机控制创建一个模块，它将包含一堆`node`类的实例。创建后，每个节点都会有一个`nodeID`、`busID`和`operatingMode`。

在初始化节点对象时，我向电机发送一个 CAN 帧，说“嘿，这是你想要的操作模式”。执行此操作的命令称为 cansend。

我已经粗略地编写了代码（手边没有）供您参考：

```
def cansend(nodeID,busID,value):
'''sends a CAN frame with a particular value to a specific node'''

class node(object):
    def __init__(self,nodeID,busID,operatingMode):
        self.nodeID=nodeID
        self.busID=busID
        self.operatingMode=operatingMode
        cansend(self.nodeID,self.busID,operatingMode 
```

我遇到的问题是，如果我想即时更改操作模式（我确实这样做了），那么似乎我必须创建单独的函数，也许是这样的：

```
 def setOperatingMode(self,operatingMode):
        cansend(self.nodeID,self.busID,operatingMode) 
```

`__init__`在方法和方法中都创建这条线似乎有点多余`setOperatingMode`。我最近发现了@property 标签，但没有特别看到它如何在这里使用，但我确实觉得有更好的方法。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:24:15.850

如果我理解正确，您的`node`实例每个都代表他们应该控制的物理电机。该`cansend`函数负责代码和电机本身之间的低级通信。您希望这样做，以便将`Node`'`operatingMode`值的更改发送到电机。

以下是如何使用 a 执行此操作`property`：

```
class Node(object):
    def __init__(self, nodeID, busID, operatingMode)
        self.nodeID = nodeID
        self.busID = busID
        self.operatingMode = operatingMode

    @property
    def operatingMode(self):
        return self._operatingMode

    @operatingMode.setter
    def operatingMode(self, mode):
        self._operatingMode = mode
        cansend(self.nodeID, self.busID, mode) 
```

现在，任何时候你`operatingMode`在一个`Node`实例上赋值（包括在`Node`构造函数本身中！），这个`cansend`函数都会被新值调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:27:27.103

全局`cansend()`函数是通用的，可以从任何地方调用，所以我可能会保留这个函数，除非每次调用`cansend()`都来自节点类。

您可以向您的类添加一个`cansend()`方法，该方法使用存储的实例变量作为输入，而不是将它们设置为参数。此外，如果您对使用属性感兴趣，则可以`operatingMode`按照您的建议将其配置为属性。

这是一个示例重构：

```
def cansend(nodeID,busID,value):
'''sends a CAN frame with a particular value to a specific node'''

class node(object):
    def __init__(self,nodeID,busID,operatingMode):
        self.nodeID = nodeID
        self.busID = busID
        self._operatingMode = operatingMode
        self.send_can_mode()

    def send_can_mode(self):
        """Send current operating mode to node on CAN bus."""
        cansend(self.nodeID, self.busID, self._operatingMode)

    @property
    def operatingMode(self):
        """Return current operating mode."""
        return self._operatingMode

    @operatingMode.setter
    def operatingMode(self, value):
        """Modify operating mode.  Update remote node if mode changes."""
        if value == self._operatingMode:
            return
        self._operatingMode = value
        self.send_can_mode() 
```

当你想改变模式时，你可以这样做`node.operatingMode = newMode`，如果模式从以前的状态改变了，新的模式将被自动发送。

全局`cansend()`仅从`send_can_mode()`方法中调用，因此您可以`cansend()`根据需要将全局集成到您的类中。

# ffmpeg - ffmpeg 缓冲区未释放

> ID：15329332
> 
> 赞同：0
> 
> 时间：2013-03-11T00:11:25.820
> 
> 标签：ffmpeg, buffer, release, decoder

因此，我为 ffmpeg 编写了一个基本解码器，它简单地读取输入帧像素数据（使用 RGB 8 格式存储），并将其直接放入输出缓冲区。（也是RGB 8）问题是当我在ffmpeg中使用这个解码器时，它说有1个未释放的缓冲区。（使用ffmpeg -i Test.utah Test.png测试）。不幸的是，我不确定它在说什么缓冲区，因为我没有创建自己的缓冲区。我尝试在我的解码器关闭方法中释放 AVContext 的 coded_frame 缓冲区，但这会导致分段错误。

任何帮助将不胜感激。

```
static int decode_frame(AVCodecContext *avctx, void *data, int *got_frame, AVPacket *avpkt)
{
    int ret;           /*Hold return from get_buffer */ 
    int skipSize;      /*Number of dummy bytes to skip per line*/
    int fseek=8;       /*Location of the first pixel*/
    int i=0; int j=0;  /*Output buffer seek index/Input Buffer seek index*/
    const uint8_t *buf = avpkt->data; /*Hold a pointer to the input buffer*/
    AVFrame *pict=data; /*Hold a pointer to the output buffer*/

    /*Set the output pixel format to RGB8*/
    avctx->pix_fmt = AV_PIX_FMT_RGB8;

    /*Get the width and height*/
    bytestream_get_le32(&buf);
    avctx->width=bytestream_get_le16(&buf);
    avctx->height=bytestream_get_le16(&buf);

    /*Release the old buffer*/
    if (pict->data[0]) avctx->release_buffer(avctx, pict);

    /*Aquire a large enough data buffer to hold the decompressed picture*/
    if (ret=ff_get_buffer(avctx, pict) < 0) return ret;
    skipSize=pict->linesize[0] - avctx->width; 

    /*Transfer input buffer to output buffer*/
    for(int y=0;y<avctx->height;y++){
        for(int x=0;x<avctx->width;x++){
            pict->data[0][i]=avpkt->data[fseek+j];
            j++;
            i++;
        }
        i+=skipSize;
    }

    /*Inform ffmpeg the output is a key frame and that it is ready for external usage*/
    pict->pict_type        = AV_PICTURE_TYPE_I;
    pict->key_frame        = 1;
    *got_frame=1;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T20:26:02.290

您没有为此解码器对象发布 .close 方法。你是否有一个？在大多数 FFmpeg 解码器中，它采用`codecname_decode_end()`. 此方法/函数在解码完成后调用，并让解码器有机会自行清理。

我要去哪里：

```
decode_frame call #0: no frame held; frame allocated
decode_frame call #1: free frame allocated during call #0; frame allocated
decode_frame call #2: free frame allocated during call #1; frame allocated
[...]
decode_frame call #n: free frame allocated during call #(n-1); frame allocated 
```

但是当这一切都完成后，解码器仍然持有在 decode_frame 调用 #n 期间分配的帧。`codecname_decode_end()`允许解码器释放最后一帧。

# scala - 函数采用数组和元素数组上的函数

> ID：15329343
> 
> 赞同：1
> 
> 时间：2013-03-11T00:13:01.307
> 
> 标签：scala, functional-programming

我开始学习 Scala 并且在为不耐烦的人阅读 Scala 时，得到了以下练习之一的解决方案：

```
//No function
def positivesThenZerosAndNegatives(values: Array[Int]) = {
    Array.concat(for (value <- values if value > 0) yield value,
        for (value <- values if value == 0) yield value,
        for (value <- values if value < 0) yield value)
} 
```

但是现在我试图将在每个综合上应用过滤器的函数作为参数传递：

```
//Trying to use a function (filter)
def positivesThenZerosAndNegatives2(values: Array[Int]) = {
    Array.concat(filter(values, _ > 0), filter(values, _ == 0), filter(values, _ < 0))
}

def filter[T: Int](values: Array[T], f: (T) => Boolean) = {
    for (value <- values if f(value)) yield value
} 
```

我还没有找到引用元素数组的正确方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T00:25:25.807

您可以`filter`按如下方式编写您的方法：

```
import scala.reflect.ClassTag

def filter[T: ClassTag](values: Array[T], f: T => Boolean): Array[T] = {
  for(value <- values; if f(value)) yield value
} 
```

或者这样：

```
def filter(values: Array[Int], f: Int => Boolean): Array[Int] = {
  for(value <- values; if f(value)) yield value
} 
```

无论如何，您可以像这样简单地重写您的方法`positivesThenZerosAndNegatives`：

```
scala> def positivesThenZerosAndNegatives(values: Array[Int]) = {
     |   values.filter(0 <) ++ values.filter(0 ==) ++ values.filter(0 >)
     | } 
```

# python - 使用 chef 安装 python 时出现“CRC check failed”

> ID：15329351
> 
> 赞同：1
> 
> 时间：2013-03-11T00:14:10.363
> 
> 标签：python, chef-infra, chef-solo

我正在尝试使用 chef-solo 和 vagrant 将石墨安装到 64 位 Lucid VM 上。石墨的依赖项之一是 python，当我尝试配置 VM 时，出现以下错误。我正在使用来自 Opscode ( [https://github.com/opscode-cookbooks/python](https://github.com/opscode-cookbooks/python) )的标准 python 食谱

我对 chef 或 python 不熟悉，所以这个错误让我有点难过。任何帮助表示赞赏。

```
[default] Running provisioner: Vagrant::Provisioners::ChefSolo...
[default] Generating chef JSON and uploading...
[default] Running chef-solo...
stdin: is not a tty
[2013-03-11T00:18:05+01:00] INFO: *** Chef 10.14.2 ***
[2013-03-11T00:18:05+01:00] INFO: Setting the run_list to ["recipe[graphite]"] from JSON
[2013-03-11T00:18:05+01:00] INFO: Run List is [recipe[graphite]]
[2013-03-11T00:18:05+01:00] INFO: Run List expands to [graphite]
[2013-03-11T00:18:05+01:00] INFO: Starting Chef Run for lucid64.hsd1.ca.comcast.net.
[2013-03-11T00:18:05+01:00] INFO: Running start handlers
[2013-03-11T00:18:05+01:00] INFO: Start handlers complete.
[2013-03-11T00:18:06+01:00] WARN: This recipe uses encrypted data bags, which are not supported on Chef Solo - fallback to node attribute.
[2013-03-11T00:18:06+01:00] INFO: Processing package[python] action install (python::package line 40)
[2013-03-11T00:18:06+01:00] INFO: Processing package[python-dev] action install (python::package line 40)
[2013-03-11T00:18:06+01:00] INFO: Processing remote_file[/tmp/vagrant-chef-1/distribute_setup.py] action create (python::pip line 33)
[2013-03-11T00:18:06+01:00] INFO: Processing execute[install-pip] action run (python::pip line 39)

================================================================================
Error executing action `run` on resource 'execute[install-pip]'
================================================================================

Mixlib::ShellOut::ShellCommandFailed
------------------------------------
Expected process to exit with [0], but received '127'
---- Begin output of   /usr/bin/python distribute_setup.py --download-base=https://pypi.python.org/packages/source/d/distribute/
  /usr/local/bin/easy_install pip
 ----
STDOUT: Extracting in /tmp/tmphzwy_0
STDERR: Traceback (most recent call last):
  File "distribute_setup.py", line 546, in <module>
    sys.exit(main())
  File "distribute_setup.py", line 543, in main
    return _install(tarball, _build_install_args(options))
  File "distribute_setup.py", line 77, in _install
    _extractall(tar)
  File "distribute_setup.py", line 479, in _extractall
    for tarinfo in members:
  File "/usr/lib/python2.6/tarfile.py", line 2412, in next
    tarinfo = self.tarfile.next()
  File "/usr/lib/python2.6/tarfile.py", line 2314, in next
    self.fileobj.seek(self.offset)
  File "/usr/lib/python2.6/gzip.py", line 382, in seek
    self.read(1024)
  File "/usr/lib/python2.6/gzip.py", line 219, in read
    self._read(readsize)
  File "/usr/lib/python2.6/gzip.py", line 267, in _read
    self._read_eof()
  File "/usr/lib/python2.6/gzip.py", line 304, in _read_eof
    hex(self.crc)))
IOError: CRC check failed 0x94c615b3 != 0x2e611106L
sh: /usr/local/bin/easy_install: not found
---- End output of   /usr/bin/python distribute_setup.py --download-base=https://pypi.python.org/packages/source/d/distribute/
  /usr/local/bin/easy_install pip
 ----
Ran   /usr/bin/python distribute_setup.py --download-base=https://pypi.python.org/packages/source/d/distribute/
  /usr/local/bin/easy_install pip
 returned 127 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T07:54:23.213

该错误`IOError: CRC check failed 0x94c615b3 != 0x2e611106L`表明 gzip 模块无法提取下载的 .tgz 文件。这可能是由网络问题引起的。

要隔离此问题，请尝试运行命令以手动设置分发，即运行`vagrant ssh`然后：

```
/usr/bin/python distribute_setup.py --download-base=https://pypi.python.org/packages/source/d/distribute/ 
```

这应该可以帮助您缩小进程在distribute_setup.py 文件中出错的位置。如果distribute_setup.py 失败，那么您可以检查它下载的distribute-XYZtar.gz 文件以查看它是否与[https://pypi.python.org/packages/source/d/distribute/](https://pypi.python.org/packages/source/d/distribute/)中的文件匹配（取md5sum两个文件以验证它们是否相同）。如果它们相同，我会尝试提取刚刚手动下载的 .tgz 以查看它是否有效；我想可以想象该站点上的一个文件已损坏，尽管这似乎不太可能。

如果此时解决方案尚不明显，请使用这些额外的诊断更新您的问题，我们将看到可以进行哪些进一步的挖掘。

# css - 大字体，细字母

> ID：15329352
> 
> 赞同：6
> 
> 时间：2013-03-11T00:14:32.973
> 
> 标签：css, fonts

假设我使用`font-size:30px;`and `font-family:Verdana;`。

![在此处输入图像描述](../Images/c110b860c11fbc96fd1eac6295f88f09.png)

我需要那些字母大而薄，所以我尝试了`font-weight:lighter;`。

然而没有任何改变，有些字体会变小，有些不会受到影响。

如何创建大而细的字母？CSS中有没有办法，或者这些是特定的字体？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T03:20:07.200

这是我想出的最接近的东西。

```
div{
    font-family:Verdana;
    font-size:30px;
    font-weight:100;
    -webkit-text-stroke-color: rgb(255,255,255);
    -webkit-text-stroke-width: 1px;
    -webkit-font-smoothing: antialiased;
} 
```

问题：
1\. 仅适用于 webkit 浏览器（Safari，Chrome）
2\. 如果文本后面的背景不是纯色，则可以看到它是文本笔划。
[http://jsfiddle.net/dru87/](http://jsfiddle.net/dru87/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T05:20:34.510

由于字体不支持某些粗细，要实现更精简的 Verdana 版本，您必须托管自己的字体版本，或使用已托管的其他字体来实现您的外观。

某些字体不支持自己的较轻/较重的版本-如果支持，它们可能与 CSS 数字比例不对齐（正如您所指出的）。

从[这里](http://elliotjaystocks.com/blog/font-weight-in-the-age-of-web-fonts/)。

> 因为这么多专业品质的网络字体有不同的权重，现在使用数字比例比我们只需要处理“正常”（400）和“粗体”（600）时更有意义。通常，家庭的权重可以映射到这些值：
> 
> 100：超轻
> 
> 200：薄
> 
> 300：光
> 
> 400：常规
> 
> 500：半粗体
> 
> 600：粗体
> 
> 700：超粗体
> 
> 800：重
> 
> 900：超重型
> 
> 注意关键字，那里：通常。可悲的是，现实情况是许多字体不符合这种模式，比如当一个家族有大量的权重，或者他们自己的定义不一定符合标准比例时。

因此，长话短说，您将不得不托管字体的“更薄”版本（您制作/下载的字体），或者使用不同的字体。

IMO Tahoma、Hedley 或 Geneva 是外观相似的字体，但这些字体并非免费提供 - 您可以在[Google 字体](http://google.com/fonts)上查找一些，您和[@minitech](https://stackoverflow.com/questions/15329352/big-font-size-thin-letters#comment21647087_15329352)都指出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T06:26:13.613

选择细字体并应用[bigtext.js/fittext.js](http://www.zachleat.com/web/fittext-and-bigtext/)或[slabtext.js](http://www.frequency-decoder.com/demo/slabText/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-13T16:23:23.700

并非所有字体都支持所有宽度。如果您正在寻找一些好的细字体。你可以看看这些[瘦谷歌字体](http://www.howtokickblogger.com/2013/04/thin-google-fonts-for-blog.html)列表。它们是免费且易于实施的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-11T06:10:44.490

使用`font-weight`意味着从字体系列中要求不同粗细的字体（特定字体）。Verdana 字体系列没有比正常字体更轻的字体，因此您可以正常使用。这适用于您通常可以在网页上使用的大多数字体。

例如，在[Google Web Fonts](http://www.google.com/webfonts)中，您可以找到许多字体比正常字体更轻的字体系列，例如 Source Sans Pro 的粗细为 200 和 300。

注意：字体的亮度与字体有关。字体系列中的浅色（200）可能对应于另一个字体系列中的正常（400）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-07T15:39:58.107

第 1 步：包括从 Google 加载字体

https://fonts.googleapis.com/css?family=Lato:100italic' rel='stylesheet' type='text/css'> https://fonts.googleapis.com/css?family=Lato:100' rel ='样式表'类型='文本/css'>

Step2: 添加以下css属性 .text{ font-family: Lato, sans-serif;

字体粗细：100；

字体大小：7em；}

完毕！

肯定会工作

欲了解更多信息，请访问[http://tobiasahlin.com/typesource/01-elements-of-html-and-css/](http://tobiasahlin.com/typesource/01-elements-of-html-and-css/)

# mysql - 如何为 MySQL FROM_UNIXTIME() 结果提取小时？

> ID：15329355
> 
> 赞同：8
> 
> 时间：2013-03-11T00:14:43.650
> 
> 标签：mysql, sql, datetime

我有一列包含 INT 时间戳中的测量时间，我需要按一小时的间隔对数据进行分组。我已经发现了 MySQL 函数 FROM_UNIXTIME()，但是 MySQL 中是否有内部工具可以从该函数的结果中提取小时？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-11T00:18:11.907

我想你的意思是`FROM_UNIXTIME`

```
GROUP BY
    DATE_FORMAT(FROM_UNIXTIME(time_column), '%Y %m %d %H')) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-11T00:17:24.263

```
SELECT *
FROM table
GROUP BY DATE_FORMAT(FROM_UNIXTIME(time_col_name), '%H') 
```

查看 MySQL 的[日期文档](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)。

**编辑：**

`DATE_FORMAT`改为使用可靠地确定返回的小时的格式。请参阅[DATE_FORMAT 文档](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-format)。**注意**：格式 %H 将返回格式为 00、01、... 23 的小时值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T00:17:25.633

就像是：

```
SELECT HOUR(FROM_UNIXTIME(unixCol))
FROM tbl
GROUP BY HOUR(FROM_UNIXTIME(unixCol)) 
```

`HOUR`将提取 UNIX 时间戳转换为日期后的小时。

[请参阅文档](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T00:21:33.120

尝试将该数据库数据作为日期放入变量中，然后回显它。

```
$timestamp = strtotime($db_data);
echo date("m-d-Y", $timestamp); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-09T01:23:39.507

我知道这是在最初的问题之后的几年，但是如果您正在处理更大的数据集，由于为查询集中的每一行调用 2 个函数，这可能需要更长的时间来执行。

通过使用一些模运算，我设法节省了几秒钟的时间

```
GROUP BY FLOOR(time_col/(60*60) MOD 24) 
```

希望这可以帮助 ：）

# jquery - Jquery检查div是否包含来自另一个div的链接

> ID：15329357
> 
> 赞同：0
> 
> 时间：2013-03-11T00:14:58.307
> 
> 标签：jquery, element

我有两列，Master 和 Slave，我想检查 Master 中的哪些链接不在 Slave 中，并突出显示它们。

但是，这似乎不起作用：

```
$(".column2 a").each(function(){

    if ($('.column1').find($(this).html()).length == 0) {
     alert($(this).html()); 
     $(this).addClass('masterhilite');
    }

}); 
```

知道为什么这不起作用吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:18:26.483

检查是否存在具有相同 href 属性的链接`.column1`，如果不突出显示？

```
$(".column2 a").filter(function(){
      return !$('.column1 a[href="' + $(this).attr('href') + '"]').length;
}).addClass('masterhilite'); 
```

**编辑：**

或检查相同的文本：

```
$(".column2 a").filter(function(){
      return !$('.column1 a:contains(' + $(this).text() + ')').length;
}).addClass('masterhilite'); 
```

# c++ - C++ 默认构造函数和默认参数

> ID：15329360
> 
> 赞同：-1
> 
> 时间：2013-03-11T00:15:30.690
> 
> 标签：c++, parameters, constructor, polymorphism, default-parameters

如果我有一个类包含：

```
foo(); //sets baz to 10
foo(int bar = 0); //sets baz to bar
int baz; 
```

会使用“默认”构造函数吗？

例如将：

```
foo qux; 
```

默认为 baz = 0 或 10？

任何区别：

```
foo * quux = new foo; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T00:17:24.410

> 会使用“默认”构造函数吗？

不，没有指定参数的构造函数调用只会是**模棱两可**的。编译器无法判断不接受参数的构造函数是否比接受具有默认值的参数的构造函数更可取，反之亦然。**你的代码不会编译**。

> 任何区别：`foo * quux = new foo;`

不，同样的故事。如果您通过`new`. 编译器仍然无法决定您打算调用哪个构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:17:16.783

这是一个模棱两可的电话。因此，我认为它甚至不应该编译。编译器无法决定您是要调用`foo::foo(int)`构造函数还是默认构造函数，`foo::foo()`.

# php - PayPal IPN 模拟器测试产生一个空的 curl 结果。在现场工作正常

> ID：15329362
> 
> 赞同：0
> 
> 时间：2013-03-11T00:15:56.923
> 
> 标签：php, curl, paypal, paypal-ipn, string

我觉得这里有点超出我的深度。自从几天前对 PayPal 进行大修以来，我一直遇到沙盒 IPN 模拟器的问题。

基本上 curl 结果通常显示 VERIFIED 或 INVALID，现在似乎返回一个空字符串。

这个完全相同的代码在实时模式下工作，但现在在沙箱中不适合我：

```
$post_fields ='cmd=_notify-validate';

foreach($_POST as $key => $val)
{
  $post_fields .= "&$key=".urlencode($val);
}

$ch =  curl_init();
// $url is https://www.sandbox.paypal.com/cgi-bin/webscr
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, $post_fields);
curl_setopt($ch, CURLOPT_VERBOSE, false);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);

$ch_result = curl_exec($ch);
curl_close($ch); 
```

我环顾四周并尝试了各种建议，例如使用 HTTP 1.1 版和添加`curl_setopt($ch, CURLOPT_HTTPHEADER, array('Connection: Close'));`，但似乎没有任何效果。

我得到了所有其他的帖子字段，这只是 $ch_result。很困惑，有没有其他人遇到过这个问题，他们能够解决它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T02:38:24.010

我使用单独但相关的技术（html / os vs php）和同上遇到同样的问题，返回空白var而不是“已验证或无效”，但相同的代码在实时模式下工作正常，因为我仍然收到订单......

我昨晚（星期六）确实阅读了这个线程 - > [IPN 模拟器返回 401 错误](https://stackoverflow.com/questions/15302710/ipn-simulator-returning-401-error)......这似乎表明贝宝开发人员已经意识到问题......在他们知道的范围内，谁知道我在 36 小时前发送了两封电子邮件仍然是nada，但又一次，tiz周末，所以也许周一事情会好转……

另请注意...当我强制/伪造一个 ipn 调用以绕过此错误时，我确实看到他们似乎已将 var payment_status 更改为数字 2 而之前的“已完成”...

oye vey ...这就是所谓的技术升级的痛苦...从技术上讲，恕我直言，我认为他们应该将软件重命名为concreteware，因为一旦事情稳定，就不要管它了，除非安全...所有这些关于“改进”的废话- 呃 - 请参阅 Windows Vista、Windows 8.0，但我离题了……诚挚的，查克斯科特

# asp.net-mvc - 发布或获取控制器操作

> ID：15329363
> 
> 赞同：0
> 
> 时间：2013-03-11T00:16:18.377
> 
> 标签：asp.net-mvc, asp.net-mvc-4, http-post, http-get

我正在使用 asp.net mvc 4.0 并进行大量客户端开发。

在与服务器交互以进行 jquery 调用时，我有一个关于使用 POST 或 GETS 的一般性问题。

当假设通过控制器操作将项目添加到数据库时，使用 GET 而不是 POST 是否更高效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:38:10.913

GET 和 POST 之间没有明显的*性能*差异，但有非常重要的*功能*差异。一个关键区别是 GET 用于幂等请求，而 POST 用于提交更改。因此，GET 请求应该始终可以安全地重复，但对于 POST 来说，存在将采取影响状态的操作并且在不进一步影响状态的情况下无法重复的风险。

另一个常见的问题是，通过允许 GET，应用程序有可能让某些网站爬虫和优化器调用所有 GET 并导致服务器更改（例如删除站点中的所有实体 - 这不是开玩笑，它发生在真实站点中每时每刻）。

请求是否通过 AJAX 进入也不是性能或功能方面的因素。

# html - ÆØÅ 显示为菱形问号

> ID：15329369
> 
> 赞同：1
> 
> 时间：2013-03-11T00:17:18.613
> 
> 标签：html, character-encoding

我几乎很抱歉问这个问题，因为我已经研究了大多数类似的话题，看看在我之前有多少人问过这个问题。简而言之，这是我的代码，它仍然显示那些该死的菱形问号。这是整个标题 html。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="nb" lang="nb">

<head> 
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="shortcut icon" href=""/>

<link rel="stylesheet" href="reset.css" />
<link rel="stylesheet" href="style.css" />

<link href='http://fonts.googleapis.com/css?family=Josefin+Sans:100' rel='stylesheet' type='text/css'>

<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="turn.js"></script>

<title>MY TITLE HERE</title>

</head> 
```

任何帮助是极大的赞赏。这些文件是用 Coda 制作的，经过一些谷歌搜索后，我相信它会自动编码为 UTF-8。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T07:08:19.203

您的文档实际上是用 ISO-8859-1 或 windows-1252 或类似的东西编码的。因此，声明 UTF-8 将破坏所有非 Ascii 字符。

您应该在创作工具中打开该文件并将其保存为 UTF-8 编码。如果无法做到这一点，请将`meta`标签更改为 declare`windows-1252`而不是`UTF-8`.

我假设服务器没有在 HTTP 标头中声明编码。如果是这样，那么您将需要进行实际编码以匹配标头。

# java - 在Java中重新连接串口，无需用户交互

> ID：15329375
> 
> 赞同：-1
> 
> 时间：2013-03-11T00:17:27.457
> 
> 标签：java, connection, serial-port, arduino

我正在使用串行数据编写一个 java 程序。我很好奇如何解决我的 arduino 断开连接的问题，因此停止串行数据，然后再次连接到它，它将再次开始发送数据而无需任何人工交互。

```
public void initialize() {
    working = 1;
    CommPortIdentifier portId = null;
    Enumeration portEnum = CommPortIdentifier.getPortIdentifiers();
    while (portEnum.hasMoreElements()) {
        CommPortIdentifier currPortId = (CommPortIdentifier) portEnum.nextElement();
        for (String portName : PORT_NAMES) {
            if (currPortId.getName().equals(portName)) {
                portId = currPortId;
                break;
            }
        }
    }
    if (portId == null) {
        thirdDC = "Could not find COM Port. Error";
        System.out.println(thirdDC);

        return;
    }

    try {

        serialPort = (SerialPort) portId.open(this.getClass().getName(),
                TIME_OUT);

        serialPort.setSerialPortParams(DATA_RATE,
                SerialPort.DATABITS_8,
                SerialPort.STOPBITS_1,
                SerialPort.PARITY_NONE);

        input = new BufferedReader(new InputStreamReader(serialPort.getInputStream()));
        output = serialPort.getOutputStream();

        serialPort.addEventListener(this);
        serialPort.notifyOnDataAvailable(true);
        System.out.println("WORKING");

    } catch (Exception e) {
        System.err.println(e.toString() + "NOPE");

    }
}

public synchronized void close() {
    if (serialPort != null) {
        serialPort.removeEventListener();
        serialPort.close();
    }
}

public synchronized void serialEvent(SerialPortEvent oEvent) {
    String stop = "ERROR";

    if (oEvent.getEventType() == SerialPortEvent.DATA_AVAILABLE) {
        serialI = true;
        try {

            inputLine=input.readLine();
            if (inputLine.equals(y)){
                System.out.println(y);
                temp1 = "OFF";
                value = 0;
            }
            if (inputLine.equals(z)){
                System.out.println(z);
                temp1 = "ON";
                value = 0;
            }
            if (inputLine.equals(stop)){
                System.out.println(stop);
                temp = "ERROR";
                value = 1;  
            }

            x = Double.parseDouble(inputLine);
            if (x > 0){
            temp = inputLine;
            System.out.println(x);
            value = 0;
            }

        } catch (Exception e) { 

        }

    }else{
    }
} 
```

上面的代码是我认为需要编辑的方法。所以我的问题是，当我拔下 USB 线时，如何同时关闭串口？然后，当我重新插入 USB 线时，我的程序如何识别它已再次插入并正在串行通信？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T07:24:42.503

当您断开 arduino 时，您应该以运行时异常结束，您可以以任何您认为合适的方式处理。找到引发异常的位置，将 public void initialize 更改为 public boolean initialize，在建立连接时返回 true。处理异常时继续调用initialize，直到它返回true。这只是一种方法。

# php - JavaScript AJAX PHP 问题

> ID：15329376
> 
> 赞同：-1
> 
> 时间：2013-03-11T00:17:45.837
> 
> 标签：php, javascript, ajax

行。我需要这方面的帮助。由于某种原因，onreadystatechange 被多次触发。今晚我真的需要弄清楚这一点。这是我剩下的最后一个任务，我不知道该怎么做或导致它的原因。请帮忙。

我正在使用 AJAX (ndhr) 将 JSON 'Ymd h:i:s' 发送到 PHP，以使用 strtotime() 函数通过 AJAX 返回 'mdY'。JSON 和 PHP 工作得很好，但是当 onreadystatechange 被触发时，它会执行多次。几乎就像 readyState == 比它多 4 次。

```
var divs_d = ["d_2009", "d_2010", "d_2011"];

function ajax_get_json(cdiv,ocdv,ed){
    var hr = new XMLHttpRequest();
    hr.open("GET", "/json/sample.json", true);
    hr.setRequestHeader("Content-type", "application/json", true);
    hr.onreadystatechange = function () {
        if (hr.readyState == 4 && hr.status == 200) {
            cdiv.innerHTML = "";
            var data = JSON.parse(hr.responseText);
            var cad = data.comm_archive;
            var rndate;
            var nda = new Array();
            var ndac = 0;
            var ec = 0;

            for (ni = 0; ni < cad.length; ni++) {
                if (cad[ni].year == ocdv) {
                    ec = ec + 1;
                    ed.innerHTML = '<h4>' + ocdv + ' (' + ec + ' entries)</h4>';

                    var ndhr = new XMLHttpRequest();
                    var url = "/inc/strtotime.php";
                    var vars = "ndate=" + cad[ni].publish_date;
                    ndhr.open("POST", url, true);
                    ndhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                    ndhr.onreadystatechange = function () {
                        if (ndhr.readyState == 4 && ndhr.status == 200) {
                            nda[ndac] = ndhr.responseText;
                            ndac = ndac + 1;
                        }
                    }
                    ndhr.send(vars);
                }
            }

            nda.sort(function (a, b) { return b - a });
            for (ndai = 0; ndai < ndac; ndai++) {
                cdiv.innerHTML += '<h4><a href="/this_is_a_Test/archive.php?cdate=' + nda[ndai] + '">' + nda[ndai] + '</a></h4>';
            }
        }
    }
    hr.send(null);
}

function optionCchange() {
    var ocdv = document.getElementById("optionCdate").value;
    var ed = document.getElementById("ediv");

    for (i = 0; i < divs_d.length; i++) {
        var cdiv = document.getElementById(divs_d[i]);

        if (divs_d[i] == "d_" + ocdv) {
            cdiv.className = "bddiv show";
            ajax_get_json(cdiv,ocdv,ed);
        } else {
            cdiv.className = "bddiv hide";
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:28:43.100

在您的`ndhr.onreadystatechange`函数中，`ndhr`代表循环中的最后一个`ndhr`创建而不是调用一个，以引用调用对象 use `this`。

```
 ndhr.onreadystatechange = function () {
     if (this.readyState == 4 && this.status == 200) {
         nda[ndac] = this.responseText;
         ndac = ndac + 1;
     }
 } 
```

由于`the last for(ndai = 0; ndai < ndac; ndai++)`ajax 的异步特性，它的行为与您预期的一样，在执行代码时，ajax 请求尚未完成。您必须在准备更改状态回调中执行此代码。只需使用计数器检查所有 ajax 请求是否已完成，然后执行代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T00:27:22.250

如果您需要运行**一次**代码，您不必担心`readystate 4`被触发了多少次。只需使用布尔变量来检查代码块是否已执行。

这是我想法的伪代码示例。

```
executed = false;
if (readystate && (executed == false))
    {
      blablabla;
      executed = true;
    }
else
    {
      sry your code has been executed;
    } 
```

# batch-file - 替换批处理脚本中的子字符串

> ID：15329379
> 
> 赞同：1
> 
> 时间：2013-03-11T00:17:59.673
> 
> 标签：batch-file

我有三个变量：字符串、搜索、替换。我希望用 %replace% 替换 %string% 中的 %search%。

这可行，但需要硬字​​符。

SET 修改=%string:早上=晚上%

这似乎是论坛中的答案，但不起作用。它只是将整行存储在 %modified%

SET modified=!string:%search%=%replace%!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T03:37:15.663

`!`格式进行延迟扩展——变量立即扩展，`%`但`!`变量仅在需要时才扩展。我相信这只适用于批处理文件，因此如果您直接在命令行中进行试验，您将不会获得与运行批处理文件相同的行为。

`!`在使用符号之前，请确保在批处理文件中启用延迟扩展，如下所示：

```
SETLOCAL ENABLEDELAYEDEXPANSION
SET string=This morning
SET search=morning
SET replace=evening
SET modified=!string:%search%=%replace%!
ECHO %modified%
ENDLOCAL 
```

这将回显`This evening`。

# java - 如何在超时 x 次后停止任务

> ID：15329380
> 
> 赞同：3
> 
> 时间：2013-03-11T00:18:00.453
> 
> 标签：java, multithreading

我正在尝试执行一个 runnable 几次，如果它没有在 x 秒内完成 3 次，我将取消它。

我用来模拟需要取消任务的情况的代码如下。从输出中我可以看到一个 InterruptedException 被抛出并被相应地捕获，但任务继续运行。

似乎在 TimeoutException 被抛出 3 次之前任务的前两次运行，这两次运行一直运行直到它们完成。我想知道是否有办法阻止这两个运行完成？

```
public class SomeClass {

private static int c =0;

public static void main(String[] args){
    Runnable dummyRunnable = new Runnable() {

        @Override
        public void run() {
            System.out.println("Hello from dummyRunnable!");        

                for (int i =0; i< 10; i++){
                    try {
                        //simulate work here
                        if (!Thread.currentThread().isInterrupted()) Thread.sleep(5000);
                        System.out.println("thread sleeps for the " + i + " time!");    
                    } catch (InterruptedException ie){
                        System.out.println("InterruptedException catched in dummyRunnable!");   
                        //Thread.currentThread().interrupt(); //this has no effects
                        break;

                    }
                }

        }
    }; 

    BlockingQueue<Runnable> blockingQueue = new ArrayBlockingQueue<Runnable>(10 * 3, true);
    ThreadPoolExecutor executor = new ThreadPoolExecutor(3, 3, Long.MAX_VALUE, TimeUnit.MILLISECONDS, blockingQueue);

    for (int i =0; i< 5; i++){
        Future<?> task = executor.submit(dummyRunnable);

        try{
            Thread.sleep(1000);
            task.get(2000, TimeUnit.MILLISECONDS);
        } catch (TimeoutException te){
            c++;
            System.out.println("TimeoutException from a task!");
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (ExecutionException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } finally {
            if (c==3){
                System.out.println("cancelling task...");
                task.cancel(true);
                break;
            }
        }
    }
     }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T00:43:59.553

我不明白你实际上想要模拟什么。我希望有一个模拟，比如用卡支付（60 秒超时来完成一项任务），或者可能是医生和病人情况下的秘书。

它现在的方式是在未来创建 5 个对象。如果您想要更多地控制您的线程，您应该考虑使用同步方法和为您处理线程的监视器。

通常在启动线程时，您应该使用

```
new Thread(new Task(object or generics)).start();
Thread.sleep(2000); // calls this thread to wait 2 secs before doing other task(s) 
```

在做一些核心并发（多线程）之前，你应该阅读一些java教程以获得一些灵感...... [http://docs.oracle.com/javase/tutorial/essential/concurrency/index.html](http://docs.oracle.com/javase/tutorial/essential/concurrency/index.html)

# php - 从任何地方引用常见的 PHP 变量

> ID：15329384
> 
> 赞同：2
> 
> 时间：2013-03-11T00:18:29.120
> 
> 标签：php, model-view-controller, variables, global-variables, constants

我正在使用 PHP 构建一个 MVC，以了解一个 MVC 是如何工作的。

在建立了基本框架之后，我有了在一个文件中定义公共变量的想法，该文件包含在我的初始化文件 ( `index.php`) 中，并且可供所有后续文件访问。经过研究，以及大量的反复试验，我找到了实现这一目标的方法。

视觉的：

```
##common.php
# a file of variables used in my project.

$myvar1 = value1;
$myvar2 = value2;
etc... 
```

我最初尝试引用 common.php 文件中的变量，就好像它们是在要使用它们的页面上定义的一样，但发现这不起作用。

视觉的：

```
##page.php
# another page in the same project
# where common.php is included.

//get the value of $myvar1

print $myvar1; // *this does not return value1* 
```

现在我将变量作为`$GLOBALS`数组的一部分引用。

```
##page.php
print $GLOBALS['myvar1'] // *returns value1* 
```

这些是变量，因此我没有使用`define(constant, value)`.

我的方法是否正确，是否有另一种*正确*的方法可以做到这一点，或者我完全不在基地？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:41:43.593

你应该有一个类，调用`Registry`它来存储你所有的共享变量。

这个类当然是在所有 MVC 框架中共享的单例。您在引导函数中设置变量，如下所示：

```
$Registry->save('yourVar','yourValue'); 
```

然后每当你在你的 MVC 中时，你都会得到这个变量：

```
$Registry->get('yourVar'); 
```

当然，你在所有应用程序中都需要这个类的事实带来了 Global State 的问题。您可以在这个相关问题中找到更多信息：[如果单例不好，那么为什么服务容器是好的？](https://stackoverflow.com/questions/6034748/if-singletons-are-bad-then-why-is-a-service-container-good)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T01:07:08.197

**$GLOBALS** — 引用全局范围内可用的所有变量
*简单的一个关联数组，其中包含对当前在脚本全局范围内定义的所有变量的引用。变量名是数组的键。*

```
<?php
function globaltest() {
    $foo = "local variable";

    echo '$foo in global scope: ' . $GLOBALS["foo"] . "\n";
    echo '$foo in current scope: ' . $foo . "\n";
}

$foo = "Gaint Global content";
globaltest();
?> 
```

> $foo 在全局范围内：增益 全局内容
> $foo 在当前范围内：局部变量

这是我朋友对配置文件所做的..

```
<?php
$conf['conf']['foo'] = 'this is foo';
$conf['conf']['fooB'] = 'this is fooB';

function foobar() {
    global $conf;
    var_dump($conf);
}

foobar(); 
```

?>

> 结果是..
> 
> 数组 'conf' => 数组 'foo' => 字符串 'this is foo' (length=11) 'fooB' => 字符串 'this is fooB' (length=12)

并记住要**避免** **`*print '$GLOBALS = ' . var_export($GLOBALS, true) . "\n";*`**

哎呀！

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-11T00:34:20.673

如果它们是全局变量，则需要在要从中访问它们的函数中声明它们。例如

从主文件

```
 $glbTesting = False ; 
```

从你的公用文件

```
 function lg($txt) {
    global $glbTesting;  // this is required otherwise it cannot access the variable called externally

   if ( $glbTesting == True ) 
   {
     echo $txt."<BR>" ; 
   }
   return True;
 } 
```

# android - 如何在主从应用程序中使用 Canvas 绘制文本？

> ID：15329385
> 
> 赞同：2
> 
> 时间：2013-03-11T00:18:35.727
> 
> 标签：android

我想玩android，所以我拿了一些我现有的并修改了它。它是一个主从应用程序，在 Eclipse 中使用默认设置生成，没有新文件。我获取了位于 com.. 中的 ItemDetailFragment.java 的代码并对其进行了修改，以便在屏幕上 (0,0) 处绘制一些测试

这是我修改的代码

```
@Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View rootView = inflater.inflate(R.layout.fragment_item_detail,
                container, false);
        //customImageView custom = (customImageView) inflater.inflate(R.layout.fragment_item_detail, container, false);

        // Show the dummy content as text in a TextView.
        if (mItem != null) {
            //((ImageView) rootView.findViewById(R.id.item_detail_)).setImageResource(R.drawable.ic_launcher);
            ((customImageView) rootView.findViewById(R.id.item_detail__)).invalidate();
        }
        return rootView;
    }
    private class customImageView extends View {
    /*To clarify I added this class myself b/c the android developer guide on Canvas and Drawables says to*/

        public customImageView(Context context, AttributeSet attrs, int defStyle) {
            super(context, attrs, defStyle);
            // TODO Auto-generated constructor stub
        }
        @Override
        public void onDraw(Canvas canvas) {
            canvas.drawText("Some Example Text", 0, 0, new Paint());
        }
    }
} 
```

哦，这是我的 /res/layout/fragment_item_detail.xml 声明

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
   android:layout_width="fill_parent"
   android:layout_height="fill_parent"
   android:orientation="vertical" >

     <TextView
       android:id="@+id/item_detail"
       android:layout_width="fill_parent"
       android:layout_height="wrap_content"
       android:padding="16dp"
       android:textIsSelectable="true" />
<!-- Autogenerated -->

<ImageView
      android:id="@+id/item_detail_"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content" />
      <!--  android:src="@drawable/android" /> -->
    <!-- I added this in -->

<customImageView
      android:id="@+id/item_detail__"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content" />
  <!-- This is the relevant part, I added this in -->

</LinearLayout> 
```

但是，当应用程序在模拟器上运行时，我会得到[这个大的错误列表](http://pastebin.com/UBJRLhWs)

有人可以帮我理解为什么会这样，以及如何解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:03:21.713

这可能是因为您的 View 类是私有的，请尝试将其设置为公共。此外，在 XML 上添加自定义视图时，您需要包含它的完整位置，因此如果它位于 com.pkg 包上名为 clazz 的类中，则需要编写

```
 <com.pkg.clazz.customImageView
       ... /> 
```

# javascript - iframe - 有没有办法在 iframe 中显示浏览器的菜单栏和地址栏等其他项目

> ID：15329388
> 
> 赞同：0
> 
> 时间：2013-03-11T00:18:48.160
> 
> 标签：javascript, html, iframe, jmenubar

我知道如何在通过 JavaScript 创建新窗口时指定“windowFeatures”，例如菜单栏 - open(url, windowname, windowfeatures)

我的问题是：iframe 是否有类似的功能？可以将 windowproperties 分配给 iframe 吗？

我用谷歌搜索过，我能找到的只是人们问关于将他们的网页菜单放在 iframe 中而不是让浏览器的菜单显示的问题。

有没有办法做到这一点？

鲍勃

****更新**** - 我正在完成我所谓的 rknWindows（rkn = 我的首字母缩写）的工作，它们实际上是可移动和可调整大小的分区，看起来像一个窗口。

rknWindow 的内容是一个 iframe，您可以在其中加载网页。

我的意图是为访问者提供另一种在弹出窗口中查看网站信息的方法，可以说它不是弹出窗口。

当我努力修改和改进[Jon Psalmonds 信息网时，我决定需要这样的东西](http://www.jonpsalmonds.net "Jon Psalmonds 信息网")

该网站包含大量数据，我将添加更多数据。目前，它会导致访问者的数据过载，并且随着新信息的出现，情况会更糟。

在整个替换站点上，我使用了可折叠/可扩展的分区，我称之为 sideBox（一个就地扩展的小盒子 - 有点像可折叠/可扩展的分区，但看起来不同）但我仍然没有到达在我正在寻找的东西。

我决定，一方面，我需要提供一个帮助系统来解释网站上的所有功能和信息类型，我的第一个想法是一系列帮助页面。

但我想要在浏览器窗口中显示的东西，与访问者正在阅读的页面相同的窗口，而不是在同一窗口或新窗口中打开的另一个页面的链接。可以重新调整大小、移动、打开和关闭的东西——比如窗户。

我环顾四周，看看其他人是如何解决这个问题的，并与其中几个人一起玩耍。

我看过并喜欢的一个是[dynDiv](http://dyndiv.markusbordihn.de/)但是，它没有格式/视图，也没有我想要的一些功能。

因此，我对 dynDiv 进行了重大更改，删除了一些功能，添加了新功能，使分区的创建完全动态化，仅支持带有 iframe 的分区，而不仅仅是文本等。

当我发现 iframe 不显示您可以为新窗口指定的任何属性时，我只是在测试功能。

我不完全确定我将如何使用它们，但我知道我大脑的一个后脑勺上有些东西可能会酝酿成对它们的用途。

因此我的问题。

至于 rknWindows，当我对其进行了全面测试、按我想要的方式工作和查看，并有完整的文档记录后，我会将有关该设施的页面放在[我的网站上](http://www.bobnovell.com)

如果您想知道，我将感谢 Markus Bordihn 为我建立的基础，但考虑到我的更改程度（以及我现在正在处理的一些更改），它确实是一个新设施，建立在 dynDiv 的基础之上.

这就是为什么我问我关于 iframe 的“windowproperties”的问题。

**第二次更新**

这是 rknWindow 的定义，就目前而言——我仍在改进（当然，这一切都不是独立的，有很多 CSS 和 JavaScript 起着至关重要的作用）：

```
<div id="test_rknWindow" class="rknWin_Parent rknWinElem" style="top: 5px; left: 5px; width: 300px; height: 150px; display: inline; z-index: 2; visibility: visible;" indexarrayindex="0">
    <div class="rknWin_titleBar rknWinElem" id="test_titleBar">test title</div>
    <img src="img/rknwin/closeButton.png" style="height: 14px; width: 16px;" class="rknWin_closeBttn">
    <div style="top: 20px; width: 300px; height: 108px;" class="rknWin_Contents_Iframe rknWinElem" id="test_contents">
        <div id="test_disableIframe" class="rknWin_disableIframe rknWinElem" style="z-index: 11; display: none;"></div>
        <iframe id="test_iframe" class="rknWin_iframe rknWinElem" name="rknWin_iframe" src="rknwin/explainsic.shtml"></iframe>
    </div><div style="width: 300px; cursor: default;" class="rknWin_statusBar rknWinElem" id="test_statusBar"></div>
    <div class="rknWin_corner_BR rknWinElem"></div>
    <div class="rknWin_corner_LTl rknWinElem"></div>
    <div class="rknWin_corner_LTt rknWinElem"></div>
    <div class="rknWin_corner_RTt rknWinElem"></div>
    <div class="rknWin_corner_RTr rknWinElem"></div>
    <div class="rknWin_corner_LBb rknWinElem"></div>
    <div class="rknWin_corner_LBl rknWinElem"></div>
    <div class="rknWin_border_Lm rknWinElem" id="test_border_Lm" style="height: 118px;"></div>
    <div class="rknWin_border_Tm rknWinElem" id="test_border_Tm" style="width: 268px;"></div>
    <div class="rknWin_border_Bm rknWinElem" id="test_border_Bm" style="width: 262px;">
    </div><div class="rknWin_border_Rm rknWinElem" id="test_border_Rm" style="height: 118px;"></div>
</div> 
```

下面是一些创建它的代码：

```
 var source = ((rknSrc !== undefined) && (rknSrc !== null)) ? rknSrc : "";
     var rknWin = document.createElement("div");
     rknWin.id = rknName + "_rknWindow";
     rknWin.className = "rknWin_Parent rknWinElem";
     rknWin.style.top = Top + "px";
     rknWin.style.left = Left + "px";
     rknWin.style.width = Width + "px";
     rknWin.style.height = Height + "px";
     rknWin.rknWinType = "rknWindow";
     rknWin.style.display = "none";
     rknWin.rknInitDisplay = (rknDisplay === true) ? true : false;
     rknWin.rknWinParent = true;
     rknWin.rknWinName = rknName;

     var rknTitleBar =  document.createElement("div");
     rknTitleBar.className = "rknWin_titleBar rknWinElem";
     rknTitleBar.id = rknName + "_titleBar";
     rknTitleBar.rknWinType = "titleBar";

     rknWin.appendChild(rknTitleBar); 
```

请记住，这些都还没有准备好公开发布。今天晚上我将回顾代码，对其进行完善和全面评论。

所以，这就是我现在的做法。

我将研究答案中提到的设施。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:20:36.363

不，没有，也不*应该*有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:44:22.510

就浏览器菜单而言，不，你不能。

但是，您可以使用 javascript重新创建*地址栏*、*前进/后退*和*刷新按钮*以及*新标签按钮。*

控件必须位于 iframe 之外。

**地址栏和刷新：**使用 window.location。

**前进/后退按钮：**使用数组 & window.location 或 history.pushstate。

**新标签：** document.createElement('iframe');

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T00:20:41.347

简短的回答：不。

但是，如果您描述了为什么要这样做，也许我可以提供替代方案？

*更新*

好吧，我认为如果没有实际看到它，可能很难确切地知道你在处理什么。但从你所说的听起来基本上可以归结为：你有很多内容，并希望用户能够在独立的“部门”中查看其中的一部分，这些“部门”在某种程度上独立运作。在我看来，您需要利用 ajax 来动态加载内容，并使用好的 UI 库来帮助您动态呈现数据。使用 DOM 的本质及其功能。查找javascript模板引擎，会有很多例子——比如KnockoutJS、backbone、AngularJS..有几十个。老实说，不知道这种技术是否真的能帮助你解决你想要解决的问题，但这是我的直觉——你

# java - 试图让 GUI 循环遍历从头开始的数据

> ID：15329392
> 
> 赞同：0
> 
> 时间：2013-03-11T00:20:23.617
> 
> 标签：java, swing

我试图让 GUI 完全循环，但在第三个下一步按钮单击数组元素 [2] 后遇到错误。我需要做的是在单击下一步按钮时让整个事情循环。一旦到达数组的最后一次迭代，就需要回到开头。问题还在于数组按字母顺序排序以开始，因此一旦循环通过，它就需要以标题 [3] 开头。感谢所有的帮助

```
import java.awt.FlowLayout;
import java.awt.GridLayout;
import java.awt.event.*;
import java.util.Arrays;
import javax.swing.*;
import java.awt.*;

public class GUI extends JFrame implements ActionListener {
    JButton next;
    JButton previous;
    JButton first;
    JButton last;

    private JLabel itmNum = new JLabel("Item Number: ", SwingConstants.RIGHT);
    private JTextField itemNumber;
    private JLabel proNm = new JLabel ("Product Name: ", SwingConstants.RIGHT);
    private JTextField prodName;
    private JLabel yr = new JLabel("Year Made: ", SwingConstants.RIGHT);
    private JTextField year;
    private JLabel unNum = new JLabel("Unit Number: ", SwingConstants.RIGHT);
    private JTextField unitNumber;
    private JLabel prodPrice = new JLabel("Product Price: ", SwingConstants.RIGHT);
    private JTextField price;
    private JLabel restkFee = new JLabel("Restocking Fee", SwingConstants.RIGHT);
    private JTextField rsFee;
    private JLabel prodInValue = new JLabel("Product Inventory Value", SwingConstants.RIGHT);
    private JTextField prodValue;
    private JLabel totalValue = new JLabel("Total Value of All Products", SwingConstants.RIGHT);
    private JTextField tValue;
    private double toValue;
    Movies[] titles = new Movies[9];
    int nb = 0;

    public GUI() 
    {

        super ("Inventory Program Part 5");
        setSize(800,800);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLookAndFeel();

        first = new JButton("First");
        previous = new JButton("Previous");
        next = new JButton("Next");
        last = new JButton("Last");
        first.addActionListener(this);
        previous.addActionListener(this);
        next.addActionListener(this);
        last.addActionListener(this);

        //Movies[] titles = new Movies[9];

        titles [0] = new Movies(10001, "King Arthur", 25 , 9.99, 2004, .05);

        titles [1] = new Movies(10002,"Tron", 25, 7.99, 1982, .05);

        titles [2] = new Movies(10003, "Tron: Legacy",25,24.99,2010,.05);

        titles [3] = new Movies(10004,"Braveheart", 25,2.50,1995,.05);

        titles [4] = new Movies(10005,"Gladiator",25,2.50,2000,.05);

        titles [5] = new Movies(10006,"CaddyShack SE",25,19.99,1980,.05);

        titles [6] = new Movies (10007,"Hackers",25,12.50,1995,.05);

        titles [7] = new Movies (10008,"Die Hard Trilogy",25,19.99,1988,.05);

        titles [8] = new Movies (10009,"Terminator",25,4.99,1984,.05);

        Arrays.sort (titles, DVD.prodNameComparator);

                        itemNumber = new JTextField(Double.toString(titles[3].getitemNum()));
                        prodName = new JTextField(titles[3].getprodName());
                        year= new JTextField(Integer.toString(titles[3].getYear()));
                        unitNumber= new JTextField(Integer.toString(titles[3].getunitNum()));
                        price= new JTextField(Float.toString(titles[3].getprice()));
                        rsFee= new JTextField(Double.toString(titles[3].getRestkFee()));
                        prodValue= new JTextField(Double.toString(titles[3].getprodValue()));
                        tValue= new JTextField("2636");
                        nb=0;
                        next.addActionListener(this);

        setLayout(new GridLayout(8,4));
        add(itmNum);
        add(itemNumber);
        add(proNm);
        add(prodName);
        add(yr);
        add(year);
        add(unNum);
        add(unitNumber);
        add(prodPrice);
        add(price);
        add(restkFee);
        add(rsFee);
        add(prodInValue);
        add(prodValue);
        add(totalValue);
        add(tValue);
        add(first);
        add(previous);
        add(next);
        add(last);
        setLookAndFeel();
        setVisible(true);

    }

    public void updateFields()
    {
        nb++;
        itemNumber.setText(Double.toString(titles[nb].getitemNum()));
        prodName.setText(titles[nb].getprodName());
        year.setText(Integer.toString(titles[nb].getYear()));
        unitNumber.setText(Integer.toString(titles[nb].getunitNum()));
        price.setText(Double.toString(titles[nb].getprice()));
        rsFee.setText(Double.toString(titles[nb].getRestkFee()));
        prodValue.setText(Double.toString(titles[nb].getprodValue()));

    }

    public void actionPerformed(ActionEvent evt){
        Object source = evt.getSource();
        if (source == next) 
        {
            if (titles[nb]== titles[8])
            {
                titles[nb] = titles[0];
            }
            else {
                nb++;
            }
            updateFields();
        }

    }

    private void setLookAndFeel()
    {
        try{
            UIManager.setLookAndFeel("com.sun.java.swing.plaf.nimbus.NimbusLookAndFeel");
                        SwingUtilities.updateComponentTreeUI(this);
            } catch (Exception e) {
                System.err.println("couln't use the system"+ "look and feel: " + e);
            }

    }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:31:57.180

您在记录中进展如此之快的原因是您已将您的记录添加`ActionListener`到您的`next` `JButton` *两次*：

```
next.addActionListener(this); 
```

反过来，这会增加您的记录索引 ( `nb`)`ActionListener` *以及*您的`updateFields`方法。从这些位置*之一*中删除此增量。

此外，当您检查是否已到达最后一个标题时，您永远不会重置您的记录索引`nb`。你可以这样做：

```
if (titles[nb] == titles[8]) {
   nb = 0;
   ... 
```

# php - 从数据库中检索并回显随机项目，并继续回显五秒钟

> ID：15329398
> 
> 赞同：0
> 
> 时间：2013-03-11T00:20:48.093
> 
> 标签：php, mysql

下面的程序就是这样做的！

```
<?php
/************************************
AIM: To retrieve and echo a random item from a database, and continue to echo the same item whenever and whereever the page is reloaded, for five seconds. After the five seconds is up, the program must echo another random item, and contine ad infinitum.
CONDITIONS: The program cannot echo two results in a row. (In effect the same result for ten seconds).
*************************************/
// Get ready to seed a random value from future 'rand()' function. Seed for 5 seconds.
srand(floor(time() / (5)));

// Retreieve all rows from table 'dogs'.
$result1 = $mysqli->query = new mysqli("SELECT * FROM dogs", MYSQLI_USE_RESULT);

// See how many rows are in 'dogs'.
mysqli_result::$num_rows;

// Generate a random value between 1 and the number of rows in 'dogs'.
echo $random = rand(1,$num_rows) . '<br>';

// Find the current date as a unix timestamp.
echo $currentdate = time() . '<br>';

// Find the time ten seconds ago.
echo $datetensecondsago = $currentdate - 10;
echo '<br>';

?> 
```

但是，我不知道如何让它不连续两次回显相同的随机数据库项目！

数据库原理图如下：

```
Table Name = dogs
id  |  name  |  lastused
------------------------
1   |  Rover |  1362960167
2   |  Chip  |  1362960123
3   |  Rex   |  1362960178 
```

我认为答案在于 mysql 查询，例如

```
SELECT * FROM dogs WHERE dateused<$datetensecondsago LIMIT 1 
```

然后更新使用过的物品的使用时间，但我无法解决！

感谢帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:21:10.743

您可以将随机行保存在会话变量中（即使您重新加载页面也可以访问（并且会话未过期））。

```
 session_start();
 // store session data
 $_SESSION['my_variable'] = 'something'; 
```

然后您可以检查一个元素是否已经回显，或者（**更好**）您可以使用 SQL 中的 WHERE 子句将其排除，例如：（
`SELECT ... FROM ... WHERE id <> LAST_ID`宽度 LAST_ID = 最后回显元素的 id）。

* * *

您可以使用`SELECT COUNT(*) FROM table`来检索 mysql 表中的行数。

* * *

有一种更简单的方法可以从表中获取随机行：

```
SELECT * FROM table ORDER BY RAND() LIMIT 1 
```

还有类似但更快的方法（如果有兴趣，只需 google *mysql random*）

* * *

您是否考虑过使用 javascript 甚至 AJAX？
使用 javascript，无需重新加载页面即可更改其内容。

# visual-studio - “Windows Phone 应用程序”和“Silverlight for Windows Phone 应用程序”有什么区别？

> ID：15329401
> 
> 赞同：5
> 
> 时间：2013-03-11T00:20:52.980
> 
> 标签：visual-studio, windows-phone

我正在观看一些用于开发 Windows Phone 7 应用程序的视频教程（并希望在此基础上开发 Windows 8 应用程序；）视频教程中的那个人正在使用 Visual Studio 2010，而我有 Visual Studio 2012。他使用选项“新建 -> 项目 -> Silverlight for Windows Phone”。虽然我没有这样的选项，但我确实有一个名为“New -> Project -> Windows Phone”的选项。这让我想知道这两者之间是否有区别。如果有的话，有人可以解释它们之间的区别吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T06:59:13.200

Visual Studio 2010 只能为 Windows Phone 7 制作应用程序。而 Silverlight 是 WP7 上唯一可供第三方开发人员使用的 API（甚至 XNA 也是基于 Silverlight）。

在 Windows Phone 8（由 Visual Studio 2012 支持）中，添加了新类型的应用程序：本机（基于 C++）、HTML5……这就是为什么称“Silverlight for Windows Phone”这个类别不再有意义了，它是简单地重命名为“Windows Phone”。

这只是一个名字，对你没有任何影响。创建新的“Windows Phone 应用”项目时，Visual Studio 会询问您要定位哪个版本。如果您选择“Windows Phone 7.1”，您将获得与 Visual Studio 2010 中完全相同的 API。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-09T23:21:00.103

微软只是试图减少术语并普及某些方式。Windows 手机应用程序与适用于 Windows 手机的 Silverlight 相同。唯一不同的是，Visual Studio 2010 中的 Silverlight 项目针对开发人员选择 windows phone 7.0 或 Mango（Mango 在 SDK 中编号为 Windows Phone OS 7.1，而用户称其为 Windows Phone 7.5）或 7.8（根据安装的更新）。但是，如果您在 Visual Studio 中使用 windows phone 项目，您将面向 Windows phone Mango 或 7.8 或 8。请注意，可能需要可选更新以针对 Windows phone 7.8 等某些平台。windows phone 7.8 基本上是一个 windows phone 7，其中一些功能从 windows phone 8 作为多尺寸动态图块向后移植到它，而一些功能没有作为阿拉伯语支持向后移植到它。

Silverlight 和 XNA 是在 Windows Phone 7.0 中制作应用程序的完全不同的方法。在 XNA 项目中不能使用任何代码 silverlight 代码，也不能在 WP7.0 的 silverlight 项目中共享 XNA 代码。Windows Phone 7.0 的程序员在选择之前必须知道每个的含义以及何时使用。silverlight 和 xna 的学习路径过于分离，以至于您可以学习其中一个而完全忽略另一个；事实上，大多数程序员只学到了两者中的一种。在实现大型应用程序之前，您必须在两者之间选择路径，因为没有回头路：即，无法在两者之间传递代码。

然而，从 Windows Phone Mango 开始，微软推出了 Silverlight/XNA。Silverlight/XNA 是 Windows phone Mango 的新应用模型。它允许在 Silverlight 应用程序中使用 XNA。将 XNA 游戏迁移到 Silverlight/XNA 不是一件容易的事，但会很有价值。

Silverlight 的 UI 控件为 Textblock 和 Drop list，布局为 Grid 和 stackpanel；所以很容易制作一个看起来像表单的应用程序，而 XNA 是面向游戏的，因为它是基于状态的编程。对于大多数开发人员来说，在 XNA 中实现一个下拉列表是非常困难的。

Silverlight app改名为windows phone app，以普及为起点，无需深思熟虑选择。

Silverlight 是 Windows 演示基础的精简版，删除了定义您自己的控件的能力。而适用于 windows phone 的 Silverlight 是一个更加精简的版本，删除了所有不适合移动设备的控件，并删除了大多数密码库。

这与微软将 Metro 风格的应用程序重命名为 Windows 8 应用程序，并将 Windows 应用程序重命名为 Windows 窗体应用程序的方式相同；然后 Windows 窗体和 WPF 后来被重命名为 Windows 桌面应用程序。

# java - Android SDK：findViewById(int) 未定义类型

> ID：15329406
> 
> 赞同：1
> 
> 时间：2013-03-11T00:21:53.837
> 
> 标签：java, android, xml, sdk

这是我第一次尝试创建一个安卓应用程序，所以我犯了很多恼人的初学者错误！现在我只是想创建一个非常简单的登录/注册系统。但是，我似乎误解了如何处理用户输入的输入。从我在这里看到的上一篇文章中，我正在尝试做这样的事情：

```
//in Register class
public void submission(View view){
    //Call User Constructor based on info received from Registration Activity
    EditText enteredUser = (EditText)findViewbyId(R.id.enteredUser);
    //then use the input from this field to do other stuff      

} 
```

但是由于某种原因，我不断收到错误，即 findViewById(int) 未定义类型 Register （我当前所在的类的名称）。有人可以告诉我我做错了什么吗？我很确定我在顶部有正确的导入语句（android.widget.EditText）。

下面是对应的xml代码：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:paddingBottom="@dimen/activity_vertical_margin"
android:paddingLeft="@dimen/activity_horizontal_margin"
android:paddingRight="@dimen/activity_horizontal_margin"
android:paddingTop="@dimen/activity_vertical_margin"
tools:context=".Register" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Enter New UserName:" />

<EditText
    android:id="@+id/enteredUser"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/textView1"
    android:layout_below="@+id/textView1"
    android:ems="10" >

    <requestFocus />
</EditText>

...more input buttons etc...

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/confirmPass"
    android:layout_alignParentBottom="true"
    android:layout_marginBottom="64dp"
    android:onClick = "submission" <----- Used to call the submission function after 
    android:text="Submit" />              all inputs have been filled

 </RelativeLayout> 
```

对不起，有点冗长的问题，但我将不胜感激任何帮助。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:27:30.487

您的编译时错误是由于拼写错误：

```
findViewbyId 
```

需要是

```
findViewById 
```

然后确保调用`setContentView()`后调用`super.onCreate(savedInstanceState)`。我强烈建议您遵循[构建您的第一个应用程序](http://developer.android.com/training/basics/firstapp/index.html)教程，并清楚地关注代码。

和往常一样，[熟悉文档](http://developer.android.com/reference/android/app/Activity.html)。如果您有编译时错误，请先检查它，您可能只是有一个错字！

# visual-studio-2010 - 本地网站从目录开始

> ID：15329407
> 
> 赞同：0
> 
> 时间：2013-03-11T00:21:59.390
> 
> 标签：visual-studio-2010, iis, web, visual-studio-2012

我正在使用 VS express for web 和 IIS 7.5 express 建立一个网站并让它工作，但我本地网站的起始页指向一个目录而不是 home.aspx 页面。我已经将 home.aspx 页面设置为 vs 中的起始页面，但仍然没有运气。自从我更新到 vs 12 后，我显然忘了设置一些东西。

我在 IIS 中启用了目录浏览，因为之前启用它会引发错误。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:30:19.003

在 inetmgr.msc（IIS 控制面板）中，选择您的站点，然后从功能窗格中选择“默认文档”。使用“home.aspx”添加一个新条目，然后单击向上箭头，直到它成为列表中的顶部条目。

或者您可以将标签添加到您的 web.config [http://www.iis.net/configreference/system.webserver/defaultdocument](http://www.iis.net/configreference/system.webserver/defaultdocument)

# r - 如何计算R中的百分位数？

> ID：15329408
> 
> 赞同：1
> 
> 时间：2013-03-11T00:22:13.500
> 
> 标签：r

在 R 帮助`help(quantile)`中，您可以看到

```
Type 7 m = 1-p.  p[k] = (k - 1) / (n - 1).  In this case, p[k] =mode[F(x[k])]. 
This is used by S. 
```

现在，我有一个例子：

```
w<-c(75,64,47.4,66.9,62.2,62.2,58.7,63.5,66.6,64,57,69,56.9,50,72.0)  
sort(w)  
[1] 47.4 50.0 56.9 57.0 58.7 62.2 62.2 63.5 64.0 64.0 66.6 66.9 69.0 72.0 75.0  
quantile(w)  
   0%   25%   50%   75%  100%   
47.40 57.85 63.50 66.75 75.00 
```

如何使用 7 型公式得到结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:26:16.323

我很难确定答案是否只是：

```
> quantile(w, type=7)
   0%   25%   50%   75%  100% 
47.40 57.85 63.50 66.75 75.00 
```

我的问题是分位数的默认值是 type=7 并且您已经有了该结果。如果您查看 quantile.default 的代码，则有一个 type=7 的部分：

```
 index <- 1 + (n - 1) * probs
        lo <- floor(index)
        hi <- ceiling(index)
        x <- sort(x, partial = unique(c(lo, hi)))
        qs <- x[lo]
        i <- which(index > lo)
        h <- (index - lo)[i]
        qs[i] <- (1 - h) * qs[i] + h * x[hi[i]] 
```

# r - R：通过平均将多个不规则时间序列与动物园合并

> ID：15329413
> 
> 赞同：3
> 
> 时间：2013-03-11T00:23:16.033
> 
> 标签：r, time-series, zoo

```
library(zoo)
a <- read.zoo(data.frame(t = c(1, 2, 3, 4, 5, 6), v = c(20, 20.5, 21, 20.7, 22, 19.6)))
b <- read.zoo(data.frame(t = c(1, 1.3, 2.4, 2.7, 5.3, 6, 6.9), v = c(15, 15.2, 11, 20.3, 12, 12.6, 20))) 
```

`merge(a, b)`会做：

```
 a    b
1   20.0 15.0
1.3   NA 15.2
2   20.5   NA
2.4   NA 11.0
2.7   NA 20.3
3   21.0   NA
4   20.7   NA
5   22.0   NA
5.3   NA 12.0
6   19.6 12.6
6.9   NA 20.0 
```

我需要的是平均值，`a`并`b`假设该列`v`表示连续时间样本之间保持不变的值：

```
 a    b     **desired output**
1   20.0 15.0         17.50
1.3   NA 15.2         17.60
2   20.5   NA         17.85
2.4   NA 11.0         15.75
2.7   NA 20.3         20.40
3   21.0   NA         20.65
4   20.7   NA         20.50
5   22.0   NA         21.15
5.3   NA 12.0         17.00
6   19.6 12.6         16.10
6.9   NA 20.0         19.80 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T00:26:18.187

```
x <- merge(a, b)
rowMeans(na.locf(x))
[1] 17.50 17.60 17.85 15.75 20.40 20.65 20.50 21.15 17.00 16.10 19.80 
```

# mysql - 如何使用 Joins 跨 MySQL 中的三个表运行查询？

> ID：15329414
> 
> 赞同：0
> 
> 时间：2013-03-11T00:23:20.507
> 
> 标签：mysql, sql, join

我在 Stackoverflow 上研究了很多涵盖此类问题的问题，但我无法得到我寻求的解决方案。

这是我的表：

```
STUDENT
studentID   lastName   firstName
08422567    Brown      Susan
10356844    Black      Roger
10659475    White      Steven
09463729    Grey       Naomi

MODULE
moduleID   moduleName
CE1181     Biometrics
CE1183     Intelligent Systems
CE1133     Databases
CE1186     HCI

GRADES
studentID*  moduleID*  grade
10356844    CE1181     A
10356844    CE1183     B
10356844    CE1133     C
10356844    CE1186     A
08422567    CE1181     B
08422567    CE1183     B
08422567    CE1133     B
08422567    CE1186     B
10659475    CE1181     C
10659475    CE1183     C
10659475    CE1133     A
10659475    CE1186     C
09463729    CE1181     A
09463729    CE1183     B
09463729    CE1133     B
09463729    CE1186     B 
```

我需要运行的查询是：

```
Select all from students whose id begins with 10 and their grade for intelligent systems was a B 
```

现在，我知道我需要将表连接在一起，我已经构建了我的表，以便成绩表包含连接到学生表和模块表的外键。

作为初学者，这种类型的查询很难解决，我希望我接近答案，这就是我所拥有的：

```
SELECT * FROM student WHERE studentID LIKE '10%' INNER JOIN grades
ON student.studentID=grades.studentID  INNER JOIN module
ON grades.moduleID =module.moduleID 
```

当然它不起作用，但我是否走在正确的轨道上？将这个问题的正确解决方案保存在代码工具箱中以供以后使用是一件很棒的事情！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T00:28:33.530

快到了，但`WHERE`需要`JOIN`遵循条款。我使用别名来简化语法。

```
SELECT s.* 
FROM   grades g 
       JOIN module m 
         ON m.moduleid = g.moduleid 
       JOIN student s 
         ON s.studentid = g.studentid 
WHERE  g.studentid LIKE '10%' 
       AND g.grade = 'B' 
       AND m.modulename = 'Intelligent Systems' 
```

**结果**

```
| 学生证 | 姓氏 | 名字 |
----------------------------------
| 10356844 | 黑色 | 罗杰 |
```

[查看演示](http://sqlfiddle.com/#!2/51c37/3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:27:23.287

`WHERE`子句应该跟在`FROM`子句之后。

```
SELECT  a.*, b.*, c.*   -- deselect the columns you don't want to show
FROM    student a
        INNER JOIN grades b
            ON a.studentID = b.studentID  
        INNER JOIN module c
            ON b.moduleID = c.moduleID
WHERE   a.studentID LIKE '10%' AND
        b.grade = 'B' AND
        c.modulename = 'Intelligent Systems' 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/ed377/1)

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

结果

```
╔═══════════╦══════════╦═══════════╦══════════╦═══════╦═════════════════════╗
║ STUDENTID ║ LASTNAME ║ FIRSTNAME ║ MODULEID ║ GRADE ║     MODULENAME      ║
╠═══════════╬══════════╬═══════════╬══════════╬═══════╬═════════════════════╣
║  10356844 ║ Black    ║ Roger     ║ CE1183   ║ B     ║ Intelligent Systems ║
╚═══════════╩══════════╩═══════════╩══════════╩═══════╩═════════════════════╝ 
```

# php - 分页网址解析问题

> ID：15329415
> 
> 赞同：0
> 
> 时间：2013-03-11T00:23:36.023
> 
> 标签：php, pdo, pagination

我有一个看起来相当好用的分页脚本，我将它转换为 PDO，我在解析两个变量时遇到了麻烦。

该页面的网址是

当前事件.php?event_id=62

当我转到第 2 页时，网址显示为

urrent-events.php?page=2

但是它仍然显示第 1 页的结果，我缺少 event_id

问题似乎是我无法调用 event_id 和页面。

谁能看到我的方式的错误？

谢谢

加里

```
 <?php 
            require_once("pdoconnect.inc.php");
            $event_id = $_GET['event_id'];
            ?>

            /////////////////////////////////////////////////////////
                $tbl_name="victims";        //your table name
                // How many adjacent pages should be shown on each side?
                $adjacents = 3;

                /* 
                   First get total number of rows in data table. 
                   If you have a WHERE clause in your query, make sure you mirror it here.
                */
                $query = "SELECT event_id  FROM $tbl_name WHERE event_id = '$event_id' ";

                $q = $conn->prepare($query);
                $q->execute();
                $total_pages = $q->rowCount();
                echo $total_pages;

                //$total_pages = mysql_fetch_array(mysql_query($query));
                //$total_pages = $total_pages[num];

              //?event_id=$event_id
                $targetpage = "current-events.php";     //your file name  (the name of this file)
                                    //how many items to show per page
                            $limit = 10;                

              $page = $_GET['page'];

                if($page) 
                    $start = ($page - 1) * $limit;          //first item to display on this page
                else
                    $start = 0;                             //if no page var is given, set start to 0

                /* Get data. */
                $sql = "SELECT * FROM $tbl_name WHERE event_id = '$_GET[event_id]' ORDER BY lname ASC LIMIT $start, $limit ";
                    $result = $conn->prepare($sql);
                    $result->execute();
                //$result = mysql_query($sql);

                /* Setup page vars for display. */
                if ($page == 0) $page = 1;                  //if no page var is given, default to 1.
                $prev = $page - 1;                          //previous page is page - 1
                $next = $page + 1;                          //next page is page + 1
                $lastpage = ceil($total_pages/$limit);      //lastpage is = total pages / items per page, rounded up.
                $lpm1 = $lastpage - 1;                      //last page minus 1

                /* 
                    Now we apply our rules and draw the pagination object. 
                    We're actually saving the code to a variable in case we want to draw it more than once.
                */
                $pagination = "";
                if($lastpage > 1)
                {   
                    $pagination .= "<div class=\"pagination\">";
                    //previous button
                    if ($page > 1) 
                        $pagination.= "<a href=\"$targetpage?page=$prev\">� previous</a>";
                    else
                        $pagination.= "<span class=\"disabled\">� previous</span>"; 

                    //pages 
                    if ($lastpage < 7 + ($adjacents * 2))   //not enough pages to bother breaking it up
                    {   
                        for ($counter = 1; $counter <= $lastpage; $counter++)
                        {
                            if ($counter == $page)
                                $pagination.= "<span class=\"current\">$counter</span>";
                            else
                                $pagination.= "<a href=\"$targetpage?page=$counter\">$counter</a>";                 
                        }
                    }
                    elseif($lastpage > 5 + ($adjacents * 2))    //enough pages to hide some
                    {
                        //close to beginning; only hide later pages
                        if($page < 1 + ($adjacents * 2))        
                        {
                            for ($counter = 1; $counter < 4 + ($adjacents * 2); $counter++)
                            {
                                if ($counter == $page)
                                    $pagination.= "<span class=\"current\">$counter</span>";
                                else
                                    $pagination.= "<a href=\"$targetpage?page=$counter\">$counter</a>";                 
                            }
                            $pagination.= "...";
                            $pagination.= "<a href=\"$targetpage?page=$lpm1\">$lpm1</a>";
                            $pagination.= "<a href=\"$targetpage?page=$lastpage\">$lastpage</a>";       
                        }
                        //in middle; hide some front and some back
                        elseif($lastpage - ($adjacents * 2) > $page && $page > ($adjacents * 2))
                        {
                            $pagination.= "<a href=\"$targetpage?page=1\"> 1 </a>";
                            $pagination.= "<a href=\"$targetpage?page=2\"> 2 </a>";
                            $pagination.= "...";
                            for ($counter = $page - $adjacents; $counter <= $page + $adjacents; $counter++)
                            {
                                if ($counter == $page)
                                    $pagination.= "<span class=\"current\">$counter</span>";
                                else
                                    $pagination.= "<a href=\"$targetpage?page=$counter\">$counter</a>";                 
                            }
                            $pagination.= "...";
                            $pagination.= "<a href=\"$targetpage?page=$lpm1\">$lpm1</a>";
                            $pagination.= "<a href=\"$targetpage?page=$lastpage\">$lastpage</a>";       
                        }
                        //close to end; only hide early pages
                        else
                        {
                            $pagination.= "<a href=\"$targetpage?page=1\"> 1 </a>";
                            $pagination.= "<a href=\"$targetpage?page=2\"> 2 </a>";
                            $pagination.= "...";
                            for ($counter = $lastpage - (2 + ($adjacents * 2)); $counter <= $lastpage; $counter++)
                            {
                                if ($counter == $page)
                                    $pagination.= "<span class=\"current\">$counter</span>";
                                else
                                    $pagination.= "<a href=\"$targetpage?page=$counter\">$counter</a>";                 
                            }
                        }

                    }

                    //next button
                    if ($page < $counter - 1) 
                        $pagination.= "<a href=\"$targetpage?page=$next\"> next  � </a>";
                    else
                        $pagination.= "<span class=\"disabled\"> next � </span>";
                    $pagination.= "</div>\n";       
                }

            ?>
            <table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:56:46.927

我认为`$event_id`第一个`$query`是一个空变量。
您可以通过以下方式解决问题：

```
$event_id = $_GET['event_id']; 
```

（那么您必须更改第二个查询并放置`$event_id`而不是`$_GET[event_id]`）

但请注意@itachi 所说的**SQL INJECTION ！**

* * *

我认为当您单击分页链接时会丢失一个参数，您必须添加`event_id`到 url。
分页代码比较长，但是可以通过搜索`$targetpage?page`替换为`$targetpage?event_id=$event_id&page`

# php - 在另一个用户区域显示本地用户？

> ID：15329419
> 
> 赞同：0
> 
> 时间：2013-03-11T00:24:29.603
> 
> 标签：php, mysql

嗨，我是 php 和 mysql 的新手，我想知道是否有一种方法可以将我网站上的用户列表显示给彼此邮政编码一定距离内的其他用户？因此，当用户注册时，他们会注册一个邮政编码，这会显示他们附近的用户列表？

因此，如果

*   用户 (a) 住在 m3 4jj
*   用户 (b) 住在 m3 4ej

这两个人相距不到 1 英里。

有没有办法在 php 和 mysql 中做到这一点？有人可以告诉我从哪里开始或分享任何教程。谢谢。

我不能在 myqsl 中创建更基本的东西吗（不需要任何额外的 api 或数据库？）：

```
function get_local_users() {
            global $connection;
            $query = "SELECT *,MATCH(user_postcode) AGAINST ('user_postcode' IN BOOLEAN MODE) AS relevance FROM ptb_stats WHERE MATCH(user_postcode) AGAINST('user_postcode' IN BOOLEAN MODE)
    AND ptb_users.account_type = \"User\" AND ptb_users.account_status = \"Active\" AND ptb_stats.user_id = ptb_users.id
                        AND ptb_profiles.user_id=ptb_stats.user_id
                        AND ptb_users.profile_hidden='0'
                         ORDER BY relevance DESC LIMIT 5";
            $local_set = mysql_query($query, $connection);
            confirm_query($local_set);
            return $local_set;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:35:21.837

这是一个相当广泛的主题，可以作为一个问题提出，因为它涉及整个应用程序的逻辑。

我认为在这种情况下，关键部分不是如何组织数据库或编写 PHP，而是如何计算两个邮政编码之间的距离。这需要某种可以将邮政编码映射到地理位置的服务或数据库；这可能意味着要付费，具体取决于您想要的精度。

编辑：如果不清楚（特别是对于非英国用户），英国的邮政编码系统基于*人口*（即地址数量）而不是*位置*。因此，农村邮政编码覆盖的区域将比城市邮政编码大得多，并且随着城市的发展，有时会“填充”新的邮政编码，从而导致边界和相邻编码有些不可预测。一个完整的邮政编码，例如“M3 4JJ”，表示少至8个地址，因此使用正确的数据库可以非常精确地映射，但同样意味着这样的数据库非常大。

Edit2：看来我的“可能很昂贵”已经过时了，因为军械测量局现在提供[免费版本的邮政编码来映射位置数据](http://www.ordnancesurvey.co.uk/oswebsite/products/code-point-open/index.html)。

# ruby-on-rails - 在 Rails 中是否有更惯用的方法来处理此控制器逻辑？

> ID：15329422
> 
> 赞同：1
> 
> 时间：2013-03-11T00:24:37.340
> 
> 标签：ruby-on-rails

```
 def index
    @workouts = Workout.all
    @user_workouts = current_user.workouts.order("created_at DESC") unless current_user.blank?
    if @client.present?
      @user_workouts = @client.workouts.order("created_at DESC")
    end

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @workouts }
    end
  end 
```

这里的问题是实例变量`@user_workouts`- 我正在使用嵌套路由来执行类似 /clients/1/workouts 而不是 /workouts 之类的操作，这将显示当前用户的锻炼情况，如果是嵌套的，则为 /users/ 1/锻炼。

有什么惯用的方法来处理这个问题，还是让条件潜入是正常的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T00:31:10.593

`Workout`您可以在接受`User`实例时创建一个类方法

```
def self.for_user(user)
  where(user_id: user.id).order("created_at DESC")
end 
```

然后简化你的动作

```
def index
  @workouts      = Workouts.all
  @user_workouts = Workout.for_user(@client || current_user)

  respond_to ... 
```

如果`@client`存在，它将被传递给`for_user`，否则`current_user`将。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:31:10.417

你可以把它弄干一点：

```
user = @client || current_user
@user_workouts = user.workouts.order("created_at DESC") 
```

除此之外，它看起来还不错。

# authentication - 密码验证 - 哈希不一致

> ID：15329424
> 
> 赞同：0
> 
> 时间：2013-03-11T00:24:39.917
> 
> 标签：authentication, joomla, md5, joomla1.5

我正在从 Joomla 1.5 迁移到 WordPress，我的客户不希望用户必须重新注册。所以我正在编写一个 WordPress 插件来匹配用户的密码和 jos_users 表中的内容，然后相应地更新他们在 WordPress 中的信息。

到目前为止，我所阅读的有关 Joomla 密码身份验证的所有内容都指向 getCryptedPassword 函数：

[http://docs.joomla.org/API15:JUserHelper/getCryptedPassword](http://docs.joomla.org/API15:JUserHelper/getCryptedPassword)

我的插件以相同的方式加密用户输入的内容：

```
$db_password = explode(':', $query); //what's in the password field of jos_users
$salt = $db_password[1];
$string_to_be_hashed = $user_entered_pass . $salt; 
$test_pass = md5($string_to_be_hashed);
$test_pass = $test_pass . ":" . $salt;
if($test_pass = query){echo "success"} 
```

我已经使用这个测试了 3 个帐户......但只有 2 个正在验证。

具体来说： md5($password$salt):$salt != 数据库密码值

在数据库中，它不起作用的帐户的密码值似乎使用了相同的加密和相同的格式（[md5hash]:salt）。我知道密码是正确的，因为我可以用它登录到客户的网站。

此外，我在整个 Joomla 代码库中搜索了 getCryptedPassword 函数。在所有情况下，都不会发送显式加密方法 - 代码和文档都表明默认使用 md5。

谁能想到我应该寻找替代加密可能性的任何地方？

我不知道还能去哪里看，也不知道为什么这个特定的用户帐户似乎以不同的方式加密。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T03:38:08.863

在 Joomla 标准中，加密处理如下。

```
 jimport('joomla.user.helper');
     $salt = JUserHelper::genRandomPassword(32);
     $crypt = JUserHelper::getCryptedPassword($password_choose, $salt);
     $password = $crypt.':'.$salt; 
```

您可以通过将整个 joomla 框架加载到根目录中的单个文件来在单独的文件中运行比较。

```
define( '_JEXEC', 1 );
define('JPATH_BASE', dirname(__FILE__) );//this is when we are in the root
define( 'DS', DIRECTORY_SEPARATOR );

require_once ( JPATH_BASE .DS.'includes'.DS.'defines.php' );
require_once ( JPATH_BASE .DS.'includes'.DS.'framework.php' );

$mainframe =& JFactory::getApplication('site');
$mainframe->initialise(); 
```

您也无法解密 Joomla 密码。如果您知道密码（原始文本）然后尝试使用 wordpress 密码 fromat 。

希望这可能会有所帮助..

# asp.net-mvc-2 - 将 IIS7 更新为 .NET 4.5 时的 ASP.NET MVC 2 站点问题

> ID：15329429
> 
> 赞同：3
> 
> 时间：2013-03-11T00:25:21.420
> 
> 标签：asp.net-mvc-2, iis-7, asp.net-4.5

我有一个`ASP.NET MVC 2`与其他网站（使用`ASP.NET MVC 4`）一起运行的 Web 应用程序，已更新`IIS7`以使用`.NET 4.5`，并且我的 MVC2 应用程序停止正常工作：

1.  **问题：（拦截器）** `There is a duplicate 'system.web.extensions/scripting/scriptResourceHandler' section defined` 解决 **方案**：注释掉 web.config 的一部分，基于[http://forums.asp.net/p/1571308/3939106.aspx](http://forums.asp.net/p/1571308/3939106.aspx)：

2.  **问题：（阻止程序）** 登录停止工作，**解决方案**将此行添加`<machineKey validation="SHA1"/>`到 web.config，基于[从 3.5 升级到 ASP.net 4.0 后登录失败](https://stackoverflow.com/questions/2739196/login-fails-after-upgrade-to-asp-net-4-0-from-3-5)：

3.  **问题：** 其中一种观点是给出编译错误：

> CS0104：“ContainerType”是“System.Web.DynamicData.ContainerType”和“MVFleet2.Core.ContainerType”之间的模糊引用

在这条线上：

```
<%foreach (var specs in (List<ContainerType>)ViewData["ContainerTypes"]) 
```

这个错误在更新之前从未发生过，我知道明显的解决方案是使用演员的全名，但我正在寻找一个解决方案，以便我可以强制 Web 应用程序在 .NET 3.5 的上下文中运行并绕过这个问题，所以我不必处理这个问题，将来可能还会有更多问题......这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:50:55.610

如果要使用旧版本的框架（.net 3.5），则需要将 IIS 中的应用程序池更改为以 .Net 2.0 运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:34:49.433

您应该将`ContainerType`类​​型定义完全限定为`MVFleet2.Core.ContainerType.ContainerType`.

# javascript - Javascript Div 点击交换

> ID：15329433
> 
> 赞同：-1
> 
> 时间：2013-03-11T00:25:53.040
> 
> 标签：javascript, jquery, html, swap

因此，我的网站上有一些工作 JS 代码，一旦单击链接，就会将 div 切换到另一个 div。但是，我目前通过覆盖作为链接的清晰 gif 使其在 iframe 之上工作，并且它完美地工作。

现在我想将它应用到我们网站上按下的按钮以创建下载 - 我不能使用相同的不可见 gif 技巧，因为按钮具有鼠标悬停效果然后不起作用所以我希望它发生单击按钮时的其他方式。当前工作的函数在标题中加载为…</p>

```
function yourFunction(){
    document.getElementById('yourfirDiv').style.display='block';
    document.getElementById('yoursecDiv').style.display='none';
} 
```

目前触发此链接的链接是一个完美运行的图像，如下所示......</p>

```
<a href="javascript:void(0)" onclick="var fileref=document.createElement('script');fileref.setAttribute('type','text/javascript'); fileref.setAttribute('src', 'http://url.com/locker.js?guid=0512eafd69b18d22');document.body.appendChild(fileref); setTimeout(yourFunction, 3000);"> 
    <img src="http://url.com/blank.gif" style="position: absolute; z-index: 500; width: 100%; max-width: 100%; height: 280px; "> 
</a> 
```

现在我需要在这个按钮上应用它来做同样的事情……</p>

```
<div id="yoursecDiv" style="display:block;">
    <div id="downloadmp3">
        <div class="download_button_div">
            <form action="/download_file.php" method="post" name="downloadform">
                <input name="file_name" value="<?php echo $fname; ?>" type="hidden">
                <input name="bucket" value="<?php echo $bucket; ?>" type="hidden">
                <button type='submit' class='download_button' title="Click to Download Mixtape!">Download</button>
            </form>
        </div>
    </div>
</div> 
```

有人给了我一些简单的JS，如下所示，当单击div名称时应该触发以触发交换命名div的功能，但是它不起作用，代码片段是......</p>

```
$("#clickablediv").bind("click",function(){
    yourFunction();
}); 
```

为了让事情稍微复杂一点，该页面是一个使用 ajax 启动的浮动页面，因此，如果需要在启动投资组合时加载页面，则上述任何代码都必须放入加载页面的部分的站点 JS 文件中。在上面的链接的情况下，函数代码加载到全局站点标题中就好了，内联 JS 工作正常 - 也许有一种方法可以将该链接应用到我的按钮 div，非常欢迎简单的输入！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T02:31:58.473

我认为 isherwood 是正确的，因为你把事情复杂化了。

但是，试试这个：

```
$(document).ready(function() {
    $(document).on("click","#clickablediv",function(){
        $('#yourfirDiv').show();
        $('#yoursecDiv').hide();
    });
}); 
```

假设#yourfirDiv 具有“display:none”的样式或类css。

然后，您可以从 div 中删除那些讨厌的 onclick 属性。

# asp.net-mvc - MVC 中具有存储库/DTO 模式的实体的部分更新（为 API 做准备）

> ID：15329436
> 
> 赞同：4
> 
> 时间：2013-03-11T00:26:05.403
> 
> 标签：asp.net-mvc, asp.net-mvc-3, web-applications, architecture, asp.net-web-api

我已经构建了我的域模型层、我的存储库层，现在我正在处理我的 DTO 层以供 webApi 项目使用。我正在实施更新服务方法，我想知道部分更新。这是我的 DTO 课程：

```
public class FullPersonDto
    {
        public FullPersonDto()
        {
            Friends = new List<Person>();
        }

        public FullPersonDto(Person person)
        {
            PersonId = person.PersonId;
            DateCreated = person.DateCreated;
            Details = person.Details;
            Friends = new List<Person>();
            foreach (Person friend in person.Friends)
            {
                Friends.Add(new PersonDto(friend));
            }
        }

        [Key]
        public int PersonId { get; set; }

        [Required]
        public virtual DateTime DateCreated { get; set; }

        public virtual string Details { get; set; }

        public List<Person> Friends { get; set; } 

        public Person ToEntity()
        {
            var person = new Person
            {
                PersonId = PersonId,             
                DateCreated = (DateTime) DateCreated,
                Details = Details,
                Friends = new List<Person>()
            };
            foreach (PersonDto friend in Friends)
            {
                person.Friends.Add(friend.ToEntity());
            }
            return person;
        }
    } 
```

这是我的存储库中的更新方法：

```
public Person UpdatePerson(Person person)
        {
            var entry = _db.Entry(person);
            if (entry.State == EntityState.Detached)
            {
                var dbSet = _db.Set<Person>();
                Person attachedPerson = dbSet.Find(person.PersonId);
                if (attachedPerson != null)
                {
                    var attachedEntry = _db.Entry(attachedPerson);
                    attachedEntry.CurrentValues.SetValues(person);  // what if values are null, like ID, or DateCreated?
                }
                else
                {
                    entry.State = EntityState.Modified;
                }

            }
            SaveChanges();
            return person;
        } 
```

我的问题是：如果我只需要通过我的 webAPI 更新一个人的详细信息怎么办？是构造一个完整的 PersonDto 并使用 SetValues 更新整个对象的约定，还是有什么方法可以指定我只想要更新一个字段，这样我就不必通过网络发送大量数据（即我真的不需要）？

如果*可以*进行部分更新，那么何时更新整个实体最好？即使我必须更新 5/7 属性，它也需要我发送 2/7 的旧数据以重新写入，以便 SetValues 不会将空值从我的 DTO 写入我的字段。

这里的任何帮助都会很棒......对这些东西完全陌生，并尝试正确学习所有内容。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T05:20:07.650

我采用了类似的方法进行优化，并且在附加时遇到了同样的空值问题（不仅仅是空值，布尔值也会有问题）。这就是我想出的：

```
 public static void Update<T>(this DbContext context, IDTO dto)
        where T : class, IEntity
    {
        T TEntity = context.Set<T>().Local.FirstOrDefault(x => x.Id == dto.Id);
        if (TEntity == null)
        {
            TEntity = context.Set<T>().Create();
            TEntity.Id = dto.Id;
            context.Set<T>().Attach(TEntity);
        }
        context.Entry(TEntity).CurrentValues.SetValues(dto);
        var attribute = dto.GetAttribute<EnsureUpdatedAttribute>();
        if (attribute != null)
        {
            foreach (var property in attribute.Properties)
                context.Entry(TEntity).Property(property).IsModified = true;
        }
    } 
```

那是 DbContext 的扩展方法。下面是接口 IDTO 和 IEntity：

```
public interface IDTO
{
    int Id { get; set; }
}

public interface IEntity
{
    int Id { get; set; }

    Nullable<DateTime> Modified { get; set; }
    Nullable<DateTime> Created { get; set; }
} 
```

我正在使用我的自定义 EnsureUpdatedAttribute 来注释应始终更新哪些属性（以处理未跟踪的空值/默认值）：

```
public class EnsureUpdatedAttribute : Attribute
{
    public IEnumerable<string> Properties { get; private set; }

    public EnsureUpdatedAttribute(params string[] properties)
    {
        Properties = properties.AsEnumerable();
    }
} 
```

这是一个使用示例：

```
public class Sample : IEntity
{
    public int Id { get; set; }

    public string Name { get; set; }

    public bool Active { get; set; }

    public Nullable<DateTime> Modified { get; set; }
    public Nullable<DateTime> Created { get; set; }
}

[EnsureUpdated("Active")] /// requirement for entity framework change tracking, read about stub entities
public class SampleDTO : IDTO
{
    public int Id { get; set; }

    [Required]
    public string Name { get; set; }

    [JsonIgnore] /// How to exclude property from going on the wire / ignored for serialization
    public bool Active { get; set; }
}

    [HttpPost]
    public HttpResponseMessage SaveSample(SampleDTO dto)
    {
        dto.Active = true;
        _ctx.AddModel<Sample>(dto);
        _ctx.SaveChanges();
        return NoContent();
    } 
```

return NoContent() 只是返回 204 (NoContent) 的扩展。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T03:53:04.413

您有几个选项，您可以创建一个存储过程来更新所需的部分（我不会这样做），或者您可以在使用 EF 保存上下文更改之前手动选择要在模型上更新的文件。

下面是一个如何更新特定字段的示例：

```
public void UpdatePerson(int personId, string details)
{
  var person = new Person() { Id = personId, Details = details };   
  db.Persons.Attach(personId);
  db.Entry(person).Property(x => x.Details).IsModified = true;
  db.SaveChanges();
} 
```

这将取决于您想要做什么，但一般来说，发送您的整个实体进行更新是很好的，这就是我将如何处理您的情况，如果需要，将来可能会发生变化。

# eclim - Neocomplete 和 Eclim 不能一起工作

> ID：15329441
> 
> 赞同：3
> 
> 时间：2013-03-11T00:26:25.270
> 
> 标签：eclim, neocomplcache

使用默认设置，没有任何关于自动完成的显示，没有自动完成显示也没有`<C-X><C-U>`键，后来显示`"pattern not found"`，有没有人可以告诉我如何让它工作？

这是我的 vimrc 文件：

```
set nocompatible
syntax on
set laststatus=2
set encoding=utf-8
set guifont=Anonymous\ Pro\ for\ Powerline:h13
let g:Powerline_symbols = 'fancy'
if has("gui_running")
    set guioptions=egmrt
    set transparency=10
    set guifont=menlo:h14
endif

imap jj <Esc>
set autoindent
set tabstop=4
set shiftwidth=4
filetype off                   " required!

 set rtp+=~/.vim/bundle/vundle/
 call vundle#rc()

 " let Vundle manage Vundle
 " required! 
 Bundle 'gmarik/vundle'

 " My Bundles here:
 " original repos on github
 Bundle 'scrooloose/nerdtree'
 Bundle 'majutsushi/tagbar'
 Bundle 'tpope/vim-rails'
 Bundle 'Shougo/neocomplcache'
 Bundle 'nanotech/jellybeans.vim'
 Bundle 'Rip-Rip/clang_complete'
 Bundle 'osyo-manga/neocomplcache-clang_complete'
 colorscheme jellybeans
 Bundle 'godlygeek/tabular'
 Bundle 'Lokaltog/vim-powerline'
 Bundle 'tpope/vim-haml'
 Bundle 'nathanaelkane/vim-indent-guides'
 Bundle 'vim-ruby/vim-ruby'
 Bundle 'kchmck/vim-coffee-script'

 " vim-scripts repos
 Bundle 'DrawIt'
 Bundle 'tComment'
 Bundle 'sudo.vim'
 Bundle 'Align'

 " non github repos
 "Bundle 'git://git.wincent.com/command-t.git'

 filetype plugin indent on     " required!

 nmap 88 :TagbarToggle<CR>
 nmap 99 :NERDTreeToggle<CR>
" use neocomplcache & clang_complete

" add neocomplcache option
let g:neocomplcache_force_overwrite_completefunc=1

" add clang_complete option
 let g:clang_complete_auto=1

" Disable AutoComplPop. 
let g:acp_enableAtStartup = 0 
" Use neocomplcache. 
let g:neocomplcache_enable_at_startup = 1 
" Use smartcase. 
let g:neocomplcache_enable_smart_case = 1 
" Use camel case completion. 
let g:neocomplcache_enable_camel_case_completion = 1 
" Use underbar completion. 
let g:neocomplcache_enable_underbar_completion = 1 
" Set minimum syntax keyword length. 
let g:neocomplcache_min_syntax_length = 3 
let g:neocomplcache_lock_buffer_name_pattern = '\*ku\*' 

" Define dictionary. 
let g:neocomplcache_dictionary_filetype_lists = { 
    \ 'default' : '', 
    \ 'vimshell' : $HOME.'/.vimshell_hist', 
    \ 'scheme' : $HOME.'/.gosh_completions' 
    \ } 

" Define keyword. 
if !exists('g:neocomplcache_keyword_patterns') 
    let g:neocomplcache_keyword_patterns = {} 
endif 
let g:neocomplcache_keyword_patterns['default'] = '\h\w*' 

" Plugin key-mappings. 
imap <C-k>     <Plug>(neocomplcache_snippets_expand) 
smap <C-k>     <Plug>(neocomplcache_snippets_expand) 
inoremap <expr><C-g>     neocomplcache#undo_completion() 
inoremap <expr><C-l>     neocomplcache#complete_common_string() 

" SuperTab like snippets behavior. 
"imap <expr><TAB> neocomplcache#sources#snippets_complete#expandable() ? "\<Plug>(neocomplcache_snippets_expand)" : pumvisible() ? "\<C-n>" : "\<TAB>" 

" Recommended key-mappings. 
" <CR>: close popup and save indent. 
inoremap <expr><CR>  neocomplcache#smart_close_popup() . "\<CR>" 
" <TAB>: completion. 
inoremap <expr><TAB>  pumvisible() ? "\<C-n>" : "\<TAB>" 
" <C-h>, <BS>: close popup and delete backword char. 
inoremap <expr><C-h> neocomplcache#smart_close_popup()."\<C-h>" 
inoremap <expr><BS> neocomplcache#smart_close_popup()."\<C-h>" 
inoremap <expr><C-y>  neocomplcache#close_popup() 
inoremap <expr><C-e>  neocomplcache#cancel_popup() 

" AutoComplPop like behavior. 
"let g:neocomplcache_enable_auto_select = 1 

" Shell like behavior(not recommended). 
"set completeopt+=longest 
"let g:neocomplcache_enable_auto_select = 1 
"let g:neocomplcache_disable_auto_complete = 1 
"inoremap <expr><TAB>  pumvisible() ? "\<Down>" : "\<TAB>" 
"inoremap <expr><CR>  neocomplcache#smart_close_popup() . "\<CR>" 

" Enable omni completion. 
autocmd FileType css setlocal omnifunc=csscomplete#CompleteCSS 
autocmd FileType html,markdown setlocal omnifunc=htmlcomplete#CompleteTags 
autocmd FileType javascript setlocal omnifunc=javascriptcomplete#CompleteJS 
autocmd FileType python setlocal omnifunc=pythoncomplete#Complete 
autocmd FileType xml setlocal omnifunc=xmlcomplete#CompleteTags 

" Enable heavy omni completion. 
if !exists('g:neocomplcache_omni_patterns') 
let g:neocomplcache_omni_patterns = {} 
endif 
let g:neocomplcache_omni_patterns.ruby = '[^. *\t]\.\w*\|\h\w*::' 
"autocmd FileType ruby setlocal omnifunc=rubycomplete#Complete 
let g:neocomplcache_omni_patterns.php = '[^. \t]->\h\w*\|\h\w*::' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-17T06:55:03.097

把它放在你的 vimrc `let g:EclimCompletionMethod = 'omnifunc'` 查看[http://eclim.org/vim/code_completion.html](http://eclim.org/vim/code_completion.html)以获得更多信息。

# macos - /proc/uptime 在 Mac OS X 中

> ID：15329443
> 
> 赞同：9
> 
> 时间：2013-03-11T00:27:09.757
> 
> 标签：macos, uptime

我需要与 Linux 的“cat /proc/uptime”完全相同的输出。

例如，使用 /proc/uptime，你会得到

> 1884371.64 38646169.12

但是对于任何 Mac 替代品，例如“正常运行时间”，您都会得到

> 20:25 上 20:26，6 个用户，平均负载：3.19 2.82 2.76

我需要它与 cat /proc/uptime**完全**一样，但在 Mac OS X 上。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-14T01:33:09.877

知道了...

```
$sysctl -n kern.boottime | cut -c14-18
87988 
```

然后我将其转换为可读格式（不记得如何）：

> 1 天 00:26:28

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-11T01:00:20.653

Macintosh 上根本没有“/proc”目录。

[在 MacOS 上，您可以执行以下命令](https://stackoverflow.com/questions/3269321/osx-programmatically-get-uptime)：

```
sysctl kern.boottime 
```

你会得到这样的回应：

```
kern.boottime: { sec = 1362633455, usec = 0 } Wed Mar  6 21:17:35 2013 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-18T19:28:58.777

```
boottime=`sysctl -n kern.boottime | awk '{print $4}' | sed 's/,//g'`
unixtime=`date +%s`
timeAgo=$(($unixtime - $boottime))
uptime=`awk -v time=$timeAgo 'BEGIN { seconds = time % 60; minutes = int(time / 60 % 60); hours = int(time / 60 / 60 % 24); days = int(time / 60 / 60 / 24); printf("%.0f days, %.0f hours, %.0f minutes, %.0f seconds", days, hours, minutes, seconds); exit }'`
echo $uptime 
```

将返回类似 1 Day, 20 hours, 10 minutes, 55 seconds

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-03T07:43:51.103

这是我获取值而不是 Cut 方法的方法

```
sysctl kern.boottime | awk '{print $5}' 
```

其中 $5 是字符串的范围

例子

```
$1 Gives you "sysctl kern.boottime"
$2 Gives you "{"
$3 Gives you "sec" 
```

从字符串

```
kern.boottime: { sec = 1604030189, usec = 263821 } Fri Oct 30 09:26:29 2020 
```

# android - 从 ArrayAdapter 中启动 FragmentTransaction

> ID：15329451
> 
> 赞同：6
> 
> 时间：2013-03-11T00:28:05.090
> 
> 标签：android, android-fragments, android-arrayadapter

我有`ListView`几行。每行都有一个`button`.

我希望按钮启动一个 FragmentTransaction 来替换 ListView 所在的 Fragment。

但是，在 的`getView()`方法中`Adapter`，这一行不起作用：

`FragmentTransaction t = getContext().getSupportFragmentManager().beginTransaction();`

它不喜欢上下文。

*这可以通过这种方式完成还是交易必须在其他地方发生？*

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-10-09T10:32:42.337

首先在构造函数中获取上下文，然后尝试以下代码，

```
FragmentTransaction ft = ((FragmentActivity)context).getSupportFragmentManager().beginTransaction(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-03-11T01:18:20.457

`getSupportFragmentManager()`只为类定义`FragmentActivity`，不为`Context`. 因此，如果您尝试在 type 的对象上调用它，编译器将无法解析该调用`Context`。

您可以使用反射以安全的方式执行此操作。只要您将 FragmentActivity 作为`Context`. 注意：FragmentActivity 是 Context 的子类，因此您可以在任何可以传递 Context 的地方传递 FragmentActivity。

因此，请改用此代码：

```
if (getContext() instanceof FragmentActivity) {
    // We can get the fragment manager
    FragmentActivity activity = (FragmentActivity(getContext()));
    FragmentTransaction t = activity.getSupportFragmentManager().beginTransaction();
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-11T00:35:42.367

我建议你像这样将`FragmentManager`实例传递给`Adapter`构造函数：

```
public class YourAdapter extends...

    private FragmentManage mFragmentManager;        

    public YourAdapter(FragmentManager fm) {
        mFragmentManager = fm;
    } 
```

并明确使用它：

```
FragmentTransaction ft = mFragmentManager.beginTransaction(); 
```

`Adapter`这应该使您可以使用其中一个`Fragment.getFragmentManager()`或实例进行初始化`FragmentActivity.getSupportFragmentManager()`，因为它们指向同一个对象

# php - 通过删除功能删除特定记录

> ID：15329456
> 
> 赞同：0
> 
> 时间：2013-03-11T00:28:20.720
> 
> 标签：php

我的一个页面我称之为删除功能

```
$Sql=mysql_query("SELECT Id FROM products");
    $Result=mysql_fetch_row($Sql);
    $Id=$Result[0];
    DeleteRecords("products","Id",$Id) 
```

在functions.php上我在下面做了这个函数

```
function DeleteRecords($Table,$Exp,$Value)
{
if(isset($_GET['delete']))
{
$Sql="DELETE FROM $Table WHERE $Exp=$Value";
$Result=mysql_query($Sql);
if($Result)
    {
        echo "<script>alert('Record Deleted')</script>";
        echo "<script>window.location='products.php';</script>";    
    }
}
} 
```

现在，当我单击删除链接时：

```
<a href='".$_SERVER['PHP_SELF']."?delete=$Id'>Delete</a> 
```

它删除第一行。似乎 $Id 有问题

请帮助我如何删除我选择的行；

最好的办法是所有的事情都应该在函数中完成，我只需要在我的页面上调用函数！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:35:26.357

您选择所有产品：

```
$Sql=mysql_query("SELECT Id FROM products"); 
```

然后将第一个元素的 id 分配给`$Id`：

```
$Id=$Result[0]; 
```

然后你传递`$Id`给你的函数 - 在那里调用相同的值`$Value`：

```
DeleteRecords("products","Id",$Id) 
```

最后在您的函数中检查是否`$_GET['delete']`已设置。如果是，则`$Id`在删除查询之前使用结果的第一个元素（而不是传递的值`$_GET['delete']`：

```
$Sql="DELETE FROM $Table WHERE $Exp=$Value"; 
```

所以你永远不会使用`$_GET['delete']`.

* * *

你可以写：

```
 DeleteRecords("products","Id", $_GET['delete']); 
```

并在函数中：

```
$Value = intval($Value);

if (0 != $Value) {
    $Sql="DELETE FROM $Table WHERE $Exp=$Value";
    $Result=mysql_query($Sql);
    […] 
```

这至少可以防止 SQL 注入。并非适用于所有情况，而是一个起点。[有一个关于“Bobby Tables”](http://bobby-tables.com)的不错的网站可以为您提供更多相关信息。

# matlab - 在 matlab 中的 x 和 y 轴上显示相似的值

> ID：15329460
> 
> 赞同：1
> 
> 时间：2013-03-11T00:28:46.370
> 
> 标签：matlab, matrix, matching, scatter

我有如下矩阵；从计算中会有一些值在图中绘制时彼此具有相同的值（我使用散点图），![绘制时的冗余值](../Images/f8f6f07fee8961ff068548cde47aaa28.png) 这里的问题是如何知道/识别哪个计算给出了匹配数据并且可以将它存储在桌子。我曾尝试在 matlab 中使用 find 函数，但出现错误。

```
A = [2/3 -1/3 -1/3;
    -1/3 2/3 -1/3;
    -1/3 -1/3 2/3];
B=[0 0 0;
    0 0 1;
    0 1 0;
    0 1 1;
    1 0 0;
    1 0 1;
    1 1 0;
    1 1 1];
d= [2/3 -1/3 -1/3];
q = [0 0.5773 -0.5773];
for i = 1:size(B,1)
    p1 =  A * B(1,:)' -A * B(i,:)';
    dtransformation0a(i) = d*p1;
    qtransformation0a(i) = q*p1;
    p2 =  A * B(2,:)' -A * B(i,:)'
    dtransformation0b(i) = d*p2;
    qtransformation0b(i) = q*p2;
     p3 =  A * B(3,:)' -A * B(i,:)';
    dtransformation0c(i) = d*p3;
    qtransformation0c(i) = q*p3;
    p4 =  A * B(4,:)' -A * B(i,:)';
    dtransformation0d(i) = d*p4;
    qtransformation0d(i) = q*p4;
    p5 =  A * B(5,:)' -A * B(i,:)';
    dtransformation0e(i) = d*p5;
    qtransformation0e(i) = q*p5;
    p6 =  A * B(6,:)' -A * B(i,:)';
    dtransformation0f(i) = d*p6;
    qtransformation0f(i) = q*p6;
end
figure
 scatter(dtransformation0a,qtransformation0a,100,'b.')
hold on
scatter(dtransformation0b,qtransformation0b,100,'b.')
hold on 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T04:13:25.030

我现在无法访问 MATLAB 解释器，所以我无法自己测试它，但这应该可以：

```
A = [2/3 -1/3 -1/3;
    -1/3 2/3 -1/3;
    -1/3 -1/3 2/3];
B = [0 0 0;
    0 0 1;
    0 1 0;
    0 1 1;
    1 0 0;
    1 0 1;
    1 1 0;
    1 1 1];
d = [2/3 -1/3 -1/3];
q = [0 0.5773 -0.5773];
for i = 1:size(B,1)
    p1 =  A * B(1,:)' -A * B(i,:)';
    dtransformation0a(i) = d*p1;
    qtransformation0a(i) = q*p1;
    p2 =  A * B(2,:)' -A * B(i,:)'
    dtransformation0b(i) = d*p2;
    qtransformation0b(i) = q*p2;
     p3 =  A * B(3,:)' -A * B(i,:)';
    dtransformation0c(i) = d*p3;
    qtransformation0c(i) = q*p3;
    p4 =  A * B(4,:)' -A * B(i,:)';
    dtransformation0d(i) = d*p4;
    qtransformation0d(i) = q*p4;
    p5 =  A * B(5,:)' -A * B(i,:)';
    dtransformation0e(i) = d*p5;
    qtransformation0e(i) = q*p5;
    p6 =  A * B(6,:)' -A * B(i,:)';
    dtransformation0f(i) = d*p6;
    qtransformation0f(i) = q*p6;
end

X = [dtransformation0a, dtransformation0b];    %Assuming dtransformation0a and dtransformation0b are row martices.
Y = [qtransformation0a, qtransformation0b];    %Assuming qtransformation0a and qtransformation0b are row martices.
my_points = [X';Y'];    %Each row of my_points will represent a particular point.
my_points = unique(my_points, 'rows');    %Get unique rows, hence points.

figure
scatter(my_points(:,1),my_points(:,2),100,'b.') 
```

如果您遇到任何问题，请告诉我。

**

## 编辑！！

**

根据您的要求，我的理解是您想要显示那些产生值的计算，例如`(0,0)`，如果这确实是您想要的，您应该能够通过将循环部分替换为：

```
my_point = [0, 0];
for i = 1:size(B,1)
    p1 =  A * B(1,:)' -A * B(i,:)';
    dtransformation0a(i) = d*p1;
    qtransformation0a(i) = q*p1;
    p2 =  A * B(2,:)' -A * B(i,:)'
    dtransformation0b(i) = d*p2;
    qtransformation0b(i) = q*p2;
     p3 =  A * B(3,:)' -A * B(i,:)';
    dtransformation0c(i) = d*p3;
    qtransformation0c(i) = q*p3;
    p4 =  A * B(4,:)' -A * B(i,:)';
    dtransformation0d(i) = d*p4;
    qtransformation0d(i) = q*p4;
    p5 =  A * B(5,:)' -A * B(i,:)';
    dtransformation0e(i) = d*p5;
    qtransformation0e(i) = q*p5;
    p6 =  A * B(6,:)' -A * B(i,:)';
    dtransformation0f(i) = d*p6;
    qtransformation0f(i) = q*p6;

    if(dtransformation0a(i)==my_point(1))
        fprintf("dtransformation0a => (%f = %f * %f;)\n",dtransformation0a(i),d,p1);
    end
    if(dtransformation0b(i)==my_point(1))
        fprintf("dtransformation0b => (%f = %f * %f;)\n",dtransformation0b(i),d,p2);
    end
    if(qtransformation0a(i)==my_point(2))
        fprintf("qtransformation0a => (%f = %f * %f;)\n",qtransformation0a(i),q,p1);
    end
    if(qtransformation0b(i)==my_point(2))
        fprintf("qtransformation0b => (%f = %f * %f;)\n",qtransformation0b(i),q,p2);
    end
end 
```

我希望这就是你要找的。

# html - 背景和菜单栏在更宽的屏幕上变得不成比例......我不想要这个

> ID：15329461
> 
> 赞同：0
> 
> 时间：2013-03-11T00:28:55.930
> 
> 标签：html, css, background, menubar

我一直在研究，但我不确定如何寻找我想要的东西。我在我的第一学期 HTML 和 CSS。我的页面在我的 15 1/2 英寸显示器上看起来很棒……但是当我将它移动到我的 19 1/2 显示器时，它会将背景图像的另一部分添加到右侧，并将菜单栏延伸到整个距离。我在寻找什么代码可以使页面在更宽的屏幕上保持完整，也许在每一侧添加彩色（或空白）边框？谢谢您的帮助。

感谢 Brad 和 Fiddle 的帮助。不重复有助于背景，但是，在更大的显示器上，我的菜单栏想要清晰地穿过，并且 .box 和 img.posit 想要坚持到最左侧。我宁愿他们根据背景图像保持测量。

样式表：

```
body    {font-family:Arial, Verdana, Garamond; 
        background-image: beach.jpg; background-repeat: no-repeat; background-position: center;}

a       {text-decoration: none;
        color: #FF4D10; font-size: 14pt;}

a:hover {background-color: white;}

.menu   {position:center;
        text-align: center;
        width: 100%; margin: 0; text-decoration: none;}

        .menuword   {width: 10%; background-color: beach.jpg; font-weight: 500; text-decoration: none;}

        .menuwordselect {width: 10%; font-weight: bolder; font-style: italic; text-decoration: none;}

        .menupipe   {width: 0%; font-weight: bolder;}

.box        {width: 400px; margin-left: 25px; margin-top: 100px; border-radius: 7px; background-color: #ffff9c; padding: 10px; color: #303032;}
            /* set styles for class named box to position the image */      

img.posit   {position: relative; left: 550px; top: -435px }
            /* sets styles for class named posit to position the image */ 
```

我真的很感谢你的帮助:)

布拉德...这是页面的代码...

```
<body background="beach.jpg">
<div style="text-align: center;">
    <img src="Oahu banner.jpg" width="995" height="295">

    <table class="menu">
            <tr>
                <td class="menuword"><a href="sitemap.html">Waikiki</a></td>
                <td class="menupipe">|</td>
                <td class="menuword"><a href="script.html">North Shore</a></td>
                <td class="menupipe">|</td>
                <td class="menuword"><a href="cast.html">Cultural and Historical</a></td>
                <td class="menupipe">|</td>
                <td class="menuword"><a href="costumes.html">Best Deal Ever</a></td>
                <td class="menupipe">|</td>
                <td class="menuword"><a href="set.html">More Info</a></td>
                <td class="menupipe">|</td>
                <td class="menuword"><a href="props.html">Site Map</a></td>

            </tr>
    </table>

</div>

<div>
    <p class="box">Oahu known as "The Gathering Place", is the third largest of the Hawaiian Islands and home to more than 950,000 people, almost 75% of the U.S. state of Hawaii's population. The state capital, Honolulu, is on Oahu's southeast coast. In the greatest dimension, this volcanic island is 44 miles (71 km) long and 30 miles (48 km) across. The length of the shoreline is 227 miles (365 km). The island is the result of two separate shield volcanoes: Wai'anae and Ko'olau, with a broad "valley" or saddle, the Oahu Plain between them. The highest point is Mt. Ka'ala in the Wai'anae Range, rising to 4,003 feet (1,220 m) above sea level.
    <br><br>
    But there is more to Oahu than just height and width.  Honolulu, the state's capital, not only displays an impressive skyline of highrises, but also the beautiful beach of Waikiki, where Duke Kahanamoku "the father of surfing" developed his surfing and swimming skills.  
    <br><br>Across the pineapple fields at the middle of the island, the North Shore is home to modern day world renown surfing competitions, prolific fruit plantations and a quiet, rural lifestyle for many residents.
    <br><br>The cultural heritage of the native peoples is richly preserved in many world class museums, libraries and attractions.  Pearl Harbor as an important piece of our American history is a must see stop for all visitors.

    <br><br>There is something for everyone on this beautiful tropical island.  Come vist and Hang Loose in Oahu!</p>

    <img  class="posit" src="waterfallbig.jpg" width="513" height="386" alt="Waterfall" />
</div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:57:51.253

您需要[background-repeat: no-repeat](http://www.w3schools.com/cssref/pr_background-repeat.asp)因为默认情况下背景图像垂直和水平重复。

对于您问题的第二部分，听起来您想要[background-position: center](http://www.w3schools.com/cssref/pr_background-position.asp)。这将使图像垂直和水平居中，在图像周围留出空间。或者，您可以将[背景颜色](http://www.w3schools.com/cssref/pr_background-color.asp)设置为您想要的任何颜色。

**CSS**

```
background: url("http://placehold.it/300x18") no-repeat center (whatever color you want); 
```

[JSFiddle](http://jsfiddle.net/EEGQ5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T05:22:15.153

你也可以试试这个，它将整个页面定位在中心，与屏幕大小无关

*{ 边距：1px 自动；

}

# google-api - Google 地球移动版中的动态数据

> ID：15329464
> 
> 赞同：0
> 
> 时间：2013-03-11T00:29:28.177
> 
> 标签：google-api, kml, google-earth, google-earth-plugin

有什么方法可以构建一个基于谷歌地球的移动应用程序，可以显示动态（周期性变化）数据？

这是我发现的

*   没有适用于移动设备（iOS、Andriod）的 GE 插件，因此 Javascript API 已退出
*   没有受支持的原生 API
*   NetworkLink RefreshInterval KML 在移动版本上不起作用（我无法让 NetworkLink KML 元素的任何部分工作）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T18:05:10.953

[NetworkLinkControl 更新](https://developers.google.com/kml/documentation/kmlreference#update)确实适用于移动设备的 Google 地球应用程序。

1.  从 Internet 加载 KML - 在此 KML 中，有`NetworkLink`如下内容：

    ```
    <NetworkLink>
        <name>Update</name>
        <Link>
            <href>URL of Updating KML</href>
            <refreshMode>onInterval</refreshMode>
            <refreshInterval>20</refreshInterval>
        </Link>
    </NetworkLink> 
    ```

因此，GE 每 20 秒尝试加载“更新 KML 的 URL”

1.  创建“更新 KML” - 它将包含`<Update>`以下命令：

    ```
     <NetworkLinkControl>
           <Update>
                <targetHref>URL of initial KML (one to make changes to)</targetHref>
                     <Change>
                          <Placemark targetId="placemarkID">
                               <visibility>0</visibility>
                          </Placemark>
                     </Change>
           </Update>
      </NetworkLinkControl> 
    ```

该示例将查找 ID 为“placemarkID”的地标并将其可见性更改为 0（不可见）

我的示例是使用更新的[更改](https://developers.google.com/kml/documentation/kmlreference#change)功能，还有`Create`和`Delete`

这是使用的Google[示例](https://developers.google.com/kml/documentation/updates)`Updates`

# linux - 如何显示文件的第二行并将字符转换为大写

> ID：15329466
> 
> 赞同：0
> 
> 时间：2013-03-11T00:29:38.603
> 
> 标签：linux, shell

```
/home/msabbar/sample_dir2
`-- sample_dir
    |-- admin
    |-- cambridge
    |   |-- cafeteria
    |   |-- library
    |   `-- security
    |       |-- annex
    |       |-- building
    |       `-- parking
    |-- faculty
    |-- history.exe
    |-- markham
    |   |-- annex
    |   |-- building1
    |   `-- parking
    `-- stenton
        |-- gen_ed
        |   |-- Holidays
        |   `-- cars2
        |-- lib_arts
        |   |-- english.txt
        |   `-- match.doc
        `-- phone_directory 
```

11 个目录，12 个文件

您当前的目录是 sample_dir。显示文件 cars2 的第 2 行，转换为大写（提示：以 'head' 命令开头）：

好吧，我做到了

```
head -2 | tr "[a-z]" "[A-Z]" < stenton/gen_ed/cars2 
```

和

```
head -n 2 | tr "[a-z]" "[A-Z]" < stenton/gen_ed/cars2 
```

但这是错误的

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:36:18.980

我想你想做：

```
 head -2 your_file | tail -1 | tr "[a-z]" "[A-Z]" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:36:24.923

我可以忽略提示吗（我猜是你的作业）？

```
awk 'NR==2 {print toupper($0);exit}' stenton/gen_ed/cars2 
```

或者

```
sed -n 'n;s/.*/\U&/p;q' stenton/gen_ed/cars2 
```

# c++ - 向量中的移动元素未按预期工作

> ID：15329469
> 
> 赞同：3
> 
> 时间：2013-03-11T00:29:48.603
> 
> 标签：c++, algorithm, templates, c++11

我正在尝试将每个具有 x 值的元素移动到向量的开头，以便所有具有 x 值的元素都在向量的前面，但是它不起作用，所以你能告诉我我做了什么请问错了吗？

```
#include <iostream>
#include <algorithm>
#include <vector>

using namespace std;

template <typename Container, typename Arg>
void move_x(Container& c, Arg x)
{
    typename Container::iterator it = find(c.begin(), c.end(), x);
    if (it!=c.end()) {
        c.insert(c.begin(), *it);
       remove (it, c.end(), x);
    }
}
int main()
{
    int x=1;
    vector <int> v{1,2,4,6,7,1,3,1,1,8,9};

    move_x(v, x);
    for(auto i:v)
        cout<<v[i];

    return 0;
} 
```

当我运行它时，我得到了这个输出

```
411613848811 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:36:43.623

插入容器后，迭代器不再有效

```
 c.insert(c.begin(), *it); // This invalidates 'it'    
    remove (it, c.end(), x); // oops! trying to use invalid iterator 
```

Using`std::rotate`提供了更好的选择，它不会使迭代器无效：

```
template <typename Container, typename Arg>
void move_x(Container& c, Arg x)
{
    typedef typename Container::iterator It;
    It write_it = c.begin(), read_it = c.begin();
    for (;;) {
        It found_it = find(read_it, c.end(), x);
        if (found_it==c.end()) break;
        read_it = found_it;
        ++read_it;
        std::rotate(write_it,found_it,read_it);
        ++write_it;
    }
} 
```

只要您处理像整数这样的简单项目，这是一个好方法：

```
template <typename Container, typename Arg>
void move_x(Container& c, Arg x)
{
    typename Container::reverse_iterator it = std::remove(c.rbegin(),c.rend(),x);

    for (;it!=c.rend();++it) {
        *it = x;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:44:43.437

这是您在代码中的固定实现：

```
template <typename Container, typename Arg>
void move_x(Container& c, Arg x)
{
    typename Container::iterator it = find(c.begin(), c.end(), x);
    if (it!=c.end()) {
       c.erase(it);
       c.insert(c.end(), x);
    }
} 
```

您的实现的一个问题是，[除了结尾之外的](http://www.cplusplus.com/reference/vector/vector/insert/)`insert`任何地方都可能导致重新分配，并且无论如何都会在插入位置之后使任何内容无效。因此，根据定义，因为您在开头插入将无效。`it`

第二个问题是`cout<<v[i];`它实际上应该是`cout<<i;`。

一个更好的实现，它使用反向迭代器并移动所有`x`s。这个会随着它的进行擦除并保留一个`count`，然后`count`在完成时插入。使用[带有反向迭代器的擦除](https://stackoverflow.com/questions/1830158/how-to-call-erase-with-a-reverse-iterator)有点棘手：

```
template <typename Container, typename Arg>
void move_all_x(Container& c, Arg x)
{
    unsigned int count = 0 ;

    for( typename Container::reverse_iterator it = c.rbegin() ; it != c.rend(); )
    {
       if( *it == x )
       {
         c.erase(--(it++).base() ) ;
         ++count ;
       }
       else
       {
          ++it ;
       }
    }

    for( unsigned int i = 0; i < count; ++i )
      {
         c.insert(c.begin(), x) ;
      }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T02:11:33.167

您可以使用 std::partition，它将范围内满足给定谓词的所有元素移动到范围的开头，并将迭代器返回到不满足谓词的第一个元素。

```
template <typename Container, typename Arg>
void move_x(Container& c, Arg x)
{
    typename Container::iterator endrange = 
        std::partition(c.begin(), c.end(), [&x](Arg ele){ return ele == x; });
} 
```

在这种情况下，我们没有使用返回值，但我认为它可能会有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T00:46:48.430

输出错误。应该`for (auto i:v) cout << i;`没有`v[i]`。你也会用正确的算法看到垃圾

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-11T00:58:41.223

您需要一个循环来处理所有匹配项（或使用计数和插入）。`v`定义为`list<int>`：

```
template <typename Container, typename Arg>
void move_x(Container& c, Arg x)
{
  for (auto it = find(c.begin(), c.end(), x); 
       it != c.end(); 
       it = find(it, c.end(), x)) {
    c.insert(c.begin(), x); 
    it = c.erase(it);
  }
} 
```

# elfinder - 覆盖 elFinder 中的“打开”菜单项

> ID：15329471
> 
> 赞同：2
> 
> 时间：2013-03-11T00:29:56.500
> 
> 标签：elfinder

我正在使用[elFinder](http://elfinder.org)访问网站上的一些存储文件，但这些文件本身不能直接访问。相反，我通过特定的控制器操作请求它们。所以我覆盖了`getFileCallback`elFinder 以使用自定义 URL：

```
getFileCallback: function (file) {
    window.location.href = '@Url.Action("File", "Home")' + '?path=' + encodeURI(file);
} 
```

这非常适合双击文件。但是，如果我只是选择文件并使用 elFinder 工具栏中的打开按钮，则不会使用此回调。相反，它会打开一个弹出窗口并尝试使用默认 URL，这会导致 404 错误。

有没有办法覆盖工具栏中“打开”按钮的行为？我一直在[Client event API](https://github.com/Studio-42/elFinder/wiki/Client-event-API)或[commands options](https://github.com/Studio-42/elFinder/wiki/Client-configuration-options#wiki-commandsOptions)中尝试各种事情，但似乎找不到任何修改 Open 行为的东西。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T00:17:09.420

我最终做的是完全覆盖 open 函数：

```
elFinder.prototype.commands.open = function () {
    // custom code
}; 
```

（只需`script`在加载 elFinder 代码后在一个块中执行此操作。）

我不能说它是否理想，如果 elFinder 有重大升级，则需要进行一些调整，但它绝对可以完成工作。（从这里开始，我还开始覆盖其他一些使用 URL 的函数，例如信息弹出窗口中的锚标记。）

# list - 为什么python中的空列表的长度为3？

> ID：15329472
> 
> 赞同：0
> 
> 时间：2013-03-11T00:30:09.337
> 
> 标签：list, python-3.x

当我输入

```
list = []

print(len(list)) 
```

它打印出来`3`，不是`0`。

有谁知道为什么会这样？

我正在使用python 3.3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T12:58:49.223

好吧，获得该结果的一种方法是以下方式：

```
>>> len = lambda x : 3
>>> print(len(list))
3 
```

要弄清楚您的情况发生了什么，请检查 print、len 和 list 是什么。他们*应该*是这样的：

```
>>> print
<built-in function print>
>>> len
<built-in function len>
>>> list
<class 'list'>
>>> 
```

请注意，您在示例中执行

```
>>> list = [] 
```

这不是一个好的做法，因为您现在会覆盖其中一个内置插件。这行得通，而且是允许的，但它可能会令人困惑。

# php - 使用 cURL 和 PHP 的 Basecamp API

> ID：15329476
> 
> 赞同：0
> 
> 时间：2013-03-11T00:30:19.777
> 
> 标签：php, curl, basecamp

我正在尝试使用 PHP + cURL 连接到 basecamp api (json)，但我所有的尝试都失败了，我不知道为什么。最终目标是构建一个仪表板，通过 http 将来自 basecamp 项目的信息显示给团队成员。

```
<?php 
$basecamp_url = 'https://basecamp.com/xxxxxx/api/v1';
$username = 'username';
$password = 'pass';

$session = curl_init();
curl_setopt($session, CURLOPT_URL, $basecamp_url.'/projects.xml');
curl_setopt($session, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
curl_setopt($session, CURLOPT_HTTPGET, 1);
curl_setopt($session, CURLOPT_HEADER, false);
curl_setopt($session, CURLOPT_HTTPHEADER, array('Accept: application/json', 'Content-Type: application/json'));
curl_setopt($session, CURLOPT_RETURNTRANSFER, true);
curl_setopt($session,CURLOPT_USERPWD,$username . ":" . $password);
$response = curl_exec($session);
curl_close($session);

echo '<pre>';
print_r($response);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T20:25:02.213

我正在从事一个与您现在非常相似的项目。您必须先创建一个 Basecamp 应用程序。比以下代码应该让您建立联系：

```
$appName = 'your app name';
$appContact = 'your app email;

$basecampAccountId = 'xxxxx';
$basecampUsername = 'youremailhere';
$basecampPassword = 'yourpassword here';
$baseUrl = "https://basecamp.com/$basecampAccountId/api/v1";

$url= $baseUrl.'/projects.json';
$credentials = "$basecampUsername:$basecampPassword";
$helloHeader = "User-Agent: $appName ($appContact)";

echo $url.'<br>';
echo $credentials.'<br>';
echo $helloHeader.'<br>';

$ch = curl_init($url);
    curl_setopt($ch, CURLOPT_USERPWD, $credentials);
    curl_setopt($ch, CURLOPT_HEADER, true);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
    curl_setopt($ch, CURLOPT_MAXREDIRS, 3);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, true);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);
    curl_setopt($ch, CURLOPT_TIMEOUT, 30);

    curl_setopt($ch, CURLOPT_HTTPGET, true);
    curl_setopt($ch, CURLOPT_HTTPHEADER, array($helloHeader));

    $response = curl_exec($ch);
    $errno = curl_errno($ch);
    $error = curl_error($ch);
    curl_close($ch);

    print_r($response); 
```

# java - 如何从一组静止图像和 Java 中的音频文件构建 mp4

> ID：15329485
> 
> 赞同：0
> 
> 时间：2013-03-11T00:31:49.267
> 
> 标签：java, mp4

我想拍摄一些静止图像和一个音频文件并将它们转换为 mp4 文件。我最熟悉java，所以我更喜欢在其中进行编码。有什么方法可以做到这一点，或者我应该研究任何库吗？我查看了 mp4parser，但看不到如何做我正在寻找的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:37:45.440

有理由在java中这样做吗？像 ffmpeg 这样的东西可以做到这一点，但它是一个命令行工具。

好吧，也是一个 C++ 库。我猜它也有一个 Java 绑定：[https ://code.google.com/p/jjmpeg/](https://code.google.com/p/jjmpeg/)

就此而言，您可以查看 ffmpeg 源代码，了解他们在这里做什么：

ffmpeg -start_number n -i test_%d.jpg -vcodec mpeg4 test.mp4

多路复用一些音频，然后你就走了。无论如何，我就是这样开始的。也许其他人会提供更好的细节。

# c++ - 在 C++ 中，如何在静态数组的末尾添加一个链表？

> ID：15329486
> 
> 赞同：1
> 
> 时间：2013-03-11T00:31:50.480
> 
> 标签：c++, linked-list

```
using namespace std;

struct Package_Node
{
    int bar_code;
    float package_weight;
    struct Package_Node *next_packaged;
};

struct Key_Node
{
    int key;
    struct Package_Node *next_package;
};

Key_Node *keyMain=0;

int weightTemp=0,barcodeTemp=0,keyTemp=0,N=0,X=0,max_value=0,optionChosen=0,optionChosenTwo=0;
float tempWeight;

int main()
{
    srand(time(NULL));
    do
    {
        cout << "1 - Enter Number of keys and the Max Value\n2 - Enter Number of Packages (N)\n";
        cout << "3 - Create Array of Keys\n4 - Organize Packages\n5 - Table Stats\n6 - Clean Table\n7 - Exit\n\n";
        cin >> optionChosen;
        switch(optionChosen)
        {
        case 1://entering keys and max values
        {
            cout << "\nEnter Number of Keys: ";
            cin >>X;
            cout <<"\nEnter Max Value of the Barcode: ";
            cin >>max_value;
            break;
        }
        case 2://enter number of packages.
        {
            cout << "\nEnter Number of Packages: ";
            cin >> N;
            break;
        }
        case 3://create array of keys.
        {
            //Key_Node *keyMain = new Key_Node[X];
            keyMain= new Key_Node[X];
            for(int i=0;i<X;i++)
            {
                keyMain[i].key=i;
                cout << keyMain[i].key<<endl;
            }

            break;
        }
        case 4:
        {

                for(int i=0;i<N;i++)
                {
                    barcodeTemp = rand() % max_value + 1;

                    keyTemp = barcodeTemp % X;

                    tempWeight = rand() % 500 + 1;

                    keyMain[keyTemp] = new Package_Node;

                    Package_Node->bar_code=barcodeTemp;
                    Package_Node->package_weight=tempWeight;
                    Package_Node->next_packaged=NULL;

                }
                for(int i=0;i<N;i++)
                {
                    cout << totalPackages[i].bar_code <<endl;
                    cout << totalPackages[i].package_weight << endl;
                }

                cout << keyTemp;
            break;
        }
        case 5:
        {
            break;
        }
        case 6:
        {
            break;
        }
        default:
        {
            break;
        }
        }
    }while(optionChosen!=7);
} 
```

我在这里有点困惑。`keyMain`是一个静态数组。`keyMain[1]`等`keyMain[2]`将指向使用`Package_Node`. 将添加的索引由`keyMain`确定。但这似乎相去甚远。好像我写的代码不起作用。我在这里做错了什么？有任何想法吗？请不要使用向量，因为这是一个课堂项目，我们根本不会谈论向量。`new package_node``keyTemp`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:06:20.580

在您的代码中，您尝试这样做：

```
keyMain[keyTemp] = new Package_Node;

Package_Node->bar_code=barcodeTemp;
Package_Node->package_weight=tempWeight;
Package_Node->next_packaged=NULL; 
```

那是行不通的。这是基本思想：

```
Package_Node *n = new Package_Node;
n->bar_code = barcodeTemp;
n->package_weight = tempWeight;
n->next_packaged = NULL;
keyMain[keyTemp].next_package = n; 
```

现在，您的`Key_Node`数组中的每个项目都有一个单元素列表。如果您想添加到这些列表中，则适用基于列表的常规算法。

但看起来您正试图将其用作哈希数组。这意味着您要附加（或前置）到您的列表中。前置使代码更具可读性。我会这样做，如果你想追加，那么这对你来说是一个练习。

```
// Do this instead of setting it to NULL (from previous code example)
n->next_packaged = keyMain[keyTemp].next_package; 
```

在上面的示例中，您必须`next_package`在创建`keyMain`数组时初始化为 NULL。目前你不这样做。[由于这是 C++，因此熟悉RAII](https://stackoverflow.com/questions/2321511/what-is-meant-by-resource-acquisition-is-initialization-raii)是一个好主意。

最后，下面的代码没有意义：

```
for(int i=0;i<N;i++)
{
    cout << totalPackages[i].bar_code <<endl;
    cout << totalPackages[i].package_weight << endl;
} 
```

您需要做的（除非您在某处存储一个名为 的数组`totalPackages`）是遍历您的`keyMain`数组并打印出所有列表：

```
for(int i=0;i<X;i++)
{
    Package_Node *p = keyMain[i].next_package;
    while( p != NULL ) {
        cout << p->bar_code << endl;
        cout << p->package_weight << endl;
        p = p->next_packaged;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T01:09:15.040

这部分看起来不正确

```
keyMain[keyTemp] = new Package_Node;
Package_Node->bar_code=barcodeTemp;
Package_Node->package_weight=tempWeight;
Package_Node->next_packaged=NULL; 
```

它应该是这样的

```
keyMain[keyTemp].next_package = new Package_Node;
keyMain[keyTemp].next_package->bar_code=barcodeTemp;
keyMain[keyTemp].next_package->package_weight=tempWeight;
keyMain[keyTemp].next_package->next_packaged=NULL; 
```

还有你计算 keyTemp 的方式

```
barcodeTemp = rand() % max_value + 1;    
keyTemp = barcodeTemp % X; 
```

似乎不正确，因为取决于您为 max_value 输入的内容，它可能大于 X，即您的数组的大小。

# opencv - OpenCV 是否能够更改为复合输入？

> ID：15329492
> 
> 赞同：3
> 
> 时间：2013-03-11T00:32:14.823
> 
> 标签：opencv, v4l2, v4l

我想知道 OpenCV 是否能够将相机（dev/video1）设置为复合或 S-video 输入。

我使用的相机仅在复合输入中运行，但 v4l2 默认在 S-Video 输入中打开 dev/video1。V4l2 能够通过 QT V4l2 utils 应用程序从 S-video 更改为复合输入。

opencv 使用 v4l 从相机捕获图像，我想使用 OpenCV 更改为代码中的复合输入。那可能吗？如果不是，解决这个问题的方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-28T12:11:02.690

您只需使用“v4l2-ctl”更改输入！例如，我在我的树莓上使用 Python 来使用 OpenCV 从 S-Video 捕获视频流：

```
 import cv, os

    print "Initializing video capture from /dev/video0 ..."
    capture = cv.CaptureFromCAM(0)
    cv.SetCaptureProperty(capture,cv.CV_CAP_PROP_FRAME_WIDTH, 720)
    cv.SetCaptureProperty(capture,cv.CV_CAP_PROP_FRAME_HEIGHT, 576)

    print "Configuring video capture (V4L2) ..."
    os.system("v4l2-ctl -d /dev/video0 -i 5 -s 4 --set-fmt-video=width=720,height=576,pixelformat=4") 
```

和 ：

*   -d ：设备（在我的情况下是 /dev/video0），
*   -i：输入。对于我的 Easycap（0 = CVBS0；1 = CVBS1；2 = CVBS2；3 = CVBS3；4 = CVBS4；5 = S-VIDEO）
*   -s：规范（0 = PAL_BGHIN；1 = NTSC_N_443；2 = PAL_Nc；3 = NTSC_N；4 = SECAM；5 = NTSC_M；6 = NTSC_M_JP；7 = PAL_60；8 = NTSC_443；9 = PAL_M；）

# ios - 如何使用 NSTimer 在特定时间执行操作？

> ID：15329496
> 
> 赞同：1
> 
> 时间：2013-03-11T00:33:14.740
> 
> 标签：ios, nsdate, nstimer, uilocalnotification

我正在尝试在一天中的某个时间执行一项操作。

我不想使用`UILocalNotification`，因为如果发生任何事情，我不希望用户离开。

我目前的代码是：

```
[NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(fire:) userInfo:nil repeats:NO]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T13:02:51.067

你可以：

1.  每次您的应用开始使用`[NSDate date]`in`application:didFinishLaunchingWithOptions`方法时提取当前本地时间。

2.  使用计算*警报时间*的剩余时间`dateWithTimeInterval:sinceDate`。

3.  以. `NSTimer`_`interval = that_time_difference`

我不确定你是什么意思：

> “我不希望用户远离任何发生的事情。”

我假设如果应用程序未运行，您不希望发生任何事情。我唯一能想到的就是推送通知。

# regular-language - 一种语言可以接受无限数吗

> ID：15329497
> 
> 赞同：0
> 
> 时间：2013-03-11T00:33:24.457
> 
> 标签：regular-language, turing-machines, dfa, computation-theory

我有一个问题，一种语言是否可以接受无限数

我必须将 Lempty 减少到 Linf

```
where Lempty ={e|L(Pe) is null}
Linf={e|L(Pe) is infinite} 
```

所以我可以像这样定义一个程序 P

```
"
input n
Run Pe on 1...n for n steps
if Pe accept any number then enter an infinite loop and start accepting infinite number
if pe does not accept any number then accept 1" 
```

现在，如果我可以像上面那样定义程序 P，那么询问 P 接受的语言是否属于 Linf 的问题将告诉我 Pe 接受的语言是否为空。

任何意见或建议总是受欢迎的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T00:54:36.597

这个问题有点不明确，但这是一个近似值：在标准计算理论中，语言不能包含无限字符串。无限数不清楚。如果您的意思是一个**需要**无限位数字才能精确表示的数字，则不。标准自动机无法识别无限长的字符串（它怎么会终止？）。但是，许多**似乎需要**无限位数字（将三分之一视为 .3333333...）的数字不需要无限位字符来表示，因此它们是任何语言的候选者。

希望对您有所帮助，具体取决于您的要求。

# android - 如果时区不正确，时间返回错误值

> ID：15329502
> 
> 赞同：0
> 
> 时间：2013-03-11T00:34:00.797
> 
> 标签：android, time, calendar

如果设备的时区不正确，时间将返回不正确的值，而日历将起作用。我的应用程序是使用 Time 构建的，我想保留它，但我需要修复时区问题。

```
Calendar c = Calendar.getInstance(); 
String out= c.get(Calendar.HOUR)+":"+c.get(Calendar.MINUTE);
Toast.makeText(this,  ""+out, Toast.LENGTH_SHORT).show();
//returns correct time

Time currentTime = new Time();
currentTime.setToNow();
Toast.makeText(this,  currentTime.format("%H:%M"), Toast.LENGTH_SHORT).show();
//returns incorrect time 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:49:45.170

我不知道这是否会帮助你，但我有一个非常本地化的应用程序，所以我只是从 res/strings.xml 变量中强制时区。

像这样的东西：

```
Calendar currentTime = Calendar.getInstance(); 

SimpleDateFormat dateFormat = new SimpleDateFormat("hh:mm aa");
dateFormat.setTimeZone(TimeZone.getTimeZone(context.getString(R.string.app_timezone)));

Toast.makeText(this, dateFormat.format(input.getTime()), Toast.LENGTH_SHORT).show(); 
```

然后在 res/strings.xml

```
<string name="app_timezone">GMT+8:00</string> 
```

# c# - 将哈希函数从 C# 转换为 Javascript 存在按位数学问题

> ID：15329503
> 
> 赞同：0
> 
> 时间：2013-03-11T00:34:04.990
> 
> 标签：c#, javascript, hash, bit-shift

我有以下 C# 哈希函数（也可以在 SO 上找到！），我在覆盖几个不同平台的一堆应用程序中使用它：

```
public static int GetStableHash(string s, int hashlength)
{
    uint hash = 0;
    var bytes = System.Text.Encoding.ASCII.GetBytes(s);
    foreach (byte b in bytes)
    {
        hash += b;
        hash += (hash << 10);
        hash ^= (hash >> 6);
    }
    // final avalanche
    hash += (hash << 3);
    hash ^= (hash >> 11);
    hash += (hash << 15);

    return (int)(hash % hashlength);
} 
```

我正在尝试将其移植到 Javascript，另一个应用程序将在其中生成匹配的哈希值。唯一的问题是 JS 没有 uint 类型，并且似乎在执行按位数学之前在内部将整数转换为浮点数。这导致此移植功能出现问题：

```
function getStableHash(s, hashlength)
{
    var hash = 0;
    var bytes = stringToBytes(s);   // this function just grabs a byte array for the given input string
    for (var i = 0; i < bytes.length; i++)
    {
        hash += bytes[i];
        hash += (hash << 10);
        hash ^= (hash >> 6);
    }
    // final avalanche
    hash += (hash << 3);
    hash ^= (hash >> 11);
    hash += (hash << 15);

    return Math.round(hash % hashlength);
} 
```

在上面的代码中，由于存在签名位，移位最终会导致问题，并且生成的哈希与 C# 版本的输出不匹配。从其他各种 SO 帖子中还不清楚（例如，请参阅[使用大整数](https://stackoverflow.com/questions/6847636/bitwise-operations-with-big-integers)的位运算）解决此问题的最佳方法是什么。

在 C# 和 C++ 中已经有使用散列方法的代码在生产中，因此不能在其他地方更改散列方法以适应 Javascript 的缺点。

如何解决 JS 的内部类型转换？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:44:43.777

尝试以下操作：

1.  使用无符号右移`>>>`而不是有符号

2.  用于在取模之前`>>> 0`将最终结果转换为*无符号32 位 int：*

    `return (hash >>> 0) % hashlength;`

# jquery - jQuery 选择器/缩放

> ID：15329509
> 
> 赞同：0
> 
> 时间：2013-03-11T00:35:00.310
> 
> 标签：jquery, asp.net

我有一个网络表单并尝试使用 jquery 来启用其中一个图像的缩放。表单代码结构是这样的：

```
<asp:FormView ID="frmVwStyle" runat="server" DefaultMode="Edit"  >

    <ItemTemplate>
    ...
    </ItemTemplate>
    <EditItemTemplate>
        <table width="690">
        <tr>
        <td width="280" align="left" valign="top">
        <div class="style-image" href='<%# ... %>'>
            <a href='' title="" id="SwatchBox" class="swatchImage" style='display:none;'><img id='SwatchImage' src='' alt='' /></a>
            <a href='<%# ... %>' zoom='<%# ... %>' rel="lightBox" title="..." id="..." class="styleImage-magnify" ><%# ...%></a>

            <img id="TargetImage" border="0" src= "images/haydensmall.jpg" style="width:250px;height:338px">

        </div>
        </td>
    ... 
```

我在页面顶部得到了以下脚本。 .addimagezoom 是一个插件，如果选择器可以正确选择我的图像，它就可以正常工作。

```
$(document).ready(function () {
                        $("#TargetImage").addimagezoom({ // single image zoom
                    zoomrange: [3, 10],
                    magnifiersize: [100, 100],
                    magnifierpos: 'right',
                    cursorshade: true,
                    largeimage: 'images\\hayden.jpg' 
                });

            } 
```

但它无法选择图像。我还尝试了以下方法：

```
 $(document).ready(function () {

            $(".style-images").find("#TargetImage").addimagezoom({  // or this one  $("#frmVwStyle").find(".style-images").find("#TargetImage").addimagezoom
                zoomrange: [3, 10],
                magnifiersize: [100, 100],
                magnifierpos: 'right',
                cursorshade: true,
                largeimage: 'images\\hayden.jpg' 
            });

        } 
```

还是行不通。任何想法？

PS jquery-1.3.1 已经在这个项目中使用了，由于一些不兼容，我目前无法更改它。

# java - 使用确认对话框将值从数据表传递到 bean JSF

> ID：15329510
> 
> 赞同：1
> 
> 时间：2013-03-11T00:35:17.457
> 
> 标签：java, jsf, primefaces

我无法将数据表中的单个值传递给支持 bean。当我尝试在确认对话框的方法中打印它时，我总是得到 0 的值，但是当我尝试在命令按钮的方法中打印它时，它会显示我需要的值。我认为它会重置价值或其他任何东西。

```
<p:dataTable id="labLists" var="lab" value="#{coltsysHome.laboratory}" >
  .....
  <p:column headerText=" ">
        <p:commandButton value="DELETE" onclick="confDlg.show()" icon="ui-icon-closethick" action="#{coltsysHome.action}">
                <f:setPropertyActionListener value="#{lab.lab_id}" target="#{coltsysHome.lab_id_del}" />
         </p:commandButton>
   </p:column> 
```

对于确认对话框：

```
<p:confirmDialog widgetVar="confDlg" header="DELETE LABORATORY" message="Are you sure you want to delete this lab?">
   <h:form id="delDlgForm">
           <p:commandButton id="confirm" value="Yes Sure" oncomplete="confDlg.hide()" actionListener="#{coltsysHome.deleteLab(event)}"/> 
            <p:commandButton id="decline" value="Not Yet" onclick="confDlg.hide()" type="button" /> 

    </h:form> 
```

豆（RequestScoped）：

```
...getter and setter (lab_id_del)

public void deleteLab(ActionEvent event) {

    FacesContext context = FacesContext.getCurrentInstance();
    String cpath = context.getExternalContext().getRequestContextPath();

    try (Connection conn = dataSource.getConnection()) {
        ColtsysDAO coltsysDAO = new ColtsysDAO(conn);
        coltsysDAO.deleteLab(lab_id_del, coltsysDAO.getUserID(getUser_name()));

    } catch (Exception e) {
        e.printStackTrace(System.err);
    }
}
public void action() {
    System.out.println("lab_id_del: " + lab_id_del);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T06:12:44.523

您需要做的第一个也是最重要的改变是：`RequestScoped->ViewScoped`正如[Luiggi Mendoza](https://stackoverflow.com/questions/15329510/passing-value-from-data-table-to-bean-jsf-with-confirm-dialog/#comment21650360_15329510)所建议的那样。您可能需要将`process`属性添加`p:commandButton`到`id`. `p:dataTable`您也可以将`lab`对象直接传递给`action`方法而不使用`f:setPropertyActionListener`as:`action="#{coltsysHome.action(lab)}"`并将其作为: `public String action(Lab lab)`。为什么不`actionListener`！

# php - 托管网站时 IE 中缺少标题菜单

> ID：15329517
> 
> 赞同：0
> 
> 时间：2013-03-11T00:35:28.137
> 
> 标签：php, html, internet-explorer

我很困惑，我找不到任何合理的解释来解释这种情况。

我已经开发一个网站一个月了。当我去的时候，我正在备份我的工作

```
- website-bkp1
- website-bkp2
- etc... 
```

自 bkp1 以来，我在 IE 和 Firefox 上本地测试该网站，并确保一切正常。我还将它上传到我的托管站点，并在 IE 和 Firefox 上进行了测试。

昨晚我将可以在 IE 和 Firefox 本地运行的 website-bkp10 上传到我的托管站点。我测试了功能，在 Firefox 中一切正常，但在 IE 中，我的网站缺少标题内容菜单！

我上传回 bkp1 并且仍然在 IE 中我缺少标题菜单......我无法解释任何这些。

知道现在正在破坏 IE 行为的托管站点可能出了什么问题吗？

谢谢

注意：这是网站：[formationmtl](http://www.formationmtl.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:47:29.847

插入此字符串：

`<!–[if gte IE 9]> <script type=”text/javascript”&gt; Cufon.set(‘engine’, ‘canvas’); </script> <![endif]–&gt;`

在这个字符串之后：

`<script src="js/cufon-yui.js" type="text/javascript"></script>`

在您的 html`<head>`标记中。

# php - 为什么我的 php 表单不生成值？

> ID：15329518
> 
> 赞同：0
> 
> 时间：2013-03-11T00:35:28.480
> 
> 标签：php, forms

如何在 PHP 中创建一个表单，用户输入的结果将在表格中生成？当我测试页面时，我只得到表、键和结果（值）字段的开头，但没有值！

这是我的代码（我将字段数缩短为两个，因为表单可能很长：

订单：

```
<?php

foreach ($_POST as $key => $entry)
{
    $totalfields++;
    echo "<tr>\n";  

    echo "<td>" . $key . "</td>";

    if (is_array ($entry)) { 
        $count = count($entry);
        echo "<td>";
        for ($i=0; $i<$count; $i++){
            echo $entry[$i] . "<br />";
        }
        echo "</td>";
    }   else   
    {
        echo "<td>$entry</td>";
    }
    echo "<tr>\n";
}
?>

<form method="post" action="address to the results form page">  

<label for="fname">First Name:</label>
<input type="text" name="fname" id="fname"/><br/>
<br/>

<label for="lname">Last Name:</label>
<input type="text" name="lname" id="lname"/><br/>
<br/>

 <p><input type="submit" value="Submit"/></p>

 </form> 
```

结果表格页面：

```
 <div id="results table">
 <table border='1'>
 <tr>
 <th>
  Field
 </th>
 <th>
  Results
 </th>
 </tr>
 </table>
 </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:38:23.050

生成表格的 PHP 应该在结果页面中，而不是在表单页面中。或者，您可以`action`将表单指向同一页面，以在同一页面上发布和处理结果。

**编辑：**我的意思是：PHP——你可能知道——是在**服务器端**处理的。这意味着您的浏览器向服务器发送请求，服务器处理 PHP 文件，然后为客户端提供处理后的版本。

您的代码中的问题是您让 PHP 脚本`$_POST`在用户应该填写表单的页面上处理。当用户填写表单并点击提交时，他将被定向到`action`页面，该页面`$_POST`将可用并进行处理。您的误解在于您希望`$_POST`它在发布它的页面上可用，然后自动将其发送到结果页面。**这不是发生的情况，因为服务器没有机会捕获您在同一页面上发送的信息，因为它已经被提供了**......</p>

…除非您将表单操作直接指向同一页面。然后服务器捕获信息并处理它。

你真的可以用两种方式解决这个问题。

1.  `action`像现在一样将您指向结果页面，但将处理代码移动到结果页面。

2.  将您`action`指向同一页面。

您甚至可能想做一些花哨的事情，例如检查是否有`$_POST`信息，如果没有，则显示一个表格。如果有，显示结果。这一点也不难实现，如下所示：

```
<?php
if( $_POST ): ?>
<div id="results table">
 <table border='1'>
     <thead>
         <tr>
         <th>
          Field
         </th>
         <th>
          Results
         </th>
         </tr>
     </thead>
     <tbody>
         <?php   

        foreach ($_POST as $key => $entry)
        {

            echo "<tr>\n";  

            echo "<td>" . $key . "</td>";

            if (is_array ($entry)) { 
                $count = count($entry);
                echo "<td>";
                for ($i=0; $i<$count; $i++){
                    echo $entry[$i] . "<br />";
                }
                echo "</td>";
            }   else   
            {
                echo "<td>$entry</td>";
            }
            echo "<tr>\n";
        }

    ?>

    </tbody>
</table>
</div>

<?php else: ?>

<form method="post" action="<?php echo $_SERVER['PHP_SELF']; ?>">  

<label for="fname">First Name:</label>
<input type="text" name="fname" id="fname"/><br/>
<br/>

<label for="lname">Last Name:</label>
<input type="text" name="lname" id="lname"/><br/>
<br/>

 <p><input type="submit" value="Submit"/></p>

 </form>

<?php endif; ?> 
```

我为你做了一个工作示例。只需转到链接并单击`Run [F9]`顶部的按钮即可查看它的实际效果：

`[**Working example**](http://phpfiddle.org/main/code/ewv-4bp)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T00:39:23.813

这实际上对我来说很好（我用于`PHP_SELF`表单操作）。但是，我建议您使用`$_SERVER[REQUEST_METHOD]`来检查`POST`：

`if( $_SERVER[REQUEST_METHOD] == 'POST' ) { ...`

此外，要明确调用已发布的变量 ( `$_POST[fname]`& `$_POST[lnane]`)

# sql - 为存储过程创建 sql server 角色

> ID：15329528
> 
> 赞同：0
> 
> 时间：2013-03-11T00:36:44.537
> 
> 标签：sql, sql-server, sql-server-2012

我有一个 mvc 4 Web 应用程序，它在多个环境中与 sql server 数据库交互。

我连接到数据库的用户在每个环境中都不同。我在每次构建和部署期间生成我的存储过程的通用脚本并将其运行到每个环境中。在脚本中，我向每个 sproc 上的 db 用户授予执行权限。

目前我需要为每个环境编写一个脚本，因为每个环境的用户都不同——这很痛苦！

是否可以在每个环境中创建一个角色，在每个环境中创建一个相同的名称，并为该角色授予与用户相反的执行权限？用户将被设置为该角色的一部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T12:02:03.157

是的，这正是数据库角色的用途，您创建一个自定义数据库角色，对其应用权限，然后您只需将用户添加到该数据库角色。

请查看以下链接，了解如何完成此操作的详细信息：

[SQL Server - 自定义数据库角色](http://beyondrelational.com/modules/2/blogs/88/posts/10181/sql-server-custom-database-role.aspx)

# linux - 在 Code::Blocks 中运行构建脚本而不是构建目标

> ID：15329530
> 
> 赞同：0
> 
> 时间：2013-03-11T00:36:51.333
> 
> 标签：linux, build, makefile, codeblocks

***背景：***

我最近作为实习生加入了一家软件开发公司，并且正在适应一个新的构建系统。该软件适用于嵌入式系统，可以说所有构建和编译都是在构建盒上完成的。该构建使用使用 xml 文件的代码生成，然后还使用 make 文件、规范文件和版本文件。

我们在自己的 comps 上开发（linux - mandriva 发行版）并使用以下方法构建：

```
ssh buildserver
use mount to mount drive on personal computer to the buildserver
set the environment using . ./set_env (may not be exactly that)
cd app_dir/obj (where makefile is)
make spec_clean
make spec_all
make clean
make 
```

***问题：***

我是 Code::Blocks 和 linux 的新手，想知道如何设置项目文件，以便它可以简单地运行脚本文件来执行这些命令，而不是在我的实际计算机上实际调用构建过程。有点像预构建脚本。我想将此脚本的执行简单地与 Ctrl-F9（构建）配对，并在构建日志窗口中捕获上述命令的任何输出。

换句话说，项目不需要担心构建配置或目标。我什至不需要在我的计算机上安装编译器！我希望设置它，以便我可以拥有 IDE 的全部功能。

感谢任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T02:29:16.493

把你的脚本放在一个 shell 脚本文件中。例如，

```
#!/bin/sh
mount ... /mnt/path/buildserver
. ./set_env
cd app_dir/obj
make spec_clean
make spec_all
make clean
make 
```

假设您将其命名为`/path/to/my_build_script`，然后`chmod 755 /path/to/my_build_script`从您的 ssh 客户端计算机调用以下命令：

```
script -c ssh buildserver "path/to/my_build_script" 
```

完成后，检查`typescript`当前目录下的文件。

高温高压

# python - 使用 _mysql 修复 SQL 注入

> ID：15329531
> 
> 赞同：0
> 
> 时间：2013-03-11T00:37:06.453
> 
> 标签：python, mysql, sql, flask, sql-injection

我刚刚发现我使用 _mysql 的方式导致了一个主要的 SQL 注入问题。

我当前的代码如下所示：

```
db = _mysql.connect('', 'user', 'pass', 'db')
query = """SELECT * FROM stuff WHERE thing="{0}" """.format(user_input)
cur.query(query) 
```

我做错了什么，我该如何解决它以确保安全？

我曾尝试使用 _mysql.escape_string() 但仍然返回 SQL 语法错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:42:20.943

您可以单独使用`MySQLdb`：

```
conn = MySQLdb.connect();
curs = conn.cursor();
curs.execute("SELECT * FROM stuff WHERE thing = %s", (user_input)); 
```

如果您想坚持使用`_mysql`，请使用`db.escape_string(user_input)`.

文档： http: [//mysql-python.sourceforge.net/MySQLdb.html](http://mysql-python.sourceforge.net/MySQLdb.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T00:44:43.327

可以通过[bobby tables 网站](http://bobby-tables.com/)获得一个很好的方便参考。

您还可以[在此 powerpoint 参考](http://www.slideshare.net/openpbs/sql-injection-defense-in-python)中找到价值，该参考显示了一些 sql 注入示例以及缓解问题的可能方法。

# ruby-on-rails - 实现简单私人消息后未定义的方法“error_message_on”

> ID：15329540
> 
> 赞同：0
> 
> 时间：2013-03-11T00:38:42.620
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rubygems, private-messaging

我正在开发我的第一个 RoR 网站，并完成了安装 simple_private_messages 的步骤。这是它应该看起来的样子吗？ [http://i.imgur.com/HTootKv.jpg](http://i.imgur.com/HTootKv.jpg)

单击“撰写”时收到此错误消息：

```
 NoMethodError in Messages#new

Showing C:/app/views/messages/new.html.erb where line #5 raised:

undefined method `error_message_on' for #<#<Class:0x516e6d0>:0x516c0f0> 
```

我正确地完成了所有步骤（我相信）。

这是我的 route.db

```
 resources :users do
             resources :messages do
               collection do
                 post :delete_selected
               end
             end
           end 
```

消息/new.html.erb

```
<% form_for @message, :url => user_messages_path(@user) do |f| %>
  <p>
    To:<br />
        <%= f.text_field :to %>
        <%= error_message_on @message, :to %>
  </p>
  <p>
    Subject:<br />
    <%= f.text_field :subject %>
    <%= error_message_on @message, :subject %>
    </p>
    <p>
      Message<br />
      <%= f.text_area :body %>
            <%= error_message_on @message, :body %>
    </p>
    <p>
      <%= submit_tag "Send" %>
    </p>
<% end %> 
```

消息模型

```
class Message < ActiveRecord::Base

  is_private_message

  attr_accessor :to

end 
```

消息控制器

```
class MessagesController < ApplicationController

  before_filter :set_user

  def index
    if params[:mailbox] == "sent"
      @messages = @user.sent_messages
    else
      @messages = @user.received_messages
    end
  end

  def show
    @message = Message.read_message(params[:id], current_user)
  end

  def new
    @message = Message.new

    if params[:reply_to]
      @reply_to = @user.received_messages.find(params[:reply_to])
      unless @reply_to.nil?
        @message.to = @reply_to.sender.login
        @message.subject = "Re: #{@reply_to.subject}"
        @message.body = "\n\n*Original message*\n\n #{@reply_to.body}"
      end
    end
  end

  def create
    @message = Message.new(params[:message])
    @message.sender = @user
    @message.recipient = User.find_by_login(params[:message][:to])

    if @message.save
      flash[:notice] = "Message sent"
      redirect_to user_messages_path(@user)
    else
      render :action => :new
    end
  end

  def delete_selected
    if request.post?
      if params[:delete]
        params[:delete].each { |id|
          @message = Message.find(:first, :conditions => ["messages.id = ? AND (sender_id = ? OR recipient_id = ?)", id, @user, @user])
          @message.mark_deleted(@user) unless @message.nil?
        }
        flash[:notice] = "Messages deleted"
      end
      redirect_to :back
    end
  end

  private
    def set_user
      @user = User.find(params[:user_id])
    end
end 
```

# lua - Lua秒格式题

> ID：15329542
> 
> 赞同：1
> 
> 时间：2013-03-11T00:39:11.753
> 
> 标签：lua

我有这个功能：

```
 function SecondsFormat(X)
   if X <= 0 then return "" end
   local t ={}
   local ndays = string.format("%02.f",math.floor(X / 86400))
   if tonumber(ndays) > 0 then table.insert(t,ndays.."d ") end
   local nHours = string.format("%02.f",math.floor((X/3600) -(ndays*24)))
   if tonumber(nHours) > 0 then table.insert(t,nHours.."h ") end
   local nMins = string.format("%02.f",math.floor((X/60) - (ndays * 1440) - (nHours*60)))
   if tonumber(nMins) > 0 then table.insert(t,nMins.."m ") end
   local nSecs = string.format("%02.f", math.fmod(X, 60));
   if tonumber(nSecs) > 0 then table.insert(t,nSecs.."s") end
   return table.concat(t)
  end 
```

我想增加几周和几个月的时间，但是因为一个月中的日子并不总是一样，所以我无法在月份部分继续前进，所以任何人都可以提供一些帮助吗？

第二个问题是，使用表格来存储结果是处理这个问题的最有效方法吗？给定函数将每 3 秒调用一次，最多可处理 100 个项目（在网格中）？

**编辑：**

```
 function ADownload.ETA(Size,Done,Tranrate) --all in bytes
   if Size == nil then return "--" end
   if Done == nil then return "--" end
   if Tranrate == nil then return "--" end
   local RemS = (Size - Done) / Tranrate
   local RemS = tonumber(RemS)
   if RemS <= 0 or RemS == nil or RemS > 63072000 then return "--" end
   local date = os.date("%c",RemS)
   if date == nil then return "--" end
   local month, day, year, hour, minute, second = date:match("(%d+)/(%d+)/(%d+) (%d+): (%d+):(%d+)")
   month = month - 1
   day = day - 1
   year = year - 70
   if tonumber(year) > 0 then
   return string.format("%dy %dm %dd %dh %dm %ds", year, month, day, hour, minute, second)
   elseif tonumber(month) > 0 then
    return string.format("%dm %dd %dh %dm %ds",month, day, hour, minute, second)
   elseif tonumber(day) > 0 then
    return string.format("%dd %dh %dm %ds",day, hour, minute, second)  
   elseif tonumber(hour) > 0 then
    return string.format("%dh %dm %ds",hour, minute, second)   
   elseif tonumber(minute) > 0 then
    return string.format("%dm %ds",minute, second)  
   else
    return string.format("%ds",second)  
   end      
  end 
```

我将该函数合并到主函数中，因为我认为它可能会更快，但我现在有两个问题：

1：我必须添加

```
 if date == nil then return "--" end 
```

因为它偶尔会在 date:match 尝试与“nil”进行比较时出错，但是 os.date 在文献中没有提到将 nil 作为字符串或表格返回，所以尽管额外的代码行解决了这个问题，但我想知道为什么行为发生是因为我确定我在之前的回报中捕获了所有非事件？

2：有时我会看到像 myfunction(...) 这样编写的函数，我确信它只是取消了参数，如果是这样，是否有一行代码可以取消前 3 个“if”语句？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T01:54:04.333

您可以使用[os.date](http://www.lua.org/manual/5.2/manual.html#pdf-os.date)函数以可用格式获取日期值。formating`'*t'`参数使返回的日期变成表格而不是字符串。

```
local t = os.date('*t')
print(t.year, t.month, t.day, t.hour, t.min, t.sec)
print(t.wday, t.yday) 
```

os.data 默认使用当前时间，如果需要，您可以传递一个明确的时间（有关更多信息，请参阅 os.data 文档）

```
local t = os.date('*t', x) 
```

至于表性能，我不会担心。不仅您的函数不经常被调用，而且表处理比您可能正在做的其他事情便宜得多（调用 os.date、大量字符串格式化等）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T01:45:30.607

为什么不让 Lua 的`os`库为您完成这项艰巨的工作呢？

可能有一种更简单（阅读：更好）的方法来找出与 的区别`01/01/70`，但这里有一个关于如何使用它的快速想法：

```
function SecondsFormat(X)
    if X <= 0 then return "" end
    local date = os.date("%c", X) -- will give something like "01/03/70 03:40:00"
    local inPattern = "(%d+)/(%d+)/(%d+) (%d+):(%d+):(%d+)"
    local outPattern = "%dy %dm %dd %dh %dm %ds"
    local month, day, year, hour, minute, second = date:match(inPattern)
    month = month - 1
    day = day - 1
    year = year - 70
    return string.format(outPattern, year, month, day, hour, minute, second)
end 
```

我认为这也应该比构建表格和`string.format`多次调用要快得多——但你必须对此进行分析。

**编辑：**我用两个 concatenate 函数进行了快速测试`"abc"`，`"def"`并`"ghi"`使用了这两种方法。将这些字符串插入一个表中，一个连接需要 14 秒（当然是几百万次运行），使用单个`string.format()`需要 6 秒。这没有考虑到您的代码`string.format()`无论如何都会调用（多次） - 也没有考虑到您通过除法计算值和通过模式匹配计算值之间的区别。模式匹配肯定会更慢，但我怀疑它是否超过了没有表格的收益——而且能够利用`os.time()`. 最快的方法可能是手动计算月份和日期，然后使用单个`string.format()`. 但同样 - 你必须描述它。

**EDIT2：** missingno 有一个好处，即首先使用`"*t"`选项 with`os.date`分别为您提供值。同样，这取决于您是为了方便而想要一个表还是为了存储而使用一个字符串或其他任何原因。结合`"*t"`和单一`string.format`：

```
function SecondsFormat(X)
    if X <= 0 then return "" end
    local date = os.date("*t", X) -- will give you a table
    local outPattern = "%dy %dm %dd %dh %dm %ds"
    date.month = date.month - 1
    date.day = date.day - 1
    date.year = date.year - 70
    return string.format(outPattern, date.year, date.month, date.day, date.hour, date.min, date.sec)
end 
```

# java - 向 JApplet 显示图像？

> ID：15329546
> 
> 赞同：1
> 
> 时间：2013-03-11T00:39:32.907
> 
> 标签：java, swing, japplet

我有一个关于如何向 JApplet 显示简单图像的问题。出于某种原因，当我运行此代码时没有任何显示：

```
import java.applet.Applet;
import java.awt.Image;
import java.awt.*;
import javax.swing.*;

public class Main extends JApplet{

Image backgroundFile;
public void init(){
    setSize(1500,750);
    backgroundFile = getImage(getCodeBase(), "Background.jpg");
}
public void paint(Graphics g){
    g.drawImage(backgroundFile, 20, 20, this);
}
} 
```

并不是代码抛出错误或其他东西（这会更可取！），而是屏幕上什么也没有出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T17:43:12.637

多谢你们！就是这样。我觉得很愚蠢，它只是不在 bin 文件夹中，而是在主项目目录中！:P 愚蠢的错误，但再次感谢！

# java - JQuery - Servlet 发布异常失败

> ID：15329549
> 
> 赞同：0
> 
> 时间：2013-03-11T00:39:51.673
> 
> 标签：java, jquery, html, ajax, servlets

我是 JQuery 的新手，我在这里遇到了一个奇怪的问题，我尝试将我的 HTML 表单发布到 servlet，并尝试在 servlet 上打印数据。在我提交带有新值的表单（例如 10 次中的 7 次）的大多数情况下，数据都会被打印出来。但它失败了另外 3 次，我找不到失败的模式。

我尝试使用 firebug 和 chrome 工具，在控制台上看不到错误，每次提交设置正确值的表单时，我都会在 chrome 的资源/HTML 工具中得到 200 响应。

这是我的代码

HTML

```
<script type="text/javascript" src="js/jquery-1.6.2.min.js"></script>
<script type="text/javascript" src="jquery-ui-1.8.16.custom/js/jquery-ui-1.8.16.custom.min.js"></script>
<script type="text/javascript" src="js/main.js"></script>   

<form id="fcall">
    <p> Start Date:  <input  type="text" name="start" id="ibox_start"> 
        End Date: <input type="text" name="end" id="ibox_end"> </p>
        <div id="buttonID"> 
     <input type="submit" value=" Find " class="button"></div>

</form> 
```

main.js

```
$().ready(

    function(){
        $('#ibox_start').datepicker();
        $('#ibox_end').datepicker();

        $('#fcall').submit(

         function(){

           var start =  $('#ibox_start').val();
           var end = $('#ibox_end').val();
           alert(start);

           $.post("DServlet", {start:start,end:end}, function(data) {});

          }
        );
      }         
    ); 
```

小服务程序

```
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws      ServletException, IOException {
    // TODO Auto-generated method stub

    String start = request.getParameter("start");
    String end = request.getParameter("end");
    System.out.println("Date Recieved "+start);

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T02:11:09.940

我希望看到以下内容之一：

*   自然的 HTML 表单提交
*   自然的 HTML 表单提交，带有一个提交处理程序，它验证表单值并返回`true`以允许表单提交或`false`禁止它。
*   通过 AJAX 提交表单数据的提交处理程序，建立`.done()`处理 HTTP 响应的处理程序，并返回`false`以禁止自然 HTML 表单提交。

上面的代码看起来像是这些可能性的混合体。

# ubuntu-12.04 - 在 Ubuntu 12.04 上安装 dotcloud 时出现 chardet2 (?) 问题

> ID：15329552
> 
> 赞同：0
> 
> 时间：2013-03-11T00:40:00.053
> 
> 标签：ubuntu-12.04, pip, dotcloud

我刚刚注册了 DotCloud 并在安装 pip 包时得到了这个。试图摆弄并无法解决它。
在 python 3.2 下运行 pip 1.2.1。

抱歉，我不知道 Python 的一些知识，所以我无法真正弄清楚如何自己解决这个问题。如果你有任何 python 帮助给我，请轻轻地做（虽然我对 PHP/Ruby 非常了解）。

```
$ sudo easy_install pip && sudo pip install dotcloud
[sudo] password for myself: 
Searching for pip
Best match: pip 1.2.1
pip 1.2.1 is already the active version in easy-install.pth
Installing pip script to /usr/local/bin
Installing pip-3.2 script to /usr/local/bin

Using /usr/local/lib/python3.2/dist-packages
Processing dependencies for pip
Finished processing dependencies for pip
Downloading/unpacking dotcloud
Running setup.py egg_info for package dotcloud

Requirement already satisfied (use --upgrade to upgrade): argparse in /usr/local/lib/python3.2/dist-packages (from dotcloud)
Downloading/unpacking requests==0.14.2 (from dotcloud)
Running setup.py egg_info for package requests
Traceback (most recent call last):
File "<string>", line 16, in <module>
File "/tmp/pip-build/requests/setup.py", line 6, in <module>
import requests
File "requests/__init__.py", line 52, in <module>
from . import utils
File "requests/utils.py", line 22, in <module>
from .compat import parse_http_list as _parse_list_header
File "requests/compat.py", line 112, in <module>
from .packages import chardet2 as chardet
ImportError: cannot import name chardet2
Complete output from command python setup.py egg_info:
Traceback (most recent call last):

File "<string>", line 16, in <module>

File "/tmp/pip-build/requests/setup.py", line 6, in <module>

import requests

File "requests/__init__.py", line 52, in <module>

from . import utils

File "requests/utils.py", line 22, in <module>

from .compat import parse_http_list as _parse_list_header

File "requests/compat.py", line 112, in <module>

from .packages import chardet2 as chardet

ImportError: cannot import name chardet2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T13:35:00.990

这可能与请求和python 3.2有关。您能否尝试安装以下软件包，然后重试安装 dotCloud CLI？

```
pip install chardet2 urllib3 
```

[需要帮助安装 python 3 的请求](https://stackoverflow.com/questions/11994337/need-help-installing-requests-for-python-3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T02:36:45.943

看起来，目前 DotCloud 不支持 Python 3，不幸的是，它是较新机器上 Python 的默认版本。

因此，看起来不可能通过 pip 安装 dotcloud。
但是，我设法下载了[独立包](https://pypi.python.org/packages/source/d/dotcloud/dotcloud-0.9.4.tar.gz#md5=1f2caf78f8f1bf4c441d18cbfe3d6ce8)，将其解压缩并使用`sudo ./setup.py install`. 该脚本自动调用 Python 2.7 并干净地安装所有内容。

# forms - extjs 表单提交模型设计

> ID：15329555
> 
> 赞同：0
> 
> 时间：2013-03-11T00:40:06.807
> 
> 标签：forms, extjs

我有一个包含大约 30 种表单的表单模板。每次只会选择并提交一份表格。表单中的元素数量各不相同，但在 80 左右甚至更多。

我对此有两个要求：

1.  表单提交应该能够缓存到 localStorage 并稍后在网络恢复时恢复到服务器。我怎样才能持久化表格？
2.  我不想将模型放在 extjs 中，因为模型将在真正的后端构建。后端将根据用户选择和输入的组合来构建它。不确定这是否有意义。我唯一能想到的就是通过一些规则设置 inputId 并在后端进行映射。

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:56:30.093

您能否在提交之前将基本表单数据推送到本地对象（数组？），并使用 $.ajax( ..., data:myDataObject ) 将数据提交到后端而不是表单？通过这种方式，您可以缓存数据，可以重新填充表单，或者根据响应根据需要重新提交。

我没有使用过 extjs（虽然看起来不错），但我想像这样：

```
function submitter() {
    var myData = new Object();   //maybe make an array/object to store each form dataset separately?
    //pseudo:
    for each form element {
        myData.push(item = value);
    }
    $.ajax({
        'dataType': 'json',
        'type': 'GET',
        'url': sSource,
        'data': myData,
        'success': [fnCallback, fnMy2ndCallback]  //single or array of callbacks.
    });
    function fnCallback(response) {
        //check for failure, or success and proceed accordingly.
    } 
```

唐有一个美好的一天

# python - 我的 numpy 数组总是以零结尾？

> ID：15329557
> 
> 赞同：1
> 
> 时间：2013-03-11T00:40:28.040
> 
> 标签：python, math, numpy

我想我错过了什么地方。我使用两个 for 循环（x 和 y）和一个基于 x,y 位置的函数填充了一个 numpy 数组。唯一的问题是无论数组的大小如何，数组的值总是以零结尾。

```
thetamap = numpy.zeros(36, dtype=float)
thetamap.shape = (6, 6)
for y in range(0,5):
    for x in range(0,5):
        thetamap[x][y] =  x+y
print thetamap 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T00:41:22.633

`range(0, 5)`产生`0, 1, 2, 3, 4`. 端点总是被省略。你想要的简单`range(6)`。

更好的是，使用*NumPy 的强大功能*将数组放在一行中：

```
thetamap = np.arange(6) + np.arange(6)[:,None] 
```

这会生成一个行向量和一个列向量，然后使用 NumPy 广播将它们相加以生成一个矩阵。

# ios6 - 在 NavigationController ios6 中返回时调用方法

> ID：15329558
> 
> 赞同：1
> 
> 时间：2013-03-11T00:40:45.593
> 
> 标签：ios6, delegates, uinavigationcontroller, back, pushviewcontroller

我在 NavigationController 设置中有许多 ViewController，并且想知道**当用户单击“返回”时是否可以运行代码**。

基本上我的应用程序运行测试，我希望“返回”也停止测试。我知道我可以添加一个单独的停止按钮，但这会更顺畅。

谢谢

编辑：

我已经添加了：

```
-(void) navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated
{
    if ([[StdTCPTestViewController class] isSubclassOfClass:[ViewController class]])
        NSLog(@"We are going back to VC1");
} 
```

到我的代码，但是一旦加载视图就会调用它，而不是在按下后退按钮时调用。在下面的示例中，StdTCPTestViewController 是 VC2，ViewController 是 VC1。NavController -- VC1 -- VC2 是层次结构，segue 是从 VC1 推送到 VC2。

还有其他微调吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:59:38.697

假设您在导航控制器堆栈中有 2 个 VC：

*   堆栈顶部的 VC2（即显示的最前面的 VC）
*   堆栈上的 VC1 在 VC2 后面/下面（即当您按回 VC2 时将返回到的后面的 VC）

每次 VC2 被“推送”到导航控制器堆栈时：调用 VC2 的 viewDidLoad。每次“弹出”时，视图都会被卸载。另一方面，堆栈上的 VC1 不会调用它的 viewDidload（当 VC2 被弹出时），因为 VC1 仍然加载在内存中（请记住，您将 VC2 推到 VC1 之上，因此 VC1 必须留在内存中！）

所以在某种程度上，如果你想在按下后退按钮时执行一些代码，你应该把这些代码放在 VC1 的 viewDidAppear（或 viewWillAppear）方法中。

现在，如果您要编写的代码必须在弹出之前在 VC2 上执行，那么您可以在 VC2 中使用：

```
 -(void) navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated
{
  if ([[viewController class] isSubclassOfClass:[VC1 class]])
  NSLog(@"We are going back to VC1");
} 
```

这是一个 UINavigationController 委托方法，因此 VC2 必须通过在 .h 文件中 @interface 行的末尾添加 UINavigationControllerDelegate 来采用该协议：

```
@interface VC2 : UIViewController <UINavigationControllerDelegate> 
```

您必须将 VC2 设置为 UINavigationController 的委托，因此您必须放入 VC2 的 viewDidLoad：

```
self.navigationController.delegate=self; 
```

您显然还需要将 VC1.h 文件导入 VC2，因为您在上面的委托方法代码中引用了它。

希望这可以帮助

# java - 如何在Java中找到调用方法的对象

> ID：15329566
> 
> 赞同：15
> 
> 时间：2013-03-11T00:42:18.933
> 
> 标签：java, authentication

我可以找到在 Java 中调用方法的对象吗？我有一个与团体和个人的社交网络。如果一个人想离开一个组，只有那个可以将自己从组中删除，没有其他人可以删除那个人，调用该方法的人必须以某种方式证明它的身份。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-11T03:41:57.700

检查方法的调用者是缺乏经验的程序员的常见请求。我很惊讶它在 SO 上出现的频率并不高。但这是一个非常糟糕的主意（只需查看 Java 2（可能更早的）安全模型）。

在少数情况下实施此限制很重要。正如 Oli Charlesworth 所说，不要这样做。但是让我们假设它很重要，但我们不打算进行堆栈检查。

让我们首先假设我们信任该组。一种可行但荒谬的方法是向组传递一个代表只有该人才能创建的人的对象。（注意 Java 语言访问限制是基于类的。不同的实例可以创建这样的替代，但代码必须在`Person`类中。）

```
public final class Group { // Can't have a malicious subclass.
    public void deregisterPerson(Person.Standin standin) {
        Person person = standin.person();
        ...
    }
}
public class Person { // May be subclassed.
    public final class Standin { // Could be one per Person.
        private Standin() { // Hide constructor from other outer classes.
        }
        public Person person() {
            return Person.this;
        }
    }
    private void groupDeregister(Group group) {
        group.deregisterPerson(new Standin());
    }
 } 
```

如果我们不信任该组，那么我们可以扩展替身以引用该组。这可以防止恶意组从其他组中注销某人。

```
public class Group { // Can have malicious subclasses.
    public void deregisterPerson(Person.GroupDeregister deregister) {
        if (deregister.group() != this) { // Not equals...
            throw new IllegalArgumentException();
        }
        Person person = deregister.person();
        ...
    }
}
public class Person { // May be subclassed.
    public final class GroupDeregister {
        private final Group group;
        private GroupDeregister(Group group) { // Hidden.
            this.group = group;
        }
        public Person person() {
            return Person.this;
        }
        public Group group() {
            return group;
        }
    }
    private void groupDeregister(Group group) {
        group.deregisterPerson(new GroupDeregister(group));
    }
 } 
```

另一种方法是制作可以公开给其他人的“公共”版本的 Person。

```
public class Person { // "PrivatePerson"
    public PublicPerson publicPerson() {
         return new PublicPerson(this);
    }
    private void groupRegister(Group group) {
        group.registerPerson(this);
    }
    private void groupDeregister(Group group) {
        group.deregisterPerson(this);
    }
    ...
}
public class PublicPerson {
    private final Person person;
    public PublicPerson(Person person) {
        this.person = person;
    }
    @Override public final boolean equals(Object obj) {
        return obj instanceof Person && (Person)obj.person == person;
    }
    @Override public final int hashCode() {
        return person.hashCode();
    }
    ...methods, but no raw registration...
 }
 public class Group {
     private final Set<Person> members = new IdentityHashSet<>(); // No Object.equals.
     public void registerPerson(Person person) {
         members.add(person);
     }
     public void deregisterPerson(Person person) {
         members.remove(person);
     }
     public Set<PublicPerson> members() {
         // This will be more concise in Java SE 8.
         Set<PublicPerson> publics = new HashSet<>();
         for (Member member : members) {
             publics.add(member.publicPerson());
         }
         return unmodifiableSet(publics);
     }
} 
```

（`Objects.requireNonNull`为了“简洁”而省略。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-11T00:44:57.753

您可以通过分析堆栈跟踪来使用*反射*来做到这一点（如本问题所述：*[如何使用堆栈跟踪或反射找到方法的调用者？](https://stackoverflow.com/questions/421280/in-java-how-do-i-find-the-caller-of-a-method-using-stacktrace-or-reflection)*）。

然而，在大多数情况下，这将是对反射的滥用。您应该强烈考虑让您的方法采用一个额外的参数调用`caller`（调用者应该填充`this`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T00:51:40.480

Oli 解决方案的风险在于恶意代码可能会调用“删除”方法并指定不同的调用者对象。

如果您正在使用诸如 Spring Security 之类的安全框架，您可以询问当前主体，并且只允许从组中删除该用户，或者如果该用户是管理员，则允许从组中删除任何用户。

# ruby-on-rails - 如何在库中使用方法？

> ID：15329570
> 
> 赞同：0
> 
> 时间：2013-03-11T00:42:33.327
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在努力将 UserVoice Single Single On 与我的 rails 应用程序集成。他们为 ruby​​ 提供了以下类：

```
require 'rubygems'
require 'ezcrypto'
require 'json'
require 'cgi'
require 'base64'

module Uservoice
  class Token
    attr_accessor :data

    USERVOICE_SUBDOMAIN = "FILL IN"
    USERVOICE_SSO_KEY = "FILL IN"

    def initialize(options = {})
      options.merge!({:expires => (Time.zone.now.utc + 5 * 60).to_s})

      key = EzCrypto::Key.with_password USERVOICE_SUBDOMAIN, USERVOICE_SSO_KEY
      encrypted = key.encrypt(options.to_json)
      @data = Base64.encode64(encrypted).gsub(/\n/,'') # Remove line returns where are annoyingly placed every 60 characters
    end

    def to_s
      @data
    end
  end
end 
```

我不知道如何使用它。我将此文件添加到我的 lib 目录并使用 Rails 控制台运行。我试过了：

```
1.9.3-p125 :013 > Uservoice::Token
 => Uservoice::Token 
```

但不能让它真正返回选项：

```
Uservoice::Token.new(:guid => 1, :display_name => "jeff goldmen", :email => "jeff@google.com") 
```

任何想法如何实际使用它？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:49:08.057

查看[代码](https://github.com/iltempo/uservoice/blob/master/lib/uservoice/token.rb)，初始化程序（调用时运行的程序）似乎不会`new`只采用哈希值。方法定义如下所示：

```
def initialize(key, api_key, data) 
```

它似乎将`data`变量视为哈希。您可能只需要在实例化 Token 时添加`key`和值。`api_key`所以调用看起来像这样：

```
Uservoice::Token.new(KEY, API_KEY, {guid:1, display_name:'foo', email:'f@b.com'}) 
```

# vim - 关于 Vim 映射中递归的规则是什么？

> ID：15329572
> 
> 赞同：1
> 
> 时间：2013-03-11T00:43:13.150
> 
> 标签：vim, recursion, mapping

我有两个关于vim 映射的问题，例如imap 和递归。在 Vim 中，映射既可以是右递归的，也可以既不是左递归的也不是右递归的，但它们不允许是左递归的，对吧？为什么不？我测试了以下示例来说明我的意思：

1.  （左递归）当我执行

    ```
    :imap x xyz 
    ```

    然后在插入模式下输入“x”，输入缓冲区的内容是

    ```
    xyz 
    ```

    据我所知，这种行为与我使用 inoremap 而不是 imap 会发生的情况无法区分。

2.  （既不是左递归也不是右递归）当我执行时

    ```
    :imap x yxz 
    ```

    然后在插入模式下键入“x”，（试图）放入缓冲区的内容是

    ```
    y...yz 
    ```

3.  （右递归）当我执行

    ```
    :imap x yzx 
    ```

    然后在插入模式下键入“x”，（试图）放入缓冲区的内容是

    ```
    yzyzyzyzyzyz... 
    ```

4.  （相互递归）当我执行时

    ```
    :imap x abc
    :imap a x 
    ```

    然后在插入模式下输入“x”，我收到“E223：递归映射”。

似乎我已经证明 Vim 不允许左递归映射和相互递归映射，但我想验证一下：**在 Vim 中定义（可能相互）递归映射的规则是什么？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:56:15.753

来自[http://vim.wikia.com/wiki/Recursive_mappings](http://vim.wikia.com/wiki/Recursive_mappings)和 vim 命令

```
:help recursive_mapping

If you include the {lhs} in the {rhs} you have a recursive mapping.  When
{lhs} is typed, it will be replaced with {rhs}.  When the {lhs} which is
included in {rhs} is encountered it will be replaced with {rhs}, and so on.
This makes it possible to repeat a command an infinite number of times ...
There is one exception: If the {rhs} starts with {lhs}, the first character
is not mapped again (this is Vi compatible) ... For example, if you use:

:map x y
:map y x

Vim will replace x with y, and then y with x, etc.
When this has happened 'maxmapdepth' times (default 1000),
Vim will give the error message "recursive mapping". 
```

似乎文档只关注 {lhs} 是单个字符的映射，但是当 {lhs} 超过一个字符并且是 {rhs} 的前缀时，仍然可以观察到这种行为。

# java - 抛出 UnsupportedOperationException

> ID：15329579
> 
> 赞同：10
> 
> 时间：2013-03-11T00:43:50.720
> 
> 标签：java, exception-handling, try-catch

因此，其中一种方法描述如下：

> public BasicLinkedList addToFront(T data) 该操作对排序列表无效。将使用消息“排序列表的无效操作”生成 UnsupportedOperationException。

我的代码是这样的：

```
public BasicLinkedList<T> addToFront(T data) {
    try {
        throw new UnsupportedOperationException("Invalid operation for sorted list.");
    } catch (java.lang.UnsupportedOperationException e) {
        System.out.println("Invalid operation for sorted list.");
    }
    return this;
} 
```

这是这样做的正确方法吗？我刚刚打印出消息，`println()`但是有没有不同的方法来生成消息？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-11T00:55:16.003

您不想在方法中捕获异常 - 关键是让调用者知道不支持该操作：

```
public BasicLinkedList<T> addToFront(T data) {
    throw new UnsupportedOperationException("Invalid operation for sorted list.");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T00:48:16.327

你可以重写你的代码是这样的

```
public BasicLinkedList<T> addToFront(T data) throws UnsupportedOperationException {
    if (this instanceof SortedList) {
        throw new UnsupportedOperationException("Invalid operation for sorted list.");
    }else{
        return this;
    }
} 
```

这基本上完成了你的要求。

# python - 如何将我的 amazon s3 页面指向自定义域？

> ID：15329580
> 
> 赞同：0
> 
> 时间：2013-03-11T00:44:10.330
> 
> 标签：python, amazon-s3, pyramid, boto

我的金字塔应用程序允许用户从 www.domain.com 在 amazon s3 存储桶（称为“testbucket”）中创建新的 html 页面。现在，当页面创建时，用户在[https://s3.amazonaws.com/testbucket/](https://s3.amazonaws.com/testbucket/(some) （一些uuid）被重定向到它。我想要它，以便将它们重定向到存储该 html 的 www.subdomain.domain.com/(someuuid) 。现在这条线在我看来是可调用的（views.py）

```
 return HTTPFound(location="https://s3.amazonaws.com/testbucket/%(uuid)s" % {'uuid':uuid}) 
```

我读过（[http://carltonbale.com/how-to-alias-a-domain-name-or-sub-domain-to-amazon-s3/](http://carltonbale.com/how-to-alias-a-domain-name-or-sub-domain-to-amazon-s3/)），为了做到这一点，我需要在我的amazon s3 帐户名为 subdomain.domain.com，然后将其命名为 s3.amazon.com。（额外的 . 是什么？）。那么我应该在我的返回 HTTPFound 调用中添加什么？应该是：

```
 return HTTPFound(location="https://s3.amazonaws.com/subdomain.domain.com/%(uuid)s" % {'uuid':uuid}) 
```

这对我来说没有任何意义。应该是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T00:48:58.970

如果您创建`CNAME`记录（尾随点是 DNS 工作方式的一个怪癖；这意味着该域是完全合格的），那么您无需提及`s3.amazonaws.com`. 相反，您可以重定向到`http://subdomain.domain.com/your_object_here`.

但是请注意，亚马逊没有您的域的 SSL 证书，因此如果您想通过 SSL 访问它，您需要连接到`s3.amazonaws.com`(或`bucket_name_here.s3.amazonaws.com`)。

据我所知，S3 目前没有实现提供您自己的 SSL 证书的方法（即使这样做了，它也可能需要使用尚未普遍支持的称为服务器名称指示的功能）。

# google-app-engine - Appengine Search API 按日期和时间搜索

> ID：15329582
> 
> 赞同：4
> 
> 时间：2013-03-11T00:44:28.283
> 
> 标签：google-app-engine, gae-search

我想知道如何有一个自纪元日期时间字段（例如 1362960734565）以来的毫秒，我可以轻松搜索（例如在 1234560123456 之后创建的所有文档），或者我是否需要实现一些方法来拆分日期或将其放入另一个格式，因为它不能用作数字或日期。

根据 Google 的搜索 API 文档（[https://developers.google.com/appengine/docs/java/search/overview#Describing_Data_with_Documents](https://developers.google.com/appengine/docs/java/search/overview#Describing_Data_with_Documents)）：

> 文档字段
> 
> 每个文档都包含将包含特定类型内容的字段。内容类型由字段构建器标识，以设置字段的内容类型，如下所示：
> 
> *   文本：纯文本
> *   HTML：HTML 格式的文本
> *   ATOM：被视为单个标记的字符串
> *   NUMBER：介于 2,147,483,647 和 -2,147,483,647 之间的数值（浮点数或整数）
> *   DATE：没有时间成分的日期
> *   GEO_POINT：基于经纬度的语言环境

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T00:02:53.847

我目前的解决方案：

使用作为 DateTime 的时间戳，我将日期存储在 Date 字段类型中，然后获取一天中的毫秒数并将其存储为数字。

然后，我针对这两个字段使用数字运算符构造搜索 API 的查询，例如：

> dayLastUpdated >= 2013-3-13 AND timeLastUpdated > 82884753

# java - 带有机器名称的特殊 UnknownHostException

> ID：15329587
> 
> 赞同：1
> 
> 时间：2013-03-11T00:44:54.017
> 
> 标签：java, android, exception, dns

我得到一个`UnknownHostException`（来自`lookuphostbyname`）。

这样做：

```
result = httpClient.execute(httpGet, responseHandler); 
```

我有互联网许可和互联网访问权限。

并且：如果我使用 ip 它可以工作。如果我使用[http://www.google.de](http://www.google.de)它可以工作。

但是，如果我在 URL 中使用机器名称，它就不会……这怎么可能？android/java 不处理机器名称吗？

我也试过：

```
InetAddress i = InetAddress.getByName(URLName); 
```

不知道接下来能不能做...

编辑：使用 fqdn 它可以工作。但是机器名称没有？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T01:37:30.250

只是为了澄清一些事情。

如果您使用的是模拟器，则可以认为它与使用单独的设备完全相同。

这样，任何网络请求都将被视为不是来自您的 PC。

虽然我相信可以进入设备/模拟器并添加主机记录，但这并不是你真正想要走的路。

最好的办法是只使用 IP 地址或始终确保您使用的地址位于可从设备/模拟器访问的 DNS 中（不需要是公共地址）。

基本上将模拟器/设备视为一台单独的计算机，您将知道您需要去哪里

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T01:00:08.750

机器名称必须在这台机器可以看到的 DNS 中注册，或者需要在您的主机文件中解析。

# paypal-sandbox - 澳大利亚的沙盒访问

> ID：15329594
> 
> 赞同：1
> 
> 时间：2013-03-11T00:45:32.277
> 
> 标签：paypal-sandbox

由于前几天开发者网站更新，我无法访问沙箱。我确实在更新前一个小时使用它。

我试图找回我的密码，但我的帐户已找不到了。我尝试建立一个新帐户，它告诉我需要在美国注册公司才能注册。

所以，我的问题是，当他们需要测试他们的网站时，世界其他地方会做什么？我错过了什么吗？

谢谢西蒙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T03:39:27.727

好的，我知道了。PayPay 支持人员说要创建一个虚拟帐户。换句话说，谎称拥有一家美国企业。完成后，转到应用程序，然后转到沙盒帐户，然后使用旧的沙盒凭据导入数据！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T01:08:59.490

我也有同样的问题。它似乎比所说的还要糟糕。他们似乎已将沙盒登录与 PayPal 帐户登录“集成”在一起。所以你必须有一个真实的 PayPal 账户。换句话说，开发人员也必须是其组织中的 CFO，否则他们自己必须使用 PayPal 作为交换手段，否则他们就不存在。

真是不可思议。

更不用说在中途切断了任意数量的现有开发人员。

# mysql - 强制 MySQL 仅使用 unix 套接字

> ID：15329595
> 
> 赞同：7
> 
> 时间：2013-03-11T00:45:58.080
> 
> 标签：mysql, unix-socket

我希望我的 MySQL 服务器只使用 unix 套接字，而忽略 TCP 网络，所以我将这一行添加到我的配置中`/etc/my.cnf`：

```
skip-networking 
```

但是`netstat`告诉我 MySQL 仍然使用 TCP 端口 3306：

```
# netstat -tl | grep mys
tcp        0      0 *:mysql      *:*                         LISTEN 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T01:08:27.830

如果原因是为了防止远程访问，您可以通过以下方式实现您的目标：

```
bind-address = 127.0.0.1 
```

在*my.cnf的**[mysqld]*部分并重新启动 mysqld。

 *这确保*mysqld*只允许本地连接。

为了防止远程访问*跳过网络*不是唯一的选择，正如（2013）*my.cnf*中的评论所说：

```
# Instead of skip-networking the default is now to listen only on
# localhost which is more compatible and is not less secure. 
```

**编辑：** 安全版本（带有上面的绑定地址）已经是最近（截至 2013 年）Ubuntu 版本中的默认版本，因此只有在您真正想要启用远程服务时才需要更改它（注释掉上面的行）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T05:00:56.370

原来我将文件保存为`my.conf`，应该是`my.cnf`，这就是为什么服务器只加载并使用默认配置的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T00:53:14.223

您使用的参数似乎是正确的，如果您想将与您的 mysql 服务器的连接限制为仅本地连接，我应该将此行添加到 /etc/my.cnf

```
[mysqld]
bind-address=127.0.0.1 
```

不要忘记重新启动 mysqld 服务以激活配置更改

*   删除了不需要的跳过网络的使用*

# c# - 如何从以特定名称开头的 appsettings 键中获取所有值并将其传递给任何数组？

> ID：15329601
> 
> 赞同：32
> 
> 时间：2013-03-11T00:47:24.720
> 
> 标签：c#, asp.net, asp.net-mvc-4, web-config

在我的`web.config`文件中，我有

```
<appSettings>
    <add key="Service1URL1" value="http://managementService.svc/"/>
    <add key="Service1URL2" value="http://ManagementsettingsService.svc/HostInstances"/>
    ....lots of keys like above
</appSettings> 
```

我想获取以开头的键`Service1URL`的值并将该值传递给`string[] repositoryUrls = { ... }`我的 C# 类。我怎样才能做到这一点？

我尝试了这样的事情，但无法获取值：

```
foreach (string key in ConfigurationManager.AppSettings)
{
    if (key.StartsWith("Service1URL"))
    {
        string value = ConfigurationManager.AppSettings[key];            
    }

    string[] repositoryUrls = { value };
} 
```

要么我做错了，要么在这里遗漏了一些东西。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2013-03-11T00:56:53.437

我会使用一点 LINQ：

```
string[] repositoryUrls = ConfigurationManager.AppSettings.AllKeys
                             .Where(key => key.StartsWith("Service1URL"))
                             .Select(key => ConfigurationManager.AppSettings[key])
                             .ToArray(); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-11T00:50:16.310

您正在为每次迭代覆盖数组

```
List<string> values = new List<string>();
foreach (string key in ConfigurationManager.AppSettings)
        {
            if (key.StartsWith("Service1URL"))
            {
                string value = ConfigurationManager.AppSettings[key];
                values.Add(value);
            }

        }

string[] repositoryUrls = values.ToArray(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-17T12:53:08.940

我定义了一个类来保存我感兴趣的变量并遍历属性并在 app.config 中查找要匹配的内容。

然后我可以随意使用该实例。想法？

```
public static ConfigurationSettings SetConfigurationSettings
{
    ConfigurationSettings configurationsettings = new   ConfigurationSettings();
    {
        foreach (var prop in  configurationsettings.GetType().GetProperties())
        {
            string property = (prop.Name.ToString());
            string value = ConfigurationManager.AppSettings[property];
            PropertyInfo propertyInfo = configurationsettings.GetType().GetProperty(prop.Name);
            propertyInfo.SetValue(configurationsettings, value, null);
        }
    }

    return configurationsettings;
 } 
```

# mysql - 请解释这个mysql查询。

> ID：15329606
> 
> 赞同：3
> 
> 时间：2013-03-11T00:47:52.507
> 
> 标签：mysql

```
SELECT * FROM dogs order by rand(dayofyear(CURRENT_DATE)) LIMIT 1 
```

在我看来，它通过一个随机数对数据库进行排序，并且这个数字每天都在变化。这是一个猜测，因为我需要一天的时间才能确定这是不是真的！

如何更改此查询以每分钟而不是每天按新的随机数对数据库进行排序？我试过这个：

```
SELECT * FROM dogs order by rand(minuteofhour(CURRENT_DATE)) LIMIT 1 
```

但它没有用:(

谢谢你的时间！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T00:51:20.977

随机数生成器 (RNG) 通常需要一个“种子值”，即用于生成随机数的值。如果种子值始终相同，则随机数序列始终相同。这就解释了为什么它每天都在变化。

解决问题的最简单方法（将其更改为每分钟）是找到每分钟更改的种子值。一个很好的将是`ROUND(UNIX_TIMESTAMP()/60)`。

```
SELECT * FROM dogs order by rand(ROUND(UNIX_TIMESTAMP()/60)) LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T10:00:20.703

使用 MySQL 的 funcs MINUTE() 和 NOW() 的组合。NOW 将返回当前日期，MINUTE 从中提取分钟值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T00:57:13.757

我不擅长mysql。但是你确定mysql中有一个功能minuteofhour吗？

查询的想法是从数据库中选择一条随机记录。

你可以这样做：SELECT * FROM dogs order by rand(20) LIMIT 1

它将按列“1-20 的随机数”排序

# ruby-on-rails - 使用 Omniauth 和 Shibboleth 的 Rails

> ID：15329611
> 
> 赞同：1
> 
> 时间：2013-03-11T00:48:39.720
> 
> 标签：ruby-on-rails, apache, omniauth, shibboleth

我在 Omniauth ( [https://github.com/toyokazu/omniauth-shibboleth](https://github.com/toyokazu/omniauth-shibboleth) ) 中使用 shibboleth 作为身份验证提供程序。成功登录并重定向到 rails 后，它无法创建新会话，因为它看不到任何 Shib-Session-ID 或 Shib-Application-ID。在同一台 apache 服务器上，其他 Web 应用程序（java）使用相同的 shibboleth 端点，没有任何问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:14:02.547

您是否尝试过：omniauth-shibboleth 的 :debug 选项？它不显示 Shib-Session-ID 或 Shib-Application-ID 吗？

如果您的 Java Web 应用程序可以正确地从 Apache 接收环境变量，Rails 应用程序的 URI 必须与 Java 应用程序的 URI 不同。您必须将 rails URI 添加到 shibd 配置以保护您的 rails 应用程序。有关详细信息，请参阅自述文件“如何验证用户”部分。

[https://github.com/toyokazu/omniauth-shibboleth](https://github.com/toyokazu/omniauth-shibboleth)

如果你的词'endpoint'表示URI'/yourapp/shibboleth/callback'与Rails 1完全相同，则Shib-Session-ID或Shib-Application-ID应该与:debug选项一起显示。在这种情况下，我找不到原因。一种可能性是您正在使用单独的 Rails 应用程序服务器，例如 mongrel、thin 或 unicorn 等。由于安全原因，我们目前只支持像 Phusion 乘客这样的 Apache 模块。另请参阅自述文件。

此致

# regex - 大于浮点数的数字

> ID：15329612
> 
> 赞同：0
> 
> 时间：2013-03-11T00:48:51.607
> 
> 标签：regex

我对正则表达式相当陌生，我有时间得到一个我制定的可以正常工作的表达式。以下是我制定的表达方式。

```
^((?!^1[0-6]*\.?[0-2][0-4]+)^(\d+))$ 
```

我正在尝试构建一个表达式来验证大于 16.24 的数字。输入需要能够接受像 17 这样的整数，而无需用户输入 17.00 来验证。关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:59:42.957

您可以这样做的一种方法是使用正则表达式来提取数值，然后将它们解析为一个数字并将它们与所需的常量进行比较。

Javascript：代码示例

数字作为字符串：

```
var test = function(str){
    return 16.24 < parseFloat(str);
};
console.log( test("234.23") == true ); // true
console.log( test("-234.23") == false ); // true 
```

隐藏在带有其他字符的字符串中的数字。

```
var test = function (str) {
    var re,
    num;

    if (/[eE]/.test(str)) {
        // search for scientific numbers
        re = /-?\d+(\.\d+)?[eE]\d+/;
    } else {
        // search for whole or decimal numbers
        re = /-?\d+(\.\d{1,2})?/;
    }
    num = str.match(re);
    return 16.24 < parseFloat(num);
};
console.log(test("input = 234.23") == true); // true
console.log(test("input = 2e34") == true); // true
console.log(test("input = -2e34") == false); // true
console.log(test("input = -234.23") == false); // true 
```

# ios - 更改标签文本

> ID：15329618
> 
> 赞同：0
> 
> 时间：2013-03-11T00:49:50.823
> 
> 标签：ios, objective-c

我正在开发一个 iOS 应用程序，使用 Xcode 4.6 在 Objective-C 中进行编码。我有两个通过 push segue 连接的屏幕。在第一个中，我有一个将由用户填写的文本字段，在第二个中我有一个标签，我想用第一个屏幕文本框文本填充该标签文本。每个屏幕我也有 1 个类，所以我有 FirstController.h、FirstController.m、SecondController.h、SecondController.m。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T00:51:49.250

当您从第一个视图控制器转到第二个视图控制器时，您可以将标签作为属性公开在第二个视图控制器中，然后在您的第一个视图控制器的方法（您需要对其进行子类化）中设置该标签，命名为：

[`[UIViewController prepareForSegue: sender:]`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/prepareForSegue%3asender%3a)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T00:52:17.590

确保您创建了一个 segue。然后，您可以使用以下方式传递数据：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    SecondController *second = [segue destinationViewController];
    second.label.text = textBox.text;

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T05:58:16.473

如果您的标签中有属性，则可以在创建 的实例并调用其属性后`SecondViewController`使用`prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender`方法设置其文本`SecondViewController`

```
`secondViewController.myLabel.text = @"some text"; 
```

如果您将标签作为实例变量，请使用`NSString`标签文本将文本传递给第二个视图

```
`secondViewController.txtStr=@"some text"; 
```

并在方法中`SecondViewController`设置标签的文本`viewDidLoad`。

# windows - SetWindowsHookEx 发送多个事件

> ID：15329621
> 
> 赞同：1
> 
> 时间：2013-03-11T00:50:09.103
> 
> 标签：windows, xna, keyboard, keyboard-hook, setwindowshookex

我将 SetWindowsHookEx 与 C# 一起使用，以允许我缓冲键盘输入（用于文本框）。

现在的基本设置是，每次我创建一个新的文本框时，文本框都会在内部创建一个新的“KeyboardBuffer”对象，然后设置一个键盘挂钩：

```
 public KeyboardBuffer(IntPtr whnd)
    {
        this.ProcessMessagesCallback = new GetMsgProc(ProcessMessages);
        this.HookHandle = SetWindowsHookEx(HookId.WH_GETMESSAGE, this.ProcessMessagesCallback,
                                           IntPtr.Zero, GetCurrentThreadId());
    } 
```

（完整的代码可以在[这里](http://xboxforums.create.msdn.com/forums/p/91491/548796.aspx#548796)看到）

问题是，如果我有 N 个文本框，当我输入一个文本框时，我会收到 N 次相同的字符，问题源于 SetWindowsHookEx 不区分 .NET 实例。

我通过制作一个所有文本框都可以访问的静态 KeyboardBuffer 对象暂时解决了这个问题，但这导致了许多其他问题，而且在我看来，这看起来很简单。

有更好的解决方案吗？

提前致谢。

编辑：我对此进行了更多的考虑，并且我意识到我可以在禁用/启用缓冲区时删除/重置挂钩。设置挂钩是否有任何明显的开销？

# ios6 - GKTurnBasedMatch handleMatchEnded：未调用

> ID：15329625
> 
> 赞同：2
> 
> 时间：2013-03-11T00:50:25.023
> 
> 标签：ios6, game-center, gamekit, gkturnbasedmatch

我正在使用*GameKit*和*GKTurnBased* API 编写一个简单的 2 人棋盘游戏，我的问题是在我的游戏结束时，我想检测一个玩家赢了另一个输了。

首先，**handleTurnEventForMatch:didBecomeActive:**方法被触发，在这个方法中，我检查了其他参与者的状态：

```
// Test other players status
    for(GKTurnBasedParticipant *participant in match.participants)
    {
        if([participant.playerID isEqualToString:[GKLocalPlayer localPlayer].playerID])
            continue;

        if(participant.matchOutcome == GKTurnBasedMatchOutcomeQuit || participant.matchOutcome == GKTurnBasedMatchOutcomeLost)
        {
            [self findMeInMatch:match].matchOutcome = GKTurnBasedMatchOutcomeWon;
            [match endMatchInTurnWithMatchData:match.matchData
                             completionHandler:nil];
            return;
        }
        else if(participant.matchOutcome == GKTurnBasedMatchOutcomeWon)
        {
            [self findMeInMatch:match].matchOutcome = GKTurnBasedMatchOutcomeLost;
            [match endMatchInTurnWithMatchData:match.matchData
                             completionHandler:nil];
            return;
        }
        else if(participant.matchOutcome == GKTurnBasedMatchOutcomeTied)
        {
            [self findMeInMatch:match].matchOutcome = GKTurnBasedMatchOutcomeTied;
            [match endMatchInTurnWithMatchData:match.matchData
                             completionHandler:nil];
            return;
        }
        else
        {
            // OK
        }
    }
[...] 
```

我现在的问题是永远不会调用**handleMatchEnded:**方法......奇怪的是，这个方法是与**handleTurnEventForMatch:didBecomeActive:**相同的委托协议的一部分，它实际上是有效的。

欢迎任何想法。

干杯。

**03/17 更新：** 由于我的第一个玩家退出是轮到的，而第二个玩家结束了比赛，我认为这两个玩家不会收到该事件。此事件可能是为游戏中的其他玩家制作的，或者当其他玩家离开时玩家不在应用程序内时。在文档中没有找到任何相关的内容，但它似乎是合乎逻辑的。

西里尔

# php - ORM 会导致糟糕的编码实践吗？

> ID：15329627
> 
> 赞同：1
> 
> 时间：2013-03-11T00:50:45.027
> 
> 标签：php, orm, coding-style, doctrine

我们在团队的 PHP 中使用 ORM，我在两个单独的项目中注意到，即使我们专门详细讨论了良好的 MVC 设计，ORM 似乎允许人们从视图中进行数据库查询层和创建难以维护的代码。

我倾向于这样一种观点，即 ORM 使得在程序员没有想到的情况下进行查询变得太容易了。通过将 ORM 对象返回到视图层，程序员实际上是在将数据库连接泄漏到不应该有它的层。

我在这里正确地考虑 ORM 吗？如果是这样，为什么它如此受欢迎？如果我没有正确考虑它，我*应该*如何解决这些问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T01:02:39.023

我会说你没有正确地考虑它。ORM 本身并不会促进不良做法，至少不会以您体验它的方式。

ORM 是一个工具，就像任何其他框架、api 或其他任何东西一样，您可以正确使用它，也可以不正确使用它。

听起来问题更像是您团队中的开发人员对 MVC 模式没有清晰的理解。我首先要解决这个问题。

我认为 MVC 模式的一个常见问题是开发人员倾向于将视图和控制器用于他们不应该做的事情。原因可能有很多，但每当你使用这样的东西时，我相信问题通常始于类似于这个想法的东西：

> “这么简单的小事，我就在这里做，在那里做没有意义。”

基本上，当试图解耦设计和业务逻辑时，总会有一些情况更容易实现一些实际上属于表示层的业务层的部分。这不一定意味着开发人员很糟糕，但它可能表明缺乏经验或懒惰。我知道我曾多次犯过这件事，比如在为 Android 开发时（虽然从来没有专业过:)）。

尝试找出一些使用您注意到的一些不良做法的示例案例，并拥有某种编码道场，您作为一个团队可以使代码变得更好并正确实施，如果您有时间，请展示拥有属于它们的东西的实际好处。我强烈建议不要使用实际代码，除非您自己编写或负责该代码的开发人员可以接受在其他开发人员面前被破坏。但这显然取决于您公司的文化以及开发人员是否对这类事情感兴趣并持开放态度。我个人很想在我的工作场所拥有类似的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T01:15:56.740

我不知道在视图层中有小的 ORM 调用*一定*很糟糕。例如，我可能有`foreach (Category::getAll() as $Category):`一个循环来列出页面上的类别。连接不会泄漏到视图的范围内（或者无论如何它当然不应该），因为它是由 ORM 封装的。我*可以*在控制器中分配这个调用的结果，并将对象数组传递给模板（我当然会使用更复杂的调用），但在视图中，imo 微不足道的情况很好。

根据我的经验，ORM 的最大问题是“n+1”数据库查询计数的增长。通常，屏幕上的一对多列表可以从单个查询中呈现，但是 ORM 使得对一个表使用主循环非常方便，然后对辅助表的每个实例进行单独的选择。这是低效的，但您只会注意到当您的数据库开始因为它必须处理的查询数量的增加而嘎嘎作响时。

最好的防范措施是让您的开发人员在开发模式下运行工具栏（例如 Symfony2 工具栏、PHP Debug 或类似工具），向他们显示构建屏幕所需的查询数量。当琐碎的屏幕开始需要超过 50 个查询（或您指定的任何上限）时，它们需要重构。

此外，值得选择具有合理表达查询语法的 ORM，否则您的开发人员将回避到“原始 SQL”模式，这会破坏首先使用 ORM 的一些原因。出于同样的原因 - Daniel 很好地说明了这一点 - 为您的开发人员提供有效使用 ORM 的培训是一个好主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T01:04:19.183

从视图中进行查询是一种不好的做法。您可以这样做，但最好通过控制器通过 Ajax 请求或您认为合适的任何方式进行。

# google-maps - 两台计算机上的 googlemap-route 通过 GPS 同步和更新

> ID：15329634
> 
> 赞同：0
> 
> 时间：2013-03-11T00:51:13.097
> 
> 标签：google-maps, gps

我想要一个软件来管理我的送货服务司机。

我的计划：

*   一个 googlemaps 路线规划器，我可以在其中适应驾驶订单。
*   司机在他的车里有一个上网本，里面有相同的 googlemaps-route planner。它与我的地图同步。
*   司机有一个全球定位系统，可以显示他在地图上的位置。
*   驾驶员可以将路线规划器用作导航软件。

这可能吗？我该如何实施？

是否已经有我可以使用的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T10:04:27.110

没有简单的解决方案。这将需要一些高级编程技能，所以如果我在您的位置，我只需将您的驱动程序安装在通常带有 GPS 接收器的平板电脑/智能手机中，并尝试为 Android/iOS 平台找到现成的解决方案，因为这些是最受欢迎的今天。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T10:53:22.997

对您的 4.points 的回答：

1）可以工作，您通过互联网将位置发送到他的平板电脑上的应用程序，该应用程序调用该位置的路线规划器。

2) 是的，见 1)

3) 是的，您在上网本上的应用程序将 coodsinates 发送到您的服务器。

4）不，我知道这是谷歌禁止的。请参阅 google 许可条件，进一步从技术上讲它是行不通的。

第 4 点理论上可以通过 OpenSoure Navi 解决方案解决，但与专业导航相比，它们都给出了糟糕的路线。

最近 TomTom 提供了一种与 TomTom 导航（特殊版本）交互的解决方案。

但是考虑到你的任务需要一些人多年的努力。

# algorithm - 计算二叉树中每个节点的子树大小的运行时间是多少

> ID：15329637
> 
> 赞同：0
> 
> 时间：2013-03-11T00:51:34.203
> 
> 标签：algorithm, binary-tree

当我做一个二叉树练习时，我有一个问题让我很困惑：

给定具有 n 个节点的二叉树（通过指向其根的指针）。令 size(n) 表示以节点 n 为根的子树中的节点数。为树的每个节点 n 计算 size(n) 的必要和充分时间是多少？

任何人都可以就上述问题给我一些提示吗？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T09:33:25.580

@user1952500 算法有几个错误：

1.  在 void 函数内返回 0
2.  添加到 node->num 而不给出初始值
3.  不遍历子节点来计算子树大小

所以一个固定的版本是：

```
struct tree
{
    int num;
    struct tree *l;
    struct tree *r;
};

void sizeofnode(tree *node)
{
    if (node) { 
        node->num = 1; // Our size

        if (node->l) {
            sizeofnode(node->l);       // Calculates size of left subtree
            node->num += node->l->num; // Adds size of left subtree
        }

        if (node->r) {
            sizeofnode(node->r);       // Calculates size of right subtree
            node->num += node->r->num; // Adds size of right subtree
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:55:00.883

要获取以 n 为根的子树的大小，您必须递归地获取每个子树的大小。这实质上意味着您最终会访问树的每个节点。

所以我相信时间复杂度是O(n)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T01:18:00.010

如果你可以有 O(n) 空间，那么你可以有一个 O(n) 解决方案：

这里 'num' 是 O(n) 空间的原因。

```
struct tree
{
    int num;
    struct tree *l;
    struct tree *r;
};

void sizeofnode(tree *node)
{
    if (!node) {
        return;
    }
    node->num = 0;

    if (node->l) {
        node->num += node->l->num; // size of left subtree
    }

    if (node->r) {
        node->num += node->r->num; // size of right subtree
    }

    node->num ++; // this is to add the size of the root of the subtree

    return;
} 
```

# printing - python print命令在每个字符串的开头显示'u前缀，为什么会发生这种情况？

> ID：15329642
> 
> 赞同：0
> 
> 时间：2013-03-11T00:52:01.527
> 
> 标签：printing, prefix

我是 Python 新手，通过 codecademy 学习。在他们的练习中，我注意到每当我打印一个字符串或字符串列表时，它们都会以 unicode 前缀打印出来。这对我来说很奇怪，因为我认为我必须将字符串指定为 unicode，以便 python 使用 unicode 前缀将它们吐出。我在 google python class 网页上阅读了以下内容：

'常规 Python 字符串*不是*unicode，它们只是纯字节。要创建 unicode 字符串，请在字符串文字上使用 'u' 前缀'

相比之下，当我在终端中运行我用于 codecademy 练习的代码（即循环第 2 节中的 For your Hobbies 练习）时，打印的字符串没有 unicode 前缀......这是预期的。我没想到的是，即使我将字符串指定为 unicode，终端也会在没有前缀的情况下打印它们。我正在运行 python 2.7.2

你能帮我理解字符串打印的细节吗？这是特定于平台的问题吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T15:32:33.390

[请参阅下面的 stackoverflow 问题和接受的答案，了解您为何获得 unicode 标记](https://stackoverflow.com/questions/4855645/how-to-remove-the-u-as-in-unicode-in-usomestring)。

简短的版本是您可以将返回值包装在 str() 中以获取普通的、无前缀的输出。

# ruby-on-rails - Ruby on Rails - 每月最高票数

> ID：15329643
> 
> 赞同：2
> 
> 时间：2013-03-11T00:52:07.940
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2, voting, favorites

我需要一些关于 Rails 投票系统的建议，该系统每月都会识别出票数最高的人。我有一个可以工作的系统，但对 Rails 不熟悉，我确信有更有效的方法可用。以下是我当前设置的简化版本（省略了控制器代码）：

```
class Charity < ActiveRecord::Base
  has_many :votes
end

class Vote < ActiveRecord::Base
  belongs_to :charity
end 
```

我的架构如下：

```
ActiveRecord::Schema.define(:version => 20130310015627) do
  create_table "charities", :force => true do |t|
    t.string   "name"
    t.text     "description"
    t.date     "last_win"
    t.datetime "created_at",  :null => false
    t.datetime "updated_at",  :null => false
  end 
  create_table "votes", :force => true do |t|
    t.integer  "charity_id"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end
end 
```

我将使用 'whenever' gem 运行一个 cron 作业来确定每月获胜者并更新 charities 表的 'last_win' 列。以下代码是我质疑我的效率的地方：

```
vote_counts = Vote.count(:group => "charity_id")
most_votes = vote_counts.values.max
winning_ids = vote_counts.map{|k,v| v == most_votes ? k :nil }.compact
charities = Charity.find(winning_ids)
charities.each {|charity| charity.update_attributes(:last_win => Date.today)} 
```

我相信有很多方法可以更好地做到这一点，并希望得到一些建议。如果您对设置投票表/关联的更好方法有建议，我们也将不胜感激。

提前致谢， CRS

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:32:35.767

像这样的东西：

如果只有一个赢家，我认为这会奏效

```
winner_id = Vote.group(:charity_id).order("count(*) desc").pluck(:charity_id).first
Charity.find(winner)id).update_attribute!(:last_win => Date.today) 
```

您可以修改它的关系：

```
most_votes = Vote.group(:charity_id).order("count(*) desc").count.first[1]
winners = Vote.group(:charity_id).having("count(*) = ?", most_votes).pluck(:charity_id)

Charity.where(:id => winners).update_all(:last_win => Date.today) 
```

确保所有内容都在您的数据库中正确编入索引，

您可能可以更简化它，但 SQL 会变得更加复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T01:16:42.700

最后两行可能是：

```
Charity.where(id:winning_ids).update_all(last_win:Date.today) 
```

这将转化为单个 SQL 更新命令，而不是为每个获奖慈善机构发出更新命令。

您确定获胜慈善机构的第一部分看起来不错，并且由于您将其作为一项 cron 工作运行，您可能不在乎它是否需要几分钟。

但是，如果您想实时显示值，您可以添加一个`after_create`钩子`Vote`来更新其所有者慈善机构的计数器（可能在另一个表中）：

```
class Vote < ActiveRecord::Base
  belongs_to :charity
  after_create :increment_vote_count
  CharityVote.where(year:Time.now.year, month:Time.now.month, 
    charity_id:self.charity_id).first_or_create.increment!(:counter)
end 
```

# python - python程序错误elif else if

> ID：15329646
> 
> 赞同：-7
> 
> 时间：2013-03-11T00:52:42.423
> 
> 标签：python, if-statement

```
def Game():

    # Story Background
    print "You decide to take a walk outside one night when you come accross a corn field."
    print "You notice an omnious sound coming from the other side of the maze."
    Enter = raw_input("Do you enter? (yes or no)")

    if Enter == "Yes" or "yes":
        print "You walk into the maze and the corn is so thick together you cant push through"
        print "so you walk down the isle surrounded by corn and you come to an intersection."
        turn = raw_input("Which way do you go? (Left, Right, Forward, Leave)")

        if turn == "Left" or "left":
            print "After you turn left you come accross a dead end and you are forced to turn around."
            print "You return to the intersection."
            turn2 = raw_input("Which way do you go? (Left, Forward, Leave)")

            if turn2 == "Forward" or "forward":
                print "you walk on deeper into the maze when you come to a left turn"
                print "you turn left and come accross a crossroad."
                turn3 = raw_input("Which way do you go? (Left, Right, Leave)")

                if turn3 == "Right" or "right":
                    print "You come to a dead end and are forced to turn around"
                    turn4 = raw_input("Which way do you go? (Forward, Leave)")

                    if turn4 == "Forward" or "forward":
                        print "You walk to a hole in the ground stopping you from moving any further"
                        print "the hole seems to be filled with snakes so you cant go through it."
                        print "you are forced to leave the maze."

                    elif turn4 == "leave" or "Leave":
                        print "you leave the maze and return home."

                    else:
                         print "you walk into a wall and go into an irreversable coma"

                elif turn3 == "Left" or "left":
                    print "You walk to a hole in the ground stopping you from moving any further"
                    print "the hole seems to be filled with snakes so you cant go through it."
                    print "you are forced to leave the maze."
                    print "you leave the maze and return home."

                else:
                    print "you walk into a wall and go into an irreversable coma"

            elif turn2 == "Left" or "left":
                print "you turn Left into the maze when you come by a strange man laying on the ground."
                man == raw_input("What do you do? (Help, keep going)")

                if man == "Help" or "help":
                    print "you help the man up and he knocks you out cold"
                    print "you wake back up in your bed at home"

                elif man == "keep going" or "Keep going":
                    print "You leave the man behing after stealing his wallet."
                    print "YOU HAVE REACHED THE END OF THE MAZE"
                    print "You realize the noise was the sound of a old farmer milking a cow."
                    print "The farmer nags at you for coming on private property."

                else:
                    print "you walk into a wall and go into an irreversable coma"

            elif turn2 == "leave" or "Leave":
                print "you leave the maze and return home."

            else:
                print "you walk into a wall and go into an irreversable coma"

        elif turn == "Forward" or "forward":
            print "you move forward into the maze when you come by a strange man laying on the ground."
            man == raw_input("What do you do? (Help, keep going)")

            if man == "Help" or "help":
                    print "you help the man up and he knocks you out cold"
                    print "you wake back up in your bed at home"

            elif man == "keep going" or "Keep going":
                    print "You leave the man behing after stealing his wallet."
                    print "YOU HAVE REACHED THE END OF THE MAZE"
                    print "You realize the noise was the sound of a old farmer milking a cow."
                    print "The farmer nags at you for coming on private property."

            elif turn == "leave" or "Leave":
                    print "you leave the maze and return home."

            else:
                print "you walk into a wall and go into an irreversable coma"

        elif turn == "Right" or "right":
            print "After you turn right you come into a left turn only path."
            print "You turn left and you come to a crossroad."
            turn = raw_input("Which way do you go? (Left, Right, Leave)")

            if turn == "Right" or "right":
                print "You come to a dead end and are forced to turn around"
                turn = raw_input("Which way do you go? (Forward, Leave)")

                if turn == "Forward" or "forward":
                    print "You walk to a hole in the ground stopping you from moving any further"
                    print "the hole seems to be filled with snakes so you cant go through it."
                    print "you are forced to leave the maze."

                else:
                    print "you walk into a wall and go into an irreversable coma"

            elif turn == "Forward" or "forward":
                print "You walk to a hole in the ground stopping you from moving any further"
                print "the hole seems to be filled with snakes so you cant go through it."
                print "you are forced to leave the maze."

            else:
                print "you walk into a wall and go into an irreversable coma"

        elif turn == "Leave" or "leave":
            print "you leave the maze and return home."

        else:
            print "you walk into a wall and go into an irreversable coma"

    elif Enter == "No" or "no":
        print "You walk on into the depths of the night and are robbed by a couple street thugs."

    else:
        print "you walk into a wall and go into an irreversable coma"

def main():

    Game()

main() 
```

当我使用这个程序时，无论我进入 python shell，它都会一遍又一遍地说同样的事情.. 它不会将 raw_input 语句放入上下文中并将它们放入 if 语句中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:00:09.103

```
if Enter == "Yes" or "yes": 
```

这不是`or`工作方式。这被解释为`if (Enter == "Yes") or "yes":`。在 python 中，非空字符串总是正确的，所以所有`if`类似的语句都是正确的。我会建议像

```
if Enter.lower() == "yes": 
```

它处理所有的大写/小写组合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T00:58:39.513

您的语法在这里是错误的：

```
if Enter == "Yes" or "yes": 
```

这个条件永远成立。`Enter == "Yes"`首先被评估。如果布尔表示为`False`，`"yes"`则将考虑 的布尔表示。`bool("yes")`总是`True`。

考虑做类似的事情：

```
if Enter in ('Yes', 'yes'): 
```

或者：

```
if Enter.lower() == 'yes': 
```

# python - IDLE中如何同时运行两个模块

> ID：15329649
> 
> 赞同：7
> 
> 时间：2013-03-11T00:53:03.660
> 
> 标签：python, sockets, python-idle

我正在开发一个超级简单的套接字程序，我有客户端代码和服务器代码。如何同时运行这两个 .py 文件以查看它们是否有效？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-11T01:01:14.627

您可以同时运行多个 IDLE/Python shell 实例。因此，打开 IDLE 并运行服务器代码，然后再次打开 IDLE，这将启动一个单独的实例，然后运行您的客户端代码。

# model-view-controller - 在弹出模式下无法访问 Kendo Grid 自定义编辑器下拉菜单

> ID：15329651
> 
> 赞同：0
> 
> 时间：2013-03-11T00:53:22.630
> 
> 标签：model-view-controller, grid, kendo-ui

我正在使用剑道网格，我需要将下拉列表显示为网格中的一列，以允许用户选择状态。在这里，每个记录的状态来源可能不同。状态的来源因记录的 TaskInstanceId 属性而异。

我遇到的问题是在弹出编辑模式下没有显示下拉列表列。并且在我进入编辑模式之前，不会显示内联编辑模式下拉列表。在我进入编辑模式之前，它会显示文本框中没有值的文本框。

请找到此电子邮件随附的示例项目。

问候， 桑杰·帕特尔

# php - PHP正则表达式替换字符串中的数字

> ID：15329653
> 
> 赞同：0
> 
> 时间：2013-03-11T00:53:50.187
> 
> 标签：php, regex

我正在尝试使用正则表达式将字符串中的数字替换为另一个数字。这应该非常简单，但由于某种原因，今天让我很伤心。字符串中的“feed”是动态的，只能包含字母或数字。

这是我尝试过的：

```
$new_number = 999;
$string = '/feed/page/1/?param=true';
preg_replace('/\/([0-9a-z])\/page\/([0-9])\/(.*)/i', '/$1/page/'.$new_number.'/$3', $string); 
```

应该输出：'/feed/page/999/?param=true'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:12:48.530

忘记+的，是吗？:P 试试这个作为你的正则表达式：

```
'/\/([0-9a-z]+)\/page\/([0-9]+)\/(.*)/i' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T01:01:38.857

试试这个：

```
\/([0-9a-z]{1,})\/page\/([0-9]{1,})\/(.*) 
```

# javascript - 仅从对象文字中获取值

> ID：15329655
> 
> 赞同：-2
> 
> 时间：2013-03-11T00:54:37.023
> 
> 标签：javascript

从这个问题继续：[Getting first object from javascript litteral](https://stackoverflow.com/questions/15286159/getting-first-object-from-javascript-litteral)

是否可以仅从一组名称：值对中获取值？假设我们有一个对象列表，每个对象都有任意数量的值：

```
var items = [
    {name:"Foo", age:16, gender:"m"},
    {name:"Bar", age:17, gender:"f"},
    {name:"foo", age:16, gender:"m"},
    {name:"bar", age:18, gender:"m"},
    {name:"foobar", age:18, gender:"f"},
    {name:"barfoo", age:20, gender:"f"}
]; 
```

如何返回如下列表：

```
var items = [
    ["Foo", 16, "m"],
    ["Bar", 17, "f"],
    ["foo", 16, "m"],
    ["bar", 18, "m"],
    ["foobar", 18, "f"],
    ["barfoo", 20, "f"]
]; 
```

我已经尝试过了，但想知道是否有更好的方法。

```
Array.prototype.getValues = function () {
    if(typeof(this[0]) != typeof({}))
        throw "Array values are expected to be == typeof({})";
    var items = [];
    for (var i = 0; i < this.length; i++) {
        var r = [];
        for (var l in this[i]) {
            r.push(this[i][l]);
        }
        items.push(r);
    }
    return items; 
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T00:56:50.393

```
var newitems=[];
//loop through each item in the original
for(var i =0; i<items.length; i++)
{
  newitems[i] = [];
  //loop over the properties in each element and push it to an array
  for(var prop in items[i]){
    newitems.push(items[i][prop]);
  }
} 
```

或者：

```
var newitems = items.map(function(elem){
  var item = [];
  for(var prop in elem){
    item.push(elem[prop]);
  }
  return item;
}) 
```

# ios - iOS - NSUserDefaults 值为“valueForKey”返回 null 但不为 null

> ID：15329662
> 
> 赞同：0
> 
> 时间：2013-03-11T00:55:36.423
> 
> 标签：ios, null, nsuserdefaults

我试图通过检索每个产品标识符的 NSUserDefaults 值来查看用户是否进行了购买。我在购买产品并且设置正确时保存了价值。

**调用此键时，键值对正确显示：**

```
NSLog(@"%@", [[NSUserDefaults standardUserDefaults] dictionaryRepresentation]); 
```

**像这样：**

```
"com.COMPANY.PRODUCTIDENTIFIER" = 1; 
```

**但是，当我尝试实际验证该特定键值时，它总是返回 null：**

```
 for (NSString * productIdentifier in _productIdentifiers) {
        NSLog(@"ProductIdentifier: %@",productIdentifier);
        NSLog(@"Defaults Value: %@",[[NSUserDefaults standardUserDefaults] valueForKey:productIdentifier]);
        NSLog(@"Defaults Bool: %d",[[NSUserDefaults standardUserDefaults] boolForKey:productIdentifier]);
        NSLog(@"Defaults Object: %@",[[NSUserDefaults standardUserDefaults] objectForKey:productIdentifier]);
        BOOL productPurchased = [[NSUserDefaults standardUserDefaults] boolForKey:productIdentifier];
        if (productPurchased) {
            [_purchasedProductIdentifiers addObject:productIdentifier];
            NSLog(@"Previously purchased: %@", productIdentifier);
        } else {
            NSLog(@"Not purchased: %@", productIdentifier);
        }
    } 
```

**结果如下：**

```
2013-03-10 17:45:13.609 COMPANY[1140:907] ProductIdentifier:  com.COMPANY.PRODUCTIDENTIFIER
2013-03-10 17:45:13.611 COMPANY[1140:907] Defaults Value: (null)
2013-03-10 17:45:13.612 COMPANY[1140:907] Defaults Bool: 0
2013-03-10 17:45:13.611 COMPANY[1140:907] Defaults Object: (null) 
```

*注意 - 上述方法都按此顺序在同一个方法中调用，因此应用程序尚未加载默认值或类似的东西不是问题，因为该值通过“dictionaryRepresentation”方法正确显示。此外，为了隐私，公司和产品标识符已被替换。真正的应用程序中没有拼写错误，所以这不是问题。*

**更新**

好的，这很有趣。如果我使用静态字符串作为键，它会返回正确的值。但是使用'productIdentifier'（即NSString）不会，即使记录'productIdentifier'它是完全相同的字符串......任何想法？？？

**代码：**

```
 for (NSString *productIdentifier in _productIdentifiers) {
        NSLog(@"ProductIdentifier: %@",productIdentifier);
        NSLog(@"Defaults Value: %@",[[NSUserDefaults standardUserDefaults] valueForKey:productIdentifier]);
        NSLog(@"Defaults Bool: %d",[[NSUserDefaults standardUserDefaults] boolForKey:productIdentifier]);
        NSLog(@"Defaults Object: %@",[[NSUserDefaults standardUserDefaults] objectForKey:productIdentifier]);
        NSLog(@"Static Key: %d",[[NSUserDefaults standardUserDefaults] boolForKey:@"com.COMPANY.PRODUCTIDENTIFIER"]);
        BOOL productPurchased = [[NSUserDefaults standardUserDefaults] boolForKey:productIdentifier];
        if (productPurchased) {
            [_purchasedProductIdentifiers addObject:productIdentifier];
            NSLog(@"Previously purchased: %@", productIdentifier);
        } else {
            NSLog(@"Not purchased: %@", productIdentifier);
        }
    } 
```

**结果：**

```
2013-03-10 17:45:13.609 COMPANY[1140:907] ProductIdentifier:  com.COMPANY.PRODUCTIDENTIFIER
2013-03-10 17:45:13.611 COMPANY[1140:907] Defaults Value: (null)
2013-03-10 17:45:13.612 COMPANY[1140:907] Defaults Bool: 0
2013-03-10 17:45:13.611 COMPANY[1140:907] Defaults Object: (null)   
2013-03-10 17:45:13.611 COMPANY[1140:907] Static Key: 1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T01:17:29.973

问题是您使用 of`valueForKey:`而不是`objectForKey:`. `valueForKey`具有不同的语义（键值编码），尤其是与其中包含点的键一起使用时。

改变这个：

```
[[NSUserDefaults standardUserDefaults] valueForKey:productIdentifier] 
```

对此：

```
[[NSUserDefaults standardUserDefaults] objectForKey:productIdentifier] 
```

它应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T00:06:21.780

问题是正在使用的 NSSet 中的产品标识符有一个前导空格，因此它永远不会直接匹配。

# java - Java（Swing）：MouseMoved 根本不工作

> ID：15329664
> 
> 赞同：3
> 
> 时间：2013-03-11T00:55:51.007
> 
> 标签：java, swing, mouselistener

这让我发疯了。这一定是一个非常简单的问题，但我不可能看到它。

基本上 mouseMoved 永远不会被调用。下面是代码。

```
public class MouseMotionThing {
public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {

        @Override
        public void run() {
            JFrame jFrame = new JFrame();
            jFrame.setContentPane(new ContentPane());
            jFrame.setSize(400, 400);
            jFrame.setVisible(true);
            jFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        }
    }); 
}
} 
```

还有我的面板。此实现使用 MouseInputListener：

```
class ContentPane extends JPanel implements MouseInputListener {
int x = 0, y = 0;

public ContentPane() {
    setOpaque(true);
    addMouseListener(this);
    addMouseMotionListener(this);

}

@Override
protected void paintComponent(Graphics g) {
    super.paintComponent(g);

    g.drawLine(0, 0, x, y);
}

@Override
public void mouseDragged(MouseEvent e) {
    System.out.println("Mouse Dragged!");
}

@Override
public void mouseMoved(MouseEvent e) {
    System.out.println("CALLED MOUSE MOVED");
    x = e.getX();
    y = e.getY();

    repaint();
}

@Override
public void mouseClicked(MouseEvent e) {
}

@Override
public void mousePressed(MouseEvent e) {
}

@Override
public void mouseReleased(MouseEvent e) {
}

@Override
public void mouseEntered(MouseEvent e) {
}

@Override
public void mouseExited(MouseEvent e) {
}
} 
```

而此替代实现仅使用 MouseMotionListener：

```
class ContentPane extends JPanel implements MouseMotionListener {
int x = 0, y = 0;

public ContentPane() {
    setOpaque(true);
    addMouseMotionListener(this);

}

@Override
protected void paintComponent(Graphics g) {
    super.paintComponent(g);

    g.drawLine(0, 0, x, y);
}

@Override
public void mouseDragged(MouseEvent e) {
    System.out.println("Mouse Dragged!");
}

@Override
public void mouseMoved(MouseEvent e) {
    System.out.println("CALLED MOUSE MOVED");
    x = e.getX();
    y = e.getY();

    repaint();
}
} 
```

在上述替代实现中，都没有调用 mouseMoved。我每次都在添加正确的听众，但它根本不起作用。mouseDragged 工作正常。我错过了什么？

LE：我在 Ubuntu 12.10 和 JDK 7 上测试了代码，运行良好。然后当我回到我的 W8 机器时，它开始工作了。我只是重新启动笔记本电脑。我无法重现该问题，也无法追踪它，但如果我再次遇到它并设法找到一些东西，我会回来的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:21:05.150

目前还不清楚哪里出了问题。进行完整构建可能会有所帮助。作为参考，我重新考虑了您的[sscce](http://sscce.org/)以使用 a`MouseAdapter`并`this`从`JPanel`.

```
import java.awt.Graphics;
import java.awt.Point;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class MouseMotionThing {

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                JFrame jFrame = new JFrame();
                jFrame.add(new MousePanel());
                jFrame.pack();
                jFrame.setSize(400, 400);
                jFrame.setVisible(true);
                jFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            }
        });
    }

    private static class MousePanel extends JPanel {

        Point p = new Point();

        public MousePanel() {
            setOpaque(true);
            addMouseMotionListener(new MouseHandler());
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            g.drawLine(0, 0, p.x, p.y);
        }

        private class MouseHandler extends MouseAdapter {

            @Override
            public void mouseDragged(MouseEvent e) {
                update(e);
            }

            @Override
            public void mouseMoved(MouseEvent e) {
                update(e);
            }

            private void update(MouseEvent e) {
                System.out.println(e.paramString());
                MousePanel.this.p = e.getPoint();
                MousePanel.this.repaint();
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-18T21:11:50.363

我碰巧在我贡献的一个应用程序中遇到了类似的问题。我找不到任何其他指向根本原因的东西，所以我开始做一些 Java AWT 日志记录，如 Oracle 的[日志记录概述](http://docs.oracle.com/javase/7/docs/technotes/guides/logging/overview.html)页面所示。

在分析部分文件后，我发现有 5 个鼠标按钮被注册到 JVM：

```
<record>
    <date>2015-06-18T15:45:54</date>
    <millis>1434656754395</millis>
    <sequence>70</sequence>
    <logger>sun.awt.windows.WDesktopProperties</logger>
    <level>FINE</level>
    <class>sun.awt.windows.WDesktopProperties</class>
    <method>setIntegerProperty</method>
    <thread>1</thread>
    <message>awt.mouse.numButtons=5</message>
</record> 
```

我还意识到其他鼠标事件（`MOUSE_ENTERED`, `MOUSE_EXITED`, `MOUSE_DRAGGED`）的`extModifiers`值为`Button5`，这很奇怪，因为我只是使用触摸板而没有按下其他按钮。我不确定这是否会阻止`MOUSE_MOVED`事件被触发——我猜这需要对较低级别的 Java 进行一些研究。

```
<record>
    <date>2015-06-18T15:45:55</date>
    <millis>1434656755026</millis>
    <sequence>329</sequence>
    <logger>java.awt.event.EventDispatchThread</logger>
    <level>FINEST</level>
    <class>java.awt.EventDispatchThread</class>
    <method>pumpOneEventForFilters</method>
    <thread>13</thread>
    <message>Dispatching: java.awt.event.MouseEvent[MOUSE_ENTERED,(388,387),absolute(388,387),button=0,extModifiers=Button5,clickCount=0] on frame0</message>
</record> 
```

我对额外的鼠标按钮进行了一些研究，发现另一个关于[桌面属性](http://docs.oracle.com/javase/7/docs/api/java/awt/doc-files/DesktopProperties.html)的 Oracle 页面。我将 Java 的启动参数更改为 include `-Dsun.awt.enableExtraMouseButtons=false`，瞧，我的应用程序又开始工作了。

`MOUSE_MOVED`我在各种 Windows JRE 上测试了一个非常简单的 Java 应用程序，并且在不设置此参数时它们都表现出相同的问题。

如果您的应用程序中不会使用额外的鼠标按钮，那么这可能是您的解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-06T23:46:51.067

好吧，当我在 Windows 8 上使用 A4TECH G10-770F 鼠标时，似乎遇到了这些问题。如果我将其关闭，一切都会恢复正常。不过，我并没有更详细地研究它——我已经有了另一只鼠标，而是使用了那个。

# php - 通过 $_COOKIE 获取 posts_per_page

> ID：15329665
> 
> 赞同：0
> 
> 时间：2013-03-11T00:55:55.133
> 
> 标签：php, wordpress, cookies, setcookie

我似乎无法理解为什么 a) 我的变量没有在页面内返回，b) 为什么似乎为每个单独的页面设置了一个 cookie。

**目标：**

在产品列表中，我可以选择按 5、10 或全部（本示例中的小数字）过滤结果。当我对`$_COOKIE`重置为默认值进行分页时，并且为该页面设置了一次设置。我可以在第 1 页和第 2 页之间交替显示不同的结果列表。

**文件“cookies.php”（之前`<!doctype html>`）：**

```
<?php $post_per_page = $_POST['post_per_page'];
    if (isset($post_per_page)) {
        // Store it in the cookie
        setcookie('post_per_page', $post_per_page, time()+60*60*24, "/");
        // And save in a variable
        $postsperpage = $post_per_page;
    }

    // Then check existing cookies
    else if (isset($_COOKIE['post_per_page'])) {
        $postsperpage = $_COOKIE['post_per_page'];
    }

    // Finally use a default value if none was set
    else {
        // Default to 3 for example:
        $postsperpage = 3;
    }
?> 
```

**在我的 taxonomy.php 中：**

```
$args = array(
    'post_type'         =>      'product',
    'posts_per_page'    =>      $postsperpage,
    'paged'             =>      $paged
); 
```

在这个`$postsperpage`是空的，甚至没有从`cookies.php`. 所以我不得不回忆一下`cookies.php`注释掉该`setcookie`行的内容。

**标记：**

```
<form method="post">
    <button type="submit" name="post_per_page" value="5">5</button>
    <button type="submit" name="post_per_page" value="10">10</button>
    <button type="submit" name="post_per_page" value="-1">ALL</button>
</form> 
```

* * *

# **编辑**

不知何故，cookie 设置已自行修复。但是我仍然很困惑为什么我必须将`cookies.php`内容包含到分类中而不是其初始变量设置是全局的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:24:41.603

除非这些 php 文件包含在同一页面中，否则 $postsperpage 变量在 taxonomy.php 中不存在。如果是这种情况，您应该像这样检索该页面上的 cookie 值...

```
$postsperpage = $_COOKIE['post_per_page']; 
```

# service - 来自 NServiceBus.Host 的 ServiceBase.RequestAdditionalTime()

> ID：15329670
> 
> 赞同：1
> 
> 时间：2013-03-11T00:56:25.523
> 
> 标签：service, timeout, nservicebus, startup

我们有一个 NServiceBus Windows 服务，它在启动时需要一段时间来注册模块。我们想向服务经理请求额外的时间来正确启动。对于不使用 NServiceBus 的服务，这将使用`ServiceBase.RequestAdditionalTime`. 这将如何使用 NServiceBus.Host 完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:47:50.763

我们最终删除了 NServiceBus.Host 并改用 Topshelf。注意服务启动时需要的额外配置。

```
public static void Main(string[] args)
{
    HostFactory.Run(hf =>
    {
        hf.Service<MailboxListenerService>(svc =>
        {
            svc.ConstructUsing(mls => new MailboxListenerService());
            svc.WhenStarted((mls, control) => mls.Start(control));
            svc.WhenStopped(mls => mls.Stop());
        });
    });
}

public class MailboxListenerService
{
    private RunWebApi _webApiRunner;

    public MailboxListenerService()
    {
    }

    public bool Start(HostControl hostControl)
    {
        hostControl.RequestAdditionalTime(TimeSpan.FromSeconds(60));

        var kernel = new StandardKernel(new MailboxListenerModule());

        Configure.With()
            .DefineEndpointName("my.endpoint.name")
            .DefiningEventsAs(t => typeof(Messaging.Markers.IEvent).IsAssignableFrom(t))
            .Log4Net<NlogAppenderForLog4Net>(a => { })
            .NinjectBuilder(kernel)
            .MsmqTransport()
                .MsmqSubscriptionStorage("my.subscription.storage")
            .DisableTimeoutManager()
            .DisableSecondLevelRetries()
            .UnicastBus()
            .ImpersonateSender(false);

        _webApiRunner = kernel.Get<RunWebApi>();
        _webApiRunner.Run();

        return true;
    }

    public void Stop()
    {
        _webApiRunner.Stop();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T18:37:48.557

不幸的是，没有，我们已经打开了一个问题以在未来的版本中支持这一点

[https://github.com/NServiceBus/NServiceBus/issues/1046](https://github.com/NServiceBus/NServiceBus/issues/1046)

解决方法是使用注册表增加您服务的超时时间：

[http://support.microsoft.com/kb/824344](http://support.microsoft.com/kb/824344)

# css - 使用 CSS 将分隔的内容设置为相同的高度

> ID：15329677
> 
> 赞同：-1
> 
> 时间：2013-03-11T00:57:30.540
> 
> 标签：css, layout, height

我正在尝试使我的侧边栏 div 与内容 div 的大小相同，我可以将`container`div 设置为白色并且可以“按照我的意愿”工作，但我需要将这个小的空白背景保持在中间`content`并且`siderbar`看起来它们是分开的...

我已经尝试过这样的事情： [CSS: Set Div height to 100% - Pixels](https://stackoverflow.com/questions/1366548/css-set-div-height-to-100-pixels)

我花了一个多小时试图弄清楚，但这里没有任何工作......我能做到的唯一方法是Javascript，但这并不友好。

这是我的问题的一个例子：http: [//jsfiddle.net/cn7cd/1/](http://jsfiddle.net/cn7cd/1/)

谢谢阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T01:08:20.533

看看这个[http://css-tricks.com/fluid-width-equal-height-columns/](http://css-tricks.com/fluid-width-equal-height-columns/)

它很好地概括了实现您所追求的不同方法

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-11T01:06:32.587

我不知道你是否可以使用一点 JQuery，但如果是这样，这里有一个可能的解决方案

```
var cHeight = $('#content').css('height');
$("#sidebar").css('height',cHeight);
console.log($("#sidebar").css("height")); 
```

[演示](http://jsfiddle.net/cn7cd/2/)

# spring - 像 Spring 的 VelocityEngineUtils 一样可以使用 URL 来模板

> ID：15329678
> 
> 赞同：0
> 
> 时间：2013-03-11T00:57:47.873
> 
> 标签：spring, email, velocity

我正在使用 Spring 和 Velocity 模板发送电子邮件。新的要求是模板不再存储在本地，而是从外部服务中获取。VelocityEngineUtils 需要一个模板的相对路径，但我现在只有一个 URL。虽然我知道我可以在调用 VelocityEngineUtils 之前在本地获取和保存模板，但我想问 Spring 中是否已经有一些可以提供帮助的东西（因为它经常发生）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:24:37.270

您目前正在使用什么速度资源加载器？我假设您正在使用**ClasspathResourceLoader**？

如果您需要通过 URL 从外部服务获取速度模板，您可以指定资源加载器以`org.apache.velocity.runtime.resource.loader.URLResourceLoader`

# c++ - Remove_If 字符串不区分大小写

> ID：15329680
> 
> 赞同：2
> 
> 时间：2013-03-11T00:57:53.667
> 
> 标签：c++, c++11

有人可以告诉我如何使用 Remove_If 进行一些不区分大小写的比较吗？

目前我这样做：

```
template<typename T>
struct is_literal
{
   enum{value = false};
};

template<>
struct is_literal<char>
{
   enum{value = true};
};

template<>
struct is_literal<char*>
{
   enum{value = true};
};

template<>
struct is_literal<const char*>
{
   enum{value = true};
};

template<typename Char, typename Traits, typename Alloc>
struct is_literal<std::basic_string<Char, Traits, Alloc>>
{
   enum{value = true};
};

template<typename T>
template<typename U>
CustomType<T>& CustomType<T>::Delete(U ValueToDelete, bool All, typename std::enable_if<is_literal<U>::value, bool>::type  CaseSensitive)
{
    for (std::size_t I = 0; I < TypeData.size(); ++I)
    {
        if (CaseSensitive ? std::string(TypeData[I]) == std::string(ValueToDelete) : std::string(ToLowerCase(TypeData[I])) == std::string(ToLowerCase(ValueToDelete)))
        {
            TypeData.erase(TypeData.begin() + I);
            if (!All)
                break;
            --I;
        }
    }
    return *this;
} 
```

我想用 remove_if 来做这个。或者至少比这更好的方法。它看起来很丑，我决定优化代码，所以我想出了：

```
if (CaseSensitive)
{
    if (All)
    {
        TypeData.erase(std::remove(TypeData.begin(), TypeData.end(), ValueToDelete), TypeData.end());
    }
    else
    {
        TypeData.erase(std::find(TypeData.begin(), TypeData.end(), ValueToDelete));
    }
}
else
{
    //Do I have to forloop and lowercase everything like before then compare and remove? OR can I do it just like above using std::remove or std::find with some kind of predicate for doing it?
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T01:03:39.387

好吧，因为`remove_if`需要一个谓词参数，所以使用 lambda 应该很容易：

```
std::remove_if(TypeData.begin(), TypeData.end(),
    [&ValueToDelete](U &val){ return ToLowerCase(val) == ToLowerCase(ValueToDelete); }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T01:04:15.117

您可以使用保存状态的结构：

```
struct StringEqualityPredicate {

    std::string str;
    bool caseSensitive;

    StringEqualityPredicate(const std::string& str, bool caseSensitive = true) : str(str), caseSensitive(caseSensitive)
    { }

    bool operator(const std::string& str)
    {
        if (caseSensitive) {
            //...
        } else {
            //...
        }
    }

};

std::erase(std::remove_if(v.begin(), v.end(), StringEqualityPredicate(targetVal, caseSensitive)), v.end()); 
```

由于您使用的是 C++11，因此可能有一种更紧凑、更简洁的方法（例如 lambda），但我的 C++11 知识基本上不存在.... :)。

尽管除了将 if 块移动到结构中而不是在方法中内联之外，这并没有真正完成太多，但是如果您发现自己在多个地方执行此操作（或者您只是想稍微抽象一下），这可能有用。

# sql-server-2008 - SQL Server 存储过程电子邮件验证

> ID：15329682
> 
> 赞同：0
> 
> 时间：2013-03-11T00:58:12.883
> 
> 标签：sql-server-2008, stored-procedures

我有一个 ASP.net，它根据客户端的电子邮件地址从 SQL Server 2008 中的存储过程请求客户端信息，直到`@`签名。由于在这个小型组织中，客户经常在 3 个月后更换，但电子邮件地址保持不变。

例如，具有电子邮件地址的客户`obois_in4@cegepoutaouais.qc.ca`在 3-4 个月后完成了他/她的合同，然后将该电子邮件地址分配给其他人。

`obois_in4`现在，这是我的问题：我希望我的存储过程在他/她输入并按下`Search`按钮后找到客户信息。我不希望他们输入整封电子邮件的原因是因为它太长了，其次他们在输入时可能会出错，但输入诸如此类`obois_in4`并不是什么大问题。

我编写了一个可以按名称搜索客户的代码，但同样，客户总是在 3-4 个月后更改，但电子邮件地址保持不变。

```
ALTER PROCEDURE [dbo].[sp_find_client_information] 
-- Add the parameters for the stored procedure here
@client_email varchar (50) = null
AS Declare @numOfRows int BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;

-- Insert statements for procedure here
SELECT @numOfRows = COUNT (*)
    From helpdesk_clients 
Where --change first name and 
    client_firstName = @client_email or client_lastName = @client_email;

begin
if (@numOfRows = 0)
    select @numOfRows;
else if (@numOfRows = 1)
select 
    client_id,
    client_firstName, 
    client_lastName, 
    client_work_email, 
    client_work_phone, 
    client_work_phone_ext, 
    client_office, 
    dept_nom,
    client_position 

from 
    helpdesk_clients join departments
    on 
    helpdesk_clients.dept_id = departments.dept_id 
    where client_firstName like '%'+@client_email+'%';
end
END 
```

电子邮件地址始终以`obois`下划线开头，`_`然后是部门信息技术的名称，`in`然后是数字，例如`4`在这种情况下。例如`obois_in4@cegepoutaouais.qc.ca`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T20:09:50.873

我很惊讶没有人费心去研究这个。最好的解决方案是使用`Substring()`和`CharIndex()`

我们可以从`SUBSTRING ( expression ,start , length )`字符串中的某个位置开始截断字符串，直到字符串中的指定位置。有了`CHARINDEX ( expressionToFind ,expressionToSearch [ , start_location ] )`，我们可以找到一个字符在给定字符串中的位置。

`substring (work_email, 1, CHARINDEX('@', work_email)-1) = @work_email`确保参数不必是 like `shawn.smith@cegepoutaouais.qc.ca`，而且客户输入他的完整电子邮件 like 是一个很大的麻烦`shawn.smith@cegepoutaouais.qc.ca`，他只需要输入，脚本将`shwan.smith`搜索`shawn.smith`直到签名。`shawn.smith@cegepoutaouais.qc.ca``@`

例如

在存储过程中，假设`@work_email`is 参数并且它的值是 'shawn.smith'

```
select 
client_id,
client_firstName, 
client_lastName, 
client_work_email, 
client_work_phone, 
client_work_phone_ext, 
client_office, 
dept_nom,
client_position 
 from 
helpdesk_clients join departments
on 
helpdesk_clients.dept_id = departments.dept_id 
where  substring (work_email, 1, CHARINDEX('@', work_email)-1) = @work_email; 
```

将返回`Select`声明中提到的所有细节。

# c# - ssh.net sftp Bad Packet length / open SSH version 2 RSA？

> ID：15329684
> 
> 赞同：0
> 
> 时间：2013-03-11T00:58:33.097
> 
> 标签：c#, ssh, sftp

我是 sftp 的新手，我正在尝试让 ac# 程序通过 sftp 将文件发送到不受我控制的远程服务器。

使用如下代码：

```
using (var sftp = new SftpClient(FTPAddress, FTPName, FTPPassword))
                    {
                        ConnectionInfo myCI = sftp.ConnectionInfo;

                        sftp.Connect(); // <<<< Exception on connect

                        sftp.UploadFile(sftp_ms, FileName,true);

                        sftp.Disconnect();
                    } 
```

我收到“错误的数据包长度”异常。

谷歌搜索显示错误的数据包长度可能是加密格式不匹配，但我不知道如何解决。

我从客户那里收到的规格是：

```
Keys must be in Open SSH version 2 format RSA format 
```

我不知道该怎么做。以前的 SO 问题[如何解决 SSH.NET 中的“错误数据包长度”错误？](https://stackoverflow.com/questions/10886665/how-to-resolve-a-bad-packet-length-error-in-ssh-net)有一个指向 sshnet.codeplex 讨论的链接，其中删除您不想要的加密密钥可以解决该海报的问题。

我可以在 ssh.net 的 connectioninfo 类中看到 16 个条目，但它们都没有声明打开 SSH 版本 2 RSA，尽管其中一个很可能是（我尝试过谷歌搜索）。

我已经尝试过使用 filezilla 提供的 IP、名称和密码，并且连接没有问题；所以filezilla以某种方式使用了正确的加密；我不知道如何判断它在使用什么。

帮助 ？

安德鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T11:48:18.340

你在这里有两个不同的问题。如果您遇到错误的数据包长度问题，那么您可能必须按照[ssh.net Codeplex](http://sshnet.codeplex.com/discussions/358307)讨论中的指南来解决协商问题。这应该解决初始连接的建立。

如果您需要使用 ssh 私钥进行连接，则必须使用其中一个构造函数，该构造函数采用 PrivateKey 对象数组。PrivateKey 的构造函数之一采用流，您可以使用以下代码将私钥字符串转换为流：

```
var privKey = new PrivateKey(new MemoryStream(Encoding.ASCII.getBytes(sshPrivateKeyString)));
var sftpclient = new SftpClient(FTPAddress, FTPName, new PrivateKeyFile[] { privKey }); 
```

其他机制是使用显式 PrivateKeyConnectionInfo 实例：

```
var privKey = new PrivateKey(new MemoryStream(Encoding.ASCII.getBytes(sshPrivateKeyString)));
var privConnInfo = new PrivateKeyConnectionInfo(FTPAddress, FTPName, privKey);
var sftpClient = new SftpClient(privConnInfo); 
```

# html - 框架 - 我看到 HTML5 不支持框架 - 如果 DOCTYPE 指定 HTML5，这是否意味着不支持？

> ID：15329686
> 
> 赞同：2
> 
> 时间：2013-03-11T00:58:38.017
> 
> 标签：html, doctype, frames

我读过 HTML5 不支持框架，但有时我仍然想使用它们。

:-) 在您开始关于框架的“邪恶”的讲座之前，让我说我已经解决了最大的问题 - 孤立的框架和无用的书签。我使用框架的页面会检查它们是否在正确的框架集中，如果不是，它们会加载正确的框架集。当您为我的一个包含框架的页面添加书签时，书签会将您带到您添加书签的“页面”，而不仅仅是具有默认框架源的框架集。

至于 HTML5 不支持框架，使用它们是否需要指定正确的 DOCTYPE 以便页面不被视为 HTML5？

我承认我对 DOCTYPE 语句知之甚少，如果您能与我分享任何知识，我将不胜感激。

鲍勃

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T11:26:30.640

浏览器要么支持框架，要么不支持。“开箱即用”，所有现代图形浏览器都这样做，尽管用户可能会禁用它们。文档类型对此没有任何影响。

在 HTML5 中，框架已经**过时**。这意味着如果作者希望他们的页面符合 HTML5，则不得使用框架。这并不意味着用户代理（例如浏览器）不应该支持它们。¹事实上， HTML5 规范在这里和[另一](http://www.w3.org/html/wg/drafts/html/master/obsolete.html#frameset)[节专门](http://www.w3.org/html/wg/drafts/html/master/rendering.html#frames-and-framesets)用于描述用户代理应该如何处理框架和框架集。

[¹因此，绝对清楚，“HTML5 不支持框架”的说法是不准确的。]

# javascript - 我们可以创建一个带有自定义 div 和消息的 Javascript 确认框吗

> ID：15329689
> 
> 赞同：1
> 
> 时间：2013-03-10T11:36:31.120
> 
> 标签：javascript

我需要一个带有**定制设计和动态消息的 javascript****确认框**。

 **我的问题是：我需要一个函数来调用该调用我如何接收该弹出窗口的结果；（比如是或否）。那可能吗？

代码

```
if (confirm('Are you sure?')){
    //Do the process
}
else{ 
    //Show Error 
} 
```

我想用我的自定义样式覆盖确认

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T11:59:27.567

如何制作一个允许用户响应的隐藏 div

```
 <div id="confirm" class="noshow">
      <div  id="messageContent" class="message"></div>
      <div id="okButton" onClick="doConfirm(true)" class="button"></div>
      <div id="cancelButton" onClick="doConfirm(false)" class="button"></div>
    </div> 
```

现在您可以使用`getElementById('messageContent')`类似的方式轻松设置消息，您现在可以使用和功能处理`ok`和`cancel`操作`doConfirm(true)``doConfirm(false)`

以一种简单的方式，您的 javascript 将类似于

```
doConfirm(flag){
  return flag;
 } 
```

并有类似的CSS

```
.noshow{display:none;} 
```

现在您可以在运行时从 javascript 构建 html 并附加事件处理程序，但这是我能想到的最简单的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-28T16:27:24.327

对我来说，这个解决方案要好得多：

html:

```
<div id='modal_dialog'>
        <div class='title'></div>
        <input type='button' value='yes' id='btnYes' />
        <input type='button' value='no' id='btnNo' />
</div> 
```

js：

```
function dialog(message, yesCallback, noCallback) {
    $('.title').html(message);
    var dialog = $('#modal_dialog').dialog();

    $('#btnYes').click(function() {
        dialog.dialog('close');
        yesCallback();
    });

    $('#btnNo').click(function() {
        dialog.dialog('close');
        noCallback();
    });
} 
```

利用：

```
 dialog('Are you sure you want to do this?',
        function() {
            //If yes do something
            console.log("yes");
        },
        function() {
            //If no do something else
            console.log("no");
        }
    ); 
```

如果没有，请不要忘记添加 jquery。

基于[alnorth29](https://stackoverflow.com/users/152347/alnorth29)对[这个](https://stackoverflow.com/questions/6929416/custom-confirm-dialog-in-javascript)问题的回答

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-15T10:11:21.130

您可以使用回调来执行此操作

确认处理程序，将添加到您的全局 javascript 文件中

```
function ConfirmInDiv(message, okcallback, cancelcallback) {
  $('#confirmation-holder').show();
  $("#confirmation_message").text(message);
  $('#Confirmation_Ok').unbind('click');
  $('#Confirmation_Ok').click(okcallback);
  $('#Confirmation_Cancel').unbind('click');
  $('#Confirmation_Cancel').click(cancelcallback);
}

function HideConfirmDiv() {
  $('#confirmation-holder').hide();
} 
```

HTML，应该驻留在您的布局文件中：

```
<div id="confirmation-holder" style="display:none">
    <div id="confirmation_message"></div>
    <a id="Confirmation_Ok" href="#" class="button">OK</a>
    <a id="Confirmation_Cancel" href="#" class="button light-button">Cancel</a>
</div> 
```

并且无论你想调用你的 javascript 确认：

而不是这个

```
function delete()
{
     if(confirm("Delete?")
     {
         console.log('deleted');
     }
     else
     {
         console.log('delete cancelled');
     }
} 
```

做这个

```
function delete()
{
    function ok()
    {
         console.log('deleted');
         HideConfirmDiv();
    }
    function cancel()
    {
         console.log('delete cancelled');
         HideConfirmDiv();
    }
    ConfirmInDiv('Delete?', ok, cancel);   
} 
```**

# animation - Cocos2d-x 2.0中CCTransitionPageTurn的背面颜色

> ID：15329692
> 
> 赞同：1
> 
> 时间：2013-03-11T00:59:20.163
> 
> 标签：animation, opengl-es, cocos2d-x, transitions

使用 CCTransitionPageTurn 时如何指定场景背面的颜色？在 cocos2d-iphone 1.0 中，我对 CCGrid.m 中的 blot() 做了一些修改，如下所示：

```
NSInteger n = gridSize_.x * gridSize_.y;
// Default GL states: GL_TEXTURE_2D, GL_VERTEX_ARRAY, GL_COLOR_ARRAY, GL_TEXTURE_COORD_ARRAY
    // Needed states: GL_TEXTURE_2D, GL_VERTEX_ARRAY, GL_TEXTURE_COORD_ARRAY
    // Unneeded states: GL_COLOR_ARRAY
    //enable culling, the default cull face is back
    glEnable(GL_CULL_FACE);
    //now only the front facing polygons are drawn
    glDisableClientState(GL_COLOR_ARRAY);
glVertexPointer(3, GL_FLOAT, 0, vertices);
    glTexCoordPointer(2, GL_FLOAT, 0, texCoordinates);
    glDrawElements(GL_TRIANGLES, (GLsizei) n*6, GL_UNSIGNED_SHORT, indices);
// This is very important, otherwise the backside of picture will be random color
    glDisable(GL_TEXTURE_2D);
//change the winding of what OpenGl considers front facing
    //only the back facing polygons will be drawn
    //this works better then changing the cull face
    glFrontFace(GL_CW);
    glDisableClientState(GL_TEXTURE_COORD_ARRAY);
    glColor4ub(255,255,255,255);
    glDrawElements(GL_TRIANGLES, (GLsizei) n*6, GL_UNSIGNED_SHORT, indices);
//restore GL default states
    glFrontFace(GL_CCW);
    glDisable(GL_CULL_FACE);
    glEnableClientState(GL_TEXTURE_COORD_ARRAY);
    glEnableClientState(GL_COLOR_ARRAY); 
```

这是cpp代码，我想我可以在cocos2d-x中使用。但不幸的是，此代码不适用于 2.0。有人可以建议如何将其翻译为 2.0 吗？或者是否有其他方法可以在 CCTransitionPageTurn 期​​间在场景的背面设置颜色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-09T13:49:11.947

根据您的代码段和其他谷歌搜索，我设法实现了这一目标：

```
void CCGrid3D::blit(void)
{

    CCLOG("CCGrid3D::blit()");
    int n = m_sGridSize.width * m_sGridSize.height;

    ccGLEnableVertexAttribs( kCCVertexAttribFlag_Position | kCCVertexAttribFlag_TexCoords );
    m_pShaderProgram->use();
    m_pShaderProgram->setUniformsForBuiltins();;

    //
    // Attributes
    //
#ifdef EMSCRIPTEN
    // Size calculations from calculateVertexPoints().
    unsigned int numOfPoints = (m_sGridSize.width+1) * (m_sGridSize.height+1);

    // position
    setGLBufferData(m_pVertices, numOfPoints * sizeof(ccVertex3F), 0);
    glVertexAttribPointer(kCCVertexAttrib_Position, 3, GL_FLOAT, GL_FALSE, 0, 0);

    // texCoords
    setGLBufferData(m_pTexCoordinates, numOfPoints * sizeof(ccVertex2F), 1);
    glVertexAttribPointer(kCCVertexAttrib_TexCoords, 2, GL_FLOAT, GL_FALSE, 0, 0);

    setGLIndexData(m_pIndices, n * 12, 0);
    glDrawElements(GL_TRIANGLES, (GLsizei) n*6, GL_UNSIGNED_SHORT, 0);
#else

    glEnable(GL_CULL_FACE);
    glVertexAttribPointer(kCCVertexAttrib_Position, 3, GL_FLOAT, GL_FALSE, 0, m_pVertices);
    glVertexAttribPointer(kCCVertexAttrib_TexCoords, 2, GL_FLOAT, GL_FALSE, 0, m_pTexCoordinates);
    glDrawElements(GL_TRIANGLES, (GLsizei)n*6, GL_UNSIGNED_SHORT, m_pIndices);

    glDisable(GL_TEXTURE_2D);

    glFrontFace(GL_CW);
    ccGLEnableVertexAttribs(kCCVertexAttribFlag_Position);

    glEnable(GL_BLEND);

    glDrawElements(GL_TRIANGLES, (GLsizei)n*6, GL_UNSIGNED_SHORT, m_pIndices);

    glFrontFace(GL_CCW);

    glDisable(GL_BLEND);
    glDisable(GL_CULL_FACE);

#endif // EMSCRIPTEN
    CC_INCREMENT_GL_DRAWS(1);
} 
```

它只有一个缺点：它不允许您指定背景颜色，而是获取左下角像素的颜色并使用它。我希望这对您来说已经足够了，或者您将能够更改它，以便我们指定所需的颜色。

# php - 无法获取 MySQL

> ID：15329693
> 
> 赞同：0
> 
> 时间：2013-03-11T00:59:20.633
> 
> 标签：php, mysql, oop

我正在尝试重新编码我制作的主页。这次我想使用 OOP 风格，但我总是得到以下错误：

> Statistic::checkExistingCounter() [statistic.checkexistingcounter]: 无法获取 MySQL

我究竟做错了什么？我知道准备语句是毫无意义的，但即使只是一个查询而不是准备语句也根本不起作用。

同样的错误：

> 无法获取 MySQL

我的数据库类：

```
class MySQL extends MySQLi {

    private static $_instance = null;
    private $host, $username, $password, $db;

    public static function getInstance() {
        if (!(self::$_instance instanceof self)) {
            self::$_instance = new self();
        }
        return self::$_instance;
    }

    public function __construct(){
        $this->host = '...';
        $this->username = '...';
        $this->password = '...';
        $this->database = '...';
        $this->connect();
    }

    public function __destruct() {
        $this->db->close();
    }

    private function __clone(){} 

    public function connect() {
        $this->db = @new MySQLi($this->host, $this->username, $this->password, $this->database);

        /* change character set to utf8 */
        $this->db->set_charset("utf8");

        if (mysqli_connect_errno()) {
            printf("Connect failed: %s\n", mysqli_connect_error());
            exit();
        }

        return $this->db;
    }
} 
```

我的统计类：

```
 class Statistic {
    private $remote, $user_agent, $referer; 
    private $db;

    /**
     * Create Instance of MySQL
     **/
    function __construct($db) {
        $this->db = MySQL::getInstance();
    }

    /**
     * Check for counter today
     *
     * @param: string SQL
     * @return: boolean (true = Counter exists, false = Counter doesnt exist)
     **/
    function checkExistingCounter($sql) {
        $stmt = $this->db->prepare($sql);

        $this->db->error;

        if (!$stmt) {
            echo 'Datenbankfehler';
            exit;
        }

        $stmt->execute();
        $stmt->store_result();

        if ($stmt->num_rows) {
            $stmt->close();
            return true;
        } else {
            $stmt->close();
            return false;
        }
    }

    function counter() {
        $sql = "SELECT ID FROM Counter WHERE Datum = CURDATE()";
        $checkCounter = $this->checkExistingCounter($sql);
    } 
```

这是我的 index.php 的一部分：

```
$db = new MySQL();
$statistic = new Statistic($db);
$statistic->counter(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T02:08:26.997

您似乎在这里陷入困境，实现了两组相互竞争的编码模式：

*   您的`MySQL`类既扩展`MySQLi`（即任何`MySQL`对象也是`MySQLi`对象）并“委托”到`MySQLi`其私有变量中的实例`$db`
*   您的`Statistic`类`MySQL`在其构造函数中获取一个实例（“依赖注入”），但随后忽略它并要求`MySQL`该类提供“单例”实例。

您需要更仔细地阅读每种模式的用途，并在每种情况下（继承**或**委托、依赖注入**或**单例）决定其中一种。

目前，您的代码将执行以下操作：

1.  创建一个新`MySQL`对象（这也是一个`MySQLi`对象，但尚未初始化为任何特定的数据库连接，因为您还没有调用`parent::__construct()`）
2.  在`MySQL`构造函数中，设置`$this->host`等
3.  在`connect()`方法中，创建一个新`MySQLi`对象，将其传递给主机等
4.  将此对象另存为`$this->db`，它只在析构函数 ( `$this->db->close()`)中被引用
5.  从 中返回`MySQLi`对象`connect()`，但没有`__construct()`查看该返回值
6.  回到外部代码中，`MySQL`对象被传递给`Statistic`类的构造函数
7.  然后构造函数忽略它，并调用 Singleton`MySQL::getInstance()`方法
8.  该`getInstance()`方法（因为这是第一次被调用）将创建第二个`MySQL`对象，重复步骤 1 到 5
9.  这第二个`MySQL`对象将保存`$this->db`在`Statistics`对象上
10.  该`checkExistingCounter`方法尝试`$this->db`用作`MySQLi`连接，但该`MySQL`对象从未连接到任何数据库，因此您会收到错误消息。（有一个已连接的连接，如果它不是私有的，您可以将其作为`$this->db->db`.在第 7 步。）

# file - 按顺序播放多个音频文件 Xcode 4.3

> ID：15329696
> 
> 赞同：0
> 
> 时间：2013-03-11T00:59:50.257
> 
> 标签：file, audio, xcode4.3, playback

嘿，我正在尝试按特定顺序播放多个音频文件，当我运行我的代码时，它会同时播放所有这些文件。我知道问题出在哪里，我只是不知道如何分隔每个文件。我正在使用 xcode 4.3

```
[callSignPlayer play];
[VFRPlayer play];
[airportPlayer play];
[weRAPlayer play];
[aircraftPlayer play]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-11T19:07:49.473

我发现的最好方法是创建一个循环，移动到下一个音频文件......如此处所示

```
for (int soundsIn=0; soundsIn < totalSoundsInQueue;) {

    NSString *sound = [theSoundArray objectAtIndex:soundsIn];
    while(![Player isPlaying]){

       Player = [[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:[[NSBundle mainBundle]pathForResource:sound ofType:@"caf"]] error:nil];

        [Player setVolume:1.0f];
        [Player play];
        //Increment for loop counter & move onto next iteration
        soundsIn++;
} 
```

# javascript - 立即/自执行函数语法：括号与否定运算符（和其他运算符）？

> ID：15329706
> 
> 赞同：1
> 
> 时间：2013-03-11T01:00:24.790
> 
> 标签：javascript, syntax

直到最近，我才知道立即执行的函数具有以下语法：

```
(function(){
  …
})(); 
```

然后我在看一个图书馆，发现：

```
! function(){
  …
}(); 
```

**这两种方法是等效的吗？意思是，从执行的角度来看，它们是否具有相同的后果？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T01:13:05.697

这篇[博](http://benalman.com/news/2010/11/immediately-invoked-function-expression/#iife)文对一般概念进行了非常彻底的讨论。

在开始这个问题时，“自我执行”一词是我所知道的，因为我在其他情况下看到过它，但在我的研究中，我发现“立即调用”这个词更准确，因为执行发生在函数体之外。我在问题中留下了“自我”以帮助他人。

*如果您对为什么*前面有操作员工作感到好奇，[请查看“Javascript Self Executing应该工作吗？”的答案。](https://stackoverflow.com/a/7979262/934195)其中详细说明[了“解释 JavaScript 的封装匿名函数语法”的答案，该答案](https://stackoverflow.com/a/1634321/934195)还包含有关封装函数以立即执行的有用信息。

从性能的角度来看[，这篇博文“自调用函数”](http://jsperf.com/self-invoking-function)比较了`!`, `-`, `+`, `~`, `void`,`delete`运算符和括号。差异似乎可以忽略不计，因此可读性可能是首选：正如作者所说`it is still recommended to use the parentheses or a bang [!] because they are programming conventions`。

使用运算符前面的一个明显效果是每个运算符将影响返回类型的方式，但是如果您通过赋值捕获返回值（这似乎是立即调用的唯一方法），那么您可以省略运算符，如`!`since赋值运算符允许解析器立即执行函数：`var capture = function(){ return 'capture this' }();`

另一个极端情况是您可以使用`new`带括号的关键字，但不能在前面使用运算符时使用 - 请参阅此问题[“（函数（）{}）（）”和“（函数（）{}（））”在功能上相等在 JavaScript 中？](https://stackoverflow.com/questions/5938802/are-function-and-function-functionally-equal-i)其中有一个有趣的答案，揭示了执行括号的位置和使用`new`如何改变封装的行为，这（如前所述）在使用运算符之前是不可能的。

# list - Haskell 在列表中找到正确的数字

> ID：15329707
> 
> 赞同：1
> 
> 时间：2013-03-11T01:00:37.783
> 
> 标签：list, haskell, compression

所以我想在这个函数中输入两个参数，一个列表和我要打印的项目的位置。

```
listNumber [1,2,3,4,5,6] 2
>> 3 
```

我已经通过这样做尝试了这个问题

```
numberList :: (List a) => a -> a -> a
numberList a b = [x | x <- a !! n, n <- b] 
```

我不知道我的错误在哪里。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T03:48:02.250

我认为这是一种有趣的方式。
如果我们暂时忽略类型签名并查看函数：

```
numberList a b = [x | x <- a !! n, n <- b] 
```

我们看到在列表理解的第一个条件中调用了 n：

```
x <- a !! n 
```

但 n 仅在此之后定义，在第二个条件下：

```
n <- b 
```

这会导致错误：不在范围内：`n'

所以首先要做的可能是切换第一个和第二个条件：

```
numberList a b = [x | n <- b, x <- a !! n] 
```

现在向 GHCi 询问类型，我们得到：

```
Prelude> :t numberList
numberList :: [[t]] -> [Int] -> [t] 
```

GHC 期望参数 a 是列表列表，参数 b 是整数列表。这是因为 n 是从 b 中提取的，并且列表推导中 <- 右侧的任何内容都必须是列表。由于 n 用作 !! 的参数，因此 GHC 假定 n 是一个 int 并且 b 是一个 int 列表。

现在 GHC 假设 x 也来自某种列表。所以我们知道 GHC 假设一个 !! n 是一个列表。但是，根据定义，a !! n 是列表 a 在位置 n 的元素，我们看到了为什么 GHC 假设 a 是列表的列表——因为 GHC 假设列表 a 的位置 n 的元素是从中提取 x 的列表。

这是一个工作示例：

```
Prelude> numberList [[1,2,3,4,5,6]] [0]
[1,2,3,4,5,6] 
```

这里 GHC 确实向我们展示了列表 a 在位置 0 的元素，即列表 [1..6]。不幸的是，这不允许我们像我们希望的那样方便地到达列表中的位置。仍然使用列表推导式的另一种方法可能是定义一个新列表“c”，其中包含我们之后的元素（a !! n）并从这个新列表中绘制 x，如下所示：

```
Prelude> let numberList a b = [x | n <- b, let c = [a !! n], x <- c]
Prelude> numberList [1,2,3,4,5,6,3] [2]
[3] 
```

不过，这似乎有点令人费解，因为我们可以简单地使用 !! 直接在位置 b 处获取 a 的元素：

```
Prelude> let numberList a b = a !! b
Prelude> numberList [1,2,3,4,5,6] 2
3 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T18:52:48.710

> 所以我想在这个函数中输入两个参数，一个列表和我要打印的项目的位置。

```
>>> listNumber [1,2,3,4,5,6] 2
3 
```

好的。第一步：你有一个非常混乱的类型签名。

```
numberList :: (List a) => a -> a -> a 
```

这不应该被忽视。从一个好的类型签名开始是掌握 Haskell 和类似语言的良好编程技术的基本技能。

首先，您需要一个具有两个输入的函数。

```
numberList :: a -> b -> c 
```

接下来，您希望第一个输入是“列表”。我们不知道这个列表包含什么，所以我们只使用一个类型参数`a`。写“列表`a`”的方法是`[a]`。

```
numberList :: [a] -> b -> c 
```

您希望第二个输入是“位置”。这可能是一个`Int`.

```
numberList :: [a] -> Int -> c 
```

最后，您希望结果是列表的一个元素。因此它将具有相同的类型`a`。

```
numberList :: [a] -> Int -> a 
```

我不知道你从哪里得到`(List a) =>`了类型签名的那一部分，但它完全是假的，除非你使用了一些你没有告诉我们的自定义库。如果你正在学习 Haskell 的大学课程，这是很有可能的。

我们有一个类型签名，知道它是否已经为我们实现可能会很方便。停止！胡歌时间。`[a] -> Int -> a`在[http://haskell.org/hoogle](http://haskell.org/hoogle)中输入类型签名。事实证明，您正在尝试实施`!!`.

# javascript - postMessage 源 IFrame

> ID：15329710
> 
> 赞同：22
> 
> 时间：2013-03-11T01:01:12.353
> 
> 标签：javascript, html, iframe, cross-domain, postmessage

我正在使用 postMessage 将跨域 iframe 调整到正确高度的网站上工作。我遇到的唯一问题是确定哪个 iframe 具有哪个高度。我目前设置它的方式是，当一个 iframe 将其高度发送给父级时，所有 iframe 的高度都会更改。

家长：

```
var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";
var eventer = window[eventMethod];
var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message";

eventer(messageEvent, function(e) {
    $('iframe').height(e.data);
}, false); 
```

框架：

```
var updateHeight = function() {
    if(window.parent) {
        window.parent.postMessage($('.widget').outerHeight(), '*');
    }
}; 
```

有什么方法可以识别哪个 iframe 发送了`message`事件？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-12-05T15:38:41.030

是的，您可以识别执行`postMessage`. 有不同的情况：

*   源 IFRAME 与接收消息的窗口具有**同源 URL**（例如`http://example.com/`）：使用 IFRAME 标识

    `myIFRAME.contentWindow == event.source`

*   源 IFRAME 与父 HTML 页面具有**同源但相对的 URL**（例如`/myApp/myPage.html`）：使用 IFRAME 标识

    `myIFRAME.contentWindow == event.source.parent`

*   源 IFRAME 具有与接收消息的页面不同的**跨域 URL**（例如）：上述方法不起作用（比较总是并且访问导致错误的属性）并且 IFRAME 必须基于识别在其原始域上；`http://example.com/``http://example.org/``false``event.source``Access Denied`

    `myIFRAME.src.indexOf(event.origin)==0`

为了管理这三种不同的情况，我使用以下内容：

```
var sourceFrame = null; // this is the IFRAME which send the postMessage
var myFrames = document.getElementsByTagName("IFRAME");
var eventSource = event.source; // event is the event raised by the postMessage
var eventOrigin = event.origin; // origin domain, e.g. http://example.com

// detect the source for IFRAMEs with same-origin URL
for (var i=0; i<myFrames.length; i++) {
    var f = myFrames[i];
    if (f.contentWindow==eventSource || // for absolute URLs
        f.contentWindow==eventSource.parent) { // for relative URLs
        sourceFrame = f;
        break;
    }
}

// detect the source for IFRAMEs with cross-origin URL (because accessing/comparing event.source properties is not allowed for cross-origin URL)
if (sourceFrame==null) {
    for (var i=0; i<myFrames.length; i++) {
        if (myFrames[i].src.indexOf(eventOrigin)==0) {
            sourceFrame = myFrames[i];
            break;
        }
    }
} 
```

对于跨域 URL，请注意，如果`event.origin`是多个 IFRAME 共有的域，我们无法区分真实来源。

有些人使用`===`而不是，`==`但我在这种情况下没有发现任何区别，所以我使用的是最短的比较器。

此实现已经过测试并在以下条件下工作：

*   微博 9
*   火狐 17

作为替代方案（Griffin 建议），您可以使用具有唯一标识符（例如时间戳）的 IFRAME src，并且 IFRAME 的 Web 应用程序将在发布的消息中发回这个唯一标识符。虽然 IFRAME 识别会更简单，但这种方法需要修改 IFRAME 的 Web 应用程序（这并不总是可能的）。这也可能导致安全问题（例如，IFRAME 的 Web 应用程序试图猜测其他 IFRAME 应用程序的唯一标识符）。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-08-16T06:51:23.470

我从这里找到了解决方案：[如何在 JavaScript 中的窗口和框架之间共享数据](https://stackoverflow.com/questions/8500276/how-to-share-a-data-between-a-window-and-a-frame-in-javascript)

家长：

```
var frames = document.getElementsByTagName('iframe');
for (var i = 0; i < frames.length; i++) {
    if (frames[i].contentWindow === event.source) {
        $(frames[i]).height(event.data); //the height sent from iframe
        break;
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-03-10T00:49:43.060

我有一个想法来解决这个问题。当您创建 iframe 时，为 iframe 提供名称/ID。.

并且，在 iframe 内的脚本中，将消息作为对象发送，看起来像

```
window.parent.postMessage({"height" : $('.widget').outerHeight(), "frmname" : window.name}, '*'); 
```

在父监听器中，

```
eventer(messageEvent, function(e) {`enter code here`
    $(e.data.frmname).height(e.data.height);
}, false); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-03-31T21:55:16.780

以下适用于我的跨域：

```
window.addEventListener('message', function (event) {
  if (event.data.size) {
    Array.prototype.forEach.call(document.getElementsByTagName('iframe'), function (element) {
      if (element.contentWindow === event.source) {
        element.style.height = `${event.data.size.height}px`;
      }
    });
  }
}, false); 
```

在 Chromium 64 和 Firefox 59 中测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-31T08:43:00.687

如果源 iframe 嵌套在多个父 iframe 中，则您需要递归每个 iframe 的 window.frames 属性并将其与 messageEvent#source 属性进行比较。

例如，如果消息是由这个 Dom 的 iframe#level3 生成的。

```
<iframe Id=level1>
   <iframe Id=level2>
       <iframe Id=level3 />
   </iframe>
</iframe> 
```

您应该能够使用在当前窗口中找到祖先 iframe 的索引。

```
FindMe = event.source
FrameIndex = find(window)
frames[FrameIndex].frameElement ==     getElByTagName(iframe)[FrameIndex] 

function find(target){
    for (i=0; I< target.frames.length; i ++)
       if(target.frames[i] == FindMe ||   find(target.frames[i]))
           return i
    return false 
} 
```

重要的是要注意

Window.frames 属性不受跨域策略限制

无论源 iframe 的嵌套有多深，此技术都将起作用

window.frames 是窗口对象的集合，而不是 iframe 元素。

对 window.frames 集合成员的属性的访问由 Same Origin 限制（即您可能无法访问 window.frames[i] 的 frameElement 或 location 属性

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-05-15T00:45:34.370

该事件还应该有一个属性“source”，可以与 iframe 的“contentWindow”属性进行比较。

# ios - StageText 打开时很慢

> ID：15329714
> 
> 赞同：1
> 
> 时间：2013-03-11T01:01:41.533
> 
> 标签：ios, actionscript-3, air, keyboard

使用 StageText 在 iOS 设备上打开软键盘时，应用程序会停止并且在键盘打开前几秒钟没有响应。

有什么方法可以避免这种情况吗？

/卡尔

# javascript - 如何从 Javascript 代码设置单元格宽度（HTML 表格）

> ID：15329719
> 
> 赞同：1
> 
> 时间：2013-03-11T01:02:46.660
> 
> 标签：javascript, html-table

我有一个 HTML 表格。如何从 Javascript 代码更改该表的一个单元格的宽度？例如，我有一个按钮，当我按下它时，我希望改变一个特定列的宽度。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T01:14:59.697

你可以在没有 jQuery 的情况下做到这一点。

工作示例：http: [//jsfiddle.net/qFDBk/1/](http://jsfiddle.net/qFDBk/1/)

```
var btn = document.getElementById('btn');

btn.onclick = function() {
    var tbl = document.getElementById('tbl');
    var td = tbl.rows[0].cells[0];
    td.width = '500px';
    td.style.backgroundColor = 'blue';
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T01:08:01.883

以下是使用流行的 JavaScript 库 jQuery 的方法：

[http://jsfiddle.net/VJTnN/2](http://jsfiddle.net/VJTnN/2)

```
$('td:nth-child(2)').css('width', '100px'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T01:11:14.820

使用 CSS 方法来应用宽度。

```
$('td').css('width','200px'); 
```

解释 ：

1.  获取所有 td 元素。并应用 CSS 属性宽度并将其值设置为 200px。对于每个 td 元素。
2.  `$('td')`是标签选择器。它将选择所有 td 元素。
3.  .css() 将应用您提到的样式规则。

# asp.net - ASP Dropdown OnSelectedIndexChange 事件不会触发

> ID：15329720
> 
> 赞同：0
> 
> 时间：2013-03-11T01:02:48.817
> 
> 标签：asp.net, events, drop-down-menu, event-handling

我已经阅读了许多关于此的文章和问题。但仍然没有找到我的案例的答案。该函数处理事件。它根本不起作用我的代码：

**ASPX**

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Popup.aspx.cs"
     Inherits="GG.UI.Popup" %>
...

<asp:DropDownList ID="LEDropdown" runat="server" AutoPostBack="true" 
                  OnSelectedIndexChanged="LEDropdown_Change" ></asp:DropDownList> 
```

**ASPX.CS**

```
protected void Page_Load(object sender, EventArgs e)
{
   if (!IsPostBack)
   {
      PopulateClist();
      BindGrid();
   }
}
protected void PopulateClist()
{
   LEDropdown.Items.Clear();
   LEDropdown.Items.Add(new ListItem("First Item", "First");
   LEDropdown.Items.Add(new ListItem("Second Item", "Second");
   LEDropdown.SelectedIndex = 0;
}
protected void LEDropdown_Change(object sender, EventArgs arg)
{
   string selectedLE = ((DropDownList)(sender)).SelectedValue;
   ClientScript.RegisterStartupScript(GetType(), "Alert", "alert('" + selectedLE + "');");
} 
```

我也尝试`EnableViewState="true"`用于此页面和母版页。没有工作。
该函数`LEDropdown_Change`从未被调用。
页面在选择后仍会发回。

还有另一个带有 OnClick 事件的按钮，它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:52:56.040

```
<asp:DropDownList ID="LEDropdown" runat="server" AutoPostBack="true" OnSelectedIndexChanged="LEDropdown_Change" ></asp:DropDownList> 
```

您的下拉列表正在调用`LEDropdown_Change`

但是您的 onchange 事件被称为：`LegalEntityDropdown_Change`

# asp.net - MVC.Net 绑定复杂模型？

> ID：15329721
> 
> 赞同：1
> 
> 时间：2013-03-11T01:03:23.573
> 
> 标签：asp.net, ajax, asp.net-mvc, razor, model-binding

我有以下代码，现有客户。我需要创建一个创建订单的表单，并将其传递给我的控制器。

我尝试将该页面上的模型类型更改为 Order 而不是 Customer，但是我还必须传递 Order 对象，或者至少是 OrderId。

楷模

```
public class Customer
{
   public int Id { set; get; }
   public string FirstName { set; get; }
   public string LastName { set; get; }
   public List<Order> Orders { get; set;}
}

public class Order
{
   public int Id { set; get; }
   public string ItemName { set; get; }
   public DateTime SomeDate { set; get; }
} 
```

控制器

```
public class OrderController : Controller
{
   [HttpPost]
   public Create ActionResult(Customer customer)
   {
      // Customer doesn't have the values that it suppose to have
      // All fields including the array of orders are null
      customerStorage.UpdateOrders(customer);

      return ("ItemListPartial", customer.orders);
   }
} 
```

看法

```
@model Company.Application.Model.Customer;

@using (Ajax.BeginForm(new AjaxOptions { UpdateTargetId = "result" }))
{
    // How can I bind this to Order object ?
    // I can't define model as Order, because then I need to pass Customer Separately
    @Html.TextBoxFor(o => o.Orders[0].ItemName)
    @Html.TextBoxFor(o => o.Orders[0].SomeDate)
    <input type="submit" value="Add" />
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T01:32:04.407

我想您正在寻找这篇博客文章描述的内容： [ASP.NET MVC Wire Format for Model Binding to Arrays, Lists, Collections, Dictionaries](http://www.hanselman.com/blog/ASPNETWireFormatForModelBindingToArraysListsCollectionsDictionaries.aspx)

引用博客：

> 如果签名看起来像这样：
> 
> ```
> public ActionResult Blah(IDictionary<string, Company> stocks) {
>   // ...
> } 
> ```
> 
> 我们在 HTML 中给出了这个：
> 
> ```
> <input type="text" name="stocks[0].Key" value="MSFT" />
> <input type="text" name="stocks[0].Value.CompanyName" value="Microsoft Corporation" />
> <input type="text" name="stocks[0].Value.Industry" value="Computer Software" />
> <input type="text" name="stocks[1].Key" value="AAPL" />
> <input type="text" name="stocks[1].Value.CompanyName" value="Apple, Inc." />
> <input type="text" name="stocks[1].Value.Industry" value="Consumer Devices" /> 
> ```
> 
> 像这样：
> 
> ```
> stocks[0].Key = "MSFT"
> stocks[0].Value.CompanyName = "Microsoft Corporation"
> stocks[0].Value.Industry = "Computer Software"
> stocks[1].Key = "AAPL"
> stocks[1].Value.CompanyName = "Apple, Inc."
> stocks[1].Value.Industry = "Consumer Devices" 
> ```
> 
> 然后就像我们写的一样：
> 
> ```
> stocks = new Dictionary<string, Company>() {
>   { "MSFT", new Company() { CompanyName = "Microsoft Corporation", Industry = "Computer Software" } },
>   { "AAPL", new Company() { CompanyName = "Apple, Inc.", Industry = "Consumer Devices" } }
> }; 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T01:40:41.193

这个IMO是你应该如何处理这个：

如果您真的不想制作视图模型，请在您的视图包中传递 customerID（ps 可以制作视图模型！）

```
public class OrderController : Controller
{
   public ActionResult Create(int customerID)
   {
      ViewBag.CustomerID = customerID
      Order ord = new Order(o);
      return View(ord);
   }
} 
```

你的发布方法：

```
[HttpPost]
public ActionResult Create(int CustomerID, Order order)
{
  //create your order
} 
```

你的cshtml

```
@model Company.Application.Model.Order;

@using (Ajax.BeginForm(new AjaxOptions { UpdateTargetId = "result" }))
{
    @Html.TextBoxFor(o => o.ItemName)
    @Html.TextBoxFor(o => o.SomeDate)
    @Html.Hidden("CustomerID",ViewBag.CustomerID)
    <input type="submit" value="Add" />
} 
```

# asp.net - asp.net javascript 到数据库

> ID：15329729
> 
> 赞同：0
> 
> 时间：2013-03-11T01:04:23.783
> 
> 标签：asp.net, razor

一直在为此苦苦挣扎。尝试了我能想到的一切。我使用 javascript 将数据传递给 db，在另一个页面上使用 ints 可以正常工作，但现在使用字符串它不会工作：s

```
 @using (Html.BeginForm(null, null, FormMethod.Post, new{@id="manageForm"}))
    {
    @Html.AntiForgeryToken()

    <span class="actions">

     @T(User.Id.ToString()) @T("  ") @T(ViewData["Tag"].ToString())

<input type="hidden" name="tag" value="fr" />
    <input type="hidden" name="id" value="3" />
<a href="#"class="bttn green large"  onclick="return following.();">@T("Follow")</a>

</span>
} 
```

Javascript

```
<script type="text/javascript">
    function followTag() {
        $('#manageForm').attr('action', '@(Url.Action("FollowTag"))').submit();
        return false;
    }
    </script> 
```

控制器

```
[RequireAuthorization]
        [HttpPost]
        public ActionResult FollowTag(int id, string tag)
        {
            _service.FollowTag(id, tag);
            return RedirectToAction("TagPage","Detail", new
            {
            });
        } 
```

数据访问

```
 public void FollowTag(int id, string tag)
    {
        DbCommand comm = GetCommand("SPTagFollow");
        //user id
        comm.AddParameter<int>(this.Factory, "id", id);
        //id to follow
        comm.AddParameter<string>(this.Factory, "tag", tag);

        comm.SafeExecuteNonQuery();
    } 
```

路线设置良好，sql（存储过程）执行完美。希望你们中的一个人能看到一些明显的东西

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T05:04:48.313

我认为是输入错误的问题，检查你的最后一个`<a>`标签，你输入`following.()`了`onclick`事件，看到你的 javascript 函数被调用了`followTag`。

如果这不能解决问题，那么摆脱该`foolowTag`功能，您可以在表单本身中指定操作和控制器，如下所示：

```
@using (Html.BeginForm("FollowTag", "YourControllerName", FormMethod.Post)) {
    ...
    //Delete this line
    //<a href="#"class="bttn green large"  onclick="return following.();">@T("Follow")</a>
    //This submit button will do the job
    <input type='submit' value='@T("Follow")' />
} 
```

那应该这样做。如果您使用锚标记只是为了样式，那没关系，否则您应该使用其他方式，我认为更清晰，而且它利用了剃须刀的强大功能。

# octave - 八度 leasqr 错误

> ID：15329730
> 
> 赞同：0
> 
> 时间：2013-03-11T01:04:36.117
> 
> 标签：octave

我有以下

```
x=[0.01:0.01:.1];
y=[1 1 1 1 1 0 0 0 0 0 ];
F=@(x,p) 0.5-(1/Pi)*atan(p(2)*(x-p(1)));
p0=[0.05 10000]; 
```

当我运行以下

```
[f p]=leasqr(x,y,p0,F) 
```

我明白了

```
error: Invalid call to options.  Correct usage is:

 -- Function File: OPT = options ("KEY1", VALUE1, "KEY2", VALUE2, ...)

error: called from:
error:   /usr/share/octave/3.6.2/m/help/print_usage.m at line 87, column 5
error:   /usr/share/octave/packages/control-2.3.52/options.m at line 68, column 5
error: evaluating argument list element number 1
error:   /usr/share/octave/packages/optim-1.2.0/leasqr.m at line 574, column 5 
```

我错过了什么吗？

编辑：更新了优化包。新的错误信息：

```
error: binary operator `.*' not implemented for `matrix' by `symbolic matrix' operations
error: called from:
error:   /usr/share/octave/packages/optim-1.2.2/private/__lm_svd__.m at line 145, column 5
error:   /usr/share/octave/packages/optim-1.2.2/leasqr.m at line 582, column 26 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T01:16:09.203

这是一个错误。根据[邮件列表](https://mailman.cae.wisc.edu/pipermail/help-octave/2012-September/053970.html)

您可能需要更新`optim`包来修复它。第一步是系统相关的，它会安装编译包的工具，就rpm包名不同。

```
$ sudo apt-get install liboctave-dev
$ sudo octave
octave> pkg install -forge optim 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-23T04:55:30.710

如果您在函数中将“Pi”更改为“pi”，则此代码适用于我。只是它说“没有实现收敛！”

# java - Java - 同步静态方法

> ID：15329731
> 
> 赞同：12
> 
> 时间：2013-03-11T01:04:41.440
> 
> 标签：java, static, synchronization

这是我在[此](http://www.theserverside.com/news/1363681/Scaling-Your-Java-EE-Applications)链接上找到的一段文字。

> "避免锁定静态方法
> 
> 最糟糕的解决方案是将“同步”关键字放在静态方法上，这意味着它将锁定该类的所有实例。”

为什么同步静态方法会锁定类的所有实例？它不应该只是锁定班级吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-03-11T01:16:35.410

要理解这一点，最简单的方法是比较 lock 与实例方法和静态方法的工作方式。假设您有一个类 Test.java，它有如下两个方法。

```
public class Test{
   public synchronized void instanceMethod(){
   }

   public synchronized static void staticMethod(){
   } 
} 
```

同时，有两个Test类实例，testA和testB。还有两个线程 tA 和 tB 试图并行访问类 Test。

锁定 instanceMethod：当 tA 获得 testA 的 instanceMethod 锁定时，**tB****无法**访问**testA**中的相同方法，但 tB 仍然可以自由调用**testB**中的**instanceMethod**。因为针对**instanceMethod 的同步是实例级锁定**

 ******锁定 staticMethod：但是，当 tA 获得**staticMethod**上的锁定时，锁定与 testA 或 testB 无关，因为 static 方法上的同步是**类级别的锁定**。这意味着 tB 根本无法访问**staticMethod**直到 tA 释放锁

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-11T01:14:39.463

实际上，锁定 class 的静态方法与`Foo`锁定`Foo.class`（这是唯一的实例）相同：

```
public static void doSomething()
{
    synchronized(Foo.class)
    {
        // ...
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-11T01:25:14.487

这是我的测试代码，表明您是对的，并且文章有点过于谨慎：

```
class Y {
    static synchronized void staticSleep() {
        System.out.println("Start static sleep");
        try {
            Thread.sleep(2000);
        } catch (InterruptedException e) {
        }
        System.out.println("End static sleep");
    }

    synchronized void instanceSleep() {
        System.out.println("Start instance sleep");
        try {
            Thread.sleep(200);
        } catch (InterruptedException e) {
        }
        System.out.println("End instance sleep");
    }
}

public class X {
    public static void main(String[] args) {
        for (int i = 0; i < 2; ++i) {
            new Thread(new Runnable() {

                public void run() {
                    Y.staticSleep();
                }
            }).start();
        }

        for (int i = 0; i < 10; ++i) {
            new Thread(new Runnable() {

                public void run() {
                    new Y().instanceSleep();
                }
            }).start();
        }
    }
} 
```

印刷：

```
Start instance sleep
Start instance sleep
Start instance sleep
Start instance sleep
Start instance sleep
Start static sleep
Start instance sleep
Start instance sleep
Start instance sleep
Start instance sleep
Start instance sleep
End instance sleep
End instance sleep
End instance sleep
End instance sleep
End instance sleep
End instance sleep
End instance sleep
End instance sleep
End instance sleep
End instance sleep
End static sleep
Start static sleep
End static sleep 
```

所以这与实例`static synchronized`上的方法无关......`synchronized`

当然，如果`static synchronised`在整个系统中都使用方法，那么您可以期望它们对多线程系统的吞吐量产生最大影响，所以使用它们需要您自担风险……

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-11T01:15:22.147

你是对的——实际的锁是在`Class`实例本身上，而不是在类的任何实例上（更不用说*所有*实例了）——但我认为你对链接页面的解释过于字面了。它本身使用短语“静态锁（类锁）”，因此它的作者清楚地知道锁定是如何工作的。但是，如果您在不同的线程中有许多实例都使用同步的静态方法，那么这些实例将相互锁定。同步的静态方法*不会*导致同步*实例*方法的阻塞，但无论如何问题都存在。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-11T01:50:00.877

它没有说“锁定类的所有实例”。它说'锁定类*的*所有实例。它的措辞很糟糕，确实不正确，但它并没有说出你所说的话。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-02-10T23:18:40.843

> 同步方法在执行之前获取监视器（第 17.1 节）。对于类（静态）方法，使用与方法类的 Class 对象关联的监视器。对于实例方法，使用与 this（调用该方法的对象）关联的监视器。

[http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.4.3.6](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.4.3.6)******

# python - 选择一个随机变量，然后在 Python 中无法再次选择它？

> ID：15329735
> 
> 赞同：1
> 
> 时间：2013-03-11T01:05:50.080
> 
> 标签：python

我正在为一个化学项目制作一个小游戏，其中控制台从其中存储在变量中的 20 个随机选择的问题打印出来，用户回答问题，然后该问题变得无法再次随机选择。我将如何去做它随机选择一个变量然后不允许再次选择它的部分？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T01:08:08.283

如果您有一个名为 的问题列表`lst`，您可以简单地执行以下操作：

```
import random
random.shuffle(lst) 
```

这会将列表随机排列。然后每次你想要一个问题时，你从列表中删除最后一个元素：

```
question = lst.pop() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-11T01:09:37.693

尝试这样的事情：

```
import random

your_questions = ['question %d' % i for i in range(20)]
random.shuffle(your_questions)

for question in your_questions:
    print question 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T01:16:24.530

听起来您正在寻找没有替换的随机样本。你可以

```
import random

print random.SystemRandom().sample(L,20) 
```

Where`L`是您的问题列表，并且`20`是要返回的随机（无替换）列表的长度。所以在这里，您的列表`L`将是代表您的问题的 20 个字符串的列表。

注意：这将返回一个随机列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T01:41:01.910

尽管@David Robinson 的答案是最好的，但您也可以执行以下操作：

import random lst = [...] # 包含问题

现在每次你需要一个问题：

```
choiceIndex = random.randint(0, len(lst)-1) # you want to do -1 since randint
choice = lst[choiceIndex]                   # is inclusive and indices start at 0
del lst[choiceIndex] 
```

# python - 构建这本字典的最 Pythonic 方式是什么？

> ID：15329749
> 
> 赞同：1
> 
> 时间：2013-03-11T01:08:08.703
> 
> 标签：python, dictionary, performance

我想创建一个字典，使得 QWERTY 键盘的第一行中的字母被赋予一个值，主行中的键被赋予一个值 0，而底行中的键被赋予一个值 2。

我想这样做是一条线，但我想不出一种方法来做到这一点。

我知道这会做第一行，但是有没有办法将所有行放在一行中？

```
firstRow = {i:1 for i in "q w e r t y u i o p".split(' ')} 
```

编辑，我想到了这个：

```
keyboardRating = dict({i:1 for i in "q w e r t y u i o p".split(' ')}.items() + {i:0 for i in "a s d f g h j k l".split(' ')}.items() + {i:2 for i in "z x c v b n m".split(' ')}.items()) 
```

但我正在寻找更简单的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-11T01:10:15.330

好吧，首先，有一个巧妙的技巧来获得`firstRow`：

```
firstRow = dict.fromkeys('qwertyuiop', 1) 
```

然后我们可以写

```
keys = {}
keys.update(dict.fromkeys('qwertyuiop', 1))
keys.update(dict.fromkeys('asdfghjkl', 2))
keys.update(dict.fromkeys('zxcvbnm,', 3)) 
```

或者，您可以尝试这样的事情：

```
rows = {1: 'qwertyuiop', 0: 'asdfghjkl;', 2: 'zxcvbnm,.'}
keys = {c:k for k,row in rows.iteritems() for c in row} 
```

由于涉及的静态数据量很大，我不建议尝试将它们全部放在一行上。

# api - 显示 Instagram 关注者数量的最简单方法是什么

> ID：15329753
> 
> 赞同：5
> 
> 时间：2013-03-11T01:09:01.760
> 
> 标签：api, instagram

我正在使用 WordPress 并试图找出显示用户拥有的 Instagram 关注者数量的最简单方法。

在搜索的过程中，我发现了一些 Instagram PHP 包装脚本，这些脚本对于我想要显示的内容似乎有点矫枉过正。

通过阅读 Stackoverflow 帖子，我发现了一篇列出此代码的帖子：

```
$userinfo = wp_remote_get("https://api.instagram.com/v1/users/3955450?access_token=f0d225aa955c4bd9ae563f87f831efab");
$userinfo = json_decode($userinfo);

$followers = $userinfo['data']['counts']['followed_by'];

echo "Folled by: " . $followers . " people"; 
```

这是一个简单而完美的脚本，但是它不返回任何数据。

我已经在 Instagram 开发者网站上设置了一个客户端，但是我无法获取上述脚本来显示任何数据。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-11-14T22:09:14.683

试试这个：

```
$result = file_get_contents("https://api.instagram.com/v1/users/3955450?access_token=f0d225aa955c4bd9ae563f87f831efab");
$obj = json_decode($result);
echo $obj->data[0]->id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-31T15:12:04.660

您是否尝试过 API 控制台中的 url？也许用户受到保护，或者您访问结果不正确。

# meteor - 从 Meteor.SetTimeout 中调用时访问 this.userId 不起作用

> ID：15329759
> 
> 赞同：4
> 
> 时间：2013-03-11T01:09:25.117
> 
> 标签：meteor

我一直在尝试`this.userId`从 Meteor.methods 调用中访问该变量，但是当我尝试通过 Meteor.setTimeout 或 Meteor.setInterval 调用该方法时，它似乎不起作用。

这就是我所拥有的：

```
if (Meteor.is_server) {
    Meteor.methods({
        getAccessToken : function() {
            try {
                console.log(this.userId);
                return Meteor.users.findOne({_id: this.userId}).services.facebook.accessToken;
            } catch(e) {
                return null;
            }
        }
    });

    var fetch_feed = function() {
        console.log(Meteor.call("getAccessToken"));
        [...] // A bunch of other code
    };

    Meteor.startup(function() {
        Meteor.setInterval(fetch_feed, 60000); // fetch a facebook group feed every minute
        Meteor.setTimeout(fetch_feed, 3000); // initially fetch the feed after 3 seconds
    });
} 
```

观察终端日志，`this.userId`总是返回一个空值。但是，如果我尝试从客户端或通过控制台调用该方法，它会返回正确的 ID。

为什么这在 Meteor.setInterval 中不起作用？这是一个错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-25T23:09:15.340

Meteor userId 与客户端连接相关联。服务器可能与许多客户端交互，并且`this.userId`在方法内部会告诉您哪个客户端要求运行该方法。

如果服务器使用 Meteor.call() 来运行一个方法，那么它将没有 userId，因为它没有为任何客户端运行。

这些方法允许客户端调用要在服务器上运行的函数。对于服务器将触发自身的事情，javascript 函数将执行此操作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-07-27T16:00:46.070

我使用了一个解决方案 - 有时您不想让该方法成为一个函数，但真的希望它仍然是一个方法。在这种情况下，一个 hack 使这项工作：

```
 var uniqueVar_D8kMWHtMMZJRCraiJ = Meteor.userId();
            Meteor.setTimeout(function() {
                    // hack to make Meteor.userId() work on next async 
                    // call to current method
                    if(! Meteor._userId) Meteor._userId = Meteor.userId;
                    Meteor.userId = function() {
                        return Meteor._userId() || uniqueVar_D8kMWHtMMZJRCraiJ
                    };
                    Meteor.apply(methodName, args);
                }
            , 100); 
```

一些简短的解释：我们保存`Meteor.userId`并用一个函数`Meteor._userId`覆盖，如果它为真则返回，否则返回任何这一切发生之前的历史值。该历史值保存在不可能出现两次的 var name 中，因此不会发生上下文冲突。`Meteor.userId``Meteor._userId()``Meteor.userId()`

# c# - ASP.NET 传递 SQL 语句以在 SQL 代理作业中运行

> ID：15329760
> 
> 赞同：0
> 
> 时间：2013-03-11T01:09:31.667
> 
> 标签：c#, asp.net, sql, sql-server-2008, batch-file

因为在我的 ASP.NET 页面中将 > 500 万个单元格导出到 Excel 所需的时间太长，所以我决定改为在后台运行 SQL 代理作业并将 excel 文件链接发送到用户的电子邮件收件箱。

我的问题是如何将 SQL 语句（根据 ASP.NET 页面上的用户选择而变化）传递给 SQL 代理作业？我需要先创建一个存储过程吗？然后获取 SQL Agent 作业来运行 sp？

另外，如何使用 SQL 代理作业将 SQL 结果导出到 CSV 文件中？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T15:20:05.180

您可以从后面的 ASP.NET 代码创建 SQL Server 代理作业，并将自定义 T-SQL 语句传递到其中。[这](http://msdn.microsoft.com/en-en/library/ms135739%28v=sql.100%29.aspx)是一个例子。

[这](https://gist.github.com/drewgillson/1964274)是一个存储过程从 T-SQL 将数据导出到 CSV 的示例

# ios - 如何在 UIScrollView 中拉伸 UITextViews 以适应旋转后的水平尺寸？

> ID：15329762
> 
> 赞同：0
> 
> 时间：2013-03-11T01:09:45.100
> 
> 标签：ios, objective-c, xcode, uiscrollview, uitextview

所以我有一个带有 11 个 UITextViews 的长表单。它刚刚超过 iPhone 旧的 3.2" 屏幕足够长，所以我不得不把它全部放在 UIScrollView 中。现在当我旋转到水平时，UITextViews 不会调整大小以适应左侧新可用的空间。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:29:38.710

首先，你的意思是 UITextFields 吗？（而不是 TextViews）

有很多不同的方法可以解决这个问题。

首先，您是否使用 Interface Builder 来构建视图？

如果视图很简单，可以试试 Interface Builder 提供的弹性定位，可能要摆弄不同的选项。

另一种方法是使用 iOS 6.0+ 中可用的 Autolayout 系统

或者，如果您对自己使用代码处理框架感到满意，则可以为视图旋转时设置不同的框架大小。

或者，您可以为横向视图创建一个单独的 xib 文件，并在手机旋转时让程序加载该 xib。

以上所有方法都是处理旋转的广泛使用的方法，您应该选择最适合您情况的方法。

# sql-server - 不允许对系统目录进行临时更新

> ID：15329764
> 
> 赞同：4
> 
> 时间：2013-03-11T01:10:42.667
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-r2

所以我试图手动更新一个用户的哈希值。我尝试更新视图，因为表格不可见。

我尝试从单用户模式开始，更改“sp_configure 'Allow updates',1”等等，但没有成功。

有没有什么办法。我不知道密码，只是哈希，因为从 2000 SP4 更新到 2008 R2 失败，我需要在 2008 R2 上拥有凭据，就像在旧的 2000 上一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-04-27T18:10:39.600

如果您运行的是 SQL Server 2000 或更早版本，则可以运行：

```
RECONFIGURE WITH OVERRIDE 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T11:11:58.870

自 SQL Server 2005 以来，`sp_Configure`“允许更新”设置没有任何效果，它仍然会“工作”，但不会做任何事情。

我相信，如果您确实必须进行这些更改，您可以在实例处于单用户模式时通过 DAC（专用管理员连接）进行连接，但要小心您所做的更改:)

[如何：将专用管理员连接与 SQL Server Management Studio 结合使用](http://msdn.microsoft.com/en-us/library/ms178068%28v=sql.105%29.aspx)

# sql - 获取距离特定邮政编码 50 英里的所有邮政编码

> ID：15329765
> 
> 赞同：1
> 
> 时间：2013-03-11T01:10:48.730
> 
> 标签：sql, sql-server, distance, latitude-longitude

我有一个页面，用户可以在其中插入他们的邮政编码，它将返回其代码附近的所有邮政编码。

现在我有这张桌子

```
CREATE TABLE [dbo].[zip](
    [zipcode] [varchar](5) NOT NULL,
    [state] [varchar](2) NULL,
    [city] [varchar](50) NULL,
    [longitude] [float] NULL,
    [latitude] [float] NULL,        
    [CreateStamp] [smalldatetime] NULL,
    [state_name] [varchar](50) NULL,        
) 
```

如果你能给我一个完整的指导，我不知道该怎么做，那就太好了

结果将是用户插入他们的邮政编码，然后查询将返回他们自己的邮政编码 50 英里内的所有邮政编码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:42:57.447

如果您正在使用`SQL Server 2008`和更高版本，则可以使用[`GEOGRAPHY`](http://msdn.microsoft.com/en-us/library/cc280766%28v=sql.100%29.aspx)数据类型。首先，您需要`Geography`根据其邮政编码获取中心的位置，然后选择指定距离内的所有记录。要计算距离，请使用[`STDistance`](http://technet.microsoft.com/en-us/library/bb933808%28v=sql.100%29.aspx)方法。这是一个例子：

```
DECLARE @cZip VARCHAR(5)
SET @cZip = '<center zip code>'
DECLARE @dMin DECIMAL = 50 * 1609.344 -- metres

DECLARE @c GEOGRAPHY
SELECT @c = GEOGRAPHY::Parse('Point(' + CAST(longitude AS VARCHAR) + ' ' + CAST(latitude AS VARCHAR) + ')')
FROM zip
WHERE zipcode = @cZip

SELECT * 
FROM zip 
WHERE @c.STDistance(GEOGRAPHY::Parse('Point(' + CAST(longitude AS VARCHAR) + ' ' + CAST(latitude AS VARCHAR) + ')')) <= @dMin 
```

# html - 画布有偏移

> ID：15329770
> 
> 赞同：0
> 
> 时间：2013-03-11T01:11:44.973
> 
> 标签：html, html5-canvas

我正在`<canvas>`为一个班级项目做一个跳棋板。出于某种原因，我的画布从偏移开始，我无法修复它。 ![在此处输入图像描述](../Images/2b3998bd2ef11b4a756f36a670b290e7.png)

我不想发布太多代码，因为这是一个家庭作业，我不希望人们为我解决它。我确实尝试过`<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">`，但它不起作用。我基本上在做的是从 0 到 8 的 i 和 j 的嵌套 for 循环。我正在根据偶数/奇数位置更改颜色。在我决定了我的颜色之后，我正在做`ctx.fillRect(i*50 ,j*50,50,50)`

知道这个偏移量是从哪里来的吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T02:31:03.423

你的画布尺寸是 400 x 400 吗？是否有一个容器可以容纳背景为灰色 (#808080) 的画布？

如果是这样，这是一个 CSS 问题。尝试给画布一个 float:left 的样式。或者将画布绝对定位在它的容器内。

```
<canvas width="400" height="400" style="float:left"></canvas> 
```

或者

```
<div style="position:relative"><!-- containing element -->
    <canvas width="400" height="400" style="top:0; left:0;position:absolute">
    </canvas>
</div> 
```

# php - 关闭一个 php 连接

> ID：15329774
> 
> 赞同：0
> 
> 时间：2013-03-11T01:12:41.423
> 
> 标签：php

我有一个 cron 作业每 5 分钟运行一次以下脚本。但是，脚本似乎不会在运行后关闭连接。如何关闭此脚本中的连接？

```
function __construct($config)
{
    $this->server = $config['server'];
    $this->certificate = $config['certificate'];
    $this->passphrase = $config['passphrase'];

    // Create a connection to the database.
    $this->pdo = new PDO(
        'mysql:host=' . $config['db']['host'] . ';dbname=' . $config['db']['dbname'], 
        $config['db']['username'], 
        $config['db']['password'],
        array());

    // If there is an error executing database queries, we want PDO to
    // throw an exception.
    $this->pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    // We want the database to handle all strings as UTF-8.
    $this->pdo->query('SET NAMES utf8');
}

// This is the main loop for this script. It polls the database for new
// messages, sends them to APNS, sleeps for a few seconds, and repeats this
// forever (or until a fatal error occurs and the script exits).
function start()
{
    writeToLog('Connecting to ' . $this->server);

    if (!$this->connectToAPNS())
        exit;

    while (true)
    {
        // Do at most 20 messages at a time. Note: we send each message in
        // a separate packet to APNS. It would be more efficient if we 
        // combined several messages into one packet, but this script isn't
        // smart enough to do that. ;-)

        $stmt = $this->pdo->prepare('SELECT * FROM messages WHERE time_sent IS NULL LIMIT 20');
        $stmt->execute();
        $messages = $stmt->fetchAll(PDO::FETCH_OBJ);

        foreach ($messages as $message)
        {
            if ($this->sendNotification($message->id, $message->token, $message->payload))
            {
                $stmt = $this->pdo->prepare('UPDATE messages SET time_sent = NOW() WHERE id = ?');
                $stmt->execute(array($message->id));
            }
            else  // failed to deliver
            {
                $this->reconnectToAPNS();
            }
        }

        unset($messages);           
        sleep(5);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T01:49:04.857

我可能读错了，但显然你每 5 分钟启动一个不退出的脚本（无限循环）。因此，您正在堆叠实例，直到地球（或更简单地说，您的服务器）最终爆炸。

为了回答您的问题，当脚本执行结束时，PHP 会自动释放所有资源，包括数据库连接。

当脚本运行*很长时间*（如无限），或者有*非常具体*的内存考虑时，可以使用`unset($foo)`or手动释放资源`$foo = null`。[1]

数据库连接也可以通过这种方式关闭和释放，只需使用`unset($this->pdo)`.

[1] 另请参阅[PHP 释放内存的优势：unset() 或 $var = null](https://stackoverflow.com/questions/584960/whats-better-at-freeing-memory-with-php-unset-or-var-null#584982)

# c++ - Getopt 加入参数

> ID：15329778
> 
> 赞同：0
> 
> 时间：2013-03-11T01:14:07.817
> 
> 标签：c++, c, parameters, parameter-passing, getopt

有没有办法使用 getopt 函数来解析：

```
./prog -L -U 
```

一样：

```
./prog -LU 
```

这是我的尝试（不工作）：

```
while ((c = getopt(argc, argv, "LU")) != -1) {
    switch (c) {
    case 'L':
        // L catch
        break;
    case 'U':
        // U catch
        break;
    default:
        return;
    }
} 
```

在这个简单的示例中只有 2 个参数，但在我的项目中需要 6 个参数的所有组合。例如：`-L`or `-LURGHX`or `-LU -RG -H`etc. 可以`getopt()`处理吗？或者我必须编写复杂的解析器来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:16:44.890

`getopt` [看起来确实有能力处理它](http://www.gnu.org/software/libc/manual/html_node/Example-of-Getopt.html#Example-of-Getopt)，[而且确实如此](http://liveworkspace.org/code/2l00yg%2432)

> 以下是一些示例，展示了该程序使用不同的参数组合打印的内容：

```
% testopt
aflag = 0, bflag = 0, cvalue = (null)

% testopt -a -b
aflag = 1, bflag = 1, cvalue = (null)

% testopt -ab
aflag = 1, bflag = 1, cvalue = (null) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T01:24:15.570

它的行为完全符合您的要求：

```
#include <stdio.h>
#include <unistd.h>

int main(int argc, char** argv) 
{
    int c;

    while ((c = getopt(argc, argv, "LU")) != -1) {
        switch (c) {
        case 'L':
            puts("'L' option");
            break;
        case 'U':
            // U catch
            puts("'U' option");
            break;
        default:
            puts("shouldn't get here");
            break;
        }
    }

    return 0;
} 
```

并测试它：

```
precor@burrbar:~$ gcc -o test test.c
precor@burrbar:~$ ./test -LU
'L' option
'U' option
precor@burrbar:~$ ./test -L -U
'L' option
'U' option 
```

[`getopt()`](http://pubs.opengroup.org/onlinepubs/009696799/functions/getopt.html)是遵循[POSIX "Utiltiy Syntax Guidelines"](http://pubs.opengroup.org/onlinepubs/009696799/basedefs/xbd_chap12.html#tag_12_02)[的 POSIX 标准函数](http://pubs.opengroup.org/onlinepubs/009696799/functions/getopt.html)，其中包括以下内容：

> 准则 5：当分组在一个“-”分隔符后面时，应该接受没有选项参数的选项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T01:26:12.507

除了缺少大括号，您的代码对我来说很好：

```
#include <stdio.h>
#include <unistd.h>

int main(int argc, char **argv) {
    int c;
    while ((c = getopt(argc, argv, "LU")) != -1) {
        switch (c) {
        case 'L':
            // L catch
            printf("L\n");
            break;
        case 'U':
            // U catch
            printf("U\n");
            break;
        default:
            break;
        }
    }
    return 0;
} 
```

> ```
> $ ./a.out -LU
> L
> U
> $ ./a.out -L
> L
> $ 
> ```

# javascript - 在Javascript中迭代由字符串索引的数组

> ID：15329788
> 
> 赞同：0
> 
> 时间：2013-03-11T01:15:32.033
> 
> 标签：javascript

我有一个数组，我在其中使用字符串作为数组的索引。假设我有：

```
var array = [];
array["a"] = 1;
array["b"] = 2;
array["c"] = 33; 
```

如何在“数组”中迭代以显示其所有元素？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T01:18:22.583

JS 中的数组只能有序号数字键，但对象可以有字符串作为键。由于键不是序数，因此您不能对其本身进行迭代，但您可以显示所有元素：

```
var obj = {};
obj['a'] = 1;
obj['b'] = 2;
/* alternatively */ var obj = {'a': 1, 'b': 2};

for (var key in obj) {
    if (obj.hasOwnProperty(key)) {
        //access via `obj[key]`
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T01:17:54.350

带有字符串索引的“数组”在 JS 中根本不是数组，而是一个有属性的对象。你要：

```
var obj = {
  a:1,
  b:2,
  c:33
};

for (var prop in obj){
  //this iterates over the properties of obj, 
  //and you can then access the values with obj[prop]
  if (obj.hasOwnProperty(prop)) {
    doSomething(obj[prop]);
  }
} 
```

数组只有可以被解析为整数的索引。

# android - Android 将图像从 JSON 加载到 Horizo ntalListView

> ID：15329791
> 
> 赞同：0
> 
> 时间：2013-03-11T01:16:05.820
> 
> 标签：android, json, android-asynctask

我一直在这里寻找关于这个问题的一些答案，并结合我目前在我的代码中的内容尝试了其中的一些。我对某些部分有一些困惑。所以，这是我的代码：

**MyMainActivity**类。解析 json 并设置适配器。

RowItem 是一个 POJO。 [Horizo​​ntalListView](http://www.dev-smart.com/archives/34)来自 dev-smart

```
.
.   
.
HorizontalListView hListView;
List<RowItem> sItems;

public void onCreate(Bundle savedInstanceState){
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Intent intent = getIntent();
    String categoryId = intent.getStringExtra("id");

    JSONParser parser = new JSONParser(this); 
    JSONObject json = parser.getJSONFromAssets("mylist.json");

    shopItems = new ArrayList<ShopRowItem>();

    try{
        shops = json.getJSONArray(LIST_ARR);
        for(int i = 0; i < shops.length(); i++){
            JSONObject c = jsonArray.getJSONObject(i);

            String sName = c.getString(NAME);
            String sCatId = c.getString(ID);
            String imageUrl = c.getString(IMAGE_URL);

            RowItem item = new ShopRowItem(imageUrl, sName, sCatId);
            sItems.add(item);

        }
    }catch(JSONException e){
        throw new RuntimeException(e);
    }

    hListView = (HorizontalListView) findViewById(R.id.hlist_view);
    ShopBaseAdapter adapter = new ShopBaseAdapter(this, sItems);
    hListView.setAdapter(adapter); 
```

然后，我的**CustomAdapter**类扩展到 BaseAdapter。

```
 .
 .
 .
    Context context;
List<RowItem> rowItems;

private class ViewHolder{
    ImageView imageView;
    TextView txtName;
    TextView txtId;
}

public View getView(int position, View convertView, ViewGroup parent){
    ViewHolder holder = null;

    LayoutInflater inflater = (LayoutInflater) context.getSystemService(Activity.LAYOUT_INFLATER_SERVICE);

    if(convertView == null){
        convertView = inflater.inflate(R.layout.shop_list_layout, null);
        holder = new ViewHolder();
        holder.txtShopName = (TextView) convertView.findViewById(R.id.name);
        holder.txtCatId = (TextView) convertView.findViewById(R.id.cat_id);

        holder.imageView = (ImageView) convertView.findViewById(R.id.prof_pic);
        holder.imageView.getLayoutParams().height = 120;
        holder.imageView.getLayoutParams().width = 120;
        holder.imageView.setPadding(5, 5, 5, 5);
        holder.imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);

        convertView.setTag(holder);
    }else{
        holder = (ViewHolder) convertView.getTag();
    }

    RowItem sItem = (RowItem) getItem(position);

    holder.txtShopName.setText(sItem.getName());
    holder.txtCatId.setText(sItem.getCatId());

    try{
                        **// I dont know what to do here  
        holder.imageView.setImageBitmap( ? ? ? ?)** 
    }catch(Exception e){

    }

    return convertView;
} 
```

然后我有**MyImageLoader**类扩展 AsyncTask。

```
public class ShopImageLoader extends AsyncTask<Object, String, Bitmap>{
.
.
.

**protected Bitmap doInBackground(Object... params){
    //how to get the url from other class? ?
    //then loadBitmap(url);
            // then set it for dispaly
    //i'm really confuse on what to do here.
    return bitmap; ??

}**

public static Bitmap loadBitmap(String url){
    Bitmap bitmap = null;
    InputStream in = null;
    BufferedOutputStream out = null;

    try{
        in  = new BufferedInputStream(new URL(url).openStream(), IO_BUFFER_SIZE);
        final ByteArrayOutputStream dataStream = new ByteArrayOutputStream();
        out = new BufferedOutputStream(dataStream, IO_BUFFER_SIZE);
        copy(in, out);
        out.flush();

        final byte[] data = dataStream.toByteArray();
        BitmapFactory.Options options = new BitmapFactory.Options();

        bitmap = BitmapFactory.decodeByteArray(data, 0, data.length, options);
    }catch(IOException e){
        Log.e(TAG, "Could not load Bitmap from: "+ url);
    }finally{
        closeStream(in);
        closeStream(out);
    }

    return bitmap;
}

private static void closeStream(Closeable stream){
    if(stream != null){
        try{
            stream.close();
        }catch(IOException e){
            android.util.Log.e(TAG, "Could not close stream", e);
        }
    }
}

private static void copy(InputStream in, BufferedOutputStream out) throws IOException {
    byte[] byt = new byte[IO_BUFFER_SIZE];
    int read;
    while((read = in.read(byt)) != -1){
        out.write(byt, 0, read);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T06:56:55.670

好吧，本[教程](http://www.technotalkative.com/android-asynchronous-image-loading-in-listview/)实际上帮助解决了我的问题。

# python - 多个列表列表的列表理解

> ID：15329797
> 
> 赞同：0
> 
> 时间：2013-03-11T01:16:36.003
> 
> 标签：python, regex

我对一个尴尬的列表理解问题感到震惊，我无法解决。所以，我有两个列表，如下所示：

```
a=[[....],[....],[....]]
b=[[....],[....],[....]]
len(a)==len(b) including sublists i.e sublists also have the same dimension. 
```

现在我想做一个 re.compile 它看起来像：

```
[re.compile(_subelement_in_a).search(_subelement_in_b).group(1)] 
```

我想知道如何使用列表理解来实现上述目标 - 例如：

```
[[re.compile(str(x)).search(str(y)).group(1) for x in a] for y in b] 
```

..但显然以上似乎不起作用，我想知道是否有人能指出我正确的方向。

*编辑*

我刚刚意识到 b 的子列表比 a 的子列表有更多的元素。因此，例如：

```
a=[[1 items],[1 items],[1 items]]
b=[[10 item], [10 item], [10 item]] 
```

我仍然想做和我上面的问题一样的事情：

```
[[re.compile(str(x)).search(str(y)).group(1) for x in b] for y in a] 
```

和输出看起来像：

```
c = [[b[0] in a[0] items],[b[1] in a[1] items],[b[2] in a[2] items]] 
```

例子：

```
a=[["hgjkhukhkh"],["78hkugkgkug"],["ukkhukhylh"]]
b=[[r"""a(.*?)b""",r"""c(.*?)d""",r"""e(.*?)f""",r"""g(.*?)h""",r"""i(.*?)j"""],[r"""k(.*?)l""",r"""m(.*?)n""",r"""o(.*?)p""",r"""q(.*?)r"""],[r"""s(.*?)t""",r"""u(.*?)v""",r"""x(.*?)y""",r"""z(.*?)>"""]] 
```

使用一对一映射。即检查是否：

```
elements of sublists of b[0] are present in sublist element of a[0]
elements of sublists of b[1] are present in sublist element of a[1]
elements of sublists of b[2] are presnet in sublist element of a[2] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T01:23:39.503

听起来像你在寻找`zip`？它需要一对列表并将其转换为一对列表。

```
[
    [my_operation(x,y) for x,y in zip(xs, ys)]
    for xs, ys in zip(a, b)
] 
```

- 编辑。要求改变：

```
[
    [[regex(p, s) for p in patterns] for s in strings]
    for strings, patterns in zip(a, b)
] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T01:17:38.450

`zip`自由使用：

```
[[re.search(x, y).group(1) for x,y in zip(s,t)] for s,t in zip(a,b)] 
```

第一个`zip(a,b)`生成子列表对的列表。第二`zip`个将并行子列表中的元素配对在一起。

# ajax - 为什么 AJAX 设置超时不起作用？

> ID：15329801
> 
> 赞同：0
> 
> 时间：2013-03-11T01:16:50.243
> 
> 标签：ajax, settimeout

我有点疯狂地试图理解为什么这会根据超时函数输出一次 json 数据，然后不再输出。我究竟做错了什么？

```
<script type="text/javascript">
var myTimer =0;
function ajax_get_json(){
var results = document.getElementById("results");
var hr = new XMLHttpRequest();
hr.open("POST", "ballJson.php",true);
hr.setRequestHeader("Content-type", "application/json");
hr.onreadystatechange = function() {
    if(hr.readyState == 4 && hr.status == 200) {
        var data = JSON.parse(hr.responseText);
        results.innerHTML = "";
        for(var obj in data){
            results.innerHTML += data[obj]+"<br />";
        }
    }
}
hr.send(null);
results.innerHTML = "requesting...";
myTimer = setTimeout('ajax_get_json()',10000);
}
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T01:21:14.763

我认为您想使用该[`setInterval`](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)功能[`setTimeout`](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)只执行一次。

`setTimeout(function () { ajax_get_json(); }, 10000)`使用或`setTimeout(ajax_get_json, 10000)`代替使用作为函数回调评估的字符串也是更可取的。

另请注意，ajax 请求可能随时完成，因此使用`setInterval`. 您还可以调用回调以链接调用`setTimout`。`onreadystatechange`

# objective-c - 从 IOUSBInterface 管道中找出数据

> ID：15329803
> 
> 赞同：1
> 
> 时间：2013-03-11T01:16:58.363
> 
> 标签：objective-c, xcode, cocoa, io, iokit

我正在编写一个 Mac 应用程序，该应用程序使用 IOKit 向 Personal Video Recorder 发送和接收消息。我需要发送消息以更改其状态，并且它需要向我提供有关视频的信息，例如分辨率或是否录制。我意识到我必须找到正确的消息来发送它，所以首先我想我可以先从它那里收到一些消息。我已经找到了设备的接口。我如何能够转储收到的消息？

这是来自 USB Probe 的日志：

```
Composite device: "PVR"
    Port Information:   0x001d
           Captive
           Internal Device
           Connected
           Enabled
    Number Of Endpoints (includes EP0):   
        Total Endpoints for Configuration 1 (current):   7
    Device Descriptor   
        Descriptor Version Number:   0x0200
        Device Class:   0   (Composite)
        Device Subclass:   0
        Device Protocol:   0
        Device MaxPacketSize:   64
        Device VendorID/ProductID:   0x2040/0xE502   (Hauppauge Computer Works, Inc.)
        Device Version Number:   0x0800
        Number of Configurations:   1
        Manufacturer String:   1 "Hauppauge"
        Product String:   2 "WinTV"
        Serial Number String:   3 "E502-00-00AA3DEE"
    Configuration Descriptor (current config)   
        Length (and contents):   60
            Raw Descriptor (hex)    0000: 09 02 3C 00 01 01 00 C0  00 09 04 00 00 06 FF FF  
            Raw Descriptor (hex)    0010: FF 00 07 05 81 02 00 02  00 07 05 84 02 00 02 00  
            Raw Descriptor (hex)    0020: 07 05 88 02 00 02 00 07  05 01 02 00 02 00 07 05  
            Raw Descriptor (hex)    0030: 02 02 00 02 00 07 05 86  02 00 02 00 
        Number of Interfaces:   1
        Configuration Value:   1
        Attributes:   0xC0 (self-powered)
        MaxPower:   0 mA
        Interface #0 - Vendor-specific   
            Alternate Setting   0
            Number of Endpoints   6
            Interface Class:   255   (Vendor-specific)
            Interface Subclass;   255   (Vendor-specific)
            Interface Protocol:   255
            Endpoint 0x81 - Bulk Input   
                Address:   0x81  (IN)
                Attributes:   0x02  (Bulk)
                Max Packet Size:   512
                Polling Interval:   0 ( Endpoint never NAKs)
            Endpoint 0x84 - Bulk Input   
                Address:   0x84  (IN)
                Attributes:   0x02  (Bulk)
                Max Packet Size:   512
                Polling Interval:   0 ( Endpoint never NAKs)
            Endpoint 0x88 - Bulk Input   
                Address:   0x88  (IN)
                Attributes:   0x02  (Bulk)
                Max Packet Size:   512
                Polling Interval:   0 ( Endpoint never NAKs)
            Endpoint 0x01 - Bulk Output   
                Address:   0x01  (OUT)
                Attributes:   0x02  (Bulk)
                Max Packet Size:   512
                Polling Interval:   0 ( Endpoint never NAKs)
            Endpoint 0x02 - Bulk Output   
                Address:   0x02  (OUT)
                Attributes:   0x02  (Bulk)
                Max Packet Size:   512
                Polling Interval:   0 ( Endpoint never NAKs)
            Endpoint 0x86 - Bulk Input   
                Address:   0x86  (IN)
                Attributes:   0x02  (Bulk)
                Max Packet Size:   512
                Polling Interval:   0 ( Endpoint never NAKs)
    Device Qualifier Descriptor   
        Descriptor Version Number:   0x0200
        Device Class   0   (Composite)
        Device Subclass   0
        Device Protocol   0
        Device MaxPacketSize:   64
        Number of Configurations:   1
        bReserved:   0
    Other Speed Configuration Descriptor   
        Length (and contents):   60
            Raw Descriptor (hex)    0000: 09 07 3C 00 01 01 00 C0  00 09 04 00 00 06 FF FF  
            Raw Descriptor (hex)    0010: FF 00 07 05 81 02 40 00  00 07 05 84 02 40 00 00  
            Raw Descriptor (hex)    0020: 07 05 88 02 40 00 00 07  05 01 02 40 00 00 07 05  
            Raw Descriptor (hex)    0030: 02 02 40 00 00 07 05 86  02 40 00 00 
        Number of Interfaces:   1
        Configuration Value:   1
        Attributes:   0xC0 (self-powered)
        MaxPower:   0 mA
        Interface #0 - Vendor-specific   
            Alternate Setting   0
            Number of Endpoints   6
            Interface Class:   255   (Vendor-specific)
            Interface Subclass;   255   (Vendor-specific)
            Interface Protocol:   255
            Endpoint 0x81 - Bulk Input   
                Address:   0x81  (IN)
                Attributes:   0x02  (Bulk)
                Max Packet Size:   64
                Polling Interval:   0 ms
            Endpoint 0x84 - Bulk Input   
                Address:   0x84  (IN)
                Attributes:   0x02  (Bulk)
                Max Packet Size:   64
                Polling Interval:   0 ms
            Endpoint 0x88 - Bulk Input   
                Address:   0x88  (IN)
                Attributes:   0x02  (Bulk)
                Max Packet Size:   64
                Polling Interval:   0 ms
            Endpoint 0x01 - Bulk Output   
                Address:   0x01  (OUT)
                Attributes:   0x02  (Bulk)
                Max Packet Size:   64
                Polling Interval:   0 ms
            Endpoint 0x02 - Bulk Output   
                Address:   0x02  (OUT)
                Attributes:   0x02  (Bulk)
                Max Packet Size:   64
                Polling Interval:   0 ms
            Endpoint 0x86 - Bulk Input   
                Address:   0x86  (IN)
                Attributes:   0x02  (Bulk)
                Max Packet Size:   64
                Polling Interval:   0 ms 
```

![在此处输入图像描述](../Images/c3b13e119297b9d7215e9546d9e543f3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T12:29:16.433

USB 是主机驱动的。这意味着设备不会发送任何消息，除非是对来自主机 (Mac/PC) 的消息的回复。因此，要从中获取消息，您首先需要向其发送有效消息。

我从您的问题中假设您实际上没有任何有关设备的文档/规范？这意味着您需要通过向制造商索取或通过*逆向工程*来获取该信息。

逆向工程最简单的方法是监听现有驱动程序生成的消息，例如某些 Windows 软件，它执行与您想要执行的操作类似的操作。然后你需要监听数据。过去，我曾在 Linux 上的 VM 中成功运行 Windows 软件，并将有问题的 USB 设备传递到 VM，并使用 Linux 的 USB 调试功能记录输出。您应该可以在 OSX 上使用“USB Prober”应用程序和 Apple 开发人员下载区域提供的“IOUSBFamily Log Release”来执行相同操作。

# android - 停止和启动Android媒体播放器的案例和切换方法

> ID：15329807
> 
> 赞同：0
> 
> 时间：2013-03-11T01:17:33.563
> 
> 标签：android, uri, spinner, android-mediaplayer, media

我有一个微调器，您可以选择您喜欢流式传输的质量，选择后您必须按停止按钮停止播放器，然后选择您的流，然后您必须选择播放按钮才能调到您选择的流。我可以自动执行此操作吗？这是我的代码。

```
@Override
public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2, long arg3) {

int position = spinner.getSelectedItemPosition();
switch (position){
case 0:
    path = ("URL TO STREAM");
    break;

case 1:
    path = ("URL TO STREAM");
    break;

}

      }

      @Override
       public void onNothingSelected(AdapterView<?> arg0) {
   // TODO Auto-generated method stub

      }
     } 
```

当我使用此代码时

```
@Override
public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2, long arg3) {

int position = spinner.getSelectedItemPosition();
switch (position){
case 0:
            mp.stop();
    path = ("URL TO STREAM");
    mp.start();
            break;

case 1:
            mp.stop();
    path = ("URL TO STREAM");
    mp.start();
            break;

}

      }

      @Override
       public void onNothingSelected(AdapterView<?> arg0) {
   // TODO Auto-generated method stub

      }
     } 
```

当用户从微调器。

这是我的日志：

```
03-10 18:54:51.041: D/AndroidRuntime(284): >>>>>>>>>>>>>> AndroidRuntime START          
03-10 18:54:51.041: D/AndroidRuntime(284): CheckJNI is ON
03-10 18:54:51.201: D/AndroidRuntime(284): --- registering native functions ---
03-10 18:54:51.851: D/AndroidRuntime(284): Shutting down VM
03-10 18:54:51.861: D/dalvikvm(284): Debugger has detached; object registry had 1      entries
03-10 18:54:51.871: I/AndroidRuntime(284): NOTE: attach of thread 'Binder Thread #3'    failed
03-10 18:54:52.251: D/AndroidRuntime(292): >>>>>>>>>>>>>> AndroidRuntime START     <<<<<<<<<<<<<<
03-10 18:54:52.251: D/AndroidRuntime(292): CheckJNI is ON
03-10 18:54:52.421: D/AndroidRuntime(292): --- registering native functions ---
03-10 18:54:53.071: I/ActivityManager(58): Force stopping package com.slaviccenter.radio    uid=10037
03-10 18:54:53.081: I/Process(58): Sending signal. PID: 273 SIG: 9
03-10 18:54:53.165: I/WindowManager(58): WIN DEATH: Window{4606c8b0     com.slaviccenter.radio/com.slaviccenter.radio.MainActivity paused=false}
03-10 18:54:53.181: I/UsageStats(58): Unexpected resume of com.android.launcher while   already resumed in com.slaviccenter.radio
03-10 18:54:53.211: W/InputManagerService(58): Got RemoteException sending    setActive(false) notification to pid 273 uid 10037
03-10 18:54:53.271: I/ActivityManager(58): Starting activity: Intent {    act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10000000    cmp=com.slaviccenter.radio/.MainActivity }
03-10 18:54:53.271: D/AndroidRuntime(292): Shutting down VM
03-10 18:54:53.291: D/dalvikvm(292): Debugger has detached; object registry had 1 entries
03-10 18:54:53.321: I/dalvikvm(292): JNI: AttachCurrentThread (from ???.???)
03-10 18:54:53.321: I/AndroidRuntime(292): NOTE: attach of thread 'Binder Thread #3' failed
03-10 18:54:53.491: I/ActivityManager(58): Start proc com.slaviccenter.radio for activity com.slaviccenter.radio/.MainActivity: pid=299 uid=10037 gids={3003}
03-10 18:54:53.851: W/ActivityThread(299): Application com.slaviccenter.radio is waiting for the debugger on port 8100...
03-10 18:54:53.901: I/System.out(299): Sending WAIT chunk
03-10 18:54:53.921: I/dalvikvm(299): Debugger is active
03-10 18:54:54.112: I/System.out(299): Debugger has connected
03-10 18:54:54.112: I/System.out(299): waiting for debugger to settle...
03-10 18:54:54.311: I/System.out(299): waiting for debugger to settle...
03-10 18:54:54.511: I/System.out(299): waiting for debugger to settle...
03-10 18:54:54.711: I/System.out(299): waiting for debugger to settle...
03-10 18:54:54.921: I/System.out(299): waiting for debugger to settle...
03-10 18:54:55.127: I/System.out(299): waiting for debugger to settle...
03-10 18:54:55.322: I/System.out(299): waiting for debugger to settle...
03-10 18:54:55.521: I/System.out(299): waiting for debugger to settle...
03-10 18:54:55.732: I/System.out(299): waiting for debugger to settle...
03-10 18:54:55.933: I/System.out(299): debugger has settled (1369)
03-10 18:54:56.271: W/WindowManager(58): No window to dispatch pointer action 0
03-10 18:54:56.421: W/WindowManager(58): No window to dispatch pointer action 1
03-10 18:55:03.275: W/ActivityManager(58): Launch timeout has expired, giving up wake lock!
03-10 18:55:03.751: W/ActivityManager(58): Activity idle timeout for HistoryRecord{460b4c78 com.slaviccenter.radio/.MainActivity} 
```

在最后一行之后，“Activity idle timeout”调试器将我带到 MainActivity.java

```
 int position = spinner.getSelectedItemPosition();
switch (position){
case 0:
            mp.stop(); <---------DEBUGGER HIGHLIGHTS THIS GREEN
    path = ("URL TO STREAM");
    mp.start();
            break;

case 1:
            mp.stop();
    path = ("URL TO STREAM");
    mp.start();
            break; 
```

----新的LOGCAT--------

```
03-10 20:45:54.440: W/ActivityThread(375): Application com.slaviccenter.radio is waiting for the debugger on port 8100...
03-10 20:45:54.460: I/System.out(375): Sending WAIT chunk
03-10 20:45:54.522: I/dalvikvm(375): Debugger is active
03-10 20:45:54.661: I/System.out(375): Debugger has connected
03-10 20:45:54.661: I/System.out(375): waiting for debugger to settle...
03-10 20:45:54.871: I/System.out(375): waiting for debugger to settle...
03-10 20:45:55.071: I/System.out(375): waiting for debugger to settle...
03-10 20:45:55.270: I/System.out(375): waiting for debugger to settle...
03-10 20:45:55.471: I/System.out(375): waiting for debugger to settle...
03-10 20:45:55.683: I/System.out(375): waiting for debugger to settle...
03-10 20:45:55.881: I/System.out(375): waiting for debugger to settle...
03-10 20:45:56.081: I/System.out(375): waiting for debugger to settle...
03-10 20:45:56.288: I/System.out(375): waiting for debugger to settle...
03-10 20:45:56.490: I/System.out(375): waiting for debugger to settle...
03-10 20:45:56.692: I/System.out(375): debugger has settled (1448)
03-10 20:46:06.240: D/AndroidRuntime(375): Shutting down VM
03-10 20:46:06.240: W/dalvikvm(375): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
03-10 20:46:06.321: E/AndroidRuntime(375): FATAL EXCEPTION: main
03-10 20:46:06.321: E/AndroidRuntime(375): java.lang.NullPointerException
03-10 20:46:06.321: E/AndroidRuntime(375):  at com.slaviccenter.radio.MainActivity.onItemSelected(MainActivity.java:296)
03-10 20:46:06.321: E/AndroidRuntime(375):  at  android.widget.AdapterView.fireOnSelected(AdapterView.java:864)
03-10 20:46:06.321: E/AndroidRuntime(375):  at android.widget.AdapterView.access$200(AdapterView.java:42)
03-10 20:46:06.321: E/AndroidRuntime(375):  at android.widget.AdapterView$SelectionNotifier.run(AdapterView.java:830)
03-10 20:46:06.321: E/AndroidRuntime(375):  at android.os.Handler.handleCallback(Handler.java:587)
03-10 20:46:06.321: E/AndroidRuntime(375):  at android.os.Handler.dispatchMessage(Handler.java:92)
03-10 20:46:06.321: E/AndroidRuntime(375):  at android.os.Looper.loop(Looper.java:123)
03-10 20:46:06.321: E/AndroidRuntime(375):  at android.app.ActivityThread.main(ActivityThread.java:4627)
03-10 20:46:06.321: E/AndroidRuntime(375):  at java.lang.reflect.Method.invokeNative(Native Method)
03-10 20:46:06.321: E/AndroidRuntime(375):  at java.lang.reflect.Method.invoke(Method.java:521)
03-10 20:46:06.321: E/AndroidRuntime(375):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
03-10 20:46:06.321: E/AndroidRuntime(375):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
03-10 20:46:06.321: E/AndroidRuntime(375):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T03:47:56.090

在停止之前检查 mp 是否正在播放

```
 @Override
public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
//    check mp
if(mp !=null){
   int position = spinner.getSelectedItemPosition();
   switch (position){
   case 0:
         if(mp.isPlaying())   mp.stop();
    path = ("URL TO STREAM");
    mp.start();
            break;

   case 1:
         if(mp.isPlaying())   mp.stop();
       path = ("URL TO STREAM");
       mp.start();
            break;

}
} 
```

希望这对您有所帮助。

# python - Python结构运算符说明

> ID：15329816
> 
> 赞同：0
> 
> 时间：2013-03-11T01:18:33.937
> 
> 标签：python, data-structures

我遇到了一段 Python 代码，我可能想将它用于个人项目的 Java，但在理解这些操作时遇到了一些困难。该片段包含以下内容：

```
F={}
for stage in range(4):

  if stage == 0:
    F[stage]=[]
    i=0

    for j in range(i, len(words)+1):
      F[stage].append([cost(i, j), 0]) 
```

这里，`cost`是一个外部定义，它接受两个整数值并返回一个数学运算。

据我所知，`F={}`初始化一个dict，它类似于Java HashMap，并`[]`表示一个列表的初始化。

首先，我是否正确，这`F[stage].append([cost(i, j), 0])`意味着

*   `cost`取函数的整数值，
*   创建一个包含两个值的列表和
*   将其作为单个容器附加到 F[stage] 列表的末尾？

其次，上面代码后面的这行部分让我很难过。

```
if F[stage-1][i][0] + cost(i, j) ... 
```

我解释它的方式是

*   `F[stage - 1]`检索该位置的列表
*   `[i]`访问子列表容器和
*   `[0]`检索子列表的第一个索引位置的值

我在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:48:17.020

你问的那条线，

```
if F[stage-1][i][0] + cost(i, j) ... 
```

似乎正在考虑前一阶段的成本计算；它看起来几乎就像一个寻找最佳下一步行动的路径算法。我说这是前一阶段的成本计算的原因（显然）是`stage-1`索引，以及当`[cost(i, j), 0]`附加到`F[stage]`（列表）时，该`[0]`列表的元素是`cost(i, j)`. 所以你说“`[0]`在子列表的第一个索引位置检索值”是对的，但知道它还专门检索早期的成本结果可能会有所帮助。

在 Java 中，使用小类而不是 2 项列表来表示成本和第二个参数是什么，使用适当命名的字段和访问器可能更习惯用语。

您也可以使用数组而不是 dict for `F`，因为尽管 Python 代码使用 dict，但它仅通过访问数字阶段键 0-3 将其视为数组。

不过，我想知道我们是否遗漏了一些您希望转换的上下文，特别是因为该`if F[stage-1] ...`行未包含在原始代码段中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T01:31:56.587

首先，我是否纠正了 F[stage].append([cost(i, j), 0]) 的意思

取成本函数的整数值，创建一个包含两个值的列表并将其作为单个容器附加到 F[stage] 列表的末尾？

* * *

你的理解是正确的。F[stage] 将是一个列表列表。

* * *

我解释它的方式是

F[stage - 1] 检索位置
[i] 的列表访问子列表容器，
[0] 检索子列表第一个索引位置的值

* * *

在我看来，F[stage] 是一个列表列表，具有这种结构：
[[cost(i, j) 返回什么，0]，[cost(i, j) 返回什么，0]....]
由于这里的 i 是 0（或者它会改变吗？） F[stage-1][i][0] 是指最后阶段的成本（0, 0）
它似乎是在将一些最后阶段的成本添加到当前阶段确定某事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T01:59:56.023

您在理解 python 代码时所做的评论是正确的。当然，这取决于该代码正在执行的操作的上下文。但是对于 Python 的 Dictionary / List 结构，您可以使用这样的简单字典开始

```
>>> tst = {'one':1, 'two':2}
>>> tst
{'two': 2, 'one': 1} 
```

现在用嵌套列表替换 'one' 的值

```
>>> tst['one'] = [1, ['a', 'b', 'c'], 3]
>>> tst
{'two': 2, 'one': [1, ['a', 'b', 'c'], 3]} 
```

现在进入嵌套列表中的“c”

```
>>> tst['one'][1][2]
'c' 
```

您可以通过添加更多嵌套数组来更进一步。如果我没记错的话，Python 中的任何列表都可以变成“锯齿状数组”

# mysql - 在delphi中使用来自mysql的@variable :=

> ID：15329818
> 
> 赞同：-1
> 
> 时间：2013-03-11T01:19:32.380
> 
> 标签：mysql, delphi

我的问题是；如何使用`:=`（在 mysql 中赋值）在 delphi 中工作？

这是我的例子：

```
create TEMPORARY TABLE if not EXISTS new
SELECT date, price, kat, tipe, ready, use, 
if(tipe = '0', @x := use, (@x := @x - (ready-use)))as balance,
@result := ready + @x as HSL,
if (@result <=0, ready, ready+@x) as sata... and script complete.. 
```

我的问题是；delphi 只能`:=`来自 mysql。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T05:57:51.100

如果您需要使用“：”，请将 Paramcheck 设置为 false。

# c++ - Arduino 内联 ASM 无法按预期工作

> ID：15329824
> 
> 赞同：1
> 
> 时间：2013-03-11T01:19:57.753
> 
> 标签：c++, assembly, arduino, avr-gcc, atmega

我正在尝试构建一个时钟，所以我正在使用 ASM 和一个 arduino。对于大多数部分来说，纯 C 就可以了，但是为了准备输出到 BCD 到十进制转换器的时间，我决定使用 ASM。我在 8086 C++/ASM 中编写了以下代码，它在我的计算机上运行良好：

```
#include <iostream>

using namespace std;

int main(int argc, char **argv)
{
    for(int num = 0; num < 16; num++) {
        int bin[4];
        bin[0] = bin[1] = bin[2] = bin[3] = 0;
        asm("movl %%ebx, %%eax;"
            "andl $8, %%eax;"
            "cmp $0, %%eax;"
            "je a;"
            "movl $1, %0;"
            "jmp b;"
            "a: movl $0, %0;"
            "b: movl %%ebx, %%eax;"
            "andl $4, %%eax;"
            "cmp $0, %%eax;"
            "je c;"
            "movl $1, %1;"
            "jmp d;"
            "c: movl $0, %1;"
            "d: movl %%ebx, %%eax;"
            "andl $2, %%eax;"
            "cmp $0, %%eax;"
            "je e;"
            "movl $1, %2;"
            "jmp f;"
            "e: movl $0, %2;"
            "f: movl %%ebx, %%eax;"
            "andl $1, %%eax;"
            "cmp $0, %%eax;"
            "je g;"
            "movl $1, %3;"
            "jmp h;"
            "g: movl $0, %3;"
            "h: nop"
            : "=r" (bin[0]), "=r" (bin[1]), "=r" (bin[2]), "=b" (bin[3])
            : "b" (num)
            : "%eax"
            );
        cout << num << ": ";
        for(int i = 0; i < 4; i++) {
            cout << bin[i];
        }
        cout << endl;
    }
    return 0;
} 
```

但是，当我修改它以在 Arduino 上运行时，事情完全停止工作：

```
 for(uint8_t num = 0; num < 16; num++) {
  uint8_t bin[4];
  bin[0] = bin[1] = bin[2] = bin[3] = 0;
  asm("mov __tmp_reg__, %[val];"
    "and __tmp_reg__, $8;"
    "cmp __tmp_reg__, $0;"
    "je a;"
    "mov %[bit8], $1;"
    "rjmp b;"
    "a: mov $0, %[bit8];"
    "b: mov %[val], __tmp_reg__;"
    "and __tmp_reg__, $4;"
    "cmp __tmp_reg__, $0;"
    "je c;"
    "mov %[bit4], $1;"
    "rjmp d;"
    "c: mov $0, %[bit4];"
    "d: mov %[val], __tmp_reg__;"
    "and __tmp_reg__, $2;"
    "cmp __tmp_reg__, $0;"
    "je e;"
    "mov %[bit2], $1;"
    "rjmp f;"
    "e: mov $0, %[bit2];"
    "f: mov %[val], __tmp_reg__;"
    "and __tmp_reg__, $1;"
    "cmp __tmp_reg__, $0;"
    "je g;"
    "mov %[bit1], $1;"
    "rjmp h;"
    "g: mov $0, %[bit1];"
    "h: nop"
    : [bit8] "=r" (bin[0]), [bit4] "=r" (bin[1]), [bit2] "=r" (bin[2]), [bit1] "=r" (bin[3])
    : [val] "r" (num)
    : "r0"
    ); 
```

8086 代码给出了您期望的输出：

> 0：0000
> 1：0001
> 2：0010
> 3：0011
> ...
> 13：1101
> 14：1110
> 15：1111

但是在 Arduino 上运行的代码给出了不同的输出：

> 0：5000
> 1：0000
> 2：0000
> 3：0000
> ...（零继续）
> 13：0000
> 14：0000
> 15：0000

正如你可以想象的那样，如果代码返回...... 五。而且我不知道当源中没有任何东西接近 5 时它如何返回 5。我不知道在这里做什么，所以我真的可以使用一些帮助。

我正在使用具有 ATMega32U 处理器的 Arduino Leonardo。我试过反汇编由 Arduino 软件生成的可执行文件（它用 AVR-GCC 编译它），但我似乎无法找到我输入的代码。

感谢您的时间，堆栈溢出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:39:54.140

您拥有的代码可以很容易地用 C++ 编写，如下所示：

```
 int bin[4] = {};

 bin[0] = !!(num & 8);
 bin[1] = !!(num & 4);
 bin[2] = !!(num & 2);
 bin[3] = !!(num & 1); 
```

或者：

```
int bin[4];
int bit = 8;
for(int i = 0; i < 4; i++)
{
    bin[i] = !!(num & bit);
    bit >>= 1;
} 
```

如果您不喜欢`!!`（这使得“取下一个值并将其设为 0 [如果为假] 或 1 [如果为真]），您可以将其替换为：

```
for(int i = 0; i < 4; i++)
{
    bin[i] = (num >> 3 - i) & 1;
} 
```

我认为您故意想要最低`bin`索引中的最高位，而不是最高索引中最高位的通常情况。

# android - onTabChanged 并不总是调用

> ID：15329825
> 
> 赞同：1
> 
> 时间：2013-03-11T01:20:10.347
> 
> 标签：android

我有根 tabWidget 和片段之一 - 子 tabWidget。

片段类是：

```
public class TopFragment extends Fragment implements TabHost.OnTabChangeListener{
    private TabWidget mTabs; 
```

tabhost 在 onCreateView() 中设置和设置监听器：

```
@Override 
public View onCreateView(...
...
    mTabs = (TabWidget)  view.findViewById(android.R.id.tabs);
    mTabHost = (TabHost) view.findViewById(R.id.tabhost_top);
    mTabHost.setOnTabChangedListener(this);
    mTabHost.setup(); 
```

在类中重写 onTabChange 方法：

```
@Override public void onTabChanged(final String tabId) { 
```

当当前片段设置为选中时调用：

```
@Override public void setUserVisibleHint(boolean isVisibleToUser) {
    super.setUserVisibleHint(isVisibleToUser);
    if (isVisibleToUser == true) { 
        mTabs.setCurrentTab(0);
        ...
    } 
```

问题：

当片段设置为可见时（点击选项卡） - 在子 tabWidget 上选择的是 0 项目索引。

# 1 次尝试：

1.  选择 0 索引，点击 2 或 3 - onTabChanged() 未调用
2.  选择 0 索引，点击 1 - 确定
3.  选择 1 个索引，点击 0 - 确定
4.  选择 0 索引，点击 2 或 3 - 确定

# 2尝试：

1.  选择 0 索引，点击 2 - onTabChanged() 未调用
2.  选择 0 索引，点击 2 - onTabChanged() 未调用
3.  选择 0 索引，点击 3 - 确定
4.  选择 3 索引，点击 2 - 确定

为什么在第一步 onTabChanged() 没有被调用？

# c# - 写入文件时压缩音频

> ID：15329826
> 
> 赞同：0
> 
> 时间：2013-03-11T01:20:16.807
> 
> 标签：c#, naudio

我正在尝试从声卡发出的音频创建一个录音机，这是我到目前为止的进展，问题是保存到文件时录制的音频太大，就像一首歌曲可以达到数百兆字节。

这是我的代码

```
using NAudio.CoreAudioApi;
using NAudio.Wave;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace Record_From_Soundcard
{
    public partial class frmMain : Form
    {
        private WaveFileWriter writer;
        private WasapiLoopbackCapture waveInSel;

        public frmMain()
        {
            InitializeComponent();
        }

        private void frmMain_Load(object sender, EventArgs e)
        {
            MMDeviceEnumerator deviceEnum = new MMDeviceEnumerator();
            MMDeviceCollection deviceCol = deviceEnum.EnumerateAudioEndPoints(DataFlow.Render, DeviceState.Active);

            cboAudioDrivers.DataSource = deviceCol.ToList();
        }       

        private void btnStopRecord_Click(object sender, EventArgs e)
        {
            waveInSel.StopRecording();
            writer.Close();
        }        

        private void btnStartRecord_Click(object sender, EventArgs e)
        {
            using (SaveFileDialog _sfd = new SaveFileDialog())
            {
                _sfd.Filter = "Mp3 File (*.mp3)|*.mp3";               

                if (_sfd.ShowDialog() == System.Windows.Forms.DialogResult.OK)
                {
                    MMDevice _device = (MMDevice)cboAudioDrivers.SelectedItem;
                    waveInSel = new WasapiLoopbackCapture(_device);
                    writer = new WaveFileWriter(_sfd.FileName, waveInSel.WaveFormat);                    

                    waveInSel.DataAvailable += (n, m) =>
                    {
                        writer.Write(m.Buffer, 0, m.BytesRecorded);
                    };

                    waveInSel.StartRecording();
                }
            }
        }
    }

} 
```

谁能帮助我在保存时如何压缩音频？

也许会在这部分添加

```
waveInSel.DataAvailable += (n, m) =>
    {
         writer.Write(m.Buffer, 0, m.BytesRecorded);
    }; 
```

提前致谢.. ;）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2021-10-22T16:34:39.833

> 尝试使用 naudio dll

```
Using NAudio.Wave; Using NAudio.Wave.SampleProviders;Using NAudio.Lame
Private void WaveToMP3(int bitRate = 128){
    String waveFileName = Application.StartupPath + @"\Temporal\mix.wav";
    String mp3FileName = Application.StartupPath + @"\Grabaciones\ " + Strings.Format(DateTime.Now, "dd-MM-yyyy.HH.mm.ss") + ".mp3";

    Using (var reader = New AudioFileReader(waveFileName))
    {
        Using (var writer = New LameMP3FileWriter(mp3FileName, reader.WaveFormat, bitRate))
        {
            reader.CopyTo(writer);
        }
        reader.Close();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T09:45:01.143

您不能通过保存扩展名为 .MP3 的 WAV 文件来制作 MP3 文件（这就是您在此处所做的）。您需要选择机器上可用的编码器，然后通过它传递音频。[我将在本文](http://www.codeproject.com/Articles/501521/How-to-convert-between-most-audio-formats-in-NET)中详细介绍如何使用 NAudio 执行此操作。

# php - 使用 mysql 将数据库中的用户邮政编码与会话用户匹配？

> ID：15329834
> 
> 赞同：0
> 
> 时间：2013-03-11T01:21:41.577
> 
> 标签：php, mysql

我正在尝试找到一种方法来显示我网站上另一个用户的本地用户，这些用户在数据库中具有匹配的邮政编码。

因此，例如，如果用户“a”的邮政编码为，`m3 4jj`而用户“b”的邮政编码为，`m3 4aj`则 mysql 查询将显示匹配并`m3 4`以例如开头的那些。我对 php 和 mysql 真的很陌生，不确定我是否朝着正确的方向前进。

到目前为止，我有这个：

```
function get_local_users() {
  global $connection;
  $query = "SELECT *
            From ptb_stats, ptb_users
            WHERE ptb_stats.user_id=ptb_users.id
            AND ptb_stats.user_postcode='m3'";
  $local_set = mysql_query($query, $connection);
  confirm_query($local_set);
  return $local_set;
} 
```

但是现在我想这样做，如果登录的用户/“._SESSION ['user_id']。” 将他们的邮政编码作为`m4`或然后显示具有匹配邮政编码的任何其他用户`m5`。`m6`

我试过这个：

```
function get_local_users() {
  global $connection;
  $query = "SELECT *
            From ptb_stats, ptb_users
            WHERE ptb_stats.user_id=ptb_users.id
            AND ptb_stats.user_postcode=".$_SESSION['user_postcode']."
  $local_set = mysql_query($query, $connection);
  confirm_query($local_set);
  return $local_set;
} 
```

但它导致了这个错误：

```
Database query failed: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 4 
```

我的数据库中存储邮政编码的列`user_postcode`在理论上我认为这会起作用；有什么理由不这样做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:31:15.030

像这样把单引号放回去......

```
$query = "SELECT *
        From ptb_stats, ptb_users
        WHERE ptb_stats.user_id=ptb_users.id
        AND ptb_stats.user_postcode='".$_SESSION['user_postcode']."'"; 
```

# django - Django：按评论计数设置的订单查询

> ID：15329835
> 
> 赞同：0
> 
> 时间：2013-03-11T01:21:44.033
> 
> 标签：django, comments, django-queryset, django-aggregation

非常简单...我使用的是 Django 1.4.1，并且需要按评论数量的倒数来订购查询集。我正在使用 Django 评论框架，并尝试使用其他答案中推荐的 .annotate(comment_count = Count('comment') 结构......我得到 'comment' doesn't resolve to a field error。

我也试过 django-generic-aggregate 的 0.3.1 版本，它会引发数据库错误，所以就这样了。

```
Photo.objects.filter(galleries=gallery).annotate(comment_count=Count('comments')).order_by('-comment_count')[(page-1)*RESULTS_PER_PAGE:page*RESULTS_PER_PAGE] 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T02:53:56.347

将功能放在照片模型下

```
class Photo(models.Model):
    .........

    def orders(self):
        //filter first the highest count of comments
        aggregate = Photo.objects.aggregate(comment_count=Count('comments'))
        return aggregate['comment_count'] + 1 
```

然后你可以在视图中这样调用它：

```
comments = Photo.objects.filter(galleries=gallery).orders() 
```

# c# - c# - 拖放识别源列表框

> ID：15329836
> 
> 赞同：-2
> 
> 时间：2013-03-11T01:21:46.820
> 
> 标签：c#, drag-and-drop, listbox, mouseevent

我已经让拖放工作正常了。我只需要知道有没有办法识别拖动的项目来自哪个列表框？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:42:41.480

尝试使用这个，我不认为是最好的解决方案，但它应该工作

```
foreach (ListBox _LB in this.Controls.OfType<ListBox>())
        {
            if(_LB.Items.Contains(listBox1.SelectedItem))
            {
                MessageBox.Show(_LB.Name);
            }
        } 
```

# mysql - 用于检查列中是否有任何单元格与一组给定字符串匹配的 SQL 查询。

> ID：15329839
> 
> 赞同：2
> 
> 时间：2013-03-11T01:22:18.423
> 
> 标签：mysql

我在一列中有这些数据

```
Steffi | ND Baumecker | Cassy 
```

我想进行查询以查找上述任何内容是否存在于另一列中

其他列的示例（艺术家是列名）

```
Artist
Steffi
Derrick Carter
Ben Klock
Craig Richards 
```

我不认为 LIKE 会在这里工作，所以想知道在进行匹配时我可以使用什么查询从“艺术家”列返回艺术家姓名 - 所以在上面的示例中将返回“Steffi”。

我是否还需要删除 | 之前和之后的空格？在第一列？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T04:41:51.180

If I understand properly your problem: you want to filter rows using values from a column and searching for these values in another column?

```
SELECT a.first_name, a.last_name, a.nickname
FROM artist AS a
WHERE a.related_nickname IN (
    SELECT sa.nickname
    FROM artist AS sa
    WHERE sa.popularity > 30
) 
```

MySQL documentation: [http://dev.mysql.com/doc/refman/5.1/en/any-in-some-subqueries.html](http://dev.mysql.com/doc/refman/5.1/en/any-in-some-subqueries.html)

It seems that you are trying to achieve a complicated task and I'd advise you to try a couple of things.

*   Subqueries are useful but makes your queries much slower so using two queries might speed things up. The first query would pick the values that will be used for filtering and the second query will search rows.

*   If you filter by string, consider using indexes on your table: [http://dev.mysql.com/doc/refman/5.1/en/create-index.html](http://dev.mysql.com/doc/refman/5.1/en/create-index.html)

# c# - 比较 ColorBlends

> ID：15329840
> 
> 赞同：1
> 
> 时间：2013-03-11T01:22:26.240
> 
> 标签：c#, .net, system.drawing

如何检查两个`ColorBlends`是否具有不同的`Colors`值？

我尝试了以下代码

```
ColorBlend Blend1 = new ColorBlend();
Blend1.Colors = new Color[] { Color.White, Color.Black };
Blend1.Positions = new float[] { 0.0f, 1.0f };

ColorBlend Blend2 = new ColorBlend();
Blend2.Colors = new Color[] { Color.White, Color.Black };
Blend2.Positions = new float[] { 0.0f, 1.0f };

if (Blend1.Colors != Blend2.Colors)
{
    MessageBox.Show("Values are Different");
} 
```

它不起作用，因为当两者的`Colors`值相同时`Blends`，它仍然说它们不相等！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T01:26:53.737

检查不正确。您不能以这种方式比较两个数组。您必须仔细检查并比较每个项目以确保它们相等

# java - 如何从 C++/JNI 调用采用 Android Context 参数的 Java 方法

> ID：15329841
> 
> 赞同：5
> 
> 时间：2013-03-11T01:22:31.330
> 
> 标签：java, android, c++, java-native-interface

我正在尝试通过 Android 上的 C++/JNI 调用 Java 类。更具体地说，我试图调用这个类的构造函数，它以 Android 上下文作为参数。如果我的构造函数没有参数，我可以成功调用，但是当我包含必要的 Context 作为参数时，我不知道我的 JNI 签名应该是什么样子，并且还怀疑这是否可能，因为我没有访问该上下文对象。

所以，我的问题是，是否可以调用将 Android 上下文作为其唯一参数的 Java 类的构造函数？如果是这样，如何？如果没有，是否有解决方法，因为我需要上下文来访问某些 Android API 类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T00:07:21.173

我不相信它可能以你所说的方式。但是，在不知道类的结构的情况下，您始终可以将其创建为带有静态实例的单例，该实例在您的 Activity 启动时被实例化，从而该类在当时获得所需的上下文。它基本上会坐在那里，直到您准备好从 C++ 调用，但确实可以通过上下文为您的请求提供服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T04:29:11.840

在获取构造函数的方法 ID 时，您只需指定您想要的方法 ID。目前，您可能正在执行以下操作：

```
constructor = (*env)->GetMethodID(env, cls, "<init>", "()V");
object = (*env)->NewObject(env, cls, constructor); 
```

相反，您希望在使用时指定参数的类型，`GetMethodID`并在调用时将其传入`NewObject`。

```
constructor = (*env)->GetMethodID(env, cls, "<init>", "(Landroid/content/Context;)V");
object = (*env)->NewObject(env, cls, constructor, context); 
```

# java - 如何使用在 Maven 中列为依赖项的包中的类？

> ID：15329848
> 
> 赞同：0
> 
> 时间：2013-03-11T01:24:27.410
> 
> 标签：java, maven, import, dependencies

刚接触 Java 和 Maven 并且遇到依赖问题。（不使用 IDE）

在我的项目的 pom.xml 中，我有：

```
<dependency>
  <groupId>org.apache.pdfbox</groupId>
  <artifactId>pdfbox</artifactId>
  <version>1.7.1</version>
  <scope>compile</scope>
</dependency> 
```

第一个构建下载了依赖项并编译没有错误。但是，在 MyClass.java 中，声明：

```
import org.apache.pdfbox; 
```

导致错误：

```
.../MyClass.java:[3,17]error: package org.apache does not exist 
```

如何在我的类中包含 Maven 依赖项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:29:11.583

该说法`import org.apache.pdfbox`不正确。您从包中导入类，而不是包本身。例如，

```
// Import a single class from package pdfbox
import org.apache.pdfbox.SomeClass; 
```

或者

```
// Import all classes from package pdfbox 
// (But this doesn't import classes from sub-packages)
import org.apache.pdfbox.*; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T01:28:46.183

您需要在导入语句中指定类或通配符。当前，您正在尝试一个名为的类，该类`pdfbox`不存在。如果要导入`pdfbox`包中的所有内容，可以使用：

```
import org.apache.pdfbox.*; 
```

请参阅导入：[使用包成员](http://docs.oracle.com/javase/tutorial/java/package/usepkgs.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T01:29:07.387

没有名为 org.apache.pdfbox 的类，这是一个包你需要

```
import  org.apache.pdfbox.*; 
```

# apache - 使用 Mod Rewrite 进行 URL 解析/转换

> ID：15329853
> 
> 赞同：-2
> 
> 时间：2013-03-11T01:24:54.943
> 
> 标签：apache, mod-rewrite

我想重写一个 url，这样如果用户输入或点击一个看起来像这样的链接： **“mysite.com”** 或 **“ [http://mysite.com](http://mysite.com) ”** 或 **“www.mysite.com”** *他们会被带到* **“ [http ://www.mysite.com](http://www.mysite.com) ”**。

我目前在我的 .htcaccess 文件中使用以下代码，但它似乎没有做任何事情：

```
RewriteEngine On
RewriteCond !^www\.mysite\.com [NC]
RewriteCond %{HTTP_HOST}   !^$
RewriteCond $1 !^(favicon\.ico|favicon\.png|media|robots\.txt|crossdomain\.xml|css|js)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^/?(.*) http://www.mysite.com/$1 [L,R=301,NE]

RewriteCond $1 !^(favicon\.ico|favicon\.png|media|robots\.txt|crossdomain\.xml|css|js)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?url_params=$1 [L,QSA]

<filesMatch "\\.(ico|pdf|flv|jpg|jpeg|png|gif|swf)$">
    #Header set Cache-Control "max-age=29030400, public"
</filesMatch>
<filesMatch "\\.(css)$">
    #Header set Cache-Control "max-age=29030400, public"
</filesMatch>
<filesMatch "\\.(js)$">
    #Header set Cache-Control "max-age=29030400, private"
</filesMatch>
<filesMatch "\\.(xml|txt)$">
    #Header set Cache-Control "max-age, public, must-revalidate"
</filesMatch> 
```

*错误已修复。

我的网站现在加载，但例如，如果我去 mysite.com 它不会将我重定向到[http://www.mysite.com](http://www.mysite.com)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T02:56:06.817

好的，我解决了。事实证明，我的重写条件顺序错误。

正确方法：RewriteCond $1 !^(favicon.ico|favicon.png|media|robots.txt|crossdomain.xml|css|js) RewriteCond %{REQUEST_FILENAME} !-f RewriteCond %{REQUEST_FILENAME} !-d RewriteRule ^(. *)$ index.php?url_params=$1 [L,QSA]

RewriteCond !^www.mysite.com [NC] RewriteCond %{HTTP_HOST} !^$ RewriteCond $1 !^(favicon.ico|favicon.png|media|robots.txt|crossdomain.xml|css|js) RewriteCond %{REQUEST_FILENAME } !-f RewriteCond %{REQUEST_FILENAME} !-d RewriteRule ^/?(.*) [http://www.mysite.com/](http://www.mysite.com/) $1 [L,R=301,NE]

# context-free-grammar - 非回文的上下文无关语法

> ID：15329855
> 
> 赞同：0
> 
> 时间：2013-03-11T01:25:16.790
> 
> 标签：context-free-grammar

所以我发现一个人在这里询问非回文的 [上下文无关语法：非回文的上下文无关语法](https://stackoverflow.com/questions/6495154/context-free-grammar-for-non-palindrome)

给定的 CFG 是：

```
R -> XRX | S
S -> aTb | bTa
T -> XTX | X | <epsilon>
X -> a | b 
```

和

```
R -> aRa | bRb | S
S -> aTb | bTa
T -> aTa | bTb | a | b | <epsilon> 
```

我的问题：尽管它不是回文，但这个 CFG 不会不接受 'aaabba' 吗？如果这个 CFG 的规则更像：

```
T -> aTa | bTb | aTb | bTa | a | b | <epsilon> 
```

而不是上面给出的最后一行？还是我误解了什么？:<

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:30:00.597

第一个很好，但第二个不是。

对于第一个，顺序是

```
R -> XRX -> aRa -> aSa -> aaTba -> aaXTXba -> aaaTbba -> aaabba. 
```

我相信您说第二个无法生成所有非回文是正确的。

# iphone - Phonegap 和 Nova 数据框架 -

> ID：15329859
> 
> 赞同：1
> 
> 时间：2013-03-11T01:26:06.250
> 
> 标签：iphone, sqlite, cordova

我正在为一个应用程序项目学习 PhoneGap，并且需要在某些方面使用数据库，我正在尝试 Nova Data 框架，

[https://cordova.codeplex.com/wikipage?title=How%20to%20use%20nova.data](https://cordova.codeplex.com/wikipage?title=How%20to%20use%20nova.data)

我正在尝试使用我的代码来组合一个测试实体，但是我收到一个 db 错误，告诉我缺少一个表。该文档未指定应事先创建数据库，但我开始认为可能是这种情况。有没有人在项目中使用过 Nova 框架？我只需要一点指导。

这是我用来启动数据库上下文的代码：

```
var DataContext = function () {
    nova.data.DbContext.call(this, "HealthDb", "1.0", "Health DB", 1000000);
    this.Temperatures = new nova.data.Repository(this, Temperature, "Temperatures");
};
DataContext.prototype = new nova.data.DbContext();
DataContext.constructor = DataContext; 
```

我的实体（温度）：

```
var Temperature = function () {
    nova.data.Entity.call(this);
    this.Value = 101;
};
Temperature.prototype = new nova.data.Entity();
Temperature.constructor = Temperature; 
```

它正在创建一个具有正确名称的空数据库，只是没有表！我很感激任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-03T07:51:43.560

感谢您使用我们的图书馆。我已经将 html5 sqlite 作为一个独立的库。请从[github](https://github.com/leotsai/html5sqlite)获取。

那里还提供了现场演示链接。并且文档更完整。lib 本身也已更新并修复了一些错误。

谢谢，

狮子座

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T14:49:56.097

原来我在定义实体类之前试图启动 dbcontext....

更改了我的 js 文件的顺序，它可以工作。

# c# - 在 C# 中，在 DateTime 数组中查找间隙的最佳方法是什么？

> ID：15329860
> 
> 赞同：5
> 
> 时间：2013-03-11T01:26:09.330
> 
> 标签：c#, datetime, collections

我有一个相隔一个月的日期列表，因为所有日期都是“本月的第一个星期一”。在某些情况下缺少月份，所以我需要编写一个函数来确定所有日期是否是连续的

因此，例如，如果这是日期列表，则该函数将返回 true，因为所有项目都是“本月的第一个星期五”并且没有间隔。下面的示例将返回 true。

```
 var date = new DateTime(2013, 1, 4);
 var date1 = new DateTime(2013, 2, 1);
 var date2 = new DateTime(2013, 3, 1);
 var date3 = new DateTime(2013, 4, 5);

 var dateArray = new DateTime[]{date, date1, date2, date3};
 bool isConsecutive = IsThisListConsecutive(dateArray); 
```

下面的示例将返回 false，因为即使它们也是“本月的第一个星期五”，它也缺少 2013 年 3 月的项目。

```
 var date = new DateTime(2013, 1, 4);
 var date1 = new DateTime(2013, 2, 1);
 var date3 = new DateTime(2013, 4, 5);

 var dateArray = new DateTime[]{date, date1, date3};
 bool isConsecutive = IsThisListConsecutive(dateArray); 
```

所以我试图找出 IsThisListConsecutive() 方法的正确逻辑：

这是我的第一次尝试：（请注意，我已经预先知道所有日期都是一周中的同一天和一个月的同一周，所以我唯一要寻找的是缺少的插槽）

```
 private bool IsThisListConsecutive(IEnumerable<DateTime> orderedSlots)
    {
        DateTime firstDate = orderedSlots.First();
        int count = 0;
        foreach (var slot in orderedSlots)
        {
            if (slot.Month != firstDate.AddMonths(count).Month)
            {
                return false;
            }
            count++;
        }
        return true;
    } 
```

如果列表从一年跨越到另一年，则上面的代码可以工作。我想就创建此函数的更好方法以及如何重写该行以处理跨越数年的日期获得任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T16:48:13.183

因此，为了实现这一点，我们将从一个简单的辅助方法开始，该方法接受一个序列并返回一个成对序列，这些对组成每个项目与其前一个项目。

```
public static IEnumerable<Tuple<T, T>> Pair<T>(this IEnumerable<T> source)
{
    T previous;
    using (var iterator = source.GetEnumerator())
    {
        if (iterator.MoveNext())
            previous = iterator.Current;
        else
            yield break;

        while(iterator.MoveNext())
        {
            yield return Tuple.Create(previous, iterator.Current);
            previous = iterator.Current;
        }
    }
} 
```

我们还将使用这个简单的方法来确定两个日期是否在同一个月份：

```
public static bool AreSameMonth(DateTime first, DateTime second)
{
    return first.Year == second.Year 
        && first.Month == second.Month;
} 
```

使用它，我们可以轻松地获取每个日期的月份，并查看它是否是上个月之后的月份。如果所有对都是如此，那么我们有连续的月份。

```
private static bool IsThisListConsecutive(IEnumerable<DateTime> orderedSlots)
{
    return orderedSlots.Pair()
        .All(pair => AreSameMonth(pair.Item1.AddMonths(1), pair.Item2));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T01:33:37.883

我建议看一下`TimeSpan`结构。由于运算符重载，您可以`TimeSpan`通过减去两个日期来获得 a，然后接收`TimeSpan`表示两个日期之间差异的 a。

[http://msdn.microsoft.com/en-us/library/system.timespan.aspx](http://msdn.microsoft.com/en-us/library/system.timespan.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T01:52:05.967

注意：这是完全未经测试的，日期检查可能很糟糕或有些多余，但这是我现在能想到的最好的方法^^

```
public bool AreSameWeekdayEveryMonth(IEnumerable<DateTime> dates)
{
    var en = dates.GetEnumerator();
    if (en.MoveNext())
    {
        DayOfWeek weekday = en.Current.DayOfWeek;
        DateTime previous = en.Current;
        while (en.MoveNext())
        {
            DateTime d = en.Current;
            if (d.DayOfWeek != weekday || d.Day > 7)
                return false;
            if (d.Month != previous.Month && ((d - previous).Days == 28 || (d - previous).Days == 35))
                return false;
            previous = d;
        }
    }
    return true;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-11T02:19:03.933

好的，当年份交叉时，您的代码不起作用，因为 1 月 1 日可能是一年的星期一和下一个星期二。如果我这样做，我会首先检查

a) 它们是每个月的同一天（使用 DateTime.DayOfWeek）

b) 它们是每个月的同一周* 使用扩展方法 DayOfMonth（请参阅链接）*[在 .NET 中计算月份中的星期](https://stackoverflow.com/questions/2136487/calculate-week-of-month-in-net/2136549#2136549)*

> （你说你已经知道 a & b 是真的，所以让我们继续第三个条件）

c) 我们必须确定它们是否连续几个月

```
//order the list of dates & place it into an array for ease of looping
DateTime[] orderedSlots = slots.OrderBy( t => t).ToArray<DateTime>();

//create a variable to hold the date from the previous month
DateTime temp = orderedSlots[0];

for(i= 1; index < orderedSlots.Length; index++)
{
    if((orderedSlots[index].Month != temp.AddMonths(1).Month |
        orderedSlots[index].Year  != temp.AddMonths(1).Year)){
        return false;
    }

    previousDate =  orderedSlots[index];
}

return true; 
```

如果您需要检查条件 a & b 以及添加更改 if 语句如下

```
 if( orderedSlots[index].Month != temp.AddMonths(1).Month |
        orderedSlots[index].Year  != temp.AddMonths(1).Year) |
        orderedSlots[index].DayOfWeek != temp.DayOfWeek      |
        orderedSlots[index].GetWeekOfMonth != temp.AddMonths(1).GetWeekOfMonth){
        return false;
    } 
```

请记住，要使用获取月份扩展方法，您必须将代码包含 [在 .NET 中计算月份的周数](https://stackoverflow.com/questions/2136487/calculate-week-of-month-in-net/2136549#2136549) 中

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-11T03:40:36.903

好吧，这是*我*对如何解决这个问题的初步想法。

首先，定义一个函数，将日期转换为与它们*应该*出现的顺序相对应的序数值。

```
int ToOrdinal(DateTime d, DateTime baseline) {
   if (d.Day <= 7
       && d.DayInWeek == baseline.DayInWeek) {
      // Since there is only one "First Friday" a month, and there are
      // 12 months in year we can easily compose the ordinal.
      // (As per default.kramer's comment, months normalized to [0,11].)
      return d.Year * 12 + (d.Month - 1);
   } else {
      // Was not correct "kind" of day -
      // Maybe baseline is Tuesday, but d represents Wednesday or
      // maybe d wasn't in the first week ..
      return 0;
   }
}

var dates = ..;
var baseline = dates.FirstOrDefault();
var ordinals = dates.Select(d => ToOrdinal(d, baseline)); 
```

然后，对于提供的日期，我们最终得到如下序数序列：

```
[24156 + 0, 24156 + 1, 24156 + 2, 24156 + 3] 
```

和

```
[24156 + 0, 24156 + 1, /* !!!! */ 24156 + 3] 
```

从这里开始，迭代列表并确保整数按顺序出现而没有间隙或停顿只是一件小事——也就是说，每个项目/整数都比前一个多一个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-11T01:56:27.913

我可能会误解您正在尝试做的事情，但我认为这会奏效，假设您不必处理古代日期。查看转换为“总月数”的日期是否有任何差距

```
int totalMonths = date.Year * 12 + (date.Month - 1); 
```

# django - Django视图预处理

> ID：15329862
> 
> 赞同：0
> 
> 时间：2013-03-11T01:26:22.630
> 
> 标签：django, django-views

只是在这里寻找一些关于如何在“Django 时尚”中实现这个概念的指导。

我正在使用 dbsettings 来定义站点级别的变量。在每个请求上，我都想检查我的站点级别变量之一，并根据该变量的值呈现不同的响应。

现在我意识到我可以通过在我的每个视图函数中添加一个简单的 if 语句来轻松实现这一点，但我认为可能有一种方法可以在更高级别上应用它？

让我知道是否有办法在所有请求中“全球化”此功能。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T01:47:08.947

实际上，您真正想要的是[middleware](https://docs.djangoproject.com/en/dev/topics/http/middleware/)，如果该设置将影响首先选择的模板，或显着影响响应。它比使用模板上下文处理器灵活得多，如果您只是想将几个变量添加到您的上下文中，这更合适。

您在应用程序中创建了一个 middleware.py，其中可能包含以下内容：

```
from django.conf import settings

class MyMiddleware(object):
    def process_request(self, request):
        request.my_app_setting = settings.MY_APP_SETTING 
```

不要忘记将您的课程添加到您的 MIDDLEWARE_CLASSES 设置中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T01:38:13.013

您可以使用自定义[模板上下文处理器](https://docs.djangoproject.com/en/dev/ref/templates/api/#writing-your-own-context-processors)将“全局”上下文传递给您的视图。

为此，请在应用程序的某处使用类似于以下示例的代码创建一个新的 contextprocessors.py（它所要做的就是返回一个 dict）。然后使用 settings.py 中的**TEMPLATE_CONTEXT_PROCESSORS**元组中的函数添加文件的路径（即：yourapp.contextprocessors.resource_urls）。

```
from django.conf import settings

def resource_urls(request):
    """Passes global values to templates."""

    return dict(
        TIME_ZONE = settings.TIME_ZONE,
    ) 
```

现在您可以按预期在模板中引用这些键：`{{ TIME_ZONE }}`.

# android - Android 网络浏览器：不弹出菜单选项

> ID：15329863
> 
> 赞同：0
> 
> 时间：2013-03-11T01:26:28.500
> 
> 标签：android, html, browser, menu

[我正在开发的网页](http://www.whitegloveapps.com/priceper/priceperdev.html)出现问题，单位价格计算器（HTML、CSS 和 JavaScript/jQuery）：在 Android 2.3.3 默认网络浏览器中查看时，靠近顶部的菜单页面，单位类型和显示单位，没有弹出（让用户从菜单中选择一个项目）。Android 模拟器和运行 2.3.3 的 Android 手机都会出现此问题。这些菜单适用于我测试过的更高版本的 Android 网络浏览器（模拟器中的 4.0.3 和 4.2），以及 iOS 6 和计算机上（测试过的 Firefox 和 Chrome 浏览器）。

在 Android 2.3.3 网络浏览器中，当一个菜单被点击时，一个彩色矩形应该会突出显示网页上的菜单，然后菜单选项会在屏幕上以列表的形式弹出。在我的网页上，对于页面顶部附近的那些菜单，矩形出现（比被点击的菜单宽），但是当它到达菜单所在的 div（行）的底部时似乎停止了，并且没有弹出菜单选项；[请参阅此屏幕截图](http://www.whitegloveapps.com/priceper/android-menu-fail.jpg)中的橙色矩形。网页下方的菜单工作正常。

这是简化的 HTML：

```
<div class="header">
    <div class="global">
        <div id="unitTypeDiv" class="options col1 unit"><!-- left column-->
                <label for="unitType" class="label">Unit type</label><br>
    <select name="unitType" id="unitType" class="unitType_input" title="Unit type">
                    <option value="weight">weight</option>
                    <option value="volume">volume</option>
                    <option value="length">length</option>
                    <option value="area">area</option>
                </select>
            </div>

            <div id="displayUnitDiv" class="options col2 unit"><!-- center column-->
                <span id="displayUnitLabel"><label for="displayUnit" class="label">Display unit</label><br></span>
                <select name="displayUnit" id="displayUnit" class="displayUnit_input unit_input" title="Display unit">
                    <option value="oz">oz</option>
                    <option value="lb">lb</option>
                </select>
            </div>
        </div>   <!-- .global -->

    </div> <!-- .header -->
    <div id="products">

        <form method="post" name="priceper" id="priceper">

            <div class="product" id="product_0">
                <div class="name">
                    <label for="name_0" class="label"><span>Product 1:</span> Name<br></label>
                    <input name="name_0" type="text" id="name_0" title="Product 1">
                </div>
                <div class="unit row">
                    <label for="unit_0" class="label">Unit</label><br>
                    <select name="unit_0" id="unit_0" class="unit_input product_unit_input" title="Please choose a unit"> <!--replace with select (pop-up menu)-->
                        <option value="oz">oz</option>
                        <option value="lb">lb</option>
                    </select>
                </div>

            </div> <!--product_0-->

        </form>

    </div> <!-- products --> 
```

编辑：这是CSS：

```
body {
    background-color: #ddd;
    color: #222;
    font-family: Helvetica; 
    margin: 0;
    padding: 0;
}

/* HEADER STYLES */
    .header {
        position:fixed; /* Keep header (title) at top of page always */
        top: 0;
        width: 100%;
        z-index:99998; /* Bring to front */
        /*border: 1px dashed red;*/
    }
    .header h1 {
        padding: 0;
        text-align: center;
        text-shadow: 0px 1px 0px #fff;
        /*background-image: -webkit-gradient(linear, left top, left bottom, 
                                           from(#ccc), to(red));*/ /* iPhone linear shading; not working*/
        /*border: 1px dashed red;*/
        margin-top: -3px;
        margin-bottom: -3px;
        background-color: #ccc;
        padding-top: 5px;
        padding-bottom:3px;
        text-align: center;
        border-bottom: 1px solid #666;
    }
    .header h1 a {
        color: #222;
        display: block;
        font-size: 20px;
        font-weight: bold;
        text-decoration: none;
    }
    .global {
        /*border: 1px dashed red;*/
        background-color: #eee; /* Background color */
        height: 43px;
        padding-top: 0px;
        z-index: 9999;
        /*border-bottom: 1px solid #666;*/
    }
    .col1 {     /* Unit type menu */
        float: left;
        margin-left: 5px;
        /*border: 1px dashed red;*/
    }
    .col2 {     /* Display unit menu */
        float: none;
        overflow: hidden;
        text-align:center;
        /*display: table-cell;*/
        /*border: 1px dashed green;*/
        position: absolute;
        /* center on browser window: put left at 50%, then offset left (margin-left) by half the width (half of 30% = 15%) */
        width: 50%;
        position: absolute;
        left: 50%;
        margin-left: -25%;
    }

/* PRODUCT STYLES */
    .product {
        padding-top: 2px;
        padding-bottom: 3px;
        padding-left: 5px;
        padding-right: 5px;
        background-color: #DCDCDC;
        border-bottom: 1px solid #999999;
        color: #222222;
    }
    #product_0 {
        margin-top: 100px;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T01:37:09.923

显然，Android 2.3.3 网络浏览器不喜欢最后一个 CSS 属性 , `margin-top`, 在一个 div 上`#product_0`, 低于有问题的菜单所在的那个。只需更改该属性即可`padding-top`：

```
 #product_0 {
        padding-top: 100px;
    } 
```

[这是生成的网页（完整版而不是简化代码）。](http://www.whitegloveapps.com/priceper/priceperdev.html)

# jquery - 日期时间选择器 - jquery mobile

> ID：15329865
> 
> 赞同：0
> 
> 时间：2013-03-11T01:26:50.040
> 
> 标签：jquery

我在网上找到了一个 jquery 移动[数据时间选择器。](http://mobipick.sustainablepace.net/demo.html)

我遵循了所有的指示。在页面中，所有css和js都安装成功。为了在文本框中使用日期时间选择器，我使用以下代码：

脚本： $(document).on("pagecreate", "#demo", function() { var picker = $("input[type='text']", this); picker.mobipick(); picker.on ("change", function() { var date = $(this).val(); // 格式化日期
var dateObject = $(this).mobipick("option", "date"); }); });

HTML：

```
<div id="demo" class="content no-heading" >
    <h1><span>Financial Transactions</span></h1>
    <div  data-role="content" style="padding:5px 0 6px 6px;"  id="SearchTermsText">
        <label for="BeginDateText">Begin date</label>
        <br />
        <input type="text" name="beginDate" style="width:95%;" value=""></input> 
        <br />
        <label for="EndDateText">End date:</label>
        <br />
        <input type="text" name="endDate" style="width:95%;" value=""></input>
        <br />
        <input type="submit" value="Search" onclick="SubmitAction('Search');"></input>
    </div> 
</div> 
```

但是当我单击文本框时，什么也没有发生。没有日期时间选择器，为什么？

# java - 用Java制作数字时钟

> ID：15329869
> 
> 赞同：2
> 
> 时间：2013-03-11T01:28:06.813
> 
> 标签：java, swing, gregorian-calendar

我正在为一个项目制作一个数字时钟，我有四个类：`DigitalTimeUI`，它是 JFrame 类，`TitlePanel`，`DigitPanel`和`ColonPanel`，它们是所述项目的 JPanel。完成后，它应该如下所示：

![在此处输入图像描述](../Images/d6dc8b01c57dd3d0d40eeb9d967a4f7d.png)

我坚持的部分是将`DigitPanel`s 添加到 UI 类的框架中。这是我现在在主要课程中的内容：

```
public class DigitalTimeUI extends JFrame {

public static GregorianCalendar currentDate;
final static int CLOCKWIDTH = 605;
final static int CLOCKHEIGHT = 200;

public static void main(String[] args) {
    int numOfDigits = 6;
    int startingX = 0;
    int startingY = 0;

    Font clockFont = new Font("Tahoma", Font.BOLD, 72);
    JFrame clock = new JFrame();

    clock.setSize(CLOCKWIDTH, CLOCKHEIGHT);
    clock.setVisible(true);
    clock.setResizable(false);
    clock.setDefaultCloseOperation(EXIT_ON_CLOSE);

    TitlePanel titlePanel = new TitlePanel();
    JLabel title = new JLabel("DIGITAL CLOCK");
    title.setFont(clockFont);
    title.setForeground(Color.BLACK);
    titlePanel.add(title);
    clock.add(titlePanel);

    DigitPanel digitPanel = new DigitPanel();
    JLabel digit;
    startingY = 115;
    while (numOfDigits > 0) {
        if ((numOfDigits % 2) == 0) {
            startingX += 5;
            digit = new JLabel(String.valueOf(0));

        }

    }
  }
} 
```

代码现在有点乱，在弄清楚最后一部分之后，我还有一些清理工作要做。底部只是我尝试显示 6 位字段的一些废品。我认为我遇到的主要问题是找到一种方法来分割返回的时间`GregorianCalendar`并将它们放入 6 个不同的盒子中，然后是一种使用 while 循环或诸如此类将它们放入框架的有效方法。

**澄清一下：** 上面的图片是教练给我的，作为我格式化时钟时的指导。它也有9个面板。“数字时间”是`TitlePanel`班级的一个面板。数字框是`DigitPanel`类的，其中有 6 个。冒号框属于`ColonPanel`该类，并且有两个。我遇到的问题是将时间分成 6 个不同的盒子。就像图片显示“48”的地方，我需要一种方法来获取值`GregorianCalendar.MINUTE`或其他值并将其拆分为 4 和 8 以放入每个盒子中。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T07:16:00.300

如果我正确理解了这个问题...

您在 OO 环境中工作。您应该尽可能将设计分解为最小的可管理工作单元。

对我来说，这意味着每个数字（或时间单位）都是最小的工作单位。这将需要一个能够简单地显示 0 填充的 int 值的组件。

从那里，您可以构建一个时钟窗格，使用 3 位数窗格，依此类推。

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.FontMetrics;
import java.awt.Graphics;
import java.awt.GridBagLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Calendar;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.Timer;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class DigitalClock {

    public static void main(String[] args) {
        new DigitalClock();
    }

    public DigitalClock() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });
    }

    public class TestPane extends JPanel {

        private DigitPane hour;
        private DigitPane min;
        private DigitPane second;
        private JLabel[] seperator;

        private int tick = 0;

        public TestPane() {
            setLayout(new GridBagLayout());

            hour = new DigitPane();
            min = new DigitPane();
            second = new DigitPane();
            seperator = new JLabel[]{new JLabel(":"), new JLabel(":")};

            add(hour);
            add(seperator[0]);
            add(min);
            add(seperator[1]);
            add(second);

            Timer timer = new Timer(500, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    Calendar cal = Calendar.getInstance();
                    hour.setValue(cal.get(Calendar.HOUR_OF_DAY));
                    min.setValue(cal.get(Calendar.MINUTE));
                    second.setValue(cal.get(Calendar.SECOND));

                    if (tick % 2 == 1) {
                        seperator[0].setText(" ");
                        seperator[1].setText(" ");
                    } else {
                        seperator[0].setText(":");
                        seperator[1].setText(":");
                    }
                    tick++;
                }
            });
            timer.setRepeats(true);
            timer.setCoalesce(true);
            timer.start();
        }

    }

    public class DigitPane extends JPanel {

        private int value;

        @Override
        public Dimension getPreferredSize() {
            FontMetrics fm = getFontMetrics(getFont());
            return new Dimension(fm.stringWidth("00"), fm.getHeight());
        }

        public void setValue(int aValue) {
            if (value != aValue) {
                int old = value;
                value = aValue;
                firePropertyChange("value", old, value);
                repaint();
            }
        }

        public int getValue() {
            return value;
        }

        protected String pad(int value) {
            StringBuilder sb = new StringBuilder(String.valueOf(value));
            while (sb.length() < 2) {
                sb.insert(0, "0");
            }
            return sb.toString();
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g); 
            String text = pad(getValue());
            FontMetrics fm = getFontMetrics(g.getFont());
            int x = (getWidth() - fm.stringWidth(text)) / 2;
            int y = ((getHeight()- fm.getHeight()) / 2) + fm.getAscent();
            g.drawString(text, x, y);
        }        
    }    
} 
```

**更新**

基本上你可以做类似...

```
String min = String.valueOf(Calendar.getInstance().get(Calendar.MINUTE));
char[] digits = min.toCharArray(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T01:52:39.043

如此处所示[，](http://docs.oracle.com/javase/tutorial/i18n/format/simpleDateFormat.html)用于`SimpleDateFormat`格式化您的时间。这将为您提供一个格式化的字符串，您可以索引该字符串以获取组件的文本。

此相关[示例](https://stackoverflow.com/a/2166500/230513)使用以下格式化程序：

```
private static final SimpleDateFormat df = new SimpleDateFormat("HH:mm:ss");
private final Date now = new Date();
...
String s = df.format(now); 
```

# javascript - KineticJS 以编程方式设置笔划

> ID：15329870
> 
> 赞同：0
> 
> 时间：2013-03-11T01:28:15.620
> 
> 标签：javascript, jquery, kineticjs

我有一些文本，它有一个“链接变量文本”形式的类（其中变量文本对每个链接都是唯一的）。我正在尝试进行设置，以便当我将鼠标悬停在文本上时，相应的对象会使用 jQuery 更改颜色。

我所拥有的 jsFiddle：http: [//jsfiddle.net/hdJCn/](http://jsfiddle.net/hdJCn/)

我正在使用的代码：

```
<a href="javascript:void(0);" class="link one">One</a>
<a href="javascript:void(0);" class="link two">Two</a>
<a href="javascript:void(0);" class="link three">Three</a>
<div id="container"></div>

var stage = new Kinetic.Stage({
container: 'container'
});

var layer = new Kinetic.Layer();

var onecircle = new Kinetic.Ellipse({
x: 100,
y: 100,
radius: {
    x: 50,
    y: 50
},
strokeWidth: 1,
stroke: 'black'
});

layer.add(onecircle);
stage.add(layer);

$('.link').mouseover(function () {
var numclass = $(this).attr('class').split(' ')[1];
(numclass + 'circle').setStroke('orange');
}); 
```

问题是它说该对象没有方法“setStroke”。如果我采用相同的对象名称并对其进行硬编码（所以 onecircle.setStroke 而不是上面的）它可以正常工作。我不确定为什么会这样，到目前为止我很茫然。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T02:03:14.927

弄清楚了。我必须将字符串转换为对象：

```
var obj = eval(numclass+'circle'); 
```

然后使用`obj.setStroke`....

# doctrine-orm - Doctrine 2 Hydrator - 带下划线的字段

> ID：15329871
> 
> 赞同：5
> 
> 时间：2013-03-11T01:28:37.553
> 
> 标签：doctrine-orm, zend-framework2

我使用 zf2.1.3 和教义 2。我试图在我的课堂上补充信息，并意识到它`DoctrineModule\Stdlib\Hydrator\DoctrineObject`不适用于带有下划线的字段，比如`cat_id`.

这里有一个例子：

```
/* namespace Application\Entity; */

class Foo
{
    private $cat_id;
    private $cat_name;

    public function getCatId()
    {
        return $this->cat_id;
    }

    public function setCatName($name)
    {
        $this->cat_name = $name;
        return $this;
    }

    public function getCatName()
    {
        return $this->cat_nome;
    }
}

class Bar
{
    private $id;
    private $name;

    public function getId()
    {
        return $this->id;
    }

    public function setName($name)
    {
        $this->name = $name;
        return $this;
    }

    public function getName()
    {
        return $this->nome;
    }
}

/* namespace Application\Controller; */

use \DoctrineModule\Stdlib\Hydrator\DoctrineObject;
public function indexAction()
{
    $hydrator = new DoctrineObject($this->getEntityManager(), 'Application\Entity\Foo');
    $foo = $hydrator->hydrate(array('cat_name' => 'Frank Moraes'), new Foo());
    \Zend\Debug\Debug::dump($foo, 'Foo Hydrator');

    $hydrator = new DoctrineObject($this->getEntityManager(), 'Application\Entity\Bar');
    $bar = $hydrator->hydrate(array('name' => 'Frank Moraes'), new Bar());
    \Zend\Debug\Debug::dump($inscrit, 'Bar Hydrator');
} 
```

此代码返回以下内容：

```
Foo Hydrator
object(Application\Entity\Foo)
    private 'cat_id' => null
    private 'cat_name' => null

Bar Hydrator
object(Application\Entity\Foo)
    private 'id' => null
    private 'name' => 'Frank Moraes' 
```

所以我的问题是：为什么 Doctrine Hydrator 不适用于带有下划线的字段？我怎样才能使这项工作？

谢谢！

**已编辑**

抱歉很久没有回复。A 在我的工作上无权访问 SO！

我尝试了以下方法：

```
$hydrator = new DoctrineObject($this->getEntityManager(), 'Application\Entity\Foo', false); 
```

对于我在此处发布的示例，此`false`参数可以正常工作。

但是，当我在表单上绑定课程时它不起作用！

有人有线索吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-10-04T22:26:52.220

几个月后有人问过这个问题，但我刚才一直在检查`DoctrineObject`hydrator 的源代码，我认为这就是发生的事情：

默认情况下，除非您使用标志构造`DoctrineObject`水合器 as ，否则水合器将在模式下工作。这意味着它会尝试从您尝试水合的值构造 getter 和 setter 方法名称，并且它这样做的方式是调用字段名称并将 get/set 附加到该名称之前。`byValue``false``byValue``ucfirst`

因此，例如，您有`cat_name`，因此它将尝试`getCat_name`显然不正确的 getter 方法。

你有4个选择，那么：

*   **A：** `camelCase`你的变量名
*   **B：**设置`byValue`为 false （以便它尝试直接访问变量）[尽管我认为在这种情况下您可能必须公开变量......我不确定可见性将如何影响它，因为我没有之前试过]
*   **C：**使用不同的保湿剂`Strategy`或
*   **D：**只有奇怪的 getter 和 setter 名称，例如`getCat_name`（请不要这样做）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-08T14:50:02.540

你仍然可以使用这个技巧：

```
/** @ORM\Column(name="column_name", type="string") */
protected $columnName;

function get(...);
function set($columnName){$this->columnName = $columnName} 
```

希望有所帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-11T17:34:51.420

又快又脏……

```
foreach ($form as $key => $value) {
        while ($pos = strrpos($key,'_')) {                                  
            $key = substr_replace($key, '', $pos, 1);
            $capitalized = strtoupper($key[$pos]);
            $key[$pos] = $capitalized;                                
        }
        $data[$key] = $value;
    } 
```

# facebook - 像盒子高度被削减

> ID：15329873
> 
> 赞同：0
> 
> 时间：2013-03-11T01:28:53.207
> 
> 标签：facebook, height, facebook-likebox, cut

当我设置自定义高度时，为什么会切割类似框的底部？它只是切割面，它的下半部分没有显示。

我该如何解决？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:31:16.523

如果我正确理解您的更正，这将是因为您没有设置盒子内容的高度，而是设置盒子本身。

```
<div height="x"> 
```

不关心 div 中的内容，它使 div 只显示 x 数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T19:41:50.570

我遇到了同样的问题并将这些添加到我的 CSS

```
.fb-like span {
    height: auto !important;
}

.fb-like iframe {
    position: relative !important;
} 
```

# entity-framework - EntityFramework 5（模型优先）和 SQLCE：存储图像的“类型”属性是什么？

> ID：15329877
> 
> 赞同：0
> 
> 时间：2013-03-11T01:29:32.817
> 
> 标签：entity-framework, sql-server-ce

**框架：** 在一个 asp.net MVC 4 项目中，我第一次使用 EntityFramework 5 并选择使用“模型优先”，因为模型实现很容易（一旦使用创建模型就可以生成数据库模式设计师）。此外，基于项目的轻量级性质和要求，我选择使用 SQLCE 来反对 SQLExpress。

**问题：** .edmx 设计器中用于将图像保存在紧凑型 sql 数据库中的最佳属性类型选择是什么？我想我可以将图像转换为二进制（就像我在以前的 Web 表单项目中所做的那样），但是没有 varbinary(max) 的选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:44:22.030

编辑您可以将属性类型定义为“二进制”并将 SqlType 映射为“图像”

# javascript - 在 javascript 中读取 XML 属性

> ID：15329878
> 
> 赞同：1
> 
> 时间：2013-03-11T01:29:33.477
> 
> 标签：javascript, xml

猜猜这对于 javascript 大师来说是一个简单的问题，但我正在学习并且遇到了一个我无法猜测的问题。

我对使用 javascript 读取 XML 文件很感兴趣。以下是 XML 文件的示例：

```
<object name='obj1'>
   <attribute name='att1' value='val1'/>
   <attribute name='att2' value='val2'/>
   <attribute name='attN' value='valN'/>
   <subobject name='sub1'>
          <attribute name='satt1' value='sval1'/>
          <attribute name='satt2' value='sval2'/>
          <attribute name='sattN' value='svalN'/>
   </subobject>
   <subobject name='subn'>
          <attribute name='snatt1' value='snval1'/>
          <attribute name='snatt2' value='snval2'/>
          <attribute name='snattN' value='snvalN'/>
   </subobject>
</object> 
```

如您所见，我有 N 个对象。每个对象都有全局属性，并且可能有 0...M 个子对象及其属性。

问题是，应用这个（我的）代码来解析**ob1**属性，我还得到了所有子对象属性：

```
if (window.XMLHttpRequest) {    
    var xmlhttp=new XMLHttpRequest();
    xmlhttp.open("GET",URL,false);  
    xmlhttp.send();

    var xmlDoc=xmlhttp.responseXML;

    var objList = xmlDoc.getElementsByTagName("object");
    var attrList = objList[0].getElementsByTagName("attribute"); // Got ALL attributes here
} 
```

在该代码中（为简单起见，没有错误测试），我的 attrList 对象同时获取 obj1 和所有子对象属性。

如何重写代码以仅获取 att1...attN?!?!

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:38:33.547

在这种情况下，由于`attribute`您要查找的元素是该元素的直接子`object`元素，您可以做的一件简单的事情是手动遍历该元素的子元素`object`：

```
var obj = objList[0]
var childNodes = obj.childNodes
for(var i=0; i<childNodes.length; i++){
    var child = childNodes[i];
    if(child.nodeType == 1 && child.nodeName == 'attribute'){
        do_something(child);
    }
} 
```

有关这些和其他 DOM 方法的信息，我建议您查看[MDN](https://developer.mozilla.org/en-US/docs/DOM/element)上的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T01:40:58.567

您遇到的问题是子对象的技术“属性”也是对象的子对象。请记住，任何元素都是 Node 对象，并且在该 Node 上您可以获得所有 childNode。您可以这样做并处理每个“元素”节点并确定它是否是“属性”节点。

有关这方面的更多信息，请参见[http://www.w3schools.com/jsref/dom_obj_node.asp](http://www.w3schools.com/jsref/dom_obj_node.asp)。

# java - 为什么 GraphicsEnvironment 的 getAllFonts() 返回的字体与 fc-list 不同？

> ID：15329880
> 
> 赞同：2
> 
> 时间：2013-03-11T01:29:41.227
> 
> 标签：java, linux, fonts

为什么 GraphicsEnvironment 的 getAllFonts() 方法返回的字体与 fc-list 不同（在 linux 上？）

fc-list 返回：

```
Abyssinica SIL:style=Regular
Cantarell:style=Bold
Cantarell:style=Regular
Century Schoolbook L:style=Bold
Century Schoolbook L:style=Bold Italic
Century Schoolbook L:style=Italic
Century Schoolbook L:style=Roman
Courier:style=Regular
DejaVu Sans,DejaVu Sans Condensed:style=Condensed Bold,Bold
DejaVu Sans,DejaVu Sans Condensed:style=Condensed Bold Oblique,Bold Oblique
DejaVu Sans,DejaVu Sans Condensed:style=Condensed,Book
DejaVu Sans,DejaVu Sans Condensed:style=Condensed Oblique,Oblique
DejaVu Sans,DejaVu Sans Light:style=ExtraLight
DejaVu Sans Mono:style=Bold
DejaVu Sans Mono:style=Bold Oblique
DejaVu Sans Mono:style=Book
DejaVu Sans Mono:style=Oblique
DejaVu Sans:style=Bold
DejaVu Sans:style=Bold Oblique
DejaVu Sans:style=Book
DejaVu Sans:style=Oblique
DejaVu Serif,DejaVu Serif Condensed:style=Condensed Bold,Bold
DejaVu Serif,DejaVu Serif Condensed:style=Condensed Bold Italic,Bold Italic
DejaVu Serif,DejaVu Serif Condensed:style=Condensed,Book
DejaVu Serif,DejaVu Serif Condensed:style=Condensed Italic,Italic
DejaVu Serif:style=Bold
DejaVu Serif:style=Bold Italic
DejaVu Serif:style=Book
DejaVu Serif:style=Italic
Dingbats:style=Regular
... 
```

然而

GraphicsEnvironment 中的 getAllFonts 返回：

```
AbyssinicaSIL
CenturySchL-Bold
CenturySchL-BoldItal
CenturySchL-Ital
CenturySchL-Roma
DejaVuSans
DejaVuSans-Bold
DejaVuSans-BoldOblique
DejaVuSansCondensed
DejaVuSansCondensed-Bold
DejaVuSansCondensed-BoldOblique
DejaVuSansCondensed-Oblique
DejaVuSans-ExtraLight
DejaVuSansMono
DejaVuSansMono-Bold
DejaVuSansMono-BoldOblique
DejaVuSansMono-Oblique
DejaVuSans-Oblique
DejaVuSerif
DejaVuSerif-Bold
DejaVuSerif-BoldItalic
DejaVuSerifCondensed
DejaVuSerifCondensed-Bold
DejaVuSerifCondensed-BoldItalic
DejaVuSerifCondensed-Italic
DejaVuSerif-Italic
Dialog.bold
Dialog.bolditalic
Dialog.italic
Dialog.plain
DialogInput.bold
DialogInput.bolditalic
DialogInput.italic
DialogInput.plain
Dingbats
... 
```

比较这两个不同的列表，示教列表具有彼此不可用的字体。

谁能解释发生了什么？

* * *

进一步说明：

我首先提出这个问题的原因是，我试图找出一些 UI 问题，即在一个操作系统（例如 Solaris）上定义的字体与在另一个操作系统（例如 Linux）上定义的字体不同。

我认为问题在于，虽然两个操作系统具有相同的逻辑字体（对话框），但它们不一定具有相同的物理字体。

但是如果你制作这样的字体：

```
Font STANDARD_FONT = new Font("Dialog", 0, 12); 
```

不能保证在任何地方都相同。

我希望我可以查看两个系统上可用的字体，看看哪些是通过 fc-list 可用的，但是 java (Dialog.plain) 报告的字体不是 fc-list 列出的字体。

因此，如果我通过 new Font("Dialog", 0, 12) 定义逻辑字体，则通过 java 可用的 API（例如 font.getName() 等）显示：

postscript - Dialog.plain 系列 - 对话框名称 - Dialog fontName - Dialog.plain 大小 - 12

我怎样才能准确地知道 java 选择用于 Dialog Family 的物理字体？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T02:26:53.087

专门出现的字体系列`getAllFonts()`不是物理字体，这意味着它们不是您计算机上的字体文件，因此`fc-list`不会找到它们。它们是每个 Java 实现中常见的字体系列，并映射到物理字体。

> 逻辑字体是 Java 平台定义的五个字体系列，任何 Java 运行时环境都必须支持：Serif、SansSerif、Monospaced、Dialog 和 DialogInput。这些逻辑字体不是实际的字体库。相反，逻辑字体名称由 Java 运行时环境映射到物理字体。

至于 专有的字体系列`fc-list`，它们很可能是您系统上的物理字体，您正在运行的 Java 实现不支持这些字体。Java 实现需要支持的唯一字体类型是 TrueType；专有的字体`fc-list`可能不是 TrueType。

> Java 平台的所有实现都必须支持 TrueType 字体；对其他字体技术的支持取决于实现。

来源：[Java 的`Font`API 文档](http://docs.oracle.com/javase/6/docs/api/java/awt/Font.html)。

# jquery - jquery与页面中的其他jquery冲突

> ID：15329885
> 
> 赞同：-1
> 
> 时间：2013-03-11T01:30:20.627
> 
> 标签：jquery

我遇到了一些 jquery 与其他 jquery 冲突的问题......你能告诉我我是否编码正确。

```
<script type="text/javascript">
jQuery(function(){
    var $mov=$(document);
      $mov.ready(function(){
    (".movie").mb_YTPlayer();
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:34:30.180

你可以试试这个：

```
//Relinquish jQuery's control of the "$" variable.
$.noConflict();
jQuery(document).ready(function($) {
  // Code that uses jQuery's $ can follow here.
  $(".movie").mb_YTPlayer();
}); 
```

使用[$.noConflict](http://api.jquery.com/jQuery.noConflict/)将允许您使用多个 jQuery 实例或避免使用`$`.

看起来您只是想包装`.mb_YTPlayer()`一个准备好的文档。你也失踪`$`了`(".movie")`。

我不确定你想用什么来完成`var $mov=$(document);`......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T01:43:14.727

jQuery 函数返回一个对象，因此您的代码是有效的。您可以在变量范围内对变量调用 jQuery 函数。

但我不知道你所说的“一些 jQuery 与其他 jQuery 冲突”是什么意思

# html - Html5媒体捕获限制视频长度？

> ID：15329886
> 
> 赞同：4
> 
> 时间：2013-03-11T01:30:34.997
> 
> 标签：html

我正在使用新的 Html5 媒体捕获 api 在 iphone 上捕获视频。我要求将视频录制限制为特定长度，例如 6 秒。

我正在使用的 html 是：

```
<input id="fileupload" type="file" name="fileupload" accept="video/*" capture="camera"> 
```

是否可以使用 Html5 限制录制的长度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-30T15:43:02.340

这是不可能的（还）。

最新的[HTML 媒体捕获](https://w3c.github.io/html-media-capture/)（2016 年 7 月 5 日）草案没有提及HTML 元素的任何*限制*类型的属性。`input`

我已经汇总了[所有 HTML 媒体捕获草稿的列表](https://addpipe.com/blog/correct-syntax-html-media-capture/)。

# jquery - 如何使用 jQuery 在图像上创建链接

> ID：15329888
> 
> 赞同：0
> 
> 时间：2013-03-11T01:31:13.833
> 
> 标签：jquery, html, hyperlink

我想在按钮单击时在图像上创建一个链接。到目前为止我所拥有的是，当我点击图像时，我得到了正确的坐标..但是我怎样才能在鼠标点击的位置上创建一个链接？有可能做到吗？

这是我到目前为止所拥有的：

```
$('.ImgMapa').click(function(e) {
captureMousePosition(e);
var offset = $(this).offset();
var left = xMousePos;
var top = yMousePos;
}); 
```

函数 captureMousePosition 为我返回 X 和 Y 位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T00:53:14.810

我最终为我的情况做了一些更好的事情。因为我想在另一个上动态创建图像，所以我使用了 jQuery 的 append() 函数。这是我所做的：

创建了一个 img 标签：

```
var img = $('<img src="http://3.bp.blogspot.com/-BDsYRXImsOQ/T-czORDNXZI/AAAAAAAABz4/qjWlHzzEBsA/s1600/1606gdg.png"/>'); 
```

根据鼠标点击位置设置它的css：

```
img.css('cssText', 'top: ' + (top-10) + 'px;' + 'left: ' + (left-10) + 'px; position: absolute; width: 22px; height: 22px'); 
```

最后将其附加到图像父级：

```
$(this).parent().append(icone); 
```

$(this) 是我的图像参考。

注 1：我的图像在里面和 div，这就是我使用 parent() 函数的原因。注意 2：所有这些代码都在我的图像点击事件中。

例子：

```
$('.Img').click(function(e) {

} 
```

希望能帮助到你！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T01:37:33.433

```
$('.image').click(function(e){
e.preventDefault();
window.location="http://google.com";
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T01:38:59.647

我认为您可以尝试`<map>`通过单击的图像动态创建。链接：[http ://www.w3schools.com/tags/tag_map.asp](http://www.w3schools.com/tags/tag_map.asp)

# java - 无法实现 KeyBinding

> ID：15329892
> 
> 赞同：-1
> 
> 时间：2013-03-11T01:31:38.100
> 
> 标签：java, swing, key-bindings

我试图使用 KeyBinding 移动矩形，但我想我无法正确实现它。我是java的初学者，我在这个程序中找不到错误所以请帮帮我。

提前谢谢！！

```
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.AbstractAction;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.KeyStroke;
import javax.swing.SwingUtilities;
import javax.swing.Timer;

class Move {

    public static void main(String args[]) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                abc();
            }
        });
    }

    private static void abc() {
        JFrame frame = new JFrame("moving object");
        frame.setVisible(true);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(1300, 600);
        frame.add(new P1());
    }
}

class P1 extends JPanel {

    int a, b;
    int x, y;
    Timer t = new Timer(10, new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent e) {//the coordinates of this rectangle 
            a += x;                                 //are mordified in every 10 millisec 
            b += y;                                 //x and y changes the direction of the moving
            repaint();                              //rect. 
        }
    });

    P1() {
        this.getInputMap().put(KeyStroke.getKeyStroke("VK_UP"), "doNothing1");
        this.getActionMap().put("doNothing1", new AbstractAction() {
            @Override
            public void actionPerformed(ActionEvent e) {
                x = 0;
                y = -1;
            }
        });
        this.getInputMap().put(KeyStroke.getKeyStroke("VK_LEFT"), "doNothing2");
        this.getActionMap().put("doNothing2", new AbstractAction() {
            @Override
            public void actionPerformed(ActionEvent e) {
                x = -1;
                y = 0;
            }
        });
        this.getInputMap().put(KeyStroke.getKeyStroke("VK_DOWN"), "doNothing3");
        this.getActionMap().put("doNothing3", new AbstractAction() {
            @Override
            public void actionPerformed(ActionEvent e) {
                x = 0;
                y = 1;
            }
        });
        this.getInputMap().put(KeyStroke.getKeyStroke("VK_RIGHT"), "doNothing4");
        this.getActionMap().put("doNothing4", new AbstractAction() {
            @Override
            public void actionPerformed(ActionEvent e) {
                x = -1;
                y = 0;
            }
        });
        t.start();
        setFocusable(true);
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.fillRect(a, b, 10, 10);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T01:51:31.020

您使用了错误的 InputMap，这是造成问题的主要原因之一。当您未指定条件时获得的默认 InputMap 使用 WHEN_FOCUSED 条件，并且由于 JPanel 默认情况下不允许焦点（并且实际上不应该强制获得焦点），因此这不起作用。相反，您将希望使用具有 WHEN_IN_FOCUSED_WINDOW 条件的那个。为此，您必须明确指定这一点。IE：

```
InputMap inputMap = getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW); // note condition
inputMap.put(KeyStroke.getKeyStroke("VK_UP"), "doNothing1");
// .... 
```

即使绑定的组件没有焦点，只要它保存在具有焦点的顶级 Window 中，这也将起作用。

# c# - 如何在 Unity3d 备用脚本中引用枚举？

> ID：15329894
> 
> 赞同：0
> 
> 时间：2013-03-11T01:31:55.183
> 
> 标签：c#, android, unity3d, swipe

我有一个名为 TouchDetector.cs 的 C# 脚本，它看起来完全像这样：

```
using UnityEngine;
using System.Collections;

public class TouchDetector : MonoBehaviour
{
  public delegate void deTouchEvent (enTouchType touchType);

  public static event deTouchEvent evTouchEvent;

  public enum enTouchType
  {
    SwipeLeft,
    SwipeRight,
    SwipeDown,
    SwipeUp,
  }   

  void Start ()
  {   
  }   

  void Update ()
  {   
    if (evTouchEvent == null)
        return;

    if (Input.GetKeyDown(KeyCode.UpArrow   )) evTouchEvent(enTouchType.SwipeUp   );
    if (Input.GetKeyDown(KeyCode.DownArrow )) evTouchEvent(enTouchType.SwipeDown );
    if (Input.GetKeyDown(KeyCode.LeftArrow )) evTouchEvent(enTouchType.SwipeLeft );
    if (Input.GetKeyDown(KeyCode.RightArrow)) evTouchEvent(enTouchType.SwipeRight);

    if (Input.touchCount > 0)
    {
        foreach (Touch t in Input.touches)
        {
            Vector3 swipe = t.deltaPosition * t.deltaTime;

            if (swipe.y >  0.5f) evTouchEvent(enTouchType.SwipeUp   );
            if (swipe.y < -0.5f) evTouchEvent(enTouchType.SwipeDown );
            if (swipe.x >  0.5f) evTouchEvent(enTouchType.SwipeRight);
            if (swipe.x < -0.5f) evTouchEvent(enTouchType.SwipeLeft );
        }
    }
}
} 
```

我正在尝试将以下键码调用替换为上面相应的滑动调用。我对编程有点陌生，并试图在这里自学。我已经设法让滑动脚本正常工作，但是如果有意义的话，我已经用尽了所有方法来将它作为我的控制器。感谢您给我的任何帮助或建议。我试过以下。

```
if(SwipeLeft)
{
  //Do something here
} 
```

然而，这对我不起作用。我似乎无法在我的其他控制脚本中引用控制类型。这是我试图替换的 Control.cs 脚本中的脚本：

```
if (Input.GetKeyDown(KeyCode.LeftArrow) && m_playerJump <= -1.0f && m_playerSlide <=0.0f)
{
  if (m_playerDirection == enCellDir.North) m_playerNextDirection = enCellDir.West;
  if (m_playerDirection == enCellDir.East ) m_playerNextDirection = enCellDir.North;
  if (m_playerDirection == enCellDir.South) m_playerNextDirection = enCellDir.East;
  if (m_playerDirection == enCellDir.West ) m_playerNextDirection = enCellDir.South;
} 
```

而不是 Input.GetKeyDown，我希望它说 SwipeLeft 或者我需要对其进行编码。请帮忙。我变得非常沮丧。我查看了枚举，但不太明白我在读什么或如何引用它们。我假设，从我读过的内容来看，枚举就像 java 中的 int。但如果是这样的话，我怎么称呼那些？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T10:49:06.113

> enum 关键字用于声明一个枚举，一种由一组称为枚举数列表的命名常量组成的独特类型。每个枚举类型都有一个底层类型，它可以是除 char 之外的任何整数类型。枚举元素的默认基础类型是 int。默认情况下，第一个枚举器的值为 0，并且每个后续枚举器的值都增加 1。

这基本上意味着您可以拥有一个事物列表，并且可以根据它们在列表中的位置来调用这些事物。例如：

```
enum Days {Sat, Sun, Mon, Tue, Wed, Thu, Fri}; 
```

在此枚举中，Sat 为 0，Sun 为 1，Mon 为 2，以此类推。可以为类型变量`Days`分配基础类型范围内的任何值；这些值不限于命名常量。

```
// keyword_enum.cs
// enum initialization:
using System;
public class EnumTest 
{
    enum Days {Sat, Sun, Mon, Tue, Wed, Thu, Fri};

    static void Main() 
    {
        int x = (int)Days.Sun;
        int y = (int)Days.Fri;
        Console.WriteLine("Sun = {0}", x);
        Console.WriteLine("Fri = {0}", y);
    }
} 
```

给出输出：

```
Sun = 1
Fri = 6 
```

由于您拥有公开的，您可以`enum`在`TouchDetector.cs`引用此类的其他类中使用它。调用它们通常是通过`Switch`- 语句完成的。

例如：

```
public enum Color
{
    Red,
    Blue,
    Green
}

class Program
{
    static void Main(string[] args)
    {
        Color color = Color.Red;

        switch (color)
        {
            case Color.Red:
                break;

            case Color.Blue:
                break;

            case Color.Green:
                break;
        }
    }
} 
```

使用`case`您可以声明调用此类内容时要执行的操作。您可以在那里插入一个方法，而不是破坏，例如：`doSomethingWithRed()`.

在您的情况下，您可能会这样说：

```
var movingLeft = false;

case enTouchType.SwipeLeft:
    movingLeft = true; 
```

在您尝试更改的脚本中，尝试：

```
if (movingLeft && m_playerJump <= -1.0f && m_playerSlide <=0.0f)
{
  if (m_playerDirection == enCellDir.North) m_playerNextDirection = enCellDir.West;
  if (m_playerDirection == enCellDir.East ) m_playerNextDirection = enCellDir.North;
  if (m_playerDirection == enCellDir.South) m_playerNextDirection = enCellDir.East;
  if (m_playerDirection == enCellDir.West ) m_playerNextDirection = enCellDir.South;
  //movingLeft = false; ?
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T01:35:48.443

类（Example.cs）：

```
public enum enTouchType{ one, two};
public class Example {
    public enum enTouchType { one, two };
} 
```

用法（SomeOther.cs）：

```
void Foo(){
    enTouchType outer = enTouchType.one;
    Example.enTouchType inner = Example.enTouchType.one;

    switch(outer){
        case enTouchType.one:
            Console.WriteLine("outer.one");
            break;
    }
    switch(inner){
        case  Example.enTouchType.one:
            Console.WriteLine("inner.one");
            break;        
    }
} 
```

[**稍微澄清更新**]

枚举只是一种数据类型，所以：

```
//(1) This won't work:
void evTouchEventExample(TouchDetector.enTouchType tt){
    if(SwipeLeft){}
}
//(2) Do something like:
void evTouchEventExample(TouchDetector.enTouchType tt){
    if(tt==TouchDetector.enTouchType.SwipeLeft){}
    //or use a switch statement, whatever.
} 
```

我在第一个示例中要指出的是，要在另一个类中使用嵌套枚举类型，您需要包含类名 TouchDetector.enTouchType。evTouchEvent 的委托引用方法应类似于 (2)。

完整示例：

```
public class EnumTest : MonoBehaviour {
public delegate void deTouchEvent (enTouchType t);
public static event deTouchEvent  evTouchEvent;
public enum enTouchType { SwipeLeft, SwipeRight }

void Start () {
            // setup and do evt
    evTouchEvent += DummyTest.DummyDel;
    evTouchEvent(enTouchType.SwipeLeft);    
}
}
public class DummyTest {
public static void DummyDel(EnumTest.enTouchType t){
    if(t==EnumTest.enTouchType.SwipeLeft){
        Debug.Log("swipey_left");
    }
    else if(t==EnumTest.enTouchType.SwipeRight){
        Debug.Log("swipey_right");
    }
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-15T07:58:46.157

枚举允许您创建相关常量的集合。枚举是一种数据类型。它们可以在类内部或外部创建。如果只有该类需要访问它，我们将在该类中创建一个枚举。如果其他类也需要访问它，我们会在一个类之外创建它。

在这个链接上非常简洁地解释了它： [https ://unity3d.com/learn/tutorials/topics/scripting/enumerations?playlist=17117](https://unity3d.com/learn/tutorials/topics/scripting/enumerations?playlist=17117)

您只需要将您的枚举声明移到您的班级之外。现在它在你的类里面，所以只有那个类可以访问它。

# java - 简单的二维数组java游戏

> ID：15329900
> 
> 赞同：0
> 
> 时间：2013-03-11T01:32:35.220
> 
> 标签：java, arrays, 2d

我正在尝试用 Java 编写一个简单的游戏，它使用 2d 数组创建一个点网格，供用户继续前进。我已经这样做了，我已经到了要求用户选择他们的动作的地步，但是，在那之后，我想重新打印网格，而他们的旧空间是空的，并且在他们搬到的空间。我不确定如何重新打印网格，因为当我第一次打印它时，我使用了 if 语句来告诉循环不要在哪里放置点。我将在下面发布代码，非常感谢提示！

```
import java.util.Scanner;
import java.util.Random;
public class main {

/**
 * @param args
 */
public static void main(String[] args) {
    // TODO Auto-generated method stub

    char[][] gridArray = new char[10][10];
    int randomRow;
    int randomCol;
    int randomRow2;
    int randomCol2;
    String moveSelect;
    boolean validInput = true;

    int min = 0;
    int max = 9;

    Random tRNG = new Random();
    randomRow = tRNG.nextInt(max - min + 1) + min;
    randomCol = tRNG.nextInt(max - min + 1) + min;
    randomRow2 = tRNG.nextInt(max - min + 1) + min;
    randomCol2 = tRNG.nextInt(max - min + 1) + min;

    gridArray[randomRow][randomCol] = 'o';
    gridArray[randomRow2][randomCol2] = 'X';

    for (int i = 0; i < gridArray.length; i++)
    {
        for (int j = 0; j < gridArray.length; j++)
        {       
            if (gridArray[i][j] != gridArray[randomRow][randomCol] && gridArray[i][j] != gridArray[randomRow2][randomCol2])
            {
                gridArray[i][j] = '.';
            }
            System.out.print(gridArray[i][j]);
        }
        System.out.println("");  
    }

    System.out.println("Enter a movement choice W A S or D");
    do{

        Scanner keyboard = new Scanner(System.in);
        moveSelect = keyboard.nextLine();

        if ( moveSelect.equals("w"))
        {
            gridArray[randomRow][randomCol] = gridArray[randomRow+1][randomCol];
            gridArray[randomRow][randomCol] = ' ';
            validInput = true;      
        }

        else if ( moveSelect.equals("a"))
        {
            gridArray[randomRow][randomCol] = gridArray[randomRow][randomCol-1];
            gridArray[randomRow][randomCol] = ' ';
            validInput = true;
        }

        else if ( moveSelect.equals("s"))
        {
            gridArray[randomRow][randomCol] = gridArray[randomRow-1][randomCol];
            gridArray[randomRow][randomCol] = ' ';
            validInput = true;
        }

        else if (moveSelect.equals("d"))
        {
            gridArray[randomRow][randomCol] = gridArray[randomRow][randomCol+1];
            gridArray[randomRow][randomCol] = ' ';
            validInput = true;
        }

        else
        {
            System.out.println("Invalid Entry. Try again.");
            validInput = false;
        }

    } while (validInput == false);
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T02:39:57.640

我认为大多数问题来自对数组的普遍混淆。例如，当您按下 w 时，代码块中的行会运行：

```
gridArray[randomRow][randomCol] = gridArray[randomRow+1][randomCol]; 
```

将 randomRow, randomCol 处的数组的 char 值（在本例中为“x”）设置为其下一行 randomRow+1,randomCol 处的数组空间的 char 值。然后是之后的代码行：

```
gridArray[randomRow][randomCol] = ' '; 
```

为同一空间分配一个新值，使上面的代码毫无价值！最后，randomRow 和 randomCol 永远不会被修改。（您也对 x 以更高的行值移动的方式有些困惑）

在此代码块中您实际需要做的就是：

```
randomRow -= 1; 
```

在此之后，您可以使用之前的打印代码简单地重新打印整个网格。尽管此代码还存在其他问题，使其远非最佳。还有一个类似的问题，即 for 循环中的 if 语句有效，但后来导致了问题。只需重写它以修复所有错误，您会得到：

```
char[][] gridArray = new char[10][10];
int randomRow;
int randomCol;
int randomRow2;
int randomCol2;
String moveSelect;
boolean validInput = true;

int min = 0;
int max = 9;

Random tRNG = new Random();
randomRow = tRNG.nextInt(max - min + 1) + min;
randomCol = tRNG.nextInt(max - min + 1) + min;
randomRow2 = tRNG.nextInt(max - min + 1) + min;
randomCol2 = tRNG.nextInt(max - min + 1) + min;

gridArray[randomRow][randomCol] = 'o';
gridArray[randomRow2][randomCol2] = 'X';

for (int i = 0; i < gridArray.length; i++)
{
    for (int j = 0; j < gridArray.length; j++)
    {       
        if (!((i == randomRow && j == randomCol) || (i == randomRow2 &&  j == randomCol2)))
        {
            gridArray[i][j] = '.';
        }
        System.out.print(gridArray[i][j]);
    }
    System.out.println("");  
}

System.out.println("Enter a movement choice W A S or D");
do{

    Scanner keyboard = new Scanner(System.in);
    moveSelect = keyboard.nextLine();

    if ( moveSelect.equals("w"))
    {
        randomRow -= 1;
        validInput = true;      
    }

    else if ( moveSelect.equals("a"))
    {
        randomCol -= 1;
        validInput = true;
    }

    else if ( moveSelect.equals("s"))
    {
        randomRow += 1;
        validInput = true;
    }

    else if (moveSelect.equals("d"))
    {
        randomCol -= 1;
        validInput = true;
    }

    else
    {
        System.out.println("Invalid Entry. Try again.");
        validInput = false;
    }

} while (validInput == false);
gridArray[randomRow][randomCol] = 'o';
gridArray[randomRow2][randomCol2] = 'X';

for (int i = 0; i < gridArray.length; i++)
{
    for (int j = 0; j < gridArray.length; j++)
    {       
        if (!((i == randomRow && j == randomCol) || (i == randomRow2 &&  j == randomCol2)))
        {
            gridArray[i][j] = '.';
        }
        System.out.print(gridArray[i][j]);
    }
    System.out.println("");  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T02:09:32.920

如果validInput==true，则制作一个打印网格的方法

```
public static void printGrid(char[][]gridArray){
    for (int i = 0; i < gridArray.length; i++)
    {
        for (int j = 0; j < gridArray.length; j++)
        {       
            System.out.print(gridArray[i][j]);
        }
        System.out.println("");  
    }
} 
```

我将您的 gridArray[randomRow][randomCol] 从 =' ' 修改为 ='。因为你希望它是一个点，对吗？（如果你真的希望它是一个空间，就让它保持原样）为了验证，将每个方向更改为：

```
if ( moveSelect.equals("w")&&randomRow!=0)
        {
            gridArray[randomRow][randomCol] = gridArray[randomRow-1][randomCol];
            gridArray[randomRow][randomCol] = '.';
            validInput = true;      
        } 
```

在做的最后，

```
if(validInput) printGrid(gridArray); 
```

# php - 无法使用 php 和 mysql 显示图像

> ID：15329902
> 
> 赞同：0
> 
> 时间：2013-03-11T01:32:50.777
> 
> 标签：php, mysql, image

我必须说我是一个真正的初学者，所以请记住这一点。我目前正在这里的本地服务器上工作，我的问题是我正在尝试将图片添加到我的 php 代码中，并且不知道问题是来自 mysql 还是来自实际代码。

在 mysql 中，它是 200 的 varchar，它被命名为： products_image

我的代码如下所示：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Releases</title>
    </head>

    <body>
    <?php
    require 'database_connection.php';

    $select_query = "SELECT * FROM releases";

    $result = mysql_query($select_query);

    if ($result) {
        $row = mysql_fetch_array($result);
        $products_name = $row['products_name'];
        $products_title = $row['products_title'];
        $products_description = $row['products_description'];
        $products_image = $row['products_image'];

    } else {
        die("Error locating user with ID {$user_id}");
    }
    echo"{$products_name} {$products_title} {$products_description} ";
    echo "<img src=\"$products_image.\">";  
    ?>
    </body>
    </html> 
```

当我查看我的源代码时，它会向我展示图像部分：

```
<img src="C:\wamp\www\chaosruralenew\images\kalsahnikovdreams.jpg."> 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T01:35:52.433

看起来你有一个错误的时期：

```
echo "<img src=\"$products_image.\">";
                                ^ 
```

关于您的代码的其他一些注释：

*   您是否还打算使用循环来遍历您的结果？
*   `mysql_`功能已被弃用。了解[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](http://j.mp/QEx8IB)将帮助您决定使用哪一个。
*   在函数之后使用错误处理程序是明智`mysql_error`的。
*   根据您的 HTML 类型，`<img>`可能需要尾部斜杠`<img ... />`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T01:38:17.400

您正在使用服务器文件系统的本地路径。

您应该保存相对于您的网站机器人的路径。

```
chaosruralenew/images/kalsahnikovdreams.jpg 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T02:35:15.513

最好在`html`代码外使用标签`PHP`，顺便试试这个希望能用

```
<img src="images/<?php echo $row['products_image']; ?>"/> 
```

将图像名称与图像的`.jpg`任何其他有效扩展名一起保存在数据库中，然后检索它并显示图像。

在这种情况下，您不需要处理图像的路径。我试过这个，它对我很有效。

# marionette - 有没有办法将两种情况分开来渲染emptyView？

> ID：15329903
> 
> 赞同：3
> 
> 时间：2013-03-11T01:33:11.427
> 
> 标签：marionette

有没有办法将两种情况分开来渲染emptyView？
1、CollectionView刚创建的时候。集合仍然是空的
2\. 获取集合后但数据为空。

```
_CollectionView = Backbone.Marionette.CollectionView.extend({
    emptyView: _EmptyView,
    itemView: _ItemView,
    initialize: function () {
        this.collection =  new Backbone.Collection ();
        this.collection.fetch();
    },//initialize

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T03:15:04.400

这就是我过去的做法。将您的“emptyView”设置为您的加载视图，然后在集合同步后，将“emptyView”设置为您的实际 EmptyView（如果需要）。我还在“onBeforeRender”中使用了它，如下例所示，如果已经使用“EmptyView”渲染了视图，则可能需要重新渲染视图：

```
emptyView: LoadingView,
collectionEvents: {
    'sync': 'onSync'
},
onSync: function () {
    if(this.collection.length === 0) {
        this.emptyView = EmptyView;
        //may need to call 'this.render();' here if already rendered
    }
} 
```

# c - struct中的char []和char *有什么区别？

> ID：15329907
> 
> 赞同：4
> 
> 时间：2013-03-11T01:33:46.973
> 
> 标签：c

有一个这样的结构：

```
struct sdshdr {
    int len;
    int free;
    char buf[];
}; 
```

结果`printf ("%d\n", sizeof(struct sdshdr));`是 8。如果我改成`char buf[]`，`char *`结果是 16。为什么`char buf[]`这里不占空间（是 4）？我应该什么时候`sizeof(int)`选择呢？`char buf[]``char *buf`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T01:38:58.573

带有空括号的构造`[]`允许作为`struct`. 它允许您为数组元素分配额外`sizeof(sdshdr)`的空间，让您将数组数据与数组本身一起嵌入。

另一方面，指针将数据存储在单独管理的内存段中，`free`最后需要额外调用。与这种`[]`方式不同，指针让您在同一个 . 中拥有多个可变长度数组`struct`，并且元素可以放置`struct`在`struct`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T01:42:34.650

`char[]`更一般地取“ ”：

`char[]`实际上会在结构内分配一些字符。（具有 的结构`char x[17]`将增长 17 个字节，依此类推。） A`char*`将只保存一个指针。

`char x[]`结构末尾的实际（未指定大小 - 我认为大小为 0 也是如此）是一种称为“灵活数组成员”的特殊情况，并在链接问题和其他答案中进行了讨论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T01:46:25.070

还要记住，这`sizeof`需要在编译时确定。由于`char buf[]`是一个灵活的数组成员，它的大小在编译时无法知道，因此在计算`sizeof`.

`char *`是一个指向 char 变量的指针，它的大小是已知的，因此被包括在内（但是这是指针的大小而不是它指向的数组）。

# java - Java将字符串中的两个整数拆分为双精度（转换时间）

> ID：15329908
> 
> 赞同：0
> 
> 时间：2013-03-11T01:33:53.120
> 
> 标签：java, string, time

我对 Java 入门类的部分作业是花时间作为字符串输入，并将其转换（同时舍入到最接近的一刻钟）为双精度，并将其存储在一个数组中。我遇到困难的部分是如何处理从 String 类的 split 方法收到的两个整数。如何将两个整数变成一个双精度以在数组中使用？（所以它就像 hours.minutes 或 5.25）这是我正在处理的程序中的一段代码：

```
 public static double convertClockOutTimes(String clockOut){
    double convertedTimeOut = 0;
    String time = clockOut;
    int hours;
    int minutes;
    String[]splitFields;
    splitFields = time.split(":");
    hours = Integer.parseInt(splitFields[0]);
    minutes = Integer.parseInt(splitFields[1]);
    if (minutes <= 7)
    {
        minutes = 0;
    }
    else if (minutes >= 8 || minutes <= 22)
    {
        minutes = 15;
    }
    else if (minutes >= 23 || minutes <= 37)
    {
        minutes = 30;
    }
    else if (minutes >= 31 || minutes <= 53)
    {
        minutes = 45;
    }
    else
    minutes = 0;
    hours = hours + 1;

    convertedTimeOut = //This is where I don't know what to do!!

   return convertedTimeOut;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:51:20.077

我认为诀窍是在这里使用一些数学。您始终可以执行以下操作：

```
double convertedTimeOut = Math.round(minutes / 15.0) * 0.25 + hours; 
```

那么你不需要 if-else 树来计算最近的一刻钟。

一刻钟有 15 分钟，一刻钟等于 0.25 小时。使用上面的公式，您将分钟除以您有多少刻钟（0-4），然后乘以刻钟的小时数。然后将其添加到您拥有的时间中。

`Math.round`只是为你做四舍五入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T01:44:56.233

我猜最让你烦恼的是如何处理会议记录。尝试这个：

```
double minutesAsDecimal = 0.01 * minutes; 
```

所以如果分钟数是 24，你最终会得到 0.24。我打赌你会知道从那里去哪里。

顺便说一句，你的 if 和 else if 并没有像你想象的那样做。但既然是家庭作业..只要仔细看看你的逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T01:53:33.163

您的条件应该是 AND 而不是 OR：

```
if(minutes >= 8 && minutes <= 22) 
```

等等，或者更好的是，一个单一的陈述，简单地

```
minutes = ((minutes + 7) % 15) * 15; 
```

它使用算术而不是逻辑计算舍入。

# css - 我应该使用 span 标签还是 i 标签作为图标？

> ID：15329909
> 
> 赞同：8
> 
> 时间：2013-03-11T01:34:13.303
> 
> 标签：css, tags, icons, html

我只是好奇哪个更好用，以便在我的链接旁边添加一个自定义图标。

```
<ul>
    <li><a href=""><i class="home"></i> Home</a></li>
    <li><a href=""><i class="downloads"></i> Downloads</a></li>
</ul> 
```

或者

```
<ul>
    <li><a href=""><span class="home"></span> Home</a></li>
    <li><a href=""><span class="downloads"></span> Downloads</a></li>
</ul> 
```

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-11T01:36:30.637

`<i>`不是图标标签，它是斜体标签，你选择哪个没有太大区别。`<span>`在语义上更正确，因为它没有语义。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-11T01:37:32.200

**从 HTML5 规范：**

> I 元素代表一段文本以另一种声音或语气，或以其他方式偏离正常散文，例如分类名称、技术术语、来自另一种语言的惯用短语、思想、船名或其他一些散文，其典型的印刷表示是斜体。

如果您想在“政治上”正确，请使用 span 标签。

然而，Holly 的回答为它的使用提出了一个论据：[我应该使用 <i> 标记而不是 <span> 来表示图标吗？](https://stackoverflow.com/questions/11135261/i-tag-for-icons)

# c++ - 试图在 main.cpp 中包含一个头文件，但是 VS2010 给了我错误

> ID：15329910
> 
> 赞同：-3
> 
> 时间：2013-03-11T01:34:18.300
> 
> 标签：c++, visual-studio-2010, header-files

我试图在我的主 cpp 中使用一个简单的头文件，但我的编译器不断产生错误。如果我想在头文件中的代码在头文件中，则会产生错误；如果头文件中没有代码，而我想在头文件中的代码在主cpp中，编译器不会产生错误。我已经检查以确保头文件与我的主文件位于同一位置，是的，因为我使用 Allegro 制作游戏，所以我确保链接调试库；所有这些东西都得到了照顾。

这是我的代码：

main.cpp （没有代码我想在头文件中）：

```
#include <iostream>
#include <allegro5\allegro5.h>
#include <allegro5\allegro_primitives.h>
#include <fstream>
#include "Globals.h"
using namespace std;

int main()
{
    ALLEGRO_DISPLAY *display = NULL;
    ALLEGRO_EVENT_QUEUE *event_queue = NULL;
    ALLEGRO_TIMER *timer = NULL;

    if(!al_init())  
    {
        if(errorFile.is_open())
            errorFile << "Allegro failed to initialize.";
        return -1;
    }

    display = al_create_display(WINDOW_WIDTH, WINDOW_HEIGHT);           

    if(!display)    
    {
        if(errorFile.is_open())
            errorFile << "ALLEGRO_DISPLAY failed to initialize.";
        return -1;
    }

    if(errorFile.bad())
    {
        cout << "errorFile is bad";
    }

    al_init_primitives_addon();
    al_install_keyboard();

    event_queue = al_create_event_queue();
    timer = al_create_timer(1.0 / 60);

    al_register_event_source(event_queue, al_get_keyboard_event_source());
    al_register_event_source(event_queue, al_get_timer_event_source(timer));
    al_register_event_source(event_queue, al_get_display_event_source(display));

    al_start_timer(timer);

    while(!done)
    {
        ALLEGRO_EVENT ev;
        al_wait_for_event(event_queue, &ev);
        if(ev.type == ALLEGRO_EVENT_TIMER)
        {
            if(ev.timer.source == timer)
            {

            }
        }
        if(ev.type == ALLEGRO_EVENT_DISPLAY_CLOSE)
        {
            done = true;
        }
        if(ev.type == ALLEGRO_EVENT_KEY_DOWN)
        {
            switch(ev.keyboard.keycode)
            {
                case ALLEGRO_KEY_ESCAPE:
                    done = true;
                    break;
            }
        }
        if(ev.type == ALLEGRO_EVENT_KEY_UP)
        {
            switch(ev.keyboard.keycode)
            {
                case ALLEGRO_KEY_ESCAPE:
                    done = true;
                    break;
            }
        }
        if(redraw && al_is_event_queue_empty(event_queue))
        {
            al_flip_display();
            al_clear_to_color(al_map_rgb(0,0,0));
        }
    }
    al_destroy_display(display);
    al_destroy_event_queue(event_queue);
    al_destroy_timer(timer);
    errorFile.close();
    return 0;
} 
```

这是带有所需代码的头文件“Globals.h”：

```
#include <iostream>
#include <fstream>

const int WINDOW_WIDTH = 600;
const int WINDOW_HEIGHT = 600;
bool done = true;
bool redraw = true;

enum KEYS {UP,DOWN,LEFT,RIGHT};
bool keys[4] = {false,false,false,false};

ofstream errorFile ("errorFile.txt", ios::trunc); 
```

提前谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:40:48.353

尝试将“”放在#include allegro 标头周围，这告诉编译器首先查看项目目录。尽管您可以将错误日志放在帖子中。

# java - libgdx中使用通用补间引擎的加法补间？

> ID：15329913
> 
> 赞同：5
> 
> 时间：2013-03-11T01:34:48.530
> 
> 标签：java, android, libgdx

我有一个循环补间的精灵，就像一个空闲动画。我想给它添加另一个补间，这样它们就可以同时播放了。（例如，如果我的第一个补间将其向上移动，而我的第二个补间将其向右移动，我希望它向上和向右移动。）

但是每当我播放第二个补间时，它似乎完全覆盖了第一个补间。我究竟做错了什么？

这是我的代码：

```
Tween.to(sprTurtle, SpriteAccessor.POS_XY, 0.4f)
    .waypoint(posTurtle[0] + (20 * density), posTurtle[1] + (20 * density))
    .target(posTurtle[0] + (30 * density), posTurtle[1])
    .ease(Quad.INOUT)
    .path(TweenPaths.catmullRom)
    .repeatYoyo(Tween.INFINITY, 0)
    .delay(0.1f)
    .start(tweenManager);
Tween.to(sprTurtle, SpriteAccessor.POS_XY, 1f)
    .target(50, 50)
    .repeat(Tween.INFINITY, 0)
    .start(tweenManager); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T13:50:11.083

此代码将在 cont2 中生成图像，这是一个 ViewContainer，首先从 (0,100) 移动到 (100, 100)。

```
 Timeline.createSequence()
        .push(Tween.set(cont2, ViewContainerAccessor.POSITION_XY))
        .push(Tween.to(cont2, ViewContainerAccessor.POSITION_XY, 0.5f).target(0,100))
        .push(Tween.to(cont2, ViewContainerAccessor.POSITION_XY, 0.5f).target(100,100))
        .start(tweenManager); 
```

在我的代码中，图像首先向下，然后向右。

也许在您的代码中应该是这样的

```
 Timeline.createSequence()
    .push(Tween.to(sprTurtle, SpriteAccessor.POS_XY, 0.4f)
        .waypoint(posTurtle[0] + (20 * density), posTurtle[1] + (20 * density))
        .target(posTurtle[0] + (30 * density), posTurtle[1])
        .ease(Quad.INOUT)
        .path(TweenPaths.catmullRom)
        .repeatYoyo(Tween.INFINITY, 0)
        .delay(0.1f))
    .push(Tween.to(sprTurtle, SpriteAccessor.POS_XY, 1f)
        .target(50, 50)
        .repeat(Tween.INFINITY, 0))
    .start(tweenManager); 
```

如果您确实希望两个图像同时移动，则必须制作两个 ViewContainer 以便它们可以同时移动。

在[官方演示 apk](https://docs.google.com/file/d/0B8tFsMh6a8xISVhYb3FENXRaWEE/edit?pli=1)`MainActivity.java`中，您可以看到以下代码。我添加and来同时移动两个图像。`LinearLayout genueHamster2``VieewContainer cont2`

```
 private LinearLayout genueHamster;
  private LinearLayout genueHamster2; // I add another LinearLayout so we could have
                                      // two images at the same time.

  @Override public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    //Setup it
    // a linearlayout in activity_main.xml
    genueHamster = (LinearLayout) findViewById(R.id.main_cont);
    // add for second image        
    genueHamster2 = (LinearLayout) findViewById(R.id.main_cont_2);
    setTweenEngine();
  }

  public void startAnimation(View v) {

    // Create object which we will animate
    ViewContainer cont = new ViewContainer();
    // Add a new container for the second image.
    ViewContainer cont2 = new ViewContainer();
    // pass our real container
    cont.view = genueHamster;
    // put it into the second container
    cont2.view = genueHamster2;

    // /start animations

    // Now you can have two images moving at the same time.
    Tween.to(cont, ViewContainerAccessor.POSITION_XY, 0.5f)
            .target(500, 0).ease(Bounce.OUT).delay(1.0f)
            .start(tweenManager);               

    Tween.to(cont2, ViewContainerAccessor.POSITION_XY, 0.5f)
            .target(0, 500)
            .ease(Bounce.OUT)
            .delay(1.0f)
            .repeatYoyo(2, 0.5f)
            .start(tweenManager);

  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-06T20:53:39.863

您正在寻找的是[Timeline.createParallel](http://www.aurelienribon.com/universal-tween-engine/javadoc/aurelienribon/tweenengine/Timeline.html#createParallel%28%29)方法。

# sharepoint - 使 _layouts 中的自定义 Web 应用程序了解子站点

> ID：15329917
> 
> 赞同：1
> 
> 时间：2013-03-11T01:35:19.180
> 
> 标签：sharepoint, sharepoint-2010

我有一个 SharePoint 2010 网站，它有不同的子网站，并且我有自定义（只是 ASP.NET）Web 应用程序部署到`_layouts`目录。

将此应用程序添加到特定子站点以便应用程序本身知道其位置的最佳方法是什么？

例如我有

*   [http://example.com/](http://example.com/) - 根站点
*   [http://example.com/site1](http://example.com/site1) - 子站点
*   [http://example.com/_layouts/mywebapp](http://example.com/_layouts/mywebapp) - 我的网络应用程序

现在我将此应用程序作为页面查看器添加到子站点（本质上是 iframe）

我想让我的应用程序知道具体的子站点。

# php - 致命错误：在非对象上调用成员函数准备

> ID：15329918
> 
> 赞同：-1
> 
> 时间：2013-03-11T01:35:26.710
> 
> 标签：php

有人可以指出我为什么以下代码失败的正确方向..

**MySQLDb.php：**

```
class MySQLDb 
{
        protected $_mysql; 
        protected $_query;

        function __constructor($host,$username,$password,$db)
        {
            $this->_mysql = new mysqli($host,$username,$password,$db) or die('Problem connecting to the DB.');

        }

        function query($query)
        {
            $this->_query =  filter_var($query,FILTER_SANITIZE_STRING);
            $stmt = $this->_prepareQuery();
            $stmt->execute();
            $results = $stmt->_dynamicBindResult($stmt);
        }

 protected function _prepareQuery(){

            $dbh = $this->_mysql;
            if ( !$stmt = $dbh->prepare($this->_query) ) {
                trigger_error('Problem preparing query', E_USER_ERROR);

            }

            return $stmt;
        } 
```

**索引.php：**

```
require_once('MYSQLDb.php');

$Db = new MySQLDb('localhost','root','','blog');

$results =$Db->query("SELECT * FROM posts"); 
```

当我运行程序时，它会`fatal error: call to a member function prepare on a non-object`在`if ( !$stmt = $dbh->prepare($this->_query) ) {`

我正在尝试学习做这些事情的面向对象的方式，所以不太了解如何解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T01:39:24.670

问题出在您的构造函数中：

```
function __constructor($host,$username,$password,$db) { 
```

实际的 PHP“类构造函数”名称是[`__construct`](http://php.net/manual/en/language.oop5.decon.php), not `__constructor`，因此您的版本永远不会被调用并且`$this->_mysql`是`null`（即 - 不是对象）。

尝试将功能更新为以下内容，它应该可以工作：

```
function __construct($host,$username,$password,$db) { 
```

# c - 使用堆栈中缀到后缀

> ID：15329919
> 
> 赞同：2
> 
> 时间：2013-03-11T01:35:27.893
> 
> 标签：c, stack, infix-notation

我的讲师给了我一个任务，让我创建一个使用 Stack 将中缀表达式转换为后缀的程序。我已经制作了堆栈类和一些函数来读取中缀表达式。

但是这个名为 inToPos(char string[]) 的函数负责使用堆栈将字符串 inFix 中的 inFix 表达式转换为字符串 postFix 中的 post fix 表达式，它正在创建一个断点。你们能帮助我并告诉我我做错了什么吗？

这些是我的代码，非常需要你的帮助.. :)

```
#include<stdio.h>
#include<stdlib.h>
#define MAX 15
#define true 1 
#define false 0 

typedef struct node* nodeptr;

typedef struct node{
    int data;
    nodeptr next;
}Node;

typedef struct{
    int count;
    nodeptr top;
}Stack;
typedef Stack* StackList;

StackList create();
void display(StackList list);
int isEmpty(StackList list);
void push(StackList list, int item);
void pop(StackList list);

int inToPos(char string[]);
int isOperator(char string[], int i);
int precedence(char x);

StackList create(){
StackList list;
list=(StackList)malloc(sizeof(Stack));
list->count=0;
list->top=NULL;
return list;
}

void display(StackList list){
    nodeptr ptr;
    ptr=list->top;
    while(ptr!=NULL){
        printf("%d ",ptr->data);
        ptr=ptr->next;
    }
    printf("\n");
}

int isEmpty(StackList list){
    return list->count==0;
    //return list->top==NULL;
}

void push(StackList list, int item){
    nodeptr temp;
    temp=(nodeptr)malloc(sizeof(Node));
    temp->data=item;
    temp->next=list->top;
    list->top=temp;
    (list->count)++;
}

void pop(StackList list){
    nodeptr temp;
    temp=list->top;
    list->top=temp->next;
    temp->next=NULL;
    free(temp);
    (list->count)--;
}

int inToPos(char string[]){
    int i,a=0;
    char postfix[MAX];
    StackList list=create();
    for(i=0;string[i]!='\0';i++){
        if(!isOperator(string,i)){
            postfix[a]=string[i];
            a++;
        }
        else if(isEmpty(list))
            push(list,string[i]);
        else{
            if(precedence(string[i])>precedence(list->top->data))
                push(list,string[i]);
            else{
                postfix[a]=list->top->data;
                a++;
                pop(list);
                if(!isEmpty(list)){
                    while(precedence(list->top->data)<=precedence(string[i])){
                        postfix[a]=list->top->data;
                        a++;
                        pop(list);
                    }
                }
                else
                    push(list,string[i]);
            }
        }
    }
    puts(postfix);
}

int isOperator(char string[], int i){
    switch(string[i])
    {
    case '+':
    case '-':
    case '*':
    case '%':
    case '/': return true;

    default: return false;
    }
}

int precedence(char x){
    switch(x)
    {
    case '%':
    case '*':
    case '/': return 2;
    case '+':
    case '-': return 1;

    default: return 0;
    }
}
int main(void){

    char string[MAX]="a+b*c-d";
    inToPos(string);
} 
```

请注意，inToPos 函数是使用以下算法生成的：

*   从左到右扫描中缀字符串。
*   初始化一个空栈。
*   如果扫描的字符是操作数，则将其添加到 Postfix 字符串。如果扫描的字符是运算符并且堆栈为空，则将字符推入堆栈。
*   如果扫描到的字符是运算符且堆栈不为空，则将字符的优​​先级与堆栈顶部的元素（topStack）进行比较。如果 topStack 的优先级高于扫描的字符，则弹出堆栈，否则将扫描的字符推入堆栈。只要 stack 不为​​空并且 topStack 优先于字符，就重复此步骤。重复此步骤，直到字符被扫描。
*   （扫描完所有字符后，我们必须将堆栈可能包含的任何字符添加到 Postfix 字符串。）如果堆栈不为空，则将 topStack 添加到 Postfix 字符串并弹出堆栈。只要堆栈不为空，就重复此步骤。
*   返回后缀字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:50:51.533

你真的应该学习如何使用调试器，它是解决此类问题的好工具。但是，我运行它并发现了您的问题：

在这条线上：

```
while(precedence(list->top->data)<=precedence(string[i])){ 
```

遍历列表时，每次都需要检查堆栈是否为空，而不仅仅是在进入循环之前。所以，做这样的事情：

```
while(!isEmpty(list) && precedence(list->top->data)<=precedence(string[i])){ 
```

反而。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-05T06:59:21.290

```
[Program to convert infix to postfix using stack][1]

C program to convert infix to postfix using stackC

#define SIZE 50            
#include <ctype.h>
char s[SIZE];
int top=-1;       /* Global declarations */

push(char elem)
{                       /* Function for PUSH operation */
    s[++top]=elem;
}

char pop()
{                      /* Function for POP operation */
    return(s[top--]);
}

int pr(char elem)
{                 /* Function for precedence */
    switch(elem)
    {
    case '#': return 0;
    case '(': return 1;
    case '+':
    case '-': return 2;
    case '*':
    case '/': return 3;
    }
}

main()
{                         /* Main Program */
    char infix[50],postfix[50],ch,elem;
    int i=0,k=0;
    printf("\n\nEnter Infix Expression : ");
    scanf("%s",infix);
    push('#');
    while( (ch=infix[i++]) != '\0')
    {
        if( ch == '(') push(ch);
        else
            if(isalnum(ch)) postfix[k++]=ch;
            else
                if( ch == ')')
                {
                    while( s[top] != '(')
                        postfix[k++]=pop();
                    elem=pop(); /* Remove ( */
                }
                else
                {       /* Operator */
                    while( pr(s[top]) >= pr(ch) )
                        postfix[k++]=pop();
                    push(ch);
                }
    }
    while( s[top] != '#')     /* Pop from stack till empty */
        postfix[k++]=pop();
    postfix[k]='\0';          /* Make postfix as valid string */
    printf("\nPostfix Expression =  %s\n",postfix);
} 
```

# python - Bash“参数扩展”的Python等效/模拟器

> ID：15329923
> 
> 赞同：3
> 
> 时间：2013-03-11T01:35:50.107
> 
> 标签：python, bash

我有一个 bash 脚本，用于更新我家中的几台计算机。它利用 deborphan 程序来识别我的系统（显然是 Linux）上不再需要的程序。

bash 脚本利用了 bash 的参数扩展，这使我能够将 deborphan 的结果传递给我的包管理器（在本例中为 aptitude）：

`aptitude purge $(deborphan --guess-all) -y`

deborphan 的结果是：

```
python-pip
python3-all 
```

我想将我的 bash 脚本转换为 python（部分作为学习机会，因为我是 python 新手），但我遇到了一个重大障碍。我对 python 脚本的明显开始是

```
subprocess.call(["aptitude", "purge", <how do I put the deborphan results here?>, "-y"]) 
```

我已经为上面的 subprocess.call 中的一个参数尝试了一个单独的 subprocess.call ，只是为了 deborphan 并且失败了。

有趣的是，我似乎无法通过以下方式捕捉 deborphan 结果：

```
deb = subprocess.call(["deborphan", "--guess-all"]) 
```

将 deborphan 的结果作为参数的变量传递。

反正有没有在 python 中模拟 Bash 的参数扩展？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T01:41:48.190

您可以`+`用来连接列表：

```
import subprocess as sp
deborphan_results = sp.check_output(…)
deborphan_results = deborphan_results.splitlines()
subprocess.call(["aptitude", "purge"] + deborphan_results + ["-y"]) 
```

（如果你使用的是低于 2.7 的 Python 版本，你可以使用`proc = sp.Popen(…, stdout=sp.PIPE); deborphan_results, _ = proc.communicate()`）

# c# - 从服务器获取图像，同时忽略文件的大小写敏感性

> ID：15329925
> 
> 赞同：2
> 
> 时间：2013-03-11T01:36:20.743
> 
> 标签：c#, winforms, ubuntu-12.04, webrequest, case-sensitive

我怎样才能让我的代码获取图像“_filename.JPG”而不仅仅是“_filename.jpg”？

```
string picUrl = "http://MyServer/" + _filename + ".jpg";            
Image webImage = global::MyProject.Properties.Resources.ImageNotFound1;
try
{
    WebRequest requestPic = WebRequest.Create(picUrl);
    WebResponse responsePic = requestPic.GetResponse();
    webImage = Image.FromStream(responsePic.GetResponseStream());                
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:52:35.630

服务器强制区分大小写 - 您的客户端代码不能影响服务器的行为。HTTP 服务器要求路径的精确大小写是不寻常的，但对于基于 Unix/Linux 的服务器来说很容易获得行为，并在[Uri RFC](http://www.ietf.org/rfc/rfc3986.txt)中以这种方式进行了描述。

如果服务器区分大小写，您的选项：

*   询问文件的确切名称（可能服务器提供了一种获取确切文件名的方法。即通过解析一些 HTML 页面）
*   事先知道名称的大小写（即在服务器上仅使用小写名称）。
*   为名称中的每个字符生成一些/所有大小写组合（即尝试已知大小写，如 .jpg/.JPG），但这可能需要很长时间。
*   重新配置服务器以非大小写方式接受文件名
*   查看服务器是否支持某种提示来进行不区分大小写的文件检索（不太可能，但是......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T02:45:26.130

就像 Alexei Levenkov 的建议之一，我通过启用模块“mod_speling”使我的 Apache 服务器不区分大小写

这是链接 [http://www.leccionespracticas.com/informatica-sistemas-y-servidores/apache-case-sensitive-to-case-insensitive-and-alias-solved/](http://www.leccionespracticas.com/informatica-sistemas-y-servidores/apache-case-sensitive-to-case-insensitive-and-alias-solved/)

> Apache 在 *nix 系统上区分大小写，因为底层文件系统区分大小写。这可能会给从不区分大小写的系统带来的站点带来麻烦。使用 apache 模块 check_speling（有趣的名字，嗯？）可以相对容易地消除这种敏感性。它还会在可能的情况下重新映射错误输入的 url，将 index.htm 映射到正确的 index.html 等。
> 
> 这是 Ubuntu/Debian 系统的程序。

1.  在命令行中，键入 sudo su 以获取 root 权限。
2.  纳米 /etc/apache2/mods-available/speling.conf
3.  键入 CheckSpelling on 并按 ctrl-x, y 退出并保存文件。
4.  输入 a2enmod 然后拼写并按回车键。
5.  键入 /etc/init.d/apache2 reload 以重新加载 apache。
6.  输入错误的 url 来测试它。

# assembly - 汇编程序：递归？

> ID：15329930
> 
> 赞同：0
> 
> 时间：2013-03-11T01:37:01.010
> 
> 标签：assembly, recursion, mips, pcspim

我需要编写一个可以迭代 10 次的程序。每次它都会更新一个值并将其打印到屏幕上。

我知道必须做一些事情来创建堆栈并保存值，以便它可以迭代回来并到达正确的部分以继续程序。我尝试了很多东西，但我无法弄清楚。到目前为止，这是我的代码

```
# ############################################################### #
# Phase2.ASM                                                      #
#                                                                 #
# This program will recurse 10 times and show how much interest   #
# is made after 10        "months"                                        #
#                                                                 #
# ############################################################### #   

.data

PRINCIPAL:  .float  100.0   # principal = $100.00
INTEREST_RATE:  .float  0.012   # interest  = 1.2%

promptFirst:     .asciiz "Your starting Principal is $100.00: \n"
promptSecond:     .asciiz "Your interest rate is 1.2%: \n"
promptNow:          .asciiz "Interest Made After a Month:\n"
.text
.globl main

main:   

First:   
     # Prints the first prompt  
     li $v0, 4               # syscall number 4 will print string whose address is in $a0       
     la $a0, promptFirst     # "load address" of the string
     syscall                 # actually print the string   

Second:  
     # Prints the second prompt
     li $v0, 4               # syscall number 4 will print string whose     address is in $a0   
     la $a0, promptSecond    # "load address" of the string
     syscall                 # actually print the string    

jal CI

j EXIT

CI:

    la  $a0, PRINCIPAL  # load the address of the principal
    la  $a1, INTEREST_RATE  # load the address of the principal

    lwc1  $f2, ($a0)    # load the principal
    lwc1  $f4, ($a1)    # load the interest rate    
    mul.s $f12, $f4, $f2    # calculate the balance

    li $v0, 4            # syscall number 4 will print string whose address is in $a0   
    la $a0, promptNow    # "load address" of the string
    syscall              # actually print the string
    li  $v0, 2           # system call #2   
    syscall

jr $ra

EXIT:    
jr $ra

# END OF THE LINES ############################################### 
```

到目前为止我的当前输出：

您的起始本金为 100.00 美元：

您的利率为 1.2%：

一个月后产生的利息：

1.20000005

任何帮助将不胜感激。我真的不擅长汇编编程。

PS：分配必须通过递归完成

**编辑！新代码**

```
# ############################################################### #
# Phase2.ASM                                                      #
#                                                                 #
# This program will recurse 10 times and show how much interest   #
# is made after 10     "months"                                       #
#                                                                 #
# ############################################################### #   

.data

PRINCIPAL:  .float  100.0   # principal = $100.00
INTEREST_RATE:  .float  1.012   # interest  = 1.2%

promptFirst:     .asciiz "Your starting Principal is $100.00: \n"
promptSecond:     .asciiz "Your interest rate is 1.2%: \n"
promptNow:          .asciiz "\nYour Balance After A Month:\n"
.text
.globl main

main:   

First:   
     # Prints the first prompt  
     li $v0, 4               # syscall number 4 will print string whose address is in $a0       
     la $a0, promptFirst     # "load address" of the string
     syscall                 # actually print the string   

Second:  
     # Prints the second prompt
     li $v0, 4               # syscall number 4 will print string whose address is in $a0   
     la $a0, promptSecond    # "load address" of the string
     syscall                 # actually print the string    

li $t1, 0
jal CI

ENDCI:
j EXIT

CI:

    add $t1, $t1, 1 
    la  $a0, PRINCIPAL      # load the address of the principal
    la  $a1, INTEREST_RATE  # load the address of the principal

    lwc1  $f2, ($a0)        # load the principal
    lwc1  $f4, ($a1)        # load the interest rate    
    mul.s $f12, $f4, $f2    # calculate the balance

    li $v0, 4               # syscall number 4 will print string whose address is in $a0   
    la $a0, promptNow       # "load address" of the string
    syscall                 # actually print the string
    li  $v0, 2              # system call #2    
    syscall

    beq $t1, 10, ENDCI
    jal CI
jr $ra

EXIT:    
jr $ra

# END OF THE LINES ############################################### 
```

新输出：

我们的起始本金为 100.00 美元：您的利率为 1.2%：

一个月后的余额：

101.19999695

一个月后的余额：

101.19999695

一个月后的余额：

101.19999695

一个月后的余额：

101.19999695

一个月后的余额：

101.19999695

一个月后的余额：

101.19999695

一个月后的余额：

101.19999695

一个月后的余额：

101.19999695

一个月后的余额：

101.19999695

一个月后的余额：

101.19999695

所以我得到了迭代10次的代码。我需要更新金额，以便显示上个月+利息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T08:50:23.067

您需要在每次更新后存储当前余额，以便下次调用不会继续使用原始值。

即是这样的：

```
lwc1  $f2, ($a0)        # load the principal
lwc1  $f4, ($a1)        # load the interest rate    
mul.s $f12, $f4, $f2    # calculate the balance
swc1  $f12, ($a0) 
```

在每次额外调用之前`CI`还需要保存当前的返回地址，然后在返回前恢复：

```
addi $sp,$sp,-4     # push the current return address
sw   $ra,($sp)      # ...
beq  $t1, 10, CIRET
jal  CI
CIRET:
lw   $ra,($sp)      # pop the saved return address
addi $sp,$sp,4      # ....
jr   $ra 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T01:46:45.517

这个问题不需要递归——一个简单的循环就可以了。汇编中的循环只是代码的有条件跳转（或无条件跳转与条件跳转结合）。

条件是基于计数器的，计数器将从 0 到 9，或从 9 到 0，在汇编中通常更容易根据与零的比较进行条件跳转。

# eigen - 我如何从一个方法返回一个 Eigen::Matrix，这样它在返回时不复制数据

> ID：15329933
> 
> 赞同：6
> 
> 时间：2013-03-11T01:37:30.463
> 
> 标签：eigen

我有：

```
Eigen::MatrixXf load_from_gpu()
{
    Eigen::MatrixXf mat(m_rows,m_cols);
    clEnqueueReadBuffer(m_manager->m_gpu_queue_loader, m_buffer, CL_TRUE, 0, sizeof(float)*numel(), mat.data(), 0, NULL, NULL); 
    return mat; 
} 
```

我相信当我调用此方法时，数据会存储到一个垫子中，然后复制到 mat2 ：`Eigen::MatrixXf mat2 = load_from_gpu();`

是否有可能让它将数据写入矩阵，这是函数调用的 rhs`load_from_gpu()`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-20T16:09:17.193

您的编译器应该能够使用常见的[返回值优化](http://en.wikipedia.org/wiki/Return_value_optimization)方法为您执行此操作。基本上这样做是编译器重写`load_from_gpu`以将指针`Eigen::MatrixXf`作为参数，并直接填充该矩阵。

请注意，它只能这样做，因为它可以看到它`mat`始终是返回值，如果方法中有多个矩阵并且基于某种条件返回一个，编译器不知道用隐藏指针替换哪个范围。在这种情况下，您必须求助于手动操作，就像在 alrikai 的回答中一样。

要启用优化，您必须`-O2`使用 GCC 进行编译。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T01:45:44.480

我没有太多使用 Eigen，但是您不能将您的 Matrix 作为参考参数传递并分配它`load_from_gpu()`吗？那是，

```
void load_from_gpu(Eigen::MatrixXf& mat)
{
    clEnqueueReadBuffer(m_manager->m_gpu_queue_loader, m_buffer, CL_TRUE, 0, sizeof(float)*numel(), mat.data(), 0, NULL, NULL);
} 
```

# html - 如何显示不规则重复但相同的图像，以便它们的边界在行之间对齐？

> ID：15329938
> 
> 赞同：0
> 
> 时间：2013-03-11T01:38:11.743
> 
> 标签：html, css, image, border

我正在尝试使用带有**蓝色**边框的[正方形图像](http://i.imgur.com/i8HNbEe.jpg)在 HTML/CSS 中重新创建[Space Invaders 图标](http://i.imgur.com/v6QOf3d.png)的“像素化”版本。`30px` **`2px`**

 **但是，我在对齐边框时遇到了*难以置信*的困难，因为方形图像在每一行上的重复次数**并不***相同*（例如，前 2 行仅显示方形图像两次，而第 3 行显示 7 次，等等）。`2px`

 ***我首先想象了一个 11 x 8 的矩形网格，然后我使用了一个`<div>`与正方形图像具有相同宽度和高度并且*没有边框*作为图像不应该出现的**占位符**`1px`，同时以实心边框显示每个正方形图像它们应该出现的地方。

`2px`这样做的问题是，虽然内部的图像正确显示了（`1px`+边框）的加倍`1px`边框，但最外面的正方形仅`1px`在不靠近另一个正方形的外侧显示边框。

所以然后我尝试`2px`在“外部正方形”的“外侧”设置边框，但这随后将整行中图像行的整个“行高”（使用`vertical-align: middle;`）从`1px`更改为`2px`，从而创建了一个空白的`1px`高空间在内部正方形的顶部。

所以在过去的几个小时里，我一直在拉头发，试图让它看起来“正确”，`2px`边框在“网格”中正确对齐，而不是出现在没有方形图像的地方，但我要进去了界。

当然，有一种更简单、更直接的方法可以做到这一点。 **什么是神奇的解决方案？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:57:43.387

所以，既然你一直在努力解决这个问题，我想我可能会建议一个更简单的解决方案，也许不能完全回答你的问题，如果没有 HTML 示例，这很难给出。

我制作了这个纯 CSS 的空间入侵者：

`[**CSS-only Space Invader!**](http://jsbin.com/eranoc/1)`

基本上你所做的就是为你的像素设置一个通用的 CSS 规则`<div>`，我将它定义为：

```
div{ 
  background-color: transparent;
  border: 1px solid #000;
  float: left;
  width: 30px;
  height: 30px;
} 
```

当然，请选择不那么通用的东西`div`，我这样做只是为了示例目的。通过这种方式，你有一个 div 组成你的透明像素。每次您需要在图像中填充一个像素时，只需使用`.px`这个最小的 CSS 规则添加一个类（我使用过）

```
.px{ 
  background-color: lightgreen;
} 
```

当你开始你的新生产线时，给你`div`一个 class of`.first`并 make it `clear:left`。

```
.first{ 
  clear:left;
} 
```

我认为这是一个非常简单的解决方案！**带上 CSS 像素艺术！*******

# mysql - InnoDB 在大型数据库上处理多连接操作的选择语句有多好？

> ID：15329943
> 
> 赞同：1
> 
> 时间：2013-03-11T01:38:27.947
> 
> 标签：mysql, innodb, myisam

我正在为一个重度使用的应用程序设计一个大型数据库。该应用程序将在销售时进行许多插图/更新，但我将有更多选择。我将做很多涉及多（3-6）内连接的选择语句。

innoDB 将如何处理这些复杂的 select 语句。我还将在我的选择中使用大量 datetime 子句作为过滤器。

那么对于这样的应用程序，InnoDB 会比 MyIsam 更好吗？或者我应该坚持还是旧的 MyIsam 方法？

这是一个选择语句的示例

```
 SELECT act.subject, act.attempts, in.industry_name, zn.zone_name, cc.code_id, DATE_FORMAT(act.due_on, "%m-%d-%Y %T") AS due_on FROM activities AS act
    INNER JOIN industries AS in ON in.industry_id = act.industry_id
    INNER JOIN zones AS zn ON zn.zone_id = act.zone_id
    INNER JOIN call_codes AS cc ON cc.code_id = act.code_id
    WHERE act.due_on BETWEEN (CURRDATE() + ' 00:00:00')  AND (CURRDATE() + ' 23:59:59')
    ORDER BY act.due_on

**This is a summery of fields description**
The following field's  type are CHAR(50)
act.subject
in.industry_name
zn.zone_name

the following field's type are INT(10) unsigned and they are all foreign keys
cc.code_id
in.industry_id
zn.zone_id

the following field's type are INT(10) unsigned and they all are indexed
act.industry_id
act.zone_id
act.code_id

this field is a date time
act.due_on 
```

我还应该注意，我的活动表有 300 万条记录。此外，我将使用 COUNT()、MAX()、MIX()、SUM()、AVG()、CASE WHEN Some THEN OTHER END 进行大量报告.....

# php - 如何添加img的“标题”并用wordpress显示

> ID：15329945
> 
> 赞同：0
> 
> 时间：2013-03-11T01:38:36.430
> 
> 标签：php, jquery, image, wordpress, supersized

我正在编写一个由我修改的 Supersized，介于 wordpress 和著名的超大幻灯片之间。

在某处，我发布了一个问题（大约 7 天前），关于如何将图像从 wordpress 插入到 Supersized 并解决。我的客户问我他想要主页底部显示的图像的标题（进入 url ）。

所以我需要插入图片的标题：

例如：

```
{image : 'http://***.jpg', title : 'title_img'} 
```

此修改后的代码用于图像但不是标题：

```
<script type="text/javascript">

            jQuery(function($){
                var imagesArray = [
                <?php 
                function foo($anArray){
                foreach($myimages as $img){
                    echo "\{image : '".$img."'\},";
                }
                }?>
                ];
                $('#container_post img').each(function(){
                    var obj = {};
                    obj.image = this.src ;
                    imagesArray.push(obj);
                });
                $.supersized({

                    // Functionality
                    slideshow               :   1,          // Slideshow on/off
                    autoplay                :   1,          // Slideshow starts playing automatically
                    start_slide             :   1,          // Start slide (0 is random)
                    stop_loop               :   0,          // Pauses slideshow on last slide
                    random                  :   0,          // Randomize slide order (Ignores start slide)
                    slide_interval          :   5000,       // Length between transitions
                    transition              :   6,          // 0-None, 1-Fade, 2-Slide Top, 3-Slide Right, 4-Slide Bottom, 5-Slide Left, 6-Carousel Right, 7-Carousel Left
                    transition_speed        :   1000,       // Speed of transition
                    new_window              :   1,          // Image links open in new window/tab
                    pause_hover             :   0,          // Pause slideshow on hover
                    keyboard_nav            :   1,          // Keyboard navigation on/off
                    performance             :   1,          // 0-Normal, 1-Hybrid speed/quality, 2-Optimizes image quality, 3-Optimizes transition speed // (Only works for Firefox/IE, not Webkit)
                    image_protect           :   1,          // Disables image dragging and right click with Javascript

                    // Size & Position                         
                    min_width               :   0,          // Min width allowed (in pixels)
                    min_height              :   0,          // Min height allowed (in pixels)
                    vertical_center         :   1,          // Vertically center background
                    horizontal_center       :   1,          // Horizontally center background
                    fit_always              :   0,          // Image will never exceed browser width or height (Ignores min. dimensions)
                    fit_portrait            :   1,          // Portrait images will not exceed browser height
                    fit_landscape           :   0,          // Landscape images will not exceed browser width

                    // Components                           
                    slide_links             :   'blank',    // Individual links for each slide (Options: false, 'num', 'name', 'blank')
                    thumb_links             :   0,          // Individual thumb links for each slide
                    thumbnail_navigation    :   0,          // Thumbnail navigation
                        slides : imagesArray 
, 

                    // Theme Options               
                    progress_bar            :   1,          // Timer for each slide                         
                    mouse_scrub             :   0

                });
            });

        </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T18:34:28.053

我写了这段关于 apiField 的代码

```
<script>
    $(document).ready(function(){
        var slideTitle = api.getField('title');
        alert(slideTitle);
    });
</script> 
```

浏览器告诉我：“未定义”

怎么了？

```
 <script type="text/javascript">

                jQuery(function($){

                    var imagesArray = [
                    <?php 
                    function foo($anArray){
                    foreach($myimages as $img){
                        echo "\{image : '".$img."', title : '".$img->post_title."'\},";
                    }
                    }?>
                    ];

                    $('#container_post img').each(function(){
                        var obj = {};
                        obj.image = this.src ;
                        imagesArray.push(obj);
                    });
                    var slideTitle = api.getField('title');
                    alert(slideTitle);
                    $.supersized({

                        // Functionality
                        slideshow               :   1,          // Slideshow on/off
                        autoplay                :   1,          // Slideshow starts playing automatically
                        start_slide             :   1,          // Start slide (0 is random)
                        stop_loop               :   0,          // Pauses slideshow on last slide
                        random                  :   0,          // Randomize slide order (Ignores start slide)
                        slide_interval          :   5000,       // Length between transitions
                        transition              :   6,          // 0-None, 1-Fade, 2-Slide Top, 3-Slide Right, 4-Slide Bottom, 5-Slide Left, 6-Carousel Right, 7-Carousel Left
                        transition_speed        :   1000,       // Speed of transition
                        new_window              :   1,          // Image links open in new window/tab
                        pause_hover             :   0,          // Pause slideshow on hover
                        keyboard_nav            :   1,          // Keyboard navigation on/off
                        performance             :   1,          // 0-Normal, 1-Hybrid speed/quality, 2-Optimizes image quality, 3-Optimizes transition speed // (Only works for Firefox/IE, not Webkit)
                        image_protect           :   1,          // Disables image dragging and right click with Javascript

                        // Size & Position                         
                        min_width               :   0,          // Min width allowed (in pixels)
                        min_height              :   0,          // Min height allowed (in pixels)
                        vertical_center         :   1,          // Vertically center background
                        horizontal_center       :   1,          // Horizontally center background
                        fit_always              :   0,          // Image will never exceed browser width or height (Ignores min. dimensions)
                        fit_portrait            :   1,          // Portrait images will not exceed browser height
                        fit_landscape           :   0,          // Landscape images will not exceed browser width

                        // Components                           
                        slide_links             :   'blank',    // Individual links for each slide (Options: false, 'num', 'name', 'blank')
                        thumb_links             :   0,          // Individual thumb links for each slide
                        thumbnail_navigation    :   0,          // Thumbnail navigation
                            slides : imagesArray 
    , 

                        // Theme Options               
                        progress_bar            :   1,          // Timer for each slide                         
                        mouse_scrub             :   0

                    });
                });

            </script> 
```

# database - MVC 4 从数据库返回条目，不包括特定项目

> ID：15329946
> 
> 赞同：0
> 
> 时间：2013-03-11T01:38:57.603
> 
> 标签：database, asp.net-mvc-4, lambda

我一直在改变这个电话一段时间，但不能让它发挥作用。我正在尝试从数据库中返回一些记录，并根据它们的 ID 号排除项目。

这是一个报价数据库，当有人隐藏报价时，它会将报价 ID 存储在 cookie 中（必需），当返回站点时，会读取 cookie.value。

我需要从返回查询中过滤出这些 ID，并使用 WebGrid 在视图中显示结果。我有饼干部分工作。我检索值（可能是多个）并将其拆分为字符串列表。然后我运行一个 foreach 循环，将字符串解析为一个整数，然后尝试删除我从数据库中检索到的引号。这是我正在使用的代码...

```
// Filter on Cookie Value using tokenizer
string value = Request.Cookies.Get("hideCookie").Value;
List<string> values = value.Split(' ').ToList();
var quotes2 = db.Quotes.Include(q => q.QName);

foreach (var i in values)
{
    int idv = int.Parse(i);
    quotes2 = from q in quotes2 where q.QuoteID != idv select q;
}
return View(quotes2.ToList()); 
```

这会引发错误“指定的包含路径无效。EntityType 'Exercise4.Models.Quote' 未声明名为 'QName' 的导航属性。” （QName 是数据库记录中的一个条目）。

如果我在返回 View() 中删除 ToList()，quotes2 会传递给 View，但会在 webGrid 上抛出此错误“指定的包含路径无效。EntityType 'Exercise4.Models.Quote' 未声明导航名为“QName”的属性。”

我确信有更好的方法来做到这一点。你能指点我正确的方向吗，这样我就可以停止用头撞我的桌子了......

# isolatedstorage - 创建的动态磁贴看起来已损坏

> ID：15329955
> 
> 赞同：0
> 
> 时间：2013-03-11T01:40:36.243
> 
> 标签：isolatedstorage, corrupt, live-tile

我正在通过更新 173x173 XAML 控件中的文本来创建自定义动态磁贴，然后使用 writablebitmap.Render 创建 JPEG。最后，创建 StandardTileData，设置两个图像，并将它们放在正确的图块上。大部分时间都在工作。实际上它总是更新得很好。但是偶尔在创建或删除新图块时，图像会损坏。文字全部糊在瓷砖的左侧，没有背景颜色。任何想法可能会发生什么？这不是后台任务，因为它已被禁用。与我尝试设置平铺数据时系统扫描新创建的 jpeg 有什么关系？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T03:02:33.667

found solution here
[rendering usercontrol live tile windows phone](https://stackoverflow.com/questions/14357302/rendering-usercontrol-live-tile-windows-phone) Obviously a system bug. calling UpdateLayout before and after each measure and arrange call

# php - 为什么这个 mysql 查询不播种随机数？

> ID：15329961
> 
> 赞同：0
> 
> 时间：2013-03-11T01:40:52.923
> 
> 标签：php, mysql

在我的 PHP 程序的上下文中，这个查询每分钟回显一个新的数据库项，这正是我想要的。

```
SELECT * FROM dogs ORDER BY rand(ROUND(UNIX_TIMESTAMP()/60)) LIMIT 1 
```

但是，当我这样做时：

```
SELECT * FROM dogs WHERE dateused<44 ORDER BY rand(ROUND(UNIX_TIMESTAMP()/60)) LIMIT 1 
```

WHERE 查询有效，但来自 rand 的数字没有种子。每次运行此查询时，都会回显一个新的数据库项。

有人对如何让号码播种一分钟有任何想法吗？或者至少，一种解决方法。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T09:50:25.800

试试这个方法：`SELECT * FROM dogs ORDER BY rand(MINUTE(NOW())) LIMIT 1`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T13:34:32.630

正如文档所说，“从 MySQL 5.1.16 开始，如果使用非常量初始化器（例如列名）作为参数，则种子将使用每次调用 RAND() 的值初始化”（[http:// dev.mysql.com/doc/refman/5.1/en/mathematical-functions.html#function_rand](http://dev.mysql.com/doc/refman/5.1/en/mathematical-functions.html#function_rand)）。

但这适用于 MySQL 5.1.16 及更高版本。从 MySQL 5.1.3 到 5.1.15，不允许使用非常量参数。在此之前，使用非常量参数的效果是不确定的。

因此，如果您从非常量参数中得到不一致的结果，则可能是您的 MySQL 版本。

我尝试了你在 5.1.47 MySQL 上所做的事情，它按照你希望的方式工作。

# php - What are the first things I should do to convert my Codeigniter PHP web app to an iOS app?

> ID：15329962
> 
> 赞同：0
> 
> 时间：2013-03-11T01:40:54.470
> 
> 标签：php, ios, codeigniter

I have a PHP-coded website working on a codeigniter framework. I want to create the iOS app version of this and understand they are completely different. But I want to learn while I try to make the app happen.

I have spring break next week and want to try and get really far. I need to connect my site to a MySQL database and run a bunch of different algorithms. I am assuming I will need to re-write all of the algorithms into a new language (Objective-C I believe) I just want to know the best way to get started building the app. I want to make sure I'm watching tutorials that will be beneficial to my end goals, rather just learn the basic core.

I have things like xcode set up, just need to know where I should go. Thank you!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:56:18.140

Yes if you really want to make a native app than you have to rewrite all in Objective-C. You also need an API on your server to connect to MySql from external device.

This API is usally REST or SOAP based. If you need to deal with user login than OAuth is the way to go.

But there are alternatives to native apps. One interesting thing is a hybrid app. This is a native browser element and inside that browser your normal website with a mobile optimized layout is running. With a hybrid app you can get into app store, too. Look at [http://phonegap.com/](http://phonegap.com/).

Another solution is to only make a mobile optimized or responsive layout for your site. If you don't need to be in app store or don't need native functions like GPS, accelerometer etc. than this is a good option.

# android - ArrayAdapter 要求 resourceID 为文本视图

> ID：15329968
> 
> 赞同：2
> 
> 时间：2013-03-11T01:42:49.490
> 
> 标签：android, arrays, textview, resource-id

我的这个项目的目标是使用用户输入动态更新微调器。不幸的是，我正在输掉这场战斗。Logcat不断向我抛出资源ID错误，但是，我不明白为什么它只在按下按钮时抛出，如果那是问题所在，它不会在onCreate之后抛出吗？

Eclipse（通过 ctrl + 空格）告诉我指定包含 TextView 的布局的资源 ID。如果我只是处理一个数组和一个微调器，我什至不明白为什么我需要一个 textview。AndroidDevelopment 网站也这么说。我只是很困惑。所以，我的问题是，这个错误是什么意思，我做错了什么？

我相信这是有问题的行：

```
list = new ArrayAdapter<String>(this,R.layout.settings,items); 
```

这是.java

```
 package com.example.thepicker;

import java.util.ArrayList;
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ArrayAdapter;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.Spinner;

public class Settings extends Activity implements OnClickListener{

    EditText getit;
    ImageButton giveit;
    Spinner thelist;
    ArrayList<String> items;
    ArrayAdapter<String> list;
    String transit;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.settings);

        items = new ArrayList<String>();
        list = new ArrayAdapter<String>(this,R.layout.settings,items);
        getit = (EditText) findViewById(R.id.getit);
        giveit = (ImageButton) findViewById(R.id.giveit);
        thelist = (Spinner) findViewById(R.id.thelist);

        thelist.setAdapter(list);
        giveit.setOnClickListener(this);
    }

@Override
    public void onClick(View v) {
        String transit = getit.getText().toString();
        items.add(transit);
        list.insert(transit, 0);
        list.notifyDataSetChanged();
    }
} 
```

这是日志猫

```
03-11 01:39:25.682: E/Trace(1722): error opening trace file: No such file or directory (2)
03-11 01:39:26.452: D/libEGL(1722): loaded /system/lib/egl/libEGL_emulation.so
03-11 01:39:26.532: D/(1722): HostConnection::get() New Host Connection established 0x556a6180, tid 1722
03-11 01:39:26.602: D/libEGL(1722): loaded /system/lib/egl/libGLESv1_CM_emulation.so
03-11 01:39:26.623: D/libEGL(1722): loaded /system/lib/egl/libGLESv2_emulation.so
03-11 01:39:26.761: W/EGL_emulation(1722): eglSurfaceAttrib not implemented
03-11 01:39:26.772: D/OpenGLRenderer(1722): Enabling debug mode 0
03-11 01:39:30.483: W/EGL_emulation(1722): eglSurfaceAttrib not implemented
03-11 01:39:36.412: E/ArrayAdapter(1722): You must supply a resource ID for a TextView
03-11 01:39:36.412: D/AndroidRuntime(1722): Shutting down VM
03-11 01:39:36.423: W/dalvikvm(1722): threadid=1: thread exiting with uncaught exception (group=0x2bd39930)
03-11 01:39:36.562: E/AndroidRuntime(1722): FATAL EXCEPTION: main
03-11 01:39:36.562: E/AndroidRuntime(1722): java.lang.IllegalStateException: ArrayAdapter requires the resource ID to be a TextView
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:386)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.widget.ArrayAdapter.getView(ArrayAdapter.java:362)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.widget.AbsSpinner.onMeasure(AbsSpinner.java:193)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.widget.Spinner.onMeasure(Spinner.java:439)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.View.measure(View.java:15513)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.widget.RelativeLayout.measureChildHorizontal(RelativeLayout.java:645)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.widget.RelativeLayout.onMeasure(RelativeLayout.java:425)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.View.measure(View.java:15513)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.View.measure(View.java:15513)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.widget.LinearLayout.measureVertical(LinearLayout.java:847)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.widget.LinearLayout.onMeasure(LinearLayout.java:588)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.View.measure(View.java:15513)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at com.android.internal.policy.impl.PhoneWindow$DecorView.onMeasure(PhoneWindow.java:2176)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.View.measure(View.java:15513)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.ViewRootImpl.performMeasure(ViewRootImpl.java:1874)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.ViewRootImpl.measureHierarchy(ViewRootImpl.java:1089)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1265)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java:989)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java:4351)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.Choreographer$CallbackRecord.run(Choreographer.java:749)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.Choreographer.doCallbacks(Choreographer.java:562)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.Choreographer.doFrame(Choreographer.java:532)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:735)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.os.Handler.handleCallback(Handler.java:725)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.os.Handler.dispatchMessage(Handler.java:92)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.os.Looper.loop(Looper.java:137)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.app.ActivityThread.main(ActivityThread.java:5039)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at java.lang.reflect.Method.invokeNative(Native Method)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at java.lang.reflect.Method.invoke(Method.java:511)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
03-11 01:39:36.562: E/AndroidRuntime(1722):     at dalvik.system.NativeStart.main(Native Method)
03-11 01:39:36.562: E/AndroidRuntime(1722): Caused by: java.lang.ClassCastException: android.widget.RelativeLayout cannot be cast to android.widget.TextView
03-11 01:39:36.562: E/AndroidRuntime(1722):     at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:379)
03-11 01:39:36.562: E/AndroidRuntime(1722):     ... 35 more
03-11 01:39:36.682: D/dalvikvm(1722): GC_CONCURRENT freed 188K, 4% free 6367K/6596K, paused 90ms+4ms, total 255ms
03-11 01:39:40.702: I/Process(1722): Sending signal. PID: 1722 SIG: 9
03-11 01:39:41.192: E/Trace(1747): error opening trace file: No such file or directory (2)
03-11 01:39:41.992: D/libEGL(1747): loaded /system/lib/egl/libEGL_emulation.so
03-11 01:39:42.092: D/(1747): HostConnection::get() New Host Connection established 0x556a6180, tid 1747
03-11 01:39:42.376: D/libEGL(1747): loaded /system/lib/egl/libGLESv1_CM_emulation.so
03-11 01:39:42.394: D/libEGL(1747): loaded /system/lib/egl/libGLESv2_emulation.so
03-11 01:39:42.674: W/EGL_emulation(1747): eglSurfaceAttrib not implemented
03-11 01:39:43.465: D/OpenGLRenderer(1747): Enabling debug mode 0 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T02:03:33.830

我怀疑问题出在：

```
list = new ArrayAdapter<String>(this,R.layout.settings,items); 
```

请尝试替换`R.layout.settings`为`android.R.layout.simple_spinner_item`

第二个参数是一个资源标识符，它应该指向`TextView`with `id="@android/text1"`（这是 Android 所期望的）

`android.R.layout.simple_spinner_item`对应于`TextView`位于 SDK 文件夹中的预定义布局（尝试查看安装 SDK 的文件夹：`<SDK_FOLDER>/platforms/<select_any_platform_by_api_level>/data/res/layout/simple_spinner_item.xml`，有一些非常不错的预定义布局，应该可以帮助您理解逻辑）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T02:08:02.707

由于 ArrayAdapter 需要一个 TextView，正如异常所说，您有两个选择：

1.  更改`R.layout.settings`为`android.R.layout.simple_spinner_item`。

2.  创建您自己的适配器子类，它会扩展您的自定义布局。

# macos - OSX上的clang：-finstrument-functions链接错误

> ID：15329969
> 
> 赞同：4
> 
> 时间：2013-03-11T01:42:55.537
> 
> 标签：macos, clang, instrumentation

我正在尝试使用`__cyg_profile_func_*`with`-finstrument-functions`在函数运行之前和之后进行特定检查（例如，检查 Mach 端口泄漏等）。这是在 OS X 上。

该代码已编写且功能齐全，但我有大量未定义的引用，例如，

```
std::__1::basic_ios<wchar_t, std::__1::char_traits<wchar_t> >::init(std::__1::basic_streambuf<wchar_t, std::__1::char_traits<wchar_t> >*) 
```

似乎可能正在发生某种内联，但仪器仍在尝试引用该函数的非内联版本。是否可以免除标准 C++ 库的检测？或者，可以在这种特殊情况下完全禁用 clang 的内联？

干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-11T16:49:22.250

在 gcc 中，`-finstrument-functions-exclude-file-list=stdlib/include`会做你想做的事。但是，它还没有在 clang 中实现（至少trunk 不识别这个选项）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-07T05:09:09.367

Clang 有一个`-finstrument-functions-after-inlining`在这种情况下可以使用的选项。是的，不幸的是，clang 不支持基于文件/目录禁用检测。如果检测太麻烦，那么更改标准 C++ 库的源代码以添加属性也可能会有所帮助。请参阅：[https ://stackoverflow.com/a/69474100/811335](https://stackoverflow.com/a/69474100/811335)

# ubuntu - Apache '您无权访问此服务器上的 xx'

> ID：15329974
> 
> 赞同：3
> 
> 时间：2013-03-11T01:43:26.523
> 
> 标签：ubuntu, apache2

我正在使用 ubuntu 12.04 和 apache（它们都是新的），我想添加一个新的虚拟目录，所以我修改了文件`/etc/apache2/sites-available/default`，添加了以下内容：

```
Alias /docs/ "/home/kk/workspace/javascript/maplib/"
<Directory "/home/kk/workspace/javascript/maplib/">
    Options Indexes MultiViews FollowSymLinks
    AllowOverride None
</Directory> 
```

然后我在浏览器中打开网址`http://localhost/docs/`，我收到以下消息：

```
You don't have permission to access /docs/ on this server. 
```

然后我认为这可能是由文件/文件夹权限引起的。所以我通过`read`以下方式向所有用户添加权限：

```
sudo chmod a+r /home/kk/workspace/javascript/maplib/ 
```

然后我跑

```
ls -ld ~/workspace/javascript/maplib/ 
```

我得到了这个：

```
drwxr--r-- 14 kk kk 4096 Mar 11 08:36 /home/kk/workspace/javascript/maplib/ 
```

正如您所看到的，每个用户都有权`read`访问该目录，但没有任何改变（我也收到了`403`消息）。

然后我尝试找到的许可，`/var/www`我得到：

```
drwxr-xr-x 2 root root 4096 Mar  8 15:33 /var/www 
```

似乎它只是将`execute`权限添加到文件夹，但我认为这不是问题。

那么发生了什么？

* * *

顺便说一句，为什么 apache 会识别`/docs`并`/docs/`使用两个不同的 url？既然我会`404`过`localhost/docs`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:03:51.447

在您的 Apache 安装中，使用 etc/apache2/envars 控制访问并在 etc/apache2/apache2.conf 中实现

在 /etc/apache2/apache2.conf 中，您会在文件的一半左右找到以下行。

```
#These need to be set in /etc/apache2/envars
    User ${APACHE_RUN_USER}
    Group ${APACHE_RUN_GROUP} 
```

在 /etc/apache2/envars 你会发现

```
export APACHE_RUN_USER=www-data
export APACHE_RUN_GROUP=www-data 
```

您希望网络服务器访问的目录需要在运行网络服务器的组中。我会说检查组权限并在必要时修复它们。如果您正确设置了这些，请返回并发布 Apache 访问日志。

# scons - 如何为 scons MSVSProject 构建器功能构建文件列表？

> ID：15329976
> 
> 赞同：1
> 
> 时间：2013-03-11T01:43:46.163
> 
> 标签：scons

我目前正在尝试类似的东西 -

```
projects = envsrc.MSVSProject(target = 'none' + env['MSVSPROJECTSUFFIX'],
srcs = Glob("src/*.cpp"),
incs = Glob("src/*.hpp"),
buildtarget = exe,
variant = 'Release') 
```

但是我得到 srcs 必须是字符串或字符串列表的错误，正确的方法是什么？src 是根目录中的一个文件夹，其中包含头文件和 cpp 文件，sconscript 位于根目录中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T13:59:57.613

当我试图了解为什么我在评论中建议的打印语句不起作用时，我发现了问题所在。

首先，在 Python 中打印字符串列表中所有字符串的有效方法如下：

```
', '.join(Sources) 
```

引号`', '`中的部分是字符串列表中元素之间的分隔符。

我意识到以下 SConstruct 摘录的问题：

```
sources = (Glob('src/dir1/*.cc')
+Glob('src/dir2/*.cc')
+Glob('src/dir3/*.cc'))

print sources
print ', '.join(sources) 
```

这给出了这个输出：

```
scons: Reading SConscript files ...
[<SCons.Node.FS.File object at 0x122e4d0>, <SCons.Node.FS.File object at 0x122e710>, <SCons.Node.FS.File object at 0x122e950>]
TypeError: sequence item 0: expected string, File found:
  File "/home/notroot/projects/sandbox/SconsGlob/SConstruct", line 10:
    print ', '.join(sources) 
```

那时我记得 SCons Glob() 函数返回的是节点（文件）列表，而不是字符串列表。根据[SCons 手册页](http://www.scons.org/doc/production/HTML/scons-man.html)（搜索 'glob(' ），用法如下：

```
Glob(pattern, [ondisk, source, strings]) 
```

字符串参数执行以下操作：

> strings 参数可以设置为 True （或任何等效值），以使 Glob() 函数返回表示匹配文件或目录的字符串，而不是节点......

MSVSProject() 构建器需要一个字符串列表，而不是节点。因此，如果您执行以下操作，它会按预期工作：

```
sources = (Glob('src/dir1/*.cc', strings=True)
+Glob('src/dir2/*.cc', strings=True)
+Glob('src/dir3/*.cc', strings=True))

print ', '.join(sources) 
```

这给出了以下输出：

```
scons: Reading SConscript files ...
src/dir1/main.cc, src/dir2/func2.cc, src/dir3/func3.cc
scons: done reading SConscript files.
scons: Building targets ...
scons: `.' is up to date.
scons: done building targets. 
```

# sql - 比较行日期

> ID：15329977
> 
> 赞同：-2
> 
> 时间：2013-03-11T01:43:47.427
> 
> 标签：sql, tsql

<2013-03-10> 我想知道是否有人可以帮助我：

我有一个 SQL 2008 数据库，其中有以下情况：

带有几列的表“表”

`Table.ID, Table.Card and Table.issuedate`

具有不同卡的相同 ID 可以有很多行，并且这些卡具有不同的发行日期。

我需要取出发行日期更接近的卡：

`Select Getdate()`

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T01:49:09.467

您可以尝试使用`DATEDIFF`：

```
SELECT ...
ORDER BY DATEDIFF(minute, Table.issuedate, GETDATE()) 
```

根据您的`issuedate`列是属于`date`还是`datetime`类型，您可能希望使用不同的日期部分。

[文档](http://msdn.microsoft.com/en-us/library/ms189794.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T03:50:16.700

你可以找这个

`select ID, Card, max(issuedate) from [table] group by ID, card`

# javascript - 为什么我的幻灯片在 epub 阅读器上有很多多余的空白页？

> ID：15329985
> 
> 赞同：0
> 
> 时间：2013-03-11T01:44:47.033
> 
> 标签：javascript, android, jquery, xhtml, epub

我正在开发一个 android epub 2 阅读器，我的阅读器运行流畅，除了在幻灯片上它总是有超过 5 页。我的幻灯片有 15 个高度为 270 像素的图像，我的第一个结论是我的幻灯片中的所有图像都增加了我的 epub 的总长度它被划分为 728px（我的 webview 的宽度），这就是为什么我形成一个条件，将图像的所有高度加起来然后我将它减去我的 epub 的总长度并划分为 728px 但答案不足以显示确切的页面。它只显示了 11 页而不是 12 页。

这是我的 Javascript 代码：

函数calculateOffset(firstLoad){

```
var offset = 0;
var pos = $('#' + pageEndMarker).position();
var slideshowImageHeight = 0;
var listLength = 0;
var slideshowExist = false;

    if(document.getElementById("slideshow")){       
    slideshowExist = true;
    var images, list;
            var ImageHeight = 0;
            slideshowExist = true;

            //This code is for getting all the ul elements with "slideshow" id
            //and total all the length of all the li element; 
    images = document.getElementById("slideshow");
    list = images.getElementsByTagName('li');
            // the answer is 15 becaused it has 15 list of images
    listLength = list.length;

    //this code is to compute the total height of the images.
    //I did subtract 1 on the listLength,because i will subtract the listLength with the value of 14 elements on the total epub length. so that only one image size will add to the total epub length and that will serve as the height of the entire slideshow.
    for(var i = 0; i < listLength-1; i++) {
        imgHeight += $("li").height();                         
        slideshowImageHeight = imgHeight;//the answer is 11648              

    }           
}

    if(pos!=null){
    var excessWidth = pos.left % desiredWidth;
    if(excessWidth > desiredWidth / 2) {
        offset = (pos.left + desiredWidth) - excessWidth;       
    } else {
        offset = pos.left - excessWidth;

                    //this code is to subtract the total slideshowImageHeight
                    if(slideshowExist){
                        //the offset should have a value of 8008 instead of 7878 to be come 12pages in android code
                        offset = offset - slideshowImageHeight;//11648 - 3780 = 7868
                    }
             }
     } 
```

这是我在android上的代码：

```
 public void setOffset(int offsetWidth) {      
    if (VibeGlobalData.mVibeReaderActivity != null) {
        VibeGlobalData.mVibeReaderActivity.getWebView().setOffsetWidth(
                offsetWidth);           
        int width = getWidth();         
        if (width > 0) {    
                            //this code divides the total offset from javascript 
            int pageSize = offsetWidth / width; // 7868 / 728 = 10.8076                 
            VibeGlobalData.mVibeBook.setCurrentPageSize(pageSize);//this code has a class that will get the total pageSize = 10.8076 then rounded to 10 then adds 1 = 11 pages;
        }
        VibeGlobalData.mVibeReaderActivity.sendHandlerMsg(
                VibeReaderActivity.GUIHandler.MSG_OFFSET_CHANGED, null);
    }
} 
```

这是我的 epub 2 的代码：但这已经调整为 width = 462px & height = 270px：

```
 <!-- SLIDESHOW--> 
    <div class="slideshow-wrap">
      <ul class="slideshow" id="slideshow">
        <li ><img src="assets/images/she-epow1_p47_slide1.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide2.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide3.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide4.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide5.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide6.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide7.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide8.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide9.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide10.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide11.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide12.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide13.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide14.png" style="width: 700px;" /></li>
        <li ><img src="assets/images/she-epow1_p47_slide15.png" style="width: 700px;" /></li>
      </ul>
      <nav class="slideshow-controls"> <a class="play">&#187;</a> </nav>
    </div> 
```

我观察到其他 epub 阅读器，一些阅读器只显示图像列表而不是幻灯片，其他阅读器也有同样的问题，它有 5 个多余的页面，而其他的根本不显示幻灯片.. epub 2 是否可以显示幻灯片没有任何错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T12:23:20.147

尝试添加

```
style="width: 700px; max-width:100%" 
```

`<img>`元素_

# backbone.js - Backbone Collection 没有方法 add（在 Coffeescript 中）

> ID：15329987
> 
> 赞同：2
> 
> 时间：2013-03-11T01:44:50.420
> 
> 标签：backbone.js, coffeescript

我正在使用 CoffeeScript 并且遇到了一个非常令人沮丧的错误。我有一个集合（我是从 ajax 调用填充的——不是`fetch()`——因为我需要调整返回的 JSON）

这是**收藏**

```
$ ->
  class AppName.Members extends Backbone.Collection
    model: AppName.Member 
```

和**模型**

```
$ ->
  class AppName.Member extends Backbone.Model 
```

很简单，对吧？最终，我将构建这些以获取非填充数据，但目前情况就是这样。现在在我**看来**

```
$ ->
  class AppName.TitleView extends Backbone.View
    template: JST['templates/title']
    initialize: ->
      @bind(@collection, 'add', @addOne);
      @bind(@collection, 'reset', @addAll);
      @bind(@collection, 'all', @render);
      $.ajax
        dataType: 'json'
        url: '/housemembers'
        success: (data, textStatus, jqXHR) ->
          for member in data.results[0].members
            model =   
                state : member.state
                first_name : member.first_name
                middle_name : member.middle_name
                last_name : member.last_name
                next_election : member.next_election
                party : member.party
            AppName.Members.add model

      @ 
```

让我丧命的是`AppName.Members.add model`失败了：

```
Uncaught TypeError: Object function Members() {
        Members.__super__.constructor.apply(this, arguments);
      } has no method 'add' 
```

但是当我期望Chrome中的元素时，构造函数上显然有一个`add`方法`Members()`！！！

事实上，加入 watch for 会`AppName.Members.__super__.add`返回一个函数回调！

那么这里发生了什么？为什么不是`AppName.Members`成熟的 Backbone 集合？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T02:22:58.723

[`add`](http://backbonejs.org/#Collection-add)是集合上的实例方法，但您正试图将其用作类方法。您需要先创建一个集合实例：

```
AppName.members = new AppName.Members 
```

然后将模型添加到实例中：

```
AppName.members.add model 
```

或者，如果您尝试将模型添加到`@collection`，请执行以下操作：

```
$.ajax
  #...
  success: (data, textStatus, jqXHR) =>
    #...
    @collection.add model 
```

# mysql - 更改 sql 查询以允许变量设置查询结果的日期范围

> ID：15329997
> 
> 赞同：0
> 
> 时间：2013-03-11T01:46:48.280
> 
> 标签：mysql, sql

我以前在 stackoverflow 上得到了用户 JW 的很大帮助，我需要解决一个 SQL 查询。但是，自他最初的回答以来，要求发生了一些变化。

我现在需要为网站后端的管理员用户提供选择报告需要涵盖的天数的选项，而不是查找过去 30 天内的结果的查询，因此 30 天可以是任何给定的数字现在。

我有一个 php 脚本和文本条目，用户可以在其中输入所需的天数，并计算返回 x 天数的日期。然后将该日期存储在变量中。我们在其他报告中使用相同的方法，并且效果很好。

JW 制定的原始查询是：

```
SELECT  c.customers_id
FROM    customers c 
INNER JOIN customers_info ci
ON c.customers_id = ci.customers_info_id 
LEFT JOIN codes_redeem_history pc 
ON c.customers_id = pc.customer_id
WHERE   pc.customer_id IS NULL
GROUP   BY c.customers_email_address 
HAVING  MAX(ci.customers_info_date_of_last_logon) <= subdate(now(),INTERVAL 30 DAY) 
```

我现在需要使用以下内容：

```
WHERE ci.customers_info_date_of_last_logon >= '" . $ndate . "' 
```

我不能把它代替 HAVING MAX 部分，因为它会创建一个 sql 语法错误

我确实尝试过：

```
WHERE   pc.customer_id IS NULL
AND WHERE ci.customers_info_date_of_last_logon >= '" . $ndate . "'
GROUP   BY c.customers_email_address 
```

但它没有用。有关信息，如果我选择 a10 天报告，$ndate 将是 '20130301'

谢谢，史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T02:17:28.870

哇，

我一定有我的愚​​蠢头脑......答案现在对我来说是如此明显。

```
WHERE   pc.customer_id IS NULL
AND ci.customers_info_date_of_last_logon >= '" . $ndate . "'
GROUP   BY c.customers_email_address 
```

不能使用，我们可以在哪里使用！！

# python - Web2py 自定义表单和 for 循环

> ID：15329999
> 
> 赞同：1
> 
> 时间：2013-03-11T01:47:11.240
> 
> 标签：python, web2py

我是 Web2py 的新手，所以我希望这不是一个太愚蠢的问题。

我有一个带有布尔值的水果数据库。

显然这是一长串水果，所以我希望它们按列排列，所以我使用了自定义表格。我还想对水果进行分组，即柑橘、浆果等。

我的想法是创建一个元组

```
{{berries = 'strawberries, bilberry, blackberry'}} 
```

然后运行一个for循环来填写表单字段，所以我尝试了

```
{{for berry in berries:}} 
{{=form.custom.widget[berry] }}
{{pass}} 
```

我只是看到很多“无”，我认为这是因为我的 form.custom 字符串错误，但我尝试了几种方法来解析它，但似乎都没有。

有没有更好的方法来做到这一点？

我的代码应该在视图还是控制器中？

传递变量以使循环和表单工作的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T02:22:13.323

```
berries = 'strawberries, bilberry, blackberry' 
```

不是元组——它只是一个字符串。因此，您的`for`循环正在遍历字符串中的每个字母。如果您在 中提供不存在的键`form.custom.widget[key]`，则返回`None`。相反，你想要：

```
berries = 'strawberries', 'bilberry', 'blackberry' 
```