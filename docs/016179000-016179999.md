# StackOverflow 问答 16179000-16179999

# c++ - 运算符 [] 重载 C++

> ID：16179000
> 
> 赞同：1
> 
> 时间：2013-04-23T20:55:12.243
> 
> 标签：c++, overloading, operator-keyword

所以，我必须为我正在编写的一个类编写两个版本的括号运算符。

详细信息：该类有一个私有变量，它是一个字符串数组。operator[] 的版本不同之处在于一个必须是 const，而另一个不是

我有点不确定这两个版本实际上有何不同，以及在调用时如何区分它们。

我目前写的那篇

```
string& MyClass::operator[](unsigned int index); 
```

只需返回索引处的字符串。

我的问题是，拥有一个 const 和一个非常量有什么意义？它们将有何不同？

编辑：由于我必须编写这些，每个函数中的代码是否相同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T20:57:34.640

正确的重载版本是：

1.  访问非 const MyClass 实例

    `std::string& MyClass::operator[](unsigned int index);`

2.  访问 const 或 temp MyClass 实例

    `const std::string& MyClass::operator[](unsigned int index) const;`

后者保证通过常量实例引用访问将不允许修改返回的`std::string`引用，但返回结果。

实现可能需要考虑您至少可以为容器添加新的（默认）字符串值以获取当前未知的索引值，并且您需要决定如何处理未知索引值以进行`const`访问（返回空字符串、抛出异常等.)。

# .net - JSON 序列化程序在反序列化失败时创建一个空对象而不是 null

> ID：16179006
> 
> 赞同：5
> 
> 时间：2013-04-23T20:55:24.700
> 
> 标签：.net, asp.net-mvc-4, asp.net-web-api, json.net

在 WebAPI 中，我注意到一个不一致的地方，它扰乱了我们的验证实践。如果您在 xml 中使用 POST 发送错误的正文/有效负载，反序列化会失败并且您会得到一个空指针。如果您以 JSON 格式发送错误的正文/有效负载，则会得到一个空对象。这是误导，我不喜欢它。有没有办法强制使用失败的 json 反序列化的空指针？

更新：我没有反序列化问题。我遇到的行为问题似乎是 DataContractSerializer 和 Json.net 序列化程序之间的差异。当 xml 反序列化失败时，payload 为空。但是，当 Json 无法反序列化时，它似乎正在实例化预期有效负载的默认实例。

错误的 xml 有效负载示例： ![在此处输入图像描述](https://i.stack.imgur.com/xKiTN.png)

使用错误 json 有效负载的相同调用示例（有效负载不为空。相反，它是有效负载类的默认实例）

![在此处输入图像描述](https://i.stack.imgur.com/xTbYd.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T21:25:15.747

默认情况下，Web.API`MissingMemberHandling.Ignore`使用`JsonMediaTypeFormatter`.

您需要将其设置为`MissingMemberHandling.Error`：

```
GlobalConfiguration.Configuration
   .Formatters.JsonFormatter
   .SerializerSettings.MissingMemberHandling = MissingMemberHandling.Error; 
```

你应该`null`在发送 JSON 时得到：

```
{
   "somenotexistingprop": ""
} 
```

但是，如果您发送一个完全空的 JSON 对象：`{}`那么您仍然会得到一个具有空属性的对象，而不是`null`. 因为`JsonConvert.DeserializeObject`如果它反序列化一个空的 JSON，则返回一个空对象（参见[github](https://github.com/JamesNK/Newtonsoft.Json/blob/master/Src/Newtonsoft.Json.Tests/Serialization/MissingMemberHandlingTests.cs#L142-151)的这个单元测试）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-02T06:01:37.373

在我的一位团队成员帮助我理解为什么会出现这种情况后，以下是关于这种情况的一些说明：

1.  默认情况下，我们在 Json 格式化程序上没有“MissingMemberHandling.Error”，因为这有助于在较新版本的客户端将具有额外成员的数据发送到旧版本的服务的情况下。旧版本的服务应该仍然能够接受这个请求并忽略额外的属性。此行为与 Xml 格式化程序的行为方式一致。

2.  @Sinaesthetic：如果您正在设置“MissingMemberHandling.Error”并且不想仅依赖“ModelState.IsValid”检查，那么您可以始终检查 ModelState 的 Keys 属性来确定您的请求是否由于缺少成员而确实无效或者是其他东西。

下面的例子：

```
public class Customer
{
    public int Id { get; set; }

    [MaxLength(5)]
    public string Name { get; set; }

    public Address Address { get; set; }
}

public class Address
{
    public string Line1 { get;set;}
}

//action
public void Post([FromBody]Customer customer)
    {
        if (!ModelState.IsValid)
        {
            ModelStateDictionary msd = new ModelStateDictionary();

            foreach (string key in ModelState.Keys)
            {
                if (ModelState[key].Errors.Count > 0)
                {
                    foreach (ModelError error in ModelState[key].Errors)
                    {
                        Exception ex = error.Exception;

                        if (ex != null 
                            && typeof(JsonSerializationException).IsAssignableFrom(ex.GetType()) 
                            && ex.Message.StartsWith("Could not find member"))
                        {
                            msd.AddModelError(key, ex);
                        }
                    }
                }
            }

            if (msd.Count > 0)
            {
                throw new HttpResponseException(Request.CreateErrorResponse(HttpStatusCode.BadRequest, msd));
            }
        }

        //process the supplied customer
    } 
```

# java - 在关联矩阵中查找路径

> ID：16179008
> 
> 赞同：0
> 
> 时间：2013-04-23T20:55:35.353
> 
> 标签：java, matrix, graph, vertex

在关联矩阵中，我们有：

```
 e1 e2 e3 e4 e5 e6
v1 1  1  0  0  0  0
v2 0  0  1  1  0  1
v3 0  0  0  0  1  1
v4 1  0  1  0  0  0
v5 0  1  0  1  1  0 
```

要找到一条路径，我们应该找出边 i 的最后一个顶点是否是另一条边的起点，最后一条边的最后一条是否是第一条边的第一条。

有人可以帮我找到解决方案吗？我非常了解它是什么，但不知道如何实现它！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T22:47:49.323

你确定什么是路径？你想知道是否可以只访问一次所有节点吗？

搜索路径的一般方法有两种：[深度优先](http://en.wikipedia.org/wiki/Depth-first_search)或[广度优先](http://en.wikipedia.org/wiki/Breadth-first_search)。如果您查看一些示例，那么您自己实现应该不会太难。

# html - 使用表格裁剪 SWF？

> ID：16179012
> 
> 赞同：2
> 
> 时间：2013-04-23T20:55:55.797
> 
> 标签：html, css, flash

我正在重做我们公司的网站，并且我必须使用一个较旧的 Flash*文件*。（是的，其中之一）问题是，在旧网站上，swf 比边界框大，所以他们在 swf 文件内做了一个边框，并使用表格来“裁剪”边缘。所以，当我把它放在漂亮闪亮的新网站上时，我的文件中间有一个丑陋的边框。

我认为这就像将对象嵌入代码设置为比周围的框更大的大小一样简单，并且在 Chrome 中有效，但在 Firefox 或 IE 中无效。

```
<td style="overflow: hidden;" align="left" valign="top" width="250" height="180">    
<object style="margin: 0px; padding: 0px; z-index: 1;" width="279" height="180" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">
<param name="Movie" value="/HolidayVideo120108.swf" />
<param name="loop" value="false" />
<embed style="margin: -10px; padding: 0px; z-index: 1;" width="279" height="180" type="application/x-shockwave-flash" src="/HolidayVideo120108.swf" _cx="7381" _cy="4762" Movie="/HolidayVideo120108.swf" Src="/HolidayVideo120108.swf" loop="false" />
</object>
</td> 
```

原始页面在这里：[http ://holidaysigns.com](http://holidaysigns.com)

新页面在这里：[http ://holidaysigns.com/wp](http://holidaysigns.com/wp)

对不起，我们还在装修。

我已经玩了一段时间了，但我想不出一个适用于所有三种主要浏览器的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T15:23:52.647

我想通了是什么导致了这一切如此糟糕……

从浏览器移动到浏览器，页面大小正在发生变化。（因为浏览器窗口的大小不同。）随着页面整体大小的变化，我的表格单元格的大小发生了变化，即使它是固定的宽度/高度。

所以，我所做的就是在表格单元格中放置一个 div 并将其设置为固定大小。

```
<td align="left" valign="top">
<div style="overflow: hidden; padding: 0px; width: 250px; height: 162px;">
... embed swf ...
</div>
</td> 
```

现在一切都按预期工作。耶！

# python - Python - 从具有可变属性和行长的文件中读取数据

> ID：16179020
> 
> 赞同：3
> 
> 时间：2013-04-23T20:56:14.790
> 
> 标签：python

我试图找到在 Python 中解析文件并创建命名元组列表的最佳方法，每个元组代表一个数据实体及其属性。数据看起来像这样：

```
UI: T020  
STY: Acquired Abnormality  
ABR: acab   
STN: A1.2.2.2  
DEF: An abnormal structure, or one that is abnormal in size or location, found   
in or deriving from a previously normal structure.  Acquired abnormalities are  
distinguished from diseases even though they may result in pathological   
functioning (e.g., "hernias incarcerate").   
HL: {isa} Anatomical Abnormality

UI: T145   
RL: exhibits   
ABR: EX   
RIN: exhibited_by   
RTN: R3.3.2   
DEF: Shows or demonstrates.   
HL: {isa} performs   
STL: [Animal|Behavior]; [Group|Behavior]   

UI: etc... 
```

虽然有几个属性是共享的（例如 UI），但有些不是（例如 STY）。但是，我可以硬编码一个详尽的必要列表。
由于每个分组都由一个空行分隔，因此我使用了 split 以便可以单独处理每个数据块：

```
input = file.read().split("\n\n")
for chunk in input:
     process(chunk) 
```

我见过一些方法使用字符串查找/拼接、itertools.groupby 甚至正则表达式。我正在考虑做一个 '[AZ]*:' 的正则表达式来查找标题的位置，但我不确定如何在到达另一个标题之前拉出多行（例如在 DEF 之后的多行数据第一个示例实体）。

我很感激任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:23:40.297

```
source = """
UI: T020  
STY: Acquired Abnormality  
ABR: acab   
STN: A1.2.2.2  
DEF: An abnormal structure, or one that is abnormal in size or location, found   
in or deriving from a previously normal structure.  Acquired abnormalities are  
distinguished from diseases even though they may result in pathological   
functioning (e.g., "hernias incarcerate").   
HL: {isa} Anatomical Abnormality
"""

inpt = source.split("\n")  #just emulating file

import re
reg = re.compile(r"^([A-Z]{2,3}):(.*)$")
output = dict()
current_key = None
current = ""
for line in inpt:
    line_match = reg.match(line) #check if we hit the CODE: Content line
    if line_match is not None:
        if current_key is not None:
            output[current_key] = current #if so - update the current_key with contents
        current_key = line_match.group(1)   
        current = line_match.group(2)
    else:
        current = current + line   #if it's not - it should be the continuation of previous key line

output[current_key] = current #don't forget the last guy
print(output) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T21:30:56.217

我假设如果您在多行上有字符串跨度，您希望用空格替换换行符（并删除任何额外的空格）。

```
def process_file(filename):
    reg = re.compile(r'([\w]{2,3}):\s') # Matches line header
    tmp = '' # Stored/cached data for mutliline string
    key = None # Current key
    data = {}

    with open(filename,'r') as f:
        for row in f:
            row = row.rstrip()
            match = reg.match(row)

            # Matches header or is end, put string to list:
            if (match or not row) and key:
                data[key] = tmp
                key = None
                tmp = ''

            # Empty row, next dataset
            if not row:
                # Prevent empty returns
                if data:
                    yield data
                    data = {}

                continue

            # We do have header
            if match:
                key = str(match.group(1))
                tmp = row[len(match.group(0)):]
                continue

            # No header, just append string -> here goes assumption that you want to
            # remove newlines, trailing spaces and replace them with one single space
            tmp += ' ' + row

    # Missed row?
    if key:
        data[key] = tmp

    # Missed group?
    if data:
        yield data 
```

这个生成器在每次迭代中都返回`dict`对`UI: T020`（并且总是至少一个项目）。

由于它使用生成器和连续读取，它应该是大文件的有效事件，它**不会**一次将整个文件读入内存。

这是一个小演示：

```
for data in process_file('data.txt'):
    print('-'*20)
    for i in data:
        print('%s:'%(i), data[i])

    print() 
```

和实际输出：

```
--------------------
STN: A1.2.2.2
DEF: An abnormal structure, or one that is abnormal in size or location, found in or deriving from a previously normal structure.  Acquired abnormalities are distinguished from diseases even though they may result in pathological functioning (e.g., "hernias incarcerate").
STY: Acquired Abnormality
HL: {isa} Anatomical Abnormality
UI: T020
ABR: acab

--------------------
DEF: Shows or demonstrates.
STL: [Animal|Behavior]; [Group|Behavior]
RL: exhibits
HL: {isa} performs
RTN: R3.3.2
UI: T145
RIN: exhibited_by
ABR: EX 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:38:47.710

```
import re
from collections import namedtuple

def process(chunk):
    split_chunk = re.split(r'^([A-Z]{2,3}):', chunk, flags=re.MULTILINE)
    d = dict()
    fields = list()
    for i in xrange(len(split_chunk)/2):
        fields.append(split_chunk[i])
        d[split_chunk[i]] = split_chunk[i+1]
    my_tuple = namedtuple(split_chunk[1], fields)
    return my_tuple(**d) 
```

应该做。我想我会这样做`dict`——你为什么如此依恋 a `namedtuple`？

# javascript - d3.js 为 x 轴指定文本

> ID：16179021
> 
> 赞同：14
> 
> 时间：2013-04-23T20:56:16.460
> 
> 标签：javascript, d3.js, axis-labels

我的 x 轴目前有编号的刻度。*我希望用我的对象中的数据（特别是关键字*值）替换刻度。我将如何做到这一点？

[**我有一个工作小提琴**](http://jsfiddle.net/enigmarm/juY5E/6/)

```
var dataset = [
            {"keyword": "payday loans", "global": 1400000, "local": 673000, "cpc": "14.11"},
            {"keyword": "title loans", "global": 165000, "local": 160000, "cpc": "12.53" },
            {"keyword": "personal loans", "global": 550000, "local": 301000, "cpc": "6.14"},
            {"keyword": "online personal loans", "global": 15400, "local": 12900, "cpc": "5.84"},
            {"keyword": "online title loans", "global": 111600, "local": 11500, "cpc": "11.74"}
        ];

var xAxis = d3.svg.axis()
    .scale(xScale)
    .orient("bottom");
// xAxis
svg.append("g") // Add the X Axis
    .attr("class", "x axis")
    .attr("transform", "translate(0," + (h) + ")")
    .call(xAxis);
//xAxis Label
svg.append("text") 
    .attr("transform", "translate(" + (w / 2) + " ," + (h + margin.bottom - 5) +")")
    .style("text-anchor", "middle")
    .text("Keyword"); 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-04-23T21:08:36.560

实现这一点的最简单方法是`tickFormat`为您的轴设置功能：

```
var xAxis = d3.svg.axis()
    .scale(xScale)
    .tickFormat(function(d) { return dataset[d].keyword; })
    .orient("bottom"); 
```

您可能需要稍微调整宽度以适合标签（或[旋转它们](http://www.d3noob.org/2013/01/how-to-rotate-text-labels-for-x-axis-of.html)）。

执行此操作的“正确”方法是将您的域值指定`xScale`为关键字而不是数组索引。然后，您将不得不更改所有其他使用的代码`xScale`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-08-16T02:56:51.430

这称为序数轴，请查看[创建者的示例](http://bl.ocks.org/mbostock/3259783)

# java - Jasper 报告 SQL 查询中的填充参数

> ID：16179026
> 
> 赞同：0
> 
> 时间：2013-04-23T20:56:45.527
> 
> 标签：java, sql, jasper-reports, datasource, resultset

我有一个基于 SQL 查询生成报告的 Web 应用程序。这些 SQL 查询具有 Jasper 报告参数（即 $P{Param}）。

在我的 Java 代码中，我使用 PreparedStatement 来执行查询并返回结果集。我使用此结果集并将其更改为 JRResultSetDataSource 以传递给 JasperFillManager.fillReport(JasperReport, parameters, dataSource)。

我使用数据源而不是连接的原因是我可以在 PreparedStatement 上使用 setQueryTimeout。

我的问题是我需要一种方法来用参数映射值填充查询的参数。有没有内置的方法来做到这一点？

前任。

```
rawSqlString = "SELECT * FROM TABLE WHERE ROW1 = $P{Param}";
filledSqlString = somefunction(sqlString);
ResultSet rs = sqlStatement.executeQuery(filledSqlString); 
```

我不能使用“rawSqlString”，因为它有 $P{Param}。

或者，是否有一种数据源可以简单地存储我可以传递给 JasperFillManager 的未填充 SQL 查询？

通常 JasperFillManager 会处理此问题，但我希望我的查询超时，因此我需要使用 setQueryTimeout，并以某种方式将其转换为 Jasper 可以处理的格式。

# java - Java utils二进制搜索未找到所有值

> ID：16179029
> 
> 赞同：0
> 
> 时间：2013-04-23T20:56:59.193
> 
> 标签：java, binary-search

我正在尝试在数组中搜索一个值，并决定使用内置的二进制搜索来执行此操作。我有一堂课：

```
import java.util.*;
public class Charge {
private int isAcct;
private int[] acctNumbers = {5658845,4520125,7895122,8777541,8451277,
1302850,8080152,4562555,5552012,5050552,7824577,
                    1250255,1005231,6545231,3852085,7576651,7881200,
                    4851002};

public Charge(int aNum) {
    isAcct = aNum;
}
public Boolean isValidAcctNumber() {
    int m = Arrays.binarySearch(acctNumbers, isAcct);
    if (m == -1)
        return false;
    else
        return true;
}
} 
```

和一个测试：

```
import java.util.Scanner;
public class ChargeTest {
public static void main(String[] args){
    Scanner scan = new Scanner(System.in);
    System.out.println("What is your account number?: ");
    int num = scan.nextInt();
    Charge charge = new Charge(num);
    System.out.println(charge.isValidAcctNumber());

    if (charge.isValidAcctNumber() == false) {
        System.out.println("Your account "+num+" is not a valid account");
    } else  {
        System.out.println("Your account "+num+" is a valid account");
    }
} 
```

}

这适用于某些数字，例如 4851002，但不适用于其他数字，例如 1302850。我真的不知道为什么。我很可能只是手动实现二进制搜索，但我对为什么这不起作用感到困惑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T20:58:13.597

[二进制搜索仅适用于已排序](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#binarySearch%28int%5b%5d,%20int%29)的数组。

引用自`Arrays.binarySearch`javadoc：

> 使用二进制搜索算法在指定的整数数组中搜索指定的值。在进行此调用之前，必须对数组进行排序（如通过 sort(int[]) 方法）。如果未排序，则结果未定义。如果数组包含多个具有指定值的元素，则无法保证会找到哪一个。

如果它还没有排序，那么它不会找到一些数字。

在尝试任何二进制搜索之前对其进行[排序：](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#sort%28int%5b%5d%29)

```
Arrays.sort(acctNumbers); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T20:58:04.813

二进制搜索需要一个排序数组。

你可以：

*   按排序顺序提供数组
*   或者使用[Arrays.sort()对其进行排序](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#sort%28int%5B%5D%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:06:11.347

如果 Java 使用链接，它看起来像

```
if ( Arrays.sort(acctNumbers).find( number ) ) 
```

现在你必须做

```
List l = Arrays.sort(acctNumbers);
// decide on 
Arrays.binarySearch( l, number ); 
```

# css - 主要内容 div 置顶

> ID：16179031
> 
> 赞同：0
> 
> 时间：2013-04-23T20:57:14.327
> 
> 标签：css, html

嗨，我正在尝试为我的网站制作维护页面，但是当我尝试通过使用将主要内容 div 放在中间时，`margin: auto;`它似乎保持在顶部，唯一的方法是使用`<br />`但我'我不想使用它，因为它看起来很乱所以我想知道你是否有任何想法有什么问题

HTML：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<link href="style/style.css" rel="stylesheet" type="text/css" />
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
</head>

<body lang="en">
<div class="alert">Do you want advertsing space? Contact us: <b>advertising@chattrd.com</b></div>

<div class="topBar">
    <div class="topBarcontainer">
        <img class="logo" src="images/logo.png" alt="Chattrd home">
    </div>
</div>

<div id="navigationBar">
  <ul> 
    <li><a href="index.htm">Home</a></li> 
    <li><a href="aboutus.htm">About us</a></li> 
    <li><a href="contactus.htm">Contact us</a></li>
  </ul>
</div>
<div id="mainContent"></div>
</body>
</html> 
```

CSS：

```
 body {
    background: #F7F7F7;
    font-family:Tahoma, Geneva, sans-serif;
    margin: 0;
    padding: 0;
}
.alert {
    font-size: 10px;
    color: #FFF;
    background: #1f1f1f;
    height: 14px;
    padding-left: 10px;
    font-family: Arial;
    white-space: nowrap
}
.topBar {
    background: #06C;
    height: 40px;
}
#navigationBar {
    background: #1f1f1f;
    height: 28px;
    color: white;
    font-family: 'Open Sans';
}
.topBarcontainer{
    margin: auto;
    width: 1000px;
}
.logo {
    padding: 7px;
    height: 24px;
    width: 98px;
}
#navigationBar ul { 
    margin: 0;
    padding: 3px;
    list-style-type: none;
    text-align: center;
    } 

#navigationBar ul li {  
    display: inline; 
    } 

#navigationBar ul li a { 
    text-decoration: none; 
    padding: .2em 1em; 
    color: #fff; 
    } 

#navigationBar ul li a:hover { 
    color: #FFF; 
    background-color: #06C;
    }
#mainContent {
    margin: auto;
    width: 500px;
    height: 200px;
    border: 1px solid #D8D8D8;
    border-radius: 5px;
    background: #E6E6E6;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T20:59:41.210

垂直居中将不起作用，因为没有任何东西可以居中 -`body`默认情况下，与所有 HTML 元素一样，它将只是容纳其内容所需的高度。

由于您的主要内容是固定大小的，您可以简单地使用绝对定位来解决它：

```
#mainContent {
    width: 500px;
    height: 200px;
    position:fixed;
    left:50%;
    top:50%;
    margin:-100px 0 0 -250px;
    border: 1px solid #D8D8D8;
    border-radius: 5px;
    background: #E6E6E6;
} 
```

[为您的乐趣而摆弄。](http://jsfiddle.net/A5N8L/)

# bash - 来自文件名的挂载点 - 可移植方式

> ID：16179032
> 
> 赞同：3
> 
> 时间：2013-04-23T20:57:16.140
> 
> 标签：bash, shell, filesystems, mount, mount-point

想要制作一个脚本（称为`getmpoint`），它将从任何文件名返回挂载点。

第一个想法，例如：从`df`or 解析输出`fstab`并不像看起来那么容易，因为例如：

```
getmpoint ../../../some/path/tmp/somefile
getmpoint /tmp/somesymlink   #and want get the mountpoint where the real file is
getmpoint / 
```

我有一些使用`stat`（获取设备）的想法 - 但我迷路了。需要一些指示如何解决这个问题。

另一个问题是[Freebsd-stat](http://www.unix.com/man-page/FreeBSD/1/stat/)和[Linux-stat](http://linux.die.net/man/1/stat)`stat`上的命令不同。这里有便携的方式吗？

同样，怎么样：

```
getmpoint /some/real/path/up/to/here/but/nonexistent_file 
```

只从路径获取挂载点会很好 - 没有文件存在 - 所以没有`stat`.

有什么建议吗？（我可能自己可以制作一个脚本 - 但需要一些指导如何做......）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:19:52.320

尝试这个：

*getmpoint.sh，期望文件名作为参数*

```
#!/bin/bash

for path
do
    orig=$path

    #find the existing path component
    while [ ! -e "$path" ]
    do
        path=$(dirname "$path")
    done

    #get a real file from a symlink
    [ -L "$path" ] && path=$(readlink "$path")

    # use "portable" (df -P)  - to get all informatons
    # 512-blocks      Used Available Capacity  Mounted on
    read s512 used avail capa mounted <<< $(df -P "$path" | awk '{if(NR==2){ print $2, $3, $4, $5, $6}}')

    echo "Filename: $orig"
    echo "Mounted: $mounted"
    echo "Available blocks: $avail"
done 
```

# javascript - 在 HTML5 画布上绘制多边形时出错

> ID：16179043
> 
> 赞同：2
> 
> 时间：2013-04-23T20:57:45.177
> 
> 标签：javascript, html, html5-canvas

我有以下代码可以在单击按钮时在 HTML5 画布上绘制任何多边形。用户提供半径、边、x 和 y 坐标。应使用边绘制任何正多边形。首先，我们使用 moveTo() 移动到周边，然后根据边使用 lineTo() 绘制线条。

js.js

```
function drawPolygon() {
var numberOfSides = prompt("Enter number of sides");
var Xcenter = prompt("Enter x");
var Ycenter = prompt("Enter y");
var size = prompt("Enter radius");

var con=document.getElementById("myCanvas");
var cxt=con.getContext("2d");

cxt.beginPath();
cxt.moveTo (Xcenter +  size * Math.cos(0), Ycenter +  size *  Math.sin(0));          

for (var i = 1; i <= numberOfSides;i += 1) {
cxt.lineTo (Xcenter + size * Math.cos(i * 2 * Math.PI / numberOfSides), Ycenter + size * Math.sin(i * 2 * Math.PI / numberOfSides));
}

cxt.strokeStyle = "#000000";
cxt.lineWidth = 1;
cxt.stroke();

}
function registerEvents(){ 
var poly = document.getElementById("polygon");
poly.addEventListener( "click", drawPolygon, false); 
}
window.addEventListener('load', registerEvents, false); 
```

提供输入后，画布上没有绘制任何内容。我的代码是错误的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:04:11.187

您的数学运算错误，因为您没有将输入转换为数值。

例如，除非和是数值`Ycenter + size * Math.sin(0)`，否则不会返回正确的结果。`Ycenter``size`

你可能应该做这样的事情：

```
var Xcenter = parseFloat(prompt("Enter x"));
var Ycenter = parseFloat(prompt("Enter y"));
var size = parseFloat(prompt("Enter radius")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-25T23:45:02.570

这是一个甚至支持顺时针/逆时针绘制的功能，您可以使用非零缠绕规则控制填充。

[**这是有关其工作原理的完整文章以及更多内容。**](http://www.storminthecastle.com/2013/07/24/how-you-can-draw-regular-polygons-with-the-html5-canvas-api/)

```
// Defines a path for any regular polygon with the specified number of sides and radius, 
// centered on the provide x and y coordinates.
// optional parameters: startAngle and anticlockwise

function polygon(ctx, x, y, radius, sides, startAngle, anticlockwise) {
  if (sides < 3) return;
  var a = (Math.PI * 2)/sides;
  a = anticlockwise?-a:a;
  ctx.save();
  ctx.translate(x,y);
  ctx.rotate(startAngle);
  ctx.moveTo(radius,0);
  for (var i = 1; i < sides; i++) {
    ctx.lineTo(radius*Math.cos(a*i),radius*Math.sin(a*i));
  }
  ctx.closePath();
  ctx.restore();
}

// Example using the function.
// Define a path in the shape of a pentagon and then fill and stroke it.
context.beginPath();
polygon(context,125,125,100,5,-Math.PI/2);
context.fillStyle="rgba(227,11,93,0.75)";
context.fill();
context.stroke(); 
```

# stripe-payments - Stripe Connect 访问令牌的格式是什么？

> ID：16179046
> 
> 赞同：1
> 
> 时间：2013-04-23T20:57:56.097
> 
> 标签：stripe-payments

我正在尝试使用条带连接，并且我想确保收到条带访问令牌，我可以使用这些令牌代表条带用户进行收费。我在测试环境中获得的访问令牌如下所示：sk_test_VyqtfZ6IIPMR1dyY0Po9O29i

这是它们的格式吗？有没有办法可以对这个令牌进行测试收费？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T18:46:15.287

在我看来，这更像是`Test Secret Key`一个内部 API 密钥，而不是卡令牌。要生成卡令牌，您应该使用`createToken`Stripe 的[JavaScript API](https://stripe.com/docs/stripe.js)中的函数。完成后，您可以在创建费用时传递该令牌而不是信用卡详细信息。 [以下](https://stripe.com/docs/api#create_charge)是 API 中的相关文档，以及感兴趣的部分：

> **卡：可选**，*卡或客户是必需的，但不是两者都需要*。一张要收费的卡。该卡可以是令牌，例如 Stripe.js 返回的令牌，也可以是包含用户信用卡详细信息的字典

根据您的具体需求，您可能会考虑查看[Temboo 的 Stripe SDK](https://temboo.com/library/Library/Stripe/)，它降低了创建客户、收费、订阅等操作的复杂性。免费的 Temboo SDK 提供[多种流行语言](https://temboo.com/download)，是一种插入式解决方案.

*全面披露：我是 Temboo 员工*

# syntax - 使用 bat 文件删除多个文件名的第一个字符 - 什么是 ~%X%,？

> ID：16179049
> 
> 赞同：0
> 
> 时间：2013-04-23T20:57:59.067
> 
> 标签：syntax, batch-file, rename

我需要创建一个脚本，它将从大量文件（具有不同名称）中删除前六个字符。我从另一个问题尝试了这个例子，但我想更好地理解它：

```
@echo off
setlocal enabledelayedexpansion
set X=3
for %%f in (*) do if %%f neq %~nx0 (
    set "filename=%%~nf"
    set "filename=!filename:~%X%,-%X%!"
    ren "%%f" "!filename!%%~xf"
)
popd 
```

我可以看到，在 -%X%! 中修改 X！我实际上从文件夹中的所有文件中修剪了 X 个第一个字符。我不知道 ~%X%, 是什么 - 我只能看到如果它不是大于 0 的数字，则脚本将不会运行。我也不知道 set X=3 是什么 - 我只能看到它是否存在于 bat 文件中没有区别。谁能给我解释一下这个文件的语法？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T23:41:24.310

该方法称为子字符串。

你可以在这里看到很多例子和解释：http: [//ss64.com/nt/syntax-substring.html](http://ss64.com/nt/syntax-substring.html)

第一个数字是起始索引，第二个数字是最后一个索引。

例子：

```
@echo off
Set "Filename=TestFile.txt"
Set "Filename=%Filename:~0,-4%"
Echo %FILENAME%
pause 
```

在该代码中，我们从索引“0”（字符串的第一个字母）开始读取，并在“-4”处停止读取，然后我们从 0 减去 -4，因此结果是：“ **TestFile** ”

我希望这有帮助。

# java - 在 Java 中使用并发使用准备好的语句

> ID：16179050
> 
> 赞同：0
> 
> 时间：2013-04-23T20:58:01.130
> 
> 标签：java, database, multithreading, concurrency, connection

我有一个应用程序可以处理文件中的大量数据并将这些数据放入数据库中。它是单线程的；所以我创建了一个数据库连接，在该连接上创建准备好的语句，然后在处理数据时重用这些语句。我可能会处理数千个文件，并且可以一遍又一遍地重用相同的准备好的语句，但只更新值。这一直工作得很好，但是......

它已经到了处理文件花费太长时间的地步，而且由于它们都是独立的，我想同时处理它们。问题是每个文件可能使用 10 个准备好的语句。所以现在对于每个文件，我正在建立一个新的数据库连接（即使它们是池化的），设置这 10 个准备好的语句，然后关闭它们并关闭每个文件的连接；所以这种情况发生了成千上万次，而不是以前的一次。

我实际上没有做任何计时，但我很好奇这种使用连接和准备好的语句是否是最好的方法？一遍又一遍地设置这些准备好的语句真的很昂贵吗？有一个更好的方法吗？我读到您不想在线程之间共享连接，但也许有一个我没有想到的更好的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:22:32.337

我建议你使用 C3P0 API 检查它 ht​​tp [://www.mchange.com/projects/c3p0/](http://www.mchange.com/projects/c3p0/)

增强性能是连接和语句池的目的，特别是如果您为每个客户端访问获取非池连接，这是 c3p0 库的主要目标。

这部分取自 C3P0 Doc 关于线程和重负载：

> numHelperThreads 和 maxAdministrativeTaskTime 有助于配置 DataSource 线程池的行为。默认情况下，每个 DataSource 只有三个关联的帮助线程。如果性能似乎在重负载下拖累，或者如果您通过 JMX 或直接检查 PooledDataSource 观察到“待处理任务”的数量通常大于零，请尝试增加 numHelperThreads。maxAdministrativeTaskTime 对于遇到无限期挂起的任务和“APPARENT DEADLOCK”消息的用户可能很有用。

此外，我建议您使用 user`Executor`和`ExecutorService`in (java.util.concurrent) 来池化您的线程。

如下所示：

```
Executor executor = Executors.newFixedThreadPool(int numberOfThreadsNeeded);
// Executor executor =Executors.newCachedThreadPool(); // Or this one

executor.execute(runnable);
.
.
.
etc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:01:24.563

> 如果这种使用连接和准备好的语句是最好的方法？一遍又一遍地设置这些准备好的语句真的很昂贵吗？

您可以肯定地一遍又一遍地重用连接和准备好的语句。您不必重新创建它们，并且对于连接，您当然不必每次都重新连接到数据库服务器。您至少应该使用数据库连接池。此外，您不能同时在多个线程中使用准备好的语句。而且我还认为，对于大多数数据库连接，您不能在不同的线程中使用相同的连接。

也就是说，执行一些分析器运行可能是有意义的，因为线程数据库代码通常提供最小的速度提升，因为您通常受到数据库服务器 IO 而*不是*线程的限制。如果您混合查询、插入和事务，这可能不是真的。如果您正在与数据库建立远程连接，您可能会获得一些并发性。

为了提高数据库操作的速度，请考虑在大量事务之前关闭自动提交，或者尽可能批量处理您的请求。

# python - 使用 C 扩展 Python - ImportError：无法映射

> ID：16179055
> 
> 赞同：2
> 
> 时间：2013-04-23T20:58:14.740
> 
> 标签：python, c, importerror, extending

我正在尝试用 C 扩展 Python。我的 C 代码编译并得到一个 .so 文件，但是在导入 Python 时，我收到此错误：

```
ImportError: dlopen(/Users/.../python/PYC/isprime.so, 2): no suitable image found.  Did find:
    /Users/.../python/PYC/isprime.so: can't map 
```

这是我的 C 代码：

```
#include <Python.h>
#include <stdio.h>

static PyObject *is_prime(PyObject *self, PyObject *args)
{
    int i;
    int num;
    int primes[] = {};
    PyArg_ParseTuple(args, "b b", &num, &primes);
    int max = num/2;

    if(num % 2 == 0) {
        return 0;
    } else {
        for(i=0; primes[i] <= max; i++) {
            if(num % primes[i] == 0) {
                return Py_BuildValue("i", 0);
            }
        }
        return Py_BuildValue("i", 1);
    }
}

static PyMethodDef is_primeMethods[] = {
    /* name, function, argument type, docstring */ 
    {"is_prime", is_prime, METH_VARARGS, "Detect primes"}, 
    /* An end-of-listing sentinel: */ 
    {NULL, NULL, 0, NULL}
};

PyMODINIT_FUNC 
init_isprime(void) 
{ 
    PyObject *m;
    m = Py_InitModule("is_prime", is_primeMethods);
}

int main(int argc, char *argv[])
{
    Py_SetProgramName(argv[0]);

    Py_Initialize();

    init_isprime();
} 
```

还有我的makefile：

```
PYLIB = /usr/bin 
PYINC = /usr/include/python2.5

isprime.so: isprime.c
    gcc isprime.c -g -I$(PYINC) -shared -L$(PYLIB) -m64 -lpython2.5 -o isprime.so

clean:
    rm -f isprime.so 
```

我到处搜索这个“无法映射”错误，但找不到任何东西。我正在运行 osx 10.6.8。任何人都可以解释一下吗？此外，所有这些样板函数是否也需要使其工作？提前致谢！

# c# - 使用 numericUpDown 在某些值上显示面板

> ID：16179056
> 
> 赞同：0
> 
> 时间：2013-04-23T20:58:16.080
> 
> 标签：c#, panel, visible, numericupdown

我在表单上有几个面板，我希望它们显示为对应于 numericUpDown 值。（即面板1在值为1时可见，面板1和2在数字为2时可见，面板1 2和3在值为3时可见，等等）

我可以使用现有代码使初始面板按预期运行，但后续面板并未按我的预期出现或消失。我不太清楚为什么。是不是因为 NUP 的值在更改时没有更新？

代码：

 ````
private void petNumNumericUpDown_ValueChanged(object sender, EventArgs e)

    {
        if ((petNumNumericUpDown.Value == 1) || (petNumNumericUpDown.Value == 2) ||(petNumNumericUpDown.Value == 3) || (petNumNumericUpDown.Value == 4) || (petNumNumericUpDown.Value == 5))
        {
            pet1Panel.Visible = true;
        }

        else
        {
            pet1Panel.Visible = false;
        }

        if((petNumNumericUpDown.Value == 2) || (petNumNumericUpDown.Value == 3) || (petNumNumericUpDown.Value == 4) || (petNumNumericUpDown.Value == 5))
        {
            pet2Panel.Visible = true;
        }

        else
        {
            pet2Panel.Visible = false;
        }
    } 
```

我希望这种情况一直持续到 5 点。任何关于我做错了什么的见解都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:02:59.300

您可以编写更简单的代码来实现您的目标：

```
pet1Panel.Visible = (petNumNumericUpDown.Value >= 1);
pet2Panel.Visible = (petNumNumericUpDown.Value >= 2);
... 
````

# web-services - JavaFX2：使用 Restful 服务

> ID：16179061
> 
> 赞同：0
> 
> 时间：2013-04-23T20:58:31.207
> 
> 标签：web-services, spring, rest, javafx-2

我正在尝试构建一种从 JavaFX 应用程序使用 RESTFul 服务的架构。要求是使用 spring 的 rest 模板（不要太紧张。如果 spring 不起作用，那么可能我可以看看 jersey 或 resteasy。

我的设置如下：

我的主类有一个下拉列表，列出了 RESTFul 服务中的值。

命中 RESTFul 服务的架构如下：

1.  我有一个客户端类，它为我提供了访问其余服务的服务类实例。

2.  在服务类中，我有各种针对 RESTFul 服务的方法。

    ```
    public MyService1()
    {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(
            MyConfig.class);
        context.registerShutdownHook();
    }

    @Autowired
    private RestOperations restTemplate;

    private final Logger   LOG = LoggerFactory.getLogger(MyService1.class);

    public List<MyObject> getMyObjects() throws IOException
    {
        HttpEntity<MultiValueMap<String, HttpEntity<?>>> request = new HttpEntity<MultiValueMap<String, HttpEntity<?>>>(
            createParts(), createMultiPartHeaders());

        Map<String, String> vars = new HashMap<String, String>();

        List<MyObject> myObjects = restTemplate.getForObject(
            "http://localhost:8080/my-webservices/objects", List.class, vars);

        return myObjects;
    } 
    ```

通过上述设置，我得到了异常：

```
Exception in Application start method
Exception in thread "main" java.lang.RuntimeException: Exception in Application start method
at com.sun.javafx.application.LauncherImpl.launchApplication1(LauncherImpl.java:403)
at com.sun.javafx.application.LauncherImpl.access$000(LauncherImpl.java:47)
at com.sun.javafx.application.LauncherImpl$1.run(LauncherImpl.java:115)
at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.NoClassDefFoundError: Could not initialize class org.springframework.beans.factory.BeanCreationException
at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:581) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-30T17:29:20.210

似乎您还没有添加包含“BeanCreationException”类的依赖库。请添加 spring 的 jar 文件作为该 JavaFX 项目的依赖项。

# android-ndk - 在 NDK 中使用“exec()”

> ID：16179062
> 
> 赞同：4
> 
> 时间：2013-04-23T20:58:32.380
> 
> 标签：android-ndk

我记得在某处读过，不建议在 NDK 编译的 C 代码中使用“exec”。

推荐的方法是什么？我们是否尝试将 EXEC 代码推送到 Java 空间？也就是说，JNI（或应用程序）会产生新进程，（并且在相关的地方将结果传递回 NDK）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-23T21:45:44.487

首先，不建议使用`fork`或`exec`。您的所有代码通常都应该存在于一个进程中，该进程是您的主要 Android 应用程序进程，由 Android 框架管理。任何其他进程都可能随时被系统杀死（尽管据我所知，实际上这在当前的 Android 版本中不会发生）。

据我了解，原因很简单，如果您要生成其他进程，Android 框架无法正确管理您的应用程序的生命周期和生命周期。

## `Exec`

您在这里别无选择，只能避免启动其他可执行文件。这意味着您需要将可执行代码转换为直接链接到应用程序的库，并使用正常的 NDK 函数调用进行调用，由 Java 代码中的 JNI 触发。

## `Fork`

比较困难。如果你真的需要一个多进程模型，并且想要符合规则，你需要安排 Android 框架从它的 Zygote 进程中分叉你。为此，您应该以不同的方式运行所有后台代码，该代码`Service`被声明为在`AndroidManifest.xml`.

将这一点发挥到极致，如果出于内存保护和隔离原因，您需要在不同进程中运行多个相同的代码实例，您可以执行 Android Chrome 所做的操作：

*   在子类中运行所有背景/分叉代码`Service`
*   创建多个子*类*
*   `AndroidManifest.xml`将这些子类中的每一个列为具有不同`process`属性的每个子类中的单独服务
*   在您的主代码中，准确记住您已启动和未启动的服务，并使用`startService`/管理它们`stopService`。

当然，如果您已经将本机代码变成了库而不是可执行文件，那么您可能就不需要`fork`了。唯一剩下的使用理由`fork`是实现内存保护/隔离。

## 在实践中

在实践中，很多应用程序忽略了所有这些并直接在其本机代码中使用`fork`/ 。`exec`目前，它至少适用于短期任务。

# ios - 捕获是否在 iOS 上点击了 Web 文本字段

> ID：16179067
> 
> 赞同：1
> 
> 时间：2013-04-23T20:58:49.380
> 
> 标签：ios, iphone, objective-c, uiwebview, uitextfield

在我的 iOS 应用程序中，我有一个`UIWebView`工作正常。我无法得到的是当用户点击显示网页中的文本字段时调用哪个函数。为了让我的问题更清楚：

如果我在 google 中显示`UIWebView`然后点击搜索栏，会`UIWebView`自动弹出键盘。我想知道如何`UIWebView`检测被点击的搜索栏。在这个水龙头上调用什么功能？

我确定不是

```
webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSMutableURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType 
```

方法，因为它没有导航到任何新页面。

# android - Android CalendarView 文本大小在 4.1 上太小

> ID：16179072
> 
> 赞同：3
> 
> 时间：2013-04-23T20:59:09.450
> 
> 标签：android, android-4.2-jelly-bean, calendarview

Jelly Bean 4.1 似乎存在一个错误，导致日期的文本大小在`CalendarView`高分辨率设备上过小。似乎它在 4.2 中已修复，但是否有任何解决方法使其在 4.1 设备上看起来更合理？

我试过这样的事情：

```
<CalendarView android:dateTextAppearance="@android:style/TextAppearance.Medium" /> 
```

但没有变化。

[屏幕截图 jellybean 4.1 http://android.googlecode.com/issues/attachment?aid=349320000000&name=date_too_small_gn.png&token=oky3Ymwfjqtj-Q2b1E1zi8ZEhMw%3A1366750079333&inline=1](http://android.googlecode.com/issues/attachment?aid=349320000000&name=date_too_small_gn.png&token=oky3Ymwfjqtj-Q2b1E1zi8ZEhMw%3A1366750079333&inline=1)

# c++ - 访问类型定义的指针数组的元素

> ID：16179073
> 
> 赞同：3
> 
> 时间：2013-04-23T20:59:12.163
> 
> 标签：c++, c, arrays, pointers

我在访问传递给函数的数组元素时遇到了一些问题。

```
#define N (128)
#define ELEMENTS(10)
typedef int (*arrayOfNPointers)[N]; 
```

`N`因此，如果这是正确的，那么它是一种描述指向 的指针数组的数据类型`int`。

后来我单独初始化我的数组，如下所示：

```
arrayOfNPointers myPtrs = { 0 };
int i;
for (i=0; i<N; i++) {
  myPtrs[i] = (int*)malloc(ELEMENTS);
} 
```

但是，这会失败并出现以下错误：

```
error: incompatible types when assigning to type 'int[128]' from type 'int *' 
```

所以，我的语法似乎有一些非常错误的地方。但是在另一段代码中，我正在修改一些此类结构的内容，我没有问题。

```
void doWork(void* input, void* output) {
   int i,m,n;
   arrayOfNPointers* inputData = (arrayOfNPointers*)input;
   int* outputData = (int*)output;

   for (m=0, n=0; n<nSamples; n++) {
      for (i=0; i<nGroups; i++) {
         outputData[m++] = (*inputData)[i][n];
      }
   }
} 
```

这个数组逻辑是不是被严重破坏了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T21:03:59.223

```
typedef int (*arrayOfNPointers)[N]; 
```

> 因此，如果这是正确的，它是一种描述 N 个指向 int 的指针数组的数据类型。

我认为这是一个指向 N 个整数数组的指针，而不是一个指向整数的 N 个指针数组......

这意味着以下行的行为不符合您的预期... myPtrs[i] = (int*)malloc(ELEMENTS); 因为 myPtrs 是指向 N 维数组（在本例中为 128 个整数的数组）的指针，所以 myPtrs[i] 是第 i 个 n 维数组。所以你试图分配一个指向数组的指针，这就是你得到消息的原因......

> 错误：从类型“int *”分配给类型“int [128]”时类型不兼容

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T21:13:03.833

我相信您正在寻找的是以下内容...

```
#define N 128
#define ELEMENTS 10
typedef int* arrayOfNPointers[N];

arrayOfNPointers myPtrs = { 0 };
int i;
for (i=0; i<N; i++) {
  myPtrs[i] = malloc(sizeof( int ) * ELEMENTS);
} 
```

您希望 arrayOfPointer 是一个包含 N 个指向 ELEMENTS 整数的指针的数组。此外，当您 malloc() 整数的空间时，您需要将 ELEMENTS 的数量乘以整数的大小。实际上，您分配的空间太小，无法容纳您尝试存储的数据。

您的 typedef 将 arrayOfPointer 声明为指向 N 个整数数组的指针。请记住使用左右阅读规则来理解您要声明的变量/类型是什么。因为你`(*arrayOfPointer)`在括号中没有任何东西在右边和一个指向左边的指针，所以 arrayOfPointer 是一个指向`[N]`(right) int (left) 的指针。不是你想要的。

另外...[不要在 C 中强制转换 malloc()](https://stackoverflow.com/questions/1565496/specifically-whats-dangerous-about-casting-the-result-of-malloc)！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-23T21:04:47.513

基于它的使用，`malloc()`它似乎是一个数组`int*`：

```
int* myPtrs[N];   /* Array of 'int*'. */ 
```

而不是指向`int[128]`数组的指针：

```
int (*myPtrs)[N]; /* Pointer to array of int[N]. */ 
```

是必须的。使用`malloc()`不正确，因为它为 10 个字节而*不是*10`int`秒分配内存。改成：

```
/* Casting result of malloc() is not required. */
myPtrs[i] = malloc(sizeof(int) * ELEMENTS); 
```

# mysql - mySQL 查询获取不匹配的记录

> ID：16179076
> 
> 赞同：0
> 
> 时间：2013-04-23T20:59:27.763
> 
> 标签：mysql

我有一个 sql 查询，我希望添加另一个条件，但我似乎无法让它工作。查询很简单：

```
SELECT DISTINCT monthly_returns.company_id
       FROM monthly_returns, paidreturns
       WHERE monthly_returns.company_id = paidreturns.company_id
       AND paidreturns.month =  '$cdate'
       AND paidreturns.paid =0 
```

但是，我还希望从在给定日期的支付回报中根本没有记录的每月回报中获取记录。我知道会是这样的

```
SELECT  *
FROM    monthly_returns
WHERE   monthly_returns NOT IN (SELECT * FROM paidreturns WHERE paidreturns.month =  '$cdate') 
```

paidreturns.paid =0 是未支付账单的地方，但同样，如果在paidreturns 中没有该日期的记录，则也不会支付账单。

架构

**支付回报表**

-ID

-company_id

-有薪酬的

-月

-全部的

**每月回报表**

-ID

-company_id

-wage_totals

-月

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:03:26.823

尝试这个：

```
SELECT
    DISTINCT monthly_returns.company_id
FROM
    monthly_returns
LEFT JOIN
    paidreturns
    ON monthly_returns.company_id = paidreturns.company_id
       AND monthly_returns.month = paidreturns.month
WHERE 
    monthly_returns.month = '$cdate'
    AND
        (
        paidreturns.paid = 0
        OR
        paidreturns.company_id IS NULL
        ); 
```

使用 a `LEFT JOIN`，您可以找到来自 的所有记录`monthly_returns`，无论它们是否与来自 的条目匹配`paidreturns`。

然后，通过添加`paidreturns.company_id IS NULL`到`WHERE`子句中，您可以在查询中包含那些不匹配的条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:02:31.243

```
select company_id
from
(
(

SELECT DISTINCT monthly_returns.company_id
   FROM monthly_returns, paidreturns
   WHERE monthly_returns.company_id = paidreturns.company_id
   AND paidreturns.month =  '$cdate'
   AND paidreturns.paid =0
)
union
(

SELECT  company_id
FROM    monthly_returns
WHERE   monthly_returns NOT IN (SELECT * FROM paidreturns WHERE paidreturns.month = '$cdate'
)
) as x 
```

# django - Django：django-secretballot MIDDLEWARE

> ID：16179080
> 
> 赞同：0
> 
> 时间：2013-04-23T20:59:52.040
> 
> 标签：django, package, django-middleware

添加 `'secretballot.middleware.SecretBallotMiddleware'`时`MIDDLEWARE_CLASSES`我不断收到以下错误：

`Exception Type: NotImplementedError`

`Exception Location: .../django_secretballot-0.2.3-py2.7.egg/secretballot/middleware.py in generate_token, line 11`

任何想法为什么？在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:09:38.057

这个错误的原因是 SecretBallotMiddleware 实际上是一个抽象类（[源代码](https://github.com/sunlightlabs/django-secretballot/blob/master/secretballot/middleware.py)），您需要对其进行子类化或使用已经实现的 SecretBallotIpMiddleware。有关详细信息，请参阅文档部分[MIDDLEWARE](https://github.com/sunlightlabs/django-secretballot#tokens-and-secretballotmiddleware)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:10:23.510

根据[docs](https://github.com/sunlightlabs/django-secretballot#tokens-and-secretballotmiddleware)，您不应该添加`secretballot.middleware.SecretBallotMiddleware`中间件。

从`SecretBallotIpMiddleware`或中选择`SecretBallotIpUseragentMiddleware`。

# syntax-highlighting - 在 CSS 中突出显示 PHP 代码

> ID：16179081
> 
> 赞同：0
> 
> 时间：2013-04-23T20:59:55.200
> 
> 标签：syntax-highlighting, phpstorm

如何在 PhpStorm 的 CSS 文件中启用 PHP 代码的识别和突出显示？

这些文件被命名`*.css`而不是`*.php`. 我无法更改它们（对环境/框架的限制/依赖）。

我知道[在 php 文件中突出显示 js-code](https://stackoverflow.com/questions/12781037/highlighting-js-code-inside-php-file)的可能性，但这需要扩展`php`是不可能的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T21:59:55.323

只需将 CSS 扩展名分配给 php 文件类型，然后在所有这些文件的设置/模板语言中将“外部”语言设置为 CSS。

# javascript - 在 JSON 中解析双引号

> ID：16179082
> 
> 赞同：0
> 
> 时间：2013-04-23T20:59:56.637
> 
> 标签：javascript, json

我正在尝试解析从第三方 API 接收到的一些 JSON。问题是一些 JSON 在引号内有引号，如下所示：

```
var json = '{"sentence": "My favorite sport is "dodgeball"." }'; 
```

我很确定浏览器将引用解释为

```
"My favorite sport is" 
```

然后在以下字符上遇到语法错误。我该如何避免这种情况？

**编辑：**我发布了问题的简化版本，但这是给我带来麻烦的实际代码片段（问题是用引号括起来的“ *Cool Vendor ”）：*

```
{"content":"Vana Workforce is the Cloud HR Company. We are a global provider of human capital software and service solutions specifically designed to the needs of small and medium enterprises delivered on-demand.

Developed on the industry's leading cloud platform Force.com, Vana Human Capital Management delivers one complete and integrated human capital management solution for global organizations form hire to retire including the core human resource system of record, benefits & compensation, absence management, performance and talent management, career and succession planning, workforce collaboration, and workforce analytics.

Founded in 2008, Vana Workforce has offices in Canada and the United States with customers on every continent, and was recently recognized by Gartner Research as a "Cool Vendor" for 2010.","val":"Description"} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:01:57.453

那不是有效的 JSON，所以你不能用标准方法来做。

您要么必须像这样转义引号：`"sport is \" "`否则您需要编写自己的消毒剂

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:01:09.843

那些引号应该被转义 -

```
"My favorite sport is \"dodgeball\"." 
```

如果这是一项真正的服务（不是家庭作业），这将正确完成。如果是家庭作业，那就去修复服务中的那个错误。

# windows - 用于 windows 的 Fortran Make 文件

> ID：16179083
> 
> 赞同：-3
> 
> 时间：2013-04-23T21:00:08.463
> 
> 标签：windows, command-line, makefile, fortran, fortran90

请你能帮我如何将 Linux 的 FORTRAN make 文件转换为 windows 下的 FORTRAN 的 make 文件吗？

我的 Linux 制作文件在这里 [https://www.dropbox.com/s/ui6pbtwmumc5zpz/makefile.txt](https://www.dropbox.com/s/ui6pbtwmumc5zpz/makefile.txt)

另外我不知道我必须在命令窗口中编写的命令是什么，而在 Linux 中我运行它就像

make clean 和 make 命令

感谢您的时间和帮助

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-26T18:20:59.080

你总是可以使用scons。只需在你的 windows 机器上安装 python，下载 scons 脚本，按照教程中的方法创建 SConscript 文件并运行。首先在 Linux 上尝试，然后将您的 SConscript 文件传输到 Windows 并运行它。它将建立在大多数平台上。

[司康](http://www.scons.org/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-26T16:13:40.247

不久前在 Windows 上，我使用了命令“nmake”。不知道它是否适合你，但这就是我会尝试的。我可能对make文件帮不上什么忙。

# php - 在 SQL PHP 中重复日历事件

> ID：16179085
> 
> 赞同：0
> 
> 时间：2013-04-23T21:00:18.310
> 
> 标签：php, sql

我有一个循环，它遍历给定月份中的所有日子，人们可以从开始日期/时间创建事件并指定结束日期/时间。我正在合并可以每 xx 天、xx 个月或 xx 年重复一次的事件。

我不知道如何在循环中匹配当前日期以查看重复是否已经开始。假设我参加了为期 3 天的“Pickup Silver”活动。我希望从 2 日开始每 7 天发生一次。日历应从开始日期/时间起每 7 天显示一次此事件。从 2、9、16、30 天开始，以此类推。

```
#Loop starts and math calulates the current unix start of each day
##The SQL QUERY to lookup if there are any events starting or ending on this day 
#$SQL =" 
#SELECT
# Name as OutputTitle,
# ID
# FROM
#safe_calendar
#WHERE
#AutherID = '[AccountID]'
#AND
#AutherTable = '[TableName]'
#AND
#(UnixFrom - 86400) <  [UnixThisDay] 
#AND
#UnixEnd >= [UnixThisDay]
#"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:18:29.413

我建议看一下[iCalendar RRULEs](https://www.rfc-editor.org/rfc/rfc5545#section-3.3.10)。如果您正在做一个非常基本的重复模式，那么不要为其中的大部分而烦恼，因为它非常大但非常全面。这至少会给你一个好主意，这是一个标准，关于如何构建你的数据以及你需要存储什么。具体来说，就您而言，听起来您需要存储重复的开始日期和结束日期以及事件的开始日期和长度。由此，您可以推断您的当前日期是否与重复日期相交。

需要记住的是日历计算实际上非常困难。您需要考虑时区差异、夏令时（不仅是在哪几天，还有如何处理额外或缺失的小时）、闰年等。如果考虑到所有异常值，即使看起来很简单也可能变得相当复杂情况。

# ios - UIButton 中的内容在动画后移动

> ID：16179089
> 
> 赞同：2
> 
> 时间：2013-04-23T21:00:40.827
> 
> 标签：ios, cocoa, animation, uibutton, frame

`UIButton`我的动画后有问题。让我解释一下步骤。

我有一个按钮，里面有一张图片。当我点击我的按钮时，我会为框架设置动画以获得较大的宽度，然后当我的框架大小合适时，我会添加我的文本（所以左边有我的图像，右边有文本）。
首先，当我开始动画时，我的图像完全在左侧，我不知道为什么，当我回到初始帧时，我的图像完全不在我的位置`UIButton`，仍然不知道为什么:(

有一些屏幕需要更多解释：

[http://pastebin.com/6MQ5xyA8](http://pastebin.com/6MQ5xyA8)（对不起，没有10分信誉我不能粘贴多个链接）

这是我的代码：

```
// Extand
CGRect loginSize = self.nvButtonConnect.frame;
loginSize.size.width = 297;
loginSize.size.height = 48;
CABasicAnimation *sizeAnimation = [CABasicAnimation animationWithKeyPath:@"bounds"];
sizeAnimation.fromValue = [NSValue valueWithCGRect:self.nvButtonConnect.frame];
sizeAnimation.toValue = [NSValue valueWithCGRect:loginSize];
[sizeAnimation setRemovedOnCompletion:NO];
sizeAnimation.fillMode = kCAFillModeForwards;

// Go back (in another method)
CGRect loginSize = self.nvButtonConnect.frame;
loginSize.size.width = 48;
loginSize.size.height = 48;
CABasicAnimation *sizeAnimation = [CABasicAnimation animationWithKeyPath:@"bounds"];
sizeAnimation.fromValue = [NSValue valueWithCGRect:self.nvButtonConnect.frame];
sizeAnimation.toValue = [NSValue valueWithCGRect:loginSize];
[sizeAnimation setRemovedOnCompletion:NO];
sizeAnimation.fillMode = kCAFillModeForwards; 
```

你有什么想法吗？
我尝试使用自定义 contentEdgeInset、TitleEdgeInset、ImageEdgeInset，似乎没有任何效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:01:35.683

您正在将`frame`值设置为 your `bounds`，这将替换视图坐标系的原点。`bounds`始终如一地使用它应该可以工作。

# html - 将某些内联 css 变成单独的工作表

> ID：16179093
> 
> 赞同：-1
> 
> 时间：2013-04-23T21:00:57.920
> 
> 标签：html, css

```
<table border="1" style="background-color:yellow;border:1px dotted black;width:80%;border-collapse:collapse;">
<tr style="background-color:orange;color:white;">
<th style="padding:3px;">Table header</th><th style="padding:3px;">Table header</th>
</tr>
<tr>
<td style="padding:3px;">Table cell 1</td><td style="padding:3px;">Table cell 2</td>
</tr>
<tr>
<td style="padding:3px;">Table cell 3</td><td style="padding:3px;">Table cell 4</td>
</tr>
</table> 
```

我的问题是如何将这个 html 示例中的内联 CSS 转换为外部样式表？

CSS看起来像这样吗？

```
tr {background-color:orange;color:white;}
table {background-color:yellow;border:1px dotted black;width:80%;border-collapse:collapse;}
td, th {padding:3px;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:03:41.450

使用[`table tr:first-child`](http://www.w3.org/TR/css3-selectors/#first-child-pseudo)代替，`tr`因为只有第一行具有内联样式：

```
table {
background-color: yellow;
border: 1px dotted black;
border-collapse: collapse;
width: 80%;
}

table th, table td { 
padding: 3px;
}

table tr:first-child {
background-color: orange;
color: white;
} 
```

[http://jsfiddle.net/URBMh/2/](http://jsfiddle.net/URBMh/2/)

# php - 比较两个大型阵列的有效解决方案

> ID：16179098
> 
> 赞同：1
> 
> 时间：2013-04-23T21:01:16.593
> 
> 标签：php, arrays, multidimensional-array, simplexml

我喜欢在不使用的情况下比较两个数组，`in_array`因为这两个数组都非常大（超过 50,000 个）。我喜欢生成一个新数组，其中包含第一个数组中缺少的所有数组。

我将使用的最快最有效的解决方案是什么？

**第一个数组**
从 SQL 查询生成的多维数组

```
Array (
  [0] => Array (
    [id] => 17228219
    [name] => ...
  )
  [1] => Array (
    [id] => 17228220
    [name] => ...
  )
  [2] => Array (
    [id] => 17228221
    [name] => ...
  )
  [3] => Array (
    [id] => 17228222
    [name] => ...
  )
  [4] => Array (
    [id] => 17228223
    [name] => ...
  )
  [5] => Array (
    [id] => 17228224
    [name] => ...
  )
) 
```

 **从简单 XML 生成的**第二个数组****

 **```
Array (
  [0] => SimpleXMLElement Object (
    [0] => 17228219
  )
  [1] => SimpleXMLElement Object (
    [0] => 17228221
  )
  [2] => SimpleXMLElement Object (
    [0] => 17228222
  )
  [3] => SimpleXMLElement Object (
    [0] => 17228224
  )
) 
```

**新数组**
创建一个缺少 ID 的数组

```
Array (
  [0] => Array (
    [id] => 17228220
    [name] => ...
  )
  [1] => Array (
    [id] => 17228223
    [name] => ...
  )
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:11:21.797

例如，您可以通过实现 AVL 树来使其更快一点，然后它将在 O(N*Log(N)) 中完成，您可以[在 php 中找到许多树的实现](http://phptouch.com/2011/04/17/implementation-of-a-tree-structure-in-php/)

这将比双'for'（N ^ 2）快一点，此外，您可以对数组进行排序并将每次迭代都在两个数组上移动一步，这样您就可以找到差异，但这也是 O(N *Log(N))，很难相信它可以比这更快。

ps 如果它已经排序（就像在你发布的代码中一样），那么你可以用第二种方法在 O(N) 中完成它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:15:49.267

从算法的角度来看，最快的将是逐项（类似合并排序）比较和补码检测，通过一次通过两个排序数组...具有时间复杂度 O(N logN) + O(MlogM) + O(M + N) ~ O(N log N)...

AVL 树是一个矫枉过正...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:28:54.650

正如 VX 建议的那样，使用 'id' 作为两个集合的数组键将使基于 PHP 的算法更快。

但是，最有效的解决方案是将您的参考集留在数据库中并将 XML 记录添加到其中，在插入或后续 SELECT 连接时检测冲突/非冲突，特别是如果参考集大于比较放。

你没有说你打算用不匹配的数据做什么——这对方法有一定的影响。**

# javascript - 褪色后移除元素

> ID：16179101
> 
> 赞同：1
> 
> 时间：2013-04-23T21:01:27.923
> 
> 标签：javascript, jquery

在插件上，我有以下内容：

```
var defaults = {
    hide: function ($element, $tooltip) {
        $tooltip.fadeOut(4000);
    }
};
$(this).each(function (e) {
    $this.mouseleave(function (e) {
        tooltip.timer = setTimeout(function () {
            options.hide($this, $("." + options.class).stop(true, true), function () {
                $("." + options.class).remove(); // THE ELEMENT IS NOT BEING REMOVED
            });
        }, 0);
    }), // Mouse leave  
}) 
```

在鼠标离开时，我试图在动画结束后删除元素。

问题是该元素没有被删除。但如果我使用它，它会起作用：

```
$this.mouseleave(function (e) {
    tooltip.timer = setTimeout(function () {
        options.hide($this, $("." + options.class).stop(true, true));
        $("." + options.class).remove(); // THE ELEMENT IS BEING REMOVED
    }, 0);
}), // Mouse leave 
```

然后一切正常...为什么 function() { ... } 禁用删除操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:11:47.260

您不能以这种方式传递第三个参数（回调）。试试这个：

```
var defaults = {
    hide: function ($element, $tooltip, $func) {
        if(typeof $func === 'function');
            $tooltip.fadeOut(4000, 'swing', $func);
        else
            $tooltip.fadeOut(4000);
    }
};

$(this).each(function (e) {
    $this.mouseleave(function (e) {
        tooltip.timer = setTimeout(function () {
            options.hide($this, $("." + options.class).stop(true, true), function () {
                $("." + options.class).remove(); // THE ELEMENT IS NOT BEING REMOVED
            });
        }, 0);
    }), // Mouse leave  
}) 
```

**编辑：**

JSFiddle 上的演示：http: [//jsfiddle.net/wcX3g/](http://jsfiddle.net/wcX3g/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:14:50.680

我认为你指的是不同`this`的，一个是`$(this)`到目前为止没有引用任何元素，然后你有`$this`里面`$(this).each()`，谁是 $(this)???，我认为你需要另一个选择器来为你的元素，比如 $('.班级名称'）。然后在里面你可以为每个具有相同类名的元素使用 $(this)：

```
$('.myClass').each(function (e) {
    $(this).mouseleave(function (e) {
        tooltip.timer = setTimeout(function () {
            options.hide($this, $("." + options.class).stop(true, true), function () {
                $("." + options.class).remove(); 
            });
        }, 0);
    }),  
}) 
```

也许您可以使用 Jquery 悬停：

```
$(this).hover(function(){
    //on mouse over
}, function(){
    //on mouse out
    $(the_elm_toRemove).remove();
}); 
```

# java - Files.createDirectory() : FileAlreadyExistsException

> ID：16179102
> 
> 赞同：10
> 
> 时间：2013-04-23T21:01:29.627
> 
> 标签：java, file-io, java-7

我在使用 Java 7 的`Files`类时遇到了一个看似奇怪的问题。我想在开始编写之前确保我的目录和文件存在以避免 a `FileNotFoundException`，并且根据[Javadocs](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#createDirectory%28java.nio.file.Path,%20java.nio.file.attribute.FileAttribute...%29)，`createDirectory`检查“文件是否存在以及如果目录不存在则创建目录”

那么如果它先检查，当目录已经存在时，为什么我对以下代码有问题？

```
private void writeFile() throws IOException {
    // Make sure parent directory and file are ready
    File file = "mydirectory/my.file";
    File parent = file.getParentFile();
    if (parent != null)
        Files.createDirectory(parent.toPath()); // Why do I get FileAlreadyExistsException? =[
    Files.createFile(file.toPath());

    // Do some file writing stuff!
} 
```

我知道我可以只做一个“如果文件不存在则创建”的事情，但我认为这种方法的重点是为我处理所有这些！

异常数据：

```
java.nio.file.FileAlreadyExistsException: mydirectory
at sun.nio.fs.WindowsException.translateToIOException(Unknown Source)
at sun.nio.fs.WindowsException.rethrowAsIOException(Unknown Source)
at sun.nio.fs.WindowsException.rethrowAsIOException(Unknown Source)
at sun.nio.fs.WindowsFileSystemProvider.createDirectory(Unknown Source)
at java.nio.file.Files.createDirectory(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-23T21:13:04.323

从[文档](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#createDirectories%28java.nio.file.Path,%20java.nio.file.attribute.FileAttribute...%29)

```
public static Path createDirectories(Path dir, FileAttribute<?>... attrs) throws IOException 
```

“通过首先创建所有不存在的父目录来创建目录。与 createDirectory 方法不同，如果由于目录已存在而无法创建目录，则不会引发异常。”

也许你可以用那个

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:09:48.127

Files.createDirectory 实际上是创建目录->“创建一个新目录.... createDirectories 方法应该用在需要首先创建所有不存在的父目录的地方。”

如果要确保文件存在，只需使用 file.exists() 方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:06:25.160

Java 7[文档](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#createDirectory%28java.nio.file.Path,%20java.nio.file.attribute.FileAttribute...%29)已经提到你会得到一个`FileAlreadyExistsException`. 那么问题似乎是什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-17T14:12:29.873

```
if (!Files.isDirectory(Paths.get(dirpath))) {
    System.out.println("Output Files parent path does not exist:"+dirpath);
    File file = new File(dirpath);
    if (!file.exists()) {
        if (file.mkdir()) {
            System.out.println("Output files directory is created!");
        } else {
            System.out.println("Failed to create output directory!");
        }
    }
} 
```

先检查再创建！！

# r - 你如何在 R 中加载微秒精度的时间序列？

> ID：16179104
> 
> 赞同：2
> 
> 时间：2013-04-23T21:01:35.093
> 
> 标签：r, time-series

自纪元以来，我需要从微秒值加载 POSIXlt 变量。有一个更好的方法吗：

```
options(digits.secs=6)
mytime=1366039619645990
as.POSIXlt(mytime %/% 1e6, tz="EST", origin="1970-01-01") + (mytime %% 1e6)/1e6
[1] "2013-04-15 10:26:59.64598 EST" 
```

考虑到我要加载数百万条记录，这似乎有点令人费解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T22:43:07.397

模除法可能会产生一些舍入错误（我在我的系统上发现）。添加一小部分时间，时间的最大准确性的一半应该可以*解决*这个问题，尽管本质上它与您已经在做的事情并没有什么不同：

```
as.POSIXlt( mytime/1e6 , tz="EST", origin="1970-01-01") + 5e-7
[1] "2013-04-15 10:26:59.64599 EST" 
```

与之对比：

```
mytime=1366039619646000

# Produces rounding error
as.POSIXlt(mytime/1000000, tz="EST", origin="1970-01-01") + (mytime %% mytime)/1000000
[1] "2013-04-15 10:26:59.645 EST"

as.POSIXlt( mytime/1e6 , tz="EST", origin="1970-01-01") + 5e-7
[1] "2013-04-15 10:26:59.646 EST" 
```

什么时候

```
mytime=1366039619645991
as.POSIXlt(mytime/1000000, tz="EST", origin="1970-01-01") + 5e-7
[1] "2013-04-15 10:26:59.645991 EST" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T12:01:08.627

这将摆脱模数和除法：

```
> mytime=1366039619645991
> mytime.secs = mytime %/% 1e+6
> mytime.usecs = mytime - as.integer(mytime.secs)*1e6
> as.POSIXlt(mytime.secs, tz="", origin="1970-01-01") + mytime.usecs*1e-6+0.0000005
[1] "2013-04-15 11:26:59.645991 EDT" 
```

# haskell - 依赖类型的“ZipVector”应用程序

> ID：16179107
> 
> 赞同：5
> 
> 时间：2013-04-23T21:01:48.983
> 
> 标签：haskell, types, vector, dependent-type

我在有限s 上为自己创建了一个“ `ZipVector`”样式，它使用 sum 类型将有限向量粘合到模拟“无限”向量的 s 上。`Applicative``Vector``Unit`

```
data ZipVector a = Unit a | ZipVector (Vector a)
             deriving (Show, Eq)

instance Functor ZipVector where
  fmap f (Unit a)  = Unit (f a)
  fmap f (ZipVector va) = ZipVector (fmap f va)

instance Applicative ZipVector where
  pure = Unit
  Unit f   <*> p        = fmap f p
  pf       <*> Unit x   = fmap ($ x) pf
  ZipVector vf <*> ZipVector vx = ZipVector $ V.zipWith ($) vf vx 
```

这可能足以满足我的需求，但我很想有一个“固定维度”模型，它以应用实例为模型，您可以通过依赖类型的“向量”获得。

```
data Point d a = Point (Vector a) deriving (Show, Eq)

instance Functor (Point d) where
  fmap f (Point va) = Point (fmap f va)

instance Applicative Point where
  pure = Vector.replicate reifiedDimension
  Point vf <*> Point vx = Point $ V.zipWith ($) vf vx 
```

其中`d`phantom 参数是 type-level `Nat`。我如何（如果可能）用`reifiedDimension`Haskell 编写代码？此外，如果可能的话，再次给定`(Point v1) :: Point d1 a`，`(Point v2) :: Point d2 a`我怎么能`length v1 == length v2`得到`d1 ~ d2`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T00:52:50.253

> 我如何（如果可能）用`reifiedDimension`Haskell 编写代码？

使用`GHC.TypeLits`和`ScopedTypeVariables`：

```
instance SingI d => Applicative (Point d) where
  pure = Point . Vector.replicate reifiedDimension
    where reifiedDimension = fromInteger $ fromSing (sing :: Sing d)
  ... 
```

有关完整示例，请参见[我的答案](https://stackoverflow.com/questions/12924782/converting-a-type-level-natural-number-into-a-regular-number/12925482#12925482)。

> 此外，如果可能的话，再次给定`(Point v1) :: Point d1 a`，`(Point v2) :: Point d2 a`我怎么能`length v1 == length v2`得到`d1 ~ d2`？

与`Data.Vector`，没有。您需要一个向量类型来编码类型中的长度。你能做的最好的就是自己维护它并通过不导出`Point`构造函数来封装它。

# c++ - TSP 的动态方法

> ID：16179111
> 
> 赞同：2
> 
> 时间：2013-04-23T21:02:01.363
> 
> 标签：c++, algorithm

我无法识别为什么该算法不返回 TSP 的最短路径。

```
vector<int> tsp(int n, vector< vector<float> >& cost)
{
  long nsub = 1 << n;
  vector< vector<float> > opt(nsub, vector<float>(n));

  for (long s = 1; s < nsub; s += 2)
    for (int i = 1; i < n; ++i) {
      vector<int> subset;
      for (int u = 0; u < n; ++u)
        if (s & (1 << u))
          subset.push_back(u);

      if (subset.size() == 2)
        opt[s][i] = cost[0][i];

      else if (subset.size() > 2) {
        float min_subpath = FLT_MAX;
        long t = s & ~(1 << i);
        for (vector<int>::iterator j = subset.begin(); j != subset.end(); ++j)
          if (*j != i && opt[t][*j] + cost[*j][i] < min_subpath)
            min_subpath = opt[t][*j] + cost[*j][i];
        opt[s][i] = min_subpath;
      }
    }

  vector<int> tour;
  tour.push_back(0);

  bool selected[n];
  fill(selected, selected + n, false);
  selected[0] = true;

  long s = nsub - 1;

  for (int i = 0; i < n - 1; ++i) {
    int j = tour.back();
    float min_subpath = FLT_MAX;
    int best_k;
    for (int k = 0; k < n; ++k)
      if (!selected[k] && opt[s][k] + cost[k][j] < min_subpath) {
        min_subpath = opt[s][k] + cost[k][j];
        best_k = k;
      }
    tour.push_back(best_k);
    selected[best_k] = true;
    s -= 1 << best_k;
  }
  tour.push_back(0);

  return tour;
} 
```

例如，在`cost`只有 5 个点（图中 5 个不同节点）的距离矩阵上，算法返回的路径不是最优的。任何有助于识别公然或小错误的帮助将不胜感激。或任何有关出现问题的有用提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:34:17.603

一件看起来很奇怪的事情是，即使 i 不是子集 s 的一部分，主 for 循环也会做一些事情。

换句话说，opt[17][8] 将被设置为 cost[0][8]。opt[17][8] 表示处于节点 8 的状态，并且访问了节点 0 和 4（因为 5=2^0+2^4）。

这应该被标记为不可能，因为如果我们在节点 8，我们肯定已经访问了节点 8！

我建议通过更改来防止这些情况的发生：

```
for (int i = 1; i < n; ++i) {
  vector<int> subset; 
```

至

```
 for (int i = 1; i < n; ++i) {
  vector<int> subset;
  if ((s&(1<<i))==0) {
     opt[s][i]=FLT_MAX;
     continue;
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-30T11:45:47.990

嵌套循环`for(j=`遍历 中的所有节点`subset`，包括*起始节点*。这会导致使用未初始化的值`opt[t][0]`，从而导致不正确的最佳路径长度计算。

最简单的解决方法是从以下位置排除*起始节点*`subset`：

```
for (int u = 1; u < n; ++u)
...
if (subset.size() == 1)
...
else if (subset.size() > 1) 
```

# r - 使用 `car` 跨列范围重新编码

> ID：16179114
> 
> 赞同：7
> 
> 时间：2013-04-23T21:02:16.500
> 
> 标签：r, dataframe, data.table

我一直在互联网上闲逛，无法弄清楚如何应用`car`重新编码一系列列的值。

要重新编码单个列的值，我会运行如下命令：

```
 df$dv_r <- recode(df$dv, "2=1;1=0;0=NA") 
```

然后，如果我想对整个 data.frame 执行此操作，我可以运行：

```
 df_2 <- lapply(df, FUN = function(x) recode(x, "2=1;1=0;0=NA")) 
```

但是，我不确定如何对一系列列执行此操作——例如，在一个`data.table`名为的假设中`df`，我将如何重新编码范围为 的列的值`20:40`？

谢谢！当然，这对于 R 专家来说非常容易。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T08:50:49.120

也许有更多的`data.table`方法可以做到这一点，但这里有一种可能性：

```
library(data.table)
library(car)

## Here is some sample data
set.seed(1)
dt <- data.table(A = sample(0:2, 10, replace = TRUE), 
                 B = sample(0:2, 10, replace = TRUE),
                 C = sample(0:2, 10, replace = TRUE),
                 D = rnorm(10), E = rnorm(10), ID = 1:10)
dt
#     A B C           D           E ID
#  1: 0 0 2 -0.04493361 -0.05612874  1
#  2: 1 0 0 -0.01619026 -0.15579551  2
#  3: 1 2 1  0.94383621 -1.47075238  3
#  4: 2 1 0  0.82122120 -0.47815006  4
#  5: 0 2 0  0.59390132  0.41794156  5
#  6: 2 1 1  0.91897737  1.35867955  6
#  7: 2 2 0  0.78213630 -0.10278773  7
#  8: 1 2 1  0.07456498  0.38767161  8
#  9: 1 1 2 -1.98935170 -0.05380504  9
# 10: 0 2 1  0.61982575 -1.37705956 10 
```

用于`.SDcols`定义要将函数应用到的列。

```
dt[, 1:3 := lapply(.SD, recode, "2=1;1=0;0=NA"), .SDcols = 1:3]
dt
#      A  B  C           D           E ID
#  1: NA NA  1 -0.04493361 -0.05612874  1
#  2:  0 NA NA -0.01619026 -0.15579551  2
#  3:  0  1  0  0.94383621 -1.47075238  3
#  4:  1  0 NA  0.82122120 -0.47815006  4
#  5: NA  1 NA  0.59390132  0.41794156  5
#  6:  1  0  0  0.91897737  1.35867955  6
#  7:  1  1 NA  0.78213630 -0.10278773  7
#  8:  0  1  0  0.07456498  0.38767161  8
#  9:  0  0  1 -1.98935170 -0.05380504  9
# 10: NA  1  0  0.61982575 -1.37705956 10 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T21:08:23.763

你当然可以。事实上，只对 data.frame 的一个子集进行操作可以避免重做 data.frame 调用：

```
 df_2[ , col_names]  <- lapply(df[ ,colnames] , 
                                FUN = function(x) recode(x, "2=1;1=0;0=NA")) 
```

通过列号进行操作：

```
 df_2[ , 20:40]  <- lapply(df[ ,20:40] , 
                                FUN = function(x) recode(x, "2=1;1=0;0=NA")) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-03T15:07:03.937

使用变量名而不是列号将类似于：

```
cnames <- c("A", "B", "C")    
dt[ , (cnames) := lapply(.SD, recode, "2=1;1=0;0=NA"), .SDcols = cnames] 
```

# flume - 水槽源可以充当jms消费者吗

> ID：16179115
> 
> 赞同：2
> 
> 时间：2013-04-23T21:02:17.660
> 
> 标签：flume

我刚刚开始研究使用 hdfs 接收器向 hdfs 写入消息的水槽。我想知道水槽源是否可以充当我的消息代理的 jms 消费者。

水槽是否提供与消息代理的集成。或者我是否需要编写一个自定义 jms 客户端，将消息推送到水槽源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T22:07:36.503

Flume 1.3 不提供开箱即用的 JMS 源。但是，似乎此类组件将随下一个版本 Flume 1.4 一起提供：[https](https://issues.apache.org/jira/browse/FLUME-924) ://issues.apache.org/jira/browse/FLUME-924 。

[同时，您可以在此处](https://git-wip-us.apache.org/repos/asf?p=flume.git;a=tree;f=flume-ng-sources/flume-jms-source;h=881a91d4594b6eedbf4b6a153ac4fa8f3fed3e59;hb=trunk)获取此新组件的源代码并进行构建。AFAIK，Flume 1.4 不会破坏其接口，因此该组件可能也适用于 1.3。

# opencv - 编译opencv框架时出错

> ID：16179120
> 
> 赞同：6
> 
> 时间：2013-04-23T21:02:34.393
> 
> 标签：opencv, compiler-errors

我正在尝试开始学习 OpenCV，但我什至无法创建框架。
我正在使用此命令，如说明所述

```
python opencv/ios/build_framework.py ios 
```

但我收到以下错误：

> ** 构建失败 **

```
The following build commands failed:
Libtool /Users/myName/Documents/Apps/Frameworks/ios2/build/iPhoneSimulator-i386/modules/world/UninstalledProducts/libopencv_world.a normal i386
(1 failure)
Traceback (most recent call last):
File "opencv/ios/build_framework.py", line 129, in <module>
build_framework(os.path.abspath(os.path.join(os.path.dirname(sys.argv[0]), "..")), os.path.abspath(sys.argv[1]))
File "opencv/ios/build_framework.py", line 121, in build_framework
put_framework_together(srcroot, dstroot)
File "opencv/ios/build_framework.py", line 89, in put_framework_together
shutil.copytree(tdir0 + "/install/include/opencv2", dstdir + "/Headers")
File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/shutil.py", line 168, in copytree
OSError: [Errno 2] No such file or directory: '../build/iPhoneOS-armv7/install/include/opencv2' 
```

我不知道该怎么办！请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T20:06:54.583

尝试这个：

`$ git checkout 2.4.3 # or 2.4.4 or 2.4.3.1 or 2.4.3.2`

...在你运行之前在你的 opencv 结帐中的某个地方

`$ python ./build_framework.py <SOME_DIR_OUTSIDE_OF_OPENCV_SOURCE_TREE>`

# firebase - Firebase 事务延迟

> ID：16179125
> 
> 赞同：0
> 
> 时间：2013-04-23T21:02:49.697
> 
> 标签：firebase

场景：运行事务。

我认为有关事务是否已提交的信息应该与其他客户端上的“价值”事件大致同时收到。情况似乎并非如此（100+ 毫秒延迟）。这是预期的行为（如果是，我如何衡量差异）还是我做错了什么？

咖啡脚本代码

```
# CLIENT 1
ref.transaction (-> 1), (e, c, d) ->
  console.log "I'm first!" if c

# CLIENT 2
ref.on 'value', (d) ->
  console.log "I'm much later" 
```

[这是一个示例（在相邻的两个窗口中运行）](http://jsfiddle.net/bu65e/5/)
红色圆圈（事务）赶上蓝色圆圈（设置）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T23:18:32.243

除非它是一个极具争议的 Firebase 位置（例如，100,000 多个同时尝试事务（）同一位置的用户）不应该涉及那种类型的延迟。另请注意，Firebase 目前仅部署在美国。我们将在不久的将来在全球范围内推出，但网络延迟也可能在这里发挥作用。

[这是一个使用事务的简单示例计数器](http://bit.ly/17PwMVx)——在多个浏览器中尝试一下，看看你的连接的延迟是什么样的。从我的连接中察觉不到延迟。

# actionscript-3 - AS3，FlashDevelop：this[] 在返回函数中不起作用

> ID：16179126
> 
> 赞同：0
> 
> 时间：2013-04-23T21:02:54.240
> 
> 标签：actionscript-3, return, this, flashdevelop

嗯，这很有趣——至少对我来说，在我的无知中。让代码说话：

```
 public function textSfx(chPos:int, otlPos:int):void
    {
        var sfxTimer:Timer = new Timer (100, 12);
        trace("statSfx fired");
        this["textCh" + chPos + "Stat"].text = this["otl" + otlPos + "Type"] + ": " + this["endOtl" + otlPos + "Stat"];         
        sfxTimer.addEventListener(TimerEvent.TIMER, textSfxHandler(chPos, sfxTimer));
        sfxTimer.start();           
    }

    public function textSfxHandler(chPos:int, sfxTimer:Timer):Function
    {
        return function(evt:TimerEvent):void
        {
            trace(this["anything"]);
        }
    } 
```

请注意，这里只有 textSfxHandler 有针对性，其余的仅供参考，希望能更好地理解它。注意在返回函数中 this[] 的使用：无论您通过它引用什么，它都将跟踪为未定义。

为什么这样？是因为 this[] 不能在 return 部分中使用，还是因为 return 是一个函数？我已经做了一个解决方法（一个丑陋的解决方法，涉及通过返回调用另一个函数，我可以使 this[] 工作），但我想知道原因是什么。

同样，计时器在函数中被实例化，因为我需要大量不同的彼此独立运行，而不是一个计时器来管理它。

有点像给种族的戒指，而不是一戒——尽管你可能会说一戒仍然控制着其他戒指，但让我们在那之前停下来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:28:41.677

通常函数在上下文中被调用，上下文由 'this' 关键字引用。匿名函数（在代码中返回）没有上下文，因此您的问题。

一个更干净的解决方案是拥有另一个类，比如 TimerHandler ，例如：

```
public class TimerHandler
{
    private var _callback:Function;
    private var _chPos:int;
    private var _otlPos:int;

    public function TimerHandler(callback:Function, chPod:int, otlPod:int)
    {
        _callback = callback;
        _chPod = chPod;
        _otlPos= otlPos;
    }

    public function timerHandler(event:TimerEvent):void
    {
        _callback(_chPos, _otlPos);
    }
} 
```

并将其用作

```
public function textSfx(chPos:int, otlPos:int):void
{
    var sfxTimer:Timer = new Timer (100, 12);
    trace("statSfx fired");
    this["textCh" + chPos + "Stat"].text = this["otl" + otlPos + "Type"] + ": " + this["endOtl" + otlPos + "Stat"];         

    var sfxTimerHandler:TimerHandler = new TimerHadler(textSfxHandler, chPos, otlPos);
    sfxTimer.addEventListener(TimerEvent.TIMER, chPos, sfxTimerHandler.timerHandler);//note I'm not calling timerHandler here... just passing a reference to it.
    sfxTimer.start();           
}

public function textSfxHandler(chPos:int, otlPos:int):void
{
   trace('chPos: ' + chPos + '; otlPos: ' + otlPos);
} 
```

此外，代码可能不会完全按照您的意愿行事......但它会给您这个想法！

# wcf - WCF：由于 EndpointDispatcher 的 ContractFilter 不匹配

> ID：16179129
> 
> 赞同：1
> 
> 时间：2013-04-23T21:02:59.873
> 
> 标签：wcf

我得到了这个例外：

> 由于 EndpointDispatcher 的 ContractFilter 不匹配，无法在接收器处处理具有 Action ' [http://tempuri.org/IUserService/HelloWorld ' 的消息。](http://tempuri.org/IUserService/HelloWorld)这可能是因为合约不匹配（发送方和接收方之间的操作不匹配）或发送方和接收方之间的绑定/安全不匹配。检查发送方和接收方是否具有相同的合同和相同的绑定（包括安全要求，例如消息、传输、无）。

Web.Config如下

**服务器**

```
 <system.serviceModel>
    <services>
      <service behaviorConfiguration="ServiceBehaviour" name="API.UserService">
        <endpoint 
          name ="basic"
          address="" 
          binding="basicHttpBinding" 
          bindingConfiguration ="basicBinding"
          contract="API.IUserService" />
        <endpoint 
          address="mex" 
          binding="mexHttpBinding" 
          contract="IMetadataExchange" />
      </service>
    </services>

    <behaviors>
      <serviceBehaviors>
        <behavior name="ServiceBehaviour">
          <serviceMetadata httpGetEnabled="true"/>
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>

    <bindings>
      <basicHttpBinding>
        <binding name="basicBinding" 
                 maxBufferSize="2147483647"  
                 maxReceivedMessageSize="2147483647">
          <security mode="None"></security>
          <readerQuotas maxStringContentLength="2147483647"  />
        </binding>
      </basicHttpBinding>
    </bindings>
  </system.serviceModel> 
```

**客户**

```
 <client>
          <endpoint
            name ="basic"
            address="http://localhost:8080/UserService.svc"
            binding="basicHttpBinding"
            bindingConfiguration ="basicBinding"
            contract="API.IUserService" />
        </client>
      </system.serviceModel> 
```

# c++ - 保持具有频繁插入和删除的小对象的无序列表

> ID：16179134
> 
> 赞同：3
> 
> 时间：2013-04-23T21:03:22.540
> 
> 标签：c++

假设我有一个小对象列表，我通过频繁的插入和删除来迭代（例如，在循环中）。但是，我遍历列表的顺序并不重要。我没有使用 std::list 来存储元素，而是考虑以下列方式使用 std::vector （用于恒定时间删除）：

插入：使用 push_back 在数组末尾插入。

删除：假设我想从大小为 n 的向量中删除位置 k 处的元素。然后，我将第 n 个（或 (n-1)st，取决于您如何看待）元素的内容复制到第 k 个元素并使用 pop_back。鉴于元素很小，复制操作不应该是昂贵的。

这是为了利用连续内存，而不必为每次插入动态分配内存。这种方法有缺点吗？我还注意到 C++11 有 unordered_set，但我认为这对于我正在尝试做的事情来说可能是矫枉过正。

如果这个想法听起来很明显，我深表歉意。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T21:06:21.340

您的想法是保持阵列高效的基本方法。如果订单对您来说真的不重要，我认为这是理想的方法。您可能希望将它封装在一个类中（一个包装器`std::vector`），这样您就可以在多个地方使用它而无需重复代码，单独测试它并且通常遵循“单一责任”原则。

如果您可以访问 C++11 功能，您甚至不必复制第 n 个元素 - 您可以移动它，即使对于较重的对象也可以这样做。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T21:11:37.073

鉴于您的要求相当宽松，我看不出这种方法有什么缺点。

另一个要考虑的选择是，如果您的项目交换比复制便宜，您可以将最后一个项目与要删除的项目交换，然后将您现在交换的项目从末尾弹出。

它确实听起来`unordered_set`对您的需求来说太重了，因为它有恒定的时间`find`，您不需要满足您的需求。

# wordpress - wordpress URL 以数字结尾

> ID：16179138
> 
> 赞同：5
> 
> 时间：2013-04-23T21:03:40.413
> 
> 标签：wordpress

我不确定这是一个已知问题还是假设是这样的表现，

任何 wordpress 网站，如果你在 URL 的末尾加上一个数字，例如，

```
http://perishablepress.com/wordpress-multisite-mamp/ 
```

我们把 1 或任何数字放在最后

```
http://perishablepress.com/wordpress-multisite-mamp/123 
```

我们不会得到该`NOT FOUND`页面，我们仍将停留在同一页面，即

`http://perishablepress.com/wordpress-multisite-mamp/`

这是错误还是正常？我们如何重定向到 NOT FOUND PAGE 呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T22:24:35.313

这不是错误，`123`被解释为分页参数：

```
Request: wordpress-multisite-mamp/123
Query String: page=%2F123&name=wordpress-multisite-mamp
Matched Rewrite Rule: ([^/]+)(/[0-9]+)?/?$
Matched Rewrite Query: name=wordpress-multisite-mamp&page=%2F123 
```

帖子可以用 分页`<!--nextpage-->`。如果没有找到更多内容，WordPress 会显示最后一页的内容（如果帖子没有分页，则显示完整的帖子）。

要在分页参数超过页数时重定向到 404 页面，请将以下内容放入`functions.php`文件中：

```
add_action( 'template_redirect', 'so16179138_template_redirect', 0 );
function so16179138_template_redirect()
{
    if( is_singular() )
    {
        global $post, $page;
        $num_pages = substr_count( $post->post_content, '<!--nextpage-->' ) + 1;
        if( $page > $num_pages ){
            include( get_template_directory() . '/404.php' );
            exit;
        }
    }
} 
```

# magento - 小部件对我的自定义参考没有响应

> ID：16179141
> 
> 赞同：0
> 
> 时间：2013-04-23T21:03:47.493
> 
> 标签：magento, widget

我正在尝试使用小部件控制 view.pthml 上的位置，在该小部件中我指定某个 static_block 仅在某些产品上显示最多。

我在 view.phtml 上插入了：getChildHtml('right_product_promotion')？> 我用一些代码创建了 right_product_promotion.phtml getLayout()->createBlock('cms/block')->setBlockId('7')-> toHtml(); ?>

我在 page.xml 上插入了：正确的产品促销

我现在可以在配置小部件时在小部件 block_reference 上选择位置“正确的产品促销”...

到目前为止一切顺利，然后我添加到我的 catalog.xml：

我创建了一个名为“right_product_promotion”的静态块，ID 为 7

到目前为止一切都很好......图像显示在我的产品视图页面上，但它显示在每个产品页面上，而不仅仅是我在配置小部件时选择的产品......它在哪里出错？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T06:24:51.827

不幸的是，您创建了一个自定义 CMS 块而不是小部件。我建议您按照此处列出的步骤进行操作：

[http://www.magentocommerce.com/knowledge-base/entry/tutorial-creating-a-magento-widget-part-1](http://www.magentocommerce.com/knowledge-base/entry/tutorial-creating-a-magento-widget-part-1) [http://www.magentocommerce.com/knowledge-base/entry/tutorial-creating-a -magento-widget-part-2](http://www.magentocommerce.com/knowledge-base/entry/tutorial-creating-a-magento-widget-part-2)

# javascript - JQuery 验证 - 替代方案

> ID：16179155
> 
> 赞同：5
> 
> 时间：2013-04-23T21:04:30.043
> 
> 标签：javascript, jquery, validation

[除了JQuery Validate](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)之外，有谁知道任何其他与 JQuery 兼容的优秀验证库？

我一直有很多困难，所以我想在我自己写东西之前看看是否有更好的东西。

编辑：

“重复”问题已存在 6 个月（已过时），并且仅引用了一个备选方案。如果可能的话，我想尝试获得更多答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T21:45:14.170

[Parsley](http://parsleyjs.org/)是一个 JavaScript 库，可以与 jQuery 或 Zepto 一起使用，旨在轻松验证表单。它在构建时考虑了用户体验问题，并试图为用户简化细节。

这是你要找的吗？

# c# - 错误：有潜在危险的请求。如何能够允许包含 (&) 的 url

> ID：16179162
> 
> 赞同：4
> 
> 时间：2013-04-23T21:05:05.567
> 
> 标签：c#, asp.net

这是我的网址-

```
http://localhost:4566/PropertyMap/project/ackruti-gardenia-dahisar-&-beyond-mumbai
```

我得到了错误 -

**说明：**执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

**异常详细信息：** System.Web.HttpException：从客户端 (&) 检测到潜在危险的 Request.Path 值。

**堆栈跟踪：**

```
[HttpException (0x80004005): 从客户端 (&) 检测到潜在危险的 Request.Path 值。]
   System.Web.HttpRequest.ValidateInputIfRequiredByConfig() +9673044
   System.Web.ValidateRequestExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +35
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +155
```

我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T21:10:07.057

与号( `&`) 在 URL 中具有特殊含义，用于分隔*Query String*和*Fragment*部分中的元素。默认情况下禁止这种用法，因为黑客通常会像这样进行探测，试图发现漏洞。

为避免这种情况，您需要在路径上使用 URL 编码，因此 & 符号被编码为`%26`，从而形成最终 URL：

```
http://localhost:4566/PropertyMap/project/ackruti-gardenia-dahisar-%26-beyond-mumbai 
```

由于您没有指定构建 URL 的位置，因此我无法帮助您正确编码它 - 每种语言的实现都不同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-23T21:14:15.167

使用`HttpUtility.UrlEncode()`方法

# mysql - 汇总所有记录的字段值

> ID：16179167
> 
> 赞同：0
> 
> 时间：2013-04-23T21:05:24.863
> 
> 标签：mysql, sum

海。如果我要将存储在字段中的所有值相加，我该如何设置查询？
现在我有这个查询：

```
"SELECT views FROM visitors WHERE visited_user = '123'" 
```

我存储了这些记录：

```
id    visitor   visited_user    views
-------------------------------------
1     555       123             15
2     666       123             23
3     777       123             45
-------------------------------------
total                           83 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:07:54.177

使用[sum() 函数](http://www.w3schools.com/sql/sql_func_sum.asp)：

```
SELECT SUM(views) 
FROM   visitors 
WHERE  visited_user = '123' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:09:02.483

```
SELECT SUM(views) FROM visitors WHERE visited_user = '123' 
```

# java - java中带有“静态”类的流利API

> ID：16179170
> 
> 赞同：1
> 
> 时间：2013-04-23T21:05:30.013
> 
> 标签：java, fluent-interface

我有一个“静态”类（即具有私有构造函数且只有静态成员和函数的类）。它包装了 Android 的`SharedPreferences`编辑器，它有一个相当不错的流畅 API。

我想知道是否有可能使用这个静态类包装器创建一个类似的流畅 API？

问题是，通常在制作流畅的 API 时`return this;`，所有功能都会用到。这（据我所知）在“静态”类设计中是不可能的。这个问题有什么解决方法吗？

显然，这可以使用单例模式来解决，但我正在寻找其他解决方案，最好是那些需要尽可能少的样板代码的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T21:28:21.347

我不熟悉首选项 API，但是制作一个静态访问的流畅 API 非常简单。

例如，要拥有类似的东西`Preferences.set().background(green).border(yellow);`，您可以执行以下操作：

```
 public class Preferences {

        private Preferences(){}

        public static Preferences set() {
            return new Preferences();    
        }

        public Preferences background(Color color) {
            //set color on real preferences
            return this;
        }

        public Preferences border(Color color) {
            //set color on real preferences
            return this;
        }

    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T21:12:40.853

通常你会有一个返回新对象的静态工厂方法，然后是该对象的非静态方法，用于自定义对象或返回具有新行为的对象副本。后者更可取，因为这样您的对象可以是不可变的。

对于我认为这是一个很好的例子，请参阅[Guava 的 Ordering 类](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Ordering.html)：

```
// yields a natural ordering over some type
// where the largest object comes first (reverse ordering)
Ordering.natural().onResultOf(someFunction).reverse(); 
```

# c# - 大型多维数组（锯齿状数组）C# 的解决方法？

> ID：16179174
> 
> 赞同：8
> 
> 时间：2013-04-23T21:05:44.937
> 
> 标签：c#, arrays, memory, multidimensional-array, jagged-arrays

我正在尝试初始化一个三维数组以加载体素世界。

地图的总大小应该是（**2048/1024/2048**）。我试图初始化一个**锯齿状**的“int”数组，但我抛出了一个内存异常。尺寸限制是多少？我的桌子大小：2048 * 1024 * 2048 = **4'191'893'824**

有人知道有办法解决这个问题吗？

```
// System.OutOfMemoryException here !
int[][][] matrice = CreateJaggedArray<int[][][]>(2048,1024,2048);
// if i try normal Initialization I also throws the exception
int[, ,] matrice = new int[2048,1024,2048];

    static T CreateJaggedArray<T>(params int[] lengths)
    {
        return (T)InitializeJaggedArray(typeof(T).GetElementType(), 0, lengths);
    }

    static object InitializeJaggedArray(Type type, int index, int[] lengths)
    {
        Array array = Array.CreateInstance(type, lengths[index]);
        Type elementType = type.GetElementType();

        if (elementType != null)
        {
            for (int i = 0; i < lengths[index]; i++)
            {
                array.SetValue(
                    InitializeJaggedArray(elementType, index + 1, lengths), i);
            }
        }

        return array;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T21:09:39.980

C# 中单个对象的最大大小为 2GB。由于您正在创建一个多维数组而不是锯齿状数组（尽管您的方法的名称），它是一个需要包含所有这些项目的单个对象，而不是多个。如果您实际上使用的是锯齿状数组，那么您将不会拥有包含所有这些数据的*单个*项目（即使总内存占用量会更大，而不是更小，只是分散得更多）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-25T13:28:52.963

**非常感谢**所有试图帮助我理解和解决我的问题的员工。

我尝试了几种解决方案来加载大量数据并存储在一个表中。两天后，这是我的测试，最后是**可以将 4'191'893'824**条目存储**到一个数组****中的解决方案**

 ****我添加了我的最终解决方案，希望有人可以提供帮助

## 目标

我记得目标：初始化一个整数数组 [2048/1024/2048] 用于存储**4'191'893'824**数据

* * *

## 测试 1：使用 JaggedArray 方法（失败）

* * *

系统抛出内存不足异常

```
 /* ******************** */
            /* Jagged Array method  */
            /* ******************** */

            // allocate the first dimension;
            bigData = new int[2048][][];
            for (int x = 0; x < 2048; x++)
            {
                // allocate the second dimension;
                bigData[x] = new int[1024][];
                for (int y = 0; y < 1024; y++)
                {
                    // the last dimension allocation
                    bigData[x][y] = new int[2048];
                }
            } 
```

* * *

## 测试 2：使用 List 方法（失败）

* * *

系统抛出内存不足异常（将大数组分成几个小数组。不幸的是，“List <>”允许最大“2GB”内存分配，就像一个简单的数组一样。）

```
 /* ******************** */
        /* List method          */
        /* ******************** */

        List<int[,,]> bigData = new List<int[,,]>(512);
        for (int a = 0; a < 512; a++)
        {
            bigData.Add(new int[256, 128, 256]);
        } 
```

* * *

# 测试 3：使用 MemoryMappedFile（解决方案）

* * *

我终于找到了解决方案！使用类“Memory Mapped File”包含虚拟内存中文件的内容。

[MemoryMappedFile MSDN与我在 codeproject](http://msdn.microsoft.com/en-us/library/dd997372.aspx) [here](http://www.codeproject.com/Articles/26275/Using-memory-mapped-files-to-conserve-physical-mem) 上找到的自定义类一起使用。初始化很长，但效果很好！

```
 /* ************************ */
        /* MemoryMappedFile method  */
        /* ************************ */

        string path = AppDomain.CurrentDomain.BaseDirectory;            
        var myList = new GenericMemoryMappedArray<int>(2048L*1024L*2048L, path); 
        using (myList)
        {
            myList.AutoGrow = false;

            /*
            for (int a = 0; a < (2048L * 1024L * 2048L); a++)
            {
                myList[a] = a;
            }
            */

            myList[12456] = 8;
            myList[1939848234] = 1;
            // etc...
        } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-23T21:12:21.407

来自[关于数组的 MSDN 文档](http://msdn.microsoft.com/en-ca/library/system.array.aspx)（添加了重点）

> 默认情况下，Array 的最大大小为 2 GB。在 64 位环境中，您可以通过在运行时环境中将 gcAllowVeryLargeObjects 配置元素的 enabled 属性设置为 true 来避免大小限制。但是，**该数组仍将限制为总共 40 亿个元素**，并且在任何给定维度中的最大索引为 0X7FEFFFFF（字节数组和单字节结构数组为 0X7FFFFFC7）。

因此，尽管有上述答案，即使您设置标志以允许更大的对象大小，数组仍然被限制在元素数量的 32 位限制。

编辑：您可能需要重新设计以消除对当前使用的多维数组的需求（正如其他人所建议的那样，在使用*实际*锯齿状数组或其他一些维度集合之间有几种方法可以做到这一点）。考虑到元素数量的*规模*，最好使用动态分配对象/内存的设计，而不是必须预先分配它的数组。（除非您不介意使用许多 GB 的内存） EDITx2：也就是说，也许您可​​以定义定义*填充*内容的数据结构，而不是定义世界上*所有可能的*体素，甚至是“空”体素。（我假设绝大多数体素是“空的”而不是“填充的”

编辑：虽然不是微不足道的，特别是如果大部分空间被认为是“空的”，那么你最好的选择是引入某种空间树，它可以让你有效地查询你的世界以查看特定区域中的对象。例如：八[叉](http://en.wikipedia.org/wiki/Rtree)树（如 Eric 建议的那样）或[RTrees](http://en.wikipedia.org/wiki/Octree)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T21:28:52.317

如描述的那样创建这个对象，无论是作为标准数组还是作为锯齿状数组，都会破坏允许 CPU 发挥性能的引用局部性。我建议您改用这样的结构：

```
class BigArray 
{
    ArrayCell[,,] arrayCell = new ArrayCell[32,16,32];

    public int this[int i, int j, int k]
    { 
        get { return (arrayCell[i/64, j/64, k/64])[i%64, j%64, k%16]; } 
    }
}

class ArrayCell 
{
    int[,,] cell = new int[64,64,64];

    public int this[int i, int j, int k] 
    { 
        get { return cell[i,j,k]; } 
    }  
} 
```****

# java - 命名查询、本机查询或标准 API

> ID：16179175
> 
> 赞同：0
> 
> 时间：2013-04-23T21:05:52.287
> 
> 标签：java, oracle, hibernate, jpa

我需要以报告的形式报告来自 3 个不同表格的数据。

用户可以搜索的各种搜索组合是..

1.  INS_USER_ID 和 DateRange
2.  CUST_ACCT_ID
3.  CUST_ACCT_ID 和 DateRange

询问..

```
select DISTINCT W.CUST_ACCT_ID, W.INS_USER_ID, WS.STTI_DATE, WS.STTI_AMT, WC.CMMT  from T_WRK W
       INNER JOIN T_WRK_STTI WS ON W.WRK_STTI_ID = WS.WRK_STTI_ID
       INNER JOIN T_WRK_CMMT WC ON W.WRK_ID = WC.WRK_ID
       WHERE W.CUST_ACCT_ID = 90610194 AND WS.STTI_DATE BETWEEN '01-JAN-12' AND '31-DEC-12'

select DISTINCT W.CUST_ACCT_ID, W.INS_USER_ID, WS.STTI_DATE, WS.STTI_AMT, WC.CMMT  from T_WRKCS W  
       INNER JOIN T_WRKCS_STTI WS ON W.WRKCS_STTI_ID = WS.WRKCS_STTI_ID
       INNER JOIN T_WRKCS_CMMT WC ON W.WRKCS_ID = WC.WRKCS_ID
       WHERE W.INS_USER_ID = 231 AND WS.STTI_DATE BETWEEN '01-JAN-12' AND '31-DEC-12' 
```

所有现有的表都已经使用 Hibernate/JPA 进行了映射。

我已经阅读了谷歌的各种方法，有人可以告诉我以下哪种休眠方法最适合我的场景。

1.  命名查询
2.  本机查询
3.  标准 API

我在考虑 NamedQuery，但还没有看到跨多个表的 NamedQuery，一个例子会很棒。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T07:58:52.343

[例子](http://www.java2s.com/Tutorial/Java/0355__JPA/NamedQueryWithIntParameter.htm)

```
@Entity
@NamedQuery(name="findSalaryForNameAndDepartment",
    query="SELECT e.salary " +
          "FROM Student e" +
          "WHERE e.department.name = :deptName AND " +
          "      e.name = :empName") 
```

您也可以在此加入部门表并稍微更改查询

对于日期使用参数

```
em.createNamedQuery("xxx").setParameter("srtartDate", ...).setParameter("endDate",..) 
```

# coldfusion - 可以记录表单提交吗？

> ID：16179176
> 
> 赞同：0
> 
> 时间：2013-04-23T21:05:57.343
> 
> 标签：coldfusion, e-commerce

这是情况。我的公司有一家电子商务商店，但我们自己不收集或处理信用卡信息。当用户选择“使用信用卡付款”时，他们会立即被带到支付网站，然后该网站会处理他们的信用卡并将状态发送回给我们，以便将订单标记为已付款。我们的站点在 ColdFusion 上运行，它从站点接收数据作为表单数据，处理表单变量，并为客户创建一个订单，标记为已付款。信用卡网站只发送一次信息，没有“握手”。

在过去的一个半月里，我们遇到了一个问题，有时我们无法从信用卡处理网站获取信息，尽管他们说他们已经发送了信息。因此，没有创建订单，并且产品仍在客户的购物车中，即使信用卡已被收取费用。这个问题是间歇性的。我们不能将它与我们这边的任何服务器更改联系起来，信用卡网站否认他们这边的更改。

因此，我们正在尝试做的事情之一是记录客户实际尝试使用信用卡付款的时间（这样我们可以更轻松地抓住错过的人）。所以我想以某种方式记录有人点击“用信用卡付款”时的事件。问题是表单操作将数据提交到信用卡网站。我能想到的唯一方法是将表单操作更改为我们网站上的页面，记录付款尝试，然后再次将表单提交给信用卡公司。我知道我可以使用 JavaScript 自动提交表单，但这似乎是一个糟糕的解决方案（如果关闭 JS 会怎样？），但不知道如何在服务器端进行。

如果可能，请尽量避免涉及 AJAX 的解决方案，因为我对此知之甚少（总的来说，我是一个非常菜鸟的 Web 开发人员，并且只是继承了整个设置）。

将不胜感激有关如何记录此事件的更好的解决方案，或对这种混乱的一般建议！

* * *

对评论的回应：

致 Sam Dufel：很想换到像 Paypal 这样的其他提供商。不幸的是，我的公司实际上是一所大学的一部分，我们都必须使用相同的支付网关。

失败：使用 301 或 302 状态码会保留表单数据吗？我试着查了一下，看起来它可以与“get”一起使用，但我需要用“post”发送它，因为这是支付网关所期望的。

致 imthepitts：我们将其作为表单数据接收。

Revent：问题是根本没有创建订单（因此客户和订单信息只是放在临时购物篮/客户/订单表中）。似乎没有访问应该处理来自支付网关的表单数据的页面。我在该页面上添加了一些日志记录，但我的公司吓坏了，他们禁用了信用卡支付，所以我没有得到任何数据。如果我能说服他们我已经实施了一个很好的日志记录解决方案来快速识别错误的订单，他们会重新打开它。

致 Laksma：我们使用的是发回的唯一标识符。我所说的握手是支付网关验证他们已经与我们的服务器建立连接的某种方式。也许我用错了这个词。感谢您在接收页面上对日志的建议-我已添加。

致 Nenotlep：我知道我没有说过 AJAX，但我想更多地了解您的想法。对日志页面的调用会完全干扰表单提交吗？我假设它会被设置为触发表单按钮的“onclick”事件，然后表单提交会正常进行？如果它很容易设置，那么也许这将是一个很好的方法。

我正在考虑尝试 Sanjeev 的解决方案，因为这与我打算做的类似，但如果它真的那么简单，我实际上想更多地了解 AJAX 的想法，主要是因为它不会改变客户完全没有体验（不像看到重定向屏幕）。

对史蒂夫的补充回应：

我感谢您的意见，通常我喜欢自学新事物，但我现在实在是太不知所措了，甚至无法考虑处理新技术。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T03:00:55.090

我在支付网关上工作，遇到了和你一样的问题。这是我的解决方案 -

1.  将值发布到名为“requestHandler.cfm”的中间页面。

2.  requestHandler.cfm 将值保存到数据库表中。

3.  继续创建一个 <form>，其中包含所有必需的值作为 <input hidden>。放置一个提交按钮和 JavaScript 以在 2 秒内触发“提交”。还要注意，“*如果页面在一段时间内没有刷新，请单击提交按钮*”。由于您不会对表单进行任何验证，因此“提交”按钮只会在 JavaScript 处于活动状态或不处于活动状态的情况下提交表单。
4.  信用卡公司将处理信息并将值回复到“responseHandler.cfm”页面。
5.  我将根据发送给他们的“primarykeyvalue”更新我的数据。（或者只是任何可以识别用户的参考）

**数据库表示例**

![数据库设计](https://i.stack.imgur.com/1xq6V.png)

*   TransactionID 默认为“0”，并将更改为信用卡公司提供的数字
*   默认为“N”的付费标志应更改为“Y”
*   实际金额是我发送的要在用户信用卡上收取的金额。
*   支付金额应与实际金额相符。这是为了帮助我找出用户或中间人是否在任何情况下篡改了详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T05:39:08.723

握手：

当用户被带到支付站点时，您应该包含一个唯一标识符来区分订单，例如 OrderID。您的支付提供商必须有一些自定义字段供您自己使用。然后，当用户被带回您的站点时，支付站点响应数据应包含 OrderID。这样你就可以匹配它们。换句话说，发生了“握手”。

间歇成功支付：

在监听器上，支付提供商返回表单数据的页面，你应该实现一个日志来记录从哪里调用页面以及发送了什么数据。

“...是将表单操作更改为我们网站上的页面，记录付款尝试，然后再次将表单提交给信用卡公司。” 这是一个可行的解决方案。

# javascript - 有什么方法可以将值注入 Meteor 中的 Less 文件？

> ID：16179179
> 
> 赞同：7
> 
> 时间：2013-04-23T21:06:06.877
> 
> 标签：javascript, meteor, less

我正在做一个项目，我们希望用户能够定义自定义颜色。我们正在运行最新版本的 Meteor，其中包括 less 软件包。

现在所有颜色都是位于单个 theme.lessimport 文件中的变量，该文件包含在处理的早期。整个站点的所有颜色（以及许多后续的 less 文件）都是从这几个变量生成的。

这个想法是为每个用户生成一个新的 userTheme.lessimport 文件，如果存在，可以在 theme.lessimport 文件之后导入，以使用自定义值覆盖变量。如果您将文件物理添加到目录中，这一切都可以完美无瑕地工作，但我似乎什至想不出一种动态/以编程方式完成它的方法。

我开始怀疑这是否可以用更少的钱来完成。

*   最大的问题之一是很多 css 都是从这些变量派生的——包括我们自己的应用程序的插件/模块中包含的 CSS。
*   看来您无法导入远程文件以包含在较少的预处理中...因此无法在远程服务器上生成文件（这对于我们的情况来说是理想的情况，因为用户数据将存在于API 服务器）。
*   似乎没有任何编程方式来生成或以其他方式将任何值注入到 less 中——至少在 Meteor 上——因为我找不到任何通过 JS 与 less 交互的方法。

除了这种不便之外，less 对我们正在做的事情来说是完美的，所以我*真的*很想完成这项工作。希望外面的人有一些他们可以传授的智慧或方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-02T13:56:58.723

当然你可以做到。只需使用“fs”节点模块。

这是一个相当愚蠢的例子。执行此操作时有很多陷阱，但对于基本的概念验证，请检查此。

```
if (Meteor.isClient) {
    Template.hello.greeting = function () {
        return "Welcome to less_injector_meteor_test.";
    };

    Template.hello.events({
        'click #button': function () {
            var css = "body {background: " + $("#color").val() + ";}";
            Meteor.call("writeToUserThemeFile", css);
        }
    });
}

if (Meteor.isServer) {
    Meteor.methods({
        "writeToUserThemeFile" :function(css) {
            var fs = Npm.require("fs");
            var path = "/Users/charnjitsingh/Desktop/less_injector_meteor_test";
            fs.writeFile(path+"/user_theme.less", css, function(err) {
                console.log("WRITING FILE");
                if (err) {
                    console.log("ERROR WHEN WRITING", err);
                }
            });
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-26T19:00:49.477

看看[bootstrap3-less](https://github.com/simison/bootstrap3-less)包是如何实现变量和 mixin 的。特别是他们自述文件的高级用法部分。

“如果你想 @import 一个文件，给它扩展名 .import.less 以防止 Meteor 独立处理它。” 因此，在您的实例中，您将命名您的主题文件：theme.import.less

# java - 我是否必须导入在同一个包中但在不同文件夹中的类？

> ID：16179184
> 
> 赞同：1
> 
> 时间：2013-04-23T21:06:49.477
> 
> 标签：java, compiler-errors

我有一些位于`classes/com/scja/exam/tutorial/planets`文件系统中的类。我正在尝试编译位于`classes/com/scja/exam/tutorial/`. 我必须手动导入吗？我正在尝试使用以下命令进行编译：

> javac -d 类 -cp 类/com/scja/exam/tutorial/planets/:. src/com/scjaexam/tutorial/GreetingsUniverse.java

似乎 java 找不到这个文件需要的类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:27:33.733

了解当 Java 搜索名为 的类时`aaa.bbb.ccc.MyClass`，它会在类路径中的每个目录中搜索名为“aaa”的目录。找到一个，它将在该目录中搜索“bbb”，然后，如果找到“ccc”，则实际查找“MyClass.class”。如果你创建你的类路径`-cp aaa/bbb/ccc`，那么 Java 会在那里寻找，找不到“aaa”，然后放弃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T21:21:01.620

包中的类必须导入它使用的类（不使用它们的完全限定名），这些类不在同一个包中（不在 java.lang 中）。存储类的目录必须与包匹配，但您可以有多个包含类的根目录（或 jar）。

您的命令不起作用，因为您将包的目录 ( `classes/com/scja/exam/tutorial/planets/`) 放在类路径中，而不是放在根目录 ( `classes`) 中。

# matlab - 使用for循环的matlab列和行元素求和

> ID：16179187
> 
> 赞同：0
> 
> 时间：2013-04-23T21:07:03.037
> 
> 标签：matlab, for-loop, vector, matrix, sum

我需要在不使用任何 Matlab 函数并使用 for 和 while 循环的情况下为类连接一个算法，这给了我两个新向量，一个是每列元素的总和，另一个是每行元素的总和并比较它们。

根据我在 python 中编写的类似代码，我得到了这么多：

```
A = input('Matrix Input: '); 
[m, n] = size(A);

for i = 1:m;
    sumRow = zeros(1,m);
    for j = 1:n;
        sumRow = sumRow + A(i,j);
    end;
end;
for i = 1:n;
    sumCol = zeros(1,n);
    for j = 1:m;
        sumCol = sumCol + A(j,i);
    end;
end;
A %#ok<NOPTS>
sumRow %#ok<NOPTS>
sumCol %#ok<NOPTS> 
```

但在 Matlab 中，我只能将最后一行和最后一列中元素的总和存储在新向量中，而在 python 中，我得到每行或列都有一个元素的向量。

我会很感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:11:56.663

您没有`sumRow`正确分配，并且每次循环都用零向量覆盖。您的代码应如下所示：

```
sumRow = zeros(1,m);
for i = 1:m;
    for j = 1:n;
        sumRow(i) = sumRow(i) + A(i,j);
    end;
end;

sumCol = zeros(1,n);
for i = 1:n;

    for j = 1:m;
        sumCol(j) = sumCol(j) + A(j,i);
    end;
end; 
```

这样，您在循环`sumRow` *之外*`i`创建，并且sumRow 的第 th 元素将是该行中所有列的总和。

# regex - Groovy 正则表达式。匹配行首

> ID：16179189
> 
> 赞同：2
> 
> 时间：2013-04-23T21:07:06.043
> 
> 标签：regex, groovy

我对 Groovy 正则表达式的行为有点困惑。

```
"dog" == /dog/ - return true

"dog" == /^dog/ - return false 
```

我的理解是 ^ 匹配行首，所以第二个表达式也应该返回 true。

我实际上想要做的是在行首替换“#”

```
line = line.replace(/^#/, '') 
```

但“#”不会被删除

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-23T21:09:30.457

在 Groovy 中，有多种声明字符串的方法，即；

```
println( 'foo' ) // regular string
println( '''foo''' ) // multiline string
println( "foo" ) // templatable string
println( """foo""" ) // multiline templatable string
println( /foo/ ) // slashy string
println( $/foo/$ ) // dollar slashy string (also multiline) 
```

以上都是字符串，所以：

```
"dog" == /dog/ - return true 
```

由于双方都是一个字符串（和相同的字符串），所以它们彼此相等

如果要进行模式匹配，则需要`==~`运算符：

```
"dog" ==~ /^dog/ 
```

返回真。不知道为什么你有`)`一个`replaceAll`：

```
def line = '#Foo'
line.replaceAll( /^#/, '' ) == 'Foo' 
```

返回真

# php - 我需要使用 PHP 函数计算高尔夫分数，但我无法得出正确的公式

> ID：16179195
> 
> 赞同：0
> 
> 时间：2013-04-23T21:07:27.457
> 
> 标签：php, math

我正在编写一个函数来计算高尔夫比赛的球员得分（不是标准的高尔夫比赛，而是自定义比赛）。

这在实际比分、洞的让分和球员的让分中都有体现。

例如：如果球员打出 6，而该球员的差点为 6，而该洞的差点为 4，则该球员将在该洞得到 5 分。原因如下：

如果球员的让分小于或等于该洞的让分，他们会从他们的实际得分中获得 -1 分。在一个 18 洞的高尔夫球场上，球洞的差点从 1 到 18 不等。因此，如果球员的差点为 18，他们将从每个洞的得分中获得 -1 分。所以只要球员的差点在18或更少，这对我来说很容易弄清楚。我遇到的问题是如果球员的让分超过 18 岁如何计算。球员的让分可能在 1 到 99 之间。

因此，如果球员的差点为 21，他们将在所有 18 个洞中获得 -1 分。然后在让分分别为 1、2 和 3 的洞上，他们也会在这些洞上获得额外的 -1 分。因此，如果球员的差点为 36，他们将在所有洞中获得 -2 分。

这是我到目前为止的功能：

```
function handicapCalc($hole,$player,$score){
    if($player <= 18){
        if($hole <= $player){
            $finalScore=$score-1;
        }else{
            $finalScore=$score;
        }
    }else{
        //FIGURE SCORE IF HANDICAP IS LARGER THEN 18
    }
    return $finalScore;
} 
```

$hole 是该洞让分的变量，$player 是球员的让分 & $score 是球员的得分。

我需要计算出允许超过 18 岁的差点。

感谢您提供的任何帮助。

* * *

**编辑[已解决]**

```
function handicapCalc($holeHandicap,$playerHandicap,$holes,$score){
    $perHoleHandicap=floor($playerHandicap/$holes);
    $leftOvers=$playerHandicap % $holes;

    if($perHoleHandicap >= 1){
        $firstScore=$score-$perHoleHandicap;
        if($leftOvers >= $holeHandicap){
            $finalScore=$firstScore-1;
        }else{
            $finalScore=$firstScore;
        }
    }else{
        if($perHoleHandicap >= $holeHandicap){
            $finalScore=$score-1;
        }else{
            $finalScore=$score;
        }
    }
    return $finalScore;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:14:02.470

如果我正确理解规则，您只需要一些模数学：

```
per-hole-handicap: floor($player_handicap / $number_of_holes)
left_over_points = $player_handicap modulo $number_of_holes 
```

例如

让分 15，打 18 洞：

```
per-hole-handicap: floor(15/18) -> 0
left_over_points = 15 mod 18 -> 15

so you've got 15 points to distribute, giving a -1 for the first 15 holes 
```

让分 37，打 18 洞：

```
per-hole-handicap: floor(37 / 18) -> floor(2.055) -> -2 points for all holes
left_over_points = 37 mod 18 -> 1 -> 1 extra point, so -1 for the first hole 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:15:14.497

试试这个编辑过的变体

```
function handicapCalc($hole, $player, $score){
    $finalScore = $score - floor($player / 18) - 
        ((($player % 18) > 0 && ($player % 18) <= $hole) ? 1 : 0);
    return $finalScore;
} 
```

# r - 转置列表列表

> ID：16179197
> 
> 赞同：18
> 
> 时间：2013-04-23T21:07:34.387
> 
> 标签：r

我有一个包含列表条目的列表，我需要转置结构。原始结构是矩形的，但子列表中的名称不匹配。

这是一个例子：

```
ax <- data.frame(a=1,x=2)
ay <- data.frame(a=3,y=4)
bw <- data.frame(b=5,w=6)
bz <- data.frame(b=7,z=8)
before <- list(  a=list(x=ax, y=ay),   b=list(w=bw, z=bz)) 
```

我想要的是：

```
after  <- list(w.x=list(a=ax, b=bw), y.z=list(a=ay, b=bz)) 
```

我不关心结果列表的名称（在任何级别）。

显然，这可以明确地完成：

```
after <- list(x.w=list(a=before$a$x, b=before$b$w), y.z=list(a=before$a$y, b=before$b$z)) 
```

但这很丑陋，仅适用于 2x2 结构。这样做的惯用方式是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-23T21:33:48.477

以下代码将创建一个列表，其中包含每个列表的第 i 个元素`before`：

```
lapply(before, "[[", i) 
```

现在你只需要做

```
n <- length(before[[1]]) # assuming all lists in before have the same length
lapply(1:n, function(i) lapply(before, "[[", i)) 
```

它应该给你你想要的。它的效率不是很高（多次遍历每个列表），您可以通过保留指向当前列表元素的指针来提高效率，因此请确定这对您来说是否足够好。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-07-10T15:27:23.277

该`purrr`软件包现在使这个过程变得非常简单：

```
library(purrr)

before %>% transpose()

## $x
## $x$a
##   a x
## 1 1 2
## 
## $x$b
##   b w
## 1 5 6
## 
## 
## $y
## $y$a
##   a y
## 1 3 4
## 
## $y$b
##   b z
## 1 7 8 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-23T22:15:59.337

这是一个不同的想法 - 使用`data.table`可以存储`data.frame`'s 的事实（事实上，鉴于您的问题，也许您甚至不需要使用列表列表而可以使用`data.table`'s）：

```
library(data.table)

dt = as.data.table(before)
after = as.list(data.table(t(dt))) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-10-05T22:07:25.480

虽然这是一个老问题，但我在搜索同样的问题时发现了它，在我看来[，谷歌的第二次点击](http://r.789695.n4.nabble.com/transpose-lists-td4660695.html)有一个更优雅的解决方案：

```
list_of_lists <- list(a=list(x="ax", y="ay"), b=list(w="bw", z="bz"))
new <- do.call(rbind, list_of_lists) 
```

`new`现在是一个矩形结构，一个奇怪的对象：一个带有维度属性的列表。只要每个子列表的长度相同，它就可以使用任意数量的元素。要将其更改为更常见的 R-Object，例如可以创建如下矩阵：

```
new.dims <- dim(new)
matrix(new,nrow = new.dims[1]) 
```

`new.dims`需要保存，因为该`matrix()`函数删除了列表的属性。另一种方式：

```
new <- do.call(c, new) 
dim(new) <- new.dims 
```

例如，您现在可以将其转换为 data.frame 并将其`as.data.frame()`拆分为列或执行列操作。在您这样做之前，您还可以更改`dim`矩阵的属性，如果它更适合您的需要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-03T13:21:20.963

我发现自己遇到了这个问题，但我需要一个保留每个元素名称的解决方案。当子列表的长度不同时，我提出的解决方案也应该有效。

```
invertList = function(l){
  elemnames = NULL
  for (i in seq_along(l)){
    elemnames = c(elemnames, names(l[[i]]))
  }

  elemnames = unique(elemnames)

  res = list()
  for (i in seq_along(elemnames)){
    res[[elemnames[i]]] = list()
    for (j in seq_along(l)){
      if(exists(elemnames[i], l[[j]], inherits = F)){
        res[[i]][[names(l)[j]]] = l[[names(l)[j]]][[elemnames[i]]]
      }
    }
  }
  res
} 
```

# sql - 在另一个子查询中使用子查询中的列并在子查询中选择多个列

> ID：16179200
> 
> 赞同：0
> 
> 时间：2013-04-23T21:07:44.017
> 
> 标签：sql, sql-server

请看下面的 SQL 查询：

我想存储列值`log_LogId`（第 6 行），`@startlog`以便稍后在第 15 行中使用它。或者还有其他方法可以实现吗？

我不能写`@log_LogId = log_LogId`在第 6 行。它显示语法错误。

另一个问题是如何在第一个子查询中选择多个列？也许喜欢 `(SELECT TOP 1 log_LogId, log_Cost .....`？

提前致谢。

```
DECLARE @startlog INT   
SELECT 
    log_VehicleId AS gpsId,
    log_LogId AS ignOnLogId,
    (SELECT TOP 1
        log_LogId ---Set this value to @startlog so that I can use this in "HERE"
            --- Also Select another column here
        FROM VehicleLog
        WHERE log_Eventid = 6012 AND log_LogId > v2.log_LogId 
        AND log_VehicleId = v2.log_VehicleId
    ) ignOffLogId,
    (SELECT SUM(CAST(log_COG AS FLOAT))
        FROM VehicleLog
        WHERE log_LogId >= v2.log_LogId
        AND log_LogId <= @startlog ---**HERE**
    )
from VehicleLog v2
WHERE log_Eventid = 6011 AND log_LogId < 300 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:38:55.460

您可以按如下方式使用 CTE（公用表表达式）：

```
;WITH CTE_V2 AS

(

    SELECT

        log_VehicleId 
        , log_LogId
    FROM
        VehicleLog

    WHERE 
        log_Eventid = 6011 AND log_LogId < 300

)

, CTE_IGN_OFF AS

(

    SELECT TOP 1

        log_LogId ---Set this value to @startlog so that I can use this in "HERE"

        ,log_OtherColumn    --- Also Select another column here

    FROM 
        VehicleLog

    WHERE 
        log_Eventid = 6012 
        AND log_LogId > (SELECT MAX(CTE_V2.log_LogId) 
                FROM CTE_V2 WHERE VehicleId = CTE_V2.log_VehicleId)
)
, CTE_COG AS
(
    SELECT 
        log_VehicleId AS gpsId
        , log_LogId AS ignOnLogId
        , SUM(CAST(log_COG AS FLOAT)) sum_COG
        FROM 
        VehicleLog
        WHERE 
        log_LogId >= (SELECT MAX(CTE_V2.log_LogId) 
                FROM CTE_V2 WHERE VehicleId = CTE_V2.log_VehicleId)
            AND log_LogId <= (SELECT TOP 1 log_OtherColumn FROM CTE_IGN_OFF)
    GROUP BY
        log_VehicleId
        , log_LogId
)
SELECT * FROM  CTE_COG; 
```

# hadoop - Hadoop Map 减少分布式缓存类路径问题

> ID：16179201
> 
> 赞同：0
> 
> 时间：2013-04-23T21:07:46.070
> 
> 标签：hadoop, mapreduce, classpath

有几个相关的问题，但我花了一整天的时间试图弄清楚这个问题，答案在 SO 的任何地方都没有，所以我将其记录下来以供后代使用。

我有一个 Hadoop 安装（CDH 3u6 - Hadoop 0.20.2），我想在其中发送一个具有多个 Jar 依赖项的 map reduce 作业。像大多数地方推荐的那样，我想使用分布式缓存将依赖项发送到数据节点。

```
 Path someHdfsPlace = new Path("my/mr/libs");
 FileStatus[] jarFiles = hdfs.listStatus(classpathFilesDir);
 for (FileStatus fs : jarFiles) {
      DistributedCache.addFileToClassPath(fs.getPath(), job.getConfiguration());
 } 
```

我在不同的 Hadoop 集群上看到了这项工作，但现在突然不行了。该文件存在于 hdfs 中，并且似乎对其上方的文件和目录具有正确的权限，但是任何 MR 代码在尝试从 lib 加载依赖项时都会失败并出现`ClassNotFound`错误（因此不是损坏问题，只是这些东西在类路径上不存在。）

一篇文章建议必须设置`$HADOOP_CLASSPATH`变量 - 这在某些情况下可能会有所帮助，但我不清楚你会将它设置为什么，在我之前的工作示例中，我不必这样做，所以看起来不太可能。

无比神秘！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:07:46.070

至少对我来说，答案在这个错误报告中：

[https://issues.apache.org/jira/browse/MAPREDUCE-1581](https://issues.apache.org/jira/browse/MAPREDUCE-1581)

该路径可能会以完全限定路径的形式出现：`hdfs://host:2456/my/mr/libs/myJar.jar`在某些环境中`:`，路径分隔符字符会导致一组文件`hdfs`、`//host`和`2456/my/mr/libs/myJar.jar`，这些都不会导致将正确的文件添加到类中小路。

错误报告中发布的第二个解决方案对我有用 - 像这样取消路径：

```
 Path someHdfsPlace = new Path("my/mr/libs");
 FileStatus[] jarFiles = hdfs.listStatus(classpathFilesDir);
 for (FileStatus fs : jarFiles) {
      Path disqualified = new Path(fs.getPath().toUri().getPath());
      DistributedCache.addFileToClassPath(disqualified, job.getConfiguration());
 } 
```

# ruby-on-rails - 如何使用 ruby 查询数据库？

> ID：16179203
> 
> 赞同：2
> 
> 时间：2013-04-23T21:07:50.373
> 
> 标签：ruby-on-rails, ruby, database, model

我已通过 rails 控制台确认此记录不存在。但是，当我运行此代码时，“它存在”会打印到控制台。

我如何使用 ruby​​ 查询数据库有问题吗？

```
 if Companyavg.where(:company => 'goog', :word => 'baa')
            puts 'it exists'
        else
            puts 'doesnt exist'
        end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:11:20.813

改变：

```
if Companyavg.where(:company => 'goog', :word => 'baa') 
```

至：

```
if Companyavg.where(:company => 'goog', :word => 'baa').exists? 
```

这比使用更有效，`present?`因为它可以运行优化查询以返回正确的结果。

您拥有的初始查询将始终是真实的，因为它返回一个`ActiveRecord::Relation`（简单来说，一个惰性未触发查询）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:18:33.383

这是因为 where 返回一个空关系。在 ruby​​ 中，只有 nil 和 false 语句评估为 false。例如 0 和 "" （空字符串）评估为真。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:11:20.657

尝试

```
Companyavg.where(:company => 'goog', :word => 'baa).empty? 
```

问题是`where`调用正在返回一个查询，但它实际上并没有运行查询，直到它绝对必须运行。因此，在这种情况下，您正在评估一个非零、非假对象的真值，因此`true`这符合 Ruby 的规则。

# macos - 以正确的方式分配视图控制器

> ID：16179206
> 
> 赞同：0
> 
> 时间：2013-04-23T21:08:21.077
> 
> 标签：macos, viewcontroller, alloc

我正在尝试归档一些非常简单的东西。

我在名为 PanelController 的 ViewController 头文件中为 NSScrollView 添加了一个属性：

```
@property (strong) IBOutlet NSScrollView *listurls_fld; 
```

我将 ViewController.h 文件添加到名为“qhandler.h”的 NSObject 接口中

```
#import "handler.h"
#import "PanelController.h" 
```

我在 qhandler.m 中有一个 +(void) 函数->

```
+ (void)do_handle:(NSDictionary *)response
{
    PanelController *MyView=[[PanelController alloc] init];
    NSLog(@"add moo");
    [MyView.listurls_fld setStringValue:@"moo"];
} 
```

这不起作用...

它不适用于 setAlphaValue 或其他任何东西，我想这是因为我正在分配 PanelController 的一个新实例，但事实上，我试图更改主实例。

我知道这是基本的，但我在使用外部 obj-c 文件中的视图控制器中的 IBOutlets 时遇到了很大的问题。

谢谢，约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T08:27:25.157

视图控制器.h

`id mainDelegate;`

viewDidLoad 中的 ViewController.m 或加载后触发的函数：

`mainDelegate=self;`

所以我可以`[mainDelegate ...:..];`在每个文件中使用..

# operating-system - FAT 文件系统可以支持对文件的多个引用吗？

> ID：16179211
> 
> 赞同：0
> 
> 时间：2013-04-23T21:08:49.397
> 
> 标签：operating-system, alias, fat

是否可以通过在目录表条目中使用相同的 FAT 块序列来修改基于 FAT 的文件系统以支持对文件的多个引用（即别名）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:10:33.043

否，因为当删除任何引用时，该文件将被添加到可用空间并可能重复使用。这将导致两个不同的文件共享空间，对一个文件的任何写入都会破坏另一个文件。

如果文件系统是不可变的，这可能会起作用。例如，如果它被写入不可写的介质。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:11:24.653

当然，您可以让目录项指向相同的 FAT 记录，但是您应该记住两件事：

1）永远不要运行任何标准的检查磁盘实用程序，否则你会弄错

2）您必须执行自己的删除操作才能从目录中删除指向您删除的同一项目的记录。

UPD：回答认为问题有“可以修改”的方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-06T07:27:16.607

**FAT 文件系统**将有关文件的所有信息存储在目录内的单个结构中，但包含文件数据的磁盘块的地址除外。所有文件的磁盘块号都保存在文件分配表 (FAT) 中。

由于链接信息和文件容器信息*绑定在一个结构*中，FAT 文件系统不支持到单个文件的多个链接。它也不支持符号链接，尽管它可以支持。但是，Windows 支持类似于符号链接的快捷方式。

# c# - savechanges() 不保存？

> ID：16179219
> 
> 赞同：0
> 
> 时间：2013-04-23T21:09:07.917
> 
> 标签：c#, entity-framework

我有这个 C# 代码：

```
 public object guardardinerohoy(float dinero,string comentario)
 {
    object dineromov1 = this.nuevodineromovimiento(dinero, variablesestaticas.usuarioglobal, DateTime.Now, null, claseenumeraciones.enumdineromovimiento.iniciosistema, comentario, DateTime .Now );
    object resultado = "ok";
    string abrirconexion = Conexion.conexion.abrirconexion();
    if (dineromov1.GetType() != "".GetType() && abrirconexion == "ok")
    try
    {
       Conexion.conexion.conect.AddTodineromovimiento((dineromovimiento)dineromov1);
       Conexion.conexion.conect.SaveChanges();
       return "ok";
    }

    catch (Exception ex)
    {
       resultado = ex.Message;
    }

    else
    {
       resultado = dineromov1.ToString() + abrirconexion;
       return resultado;
    }
  } 
```

如果保存成功，我会返回“ok”。现在，当我检查这是否已保存时，它不是。我不明白为什么如果它没有返回异常。这不会一直发生。有时它会保存，有时它不会。

我发现这个线程说如果它没有异常，一切都很好。

[检查实体框架中的插入或更新是否成功](https://stackoverflow.com/questions/1331017/check-if-insertss-or-updates-was-successful-in-entity-framework)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:15:30.497

实体框架将在插入、更新或删除失败时抛出异常。因此，您可以毫无例外地假设它是成功的。

# datetime - 我可以自己编写一个 posix_time::ptime 对象吗？

> ID：16179222
> 
> 赞同：0
> 
> 时间：2013-04-23T21:09:25.923
> 
> 标签：datetime, posix

我有一个对象，其中有一个`boost::posix_time::ptime`对象。我将从其他不提供标准时间结构的库中获取时间，它们有自己的自定义时间结构我的问题是，我可以`ptime`通过简单地设置这些小时/分钟/秒/毫秒变量来组成一个对象。因为我试图这样做，似乎我无法访问它们来设置值。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:16:19.260

从[boost 文档](http://www.boost.org/doc/libs/1_53_0/doc/html/date_time/posix_time.html#ptime_constr)中，您可以通过给它一个日期和时间来创建一个 ptime 对象，直到[小数秒](http://www.boost.org/doc/libs/1_53_0/doc/html/date_time/posix_time.html#time_duration_constr)。ptime 一经创建便不可变。

# objective-c - OpenGL 纹理未显示（使用可可）

> ID：16179228
> 
> 赞同：0
> 
> 时间：2013-04-23T21:09:42.620
> 
> 标签：objective-c, cocoa, opengl, textures

这是一个非常奇怪的问题。我使用从苹果示例复制的方法创建纹理。它在苹果的示例中运行良好，但在我的项目中却不行。没有显示纹理，只有 glcolor4f 定义的颜色。我用 glistexture 和 glgeterror 来检查，他们说那里没有错。这仅在我第一次加载纹理时发生。如果我释放纹理并重新加载它，它可以使用相同的代码。有没有其他方法可以检查 OpenGL 的错误？

这是我用来加载纹理的代码：

```
- (FETexture *)loadTextureWithPath:(NSString*)name{
NSURL    *url = nil;
CGImageSourceRef    src;
CGImageRef    image;
CGContextRef    context = nil;
CGColorSpaceRef    colorSpace;

GLuint textureId;
GLuint pboId;
GLubyte *data;

url = [NSURL fileURLWithPath: name];
src = CGImageSourceCreateWithURL((__bridge CFURLRef)url, NULL);

if (!src) {
    NSLog(@"No image");
    return nil;
}

image = CGImageSourceCreateImageAtIndex(src, 0, NULL);
CFRelease(src);

GLuint width = (GLint)CGImageGetWidth(image);
GLuint height = (GLint)CGImageGetHeight(image);

data = (GLubyte*) calloc(width * height * 4, sizeof(GLubyte));

colorSpace = CGColorSpaceCreateDeviceRGB();
context = CGBitmapContextCreate(data, width, height, 8, 4 * width, colorSpace, kCGImageAlphaPremultipliedFirst | kCGBitmapByteOrder32Host);
CGColorSpaceRelease(colorSpace);

// Core Graphics referential is upside-down compared to OpenGL referential
// Flip the Core Graphics context here
// An alternative is to use flipped OpenGL texture coordinates when drawing textures
CGContextTranslateCTM(context, 0.0, height);
CGContextScaleCTM(context, 1.0, -1.0);

// Set the blend mode to copy before drawing since the previous contents of memory aren't used. This avoids unnecessary blending.
CGContextSetBlendMode(context, kCGBlendModeCopy);

CGContextDrawImage(context, CGRectMake(0, 0, width, height), image);

CGContextRelease(context);
CGImageRelease(image);

glGenTextures(1, &textureId);
glGenBuffers(1, &pboId);

// Bind the texture
glBindTexture(GL_TEXTURE_2D, textureId);

// Bind the PBO
glBindBuffer(GL_PIXEL_UNPACK_BUFFER, pboId);

// Upload the texture data to the PBO
glBufferData(GL_PIXEL_UNPACK_BUFFER, width * height * 4 * sizeof(GLubyte), data, GL_STATIC_DRAW);

// Setup texture parameters
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);

glPixelStorei(GL_UNPACK_ROW_LENGTH, 0);

// OpenGL likes the GL_BGRA + GL_UNSIGNED_INT_8_8_8_8_REV combination
// Use offset instead of pointer to indictate that we want to use data copied from a PBO
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, width, height, 0,
             GL_BGRA, GL_UNSIGNED_INT_8_8_8_8_REV, 0);

// We can delete the application copy of the texture data now
free(data);

glBindTexture(GL_TEXTURE_2D, 0);
glBindBuffer(GL_PIXEL_UNPACK_BUFFER, 0);

FETexture *texture = [FETexture new];

texture.textureID = textureId;
texture.bufferID = pboId;
texture.width = width;
texture.height = height;

return texture; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:38:55.890

您没有显示抽奖站点的任何相关代码。也许你没有在绘制时绑定这个纹理。

[您可以在https://developer.apple.com/downloads/index.action](https://developer.apple.com/downloads/index.action)的“Xcode 图形工具”中使用 OpenGL Profiler来调试 GL 错误和状态。

# c++ - 构造函数中的“未定义对行中 vtable 的引用”

> ID：16179230
> 
> 赞同：0
> 
> 时间：2013-04-23T21:09:44.320
> 
> 标签：c++, inheritance, vtable

我收到标题中所述的错误消息。我正在尝试构建一个继承了 Shape 类的 Line 类。我在

```
Shape(color) {} 
```

在行构造函数中执行。

头文件（形状和线条在一个，颜色在另一个）

形状.h：

```
#ifndef SHAPE
#define SHAPE

#include "Image.h"
class Shape{
private:
    Color color;
public:
    Shape (const Color & col) : color(col){}
    virtual void Draw(Image & figure) const = 0;

};

class Line : public Shape{
public:
    Line (int x1, int y1, int x2, int y2, const Color & color);
    virtual void Draw(Image & figure) const;

private:
    int x1, y1, x2, y2;
};
#endif // SHAPE 
```

图片.h：

```
struct Color {
    Color( unsigned char r, unsigned char g, unsigned char b ) 
    : red( r ), green( g ),     blue( b ) {
    }
    Color() : red( 0 ), green( 0 ), blue( 0 ) {
    }
    unsigned char red, green, blue;
}; 
```

这是Shape.cpp

```
#include "Shape.h"

Line::Line( int x1, int y1, int x2, int y2, const Color &color )
    : x1( x1 )
    , x2( x2 )
    , y1( y1 )
    , y2( y2 )
    , Shape(color){
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:19:00.307

struct`Color`必须在用作 的成员之前声明`Shape`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T16:29:40.887

似乎从 Line 类的 Draw 声明中收回“void”是有效的。由于某些原因

# c# - 响应式扩展缓冲订阅

> ID：16179232
> 
> 赞同：0
> 
> 时间：2013-04-23T21:09:48.897
> 
> 标签：c#, buffer, system.reactive

我对 Rx 相当陌生，并且无法找到解决问题的方法。我正在使用 Rx 通过客户端库开始下载。目前它看起来像：

```
private void DownloadStuff(string descriptor, Action<Stuff> stuffAction)
{
    this.stuffDownloader.GetStuffObservable(descriptor).Subscribe(x => stuffAction(x))
} 
```

其中 stuffDownloader 是客户端库中定义的下载逻辑的包装器。但是我遇到了一个问题，就是调用DownloadStuff太多，导致下载很多，系统不堪重负。现在我想做的是

```
private void DownloadStuff(string descriptor, Action<Stuff> stuffAction)
{
    this.stuffDownloader.GetStuffObservable(descriptor)
        .SlowSubscribe(TimeSpan.FromMilliSeconds(50))
        .Subscribe(x => stuffAction(x))
} 
```

其中，SlowSubscribe 是 Rx 操作的某种组合，仅在某个时间间隔订阅。

通常我只会将这些 DownloadStuff 调用放在一个队列中，并在一段时间内将它们拉出来，但我最近一直在尝试通过 Rx 做更多事情。我想到了三个解决方案：

1.  此功能存在并且可以在订阅端完成。
2.  这是可能的，但下载器的基础设施不正确，应该改变（即 stuffDownloader 需要表现不同）
3.  这不应该用 Rx 来做，用另一种方式来做。

我想到#2 可以通过将描述符的 IObservable 传递给客户端库并以某种方式减慢描述符进入 Observable 的速度。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-25T18:47:00.063

理论上，您可以使用 Rx 将您的请求视为事件。通过这种方式，您可以利用 Rx 的序列化特性来排队下载。

我认为您的网络层（或 stuffDownloader）会为您执行此操作，但是如果您想加入我的行列……这就是我想出的（耶哈！！）

1\. 不要传递 Action，使用 Rx！！您基本上在这里失去了错误处理，并为奇怪的未处理异常做好了准备。

```
private void DownloadStuff(string descriptor, Action<Stuff> stuffAction) 
```

变成

```
private IObservable<Stuff> DownloadStuff(string descriptor) 
```

2\. 现在我们只有一个方法调用另一个方法。似乎毫无意义。抛弃抽象。

3\. 修复底层。对我来说， stuffDownloader 没有做好它的工作。更新接口以采用 IScheduler。现在你可以给它传递一个专门的 EventLoopScheduler 来强制工作的序列化

```
public IObservable<Stuff> GetStuffObservable(string descriptor, IScheduler scheduler) 
```

4\. 修正实施？当您想序列化您的请求时（hmmmm ....），您可以使调用同步。

```
private Stuff GetSync(string description)
{
    var request = (HttpWebRequest)WebRequest.Create("http://se300328:90/");
    var response =request.GetResponse();
    var stuff = MapToStuff(response);
    return stuff;
} 
```

现在你只需在你的其他方法中调用它

```
public IObservable<Stuff> GetStuffObservable(string descriptor, ISchedulerLongRunning scheduler)
{
    return Observable.Create<Stuff>(o=>
        {
            try
            {
                var stuff = GetStuff(description);
                o.OnNext(stuff);
                o.OnCompleted();
            }
            catch(Exception ex)
            {
                o.OnError(ex);
            }
            return Disposable.Empty(); //If you want to be sync, you cant cancel!
        })
        .SubscribeOn(scheduler);
} 
```

但是，完成所有这些之后，我确信这不是您真正想要的。我希望系统中的其他地方存在问题。

另一种选择是考虑使用 Merge 运算符及其最大并发功能？

# java - Java: Plotting points uniformly on a circle using Graphics2d

> ID：16179240
> 
> 赞同：1
> 
> 时间：2013-04-23T21:10:27.677
> 
> 标签：java, trigonometry, graphics2d

I'm trying to draw a number of points on a circle such that each point is the same distance from the next. Eventually I'll be drawing lines between all of the points to make a little drawing. The current hurdle I am dealing with is the points don't come out on the circle uniformly. The way I am figuring the points is, for a given point with angle theta, the X coordinate and Y coordinate are calculated as follows

xc = radius * (Math.cos(theta)) + horizontal center

yc = radius * (Math.sin(theta)) + vertical center

I also have an extra variable so I can make a spinning animation. Here is the code:

```
 import javax.swing.*;
    import java.awt.*;
    import java.awt.image.*;
    import java.util.Random;
    import java.awt.event.*;
    import java.lang.*;
    import java.awt.geom.Line2D;
    import java.awt.geom.Ellipse2D;

    class JavaPaintUI extends JPanel{
        int x,y,rad,i;
        static Random r = new Random();
        BufferedImage image;
        Graphics2D g2d;
        Timer timer;
        double vertices = 24.0;
        double angle = 0.0;
        double delta = 0.01;
        double [] xs = new double[24];
        double [] ys = new double[24];

        JavaPaintUI(){
            image = new BufferedImage(600, 600, BufferedImage.TYPE_INT_ARGB);
            g2d = (Graphics2D)image.getGraphics();
            setBackground(Color.black);
            g2d.setColor(Color.white);
            i=0;
            ActionListener listener = new ActionListener() {
                public void actionPerformed(ActionEvent ae) {
                    angle += delta;
                    angle = angle % 360.0;
                    iterate();
                }
            };
            timer = new Timer(100, listener);
            timer.start();
        }
        public void iterate(){
            g2d.setColor(Color.BLACK);
            g2d.fillRect(0, 0, 600, 600);
            g2d.setColor(Color.WHITE);

            for(double i = 0; i < vertices; i++){
                xs[(int)i] = 250.0 * (Math.cos(((2*Math.PI)/360) * (angle+(i*(360.0/vertices))))) + 300.0;
                ys[(int)i] = 250.0 * (Math.sin(((2*Math.PI)/360) * (angle+(i*(360.0/vertices))))) + 300.0;
            }

            for(double i = 0; i < vertices; i++){
                g2d.draw(new Ellipse2D.Double(xs[(int)i], ys[(int)i], 8.0, 8.0));
            }

            /*
            for(double i = 0; i < vertices; i++){
                for(double j = 0; j < vertices; j++){
                    g2d.draw(new Line2D.Double(xs[(int)i],ys[(int)i],xs[(int)j],ys[(int)j]));
                }
            } */

            repaint();    
            if (i==1000){timer.stop();}
        }
        public void paintComponent(Graphics g){
            super.paintComponent(g);
            g.drawImage(image,0,0,null);
            }
        } 
```

I used code from another stack overflow post.Here is a picture of what the circle looks like as of now.

![circle](https://i.stack.imgur.com/4yukA.png)

As you can see, there are some extra space between some of the points. Does anyone know what causes this?

EDIT

Thanks guys! It looks much better!

![circle2](https://i.stack.imgur.com/dzzsQ.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:16:50.363

`Math.sin()` and `Math.cos()` take an angle in radians and you are providing angles in degrees.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:16:55.863

I believe the trig functions in `Math` take their parameters in radians, not degrees. So you need to do `2 * Math.PI` instead of `360.0`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:17:57.383

A circle has 360 degrees.
So you need an

```
int numSteps = 32;
double angleStep = 360 / numStpes;   // You also can do that with 2*Math.PI / numSteps

for (int i = 0; i < numSteps; i++) {
   double angle = i * anglStep;
   // now use the formula with x0 + r * sin(angle * toRadians);

} 
```

# java - 变量未初始化 - 无法返回值

> ID：16179241
> 
> 赞同：1
> 
> 时间：2013-04-23T21:10:27.690
> 
> 标签：java, class

在下面; 我正在尝试打印用户输入的一些信息。我相信我有一个范围问题。当用户选择A时；他们能够制作一个新角色，然后打印他们的名字。如果他们然后按 V；它失败了，但有一个例外。

java.lang.RuntimeException：无法编译的源代码 - 变量 newChar 可能尚未初始化

如果他们添加了新角色；为什么程序不允许我在选项 V 中打印 getFirstName 但它在选项 A 中这样做？

```
 /*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package rpgmanager;

import java.util.Scanner;

/**
 *
 * @author Aaron
 */
public class RpgManager {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        // Set Run Boolean to true
        boolean running = true;
        // "Splash Screen here"
        System.out.println("Welcome to character generator.");
        // If the program is running; offer the user options
        while(running) {
                System.out.println("A: New Char ; V: View ; S: Save ; D: Delete ; Q: Quit");
                // Initialize the scanner
                Scanner user_input = new Scanner(System.in);
                // Prepare to accept a string
                String decision;
                // Get the user input
                decision = user_input.next();
                // We switch the input to lowecase here and compare
                switch (decision.toLowerCase()) {
                    case "a": 
                        Character newChar = new Character();
                        System.out.println(newChar.getFirstName());
                            break;
                    case "s":
                            break;
                    case "d": 
                            break;
                    case "v":
                        try {
                            System.out.println(newChar.getFirstName());    
                        } catch(Exception e) {
                            System.out.println("You have an exception - ");
                            System.out.println(e);
                        }
                            break;
                    case "q": System.exit(0); // Kill the program
                                break;
                    default: System.out.println("You did not select a viable option.");
                             System.out.println("Try again.");
                                break;
                }
        }
    }
}

/*
 * 
 * 
 */
package rpgmanager;

import java.util.Scanner;

/**
 *
 * @author Aaron
 */
public class Character {
        private String First_Name;
        private String Last_Name;
        private String Height;
        private int Weight;
        private int Age;

        public Character() {
            System.out.println("Creating new character...");
            Scanner user_input = new Scanner(System.in);
            System.out.println("What is your first name?");
            First_Name = user_input.next();
            System.out.println("What is your last name?");
            Last_Name = user_input.next();
            System.out.println("What is your height?");
            Height = user_input.next();
            System.out.println("What is your weight?");
            Weight = user_input.nextInt();
            System.out.println("What is your age?");
            Age = user_input.nextInt();
        }

     /**
     *
     */
    public String getFirstName() {
        return First_Name;
    }

    public String getLastName() {
        return Last_Name;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:20:09.400

实际上，变量 newChar 在这里被初始化：

```
case "a": 
    Character newChar = new Character(); //Here
    System.out.println(newChar.getFirstName());
    break; //"break" makes 
```

但是只有当您选择“a”时才会执行该代码块。当您选择“v”时，将执行以下代码：

```
System.out.println(newChar.getFirstName()); //The variable newChar is not initialized 
```

我相信您正在寻找以下内容：

```
/**
 * @param args the command line arguments
 */
public static void main(String[] args) {
    // Set Run Boolean to true
    boolean running = true;
    // "Splash Screen here"
    System.out.println("Welcome to character generator.");
    // If the program is running; offer the user options
    while(running) {
            System.out.println("A: New Char ; V: View ; S: Save ; D: Delete ; Q: Quit");
            // Initialize the scanner
            Scanner user_input = new Scanner(System.in);
            // Prepare to accept a string
            String decision;
            // Get the user input
            decision = user_input.next();
            // We switch the input to lowecase here and compare
            Character newChar = new Character(); //Now the variable will always be initialized
            switch (decision.toLowerCase()) {
                case "a":                         
                    System.out.println(newChar.getFirstName());
                    break;
                case "s":
                    break;
                case "d": 
                    break;
                case "v":
                    try {
                        System.out.println(newChar.getFirstName());    
                    } catch(Exception e) {
                        System.out.println("You have an exception - ");
                        System.out.println(e);
                    }
                        break;
                case "q": System.exit(0); // Kill the program
                    break;
                default: System.out.println("You did not select a viable option.");
                    System.out.println("Try again.");
                    break;
            }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:12:07.477

您需要在语句`newChar`之前为变量分配一些东西。`switch`这里最合乎逻辑的解决方案是添加一个

```
Character newChar = null; 
```

在语句之外的行`switch`，然后检查`q`if `newChar`is的情况`null`，并在这种情况下打印某种`No Character has been created yet`消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:13:52.967

它是您在选项 A 中声明 newChar 但未在选项 v 中声明的范围问题

case "a": 字符 newChar = new Character();

所以在 while 或选择 v 中声明 newChar

# android - 没有加载符号表。使用“文件”命令。使用 Eclipse 和 NDK

> ID：16179242
> 
> 赞同：5
> 
> 时间：2013-04-23T21:10:27.963
> 
> 标签：android, eclipse, android-ndk, cygwin

我正在尝试使用 eclipse + NDK + cygwin 调试本机 android 应用程序（显然是在 Windows 机器上）

一切似乎都运行良好（当然是在一段时间后:) - 但我似乎总是在遇到断点时遇到同样的错误=“未加载符号表。使用“文件”命令。”

即使我直接使用 ndk-gdb - 仍然是同样的问题。

当我使用“信息共享”检查时 - 我没有加载我的“.o”。

有任何想法吗？

谢谢

# perl - Perl - 通过套接字发送多个数据

> ID：16179243
> 
> 赞同：2
> 
> 时间：2013-04-23T21:10:31.830
> 
> 标签：perl, sockets

当谈到 Perl 中的套接字编程时，我想知道一件事。我正在尝试通过我的套接字发送两个变量。它有效，我可以发送两个，但我想一个接一个地接收它们。让我向您展示我的代码和我得到的输出：

服务器

```
my $var1 = 200;
chomp($var1);
$socket->send($var1);

my $var2 = 300;
chomp($var2);
$socket->send($var2); 
```

客户

```
$socket->recv(my $var1, 4000);
chomp($var1);
$socket->recv(my $var2, 4000);
chomp($var2);

print "From server: My height is: $var1 cm, weight is: $var2 kg\n"; 
```

好吧，我的预期输出应该是：来自服务器：我的身高是：400 厘米，体重是：300 厘米。相反，我的输出如下所示：来自服务器：我的身高是：400300 厘米，体重是：

好吧，我不明白为什么我的代码是错误的。我不应该像这样一个接一个地接收数据吗？我最终将如何解决这个问题以正确接收数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:43:38.210

简短回答：使用数据报套接字或实现分隔不同消息的通信协议。

你问：

> *我不应该像这样一个接一个地接收数据吗？*

您可以在UDP: 等*数据报*套接字 上轻松完成此操作`IO::Socket::INET->new(Type => SOCK_DGRAM, ...)`。写入器/读取器协议在那里传输和接收离散的数据包，发送/接收将做你想做的事。

*另一方面，像 TCP 这样的*流套接字具有连续的字节流模型。*在这里，您需要某种记录分隔符或消息大小或类似的初始传输。我怀疑这是你正在使用的。*

 *流套接字与普通文件不同，它们显示为“字节流”IO 句柄。如果一个文件包含字符串“300400”，*没有任何换行符*，那么该文件的读者怎么会知道这个字符串实际上是两条记录而不是一条（或六或五或不完整的记录等）？*

# java - 没有从多线程客户端服务器应用程序中取回正确的值

> ID：16179245
> 
> 赞同：1
> 
> 时间：2013-04-23T21:10:33.683
> 
> 标签：java, multithreading, client-server

我目前正在开发一个客户端服务器应用程序，其中 2 个客户端在 JFrame 上有一个椭圆形，他们每个人都可以看到他们的位置。

我的问题是当 Client1 得到 Client2 的位置时，他没有得到正确的值，因为对手在 Frame 上的椭圆位置不对。我决定让两个椭圆都向下移动（增加 y 值）并打印 oppYPos。似乎当 y = 250 时，它又回到了 y = 4。

我能够获得两个客户端的起始位置并在两个窗口上绘制椭圆，但是当我运行线程时，一切都从那里走下坡路......

由于我不能发布图片，这里有一些代码：

这发生在客户端线程中：movePlayer，向下移动椭圆，检查碰撞，然后将当前 x 和 y 值发送​​到服务器，然后服务器将这些新值设置为第二个客户端的 Opponent 值并获取 opp 位置另一个客户

```
 //This while loop is in the run method
    while(true){
        movePlayer();
        checkForCollisions();
        sendValuesToServer();
        getOppValuesFromServer();
        repaint();

        try {
            Thread.sleep(120);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

   public  void sendValuesToServer()
{
    try {
        outputToServer.write(myXPos);
        outputToServer.write(myYPos);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

}

public  void getOppValuesFromServer(){

    try {
        this.oppXPos = inputFromServer.read();
        this.oppYPos = inputFromServer.read();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

} 
```

这是服务器端

```
 //The xStartPos are overriden by the new x and y values from the client
             while (true) {
        synchronized (this) {

            // Getting the new variables back
            try {
                xStartPos = inputFromClient.read();
                yStartPos = inputFromClient.read();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }

        // Setting the new values for opponents
        synchronized (this) {
            for (SnakeServerThread sst : snakeThreads) {

                if (sst != this) {
                    currentOppXPos = sst.xStartPos;
                    currentOppYPos = sst.yStartPos;
                }

            }
        }

        synchronized (this) {
            try {
                outputToClient.write(currentOppXPos);
                outputToClient.write(currentOppYPos);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        } 
```

这工作正常，直到 y 值为 250 ......出于某种原因，它将它设置为零，并且对手只是在屏幕的一半消失并从顶部开始。

抱歉，如果我包含的内容太多，但在过去的 2 个小时里我一直在尝试解决这个问题，但没有运气！！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:13:51.660

> 这工作正常，直到 y 值为 250 ......出于某种原因，它将它设置为零，并且对手只是在屏幕的一半消失并从顶部开始。

您的问题很可能是您试图将一个整数写入服务器，但[`OutputStream.write(byte)`](http://docs.oracle.com/javase/6/docs/api/java/io/OutputStream.html#write%28int%29)只查看该值的最低 8 位。引用 javadocs：

> 将指定字节写入此输出流。一般约定`write`是将一个字节写入输出流。要写入的字节是参数的 8 个低位`b`。的 24 个高位`b`被忽略。

一旦超过了字节的 8 个字节，您就会再次滚动到 0。如果您的值高于 255，则需要写入多个字节。您应该将您的位置写为一系列字节：

```
...write(pos & 0xFF);
...write((pos & 0xFF00) >> 8);
// if the position can be more than 2 bytes
//...write((pos & 0xFF0000) >> 16);
//...write((pos & 0xFF000000) >> 24); 
```

接着：

```
pos = ...read();
pos |= ...read() << 8;
// if the position can be more than 2 bytes
// pos |= ...read() << 16;
// pos |= ...read() << 24; 
```

类似的东西。或者您可以使用序列化并直接编写 a`short`或 an `int`。

# iphone - 在 ViewController 中设置 UINavigationBar 背景图片

> ID：16179253
> 
> 赞同：3
> 
> 时间：2013-04-23T21:11:09.200
> 
> 标签：iphone, ios, objective-c, uinavigationcontroller

我可以使用以下代码在应用程序委托 didFinishLaunchingWithOptions 方法中将导航栏的背景设置为自定义图像：

```
UIImage *navBarImage;
navBarImage = [UIImage imageNamed:@"navbar.png"];

[[UINavigationBar appearance] setBackgroundImage: navBarImage forBarMetrics:UIBarMetricsDefault]; 
```

我正在尝试在我的应用程序中添加一个选项，以在切换开关时更改导航栏的背景图像，但它似乎不起作用。是否只能在应用启动时设置背景图像？应用程序启动后如何执行此操作？

这是我的代码：

```
- (void) switchChanged:(id)sender {
    UISwitch* switchView = sender;

        if (switchView.isOn) {
            UIImage *navBarImage = [UIImage imageNamed:@"black_nav.png"];
            [[UINavigationBar appearance] setBackgroundImage: navBarImage forBarMetrics:UIBarMetricsDefault];
        }
        else {
            UIImage *navBarImage = [UIImage imageNamed:@"white_nav.png"];
            [[UINavigationBar appearance] setBackgroundImage: navBarImage forBarMetrics:UIBarMetricsDefault];
        }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T21:14:57.497

使用`setBackgroundImage:forBarMetrics:` 方法：

```
[navbar setBackgroundImage:[UIImage imageNamed:@"navbar"] 
               forBarMetrics:UIBarMetricsDefault]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T21:33:45.170

您可以这样做替换每个视图中的默认值：

```
UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0,0,
 self.navigationController.navigationBar.frame.size.width,
 self.navigationController.navigationBar.frame.size.height)];
[imageView setImage:[UIImage imageNamed:@"newImage.png"]];
[self.navigationController.navigationBar addSubview:imageView];
[self.navigationController.navigationBar sendSubviewToBack:imageView]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:54:40.693

试试这个

// 创建可调整大小的图像

```
UIImage *gradientImage44 = [[UIImage imageNamed:@"surf_gradient_textured_44"]
           resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 0, 0)];
 UIImage *gradientImage32 = [[UIImage imageNamed:@"surf_gradient_textured_32"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 0, 0)]; 
```

// 设置*所有*UINavigationBars的背景图片

```
 [[UINavigationBar appearance] setBackgroundImage:gradientImage44 forBarMetrics:UIBarMetricsDefault];
[[UINavigationBar appearance] setBackgroundImage:gradientImage32 forBarMetrics:UIBarMetricsLandscapePhone]; 
```

# c - ANSI C：从 calloc API 测试返回 - 不同于 windows 和 ibm cics

> ID：16179255
> 
> 赞同：-1
> 
> 时间：2013-04-23T21:11:14.600
> 
> 标签：c, ansi, cics

下面的 ANSI C 代码在使用 Viasual Studio 2010 编译时返回一个有效指针（编译为 C 代码 (/TC)）：

```
#include <stdio.h>
#include <stdlib.h>
#include <内存.h>

无效的主要（）
{
    无效* p = NULL；
    诠释我=0；

    p = calloc(0, 100);

    如果 ( p != NULL )
    {
        printf("成功。\n");

        免费 ( p );
        p = 空；
    }
    别的
    {
        printf ( "失败.\n" );
    }
}

```

使用 IBM CICS 的 C 编译器的相同代码具有不同的行为，在 API 调用 calloc 时返回 NULL。
Visual Studio 2010 的行为是否正确？

由于该测试，回调在两种情况下都有不同的效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:13:23.087

正如 cppreference 的文档所说：

> 如果大小为零，则行为是实现定义的（可能会返回空指针，或者可能会返回一些可能不用于访问存储的非空指针）

只是不要那样做。

[http://en.cppreference.com/w/cpp/memory/c/calloc](http://en.cppreference.com/w/cpp/memory/c/calloc)

# mysql - MySql 触发更新、插入和删除

> ID：16179267
> 
> 赞同：1
> 
> 时间：2013-04-23T21:12:04.440
> 
> 标签：mysql, sql, triggers

有一种方法可以截取表中的新条目记录，并在另一个表中插入此字段的一些值？而且，再次，如何将关系设置为级联，以便如果我删除主表中的记录，即使在触发表中也会删除这些记录？我们可以通过示例/资源来解释吗？提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:17:22.177

这直接来自[http://dev.mysql.com/doc/refman/5.0/en/trigger-syntax.html](http://dev.mysql.com/doc/refman/5.0/en/trigger-syntax.html)

```
mysql> CREATE TRIGGER ins_sum BEFORE INSERT ON account
    -> FOR EACH ROW SET @sum = @sum + NEW.amount; 
```

在您的情况下，您可能希望将插入的表格行的实例替换`SET`为`insert`语句。`NEW`所以是这样的：

```
mysql> CREATE TRIGGER trigger_name BEFORE INSERT ON tablename
    -> FOR EACH ROW insert into othertable (colname) Values(NEW.colname); 
```

# eclipse - 调试多线程应用程序的问题

> ID：16179269
> 
> 赞同：1
> 
> 时间：2013-04-23T21:12:11.847
> 
> 标签：eclipse

我正在尝试在 Eclipse 中调试多线程应用程序。有3个线程

读写控制器

Read 和 Write 都可以访问 Controller 中的方法。当 Write 执行该 Controller 方法时，我正在尝试调试问题。

我在写线程和控制器中设置了一个断点。我中断了 Write 并关闭了网络连接以模拟我的错误并点击恢复，因此我在 Controller 中的断点处结束。

当我在那里时，控制器会正常工作：它会杀死读写线程（我认为）并启动新的读写线程。杀死读写后，我打开网络连接以模拟正在解决的问题。

这一切都很棒。现在应该发生的事情是一切都在继续进行。除了真正发生的是 Read 线程执行并且我再次到达我在 Controller 中设置的断点 - 与我之前从 Write 中命中的断点相同。更糟糕的是，它仍然认为网络连接不可用——这没有任何意义，因为我重新启用了它。

这一切都让我想知道我是否需要以某种方式阻止读取线程执行。我需要通过 Eclipse 暂停它吗？甚至可以从调试器中运行的应用程序中杀死线程吗？

标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T07:15:27.967

*我需要通过 Eclipse 暂停它吗？* 不，没有必要为了你的代码工作而暂停一个线程。我很少暂停线程，当我怀疑它正在等待我不例外的东西时，我会这样做。我使用断点来控制停止，有时还使用属性。[这是一个有趣的答案。](https://stackoverflow.com/questions/5375538/debugging-multiple-threads-in-eclipse)

*甚至可以从调试器中运行的应用程序中杀死线程吗？* **不**，如果可能的话，对于当前的 Java 规范来说，这不是一个好主意。停止线程的一个好方法是使用标志正确退出 run() 方法：[请参阅此处](https://stackoverflow.com/questions/10961714/how-to-properly-stop-the-thread-in-java)

你确定你退出你的读写线程吗？一种方法是在运行方法中添加调试信息：

```
run()
{
  System.out.println("start : " + this.getName());
  // do your process
  System.out.println("stop : " + this.getName());
} 
```

日志记录有时比多线程中的调试更容易。没有代码很难更具体。

# sql - 期间开始日期的计算

> ID：16179270
> 
> 赞同：0
> 
> 时间：2013-04-23T21:12:11.753
> 
> 标签：sql, sql-server

我有一个表格，其中包含一个财务期间的开始日期和结束日期。

```
CHARGE_PERIOD_ID    START_DATE                 END_DATE
13                  2013-03-31 00:00:00.000    2013-04-27 00:00:00.000
14                  2013-04-28 00:00:00.000    2013-05-25 00:00:00.000
15                  2013-05-26 00:00:00.000    2013-06-29 00:00:00.000
16                  2013-06-30 00:00:00.000    2013-07-27 00:00:00.000
17                  2013-07-28 00:00:00.000    2013-08-24 00:00:00.000
18                  2013-08-25 00:00:00.000    2013-09-28 00:00:00.000
19                  2013-09-29 00:00:00.000    2013-10-26 00:00:00.000
20                  2013-10-27 00:00:00.000    2013-11-23 00:00:00.000
21                  2013-11-24 00:00:00.000    2013-12-28 00:00:00.000
22                  2013-12-29 00:00:00.000    2014-01-25 00:00:00.000
23                  2014-01-26 00:00:00.000    2014-02-22 00:00:00.000
24                  2014-02-23 00:00:00.000    2014-03-29 00:00:00.000 
```

报告的用户希望将当前财政年度分成 12 个期间，并希望将 2 个参数输入到报告中，一个年份和一个将进入我的 sql 的期间编号。所以会收到类似@year=2014 @period=1 的东西。我必须编写一些 sql 才能访问该表并设置 2014 年 3 月 31 日的期间开始日期和 2014 年 4 月 27 日的期间结束日期。

所以在伪代码中：

查找 2014 年的期间 1 和 2014 年 3 月 31 日的返回期间开始日期和 2014 年 4 月 27 日的期间结束日期。

@PERIOD_START_DATE = 选择给定年份从 3 月开始的第一个期间。所有财务期从三月开始。

@PERIOD_END_DATE = 从表中选择相应的 END_DATE。

问题是如何开始编写这个或我的设计方法？我应该创建一个计算这个的函数，还是应该做一个 CTE 并添加一个列，该列将以他们想要的方式保存期数等。

想多了我想我需要一个映射表。所以真正的问题是我可以在没有映射表的情况下做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:29:53.637

```
DECLARE @Year INT 
DECLARE @Period INT

SET @Year= 2013
SET @Period = 1

;WITH CTE AS 
(
SELECT *, ROW_NUMBER() OVER (PARTITION BY 
                                CASE WHEN MONTH([START_DATE])<3 THEN YEAR([START_DATE]) -1 ELSE YEAR([START_DATE]) END                              
                                ORDER BY 
                                CASE WHEN MONTH([START_DATE])<3 THEN YEAR([START_DATE]) - 1 ELSE YEAR([START_DATE]) END
                                ,CASE WHEN MONTH([START_DATE])<3 THEN MONTH([START_DATE]) + 12 ELSE MONTH([START_DATE]) END 
                                ) AS RN
FROM Periods
)
SELECT * FROM CTE
WHERE RN = @Period 
AND CASE WHEN MONTH([START_DATE])<3 THEN YEAR([START_DATE]) -1 ELSE YEAR([START_DATE]) END = @Year 
```

**[SQLFiddle 演示](http://www.sqlfiddle.com/#!6/02a68/2)**

# html - HTML 表格在电子邮件中扩展到窗口的末尾

> ID：16179274
> 
> 赞同：0
> 
> 时间：2013-04-23T21:12:33.310
> 
> 标签：html, html-table, width, html-email

我遇到了一个令人沮丧的问题，没有真正的方法来找到解决方案......

我正在编写 HTML 电子邮件，并且我有一个特定的表格，该表格一直延伸到浏览器的末尾。我在（所有浏览器、Yahoo、Gmail、Outlook Mac 2011）中测试过的所有东西都没有做类似的事情。我收到了来自收件人的屏幕截图，尽管那很不正常。当我尝试的所有东西看起来都很好时，我不确定如何解决这个问题......

不正确：

![](https://i.stack.imgur.com/60jJJ.png)

正确的：

![](https://i.stack.imgur.com/mtmiV.png)

正如您在屏幕截图中看到的那样，中心列在它旁边的两列之间尽可能地扩展。在正确的屏幕截图中，您将看到它应该如何实际出现。

如果有人能给我一些方向，将不胜感激。

```
<!--Container-->
<table cellpadding="0px" cellspacing="0px" width="600px" style="margin:0px auto;border:0px;border-spacing:0px;border-collapse:collapse;display:block;background-color:#1a223e;">
    <tr>
            <td style="vertical-align:top;">

<!--Left Column-->
<table width="227px" cellpadding="0px" cellspacing="0px" style="border:0px;border-spacing:0px;border-collapse:collapse;margin:0px auto;display:block;padding:0px;">
                            <tr>
                                    <td><a href="http://pesgm13.org/index1.asp?camp=TDGMEM2" style="border:0px;"><img src="left_image.jpg" width="227" height="932" style="display:block;border:0px;border-spacing:0px;border-collapse:collapse;vertical-align:top;background-color:#1a223e;" /></a></td>
                            </tr>
                    </table>
            </td>

    <td style="vertical-align:top;">  

            <!--Content-->
            <table width="340px" cellpadding="0px" cellspacing="0px" style="border:0px;border-spacing:0px;border-collapse:collapse;margin:0px auto;display:block;vertical-align:top;font-family:Arial, Helvetica, sans-serif;font-size:14px;line-height:16px;font-weight:normal;color:#1a1a1a;background-color:#ffffff;">
                            <tr>
                                    <td style="vertical-align:top;display:block;">

                                    <img src="headline.jpg" width="271" height="85" style="display:block;margin:0px auto;border:0px;border-spacing:0px;border-collapse:collapse;background-color:#ffffff;margin-bottom:20px;padding-top:25px;" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:18:01.887

当您编写电子邮件模板时，总是喜欢设置 `<td width="600"> instead of <table width="600">` ，`set width for each <td>`它会好的，如果它不起作用，请告诉我

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:17:22.350

当使用不推荐使用的`width`和`height`属性而不是 CSS 时，您需要遵守它们的语义。属性采用数字值（表示像素）或百分比后跟 a`%`作为值。所以：

```
<table width="600">      <!-- correct -->
<table width="60%">      <!-- correct -->    
<table width="600px">    <!-- invalid attribute value! --> 
```

大多数 HTML 渲染器对此并不真正迂腐，但您的客户似乎找到了一个。我很确定将其更改为`width="600"`将解决您的问题。

您实际上可以在*不正确*的屏幕截图中看到这是解决方案，因为它也忽略了您的`cellspacing`声明，将它们默认为正常值，`1`因为它们`px`包含在内。请注意，即使在 CSS 中，这也被认为是不好的形式 -`0`根本没有尺寸，因此没有单位来衡量它，所以在 CSS 中你也应该总是写`0`而不是`0px`,`0em`或`0%`。

# java - 自定义水平滚动动画以跟踪 android 中视图上的手指

> ID：16179283
> 
> 赞同：0
> 
> 时间：2013-04-23T21:13:27.543
> 
> 标签：java, android, horizontal-scrolling

所以这不是一个关于代码的技术问题，而是更多关于一些想法的问题。我是 android 开发的新手，因此我并不完全熟悉它所提供的很多东西。

我在屏幕上有一个项目列表，您可以上下滚动以查看不同的项目。

当我决定让项目能够左右滑动以显示像面板这样的设置时，我的问题出现了，它们下面有几个选项（每个项目下面都有自己的设置，而不是所有项目的设置屏幕） ）。我四处寻找不同的方法来做到这一点，但似乎找不到一种有效的方法。到目前为止，我在想的是在其中`HorizonalScrollView`包含我的项目，设置菜单位于屏幕左侧或右侧，但是当我将文本区域放在 中时`HorizonalScrollView`，它只占屏幕的一半，所以我可以适应两个并排，不是我想要的，最终结果也不会是我想象的。我真的想要一个允许设置位于项目下的解决方案，因此当您将其推开时，它会显示设置。

有没有更好的方法，或者我应该继续努力做我的`HorizonalScrollView`工作，任何关于我如何去做的指南或想法将不胜感激。

查看我的应用程序，看看我是否能找到一个具有类似功能的应用程序，gmail 应用程序有。这是一个图像链接，可以让您了解，在您将项目滑动到一侧后，它会在项目的位置显示一个撤消或存档按钮，就好像它们隐藏在您滑开的列表项下一样![在此处输入图像描述](https://i.stack.imgur.com/gFBN6.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:43:25.153

这个问题是一个非常有趣的话题。并准备好做一些定制的事情。

首先，删除Horizo​​nalScrollView，我认为它不会帮助你。每个项目的布局应该是这样的（伪代码，您可以自己构建 XML =]）：

```
FrameLayout
   RelativeLayout id:topContent background:someSolidColor
          // inside this RelativeLayout, the stuff that is visible on the ListView
   RelativeLayout id:bottomContent
          // inside this RelativeLayout, the stuff that is behind the content
/FrameLayout 
```

这样一来，您实际上就是将一件事放在另一件事之上。另请注意，topContent 具有纯色背景。如果您不指定任何背景，则两个 RelativeLayouts 都将可见。另请注意，我使用RelativeLayout，只是因为我喜欢它们，而且我喜欢它们的灵活性，但这将取决于您的列表视图的内容和您的设置。

现在，当事情变得有趣时，您将需要一个 GestureDetector 来检测手指滑动，您将使用该值在`id:topContent`.

你可以像这样创建一个 TouchListener：

```
public class MySlideListener extends View.OnTouchListener{

    private View v;
    private GestureDetector gestureDetector;

    public MySlideListener (View v){
        this.v = v;
        gestureDetector = new GestureDetector(v.getContext(), myGestureListener);
    }

   public boolean onTouch (View v, MotionEvent event){
         return gestureDetector.onTouchEvent(event);
   }

    private SimpleOnGestureListener myGestureListener = new SimpleOnGestureListener(){
        @Override
        public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX, float distanceY){

           // now here we make the view scroll
           MarginLayoutParams lp = (MarginLayoutParams) view.getLayoutParams();
           lp.leftMargin = distanceX;
           lp.rightMargin = -distanceX;

          // You might need to call view.requestLayout();
          //  but first give it a try without it

          // This part of the method for processing the horizontal
          // offset can (and should) be further developed to add some
          // 'snap-in' or transparency functionality to make the whole
          // concept work better.
          // But this code should give you a proof of concept on how to deal with stuff.

          // The important part is that now you have a call back that have access
          // to the view during onScroll.

          // Also might be necessary to enable/disable the bottomContent view
          // in order for it to be not clickable whilst not visible.

           return true;
        }
    }
} 
```

然后为每个`topContent`ListView 设置一个新的侦听器（可能在适配器的 getView 内部）`topContentView.setOnTouchListener(new MySlideListener(topContentView));`

请记住，所有这些代码都是我用心输入的，并且 100% 未经测试！

**编辑：**

上面的代码是正确的方向，但它是 100% 未经测试的东西。现在下面的代码，我刚刚编译，测试，这段代码有效！

这个类也更有效率，因为您可以只创建一个并将相同的实例应用于适配器上创建的所有项目。您可以看到它让视图在触摸事件上滚动。

```
public class MySlideListener implements View.OnTouchListener {

    private View view;
    private ListView listView;
    private GestureDetector gestureDetector;

    public MySlideListener(ListView lv) {
        listView = lv;
        gestureDetector = new GestureDetector(lv.getContext(), myGestureListener);
    }

    @Override
    public boolean onTouch(View v, MotionEvent event) {
        view = v;
        gestureDetector.onTouchEvent(event);
        return true;
    }

    private SimpleOnGestureListener myGestureListener = new SimpleOnGestureListener() {

    private int origLeft, origRight;

    public boolean onDown(MotionEvent e) {
        MarginLayoutParams lp = (MarginLayoutParams) view.getLayoutParams();
        origLeft = lp.leftMargin;
        origRight = lp.rightMargin;
        return true;
    };

    public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX, float distanceY) {
        listView.requestDisallowInterceptTouchEvent(true);
        MarginLayoutParams lp = (MarginLayoutParams) view.getLayoutParams();
        lp.leftMargin = (int) (origLeft + (e2.getRawX() - e1.getRawX()));
        lp.rightMargin = (int) (origRight - (e2.getRawX() - e1.getRawX()));
        view.requestLayout();
        return true;
    };
    };
} 
```

# java - Html.ImageGetter 文本视图

> ID：16179285
> 
> 赞同：11
> 
> 时间：2013-04-23T21:13:41.377
> 
> 标签：java, android, textview

所以我使用 ImageGetter 来显示来自 JSON 博客文章的图像。我在日志中获得了正确的来源，但 URL 在到达 setBounds 时会发生变化。有任何想法吗？

代码：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_blog_view);

    Intent intent = getIntent();
    Uri blogUri = intent.getData();
    mPost = blogUri.toString();
    mUrl = getIntent().getStringExtra("mUrl");

    TextView textView = (TextView) findViewById(R.id.scrollView1);
    textView.setText(Html.fromHtml(mPost, imgGetter, null));
}

private ImageGetter imgGetter = new ImageGetter(){
    @Override
    public Drawable getDrawable(String source){
         Drawable drawable = Drawable.createFromPath(source);
        try {
            drawable.setBounds(0, 0, drawable.getIntrinsicWidth(), drawable.getIntrinsicHeight());
        }catch (NullPointerException e){
            logException(e);
        }
        return drawable;
    }
}; 
```

尝试前的“来源”是

[http://www.domain.com/images_blog/feature.png](http://www.domain.com/images_blog/feature.png)

但在捕获错误是：

无法解码流：

```
java.io.FileNotFoundException: /http:/www.domain.com/images_blog/feature.png : open failed: ENOENT (No such file or directory) 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-04-25T08:17:01.543

最简单的解决方案是：

```
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;
import java.net.MalformedURLException;
import java.net.URL;

import org.pskink.soom.R;

import android.app.Activity;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.Drawable;
import android.graphics.drawable.LevelListDrawable;
import android.os.AsyncTask;
import android.os.Bundle;
import android.text.Html;
import android.text.Html.ImageGetter;
import android.text.Spanned;
import android.util.Log;
import android.widget.TextView;

public class TestImageGetter extends Activity implements ImageGetter {
    private final static String TAG = "TestImageGetter";
    private TextView mTv;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.test_image_getter);
        String source = "this is a test of <b>ImageGetter</b> it contains " +
                "two images: <br/>" +
                "<img src=\"http://developer.android.com/assets/images/dac_logo.png\"><br/>and<br/>" +
                "<img src=\"http://developer.android.com/assets/images/icon_search.png\">";

        Spanned spanned = Html.fromHtml(source, this, null);
        mTv = (TextView) findViewById(R.id.text);
        mTv.setText(spanned);
    }

    @Override
    public Drawable getDrawable(String source) {
        LevelListDrawable d = new LevelListDrawable();
        Drawable empty = getResources().getDrawable(R.drawable.ic_launcher);
        d.addLevel(0, 0, empty);
        d.setBounds(0, 0, empty.getIntrinsicWidth(), empty.getIntrinsicHeight());

        new LoadImage().execute(source, d);

        return d;
    }

    class LoadImage extends AsyncTask<Object, Void, Bitmap> {

        private LevelListDrawable mDrawable;

        @Override
        protected Bitmap doInBackground(Object... params) {
            String source = (String) params[0];
            mDrawable = (LevelListDrawable) params[1];
            Log.d(TAG, "doInBackground " + source);
            try {
                InputStream is = new URL(source).openStream();
                return BitmapFactory.decodeStream(is);
            } catch (FileNotFoundException e) {
                e.printStackTrace();
            } catch (MalformedURLException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }
            return null;
        }

        @Override
        protected void onPostExecute(Bitmap bitmap) {
            Log.d(TAG, "onPostExecute drawable " + mDrawable);
            Log.d(TAG, "onPostExecute bitmap " + bitmap);
            if (bitmap != null) {
                BitmapDrawable d = new BitmapDrawable(bitmap);
                mDrawable.addLevel(1, 1, d);
                mDrawable.setBounds(0, 0, bitmap.getWidth(), bitmap.getHeight());
                mDrawable.setLevel(1);
                // i don't know yet a better way to refresh TextView
                // mTv.invalidate() doesn't work as expected
                CharSequence t = mTv.getText();
                mTv.setText(t);
            }
        }
    }
} 
```

在图像下载后重新布局 TextView 有一种不太优雅的方法：

```
// i don't know yet a better way to refresh TextView
// mTv.invalidate() doesn't work as expected
CharSequence t = mTv.getText();
mTv.setText(t); 
```

如果有人知道更好的解决方案，请告诉我

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2019-09-25T05:09:00.747

使用`Glide`并`Coroutines`假设不需要重试的替代解决方案：

```
import android.content.res.Resources
import android.graphics.Bitmap
import android.graphics.Canvas
import android.graphics.drawable.BitmapDrawable
import android.graphics.drawable.Drawable
import android.text.Html
import android.widget.TextView
import androidx.lifecycle.LifecycleCoroutineScope
import com.bumptech.glide.RequestManager
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch
import kotlinx.coroutines.withContext
import kotlin.math.roundToInt

class HtmlImageGetter(
    private val scope: LifecycleCoroutineScope,
    private val res: Resources,
    private val glide: RequestManager,
    private val htmlTextView: TextView
) : Html.ImageGetter {

    override fun getDrawable(url: String): Drawable {
        val holder = BitmapDrawablePlaceHolder(res, null)

        scope.launch(Dispatchers.IO) {
            runCatching {
                val bitmap = glide
                    .asBitmap()
                    .load(url)
                    .submit()
                    .get()

                val drawable = BitmapDrawable(res, bitmap)

                val scale = 1.25 // This makes the image scale in size.
                val width = (drawable.intrinsicWidth * scale).roundToInt()
                val height = (drawable.intrinsicHeight * scale).roundToInt()
                drawable.setBounds(0, 0, width, height)

                holder.setDrawable(drawable)
                holder.setBounds(0, 0, width, height)

                withContext(Dispatchers.Main) { htmlTextView.text = htmlTextView.text }
            }
        }

        return holder
    }

    internal class BitmapDrawablePlaceHolder(res: Resources, bitmap: Bitmap?) : BitmapDrawable(res, bitmap) {
        private var drawable: Drawable? = null

        override fun draw(canvas: Canvas) {
            drawable?.run { draw(canvas) }
        }

        fun setDrawable(drawable: Drawable) {
            this.drawable = drawable
        }
    }
} 
```

在 a `Fragment`or`Activity`中使用`HtmlCompat`

```
val imageGetter = HtmlImageGetter(lifecycleScope, resources, glide, htmlTextView)
val styledText = HtmlCompat.fromHtml(htmlString, flags, imageGetter, null)
htmlTextView.text = styledText 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-03T13:47:06.553

如果你有 mTV（我的意思是 TextView），你可以根据它的尺寸（mTv.getWidth() 和 mTv.getHeight()）和创建的位图的尺寸（bitmap.getWidth() 和 bitmap.getHeight()）计算并设置这些值作为 TextView (mTv) 的新维度。

```
 if (bitmap != null) {
            BitmapDrawable d = new BitmapDrawable(bitmap);
            mDrawable.addLevel(1, 1, d);
            int width = mTv.getWidth() < bitmap.getWidth() ? mTv.getWidth() : bitmap.getWidth();
            int height = bitmap.getHeight() * width / bitmap.getWidth();
            mDrawable.setBounds(0, 0, width, height);
            mDrawable.setLevel(1);
            // i don't know yet a better way to refresh TextView 
            // mTv.invalidate() doesn't work as expected 
            // but we can calculate new TextView dimensions
            mTv.setHeight(height);
            CharSequence t = mTv.getText();
            mTv.setText(t);
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-19T07:29:42.853

这个答案可能会对某人有所帮助。我使用 Jsoup`<Img/>`从字符串中提取标签，然后在.in`ImageView`和`<p>`in 中显示图像`Textview`。结果是根据我需要的。我还使用 Universal Image Loader Libaray 来加载图像`ImageView`然后我以编程方式将视图添加到布局中，我的案例布局是线性布局，所以我创建了一个辅助类并传递内容、html 字符串和线性布局作为参数。

在您的项目中添加 jsoup。

```
compile 'org.jsoup:jsoup:1.9.2' 
```

这里有一些片段。

```
public class PostContentHandler {
Context context;
String content;
LinearLayout linearLayout;

public PostContentHandler(Context context, String content, LinearLayout linearLayout) {
    this.context = context;
    this.content = content;
    this.linearLayout = linearLayout;

}

public void setContentToView() {

    //custom font
    Typeface bitterBoldFont = Typeface.createFromAsset(context.getAssets(), "fonts/Bitter-Regular.otf");

    List<String> p = new ArrayList<>();
    List<String> src = new ArrayList<>();
    List<String> li = new ArrayList<>();
    Document doc = Jsoup.parse(content);

    Elements elements = doc.getAllElements();

    for (Element element : elements) {
        Tag tag = element.tag();
        if (tag.getName().matches("h[1-6]{1}")) {
            String heading = element.select(tag.getName().toString()).text();
            TextView textView = new TextView(context);
            textView.setLayoutParams(new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT,
                    LinearLayout.LayoutParams.WRAP_CONTENT));
            LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) textView.getLayoutParams();
            int top = (int) context.getResources().getDimension(R.dimen.heading_margin_top);
            int start = (int) context.getResources().getDimension(R.dimen.content_margin);
            int end = (int) context.getResources().getDimension(R.dimen.content_margin);
            params.setMargins(start, top, end, 0);
            textView.setTextSize(20);
            textView.setTypeface(bitterBoldFont);
            textView.setText(heading);
            textView.setTextColor(context.getResources().getColor(R.color.black));
            linearLayout.addView(textView);
        }
 if (tag.getName().equalsIgnoreCase("p")) {
            element.select("img").remove();
            String body = element.html();
            TextView textView = new TextView(context);
            textView.setLayoutParams(new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT,
                    LinearLayout.LayoutParams.WRAP_CONTENT));
            LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) textView.getLayoutParams();
            int top = (int) context.getResources().getDimension(R.dimen.heading_margin_top);
            int start = (int) context.getResources().getDimension(R.dimen.content_margin);
            int end = (int) context.getResources().getDimension(R.dimen.content_margin);
            params.setMargins(start, top, end, 0);
            textView.setTypeface(bitterBoldFont);
            textView.setLinksClickable(true);
            textView.setAutoLinkMask(Linkify.WEB_URLS);
            textView.setText(Html.fromHtml(body));
            textView.setTextColor(context.getResources().getColor(R.color.content_color));
            linearLayout.addView(textView);
            p.add(body);
        }
        if (tag.getName().equalsIgnoreCase("ol")) {
            String ol = element.select(tag.getName().toString()).outerHtml();
            TextView textView = new TextView(context);
            textView.setLayoutParams(new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT,
                    LinearLayout.LayoutParams.WRAP_CONTENT));
            LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) textView.getLayoutParams();
            params.setMarginStart((int) context.getResources().getDimension(R.dimen.content_margin));
            int top = (int) context.getResources().getDimension(R.dimen.heading_margin_top);
            int start = (int) context.getResources().getDimension(R.dimen.content_margin);
            int end = (int) context.getResources().getDimension(R.dimen.content_margin);
            params.setMargins(start, top, end, 0);
            textView.setTypeface(bitterBoldFont);
            textView.setLinksClickable(true);
            textView.setAutoLinkMask(Linkify.WEB_URLS);
            textView.setTextColor(context.getResources().getColor(R.color.content_color));
            textView.setText(Html.fromHtml(ol, null, new MyTagHandler()));
            linearLayout.addView(textView);

        }
        if (tag.getName().equalsIgnoreCase("ul")) {
            String ul = element.select(tag.getName().toString()).outerHtml();
            TextView textView = new TextView(context);

            textView.setLayoutParams(new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT,
                    LinearLayout.LayoutParams.WRAP_CONTENT));
            LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) textView.getLayoutParams();
            int top = (int) context.getResources().getDimension(R.dimen.heading_margin_top);
            int start = (int) context.getResources().getDimension(R.dimen.content_margin);
            int end = (int) context.getResources().getDimension(R.dimen.content_margin);
            params.setMargins(start, top, end, 0);
            textView.setTypeface(bitterBoldFont);
            textView.setLinksClickable(true);
            textView.setAutoLinkMask(Linkify.WEB_URLS);
            textView.setTextColor(context.getResources().getColor(R.color.content_color));
            textView.setText(Html.fromHtml(ul, null, new MyTagHandler()));
            linearLayout.addView(textView);
        }
        if (tag.getName().equalsIgnoreCase("img")) {
            String url = element.select("img").attr("src");
            final ImageView imageView = new ImageView(context);
            imageView.setLayoutParams(new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT,
                    LinearLayout.LayoutParams.WRAP_CONTENT));
            final ProgressBar progressBar = new ProgressBar(context);
            linearLayout.addView(progressBar);
            progressBar.setVisibility(View.GONE);
            ImageLoader imageLoader = ImageLoader.getInstance();
            imageLoader.displayImage(url, imageView, new SimpleImageLoadingListener() {
                @Override
                public void onLoadingComplete(String imageUri, View view, Bitmap loadedImage) {
                    super.onLoadingComplete(imageUri, view, loadedImage);
                    progressBar.setVisibility(View.INVISIBLE);
                    int height = loadedImage.getHeight();
                    imageView.getLayoutParams().height = getScreenWidth();
                    imageView.setAdjustViewBounds(true);
                    imageView.requestLayout();
                }

                @Override
                public void onLoadingStarted(String imageUri, View view) {
                    super.onLoadingStarted(imageUri, view);
                    progressBar.setVisibility(View.VISIBLE);
                }
            });
            linearLayout.addView(imageView);
            src.add(url);
        }

    }
}

public static int getScreenWidth() {
    return Resources.getSystem().getDisplayMetrics().widthPixels;
}
} 
```

我希望我的回答对某人有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-07T16:03:15.910

如果你有 mTV（我的意思是 TextView），你可以根据它的尺寸（mTv.getWidth() 和 mTv.getHeight()）和创建的位图的尺寸（bitmap.getWidth() 和 bitmap.getHeight()）计算并设置这些值作为 TextView (mTv) 的新维度。

# asp.net-mvc - AJAX CSRF 攻击和 .Net MVC

> ID：16179289
> 
> 赞同：2
> 
> 时间：2013-04-23T21:13:45.587
> 
> 标签：asp.net-mvc, asp.net-web-api, xss, antiforgerytoken, asp.net-mvc-ajax

这篇文章描述了所有 JSON HttpGet 和 HttpPost AJAX 调用的标记系统：

简而言之，您使用 AntiForgeryToken 属性在页面上创建一个令牌，然后手动验证该值是否通过 AJAX 调用发送回控制器。

[http://www.asp.net/web-api/overview/security/preventing-cross-site-request-forgery-(csrf)-attacks](http://www.asp.net/web-api/overview/security/preventing-cross-site-request-forgery-(csrf)-attacks)

经过数小时的互联网侦查，总是有人提到这种可能性，但没有人真正实现它。相反，通常重复的技术是 1) 仅使用 HttpPost AJAX 请求（这会破坏 REST），2) 将所有 json 响应包装在一个匿名对象中，这会导致 .net MVC4 中的代码非常不优雅，3) 使用无法解析的 cruf，这会破坏常用库，例如​​主干.js

**那么为什么我们不都使用上面链接的令牌系统呢？我错过了什么？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T03:32:58.380

如果您关心 CSRF，并且您关心 REST 并正确执行 REST，那么您不应该在 GET 中做任何会受 CSRF 影响的事情，因为 AntiForgeryTokens 的全部目的是处理不断变化的数据（即，如果不首先获取包含令牌的页面，则不能使用 AntiForgeryToken）。

因此，说使用 POST“破坏 REST”似乎首先误解了您使用令牌的目的。确实，GET 可以暴露敏感信息，但是如果您想将它与 GET 一起使用，则必须先有某种方法来获取令牌。

Ajax 和 AntiForgeryToken 与 json 和 Ajax 的真正问题是“内置”验证仅适用于表单值，而不适用于 json。因此，您必须自己进行验证，并且您链接到的那篇文章很好地解释了如何做到这一点。

# entity-framework - 将 EF Code First 同步到 SQL Azure

> ID：16179290
> 
> 赞同：4
> 
> 时间：2013-04-23T21:13:50.283
> 
> 标签：entity-framework, visual-studio-2012, ef-code-first, azure-sql-database, database-migration

我正在尝试找到在不使用 EFCF 迁移的情况下将 EF Code First 数据库从本地主机同步/迁移到 SQL Azure 的最佳方法。我知道我可以使用这种方法，但我想看看不同的、不那么自动化的选项。

以下过程或类似过程的变体是我想要遵循的过程：

1.  在本地开发，让 EFCF 在 localhost 上构建数据库
2.  使用某些工具将本地数据库与 SQL Azure 上的阶段数据库同步
3.  在暂存环境中运行测试
4.  将数据库（本地或阶段）同步/迁移到 SQL Azure 上的生产数据库

使用 MySQL，这是一件轻而易举的事。[MySQL Workbench](http://dev.mysql.com/doc/workbench/en/index.html)可以将模式模型同步到相关数据库，简单明了。在这种情况下，我本身没有模式模型，但是 EFCF 生成的 localhost 上的数据库可以被认为是模式。

哪些工具可用于执行此任务？是否可以使用 SSMS 执行此操作？

**更新：我是如何做到**的：在 Craig 提示使用 Visual Studio 2012 数据库项目之后，我做了以下事情：

1.  创建了一个空的 VS 2012 数据库项目并将其目标平台设置为 SQL Azure
2.  是否进行了新架构比较，源数据库 = 本地数据库和目标 = 数据库项目
3.  更新了目标。这使数据库项目加快了速度
4.  做了一个新的比较，源 = 数据库项目和目标 = SQL Azure 阶段数据库
5.  更新了目标。这使 SQL Azure 阶段数据库加速

这正是我想要的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T00:35:39.283

Visual Studio 2012 数据库项目可以做到，我一直都在做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T22:29:34.187

它不是免费的，但 Red-Gate 的[SQL 比较](http://www.red-gate.com/products/sql-development/sql-compare/)会处理模式复制

# asp.net-mvc - System.Web.Optimization 和 Microsoft.Web.Optimization 不会在 vs 2012 中加载参考

> ID：16179293
> 
> 赞同：34
> 
> 时间：2013-04-23T21:13:53.057
> 
> 标签：asp.net-mvc, asp.net-optimization

我正在开发一个从 Visual Studio 2010 开始的 MVC 4 项目。现在我正在使用 Visual Studio 2012 的机器上工作，因为我无法访问我最初正在使用的机器。我整个早上都在努力寻找答案，但它们似乎对我的情况没有帮助。

我遵循[如何为 MVC-3-converted-to-4 应用程序添加对 System.Web.Optimization 的引用，](https://stackoverflow.com/questions/9475893/how-to-add-reference-to-system-web-optimization-for-mvc-3-converted-to-4-app)并从 nuget 直接安装到我的解决方案中。即使我已经在我的机器上下载并安装了所有必需的参考包，但`System.Web.Optimization`仍然丢失。还有什么我可以做的吗？

编辑：当我尝试构建项目时，我收到以下错误

*   命名空间“System.Web”中不存在类型或命名空间名称“优化”（您是否缺少程序集引用？） - BundleConfig.cs
*   命名空间“System.Web”中不存在类型或命名空间名称“优化”（您是否缺少程序集引用？） - Global.asax.cs
*   找不到类型或命名空间“BundleCollection”（您是否缺少 using 指令或程序集引用？） - BundleConfig.cs

我的 BundleConfig.cs 包含

```
using System.Web;
using System.Web.Optimization;

namespace BCCDC_AdminTool
{
    public class BundleConfig
    {
     // For more information on Bundling, visit http://go.microsoft.com/fwlink/?    LinkId=254725
    public static void RegisterBundles(BundleCollection bundles)
    {
           bundles.Add(new ScriptBundle("~/bundles/jquery").Include(
                    "~/Scripts/jquery-{version}.js"));

           bundles.Add(new ScriptBundle("~/bundles/jqueryui").Include(
                    "~/Scripts/jquery-ui-{version}.js"));

            bundles.Add(new ScriptBundle("~/bundles/jqueryval").Include(
                    "~/Scripts/jquery.unobtrusive*",
                    "~/Scripts/jquery.validate*"));

        // Use the development version of Modernizr to develop with and learn from. Then, when you're
        // ready for production, use the build tool at http://modernizr.com to pick only the tests you need.
            bundles.Add(new ScriptBundle("~/bundles/modernizr").Include(
                    "~/Scripts/modernizr-*"));

            bundles.Add(new StyleBundle("~/Content/css").Include("~/Content/site.css"));

            bundles.Add(new StyleBundle("~/Content/themes/base/css").Include(
                    "~/Content/themes/base/jquery.ui.core.css",
                    "~/Content/themes/base/jquery.ui.resizable.css",
                    "~/Content/themes/base/jquery.ui.selectable.css",
                    "~/Content/themes/base/jquery.ui.accordion.css",
                    "~/Content/themes/base/jquery.ui.autocomplete.css",
                    "~/Content/themes/base/jquery.ui.button.css",
                    "~/Content/themes/base/jquery.ui.dialog.css",
                    "~/Content/themes/base/jquery.ui.slider.css",
                    "~/Content/themes/base/jquery.ui.tabs.css",
                    "~/Content/themes/base/jquery.ui.datepicker.css",
                    "~/Content/themes/base/jquery.ui.progressbar.css",
                    "~/Content/themes/base/jquery.ui.theme.css"));
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2013-07-22T13:01:08.747

我在 VS2012 中打开的 VS2010 项目遇到了同样的问题。Microsoft.AspNet.Web.Optimization 包丢失了，所以我只需要使用 Nuget 包管理器下载它。

您可以在控制台中运行：`Install-Package Microsoft.AspNet.Web.Optimization`

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2013-07-01T09:08:14.683

我知道这很令人困惑，但你需要`Install-Package Microsoft.AspNet.Web.Optimization`

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-02-19T16:49:00.420

尝试转到 Views 文件夹中的 web.config 并删除以下行：

```
 <add namespace="System.Web.Optimization" /> 
```

那为我修好了。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-04-23T21:52:22.127

这是一个很长的镜头，但无论如何，右键单击项目 --> 属性页并确保 System.Web.Optimization 条目存在。如果没有，请将 System.Web.Optimization.dll 复制到您的 bin 文件夹或将其作为参考导入。

编辑：mvc 项目没有“属性页”菜单选项。

您可以尝试的另一件事是创建一个新的 mvc4 基本项目，转到解决方案的 bin 文件夹并将 System.Web.Optimization.dll 复制到另一个给您错误的项目的 bin 文件夹中。如果找不到 dll，请尝试更新 nuget 包。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-10-29T18:39:02.560

我为此奋斗了一个小时，但上述建议都没有奏效。最后只有以下工作（出于某种迟钝的原因）：

1.  ctrl-q -> 输入“包管理器控制台”
2.  `Uninstall-Package Microsoft.AspNet.Web.Optimization <problem project name>`
3.  `Install-Package Microsoft.AspNet.Web.Optimization <problem project name>`

### 警告/警告

*   以上将安装最新版本的`Microsoft.AspNet.Web.Optimization`. 如果您想要特定版本（例如 v1.1.1），请使用`Install-Package Microsoft.AspNet.Web.Optimization <problem project name> -Version 1.1.1`
*   不要忘记`<problem project name>`参数或 nuget 将在解决方案级别运行，可能会践踏兄弟项目。
*   请注意，省略项目名称本身对于进行解决方案级别的版本更新或包安装非常方便。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-04-24T10:26:51.250

转到工具 >> 库包管理器 >> 管理 Nuget 包 >> 安装 Microsoft ASP.NET Web 优化框架

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-08-22T10:24:12.613

卸载并重新安装 Microsoft.AspNet.Web.Optimization 包为我解决了这个问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-01-28T20:15:17.160

我通过将对程序集 System.Web.Optimization.dll 的引用设置为将本地复制为 true 来解决此问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-02-23T01:32:01.063

使用 Nuget 包管理器重新安装 system.web.optimizaiton 为我解决了这个问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-10-21T15:55:21.723

在特定场景中对我有用的（我从源代码管理下载了一个 MVC 项目并收到该错误）是在同一解决方案上打开一个新的 MVC 项目。之后我可以删除我创建的新项目，它仍然有效（在 VS2012 上）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-04-29T18:49:41.323

简单的解决方案。以管理员模式打开 Visual Studio。它将解决您的错误。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2015-04-16T16:35:59.683

我知道这个问题有很多答案，但试一试——以管理员身份在 Visual Studio 中打开项目。它确实解决了我的情况。

# asp.net - 如何使用 CSS 重新定位此图像？

> ID：16179294
> 
> 赞同：3
> 
> 时间：2013-04-23T21:13:53.517
> 
> 标签：asp.net, css

在此图像中，您会看到相同元素的两个版本。顶部是我得到的，底部是我想要结束的。当然，图像的底部与标签中的文本和文本框中的文本对齐，但我需要它与文本框的框对齐。我在 CSS 方面有点新手，到目前为止我尝试过的事情并没有让我脱离困境。

![在此处输入图像描述](https://i.stack.imgur.com/9iBdH.png)

控件编码如下：

```
<asp:Label ID="TimeTextRequiredLabel" runat="server" Text="*"></asp:Label>
<asp:Label ID="TimeTextLabel" runat="server" Text="Time:&nbsp;"></asp:Label>
<asp:TextBox ID="TimeTextBox" runat="server" ReadOnly="false" Width="100"></asp:TextBox>
<asp:Image ID="TimePickerImageButton" runat="server" BorderWidth="0"
     Width="34" Height="21"  CssClass="TimePickerImage"
    ImageUrl="~/UserControls/Images/ClockPicker.gif" 
    ToolTip="Pick a time." /> 
```

我的 CSS 中应该包含什么，在“TimePickerImage”类中以向左和向下移动几个必要的像素？

**编辑添加：**

最终选择了@JuanMendes 解决方案，以及这个类：

```
<style type="text/css">
    .TimePickerImage {
        position: relative;
        top: .2em;
        right: .3em;
    } 
</style> 
```

这正好在我需要的地方紧贴它。谢谢！下一个任务是认真学习 CSS。到目前为止，我一直在用它玩脚本小子。

**进一步编辑添加：**

我已经尝试了@MarcAudet 和@JuanMendes 提出的所有其他变体，上面的代码效果最好。我想我不太在乎是否符合一些理论上的“理想”，而是让事情达到我需要的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:17:40.283

您需要添加或调整`vertical-align: bottom`声明`#TimePickerImageButton`

从您的屏幕截图中，图像似乎与文本行的基线对齐，这是内联图像的默认行为。

`vertical-align`将负责垂直定位。

要将元素向左移动，请尝试调整`margin-left`. 但是，请检查输入字段的边距，因为它可能有边距，并且还要在输入字段和图像之间寻找一些空白区域。

**演示**

如果您有以下 HTML：

```
<div class="parent ex2">
    <label for="the-time">Time:</label>
    <input id="the-time" type="text">
    <img src="http://placehold.it/30x25">
</div> 
```

并应用以下 CSS：

```
.ex2 img {
    vertical-align: bottom;
} 
```

你会看到你想要的定位。

小提琴：http: [//jsfiddle.net/audetwebdesign/2PkUF/](http://jsfiddle.net/audetwebdesign/2PkUF/)

**如果你有高大的线条...**

如果为 应用更大的值`line-height: 4.0`，将元素对齐到行框底部可能看起来很愚蠢。

您也可以尝试`vertical-align: text-bottom`哪个应该有效。

请参阅演示中的示例 3。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:37:53.333

你总是可以欺骗和定位图像自己捏造值直到它排队（如果你找不到更好的方法）[http://jsfiddle.net/vTCHW/](http://jsfiddle.net/vTCHW/)

在 FF、IE 8/9 和 Chrome 中测试

```
img {
    position: relative;
    top: .3em;
} 
```

您提到[Marc 的回答](https://stackoverflow.com/a/16179349/227299)几乎足够好。我认为这是一个更好的解决方案。您可以通过从输入中删除填充/边距来正确排列所有三个。[http://jsfiddle.net/vTCHW/1/](http://jsfiddle.net/vTCHW/1/)请注意，许多人使用[CSS 重置系统](http://yuilibrary.com/yui/docs/cssreset/)会为您处理边距/填充

```
img {
    vertical-align: bottom;
}

input {
    padding: 0;
    margin: 0;    
} 
```

# php - 如何设置样式两个 foreach 语句输出 PHP

> ID：16179298
> 
> 赞同：-2
> 
> 时间：2013-04-23T21:14:07.510
> 
> 标签：php, html, foreach, html-table

如何将第一个 foreach 语句的输出放在表的一列中，将另一个 foreach 语句的输出放在另一列中。我尝试了一些东西，但出于某种原因，它把它全部放在了一个列中。这是我的代码：

```
<table border="0" align="center">
<?php
foreach($anchors as $a) {
    $text = $a->nodeValue;
    $href = $a->getAttribute('href');
    $i++;

    if ($i > 16) {
        if (strpos($text, "by owner") === false) {
            if (strpos($text, "map") === false) {
                echo "<tr><td><a href =' ".$href." '>".$text."</a><br/></td></tr>";
            }
        }
    }
    foreach($span as $s) {
        echo "<tr><td>".$s->nodeValue."</td></tr>";
    }
}
?>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:27:07.403

`<tr></tr>`标记一行。`<td></td>`标记一列。要制作 2 列，每次迭代只使用一组`<tr>`标签，它们之间有两组`<td></td>`s。

也就是说，究竟是`$span`什么？它是否包含与 相同数量的元素`$anchors`，并且您希望每行显示一个项目？如果是这样，您将需要稍微重构您的代码。有几种方法可以做到这一点——这里有一个简单的方法：

```
<table border="0" align="center">
<?php

$i = 0;

foreach($anchors as $a) {
    echo "<tr>";

    $text = $a->nodeValue;
    $href = $a->getAttribute('href');

    if ($i >= 16) {
        if (strpos($text, "by owner") === false) {
            if (strpos($text, "map") === false) {
                echo "<td><a href =' ".$href." '>".$text."</a><br/></td>";
            }
        }
    } else {
       echo "<td></td>";    #output a blank cell in the first column
    }

    echo "<td>" . $span[$i]->nodeValue . "</td>";
    echo "</tr>";

    ++$i
}
?>
</table> 
```

编辑：看起来你`$span`是一个 DOMNodeList 对象，而不是一个数组。我没有这方面的经验，但看起来您可以使用该`DOMNodelist::item`函数来获取列表中的当前项目（参见[http://php.net/manual/en/domnodelist.item.php](http://php.net/manual/en/domnodelist.item.php)）：

```
echo "<td>" . $span->item($i)->nodeValue . "</td>"; 
```

因此，请尝试更改我对此的回答中的相应行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:38:27.877

没有数据的想法很难，但可能是这样的：

```
 // start a table
   echo '<table>';

   // for as long as there are elements in both span and anchors
   for ($i=0; $i < $anchors->length && $i < $span->length; $i++) { 
       // start a new table row
       echo '<tr>';

       // get the current span and anchor
       $a = $anchors->item($i);
       $s = $span->item($i);

       // print them
       $text = $a->nodeValue;
       $href = $a->getAttribute('href');
       // col 1, number
       echo '<td>'.$i.'</td>';
       // col 2, anchor
       echo '<td><a href ="' .$href. '">'.$text.'</a></td>';
       // col 3, span
       echo '<td>'.$s->nodeValue.'</td>';

       // close the table row
       echo '</tr>';
    }

    // close the table
    echo '</table>'; 
```

（代码未测试）没有实际数据很难更具体。

~~这使用php 内置的[“当前”](http://www.php.net/manual/en/function.current.php)和[“下一个” 。](http://www.php.net/manual/en/function.next.php)~~

一些提示/备注/旁注可能对您有所帮助：
- 请注意，我使用了单引号，因为它们的性能要好得多（双引号将由 php 解释）。
- 尝试使用尽可能少的循环（for、while、foreach）。它们是一个强大的工具，但会迅速耗尽内存和性能！
- 只有在使用多个维度时才嵌套循环（数组内的数组），这里不是这种情况（我认为）
- 尝试限制嵌套块的数量（如果在内部，如果在内部，如果在内部循环中）。我尽量不深入到 2 个级别（这不是绝对的规则，只是一个很好的标准）。如果不可能，请创建一个函数。
-**评论你的代码！**我很难理解你的代码（我每天都写 PHP 为生），我可以想象你会在几周内完成。评论可能看起来很浪费时间，但它会大大简化调试，并且在以后更新您（或其他人）代码时是一种祝福！

**编辑：**
我刚刚注意到你没有使用 DOMNodeList 而不是数组，所以我更新了我的代码。应该可以正常工作，并且代码更清晰。就像我说的，很难没有看到数据......

# sql - 根据持续时间的月数计算不同的成员

> ID：16179299
> 
> 赞同：1
> 
> 时间：2013-04-23T21:14:14.797
> 
> 标签：sql, sql-server

我有一个包含以下列的成员资格表：

```
Member_number  | StartDate   | EndDate
XYZ            | 01-Jan-2002 | 01-March-2002 
ABC            | 01-Feb-2002 | 01-March-2002 
```

基本上，我想显示特定月份有多少成员在场。我的问题是我不知道如何将这段时间分成几个月。我怎样才能看到这个结果？

```
Month  |  NumberOfMembers
Jan    |  1
Feb    |  2
March  |  2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T23:01:33.100

给定一个看起来像这样的成员表：

```
create table dbo.members
(
  member_number int      not null primary key ,
  start_date    datetime not null ,
  end_date      datetime not null ,
) 
```

还有一个生成连续整数序列的表值函数，如下所示：

```
create function dbo.IntegerRange ( @from int , @thru int )
returns @sequence table
(
  value int not null primary key clustered
)
as
begin

  declare @increment int = case when @from > @thru then -1 else 1 end ;

  with sequence(value) as
  (
      select value = @from
    union all
      select value + @increment
      from sequence
      where value < @thru
  )
  insert @sequence
  select value
  from sequence
  order by value
  option ( MAXRECURSION 0 )

  return

end 
```

像这样的查询应该给你你想要的：

```
select [year]     = period.yyyy ,
       [month]    = case period.mm ,
                    when  1 then 'Jan'
                    when  2 then 'Feb'
                    when  3 then 'Mar'
                    when  4 then 'Apr'
                    when  5 then 'May'
                    when  6 then 'Jun'
                    when  7 then 'Jul'
                    when  8 then 'Aug'
                    when  9 then 'Sep'
                    when 10 then 'Oct'
                    when 11 then 'Nov'
                    when 12 then 'Dev'
                    else         '***'
                    end ,
       member_cnt = sum( case when m.member_number is not null then 1 else 0 end )
from ( select yyyy   = yyyy.value ,
              mm     = mm.value ,
              dtFrom = dateadd( month , mm.value - 1 , dateadd( year , yyyy.value - 1900 , convert(date,'') ) ) ,
              dtThru = dateadd( day , - 1 , dateadd( month , mm.value     , dateadd( year , yyyy.value - 1900 , convert(date,'') ) ) )
       from      dbo.IntegerRange(2000,2013) yyyy
       full join dbo.IntegerRange(1,12)      mm   on 1=1
     ) period
left join dbo.members m on period.dtFrom <= m.end_date
                       and period.dtThru >= m.start_date
group by period.yyyy ,
         period.mm
order by period.yyyy ,
         period.mm 
```

子句中的第一个表表达式`from`创建了一个涵盖报告期间的期间（在本例中为几个月，但该技术不将自身限制为几个月甚至几周）的虚拟表：

```
from ( select yyyy   = yyyy.value ,
              mm     = mm.value ,
              dtFrom = dateadd( month , mm.value - 1 , dateadd( year , yyyy.value - 1900 , convert(date,'') ) ) ,
              dtThru = dateadd( day , - 1 , dateadd( month , mm.value     , dateadd( year , yyyy.value - 1900 , convert(date,'') ) ) )
       from      dbo.IntegerRange(2000,2013) yyyy
       full join dbo.IntegerRange(1,12)      mm   on 1=1
     ) period 
```

然后通过 a 将其连接起来`left outer join`，确保将*所有*期间（而不仅仅是那些具有活跃成员的期间）报告到成员表中，以针对上述虚拟`period`表中的每个报告期收集在该期间活跃的成员集：

```
left join dbo.members m on period.dtFrom <= m.end_date
                       and period.dtThru >= m.start_date 
```

然后我们按每个时期的年和月分组，然后按年/月数对结果进行排序：

```
group by period.yyyy ,
         period.mm
order by period.yyyy ,
         period.mm 
```

在创建要返回的结果集时，我们返回期间的年份、月份数（转换为友好名称）和活动成员的数量。请注意，我们必须在`sum()`此处使用聚合函数，而不是`count()`因为空句点将返回单行（`null`在所有列中）。`Count()`与所有其他聚合函数不同，它`null`在聚合中包含值。`Sum()`应用于作为判别函数的 case 表达式，返回 1 或 0，标识该行是表示有用数据还是缺失数据：

```
select [year]     = period.yyyy ,
       [month]    = case period.mm ,
                    when  1 then 'Jan'
                    when  2 then 'Feb'
                    when  3 then 'Mar'
                    when  4 then 'Apr'
                    when  5 then 'May'
                    when  6 then 'Jun'
                    when  7 then 'Jul'
                    when  8 then 'Aug'
                    when  9 then 'Sep'
                    when 10 then 'Oct'
                    when 11 then 'Nov'
                    when 12 then 'Dev'
                    else         '***'
                    end ,
       member_cnt = sum( case when m.member_number is not null then 1 else 0 end ) 
```

简单的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T22:00:20.040

```
DECLARE @minMonth DATE
SELECT @minMonth = MIN(StartDate) FROM Table1

DECLARE @maxMonth DATE
SELECT @maxMonth = MAX(EndDate) FROM Table1

;WITH CTE_Months AS
(
    SELECT @minMonth AS Mnth
    UNION ALL
    SELECT DATEADD(MM,1,Mnth) FROM  CTE_Months
    WHERE Mnth<@MaxMonth
)
SELECT Mnth AS Month, COUNT(*) as Members
FROM CTE_Months m
LEFT JOIN Table1 t on m.Mnth BETWEEN t.StartDate AND t.EndDate
GROUP BY Mnth 
```

**[SQLFiddle 演示](http://www.sqlfiddle.com/#!6/3222b/2)**

CTE 将查找从 min StartDate 到 max EndDate 的所有月份，如果您需要不同的 min 和 max，只需更改获取 @MinMonth 和 @MaxMonth 的方式

如果您不想在可能没有任何成员的月份显示零，请在末尾将 LEFT JOIN 替换为 INNER。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:18:36.490

```
select t.Month, count(*) Members
from (
  select case  
    when startdate <= to_date('01-Jan-2002', 'DD-MON-YYYY') AND enddate >= to_date('31-Jan-2002', 'DD-MON-YYYY') then ' Jan'
    when startdate <= to_date('01-Feb-2002', 'DD-MON-YYYY') AND enddate >= to_date('28-Feb-2002', 'DD-MON-YYYY') then ' Feb'
    when startdate <= to_date('01-Mar-2002', 'DD-MON-YYYY') AND enddate >= to_date('31-Mar-2002', 'DD-MON-YYYY') then ' Mar'
    when startdate <= to_date('01-Apr-2002', 'DD-MON-YYYY') AND enddate >= to_date('30-Apr-2002', 'DD-MON-YYYY') then ' Apr'
    when startdate <= to_date('01-May-2002', 'DD-MON-YYYY') AND enddate >= to_date('31-May-2002', 'DD-MON-YYYY') then ' May'
    when startdate <= to_date('01-Jun-2002', 'DD-MON-YYYY') AND enddate >= to_date('30-Jun-2002', 'DD-MON-YYYY') then ' Jun'
    when startdate <= to_date('01-Jul-2002', 'DD-MON-YYYY') AND enddate >= to_date('31-Jul-2002', 'DD-MON-YYYY') then ' Jul'
    when startdate <= to_date('01-Aug-2002', 'DD-MON-YYYY') AND enddate >= to_date('31-Aug-2002', 'DD-MON-YYYY') then ' Aug'
    when startdate <= to_date('01-Sep-2002', 'DD-MON-YYYY') AND enddate >= to_date('30-Sep-2002', 'DD-MON-YYYY') then ' Sep'
    when startdate <= to_date('01-Oct-2002', 'DD-MON-YYYY') AND enddate >= to_date('31-Oct-2002', 'DD-MON-YYYY') then ' Oct'
    when startdate <= to_date('01-Nov-2002', 'DD-MON-YYYY') AND enddate >= to_date('30-Nov-2002', 'DD-MON-YYYY') then ' Nov'
    when startdate <= to_date('01-Dec-2002', 'DD-MON-YYYY') AND enddate >= to_date('31-Dec-2002', 'DD-MON-YYYY') then ' Dec'
  end as Month
from member) t
group by t.Month 
```

`member`表名在哪里。

# qt - 通过确定性设备播放 QSound

> ID：16179302
> 
> 赞同：0
> 
> 时间：2013-04-23T21:14:22.770
> 
> 标签：qt

有没有办法让 QSound 通过我的程序选择的设备播放我的声音文件，而不是总是通过系统当前的默认音频设备进行路由？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T02:56:24.387

[`Phonon`](http://qt-project.org/doc/qt-4.8/phonon-module.html)我认为给你更多的选择，但`QSound`你的选择非常有限。您可以尝试一些特定于操作系统的方法来使用不同的音频设备。

这是在 Windows 中执行此操作的一种可能方法。

[http://www.daveamenta.com/2011-05/programmatically-or-command-line-change-the-default-sound-playback-device-in-windows-7/](http://www.daveamenta.com/2011-05/programmatically-or-command-line-change-the-default-sound-playback-device-in-windows-7/)

[http://www.google.com/search?q=windows+change+sound+output+device+c%2B%2B](http://www.google.com/search?q=windows+change+sound+output+device+c%2B%2B)

希望有帮助。

# highcharts - highcharts 图例条目在 Firefox 中不可点击

> ID：16179304
> 
> 赞同：0
> 
> 时间：2013-04-23T21:14:31.370
> 
> 标签：highcharts

我设置了几个 highcharts 图表，最近注意到我无法单击图例条目以在 Firefox 中显示/隐藏它们的关联系列。这在 Chrome 和 Safari 中运行良好，因此这似乎是与浏览器相关的问题。

我注意到 highcharts 演示没有这个问题，所以这一定是我在实现中正在做的事情，但我很难弄清楚。Firefox 的哪些不同之处可能导致 highcharts 出现此类问题？

兴趣点：如果我将图表的 useHtml 参数设置为 true，则图例条目变得可点击。然而，这不是一个解决方案，因为它破坏了许多其他东西。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-31T12:05:24.673

我有一个类似的问题，其中折线图中的点在 Firefox 中不可点击（但在 Chrome 中可点击）。事实证明，Firefox 将 dataLabels 放在图形点的顶部。

解决了它：

```
 plotOptions: {
                series: {
                    dataLabels: {
                        zIndex: 2 
```

另见： [http ://api.highcharts.com/highcharts#plotOptions.series.dataLabels](http://api.highcharts.com/highcharts#plotOptions.series.dataLabels)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-10-24T14:57:55.160

我解决了这个问题，它在 Firefox、Chrome 和 Safari 中发生在我身上，但在 IE9 中没有。

我发现问题与 CSS 相关。我的页面有 2 个“盒子”；左和右。我的 Vaadin 饼图位于右侧的方框中。在左侧框中，我有一个 html`<H1>`标记，右侧框的宽度溢出（宽度：900px），它覆盖了饼图的一部分。因此，某些矩形区域不可点击。这可以通过使用 Firefox Firebug 工具检查 CSS 轻松解决。我希望这可以节省您安装最新 vaadin 图表库的时间；调试代码等

# javascript - 单击后按钮上的jquery切换操作

> ID：16179305
> 
> 赞同：0
> 
> 时间：2013-04-23T21:14:31.940
> 
> 标签：javascript, jquery, anchor

我正在尝试在按钮上的两个操作之间切换。

当前，当黄色块向上滚动时，单击“顶部/显示”有效。再次单击该按钮应将黄色块向下移动以显示绿色块的高度。

[现场示例](http://jsfiddle.net/XFcJe/2/)

**HTML**

```
 <div class="block">
     <h2>This is green block is fixed</h2>

</div>
<div class="content" id="here">
    <div class="headerbar"> <a href="#here">Top / Reveal</a>

    </div>
</div> 
```

**JS**

```
$("a href='#here'").click(function () {
    $("html, body").animate({
        scrollTop: 0
    }, "slow");
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:28:34.700

只需像这样切换您的`scrollTop`参数：

```
scrollTop: $("body").scrollTop() == 0 ? 300 : 0 
```

[http://jsfiddle.net/XFcJe/5/](http://jsfiddle.net/XFcJe/5/)

# php - 用自定义 HTML 模板覆盖默认 Zend_Form 元素渲染器？

> ID：16179316
> 
> 赞同：1
> 
> 时间：2013-04-23T21:15:15.207
> 
> 标签：php, zend-framework, zend-form

我对 Zend_Form 默认呈现表单元素的方式不满意，并希望为通过实例化从 Zend_Form 继承的帮助器类生成的所有表单覆盖它，以处理我在所有表单上所做的一些事情。

我想要做出的更改看起来比使用装饰器的合理/可能更复杂，所以我想使用自定义 HTML 模板来完成此操作，我可以将表单值插入自定义 HTML 片段。

如何将我的类呈现的所有 HTML 元素设置为使用 HTML 模板？我应该从模板中调用哪些属性/函数来获取 Zend_Form 默认呈现的内容？最后，我更愿意这样做，而不必在我在代码中创建的每个输入元素上手动设置模板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T23:57:31.610

我已经用 ZF1 完成了我的编码工作，我发现渲染漂亮表单的最佳方法是使用 Twitter Bootstrap。

检查以下链接，看看这是否也是您满意的解决方案：

1.  [如何在 zend 框架 1 应用程序中使用 twitter 引导框架？](https://stackoverflow.com/questions/12898817/how-to-use-the-twitter-bootstrap-framework-in-a-zend-framework-1-application)
2.  [http://twitter.github.io/bootstrap/](http://twitter.github.io/bootstrap/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T22:59:02.200

我最终使用了一个自定义视图脚本，我将其泛化为使用任意形式。

使用这种方法，我能够做以下事情：

*   在所需表单元素的标签后添加星号
*   将输入和错误组合在一个 div 中，这样当我将标签浮动到左侧时，事情仍然排成一行
*   向错误输入添加一个特殊类，以便我可以突出显示它们
*   更改某些错误消息以包含元素的名称而不是“值”
*   传递文本注释以及要在输入下显示的表单元素
*   不在特殊元素中包装标签和输入

其中一些事情如果没有 viewscript 是不可能的，而有些事情只是实施起来很痛苦。我认为这个解决方案对我来说会更加灵活。

在我的助手类的`render()`功能中：

```
$view = new Zend_View();
$view->setBasePath(SRC_ROOT . "/templates/forms");
$this->setDecorators(array(array('ViewScript', array('viewScript' => 'viewscript.php')))); 
```

这是我的观点：

```
<link rel="stylesheet" type="text/css" href="/styles.css" />

<form id="<?php echo $this->element->html_id ?>" class="<?php echo $this->element->html_class ?>" enctype="application/x-www-form-urlencoded" action="" method="post">
    <?php foreach($this->element as $element) { ?>
        <?php

        $decorators = $element->getDecorators();
        if(isset($decorators["Zend_Form_Decorator_Label"])) {
            $label = $element->getLabel();
        } else {
            $label = "";
        }

        if($element->isRequired() === true) {
            $label .= " *";
        }
        ?>
        <label class="label" for="<?php echo $element->getName(); ?>"><?php echo $label; ?></label>

        <div class="formInput">
            <?php
            // Add the error class to make the form inputs highlight in red
            if($element->hasErrors()) { 
                $attribs = $element->getAttribs();
                if(!isset($attribs["class"])) {
                    $attribs["class"] = "";
                }
                $attribs["class"] .= " inputError";
                $element->setAttribs($attribs);
            }

            // Print the input using Zend_Form's own mechanisms
            $element->setDecorators(array('ViewHelper'));  // Removes all decorators (labels, etc.)
            $v = new Zend_View();
            $element->setView($v);
            echo $element->render();

            if(isset($element->note)) {
                echo "<p>{$element->note}</p>";
            }

            // Print the error messages
            if($element->hasErrors()) {
                $errors = $element->getMessages();
            ?>
                <ul class="errors <?php echo sizeof($errors) == 1 ? "noDecorations" : "" ?>">
                <?php 
                foreach($errors as $error => $message) {
                    // Custom error messages
                    if($error === "isEmpty") {
                        $message = $element->getLabel() . " cannot be empty";
                    } ?>
                    <li><?php echo $message ?></li>
                <?php } ?>
                </ul>
            <?php } ?>
        </div>
        <div style="float: clear;"></div>
    <?php } ?>
</form> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T07:06:35.333

`Zend_Form`您可以使用自己的类扩展默认`Custom_Form`类。在`init()`方法中覆盖默认元素装饰器。这是我的代码片段：

```
//class Custom_Form extends Zend_Form
public function init()
{
    $this->setElementDecorators(
            array(array('ViewScript', array('viewScript' => '/controller_name/forms/fields/input-text.phtml'))),
            array('email', 'firstname', 'lastname')
        );
} 
```

# windows - 如何使用 Windows 批处理将奇数附加到文件夹名称？

> ID：16179319
> 
> 赞同：1
> 
> 时间：2013-04-23T21:15:34.850
> 
> 标签：windows, batch-file

我使用在此站点上找到的批处理脚本创建了一个包含 50 个州的目录，其中包含大约 3000 个县的子目录。

不幸的是，我将复制到目录中的文件是 FIPS 代码。FIPS 代码只是一系列奇数，从 001 开始，适用于按州按字母顺序排列的县。例如，阿拉巴马州以 Autauga 县作为第一个字母县开始，FIPS 代码为 001，第二个县是 Baldwin，FIPS 代码为 003 等......并以 Winston 县结束，FIPS 代码为 133。所以我需要将 FIPS 代码 3 位数字附加到县文件夹名称，即 Autauga_001。我认为它就像添加 n+=2 一样简单，但它需要从 001 开始？

我很喜欢编写批处理文件。花了几个小时试图零碎地列出这个网站上列出的类似代码以满足我的需要，但无济于事。

我该怎么做呢？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:40:46.520

试试这个并删除`echo`命令，如果输出正常：

```
@echo off&setlocal enabledelayedexpansion
rem set root to the subfolder, where the 50 state folders are inside
set "root=states"

pushd "%root%"
for /d %%i in (*) do (
    set /a counter=1001
    for /d %%j in ("%%~fi\*") do (
        set "newname=%%~nj_!counter:~-3!%%~xj"
        echo rename "%%~fj" "!newname!"
        set /a counter+=2
    )
)
popd 
```

# javascript - 单击表格行时取消绑定事件不起作用Jquery

> ID：16179320
> 
> 赞同：0
> 
> 时间：2013-04-23T21:15:34.980
> 
> 标签：javascript, jquery

我正在使用表格和微调器，当表格的一行被双击时，我想将一个添加到微调器的值并执行函数 x，另一方面，微调器有事件更改，当它更改，我想执行功能 y。我有这个：

```
$(spinner).spinner({ 
      change: function( event, ui ) {
          alert("y");
      }
}).val(0);  

$('td#row').dblclick(function(event){
        $(spinner).spinner("value");
        $(spinner).spinner("value", value + 1);
        alert("x");
    } 
```

问题是当我双击表格时，两个函数都被调用（函数 x 和 y），如何取消微调器的更改事件？我试过这个：

```
$(spinner).spinner("value", value + 1).unbind("change"); 
```

另外，我尝试了这些`undelegate() event.stopPropagation() event.stopImmediatePropagation()`方法，但没有任何效果，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:32:40.167

名称是“ `event`spinchange”，因此您可以绑定或取消绑定到该事件，而不是指定`change`选项。尝试这个：

```
function spinChange(event, ui) {
    console.log("AFAF");
}

$("#spinner").spinner().on("spinchange", spinChange);

$("#btn1").on("click", function () {
    var $spinner = $("#spinner"),
        prevValue = $spinner.spinner("value");

    $spinner.off("spinchange", spinChange);
    $spinner.spinner("value", prevValue+1);
    $spinner.on("spinchange", spinChange);
}); 
```

**演示：http:** [//jsfiddle.net/5cL8G/2/](http://jsfiddle.net/5cL8G/2/)

请注意单击按钮不会在控制台中记录任何内容，但手动更改值（和不聚焦）会记录。

# c# - Visual Studio c# DialogResult 似乎不起作用

> ID：16179324
> 
> 赞同：2
> 
> 时间：2013-04-23T21:15:46.680
> 
> 标签：c#, visual-studio-2010, dialogresult

我正在使用 Visual Studio 2010 `frmMain`有一个“注册”按钮，它调用另一个表单`newReg`

`frmMain`这是调用第二种形式的按钮的代码。问题是`MessageBox("So Far So Good")`永远不会被调用。`dialogResult`好像没有被认出来。

```
private void btnRegisterNew_Click(object sender, EventArgs e)
{
   // newReg Constructor Call
   newReg = new frmRegisterNew();

   // show form
   newReg.Show();

   if (newReg.DialogResult.Equals(DialogResult.OK)) 
   {
      MessageBox.Show ("So Far So Good");
   }
} 
```

第二个表格有一些要填写的字段和一个“注册”按钮。我已经`dialogResult`在属性窗口中将此按钮设置为“确定”，我认为在代码中也是如此。单击第二种形式的“注册”按钮时，它会检查输入，尝试更新数据库并在成功时关闭。这是那段代码：

```
dbConnection db = new dbConnection();
db.dbConnect();
if (db.dbRegisterVehicle(txtNewReg.Text, txtNewMake.Text, txtNewModel.Text, txtNewColour.Text, OwnerID))
{
   // if insert worked close
   this.DialogResult = DialogResult.OK;
   this.Close();
}
db.dbDisconnect(); 
```

我确定要尝试什么，或者我可能会过度关注。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-23T21:18:53.080

利用`ShowDialog`

```
newReg = new frmRegisterNew();
var dialogResult = newReg.ShowDialog();

if(dialogResult==DialogResult.OK)
{
    ....
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T21:29:13.140

该方法是一个很好的方法，但要注意和`ShowDialog`之间的区别。后者将意味着在新表单关闭之前您无法访问原始表单。这就是它阻止检查的原因，可能是也可能不是你想要的。`Show``ShowDialog``modal`

当您调用 时`Show`，它不会阻塞，这就是为什么您的代码会立即检查是否`DialogResult`等于`OK`（它不等于，`OK`因为在进行检查时您的新表单几乎没有打开）。

`ShowDialog`如果您想使用using ，另一种方法`Show`是处理新表单的`closed`事件。

```
frmRegisterNew newReg = new frmRegisterNew();    
newReg.FormClosed += (s, o) =>
    {
        if (newReg.DialogResult == DialogResult.OK)
        {
            MessageBox.Show ("So Far So Good");
        }
    };
newReg.Show(); 
```

这意味着您的代码将继续工作并且您的新表单将不是模态的，但是当它关​​闭新表单时，`FormClosed`将触发事件处理程序。如果您不熟悉上面的事件处理程序符号（它们被称为匿名方法），请不要担心，但您仍然可以正常使用事件处理程序。

```
newReg.FormClosed += new FormClosedEventHandler(newReg_FormClosed);

void newReg_FormClosed(object sender, FormClosedEventArgs e)
{
    MessageBox.Show ("So Far So Good");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T21:21:07.437

尝试实例化[DialogResult](http://support.microsoft.com/kb/816145)类并以这种方式使用它：

```
DialogResult dr = new DialogResult();

newReg = new frmRegisterNew();
dr = frmResgisterNew.ShowDialog();
if ( dr == DialogResult.OK )
   //Take an action here. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T21:20:10.757

`Form.Show()`是非阻塞的，并且会很快返回。因此，您的检查`newReg.DialogResult.Equals(DialogResult.OK))`将在用户有机会按下按钮之前进行。此外，请注意有关关闭窗口的警告：

> 如果窗体显示为无模式窗口，则 DialogResult 属性返回的值可能不会返回分配给窗体的值，因为窗体的资源会在窗体关闭时自动释放。

（通过[Form.DialogResult 属性 msdn 库页面](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.dialogresult.aspx)）

您可以调用`From.ShowDialog()`，或者，如果您需要在主窗体上保持交互，则传递一个委托以供另一个窗体在完成时调用。

* * *

编辑：要记住几点：

*   除了上面关于关闭表单的警告之外，您还必须小心在处理后尝试从从`newReg`的消息循环（包括调用的函数`Close()`）调度的方法中访问内容。

*   但是，如果您最终使用`ShowDialog()`而不是`Show()`，`this.Close()`则不会处理该表单。事实上，它基本上什么都不做，因为设置`DialogResult`为除了`None`会自动隐藏表单之外的任何东西。如果您需要确定性清理（大概是您`Close()`首先打电话的原因），您应该`newReg.Dispose()`在`btnRegisterNew_Click`. 否则，表单将在未来某个不可预测的时间被处理（前提是您的应用程序在此期间没有异常结束）。

*   如果您使用keyboardP 提到的[匿名函数](http://msdn.microsoft.com/en-us/library/bb882516%28v=vs.100%29.aspx)，请注意当出现问题时它可能很难调试（特别是如果您对语言和框架相对较新）。

# android - 在Android中使用java而不是xml控制开关

> ID：16179328
> 
> 赞同：1
> 
> 时间：2013-04-23T21:15:53.487
> 
> 标签：android, switch-statement

有没有办法可以控制 java 源中的开关，但不能控制 .xml 中的开关？我希望根据我保存的偏好打开/关闭开关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:23:27.240

请看一下 Switch 的参考 [http://developer.android.com/reference/android/widget/Switch.html](http://developer.android.com/reference/android/widget/Switch.html)

```
Switch switch = (Switch) findViewById(switchId);
switch.setChecked(true) // set it on;
switch.setChecked(false) // set it off; 
```

请将 switchId 替换为您在 xml 中定义的 id。

# python - 如何在用户输入之前运行 python 循环？定时器格式

> ID：16179329
> 
> 赞同：1
> 
> 时间：2013-04-23T21:15:53.523
> 
> 标签：python, timer

我正在编写一个计数分钟和秒的计时器，我希望计时器能够在您按下回车时暂停 - 但是，我正在使用 while 循环使计时器实际计数，并添加一个 raw_input/input会停止循环......我如何让这两个函数动态运行 - 一起但分开？

到目前为止我的代码：

```
from datetime import datetime
import math
#import subprocess
import sys
import time
import os

sys.stdout.write("\x1b[8;{rows};{cols}t".format(rows=24, cols=60))

t1 = 0
t3 = 0

def space():
    print(" ")
    print(" ")
    print(" ")
    print(" ")
    print(" ")
    print(" ")
    print(" ")
    print(" ")
    print(" ")
    print(" ")

while t1 != 1.1:

    os.system('clear')

    t2 = str(t1)
    t4 = str(t3)

    space()

    print('*')*60
    print "James Balazs' Python Timer".center(60,"-")
    print ("Passed time: " + t4 + " minutes and " + t2 + " seconds").center(60, " ")
    print('*')*60

    t1 = t1 + 1
    time.sleep(1)
    if t1 == 60:
        t1 = 0
        t3 = t3 + 1 
```

一些不必要的导入是因为我使用的是我制作的时钟的修改副本......所以只要我不必破坏我的大部分工作来实现这一切，所有的帮助都会非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:26:46.847

使用计时器创建一个函数，并[`threading`](https://stackoverflow.com/questions/2957116/make-2-functions-run-at-the-same-time)在请求输入时使用它来运行它。然后在用户按下回车键时将其[杀死。](https://stackoverflow.com/questions/323972/is-there-any-way-to-kill-a-thread-in-python)

```
import threading
def timer():
    #Timer goes here
Thread(target = timer).start()
raw_input("Press enter to stop")
#Kill the thread 
```

另请参阅[http://mail.python.org/pipermail/python-list/2004-May/281943.html](http://mail.python.org/pipermail/python-list/2004-May/281943.html)关于杀戮。

# php - 如何在 PHP5 中链接混合类型的对象

> ID：16179332
> 
> 赞同：1
> 
> 时间：2013-04-23T21:16:06.597
> 
> 标签：php, oop, chaining

我想像这样链接引用一个字符串属性：

```
echo($object1->object2->stringProperty); 
```

但这会产生这个错误：

**可捕获的致命错误：类 [object 2's type] 的对象无法转换为字符串**

我可以通过在某处强制进行类型转换来完成这项工作吗？它可以为中间对象使用中间变量，但这增加了不幸的麻烦：

```
class foo {
    public $bar;
}

class bar {
    public $title;
}

// Initialize the example.
$myBar = new bar();
$myFoo = new foo();
$myFoo->bar = $myBar;
$myBar->title = "fubar";

// Using an intermediate object works.
$temp = $myFoo->bar;
echo("$temp->title<br />");

// Using a direct reference raises a fatal error.
echo("$myFoo->bar->title<br />"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T21:21:18.863

要么删除引号：

```
echo $myFoo->bar->title . "<br />"; 
```

或放在大括号中（也称为复杂语法）：

```
echo "{$myFoo->bar->title}<br />"; 
```

# matlab - 使用中值算子将四个初始视差图合二为一

> ID：16179340
> 
> 赞同：0
> 
> 时间：2013-04-23T21:17:18.147
> 
> 标签：matlab, interpolation, median, disparity-mapping

嗨，有人可以帮助我使用 matlab 生成视差图。我已经对两个经过校正的立体对执行了多小波变换，并使用立体匹配算法来组合每个图像的相应巴布带，以生成四个初始视差图。但是，我现在对如何使用中值运算符将这四个视差图的值合并为一个感到困惑并且完全无能为力。有人可以帮我吗？

我的四个图像大小相同。前面的代码无关紧要，因为它位于不同的文件中（我刚刚保存了上一个文件的输出，现在我试图在另一个文件中编码）。

我的想法是： 1\. 从四个基带中的每一个中读取像素 p 的值 2\. 将值按升序排序 3\. 计算像素的中值 4\. 将像素值写入新图像 5\. 设置 p +1 并重复步骤 1-4 直到到达最后一个像素

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T01:06:26.897

首先，将图像堆叠到 MxNx4 数组中：

```
bbstack = cat(3,bb1,bb2,bb3,bb4);  % use bb{:} if they are in a single cell array 
```

然后沿第三维应用中值算子：

```
medbb = median(bbstack,3); 
```

# ios - 我需要释放 CFError 吗？

> ID：16179342
> 
> 赞同：1
> 
> 时间：2013-04-23T21:17:22.270
> 
> 标签：ios, memory-management, core-foundation

在 Core Foundation 中，当我使用 CFError 指针调用函数时，我是否有责任在之后释放该错误？例如：

```
CFErrorRef error = NULL;
BOOL success = ABRecordSetValue(record, property, value, &error);
if (!success) {
    // handle error
    CFRelease(error);
} 
```

我想我记得在某处读过，这只是在没有发布的情况下神奇地工作，但找不到任何东西来验证这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:25:15.513

在 CoreFoundation 中，如果您使用指针取回东西，则很可能是使用其中一个`...Create()`函数分配的（文档*没有*说明这一点吗？），因此您必须释放它。

在 Foundation 中，“返回”值是自动释放的，因此您不需要（实际上也不应该）这样做。

# mysql - SQL - 有没有办法简单地计算它？

> ID：16179347
> 
> 赞同：1
> 
> 时间：2013-04-23T21:17:37.497
> 
> 标签：mysql, sql

从两天开始，我试图解决一些问题 - 没有成功。这是我的表 user_actions：

```
用户名 | 动作标识
------------------
12 | 0004243
12 | 0004243
12 | 1346454
第542章 4356675
235 | 1346454
235 | 0004243
235 | 1346454
235 | 1346454

```

我需要计算有多少用户执行了一个操作（actionId）。关于上面的示例，输出应如下所示：

```
行动ID | howManyUsers
----------------------
0004243 | 2
1346454 | 2
4356675 | 1

```

有人能聪明地帮助我并向我解释方法吗？谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T21:20:15.143

尝试这个：

```
SELECT actionId, COUNT(DISTINCT userId) AS howManyUsers
FROM user_actions
GROUP BY actionId 
```

这有帮助吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T21:20:54.683

正确的查询使用`count(distinct)`：

```
select actionID, count(distinct userId) as howManyUsers  
from table
group by actionID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:39:51.360

我模拟了它，实际上这个查询给了我正确的输出：

```
SELECT actionId, COUNT(DISTINCT actionId) AS howManyUsers
FROM user_actions
GROUP BY userId 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T21:20:10.117

尝试以下查询

```
SELECT actionId, COUNT(userId) AS howManyUsers 
FROM user_actions
GROUP BY actionId 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T21:19:30.230

查询很简单。

选择 Count(*) 作为 howmanyusers, actionID from TableX groupby actionId

# php - SOAP Web 服务无法识别来自 Agemni 数据库 API 的 PHP 客户端的 ArrayOfAnyType

> ID：16179353
> 
> 赞同：1
> 
> 时间：2013-04-23T21:18:00.037
> 
> 标签：php, .net, soap

我正在尝试使用此 WSDL 将潜在客户插入 SOAP Web 服务：[http ://www.agemni.com/AgemniWebservices/service1.asmx?WSDL](http://www.agemni.com/AgemniWebservices/service1.asmx?WSDL)

API 记录在这里：[http ://wiki.agemni.com/4Integration_And_API%27s/APIs/Database_API](http://wiki.agemni.com/4Integration_And_API%27s/APIs/Database_API)

此 Web 服务的后端代码似乎在 .NET 中。

这是我的代码：

```
// Create soap client.
try {
    $this->client = new SoapClient("https://www.agemni.com/AgemniWebservices/service1.asmx?WSDL", array('soap_version' => SOAP_1_2, 'cache_wsdl' => 0, "trace" => true));
} catch (Exception $e) {
    $this->logMessage('Couldn\'t connect to web service.');
    throw $e;
}

// Create parameters.
$dataParams = new \stdClass;
$dataParams->strUsername = 'userman';
$dataParams->strPassword = 'hissecretpassword';
$dataParams->strCompanyName = 'validcompanyname';
$leadCode = 2;
$dataParams->objecttype = $leadCode;

// Create keys.
$dataParams->keys = new \stdClass;
$dataParams->keys->Phone = 'Phone';

// Create values.
$dataParams->values = new \stdClass;
$dataParams->values->Phone = '8011234567';

// Call web service.
$validateResult = $this->client->CreateEntity($dataParams); 
```

这是我收到的回复：

```
object(stdClass)#27 (1) {
  ["ValidateEntityResult"]=>
  object(SoapVar)#29 (4) {
    ["enc_type"]=>
    int(0)
    ["enc_value"]=>
    object(stdClass)#28 (10) {
      ["statusCode"]=>
      string(9) "Succeeded"
      ["status"]=>
      string(5) "Error"
      ["description"]=>
      string(56) "Phone number is required and needs to be 10 digits long."
      ["errorNumber"]=>
      int(1)
      ["xmlResult"]=>
      string(39) "<?xml version="1.0" standalone="yes" ?>"
      ["EntityValidated"]=>
      bool(false)
      ["EntityCreated"]=>
      bool(false)
      ["EntityUpdated"]=>
      bool(false)
      ["EntityIDCreated"]=>
      int(0)
      ["isloggedIn"]=>
      bool(false)
    }
    ["enc_stype"]=>
    string(15) "ExceptionReport"
    ["enc_ns"]=>
    string(44) "http://tempuri.org/AgemniWebService/Service1"
  }
} 
```

我在 PHPFreaks 上发现了一个类似的问题，该问题已有多年历史，但从未成功回答。我在 PHP SoapClient 中看到其他类似的嵌套参数问题，但我看到的所有建议都以相同的错误消息结尾。

身份验证与公司名称一起收到很好。然而，我几乎以我能想到的所有方式对键和值参数进行格式化、解析和编码。我已经尝试将我的参数声明为 SoapVar 和 SoapParam 以及我能想到的每个潜在的构造函数参数，但仍然收到相同的错误消息。

对于有人可能认为 Agemni 网络服务不接受我的潜在客户电话号码的任何原因，我将不胜感激。

谢谢。

*更新* 我可以在字符串中生成我需要的 XML 请求并使用 cURL 发送它，但我想使用 SoapClient。但是，我很难在键和值节点中生成如下所示的元素：

```
<anyType xsi:type="xsd:string">phone</anyType>' 
```

我遵循了一些关于在 SoapClient 中创建自定义复杂类型的指南，但我无法使用它来创建看起来像那样的 XML。

# tomcat - Netbeans 7.3 + Apache Tomcat 7.0.39：HttpMonitor 无法启动

> ID：16179355
> 
> 赞同：0
> 
> 时间：2013-04-23T21:18:05.673
> 
> 标签：tomcat, netbeans

我刚刚将 Tomcat 7.0.39 添加到我的（Windows）系统中。创建了一个 catalina_base 目录并用文件填充它。然后在 netbeans 中配置服务器，将其指向正确的 catalina_home 和 catalina_base 目录。Netbeans 可以正常启动服务器，但无法启用 HttpMonitor。当我尝试启动 tomcat 时，选中“启用 Http Monitor”会导致以下错误。

Tomcat 7.0.27 工作正常，配置看起来一样，权限看起来一样。

```
NetBeans: Deploying on Apache Tomcat 7.0.39
    profile mode: false
    debug mode: false
    force redeploy: true
Operation failed, error occurred when setting up the HTTP Monitor support. The HTTP Monitor has been disabled,  you can try to restart the operation now. If you would like to enable the HTTP Monitor again, make sure you have write permissions to <CATALINA_BASE>/conf/web.xml file and <CATALINA_HOME>/lib directory and check the "Enable HTTP Monitor" checkbox in the Tomcat properties.
Deployment error: Operation failed, error occurred when setting up the HTTP Monitor support. The HTTP Monitor has been disabled,  you can try to restart the operation now. If you would like to enable the HTTP Monitor again, make sure you have write permissions to <CATALINA_BASE>/conf/web.xml file and <CATALINA_HOME>/lib directory and check the "Enable HTTP Monitor" checkbox in the Tomcat properties.
See the server log for details.
    at org.netbeans.modules.j2ee.deployment.devmodules.api.Deployment.deploy(Deployment.java:230)
    at org.netbeans.modules.maven.j2ee.ExecutionChecker.performDeploy(ExecutionChecker.java:178)
    at org.netbeans.modules.maven.j2ee.ExecutionChecker.executionResult(ExecutionChecker.java:130)
    at org.netbeans.modules.maven.execute.MavenCommandLineExecutor.run(MavenCommandLineExecutor.java:212)
    at org.netbeans.core.execution.RunClassThread.run(RunClassThread.java:153) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:46:31.920

问题是 Netbeans 想要写入 < CATALINA_HOME >/lib 以存储 org-netbeans-modules-schema2beans.jar 和 org-netbeans-modules-web-httpmonitor.jar。

我认为这是一个 netbeans 错误。它应该将 jar 存储在 < CATALINA_BASE >/nblib 中。

# php - 使用ajax传递rel变量

> ID：16179357
> 
> 赞同：0
> 
> 时间：2013-04-23T21:18:15.440
> 
> 标签：php, jquery, ajax, wordpress

我想要完成的是让变量 $meta_value_pass 通过 ajax 传递到另一个页面 186。这个页面应该获取变量，在循环中使用它并输出发回生成的 html。

通话来源：

```
$meta_value_pass = Entwerfen3;
<script>
jQuery(document).ready(function($){

alert ("helloworld");
    $(".sorting").click(function()
{      
var post_value = $meta_value_pass;
jQuery("#projektwrapper")

            .empty()

            .html("<div style='text-align: center; padding: 30px;'>Loading...</div>");

jQuery.ajax({

            url: "http://web318.login-11.hoststar.at/ben/xarch/azall/?page_id=186",
            dataType: "html",
            type: "POST",
            data: ({player: post_value}),
            success: function(data) {
                jQuery("#projektwrapper").html(data); } 

  });
    });

});
</script> 
```

PHP 处理变量并返回 html：

```
 <?php

    /*
        Template Name: Projekte Getter
    */

    $meta_value_pass = $_POST['player'];

    $args= array(
    'meta_query' =>  array(
    array(
            'key' => 'cf_cf_Lehrveranstaltung',
            'value' => $meta_value_pass,
            'compare' => 'LIKE'
            ))
            );

   $the_query = new WP_Query( $args );
?> 
```

# python - IOerror 的所有“原因”是什么

> ID：16179360
> 
> 赞同：3
> 
> 时间：2013-04-23T21:18:32.637
> 
> 标签：python, exception-handling, io

来自 Python 文档

> 异常 IOError
> 
> ```
> Raised when an I/O operation (such as a print statement, the built-in open() function or a method of a file object) fails for an
> I/O-related reason, e.g., “file not found” or “disk full”. 
> ```

似乎没有列举互联网上记录的原因。

IOErrors 似乎是放置关于 io 的异常的地方，没有其他地方可以住。我很好奇 IOErrors 的全部（至少所有常见原因）是什么。

让我们从访问类似文件的环境（具有文件概念的文件系统）的假设开始，其空间有限（10 GB 的硬盘驱动器（磁性介质））。

这个问题不是特定于 python 的，真的，但我需要一个起点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:55:03.583

I/O 错误不是由 Python 生成的，它们来自操作系统。Python 只是模仿从操作系统传递的错误消息。

# javascript - 无法使用 Rhino 在 NetBeans 中编译 javascript 文件

> ID：16179361
> 
> 赞同：1
> 
> 时间：2013-04-23T21:18:32.610
> 
> 标签：javascript, netbeans, rhino

我的目标是在netbeans中创建一个项目（还不知道它是否必须是html5或java项目），添加带有任何代码行的js文件，然后按编译并运行。

我希望将我的 js 文件编译为 *.class 文件，因为它可以根据 mozilla 页面上的 rhino 教程通过 js 控制台完成。

但正如我所说，我想通过按我的 netbeans 中的运行/编译按钮来拥有它

目前我正在使用netbeans 7.3（如果需要，我真的愿意更改版本）和windows

我已经尝试做很多事情，但只有两件事值得描述：-编辑 build.xml 文件以使用 rhino 中的 js.jar -只需使用 javascript 文件运行 java 项目-根据一些文章，这应该是可能的，但在我的情况下只是留下未编译的js文件

请帮助亚历山德拉

# java - Java整数数组，我似乎无法做简单的数学运算

> ID：16179363
> 
> 赞同：0
> 
> 时间：2013-04-23T21:18:35.177
> 
> 标签：java, arrays

我有以下代码：

```
int lines = 0;
while(lines < 2)
{
    int[] oldarr = parr;

    for(int i = 0; i < arrsize; i++)
        System.out.print(" " + oldarr[i]);
    System.out.println();

    for(int i = 0; i < arrsize; i++)
    {
        if(i == 0)
            parr[i] = 0;
        else
            parr[i] = Math.abs(oldarr[i] - oldarr[i-1]);
    }

    lines++;
} 
```

parr 是大小为 [arrsize] 的整数数组。每次通过此循环时，我都想打印 parr 中每个索引的值，然后将每个索引设置为它之前的索引与其自身之间的差异。目前它给了我正确的（硬编码）最初的parr。但是改变 parr 的下一次（第一次）迭代给了我意想不到的值；它们甚至不接近两个相邻值之间的差异..

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T21:21:40.107

你不是用这一行复制你的数组：

```
int[] oldarr = parr; 
```

这两个变量仍然指向同一个数组。

要获取副本，您可以执行以下操作：

```
int[] oldarr = Arrays.copyOf(parr, parr.length); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:21:56.743

在您的第二个`for`循环中，您将新值设置为当前值和前一个值的差值，但前一个值在`for`循环的前一次迭代中已经更改。

更改您的第二次`for`循环迭代以向后迭代数组，因此您的计算不依赖于先前的计算。

```
for(int i = arrsize - 1; i >= 0; i--) 
```

# git - GitLab v5.0 git推送问题

> ID：16179366
> 
> 赞同：5
> 
> 时间：2013-04-23T21:18:45.593
> 
> 标签：git, ubuntu-12.04, ssh-keys, gitlab

我创建这个问题是为了帮助其他人在尝试推送初始化的存储库时搜索有关两个 GitLab 配置问题的文档：

**1：即使在 GitLab 前端设置了 SSH 密钥后，GitLab 服务器上的 git 用户也需要密码：**

```
$ git push -u origin master
git@hostname's password: 
```

**2： gitlab-shell 客户端在尝试推送时似乎在错误的位置寻找您的存储库（`/home/git/repositories`所有存储库都应按中指定的方式存储`/home/git/gitlab-shell/config.yml`）：**

```
$ git push -v -u origin master
Pushing to git@hostname:sadmicrowave/test-project.git
fatal: 'sadmicrowave/test-project.git' does not appear to be a git repository
fatal: The remote end hung up unexpectedly 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T21:18:45.593

当 SSH 密钥被添加到 GitLab 前端时，我注意到它没有被相应地添加到`/home/git/.ssh/authorized_keys`文件中。经过一番挖掘，我发现了这个[https://github.com/gitlabhq/gitlabhq/issues/3120](https://github.com/gitlabhq/gitlabhq/issues/3120)，它指出运行以下 rake：

```
rake gitlab:shell:setup RAILS_ENV=production 
```

*注意：参考省略了该部分`RAILS_EVN=production`，但这是必需的，因此您不会收到另一个错误说明`cannot load such file -- rb-inotify`*

由于我的 git 用户没有`sudo`访问权限，因此我必须从另一个用户登录 sudo 运行上述命令，然后运行以下命令以将正确的权限（git）返回给 .ssh 目录：

```
$ sudo chgrp -R git /home/git/.ssh
$ sudo chown -R git /home/git/.ssh 
```

毕竟，回到 GitLab 前端，删除并重新创建您的 SSH 密钥（您可以使用与以前相同的公钥）。

您应该看到正确的记录`/home/git/.ssh/authorized_keys`，如果您`git push -v -u origin master`从本地计算机运行，您现在应该很好！

# r - 在ggplot2中重复X轴标签和图例标签

> ID：16179371
> 
> 赞同：1
> 
> 时间：2013-04-23T21:18:58.190
> 
> 标签：r, ggplot2

我不确定为什么我的 x 比例标签重复出现这样的问题，而不是仅仅在有测量点的地方进行标记。此外，我的图例标签不起作用。

```
 FamIncome Ethnicity    mean.bmi
1   1   1   28.54250
2   1   2   26.66300
3   1   3   26.62105
4   1   4   29.51396
5   1   5   25.66722
6   2   1   29.62404
7   2   2   28.08393
8   2   3   28.62215
9   2   4   28.97561
10  2   5   25.57714
11  3   1   29.52630
12  3   2   28.27235
13  3   3   29.67060
14  3   4   31.36768
15  3   5   26.13361
16  4   1   30.83368
17  4   2   30.80814
18  4   3   29.29594
19  4   4   29.18521
20  4   5   24.80550
21  5   1   29.76500
22  5   2   29.24404
23  5   3   28.89435
24  5   4   31.48172
25  5   5   28.02522
26  6   1   30.05087
27  6   2   29.88574
28  6   3   29.53793
29  6   4   30.97993
30  6   5   25.57857
31  7   1   30.31787
32  7   2   29.28055
33  7   3   28.50421
34  7   4   30.65427
35  7   5   26.66094
36  8   1   29.15000
37  8   2   29.02789
38  8   3   28.36507
39  8   4   33.51915
40  8   5   28.38263
41  9   1   28.17679
42  9   2   28.74731
43  9   3   28.06196
44  9   4   31.38483
45  9   5   26.96000
46  10  1   28.71633
47  10  2   33.44409
48  10  3   30.63048
49  10  4   30.22587
50  10  5   27.36375
51  14  1   30.78161
52  14  2   27.43575
53  14  3   28.96817
54  14  4   32.22378
55  14  5   25.62778
56  15  1   29.15982
57  15  2   27.42672
58  15  3   27.60567
59  15  4   30.05013
60  15  5   26.80271 
```

下面的代码：

```
a <- ggplot(nh1, aes(x=FamIncome, y=mean.bmi)) + geom_line(aes(group=Ethnicity, colour = Ethnicity)) + geom_point()
a = a + labs(list(title="Average BMI versus Family Income", x = "Family Income", y = "Average BMI"))
a = a + scale_x_discrete(breaks=c("1","2","3","4","5","6","7","8","9","10","14","15"),
      labels = c("0-4,999", "5K-9,999", "10K-14,999", "15K-19,999", "20K-24,999", "25K-34,999", "35K-44,999", "45K-54,999", "55K-64,999", "65K-74,999", "75K-100K", "Over 100K"))
a = a + theme(axis.text.x=element_text(angle=-90))
a = a + scale_colour_continuous(name = "Ethnicity", 
                        breaks=c("5","4","3","2","1"),
                        labels=c("Other Race/Multi", "Black","White","Other Hispanic", "Mexican-American"))

a 
```

在我再获得 2 个“声誉”点之前，我无法发布我获得的图像的图片

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:51:59.993

尝试将您的 x 变量转换为一个因子：

```
a <- ggplot(nh1, aes(x=factor(FamIncome), y=mean.bmi)) + geom_line(aes(group=Ethnicity, colour = factor(Ethnicity)))
a = a + labs(list(title="Average BMI versus Family Income", x = "Family Income", y = "Average BMI"))
a = a + scale_x_discrete("Family Income", labels = c("0-4,999", "5K-9,999", "10K-14,999", "15K-19,999", "20K-24,999", "25K-34,999", "35K-44,999", "45K-54,999", "55K-64,999", "65K-74,999", "75K-100K", "Over 100K"))
a = a + opts(axis.text.x=theme_text(angle=-90))
a = a + scale_colour_discrete(name = "Ethnicity", 
                        breaks=c("5","4","3","2","1"),
                        labels=c("Other Race/Multi", "Black","White","Other Hispanic", "Mexican-American")) 
```

![在此处输入图像描述](https://i.stack.imgur.com/JskS3.png)

使用数字 x 变量时，ggplot 将其视为数字比例，而您确实希望它是分类的。`fill`还要注意和之间的混淆`colour`。`fill`用于二维填充区域。

# linux - 解密需要私钥和密码

> ID：16179376
> 
> 赞同：0
> 
> 时间：2013-04-23T21:19:29.920
> 
> 标签：linux, public-key-encryption, gnupg, passphrase

是否可以同时要求私钥和密码才能使用 gpg 解密文件？我知道我可以使用公钥对文件进行两次加密。然后使用密码加密该文件。gpg中有一个选项可以一步完成吗？通过查看 man 文件，我只能找到一个密钥或密码。任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T02:37:11.977

> 我知道我可以使用公钥对文件进行两次加密。然后使用密码加密该文件。gpg中有一个选项可以一步完成吗？

没有。没有这样的选择。

（但是，您*可以*使用对称密码对文件进行 PGP 加密，同时将其加密给多个收件人。这基本上会导致会话密钥的多个副本 [用于对称加密消息] 通过不同的方式加密 [潜在的各种公钥以及共享密码]）。

# unit-testing - 我应该对验证代码进行单元测试吗？似乎不切实际

> ID：16179385
> 
> 赞同：1
> 
> 时间：2013-04-23T21:20:10.330
> 
> 标签：unit-testing, testing, tdd

我正在学习测试驱动开发，我想知道在测试驱动验证方面我应该做什么。我应该创建单元测试来测试验证结果的每一种可能组合吗？在处理大型实体时，这似乎几乎是不可能的。假设我有一个具有很多属性的模型实体，其中一些带有约束，如下所示 -

```
@entity
public class MyClass extends Model {

    @Constraints.Required
    @Constraints.MaxLength(20)
    public String attribute1;

    @Constraints.Required
    public String attribute2;

    public float attribute3;

    @Constraints.Required
    public String attribute4;

    @Constraints.Required
    public String attribute5;

    @Constraints.Max(100)
    public int attribute6;

    @Constraints.Required
    public String attribute7;

    ...
    ...
    ...
} 
```

所以我正在编写单元测试来验证这样一个实体，还是那毫无意义？我可以通过 Validator 函数运行它并获取失败验证的数量......但如果我对测试非常严格，我是否必须对所有可能的无效属性组合进行此操作，这将需要创建大量要测试的实例。

所以在这种情况下它肯定看起来毫无意义，这是否意味着单元测试对于任何实体验证都毫无意义？即，如果它们对于具有很多属性的实体毫无意义，那么它们对于只有少数属性的属性也一定是毫无意义的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:49:13.280

我会测试，不是每个可能的组合，而是每个属性约束。所以创建一个有效的条目，检查没有失败。以违反特定约束的方式更改该条目中的一件事；确保该约束捕获它。对每个约束重复。现在您知道约束都在起作用。

# unity3d - HLSL float4x4 单个浮点数

> ID：16179387
> 
> 赞同：1
> 
> 时间：2013-04-23T21:20:14.770
> 
> 标签：unity3d, hlsl

简单的问题，但是如何在 HLSL 中访问 4x4 矩阵中的单个浮点数或 float4？

我试过： matrix._m00_m01_m02 for a float3 无济于事。我也试过 matrix._00_01_02 无济于事。

在 HLSL 中获取矩阵的单个浮点数或 float3/4 的正确方法是什么？

另外，如何在矩阵中插入 float4？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T05:02:57.320

为什么不在几乎所有语言中使用与矩阵相同的访问方法？

```
myField[row][column] = potato; 
```

# jakarta-ee - 为什么我的命令按钮不起作用？

> ID：16179389
> 
> 赞同：0
> 
> 时间：2013-04-23T21:20:16.410
> 
> 标签：jakarta-ee, jsf-2, primefaces

我正在使用 primefaces 3.5、Glassfish 3.1.2 和 Java EE。我正在尝试创建一个在表格中创建“问题”的页面。我有一个数据表，其中包含供用户在尝试回答问题时选择的“答案”。

作为一项多项选择琐事测验，他们需要有一个或多个答案是正确的，其余的都是正确的。我允许每个问题有 2-6 个答案，并且最多有 4 个正确。所以我有 ap:dataTable 元素来保存答案，我有 3 个命令按钮来添加、删除或编辑表中的答案，每个按钮都有一个在单击时运行的服务器端方法。但是，没有任何方法运行。没有错误也没有异常，只是没有任何作用。

这是我的页面（我将整个页面包括在内，以防万一我在其他地方出现错误）：

```
<h:form id="createQForm">
    <h1>Create A Question</h1>
    <p:messages id="msgs"/>  
    <p:selectOneMenu 
        value="#{createQuestionBean.selectedCategory}"  
        id="lstCategory" required="true" >

        <f:selectItems 
            value="#{createQuestionBean.categories}" />
        <p:ajax listener="#{createQuestionBean.onSelectCategory}" 
                update="lstSubCategory" />
    </p:selectOneMenu>
    <p:selectOneMenu 
        value="#{createQuestionBean.selectedSubCategory}"  
        id="lstSubCategory" required="false">

        <f:selectItem itemLabel="No Sub-Category" 
                      noSelectionOption="true" />

        <f:selectItems 
            value="#{createQuestionBean.subCategories}"/>

    </p:selectOneMenu>
    <h:panelGrid  columns="3">
        <h:outputLabel for="txtQuestion" id="lblQuestion" value="Question: *" />
        <p:inputText value="#{createQuestionBean.entry.question}"
                     id="txtQuestion" required="true" 
                     requiredMessage="You must provide a question"
                     validatorMessage="#{createQuestionBean.QUESTION_VALIDATION_MESSAGE}">
            <f:validateRegex pattern=".*[\s\d\w]"  />
            <p:ajax update="msgQuestion" event="keyup" />
        </p:inputText>
        <p:message for="txtQuestion" id="msgQuestion" display="icon"/> 
    </h:panelGrid>
    <h:outputText value="Horizontal: " />  

    <p:selectManyCheckbox value="#{createQuestionBean.selectedOptions}">  
        <f:selectItem itemLabel="Randomizable?" itemValue="randomizable" />  
        <f:selectItem itemLabel="Multiple Choice?" itemValue="multichoice" />  
    </p:selectManyCheckbox> 

    <p:fileUpload 
        value="#{createQuestionBean.questionImage}" mode="simple" 
        allowTypes="/(\.|\/)(gif|jpe?g|png)$/" 
        label="Select Images (jpg or png)" 
        sizeLimit="2097152" 
        invalidFileMessage="Sorry, only files of type .jpg, .png or .gif are allowed" 
        invalidSizeMessage="Sorry, files are limited in size to 2 Mb"/>
    <p:dataTable 
        id="answersTable" var="answer" style="width: 250px"
        value="#{createQuestionBean.datamodel}"   
        selection="#{createQuestionBean.selectedAnswer}"
        editMode="cell" editable="true"
        selectionMode="single">

        <p:column style="width:75%"> 
            <p:cellEditor >  
                <f:facet name="output">
                    <h:outputText 
                        value="#{answer.answer.testAnswer}" />
                </f:facet>  
                <f:facet name="input">
                    <p:inputText 
                        id="modelInput"  
                        style="width: 97%;height: 97%"
                        value="#{answer.answer.testAnswer}"/>
                </f:facet>  
            </p:cellEditor>  
        </p:column>
        <p:column style="width:25%">  
            #{answer.correct ? "Correct" : "Wrong" }  
        </p:column>

    </p:dataTable>
    <h:panelGrid columns="3">
        <p:commandButton 
            update="answersTable" ajax="true"
            actionListener="#{createQuestionBean.removeSelect}"
            value="Remove Selected -"/>
        <p:commandButton
            update="answersTable" ajax="true"
            actionListener="#{createQuestionBean.setAsCorrect}"
            value="Set Selected As Right"/>
        <p:commandButton 
            update="answersTable" ajax="true"
            value="Add +"
            actionListener="#{createQuestionBean.addAnswer}"/>

    </h:panelGrid>
    <p:commandButton
        action="#{createQuestionBean.saveAndStoreEntry()}" />
</h:form> 
```

以下是调用的方法：

```
public void addAnswer() {
    System.out.println("***** CALLED ADD ANSWER");
    answers.add(new QuestionAnswers());
    answers.get(answers.size() - 1).setCorrect(false);
    setIDs();
    //set the data models
    datamodel = new QuestionAnswersDataModel(new ArrayList<QuestionAnswers>(answers));
}

public void removeSelect() {
    System.out.println("***** CALLED REMOVE SELECT");
    if (selectedAnswer == null && !answers.contains(selectedAnswer)) {
        FacesUtils.addErrorMessage(NO_SELECTION_ERROR);
    } else {
        answers.remove(selectedAnswer);
    }
    setIDs();
    //set the data models
    datamodel = new QuestionAnswersDataModel(new ArrayList<QuestionAnswers>(answers));
}

public void setAsCorrect() {
    System.out.println("***** CALLED SET AS CORRECT");
    if (selectedAnswer != null) {
        selectedAnswer.setCorrect(true);
        if (!entry.getMultichoice()) {
            for (QuestionAnswers questionAnswers : answers) {
                if (questionAnswers != selectedAnswer) {
                    questionAnswers.setCorrect(false);
                }
            }
        }
    } else {
        FacesUtils.addErrorMessage(NO_SELECTION_ERROR);
    }
    setIDs();

    //set the data models
    datamodel = new QuestionAnswersDataModel(new ArrayList<QuestionAnswers>(answers));
} 
```

我在每个方法中添加了断点，以查看它是否被调用，以及系统输出。

我究竟做错了什么？我虽然可能是因为我在方法调用中没有 AjaxBehaviourEvent，但这并没有改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T22:07:30.037

我发现它是什么。我删除了每个元素，发现它与我的输入文本框有关。我删除了它上面的验证器，它仍然没有工作。然后我发现它正在使用实体验证（IE，它不能为空或空白），即使我从未说过需要任何验证。一旦我在框中输入了文本，这些方法就可以毫无错误地运行。

# c# - 创建一个基本视图模型，但似乎无法在 OnActionExecuting 中挂钩

> ID：16179391
> 
> 赞同：2
> 
> 时间：2013-04-23T21:20:32.130
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, viewdata

我创建了一个 baseviewmodel，我的其他强类型视图模型继承自该模型。

基础控制器：

```
protected override void OnActionExecuting(ActionExecutingContext filterContext)
{
            var baseViewModel = ViewData.Model as BaseViewModel;
            if (baseViewModel != null)
            {
                // set common properties that I want to use in all views
            }
} 
```

现在，当我在 if cluase 上设置断点时，baseViewModel 似乎始终为空。

如何将基本 ViewData.Model 设置为 BaseViewModel？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T21:32:12.870

[OnActionExecuting](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.onactionexecuting%28v=vs.108%29.aspx)还为时过早，无法查看模型。

> 在调用操作方法之前调用。

您可以在 OnActionExecuted 中看到模型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T00:35:12.643

`ViewData`旨在将模型从控制器操作发送到视图。

您的`OnActionExecuting`钩子是在调用操作方法之前...这就是为什么您将视图数据的模型视为空的原因。尝试`OnActionExecuted`改用。

然后，您可以通过以下方式使用关键字检查模型是否属于该基本类型`is`：

```
if(ViewData.Model != null && ViewData.Model is BaseModel){

    var base = ViewData.Model as BaseModel;
    // set common properties
} 
```

# sql - SQL Cross Join error The multi-part identifier could not be bound

> ID：16179393
> 
> 赞同：2
> 
> 时间：2013-04-23T21:20:50.900
> 
> 标签：sql, sql-server

我试图从表 Jobs 中返回几行，但也从表 JobProducts 中返回下一个截止日期（每个 JobProduct 都有截止日期）。

到目前为止，我有以下内容

```
SELECT  J.CustomerID,  J.JobID, J.Status, 
J.Deleted, J.JobNo, Customers.CompanyName AS [Company], 
J.DateCreated AS [Date Created], derivedtbl_1.DueDate AS [Due Date] 
FROM Jobs  J
LEFT OUTER JOIN 
Customers ON J.CustomerID = Customers.CustomerID CROSS JOIN 
(SELECT   TOP (1) DueDate, JobProductID, JobID, ProductID, DepartmentID 
FROM      JobProducts AS JobProducts_1 
WHERE    JobProducts_1.JobID = J.JobID 
ORDER BY DueDate) 
AS derivedtbl_1 
```

但我收到错误无法绑定多部分标识符“J.JobID”。

任何帮助将非常感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T21:25:36.030

该错误似乎来自 SQL Server。我认为您对以下内容感到困惑`CROSS JOIN`（这是笛卡尔积）`CROSS APPLY`：

```
SELECT  J.CustomerID,  
        J.JobID, 
        J.Status, 
        J.Deleted, 
        J.JobNo, 
        Customers.CompanyName AS [Company], 
        J.DateCreated AS [Date Created], 
        derivedtbl_1.DueDate AS [Due Date] 
FROM Jobs  J
LEFT JOIN Customers 
    ON J.CustomerID = Customers.CustomerID 
CROSS APPLY (SELECT TOP (1) DueDate, 
                           JobProductID, 
                           JobID, 
                           ProductID, 
                           DepartmentID 
            FROM JobProducts AS JobProducts_1 
            WHERE JobProducts_1.JobID = J.JobID 
            ORDER BY DueDate) 
AS derivedtbl_1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:26:03.023

您可以尝试将交叉连接更改为交叉应用

```
CROSS APPLY
(SELECT   TOP (1) DueDate, JobProductID, JobID, ProductID, DepartmentID 
FROM      JobProducts AS JobProducts_1 
WHERE    JobProducts_1.JobID = J.JobID 
ORDER BY DueDate) 
```

# android - 安卓 HTML 视图

> ID：16179399
> 
> 赞同：0
> 
> 时间：2013-04-23T21:21:13.817
> 
> 标签：android, webview

使用 Android，我有一个 WebView。我在本地创建 html，其中包括对 Assets 文件夹中的 css、javascript 和图像的引用。然后显示此本地 html。

如何让 WebView 引用资产的 javascript 和图像？

我猜我需要告诉 HTML VIew 基本文件夹是 Assets 文件夹？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:25:49.683

您应该`index.html`使用此位置访问文件：

```
file:///android_asset/index.html 
```

# asp.net-mvc-4 - Razor 模板编辑器不喜欢我的 Knockout attr 绑定语法

> ID：16179404
> 
> 赞同：5
> 
> 时间：2013-04-23T21:21:22.403
> 
> 标签：asp.net-mvc-4, knockout.js, razor-2

我有一个运行良好的 Knockout attr 绑定：

```
<a data-bind="attr: { href: 'Action?destination=' + '@Model.Property' + '&entityId=' + Id }">Select</a> 
```

但是，一旦将任何模型属性插入到 href 字符串中，Visual Studio 中突出显示的语法就会引发“未终止的字符串常量”错误。

我尝试过'@()' 和'@:'，但似乎没有什么能让编辑满意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-22T21:28:10.397

我有一个类似的问题，我想将控制器操作 URL（由`UrlHelper`Razor 视图的实例提供）传递给我的视图模型函数，以便稍后在 jQuery AJAX 调用中使用。

以下标记在浏览器中有效，但在 Visual Studio 中突出显示语法：

```
<button data-bind="click: function (data) { someFunction(data, '@Url.Action("SomeAction", "SomeController")') }">Action!</button> 
```

可以通过将上面的内容更改为以下内容来抑制语法突出显示：

```
<button data-bind="@("click: function (data) { someFunction(data, '" + Url.Action("SomeAction", "SomeController") + "') }")">Action!</button> 
```

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2013-09-06T21:15:08.350

为什么不直接使用常规的 Html.ActionLink？

```
@Html.ActionLink("Action", "Select", new { destination = Model.Property, entityId = Model.Id }); 
```

# sorting - 聚类数对

> ID：16179406
> 
> 赞同：0
> 
> 时间：2013-04-23T21:21:23.410
> 
> 标签：sorting

我在数组中有一组随机顺序的数字对，如下所示：

(5,6) (2,7) (3,7) (1,2) (3,4) (4,5)

比较配对时，我需要根据公共数字链接所有这些数字。所以我的预期输出是：1,2,7,3,4,5,6。如果可以按 (1,2) (2,7) (3,7) (3,4) (4,5) (5,6) 的顺序对对进行排序，我可以很容易地得到它。任何支持这种排序的算法？

# c# - PowerShell 运行空间到 Exchange 在线预算超出错误

> ID：16179414
> 
> 赞同：2
> 
> 时间：2013-04-23T21:22:04.980
> 
> 标签：c#, powershell, exchange-server, office365, runspace

我有一个以编程方式在 Exchange Server 上调用 PowerShell 命令的应用程序。将应用程序连接到 Exchange 在线服务器 outlook.office365.com 成功，并且可以调用单个命令，但是在短时间内按顺序发送多个命令，服务器会阻塞并回复以下消息。
我尝试使用 runspace.Close 和 runspace.Dispose，但没有效果。
从下面的消息中，我看到在 60 秒内最多有 5 个运行空间，但是使用我的代码，我正在关闭和处理运行空间，这个限制不应该是问题。当然，我总是有可能做错了什么。

消息（一些文本被点掩盖）：

```
Connecting to remote server failed with the following error message : Fail to create runspace because you have exceeded your budget to create runspace. Please wait for 45 seconds.
Policy: CN=GlobalThrottlingPolicy_....,CN=Global Settings,CN=ExchangeLabs,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=namprd05,DC=prod,DC=outlook,DC=com; 
Snapshot: Owner:    Sid~NAMPR05A001\.......~WSMan~false
BudgetType: WSMan
ActiveRunspaces:    0/3
Balance:    600000/1800000/-3000000
PowerShellCmdletsLeft:  199/200
ExchangeCmdletsLeft:    9223372036854775807/Unlimited
CmdletTimePeriod:   5
DestructiveCmdletsLeft: 60/Unlimited
DestructiveCmdletTimePeriod:    Unlimited
QueueDepth: Unlimited
MaxRunspaces:   5
MaxRunspacesTimePeriod: 60
LastTimeFrameUpdate:    4/23/2013 8:48:20 PM
LastTimeFrameUpdateDestructiveCmdlets:  4/23/2013 8:40:36 PM
LastTimeFrameUpdateMaxRunspaces:    4/23/2013 8:48:08 PM
Locked: False
LockRemaining:  00:00:00 For more information, see the about_Remote_Troubleshooting Help topic 
```

这是简化的代码（实际更复杂，但基本上就是这样）：

```
private Collection<PSObject> GetUser(string userName, string password)
{
    try
    {
        serverName = "https://outlook.office365.com/powershell-LiveID?PSVersion=2.0"
        SecureString pass = new SecureString();

        foreach (char x in password.ToCharArray())
        {
            pass.AppendChar(x);
        }

        WSManConnectionInfo connectionInfo = new WSManConnectionInfo(
            new Uri(serverName), PSNamespace, new PSCredential(userName, pass));
        connectionInfo.AuthenticationMechanism = AuthenticationMechanism.Basic;
        connectionInfo.SkipCNCheck = true;
        connectionInfo.SkipCACheck = true;

        CallContext.SetData("WSManConnectionInfo", connectionInfo);

        using (Runspace runspace = RunspaceFactory.CreateRunspace(connectionInfo))
        {
            using (PowerShell powershell = PowerShell.Create())
            {
                try
                {
                    powershell.AddCommand("Get-User");
                    powershell.AddArgument(userName);

                    runspace.Open();
                    powershell.Runspace = runspace;

                    return powershell.Invoke();

                }
                catch (Exception e)
                {
                    return null;
                }
                finally
                {
                    runspace.Close();
                    runspace.Dispose();
                }

            }
        }
    }
    catch (Exception e)
    {

        return null;
    }
} 
```

感谢您的任何意见。

鲍里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-05-11T14:08:18.750

据我了解，在所述时间段内可以创建多少运行空间是有限制的，无论运行空间是否再次被拆除。然而，我还没有找到任何文件来支持这种解释。

# haskell - 无法使类型签名适用于简单的递归函数

> ID：16179415
> 
> 赞同：5
> 
> 时间：2013-04-23T21:22:20.920
> 
> 标签：haskell, recursion

这是我的代码：

```
test :: (Num a) => [a] -> a
test []     = 0
test [x:xs] = x + test xs 
```

然而，当我通过 ghci as 运行它时`:l test`，我得到了这个错误：

[1 of 1] 编译 Main（test.hs，解释）

```
test.hs:3:7:
    Couldn't match type `a' with `[a]'
      `a' is a rigid type variable bound by
          the type signature for spew :: Num a => [a] -> a at test.hs:2:1
    In the pattern: x : xs
    In the pattern: [x : xs]
    In an equation for `spew': spew [x : xs] = x + spew xs
Failed, modules loaded: none. 
```

尽量不要笑:) 这是我第一次尝试haskell。任何帮助或解释都会很棒。

PS：我知道这可以通过折叠轻松完成，但我正在尝试练习编写自己的类型签名。提前致谢！！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-23T21:25:16.830

你的意思是

```
test :: (Num a) => [a] -> a
test []     = 0
test (x:xs) = x + test xs -- note round brackets 
```

带圆括号。

`[x:xs]`是一个包含一个元素的列表，它本身就是一个列表，而`(x:xs)`是一个包含第一个元素`x`和 tail的列表`xs`。

如果你输入`length (1:[1,1,1])`，你会得到 4，但如果你输入`length [1:[1,1,1]]`，你会得到 1——唯一的元素是一个列表。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-23T21:25:45.377

您可能打算将列表作为一个整体进行匹配，而不是列表的第一个元素：

```
test (x:xs) = ... 
```

如果不这样做，则模式具有推断的类型`[[b]]`，因此`a == [b]`根据`test`s 签名，因此`xs`必须具有类型`[b]`，因此`test xs`必须具有类型，`b`而且`a`根据 的签名也有类型`test`，这意味着`a == [a]`，这是一个矛盾并导致统一错误 ：）

# wcf - 一个过程需要多长时间 - 通过 WCF 服务

> ID：16179418
> 
> 赞同：0
> 
> 时间：2013-04-23T21:22:42.633
> 
> 标签：wcf, time, estimation

这次我是带着另一个问题来的。

我有一个应用程序可以将数据从一个数据库移动到另一个数据库。它还处理数据库之间的验证和比较。当我们开始将数据从源移动到目标时，它需要一段时间，因为它总是处理数千条记录。我们使用 WCF 服务和 SQL 服务器@服务器端和 WPF@客户端来处理这个问题。

现在，我需要在用户开始此移动过程之前根据源数据库 no: 记录（最终这就是我将在目标数据库中创建的内容）通知用户它将花费的时间。

现在我真正的问题是，我们可以做到这一点并从中获得估计时间的最佳方法是什么？

感谢并感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:31:44.983

如果您的估计要在上传过程中更新，您可以花费已经花费的时间，删除已处理记录的数量，然后乘以剩余记录的数量。这将为您提供更新的平均剩余时间：

```
TimeSpan spent = DateTime.Now - startTime;
TimeSpan remaining = (spent / numberOfProcessedRecords) * numberOfRemainingRecords; 
```

# windows-8 - 在 IE 10 WINdows 8 64 示例中工作的浏览器帮助对象

> ID：16179420
> 
> 赞同：3
> 
> 时间：2013-04-23T21:22:55.330
> 
> 标签：windows-8, 64-bit, internet-explorer-10, bho

我已经为此苦苦挣扎了一个星期。我使用了这个示例[如何开始开发 Internet Explorer 扩展？](https://stackoverflow.com/questions/5643819/developing-internet-explorer-extensions)它甚至在 Win 7 64 位 IE 10 中也能完美运行，但在 Windows 8 64 IE 10 中却不行。

它正确加载，但什么也不做，即使是简单的`MessageBox`put in `OnDocumentComplete()`。虽然我在不同的论坛上发现人们确认他们已经让它运行了，所以我要问的只是一个有效的例子。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T19:19:17.730

项目属性的 Build 部分中的“Register for COM interop”复选框起到了作用。有趣的是，没有它，任何其他软件和浏览器的组合都可以正常工作。

# php - 如何在php中分割字符串

> ID：16179421
> 
> 赞同：0
> 
> 时间：2013-04-23T21:22:55.877
> 
> 标签：php, regex, string, divider

如何`;`在包含字符串的以下变量中添加分隔符

我有这样的字符串：

```
$filename = "a.jpg3c.pngyes.jpg"; 
```

我想要类似的东西

```
a.jpg;3c.png;yes.jpg 
```

当我选择要上传的多个文件时创建此字符串。

正则表达式是这里唯一的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:26:16.863

正则表达式不是唯一的解决方案！也许您可以使用`str_replace()`而不是正则表达式。

```
$filenames = "a.jpg3c.pngyes.jpg";

$img_extensions = array(".png", ".jpg", ".gif");
$semicolon_additions = array(".png;", ".jpg;", ".gif;");

$newfilenames = str_replace($img_extensions, $semicolon_additions, $filenames); 
```

[http://php.net/manual/en/function.str-replace.php](http://php.net/manual/en/function.str-replace.php)

**编辑：**在您的特定情况下，我会在循环内的文件名末尾添加分号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:33:04.003

这是使用正则表达式的一种选择：

```
$filename = "a.jpg3c.pngyes.jpg";
$regex = '/\.(jpg|png|gif)(?!$)/';
$filename = preg_replace($regex, ".$1;", $filename); 
```

# apache - 使用 .htaccess 规则递归重定向所有 PDF？

> ID：16179426
> 
> 赞同：2
> 
> 时间：2013-04-23T21:23:17.660
> 
> 标签：apache, .htaccess

我正在尝试提出一个规则，它将所有 PDF 递归地重定向到不同的目录，除了我正在做的更改之外保留路径。

初始目录是*/wp-content/uploads* 目标目录是*/build/wp-content/uploads*

所以/wp-content/uploads/2013/03/LW_Stevens.pdf

将重定向到 /build/wp-content/uploads/2013/03/LW_Stevens.pdf

```
RewriteEngine On
RewriteRule ^wp-content/uploads/*/(.+\.pdf)$ build/wp-content/uploads/*/$1 [L] 
```

显然 /*/ 部分是错误的，我该如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:33:38.873

这是我在初始目录后匹配或不匹配路径的建议。如果初始目录后没有路径，则忽略。

```
RewriteRule ^wp-content\/uploads\/(?:(.+)\/)?(.+\.pdf)$ build/wp-content/uploads/$1/$2 [L] 
```

您可以在此处查看返回的匹配项： [http ://rubular.com/r/16io6ZVSJc](http://rubular.com/r/16io6ZVSJc)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:39:36.000

用这个替换你的规则：

```
RewriteRule ^(wp-content/uploads/.*?/[^.]+\.pdf)$ /build/$1 [L,NC] 
```

并确保将此规则置于 .htaccess 中的其他标准 Wordpress 规则之上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-09T09:31:16.490

将两个答案的混合用于wordpress。

插件：John Godley 重定向

重定向类型：正则表达式 原始 url：^(/pdfs/(?:(.+)/)?(.+.pdf)) 目标 url：URL$1

# c++ - 在运行时定义非作用域文本 C++

> ID：16179428
> 
> 赞同：0
> 
> 时间：2013-04-23T21:23:28.450
> 
> 标签：c++, winforms, scope

是否可以选择定义文本并稍后使用它而不是作为字符串或任何东西，只是作为函数的一部分，**但能够在程序中间重新定义它（定义*不在*预处理器中进行，但是运行）？**例如，我在 C++ Windows 窗体中有以下代码：

```
private: System::Void ps1_GotFocus(System::Object^  sender, System::EventArgs^  e)
{
    if(this->ps1->Text == L"/ Your text here /") this->ps1->Text = L"";
    this->ps1->ForeColor = System::Drawing::Color::FromName( "Black" );
}

private: System::Void ps2_GotFocus(System::Object^  sender, System::EventArgs^  e)
{
    if(this->ps1->Text == L"/ Your text here /") this->ps1->Text = L"";
    this->ps2->ForeColor = System::Drawing::Color::FromName( "Black" );
} 
```

在哪里`ps1`和`ps2`是**TextBoxes**，我用它来显示一个**灰色**的“你的文本在这里”字符串，当在 TextBox 中单击准备输入时（当 TB 时`GotFocus`）以清除文本并使输入变为**黑色**。考虑到我有 9 个这样的文本框，是否可以用更少的代码完成所有这些工作？我在使用该 ps 的所有东西之外尝试了相同的代码`#define ps ps1`和一个全局方法，但正如您所知， s 是在预处理器中完成的，最后一个 define ( ) 甚至在程序启动之前就已经定义了。`ps_GetFocus()``#define``ps ps9`

有没有办法在运行时定义非范围文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:43:57.277

只需`ps_GotFocus`为所有文本框提供一个通用功能，然后使用`sender`（您必须先将其转换为适当的类型，不知道如何在 .Net C++ 中使用那个奇怪的东西来做到这一点`^`，也许`dynamic_cast`会起作用？）而不是各种`ps`物体。

类似于以下内容：

```
private: System::Void ps_GotFocus(System::Object^  sender, System::EventArgs^  e)
{
    TypeForYourTextBox^ the_sender = dynamic_cast<TypeForYourTextBox^>(sender);
    // I'm unsure about the previous line but you get the idea
    // You may also want to check that the cast succeeded, ie. the_sender is not null
    if (the_sender->Text == L"/ Your text here /") the_sender->Text = L"";
    the_sender->ForeColor = System::Drawing::Color::FromName("Black");
} 
```

# c# - (mongodb) 使用 csharp 在 bson 对象中获取 bson 对象

> ID：16179431
> 
> 赞同：0
> 
> 时间：2013-04-23T21:23:41.797
> 
> 标签：c#, mongodb, mongodb-.net-driver

我有一个包含以下文件的集合：

```
{
    field1: {subfield1:{ssfield1:5,ssfield2:6},subfield2:6},
    field2: 1,
    ...
} 
```

我只想获取子字段，但我不确定如何从 csharp 查询它（它似乎没有在 bsondocument 中返回 bsondocument）。

有什么帮助吗？

我试过这个：

```
String c = "mongodb://"+myip;
MongoServer server = MongoServer.Create(c);
MongoDatabase db = server.GetDatabase(mydb);
var collection = db.GetCollection(col); 
string[] fields = new string[] { "field1" };  
MongoCursor cursor = collection.Find().SetFields(fields); 
```

但它似乎回来了

```
{subfield2:6} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T21:34:37.610

我创建了一个包含一个与您的示例文档非常相似的文档的集合：

```
> db.test.find().pretty()
{
    "_id" : ObjectId("518ac1aa92f1c388279a9979"),
    "field1" : {
        "subfield1" : {
            "ssfield1" : 5,
            "ssfield2" : 6
        },
        "subfield2" : 6
    },
    "field2" : 1
}
> 
```

在显示我尝试重现您的 C# 代码时得到的结果之前，让我们看一下 MongoDB shell 中的相同查询：

```
> db.test.find({}, { field1 : 1 }).pretty()
{
    "_id" : ObjectId("518ac1aa92f1c388279a9979"),
    "field1" : {
        "subfield1" : {
            "ssfield1" : 5,
            "ssfield2" : 6
        },
        "subfield2" : 6
    }
}
> 
```

这里有几点需要注意：

1.  默认情况下，服务器总是返回 _id 字段
2.  field1 是唯一返回的其他字段（正是我们要求的）
3.  subfield2 被返回，因为它嵌入在 field1 中

我使用与您的稍有不同的 C# 代码进行测试：

```
foreach (var document in collection.FindAll().SetFields("field1"))
{
    Console.WriteLine(document.ToJson(new JsonWriterSettings { Indent = true }));
} 
```

我从那个循环得到的输出是：

```
{
  "_id" : ObjectId("518ac1aa92f1c388279a9979"),
  "field1" : {
    "subfield1" : {
      "ssfield1" : 5.0,
      "ssfield2" : 6.0
    },
    "subfield2" : 6.0
  }
} 
```

这与 MongoDB shell 的输出基本相同。

如果您还有其他问题，请告诉我。

# data-binding - 在 Angular 绑定中设置 $scope.items

> ID：16179432
> 
> 赞同：0
> 
> 时间：2013-04-23T21:23:46.470
> 
> 标签：data-binding, angularjs, angularjs-directive

我有一个具有以下功能的服务，

```
public object Get(AllUsers request)
{
    var users = XYZ.GetAllUsers();
    var userList = users.Cast<XYZ>();

    return new AllUsers
    {
        UsersAcc = userList.Select(ConvertToEntity).ToList()
    };
} 
```

我正在尝试从角度控制器获取结果。

```
 function UserAccountController($scope, $location, $filter, UserAccount) {
    @scope.items = function(){
    var abc = UserAccount.query();
return abc.UsersAcc

    }
    } 
```

这是我的服务

```
angular.module('userAccService', ['ngResource']).factory('UserAcc', function($resource) {
    return $resource('/api/useracc/:id', {}, {
      query: {
        method: 'GET',
      }
}); 
```

我是角度服务的新手，似乎无法正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:47:40.030

您需要创建一个数组对象并返回它。查询完成后，您可以使用 list 填充相同的实例`UsersAcc`。请记住，`$scope.items`直到`[]`查询返回数据。

```
$scope.items = getUsersAcc();

function getUsersAcc() {
    var dataArray = new Array();        
    UserAccount.query(function (data) {         
        var list = data.UsersAcc;
        for (var i = 0, c = list.length; i < c; i++) {
            dataArray.push(list[i]);
        }
    };
    return dataArray;
}; 
```

# android - 专门针对 Android 设备

> ID：16179435
> 
> 赞同：0
> 
> 时间：2013-04-23T21:24:01.513
> 
> 标签：android, ios, android-layout

如何在不干扰设备的情况下专门针对 Android`iOS`设备？

我知道我们可以使用

```
 @media all and (max-width: 320px) { }<br/>
 @media all and (min-width: 321px) and (max-width: 640px) { }<br/>
 @media all and (max-width: 641px) and (max-width: 768px) { } 
```

但我不想通过获取屏幕分辨率来做到这一点。相反，我想通过加载不同`css`的`Android`具体来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:49:09.670

您可以检查 userAgent：

```
if (navigator.userAgent.toLowerCase().match(/android/)) {
    console.log("uses android")
    //alert("uses android"), load your css here.
    } else if (navigator.userAgent.toLowerCase().match(/iphone/) || navigator.userAgent.toLowerCase().match(/ipad/)) {
        console.log("uses iphone") //load your css here
    } else { 
    //alert("browser, blackberry or whatever") load your css here
    } 
```

**更新**

Jsfiddle：[给你。](http://jsfiddle.net/XKuuX/)

# java - maven在java中生成web服务

> ID：16179439
> 
> 赞同：2
> 
> 时间：2013-04-23T21:24:35.607
> 
> 标签：java, web-services, maven

我是 maven 新手，我想使用 maven 从 wsdl 文件（使用 wsimport 插件？）生成 java 代码，该文件在我的项目中（不在 url 中）。

我认为 wsdl 文件应该在 myprojet/src/main/resources 中的某个位置，而生成的源文件应该在 myproject/target/generatedsources/ws 中。

如果选择这些地方ok？如果是这样，我如何使用 maven 创建从 wsdl 到指定文件夹的源？我可以选择源的 java 包名吗？我是不是该 ？然后我应该从源文件中制作一个 jar 文件吗？如何确保生成的源代码可用于编译（在类路径中）？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T22:17:24.123

使用 wsimport 插件有几种方法可以做到这一点，但大多数示例需要更多关于 pom.xml 的知识

[Apache CXF](http://cxf.apache.org/docs/maven-cxf-codegen-plugin-wsdl-to-java.html)是用于此目的的流行免费插件

```
<plugin>
<groupId>org.apache.cxf</groupId>
<artifactId>cxf-codegen-plugin</artifactId>
<version>${cxf.version}</version>
<executions>
    <execution>
        <id>generate-sources</id>
        <phase>generate-sources</phase>
        <configuration>
            <sourceRoot>${project.build.directory}/generated/cxf</sourceRoot>
            <wsdlOptions>
                <wsdlOption>
                    <wsdl>${basedir}/src/main/resources/myService.wsdl</wsdl>
                </wsdlOption>
            </wsdlOptions>
        </configuration>
        <goals>
            <goal>wsdl2java</goal>
        </goals>
    </execution>
</executions> 
```

注意：您绝对可以从生成的源中制作一个 jar，但这将是您 POM 中的一个单独条目

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T22:22:56.110

查看 Apache 的 Axis2——它专门设计用于帮助生成基于 Web 服务的 WSDL 的代码。基本上这正是您正在寻找的：

[http://axis.apache.org/axis2/java/core/](http://axis.apache.org/axis2/java/core/)

编辑：为了扩展，我通常会运行 wsdl2java(.bat 或 .sh) 文件并将其指向 wsdl（在 Web 或本地副本上）并生成其他所有内容。它甚至可以为您将其全部打包成一个罐子（我的首选方法，因为它“更干净”）。您可能不需要进入生成的代码并更改任何内容，您只需将该 jar 添加到您的类路径中，然后像任何其他库一样导入并使用它。

# matlab - 在信号中查找二进制数据序列

> ID：16179442
> 
> 赞同：3
> 
> 时间：2013-04-23T21:24:59.620
> 
> 标签：matlab, signal-processing, correlation

## 这是我的目标：

我试图找到一种方法来搜索数据信号并找到（索引）已知重复二进制数据序列所在的位置。然后，因为扩频码和解调是已知的，所以拉出对应的数据码片读取。目前，我相信 xcorr 会成功的。

## 这是我的问题：

我似乎无法从 xcorr 或 xcorr2 解释我的结果来给我正在寻找的东西。我在从我的 xcorr 函数的向量位置交叉引用到我的时间向量时遇到问题，或者在使用 xcorr 正确识别我的数据序列时遇到问题，或者两者兼而有之。可能存在其他可能性。

## 我在哪里/我有什么：

我创建了一个随机 BPSK 信号，该信号由感兴趣的数据序列和重复周期内的垃圾数据组成。我尝试使用 xcorr 处理它，这就是我卡住的地方。

### 这是我的代码：

```
%% Clear Variables

clc;
clear all, close all;

%% Create random data

nbits = 2^10;
ngarbage = 3*nbits;
data = randi([0,1],1,nbits);
garbage = randi([0,1],1,ngarbage);
stream = horzcat(data,garbage); 

%% Convert from Unipolar to Bipolar Encoding

stream_b = 2*stream - 1;

%% Define Parameters

%%% Variable Parameters
nsamples = 20*nbits;
nseq = 5 %# Iterate stream nseq times
T = 10; %# Number of periods
Ts = 1; %# Symbol Duration
Es = Ts/2; %# Energy per Symbol
fc = 1e9; %# Carrier frequency

%%% Dependent Parameters
A = sqrt(2*Es/Ts); %# Amplitude of Carrier
omega = 2*pi*fc %# Frequency in radians
t = linspace(0,T,nsamples) %# Discrete time from 0 to T periods with nsamples samples
nspb = nsamples/length(stream) %# Number of samples per bit

%% Creating the BPSK Modulation
%# First we have to stretch the stream to fit the time vector. We can quickly do this using _
%# simple matrix manipulation.

% Replicate each bit nspb/nseq times
repStream_b = repmat(stream_b',1,nspb/nseq);

% Tranpose and replicate nseq times to be able to fill to t
modSig_proto = repmat(repStream_b',1,nseq);

% Tranpose column by column, then rearrange into a row vector
modSig = modSig_proto(:)';

%% The Carrier Wave

carrier = A*cos(omega*t);

%% Modulated Signal

sig = modSig.*carrier; 
```

### 使用 XCORR

我`xcorr2()`用来消除`xcorr`不等向量的零填充效应。请参阅下面的评论以进行澄清。

```
corr = abs(xcorr2(data,sig); %# pull the absolute correlation between data and sig
[val,ind] = sort(corr(:),'descend') %# sort the correlation data and assign values and indices
ind_max = ind(1:nseq); %# pull the nseq highest valued indices and send to ind_max 
```

现在，我认为这应该拉动 data 和 sig 之间的五个最高相关性。对于流的每次迭代，这些应该对应于流中数据的结束位，因为我认为这是数据与 sig 最强烈交叉相关的地方，但事实并非如此。有时最大值甚至不是一个流长度。所以我在这里很困惑。

## 问题

在一个三部分的问题中：

1.  我错过了某个步骤吗？在这种情况下，我如何使用 xcorr 来查找数据和 sig 最密切相关的位置？

2.  我的整个方法错了吗？我不应该寻找最大相关性吗？

3.  或者我应该从另一个角度解决这个问题，id est，不使用 xcorr，也许使用过滤器或其他功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:05:42.593

你的整体方法很棒，很有意义。您遇到的问题是您与垃圾数据有一些实际的相关性。我注意到您将所有的 sream 都以零为中心，但对您的数据却没有这样做。如果您将数据归零，您的相关峰值将得到更好的定义（至少在我尝试时有效）。

```
data = 2*data -1; 
```

另外，我不建议使用简单的排序来查找您的峰值。如果你有一个很宽的峰值，尤其是在有噪声信号的情况下，你可以有两个相邻的高点。找到一个最大值，然后将该点和几个邻居归零。然后重复你喜欢的次数。或者，如果您知道您的 epoch 有多长，只需与一个 epoch 的数据价值进行关联，并在信号到达时对其进行迭代。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-02T10:38:12.453

在@David K 和@Patrick Mineault 的帮助下，我设法找出了哪里出错了。首先@Patrick Mineault 建议我翻转信号。查看您对结果的期望的最佳方法是沿着搜索到的较大向量滑动小向量。所以

```
corr = xcorr2(sig,data); 
```

然后我喜欢把结尾剪掉，因为它只是额外的。我使用我制作的修剪功能做到了这一点，该功能只需获取您正在滑动的信号并修剪它与 xcorr 结果末尾无关的部分。

```
trim = @(x,s2) x(1:end - (length(s2) - 1));
trim(corr,data); 
```

然后，正如@David K 建议的那样，您需要将您正在寻找的数据流编码为与您搜索的信号相同。所以在这种情况下

```
data = 2*data-1; 
```

其次，如果您的数据只是原始位长度，而不是拉伸、迭代长度，则**可以**在信号中找到它，但会非常嘈杂。为了减少噪声，只需拉伸数据以匹配它在迭代信号中的拉伸长度。所以

```
rdata = repmat(data',1,nspb/nseq);
rdata = repmat(rdata',1,nseq);
data = rdata(:)'; 
```

现在最后，我们应该对这个案例有非常清晰的相关性。并拉出应该对应于我写的那些相关性的最大值

```
[sortedValues sortIndex] = sort(corr(:),'descend');
c = 0 ;
for r = 1 : length(sortedValues)
    if sortedValues(r,:) == max(corr)
        c = c + 1;
        maxIndex(1,c) = sortIndex(r,:);
    else break % If you don't do this, you get loop lock
    end
 end 
```

现在`c`应该最终`nseq`适用于这种情况，并且您应该有 5 个索引时间，corrs 应该是！`c`您可以使用另一个循环和or轻松拉出位`length(maxIndex)`。我还把它做成了一个更“真实世界”的玩具脚本，其中有一个数据流、多普勒、衰落，它是在几秒钟内超过一个时间向量而不是样本。

谢谢您的帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T22:22:20.803

尝试翻转信号，即：

```
corr = abs(xcorr2(data,sig(end:-1:1)); 
```

这样更好吗？

# android - 为什么我的这个 ImageView 的 OnClick 不起作用？

> ID：16179444
> 
> 赞同：2
> 
> 时间：2013-04-23T21:25:12.017
> 
> 标签：android

我真的不知道为什么这不起作用，我整晚都在尝试。`ImageView`当我点击它时应该减去分数。我也尝试记录它但没有成功..可能是因为我的动画以某种方式干扰？

这是我的整个 XML

```
<TextView
    android:id="@+id/timer1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="Test" />
<TextView
    android:id="@+id/score1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="Score:" />

<ImageView
    android:id="@+id/imgview1"
    android:layout_width="83dp"
    android:layout_height="131dp"
    android:clickable="true"  
    android:onClick="PeanutClick" 
    android:src="@drawable/lil_peanut"/> 
```

这是我的源代码

```
public class GameView extends Activity implements OnClickListener {
MediaPlayer backgroundMusic;
TextView mTextField;
TextView mScoreField;
Point size = new Point();
Display display;
ImageView image;
int score = 0;

@SuppressLint("NewApi")
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.gameviewlayout);
    int l;
    mTextField = (TextView) findViewById(R.id.timer1);
    mScoreField = (TextView) findViewById(R.id.score1);
    image = (ImageView) findViewById(R.id.imgview1);
    image.setOnClickListener(this);
    TranslateAnimation moveLefttoRight = new TranslateAnimation(0, 200, 0,
            0);
    moveLefttoRight.setDuration(5000);
    moveLefttoRight.setFillAfter(true);
    moveLefttoRight.setRepeatCount(-1);
    moveLefttoRight.setRepeatMode(Animation.REVERSE);
    image.startAnimation(moveLefttoRight);
    new CountDownTimer(45000, 1000) {

        public void onTick(long millisUntilFinished) {
            mTextField.setText("Seconds Remaining: " + millisUntilFinished
                    / 1000);
        }

        public void onFinish() {
            mTextField.setText("done!");
        }
    }.start();
    display = getWindowManager().getDefaultDisplay();
    display.getSize(size);
    int width = size.x;
    int height = size.y;
    backgroundMusic = MediaPlayer
            .create(GameView.this, R.raw.gallery_music);
    backgroundMusic.start();

}

public void onClick(View v) {
    if (v.getId() == R.id.imgview1)
        Log.i("MB2", "Touchy touchy!");
    PeanutClick();
}

public void PeanutClick() {
    score = score - 100;
    mScoreField.setText("Score: " + score);
}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    backgroundMusic.release();

} 
```

编辑; 发布的解决方案不起作用。我用我的整个 XML 和当前代码更新了代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T11:41:21.320

```
公共无效花生点击（查看视图）{
    分数 = 分数 - 100；
    mScoreField.setText("分数：" + 分数);
}

```

公共方法应该接受一个 View 参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:37:57.053

我不完全确定单击属性如何在 XML 上工作。但是您可以在您的 Java 文件中使用类似...

```
public class GameView extends Activity implements OnClickListener{
   ImageView iv;
   // whatever else

   public void onCreate(...)
   {
       // ...
       iv = (ImageView) findViewById(R.id.imageView1);
       iv.setOnClickListener(this);
   }

   public void onClick(View v)
   {
       if (v.getId() == R.id.imageView1)
          PeanutClick();
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T12:16:20.040

感谢您的帮助，我想通了。一直在`onClick`工作，但仅在图像的原始位置上。

```
<ImageView
android:id="@+id/imgview1"
android:layout_width="83dp"
android:layout_height="131dp"
android:clickable="true"  
android:onClick="PeanutClick" 
android:src="@drawable/lil_peanut"/> 
```

使用此 XML，只有左上角是可点击的。我通过更改 `android:layout_width="83dp"`为 `android:layout_width="fill_parent"`

# sencha-touch - 此应用程序最后一次被更新版本的 Sencha Cmd 修改 - 版本不匹配

> ID：16179447
> 
> 赞同：4
> 
> 时间：2013-04-23T21:25:15.720
> 
> 标签：sencha-touch, sencha-touch-2, sencha-cmd

我正在尝试将 sencha cmd 生产包添加到我的构建过程中。但是我需要打包应用程序的最后一步失败并出现上述错误。

我不明白的是，这是一个来自 SVN 存储库的新建应用程序。sencha cmd 是我刚刚升级的最新版本。所以我的问题是，当它声明**应用程序最后一次被更新版本的 sencha cmd 修改**时，它是在骗我吗？

2不正确的事情：

1.  该应用程序无法被较新版本修改，因为我刚刚将 sencha cmd 的构建机版本升级到最新版本。
2.  该应用程序过去是由 Sencha cmd 创建的，但这比构建机器上的当前应用程序要旧。

所以我很困惑如何解决这个问题。Sencha Cmd 是如何“知道”该应用程序最后一次被不同版本修改的？我的 \app 文件夹中是否有一些文件可以被篡改，使其认为版本是最新的？Sencha Cmd 与我的应用程序代码库有什么关系？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T21:47:40.433

您可以在更新模式下运行新的 Cmd 版本。我认为这确实是为了更新 Sencha Touch 版本，但如果你只是将它指向当前版本（2.1），那么它只会更新自己。

因此，例如，使用最新的 Cmd 运行以下行：

sencha app升级【2.1所在目录】

不过，请确保您首先获取 app.js 的副本，因为新版本会破坏这一点 - 只需在更新后将旧版本放回原处即可。另请注意，它会更新您的“Touch”目录，因此请确保它也已备份。

运行更新并放回 app.js 文件后，您的项目现在应该使用最新的 cmd 构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T06:12:01.553

如果您使用 Sencha Cmd 创建/构建了您的应用程序，您将在以下文件中获得相关信息 ( `workspace.cmd.version`, )：`app.cmd.version`

```
PROJECT_ROOT/touch/cmd/sencha.cfg // This is SDK requirements
PROJECT_ROOT/.sencha/workspace/sencha.cfg // This is workspace build config
PROJECT_ROOT/.sencha/app/sencha.cfg  // This is app build config 
```

您可以尝试在这些文件中伪造 Cmd 版本，并让我们知道它是否有效 :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-19T19:11:22.370

完成 sencha app upgrade --noframework 后，确保还运行“sencha app refresh”以更新 .sencha 元数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-06T16:29:00.030

此误导性错误消息指的是您正在使用的机器上 Sencha 的 Cmd 工具的版本更改。您可以使用以下命令升级 Cmd 脚手架：

```
sencha app upgrade --noframework 
```

来自：'sencha帮助应用升级'

```
Options
  * --noframework, -no - Upgrade only the Sencha Cmd scaffolding and not the SDK 
```

在升级之前一定要备份你的应用程序。upgrade 命令将警告您需要解决的冲突（例如对 app.js 的自定义更改）。当您打开这些文件时，将以标准差异格式记录差异：

```
<<<<<<< Generated
/*
This file is generated and updated by Sencha Cmd. You can edit this file as
needed for your application, but these edits will have to be merged by
Sencha Cmd when it performs code generation tasks such as generating new
models, controllers or views and when running "sencha app upgrade".

Ideally changes to this file would be limited and most work would be done
in other places (such as Controllers). If Sencha Cmd cannot merge your
changes and its generated code, it will produce a "merge conflict" that you
will need to resolve manually.
*/
...
>>>>>>> Custom
... 
```

解决冲突（删除 >>>>>> X 行并确保文件中包含正确的行），您应该已准备就绪。最有可能发生冲突的文件是 app.js - 最好将该文件的备份版本与修改后的版本进行比较，以确信更改。

这似乎意味着所有开发应用程序的开发人员都需要运行相同的 Cmd 版本，因此请记住这一点。

# batch-file - 批处理：在 Windows 机器上通过 ssh 运行文件

> ID：16179449
> 
> 赞同：-1
> 
> 时间：2013-04-23T21:25:18.593
> 
> 标签：batch-file, ssh

对于资深程序员来说，我正在尝试做的事情可能很简单。我有两台 Windows 机器：MachineA 和 MachineB。从 MachineA，我想：

1) ssh 进入 MachineB，运行一个批处理文件说 C:\parent\test.bat -start 2) 删除 C:\parent 文件夹 3) 将 MachineA 中的 C:\parent 文件夹复制到 MachineB 的 C 驱动器 4) 运行 C: \parent\test.bat -stop 5) 我需要通过 MachineA 上的脚本完成上述所有操作（最好是**批处理脚本**）

到目前为止，我读到的大部分内容都使用 plink 或其他软件（有人建议使用 WinSCP）。如果我能在不安装任何软件的情况下完成这一切，那就太好了。有什么建议么？？（我在两台机器上都有 msysgit）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T02:42:09.170

Windows 不支持 SSH。您必须安装一个实用程序才能在远程计算机上运行命令

您可以在这篇文章中找到详细信息： [如何在远程 PC 上执行 dos 命令？](https://stackoverflow.com/questions/11935695/how-to-execute-a-dos-command-on-a-remote-pc)

您的另一个选择是使用 Windows Powershell 脚本。

# sql - 确保 endDate 等于或晚于 startDate

> ID：16179451
> 
> 赞同：1
> 
> 时间：2013-04-23T21:25:24.293
> 
> 标签：sql, sql-server, sql-server-2008, stored-procedures, triggers

我有一张桌子，我需要确保它`startDate`不迟于`endDate`.

可以更新任一日期，因此无论是否输入/修改`startDate`或`endDate`（或两者）都必须应用规则。

使用触发器、存储过程或其他东西更好吗？任何示例语法表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T21:32:15.603

使用检查约束。比触发器简单得多。

```
CREATE TABLE dbo.foo
(
  StartDate DATE NOT NULL,
  EndDate   DATE NOT NULL,
  CONSTRAINT CheckEndLaterThanStart CHECK (EndDate >= StartDate)
); 
```

如果表已经存在：

```
ALTER TABLE dbo.foo
  ADD CONSTRAINT CheckEndLaterThanStart
  CHECK (EndDate >= StartDate); 
```

如果您尝试插入晚于结束日期的开始日期，您将获得：

> 消息 547，级别 16，状态 0，第 1 行
> INSERT 语句与 CHECK 约束“CheckEndLaterThanStart”冲突。冲突发生在数据库“AdventureWorks2012”、表“dbo.foo”中。
> 该语句已终止。

# c++ - 在构造函数中分配双向链表指针

> ID：16179453
> 
> 赞同：0
> 
> 时间：2013-04-23T21:25:32.270
> 
> 标签：c++, list, pointers, constructor

我正在尝试为双向链表创建一些节点并将它们打印出来。所以我创建了我的 dnode 类：

```
template <typename T>
class dnode
{
    public:
        T nodeValue;
        dnode<T> *prev;
        dnode<T> *next;

        dnode() : prev(this), next(this) {}

        dnode(const T& item, dnode<T> *prevNode = NULL, dnode<T> *nextNode = NULL) :
            nodeValue(item), prev(prevNode), next(nextNode) {}

}; 
```

然后我有我的 writeList 函数：

```
template <typename T>
void writeDLinkedList(dnode<T>* header, const string& seperator = " ")
{
    dnode<T> *p = header->next;

    while (p != header)
    {
        cout << p->nodeValue << seperator;
        p = p->next;
    }

    cout << endl << endl;
} 
```

在 main 中，我创建了一个头指针和两个节点，使用构造函数来分配循环列表中的前一个和下一个节点：

```
dnode<int> *header, *one, *two;

header = new dnode<int>(0, two, one);
one = new dnode<int> (10, header, two);
two = new dnode<int> (25, one, header);

writeDLinkedList(header); 
```

当我调用 writeDLinkedList 时，出现分段错误。我对此感到困惑，所以我最终尝试单独输出每个节点值以查看指针是否正常工作。事实证明他们不是。相反，我必须这样做才能使打印功能正常工作：

```
header = new dnode<int>;

one = new dnode<int> (10);
two = new dnode<int> (25);
header->next = one;
one->next = two;
two->next = header;

writeDLinkedList(header); 
```

我想知道为什么我的构造函数没有按应有的方式工作。是初始化列表吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:36:27.770

您的构造函数正在工作。问题是您在给变量赋值之前就在使用它们。

```
dnode<int> *header, *one, *two; 
// one and two have undefined values at this point

header = new dnode<int>(0, two, one);
// so undefined values get put into header->next and header->prev 
```

在双向链表中，您有*指针循环*，节点 A 指向节点 B，节点 B 又指向节点 A。根据定义，指针循环不能仅在构造函数中创建。*因为必须先*创建节点 A 或节点B。不能创建指向另一个节点的最先创建的哪个节点，因为该另一个节点尚不存在。

双向链表比我想象的要复杂一些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:57:43.200

您没有正确管理节点。试试这个：

```
template <typename T>
class dnode
{
    public:
        T nodeValue;
        dnode<T> *prev;
        dnode<T> *next;

        dnode() : prev(NULL), next(NULL) {}

        dnode(const T& item, dnode<T> *prevNode = NULL) :
            nodeValue(item), prev(prevNode), next(NULL)
        {
            if (prev)
            {
                if (prev->next)
                    prev->next->prev = this;
                prev->next = this;
            }
        }

        ~dnode()
        {
            if (prev)
                prev->next = next;

            if (next)
                next->prev = prev;
        }
}; 
```

.

```
template <typename T>
void writeDLinkedList(dnode<T>* header, const string& seperator = " ")
{
    dnode<T> *p = header;

    while (p != NULL)
    {
        cout << p->nodeValue << seperator;
        p = p->next;
    }

    cout << endl << endl;
} 
```

.

```
dnode<int> *header, *one, *two;

header = new dnode<int>(0);
one = new dnode<int> (10, header);
two = new dnode<int> (25, one);

writeDLinkedList(header); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T22:27:46.757

我认为您正在尝试创建双重循环列表。您可以先创建单个节点，然后再连接它们。在连接两个节点后的双重循环列表中，您必须将最后一个节点连接到第一个节点才能闭合圆圈。您可能想尝试类似的东西。我已经为 int 完成了它，但它可以很容易地放入模板中。

```
#include<iostream>

class dnode
{

public:

    dnode(int a):prev(this), next(this), nodeValue(a)
     {}
    void connectNode(dnode *newNode)
     {
        if(newNode != NULL)
        {
            dnode*head = this->next;
            this->next = newNode;
            newNode->prev = this;
            newNode->next = head;
            head->prev = newNode;
        }
     }

    void writeDNode()
     {
     dnode *p = this->next;
        while(p != this)
         {
            std::cout<<"Element "<<p->nodeValue<<std::endl;
            p = p->next;
         }
     }
private:
    int nodeValue;
    dnode *prev;
    dnode *next;

 };

int main(int argc, char*argv[])
 {
    dnode* header = new dnode(-1);
    dnode *one = new dnode(23);
    dnode *two = new dnode(45);
    dnode *three = new dnode(67);
    header->connectNode(one);
    one->connectNode(two);
    two->connectNode(three);
    header->writeDNode();
    std::getchar();

 } 
```

# eclipse - Eclipse 文本编辑器的插入符号位置

> ID：16179458
> 
> 赞同：1
> 
> 时间：2013-04-23T21:25:46.680
> 
> 标签：eclipse, eclipse-plugin

我正在编写一个小插件来将 Eclipse 文本编辑器的插入符号位置移动到选定块的另一侧。问题是我找不到一个很好的方法来发现选择是从左到右还是从右到左。

我知道有这些选择：

*   以某种方式使用 CarretListener。这似乎没有必要，我不想这样做。
*   抓住底层`StyledText`并将选择与插入符号位置进行比较。似乎打破了抽象，因为我必须知道编辑器是如何实现的。另一个缺点是您必须使用`widgetOffset2ModelOffset`文本查看器上的方法来调整位置。

我不能从我的`ITextEditor`or`ISelectionProvider`或其他东西中获得插入符号的位置吗？

这是我的代码：

```
public class SwapCursorSelectionHandler extends AbstractHandler {
    public Object execute( ExecutionEvent event )
    {
        ITextEditor editor;
        try {
            editor = (ITextEditor) HandlerUtil.getActivePartChecked( event );
        } catch ( ExecutionException exc ) {
            throw new RuntimeException( exc );
        }

        ITextSelection sel = (ITextSelection) editor.getSelectionProvider().getSelection();

        // How to find out if sel is left-to-right or right-to-left?!

        editor.selectAndReveal( ... );

        return null;
    }
} 
```

* * *

更新：似乎没有办法在不使用`StyledText`. 我认为这很奇怪，我考虑放置一个错误报告，建议应该将选择方向信息添加到`ITextSelection`. 在我这样做之前，了解一下 SO 这里的人们对这个提案的看法会很有趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-03T13:18:51.947

**编辑：这个解决方案原来是错误的！感谢 willkil 指出这一点。**

* * *

这段不是很优雅的代码是我能找到的最规范的实现方式。它使用`ITextEditor.getAdapter(ITextOperationTarget.class)`和`JFaceTextUtil`。这意味着它取决于特定的编辑器实现，但至少我不必自己触摸它或弄乱`widget2model`方法。

```
public Object execute(ExecutionEvent event) {
    try {
        ITextViewer viewer = (ITextViewer)
            ((ITextEditor) HandlerUtil.getActivePartChecked(event))
                .getAdapter(ITextOperationTarget.class);
        int caretOffset = JFaceTextUtil.getOffsetForCursorLocation(viewer);
    } catch (ExecutionException exc) {
        throw new RuntimeException(exc);
    }
    return null;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-01T01:51:20.533

获取当前光标位置的最佳方法是通过`ITextViewer.getTextWidget().getCaretOffset()`. `IContentAssistProcessor`这是一个在我正在处理的实现中打印各种文本位置的示例：

```
public ICompletionProposal[] computeCompletionProposals(ITextViewer viewer, int offset) {
    int widgetCaretOffset = viewer.getTextWidget().getCaretOffset();
    if (viewer instanceof ITextViewerExtension5) {
        ITextViewerExtension5 extension = (ITextViewerExtension5) viewer;
        System.out.println(extension.widgetOffset2ModelOffset(widgetCaretOffset));
    }
    System.out.println(JFaceTextUtil.getOffsetForCursorLocation(viewer));
    System.out.println(offset);
    System.out.println(widgetCaretOffset);
    System.out.println(viewer.getSelectedRange());
} 
```

我将插入符号放在文档中的任意位置，然后将鼠标移动到靠近第一行的开头，然后通过各种选择触发内容助手。在我的例子中，textViewer 没有实现 ITextViewerExtension5，所以只打印了四行。上面代码的输出如下：

未选择任何内容：

```
6
794
794
Point {794, 0} 
```

通过右移创建从左到右的选择（插入符号在选择的右侧闪烁）：

```
6
794
799
Point {794, 5} 
```

请注意，插入符号的位置是 799，等于 794 + 5。

使用 shift-left 创建的从左到右的选择（选择左侧的插入符号闪烁）：

```
6
794
794
Point {794, 5} 
```

请注意，插入符号位置等于选择偏移量。

另请注意，尽管与此问题无关，但`offset`参数 in`IContentAssistProcessor. computeCompletionProposals()`始终是选择的偏移量，而不是插入符号。

如果您有 an`ITextEditor`而不是 an `ITextViewer`，则可以`ITextViewer`通过该方法从该问题的[另一个答案和另一个问题](https://stackoverflow.com/a/16359871/1086034)[的答案](https://stackoverflow.com/a/7536114/1086034)中[获得](https://stackoverflow.com/q/923342/1086034)：

```
ITextEditor editor;
ITextOperationTarget target = (ITextOperationTarget) editor.getAdapter(ITextOperationTarget.class);
if (target instanceof ITextViewer) {
    ITextViewer viewer = (ITextViewer) target;

    int widgetCaretOffset = viewer.getTextWidget().getCaretOffset();
    if (viewer instanceof ITextViewerExtension5) {
        ITextViewerExtension5 extension = (ITextViewerExtension5) viewer;
        System.out.println(extension.widgetOffset2ModelOffset(widgetCaretOffset));
    }
    System.out.println(JFaceTextUtil.getOffsetForCursorLocation(viewer));
    System.out.println(offset);
    System.out.println(widgetCaretOffset);
    System.out.println(viewer.getSelectedRange());
} 
```

# c# - 如何控制电源按钮按下关机？

> ID：16179460
> 
> 赞同：8
> 
> 时间：2013-04-23T21:25:52.133
> 
> 标签：c#, winapi, wndproc, acpi, windows-7-embedded

我正在开发一个信息亭风格的应用程序，我需要在按下电源按钮时控制 PC 的关机/重启。多亏了这篇[文章](https://stackoverflow.com/questions/11242232/wm-queryendsession-is-causing-me-problems)，我已经完成了大约 90% 的工作。

1.  在控制面板中将 acpi 电源按钮按下操作设置为关机。
2.  监听 WndProc 消息 WM_QUERYENDSESSION
3.  收到问题后，完全没有记录：

    ```
    [DllImport("user32.dll", SetLastError = true)]
    static extern int CancelShutdown(); 
    ```

4.  从 WndProc 返回并显示我自己的消息框，要求用户关闭/重新启动或取消，并响应他们的操作。

如果我从任务栏启动/关闭一切都很好（我可以尽可能快地发布论文）。当我第一次按下电源按钮时，一切都运行良好。尽管在收到 WM_QUERYENDSESSION 消息之前我看到一分钟左右的延迟，但在随后按下电源按钮时。

是否有关于 Windows 多久发出 ACPI 事件的设置或注册表项？我知道这不是硬件，因为在 linux 下，同一台机器会尽可能快地触发 ACPI 事件，因为我可以按下按钮。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-17T14:25:03.210

在工作中寻求帮助后，我能够直接将这个问题提交给 Microsoft 支持。*在我的第三位支持工程师那里，我基本上被告知这在应用程序级别*是不可能的。他认为，调用无证`CancelShutdown()`“混淆”电源管理器或 acpi 驱动程序会导致`WM_QUERYENDSESSION`消息延迟。由于`CancelShutdown()`没有记录，MS 不愿意进一步调查。

那么，你如何挂钩电源按钮按下？您需要编写设备驱动程序，特别是[ACPI 过滤器驱动程序](http://msdn.microsoft.com/en-us/library/windows/hardware/ff540493%28v=vs.85%29.aspx)。我们现在正在对此进行调查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-01T20:56:33.530

我认为这是不可能的，除非您与您的硬件制造商交谈或硬连线开始按钮，以便它不会向处理此问题的硬件发送信号。你只能延迟它，但即使这样也不能给你 100% 的保证，我猜。

Windows 8.1 将（可能）带来 Kiosk 模式。也许这就是你正在寻找的;-)

# objective-c - -dealloc 从 KVO 注销是否为时已晚

> ID：16179465
> 
> 赞同：0
> 
> 时间：2013-04-23T21:26:21.713
> 
> 标签：objective-c, cocoa, automatic-ref-counting, key-value-observing

我有一个模型对象，一个直接的 NSObject 子类，其属性由使用 KVO 的上下文对象观察。

我在模型对象的 dealloc 中从 KVO 注销，如下所示：

```
- (void) dealloc
{
    [self.context unregisterObject:self];
} 
```

上下文的方法如下所示：

```
- (void) unregisterObject:(MyCustomObject*) inObject
{   
    for (NSString *property in [inObject propertyNamesToObserve])
    {
        [inObject removeObserver:self forKeyPath:property context:(void*)kCustomContext];
    }
} 
```

我仍然从运行时收到一条消息，如下所示，所以我想知道 -dealloc 是否为时已晚而无法从 KVO 注销？

```
An instance 0x10045fc10 of class MyCustomObject was deallocated while key value observers were still registered with it. Observation info was leaked, and may even become mistakenly attached to some other object. Set a breakpoint on NSKVODeallocateBreak to stop here in the debugger. Here's the current observation info: 
```

根据这篇文章，我正在做的应该没问题： [KVO and ARC how to removeObserver](https://stackoverflow.com/questions/6959896/kvo-and-arc-how-to-removeobserver)

还是我忽略了什么？我检查了调用 dealloc 时上下文是否为非零。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:58:47.680

弄清楚了。模型对象被上下文为 KVO 注册了两次，但只注销了一次。

# spring - 尝试在 Spring - Hibernate 应用程序中创建 transactionManager bean 时出错

> ID：16179467
> 
> 赞同：0
> 
> 时间：2013-04-23T21:26:36.910
> 
> 标签：spring, hibernate

当 spring 尝试创建事务管理器 bean 时，我收到一个错误。我在下面发布我的 java 类和配置文件。

foo.bar/HelloApp.java ：

```
package foo.bar;

import com.mkyong.stock.bo.StockBo;
import com.mkyong.stock.model.StockEntity;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class HelloApp {
    public static void main(String[] args) {
        ApplicationContext context = new ClassPathXmlApplicationContext("spring-config.xml");

        StockBo stockBo = (StockBo)context.getBean("stockBo");

        //insert
        StockEntity stock = new StockEntity();
        stock.setStockCode("7668");
        stock.setStockName("HAIO");
        stockBo.save(stock);

        //select
        StockEntity stock2 = stockBo.findByStockCode("7668");
        System.out.println(stock2);

        //update
        //stock2.setStockName("HAIO-1");
        //stockBo.update(stock2);

        //delete
        //stockBo.delete(stock2);

        System.out.println("Done");
    }
} 
```

com.mkyong.stock.bo/StockBoImpl.java：

```
package com.mkyong.stock.bo;

import com.mkyong.stock.dao.StockDao;
import com.mkyong.stock.model.StockEntity;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;

@Service("stockBo")
@Transactional(propagation = Propagation.SUPPORTS)
public class StockBoImpl implements StockBo{

    @Autowired
    StockDao stockDao;

    public void setStockDao(StockDao stockDao)
    {
        this.stockDao = stockDao;
    }

    @Override
    public void save(StockEntity stock) {
        stockDao.save(stock);
    }

    @Override
    public void update(StockEntity stock) {
        stockDao.save(stock);
    }

    @Override
    public void delete(StockEntity stock) {
        stockDao.delete(stock);
    }

    @Override
    public StockEntity findByStockCode(String stockCode) {
        return stockDao.findByStockCode(stockCode);
    }
} 
```

com.mkyong.stock.dao/StockDaoImpl.java：

```
package com.mkyong.stock.dao;

import com.mkyong.stock.model.StockEntity;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;

@Repository("stockDao")
public class StockDaoImpl implements StockDao{

    private SessionFactory sessionFactory;

    @Autowired
    public StockDaoImpl(SessionFactory sessionFactory)
    {
        this.sessionFactory = sessionFactory;
    }

    private Session currentSession()
    {
        return sessionFactory.getCurrentSession();
    }

    @Override
    public void save(StockEntity stock) {
        currentSession().save(stock);
    }

    @Override
    public void update(StockEntity stock) {
        currentSession().update(stock);
    }

    @Override
    public void delete(StockEntity stock) {
        currentSession().delete(stock);
    }

    @Override
    public StockEntity findByStockCode(String stockCode) {
        return (StockEntity)currentSession().get(StockEntity.class, stockCode);
    }
} 
```

com.mkyong.stock.model/StockEntity.java ：

```
package com.mkyong.stock.model;

import javax.persistence.*;

import java.io.Serializable;

import static javax.persistence.GenerationType.IDENTITY;

@javax.persistence.Table(name = "stock", schema = "", catalog = "mkyong",
        uniqueConstraints = {
                @UniqueConstraint(columnNames = "STOCK_NAME"),
                @UniqueConstraint(columnNames = "STOCK_CODE")
        }
)
@Entity
public class StockEntity implements Serializable{
    private int stockId;
    private String stockCode;
    private String stockName;

    //---constructors
    public StockEntity() {
    }

    public StockEntity(String stockCode, String stockName) {
        this.stockCode = stockCode;
        this.stockName = stockName;
    }

    //---getters and setters
    @javax.persistence.Column(name = "STOCK_ID", unique = true, nullable = false, insertable = true, updatable = true, length = 10, precision = 0)
    @Id
    @GeneratedValue(strategy = IDENTITY)
    public int getStockId() {
        return stockId;
    }

    public void setStockId(int stockId) {
        this.stockId = stockId;
    }

    @javax.persistence.Column(name = "STOCK_CODE", unique = true, nullable = false, insertable = true, updatable = true, length = 10, precision = 0)
    @Basic
    public String getStockCode() {
        return stockCode;
    }

    public void setStockCode(String stockCode) {
        this.stockCode = stockCode;
    }

    @javax.persistence.Column(name = "STOCK_NAME", unique = true, nullable = false, insertable = true, updatable = true, length = 20, precision = 0)
    @Basic
    public String getStockName() {
        return stockName;
    }

    public void setStockName(String stockName) {
        this.stockName = stockName;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;

        StockEntity that = (StockEntity) o;

        if (stockId != that.stockId) return false;
        if (stockCode != null ? !stockCode.equals(that.stockCode) : that.stockCode != null) return false;
        if (stockName != null ? !stockName.equals(that.stockName) : that.stockName != null) return false;

        return true;
    }

    @Override
    public int hashCode() {
        int result = stockId;
        result = 31 * result + (stockCode != null ? stockCode.hashCode() : 0);
        result = 31 * result + (stockName != null ? stockName.hashCode() : 0);
        return result;
    }

    @Override
    public String toString()
    {
        return "Stock [stockCode=" + stockCode + ", stockId=" + stockId + ", stockName=" + stockName + "]";
    }
} 
```

资源/hibernate.cfg.xml：

```
<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE hibernate-configuration PUBLIC
        "-//Hibernate/Hibernate Configuration DTD//EN"
        "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
    <session-factory>
        <property name="connection.url">jdbc:mysql://localhost:3306/mkyong</property>
        <property name="connection.driver_class">com.mysql.jdbc.Driver</property>
        <property name="connection.username">root</property>
        <property name="connection.password">mypassword</property>

        <property name="hibernate.current_session_context_class">thread</property>

        <!-- DB schema will be updated if needed -->
        <property name="hbm2ddl.auto">create</property>

        <!-- SQL dialect -->
        <property name="dialect">org.hibernate.dialect.MySQLDialect</property>

        <mapping class="com.mkyong.stock.model.StockEntity"/>
        <mapping resource="mapping.xml"/>
    </session-factory>
</hibernate-configuration> 
```

资源/spring-config.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context" xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/cache http://www.springframework.org/schema/cache/spring-cache.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd">

    <bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
        <property name="configLocation" value="hibernate.cfg.xml"/>
    </bean>

    <bean id="transactionManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory"/>
    </bean>

    <context:annotation-config />
    <context:component-scan base-package="foo.bar, com.mkyong.stock"/>

    <tx:annotation-driven transaction-manager="transactionManager"/>

</beans> 
```

这是我得到的错误堆栈跟踪：

```
Exception in thread "main" org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionManager' defined in class path resource [spring-config.xml]: Invocation of init method failed; nested exception is org.hibernate.service.UnknownUnwrapTypeException: Cannot unwrap to requested type [javax.sql.DataSource]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1486)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:524)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:461)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:295)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:223)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:292)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:607)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:932)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:479)
    at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:139)
    at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:83)
    at foo.bar.HelloApp.main(HelloApp.java:10)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120)
Caused by: org.hibernate.service.UnknownUnwrapTypeException: Cannot unwrap to requested type [javax.sql.DataSource]
    at org.hibernate.service.jdbc.connections.internal.DriverManagerConnectionProviderImpl.unwrap(DriverManagerConnectionProviderImpl.java:85)
    at org.springframework.orm.hibernate4.SessionFactoryUtils.getDataSource(SessionFactoryUtils.java:91)
    at org.springframework.orm.hibernate4.HibernateTransactionManager.afterPropertiesSet(HibernateTransactionManager.java:252)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1545)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1483)
    ... 17 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T06:42:25.253

乍一看，对我来说最突出的是您设置的属性。据我所知，Hibernate 期望找到您在 hibernate 属性中指定的连接属性。（参见[http://docs.huihoo.com/hibernate/hibernate-reference-2.1.7/session-configuration.html](http://docs.huihoo.com/hibernate/hibernate-reference-2.1.7/session-configuration.html)的以下内容）

```
 Hibernate will obtain (and pool) connections using java.sql.DriverManager if you set the following properties:

Table 3.1\. Hibernate JDBC Properties
Property name   Purpose
hibernate.connection.driver_class   jdbc driver class
hibernate.connection.url    jdbc URL
hibernate.connection.username   database user
hibernate.connection.password   database user password
hibernate.connection.pool_size  maximum number of pooled connections 
```

在您的情况下，这意味着替换：

```
 <property name="connection.url">jdbc:mysql://localhost:3306/mkyong</property>
        <property name="connection.driver_class">com.mysql.jdbc.Driver</property>
        <property name="connection.username">root</property>
        <property name="connection.password">mypassword</property> 
```

使用（这是它在 mykong 上的显示方式）：

```
 <property name="hibernate.connection.url">jdbc:mysql://localhost:3306/mkyong</property>
        <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
        <property name="hibernate.connection.username">root</property>
        <property name="hibernate.connection.password">mypassword</property> 
```

另一种可能的方法是指定一个 JDBC DataSource 并将其注入到 SessionFactory 中，例如：

```
 <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="com.microsoft.sqlserver.jdbc.SQLServerDriver" />
        <property name="url" value="jdbc:sqlserver://<Host>:<Port>;databaseName=<DBName>;" />
        <property name="username" value=<username> />
        <property name="password" value=<password> />
   </bean>

<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
...... 
```

# vb.net - 重用连接字符串

> ID：16179468
> 
> 赞同：-1
> 
> 时间：2013-04-23T21:26:45.020
> 
> 标签：vb.net, design-patterns

请看下面的代码：

```
Namespace DataAccessGateway
    Public Class clsAudit
        Implements IAudit

        Private _ConString As String
        Private _Provider As String

        Public Sub New()
            _ConString = ConfigurationManager.ConnectionStrings("dbConnection").ConnectionString
            _Provider = ConfigurationManager.ConnectionStrings("dbConnection").ProviderName
        End Sub

        Public Function AddAudit(ByVal tyDeletion As typeDeletion) As Integer Implements IAudit.AddAudit
            Dim intCount As Integer
            Dim objParameterValues As New clsParameterValues
            Dim iConnectionBLL As iConnectionBLL
            Dim tyInnkeeperPremises As New typeInnkeeperPremises
            Dim objCon As DbConnection
            Try
                Dim paramValues() As DbParameter
                objParameterValues = New clsParameterValues
                iConnectionBLL = New clsConnectionBLL()
                objCon = iConnectionBLL.getDatabaseTypeByDescription("AUDIT")
                Using objCon
                    Dim strSQL As String
                    strSQL = "INSERT INTO dbAudit (Reference) VALUES (@Reference)"
                    objParameterValues.AssignParameterValues("@Reference", tyDeletion.Reference, 1)
                    paramValues = objParameterValues.getParameterValues
                    intCount = clsDatabaseHelper.ExecuteNonQuery(objCon, CommandType.Text, strSQL, paramValues)
                End Using
                Return intCount
            Catch ex As Exception
                Return -1
            End Try
        End Function
    End Class
End Namespace 
```

该代码被称为批处理作业的一部分，即它可以在一天内一次被调用一千万次。审计数据库的连接字符串存储在加密的数据库表中，即 tbl_database（getDatabaseTypeByDescription 查询该表）。因此，数据库必须查询一千万次才能获得相同的连接字符串一千万次。将连接字符串放在静态变量中是不好的做法还是有更好的方法？

我意识到将连接字符串放在配置文件中会更好，但我希望保持一致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:33:26.507

虽然这个答案不是非常特定于 .NET，但我实际上会推荐[The Twelve-Factor App](http://www.12factor.net/)中提到的方法，下面摘自[config](http://www.12factor.net/config)部分。

> **在环境中存储配置**
> 
> 十二因素应用程序将配置存储在环境变量中（通常缩写为 env vars 或 env）。环境变量很容易在部署之间更改，而无需更改任何代码；与配置文件不同，它们被意外签入代码仓库的可能性很小；与自定义配置文件或其他配置机制不同...

该文档更多地针对*应用程序*，但我认为类似的方法在这里会很好用。您可以调用数据库以获取连接字符串一次，然后将其存储在您的进程或应用程序域环境中。在测试方面，这也将为您提供相当好的灵活性。

# javascript - 创建 Facebook 好友选择器时出错

> ID：16179471
> 
> 赞同：0
> 
> 时间：2013-04-23T21:26:47.433
> 
> 标签：javascript, jquery, facebook, facebook-javascript-sdk

我使用[教程](https://github.com/mbrevoort/jquery-facebook-multi-friend-selector/blob/master/index.html)来创建 facebook 多朋友选择器。它不起作用并出现以下错误

```
fb.login() called when user is already connected 
```

我知道我应该打电话`FB.logout`，但是默认情况下何时启用弹出阻止程序？或者我应该使用`FB.getLoginStatus`方法来查找用户是否登录。但是如果这些方法说没有授权，那么我不能调用 login() 方法。它将被弹出窗口阻止程序阻止。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T10:17:57.907

您可以根据需要处理登录功能，只需在正确的位置调用此库即可。

为了让事情更简单，请从[这里](https://github.com/mbrevoort/jquery-facebook-multi-friend-selector)下载源代码，它可以工作！

# asp.net - 路径更短时的 System.IO.PathTooLongException

> ID：16179472
> 
> 赞同：0
> 
> 时间：2013-04-23T21:26:50.387
> 
> 标签：asp.net

我已经看到这个话题被打死了，但就我而言，.Net 框架似乎很困惑。我明白了，`System.IO.PathTooLongException`但路径长 151 个字符。我正在使用 UNC 格式，共享文件夹的完全限定域名从根目录向下 8 级。最后一个文件夹中有空格，我想这不会影响事情，但我不确定。

我正在使用 4.0 框架，服务器在域上，用户正在尝试使用 HTML 输入文件类型控件导航到某个位置。我正在使用至少对远程共享具有读取权限的域帐户进行模拟。

我还想指出，在我的开发环境 VS2010 中它工作正常 - 只有当我发布它以使用受限制的公司安全策略进行测试时才会发生。

如果路径远低于“太长”限制，有谁知道为什么会出现此错误？

# java - 缺少 J2ME SMS MIDlet 的发件人类

> ID：16179481
> 
> 赞同：1
> 
> 时间：2013-04-23T21:27:42.937
> 
> 标签：java, java-me

这是我第一次使用其中一个，我试图弄清楚为什么在使用发送者类声明发送者时，我从无线工具包中收到一个错误，告诉我它不起作用。有谁知道我做错了什么？如果它看起来很熟悉，它与 Apress 开始 J2ME 第 3 版教科书中的示例代码相同。

```
private Sender mSender = null;
mSender = Sender.getInstance(); 
```

# r - 如何从随机时间观察中生成规则的 xts 周期？

> ID：16179482
> 
> 赞同：6
> 
> 时间：2013-04-23T21:27:43.817
> 
> 标签：r, xts

我有以下 xts 矩阵：

```
> options(digits.secs = 6)
> set.seed(1234)
> xts(1:10, as.POSIXlt(1366039619, tz="EST", origin="1970-01-01") + rnorm(10, 500000, 250000)/1000000)
                           [,1]
2013-04-15 10:26:58.913576    4
2013-04-15 10:26:59.198234    1
2013-04-15 10:26:59.277491   10
2013-04-15 10:26:59.356315    7
2013-04-15 10:26:59.358887    9
2013-04-15 10:26:59.363342    8
2013-04-15 10:26:59.569357    2
2013-04-15 10:26:59.607281    5
2013-04-15 10:26:59.626514    6
2013-04-15 10:26:59.771110    3
Warning message:
timezone of object (EST) is different than current timezone (). 
```

我需要每 100 毫秒生成一次时间序列条目，其中包含该期间的最后一个值。例如：

```
 [,1]
2013-04-15 10:26:58.000000    4
2013-04-15 10:26:59.100000    4
2013-04-15 10:26:59.200000    1
2013-04-15 10:26:59.300000    10
2013-04-15 10:26:59.400000    8
... 
```

请注意最后一个条目如何携带 8，即 0.300000 到 .399999 期间的最后一个条目。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T22:01:36.120

我不确定这是否适用于 Windows，因为对亚秒精度的支持很差，但这适用于 Ubuntu。

```
library(xts)
options(digits.secs=6)
set.seed(1234)
x <-  xts(1:10, as.POSIXlt(1366039619, tz="EST", origin="1970-01-01")
  + rnorm(10, 500000, 250000)/1000000)
ti <- trunc(index(x))
ms <- rep(seq(min(ti),max(ti),by="s"), each=10)+0:9/10
a <- merge(x,ms,fill=na.locf)[ms] 
```

您会注意到，您处理此问题的方式与您需要从不规则数据创建规则 xts 系列的任何其他实例相同。不过这有点困难，因为生成亚秒级序列更困难。

# arm - 使用 fakeroot/fakechroot 的 ARM Linux rootfs 网络无法正常工作

> ID：16179485
> 
> 赞同：1
> 
> 时间：2013-04-23T21:27:56.480
> 
> 标签：arm, chroot, buildroot, crosstool-ng

我使用*buildroot创建了一个**rootfs*，但使用了带有*glibc的**crosstool-ng*工具链。这向我展示了所需的最少文件集。然后，我将所有库替换为直接从**.deb**压缩包中提取的库。然后我添加和混合（也来自**.deb**包）。我还根据自己的喜好修改了、和文件。将其上传到我的设备后，很多工作都在进行。 带我到正确的地方。 返回根。但是，任何与 DNS 相关的东西都不起作用。例如返回*错误地址*。我已经复制了*****`armel``fakeroot``fakechroot`**`resolv.conf``hosts``nsswitch.conf``cd /``whoami``ping google.com`***libnss_***和**libresolv**库以及我认为必要的所有其他内容。输入相同的设置，但在我的主机上使用*qemu*和*chroot*有效，但我试图找出它在我的目标设备上不起作用的原因。********

 ******当我运行时，`strace ping google.com`我得到以下信息：

```
open("/data/local/target/bin/ping", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\2\0(\0\1\0\0\0\0\314\0\0004\0\0\0"..., 4094) = 4094
close(3)                                = 0
execve("/data/local/target/bin/ping", ["ping", "google.com"], [/* 20 vars */]) = 0
brk(0)                                  = 0xb5000
uname({sys="Linux", node="localhost", ...}) = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
mmap2(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x4001d000
open("/data/local/target/usr/lib/fakechroot/libfakechroot.so", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0(\0\1\0\0\0\364\32\0\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0666, st_size=45540, ...}) = 0
mmap2(NULL, 77628, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x40026000
mprotect(0x40031000, 28672, PROT_NONE)  = 0
mmap2(0x40038000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0xa) = 0x40038000
close(3)                                = 0
open("/data/local/target/usr/lib/libfakeroot/libfakeroot-sysv.so", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0(\0\1\0\0\0\340'\0\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0666, st_size=29092, ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x4001f000
mmap2(NULL, 60672, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x40039000
mprotect(0x40040000, 28672, PROT_NONE)  = 0
mmap2(0x40047000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x6) = 0x40047000
close(3)                                = 0
access("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
open("tls/v7l/neon/vfp/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
...
open("/data/local/target/lib/libc.so.6", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0(\0\1\0\0\0\374V\1\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0777, st_size=1209660, ...}) = 0
mmap2(NULL, 1246468, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x40048000
mprotect(0x4016b000, 32768, PROT_NONE)  = 0
mmap2(0x40173000, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x123) = 0x40173000
mmap2(0x40176000, 9476, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x40176000
close(3)                                = 0
open("tls/v7l/neon/vfp/libdl.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
...
open("/data/local/target/lib/libdl.so.2", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0(\0\1\0\0\0$\t\0\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0777, st_size=9808, ...}) = 0
mmap2(NULL, 41136, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x40179000
mprotect(0x4017b000, 28672, PROT_NONE)  = 0
mmap2(0x40182000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1) = 0x40182000
close(3)                                = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x40020000
set_tls(0x40020170, 0x40020847, 0x40020848, 0x40020170, 0x40025000) = 0
mprotect(0x40182000, 4096, PROT_READ)   = 0
mprotect(0x40173000, 8192, PROT_READ)   = 0
mprotect(0xb1000, 4096, PROT_READ)      = 0
mprotect(0x40024000, 4096, PROT_READ)   = 0
brk(0)                                  = 0xb5000
brk(0xd6000)                            = 0xd6000
socket(PF_FILE, SOCK_STREAM|SOCK_CLOEXEC|SOCK_NONBLOCK, 0) = 3
connect(3, {sa_family=AF_FILE, path="/var/run/nscd/socket"}, 110) = -1 ENOENT (No such file or directory)
close(3)                                = 0
socket(PF_FILE, SOCK_STREAM|SOCK_CLOEXEC|SOCK_NONBLOCK, 0) = 3
connect(3, {sa_family=AF_FILE, path="/var/run/nscd/socket"}, 110) = -1 ENOENT (No such file or directory)
close(3)                                = 0
open("/etc/nsswitch.conf", O_RDONLY)    = -1 ENOENT (No such file or directory)
open("tls/v7l/neon/vfp/libnss_compat.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
...
open("/data/local/target/lib/libnss_compat.so.2", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0(\0\1\0\0\0|\r\0\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0777, st_size=26480, ...}) = 0
mmap2(NULL, 57952, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x40184000
mprotect(0x4018a000, 28672, PROT_NONE)  = 0
mmap2(0x40191000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x5) = 0x40191000
close(3)                                = 0
open("tls/v7l/neon/vfp/libnsl.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
...
open("/data/local/target/lib/libnsl.so.1", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0(\0\1\0\0\0x/\0\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0777, st_size=75732, ...}) = 0
mmap2(NULL, 116488, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x40193000
mprotect(0x401a5000, 28672, PROT_NONE)  = 0
mmap2(0x401ac000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x11) = 0x401ac000
mmap2(0x401ae000, 5896, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x401ae000
close(3)                                = 0
mprotect(0x401ac000, 4096, PROT_READ)   = 0
mprotect(0x40191000, 4096, PROT_READ)   = 0
open("/etc/nsswitch.conf", O_RDONLY)    = -1 ENOENT (No such file or directory)
open("tls/v7l/neon/vfp/libnss_nis.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
...
open("/data/local/target/usr/lib/libnss_nis.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/data/local/target/lib/libnss_nis.so.2", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0(\0\1\0\0\0X\30\0\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0777, st_size=38608, ...}) = 0
mmap2(NULL, 70236, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x401b0000
mprotect(0x401b9000, 28672, PROT_NONE)  = 0
mmap2(0x401c0000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x8) = 0x401c0000
close(3)                                = 0
open("tls/v7l/neon/vfp/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
...
open("/data/local/target/lib/libnss_files.so.2", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0(\0\1\0\0\0\330\31\0\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0777, st_size=42688, ...}) = 0
mmap2(NULL, 74492, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x401c2000
mprotect(0x401cc000, 28672, PROT_NONE)  = 0
mmap2(0x401d3000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x9) = 0x401d3000
close(3)                                = 0
mprotect(0x401d3000, 4096, PROT_READ)   = 0
mprotect(0x401c0000, 4096, PROT_READ)   = 0
open("/data/local/target/etc/passwd", O_RDONLY|O_CLOEXEC) = 3
fcntl64(3, F_GETFD)                     = 0x1 (flags FD_CLOEXEC)
_llseek(3, 0, [0], SEEK_CUR)            = 0
fstat64(3, {st_mode=S_IFREG|0666, st_size=596, ...}) = 0
mmap2(NULL, 596, PROT_READ, MAP_SHARED, 3, 0) = 0x40021000
_llseek(3, 596, [596], SEEK_SET)        = 0
munmap(0x40021000, 596)                 = 0
close(3)                                = 0
getpid()                                = 9034
socket(PF_NETLINK, SOCK_RAW, 0)         = 3
bind(3, {sa_family=AF_NETLINK, pid=0, groups=00000000}, 12) = 0
getsockname(3, {sa_family=AF_NETLINK, pid=9034, groups=00000000}, [12]) = 0
gettimeofday({1366748508, 414909}, NULL) = 0
sendto(3, "\24\0\0\0\26\0\1\3\\\355vQ\0\0\0\0\0\0\0\0", 20, 0, {sa_family=AF_NETLINK,     pid=0, groups=00000000}, 12) = 20
recvmsg(3, {msg_name(12)={sa_family=AF_NETLINK, pid=0, groups=00000000}, msg_iov(1)=[{"0\0\0\0\24\0\2\0\\\355vQJ#\0\0\2\10\200\376\1\0\0\0\10\0\1\0\177\0\0\1"..., 4096}], msg_controllen=0, msg_flags=0}, 0) = 108
recvmsg(3, {msg_name(12)={sa_family=AF_NETLINK, pid=0, groups=00000000}, msg_iov(1)=[{"@\0\0\0\24\0\2\0\\\355vQJ#\0\0\n\200\200\376\1\0\0\0\24\0\1\0\0\0\0\0"..., 4096}], msg_controllen=0, msg_flags=0}, 0) = 128
recvmsg(3, {msg_name(12)={sa_family=AF_NETLINK, pid=0, groups=00000000}, msg_iov(1)=[{"\24\0\0\0\3\0\2\0\\\355vQJ#\0\0\0\0\0\0\1\0\0\0\24\0\1\0\0\0\0\0"..., 4096}], msg_controllen=0, msg_flags=0}, 0) = 20
close(3)                                = 0
open("/etc/resolv.conf", O_RDONLY)      = -1 ENOENT (No such file or directory)
uname({sys="Linux", node="localhost", ...}) = 0
socket(PF_FILE, SOCK_STREAM|SOCK_CLOEXEC|SOCK_NONBLOCK, 0) = 3
connect(3, {sa_family=AF_FILE, path="/var/run/nscd/socket"}, 110) = -1 ENOENT (No such file or directory)
close(3)                                = 0
socket(PF_FILE, SOCK_STREAM|SOCK_CLOEXEC|SOCK_NONBLOCK, 0) = 3
connect(3, {sa_family=AF_FILE, path="/var/run/nscd/socket"}, 110) = -1 ENOENT (No such file or directory)
close(3)                                = 0
open("/etc/nsswitch.conf", O_RDONLY)    = -1 ENOENT (No such file or directory)
open("tls/v7l/neon/vfp/libnss_dns.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
...
open("/data/local/target/lib/libnss_dns.so.2", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0(\0\1\0\0\0000\v\0\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0777, st_size=18040, ...}) = 0
mmap2(NULL, 49316, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x401d5000
mprotect(0x401d9000, 28672, PROT_NONE)  = 0
mmap2(0x401e0000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x3) = 0x401e0000
close(3)                                = 0
open("tls/v7l/neon/vfp/libresolv.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
...
open("/data/local/target/lib/libresolv.so.2", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0(\0\1\0\0\0H$\0\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0777, st_size=71524, ...}) = 0
mmap2(NULL, 79772, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x401e2000
mmap2(0x401f2000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x10) = 0x401f2000
mmap2(0x401f4000, 6044, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x401f4000
close(3)                                = 0
mprotect(0x401f2000, 4096, PROT_READ)   = 0
mprotect(0x401e0000, 4096, PROT_READ)   = 0
open("/etc/host.conf", O_RDONLY)        = -1 ENOENT (No such file or directory)
stat64("/etc/resolv.conf", 0xbed0eee8)  = -1 ENOENT (No such file or directory)
gettimeofday({1366748508, 437074}, NULL) = 0
socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 3
connect(3, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr("127.0.0.1")}, 16) = 0
gettimeofday({1366748508, 438028}, NULL) = 0
poll([{fd=3, events=POLLOUT}], 1, 0)    = 1 ([{fd=3, revents=POLLOUT}])
send(3, "\234\32\1\0\0\1\0\0\0\0\0\0\6google\3com\0\0\1\0\1", 28, MSG_NOSIGNAL) = 28
poll([{fd=3, events=POLLIN}], 1, 5000)  = 1 ([{fd=3, revents=POLLERR}])
close(3)                                = 0
socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 3
connect(3, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr("127.0.0.1")}, 16) = 0
gettimeofday({1366748508, 440124}, NULL) = 0
poll([{fd=3, events=POLLOUT}], 1, 0)    = 1 ([{fd=3, revents=POLLOUT}])
send(3, "\234\32\1\0\0\1\0\0\0\0\0\0\6google\3com\0\0\1\0\1", 28, MSG_NOSIGNAL) = 28
poll([{fd=3, events=POLLIN}], 1, 5000)  = 1 ([{fd=3, revents=POLLERR}])
close(3)                                = 0
gettimeofday({1366748508, 441638}, NULL) = 0
socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 3
connect(3, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr("127.0.0.1")}, 16) = 0
gettimeofday({1366748508, 442345}, NULL) = 0
poll([{fd=3, events=POLLOUT}], 1, 0)    = 1 ([{fd=3, revents=POLLOUT}])
send(3, "\302\373\1\0\0\1\0\0\0\0\0\0\6google\3com\0\0\1\0\1", 28, MSG_NOSIGNAL) = 28
poll([{fd=3, events=POLLIN}], 1, 5000)  = 1 ([{fd=3, revents=POLLERR}])
close(3)                                = 0
socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 3
connect(3, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr("127.0.0.1")}, 16) = 0
gettimeofday({1366748508, 444280}, NULL) = 0
poll([{fd=3, events=POLLOUT}], 1, 0)    = 1 ([{fd=3, revents=POLLOUT}])
send(3, "\302\373\1\0\0\1\0\0\0\0\0\0\6google\3com\0\0\1\0\1", 28, MSG_NOSIGNAL) = 28
poll([{fd=3, events=POLLIN}], 1, 5000)  = 1 ([{fd=3, revents=POLLERR}])
close(3)                                = 0
open("/data/local/target/etc/hosts", O_RDONLY|O_CLOEXEC) = 3
fcntl64(3, F_GETFD)                     = 0x1 (flags FD_CLOEXEC)
fstat64(3, {st_mode=S_IFREG|0666, st_size=40, ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x40021000
read(3, "127.0.0.1\tlocalhost\n127.0.1.1\tbu"..., 4096) = 40
read(3, "", 4096)                       = 0
close(3)                                = 0
munmap(0x40021000, 4096)                = 0
write(2, "ping: bad address 'google.com'\n", 31) = 31
exit_group(1)                           = ? 
```

很多事情进展顺利。它知道在搜索可执行文件和库时将*/data/local/target添加到路径中。*您可以看到它找到了各种**libnss_***库，并且发现主机文件不只是 at `/etc/hosts`，但是为什么您认为它没有在正确的位置查找`nsswitch.conf`and `resolv.conf`？这似乎是`fakechroot`我如何使用它的问题或问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T16:53:19.800

看起来在其他库/可执行文件中使用 fopen 可以通过使用指向 libfakechroot 的 LD_PRELOAD 来拦截，但不能从 eglibc 本身调用 fopen。您将不得不手动编辑 eglibc 源并构建它。看起来他们做得很好，使这变得容易。

这已经过测试并且有效。******

# html5-video - 视频播放时动态切换轨道 (vtt) 文件

> ID：16179487
> 
> 赞同：0
> 
> 时间：2013-04-23T21:28:06.267
> 
> 标签：html5-video, video.js, captions, vtt

我正在使用 VideoJS 加载带字幕的视频。我希望 api 中有一种方法可以动态地从一个 .vtt 字幕文件切换到另一个。我有一个带有英语和其他语言字幕的视频。在播放视频时，访问者需要在其中一个之间切换。

寻找类似的东西：

```
_V_.Track.src="blah.vtt"; 
```

我想另一种方法是获取视频的时间位置并用另一个 vtt 重新加载它。

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T17:19:34.430

我希望用字幕轨道做类似的事情......但也无法找到一种干净的方式来完成这项任务。

我能做的最好的事情是这样的：

```
document.getElementById("HtmlFiveMediaPlayer_html5_api").innerHTML = '<track label="English Captions" srclang="en" kind="captions" src="http://localhost/media/captiontest/demo_Brian/demo_h264_1.vtt" type="text/vtt" default />'; 
```

我将 HTML 直接插入到视频标签中......但这不适用于 video-js 中的 CC 按钮（如果在加载标签时轨道不存在，则根本不会添加/创建）。

# sql-server - 选择两个日期之间的所有月份并重复每年的结果

> ID：16179491
> 
> 赞同：0
> 
> 时间：2013-04-23T21:28:20.717
> 
> 标签：sql-server, sql-server-2012, common-table-expression

我需要生成 2 个日期之间的月份列表，然后重复我在**SQL Server 2012**中拥有的每一年的结果。

这是一个例子：

*   开始日期 = 2010-11-01
*   结束日期 = 2011-01-01
*   参考年 = 2008

我想要的结果：

```
StatDate     StatYearGroup
--------------------------
2007-11-01            2008
2007-12-01            2008
2008-01-01            2008
2008-11-01            2009
2008-12-01            2009
2009-01-01            2009
2009-11-01            2010
2009-12-01            2010
2010-01-01            2010
2010-11-01            2011
2010-12-01            2011
2011-01-01            2011 
```

我可以使用该查询生成两个日期之间的月份列表，但是我如何在@endDate 和我的@referenceYear 之间重复每年的结果？还有如何获得 StatYearGroup 值？

```
declare @startDate date = '2010-11-01';
declare @endDate date = '2011-01-01';
declare @referenceYear int = 2008;

with dateRange(StatDate) as 
(
    select @startDate
    union all
    select dateadd(month, 1, StatDate)
    from dateRange 
    where StatDate < @endDate
)
select StatDate
from dateRange 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T06:38:36.773

试试这个——

```
DECLARE 
      @startDate DATE = '2010-11-01'
    , @endDate DATE = '2011-01-01'
    , @referenceYear INT = 2008

;WITH rng AS 
(
    SELECT StatDate = @startDate, StatYearGroup = YEAR(@endDate)

    UNION ALL

    SELECT DATEADD(MONTH, 1, StatDate), StatYearGroup
    FROM rng 
    WHERE StatDate < @endDate
), years AS 
(
    SELECT StatDate, StatYearGroup
    FROM rng 

    UNION ALL

    SELECT DATEADD(MONTH, -12, StatDate), StatYearGroup - 1
    FROM years 
    WHERE StatYearGroup > @referenceYear
)
SELECT *
FROM years
ORDER BY StatDate, StatYearGroup 
```

# amazon-web-services - 来自 Secure Token Service 的 Amazon AWS 请求令牌

> ID：16179494
> 
> 赞同：1
> 
> 时间：2013-04-23T21:28:34.173
> 
> 标签：amazon-web-services, amazon-s3, access-token, signature

我正在尝试签署亚马逊 sts 令牌请求以临时访问我的 S3 帐户。我一直在按照 Signature Version 4 的说明进行操作，但没有成功。

我不断从亚马逊 sts 收到这条消息。

`<Code>IncompleteSignature</Code>`

`<Message>Request must contain a signature that conforms to AWS standards</Message>`

这是我发送的 url 请求。

```
https://sts.amazonaws.com/?AWSAccessKeyId=**********&Action=GetFederationToken&DurationSeconds=3600&SignatureMethod=HmacSHA256&SignatureVersion=4&Timestamp=2013-04-23T19:01:00Z&Version=2011-06-15&Signature=2fc3dc902a20a5aa25c3191f2aa6513088e11596082b6a563b00dc5ea4b8bfa0 
```

按照 Signature Version 4 的步骤，这就是我计算签名的方式。

[http://docs.aws.amazon.com/general/latest/gr/sigv4_signing.html](http://docs.aws.amazon.com/general/latest/gr/sigv4_signing.html)

任务1：

```
GET\n
/\n
AWSAccessKeyId=<Access Key Removed>&
Action=GetFederationToken&
DurationSeconds=3600&
SignatureMethod=HmacSHA256&
SignatureVersion=4&
Timestamp=2013-04-23T19:01:00Z&
Version=2011-06-15\n
host:sts.amazonaws.com\n
host\n
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 
```

任务 2：

```
AWS4-HMAC-SHA256\n
20130423T190100Z\n
20130423/us-gov-west-1/sts/aws4_request\n
5e769aeb49a050fd7cd1035122712098fd83220ea42a0d9871f0ff2fa622b1c6 
```

任务 3：

```
Signature: 2fc3dc902a20a5aa25c3191f2aa6513088e11596082b6a563b00dc5ea4b8bfa0 
```

任何帮助将不胜感激，到目前为止，我一直在努力解决这个问题。提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T18:52:50.757

只是在这里做个笔记，我终于能够通过改变我的请求来获得一个令牌。以防万一这将帮助遇到同样问题的其他人。我无法在文档中找到太多帮助，但通过不断修改我的请求，我终于能够从服务器获得有用的错误消息。最重要的消息是最后一条，它准确地为您提供了请求签名和要签名的字符串。

这特别适用于从 Amazon Secure Token Service 检索联合令牌。

```
The request signature we calculated does not match the signature you provided. Check your AWS Secret Access Key and signing method. Consult the service documentation for details.

The Canonical String for this request should have been
'GET
/
Action=GetFederationToken&Version=2011-06-15&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAXXXXXXXXXWIQ%2F20130424%2Fus-east-1%2Fsts%2Faws4_request&X-Amz-Date=20130424T183200Z&X-Amz-SignedHeaders=host%3Bx-amz-date
host:sts.amazonaws.com
x-amz-date:

host;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855'

The String-to-Sign should have been
'AWS4-HMAC-SHA256
20130424T183200Z
20130424/us-east-1/sts/aws4_request
3eb22aba7f25dd4e01be888added6f74db579bdf0d066d2b1f75779a25b1300d' 
```

这是使用的 URL。

`https://sts.amazonaws.com/?Action=GetFederationToken&Name=Megan&Version=2011-06-15&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIXXXXXXXXXXWIQ%2F20130424%2Fus-east-1%2Fsts%2Faws4_request&X-Amz-Date=20130424T183200Z&X-Amz-SignedHeaders=host%3Bx-amz-date&X-Amz-Signature=db754013466768c11a86a610796faad6a041bcad9d83f4c958cac82988d2f7d7`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T13:22:37.463

Amazon S3 当前不支持签名版本 4。有关当前支持的签名算法，请参阅 S3 文档：

[http://docs.aws.amazon.com/AmazonS3/latest/dev/RESTAuthentication.html](http://docs.aws.amazon.com/AmazonS3/latest/dev/RESTAuthentication.html)

编辑：很抱歉误读了您的初始请求。您对 STS 请求有许多不正确的假设，这些假设会导致您的签名计算出现问题：

1.  操作是 POST
2.  STS 唯一受支持的区域是 us-east-1。
3.  日期必须包含在标题中才能签名

虽然我知道您可能不想使用 SDK，但他们将提供有关如何生成签名的说明性示例。

下面是我从我们的 iOS SDK 中提取的一个示例。

规范要求：

```
POST\n
/\n
\n
host:sts.amazonaws.com\n
x-amz-date:20130424T164023Z\n
\n
host;x-amz-date\n
HASH_REMOVED\n 
```

要签名的字符串：

```
AWS4-HMAC-SHA256\n
20130424T164023Z\n
20130424/us-east-1/sts/aws4_request\n
HASH_REMOVED 
```

# python - 使用 Map Reduce 拆分文件

> ID：16179496
> 
> 赞同：0
> 
> 时间：2013-04-23T21:28:40.747
> 
> 标签：python, amazon-web-services, amazon-s3, boto, emr

我想使用 EMR 将文本文件的内容拆分为 2 个不同的文件。输入文件以及 mapper 和 reducer 脚本都存储在 AWS 的 S3 中。目前，我的映射器通过制表符分隔整个文件中的每个字段来重新格式化标准输入的输入。

```
import sys
import time

first_line = True

for line in sys.stdin:
    if first_line == True:
            first_line = False
            continue
    line= line.strip()
    data=line.split('|')
    d = data[0]
    for i in range(1,len(data)):
            d = d + '\t' +str(data[i])
    d = d+ '\n'
    print d 
```

我的减速器是魔法发生的地方。我希望减速器根据特定字段的值将此文本文件拆分为 2 个不同的文件。这是我当前的 reducer.py 代码

```
mobile_inquiries = open("reducer_output/mob_inq.txt", "a")
transactions = open("reducer_output/transactions.txt", "a")
mob_merchant_id='"99031479997"'
mob_response_code = '"0"'
mob_request_codes = ['"400"','"401"','"402"','"403"','"450"','"408"','"2400"','"2401"','"2402"','"2408"','"6400"','"6405"','"6450"']

for line in sys.stdin:          
    line= line.strip()
    data=line.split('\t')
    d = data[0]
    merchant_id = data[4]
    request_code = data[10]
    response_code = data[19]

# Writes to mobile inquiry file
    if (merchant_id == mob_merchant_id) and (response_code == mob_response_code) and (request_code in mob_request_codes):
        d = d + '\t' +str(data[9])+ '\t' + str(data[28])+'\n'               
        mobile_inquiries.write(d)
# Writes to transaction file
    else:
        d = d + '\t' +str(data[9])+ '\t' + str(data[6])+ '\t' + str(data[4])+ '\t' + str(data[26])+ '\t' + str(data[10])+ '\t' + str(data[19])+ '\t' + str(data[28])+ '\n'
        transactions.write(d)
mobile_inquiries.close()
transactions.close() 
```

此 EMR 作业失败并返回以下错误消息：由于步骤失败而关闭。我已经在每一行上使用 fileReaders 在本地测试了这两个脚本，并且它可以工作。将任务导入 EMR 会导致问题。我的问题是： - 是否可以使用 EMR 将文件拆分为 2 个或更多文件？- 如果是这样，S3 是否会阻止我动态创建新文件，从而导致 EMR 作业失败？- 还是我的代码行为错误？

我感谢任何和所有的反馈。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T19:43:28.027

您尝试执行此操作的方式行不通。即使作业成功 - 您也只是设法将文件写入 Hadoop 集群中每个节点上的本地文件系统。最有可能 - 一旦作业完成，这些文件将被丢弃。

奇怪的是，即使映射器发出一个 key\tvalue 结构，reducer 似乎也没有对给定键的值集合做任何事情。所以不清楚为什么还要费心按数据[0]分割地图输出？（也许我不明白上下文）

如果可能的话 - 这些将是更好的选择：

*   首先使用仅地图作业将输入数据拆分为两个数据集（mobile_inquiries 和 transactions）。如果您愿意使用 Hive - 您可以选择一个表并根据谓词插入两个目录（在 HDFS 或 S3 中）（就像 Python 代码中的那个）
*   现在输入已被拆分 - 在每个输出上运行一个 map-reduce 作业。这可以执行任何 map/reduce 功能。FWIW - 这里编码的 map-reduce 函数实际上并不需要 Python - 可以直接用标准 Hive SQL 表示。

# php - PHP文件上传超时

> ID：16179502
> 
> 赞同：0
> 
> 时间：2013-04-23T21:28:55.300
> 
> 标签：php, cakephp, file-upload

我创建了一个文件传输 webapp，使用 cakephp，如果上传速度很高，它可以正常工作。

然后为了测试，我使用 netlimiter 将上传速度限制为 50kBps 以上传 45MB 文件，并且不知何故在大约 6-8 分钟后它停止上传。似乎它会超时。我应该怎么做才能防止这种情况发生？

我的 php.ini 设置是：

```
max_execution_time = 3600 
max_input_time = 3600
memory_limit = 512M
post_max_size = 512M
upload_max_filesize = 512M 
```

我不确定是不是因为 php.ini 或其他原因，但如果我在高速互联网（5MBps 上传速度）上上传 9GB 文件（大约需要 15-20 分钟），它工作正常。就是网速慢，好像不太好用

# ios - 适用于 ios 平台的电子邮件应用程序示例

> ID：16179504
> 
> 赞同：0
> 
> 时间：2013-04-23T21:29:03.003
> 
> 标签：ios

我想为 ios 编写一个简单的电子邮件应用程序，它可以抓取我的电子邮件。经过调查，这似乎不是一件容易的事。我找到[了 remail](http://code.google.com/p/remail-iphone/)，但它看起来很棘手。是否有任何框架/库或开源项目可以帮助我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:47:30.200

你可以试试mailCore。自己没用过，但是听说过[mailCore的好东西](http://libmailcore.com)

# android - 适用于不同分辨率的 Android 可绘制图像

> ID：16179507
> 
> 赞同：0
> 
> 时间：2013-04-23T21:29:17.533
> 
> 标签：android, drawable

我记得在某处看到有某种方式或某种工具，您可以在其中给它一个图像，它会自动缩放并为不同的分辨率生成多个图像，但我似乎找不到它。有谁知道我在描述什么以及在哪里可以找到它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-28T11:37:34.000

找到了我要找的东西，Android Asset Studio。

[http://android-ui-utils.googlecode.com/hg/asset-studio/dist/icons-launcher.html](http://android-ui-utils.googlecode.com/hg/asset-studio/dist/icons-launcher.html)

# c - 转移一块malloc内存的最简单方法

> ID：16179508
> 
> 赞同：3
> 
> 时间：2013-04-23T21:29:18.333
> 
> 标签：c

我需要向下移动一块分配的内存。目前我正在创建一个临时内存，然后将其复制过来，然后他们通过班次将其重新复制回来

```
void * buf = malloc(5);
void * temp = malloc(5);

memcpy(temp, buf, 5); 
memset(buf, 0, 5);
memcpy(buf, temp + 1, 4); 
```

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-23T21:30:30.163

是的，使用`memmove`：

```
char * buf = malloc(5);   // pointer arithmetic only on chars!

memmove(buf, buf + 1, 4);
memset(buf + 4, 0, 1); 
```

# google-apps-script - 是否有如何将替换添加到 Google Docs 的示例

> ID：16179509
> 
> 赞同：1
> 
> 时间：2013-04-23T21:29:19.407
> 
> 标签：google-apps-script

是否有示例说明如何使用文档应用程序脚本 API 向 Google Docs 菜单添加按钮，当单击它时从我的网络应用程序中调出一个网页，提示用户输入 2 个字符串，然后点击确定对打开的文档进行搜索和替换吗？

我不需要添加搜索/替换本身。我只是认为这是编写用于编辑打开文档的 Google Docs 插件的最简单示例。

谢谢 - 戴夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:43:40.327

就目前而言，这是不可能的。我认为[这个问题](https://code.google.com/p/google-apps-script-issues/issues/detail?id=721&q=add%20menu%20docs&colspec=Stars%20Opened%20ID%20Type%20Status%20Summary%20Component%20Owner)（你可能想给它加星标以便你可以在线程中接收更新）最能描述它。帖子#7中的摘要：

> 此功能请求是为文档添加与电子表格中相同的脚本功能。即菜单项等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T22:55:52.710

谷歌最近的一段视频（见他们的博客）暗示这将很快推出。同时，您可以从已发布的脚本界面中请求文档 url。如果您制作 googledrive.com 客户端应用程序，您甚至可以使用新的 goglepicker 来选择文档。

# javascript - 将 2d SVG 路径拉伸或制作成 3d

> ID：16179510
> 
> 赞同：4
> 
> 时间：2013-04-23T21:29:32.690
> 
> 标签：javascript, svg, raphael

我想知道是否有人听说过一些 javascript，它可以采用一个简单的 SVG 路径，可能需要 30 秒才能在 illustrator 或其他东西中创建并将其转换为看起来 3d 的东西。illustrator 中有一个拉伸功能可以做到这一点。在 sketchUp 中也称为轮询。

我现在正在使用 Raphael.js，但我愿意接受其他建议。一个简单的解决方案是制作路径的副本并将其向下和向右移动几个像素，并在原始路径后面赋予它较暗的颜色，但我正在寻找可能有更多阴影的东西。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-25T07:22:25.513

总是有可能使用[three.js](http://threejs.org/)来在浏览器中挤出用于 webGL 的路径：

[http://alteredqualia.com/three/examples/webgl_text.html#D81F0A21010#23a](http://alteredqualia.com/three/examples/webgl_text.html#D81F0A21010#23a)

（更多示例：http: [//stemkoski.github.io/Three.js/](http://stemkoski.github.io/Three.js/)）

它使用 js-fonts 并解析它们上的路径命令，挤出路径并渲染场景。以同样的方式，应该可以采用 SVG 路径并将其拉伸。Raphael`Raphael.parsePathString()`将路径段作为单个段的数组提供给您。如果您首先使用`Raphael.path2curve()`和将路径命令转换为三次曲线`Raphael._pathToabsolute()`，则只有一种线段类型，因此您可以使用 three.js:s BEZIER_CURVE_TO 命令。如果您在路径上应用了转换（通常是 Illustrator 导出中的情况），您可以使用此处的函数将它们展平：[https](https://stackoverflow.com/a/13102801/1691517) ://stackoverflow.com/a/13102801/1691517 。

一个可能的起点是这里（单击答案的小提琴）： [Extruding multiple polygons with multiple hole and textured the combination shape](https://stackoverflow.com/questions/16124691/extruding-multiple-polygons-with-multiple-holes-and-texturing-the-combined-shape)

Three.js 支持的路径命令很少，但还没有全部测试过（ [http://threejsdoc.appspot.com/doc/three.js/src.source/extras/core/Path.js.html](http://threejsdoc.appspot.com/doc/three.js/src.source/extras/core/Path.js.html)，见下文）。

```
三.PathActions = {

    MOVE_TO: '移动到',
    LINE_TO: 'lineTo',
    QUADRATIC_CURVE_TO: 'quadraticCurveTo', // 贝塞尔二次曲线
    BEZIER_CURVE_TO: 'bezierCurveTo', // 贝塞尔三次曲线
    CSPLINE_THRU: 'splineThru', // Catmull-rom 样条
    ARC: 'arc' // 圆

};

```

我使用了一个自定义的相当复杂的函数来多边形化 SVG 路径，所以除了 moveto 和 lineto 之外，不需要依赖其他命令。

缺点当然是对 webGL 的支持水平相当低，31-53%：[http ://caniuse.com/webgl](http://caniuse.com/webgl)

* * *

如果质量较差和速度慢不是问题，其他更多跨浏览器解决方案是这个 SVG3d 库：

[http://debeissat.nicolas.free.fr/svg3d.php](http://debeissat.nicolas.free.fr/svg3d.php) [https://code.google.com/p/svg3d/](https://code.google.com/p/svg3d/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-25T13:19:37.867

我认为[此](http://css.dzone.com/articles/render-geographic-information)资源可能对您有所帮助，他使用 d3 生成 2D 可视化，然后使用[d3-threeD](https://github.com/asutherland/d3-threeD)进行挤压。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T09:05:12.473

听起来你想使用[svg 过滤器](http://www.w3.org/TR/SVG11/filters.html)。[Webplatform.org](http://webplatform.org)有一个很好的[教程](http://docs.webplatform.org/wiki/svg/tutorials/smarter_svg_filters)。向下滚动一点，您会发现一些看起来像 3d 的照明滤镜。

Raphaël 不支持过滤器，所以要么你需要扩展它，要么直接使用 svg。

# jquery - 在鼠标悬停上创建一个悬停动作，触发 div 内的元素

> ID：16179516
> 
> 赞同：0
> 
> 时间：2013-04-23T21:30:13.213
> 
> 标签：jquery

如果我有一组彼此相邻的 2 个 div：

```
 <div class="selector outdoor">
            <div class="bar">
              <a href="#" class="firstOne"><p>Outdoor</p></a>
            </div><!--end of "bar"-->
        </div><!--end of "selector outdoor"-->
        <div class="selector hunter">
            <div class="bar">
              <a href="#" class="firstOne"><p>Hunting</p></a>
            </div><!--end of "bar"-->
        </div><!--end of "selector hunter"-->
        <div class="selector military"> 
```

如果我想在鼠标悬停 .selector 时创建悬停动作，那只会触发 div 内的 .bar 我悬停在我的 jquery 会是什么样子？这就是我所拥有的。

```
$('.selector').hover(function ()  {
    TweenMax.to(this('.bar'), 1, {y:"-154px", ease:Power1.easeInOut});

});
$('.selector').mouseleave(function ()  {
    TweenMax.to(this('.bar'), 1, {y:"0", ease:Power1.easeInOut});
}); 
```

我知道我可以使用“this”来触发具有鼠标焦点的对象，但我不知道如何使用子选择器仅移动父 div 内部的一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:33:20.500

```
$(this).find('.bar') 
```

将仅选择`'.bar'`当前元素内的元素。

我不熟悉`TweenMax`，但我假设你最终会得到这样的代码：

```
$('.selector').hover(function ()  {
    TweenMax.to($(this).find('.bar'), 1, {y:"-154px", ease:Power1.easeInOut});
}); 
```

如果`TweenMax.to()`函数在第一个参数中需要 DOM 元素而不是 jQuery 对象，则使用`$(this).find('.bar').get(0)`.

还要注意`.hover()`和`mouseleave()`不是对立的。如果您提供一个函数，`.hover()`它将在*mouseenter*和 mouseleave 上执行。要在进入和离开时做一些不同的事情，请提供两个函数`.hover()`（并且根本不调用`mouseleave()`）：

```
$('.selector').hover(function ()  {
    TweenMax.to($(this).find('.bar'), 1, {y:"-154px", ease:Power1.easeInOut});
},function ()  {
    TweenMax.to($(this).find('.bar'), 1, {y:"0", ease:Power1.easeInOut});
}); 
```

或使用`.mouseenter()`and`.mouseleave()`但不是`.hover()`.

# asp.net-mvc-4 - 新的发布期间预编译选项对 MVC4 应用程序有什么影响？

> ID：16179519
> 
> 赞同：90
> 
> 时间：2013-04-23T21:30:19.590
> 
> 标签：asp.net-mvc-4, visual-studio-2012

所以我最近将 Visual Studio 2012 更新为更新 2。瞧，下次我去发布我的应用程序（在这种情况下是通过文件发布）时，我注意到有三个新选项：

1.  发布前删除所有现有文件
2.  发布期间预编译（带有指向配置的链接）
3.  从 App_Data 文件夹中排除文件

第一个和第三个选项是不言自明的，但是我找不到关于第二个选项的任何文档，因为它适用于 MVC。当我检查它时，网站上生成的文件似乎没有任何变化，而且我没有看到任何真正的性能变化。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2013-04-23T22:46:56.443

使用 ASP.NET 预编译器会对您的 MVC 应用程序产生以下影响：

*   如果您在 App_Code 中有任何内容，它将在部署之前预编译为 DLL。如果没有预编译，这将由 ASP.NET 运行时即时发生。
*   如果您选择*不*使您的页面可更新的选项（即取消选中高级设置对话框中的第一个复选框），它还将预编译您的视图（ASPX 和 Razor），而不是在运行时动态编译它们。“允许预编译站点可更新”的默认（选中）设置允许您更新视图内容，而无需重新构建整个项目。

如果您在 App_Code 中没有任何文件并且您希望您的网站保持可更新状态，那么它似乎没有多大作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-09-18T14:16:45.140

这是一个老问题，但我只是遇到类似的问题，觉得值得分享。

我的错误信息在这篇文章中是一样的。我的项目是 MVC5，使用 Visual Studio 2013 Professional 构建。 [编译错误：两个 DLL 中都存在“ASP.global_asax”类型](https://stackoverflow.com/questions/20852039/compilation-error-the-type-asp-global-asax-exists-in-both-dlls)

在我的情况下，使用预编译选项，bin 文件夹中有一个文件 App_global.asax.dll，并导致上述错误消息。首先，我删除服务器上的 App_global.asax.dll，重新启动应用程序池，问题就消失了。然后我尝试了另一种方法，取消选中预编译并重新发布，重新部署到服务器，问题就消失了。

# windows-phone-7 - WP7 和 WP8 项目中的字体不同

> ID：16179520
> 
> 赞同：2
> 
> 时间：2013-04-23T21:30:23.230
> 
> 标签：windows-phone-7, fonts, windows-phone-8, windows-phone-7.1

这是我遇到的一件很奇怪的事情。我已经开发 Windows Phone 应用程序一年多了，即使使用 WP8 开关，我也从未见过这种情况。

如果我使用我的 WP 7.1 应用程序并将其升级到 WP 8，字体会变得非常混乱，如下面的两个屏幕截图所示。（均取自我的 WP8 Lumia 620）

1.  WP 7.1 版本 -

![在此处输入图像描述](https://i.stack.imgur.com/8XSx2.png)

2.  WP 8 版本 -

![http://i105.photobucket.com/albums/m218/MegaNight2006/wp_ss_20130423_00021_zps1f419533.png](https://i.stack.imgur.com/qPeES.png)

确实很奇怪，使用的字体是来自[http://www.dafont.com/visitor.font的“visitor1 TT1 BRK”](http://www.dafont.com/visitor.font)

字体设置为 BlendEmbeddedFont 并在 XAML 中使用，如下所示：

```
FontFamily="/TronRadio;component/Fonts/Fonts.zip#Visitor TT1 BRK" 
```

是需要设置的 .NET 4.5 还是其他类型的问题？这是我第一次看到这个问题，我已经升级了嵌入字体的其他应用程序而没有遇到这个问题。

需要注意的是，该字体在 Design Workplace（Visual Studio 2012 和 Blend）中显示良好。但是在 Windows Phone 8 和模拟器上显示了上述问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T09:42:12.073

为什么不在 Expression Blend 中选择字体，然后为 Windows Phone 7 和 8 应用程序单独**嵌入它。**这可能会有所帮助。

# jquery - 通过 jQuery 加载 XML 时如何按特定元素排序？

> ID：16179522
> 
> 赞同：0
> 
> 时间：2013-04-23T21:30:27.080
> 
> 标签：jquery, xml

我有这样的代码来加载 XML 文件的内容：

```
$.ajax({
    type: "GET",
    url: "SITESETUP_000003.XML",
    dataType: "xml",
    success: function (siteSetupRedemptionsRec) {
        var sitesetup = "<table><thead><th>REDEMPTIONS Redemption ID</th><th>REDEMPTIONS Name</th><th>REDEMPTIONS Item Id</th><th>REDEMPTIONS Amount</th><th>REDEMPTIONS Department</th><th>REDEMPTIONS Subdepartment</th></thead>";
        $(siteSetupRedemptionsRec).find('Redemptions').each(function () {
            var redemptionId = $(this).find('RedemptionID').text();
            var name = $(this).find('Name').text();
            var itemId = $(this).find('ItemID').text();
            var amount = $(this).find('Amount').text();
            var dept = $(this).find('Department').text();
            var subDept = $(this).find('Subdepartment').text();
            sitesetup += "<tr>";
            sitesetup += "<td>" + redemptionId + "</td>";
            sitesetup += "<td>" + name + "</td>";
            sitesetup += "<td>" + itemId + "</td>";
            sitesetup += "<td>" + amount + "</td>";
            sitesetup += "<td>" + dept + "</td>";
            sitesetup += "<td>" + subDept + "</td>";
            sitesetup += "</tr>";
        });
        sitesetup += "</table>";
        $('#Site_Setup3').append(sitesetup);
    },
    error: function (xhr) {
        alert(xhr.status);
    }
}); 
```

如何按特定元素或列排序/排序？比如名字？

# java - Java Puzzler：繁忙的等待线程停止工作

> ID：16179525
> 
> 赞同：0
> 
> 时间：2013-04-23T21:30:34.303
> 
> 标签：java, multithreading, thread-synchronization, java-memory-model, busy-waiting

这是某种Java Puzzler，我偶然发现并无法真正解释。也许有人可以？

以下程序在短时间内挂起。有时在 2 次输出之后，有时在 80 次之后，但几乎总是在正确终止之前。如果第一次没有发生，您可能需要运行几次。

```
public class Main {
    public static void main(String[] args) {
        final WorkerThread[] threads = new WorkerThread[]{ new WorkerThread("Ping!"), new WorkerThread("Pong!") };
        threads[0].start();
        threads[1].start();

        Runnable work = new Runnable() {
            private int counter = 0;
            public void run() {
                System.out.println(counter + " : " + Thread.currentThread().getName());
                threads[counter++ % 2].setWork(this);
                if (counter == 100) {
                    System.exit(1);
                }
            }
        };

        work.run();
    }
}

class WorkerThread extends Thread {
    private Runnable workToDo;

    public WorkerThread(String name) {
        super(name);
    }

    @Override
    public void run() {
        while (true){
            if (workToDo != null) {
                workToDo.run();
                workToDo = null;
            }
        }
    }

    public void setWork(Runnable newWork) {
        this.workToDo = newWork;
    }
} 
```

现在，很明显，繁忙的等待循环通常不是一个好主意。但这不是关于改进，而是关于了解正在发生的事情。

由于一切都按预期工作，`WorkerThread.setWork()`或者`synchronized`当该`WorkerThread.workToDo`字段设置为时，`volatile`我怀疑存在内存问题。

但究竟为什么会发生呢？调试无济于事，一旦您开始单步执行，一切都会按预期运行。

解释将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:34:35.163

1.  第一个问题是您正在`Runnable workToDo`从`main`线程设置，然后在没有同步的 2 个分叉线程中读取它。任何时候你在多个线程中修改一个字段，它都应该被标记为`volatile`或某人`synchronized`。

    ```
    private volatile Runnable workToDo; 
    ```

2.  此外，由于多个线程都在这样做，`counter++`所以也需要`synchronized`. 我`AtomicInteger`为此推荐一个。

    ```
    private AtomicInteger counter = new AtomicInteger(0);
    ...
    threads[counter.incrementAndGet() % 2].setWork(this); 
    ```

3.  但我认为*真正的*问题可能是竞争条件之一。两个线程都可以将 设置为`workToDo`，`Runnable`然后让它们都返回并将其设置回 ，`null`这样它们就会永远旋转。我不知道如何解决这个问题。

    ```
    1\. threads[0] has it's `workToDo` set to the runnable.  It calls `run()`.
    2\. at the same time threads[1] also calls `run()`.
    3\. threads[0] sets the `workToDo` on itself and threads[1] to be the runnable.
    4\. at the same time threads[1] does the same thing.
    5\. threads[0] returns from the `run()` method and sets `workToDo` to be `null`.
    6\. threads[1] returns from the `run()` method and sets `workToDo` to be `null`.
    7\. They spin forever... 
    ```

而且，正如您提到的，自旋循环很疯狂，但我认为这是一个演示线程程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:44:55.227

问题发生在这几行之间：

```
workToDo.run();
workToDo = null; 
```

假设发生以下事件序列：

```
- Original Runnable runs.  "Ping!".setWork() called
- Ping! thread realizes workToDo != null, calls run(), the stops between those two lines
  - "Pong!".setWork() called
- Pong! thread realizes workToDo != null, calls run()
  - "Ping!".setWork() called
- Ping! thread resumes, sets workToDo = null, ignorantly discarding the new value
- Both threads now have workToDo = null, and the counter is frozen at 2,...,80
  Program hangs 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-14T16:41:40.057

我的 2 美分....

```
import java.util.concurrent.atomic.AtomicReference;

class WorkerThread extends Thread {
    private AtomicReference<Runnable> work;

    public WorkerThread(String name) {
        super(name);
        work = new AtomicReference<Runnable>();
    }

    @Override
    public void run() {
        while (true){
            Runnable workToDo = work.getAndSet(null);
            if ( workToDo != null ) {
                workToDo.run();
            }
        }
    }

    public void setWork(Runnable newWork) {
        this.work.set(newWork);
    }
} 
```

# c++ - c++模板非类型参数lambda函数

> ID：16179528
> 
> 赞同：3
> 
> 时间：2013-04-23T21:30:51.870
> 
> 标签：c++, templates, c++11, lambda

这有效：

```
#include <functional>

template < bool (*F)( int ) > class Foo {};

bool fooFunc( int n ) { return true; }

int main( int argc, char* argv[] )
{
    auto a = Foo< fooFunc >();
} 
```

但这不起作用，因为您无法将 lambda 转换为函数指针：

```
#include <functional>

template < bool (*F)( int ) > class Foo {};

auto barFunc = [] ( int n ) -> bool { return true; };

int main( int argc, char* argv[] )
{
    auto a = Foo< barFunc >();
} 
```

这不起作用，因为您不能使用 std::function<> 作为模板非类型参数：

```
#include <functional>

template < std::function< bool( int ) > F > class Bar {};

auto barFunc = [] ( int n ) -> bool { return true; };

int main( int argc, char* argv[] )
{
    auto b = Bar< barFunc >();
} 
```

那么如何创建一个能够接受 lambda 封装作为模板非类型参数的模板类呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T21:33:41.243

只需创建一个带有类型参数的类模板，并`decltype`在实例化模板时用于推断 lambda 的类型。

```
#include <functional>

template <typename Function> 
class Bar 
{ };

auto barFunc = [] ( int n ) -> bool { return true; };

int main()
{
    auto b = Bar<decltype(barFunc)>();
} 
```

但请注意，lambdas 不是默认可构造的，因此您可能需要添加更多代码来创建一个构造函数，`Bar`该构造函数接受 lambda 的副本：

```
template <typename Function> 
class Bar 
{ 
    public:

    Bar(Function f) : m_function(f)
    { }

    private:

    Function m_function;
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:43:44.910

在您的第一个示例中，您需要添加一个指针，因为该函数没有衰减为一个。

```
int main( int argc, char** )
{
    auto a = Foo< std::add_pointer<decltype(fooFunc)>::type(0) >();
} 
```

# ios - 如何在不推动的情况下滑动 UINavigationController 树叶？

> ID：16179531
> 
> 赞同：1
> 
> 时间：2013-04-23T21:30:57.030
> 
> 标签：ios, uinavigationcontroller, uiswipegesturerecognizer

此应用程序提供 6 个详细表单输入屏幕，可通过主表视图使用`UINavigationController`.

因此，用户开始时将主屏幕用作菜单，并依次向下钻取每个详细视图。树的深度为 2：在第 1 级，有主视图（菜单）。在第 2 级，共有 6 个详细视图。

现在，最常见的工作流程是以线性方式依次通过 6 个细节屏幕中的每一个。每次都必须返回菜单充其量是很麻烦的。

因此，我想为用户提供通过滑动手势从一个详细信息屏幕转到下一个或上一个屏幕的可能性。

我怎样才能做到这一点？

我可以设置 2 `UIGestureRecognisers`。没问题。我什至将它们与 push segue 相关联，它可以工作，但这不是我想要的行为：我希望深度保持在 2。换句话说，我希望 segues*替换*而不是*推送*视图导航堆栈的顶部。

最好的方法是什么？

第二：视图切换一滑动手势结束。我宁愿让动画在滑动*期间*开始，用户有机会在观看下一个/上一个视图部分出现时改变主意，就像照片应用程序处理从一张照片滑动到下一张/上一张照片一样。

这甚至可能吗？

感谢您的任何见解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T10:26:31.283

在我看来，您正在寻找类似[UIPageViewController](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPageViewControllerClassReferenceClassRef/UIPageViewControllerClassReference.html)和[UIPageViewControllerTransitionStyleScroll](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPageViewControllerClassReferenceClassRef/UIPageViewControllerClassReference.html#//apple_ref/doc/c_ref/UIPageViewControllerTransitionStyle)的东西。

您可以`UIPageViewController`从您的主 tableView 中选择它并将您的 6 个详细信息 VC 作为页面添加到其中。

这是有关如何在情节提要中使用 a 的[教程。](http://translate.google.com/translate?hl=en&sl=it&u=http://www.devapp.it/wordpress/t111-come-utilizzare-uipageviewcontroller-con-lo-storyboard.html&prev=/search?q=uipageviewcontroller%2bexample&start=20&safe=active&sa=N&hl=en&biw=1597&bih=674&sa=X&ei=7LF3Uej8KcGAtAa8zoGYBg&ved=0CE0Q7gEwBTgU)`UIPageViewController`

请注意，此滚动样式仅适用于 iOS6.0+。

# ios - 如何在 iOS 上的 MapView 中分隔逗号分隔坐标以进行绘图？

> ID：16179534
> 
> 赞同：0
> 
> 时间：2013-04-23T21:31:00.647
> 
> 标签：ios, coordinates

我将如何取一个逗号分隔值 NSString *location = "15.009483, -87.485195" 并将它们分隔成坐标值来绘制？

我需要将它们放入 CoreData 数据库中，每个坐标都有单独的字段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:40:23.923

您可以使用 NSArray`componentsSeparatedByString:`将字符串分解为数组。从那里您可以将对象作为单独的字符串拉回。

```
NSString *location = @"15.009483, -87.485195";
NSArray *array = [location componentsSeparatedByString:@","];
NSString *lat = array[0];
NSString *lon = array[1]; 
```

# javascript - Javascript 命名空间和公共函数

> ID：16179536
> 
> 赞同：2
> 
> 时间：2013-04-23T21:31:25.860
> 
> 标签：javascript, jquery, jquery-plugins, fine-uploader

我正在编写一个 jQuery 插件，以允许以指定的形式初始化多个单个文件上传字段（使用[Fine Uploader](http://fineuploader.com/)）。

最终，我希望表单知道它附加了这些单个上传器，因此我可以在手动开始文件上传和提交表单之前运行一些验证等。

我理想的初始化代码如下所示：

```
var form = $("form");
form.uploader();
form.addUploader({
  element: '.uploader_one'
});
form.addUploader({
  element: '.uploader_two'
}); 
```

到目前为止，我为实现这一点而编写的插件看起来像：

```
(function($) {

    var Uploader = function(form){
       addUploader = function() {
          // Initialize Fine Uploader
       }

       $(form).submit(function(e) {
         // Run validations, then process uploaders
         $(this).submit();
       } 
    }

    $.fn.uploader = function(options) {
       var uploader = new Uploader(this);
    };

})(jQuery); 
```

大部分都有效，除了 addUploader 函数不可公开访问。

我可能会以错误的方式解决这个问题吗？任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:45:56.880

您需要创建`addUploader`对象的成员以使其可通过对象访问（而不是作为与对象断开连接的全局变量）：

```
 this.addUploader = function() { 
```

插件必须对对象做一些事情以便它变得可访问，例如返回它：

```
$.fn.uploader = function(options) {
  return new Uploader(this);
}; 
```

现在您可以从插件中获取对象并使用它：

```
var form = $("form");
var upl = form.uploader();
upl.addUploader({
  element: '.uploader_one'
});
upl.addUploader({
  element: '.uploader_two'
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T22:03:04.530

您应该遵循开发插件的一般做法。您的插件的建议结构类似于：

```
(function($) {
    var methods = {
        init: function (options) {
            var data = $(this).data("uploader-plugin");
            if (!data) {
                $(this).on("submit", function (e) {

                });
                $(this).data("uploader-plugin", new Uploader(options));
            }
        },
        add: function (options) {
            // Use `options.element`
            $(this).data("uploader-plugin").elements.push(options.element);
            console.log($(this).data("uploader-plugin"));
        }
    };

    var Uploader = function (opts) {
        this.whatever = opts.a;
        this.elements = [];
    };

    $.fn.uploader = function(method) {
        var args = arguments;
        return this.each(function () {
            if (methods[method]) {
                return methods[method].apply(this, Array.prototype.slice.call(args, 1));
            } else if (typeof method === "object" || !method) {
                return methods.init.apply(this, args);
            } else {
                $.error("Method " +  method + " does not exist on jQuery.uploader");
            }
        });
    };
})(jQuery); 
```

**演示：http:** [//jsfiddle.net/WyGqc/](http://jsfiddle.net/WyGqc/)

你会这样称呼它：

```
var form = $("form");
form.uploader({
    a: "whatever";
});
form.uploader("add", {
    element: ".uploader_one"
}); 
```

它实际上将其应用于原始选择器中的所有选定元素，并继续链接。它还遵循插件使用的常规约定 - 意思是，您`uploader`使用不同的参数调用插件名称 ( ) 来执行不同的操作。

# sql - 使用带有通配符的表值参数？

> ID：16179541
> 
> 赞同：1
> 
> 时间：2013-04-23T21:31:42.380
> 
> 标签：sql, vb.net, search, search-engine, table-valued-parameters

## 情节...

**我正在用ASP.net**和**Visual Basic**开发一个网站，显示用户生成的产品列表（以下称为“帖子”）。在这个站点中，我有一个搜索框，可以让用户更轻松地找到他的帖子。搜索框旨在允许用户输入特定的*关键字*，这有望提供更定制的搜索。例如：

![示例搜索框](https://i.stack.imgur.com/4SUEk.gif)

在上面的示例中，用户已指定他想搜索作者与名称“John Smith”匹配的书籍，*以及*标签“Crime”和“Suspense”的书籍。

**脚步：**

1.  我的 SearchBoxManager 类检索这些键名（作者、标签）和键值（约翰·史密斯、犯罪、悬念）。
2.  我使用这些参数运行 SQL 查询以寻找精确匹配。
3.  我从键值中提取每个单词，以便可以单独搜索它们。
4.  **这是我遇到问题的地方。**我使用那些寻找非精确匹配的参数运行 SQL 查询（例如，'%John%'、'%Smith%'）。这一步是创建一个基于相关性的结果系统。这是我的第一个相关性算法，所以我可能会走错路。

* * *

## 问题...

为了使第三步正常工作，我想将每组从键值中分离出来的单词放入一个表值参数中，然后在通配符“%”包围的 SqlCommandText 中使用该表值参数。

换句话说，因为每个键值中的单词数可能每次都会改变，所以我需要将它们放在某种表值参数中。我还认为我可以以某种方式将它们串在一起并直接在查询字符串中使用它们，但我中途停止了，因为它变得有点混乱。

* * *

## 问题...

*   我可以将通配符与表值参数一起使用吗？如果可以，如何使用？

此外，如果你们中的任何人开发了本地搜索框的相关性排名算法或知道一个，如果您能指出正确的方向，我将不胜感激。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:45:42.700

所以一些样本数据

```
create table authors ( id int, name varchar(200) )
insert into authors values (1, 'John Smith')
insert into authors values (2, 'Jack Jones')
insert into authors values (3, 'Charles Johnston') 
```

如果您想使用 table var，我们可以制作一个并填充几个搜索词

```
declare @t table(word varchar(10) )
insert into @t select 'smith' union select 'jones' 
```

现在我们可以使用通配符进行选择

```
select authors.* from authors, @t words 
where authors.name like '%'+words.word+'%' 
```

# typescript - 更漂亮的 TypeScript 匿名类声明？

> ID：16179542
> 
> 赞同：14
> 
> 时间：2013-04-23T21:31:44.450
> 
> 标签：typescript

有没有比这更漂亮的方式来用 typeScript 中的类型成员来表达匿名类（？）？

```
class Foo {
    member = {
        aNumber = <number>undefined;
        aBoolean = <bool>undefined;
    }
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-23T21:41:30.303

唯一的*匿名*选择是：

```
class Foo {
    member: { aNumber?: number; aBoolean?: bool; } = {
        aNumber: undefined,
        aBoolean: undefined
    }
} 
```

你通常最好只写一个`interface`这样你就可以命名类型。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-24T00:02:32.373

Since members are undefined by default you could simply go with:

```
class Foo {
    member:{aNumber:number;aBoolean:bool;} = <any>{};
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-12-09T04:46:58.257

在较新版本的打字稿中，这可以使用可选属性来实现：

```
class Foo {
    member: { aNumber?: number; aBoolean?: boolean; } = {}
} 
```

# android - Android - 在 Spinner 选择后将焦点设置在 EditText 上

> ID：16179545
> 
> 赞同：6
> 
> 时间：2013-04-23T21:31:48.083
> 
> 标签：android, xml, focus, android-edittext, spinner

我在屏幕上显示以下项目：

```
EditText Forename
Spinner gender selection (Male | Female)
EditText Email 
```

首次启动应用程序时，我希望将焦点设置在 Forename EditText 上。然后在微调器中选择“男性”或“女性”之后，我希望将焦点设置在位于微调器下方的电子邮件 EditText 上。

我曾经在电子邮件 EditText 上`setOnItemSelectedListener`设置过`requestFocus`，但问题是它会在我启动应用程序时自动将焦点设置在此 EditText 上。发生这种情况是因为默认情况下微调器显示第一个选择，在这种情况下是“男性”，因此它认为已经做出选择并将焦点设置在电子邮件字段上。

我不介意默认情况下已经在微调器中选择了第一个选择，但是如果我能以某种方式覆盖`requestFocus`最初在 Forename EditText 上设置的选项，那就太好了。

XML:

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/LinearLayout" 
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">

   <EditText
        android:id="@+id/ForenameForm"
        android:layout_width="285dp"
        android:layout_height="65dp"
        android:hint="@string/forenameHint"
        android:lines="1"
        android:singleLine="true"
        android:textSize="20sp" >
    </EditText>

   <Spinner  
        android:id="@+id/SpinnerGender" 
        android:spinnerMode="dialog"
        android:textSize="30sp" 
        android:layout_width="285dp"
        android:layout_height="60dp"
        android:prompt="@string/spinnerGender"  
        android:entries="@array/genderList">

    </Spinner>

   <EditText
        android:id="@+id/EmailForm"
        android:layout_width="285dp"
        android:layout_height="65dp"
        android:hint="@string/emailHint"
        android:lines="1"
        android:singleLine="true"
        android:textSize="20sp" >
    </EditText>

</LinearLayout> 
```

活动类：

```
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        final EditText forename=(EditText)findViewById(R.id.ForenameForm);
        forename.requestFocus();

        final EditText email=(EditText)findViewById(R.id.EmailForm);

        Spinner spinner=(Spinner)findViewById(R.id.SpinnerGender);
        spinner.setFocusable(true);
        spinner.setFocusableInTouchMode(true);   

        spinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener()
        {

            @Override
            public void onItemSelected(AdapterView<?> arg0, View arg1,
                    int arg2, long arg3) {
                email.requestFocus();               
            }

            @Override
            public void onNothingSelected(AdapterView<?> arg0) {

            }               
        });  
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T22:07:40.143

这个解决方案怎么样。

```
define a boolean flag and set it default false.

in oncreate set the focus of forname

in setOnItemSelectedListener 
     if flag is false then set flag true
     else focus email 
```

所以你的代码会像

```
boolean flag = false;
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        final EditText forename=(EditText)findViewById(R.id.ForenameForm);
        forename.requestFocus();

        final EditText email=(EditText)findViewById(R.id.EmailForm);

        Spinner spinner=(Spinner)findViewById(R.id.SpinnerGender);
        spinner.setFocusable(true);
        spinner.setFocusableInTouchMode(true);   

        spinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener()
        {

            @Override
            public void onItemSelected(AdapterView<?> arg0, View arg1,
                    int arg2, long arg3) {
              // changes here
                if(flag == false)
                    flag = true;
                else 
                    email.requestFocus();               
            }

            @Override
            public void onNothingSelected(AdapterView<?> arg0) {

            }               
        });  
    } 
```

# asp.net-mvc-4 - Setting IBus Property in MVC Filter

> ID：16179547
> 
> 赞同：0
> 
> 时间：2013-04-23T21:31:58.940
> 
> 标签：asp.net-mvc-4, aop, structuremap, nservicebus, nservicebus3

I'm trying to send a command from a filter in my MVC4 project to my command processor.

The problem:
I can't get an NServiceBus instance in the filter to fill.

The components:

*   ASP.NET MVC 4
*   NServiceBus version 3
*   StructureMap

The Attribute/Filter:

```
namespace AMS.WebApp.Filters
{
    public class AMSAuthorizeAttribute : AuthorizeAttribute
    {
        public IBus Bus { get; set; }
        protected override bool AuthorizeCore(HttpContextBase httpContext)
        {
            bool accessGranted = false;

            accessGranted = base.AuthorizeCore(httpContext);

            // arbitrary command, don't worry about it
            // Why is Bus still null?
            var requestAccess = new RequestingAccess();
            Bus.Send("AMS.AccessControl.CommandProcessor", requestAccess);

            //if(isAdmin)
            //  accessGranted = true;

            #if DEBUG
                accessGranted = true;
            #endif

            return accessGranted;
        }
    }
} 
```

The IOC Code:

```
using AMS.WebApp.Filters;
using NServiceBus;
using StructureMap;
namespace AMS.WebApp.DependencyResolution {
    public static class IoC {
        public static IContainer Initialize() {
            ObjectFactory.Initialize(x =>
                        {
                            x.Scan(scan =>
                                    {
                                        scan.AssembliesFromApplicationBaseDirectory();
                                        scan.WithDefaultConventions();
                                    });

                            //This doesn't work
                            //x.SetAllProperties(y => y.OfType<IBus>());  

                            //Neither does this                            
                            //x.ForConcreteType<AMSAuthorizeAttribute>()
                            // .Configure
                            // .Setter<IBus>(a => a.Bus)
                            // .IsTheDefault();
                        });
            return ObjectFactory.Container;
        }
    }
} 
```

Also, my attempt to bypass structuremap completely by passing in the bus instance from the controller resulted in:

```
An object reference is required for the non-static field, method, or property 
```

At this point I'm pretty sure its something awkward with attributes/filters and structuremap, but I'm not really sure what that is.

WARNING: the accepted answer does not fix the actual problem of getting nservicebus in an action filter, but it does address how to get DI in an action filter. See [ASP.NET MVC4 NServiceBus Attribute/Filter StructureMap](https://stackoverflow.com/questions/16196652/asp-net-mvc4-nservicebus-attribute-filter-structuremap) for the Nservicebus specific question

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T03:39:00.643

Take a look at this post. I think this is what you're looking for.

[http://lostechies.com/jimmybogard/2010/05/03/dependency-injection-in-asp-net-mvc-filters/](http://lostechies.com/jimmybogard/2010/05/03/dependency-injection-in-asp-net-mvc-filters/)

Edit:

I think you have two different issues here.

1.  Using DI on a filter
2.  Configuring DI on NServiceBus

Can you please post your code which initializes NServiceBus for StructureMap?

You are looking for somthing like this:

Configure.With().StructureMapBuilder()

# android - 安卓亚行。奇怪的行为

> ID：16179549
> 
> 赞同：0
> 
> 时间：2013-04-23T21:32:10.330
> 
> 标签：android, intellij-idea, adb

我机器上的 adb 突然出现奇怪的行为，我无法调试任何项目。我在 Ubuntu 12.10 上使用 Intellij Idea。两天前一切正常，但现在调试器一般无法正常工作。 `adb devices`显示所有连接的设备，当我在手机上启动应用程序时，我可以看到带有消息的对话框`Waiting for debugger`，但任何断点都不起作用。我不知道这种情况可能是什么原因，我只是安装了 Netbeans。请知道如何解决这种情况的人帮助。没有调试器，我的工作真的很糟糕

# android - 从 AlarmManger 弹出一个 AlertDialog

> ID：16179554
> 
> 赞同：0
> 
> 时间：2013-04-23T21:32:21.300
> 
> 标签：android, dialog, broadcastreceiver, android-alertdialog, alarmmanager

我试图让 BroadcastReceiver 运行一个 AlertDialog ，它只是跳过对 Dialog 方法的调用（并抛出 catch 异常）：我的 BroadcastReceiver：

```
public void onReceive(Context context, Intent intent) {
        this.con = context;
        try 
        {            
            PowerManager pm = (PowerManager) context.getSystemService(Context.POWER_SERVICE);
            PowerManager.WakeLock wl = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, "YOUR TAG");
            //Acquire the lock
            wl.acquire();

            intent.getExtras();
            new StringBuilder();
            wl.release();
            String[] a ={"a","b"};
            create(context, a); //The Dialog Call
            setOnetimeTimer(con);
            Toast.makeText(context, "Hurray!", Toast.LENGTH_SHORT).show();

        } 
        catch (Exception e) 
        {
             Toast.makeText(context, "Error,broadcastReciver"+e.getMessage(), Toast.LENGTH_LONG).show();
             e.printStackTrace();
        }
   } 
```

方法如下`create()`：（创建对话框）public static void create（Context context,String[] descriptions）{

```
 AlertDialog.Builder builder = new AlertDialog.Builder(context);
        builder.setCancelable(true);
        builder.setTitle("Random String");
        builder.setMessage(descriptions[rn.nextInt(2)]);
        //builder.setMessage("test");
        builder.setInverseBackgroundForced(false);
        builder.setPositiveButton("Close",
                new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialog,
                            int which) {
                        dialog.dismiss();
                    }
                });
        AlertDialog alert = builder.create();
        alert.show();
    } 
```

谢谢！编辑：不要说我把它放在一个活动中并运行这个活动，因为我不希望它打开我的应用程序，我希望它在打开的应用程序之上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T05:57:24.237

如果不设置日历的较长持续时间字段（例如，年份），您似乎在当前时间之前设置了闹钟。尝试这样的事情：

```
Calendar calendar = Calendar.getInstance();
calendar.setTimeInMillis(System.currentTimeMillis());
calendar.add(Calendar.MINUTES, 23*60 + 58); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T12:40:52.170

（编辑前）1.i 调用了该类`Dialog`，因此当 Intent 尝试调用`Dialog.class`它时，它会在 System 类中调用`Dialog`。2.我用过： [如何在Android上创建一个透明的Activity？](https://stackoverflow.com/questions/2176922/how-to-create-transparent-activity-in-android) 为了使活动透明，我没有使用`ContentView`，所以只有已经打开的活动上方的对话框弹出。

# python - 使用 Python 连接到 Access .accdb 数据库的 DAO

> ID：16179555
> 
> 赞同：3
> 
> 时间：2013-04-23T21:32:23.063
> 
> 标签：python

我的一个 Python 应用程序在使用旧的 .mdb 访问数据库时运行良好，我遇到了问题。转换为 Access 2010 并将文件转换为新的 .accdb 格式后，似乎没有任何效果。我确实在新的 64 位 Win 7 操作系统上加载了 32 位 Access 版本。我相信我的问题在于我的代码的前两行。我相信我需要更新它们以引用“Microsoft Office 14.0 Access Database Engine Object”，但我不清楚如何执行此操作。我可以得到一些帮助吗？我已经搜索了有关这种情况的 DAO 信息的高低，但都可以利用。

```
 import win32com.client
 engine = win32com.client.Dispatch("DAO.DBEngine.36")

 db=engine.OpenDatabase(r"c:\temp\Tracker.accdb")

 table = db.OpenRecordset("select * from Event_Log")
 print table.RecordCount 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-07-11T10:43:58.653

对于 OP 来说答案可能为时已晚，但万一其他人在这里偶然发现使用 Python 在 DAO 领域寻找答案：

OP 是正确的，直接的问题在于 Dispatch 方法中使用的字符串。Office 2010（Office 14？）安装“DAO.DBEngine.120”，我认为这是与 .accdb 文件一起使用的最早版本。通常，可以通过使用 RegEdit 在注册表中搜索子字符串“DAO.DBEngine”来研究此问题，并查看哪些组件已注册，将版本号添加到该字符串。

还需要注意的是，要使用的python版本的32/64位需要与DAO版本的32/64位匹配，而DAO版本又与安装它的Office的32/64位匹配。

进一步说明：如果您使用 IDE 并使用自动完成功能，则生成和导入与 DAO API 对应的模块很有用。这可以通过在相关库（此处为“Microsoft Office 14.0 Access Database Engine Object Library”）上运行 MakePy 实用程序（在 PythonWin 程序中）来完成。这会在 site-packages\win32com\gen_py\ 中生成一个模块文件，其 GUID 名称很长……您可以将其重命名为“DAO_120-64.py”或类似名称。然后将 gen_py 目录添加到 Python 路径中（或在 sitepackages 中添加一个 .pth 文件），以便 import 可以找到新模块。

导入后，您可以执行 IDE 识别的任何操作，将类型与 DAO.Database、DAO.Recordset 等的变量相关联。

此外，生成的 DAO 模块是可用的对象、方法、属性和常量的有用参考。可能更有用的参考是简单地打开一个 Excel/Word/Access VBA 项目，参考（导入）这个相同的库，然后在其上使用 VBA 对象浏览器。

一般来说，任何关于在Access（VBA或VB）中使用DAO的教程或文章都会描述常见操作中涉及的对象、方法和属性，几乎可以逐字转录成python。主要区别在于，在 python 版本中，一些 COM“默认方法”机制不起作用。因此，例如，VBA

MyRecordset("SomeColumn") = "NewValue"

...在python中对应于：

MyRecordset.Fields("SomeColumn").Value = "NewValue"

希望有帮助。

# ios - 如何从我的 iPad 启用 1920x1080 外接显示器？

> ID：16179558
> 
> 赞同：1
> 
> 时间：2013-04-23T21:32:44.277
> 
> 标签：ios, objective-c, ipad, external-display

我正在尝试通过 Lightning AV 适配器从 iPad 4（型号 MD513LL/A）设置以 1920x1080 运行的外部显示器。当我解析每种可用模式时，我看到以下内容：

*   1600x900
*   1280x720
*   1024x768
*   800x600
*   640x480
*   720x480

我已经用三台现代（1-2 岁）电视对此进行了测试，并且在每台显示器上都得到了相同的结果，但从未见过 1920x1080。这是我用于外部显示器的代码。

编辑：我发现这只是 Lightning 数字 AV 适配器的问题，而不是原始数字 AV 适配器的问题。

```
if ([[UIScreen screens] count] > 1)
{
    UIScreen *secondScreen = [[UIScreen screens] objectAtIndex:1];
    NSString *availableModeString;

    for (int i = 0; i < secondScreen.availableModes.count; i++)
    {
        availableModeString = [NSString stringWithFormat:@"%f, %f",
        ((UIScreenMode *)[secondScreen.availableModes objectAtIndex:i]).size.width,
        ((UIScreenMode *)[secondScreen.availableModes objectAtIndex:i]).size.height];

        [[[UIAlertView alloc] initWithTitle:@"Available Mode" message:availableModeString delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil] show];
        availableModeString = nil;
    }

    // undocumented value 3 means no overscan compensation
    secondScreen.overscanCompensation = 3;

    self.secondWindow = [[UIWindow alloc] initWithFrame:CGRectMake(0, 0, 1280, 720)];
    self.secondWindow.backgroundColor = [UIColor blueColor];
    self.secondWindow.screen = secondScreen;

    T9SecondaryScreenViewController *viewController = [[T9SecondaryScreenViewController alloc] initWithNibName:@"T9SecondaryScreenViewController" bundle:nil];
    self.secondWindow.rootViewController = viewController;

    self.secondWindow.hidden = NO;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T22:47:12.243

不幸的是，这个适配器不能支持 1080p。

[资源](http://9to5mac.com/2013/03/01/the-lightning-digital-av-adapter-doesnt-do-native-1080p-out-possibly-because-it-is-an-airplay-receiver/)

# c++ - stl_algo.h 中的错误，比较指针

> ID：16179561
> 
> 赞同：0
> 
> 时间：2013-04-23T21:33:03.587
> 
> 标签：c++, pointers, compare

我试图找出一个对象是否存在于指针向量中。

```
vector<Objectoid*> elements;

bool contains(Objectoid &o){
    for(int i = 0; i < elements.size(); i++){
        if(elements[i] == &o){
            return true;
        }
    }
    return false;
} 
```

但得到这些错误，

```
no match for 'operator==' in '__first. __gnu_cxx::__normal_iterator<_Iterator, _Container>::operator* [with _Iterator = Objectoid**, _Container = std::vector<Objectoid*, std::allocator<Objectoid*> >]() == __value' 
```

在`stl_algo.h`.

非常感谢帮助。

**编辑：**

完整代码

```
class Cell : public Element{

public:
    Rectf cellRect;
    Vec2i size;
    Vec2i pos;
    vector<Objectoid*> elements;

    Cell(Vec2f &pos_, Vec2f &size_){
        pos = pos_;
        size = size_;
        Vec2f p2 = Vec2f(pos.x + size.x, pos.y + size.y);
        cellRect = Rectf(pos, p2);
    }

    void add(Objectoid &o){
        elements.push_back(&o);
    }
    void remove(Objectoid &o){
        elements.erase(std::remove(elements.begin(), elements.end(), o), elements.end());
    }

    bool contains(Objectoid &o){
        for(int i = 0; i < elements.size(); i++){
            if(elements[i] == &o){
                return true;
            }
        }
        return false;
    }

}; 
```

我正在尝试在 2D 游戏中实现用于碰撞检测的哈希表。这是表格中每个单元格的类。

**编辑**

所以罪魁祸首其实是

```
void remove(Objectoid &o){
    elements.erase(std::remove(elements.begin(), elements.end(), o), elements.end());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:53:40.453

**首先，评论：**您现在提供了一些我们可以编译的东西，这很有帮助。话虽如此，您提供的一堆代码不是问题的一部分（例如您的构造函数），我们实际上无法编译您提供的代码（`Vec2i`没有定义）。

**其次，您的问题的答案：** Clang 提供以下错误：

```
/usr/include/c++/4.2.1/bits/stl_algo.h:208:17: error: invalid operands to binary expression ('Objectoid *' and 'const Objectoid')
      if (*__first == __val)

sa.cc:27:19: note: in instantiation of function template specialization 'std::remove<__gnu_cxx::__normal_iterator<Objectoid **, std::vector<Objectoid *, std::allocator<Objectoid *> > >, Objectoid>' requested here
      elements.erase(std::remove(elements.begin(), elements.end(), o), elements.end()); 
```

如果我将该行更改为：

```
elements.erase(std::remove(elements.begin(), elements.end(), &o), elements.end()); 
```

然后一切编译。我提供的版本可以编译，因为 std::remove 的第三个参数必须是`value_type`您正在迭代的任何内容。您最初提供了 a `Objectoid`，但我们需要它成为`value_type`您的容器的 ，即 a `Objectoid *`。

* * *

并且只是为了扩展第一个注释，一个很好的简化问题陈述可以包含如下所示的代码。它非常小，问题仍然很明显。遇到这种情况的任何人都可以很快提供帮助。

```
#include <vector>
#include <algorithm>

class Objectoid {};

int main() {
    std::vector<Objectoid *> elements;
    Objectoid o;

    elements.erase(std::remove(elements.begin(), elements.end(), o), elements.end());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:39:35.123

您的问题没有意义，因为编译器在抱怨`operator*`，但在您的示例中没有使用它。

同时，您应该使用 STL 算法并将您的重写`contains`为：

```
bool contains(Objectoid &o) {
    return std::find(elements.cbegin(), elements.cend(), &o) != elements.cend();
} 
```

这完全避免了这个问题。

# javascript - 删除除 Socket.io 中的特定事件侦听器之外的所有事件侦听器

> ID：16179564
> 
> 赞同：2
> 
> 时间：2013-04-23T21:33:06.880
> 
> 标签：javascript, node.js, socket.io

我有带有 socket.io 的 node.js 应用程序，我用它来实时选择和加载不同的外部模块（我称之为“活动”）。

由于每个模块都将它自己的事件绑定到套接字，因此当我从一个模块更改为另一个模块时，我希望能够从我的套接字中删除前一个模块添加的所有事件侦听器。

我会使用[emiter.removeAllListeners()](http://nodejs.org/api/events.html#events_emitter_removealllisteners_event)，但这也会删除我在服务器中定义的事件，这是我不想要的。

这是我的代码的样子：

`app.js`

```
// Boilerplate and some other code

var currentActivity;
io.sockets.on('connection', function(client){

    client.on('event1', callback1);
    client.on('event2', callback2);

    client.on('changeActivity', function(activityPath){
        var Activity = require(activityPath);
        currentActivity = new Activity();

        // Here I'd like some loop over all clients and:
        // 1.- Remove all event listeners added by the previous activity
        // 2.- Call currentActivity.bind(aClient) for each client
    });
}) 
```

示例活动将类似于以下内容

`someActivity.js`

```
module.exports = function(){

    // some logic and/or attributes

    var bind = function(client){

        client.on('act1' , function(params1){ // some logic
        });
        client.on('act2' , function(params2){ // some logic
        });
        // etc.
    }
} 
```

因此，例如在本例中，如果我从`someActivity.js`其他活动更改，我希望能够为所有客户端删除“act1”和“act2”的侦听器，而不删除“event1”的侦听器，“ event2”和“changeActivity”。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:48:35.137

我将在每个模块中创建一个名为**unbind**的方法，该方法删除由**bind**函数添加的所有侦听器：

```
var fun1 = function(params1){ // some logic };    
var fun2 = function(params2){ // some logic };

module.exports = function(){    
    // some logic and/or attributes    
    var bind = function(client){    
        client.on('act1' , fun1);
        client.on('act2' , fun2);
    }

    var unbind = function(client){
        client.removeEventListener('act1',fun1);
        client.removeEventListener('act2',fun2);
    };
}; 
```

如果您需要在侦听器中访问**客户端**，我会重构它以将客户端传递给构造函数：

```
function MyModule(client){
   this.client = client;
};
MyModule.prototype.fun1 = function(params1){
   //do something with this.client
};
MyModule.prototype.fun2 = function(params2){
   //do something with this.client
};
MyModule.prototype.bind = function(){
   this.client.on('act1' , this.fun1);
   this.client.on('act2' , this.fun2);
};
MyModule.prototype.unbind = function(){
   this.client.removeEventListener('act1' , this.fun1);
   this.client.removeEventListener('act2' , this.fun2);
};
module.exports = MyModule; 
```

然后你可以像这样使用它：

```
client.on('changeActivity', function(activityPath){
    var Activity = require(activityPath);
    var currentActivity = activityCache[activityPath] || new Activity(client); //use the existing activity or create if needed
    previousActivity.unbind();
    currentActivity.bind();
}); 
```

# python - StremListener 不会在 tweepy 中以 JSON 格式返回数据

> ID：16179566
> 
> 赞同：2
> 
> 时间：2013-04-23T21:33:14.263
> 
> 标签：python, json, tweepy

`def on_status(self, status):`我的目标是以json 格式获取数据。现在我以类似于 JSON 的形式返回数据，但它不是 JSON：

```
{'favorited': False, 'contributors': None, 'truncated': False, 'text': 'Lol. As long as you and Tsidi are awake, am not sleeping RT @TboyMP: @Fufu_Tinkies hambo lala wena!! LMAO!!', 'source_url': 'http://ubersocial.com', 'in_reply_to_status_id': None, 'user': <tweepy.models.User object at 0x1b4f3d0>, 'filter_level': 'medium', 'geo': None, 'id': 326808604013379586, 'favorite_count': 0, 'source': 'UberSocial for BlackBerry', 'lang': 'en', 'author': <tweepy.models.User object at 0x1b4f3d0>, 'created_at': datetime.datetime(2013, 4, 23, 21, 23, 37), 'retweeted': False, 'coordinates': None, 'in_reply_to_user_id_str': None, 'entities': {'symbols': [], 'user_mentions': [{'id': 282499717, 'indices': [60, 67], 'id_str': '282499717', 'screen_name': 'TboyMP', 'name': 'Thulane Khanye'}, {'id': 157961325, 'indices': [69, 82], 'id_str': '157961325', 'screen_name': 'Fufu_Tinkies', 'name': 'Nomfundo'}], 'hashtags': [], 'urls': []}, 'in_reply_to_status_id_str': None, 'in_reply_to_screen_name': None, 'id_str': '326808604013379586', 'place': None, 'retweet_count': 0, 'in_reply_to_user_id': None} 
```

如您所见，它使用单引号而不是双引号。我得到这个的方式是：

```
data = status.__getstate__() 
```

但是我不能`load`使用 json 模块：它给了我一个错误：

```
Encountered Exception: expected string or buffer 
```

那么如何从 JSON 中删除数据或将其转换为 JSON？

# 更新

我想要这样的东西：

```
>>> data = '[{"fooo":"bar","something":"another bar"}]'
>>> ww = json.loads(data)
>>> ww[0]['fooo']
u'bar' 
```

我期待在我可以用`tweepy`数据做到这一点的方式上获得帮助......谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-30T19:49:31.063

这会将原始 json 数据写入`def on_status(self, status):`文件。

该解决方案取自[此处](http://willsimm.co.uk/saving-tweepy-output-to-mongodb/)，用于将原始 json 数据添加到状态对象，并[在此处](http://peter-hoffmann.com/2012/simple-twitter-streaming-api-access-with-python-and-oauth.html)作为骨架代码使用 tweepy 的流功能。

```
@classmethod                    
def parse(cls, api, raw):
        status = cls.first_parse(api, raw)
        setattr(status, 'json', json.dumps(raw))
        return status

tweepy.models.Status.first_parse = tweepy.models.Status.parse
tweepy.models.Status.parse = parse

_dir = os.path.dirname(os.path.abspath(__file__))

class CustomStreamListener(tweepy.StreamListener):
    def on_status(self, status):
        print status.user.screen_name
        with codecs.open(os.path.join(_dir, 'tweets.json'), "a", 'utf-8') as textFile:
                textFile.write(status.json)
                textFile.write('\n')

    def on_error(self, status_code):
        print >> sys.stderr, 'Encountered error with status code:', status_code
        return True # Don't kill the stream

    def on_timeout(self):
        print >> sys.stderr, 'Timeout...'
        return True # Don't kill the stream 
```

我不是 Python 专家，但似乎正在使用新版本对 parse 方法进行热修补，然后将新版本安装到 tweepy 类层次结构中。新版本调用旧版本，然后在原始 parse 方法返回的对象上附加一个 json 槽。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:35:56.393

您拥有的是 Python 字典，将其转换为 JSON 使用[`json.dumps()`](http://docs.python.org/2/library/json.html#json.dumps)：

```
import json
json_data = json.dumps(data) 
```

# variables - 获取循环内用于循环外的变量值

> ID：16179570
> 
> 赞同：0
> 
> 时间：2013-04-23T21:33:23.710
> 
> 标签：variables, loops, batch-file

我需要将一些行（Myfile）的一部分从'for'循环中取出到两个单独的变量中或放入一个数组中。我的目标是相互使用来构成以下行result * .txt的路径。我在下面写了您所看到的内容，但可以看出我的“a”变量仅在回显“C:\Temp\FR”（Myfile 中的行尾匹配标记）。

请问，有没有办法在变量/数组中获取所有匹配的标记？例如，就我而言，我需要将 'C:\Temp\USA' 和 'C:\Temp\FR' 排除在循环之外？谢谢

```
 for /f "tokens=2 delims==" %%x in (Myfile) do (
   set a=%%x
  )
  echo %a%
  'MyFile
   DIR1= C:\Temp\USA
   DIR2= C:\Temp\FR
   result1.txt
   result2.txt 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T22:03:12.990

尝试这个：

```
@echo off&setlocal

for /f "tokens=1* delims== " %%x in (Myfile) do (
    if /i "%%x"=="dir1" set "path1=%%y"
    if /i "%%x"=="dir2" set "path2=%%y"
)

echo %path1%
echo %path2% 
```

输出是：

```
C:\Temp\USA
C:\Temp\FR 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T05:37:38.977

有几种方法可以做到这一点。如果您想从文件的开头读取几行，最简单的方法是直接在几个变量中读取它们：

```
< Myfile (
set /P var1=
set /P var2=
) 
```

请注意，这些变量包含完整的行，因此有必要提取等号后面的部分。

在您的示例中，您只需要带有等号的行，因此我们可以`findstr "=" Myfile`在 FOR 命令中使用来处理它们。如果未定义行数，则必须按照建议将所有所需行保存在*数组*中：

```
setlocal EnableDelayedExpansion
set n=0
for /F "tokens=2 delims==" %%a in ('findstr "=" Myfile') do (
   set /A n+=1
   set var[!n!]=%%a
)
rem Show all array elements
for /L %%i in (1,1,%n%) do (
   echo !var[%%i]!
)
rem Show just the second element
echo %var[2]% 
```

但是，在您的特定情况下，您想要的行具有*variable assignments*的形式。这意味着如果您使用 SET 命令*执行*此类行，则这些行中的值将“自动”保存：

```
for /F "delims=" %%a in ('findstr "=" Myfile') do set %%a 
```

在前面的 FOR 之后，您可以直接获取`DIR1`或`DIR2`变量的值，例如：

```
echo %DIR1%
echo %DIR2% 
```

此方法非常简单，不需要对正在加载的各个变量进行任何测试。

如果要删除值中等号后的空格，可以调整 FOR 选项来执行此操作：

```
for /F "tokens=1* delims== " %%a in ('findstr "=" Myfile) do set %%a=%%b 
```

# php - 使用 PDO 检查表是否存在

> ID：16179578
> 
> 赞同：2
> 
> 时间：2013-04-23T21:33:55.120
> 
> 标签：php, mysql, pdo

大家好决定开始学习PDO。但是我无法创建一个函数来检查我的数据库中是否存在表。

每个单独的项目都有自己的表，其中表名是 ($id)。

```
<?php
include_once('config.php');
include_once('simple_html_dom.php');

$html = file_get_html('http://localhost:8888/CDOnline%20Online.html');

foreach($html->find('div.product-stamp-inner') as $content) {   

$detail['itemid'] = $content->find('a',0)->href;
$detail['itemid'] = substr($detail['itemid'], 40, 6);
if (strpos($detail['itemid'], "?") !== false) {
$detail['itemid'] = substr($detail['itemid'], 0, 5);
}
$id = $detail['itemid'];

tableExists($dbh, $id);
}

function tableExists($dbh, $id)
{
//check if table exists
}

$dbh = null;
?> 
```

我试图搜索论坛以寻找答案，但空手而归。唯一让我接近答案的是：

```
function tableExists($dbh, $id)
{
$results = $dbh->query("SHOW TABLE LIKE `$id`");
if(count($results)>0){echo 'table exists';}
} 
```

但这只是说所有表都存在，而一半的表不存在。

编辑：如果有 1 行或更多行，该表应该存在。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-23T21:36:42.273

您正在使用 backtics `$id`。将其更改为单引号。像这样：

```
"SHOW TABLES LIKE '$id'" 
```

进一步注意，该语句`count($results)>0`将不起作用。你必须`$results->rowCount()`改用。

* * *

修复这两个错误将为您提供以下功能：

```
function tableExists($dbh, $id)
{
    $results = $dbh->query("SHOW TABLES LIKE '$id'");
    if(!$results) {
        die(print_r($dbh->errorInfo(), TRUE));
    }
    if($results->rowCount()>0){echo 'table exists';}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-27T02:56:48.580

`SHOW TABLES...`是**MySQL**方言，在几乎任何其他数据库引擎下都会失败。这当然不是便携式桌子检测的最终答案。

您可以获得的最接近便携式的方法是检查是否`SELECT * FROM $table`产生错误，或[**此处讨论的类似方法**](https://stackoverflow.com/questions/1227921/portable-sql-to-determine-if-a-table-exists-or-not)

如果您的需要只是创建一个不存在的表，您可以使用：

```
CREATE TABLE IF NOT EXISTS $table ($field, ...) 
```

但是，如果您的数据库位于 Windows MySQL 服务器上，您可能希望将表命名为***小写***以解决[此错误。](http://ledyardconsulting.blogspot.co.at/2011/03/mysql-error-1050-table-already-exists.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-19T17:13:55.950

如果有人来寻找这个问题，就会简单地发布这个。即使它被回答了一点。

```
if ($con->query(
                   "SHOW TABLES LIKE '" . $table . "'"
               )->rowCount() > 0
        or die("No table set")
   ){ 
```

有了这个，我只是将 else 条件推入 or 。为了我的需要，我只需要死。虽然你可以设置或其他的东西。有些人可能更喜欢 if / else if / else。然后删除或然后提供 if / else if / else。

或者，如果我要重做该功能：

```
function tableExists($dbh, $id){

    if ($dbh->query(
                   "SHOW TABLES LIKE '" . $id . "'"
               )->rowCount() > 0
        or die(print_r($dbh->errorInfo(), TRUE))
   ){
    echo 'table exists';
    }

} 
```

没有测试重做，虽然它应该和我之前使用的代码一样工作。就在功能上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-08T10:01:15.970

这似乎是最简单的方法。你向这个函数传递一个带有你已经创建的 pdo 对象的数组。

```
$db['pdo']=new PDO('mysqlconnectiongoeshere');
$db['table']='tabletobechecked';

function is_table($db){
   $is_table=$db['pdo']->query("SHOW TABLES LIKE '".$db['table']."'");
   return$is_table->rowCount();
} 
```

这样，如果表存在，则此函数返回“1”，如果不存在，则该函数返回“0”；

所以你可以像这样使用它：

```
if(is_table($db)){
  echo"The table".$db['table']." exists.";
}else{
  echo"The table".$db['table']." does not exist.";
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-03-30T10:34:58.277

```
private function doesTableExist($table)
{
    try {
        $this->db->query("DESC $table");
    } catch (Exception $e) {
         return false;
    }
    return true;
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-05-05T12:05:50.043

只需使用良好的旧行数。如果表存在，则必须有结果。

```
$sql ="SELECT count(*) FROM [table name]";
$sql_result = $this->db_mssql->prepare($sql);
$sql_result->execute();
$sql_result->setFetchMode(PDO::FETCH_ASSOC);
$my_res = $sql_result->fetchAll();
if($my_res){
   echo 'table exists';
} 
```

# python - 使用带有 '\xae' 的元素对列表进行转义并打印结果

> ID：16179588
> 
> 赞同：3
> 
> 时间：2013-04-23T21:34:53.870
> 
> 标签：python, list

我有一个清单`L = [u'steve', u'micheal', u'pedro\xae']`

当我试图阅读它时，我得到了一个错误，我相信它与 '\xae' 有关

```
>>> L = [u'steve', u'micheal', u'pedro\xae']
>>>
>>> for n in L:
...     print n
...
steve
micheal
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
UnicodeEncodeError: 'ascii' codec can't encode character u'\xae' in position 5: ordinal not in range(128)
>>> 
```

知道如何逃脱角色吗？

所需的输出，因此读数将非常简单：

```
L= ['steve', 'micheal', 'pedro'] 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T22:05:30.140

便宜的解决方案

```
print n.encode('ascii','backslashreplace') 
```

或者

```
print n.encode('ascii','ignore') 
```

但最好查看 Martijn Pieters 链接并修复编码......否则您可能会在程序的其他地方遇到更多问题

# java - 正则表达式匹配什么

> ID：16179590
> 
> 赞同：1
> 
> 时间：2013-04-23T21:35:07.083
> 
> 标签：java, regex

假设您有一个像这样的正则表达式：

```
\d+\.?\d* (mg |teaspoon |mcg |tablet |units |puffs |tab )*(\d )*(P\.O\. )*((once )*daily|B\.I\.D\.*|(once )*a day|Q\.I\.D\.|nightly|P\.R\.N\.|T\.I\.D\.|every (other )*(day|morning)) 
```

它匹配各种表达式，包括：

> 1 茶匙 每日一次
> 1.5 毫克
> 10 毫克 每晚 1 次 PO

等等

我想了解的是，假设每天 1.5 毫克和 1.5 毫克是匹配的，java 正则表达式是否总是匹配最长的字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:45:59.233

使用您当前拥有的表达式，它实际上与“1.5 mg”不匹配，因为定义频率的最后一组不是可选的。

为了更笼统地回答您的问题，如果您有一个与正则表达式匹配的字符串，并且该字符串的子字符串也将匹配，**则完全取决于将匹配哪个正则表达式**。

例如，对于字符串“foobar”，您将使用 regex 匹配整个字符串`foo(bar)*`，但只会将“foo”与 regex 匹配`foo(bar)*?`。

如果要确保始终匹配最大的字符串，请确保在交替时始终将较长的元素放在首位，例如，`(foobar|foo)`而不是`(foo|foobar)`. 您可能还希望避免使用延迟重复，如`*?`,`+?`或`??`.

当然，这些只是一些一般性的指导方针，彻底测试和重构你的正则表达式，直到你在所有情况下都得到预期的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:40:44.660

> java 正则表达式是否总是匹配最长的字符串？

不，正则表达式并不总是匹配最长的字符串，因为正则表达式库通常会在找到匹配项后停止，而无需回溯以查找更长的匹配项。

例如，

```
Pattern p = Pattern.compile("a|aa");
Matcher m = p.matcher("aaa");
while (m.find()) { System.out.println(m.group()); } 
```

将打印

```
a
a
a 
```

不是

```
aa
a 
```

* * *

这也会影响组匹配。

这会导致混淆的一个地方是当人们尝试使用正则表达式来匹配按字母顺序排列的标识符列表时，执行类似的操作

```
Pattern.compile("<(/?)(a|b|p|pre|s|script)[^>]*>") 
```

匹配标签。给定输入`"<script>Not text in an s tag</script>"`，第 2 组将包含`"s"`，而不是`"script"`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T21:44:03.407

在这种情况下，如果模式的其余部分与较长的字符串匹配，则将返回最长的字符串，而不是最短的。

```
public static void main(String[] args) {
    String regex = "\\d+.?\\d* (mg |teaspoon |mcg |tablet |units |puffs |tab )(\\d )(P.O. )*((once )daily|B.I.D.|(once )a day|Q.I.D.|nightly|P.R.N.|T.I.D.|every (other )(day|morning))";

    Pattern p = Pattern.compile(regex);
    Matcher m = p.matcher("1.5 mg 10 mg 1 P.O. nightly");
    while(m.find()){
        System.out.println(m.group());
    }

} 
```

打印：**每晚 10 毫克 1 次 PO**

# c++ - 错误：转换为非标量类型

> ID：16179592
> 
> 赞同：3
> 
> 时间：2013-04-23T21:35:15.813
> 
> 标签：c++, cstring

我正在为一项任务制作一组派生类。我被指示使用 char 数组（c 字符串）。当我编译时，我不断收到错误：

```
Homework11.cpp: In function âint main()â:
Homework11.cpp:72: error: conversion from âchar [10]â to non-scalar type âBusinessâ requested
Homework11.cpp:73: error: conversion from âchar [10]â to non-scalar type âBusinessâ requested
Homework11.cpp:74: error: conversion from âchar [10]â to non-scalar type âAccountâ requested
Homework11.cpp:75: error: conversion from âchar [10]â to non-scalar type âAccountâ requested 
```

我相当确定我的问题源于我尝试将实例变量 Name 设置为发送的参数。这是我的代码，其中包含我认为可能存在问题的注释。

```
#include <iomanip>
#include <iostream>
#include <cstdlib>
#include <cstring>
using namespace std;

class Person{
public:
        Person() {}
        Person(char theName[]) {strcpy(name,theName);}
        void getName(char theName[]) // I think the problem may be here or in the line above
                { theName = name;}
private:
        char name[80];
 };

class Account : public Person{
public:
        Account() :accountNum(0),balance(0) {}
        Account(int actNo, char theName[])
                :Person(theName),accountNum(actNo),balance(0) {}
        void setBal(float theBalance)
                {balance = theBalance;}
        void deposit(float numDeposited)
                { balance = balance + numDeposited;}
        float withdraw(float numWithdrawn)
                { balance = balance -numWithdrawn;
                  return numWithdrawn;}
        float getBal() {return balance;}
        void printBal();
private:
        int accountNum;
        float balance;
};

 class Business : public Account{
 public:
        Business() : checkFee(0.0) {}
        Business(int actNo, char theName[])
                : Account(actNo, theName),checkFee(0.0) {}
        float withdraw(float numWithdrawn)
                {float newBalance = getBal()-numWithdrawn-checkFee;
                 setBal(newBalance);
                  return numWithdrawn;}
        void setFee(float fee) {checkFee = fee;}
 private:
        float checkFee;
};

void Account::printBal()
{
        char name[80];
        getName(name);
        cout<<setw(10)<<"Account # "<<accountNum<<setw(10)<<
              name<<setw(10)<<balance<<endl;
}

int main()
{
        char businessName1[10]="Business1";
        char businessName2[10] ="Business2";
        char regularName1[10] = "Regular1";
        char regularName2[10] = "Regular2";

       //The following 4 lines are the ones I am getting the error for
        Business bs1 = (1,businessName1);
        Business bs2 = (2,businessName2);
        Account rg1 = (1, regularName1);
        Account rg2 = (2, regularName2);

        cout<<"Intially: "<<endl;
        rg1.printBal();
        rg2.printBal();
        bs1.printBal();
        bs2.printBal();

        bs1.deposit(1000.00);
        bs2.deposit(1000.00);
        rg1.deposit(1000.00);
        rg2.deposit(1000.00);

        cout<<"----------------------------------------"<<endl;
       cout<<"After adding 1000.00 to all accounts:"<<endl;
        rg1.printBal();
        rg2.printBal();
         bs1.printBal();
        bs2.printBal();

        bs1.setFee(1.00);
        bs1.withdraw(500);
        bs2.withdraw(500);
        bs1.deposit(250);
        bs2.deposit(250);
        rg1.withdraw(500);
        rg2.deposit(500);

        cout<<"---------------------------------------"<<endl;
        cout<<"Finially:"<<endl;
        rg1.printBal();
        rg2.printBal();
        bs1.printBal();
        bs2.printBal();

        return 0;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-23T21:37:14.460

正确的语法是`Business bs1(1,businessName1);`. 如果要使用`=`，还可以使用复制初始化`Business bs2 = Business(2,businessName2);`。

前者称为直接初始化。但是它们并不完全相同，请参阅[复制初始化和直接初始化之间的 C++ 有区别吗？](https://stackoverflow.com/questions/1051379/is-there-a-difference-in-c-between-copy-initialization-and-direct-initializati)以获得更深入的信息。

在and 数组中用[逗号](http://en.wikipedia.org/wiki/Comma_operator)`Business bs1 = (1,businessName1);`分隔。逗号运算符评估第一个操作数，即丢弃结果并返回第二个操作数的值，在您的情况下这是一个数组。换句话说，您的代码相当于. 这就是错误消息说它无法将 a 转换为对象的原因。`1``businessName1``1``Business bs1 = businessName1;``char[10]``Business`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:54:54.953

将产生错误的第一行更改为`Business bs1(1,businessName1);`和其余类似。这是在堆栈上初始化类实例的 C++ 习惯用法。

`Business bs2 = Business(2,businessName2);`正如 Jesse Good 所建议的那样，我认为这是一个 Java 习语，在 C++ 中的实践很差。它比较慢，因为有两个隐式构造函数调用和一个复制构造函数调用，而不是`Business bs1(1,businessName1);`. 在这种情况下还有另一个陷阱：您没有为该`Business`类型定义复制构造函数，这意味着编译器将为您创建一个执行浅拷贝的构造函数。 `bs2.name`最终会得到一个指向内存的指针，当`bs2`超出范围时不一定正确释放 - 典型的内存泄漏。

相应的 C++ 习惯用法是在堆上构造一个新对象，然后将其地址分配给一个指针：`Business *bs2 = new Business(2,businessName2);`。

您的代码还有另一个问题。通常，在 C 或 C++ 中按名称分配数组也是一种不好的风格（请记住，静态分配的字符串`char theName[]`只是一种特殊的数组）。查看`getName()`in的定义`Person`：

```
void getName(char theName[])
    { theName = name; } 
```

这是分配数组名称（不完全是指针，而是近亲），而不是将一个字符串的内容复制到另一个字符串。然后在`printBal()`你写

```
char name[80];
getName(name); 
```

执行时它将局部变量`getName()`绑定到参数。到目前为止，一切都很好，尽管您选择的变量名称可能不会那么混乱。:) 但是随后执行主体并将私有实例变量的地址分配给（这是一个数组的名称——同样，一种特殊的指针）。返回时，不会对. 正确的编写方法是 with ，即您编写第二个构造函数的方式：`printBal()``name``theName``getName()``name``theName``getName()``name``printBal()``Person::getName()``strcpy()``Person`

```
void getName(char theName[])
    { strcpy(theName,name); } 
```

# c++ - 关闭我的 DISLIN 小部件会导致我的整个程序关闭

> ID：16179593
> 
> 赞同：1
> 
> 时间：2013-04-23T21:35:16.193
> 
> 标签：c++, visual-studio, visual-c++, plot

我正在使用[DISLIN](http://www.mps.mpg.de/dislin/)在 VC++ 项目中制作一些图。我的对话框窗口包含一个按钮，该按钮在按下时会创建一个 DISLIN 小部件。一切都很好，但是当我关闭 dislin 小部件时，它会关闭我的整个程序。我都试过了

```
g.swgopt("QUIT","CLOSE"); 
```

和

```
g.swgopt("OK","CLOSE"); 
```

在创建小部件时，但它们仍然会在单击“退出”时关闭我的主应用程序，或者当我在 Windows 窗口顶部使用“x”关闭小部件时。

这是从我的主对话框窗口调用小部件创建的代码。

```
void CEx3Dlg::OnBnClickedButton2()
{
    Dislin g;
    g.dislin_expsymbols = GetSelectedSymbols();
    try{
        widget();
    }catch(...){}
} 
```

这是小部件的图像。 ![小部件外观](https://i.stack.imgur.com/SgxZt.png).

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T22:38:39.300

What you want is an OK button, not a quit button, cancel out the Quit and add an OK:

```
//g.wgquit (ip_l);
g.wgok(1);
g.wgfin(); 
```

# php - Imagemagick 调整大小控制质量和扩展

> ID：16179594
> 
> 赞同：0
> 
> 时间：2013-04-23T21:35:23.273
> 
> 标签：php, resize, imagemagick, image-resizing

我正在尝试学习 Imagemagick，php.net 文档太糟糕了 T_T，我似乎找不到任何问题的答案。我想让人们上传图片然后调整它们的大小并丢失 EXIF 数据。

这是我目前拥有的。

```
$thumbnail = new Imagick("http://4.bp.blogspot.com/-hsypkqxCH6g/UGHEHIH43sI/AAAAAAAADGE/0JBu9izewQs/s1600/luna-llena1.jpg");
$thumbnail->thumbnailImage( 100, 100, true );
$thumbnail->writeImage( "avatar/thumbnail.jpg" ); 
```

现在我如何控制它被保存为的图像文件？假设用户提交了一个 gif/png/jpg 我将如何获取该图像然后将其保存为相同的输入格式或将它们全部更改为 .png？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-26T19:41:14.957

This IMO produces the best results for imagick thumbnails;

Load the picture

```
$img = new imagick( $_FILES['Picture']['tmp_name'] ); 
```

Trim an excess off the picture

```
$img->trimImage(0); 
```

Create the thumbnail, in this case, I'm using 'cropThumbnailImage'

```
$img->cropThumbnailImage( 180, 180 ); 
```

Set the format so all pics can now be the same standard format

```
$img->setImageFormat( 'jpeg' ); 
```

Set the Image compression to that of a jpg

```
$img->setImageCompression(Imagick::COMPRESSION_JPEG); 
```

Set the quality to be 100

```
$img->setImageCompressionQuality(100); 
```

The resulting thumbnail is then a little bit blury IMO, so I add a slight sharpening effect to make it 'sharper'. . play around with these settings, but I like..

```
$img->unsharpMaskImage(0.5 , 1 , 1 , 0.05); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T09:50:06.307

我同意，PHP.net 文档不是很有帮助。我发现最容易找到使用命令的方法，然后将命令与 PHP 方法匹配。我回复的有点晚了，所以你现在可能已经想通了，但如果没有，或者为了其他人的利益：

如果您想在保存之前更改图像格式，请在您的`writeImage`行前添加：

```
$thumbnail->setImageFormat('png'); 
```

然后更改您的 writeImage 行中的扩展名以匹配，例如`thumbnail.png`

要更改质量，请编写：

```
$thumbnail->setImageCompressionQuality(40); // Adjust the number 40 
```

在某些情况下，您可能还想通过以下方式设置压缩类型：

```
$thumbnail->setImageCompression(Imagick::COMPRESSION_JPEG); 
```

你可以在这里找到压缩常量：[http ://www.php.net/manual/en/imagick.constants.php](http://www.php.net/manual/en/imagick.constants.php)

注意：这些只是示例。这种压缩实际上不适用于 png 文件。

# java - 将 jTextPane 文本复制到剪贴板

> ID：16179595
> 
> 赞同：4
> 
> 时间：2013-04-23T21:35:26.780
> 
> 标签：java, swing, jtextpane

我有一个包含 a`jTextPane`和 a的表单`jButton`，我已将其设置`jTextPane` `Accessible Description`为`text/html`，现在我想当我单击`jButton`将 的内容复制`jTextPane`到剪贴板时，我尝试了以下代码：

```
 private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {                                         
        StringSelection stringSelection = new StringSelection (jTextPane1.getText());
        Clipboard clpbrd = Toolkit.getDefaultToolkit ().getSystemClipboard ();
        clpbrd.setContents (stringSelection, null);
    } 
```

但是当我过去时，它以 HTML 格式过去的文本。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T00:04:11.763

When I use Ctrl+C I get text copied to the clipboard without HTML. You can use the default Action with the following code:

```
Action copy = new ActionMapAction("Copy", textPane, "copy-to-clipboard");
JButton copyButton = new JButton(copy); 
```

See [Action Map Action](http://tips4java.wordpress.com/2008/12/06/action-map-action/) for more information on how this works.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:52:20.183

首先，Java 中有 2 个剪贴板（您正在使用的一个本地剪贴板和一个系统剪贴板）。[这](http://www.javapractices.com/topic/TopicAction.do?Id=82)是一个使用系统剪贴板的示例。看看并尝试这个 getClipboardContents 方法：

```
public String getClipboardContents(Clipboard clipboard) {
    String result = "";
    if (clipbloard != null){            
        //odd: the Object param of getContents is not currently used
        Transferable contents = clipboard.getContents(null);
        boolean hasTransferableText =
          (contents != null) &&
          contents.isDataFlavorSupported(DataFlavor.stringFlavor);
        if ( hasTransferableText ) {
          try {
            result = (String)contents.getTransferData(DataFlavor.stringFlavor);
          }
          catch (UnsupportedFlavorException ex){
            //highly unlikely since we are using a standard DataFlavor
            System.out.println(ex);
            ex.printStackTrace();
          }
          catch (IOException ex) {
            System.out.println(ex);
            ex.printStackTrace();
          }
        }
    }
    return result;
} 
```

# php - 从 swf 文件问题生成图像

> ID：16179596
> 
> 赞同：1
> 
> 时间：2013-04-23T21:35:35.063
> 
> 标签：php, ffmpeg, flash

我正在尝试将 swf 的第一帧生成为图像，以便用户在打开文件`thumbnail`之前可以看到它。`swf`

1.使用`FFMpeg`

```
ffmpeg -i movie.swf -f image2 -vcodec png movie%d.png 
```

使用命令行`ffmpeg`生成图像。上面的命令会给我错误说

```
[swf @ 0x17937a0] 不支持压缩的 SWF 格式

```

2.使用`swftools`

他们的网站提供了一个`tar`文件供下载，但是我只能`command line`访问服务器，所以我无法安装这些工具。

我需要使用服务器端技术，因为我有数百个 swf 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:57:27.333

```
p7zip e movie.swf
ffmpeg -i movie~.swf movie.png 
```

大多数 SWF 文件都经过压缩以节省空间，类似于 a`.tar.gz`或`.zip`. 因此，在您可以将其与 FFmpeg 一起使用之前，您需要提取或解压缩文件。

`p7zip`是一个 可以提取SWF的[命令行程序。](http://p7zip.sourceforge.net)

# javascript - 带有 ObjectID 的 Mongoosejs OR 语句

> ID：16179597
> 
> 赞同：0
> 
> 时间：2013-04-23T21:35:35.503
> 
> 标签：javascript, node.js, express, mongoose

我正在查询我的团队架构并获取一组 id。我已经验证这`teamIds`是一个包含正确 id 的数组。在我的`OR`陈述中，两者`home_team`都是`away_team`Team Schema 的 ObjectID。我有一种感觉，我的问题与两个 ObjectID 的事实`home_team`有关`away_team`。

```
Team.find({
    'conference.name': confName
}).select('_id').exec(function(err, results) {
    var teamIds = _.pluck(results, '_id');
    console.log(teamIds);

    finding = Game.find().or([
        {'home_team': { $in: teamIds }},
        {'away_team': { $in: teamIds }}
    ]);

    finding.exec(function(err, models) {
        // An error occurred
        if (err) return res.send(err, 500);

        // No models found
        if (!models) return res.send(404);

        console.log(models);
    });
}); 
```

这个查询不起作用，我没有做错什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T23:21:57.130

这个答案主要基于文档，而不是实验。似乎 mongoose`or`函数使用了查询并将其包装到带有附加子句的 or 语句中。在您的情况下，您将搜索主队和客队中存在的“一切”或标识符。它应该在主队或客队，因此建议手动编写：

```
Game.find({$or: [
                 {'home_team': {$in: teamIds}},
                 {'away_team': {$in: teamIds}}
                 ]}, function(err, models) {
    // An error occurred
    if (err) return res.send(err, 500);

    // No models found
    if (!models) return res.send(404);

    console.log(models);
}); 
```

# google-chrome - Chrome 会间歇性地将内容放入带有滚动条的溢出框中

> ID：16179598
> 
> 赞同：0
> 
> 时间：2013-04-23T21:35:46.617
> 
> 标签：google-chrome, overflow

网站 www.sterlingfoundations.com 的 Google Chrome 存在间歇性溢出问题。有时需要重新加载 3 次才能看到问题，但它会将 Navigation 下方的所有内容（当前为 id="wrapper"）推送到左侧边缘带有滚动条的窄列中（它发生在网站的所有页面上）。default.css 给“包装器”一个溢出：auto。删除“default.css”文件时，字体变为默认，但布局问题已解决。所以我认为它与“包装器”中的 CSS 溢出有关。

我注意到的一件事是导航栏看起来像是压缩了“私人基金会”和“金融专业人士”等较长的短语，并在出现问题时强制它们换行至两行。不确定这是否相关。有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T22:04:10.350

看起来您不需要在 div#wrapper 上使用 overflow-y:auto。

# jquery - jQuery垂直文本滚动

> ID：16179599
> 
> 赞同：0
> 
> 时间：2013-04-23T21:35:51.930
> 
> 标签：jquery

我有以下代码，它在**CodePen**、**JSFiddle**和我的浏览器中的行为不同。它只能在 CodePen 中完美运行。

本质上，我希望它从上到下无限滚动而不会停止。

以下是实际代码的两个示例， http: [//jsfiddle.net/qmFD3/](http://jsfiddle.net/qmFD3/)和[http://codepen.io/anon/pen/fiaql](http://codepen.io/anon/pen/fiaql)

```
function scroller() {
  $('#honor-roll ul').animate({
    top: '-=' + $('#honor-roll ul li:last').height()
  }, 1000, 'linear', function () {
    var offset = $('#honor-roll ul li:last').offset().top;
    console.log(offset);
    if (offset <= 2000) {
      $('#honor-roll ul').css("top", 0);
      $('#honor-roll ul li:last').after($('#honor-roll ul li:first').detach());
    }
  });
}
$(document).ready(function () {
  setInterval('scroller()', 200)
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:39:36.403

在 jsFiddle 控制台说：

```
Uncaught ReferenceError: scroller is not defined
(anonymous function) 
```

# php - session_set_cookie_params() 重定向后设置两个cookie

> ID：16179602
> 
> 赞同：1
> 
> 时间：2013-04-23T21:35:58.250
> 
> 标签：php, cookies, session-cookies

我正在使用[此处](http://www.wikihow.com/Create-a-Secure-Login-Script-in-PHP-and-MySQL)找到的登录脚本的略微修改版本，并且遇到了我认为来自我不理解的 session_set_cookie_params() 的行为。

我正在使用会话、cookie 和 header() 将用户重定向到登录页面，然后返回到他们请求的页面。我的问题是，即使初始页面和登录页面使用相同的函数来处理会话和 cookie，也设置了两个单独的 cookie；一个用于 www.example.com，一个用于 example.com。这阻止了登录后读取初始页面上设置的会话变量。

以下是来自任何请求页面的代码示例：

```
requireSSL();
sec_session_start();
if(login_check($mysqli) == false) {
    $_SESSION['origURL'] = $_SERVER['REQUEST_URI'];
    header('Location: https://www.example.com/login.php');
    exit();
} 
```

以下是功能：

```
function requireSSL() {
    if($_SERVER["HTTPS"] != "on") {
        header("Location: https://" . $_SERVER["HTTP_HOST"] . $_SERVER["REQUEST_URI"]);
        exit();
    }
}

function sec_session_start() {
    $session_name = 'sec_session_id'; // Set a custom session name
    $secure = true; // Set to true if using https.
    $httponly = true; // This stops javascript being able to access the session id. 
    ini_set('session.use_only_cookies', 1); // Forces sessions to only use cookies. 
    $cookieParams = session_get_cookie_params(); // Gets current cookies params.
    session_set_cookie_params($cookieParams["lifetime"], $cookieParams["path"], $cookieParams["domain"], $secure, $httponly);
    session_name($session_name); // Sets the session name to the one set above.
    session_start(); // Start the php session
    session_regenerate_id(true); // regenerated the session, delete the old one.     
} 
```

虽然我能够通过在 session_set_cookie_params() 中明确声明一个域（例如“example.com”）来“修复”这种行为，但我很想**了解**为什么首先设置了两个 cookie。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:54:30.993

* * *

为什么：因为 example.com 和 www.example.com 是浏览器的两个不同域。

* * *

```
example.com 
```

是更高级别的域。

```
www.example.com 
```

是一个较低级别的域，在 example.com

通过以下方式将您的 cookie 设置为更高的域：

```
setcookie($name, $value, $expire, $path, 'example.com'); 
```

对于会话 cookie，也可以通过：

```
session_set_cookie_params($lifetime, $path, 'example.com'); 
```

同样因此解决了问题。

所以它们对 www.example.com 和 example.com 都有效

看一下[setcookie函数的php手册中的域定义](http://php.net/manual/en/function.setcookie.php)

**警告**：高级域 cookie 是有效的，并且可由所有较低级别的页面访问。Cookie for`example.com`也可以从中访问`mysubdomain.example.com`。

因此，如果不希望这样做，您应该区分 cookie 域。

* * *

恕我直言：

```
header("Location: https://" . $_SERVER["HTTP_HOST"] . $_SERVER["REQUEST_URI"]); 
```

与其发送标头，不如回显它以查看发生了什么...

# iphone - MPMoviePlayerViewController 不会播放较大的 mp4 文件

> ID：16179609
> 
> 赞同：0
> 
> 时间：2013-04-23T21:36:39.367
> 
> 标签：iphone, ios, objective-c, ipad, cocoa-touch

我所拥有的是 2 个链接，指向同一部​​电影的 2 个版本，一个是低清晰度的，另一个是高清晰度的，都是 .mp4 格式。

它可以很好地播放低清晰度，但是当我单击高清版本的链接时，电影播放器​​会弹出，就像它应该将自己解散回原始视图控制器一样。如果我再次单击它，它会起作用，但第一次尝试通常会失败。就像线程的某些事情正在进行并且成功与否。从我读到的内容来看，这是 ARC 的一个问题，但我似乎无法正确解决。

我想使用 MPMoviePlayerViewController 因为我喜欢它在默认情况下充当模式弹出窗口的方式。我尝试使用 MPMoviePlayerController 但您必须设置视图然后处理看起来的旋转。

我也没有在 Xcode 内的日志中收到任何崩溃或任何警告。

这是我的代码：

```
@interface VideoInfoViewController ()

@property (nonatomic, strong) MPMoviePlayerController *player;

@end

- (IBAction)playLowVideo:(id)sender {

    [self playVideoFromURL:[NSURL URLWithString:_video.video_url_low]];
}

- (IBAction)playHDVideo:(id)sender {

    [self playVideoFromURL:[NSURL URLWithString:_video.video_url_HD]];
}

- (void)playVideoFromURL:(NSURL *)url {

    MPMoviePlayerViewController *playerViewController = [[MPMoviePlayerViewController alloc] initWithContentURL:url];
    _player = playerViewController.moviePlayer; 
    _player.scalingMode = MPMovieScalingModeFill;
    [_player prepareToPlay];
    [self presentMoviePlayerViewControllerAnimated:playerViewController];
} 
```

预计到达时间：

找到本教程：http: [//josebolanos.wordpress.com/2011/09/28/dismissing-mpmovieplayerviewcontroller-the-right-way/](http://josebolanos.wordpress.com/2011/09/28/dismissing-mpmovieplayerviewcontroller-the-right-way/)

```
- (void)playVideoFromURL:(NSURL *)url {

    MPMoviePlayerViewController *player = [[MPMoviePlayerViewController alloc] initWithContentURL:url];
    [self presentModalViewController:player animated:YES];
    [player.moviePlayer prepareToPlay];
    [player.moviePlayer play];
} 
```

还是不行。

# batch-file - 报告未能删除到 DEL 批处理文件中的文件

> ID：16179611
> 
> 赞同：2
> 
> 时间：2013-04-23T21:36:45.893
> 
> 标签：batch-file, echo, delete-file

如何创建一个 DEL 命令未能正确执行的报告文件？

我原以为你会这样做：

```
DEL FILENAME.TXT ECHO "FILENAME.TXT" >> REPORT.TXT 
```

但它所做的只是创建一个空的报告文件，无论它是否找到 FILENAME.TXT。我想创建一个报告文件，如果由于某种原因无法删除 FILENAME.TXT，弹出的消息将被转储到 REPORT.TXT 中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-08-18T09:36:48.713

仅供您参考。如果发生严重错误， DEL 命令*确实会*返回错误代码，但是它的行为超出了我们的直觉，人们会简单地认为错误代码根本不起作用。

这是我在 Windows 7 的 DEL 命令中测试过的：

*   成功删除所有文件：0（当然）
*   删除了一些文件，丢失了一些文件：0（直觉预期为 1）
*   由于没有权限或只读介质导致删除失败：0（直觉期望≥1）
*   不存在的驱动器或驱动器未准备好（例如 CD-ROM 驱动器上没有 CD）：**1（是的，你明白了，但我会期待更高的错误代码）**
*   无效路径：**1（我也会期望更高的错误代码）**

并且，如果您为 DEL 命令指定一个文件列表，其中至少一个文件符合上述最后两种错误，则*列表中的任何文件都不会被删除*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T00:01:52.600

即使找不到文件或文件需要管理员访问权限，Del 命令总是返回错误代码 0，因此您需要在尝试删除文件后检查文件是否仍然存在：

```
@Echo OFF

Set "File=File.txt"

Del "%File%" 2>NUL & If exist "%File%" (
    Echo [+] File failed to delete: "%File%" >> "Report.txt" 
)

Pause&Exit 
```

对于大量文件，您可以创建一个不编写大代码的过程，如下所示：

```
@Echo OFF

Call :ReportDelete "C:\File1.txt"
Call :ReportDelete "C:\File2.txt"
Call :ReportDelete "C:\File3.txt"
Call :ReportDelete "C:\File4.txt"
Call :ReportDelete "C:\File5.txt"

Pause&Exit

:ReportDelete
(Del "%~1" 2>NUL & If exist "%~1" (Echo [+] File failed to delete: "%~1" >> "Report.txt")) & (Goto:EOF) 
```

# sql - Regexp_Replace 在 Oracle 中多次出现具有相同替换次数的字符

> ID：16179612
> 
> 赞同：3
> 
> 时间：2013-04-23T21:36:46.740
> 
> 标签：sql, regex, oracle, plsql

我需要一个正则表达式将字符串中的 0 替换为 O，如果它链接到一个单词，则只有 0。例如：

```
R0OSEVELT => ROOSEVELT
100 RO00SEVELT => 100 ROOOSEVELT
0RANGE10 => ORANGE10
PALT00OO = PLATOOOO 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T07:19:14.743

既然你已经用 sql 标记了这个问题，那么这是我能想出的代码。

```
REPLACE
   (search_string,
REGEXP_SUBSTR
   (search_string,
    '([[:alpha:]]+|^|[[:space:]])0+([[:alpha:]]+|$|[[:space:]])'
   ),
TRANSLATE
   (REGEXP_SUBSTR
       (search_string,
        '([[:alpha:]]+|^|[[:space:]])0+([[:alpha:]]+|$|[[:space:]])'
       ),
    '0',
    'O'
   )
   ) 
```

这是输出。它适用于您的输入案例。也许我错过了其他一些可能性。

```
R0OSEVELT --> ROOSEVELT
100 RO00SEVELT --> 100 ROOOSEVELT
0RANGE10 --> ORANGE10
PALT00OO --> PALTOOOO
RO00SEVELT 100 --> ROOOSEVELT 100
RANGE10 --> RANGE10
RANGE0 --> RANGEO 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T07:03:04.620

您没有指定单独存在的单个零会发生什么，但是：

```
sed -E 's/([[:alpha:]])?0([[:alpha:]])/\1O\2/g; s/([[:alpha:]])0([[:alpha:]])?/\10\2/g' 
```

将完成您指定的工作。如果第一个替换命令在两个字母字符之间或至少后跟一个字母字符（即单词开头），则第一个替换命令用字母“O”替换零。第二个对词尾也是如此。

# html - div不会堆叠

> ID：16179614
> 
> 赞同：0
> 
> 时间：2013-04-23T21:37:02.993
> 
> 标签：html, css

所以我读过关于 div 被堆叠的文章，许多帖子建议使用 clear: left; 但是当我这样做时，它“向左清除”所以不起作用。

当我放置 div 和当前的 css 样式时，我留下了位于地图 div 旁边的合法 div 以及与这两组仅堆叠的版权/设计 div 相同。

## 代码

```
<div id="footer">
<div id="footerLeft"></div>
<div id="footerMap"></div>
<div id="footerLegal"></div>
<div id="footerLinkedin"></div>
<div id="footerLeftPadding"></div>
<div id="footerFacebook"></div>
<div id="footerRightPadding"></div>
<div id="footerTwitter"></div>
<div id="footerCopyright"></div>
<div id="footerDesign"></div>
<div id="footerRight"></div>
</div> 
```

## CSS 代码

```
#footer {
float:left;
height: 50px;
width: 1200px;
}
#footerLeft{
float:left;
height: 50px;
width: 90px;
}
#footerMap{
float:left;
height: 25px;
width: 366px;
}
#footerLegal{
float:left;
height: 25px;
width: 366px;
}
#footerLinkedin{
float:left;
height: 50px;
width: 48px;
background-image:url(images/footer/web_page_footer_03.png);
background-repeat:no-repeat;
}
#footerLeftPadding{
float:left;
height: 50px;
width: 22px;
}
#footerFacebook{
float:left;
height: 50px;
width: 48px;
background-image:url(images/footer/web_page_footer_05.png);
background-repeat:no-repeat;
}
#footerRightPadding{
float:left;
height: 50px;
width: 22px;
}
#footerTwitter{
float:left;
height: 50px;
width: 48px;
background-image:url(images/footer/web_page_footer_07.png);
background-repeat:no-repeat;
}
#footerCopyright{
float:left;
height: 25px;
width: 366px;
background-image:url(images/footer/web_page_footer_08.png);
background-repeat:no-repeat;
}
#footerDesign{
float:left;
height: 25px;
width: 366px;
background-image:url(images/footer/web_page_footer_10.png);
background-repeat:no-repeat;
}
#footerRight{
float:left;
height: 50px;
width: 90px;
background-image:url(images/footer/web_page_footer_09.png);
background-repeat:no-repeat;
} 
```

# c# - GetRequestStream - 写入输出

> ID：16179615
> 
> 赞同：-2
> 
> 时间：2013-04-23T21:37:03.303
> 
> 标签：c#, compact-framework, http-post

我如何将原始 HTTP 帖子写入控制台窗口？我正在使用紧凑的框架 3.5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:45:53.113

如果您的目标是通过 HTTP 调试客户端-服务器通信，那么有一种比写入控制台更方便的方法，您可以使用 Fiddler。

# javascript - JS：滚动到元素时对元素应用焦点效果

> ID：16179618
> 
> 赞同：1
> 
> 时间：2013-04-23T21:37:15.887
> 
> 标签：javascript, jquery, html, css, scroll

这是小提琴：http: [//jsfiddle.net/fz5Yk/5/](http://jsfiddle.net/fz5Yk/5/)

我想要实现的只是在`<strong> </strong>`滚动到第 3 节时突出显示（例如添加背景颜色）第 3 节的标题（在标签中）。

我想知道当我在某个部分时是否有办法触发某些事件。这一定是有原因的，因为当您手动滚动页面时，您会注意到，在导航菜单中，指向该部分的链接会自动选择，就像它被单击一样。

任何有帮助的东西都将不胜感激，因为我从昨天开始一直在研究这个问题并且还没有解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:19:21.160

没有任何方法可以使用 CSS 实现这一点，所以我编辑了 jquery.nav.min.js。（仅添加 4 行）现在效果很好。[http://jsfiddle.net/fz5Yk/10/](http://jsfiddle.net/fz5Yk/10/)

```
adjustNav=function(a,b,d){
                var sec = a.find("."+d+">a").attr("href");
                $(sec+">strong").css('background','none'); //Find and remove previous highlight of strong  
                a.find("."+d).removeClass(d);b.addClass(d); //ORIGINAL

                sec = b.find("a").attr("href");
                $(sec+">strong").css('background','aqua'); //Find and highlight the strong
}; 
```

编辑：按请求添加的动画：http: [//jsfiddle.net/fz5Yk/11/](http://jsfiddle.net/fz5Yk/11/)

`animateSomething`在顶部添加功能：

```
function animateSomething(sec) {
    if(sec == "#section-2")
        $("#testBlock").animate({
            width:"50%",
            opacity:0.5
        }, 1500);
} 
```

在函数`animateSomething(sec);`末尾添加。 瞧！`adjustNav`

编辑最后：滚动结束后动画[http://jsfiddle.net/fz5Yk/12/](http://jsfiddle.net/fz5Yk/12/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T22:18:54.007

不确定这是否正是您想要的，但您可以使用`strong`它为当前视图中的每个添加一个类：

```
$(document).scroll(function(){
    var t = $(this).scrollTop();
    var b = t + $(this).height();
    $('.section>strong').removeClass('highlight').filter(function(){
        var ot = $(this).position().top;
        return ot > t && ot < b;
    }).addClass('highlight');
}); 
```

[http://jsfiddle.net/fz5Yk/7/](http://jsfiddle.net/fz5Yk/7/)

但这在我看来有点毫无意义，因为当它不在视野中时，为什么要删除突出显示？反正也看不出来！？

如果您真的只想要第 3 节的功能，您可以更改`$('.section>strong')`为`$('#section-3>strong')`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T22:09:38.590

在您的点击操作中有这样的内容：

```
$("#container .section strong").css('background-color', 'transparent');
$("#container .section strong:contains('" + $(this).text() + "')").css('background-color', 'yellow'); 
```

# android - FragmentManager 可以在 DialogFragment 中设置内容吗？

> ID：16179621
> 
> 赞同：0
> 
> 时间：2013-04-23T21:37:53.937
> 
> 标签：android, android-layout, android-fragments, android-dialogfragment

我目前有`Fragments`它们都放置在正常布局中并显示为`DialogFragments`. 每个 Fragment 都有自己的操作，其中大部分包括用另一个 Fragment 替换当前布局。

所以我想知道的是：可以`FragmentManager`在 DialogFragment 中设置布局内容`Window`吗？我不喜欢让 Fragment 检查它们是否是 DialogFragment 以确定下一个 Fragment 状态应该是什么的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T08:11:17.567

> FragmentManager 可以在 DialogFragment Window 中设置布局内容吗？

不，`FragmentManager`负责获取参考/使用片段。片段本身应该对它们的布局负责。

> 我不喜欢让 Fragment 检查它们是否是 DialogFragment 以确定下一个 Fragment 状态应该是什么的想法。

您可以通过 a 将布尔值传递给片段的任何新实例，`Bundle`以便片段从一开始就知道它所处的状态。

# facebook-graph-api - 分页中使用的游标是否有特定的寿命或超时？

> ID：16179625
> 
> 赞同：2
> 
> 时间：2013-04-23T21:38:14.910
> 
> 标签：facebook-graph-api, pagination

在关于[分页](https://developers.facebook.com/docs/reference/api/pagination/)的文档中有一节关于使用游标检查新内容。这意味着您可以存储光标并稍后返回以查看是否出现了新内容。游标是否在某个时间点超时或具有特定的寿命？如果我在浏览帖子评论时出现光标，该光标在一个小时、一天甚至一周后是否仍然有效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T18:27:57.060

根据文档，它将始终有效。

[http://developers.facebook.com/docs/reference/api/pagination/](http://developers.facebook.com/docs/reference/api/pagination/)

“光标分页是我们首选的分页方法，支持它的 Graph API 端点列表正在增长。光标指的是随机字符串，它标记数据列表中的特定点。您可以可靠地假设光标将始终指向列表的同一部分并使用它来翻阅数据。

如果您在收到游标时在 API 端点上使用其他过滤器，则此游标仅适用于使用这些过滤器的调用。”

**更新**

正如[Scutterman](https://stackoverflow.com/users/989477/scutterman)所指出的，这些游标也有生命周期。您应该在 1 天后丢弃它。“这些方法中使用的分页标记不应该在长期存在的应用程序中用作跳回流的一种方式。例如，将游标存储在数据库中，然后在几天后重新使用它们可能会返回陈旧的、不正确的，或者根本没有数据。确保你的光标相对新鲜——最多不到一天。”

更新：在某些时候，[文档](http://developers.facebook.com/docs/reference/api/pagination/)添加了信息点：

```
Don't store cursors. Cursors can quickly become invalid if items are added or deleted. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-14T22:52:13.670

[文档](https://developers.facebook.com/docs/graph-api/using-graph-api/v2.0#paging)中有一条注释：

> 光标不能长时间存储并且预计仍然可以工作。它们旨在在短时间内对结果集进行分页。

# mysql - 从类似名称的表中选择列

> ID：16179628
> 
> 赞同：1
> 
> 时间：2013-04-23T21:38:34.787
> 
> 标签：mysql, sql-like, tablename

我想从许多具有相似名称的表中选择一个特定的列，即：

表名称

x1

x2

x3

y1

y2

z1

smth like this : select `field`from like x%;

所有表都具有相同的结构和列名

# iphone - iPhone：应用程序能否检测到手机何时接听电话并返回应用程序？

> ID：16179633
> 
> 赞同：1
> 
> 时间：2013-04-23T21:39:00.977
> 
> 标签：iphone, ios, objective-c

我正在检查它

```
- (void)applicationWillEnterForeground:(UIApplication *)application 
```

当它回到应用程序时。

但是这个没有检测到用户何时拒绝呼叫。即使用户拒绝来电，是否仍然可以检测到？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T21:49:10.203

也许您可以使用以下通知，在您的情况下，第二个：

添加`CoreTelephony.framework`到您的项目并：

```
#import <CoreTelephony/CTCall.h>

   [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(callReceived:) name:CTCallStateIncoming object:nil];
   [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(callEnded:) name:CTCallStateDisconnected object:nil];
   [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(callConnected:) name:CTCallStateConnected object:nil]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T22:24:17.090

我认为您想要的是检测应用程序何时恢复活动状态。有两种委托方法：

applicationWillEnterForeground：告诉代理应用程序即将进入前台。

```
- (void)applicationWillEnterForeground:(UIApplication *)application 
```

和

applicationDidBecomeActive：告诉代理应用程序已激活。

```
- (void)applicationDidBecomeActive:(UIApplication *)application 
```

[UIApplicationDelegate 文档中的](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplicationDelegate_Protocol/Reference/Reference.html)更多信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:45:06.470

我不知道有什么方法可以判断呼叫何时被拒绝。但是当用户接到电话时会调用此方法：

```
 - (void)applicationWillResignActive:(UIApplication *)application {
} 
```

# api - 如何通过 FbGraph /me/inbox 获取原始消息的消息字段？

> ID：16179635
> 
> 赞同：0
> 
> 时间：2013-04-23T21:39:19.543
> 
> 标签：api, facebook-graph-api, message, inbox, subject

我正在尝试通过 API 从 /me/inbox 获取原始消息内容。我已经授权了 read_inbox 权限并得到了一堆消息对象。但是，每条消息都没有主题或消息（内容）。但它确实包含评论，其中包括评论列表和评论的消息内容。

这是权限问题吗？还是我使用的 API 错误？

下面的消息示例（出于隐私原因使用虚假内容。）

```
{
  "id": "97654321", 
  "to": {
    "data": [
      {
        "name": "Luke C.", 
        "id": "12346"
      }, 
      {
        "name": "Mark D.", 
        "id": "12345"
      }
    ]
  }, 
  "updated_time": "2013-01-31T19:10:17+0000", 
  "unread": 0, 
  "unseen": 0
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T19:01:02.670

在询问我已经使用 FBgraph api 一段时间的同事时。似乎 fbgraph 收件箱在一段时间内确实表现得像这样，而且似乎没有任何修复它的意图。而且我还注意到我/发件箱的行为与预期的一样

因此，我开始使用 FQL 来替换 me/inbox api：

```
SELECT body, recipients, sender, thread_id, message_id
FROM unified_message where thread_id IN 
(SELECT thread_id FROM unified_thread WHERE folder = 'inbox') 
```

如果有人知道为什么 FbGraph api 不起作用，请仍然帮助解决这个问题。

# c++ - C++ BOOST ForEach 与自定义宏

> ID：16179636
> 
> 赞同：2
> 
> 时间：2013-04-23T21:39:20.160
> 
> 标签：c++, boost, macros, iterator, boost-iterators

使用 BOOST 的 ForEach 和我自己的自定义 #define 宏来迭代容器有什么区别？

矿：

```
#define iterate(i,x)     for(typeof(x.begin()) i=x.begin();i!=x.end();++i)

boost:
#include <string>
#include <iostream>
#include <boost/foreach.hpp>

int main()
{
    std::string hello( "Hello, world!" );

    BOOST_FOREACH( char ch, hello )
    {
        std::cout << ch;
    }

    return 0;
} 
```

请解释哪种方法更好，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T17:07:46.430

第一个很大的区别是当你使用右值时，像这样：

```
vector<int> foo();

// foo() is evaluated once
BOOST_FOREACH(int i, foo())
{

}

// this is evaluated twice(once for foo().begin() and another foo().end())
iterate(i, foo())
{

} 
```

这是因为`BOOST_FOREACH`检测它是否是一个右值并制作一个副本（编译器可以忽略它）。

第二个区别是`BOOST_FOREACH`使用[Boost.Range](http://www.boost.org/doc/libs/1_53_0/libs/range/doc/html/index.html)来检索迭代器。这使得它可以很容易地扩展。所以它将适用于数组和`std::pair`.

第三个区别是你的宏会自动推断范围的类型，这在支持但不`iterate`支持的旧编译器上非常方便。但是，将适用于所有 C++03 编译器。`typeof``auto``BOOST_FOREACH`

# php - eBay API 返回 JSON 而不是 XML 格式

> ID：16179642
> 
> 赞同：1
> 
> 时间：2013-04-23T21:39:48.417
> 
> 标签：php, ebay-api

我正在尝试调用 eBay API 并以 XML 格式返回结果（我使用的是 PHP）。

在进行以下调用或什至在浏览器中导航到此 URL 时，响应总是以 JSON 或其他一些时髦的格式返回，而不是 XML：

```
http://svcs.ebay.com/services/search/FindingService/v1?SECURITY-APPNAME=[removed-for-security]&OPERATION-NAME=findItemsByKeywords&SERVICE-VERSION=1.12.0&RESPONSE-DATA-FORMAT=XML&callback=_cb_findItemsByKeywords&REST-PAYLOAD&keywords=$searchTerm&paginationInput.entriesPerPage=3 
```

有什么想法吗？

编辑：这是我收到的：

```
_cb_findItemsByKeywords({"findItemsByKeywordsResponse":[{"ack":["Success"],"version":["1.12.0"],"timestamp":["2013-04-23T21:41:13.474Z"],"searchResult":[{"@count":"3","item":[{"itemId":["261205412868"],"title":["Apple iPhone 4 - 32GB - Black (Unlocked) Smartphone"],"globalId":["EBAY-US"],"primaryCategory":[{"categoryId":["9355"],"categoryName":["Cell Phones & Smartphones"]}],"galleryURL":["http:\/\/thumbs1.ebaystatic.com\/m\/my0vy-RgnhVBALirMFhHCaA\/140.jpg"],"viewItemURL":["http:\/\/www.ebay.com\/itm\/Apple-iPhone-4-32GB-Black-Unlocked-Smartphone-\/261205412868?pt=Cell_Phones"],"productId":[{"@type":"ReferenceID","__value__":"99939964"}],"paymentMethod":["PayPal"],"autoPay":["false"],"postalCode":["97215"],"location":["Portland,OR,USA"],"country":["US"],"shippingInfo":[{"shippingServiceCost":[{"@currencyId":"USD","__value__":"0.0"}],"shippingType":["Free"],"shipToLocations":["US"],"expeditedShipping":["true"],"oneDayShippingAvailable":["false"],"handlingTime":["2"]}],"sellingStatus":[{"currentPrice":[{"@currencyId":"USD","__value__":"274.99"}],"convertedCurrentPrice":[{"@currencyId":"USD","__value__":"274.99"}],"sellingState":["Active"],"timeLeft":["P4DT23H13M47S"]}],"listingInfo":[{"bestOfferEnabled":["false"],"buyItNowAvailable":["false"],"startTime":["2013-04-23T20:55:00.000Z"],"endTime":["2013-04-28T20:55:00.000Z"],"listingType":["FixedPrice"],"gift":["false"]}],"returnsAccepted":["false"],"condition":[{"conditionId":["3000"],"conditionDisplayName":["Used"]}],"isMultiVariationListing":["false"],"topRatedListing":["false"]},{"itemId":["111054473885"],"title":["Apple iPhone 3GS - 16GB Black (AT&T) Smartphone (MB715LL\/A) With Original Box"],"globalId":["EBAY-US"],"primaryCategory":[{"categoryId":["9355"],"categoryName":["Cell Phones & Smartphones"]}],"galleryURL":["http:\/\/thumbs2.ebaystatic.com\/m\/mVzC6dpqIgRKIzrUTKqH2SA\/140.jpg"],"viewItemURL":["http:\/\/www.ebay.com\/itm\/Apple-iPhone-3GS-16GB-Black-AT-T-Smartphone-MB715LL-A-Original-Box-\/111054473885?pt=Cell_Phones"],"productId":[{"@type":"ReferenceID","__value__":"101828989"}],"paymentMethod":["PayPal"],"autoPay":["false"],"postalCode":["13323"],"location":["Clinton,NY,USA"],"country":["US"],"shippingInfo":[{"shippingType":["Calculated"],"shipToLocations":["US"],"expeditedShipping":["true"],"oneDayShippingAvailable":["false"],"handlingTime":["2"]}],"sellingStatus":[{"currentPrice":[{"@currencyId":"USD","__value__":"73.0"}],"convertedCurrentPrice":[{"@currencyId":"USD","__value__":"73.0"}],"bidCount":["38"],"sellingState":["Active"],"timeLeft":["P0DT0H0M42S"]}],"listingInfo":[{"bestOfferEnabled":["false"],"buyItNowAvailable":["false"],"startTime":["2013-04-16T21:41:55.000Z"],"endTime":["2013-04-23T21:41:55.000Z"],"listingType":["Auction"],"gift":["false"]}],"returnsAccepted":["false"],"condition":[{"conditionId":["3000"],"conditionDisplayName":["Used"]}],"isMultiVariationListing":["false"],"topRatedListing":["false"]},{"itemId":["111058640858"],"title":["Apple iPhone 4 - 16GB - Black (Verizon)"],"globalId":["EBAY-US"],"primaryCategory":[{"categoryId":["9355"],"categoryName":["Cell Phones & Smartphones"]}],"galleryURL":["http:\/\/thumbs3.ebaystatic.com\/m\/my0vy-RgnhVBALirMFhHCaA\/140.jpg"],"viewItemURL":["http:\/\/www.ebay.com\/itm\/Apple-iPhone-4-16GB-Black-Verizon-\/111058640858?pt=Cell_Phones"],"productId":[{"@type":"ReferenceID","__value__":"101787954"}],"paymentMethod":["PayPal"],"autoPay":["true"],"postalCode":["30213"],"location":["Fairburn,GA,USA"],"country":["US"],"shippingInfo":[{"shippingType":["Calculated"],"shipToLocations":["US"],"expeditedShipping":["true"],"oneDayShippingAvailable":["false"],"handlingTime":["2"]}],"sellingStatus":[{"currentPrice":[{"@currencyId":"USD","__value__":"150.0"}],"convertedCurrentPrice":[{"@currencyId":"USD","__value__":"150.0"}],"sellingState":["Active"],"timeLeft":["P2DT21H31M58S"]}],"listingInfo":[{"bestOfferEnabled":["false"],"buyItNowAvailable":["false"],"startTime":["2013-04-23T19:13:11.000Z"],"endTime":["2013-04-26T19:13:11.000Z"],"listingType":["FixedPrice"],"gift":["false"]}],"returnsAccepted":["false"],"condition":[{"conditionId":["3000"],"conditionDisplayName":["Used"]}],"isMultiVariationListing":["false"],"topRatedListing":["false"]}]}],"paginationOutput":[{"pageNumber":["1"],"entriesPerPage":["3"],"totalPages":["488589"],"totalEntries":["1465767"]}],"itemSearchURL":["http:\/\/www.ebay.com\/sch\/i.html?_nkw=iphone&_ddo=1&_ipg=3&_pgn=1"]}]}) 
```

不确定这是什么，因为我尝试将其验证为 JSON，但它返回说它无效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:42:29.513

你得到的格式是 JSONP。`&callback=_cb_findItemsByKeywords`从网址中删除。然后你会得到xml

这是为您提供 xml 的 url：

```
http://svcs.ebay.com/services/search/FindingService/v1?SECURITY-APPNAME=[removed-for-security]&OPERATION-NAME=findItemsByKeywords&SERVICE-VERSION=1.12.0&RESPONSE-DATA-FORMAT=XML&REST-PAYLOAD&keywords=$searchTerm&paginationInput.entriesPerPage=3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:43:00.387

添加`&responseencoding=XML`到末尾或 URL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:46:12.180

问：JSON 有什么问题 ;)？

回答你的问题：

> [http://developer.ebay.com/devzone/finding/Concepts/MakingACall.html](http://developer.ebay.com/devzone/finding/Concepts/MakingACall.html)
> 
> 默认情况下，XML 请求的调用响应采用 XML 格式，但如果需要，您可以指定 NV 或 JSON 作为响应格式。

以下是 eBay 网页上的示例：

```
http://svcs.ebay.com/services/search/FindingService/v1?
   OPERATION-NAME=findItemsByKeywords
   &SERVICE-VERSION=1.0.0
   &SECURITY-APPNAME=YourAppID
   &RESPONSE-DATA-FORMAT=XML
   &REST-PAYLOAD
   &keywords=harry%20potter%20phoenix 
```

这是你的例子：

```
http://svcs.ebay.com/services/search/FindingService/v1?
  SECURITY-APPNAME=[removed-for-security]
  &OPERATION-NAME=findItemsByKeywords
  &SERVICE-VERSION=1.12.0
  &RESPONSE-DATA-FORMAT=XML
  &callback=_cb_findItemsByKeywords
  &REST-PAYLOAD
  &keywords=$searchTerm&paginationInput.entriesPerPage=3 
```

最显着的区别似乎是您的回调。建议：丢掉它！

# php - 通过 mysqli::query 中的变量传递 null

> ID：16179646
> 
> 赞同：0
> 
> 时间：2013-04-23T21:40:12.653
> 
> 标签：php, mysqli

我有一个特殊情况需要使用 mysqli::query 而不是 mysqli::prepare。我正在尝试通过变量将 null 传递给存储过程。以下与准备好的语句一起使用：

```
$val = null;
$stmt = $this->db->prepare('CALL my_stored_procedure(?, ?)');
$stmt->bind_param('ii', $this->id, $val);
etc... 
```

不适用于查询：

```
$val = null;
$qry = $this->db->query("CALL my_stored_procedure($this->id, $val)");
etc... 
```

结果是：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '1, )' 
```

我可以明确地传递 null ok，但这对我没有好处。

同样，在这种情况下，我不能使用准备好的语句。有没有办法将 null 传递给 mysqli 查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:47:26.147

您不能使用以下语句：

```
$procedureArguments = '$this->id, ' . ( is_null($val) ? 'NULL' : $val );
$qry = $this->db->query('CALL my_stored_procedure(' . $procedureArguments . ')'); 
```

# java - Jar 文件未在右键单击上下文菜单中运行

> ID：16179647
> 
> 赞同：0
> 
> 时间：2013-04-23T21:40:19.073
> 
> 标签：java

我有一个 jar 应用程序，它运行良好，但是当我将它添加到 Windows 8 中的右键单击上下文菜单时。它说这个应用程序无法在您的电脑上运行的错误。如何处理这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:44:27.513

您必须在 jar 内的 META-INF 文件夹中指定文件`Main-Class`中的属性。`manifest.mf`请查看此[答案](https://stackoverflow.com/a/804885/201359)以获取详细信息。

# jquery - 通过 jquery 类更改应用动画

> ID：16179656
> 
> 赞同：1
> 
> 时间：2013-04-23T21:41:05.283
> 
> 标签：jquery, css, css-transitions

我正在尝试创建一个半透明的粘性 CSS 菜单，以允许通过它看到文本。当用户将鼠标悬停在菜单上时，我添加了一个`:hover {opacity:1;}`使其不透明，但是，这是一个相当“课程”的变化；对这些过渡进行动画处理会很棒，无论是在第一次变为透明时，然后在返回不透明时。

我使它工作的方式是`fixed`当窗口位置超出我的标题 div 的高度时，使用 jquery 向 body 标记添加一个类。[您可以在这里](http://jsfiddle.net/wright_jamie/sTCqq/)看到它的实际效果。

我假设悬停过渡是一个 css3 动画，但到目前为止我还不能让它工作。添加类引起的初始转换——我什至不知道从哪里开始！

任何帮助，将不胜感激。

**解决方案** CSS3 解决方案从下面标记的答案中提取和修改。我将过渡效果从`.fixed header nav`移至`header nav`。这会导致在`fixed`添加或删除类时动画工作。此处更新解决方案：[小提琴](http://jsfiddle.net/wright_jamie/veDU3/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:46:53.690

CSS：

```
body.fixed nav{
    position:fixed;
    top:0px;
    opacity:0.6;
    transition: 1s opacity;
    -webkit-transition: 1s opacity;
    -moz-transition: 1s opacity;
    width:100%;
}
body.fixed nav:hover{
    opacity:1;
    transition: 1s opacity;
    -webkit-transition: 1s opacity;
    -moz-transition: 1s opacity;
} 
```

小提琴：http: [//jsfiddle.net/sTCqq/1/](http://jsfiddle.net/sTCqq/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:51:26.343

您可以结合 jQuery`.hover()`和`.animate()`方法来执行此操作：

```
$('header').hover(function(){
   $(this).animate({
    opacity: 1 }, 1000);
}, function(){
    $(this).animate({
    opacity: 0.6 }, 1000);
}); 
```

[**Jsfiddle 示例**](http://jsfiddle.net/darkajax/kjNdh/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:59:30.833

您可以将 CSS 的特定部分修改为

```
.fixed
{
    header nav
    {
        transition: 0.5s opacity;
        -webkit-transition: 0.5s opacity;
        -moz-transition: 0.5s opacity;
        position:fixed;
        top:0px;
        opacity:0.6;
        width:100%;
        &:hover{opacity:1;}
    }
} 
```

[看到这个小提琴](http://jsfiddle.net/sTCqq/2/)演示

# java - 用 AES 腌制

> ID：16179657
> 
> 赞同：0
> 
> 时间：2013-04-23T21:41:16.687
> 
> 标签：java, encryption, cryptography, aes

我是一个加密新手，但需要在存储到数据库之前加密敏感的个人数据。我打算将 AES 与 CBC 一起使用，但也想使用盐。但是我找不到这样做的方法（除了 BouncyCastle，我的主机由于某种原因不准备允许）所以我决定自己添加一个，方法是在要加密的文本末尾添加一个随机字符串：

```
SecretKeySpec skeySpec = new SecretKeySpec(key, "AES");
byte[] iv = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
IvParameterSpec ivspec = new IvParameterSpec(iv);

Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");

cipher.init(Cipher.ENCRYPT_MODE, skeySpec, ivspec);

String plainText = "This is my plain text";
System.out.println("**plainText: " + plainText);

String saltedPlainText = plainText + UUID.randomUUID().toString().substring(0, 8);
byte[] encrypted = cipher.doFinal(saltedPlainText.getBytes());
String encryptedText = new String(new Hex().encode(encrypted));
System.out.println("**encryptedText: " + encryptedText);

cipher.init(Cipher.DECRYPT_MODE, skeySpec, ivspec);

byte[] decrypted = cipher.doFinal(new Hex().decode(encryptedText.getBytes()));
saltedPlainText = new String(decrypted);
plainText = saltedPlainText.substring(0, saltedPlainText.length()-8);

System.out.println("**plainText: " + plainText); 
```

我想我有3个问题：

1.  有没有更好的方法在我的加密中包含盐？
2.  在与此类似的示例中，似乎总是在开始时生成随机密钥，并且在加密后立即进行解密。这是一个不太可能发生的情况 - 所以我一直在每次都应该使用相同的密钥的基础上工作（看起来很简单，但我看到的所有示例似乎都是随机的）。看不到它还能如何工作，但有人可以确认:)
3.  使用固定密钥时，我注意到如果我继续加密相同的字符串，我会得到不同的结果，但只有加密结果的结尾部分会发生变化。似乎不对。怎么来的？

非常感谢，尼尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:46:57.040

加盐通常是在对密码进行哈希处理时完成的，而不是在加密明文时完成的；例如，当使用[PBEKeySpec](http://docs.oracle.com/javase/6/docs/api/javax/crypto/spec/PBEKeySpec.html)从密码生成密钥时，您将使用盐。AES 的“盐”是它的初始化向量。

您在加密相同的明文时得到相同的密文，因为您每次都使用相同的初始化向量 - 您需要随机化 IV（使用例如[SecureRandom](http://docs.oracle.com/javase/6/docs/api/java/security/SecureRandom.html)），否则您需要从计数器生成 IV。IV 不是秘密的（可以明文传输），解密器需要使用与加密器相同的 IV。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:51:46.810

为什么要在文本中添加盐？它不会做任何事情。

Salt通常用于散列密码，以击败彩虹表。像这样工作：假设用户输入密码“qwerty”。您生成一个 16 字节长的随机字符串 (rs)，将其添加到密码中，并对生成的字符串进行哈希处理，然后获取哈希值，将 rs 添加到其中 - 并将生成的字符串存储在数据库中。

# java - 阶乘程序打印出递归

> ID：16179664
> 
> 赞同：1
> 
> 时间：2013-04-23T21:41:44.737
> 
> 标签：java, recursion, factorial

我写了一个阶乘程序。我已经完成了整个程序，它运行没有任何问题。但是，我希望输出看起来像这样

```
Begin Factorial Program. . . 
Provide number and the factorial will be computed: 4
4! is . . . 
In f(4) and calling f(3) . . . 
In f(3) and calling f(2) . . . 
In f(2) and calling f(1) . . . 
In f(1) and calling f(0) . . . 
  In f(0) and computing f(0). Returning 1
f(1) is 1 * 1 which equals 1\. Returning 
f(2) is 2 * 1 which equals 2\. Returning 2
f(3) is 3 * 2 which equals 6\. Returning 6
f(4) is 4 * 6 which equals 24\. Returning 24
4! = 24 
```

我怎么得到。

```
f(1) is 1 * 1 which equals 1\. Returning 
f(2) is 2 * 1 which equals 2\. Returning 2
f(3) is 3 * 2 which equals 6\. Returning 6
f(4) is 4 * 6 which equals 24\. Returning 24 
```

用我的方法打印出来

这是我的方法

```
public static int factorial(int num) {
    if (num == 0) {
        System.out.println("In f(" + num + ") and computing f(" + num
                + "). Returning " + 1);
        return 1;
    } else {
        System.out.println("In f(" + num + ") and calling f(" + (num - 1)
                + ") . . .");

        return num * factorial(num - 1);
    } 
```

打印出来

```
4! is . . .
In f(4) and calling f(3) . . .
In f(3) and calling f(2) . . .
In f(2) and calling f(1) . . .
In f(1) and calling f(0) . . .
In f(0) and computing f(0). Returning 1
4! = 24 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:54:25.720

这样的事情应该可以解决问题：

```
public static int factorial(int num) {
    if (num == 0) {
        System.out.println("In f(0) and computing f(0). Returning 1");
        return 1;
    }

    System.out.printf("In f(%d) and calling f(%d) . . .%n", num,
                num - 1);  // #1

    int factorial = factorial(num - 1);
    int result = num * factorial;

    System.out.printf(
        "f(%1$d) is %1$d * %2$d which equals %3$d. Returning %3$d%n",
            num, factorial, result);  // #2

    return result;
} 
```

```
在 f(4) 并调用 f(3) 。. .
在 f(3) 并调用 f(2) 。. .
在 f(2) 并调用 f(1) 。. .
在 f(1) 并调用 f(0) 。. .
在 f(0) 和计算 f(0) 中。返回 1
f(1) 是 1 * 1，等于 1。返回 1
f(2) 是 2 * 1 等于 2。返回 2
f(3) 是 3 * 2 等于 6。返回 6
f(4) 是 4 * 6 等于 24。返回 24
24

```

请注意`factorial`递归调用是如何夹在两个打印语句之间的（我们通过将其存储在一个新变量中而不是使用其结果内联来做到这一点）。结果，所有第一个打印语句 ( `#1`) 在任何第二个打印语句 ( ) 之前执行`#2`，从而产生所需的格式。

此外，在这种情况下，`printf`更有意义，并且使事情更容易阅读/开发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:47:27.537

您直接返回，而不是让自己做出您要求的额外日志声明。您需要做的是设置一个等于返回值的变量，然后您可以打印出您的“Returning”语句，然后您可以返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:49:41.377

拿出你的“阶乘（num - 1）；” 从 return 语句调用并将其保存在临时变量中。

前任

```
int retVal = factorial(num-1)
System.out.println("I'm about to return "+retVal);
return retVal; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T22:09:06.670

```
public static int factorial(int num)
{
    int ret =0;
    if (num == 0)
    {
        System.out.println("In f(" + num + ") and computing f(" + num+ "). Returning " + 1);
        ret = 1;
    }
    else
    {
        System.out.println("In f(" + num + ") and calling f(" + (num - 1)+ ") . . .");
        int fact = factorial(num - 1);
        System.out.println("f("+num+") is "+num + " * "+fact + " which equals "+ num*fact+". Returning "+num*fact );
        ret = num*fact;
    }
    return ret;
} 
```

# jquery - php 和 xml 解析错误：解析错误，意外的 T_OBJECT_OPERATOR

> ID：16179666
> 
> 赞同：-3
> 
> 时间：2013-04-23T21:41:55.010
> 
> 标签：jquery, xml, ajax, php

我一直在处理一个涉及从 XML 文件读取的 PHP 页面。但是，我在第 24 行看到此错误消息：解析错误：解析错误，意外的 T_OBJECT_OPERATOR。但我不确定是什么导致了错误。所以我想知道是否有人能弄清楚我做错了什么。

```
<?php
if (!isset($_GET["searchstr"]))
    print "no Search String is provided! <br />";
else if (!isset($_GET["searchtype"]) || empty($_GET["searchtype"]))
    print "No Search type is selected!<br />";

    else 
{
    $searchstr = $_GET["searchstr"];
    $searchtype = $_GET["searchtype"];

    $xmlDoc = new DOMDocument();
    @ $success = $xmlDoc->load("books.xml");
    if (!$success)
        print "No XML book data on the server!";

else
{
    $books = $xmlDoc->getElementsByTagName("book");
    $num = 0;
    foreach ($books as $book)

        $title = $book->getElementsByTagName("title")->item(0)->firstChild->nodevalue;          
        $isbn13 = $book->getElementsByTagName("ISBN13")->item(0)->firstchild->nodevalue;
        $isbn10t = $book->getElementsByTagName("ISBN10");
        $isbn10 = "";
    if ($isbn10t->length > 0)
        $isbn10 = $isbn10t->item(0)->firstchild->nodevalue;

        $authors = $book->getElementsByTagName("author");
        $author = "";
        for ($j=0; $j<$authors->length; $j++)
        {

if ($j>0)
            {
                if ($j < $authors->length-1) $author .= ". ";
                else $author .= " and ";
            }
            $author .= $author->item($j)->getElementsByTagName("firstname")->item(0)->firstchild->nodevalue;
            $author .= " " . $authors->item($j)->getElementsByTagName("lastname")-item(0)->firstchild->nodevalue;
        }
        $desc = $book->getElementsByTagName("descritpion");
        $description = "";
        if ($desc->length > 0)
            $descreption = $desc->item(0)->firstchild->nodevalue;

        if (empty($searchstr)
        || searchtype == "title" && eregi($searchstr,$title)
        || $searchtype == "isbn" && (eregi($searchstr, $author)
        || $searchtype == "keyword" && (eregi($searchstr, $title) || eregi($searchstr, $description)

{
            $num++
            print "{$num}. Title: <a href=\"select.php?isbn={$isb13}\">{$title}</a><br />";
            print "Author: {$author}<br />"
            print "ISBN-13\. ";
            print $books->getElementsByTagName("ISBN13")->item(0)->firstchild->nodevalue."<br />";
            $isbn10 = $book->getElementsByTagName("ISBN10");
            if ($isbn10->length > 0)
            {
                print " ISBN-10: " . $isbn10->item(0)->firstchild-nodevalue. "<br />";
            }
            print "Price: $";
            print $book->getElementsByTagName("price")->item(0)->firstchild->nodevalue. "<br />";
            print "<br />"
        }
        if ($num == 0)
            print "no book is found!";  
    }

}
}

?> 
```

这是我正在使用的 XML 代码示例

```
<book id="1"> 
    <title>Beginning ASP.NET 4 in C# 2010</title> 
    <authors> 
      <author> 
        <lastname>MacDonald</lastname> 
        <firstname>Matthew</firstname> 
      </author> 
    </authors> 
    <ISBNs> 
      <ISBN13>9781430226086</ISBN13> 
      <ISBN10>1430226080</ISBN10> 
    </ISBNs> 
    <publisher>Apress</publisher> 
    <publishdate>2010-05</publishdate> 
    <pages>981</pages> 
    <price>49.99</price> 
    <description>This book discusses ASP.NET programming in C# with Visual Studio 2010.</description> 
  </book> 
```

这是搜索页面的代码，PHP页面之前的页面；

```
 <!DOCTYPE html>
<html>
<head>
    <title>Textbook Buyer</title>
    <link href="styles.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript">

    function doSearch()
    {
        var searchstr = document.getElementById("searchstr").value;
        var searchtype = document.getElementById("searchtype").value;

        $.ajax
        ({
            type: "GET",
            url: "searchlist.php?searchstr=" + searchstr + "&searchtype=" + searchtype,
            success: function(sText, sStatus, oXHR) 
            {
                $("div#results").html(sText);
            },
            error: function (oXHR, sStatus, sError) 
            {
                $("div#results").html("An error occurred.");
            }
        });
    }   

    </script>
</head>
<body>
    <table>
     <tr>
       <td class="header" colspan="5">Textbook Buyer</td>
     </tr>
     <tr>
       <td id="td1" colspan="5">
       | <a href="welcome.php">Welcome</a> 
       | <a href="bestsellers.php">Bestsellers</a>
       | <a href="hotdeals.php">Hot Deals</a>
       | <a href="bookstores.php">Bookstores</a>
       | <a href="myaccout.php">My Account</a>
       | <a href="help.php">Help</a>
       |</td>
     </tr>
     <tr>
       <td class="column">
        <strong>Browse Textbooks<br />
        by Category:</strong><br />
        <br />
        Business -<br />
        Computer Science -<br />
        History -<br />
        Mathematics -<br />
        Medical -<br />
        Social Science  -<br />
       </td>
       <td class="td2"></td>
       <td id="td3">
        <div id="searchBox"> <br />
          <input type="text" id="searchstr" size="30" />
          <select id="searchtype">
            <option value="title" selected="selected">Title</option>
            <option value="author">Author</option>
            <option value="isbn">ISBN</option>
            <option value="keyword">Keyword</option>
          </select>
          <br />
           <input type="button" id="searchButton" value="Search" onClick="doSearch();" /><br />

        </div>
        <div id="results"></div>
       </td>
       <td class="td2"></td>
       <td class="column">
        <strong>Customer Support:</strong><br />
        <br />
        Order Status<br />
        Customer Service <br /><br />
        <a href="search.php">Search Books</a>
       </td>
     </tr>
     <tr>
       <td id="td5" colspan="5">&copy; Copyright 2013, Textbook Buyer, Inc. All rights reserved.
       </td>
     </tr>
    </table>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:17:53.910

此代码中有几个语法错误：

```
foreach ($books as $book) // this is invalid given the lines below it and the lines at 
// the end of the page.  You forgot to open this:

foreach ($books as $book) { //this is what it should be.

$author .= $author->item($j)->getElementsByTagName("firstname")->item(0)->firstchild->nodevalue;
$author .= " " . $authors->item($j)->getElementsByTagName("lastname")-item(0)->firstchild->nodevalue;

$isbn10 = $isbn10t->item(0)->firstchild->nodevalue;

$descreption = $desc->item(0)->firstchild->nodevalue;

print $books->getElementsByTagName("ISBN13")->item(0)->firstchild->nodevalue."<br />";
//         ^ not to mention, you need to delete this S      ^   and    ^ both need to be upper-case

// The above lines(and pretty much every single instance in which you use those two
// methods) are using an incorrect property.  nodevalue should be nodeValue,
// firstchild should be firstChild.  The capital C/V makes all the difference.

$num++
   // ^ no semi-colon

print "Author: {$author}<br />"
                            // ^ no semi-colon

print "<br />"
         //   ^ again, no semi-colon

// the below..

$author .= $author->item($j)->getElementsByTagName("firstname")->item(0)->firstchild->nodevalue;

//should be this:

$author .= $authors->item($j)->getElementsByTagName("firstname")->item(0)->firstchild->nodevalue;
//                ^ notice the s here

$author .= " " . $authors->item($j)->getElementsByTagName("lastname")-item(0)->firstchild->nodevalue;
//                                                                    ^ forgot a key character, the > 
```

这个：

```
if (empty($searchstr)
    || searchtype == "title" && eregi($searchstr,$title)
    || $searchtype == "isbn" && (eregi($searchstr, $author)
    || $searchtype == "keyword" && (eregi($searchstr, $title) || eregi($searchstr, $description) 
```

应该类似于..（记得关闭你`()`的 s）（这主要是猜测，因为我不知道这段代码的目的）：

```
if (empty($searchstr)
    || searchtype == "title" && eregi($searchstr,$title)
//    ^ forgot the $ here, unless you have a constant called 'searchtype'
    || $searchtype == "isbn" && (eregi($searchstr, $author))
    || $searchtype == "keyword" && (eregi($searchstr, $title) || eregi($searchstr, $description))) 
```

最后，就在这里：

```
print " ISBN-10: " . $isbn10->item(0)->firstchild-nodevalue . "<br />";
// The C and V need to be upper case and          ^ you forgot the > 
```

修复所有这些错误后，代码对我来说可以正常工作。

# php - PHP - 格式化日期到 UNIX 到 iCal

> ID：16179669
> 
> 赞同：1
> 
> 时间：2013-04-23T21:41:58.517
> 
> 标签：php, date, icalendar, strtotime

我正在尝试将我存储的日期`2013-04-23 19:00`格式化为 iCal 格式：`20130423T190000`. 这是我正在尝试的方法：

```
$start = strtotime($event["event_start"]);
$start = date('Ymd\THis',$start); 
```

此代码返回`19691231T190000`.

我认为因为起始字符串缺少秒数，这可能是问题所在，但在尝试后`$start = strtotime($event["event_start"] . ":00");`我已经排除了这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:53:52.367

c你似乎遗漏了什么。您确定 $event["event_start"] 已填充。

```
date('Ymd\THis',strtotime('2013-04-23 19:00')) == 20130423T190000 
```

**尽管**

```
date('Ymd\THis',strtotime('')) == 19691231T190000 
```

检查 $event["event_start"] 的值。

**编辑：** 提示是 1969 年可疑地接近 1970 年的 UNIX 时代。

FROM marc b -> 不同的是 UTC +5 的时区

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:44:26.530

尝试这个：

```
$str = "DTSTART;TZID=<your timezone>:".date('Ymd', strtotime($start)); 
```

看：

[http://php.net/manual/en/timezones.php](http://php.net/manual/en/timezones.php)

# apache-flex - 如何检测 Flex Spinner 中的递增或递减按钮？

> ID：16179670
> 
> 赞同：0
> 
> 时间：2013-04-23T21:42:05.940
> 
> 标签：apache-flex, spinner

如何检测是否在 Flex Spinner 组件中单击了递增或递减按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T08:15:24.067

numericStepper 创建完成后，获取按钮并监听事件：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600">
    <fx:Script>
        <![CDATA[
            import mx.controls.Alert;
            import mx.events.FlexEvent;

            protected function numericstepper1_creationCompleteHandler(event:FlexEvent):void
            {
                var stepper:NumericStepper = NumericStepper(event.target);

                stepper.incrementButton.addEventListener(MouseEvent.CLICK, onIncrementClickHandler, false, 0, true);
                stepper.decrementButton.addEventListener(MouseEvent.CLICK, onDecrementClickHandler, false, 0, true);
            }

            protected function onIncrementClickHandler(event:MouseEvent):void
            {
                Alert.show("incrementButton click");    
            }

            protected function onDecrementClickHandler(event:MouseEvent):void
            {
                Alert.show("decrementButton click");        
            }

        ]]>
    </fx:Script>

    <s:NumericStepper creationComplete="numericstepper1_creationCompleteHandler(event)" />

</s:Application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T23:12:08.310

您可以侦听[更改](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/Spinner.html#event%3achange)事件以判断项目何时更改。当然，单击递增或递减按钮并不是判断值何时发生变化的唯一方法。

incrementButton 和 decrementButton 都是[皮肤部件](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/Spinner.html#SkinPartSummary)。由于皮肤部件是公开的，您可以为按钮[单击](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/InteractiveObject.html#event%3aclick)事件添加事件侦听器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:12:56.997

```
protected function spinnerClick(event:MouseEvent):void
{
    Alert.show(event.target.id);
    // will show 'incrementButton' or 'decrementButton' 
}

<s:Spinner click="spinnerClick(event)"/> 
```

# maven - 让 Play/SBT 应用程序依赖于 Maven POM

> ID：16179671
> 
> 赞同：6
> 
> 时间：2013-04-23T21:42:16.867
> 
> 标签：maven, playframework-2.0, sbt

我的 Play 2 应用程序是一个更大的 Maven 应用程序的子项目。Play 2 应用程序在其父级中具有依赖项 - 它从中获取数据访问权限。因此，我希望应用程序的构建依赖于外部 Maven 项目。

基本上，我想写这个：

```
val main = play.Project(appName, appVersion, appDependencies).settings(
   // settings
).dependsOn(externalPom(baseDirectory(_ / "../pom.xml"))) 
```

但这当然不是有效的语法。

我试过这样定义我`play.Project`的：

```
val main = play.Project(appName, appVersion, appDependencies).settings(
   externalPom(baseDirectory(_ / "../pom.xml"))
) 
```

失败是因为（我认为）覆盖导致 Play 不加载自己的异常

我试过`Project`像这样定义一个新的：

```
lazy val data = Project("data", file(baseDirectory(_ / "..).settings(
   externalPom(baseDirectory(_ /         "../pom.xml"))
) 
```

并且取决于此，这不起作用，因为没有检测到主类。

关于如何做到这一点的任何建议？我是 SBT 的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T15:21:49.130

我成功使用 play2-maven-plugin

[http://nanoko-project.github.io/maven-play2-plugin/maven/release/](http://nanoko-project.github.io/maven-play2-plugin/maven/release/)

使用此插件，您还可以为 play2 应用程序创建 maven 模块，并在 maven pom.xml 中定义依赖项（您的数据访问层）。该插件将确保 play 获取依赖项（它将 pom 依赖项复制到 lib 目录中的非托管依赖项中）。

使用这个插件还可以避免许多繁琐的重新构建，因为您在一个项目中拥有一切，因此您的 IDE 无需重新构建即可看到所有模块的更改。

此外，当您使用该插件时，您不会遇到从本地 maven 存储库更新快照 maven 依赖项的问题（此 sbt 错误[https://github.com/sbt/sbt/issues/321](https://github.com/sbt/sbt/issues/321)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-18T15:34:30.787

我只是用[play2-maven-plugin](https://code.google.com/p/play2-maven-plugin/)和[sbt-pom-reader](https://github.com/sbt/sbt-pom-reader)做到了这一点。

这是您需要配置 play2-maven 项目的方式：

```
<my-maven-project>/
  pom.xml                  <- Your maven build
  build.sbt                <- the sbt Play 2 configuration
  project/
     build.properties      <- the sbt version specification
     build.scala           <- the sbt build definition
     plugins.sbt           <- the sbt plugin configuration

  ..                       <- Whatever files are normally in your maven project. 
```

每个文件应具有以下内容。

pom.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>org.foo</groupId>
    <artifactId>bar</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <packaging>play2</packaging>
    <name>My mavenified Play 2 application</name>
    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
        <play2.version>2.2.1</play2.version>
        <play2-scala.version>2.10</play2-scala.version>
        <play2.plugin.version>1.0.0-alpha5</play2.plugin.version>
        <scala.version>2.10.2</scala.version>
    </properties>
    <repositories>
        <repository>
            <id>typesafe</id>
            <name>Typesafe - releases</name>
            <url>http://repo.typesafe.com/typesafe/releases/</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
    </repositories>
    <dependencies>
        <dependency>
            <groupId>org.scala-lang</groupId>
            <artifactId>scala-library</artifactId>
            <version>${scala.version}</version>
        </dependency>
        <dependency>
            <groupId>com.typesafe.play</groupId>
            <artifactId>play_${play2-scala.version}</artifactId>
            <version>${play2.version}</version>
        </dependency>
        <!-- only if using Java -->
        <dependency>
            <groupId>com.typesafe.play</groupId>
            <artifactId>play-java_${play2-scala.version}</artifactId>
            <version>${play2.version}</version>
        </dependency>
    </dependencies>
    <build>
        <sourceDirectory>${basedir}/app</sourceDirectory>
        <resources>
            <resource>
                <directory>${basedir}/conf</directory>
            </resource>
            <resource>
                <directory>${basedir}</directory>
                <includes>
                    <include>public/**</include>
                </includes>
            </resource>
        </resources>
        <!--<outputDirectory>target/scala-${play2-scala.version}/classes</outputDirectory>-->
        <plugins>
            <plugin>
                <groupId>com.google.code.play2-maven-plugin</groupId>
                <artifactId>play2-maven-plugin</artifactId>
                <version>${play2.plugin.version}</version>
                <extensions>true</extensions>
                <dependencies>
                    <dependency>
                        <groupId>com.google.code.play2-maven-plugin</groupId>
                        <artifactId>play2-provider-play22</artifactId>
                        <version>${play2.plugin.version}</version>
                    </dependency>
                </dependencies>
                <!-- only if using Java -->
                <configuration>
                    <mainLang>java</mainLang>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project> 
```

构建.sbt：

```
play.Project.playJavaSettings //or play.Project.playScalaSettings 
```

项目/build.properties：

```
sbt.version=0.13.0 
```

项目/build.scala：

```
object BuildFromMavenPomSettings extends com.typesafe.sbt.pom.PomBuild 
```

项目/plugins.sbt：

```
addSbtPlugin("com.typesafe.play" % "sbt-plugin" % "2.2.1")

addSbtPlugin("com.typesafe.sbt" % "sbt-pom-reader" % "1.0.1") 
```

# android - Robolectric：如何测试包含 SherlockFragment 的活动？

> ID：16179675
> 
> 赞同：6
> 
> 时间：2013-04-23T21:42:36.867
> 
> 标签：android, android-fragments, actionbarsherlock, robolectric

我一直在阅读这里、github 和 robolectric 博客的很多链接，但还没有找到可行的解决方案（已经使用 Robolectric 2.0 alpha 2）。

**更新：**即使我们替换`SherlockFragment`为`android.support.v4.app.Fragment`.

[遵循此提示](http://robolectric.blogspot.com.br/2013/03/using-actionbarsherlock-with.html)后，我能够测试 SherlockFragmentActivity ，但是当我将此片段（即 SherlockFragment）添加到我的活动 xml 时：

```
<fragment 
    android:name="com.marcelopazzo.fragmentapplication.ExampleFragment" 
    android:id="@+id/example_fragment"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" /> 
```

SherlockFragment 类：

```
public class ExampleFragment extends SherlockFragment {

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        return inflater.inflate(R.layout.example_fragment, container, false);
    }
} 
```

这是被片段夸大的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/hello_again"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/hello_again" />

</LinearLayout> 
```

我收到以下错误：

```
java.lang.NullPointerException
    at org.robolectric.shadows.ShadowViewGroup.addView(ShadowViewGroup.java:69)
    at android.view.ViewGroup.addView(ViewGroup.java)
    at org.robolectric.res.builder.LayoutBuilder.constructFragment(LayoutBuilder.java:150)
    at org.robolectric.res.builder.LayoutBuilder.create(LayoutBuilder.java:104)
    at org.robolectric.res.builder.LayoutBuilder.doInflate(LayoutBuilder.java:42)
    at org.robolectric.res.builder.LayoutBuilder.doInflate(LayoutBuilder.java:45)
    at org.robolectric.res.builder.LayoutBuilder.inflateView(LayoutBuilder.java:62)
    at org.robolectric.shadows.ShadowLayoutInflater.inflate(ShadowLayoutInflater.java:50)
    at org.robolectric.shadows.ShadowLayoutInflater.inflate(ShadowLayoutInflater.java:55)
    at android.view.LayoutInflater.inflate(LayoutInflater.java)
    at com.squareup.test.ActionBarSherlockRobolectric.setContentView(ActionBarSherlockRobolectric.java:38)
    at com.actionbarsherlock.app.SherlockFragmentActivity.setContentView(SherlockFragmentActivity.java:262)
    at com.marcelopazzo.fragmentapplication.MainActivity.onCreate(MainActivity.java:13)
    at com.marcelopazzo.fragmentapplication.MainActivityTest.setUp(MainActivityTest.java:33)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
    at org.robolectric.RobolectricTestRunner$2.evaluate(RobolectricTestRunner.java:110)
    at org.junit.runners.BlockJUnit4ClassRunner.runNotIgnored(BlockJUnit4ClassRunner.java:79)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:71)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:234)
    at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:133)
    at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:114)
    at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:188)
    at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:166)
    at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:86)
    at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:101)
    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:74) 
```

这是我正在使用的测试类：

```
@RunWith(RobolectricTestRunner.class)
public class MainActivityTest {

    private MainActivity activity;
    private TextView textView;

    public static final String GREETINGS = "Hello world!";  

    @Before
    public void setUp() {

        ActionBarSherlock.registerImplementation(ActionBarSherlockRobolectric.class);
        ActionBarSherlock.unregisterImplementation(ActionBarSherlockNative.class);
        ActionBarSherlock.unregisterImplementation(ActionBarSherlockCompat.class);

        activity = new MainActivity();
        activity.onCreate(null);

        textView = (TextView) activity.findViewById(R.id.hello);
    }

    @Test
    public void shouldGreet() {
        assertEquals(GREETINGS, textView.getText());
    }
} 
```

该应用程序在设备上运行良好。

我在这里想念什么？

ps：完整的源码在[github上](https://github.com/marcelopazzo/RobolectricSample)

编辑：还使用 square/master (2.0 alpha 3 square 5) 分支的代码进行了测试，并遇到了同样的问题。检查`LayoutBuilder.constructFragment`，我认为问题在于`activity.getSupportFragmentManager().beginTransaction().add(fragment, tag).commit()`不与 SherlockFragment 一起使用，因此`fragment.getView()`返回 null。

我不确定我是否可以做任何事情来解决这个问题......我已经在检查我是否可以在 robolectric 方面解决它，如果有人对此有任何提示，请告诉我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-11T00:42:46.943

您可以尝试使用 Robolectric 2.0 的新 ActivityController，它修复了一些经常出现的调度/操作顺序问题。

```
MainActivity activity = Robolectric.buildActivity(MainActivity.class)
                                    .create().get(); 
```

它安排主循环器在调用 onCreate() 期间暂时暂停。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-30T11:55:12.743

打电话

```
Robolectric.buildActivity(YourActivityClass.class).attach().create().start().resume().get(); 
```

将调用您的 Fragment.onCreateView 方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T18:36:23.867

我对这个解决方案不满意，但有一种方法可以让它发挥作用：

该方法`fragment.getView()`返回 null 因为`onCreateView`我的 Fragment 从未调用过。它应该由`moveToState`from的方法调用`android.support.v4.app.FragmentManager`，但不是因为`f.mFromLayout`是假的。

```
f.mActivity = mActivity;
f.mFragmentManager = mActivity.mFragments;
f.mCalled = false;
f.onAttach(mActivity);
if (!f.mCalled) {
    throw new SuperNotCalledException("Fragment " + f
    + " did not call through to super.onAttach()");
}
mActivity.onAttachFragment(f);

if (!f.mRetaining) {
    f.mCalled = false;
    f.onCreate(f.mSavedFragmentState);
    if (!f.mCalled) {
        throw new SuperNotCalledException("Fragment " + f
        + " did not call through to super.onCreate()");
    }
}
f.mRetaining = false;
if (f.mFromLayout) {
    // For fragments that are part of the content view
    // layout, we need to instantiate the view immediately
    // and the inflater will take care of adding it.
    f.mView = f.onCreateView(f.getLayoutInflater(f.mSavedFragmentState),
    null, f.mSavedFragmentState);
    if (f.mView != null) {
    f.mInnerView = f.mView;
    f.mView = NoSaveStateFrameLayout.wrap(f.mView);
    if (f.mHidden) f.mView.setVisibility(View.GONE);
        f.onViewCreated(f.mView, f.mSavedFragmentState);
    } else {
        f.mInnerView = null;
    }
} 
```

因此，如果您将此代码块添加到您的片段`onCreate`方法中，它将起作用。

```
Field field = Fragment.class.getDeclaredField("mFromLayout");
field.setAccessible(true);
field.setBoolean(this, true);
field.setAccessible(false); 
```

正如我所说，这不是一个真正的解决方案，而是一种在有人找到合适的解决方案之前让它发挥作用的方法。

[更新] 此方法不适用于 Robolectric 2.0 Final

# c++ - 基于 Windows Hook 的调用 - 潜在的 GDI 泄漏

> ID：16179676
> 
> 赞同：0
> 
> 时间：2013-04-23T21:42:38.460
> 
> 标签：c++, gdi+, memory-leaks

我正在尝试调用我自己的函数 - 从我无法控制的程序中 - 使用钩子在程序的同一窗口上进行绘制。它工作了一段时间，但随后崩溃让我认为这可能是 GDI 泄漏左右。想知道是否有人可以查看此代码并可以从通用结构的角度发表评论以及任何可以改进的地方。我遇到的第二个问题是文本每隔几秒钟就会闪烁一次。任何人都可以在这方面提供帮助吗？请注意，在 C++ GDI 方面，我仍然是初学者。谢谢。

```
void Paint(HWND hWnd)
{
    HDC hdc = GetWindowDC(hWnd);
    HBRUSH Brush = CreateSolidBrush(RGB(255,255,0));
    HPEN   Pen = CreatePen(PS_DOT,1,RGB(255,255,0));
    HGDIOBJ PriorBrush = SelectObject(hdc, Brush);
    HGDIOBJ PriorPen = SelectObject(hdc, Pen);

    Gdiplus::Graphics g(hdc);
    Gdiplus::Pen pen(Gdiplus::Color(255, 255, 0, 0), 1);
    g.DrawLine(&pen,fpx,fpy,spx,spy);
    Font font(&FontFamily(L"Arial"), 12);
    LinearGradientBrush brush(Rect(0,0,100,100), Color::Red, Color::Yellow, LinearGradientModeHorizontal);
    Status st = g.DrawString(L"SampleText!", -1, &font, PointF((float)spx, (float)spy), &brush);
    assert(st == Ok);

    SelectObject(hdc,PriorBrush);
    SelectObject(hdc,PriorPen);
    ReleaseDC(hWnd,hdc);
    return;
} 
```

//

使用以下方法进行上述调用：

```
 case WM_PAINT:
    {
        LRESULT l = CallWindowProc(hook, hWnd, uMsg, wParam, lParam);
        Paint(hWnd);
        return l;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:44:35.180

您正在泄漏`Brush`-`Pen`您需要`DeleteObject`在从 DC 中选择它们后使用。

（或者摆脱它们——它们甚至被使用过吗？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T22:03:43.587

这段代码现在看起来不错吗？谢谢

```
void Paint(HWND hWnd)
{
     HDC hdc = GetWindowDC(hWnd);

Gdiplus::Graphics g(hdc);
Gdiplus::Pen pen(Gdiplus::Color(255, 255, 0, 0), 1);
g.DrawLine(&pen,fpx,fpy,spx,spy);
Font font(&FontFamily(L"Arial"), 12);
LinearGradientBrush brush(Rect(0,0,100,100), Color::Red, Color::Yellow, LinearGradientModeHorizontal);
Status st = g.DrawString(L"SampleText!", -1, &font, PointF((float)spx, (float)spy), &brush);
assert(st == Ok);

DeleteObject(&pen);
DeleteObject(&brush);

ReleaseDC(hWnd,hdc);
return;
} 
```

# c - OpenSSL文件加密麻烦

> ID：16179679
> 
> 赞同：1
> 
> 时间：2013-04-23T21:43:04.427
> 
> 标签：c, file, encryption, openssl

我目前正在为我的班级开发 SSL 加密的 VFS 文件系统，但在文件加密方面遇到了一些问题。他们为我们提供的示例需要两个文件，输入和输出，其中输入文件文本被读取、加密并作为加密文件写入输出。但是，对于分配，我们需要获取单个输入文件并对该文件本身进行加密，而不是返回加密的输出。

我在下面编写了这段代码，试图获取所有加密文本并将其存储在缓冲区中，然后用保存在缓冲区中的加密文本覆盖输入文件。在将缓冲区写入输入文件的最后一个 for 循环中，我在代码中遇到了段错误。当count = 4时发生段错误；z 等于 3。我认为它正在发生，因为我以某种方式错误地存储了数据，但是我似乎无法在这里指出确切的问题。

任何帮助，将不胜感激。

这是代码。

```
#define BLOCKSIZE 1024
#define FAILURE 0
#define SUCCESS 1

extern int do_crypt(FILE* in, int action, char* key_str){
    /* Local Vars */

    /* Buffers */
    unsigned char inbuf[BLOCKSIZE];
    int inlen;
    int z;
    int count = 0;
    /* Allow enough space in output buffer for additional cipher block */
    unsigned char outbuf[BLOCKSIZE + EVP_MAX_BLOCK_LENGTH];
    unsigned char **storebuf = malloc((BLOCKSIZE + EVP_MAX_BLOCK_LENGTH)*20);

    int outlen;
    //int writelen;

    /* OpenSSL libcrypto vars */
    EVP_CIPHER_CTX ctx;
    unsigned char key[32];
    unsigned char iv[32];
    int nrounds = 5;

    /* tmp vars */
    int i;

    /* Setup Encryption Key and Cipher Engine if in cipher mode */
    if(action >= 0){
    if(!key_str){
        /* Error */
        fprintf(stderr, "Key_str must not be NULL\n");
        return 0;
    }
    /* Build Key from String */
    i = EVP_BytesToKey(EVP_aes_256_cbc(), EVP_sha1(), NULL,
               (unsigned char*)key_str, strlen(key_str), nrounds, key, iv);
    if (i != 32) {
        /* Error */
        fprintf(stderr, "Key size is %d bits - should be 256 bits\n", i*8);
        return 0;
    }
    /* Init Engine */
    EVP_CIPHER_CTX_init(&ctx);
    EVP_CipherInit_ex(&ctx, EVP_aes_256_cbc(), NULL, key, iv, action);
    }    

    /* Loop through Input File*/
    for(;;){
    /* Read Block into inbuf */

    inlen = fread(inbuf, sizeof(*inbuf), BLOCKSIZE, in);
    if(inlen <= 0){
        /* EOF -> Break Loop */
        break;
    }

    /* If in encrypt/decrypt mode, perform cipher transform on block */
    if(action >= 0){
        /*set up ctx with passed params */
        if(!EVP_CipherUpdate(&ctx, outbuf, &outlen, inbuf, inlen))
        {
            /* Error */
            EVP_CIPHER_CTX_cleanup(&ctx);
            return 0;
        }
    }
    /* If in pass-through mode. copy block as is */
    else{
        memcpy(outbuf, inbuf, inlen);
        outlen = inlen;
    }

    storebuf[count] = malloc(outlen*sizeof(*outbuf));
    memcpy(storebuf[count], outbuf, outlen);
    /* Write Block */
    //writelen = fwrite(outbuf, sizeof(*outbuf), outlen, out);//THIS LINE
    if(storebuf[count] == NULL){
        /* Error */
        perror("malloc error");
        EVP_CIPHER_CTX_cleanup(&ctx);
        return 0;
    }
    count++;

    }
    count++;
    /* If in cipher mode, handle necessary padding */
    if(action >= 0){
    /* Handle remaining cipher block + padding */
    if(!EVP_CipherFinal_ex(&ctx, outbuf, &outlen))
        {
        /* Error */
        EVP_CIPHER_CTX_cleanup(&ctx);
        return 0;
        }
    /* Write remaining cipher block + padding*/
    //fwrite(outbuf, sizeof(*inbuf), outlen, out);
    storebuf[count] = malloc(outlen*sizeof(*inbuf));
    memcpy(storebuf[count], outbuf, inlen);
    EVP_CIPHER_CTX_cleanup(&ctx);
    }
    printf("%d, %s", count, storebuf[count]);

    rewind(in);
    for(z = 0; z < count-1; z++){
        fwrite(storebuf[z], sizeof(*storebuf), strlen((char*)storebuf[z]), in);

    }
    /* Success */
    return 1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T12:05:51.817

您获得的加密数据是二进制形式，不是以 NULL 结尾的字符串。你不能使用 strlen()，你需要使用存储在 outlen 中的值。

# google-glass - 视频附件缺少 contentUrl

> ID：16179680
> 
> 赞同：3
> 
> 时间：2013-04-23T21:43:07.057
> 
> 标签：google-glass, google-mirror-api

我尝试将视频分享到我的应用程序。它收到了通知，但没有 contentUrl 来加载视频。这是通知中的附件字段：

```
attachments: [{contentType: 'video/mp4', 'id': 'ps:5870152408634447570'}] 
```

isProcessingContent 字段也不存在。它尝试等待一段时间（也许视频正在处理中），但这没有任何区别。

[https://developers.google.com/glass/v1/reference/timeline/attachments](https://developers.google.com/glass/v1/reference/timeline/attachments)

有没有办法访问视频文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:41:14.187

`contentUrl`元数据中未提供附件`TimelineItem`，您需要向`mirror.timeline.attachments.get`端点发送授权请求以检索有关附件的更多信息：

```
from apiclient import errors
# ...

def print_attachment_metadata(service, item_id, attachment_id):
  """Print an attachment's metadata

  Args:
    service: Authorized Mirror service.
    item_id: ID of the timeline item the attachment belongs to.
    attachment_id: ID of the attachment to print metadata for.
  """
  try:
    attachment = service.timeline().attachments().get(
        itemId=item_id, attachmentId=attachment_id).execute()
    print 'Attachment content type: %s' % attachment['contentType']
    print 'Attachment content URL: %s' % attachment['contentUrl']
  except errors.HttpError, error:
    print 'An error occurred: %s' % error 
```

获取附件的元数据后，检查`isProcessingContent`属性：需要将其设置为`False`才能检索`contentUrl`. 不幸的是，当属性更改值时没有推送通知，您的服务必须使用指数退避进行轮询以节省配额和资源。

从附件的元数据中，当`contentUrl`可用时，您可以像这样检索附件的内容：

```
def download_attachment(service, attachment):
  """Download an attachment's content

  Args:
    service: Authorized Mirror service.
    attachment: Attachment's metadata.
  Returns:
    Attachment's content if successful, None otherwise.
  """
  resp, content = service._http.request(attachment['contentUrl'])
  if resp.status == 200:
    return content
  else:
    print 'An error occurred: %s' % resp
    return None 
```

# vaadin - 在 Vaadin 7 中检测平板电脑

> ID：16179688
> 
> 赞同：5
> 
> 时间：2013-04-23T21:43:28.333
> 
> 标签：vaadin

我正在寻找一种方法来轻松检测我的用户是在平板电脑上还是在成熟的个人电脑上。知道怎么做吗？

getSession().getBrowser().isTouchDevice() 不适用于越来越多的带有触摸屏的电脑。无论如何，getBrowser() 在 Vaadin 7 中已被弃用。

我没有使用 vaadin-touchkit（我应该吗？）

问候，罗布。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T07:10:35.750

这是 Vaadin 7 的一种方法：

在[UI.init()](https://vaadin.com/api/com/vaadin/server/Page.html#init%28com.vaadin.server.VaadinRequest%29)中，您获得参数[VaadinRequest](https://vaadin.com/api/com/vaadin/server/VaadinRequest.html)，您可以将其强制转换（在类型检查后）到[VaadinServletRequest](https://vaadin.com/api/com/vaadin/server/VaadinServletRequest.html)并使用[getHttpServletRequest](https://vaadin.com/api/com/vaadin/server/VaadinServletRequest.html#getHttpServletRequest%28%29)来获取底层 HTTP 请求。然后您可以使用它来检查“用户代理”。就像是：

```
if (request instanceof VaadinServletRequest) {
    HttpServletRequest httpRequest = ((VaadinServletRequest)request).getHttpServletRequest();
    String userAgent = httpRequest.getHeader("User-Agent").toLowerCase();

    // TODO: Check user agent for all tablet matching keywords
    if (userAgent.contains("ipad")) { 
        //...
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-03T07:49:15.390

您还可以通过以下方式获取 User-Agent HTTP 标头

```
Page.getCurrent().getWebBrowser().getBrowserApplication() 
```

似乎标题中没有发送属性来区分平板电脑或个人电脑，但您可以通过使用来确定它是否是触摸屏。

```
if(Page.getCurrent().getWebBrowser().isTouchDevice()){ //..} 
```

*   getWebBrowser 在版本 7.4.7 之前不被弃用

# objective-c - 控制精灵的布局

> ID：16179689
> 
> 赞同：-1
> 
> 时间：2013-04-23T21:43:29.897
> 
> 标签：objective-c, cocos2d-iphone

我正在创建一个 Cocos2d 游戏，它将有 4 到 12 个可移动的矩形精灵，它们应该从屏幕的底部 1/3 开始。用户将能够将那些可移动的精灵（一次一个）拖动到屏幕顶部，并让它们放在其他不可移动的精灵之上。我正在尝试确定布局可移动精灵的最佳/最简单方法，并能够跟踪它们的原始位置。

我想跟踪可移动精灵原始位置的原因是我想让用户能够点击它们并让他们回到原来的位置（如果他们不满意他们的位置'已经放置它们）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:50:03.440

使用 Sprite 对象和原始 x、y 位置以及响应移动、单击等所需的行为创建一个新类。

这样，如果您想向 Sprites 添加其他属性，您可以通过将它们添加到新类中轻松地做到这一点。

# compiler-construction - 哪个用于 Cortex-M4 的 ARM 编译器 arm-none-eabi 生成的代码空间最少？

> ID：16179693
> 
> 赞同：2
> 
> 时间：2013-04-23T21:43:43.090
> 
> 标签：compiler-construction, arm, space

好吧，我认为标题说明了一切，但网页抱怨消息正文丢失。

这里有关于代码空间优化的有价值的讨论，但我想知道哪种编译器（GCC、Keil、IAR、CLang 等）在这方面做得最好。到目前为止，我已经比较了四个（全部免费），Atmel Studio GCC、Yagarto、CodeSourcery Light 和 ARM GNU Embedded Tools（可在 launchpad.net 找到）。作为源，我使用了为无操作系统配置的 OpenSSL 1.0.1c 的一部分并进行了按摩。对于我使用的优化级别（-O1 和 -Os），没有太大差异，大约 10%（470k 到 520k，-O1）。我想知道是否有编译器可以击败（主要是 gcc）人群 25% 左右。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T16:04:09.953

Keil/ARM 编译器，市售的（不是免费的），在代码大小方面可能是最好的。不过，它可能不会比 GCC 领先 25%。

要获得真正好的代码大小，您需要查看积极摆脱未使用代码的选项，例如 gcc 中的 -ffunction-sections -fdata-sections --gc-sections 或 armcc 中的 --split-sections。

# azure - 如何为 Azure 中的容器定义只读访问连接字符串？

> ID：16179695
> 
> 赞同：0
> 
> 时间：2013-04-23T21:43:51.667
> 
> 标签：azure, azure-blob-storage

在 Azure 订阅中，我有一个包含多个已定义容器的存储帐户。目前，我的所有代码都使用连接字符串的主访问键来读取和写入容器的数据。所有容器都是私有的。我可以为存储帐户生成一个只读连接字符串，还是必须为每个容器定义它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T17:02:54.463

如果您试图模仿文件系统的文件夹，那么您可能需要考虑在单个 blob 容器中创建虚拟目录，而不是创建超过 20 个单独的容器来表示文件夹。目录的使用在另一个 stackoverflow 问题中讨论：[Windows Azure: How to create sub directory in a blob container](https://stackoverflow.com/questions/2619007/windows-azure-how-to-create-sub-directory-in-a-blob-container)以及[Azure Storage Blobs Service Working with Directories](http://www.codeproject.com/Articles/297052/Azure-Storage-Blobs-Service-Working-with-Directori)。CloudBlobDirectory[类](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.windowsazure.storageclient.cloudblobdirectory.aspx)表示 blob 的 blob 目录，由分隔符指定。如果将所有目录放在一个容器中，则可以通过配置公共访问（例如匿名读取访问）、共享访问签名或[存储访问策略](http://azure.microsoft.com/en-us/documentation/articles/storage-manage-access-to-resources/#use-a-stored-access-policy)来为该容器中的所有 blob（包括子目录中的 blob）设置一次访问权限 . 容器上的存储访问策略可能对您有用，因为它使您部署的 SAS 字符串能够被撤销、扩展或更新，而无需重新部署新字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T02:00:39.523

目前，无法为存储帐户创建只读连接字符串。从平台方面来看，您唯一的选择是使用[`Shared Access Signatures`/`Container Level ACL`](https://docs.microsoft.com/en-gb/azure/storage/blobs/storage-manage-access-to-resources)但您必须分别为每个 blob 容器执行此操作。其他选择是创建自己的应用程序，充当用户和存储帐户之间的代理。对您的存储帐户的所有请求都将通过此应用程序进行路由，您可以在其中合并此只读机制，您可以拒绝除 GET 之外的所有请求（用于只读行为）。

# f# - XmlProvider 的调试运行时

> ID：16179698
> 
> 赞同：1
> 
> 时间：2013-04-23T21:44:02.040
> 
> 标签：f#, f#-data

我将 XmlProvider 附加到似乎是有效的 xml（在 IE 中显示，由 W3C 工具验证）

当我编写程序时，所有类型都会检查并且我可以编译。但是在运行时我有以下错误：

```
Data at the root level is invalid. Line 1, position 1. 
```

当我访问

```
 let posts = (TyPosts.Parse lastposts).GetEntries() 
```

其中 entry 是节点名称。

=> 我应该在哪里放置断点？

我只能设法打破 TP 结构，而不是它的实际数据访问！

为了重现最初的 pb，这里有一个脚本。唯一的修改应该是前 2 个 dll。

```
#r @"Z:\clones\FSharp.Data\bin\v40\FSharp.Data.dll"
#r @"Z:\clones\FSharp.Data\bin\v40\FSharp.Data.DesignTime.dll"
#r @"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.5\System.dll"
#r @"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.5\System.Core.dll"
#r @"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.5\System.Net.dll"
#r @"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.5\System.Net.Http.dll"
#r @"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.5\System.Xml.dll"
#r @"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.5\System.Xml.Linq.dll"
open System
open System.Net
open FSharp.Data
open System.IO;
open System.Text;
open System.Xml;
[<Literal>] 
let lastposts = "lastposts.xml" 
let phase0 () =
  let fetch (url : string, auth) =
   use client = new WebClient()
   client.Headers.Add("user-agent", @"Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US")
   client.DownloadString url
  let write(filename, content:string) = 
     use f= new StreamWriter(filename, false)
     f.Write(content)
  let posts () = fetch(@"http://squarism.com/feed/atom/", false)
  write(  __SOURCE_DIRECTORY__   + "/"+ lastposts, posts())
phase0()

[<Literal>]
let res = __SOURCE_DIRECTORY__
type TyPosts = XmlProvider<lastposts,ResolutionFolder=res> 
let posts = (TyPosts.Parse lastposts).GetEntries() // <-- TCHETCHENIA HERE !! 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T09:32:08.077

您使用的是什么版本的 FSharp.Data？我刚刚用 1.1.4 试过了，效果很好：

```
let feed = XmlProvider<"http://squarism.com/feed/atom/">.GetSample()
let entries = feed.GetEntries() 
```

最近修复的 Xml 命名空间存在问题（请参阅[SO question](https://stackoverflow.com/questions/15753005/f-typeprovider-xmlprovider-gives-system-exception)）

无论如何，放断点的地方都[在这里](https://github.com/fsharp/FSharp.Data/blob/master/src/XmlProvider/XmlRuntime.fs#L51)（在`FSharp.Data.dll`程序集中，不是在程序集中`FSharp.Data.DesignTime.dll`）

如果 1.1.4 不起作用，请在 GitHub 上提交问题

# appharbor - AppHarbor 自定义配置文件转换

> ID：16179700
> 
> 赞同：2
> 
> 时间：2013-04-23T21:44:08.403
> 
> 标签：appharbor, web-config-transform

我有一个包含一些 saml 信息的 xml 文件 saml.config。该信息需要在发布版本中进行转换，以包含生产 URL，而不是开发和暂存 URL。在我的开发和登台环境中，转换发生得很完美，在发布环境中，转换不会发生。

我一直在尝试[http://webconfigtransformationtester.apphb.com/](http://webconfigtransformationtester.apphb.com/)来测试转换，但它们没有被应用，但同样，VS 完美地应用了它们。

基础 saml.config 文件：

```
<?xml version="1.0"?>
<SAMLConfiguration xmlns="urn:componentspace:SAML:2.0:configuration">
    <ServiceProvider Name="Portal.Web" AssertionConsumerServiceUrl="http://localhost:49462/SingleSignOn/ConsumeAssertion"/>
    <PartnerIdentityProvider Name="MTMIdentity"
                             SignAuthnRequest="false"
                             WantResponseSigned="false"
                             WantAssertionSigned="false"
                             WantAssertionEncrypted="false"
                             SingleSignOnServiceUrl="https://identity.*********.com/SingleSignOn/"/>
</SAMLConfiguration> 
```

转换文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<SAMLConfiguration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform" xmlns="urn:componentspace:SAML:2.0:configuration">
  <ServiceProvider Name="Portal.Web" AssertionConsumerServiceUrl="https://***********.com/SingleSignOn/ConsumeAssertion" xdt:Transform="SetAttributes" xdt:Locator="Match(Name)" />
</SAMLConfiguration> 
```

结果应该将服务提供者 AssertionConsumerServiceUrl 中的 localhost url 替换为 ***********.com 版本，但它没有

```
<?xml version="1.0"?>
<SAMLConfiguration xmlns="urn:componentspace:SAML:2.0:configuration">
    <ServiceProvider Name="Portal.Web" AssertionConsumerServiceUrl="http://localhost:49462/SingleSignOn/ConsumeAssertion" />
    <PartnerIdentityProvider Name="MTMIdentity" SignAuthnRequest="false" WantResponseSigned="false" WantAssertionSigned="false" WantAssertionEncrypted="false" SingleSignOnServiceUrl="https://identity.********.com/SingleSignOn/" />
</SAMLConfiguration> 
```

为什么变换测试仪不应用变换？

**编辑：**

我应该补充一点，我使用 SlowCheetah addin / nuget 包在本地和我们的暂存环境中处理转换。

考虑文档（[http://support.appharbor.com/kb/getting-started/managing-environments](http://support.appharbor.com/kb/getting-started/managing-environments)）状态

> 具有相应 .release.config 文件的所有 .config 文件都支持配置文件转换。

我假设 AppHarbor 可以在没有 SlowCheetah 的情况下做到这一点。但同样，WebConfigTransformTester 工具不应用此转换。

所以问题仍然是，我该如何应用这种转换？我可以在 AppHarbor 中使用 SlowCheetah 吗？

**编辑：**

经过进一步调查，AppHarbor 似乎也没有将转换应用于 Web.Config。

我的配置：

![在此处输入图像描述](https://i.stack.imgur.com/c2vsx.png)

Web.Config 中的 AppSettings

```
<appSettings>
    <add key="webpages:Version" value="2.0.0.0" />
    <add key="webpages:Enabled" value="false" />
    <add key="aspnet:UseHostHeaderForRequestUrl" value="true" />
    <add key="PreserveLoginUrl" value="true" />
    <add key="ClientValidationEnabled" value="true" />
    <add key="UnobtrusiveJavaScriptEnabled" value="true" />
    <add key="Environment" value="Development" />
</appSettings> 
```

注意环境设置为“开发”

发布改造：

```
<?xml version="1.0"?>
<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">
    <appSettings>
        <add key="Environment" value="Release" xdt:Transform="SetAttributes" xdt:Locator="Match(key)" />
    </appSettings>
    <system.web>
        <compilation xdt:Transform="RemoveAttributes(debug)" />
        <customErrors defaultRedirect="GenericError.htm" mode="Off" xdt:Transform="Replace">
            <error statusCode="500" redirect="InternalError.htm"/>
        </customErrors>
    </system.web>
</configuration> 
```

注意环境被替换为“发布”

AppHarbor 环境：

![在此处输入图像描述](https://i.stack.imgur.com/ywlpg.png)

部署到 AppHarbor 后，我下载了构建并检查了 Web.Config，它仍然在“开发”处具有环境设置。

**编辑：**

我向我的一个控制器添加了一个动作，它读取环境 AppSetting 并输出到视图，令我惊讶的是它是“发布”！！！

那么给了什么？“下载构建”内容没有适当的转换，但是当请求发生时呢？AppHarbor 何时应用转换？它是在运行时而不是在构建期间吗？

**编辑：**

从 AppHarbor 人员那里得知，转换发生在实际发布时，因此即使构建有一个“已发布网站”文件夹，它仍然不是发布操作的最终输出。

谢谢，乔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T23:59:40.423

我们刚刚针对此问题推出了解决方案（使用您指出的最新转换程序集）并相应地更新了[http://webconfigtransformationtester.apphb.com/](http://webconfigtransformationtester.apphb.com/)。现在应该按预期应用您的转换。

感谢您对此问题的彻底调查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T15:29:21.907

来看看，我原来的问题的答案是没有发生转换的方式，是因为配置文件根节点中的 xmlns 属性。

不幸的是，[http:](http://webconfigtransformationtester.apphb.com/) //webconfigtransformationtester.apphb.com/ 没有给你任何关于为什么没有发生转换的信息，但是如果你查看代码，你可以看到有一个可用的记录器，但是它被设置为空。

我最终提取了代码并添加了一个记录器，发现一个警告“源文档中没有元素匹配'/SAMLConfiguration'”。进一步挖掘我发现了这篇文章[为什么这个 web.config 转换说它找不到 applicationSettings 元素？](https://stackoverflow.com/questions/6844868/why-does-this-web-config-transform-say-it-cant-find-the-applicationsettings-ele)在 Sayed 的回答中，他指出旧的 MSBuild 转换任务不尊重 xmlns 属性。

从配置文件和转换文件中删除 xmlns 属性应该可以解决问题。

但是，在我的情况下， xmlns 属性是必需的，并且无法删除。

因此，在 AppHarbor 更新他们的转换程序集以使用 MSBuild v11.0 程序集之前，我几乎被困住了。

# django - Grappelli，使用 CDN 并在本地上传文件的文件浏览器

> ID：16179703
> 
> 赞同：0
> 
> 时间：2013-04-23T21:44:27.140
> 
> 标签：django, django-admin

我相信这是一个设置问题，而不是更复杂的问题。当我尝试浏览上传目录 Grappelli 或 Filebrowser 时，将根 URL 设置为 STATIC_URL，但我看不到如何更改它。我在 Filebrowser 问题上发布了以下内容：

> 我有以下设置：
> 
> Amazon S3 为我所有的静态文件提供服务。我服务器上的本地目录处理我所有的上传。
> 
> 当我单击浏览图标时，URL 根是 STATIC_URL。无论我在 JS 中调整什么设置。我看不到 MEDIA_URL。
> 
> 关于如何使这项工作的任何建议？似乎应该有一种方法来设置它，但似乎没有一个设置有效。
> 
> 看起来我无法更改 Grappelli 的供应地点。是这个问题吗？欢迎任何帮助。

欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-07T06:54:21.497

目前看来 Filebrowser 不适用于 CDN。

# java - CommandButton 的 actionListener 不起作用

> ID：16179708
> 
> 赞同：0
> 
> 时间：2013-04-23T21:44:34.657
> 
> 标签：java, jsf, converter, selectonemenu, commandbutton

在我在 ah:selectOneMenu 中选择一个项目后，commandButton 中的 Mi actionListener 不会被调用，只有当我在 selectOneMenu 中没有任何选择的情况下按下按钮时它才会起作用您可以在下面看到我的代码：

```
<h:form id="formBtnBusquedaAnomalias">
                <table>
                    <tr>

                        <td>
                                <h:outputLabel id="idEstatusAnomalias" value="Estatus anomalias." />                                     
                                <h:selectOneMenu id="selectOneMenuEstatusAnomalias" 
                                    value = "#{busquedaAnomaliasManageBean.selectedEstatusAnomaliaVO}" >
                                    <f:converter converterId="estatusAnomaliaConverter"/>
                                    <f:selectItem itemLabel="Select one" />
                                    <f:selectItems value="#{busquedaAnomaliasManageBean.lstEstatusAnomaliaVOs}" var="estatusAnomalia"
                                        itemLabel="#{estatusAnomalia.descripcionEstatusAnomalia}" />
                                </h:selectOneMenu>                      
                        </td>

                    </tr>
                    <tr>
                        <td>    
                            <p:commandButton value="Buscar anomalias."
                                    actionListener="#{busquedaAnomaliasManageBean.buscarAnomalias()}" />
                        </td>
                    </tr>
                </table>
            </h:form> 
```

转换器类：

```
@FacesConverter(value = "estatusAnomaliaConverter")
public class EstatusAnomaliaConverter implements Converter{

@Override
public Object getAsObject(FacesContext ctx, UIComponent component, String value) {
    EstatusAnomaliaVO estatusAnomaliaVO = new EstatusAnomaliaVO();
    estatusAnomaliaVO.seDescripcionEstatusAnomalia(value);
    return estatusAnomaliaVO;
}

@Override
public String getAsString(FacesContext ctx, UIComponent component, Object object) {
    String temp = "";
            if(!object == null)
            {
                 temp = object.toString();
            }
    return temp;
} 
```

}

管理豆：

```
@ManagedBean(name=ConstantesManageBeans.MANAGE_BEAN_BUSQUEDA_ANOMALIAS)
@RequestScoped
public class BusquedaAnomaliasManageBean implements Serializable {

/**
 * 
 */
private static final long serialVersionUID = -1955257440354260445L;

public void buscarAnomalias(){
             //...some code here
}
] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T22:37:26.280

您的`buscarAnomalias`方法不遵循 ActionListener 方法的签名。这是签名：

```
public void actionListener(ActionEvent event) {
    // ...
} 
```

为了使其工作，只需将`ActionEvent`参数添加到您的方法中：

```
public void buscarAnomalias(ActionEvent event) {
    //...some code here
} 
```

如果我是你，我会使用`action`而不是`actionListener`执行托管 bean 操作：

```
<p:commandButton value="Buscar anomalias."
   action="#{busquedaAnomaliasManageBean.buscarAnomalias()}" /> 
```

请注意，使用这种方法，您不需要将`ActionEvent event`参数添加到您的方法中。

更多信息：

*   [action 和 actionListener 的区别](https://stackoverflow.com/q/3909267/1065197)

您的代码中的另一个问题是您`FacesConverter`在检索所选项目的值时失败。`itemValue`这是因为您没有设置`<f:selectItems>`：

```
<h:selectOneMenu id="selectOneMenuEstatusAnomalias" 
    value="#{busquedaAnomaliasManageBean.selectedEstatusAnomaliaVO}">
    <f:converter converterId="estatusAnomaliaConverter"/>
    <f:selectItem itemLabel="Select one" />
    <f:selectItems value="#{busquedaAnomaliasManageBean.lstEstatusAnomaliaVOs}"
         var="estatusAnomalia" itemValue="#{estatusAnomalia}"
         itemLabel="#{estatusAnomalia.descripcionEstatusAnomalia}" />
</h:selectOneMenu> 
```

# javascript - Converting float values to a grayscale hex color value

> ID：16179713
> 
> 赞同：5
> 
> 时间：2013-04-23T21:45:02.923
> 
> 标签：javascript, html, colors, floating-point, converter

this question is quick and simple.

I've a 2d array of floats ( 0,0000000 to 1,0000000 ) and i want to convert those numbers to a color value ( #000000 to #ffffff ).

note that i'm talking about just grayscale values.

0 = black | ... | 0.5 = middle gray | ... | 1 = white

does anyone know how to do that with javascript ? thx.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-23T22:05:18.577

Grayscale values in hex are those which got symmetrical distribution or Red, Green and Blue, e.g.: #111111, #5B5B5B, #A2A2A2.

To convert decimal number to hexadecial number you can use:

```
var number = 42;
var hex = Number(parseInt( number , 10)).toString(16);
hex // => "2a" 
```

Put that to function:

```
function dec2hex(dec) {
    return Number(parseInt( dec , 10)).toString(16);
} 
```

So your float can be converted to hex with:

```
var percentage = 0.4;
var color_part_dec = float * 255;
var color_part_hex = dec2hex( color_part_dec );
var color = "#" + color_part_hex + color_part_hex + color_part_hex;
color // => "#666666" 
```

So your function will look like this:

```
function float2color( percentage ) {
    var color_part_dec = 255 * percentage;
    var color_part_hex = Number(parseInt( color_part_dec , 10)).toString(16);
    return "#" + color_part_hex + color_part_hex + color_part_hex;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T23:18:08.710

Here is an example using 3 colour to greyscale methods, Lightness, Average and Luminosity.

```
div.swatch {
    border: 1px solid;
    width: 520px;
    height: auto;
    overflow: auto;
    margin-top: 10px;
    margin-bottom: 10px;
    margin-right: 0px;
    margin-left: 0px;
}
div.box {
    height: 10px;
    width: 10px;
    float: left;
}

<div>Lightness greyscale</div>
<div id="lightness" class="swatch"></div>
<div>Average greyscale</div>
<div id="average" class="swatch"></div>
<div>Luminosity greyscale</div>
<div id="luminosity" class="swatch"></div>

var lightnessDiv = document.getElementById("lightness");
var averageDiv = document.getElementById("average");
var luminosityDiv = document.getElementById("luminosity");
var floats = [];
var lightnesses = [];
var averages = [];
var luminosities = [];
var step = 1 / 256;

for (var i = 0; i < 1; i += step) {
    floats.push(i);
}

function hexToRgb(hex) {
    var bigint = parseInt(hex, 16);
    var r = (bigint >> 16) & 255;
    var g = (bigint >> 8) & 255;
    var b = bigint & 255;

    return [r, g, b];
}

floats.forEach(function (float) {
    var value = Math.floor(16777215 * float);
    var hex = value.toString(16);
    var rgb = hexToRgb(hex);

    var lightness = Math.floor((Math.max(rgb[0], rgb[1], rgb[2]) + Math.min(rgb[0], rgb[1], rgb[2])) / 2);
    var average = Math.floor((rgb[0] + rgb[1] + rgb[2]) / 3);
    var luminosity = Math.floor((0.21 * rgb[0]) + (0.71 * rgb[1]) + (0.07 * rgb[2]));

    lightnesses.push(lightness);
    averages.push(average);
    luminosities.push(luminosity);
});

lightnesses.forEach(function (lightness) {
    var div = document.createElement("div");

    div.className = "box";
    div.style.backgroundColor = "#" + lightness.toString(16) + lightness.toString(16) + lightness.toString(16);
    lightnessDiv.appendChild(div);
});

averages.forEach(function (average) {
    var div = document.createElement("div");

    div.className = "box";
    div.style.backgroundColor = "#" + average.toString(16) + average.toString(16) + average.toString(16);
    averageDiv.appendChild(div);
});

luminosities.forEach(function (luminosity) {
    var div = document.createElement("div");

    div.className = "box";
    div.style.backgroundColor = "#" + luminosity.toString(16) + luminosity.toString(16) + luminosity.toString(16);
    luminosityDiv.appendChild(div);
}); 
```

on [jsfiddle](http://jsfiddle.net/Xotic750/W6xaa/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-25T21:48:21.200

Just be sure to add leading 0's if your value is below 16 and you combine three values into a color code.

```
function dec2hex(dec) {
    return Number(parseInt( dec , 10)).toString(16);
}

function pad(h){ //adds leading 0 to single-digit codes
    if(h.length==1) return "0"+h;
    else return h;
}

r = Math.random()*255;
g = Math.random()*255;
b = Math.random()*255; 

color = "#" + pad(dec2hex(r)) + pad(dec2hex(g)) + pad(dec2hex(b)); 
```

# windows - 关于：配置 - geckofx 中的 always_print_silent

> ID：16179716
> 
> 赞同：-1
> 
> 时间：2013-04-23T21:45:09.033
> 
> 标签：windows, firefox, gecko, geckofx

print.always_print_silent 是否未显示在 about:config 中并且未显示添加的上下文菜单，如何在 geckofx 18 Web 浏览器 c# 中添加此配置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:06:09.883

在 Gecko.Xpcom.Initialize 之后添加此代码

`GeckoPreferences.User["print.always_print_silent"] = true;`

# php - 添加立即购买并添加到购物车按钮，只有 1 个下拉菜单

> ID：16179717
> 
> 赞同：0
> 
> 时间：2013-04-23T21:45:10.327
> 
> 标签：php, html, forms, e-commerce

我想在同一个表单上添加一个“立即购买”按钮并添加到购物车按钮，只有 1 个下拉菜单。目前，如果我想立即购买并添加到购物车按钮，我有 2 个完全相同的下拉菜单。

所以基本上我只想使用 1 个下拉菜单来立即购买并添加到购物车按钮，该按钮链接到两个按钮。

这是仅用于“立即购买”按钮的 html。

```
<form id="form_35" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_self" style="margin:0;position:absolute;left:492px;top:112px;width:199px;height:68px; /*MainDivStyle*/" __AddCode="here">
    <!--MainDivStart-->
    <input type="hidden" name="bn" value="Serif.WebPlus">
    <input type="hidden" name="cmd" value="_xclick">
    <input type="hidden" name="business" value="info@mysite.com">
    <input type="hidden" name="item_name" value="Polo Shirt">
    <input type="hidden" name="currency_code" value="GBP">
    <input type="hidden" name="amount" value="20.00">
    <input type="hidden" name="weight" value="0.18">
    <input type="hidden" name="weight_unit" value="kgs">
    <input type="hidden" name="quantity" value="1">
    <input type="hidden" name="undefined_quantity" value="1">
    <input type="hidden" name="no_shipping" value="0">
    <input type="hidden" name="cn" value="Special Instructions">
    <input type="hidden" name="no_note" value="0">
    <input type="hidden" name="return" >
<input type="hidden" name="on0" value="Colour">

    <!-- Combo Box combo_30 -->

    <!--Preamble-->
    <select name="os0" size="1" style="position:absolute; left:8px; top:8px; /*Tag Style*/" __AddCode="here">
        <option value="Black" __AddCode="here">Black</option>
        <option value="White" __AddCode="here">White</option>
    </select>
    <!--Postamble-->

    <!-- Button btn_29 -->

    <!--Preamble-->
    <div style="position:absolute;left:75px;top:2px;width:116px;height:28px;"><button type="submit" id="btn_29" class="Button4" style="width:116px;height:28px;"><span>Buy&nbsp;Now</span></button></div>
    <!--Postamble-->
    </form>
    <!--Postamble-->
<!--MainDivEnd-->
</div> 
```

加入购物车：

```
<form id="form_36" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_self" style="margin:0;position:absolute;left:647px;top:957px;width:271px;height:44px; /*MainDivStyle*/" __AddCode="here">
<!--MainDivStart-->
<input type="hidden" name="bn" value="Serif.WebPlus">
<input type="hidden" name="cmd" value="_cart">
<input type="hidden" name="business" value="info@mysite.com">
<input type="hidden" name="item_name" value="Polo Shirt">
<input type="hidden" name="currency_code" value="GBP">
<input type="hidden" name="amount" value="20.00">
<input type="hidden" name="weight" value="0.18">
<input type="hidden" name="weight_unit" value="kgs">
<input type="hidden" name="add" value="1">
<input type="hidden" name="quantity" value="1">
<input type="hidden" name="no_shipping" value="0">
<input type="hidden" name="no_note" value="1">
<input type="hidden" name="on0" value="Colour">

<!-- Combo Box combo_31 -->

<!--Preamble-->
<select name="os0" size="1" style="position:absolute; left:8px; top:8px; /*Tag Style*/" __AddCode="here">
    <option value="Black" __AddCode="here">Black</option>
    <option value="White" __AddCode="here">White</option>
</select>
<!--Postamble-->

<!-- Button btn_24 -->

<!--Preamble-->
<div style="position:absolute;left:75px;top:0px;width:188px;height:36px;"><button type="submit" id="btn_24" class="Button5" style="width:188px;height:36px;"><span>Add&nbsp;to&nbsp;Cart</span></button></div>
<!--Postamble-->
</form> 
```

希望这张照片能让我更深入地了解我想做的事情。

[http://img849.imageshack.us/img849/3108/buttonvb.jpg](http://img849.imageshack.us/img849/3108/buttonvb.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:29:05.207

正如我所看到的两种形式的字段相似，所以我建议只保留第一种形式**，**删除第二种形式，将两个按钮放在第一种形式中并用于`javascript`在命令之间切换：

第一种形式的变化：

添加另一个隐藏字段（购物车选项所需）

```
<input type="hidden" name="add" value="1"> 
```

在两个按钮上添加**onclick**事件

```
<button type="submit" id="btn_29" class="Button4" style="width:116px;height:28px;" onclick="setCMD('_xclick');"><span>Buy&nbsp;Now</span></button>
<button type="submit" id="btn_24" class="Button5" style="width:188px;height:36px;" onclick="setCMD('_cart');"><span>Add&nbsp;to&nbsp;Cart</span></ 
```

Javascript函数：

```
<script type="text/javascript">
function setCMD(cmd) {
    form = document.getElementById("form_35");
    form.cmd.value = cmd; 
}   
</script> 
```

希望这可以帮助！

# jquery - 使用 jquery 更改元素 ID

> ID：16179718
> 
> 赞同：0
> 
> 时间：2013-04-23T21:45:14.253
> 
> 标签：jquery

我在 JsFidlle 上有这段代码

[http://jsfiddle.net/MzJaH/14/](http://jsfiddle.net/MzJaH/14/)

我想使用以下代码更改 a 元素的 ID：

```
$(document).ready(function () {
    $('div.chapter a[href*="wikipedia"]').attr({
        rel: 'external',
        title: function () {
            return 'Learn more about ' + $(this).text() + ' at Wikipedia.';
        },
        id: function (index, oldValue) {
            return 'wikilink-' + index;
        }
    });
}); 
```

我希望锚标签是 id='wikilink-0' 但它没有发生....

而且我不知道为什么我在 function(index, oldValue) 中需要这个 var oldValud ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:49:02.303

> 我不知道为什么我在 function(index, oldValue) 中需要这个 var oldValue。

如果您已经为元素设置了 id，您将在 oldvalue 中获得它。

# c++ - Sum Of Subsets Program

> ID：16179720
> 
> 赞同：1
> 
> 时间：2013-04-23T21:45:14.413
> 
> 标签：c++, subset-sum

I am new to C++ and am writing a sum of subsets program that takes in a user defined set of numbers, the first number of which is considered to be the total. I have tried using DDD to debug this program, however I continue to get an out-of-bounds error. I cannot seem to find out why this is happening. Any clues? Thanks. Here is the error:

```
terminate called after throwing an instance of 'std::out_of_range'
what(): vector::_M_range_check 
```

Code:

```
#include <iostream>
#include <vector>
#include <cassert>
#include <iomanip>
#include <climits>
#include <math.h>
#include <algorithm>

typedef unsigned int uint;
using namespace std;

//////// Function declerations //////////
void sum_of_subsets( uint index, 
                     uint weight, 
                     uint total, 
                     vector<bool> &include, 
                     vector<uint> &w,
                     uint W );

bool promising ( uint index, 
                 uint weight, 
                 uint W, 
                 vector<uint> w,
                 uint total ); 
```

.

```
/////////////// Main //////////////////
int main()
{
    //string sortingCode = "-as";
    vector<uint> w;             // vector of weights
    vector<bool> include;       
        uint W;                     // the total
    uint index = 0;
    uint weight = 0;            // the current weight of subsets
    uint total = 0;             // the superset total weight
    while( ! cin.eof() )
  {
    uint value;
    if( cin >> value && ! cin.eof() )
      w.push_back( value );
  }

    W = w.front();
    w.erase( w.begin() );
    // instantiate the include vector to false
    for( uint k = 0; k <= w.size(); k++ )
        include.push_back(0);
    // calculate the superset total
    for( uint k = 0; k <= w.size()-1; k++ )
        total += w.at(k);
    // calculate the sum of subsets accordig to CL argument
    sum_of_subsets( index, weight, total, include, w, W );

    // report success   
    return 0;
} 
```

.

```
////////// Function Bodies ///////////
void sum_of_subsets( uint index, 
                     uint weight, 
                     uint total, 
                     vector<bool> &include, 
                     vector<uint> &w, 
                     uint W )
{    
    cout << "inside sumb_of_subsets" << endl;
    if( promising(index, weight, W, w, total) )
    {   
        cout << "promising is true, continue" << endl;
        if( weight == W )
        {   
            for( uint k = 0; k <= index; k++ )
            {
                if(include.at(k))
                    cout << w.at(k) << " ";;
            }
            cout << endl;
        }
        else
        {
            include.at(index + 1) = 1;
            cout << "index1 = " << index << endl;
            sum_of_subsets( index + 1, 
                            weight + w.at(index + 1 ), 
                            total - w.at(index + 1),
                            include, w, W ) ;
            include.at(index + 1) = 0;
            cout << "index2 = " << index << endl;
            sum_of_subsets( index + 1, 
                            weight, 
                            total - w.at(index + 1),
                            include, w, W );
        }
    }
} 
```

.

```
bool promising ( uint index, 
                 uint weight, 
                 uint W, 
                 vector<uint> w,
                 uint total )
{    
    cout << "inside promising" << endl;
    cout << "W = " << W << endl;
    cout << "weight = " << weight << endl;
    return ( weight + total >= W )
         && ( (weight == W) || (weight + w.at(index+1) <= W));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:51:19.953

这个错误：

```
terminate called after throwing an instance of 'std::out_of_range'
what(): vector::_M_range_check 
```

建议您的调试版本的 vector 抛出异常，并且没有捕获它。发生这种情况时，程序会立即终止而不展开堆栈，这使调试变得更加困难。

改成这样：

```
// calculate the sum of subsets accordig to CL argument
try
{
  sum_of_subsets( index, weight, total, include, w, W );
}
catch (...)
{
  cout << "put breakpoint here!" << endl;
} 
```

在 catch 中添加断点，并检查回溯以查看代码的哪一部分出错。

# fiddler - 提琴手正确吗？SQL 调优后没有字节变化

> ID：16179722
> 
> 赞同：-1
> 
> 时间：2013-04-23T21:45:16.847
> 
> 标签：fiddler

我有一个查询 Select * from table。然后我将其更改为从表中选择 some_fileds。

由这些结果组成一个 json 字符串并输入到网格中。我看到提琴手没有字节差异。有谁知道为什么，请参阅下面的摘要？

-----SQL变更前的Fiddler

```
请求数：1
发送的字节数：756（标头：756；正文：0）
收到的字节数：592,133（标头：279；正文：591,854）

```

-----SQL更改后的Fiddler

```
请求数：1
发送的字节数：756（标头：756；正文：0）
收到的字节数：592,133（标头：279；正文：591,854）

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:53:50.227

当您在 Fiddler 论坛中提出这个问题时，我给出的回答与我相同：

不要查看**统计**选项卡，而是使用**检查器**选项卡查看响应的确切内容。或者使用 Web 会话列表上下文菜单上的**比较会话**命令（在选择 2 个会话之后）来查看这两个会话的确切差异。

# c# - Set autonumber for DataTable after it already has data

> ID：16179724
> 
> 赞同：4
> 
> 时间：2013-04-23T21:45:42.003
> 
> 标签：c#, datatable

I have the following code to add an autonumber column to a `DataTable`:

```
public void AddAutoIncrementColumn(DataTable dt)
{
   DataColumn column = new DataColumn();
   column.DataType = System.Type.GetType("System.Int32");
   column.AutoIncrement = true;
   column.AutoIncrementSeed = 0;
   column.AutoIncrementStep = 1;
   dt.Columns.Add(column);
} 
```

However, this value will be blank for all rows that are already in the table; it seems that the AutoIncrement is only triggered for new rows that are added after this column has been added. Is there a way to set autonumber values for the rows that already exist?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-23T21:55:02.867

我认为`AutoIncrement`当行已经在表中时，不可能触发该功能。但是您可以轻松地手动更新表格：

```
public void AddAutoIncrementColumn(DataTable dt)
{
    DataColumn column = new DataColumn();
    column.DataType = System.Type.GetType("System.Int32");
    column.AutoIncrement = true;
    column.AutoIncrementSeed = 0;
    column.AutoIncrementStep = 1;
    dt.Columns.Add(column);
    int index = -1;
    foreach (DataRow row in dt.Rows)
    {
        row.SetField(column, ++index);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-22T21:17:19.967

我对@Programnik 解决方案进行了更改。

```
DataTable dt = LoadDataTable();
using (DbDataReader dr = dt.CreateDataReader())
{
    //Get Original Datatable structure
    dt = dt.Clone();

    // Add Auto Increment Column called ID
    dt.Columns.Add(new DataColumn("ID")
    {
        AutoIncrement = true,
        AllowDBNull = false,
        AutoIncrementSeed = 1,
        AutoIncrementStep = 1,
        DataType = typeof(System.Int32),
        Unique = true
    });

    // Change Auto Increment Column Ordinal Position to 0 (ie First Column)
    dt.Columns["TabID"].SetOrdinal(0);

    // Re-load original Data
    dt.Load(dr);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-06-27T05:25:27.280

我认为有一种更简单的方法不需要遍历所有行。Datatable 上有一个名为 CreateDataReader 的方法。因此，克隆您的原始数据表，添加标识列，从原始表创建数据读取器，然后使用数据读取器加载克隆的表。这将在标识列中生成数字，例如

```
// original data table
DataTable origDT;

// create a reader
DataReader dr = origDT.CreatDataReader();

//clone original
DataTable clonedDT  = origDT.Clone();

//add identity column
clonedDT.Columns.Add(new DataColumn(){AutoIncrement=true});

//load clone from reader, identity col will auto-populate with values
clonedDT.Load(dr); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-30T21:36:32.230

这对我有用，我试图从另一个表中获取唯一值并让它们有一个新的 ID。

```
 DataTable FinalNest = new DataTable();
        FinalNest.Columns.Add(new DataColumn("CuttingPlan", typeof(int)) { AutoIncrement = true, AutoIncrementSeed = 1, AutoIncrementStep = 1 });
        FinalNest.Columns.Add("Material", typeof(string));
        FinalNest.Columns.Add("IncludedPartIDs", typeof(string));
        DataTableReader dr = cutPlan.DefaultView.ToTable(true, "Material", "IncludedPartIDs").CreateDataReader();
        FinalNest.Load(dr); 
```

# vba - 从“文本”文件导入数据时出错

> ID：16179728
> 
> 赞同：0
> 
> 时间：2013-04-23T21:45:56.490
> 
> 标签：vba, excel

我有 100 多个以分号分隔的文件（*.asc，但打开方式与文本文件相同）要导入工作表。我可以每次选择文件并根据需要更新脚本中的文件夹。我只是想节省点击菜单的时间。

我可以成功选择文件，但它在 .Refresh BackgroundQuery 行之后给了我“错误 104 Excel 找不到刷新此外部数据范围的文本文件”。

我没有正确引用某些东西吗？

```
Sub Macro2input()
'
' Macro2input Macro
'
'
    Dim Start1 As Range
    'Dim SourceCells As Range
    'Dim DestinationCells As Range
    'Dim NextStart As Range
    Set Start1 = ActiveCell
    Dim Finfo As String
    Dim vFilename As Variant
    Dim fileToOpen As Variant

    rootDir = "X:\Lab Tests\13-7242\Re-run Calon\1-B"
    Finfo = "All Files (*.*), *.*"

    'Sets the default folder for selecting a file
    ChDrive "X:"
    ChDir rootDir

    Filename = Application.GetOpenFilename(Finfo, 1, "Select A File To Import")
    vFilename = rootDir & Filename

    With ActiveSheet.QueryTables.Add(Connection:= _
        "TEXT;" + vFilename, Destination:=Start1)
        .Name = Filename
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 932
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileTabDelimiter = True
        .TextFileSemicolonDelimiter = True
        .TextFileCommaDelimiter = False
        .TextFileSpaceDelimiter = False
        .TextFileColumnDataTypes = Array(1)
        .TextFileTrailingMinusNumbers = True
        .Refresh BackgroundQuery:=False
    End With
ActiveCell.Offset(0, 8).Select
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:54:27.757

现在没有一个非常好的 VB 向导：您是否真的在“vFilename = rootDir & Filename”行中检查了 vFilename 中有正确的文件名，并且您确定可以找到并允许访问（exccel 进程）您在 vFilename 中的文件？我认为 rootDir 和 Filename 之间没有反斜杠，因此不是有效的文件路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-07T13:41:17.230

我认为有问题`Destination:=Start1.`

请`Destination:=Range("A" & Lastrow)`改用。

# c - 在 C 错误输出中反转字符串

> ID：16179731
> 
> 赞同：1
> 
> 时间：2013-04-23T21:46:02.203
> 
> 标签：c, string, size, puts

我的字符串长度有一个奇怪的错误。我对此很陌生，所以这可能是我错过的基本内容。

我正在尝试编写一个程序，该程序获取一个指向字符数组（即字符串的第一个字符）的指针，并返回一个指向与第一个大小相同的字符串的指针，但字母是相反的。例如，计算机将变为 retupmoC。tacocat 将保持 tacocat :)

这是代码：

```
char* return_flipped_string(char* stringptr)
{
    int i=0,size_of_string=length_of_string(stringptr);
    char *flipped;
    flipped=(char *)malloc(size_of_string*sizeof(char));
    while(i<size_of_string)
    {
        *(flipped+i)=*(stringptr+size_of_string-1-i);
        i++;
    }
    return flipped;
} 
```

stringptr 是指向原始字符串的指针，翻转的是我要返回的那个。当我打印翻转的字符串时，它显示原始字符串被翻转，然后是难以区分的乱码。由于某种原因，它们的大小不同。

这是我为查找字符串长度而编写的代码（正常工作）

```
int length_of_string(char* stringptr)
{
    int length=0,i=0;
    while(*(stringptr+i)!='\0')
    {
        length++;
        i++;
    }
    return length;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T21:48:21.110

您需要在翻转字符串的末尾附加一个空字节 ('\0')。翻转字符串数据缓冲区的长度是输入字符串的长度**加上**空字符串终止符字节的长度。正是那个空字节告诉字符串在哪里结束。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T21:48:04.957

你需要 NULL 终止字符串..就像这样..

```
 while(i<size_of_string)
    {
        *(flipped+i)=*(stringptr+size_of_string-1-i);
        i++;
    }
    flipped[size_of_string]=0;
    return flipped; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T21:49:53.283

您缺少一个`NUL`终止字符。您需要分配**一个额外**的字符并在末尾显式`flipped`添加一个。`'\0'`

```
char* return_flipped_string(char* stringptr)
{
    int i=0,size_of_string=length_of_string(stringptr);
    char *flipped;
    flipped=(char *)malloc((size_of_string + 1)*sizeof(char));
    while(i<size_of_string)
    {
        *(flipped+i)=*(stringptr+size_of_string-1-i);
        i++;
    }
    *(flipped+1) = '\0';
    return flipped;
} 
```

顺便说一句-您知道`strlen`标准库中的功能吗？您的`length_of_string`功能复制了它。我不记得是否`strrev`符合 ANSI/ISO 标准。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T21:54:55.457

C 中没有字符串这样的东西。C 有字符 ( `char`) 数组，当它们包含 字符 ( ) 时（按照惯例）被*解释*为字符串。第一个找到的终止字符串。如果您的数组不包含 a ，那么任何标准字符串函数都将继续读取从您提供的地址开始的缓冲区，直到它们遇到空字节。 `NUL``'\0'``NUL``NUL`

因此，胡言乱语。

# vbscript - 获取只能写入 ASCII 输出来写入二进制数据的 3rd-party SW

> ID：16179734
> 
> 赞同：1
> 
> 时间：2013-04-23T21:46:26.023
> 
> 标签：vbscript, io, binary, ascii

**问题**

我怎样才能制作一个程序，能够专门用 ASCII 编写输出文件，能够编写二进制数据（特别是 32 位浮点数）？

*   我如何设想最佳答案：某种将浮点值编码为 ASCII 字符的技术，以便程序可以将该 ASCII 编码值写入（到 .txt 文件），并且重命名为 .bin 的结果 .txt 具有字节结构设置，以便它可以直接读取为二进制（最好是 float32 或 float16，big-endian 或 little-endian）。
*   我如何设想一种解决方法：一种将 ASCII 值写入 .vbs 或 .bat 文件的技术，然后可以通过程序内部的系统调用启动该文件。.vbs/.bat/等。将获取（从 ASCII 硬编码的）值并以所需的二进制格式将它们写出。

* * *

**背景**

*   关于我的设置的详细信息：我有一个第 3 方软件 (“3PSW”) 应用程序（光学分析的行业标准，仅供参考），我使用一种方便的宏语言来设置长期计算分析。3PSW 可以进行系统调用。我在 Windows XP 上运行它。
*   为什么这个问题很重要：（A）将输出数据写入一个大的 1000x1000 矩阵需要更长的时间，而这个 IO 瓶颈限制了我们可以用 3PSW 研究的范围（B）ASCII 输出占用了更多的磁盘空间比二进制，（C）我需要 3PSW 的输出为特定的二进制格式，以便被另一个程序读取。
*   我目前的解决方法：我有 MATLAB 脚本来读取 ASCII 输出并以所需的二进制格式写出。虽然这建立了功能，但重新格式化/重写步骤会在过程中引入更多时间，有时 MATLAB 和 3PSW 都会因 RAM 内存使用而挂起。计算持续时间成本限制了我们探索解决方案空间的粒度，从而损害了结果的质量。通过说 VBSCRIPT 而不是 RAM 密集型 MATLAB 完成重新格式化将减少 MATLAB 和/或 3PSW 由于内存而挂起的机会，即使不影响持续时间。
*   我已就此通知 3PSW 的供应商，并且他们是否计划将其包含在未来的版本中，我将任其摆布。

* * *

任何帮助/建议/指导/重定向都是非常受欢迎的，就像您考虑的时间一样。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T07:59:01.323

如果不重写应用程序，我认为你想要的东西是不可能的。如果应用程序能够将其输出写入 STDOUT 而不是文件，您可以实现一个过滤器，在将 ASCII 数据流写入文件之前将其转换为二进制流，但仅此而已。

# magento - Magento: Adding a bundled product that is associated to a bundle to a cart returns an error because of getSelectionByIds()

> ID：16179735
> 
> 赞同：1
> 
> 时间：2013-04-23T21:46:28.907
> 
> 标签：magento, bundle

I need help with a certain custom extension I am building for Magento. I made an extension that would allow bundled product types to be associated with a "parent" bundle product.

So think of it as a I was selling a bundled product, "keyboard and mouse", that was bundled with a DESKTOP computer.

I have it working on the admin and I have it being displayed on the product view. However I am running into an issue when I am trying to add this "DESKTOP COMPUTER" to my shopping cart. I was able to trace it down to a function that called *_prepareProduct()* which is under **/app/code/core/Mage/Bundle/Model/Product/Type.php**.

Below is a snippet of the code that I am finding the problem. As you can see I have dumped out the selectionIds and that returns an array of what options I have selected from the product view page. The second dump is the **selections->getItems** (which I have no idea where this function is at, it wont let me focus it). However when I view this DUMP from a BUNDLE PRODUCT that only contains simple products (i.e., the bundle product that contains the keyboard and mouse) it will output data/object for **selections->getItems(...)**. When I dump this from a bundled product that contains bundled products (i.e., the desktop computer that has the bundled product that contains the keyboard and mouse and other things ) it returns nothing for **selections->getItems(...)**.

```
 // If product has not been configured yet then $selections array should be empty
        if (!empty($selectionIds)) {
            $selections = $this->getSelectionsByIds($selectionIds, $product);

            var_dump($selectionIds);
            var_dump($selections->getItems());    
            // Check if added selections are still on sale
            foreach ($selections->getItems() as $key => $selection) { 
```

Can anyone help me understand "getSelectionsByIds" and how I can override it so it will not return an empty object for a bundled product when I add an item to my cart and/or help me understand getItems and how I can override that as well? I know how to override getSelectionsById but i don't understand what is causing the function to return nothing.

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T03:58:26.410

`getSelectionsById()`正在返回一个*Magento 集合*，这是一个用于包含其他模型（所有同一个类）的模型。将其视为增强型阵列。你可以在这里阅读更多关于它们的信息：[在 Magento 中使用集合](http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/using_collections_in_magento)

由于一些 PHP 技巧，Magento 集合在许多情况下可以被视为一个数组。例如，以下代码有效：

```
$productCollection = Mage::getModel('catalog/product')->getCollection();
foreach ($productCollection as $product) {
    // do stuff
} 
```

尽管如此，从集合中获取实际的 PHP 数组有时还是很有用的。为此，您使用`getItems()`. 它是一种可用于任何 Magento 集合（特别是任何继承自 的对象`Varien_Data_Collection`）的方法。你不应该有任何理由覆盖它。它只是返回集合对象在内部存储和使用的普通 ol' PHP 数组。如您所见，没什么特别的：

```
/**
 * Retrieve collection items
 *
 * @return array
 */
public function getItems()
{
    $this->load();
    return $this->_items;
} 
```

因此，如果您的集合`getItems()`返回`null`或为空数组，则表示该集合不包含任何对象。这通常是因为应用于集合的查询返回了一个空结果集，尽管我不确定这是否适用于您的情况。

很难具体说明为什么您的代码无法返回包含您提供的信息的填充集合。如果您可以更详细地了解您是如何实现新产品类型的——您创建了哪些类、如何扩展核心捆绑包类型等，那将会很有帮助。

# cobol - COBOL 85 END PROGRAM Error

> ID：16179736
> 
> 赞同：0
> 
> 时间：2013-04-23T21:46:45.470
> 
> 标签：cobol

```
PROCEDURE DIVISION USING Input Cipher Temp.
   INSPECT Input
       CONVERTING Alpha-String(1) TO Alpha-String(Cipher)
       MOVE Input TO Temp.
EXIT PROGRAM. 
```

COBOL 85 is not taking EXIT PROGRAM. at the end of my program. Whether I use STOP RUN. or not.

```
prog.cbl:    75: error: syntax error, on or before '.'
prog.cbl:    75: error: unknown or wrong statement, on or before '.' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:15:42.787

尝试将出口移动到与移动一致的右侧。Cobol 不是自由格式的语言，右边的列是为 01 的 Section / Divisions 保留的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T22:39:27.890

不是“结束程序”，不是“退出程序”吗？

我认为你真正想要的是：

```
End Program YourProgramNameHereThatAgreesWithIdentificationDivisionName. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T06:00:14.340

这将取决于你想要做什么。

在 IBM World 中，“EXIT PROGRAM”意味着离开这个程序并返回给 CALLer。由于您的程序是一个 CALLed 程序（您有 PROCEDURE DIVISION USING），您的意图可能是返回 CALLer（尽管您确实提到了 STOP RUN，这将在当时和那里停止处理）您要么需要将其移到右侧，如布鲁斯说过，如果这是你的（未知的）编译器返回给 CALLer 的原因。否则请尝试第 12 列中的 GOBACK。否则，请参阅编译器的文档。否则请告诉我们您使用的是哪个编译器。

# php - how do capture drop down menu value in a form

> ID：16179742
> 
> 赞同：1
> 
> 时间：2013-04-23T21:47:07.920
> 
> 标签：php, html, forms

I am using a piece of code within a form for a drop down list that is populated by a directory on a web site:

```
 <select name="mydrop" id="mydrop">
  <option value="" selected="selected">--a--</option>
    <?php 
            foreach(glob(dirname(__FILE__) . '/images/*') as $filename){
            $filename = basename($filename);
            echo "<option value='" . $filename . "'>".$filename."</option>";
        }
?>

</select> 
```

I have two text boxes and a text area inputting. When I action my php file all of the data values are there but not from this drop down menu. Any ideas why?

I use:

```
$first=$_POST['first'];
$last=$_POST['last'];
$email=$_POST['email'];
$table=$_POST['table'];
$image=$_GET['mydrop']; //Doesn't work 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T21:52:04.200

那么你为什么要使用`$_POST`其他所有东西，而`$_GET`不是`<select>`? 如果表单是通过 POST 提交的，`mydrop`也应该在`$_POST`.

这一行：

```
$image=$_GET['mydrop']; //Doesn't work 
```

应该是这样的：

```
$image = $_POST['mydrop']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:49:24.670

确保`value`每个属性都`<option>`需要填写。这就是`POST`表单的内容。

您正在使用`$image=$_GET['mydrop'];`，但应该是`$image=$_POST['mydrop'];`。`$_GET`用于 URL 参数，例如`?foo=bar`在 URL 的末尾。`$_GET['foo']`将是`bar`。

# php - 帐户搜索通配符 - SugarCRM

> ID：16179743
> 
> 赞同：2
> 
> 时间：2013-04-23T21:47:09.847
> 
> 标签：php, mysql, sugarcrm

我正在寻找一种在 SugarCRM 中搜索帐户时进行通配符搜索的方法，但我无法让查询正常工作。

这是 build_generic_where_clause() 函数：

```
function build_generic_where_clause ($the_query_string) {
    $where_clauses = Array();
    $the_query_string = $this->db->quote($the_query_string);
    array_push($where_clauses, "accounts.name like '%$the_query_string%'");
    if (is_numeric($the_query_string)) {
        array_push($where_clauses, "accounts.phone_alternate like '%$the_query_string%'");
        array_push($where_clauses, "accounts.phone_fax like '%$the_query_string%'");
        array_push($where_clauses, "accounts.phone_office like '%$the_query_string%'");
    }

    $the_where = "";
    foreach($where_clauses as $clause)
    {
        if(!empty($the_where)) $the_where .= " or ";
        $the_where .= $clause;
    }

    $log = fopen('1.txt', "a");
    fwrite($log, $the_where . "\n");

    return $the_where;
} 
```

我只更改`array_push($where_clauses, "accounts.name like '%$the_query_string%'");`为在 the_query_string 的任一侧包含百分号。

这是 view.list.php 中的 processSearchForm()：

```
 function processSearchForm(){

        if(isset($_REQUEST['query']))
        {
            // we have a query
            if(!empty($_SERVER['HTTP_REFERER']) && preg_match('/action=EditView/', $_SERVER['HTTP_REFERER'])) { // from EditView cancel
                $this->searchForm->populateFromArray($this->storeQuery->query);
            }
            else {
                $this->searchForm->populateFromRequest();
            }

            $where_clauses = $this->searchForm->generateSearchWhere(true, $this->seed->module_dir);

            if (count($where_clauses) > 0 )$this->where = '('. implode(' ) AND ( ', $where_clauses) . ')';
            $GLOBALS['log']->info("List View Where Clause: $this->where");

            $log = fopen('1.txt', "a");
            fwrite($log, $this->where . "\n");

        }
        if($this->use_old_search){
            switch($view) {
                case 'basic_search':
                    $this->searchForm->setup();
                    $this->searchForm->displayBasic($this->headers);
                    break;
                 case 'advanced_search':
                    $this->searchForm->setup();
                    $this->searchForm->displayAdvanced($this->headers);
                    break;
                 case 'saved_views':
                    echo $this->searchForm->displaySavedViews($this->listViewDefs, $this->lv, $this->headers);
                   break;
            }
        }else{
            echo $this->searchForm->display($this->headers);
        }
    } 
```

请注意，我只添加了日志文件写入来捕获 $this->where。如果我使用搜索框查找诸如“Newbold”和“New York Design”之类的帐户，我只会得到“Newbold”，并且我的日志文件显示为`(accounts.name like 'new%')`. 因此，第一个百分号以某种方式被删除，我相信 processSearchForm() 某处。很难确定是这种情况还是罪魁祸首是否在其他地方。我发现这段代码有点复杂而且到处都是，但这是我唯一需要做的定制。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-24T20:17:53.547

**您应该能够在不更改任何代码的情况下执行此操作。当您从帐户列表视图中搜索时，只需将通配符添加到表单中的搜索中。将“%$the_query_string%”放入搜索表单。**

如果您想以编程方式使用通配符来搜索记录，您可以执行以下操作。

```
<?php

$filter = 'ABC%'; // account names that start with 'ABC'
$account = BeanFactory::getBean('Accounts');
$accounts = $account->get_list("", "accounts.name like '".$filter."'");

foreach ($accounts['list'] as $account)
{
    // do something with $account
} 
```

get_list() 将提取您需要的内容。需要注意的一点是，get_list() 只会返回您要返回列表视图的记录数。因此，如果您的列表视图仅显示 20 条记录，则 get_list() 将返回最多 20 条记录。如果要获取所有结果，请使用 get_full_list()。

# vim - Vim how to set visual mode selection from a function?

> ID：16179744
> 
> 赞同：0
> 
> 时间：2013-04-23T21:47:17.323
> 
> 标签：vim

I have the start and end (line/col) pairs for my desired selection.

How to set that as the actual visual selection?

Ex:

I have the buffer:

```
 1 2
 3 4
 5 6 
```

Start: 2,1

End: 3,2

```
:cal SetSelection() 
```

Desired visual selection after call:

```
3 4
5 6 
```

What does 'SetSelection()' look like?

EDIT

best solution so far with error checking based on answers

```
"put user in visual mode and set the visual selection

"if arguments are not valid, nothing is changed, and raises an exception

":param 1:

    "Visual mode to leave user in.

    "must be either one of:

    "- 'v' for visual (default)
    "- "\<s-v>" for line visual
    "- "\<c-v>" for block visual
":type 1: string

":returns: 0

":raises: bad mode argument, bad position argument
fu! SetSelection( x, y, x2, y2, ... )
    let valid_mode_strings = ["v","\<s-v>","\<c-v>"]

    if a:0 > 0
        if index( valid_mode_strings, a:1 ) >= 0
            let mode = a:1
        el
            th 'bad mode argument: ' . a:1 . ' valid options: ' . join( valid_mode_strings, ', ' )
        en
    el
        let mode = 'v'
    en

    let oldpos = getpos('.')

    if setpos( '.', [0,a:x,a:y] ) != 0
        exe "norm! \<esc>"
        th 'bad position argument: ' . a:x . ' ' . a:y . ' ' . a:x2 . ' ' . a:y2
    en

    exe 'norm! ' . mode

    if setpos( '.', [0,a:x2,a:y2] ) != 0
        exe "norm! \<esc>"
        cal setpos( '.', oldpos )
        th 'bad position argument: ' . a:x . ' ' . a:y . ' ' . a:x2 . ' ' . a:y2
    en
endf 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T22:40:27.917

你可以使用函数`setpos()`来完成这项工作：

```
fun! SetSelection()
    call setpos('.',[0,2,1])
    normal! v
    call setpos('.',[0,3,2])
endf 
```

在上面的代码中，`[2,1]`and`[3,2]`应该作为传入的参数。我只是硬编码以使其简单。

还有一些错误处理留给你。例如参数验证等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T00:45:46.317

大多数 vim 都有一个`m<`和`m>`标记用于这个目的。`:help m<`

```
call setpos("'<", [0, 2, 1])
call setpos("'>", [0, 3, 2])
normal! gv 
```

一些 vim 安装没有。在这些情况下，您可以保存和恢复用户标记，或使用上下文标记```

```
call cursor([2, 1])
normal! m`
call cursor([3, 2])
normal! v`` 
```

# linux - (99)无法分配请求的地址：AH00072：make_sock：无法绑定到地址 xx.xxx.xx.xx:80

> ID：16179749
> 
> 赞同：1
> 
> 时间：2013-04-23T21:47:30.350
> 
> 标签：linux, apache, fedora-core

我正在尝试在 apache 中添加一个虚拟服务器：

```
Listen xx.xxx.xx.xx:80
NameVirtualHost domain.com
<VirtualHost domain.com>
DocumentRoot /home/webserver/domain/html
ServerName domain.com
</VirtualHost> 
```

当我重新启动 apache 时出现此错误：

```
(99)Cannot assign requested address: AH00072: make_sock: could not bind to address xx.xxx.xx.xx:80
no listening sockets available, shutting down
AH00015: Unable to open logs 
```

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T03:19:55.360

要么您没有以正确的权限启动 apache（只有 root 可以打开端口 80），或者某些东西（可能是另一个 apache）已经在端口 80 上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T17:21:13.043

问题是额外的网卡没有配置额外的IP。

# php - php date less than in date('l, F j') form

> ID：16179754
> 
> 赞同：0
> 
> 时间：2013-04-23T21:47:43.257
> 
> 标签：php, date

Here is my exact code:

```
$date = date('l, F j'); 
$start = $row['date']; // equal to Monday, April 15
$interval = $row['interval']; // this is equal to 7 
$end = date('l, F j', strtotime($start ."+$interval days"));

 if ($end < $date) { 
     // do this 
 } else { 
     //yada yada yada
 } 
```

I dont know if Im using the variable `$interval` wrong or if the date strtotime +7 days can not be used in this date format. I would like to keep the date format in this but if I must change then I guess I have to. The question is Can I use this date format and still add `$interval` amount of days? When the `$end` date is less than the $date it should do one part of the code and its not doing that part.

Any help would be great. Thanks.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:51:07.957

如果那是您的确切代码，那么`date(l, F j)`第一行是语法错误，并且此代码永远无法按原样运行。

您的问题是您将时间值转换为字符串，然后进行字符串比较。

例如

```
('December 1' < 'February 15') 
```

将是 TRUE，因为`D`在`F`. 您需要比较 strtotime() 产生的原始时间戳，这是一个简单的整数：

```
if (strtotime($start) < strtotime($end)) {
   start is less than end
} 
```

# perl - How to build a hashref with arrays in perl?

> ID：16179762
> 
> 赞同：1
> 
> 时间：2013-04-23T21:48:24.863
> 
> 标签：perl, xml-simple, hashref

I am having trouble building what i think is a hashref (href) in perl with XML::Simple. I am new to this so not sure how to go about it and i cant find much to build this href with arrays. All the examples i have found are for normal href.

The code bellow outputs the right xml bit, but i am really struggling on how to add more to this href

Thanks Dario

```
use XML::Simple;
$test = {
book => [
    {
        'name' => ['createdDate'],
        'value' => [20141205]
    },
        {
        'name' => ['deletionDate'],
        'value' => [20111205]
    },

]

};
$test ->{book=> [{'name'=> ['name'],'value'=>['Lord of the rings']}]};
print XMLout($test,RootName=>'library'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T22:04:38.160

要将新哈希添加到 arrary-ref 'books'，您需要将 array-ref 强制转换为数组，然后推送到它。`@{ $test->{book} }`将数组引用转换为数组。

```
push @{ $test->{book} }, { name => ['name'], value => ['The Hobbit'] }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T23:26:19.357

`XML::Simple`很痛苦，因为您永远不确定是否需要数组或哈希，并且很难区分元素和属性。

我建议你移动到[`XML::API`](https://metacpan.org/module/XML%3a%3aAPI). 该程序演示了如何使用它来创建与您自己的程序相同的 XML 数据，该程序使用`XML::Simple`.

它有一个优势，因为它在内存中构建了一个正确表示 XML 的数据结构。可以像这样线性添加数据，或者您可以将书签存储在结构中并返回并将信息添加到先前创建的节点。

此代码`book`以不同的方式添加这两个元素。第一种是标准方式，打开元素，添加`name`和元素，然后再次关闭元素。第二个显示了（抽象语法树）方法，该方法允许您在嵌套数组中传递数据，类似于为了简洁起见。此结构要求您在属性名称前加上连字符，以将它们与元素名称区分开来。`value``book``_ast``XML::Simple``-`

```
use strict;
use warnings;

use XML::API;

my $xml = XML::API->new;

$xml->library_open;

$xml->book_open;
$xml->name('createdDate');
$xml->value('20141205');
$xml->book_close;

$xml->_ast(book => [
  name  => 'deletionDate',
  value => '20111205',
]);

$xml->library_close;

print $xml; 
```

**输出**

```
<?xml version="1.0" encoding="UTF-8" ?>
<library>
  <book>
    <name>createdDate</name>
    <value>20141205</value>
  </book>
  <book>
    <name>deletionDate</name>
    <value>20111205</value>
  </book>
</library> 
```

# php - pdo 和 postgresql 的配置

> ID：16179763
> 
> 赞同：1
> 
> 时间：2013-04-23T21:48:32.120
> 
> 标签：php, pdo, postgresql-9.1

我将 postgreSQL 9.1 与 postGIS 2.0 一起使用。还有 Apache 2.2.22 和 PHP 5.3.13。我正在尝试为 postgreSQL 设置 PHP 的 PDO。我也使用 Windows 7。据此我没问题，我检查了我的 php.ini 并找到了这一[行](http://www.php.net/manual/en/pdo.installation.php)`extension=php_pgsql.dll`

但是根据[这个](http://www.php.net/manual/en/pdo.configuration.php)（运行时配置）我必须在我的 php.ini 中设置一个 dsn。我实际上并没有得到我必须做的事情。以及为什么。我尝试`pdo.dsn.'pgsql:host=localhost;port=5432'`在 php.ini 中编写类似的内容，然后重新启动 Apache。

之后我创建了一个新的 php 文件来测试 PDO。这是代码

```
 try {  
      $DBH = new PDO("pgsql:host=localhost;port=0000;dbname=blah;user=blah;password=blah");  
      $DBH->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_WARNING );  

    }  
    catch(PDOException $e) {  
    echo" sorry man! ";
        echo $e->getMessage();  
    } 
$name="frouto";
$STH = $DBH -> prepare("SELECT * FROM controller WHERE c_name LIKE :name;");
$STH->bindParam(':name', $name);

$STH->execute();
$result = $STH->fetchAll(PDO::FETCH_ASSOC); 
```

测试 PDO 真的很简单。这根本不起作用。也不会打印异常错误。我猜运行时配置是错误的。而且dsn也是错的。我必须做些什么来修复它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:10:48.803

首先，确保 postgres 在您的本地主机上运行。

其次，确保可以连接到 postgres：telnet localhost 5432

第三，Postgres 通常在端口 5432 上运行。您的代码在 0000 上连接。

DSN 是您创建 PDO 中的（唯一）参数：

```
$DBH = new PDO("pgsql:host=localhost;port=0000;dbname=blah;user=blah;password=blah"); 
```

IE

```
$dsn = "pgsql:host=localhost;port=0000;dbname=blah;user=blah;password=blah";
$DBH = new PDO($dsn); 
```

检查这些步骤中的每一个，并再次询问如果其中一个步骤失败并且您无法弄清楚该步骤时如何解决。

# java - CardLayout (swing) with action listeners on buttons?

> ID：16179764
> 
> 赞同：3
> 
> 时间：2013-04-23T21:48:32.740
> 
> 标签：java, swing, jframe, jbutton, cardlayout

I've been trying to figure out CardLayout with action listeners on button (so like - starts on a load-up page- and on a button click switches to a different "card"

my code won't even run right now i'm not entirely sure why - most implementations I can find use ItemListeners and Combo Boxes

The basic process I've done is create a master JPanel, but my cards JPanel onto the master JPanel, but my different cards into the cards JPanel, then add the master JPanel to the frame to display...

Also, for one of my cards I only need to display a picture - I previously implemented this by just creating a new pop-up window but It would be nice to be able to switch the frame to show it... I don't know why I can't figure this out

Here's my code:

```
import java.awt.*;

/** 
 * Game
 * Main class that specifies the frame and widgets of the GUI
 */
public class Game implements Runnable {
public void run(){

    final String ON_OPEN = "Welcome!"; //Opening frame
    final String GAME = "Play!"; // Game Frame
    final String STATS = "Stats"; // Post-Game Stat Frame
    final String HELP = "Help"; //tutorial frame
    JPanel cards = new JPanel(); 
    JPanel master; // a panel for the card layout

    final JFrame frame = new JFrame(ON_OPEN);
    frame.setLocation(500,200);

    //Create the master layout for the program
    master = (JPanel) frame.getContentPane();
    master.setLayout(new BorderLayout()); // creating master layout

    //Create panel for all the cards in CardLayout
    final CardLayout cLay = new CardLayout();
    cards.setLayout(cLay);

    // all the cards
    final JPanel help = new JPanel();
    final JPanel stats = new JPanel();
    final JPanel game = new JPanel (new BorderLayout());
    final JPanel open = new JPanel (new FlowLayout());

    // setting up ON_OPEN layout - uses JPanel open

    final ImageIcon img = new ImageIcon("Instructions.png", "My Instructions..."); // the image I want shown under HELP card
    final JButton info = new JButton("Help");
    info.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
    //      cLay.show(help, HELP);     // WHAT I NORMALLY SHOULD BE DOING, RATHER JUST MAKE A NEW FRAME FOR THIS THOUGH
    //      frame.pack();

            final JFrame infoFrame = new JFrame("Tutorial");
            infoFrame.setLocation(500,50);
            JLabel tutorialImg = new JLabel(img);
    //      int w = img.getIconWidth();
        //  int h = img.getIconHeight();
            //infoFrame.setSize(w, h);
            infoFrame.pack();
            infoFrame.add(tutorialImg);
            infoFrame.setVisible(true);
        }
    });
    open.add(info); // the open-tutorial button

    //Add them to the cards JPanel
    cards.add(open, ON_OPEN);
    cards.add(help, HELP);
    cards.add(stats, STATS);
    cards.add(game, GAME);

    //Add the cards panel to the Master layout panel
    master.add(cards);

    // This code is all commented out because I'm not sure what I'm doing here...
//  frame.add(cards);
//  cLay.show(cards, ON_OPEN);

//  frame.add(open, BorderLayout.CENTER);

    // Main playing area - I want this to be shown in the GAME card...

    GridLayout tileGrid = new GridLayout(4,4);
    final JPanel grid = new JPanel(tileGrid);
      //    game.add(grid, BorderLayout.CENTER);

    //      grid.setLayout(tileGrid);
    //  frame.add(grid, BorderLayout.CENTER);

    // Input - holds typing box
    //        final JPanel status_panel = new JPanel();

    //  frame.add(cards, BorderLayout.CENTER);

//  frame.add(open, BorderLayout.CENTER);

    final JTextField typingArea = new JTextField();
    typingArea.setFocusTraversalKeysEnabled(false);
    typingArea.setEditable(true);
    typingArea.setFocusable(true);
    typingArea.requestFocus();

    frame.add(typingArea, BorderLayout.SOUTH);
    typingArea.addKeyListener(new KeyAdapter() {
        public void keyPressed (KeyEvent e) {
            if (e.getKeyCode() == KeyEvent.VK_ENTER) { // enter key is pressed
                String userWord = typingArea.getText().toLowerCase();
                typingArea.setText("");

            }
        }
    });

    final JLabel status = new JLabel("Running...");
    //        status_panel.add(status);

    // Reset button
    final JPanel control_panel = new JPanel();
    frame.add(control_panel, BorderLayout.NORTH);

    ]

    // Put the frame on the screen
    frame.pack();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true);
}

public static void main(String[] args){
    SwingUtilities.invokeLater(new Game());
}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:58:42.863

问题：

*   您的代码无法为我们编译，因为我们没有 JLetterField 类。
*   您正在尝试将 JFrame 的 contentPane 添加回自身，并导致异常并且没有意义。

* * *

**编辑1：**

*   您最新的代码显示您将所有内容都放入一个非常大`run()`的方法中，但这样做，您失去了很多，却一无所获。
*   我建议摆脱 Runnable 接口，不需要它，并创建一个真正符合 OOP 的类，一个具有私有字段和公共和私有方法的类。
*   您的 actionPerformed 方法显示没有尝试更改 CardLayout 的显示卡片。
*   我建议您摆脱代码以显示一个新窗口并尝试在那里放置换卡代码。
*   制作您的 CardLayout 和类的卡片显示 JPanel 字段，以便其他方法可以访问它们并调用它们的方法。

* * *

**编辑2：**

例如，以下代码显示了使用 3 个 JButton 交换卡片。一张用于获取上一张卡片，一张用于获取下一张卡片，一张用于展示如何获取特定卡片（此处为第二张）：

```
import java.awt.BorderLayout;
import java.awt.CardLayout;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;

import javax.swing.*;

@SuppressWarnings("serial")
public class CardLayoutEg extends JPanel {
   private static final String[] CARD_LABELS = { "one", "two", "three", "four",
         "five", "six", "seven", "eight", "nine", "ten" };
   private static final int PREF_W = 400;
   private static final int PREF_H = PREF_W;
   private CardLayout cardlayout = new CardLayout();
   private JPanel cardHolder = new JPanel(cardlayout);
   private Action[] actions = { new ShowPreviousAction(), new ShowNextAction(),
         new ShowTwoCardAction() };

   public CardLayoutEg() {
      for (String cardLabelText : CARD_LABELS) {
         JLabel cardLabel = new JLabel(cardLabelText, SwingConstants.CENTER);
         cardHolder.add(cardLabel, cardLabelText);
      }

      JPanel btnPanel = new JPanel(new GridLayout(1, 0, 5, 0));
      for (Action action : actions) {
         btnPanel.add(new JButton(action));
      }

      setLayout(new BorderLayout());
      add(cardHolder, BorderLayout.CENTER);
      add(btnPanel, BorderLayout.SOUTH);
   }

   @Override
   public Dimension getPreferredSize() {
      return new Dimension(PREF_W, PREF_H);
   }

   private class ShowPreviousAction extends AbstractAction {
      public ShowPreviousAction() {
         super("Previous");
      }

      @Override
      public void actionPerformed(ActionEvent e) {
         cardlayout.previous(cardHolder);
      }
   }

   private class ShowNextAction extends AbstractAction {
      public ShowNextAction() {
         super("Next");
      }

      @Override
      public void actionPerformed(ActionEvent e) {
         cardlayout.next(cardHolder);
      }
   }

   private class ShowTwoCardAction extends AbstractAction {
      public ShowTwoCardAction() {
         super("Show Two");
      }

      @Override
      public void actionPerformed(ActionEvent e) {
         cardlayout.show(cardHolder, CARD_LABELS[1]);
      }
   }

   private static void createAndShowGui() {
      CardLayoutEg mainPanel = new CardLayoutEg();

      JFrame frame = new JFrame("CardLayout Example");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(mainPanel);
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
} 
```

# facebook - Facebook FQL：我想获取用户在朋友时间线上写的所有帖子

> ID：16179767
> 
> 赞同：1
> 
> 时间：2013-04-23T21:48:49.933
> 
> 标签：facebook, facebook-fql

我只想要帖子（没有喜欢或评论）。任何人都可以提供一个想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T21:19:13.993

这在 FQL 中是不可能的，请考虑在具有`read_stream`权限的以下端点上使用常规 Graph API 和分页

`friend_id/feed?fields=message`

# ms-access - 用 VBA 填写报告

> ID：16179774
> 
> 赞同：0
> 
> 时间：2013-04-23T21:49:12.993
> 
> 标签：ms-access, ms-access-2007, vba

我有一个与报告相关的表格。根据表格中填写的字段，报告必须添加一些额外的内容，例如：如果用户在某些字段中选择“A”，比如说表单的 [options] 字段，则报告必须显示“您选择 A这一次”在[选项]报告的字段中，并且在报告的其他字段中为“这是一个不错的选择”，比如说[解释]字段。

我`openreport`在 vba 中使用过该方法并使用 where 语句或`openargs`

```
docmd.openreport "myreport", acViewPreview, , "[options] = " & "you choose " + [forms!].[options!] + " this time" 
```

但我不需要查询来填写报告，所以 where 条件不符合我的需要。同样使用 openargs 也没有任何反应，也许我出了点问题.. 有人知道如何使其与 openargs 或其他方法一起使用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T17:30:27.777

可能有一个更简单的解决方案，但您可以将用户的选择插入到 1 行表中。然后将该表用作报告的记录源。

这种方法的一个优点是，由于您的报表将具有稳定的数据源（表格），因此开发起来更容易一些。

# regex - 谷歌优化正则表达式

> ID：16179778
> 
> 赞同：1
> 
> 时间：2013-04-23T21:49:28.810
> 
> 标签：regex, openrefine

我正在尝试使用正则表达式（GREL）来删除单元格中不以特定字符（es“@”）开头的字符串。

例子

我想改变这个：

**@user1 给@user2 写一些东西并打个招呼**

至：

**@用户1 @用户2**

非常感谢 AZ

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:22:07.373

您可以`(?<!\S)[^@]\S*`用空字符串替换。

# html - 请帮助我的页脚

> ID：16179782
> 
> 赞同：0
> 
> 时间：2013-04-23T21:49:39.087
> 
> 标签：html, css, footer

我正在使用 Dreamweaver 编辑为我的新商业网站获得的模板。我的页脚有问题，我不确定是 HTML 问题、CSS 问题还是我只是个白痴问题。无论我做什么，页脚都向下延伸太远。这是我正在谈论的屏幕截图：

[http://tinypic.com/r/t9ccbn/4](http://tinypic.com/r/t9ccbn/4)

另外，我希望链接与上面的列对齐，就像联系信息和版权信息一样。这是HTML：

```
<div id="footer">
    <div>
      <div id="links">
        <div class="showroom">              
              <p><br>
                9501 W. Sahara Ave. #2082
              <br> Las Vegas, NV 89117
                <br> 702-409-5373<br>
                  <a href="index.html">info@briarpatchfurniture.com</a>
          </p>
          </div>

        <ul class="navigation">
          <li><a href="index.html">Home</a></li>
<li><a href="about.html">About</a></li>
<li><a href="gallery.html"> Gallery</a></li>
<li><a href="contact.html">Contact</a></li> 
```

```
 <p id="footnote">
            © Copyright TIBISI, Inc 2013\. All Rights Reserved.
      </p>
    </div>
</div> 
```

这是CSS：

```
/*------------------------------ FOOTER ------------------------------*/
#footer {
background-color: #e2b241;
border-top: 1px solid #fff;
padding: 28px 0 14px;
}
#footer p {
color: #4b3a33;
font-size: 12px;
line-height: 18px;
margin: 0;
}
#footer > div {
width: 940px;
margin: 0 auto;
padding: 0 10px;
}
#footer .posts {
float: left;
height: 300px;
width: 302px;
padding: 0;
}
#footer .posts li {
width: 276px;
margin: 0 0 30px;
padding-left: 10px;
}
#footer .posts p a {
line-height: 24px;
margin: -3px 0 3px;
}
#links {
background: url(../images/separator-dark.png) repeat-x left bottom;
color: #4b3a33;
display: inline-block;
width: 940px;
padding: 0 0 20px;
}
#links h4 {
color: #241b18;
font-family: "Oswald";
font-size: 15px;
font-weight: normal;
line-height: 24px;
margin: 0 0 12px;
padding-left: 10px;
text-transform: uppercase;
}
#links > div {
float: left;
background: url(../images/separator-dark-vertical.png) repeat-y left top;
height: 300px;
padding-left: 20px;
}
#links .showroom {
background: none;
width: 293px;
padding-left: 0;
padding-right: 15px;
}
#links .showroom h4 {
padding-left: 0;
}
#links .showroom img {
margin-bottom: 12px;
}
#links .showroom p {
font-size: 13px;
margin: 0;
}
#links .showroom p em {
color: #fff;
display: block;
font-style: normal;
margin: 0 0 20px;
}
#links .showroom p a {
color: #4b3a33;
display: block;
}
#links .showroom p a:hover {
color: #241b18;
}
#newsletter {
background: url(../images/separator-dark.png) repeat-x left bottom;
width: 284px;
margin: 0 0 16px 6px;
padding: 0 0 20px;
}
#newsletter h4 {
padding-left: 0;
}
#newsletter input {
color: #4b3a33;
height: 26px;
line-height: 26px;
width: 269px;
border: 3px solid #af8112;
margin: 0 0 6px;
padding: 0 4px;
*margin-left: -6px; /** Needed for IE7 **/
}
#newsletter input.btn2 {
color: #fff;
width: 83px;
border: 0;
padding: 0px 0 2px;
}
#connect a {
display: inline-block;
height: 33px;
margin: 0 10px;
}
#connect a.facebook {
background-position: -46px -112px;
width: 33px;
}
#connect a.googleplus {
background-position: -46px -153px;
width: 34px;
}
#connect a.twitter {
background-position: -46px -194px;
width: 40px;
}
#connect a.facebook:hover {
background-position: 0 -112px;
}
#connect a.googleplus:hover {
background-position: 0 -153px;
}
#connect a.twitter:hover {
background-position: 0 -194px;
}
#footer ul.navigation {
float: right;
display: block;
line-height: 24px;
list-style: none;
margin: 0;
padding: 0 12px 0 0;
}
#footer ul.navigation li {
float: left;
margin-left: 15px;
}
#footer ul.navigation li:first-child {
margin-left: 0;
}
#footer ul.navigation li a {
color: #ab7d0f;
font: 11px/24px "Oswald";
text-decoration: none;
text-transform: uppercase;
}
#footer ul.navigation li a:hover {
color: #241b18;
}
#footer #footnote {
color: #ab7d0f;
font: 11px/24px "Oswald";
margin: 0;
text-transform: uppercase;
} 
```

任何帮助将不胜感激。

[http://jsfiddle.net/GCqfE/](http://jsfiddle.net/GCqfE/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:20:59.813

您`line-height`在所有子元素中的使用`footer`导致页脚垂直向下扩展，并且没有`height`为父元素指定值，`div`它们可以自由扩展。要么将 line-heights 更改为较小的值，要么为父`footer`div 指定一个高度，如下所示：

```
#footer {
background-color: #e2b241;
border-top: 1px solid #fff;
padding: 28px 0 14px;
height:100px;
} 
```

我已经更新了你的 jsFiddle：http: [//jsfiddle.net/GCqfE/1/](http://jsfiddle.net/GCqfE/1/)

# java - 替换 zip 文件中的文件，该文件以字节形式存储在数据库中

> ID：16179787
> 
> 赞同：0
> 
> 时间：2013-04-23T21:49:58.010
> 
> 标签：java, mysql, zip, bytearray

我目前正在开发一个 Web 应用程序。我试图访问的数据库表具有以下列：

`archive_pk`int(20) 无符号 NOT NULL AUTO_INCREMENT,

`archive`mediumblob 非空，

`checksum`varchar(32) 非空，

user1 上传一个压缩文件（一个 Eclipse 项目），然后将其转换为字节并存储在“归档”列下，自动生成 archive_pk 并使用 java.security.MessageDigest 库计算校验和。（MessageDigest.digest(bytes) ，#bytes 是 zip 文件的字节流表示）。

user2 使用archive_pk 从数据库中获取存档。他想替换存档中某些文件的内容（*.java 文件的内容）。我正在使用 java.util.zip。*模块来尝试访问特定的 zip 条目并替换其内容。但是数据最终每次都会损坏。

# mysql - 从另一个表中不存在列值的表中选择

> ID：16179791
> 
> 赞同：2
> 
> 时间：2013-04-23T21:50:12.703
> 
> 标签：mysql, sql

```
SELECT  Id, Name, Lastname
FROM customers AS c, Places AS p, 
WHERE c.customer_ID = p.customer_ID 
```

我的问题是，我想阻止显示另一个表中存在的行的查询结果（阶段）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T21:54:40.227

您可以执行 LEFT JOIN 并检查是否为空。

```
SELECT  Id, Name, Lastname
FROM customers AS c LEFT JOIN Places AS p ON c.customer_ID = p.customer_ID
WHERE p.customer_ID IS NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:53:45.407

添加

```
and not exists
(subquery to select your exclusions) 
```

对您的查询

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:53:28.937

你可以使用：

```
SELECT  Id, Name, Lastname
FROM customers AS c JOIN Places AS p USING(customer_ID) 
```

这是您可以使用的更快的方法`in/exists`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T21:55:16.653

我想你想要这样的东西：

`SELECT Id, Name, Lastname FROM customers, WHERE customer_ID NOT IN (SELECT customer_ID FROM Places)`

# python - In a list of lists, is there a way to get the elements in an element's row and column simultaneously?

> ID：16179794
> 
> 赞同：1
> 
> 时间：2013-04-23T21:50:30.193
> 
> 标签：python, python-3.x

I have a simple list of lists called `square`:

```
square = [[1,2,3],[4,5,6],[7,8,9]] 
```

and my goal is to iterate through each of the nine elements and get all the values in that element's row and column simultaneously. In this example, the first iteration (for element 1) should return `[1,2,3]` and `[1,4,7]`, the second (for element 2) would give me `[1,2,3]` and `[2,5,8]`, etc. The following code works:

```
for r in range(3):
    for c in range(3):
        row = square[r]
        col = [square[c1][c] for c1 in range(3)] 
```

but is there another method using **base** Python to do this?

I can transpose and iterate over the list using `for c in zip(*square):`, which works if I just need the columns once, but is there no way to use array slicing to index the columns without storing the transpose of the matrix as well as the matrix itself?

Unfortunately, libraries like numpy aren't an option at the moment because they'll need to go through our code review process first, which takes a *long* time (on the order of six months...). I didn't write the policy or design the procedures, but it's the policy I have to work with at this institution. I already filed the request for numpy, but in the meantime, I'm just using base Python.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T21:57:46.013

使用 numpy

```
>>> import numpy as np
>>> square = np.array([[1,2,3],[4,5,6],[7,8,9]])
>>> square[0]
array([1, 2, 3])
>>> square[..., 0]
array([1, 4, 7])
>>> square[:, 0]
array([1, 4, 7]) 
```

仅使用 Python

```
>>> square = [[1,2,3],[4,5,6],[7,8,9]]
>>> square[0]
[1, 2, 3]
>>> zip(*square)[0]
(1, 4, 7) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T21:58:25.363

如果您想使用标准 Python 执行此操作，您可能想尝试转置列表。然后，您可以正常索引。您可以执行此操作，`zip(*square)`然后`map(list,)`将其转回列表：

```
square = [[1,2,3],[4,5,6],[7,8,9]]

square_transposed = map(list, zip(*square)) 
```

然后`square[1]`会得到你`[2,5,8]`。

如果您想知道 * 运算符在此上下文中的作用，[它会将列表解压缩为一系列位置参数](https://stackoverflow.com/questions/2921847/python-once-and-for-all-what-does-the-star-operator-mean-in-python)。因此 zip 将`[1,2,3] [4,5,6] [7,8,9]`它们视为`[(1, 4, 7), (2, 5, 8), (3, 6, 9)]`. 然后最终的映射将元组转换为列表。

# html - 背景图像不是来自 joomla 2.5 中的 css

> ID：16179797
> 
> 赞同：1
> 
> 时间：2013-04-23T21:50:42.257
> 
> 标签：html, css, joomla2.5

背景图像不是来自 joomla 2.5 中的 css。我正在为背景图像编写这个 css 代码

```
background-image: url(images/abc-md.jpg); 
```

但是，如果我通过创建文件夹名称网站并在其中保留 html 代码和 css 来尝试在我的本地计算机上，并且图像被放置在名为 images 的文件夹中，该文件夹也保存在侧网站文件夹中

请帮助我如何在 joomla 中使图像来自 css，无论是内联还是外部

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T01:10:51.017

如果您在 CSS 中调用背景图像，则图像的路径是相对于 CSS 文件的，而不是您网站的根目录。

如果我理解正确，您的图像和 CSS 目录在您的网站文件夹中都处于同一级别，在这种情况下，您想要的是：

```
background-image: url(../images/abc-md.jpg); 
```

注意图像路径中的 ../。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T13:47:24.257

您正在编辑的样式表很可能是您的模板？在这种情况下，images/abc-md.jpg 将位于 /templates/your_template/images/ 而不是根目录中。

为简单起见，只需将 / 添加到图像的 URL：

```
background-image: url(/images/abc-md.jpg); 
```

如果它仍然不起作用，请尝试使用 firebug（或 chrome 开发工具）并查看是否完全选择了规则（可能您使用了错误的 css 选择器）*以及*是否可以加载图像*以及*是否容器大小足以显示它*并且*可能性是无穷无尽的，您为什么不尝试上述方法并让我们知道更多信息，即至少您的站点地址？

# javascript - Javascript conditional execution and simplification

> ID：16179798
> 
> 赞同：0
> 
> 时间：2013-04-23T21:50:43.370
> 
> 标签：javascript, jquery, refactoring, conditional-execution

I have the following script which works great however I think this can be simplify, right? also, I'd like it to trigger **only** once.

Example, user inputs "My Title". Script executes and user sees "my-title" in slug field. If user replaces title value by "My Crazy Title", I'd like the slug to remain "my-title". How?

```
$('#article_title').change(function() {
  str = $('#article_title').val();
  formatted = str.replace(/\s+/g, '-').toLowerCase();
  $('#article_slug').val(formatted);
}); 
```

See code example [http://jsfiddle.net/TSrYu/](http://jsfiddle.net/TSrYu/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:52:41.373

```
var changed = false;
$('#article_title').change(function () {
    // do some other stuff
    if (!changed) {
        str = $(this).val();
        formatted = str.replace(/\s+/g, '-').toLowerCase();
        $('#article_slug').val(formatted);
    }
    changed = true;
}); 
```

[http://jsfiddle.net/mohammadAdil/TSrYu/1/](http://jsfiddle.net/mohammadAdil/TSrYu/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T22:09:32.110

你可以这样简化：

1.  切换到使用`.one()`来注册您的事件处理程序，以便它只触发一次。
2.  删除中间变量并一次处理所有字符串

编码：

```
$('#article_title').one('change', function() {
    $('#article_slug').val($(this).val().replace(/\s+/g, '-').toLowerCase());
}); 
```

工作演示：http: [//jsfiddle.net/jfriend00/XGjWA/](http://jsfiddle.net/jfriend00/XGjWA/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:54:41.573

您可以进行两个小的改进：

*   没有通过正确声明变量来使变量全局化。
*   不再为元素查询 DOM，因为它已经可以通过访问`this`

为了确保它只发生一次，您可以取消绑定事件（片段中的最后一行

```
$('#article_title').change(function() {
  var str = $(this).val();
  var formatted = str.replace(/\s+/g, '-').toLowerCase();
  $('#article_slug').val(formatted);
  $(this).unbind("change");
}); 
```

# google-maps - fusion table: link two location with line

> ID：16179799
> 
> 赞同：1
> 
> 时间：2013-04-23T21:50:46.690
> 
> 标签：google-maps, kml, google-fusion-tables

Right now each row of my data contains two locations i.e. source and destination. Can I show some kind of link eg. a line between these locations within Maps in Fusion Table. I guess I might have to learn KML for that and will have to modify my data. Is their any other way of achieving this?

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T00:47:56.980

不幸的是，不可能“即时”创建这样的结果，您必须修改数据，例如通过添加基于源和目标的新列。

KML 语法是这样的：

```
<LineString>
<coordinates> [source.lng],[source.lat] [destination.lng],[destination.lat]</coordinates>
</LineString> 
```

从纽约到芝加哥的线路示例：

```
<LineString>
<coordinates> -74.0059731,40.7143528 -87.6297981,41.8781136</coordinates>
</LineString> 
```

注意：当您在 KML 中定义坐标时，顺序是`longitude,latitude`，它与 Maps-API 不同。

# python - solaris python setuptools 安装

> ID：16179800
> 
> 赞同：2
> 
> 时间：2013-04-23T21:50:48.433
> 
> 标签：python, solaris, setuptools, distutils

我有一个 solaris 主机：

```
SunOS blah 5.10 Generic_147441-27 i86pc i386 i86pc 
```

我有蟒蛇`/usr/bin/python`

```
$ /usr/bin/python
Python 2.6.4 (r264:75706, Jun 26 2012, 21:27:36) [C] on sunos5
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

问题是我似乎没有安装 setuptools，所以我下载了 tarball 并尝试：

```
setuptools-0.6c12dev-r88846$ /usr/bin/python setup.py install
Traceback (most recent call last):
  File "setup.py", line 4, in <module>
    from distutils.util import convert_path
ImportError: No module named distutils.util 
```

当然，因为我没有 distutils，所以我无法安装......以及任何东西。

我根本不熟悉solaris。一些谷歌搜索表明我需要安装 python-dev。我怎么做？还有其他建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-15T08:53:09.710

您可以使用来自 OpenCSW 的 Python。在那里你会得到一个 Python 包和许多模块，包括 setuptools。可用的 Python 版本是 Python 2.6 ( `CSWpython`)、2.7 ( `CSWpython27`) 和 3.3 ( `CSWpython33`)。大多数模块包可用于 Python 2.6 和 2.7。假设您已经[开始使用 OpenCSW](http://www.opencsw.org/manual/for-administrators/getting-started.html)并添加`/opt/csw/bin`到`PATH`，您可以：

```
sudo pkgutil -y -i python py_django 
```

要获取 Python 3.3 的模块，可以使用 virtualenv 和 pip 作为普通用户。例如：

```
sudo pkgutil -y -i python33 virtualenv
virtualenv -p /opt/csw/bin/python3.3 py3env
source py3env/bin/activate
pip install django 
```

# mysql - 查询以检索姓氏以特定字母开头的所有人

> ID：16179802
> 
> 赞同：0
> 
> 时间：2013-04-23T21:50:56.540
> 
> 标签：mysql, sql

如何编写查询以检索数据，仅使用特定的姓氏首字母。例如，我需要一个查询来检索以 A、B、C 和 E 开头的姓氏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:53:23.930

使用`LIKE`和`%`：

```
SELECT * FROM people WHERE last_name LIKE 'A%' OR last_name LIKE 'B%' OR last_name LIKE 'C%' OR last_name LIKE 'E%' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T22:43:09.120

非常感谢。使用您提供给我的模型，我开发了以下模型：

```
SELECT vendor_name,
  CONCAT(vendor_contact_last_name, ', ', vendor_contact_first_name) AS full_name
FROM vendors
WHERE vendor_contact_last_name LIKE 'A%' OR vendor_contact_last_name LIKE 'B%'
   OR vendor_contact_last_name LIKE 'C%' OR vendor_contact_last_name LIKE 'E%'
ORDER BY vendor_contact_last_name; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-06T08:39:58.747

**下面的 SQL 适用于大多数情况**

```
SELECT * FROM people WHERE last_name LIKE '[A-E]%'; 
```

括号表示从字母*A*到*E*的任何内容，百分比*(%)*表示后跟任意数量的任意字符。

**如果您正在运行 SQLite，您可以尝试以下 SQL**

```
SELECT * FROM people WHERE last_name >= 'A' and <= 'E'; 
```

希望这可以帮助。

# google-drive-api - Is permissionId unique for a user?

> ID：16179805
> 
> 赞同：1
> 
> 时间：2013-04-23T21:51:08.283
> 
> 标签：google-drive-api

Follow up to: [Replies, comments and changes lack userids](https://stackoverflow.com/questions/14999870/replies-comments-and-changes-lack-userids)

i.e. is there a one to one mapping permissionId a 1-1 mapping between a permission and a user?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T06:01:11.733

是的

根据 Google 支持人员的说法，是的。这是他们在内部使用的标识符，用于将每个帐户及其权限与文档相关联。

# java - android GridView, ListView and WebView in ScrollView

> ID：16179806
> 
> 赞同：0
> 
> 时间：2013-04-23T21:51:13.610
> 
> 标签：java, android, gridview, scrollview

I'm implementing mail application for Android. I need to display mail content in ScrollView. The problem is I also need to display attachment as image backed GridView or ListView. Since it is not recommended to put aScrollable layout in ScrollView, how to organize my layout to have adapter based views inside ScrollView?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T23:39:32.990

> 如何组织我的布局以在 ScrollView 中有基于适配器的视图？

你没有。

> 我需要在 ScrollView 中显示邮件内容。

为什么？为什么不将它显示在不可选择的第一行`ListView`？这样，它和列表的其余部分一致滚动。请记住，an可以为不同的行（通过和）`Adapter`提供不同的行类型、不同的布局。因此，您可以将第一行作为消息，其余行作为附件等。`getViewTypeCount()``getItemViewType()`

或者，使邮件内容可滚动`ScrollView`，但单独显示附件。

# webdriver - Chromedriver is extremely slow on a specific machine using Selenium Grid and .net

> ID：16179808
> 
> 赞同：28
> 
> 时间：2013-04-23T21:51:15.153
> 
> 标签：webdriver, mstest, selenium-webdriver, selenium-grid, selenium-chromedriver

**Overview:** Chromedriver works normally on one machine but extremely slowly on two other identical machines.

**Setup:**

*   Selenium Webdriver using .Net for coding and Selenium Grid for distributing the tests. MSTest is being used from within Visual Studio 2010 in order to run the tests.
*   A 64bit Windows 7 local machine acting as the Hub
*   Three 32-bit Win 7 remote machines (two of them are virtual) on my local network all configured as nodes. Here is the command used to start the nodes on the remote machines:

    java -jar c:\seleniumWebDriver\seleniumGrid\selenium-server-standalone-2.31.0.jar -role node -hub [http://XXX.XXX.XXX.XXX:4444/grid/register](http://XXX.XXX.XXX.XXX:4444/grid/register) -browser "browserName=chrome",maxInstances=4 -Dwebdriver.chrome.driver="C:\seleniumWebDriver\chromedriver.exe"

*   The driver is launched like this from within the code:

    DesiredCapabilities capability = new DesiredCapabilities(); capability.SetCapability(CapabilityType.BrowserName, browser); driver = new RemoteWebDriver(new Uri(hubUrl), capability);

*   The variable "browser" and "hubUrl" above is passed via an app.config file that is built at runtime. For this case, browser=chrome.

**Problem:**

*   When I setup machine 212 (which is a virtual machine) as a chrome node using the command above, and then launch the scripts from the hub, I see chrome start in the proper remote machine and run normally. It fields between 5-10 commands per second.

*   When I setup either machine 78 (virtual machine) or machine 103 (real machine) as a node in the same manner, and then launch the scripts from the hub, I see the node start up chrome properly. However, it runs extremely slowly, like 1 command per sec or less.

**Other info:** Like I said, on one machine chrome works normally, but on the others, runs extremely slowly. Firefox and IE, when configured as nodes, work normally.

I have compared the machine 212 (which works properly) with the other machines and cannot find the difference. All the machines are using 'selenium-server-standalone-2.31.0.jar' and the same version of the ChromeDriver.

It does not appear that the node machines are being overloaded. Also, it is a very consistent difference in performance which does not seem related to any fluctuating load on the network or the machines.

My network tech has verified that all these machines are configured identically on the network.

Has anybody seen anything like this before?

EDIT 1: I logged in today and all three remote machines are running chrome slowly. Before one of them was normal, but now they are all slow.

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-05-01T13:56:36.517

我遇到了类似的问题，chromedriver 在某些机器上运行缓慢，结果证明是代理问题。在 Chrome://settings >Change proxy settings> LAN Settings> 下禁用“自动检测设置”使 webdriver 在 Chrome 中为我更快地执行命令。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-10-15T12:50:07.600

我的代理设置没有使用自动检测，但我发现以下内容有很大帮助。启动驱动程序所需的时间从 43 秒下降到 1 秒

```
driver = new ChromeDriver(new ChromeOptions{Proxy = null}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-29T10:41:31.410

[chromedriver 问题中的错误链接](https://bugs.chromium.org/p/chromedriver/issues/detail?id=90&q=sendKeys&colspec=ID%20Status%20Pri%20Owner%20Summary)这是优先级最低的长期问题。但随着更多用户投票支持它，也许有人会修复它。它也可能[与代理配置的解析不符合标准有关](https://bugs.chromium.org/p/chromedriver/issues/detail?id=2537&q=proxy&colspec=ID%20Status%20Pri%20Owner%20Summary%60)，这将很快得到修复。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-06-13T08:35:23.853

此代码为我解决了 macOS 10.14.3 上 Chrome 75 的问题

```
ChromeOptions options = new ChromeOptions();
options.setProxy(null);
driver = new ChromeDriver(options); 
```

# javascript - 多次触发ajax加载内容事件

> ID：16179810
> 
> 赞同：0
> 
> 时间：2013-04-23T21:51:22.880
> 
> 标签：javascript, ajax, events, jquery

我有一个 div，其中有一个段落和一个按钮，如下所示：

```
<div id="my_div">
    <p>This is a paragraph</p>
    <button class="my_btn">Click here!</a>
</div> 
```

我的 div 中的内容是通过 Ajax 加载的。现在假设我的页面标题中有这样的东西来测试按钮：

```
$(function(){

    $(document).on('click', '.my_btn', function(){

        alert('my button works!');        

    });

}); 
```

我遇到的问题是，每次将内容与我的段落和按钮一起加载到我的 div 中时，当我单击按钮时，我都会收到相同的警报（'我的按钮有效！'），这意味着，如果内容加载了 100 次，我收到了 100 次警报，知道如何解决这个问题以及为什么会这样吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T22:12:21.933

这有点小技巧，但应该可以

```
 $(function(){

   $(document)
    .off()
    .on( 'click', '.my_btn', function(){

    alert('my button works!');        

  });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T22:23:00.337

您能否发布 ajax 调用以及如何加载 div 以获得更详细的说明。

也就是说，这里有一些似乎可以正常工作的示例代码。 [在这里摆弄](http://jsfiddle.net/wgxdj/1/)

```
<div id='data' style='display:none;'>
    <p>This is a paragraph</p>
    <button class="my_btn">Click here!</a></div>
<div id='target'></div>
<button class='load'>this load works</button> 
```

```
$(document).ready(function() {
    $(document).on('click', '.my_btn', function(){
        alert('my button works!');        
    });       
    $('.load').click(function() {
        $('#target').html($('#data').html());
    });    
}); 
```

# asp.net-mvc-4 - 如何格式化 iqueryable mvc 4 web api 请求？

> ID：16179812
> 
> 赞同：0
> 
> 时间：2013-04-23T21:51:26.750
> 
> 标签：asp.net-mvc-4, asp.net-web-api, odata, iqueryable

我想在我的所有集合上使用 iqueryable，以便获得所有 odata 功能。但是，我需要使用以下字段格式化请求的响应；

```
{
   href: "url to resouce",
   length: 10,
   items: [
     "(IQueryable results)"
   ]
} 
```

格式化响应并不是困难的部分，但保持所有 odata “东西”的工作是困难的。

所以我的代码看起来像；

```
MyFormattedResponse.Href = "poop.com";
MyFormattedResponse.Length = 0;
MyFormattedResponse.Items = _myRepo.Gets();
Request.CreateResponse(HttpStatusCode.OK, MyFormattedResponse); 
```

但我得到的错误是：

> 返回类型为“MyObject”的控制器“MyResource”上的“Get”操作不支持查询。确保返回内容的类型是 IEnumerable、IQueryable 或任一接口的通用形式。

这是我可以在媒体格式化程序或过滤器中构建的东西吗？

我真的很想保持 odata 的魅力......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T22:46:47.570

看看我提供的这个答案：

[Web API Queryable - 如何应用 AutoMapper？](https://stackoverflow.com/questions/14484692/web-api-queryable-how-to-apply-automapper/14490362#14490362)

您的情况类似，您可以执行以下操作：

```
public MyFormattedResponse Get(ODataQueryOptions<Person> query)
{
    var results = query.ApplyTo(_myRepo.Gets()) as IEnumerable<Person>;
    return new MyFormattedResponse() { Href = "foo.com", Length = 5, Items = results };
} 
```

确保删除该`[Queryable]`属性。

# ruby-on-rails - gmaps4rails 显示隐藏功能

> ID：16179814
> 
> 赞同：1
> 
> 时间：2013-04-23T21:51:32.543
> 
> 标签：ruby-on-rails, google-maps, gmaps4rails

我希望对 gmaps4rails 中的显示/隐藏功能有所了解。

[示例功能](http://www.geocodezip.com/v3_MW_example_categories.html)

```
 // == shows all markers of a particular category, and ensures the checkbox is checked ==
  function show(category) {
    for (var i=0; i<gmarkers.length; i++) {
      if (gmarkers[i].mycategory == category) {
        gmarkers[i].setVisible(true);
      }
    }
    // == check the checkbox ==
    document.getElementById(category+"box").checked = true;
  }

  // == hides all markers of a particular category, and ensures the checkbox is cleared ==
  function hide(category) {
    for (var i=0; i<gmarkers.length; i++) {
      if (gmarkers[i].mycategory == category) {
        gmarkers[i].setVisible(false);
      }
    }
    // == clear the checkbox ==
    document.getElementById(category+"box").checked = false;
    // == close the info window, in case its open on a marker that we just hid
    infowindow.close();
  }

  // == a checkbox has been clicked ==
  function boxclick(box,category) {
    if (box.checked) {
      show(category);
    } else {
      hide(category);
    }
    // == rebuild the side bar
    makeSidebar();
  }

  function myclick(i) {
    google.maps.event.trigger(gmarkers[i],"click");
  }

  // == rebuilds the sidebar to match the markers currently displayed ==
  function makeSidebar() {
    var html = "";
    for (var i=0; i<gmarkers.length; i++) {
      if (gmarkers[i].getVisible()) {
        html += '<a href="javascript:myclick(' + i + ')">' + gmarkers[i].myname + '<\/a><br>';
      }
    }
    document.getElementById("side_bar").innerHTML = html;
  } 
```

所以，在我的控制器中，我正在构建一个标记列表，并将它们的类别包括为 json。

```
@markersLoc = @locSearch.to_gmaps4rails do |loc, marker|
  letter.next!
  marker_image = "http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=#{letter}|82ABDD|000000"
  marker.infowindow render_to_string(partial: '/events/info', 
                                     locals: {object: loc})
  marker.picture({picture: marker_image,
                  width: 32,
                  height: 32,
                  marker_anchor: [11,30],
                  shadow_picture: "http://chart.apis.google.com/chart?chst=d_map_pin_shadow",
                  shadow_width: 110,
                  shadow_height: 110,
                  shadow_anchor: [12,34]})
  marker.title loc.what
  marker.sidebar render_to_string(partial: '/events/sidebar', 
                                  locals: {object: loc, letter: marker_image})
  marker.json({cat: loc.category})
end 
```

我有点卡住了，在这里。我知道该`:cat`字符串可用（例如：1,3,4），但我不确定如何使用它来实现我所追求的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T22:15:59.187

能够几乎使用那里的东西，并进行一些修改。这让我拥有 9 个类别（可能或多或少）的功能，并且只查看我想要的内容。惊人的。

```
// == shows all markers of a particular category, and ensures the checkbox is checked ==
function show(category) {
  var regEx = new RegExp("[" + category + "]")
  for (var i=0; i<Gmaps.map.markers.length; i++) {
    if (Gmaps.map.markers[i].cat) {
      if (Gmaps.map.markers[i].cat.match(regEx)) {
        Gmaps.map.showMarker(Gmaps.map.markers[i]);
      }
    }
  }
  // == check the checkbox ==
  document.getElementById(category+"box").checked = true;
}

// == hides all markers of a particular category, and ensures the checkbox is cleared ==
function hide(category) {
  var regEx = new RegExp("[" + category + "]")
  for (var i=0; i<Gmaps.map.markers.length; i++) {
    if (Gmaps.map.markers[i].cat) {
      if (Gmaps.map.markers[i].cat.match(regEx)) {
        Gmaps.map.hideMarker(Gmaps.map.markers[i]);
      }
    }
  }
  // == clear the checkbox ==
  document.getElementById(category+"box").checked = false;
  // == close the info window, in case its open on a marker that we just hid
  // Gmaps.map.infowindow.close();
}

// == a checkbox has been clicked ==
function boxclick(box,category) {
  if (box.checked) {
    show(category);
  } else {
    hide(category);
  }
} 
```

# jquery - jquery error on page without any scripts

> ID：16179818
> 
> 赞同：0
> 
> 时间：2013-04-23T21:51:52.520
> 
> 标签：jquery

getting the following error with jquery.

getting this without any jquery syntax in the head sections.

any ideas?

jquery 1.9.1

```
TypeError: a is undefined
[Break On This Error]   

...function(b,d){var f=d.nextPage,g,h=new a.Event("pageremove");d.nextPage&&(g=f.jq... 
```

my head is:

```
 <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
 <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script> 
```

Thanks in advance...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T21:53:49.990

我很确定 jquery mobile 应该在 jquery 之后，因为它取决于它。尝试切换它们的加载顺序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T21:53:44.830

更改行顺序 - 将 jQuery 行放在 jQuery-mobile 之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:55:36.990

按此顺序包含脚本/css：

```
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery-ui.min.css" />
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script> 
<script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script> 
```

由于 jQuery mobile 和 jQuery UI 都依赖`jquery.min.js`，所以必须在`jquery.min.js`.

# zend-framework - How to set view variables to multiple different view in one controller [zend]?

> ID：16179821
> 
> 赞同：0
> 
> 时间：2013-04-23T21:52:14.213
> 
> 标签：zend-framework, view, controller

I have stuck with implementing a simple scenario. I have 2 views for a single controller

```
MyController 
  view/scripts/my/index.phtml
                 /index2.phtml 
```

I know `$this->view->test = "test"` will set 'test' view variable for `index.phtml`. but I would like to know how to set a variable for `index2.phtml`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:56:20.523

在你的控制器中设置`$this->view->test = "test"`将设置视图变量，这些变量可以被之后通过调用渲染的任何模板使用：

`$this->render('your action');`

例如：

```
class MyController extends Zend_Controller_Action
{
    public function indexAction()
    {
        $this->view->test = "test"

        // Renders my/index.phtml
        $this->render();

        // Renders my/index2.phtml
        $this->render('index2');    
    }
} 
```

在这两个模板中，您都可以访问该`test`属性。

# xcode - 共享未签名的 OSX 应用程序

> ID：16179824
> 
> 赞同：-5
> 
> 时间：2013-04-23T21:52:21.120
> 
> 标签：xcode, macos, dmg

我刚刚开始开发一些 OSX 应用程序，并且在我有一些合法的东西可以发布之前，我不想支付 99 美元的开发人员费用。我的问题是，我试图通过在 Xcode 中将它们存档为未签名的应用程序来与一些朋友分享我拥有的小应用程序。虽然我可以通过电子邮件和空投发送这些并且效果很好，但如果我想将其中一个放在 Mediafire 之类的网站上以便其他人可以下载它们（我不必单独向每个人发送电子邮件），该应用程序被分成一堆不同的文件，用于图标、plist 等。有什么方法可以共享这样的未签名应用程序并保留它，以便人们可以按原样下载和打开应用程序？（或者做一些类似 dmg 的事情，这似乎是许多 3rd 方应用程序所走的路线）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:59:28.100

转到查找器并压缩您创建的应用程序。这可以通过选择您的应用程序然后选择**File > Compress**轻松完成。ZIP 文件适合下载，但会向用户显示他们正在使用未签名二进制文件的警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T22:04:57.277

您可以使用 Xcode 创建存档，转到 Organizer，选择顶部的 Archives 选项卡，然后选择 Distribute、Save for Enterprise 或 Ad-Hoc Deployment。然后你必须选择你的开发代码签名身份。单击下一步，它将询问您要将 .ipa 文件保存在哪里。

您可以将其与您的开发配置文件一起分发，并让您的朋友将 ipa 和配置文件拖放到 iTunes 上以安装该应用程序。

我知道这适用于 Ad Hoc 分发（您可能需要支付 99 美元），但它可能只适用于开发人员证书/配置文件。

# iphone - Reverse array content?

> ID：16179826
> 
> 赞同：0
> 
> 时间：2013-04-23T21:52:31.787
> 
> 标签：iphone, arrays, sdk, reverse, mailcore

I am populating a table view with information, but would like it to be populated in reverse, so that any newly added cells (new email messages) would appear on the top, not the bottom.

What am I doing wrong?

```
 - (UITableViewCell *)tableView:(UITableView *)tableView
         cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *simpleTableIdentifier = @"MailCell";

    MailCell *cell = (MailCell *)[tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];
    if (cell == nil)
    {
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"MailCell" owner:self options:nil];
        cell = [nib objectAtIndex:0];

        // SLICK
        // Anything that should be the same on EACH cell should be here.

        UIView *myBackView = [[UIView alloc] initWithFrame:cell.frame];
        myBackView.backgroundColor = [UIColor colorWithRed:15.0/255.0 green:140.0/255.0 blue:198.0/255.0 alpha:1];
        cell.selectedBackgroundView = myBackView;

        cell.selectionStyle = UITableViewCellSelectionStyleGray;
        cell.messageText.textAlignment = NSTextAlignmentLeft;
        cell.messageText.lineBreakMode = NSLineBreakByTruncatingTail;
    }

    NSUInteger row = [indexPath row];

    // Extract Data

    // Use the message object instead of the multiple arrays.

    CTCoreMessage *message = [[self allMessages] objectAtIndex:row];

    // Sender

    CTCoreAddress *sender = [message sender];
    NSString *senderName = [sender name];

    // Subject

    NSString *subject = [message subject];
    if ([subject length] == 0)
    {
        subject = @"(No Subject)";
    }

    // Body

    BOOL isPlain = YES;
    NSString *body = [message bodyPreferringPlainText:&isPlain];
    body = [body stringByReplacingOccurrencesOfString:@"\n" withString:@" "];
    body = [body stringByReplacingOccurrencesOfString:@"\r" withString:@" "];

    // Populate Cell

    [[cell nameText] setText:senderName];
    [[cell subjectField] setText:subject];
    [[cell messageText] setText:body];

    if ([message isUnread])
    {
        UIColor *myColor = [UIColor colorWithRed:15.0/255.0 green:140.0/255.0 blue:198.0/255.0 alpha:1.0];
        cell.nameText.textColor = myColor;
    }
    else
    {
        cell.nameText.textColor = [UIColor blackColor];
    }

    return cell;

} 
```

How I am loading the array:

```
- (NSMutableArray *)allMessages
{
    if (_allMessages == nil)
    {
        _allMessages = [[NSMutableArray alloc] init];
    }
    return _allMessages;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:02:04.897

您正在从 NSArray 索引中拉取，`[indexPath row]`这意味着您从索引 0 开始并到 n。这意味着您的顺序不是相反的。你需要先反转你的数组。一个简单的方法是：

```
- (void)viewWillAppear:(BOOL)animated
{
    NSArray *allMessages = [self allMessages];
    NSArray* reversedMessages = [[allMessages reverseObjectEnumerator] allObjects];
} 
```

然后在您的`cellForRowAtIndexPath`方法中，您可以执行以下操作：

```
CTCoreMessage *message = [reversedMessages objectAtIndex:row]; 
```

# ios - View Controller not deallocated after adding GameKit

> ID：16179827
> 
> 赞同：0
> 
> 时间：2013-04-23T21:52:31.837
> 
> 标签：ios, memory-management, uiviewcontroller, game-center, gamekit

My view controller no longer gets deallocated after adding the following:

```
@property (strong, nonatomic) GKLocalPlayer *player;

(in viewDidLoad)
self.player = nil;
[self authenticatePlayer];

- (void)authenticatePlayer
{
    GKLocalPlayer *localPlayer = [GKLocalPlayer localPlayer];    
    __unsafe_unretained typeof(*localPlayer) *blockLocalPlayer = localPlayer;

    localPlayer.authenticateHandler =
    ^(UIViewController *authenticateViewController, NSError *error)
    {
        if (authenticateViewController != nil)
        {
            [self presentViewController:authenticateViewController animated:YES
                             completion:nil];
        }
        else if (blockLocalPlayer.isAuthenticated)
        {

            self.player = blockLocalPlayer;
            [self openGame];
        }
        else
        {
            // Disable Game Center
            self.player = nil;
            [self openGame];
        }
    };
}

- (void)setPlayer:(GKLocalPlayer *)player
{
    _player = player;
    NSString *playerName;
    if (_player)
    {
        playerName = _player.alias;
    }
    else
    {
        playerName = @"Anonymous Player";
    }
    NSLog(@"%@", [NSString stringWithFormat:@"Welcome %@", playerName]);
} 
```

The problem occurs whether or not the user connects to game center. There must be something in the code that is causing the view controller to remain in memory after it gets dismissed. If I comment these lines out:

```
self.player = nil;
[self authenticatePlayer]; 
```

the view controller will properly get deallocated when dismissed.

EDIT: My hunch was correct. From Apple docs:

> Game Kit maintains a strong reference to your completion handler even after successfully authenticating a local player. If your game moves into the background, Game Kit automatically authenticates the player again whenever your game moves back to the foreground. Game Kit calls your same completion handler each time it authenticates the local player. Be mindful that in block programming, any Objective-C object referenced inside a block is also strongly referenced by the block until the block is released. Because Game Kit maintains a strong reference to your completion handler until your game terminates, any objects referenced from within your authentication handler are also held indefinitely.

This is a problem for me though. I'm using Cocos2d and it has problems resetting its view unless the view controller is completely deallocated and created fresh.

Is there any way to get Game Kit to let go of my view controller?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T02:56:15.287

厌倦了处理这个问题并将 GameKit 身份验证代码移动到不同的视图控制器，在那里释放它并不重要。

# c++ - putting some class methods in different .cc file

> ID：16179829
> 
> 赞同：1
> 
> 时间：2013-04-23T21:52:41.230
> 
> 标签：c++

I have a bit of code of the following format contained in a single .h and .cc file:

myClass.h:

```
#ifndef MYCLASS_H
#define MYCLASS_H
class myClass
{
public:
    myClass(); // constructor
    ~myClass(); // destructor

    void classMethod1 ();
    void classMethod2 ();

    int memberVarable1;
    int memberVariable2;
};
#endif 
```

and myClass.cc:

```
#include "myClass.h"
myClass::myClass(){
 // stuff
}

myClass::~myClass(){
 // stuff
}

void myClass::classMethod1 (){
 // stuff
}

void myClass::classMethod2 (){
 // stuff
} 
```

All of this is working fine. However my project is getting quite large and I'm about to add a set of new functionality. Instead of clogging up myClass.h and myClass.cc I want to put some new methods in another .cc file. I don't seem to be able to get this to work though.

myClass.h:

```
#ifndef MYCLASS_H
#define MYCLASS_H

#include "secondFile.h"

class myClass
    {
    public:
        myClass(); // constructor
        ~myClass(); // destructor

        void classMethod1 ();
        void classMethod2 ();

        int memberVarable1;
        int memberVariable2;
    };
#endif 
```

and myClass.cc:

```
#include "myClass.h"
#include "secondFile.h"
myClass::myClass(){
 // stuff
}

myClass::~myClass(){
 // stuff
}

void myClass::classMethod1 (){
 // stuff
}

void myClass::classMethod2 (){
 // stuff
} 
```

secondFile.h:

```
#ifndef SECONDFILE_H
#define SECONDFILE_H

void someNewMethod();

#endif 
```

secondFile.cc

```
#include "secondFile.h"
void someNewMethod(){
 // can't see classMethod1()
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:55:54.663

在每个源文件中，您需要包含每个声明要使用的函数等的头文件。

因此，在您的情况下，您似乎希望 secondFile.cc 包含

```
#include "myClass.h"
#include "secondFile.h"
void someNewMethod(){
 // can't see classMethod1()
} 
```

顺便说一句，您正在做的事情在实践中很常见。有时，我比您建议的更进一步，并在多个源文件中实现单个类的各种方法。对于大型、复杂的类，这有助于加快开发周期，因为如果我只进行了很小的更改，我只需要重新编译一小部分类实现。例子：

我的班级.h

```
#pragma once

class MyClass
{
  ...
  void complicatedMethod0();
  void complicatedMethod1();
  ...
}; 
```

myclass_impl0.cpp

```
#include "myclass.h"

void MyClass::complicatedMethod0()
{
  ...
} 
```

myclass_impl1.cpp

```
#include "myclass.h"

void MyCLass::complicatedMethod1()
{
  ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T22:03:40.723

如果您打算向 中*添加*方法`myClass`，则不能这样做 - 类方法必须包含在一个定义中。

但是，您可以通过*继承来**扩展* ：`myClass`

 *第二文件.h：

```
#ifndef SECONDFILE_H
#define SECONDFILE_H

#include "myClass.h"

class mySecondClass : public myClass
{
    public: 
        void someNewMethod();
}
#endif 
```

第二文件.cc

```
#include "secondFile.h"
void mySecondClass::someNewMethod(){
     this.classMethod1();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:56:43.440

```
#include "secondFile.h"
#include "myClass.h" 
//if you want the class methods, 
//you need to tell the compiler where to look
void someNewMethod(){
 // can't see classMethod1()
} 
```

您似乎忘记包含“myClass.h”。*

# java - imagemagick convert : tiff 警告/创建了多个输出文件

> ID：16179838
> 
> 赞同：1
> 
> 时间：2013-04-23T21:53:40.493
> 
> 标签：java, imagemagick-convert

我正在开发一个使用 ImageMagick 转换实用程序将 tiff 转换为 jpg 的 java 应用程序。

我们的工作流程是先做tiff->jpg；创建缓冲的 img obj 以获取尺寸，然后缩放新尺寸，然后再次运行 convert 以使用新尺寸和其他一些选项调整大小。

这在绝大多数情况下都能正常工作，但在某些情况下，我会收到一些 tiff 警告，虽然 img 转换最终成功，但 convert 会创建一些有问题的临时图像。这是它在命令行上的样子：

```
>convert testImg.tif test.jpg
convert.exe: Unknown field with tag 317 (0x13d) encountered. `TIFFReadDirectory @ warning/tiff.c/TIFFWarnings/824.
convert.exe: Unknown field with tag 34391 (0x8657) encountered. `TIFFReadDirectory' @ warning/tiff.c/TIFFWarnings/824.
convert.exe: Unknown field with tag 34392 (0x8658) encountered. `TIFFReadDirectory' @ warning/tiff.c/TIFFWarnings/824.
convert.exe: testImg.tif: Null count for "Tag 34391" (type 1, writecount -3, pascount 1). `_TIFFVSetField' @ error/tiff.c/TIFFErrors/562.
convert.exe: Unknown field with tag 317 (0x13d) encountered. `TIFFReadDirectory @ warning/tiff.c/TIFFWarnings/824. 
```

开始时

```
testImg.tif 
```

输出是

```
test-0.jpg
test-1.jpg 
```

我们的解决方法是先转换 tif->gif 然后 gif->jpg ，这似乎可以解决它，但想知道是否有人遇到过这个特殊问题。

顺便说一句，我们使用 convert 工具是因为我们发现 JMagick 非常不可靠。如果有人成功使用它，将有兴趣听到有关如何提供信息的任何想法。

谢谢！bp

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-29T21:13:40.093

我根本不是 java 专家，但遇到了 imagemagick 的多图像问题。这是由于 tiff 文件包含图层。imagemagick 将输出 tiff 中的每一层。要获得一个特定的层，只有 1...

> 转换 image.tif[0] image.jpg

现在这可能会影响质量。您可能想要转换两者，并且对于制作的每一层，将它们组合为 0-first 1 秒。根据我的发现，第一个图层之后的分辨率较低。

# android - Android WebView 全屏播放 flash/YouTube 视频

> ID：16179842
> 
> 赞同：2
> 
> 时间：2013-04-23T21:53:49.373
> 
> 标签：android, android-widget, youtube, android-webview

我想要完成的是，当 a 中有嵌入的 iframe YouTube 视频`WebView`并且用户开始播放视频然后单击全屏按钮时，我希望它以全屏显示`Dialog`，而不是像[https这样的建议://code.google.com/p/html5webview/source/browse/trunk/HTML5WebView/src/org/itri/html5webview/HTML5WebView.java](https://code.google.com/p/html5webview/source/browse/trunk/HTML5WebView/src/org/itri/html5webview/HTML5WebView.java)

我在`WebView`和 中都播放了视频`Dialog`，但是，全屏对话框中没有播放器控件。下面是迄今为止让它在对话框中播放的被黑代码。

```
 webView.setWebChromeClient(new WebChromeClient() {
            View mVideoProgressView;

            Bitmap mDefaultVideoPoster;

            Dialog fullScreenDialog;

            WebChromeClient.CustomViewCallback mCustomViewCallback;

            @Override
            public void onShowCustomView(View view, CustomViewCallback callback) {
                super.onShowCustomView(view, callback);
                if (view instanceof FrameLayout) {

                    FrameLayout frameLayout = (FrameLayout) view;
                    mCustomViewCallback = callback;
                    fullScreenDialog = new Dialog(DemoActivity.this, R.style.full_screen_dialog);
//                    fullScreenDialog = new Dialog(DemoActivity.this, R.style.Dialog_Fullscreen);
                    LinearLayout linearLayout = (LinearLayout) getLayoutInflater().inflate(R.layout.full_screen_video_view, null);
                    FrameLayout.LayoutParams params = new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT);
                    params.gravity = Gravity.CENTER;

                    SurfaceView surfaceView = (SurfaceView)frameLayout.getFocusedChild();
                    surfaceView.bringToFront();
                    surfaceView.setZOrderMediaOverlay(true);
                    surfaceView.setZOrderOnTop(true);
                    surfaceView.setLayoutParams(params);

//                    frameLayout.removeAllViews();
//                    linearLayout.addView(surfaceView);

//                    fullScreenDialog.setContentView(view, params);
                    frameLayout.removeAllViews();
                    fullScreenDialog.setContentView(surfaceView);
                    fullScreenDialog.show();
                }
            }

            @Override
            public void onHideCustomView() {
                if (fullScreenDialog != null && fullScreenDialog.isShowing()) {
                    fullScreenDialog.dismiss();
                }
                if (mCustomViewCallback != null) {
                    mCustomViewCallback.onCustomViewHidden();
                    mCustomViewCallback = null;
                }
            }

            @Override
            public Bitmap getDefaultVideoPoster() {
                if (mDefaultVideoPoster == null) {
                    mDefaultVideoPoster = BitmapFactory.decodeResource(getResources(), R.drawable.default_video_poster);
                }
                return mDefaultVideoPoster;
            }

            @Override
            public View getVideoLoadingProgressView() {
                if (mVideoProgressView == null) {
                    LayoutInflater inflater = getLayoutInflater();
                    mVideoProgressView = inflater.inflate(R.layout.video_loading_progress, null);
                }
                return mVideoProgressView;
            }
        }); 
```

我的 full_screen_dialog 风格很简单：

```
<style name="full_screen_dialog">
        <!--<item name="android:windowFrame">@null</item>-->
        <!--<item name="android:windowIsFloating">true</item>-->
        <!--<item name="android:windowContentOverlay">@null</item>-->
        <!--<item name="android:windowAnimationStyle">@android:style/Animation.Dialog</item>-->
        <!--<item name="android:windowSoftInputMode">stateUnspecified|adjustPan</item>-->
        <item name="android:windowFullscreen">true</item>
        <item name="android:windowNoTitle">true</item>
    </style> 
```

这些`WebView`设置启用了 javascript 和插件。

此贴有许多类似的问题，但没有一个试图在全屏对话框中打开视频。任何帮助将不胜感激！

# asp.net - ASPX 页面加载上次会话的数据

> ID：16179863
> 
> 赞同：0
> 
> 时间：2013-04-23T21:55:05.363
> 
> 标签：asp.net, loading

我正在使用 ASP.net 前端创建一个 C# 应用程序，但是我现在遇到了问题。我希望用户输入一些信息，这些信息一旦提交，将显示在页面上的列表框中，效果很好。但是，一旦我关闭页面，停止调试程序并再次运行它 - 信息仍然显示，但我希望它从空白开始。在这里，如果我认为导致问题的 ASPX 页面，这让我发疯。

```
public partial class CarBootSaleForm : System.Web.UI.Page, ISaleManagerUI
{
    private SaleList saleList; 

    protected void Page_Load(object sender, EventArgs e)
    {

        if (IsPostBack && Application["SaleList"] != null)
        {
            LoadData();
        }
        else
        {
            saleList = (SaleList)Application["SaleList"];
        }

        if (saleList != null)
        {
            UpdateListbox();
        }

    }

    private void UpdateListbox()
    {
        lstSales.Items.Clear();

        if (saleList != null)
        {
            for (int i = 0; i < saleList.Count(); i++)
            {
                lstSales.Items.Add(new ListItem(saleList.getSale(i).ToString()));
            }
        }
    }

    protected void btnAdd_Click(object sender, EventArgs e)
    {
        Application.Lock();
        Application["SaleList"] = saleList;
        Application.UnLock();

        Response.Redirect("AddSaleForm.aspx");
    }

} 
```

忘记`LoadData()`页面内加载，因为它目前实际上没有加载任何内容:)

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:18:21.700

除非您重新启动 Web 服务器，否则不会刷新存储在应用程序状态中的变量，因此如果您使用 IIS，则需要使用 iisreset 命令（在命令行上），或者您需要停止 ASP.NET Web 服务器（每次调试会话后使用托盘图标）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T22:03:09.317

如果不是回发，您可以添加 Session.Abandon(); 在 Page_load 的 else 块中。

杀死会话：

[如何终止会话或会话 ID (ASP.NET/C#)](https://stackoverflow.com/questions/5330268/how-to-kill-a-session-or-session-id-asp-net-c)

# django - 为什么 url 函数在 Django 1.5 文档中使用得更频繁？

> ID：16179868
> 
> 赞同：0
> 
> 时间：2013-04-23T21:55:38.087
> 
> 标签：django

我正在使用一些较旧的 Django 代码，并且该`url`函数未在任何地方使用，类似于[Django 1.4 文档](https://docs.djangoproject.com/en/1.4/topics/http/urls/)中的示例：

```
from django.conf.urls import patterns, url, include

urlpatterns = patterns('',
    (r'^articles/2003/$', 'news.views.special_case_2003'),
    (r'^articles/(\d{4})/$', 'news.views.year_archive'),
    (r'^articles/(\d{4})/(\d{2})/$', 'news.views.month_archive'),
    (r'^articles/(\d{4})/(\d{2})/(\d+)/$', 'news.views.article_detail'),
) 
```

[但我在Django 1.5 文档](https://docs.djangoproject.com/en/1.5/topics/http/urls/)中注意到该`url`函数经常使用：

```
from django.conf.urls import patterns, url

urlpatterns = patterns('',
    url(r'^articles/2003/$', 'news.views.special_case_2003'),
    url(r'^articles/(\d{4})/$', 'news.views.year_archive'),
    url(r'^articles/(\d{4})/(\d{2})/$', 'news.views.month_archive'),
    url(r'^articles/(\d{4})/(\d{2})/(\d+)/$', 'news.views.article_detail'),
) 
```

为什么是这样？这是惯例问题，还是有使用该`url`功能的技术原因？将来我应该遵循哪种做法，我应该如何在没有`url`调用的情况下维护我的遗留代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T22:05:43.547

从[文档](https://docs.djangoproject.com/en/1.4/topics/http/urls/#url)

> url（正则表达式，视图，kwargs=无，名称=无，前缀=''）
> 
> 您可以使用 url() 函数而不是元组作为 patterns() 的参数。如果您想指定一个没有可选额外参数字典的名称，这很方便。例如：

```
urlpatterns = patterns('',
    url(r'^index/$', index_view, name="main-view"),
    ...
) 
```

然后您将它们用于反向 URL 匹配（同样，[文档](https://docs.djangoproject.com/en/1.4/topics/http/urls/#id2)）

您可以将第一个示例转换为：

```
url(r'^articles/2003/$', special_case_2003, name="special_case_2003"), 
```

并在您的模板中调用它

```
{% url special_case_2003 %} 
```

是的，也许您发布的两个示例对此有点太模糊了

# ios - 图层定位仅适用于 4.3 目标

> ID：16179869
> 
> 赞同：0
> 
> 时间：2013-04-23T21:55:39.197
> 
> 标签：ios, uiscrollview, cocos2d-iphone

我制作了`UIScrollView`基于 Cocos 层的滚动机制，下面是`UIScrollView`派生类的部分代码：

```
- (id)initWithFrame:(CGRect)scrollFrame contentFrame:(CGRect)contentFrame layer:(CCNode*)layer anchor:(int)anchor_
{
    self = [super initWithFrame:scrollFrame];
    if (self) {
        self.contentSize = contentFrame.size;
        self.delegate = self;
        self.bounces = YES;
        self.delaysContentTouches = NO;
        self.pagingEnabled = YES;
        self.scrollsToTop = NO;
        self.showsVerticalScrollIndicator = NO;
        self.showsHorizontalScrollIndicator = NO;

        self.alwaysBounceHorizontal = YES;
        self.alwaysBounceVertical = YES;
        self.decelerationRate = UIScrollViewDecelerationRateNormal;

        [self setUserInteractionEnabled:TRUE];
        [self setScrollEnabled:TRUE];
        self.targetLayer = layer;
        anchor = anchor_;
    }
    return self;
}

- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
    CGPoint dragPt = [scrollView contentOffset];
    dragPt = [[CCDirector sharedDirector] convertToGL:dragPt];
    dragPt.y = targetLayer.position.y;
    dragPt.x = dragPt.x * -1 + anchor;
    CGPoint newLayerPosition = CGPointMake(dragPt.x, dragPt.y);
    [targetLayer setPosition:newLayerPosition];
} 
```

它需要新的偏移量并移动目标层。很奇怪，我使用 4.3 作为目标 iOS 版本开始这个项目，并且图层滚动得很好。今天我尝试了 5.0/above 并且...我在调试器中看到了新的偏移量，但是图层在滚动期间根本不会改变它在屏幕上的位置。只有当页面发生变化时，我才能立即看到图层的新部分。我怀疑与 Cocos 2.0 有关。

更新：这就是我在 4.3 上所做的工作

[http://www.youtube.com/watch?feature=player_embedded&v=xp6bPyAVShk](http://www.youtube.com/watch?feature=player_embedded&v=xp6bPyAVShk)

同样，这不适用于 iOS 5 或更高版本。我不知道在哪里寻找问题，搜索什么......请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T05:04:59.573

您可以使用**CCBReader**库中的CCScrollView

在这里我添加了 github 存储库 [https://github.com/cocos2d/CCBReader](https://github.com/cocos2d/CCBReader)

这个库是关于 Cocos Builder 的阅读器，Cocos2D 的图形界面构建器，它是免费的

Cocos2D 不建议在 cocos 层上使用 uikit，CCScrollView 易于实现，适用于 cocos2D 的最新版本和目标 4.3 及以上。

**编辑：**
这里 的**CCScrollLayer 支持**分页 GitHub 存储库

[https://github.com/cocos2d/cocos2d-iphone-extensions/tree/master/Extensions/CCScrollLayer](https://github.com/cocos2d/cocos2d-iphone-extensions/tree/master/Extensions/CCScrollLayer)

也许你需要在新版本的 cocos2D 中为 touch delegate 稍微修改一下这个类

# java - 我的程序中的大 O 复杂性是否正确

> ID：16179870
> 
> 赞同：0
> 
> 时间：2013-04-23T21:55:39.587
> 
> 标签：java, big-o

我正在学习所有关于大 O 的知识，并且我试图了解我的每个程序的大复杂性。我想确保我的复杂性是正确的。

方案一：

第 1 步 - 从文件中读取所有单词`O(n)`，n 是词表的大小 第 2 步 - 遍历每个单词的字符并对其进行操作（我不会详细说明它的作用，它只是一个循环）-`O(m)`其中 m 是单词中的字符数第 3 步 - 插入 HashMap`O(1)`

全部的 -`O(n + m)`

程序 2： 步骤 1 - 将单词传递给程序步骤 2 - 在 hashmap 中查找单词 -`O(1)` 步骤 3 - 循环遍历每个单词的字符并对其进行操作`O(m)`，其中 m 是单词中的字符数 步骤 4 - 将单词输入一个函数 - 我计算得到`O(2^m)`，其中 m 是单词中的字符数 第 5 步 - 在 hashmap 中再次查找单词`O(1)`

```
O(2^m + m) 
```

程序不涉及 O(n)，因为我只是在查找 hashmap。遍历传入单词的字符的唯一复杂性

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:58:52.933

遍历所有单词中的所有字符是 O(n*m)，其中 n 是单词数，m 是单词的最大长度

哈希图的插入和查找在技术上是 O(n) （如果所有元素散列到相同的值），但如果你的教授说它是 O(1) 那就去吧

在不知道函数是什么的情况下，我们无法帮助您完成“第 4 步 - 将单词输入函数”

# c++ - Code::Blocks - 奇怪的返回码

> ID：16179872
> 
> 赞同：1
> 
> 时间：2013-04-23T21:56:13.007
> 
> 标签：c++, return-value, codeblocks

我使用 Code::Blocks 运行以下命令

```
#include <iostream>

using namespace std;

int main()
{
    cout << "Hello, world !!!!!!!";
    return 0;
} 
```

现在，昨晚有一些关于我如何知道我的返回值的问题。我不知道它是否是我的版本，但是在程序在我的版本上运行后，它会显示“进程返回 v (0xv) 执行时间......”等等，其中“v”是返回值。

现在，这就是我要问的，这是我能做到的。

当我运行它时，它返回值 1993075819 而不是 0。此外，程序没有运行，它所做的只是向我显示返回的值。

有两点值得注意：

1.  每次我尝试执行此操作时都会弹出 AVG，并将其报告为特洛伊木马

2.  如果我没有运行代码

    ```
    cout << "Hello, world!!!!"; 
    ```

它按应有的方式返回 0，并且 AVG 不会弹出

我怎样才能解决这个问题？（代码::块 12.11）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T22:05:51.457

禁用 AVG 或将其配置为不抱怨您的可执行文件。出于某种原因，启发式方法会误解可执行文件中的某些位模式，就好像它是特洛伊木马一样，并在它启动之前将其杀死。您获得的结果代码来自被拦截的程序调用（即防病毒软件），而不是来自您甚至没有运行的程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T22:02:15.440

问题不在于您的代码，而在于 AVG 产生的误报。返回码 1993075819 是因为 AVG 拦截了程序，不让它运行。

您可以[向 AVG 报告误报](http://samplesubmit.avg.com/us-en/false-detection)。病毒供应商实际上非常擅长修复用户报告的误报。当我曾经在一家产生大量误报的公司工作时（与安全相关的代码会做一些引发误报的古怪事情），周转时间通常约为一周。

同时，如果您使用不同的编译器开关（例如，如果当前未优化则优化编译，反之亦然），您生成的代码很有可能不会触发误报。

您还可以将已编译的程序添加到 AVG 安全列表中：

[http://www.ehow.com/how_8192066_add-exceptions-avg.html](http://www.ehow.com/how_8192066_add-exceptions-avg.html)

# android - 我正在为我的 android 应用程序使用 Sqlite，我想按分数列中的值从最高到最低排序我的 Db

> ID：16179874
> 
> 赞同：0
> 
> 时间：2013-04-23T21:56:36.743
> 
> 标签：android, sqlite, sql-order-by

我将 Sqlite 用于我的 android 应用程序，我想按分数列中的值从最高到最低排序我的 Db。

我正在使用这种方法

```
Cursor cur = query ("Gamestable", String[] columns, String selection, String[] selectionArgs, String groupBy, String having, String orderBy) 
```

不知道如何填写其余部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:58:30.513

如果您只想从最高到最低排序，请使用此查询

```
Cursor cur = query ("Gamestable", null, null, null, null, null, SCORE_VALUE + "DESC", null);

if(cur != null)
    cur.moveToFirst(); 
```

其中 SCORE_VALUE 是存储分数的列的名称。

这是可能的最简单查询，最好在第二个字段中使用`null`选择，而不是仅选择要返回的列。

# python - Python中的命令行输入

> ID：16179875
> 
> 赞同：35
> 
> 时间：2013-04-23T21:56:40.227
> 
> 标签：python, command-line, input, python-2.7, user-input

是否可以先运行程序然后等待用户在命令行中输入。例如

```
Run...

Process...

Input from the user(in command line form)...

Process... 
```

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2013-04-23T21:58:10.913

完全不清楚 OP 的含义（即使在评论中反复讨论之后），但这里有两个对问题可能解释的答案：

## 用于交互式用户输入（或管道命令或重定向输入）

`raw_input`在 Python 2.x 和Python 3 中使用`input`。（这些是内置的，因此您无需导入任何内容即可使用它们；您只需为您的 python 版本使用正确的。）

例如：

```
user_input = raw_input("Some input please: ") 
```

更多细节可以在[这里](http://docs.python.org/2/library/functions.html#raw_input)找到。

因此，例如，您可能有一个看起来像这样的脚本

```
# First, do some work, to show -- as requested -- that
# the user input doesn't need to come first.
from __future__ import print_function
var1 = 'tok'
var2 = 'tik'+var1
print(var1, var2)

# Now ask for input
user_input = raw_input("Some input please: ") # or `input("Some...` in python 3

# Now do something with the above
print(user_input) 
```

如果你把它保存在 中`foo.py`，你可以从命令行调用脚本，它会打印出来`tok tiktok`，然后要求你输入。您可以输入`bar baz`（后跟回车键），它会打印`bar baz`. 这就是它的样子：

```
$ python foo.py
tok tiktok
Some input please: bar baz
bar baz 
```

在这里，`$`代表命令行提示符（所以你实际上并不输入），当它要求`Enter`输入时我在输入后点击。`bar baz`

## 对于命令行参数

假设您有一个名为的脚本`foo.py`，并希望使用参数`bar`和`baz`从命令行调用它，例如

```
$ foo.py bar baz 
```

（同样，`$`代表命令行提示符。）然后，您可以在脚本中使用以下内容：

```
import sys
arg1 = sys.argv[1]
arg2 = sys.argv[2] 
```

在这里，变量`arg1`将包含字符串`'bar'`，`arg2`并将包含`'baz'`. 该对象`sys.argv`只是一个包含命令行中所有内容的列表。请注意，这`sys.argv[0]`是脚本的名称。例如，如果您只想要一个包含所有参数的列表，您可以使用`sys.argv[1:]`.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-23T22:01:10.140

## 只接受输入

```
the_input = raw_input("Enter input: ") 
```

就是这样。

此外，如果您想制作一个输入列表，您可以执行以下操作：

```
a = []

for x in xrange(1,10):
    a.append(raw_input("Enter Data: ")) 
```

在这种情况下，您将被要求 10 次数据以将 9 个项目存储在列表中。

输出：

```
Enter data: 2
Enter data: 3
Enter data: 4
Enter data: 5
Enter data: 7
Enter data: 3
Enter data: 8
Enter data: 22
Enter data: 5
>>> a
['2', '3', '4', '5', '7', '3', '8', '22', '5'] 
```

您可以使用以下方式搜索该列表的基本方式（在制作该列表之后）：

```
if '2' in a:
    print "Found" 
```

否则：打印“未找到”。

您可以像这样用“raw_input()”替换“2”：

```
if raw_input("Search for: ") in a:
    print "Found"
else: 
    print "Not found" 
```

## 通过命令行界面从输入文件中获取原始数据

如果您想从通过命令行提供的文件中获取输入（这通常是您在为比赛做代码问题时需要的，例如 Google Code Jam 或 ACM/IBM ICPC）：

**例子.py**

```
while(True):
    line = raw_input()
    print "input data: %s" % line 
```

在命令行界面中：

```
example.py < input.txt 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-04-23T23:04:18.550

如果您使用的是 Python 3，`raw_input`则已更改为`input`

Python 3 示例：

```
line = input('Enter a sentence:') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-31T00:32:29.450

使用以下行开始您的脚本。该脚本将首先运行，然后您将获得 python 命令提示符。此时，所有变量和函数都可用于交互使用和调用。

#!/usr/bin/env python -i

# javascript - 为什么这个分组角度过滤器会导致摘要循环？

> ID：16179876
> 
> 赞同：2
> 
> 时间：2013-04-23T21:56:41.643
> 
> 标签：javascript, angularjs, angularjs-ng-repeat

我正在尝试一次显示 N 个项目中的一堆项目。我需要对项目进行分块，因为标记必须是表格/网格的（每组 N 个项目有一行，然后每个项目有一列）。这是一个简化的尝试：

```
app.filter('inGroupsOf', function () {
    return function (input, groupSize) {
        if (!input) {
            return [];
        }
        var result = [];
        for (var index = 0; index < input.length; index++) {
            var groupIndex = Math.floor(index / groupSize);
            if (!result[groupIndex]) {
                result[groupIndex] = [];
            }
            result[groupIndex].push(input[index]);
        }
        return result;
    };
});

<div ng-controller="Ctrl">
    <div ng-repeat="itemGroup in items | inGroupsOf:7">
        <span ng-repeat="item in itemGroup">{{item.name}}</span>
    </div>
</div> 
```

（完整版在这里：http: [//jsfiddle.net/bradleybuda/twhVj/3/](http://jsfiddle.net/bradleybuda/twhVj/3/)）

这会导致“达到 10 个 $digest() 迭代”错误。我已经查看了[这个问题](https://stackoverflow.com/questions/14462015/angular-grouping-filter)的公认答案，但那里的建议对我不起作用（除了核对过滤器并在控制器中执行所有操作）。有没有办法让这种 ng-repeat 与模板/过滤器一起工作？在控制器中执行此操作感觉很难看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T03:08:40.123

由于控制器中的第 12 行，正在发生无限循环：

```
result[groupIndex] = []; 
```

$digest 循环没有发生，因为您正在定义的循环中创建一个数组，而是因为您将这些新数组嵌套在您在第 8 行创建的数组中：

```
var result = []; 
```

即使您在 for 循环之外创建嵌套数组，也会发生相同的错误：

```
var result = [];
    result[0] = []; 
```

嵌套对象也会发生同样的事情。至于“为什么”会发生这种情况，我不太确定。我已经阅读了[文档](http://docs.angularjs.org/api/ng.%24rootScope.Scope#%24digest)，但仍然不明白为什么数组或对象的嵌套会导致 $digest 循环发生。用字符串或数字替换嵌套数组，你就很成功了。

我想在这种情况下，逻辑必须移回控制器，而不是被称为过滤器。

# data-binding - 我可以在淘汰数据绑定中调用 JS 脚本吗？

> ID：16179884
> 
> 赞同：0
> 
> 时间：2013-04-23T21:57:20.453
> 
> 标签：data-binding, knockout.js, knockout-2.0

我需要在淘汰数据绑定中的 foreach 循环内调用 JS 函数。

我需要做类似的事情：

```
<div data-bind="foreach:items()">
.....
<script>
  jQuery(function () { jQuery('#myid').rateit({ value:$data.value }); })
</script>
....
</div> 
```

显然它不起作用，我还没有找到在脚本标签内应用数据绑定的方法......有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T05:05:12.050

不，你不能。

如果您想为集合（或*任何*可观察的）中的每个项目执行某些操作，您可以使用[`computed observable`](http://knockoutjs.com/documentation/computedObservables.html).

这将适用于您的场景：

```
ko.computed(function () {
    var items = this.items();

    for (var i = 0; i < items.length; i++) {
        jQuery(function () { jQuery('#myid').rateit({ value: item[i].value }); })
    }
}, viewModel); 
```

# javascript - 画布元素，画圆调整大小

> ID：16179885
> 
> 赞同：1
> 
> 时间：2013-04-23T21:57:26.607
> 
> 标签：javascript, jquery, html, css

我正在慢慢尝试创建突破游戏以更熟悉 javascript。
我正在尝试根据窗口大小重新调整画布元素的大小，但请注意我正在根据画布的大小自动渲染重新调整大小的圆圈。我将如何独立于画布的大小渲染圆圈的大小？

```
//resize canvas
$(function(){
$("#canvas").width($(window).width());
});

//get a reference to the canvas
var ctx = $('#canvas')[0].getContext("2d");

//draw a circle
ctx.beginPath();
ctx.arc(75, 75, 10, 0, Math.PI*2, true); 
ctx.closePath();
ctx.fill(); 
```

这是我的小提琴：http: [//jsfiddle.net/z25q7/3/](http://jsfiddle.net/z25q7/3/)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:03:18.507

直接更改画布的`width`属性，而不是其 CSS `style.width`（这是 jQuery 所做的）：

```
$("#canvas")[0].width = $(window).width(); 
```

更多信息：[通过 CSS 与元素属性的 HTML5 Canvas 大小](https://stackoverflow.com/questions/5034529/size-of-html5-canvas-via-css-versus-element-attributes)

# java - Android：当您的应用在后台运行时，在通知上使用 AUTO-CANCEL

> ID：16179899
> 
> 赞同：20
> 
> 时间：2013-04-23T21:58:12.197
> 
> 标签：java, android, notifications

我在这里查看了所有其他 AUTO-CANCEL-not-working 问题，它们似乎都涉及我没有犯的错误。我都试过了

```
builder.setAutoCancel(true); 
```

和

```
Notification notif = builder.build();
notif.flags |= Notification.FLAG_AUTO_CANCEL; 
```

两者都不起作用。

我正在使用 NotificationCompat，因为我的最低 API 是 8。这是我的完整代码。在这个特定的通知中，我没有调用意图，因为我不需要用户做任何事情。

```
NotificationCompat.Builder builder = new NotificationCompat.Builder(this);
builder.setContentTitle(getString(R.string.app_name) + ": my title");
builder.setContentText(message);
builder.setSmallIcon(R.drawable.notification_icon);

Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.prog_icon);
builder.setLargeIcon(bitmap);

builder.setAutoCancel(true); // dismiss notification on user click

NotificationManager notiManager = (NotificationManager)getSystemService(NOTIFICATION_SERVICE);
notiManager.notify(MY_NOTI_MANAGER_ID, builder.build()); 
```

通知显示得恰到好处。您可以滑动以清除它。但只需点击它并不会关闭通知。它只是点亮并停留在那里。

我的代码与此处发布的其他代码之间可能存在一些差异：1）我正在使用 NotificationCompat（这应该不会产生影响，但我们之前已经听说过）。2）由于我的通知很简单，我没有附加意图。

如果您有任何见解，请告诉我。

编辑：我的目的是在不使我的后台应用程序前景化的情况下关闭通知。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-24T16:06:56.937

所以显然你*确实*需要一个未决的意图。

在[Android - 通知管理器，有一个没有意图的通知](https://stackoverflow.com/questions/7040742/android-notification-manager-having-a-notification-without-an-intent)，我找到了一个解决方案，它可以将当前活动的应用程序作为您的待处理意图（这样您就不必启动自己的活动来关闭通知）。

我刚刚添加了以下两行代码（在设置自动取消之后）：

```
PendingIntent notifyPIntent = 
    PendingIntent.getActivity(getApplicationContext(), 0, new Intent(), 0);     
builder.setContentIntent(notifyPIntent); 
```

效果很好。我想说，如果您不希望您的活动因用户单击您的通知而重新启动，那么这是您的最佳选择。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-23T22:09:27.483

您似乎错过了`PendingIntent`and`setContentIntent()`电话。我相信这是自动取消工作所必需的。

这是[此示例项目](https://github.com/commonsguy/cw-omnibus/tree/master/Notifications/DownloadNotify)`Notification`中的一些显示逻辑，该逻辑有效：

```
 private void raiseNotification(Intent inbound, File output, Exception e) {
    NotificationCompat.Builder b=new NotificationCompat.Builder(this);

    b.setAutoCancel(true).setDefaults(Notification.DEFAULT_ALL)
     .setWhen(System.currentTimeMillis());

    if (e == null) {
      b.setContentTitle(getString(R.string.download_complete))
       .setContentText(getString(R.string.fun))
       .setSmallIcon(android.R.drawable.stat_sys_download_done)
       .setTicker(getString(R.string.download_complete));

      Intent outbound=new Intent(Intent.ACTION_VIEW);

      outbound.setDataAndType(Uri.fromFile(output), inbound.getType());

      b.setContentIntent(PendingIntent.getActivity(this, 0, outbound, 0));
    }
    else {
      b.setContentTitle(getString(R.string.exception))
       .setContentText(e.getMessage())
       .setSmallIcon(android.R.drawable.stat_notify_error)
       .setTicker(getString(R.string.exception));
    }

    NotificationManager mgr=
        (NotificationManager)getSystemService(NOTIFICATION_SERVICE);

    mgr.notify(NOTIFY_ID, b.build());
  } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-03-21T11:00:29.687

海亲爱的朋友，如果您想在特定时间显示不可取消的通知（用户不可取消），然后您需要清除它（如音乐播放器），您可以使用它。

```
mNotificationBuilder .setSmallIcon(android.R.drawable.btn_plus);
mNotificationBuilder .setContentTitle("My notification");
mNotificationBuilder .setContentText("Notificattion From service");
mNotificationBuilder .setLights(0xFF0000FF, 500, 500);

Notification note = mNotificationBuilder.build();  
note.flags = Notification.FLAG_ONGOING_EVENT; // For Non cancellable notification
mNotificationManager.notify(NOTIFICATION_ID, note); 
```

# ruby - 如何使用 PayPal 登录以保存 user_id？

> ID：16179908
> 
> 赞同：0
> 
> 时间：2013-04-23T21:59:02.437
> 
> 标签：ruby, paypal

是否可以通过 PayPal API 使用“使用 PayPal 登录”按钮？我想将它用作 twitter 登录，将您的 paypal 帐户链接到该应用程序，然后让它存储一个`user_id`.

这可能吗？

* * *

我想要某种“**连接到贝宝**”的行为。想想一家商店，那里出售商品并获得支付给商店的贝宝账户。店主必须验证（连接）他的贝宝帐户，然后应用程序将知道所有付款必须去哪里。

也可以只询问店主的贝宝电子邮件帐户，但我认为这并不是很低的水平。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T22:07:20.963

如果这甚至是可能的，我不会做这样的事情来进行身份验证。

原因是，用户可以很容易地指定他必须通过此过程为每次登录付费。

# ruby-on-rails-3 - belongs_to 的反向关联 - has_one

> ID：16179909
> 
> 赞同：2
> 
> 时间：2013-04-23T21:59:06.330
> 
> 标签：ruby-on-rails-3, activerecord

关于活动记录的一件事让我感到困惑（我对 Rails 还是有点陌生​​）。我正在做这样的迁移：

```
def up
    change_table :slide do |t|
        t.references => :slideable, :polymorphic => true
  end
end 
```

然后我将修改我的模型：

```
class Slide < BaseModel
  ...
  belongs_to :slideable, :polymorphic=>true
end

class Painting < BaseModel
  ...
  has_one :slide, :as => :slideable
end

class Paper < BaseModel
  ...
  has_one :slide, :as => :slideable
end 
```

为了能够使用关联的双方，我是否还必须对绘画和纸张上的 has_one 关系进行迁移？

```
slide.painting.name
slide.paper.title
painting.slide.name
paper.slide.name 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T23:16:08.987

不，`has_one`不会影响您的数据库。`belongs_to`是什么将在您的表中实际创建一个外键字段，这就是您需要迁移的原因。

# php - PHP 中的 Amazon AWS putBucketLogging 参数

> ID：16179915
> 
> 赞同：0
> 
> 时间：2013-04-23T21:59:51.327
> 
> 标签：php, amazon-s3

我正在编写连接到亚马逊 S3 存储的脚本。该脚本应该创建 2 个存储桶：

1.  存储桶用于数据

2.  桶用于日志

我成功创建了两个存储桶，但无法设置日志记录。下面显示了我用于启用存储桶日志记录的代码

```
 $result = $client->putBucketLogging(array(
        'Bucket' => $bucket,
        'LoggingEnabled' => array(
            'TargetBucket' => $bucket . '-LOG',
            'TargetGrants'=>array(
              'Grantee'=>array(
                  'DisplayName'=>'user.name',
                  'Type'=>'CanonicalUser'
              ),  
            ),
             'TargetPrefix' => 'LOG-',
        ),
    )); 
```

在亚马逊 AWS API for PHP 版本 2 中，Bucket、LoggingEnabled 和 Type 是强制性的。但是文档没有说明如何准确地实现那里的参数。

你能帮我看看**putBucketLogging**方法的配置数组的结构吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T00:41:20.810

您还可以使用服务的 API 文档作为参考，其中有时包含有关如何专门为请求构建某些数据类型的更多详细信息。[PUT Bucket Logging](http://docs.aws.amazon.com/AmazonS3/latest/API/RESTBucketPUTlogging.html)的S3 API 文档有更多关于如何指定被授权者的详细信息。

此外，您不应在存储桶名称中使用大写字母（请参阅[存储桶命名规则](http://docs.aws.amazon.com/AmazonS3/latest/dev/BucketRestrictions.html#bucketnamingrules)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T22:59:27.783

在手册中搜索后，方法**putBucketLogging**的 php 数组是

```
 $result = $client->putBucketLogging(array(
        'Bucket' => $bucket,
        'LoggingEnabled' => array(
            'TargetBucket' => $bucket . '-log',
            'TargetGrants' => array(
                'Grant' => array(
                    'Grantee' => array(
                        'Type' => 'AmazonCustomerByEmail',
                        'EmailAddress' => 'email@email.com',
                    ),
                    'Permission' => 'FULL_CONTROL',
                ),
            ),
            'TargetPrefix' => 'log-',
        ),
    )); 
```

但是启用日志记录失败，异常告诉我必须在日志存储桶上设置权限......

# ios - 如何在 iO 上获取 Twitter 访问令牌和秘密？

> ID：16179916
> 
> 赞同：3
> 
> 时间：2013-04-23T21:59:55.060
> 
> 标签：ios, twitter, oauth, authorization, token

我所拥有的：1\. RoR 后端 2\. iOs 6 应用程序 3\. 后端使用的 Twitter ConsumerKey 和 ConsumerSecret

我想要什么：在我的 iOs 应用程序中添加一个 Twitter 登录按钮，这将允许我授权用户并让他的 AccessToken 和 AccessTokenSecret 在我的后端部分中使用。我已经在网上搜索了近一周的最新工作解决方案，但没有找到任何东西。

Facebook 花了将近 5 分钟的时间来创建一个 WebView 并将他们的 oAuth url 放在那里，在用户授权后将令牌直接放入地址栏中。为什么 Twitter 这么让人头疼？？

帮助！！><

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T22:09:56.760

您需要使用 Reverse Auth 来获取 oAuth 访问令牌和访问令牌机密，如本[教程](https://dev.twitter.com/docs/ios/using-reverse-auth)中所述。

[你可以在这里](https://github.com/seancook/TWReverseAuthExample)找到Twitter 工程师 Sean Cook的工作示例。

# android - 如何在 Android 上跨一系列设备可靠地捕获低分辨率视频？

> ID：16179919
> 
> 赞同：9
> 
> 时间：2013-04-23T22:00:08.733
> 
> 标签：android, video, ffmpeg, video-capture

你好 Android 视频专家 :)

我正在开发一个 Android 应用程序，它允许用户捕获视频并将其上传到远程服务器（它比这更复杂，但应用程序的其余部分并不重要）。由于上传要求，视频的大小必须合理，而不是超高分辨率。假设最大为 680x480 或 10Mb/分钟。这在 Apple 设备上没有问题。

我经历了一场只能被描述为一场彻头彻尾的噩梦，试图在一系列 Android 设备上以相当低的比特率可靠地捕获视频。

据我了解，有两种在 Android 上捕获视频的方法：

1) 使用媒体记录器/相机 API

2) 使用 Intent 打开摄像头视频捕获应用程序

选项 1) 提供了最大的灵活性，并允许我们轻松更改捕获分辨率。然而，Android Camera API 在一系列设备上并不可靠，而且我有非常好的信息（包括与谷歌在这个问题上联络的人），如果你使用这个 API 捕获视频，那么它会在 50% 的设备上崩溃那里的设备。Zoom Camera FX 使用 Intent 进行视频捕捉是有原因的。Zoom Camera（不同的应用程序）似乎使用媒体记录器，但有很多关于视频崩溃或无法正常工作的差评。

选项 2) 适用于各种设备，因为它使用设备上的内置应用程序。问题是您无法控制分辨率，Intent 上有质量提示，但相机应用程序通常会忽略这一点。我的三星 Galaxy S3 默认以大约 2Mb/s 的速度录制视频。这分辨率太高了。内置应用程序当然可以更改分辨率，但这依赖于用户的操作，难以控制。

我知道我可以使用 ffmpeg 之类的库在捕获后更改视频的分辨率。但是，这需要我为 Android 编译库，而且我被告知，为了在设备上合法使用解码/编码编解码器，您必须支付每份应用程序约 1 美元的许可费。由于此应用程序将免费使用，因此这不是一个选项。

这就是我所在的位置。我一直在寻找答案，但我不知道如何使用 Android 可靠地捕获低分辨率视频。

非常感谢任何帮助！

马修

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-10-26T09:40:57.773

`MediaRecorder`您可以通过设置 Frame size在类中准确定义`(width x height)`，使用方法 the `setVideoSize(int width, int height)`，帧大小越小视频越小，这适用于所有 Android 手机，您无需更改每个设备的帧大小，或者您可以编码比特率，它控制每一帧的压缩质量。使用方法`setVideoEncodingBitRate (int bitRate)`，较低的比特率会导致较高的压缩率，这反过来会导致较低的质量和较小的视频文件大小。好好看看`MediaRecorder`课堂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-19T18:01:08.873

如果您以 API 18 及更高版本为目标，则可以使用`Camera`和`MediaCodec`一起以任意大小和比特率进行录制。例如，请参阅[Grafika](https://github.com/google/grafika)中的“显示 + 捕获相机”活动。

您可以检查[平台版本仪表板](http://developer.android.com/about/dashboards/index.html)以估计给定 API 级别的目标市场规模。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T10:11:25.193

我认为您可以使用[getSupportedPictureSizes来获取每个移动相机中支持的最小尺寸，然后您可以在](http://developer.android.com/intl/es/reference/android/hardware/Camera.Parameters.html#getSupportedPictureSizes%28%29)[SetVideoSize(width, height)](http://developer.android.com/intl/es/reference/android/media/MediaRecorder.html#setVideoSize%28int,%20int%29)中使用 mediaRecorder 和这些参数

# java - 如何在java中捕获全局按键

> ID：16179923
> 
> 赞同：7
> 
> 时间：2013-04-23T22:00:31.573
> 
> 标签：java

我用 Java 制作了一个简单的媒体播放器，但我**想记录全局按键，如`Ctrl`+`P`**以暂停/恢复当前正在播放的音乐，**而 JFrame 没有焦点**，但由于 JVM 安全问题，这似乎是不可能的。

我遇到了[JNativeHook](http://code.google.com/p/jnativehook/)，但我只想为 Windows 实现我自己的方法。请建议如何做以及从哪里开始？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2017-05-18T16:40:52.403

试试**[JNativeHook](https://github.com/kwhat/jnativehook)**。这是一个示例，展示了如何使用它来捕获全局按键：

```
try
{
    GlobalScreen.registerNativeHook();
    GlobalScreen.addNativeKeyListener(new NativeKeyListener()
    {

        @Override
        public void nativeKeyTyped(NativeKeyEvent nativeEvent)
        {
        }

        @Override
        public void nativeKeyReleased(NativeKeyEvent nativeEvent)
        {
            String keyText=NativeKeyEvent.getKeyText(nativeEvent.getKeyCode());
            System.out.println("User typed: "+keyText);
        }

        @Override
        public void nativeKeyPressed(NativeKeyEvent nativeEvent)
        {   
        }
     });
}
catch (NativeHookException e)
{
    e.printStackTrace();
} 
```

如果您使用的是 Maven，请将其添加到您的`pom.xml`：

```
<dependency>
    <groupId>com.1stleg</groupId>
    <artifactId>jnativehook</artifactId>
    <version>2.1.0</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T22:44:30.510

Jintellitype 是一个比较简单的解决方案。

[https://code.google.com/p/jintellitype/](https://code.google.com/p/jintellitype/)

另一个简单的解决方案是使用带有 JNA 的 windows 挂钩：

[Windows 中的 JNA 键盘挂钩](https://stackoverflow.com/questions/3078646/jna-keyboard-hook-in-windows)

我对 JNA 有一些经验，并且非常喜欢这个 api。

第三种解决方案是使用 JNI 管理您自己的调用。

可移植性方面，据我所知，Windows dll 和 api 架构就响应用户输入而言，已保存在不同的操作系统版本中。如果没记错的话，用户输入的钩子在 user32 dll 中。也许您必须为 x64 位版本跳过一些障碍，但我怀疑这会很难。

# c# - ContentPlaceHolder 到 HtmlString

> ID：16179927
> 
> 赞同：1
> 
> 时间：2013-04-23T22:01:07.077
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-3, razor

我正在将我的 .Master 代码移动到部分视图，因为我们在项目中包含了剃刀视图。我们使用局部视图来维护 .Master 和 _Layout 而无需重复代码。

_Layout 看起来像这样

```
<html>
<head>
   <title>@RenderSection("Title", required: false)</title>
   @RenderSection("Head", required: false)
   @{ Html.RenderPartial("~/Views/Shared/Partials/head.Master.cshtml"); }
   @RenderSection("HeadBottom", required: false)
</head>
<body @bodyClass id="@ViewData["bodyId"]">
   @{
      ViewData["renderBody"]         = RenderBody();
      ViewData["belowHeader"]        = RenderSection("BelowHeader", required: false);
      ViewData["bootomFixedContent"] = RenderSection("BootomFixedContent", required: false);
      ViewData["insideFooter"]       = RenderSection("InsideFooter", required: false);

      Html.RenderPartial("~/Views/Shared/Partials/body.Master.cshtml");
   }
   @RenderSection("Scripts", required: false)
   @{ Html.RenderPartial("~/Views/Shared/Partials/scripts.Master.cshtml"); }
</body>
</html> 
```

我有一个问题。使用 razon 我可以这样做：

```
ViewData["belowHeader"] = RenderSection("BelowHeader", required: false); //Razor _Layout 
```

然后在 RenderSection 应该在的部分内绘制 HtmlString。

```
var belowHeader = ViewData["belowHeader"] as HelperResult; //HelperResult contains the html string
@belowHeader //Inside the partial 
```

但我不知道如何在 .Master 中做同样的事情

```
var belowHeader = FindControl("BelowHeader").ToString(); //.Master (This doesn't work) 
```

关于如何解决这个问题或解决问题的其他方法的任何想法。

提前致谢。

# mysql - MySQL小复杂查询

> ID：16179931
> 
> 赞同：0
> 
> 时间：2013-04-23T22:01:32.640
> 
> 标签：mysql, cakephp, sorting

我正在处理一个 mysql 查询，其中我需要结果集中的上一个和下一个 id。我能够在没有搜索查询的情况下得到它。但是，当进行搜索时，ID 显然无济于事......这将是基于参数的其他字段。

所以，我正在运行两个不同的查询，一个针对当前用户标识，即 123..，另一个针对上一个用户标识和下一个用户标识。

查询是这样的...... `select fields from users where (( id = IFNULL((select min(id) from users where id > 123),0) or id = IFNULL((select max(id) from users where id < 123),0) ) AND (username like "%john%"))`

有了上面的内容，我得到了用户的上一个和下一个 id...但是当我在示例 'john' 上进行搜索时，我无法从搜索结果中获取下一个 id 和上一个 id？我也有AZ和ZA的字母排序。所以我必须按名称排序，按名称排序，升序，降序。

在会话中存储搜索结果 ID 是一个好主意，包括分页 ID？

有哪些选择可以实现这一目标？请分享你的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T22:05:53.420

为了获得您正在排序的其他字段的下一个/上一个，您需要在一个联合中完成两个单独的查询。

```
SELECT ...
FROM users
WHERE whatever=whatever
ORDER BY sortfield DESC limit 1,1

UNION ALL

SELECT ..
FROM users
WHERE whatever=whatever
ORDER BY sortfield ASC LIMIT 1,1 
```

第一个查询获取“前一个”记录，前一个由您实际排序的任何内容定义。另一个查询颠倒了意义，因此您使用相同的顺序获得“下一个”记录，顺序颠倒（DESC -> ASC）。

您可以在其中一个查询上使用 LIMIT 0,1 ，这将允许实际的“当前”记录也包含在结果集中。但不要在两者上都这样做，否则联合会导致重复的“当前”。

# c# - 使用 linq 对复杂字典求和

> ID：16179937
> 
> 赞同：1
> 
> 时间：2013-04-23T22:02:09.007
> 
> 标签：c#, linq, dictionary

我有这个结构

```
 class DailyData
    {
        public double A=0.0;
        public double B=0.0;
        public double C=0.0;

    }

SortedDictionary<DateTime,DailyData[]> Data = new SortedDictionary<DateTime,DailyData[]>();
var LongData = Data.Skip(Math.Max(0, Data.Count() - 90)).Take(90); 
```

如何在我的字典的一部分中对特定值求和（或其他操作）？

即我想总结 LongData 中的所有“A”？

编辑

实际上，我不想要所有的“A”。我只想对我的 DailyData 数组的元素（索引） N 的所有“A”求和。我应该早点说对不起

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-23T22:14:06.133

从类型中解决。我们有什么？`longData`是类型`IEnumerable<KeyValuePair<DateTime, DailyData[]>`。我们需要什么？ `IEnumerable<double>`，我们可以总结。我们将如何到达那里？

首先是得到一个序列`DailyData[]`：

```
IEnumerable<DailyData[]> q1 = from pair in longData 
                              select pair.Value; 
```

好的，现在我们有了，让我们制作一个序列`DailyData`：

```
IEnumerable<DailyData> q2 = from array in q1 
                            from element in array
                            select element; 
```

现在我们可以获得所需的双打序列：

```
IEnumerable<double> q3 = from data in q2
                         select data.A; 
```

现在我们有一些可以总结的东西：

```
double sum = q3.Sum(); 
```

现在我们已经把它分解成一系列小步骤，我们可以看看如何把它组合成更简洁的东西：

```
var query = from pair in longData 
            from element in pair.Value
            select element.A;
double sum = query.Sum(); 
```

有道理？使用 LINQ 时，需要记住以下几点：

*   使用类型系统来指导您。类型系统表示数据的“形状”，因此请遵循它。
*   将查询分解为许多子查询，每个子查询执行一个简单的步骤。然后，如果您愿意，您可以在以后弄清楚如何将其写成简洁的东西。
*   永远记住，查询理解表达式的值是*查询*而不是*结果*。q1, q2, q3 和 query 除了分配*query*之外没有任何作用。在调用 Sum 之前，实际上不会执行任何查询。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T22:03:55.647

有几个选项。您可以使用这样的[`Sum`](http://msdn.microsoft.com/en-us/library/bb549046.aspx)方法：

```
var sum = LongData.SelectMany(x => x.Value).Sum(x => x.A); 
```

或这个：

```
var sum = LongData.Sum(x => x.Value.Sum(y => y.A)); 
```

或这个：

```
var sum =
    (from x in LongData
     from y in x.Value
     select y.A).Sum(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-23T22:07:08.617

您可以使用 LINQ 的内置 sum 运算符，您只需选择所有值：

```
var sum = Data.Sum(x => x.Value.Sum(y => y.A)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-23T22:05:52.627

> 我想总结 LongData 中的所有“A”

```
LongData.SelectMany( x=>x.Value ).Sum( x=>x.A ); 
```

# c++ - C++11 memory_order_acquire 和 memory_order_release 语义？

> ID：16179938
> 
> 赞同：32
> 
> 时间：2013-04-23T22:02:09.103
> 
> 标签：c++, mutex, atomic, memory-model, stdatomic

[http://en.cppreference.com/w/cpp/atomic/memory_order](http://en.cppreference.com/w/cpp/atomic/memory_order)和其他 C++11 在线参考资料，将 memory_order_acquire 和 memory_order_release 定义为：

*   获取操作：当前线程中的任何**读取**都不能在此加载之前重新排序。
*   释放操作：当前线程中的任何**写入**都不能在此存储之后重新排序。

这似乎允许在获取操作**之前**执行获取后写入，这对我来说似乎很奇怪（通常的获取/释放操作语义限制了**所有**内存操作的移动）。

相同的在线资源（[http://en.cppreference.com/w/cpp/atomic/atomic_flag](http://en.cppreference.com/w/cpp/atomic/atomic_flag)）建议可以使用 C++ 原子和上述宽松的内存排序规则构建自旋锁互斥锁：

```
lock mutex: while (lock.test_and_set(std::memory_order_acquire))

unlock mutex: lock.clear(std::memory_order_release); 
```

有了这个锁定/解锁的定义，如果 memory_order_acquire/release 确实以这种方式定义（即，不禁止重新排序后获取写入），下面的简单代码不会被破坏：

```
Thread1:
  (0) lock
    (1) x = 1;
    (2) if (x != 1) PANIC
  (3) unlock

Thread2:
  (4) lock
    (5) x = 0;
  (6) unlock 
```

是否可以执行以下操作：(0) lock, (1) x = 1, (5) x = 0, (2) PANIC ？我错过了什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-24T01:00:02.797

自旋锁互斥锁实现对我来说看起来不错。我认为他们对*获取*和*释放*的定义完全错误。

这是我所知道的获取/发布一致性模型的最清晰的解释：[Gharachorloo；列诺斯基；劳登；长臂猿；古普塔；Hennessy：可扩展共享内存多处理器中的内存一致性和事件排序，*Int'l Symp Comp Arch*，ISCA(17):15-26, 1990，doi 10.1145/325096.325102](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.17.8112)。（doi 在 ACM 付费墙后面。实际链接是指向*不在*付费墙后面的副本。）

查看第 3.3 节中的条件 3.1 和随附的图 3：

*   在允许对任何其他处理器执行普通加载或存储访问之前，必须执行所有先前的获取访问，并且
*   在允许对任何其他处理器执行释放访问之前，必须执行所有以前的普通加载和存储访问，并且
*   特殊访问 [sequentially] 彼此一致。

要点是：获取和释放是顺序一致的¹（所有线程全局都同意获取和释放发生的顺序。）所有线程全局都同意在特定线程上的获取和释放之间发生的事情发生在获取和释放。但是允许将发布*后*的正常加载和存储（通过硬件或编译器）移动到发布之上，并且允许将获取*之前*的正常加载和存储（通过硬件或编译器）移动到获取之后.

（脚注 1：这对于*大多数*实现来说都是正确的，但是对于 ISO C++ 来说一般来说夸大了。读者线程可以不同意其他 2 个线程完成的 2 个存储的顺序。请参阅[Acquire/release semantics with 4 threads](https://stackoverflow.com/questions/48383867/acquire-release-semantics-with-4-threads)和[这个答案](https://stackoverflow.com/questions/27807118/will-two-atomic-writes-to-different-locations-in-different-threads-always-be-see/50679223#50679223)有关如何为 POWER CPU 编译 C++ 的详细信息，展示了在实践中与发布和获取的差异，但不是 seq_cst。但大多数 CPU 仅通过一致的缓存在内核之间获取数据，这意味着确实存在全局顺序。）

* * *

在[C++ 标准](http://isocpp.org/std/the-standard)中（我使用了 2012 年 1 月草案的链接），相关部分是 1.10（第 11 页到第 14 页）。

*“ happens-before* ”的定义意在仿照[Lamport；分布式系统中的时间、时钟和事件顺序，*CACM*，21(7):558-565，1978 年 7 月](http://research.microsoft.com/en-us/um/people/lamport/pubs/time-clocks.pdf)。C++*获取*对应于 Lamport 的*接收*，C++*发布*对应于 Lamport 的*发送*。Lamport 对单个线程内的事件序列进行了总排序，其中 C++ 必须允许部分排序（参见第 1.9 节，第 13-15 段，第 10 页，了解 C++ 对*sequenced-before*的定义。）不过，*sequenced-前*订购几乎是您所期望的。语句按照它们在程序中给出的顺序排列。第 1.9 节，第 14 段：“与完整表达式相关的每个值计算和副作用都在与要评估的下一个完整表达式相关的每个值计算和副作用之前排序。”

1.10 节的重点是说，一个*无数据竞争的*程序产生相同的定义良好的值，就好像该程序在具有顺序一致内存且没有编译器重新排序的机器上运行一样。如果存在数据竞争，则程序根本没有定义的语义。如果没有数据竞争，则允许编译器（或机器）重新排序不会导致顺序一致性错觉的操作。

第 1.10 节，第 21 段（第 14 页）说：如果有一对从不同线程对对象 X 的访问 A 和 B，则程序不是无*数据竞争的*，至少其中一个访问有副作用，并且两者都没有A 发生在 B 之前，B 也不发生在 A 之前。否则程序是无数据竞争的。

第 6 至 20 段对happens-before 关系给出了非常仔细的定义。关键定义是第 12 段：

“如果满足以下条件，则评估*A 发生在*评估 B 之前：

*   A 在 B 之前排序，或
*   线程间发生在 B 之前。”

因此，如果获取在几乎任何其他语句*之前*（在同一个线程中）排序，那么获取必须出现在该语句之前。（包括该语句是否执行写入。）

同样：如果几乎任何语句都在发布*之前*（在同一个线程中）排序，那么该语句必须出现在发布之前。（包括该语句是否只进行值计算（读取）。）

允许编译器*将*其他计算从发布之后移动到发布之前（或从获取之前到获取之后）的原因是因为这些操作在关系之前*没有*线程间发生（因为它们在临界区之外）。如果他们竞争语义是未定义的，并且如果他们不竞争（因为它们不是共享的），那么你就无法准确判断它们何时发生在同步方面。

这是一个很长的说法：cppreference.com 对获取和释放的定义是完全错误的。您的示例程序没有数据竞争条件，并且不会发生 PANIC。

# java - 声明具有两个接口的泛型类型参数时如何避免不必要的强制转换

> ID：16179940
> 
> 赞同：2
> 
> 时间：2013-04-23T22:02:18.813
> 
> 标签：java, generics, type-safety

为什么我必须在以下代码中将命令显式转换为 C？Commands 实现了 Runnable 和 Describable。

```
@Test
public <C extends Runnable & Describable> void testMapOfCommands() throws Exception
{
    Map<String, C> commands = Maps.newHashMap();
    for(Commands command : Commands.values())
    {
        commands.put(command.name(), (C) command);
    }
    //Use commands here (not relevant to my question):
    //CommandLineParser.withCommands(commands).parse("commit");
}

private enum Commands implements Runnable, Describable
{
    commit
    {
        @Override
        public void run()
        {
            System.out.println("COMMIT");
        }

        @Override
        public String description()
        {
            return "Commits something";
        }
    };
} 
```

我想到的一种解决方法是引入扩展 Runnable 和 Describable 的 ICommand：

```
public interface ICommand extends Runnable, Describable{} 
```

但是当已经有两种类型可用并且我已经有一个稍微复杂一点的 Command 类时，我试图避免引入一种新类型。我在这里抓稻草吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T22:11:33.053

你所拥有的是一个`command`类型为 的对象`Commands`。但是由于您的泛型类型声明`<C extends Runnable & Describable>`，Java 期望`C`同时是`Describable`and `Runnable`，但`C`不一定是 a `Commands`。

这种特殊的测试方法并不适用于除 之外的任何东西`Commands`，因此它不应该是通用的。这应该有效：

```
public void testMapOfCommands() throws Exception
{
    Map<String, Commands> commands = new HashMap<String, Commands>();
    for(Commands command : Commands.values())
    {
        commands.put(command.name(), command);
    }
} 
```

# sql - SQL Server 更新触发器不起作用

> ID：16179941
> 
> 赞同：1
> 
> 时间：2013-04-23T22:02:40.737
> 
> 标签：sql, sql-server, database, triggers, sql-update

有一个具有更新触发器的数据库表。每当更新一列时，都会自动计算其中一列。

我已经调整了触发器，我想再次在所有行上运行它。在 SQL Server Management Studio 中，如果我在表上选择“编辑前 200 行”并编辑其中一行，则更新触发器将起作用。但是当我编写如下查询时：

```
UPDATE MyTable
SET SomeIrrelevantColumn = 0 
```

触发器不起作用，应该由触发器计算的列保持不变。

如何在所有行上手动运行触发器？

**编辑：**这是触发器：

```
USE [MY_DATABASE]
GO
/****** Object:  Trigger [dbo].[MY_TABLE_AUER]    Script Date: 04/24/2013 00:05:23 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER TRIGGER [dbo].[MY_TABLE_AUER] 
   ON  [dbo].[MY_TABLE] 
   AFTER UPDATE
AS 
DECLARE @UPD_COLUMN_A int,
        @INS_COLUMN_A int,
        @UPD_COLUMN_B int,
        @UPD_COLUMN_C varchar(255),
        @UPD_COLUMN_D varchar(255),
        @UPD_COLUMN_E int,
        @UPD_COLUMN_F datetime
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;
    SELECT @UPD_COLUMN_A = _Column_A,
           @UPD_COLUMN_B =_Column_B,
           @UPD_COLUMN_C = COLUMN_C,
           @UPD_COLUMN_D = [Column_D]
      FROM DELETED;
    IF @UPD_COLUMN_D not like '%SomeString%'
    BEGIN
      SELECT @INS_COLUMN_A = _Column_A
        FROM INSERTED;
      IF @UPD_COLUMN_A != @INS_COLUMN_A
      BEGIN
        SELECT @UPD_COLUMN_E = MAX([_Column_B]),
               @UPD_COLUMN_F = MAX([_Column_G])
          FROM MY_TABLE
         WHERE COLUMN_C = @UPD_COLUMN_C
           AND [Column_D] LIKE '%SomeString%';
        UPDATE MY_TABLE 
           SET COLUMN_E = @UPD_COLUMN_E,
               COLUMN_F = @UPD_COLUMN_F
         WHERE [_Column_B] = @UPD_COLUMN_B;
        UPDATE MY_TABLE 
           SET COLUMN_H = @UPD_COLUMN_B
         WHERE [_Column_B] = @UPD_COLUMN_E; 
      END
    END
END 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-23T22:57:40.040

您的触发器做了一个非常常见但错误的假设，即它将每行执行一次。它没有，它每个动作执行一次——所以当你更新整个表时，我敢打赌，如果你仔细观察，你会发现有一行被更新了。^(* 感谢 Aaron Bertrand 对此介绍段落的评论。)

您需要研究如何基于 JOIN（使用`inserted`or`deleted`元表）执行更新。例如：

```
CREATE TRIGGER TR_Sample_U ON dbo.Sample FOR UPDATE -- AFTER is default so not needed
AS
IF EXISTS ( --check for disallowed modifications
   SELECT *
   FROM
      Inserted I
      INNER JOIN Deleted D
         ON I.SampleID = D.SampleID
   WHERE
      I.Something <> D.Something
      AND I.UpdateDate = D.UpdateDate
)
ROLLBACK TRAN; 
```

这些资源也可以帮助您：

*   [使用连接的 SQL 更新查询](https://stackoverflow.com/questions/982919/sql-update-query-using-joins)
*   [处理多行插入的触发器](https://stackoverflow.com/questions/2178889/sql-server-a-trigger-to-work-on-multiple-row-inserts)
*   [多行处理触发器的示例](https://stackoverflow.com/questions/14967384/computed-column-expression/14970664#14970664)
*   [另一个多行处理触发器示例](https://stackoverflow.com/questions/15905286/sql-server-inserted-table/15908326#15908326)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:35:18.117

我发现一种方法如下：

```
UPDATE A
SET A.SOME_COLUMN = D.ANOTHER_COLUMN
FROM MY_TABLE AS A
JOIN inserted AS B ON A.ID = B.ID -- Point 1.
JOIN deleted AS C ON A.ID = C.ID
JOIN (SELECT MAX(ID) AS OTHER_ID, GROUP_ID AS OTHER_GROUP_ID -- Point 2.
      FROM MY_TABLE AS E
      WHERE E.SOME_STRING_COLUMN LIKE '%SomeString%'
      GROUP BY E.GROUP_ID) AS D ON A.GROUP_ID = D.OTHER_GROUP_ID
WHERE C.SOME_BOOL_COLUMN != B.SOME_BOOL_COLUMN -- Point 3.
      AND C.SOME_STRING_COLUMN NOT LIKE '%SomeString%' 
```

1.  在基本`UPDATE`语句之后，我继续将表加入“插入”和“删除”特殊表（有关这些表的更多信息，[请访问 http://www.mssqltips.com/sqlservertip/2342/understanding-sql-server-inserted- and-deleted-tables-for-dml-triggers/](http://www.mssqltips.com/sqlservertip/2342/understanding-sql-server-inserted-and-deleted-tables-for-dml-triggers/)）。这样，我只会遍历已更新的行，而不会与其他行混淆。您只能加入其中之一，但我需要查看更新操作前后值之间的一列差异。所以这就是我同时使用它们的原因。'deleted' 具有更新操作之前状态的行，'inserted' 具有更新操作之后状态的行。
2.  之后，我需要在整个表中找到由当前正在更新的行中的值计算的行。就我而言，当前行有一个父级，我想找到该行。这两行共享相同`GROUP_ID`，我进行了字符串测试以确保我得到的新行符合父级条件，您可以在那里定义任何类型的过滤器。基本上，您编写另一个查询以根据更新的行查找该行，然后`JOIN`对该返回的表进行另一个查询。
3.  最后，我使用了一个`WHERE`子句来确保仅通过查看列来更新已更改状态的`SOME_BOOL_COLUMN`行。您可以在此处放置任何类型的标准。如您所见，我检查了更新前后列状态之间的差异。

不过，这里写的任何东西都持保留态度，因为它来自几乎没有 SQL 经验的人。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2017-10-05T12:54:42.413

请尝试使用下面的代码..in 触发器..！

```
//Check if the column is getting updated

if (Update(column1) or Update(Column2)...etc)

Begin

  Write the entire logic inside this loop..!

End 
```

希望这有效..!!!

# macos - Unix 查找文件名中的空格

> ID：16179945
> 
> 赞同：0
> 
> 时间：2013-04-23T22:03:10.787
> 
> 标签：macos, shell, find

我正在使用以下 shell 脚本循环遍历文本文件，然后删除与该文件名匹配的任何内容。

但是，如果文件名中包含空格，则它不起作用。如何纠正？理想情况下，我的脚本将查找并删除带有和不带空格的文件名......

对此最受赞赏的任何其他改进。

这是在 OSX

提前感谢您的想法和建议，

担

```
$ cat delete-files.sh
#!/bin/sh

PATH=/bin:/usr/bin:/usr/sbin
export PATH

for i in `cat /opt/scripts/files-to-delete.dat` ;

do find /Volumes/folder/subfolder -iname $i -print -delete ;

done 
```

和文本文件：

```
$ cat files-to-delete.dat
LloydsTSB_Customer_Identification.html
Santander_Update_Process.html
asdasdasd asdasdasd.txt 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T22:36:40.920

假设空白是字段分隔符，正在读取输入文件。将其更改为换行符，如下所示：

```
#!/bin/sh

PATH=/bin:/usr/bin:/usr/sbin
export PATH

IFS=$'\n'

for i in `cat /opt/scripts/files-to-delete.dat` ;

do find /Volumes/folder/subfolder -iname $i -print -delete ;

done 
```

注意添加的 IFS=$'\n' 行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T22:14:23.420

`for i in $(cat filenames)`正是由于您遇到的原因，这是一个坏主意。可以在[此处](http://mywiki.wooledge.org/DontReadLinesWithFor)和[此处](http://mywiki.wooledge.org/BashFAQ/001)找到更多信息，但简而言之：

```
while IFS= read -r line; do stuff_with "$line"; done < "$file" 
```

始终**是**正确的解决方案。（注意：如果您的任何文件名包含换行符，这*仍然会失败*；在这种情况下，您自己删除它们可能更容易。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T17:51:39.397

感谢 Lauri Ranta 指出最优雅的解决方案：

```
#!/bin/sh

PATH=/bin:/usr/bin:/usr/sbin
export PATH

while IFS= read -r line

do find /Volumes/folder/subfolder -iname "$line" -print -delete

done < "/tmp/files-to-delete.dat" 
```

# linq - 给定一个日期列，使用 LINQ 获取前一个星期日以进行分组

> ID：16179946
> 
> 赞同：1
> 
> 时间：2013-04-23T22:03:12.623
> 
> 标签：linq

给定这样的表：

```
UserID,DateOfEntry,TimeWorked,Status
user1,2013-04-23,5,Submitted
user1,2013-04-22,7,Submitted
user1,2013-04-29,11,Submitted
user1,2013-04-24,3,Approved
user2,2013-04-22,9,Submitted 
```

我将如何获得这个结果集：

```
UserID,WeekStart,SumTimeWorked
user1, 2013-04-21, 12
user1, 2013-04-28, 11
user2, 2013-04-21, 9 
```

分组基于用户 ID 和“DateOfEntry”中日期之前的星期日？

如果可能的话，我更喜欢 Lambda 语法。

**编辑** 这是基于托马斯回答的工作查询。这是我正在查询的实际表的实际查询，因此它可能与上面的示例不完全匹配。

```
var entries = _db.TimeEntries.GroupBy(g => new {
weekstart = g.DateOfEntry.AddDays(-(int)g.DateOfEntry.DayOfWeek),
userID = g.UserID
})
.OrderBy(c => c.Key.userID)
.Select(c => new {
userID = c.Key.userID,
weekStart = c.Key.weekstart,
Duration = c.Sum(sub => sub.Duration)
}); 
```

**编辑 2** 上面的查询在 LINQPad 中工作，它使用的实际代码直到今天才准备好进行测试 - 不幸的是，在 LINQPad 中我使用的是 LINQ to SQL，而在代码中我们使用的是 LINQ to Entities。我现在收到此错误，如果有人有任何想法...

```
LINQ to Entities does not recognize the method 'System.DateTime AddDays(Double)'
method, and this method cannot be translated into a store expression. 
```

**编辑 3** 好的，我想我已经弄清楚了。我不得不添加两个 Using 语句：

```
using System.Data.Objects;
using System.Data.Objects.SqlClient; 
```

然后将查询更改为：

```
var entries = _db.TimeEntries.GroupBy(g => new {
weekstart = EntityFunctions.AddDays(g.DateOfEntry, -SqlFunctions.DatePart("weekday", g.DateOfEntry)),
userID = g.UserID
})
.OrderBy(c => c.Key.userID)
.Select(c => new {
userID = c.Key.userID,
weekStart = c.Key.weekstart,
Duration = c.Sum(sub => sub.Duration)
}); 
```

资料来源：[Linq to EntityFramework DateTime](https://stackoverflow.com/questions/4146300/linq-to-entityframework-datetime)和[LINQ to Entities Join on DateTime.DayOfWeek](https://stackoverflow.com/questions/3517516/linq-to-entities-join-on-datetime-dayofweek)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:40:10.743

linq 查询实际上非常简单：

```
var q = from s in submissions
        group s by GetKey(s) into g
        select new
        {
            UserId = g.Key.Key,
            WeekStart = g.Key.Value,
            SumTimeWorked = g.Sum(sub => sub.TimeWorked)
        }; 
```

诀窍是定义适当的分组方法。这个使用[KeyValuePairs](http://msdn.microsoft.com/en-us/library/5tbh8a42.aspx)只是因为我不想在这个答案中加入类定义：

```
private KeyValuePair<string, DateTime> GetKey(Submission s)
{
    return new KeyValuePair<string, DateTime>
            (s.UserID, s.DateOfEntry.AddDays(-(int)s.DateOfEntry.DayOfWeek));
} 
```

顺便说一句，运行它后，我注意到您的其中一行在**SumTimeWorked**列中有错误的值。它应该是：

```
user1, 2013-04-21, 15 
```

# java - Android AdMob 现在显示在我的手机上

> ID：16179948
> 
> 赞同：1
> 
> 时间：2013-04-23T22:03:17.330
> 
> 标签：java, android, xml

我正在尝试将 AdMob 添加到我的手机中，我在 admob 网站上注册，并且我的状态为“活动”，但当我在手机上运行应用程序时，无处可见添加。我用谷歌搜索了很多，但我尝试的一切都没有得到任何结果。

这是我在主布局 xml 文件中放入的内容：

```
 <com.google.ads.AdView
    xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
    android:id="@+id/adView"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/button1"
    android:layout_alignParentBottom="true"
    app:adSize="SMART_BANNER"
    app:adUnitId="a15176e8a6c0467"
    ads:loadAdOnCreate="true" >
</com.google.ads.AdView> 
```

我的清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="hr.sv.mate.crypt"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <uses-permission android:name="android.permission.RECEIVE_SMS" >
    </uses-permission>
      <uses-permission android:name="android.permission.INTERNET"/>
  <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <receiver android:name="hr.sv.mate.crypt.MySmsRecivier" >
            <intent-filter>
                <action android:name="android.provider.Telephony.SMS_RECEIVED" >
                </action>
            </intent-filter>
        </receiver>

        <activity
            android:name="hr.sv.mate.crypt.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity android:name="com.google.ads.AdActivity"
          android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"/>

    </application>

</manifest> 
```

这就是我从主要活动中调用 add 的方式：

```
 adRequest = new AdRequest();
    adView = new AdView(this, AdSize.BANNER, "a15176e8a6c0467");
    mainLayout = (RelativeLayout)findViewById(R.id.layout);
    mainLayout.addView(adView);
    adView.loadAd(adRequest); 
```

但仍然没有显示，我尝试在几个不同的版本中更改上面的代码，认为“也许我调用添加错误”但没有任何帮助。任何人都可以在这里找到我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T22:52:25.640

尝试添加`request.addTestDevice(AdRequest.TEST_EMULATOR)`并查看是否出现横幅：如果出现则没有问题，只需在发布前删除该行，一切都会好起来的；如果不是 AdMob 服务器的问题，请等待 Google 工程师解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T22:52:27.993

尝试通过 AdMOB 网站将广告设置为自动刷新。

# sql-server - 将 SQL Server 2012 从 Cal Licensing 切换到 Core Licensing

> ID：16179953
> 
> 赞同：1
> 
> 时间：2013-04-23T22:03:22.230
> 
> 标签：sql-server, installation, sql-server-2012

有没有办法将 SQL Server 2012 安装从 CAL 许可切换到 Core 许可，而无需完全重新安装？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T22:09:27.743

是的，从核心许可媒体运行安装程序，然后选择版本升级。它将很快升级到核心许可（基本上是注册表更改，而不是完全重新安装）

# ruby-on-rails - 删除 Rails 表和迁移

> ID：16179956
> 
> 赞同：2
> 
> 时间：2013-04-23T22:03:34.750
> 
> 标签：ruby-on-rails, ruby, sqlite

如果已经讨论过这个问题的答案，请指出正确的方向。我已经搜索过这个问题，但在我的情况下我没有找到任何东西。

我创建了要删除的表。我已经删除了模型和迁移，但是当我尝试重新创建它们然后迁移时，我得到以下信息：

```
SQLite3::SQLException: table already exists, etc.... 
```

我尝试使用`SQLite`管理器手动删除它们，但我不确定数据库文件的位置（其他帖子在这里也没有帮助我）。顺便说一句，我在`Win 7`。

我想知道这样做的正确方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T08:53:25.757

这是再次创建表和迁移的另一种最简单的方法。如果您使用的是 rails 3\. 运行此命令以删除数据库并再次创建它。

rake db:drop # 删除数据库

rake db:create # 创建相同的数据库

rake db:migrate # 迁移数据。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T22:12:18.443

您可以生成迁移

```
 rails generate migration DropProducts 
```

并用它来放下桌子

```
class DropProducts < ActiveRecord::Migration
  def up
    drop_table :products    
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T06:38:25.437

我写了一篇关于处理这种情况的博客文章，它可能会有所帮助......

[http://www.fmhcc.com.au/ruby/database-migrations-in-rails-and-when-to-start-from-scratch/](http://www.fmhcc.com.au/ruby/database-migrations-in-rails-and-when-to-start-from-scratch/)

# c# - 从模型创建 Html.DropDownList？

> ID：16179959
> 
> 赞同：1
> 
> 时间：2013-04-23T22:03:49.257
> 
> 标签：c#, asp.net-mvc, razor, asp.net-mvc-4, html-select

我需要在我的 mvc 应用程序中创建发票功能。我有这个模型类：

```
public class Product
{
    public int ProductId { get; set; }
    public int SupplierId { get; set; }
    public int CategoryId { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public decimal Price { get; set; }
    public double costPrice { get; set; }
    public string ProductPicUrl { get; set; }
    public ProductCategory Category { get; set; }
    public Supplier Supplier { get; set; }
} 
```

1.我需要在不使用 ViewData 的情况下让我的视图显示所有产品（特别是所有产品名称）的下拉列表 2.我需要能够单击转到我的 AddToInvoice 控制器方法的按钮。我只是不确定如何让它将 productid 从下拉列表中拉出并将其发送到该方法。

有人可以帮忙吗？即使只是解释如何制作下拉列表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T22:41:06.343

我通常会创建一个视图模型，其中包含我要创建或更新的模型以及为特定字段获取数据所需的项目列表。在这种情况下，我将创建一个名为的视图模型`SelectProductModel`，其中包含一个`ProductId`属性和一个`Products`属性。

```
public class SelectProductModel
{

  public Int32 ProductId { get; set; }
  public IEnumerable<Product> Products { get; set; }

} 
```

在`Invoice`控制器中，我只需加载产品列表并将其存储在模型中：

```
public ActionResult SelectProduct()
{
  SelectProductModel model = new SelectProductModel();
  model.ProductId = -1;
  model.Products = productRepository.GetList();
  return View();
}

public ActionResult AddToInvoice(Int32? id)
{
  //id is the ProductId sent
} 
```

该`SelectProduct`视图将是基于此模型的类型化视图：

```
@model SelectProductModel
...
@using(Html.BeginForm(actionName="AddToInvoice", controllerName="Invoice", method=FormMethod.Post))
{

  @Html.DropDownListFor(m => m.ProductId, new SelectList(model.Products, "ProductId", "Name"))
} 
```

# unity3d - 使用机器模拟驾驶视频游戏

> ID：16179962
> 
> 赞同：-8
> 
> 时间：2013-04-23T22:03:59.940
> 
> 标签：unity3d, game-engine, video-game-consoles

我要做一个视频游戏，需要帮助来了解如何开始。我需要什么工具来制作带有驾驶汽车模拟器的汽车游戏，比如我们用硬币玩的游戏？这款汽车模拟器机器的名称是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:06:12.987

如果你想走这条路，最好学习电子学。

没有“汽车驾驶模拟器”套件。它需要从头开始构建。

简而言之，你需要先学会爬行，然后才能走路。

在走这条路之前，请先研究游戏开发和电子产品。

# c - 声明未知数量的用户输入变量？

> ID：16179963
> 
> 赞同：0
> 
> 时间：2013-04-23T22:04:00.423
> 
> 标签：c

我是一名新程序员，希望了解循环并与用户交互。

我正在尝试用 C 编写一些程序，这些程序涉及用户输入一系列数字，然后扫描这些变量并用它们做一些事情。但是，我知道您应该在程序开始时声明变量。问题是，如果没有明确声明可能包含的最大变量数，我不知道如何在程序开始时声明未知数量的变量。有人对如何为未知数量的变量循环 scanf() 有任何建议吗？

包括下面是有限版本的代码，所以每个人都知道我在做什么。

```
 #include <stdio.h>

    int main() {
double Num;
double a,b,c;
double max,min;
int i=0;

    printf("How many numbers? > ");
    scanf("%lf", &Num);

    printf("OK, now please enter ");
    printf("%lf", Num);
    printf(" floating point numbers > ");

    while(i<=Num) {
    scanf("%lf", &a);
    scanf("%lf", &b);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T22:07:50.027

您可能希望使用指向双精度数组的指针来保存您的数字并在运行时为其分配内存......

```
 #include <stdio.h>

    int main() 
    {
        double Num;
        double *a,*b,*c;
        double max,min;
        int i=0;

        printf("How many numbers? > ");
        scanf("%lf", &Num);

        a = malloc( sizeof( double ) * Num );
        b = malloc( sizeof( double ) * Num );
        c = malloc( sizeof( double ) * Num );

        if( !a || !b || !c )
        {
            printf( "Out of memory\n" );
            exit( -1 );
        }

        printf("OK, now please enter %lf floating point numbers > ", Num);

        while(i<=Num) 
        {
            scanf("%lf", &a[i]);
            scanf("%lf", &b[i]);
        }

        // do stuff with c

        free( a );
        free( b );
        free( c );

        exit( 0 );
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T22:09:28.363

您真的需要同时在内存中使用所有变量吗？

例如，如果您计划计算未指定数量的用户输入数字的最大值，则只需要两个变量，而不是未指定数量的变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T22:09:36.750

建议（改动很小）：

```
 #include <stdio.h>

   int main() {
     int Num;
     double a,b,c;
     double max,min;
     int i=0;

     printf("How many numbers? > ");
     scanf("%d", &Num);

     printf("OK, now please enter %d floating point numbers >", Num);
     for (i=0; i < Num; i++) {
       scanf("%lf %lf %lf", &a, &b, &c);
       printf ("you entered: a=%lf, b=%lf, c=%lf\n", a, b, c);

     }

     return 0;
    } 
```

注意：此代码假定您只需要当前的 a、b 和 c（例如，将它们与当前的最小值和最大值进行比较）。如果要保留输入的*所有*a、b 和 c 值 ...l，则需要将它们存储在数组或列表中。

C++ 有一个定制的“vector<>”类。但是，如果您使用 C“数组”，则通常需要在分配数组*之前*预先知道最大 #/elements 。您可以通过使用“malloc()”在一定程度上缓解这种情况 - realloc() 允许您在运行时更改数组大小。

# python - (另一种) mod_wsgi 下 Flask 的 ImportError

> ID：16179967
> 
> 赞同：2
> 
> 时间：2013-04-23T22:04:27.777
> 
> 标签：python, apache2, flask, virtualenv, mod-wsgi

抱歉，如果这似乎是之前几个问题的重复，但到目前为止这些问题都没有帮助我：-/

我编写了一个 Flask 应用程序，我试图在 mod_wsgi 和 apache2 下部署它。

我得到以下信息`ImportError`：

```
[Tue Apr 23 23:46:56 2013] [info] Server built: Dec  9 2012 18:57:18
[Tue Apr 23 23:46:56 2013] [info] mod_wsgi (pid=7445): Initializing Python.
[Tue Apr 23 23:46:56 2013] [info] mod_wsgi (pid=7445): Attach interpreter ''.
[Tue Apr 23 23:47:10 2013] [info] [client 127.0.0.1] mod_wsgi (pid=7443, process='foo.com', application=''): Loading WSGI script '/Users/admin/Sites/p4p/p4p_jsapp/pfp/pfp.wsgi'.
[Tue Apr 23 23:47:10 2013] [error] [client 127.0.0.1] mod_wsgi (pid=7443): Target WSGI script '/Users/admin/Sites/p4p/p4p_jsapp/pfp/pfp.wsgi' cannot be loaded as Python module.
[Tue Apr 23 23:47:10 2013] [error] [client 127.0.0.1] mod_wsgi (pid=7443): Exception occurred processing WSGI script '/Users/admin/Sites/p4p/p4p_jsapp/pfp/pfp.wsgi'.
[Tue Apr 23 23:47:10 2013] [error] [client 127.0.0.1] Traceback (most recent call last):
[Tue Apr 23 23:47:10 2013] [error] [client 127.0.0.1]   File "/Users/admin/Sites/p4p/p4p_jsapp/pfp/pfp.wsgi", line 7, in <module>
[Tue Apr 23 23:47:10 2013] [error] [client 127.0.0.1]     from PfpServer import app as application
[Tue Apr 23 23:47:10 2013] [error] [client 127.0.0.1]   File "/Users/admin/Sites/p4p/p4p_jsapp/pfp/PfpServer.py", line 4, in <module>
[Tue Apr 23 23:47:10 2013] [error] [client 127.0.0.1]     import pandas as pd
[Tue Apr 23 23:47:10 2013] [error] [client 127.0.0.1] ImportError: No module named pandas 
```

阿帕奇配置：

```
<VirtualHost *:80>

    ServerName  www.foo.com
    ServerAlias foo.com

    DocumentRoot /Users/admin/Sites/p4p/p4p_jsapp/www

    <Directory /Users/admin/Sites/p4p/p4p_jsapp/www>
    Order allow,deny
    Allow from all
    </Directory>

    WSGIDaemonProcess foo.com user=admin processes=2 threads=15 display-name=%{GROUP}
    WSGIProcessGroup foo.com

    WSGIScriptAlias / /Users/admin/Sites/p4p/p4p_jsapp/pfp/pfp.wsgi

    <Directory /Users/admin/Sites/p4p/p4p_jsapp/pfp>
    WSGIProcessGroup foo.com
    WSGIApplicationGroup %{GLOBAL}
    Order allow,deny
    Allow from all
    </Directory>

</VirtualHost> 
```

pfp.wsgi：

```
import sys

activate_this = '/Users/admin/Sites/p4p/p4p_jsapp/foo/bin/activate_this.py'
execfile(activate_this, dict(__file__=activate_this))

sys.path.append('/Users/admin/Sites/p4p/p4p_jsapp/pfp')
from PfpServer import app as application 
```

PfPServer.py：

```
import numpy as np
import pandas as pd
import ujson
from flask import Flask, Response, request, render_template
import traceback

app = Flask(__name__)

# ... 
```

我曾尝试使用和不使用 virtualenv 来查看是否有帮助，但无论如何我都会遇到同样的错误。这里有什么问题？

编辑：为了完全清楚，我安装了 pandas 并且应用程序在调试器中本地运行良好

edit2：好的，解决方案在 sys.path 中 - 我已经安装了最新的 pandas RC，它位于非标准路径上，这就是为什么当我单独添加 std 站点包路径时它不起作用的原因：

```
sys.path.append('/Users/admin/dev/pandas/pandas-0.11.0rc1')
sys.path.append('/Library/Frameworks/EPD64.framework/Versions/7.3/lib/python2.7/site-packages') 
```

...工作 - 谢谢大家！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-23T23:13:54.527

我的*猜测*是 apache 运行的 Python 与您用于测试应用程序的 Python 不同。

# mysql - MySql 文本本地化

> ID：16179968
> 
> 赞同：1
> 
> 时间：2013-04-23T22:04:30.483
> 
> 标签：mysql, sql

我需要本地化我的查询结果。为此，我有：

*   表格`Show`，`id`以及其他一些信息；
*   `ShowName`带有`idShow`,`name`的表格`lang`（对于每个节目有多个`showName`s 其中`Show.id`= `ShowName.idShow`）

我的查询现在可以正常工作：

```
select Show.*,
(SELECT name FROM ShowName 
    WHERE Show.id=ShowName.idShow 
    ORDER BY FIELD(lang,'$userPreferredLanguage','en','it','es','fr','de','pt','da','he','pl','nl','hu','no','sl', 'fi','sv','tr','cs','hr', 'el','ru','zh','ja','ko') 
    LIMIT 0,1) as name,
from Show 
```

现在，问题是：有没有办法稍微加快速度？查询原样大约需要 3 秒，其中 2 秒用于计算内部`SELECT`. 我试过了`INNER JOIN`，但我不知道如何省略第二个选择。PS：注意`ShowName`可能没有所有的本地化，所以我需要使用`FIELD`函数而不是简单的`WHERE lang = '$userPreferredLanguage'`.

提前谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T01:07:00.290

你有索引`ShowName(idShow)`吗？

那会有所帮助。更好的索引是： `ShowName(IdShow, name, lang)`，因为子查询中的所有列引用都可以通过索引来满足。

一旦有了索引，执行显式连接也可能会更快：

```
select Show.*,
       (SELECT name
        FROM ShowName join
             (select 'en' as lang, 1 as priority union all
              select 'it', 2 union all
              . . .
             ) lp
             on showname.lang = lp.lang
        WHERE Show.id=ShowName.idShow 
        ORDER BY lp.priority 
        LIMIT 0, 1
       ) as name
from Show 
```

# google-app-engine - GCMIntentService 导入错误

> ID：16179969
> 
> 赞同：0
> 
> 时间：2013-04-23T22:04:31.457
> 
> 标签：google-app-engine

请帮我。我正在关注创建 App Engine 连接的 Android 项目教程。我马上就在 GCMIntentService 类中遇到了导入错误。

```
import com.cloudnotes.deviceinfoendpoint.Deviceinfoendpoint;
import com.cloudnotes.deviceinfoendpoint.Deviceinfoendpoint.Builder;
import com.cloudnotes.deviceinfoendpoint.model.DeviceInfo; 
```

我不知道该怎么办。我正在使用 Eclipse Juno、GAE Java SDK 1.7.7.1、Google 插件 4.2、Android API 17

我对此很陌生，所以欢迎任何建议

先感谢您。史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T23:45:49.623

您必须实际添加 Google Cloud Messaging 库：在您的 Android SDK 中查找该`gcm.jar`文件（应该在您的 Android SDK 文件夹中的 extras\google\gcm\samples\gcm-demo-client\libs 文件夹中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T20:54:49.517

已发布 Eclipse GAE 插件的新更新并修复了该问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-08T07:52:25.147

您必须删除此行：

```
import com.cloudnotes.deviceinfoendpoint.Deviceinfoendpoint;
import com.cloudnotes.deviceinfoendpoint.Deviceinfoendpoint.Builder;
import com.cloudnotes.deviceinfoendpoint.model.DeviceInfo; 
```

并再次导入。它对我有用。

# java - 使用 RedirectAttributes.addFlashAttribute 时刷新后将对象保留在视图中

> ID：16179973
> 
> 赞同：2
> 
> 时间：2013-04-23T22:04:49.957
> 
> 标签：java, spring, jakarta-ee, spring-mvc

感谢 Spring 3.1，我可以使用 RedirectAttributes.addFlashAttribute 进行 Post/Redirect/Get，但似乎有小问题

这是持久化表单对象的方法，然后重定向到视图以显示该表单对象：

```
@RequestMapping(value = "/{formType}/onTheEarch", method = RequestMethod.POST)
public String submitAndRedirect(SomeWebForm someWebForm,
        @PathVariable("formType") String formType,
        final RedirectAttributes redirectAttributes) {

            // do something according to formType
            // .......

            redirectAttributes.addFlashAttribute("webObject", webObject);
            String view = "redirect:/formType/toTheMoon";
    } 
```

这是将用户引导到显示表单对象的视图的方法

```
@RequestMapping(value = "/{formType}/toTheMoon", method = RequestMethod.GET)
public String submitAndRedirect(@PathVariable("formType") String formType) {
            // do something according to formType
            // .......
            String view = "toTheMoon";
    } 
```

到目前为止一切顺利，但有一个不足之处。当我刷新视图`toTheMoon`时，一切都消失了。所以这里的问题是

```
(1)How does `RedirectAttributes.addFlashAttribute` works? 
(2)How can I keep the object from "FlashAttribute" even after refreshing the page? 
```

我知道对于第二个问题，我们可以避免`RedirectAttributes.addFlashAttribute`并且只传递 URL 中的任何参数来实现`RGP pattern`. 那么该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T22:37:08.233

如[弹簧文档第 17.6 章所述](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-flash-attributes)

> Flash 属性在重定向之前（通常在会话中）临时保存，以便在重定向之后对请求可用并立即删除。

如果您希望结果持续几个请求，您可以将它们存储在带有某个标识符的会话中，并仅将标识符作为请求参数传递给结果页面

我通常做的其他方法是检查结果页面上是否存在结果模型，如果不只是重定向到错误页面（即：用户不打算直接按刷新/访问结果页面，如果他们确实出现错误）。然后使用 javascript 进行客户端刷新预防

# mips - 如何在 QT Spim 中增加字节计数器

> ID：16179978
> 
> 赞同：0
> 
> 时间：2013-04-23T22:05:21.763
> 
> 标签：mips, spim

例如，我有一个带有这个字符串的程序：

```
str: .asciiz "abcdefghijklmnopqrstuvwxyz" 
```

然后我在字符串的末尾加上另一个字母：

```
la $t0, str
sb $t1, 26($t0) # the letter a  is stored into $t1 
```

这使得编辑后的 ​​str 为：

```
str: .asciiz "abcdefghijklmnopqrstuvwxyza" 
```

我的问题是如何将数字 26 增加到 27，因为我有一个循环不断接受用户输入的字符并将其添加到字符串的末尾，但我一直用新字母替换字符串的最后一个字母。我想在每次循环一次时将 26 递增 1，以便字符串不断延长，而不是被其他字母替换。我唯一能想到的是

```
sb $t1, $t2($t0)
add $t2, $t2, 1 
```

这是行不通的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T09:20:14.780

> 这使得编辑后的 ​​str 为：

```
str: .asciiz "abcdefghijklmnopqrstuvwxyza" 
```

这并不完全正确（请参阅[我对您之前问题的回答](https://stackoverflow.com/a/16186730/1524450)）。`.asciiz`暗示一个以 NULL 结尾的字符串，但您只是用`'a'`.

* * *

```
add $t2, $t2, 1 
```

> 这是行不通的。

该`add`指令将寄存器相加。如果要向寄存器添加立即数，请使用`addi`or 。`addiu`例如：

```
addiu $t2,$t2,1  # add 1 to $t2, ignoring potential overflows 
```

# chef-infra - 流浪者的厨师食谱不尊重长时间运行的w-get下载的rest_timeout或超时选项

> ID：16179979
> 
> 赞同：1
> 
> 时间：2013-04-23T22:05:23.073
> 
> 标签：chef-infra, vagrant, chef-recipe, chef-solo

我正在尝试获取一个要在厨师食谱中使用的大文件——它是一个大约 350mb 的数据库备份。我正在使用 wget 来获取文件，这是我的食谱：

```
include_recipe "apt"

include_recipe "sudo"

execute "sudo mkdir -p ~/dev/dbbackup"

execute "download most recent db backup" do
  command "sudo wget --user=theusername --password=thepassword -P ~/dev/dbbackup/ https://ourdbbackup.com/latest.psql.gz"
  timeout 86400
 end 
```

无论我尝试了什么，我都会得到以下信息：

```
[2013-04-23T21:50:32+00:00] INFO: Processing execute[download most recent database backup] action run (company_dev::default line 25)
bash: line 2:  1184 Killed                  chef-solo -c /tmp/vagrant-chef-1/solo.rb -j /tmp/vagrant-chef-1/dna.json
Chef never successfully completed! Any errors should be visible in the output above. Please fix your recipes so that they properly complete. 
```

我什至尝试给 Vagrant 打猴子补丁，这样我就可以添加 rest_timeout 选项：

```
Vagrant::Config.run do |config|
  config.vm.box = "precise32"
   config.vm.provision :chef_solo do |chef|
     chef.cookbooks_path = "cookbooks"
     chef.add_recipe "company_dev"
     chef.log_level = :debug
     chef.rest_timeout = 86400
  end 
end 
```

这会产生一个 /tmp/vagrant-chef-1/solo.rb 确实有一个 rest_timeout 选项：

```
rest_timeout 86400 
```

但是我仍然遇到 Chef 无法完成的相同错误。关于在没有厨师超时或其他问题停止食谱的情况下让这个大型下载工作的任何建议？当我设置机器然后从内部运行 wget 时它工作正常。非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-22T07:26:38.857

增加VM的内存，添加以下内容`Vagrantfile`：

```
config.vm.provider :virtualbox do |vb|
   vb.customize ["modifyvm", :id, "--memory", "2048"]
end 
```

然后重新创建虚拟机：

```
vagrant destroy --force && vagrant up 
```

PS：你为什么不使用[`remote_file`](http://docs.opscode.com/resource_remote_file.html)而不是做`wget`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T18:50:46.967

似乎在下载文件时生成 wget 的动态控制台输出中的问题。这会导致内存不足错误。我已经通过使用“curl -O 文件名 download_url”解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-04T18:16:16.983

使用 wget 从外部源下载大文件也存在同样的问题。更改了要使用的命令，`curl -O #{URL}`并且 chef-client 运行不再因错误 runKilled 错误而失败。在 rackspace 云上使用 chef 11.4

# actionscript-3 - 在 ActionScript 3 中，如何动态更改文本框的行为

> ID：16179988
> 
> 赞同：0
> 
> 时间：2013-04-23T22:05:59.520
> 
> 标签：actionscript-3, textbox

我正在尝试根据用户输入将输入文本行为从“单行”更改为“密码”并返回，这样当用户输入不正确的密码时，文本字段将变成带有文本“密码不正确”的单行文本框”。然后，一旦他们再次开始输入，文本框将再次充当密码类型文本框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T00:08:23.757

这是您想要的东西，它会显示`Incorrect Password`在`TextField`输入正确的密码之前。

```
package 
{
    public class Main extends Sprite 
    {
        private var tf:TextField = new TextField();

        public function Main():void 
        {
            if (stage) init();
            else addEventListener(Event.ADDED_TO_STAGE, init);
        }

        private function init(e:Event = null):void 
        {
            removeEventListener(Event.ADDED_TO_STAGE, init);

            tf.border = true;
            tf.displayAsPassword = true;
            tf.multiline = false;
            tf.height = 20;
            tf.type = TextFieldType.INPUT;
            tf.addEventListener(KeyboardEvent.KEY_DOWN, onKeyDown);
            tf.addEventListener(FocusEvent.FOCUS_IN, onFocusIn);

            addChild(tf);

        }

        private function onFocusIn(e:FocusEvent):void 
        {
            tf.text = "";
            tf.displayAsPassword = true;
        }

        private function onKeyDown(e:KeyboardEvent):void 
        {
            if (e.keyCode == Keyboard.ENTER)
            {
                if (tf.text == "pass")
                {
                    trace("logged in");
                }
                else
                {
                    tf.displayAsPassword = false;
                    tf.text = "Incorrect Password";
                    stage.focus = stage;
                }
            }
        }

    }

} 
```

# r - 使用 r 包 tm() 进行文本挖掘：“if (vectorized && (length <= 0)) 中的错误”

> ID：16179991
> 
> 赞同：0
> 
> 时间：2013-04-23T22:06:06.077
> 
> 标签：r, text-mining, tm

我正在尝试在带有文本的数据框中使用 tm()，但此错误不断出现：`"Error in if (vectorized && (length <= 0)) stop("vectorized sources must have positive length") : missing value where TRUE/FALSE needed"`

我有一个看起来像这样的数据框：

```
 person sex adult                                 state code
1         sam   m     0         Computer is fun. Not too fun.   K1
2        greg   m     0               No it's not, it's dumb.   K2
3     teacher   m     1                    What should we do?   K3
4         sam   m     0                  You liar, it stinks!   K4
5        greg   m     0               I am telling the truth!   K5
6       sally   f     0                How can we be certain?   K6
7        greg   m     0                      There is no way.   K7
8         sam   m     0                       I distrust you.   K8
9       sally   f     0           What are you talking about?   K9
10 researcher   f     1         Shall we move on?  Good then.  K10
11       greg   m     0 I'm hungry.  Let's eat.  You already?  K11 
```

我只使用这些代码：

```
library(tm)
texts <- as.data.frame(texts)
mycorpus<- Corpus(DataframeSource(texts)) 
```

有谁知道这里出了什么问题？提前谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-11T16:07:25.330

希望这是你要找的那个

```
xkcd.df <- read.csv(file.path(path, datafiles))
xkcd.corpus <- Corpus(DataframeSource(data.frame(xkcd.df[, 3]))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-12T04:49:51.583

听起来您需要为您的文本列创建一个语料库（并且它似乎与状态代码列合并，如果是这种情况，您需要将其分开）。假设状态代码是您要用于 tm 包的列，那么如果我没记错的话，您应该将该列（而不是整个数据框）拉入语料库。使用您提供的信息，如果您想这样做，您的代码应如下所示：

```
mycorpus<- Corpus(VectorSource(texts$state code)) 
```

如果您确实需要将文本与状态代码分开，则假设“文本”是您的新列：

```
mycorpus<- Corpus(VectorSource(texts$text)) 
```

# javascript - 广播点击事件

> ID：16179993
> 
> 赞同：0
> 
> 时间：2013-04-23T22:06:15.023
> 
> 标签：javascript, jquery

由于以下流程，我遇到了 pop 被阻止的问题。

```
click on link->function a->function b->popup 
```

我了解大多数浏览器都会阻止弹出窗口，除非它们是从用户事件启动的，例如单击按钮或链接。可能吗：

```
click on link->function a ->broadcast a click event -> function b ->popup 
```

仅供参考：弹出是`FB.login()`弹出

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T04:17:03.220

try

```
<a id='linkId' href='#' onClick='someFunction()'>link</a>

$('linkId').click(); 
```

# cocos2d-iphone - 通过Cocos2d中的迭代器从CCSprite子类中检索时CCSprite位置不稳定

> ID：16179994
> 
> 赞同：0
> 
> 时间：2013-04-23T22:06:18.953
> 
> 标签：cocos2d-iphone, iterator, kobold2d

我正在继承 CCSprite。（最初是子类 CCNode 但有同样的问题）

来自 EnemyShip.h：

```
@interface EnemyShip : CCSprite
- (id)initWithFile:(NSString *)file health:(int)health;

@property (nonatomic, assign) NSInteger health; 

@end

@interface easyShip : EnemyShip
- (id)init;
@end 
```

来自 EnemyShip.mm：

```
@implementation EnemyShip

@synthesize health;

- (id)initWithFile:(NSString *)file health:(int)h
{
    if ((self = [super initWithFile:file])) {
        self.health= h;
        self.position=[CCDirector sharedDirector].screenCenter;
}
return self;
}

@end

@implementation easyShip

- (id)init{
    if ((self = [super initWithFile:@"enemy_side_hole.png" health:100])){}
    return self;
}

@end 
```

都很基本。我通过以下方式添加这个敌人：

```
-(void) addEnemy:(CGPoint)p
{
    EnemyShip *enemyShip = [[easyShip alloc]init];
    [self addChild:enemyShip z:0]; 
} 
```

所以我在我的更新方法中进行碰撞检测。（再次——一旦这个工作，我将使用 sprite 属性等对 CCNode 进行子类化）

```
for(EnemyShip* theEnemies in [self children])
{
    NSLog(@"x,y: (%f,%f)",theEnemies.position.x,theEnemies.position.y);
} 
```

我理解上述内容可以访问我作为孩子添加的所有“EnemyShip”并记录它的位置。确实如此。除了位置到处都是 - 即使我可以看到精灵没有移动到任何地方，并且来自同一 .position.x/y 类的 NSLog 输出正确的坐标。

我的输出是：

```
2013-04-23 23:24:48.122 Radon[9209:907] x,y: (0.000000,0.000000)
2013-04-23 23:24:48.130 Radon[9209:907] x,y: (768.000000,512.000000)
2013-04-23 23:24:48.131 Radon[9209:907] x,y: (384.000000,512.000000)
2013-04-23 23:24:48.134 Radon[9209:907] x,y: (192.000000,512.000000)
2013-04-23 23:24:48.135 Radon[9209:907] x,y: (600.000000,30.000000)
2013-04-23 23:24:48.135 Radon[9209:907] x,y: (525.000000,30.000000)
2013-04-23 23:24:48.136 Radon[9209:907] x,y: (450.000000,30.000000)
2013-04-23 23:24:48.138 Radon[9209:907] x,y: (375.000000,30.000000)
2013-04-23 23:24:48.139 Radon[9209:907] x,y: (300.000000,30.000000)
2013-04-23 23:24:48.140 Radon[9209:907] x,y: (225.000000,30.000000)
2013-04-23 23:24:48.142 Radon[9209:907] x,y: (162.000000,512.000000) 
```

// - 编辑以反映一个错字和不正确的输出结果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T23:31:50.463

I've used an alternate approach, as I need this done quickly.

added

```
NSMutableArray enemies; 
```

create 'enemies':

```
EnemyShip *enemyShip = [[EnemyShip alloc]init];
[enemies addObject:enemyShip];
[self addChild:enemyShip z:0]; 
```

iterate through this specifically instead of grabbing the other way:

```
for(NSUInteger i=0;i<[enemies count];i++){
    EnemyShip* enemy = [enemies objectAtIndex:i];
    NSLog(@"x,y: (%f,%f)",enemy.sprite.position.x,enemy.sprite.position.y);
} 
```

Works fine.

Note: ^ using a CCNode subclass which contains a CCSprite instead of a CCSprite subclass, hence some names are different.

# ruby-on-rails - Heroku 上的 Rails 4 应用程序是 500ing，但日志中没有错误消息

> ID：16179995
> 
> 赞同：14
> 
> 时间：2013-04-23T22:06:25.323
> 
> 标签：ruby-on-rails, heroku, ruby-on-rails-4

我制作了一个新的 Rails 4 beta 应用程序并将其部署到 Heroku（使用 Ruby 2.0.0，并通过 Procfile 使用 Unicorn）。

它在本地运行良好`foreman start`，但是当我访问已部署应用程序的主页时，我只收到标准 Heroku 500 错误：

```
We're sorry, but something went wrong.
If you are the application owner check the logs for more information. 
```

但是，在日志中，**没有错误**。我不知道是什么导致了 500。

这是我上次的输出`git push heroku master`：

```
Counting objects: 6, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (4/4), done.
Writing objects: 100% (4/4), 656 bytes, done.
Total 4 (delta 2), reused 0 (delta 0)

-----> Ruby/Rails app detected
-----> Using Ruby version: ruby-2.0.0
-----> Installing dependencies using Bundler version 1.3.2
       Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin --deployment
       Using rake (10.0.4)
       Using i18n (0.6.4)
       Using minitest (4.7.3)
       Using multi_json (1.7.2)
       Using atomic (1.1.8)
       Using thread_safe (0.1.0)
       Using tzinfo (0.3.37)
       Using activesupport (4.0.0.beta1)
       Using builder (3.1.4)
       Using erubis (2.7.0)
       Using rack (1.5.2)
       Using rack-test (0.6.2)
       Using actionpack (4.0.0.beta1)
       Using mime-types (1.23)
       Using polyglot (0.3.3)
       Using treetop (1.4.12)
       Using mail (2.5.3)
       Using actionmailer (4.0.0.beta1)
       Using activemodel (4.0.0.beta1)
       Using activerecord-deprecated_finders (0.0.3)
       Using arel (4.0.0)
       Using activerecord (4.0.0.beta1)
       Using coffee-script-source (1.6.2)
       Using execjs (1.4.0)
       Using coffee-script (2.2.0)
       Using json (1.7.7)
       Using rdoc (3.12.2)
       Using thor (0.18.1)
       Using railties (4.0.0.beta1)
       Using coffee-rails (4.0.0)
       Using hike (1.2.2)
       Using jbuilder (1.0.2)
       Using jquery-rails (2.2.1)
       Using kgio (2.8.0)
       Using mysql2 (0.3.11)
       Using bundler (1.3.2)
       Using tilt (1.3.7)
       Using sprockets (2.9.3)
       Using sprockets-rails (2.0.0.rc4)
       Using rails (4.0.0.beta1)
       Using raindrops (0.11.0)
       Using sass (3.2.8)
       Using sass-rails (4.0.0.rc1)
       Using turbolinks (1.1.1)
       Using uglifier (2.0.1)
       Using unicorn (4.6.2)
       Your bundle is complete! It was installed into ./vendor/bundle
       Cleaning up the bundler cache.
-----> Preparing app for Rails asset pipeline
       Running: rake assets:precompile
       I, [2013-04-23T22:28:44.559735 #871]  INFO -- : Writing /tmp/build_33m76p0rij8a5/public/assets/rails-d8fb6a2617998f32edf5edb354fc5326.png
       I, [2013-04-23T22:28:49.911890 #871]  INFO -- : Writing /tmp/build_33m76p0rij8a5/public/assets/application-d4a508061cd56ce9e544945495285e0c.js
       I, [2013-04-23T22:28:50.120141 #871]  INFO -- : Writing /tmp/build_33m76p0rij8a5/public/assets/application-a3b89b66a8471f3e75abb239e3b35c7d.css
       Asset precompilation completed (8.30s)
-----> Rails plugin injection
-----> Discovering process types
       Procfile declares types      -> web
       Default types for Ruby/Rails -> console, rake, worker

-----> Compiled slug size: 35.0MB
-----> Launching... done, v21
       http://blofs.herokuapp.com deployed to Heroku

To git@heroku.com:blofs.git
   32e51a2..37d989c  master -> master 
```

以下是该推送的日志：

```
2013-04-23T22:28:06.650049+00:00 heroku[slugc]: Slug compilation started
2013-04-23T22:29:11.194613+00:00 heroku[api]: Release v21 created by callum.locke@gmail.com
2013-04-23T22:29:11.365908+00:00 heroku[api]: Deploy 37d989c by callum.locke@gmail.com
2013-04-23T22:29:11.441066+00:00 heroku[web.1]: State changed from up to starting
2013-04-23T22:29:11.932952+00:00 heroku[slugc]: Slug compilation finished
2013-04-23T22:29:12.858139+00:00 heroku[web.1]: Stopping all processes with SIGTERM
2013-04-23T22:29:13.194707+00:00 app[web.1]: I, [2013-04-23T22:29:13.194495 #2]  INFO -- : reaped #<Process::Status: pid 5 exit 0> worker=0
2013-04-23T22:29:13.194902+00:00 app[web.1]: I, [2013-04-23T22:29:13.194747 #2]  INFO -- : master complete
2013-04-23T22:29:14.312014+00:00 heroku[web.1]: Process exited with status 0
2013-04-23T22:29:14.338943+00:00 heroku[web.1]: Starting process with command `bundle exec unicorn -p 25281 -E $RACK_ENV`
2013-04-23T22:29:15.717687+00:00 app[web.1]: I, [2013-04-23T22:29:15.717387 #2]  INFO -- : listening on addr=0.0.0.0:25281 fd=7
2013-04-23T22:29:15.717916+00:00 app[web.1]: I, [2013-04-23T22:29:15.717861 #2]  INFO -- : worker=0 spawning...
2013-04-23T22:29:15.721526+00:00 app[web.1]: I, [2013-04-23T22:29:15.721385 #2]  INFO -- : master process ready
2013-04-23T22:29:15.723623+00:00 app[web.1]: I, [2013-04-23T22:29:15.723389 #5]  INFO -- : worker=0 spawned pid=5
2013-04-23T22:29:15.723805+00:00 app[web.1]: I, [2013-04-23T22:29:15.723750 #5]  INFO -- : Refreshing Gem list
2013-04-23T22:29:16.305653+00:00 heroku[web.1]: State changed from starting to up
2013-04-23T22:29:16.891063+00:00 app[web.1]: I, [2013-04-23T22:29:16.890882 #5]  INFO -- : worker=0 ready 
```

之后，我尝试在浏览器中加载主页，这些是日志中出现的仅有的两行：

```
2013-04-23T22:29:26.685651+00:00 heroku[router]: at=info method=GET path=/ host=blofs.herokuapp.com fwd="46.65.16.44" dyno=web.1 connect=2ms service=156ms status=500 bytes=706
2013-04-23T22:29:26.973073+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=blofs.herokuapp.com fwd="46.65.16.44" dyno=web.1 connect=1ms service=5ms status=200 bytes=0 
```

有谁知道问题可能是什么？

其他可能相关的事情：

*   我已经禁用了标准的 Heroku Postgres 插件，而改用 ClearDB MySQL 插件。
*   我尝试手动将`DATABASE_URL`环境变量从以前的值（即使我删除了 postgres 插件后仍然是 postgres URL）更改为与`CLEARDB_DATABASE_URL`var（mysql 的值）相同的值。这似乎没有任何区别。
*   我已添加`ruby '2.0.0'`到我的 Gemfile 中，并添加了`mysql2`和`unicorn`​​ gems。我已经使用了[https://devcenter.heroku.com/articles/rails-unicorn](https://devcenter.heroku.com/articles/rails-unicorn)`config/unicorn.rb`上的建议
*   我的 Procfile 仅包含：`web: bundle exec unicorn -p $PORT -E $RACK_ENV`
*   它在本地与`foreman start`.
*   除了上述修改之外，它基本上是一个使用`rails new`.

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-06-18T23:15:48.137

您需要添加`gem 'rails_12factor'`到您的 Gemfile。这是 Heroku 的一个~~临时~~修复，以使 Rails 4+ 与他们的服务一起工作。

请参阅[Heroku 上的 Rails 4.x](https://devcenter.heroku.com/articles/rails4-getting-started)入门或Heroku[上的 Rails 5.x 入门](https://devcenter.heroku.com/articles/getting-started-with-rails5)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-25T23:03:57.263

这些答案告诉您如何打开日志以便您可以查找错误，但并没有真正回答“*可能*出了什么问题？”这个问题。

除了@Lauren 对[这个问题](https://stackoverflow.com/questions/19410811/how-do-you-diagnose-a-500-error-on-heroku-when-there-is-no-error-message-in-the)的回答中的建议之外，还有另一种可能性 - 如果您尝试`ENV`在生产环境中访问常量并且没有通过 设置它`heroku config:set`，这也会导致非常无声的 500 错误。

# c# - 使用 linq 时如何最好地清理 SQLDataReader

> ID：16179996
> 
> 赞同：1
> 
> 时间：2013-04-23T22:06:25.067
> 
> 标签：c#, linq, sqldatareader

我有一个返回数据读取器的方法。通常我会在数据阅读器周围包裹一个 using ，以便在我遍历它之后很好地处理它。问题是我选择使用 Linq 使用数据读取器，这意味着延迟执行会导致读取器提前处理。是否有适当的模式来使用 Linq 使用和处理数据读取器，而无需构建其内容的完整集合？

```
using (System.Data.SqlClient.SqlDataReader reader = CallStoredProcedure())
{
    return reader.Cast<System.Data.Common.DbDataRecord>().Select(rec => new ObjectModel.CollectorSummaryItem()
    {
        CollectorID = (int)rec[0],
        Name = rec.IsDBNull(1) ? null : rec.GetString(1),
        Information = rec.IsDBNull(2) ? null : rec.GetString(2)
    });
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-23T22:11:33.567

您需要从 using 块内的阅读器中实际读取：

```
using (System.Data.SqlClient.SqlDataReader reader = CallStoredProcedure())
{
    while (reader.Read())
    {
        yield return new ObjectModel.CollectorSummaryItem()
        {
            CollectorID = (int)reader[0],
            Name = reader.IsDBNull(1) ? null : reader.GetString(1),
            Information = reader.IsDBNull(2) ? null : reader.GetString(2)
        };
    }
} 
```

*这将评估为具有与您之前所拥有的相同或一致的返回类型的代码，但在*您完成读取之前不会关闭阅读器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T03:30:23.917

在这里从臀部射击。这也应该有助于您解耦阅读器逻辑。

```
public IEnumerable<MyObject> ExecuteNonQuery(...)
{
  ...
  using(var reader = comm.ExecuteReader())
  {
    var results = new List<MyObject>();
    return reader
            .Cast<System.Data.Common.DbDataRecord>()
            .Select(rec => GetFromReader(rec))
            .ToList();
  }
}

public MyObject GetFromReader(IDataRecord rdr)
{
   return new MyObject { Prop1 = rdr["prop1"], Prop2 = rdr["prop2"] };
} 
```

# c# - 当我将文件从一个目录复制到另一个目录时，为什么我的文件名会中断？

> ID：16179998
> 
> 赞同：1
> 
> 时间：2013-04-23T22:06:34.063
> 
> 标签：c#, visual-studio-2010, file, copy, console-application

我有这行代码将文件从一个目录复制到另一个目录：

```
File.copy(Path.Combine(sourceDir, fileName), Path.Combine(destinationDir, fileName), true); 
```

当我单步执行代码时，所有变量都有正确的值和完整的文件名，但是当我查看目标目录 ( `destinationDir`) 中的文件时，文件就在那里，只有原始文件名的一部分......

原始文件名是`New Employee Orientation - Benefits`，当它被复制到新目标时`New Employee Orientation - Benefi`

我有另一个名称相似的文件，它以相同数量的字符（包括空格）截断。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T23:10:45.037

是`File.copy`您自己的功能还是错字？`File.Copy`如果使用 .NET 的 Copy 功能，应该是这样。如果它是您自己的，仍然需要查看并演练该代码。

否则，字符限制为 260 并且可能是罪魁祸首。移动`Path.Combine(string,string)`外部`File.copy`并检查值和长度。有关详细信息，请参阅[命名文件、路径和命名空间](http://msdn.microsoft.com/en-us/library/aa365247%28VS.85%29.aspx)。

# mysql - 您如何将这 3 个 mySQL 查询合并为一个？

> ID：16179999
> 
> 赞同：1
> 
> 时间：2013-04-23T22:06:36.033
> 
> 标签：mysql, sql

我正在尝试做的示意图代码：

```
INPUT VAR inputOne; (First input of the desired statement)
INPUT VAR inputTwo; (Second input of the desired statement)
INPUT VAR inputThree; (Third input of the desired statement)

-

VAR repResult = getResult("SELECT * FROM `representatives` WHERE `rID` = inputOne LIMIT 1;")
VAR evResult = getResult("SELECT `events`.`eID` FROM `events` WHERE `eventDateTime` = inputTwo LIMIT 1;")

if (repResult != null && evResult != null) {
    execureQuery("INSERT INTO `votes` (`representatives_rID`, `events_eID`, `voteResult`) VALUES(inputOne,evResult.eID,inputThree);");
} 
```

当我在单独的语句中执行它们时，它非常慢，特别是因为有 ~1.000.000 需要检查和插入。我想知道，是否有任何替代的单查询方式来执行此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T00:03:06.703

You can use INSERT-SELECT syntax to accomplish this:

```
INSERT INTO `votes` (`representatives_rID`, `events_eID`, `voteResult`) 
select inputOne, `events`.`eID`, inputThree FROM `events` WHERE `eventDateTime` = inputTwo LIMIT 1 
```

The above combines all three params into one INSERT-SELECT statement where the results of the select are sent to the insert.

See: [Insert into ... values ( SELECT ... FROM ... )](https://stackoverflow.com/questions/25969/sql-insert-into-values-select-from) for select-insert statement.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T23:56:33.700

是的，您可以将这些语句放入 1 个存储过程（返回 2 个结果集并执行 1 个插入），但是不，这可能无济于事。因为 3 条 SQL 语句的网络流量不是很大，而且 MySQL 中的存储过程很慢。

rID 是主键吗？第一个查询是否提取了您并不真正需要的大字段？

eventDateTime 上是否有唯一索引？如果表不是 InnoDB，则索引应显式包含 eID，因此它成为覆盖索引。

制作这些钥匙后，您可以放下`LIMIT 1`.

rID 和 eID 数据类型是否尽可能小？