# StackOverflow 问答 16068000-16068999

# visual-studio-2012 - VS2012中如何提高CodeContract重写器的性能？

> ID：16068000
> 
> 赞同：2
> 
> 时间：2013-04-17T19:00:18.357
> 
> 标签：visual-studio-2012, code-contracts

我们有一个包含 60 个项目的中型 VisualStudio 解决方案。每个项目都包含代码合约。由于我们使用`Contract.Requires<T>`我们的前置条件，我们需要在编译后重写我们的程序集。

组装模式是“标准合同要求”，运行时检查设置为“完整”，我们设置了“合同失败时断言”。合同参考程序集设置为“构建”。

从 VS2010 更改为 VS2012（安装前已卸载 VS2010）后，我们的解决方案将在**1m 30s**内构建。安装 CodeContracts 安装包后，构建时间增加到**5m 30s**（因为二进制重写器现在正在重写程序集）。

这比在 VS2010 中构建解决方案所需的时间要长得多，完全重建大约需要 3m。

有没有人经历过类似的放缓或知道如何改善这种情况？

我们已经尝试禁用合同参考程序集的构建，但这并没有改变任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-22T19:01:20.173

我注意到静态检查器的速度严重下降，但不确定这是否适用于此。我不是很肯定，但我认为他们最近改变了缓存的工作方式。我认为它默认使用基于文件的缓存，但不再具有该选项。在项目的 CC 设置中，有一个选项可以指定用于缓存的 SQL 实例。我花了一段时间才把它弄好，但我在我的机器上使用了 SQL Express 实例。我检查了“缓存结果”并将“SQL Server”设置为`.\SQLEXPRESS`. 当工具运行时，当它不工作时，您应该在输出窗口中看到有关缓存的消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-18T15:12:26.943

当我开始一个新的解决方案时，我要做的第一件事就是创建一个新的解决方案配置：

1.  调试
2.  调试 CC
3.  发布

然后我只在 Debug CC 上启用代码契约。这使我可以在调试模式下快速编译，并在我接近提交时切换到代码契约构建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:27:43.190

我们有一个解决方案，其中有 90 多个项目在大多数项目上运行重写器。在 HP z420 上，并行构建，我可以在大约 1 分 40 秒内构建解决方案。根据要重写的 dll 的大小，重写器确实会为每个项目增加 2-10 秒。这是最新的 1.5.60409.11 版本。

# c# - 如何模拟 WebOperationContext 进行单元测试？

> ID：16068001
> 
> 赞同：8
> 
> 时间：2013-04-17T19:00:19.460
> 
> 标签：c#, wcf, unit-testing, rest, weboperationcontext

我正在尝试为`GetAwesomeResultsAsXml()`以下 WCF Rest 服务编写单元测试（更多的集成测试）。
我如何处理`WebOperationContext`嘲笑方面？
最好的方法是什么？

```
public class AwesomeRestService : AwesomeRestServiceBase, IAwesomeRestService
    {
        public AwesomeSearchResults<AwesomeProductBase> GetAwesomeResultsAsXml()
        {
            return GetResults();
        }

        private static AwesomeSearchResults<AwesomeProductBase> GetResults()
        {
            var searchContext = AwesomeSearchContext
                               .Parse(WebOperationContext.Current);
            ..............
            ..............
            ..............
        }

    }

[ServiceContract]
    public interface IAwesomeRestService
    {
        [OperationContract]
        [WebInvoke(Method = "GET", ResponseFormat = WebMessageFormat.Xml,
        BodyStyle =  WebMessageBodyStyle.Bare,
            UriTemplate = "/search/xml")]
        AwesomeQueryResults<AwesomeProductBase> GetAwesomeResultsAsXml();

    }

public class AwesomeSearchContext
        {
            ................
            ................
            ................
             public static AwesomeSearchContext Parse 
                                           (WebOperationContext operationContext)
            {
                return WebOperationContext.Current != null ? new     
 AwesomeSearchContext(operationContext.IncomingRequest.UriTemplateMatch.QueryParameters) : null;
            }
        } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-05-22T09:12:24.613

我遇到了同样的问题。我想在没有任何 IIS 的情况下对 WCF 服务功能（用于 IOauth2 接口，如下例）进行单元测试。这是准备的代码片段。

```
// Prepare WebOperationContext
var factory = new ChannelFactory<IOauth2>(
    new WebHttpBinding(),
    new EndpointAddress("http://localhost:80"));

OperationContext.Current = new OperationContext(factory.CreateChannel() as IContextChannel);
Debug.Assert(WebOperationContext.Current != null); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-25T07:34:07.140

我按照 Sanjay 的回答，尝试了 MS fake 框架，

首先，你必须`open "Solution Explorer > your test project > Reference"`=> `right-click the "System.ServiceModel.Web"`=>`press "add Fakes Assembly"`

## 参考：

```
using Microsoft.QualityTools.Testing.Fakes;
using System.ServiceModel.Web.Fakes; 
```

## 样本：

```
using (ShimsContext.Create())
{
    var response = new ShimOutgoingWebResponseContext();
    var request = new ShimIncomingWebRequestContext();

    var ctx_hd = new WebHeaderCollection();
    ctx_hd.Add("myCustomHeader", "XXXX");
    request.HeadersGet = () => ctx_hd;

    var ctx = new ShimWebOperationContext
    {
        OutgoingResponseGet = () => response,
        IncomingRequestGet = () => request
    };
    ShimWebOperationContext.CurrentGet = () => ctx;

    //Test your code here...
} 
```

现在您可以在 WCF 服务代码中获取 WebOperationContext.Current.IncomingRequest.Headers["myCustomHeader"] 了。

更多关于 MSDN 上的 MS Fakes 框架： [https ://msdn.microsoft.com/en-us/library/hh549176.aspx](https://msdn.microsoft.com/en-us/library/hh549176.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T08:57:35.163

一种常见的方法是模拟 moq ( [https://code.google.com/p/moq/](https://code.google.com/p/moq/) ) 或 rhinomocks 等工具。

由于它们不允许您模拟静态成员，您需要将调用包装到 webcontext.current。这是包装静态 mmember 并使用 moq 进行测试的示例：[Mock static property with moq](https://stackoverflow.com/questions/2416362/mock-static-property-with-moq)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-01T17:52:39.450

如果您还没有使用 MS Fakes 框架，可能会矫枉过正，但如果您使用的话，这对我有用。

```
using (ShimsContext.Create())
        {

            var response = new ShimOutgoingWebResponseContext();
            var ctx = new ShimWebOperationContext
            {
                OutgoingResponseGet = () => response
            };

            ShimWebOperationContext.CurrentGet = () => ctx;

            try
            {
                ParameterInspector.BeforeCall("operationName", new string[]{"some_argument"} );
            }
            catch (Exception e)
            {
                Assert.IsNull(e);
            }
        } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-24T19:09:17.530

为您的服务创建一个客户端，然后在客户端中处理 OperationContext：

```
public class AwesomeRestServiceClient : ClientBase<IAwesomeRestService>, IAwesomeRestService
{
    public class AwesomeRestServiceClient(string address)
        : base(new WebHttpBinding(), new EndpointAddress(address))
    {   
        this.Endpoint.EndpointBehaviors.Add(new WebHttpBehavior());
    }

    public AwesomeSearchResults<AwesomeProductBase> GetAwesomeResultsAsXml()
    {
        using (new OperationContextScope(this.InnerChannel))
        {
            return base.Channel.GetAwesomeResultsAsXml();
        }
    }
} 
```

有关如何使用此功能的更多信息，请参阅[此答案](https://stackoverflow.com/questions/406955/easy-way-to-mock-a-wcf-service/67677474#67677474)。

# performance - 在excel vba中格式化需要很长时间

> ID：16068002
> 
> 赞同：1
> 
> 时间：2013-04-17T19:00:28.183
> 
> 标签：performance, vba, excel, excel-2010

我有一个 excel (2010) 表，我从数据库中加载数据，然后根据每行中的特定单元格格式化每一行。格式化代码需要很长时间。大约 150 行和 15 列大约需要 4 分钟。这是代码片段。基本上它是一个循环，检查 row_type 的值并相应地为每一行设置字体颜色、背景颜色等。有没有比使用循环更好的方法？如果循环是答案，我可以做的任何其他改进。

```
 J = 1
 While J <= iNumRows
    row_type = Worksheets("WaterFall").Range("WaterFallHeaders").Offset(J, -1).Cells(1, 1)

    If row_type = "main_row" Then
        With Worksheets("WaterFall").Range("WaterFallHeaders").Offset(J, 0).EntireRow.Font
            .Bold = False
            .ColorIndex = RGB(0, 0, 0)
        End With
        'yellow Description columns
        With Worksheets("WaterFall").Range("WaterFallHeaders").Offset(J, 0).Resize(1, 5).Interior
                .Color = RGB(204, 255, 204)
        End With
        'grey amount columns
        With Worksheets("WaterFall").Range("WaterFallHeaders").Offset(J, 5).Resize(1, dtCount + 2).Interior
            .Color = RGB(217, 217, 217)
        End With

        'blue action columns
        With Worksheets("WaterFall").Range("WaterFallHeaders").Offset(J, 0).Cells(1, 1).Font
            .Bold = True
        End With
        With Worksheets("WaterFall").Range("WaterFallHeaders").Offset(J, 0).Cells(1, 1).Interior
                .Color = RGB(184, 204, 225)
        End With
    Else
        With Worksheets("WaterFall").Range("WaterFallHeaders").Offset(J, 0).Resize(1, colCount - 1).Font
            .Bold = True
            .Color = RGB(51, 51, 255)
        End With
        With Worksheets("WaterFall").Range("WaterFallHeaders").Offset(J, 0).Resize(1, colCount - 1).Interior
                .Color = RGB(255, 255, 204)
        End With
    End If

    J = J + 1

Wend 
```

谢谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:15:28.593

这看起来不像是需要 4 分钟才能完成的事情（例如，Range.Autofill 大约 100,000 行在我的机器上大约需要 90 秒）。

但是，您可以通过减少对某些对象的调用次数，更好地使用`With`块来提高代码效率。

这减少了编译器必须引用`Worksheets("WaterFall").Range("WaterFallHeaders")`1 的次数。以前，您引用 3 或 6 次，具体取决于`If/Else`.

**未经**测试，因为我没有您的工作簿文件来测试它。让我知道这是否有帮助或是否给您带来任何问题。

```
J = 1
With Worksheets("WaterFall").Range("WaterFallHeaders")
    While J <= iNumRows
        row_type = .Offset(J, -1).Cells(1, 1)

        If row_type = "main_row" Then
            With .Offset(J, 0).EntireRow.Font
                .Bold = False
                .ColorIndex = RGB(0, 0, 0)
            End With

            'yellow Description columns
            With .Offset(J, 0).Resize(1, 5).Interior
                .Color = RGB(204, 255, 204)
            End With

            'grey amount columns
            With .Offset(J, 5).Resize(1, dtCount + 2).Interior
                .Color = RGB(217, 217, 217)
            End With

            'blue action columns
            With .Offset(J, 0).Cells(1, 1)
                .Font.Bold = True
                .Interior.Color = RGB(184, 204, 225)
            End With
        Else

            With .Offset(J, 0).Resize(1, colCount - 1)
                With .Font
                    .Bold = True
                    .Color = RGB(51, 51, 255)
                End With
                .Interior.Color = RGB(255, 255, 204)
            End With
        End If
    Wend
End With 
```

# php - 处理表单数据之前的 PHP 审查页面（例如通过电子邮件发送）

> ID：16068004
> 
> 赞同：1
> 
> 时间：2013-04-17T19:00:33.383
> 
> 标签：php, forms, post, preview

我有 HTML 表单，它只通过 PHP 将填写的表单发送到电子邮件。好吧，我需要先将该信息发送到评论页面，让客户检查所有填写的信息，让他们审核并再次提交，然后才将该信息发送到电子邮件。这个怎么做？

这是代码：

```
<?php
// Please specify your Mail Server - Example: mail.yourdomain.com.
ini_set("SMTP", "mail.amaderica.com");
// Please specify an SMTP Number 25 and 8889 are valid SMTP Ports.
ini_set("smtp_port", "25");
// Please specify the return address to use
ini_set('sendmail_from', 'ravila@art.com');

$name = $_POST['Attention_To'];

// Set parameters of the email
$to = "ravila@art.com";
$subject = "Art Promo Items Ordered";
$from = " nostrowski@art.com";
$headers = "From: $from";

$message =
    "Order has been placed. Attn to: $name .\n" .
    "Items:\n";
foreach ($_POST as $fieldName => $fieldValue)
{
    if (!empty($fieldValue))
        $message .= "   $fieldName: $fieldValue\n";
}

// Mail function that sends the email.
mail($to, $subject, $message, $headers);

header('Location: thank-you.html');
?> 
```

我的表单中的一些字段是`silver_name_badges`, `coffee_mug`, `plastic_bag`, `paper_bag`, `candy`, `moist_towlette`, `notepad_and_pen`, `tuck_box`, `red_tie`, `cap`, `red_lanyard`, 等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T21:50:30.887

## 评论页面

使表单提交到评论页面，而不是您的发送页面（=您问题中的代码）。除了呈现评论页面本身（包含所有数据）之外，将数据副本放入隐藏的表单字段。添加*电子邮件*提交按钮，该按钮将数据（有效地以与原始表单相同的格式）提交到发送页面。

例子：

```
<dl>
<?
if (!empty($_POST['plastic_bag']))
{
?>
    <dt>Plastic bag:</dt>
    <dd><?=htmlspecialchars($_POST['plastic_bag'])?></dd>
<?
}
if (!empty($_POST['paper_bag']))
{
?>
    <dt>Paper bag:</dt>
    <dd><?=htmlspecialchars($_POST['paper_bag'])?></dd>
<?
}
// and so forth for all fields 
?>
</dl>

<form action="your_mailing_script_from_your_question.php" method="post">
<?
foreach ($_POST as $key => $value)
{
    echo "<input type=\"hidden\" name=\"".htmlspecialchars($key).
         "\" value=\"".htmlspecialchars($value)."\"/>\n";
}
?>
<input type="submit" value="Email this"/>
</form> 
```

## “返回键

在 HTML4 中，您不能在同一个表单上有两个按钮，将表单提交到不同的 URL。所以有两种选择：

*   更简单：制作两个表单，每个表单都包含所有隐藏字段和一个按钮。每个表单提交到不同的 URL，一个发送到电子邮件，一个返回到表单。
*   保留一个提交到的表单，比如说电子邮件 URL，但那里的脚本会检查按下的按钮（您必须命名按钮并检查`empty($_POST["button_name"])`）。然后它检测到“返回”按钮被按下，它将帖子重定向回表单 URL。

在 HTML5 中，您可以让每个按钮提交到不同的 URL。检查标签`formaction`的属性。`input`我不知道，如果你负担得起使用 HTML5。检查浏览器[中对属性的支持。](https://www.w3schools.com/tags/att_input_formaction.asp)

当然，你必须修改表单脚本来填写表单数据，通过“返回”按钮提交。例如：

```
<p>
<label for="plastic_bag">Plastic bag:</label>
<?
$value =
    !empty($_POST["plastic_bag"]) ? htmlspecialchars($_POST["plastic_bag"]) : NULL;
?>
<input name="plastic_bag" id="plastic_bag" value="<?=$value?>"/>
</p> 
```

# jquery - 将 JQuery 合并到 Rails 中

> ID：16068012
> 
> 赞同：0
> 
> 时间：2013-04-17T19:00:53.537
> 
> 标签：jquery, ruby-on-rails

讨厌再次问这个问题，但其他解决方案都没有让它对我有用。我对此完全是新手，但我正在尝试将一些简单的 JQuery 合并到我在 Rails 上的网站中。

在我的 app\views\application.html.erb 中：

```
<%= stylesheet_link_tag    "application", :media => "all" %>
<%= javascript_include_tag 'jquery', "application" %>
<%= csrf_meta_tags %> 
```

另请阅读某处以包含在页脚中：

```
<%= javascript_include_tag(:application) %> 
```

但这似乎是重复的。

在我的 app\assets\javascripts\application.js 我有：

```
//= require jquery
//= require jquery_ujs
//= require_tree . 
```

所以它被注释掉了，不知道这是否正确？

最后，我在同一文件夹中的“main.js”中有我的简单 jquery 代码：

```
$(document).ready(function() {
$('img').mouseenter(function() {
    $(this).fadeTo('fast', 1);
});
$('img').mouseleave(function() {
    $(this).fadeTo('fast', 0.5);
});
}) 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:04:49.070

将其添加到 application.js 和

```
<%= javascript_include_tag "application" %> 
```

应该为你工作。无需在您的布局中单独声明/加载它。

要加载 main.js 文件，您还需要在 application.js 中指定它

```
//= require jquery
//= require jquery_ujs
//= require main.js 
```

与要求树相比，要求文件将为您提供更好的控制。两次/三次加载 jQuery 也可能会导致您出现问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:09:13.873

注释部分并不是真正的注释，它是 sprockets`//=`用来知道创建 application.js 时要包含哪些文件的符号。application.js 基本上是一个清单文件（如文件顶部的注释中所写

要使 jquery 发生，并且能够使用，请`//= require jquery`确保安装了 jquery gem`gem 'jquery-rails'`

另外，在页眉中包含 jquery，而不是在页脚中，因为 onload javascript 将无法使用它

# wpf - Where does PresentationTraceSources.Refresh look for the app.config file?

> ID：16068013
> 
> 赞同：0
> 
> 时间：2013-04-17T19:00:58.437
> 
> 标签：wpf, debugging, app-config, trace

I am trying to better understand PresentationTraceSources. The docs for the Refresh() method say "Refreshes trace sources, by forcing the app.config file to be re-read." Where does it expect to find the app.config file? If I add an application configuration file to my project, it is placed in the project source folder, but when the app is deployed, there is no such folder. What does Refresh() do if it can't find app.config. If I configure PresentationTraceSources in code, an app.config file doesn't necessarily exist. But the PresentationTraceSources.Refresh() call is still required. What is really happening in this case?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:34:18.560

是的，您可以在没有配置文件的情况下使用 Systems.Diagnostics 侦听器。例如，在按钮后面的事件处理程序中，创建一个侦听器，然后将该侦听器注册到各种源。

预期的场景是使用配置文件，假设机器管理员（与用户分开）将收集跟踪，并且需要在不重新编译的情况下这样做，并且需要在不重新编译的情况下关闭跟踪。这将通过在应用程序配置文件中配置侦听器来完成，该文件名为 XamlPad.exe.config

看起来您需要设置一个注册表项，并且您需要完全信任。

[http://msdn.microsoft.com/en-us/library/system.diagnostics.presentationtracesources.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.presentationtracesources.aspx)

我想这个跟踪是由 MS 开发人员编写的，以帮助您弄清楚他们的代码在做什么。System.Net 和 WCF 堆栈都大量使用 System.Diagnostics 跟踪 - 一旦您知道跟踪源名称，您就可以连接侦听器并“查看矩阵”滚动。

您可以写入任何跟踪源，但您可能想要创建自己的跟踪源，它们很容易创建。

# php - CakePHP 基于域名的动态主页

> ID：16068014
> 
> 赞同：0
> 
> 时间：2013-04-17T19:01:01.060
> 
> 标签：php, cakephp, cakephp-2.1, cakephp-routing

我希望根据域名更改我的应用程序的主页。

*   要链接到的域名 x.com（我们的主应用程序域）：控制器：页面 | 行动：回家
*   域名 y.com 或 z.com（通过我们的主应用程序域创建的商店）链接到：控制器：商店 | 行动：索引

要设置主页，定义此路由：

```
Router::connect('/', array('controller' => 'pages', 'action' => 'home')); 
```

**问题：**如何使这个动态并添加条件，以便根据域名加载不同的控制器/动作？

**笔记：**

*   在 AppController 的 beforeFilter 中，我执行了一些数据库检查。它检查以确保商店确实存在（通过商店模型）。如果商店/域不存在，它会重定向到我们的主域名。
*   我想保持 URL 干净。我不想重定向到基于域名的页面。重定向意味着主页看起来像[http://x.com/pages/home/](http://x.com/pages/home/)就像[http://x.com/](http://x.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:06:39.313

我想到的一种方法是在加载 Cake 之前解析域并为不同的域加载不同的路由配置（例如单独的文件）。这样，您可以为每个域加载不同的配置，因此相同的路径可以与不同域的不同控制器相关联。

# wordpress - Permalinks do not work on Event subpages

> ID：16068021
> 
> 赞同：0
> 
> 时间：2013-04-17T19:01:32.240
> 
> 标签：wordpress

I have problem with permalink. When I set "Post name" option, I get "Page not found".

I have an event page: url is [http://mydomain.com/events/event-1/](http://mydomain.com/events/event-1/) This event page has 3 static pages, one of the urls is [http://mydomain.com/event-1/about/](http://mydomain.com/event-1/about/), [http://mydomain.com/event-1/register/](http://mydomain.com/event-1/register/)... I get 404 error on this page. Event is a parent of this 3 static pages. Static I just meant Wordpress pages.

I do not know what to do.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:25:29.557

阅读此页面： [http ://codex.wordpress.org/Using_Permalinks](http://codex.wordpress.org/Using_Permalinks)

如果您使用的是 Apache，请确保启用 FollowSymLinks 选项并且允许使用 FileInfo 指令。

# javascript - 如何在 Inteceptor 模式中使用 dojo/promise/Promise.cancel()

> ID：16068025
> 
> 赞同：4
> 
> 时间：2013-04-17T19:01:50.370
> 
> 标签：javascript, dojo

我希望为特定于应用程序的 AJAX 控制器实现一个 Inteceptor Pattern。

我的应用程序中的任何 AJAX 请求都会调用 Authenticator.request()，它会拦截响应，检查某些状态（例如 401、403、503），根据它们执行特定于应用程序的显示功能（即，如果状态 401 是，则显示 LoginDialog已收到）。我的问题源于对 dojo 的 Promises 的混淆。

1.  如何将成功的请求传递回原始调用方法？
2.  当我调用 dojo.promise.Promise.cancel() 时，我希望链接停止。但是，这只是运行 errback 函数。这意味着需要在调用函数的每个 errback 方法中放置逻辑，以区分取消的请求和错误。

谁能向我解释在这种情况下如何使用 Promises？

提前致谢！

这是我认为我可以做的一个例子......

```
require(["dojo/request"], function(request){
    auth = { 
        request: function() {
            var promise = request(arguments);

            return promise.always(function (response) {
                console.log("always called", response);
                switch (response.response.status)
                {
                    case 404:
                        console.log(404, response);
                        return "cancelled";
                        break;
                }
            });
        }
    };
});

auth.request('example.json').then(function(text){ console.log('success!', text) }, function(error){
    console.log('error!', error);
}); 
```

如果这对将来的任何人有帮助，这就是我最终实现的（基于戴夫的回答）......

```
require(["dojo/request", "dojo/errors/CancelError"], function(dRequest, CancelError){
    auth = { 
        request: function(url, options) {
            var promise = dRequest(url, options);

            return promise.response.then(
                function (response) {
                    return response;
                },
                function (error) {
                    var error,
                        cancelError = new CancelError(error.message);
                    cancelError.response = error.response;
                    console.log("error", error, cancelError);

                    switch (error.response.status)
                    {
                        case 404:
                            console.log(404, "canceled");
                            throw cancelError;
                    }
                    throw error;
                }
            );
        },
        cancelTrap: function (errorBack, cancelBack) {
            return function (error) {
                throw (error instanceof CancelError) 
                    ? cancelBack && cancelBack(error) || error 
                    : errorBack && errorBack(error) || error;
            }
        }
    };
}); 
```

...然后可以像这样使用...

```
r = auth.request('something.json');
r.then(
    function(text){
        console.log('success! > this', this)
        console.log('success!', text)
        return text;
    }, 
    auth.cancelTrap(
        function (error) {
            console.log('error!', error);
            throw error;
        },
        function (cancelError) {
            console.log('cancelError!', cancelError);
            throw cancelError;
        }
    )
).then(
    function(text){
        console.log('success2!', text)
    }, 
    auth.cancelTrap(
        function (error) {
            console.log('error2!', error);
            throw error;
        },
        function (cancelError) {
            console.log('cancelError2!', cancelError);
            throw cancelError;
        }
    )
); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T09:38:15.717

Promise 非常强大，我认为您应该尝试了解通过该`then`函数提供的两种执行路径（假设`always`只是使用`then`与两个参数相同的函数进行调用的快捷方式）：

`promise.then(successCallback, errorCallback)`

*   返回一个承诺。
*   如果满足以下条件，则此承诺已解决（成功）：
*   successCallback*或*errorCallback 返回一个值。这个promise 要么用这个值解决，或者如果这个值是一个promise，它用这个promise 的resolve 来解决。

*   如果出现以下情况，则此承诺被拒绝（错误）：

*   successCallback*或*errorCallback 都会引发错误。

此外，如果没有提供 errorCallback ，如果原始承诺被拒绝（错误），则会冒泡到提供错误处理程序的下一个级别，所以如果我这样做：

```
promise.then(func1).then(func3).then(finalFunc, errorHandler);
promise.reject(someError); 
```

然后`errorHandler`用 调用`someError`。

这一切的意思是，如果您不想在某个级别处理错误，那就不要，让它在链中冒泡并在最高级别实现*一个错误处理程序。*如果您只想处理某些错误，您可以像这样“包装它或捕获它”：

```
promise.then(successFunction, function(error) {
    if(error.code > 400) {
         // do something clever, maybe just send an empty result up the chain
         return []; // goes to successCallbacks!
    } else {
        throw error; // pass it to the next errorHandler
    }
}); 
```

最后，总结一下并尝试回答您的问题：

如何将成功的请求传递回原始调用方法？

您可以简单地`return`将值传递给下一个successHandler。

当我调用 dojo.promise.Promise.cancel() 时，我希望链接停止。但是，这只是运行 errback 函数。这意味着需要在调用函数的每个 errback 方法中放置逻辑，以区分取消的请求和错误。

不幸的是，您不允许停止链接，promise 旨在稳健地传递到完成。但是，您不能*在*每个路口都放置一个错误提示，仅在您真正需要时添加一个，并且您的解决方案应该非常干净。

# javascript - How to creat a 'remove item' button in simple cart?

> ID：16068027
> 
> 赞同：1
> 
> 时间：2013-04-17T19:01:55.760
> 
> 标签：javascript, paypal, simplecart

Ok so I have simple cart installed ( simple javascript cart that works in conjunction with payapl)

I had someone implement simple cart, but they are no longer available.

I need a way to remove the items from my cart.

Right now, if I input a value of '0' then the items are removed, but this may not be evident to my users.

Is it possible to make a little 'remove item link per item?

please visit:

[http://www.bodesi.com/product/tiling/small-subway-mosaic/15x48x6/Hand-Painted/SMTI026/SMTI026.html#ad-image-0](http://www.bodesi.com/product/tiling/small-subway-mosaic/15x48x6/Hand-Painted/SMTI026/SMTI026.html#ad-image-0)

please add an item, and see the cart in the top right hand corner.

thanks in advance and hope I have been clear! let me know if you need more information.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T04:36:17.160

一种选择是创建一个查看购物车按钮，然后买家可以从那里从购物车中删除商品。您可以使用查看购物车按钮的代码，并使用不同的按钮图像，以便他们可以清楚地单击按钮来查看购物车或删除项目。一旦他们点击按钮，它将向买家显示他们在购物车中的所有物品，并且可以根据需要从那里删除它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-06T23:22:28.830

不确定您是否仍然在此，但 simplecartjs 中内置了一个非常简单的解决方案。

清空整个购物车：`<a href="javascript:;" class="simpleCart_empty"></a>`

删除单个项目：`<a class="simpleCart_remove" href="javascript:;">Whatever Text You want</a>`

还注意到您没有任何屏幕警报让用户知道在他们选择添加到购物车后东西已添加到购物车（我点击了大约 3 次才意识到它正在添加它）。:)

为此，您使用 simplecartjs 中称为 afteradd 的另一种简单方法：

```
 simpleCart.bind( "afterAdd" , function(){
    $('.add-cart-msg').hide()
                      .addClass('success')
                      .html('Added to cart successfully!')
                      .fadeIn(300)
                      .delay(3000)
                      .fadeOut(1300);

    }); 
```

然后，您只需要`class="add-cart-msg"`添加到购物车按钮旁边的东西。它会淡入，坐在那里大约 3 秒钟，然后淡出。

我希望你觉得这有帮助。

这是一些非常方便的参考资料：[Simplecartjs 文档](http://simplecartjs.org/documentation)

# r - 将多个序列中的元素总和折叠到有序列表 R

> ID：16068032
> 
> 赞同：2
> 
> 时间：2013-04-17T19:02:06.673
> 
> 标签：r, sequence

令 r = c(0,1,2) 和 s = c(0,5,10)。我想要一个可以采用 r 和 s 的函数（最终将采用两个以上的序列 - 如果可能，我想避免循环！），并返回 r 和 s 中元素总和的所有唯一组合的有序列表，即返回以下：

0,1,2,5,6,7,10,11,12

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T19:07:05.873

您可以将函数`expand.grid()`和`rowSums()`. `expand.grid()`将制作所有组合的数据框，`rowSums()`并将计算这些组合的总和。

```
r = c(0,1,2)
s = c(0,5,10)
rowSums(expand.grid(r,s))
[1]  0  1  2  5  6  7 10 11 12 
```

使用函数`sort()`，您可以对值进行排序。

```
r = c(0,1,2)
s = c(0,5,10)
k=c(3,4,6)
rowSums(expand.grid(r,s,k))
 [1]  3  4  5  8  9 10 13 14 15  4  5  6  9 10 11 14 15 16  6  7  8 11 12 13 16 17 18
sort(rowSums(expand.grid(r,s,k)))
 [1]  3  4  4  5  5  6  6  7  8  8  9  9 10 10 11 11 12 13 13 14 14 15 15 16 16 17 18 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:59:33.623

与@Didzis 类似的概念，但使用`outer`with`Reduce`代替：

```
as.vector(Reduce(function(x, y) outer(x, y, '+'), list(r, s, k)))
#  [1]  3  4  5  8  9 10 13 14 15  4  5  6  9 10 11 14 15 16  6  7  8 11 12 13 16 17 18 
```

`sort`如有必要，用 a 包裹它。

* * *

小基准测试：

```
w <- sample(50)
x <- sample(50)
y <- sample(50)
z <- sample(30)

# arun's 
system.time(t1 <- as.vector(Reduce(function(x, y) outer(x, y, '+'), list(w, x, y, z))))
#    user  system elapsed 
#   0.051   0.044   0.100 

# Didzis'
system.time(t2 <- rowSums(expand.grid(w, x, y, z)))
#    user  system elapsed 
#   1.167   0.308   1.579 

identical(as.numeric(t1), t2)
[1] TRUE 
```

# php - preg_regex 中的转义斜线还是我必须这样做？

> ID：16068034
> 
> 赞同：0
> 
> 时间：2013-04-17T19:02:15.443
> 
> 标签：php, regex

我有这个文本和表达式，我尝试了一切，但它不起作用。如果我在最后删除斜线，那么它可以工作。根据 preg_quote 手册，我需要转义的唯一字符是：

> . \ + * ? [ ^ ] $ ( ) { } = ！< > | : -

我试图用反斜杠转义最后一个斜杠`\/`并尝试`\\/`但它仍然不起作用。

```
Sample text:  song
file="http://mehangcuugiup.net/images/radio/2013/t4/Thu Ba ngay
16-4-2013.mp3" title="Thu Ba ngay 16-4-2013"/;

NOT Match Expression: $exp = '@song file="(http.+?\.mp3)"
title=".+?(\d+\-\d+\-\d{4})"/@i';

Good Expression: $exp = '@&lt;song file="(http.+?\.mp3)"
title=".+?(\d+\-\d+\-\d{4})"@i'; 
```

我知道我可以删除最后一个斜线来获取我的数据，但是这个问题已经困扰我一段时间了，我想知道它的原因。

感谢您的任何意见！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:06:42.393

您需要使用双引号转义该斜线`"\/"`。`

```
$exp = "@song file=\"(http.+?.mp3)\" title=\".+?(\d+-\d+-\d{4})\"\/@i"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:14:30.757

`/`如果您使用它作为分隔符，您只需要转义。在您的情况下，分隔符是`@`，因此您不需要转义`/`（但是，您*确实*需要转义`@`）。

```
<?php

$song = 'song file="http://mehangcuugiup.net/images/radio/2013/t4/Thu Ba ngay 16-4-2013.mp3" title="Thu Ba ngay 16-4-2013"/';
$exp = '@song file="(http.+?\.mp3)" title=".+?(\d+\-\d+\-\d{4})"/@i';

if(preg_match($exp, $song, $match) === 1){
    var_dump($match);
} 
```

演示：http: [//ideone.com/iuunxe](http://ideone.com/iuunxe)

# ruby - ruby cucumber xpath 包含“或”运算符

> ID：16068037
> 
> 赞同：-1
> 
> 时间：2013-04-17T19:02:24.310
> 
> 标签：ruby, xpath, cucumber

我正在尝试为 pdf 文本处理 xpath。这就是我所拥有的

```
 cell(:x, :xpath => "//table//td[contains(.,'pdf')]") 
```

我正在寻找的是使“pdf”不区分大小写的正确方法，因此它可以是“pdf”或“PDF”

这是我尝试过的

```
cell(:commission_statement, :xpath => "//table//td[contains(.,'pdf'|'PDF')]") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:55:12.780

试试`:xpath => "//table/td[contains(.,'pdf') or contains(.,'PDF')]"`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:58:04.000

您可以使用此 xpath：

```
"//table//td[contains(.,'pdf')] | //table//td[contains(.,'PDF')]" 
```

替代解决方案：

```
"//td[contains(translate(., 'PDF', 'pdf'), 'pdf')]" 
```

translate 的作用：
translate(string1,string2,string3)

通过将 string2 中的字符替换为 string3 中的字符来转换 string1
示例： translate('12:30','30','45') 结果：'12:45'

示例： translate('12:30','03','54') 结果：'12:45'

示例： translate('12:30','0123','abcd') 结果：'bc:da'

# javascript - 奇怪的 Javascript TypeError '不是函数'

> ID：16068042
> 
> 赞同：1
> 
> 时间：2013-04-17T19:02:48.477
> 
> 标签：javascript, jquery

我得到一个奇怪的 JS TypeError：

```
TypeError: $(...).formset is not a function
added: function(row) { 
```

现在，JS 看起来像这样：

```
$('#richtextcontent_set-group .inline-related').formset({
  prefix: "richtextcontent_set",
  addText: "Text hinzufügen",
  formCssClass: "dynamic-richtextcontent_set",
  deleteCssClass: "inline-deletelink",
  deleteText: "Entfernen",
  emptyCssClass: "empty-form",
  removed: updateInlineLabel,
  added: function(row) {
    initPrepopulatedFields(row);
    reinitDateTimeShortCuts();
    updateSelectFilter();
    updateInlineLabel(row);
  }
}); 
```

真的不能`.formset()`叫。如果我执行

```
$('#richtextcontent_set-group .inline-related').formset({}) 
```

在控制台中，它不会返回任何错误。

并且该`added:`选项显然具有功能。

我正在使用 django-dynamic-formset 插件： [http ://code.google.com/p/django-dynamic-formset/](http://code.google.com/p/django-dynamic-formset/)

那么这里可能是什么问题呢？

如有必要，我很乐意提供更多信息。谢谢。

**更新**

django inlines.js（包含`formset()`）实际上没有加载，因为 InlineModelAdmin 上有一个凌乱的猴子补丁覆盖了它的 media 属性。感谢您的评论和回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:15:37.233

尝试在有问题的代码之前记录输出。

```
var formset = $('#richtextcontent_set-group .inline-related').formset;

// have a look at formset
console.log(formset);

formset({
    ...
    configuration properties
    ...
}); 
```

如果`undefined`返回到控制台，则在您调用它时未加载插件。在这种情况下，最好在 dom 准备好时执行您的代码。这个例子将它包装在里面`$(function() { ... })`来做到这一点。

```
$(function () {
    $('#richtextcontent_set-group .inline-related').formset({
        ...
        configuration properties
        ...
    }));
}); 
```

现在你几乎可以确定它是在插件加载时执行的。

# javascript - jQuery 将 DIV 复制到另一个 DIV

> ID：16068047
> 
> 赞同：117
> 
> 时间：2013-04-17T19:02:59.450
> 
> 标签：javascript, jquery, html

需要一些 jquery 帮助将 DIV 复制到另一个 DIV 并希望这是可能的。我有以下 HTML：

```
 <div class="container">
  <div class="button"></div>
  </div> 
```

然后我在页面的另一个位置有另一个 DIV，我想将“按钮”div 复制到以下“包”div 中：

```
<div class="package">

Place 'button' div in here

</div> 
```

* * *

## 回答 #1

> 赞同：184
> 
> 时间：2013-04-17T19:04:19.827

您需要使用该`clone()`方法来获取元素的深层副本：

```
$(function(){
  var $button = $('.button').clone();
  $('.package').html($button);
}); 
```

完整演示：http: [//jsfiddle.net/3rXjx/](http://jsfiddle.net/3rXjx/)

来自[jQuery 文档](http://api.jquery.com/clone/)：

> .clone() 方法执行匹配元素集的深层复制，这意味着它复制匹配的元素以及它们的所有后代元素和文本节点。当与其中一种插入方法结合使用时，.clone() 是一种在页面上复制元素的便捷方法。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2015-10-01T06:38:44.383

使用 clone 和 appendTo 函数复制代码：

这里也是工作示例[jsfiddle](http://jsfiddle.net/sunnysm/fwjh1mv5/1/)

```
<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
</head>
<body>
<div id="copy"><a href="http://brightwaay.com">Here</a> </div>
<br/>
<div id="copied"></div>
<script type="text/javascript">
    $(function(){
        $('#copy').clone().appendTo('#copied');
    });
</script>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-17T19:05:16.420

你可以像这样复制你的div

```
$(".package").html($(".button").html()) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-17T19:05:12.070

把它放在一个事件上

```
$(function(){
    $('.package').click(function(){
       var content = $('.container').html();
       $(this).html(content);
    });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-22T05:49:08.597

```
$(document).ready(function(){  
    $("#btn_clone").click(function(){  
        $("#a_clone").clone().appendTo("#b_clone");  
    });  
}); 
```

```
.container{
    padding: 15px;
    border: 12px solid #23384E;
    background: #28BAA2;
    margin-top: 10px;
}
```

```
<!DOCTYPE html>  
<html>  
<head>  
<title>jQuery Clone Method</title> 
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script> 

</head>  
<body> 
<div class="container">
<p id="a_clone"><b> This is simple example of clone method.</b></p>  
<p id="b_clone"><b>Note:</b>Click The Below button Click Me</p>  
<button id="btn_clone">Click Me!</button>  
</div> 
</body>  
</html> 
```

[有关更多详细信息和演示](https://www.tutsmake.com/how-to-duplicate-html-elements-using-jquery-clone/)

# c# - 使用 C# 使用 ETW 内核跟踪

> ID：16068051
> 
> 赞同：0
> 
> 时间：2013-04-17T19:03:03.020
> 
> 标签：c#, etw

我正在使用 Windows Server 2012 并尝试使用 C# 使用来自 ETW 的内核跟踪。例如，我有一个名为“LiveKernel”的数据收集器集，它有一个“Windows 内核跟踪”提供程序来捕获线程系统调用事件，并且流模式是实时的。

使用[Daniel Vasquez Lopez 提供的代码](http://blogs.msdn.com/b/danielvl/archive/2009/01/25/view-etw-rewrite-events.aspx)作为起点，我正在尝试使用这些事件。但是，我收到的输出总是：

```
Listening...Press <Enter> to exit 
```

这对我来说表明它没有消耗任何事件。我对这段代码的理解是，我所要做的就是更改名称和 GUID 以反映我的新选择，因此我将代码更新为

```
 Guid RewriteProviderId = new Guid("9E814AAD-3204-11D2-9A82-006008A86939");
    using (EventTraceWatcher watcher = new EventTraceWatcher("LiveKernel", RewriteProviderId)) { 
```

我在这里缺少什么吗？有没有更好的方法来使用内核跟踪？“Windows 内核跟踪”提供程序是否有什么特别之处可以阻止我们实时使用它的事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T15:59:02.023

要完成您想要使用[Vance Morrison 博客](http://blogs.msdn.com/b/vancem/archive/2013/03/09/using-traceevent-to-mine-information-in-os-registered-etw-providers.aspx)中的 TraceEvent 库的要求。我已经在以管理员身份运行的 Windows 8 上测试了该示例，它运行良好。

要列出每个有效负载属性名称和值，您需要将示例委托交换为以下示例。

```
Action<TraceEvent> action = delegate(TraceEvent data)
{
  foreach (var name in data.PayloadNames)
  {
    Console.WriteLine("\t" + name + " -- " + data.PayloadByName(name));
  }
}; 
```

只需运行示例，然后启动一个新进程，您应该会开始看到一些跟踪信息。

![在 Win8 上启动 IE10 时的跟踪输出](https://i.stack.imgur.com/RYv44.png)

——拉尔斯

# html - HTMLIE10 中的项目容器边框 我正在尝试更改 IE10 中 HTML 下拉组件的奇怪外观。单击下拉箭头后，列表项容器上方带有我要修改的黑色边框。是否可以控制html下拉列表那部分的css？如果您想要时间值，那么这是相当快的。def dt_time(ind): return np.array([time(*time_tuple) for time_tuple in zip(ind.hour, ind.minute, ind.second)]) 调用 map 会慢很多。在 [29] 中：

> ID：16068053
> 
> 赞同：0
> 
> 时间：2013-04-17T19:03:08.903
> 
> 标签：html, select, internet-explorer-10

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:03:40.493

据我所知，无法更改包含所选项目的菜单的样式。有许多用于样式化 HTML 控件 [0] 的伪元素选择器，但没有一个用于该菜单。您可以设置披露小部件和当前所选项目的文本的样式。

[0] [http://msdn.microsoft.com/en-us/library/windows/apps/hh767361.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh767361.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:06:48.587

你说的是重点大纲吗？当输入元素获得焦点时，大多数浏览器都会在输入元素周围放置一条虚线。你可以设置`outline: none;`你`<select>`的禁用它。

# javascript - 单击所有链接后重定向？

> ID：16068056
> 
> 赞同：0
> 
> 时间：2013-04-17T19:03:11.390
> 
> 标签：javascript, html, redirect, cookies, href

我有一个包含三个主题标签网址的页面：

```
<a href="#Link1">Some Text 1</a>
<a href="#Link2">Some Text 2</a>
<a href="#Link3">Some Text 3</a> 
```

一旦用户点击了所有三个，我需要将它们重定向到另一个 URL。

有没有人有一个例子，或者知道我可以做到这一点的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:06:53.247

试试这个：

```
window.onload = function () {
    var anchors, clicked_count, clicked, i, cur_anchor, my_anchor_id;

    anchors = document.getElementsByTagName("a");
    clicked_count = 0;
    clicked = {};

    for (i = 0; i < anchors.length; i++) {
        cur_anchor = anchors[i];
        cur_anchor.setAttribute("data-anchor-id", i);
        cur_anchor.onclick = function (e) {
            e = e || window.event;
            e.preventDefault();

            my_anchor_id = this.getAttribute("data-anchor-id");
            if (!(my_anchor_id in clicked)) {
                clicked[my_anchor_id] = null;
                if (++clicked_count === anchors.length) {
                    console.log("WOULD BE REDIRECTING");
                    //window.location.href = "NEW URL";
                }
            }
        };
    }
}; 
```

**演示：http:** [//jsfiddle.net/hCRtD/1/](http://jsfiddle.net/hCRtD/1/)

为了证明演示有效，请在单击最后一个所需的锚点之前多次单击一些锚点。它不会在总共点击 3 次后完成（我原来的解决方案就是这样有缺陷的），而是会等到每个点击至少一次。

它为所有标签设置一个特殊属性`<a>`，唯一标识它们。显然，`id`可以使用 an ，但您没有包含它，这样做很容易。

然后，当一个锚点被点击时（仅是第一次），它的唯一标识符被添加到一个集合中（`clicked`）。

当每次第一次单击锚点时递增的计数器 ( `clicked_count`) 达到第一次找到的锚点总数时，一切都已完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:11:06.597

添加html类：

```
<a href="#Link1" class="redirect">Some Text 1</a>
<a href="#Link2" class="redirect">Some Text 2</a>
<a href="#Link3" class="redirect">Some Text 3</a> 
```

并尝试使用 javascript：

```
function catchAnchors(){
  var links = document.getElementsByClassName("redirect");//get your links
  for(var i=links.length-1;i>=0;i--){
   if(!links[i].wasClick)return;//if never clicked return;
  }
   location.href = "your url";//redirect
}

var links = document.getElementsByClassName("redirect");//get your links
for(var i=links.length-1;i>=0;i--){
  links[i].onclick = function(){
    this.wasClick = true;//set mark onclick event
    catchAnchors();//check links
  }
} 
```

# c# - WinForms：有什么方法可以在 Application.Run(new Form1()) 之前获取窗口句柄？

> ID：16068059
> 
> 赞同：1
> 
> 时间：2013-04-17T19:03:17.203
> 
> 标签：c#, winforms, process, handle

我有一个 winforms，**在 Application.Run(new Form1()) 之前**我向其他应用程序发送消息

```
[DllImport("user32.dll")]
public static extern long SendMessage(IntPtr Handle, int Msg, int wParam, int lParam); 
```

但我无法获得窗口句柄，我试过：

```
IntPtr Handle = Process.GetCurrentProcess().Handle; 
```

但有时它会返回错误的句柄。
我怎样才能做到这一点？非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:20:41.560

如果您尝试将消息发送到*不同*的应用程序，那么您需要获取*其*窗口句柄而不是属于您自己进程的窗口句柄。使用`Process.GetProcessesByName`查找特定进程，然后使用`MainWindowHandle`属性获取窗口句柄。注意`MainWindowHandle`与 不同`Handle`，后者指的是进程句柄而不是窗口句柄。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:46:59.240

函数的第一个参数[`SendMessage`](http://msdn.microsoft.com/library/windows/desktop/ms644950.aspx)是接收消息的窗口句柄。 [`Process.GetCurrentProcess().Handle`](http://msdn.microsoft.com/library/system.diagnostics.process.handle.aspx)返回当前进程的本机句柄。那不是窗口句柄。

[`Application.Run`](http://msdn.microsoft.com/library/ms157900.aspx)启动应用程序的消息循环。由于您想向另一个应用程序发送消息，因此您的应用程序根本不需要消息循环。但是，您需要另一个应用程序窗口的句柄。

以下示例显示了如何使用关闭另一个应用程序的主窗口`SendMessage`：

```
[DllImport("user32.dll")]
public static extern long SendMessage(IntPtr Handle, int Msg, int wParam, int lParam);

public const int WM_CLOSE = 0x0010;

private static void Main()
{
    var processes = Process.GetProcessesByName("OtherApp");
    if (processes.Length > 0)
    {
        IntPtr handle = processes[0].MainWindowHandle;
        SendMessage(handle, WM_CLOSE, 0, 0);
    }
} 
```

# java - 这种情况下如何避免代码重复？

> ID：16068061
> 
> 赞同：9
> 
> 时间：2013-04-17T19:03:22.070
> 
> 标签：java, oop, inheritance, interface

我的项目是关于在 java 中实现 hyperGraph

我的 hyperGraph 包含各种类型的 hyperEdge，具体取决于我拥有的顶点类型

顶点类型：图像，标签...

HyperEdge =同质（相同类型的相关顶点）/异构（不同类型的相关顶点）

同构HyperEdge = Image-image HyperEdge/Tag-tag hyperEdge

这是一个快速绘制的 UML 图

![在此处输入图像描述](https://i.stack.imgur.com/efE0l.png)

![在此处输入图像描述](https://i.stack.imgur.com/78Mps.png) 这是我的代码

```
public interface HomogenousHyperedge< T extends Vertex<L>, L> extends Hyperedge {

   public abstract List<T> searchNearstNeighborsVertex(
      Hypergraph hypergraph, T vertex);
} 
```

```
public class ImageImageHyperedge implements
   HomogenousHyperedge<ImageVertex, Map<String,Instance>> {

   @Override
   public List<ImageVertex> searchNearstNeighborsVertex(Hypergraph hypergraph,
        ImageVertex vertex) {
      return null;
   }
} 
```

问题出在 ImageImageHyperEdge 类中我应该知道基于它的特征类型是什么我将搜索 ImageVertex 最近邻居我无法将其传递给超级接口的抽象方法，因为 TagTagHyperEdge 类不需要它

如果我用 {featureOneHyperEdge class ,...featureFiveHyperEdge class } （我知道特征类型）替换 ImageImageHyperEdge 类，它将是重复的代码，因为它是相同的最近邻搜索算法

* * *

特征=图像的低级特征（例如颜色直方图）
我有 5 种低级特征
我将使用每一种来搜索我当前图像的最近邻居
所有特征都存储在一个简单的文本文件
中使用相同的算法搜索最近的邻居
，每次只更改文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T09:02:17.923

您的 UML 设计不够好。跳过丑陋且难以阅读的“样式”，向我们展示“顶点”和“边缘”，以及关联图；不是您（可能过于复杂）的继承想法。

您的 API、设计和基本问题不是很清楚。'Hyperedge' 类可以表示 Edge 的单个实例，并将其两端关联起来；或者它们可以（如果更好地命名）表示边缘类型，并从指定的端点参数全局搜索图形。

这些是完全不同的设计，在您弄清楚以上内容之前，您的问题毫无意义。

无论哪种方式， Edge.search() 都没有正确的签名。其中 VS 和 VE 是开始和结束顶点类型，而 TE 是边类型，它应该是：

```
public class EdgeType {
    public List<EV> getEndpoints (SV startVertex);
} 
```

或者

```
public class Vertex {
    public List<TE> Vertex.getEdges();
}
public class Edge {
    public EV Edge.getEndpoint();
} 
```

最近邻算法应该使用泛型类型实现，然后由具体类根据需要（使用精确的类型签名）调用。

顺便说一句，当您提到“最近的邻居”时；也不清楚“最近的邻居”是指*直接连接的顶点*，这是微不足道的，还是找到最近的远距离（如何测量距离？你没有指定）指定类型的顶点。

无论哪种方式，实现“Edge”子类型的实用性和正确性/需要似乎都不清楚。许多图形算法发现顶点/节点很有趣并且对它们进行子类型化，但我不太了解导致这些的边的子类型化（或子类型化的实用性）。

最后提示：放弃复杂的命名，KISS。“顶点”和“边缘”将帮助您获得清晰、简单、可理解和正确的设计。在你得到它*之后*保存额外的措辞。

* * *

回应 Nawara 的进一步信息：

然后它是您建模的 EdgeType，当询问“最近的邻居”时，您应该使用 Start Vertex 并返回 Edge（如果您需要距离度量）或 Vertices。

对“Graph”的引用可能应该从 Vertex 参数中隐含。

至于您的 EdgeType 继承层次结构：应定义子类型和继承以遵循行为特征，而不是它们引用的泛型类型（顶点类型）。OO 类层次结构设计的原则是建模*做*，而不是*存在*。

在这方面，您可能有一个 KnnDistanceEdgeType 和 FlickrDistanceEdgeType 类，作为祖先，或者，如果没有其他方法行为需要不同，作为实际的实现类。他们正在搜索的特征类型/类可以设置为属性——具有不同的属性和泛化，以回答不同的顶点类型。

例如。

```
IMAGE_IMAGE_EDGES = new KnnDistanceEdgeType<ImageVertex,ImageVertex>( ImageVertex.class, ImageVertex.class);
TAG_TAG_EDGES = new FlickrDistanceEdgeType<TagVertex,TagVertex>( TagVertex.class, TagVertex.class);
ANY_EDGES = new KnnDistanceEdgeType<Vertex,Vertex>( Vertex.class, Vertex.class); 
```

如果在 EdgeType 中有很多其他行为（我们没有定义任何行为，并且无法想象太多），您可以将 KNN 和 Flickr 距离算法移到单独的类中。大概不需要吧。

请记住：在 OO 中，子类是为了行为，而不是为了存在。给我+1票！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:40:38.550

根据您写的关于“功能”的内容，我会说这适合作为 ImageImageHyperEdge 类中的一个字段。您可以使用将定义它的任何各种成员来创建 FeatureType 类。

```
public class ImageImageHyperedge implements
   HomogenousHyperedge<ImageVertex, Map<String,Instance>> {

   private FeatureType featureType;

   @Override
   public List<ImageVertex> searchNearstNeighborsVertex(Hypergraph hypergraph,
        ImageVertex vertex) {
      return null;
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T19:53:51.013

试试这样的东西？

```
public abstract class BaseFeatureHyperEdge {

    @Override
   public List<ImageVertex> searchNearstNeighborsVertex(Hypergraph hypergraph,
        ImageVertex vertex) {   
      // implement nearest neighbor search algorithm
      // and call getFeatureType where you need it.
      // This will allow you to have the search algorithm only in one place. 
      //But make the search based on the feature type;
   }

   protected FeatureType getFeatureType();
}

public class FeatureOneHyperEdge extends BaseFeatureHyperEdge{

    @Override
    protected FeatureType getFeatureType() {
        return new FeatureTypeOne();
    }
}

public class FeatureTwoHyperEdge extends BaseFeatureHyperEdge{

    @Override
    protected FeatureType getFeatureType() {
        return new FeatureTypeTwo();
    }
} 
```

也许您可以尝试[模板方法模式](http://en.wikipedia.org/wiki/Template_method_pattern)？

# string - 如何访问 TStringGrid 中的字符？

> ID：16068064
> 
> 赞同：-1
> 
> 时间：2013-04-17T19:03:30.370
> 
> 标签：string, delphi, datagrid

如何从 Delphi 中的 TStringGrid 获取字符？

```
StringGrid1.Cells[X, Y, Z]//doesn't work
StringGrid1.Cells[X][Y][Z]//doesn't work 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:11:48.050

您知道这`StringGrid1.Cells[X, Y]`是一个`string`包含带有坐标的单元格中的文本`X, Y`。你也知道 if`S`是 a `string`， then`S[n]`是 的`n`第 th 个字符`S`。结合这些知识，你会意识到

```
StringGrid1.Cells[X, Y][n] 
```

是`n`具有坐标的单元格中的第 th 个字符`X, Y`。但请注意：虽然单元格坐标是基于 0 的，但字符索引是基于 1 的。因此，例如，左上角单元格中的第一个字符是

```
StringGrid1.Cells[0, 0][1] 
```

如果此单元格确实包含至少一个字符的字符串。

# c# - WCF 服务的 JSON 消息格式

> ID：16068080
> 
> 赞同：0
> 
> 时间：2013-04-17T19:04:08.887
> 
> 标签：c#, json, wcf, rest

我有一个 wcf 服务。我需要用它来保存用户并做出回应。这是我的方法：

```
 [OperationContract]
    [WebInvoke(UriTemplate = "SaveUsersCode", Method = "POST", ResponseFormat = WebMessageFormat.Json, RequestFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.Bare)]
    Response SaveUsers(UserCode code); 
```

UserCode 类只有两个字符串属性。我正在使用 Google Postman 进行检查。我已经尝试了一切并且总是得到一个错误“服务器在处理请求时遇到错误”。

发送 JSON 消息的正确格式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:42:45.120

Flipper 我用你的模板写了一个服务器代码

```
[ServiceContract]
public class MyServer
{
    public void Start()
    {
        Task.Factory.StartNew(() =>
        {
            WebServiceHost ws = new WebServiceHost(this.GetType(), new Uri("http://0.0.0.0/Test"));
            ws.Open();
        });
    }

    [OperationContract]
    [WebInvoke(UriTemplate = "SaveUsersCode", Method = "POST", ResponseFormat = WebMessageFormat.Json, RequestFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.Bare)]
    string SaveUsers(UserCode code)
    {
        return "GOT: " + code.companyName + "," + code.imsi;
    }

    public class UserCode
    {
        public string companyName;
        public string imsi;
    }
} 
```

并将其称为

```
//Start server
var m = new MyServer();
m.Start();
Task.Delay(1000);

//Call server method
using (var wc = new WebClient())
{
    wc.Headers[HttpRequestHeader.ContentType] = "application/json";
    var obj = new { companyName = "cocaCola",imsi="3324" };
    string response = wc.UploadString("http://localhost/Test/SaveUsersCode", new JavaScriptSerializer().Serialize(obj));
    Console.WriteLine(response);
} 
```

达达，它的作品

# android - Android：有没有创建类似 Toast 的对话框的好方法？

> ID：16068081
> 
> 赞同：7
> 
> 时间：2013-04-17T19:04:12.920
> 
> 标签：android

我想向用户显示一些信息，但我不希望在用户点击其他地方或按下后退按钮之前关闭信息。我意识到这样做的明显选择是在对话框中显示文本（而不是 toast）。我希望我的对话框类似于系统 Toast。我承认我可以只复制`transient_notification.xml`布局（及其相关资源），但由于 Toast 样式因设备和操作系统而异，因此不太可能产生良好的匹配。

那么，有没有一种好方法来创建一个继承系统 Toast 样式的对话框？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-22T13:21:33.917

或者您可以使用自定义布局

**显示吐司的自定义方法**

```
public static Toast currentToast;
/**
 * Use a custom display for Toasts.
 *
 * @param message
 */
public static void customToast(String message) {
    // Avoid creating a queue of toasts
    if (currentToast != null) {
        // Dismiss the current showing Toast
        currentToast.cancel();
    }       
    //Retrieve the layout Inflater
    LayoutInflater inflater = (LayoutInflater) 
            context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    //Assign the custom layout to view
    View layout = inflater.inflate(R.layout.custom_toast, null);
    //Return the application context
    currentToast = new Toast(context.getApplicationContext());
    //Set toast gravity to center
    currentToast.setGravity(Gravity.CENTER | Gravity.CENTER, 0, 0);
    //Set toast duration
    currentToast.setDuration(Toast.LENGTH_LONG);
    //Set the custom layout to Toast
    currentToast.setView(layout);
    //Get the TextView for the message of the Toast
    TextView text = (TextView) layout.findViewById(R.id.text);
    //Set the custom text for the message of the Toast
    text.setText(message);
    //Display toast
    currentToast.show();
    // Check if the layout is visible - just to be sure
    if (layout != null) {
        // Touch listener for the layout
        // This will listen for any touch event on the screen
        layout.setOnTouchListener(new OnTouchListener() {           
            @Override
            public boolean onTouch(View v, MotionEvent event) {
                // No need to check the event, just dismiss the toast if it is showing
                if (currentToast != null) {
                    currentToast.cancel();
                    // we return True if the listener has consumed the event
                    return true;
                }   
                return false;
            }
        });
    }
} 
```

* * *

和**custom_toast.xml**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:padding="10dip"
    android:background="@drawable/custom_toast_shape">

    <TextView
        android:id="@+id/title" 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textStyle="bold"
        android:textColor="@color/blue"
        android:textSize="16sp"
        android:text="@string/app_name" 
    />

    <View
        android:layout_gravity="center"
        android:layout_width="fill_parent"
        android:layout_height="2dip"
        android:background="@color/blue" 
    />

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="@color/black"
        android:layout_marginTop="5dp"
        android:layout_marginBottom="5dp"
        android:maxEms="15"
        android:gravity="center_horizontal"
        android:id="@+id/text" 
    />
</LinearLayout> 
```

要使用它，只需调用

```
Utils.customToast("Just a test to see if toast is working!\nPerfect"); 
```

**编辑** 我稍微修改了方法。现在它不会创建一个 toast 队列，它会在触摸时被解除，就像普通的 toast 一样。

如果其他人可以改进它，请随时这样做:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:21:03.440

您可能想尝试[Crouton](https://github.com/keyboardsurfer/Crouton)，它是可定制的，并且可以在触摸时关闭。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T19:26:02.087

两个可能的建议。一种可能性是使用 PopupWindow 和自定义 XML。实施起来应该不会太难。另一种选择可能是使用开源项目 Crouton ( [https://github.com/keyboardsurfer/Crouton](https://github.com/keyboardsurfer/Crouton) ) 中的 Toast 替换系统。基本上它提供了一个更美观的用户界面，而且我知道在关闭之前等待用户点击的选项。您可以在 Play 商店中下载他们的演示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T19:32:21.810

您可以使用此小部件（没有撤消按钮），如此处所示。[https://plus.google.com/u/0/+RomanNurik/posts/RA9WEEGWYp6](https://plus.google.com/u/0/+RomanNurik/posts/RA9WEEGWYp6)

# android - 如何自动将事件添加到日历？

> ID：16068082
> 
> 赞同：14
> 
> 时间：2013-04-17T19:04:16.303
> 
> 标签：android, android-intent, android-emulator, calendar, android-calendar

**如何自动将事件添加到日历？**如果我使用这个源代码，它会打开带有填充条目的日历，但我必须单击保存按钮来保存它。

```
public class CalendarApplicationActivity extends Activity
{  

public static final String[] EVENT_PROJECTION = new String[] 
{  
        Calendars._ID, // 0  
        Calendars.ACCOUNT_NAME, // 1  
        Calendars.CALENDAR_DISPLAY_NAME // 2  
};  

private static final int PROJECTION_DISPLAY_NAME_INDEX = 2;  

@Override 
public void onCreate(Bundle savedInstanceState)
{  
    super.onCreate(savedInstanceState);  
    setContentView(R.layout.activity_calendar_application);  
}  

public void onClick(View view) 
{  

    Intent intent = new Intent(Intent.ACTION_INSERT);  
    intent.setType("vnd.android.cursor.item/event");  
    intent.putExtra(Events.TITLE, "Learn Android");  
    intent.putExtra(Events.EVENT_LOCATION, "Home suit home");  
    intent.putExtra(Events.DESCRIPTION, "Download Examples");  

    GregorianCalendar calDate = new GregorianCalendar(2012, 10, 02);  
    intent.putExtra(CalendarContract.EXTRA_EVENT_BEGIN_TIME,  
            calDate.getTimeInMillis());  
    intent.putExtra(CalendarContract.EXTRA_EVENT_END_TIME,  
            calDate.getTimeInMillis());  

    intent.putExtra(CalendarContract.EXTRA_EVENT_ALL_DAY, true);  

    intent.putExtra(Events.ACCESS_LEVEL, Events.ACCESS_PRIVATE);  
    intent.putExtra(Events.AVAILABILITY, Events.AVAILABILITY_BUSY);  

    startActivity(intent);  

}  

} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-17T19:42:26.573

我向您发布了这段代码，该代码用于我在市场上的一个应用程序中。它会自动将事件添加到用户日历。它不使用需要用户操作的 Intent。

```
public void addEvent(CalendarEvent evt) {
    //Log.d(Params.LOG_APP, "Insert event ["+evt+"]");

    try {
        Uri evtUri = ctx.getContentResolver().insert(getCalendarUri("events"), CalendarEvent.toContentValues(evt));
        Log.d(Params.LOG_APP, "" + evtUri);
    }
    catch(Throwable t) {
        //Log.e(Params.LOG_APP, "", t);
    }
}

public void setContext(Context context) {
    this.ctx = context;
    this.baseUri = getCalendarUriBase();
}

private Uri getCalendarUri(String path) {
    return Uri.parse(baseUri + "/" + path);
}

private String getCalendarUriBase() {
    String calendarUriBase = null;
    Uri calendars = Uri.parse("content://calendar/calendars");
    Cursor managedCursor = null;
    try {
        managedCursor = ctx.getContentResolver().query(calendars, null, null, null, null);
    } catch (Exception e) {
       // e.printStackTrace();
    }

    if (managedCursor != null) {
        calendarUriBase = "content://calendar/";
    } else {
        calendars = Uri.parse("content://com.android.calendar/calendars");
        try {
            managedCursor = ctx.getContentResolver().query(calendars, null, null, null, null);
        } catch (Exception e) {
           // e.printStackTrace();
        }

        if (managedCursor != null) {
            calendarUriBase = "content://com.android.calendar/";
        }

    }

    Log.d(Params.LOG_APP, "URI ["+calendarUriBase+"]");
    return calendarUriBase;
} 
```

对于 ICS 及更高版本

```
public void addEvent(CalendarEvent evt) {

    ContentResolver cr = context.getContentResolver();
    Uri uri = cr.insert(Events.CONTENT_URI, CalendarEvent.toICSContentValues(evt));
    System.out.println("Event URI ["+uri+"]");

} 
```

CalendarEvent 就像

```
public static ContentValues toContentValues(CalendarEvent evt) {
    ContentValues cv = new ContentValues();
    cv.put("calendar_id", evt.getIdCalendar());
    cv.put("title", evt.getTitle());
    cv.put("description", evt.getDescr());
    cv.put("eventLocation", evt.getLocation());
    cv.put("dtstart", evt.getStartTime());
    cv.put("dtend", evt.getEndTime());
    cv.put("eventStatus", 1);
    cv.put("visibility", 0);
    cv.put("transparency", 0);

    return cv;

}

public static ContentValues toICSContentValues(CalendarEvent evt) {

    ContentValues cv = new ContentValues();
    cv.put(Events.CALENDAR_ID, evt.getIdCalendar());
    cv.put(Events.TITLE, evt.getTitle());
    cv.put(Events.DESCRIPTION, evt.getDescr());
    cv.put(Events.EVENT_LOCATION, evt.getLocation());
    cv.put(Events.DTSTART, evt.getStartTime());
    cv.put(Events.DTEND, evt.getEndTime());

    Calendar cal = Calendar.getInstance();
    TimeZone tz = cal.getTimeZone();

    cv.put(Events.EVENT_TIMEZONE, tz.getDisplayName());
    /*
    cv.put(Events.STATUS, 1);
    cv.put(Events.VISIBLE, 0);
    cv.put("transparency", 0);

    return cv;
    */

    return cv;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-08T05:23:18.670

我使用以下代码在我自己创建的日历中添加事件

```
public void SyncEvent(long id, int meeting_id, String EventName,
   String Stime, String Etime, String Description) {

 Calendar cal = Calendar.getInstance();
 cal.setTimeZone(TimeZone.getTimeZone("GMT-1"));
 Date dt = null;
 Date dt1 = null;
 try {
  dt = new SimpleDateFormat("yyyy-MM-dd HH:mm").parse(Stime);
  dt1 = new SimpleDateFormat("yyyy-MM-dd HH:mm").parse(Etime);

  Calendar beginTime = Calendar.getInstance();
  cal.setTime(dt);

  // beginTime.set(2013, 7, 25, 7, 30);
  beginTime.set(cal.get(Calendar.YEAR), cal.get(Calendar.MONTH),
  cal.get(Calendar.DATE), cal.get(Calendar.HOUR_OF_DAY),
  cal.get(Calendar.MINUTE));

  Calendar endTime = Calendar.getInstance();
  cal.setTime(dt1);

  // endTime.set(2013, 7, 25, 14, 30);
  // endTime.set(year, month, day, hourOfDay, minute);
  endTime.set(cal.get(Calendar.YEAR), cal.get(Calendar.MONTH),
  cal.get(Calendar.DATE), cal.get(Calendar.HOUR_OF_DAY),
  cal.get(Calendar.MINUTE));

  ContentResolver cr = this.mContext.getContentResolver();
  ContentValues values = new ContentValues();

  values.put(Events.DTSTART, beginTime.getTimeInMillis());
  values.put(Events.DTEND, endTime.getTimeInMillis());
  values.put(Events.TITLE, EventName);
  values.put(Events.DESCRIPTION, Description);
  values.put(Events.CALENDAR_ID, id);
  // values.put(Events._ID, meeting_id);
  values.put(Events.EVENT_TIMEZONE, TimeZone.getDefault().getID());

  Uri uri = cr.insert(Events.CONTENT_URI, values);
  long eventID = Long.parseLong(uri.getLastPathSegment());
 } catch (ParseException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T19:42:14.900

如果您使用 Intents 与日历提供程序进行通信，那么正如您所注意到的，日历应用程序会要求用户确认。这是因为使用 Intents 意味着您不需要请求任何特定权限。

顺便说一句，Google 建议使用 Intents 与日历进行交互。

但是，如果您确实想要自动插入事件，您的应用程序必须`WRITE_CALENDAR`在清单中具有权限。您不使用 Intent，而是使用 ContentResolver。*您可以在添加事件*部分的[https://developer.android.com/guide/topics/providers/calendar-provider.html](https://developer.android.com/guide/topics/providers/calendar-provider.html)中查看示例代码。

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-12T21:14:44.417

此代码添加一个事件，并在日历视图中显示该事件。无需点击“保存”/用户交互。

```
 long calID = 3;
            long startMillis = 0;
            long endMillis = 0;
            Calendar beginTime = Calendar.getInstance();
            beginTime.set(2015, 6, 12, 7, 30);// set(int year, int month, int day, int hourOfDay, int minute)
            startMillis = beginTime.getTimeInMillis();
            Calendar endTime = Calendar.getInstance();
            endTime.set(2015, 6, 12, 8, 30);
            endMillis = endTime.getTimeInMillis();

            TimeZone tz = TimeZone.getDefault();

            ContentResolver cr = getContentResolver();
            ContentValues values = new ContentValues();
            values.put(CalendarContract.Events.DTSTART, startMillis);
            values.put(CalendarContract.Events.DTEND, endMillis);
            values.put(CalendarContract.Events.TITLE, "Jazzercise");
            values.put(CalendarContract.Events.DESCRIPTION, "Group workout");
            values.put(CalendarContract.Events.CALENDAR_ID, calID);
            values.put(CalendarContract.Events.EVENT_TIMEZONE,  tz.getID());
            Uri uri = cr.insert(CalendarContract.Events.CONTENT_URI, values);

            // get the event ID that is the last element in the Uri
            long eventID = Long.parseLong(uri.getLastPathSegment());

            Uri.Builder builder = CalendarContract.CONTENT_URI.buildUpon();
            builder.appendPath("time");
            ContentUris.appendId(builder, startMillis);
            Intent intent = new Intent(Intent.ACTION_VIEW).setData(builder.build());
            startActivity(intent); 
```*

# facebook - OpenGraph 在有效的 og 元标记上抛出错误

> ID：16068083
> 
> 赞同：0
> 
> 时间：2013-04-17T19:04:17.707
> 
> 标签：facebook, post, facebook-javascript-sdk, facebook-opengraph

我在我们的日志中收到此错误，这似乎表明我们已将 og 类型设置为“网站”。

```
Object error: Object code: 3502 message: "(#3502) Object at URL (see link below) has og:type of 'website'. The property 'movie' requires an object of og:type 'video.movie'. "type: "OAuthException" 
```

以下是我们其中一款产品的元标记。如您所见，og 类型仍列为视频。

```
<meta content="217556128271512" property="fb:app_id">
<meta content="17 Again" property="og:title">
<meta content="video.movie" property="og:type"> 
```

根据[该产品的调试器](https://developers.facebook.com/tools/debug/og/object?q=https%3A%2F%2Fsumuru.milyoni.net%2Fstudios%2F1%2Fproducts%2F57-17-again)，og类型正确显示video.movi​​e：

知道这里发生了什么吗？似乎今天才开始，因为我昨天能够发布消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T15:10:06.977

您可以尝试检查您的网络服务器日志是否同时发生错误。不正确的 html 可以根据 OpenGraph 请求返回给 Facebook，这可以被视为“网站”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-31T08:09:51.217

来自 fb 文档：

```
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# video: http://ogp.me/ns/video#">
<meta property="fb:app_id"      content="302184056577324" /> 
<meta property="og:type"        content="video.movie" /> 
<meta property="og:url"         content="Put your own URL to the object here" /> 
<meta property="og:title"       content="Sample Movie" /> 
<meta property="og:image"       content="https://s-static.ak.fbcdn.net/images/devsite/attachment_blank.png" /> 
<meta property="video:actor:id" content="Sample Actor: ID" /> 
```

# ruby-on-rails - 为什么我的应用程序从 SQLite 迁移后无法修改开发 postgresql 数据库？

> ID：16068087
> 
> 赞同：1
> 
> 时间：2013-04-17T19:04:22.907
> 
> 标签：ruby-on-rails, windows, sqlite, migration, rails-postgresql

我将我的开发数据库从 SQLite 切换到了 postgresql。我的应用程序在开发和生产（Heroku、postgresql）中都可以工作，但现在我无法在新的 postgresql 开发数据库中修改、删除或创建记录。用户只能正确登录、查看他们的个人资料信息和注销。

创建用户时出错：

```
ActiveRecord::StatementInvalid in Devise::RegistrationsController#create

Errno::EBADF: Bad file descriptor - rb_thread_select(): INSERT INTO "users" ("field1", "field2", "field3", ...etc continues through..., "Field28") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING "id" 
```

删除用户错误：

```
ActiveRecord::StatementInvalid in Devise::RegistrationsController#destroy

Errno::EBADF: Bad file descriptor - rb_thread_select(): DELETE FROM "users" WHERE "users"."id" = $1 
```

这一切都在生产中正确运行。

我在 Windows 7 上使用 Cygwin 并使用 pgAdmin Windows 包安装 postgresql。

我使用以下方法创建了 4 次不同的新数据库，所有这些方法都产生了与上述相同的结果。

1.  在 pgAdmin 中创建了一个空数据库并使用`rake db:migrate`正确创建了字段，但应用程序无法创建记录。

2.  在 pgAdmin 中创建了一个空数据库，然后使用`db:schema:load`与 #1 相同的结果。

3.  在 pgAdmin 中创建了一个空数据库。用于从我的生产应用程序`pgbackups`创建一个文件，然后用于新的空数据库。一切看起来都不错，字段和记录，但仍然无法修改、删除或创建。只能登录，并查看用户个人资料。`.dump``pgrestore`

4.  按照Railscast [#342 迁移到 PostgreSQL](http://railscasts.com/episodes/342-migrating-to-postgresql)使用所有步骤，包括 Taps Gem，完全按照 4:40 开始的描述。同样，所有字段和记录看起来都不错，但行为与 #3 相同。

我可以通过 pgAdmin GUI 或`psql mydatabase`命令行直接与数据库交互。

数据库.yml

```
development:
  adapter: postgresql
  encoding: unicode
  database: devdatabase
  pool: 5
  username: postgres
  password: 'password'

test:
  adapter: postgresql
  encoding: unicode
  database: testdatabase
  pool: 5
  username: postgress
  password: 'password' 
```

我的 postgresql 日志显示成功连接到数据库：

```
2013-04-18 15:12:09 EDT LOG:  database system was shut down at 2013-04-18 15:03:00 EDT
2013-04-18 15:12:09 EDT LOG:  database system is ready to accept connections
2013-04-18 15:12:09 EDT LOG:  autovacuum launcher started
2013-04-18 15:12:10 EDT LOG:  connection received: host=::1 port=58635
2013-04-18 15:13:14 EDT LOG:  connection received: host=::1 port=58637
2013-04-18 15:13:14 EDT LOG:  connection authorized: user=postgres database=brdevelopment
2013-04-18 15:13:25 EDT LOG:  connection received: host=::1 port=58653
2013-04-18 15:13:25 EDT LOG:  connection authorized: user=postgres database=brdevelopment
2013-04-18 15:18:32 EDT LOG:  received fast shutdown request
2013-04-18 15:18:32 EDT LOG:  aborting any active transactions
2013-04-18 15:18:32 EDT LOG:  autovacuum launcher shutting down
2013-04-18 15:18:32 EDT LOG:  shutting down
2013-04-18 15:18:32 EDT LOG:  database system is shut down 
```

我的应用程序日志显示成功的用户登录、注销和查看配置文件的请求。它还显示了用户如何通过单击确认电子邮件中的链接成功更改密码。当用户尝试更改其个人资料、删除其帐户或新用户尝试注册时，它还会显示错误。错误：

```
 Rendered /home/Pavilion/.rvm/gems/ruby-1.9.3-p374/gems/actionpack-3.2.11/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.0ms)
  Rendered /home/Pavilion/.rvm/gems/ruby-1.9.3-p374/gems/actionpack-3.2.11/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (2.0ms)
  Rendered /home/Pavilion/.rvm/gems/ruby-1.9.3-p374/gems/actionpack-3.2.11/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (42.0ms)
Connecting to database specified by database.yml
Connecting to database specified by database.yml

...

Started DELETE "/users" for 127.0.0.1 at 2013-04-18 15:14:20 -0400
Processing by Devise::RegistrationsController#destroy as HTML
  Parameters: {"authenticity_token"=>"xxxxx="}
  [1m[35mUser Load (0.0ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 57 LIMIT 1
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "users" WHERE "users"."id" = $1  [["id", 57]]
Errno::EBADF: Bad file descriptor - rb_thread_select(): DELETE FROM "users" WHERE "users"."id" = $1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
Completed 500 Internal Server Error in 5ms

ActiveRecord::StatementInvalid (Errno::EBADF: Bad file descriptor - rb_thread_select(): DELETE FROM "users" WHERE "users"."id" = $1):
  activerecord (3.2.11) lib/active_record/connection_adapters/postgresql_adapter.rb:1165:in `block'
  activerecord (3.2.11) lib/active_record/connection_adapters/postgresql_adapter.rb:1165:in `exec_cache'
  activerecord (3.2.11) lib/active_record/connection_adapters/postgresql_adapter.rb:674:in `block in exec_delete'
  activerecord (3.2.11) lib/active_record/connection_adapters/abstract_adapter.rb:280:in `block in log'
  activesupport (3.2.11) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activerecord (3.2.11) lib/active_record/connection_adapters/abstract_adapter.rb:275:in `log'
  activerecord (3.2.11) lib/active_record/connection_adapters/postgresql_adapter.rb:672:in `exec_delete'
  activerecord (3.2.11) lib/active_record/connection_adapters/abstract/database_statements.rb:101:in `delete'
  activerecord (3.2.11) lib/active_record/connection_adapters/abstract/query_cache.rb:14:in `delete'
  activerecord (3.2.11) lib/active_record/relation.rb:413:in `delete_all'
  activerecord (3.2.11) lib/active_record/persistence.rb:141:in `destroy'
  activerecord (3.2.11) lib/active_record/locking/optimistic.rb:103:in `destroy'
  activerecord (3.2.11) lib/active_record/callbacks.rb:254:in `block in destroy'
  activesupport (3.2.11) lib/active_support/callbacks.rb:403:in `_run__747758159__destroy__128269692__callbacks'
  activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
  activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_destroy_callbacks'
  activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
  activerecord (3.2.11) lib/active_record/callbacks.rb:254:in `destroy'
  activerecord (3.2.11) lib/active_record/transactions.rb:254:in `block in destroy'
  activerecord (3.2.11) lib/active_record/transactions.rb:313:in `block in with_transaction_returning_status'
  activerecord (3.2.11) lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
  activerecord (3.2.11) lib/active_record/transactions.rb:208:in `transaction'
  activerecord (3.2.11) lib/active_record/transactions.rb:311:in `with_transaction_returning_status'
  activerecord (3.2.11) lib/active_record/transactions.rb:254:in `destroy'
  devise (2.2.3) app/controllers/devise/registrations_controller.rb:59:in `destroy'
  actionpack (3.2.11) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (3.2.11) lib/abstract_controller/base.rb:167:in `process_action'
  actionpack (3.2.11) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (3.2.11) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
  activesupport (3.2.11) lib/active_support/callbacks.rb:436:in `_run__389569436__process_action__28646103__callbacks'
  activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
  activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
  activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
  actionpack (3.2.11) lib/abstract_controller/callbacks.rb:17:in `process_action'
  actionpack (3.2.11) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
  activesupport (3.2.11) lib/active_support/notifications.rb:123:in `block in instrument'
  activesupport (3.2.11) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (3.2.11) lib/active_support/notifications.rb:123:in `instrument'
  actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
  actionpack (3.2.11) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
  activerecord (3.2.11) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (3.2.11) lib/abstract_controller/base.rb:121:in `process'
  actionpack (3.2.11) lib/abstract_controller/rendering.rb:45:in `process'
  actionpack (3.2.11) lib/action_controller/metal.rb:203:in `dispatch'
  actionpack (3.2.11) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
  actionpack (3.2.11) lib/action_controller/metal.rb:246:in `block in action'
  actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `call'
  actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
  actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:36:in `call'
  actionpack (3.2.11) lib/action_dispatch/routing/mapper.rb:42:in `call'
  journey (1.0.4) lib/journey/router.rb:68:in `block in call'
  journey (1.0.4) lib/journey/router.rb:56:in `each'
  journey (1.0.4) lib/journey/router.rb:56:in `call'
  actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:601:in `call'
  omniauth (1.1.3) lib/omniauth/strategy.rb:177:in `call!'
  omniauth (1.1.3) lib/omniauth/strategy.rb:157:in `call'
  meta_request (0.2.3) lib/meta_request/middlewares/app_request_handler.rb:11:in `call'
  rack-contrib (1.1.0) lib/rack/contrib/response_headers.rb:17:in `call'
  meta_request (0.2.3) lib/meta_request/middlewares/headers.rb:16:in `call'
  meta_request (0.2.3) lib/meta_request/middlewares/meta_request_handler.rb:13:in `call'
  warden (1.2.1) lib/warden/manager.rb:35:in `block in call'
  warden (1.2.1) lib/warden/manager.rb:34:in `catch'
  warden (1.2.1) lib/warden/manager.rb:34:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
  rack (1.4.5) lib/rack/etag.rb:23:in `call'
  rack (1.4.5) lib/rack/conditionalget.rb:35:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/head.rb:14:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/flash.rb:242:in `call'
  rack (1.4.5) lib/rack/session/abstract/id.rb:210:in `context'
  rack (1.4.5) lib/rack/session/abstract/id.rb:205:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/cookies.rb:341:in `call'
  activerecord (3.2.11) lib/active_record/query_cache.rb:64:in `call'
  activerecord (3.2.11) lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
  activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `_run__111743413__call__128269692__callbacks'
  activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
  activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
  activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
  actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/reloader.rb:65:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
  railties (3.2.11) lib/rails/rack/logger.rb:32:in `call_app'
  railties (3.2.11) lib/rails/rack/logger.rb:16:in `block in call'
  activesupport (3.2.11) lib/active_support/tagged_logging.rb:22:in `tagged'
  railties (3.2.11) lib/rails/rack/logger.rb:16:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/request_id.rb:22:in `call'
  rack (1.4.5) lib/rack/methodoverride.rb:21:in `call'
  rack (1.4.5) lib/rack/runtime.rb:17:in `call'
  activesupport (3.2.11) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
  rack (1.4.5) lib/rack/lock.rb:15:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/static.rb:62:in `call'
  railties (3.2.11) lib/rails/engine.rb:479:in `call'
  railties (3.2.11) lib/rails/application.rb:223:in `call'
  rack (1.4.5) lib/rack/content_length.rb:14:in `call'
  railties (3.2.11) lib/rails/rack/log_tailer.rb:17:in `call'
  rack (1.4.5) lib/rack/handler/webrick.rb:59:in `service'
  /home/Pavilion/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
  /home/Pavilion/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
  /home/Pavilion/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'

...

Started POST "/users" for 127.0.0.1 at 2013-04-18 15:15:23 -0400
Processing by Devise::RegistrationsController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"xxxxx=", "user"=>{"email"=>"me@example.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}, "commit"=>"Sign up"}
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mUser Exists (0.0ms)[0m  SELECT 1 AS one FROM "users" WHERE "users"."email" = 'me@example.com' LIMIT 1
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."confirmation_token" = 'xxxxx' LIMIT 1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "users" ("confirmation_sent_at", "confirmation_token", "confirmed_at", "created_at", "current_sign_in_at", "current_sign_in_ip", "description", "email", "encrypted_password", "first_name", "headline", "image", "industry", "last_name", "last_sign_in_at", "last_sign_in_ip", "location", "name", "nickname", "provider", "public_profile", "remember_created_at", "reset_password_sent_at", "reset_password_token", "sign_in_count", "uid", "unconfirmed_email", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING "id"  [["confirmation_sent_at", Thu, 18 Apr 2013 19:15:23 UTC +00:00], ["confirmation_token", "xxxxx"], ["confirmed_at", nil], ["created_at", Thu, 18 Apr 2013 19:15:23 UTC +00:00], ["current_sign_in_at", nil], ["current_sign_in_ip", nil], ["description", nil], ["email", "me@example.com"], ["encrypted_password", "xxxxx"], ["first_name", nil], ["headline", nil], ["image", nil], ["industry", nil], ["last_name", nil], ["last_sign_in_at", nil], ["last_sign_in_ip", nil], ["location", nil], ["name", nil], ["nickname", nil], ["provider", nil], ["public_profile", nil], ["remember_created_at", nil], ["reset_password_sent_at", nil], ["reset_password_token", nil], ["sign_in_count", 0], ["uid", nil], ["unconfirmed_email", nil], ["updated_at", Thu, 18 Apr 2013 19:15:23 UTC +00:00]]
Errno::EBADF: Bad file descriptor - rb_thread_select(): INSERT INTO "users" ("confirmation_sent_at", "confirmation_token", "confirmed_at", "created_at", "current_sign_in_at", "current_sign_in_ip", "description", "email", "encrypted_password", "first_name", "headline", "image", "industry", "last_name", "last_sign_in_at", "last_sign_in_ip", "location", "name", "nickname", "provider", "public_profile", "remember_created_at", "reset_password_sent_at", "reset_password_token", "sign_in_count", "uid", "unconfirmed_email", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING "id"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
Completed 500 Internal Server Error in 469ms

ActiveRecord::StatementInvalid (Errno::EBADF: Bad file descriptor - rb_thread_select(): INSERT INTO "users" ("confirmation_sent_at", "confirmation_token", "confirmed_at", "created_at", "current_sign_in_at", "current_sign_in_ip", "description", "email", "encrypted_password", "first_name", "headline", "image", "industry", "last_name", "last_sign_in_at", "last_sign_in_ip", "location", "name", "nickname", "provider", "public_profile", "remember_created_at", "reset_password_sent_at", "reset_password_token", "sign_in_count", "uid", "unconfirmed_email", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING "id"):

...

Started DELETE "/users" for 127.0.0.1 at 2013-04-18 15:17:25 -0400
Processing by Devise::RegistrationsController#destroy as HTML
  Parameters: {"authenticity_token"=>"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx="}
  [1m[35mUser Load (1.0ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 57 LIMIT 1
  [1m[36m (3.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "users" WHERE "users"."id" = $1  [["id", 57]]
Errno::EBADF: Bad file descriptor - rb_thread_select(): DELETE FROM "users" WHERE "users"."id" = $1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
Completed 500 Internal Server Error in 7ms

ActiveRecord::StatementInvalid (Errno::EBADF: Bad file descriptor - rb_thread_select(): DELETE FROM "users" WHERE "users"."id" = $1): 
```

为什么我不能从我新创建的开发数据库中获得全部功能，而一切都在生产中正常工作？我从我的研究中了解到，在开发和生产中拥有相同的数据库非常重要。

我是新手，正在学习 ruby​​、rails、数据库和 postgresql。stackoverflow 非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:00:01.613

> 我可以通过 pgAdmin GUI 或 psql > mydatabase 命令行直接与数据库交互。

那么为什么要继续摆弄数据库呢？那不是导致您出现问题的部分。

这个：

> EBADF：错误的文件描述符

表明连接有问题，甚至可能是数据库连接库本身的问题。

在 PostgreSQL 中打开连接日志记录。在您的应用程序中打开登录。在进一步查看之前，请确保您可以连接。

# ios - 提取由 ask_log 写入的 ASL 日志条目

> ID：16068095
> 
> 赞同：2
> 
> 时间：2013-04-17T19:04:48.363
> 
> 标签：ios, logging

我正在使用带有 DDASLLogger 的 CocoaLumberjack 来获取 ASL 的日志条目，并且我想要一个日志，其中包含来自 3:rd 方的 misc NSLog:ed 输出和我自己的日志以及同一日志中的日志。

为了获得更好的画面，我提取了对 ASL 的调用并做了一个例子。我遇到的问题是，这种 ASL 提取方法只能找到**使用 NSLog 编写的**条目，而不是使用**asl_log**编写的条目。

以下是管理器控制台中的示例：

```
Apr 17 20:34:48 Claes-Ls-iPhone-4s ASLLogTest[7253] <Warning>: NSLog 7
Apr 17 20:34:51 Claes-Ls-iPhone-4s ASLLogTest[7253] <Critical>: ASLLog 7 
```

提取这个时，我只得到 NSLog 行。

这是使用的代码：

**写给 ASL：**

```
NSDictionary *infoDictionary = [NSBundle mainBundle].infoDictionary;
NSString *productName = [infoDictionary objectForKey:@"CFBundleDisplayName"];
_client = asl_open(productName.UTF8String, "com.apple.console", 0);
int status = asl_log(_client, NULL, ASL_LEVEL_CRIT, "%s", string.UTF8String); 
```

**从 ASL 读取（不提供完整的 iterate-through-asl，但它有效）：**

```
// Using ASL_QUERY_OP_TRUE to be dead-sure.
q = asl_new(ASL_TYPE_QUERY);
asl_set_query(q, ASL_KEY_SENDER, productName.UTF8String, ASL_QUERY_OP_TRUE);
aslresponse r = asl_search(NULL, q); 
```

我错过了什么，是否无法写入 ASL 然后以这种方式阅读？

谢谢， 克拉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-12T18:17:36.670

[如果您使用的是 Swift，那么有一个名为CleanroomASL](https://github.com/emaloney/CleanroomASL)的新开源项目，它提供了一个类型安全的 API，用于读取和写入 Apple 系统日志条目。

查询给定的日志`.Sender`（假设`productName`是 a`String`或`NSString`）：

```
let client = ASLClient()
let query = ASLQueryObject()
query.setQueryKey(.Sender, value: productName, operation: .EqualTo, modifiers: .None)

client.search(query) { record in
    if let record = record {
        // we've gotten a log entry for the search.
        // 'record' is of type ASLQueryObject.ResultRecord
    }
    else {
        // there are no more log entries to process
    }
    // return true while we still want to get results
    // or return false when we don't want to process more
    return true
} 
```

**注意：**在 iOS 设备上，ASL*只会*返回您的进程创建的日志条目。此外，日志会被相当积极地修剪，并且可能只包含当前运行应用程序的条目。[此处解释](https://github.com/emaloney/CleanroomASL/#differences-between-the-device-and-simulator)了 Mac/iOS 模拟器和 iOS 设备上的 ASL 行为之间的进一步差异。

# apache - 你能从 .htaccess 文件中加载一个 apache 模块吗？

> ID：16068097
> 
> 赞同：5
> 
> 时间：2013-04-17T19:04:49.257
> 
> 标签：apache

比如，我可以修改 .htaccess 文件来加载 apache 模块吗？具体来说，“ExpiresActive On”会加载 mod_expires 模块吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T19:16:32.583

该[`LoadModule`](http://httpd.apache.org/docs/2.2/mod/mod_so.html#loadmodule)指令只能在服务器配置中使用。不是 vhost 配置，也不是在 htaccess 文件中。

> 具体来说，“ExpiresActive On”会加载 mod_expires 模块吗？

不，如果您尝试使用未加载的模块，您将收到 500 内部服务器错误。

# jquery-mobile - 使用 Play 框架的 JQuery 移动表单助手

> ID：16068104
> 
> 赞同：0
> 
> 时间：2013-04-17T19:05:02.280
> 
> 标签：jquery-mobile, playframework-2.0, play-authenticate

我正在尝试[将此](https://github.com/joscha/play-authenticate/tree/2.0.x/samples/java/play-authenticate-usage/app)播放身份验证模块与我的应用程序的移动端集成。我想为每个页面使用 JQuery mobile 而不是 Twitter Bootstrap。所以我创建了一个单独的视图，我刚刚设置了一个基本索引，我试图让登录页面首先工作。登录页面以表单为参数，我只是想知道是否有办法在 JQuery Mobile 中使用 scala 表单助手在 play 2.0.* 中。

到目前为止我的基本登录页面：

```
@(loginForm: Form[_])

@import helper._

@main(Messages("playauthenticate.login.title"),"login") {
            <div data-role="content">
                <div data-role="fieldcontain">
                    <label for="textinput1">
                        Your Email
                    </label>
                    <input name="" id="textinput1" placeholder="" value="" type="email" />
                </div>
                <div data-role="fieldcontain">
                    <label for="textinput2">
                        Your Password
                    </label>
                    <input name="" id="textinput2" placeholder="" value="" type="password" />
                </div>
                <a data-role="button" href="#page1">
                    Login Now
                </a>
                <h4>
                    Or login with a different service:
                </h4>
                      @* Display list of available providers *@
                      @_providerPartial(skipCurrent=false)
                <a data-role="button" data-transition="slidedown" href="routes.Application.index()">
                    Home
                </a>
            </div>
} 
```

[这](https://github.com/joscha/play-authenticate/blob/2.0.x/samples/java/play-authenticate-usage/app/views/login.scala.html)就是使用 Twitter Bootstrap 的样子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:29:24.497

Yes and... no.

As you showed us jQueryMobile has its specific markup for form, so built-in `helpers` of Play doesn't fit it in any way...

You have two solutions and choice between this you want to use belongs to you:

*   If you have just few forms, write them with common HTML according to [JQM's specification](http://view.jquerymobile.com/1.3.1/dist/demos/widgets/forms/).
*   Otherwise, if you plan to use lot of forms in many places you'll do better if you'll... write own [`field constructors`](http://www.playframework.com/documentation/2.1.1/JavaFormHelpers).

Of course if you'll decide to go with second approach it will be great if you'll decide to share it with others :)

# c# - 将带有 WSDL 的 PEAR SOAP 连接到 C# 独立 .exe

> ID：16068110
> 
> 赞同：1
> 
> 时间：2013-04-17T19:05:23.677
> 
> 标签：c#, php, soap, wsdl, pear

我正在尝试创建一个 Web 服务，其中从网页中选择的参数被发送到一个用 C# 编写的standalone.exe，它控制安装在服务器上的 CAD 包。CAD 软件包然后根据用户在前端网页上选择的参数生成图像。简而言之，我需要：

1.  用户选择两个部分
2.  选定的部分被发送到 C# .exe
3.  C# 运行 CAD 包，连接零件，返回两个零件的图像
4.  用户看到图像

据我了解，我需要带有可见 WSDL 的 SOAP 实现。我通过教程运行并创建自己的 SOAP 和 WSDL 以及在我自己的 PHP 函数之间的本地和远程服务器上进行通信都没有问题。

现在我试图让一个 PHP 编写的 SOAP 被 C# 独立使用，这就是我迷路的地方。我对 SOAP 和 WSDL 比较陌生，但我了解它们的基础知识和功能。此外，我开始将 NUSOAP 用于我的 wsdl 生成。

是否有类似的代码包允许从允许 SOAP 连接的 c# 方法创建 WSDL 文件？

此外，我的客户端和网页将始终知道要发送的 WSDL 和所需参数。本质上，这只是 Web 和 CAD 包之间的网关。

这是 Wheezly McDizzle

```
<?xml version="1.0" encoding="UTF-8"?>
<definitions
    xmlns:typens="urn:getBlockedIP"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
    xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/"
    xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
    xmlns="http://schemas.xmlsoap.org/wsdl/"
    name="getBlockedIP"
    targetNamespace="urn:getBlockedIP">

  <types></types>

  <message name="getBlockedIP">
    <part name="idNumber" type="xsd:string"/>
  </message>

  <message name="getBlockedIPResponse">
    <part name="ipAddress" type="xsd:string"/>
  </message>

  <portType name="blockedIPPort">
    <operation name="getBlockedIP">
      <input message="typens:getBlockedIP" />
      <output message="typens:getBlockedIPResponse"/>
    </operation>
  </portType>

  <binding name="blockedIPBinding" type="typens:blockedIPPort">
    <soap:binding style="rpc" transport="http://schemas.xmlsoap.org/soap/http"/>
    <operation name = "getBlockedIP" >
      <soap:operation soapAction = "urn:blockedIPAction" />
      <input>
        <soap:body namespace="urn:getBlockedIP" use="encoded" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body namespace="urn:getBlockedIP" use="encoded" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
  </binding>

  <service name="getBlockedIPService">
    <port name="blockedIPPort" binding="blockedIPBinding">
      <soap:address location="http://mysite.com/xdata/blockedip_api.php"/>
    </port>
  </service> 
</definitions> 
```

正在测试的方法是使用单个参数的简单数组获取。它只是一个包含 25 个元素的数组，其中包含被阻止的 IP，用户在 1-25 之间选择一个数字，该方法会在数组中吐出与该位置相关的 IP。

我将 C# 中的方法模仿为命令提示符程序，使用`Console.WriteLine`和`Console.ReadLine()`. （这显然是不正确的，因为 C# 程序必须从 XML 文件中获取参数，而不是任何用户输入）

所以现在我被困住了——我的脑子里全是 WhizCheese Dulls 和 SOAP 和 XML。我对从这里去哪里感到困惑。我是前端和后端 Web 开发的专家，但在谈到 .NET 框架时仍然耳聋。

从本质上讲，我希望有人为我指明正确的方向，最终实现我在这个项目中的第一个既定目标。我做事的方式甚至可能吗？也许 SOAP 不是正确的路径？我也很困惑如何将参数发送到独立的 c# .exe 并让它使用它（如汉堡包...mmmmmmm）。

这是我在远程服务器上用 PHP 进行的肥皂实例化：

**客户：**

```
// WSDL location to be used with a WSDL instantiation of SOAP
$namespace = 'http://mysite.com/xdata/blockedip.wsdl';

// Parameters are easier sent as an array with associative keys
$params = array('arrayNum' => $number);

// include soap client (php.ini include_path set to installed PEAR location)
require_once 'SOAP/Client.php';

// create SOAP Client with an exposed WSDL location
$wsdl = new SOAP_WSDL($namespace);

//communicate with server, WSDL
$SoapClient = $wsdl->getProxy();

//call method with parameters
$ip = $SoapClient->call("getBlockedIP", $params); 
```

**服务器：**

```
// include soap server and create server object
require_once 'SOAP/Server.php';
$soapServer = new SOAP_Server();
$server->_auto_translation = true;

// create class with desired method
$blockedip = new SoapTestClass();

// add class and namespace schema
$soapServer->addObjectMap($blockedip, 'http://schemas.xmlsoap.org/soap/envelope/');

// respond with raw post
$soapServer->service($GLOBALS['HTTP_RAW_POST_DATA']); 
```

如果你还需要什么，我很乐意分享。感谢您抽出宝贵时间阅读本文并为您提供任何帮助！我非常感谢。

**更新**：

从我一直在阅读的内容来看，也许我必须打开元数据，但我不知道在哪里可以做到这一点？

**更新**：

我一直在使用 NUSOAP 从 php 方法生成我的 WSDL 文件并将它们连接到 VISUAL STUDIO 2010 C# 并且它们一直在工作。我现在坚持扭转这个过程。我需要 php 将参数发送到 C# 方法并让 .exe 返回一些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T20:02:54.300

由于您似乎正在尝试生成代理 - 您需要启用元数据发现，因此客户端程序知道如何构造调用（参数、方法、返回值）。您使用的是 Apache、IIS 还是其他？

[什么是元数据交换](http://en.wikipedia.org/wiki/WS-MetadataExchange "元数据交换") [通过 IIS](http://social.technet.microsoft.com/wiki/contents/articles/exposing-a-metadata-exchange-mex-endpoint-over-tcp-with-an-iis-hosted-wcf-service.aspx) [公开元数据 通过 Apache 公开元数据](http://tomcat.apache.org/migration-7.html)

我更新了链接以启用 Apache 和 IIS 的元数据——那里可能有更好的说明——我只涉足 Apache。

SOAP 没有任何“错误”，它只是基于 http 协议的 xml，它可以是一种合同优先的（想想 Web 的 IDL）方法，定义功能/服务的 IDL 是 Web 的。php 中似乎有很多可用的工具来促进这一点。NuSoap 就是这样一个更易于管理的库——Scot Nichol 深入研究了它的设置。[NuSoapIntro](http://www.scottnichol.com/nusoapintro.htm)也是一个以此为模型的代码示例——简单的 PHP 示例[CodeProject](http://www.vankouteren.eu/blog/2009/03/simple-php-soap-example/)从技术上讲，如果你有正确的方法的 xml 输入格式——你可以只是 HTTP POST 预期的输入（由 WSDL 定义）并且它“正常工作”。我发现 SOAPUI 是一个不可或缺的测试工具（无论如何我都没有加入）。

如果 SOAP 太让人心痛，您可以考虑采用 RESTful 方法[REST Frameworks Php](http://blog.programmableweb.com/2011/09/23/short-list-of-restful-api-frameworks-for-php/)它将更多地为您的外部接口使用基于 URL 的方法签名，并且可能更容易实现您的目标。

（啊 - WAMP over LAMP）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T22:56:51.183

尚不完全清楚您的问题是什么，但听起来您正试图让您的 c# 应用程序提供 wsdl。然后 php 可以使用暴露的合约。

.NET 库的 WCF（窗口通信框架）部分支持这一点。特别是 SessionHost 类将提供一个可以承载 SOAP 服务并公开 WSDL 的服务器。

首先，您需要在 c# 中定义您的合同。您可以通过创建具有 DataContract 属性的接口来做到这一点。

定义合约的示例接口。

```
[ServiceContract]
public interface MyContract
{
    [OperationContract]
    void MyOperation(string param1, int param2);

    [OperationContract]
    void MyOtherOperation(int param1, out int outputParam);
} 
```

然后，您可以创建一个服务主机，该主机将创建一个 SOAP 服务器并将传入请求绑定到实现您的接口的类。它还将为您公开 WSDL 文件。

设置主机。

```
// create service host
// Note: ServiceHandler is a class you make that implements your service contract interfaces
ServiceHost host = host = new ServiceHost(typeof(ServiceHandler), new URI("127.0.0.1");

// enable metadata exchange (creates wsdl URL)
ServiceMetadataBehavior smb = new ServiceMetadataBehavior();
smb.HttpGetEnabled = true;
host.Description.Behaviors.Add(smb);

// start the host listening
host.Open() 
```

希望这有助于您入门。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T02:57:47.453

我正在研究一个类似的问题。我经历了各种排列，得出的结论是 WDSL/XML 不是最好的解决方案。

这是我想出的：AJAX。将网页请求推送到独立的 C# 代码。然后它会推出必要的图形（最好是 PNG 或 JPEG 格式）。反过来，它会被放入一个 HTML 元素中进行显示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-03T23:59:44.777

我使用了一个连接到 MySQL 的 C# 程序，并让它定期检查表中的新条目。

# javascript - 静态成员继承的解决方法

> ID：16068112
> 
> 赞同：0
> 
> 时间：2013-04-17T19:05:36.223
> 
> 标签：javascript, inheritance, static

我实际上正在从事一个项目，在该项目中我需要一堆对象（如果您愿意，可以使用类，而不是实例）来实现相同的行为。基本上，每个“类”都需要提供一种操作包含它的每个实例的数组的方法。

编码这样的事情让我很困扰：

```
function A() { ... }
A.instances = [];
A.someStaticMethod = function () {
    for (var i = 0 ; i < A.instances ; i++) {
        A.instances[i].doSomething();
    }
}
A.prototype.doSomething = function () { ... }

function B() { ... }
B.instances = [];
B.someStaticMethod = function () {
    for (var i = 0 ; i < B.instances ; i++) {
        B.instances[i].doSomething();
    }
}
B.prototype.doSomething = function () { ... } 
```

我只是不喜欢有某种复制/粘贴的代码。来自类语言，我自然认为我所要做的就是创建第三个类，该类将实现那些静态成员/方法并让我的其他类继承它。我几乎不知道，你不能继承静态成员。

我愿意学习javascript是如何工作的，所以我想知道是否有任何方法可以获得想要的行为而不必每次都复制代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:12:34.370

您可以尝试使用一个函数来使用某种*mixin*函数来增强您的对象。

```
function enhanceStatic(type) {
    type.instances = [];
    type.someStaticMethod = function () {
        for (var i = 0; i < type.instances.length; i++) {
            type.instances[i].doSomething();
        }
    };
}

function A(msg) {
    this.msg = msg;
}
enhanceStatic(A);
A.prototype.doSomething = function () {
    console.log("A: " + +this.msg);
}

function B(msg) {
    this.msg = msg;
}
enhanceStatic(B);
B.prototype.doSomething = function () {
    console.log("B: " + +this.msg);
}

A.instances = [new A(1), new A(2)];
B.instances = [new B(1), new B(2), new B(3)];
A.someStaticMethod();
B.someStaticMethod(); 
```

输出：

```
A: 1
A: 2
B: 1
B: 2
B: 3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:18:31.623

有多种方法可以在 javascript 中实现类行为。值得一提的框架是 ExtJs（也是原型），它具有清晰简单的语法并支持静态方法。巨大的代码库和许可证（GPL，商业）使我无法使用相同的代码编写小型预算项目，这让我很恼火，我编写了一个基于 MIT 许可证的类管理器，称为 Esf-Core，用于核心类加载器功能（[https： //npmjs.org/package/esf-core](https://npmjs.org/package/esf-core) )，类似于 ExtJS 编码风格。这是一个如何使用它的示例：

```
Esf.define('A', {
    a: null,

    constructor: function (a) {
        // Save var
        this.a = a;

        // Heyho
        console.log('A');
    },
    foo: function (b) {
        console.log('foo - ' + b);
    }
});

Esf.define('B', {
    b: null,

    constructor: function (a, b) {
        // Call super constructor
        this.callParent(a);

        // Save var
        this.b = b;

        // Heyho
        console.log('B');
    },
    foo: function () {
        this.callParent('bar');
    }
}, {
    extend: 'A'
});

// Use
var b = new B(1, 2);

// or
var b = Esf.create('B', 1, 2);

/*
 * Output:
 * A
 * B
 * foo - bar
 */
b.foo(); 
```

静态方法尚未实现，但会在不久的将来实现（如果您愿意，您可以自己实现，它只是一段代码），并且还有一个用于动态加载依赖项的类加载器。仍在进行中的主框架还将带来基于主干的依赖注入和模型存储等。

如果您在此处看到，还有多种其他方式可以以更轻量级的方式执行此操作：[javascript 继承框架](https://stackoverflow.com/questions/9408065/javascript-inheritance-framework/13940803)（线程结束）

这是静态方法的 ExtJS 方式：

```
Ext.define('Computer', {
     statics: {
         factory: function() {
             // This refers to the class not the object in static context
             return this.factory;
         }
     },

     factory: 'Unknown',
});

Ext.define('PC', {
     extends: 'Computer',

     factory: 'Dell',
});

// Dell
console.log(PC.factory()); 
```

代码应该可以工作，但我没有尝试:-)

# php - 使用作为数组键提取的列之一的数组 - 收到错误消息“unexpected T_DOUBLE_ARROW”

> ID：16068115
> 
> 赞同：0
> 
> 时间：2013-04-17T19:05:42.813
> 
> 标签：php, arrays, key

我正在尝试使用作为数组键提取的列之一创建一个数组，但我收到了错误消息`unexpected T_DOUBLE_ARROW`

```
$students = array();
foreach ($rows as $row) { 
    $students[$row['first_name']] => $row['last_name'];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:11:05.423

`=>`应该替换为`=`

```
$students[$row['first_name']] = $row['last_name']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:57:23.733

```
$students = array();
foreach ($rows as $row) { 
    $students=array($row['first_name'] => $row['last_name']);
} 
```

# python - 用 pytables 构造巨大的 numpy 数组

> ID：16068118
> 
> 赞同：2
> 
> 时间：2013-04-17T19:05:48.870
> 
> 标签：python, numpy, machine-learning, data-mining, pytables

我从大量数据中为示例生成特征向量，并且我想在读取数据时增量存储它们。特征向量是 numpy 数组。我事先不知道 numpy 数组的数量，我想以增量方式存储/检索它们。

查看 pytables，我发现了两个选项：

1.  **数组**：它们需要预定的大小，我不太确定附加多少在计算上是有效的。
2.  **表**：列类型不支持列表或数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T17:28:01.453

如果它是一个普通的 numpy 数组，您可能应该使用可扩展数组 (EArray) [http://pytables.github.io/usersguide/libref/homogenous_storage.html#the-earray-class](http://pytables.github.io/usersguide/libref/homogenous_storage.html#the-earray-class)

如果你有一个 numpy 结构化数组，你应该使用一个表。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-04-17T19:13:02.727

你不能把它们存储到一个数组中吗？你有你的代码，它应该是一个循环，它将从数据中获取内容以生成你的示例，然后生成示例。在循环外创建一个数组并将您的向量附加到数组中进行存储！

```
array = []
for row in file:
    #here is your code that creates the vector
    array.append(vector) 
```

然后在你浏览完整个文件之后，你就有了一个包含所有生成向量的数组！希望这就是你所需要的，你有点不清楚......下次请提供一些代码。

哦，你确实说过你想要 pytables，但我认为没有必要，特别是因为你提到的限制

# java - 从servlet发送数据到jsp并动态生成下拉列表

> ID：16068123
> 
> 赞同：0
> 
> 时间：2013-04-17T19:06:15.520
> 
> 标签：java, jsp, jakarta-ee, servlets

在一个 servlet 中，我有一个包含数据的列表。我将该列表放在一个方法`doget()`中，以便在 onPage Load 事件中访问它。

```
List<Integer> list = pse.populateemployee();
request.setAttribute("list", list); 
```

我想使用 JSTL 将该列表发送到我的 JSP 页面。

我试过这个：

```
<select name="selectemployee">
 <c:forEach var="employees" items="${list}">
     <option> <c:out value="${employees}"/> </option>
 </c:forEach>
</select> 
```

我正在使用 MVC

为什么这不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-27T14:07:00.170

您需要添加链接..例如您在`jsp`页面中，如果您想从`jsp`到`servlet`，您需要提供路径..（`./servlet name`在jsp页面中）

```
<form action="./servlet name" method=post>
<\form> 
```

您还应该关闭`form`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:15:01.140

我解决了这个问题

我正在运行 servlet 的 jsp 页面，这就是为什么 jsp 页面在加载时没有从 servlet 获取数据

现在告诉我如何在 XML 文件中映射我的 servlet 以首先运行 servlet 而不是 jsp

# mysql - MySQL - 从另一个表中选择多个值时在关系表上计数（*）？

> ID：16068124
> 
> 赞同：0
> 
> 时间：2013-04-17T19:06:17.777
> 
> 标签：mysql, relational-database

我有两张桌子，T1 和 T2。

T1 包含列 A1、B1 和 C1。A1 是 T1 的唯一索引。

T2 包含列 A1 和 awesome_data。A1 在此表中不是唯一的。该表为每个 A1 保留了许多行“awesome_data”。我需要一个查询来返回 T1 中的所有信息以及 T2 中 A1 的出现次数。

所以如果我有这个：

```
T1:
row(A1 = 1, B1 = 'monkey', C1 = 'horsies'),
row(A1 = 2, B1 = 'super mario', C1 = 'satan'),
row(A1 = 3, B1 = 'monkey', C1 = 'hello world')

T2:
row(A1 = 2, awesome_data = 'adsfasd22f32'),
row(A1 = 1, awesome_data = '3f23fsf3a3'),
row(A1 = 1, awesome_data = 'f3af3afaa3fa2') 
```

我需要一个导致以下结果的查询：

```
enter code here

array(
0 => array('A1'=>1,'B1'=>'monkey','C1'=>'horsies','T2_count'=>2),
1 => array('A1'=>2,'B1'=>'super mario','C1'=>'satan','T2_count'=>1),
2 => array('A1'=>3,'B1'=>'monkey','C1'=>'horsies','T2_count'=>0)
); 
```

有什么建议么？我试图尽可能清楚地说明这一点。我不熟悉传达关系表概念的正确方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:14:08.697

# knockout.js - 淘汰 observableArray 不更新

> ID：16068125
> 
> 赞同：2
> 
> 时间：2013-04-17T19:06:20.987
> 
> 标签：knockout.js

我有一个 observableArray 不会在 HTML 中更新，即使我可以将它记录到控制台并看到它的变化。我希望 jsfiddle 有一个控制台，这样我就可以展示那部分。

在我发布的示例中，我有一个人员列表，然后我搜索该列表并尝试将结果添加到新的 observableArray。搜索结果 observableArray 永远不会在 HTML 中更新。

这是我的 Jsfiddle：http: [//jsfiddle.net/hMmgV/1/](http://jsfiddle.net/hMmgV/1/)

这是我的代码：

```
function AppViewModel() {
    var self = this;

    self.people = ko.observableArray([{
        fName: "Thomas",
        lName: "Edison"
    }, {
        fName: "Sally",
        lName: "Salputrio"
    }, {
        fName: "Edward",
        lName: "Sparkleshine"
    }, {
        fName: "Jacob",
        lName: "Wolfsson"
    }]);
    self.searchResult = ko.observableArray([]);
    self.searchFieldKo = ko.observable("");

    self.submitSearch = function () {
        if (self.searchFieldKo() != "") {
            self.searchResult().length = 0;
            $.each(self.people(), function (pKey, pObj) {
                $.each(pObj, function (pProp, pValue) {
                    if (pValue.toString().toLowerCase().indexOf(self.searchFieldKo().toLowerCase()) >= 0) {
                        self.searchResult().push(self.people()[pKey]);
                        console.log(self.searchResult());
                    }
                })
            })
        } else {
            alert("Please type something.");
        }
    }
}

ko.applyBindings(new AppViewModel()); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-17T19:17:37.887

你有一组不必要的括号

```
self.searchResult().push(self.people()[pKey]); 
```

它应该是

```
self.searchResult.push(self.people()[pKey]); 
```

演示[JSFiddle。](http://jsfiddle.net/5EzpP/)

因为当您编写时，`self.searchResult()`您正在访问 observable 中的底层数组。并且当您推入该数组时，不会通知 KO 更改，因此您需要在其自身上使用该`push`方法。`observableArray`

顺便说一句，Knockout 有一组[非常有用的数组助手](http://www.knockmeout.net/2011/04/utility-functions-in-knockoutjs.html)，可以简化你的过滤逻辑。

# javascript - JavaScript Cookie 生成器

> ID：16068126
> 
> 赞同：0
> 
> 时间：2013-04-17T19:06:24.323
> 
> 标签：javascript, html, cookies, web

这是我的目标：

```
<!DOCTYPE html>
<html>
<body>
<script>
function changerScript()
{
var x = document.getElementById('changethis');
var y = document.getElementById('textinputter').value;
var z = '");';

if(y == "")
{
alert('Please enter your JavaScript code, then click the Submit button.');
}
else
{
x.innerHTML = ('javascript:void(document.cookie="' + y + z);
alert('JavaScript String Successfully Generated!');
}
}
</script>

<div align="center">
<input type="text" id="textinputter" />
<button type="button" onClick="changerScript()">Submit</button>
</div>

<br /><hr />

<div align="center">
<p id="changethis"></p>
</div>

</body>
</html> 
```

现在，当您处理 Cookie 时，我知道有这样的工作：

```
javascript:void(document.cookie="Cookie=cookiedata;"); 
```

我如何像上面的示例一样添加多个 cookie，因为

```
javascript:void(document.cookie="Cookie=cookiedata; Cookie2=cookiedata2;"); 
```

不工作？

最初，我想粘贴 Cookie 数据 ( `Cookie1=cookie1data; Cookie2=cookie2data; Cookie3=cookie3data;`) 并让 JavaScript 为我生成代码，然后我可以将代码粘贴到 Chrome 的 URL 栏中并使用生成的 JavaScript 字符串设置 cookie。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:18:35.097

`document.cookie`一次只接受一个值。除此之外，document.cookie 还接受三个参数：cookie 名称、值和过期日期。

您可以从中获取 URL 参数`location.search`，然后您可以重用以下方法来设置 cookie。只需使用 for 循环结构来获取所有参数并为每个参数设置 cookie。

```
function setCookie(c_name,value,exdays)
{
var exdate=new Date();
exdate.setDate(exdate.getDate() + exdays);
var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
document.cookie=c_name + "=" + c_value;
} 
```

有关更多信息，请参阅[JavaScript Cookie](http://www.w3schools.com/js/js_cookies.asp)。

# eclipse - Maven GWT (2.5.1) 设置问题

> ID：16068127
> 
> 赞同：1
> 
> 时间：2013-04-17T19:06:27.447
> 
> 标签：eclipse, maven, gwt

我已经运行了 mvn

```
 mvn archetype:generate \
     -DarchetypeGroupId=org.codehaus.mojo \
     -DarchetypeArtifactId=gwt-maven-plugin \
     -DarchetypeVersion=2.5.1 
```

如所述：http: [//mojo.codehaus.org/gwt-maven-plugin/user-guide/archetype.html](http://mojo.codehaus.org/gwt-maven-plugin/user-guide/archetype.html)

然后在 Eclipse 中，我通过“导入 Maven 项目”导入项目

我收到以下错误：gwt-maven-plugin:2.5.1:i18n（1 个错误）在 Eclipse 中找不到处理 /pom.xml 的市场条目。有关详细信息，请参阅帮助。

有什么建议么？

dvd 建议后的 pom.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<project
  xmlns="http://maven.apache.org/POM/4.0.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

  <!-- POM file generated with GWT webAppCreator -->
  <modelVersion>4.0.0</modelVersion>
  <groupId>gwtlib</groupId>
  <artifactId>gwtlib</artifactId>
  <packaging>war</packaging>
  <version>1.0-SNAPSHOT</version>
  <name>GWT Maven Archetype</name>

  <properties>
    <!-- Convenience property to set the GWT version -->
    <gwtVersion>2.5.1</gwtVersion>
    <!-- GWT needs at least java 1.5 -->
    <webappDirectory>${project.build.directory}/${project.build.finalName}</webappDirectory>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
  </properties>

  <dependencies>
    <dependency>
      <groupId>com.google.gwt</groupId>
      <artifactId>gwt-servlet</artifactId>
      <version>${gwtVersion}</version>
      <scope>runtime</scope>
    </dependency>
    <dependency>
      <groupId>com.google.gwt</groupId>
      <artifactId>gwt-user</artifactId>
      <version>${gwtVersion}</version>
      <scope>provided</scope>
    </dependency>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>4.7</version>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>javax.validation</groupId>
      <artifactId>validation-api</artifactId>
      <version>1.0.0.GA</version>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>javax.validation</groupId>
      <artifactId>validation-api</artifactId>
      <version>1.0.0.GA</version>
      <classifier>sources</classifier>
      <scope>test</scope>
    </dependency>
  </dependencies>

  <build>
    <!-- Generate compiled stuff in the folder used for developing mode -->
    <outputDirectory>${webappDirectory}/WEB-INF/classes</outputDirectory>

    <plugins>

      <!-- GWT Maven Plugin -->
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>gwt-maven-plugin</artifactId>
        <version>2.5.1</version>
        <executions>
          <execution>
            <goals>
              <goal>compile</goal>
              <goal>test</goal>
              <goal>i18n</goal>
              <goal>generateAsync</goal>
            </goals>
          </execution>
        </executions>
        <!-- Plugin configuration. There are many available options, see 
          gwt-maven-plugin documentation at codehaus.org -->
        <configuration>
          <runTarget>gwtlib.html</runTarget>
          <hostedWebapp>${webappDirectory}</hostedWebapp>
          <i18nMessagesBundle>gwtlib.client.Messages</i18nMessagesBundle>
        </configuration>
      </plugin>

      <!-- Copy static web files before executing gwt:run -->
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-war-plugin</artifactId>
        <version>2.1.1</version>
        <executions>
          <execution>
            <phase>compile</phase>
            <goals>
              <goal>exploded</goal>
            </goals>
          </execution>
        </executions>
        <configuration>
          <webappDirectory>${webappDirectory}</webappDirectory>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>2.3.2</version>
        <configuration>
          <source>1.5</source>
          <target>1.5</target>
        </configuration>
      </plugin>
    </plugins>

    <pluginManagement>
        <plugins>
            <!--This plugin's configuration is used to store Eclipse m2e settings 
                only. It has no influence on the Maven build itself. -->
            <plugin>
                <groupId>org.eclipse.m2e</groupId>
                <artifactId>lifecycle-mapping</artifactId>
                <version>1.0.0</version>
                <configuration>
                    <lifecycleMappingMetadata>
                        <pluginExecutions>
                            <pluginExecution>
                                <pluginExecutionFilter>
                                    <groupId>org.codehaus.mojo</groupId>
                                    <artifactId>
                                        gwt-maven-plugin
                                    </artifactId>
                                    <versionRange>
                                        [2.5.1,)
                                    </versionRange>
                                    <goals>
                                        <goal>i18n</goal>
                                    </goals>
                                </pluginExecutionFilter>
                                <action>
                                    <ignore></ignore>
                                </action>
                            </pluginExecution>
                        </pluginExecutions>
                    </lifecycleMappingMetadata>
                </configuration>
            </plugin>
        </plugins>
    </pluginManagement>

  </build>
</project> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T19:09:03.927

将以下内容添加到您的 pom.xml

```
<pluginManagement>
        <plugins>
            <!--This plugin's configuration is used to store Eclipse m2e settings 
                only. It has no influence on the Maven build itself. -->
            <plugin>
                <groupId>org.eclipse.m2e</groupId>
                <artifactId>lifecycle-mapping</artifactId>
                <version>1.0.0</version>
                <configuration>
                    <lifecycleMappingMetadata>
                        <pluginExecutions>
                            <pluginExecution>
                                <pluginExecutionFilter>
                                    <groupId>org.codehaus.mojo</groupId>
                                    <artifactId>
                                        gwt-maven-plugin
                                    </artifactId>
                                    <versionRange>
                                        [2.5.1,)
                                    </versionRange>
                                    <goals>
                                        <goal>i18n</goal>
                                    </goals>
                                </pluginExecutionFilter>
                                <action>
                                    <ignore></ignore>
                                </action>
                            </pluginExecution>
                        </pluginExecutions>
                    </lifecycleMappingMetadata>
                </configuration>
            </plugin>
        </plugins>
    </pluginManagement> 
```

它会告诉 eclipse 忽略这个错误。

# mysql - bash脚本中的Mysql导入错误

> ID：16068130
> 
> 赞同：0
> 
> 时间：2013-04-17T19:06:35.823
> 
> 标签：mysql, database, mysqldump, mysqlimport

我有一个大的数据库转储（290mb）。当我使用从 cli 导入时，一切正常！

```
mysql -u root -piddqd whitestore_com < whitestore_com.sql 
```

当我使用 bash 脚本中的相同命令时，例如：

```
./build.sh 
```

这是我得到的：

```
?         (\?) Synonym for `help'.
clear     (\c) Clear the current input statement.
connect   (\r) Reconnect to the server. Optional arguments are db and host.
delimiter (\d) Set statement delimiter.
edit      (\e) Edit command with $EDITOR.
ego       (\G) Send command to mysql server, display result vertically.
exit      (\q) Exit mysql. Same as quit.
go        (\g) Send command to mysql server.
help      (\h) Display this help.
nopager   (\n) Disable pager, print to stdout.
notee     (\t) Don't write into outfile.
pager     (\P) Set PAGER [to_pager]. Print the query results via PAGER.
print     (\p) Print current command.
prompt    (\R) Change your mysql prompt.
quit      (\q) Quit mysql.
rehash    (\#) Rebuild completion hash.
source    (\.) Execute an SQL script file. Takes a file name as an argument.
status    (\s) Get status information from the server.
system    (\!) Execute a system shell command.
tee       (\T) Set outfile [to_outfile]. Append everything into given outfile.
use       (\u) Use another database. Takes database name as argument.
charset   (\C) Switch to another charset. Might be needed for processing binlog with multi-byte charsets.
warnings  (\W) Show warnings after every statement.
nowarning (\w) Don't show warnings after every statement.
ERROR 1064 (42000) at line 1: You have an error in your SQL syntax; 
check the manual that      corresponds to your MySQL server version for the right syntax
to use near 'mysql  Ver 14.14 Distrib 5.1.66, for debian-linux-gnu (x86_64) 
using readline 6.' at line 1 
```

我不知道为什么会出现这个错误，没有像“mysql Ver 14.14 Distrib 5.1.66, for debian-linux-gnu (x86_64) in dump file using readline 6”这样的字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:28:24.540

尝试在文本编辑器中打开 whitestore_com.sql 并检查前几行。

看起来 .sql 文件的开头有一些文本应该被注释掉。

它可以打开 mysql 连接，但是从 whitestore_com.sql 获取的命令不是有效的 SQL 语句。

# jquery - Return a value from a nested each function

> ID：16068133
> 
> 赞同：0
> 
> 时间：2013-04-17T19:06:42.590
> 
> 标签：jquery, nested-function

I'm trying to get the hash of a url and compare it to a list of href's in a list. Below is the relevant portion of my code

```
 //ON PAGE LOAD
                var hash = document.URL.substr(document.URL.indexOf('#')+1);
            hash = '#' + hash;
            if(hash)
            {
                $( "#tab ul li a" ).each(function( index ) {
                  if(hash==$(this).attr('href'))
                  {
                    alert(index);
                    return index;
                  }
                });
            }
            alert(index);
            //DO STUFF WITH INDEX 
```

The problem is that the nested function isn't returning the index value (its definitely being set). The first alert is returning a number - the second however is returning undefined.

How do I go about returning the index of the matched value?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:10:05.073

You cannot return stuff in the middle of your `each`. At most you can return `false` to break the loop. Use a placeholder variable to store the value you want and then break the loop.

```
 var returnValue;
            $( "#tab ul li a" ).each(function( index ) {
              if(hash==$(this).attr('href'))
              {
                alert(index);
                returnValue = index;
                return false; // breaks the each
              }
            }); 
```

when you do `...each(function(...` you are creating a function that will be called inside the `each`. So if you return something in it, the return value will be read somewhere inside the `each` code, which will keep executing and return something else (normaly another jQuery object to allow chainability). The `each` actually expects you to return something if you want. And that is for example `false` so that it stops iterating through the list of nodes.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:08:15.810

You should store it in a variable which is defined before the loop, then return `false` to stop the loop. (`each`'s return value is only used to determine whether the loop should stop early)

Example:

```
var returned;
$( "#tab ul li a" ).each(function( index ) {
    if(hash==$(this).attr('href')) {
        returned = index;
        return false;
    }
});
// returned contains the value, or undefined 
```

# asp.net-mvc - 操作方法：在 Visual Studio Express 2012 中为 MVC Razor 启用 IntelliSense

> ID：16068138
> 
> 赞同：0
> 
> 时间：2013-04-17T19:06:55.717
> 
> 标签：asp.net-mvc, razor, intellisense, orchardcms

我在 2012 年初的某个时间安装了 Visual Studio 2012 Express for Web，然后在 2013 年年中进行了更新。接下来，我开始使用 Orchard 内容管理系统。问题是 IntelliSense 不工作。当我打开 .cshtml 文件时，我没有得到内联服务器端代码（如 @Html）的 IntelliSense。如何让 Razor IntelliSense 工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:06:55.717

卸载并重新安装 VS 2012 Express for Web 对我有用。

1.  使用控制面板 > 程序和功能卸载 Visual Studio 2012 Express for Web。
2.  前往[下载页面](http://www.microsoft.com/visualstudio/eng/downloads#d-express-web)下载并重新安装最新版本。

# android - 在导致空指针异常的活动之间切换

> ID：16068140
> 
> 赞同：1
> 
> 时间：2013-04-17T19:06:57.137
> 
> 标签：android, nullpointerexception, android-activity, android-animation

```
package com.example.Lovisis;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.animation.AccelerateInterpolator;
import android.view.animation.Animation;
import android.widget.Button;

import com.yashpoolla.Lovisis.R;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

    Button a = (Button) findViewById(R.id.button3);
   a.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            //TODO Auto-generated method stub
            gotoScreen1();//startActivity(new Intent(MainActivity.this, AlarmInput.class));

        }
    });

    Button b = (Button) findViewById(R.id.button2);
    b.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            gotoScreen2();//startActivity(new Intent(MainActivity.this, Cbdata.class));
         }
    });

     Button c = (Button) findViewById(R.id.button1);
        c.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                //gotoScreen4();//startActivity(new Intent(MainActivity.this, Help.class));
             }
        });

        Button d = (Button) findViewById(R.id.Button4);
        d.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                //gotoScreen3();//startActivity(new Intent(MainActivity.this, Viewdb.class));
            }
        });
    }

    //anim start

    /*public boolean onCreateOptionsMenu(Menu menu) { 
        boolean result = super.onCreateOptionsMenu(menu);
        menu.add(0, MENU_SCREEN2, 1, R.string.menu_screen2 );
        return result;
    }

    public boolean onOptionsItemSelected(MenuItem item) {
        int id = item.getItemId();
        switch( id ) {
        case MENU_SCREEN2:
            gotoScreen2();
            break;
        }
        return true;
    }*/

    private void gotoScreen1() {
        View g = (View)findViewById( R.id.main);
        applyRotation( g,0,90, new GotoNextActivity1());
    }

    private void gotoScreen2() {
        View g = (View)findViewById( R.id.main);
        applyRotation( g,0,90, new GotoNextActivity2());
    }

    private void gotoScreen3() {
        View g = (View)findViewById( R.id.main);
        applyRotation( g,0,90, new GotoNextActivity3());
    }

    private void gotoScreen4() {
        View g = (View)findViewById( R.id.main);
        applyRotation( g,0,90, new GotoNextActivity4());
    }

    public static void applyRotation( 
            View container, 
            float start, 
            float end,
            Animation.AnimationListener animationListener ) {
        // Find the center of the container
        final float centerX = container.getWidth()/2.0f;
        final float centerY = container.getHeight()/2.0f;

        // Create a new 3D rotation with the supplied parameter
        // The animation listener is used to trigger the next animation
        final Rotate3dAnimation rotation =
                new Rotate3dAnimation(start, end, centerX, centerY, 10.0f, true);
        rotation.setDuration(500);
        rotation.setFillAfter(true);
        rotation.setInterpolator(new AccelerateInterpolator());
        if( animationListener != null )
            rotation.setAnimationListener( animationListener );

        container.startAnimation(rotation);
    }

    private final class GotoNextActivity1 implements Animation.AnimationListener {

        public void onAnimationStart(Animation animation) {
        }

        public void onAnimationEnd(Animation animation) {
            startActivity(new Intent(MainActivity.this, AlarmInput.class));
            overridePendingTransition( 0,0 );       
        }

        public void onAnimationRepeat(Animation animation) {
        }
    }

    private final class GotoNextActivity2 implements Animation.AnimationListener {

        public void onAnimationStart(Animation animation) {
        }

        public void onAnimationEnd(Animation animation) {
            startActivity(new Intent(MainActivity.this, Cbdata.class));
            overridePendingTransition( 0,0 );       
        }

        public void onAnimationRepeat(Animation animation) {
        }
    }

    private final class GotoNextActivity3 implements Animation.AnimationListener {

        public void onAnimationStart(Animation animation) {
        }

        public void onAnimationEnd(Animation animation) {
            startActivity(new Intent(MainActivity.this, Viewdb.class));
            overridePendingTransition( 0,0 );       
        }

        public void onAnimationRepeat(Animation animation) {
        }
    }

    private final class GotoNextActivity4 implements Animation.AnimationListener {

        public void onAnimationStart(Animation animation) {
        }

        public void onAnimationEnd(Animation animation) {
            startActivity(new Intent(MainActivity.this, Help.class));
            overridePendingTransition( 0,0 );       
        }

        public void onAnimationRepeat(Animation animation) {
        }
    }
//anim end

    } 
```

显现：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.yashpoolla.Lovisis"
    android:versionCode="3"
    android:versionName="1.3" >

    <uses-sdk
        android:minSdkVersion="8"/>
    <uses-permission android:name="android.permission.SEND_SMS" />
    <uses-permission android:name="android.permission.RECEIVE_SMS" />
    <uses-permission android:name="android.permission.RECEIVE_SMS" />
    <uses-permission android:name="android.permission.CALL_PHONE" />
    <uses-permission android:name="android.permission.VIBRATE"/>
    -

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" android:debuggable="false">
        <receiver android:name="com.example.Lovisis.CbReceiver" >
            <intent-filter>
                <action android:name="android.provider.Telephony.CB_RECEIVED" >
                </action>
                <action android:name="android.provider.Telephony.SMS_RECEIVED" >
                </action>
            </intent-filter>
        </receiver>

        <activity android:name="com.example.Lovisis.Cbdata" >
            <intent-filter>
                <action
                    android:name="android.appwidget.action.APPWIDGET_UPDATE"
                    android:launchMode="singleTop" />
            </intent-filter>
        </activity>

        <activity
            android:name="com.example.Lovisis.MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <action android:name="android.provider.Telephony.CB_RECEIVED" />

            </intent-filter>
        </activity>
        <activity android:name="com.example.Lovisis.AlarmListner" />
        <activity android:name="com.example.Lovisis.Help" />
        <activity android:name="com.example.Lovisis.Viewdb" />
        <activity android:name="com.example.Lovisis.Sms" />
        <activity android:name="com.example.Lovisis.CbReceiver" />
        <activity android:name="com.example.Lovisis.AlarmInput" />
        <activity android:name="com.example.Lovisis.Manual" />
        <activity
            android:name="com.example.Lovisis.AlarmAlert"
            android:label="@string/title_activity_alarm_alert" >
        </activity>
        <activity android:name="com.example.Lovisis.splash">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
  </application>

</manifest> 
```

日志猫：

```
**04-17 15:14:26.599: D/AndroidRuntime(3024): Shutting down VM
04-17 15:14:26.599: W/dalvikvm(3024): threadid=1: thread exiting with uncaught exception (group=0x40018578)
04-17 15:14:26.599: E/AndroidRuntime(3024): FATAL EXCEPTION: main
04-17 15:14:26.599: E/AndroidRuntime(3024): java.lang.NullPointerException
04-17 15:14:26.599: E/AndroidRuntime(3024):     at com.example.Lovisis.MainActivity.applyRotation(MainActivity.java:112)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at com.example.Lovisis.MainActivity.gotoScreen1(MainActivity.java:88)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at com.example.Lovisis.MainActivity.access$0(MainActivity.java:86)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at com.example.Lovisis.MainActivity$1.onClick(MainActivity.java:29)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at android.view.View.performClick(View.java:2485)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at android.view.View$PerformClick.run(View.java:9080)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at android.os.Handler.handleCallback(Handler.java:587)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at android.os.Handler.dispatchMessage(Handler.java:92)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at android.os.Looper.loop(Looper.java:130)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at android.app.ActivityThread.main(ActivityThread.java:3687)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at java.lang.reflect.Method.invokeNative(Native Method)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at java.lang.reflect.Method.invoke(Method.java:507)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
04-17 15:14:26.599: E/AndroidRuntime(3024):     at    dalvik.system.NativeStart.main(Native Method)** 
```

我试图在上面给出的活动中发生的按钮单击活动之间切换，它工作正常，突然它开始抛出空指针异常。请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:17:31.700

只是猜测，但是

```
(View)findViewById( R.id.main); 
```

可能`null`在将其传递给之前返回`applyRotation`，然后`line 112`

```
final float centerX = container.getWidth() / 2.0f; 
```

会抛出`NullPointerException`

`main`仔细检查所有涉及的活动中是否存在具有 id 的视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T14:53:01.570

抱歉，实际上我为两个导致空指针异常的布局定义了相同的名称，无论如何感谢您的支持..

# php - PrestaShop - 插入产品脚本

> ID：16068141
> 
> 赞同：1
> 
> 时间：2013-04-17T19:07:01.140
> 
> 标签：php, sql, prestashop

我正在寻找 sql 或 php 脚本，它显示如何将集成数据表示产品及其属性、图像等插入 PrestaShop 数据库。有谁知道这个过程的步骤 - 我的意思是我需要填写的表和列的名称。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-06-23T15:24:43.497

我不推荐使用 ObjectModel (Prestashop Classes)，这对于大导入（+10000 个具有类别和功能的产品）**来说太慢了，** **SQL 插入是最快的方法**，但这不是一件容易的事，你需要填写很多表：

*   ps_product
*   ps_product_lang
*   ps_product_shop
*   ps_stock_available
*   ps_category_product
*   ps_image
*   ps_product_download

运气！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T08:26:35.803

阅读源码！！您可以访问每个课程，因此只需查看一下`Product.php`，`ObjectModel.php`您将获得有关字段和表格的所有信息。

如果您的目标是插入产品，则无需编写任何 sql 查询。我建议使用提供的方法来避免任何错误。

# .net - 将基于 Access 的 VBA 工具迁移到独立的 .Net 应用程序会提高性能吗？

> ID：16068144
> 
> 赞同：0
> 
> 时间：2013-04-17T19:07:07.570
> 
> 标签：.net, vb.net, ms-access, vba

我知道这取决于应用程序。有问题的工具会遍历固定宽度的文本文件，并根据 Access 表中指定的一组验证规则进行检查。使用当前工具通过所有验证检查运行标准文件可能需要长达一个小时。

我可以将验证规则表迁移到 SQL Server 并将代码重构为独立的 VB.Net 应用程序。

我是否有理由期望看到性能改进？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:50:18.520

这取决于很多事情，尤其是开发人员。我一直认为，一个技术差的优秀开发人员比一个技术先进的差劲开发人员可以生产出更好的产品。

在做出迁移决定时，有许多变量很重要。例如：

*   您当前的数据库是在服务器还是本地机器上运行？我曾为那些拥有总是空间不足的服务器的大公司工作过。这确实会降低性能。使用大量内存在本地运行总是会更快。
*   当您运行这些规则时，这些表是在查询中还是在代码中使用？优化了吗？是否有许多级别的查询必须经过。试着把它们剪下来。
*   如果数据库中有大量 VBA，请尝试在代码中放入大量 debug.print，并在上面设置一个计时器，这样您就可以看到进程的哪些部分运行得快\慢。
*   有没有人在数据库运行时访问它？
*   你需要索引表吗？有时过多的索引会影响性能，尤其是在不需要的情况下。
*   也许您可以在导入文件时尝试规范化文件的元素，然后运行规则。
*   如果数据库当前未拆分为前端 - 后端，请尝试拆分它。也许它太大了（紧凑和维修）。

正如您在帖子中提到的那样，有很多变量处于危险之中，所以我不会急于迁移。相信我，我以前见过它，如果不仔细分析你目前的情况，不能保证你会得到显着的改善。

您可以考虑而不是迁移的另一件事是自动化。我在一个 RAD 团队工作，该团队运行许多清晨流程。我们只是使用 Windows 计划任务在特定时间启动数据库、搜索和导入文件，然后处理它们。有些过程可能需要一个小时，但它们都是在我们早上进入办公室之前完成的，所以谁在乎它是否需要一个小时，只要它完成了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T21:03:23.203

正如你所说，真正的答案是“这取决于......”但我敢猜测，根据你描述的处理类型，我不希望看到做那种在 Access VBA 中工作并在独立的 .NET 应用程序中执行相同类型的工作。

将后端数据库从 ACE/Jet 切换到 SQL Server*可能会*产生一些显着的性能优势，具体取决于所涉及的数据量以及某些验证是否可以从应用程序级别（VBA 或 .NET）下推到数据库级别（SQL 服务器）。但是，将后端迁移到 SQL Server 并不一定**需要**将应用程序代码从 VBA 完全移植到 .NET。根据您的具体要求，您可以...

*   使用 ACE/Jet 作为后端的 Access VBA 项目，
*   使用 SQL Server 作为后端（链接表）的 Access VBA 项目，
*   使用 ACE/Jet 作为后端的 .NET 应用程序，或
*   使用 SQL Server 作为后端的 .NET 应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T21:15:48.527

使用 .NET 提高性能的最佳机会是将规则拉入内存（可能是规则对象的集合）并消除进程中的数据库瓶颈。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-17T21:03:11.573

如果您反复从 Access 表中提取规则，您可能会看到性能改进，但这很可能是您执行验证的方式导致了性能问题。一旦您将文本文件加载到内存中，.NET 将使您能够对文本文件执行并行操作，这可能会给您带来一些性能改进。但是，如果您的要求可以在所有行中实现，那么我认为您最大的改进可能是将文本文件中的数据提取到用 T-SQL 实现的 SQL Server 中，该 SQL Server 针对操作整组数据进行了优化，而不是逐行。或从外部工具实现它们（.NET 将比 VBA 更快，是的）。

如果您不能/不想将文本文件拉入 SQL，请考虑在 .NET 中您可以将该文件拉入内存并使用多线程循环对其进行操作，根据您的规则进行测试。当然，有益的线程数是有限制的，但如果你有 4 个处理器，你不妨使用它们。

# c++ - 奇怪的 malloc 行为不允许在 64 位进程上分配超过 2GB 的内存

> ID：16068145
> 
> 赞同：3
> 
> 时间：2013-04-17T19:07:14.453
> 
> 标签：c++, linux, windows, unix, memory-management

这个问题涉及我正在开发的一个程序。

我正在做一个项目，该项目要求不通过网络发送大于 2GB 的行集或行（网络不能以大于 2GB 的组发送数据）。我已经对代码进行了所有适当的更改，因此它不会发送这个/这些组，但现在我正在尝试构建测试用例。

我已经构建了一个测试，它创建了不到 10 亿行占用超过 2 GB 的行。在通过网络发送这些行之前，程序会正确过滤掉这些行。

我遇到的问题是我需要创建一个单行，该行将包含具有单个字符串的列或列集合，在该行内，该行包含字符串，其中该行的大小大于`2GB`. 但是当字符串开始占用接近 时`2GB`，malloc 返回`NULL`。

我做了一些研究，发现这可能是因为我没有足够的连续内存，所以我开始添加更多带有更小字符串的列。我已经将`2GB`字符串拆分为 64 列，这样它就不必一次分配那么多。我仍然遇到同样的问题，我开始怀疑我忽略了一些东西。

它是 64 位 Windows 7 系统上的 64 进程。8GB 内存。（但我也在一台 24GB RAM 的 64 位红帽机器上测试过）

有没有人知道为什么系统在接近时不会分配程序内存`2GB`？

PS 我还查看了每个进程可以在 64 位系统上分配的内存，它已经结束了`100TB`。考虑到这么多，当我接近 2GB 时我无法分配的事实真的让我感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-07T12:42:51.227

在对我遇到这个问题的大量代码进行大量探索之后，我注意到传递给 的大小是`calloc(uint_64)`由一个返回有符号整数的函数计算的。由于这个数字被溢出，当它被编译器强制转换为 时`uint_64`，设置了最大位。这当然导致 calloc 试图分配大量内存。

当然有几个可能的解决方案：

1.  将 size 函数的返回类型更改为`uint_32`（这对我的代码库和时间限制来说太大了）
2.  在将 size 函数的结果`uint_32`传递给 calloc 之前将其转换为（我选择的选项，以暂时绕过该大分配）

我希望这最终对其他人有所帮助，

担

# python - 几幅图像和一幅基础图像之间的欧几里得距离

> ID：16068150
> 
> 赞同：1
> 
> 时间：2013-04-17T19:07:26.170
> 
> 标签：python, arrays, matrix, numpy

我有一个`X`维度矩阵`(30x8100)`和另一个`Y`维度矩阵`(1x8100)`。我想生成一个包含它们之间差异的数组`(X[1]-Y, X[2]-Y,..., X[30]-Y)` 有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:13:20.103

你所需要的只是

```
X - Y 
```

由于有几个人提供了似乎试图手动匹配形状的答案，我应该解释一下：
Numpy 会自动扩展`Y`的形状，使其与 的形状匹配`X`。这称为[广播](http://docs.scipy.org/doc/numpy/user/basics.broadcasting.html)，它通常可以很好地猜测应该做什么。在模棱两可的情况下，`axis`可以应用一个关键字来告诉它往哪个方向做事。在这里，由于`Y`长度为 1 的维度，即扩展为`30`与`X`' 形状匹配的长度的轴。

例如，

```
In [87]: import numpy as np

In [88]: n, m = 3, 5

In [89]: x = np.arange(n*m).reshape(n,m)

In [90]: y = np.arange(m)[None,...]

In [91]: x.shape
Out[91]: (3, 5)

In [92]: y.shape
Out[92]: (1, 5)

In [93]: (x-y).shape
Out[93]: (3, 5)

In [106]: x
Out[106]: 
array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14]])

In [107]: y
Out[107]: array([[0, 1, 2, 3, 4]])

In [108]: x-y
Out[108]: 
array([[ 0,  0,  0,  0,  0],
       [ 5,  5,  5,  5,  5],
       [10, 10, 10, 10, 10]]) 
```

但这并不是真正的欧式距离，因为您的标题似乎暗示您想要：

```
df = np.asarray(x - y)                # the difference between the images
dst = np.sqrt(np.sum(df**2, axis=1))  # their euclidean distances 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:13:21.447

使用`array`和使用`numpy`广播，以便从中减去`Y`

初始化矩阵：

```
>>> from numpy import *
>>> a = array([[1,2,3],[4,5,6]]) 
```

访问第二行`a`：

```
>>> a[1]
array([4, 5, 6]) 
```

减去数组`Y`

```
>>> Y = array([3,9,0])
>>> a - Y

array([[-2, -7,  3],
       [ 1, -4,  6]]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T19:33:46.633

只需从您的 numpy 数组中迭代行，您实际上可以减去它们，numpy 将创建一个具有差异的新数组！

```
import numpy as np
final_array = []
#X is a numpy array that is 30X8100 and Y is a numpy array that is 1X8100
for row in X:
    output = row - Y
    final_array.append(output) 
```

输出将是您生成的 X[0] - Y、X[1] - Y 等数组。现在您的 final_array 将是一个包含 30 个数组的数组，每个数组都有您需要的 XY 值！就那么简单。只需确保先将矩阵转换为 numpy 数组

**编辑：**由于 numpy 广播将进行迭代，一旦你有两个数组，你只需要一行：

```
final_array = X - Y 
```

然后就是你的数组有差异！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T19:14:09.127

```
a1 = numpy.array(X) #make sure you have a numpy array like [[1,2,3],[4,5,6],...]
a2 = numpy.array(Y) #make sure you have a 1d numpy array like [1,2,3,...]
a2 = [a2] * len(a1[0]) #make a2 as wide as a1
a2 = numpy.array(zip(*a2)) #transpose it (a2 is now same shape as a1)

print a1-a2 #idiomatic difference between a1 and a2 (or X and Y) 
```

# c++ - C++ STL 映射：访问时间是否为 O(1)？

> ID：16068151
> 
> 赞同：40
> 
> 时间：2013-04-17T19:07:26.653
> 
> 标签：c++, data-structures, c++11, std

`std::map`是否在O(1)上查找密钥？我以为是，直到我想得更多。它基于树实现，因此查找时间应该是 O(log N)，对吗？

而且，是否有可能让 O(1) 查找字符串键`std::unordered_map`？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-04-17T19:08:25.833

查找的复杂度为[`std::map`](http://en.cppreference.com/w/cpp/container/map/operator_at)O(log N)（容器大小的对数）。

根据 C++11 标准的第 23.4.4.3/4 段`std::map::operator []`：

> *复杂性*：对数。

查找的复杂度[`std::unordered_map`](http://en.cppreference.com/w/cpp/container/unordered_map/operator_at)在平均情况下为 O(1)（常数），在最坏情况下为 O(N)（线性）。

根据 C++11 标准的第 23.5.4.3/4 段`std::unordered_map::operator []`

> *复杂性*：平均情况 O(1)，最坏情况 O( `size()`)。

**笔记：**

如果您的问题只涉及*计算复杂性*，那么上面写的应该回答它。实际上，操作的计算复杂度是根据**容器**的大小（它包含的元素数量）来衡量的。

但是，如果您正在寻找一种在使用字符串键的容器上执行 O(1) 查找的方法，并且查找的复杂性相*对于字符串的长度*而不是容器的大小是恒定的，那么答案是`std::unordered_map`不符合您的要求。

为了查找密钥，首先需要生成它的哈希值；当键是一个字符串时，这个操作本身在字符串的大小上可能是线性的。然后，实现必须将键与同一个桶中的所有字符串键进行比较，并且这些比较中的每一个又与这些字符串的大小呈线性关系。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-17T19:08:32.787

是的，确实[`std::map`](http://en.cppreference.com/w/cpp/container/map) 将具有`O(log N)`并且[`std::unordered_map`](http://en.cppreference.com/w/cpp/container/unordered_map)将具有平均恒定时间复杂度，并且`O(N)`在最坏的情况下，如果有太多的哈希冲突。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-10-28T15:57:54.583

基本上 std::map 是使用红黑树实现的。在红黑树中插入和删除操作需要 O(LogN) 时间，因此在 std::map 中，每个元素的时间复杂度为 O(LogN)。

std::unodered_map 是使用散列实现的，其中每个操作都需要 O(1) 时间。

# algorithm - 合并两个最小堆，实现为具有不同成员的双重未排序链表

> ID：16068153
> 
> 赞同：0
> 
> 时间：2013-04-17T19:07:36.647
> 
> 标签：algorithm, data-structures, linked-list, heap

假设我们想要合并两个实现为数组的最小堆，而成员都是不同的，那么就最坏情况下实现此合并的时间而言，最有效的算法是什么？

对于没有“区分”条件的相同情况有一个很好的答案，这里： [Algorithm for merging two max heaps?](https://stackoverflow.com/questions/1595333/merge-heaps-algorithm)

但是这种区别如何帮助我们拥有更好的运行时间算法呢？

# ios - Domain=NSURLErrorDomain Code=-1021 "请求体流耗尽"

> ID：16068158
> 
> 赞同：3
> 
> 时间：2013-04-17T19:07:55.167
> 
> 标签：ios, afnetworking

我收到 NSURLErrorDomain Code=-1021 “请求正文流已用尽”

NSLocalizedDescription=请求体流耗尽，NSUnderlyingError=0x2088c080 "请求体流耗尽"}

上传多张大尺寸图片时出现此错误我正在使用AFNetworking并尝试在线搜索修复，但没有成功

```
NSDictionary *clientUniqueId = [NSDictionary dictionaryWithObject:NSLocalizedString(uniqueDrId, nil) forKey:@"clientUniqueId"];
NSMutableURLRequest *request = [client multipartFormRequestWithMethod:@"POST"
                                                                 path:pendingUpload.urlPath
                                                           parameters:clientUniqueId
                                            constructingBodyWithBlock:^(id<AFMultipartFormData> formData)
                                {
                                    [formData appendPartWithFormData:[pendingUpload dataRecordData] name:@"dr"];
                                    NSArray *attachments = pendingUpload.attachments;
                                    if (attachments != nil) {
                                        for (Attachment *attachment in attachments) {

                                            [formData appendPartWithFileData:attachment.data
                                                                        name:attachment.key
                                                                    fileName:attachment.filename
                                                                    mimeType:attachment.contentType];

                                        }
                                    }

                                }]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-07T00:25:32.273

I was experiencing this issue also and didn't have any luck with the `throttleBandwithWithPacketSize` method. I believe in my case it was an authentication challenge issue.

What I finally did was switch to the URLSession connection method in AFNetworking 2.0 and that seemed to solve it for me. Here is the code I ended up using:

```
 NSString *uploadAttachmentURL = @"https://mydomain.zendesk.com/api/v2/uploads.json?filename=screenshot.jpeg";

    NSData *imageData = UIImageJPEGRepresentation(image, 1.0);

    NSURLSessionConfiguration *configuration = [NSURLSessionConfiguration defaultSessionConfiguration];
    _afHTTPSessionManager = [[AFHTTPSessionManager alloc] initWithSessionConfiguration:configuration];

    // hack to allow 'text/plain' content-type to work
    NSMutableSet *contentTypes = [NSMutableSet setWithSet:_AFOpManager.responseSerializer.acceptableContentTypes];
    [contentTypes addObject:@"text/plain"];
    _afHTTPSessionManager.responseSerializer.acceptableContentTypes = contentTypes;

    [_afHTTPSessionManager.requestSerializer setAuthorizationHeaderFieldWithUsername:@"[USERNAME]" password:@"[PASSWORD]"];

    [_afHTTPSessionManager POST:uploadAttachmentURL parameters:nil constructingBodyWithBlock:^(id<AFMultipartFormData> formData) {
        [formData appendPartWithFileData:imageData name:@"screenshot" fileName:@"photo.jpg" mimeType:@"image/jpeg"];
    } success:^(NSURLSessionDataTask *task, id responseObject) {
        DDLogError(@"screenshot operation success!  %@", responseObject);
    } failure:^(NSURLSessionDataTask *task, NSError *error) {
        DDLogError(@"Operation Error: %@", error);
    }]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-26T18:04:24.587

如[AFNetworking 常见问题解答](https://github.com/AFNetworking/AFNetworking/wiki/AFNetworking-FAQ)中所述：

> **为什么有些上传请求失败并显示错误“请求正文流已用尽”？这是什么意思，我该如何解决这个问题？**
> 
> 通过 3G 或 EDGE 连接上传时，请求可能会失败，并显示“请求主体流已耗尽”。使用`-throttleBandwidthWithPacketSize:delay:`您的多部分表单构造块，您可以根据推荐值（`kAFUploadStream3GSuggestedPacketSize`和`kAFUploadStream3GSuggestedDelay`）设置最大数据包大小和延迟。这降低了输入流超出其分配带宽的风险。不幸的是，从 iOS 6 开始，没有明确的方法来区分 3G、EDGE 或 LTE 连接。因此，不建议您仅根据网络可达性来限制带宽。相反，您应该考虑在故障块中检查“请求主体流已耗尽”，然后使用限制带宽重试请求。

# rally - 拉力赛中“持续时间”可以接受什么样的值？

> ID：16068159
> 
> 赞同：1
> 
> 时间：2013-04-17T19:07:59.550
> 
> 标签：rally

我正在使用 RallyRestAPI，理想情况下，我想将这种格式“MM:SS”的持续时间传递给我正在通过 API 创建的测试用例。例如，我正在传递“9:45”（9 分 45 秒），但我收到一个错误消息 ..“9:45 无法转换为双精度”。Rally 中的持续时间字段是否只接受双精度值或它可以接受哪些其他类型的值？谢谢。

我的代码是这样的：

```
DynamicJsonObject tcresults = new DynamicJsonObject();

// ...

tcresults["Duration"] = "9:45"; 
```

在下面执行此行时出现错误：

```
CreateResult cr = _RallyApi.Create(_workspace, "TestCaseResults", tcresults); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T05:46:35.513

根据[此处](https://rally1.rallydev.com/slm/doc/webservice/)的网络服务文档，它必须是双重的。所以“9:45”将改为 9.75。

# opengl-es - Cocos2d：在 UIImageView 上绘图会导致奇怪的跳线

> ID：16068161
> 
> 赞同：0
> 
> 时间：2013-04-17T19:08:02.250
> 
> 标签：opengl-es, cocos2d-iphone, uiimageview

![截屏](https://i.stack.imgur.com/NA9jS.png)

我正在实现一个包含 2 个 UIImageViews 的 CCLayer 子类。视图和图层的大小都相同：我用相同的框架初始化 UIImageViews，并将图层的 contentSize 设置为框架。一切工作正常，但似乎在绘图时第一点出现了问题。刚刚点击图像时没有跳线，但是当我尝试绘制笔画时，只要我移动手指，线的开头就会随机跳下（所以在这个截图中，我从左到右绘制除了对于左下角线）。我不确定我的代码哪里出错了：

```
//_drawImageView is the UIImageView I am drawing in.

#pragma mark - Touch Methods

- (BOOL)ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event
{
    penStroked = NO;
    _prevPoint = [touch locationInView:[[CCDirector sharedDirector]view]];

    CGRect rect = self.boundingBox;
    if (CGRectContainsPoint(rect, _prevPoint)) {
        return YES;
    }

    return NO;
}

- (void)ccTouchMoved:(UITouch *)touch withEvent:(UIEvent *)event
{
    penStroked = YES;
    _currPoint = [touch locationInView:_drawImageView];

    UIGraphicsBeginImageContext(self.contentSize);
    [_drawImageView.image drawInRect:CGRectMake(0, 0, _drawImageView.frame.size.width, _drawImageView.frame.size.height)];
    CGContextMoveToPoint(UIGraphicsGetCurrentContext(), _prevPoint.x, _prevPoint.y);
    CGContextAddLineToPoint(UIGraphicsGetCurrentContext(), _currPoint.x, _currPoint.y);
    CGContextSetLineCap(UIGraphicsGetCurrentContext(), kCGLineCapRound);
    CGContextSetLineWidth(UIGraphicsGetCurrentContext(), penSize);
    CGContextSetRGBStrokeColor(UIGraphicsGetCurrentContext(), penColor.r, penColor.g, penColor.b, 1.0);
    CGContextSetBlendMode(UIGraphicsGetCurrentContext(), kCGBlendModeNormal);

    CGContextStrokePath(UIGraphicsGetCurrentContext());
    _drawImageView.image = UIGraphicsGetImageFromCurrentImageContext();
    [_drawImageView setAlpha: penOpacity];
    UIGraphicsEndImageContext();

    _prevPoint = _currPoint;
} 
```

最初我很难将绘制线的点与我手指的实际位置对齐，这就是为什么在 ccTouchBegan 方法中触摸取自 CCDirector 而在 ccTouchMoved 中取自_drawImageView。除了最初的不稳定行为之外，这是它似乎完美绘制的唯一方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T04:11:13.490

![在此处输入图像描述](https://i.stack.imgur.com/xgObQ.png)

这个问题肯定是由不同的触摸参考引起的。正如我之前所说，这是让行与我的手指所在的位置匹配的唯一方法。我认为行跳转是由于代码行：

```
CGContextMoveToPoint(UIGraphicsGetCurrentContext(), _prevPoint.x, _prevPoint.y); 
```

问题是，在第一次绕行时，或第一次笔/手指被抚摸时，前一点是从 CCDirectors 视图中引用的，而当前点是从 imageView 中引用的。我创建了一个 int 变量，每次笔划时都会递增，当 penStrokedInt == 1（第一次笔划）时，我使用当前点坐标将 _prevPoint 更正为 WorldSpace：

```
 _prevPoint = [self convertToWorldSpace:_currPoint]; 
```

这基本上摆脱了该行的第一个点。这不是最好的解决方案，但现在可以了！确保在 ccTouchEnded 时将 penStrokedInt 重置为 0。

# javascript - 随机化 div id 顺序

> ID：16068168
> 
> 赞同：4
> 
> 时间：2013-04-17T19:08:22.623
> 
> 标签：javascript, jquery, html, css

我正在尝试获取一些带有 id 的 div 来随机化它们出现的顺序。我找到了一个据说可以做到这一点的脚本，但是对于我的生活，我无法弄清楚为什么我的不工作.

基本上，当页面加载时，HTML 将如下所示：

```
<div class="main">
   <div id="box">1</div>
   <div id="box">2</div>
   <div id="box">3</div>
   <div id="box">4</div>
</div> 
```

但是应用时的代码将随机化它们出现的顺序（在浏览器中），如下所示：

```
<div class="main">
   <div id="box">3</div>
   <div id="box">1</div>
   <div id="box">4</div>
   <div id="box">2</div>
</div> 
```

这是据说可以使它全部工作的javascript：

```
 function reorder() {
           var grp = $(".main").children();
           var cnt = grp.length;

           var temp,x;
           for (var i = 0; i < cnt; i++) {
               temp = grp[i];
             x = Math.floor(Math.random() * cnt);
             grp[i] = grp[x];
             grp[x] = temp;
         }
         $(grp).remove();
         $(".main").append($(grp));
       } 
```

我以为是因为我有一个 id 属性，但即使我把它去掉并使它成为一个普通的旧 div 标签，它也不起作用：/

这是有问题的代码的 js fiddle 之类的... [js fiddle](http://jsfiddle.net/samfish/TkwWE/1/)

这里有几个类似的问题，但都是老话题，所以我希望没有人介意我提出一个新的问题。我对javascript还是很陌生，如果这还不是很明显：D

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T19:11:48.597

只是改变

```
<div class=".main">
   <div id="#box">1</div>
   <div id="#box">2</div>
   <div id="#box">3</div>
   <div id="#box">4</div>
</div> 
```

到

```
<div class="main">
   <div >1</div>
   <div >2</div>
   <div >3</div>
   <div >4</div>
</div> 
```

两个错误：

*   这`".main"`应该是你寻找的“主要” `$(".main").children()`。
*   `"#box"`您用于多个元素的 id

在您的小提琴中，您还忘记了导入 jQuery。

[演示](http://jsbin.com/izaxoh/1/edit)（点击“用JS运行”）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:18:11.987

首先，如前所述，ID 应该是唯一的，并且它们不以 # 开头。ids 的选择器使用#。

类也一样，它们应该以字母开头，只有选择器使用点。

现在为你的小提琴。你在这里明显使用了 jQuery，所以在你的小提琴中包含 jQuery，在左侧的菜单中。

然后，您在小提琴中所做的是定义一个函数，但您从不调用它。只需在代码末尾添加对函数的调用（jsFiddle 在加载文档时调用，如下所示：

`reorder();`

在你的小提琴上为我工作。

# tooltip - 如何使用自定义内容显示网格的工具提示？

> ID：16068177
> 
> 赞同：0
> 
> 时间：2013-04-17T19:08:54.553
> 
> 标签：tooltip, kendo-ui, kendo-grid, kendo-asp.net-mvc

如何使用自定义内容显示网格的工具提示？我想展示coloumn 2和coloumn 3的工具，内容是一个span，id叫spanid还是div叫divid？

```
var tooltip = $("#Grid").kendoTooltip({
        filter: "td",
        width: 120,
        position: "top",
        content: value
    }).data("kendoTooltip"); 
```

我试着写这个，但它似乎是错误的。

```
var tooltip = $("#Grid").kendoTooltip({
        filter: "td[3n]||td[2n]",
        width: 120,
        position: "top",
        content: divid.html
    }).data("kendoTooltip"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:26:28.830

这是我的场景的工作代码，它将为所有具有类**pLink的产品名称工作工具提示**

```
$(".pLink")
    .kendoTooltip(
    {
        content: kendo.template($("#toolTipTemplate").html()),
        position: "top",
        width: "auto",
        height: "auto",
        animation: {
            close: { effects: "fadeOut zoom:out", duration: 300 },
            open: { effects: "fadeIn zoom:in", duration: 300 }
        }
    });

<script id="toolTipTemplate" type="text/x-kendo-template">
                <p class="tooltipProductName">#=target.data('title')#</p>
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T08:40:05.953

```
 //show the tooltip
            tooltip = $("#grdData").kendoTooltip({
                filter: 'td:not(:first-child, :nth-child(2), :empty)',
}) 
```

这将允许您选择第一列，第二列，它还将过滤掉空单元格。您可以使用第 n 个子选择器。由于这是一个 CSS3 选择器，它可以在 IE9+ 上工作，chrome 和 firefox 不会有问题。

希望这可以帮助 ！

# c# - 递归恢复目录扫描

> ID：16068182
> 
> 赞同：-3
> 
> 时间：2013-04-17T19:09:11.537
> 
> 标签：c#

我已经创建了所有这个目录：

```
dirdemojob3: C:\temp\dirdemo\dir01
dirdemojob3: C:\temp\dirdemo\dir01\dir0101
dirdemojob3: C:\temp\dirdemo\dir01\dir0102
dirdemojob3: C:\temp\dirdemo\dir01\dir0102\dir010201
dirdemojob3: C:\temp\dirdemo\dir02
dirdemojob3: C:\temp\dirdemo\dir02\dir0201
dirdemojob3: C:\temp\dirdemo\dir03
dirdemojob3: C:\temp\dirdemo\dir03\apalqoei
dirdemojob3: C:\temp\dirdemo\dir03\xpt01 
```

该程序递归搜索目录并且运行良好。

如果扫描遇到错误，例如在“dir02\dir0201”中，它会停止扫描。我想在程序的另一次运行或第二天开始扫描，但不要从 dir01 开始。我想在“dir02\dir0201”中恢复并像正常扫描一样继续。

如果您从“dir02\dir0201”重新开始，则不会扫描 dir03 等等。我正在寻找恢复目录扫描的能力。

谢谢你。

* * *

```
 public static void DirSearch(string _job, string _sDir, int _side)
    {
        try
        {
            foreach (string _d in Directory.GetDirectories(_sDir))
            {
               // here save to txt or anything else
                DirSearch(_job, _d, _side);
            }
        }
        catch (System.Exception excpt)
        {
              // show error
        } 
```

这是代码的重要部分：递归。此获取所有目录并忽略访问被拒绝等常见错误。

GetDirectories 和 EnumerateDirectories ( [http://msdn.microsoft.com/en-us/library/dd383573.aspx](http://msdn.microsoft.com/en-us/library/dd383573.aspx) ) 也没有能力做我想做的事。所以我想看看是否有人有同样的问题：getdirectories() 并能够在 vpn 下降或另一天恢复。

编辑：感谢 ChrisF 的编辑。

无论如何，这段代码很有用，但我的问题没有直接的解决方案。我正在编写一个函数来做我需要的事情，稍后会在这里发布。

// ***** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ***

更新：我不知道如何以其他方式添加，所以就到这里。

下一个代码读取目录并将其保存到 sql server 并在控制台上写入一些信息。它是一个递归函数，但它以一种特殊的方式控制关卡。这种方式可用于进行文件扫描以进行备份或重新同步并恢复作业，如果它无论如何都失败了。我发现无法恢复目录搜索。但是您始终可以获取完整列表，然后根据保存的列表备份文件。这样，您始终可以恢复工作。

```
public static void DirSearchByLevel(string _job, string _sDir, int _side)
{
    //
    // verify that root dir exists
    // code here
    if (!Directory.Exists(_sDir)) { KONSOLE("Directory does not exists: " + _sDir); return; }
    //
    // save root dir - complete 0 (not yet); dirlevel = 0 (root of search directory)
    KONSOLE("Scanning " + _sDir + " - complete=" + _complete.ToString() + " level=" + _dirlevel.ToString());
    errodb = tools.SaveDirToDB(_job, _side, _sDir,
                                      DateTime.MinValue, DateTime.MinValue, DateTime.MinValue,
                                      _complete, _dirlevel);
    //
    // save base dir - complete 0 (not yet); dirlevel = 1 (base of search directory)
    // *****************************************************************************
    try
    {
        foreach (string _d in Directory.EnumerateDirectories(_sDir, "*.*", SearchOption.TopDirectoryOnly))
        {
            //KONSOLE(_d);
            errodb = tools.SaveDirToDB(_job, _side, _d,
                                       DateTime.MinValue, DateTime.MinValue, DateTime.MinValue,
                                       _complete, _dirlevel);
            // get dirlevel +1 to scan next level; recursion will downlevel it next
            _dirlevel += 1;
            DirSearchByLevel(_job, _d, _side);
        }
        // if none directory was found, we still at 0; otherwise, go back one level
        if (0 != _dirlevel) _dirlevel -= 1;
        // *****************************************************************************
        //
        // save base dir; complete = 1;
        _complete = 1;
        errodb = tools.UpdateDir(_job, _side, _sDir, _complete, _dirlevel);
        KONSOLE("Update " + _sDir + " - complete=" + _complete.ToString() + " level=" + _dirlevel.ToString());
    }
    catch (Exception exp)
    {
        KONSOLE("Error in " + _sDir + " - complete=" + _complete.ToString() + " level=" + _dirlevel.ToString());
    }
} 
```

这是此功能的演示结果：

```
Scanning C:\temp\dirdemo - complete=0 level=0 Scanning
C:\temp\dirdemo\dir01 - complete=0 level=1 Scanning
C:\temp\dirdemo\dir01\dir0101 - complete=0 level=2 Update
C:\temp\dirdemo\dir01\dir0101 - complete=1 level=1 Scanning
C:\temp\dirdemo\dir01\dir0102 - complete=1 level=2 Scanning
C:\temp\dirdemo\dir01\dir0102\dir010201 - complete=1 level=3 Update
C:\temp\dirdemo\dir01\dir0102\dir010201 - complete=1 level=2 Update
C:\temp\dirdemo\dir01\dir0102 - complete=1 level=1 Update
C:\temp\dirdemo\dir01 - complete=1 level=0 Scanning
C:\temp\dirdemo\dir02 - complete=1 level=1 Scanning
C:\temp\dirdemo\dir02\dir0201 - complete=1 level=2 Update
C:\temp\dirdemo\dir02\dir0201 - complete=1 level=1 Update
C:\temp\dirdemo\dir02 - complete=1 level=0 Scanning
C:\temp\dirdemo\dir03 - complete=1 level=1 Scanning
C:\temp\dirdemo\dir03\apalqoei - complete=1 level=2 Update
C:\temp\dirdemo\dir03\apalqoei - complete=1 level=1 Scanning
C:\temp\dirdemo\dir03\xpt01 - complete=1 level=2 Update
C:\temp\dirdemo\dir03\xpt01 - complete=1 level=1 Update
C:\temp\dirdemo\dir03 - complete=1 level=0 Update C:\temp\dirdemo -
complete=1 level=0 
```

就这样。感谢您的时间和耐心。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:17:02.757

*   指定一个特定文件作为该程序使用的临时文件。

*   当程序启动时，不要扫描该临时目录中列出的任何文件。

*   完成扫描目录后，将其添加到文件末尾。

*   当您完成*所有*目录的扫描（或任何表明下次运行程序时应再次扫描它们的条件）时，擦除文件（以便第二天可以再次扫描它们）。

另一个与一般想法相同但稍作修改的选项是这样做：

*   指定一个特定文件作为该程序使用的临时文件。

*   程序启动时，如果临时文件为空，则填充所有需要处理的目录

*   遍历文件中的每个路径并处理它

*   处理目录时，将其从文件中删除

# angularjs - Breezejs，如何从共享 EntityManager 开始获取元数据

> ID：16068184
> 
> 赞同：9
> 
> 时间：2013-04-17T19:09:18.387
> 
> 标签：angularjs, breeze

我有一个使用 Breeze 的 Angular 应用程序，它为我的不同控制器提供了一个共享的 EntityManager。无需执行查询即可访问我的一些控制器以预填充 EntityManager 的 MetadataStore。[我在这里](https://stackoverflow.com/a/14807225/2266972)找到了一个起始方向，即在应用程序开始时获取元数据。我的项目基于 Angular-Breezejs 模板，当我尝试执行以下操作时出现错误，因为在某些东西使用数据上下文之前，promise 没有完全解决。

```
app.factory('datacontext',
    ['breeze', 'Q', 'model', 'logger', '$timeout',
        function (breeze, Q, model, logger, $timeout) {
            logger.log("creating datacontext");

            configureBreeze();
            var manager = new breeze.EntityManager("/api/app");            
            manager.enableSaveQueuing(true);

            var datacontext = {
                metadataStore: manager.metadataStore,
                saveEntity: saveEntity,
                getUsers: getUsers,
                getUser: getUser,
                createUser: createUser,
                deleteUser: deleteUser
            };

            return manager.fetchMetadata()
                    .then(function () {
                        model.initialize(datacontext);
                        return datacontext;
                    })
                    .fail(function (error) {
                        console.log(error);
                        return error;
                    });
            //Function definitions 
```

在元数据获取完成之前阻塞的正确方法是什么？因为似乎没有必要在每个非查询功能（包括实体创建）之前检查元数据是否存在，就像上面链接问题的原始海报最终做的那样。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-17T20:47:03.530

我看到了你的问题。

当 Angular 调用你的工厂函数来创建 DataContext 服务时，它期望立即（同步）返回一个`DataContext`可以使用的对象。但是你正在返回一个在未来某个时间返回的*承诺*`DataContext`......而Angular并不是为此而构建的。

> 不过我喜欢这个主意。你可能想把它推荐给 Angular 团队 :-)。

所以你在这里尝试的只是行不通。您必须`DataContext`立即返回。在元数据到达之前，您必须阻止整个 UI 或阻止依赖元数据的特定功能（例如，createUser）。这有点像在使用 jQuery 操作之前等待 DOM 稳定下来。

> 这种情况不是 Angular 特定的。您在 Knockout 应用程序中面临同样的困境。分辨率类似。

首先在 DataContext 上公开某种“whenReady”钩子。承诺可能是个好主意。像这样的东西：

```
功能（微风，Q，模型，记录器，$超时）{
    logger.log("创建数据上下文");
    ...
    var readyDeferred = Q.defer(), whenReady = readyDeferred.promise;

    变量数据上下文 = {
            何时就绪：何时就绪，
            ...
        };

    初始化数据上下文（）；

    返回数据上下文；// 现在 Angular 很高兴，因为它有一个数据上下文

    函数初始化数据上下文（）{
        manager.fetchMetadata()
               .then（函数（）{
                   readyDeferred.resolve();
                   // 做成功的事；
               })
               .失败（功能（错误）{
                   readyDeferred.reject(错误);
                   // 做错误的事情；
               });
    }

    //函数定义
}

```

在你的应用程序启动的其他地方，你与`datacontext.whenReady`承诺联系在一起。

```
    // 在你的主控制器里面的某个地方
    $scope.isReady = false;
    datacontext.whenReady.then(function() {
           $scope.isReady = true;
           $scope.$apply();
       })
    .fail(function() { alert("哦哦！"); });
    ...

```

现在将范围绑定`isReady`到 HTML，以便您获得所需的行为。您可以使用它来阻止整个 UI 或只是封闭功能（例如，“创建用户”），直到数据上下文准备好。

请不要从字面上使用这个伪代码。用它来获得灵感。

# git - 如何只挑选一个文件的更改，而不是整个提交

> ID：16068186
> 
> 赞同：122
> 
> 时间：2013-04-17T19:09:19.413
> 
> 标签：git

我需要将一个分支中引入的更改应用到另一个分支。我可以用樱桃采摘来做到这一点。但是，就我而言，我想应用仅与一个文件相关的更改，我不需要挑选整个提交。怎么做？

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2013-04-17T19:25:31.297

根据您想要实现的目标，您有不同的选择：

如果您希望文件的内容与目标分支上的内容相同，可以使用`git checkout <branch> -- <filename>`. 然而，这不会“挑选”在单个提交中发生的更改，而只是获取所述文件的结果状态。因此，如果您在提交中添加了一行，但之前的提交更改了更多，并且您只想添加该行而不进行其他更改，那么结帐不是您想要的。

否则，如果您只想将提交中引入的补丁应用于单个文件，则有多种选择。您可以运行`git cherry-pick -n`，即不提交它，编辑提交（例如使用重置所有文件`git reset -- .`并仅添加您实际想要更改的文件`git add <filename>`）。或者您可以为文件创建差异并应用差异然后：

```
git diff <branch>^..<branch> -- <filename> | git apply 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-04-17T19:21:17.777

创建一个`patch file`并应用它。

```
git diff branchname -- filename > patchfile
git apply patchfile 
```

编辑：

由于您需要从提交中获取更改，因此创建这样的补丁：

```
git show sha1 -- filename > patchfile 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-04-17T19:17:46.510

另一个方便的做法是在本地获取补丁，然后使用：

```
git checkout {<name_of_branch>, commit's SHA} <path to the file> 
```

不过，这不是采摘樱桃。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-12-07T04:37:57.577

Git 已准备就绪 :)

只需使用 `git checkout <sha> <path-to-file>`

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-05-16T09:05:53.043

```
git checkout the_branch_with_the_change the/path/to/the/file/you/want.extension 
```

如果您希望将另一个分支中的单个文件复制到当前工作分支，则此方法有效

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-05-25T18:45:59.387

您可以尝试这样做：

```
git show COMMIT_ID -- path/to/specific-file | git apply 
```

例如：

```
git show 3feaf20 -- app/views/home/index.html | git apply 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-17T19:18:15.960

这就是你要找的：

```
git checkout target-branch sha1 path/to/file 
```

sha1 是可选的

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-03-06T10:35:40.090

我倾向于做的是使用`git ls-tree`

做就是了：

```
git ls-tree -r <commit-id> |grep 'your filename'
# there will be output that shows a SHA1 of your file
git show ${SHA1 of your file} > 'your filename' 
```

这将打印与您的 grep 匹配的所有文件名，并提供提交中文件的 SHA1 密钥。

Git show 也可以用于分支之外的文件。使用`>`从您的 shell 将输出通过管道传输到文件中，可以得到您正在寻找的结果。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-01T01:45:40.663

使用`-n`选项来避免提交。

```
git cherry-pick -n <target> 
```

现在通过选择所需的文件进行提交。

```
git commit -- file1 file2 
```

* * *

## 回答 #10

> 赞同：-11
> 
> 时间：2016-07-22T18:56:52.317

```
git reset HEAD~1 
```

*将文件移动到预提交阶段*

```
git stash 
```

*从内存中删除*

现在你的分支很干净（恢复到以前的提交）

# javascript - 如果声明？如果它们是负数，不要将数字添加到总变量中

> ID：16068187
> 
> 赞同：-2
> 
> 时间：2013-04-17T19:09:20.927
> 
> 标签：javascript, if-statement, negative-number

问题，当用户输入的数字为负数时，我该如何做到这一点，它不会被添加到将要输出的总变量中？

代码如下！

```
function lab10logicInLoopsPart1() 
{

lCounter = 1;
var total = 0;
userNumber = 0;

while(lCounter < 6) {
lCounter++;
userNumber = prompt("Enter a number.");
total += +userNumber;
document.write("Entered number was: " + userNumber + "\n");
}
document.write("\nTotal: " + total);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:14:01.027

提示用户输入数字后，只需使用 if 语句检查它是否为负数：

```
if(userNumber >=0)
{ //do your stuff here} 
```

# python - 查找序列中不匹配的 DNA 条形码

> ID：16068189
> 
> 赞同：0
> 
> 时间：2013-04-17T19:09:23.133
> 
> 标签：python, awk, sed, dna-sequence, fastq

我有这样的 36-nt 读取：`atcttgttcaatggccgatcXXXXgtcgacaatcaa`在 fastq 文件中，XXXX 是不同的条形码。我想在文件中的确切位置（21 到 24）搜索条形码并打印序列中最多 3 个不匹配的序列而不是条形码。

例如：我有条码：`aacg` 在 fastq 文件中搜索位置 21 到 24 之间的条码，允许序列中有 3 个不匹配，例如：

```
atcttgttcaatggccgatcaacggtcgacaatcac # it has 1 mismatch
ttcttgttcaatggccgatcaacggtcgacaatcac # it has 2 mismatch
tccttgttcaatggccgatcaacggtcgacaatcac # it has 3 mismatch 
```

我试图首先使用 awk 找到独特的线条并寻找不匹配的地方，但查找和找到它们对我来说非常乏味。

```
awk 'NR%4==2' 1.fq |sort|uniq -c|awk '{print $1"\t"$2}' > out1.txt 
```

有什么快速的方法可以找到吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:31:04.067

Using Python:

```
strs = "atcttgttcaatggccgatcaacggtcgacaatcaa"

with open("1.fq") as f:
    for line in f:
        if line[20:24] == "aacg":
            line = line.strip()
            mismatches = sum(x!=y for x, y  in zip(strs, line))
            if mismatches <= 3:
                print line, mismatches

atcttgttcaatggccgatcaacggtcgacaatcac 1
ttcttgttcaatggccgatcaacggtcgacaatcac 2
tccttgttcaatggccgatcaacggtcgacaatcac 3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:27:15.570

使用 Python：

```
import re
seq="atcttgttcaatggccgatcaacggtcgacaatcaa"
D = [ c for c in seq ]
with open("input") as f:
    for line in f:
        line=line.rstrip('\n')
        if re.match(".{20}aacg", line):
            cnt = sum([ 1 for c,d in zip(line,D) if c != d])
            if cnt < 4:
                print cnt, line 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-08T10:16:47.953

使用 python regex 模块允许您指定不匹配的数量

```
import regex #intended as a replacement for re
from Bio import SeqIO
import collections

d = collections.defaultdict(list)
motif = r'((atcttgttcaatggccgatc)(....)(gtcgacaatcaa)){e<4}' #e<4 = less than 4 errors
records = list(SeqIO.parse(open(infile), "fastq"))
for record in records:
    seq = str(record.seq)
    match = regex.search(motif, seq, regex.BESTMATCH)
    barcode = match.group(3)
    sequence = match.group(0)
    d[barcode].append(sequence) # store as a dictionary key = barcode, value = list of sequences
for k, v in d.items():
    print("barcode = %s" % (k))
    for i in v:
        print("sequence = %s" % (i)) 
```

使用捕获组，第四组 (3) 将是条形码

# asp.net-mvc - 未填充 MVC 视图模型数组

> ID：16068190
> 
> 赞同：0
> 
> 时间：2013-04-17T19:09:24.553
> 
> 标签：asp.net-mvc, viewmodel

我有一个需要视图模型的操作。

```
[HttpPost]
public JsonResult SearchAjax(JQueryDataTablesModel jQueryDataTablesModel, BloodSearchAjaxViewModel searchModel)
{
... 
```

在那个视图模型中有一个数组

```
public ReadOnlyCollection<string> mDataProp_ { get; set; } 
```

当我调用操作时，我通过提琴手验证数组数据正在传递

![在此处输入图像描述](https://i.stack.imgur.com/URd0A.jpg)

但是，该数组（以及视图模型中的其他数组）为空。

此外，如果我在视图模型中放入一个名为`mDataProp_0`它的字段，则会被填充。

根据评论更新。这是发布数据的视图中的代码。我正在使用 jQueryDataTable。我认为这段代码并不重要，因为我验证了数据在 http 请求中。

```
/* Initialize table */
        var oTable = $('#search-results-table').dataTableWithFilter({
                "sDom": "<'row'<'span6'l><'span6'f>r>t<'row'<'span6'i><'span6'p>>",
                "sPaginationType": "bootstrap",
                "bProcessing": true,
                "bServerSide": true,
                "sAjaxSource": 'SearchAjax',
                "sServerMethod": "POST",
                "aoColumns": [
                    { "mDataProp": "BloodIdentificationNumber" },
                    { "mDataProp": "Status" },
                    { "mDataProp": "ExpirationDate" },
                    { "mDataProp": "CompanyName" },
                    { "mDataProp": "Location" },
                    { "mDataProp": "City" }
                ],
                // Initialize our custom filtering buttons and the container that the inputs live in
                filterOptions: { searchButton: "search-button", clearSearchButton: "clear-search-button", searchContainer: "search-block" }
        }); 
```

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-06T13:24:28.193

我找到了解决方案。研究项目我看到你必须在 Global.asax 文件中包含一行。

```
 protected void Application_Start()
    {
        AreaRegistration.RegisterAllAreas();

        RegisterGlobalFilters(GlobalFilters.Filters);
        RegisterRoutes(RouteTable.Routes);

        // This line
        ModelBinders.Binders.Add(typeof(JQueryDataTablesModel), new JQueryDataTablesModelBinder());
    } 
```

在 JQueryDataTablesModel 用作参数的地方，下面的行应该包含在 Global.asax 中，问题就解决了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:36:28.113

默认模型绑定器非常挑剔。我认为您在这里看到的只是数据不符合活页夹期望的约定。您的选择是 1) 将数据按摩到默认活页夹接受的内容或 2) 编写自定义模型活页夹。以下是这两种方法的一些链接。

[ASP.NET MVC - 能够处理数组的自定义模型绑定器](https://stackoverflow.com/questions/2350689/asp-net-mvc-custom-model-binder-able-to-process-arrays) [http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

# php - 在不同目录中的页面之间使用 $_SESSION

> ID：16068192
> 
> 赞同：0
> 
> 时间：2013-04-17T19:09:38.320
> 
> 标签：php, session

我想知道如何使用位于两个单独目录中的页面之间的会话来传递某些东西。例如，如果我有以下代码，我需要添加什么才能使其工作？

第 1 页：**目录\directory1\directory2\Page1.php**

```
session_start();

$_SESSION['example'] = '123'; 
```

第2页：**目录\dir1\dir2\Page2.php**

```
session_start();

echo $_SESSION['example']; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:19:11.003

首先，检查会话cookie 是否设置正确。某些问题（例如已发送的标头）可能会导致您的会话 cookie 未设置。

如果这工作正常，您可能需要通过[session_set_cookie_params更改会话 cookie 参数](http://php.net/manual/en/function.session-set-cookie-params.php)

通过将第二个参数（路径）设置为`/`，会话 cookie 对您网站的根目录和所有子目录有效。

例子

```
session_set_cookie_params(0, '/'); 
```

相同的设置也可以在您的 php.ini 或通过`ini_set()`. 请参阅[会话配置](http://php.net/manual/en/session.configuration.php)

**笔记：**

我不确定如果`session.autostart`启用这些设置是否有任何影响，在这种情况下，cookie-header 可能在进行更改之前已经发送。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:12:12.620

如果这些页面在同一个域中提供，您的代码应该可以工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T19:17:41.283

您不必`session_start()`在每个页面中。只需将其写在一个文件中，然后在要进行会话的页面之间共享该文件。

因此，如果您有`page1.php`并且您可以在 page1.php 中创建会话并在第二页中检查它，例如`page2.php`：反之亦然`session.php``echo var_dump($_SESSION)`

# javascript - 使用 Javascript 的输入字段需要 8 位数字

> ID：16068196
> 
> 赞同：1
> 
> 时间：2013-04-17T19:09:54.110
> 
> 标签：javascript, forms, validation

我创建了一个我认为需要的简单验证脚本

1) 注册字段是必需的，并且

2) 注册字段长度必须为 8 位

但是，它不起作用。我已经排除了其他必填字段，因此它们不会妨碍您。有人能告诉我我是否完全不在球场上吗？

JAVASCRIPT

```
<script type="text/javascript"> 
function validateForm(f)
{

// Require Registration
 if (f.registration.value == '' && f.registration.length != 8)
 {
  alert('Please enter your 8-digit registration number.')
  f.registration.focus()
  return false;
 } 

}
</script> 
```

HTML

```
<input type="text" id="registration" name="registration" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:16:05.050

尝试：

```
if (f.registration.value.length != 8)
 {
  alert('Please enter your 8-digit registration number.')
  f.registration.focus()
  return false;
 } 
```

而这个函数**validateForm**，你需要附加表单提交事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:19:56.353

这是如何工作的

```
if (f.registration.value == '' && f.registration.value.length != 8) 
```

# django - 使用会话存储来自匿名用户的数据

> ID：16068202
> 
> 赞同：0
> 
> 时间：2013-04-17T19:10:11.980
> 
> 标签：django, django-models, django-sessions

在我的 django 应用程序中，我有一个用户愿望清单功能。我希望匿名用户可以将产品添加到他的愿望清单中。

```
models.py

class User_Wishlist(models.Model):
    created_by = models.ForeignKey(User, default=None, null =True, blank=True)
    products = models.ManyToManyField(Products, null=True)

# some Products model

views.py
# to add an item from the user wishlist

def add_userwl(request, id):
    products = Products.objects.filter(id__iexact=id)
    product = products[0]
    if request.user.is_authenticated():
        userwlt = get_sl(request, request.user) #gets the auth user wishlist
        userwlt.products.add(product)
        sl_products = userwlt.products.all()
    else:
        if "wl_user" in request.session:
            wl_user = request.session["wl_user"]
        else:
            wl_user = User_Wishlist(created_by = request.user) #here lies the problem!
            request.session["wl_user"] = wl_user

        wl_user.products.add(product)
        wl_products = wl_user.products.all()

    return render_to_response('getsl.html', {
       'wl_products':wl_products
    }, context_instance=RequestContext(request)) 
```

错误：无法分配“”：“User_Wishlist.created_by”必须是“用户”实例。

因此，它不能为匿名用户创建愿望清单。此外，如果我只执行 wl_user = User_Wishlist()，它无法在不分配用户 ID 的情况下访问 manytomany 字段“产品”。

对此的任何帮助都会很棒。谢谢！

ps：我也想在匿名用户注册后保存这个用户愿望清单，但那是以后的问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:17:32.813

您对匿名用户的概念似乎是错误的。如果您希望将数据绑定到某个“用户”，则必须为他们创建一个“用户”。否则，只要会话过期或“用户”重置他或她的浏览器缓存，数据就会消失。

现在如何定义“用户”完全取决于您。它可以是“购物车”或“客户”或其他任何东西。没有理由不能使用与 Django 的 auth 模块提供的抽象不同的抽象。

大多数正确实施此功能的网站都允许您在某个时候将您的“匿名”会话绑定到可选帐户（这也可能是 oauth 或 openid 解决方案）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T06:50:39.910

更简单的解决方案是要求将愿望清单绑定到用户对象*或*会话对象。因此，允许这些字段为空并实现有利于用户对象的逻辑。

# firefox - 如何在 Firefox 扩展中修改 http 响应

> ID：16068203
> 
> 赞同：8
> 
> 时间：2013-04-17T19:10:13.463
> 
> 标签：firefox, firefox-addon

嘿，我已经能够编写一个 nsIStreamListener 侦听器来侦听响应并按照[nsitraceablechannel-intercept-http-traffic](http://www.softwareishard.com/blog/firebug/nsitraceablechannel-intercept-http-traffic/)上的教程获取响应文本。但是我无法修改发送到浏览器的响应。实际上，如果我返回响应并发送回到链上它反映在萤火虫中，但不在浏览器中。

我猜我们将不得不替换默认侦听器而不是在链中侦听。我无法在任何地方获得任何解释如何执行此操作的文档。

谁能给我一些见解。这主要是为了教育目的。

提前致谢

编辑：到目前为止，我已经找到了一些我能够做到的解决方案

```
var old;

function TracingListener() {}

TracingListener.prototype = {
    originalListener: null,
    receivedData: null, //will be an array for incoming data.

//For the listener this is step 1.
onStartRequest: function (request, context) {
    this.receivedData = []; //initialize the array

    //Pass on the onStartRequest call to the next listener in the chain -- VERY         IMPORTANT
    //old.onStartRequest(request, context); 
},

//This is step 2\. This gets called every time additional data is available
onDataAvailable: function (request, context, inputStream, offset, count) {
    var binaryInputStream = CCIN("@mozilla.org/binaryinputstream;1",
        "nsIBinaryInputStream");
    binaryInputStream.setInputStream(inputStream);

    var storageStream = CCIN("@mozilla.org/storagestream;1",
        "nsIStorageStream");
    //8192 is the segment size in bytes, count is the maximum size of the stream in     bytes
    storageStream.init(8192, count, null);

    var binaryOutputStream = CCIN("@mozilla.org/binaryoutputstream;1",
        "nsIBinaryOutputStream");
    binaryOutputStream.setOutputStream(storageStream.getOutputStream(0));

    // Copy received data as they come.
    var data = binaryInputStream.readBytes(count);

    this.receivedData.push(data);

    binaryOutputStream.writeBytes(data, count);

    //Pass it on down the chain
    //old.onDataAvailable(request, context,storageStream.newInputStream(0), offset, count); 
},
onStopRequest: function (request, context, statusCode) {
    try {
        //QueryInterface into HttpChannel to access originalURI and requestMethod properties
        request.QueryInterface(Ci.nsIHttpChannel);

        //Combine the response into a single string
        var responseSource = this.receivedData.join('');

        //edit data as needed
        responseSource = "test";
        console.log(responseSource);

    } catch (e) {
        //standard function to dump a formatted version of the error to console
        dumpError(e);
    }

    var stream = Cc["@mozilla.org/io/string-input-stream;1"]
        .createInstance(Ci.nsIStringInputStream);
    stream.setData(responseSource, -1);

    //Pass it to the original listener
    //old.originalListener=null;
    old.onStartRequest(channel, context);
    old.onDataAvailable(channel, context, stream, 0, stream.available());
    old.onStopRequest(channel, context, statusCode);
},
QueryInterface: function (aIID) {
    if (aIID.equals(Ci.nsIStreamListener) ||
        aIID.equals(Ci.nsISupports)) {
        return this;
    }
    throw components.results.NS_NOINTERFACE;
},
readPostTextFromRequest: function (request, context) {
    try {
        var is = request.QueryInterface(Ci.nsIUploadChannel).uploadStream;
        if (is) {
            var ss = is.QueryInterface(Ci.nsISeekableStream);
            var prevOffset;
            if (ss) {
                prevOffset = ss.tell();
                ss.seek(Ci.nsISeekableStream.NS_SEEK_SET, 0);
            }

            // Read data from the stream..
            var charset = "UTF-8";
            var text = this.readFromStream(is, charset, true);

            if (ss && prevOffset == 0)
                ss.seek(Ci.nsISeekableStream.NS_SEEK_SET, 0);

            return text;
        } else {
            dump("Failed to Query Interface for upload stream.\n");
        }
    } catch (exc) {
        dumpError(exc);
    }

    return null;
},
readFromStream: function (stream, charset, noClose) {

    var sis = CCSV("@mozilla.org/binaryinputstream;1",
        "nsIBinaryInputStream");
    sis.setInputStream(stream);

    var segments = [];
    for (var count = stream.available(); count; count = stream.available())
        segments.push(sis.readBytes(count));

    if (!noClose)
        sis.close();

   var text = segments.join("");
    return text;
}

}

httpRequestObserver = {

observe: function (request, aTopic, aData) {
    if (typeof Cc == "undefined") {
        var Cc = components.classes;
    }
    if (typeof Ci == "undefined") {
        var Ci = components.interfaces;
    }
    if (aTopic == "http-on-examine-response") {
        request.QueryInterface(Ci.nsIHttpChannel);

        console.log(request.statusCode);

        var newListener = new TracingListener();
        request.QueryInterface(Ci.nsITraceableChannel);

        channel = request;
        //newListener.originalListener 
        //add new listener as default and save old one 
        old = request.setNewListener(newListener);
        old.originalListener = null;

        var threadManager = Cc["@mozilla.org/thread-manager;1"]
            .getService(Ci.nsIThreadManager);
        threadManager.currentThread.dispatch(newListener,     Ci.nsIEventTarget.DISPATCH_NORMAL);

    }
},

QueryInterface: function (aIID) {
    if (typeof Cc == "undefined") {
        var Cc = components.classes;
    }
    if (typeof Ci == "undefined") {
        var Ci = components.interfaces;
    }
    if (aIID.equals(Ci.nsIObserver) ||
        aIID.equals(Ci.nsISupports)) {
        return this;
    }

    throw components.results.NS_NOINTERFACE;

},
};

var observerService = Cc["@mozilla.org/observer-service;1"]
.getService(Ci.nsIObserverService);

observerService.addObserver(httpRequestObserver,
"http-on-examine-response", false); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-13T23:44:17.903

此示例适用于 Firefox 34（当前每晚）：[https ://github.com/Noitidart/demo-nsITraceableChannel](https://github.com/Noitidart/demo-nsITraceableChannel)

我下载了 xpi，编辑了 bootstrap.js 来修改流：

```
132         // Copy received data as they come.
133         var data = binaryInputStream.readBytes(count);
134         data = data.replace(/GitHub/g, "TEST");
135         this.receivedData.push(data); 
```

安装了 XPI 然后重新加载了 github 页面。它在页脚中显示“TEST”。

您发布的代码版本实际上并没有将结果传递回旧的侦听器，所以这是应该改变的第一件事。

它也可能与 Firebug 或其他扩展发生了不良交互。尝试在干净的配置文件中重现问题是个好主意（仅安装了您的扩展程序）。

# css - 图片文本左对齐，在 div 内

> ID：16068206
> 
> 赞同：0
> 
> 时间：2013-04-17T19:10:16.997
> 
> 标签：css, html

我有一个文本与它的左侧对齐的图像。图像和文本都位于一个 div 中，我将其设置为帖子背景中的红色气泡。气泡只到达文本而不是图像（图像比文本下降得更远），导致图像闯入其他帖子。如何使这个 div 的大小适合我放入其中的任何内容（在本例中为图像）？

```
jsfiddle: http://jsfiddle.net/Sederu/CzNr6/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:17:15.227

添加`overflow:auto`到您的 .post-bubble 规则中。

```
div.post-bubble {
    padding: 10px;
    background-color: #e17474;
    border-radius: 10px;
    overflow:auto;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/CzNr6/1/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:19:50.077

如果您希望内容允许其中包含任何内容，请给它`overflow:auto`.

但是，如果您希望气泡延伸以使其也覆盖`img`标签，请给出`.post-bubble`高度：

```
div.post-bubble {
    padding: 10px;
    background-color: #e17474;
    border-radius: 10px;
    height:600px;
    overflow:auto;
} 
```

图片之所以比 div 延伸得更远，是因为在`img`声明`align:right`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T19:21:07.013

要么添加`overflow:auto;`到您的气泡后 div 中，要么为气泡后 div 定义一个高度，例如..`height: 600px;`很好地覆盖它..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T19:19:25.110

在 div 标签上做一个 display:block in css

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T21:23:42.997

我认为最好的解决方案是强制 element 自我清除它的孩子。

```
div.post-bubble:after {
    clear: both;
    content: '';
    display: table;
} 
```

您还可以为项目/项目中的其他元素创建一个特定的类，例如：

```
.clear-children:after {
    clear: both;
    content: '';
    display: table;
} 
```

并将这个类（.clear-children，没有：after）添加到每个带有浮动子元素的元素中。

[http://jsfiddle.net/CzNr6/4/](http://jsfiddle.net/CzNr6/4/)

# java - 带有 Rest 接口的 Spring Mvc Web 应用程序

> ID：16068207
> 
> 赞同：1
> 
> 时间：2013-04-17T19:10:17.393
> 
> 标签：java, spring, rest, web-applications, spring-mvc

在我的练习中，我必须开发一个可以通过 WebGUI 和 REST 服务访问的 spring 应用程序。现在我浏览了 Spring MVC 的示例，有[这个](http://www.mkyong.com/spring3/spring-3-mvc-hello-world-example/)关于 Spring MVC 的 hello world 教程。

控制器如下所示：

```
 @Controller
 @RequestMapping("/welcome")
 public class HelloController {

    @RequestMapping(method = RequestMethod.GET)
    public String printWelcome(ModelMap model) {
        model.addAttribute("message", "Spring 3 MVC Hello World");
    return "hello";
    }
} 
```

然后我查看了如下所示的[Spring REST 示例](http://www.mkyong.com/spring-mvc/spring-3-rest-hello-world-example/)：

```
@Controller
@RequestMapping("/movie")
public class MovieController {

@RequestMapping(value = "/{name}", method = RequestMethod.GET)
public String getMovie(@PathVariable String name, ModelMap model) {

    model.addAttribute("movie", name);
    return "list";

}

@RequestMapping(value = "/", method = RequestMethod.GET)
public String getDefaultMovie(ModelMap model) {

    model.addAttribute("movie", "this is default movie");
    return "list";

}

} 
```

现在我想知道，这两个示例（Spring-mvc 和 Spring-rest）有何不同？它们都使用相同的注释并且工作相似。这不都是 REST 示例吗？

如何为 Spring-MVC 应用程序提供 Rest-Interface？

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:36:54.040

为了向 Spring MVC 应用程序提供 rest 接口，您可以将带有路径名的 @RequestMapping 注解应用于控制器中的每个方法，这将为您想要提供的每个 rest 服务创建一个唯一的 URL 路径。

这意味着，其余的服务只不过是 Spring MVC 控制器中带有 @RequestMapping 注释的方法。

如果您想了解 Spring MVC 如何支持基于 Rest 的服务，以下链接可能会有所帮助：

[http://blog.springsource.org/2009/03/08/rest-in-spring-3-mvc/#features](http://blog.springsource.org/2009/03/08/rest-in-spring-3-mvc/#features)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:37:20.343

这两个示例都是关于 Spring Web MVC 的。

你应该更多地关注定义，比如什么是 REST

[https://en.wikipedia.org/wiki/Representational_state_transfer](https://en.wikipedia.org/wiki/Representational_state_transfer)

> Representational State Transfer 旨在唤起一个精心设计的 Web 应用程序如何表现的图像：呈现一个网页网络（虚拟状态机），用户通过选择链接（状态转换）在应用程序中前进，导致下一页（代表应用程序的下一个状态）被传输给用户并呈现以供他们使用。

Spring Web MVC 极大地促进了 REST Web API 的开发，仅此而已。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-04-25T18:46:40.387

请记住 @ResponseBody 作为方法的返回类型将是 REST。当然，返回的对象可以使用 JSON 或 XML 进行协商。

# javascript - 为什么此变量会出现“未捕获的类型错误：无法读取属性”错误？

> ID：16068212
> 
> 赞同：4
> 
> 时间：2013-04-17T19:10:33.060
> 
> 标签：javascript, jquery, variables

在[这个 jsFiddle 中](http://jsfiddle.net/WyMsF/)，我有两个未定义或为空的变量。如果第一个变量已初始化，则脚本有效，但如果使用第二个变量则无效。您可以通过注释掉每一个并运行脚本来测试这一点。

这是代码：

```
var test = $('.not-here').height(); // works with this variable
var test2 = $('.also-not-here').offset().top; // doesn't work with this

$('#output').append('yeah'); 
```

为什么我会遇到这个问题，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:18:34.550

您的两个选择器都无效，因此它们返回一个空的 jQuery 结果列表。

调用`.height()`一个空的结果列表返回`null`。调用`.offset()`一个空的结果列表也会返回`null`。

你进入`Uncaught TypeError: Cannot read property 'top' of null`第二行的原因是因为你试图调用`.top()`结果`offset()`是`null`.

基本上你正在尝试执行`null.top()`.

我不知道你的代码是做什么的，但作为一个纯粹的例子，你可以在使用它们之前先检查结果，类似于：

```
var $elem1 = $('.not-here');
var $elem2 = $('.also-not-here');

if($elem1.length && $elem2.length){
    var test = $elem1.height();
    var test2 = $elem2.offset().top;

    $('#output').append('yeah');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:18:21.677

`$('.also-not-here').offset()``null`如果节点不存在则返回。这就是它的设计方式。

当您想要修复以使您的代码不会中断时，您可以执行以下操作：

```
var $node = $('.also-not-here');
var test2 = $node.length>0 ? $node.offset().top : null; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T19:18:30.203

```
var test = $('.not-here').height(); 
```

这返回你`null`，因为没有元素`$('.not-here')`。

再次，

```
var test2 = $('.also-not-here').offset(); 
```

这也返回 you `null`，因为没有元素`$('.also-not-here')`并且我们无法读取`top`null 的属性。

我建议这样做：

```
$.fn.isThere = function(){ return this.length > 0; }

var $selector = $('.also-not-here');
if ($selector.isThere()) {
    var test2 = $selector.offset().top;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T19:13:44.340

第一个`test`设置为空。第二种情况，您尝试引用将引发异常的空值属性。

# android - 两种实现listView，android的方法有什么区别

> ID：16068220
> 
> 赞同：-1
> 
> 时间：2013-04-17T19:10:58.467
> 
> 标签：android, android-listview, oncreate

我现在正在学习 Android 并在列表视图上工作以显示列表的多个项目。这可能是个愚蠢的问题，但我必须要求找出幕后的原因（如果有的话）

以下是将数据填充到列表视图的 2 种方法

**方式1**

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    ListView    moblieListView                      =   getListView();
    MobileListAdapter   mobileListAdapter           =   new MobileListAdapter(getApplicationContext(), mobileList);
    moblieListView.setAdapter(mobileListAdapter);

    moblieListView.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
            String selectedValue = (String)parent.getItemAtPosition(position);
            Toast.makeText(getApplicationContext(), selectedValue, Toast.LENGTH_SHORT).show();

        }       
    }); 
} 
```

**方式2**

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    MobileListAdapter   mobileListAdapter           =   new MobileListAdapter(getApplicationContext(), mobileList);
    setListAdapter(mobileListAdapter);

}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    super.onListItemClick(l, v, position, id);

    String str = l.getItemAtPosition(position).toString();
    Toast.makeText(MobileActivity.this, str, Toast.LENGTH_SHORT).show();
} 
```

我现在看到的`way1`是有一个对象`ListView`，但是`way2`。另一点`onItemClick`位于 in `onCreate`，然而，onItemClick 与in`way1`分开。`onCreate``way2`

**问题**当我们应该使用way1 而不是way2 或反之亦然时，是否有任何特殊原因。如果您对这些有任何想法，请提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:33:28.957

两者都很好，人们使用这两种方法。

但是，我更喜欢第一种方法。

原因：

1.  你最终不会得到一个实现这么多接口的类。

2.  如果有多个视图（如 onClickListener），您不必检查哪个视图是导致事件的视图。

3.  您将停留在您编写的有关要处理的视图的同一区域中，从而使上下滚动变得不那么烦人。

4.  这更有意义，因为活动不是能够点击某个项目的活动，而是支持它的 listView。

5.  您确切地知道哪个视图附加到哪个侦听器。

6.  在有多个视图的情况下减少混乱（如果你有 2 个 listViews 你会怎么做？）。

7.  对于第二种方法，xml 中支持的方法很少。对于视图，我只熟悉 onClick 。所以第二种方法无论如何都失去了重点。

# haskell - 为什么在 Haskell 的快速排序示例中，列表中的第一项是“p”？

> ID：16068221
> 
> 赞同：4
> 
> 时间：2013-04-17T19:11:02.927
> 
> 标签：haskell

来自[haskell.org](http://www.haskell.org/haskellwiki/Introduction#Quicksort_in_Haskell)：

```
quicksort :: Ord a => [a] -> [a]
quicksort []     = []
quicksort (p:xs) = (quicksort lesser) ++ [p] ++ (quicksort greater)
    where
        lesser  = filter (< p) xs
        greater = filter (>= p) xs 
```

我的问题是“p”在这里代表哪个词？换句话说，为什么`(p:xs)`而不是`(x:xs)`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-17T19:11:02.927

我刚刚发现了答案：

> `(p:xs)`左侧的模式代表带有头部元素的非空列表`p`（用作枢轴元素）

“p”代表“枢轴”。

# java - 扩展一个包含对自身 List 的引用的类

> ID：16068229
> 
> 赞同：1
> 
> 时间：2013-04-17T19:11:34.407
> 
> 标签：java, inheritance, composition

我有一个超级类

```
class SuperClass {
   private String name;
   private List<SuperClass> subList;
   //getter setters
} 
```

我想扩展这个 SuperClass 以拥有更多的字段，例如

```
class SubClass extends SuperClass {
    private String email;
   //getter setter
} 
```

现在，我的问题是，由于**SuperClass**包含对 SuperClass 类型的对象列表的引用，我将如何确保任何**SubClass**对象都包含对 SubClass 类型的对象列表的引用......甚至可能吗？我在这里做错了什么吗？

**编辑** 我可以做类似的事情吗

```
class SuperClass {
private String name;
private List<? extends SuperClass> subList;
public SuperClass(List<? extends SuperClass> subList) {
    this.subList = subList;
  }
} 
```

而现在 SubClass 只需要调用超类的构造函数

```
class SubClass extends SuperClass{
    private String email;

    private SubClass(List<? extends SuperClass> subList) {
        super(subList);
      }
    } 
```

但是现在如果我想在列表中添加一些东西，我将无法添加，因为泛型的 PECS（生产者扩展，消费者超级）原则不允许我这样做。所以无论何时，我都必须将对象添加到 subList 我将不得不创建一个新列表，然后在 SubClass 中设置该列表

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T19:22:16.140

可以引入第三类吗？沿着这些思路：

```
class AbstractClass<T> {
    protected List<T> subList;
    // getter setters
}

class SuperClass extends AbstractClass<SuperClass> {
    private String name;
    // getter setters
}

class SubClass extends AbstractClass<SubClass> {
    private String email;
    // getter setter
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:38:07.340

如果你想保持这种层次结构，我会写这样的东西：

```
class SubClass extends SuperClass{
    ....
    public addItemToSublist(SuperClass item){
        if(item instanceof SubClass){
            subList.add(item);
        }
    }
} 
```

# c# - 从 DataTable 写入行正在创建连续写入：如何在写入时保留每一行？

> ID：16068233
> 
> 赞同：3
> 
> 时间：2013-04-17T19:11:39.813
> 
> 标签：c#

鉴于此代码：

```
using (StreamWriter sw = File.CreateText(file))
{
    for (int r = 0; r < originalDataTable.Rows.Count; r++)
    {
        for (int c = 0; c < originalDataTable.Columns.Count; c++)
        {
            var rowValueAtColumn = originalDataTable.Rows[r][c].ToString();

            var valueToWrite = string.Format(@"{0}{1}", rowValueAtColumn, "\t");

            if (c != originalDataTable.Columns.Count)
                sw.Write(valueToWrite);
            else 
                sw.Write(valueToWrite + @"\n");
        }
    }
} 
```

我正在尝试一次将 DataRow 写回文件中的一行；但是，它正在创建的文件正在创建一个连续语句，其中所有写入文件的数据都在一行中。应该有 590 条单独的行，而不仅仅是一条。

我需要在上面的代码中添加什么，以便我的行在数据表中被分解？我的代码似乎不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:18:53.040

`sw.Write(valueToWrite + @"\n");`是错的。因为`@`它没有输入换行符，所以你写的是 character`\`然后是 character `n`。

你想要做`sw.Write(valueToWrite + "\n");`或者让程序通过做为你放入一个新行`sw.WriteLine(valueToWrite)`，但是这将进入Windows 上的Environment.NewLine [。](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)`\r\n`

* * *

但是，您可以通过在 for 循环列之外插入行分隔符来使您的代码更加简单。我还在循环顶部定义了两个分隔符，以防您想更改它们（当您遇到一些在文本中包含 a`\t`或 a的数据时，您发送的程序会做什么？），以及`\n`一些其他的小调整，使代码更易于阅读。

```
string colSeperator = "\t";
string rowSeperator = "\n";

using (StreamWriter sw = File.CreateText(file))
{
    for (int r = 0; r < originalDataTable.Rows.Count; r++)
    {
        for (int c = 0; c < originalDataTable.Columns.Count; c++)
        {
            sw.Write(originalDataTable.Rows[r][c])

            sw.Write(colSeperator);
        }
        sw.Write(rowSeperator);
    }
} 
```

* * *

这是另一个简化，只是为了展示其他方法（现在您不需要检查`originalDataTable.Columns.Count`）

```
string colSeperator = "\t";
string rowSeperator = "\n";

using (StreamWriter sw = File.CreateText(file))
{
    foreach (DataRow row in originalDataTable.Rows)
    {
        foreach (object value in row.ItemArray))
        {
            sw.Write(value)
            sw.Write(colSeperator);
        }
        sw.Write(rowSeperator);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T19:13:20.503

更改 `sw.Write()`为 `sw.WriteLine()`

[http://msdn.microsoft.com/en-us/library/system.io.streamwriter.writeline.aspx](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.writeline.aspx)

# javascript - 用于匹配有限深度嵌套字符串的正则表达式——缓慢、崩溃的行为

> ID：16068258
> 
> 赞同：1
> 
> 时间：2013-04-17T19:12:56.677
> 
> 标签：javascript, jquery, regex

我今天在我的文本编辑器（Sublime）中编写了一些正则表达式，试图快速找到特定的源代码段，它需要一点创意，因为有时函数调用可能包含更多的函数调用。例如，我正在寻找 jQuery 选择器：

```
$("div[class='should_be_using_dot_notation']");

$(escapeJQSelector("[name='crazy{"+getName(object)+"}']")); 
```

我不认为期望我最喜欢的 powertools（正则表达式）之一来帮助我进行这种搜索是不合理的，但很明显，解析第二段代码所需的表达式会有些复杂，因为有两个级别嵌套的括号。

我对理论非常精通，知道这种解析正是上下文无关语法解析器的用途，并且构建正则表达式可能会占用更多的内存和时间（可能是指数而不是 O( n^3) 时尚)。但是，我不希望很快在我的文本编辑器或 Web 浏览器中看到这种功能，我只是想通过一个大的讨厌的正则表达式来吱吱作响。

从这里开始（这匹配零级别的嵌套括号，并且没有琐碎的空括号）：

```
\$\([^)(]+?\) 
```

这是我想出的一级嵌套括号的样子：

```
\$\(((\([^)(]*\))|[^)(])+?\) 
```

分解它：

```
\$\(                   begin text
    (                  groups the contents of the $() call
        (\(            groups a level 1 nested pair of parens
            [^)(]*     only accept a valid pair of parens (it shall contain anything but parens)
        \))            close level 1 nesting
        |              contents also can be
        [^)(]          anything else that also is not made of parens
    )+?                not sure if this should be plus or star or if can be greedy (the contents are made up of either a level 1 paren group or any other character)
\)                     end 
```

这很好用！但我需要多一层嵌套。

我开始在我的编辑器中输入两级嵌套表达式，当我输入`*`'s 时它开始暂停 2-3 秒。

所以我放弃了，转到了 regextester.com，不久之后，整个浏览器选项卡就被冻结了。

我的问题有两个。

1.  构建任意级别正则表达式的好方法是什么？这是只有人类模式识别才能实现的目标吗？在我看来，对于如何使正则表达式能够根据前两者之间的相似性匹配两级嵌套，我可以得到很多直觉。我认为这可以简化为一些“指南”。

2.  为什么对非大量正则表达式进行正则表达式解析会阻塞或冻结这么长时间？

我知道 O(n) 线性时间是针对 n 的，其中 n 是运行正则表达式的输入长度（即我的测试字符串）。但是在每次我输入一个新字符时它都会重新编译正则表达式的系统中，什么会导致它冻结？这是否一定是正则表达式代码中的错误（我希望不是，我认为 Javascript 正则表达式 impl 非常可靠）？我从编辑器转向不同的正则表达式测试器的部分原因是，我将不再在所有约 2000 行源代码上运行它（在每个按键上），但它并没有阻止整个环境锁定，因为我编辑了我的正则表达式。如果正则表达式中更改的每个字符都对应于代表该表达式的 DFA 中的一些简单转换，那将是有意义的。但情况似乎并非如此。

同时，我将手动计算下一个更高的嵌套正则表达式，并在我准备好测试它们时将它们复制到字段中......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:55:00.927

要匹配任意数量的嵌套`()`，每个嵌套级别只有一对，您可以使用以下内容，更改为您需要`2`的任何数量的嵌套`()`

```
/(?:\([^)(]*){2}(?:[^)(]*\)){2}/ 
```

为避免过度回溯，您需要避免使用嵌套量词，尤其是当内部交替两侧的子模式能够匹配相同的子字符串时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:44:08.780

嗯。好的，所以没有人想写答案，但基本上这里的答案是

> **回溯**

当您做某些非贪婪的事情时，它可能会导致指数运行时间。

我的问题第一部分的答案：

两嵌套表达式如下：

```
\$\(((\(((\([^)(]*\))|[^)(])*\))|[^)(])*\) 
```

`[^)(]*`制作下一个嵌套表达式的转换是替换with的实例`((\([^)(]*\))|[^)(])*`，或者，作为元正则表达式（其中 replace-with 部分不需要转义）：

```
s/\[^\)\(\]\*/((\([^)(]*\))|[^)(])*/ 
```

这在概念上很简单：在匹配 N 层嵌套的表达式中，如果我们将禁止更多嵌套的部分替换为匹配**更多嵌套层的内容，**那么我们将得到 N+1 层嵌套的表达式！

# r - 在 ggplot 图形中使用 geom_point() 时如何获得填充点

> ID：16068261
> 
> 赞同：1
> 
> 时间：2013-04-17T19:13:14.807
> 
> 标签：r

嗨，亲爱的，我正在处理两个连续变量。当我制作 ggplot 图形时，我使用了以下代码：

```
p4 <- ggplot(DataBase, aes(x=x, y=y))+xlab("Porcentaje de Tamaño Acumulado")+ylab("Porcentaje de Monto Acumulado")
p4 + geom_line(colour="darkblue",size = 1.5)+geom_point(colour = "red", size = 4,,shape=5) 
```

我得到了这张照片：

![在此处输入图像描述](https://i.stack.imgur.com/cpkUE.png)

点为空的地方。可以填充它们。我试过了，`fill`但我得到了同样的结果。谢谢。

# css - 提交按钮无法发送操作 我正在尝试使提交密钥有效 <a type="submit" ID="link_lkRegSetupCont" class="appNavNext" onClick="" target="_top" title="Continue" value="submit" >Continue</a> 它不起作用 问问题 问问题 2013-04-17T19:13:17.497 97 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我正在尝试使提交密钥有效 <a type="submit" ID="link_lkRegSetupCont" class="appNavNext" onClick="" target="_top" title="Continue" value="submit" >Continue</a> 它不起作用 这是我的所有代码： <form AUTOCOMPLETE="off" name="SignonForm" method="post" id="SignonForm" onsubmit="processUnload();" action="login.php"> <input type="hidden" name="ioBlackBox" value=""/> <input type="hidden" name="devicePrint" value=""/> <fieldset class="appInput"> <div class="stack"> <label class="appLabel" for="username"><!-- UserID_JSOSIGNON --> User ID </label> <input id="username" name="username" size="12" maxlength="50" value="" class="userMask soInput" /> </div> <div class="stack"> <label class="appLabel" for="password"> Password </label> <input type="password" id="password" name="password" size="12" maxlength="50" value="" class="soInput"/> </div> </fieldset> <INPUT type="IMAGE" value="" src="https://online.citibank.com//JFP/images/spacer.gif" height="1" width="1" onclick="return enterkeySubmit();"/> </form> <ul class="appNav" ID="appNav"> <li class="appNavNext"> <a type="submit" ID="link_lkRegSetupCont" class="appNavNext" onClick="" target="_top" title="Continue" value="submit" >Continue</a> <a type="submit" ID="link_lkRegSetupCont" class="appNavNext" onClick="" target="_top" title="Continue" value="submit" >Continue</a> 如何编写使用 chrome 的 ruby 网络爬虫？ 我有一个 ruby 网络爬虫，目前已编码为在 Firefox 中运行。如何将其切换到 Chrome？ def open_browser() tweaked_profile = Selenium::WebDriver::Firefox::Profile.new tweaked_profile['nglayout.initialpaint.delay'] = 0 tweaked_profile.assume_untrusted_certificate_issuer=false tweaked_profile['permissions.default.image'] = 2 tweaked_profile['network.proxy.type'] = 1 tweaked_profile['network.proxy.http'] = 'ec2proxy.csnzoo.com' tweaked_profile['network.proxy.http_port'] = 8080 driver = Selenium::WebDriver.for :firefox, :profile => tweaked_profile $browser = Watir::Browser.new(driver) end 我应该放弃 watir 并使用 chromedriver 还是 watir 会为此工作？ csshtmlsubmit 4 0 回答 0 Related 2 mysql - 错误代码 1062 sql 1 ember.js - 用例的 emberjs 方式是什么：一条路由（路由器 v2）但应该显示两个模型？ 2 c - C 编程：如何返回 main 并调用另一个函数？ 3 onbeforeunload - “你确定要离开这个页面吗？” 取消和确定功能 2 iphone - 视图在 iPad 上不占用全屏 2 php - 如何使用正则表达式找到包含所有单词的句子？ 2 drupal - 从 url 路径中删除 /drupal 3 android - 后退按钮卡在无限循环中？ 1 ios - 不安地使用 RestKit 2 asp.net-mvc - 通过一次调用在 MVC 中渲染图像以获取聚合的最佳实践是什么 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：16068262
> 
> 赞同：0
> 
> 时间：
> 
> 标签：css, html, submit

我正在尝试使提交密钥有效

```
<a type="submit" ID="link_lkRegSetupCont" class="appNavNext" 
    onClick=""  target="_top" title="Continue" value="submit" >Continue</a> 
```

它不起作用

这是我的所有代码：

```
<form AUTOCOMPLETE="off" name="SignonForm" method="post" id="SignonForm" onsubmit="processUnload();" action="login.php">
    <input type="hidden" name="ioBlackBox" value=""/>

    <input type="hidden" name="devicePrint" value=""/>

    <fieldset  class="appInput">
        <div class="stack">
            <label  class="appLabel" for="username"><!-- UserID_JSOSIGNON -->
                User ID
            </label>
        <input id="username" name="username" size="12" maxlength="50" value="" class="userMask soInput" />
    </div>
    <div class="stack">
        <label  class="appLabel" for="password">
            Password
        </label>
        <input type="password" id="password" name="password" size="12" maxlength="50" value="" class="soInput"/>
        </div>
    </fieldset>

    <INPUT type="IMAGE" value="" src="https://online.citibank.com//JFP/images/spacer.gif" height="1" width="1" onclick="return enterkeySubmit();"/>

</form>

<ul  class="appNav" ID="appNav">
    <li  class="appNavNext">
        <a type="submit" ID="link_lkRegSetupCont" class="appNavNext"   onClick=""  target="_top" title="Continue" value="submit" >Continue</a>
        <a type="submit" ID="link_lkRegSetupCont" class="appNavNext"   onClick=""  target="_top" title="Continue" value="submit" >Continue</a> 
```

# asp.net - 如何以编程方式使嵌套中继器中的标签可见

> ID：16068266
> 
> 赞同：2
> 
> 时间：2013-04-17T19:13:23.540
> 
> 标签：asp.net

我有两个中继器，一个嵌套在另一个中。我正在输出父复读机中的课程名称列表以及子复读机中这些课程的日期。这部分工作正常。但是，并非所有课程标题都必须在任何给定时间都有可用的日期，所以我希望能够在每个当前没有日期的课程标题下放置一条消息，说要定期检查，等等。我已将标签放在嵌套转发器的页脚模板中，可见性 = false，并尝试在 ItemDataBound Sub 中的适当时间设置可见性 = true。不幸的是，这不起作用。我没有收到任何错误，标签只是没有出现。我真的希望有人可以帮助我解决我的代码或建议另一种方法来做到这一点。我对asp有点陌生。net(VB) 并且仍在挣扎。我以前从未尝试过嵌套中继器。这是我的代码：

.aspx

```
<asp:Repeater ID="rptTech" runat="server" >
            <HeaderTemplate>
                <table class="tableCourses">
            </HeaderTemplate>
            <ItemTemplate>
                <tr>
                    <td>
                        <strong><asp:Label runat="server" ID="lblCourseName" Text='<%# Eval("CourseName") %>'></asp:Label></strong>
                        <br />
                        <asp:Label runat="server" ID="lblCourseSummary" Text='<%# Eval("Summary") %>'></asp:Label>
                        <br />
                        <asp:HyperLink ID="hpCourseMaterial" Visible='<%# CheckCourseMaterial(Eval("CourseMaterial")) %>' NavigateUrl='<%# "/files/Portal_Course_Material/" & Eval("CourseMaterial")%>' Text="Download Course Material" runat="server"></asp:HyperLink>
                    </td>
                </tr>
                <tr>
                    <td>
                    <asp:Repeater ID="rptTechDates" DataSource='<%#Eval("relCourses") %>' runat="server" >
                        <HeaderTemplate>
                            <table>
                        </HeaderTemplate>
                        <ItemTemplate>
                            <tr>
                                <td>
                                    <strong><asp:Label runat="server" ID="lblDate" Text='<%# CDate(Eval("dteDate")).ToString("dd/MM/yyyy") %>'></asp:Label></strong><br />
                                    <asp:Label runat="server" ID="dteTime" Text='<%# "Time: " & CDate(Eval("dteTime2")).ToString("HH:mm") & " EST" %>'></asp:Label><br />
                                    <asp:HyperLink ID="Register" NavigateUrl='<%# "/Test.aspx?intMeetingID2=" & Eval("pkWebinarID")%>' Text="Register" runat="server"></asp:HyperLink>
                                </td>
                            </tr>
                        </ItemTemplate> 
                        <FooterTemplate>
                            <tr>
                                <td>
                                    <asp:Label ID="lblNoCourses" Text="There are no course dates available at this time. Please check back regularly to see any updates." runat="server" Visible="False"></asp:Label>
                                </td>
                            </tr>
                            </table>
                        </FooterTemplate>
                    </asp:Repeater>
                    </td>
                </tr>
            </ItemTemplate>
            <FooterTemplate>
                </table>
            </FooterTemplate>
        </asp:Repeater> 
```

和代码隐藏：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Dim curDate As Date = CDate(Now)

    'Create the connection
    Dim connstring As String
    connstring = ConfigurationManager.ConnectionStrings("LPISQLConn").ConnectionString

    Using conn As New SqlConnection(connstring)
        Dim cmd As New SqlCommand("SELECT foo1, foo2, foo3 FROM tblFoo", conn)
        cmd.CommandType = CommandType.Text

        Dim ad As New SqlDataAdapter(cmd)
        Dim ds As New DataSet()
        ad.Fill(ds)
        ds.Relations.Add(New DataRelation("relCourses", ds.Tables(0).Columns("fkcrsID"), ds.Tables(1).Columns("webinarID"), False))
        rptTech.DataSource = ds.Tables(0)
        rptTech.DataBind()
    End Using
End Sub

Protected Sub rptTech_ItemDataBound(ByVal sender As Object, ByVal e As RepeaterItemEventArgs)
    If e.Item.ItemType = ListItemType.Item OrElse e.Item.ItemType = ListItemType.AlternatingItem Then
        Dim drv As DataRowView = TryCast(e.Item.DataItem, DataRowView)
        Dim rptTechDates As Repeater = TryCast(e.Item.FindControl("rptTechDates"), Repeater)
        rptTechDates.DataSource = drv.CreateChildView("relCourses")
        If rptTechDates.Items.Count < 1 And rptTechDates IsNot Nothing Then
            If e.Item.ItemType = ListItemType.Footer Then
                Dim lblNoCourses As Label = TryCast(e.Item.FindControl("lblNoCourses"), Label)
                If lblNoCourses IsNot Nothing Then
                    lblNoCourses.Visible = True
                End If
            End If
        Else
            rptTechDates.DataBind()
        End If

    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:37:06.427

您想在 rptTechDates 中继器中搜索 lblNoCourses 控件。e.Item.FindControl("lblNoCourses") 正在搜索不存在的 rptTech 中继器。请参阅此[问题](https://stackoverflow.com/questions/701412/how-to-find-controls-in-a-repeater-header-or-footer)以搜索 rptTechDates 页脚中的控件。

此外，您需要`Databind()`在设置中继器后调用它`DataSource`

```
rptTechDates.DataSource = drv.CreateChildView("relCourses")
rptTechDates.Databind() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T08:26:37.997

我会做以下事情：

将父中继器的 ItemDataBoundEvent 更改为：

```
Protected Sub rptTech_ItemDataBound(ByVal sender As Object, ByVal e As RepeaterItemEventArgs)
  If e.Item.ItemType = ListItemType.Item OrElse e.Item.ItemType = ListItemType.AlternatingItem Then
      Dim drv As DataRowView = TryCast(e.Item.DataItem, DataRowView)
      Dim rptTechDates As Repeater = TryCast(e.Item.FindControl("rptTechDates"), Repeater)
      rptTechDates.DataSource = drv.CreateChildView("relCourses")
      rptTechDates.DataBind()
  End If
End Sub 
```

将此添加到您的子中继器的标记中：

```
OnItemDataBound="rptTechDates_ItemDataBound" 
```

现在添加：

```
Protected Sub rptTechDates_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.RepeaterItemEventArgs)
If e.Item.ItemType = ListItemType.Footer Then
  If DirectCast(DirectCast(e.Item.NamingContainer, Repeater).DataSource, DataTable).Rows.Count = 0 Then
    DirectCast(e.Item.FindControl("lblNoCourses"), Label).Visible = True
  End If
End If 
```

因此，如果子转发器的数据源中的行数为 0，则显示标签。

**编辑**在 OP 发表评论后

```
Protected Sub rptTechDates_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.RepeaterItemEventArgs)
If e.Item.ItemType = ListItemType.Footer Then
  If DirectCast(DirectCast(e.Item.NamingContainer, Repeater).DataSource, DataView).Count = 0 Then
    DirectCast(e.Item.FindControl("lblNoCourses"), Label).Visible = True
  End If
End If 
```

# ruby - 如何编写使用 chrome 的 ruby 网络爬虫？

> ID：16068267
> 
> 赞同：1
> 
> 时间：2013-04-17T19:13:41.883
> 
> 标签：ruby, google-chrome, selenium, watir-webdriver, selenium-chromedriver

我有一个 ruby​​ 网络爬虫，目前已编码为在 Firefox 中运行。如何将其切换到 Chrome？

```
def open_browser()
  tweaked_profile = Selenium::WebDriver::Firefox::Profile.new
  tweaked_profile['nglayout.initialpaint.delay'] = 0
  tweaked_profile.assume_untrusted_certificate_issuer=false
  tweaked_profile['permissions.default.image'] = 2
  tweaked_profile['network.proxy.type'] = 1
  tweaked_profile['network.proxy.http'] = 'ec2proxy.csnzoo.com'
  tweaked_profile['network.proxy.http_port'] = 8080
  driver = Selenium::WebDriver.for :firefox, :profile => tweaked_profile
  $browser = Watir::Browser.new(driver)
end 
```

我应该放弃 watir 并使用 chromedriver 还是 watir 会为此工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:28:10.553

查看[http://watirwebdriver.com/chrome/](http://watirwebdriver.com/chrome/)，其中包含以下示例：

```
profile = Selenium::WebDriver::Chrome::Profile.new
... 
b = Watir::Browser.new :chrome, :profile => profile 
```

此外，这些 SO 问题为爬取网站提供了替代方案： Ruby 中的 Web[爬虫](https://stackoverflow.com/questions/4132595/web-crawler-in-ruby)和[哪些基于 Ruby 的优秀 Web 爬虫？](https://stackoverflow.com/questions/4981379/what-are-some-good-ruby-based-web-crawlers)

# codeigniter - 使用 CodeIgniter 在休息服务的结果中有字符 \

> ID：16068273
> 
> 赞同：0
> 
> 时间：2013-04-17T19:14:05.973
> 
> 标签：codeigniter, rest

我创建发布方法：

```
class login extends REST_Controller {

    function user_post() {

            $re = array (
                'code' => '0',
                'result' => "loi roi",
                'data' => "lp cp",

            );

            $this->response(json_encode($re));

    }

} 
```

在 c# 中使用 WebRequest 后，我​​有这个字符串：

```
"{\"code\":\"0\",\"result\":\"loi roi\",\"data\":\"lp cp\"}" 
```

但我想要的字符串： {"code":"0","re​​sult":"loi roi","data\":"lp cp"}

为什么结果有性格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:49:38.900

您似乎在对 json 对象进行双重编码。`REST_Controller::response`如果输出格式是 json（假设您使用的是[这个库](https://github.com/philsturgeon/codeigniter-restserver)），您的方法将对您提供的内容进行编码。`json_encode()`在你通过之前放下`$re`。

# ios - 核心数据查询

> ID：16068276
> 
> 赞同：2
> 
> 时间：2013-04-17T19:14:13.703
> 
> 标签：ios, core-data, nsfetchrequest

我仍在尝试围绕核心数据进行思考，并且在放弃 SQL 时遇到了麻烦。我知道它们不一样，但我发现很难重新创建我在 SQL 中可以做的事情。我希望有人可以提供帮助。

我想要做的是创建一个客户列表并返回他们当前账单的总和。我有两个实体：

客户

*   姓名
*   地址
*   ETC

计费

*   客户
*   日期
*   数量
*   ETC

我在 2 个实体之间创建了一对多的关系，并且我的 NSEntityDescription 指向客户端。

现在我想用 SQL 术语发生的是：

`SELECT *, SUM(amount) as Total FROM Clients INNER JOIN Billing......"`

*   这可以通过一个 Fetch Request 来完成，还是我会做 2 个请求然后合并它们？
*   我可以以某种方式使用 valueForKey:`@"billing.@sum.amount"`吗？

*   还有人可以为初学者推荐一本很棒的核心数据书（或网站）吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T04:21:32.303

> > 这可以通过一个 Fetch Request 来完成，还是我会做 2 个请求然后合并它们？

是的，它可以通过一个请求来完成。[看这里](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdFetching.html#//apple_ref/doc/uid/TP40002484-SW6)

```
/*UNTESTED*/
- (NSNumber*) billingSumForClient:(NSManagedObjectID*)clientId
                           context:(NSManagedObjectContext*)context
{
    NSNumber* total = nil;
    NSFetchRequest *request = [[NSFetchRequest alloc] initWithEntityName:@"Billing"];
    [request setResultType:NSDictionaryResultType];
    NSExpression *keyPathExpression = [NSExpression expressionForKeyPath:@"amount"];
    NSExpression *sumExpression = [NSExpression expressionForFunction:@"sum:"
                                                            arguments:[NSArray arrayWithObject:keyPathExpression]];
    NSExpressionDescription *expressionDescription = [[NSExpressionDescription alloc] init];
    [expressionDescription setName:@"total"];
    [expressionDescription setExpression:sumExpression];
    [expressionDescription setExpressionResultType:NSDateAttributeType];
    [request setPredicate:[NSPredicate predicateWithFormat:@"client == %@",clientId]];
    [request setPropertiesToFetch:[NSArray arrayWithObject:expressionDescription]];
    NSError *error = nil;
    NSArray *objects = [context executeFetchRequest:request error:&error];
    if (&error) {
        // Handle the error.
    } else {
        if ([objects count] > 0) {
            total = [[objects objectAtIndex:0] valueForKey:@"total"];
        }
    }
    return total;
} 
```

> > 我可以以某种方式使用 valueForKey:@"billing.@sum.amount" 吗？

是的。[请参见此处（@Daniel 链接）](https://stackoverflow.com/questions/7565425/core-data-get-sum-of-values-fetched-properties-vs-propagation)
如果您的所有帐单都已在您当前的上下文中出错，这可能会更快。

# javascript - 语法错误：JavaScript 中的非法 return 语句

> ID：16068278
> 
> 赞同：76
> 
> 时间：2013-04-17T19:14:27.480
> 
> 标签：javascript, syntax-error

运行此代码时，我遇到了一个非常奇怪的 JavaScript 错误：

```
<script type = 'text/javascript'>
var ask = confirm('".$message."');
if (ask == false)
{
    return false;     
}

else
{
    return true;
}
</script> 
```

在 JavaScript 控制台中它说：

`Syntax Error: Illegal return statement`

它发生在`return true;`和`return false;`

（我从 php 函数中呼应这个 javascript；`$message`变量是 php 参数之一）

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2013-04-17T19:16:26.243

`return`只有在函数内部才有意义。您的代码中没有函数。

另外，你的代码是值得的，如果系冗余系。假设您将其移动到适当的功能，这会更好：

```
return confirm(".json_encode($message)."); 
```

很久以后编辑：更改了`json_encode`用于确保消息内容不会仅仅因为消息中的撇号而中断的代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-17T19:18:19.063

如果你想返回一些值，那么将你的语句包装在函数中

```
function my_function(){ 

 return my_thing; 
} 
```

如果您尝试使用 PHP，则问题在于第一行的语句

```
var ask = confirm ('".$message."'); 
```

如果您尝试使用 PHP，您应该使用

```
 var ask = confirm (<?php echo "'".$message."'" ?>); //now message with be the javascript string!! 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-09-01T06:25:58.517

在 javascript return 语句中仅在功能块内使用。如果您尝试在独立的 if else 块中使用 return 语句，则会触发语法错误：JavaScript 中的非法 return 语句

这是我避免此类错误的示例代码：

```
<script type = 'text/javascript'>
(function(){
    var ss= 'no';
    if(getStatus(ss)){
        alert('Status return true');   
    }else{
        alert('Status return false'); 
    }

    function getStatus(ask){
        if(ask=='yes')
        {
        return true;     
        }
        else
        {
        return false;
        }
    }
})();
</script> 
```

请检查[Jsfiddle](http://jsfiddle.net/sunnysm/so6upLsc/)示例

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-02T18:42:54.683

你想在哪里返回值？在开发工具中进行控制台更适合调试

```
<script type = 'text/javascript'>
var ask = confirm('".$message."');
function answer(){
  if(ask==false){
    return false;     
  } else {
    return true;
  }
}
console.log("ask : ", ask);
console.log("answer : ", answer());
</script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-11T04:04:34.857

根据我的经验，此错误消息通常意味着您在某处放置了一个意外的右大括号，而将其余语句留在了函数之外。

例子：

```
function a() {
    if (global_block) //syntax error is actually here - missing opening brace
       return;
    } //this unintentionally ends the function

    if (global_somethingelse) {
       //Chrome will show the error occurring here, 
       //but actually the error is in the previous statement
       return; 
    }

    //do something
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-08-04T16:53:09.913

只是我忘了在函数之前声明“函数”这个词。es

```
myFunc(num)
{
   if(num > 0)
      return;
} 
```

这会产生“非法返回语句”错误，因为在 myFunc(num) 之前错过了“函数”

正确的形式：

```
function myFunc(num)
{
    if(num > 0)
       return;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-28T07:02:42.447

如果您对静态方法使用不正确的（旧）语法，这可能在 ES6 中发生：

```
export default class MyClass
{
    constructor()
    {
       ...
    }

    myMethod()
    {
       ...
    }
}

MyClass.someEnum = {Red: 0, Green: 1, Blue: 2}; //works

MyClass.anotherMethod() //or
MyClass.anotherMethod = function()
{
   return something; //doesn't work
} 
```

而正确的语法是：

```
export default class MyClass
{
    constructor()
    {
       ...
    }

    myMethod()
    {
       ...
    }

    static anotherMethod()
    {
       return something; //works
    }
}

MyClass.someEnum = {Red: 0, Green: 1, Blue: 2}; //works 
```

# javascript - jQuery 代码在 JSFiddle 上运行，但不在我的网络应用程序中

> ID：16068281
> 
> 赞同：2
> 
> 时间：2013-04-17T19:14:31.877
> 
> 标签：javascript, jquery, html, typeerror

我在使用 jQuery 时遇到了一个奇怪的问题。我在页面上有一组按钮，当长按时，它们会在按钮的位置弹出一个输入框。**[这是小提琴。](http://jsfiddle.net/PhDBrown/8V6pn/1/)**

**HTML**

```
<div class="popupView" id="recoveryView">
    <button class="intervalBtn" type="button" name="recovery0" id="recovery0">00:30</button>
    <button class="intervalBtn" type="button" name="recovery6" id="recovery6">00:35</button>
    <button class="intervalBtn" type="button" name="recovery1" id="recovery1">02:00</button>
    <button class="intervalBtn" type="button" name="recovery7" id="recovery7">03:00</button>
    <button class="intervalBtn" type="button" name="recovery2" id="recovery2">04:00</button>
    <button class="intervalBtn" type="button" name="recovery8" id="recovery8">05:00</button>
</div>
<input id="edit_interval" type="text" /> 
```

**CSS**

```
.popupView {
    background: #999999;
    -webkit-border-radius: 6px;
    -webkit-box-shadow: 0 0 4px #333333;
    width: 30%;
    height: 70%;
    position: absolute;
}
.intervalBtn {
    color: blue;
    background: #CCCCCC;
    -webkit-border-radius: 6px;
    width: 41%;
    height: 12.5%;
    float: left;
    margin-left: 6%;
    margin-top: 3%;
    font: 12pt sans-serif;
}
.recoveryBtn {
    color: blue;
    background: #CCCCCC;
    -webkit-border-radius: 6px;
    width: 88%;
    height: 12.5%;
    float: left;
    margin-left: 6%;
    margin-top: 3%;
    font: 12pt sans-serif;
}
.intervalBtn.selected, .recoveryBtn.selected {
    color: #CCCCCC;
    background: blue;
}
body {
    position:absolute;
    overflow: hidden;
    bottom: 0;
    left: 0;
    right: 0;
    top: 0;
    user-select: none;
    -moz-user-select: none;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}
body > div {
    -moz-box-sizing: border-box;
    -ms-box-sizing: border-box;
    -webkit-box-sizing: border-box;
}
#edit_interval {
    display: none;
    position: absolute;
} 
```

**JavaScript**

```
$(".intervalBtn").click(function () {
    $(".intervalBtn").removeClass("selected");
    $(this).addClass('selected');
}).mouseup(function () {
    clearTimeout(pressTimer);
    return false;
}).mousedown(function () {
    // Set timeout
    pressTimer = window.setTimeout(function () {
        console.log("interval button long click");

        $("#edit_interval").css("display", "block").css("left", $(this).position().left).css("top", $(this).position().top);
    }, 1000)
    return false;
}); 
```

如果在小提琴中运行，唯一的问题是盒子的位置（我是否错误地获得了左侧和顶部的位置？），但是当我在实际的网络应用程序（在 Safari 中）上进行测试时，长时间后出现以下错误点击log，出现无输入框：

> TypeError：'undefined' 不是 'in' 的有效参数（评估 't in e'）

在

> jQuery.min.js：5

所以这是一个由两部分组成的问题（重点是第 1 部分）：

1.  **为什么我会收到此错误（是错误吗？），我该如何解决？**
2.  **如何将输入框设置到正确的位置？**

**编辑**

正如评论中所建议的，我换成了`jquery.min.js`，`jquery.js`并且有一个更容易调试的错误：

> TypeError：'undefined' 不是 'in' 的有效参数（评估 'name in style'）

在第 6643 行。这是来自的代码`jQuery.js`：

```
// return a css property mapped to a potentially vendor prefixed property
function vendorPropName( style, name ) {

    // shortcut for names that are not vendor prefixed
    if ( name in style ) {   //<---This is the line that causes the error
        return name;
    }

    // check for vendor prefixed names
    var capName = name.charAt(0).toUpperCase() + name.slice(1),
        origName = name,
        i = cssPrefixes.length;

    while ( i-- ) {
        name = cssPrefixes[ i ] + capName;
        if ( name in style ) {
            return name;
        }
    }

    return origName;
} 
```

这是否意味着 jQuery 找不到*左侧*和*顶部*的 CSS 属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:35:40.453

对于您问题的第 2 部分，您`this`不是`this`您所期望的，因为它在`window.setTimeout()`函数内部。您需要`this`在`setTimeout()`. 相关代码如下。[我在这里](http://jsfiddle.net/8V6pn/2/)更新了你的小提琴。请注意，[位置](http://api.jquery.com/position/)函数不考虑边距或填充。

```
var pos = $(this).position();

// Set timeout
pressTimer = window.setTimeout(function() 
{ 
    console.log("interval button long click");

    $("#edit_interval").css({"left": pos.left + 'px', "top": pos.top + 'px'}).show();
},1000)
return false; 
```

# java - 反序列化 json 并分隔换行符 NDJ

> ID：16068283
> 
> 赞同：2
> 
> 时间：2013-04-17T19:14:33.030
> 
> 标签：java, json, gson

我有一个简单的 JSON 文件，我想使用 gson 和 Java 解析（units.json）：

```
{"user_name": "happyman", "status": {"hp": 20, "karma": 7, "mp": 10}, "gold": 5.25,}
{"user_name": "sadman", "status": {"hp": 10, "karma": 2, "mp": 6}, "gold": 0.5,}
... 
```

我遇到的问题是，我如何解析这个文件，因为它不是数组格式？

目前我有一个 Filereader 到 JsonReader 调用的路径

```
FileReader fileReader = new FileReader(jsonFilePath);
JsonReader jsonReader = new JsonReader(fileReader);
jsonReader.beginObject();
while (jsonReader.hasNext()) {
    String name = jsonReader.nextName();
    if (name.equals("user_name")) {
        System.out.println("user_id: "+jsonReader.nextString());
    }
    //...checks for other equals 
```

但是，使用此代码，我只能获得第一行。我有一种感觉，这与“hasNext()”不是 while 循环中正确的方法调用有关。

感谢您的帮助！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:34:24.153

您可以将此代码与 GSON 库一起使用：

```
ObjectMapper mapr = new ObjectMapper();
Map<String,Object> map = mapr.readValue(jsonString, Map.class); 
```

或者

```
public class Units {
  @JsonProperty("user_name")
  public String user_name;

  @JsonProperty("status")
  public List<Attr> attrs;

  ..
}
public class Attr {
  @JsonProperty("hp") 
  public String hp;
  @JsonProperty("karma") 
  public String karma;
  @JsonProperty("mp") 
  public String mp;
}

ObjectMapper mapr = new ObjectMapper();
Units unit = mapr.readValue(jsonString, Units.class); 
```

对于两者，您都可以使用 jsonString 来定义文件中的每个 json 单元。

# android - 使用相机时收集光强度数据

> ID：16068284
> 
> 赞同：2
> 
> 时间：2013-04-17T19:14:33.097
> 
> 标签：android, camera, android-sensors

我正在开发一个在后台服务中收集光强度的应用程序。在此应用程序中，允许用户通过打开意图来扫描条形码并显示相机。然而，从用户打开意图的那一刻起，直到他关闭它，光传感器停止收集数据。请问有什么方法可以让我在使用相机的同时继续收集数据吗？

# javascript - JavaScript nodejs mysql，循环查询

> ID：16068290
> 
> 赞同：3
> 
> 时间：2013-04-17T19:14:48.613
> 
> 标签：javascript, mysql, node.js

我现在觉得有点傻。我对nodejs和javaScript相当陌生，无法弄清楚这一点。我想这是因为对 mysql 的查询的异步性质......

我做了一个例子来说明我的问题。我只想循环处理一些 sql 查询并对结果进行处理。为了这个例子，我只是打印出一些东西。我知道我可以使用这样的单个 sql 查询，`"SELECT id, name FROM player WHERE id IN (1,2,3,4,5)"`但这在我尝试编写的实际应用程序中是不可能的。

这是我的 nodejs app.js 的相关部分

```
var mysql = require("mysql");
var mysqlPool = mysql.createPool(conf.mysqlArbData);

for (var i = 0; i<5; i++){

    mysqlPool.getConnection(function(err, connection) {

        var detailSql = "SELECT id, name FROM player " +
            "WHERE id = "+i;
        if (err){
            throw err;
        }
        connection.query(detailSql, function(err, detailRows, fields) {
            connection.end();
            console.log("detailSql="+detailSql);
            if (err){
                console.log("can't run query=" + detailSql +"\n Error="+err);
            }
            else{

                console.log(detailRows[0].id + " " +detailRows[0].name);

            }

        });
    });

}; 
```

现在输出：

```
web server listening on port 3000 in development mode
detailSql=SELECT id, name FROM player WHERE id = 5
5 Jyvaskyla
detailSql=SELECT id, name FROM player WHERE id = 5
5 Jyvaskyla
detailSql=SELECT id, name FROM player WHERE id = 5
5 Jyvaskyla
detailSql=SELECT id, name FROM player WHERE id = 5
5 Jyvaskyla
detailSql=SELECT id, name FROM player WHERE id = 5
5 Jyvaskyla 
```

我的问题是，为什么我只得到 id=5 的数据库条目的结果？为了在回调中接收每个单独的结果，需要更改什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:06:27.127

问题是它`getConnection`是异步的*，并且*Javascript 没有块作用域，这意味着在调用回调时`getConnection`，`i`变量将指向它在循环中的最后一个值（即 5）。

您可以使用技巧为循环的每一轮创建一个部分函数（将其视为已应用第一个参数的函数），它将当前值`i`作为`getConnection`回调的第一个参数传递：

```
for (var i = 0; i<5; i++) {
  mysqlPool.getConnection(function(i, err, connection) {
    ...
  }.bind(mysqlPool, i));
}; 
```

FWIW，您的代码将几乎立即打开到您的数据库的 5 个连接（并执行 5 个查询）（这就是异步 I/O 的工作方式）。这可能不是一个大问题，但如果它`5`可以变得更高，这是值得实现的:)

此外，for 循环将生成`[0, 1, 2, 3, 4]`，而在您的示例查询中，您编写`WHERE id IN (1, 2, 3, 4, 5)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-24T10:54:57.870

对于节点，您可以使用[let](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let)语句。它限制`i`了 for 循环的范围。

```
for (let i = 0; i<5; i++) {
  mysqlPool.getConnection(function(err, connection) {
    console.log(i);
  });
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-30T20:25:50.203

这就是我一直在做的。它适用于包含 50,000 多个项目的`UPDATE`AND语句。`INSERT`

```
const mysql = mysql.createConnection({
  host     :   'HOST',
  user     :   'USER',
  password :   'PASSWORD',
  database :   'DATABASE_NAME',
  port     :   PORT,
  ssl      :   { ca : fs.readFileSync(process.cwd() + '/ssl/certs/ca-certificate.crt') },
});

async function processRequest(itemArray) {

  //pre-processing of array (if needed...)

  // initialize sql connection
  mysql.connect();

  const startProcess = await processItems(itemArray)
    .catch(e => {
      // end sql connection if there was an error running startProcess
      mysql.end();
      throw new Error(`Error @ startProcess: ${e}`);
    })

  // end sql connection after startProcess is finished
  mysql.end();

  // optional return of startProcess. This occurs after processItems is done.
  try {

    if (startProcess.status == 'success') {
      return {status: 'success', msg: 'function startProcess has compelted.';
    }

  }

  catch (e) {
      return {status: 'error', msg: 'function startProcess did not complete.', error: e;
  }

  function processItems(array){

    return new Promise((resolve,reject) => {

      for (let i in array) {

        // perform DB operations inside loop
        mysql.query(`UPDATE db SET ?`, array, (err, results, fields) => {
          // exit if there's any sort of error
          if (err) reject(err)
        })

      }

    // resolve promise after loop completes
    resolve({status: 'success'});

    })

  };

}
```

**这是工作流程：**

1.  mysql连接打开（通过`mysql.connect()`）
2.  `processRequest`被调用（在我的情况下，它是从 a 调用的`Route`）
3.  该`processItems`函数被调用`asynchronously`
4.  `processItems`返回一个`promise`
5.  `processItems`在它解决或拒绝它的地方完成
6.  mysql 连接已关闭（通过`mysql.end()`）

# php - 显示来自 blob 字段 php 的相同图像

> ID：16068291
> 
> 赞同：0
> 
> 时间：2013-04-17T19:14:50.030
> 
> 标签：php, html, css

```
<?php
while($query_row2=mysql_fetch_array($result))
    {
    $res=mysql_query("SELECT * FROM images WHERE er='".$query_row2['er']."' ORDER BY `sr` DESC") or die ("Error");
    $q=mysql_fetch_array($res);
    $_SESSION["id1"]=$q['iname'];
?>

     <img src="xyz.php" height="50" width="100"/>
<?php

    }
?> 
```

xyz.php 包含：

```
<?php
include("connection.php");
session_start();
$z= $_SESSION["id1"];
header ("Content-type:image");
echo $z;
?> 
```

此代码显示为第一个 $query_row2['er'] 存储的相同图像......并且所有图像都显示相同..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:39:52.110

The behavior you encounter is normal: first, the page listing all the images is executed, so at the end, $_SESSION["id1"] will contain the content of the last image.

I would not use the session, and change your loop to:

```
while($query_row2=mysql_fetch_array($result)) {
    ?><img src="xyz.php?er=<?=urlencode($query_row2['er'])?>" height="50" width="100"/><?
} 
```

and xyz.php to do the query to get the image content, so something like:

```
<?php
include("connection.php");
$res=mysql_query("SELECT * FROM images WHERE er='".mysql_real_escape_string($_GET['er'])."'");
$q=mysql_fetch_array($res);
$z = $q['iname'];
header ("Content-type:image");
echo $z;
?> 
```

# eclipse - 我可以在 Eclipse 的 Ant 视图中共享构建文件列表吗？

> ID：16068292
> 
> 赞同：0
> 
> 时间：2013-04-17T19:14:52.093
> 
> 标签：eclipse

Intellij IDEA 在工具窗口的树形视图中显示 ant 构建文件。文件列表和任何额外的参数（例如内存等）都保存在 .idea/ant.xml 文件中，我将其签入到版本控制中，以便在签出项目时清楚地知道构建什么/如何构建。

有关在此文件中列出多个构建文件的项目示例，请参见[此处（请注意所有内容与项目目录的关系）。](https://github.com/JetBrains/intellij-scala/blob/master/.idea/ant.xml)

Eclipse 有一个类似的[Ant View](http://help.eclipse.org/juno/index.jsp?topic=/org.eclipse.platform.doc.user/gettingStarted/qs-85a_ant_view.htm)，但我看不到配置的存储位置。我宁愿不必告诉每个新开发人员“在签出项目后将这 3 个 xml 文件拖到 ant 视图中”。

eclipse 是否有一个等效的 .idea/ant.xml 可以签入版本控制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:24:11.340

您可以创建一个运行 Ant 的“外部构建”配置，并且可以将该配置设置为驻留在可以存储在 VC 系统中的外部文件中。

**1**

在 Eclipse 中，这会调出菜单

```
Run > External Tools > External Tools Configuration 
```

**2**

创建一个 Ant 构建并指定要运行的所有参数和目标。（您也可以通过编辑 build.xml 文件、查看大纲视图并右键单击目标并选择来执行此操作`Run as ... > Ant build ...`）

**3**

然后使用它来创建受版本控制的文件。

```
Common > Save As "Shared File" and[ browse to a folder in your workspace] 
```

**4**

您以这种方式创建的那些文件可以通过右键单击并选择来启动`"Run as ..."`

# c# - 从服务中使用 UIAutomation

> ID：16068294
> 
> 赞同：1
> 
> 时间：2013-04-17T19:14:54.687
> 
> 标签：c#, .net, microsoft-ui-automation

我有使用 UIAutomation 的代码，可以在控制台应用程序中找到，但我需要它作为服务运行。该服务负责确保 3 个 exes 在给定的机器上运行并且配置正确。用 C++ 编写的 exe 没有 COM 或 .net 入口点。

```
var k = Process.GetProcessesByName("genericEXE");
                foreach (var win in k)
                {
                    List<string> scol = new List<string>();

                    AutomationElement cpc = AutomationElement.RootElement.FindFirst(TreeScope.Children, new PropertyCondition(AutomationElement.ProcessIdProperty, win.Id));
                    if (cpc == null)
                        continue;
                    WalkEnabledElements(cpc, scol);
                    if (scol.Contains("COM1") && scol.Contains("COM2") && scol.Contains("COM3") && scol.Contains("COM4") && scol.Contains("COM5"))
                        foundCom1 = true;
                    if (scol.Contains("COM6") && scol.Contains("COM7") && scol.Contains("COM8") && scol.Contains("COM9") && scol.Contains("COM10"))
                        foundCom6 = true;
                    if (scol.Contains("COM11") && scol.Contains("COM12") && scol.Contains("COM13") && scol.Contains("COM14") && scol.Contains("COM15"))
                        foundCom11 = true;

                }

static void WalkEnabledElements(AutomationElement rootElement, List<string> col)
        {
            TreeWalker walker = new TreeWalker(Condition.TrueCondition);
            AutomationElement elementNode = walker.GetFirstChild(rootElement);
            while (elementNode != null)
            {
                Console.WriteLine(elementNode.Current.Name);
                col.Add(elementNode.Current.Name);
                WalkEnabledElements(elementNode, col);
                elementNode = walker.GetNextSibling(elementNode);
            }
        } 
```

我尝试以在此运行时登录的同一用户身份运行该服务，尝试在打开交互 w/ 桌面位的情况下作为本地服务运行。我从来没有从

```
AutomationElement cpc = AutomationElement.RootElement.FindFirst(TreeScope.Children, new PropertyCondition(AutomationElement.ProcessIdProperty, win.Id)); 
```

线。有人知道我需要做些什么不同的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:45:48.407

如果您运行的是 Vista 或更高版本，那么出于安全原因，服务总是在会话 0 中创建，该会话与任何用户会话都是分开的。您不能共享 UI 元素或在会话之间来回发送消息，这可能是您的自动化工具无法正常工作的原因。仅仅因为服务作为特定用户运行并不意味着它的进程在同一个会话中运行。即使没有人登录，服务也必须继续运行，因此必须在自己的会话中创建它们。

作为一种解决方法，我认为`CreateProcessAsUser`可以用来在用户会话中生成另一个进程。然后，您需要使用进程间通信（例如通过管道的 WCF）从您的服务中对其进行操作。听起来很乱。更好的选择可能是忘记该服务并坚持使用控制台应用程序。

# ruby - 将 OpenSSL IV 转换为十六进制？

> ID：16068298
> 
> 赞同：1
> 
> 时间：2013-04-17T19:15:03.847
> 
> 标签：ruby, encryption, openssl, aes

我正在开发一种将 AES-128 加密应用于 HLS 流的工具。到目前为止，这是我的 Ruby 代码：

```
aes = OpenSSL::Cipher::AES.new(128, :CBC)
aes.encrypt
aes_key = aes.random_key
aes_iv = aes.random_iv 
```

现在，当我输出 aes_iv 时，它给了我很明显只是我的 shell 环境难以转换为文本的二进制数据。那讲得通。我需要将其转换为十六进制表示。

IV 必须在 HLS 清单文件中指明，如下所示：

```
#EXT-X-KEY:METHOD=AES-128,URI="crypt0.key",IV=0xdc03cfac7ea13f69dd49c1411c14c264 
```

该行的 IV 属性描述如下：

*“该值是一个十六进制整数，它指定要与密钥一起使用的初始化向量。IV 属性出现在协议版本 2 中。”*

我有两个问题：

1.  如何确定 random_iv 设置的 IV 与 HLS 规范兼容？
2.  如何将二进制 IV 输出从 random_iv 转换为所需的十六进制值？

我试过这样做：

`aes_iv.unpack("H*")`和`aes_iv.unpack("h*")`，它返回类似“4b56da546d807eb0870170b4e03d77dd”的东西，这似乎是正确的。但是，当我将其指定为 IV 时，无法播放视频。

我已将问题隔离到 IV，就好像我没有调用 random_iv 并指定“000000000000000000000000000000000”的 IV，它可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:09:02.950

好的，看起来我可以使用 aes_iv.unpack("H*") 让它工作。我想我正在查看早期失败试验的一些较旧的视频文件。

我对为什么 H* 有效而 h* 无效一无所知。我看到这里有一个描述：http: [//apidock.com/ruby/String/unpack](http://apidock.com/ruby/String/unpack)，它解释了低半字节与高半字节的区别，但不确定这里有什么区别。

# c++ - OpenCV C++ 接口和 Qt 框架

> ID：16068300
> 
> 赞同：0
> 
> 时间：2013-04-17T19:15:16.683
> 
> 标签：c++, qt, opencv, interface, crash

我一直在使用 OpenCV 创建我需要制作的项目。我制作了一个功能齐全的控制台应用程序，现在想让它更加图形化（添加一个 GUI）。我为此使用Qt。

一切都很顺利，我开始接触 Qt 编程，但后来发生了一些奇怪的事情。当我从 Qt 项目中调用我的一些函数时，我遇到了奇怪的崩溃。由于某种原因，某些 opencv 函数在从“qt 项目”调用时会失败。函数包括 split、findChessboardcorners、cornerSubPix、...

有人知道为什么会发生这种情况吗？我正在使用 OpenCV 2.4.2 和 Qt 4.8.4。我正在使用opencv的C++接口。

任何帮助将不胜感激。

编辑：我使用的是 Windows 7、64 位。IDE 是 Visual Studio 2010。

亲切的问候，菲利普

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:55:38.290

我使用与您相同的配置，但我的项目是 MakeFile 项目。

作为 NMAKE 的项目属性：

构建命令行：

```
$(QTDIR)\bin\qmake 
```

重建所有命令行：

```
$(QTDIR)\bin\qmake -project
nmake debug-clean
nmake debug 
```

清洁命令行：

```
$(QTDIR)\bin\qmake
nmake debug-clean 
```

请务必以相同的格式使用 Qt 和 OpenCV。我使用 OpenCV 编译教程在 x64 中编译了这两个教程，而这个是为 Qt 编译的：[如何为 Visual Studio 2010 构建 Qt](https://stackoverflow.com/questions/5601950/how-to-build-qt-for-visual-studio-2010)

# php - 如何找到哪个 PHP 脚本正在泄漏内存？

> ID：16068301
> 
> 赞同：35
> 
> 时间：2013-04-17T19:15:19.660
> 
> 标签：php, memory-management, memory-leaks

我的专用服务器有 32GB 内存，内存不断增加，我现在必须每天重新启动它。这让我付出了客户和金钱的代价。

我很难找到内存泄漏的位置。我在网上只能找到人们说“使用 xdebug”，但我找不到任何有关查找内存泄漏的 xdebug 教程。我曾尝试在函数调用之前和之后打印 memory_get_usage 但这是正确的方法吗？

我有许多 php 脚本正在运行 - 一些来自访问者，另一些来自 cron 作业 - 我需要找到其中哪些正在泄漏内存并尽快修复它，但我什至不知道如何确定给定函数是否是是否泄漏内存。

我曾尝试在函数调用之前和之后打印 memory_get_usage，它会上升，但是如果我多次调用该函数，它就不会再上升了。有人可以解释一下并告诉我如何简单轻松地判断 PHP 函数是否存在内存泄漏？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-26T17:26:28.637

你可以做各种各样的事情，但首先你应该尽量避免首先产生内存泄漏。

让我澄清一下：PHP 是一种脚本语言，它不是为长时间运行的脚本而设计的，因此它的内存管理并不是市场上最好的。但为什么会这样呢？它的目的是在请求级别上调用，因此它的运行范围非常小（不超过 2 - 3 秒）。其他一切都应该放在后台。

我能做些什么来防止内存泄漏？

1.  如果您的版本低于 5.4，则需要注意循环引用，因为这些不是垃圾收集的。

2.  如果您需要连续运行脚本，您可能会考虑另一种方法。尝试一个`while(true)`实现，但是将`supervisor`（[http://supervisord.org](http://supervisord.org)）包裹在你的脚本周围，让它在它结束后被调用。这样你就可以 100% 确保你永远不会发生内存泄漏。

3.  您可以使用`xdebug`一个一个来分析您的脚本并找出消耗大量内存的地方。

4.  如果不再需要该类，您可以实现一个析构函数来取消设置所有引用。

    ```
    public function __destruct(){
        $this->cleanup();
    }

    public function cleanup() {
        //cleanup everything from attributes
        foreach (get_class_vars(__CLASS__) as $clsVar => $_) {
            unset($this->$clsVar);
        }

        //cleanup all objects inside data array
        if (is_array($this->_data)) {
            foreach ($this->_data as $value) {
                if (is_object($value) && method_exists($value, 'cleanUp')) {
                    $value->cleanUp();
                }
            }
        }
    } 
    ```

5.  阅读有关垃圾收集的 PHP 文档[http://us3.php.net/manual/en/features.gc.php](http://us3.php.net/manual/en/features.gc.php)

6.  避免使用全局变量，因为它们永远不会被垃圾收集并且需要`unset`显式地收集。如果您使用 ZF 或 Symfony 之类的框架，这可能是不可能的，因为这样做会破坏功能。

最后但同样重要的是，我想**再次强调**，PHP 不适合长时间运行的脚本！如果你有事情要做，需要持续运行，你不应该因为 PHP 的内存泄漏而崩溃，而是花时间学习更复杂的语言，如 JAVA 或 C#。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-07-01T18:52:26.097

看看这个 php 扩展：[https](https://github.com/arnaud-lb/php-memory-profiler) ://github.com/arnaud-lb/php-memory-profiler 。您可以转储不同格式的信息并通过一些工具进行简单分析，例如：[Google Performance Tools](https://code.google.com/p/gperftools/downloads/list)、[KCacheGrind](http://kcachegrind.sourceforge.net/html/Home.html)或[QCacheGrind](https://www.google.com/search?q=qcachegrind)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-03-29T15:30:38.257

我发现对我来说效果很好的方法：

1.  安装“ [php-memprof](https://github.com/arnaud-lb/php-memory-profiler) ”扩展。你可以在 Ubuntu 中运行：

    `sudo pecl install memprof`

2.  安装“ [google-perftools](https://github.com/gperftools/gperftools) ”。再次为 Ubuntu：

    `sudo apt-get install google-perftools`

3.  将此代码添加到脚本的开头：

    ```
    if (function_exists('memprof_enable')) {
        memprof_enable();
    } 
    ```

4.  而这个周围的地方是你期望找到内存泄漏的：

    ```
    if (function_exists("memprof_dump_pprof"))
    {
        $time = microtime(true);
        $f = fopen("/tmp/profile_$time.heap", "w");
        memprof_dump_pprof($f);
        fclose($f);
        echo "Memory profile dumped. ";
    } 
    ```

    在我的情况下，它每 100 次运行就在一个大周期内。

5.  运行`google-pprof`比较 2 个内存转储：

    ```
    google-pprof --web --base=/tmp/profile_17.heap /tmp/profile_18.heap 
    ```

    这将在您的浏览器中打开像这样的 svg 图像：

    ![来自文档的样本](https://i.stack.imgur.com/0h8Qp.png)

    您可以在[gperftools 文档中找到内部数字和名称的描述](https://gperftools.github.io/gperftools/heapprofile.html)

**PS**修复 php 级别的泄漏并不能保证解释器中没有内存泄漏。就我而言，我最终只是在更长的时间内重新启动 stipt。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-03T14:33:11.553

我不是内存使用方面的专家，但也许这种方法可以帮助您检测有问题的脚本：

获取信息： 1\. 使用 apache 访问日志文件 2\. 创建您自己的内存使用日志文件 ( [http://www.webhostingtalk.com/showthread.php?t=617742](http://www.webhostingtalk.com/showthread.php?t=617742) )

检查内存使用量上升的时间并与 apache 访问日志进行比较。

它至少会为您提供有关使用量是否缓慢而持续上升或是否从某个点开始的信息。

祝你好运！

# postgresql - PostgreSQL有没有办法将结果平均到有限数量的最终结果？

> ID：16068303
> 
> 赞同：2
> 
> 时间：2013-04-17T19:15:22.567
> 
> 标签：postgresql

让我尝试通过示例来解释我的意思：

我正在使用 PostgreSQL 版本 9.2.1

数据结构如下：

```
(timedate)date           | (float) data    |  ...
"2013-03-23 03:58:00-04" | 66819.59        |  ...
"2013-03-23 03:59:00-04" | 64277.22        |  ...
"2013-03-23 03:59:00-04" | 46841.75        |  ...
"2013-03-23 04:00:00-04" | 69697.38        |  ...
"2013-03-23 04:00:00-04" | 69452.69        |  ...
"2013-03-23 04:01:00-04" | 69697.47        |  ... 
```

我的表有超过 500 万个数据点。我已经知道如何在开始和结束日期范围内获取数据。

**这是我的问题**：当范围太大时，假设它涵盖了整个数据，它将返回所有 500 万行，我想限制它返回的行而不省略任何数据。

例如，如果我想返回 5 行，我希望第一行是前一百万行数据的平均值。第二行是第二百万行数据的平均值，以此类推。（显然这个例子有点极端，我只是夸大了试图传达我需要做的事情）

感谢您的帮助和建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:21:00.987

如果你想要一天的平均值：

```
select
    date_trunc('day', "date")::date "day",
    avg("data") "data"
from t
group by 1
order by 1 
```

`'day'`随心所欲地改变`'month'`或改变`'week'`。

[http://www.postgresql.org/docs/current/interactive/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC](http://www.postgresql.org/docs/current/interactive/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC)

如果您真的想将数据按日期划分为 5 个块：

```
select
    floor(
        (row_number() over(order by "date"))::double precision
        * 5
        / (select count(*) from t)
    ) chunk,
    avg("data") "data"
from t
group by 1
order by 1 
```

# c# - OAuthWebSecurity.CreateOrUpdateAccount 生成 FOREIGN KEY 约束异常

> ID：16068305
> 
> 赞同：0
> 
> 时间：2013-04-17T19:15:24.360
> 
> 标签：c#, asp.net-mvc, oauth

在过去的几个小时里，我一直在尝试在我的 MVC 4 网站中添加 facebook 登录。

到目前为止，“本地帐户注册”（ WebSecurity.CreateAccount() 运行良好。

在我的业务逻辑中，我的代码如下所示：

```
public ValidationReturn<User> AddUser(User data, string provider, string providerUserId)
{
....

Repository.Insert(data);
SaveChanges();

OAuthWebSecurity.CreateOrUpdateAccount(provider, providerUserId, data.LoginName); 
```

现在，当我尝试创建这样的帐户时， OAuthWebSecurity.CreateOrUpdateAccount 抛出异常：

> INSERT 语句与 FOREIGN KEY 约束“FK_dbo.webpages_OAuthMembership_dbo.webpages_Membership_UserId”冲突。冲突发生在数据库“Wims”、表“dbo.webpages_Membership”、列“UserId”中。

我在我的 UserTable 中看到我的用户，并且我了解查看 db 方案为什么它崩溃......但我不知道原因...... OAuthWebSecurity.CreateOrUpdateAccount 是否也应该在 pages_Membership 中创建记录？如果是这样，密码呢？

我一直在网上查看几个这样的教程： [http](http://www.asp.net/mvc/tutorials/mvc-4/using-oauth-providers-with-mvc) ://www.asp.net/mvc/tutorials/mvc-4/using-oauth-providers-with-mvc或[http://www.asp。 net/web-pages/tutorials/security/16-adding-security-and-membership](http://www.asp.net/web-pages/tutorials/security/16-adding-security-and-membership) ，我看不出我在这里缺少什么...

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T11:36:27.270

对我来说，我发现会员模型的代码在 OAuthMembership 上有一个外键，返回到 Membership 表。这是不正确的，因为您可以使用 OAuthMembership 登录，而无需本地成员资格记录。我不得不注释掉以下几行：

```
[Table("webpages_Membership")]
public class Membership
{
    public Membership()
    {
        Roles = new List<Role>();
        //OAuthMemberships = new List<OAuthMembership>();
    }

    [Key, DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int UserId { get; set; }
    public DateTime? CreateDate { get; set; }
    [StringLength(128)]
    public string ConfirmationToken { get; set; }
    public bool? IsConfirmed { get; set; }
    public DateTime? LastPasswordFailureDate { get; set; }
    public int PasswordFailuresSinceLastSuccess { get; set; }
    [Required, StringLength(128)]
    public string Password { get; set; }
    public DateTime? PasswordChangedDate { get; set; }
    [Required, StringLength(128)]
    public string PasswordSalt { get; set; }
    [StringLength(128)]
    public string PasswordVerificationToken { get; set; }
    public DateTime? PasswordVerificationTokenExpirationDate { get; set; }

    public ICollection<Role> Roles { get; set; }

    //[ForeignKey("UserId")]
    //public ICollection<OAuthMembership> OAuthMemberships { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:38:30.177

好的，我刚刚发现...我使用代码第一类来声明系统在初始化 simplemembership 时创建的表的结构...（因为我需要将角色放在一个对象中以从网站管理它）

例子：

```
 [Table("webpages_OAuthMembership")]
    public class OAuthMembership
    {
        [Key, Column(Order = 0), StringLength(30)]
        public string Provider { get; set; }

        [Key, Column(Order = 1), StringLength(100)]
        public string ProviderUserId { get; set; }

        public int UserId { get; set; }

        //[Column("UserId"), InverseProperty("OAuthMemberships")]
        //public Membership User { get; set; }
    } 
```

一些FK错了..耶稣....

希望它会帮助某人

# scala - 有没有办法区分案例类和元组？

> ID：16068307
> 
> 赞同：3
> 
> 时间：2013-04-17T19:15:33.597
> 
> 标签：scala

我想知道是否有一种方法可以在不列出 22 个选项的情况下区分隐式转换`TupleN`？

```
implicit def forTuple[A <: Product](a:A) = createForTuple(a)
implicit def forCaseClass[A](a:A) = createForCaseClass(a) 
```

为案例类选择该`forTuple`方法是因为它们也扩展了产品。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-06T02:22:10.733

您可以使用反射来执行此操作，如下所示（如果您使用的是 scala 版本 2.10）：

```
import scala.reflect.runtime.universe._

def forEither[P <: Product : TypeTag](product: P) = {
  if (typeOf[P].typeSymbol.asClass.isCaseClass) forCaseClass(product)
  else forTuple(product)
} 
```

# php - 带有 $_SESSION 或引号的 mysql_query

> ID：16068309
> 
> 赞同：0
> 
> 时间：2013-04-17T19:15:36.167
> 
> 标签：php

我对此感到有些悲伤，希望能得到一些帮助。我尝试了以下方法：

```
$result = mysql_query("SELECT this FROM that WHERE tFirstName = $_SESSION['FirstName'] And tLastName = $_SESSION['LastName']"); 
```

但我收到错误“意外的 T_ENCAPSED_AND_WHITESPACE，期待 T_STRING 或 T_VARIABLE”。

我尝试了多种在会话变量周围使用双引号和单引号的方法，但似乎总是发现错误。

最终我放弃了，并事先将它们设置为 $fn 和 $ln - 然后在查询中使用它：

```
$result = mysql_query("SELECT this FROM that WHERE tFirstName = '$fn' And tLastName = '$ln'"); 
```

这工作得很好......直到我遇到一个姓 O'Reilly 的用户，现在他们名字中的单引号打破了它！

帮助！知道我如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:20:42.243

在 SQL 查询中使用变量之前，您需要对它们进行**转义！**如果不这样做，可能会发生坏事（SQL 注入！¹）。由于您使用的是`mysql_`，因此您可以执行此操作。

```
$fn = mysql_real_escape_string($_SESSION['FirstName']);
$ln = mysql_real_escape_string($_SESSION['LastName']);

$result = mysql_query("SELECT this FROM that WHERE tFirstName = '$fn' And tLastName = '$ln'"); 
```

这*正是**停止*使用`mysql_`并切换到`PDO`（或）的原因`mysqli`！有了这些，您可以使用“准备好的查询”，而不必担心再次转义（它会为您完成）。请看这个页面：[http ://us2.php.net/manual/en/mysqlinfo.api.choosing.php](http://us2.php.net/manual/en/mysqlinfo.api.choosing.php)

切换后，您需要[`$mysqli->prepare`](http://php.net/manual/en/mysqli.prepare.php)或[`$dbh->prepare`](http://php.net/manual/en/pdo.prepare.php)。

[¹有关 SQL 注入的信息，请参阅：http: [//bobby-tables.com/](http://bobby-tables.com/)]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:22:29.607

你应该在你的输入上使用类似[mysqli_real_escape_string](http://www.php.net/manual/en/mysqli.real-escape-string.php)的东西：

```
$fn = mysqli_real_escape_string($link,$_SESSION['FirstName']);
$ln = mysqli_real_escape_string($link,$_SESSION['LastName']); 
```

or`$link`返回的链接标识符在哪里。然后：`mysqli_connect()``mysqli_init()`

```
$result = mysqli_query($link, "SELECT this FROM that WHERE tFirstName = '$fn' And tLastName = '$ln'"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T19:22:31.940

首先，我将再次重复自己并说这一点 - 你不应该使用 PHP`mysql_*`函数，因为它们已被弃用。请考虑切换到 mysqli 或 PDO。

现在，您的查询的问题在于您无法确保用户无法将恶意代码注入您的数据库。由于撇号，查询不适用于姓氏“O'Reilly” `'`。它破坏了 MySQL 查询。
在将数据插入数据库之前，请使用类似`htmlspecialchars()`和的函数`mysql_real_escape_string()`（如果您仍然坚持使用`mysql_*`）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T19:23:14.810

`mysql_real_escape_string`您可以使用或 using解决此问题`PDO`。

mysql_real_escape_string：

```
$str = mysql_real_escape_string($str); 
```

PDO：

```
 // make a connection using mysql on PDO
 $dbh = new PDO('mysql:host=localhost;dbname=test', $user, $pass);
 // make a query using params :fn and :ln
 $stmt = $dbh->prepare("SELECT this FROM that WHERE tFirstName = :fn And tLastName = :ln");
 // bind value to these params
 // when binding params, PDO automaticaly escape it and quote it, it's the most safe way to avoid SQL Injection.
 $stmt->bindParam(':fn', $fn);
 $stmt->bindParam(':ln', $ln);
 // execute the created statement
 $stmt->execute();
 // fetch data from statement
 $data = $stmt->fetchAll(PDO::FETCH_ASSOC);
 // dump data
 sprintf("<pre>%s</pre>", printr($data,true)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T19:19:41.410

要转义单引号，`mysql_real_escape_string()`请在将变量放入查询之前使用。

```
$result = mysql_query("SELECT this FROM that WHERE tFirstName = '".mysql_real_escape_string($fn)."' And tLastName = '".mysql_real_escape_string($ln)."'"); 
```

第一个查询的正确语法（现在没有转义......）：

```
$result = mysql_query("SELECT this FROM that WHERE tFirstName = {$_SESSION['FirstName']} And tLastName = {$_SESSION['LastName']}"); 
```

# ruby-on-rails-3 - 找不到没有 ID 的列表

> ID：16068311
> 
> 赞同：0
> 
> 时间：2013-04-17T19:15:51.257
> 
> 标签：ruby-on-rails-3, activerecord

我有一个名为 Listings 的资源和一个名为 email 的资源

列表 has_many :emails email belongs_to :listing

我正在尝试将列表 ID 传递给 email.listing_id 但我不断收到此错误：

```
Couldn't find Listing without an ID ActiveRecord::RecordNotFound in EmailsController#create 
```

这是我的代码：

```
class EmailsController < InheritedResources::Base
    def new
        @listing = Listing.find(params[:listing_id])
        @email = Email.new

    end

    def create
        @listing = Listing.find(params[:listing_id])
        @email = Email.new(params[:email])
        @email.user_id = current_user.id

    end 
```

从我的列表显示页面我传递了listing.id

```
<%=link_to "Email Listing", new_email_path(:listing_id => @listing.id) 
```

电子邮件_form

```
 <%= f.input :email %>
  <%= f.input :message %>
  <%= f.hidden_field :listing_id, :value => @listing.id %>
  %= f.button :submit, :value=> "Send Email" %> 
```

参数：

```
"email"=>{"email"=>"xyz@z.com",
 "message"=>"hello",
 "listing_id"=>"3"},
 "commit"=>"Send Email"} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:51:59.640

其实很简单..你的参数是

`params[:email][:listing_id]`不是`params[:listing_id]`。

啊，答案被删除了，您在其中复制粘贴了您要发送的参数，所以我不再证明是这种情况，但是从您粘贴在那里的内容来看，参数似乎是形式

只是改变

`@listing = Listing.find(params[:listing_id])`

至

`@listing = Listing.find(params[:email][:listing_id])`

顺便说一句，还有很多需要改进的地方......

第一个。您可以使用嵌套资源，因此您不必关心放置 hidden_​​input。其次，您可以创建一个 before_filter 方法来获取正确的 @listing 并使用 @listing.emails.build 正确设置关系。

# c++ - 仅为一种小部件设置样式

> ID：16068314
> 
> 赞同：3
> 
> 时间：2013-04-17T19:16:01.513
> 
> 标签：c++, qt

如何全局更改一种特定类型小部件的样式？由于那个漂亮的边框，我想让所有 QGroupBox 实例都使用“plastique”样式：

左边是 GTK 风格（我不喜欢）；右边，我想要的风格。

[![塑料风格](https://i.stack.imgur.com/VQgrc.png)](https://i.stack.imgur.com/VQgrc.png)
[（来源：[qt-project.org](http://qt-project.org/doc/qt-4.8/images/gtk-groupbox.png)）]

[![塑料风格](https://i.stack.imgur.com/d6kRt.png)](https://i.stack.imgur.com/d6kRt.png)
[（来源：[qt-project.org](http://qt-project.org/doc/qt-4.8/images/plastique-groupbox.png)）]

我不想为程序中的每个 QGroupBox 实例设置样式，我想像在 QApplication::setStyle() 中一样全局设置它，但仅适用于 QGroupBox。有办法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:18:00.150

您可以`qss`为此使用文件；它们是 Qt 元素的样式表。正如[这里所解释的](http://qt-project.org/doc/qt-4.8/stylesheet-examples.html)

然后，您可以在您的`qss`中指定`QGroupBox`类的样式，类似于您在`css`HTML 网站中的操作方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:21:29.310

您必须在[`QWidget::setStyle`](http://qt-project.org/doc/qt-4.8/qwidget.html#setStyle)要重新设置样式的小部件上使用该功能。

如果您希望所有组框具有相同的样式，您可以创建一个子类并仅使用它（没有最简单的方法来重新设置相同小部件类型的所有实例的样式）：

```
class MyGroupBox: public QGroupBox
{
    public:
        MyGroupBox(QWidget* parent) : QGroupBox(parent)
        {
            setStyle(/* the style you want */);
        }
}; 
```

另一个不太方便的选择是遍历widget树，根据widget的类名设置样式。

您还可以使用[Qt 样式表](http://qt-project.org/doc/qt-4.8/stylesheet.html)。请注意，目前自定义样式不支持这些。

# google-caja - 设置生产就绪的 caja 服务器

> ID：16068317
> 
> 赞同：1
> 
> 时间：2013-04-17T19:16:10.197
> 
> 标签：google-caja

我找到了这篇文章：

[http://markmail.org/thread/4g6j2vgq3fpcpjr5#query:+page:1+mid:7rcagkd6of44x3fk+state:results](http://markmail.org/thread/4g6j2vgq3fpcpjr5#query:+page:1+mid:7rcagkd6of44x3fk+state:results)

但是当前的 caja ant 构建文件中没有“maven”目标。我还花了几个小时浏览相当稀疏的 caja 文档，并在结帐时阅读文件，但没有看到任何明确的迹象表明如何以生产就绪的方式运行它。ant 构建中有一个开发服务器目标，但是在生产环境中运行 ant 来启动它并不是很有吸引力。

我不能使用谷歌托管的 caja 服务器（项目要求针对来自 UI 的传出 3rd 方请求），所以如果我使用 caja，我需要设置自己的服务器。我的愿望是使用 caja 来确保我编写的嵌入片段永远不会在嵌入它们的托管服务中运行（或彼此）。这尤其适用于与 html id 冲突、jquery 版本或 css 样式冲突（后者已经咬我们）的冲突。

我希望能够将其安装为容器中的战争，或安装为我的应用程序中的 servlet。我还想知道是否可以作为 ServletFilter 进行哄骗。

有没有办法建立战争，或者一些关于如何通过 servlet 或过滤器实现这一目标的文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:33:53.050

非常感谢您对使用 Caja 的兴趣。

您对我们的构建脚本是正确的，但是有一种简单的方法可以满足您的需求。如果您`ant AllTests`从 Caja 源代码树运行，您将获得一个`ant-war/`目录。它不是一个最小的、干净的生产版本，因为它提供了 Caja Playground 和一堆测试等服务。但它确实为您提供了一个正在运行的 Caja 服务器，您可以将它部署在您最喜欢的 Java webapp 容器中。

如果您对此程序有任何疑问，请告知我们。也请在以下位置提交我们产品的错误：

[https://code.google.com/p/google-caja/issues/entry](https://code.google.com/p/google-caja/issues/entry)

提醒我们下次去我们周围挖掘时要注意这一点`build.xml`。

伊哈布·阿瓦德

# java - How i can change size of text in ListView?

> ID：16068319
> 
> 赞同：1
> 
> 时间：2013-04-17T19:16:16.750
> 
> 标签：java, android, xml

I am writing aplication for android 2.3

in `main.xml`

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout 
xmlns:android        = "http://schemas.android.com/apk/res/android"
android:orientation  = "vertical"
android:layout_width = "fill_parent"
android:layout_height= "fill_parent" >

    <ListView
    android:id                 =   "@android:id/list"
    android:textSize           =  "4sp"
    android:layout_width       = "fill_parent"
    android:layout_height      = "fill_parent"
    android:drawSelectorOnTop  = "false" />

</LinearLayout> 
```

in `ViewHolder.java`

```
public class ViewHolder {
    ImageView icon = null;

    ViewHolder(View base){
        this.icon = (ImageView)base.findViewById(R.id.pic);
    }
} 
```

in `ViewHolderDemo.java`

```
public class ViewHolderDemo extends ListActivity {
    private static final String[] items = {"lorem", "ipsum", "dolor", "sit", "amet","consectetuer", "adipiscing", "elit"};

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        setListAdapter(new IconicAdapter());
    }

    public void OnListItemClick(ListView parent, View v, int position, long id){
    }   

    class IconicAdapter extends ArrayAdapter<String> {

        public IconicAdapter() {
            super(ViewHolderDemo.this, R.layout.row, R.id.label, items);
        }

        public View getView(int position, View convertView, ViewGroup parent){  
            View row = super.getView(position, convertView, parent);
            ViewHolder holder = (ViewHolder)row.getTag();

            if(holder == null){         
                holder = new ViewHolder(row);
                row.setTag(holder);

            }
            holder.icon.setImageResource(R.drawable.star);
            return(row);
        }       
    }
} 
```

problem that tired me is : when i change`android:textSize` in `.xml`. size of text dont change
may be this is a bug in android
![enter image description here](https://i.stack.imgur.com/ftSFv.png)
so how i can chage size of text(make small) that exist in ListView?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:30:10.567

```
android:textSize = "4sp" 
```

android:textSize is a TextView attribute, not for ListView.

You can override the default textSize by setting the textSize in your app theme. The better way would be to either:

1.  Set it in code (get a reference to the TextView and use setTextSize)
2.  Inflating your own row layout with android:textSize ="4sp" for the TextView

Why this is better than setting it in the app theme? Since the textSize attribute would be shared by all widgets that extend from TextView. So anything like Button or EditText would have that size as well (of course assuming that is not the desired effect).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:21:31.193

You can do so with a custom row XML and BaseAdapter. Not sure if there's an easier way or not, but I know this works.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T19:30:09.047

```
 private static final String[] items = {"lorem", "ipsum", "dolor", "sit", "amet","consectetuer", "adipiscing", "elit"} 
```

I assume you are inflating a custom layout with imageview and textview.

In your getView()

```
 SpannableString ss2=  new SpannableString(items[position]);
 ss2.setSpan(new RelativeSizeSpan(2f), 0, ss2.length(), 0);  //change the size
 viewHolder.tv.setText(ss2); //set spannable string to your text 
```

# sql-server - 存储过程创建详细信息

> ID：16068321
> 
> 赞同：0
> 
> 时间：2013-04-17T19:16:21.083
> 
> 标签：sql-server, stored-procedures

我目前正在记录一个数据库，我现在正在处理存储过程。

我想知道是否有任何方法可以知道谁创建了哪个存储过程以及他们何时创建它？

我正在研究 SQL Server 2008 R2。

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:18:18.920

**创建**存储过程时在以下位置找到`sys.procedures`：

```
USE (your database here)
GO 

SELECT name, create_date FROM sys.procedures 
```

**据我所知，SQL Server 没有记录**谁创建了它。****

 **您必须设置自己的跟踪系统，例如通过使用[SQL Server DDL 触发器](http://technet.microsoft.com/en-us/library/ms190989%28v=sql.105%29.aspx)来捕获创建存储过程的时间。除非您已经有这样的自定义跟踪系统，否则无法找出谁在 5 年前创建了存储过程......**

# c# - 如何在 c# 中使用 Microsoft.Office.Interop.Excel.Application 写入 excel

> ID：16068322
> 
> 赞同：2
> 
> 时间：2013-04-17T19:16:23.040
> 
> 标签：c#, asp.net, excel

我想有一个简单的例子来使用 C# 中的 Microsoft.Office.Interop.Excel.Application 对象写入 Excel 电子表格

请哪位帮忙谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T19:55:51.433

**[根据 MS 的说法，服务器场景（如 ASP.NET）不支持互操作](http://support.microsoft.com/default.aspx?scid=kb;EN-US;q257757#kb2)。**

有许多选项可以读取/编辑/创建 Excel 文件，而无需在服务器上进行互操作/安装 Excel：

MS 提供免费的 OpenXML SDK V 2.0 - 请参阅[http://msdn.microsoft.com/en-us/library/bb448854%28office.14%29.aspx](http://msdn.microsoft.com/en-us/library/bb448854%28office.14%29.aspx)（仅限 XLSX）

这可以读写 MS Office 文件（包括 Excel）。

另一个免费选项参见[http://www.codeproject.com/KB/office/OpenXML.aspx](http://www.codeproject.com/KB/office/OpenXML.aspx)（仅限 XLSX）

如果您需要更多处理旧 Excel 版本（如 XLS，不仅是 XLSX）、渲染、创建 PDF、公式等，那么有不同的免费和商业库，如[ClosedXML](http://closedxml.codeplex.com/)（免费，仅限 XLSX）、[EPPlus](http://epplus.codeplex.com/)（免费，仅限 XLSX） , [Aspose.Cells](http://www.aspose.com/categories/.net-components/aspose.cells-for-.net/default.aspx) , [SpreadsheetGear](http://www.spreadsheetgear.com/) , [LibXL](http://www.libxl.com/)和[Flexcel](http://www.tmssoftware.com/site/flexcelnet.asp)等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T19:34:19.643

这是一个创建新工作簿并将值写入单元格的简单示例。

```
using Excel = Microsoft.Office.Interop.Excel;
var xlApplication = new Excel.Application();
var workbooks = xlApplication.Workbooks;
Excel.Workbook sampleWorkbook = workbooks.Add();
Excel.Worksheet sampleWorksheet = sampleWorkbook[1];
Excel.Range sampleCell = sampleWorksheet.get_Range("A1");
sampleCell.Value = "New Value";
sampleWorkbook.SaveAs("Output.xlsx");
sampleWorkbook.Close();
xlApplication.Quit(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T20:07:46.617

根据我之前使用 Microsoft.Office.Interop.Excel 的经验，我可以告诉你，这将成为地狱。相反，我建议使用像 EPPlus 这样的托管 Excel 引擎

[http://epplus.codeplex.com/](http://epplus.codeplex.com/)

我使用 EPPlus 实现了几个 Excel 导出功能，效果很好。

# php - 我可以通过传递对 Mongo 连接的引用从远程类连接到 MongoDB 吗？

> ID：16068323
> 
> 赞同：0
> 
> 时间：2013-04-17T19:16:23.270
> 
> 标签：php, mongodb, scope, kohana

我正在使用 Kohana 的 php 框架 (2.x)，我想要一个帮助程序，让我可以通过函数访问 Mongo 并将结果作为对象返回。为此要实际查询数据库，我是否必须连接到本地类中的数据库？或者我可以`$this->mongo->collection`从连接的对象传递吗？我确定我的代码中存在错误和误解，因此请随时指出。

```
class mongoaccess
{   

function __construct()
{     
        try
        {
            //$m = new MongoClient();       // not sure how to go about the connection
            //$this->mongo = Mongo_Database::instance();
        }
            catch (Exception $e) 
            {
                error_log('Caught exception: ' . $e->getMessage() . "\n");
            }
}

    /** 
    * Converts an array to an object. 
    * Multiple nesting supported.
    * @param $array | type: array | Ex: array('newvariable' => 'value')
    */
public static function arrayToObject($array) 
    {
        $object = new stdClass;
        foreach($array as $key => $value) 
        {
            if(is_array($value)) 
            {           
                $object->{$key} = arrayToObject($value); //Recursive
            } else {$object->{$key} = $value;}
        }
      return $object;
    } 

    /** Provides easy access to findOne()
     * @param $collection | type: object member | Ex: $this->mongo->usersinapps
     * @param $query | type: array | Ex: array('keyy' => 'valuee')  
     */
public static function getObjectFromMongo($collection, $query) 
{
    if (empty($query) || !is_array($query) || empty($collection))
        {return null;}

     $collection->findOne($query);

             $object = new stdClass();
     $object = mongoaccess::arrayToObject($query);

     return $object;
}

    // needs review
    /** Provides easy access to find() - iterates through cursor and returns array of objects
     * @param $collection | type: object member | Ex: $this->mongo->usersinapps
     * @param $query | type: array | Ex: array('keyy' => 'valuee')  
     */
public static function getObjectsFromMongo($collection, $query)
{
    if (empty($query) || !is_array($query) || empty($collection))
        {return null;}

    $objectArray = array();

    $mongoResultsCursor = $collection->find($query);

     while ($mongoResultsCursor->hasNext())
     {
        $document = $mongoResultsCursor->getNext();
        array_push($objectArray, $document);
     }

    $object = mongoaccess::arrayToObject($objectArray);

    return $object;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:03:38.783

```
class Mongoaccess
{   
    protected $_mongo;

    function __construct()
    {
        $database     = 'test';
        $connect      = new MongoClient('mongodb://localhost:27017/'.$database);
        $this->_mongo = $connect->{$database}; // $this->_mongo
    }

    function get($collection, $criteria)
    {
        $data = $this->get_many($collection, $criteria);

        return ($data) ? reset($data) : $data; // Get first array
    }

    function get_many($collection, $criteria, $findOne = FALSE)
    {
        $find      = $this->_mongo->{$collection}->find($criteria);

        // find().limit(1) faster than findOne()
        // http://dba.stackexchange.com/a/7587
        $find      = $findOne ? $find->limit(1) : $find;

        // Array to object
        // https://coderwall.com/p/k-bwtq
        $data      = json_encode(iterator_to_array($find));
        $to_object = json_decode($data);

        return $to_object;
    }
} 
```

* * *

```
Mongoaccess::get('collection', $criteria_array);
Mongoaccess::get_many('collection', $criteria_array); 
```

# java - mybatis mapper xml：元素类型“mapper”的内容必须匹配

> ID：16068327
> 
> 赞同：1
> 
> 时间：2013-04-17T19:16:35.990
> 
> 标签：java, database, database-connection, ibatis, mybatis

我很难让我的简单 mybatis 文件正常工作。我有这个文件：

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="truthtree.model.mysql.UserMapper">

    <typeAlias alias="User" type="truthtree.model.mysql.User" />

    <select id="getAllUsers" resultType="User">
        select * from User
    </select>

    <select id="findUserByID" resultType="User">
        select *
        from User
        where id=#{id,javaType=int}
    </select>

    <select id="findByNameAndPassword" resultType="User">
        select *
        from User
        where name = #{name,javaType=String}
          and password = #{password,javaType=String}
    </select>

</mapper> 
```

我得到以下异常：

引起：org.xml.sax.SAXParseException：元素类型“mapper”的内容必须匹配“(cache-ref|cache|resultMap*|parameterMap*|sql*|insert*|update*|delete*|select*) +”。

这很令人困惑，因为我肯定有一些 s 在那里。任何想法这里可能有什么问题？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T00:31:28.137

你在这里错的是`typeAlias`元素没有进入`mapper`文件。它不存在于[`mybatis-3-mapper.dtd`](http://mybatis.org/dtd/mybatis-3-mapper.dtd). 该`typeAlias`元素必须包含在`mybatis-config`文件中（在`typeAliases`元素内部，因为在[`mybatis-3-config.dtd`](http://mybatis.org/dtd/mybatis-3-config.dtd):

```
<!ELEMENT typeAliases (typeAlias*,package*)>

<!ELEMENT typeAlias EMPTY>
<!ATTLIST typeAlias
type CDATA #REQUIRED
alias CDATA #IMPLIED
> 
```

# ruby-on-rails - 迁移后移除 rails 模型

> ID：16068328
> 
> 赞同：8
> 
> 时间：2013-04-17T19:16:40.167
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

对我来说，创建模型、运行迁移、销毁它并再次创建相同的模型报告 SQL 异常，这对我来说似乎很奇怪：

```
project|master ⇒ rails g model name name
      invoke  active_record
      create    db/migrate/20130417185814_create_names.rb
      create    app/models/name.rb
project|master⚡ ⇒ rake db:migrate
==  CreateNames: migrating ====================================================
-- create_table(:names)
   -> 0.0020s
==  CreateNames: migrated (0.0021s) ===========================================
project|master⚡ ⇒ rails d model name
      invoke  active_record
      remove    db/migrate/20130417185814_create_names.rb
      remove    app/models/name.rb
project|master⚡ ⇒ rake db:migrate
project|master⚡ ⇒ rails g model name test
      invoke  active_record
      create    db/migrate/20130417185845_create_names.rb
      create    app/models/name.rb
project|master⚡ ⇒ rake db:migrate
==  CreateNames: migrating ====================================================
-- create_table(:names)
rake aborted!
An error has occurred, this and all later migrations canceled:

SQLite3::SQLException: table "names" already exists: CREATE TABLE "names" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "test" varchar(255), "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL) /path/project/db/migrate/20130417185845_create_names.rb:3:in `change'
-- create_table("names", {:force=>true})
   -> 0.0100s
-- initialize_schema_migrations_table()
   -> 0.0025s
-- assume_migrated_upto_version(20130417185814, ["/path/project/db/migrate"])
   -> 0.0010s
You have 1 pending migrations:
  20130417185845 CreateNames
Run `rake db:migrate` to update your database then try again. 
```

也许，我做错了什么？迁移有删除表的代码 - 它是否只能用于回滚？

# 解决方案

删除模型和数据库表并生成一个新表非常简单：

1.  创建模型：`rails g model user name`
2.  进行迁移：`rake db:migrate`
3.  实现一个东西，突然想起需要删除模型
4.  还原特定迁移：`rake db:migrate:down VERSION=20130417185814`，`20130417185814`迁移id在哪里（可以在rake db:migrate:status中看到）
5.  移除模型：`rails d model user`
6.  突然想起你需要这个模型，但是还有其他字段
7.  创建模型：`rails g model user email group:references`
8.  成功迁移数据库：`rake db:migrate`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T19:23:57.097

```
rails d model name 
```

这只是删除模型而不是您运行的迁移（在数据库中创建了表）。

如果要删除模型和表，则必须执行以下操作

```
rake db:rollback 
rails d model name 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-17T19:19:40.647

您删除了模型——这是与回滚迁移不同的操作。

销毁模型正是这样做的，而且仅仅是这样做的；它与迁移无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:01:36.867

根据您的迁移错误，迁移文件肯定有问题，而且是指创建名称表的文件。

请查看此文件，查看您的更改方法。

迁移文件中的 change 方法应该执行 DB 代码，该 DB 代码可以在 DB 上执行一些操作，并且更改的相同代码应该是正确的回滚。

如果您想将两者分开，您应该将代码放在将对数据库执行操作的 up 方法上，并在 down 方法上执行相反的滚动操作。

我建议您删除迁移中的所有文件，包括导致问题的文件，并正确写入。

如果您需要帮助，请发布您的迁移文件。

另请查看指南： http: [//guides.rubyonrails.org/migrations.html](http://guides.rubyonrails.org/migrations.html)

# javascript - 如何在网站上进行 twitter 登录 javascript

> ID：16068334
> 
> 赞同：7
> 
> 时间：2013-04-17T19:16:58.193
> 
> 标签：javascript, twitter

我一直在寻找如何使用 twitter 登录。我发现了一些关于 twitter @anywhere 的信息，但似乎这个选项已被取消。有谁知道是否有其他方法可以在网站上使用 twitter 登录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:22:59.457

以下是“使用 Twitter 实现登录”的官方教程：

[https://dev.twitter.com/web/sign-in/implementing](https://dev.twitter.com/web/sign-in/implementing)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:26:57.253

要使用 twitter 为您的网站创建第三方登录系统，请参阅这篇文章： http: [//onlinewebapplication.com/login-facebook-twitter-php/](http://onlinewebapplication.com/login-facebook-twitter-php/)

您将看到他们有一个教程，其中包含解释该过程的文件。

这是官方推特文档： [https ://dev.twitter.com/docs/auth/implementing-sign-twitter](https://dev.twitter.com/docs/auth/implementing-sign-twitter)

在开始复制和粘贴代码之前，仔细考虑流程的每个步骤和每个登录页面可能会有所帮助。

*   登录页面
*   用户是否有账户 Y/N
*   如果 N 然后注册页面（那么他们是否必须返回并登录到您的站点？）
*   如果 Y 输入凭据（然后重定向到所需页面）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T19:20:49.127

总是当你遇到类似的事情时直接去开发者 API

[https://dev.twitter.com/](https://dev.twitter.com/)

如果你使用 PHP，你可以看看这个很棒的库

[http://www.eden-php.com/](http://www.eden-php.com/)

我希望这可以帮助

# visual-studio-2010 - 在 Visual Studio 2010 和 resharper 中导航返回的快捷方式

> ID：16068336
> 
> 赞同：15
> 
> 时间：2013-04-17T19:16:59.837
> 
> 标签：visual-studio-2010, resharper, shortcuts, keyboard-shortcuts

`visual studio 2010`使用（jetBrain 的产品）后，我才刚回来，`phpStorm`但我错过了所有漂亮的快捷键。我已经安装`visual studio 2010`了，`resharper`但仍然缺少一些不错的功能。我不知道如何在我的代码中“导航回来”。例如，如果我正在导航到各种方法定义，然后我想导航回我刚才所在的位置，我该怎么做？

我相信，如果我想前进，`phpstorm`我会按`Ctrl`+ `Alt`+`Left`向后导航和`Ctrl`+ `Alt`+ 。`Right`它会保留历史，所以我可以继续往回走，只要我想。请帮忙。我想念这个功能。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-04-17T21:46:28.487

默认情况下，您可以使用 + 向后`Ctrl`导航并使用+ +`-`向前导航。`Ctrl``Shift``-`

如果要更改这些快捷键，请转到 Tools->Options...->Environment->Keyboard，然后搜索名为`View.NavigateBackward`and的命令`View.NavigateForward`，并为其分配新的键盘快捷键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-18T14:41:16.420

在 Resharper 2020.02 中，`Alt`+`left arrow`表示“时间”返回，`Alt`+`right arrow`表示前进。

# opengl - glGetString 和 glGetShaderInfoLog 等函数使用什么编码

> ID：16068339
> 
> 赞同：4
> 
> 时间：2013-04-17T19:17:26.317
> 
> 标签：opengl

OpenGL 有一些函数，比如`glGetString`和`glGetShaderInfoLog`，它们返回字符串。这些使用什么形式的文本编码？

我假设，假设它们以 a 形式返回`GLchar*`，它是包含在返回值中的 ASCII 编码文本，但这是在任何地方指定的吗？

作为第二个相关点，诸如`glShaderSource`和之类的函数所期望的文本编码是什么`glBindAttribLocation`。GLSL 程序必须用 ASCII 编码还是可以是 UTF-8？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:23:21.427

[OpenGL 4.3 兼容性配置文件规范](http://www.opengl.org/registry/doc/glspec43.compatibility.20130214.pdf)，第 22.2 节，第 627 页：

> 字符串查询返回指向 UTF-8 编码、以 null 结尾的静态字符串的指针，该字符串描述当前 GL 上下文的属性。

据我所知，规范没有提到`glGetShaderInfoLog()`.

# php - PHP正则表达式从字符串中分离数字

> ID：16068347
> 
> 赞同：0
> 
> 时间：2013-04-17T19:17:50.310
> 
> 标签：php, regex, string, numbers

我有以下字符串：`01SOMECOMPANY`我想以`01 SOMECOMPANY`. 我如何使用正则表达式来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:20:58.497

正则表达式将是“/^([0-9]+)(.+)/”，替换为“\1 \2”或“$1 $2”。不记得 PHP 是使用 \1 还是 $1 来引用正则表达式中的第一个匹配项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:21:41.280

正则表达式可能看起来像这样：

```
 (\d+)([a-zA-Z]+) 
```

然后，您可以在替换表达式中使用捕获组，它们之间有一个空格。

```
 $1 $2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T19:26:17.743

我使用[preg_split](http://php.net/manual/en/function.preg-split.php)函数来分隔字符串的组成部分。然后加入元素，使用空格作为分隔符：

```
<?php
$str = '01string44str';
$elements = preg_split('/(\d+)/', $str, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);
$output = implode(" ", $elements);
print $output; 
```

这打印：

> 01 弦 44 弦

更有效的解决方案是使用带有反向引用的[preg_replace函数：](http://www.php.net/manual/en/function.preg-replace.php)

```
<?php
$str = '01string44str';
$output = preg_replace('/(\d+)/', '$1 ', $str);
print $output; 
```

这会打印出一些不同的结果：

> 01 字符串 44 字符串

不确定，“字符串”和“44”之间是否需要一个空格。但是，对于您的字符串 '01SOMECOMPANY'，它可以正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T19:29:07.880

下面的例子将为您解释。

```
$string = "01SOMECOMPANY";
preg_match('/^([0-9]*)(.*)/i', $string, $matches);
echo $matches[1]." ".$matches[2]; 
```

结果：
`01 SOMECOMPANY`

# java - 如何导入 tablelayout.jar 文件？

> ID：16068348
> 
> 赞同：-1
> 
> 时间：2013-04-17T19:17:57.220
> 
> 标签：java, swing, classpath, packages, tablelayout

在每个示例中，我都发现使用了这个导入：import layout.TableLayout; 我已经下载了 jar 文件，但是我在导入它时遇到了问题。任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:29:46.523

To be able to use a jar file, you need to either add it to the classpath. This can be done either by compiling on the command line with the `javac -cp theJarFilePath TheJavaFile.java` command, or by adding the jar to the build path if using an IDE.

# vbscript - VBScript：从对象属性内部检索值

> ID：16068349
> 
> 赞同：0
> 
> 时间：2013-04-17T19:17:58.310
> 
> 标签：vbscript

我正在尝试从 AD 组的 Notes 字段中检索自动生成的信息并从中获取特定值。我能够找到我需要的组并使用 Get("Info") 提取数据，但我不知道如何从中获得我需要的东西。这是我将看到的示例：

```
Value1=True
Value2=name@domain.org
Value3=Something Else 
```

我需要做的是找到 Value2 并将其放入变量中。我以前用文本文件做过这个，但这似乎有点不同，我很难过。

编辑：要清楚，这是基本代码：

```
Set objGroup = GetObject("LDAP://cn=Group Name,ou=Groups,dc=domain,dc=org")
wscript.echo objGroup.Get("Info") 
```

这将返回上面的示例。我需要从中找到“Value2”并将其值（在本例中为“name@domain.org”）放入一个新变量中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:26:25.543

未经测试：

```
For Each v In Split(objGroup.Get("Info"), vbNewLine)
  If LCase(Left(v, 6)) = "value2" Then
    a = Split(v, "=", 2)
    If UBound(a) = 1 Then var = Trim(a(1))
  End If
Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:28:47.283

您可以为变量赋值，如下所示：

```
Value3 = Get("info") 
```

# java - 标准网络请求

> ID：16068351
> 
> 赞同：1
> 
> 时间：2013-04-17T19:18:01.763
> 
> 标签：java, android, standards, httpurlconnection

我想知道是否有某种通用方法可以使用 Java / Android 进行网络调用，因为我正在为我目前的策略而苦苦挣扎。我目前正在尝试这个：

```
public static File synchronousConnection(String url, String requestMethod, byte[] requestData, Map<String, String> headers)
{
    File returnData = null;
    try
    {
        URL url = new URL(url);
        HttpURLConnection connection = (HttpURLConnection)url.openConnection();
        connection.setDoInput(true);
        connection.setDoOutput(true);
        connection.setRequestMethod(requestMethod);
        if(requestData != null && requestData.length > 0)connection.setRequestProperty("Content-Length", Integer.toString(requestData.length));
        if(headers != null)for(String key : headers.keySet())connection.setRequestProperty(key, headers.get(key));
        //connection.connect();

        if(requestData != null && requestData.length > 0)
        {
            DataOutputStream outputStream = new DataOutputStream(connection.getOutputStream());
            outputStream.write(requestData);

            outputStream.flush();
            outputStream.close();
        }

        //String response = inputStreamToString(url.openStream());
        //System.out.println("Response: " + response);

        int statusCode = connection.getResponseCode();

        connection.disconnect();

        System.out.println("Status code: " + statusCode);

        //returnData = response;
    }
    catch(IOException e)
    {
        System.out.println("IO Exception in connections\n" + e.getLocalizedMessage());
        e.printStackTrace();
    }
    catch(Exception e)
    {
        System.out.println("Invalid information for network connection\n" + e.getLocalizedMessage());
        e.printStackTrace();
    }
    return returnData;
} 
```

我有相当多的组件被注释掉，因为它们似乎会干扰过程或提出问题，即使它们在其他示例中也是如此。至于`inputStreamToString(InputStream)`，那是我按照它所说的去做的方法之一。

给定函数的输入参数，是否有通用的 URL 连接方式？目前，我真的很难让任何连接正常工作，而且对于每个请求都必须以自定义方式做事很奇怪。`POST`此外，即使我的 API 确实返回了响应正文，我似乎也无法从请求中获取任何响应数据。

# php - 为 php/apache 全局设置 'secure' 和 'httponly' 标志

> ID：16068354
> 
> 赞同：1
> 
> 时间：2013-04-17T19:18:10.860
> 
> 标签：php, apache, cookies

该网站完全使用 HTTPS，没有使用 HTTP 的页面。我想为 cookie 设置安全和 httponly 标志。除了对每个 cookie 都这样做，有没有办法在全局范围内对所有 cookie 这样做？如标题所述，我使用 PHP 5.3 和 Apache。

请注意，我知道会话 Cookie 是可能的，但我需要它用于网站中的所有 cookie。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:09:03.097

简而言之，没有。

您可以管理此问题的唯一方法是拥有一个辅助函数：

```
function setSecureCookie($name, $val = '', $exp = 0, $path = '', $domain = '') {
    return setcookie($name, $val, $exp, $path, $domain, true, true);
} 
```

# objective-c - 为属性创建我自己的设置器时无限递归

> ID：16068357
> 
> 赞同：4
> 
> 时间：2013-04-17T19:18:13.090
> 
> 标签：objective-c, infinite-loop, setter

我偶然发现了 Objective-C 中的一些奇怪行为。我有一个 main.m：

```
#include <Foundation/Foundation.h>
#include "AClass.h"

int main(int argc, char* argv[]) {
  AClass* tmpClass = [[AClass alloc] init];
  [tmpClass setAVariable:12];
  return -1;
} 
```

头文件 AClass.h：

```
#include <Foundation/Foundation.h>

@interface AClass: NSObject; 

-(void) setAVariable:(int) bVariable;

@property int aVariable;

@end 
```

以及对应的实现文件AClass.m：

```
#include <Foundation/Foundation.h>
#include <AClass.h>

@implementation AClass
@dynamic aVariable;
int aVariable;

-(void) setAVariable:(int)bVariable {
  NSLog(@"foo:");
  self.aVariable = bVariable;  
}

@end 
```

在 Linux 上使用 clang 或通过 OSX 上的 Xcode 编译此代码时，`setAVariable:`会触发无限递归。我想知道这是否是 clang/Objective-C 中的错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T19:29:05.643

这是意料之中的。您正在您的 setter 中访问您的 setter。

`self.aVariable = bVariable`实际上是在调用`[self setAVariable:bVariable]`，因此是递归。点语法就是这样，一种特殊的语法，实际上只是实际 setter 方法的简写。当您编写自己的 setter 方法时，您应该访问支持的实例变量，而不是属性本身。例如

```
- (void) setAVariable:(int)bVariable {
  NSLog(@"foo:");
  aVariable = bVariable;  
} 
```

通常的做法是为您的实例变量使用前导下划线，因此当您直接访问实例变量而不是属性（通过 getter 和 setter 访问支持实例变量）时，很容易识别。

此外，最好使用#import 而不是#include，因为即使同一个文件有多个#import 语句，#import 也只包含一次文件，这可能会加快编译时间。

# sql - SQL：另一个日期/时间的 24 小时内的最小日期/时间值

> ID：16068362
> 
> 赞同：0
> 
> 时间：2013-04-17T19:18:23.183
> 
> 标签：sql, oracle, oracle11g

我正在尝试查找在另一个日期/时间值的 24 小时内出现的第一个日期/时间值。

ENCOUNTER 表：

```
ENC_ID    ADMSN_TIME         DISCH_TIME
16755387  03/19/13 11:10:00  03/22/13 12:55:00 
```

PROBLEM_LIST 表：

```
ENC_ID      REVIEWED_TIME       USER_ID
16755387    03/19/13 13:02:00   FOOBAR
16755387    03/19/13 13:03:00   FOOBAR
16755387    03/20/13 07:52:00   FOOBAR
16755387    03/22/13 08:35:00   FOOBAR
16755387    03/22/13 08:35:00   FOOBAR
16755387    03/22/13 08:35:00   FOOBAR 
```

期望的结果集：

```
ENC_ID    ADMSN_TIME         ADMSN_REVIEW_TIME  ADMSN_REVIEWER  DISCH_REVIEW_TIME  DISCH_REVIEWER
16755387  03/19/13 11:10:00  03/19/13 13:02:00  FOOBAR          03/22/13 08:35:00  FOOBAR 
```

规则：

1.  ABS(REVIEWED_TIME - ADMSN_TIME)<=1
2.  ABS(REVIEWED_TIME - DISCH_TIME)<=1
3.  可能没有与入院、出院或两者都对应的复习时间

我的第一次尝试：

```
SELECT  E.ENC_ID, 

        E.ADMSN_TIME,
        R0.REVIEWED_TIME ADMSN_REVIEWED_TIME,
        R0.USER_ID ADMSN_REVIEWER,

        E.DISCH_TIME,
        R1.REVIEWED_TIME DISCH_REVIEWED_TIME,
        R1.USER_ID DISCH_REVIEWER

FROM    ENCOUNTER E
INNER JOIN PROBLEM_LIST R0 ON HE.ENC_ID=R0.ENC_ID
  and r0.REVIEWED_TIME = (
    SELECT  MIN(REVIEWED_TIME)
    FROM    PROBLEM_LIST
    WHERE   ENC_ID=E.ENC_ID
    AND     ABS(REVIEWED_TIME - ADMSN_TIME)<=1      
    )
INNER JOIN PROBLEM_LIST R1 ON E.ENC_ID=R1.ENC_ID
  and r1.REVIEWED_TIME = (
    SELECT  MIN(REVIEWED_TIME)
    FROM    PROBLEM_LIST
    WHERE   ENC_ID=E.ENC_ID
    AND     ABS(REVIEWED_TIME - DISCH_TIME)<=1      
    ) 
```

问题：

*   不允许漏检（规则#3）；使用 'OUTER JOIN' 会产生语法错误
*   不会消除重复的 PROBLEM_LIST 记录

有没有办法使这项工作？

** 编辑 **

```
SELECT  DISTINCT ENC_ID, 
        E.ADMSN_TIME,
        FIRST_VALUE(R0.REVIEWED_TIME) OVER (PARTITION BY R0.ENC_ID ORDER BY R0.REVIEWED_TIME) ADMSN_REVIEWED_TIME,
        FIRST_VALUE(R0.USER_ID) OVER (PARTITION BY R0.ENC_ID ORDER BY R0.REVIEWED_TIME) ADMSN_REVIEWED_BY,
        E.DISCH_TIME,
        FIRST_VALUE(R1.REVIEWED_TIME) OVER (PARTITION BY R1.ENC_ID ORDER BY R1.REVIEWED_TIME) DISCH_REVIEWED_TIME
        ,FIRST_VALUE(R1.USER_ID) OVER (PARTITION BY R1.ENC_ID ORDER BY R1.REVIEWED_TIME) DISCH_REVIEWED_BY

FROM    ENCOUNTER E
LEFT JOIN PROBLEM_LIST R0 ON E.ENC_ID=R0.ENC_ID
    AND ABS(r0.REVIEWED_TIME - ADMSN_TIME)<=1
LEFT OUTER JOIN PROBLEM_LIST R1 ON E.ENC_ID=R1.ENC_ID
    AND ABS(R1.REVIEWED_TIME - DISCH_TIME)<=1 
```

这种方法可以按预期工作，但该`DISTINCT`子句似乎不是最优的。有没有更高效的查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:53:00.627

我想出了以下内容，它适用于几个测试。使用 LEAD 分析函数和 UNION。

```
SELECT enc_id,
       admsn_time,
       CASE
          WHEN TO_CHAR (admsn_time, 'DDMMYYYY') =
                  TO_CHAR (admsn_review_time, 'DDMMYYYY')
          THEN
             admsn_review_time
          ELSE
             NULL
       END
          AS admsn_review_time,
       CASE
          WHEN TO_CHAR (admsn_time, 'DDMMYYYY') =
                  TO_CHAR (admsn_review_time, 'DDMMYYYY')
          THEN
             admsn_user
          ELSE
             NULL
       END
          AS admsn_review_user,
       disch_time,
       CASE
          WHEN TO_CHAR (disch_time, 'DDMMYYYY') =
                  TO_CHAR (disch_review_time, 'DDMMYYYY')
          THEN
             disch_review_time
          ELSE
             NULL
       END
          AS disch_review_time,
       CASE
          WHEN TO_CHAR (disch_time, 'DDMMYYYY') =
                  TO_CHAR (disch_review_time, 'DDMMYYYY')
          THEN
             disch_user
          ELSE
             NULL
       END
          AS disch_review_user
  FROM (SELECT enc_id,
               admsn_time,
               LEAD (admsn_time, 1)
                  OVER (PARTITION BY enc_id ORDER BY admsn_time)
                  admsn_review_time,
               LEAD (user_id, 1)
                  OVER (PARTITION BY enc_id ORDER BY admsn_time)
                  admsn_user,
               disch_time,
               LEAD (disch_time, 1)
                  OVER (PARTITION BY enc_id ORDER BY disch_time)
                  disch_review_time,
               LEAD (user_id, 1)
                  OVER (PARTITION BY enc_id ORDER BY disch_time)
                  disch_user,
               ch
          FROM (SELECT e.enc_id,
                       admsn_time,
                       disch_time,
                       'E' AS ch,
                       NULL AS user_id
                  FROM encounter e
                UNION
                SELECT enc_id,
                       reviewed_time,
                       reviewed_time,
                       'P',
                       user_id
                  FROM problem_list pl))
 WHERE ch = 'E'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T07:27:59.980

您的基本问题是如何在时间 T 之后找到第一次受到约束。从那里开始，

```
SELECT  E.ENC_ID, 
        E.ADMSN_TIME,
        min(REVIEWED_TIME) as ADMSN_REVIEWED_TIME,
FROM    ENCOUNTER as E
JOIN    PROBLEM_LIST as P 
ON      E.ENC_ID = P.ENC_ID
AND     ADMSN_TIME < REVIEWED_TIME
AND     REVIEWED_TIME <= ADMSN_TIME + 1
GROUP BY E.ENC_ID, E.ADMSN_TIME 
```

将其加入您需要的任何其他内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:54:53.523

不确定这是否会比您的第二个解决方案更有效，但它避免了`distinct`和两个连接到`problem_list`. 仍然感觉过于复杂 - 做 a`unpivot`后跟 a`pivot`似乎是一种黑客行为 - 但这部分是为了我自己的乐趣：

```
select enc_id, admsn_time, admsn_review_time, admsn_reviewer,
    disch_time, disch_review_time, disch_reviewer
from (
    select enc_id, admsn_time, disch_time, user_id, reviewed_time, review_type
    from (
        select *
        from (
            select e.enc_id, e.admsn_time, e.disch_time,
                pl.user_id, pl.reviewed_time,
                row_number() over (partition by e.enc_id
                    order by abs(pl.reviewed_time - e.admsn_time))
                        as admsn_reviewed_rn,
                row_number() over (partition by e.enc_id
                    order by abs(pl.reviewed_time - e.disch_time))
                        as disch_reviewed_rn
            from encounter e
            left join problem_list pl on pl.enc_id = e.enc_id
        )
        unpivot (rn for review_type in (admsn_reviewed_rn as 'ADMSN',
            disch_reviewed_rn as 'DISCH'))
    )
    where rn = 1
    and (abs(reviewed_time - admsn_time) <= 1
        or abs(reviewed_time - disch_time) <= 1)
)
pivot (min(reviewed_time) as review_time, min(user_id) as reviewer
for review_type in ('ADMSN' as admsn, 'DISCH' as disch))
/ 
```

这使：

```
 ENC_ID ADMSN_TIME          ADMSN_REVIEW_TIME   ADMSN_ DISCH_TIME          DISCH_REVIEW_TIME   DISCH_
---------- ------------------- ------------------- ------ ------------------- ------------------- ------
  16755387 03/19/0013 11:10:00 03/19/0013 13:02:00 FOOBAR 03/22/0013 12:55:00 03/22/0013 08:35:00 FOOBAR 
```

# json - .NET MVC 接受列表 使用 JSON 和 ExtJS 4.1.1 时作为参数

> ID：16068363
> 
> 赞同：0
> 
> 时间：2013-04-17T19:18:24.450
> 
> 标签：json, list, asp.net-mvc-4, extjs4

我正在尝试向 .NET MVC 控制器发出 Ajax 请求。当我在控制器代码中设置断点时，我注意到数据为空。我希望它有数据。

ExtJS 代码：

```
var paramsList = [];
console.log(paramsList);
for (var i = 0; i < dropData.records.length; i++) {
    if (dropData.records[i].data.Conflicts.indexOf('This Camp' == -1)) {
        //add this cabin to the parameters object
        //idCampEventCabin = 0 tells the server to insert a new CampEventCabin
        paramsList.push({ idCampEventCabin: 0, Abbreviation: dropData.records[i].data.Abbreviation, Accommodations: dropData.records[i].data.Accommodations, Capacity: dropData.records[i].data.Capacity, idCabin: dropData.records[i].data.idCabin, Level: dropData.records[i].data.Level, Name: dropData.records[i].data.Name, Number: dropData.records[i].data.Number, Type: dropData.records[i].data.Type, idCampEvent: form.getIdCampEvent() });
    }
}

console.log(paramsList);
console.log(Ext.JSON.encode(paramsList));
if (params.length > 0) {
    //post 
    Ext.Ajax.request({
        url: '/CampEvent/UpsertCampEventCabins',
        method: 'POST',
        params: Ext.JSON.encode(paramsList),
        success: function (response, request) {
            var res = Ext.JSON.decode(response.responseText)
            if (res.success == true) {
                console.log('success');
                thisController.refreshCampEventCabinsForm(form);
            }
            else {
                Ext.Msg.alert('Add CampEventCabins Failed', res.message);
            }
        },
        failure: function (response, opts) {
            Ext.Msg.alert('Error', '<p>There was an error trying to save the record:</p><br /><p>The status code was: ' + response.status + '</p><br/><p>The error occurred in the function onMainTabCampEventCabinsFormRender()<p>');
        }

    });
} 
```

MVC 控制器代码：

```
[HttpPost]
public JsonResult UpsertCampEventCabins(IList<ViewModels.CampEventCabin> model)
{
    //a breakpoint here shows that "model" is always null
    return Json(repo.UpsertCampEventCabins(model), JsonRequestBehavior.AllowGet);
} 
```

“console.log(Ext.JSON.encode(paramsList));”这一行 产生这个结果：

```
[{"idCampEventCabin":0,"Abbreviation":"BH","Accommodations":null,"Capacity":10,"idCabin":2,"Level":"","Name":"Blackhawk","Number":"E2","Type":"Boys","idCampEvent":2},{"idCampEventCabin":0,"Abbreviation":"CH","Accommodations":null,"Capacity":9,"idCabin":3,"Level":"","Name":"Chinook","Number":"D1","Type":"Girls","idCampEvent":2}] 
```

我注意到的一件奇怪的事情是，当我使用 Chrome 的开发人员工具检查表单数据时，JSON 字符串的末尾有一个额外的冒号。像这样：

```
[{"idCampEventCabin":0,"Abbreviation":"BH","Accommodations":null,"Capacity":10,"idCabin":2,"Level":"","Name":"Blackhawk","Number":"E2","Type":"Boys","idCampEvent":2},{"idCampEventCabin":0,"Abbreviation":"CH","Accommodations":null,"Capacity":9,"idCabin":3,"Level":"","Name":"Chinook","Number":"D1","Type":"Girls","idCampEvent":2}]: 
```

我希望控制器接受 JSON 数据作为 CampEventCabin 的一些集合。我试过“List”、“IList”、“IEnumerable”无济于事。我也尝试在不编码的情况下传递 params 对象。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T06:13:43.107

您的代码似乎只是好的。只需检查控制器流程。作为 ExtJS 的一部分，根据我的理解，您编写的所有代码都是正确的。

试一试 public JsonResult UpsertCampEventCabins(String model)

然后使用 json 解析器在控制器端进行操作。

谢谢

# javascript - 在记事本上写完之后，我的 javascript 程序应该放在哪里

> ID：16068374
> 
> 赞同：0
> 
> 时间：2013-04-17T19:18:56.280
> 
> 标签：javascript

我已经在记事本上以 javascript 形式编写了一个程序，但我不知道如何获取这些信息并制作一个程序，我有多个浏览器，所以如果我能弄清楚如何使用，我不在乎我使用哪一个它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:29:26.497

您可以将其直接放入 HTML 文件中，如下所示：

```
<html>
<head>
  <title></title>
  <script type="text/javascript">
    // Your JavaScript code here
  </script>
</head>
<body>
  <!-- Your HTML here -->
</body>
</html> 
```

或者您可以将您的 JavaScript 代码保存为 .js 文件并将其链接到您的 HTML 页面：

```
<html>
  <head>
    <title></title>
    <script src="javascriptfile.js"></script>
  </head>
  <body>
    <!-- Your HTML here -->
  </body>
</html> 
```

完成上述任一方法后，保存 HTML 文件并在 Web 浏览器中预览。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:24:44.450

您创建一个`.html`和`.js`文件并将javascript加载到：

```
<html>
   <head> 
      <title>My first page</title>
   </head>
   <body> 
     <!-- page HTML here-->
     <script type="text/javascript" src="your_file.js"></script>
   </body>
</html> 
```

或者，您可以将脚本放入`.html`文件中：

```
<html>
   <head> 
      <title>My first page</title>
   </head>
   <body> 
     <!-- page HTML here-->
     <script type="text/javascript">
        var name = "User";
        document.title = document.title.replace("My", name+"'s");
     </script>
   </body>
</html> 
```

请注意，我将 javascript 文件**放在了文档的末尾**。这使得页面加载速度更快——执行脚本会（几乎）**停止****所有活动**。但通常，javascript 位于`<head>`.
通常的做法：

```
<html>
   <head> 
      <title>My first page</title>
      <script type="text/javascript" src="your_file.js"></script>
   </head>
   <body> 
     <!-- page HTML here-->
   </body>
</html> 
```

也很高兴知道，脚本将在乳清的地方执行。这对`document.write`, `alert`and很重要`document.getElementById`（作为初学者，您可能不知道此功能，但稍后您将学会使用它）。举个例子：
此代码有效：

```
<div id="div_id">Hello world!</div>
<script type="text/javascript">
    var div_element = document.getElementById("div_id");
    alert(div_element.innerHTML);
</script>
<i>I will appear after you confirm alert()</i> 
```

这个返回错误，因为在执行`<div>`之后`<script>`并且不存在：

```
<script type="text/javascript">
    var div_element = document.getElementById("div_id");
    alert(div_element.innerHTML);   //ERROR: div_element is null!
</script>
<div id="div_id">Hello world!</div>
<i>I will appear after you confirm alert()</i> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-17T19:31:15.083

只需运行它

`node file.js`

安装节点后。

# python - 瓶服务器未完全重置，保留旧的，不正确的功能

> ID：16068379
> 
> 赞同：2
> 
> 时间：2013-04-17T19:19:18.380
> 
> 标签：python, web-applications, bottle

我有一个瓶子服务器正在运行，并为其添加了一个功能。我第一次在函数中犯了一个错误 - 我有 4 个输入参数，但只传递了一个。所以它崩溃了，给了我这个消息：

```
Traceback (most recent call last):
  File "C:\Python27\lib\site-packages\bottle-0.11.6-py2.7.egg\bottle.py", line 764, in _handle
  File "C:\Python27\lib\site-packages\bottle-0.11.6-py2.7.egg\bottle.py", line 1575, in wrapper
  File "C:\Python27\lib\site-packages\bottle-0.11.6-py2.7.egg\bottle.py", line 2294, in wrapper
  File "C:\Users\aschmitt\Dropbox\Python\MyBottle.py", line 93, in edit_item
    Synopsis = result[8]
TypeError: MakeComment() takes exactly 4 arguments (1 given) 
```

很公平，所以我去修复了这个错误。但是服务器不承认我已经修复了它！就像我的女朋友一样，它会记住我多年前犯的一些小错误。即使它肯定是固定的，它仍然给我同样的错误 - 我知道它是固定的，因为当我在不同的计算机上运行相同的代码时它可以工作。

就好像它正在缓存页面 - 即使在瓶服务器关闭后它也会进入它们。我试过使用`TEMPLATES.clear()`，但似乎没有任何效果。与清除 Chrome 中的缓存类似。我正在（并且一直是）使用重新加载器（即：）在调试模式下运行它`run(reloader = True, debug = True)`。

也许这是重新启动计算机的问题，我还没有尝试过。但老实说，我不想每次在代码中出错时都必须重新启动。

有谁知道解决这个问题的方法？

非常感谢，亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T00:27:14.433

（只是将我的评论转换为答案。）

> 你确定你关闭它正确吗？你能检查一下是否有任何瓶子过程仍在运行吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T14:17:44.770

Ron 是正确的，当我更仔细地查看进程列表时，有一个 python 实例仍在运行。在我杀死它并重新启动服务器之后，它使用了正确的代码。谢谢罗恩！

# if-statement - 为什么不评估此 Cobol 代码中的第二个 if 语句 (OpenCOBOL)？

> ID：16068385
> 
> 赞同：2
> 
> 时间：2013-04-17T19:19:35.547
> 
> 标签：if-statement, cobol, sentence, gnucobol

```
 identification division.
   program-id.      quick.
   environment division.
   data division.
   working-storage section.
   01 temp-val1 pic 9 value 1.
   01 temp-val2 pic 9 value 2.
   procedure division.
    mainline.
           perform encrypt.
           stop run.
    encrypt.
           if (temp-val1 = 1)
             display "1"
             display "2".
           end_if.
           if (temp-val2 = 2)
             display "2"
             display "1".
           end_if.
           display "outside the ifs". 
```

程序的输出很简单：
1
2

但我希望：

1
2
2
1
在 ifs 之外

我究竟做错了什么？我是否误解了第一个 if 中语句的句子结构或句号的位置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T17:32:27.187

代码有2个问题。一是之前的时期`end-if`。

另一个是`end_if`不一样的`end-if`。只有`end-if`在 Cobol 中使用。被`end_if`视为段落名称。因此，它不会（也不应该）产生编译器警告消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T19:27:37.733

反复试验证明问题是语法和句点放置错误的混合。

这确实提供了预期的输出。

```
 identification division.
   program-id.      quick.
   environment division.
   data division.
   working-storage section.
   01 temp-val1 pic 9 value 1.
   01 temp-val2 pic 9 value 2.
   procedure division.
    mainline.
           perform encrypt.
           stop run.
    encrypt.
           IF (temp-val1 = 1)
             display "1"
             display "2"
           END-IF
           if (temp-val2 = 2)
             display "2"
             display "1"
           END-IF
           display "outside the ifs". 
```

openCobol 程序员指南中的示例代码帮助我解决了这个问题。 [http://opencobol.add1tocobol.com/OpenCOBOL%20Programmers%20Guide.pdf](http://opencobol.add1tocobol.com/OpenCOBOL%20Programmers%20Guide.pdf)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T01:22:52.313

直截了当地说

```
 display "2".
   end_if. 
```

这 '。' 在 "2" 结束 if 语句之后，你有另一个 end_if 和 . Open-Cobol 可能会将其作为程序的结束 - 可能不是最好的解释。

正如尼克所说 **不要混合编码风格。

个人我会放一个'。在每个过程结束时单独一行

```
encrypt.
           IF (temp-val1 = 1)
             display "1"
             display "2"
           END-IF
           if (temp-val2 = 2)
             display "2"
             display "1"
           END-IF
           display "outside the ifs"

           . 
```

# python - 执行python代码时，gui为空

> ID：16068386
> 
> 赞同：0
> 
> 时间：2013-04-17T19:19:37.877
> 
> 标签：python, user-interface, tkinter

每当我执行此代码时，gui 上都不会显示任何内容。如果我使用网格放置标签和按钮，它工作正常。如果我使用 .place 放置标签，它不会显示任何内容。

```
from Tkinter import *

class Applet(Frame):
""" First attempt to make the program """
    def __init__(self, master):
            """ initialize the frame """
            Frame.__init__(self,master)
            self.login()
    #self.Signup()
    def login(self):
            self.Login_username = StringVar()
            self.Login_password = StringVar()
            self.Label1 = Label(self, text = 'Username: ').place(x = 0, y = 0)
            self.Label2 = Label(self, text = 'Password: ').place(x =50, y = 0)
            self.loguser = Entry(self, textvariable = self.Login_username, width = 15).place(x = 0, y = 10)
            self.logpass = Entry(self, textvariable = self.Login_password, width = 15, show = '*').place(x = 50, y = 10)
            self.button = Button(self, text = 'Login').place(x = 400, y = 0)

Top = Tk()
Top.title('test-gui')
app = Applet(Top)
Top.geometry('700x350')
Top.mainloop() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:22:56.817

您只是在创建一堆对象并将它们添加到本身并未添加到任何地方的界面中。

将它们添加到接口的最简单方法是`pack`调用`Applet`.

但是，您仍然会遇到一些问题。

首先，您试图明确地`place`将所有元素几乎彼此重叠，因此它们都将重叠成一团糟。

其次，该`place`方法返回`None`，因此您的所有成员变量都将是`None`，而不是实际的小部件。

这是解决所有三个问题的版本：

```
from Tkinter import *

class Applet(Frame):
    """ First attempt to make the program """
    def __init__(self, master):
            """ initialize the frame """
            Frame.__init__(self,master)
            self.login()
    #self.Signup()
    def login(self):
            self.Login_username = StringVar()
            self.Login_password = StringVar()
            self.Label1 = Label(self, text = 'Username: ')
            self.Label1.place(x = 0, y = 0)
            self.Label2 = Label(self, text = 'Password: ')
            self.Label2.place(x = 100, y = 0)
            self.loguser = Entry(self, textvariable = self.Login_username, width = 15)
            self.loguser.place(x = 0, y = 20)
            self.logpass = Entry(self, textvariable = self.Login_password, width = 15, show = '*')
            self.logpass.place(x = 100, y = 20)
            self.button = Button(self, text = 'Login')
            self.button.place(x = 400, y = 20)

Top = Tk()
Top.title('test-gui')
app = Applet(Top)
app.pack(fill='both', expand=True)
Top.geometry('700x350')
Top.mainloop() 
```

但是，您通常最好使用框和`pack`方法而不是显式调用`place`. 例如，`x = 100`instead of`x = 50`等，在我的系统上工作，使所有的东西都很好地布局——但是如果你的系统有不同的默认字体大小、小部件边界等，它最终会重叠或奇怪的间隔。

# vb.net - 检查互联网可用性

> ID：16068390
> 
> 赞同：0
> 
> 时间：2013-04-17T19:19:46.750
> 
> 标签：vb.net, visual-studio-2010, networking, ping

如果有互联网连接，我正在尝试 ping a，因此我决定按以下方式 ping google：

```
Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick
    Try
        If My.Computer.Network.Ping("www.google.com", 500) Then
            TextBox4.Text = "Internet Available"
        Else
            TextBox4.Text = "No Internet avilable"
        End If
    Catch ex As Exception
        TextBox4.Text = "Cable disconnected"
    End Try

End Sub 
```

它工作正常，但挑战是当我断开电缆时，应用程序似乎冻结了，这可能是由于 wch 使系统持续 ping 的时间。我的定时器延迟时间是2000。有没有更好的方法来解决这个问题。如果您提供代码或链接，我将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T10:30:46.430

1.  您的计时器在哪个线程中运行？这些类型的诊断需要放在一个工作线程中，与运行你的 UI 的工作线程分开。如果您还没有使用线程，那么现在就为您的股票计时器这样做。

2.  您也可以使用公开的 Win 7 / XP API 来检查 Internet 连接，以防万一。

我希望这能指引你走上正确的道路。

# actionscript-3 - 在 actionscript-3 中加载图像而不是使用绘制的对象时遇到问题

> ID：16068395
> 
> 赞同：0
> 
> 时间：2013-04-17T19:19:57.930
> 
> 标签：actionscript-3, flash, flash-cs5

我正在尝试从佳能拍摄球，这很好，但我想将佳能从绘制的佳能更改为我拥有的佳能图像。但是当我这样做时，当我点击舞台射击球时，我得到以下错误，而绘制版本的球按计划射击：

> TypeError：错误 #1009：无法访问空对象引用的属性或方法。在 code2/createNewBullet() 在 code2/mouseClickHandler()

**这是有效的代码：**

```
private function init():void {

        drawBoard = new MovieClip;
        drawBoard.graphics.beginFill(0xFFFFFF, 0); // white transparant
        drawBoard.graphics.drawRect(0, 0, gameWidth, gameHeight);
        drawBoard.graphics.endFill();
        addChild(drawBoard);
        // create canon
        canon = new MovieClip;
        canon = new MovieClip;
        canon.graphics.beginFill(0x000000);
        canon.graphics.drawRect(0, -10, 50, 20);
        canon.graphics.endFill();
        canon.rotation = -45;
        canon.x = 25;
        canon.y = gameHeight;
        addChild(canon); 
```

**这就是我试图使用图像而不是为大炮绘制的矩形** （（图像加载正常但会导致错误））

```
private function init():void {
        // create drawboard (the important movieclip, that holds all visible elements)
        drawBoard = new MovieClip;
        drawBoard.graphics.beginFill(0xFFFFFF, 0); // white transparant
        drawBoard.graphics.drawRect(0, 0, gameWidth, gameHeight);
        drawBoard.graphics.endFill();
        addChild(drawBoard);

        var canon:Loader = new Loader();
        var fileRequest:URLRequest = new URLRequest("cannon1.png");
        canon.load(fileRequest);
        canon.rotation = -45;
        canon.x = 25;
        canon.y = gameHeight;
        addChild(canon);

    } 
```

**如果需要，这是完整的代码：**

```
package {

// Copyright 2010-2011 - Seinia.com
// Find more crazy good AS3.0 tutorials and games on Seinia.com!

// imports
// --------------------------------------------------------------------------------------
import flash.display.MovieClip;
import flash.events.Event;
import flash.events.MouseEvent;
import flash.geom.Point;
import flash.events.*;
import flash.net.URLRequest;
import flash.display.Loader;
import flash.display.Sprite;

// Game class (MovieClip extension)
// --------------------------------------------------------------------------------------
public class code2 extends MovieClip {

    // game properties
    // --------------------------------------------------------------------------------------
    var drawBoard:MovieClip;
    var background:MovieClip;
    var gameWidth:int = 600;
    var gameHeight:int = 300;
    var gravity:Number = .4;
    var bullets:Array;
    var canon:MovieClip;

    // constructor
    // --------------------------------------------------------------------------------------
    public function code2():void {
        this.focusRect = false;
        this.init();
        addEventListener(Event.ENTER_FRAME, enterFrameHandler, false, 0, true);
        addEventListener(MouseEvent.CLICK, mouseClickHandler, false, 0, true);
        bullets = new Array();
    }

    // init the game
    // --------------------------------------------------------------------------------------
    private function init():void {
        // create drawboard (the important movieclip, that holds all visible elements)
        drawBoard = new MovieClip;
        drawBoard.graphics.beginFill(0xFFFFFF, 0); // white transparant
        drawBoard.graphics.drawRect(0, 0, gameWidth, gameHeight);
        drawBoard.graphics.endFill();
        addChild(drawBoard);

        var canon:Loader = new Loader();
        var fileRequest:URLRequest = new URLRequest("cannon1.png");
        canon.load(fileRequest);
        canon.rotation = -45;
        canon.x = 25;
        canon.y = gameHeight;
        addChild(canon);

    }

    // mouse click handler
    // --------------------------------------------------------------------------------------
    private function mouseClickHandler(event:MouseEvent):void {
        createNewBullet();
    }

    // function to create a new bullet
    // --------------------------------------------------------------------------------------
    private function createNewBullet():void {
        // init and draw bullet
        var bullet:MovieClip = new MovieClip;
        bullet.graphics.beginFill(0xff0000);
        bullet.graphics.drawCircle(0, 0, 10);
        bullet.graphics.endFill();
        // define bullet start point and speed
        var cos:Number = Math.cos(canon.rotation * Math.PI / 180);
        var sin:Number = Math.sin(canon.rotation * Math.PI / 180);
        var speed:Number = 8;
        bullet.x = canon.x + cos * canon.width;
        bullet.y = canon.y + sin * canon.width;
        bullet.vx = cos * speed;
        bullet.vy = sin * speed;
        bullets.push(bullet);
        addChild(bullet);
    }

    // enter frame handler
    // --------------------------------------------------------------------------------------
    private function enterFrameHandler(event:Event):void {
        for (var i = 0; i < bullets.length; i++ ) {
            // gravity
            bullets[i].vy += gravity;
            // move bullet
            bullets[i].x += bullets[i].vx;
            bullets[i].y += bullets[i].vy;
            // remove star from stage?
            if (bullets[i].y >= gameHeight) {
                removeChild(bullets[i]);
                bullets.splice(i, 1);
            }
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:40:18.523

`canon``createNewBullet()`在您的方法中没有范围。

您需要声明`canon`为类成员变量。

目前 canon 是该`init()`方法的局部变量。

正如评论者所指出的，您确实需要在声明中将规范更改为 Loader 类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:43:20.690

问题是

```
var canon:MovieClip; 
```

被定义为私有变量，并且在所有类方法中都可用，其中

```
var canon:Loader = new Loader(); 
```

您在 init 函数中定义的函数仅在此函数范围内可用。函数结束后，函数范围内定义的所有变量都将被丢弃。另请注意，第一个和第二个变量是两个不同的变量。

要解决您的问题，您应该将类​​变量设置为 Loader，并在 init 函数期间创建 loader 并将值分配给它。这样它就可以在这个类的所有函数中使用，就像这样

```
package {

// Copyright 2010-2011 - Seinia.com
// Find more crazy good AS3.0 tutorials and games on Seinia.com!

// imports
// --------------------------------------------------------------------------------------
import flash.display.MovieClip;
import flash.events.Event;
import flash.events.MouseEvent;
import flash.geom.Point;
import flash.events.*;
import flash.net.URLRequest;
import flash.display.Loader;
import flash.display.Sprite;

// Game class (MovieClip extension)
// ------------------------------------------------------------------------------------    --
public class code2 extends MovieClip {

    // game properties
    // --------------------------------------------------------------------------------    ------
    var drawBoard:MovieClip;
        var background:MovieClip;
    var gameWidth:int = 600;
    var gameHeight:int = 300;
    var gravity:Number = .4;
    var bullets:Array;
    var canon:Loader;

    // constructor
    // --------------------------------------------------------------------------------    ------
    public function code2():void {
        this.focusRect = false;
        this.init();
        addEventListener(Event.ENTER_FRAME, enterFrameHandler, false, 0, true);
        addEventListener(MouseEvent.CLICK, mouseClickHandler, false, 0, true);
        bullets = new Array();
    }

    // init the game
    // --------------------------------------------------------------------------------    ------
    private function init():void {
        // create drawboard (the important movieclip, that holds all visible elements)
        drawBoard = new MovieClip;
        drawBoard.graphics.beginFill(0xFFFFFF, 0); // white transparant
        drawBoard.graphics.drawRect(0, 0, gameWidth, gameHeight);
        drawBoard.graphics.endFill();
        addChild(drawBoard);

        canon = new Loader();
        var fileRequest:URLRequest = new URLRequest("cannon1.png");
        canon.load(fileRequest);
        canon.rotation = -45;
        canon.x = 25;
        canon.y = gameHeight;
        addChild(canon);

    }

    // mouse click handler
    // --------------------------------------------------------------------------------    ------
    private function mouseClickHandler(event:MouseEvent):void {
        createNewBullet();
    }

    // function to create a new bullet
    // --------------------------------------------------------------------------------    ------
    private function createNewBullet():void {
        // init and draw bullet
        var bullet:MovieClip = new MovieClip;
        bullet.graphics.beginFill(0xff0000);
        bullet.graphics.drawCircle(0, 0, 10);
        bullet.graphics.endFill();
        // define bullet start point and speed
        var cos:Number = Math.cos(canon.rotation * Math.PI / 180);
        var sin:Number = Math.sin(canon.rotation * Math.PI / 180);
        var speed:Number = 8;
        bullet.x = canon.x + cos * canon.width;
        bullet.y = canon.y + sin * canon.width;
        bullet.vx = cos * speed;
        bullet.vy = sin * speed;
        bullets.push(bullet);
        addChild(bullet);
    }

    // enter frame handler
    // --------------------------------------------------------------------------------    ------
    private function enterFrameHandler(event:Event):void {
        for (var i = 0; i < bullets.length; i++ ) {
            // gravity
                bullets[i].vy += gravity;
            // move bullet
            bullets[i].x += bullets[i].vx;
            bullets[i].y += bullets[i].vy;
            // remove star from stage?
            if (bullets[i].y >= gameHeight) {
                removeChild(bullets[i]);
                bullets.splice(i, 1);
            }
        }
    }
} 
```

}

# scala - 方法签名中允许子类型的特征

> ID：16068398
> 
> 赞同：3
> 
> 时间：2013-04-17T19:20:04.823
> 
> 标签：scala, generics, types

如何在继承特征中定义的方法中强制执行子类型？我在里面放什么？？？以下

```
trait Organism {
 def reproduce(org:???):Bool
}

class Amoeba extends Organism {
  def reproduce(org:Amoeba) = {// so cute..}

}
class Dinosaur extends Organism {
 def reproduce(org:Dinosaur) = { // so scary} 
} 
```

我的客户代码将类似于：

```
object BoozeParty {
 def gonuts() = {
    val (maleOrganism:Organism,femaleOrganism:Organism) = getOrganisms()

    maleOrganism.reproduce(femaleOrganism)

 }
} 
```

无论我通过 getOrganisms() 方法发送恐龙或变形虫，上面的代码都应该工作，因为它返回 (Organism,Organism) 的元组

我想要实现的两个概念是：

*   变形虫知道如何与变形虫交配，而恐龙知道如何与恐龙交配。所以让他们弄清楚错综复杂的细节。
*   恐龙不应该传给变形虫。只有变形虫到变形虫

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T19:56:32.160

通常使用称为 F 有界多态性的东西（参见[Scala School](http://twitter.github.io/scala_school/advanced-types.html#fbounded)）。

```
trait Organism[Self <: Organism[Self]] { self: Self =>
  def reproduceWith(org:Self):Boolean
}

class Amoeba extends Organism[Amoeba] {
  def reproduceWith(org:Amoeba) = ???
}

class Dinosaur extends Organism[Dinosaur] {
  def reproduceWith(org:Dinosaur) = ???
}

class Monster extends Dinosaur 
```

`Organism[X]`where`X`声明它必须是一个`Organism[X]`. 这意味着只有 an`X`可以传入，也可以进行 extends `Organism[X]`。

为了防止`Dinosaur extends Organism[Amoeba]`我添加了一个自我类型`self: Self =>`，告诉编译器这个特征应该与传入的类型混合。

该`mate`函数现在看起来像这样：

```
def mate[Species <: Organism[Species]](male:Species, female:Species) = 
  male reproduceWith female 
```

用法是这样的：

```
val a1 = new Amoeba
val a2 = new Amoeba

val d1 = new Dinosaur 
val d2 = new Monster 

mate(a1, a2)
mate(d1, d2)
// wont compile
// mate(a1, d1) 
```

如果您想对类型进行更多限制（以及更复杂的代码），您可以查看以下答案：[Scala: implementation method with return type of specific instance](https://stackoverflow.com/questions/14729996/scala-implementing-method-with-return-type-of-concrete-instance/14910318#14910318)

# zend-framework - 在注册表中找不到带有消息“插件名称“朋友”的异常“Zend_Loader_PluginLoader_Exception”；使用的路径：

> ID：16068400
> 
> 赞同：-1
> 
> 时间：2013-04-17T19:20:07.540
> 
> 标签：zend-framework, socialengine

嗨，我正在使用 Socialengine 4.5，我收到以下错误。有人可以根据错误消息和堆栈跟踪帮助我确定原因吗？

错误：

```
Error Code: 8094cd
exception 'Zend_Loader_PluginLoader_Exception' with message 'Plugin by name 'Friends' was not found in the registry; used paths:
Messages_View_Helper_: /var/www/vhosts/site.com/httpdocs/application/modules/Messages/views/helpers/
User_View_Helper_: /var/www/vhosts/site.com/httpdocs/application/modules/User/View/Helper/
Seaocore_View_Helper_: /var/www/vhosts/site.com/httpdocs/application/modules/Seaocore/View/Helper/
Advancedmembers_View_Helper_: /var/www/vhosts/site.com/httpdocs/application/modules/Advancedmembers/View/Helper/
Activity_View_Helper_: /var/www/vhosts/site.com/httpdocs/application/modules/Activity/View/Helper/
Core_View_Helper_: /var/www/vhosts/site.com/httpdocs/application/modules/Core/View/Helper/
Engine_View_Helper_: Engine/View/Helper/
Zend_View_Helper_: Zend/View/Helper/:/var/www/vhosts/site.com/httpdocs/application/modules/Album/views/helpers/:/var/www/vhosts/site.com/httpdocs/application/modules/Core/views/helpers/' in /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/Loader/PluginLoader.php:406 
```

堆栈跟踪：

```
#0 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/View/Abstract.php(1120): Zend_Loader_PluginLoader->load('Friends')
#1 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/View/Abstract.php(569): Zend_View_Abstract->_getPlugin('helper', 'friends')
#2 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/View/Abstract.php(336): Zend_View_Abstract->getHelper('friends')
#3 /var/www/vhosts/site.com/httpdocs/application/modules/Core/views/scripts/_composeTag.tpl(31): Zend_View_Abstract->__call('friends', Array)
#4 /var/www/vhosts/site.com/httpdocs/application/modules/Core/views/scripts/_composeTag.tpl(31): Zend_View->friends()
#5 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/View.php(108): include('/var/www/vhosts...')
#6 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/View/Abstract.php(835): Zend_View->_run('/var/www/vhosts...')
#7 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/View/Helper/Partial.php(103): Zend_View_Abstract->render('_composeTag.tpl')
#8 [internal function]: Zend_View_Helper_Partial->partial('_composeTag.tpl', 'core')
#9 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/View/Abstract.php(342): call_user_func_array(Array, Array)
#10 /var/www/vhosts/site.com/httpdocs/application/modules/Messages/views/scripts/messages/compose.tpl(201): Zend_View_Abstract->__call('partial', Array)
#11 /var/www/vhosts/site.com/httpdocs/application/modules/Messages/views/scripts/messages/compose.tpl(201): Zend_View->partial('_composeTag.tpl', 'core')
#12 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/View.php(108): include('/var/www/vhosts...')
#13 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/View/Abstract.php(835): Zend_View->_run('/var/www/vhosts...')
#14 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/Controller/Action/Helper/ViewRenderer.php(903): Zend_View_Abstract->render('messages/compos...')
#15 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/Controller/Action/Helper/ViewRenderer.php(924):

Zend_Controller_Action_Helper_ViewRenderer->renderScript('messages/compos...', NULL)
#16 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/Controller/Action/Helper/ViewRenderer.php(963): Zend_Controller_Action_Helper_ViewRenderer->render()
#17 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/Controller/Action/HelperBroker.php(277): Zend_Controller_Action_Helper_ViewRenderer->postDispatch()
#18 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/Controller/Action.php(523): Zend_Controller_Action_HelperBroker->notifyPostDispatch()
#19 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/Controller/Dispatcher/Standard.php(289): Zend_Controller_Action->dispatch('composeAction')
#20 /var/www/vhosts/site.com/httpdocs/application/libraries/Zend/Controller/Front.php(946): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))
#21 /var/www/vhosts/site.com/httpdocs/application/modules/Core/Bootstrap.php(75): Zend_Controller_Front->dispatch()
#22 /var/www/vhosts/site.com/httpdocs/application/libraries/Engine/Application.php(160): Core_Bootstrap->run()
#23 /var/www/vhosts/site.com/httpdocs/application/index.php(205): Engine_Application->run()
#24 /var/www/vhosts/site.com/httpdocs/index.php(24): include('/var/www/vhosts...')
#25 {main}` 
```

正如 Kirk Hammett 所说，问题出在 ComposeTag.tlp 代码上 请有人告诉我该怎么做：

```
<?php
/**
 * SocialEngine
 *
 * @category   Application_Core
 * @package    Core
 * @copyright  Copyright 2006-2010 Webligo Developments
 * @license    http://www.socialengine.com/license/
 * @version    $Id: _composeTag.tpl 9900 2013-02-14 02:20:25Z shaun $
 * @author     John
 */
?>

<?php $this->headScript()
    ->appendFile($this->layout()->staticBaseUrl . 'externals/autocompleter/Observer.js')
    ->appendFile($this->layout()->staticBaseUrl . 'externals/autocompleter/Autocompleter.js')
    ->appendFile($this->layout()->staticBaseUrl . 'externals/autocompleter/Autocompleter.Local.js')
    ->appendFile($this->layout()->staticBaseUrl . 'externals/autocompleter/Autocompleter.Request.js')
    ->appendFile($this->layout()->staticBaseUrl . 'application/modules/Core/externals/scripts/composer_tag.js') ?>

<script type="text/javascript">
  en4.core.runonce.add(function() {
    composeInstance.addPlugin(new Composer.Plugin.Tag({
      suggestOptions : {
        'url' : '<?php echo $this->url(array(), 'default', true) . '/user/friends/suggest' ?>',
        'data' : {
          'format' : 'json'
        }
      },
      'suggestProto' : 'local',
      'suggestParam' : <?php echo Zend_Json::encode($this->friends()) ?>
    }));
  });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T20:24:08.367

SOLUTTION:

CHANGE :    

```
'suggestParam' : <?php echo Zend_Json::encode($this->friends()) ?> 
```

FOR:  

```
'suggestParam' : <?php echo $this->action('suggest', 'friends', 'user', array('sendNow' => false, 'includeSelf' => true)) ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T14:26:43.363

堆栈跟踪表明您在视图中调用了函数 friends() 错误：

```
httpdocs/application/modules/Core/views/scripts/_composeTag.tpl 
```

可能看起来像

```
$this->friends() 
```

或类似的东西。那是您应该继续搜索此问题的原因的地方。

# linux - 在 CRAMFS 文件系统上设置权限

> ID：16068401
> 
> 赞同：0
> 
> 时间：2013-04-17T19:20:12.800
> 
> 标签：linux, permissions, readonly, uid

我正在尝试创建一个 CRAMFS 文件系统，但正在努力争取权限。如何设置权限，以便在主机挂载文件系统时它将是 root:root？

一旦创建了 CRAMFS，它就是一个只读 FS，因此不会发生任何更改；因此我需要在运行 mkcramfs 之前设置更改。

目前，我可以通过设置 777 来使事情正常进行；但是在将它安装到设备上并检查权限后，我发现它们被设置为 1000:232 而不是 root:root。显然我不能 chown - 只读。而且由于磁盘空间不足，我也无法在设备上解压、调整和重新打包 CRAMFS。

我怀疑它与设备上的 root 用户和组的 UID/GID 以及在打包 CRAMFS 之前正确设置这些有关。顺便说一句 - 设备上的 Linux 受限版本没有 ID 命令。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T20:48:05.160

要构建具有 root 权限的文件系统，您需要是 root。无论是真的还是虚拟的：

```
sudo mkcramfs root-dir cramfs.img 
```

或者

```
fakeroot mkcramfs root-dir cramfs.img 
```

sudo 确实为您提供了 root 权限，但对于此操作并不是必需的。fakeroot 使用 shim 库执行 LD_PRELOAD 以使正在运行的应用程序相信它确实是 root （即使它不是）。fakeroot 是常用的 debian 软件包维护者，以“root”身份构建软件包，而不是真正的 root。

# c# - 动态 String.Format 取决于参数

> ID：16068403
> 
> 赞同：5
> 
> 时间：2013-04-17T19:20:16.913
> 
> 标签：c#

给出以下示例：

```
string amountDisplay = presentation.Amount == 1 ? "" : String.Format("{0} x ", presentation.Amount); 
```

无论如何要使用 String.Format 以便它根据属性进行格式化，而不必对参数的“值”进行条件处理？

另一个用例：

```
String.Format("({0}) {1}-{2}", countryCode, areaCode, phonenumber); 
```

如果我只有电话号码，我最终会得到类似“() -5555555”的东西，这是不可取的。

另一个用例：

```
String.Format("my {0} has {1} cat[s]", "Aunt", 3) 
```

在这种情况下，如果值 > 1，我想将 s 包含在 [] 中。

String.Format 是否有任何黑色“语法”根据参数值或 null 删除代码部分？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:27:00.543

并不真地。当然，您可以为复数 [s] 破解一些东西，但这不是匹配所有用例的通用解决方案。

无论如何，您都应该检查输入的有效性。如果您希望`areaCode`它不为 null，并且它是一个可以为 null 的类型，例如`string`，请在方法的开头进行一些检查。例如：

```
public string Foo(string countryCode, string areaCode, string phoneNumber)
{
    if (string.IsNullOrEmpty(countryCode)) throw new ArgumentNullException("countryCode");
    if (string.IsNullOrEmpty(areaCode)) throw new ArgumentNullException("areaCode");
    if (string.IsNullOrEmpty(phoneNumber)) throw new ArgumentNullException("phoneNumber");

    return string.Format(......);
} 
```

补偿用户输入的一些验证错误不是 UI 的工作。如果数据错误或丢失，请不要继续。它只会给你带来奇怪的错误和很多痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:33:38.413

您也可以尝试 PluralizationServices 服务。像这样的东西：

```
using System.Data.Entity.Design.PluralizationServices;

string str = "my {0} has {1} {3}";
PluralizationService ps = PluralizationService.CreateService(CultureInfo.GetCultureInfo("en-us"));
str = String.Format(str, "Aunt", value, (value > 1) ? ps.Pluralize("cat") : "cat"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T19:23:48.513

尝试使用条件运算符：

```
string str = "my {0} has {1} cat" + ((value > 1) ? "s" : "");

str = String.Format(str, "Aunt", value); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T19:25:10.483

只解决了第二个问题，但是：

```
int x = 3;
String.Format("my {0} has {1} cat{2}", "Aunt", x, x > 1 ? "s" : ""); 
```

# c++ - 需要将 MS Visual C++ 移植到 Linux G++

> ID：16068415
> 
> 赞同：4
> 
> 时间：2013-04-17T19:21:02.543
> 
> 标签：c++, linux, windows, visual-c++, porting

首先我想说我是计算生物物理学家，而不是软件工程师，所以我的编程知识仅限于科学计算（我使用 C++、Matlab 和 R）。

我最近被要求将一个巨大的代码包（约 10,000 行）从 MS Visual C++ 移植到 Linux，我一直在那里开发一些代码。他们知道我正在使用 Linux 编写代码，直到将近一年后才告诉我他们希望它与 Windows 中的旧代码集成。

老实说，我不知道从哪里开始。我能够组合一个 MakeFile 并成功编译，但我遇到了分段错误，经过 valgrind 的调查，这可能与数百个管理不善的内存分配有关。有没有一个适合我开始的好地方，不需要我学习 MS Visual C++ 就可以让它在 Linux 中工作？任何帮助将不胜感激。谢谢！

编辑：感谢到目前为止的所有帮助。我绝对是“真正”编程的新手，所以我什至不总是清楚我应该如何描述我的问题。感谢您的理解并提供了一些良好的起点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T19:50:04.463

我将首先打开编译器警告并修复所有警告。

```
-Wall -Wextra -Wstrict-aliasing -pedantic -Werror -Wunreachable-code 
```

如果您修复所有警告，它将解决许多您可能从未见过的问题。尤其是在不同编译器之间移植时（因为这些代表会影响移植的问题，因为不同的编译器可以做不同的事情）。

在 MS 编译器上时。将警告级别提高到 4，并告诉编译器将所有警告视为错误。这些结合起来会产生很多错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T19:39:45.973

有了这个代码库大小，如果你从修复你已经注意到的随机内存管理问题开始，你很快就会有一个工作的应用程序。这假设您正在正确诊断每个段错误，这从问题中不是很明显。了解新代码究竟做了什么以及如何与调试过程齐头并进的过程。

如果它已经在 Linux 中编译，您不需要了解任何其他操作系统，假设您在尝试使其工作时没有“注释掉”任何您不理解的代码，或者避免引用 Windows 特定库这可能在应用程序中发挥了作用。

# ajax - 如何在 Backbone 中通过 ajax 登录时启用表单中的自动填充

> ID：16068417
> 
> 赞同：1
> 
> 时间：2013-04-17T19:21:04.833
> 
> 标签：ajax, forms, backbone.js

我想用backbone.js 创建一个基于ajax 的登录。那是我的表格：

```
<form class="form-horizontal" method="post">
  <div class="control-group">
    <label class="control-label" for="inputEmail">E-Mail</label>
    <div class="controls">
      <input type="text" id="inputEmail" placeholder="E-Mail">
    </div>
  </div>
  <div class="control-group">
    <label class="control-label" for="inputPassword">Password</label>
    <div class="controls">
      <input type="password" id="inputPassword" placeholder="Password">
    </div>
  </div>
  <div class="control-group">
    <div class="controls">
      <input id="loginButton" type="submit" class="btn btn-success" name="Submit" value="Submit">
      <span class="btn btn-primary" onclick="window.location.href='#register';">Register</span>
    </div>
  </div>
</form> 
```

我通过单击捕获事件并处理登录。到目前为止一切都很好。但是，浏览器不允许保存登录信息。LastPass 或浏览器内部。

有没有办法触发这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T02:07:57.040

您应该触发表单的提交事件。这样几乎所有的浏览器都承认你正在做的是一个实际的提交。试试看，让我知道。

# jquery - jQuery appendTo 函数不起作用

> ID：16068425
> 
> 赞同：1
> 
> 时间：2013-04-17T19:21:40.720
> 
> 标签：jquery

为什么我的功能不起作用：

[小提琴](http://jsfiddle.net/c5r6P/25/)

HTML：

```
<div class="cash">1234.00</div>
<div class="cash">123456.00</div>
<div id="total"></div> 
```

JS：

```
function formatPrice(price) {
    return price.reverse().replace(/((?:\d{2})\d)/g, '$1 ').reverse();
}

// Need to extend String prototype for convinience
String.prototype.reverse = function() {
    return this.split('').reverse().join('');
}

$('.cash').each(function(){
    $(this).html().formatPrice().appendTo('body');
}); 
```

我也试过这个，没有运气：

```
$('.cash').each(function(){
    $(this).html() = i;
    formatPrice(i).appendTo('body');
}); 
```

* * *

即使将其剥离为基本功能，它仍然不会附加我的东西......我失去了我的魔力吗？

```
$('.cash').each(function(){
    $(this).html().appendTo('body');
}); 
```

谢谢

更新：该功能只是假设这样做：

formatPrice('1234.00') //转换为“1 234.00” formatPrice('123456.00') //转换为“123 456.00”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T19:25:17.800

为了使您的示例正常工作，您应该修复这部分代码：

```
$('.cash').each(function(){
    $('body').append(formatPrice($(this).html()));
}); 
```

这是[小提琴](http://jsfiddle.net/c5r6P/28/)

您不能 run `html().formatPrice()`，因为`formatPrice()`在您的情况下是独立函数，而不是字符串对象的方法。

如果要替换里面的文字`div.cash`，请使用以下代码：

```
$('.cash').each(function(){
    $(this).html(formatPrice($(this).html()));
}); 
```

这是[更新的小提琴](http://jsfiddle.net/c5r6P/32/)

如果您希望能够`formatPrice()`用于任何字符串，请执行以下操作：

```
String.prototype.formatPrice = function() {
    return this.reverse().replace(/((?:\d{2})\d)/g, '$1 ').reverse();
}

$('.cash').each(function(){
    $(this).html(function(i, h) { return h.formatPrice() });
}); 
```

这是[小提琴](http://jsfiddle.net/c5r6P/34/)

因此，只需选择您喜欢的选项并使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-17T19:23:53.720

`$(this).html()`返回文本中的 html，而不是包含该`appendTo`函数的 jQuery 对象。

你可以做：

```
$($(this).html()).appendTo('body'); 
```

顺便说一句，您不应该“选择 html”并假设将其传递给您的`formatPrice`函数是安全的。

这样做，它更干净：

```
<div class="cash" data-cash="1234.00">1234.00</div>

$('body').append(formatPrice($(this).attr("data-cash"))); 
```

# scala - 坚持使用 Scala 从 Twitter API 获取访问令牌

> ID：16068428
> 
> 赞同：0
> 
> 时间：2013-04-17T19:21:42.843
> 
> 标签：scala, playframework, twitter, twitter-oauth

我正在我的网站上将登录与 Twitter 集成，我现在完全陷入困境。我正在遵循本指南：（[https://dev.twitter.com/docs/auth/implementing-sign-twitter](https://dev.twitter.com/docs/auth/implementing-sign-twitter)）并且正在使用 Play 框架在 Scala 中进行操作。

我读过很多人一直收到 401 Unauthorized 错误，我之前在“第 1 步：获取请求令牌”中也是如此，但我通过不传递我在这里找到的 oauth_callback_url 解决了这个问题：[https：/ /github.com/cyrus7580/twitter_api_examples/blob/master/src/SampleTwitterRequests.java](https://github.com/cyrus7580/twitter_api_examples/blob/master/src/SampleTwitterRequests.java)

现在我的问题是“第 3 步：将请求令牌转换为访问令牌”，最后一步......问题是当我对 oauth/access_token 端点进行 POST 时。我得到 401 - Unauthorized - Invalid request token。

我从“步骤 2”中获得了请求令牌和验证者。

第 3 步的代码如下所示：

```
val token = "R6qe*********************PbTAvlHw" //Got this from step 2
val verifier = "s1jWnOz********************eJEU" //Got this from step 2
val twitterConsumerKey = "iLRU**********uQ"
val twitterConsumerSecret = "DsdGs***********dgfd2"
val signatureMethod = "HMAC-SHA1"
val version = "1.0"

val nonce = getNonce() //method return a 32character random nonce (worked in step 2)
val timeStamp = (System.currentTimeMillis / 1000).toString

    val parameterString:String = 
       "oauth_consumer_key=" + twitterConsumerKey + 
      "&oauth_nonce=" + nonce + 
      "&oauth_signature_method=" + signatureMethod + 
      "&oauth_timestamp=" + timeStamp +
      "&oauth_token=" + URLEncoder.encode(token, "UTF-8") +
      "&oauth_version=" + version  

      val baseString:String = "POST&"+ URLEncoder.encode("https://api.twitter.com/oauth/access_token", "UTF-8")+"&"+ URLEncoder.encode(parameterString2, "UTF-8")   
      val signature = getSignature(twitterConsumerSecret, baseString, "HmacSHA1")

      val data = "OAuth " +
          "oauth_consumer_key=\"" + twitterConsumerKey +
      "\",oauth_signature_method=\"" + signatureMethod +
      "\",oauth_timestamp=\"" + timeStamp +
      "\",oauth_nonce=\"" + nonce +
      "\",oauth_version=\"" + version + 
      "\",oauth_signature=\"" + signature + 
      "\",oauth_token=\"" + URLEncoder.encode(token, "UTF-8") + "\""

      Async{
      WS.url("https://api.twitter.com/oauth/request_token").withHeaders("Authorization" -> data).post("oauth_verifier="+URLEncoder.encode(verifier, "UTF-8")).map(response => {
        Logger.info(response.body.toString()) //Invalid request token
        Logger.info(response.status.toString) //401
        Logger.info(response.statusText) //Unauthorized
        Ok("Welcome")
      })
    } 
```

getSignature(twitterConsumerSecret, baseString, "HmacSHA1") 看起来像这样：

```
def getSignature(consumerSecret:String, baseString:String, algorithm:String):String = {
  val key:String = consumerSecret + "&"
  val signingKey:SecretKeySpec = new SecretKeySpec(key.getBytes(), algorithm)

  try{
  var mac: Mac = null;
      mac = Mac.getInstance(algorithm);
      mac.init(signingKey);

  val rawHmac:Array[Byte] = mac.doFinal(baseString.getBytes());

  val oauth_signature:String =  new sun.misc.BASE64Encoder().encode(rawHmac)
  val oauth_signatureFinal:String = URLEncoder.encode(oauth_signature, "UTF-8")

  return oauth_signatureFinal
  }
} 
```

我希望有人对此有任何想法。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:10:44.297

你错过了`oauth_verifier`

当用户在点击“是的，我同意这个应用程序”后从 Twitter 返回时，Twitter 将回帖给您`oauth_token`，并且`oauth_verifier`.

要获取访问令牌，您应该将值添加到`parameterString`某处`oauth_verifier`。因此，假设 oauthVerifier 是来自 Twitter 的值，`parameterString`应该在某处添加：

`parameterString = parameterString + "&oauth_verifier=" + oauthVerifier`

我还注意到这一行使用 parameterString2，而不是 parameterString...我从未见过 parameterString2 定义

```
val baseString:String = "POST&"+URLEncoder.encode("https://api.twitter.com/oauth/access_token", "UTF-8")+"&"+URLEncoder.encode(parameterString2, "UTF-8") 
```

# maven - 在 Jenkins 上运行我的 Testng 测试套件时遇到问题

> ID：16068429
> 
> 赞同：1
> 
> 时间：2013-04-17T19:21:46.593
> 
> 标签：maven, selenium, jenkins, testng, surefire

这是我看到的堆栈跟踪错误

```
[INFO] --- maven-surefire-plugin:2.8.1:test (default-test) @ eselenium-smartpearsonplayer-pageobjects ---
[INFO] Surefire report directory: c:\jenkins\workspace\MediaPlayerTest\target\surefire-reports
There are no tests to run. 
```

我知道这可能是由于任何原因。因此，让我尝试为您提供更多信息，尽管这是一个长期的目标，但也许您可以提供帮助。我正在使用 selenium webdriver 2.29 编写测试。我也在用 Maven 构建。我正在尝试使用 testng 来配置我正在使用的测试。我正在使用 jenkins 运行 maven 项目，并且我正在尝试进行“干净验证”，有时是“干净测试”，因为我不知道两者之间的区别。

在本地，我正在使用 eclipse。在本地，我可以使用 maven test 在 maven 上运行测试，并使用 maven verify。

这是我的pom中的一些东西。

```
<!-- attempt to use surefire to run tests -->
            <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.8.1</version>
                <configuration>
                    <suiteXmlFiles>
                             <suiteXmlFile>src\test\resources\testng\TestBrowserPOC_Test.xml</suiteXmlFile>
                    </suiteXmlFiles>
                </configuration>
            </plugin>
            <!-- end attempt --> 
```

同样，当我在 Eclipse 上进行 Maven 验证时，测试运行良好。

这是我的testng xml。

```
<!DOCTYPE Suite SYSTEM "http://testng.org/testng-1.0.dtd">
    <suite name="BrowserPOC_Tests">

        <!-- class does not exist -->
        <!-- <test name="Demo Test"> <parameter name="url"     value="src/test/resources/testData/login.html"></parameter> 
            <groups> <run> <exclude name="errorDetector"></exclude> </run> </groups> 
            <classes> <class name="com.pearson.demotests.DemoTestIT" /> </classes>         </test> -->
        <test name="POC test">
            <groups>
                <run>
                    <include name="volumeTest"></include>
                </run>
            </groups>
            <classes>
                <class name="com.pearson.poc_tests.BrowserPOCIT" />
            </classes>
        </test>
</suite> 
```

现在我将尝试更改我的 xml 的名称以遵循“命名约定”，看看是否有任何作用。同样，测试在 eclipse 上运行良好，只是在 jenkins 上运行良好。我不确定从这里做什么或我需要什么其他信息。我从这里开始的步骤只是为了从詹金斯专家那里获得更多帮助。

哦，我认为我对测试 xml 的命名约定是正确的。我还认为我正在使用构建为 maven 的自由式项目。我应该使用“mvn clean test”而不是“clean test”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T22:24:50.767

谢谢大家。事实证明，我的 jenkins 配置中有两个存储库。Jenkins 在错误的项目中寻找测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T01:21:57.777

我过去使用过 Maven 故障安全插件。下面是我的配置。你会跑`mvn clean verify`。`mvn clean`始终建议使用，因为它会在编译和运行测试之前删除您的目标目录。

```
<properties>
        <functionalSourceDirectory>src/itest</functionalSourceDirectory>
</properties>

<plugin>
    <artifactId>maven-failsafe-plugin</artifactId>
    <version>2.11</version>
    <configuration>
       <testSourceDirectory>${functionalSourceDirectory}</testSourceDirectory>
       <suiteXmlFiles>
         <suiteXmlFile>src/itest/resources/testng.xml</suiteXmlFile>
       </suiteXmlFiles>
     </configuration>
     <executions>
        <execution>
           <id>verify</id>
           <phase>verify</phase>
           <goals>
             <goal>verify</goal>
           </goals>
        </execution>
     </executions>
 </plugin> 
```

# php - Youtube API：服务帐号

> ID：16068433
> 
> 赞同：4
> 
> 时间：2013-04-17T19:22:08.120
> 
> 标签：php, google-api, youtube-api, youtube-data-api, service-accounts

我需要有关 YouTube API 的帮助。我想我必须使用`service account`，因为我需要超过 10 个用户使用同一个帐户。我不确定为什么我会收到播放列表请求的空项目列表。我应该在@developer.gserviceaccount.com 和我的电子邮件之间建立一些联系吗？我尝试将其添加为备用电子邮件，但它已与另一个 Google 帐户相关联。

这是我使用的代码：

```
const CLIENT_ID = 'xx.apps.googleusercontent.com';
const SERVICE_ACCOUNT_NAME = 'xx@developer.gserviceaccount.com';
const KEY_FILE = 'xx-privatekey.p12';

$client = new Google_Client();
$key = file_get_contents(__DIR__."/../../components/google-api-php-client/src/".KEY_FILE );
$client->setClientId(CLIENT_ID);
$client->setAssertionCredentials(new Google_AssertionCredentials(
        SERVICE_ACCOUNT_NAME,
        array('https://www.googleapis.com/auth/youtube'),
        $key)
);

$youtube = new Google_YoutubeService($client);
$playlistItemsResponse = $youtube->playlists->listPlaylists('snippet',array('mine'=>true));
var_dump($playlistItemsResponse); 
```

这是回应：

```
array (size=4)
'kind' => string 'youtube#playlistListResponse' (length=28)
'etag' => string '"8TOPSm5ek9Nh6woLJrPMROQl6rM/GERGKSwb6YJY5lZXdcTaZAMM1WU"' (length=57)
'pageInfo' =>
array (size=2)
'totalResults' => int 0
'resultsPerPage' => int 5
'items' =>
array (size=0)
empty 
```

# ruby-on-rails - 使用 Rspec 在 Rails 中测试视图异常

> ID：16068435
> 
> 赞同：0
> 
> 时间：2013-04-17T19:22:15.630
> 
> 标签：ruby-on-rails, ruby, rspec, capybara

如何编写一个测试来遍历 User#Show 的所有实例（对于每个用户）以查看是否引发了异常？

我了解如何编写测试以检查对象中是否包含某些数据。但是不知道如何在确保它不会抛出 500 错误等的同时对每个进行迭代。

我可能只是有温度。大脑冻结，但请帮帮我。

任何帮助或指南表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:38:11.057

你可以这样做。这假设您已经创建并保存了用户到您的数据库。

```
describe UsersController do
  User.each do |user|
    it "doesn't return a 500 error for user #{user.name}" do
      get :show, :id => user.id
      assert_response(:success)
    end
  end
end 
```

您的 Ruby 代码不仅必须位于 an 内部，`it`因此您可以使用它来循环然后`it`稍后执行 s。

# c++ - c ++将图像加载到对话框MFC

> ID：16068436
> 
> 赞同：1
> 
> 时间：2013-04-17T19:22:15.783
> 
> 标签：c++, mfc, dialog

在 MFC 中，我想将图像加载到对话框窗口，C++ 中的图片控件我使用这些方法：

```
void diaalo::OnBnClickedOk()
{

    if(access("BMP",0))
    {
        MessageBox(L"Отсутствует папка BMP,\nгде должны находится файлы *.bmp\nдля работы с картинками \n",L"Внимание!",MB_ICONINFORMATION);
        return;
    }

    if(access("BMP\\GAZ.bmp",0))
    {
        MessageBox(L"В папке BMP отсутствует файл GAZ.bmp",L"Внимание!",MB_ICONINFORMATION);
        return;
    }

    HBITMAP startBitmap = (HBITMAP)LoadImage(NULL, L"BMP\\GAZ.bmp", IMAGE_BITMAP,0,0, LR_LOADFROMFILE);
    if (!startBitmap)
    {
        MessageBox(L"В папке BMP ошибочная структура файла GAZ.bmp", L"Внимание!",MB_ICONINFORMATION);
        AfxMessageBox(L"111");
        return;
    }

    st1->SetBitmap(startBitmap);

    AfxMessageBox(L"222");
} 
```

有我的程序，11mb zip： [http ://ge.tt/1hkPdLe/v/0?c](http://ge.tt/1hkPdLe/v/0?c)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-18T06:30:23.247

静态控件IDC_STATIC1的类型必须是“Bitmap”而不是“Frame”。

![在此处输入图像描述](https://i.stack.imgur.com/qjscR.png)

# c# - 如何仅在左侧有 Datalist 标题

> ID：16068438
> 
> 赞同：0
> 
> 时间：2013-04-17T19:22:20.347
> 
> 标签：c#, datalist, html-table

我有一个数据列表，它在三列中显示数据。每列代表一组结果。所以我需要在左边有标题，所以它看起来像下面这样：

```
**plan**                   HMO       PPO      Indem
**Vendor Name**            vendor1  vendor2   vendor3 
```

等等。我能够将数据正确显示为三列，但我不知道如何获取左侧的标题。目前，我在左侧数据列表旁边使用单独的表格来显示具有固定高度的每一行的标题名称。但是有一个问题，如果我在 datalist 中的一个单元格数据的内容比预期的大，那么对齐就会搞砸。请建议我最好的方法。

这是一个问题，尤其是在跨浏览器测试中。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:51:09.993

这个解决方案对我有用：

```
$(".tableRight tr").each(function(i) {
    $("..tableLeft tr").eq(i).height($(this).height());
}); 
```

# openerp - OpenERP web 模块：从 JQuery 调用 python 函数

> ID：16068441
> 
> 赞同：0
> 
> 时间：2013-04-17T19:22:25.830
> 
> 标签：openerp

我是 openERP 的新手，我正在创建一个 web 模块。在这个模块中，我想读取服务器上的文件，在屏幕上显示其内容并使用按钮打印屏幕内容。

我已经创建了打开文件并返回其内容的 python 函数。我制作了一个小部件，显示一个触发打印机调用的按钮。但是，我不知道如何从 JQuery 代码中调用 python 函数。

这是我的模块的外观：

```
<web_example>
  +-- __openerp__.py
  +-- __init__.py
  +-- web_example.py
  +-- web_example_view.xml
  +-- static/
       +-- src/
            +-- js/
                +--first_module.js
            +-- xml/
                +--web_example_view.xml 
```

这是我的python代码：

```
from osv import fields, osv
import re

class web_example(osv.osv):

    _name='web.example'
    #_table ='test_printer'
    _description = 'Test pour l\'impression de fichiers'

    def button_function(self, cr, uid, ids, context=None):
        filename = '/home/stage2013/Documents/testlecture'
        fichier = open('/home/stage2013/Documents/testlecture', 'r')
        toutesleslignes = fichier.readlines()
        fichier.close()
        print toutesleslignes
        return toutesleslignes  

web_example() 
```

这是我的 JS 代码：我想要在文件中获取函数 def button_function(...) 的结果。

```
// static/src/js/first_module.js
openerp.web_example = function (instance) {
    instance.web.client_actions.add('example.action', 'instance.web_example.Action');
    instance.web_example.Action = instance.web.Widget.extend({
        template: 'web_example.action',
        events: {
            'click .oe_web_example_print button' : 'print_start',
            'click .oe_web_example_load button' : 'load_start'
        },
        init: function () {
            this._super.apply(this, arguments);
        },

        print_start: function () {
            window.print();
        },
        load_start: function () {
            //CALL THE PYTHON FUNCTION FROM WEB_EXAMPLE.PY
        }

    });
}; 
```

和 xml (web_example.xml)：

```
<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <record model="ir.actions.client" id="action_client_example">
            <field name="name">Example Client Action</field>
            <field name="tag">example.action</field>
        </record>        

        <menuitem action="action_client_example" id="test_printer_2" parent="product.menu_products" name="Test impression 2"/>
    </data>
</openerp> 
```

模板（static/src/xml/web_example.xml）：第一个按钮是在JS中加载文件，第二个是打印页面

```
<templates>
<div t-name="web_example.action" class="oe_web_example oe_web_example_stopped">
    <p class="oe_web_example_load">
        <button type="button">Load file</button>
    </p>
    <p class="oe_web_example_print">
        <button name="button_function" type="object"  >Imprimer</button>
    </p>
    <textarea id="response_fichier"></textarea>
</div>
</templates> 
```

谁能帮我从 JS 代码中调用 python 函数？或者告诉我我是否以错误的方式这样做......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T11:34:14.273

```
new instance.web.Model("web.example").call("button_function",[ids]).then(function(res) {
   //res is the result returned by the python function
 }); 
```

如果你想传递“ids”之外的其他参数，它会像： call("button_function",[ids,param1,param2]) 在python中：

```
def button_function(self, cr, uid, ids, param1, param2, context=None) 
```

您还应该知道这些调用是异步的，因此 python 函数的调用可能比您预期的要晚。这里解释了一些东西[http://doc.openerp.com/trunk/developers/web/rpc/](http://doc.openerp.com/trunk/developers/web/rpc/)

迟到的问题我也有，所以如果你把它整理出来，请在这里发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-08T07:44:28.087

Here search_read is function that is called from pos.js

```
return $.when(new db.web.Model("sale.order").get_func("search_read")([]).pipe(function(result) 
   {
     var _name = result;
     alert(_name.toSource());

    }),
new db.web.Model("res.users").get_func("read")(this.session.uid, ['name']).pipe(function(result) 
     { 
     })); 
```

# concurrency - Clojure Refs/do-sync 是否等同于 java“同步”块？

> ID：16068448
> 
> 赞同：1
> 
> 时间：2013-04-17T19:22:41.013
> 
> 标签：concurrency, clojure, transactions, stm

我试图说服自己，clojure 确实比 java 更容易进行并发编程。

但我觉得 Clojure Refs/do-sync 与 java“同步”块几乎完全一样。然后我读了这个线程：[Clojure STM (dosync) x Java 同步块](https://stackoverflow.com/questions/3583513/clojure-stm-dosync-x-java-synchronize-block)

--- 我正在重新启动一个新线程，因为如果我在旧线程中发表评论，由于年龄较大，响应可能不高。

Michał Marczyk 在该线程中的第一条评论声称不同之处在于 java 同步块使用锁，而 Clojure 使用事务。我认为这种说法并没有触及问题的本质：在底层，事务仍然是通过锁来实现的。所以“java 使用锁”并不是 Clojure 更好的原因。

我认为真正的好处是 Clojure 事务自动*管理*锁，就像 DB 事务一样。这样，获取锁的顺序和执行事务的顺序由事务管理器决定，程序员不需要关心这些，而在java世界中，程序员必须显式选择使用哪个锁同步块，这会导致可能的死锁。例如，事务管理器可以使用两阶段锁定来避免死锁。

以上有意义吗？

谢谢杨

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T20:19:27.580

Clojure 中的 Ref 是一种不同的并发抽象，它像数据库事务一样工作——它具有原子性、一致性和隔离性属性。它建立在 JVM 锁定机制之上，因此可以在 Java 中自己实现。我们不这样做的原因是类似 Ref 的机制需要预先实现其他重要的机制：

*   [持久数据结构](http://en.wikipedia.org/wiki/Persistent_data_structure)
*   [MVCC STM](http://en.wikipedia.org/wiki/Multiversion_concurrency_control)
*   不可变数据和事务内部没有副作用（因为它们是自动重试的）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-17T21:19:09.650

此处引用答案的作者-让我尝试详细说明：

实际上，在引用的答案中，我首先声称“`dosync`并`synchronized`允许访问完全不同的并发抽象”。此外，我`synchronized`不仅将其描述为“使用锁”，还描述为“一种获取和释放锁的方式”。

换句话说，虽然 STM 确实在后台使用了锁，但它暴露了事务语义，可以这样推断；例如，它通过构造没有死锁（然而，活锁是可能的）。相比之下，`synchronized`程序员明确地声明在大括号标记的点处获取和释放某某对象的监视器是一种明确的方式。这里的重要区别在于语义，而不是实现。

此外，STM 不仅仅是管理锁定顺序；有 MVCC，正如 Grzegorz 所提到的，有自动重启事务，有`ensure`和`commute`（控制一致性与并发权衡，如果你愿意的话），有 STM 和代理之间的合作（代理操作放在队列中，`send`只有在提交时调度如果从事务中调用时间）。

因此，STM 确实是一种管理锁的机制，这样描述它是有用的；但更大的图景是 STM 实现使用它需要的任何内部细节，包括锁，为程序员提供另一种并发抽象，合理地无泄漏，如果要从中提取全部好处，最终必须这样处理它。

# css - 在 wordpress 212 上居中导航边框

> ID：16068454
> 
> 赞同：0
> 
> 时间：2013-04-17T19:22:58.127
> 
> 标签：css, wordpress

我正在尝试将我正在处理的网站的顶部和底部边框居中[http://www.listentotheway.com](http://www.listentotheway.com)。右侧超出我想要的范围。另外，我添加了这段代码以避免堆叠：

> ```
> .menu-main-menu-container {
>   width: 1100px;
>   } 
> ```

任何指针和帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:26:22.010

1100px 对于您的 960 css 来说太宽了，尝试使用这个：

```
 .menu-main-menu-container {
        width: 960px;
        margin: auto;
     } 
```

# python - Python GIL、C 扩展和增加吞吐量 (Python 3.2)

> ID：16068460
> 
> 赞同：0
> 
> 时间：2013-04-17T19:23:12.997
> 
> 标签：python, multithreading, python-3.x, gil

我有一个接受请求的服务器应用程序，需要运行一些 Python，其中一些调用我的基于 C 的扩展 DLL。如果我在整个请求期间完全锁定 GIL，一切正常。但是我想在基于 C 的扩展 DLL 中释放它，当长时间操作发生时，可以处理更多请求。到目前为止，这是我的方法：

```
A. Request arrives on thread I don't control
B.   Call PyGILState_Ensure
C.      Call into Python runtime via PyRun_String  
D.          Python calls my MethodA in my C-based code
E.              Call PyGILState_Release 
F.                  Do long-ish processing
G.              Call PyGILState_Ensure to lock GIL again
H.          Return control to Python for further script processing
I.      Python runtime returns
J.   Call PyGILState_Release 
```

以上所有步骤都是单线程（系统中有很多类似的线程）。

上面的调用序列总是在 Python 深处的步骤 (H) 中某处抛出异常（我似乎无法从堆栈跟踪中找出）。但是，如果我在 (B) 处对 PyGILState_Ensure 进行额外调用，以便 (E) 和 (F) 处的调用最终不会做任何事情，那么一切都会完美运行。

有人可以帮我理解我做错了什么吗？我真的很想在长时间的操作中释放 GIL，以便其他请求可以取得进展。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:42:11.963

首先，您必须匹配 B 和 E 以及 G 和 J 处的`PyGILState_Ensure`/`PyGILState_Release`对，而不是 B 和 J 以及 E 和 G 的更天真的匹配匹配。（如果你这样尝试，步骤 E 会释放一个未初始化的状态，破坏解释器的内部状态信息。）

但是您使用的是单一状态，它没有这个问题。（我实际上不确定这是否合法，但我很确定它在每个版本的 CPython 中都是安全的，而且绝对不可能让事情发生故障。）

* * *

不幸的是，这有一个*不同*的问题。正如[`PyGILState_Release`](http://docs.python.org/3/c-api/init.html#PyGILState_Release)文档所说，它：

> 释放之前获得的任何资源。在此调用之后，Python 的状态将与相应调用之前的状态相同`PyGILState_Ensure()`……</p>

换句话说，您不能在 a`Release`和后续之间携带任何解释器资源`Ensure`（当然，除非它们受到外部保护`Ensure`，但在这种情况下，您实际上并没有释放任何东西）。

因此，一旦您`Release`确保了 的状态，`PyRun_String`该调用的其余部分`PyRun_String`就变得无效。在中间切换到新获得的状态并没有帮助。

* * *

但是我认为您首先是在不必要地滥用`Ensure`/ 。`Release`您不需要向解释器注册线程，注销它，再次注册它，然后再次注销它；您需要做的就是从同一个线程中释放并重新获取 GIL。这就是目的[`Py_BEGIN_ALLOW_THREADS`](http://docs.python.org/3.2/c-api/init.html#Py_BEGIN_ALLOW_THREADS)和`Py_END_ALLOW_THREADS`目的。

正如文档[`PyGILState_Ensure`](http://docs.python.org/3.2/c-api/init.html#PyGILState_Ensure)所说：

> 一般来说，只要线程状态恢复到Release()之前的状态，就可以在`PyGILState_Ensure()`和调用之间使用其他线程相关的API。`PyGILState_Release()`例如，`Py_BEGIN_ALLOW_THREADS`和`Py_END_ALLOW_THREADS`宏的正常使用是可以接受的。

所以：

```
PyGILState_STATE state;

B. state = PyGILState_Ensure();
    ...
E.              Py_BEGIN_ALLOW_THREADS
F.                  Do long-ish processing
G.              Py_END_ALLOW_THREADS
    ...
J.  PyGILState_Release(state); 
```

# opencv - 为什么我会收到此 OpenCV 错误断言失败？

> ID：16068462
> 
> 赞同：3
> 
> 时间：2013-04-17T19:23:17.800
> 
> 标签：opencv

这是代码：

```
Mat _orange = imread("orange.jpg");
Mat_<Vec3f> orange;
_orange.convertTo(orange, orange.type(), 1.0/255.0); 
```

`_orange.convertTo(orange, orange.type(), 1.0/255.0);`零件导致错误。

这是错误消息：

OpenCV 错误：未知函数中的断言失败 (!fixedType() || ((Mat*)obj)->type() == mtype)。

PS：我正在使用 Visual Studio 2012 和 OpenCV 2.4.4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:07:58.153

我的猜测是该`cv::Mat::convertTo()`方法正在调用该`cv::Mat::create()`方法为变量中的数据分配内存`orange`。您应该尝试替换`orange.type()`为`CV_32F`以使其正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T13:19:42.600

尝试像这样向您的 imread 添加参数：

```
cv::imread("orange.jpg", CV_LOAD_IMAGE_ANYDEPTH | CV_LOAD_IMAGE_ANYCOLOR ); 
```

# matlab - 绘制矩阵

> ID：16068463
> 
> 赞同：1
> 
> 时间：2013-04-17T19:23:20.687
> 
> 标签：matlab, matlab-figure

我正在尝试逐行绘制矩阵。我想绘制的第一行然后在它旁边我想绘制下一行信息。这是一个大矩阵，它是 287x6。感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:29:44.043

Do you want something like a surface plot, or just a large set of line plots? Depending on what your data represents, different approaches are of course more or less appropriate.

For line plots, you could do something like

```
figure, hold on
for row=1:size(A,1)
    plot(A(row,:))
end 
```

although I doubt that would be legible. To do a surface plot, the easiest is just to do

```
surf(A) 
```

in which case you'll have row index on one axis, column index on the other, and the matrix element values on the z axis.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:35:42.430

```
>> m = magic(10);
>> s = size(m);
>> for i=1:s(1)
plot(i,m(i,:),'o'); hold on
end 
```

![在此处输入图像描述](https://i.stack.imgur.com/XZPTl.png)

# javascript - 如何使用 jQuery 使所有相对路径成为绝对路径？

> ID：16068465
> 
> 赞同：0
> 
> 时间：2013-04-17T19:23:23.560
> 
> 标签：javascript, jquery, replace, href

使用 jQuery，我试图`<a href="/folder/whatever.file">link</a>`在页面上查找任何实例并将[http://www.domain.com](http://www.domain.com)放在/folder 之前。

最简单、最安全的方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T19:33:21.403

单击时更新锚标记的href。

```
$(document).on("click","a:not([href^=http])",function(){
    this.href = "http://domain.com" + this.href;
}) 
```

或者更好

```
$(document).on("click","a[href^=/specificfolder/]",function(){
    this.href = "http://domain.com" + this.href;
}); 
```

使用 htaccess 或类似的 url 重写解决方案在您的服务器上进行此更改可能会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:25:10.713

```
$('a').each(function(){
  var href = $(this).prop('href')
  $(this).prop('href',"http://domain.com"+href);
}); 
```

# asp.net-mvc-4 - Asp.net MVC4，控制器构造函数

> ID：16068467
> 
> 赞同：0
> 
> 时间：2013-04-17T19:23:26.673
> 
> 标签：asp.net-mvc-4

```
public class CheckoutController : Controller
{
    string userID;

    public CheckoutController()
    {
        userID = User.Identity.Name;
    }
    ...
} 
```

当我运行上面的代码时，我得到了这个错误，

```
**Make sure that the controller has a parameterless public constructor.** 
```

在那个类中，大多数方法都需要那个用户ID，所以我想在构造函数中定义那个值，我该如何解决这个问题？

[编辑]

```
public class CheckoutController : Controller
{
    string userID;

    public CheckoutController()
    {
      //None
    }
} 
```

此代码工作正常，没有错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:23:13.580

与执行管道相关的值（`Request`、`Response`和`User`）**仅**在`Controller`的构造函数方法之后绑定。这就是为什么你不能使用`User.Identity`它，因为它还没有绑定。只有在**第 3 步之后：`IController.Execute()`**才是那些上下文值被初始化的时候。

~~[http://blog.stevensanderson.com/blogfiles/2007/ASPNET-MVC-Pipeline/ASP.NET%20MVC%20Pipeline.jpg](http://blog.stevensanderson.com/blogfiles/2007/ASPNET-MVC-Pipeline/ASP.NET%20MVC%20Pipeline.jpg)~~

**更新海报：** [感谢@SgtPooki，根据@mystere-man 的反馈链接到更新的海报](https://i.imgur.com/96jp1eu.png)。但是我在这里保留了较旧的可嵌入图像，以使其更容易参考。

![ASP.NET MVC 管道](https://i.stack.imgur.com/MafY3.jpg)

`User.Identity.Name`不会对性能产生负面影响，因为它已经`FormsAuthentication`由 ASP.NET 运行时从 cookie 中解密（*假设您正在使用`FormsAuthentication`您的 Web 应用程序*）。

所以不要费心将它缓存到类成员变量中。

```
public class CheckoutController : Controller
{
    public CheckoutController() { /* leave it as is */ }

    public ActionResult Index()
    {
        // just use it like this
        string userName = User.Identity.Name;

        return View();
    }
} 
```

# java - 无头/CLI LibGDX

> ID：16068468
> 
> 赞同：8
> 
> 时间：2013-04-17T19:23:28.577
> 
> 标签：java, libgdx

我正在为一个小型 LibGDX 驱动的游戏编写服务器端代码，并且偶然发现了一个问题。每次我尝试使用任何`Gdx.files.*`方法时，都会遇到一个`NullPointerException`.

显然这是因为我没有实现 ApplicationListener，所以 LibGDX 还没有被初始化。

有没有办法以无头/CLI 方式初始化 LibGDX？我需要能够在服务器端加载 TiledMap 对象。

```
MapLoader(Request request)
{
    TiledMap tmp = new TmxMapLoader().load("maps/" + request.name + ".tmx");
} 
```

> com.esotericsoftware.kryonet.Server$1.received(Server.java:60) 的 com.tester.Example.server.ExampleServer$2.received(MapLoader.java:83) 的线程“服务器”中的异常 java.lang.NullPointerException com.esotericsoftware.kryonet.Connection.notifyReceived(Connection.java:246) 在 com.esotericsoftware.kryonet.Server.update(Server.java:202) 在 com.esotericsoftware.kryonet.Server.run(Server.java:350)在 java.lang.Thread.run(Thread.java:722)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T04:00:27.723

~~我不建议将 libGDX 用于无头环境，它根本不是为那样使用而设计的，并且随着 libGDX 团队更改框架，您将来可能会遇到问题。~~然而，正如罗德指出的那样，这样做是完全有可能的，下面是你将如何去做的一个片段。要初始化 Gdx.files 全局变量，您需要在后端包中创建一个类并自己设置全局变量：

```
package com.badlogic.gdx.backends.lwjgl;

import com.badlogic.gdx.Gdx;

public class Headless {
    public static void loadHeadless() {
        LwjglNativesLoader.load();
        Gdx.files = new LwjglFiles();
    }
} 
```

其余的应该相当简单。只需调用 Headless.loadHeadless(); 在开始时，您应该能够使用您需要的部分框架。

正如我之前所说，我不建议这样做，但我还没有找到将 libgdx 与客户端/服务器架构一起使用的任何好的解决方案。

**编辑**：

不久前（在我最初写了这个答案之后）libgdx 添​​加了一个[无头后端](https://github.com/libgdx/libgdx/tree/master/backends/gdx-backend-headless)，它是为这种目的而设计的。这是在无头环境中使用 libgdx 的正确方法，并且非常适合使用 libgdx 创建服务器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-06-25T03:46:51.893

截至 2013 年 12 月 23 日（[拉取请求 #1018](https://github.com/libgdx/libgdx/commit/dd977b08a9bc5eba21031cb450581146dea1a01f)），libGDX 有一个[无头后端](https://github.com/libgdx/libgdx/tree/master/backends/gdx-backend-headless)，您可以将其用于此目的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-22T11:47:56.123

看看 LWJGL 后端，特别是[LwjglApplication.java](https://github.com/libgdx/libgdx/blob/master/backends/gdx-backend-lwjgl/src/com/badlogic/gdx/backends/lwjgl/LwjglApplication.java)。*LwjglApplication*的构造函数初始化所有*Gdx。** 全局变量，例如*Gdx.files*。

如果您要从您自己的代码调用在构造函数中运行的步骤，除了对*initialize()*的调用，那么这应该会得到您想要的。

# matplotlib - 关闭绘图窗口后，进程继续运行

> ID：16068469
> 
> 赞同：0
> 
> 时间：2013-04-17T19:23:30.223
> 
> 标签：matplotlib, wxpython

我是 matplotlib 的新手，遇到了一些困难。从用户的角度来看，一切正常。我有一个带按钮的窗口。按下按钮会弹出一个显示绘图的新窗口。玩完之后，我点击 X 关闭这个窗口。并再次单击 X 以使用该按钮关闭窗口。但我没有退回到免费提示。主窗口被锁定并仍在后台运行。

这是代码的重要部分：

```
import matplotlib
import matplotlib.pyplot as Plt
from matplotlib.figure import Figure

class MainPanel(wx.Panel):

    def __init__(self, parent): #=None

        wx.Panel.__init__(self, parent)

                       .... wxpython stuff goes here....

              self.btn1.Bind(wx.EVT_BUTTON, self.cplot)

                       ....

    def cplot(self, event):
        self.new = NewWindow(self)
        self.new.cidadeplot(self)
        self.new.Show()
        return

class NewWindow(wx.Frame):

    def __init__(self,event):
        wx.Frame.__init__(self, None, -1, 'Plot', size=(556, 618))
        wx.Frame.CenterOnScreen(self)
        self.Bind(wx.EVT_CLOSE, self.OnClose)

    def OnClose(self,event):
        self.Destroy()

    def cidplot(self,event):

        self.fig = Figure()

        self.axes = self.fig.add_subplot(111)
        self.canvas = FigCanvas(self, -1, self.fig)

        self.axes.set_ylabel("Parts")
        self.axes.set_ylim(0,100)
        self.axes.grid(True)

        ....more axes settings...

       bars = self.axes.bar(left=self.ii, height=self.tt, width=0.2, align='center', alpha=0.8)

        ....

        self.canvas.draw()

        Plt.savefig("Parts.pdf", dpi=300)

class MainFrame(wx.Frame):

    def __init__(self):

        wx.Frame.__init__(self, None, title = "System Test")

        self.SetSize((556, 618))

        panel = MainPanel(self)

        self.Show()

if __name__ == "__main__":

    app = wx.App(False)
    frame = MainFrame()
    app.MainLoop() 
```

我认为问题出在 self.fig = Figure() （如果我使用 Plt.figure() 也会发生同样的情况）

当我创建一个新窗口或在我的 matplotlib 部分时，我做错了什么？有什么更好的方法吗？

提前致谢。欢迎任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:41:41.583

不要导入`pyplot`，它有自己的包装来处理管理图形 gui 框架（除了状态机界面）是`pyplot`. 要做到这一点，它会启动它自己的主循环，这可能是让你搞砸的原因。

请务必查看[此处的示例](http://matplotlib.org/examples/user_interfaces/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:28:07.887

使用此功能 OnClose：

```
def onClose(self, event):
    """"""
    self.Close(True) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T14:57:45.460

特卡斯韦尔是对的。

我删除了对 pyplot 的所有引用。savefig 正在锁定应用程序。全部更改为 self.axes.XXX 和 salf.fig.savefig(xxx) 并工作。

谢谢。

# java - 使用 Java 正则表达式搜索包含 + 或 # 的字符串

> ID：16068470
> 
> 赞同：4
> 
> 时间：2013-04-17T19:23:30.553
> 
> 标签：java, regex

我正在使用 Java Pattern 类进行一些字符串搜索。我正在尝试使用 java Pattern 类匹配包含“c++”或“c#”的字符串（txt）。

```
String txt="c++ / c# developer";
Pattern p = Pattern.compile(".*\\b(c\\+\\+|c#)\\b.*" , Pattern.CASE_INSENSITIVE);
Matcher m = p.matcher(txt);
while (m.find()) {
...
   break;
} 
```

m.find 总是错误的我做错了什么？谢谢奥弗

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T19:30:42.173

`\\b` is a word boundary. Which means it matches between a word and a non-word character. `+` and `#` are both non-word characters, so you require `c++` or `c#` to be followed by a letter, digit or underscore. Try removing the `\\b` or replacing it with a `\\B` (which would require that there is another non-word character after the `+` or `#`).

Note that, when you are using `find`, you don't need the `.*` either. `find` will happily return partial matches. Your pattern would give you the last occurrence of either `c++` or `c#` in the first capturing group. If that is not what you want, remove the parentheses and wildcards.

[Working demo.](http://fiddle.re/tn5j6)

**EDIT:** If you are adding other alternatives that **do** end in word characters (like `java`). The cleanest solution would be not to use `\\b` or `\\B` at all, but create your own boundary condition using a negative lookahead. This way you are simply saying "match if there is no word character next":

```
\\b(c\\+\\+|c#|java)(?!\\w) 
```

[Working demo.](http://fiddle.re/xkfg6)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:28:38.793

您可以尝试使用`^.*c(\+{2}|\#).*$`. 它说 find a`c`后跟 2`+`或 a `#`。[你可以在这里](http://rubular.com/r/AHY2Wi7fY2)看到一个例子。

# jquery - JQuery Drop Down on Hover .slideDown 和 .slideUp 在 IE7 + 8 中中断

> ID：16068474
> 
> 赞同：0
> 
> 时间：2013-04-17T19:23:42.927
> 
> 标签：jquery, css, drop-down-menu, internet-explorer-7, slidedown

我的下拉菜单的 .hover 功能在 Chrome、FF、Safari 和 IE9 + 10 中运行良好。但是当我在 IE7 + 8 中测试它们时，它们会中断。在网上搜索答案后，我尝试添加 zoom: 1; 到我的 CSS 中的下拉菜单，因为 .slideUp/Down 无法识别 position: relative; IE7 中的元素。仍然没有找到解决这个问题...有人可以帮忙吗？

查询：

```
 $(document).ready(function () {
        $('div.dropNavOne').hover(
            function () {
                $('ul.menu_body1').stop(true, true).slideDown(600);
            },
            function () {
                $('ul.menu_body1').stop(true, true).slideUp(600); 
        });
    }); 
```

HTML：

```
 <div class="dropNavOne" class="gradient">
        <ul>
            <li><a href="#">I am a...</a>
                <ul class="menu_body1">
                    <li><a href="#">Option 1</a></li>
                    <li><a href="#">Option 2</a></li>
                    <li><a href="#">Option 3</a></li>
                </ul>
            </li>
        </ul> 
```

相关CSS：

```
 .dropNavOne, .dropNavTwo {
float: left;
margin-top:10px;
padding-right: 5px;
height: 30px;
width: 200px;
    }

    .dropNavOne ul ul, .dropNavTwo ul ul {
display: none;
    }

    .dropNavOne ul, .dropNavTwo ul {
position: relative;
zoom: 1;
background: #bbbbbb;
padding: 0 5px; 
list-style: none;
display: inline-table;
margin: auto;
width: 190px;
opacity: 0.9;
box-shadow: 0px 0px 9px rgba(0,0,0,0.15);
border-radius: 3px;
    }
.dropNavOne ul:after, .dropNavTwo ul:after {
    content: ""; clear: both; display: block;
}

    .dropNavOne ul li, .dropNavTwo ul li {
position: relative;
zoom: 1;
width: 190px;
border-top-left-radius: 3px;
border-top-right-radius: 3px;
    }
.dropNavOne ul li:hover, .dropNavTwo ul li:hover {
    position: relative;
    zoom: 1;
    background: #5e5e5e;
}

    .dropNavOne ul li:hover a, .dropNavTwo ul li:hover a {
        color: #c7c7c7;
    }

.dropNavOne ul li a, .dropNavTwo ul li a {
    display: block; padding: 5px;
    color: black; text-decoration: none;
}

    .dropNavOne ul ul, .dropNavTwo ul ul {
zoom: 1;
background: #5e5e5e; padding: 0;
position: absolute; top: 100%;
border-top-right-radius: 3px;
border-bottom-left-radius: 3px;
border-bottom-right-radius: 3px;
width: 275px;
opacity: 0.9;
filter: alpha(opacity=90);
    }
.dropNavOne ul ul li, .dropNavTwo ul ul li {
    border-top: 1px solid #6b6b6b;
    border-bottom: 1px solid #494949;
    width: 275px;
}
    .dropNavOne ul ul li a, .dropNavTwo ul ul li a {
        padding: 5px 10px;
        color: #c7c7c7;
    }   
        .dropNavOne ul ul li a:hover, .dropNavTwo ul ul li a:hover {
            background: #333333;
        } 
```

在 IE7 中，下拉菜单根本不显示，而在 IE8 中，它们确实有问题……在正确的位置，但仅部分显示并且功能（向上/向下滑动）不正确。

# apache-flex - 在 Air 应用程序的嵌入式 flex Web 应用程序上将焦点设置为 textInput

> ID：16068480
> 
> 赞同：0
> 
> 时间：2013-04-17T19:24:00.977
> 
> 标签：apache-flex, web, air, focus

好吧朋友，场景很复杂：

我有一个空中应用程序，在其中我有一个运行 flex Web 应用程序的 HTML 组件，我需要在两分钟内将焦点设置在文本输入上。HTML 组件位于 Panel 内，而这位于 stackview 内

1.- 当我选择 HTML 组件所在的 stackview 索引时，Panel 调度完成事件。好吧，我通过修改 flex web 应用程序的 html 包装器添加一些代码来解决这个问题

```
<script languaje="javascript" type="text/javascript">
    function setInitialFocus() {
       document.getElementById('${application}').tabIndex = 0;
       document.getElementById('${application}').focus();
    }
</script>

<body scroll="no" onload="setInitialFocus()"> 
```

2.-接下来是错误的事情：当我从stackview中选择另一个索引时，HTML所在的面板会调度隐藏事件。如果我回到 HTML 所在的索引，那么包含 HTML 的面板会调度 show 事件。在 show 事件处理程序中，我使用 localConnection 向 Web 应用程序发送命令，通过调用加载页面时正常工作的相同 javascript 函数 (onload="setInitialFocus()") 将焦点恢复到 textInput 组件。

内部空气应用程序：受保护的 creationComplete_Handler(event:Event) : void { localConnection = new LocalConnection(); localConnection.addEventListener(StatusEvent.STATUS, localConnection_onStatus); localConnection.connect("some.domain.com"); }

```
 protected function show(event:FlexEvent) : void {
     localConnection.send("_someConnection","executeJavaScript");
 } 
```

内部网络应用程序： public creationComplete_handler(event:Event) : void { localConnection.allowInsecureDomain("app#chevronLocstattDesktop"); localConnection.client = 这个；localConnection.connect("_SomeConnection"); }

```
 public function executeJavaScript() : void {
   ExternalInterface.call("setInitialFocus");
   textInput.setFocus();
 } 
```

javascript 函数执行得很好（因为我在其中添加了一些警报并显示了它），但是没有给 web 应用程序焦点，因此没有给 textInput 焦点，这就是所有目标。

请帮我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-09T15:02:07.497

**1\. 在 index.template.html 中创建一个 Javascript 函数；**

```
<script language="JavaScript" type="text/javascript" >
<!--
function setFocus()
{
    window.document.YourSite.focus();
}

// -->
</script> 
```

***PS：将“YourSite”替换为您的 SWF 电影的名称。***

**2\. 插入你的创作完成方法；**

```
if (ExternalInterface.available) {
        ExternalInterface.call('setFocus');
    } else {
        Alert.show("Browser not available");
    }

    focusManager.setFocus(yourTextInput); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:47:03.210

现在我找到了解决方案：

在 web 应用程序的 html 包装器上添加另一个功能

```
<script languaje="javascript" type="text/javascript">
    function unsetInitialFocus() {
       document.getElementById('${application}').tabIndex = 0;
       document.getElementById('${application}').blur();
    }
</script> 
```

空中应用：

在具有 HTML 组件的组件内部，在隐藏事件处理程序中，我调用了名为 unsetInitialFocus 的 javascript 函数。这将关闭 html 包装器的标志，强制它失去焦点，并且下次调用函数 setInitialFocus 时，将配置焦点。

```
protected function hide(event:FlexEvent) : void {
   HTMLViewer.htmlLoader.window.unsetInitialFocus();
} 
```

看起来很复杂，但如果有人需要更多帮助，请询问。

# java - 使用 servlet 上传文件 GWT

> ID：16068482
> 
> 赞同：1
> 
> 时间：2013-04-17T19:24:02.320
> 
> 标签：java, gwt, servlets, file-upload

我正在使用 GWT 开发应用程序，并且正在尝试将文件上传到服务器（或目录）。我正在使用表单通过 FileUpload 小部件提交所选文件。我用来上传文件的 servlet 有问题：

```
package com.asso.server;

import java.io.File;
import java.io.IOException;
import java.util.List;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.commons.fileupload.FileItem;
import org.apache.commons.fileupload.FileItemFactory;
import org.apache.commons.fileupload.disk.DiskFileItemFactory;
import org.apache.commons.fileupload.servlet.ServletFileUpload;
import org.apache.commons.io.FilenameUtils;

/**
 * servlet to handle file upload requests
 * 
 * @author hturksoy
 * 
 */
public class FileUploadServlet extends HttpServlet {

        private static final String UPLOAD_DIRECTORY = "c:\\uploaded\\";
        private static final String DEFAULT_TEMP_DIR = ".";

        @Override
        protected void doGet(HttpServletRequest req, HttpServletResponse resp)
                        throws ServletException, IOException {
                // TODO Auto-generated method stub
                super.doGet(req, resp);
        }

        @Override
        protected void doPost(HttpServletRequest req, HttpServletResponse resp)
                        throws ServletException, IOException {

                // process only multipart requests
                if (ServletFileUpload.isMultipartContent(req)) {

                        File tempDir = getTempDir();
                        if (!tempDir.exists()) {
                                tempDir.mkdirs();
                        }

                        // Create a factory for disk-based file items
                        FileItemFactory factory = new DiskFileItemFactory();

                        // Create a new file upload handler
                        ServletFileUpload upload = new ServletFileUpload(factory);

                        // Parse the request
                        try {
                                List<FileItem> items = upload.parseRequest(req);
                                for (FileItem fileItem : items) {
                                        // process only file upload
                                        if (fileItem.isFormField()) continue;

                                        String fileName = fileItem.getName();
                                        // get only the file name not whole path
                                        if (fileName != null) {
                                        fileName = FilenameUtils. getName(fileName);
                                    }

                                        File uploadedFile = new File(UPLOAD_DIRECTORY, fileName);
                                        if (uploadedFile.createNewFile()) {
                                                fileItem.write(uploadedFile);
                                                resp.setStatus(HttpServletResponse.SC_CREATED);
                                                resp.getWriter().print("The file was created successfully.");
                                                resp.flushBuffer();
                                        } else
                                                throw new IOException("The file already exists in repository.");
                                }
                        } catch (Exception e) {
                                resp.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR,
                                                "An error occurred while creating the file : " + e.getMessage());
                        }

                } else {
                        resp.sendError(HttpServletResponse.SC_UNSUPPORTED_MEDIA_TYPE,
                                                        "Request contents type is not supported by the servlet.");
                }
        }

        private File getTempDir() {
                return new File(DEFAULT_TEMP_DIR);
        }

} 
```

我收到此错误：

```
java.lang.NoClassDefFoundError: org/apache/commons/fileupload/FileItemFactory
    at java.lang.Class.getDeclaredConstructors0(Native Method)
    at java.lang.Class.privateGetDeclaredConstructors(Unknown Source)
    at java.lang.Class.getConstructor0(Unknown Source)
    at java.lang.Class.newInstance0(Unknown Source)
    at java.lang.Class.newInstance(Unknown Source)
    at org.mortbay.jetty.servlet.Holder.newInstance(Holder.java:153)
    at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:428)
    at org.mortbay.jetty.servlet.ServletHolder.getServlet(ServletHolder.java:339)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at com.google.appengine.api.socket.dev.DevSocketFilter.doFilter(DevSocketFilter.java:74)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.ResponseRewriterFilter.doFilter(ResponseRewriterFilter.java:123)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:34)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:61)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:125)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.DevAppServerServersFilter.doFilter(DevAppServerServersFilter.java:106)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:94)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:421)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:938)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
Caused by: java.lang.ClassNotFoundException: org.apache.commons.fileupload.FileItemFactory
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at com.google.appengine.tools.development.IsolatedAppClassLoader.loadClass(IsolatedAppClassLoader.java:214)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    ... 41 more 
```

我看到了这个主题，它说我应该添加`commons-fileupload-1.3.jar`and`commons-io-2.4.jar`并且我已经完成了。 [如何解决这个 java.lang.NoClassDefFoundError: org/apache/commons/io/output/DeferredFileOutputStream？](https://stackoverflow.com/questions/11154252/how-to-solve-this-java-lang-noclassdeffounderror-org-apache-commons-io-output-d) 有什么解决办法吗？编辑：将 JAR 直接添加到我的 WEB-INF/lib 后，出现此错误

```
java.lang.NoClassDefFoundError: `java.io.FileOutputStream is a restricted class. Please see the Google  App Engine developer's guide for more details.
    at com.google.appengine.tools.development.agent.runtime.Runtime.reject(Runtime.java:51)
    at org.apache.commons.io.output.DeferredFileOutputStream.thresholdReached(DeferredFileOutputStream.java:178)
    at org.apache.commons.io.output.ThresholdingOutputStream.checkThreshold(ThresholdingOutputStream.java:224)
    at org.apache.commons.io.output.ThresholdingOutputStream.write(ThresholdingOutputStream.java:128)
    at org.apache.commons.fileupload.util.Streams.copy(Streams.java:108)
    at org.apache.commons.fileupload.util.Streams.copy(Streams.java:70)
    at org.apache.commons.fileupload.FileUploadBase.parseRequest(FileUploadBase.java:347)
    at org.apache.commons.fileupload.servlet.ServletFileUpload.parseRequest(ServletFileUpload.java:115)
    at com.asso.server.FileUploadServlet.doPost(FileUploadServlet.java:56)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at com.google.appengine.api.socket.dev.DevSocketFilter.doFilter(DevSocketFilter.java:74)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.ResponseRewriterFilter.doFilter(ResponseRewriterFilter.java:123)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:34)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:61)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:125)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.DevAppServerServersFilter.doFilter(DevAppServerServersFilter.java:106)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:94)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:421)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:938)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T03:36:37.567

确保您没有错过将文件 commons-fileupload-1.3.jar 和 commons-io-2.4.jar 复制到您的 WEB-INF/lib 中。您还应该检查您的启动类路径是否有 devmode。

**示例**- 我在我的库中添加了一个示例 jar，并且可以通过我的启动配置看到相同的内容。

**更新**- 如果您使用的是 GAE，请通读

1.  [GWT - 图像上传和 GAE](https://stackoverflow.com/questions/10605046/gwt-image-upload-and-gae)
2.  [如何使用谷歌应用引擎（java）上传和存储图像](https://stackoverflow.com/questions/1513603/how-to-upload-and-store-an-image-with-google-app-engine-java)

![在此处输入图像描述](https://i.stack.imgur.com/AnlZd.png)

![在此处输入图像描述](https://i.stack.imgur.com/YdkOw.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-10T15:36:35.423

Google App Engine 应用程序[无法写入文件系统](https://developers.google.com/appengine/docs/go/#The_Sandbox)。

您使用的 DiskFileItemFactory 对象尝试写入文件系统，因此您会收到以下异常：

```
java.lang.NoClassDefFoundError: `java.io.FileOutputStream is a restricted class. Please see the Google  App Engine developer's guide for more details. 
```

这是[DiskFileItemFactory 文档](http://commons.apache.org/proper/commons-fileupload/apidocs/org/apache/commons/fileupload/disk/DiskFileItemFactory.html)的解释：

> 此实现创建 FileItem 实例，这些实例将其内容保存在内存中，用于较小的项目，或保存在磁盘上的临时文件中，用于较大的项目。将内容存储在磁盘上的大小阈值是可配置的，将在其中创建临时文件的目录也是如此。如果没有另外配置，默认配置值如下： 大小阈值为 10KB。

解决方案：您应该增加文件大小阈值。覆盖默认值。将其设置为您希望上传到 servlet 的最大文件大小。

```
DiskFileItemFactory factory= new DiskFileItemFactory(5000000,null); 
```

或者

```
DiskFileItemFactory factory= new DiskFileItemFactory();
factory.setSizeThreshold(5000000); 
```

# php - 无法将 PHP 字符串传递给 jquery

> ID：16068487
> 
> 赞同：0
> 
> 时间：2013-04-17T19:24:14.037
> 
> 标签：php, javascript, jquery, ajax, json

我的系统上有一个脚本，提供活动接口列表 -

```
 $ interfaces
 eth0
 lo
 wlan0 
```

现在这是我的 PHP 代码 -

```
 <?php
 $output=shell_exec('./interfaces');
 $string = trim(preg_replace('/\s+/', ' ', $output));
 $string = str_replace("\0","",$string);
 $data = preg_split('/\s+/',$string);  // There was a typo here, changed $output to  
                                        //  $string 
 echo json_encode($data);
?> 
```

我的jQuery去了-

```
 $.getJSON('nw/sample1.php', function(data) {

    $(data).each(function(i,item) {

            alert(item);

    });

    }); 
```

我希望应该有`3`一个可见的警报框，每个突出显示一个活动界面。

例如，第一个警报框应该说`"eth0"`，第二个说`"lo"`等等，但它没有按预期工作。

我对这一切都很陌生，所以我很清楚我在哪里弄错了？

谢谢

**编辑 ：**

**sample1.php 在浏览器中的输出**

```
 ["eth0","lo","wlan0"] 
```

**$.each(data, ...) 和 $data.each ... ** 两者的行为方式相同。

**console.log(data) 输出** ![在此处输入图像描述](https://i.stack.imgur.com/Akdnz.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T10:10:18.177

在通知客户`header('Content-Type: application/json');`之前添加-`json_encode($data)``parse it as json instead of text/HTML`

所以，

```
<?php
 $output=shell_exec('./interfaces');
 $string = trim(preg_replace('/\s+/', ' ', $output));
 $string = str_replace("\0","",$string);
 $data = preg_split('/\s+/',$string);  // There was a typo here, changed $output to  
                                        //  $string 

 header('Content-Type: application/json'); // ## ADDED this line ##
 echo json_encode($data);
?> 
```

现在，您`javascript/jquery`应该能够做 - 您期望它做的事情！

请尝试恢复！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T10:42:25.310

我认为你的问题只是 nw/sample1.php

我在 sample1.php 中使用了一个“普通”字符串，而 $getJSON 就像一个魅力，所以我将重点介绍如何检索存储在“接口”文件中的数据。只需将 sample1.php 中的代码替换为以下代码即可检查 jQuery JSON 是否正常工作：

```
<?php
$string = 'eth0 lo wlan0';
$string = str_replace("\0","",$string);
$data = preg_split('/\s+/',$string);
echo json_encode($data); 
```

# php - 单击按钮后如何清除整个php网页？

> ID：16068492
> 
> 赞同：-3
> 
> 时间：2013-04-17T19:24:40.353
> 
> 标签：php

我在网络浏览器中输出一个测验问题。我想选择答案并单击“下一步”按钮以移至应显示在同一页面中的下一个问题。我使用 javascript 在同一页面上打印所有问题。但是，当我单击下一步时，下一个问题会打印在上一个问题的下方。

有没有一种方法可以清除页面，以便第二个问题是页面上唯一显示的问题？

我正在使用标签指向下一个问题。例如，

******在页面测试.php** *** ********

 **```
<form id="q1_id" action="testcalc.php" method="post">
<fieldset>
<legend>
<?php
echo $question;
?>
</legend>
<input type="radio" name="definition1" value="<?php echo $answer1; ?>"><?php echo $answer1; ?><br>
<input type="radio" name="definition1" value="<?php echo $answer2; ?>"><?php echo $answer2; ?><br>
<input type="radio" name="definition1" value="<?php echo $answer3; ?>"><?php echo $answer3; ?><br>
</fieldset>
<button id="b1_id">Next</button>
</form> 
```

执行此页面后，我希望能够仅打印 URL“test.php”中“testcalc.php”中存在的下一个问题。我可以使用 javascript 来做到这一点，但是这两个问题都显示在 url“test.php”下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:30:51.927

Well, I suppose you can change your action value from `action="testcalc.php"` to something like `action="testcalc.php?part=2"` now, the first time you submit or click the button, the page will be the same, but still will add a query string of `part=2` now, this will help you to manipulate the page more, as you can use the `$_GET` method to check if you should execute the second part of the question like:

```
if(!$_GET['part'] && empty($_GET['part'])) {

// show **1st part** of the questions

}else if(isset($_GET['part']) && $_GET['part']==2){

// show **2nd part** of the questions
} 
```

Now - First time you open the page, or if you did not click any button, the 1st script will run, if you press the button however, the second part will run

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-09T04:10:21.317

完成这种事情的通常方法是使用 post/get 发送值到带有下一个问题的页面并使用它们创建隐藏的输入标签，并且下次将这些隐藏的输入标签也传递到下一页，或者你可以按照西蒙说的去做。

如果您希望人们能够在问题之间迁移，这将更有效率。

您添加将每个问题放在不同的页面上并将此代码添加到每个问题：

```
foreach($_POST as $key => $value) {
// set some validation for the type for keys you want
echo "<input type=\"hidden\" id=\"{$key}\" value=\"{$value}\" />\n";
} 
```

唯一要做的另一件事是使用一些 javascript 设置表单的操作（以决定下一页）。这样，用户可以迁移到所有问题，而不仅仅是下一个问题。**

# java - 如何在不触发验证的情况下触发 ap:fileDownload

> ID：16068493
> 
> 赞同：0
> 
> 时间：2013-04-17T19:24:40.927
> 
> 标签：java, jsf, primefaces

我正在尝试`p:fileDownload`从数据表中的命令按钮触发使用 PrimeFaces。

它正在使用`Ajax="false"`，但我需要确保绕过页面验证。我已经尝试`immediate="true"`在命令按钮上进行设置，但它不起作用。

任何建议表示赞赏。

应该`immediate="true"`在这种情况下工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:53:58.787

问题实际上是因为我的数据表没有将选定的值写入 bean，因为 Immediate 设置为 true。所以我试图下载一个空值......我现在正在使用 Ajax 行选择侦听器将所选对象写入 bean，所以它现在正在工作......

谢谢

一世

# java - 将值从 .txt 传递到 HTML 文本框（使用 Batch、Java 或 PHP）

> ID：16068494
> 
> 赞同：0
> 
> 时间：2013-04-17T19:24:42.713
> 
> 标签：java, javascript, parsing, batch-file

复杂的问题，所以让我试着解释一下......

我有一个文本文件（名为 filelist.txt），其中包含如下值列表：

```
12_23_4_ABC_|
12_35_6_XYZ_|
12_36_5_ABC_|
12_37_9_UVW_|
12_38_8_XYZ_|
12_39_1_ABC_|

(pipe ( | ) is the delimiter) 
```

我有一个 HTML 页面（名为 ABCparser.html），它有一个文本框，我可以在其中键入值然后点击“提交”，但是这个特定页面只接受前缀的值`_ABC_`（还有另一个 HTML 页面接受`_XYZ_`and `_UVW_`），而不是我硬编码`value = ""`每个页面上每次部分中的前缀值，有没有办法从文本文件（.txt）中捕获它并将其传递给 HTML 页面？我已经在页面上有一个 JavaScript 函数来自动点击“提交”按钮。如果可能的话，我宁愿在批处理中执行此操作，因为我的主程序是用它编写的，或者如果有人可以帮助我用 Java 甚至 PHP 提供它，我可以从批处理中取消。

文本框代码：

```
<input type="text" name="trackingId" size="100" value = ""> 
```

不过有一个问题。我需要将清理后的数据传递给 HTML 文本框....

所以目标：

*   解析文本文件并查找具有`_ABC_`
*   如果 line 为 false，则转到文本文件中的下一行（参见第 5 个项目符号），如果 line 为 true，则将值取到第三个下划线并将其捕获以传递给 HTML 文本框，但是将前面的下划线转换为破折号和单独的值用逗号。
*   因此，文本框代码应与上述示例类似：
    *   `<input type="text" name="trackingId" size="100" value = "12-23-4, 12-36-5, 12-39-1">`
*   JavaScript 函数自动提交，Web 服务调用成功。
*   如果行已`_XYZ_`执行相同的步骤但将其发送到“XYZparser.html”，如果行已将`_UVW_`其发送到“UVWparser.html”
*   用户可以随时更改 filelist.txt 中的数字，但后缀将保持不变（即：在以后的运行中，用户可能不想提交 12_23_4_ABC_，他们可能希望看到 13_87_1_ABC_）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:17:07.437

```
@ECHO OFF
SETLOCAL enabledelayedexpansion
FOR /f "delims==" %%i IN ('set val 2^>nul') DO (SET %%i=)
FOR /f "tokens=1-4delims=_" %%a IN (filelist.txt) DO (
SET val_%%d=!val_%%d!, %%a-%%b-%%c
)
FOR /f "tokens=2,3delims=_=" %%i IN ('set val 2^>nul') DO (
SET list=%%j
SET list=!list:~2!
>%%iparser.html ECHO ^<input type="text" name="trackingId" size="100" value = "!list!"^>
ECHO generated %%i parser
) 
```

五分钟的任务。首先清除所有名为 VAL* 的环境变量，获取列表并为变量中的 VALUE 数据构建字符串`val_prefix`

处理完文本文件后，在环境中查找 VAR*，抓取下划线后面的部分以用于输出文件名，删除数据项的前两个字符，即逗号空格并生成行文件。报告生成的 HTML 文件 - 可用于触发任何需要触发的内容。

记录的时间比编程的时间长……

* * *

修订规范的修正

```
@ECHO OFF
SETLOCAL enabledelayedexpansion
FOR /f "delims==" %%i IN ('set val 2^>nul') DO (SET %%i=)
FOR /f "tokens=1-5delims=_|" %%a IN (filelist.txt) DO (
 IF "%%e"=="" (SET val_%%d=!val_%%d!, %%a-%%b-%%c) ELSE (
               SET val_%%d_%%e=!val_%%d_%%e!, %%a-%%b-%%c)
)
FOR /f "tokens=1,2delims==" %%i IN ('set val 2^>nul') DO (
SET html=%%i
SET html=!html:*_=!parser.html
SET list=%%j
SET list=!list:~2!
>!html! ECHO ^<input type="text" name="trackingId" size="100" value = "!list!"^>
ECHO generated !html!
) 
```

几乎与OP的版本相同。的设置略有不同`%%e`，但这是风格问题。

虽然生成 HTML 文件的方法更简单 - 有点偷偷摸摸。只是将`FOR`名称与值分开。处理名称，它将采用格式`val_something`，因此将其应用于变量（字符串操作不能直接在元变量上执行）然后`!html:*_=!`将获取`var_something`并更改所有字符，包括第一个`_`字符（之间的字符或字符串）`*`和`=`) 到 - 之后的那些字符，`=`在这种情况下什么都不是，所以前导`..._`被删除（好吧，好吧，因为我们知道所有`var..`变量都会开始`var_`我们可以很容易地使用`!html:~4!`- 一般与特定技术的问题）

所以 - 是否在`parser.html`此处添加是一个选择问题。

...只是有关各方的另一种方法...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T00:59:25.257

彼得的回答真的很有帮助！我确实根据一些额外的用例做了一些修改。以下是我的回答......

```
@ECHO ON
SETLOCAL enabledelayedexpansion
FOR /f "delims==" %%i IN ('set val 2^>nul') DO (SET %%i=)
FOR /f "tokens=1-5delims=_" %%a IN (filelist.txt) DO (
    IF "%%e"=="|" (
        SET val_%%d=!val_%%d!, %%a-%%b-%%c
    )   ELSE (
        SET val_%%d_%%e=!val_%%d_%%e!, %%a-%%b-%%c
    )
)

FOR /f "tokens=2-4delims=_=" %%i IN ('set val 2^>nul') DO (
    IF "%%k"=="" (
        SET list=%%j
        SET list=!list:~2!
        >%%i_parser.html ECHO ^<input type="text" name="trackingId" size="100" value = "!list!"^>
        ECHO generated %%i parser
    )   ELSE (   
        SET list=%%k
        SET list=!list:~2!
        >%%i_%%j_parser.html ECHO ^<input type="text" name="trackingId" size="100" value = "!list!"^>
        ECHO generated %%i_%%j parser
    )
) 
```

# linux - Linux 虚拟化中的 macvtap 接口

> ID：16068496
> 
> 赞同：3
> 
> 时间：2013-04-17T19:24:47.870
> 
> 标签：linux, linux-kernel, linux-device-driver, qemu, kvm

显然，使用 macvtap 作为来宾 VM 的网络选项比具有 Linux 桥的传统 tun/tap 设备提供更好的性能。

据我了解，macvtap 使用主机 Linux 内核的 macvlan 驱动程序，它基本上通过具有不同的 mac 地址在物理网卡上创建一种逻辑以太网接口。

但是使用 macvtap 对吞吐量有什么帮助呢？是因为来自来宾 VM 的传输/接收的后端处理是在主机内核中处理的（而不是 Qemu 进程使用传统的 tun/tap 进行处理）？

# php - 谷歌分析数组解码 foreach

> ID：16068500
> 
> 赞同：0
> 
> 时间：2013-04-17T19:25:00.993
> 
> 标签：php, arrays, foreach, google-analytics-api

嗨，这是我第一次涉足 Google Analytics 及其 API 的美妙世界，我遇到了一个障碍，想​​知道是否有人可以提供帮助。

我正在检索以下数组：

```
[
    [
     "iPhone",
     "United Kingdom",
     "51.5073",
     "-0.1277",
     "1",
     "18"
    ],
    [
     "iPhone",
     "Australia",
     "-33.8675",
     "151.2070",
     "1",
     "17"
    ],
    [
     "iPhone",
     "United Kingdom",
     "51.5171",
     "-0.1461",
     "5",
     "16"
    ]
] 
```

这是使用标准（基于演示的 htmlOutput 函数）输出到我的页面的我正在使用中的此调用获取数据

> coreReportingApiReference.php

PHP：

```
 private function getRows($results) {
    $json;
    if(count($results->getRows()) > 0) {
        $json .= json_encode($results->getRows());
    } else {
        $json .= '<p>No results found.</p>';
    }
        return $json;
  } 
```

我想知道如何 - 在 foreach 循环中获取输出的“数组”中的每个对象并在我的页面中使用它们。此时 eve 只是在输出上运行 count() 只返回 1。

我的最终目标是在地图叠加层和一些图表中使用这些数据。

提前感谢您的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:30:23.223

像这样的东西：

```
foreach($data as $row) {
  list($item, $country, $lat, $long, $number1, $number2) = $row;
  echo "$item was purchased in $country, at $lat x $long, with data $number1 and $number2\n";
} 
```

# .net - 链接文件和添加另一个项目作为参考之间的区别？

> ID：16068504
> 
> 赞同：2
> 
> 时间：2013-04-17T19:25:15.670
> 
> 标签：.net, visual-studio, class-library, code-sharing

我有一种情况，我想要在多个应用程序中使用的功能。特别是，我有`Repository`一个 C# 类库的形式，其中包含 EF .edmx、存储库和 UnitOfWork 等足够通用的东西，可以跨应用程序使用。

我很沮丧，因为我*应该*清楚地理解这些差异，所以我无法更清楚地看到图片；我做到了一点。但是我认为我无法看透每个选择的后果和整体差异。

我已阅读此链接：[如何在 Visual Studio 中的项目/解决方案之间共享代码？](https://stackoverflow.com/questions/1116465/how-do-you-share-code-between-projects-solutions-in-visual-studio)它提供了一些很好的建议，但两个建议似乎都站得住脚。我想更好地了解每种产品的下游影响，并了解哪种选择适合我的需要。

我相信通过*链接*文件，我会在 Application-2 中创建另一个*新* `Repository`项目，但将链接文件用于构成该新层的内容。

我相信添加`Repository`来自 Application-1 作为对 Application-2 的*引用*会起作用，但我不确定更改代码会产生什么影响。

我基本上需要知道哪种方法会产生正确的结果，因为我需要在 1..n 应用程序之间共享存储库层？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T21:37:19.570

如果你有一个 Repository/UnitOfWork 的实现，你想在多个独立项目之间共享，你有以下选项：

1.  将源 *.cs 文件放在某个公共文件夹中，并将这些文件作为链接添加到每个项目中。

    *优点*：

    *   所有错误修复/功能都会自动进入所有项目。
    *   您可以调试您的存储库代码。
    *   由于代码作为一组文件共享，因此每个解决方案都可以拥有自己的自定义数据访问项目，该项目可以扩展基本共享存储库代码。

    *缺点*：

    *   相同的代码在两个编译项目中重复，如果在某个时候 project1 将根据 project2 启动，则会出现类名/命名空间冲突，您必须手动解决（请参阅下面 Tom Blodget 的评论）。
    *   对共享类的代码更改必须小心，不要破坏现有功能（例如，删除已在其他项目中使用的存储库方法）。
    *   如果共享代码链接到多个库中，则与复制粘贴基本相同。
2.  将通用代码提取到类库中，将已编译的 .dll 程序集作为引用包含到两个项目中。

    *优点*：

    *   防止意外的合同变更。
    *   可能有单一版本的存储库实现 - 在 GAC 中注册
    *   可以完全隐藏实现细节（使存储库内部/密封），并且只公开接口。
    *   类库就像黑匣子一样，迫使你实现更好的合约接口/API。

    *缺点*：

    *   可能需要支持多个版本的程序集，例如当 project1 需要来自库 v2.0 的新功能时，并且 v2.0 包含阻止其在 project2 中使用的重大更改。
3.  提取到单独的类库并包含库作为项目引用

    *优点*：

    *   与选项 1 相同，除了存储库代码被封装到一个共享库中，并作为一个完整的解决方案部署。扩展它可能会导致重大更改。

    *缺点*：

    *   减少对更改的控制，如选项 1 - 更改库中的源代码可能导致其他项目中的潜在重大更改。

But again, it all depends on many factors - what kind of version control you are using, what will be lifecycle of your projects, are there multiple teams developing these projects, how these projects will be deployed and whether or not they will be connected. It all affects the final decision.

# c# - 实体框架 5 SaveChanges() 不回滚尝试的事务

> ID：16068505
> 
> 赞同：3
> 
> 时间：2013-04-17T19:25:16.367
> 
> 标签：c#, .net, asp.net-mvc-4, entity-framework-5

我有以下代码（EntityContext.Current 是一个 DbContext）：

```
try {
    Setting s = new Setting
    {
        id = 1,
        user_id = 0
    };

    EntityContext.Current.Settings.Add(s);
    EntityContext.Current.SaveChanges(); //this violates a foreign key constraint and therefore throws an exception
} catch (Exception ex) {
    ErrorContext.Log(ex);
} 
```

我期望（根据[这个答案](https://stackoverflow.com/a/1070426/1324019)）是挂起的更改在失败时将被回滚。但是，在我的错误记录方法中，我发现它们没有。

```
Error e = new Error
{
    message = ex.Message
};

EntityContext.Current.Errors.Add(e);

var pending = ((IObjectContextAdapter)EntityContext.Current).ObjectContext.ObjectStateManager.GetObjectStateEntries(System.Data.EntityState.Added);
//this contains both my new error entity and my old setting entity which shouldn't be here

EntityContext.Current.SaveChanges(); 
```

当我的应用程序尝试在数据库中记录错误时，它还尝试（再次）使用无效的外键约束保存设置，这会导致添加错误日志记录失败。

这是我第一次使用 EF 遇到这种行为。我尝试将第一个包装`SaveChanges()`在事务中，但发生了同样的问题。

根据[这个答案](https://stackoverflow.com/a/15013408/1324019)，我的连接字符串也不包含`Enlist=false`。我不知所措。这是预期的行为吗？我怎样才能防止这种情况发生？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T21:44:46.007

这是预期的行为。`SaveChanges`尝试在单个数据库事务中提交所有更改。如果失败，数据库事务将回滚，并且不会向数据库写入任何内容。

但是失败的事务不会改变上下文中实体的状态。这就是您的`Setting`实体仍处于 state的原因`Added`。

将您的实体附加`Error`到相同的上下文是一个问题，因为您通常无法将其存储到数据库中，就像在这个示例中一样。我会考虑使用仅打开新上下文、将`Error`实体添加到此上下文并保存更改的专用方法始终在新上下文中写入错误日志。然后立即丢弃。

# javascript - Ajax 选项卡设置在本地主机上不起作用（EasyTabs）

> ID：16068506
> 
> 赞同：0
> 
> 时间：2013-04-17T19:25:17.387
> 
> 标签：javascript, jquery, css, ajax, tabs

我正在为我的标签使用[EasyTabs](http://os.alfajango.com/easytabs/#ajax-tabs)。我使用 ajax-tabs，所以我可以从其他页面获取内容（当我点击导航菜单的相应按钮时）。但它不起作用。内容未加载。

根据开发人员的[博客](http://www.alfajango.com/blog/jquery-easytabs-v2-3-released-ajax-tabs-and-more/#/ajax-tabs)，我只需要更改 div 的顺序并添加 data-target 属性。但它不起作用，我不知道问题可能出在哪里。奇怪的是，当我不使用 Ajax 时它可以工作（但我需要 Ajax，以便在单击导航按钮时加载内容）。

我在 localhost:8888 上使用[Easytabs和 MAMP。](http://os.alfajango.com/easytabs/#ajax-tabs)出于测试目的，我使用的是 Safari 5.1.7。

这里我初始化[Easytabs](http://os.alfajango.com/easytabs/#ajax-tabs)。

```
<script type="text/javascript"> 
  $(document).ready(function(){ $('#tab_container').easytabs(); });
</script> 
```

这是我的按钮和 div 的设置。

```
<div id="tab_container" class="module_bg">
            <ul id="shadetabs">
                <li><a href="'<?php echo $setting['site_url'];?>/includes/homepage/new_games.inc.php'" data-target="#t1"><?php echo NEWEST_MODULE;?></a></li>
                <li><a href="'<?php echo $setting['site_url'];?>/includes/homepage/popular_games.inc.php'" data-target="#t2"><?php echo POPULAR_MODULE;?></a></li>
            </ul>

        <div class="panel_container">
                <div id="t1">
                </div>

                <div id="t2">
                </div>
         </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T20:12:44.493

我最初的想法[`EasyTabs`](http://os.alfajango.com/easytabs/#ajax-tabs)是它相当有问题，所以我建议使用[`jQueryUI's Tabs`](http://jqueryui.com/tabs/#ajax)（[API](http://api.jqueryui.com/tabs/)）。

如果您不熟悉[`jQueryUI`](http://jqueryui.com/). 您可以通过将其添加到您的`<head>`.

例子：

```
<head>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
</head> 
```

只要确保在之前添加（***否则***你会得到一个错误）。[`jQuery script`](https://developers.google.com/speed/libraries/devguide#jquery) *[`jQueryUI script`](https://developers.google.com/speed/libraries/devguide#jqueryui)*

 **注意：*我在示例中使用的版本可能已经过时，因此请确保您包含最新版本的[`jQuery`](http://jquery.com/)和[`jQueryUI`](http://jqueryui.com/).

* * *

这就是您实施`jQueryUI's Tabs`.

**JAVASCRIPT：**

```
$(function(){
    $('#tab_container').tabs();
}); 
```

这就是全部！*（容易吧？）*

**HTML：**

如果您想从其他页面加载内容，您需要做的就是将链接添加到`<a>`'s href 并`jQueryUI Tabs`处理其余部分。

```
<div id="tab_container" class="module_bg">
    <ul id="shadetabs">
        <li><a href="http://fiddle.jshell.net/dirtyd77/kC2Wn/1/show/">Link 1</a></li>
        <li><a href="http://fiddle.jshell.net/dirtyd77/kC2Wn/2/show/">Link 2</a></li>
    </ul>
</div> 
```

演示：http: [//jsfiddle.net/dirtyd77/kC2Wn/5/](http://jsfiddle.net/dirtyd77/kC2Wn/5/)

但是，如果内容位于同一页面上，则：

*   创建一个`<div>`内`<div id="tab_container" class="module_bg">`
*   给创建`<div>`的 ID（*“tab1”*）。
*   将 ID 放在`<a>`'s href 中。

这是HTML：

```
<div id="tab_container" class="module_bg">
    <ul id="shadetabs">
        <li><a href="http://fiddle.jshell.net/dirtyd77/kC2Wn/1/show/">Link 1</a></li>
        <li><a href="http://fiddle.jshell.net/dirtyd77/kC2Wn/2/show/">Link 2</a></li>
        <li><a href="#tab1">Link 3</a></li>
    </ul>

    <div id="tab1">
        I AM A TAB!
    </div>
</div> 
```

演示：http: [//jsfiddle.net/dirtyd77/kC2Wn/6/](http://jsfiddle.net/dirtyd77/kC2Wn/6/)

`jQueryUI's Tabs`非常灵活，所以它应该适合您的需求！我希望这会有所帮助，如果您有任何问题，请告诉我！

* * *

有用的网址：

*   [http://jquery.com](http://jquery.com)（jQuery 网站）
*   [http://jqueryui.com](http://jqueryui.com)（jQueryUI 网站）
*   [是否有指向 Google API 上“最新”jQuery 库的链接？](https://stackoverflow.com/questions/441412/is-there-a-link-to-the-latest-jquery-library-on-google-apis)（jQuery库的最新链接）
*   [https://stackoverflow.com/questions/1348559/are-there-hosted-jquery-ui-themes-anywhere（jQuery](https://stackoverflow.com/questions/1348559/are-there-hosted-jquery-ui-themes-anywhere) css 主题）
*   [http://jqueryui.com/themeroller/](http://jqueryui.com/themeroller/) (Themeroller - 创建你自己的主题)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T16:36:08.720

虽然我可能会为此使用 Jquery-UI Tabs，但这里是如何使用[Ajax Easy Tabs Plugin](http://os.alfajango.com/easytabs/#ajax-tabs)的。

[**jsFiddle**](http://jsfiddle.net/apaul34208/vcULm/5/)

一定要包括必要的外部资源。

```
<script src="/javascripts/jquery.js" type="text/javascript"></script>
<script src="/javascripts/jquery.hashchange.js" type="text/javascript"></script>
<script src="/javascripts/jquery.easytabs.js" type="text/javascript"></script> 
```

和

改变这个 -

```
$(document).ready(function(){ $('#tab_container').easytabs(); }); 
```

对此——

```
$(document).ready(function(){
  $('#ajax-tab-container').easytabs();
}); 
```

并将您的 HTML 更改为这样的内容-

```
 <div id="ajax-tab-container" class='tab-container'>
    <ul class='tabs'>
        <li class='tab'><a href="<!-- url of page 1 -->" data-target="#tabs-ajax-1">Page 1</a>

        </li>
        <li class='tab'><a href="<!-- url of page 2 -->" data-target="#tabs-ajax-2">Page 2</a>

        </li>
    </ul>
    <div class='panel-container'>
        <div id="tabs-ajax-1"></div>
        <div id="tabs-ajax-2"></div>
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-07T09:46:01.860

虽然原始发帖人已经解决了他的问题，但我来到这里的症状相同，但原因不同。

当使用 Chrome 通过本地文件系统查看页面时，也可以看到 AJAX 无法与 EasyTabs 一起使用的问题。Chrome 在设计上不允许使用 AJAX 方法加载本地文件。如果您遇到此问题，请检查 Firefox 和 IE 是否产生相同的问题，如果没有，那么您可能希望使用小型网络服务器通过 127.0.0.1 将文件提供给浏览器作为解决方法。

就 jQueryUI 选项卡而言，此小部件存在许多限制，EasyTabs 提供了简洁明了的解决方案（例如将导航区域与内容区域分开，或使用 UL 和 LI 之外的元素），因此您可能不会更好交换。此外，我没有目睹此处其他答案中报告的 EasyTabs 的任何错误，但诚然，文档很薄弱。*

# mongodb - 使用 Mongoose 执行非“$set”更新

> ID：16068508
> 
> 赞同：2
> 
> 时间：2013-04-17T19:25:24.323
> 
> 标签：mongodb, mongoose, database

Mongoose 文档指出，任何模型更新都是使用 '$set' 自动发送的：

```
var query = { name: 'borne' };
Model.update(query, { name: 'jason borne' }, options, callback)

// is sent as

Model.update(query, { $set: { name: 'jason borne' }}, options, callback) 
```

但我想执行传统的 Mongo 更新，实际上是用提供的值*重置文档。*但我似乎找不到任何简单的方法来使用 Mongoose 做到这一点。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:01:24.647

您可以使用本机驱动程序`update`来获得传统行为：

```
Model.collection.update.update(query, {name: 'jason borne'}, options, callback); 
```

请记住，当您执行此操作时，不会执行任何基于模式的 Mongoose 类型转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-06-01T05:30:03.093

您可以使用覆盖选项。它在文档中提到 - [http://mongoosejs.com/docs/api.html#update_update](http://mongoosejs.com/docs/api.html#update_update)

[![来自猫鼬文档的覆盖选项](https://i.stack.imgur.com/l6luc.png)](https://i.stack.imgur.com/l6luc.png)

# python - Django 多对多平等

> ID：16068512
> 
> 赞同：0
> 
> 时间：2013-04-17T19:25:34.213
> 
> 标签：python, django

我有一个模型，`Entry.`特别值得注意的是它的`addTags`功能，它向实例添加标签`Entry`并保存它。这是该类的完整代码：

```
class Entry(models.Model):

    title = models.CharField(max_length=80)
    author = models.ForeignKey(User)
    pubdate = models.DateTimeField()
    tags = models.ManyToManyField(Tag)
    text = models.TextField()

    def getAllTags(self):
        '''
        Returns all tags applied to a given entry
        '''
        return self.tags.all()

    def addTag(self, tagName):
        '''
        Add a tag to an entry. If tag does not exist, create it. If tag has
        already been added, do nothing.
        '''
        try:
            tag = Tag.objects.get(name=tagName)
            return tag
        except Tag.DoesNotExist:
            tag = self.tags.create(name=tagName)
            self.save()
            return tag 
```

奇怪的是，当我使用以下代码测试 addTag 函数时（entry1 是之前创建的，并且是一个有效的 Entry 对象）：

```
 tag1 = entry1.addTag("testtag2")
    tag2 = entry1.addTag("testtag2")
    tag3 = entry1.addTag("testtag3")
    tagList = [tag1, tag2, tag3]
    for listTag, objTag in zip(tagList, entry1.tags.all()):
        print "%s: %s" % (listTag, objTag)
    self.assertEqual(entry1.tags.all(), tagList) 
```

我收到以下断言错误：

```
AssertionError: [<Tag: testtag>, <Tag: testtag2>, <Tag: testtag3>] != [<Tag: testtag>, <Tag: testtag2>, <Tag: testtag3>] 
```

然而，上面代码中的 print 语句给了我以下信息：

```
testtag: testtag
testtag2: testtag2
testtag3: testtag3 
```

表示标签已按预期创建。似乎每个标签对象的不同内存位置都已创建，但我不明白这是怎么回事。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:49:36.597

```
self.assertEqual(list(entry1.tags.all()), tagList) 
```

entry1.tags.all() 是一个不覆盖 __eq__ 方法的查询集，因此通过它的 id（内存位置）与其他对象进行比较。如果要将它返回的对象与 tagList 中的对象进行比较，则必须首先通过调用 list 来评估查询集。

list(entry1.tags.all()) 中的 Entry 实例与 tagList 中的不同。这不会改变两个列表相等，因为 Entry 实例确实有一个被覆盖的 __eq__ 方法并通过它们的 pk 进行比较。

编辑：

将 QuerySet 与列表进行比较时

```
entry1.tags.all() == tagList 
```

您没有比较它返回的实例，因为 Queryset 没有覆盖 __eq__ 方法，因此无法与列表进行比较。

但是可以比较两个列表。列表中的所有实例都是成对比较的，因为它们的 __eq__ 提供了除 id-comparison 之外的方法（它测试 pk 相等性），它们比较相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:35:53.347

试试这个来重构你的代码：

```
 class Entry(models.Model):

        title = models.CharField(max_length=80)
        author = models.ForeignKey(User)
        pubdate = models.DateTimeField()
        tags = models.ManyToManyField(Tag)
        text = models.TextField()

        def getAllTags(self):
            '''
            Returns all tags applied to a given entry
            '''
            return self.tags.all()

        def addTag(self, tagName):
            '''
            Add a tag to an entry. If tag does not exist, create it. If tag has
            already been added, do nothing.
            '''
            tag = Tag.objects.get_or_create(name=tagName)
            self.tags.add(tag)
            self.save() 
```

此外，在您的测试中，您必须比较两个列表：

```
self.assertEqual(list(entry1.tags.all()), tagList) 
```

# node.js - 在两个文档中查找带有条件的嵌入文档 mongoose

> ID：16068513
> 
> 赞同：0
> 
> 时间：2013-04-17T19:25:35.717
> 
> 标签：node.js, mongodb, mongoose

我正在开发一个有 2 个模型的程序，建筑和地板。架构定义如下。

```
var BuildingSchema = new Schema({
    block:{type:String,trim:true},
    project_id:{type:String},
    floors:[{type:Schema.Types.ObjectId,ref:'Floor'}]
})

var FloorSchema = new Schema({
    name:{type:String,trim:true},
    building_id:{type:String,ref:'Building'}
} 
```

我想做的是用 floor.name 和 building.project_id 的条件找到楼层结果。我试过这个但没有用

```
floor.find({name:'fname','building_id.project_id':123}).exec() 
```

我怎样才能得到我想要的？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:15:29.153

您需要使用[$elemMatch](http://docs.mongodb.org/manual/reference/operator/elemMatch/#op._S_elemMatch)来检索地板。[mongoosejs 文档在这里](http://mongoosejs.com/docs/2.7.x/docs/query.html)讨论它。

所以你可能会做类似的事情：

```
building.find({"project_id": 123}).where("floors").elemMatch(function(elem){
  elem.match("name", "fname");
}); 
```

这应该只返回匹配的地板元素`{"name": "fname"}`

# qt - 如何设置 QML 小部件的最小尺寸？

> ID：16068514
> 
> 赞同：4
> 
> 时间：2013-04-17T19:25:35.927
> 
> 标签：qt, qml, qtquick2

我正在使用 a`QDeclarativeView`来显示 QML 小部件。如何设置`QDeclarativeView`/widget 的最小高度，使其不会变得比我想要的小？我希望能够将其绑定到子小部件的最小尺寸，因此小部件不会重叠并且所有内容都保持适当的间距。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-18T15:57:42.163

iBelevie 的解决方案是可靠的，但有点矫枉过正。QML 在某种程度上是类固醇上的 CSS，并支持内联 javascript。我希望您现在知道这是怎么回事 :)
只需将您的属性定义为条件语句： `height: (root.height < threshold) ? minHeight: WhateverIsEpressibleInJavaScript`. 它不是圆滑和可靠的解决方案，但至少它是一个单行**内标记**。我把它留给读者思考它是否好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T19:25:35.927

### 步骤 #1：在 QML 中定义最小尺寸

首先，在您的主小部件中，创建两个属性来保存最小宽度和高度：

```
property int minWidth: <whatever>
property int minHeight: <whatever> 
```

如果您希望它基于小部件子项的最小大小，您可以执行以下操作：

```
Item {
    id: root

    property int minWidth: child.minWidth + 40; // Adds a 40px margin
    property int minHeight: child.minHeight + 40; // Adds a 40px margin

    Item {
        id: child
        property int minWidth: <whatever>
        property int minHeight: <whatever>
        anchors.centerIn: root
    }
} 
```

### 步骤#2：将 QML 中的最小尺寸连接到`QDeclarativeView`

然后，在创建 的类中`QDeclarativeView`，定义两个槽（`view`是`QDeclarativeView`）：

```
void onMinimumWidthChanged() {
    view->setMinimumWidth(view->rootObject()->property("minWidth").toInt());
}

void onMinimumHeightChanged() {
    view->setMinimumHeight(view->rootObject()->property("minHeight").toInt());
} 
```

然后，当您创建`QDeclarativeView`：

```
QDeclarativeView *view = new QDeclarativeView(this);
view->setResizeMode(QDeclarativeView::SizeRootObjectToView);
view->setSource(/* Whatever */);
QDeclarativeProperty(view->rootObject(), "minWidth").connectNotifySignal(this, SLOT(onMinimumWidthChanged()));
QDeclarativeProperty(view->rootObject(), "minHeight").connectNotifySignal(this, SLOT(onMinimumHeightChanged()));
onMinimumWidthChanged();
onMinimumHeightChanged(); 
```

现在，最小尺寸`QDeclarativeView`将绑定到主 QML 小部件中定义的最小尺寸。如果您在 QML 中的任何位置更改最小大小，则最小大小`QDeclarativeView`也会更改。

# python - Django - 站点匹配查询不存在

> ID：16068518
> 
> 赞同：32
> 
> 时间：2013-04-17T19:25:57.460
> 
> 标签：python, django, django-models

我试图让我在 Django 中的应用程序的管理站点正常工作。我刚刚同步了数据库，然后去了该网站，但我得到了错误......

```
Site matching query does not exist. 
```

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-04-17T19:28:16.723

每个 django 应用程序都需要`Site`运行。在这里你似乎没有它。

登录到你的 django shell

```
$> ./manage.py shell
>>> from django.contrib.sites.models import Site
>>> site = Site()
>>> site.domain = 'example.com'
>>> site.name = 'example.com'
>>> site.save() 
```

或者

```
$> ./manage.py shell
>>> from django.contrib.sites.models import Site
>>> site = Site.objects.create(domain='example.com', name='example.com')
>>> site.save() 
```

你应该准备好了。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2018-02-21T20:12:37.340

添加`django.contrib.sites`django`INSTALLED_APPS`并添加`SITE_ID=1`您的 django 设置文件。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2020-08-08T08:22:02.787

添加`SITE_ID=1`settings.py 对我有用。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-12-05T23:20:32.777

您还需要确保站点域与您实际使用的域相同。例如，如果您正在从[http://127.0.0.1:8000/admin/](http://127.0.0.1:8000/admin/)访问管理站点，那么您的 site.domain 应该是：site.domain = '127.0.0.1:8000'。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-08-02T20:47:38.967

**在settings.py**中试试这个：

```
SITE_ID = 1 
```

# c# - 自定义功能区在 ThisAddIn_Startup 之前加载，但我想在那里初始化一些东西 - 最佳解决方案？

> ID：16068522
> 
> 赞同：7
> 
> 时间：2013-04-17T19:26:10.920
> 
> 标签：c#, vsto, ms-office, add-in

我正在开发一个带有自己的功能区选项卡的 Word 加载项。我的大部分实际代码都包含在一些服务类中，这些类在 ThisAddIn_Startup 中初始化并分配给 ThisAddIn 单例对象的属性。我还有一个事件侦听器，用于侦听剪贴板事件，我想将这些事件作为同一对象的属性公开给其余代码。

我遇到的问题是我的 Ribbon 的 Load 事件在 ThisAddIn 的 Startup 事件之前触发（即使单例对象已经被初始化并分配给 Globals.ThisAddIn）。在我的 Ribbon 的 Load 事件处理程序中，我想在该侦听器上安装一个处理程序并使用其中一项服务。但是，我不能，因为在程序执行的这一点上它们是空的。

这个问题的最佳解决方案是什么？我可以将所有这些东西都设为 ThisAddIn 的静态成员并在静态构造函数中对其进行初始化，但这似乎是错误的，并且还会破坏拥有 Startup 事件（或单例对象）的全部意义。

奇怪的是，当我的 Ribbon 只是将其组件添加到内置的 Add-In 选项卡时，我最初没有遇到这个问题 - 然后在 Startup 之后触发了 Load 事件。

（注意：我在 Visual Studio 2012 中执行所有这些操作并使用功能区设计器。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T15:34:52.473

为此，我将覆盖**BeginInit**方法。根据我的经验，事件按顺序发生（功能区/初始化相关）：

1.  创建RibbonExtensibilityObject
2.  开始初始化
3.  获取自定义用户界面
4.  Ribbon_Load
5.  ThisAddIn_Startup

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-13T23:02:32.933

我已经测试了tinamou的解决方案，它不再起作用了。Ribbon_load 确实发生在 BeginInit 之后，但在此步骤中，功能区是固定的并且是只读的。无法添加组按钮..（但是可以修改动态菜单）。

我认为最好的方法（稳定）是预加载几个组等。并使用`visibility`控件的属性来获得一种动态功能区。

另请参阅此帖子[根据办公产品的语言本地化 VSTO 插件](https://stackoverflow.com/questions/8523812/localize-vsto-addin-according-to-the-language-of-the-office-product)，似乎`CreateRibbonExtensibilityObject` 是随机触发的。

# c++ - 在 C++ 中将文本分配给变量

> ID：16068523
> 
> 赞同：-2
> 
> 时间：2013-04-17T19:26:13.713
> 
> 标签：c++, visual-studio-2010, char

我在这里做了一些搜索，但我没有找到我正在寻找的解决方案。如果它在那里，我提前道歉。我是科罗拉多技术大学的学生，正在学习 C++ 入门，之前在 C++ 方面的编程经验为零。

我正在尝试构建一个应该显示文本的程序。Visual Studio 不断出现构建错误。查看构建说明后，我确定错误在于尝试将文本分配给变量。这是我到目前为止所拥有的：

```
char my_name;
char my_major;
int my_zip;
char my_address;
char my_phone;
char my_city_state;

cin >> "What is your name? " >> my_name;
cin >> "What is your street address, without city, state & ZIP? " >> my_street;
cin >> "What is the City and state that you live in? " >> my_city_state;
cin >> "What is the ZIP code? " >> my_zip;
cin >> "What is your phone number? " >> my_phone;
cin >> "What is your major? " >> my_major; 
```

我曾尝试直接分配，如下所示：

```
my_name="C++ User"; 
```

但是在这里查看其他常见问题解答时，我意识到这是不可能的。

我如何能够像最初希望的那样直接分配，或者允许分配输入？

注意：基本代码行取自 RAPTOR 输出，我已经能够让它与它一起工作，只是在 Visual Studio 中没有。

提前感谢您的帮助，如果有答案，我很抱歉，但经过 15 分钟的查找，我无法在这里找到它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T19:28:38.277

`my_name`是一个单一的`char`，而你试图分配给它的是一个字符串文字（即一个s*数组*`char`）。

我建议[`std::string`](http://en.cppreference.com/w/cpp/string/basic_string)在这里使用。例如：

```
#include <string> // Header required for std::string

// ...

std::string my_name = "C++ User"; 
```

此外，您不应该`operator >>`在右侧使用字符串文字。而不是这样做：

```
cin >> "What is your name? " >> my_name; 
```

你应该这样做：

```
std::cout << "What is your name? "; // Print a message to the standard output
std::cin >> my_name; // Read a string from the standard input 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:01:44.527

您应该使用 std::string 从用户获取字符串输入，使用 std::cout 显示用户消息，使用 std::cin 获取用户输入。

像这样的东西你也需要#include

```
std::string name;

std::cout<<"What is your name "<<std::endl;
std::cin >> name; 
```

# mysql - Mysql：帮助订购一个选择语句并获得集合的中间

> ID：16068530
> 
> 赞同：0
> 
> 时间：2013-04-17T19:26:33.663
> 
> 标签：mysql

所以我有

```
SELECT * FROM table ORDER BY column DESC LIMIT 100; 
```

我想做的是根据...“索引”获得一组 100 个？基本上我想说第 50 到第 149 或第 300 到第 399。

对不起，我只是不知道这个术语...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:31:03.830

```
SELECT * FROM table ORDER BY column DESC LIMIT 100 , 50 ; 
```

您需要使用偏移量。通过 300 而不是 50，您将获得 300 和 400 的结果集

编辑：这将得到 100 -> 400，因为第一个值是使用 ',' 时的起始索引

# android - 带有 JSON.NET 的包非常大

> ID：16068531
> 
> 赞同：1
> 
> 时间：2013-04-17T19:26:50.447
> 
> 标签：android, linker, xamarin.android, json.net

我正在使用 JSON.NET 在我的 Mono for Android 应用程序中解析 JSON。但是当我制作一个包时，生成的文件是 17 MB 的链接：无。启用链接后，包大小减小到 4 MB，但出现错误：

```
System.MissingMethodException: Default constructor not found for type System.ComponentModel.TypeConverter. 
```

我怀疑链接出错了，但我不知道为什么。不过，我想减小包裹的大小。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-10T11:37:11.467

打开链接将丢弃任何在编译时未使用的方法、属性、属性...。这是例如反射方法的问题。

您的问题 - 非常大的包裹可以通过以下方式解决：

1.  减少库代码 - 手动删除未使用的代码并链接 - 可能不想这样做
2.  使用 DataContractJsonSerializer - 使用此类的应用程序要小得多
3.  使用 17 MB 的应用程序，毕竟它仍然可以忍受 :) 并且链接“仅 Sdk 程序集”也可以提供一点帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T20:03:28.763

使用[Xamarin Component Store](http://components.xamarin.com/view/json.net/)提供的 Json.Net 。我已将此组件用于多个项目，并且启用链接的发布版本在 4-8 MB 之间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-20T18:06:47.933

可以通过将系统程序集添加到项目的 Mono Android 选项下的“跳过链接程序集”列表来解决此问题。这对我来说增加了 < 1 Mb 的 APK 大小。

# python - 如果我填充十进制字段，则无法保存模型实例

> ID：16068532
> 
> 赞同：0
> 
> 时间：2013-04-17T19:26:50.487
> 
> 标签：python, django, python-2.7, model, decimal

所以这发生在我身上：

```
thing = ModelClass()
thing.foo = bar()
thing.do_Stuff()
thing.save()  #works fine
thing.decimal_field = decimal_value
thing.save()  #error here 
```

追溯如下：

```
TypeError at /journey/collaborators/2/

unsupported operand type(s) for ** or pow(): 'Decimal' and 'str'

274\.             oH.save()
File "/usr/lib/python2.7/dist-packages/django/db/models/base.py" in save
  460\.         self.save_base(using=using, force_insert=force_insert, force_update=force_update)
File "/usr/lib/python2.7/dist-packages/django/db/models/base.py" in save_base
  543\.                         for f in meta.local_fields if not isinstance(f, AutoField)]
File "/usr/lib/python2.7/dist-packages/django/db/models/fields/subclassing.py" in inner
  28\.             return func(*args, **kwargs)
File "/usr/lib/python2.7/dist-packages/django/db/models/fields/__init__.py" in get_db_prep_save
  787\.                 self.max_digits, self.decimal_places)
File "/usr/lib/python2.7/dist-packages/django/db/backends/__init__.py" in value_to_db_decimal
  705\.         return util.format_number(value, max_digits, decimal_places)
File "/usr/lib/python2.7/dist-packages/django/db/backends/util.py" in format_number
  145\.         return u'%s' % str(value.quantize(decimal.Decimal(".1") ** decimal_places, context=context)) 
```

我尝试设置`decimal_value`为一个`decimal.Decimal`实例、一个浮点数、一个 int 和一个字符串。除非我将该字段留空，否则我似乎无法保存我的模型实例。

任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:28:24.310

解决它。我变了：

```
 decimal_field = models.DecimalField(decimal_places='2',max_digits='6',null=True) 
```

至

```
 decimal_field = models.DecimalField(decimal_places=2,max_digits=6,null=True) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:10:13.813

从堆栈跟踪，它看起来像`decimal_places`这里

```
return u'%s' % str(value.quantize(decimal.Decimal(".1") ** decimal_places, context=context)) 
```

是 a`str`并且您正在尝试执行`pow`不允许`Decimal`和`str`类型的操作 ( )

因此，您可以尝试更改`decimal_places`为`int(decimal_places)`或弄清楚为什么它是 a`str`而不是`int`.

# java - 带有小时和秒的 RRULE google-rfc-2445

> ID：16068537
> 
> 赞同：3
> 
> 时间：2013-04-17T19:27:11.770
> 
> 标签：java, jodatime, rfc2445, rrule, rfc5545

我正在使用实现 google-rfc-2445 ( [https://code.google.com/p/google-rfc-2445/](https://code.google.com/p/google-rfc-2445/) ) 来生成应该在事件之后重复的日期，而不是作为规则指示 ( RRULE) 重复完成还要记下时间，即下次我也扔的时候计算日期。

```
example:
Start Date: 17/04/2013 8:30 a.m.
Rule: "RRULE: FREQ = DAILY; UNTIL = 20130430T083000Z, INTERVAL = 1"
Expected Result, Next Repetition: 4/18/2013 8:30 a.m.
Result Obtained, Next Repetition: 4/18/2013 00 00 00 
```

这是我正在使用的代码

```
 LocalDate start = new LocalDate(System.currentTimeMillis());

            String ical = "RRULE:FREQ=DAILY;"
                    + "UNTIL=20130430T083000Z;"
                    + "INTERVAL=1;";

            //Next Notification
            Date f = null;

            for (LocalDate date
                    : LocalDateIteratorFactory.createLocalDateIterable(ical, start, false)) {
                 f  = date.toDateTimeAtCurrentTime().toLocalDate().toDate();
                break;
            }

            System.out.println("Next = " + f); 
```

打印结果为 **Next = Wed Apr 17 00:00:00 COT 2013**

是“BYHOUR = 8; BYMINUTE = 05; BYSECOND = 10”的存在，而不是如何使用它，如果我能伸出援手，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T19:32:05.743

`LocalDateIteratorFactory` produces dates without a corresponding time, but it sounds like you want DateTimes. Use [`DateTimeIteratorFactory`](http://google-rfc-2445.googlecode.com/svn/trunk/snapshot/docs/com/google/ical/compat/jodatime/DateTimeIteratorFactory.html) instead.

Also,

```
LocalDate start = new LocalDate(System.currentTimeMillis()); 
```

is probably not equivalent to

```
Start Date: 17/04/2013 8:30 a.m. 
```

You probably want to use [`DateTime`](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html)

```
DateTime start = new DateTime(2013, 4, 17, 8, 30, 0); 
```

Finally, there's no reason to use the Joda time compatibility layer if what you want at the end is

```
Date f = null; 
```

Just use the [`java.util` compatibility layer](http://google-rfc-2445.googlecode.com/svn/trunk/snapshot/docs/com/google/ical/compat/javautil/DateIteratorFactory.html) instead.

I would suggest sticking to Joda time though, since `java.util` dates are a mess.

# jquery - jQuery 可排序语法错误：在 . 操作员

> ID：16068546
> 
> 赞同：1
> 
> 时间：2013-04-17T19:27:40.607
> 
> 标签：jquery, jquery-ui-sortable

我正在关注本教程[https://www.youtube.com/watch?v=3mOs0VY_sIw](https://www.youtube.com/watch?v=3mOs0VY_sIw)

```
$(function() {
    $( "#navsort" ).sortable({
        update: function(event, ui) {
            var postData = $(this).sortable('serialize');
            console.log(postData);

            $.post('save.php'. {list: postData}, function(o) { // i stuck here giving error
                console.log(o);
            }, 'json');
        }
    });
}); 
```

我坚持`$.post('save.php'. {list: postData}, function(o)`并给出错误`SyntaxError: missing name after . operator`

请帮我解决这个问题。我是 jquery 的新手

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:29:44.810

You have `.` after `save.php` replace it with `,`

```
$.post('save.php', {list: postData}, function(o) { 
                console.log(o);
            }, 'json'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:30:08.790

You need to place a "," after 'save.php' instead of a ".".

```
 $.post('save.php', {list: postData}, function(o) { // i stuck here giving error
                console.log(o);
            }, 'json'); 
```

# php - 如何阻止少数用户编辑相同的文本

> ID：16068548
> 
> 赞同：-1
> 
> 时间：2013-04-17T19:27:56.060
> 
> 标签：php, phpmyadmin

我需要防止用户同时在 tinymce 上编辑相同的文本或文章。

当一个用户在管理面板中编辑文本时，如何阻止其他用户进行编辑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:44:21.847

实际上有很多方法......但是当我坐在约翰的时候，我的头顶就是

1.  当您的应用程序中的某人开始编辑时，您然后向数据库发送更新查询顶部更新“编辑”行

2.  现在，如果下一个用户尝试编辑相同的帖子重定向，则会出现错误消息。

3.  如果第一个用户完成，则发送另一个查询以更新“编辑”行。现在第二个ist可以编辑他们想要的任何东西......

像这样的东西会起作用：

```
If($_POST['startedit'] ) { 
     ............... // start your editing and then also send a query to a database

} else { 
   If($_POST['finished']){ 
       .............// send the update query and send them some where like homepage
   }
} 
```

有任何问题请询问

> > 编辑 1

好的，所以你问如何获得编辑时间？好吧，有很多方法可以让它变得简单，你实际上可以使用数据库来为你做时间戳，我会告诉你这是可能的。

步骤 1) 在数据库中创建一个包含您需要的所有字段的表，然后在表的末尾设置一个时间戳字段，该字段设置为在更新行时更新。（如果您不知道任何 sql，可以使用 PHPmyadmin 轻松完成）

步骤 2) 当用户点击“startedit”按钮时

你会像这样发送一个查询：

```
$query = $pdo->prepare("UPDATE `yourtable` SET `editing` = '1' WHERE `text_id` = ':id'"); //Using PDO you prepare a update query to dynamically update any ID based on what form a user is using.

$query->bindParam(':ID', $form_id); // Bind your value of the form to the parameter being passed to the PDO query

$query->execute() // Run the PDO query. 
```

现在你可以在 $query 上做一个条件 if 来检查它是否执行，如果它执行了，它将返回 true ......所以我们这样做：

```
if($query) {
    Redirect(to the form that he / she wants to work on) // Redirect (obviously lol)
} else { 
............ What ever? ...........
} 
```

现在你问自己好废话，我如何检查是否有人正在编辑此表单？

那么我们需要在旁边运行一个查询来查看表单是否正在被编辑。

所以我们这样做：

```
$query = $pdo->prepare("SELECT * from `yourtable` WHERE `editing` = `1` and `form_id` = :ID"); // Retrieve all forms that are being edited

$query->bindParam(':ID', $form_id); // Bind the parameter 

 $query->execute();

 if ($query->rowCount() > 0 ) {
     die("OOOPS! Some one is editing this form!! - Sorry to late!")
 } else {
   echo "Have fun editing punk!"; 
 } 
```

你去吧，这就是它的要点。我不会为你编写所有代码。但这是完成此任务的基本方法。现在，您当然要添加是否发生超时，将用户从编辑中踢出等等。如果用户完成，则将编辑更新为 = 0\. 等等。

这将帮助你建立你的工作。

我也在使用 PDO，所以如果您不习惯它，请阅读[this](http://php.net/manual/en/book.pdo.php)和[this](https://stackoverflow.com/questions/16072212/learning-select-from-where-prepared-statements/16072437#16072437)。

*   享受

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:57:14.577

可能最友好的解决方案是让用户同时编辑文章。如果发生冲突——比如文章在给定的时间跨度内被不同的用户保存——人们可以选择要使用的文章的哪个版本。这需要版本控制，并且可能比@Rixhers Ajazi 解决方案更难实现。

# delphi - 如何最好地将整数转换为浮点值而不分配给变量？

> ID：16068553
> 
> 赞同：5
> 
> 时间：2013-04-17T19:28:25.173
> 
> 标签：delphi

我想知道如何在不分配中间变量的情况下将整数转换为浮点值。有问题的代码如下所示：

```
Format('Theoretical peak scaling %6.2f', [ThreadCount]) 
```

这显然在运行时失败，因为`ThreadCount`它是一个整数。

我尝试了明显的

```
Format('Theoretical peak scaling %6.2f', [Double(ThreadCount)]) 
```

并且编译器拒绝了

```
E2089 Invalid typecast 
```

我知道我会写

```
Format('Theoretical peak scaling %6.2f', [ThreadCount*1.0]) 
```

但这读起来很糟糕，只会诱使未来的维护者删除错误的乘法。

有没有人知道没有中间变量的干净方法，并且可以使代码意图对未来的读者清楚？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T19:50:23.573

这可能感觉很愚蠢......但如果它是一个整数，为什么不只是：

```
Format('Theoretical peak scaling %3d.00', [ThreadCount]); 
```

小数点后除了零之外，你永远不会有任何东西，对吧？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-17T20:54:59.827

您可以选择将 a`record helper`用于内部类型：

```
type
  TIntHelper = record helper for Integer
    function AsFloat : Double;
  end;

function TIntHelper.AsFloat: Double;
begin
  Result := Self;
end;

Format('Theoretical peak scaling %6.2f', [ThreadCount.AsFloat]) 
```

这是在 XE3 中添加的，但受到 Embarcadero 的一些限制。由于范围内只能有一个助手，因此 Emarcadero 建议此功能仅供他们在 RTL 内部使用。

Marco Cantu 的名言：

> *   我们建议不要自己编写（尽管您可能希望将其作为我们不支持的类型的临时措施）
>     
>     
> *   原因不仅是每个类规则只有一个助手，而且这种行为将来会发生变化，具有不同的编译器机制。所以如果你得到了这个，不要为未来屏住呼吸。

参考资料：[`On Record/Class/Type Helpers`](https://forums.embarcadero.com/thread.jspa?threadID=84839)。

**更新：**在[`XE4`](http://docwiki.embarcadero.com/RADStudio/XE4/en/What%27s_New_in_Delphi_and_C%2B%2BBuilder_XE4#Run-Time_Library_.28RTL.29_Changes_for_XE4)，一个内置的整数帮助类[`TIntegerHelper`](http://docwiki.embarcadero.com/Libraries/XE4/en/System.SysUtils.TIntegerHelper)，，有一个方法`ToDouble`。

* * *

使用`RTTI`它可以通过内置的语言元素来解决：

```
Format('Theoretical peak scaling %6.2f', 
  [TValue.From<Integer>(ThreadCount).AsExtended]) 
```

* * *

只是 FTR，一个基准测试表明它`Double(Variant(i))`和内联助手`i.AsFloat`是可比的，但`TValue.From<Integer>(i).AsExtended`慢了 200 倍以上。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-17T19:41:37.923

这是学术性的，我会使用函数或 * 1.0 但这有效

```
Format('Theoretical peak scaling %6.2f', [Double(Variant(ThreadCount))]) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-17T19:34:54.420

你不能使用一个简单的功能：

```
function IntToDouble(const AInt: Integer): Double;
begin
  Result := AInt;
end;

Format('Theoretical peak scaling %6.2f', [IntToDouble(ThreadCount)]); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-17T19:54:38.653

你也可以这样做：

```
Format('Theoretical peak scaling %3d.00', [ThreadCount]) 
```

整数 ThreadCount 永远不会有任何小数部分，因此将小数零放在字符串中并将数据作为整数同样准确。;>

# json - RestKit 0.20 NSArray 序列化问题

> ID：16068555
> 
> 赞同：0
> 
> 时间：2013-04-17T19:28:29.910
> 
> 标签：json, restkit, restkit-0.20

我正在尝试序列化对象的 NSArray。

对象序列化为：

```
{"age":1,"name":"Foo"} 
```

如果我有一个包含这些对象的 NSArray，它应该序列化为：

```
[{"age":1,"name":"Bob"},{"age":4,"name":"Sally"},{"age":2,"name":"Jill"}] 
```

但是，当我直接通过 RestKit 对其进行序列化时，我得到以下信息：

```
{"age":[1,3,2],"name":["Sally","Jack","Bob"]} 
```

当我检查 RKMIMETypeSerialization 时，我看到以下内容：（与 json 输出匹配）

```
Parameters: {
    age =     (
        1,
        3,
        2
    );
    name =     (
        Sally,
        Jack,
        Bob
    );
} 
```

我确定我只是在做一些非常愚蠢的事情，我一直在玩它无法弄清楚。

这是我的映射逻辑

```
+ (RKObjectMapping *)mapping {
    RKObjectMapping *mapping = [RKObjectMapping mappingForClass:[Item class]];
    [mapping addAttributeMappingsFromDictionary:@{
            @"name" : @"name",
            @"age" : @"age"
    }];

    return mapping;
} 
```

这是执行数组序列化的逻辑：

```
+ (NSString *)JSONStringFromArray:(NSArray *)array {
    RKObjectMapping *mapping = [Item mapping];
    RKRequestDescriptor *requestDescriptor = [RKRequestDescriptor requestDescriptorWithMapping:mapping.inverseMapping objectClass:[Item class] rootKeyPath:nil];
    NSError *error;
    NSDictionary *parameters = [RKObjectParameterization parametersWithObject:array requestDescriptor:requestDescriptor error:&error];

// Serialize the object to JSON
    NSData *JSON = [RKMIMETypeSerialization dataFromObject:parameters MIMEType:RKMIMETypeJSON error:&error];

    NSString *jsonString = [[NSString alloc] initWithBytes:[JSON bytes]
                                                    length:[JSON length] encoding:NSUTF8StringEncoding];
    return jsonString;
} 
```

这里是测试类： **Item.h**

```
#import <Foundation/Foundation.h>

@interface Item : NSObject
@property(nonatomic, strong) NSString *name;
@property(nonatomic) int age;

+ (void)testJsonSerialization;

+ (void)testJsonArraySerialization;

+ (Item *)itemWithName:(NSString *)string age:(int)age;
@end 
```

**项目.m**

```
#import "Item.h"
#import <RestKit.h>

@implementation Item
+ (RKObjectMapping *)mapping {
    RKObjectMapping *mapping = [RKObjectMapping mappingForClass:[Item class]];
    [mapping addAttributeMappingsFromDictionary:@{
            @"name" : @"name",
            @"age" : @"age"
    }];

    return mapping;
}

- (NSString *)JSONString {
    RKObjectMapping *mapping = [Item mapping];
    RKRequestDescriptor *requestDescriptor = [RKRequestDescriptor requestDescriptorWithMapping:mapping.inverseMapping objectClass:[Item class] rootKeyPath:nil];
    NSError *error;
    NSDictionary *parameters = [RKObjectParameterization parametersWithObject:self requestDescriptor:requestDescriptor error:&error];

// Serialize the object to JSON
    NSData *JSON = [RKMIMETypeSerialization dataFromObject:parameters MIMEType:RKMIMETypeJSON error:&error];

    NSString *jsonString = [[NSString alloc] initWithBytes:[JSON bytes]
                                                    length:[JSON length] encoding:NSUTF8StringEncoding];
    return jsonString;
}

+ (NSString *)JSONStringFromArray:(NSArray *)array {
    RKObjectMapping *mapping = [Item mapping];
    RKRequestDescriptor *requestDescriptor = [RKRequestDescriptor requestDescriptorWithMapping:mapping.inverseMapping objectClass:[Item class] rootKeyPath:nil];
    NSError *error;
    NSDictionary *parameters = [RKObjectParameterization parametersWithObject:array requestDescriptor:requestDescriptor error:&error];

// Serialize the object to JSON
    NSData *JSON = [RKMIMETypeSerialization dataFromObject:parameters MIMEType:RKMIMETypeJSON error:&error];

    NSString *jsonString = [[NSString alloc] initWithBytes:[JSON bytes]
                                                    length:[JSON length] encoding:NSUTF8StringEncoding];
    return jsonString;
}

+ (void)testJsonSerialization {
    Item *item = [Item itemWithName:@"Foo" age:1];
    NSString *itemJSON = [item JSONString];
    NSLog(@"ItemJSON:\n%@\n\n", itemJSON);
}

+ (void)testJsonArraySerialization {
    NSArray *items = @[[Item itemWithName:@"Sally" age:1], [Item itemWithName:@"Jack" age:3], [Item itemWithName:@"Bob" age:2]];
    NSString *itemJSON = [Item JSONStringFromArray:items];
    NSLog(@"ItemArrayJSON:\n%@\n\n", itemJSON);
}

+ (Item *)itemWithName:(NSString *)name age:(int)age {
    Item *item = [[Item alloc] init];
    item.name = name;
    item.age = age;
    return item;
}
@end 
```

**执行** Have RestKit pod installed 然后发出以下命令：

```
 [Item testJsonSerialization];
    [Item testJsonArraySerialization]; 
```

请注意，也许我没有为数组序列化正确配置映射。虽然这个映射器非常适合反序列化上面的目标 json 文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T23:54:12.320

`RKObjectParameterization`预计将用于序列化对象映射目标的各个实例，并将实例静态序列化为`NSMutableDictionary`. 您不能编写一个映射来使用`RKObjectParameterization`它将一个对象数组序列化为一个字典数组。您需要自己通过循环遍历数组来完成此操作。

# delphi - 如何使形状在特定位置自动移动，按坐标进行坐标

> ID：16068558
> 
> 赞同：-3
> 
> 时间：2013-04-17T19:28:34.917
> 
> 标签：delphi

我为写了这么糟糕的标题而道歉，请您编辑它以便其他人理解我的意思吗？我会解释：

我想将形状移动到特定位置，例如从 x:=1000 移动到 x:=600。但是，如果我写：

```
shape1.left:=600; 
```

它将形状从 1000（起始位置）移动到 600，但我不希望它跳 400mm，而是先跳到 992，然后是 184，然后是 176 等，这样人们就可以看到它实际上是在移动。

我试过用命令（sleep），但是没用，可能还是跳了400mm：

```
Shape1.Left:=1000;
sleep (50);
shape1.Left:=992;
sleep (50);
...
... 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T19:33:28.633

永远不要`Sleep`在主线程中使用。它会阻止您的应用程序 GUI 线程，这是一个严重的失礼。

而是在表单上放置一个计时器。并编写一个像这样的计时器处理程序：

```
procedure TForm1.Timer1Timer(Sender: TObject);
begin
  Shape1.Left := Shape1.Left - 5;
end; 
```

定时器事件处理程序定期执行。每次计时器*滴答作响*时，您都会更新形状的位置。

您可能希望将计时器间隔设置得非常低，以使动画看起来很流畅。例如，尝试 100 毫秒。

当形状达到其目标时，您可能还想禁用计时器。

```
procedure TForm1.Timer1Timer(Sender: TObject);
begin
  Shape1.Left := Shape1.Left - 5;
  if Shape1.Left<=ShapeTargetLeft then
    Timer1.Enabled := False;
end; 
```

# c++ - Visual Studio 2008 启动调试更改关联可执行文件

> ID：16068563
> 
> 赞同：1
> 
> 时间：2013-04-17T19:28:49.033
> 
> 标签：c++, visual-studio-2008

在 Visual Studio 2008 中，我第一次按 F5（开始调试）时，它会询问我要调试什么可执行文件。我输入了一个错误的，现在每次我开始调试时都会运行错误的可执行文件。有没有办法改变它？

（我的项目是cmake生成的大C++项目）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:35:29.053

解决方案：Common Properties -> Startup Project -> Single startup project ->*选择正确的项目*

对于项目：配置属性 -> 调试 -> 命令 ->*导航到要启动的 .exe 路径*

我希望这有帮助！

# java - 可以从另一个线程安全地调用 disconnect() 以取消正在进行的 HttpURLConnection 吗？

> ID：16068564
> 
> 赞同：5
> 
> 时间：2013-04-17T19:28:57.863
> 
> 标签：java, android

如果我有一个`java.net.HttpURLConnection`在工作线程中接收数据（或即将接收数据）的设备，那么`disconnect()`在另一个线程中连接生命周期的任何时候调用以停止它是否安全？

我想知道这一点，因为我找不到明确记录的方式来中止正在进行的 HTTP 连接。通过调用来中断工作线程是`Thread.interrupt()`行不通的，因为`InputStream`你从中获得`HttpURLConnection`的不是可中断的。

我做了一些看起来像这样的实验：

```
// MyRequest.run() gets an HttpURLConnection by calling someUrl.openConnection()
MyRequest request = new MyRequest(someUrl);

FutureTask<SomeResult> task = new FutureTask<SomeResult>(request);
someExecutor.execute(task);

// The connection opens, data comes in, ...

// Get the HttpURLConnection from the request, call disconnect()
// Should be part of the cancel() of a FutureTask subclass
request.getConnection().disconnect(); 
```

它似乎可以工作，并且它创建的连接和套接字对象最终都会被 gc 清理掉。不过，我想知道这是否是正确的做法？`disconnect()`从另一个线程调用会有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-01T11:04:45.123

如果您在任务中正确处理它，那将起作用。更好的方法是在读取 InputStream 时检查任务的中断状态。

例如使用 BufferedReader：

```
HttpURLConnection conn = null;
try {

      //open Connection

   BufferedReader br = new BufferedReader(new InputStreamReader(inputstream));
   for(String line = br.readLine(); line != null && !Thread.currentThread().isInterrupted(); line = br.readLine()) {
         //do something
   }
} catch(IOException io) {
     //error handling
} finally {
   if(conn != null)
          conn.disconnect();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-20T19:19:49.473

[HttpURLConnection](http://developer.android.com/reference/java/net/HttpURLConnection.html)的文档说，“此类的实例不是线程安全的。” 由于`disconnect`是实例方法，因此根据文档，您不能在调用与对象相关的任何其他方法时调用它。通常，I/O 线程代码几乎总是调用与 HttpURLConnection 相关的方法，因为这些方法在等待网络时会阻塞。

如果您进行并发调用，例如一般的线程安全违规，当您在最重要的客户面前测试失败时，您可以期望它能够完美地工作。:-)

# c++ - 尝试使用分配器构造 std::list 时失败

> ID：16068569
> 
> 赞同：1
> 
> 时间：2013-04-17T19:29:09.607
> 
> 标签：c++, visual-studio-2012, stl

在尝试使用带有自定义分配器的普通 std::list 编译一些代码时，我发现了一个奇怪的行为。考虑以下代码：

```
std::list<int, std::allocator<int>> theList;
theList.push_back(1); 
```

这是一个添加了一些数据的普通列表变量。现在，如果我将其切换为：

```
std::list<int, std::allocator<int>> theList(std::allocator<int>());
theList.push_back(1); 
```

Visual Studio 2012 无法编译它并出现“错误 C2228：'.push_back' 左侧必须有类/结构/联合”。当然 std::list 有一个构造函数，它接受对分配器的 const 引用。但是，如果我将其更改为：

```
std::list<int, std::allocator<int>> theList = std::list<int, std::allocator<int>>(std::allocator<int>());
theList.push_back(1); 
```

一切皆好。为什么第二部分失败了？为了增加情况的奇怪之处，当尝试按值返回列表时：

```
typedef std::list<int, std::allocator<int>> TempType;

TempType func()
{
    TempType theList(std::allocator<int>());
    return theList;
} 
```

我得到“错误 C2664: 'std::list<_Ty,_Alloc>::list(const std::list<_Ty, *Alloc> &)' : cannot convert parameter 1 from 'TempType (* _cdecl *)(std::allocator < *Ty> (* _cdecl *)(void))' 到 'const std::list<_Ty,_Alloc> &'”。看起来编译器将列表视为函数声明。知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T19:35:40.263

您遇到[了最令人头疼的 parse](http://en.wikipedia.org/wiki/Most_vexing_parse)。编译器将 的定义解析`theList(std::allocator<int>())`为函数声明。这应该可以解决您的问题：

```
std::allocator<int> alloc;
std::list<int, std::allocator> > theList(alloc); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T19:34:16.737

它被称为[最令人头疼的解析](http://en.wikipedia.org/wiki/Most_vexing_parse)。

你不小心声明了一个*函数*。添加一组额外的括号将使其明确。

```
std::list<int, std::allocator<int>> theList((std::allocator<int>()));
//                                          ^                     ^ 
```

# css - 添加一些样式并在悬停时更改链接颜色：CSS

> ID：16068572
> 
> 赞同：0
> 
> 时间：2013-04-17T19:29:16.787
> 
> 标签：css, hyperlink, hover

我有一个带有一些超链接和 CSS 样式的字段集

```
.fieldset-start {
styling code here
} 
```

并编写鼠标悬停时的操作代码

```
.fieldset-start:hover
{
some on-hover styling code
} 
```

我想要做的是更改链接颜色并在悬停时删除下划线。

我目前有

```
.fieldset-start:hover A:link {
text-decoration:none;
} 
```

但它不起作用。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:36:46.660

它应该可以正常工作：http: [//jsfiddle.net/2JW32/](http://jsfiddle.net/2JW32/)

**CSS**

```
fieldset:hover a {
    text-decoration: none;
    color: red;
} 
```

**HTML**

```
<fieldset>
    <div>Hello World</div>
    <a href="http://google.com">Test 1</a>
    <a href="http://google.com">Test 2</a>
</fieldset> 
```

您可能想要检查另一个具有更高特异性的选择器是否不会阻止所需的效果。

还要记住，这`:link` [适用于尚未访问过的链接](http://www.w3.org/wiki/CSS/Selectors/pseudo-classes/%3alink)。如果您还需要匹配访问过的链接，您可以使用更通用的`a`选择器，或者为`a:visited`.

# c# - Unity3D third party C# library inclusion

> ID：16068574
> 
> 赞同：3
> 
> 时间：2013-04-17T19:29:20.027
> 
> 标签：c#, unity3d, state, nuget-package

So I'm currently working on making an RPG that's going to require a lot of state machines with Unity3D. The problem I'm running into is when trying to include the Stateless Framework [http://nuget.org/packages/Stateless/](http://nuget.org/packages/Stateless/) in my project, the framework is removed each time I close Unity.

Is there a special method for including C# libraries like this in Unity, or is it simply not allowed?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:49:22.123

您可以做的最好的事情是编写一个处理此问题的 C# 库并将其放置在检查器的插件文件夹中（您必须自己创建它）

创建一个带有公共类的库并在 C# 中直接引用它们 Plugin 文件夹中包含的每个库都将自动包含在您的统一脚本中。

# c# - 如何使用新的 Twitter API v1.1 获取用户的推文？

> ID：16068587
> 
> 赞同：3
> 
> 时间：2013-04-17T19:29:52.940
> 
> 标签：c#, asp.net, twitter

所以我目前正在使用它来从用户那里获取一定数量的推文：

```
public void GetTweets(string username, int tweetCount)
{
    var url = string.Format(
         "http://api.twitter.com/1/statuses/user_timeline.xml?screen_name={0}&count={1}", 
         username, tweetCount);
    XDocument xml = XDocument.Load(url);

    // parse xml
} 
```

使用新的 API 版本，这将不再被允许，我将不得不使用 JSON 发送一个 GET 请求：[https ://dev.twitter.com/docs/api/1.1/get/statuses/user_timeline](https://dev.twitter.com/docs/api/1.1/get/statuses/user_timeline)

我迷路的地方是需要通过 OAuth 进行身份验证。我需要一个 Twitter 帐户吗？我四处寻找使用 .NET 执行此操作的示例或教程，但找不到任何东西，只是链接回 v1.1 的 twitter 开发页面

有人可以指导我正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-21T15:52:10.837

您确实需要一个 Twitter 帐户，并且您需要获取“消费者密钥”和“消费者秘密”。您可以通过在[https://dev.twitter.com/apps](https://dev.twitter.com/apps)创建一个应用程序来做到这一点。

这是 IHttpHandler 中的一种方法，一旦您拥有这些方法，您就可以对其进行调整。它为客户端脚本提供了与[https://api.twitter.com/1/statuses/user_timeline.json](https://api.twitter.com/1/statuses/user_timeline.json)端点相同的功能。它在身份验证后请求该数据的 1.1 版本，因此它仅适用于您的应用程序。

对于比获取推文更复杂的事情，应该使用适当的 OAuth 握手 - 尝试 TweetSharp 库：[https ://github.com/danielcrenna/tweetsharp](https://github.com/danielcrenna/tweetsharp)

[下面的代码遵循https://dev.twitter.com/docs/auth/application-only-auth](https://dev.twitter.com/docs/auth/application-only-auth)中描述的过程，但它没有执行此处描述的所有 SSL 检查 - [https://dev.twitter.com/文档/安全/使用-ssl](https://dev.twitter.com/docs/security/using-ssl)。

```
public void ProcessRequest(HttpContext context)
{
    // get these from somewhere nice and secure...
    var key = ConfigurationManager.AppSettings["twitterConsumerKey"];
    var secret = ConfigurationManager.AppSettings["twitterConsumerSecret"];
    var server = HttpContext.Current.Server;
    var bearerToken = server.UrlEncode(key) + ":" + server.UrlEncode(secret);
    var b64Bearer = Convert.ToBase64String(Encoding.Default.GetBytes(bearerToken));
    using (var wc = new WebClient())
    {
        wc.Headers.Add("Content-Type", "application/x-www-form-urlencoded;charset=UTF-8");
        wc.Headers.Add("Authorization", "Basic " + b64Bearer);
        var tokenPayload = wc.UploadString("https://api.twitter.com/oauth2/token", "grant_type=client_credentials");
        var rgx = new Regex("\"access_token\"\\s*:\\s*\"([^\"]*)\"");
        // you can store this accessToken and just do the next bit if you want
        var accessToken = rgx.Match(tokenPayload).Groups[1].Value;
        wc.Headers.Clear();
        wc.Headers.Add("Authorization", "Bearer " + accessToken);

        const string url = "https://api.twitter.com/1.1/statuses/user_timeline.json?screen_name=YourTwitterHandle&count=4";
        // ...or you could pass through the query string and use this handler as if it was the old user_timeline.json
        // but only with YOUR Twitter account

        var tweets = wc.DownloadString(url);
        //do something sensible for caching here:
        context.Response.AppendHeader("Cache-Control", "public, s-maxage=300, max-age=300");
        context.Response.AppendHeader("Last-Modified", DateTime.Now.ToString("r", DateTimeFormatInfo.InvariantInfo));
        context.Response.AppendHeader("Expires", DateTime.Now.AddMinutes(5).ToString("r", DateTimeFormatInfo.InvariantInfo));
        context.Response.ContentType = "text/plain"; 
        context.Response.Write(tweets);
    }
} 
```

你可以：

*   将获取到的值存储起来，供以后使用，不需要每次都获取。
*   通过查询字符串上的参数 - 我认为 user_timeline.json 接受与 v1 版本相同的参数。
*   根据需要设置与缓存相关的 HTTP 标头 - 必须缓存此响应以避免遇到请求限制。
*   反序列化服务器上​​的 JSON 并用它做一些不同的事情。但如果你这样做，也许直接使用 TweetSharp。这实际上是为了向以前使用 API v1 的客户端脚本提供相同的 JSON 数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:47:48.780

> 我需要一个 Twitter 帐户吗？

Twitter 支持基于用户的身份验证和基于应用程序的身份验证，因此如果您不想使用 Twitter 用户帐户进行身份验证，则不必这样做。完整的细节在这里：

[https://dev.twitter.com/docs/auth/application-only-auth](https://dev.twitter.com/docs/auth/application-only-auth)

也就是说，我的建议是使用基于用户的身份验证。这是迄今为止最常用的 Twitter 身份验证方式，因此更容易找到文档和代码示例。这里有一些例子：

[https://dev.twitter.com/docs/auth/oauth/single-user-with-examples](https://dev.twitter.com/docs/auth/oauth/single-user-with-examples)

# c# - Cannot have multiple items selected in a DropDownList using C#

> ID：16068593
> 
> 赞同：3
> 
> 时间：2013-04-17T19:30:17.420
> 
> 标签：c#, asp.net, dropdownbox

i am getting this error when i try to select an item from the drop-down box "Cannot have multiple items selected in a DropDownList". Can someone please help me i am not sure why i am getting this. here is my code:

```
private void Bind_GridView()
{
this.BindGroupNameList(DropDownList1);
}

 private void GetGroupNameList(DropDownList DropDownList1)
    {
        String strConnString = System.Configuration.ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString;
        SqlConnection con2 = new SqlConnection(strConnString);
        SqlDataAdapter sda = new SqlDataAdapter();
        SqlCommand cmd1 = new SqlCommand("select distinct Name" +
                        " from MyTable");

        cmd1.Connection = con2;
        con2.Open();

        DropDownList1.DataSource = cmd1.ExecuteReader();
        DropDownList1.DataTextField = "Name";
        DropDownList1.DataValueField = "Name";
        DropDownList1.DataBind();
        con2.Close();
        DropDownList1.Items.FindByValue(ViewState["MyFilter"].ToString())
                .Selected = true;
    }

   //on item change
    protected void NameChanged(object sender, EventArgs e)
    {
        DropDownList DropDownList1 = (DropDownList)sender;
        ViewState["MyFilter"] = DropDownList1.SelectedValue;
        this.Bind_GridView();
    } 
```

and here is my dropdownbox in aspx

```
<asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="True" OnSelectedIndexChanged="NameChanged"
                        DataTextField="Name" DataValueField="Name" 
                        AppendDataBoundItems="true">
                        <asp:ListItem Text="ALL" Value="ALL"></asp:ListItem>
                        <asp:ListItem Text="Top 10" Value="10"></asp:ListItem>
                    </asp:DropDownList> 
```

Here is the code for the page load:

```
protected void Page_Load(object sender, EventArgs e)
    {

        if (!Page.IsPostBack)
        {

            ViewState["MyFilter"] = "ALL";
            this.Bind_GridView();

        }

} 
```

here is the method that calls GetGroupNameList:

```
 private void Bind_GridView()
    {
        DataTable dt = new DataTable();
        String strConnString = System.Configuration.ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString;
        SqlConnection con = new SqlConnection(strConnString);
        SqlDataAdapter sda = new SqlDataAdapter();
        SqlCommand cmd = new SqlCommand("sp_filter_Names");
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.Parameters.AddWithValue("@MyFilter", ViewState["MyFilter"].ToString());
        cmd.Connection = con;
        sda.SelectCommand = cmd;
        sda.Fill(dt);
        GV_Test.DataSource = dt;
        GV_Test.DataBind();
        GetGroupNameList();

    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-17T19:32:33.383

更改此行：

```
DropDownList1.Items.FindByValue(ViewState["MyFilter"].ToString())
              .Selected = true; 
```

对此：

```
DropDownList1.SelectedValue = ViewState["MyFilter"].ToString(); 
```

问题是您已经有一个选定的项目（可能是列表中的第一个），并且您正在搜索另一个并选择它。请记住，选择多个项目对`ListBox`and有效`CheckListBox`，但对 a无效`DropDownList`。

选择其中一项`ListItem`不会自动取消选择`ListItemColletion`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-18T08:28:43.763

这真的很简单，正如 Adrian 提到的，当您在下拉列表中选择了一个项目，然后**在代码的其他地方**选择了另一个项目时，就会发生此错误。

要解决此问题，请设置刹车点`GetGroupNameList`，如果在此行引发错误：

```
DropDownList1.Items.FindByValue(ViewState["MyFilter"].ToString()).Selected = true; 
```

将以下代码行放在其上方：

```
DropDownList1.ClearSelection(); 
```

如果该行没有抛出错误，则意味着第二次选择是在`GetGroupNameList`方法调用之后完成的，在这种情况下，`DropDownList1.ClearSelection();`直接在调用之后进行`GetGroupNameList`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T09:37:26.830

```
DropDownList1.ClearSelection();
DropDownList1.FindByValue("parameter").Selected = true; 
```

Make sure you are not databinding multiple ddls to the same datasource. Being selected is an attribute of an item, therefore, if different ddls select different items from the same datasource, each of the ddls ends up with multiple items selected which is probably what is happening here..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T09:38:30.840

你可以试试：

```
DropDownList1.ClearSelection(); 
```

行前：

```
DropDownList1.Items.FindByValue(ViewState["MyFilter"].ToString())
            .Selected = true; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-24T16:59:14.867

我建议您不要从 aspx 添加 DropDownList 的默认值，并在绑定数据之前清除所有项目。

```
<asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="True" OnSelectedIndexChanged="NameChanged"
                        DataTextField="Name" DataValueField="Name" >
                    </asp:DropDownList> 
```

并更改 GetGroupNameList 方法如下

```
private void GetGroupNameList(DropDownList ddl)
    {
        ddl.Items.Clear();
        String strConnString = System.Configuration.ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString;
        SqlConnection con2 = new SqlConnection(strConnString);
        SqlDataAdapter sda = new SqlDataAdapter();
        SqlCommand cmd1 = new SqlCommand("select distinct Name" +
                        " from MyTable");

        cmd1.Connection = con2;
        con2.Open();

        ddl.DataSource = cmd1.ExecuteReader();
        ddl.DataTextField = "Name";
        ddl.DataValueField = "Name";
        ddl.DataBind();
        con2.Close();

        ddl.Items.Insert(0, new ListItem("Top 10", "10"));
        ddl.Items.Insert(0, new ListItem("ALL", "ALL"));

        ListItem oListItem = ddl.Items.FindByValue(ViewState["MyFilter"].ToString());
        if(oListItem != null){
             ddl.ClearSelection();
             ddl.SelectedValue = oListItem.Value;
        }
    } 
```

# vba - 如何在特定页面上打开带有单词表信息的pdf文件

> ID：16068594
> 
> 赞同：0
> 
> 时间：2013-04-17T19:30:18.923
> 
> 标签：vba, pdf, ms-word

我有一个包含 3 列表格的 Word 文档。我正在尝试创建一个宏，它将在第 3 列的页码处打开一个 pdf 文件（名称存储在第 2 列中）。

我在 Excel 中找到了一个宏，当我选择页码单元格时会自动打开它，但在 Word 中没有。许多用户正在使用 Word 文档并且不想切换到 Excel。

最好是使用键盘快捷键激活宏，如果在表中，它将在光标所在行中指定的页面打开文件。如果光标不在表中，可能会显示错误。

谢谢。

> [编辑]

这是 Excel 宏的代码。请注意，在此示例中，Adobe Reader 路径和程序存储在单元格 B1 中，文件位于单元格 B2 中。

```
Private Sub Worksheet_SelectionChange(ByVal Target As Range)

   If Target.Row > 4 And Target.Column = 1 And Target.Value > 0 Then

      vAdobe = ActiveSheet.Cells(1, 2)
      vDocument = ActiveSheet.Cells(2, 2)

      vPage = Target.Value

      result = Shell(vAdobe & " /A ""page=" & vPage & """ " & vDocument, vbNormalFocus)

   End If
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T20:28:44.130

这是一种方法：

```
Sub OpenPDF()
Dim aRow As Row
Dim vDocument As String
Dim vPage As String
Dim vAdobe As String
Dim result As Long

vAdobe = <File path to Acrobat.exe here.>
If Selection.Information(wdWithInTable) = True Then
    Set aRow = Selection.Range.Rows(1)
    vDocument = Trim(Replace(Replace(aRow.Cells(2).Range.Text, "", ""), vbCr, ""))
    vPage = Trim(Replace(Replace(aRow.Cells(3).Range.Text, "", ""), vbCr, ""))
    result = Shell(vAdobe & " /A ""page=" & vPage & """ " & vDocument, vbNormalFocus)
Else: 'Some error message here.
End If
End Sub 
```

您可能需要使用那些 Replace 方法；我发现有必要删除从表格单元格中提取的任何文本末尾出现的一些表格字符。

另一个需要设置参考的选项可以在这里找到：[http ://www.myengineeringworld.net/2012/07/vba-macro-to-open-pdf-file.html](http://www.myengineeringworld.net/2012/07/vba-macro-to-open-pdf-file.html)

# php - 一个网页上的多个部分

> ID：16068597
> 
> 赞同：3
> 
> 时间：2013-04-17T19:30:26.477
> 
> 标签：php

我是一个试图吸收 HTML、PHP 和 MYSQL 的编程初学者。这是我的第一个问题。

我计划建立一个同时显示“管理”部分和注册用户/成员部分的站点。

为了提供更好的画面，想想 YELP，顶部是企业机构部分，底部是评论。不同之处在于企业主/管理员可以访问/编辑业务部分，但不能在审查部分这样做；反之亦然，用于底部的评论/会员用户。

我应该如何计划布局？它们会与两个不同的 PHP 代码放在一个 html 页面下吗？

有人可以提供一个布局结构作为指导吗？

例子

```
<html>
<?php
include( businessowner_admin.php); //with all the validations etc.

inlude(registered_member.php); //with all the validations etc.

?> 
</html> 
```

我在正确的道路上吗？或者是否需要 CSS 来处理这个问题？

谢谢凯蒂

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:00:27.957

[宣讲模式开启]

我认为你走错路了。在一个页面上拥有两个几乎完全不相关的功能集通常是个坏主意。而且，PHP 的一个总体问题是，遵循糟糕的编码标准非常容易。

所以，与其为你提供一个好的布局，这样你就可以扔进糟糕的代码（不要让它冒犯，在每个程序员的开发中第一步 - 编写糟糕的代码:)）

1.  [以正确的方式](http://www.phptherightway.com/)学习 PHP
2.  花一些时间研究一些著名的设计良好的 PHP [MVC](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)框架（例如[Symfony](http://symfony.com/)、[Yii](http://www.yiiframework.com/)或[Zend](http://framework.zend.com/)）。
3.  学习 HTML 和 CSS（谷歌搜索 CSS 或 HTML 教程——其中有很多）。
4.  使用一些好的文本编辑器，如[Sublime Text2](http://www.sublimetext.com/2)或[Notepad++](http://notepad-plus-plus.org/)（铁杆程序员会推荐`vim`或`emacs`- 不要听它们。这些是强大的野兽，*但*需要大量的努力来学习，嗯......采用它们 :) )
5.  学习一些数据库基础知识（如果你不确定 - 从[MySql](http://www.mysql.com/downloads/mysql/)开始）以及如何将它与 PHP 耦合（**永远不要使用 mysql_[something]** PHP 函数 - 它们已被弃用。使用`mysqli`or`pdo`首先，而不是转移到某些`ORM`框架，如[Doctrine2](http://www.doctrine-project.org/)） .
6.  最后，学习 javascript（例如在[codeacademy](http://www.codecademy.com)上）和一些好的 javascript 框架（[jQuery](http://jquery.com/)是事实上的“标准”）。

所有提到的仪器和技术都是免费的，所以唯一需要的资源是你的时间，而不是金钱。

一步一步地移动。这条路，走对了路，应该不会少于一两个月。但最终你将成为熟练的婚礼开发人员，适合大多数任务。

[讲道模式关闭]

至于问题，您最好将“管理”和“前端”页面分开，这样您就可以更轻松地管理访问、内容和样式。因此，您可以使用一些常用部分，如页眉/页脚、菜单等作为这些页面上的包含，但我认为页面本身最好是分开的（而且，您最好学习和使用一些

# c# - C# / .NET 编译器是否有任何理由不对 Dispose() 发出警告？

> ID：16068600
> 
> 赞同：6
> 
> 时间：2013-04-17T19:30:44.910
> 
> 标签：c#, .net, vb.net, idisposable

我今天在写一些`IDisposable`代码时正在考虑这个问题。

开发人员最好`Dispose()`直接调用，或者如果对象的生命周期允许，使用`using`构造。

我们需要担心的唯一实例是那些`using`由于代码机制而无法使用的实例。但我们应该在某个时候调用`Dispose()`这些对象。

鉴于 C# 编译器知道一个对象 implements `IDisposable`，理论上它也可以知道它`Dispose()`从未被调用过（它是一个非常聪明的编译器！）。它可能不知道程序员何时应该这样做的语义，但它可以很好地提醒它永远不会*被*调用，因为它从未在`using`构造中使用过，并且`Dispose()`从未在任何实现的对象上直接调用该方法`IDisposable`.

这有什么原因，还是有想法走这条路？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:51:39.003

> 它理论上也可以知道它`Dispose()`从未被调用过

它可以确定在某些简单的情况下`Dispose`永远不会被调用。仅基于对代码的静态分析，*无法*确定所有创建的实例都将被处理掉。代码也不需要非常复杂，即使估计对象是否未被处理也很简单。

更糟糕的是，*并非所有`IDisposable`对象实例都应该被释放*。这可能有很多原因。有时，`IDisposable`即使对象的一部分实例实际上在实现中做任何事情，对象也会实现。(`IEnumerator<T>`就是一个很好的例子。大量的实现在处理时什么都不做，但有些会做。如果你知道具体的实现是什么，你就不会在处理时做任何事情；如果你不知道你需要确保你打电话`Dispose`。

还有一些类型，例如`Task`几乎从不需要处理的类型。（请参阅[我需要处置任务吗？](http://blogs.msdn.com/b/pfxteam/archive/2012/03/25/10287435.aspx)。）在绝大多数情况下，您不需要处置它们，并且不必要地用`using`块或处置调用来混乱您的代码，这些调用不会妨碍可读性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T15:14:49.227

主要规则`IDisposable`是“最后一个离开房间的人，请关灯”。大多数 .NET 语言的设计中的一个主要失败是没有通用句法（甚至属性标记）约定来指示包含特定变量或包含特定字段的类的代码是否将：

1.  永远是最后一个离开房间的人
2.  永远不要成为最后一个离开房间的人
3.  有时是最后一个离开房间的人，并且在运行时很容易知道它是否会离开（例如，因为谁给了它一个参考告诉它）。
4.  可能是最后一个离开房间的人，但在它离开房间之前不知道它是否会是最后一个离开的人。

如果语言有语法来区分这些情况，那么编译器很容易确保知道它们将是最后一个离开房间的东西会关掉灯和永远不会的东西最后一个离开房间的人不要关灯。如果框架包含编译器知道的包装器类型，则编译器或框架可以促进第三种和第四种情况。传统的引用计数通常不能作为确定何时不再需要对象的主要机制，因为每次复制或销毁引用时它都需要处理器互锁，即使副本的持有者知道它不会是“最后一个离开房间”,

在没有约定是否应将特定引用视为“房间中的最后一个”的情况下，编译器无法知道该引用的持有者是否应该“关灯”（即 call `Dispose`） . VB.NET 和 C# 对于一种特殊情况都有特殊的`using`语法，其中变量的持有者知道它将是最后一个离开房间的人，但除此之外，如果编译器不这样做，编译器就不能真正要求清理这些东西。不明白他们。C++/CLI 确实有更通用的语法，但不幸的是它在使用上有很多限制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T19:32:53.980

代码分析规则将检测到这一点。根据您的 VS 版本，您可以使用 FXCop 或内置分析规则。

它需要在编译后对代码进行静态分析。

# java - 配置 JBoss Web 服务器以连接到 JBoss AS

> ID：16068601
> 
> 赞同：0
> 
> 时间：2013-04-17T19:30:49.133
> 
> 标签：java, jakarta-ee, configuration, jboss

我正在尝试配置 JBoss Web 服务器以连接到 JBoss AS。我们在一台机器上安装和配置了 JBoss Web 服务器，在另一台机器上安装和配置了 JBoss AS。如何配置我的 JBoss Web 服务器，以便当我调用映射到 Web 服务器的一些 url 时，它会将我重定向到部署在 JBoss AS 上的实际应用程序。我试图在网上搜索相同的内容，但找不到具体内容。这可能是一个非常简单的场景，但我是配置它的新手。有人可以在这里帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T14:42:22.857

取决于您在 JBoss AS 服务器上拥有的应用程序类型：EJB 或 Web 应用程序。

如果这是 EJB 应用程序，那么在您的 Servlet 或 JSP 页面或 Servlet 过滤器或 JBoss Web 服务器上使用的任何其他内容中创建 EJB 客户端。该客户端将调用 JBoss AS 上的 EJB 组件。

如果在 JBoss AS 服务器上您还有 Web 应用程序，则只需将请求重定向到 JBoss AS 或

# node.js - How to suggest files with tab completion using readline?

> ID：16068607
> 
> 赞同：8
> 
> 时间：2013-04-17T19:31:10.027
> 
> 标签：node.js, readline, tab-completion

Within the Bash shell, I can use tab-completion to use suggest file and directory names. How can I achieve this with nodejs and [readline](http://nodejs.org/api/readline.html#readline_readline_createinterface_options)?

Examples:

*   `/<Tab>` should suggest `/root/`, `/bin/`, etc.
*   `/et<Tab>` should complete to `/etc/`.
*   `fo<Tab>` should complete to `foobar` assuming such a file exists in the current directory.

I was thinking of using globbing (pattern `search_term.replace(/[?*]/g, "\\$&") + "*"`), but is there maybe a library that I have overlooked?

This is my current approach using glob, it is broken when using `//<Tab>` as it returns the canonicalized name and has possibly some other oddities:

```
function command_completion(line) {
    var hits;
    // likely broken, one does not simply escape a glob char
    var pat = line.replace(/[?*]/g, "\\$&") + "*";
    // depends: glob >= 3.0
    var glob = require("glob").sync;
    hits = glob(pat, {
        silent: true,
        nobrace: true,
        noglobstar: true,
        noext: true,
        nocomment: true,
        nonegate: true
    });

    return [hits, line];
}

var readline = require("readline");
rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout,
    completer: command_completion
});
rl.prompt(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2020-11-04T19:05:35.697

这是一个有一些怪癖的工作解决方案：

*   它不支持相对路径
*   当尝试通过按两次 Tab 来显示建议时，它会在建议列表中显示完整路径。
*   它更喜欢 '/' 而不是 '\'，但在 windows 上容忍 '\' 分隔符
*   它只支持目录和文件。（没有设备、管道、套接字、软链接）

代码：

```
const { promises: fsPromises } = require("fs"); 
const { parse, sep } = require("path");

function fileSystemCompleter(line, callback) {
  let { dir, base } = parse(line);
  fsPromises.readdir(dir, { withFileTypes: true })
    .then((dirEntries) => {
      // for an exact match that is a directory, read the contents of the directory
      if (dirEntries.find((entry) => entry.name === base && entry.isDirectory())) {
        dir = dir === "/" || dir === sep ? `${dir}${base}` : `${dir}/${base}`;
        return fsPromises.readdir(dir, { withFileTypes: true })
      }
      return dirEntries.filter((entry) => entry.name.startsWith(base));
    })
    .then((matchingEntries) => {
      if (dir === sep || dir === "/") {
        dir = "";
      }
      const hits = matchingEntries
        .filter((entry) => entry.isFile() || entry.isDirectory())
        .map((entry) => `${dir}/${entry.name}${entry.isDirectory() && !entry.name.endsWith("/") ? "/" : ""}`);
      callback(null, [hits, line]);
    })
    .catch(() => (callback(null, [[], line])));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-15T15:07:30.663

也许你可以看看 readdir：[https ://www.npmjs.com/package/readdir](https://www.npmjs.com/package/readdir)

只需读取用户正在创建选项卡的目录，然后将用户输入与目录中每个文件的开头进行比较，如果文件名匹配，则将其显示给用户。就像是：

```
var readDir = require('readdir');

function strncmp(str1, str2, lgth) {
  var s1 = (str1 + '')
    .substr(0, lgth);
  var s2 = (str2 + '')
    .substr(0, lgth);

  return ((s1 == s2) ? 0 : ((s1 > s2) ? 1 : -1));
}

var userInput = // get user input;
var path = // get the path;
readDir.read(path, [*], function(err, files) {
    for (var i = 0; i < files.length; i++)
        if (strncmp(files[i], userInput, userInput.length) == 0)
            console.log(files[i]);
}); 
```

# networkx - How to read in graphml file into networkx with weird characters?

> ID：16068608
> 
> 赞同：1
> 
> 时间：2013-04-17T19:31:11.153
> 
> 标签：networkx, graphml

I am trying to read in a graphml file of my facebook network into NetworkX. However, because some of my friends have unusual characters, such as accents, their names are unable to be read into networkx.

I ran the command:

```
g = nx.read_graphml("/Users/juliehui/Desktop/MyGraph.graphml") 
```

I then get the error:

> TypeError: int() argument must be a string or a number, not 'NoneType'

I looked at the graphml file in Sublime Text, and it seems to have trouble with names, such as Andrés

I then looked at the graphml file in Gephi to see what it looked like. The name, Andrés, in Gephi looks like:

> Andr‚Äö√†√∂¬¨¬©s

When I export the data without making any edits into a separate graphml file, and try to read that file in, I get the error:

> UnicodeEncodeError: 'ascii' codec can't encode characters in position 7-8: ordinal not in range(128)

When I delete the problem names in Gephi, then the file reads fine.

I am not sure if there is some way to edit my original graphml file to fix the names with unusual characters.

I have looked at this page: [Graphml parse error](https://stackoverflow.com/questions/8955797/graphml-parse-error/8958183#8958183) But, I could not figure out if my graphml file is in UTF-8 or needs to be in UTF-8 or needs to be in ASCII?

I have also tried:

```
data="/Users/juliehui/Desktop/MyGraph.graphml"
udata=data.decode("utf-8")
asciidata=udata.encode("ascii","ignore")
g = nx.read_graphml(asciidata) 
```

But, this gave the error:

> UnicodeEncodeError: 'ascii' codec can't encode characters in position 8-19: ordinal not in range(128)

How do I resolve this error?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-15T22:24:20.187

这在 Python 2.7 中对我有用。您必须将节点类型指定为 unicode。

```
nx.read_graphml('/path/to/my/file.graphml', unicode) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-22T12:59:25.507

我建议使用[unidecode](https://pypi.python.org/pypi/Unidecode)删除文件中的所有非 ASCII 字符：

```
from unidecode import unidecode
data_in="/Users/juliehui/Desktop/MyGraph.graphml"
data_ascii ="/Users/juliehui/Desktop/MyGraph_ASCII.graphml"
f_in = open(data_in, 'rb')
f_out = open(data_ascii, 'wb')
for line in f_in:
    f_out.write(unidecode(line))
f_in.close()
f_out.close() 
```

然后你可以希望使用：

```
g = nx.read_graphml(data_ascii) 
```

# php - PHP IF[FALSE/NULL/EMPTY] 函数

> ID：16068611
> 
> 赞同：-2
> 
> 时间：2013-04-17T19:31:16.880
> 
> 标签：php

大约一年以来，我在所有项目中都有一个名为：`ifNot()`.

这个函数在某种程度上是从三元运算符派生的：

```
public function ifNot( $item, $ifNot )
{
    if ( !$item ) {
        return $ifNot
    } else {
        return $item;
    }
}
// The var $foo twice
$var = ( $foo ) ? $foo : 'is empty or false =(';
// The var $foo once
$var = ifNot($foo, 'is empty or false =('); 
```

事实上，Twig 模板引擎使用类似的东西：

```
{{ foo ? 'yes' : 'no' }}

{# as of Twig 1.12.0 #}
{{ foo ?: 'no' }} == {{ foo ? foo : 'no' }}
{{ foo ? 'yes' }} == {{ foo ? 'yes' : '' }} 
```

问题是：这个功能有更好/已知的方法吗？

PS：SQL也有一个`IFNULL()`=)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T19:34:32.857

您的函数本质上等同[于 PHP 5.3 中添加的条件运算符的变体](http://www.php.net/manual/en/language.operators.comparison.php#language.operators.comparison.ternary)：

> 从 PHP 5.3 开始，可以省略三元运算符的中间部分。表达式***expr1 ?：***如果*expr1*的计算结果为**TRUE**，则*expr3*返回*expr1* ，否则返回 expr3。

 ****如果您的所有目标环境都是 PHP 5.3 或更高版本，则使用内置方法可能会快一点，但我并不担心。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T19:34:20.180

是的，如果您的 PHP 足够新（5.3.0 或更高版本）。请参阅有关[三元运算符的 PHP 文档](http://php.net/language.operators.comparison.php)

> 从 PHP 5.3 开始，可以省略三元运算符的中间部分。表达式 expr1 ?：如果 expr1 的计算结果为 TRUE，则 expr3 返回 expr1，否则返回 expr3。

因此，虽然您上面的代码*很*尴尬，但在某些情况下，您可能需要此三元运算符的函数版本（例如，用作[可调用](http://php.net/language.types.callable)- 在这些情况下，您可以使用闭包滚动：

`function($foo, $default) { return $foo ?: $default; }`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T19:32:43.403

```
$var = ifNot($foo, 'is empty or false =('); 
```

是相同的：

```
$var = $foo?:'is empty or false =('; 
```

在普通 PHP（>= 5.3 版）中也是如此。您的 ifNot 功能完全是多余的。****

# android - 谷歌地图未在移动设备上显示，但在模拟器中可见

> ID：16068612
> 
> 赞同：1
> 
> 时间：2013-04-17T19:31:23.703
> 
> 标签：android, google-maps-android-api-2

我正在制作一个涉及谷歌地图的应用程序..

地图工作正常，地图在我的模拟器中完全可见，但是当我在手机上安装相同的应用程序时，地图只显示网格......并且没有地图......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:45:58.217

我的 2 美分，请确保设备上安装了 Google Play 服务，可以在此处找到：

[https://play.google.com/store/apps/details?id=com.google.android.gms&hl=en](https://play.google.com/store/apps/details?id=com.google.android.gms&hl=en)

如果这不能解决问题，则很可能您使用的是调试密钥而不是生产密钥。在应用程序具有生产密钥并从播放商店下载之前，地图不显示是正常的。这里有一个类似的问题：

[Android Maps API V2 仅显示网格，调试中不显示地图。普通的？](https://stackoverflow.com/questions/14380486/android-maps-api-v2-shows-only-grid-no-map-in-debug-normal)

要获取生产密钥，请参阅本指南：

[https://developers.google.com/maps/documentation/android/start](https://developers.google.com/maps/documentation/android/start)

希望这可以帮助。:)

# wpf - 构建 Blend 解决方案时出错

> ID：16068613
> 
> 赞同：0
> 
> 时间：2013-04-17T19:31:33.287
> 
> 标签：wpf, silverlight, expression-blend, blend

我下载了一个混合 3 的 MS 教程文件并将其更新为 4；出现如下错误。好像和我不关心的语言资源有关，也不知道怎么去掉。其他 Blend 4 项目工作正常。

任何人都可以建议修复吗？

干杯

```
 c:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets(3001,9): error MSB3021:  
Unable to copy file "c:\Program Files (x86)\Microsoft SDKs\Expression\Blend\Silverlight\v4.0\Prototyping\Libraries
\de\Microsoft.Expression.Prototyping.Runtime.resources.dll" 
to "..\Bin\Debug\de\Microsoft.Expression.Prototyping.Runtime.resources.dll". 

The specified path, file name, or both are too long. The fully qualified file name must be less than 260 characters, 
and the directory name must be less than 248 characters. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:25:30.520

当我将文件（Sample Proj）提取到桌面或我的文档文件夹时，我会遇到这类问题。我建议将您的整个项目文件夹移动到 C:\ 并运行。这通常可以解决我与该错误相关的问题

# asp.net-mvc-4 - LINQ to EF 在 Where 子句中使用集合

> ID：16068615
> 
> 赞同：0
> 
> 时间：2013-04-17T19:31:50.720
> 
> 标签：asp.net-mvc-4, linq-to-entities, entity-framework-5

我有一个主 VendorProfile 表和一个包含状态代码和日期戳的 1-many VendorHistory 表。下面的查询仅用于检索每个供应商的最新状态（状态代码和日期）。但是，视图允许用户选择任何状态代码的复选框来过滤视图。所以我需要添加一个匹配任何复选框状态选择的 where 子句。

[模型图](https://skydrive.live.com/redir?resid=CD5A047338E8C232!1145&authkey=!ABZipFbNNDI14RQ)

```
 public IEnumerable<BrowseStatusModel> BrowseByStatus(int[] StatusSelections)
    {
        IQueryable<BrowseStatusModel> query = _db.VendorProfiles
            .Include("VendorStatusHistory")
            .Include("StatusCodes")
            .Select(s => new BrowseStatusModel
            {
                ProfileID = s.ProfileID,
                Name = s.Name,
                CompanyName = s.CompanyName,
                CompanyDBA = s.CompanyDBA,
                DateCreated = s.DateCreated,
                Status = s.VendorStatusHistories.OrderByDescending(o => o.DateCreated).FirstOrDefault().Id,
                StatusDate = s.VendorStatusHistories.OrderByDescending(o => o.DateCreated).FirstOrDefault().DateCreated
            })
            .OrderBy(x => x.ProfileID);

        foreach (int status in StatusSelections)
        {
            query = query.Where(x => x.Status == status);
        }
        return query;
    } 
```

上面的 foreach 循环有效，但不幸的是创建了 AND 条件，其中所有选择都必须为真，而不是 ANY。我想我必须以某种方式使用带有以下内容的 where 子句，但在正确的语法上没有成功。

```
.AsQueryable().Any(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:41:27.117

使用 contains 代替该 foreach 循环

`query = query.Where(x => StatusSelections.Contains(x.Status))`

# python - 无法将列表对象传递到模板瓶中

> ID：16068617
> 
> 赞同：1
> 
> 时间：2013-04-17T19:31:53.093
> 
> 标签：python, web, python-2.7, bottle

我对瓶子模板有一些问题。我无法将 python 列表传递给模板。我的代码如下：

```
@route('/'):
def home():
    return template('home', var=['item1', 'item2']) 
```

这是 home.tpl：

```
<html>
   <ul>
       #for item in var:
         <li>{{item}}</li>
       #end
   </ul>
</html> 
```

我认为它有效，但抛出了未定义的变量“项目”异常。请告诉我我的错误在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:38:30.433

瓶子模板语法使用`%`，*而不是* `#`标记 python(ish) 块：

```
<html>
   <ul>
       %for item in var:
         <li>{{item}}</li>
       %end
   </ul>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-08T16:34:55.790

如果您想以相反的顺序遍历列表，以下模板将起作用。

```
<html>
     <ul>
         %for i in range(len(var)-1,-1,-1):
             <li>{{var[i]}}</li>
         %end
     </ul>
</html> 
```

# c# - NHibernate Futures 有时返回代理，其他实体

> ID：16068618
> 
> 赞同：2
> 
> 时间：2013-04-17T19:31:58.117
> 
> 标签：c#, nhibernate, nhibernate-futures

我有一个使用多个未来查询处理完整对象图的数据库获取。它看起来像这样（已更改类名以保护无辜者）：

```
Foo foo;
var fooFuture = Session.QueryOver<Foo>()
                       .Where(f => f.Id == id)
                       .Future();

// load up the Blah collection for the Foo
Session.QueryOver<Foo>()
       .Fetch(f => f.Blahs).Eager
       .Where(f => f.Id == id)
       .Future();

// do a separate query for the BlahOptions -- this is needed
// because if we did a Join and Join off of Foo, we'd get duplicate Blah
// results and that's not good
Session.QueryOver<Blah>()
       .Fetch(b => b.Options).Eager
       .Where(b => b.Foo.Id == id)
       .Future();

// load up the Attributes for the Foo
Session.QueryOver<Foo>()
       .Fetch(f => f.Attributes).Eager
       .Where(f => f.Id == id)
       .Future();

foo = fooFuture.SingleOrDefault(); 
```

*注意：我可以在 NHibernate LINQ 中实现这一点，但行为保持不变。*

**奇怪的是：** `foo`有时会是类型`FooNamespace.Foo`（正确的、具体的类型），有时会是`Castle.Proxies.FooProxy`.

我得到的是真实类型还是代理类型似乎取决于之前是否在会话中使用过 NHibernate。当这个查询在其他 NHibernate 查询之后发生时，它返回一个`FooProxy`. 如果是第一次使用会话，则返回一个`Foo`.

**为什么会这样？我怎样才能防止它发生？** 我有目的地获取整个对象图`Foo`以确保没有代理。而且图本身不包含任何代理，它只是根`Foo`引用。返回的类型取决于 NHibernate 之前所做的事情这一事实似乎是关键（而且真的很奇怪）。

一些结束语：

*   `NHibernateUtil.IsInitialized`喂食 a 时返回 true `FooProxy`，所以我不能保证它不是这样的代理
*   我是代理不利的，因为该图将被序列化以用于缓存目的和反序列化在使用时发出呱呱叫声`FooProxy`

非常感谢任何见解！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T19:43:32.483

这通常会发生的原因是因为在此之前在会话中的其他地方加载了 Foo，并且您正在获取在先前查询中创建的代理。

我在以下方面取得了一些成功

```
var fooProxy = foo as INHibernateProxy;
if(fooProxy != null) {
   var context= Session.GetSessionImplementation().PersistenceContext;
   foo = context.Unproxy(fooProxy);
} 
```

不过，在大多数情况下，序列化过程似乎会将代理转换为正确的类型。

# wordpress - wordpress的分页结果

> ID：16068620
> 
> 赞同：1
> 
> 时间：2013-04-17T19:32:04.813
> 
> 标签：wordpress

Y尝试对wordpress的结果进行分页并使用此脚本，问题是当我分页时，页数显示正确，但如果分页的链接总是显示相同的内容，每个页数都没有变化

```
<?php 
global $post;

if (have_posts()) : ?>

<?php 
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
query_posts( 'cat=36&posts_per_page=4' );
while (have_posts()) : the_post(); ?>
<div class="cols_posts">
<?php
$imagen = wp_get_attachment_image_src( get_post_thumbnail_id($post->ID), 'full');
$ruta_imagen = $imagen[0];
echo '<img src="'.$ruta_imagen.'">';
?>
<div <?php post_class() ?> id="post-<?php the_ID(); ?>">
<h2><a href="<?php the_permalink() ?>" rel="bookmark" title="<?php the_title_attribute(); ?>"><?php the_title(); ?></a></h2>
<div class="extracto"><?php the_excerpt(); ?></div>
</div>
</div>
<?php endwhile; ?>
<?php wp_pagenavi(); ?> 
```

在第 1 页必须显示该页面的内容，在第 2 页中相同，等等，但始终显示相同的页面，即第一页内容

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T20:14:43.233

您可以为此使用函数。为此，请访问此页面

[http://design.sparklette.net/teaches/how-to-add-wordpress-pagination-without-a-plugin/](http://design.sparklette.net/teaches/how-to-add-wordpress-pagination-without-a-plugin/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T06:52:57.890

问题在这里：

```
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
query_posts( 'cat=36&posts_per_page=4' ); 
```

您正在`$paged`正确获取变量，但您没有在查询中使用它。

因此，将其添加到查询中，如下所示：

```
query_posts( 'cat=36&posts_per_page=4&paged='.$paged ); 
```

# jakarta-ee - 访问服务器上的 SSL 证书（私钥）

> ID：16068622
> 
> 赞同：0
> 
> 时间：2013-04-17T19:32:07.477
> 
> 标签：jakarta-ee, tomcat, ssl

我想使用我的网站的公钥解密在客户端加密的消息：

```
URL httpsURL = new URL("https://mediashuttle.com/");
HttpsURLConnection connection = (HttpsURLConnection) httpsURL.openConnection();
connection.connect();
Certificate cert = connection.getServerCertificates()[0];
PublicKey publicKey = cert.getPublicKey(); 
```

现在在服务器（Tomcat）端，我想解密传递给 Servlet 的消息。你能告诉我如何在 Tomcat 中检索私钥来解密消息吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T01:16:49.420

您需要从存储服务器密钥的密钥库中获取密钥。像这样：

```
File keyStoreFile = new File("path/to/keystore/file.jks");
InputStream inputStream = new FileInputStream(keyStoreFile);

KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());
keyStore.load(inputStream, "password".toCharArray());
Key key = keyStore.getKey("yourKeyAlias", "changeit".toCharArray());
Cipher cipher = Cipher.getInstance("RSA");
cipher.init(Cipher.DECRYPT_MODE, key);
byte[] encrypted = getEncripted();
byte[] decrypted = cipher.doFinal(encrypted); 
```

# javascript - 将 Junior Framework 与 Meteor 一起使用（Jr 未定义）

> ID：16068628
> 
> 赞同：1
> 
> 时间：2013-04-17T19:32:25.023
> 
> 标签：javascript, backbone.js, meteor

所以我目前正在开发我的第一个流星应用程序，这将是一个很好的移动应用程序。由于它只能在移动设备上运行，我想使用[Junior Framework](http://justspamjustin.github.io/junior/#home)来实现经典应用程序的外观和感觉 + 幻灯片转换。

它基于backbone.js。

所以我的流星应用程序也已经使用了主干并且工作得很好。现在的问题是，当我将初级包含在我的流星项目中时，没有定义初级命名空间（“Jr”）。

我认为这有以下原因： Meteor 总是使用以下代码自动包装项目中的任何 *.js 文件：

```
(function(){ ... }).call(this); 
```

这会破坏[初级 js 类](http://justspamjustin.github.io/junior/src/javascripts/junior.js)的类定义，导致“Jr”未定义。

我怎样才能解决这个问题？我真的需要 Junior 使用幻灯片过渡和一切。

或者让我们换一种说法：你知道有什么方法可以在同样使用backbone.js的meteor项目中包含页面之间的幻灯片转换（目前我正在使用标准的主干路由器+ Meteor的Template.templatename.var语法)?

提前谢谢你，最好的问候

帕特里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T06:23:32.757

你把你的 CSS + JS 放在哪里？

您应该将所有这些第 3 方的东西放在“public”文件夹中（它不会捆绑为流星 js，而是作为第 3 方 js + css。http [://docs.meteor.com/#structuringyourapp](http://docs.meteor.com/#structuringyourapp)

我创建了快速演示，我把所有东西都放在那里

# HTML

```
<head>
    <title>junior</title>
    <script src="lib/javascripts/modernizr.custom.15848.js"></script>
    <script src="lib/javascripts/zepto.min.js"></script>
    <script src="lib/javascripts/zepto.flickable.min.js"></script>
    <script src="lib/javascripts/lodash.min.js"></script>
    <script src="lib/javascripts/backbone-min.js"></script>
    <script src="src/javascripts/junior.js"></script>
    <link rel="stylesheet" href="lib/stylesheets/ratchet.css"/>
    <link rel="stylesheet" href="src/stylesheets/junior.css"/>
</head>

<body>
  {{> hello}}
</body>

<template name="hello">
  <div id="app-container">
    <div id="app-main">
        <h1>Hello World!</h1>
        {{greeting}}
        <input type="button" value="Click" />
    </div>
  </div>
</template> 
```

# JavaScript

```
// then i'm able to get Jr object on client side (anywhere)
console.log(Jr); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-07T04:11:07.330

所以初级不会做这个工作！

首先也是最重要的：到目前为止，移动设备上的幻灯片转换仍然非常错误和缓慢。因此，仅在您确实需要它们时才包含它们。如果您仍然在寻找一种在流星项目中进行滑动过渡的方法，我建议您看看：[Tom C's transitioner](https://github.com/tmeasday/meteor-transitioner/)

它不能完美运行，但它是目前最好的解决方案！

# ios - iOS：发布到 Twitter 导致错误 - 从主线程以外的线程获取网络锁

> ID：16068633
> 
> 赞同：1
> 
> 时间：2013-04-17T19:32:37.727
> 
> 标签：ios, cocoa-touch, twitter, slrequest

我正在制作一个要发布到 twitter 的应用程序（没有模式视图）。我对这个很陌生，`Social.framework`所以我遇到了一些问题。更具体地说，我得到了错误：

```
Obtaining the web lock from a thread other than the main thread or the web thread. UIKit should not be called from a secondary thread. 
```

而且我不确定是什么导致了这个错误。

我的 Twitter 方法如下所示：

```
- (void)postToTwitter
{
    ACAccountType *twitterType = [self.accountStore   accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierTwitter];

    SLRequestHandler requestHandler =
    ^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) {
        if (responseData) {
            NSInteger statusCode = urlResponse.statusCode;
            if (statusCode >= 200 && statusCode < 300) {
                NSDictionary *postResponseData =
                [NSJSONSerialization JSONObjectWithData:responseData
                                            options:NSJSONReadingMutableContainers
                                              error:NULL];
                NSLog(@"[SUCCESS!] Created Tweet with ID: %@", postResponseData[@"id_str"]);
            }
            else {
                NSLog(@"[ERROR] Server responded: status code %d %@", statusCode,
                  [NSHTTPURLResponse localizedStringForStatusCode:statusCode]);
            }
        }
        else {
            NSLog(@"[ERROR] An error occurred while posting: %@", [error localizedDescription]);
        }
    };

    ACAccountStoreRequestAccessCompletionHandler accountStoreHandler =
    ^(BOOL granted, NSError *error) {
        if (granted) {
            NSArray *accounts = [self.accountStore accountsWithAccountType:twitterType];
            NSURL *url = [NSURL URLWithString:@"https://api.twitter.com"
                      @"/1.1/statuses/update_with_media.json"];
            NSDictionary *params = @{@"status" : self.postTextField.text};
            SLRequest *request = [SLRequest requestForServiceType:SLServiceTypeTwitter
                                                requestMethod:SLRequestMethodPOST
                                                          URL:url
                                                   parameters:params];

            [request setAccount:[accounts lastObject]];
            [request performRequestWithHandler:requestHandler];
        }
        else {
            NSLog(@"[ERROR] An error occurred while asking for user authorization: %@",
              [error localizedDescription]);
        }
    };

    [self.accountStore requestAccessToAccountsWithType:twitterType
                                           options:NULL
                                        completion:accountStoreHandler];
} 
```

很像这里的例子：[https ://dev.twitter.com/docs/ios/posting-images-using-twrequest](https://dev.twitter.com/docs/ios/posting-images-using-twrequest)

任何人都可以看到代码有任何问题，还是其他原因导致错误？

**注意：似乎没有一个 NSLog 被调用。**

# java - 递归和乘法

> ID：16068643
> 
> 赞同：0
> 
> 时间：2013-04-17T19:33:04.747
> 
> 标签：java, recursion, multiplication

这可能是伙计们吗？这是我的作业，我的老师显然相信它，但在我看来，在短乘法之外不使用加法或乘法是不可能的。

> 编写（并提供测试器）递归算法：
> 
> 整数乘法（整数 x，整数 y）
> 
> 在不使用 * 运算符的情况下将两个正整数相乘。不要只是将 x 添加到自身 y 次！！！
> 
> （提示：编写一个递归方法，将一个整数乘以 0 .. 10 范围内的一个值。然后编写第二个递归方法来实现您在小学学习的乘法算法，将多位数字相乘。）

我的问题是，一旦你分解任何多位数字并开始将它们加在一起，你必须使用大于 10 的数字相乘，即 22 * 6 是 2 * 6 + 20 * 6 ......所以我完全错过了什么吗？

**编辑** 我想我应该添加这是我拥有的代码，

```
public int mult(int x, int y){
return x == 0 ? 0 : (mult(x-1, y) + y);
} 
```

这是完美的，但据我理解的说明，这是破坏不只是将 x 添加到自身 y 次。我个人认为不是，但我的老师还不是很清楚，我想知道是否有其他我没有想到的方法，抱歉造成混乱。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T19:36:30.517

是的，这是可能的。是的，我认为你错过了一些东西。试着写下你要遵循的步骤来手动将两个数字相乘，就像你在小学时学到的那样。

然后将这些步骤变成代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T21:10:18.240

我对作业的解释是老师希望学生实现一个递归算法来执行[网格方法乘法](http://en.wikipedia.org/wiki/Grid_method_multiplication)（我们在小学学习的那种）。

例如，乘以 34 x 13 可以这样完成......

```
 34
* 13
====
  12
  90
  40
+300
====
 442 
```

我无法轻松访问 Java 开发环境，所以我用 C# 编写了代码，但算法应该足够简单，可以转换成 Java。

```
public int Multiply(int x, int y)
{
    if (x < 0) throw new ArgumentException("must be positive integer", "x");
    if (y < 0) throw new ArgumentException("must be positive integer", "y");

    if (x == 0 || y == 0) return 0; // obvious quick-exit condition

    // integer division
    int xDivBy10 = x / 10;
    int yDivBy10 = y / 10;

    bool xIsSingleDigit = xDivBy10 == 0;
    bool yIsSingleDigit = yDivBy10 == 0;

    // base case
    if (xIsSingleDigit && yIsSingleDigit)
    {
        return MultiplySingleDigits(x, y);
    }

    // otherwise, use grid multiplication recursively
    // http://en.wikipedia.org/wiki/Grid_method_multiplication

    if (xIsSingleDigit) // y must not be a single digit
    {
        return (Multiply(x, yDivBy10) * 10) + Multiply(x, y % 10);
    }

    if (yIsSingleDigit) // x must not be a single digit
    {
        return (Multiply(xDivBy10, y) * 10) + Multiply(x % 10, y);
    }

    // else - x and y are both numbers which are not single digits
    return (Multiply(x, yDivBy10) * 10) + Multiply(x, y % 10); // the same code as the "if (xIsSingleDigit)" case
}

// technically, this algorith can multiply any positive integers
// but I have restricted it to only single digits as per the assignment's requirements/hint
private int MultiplySingleDigits(int x, int y)
{
    if (x < 0 || x > 9) throw new ArgumentException("must be in range 0 - 9 (inclusive)", "x");
    if (y < 0 || y > 9) throw new ArgumentException("must be in range 0 - 9 (inclusive)", "y");

    if (x == 0 || y == 0) return 0; // base case
    return x + MultiplySingleDigits(x, y - 1);
} 
```

**笔记：**

*   这种方法仍然使用`*`运算符，但不用于实际乘以`x`and `y`，它用于将其他子乘积增加 10 的倍数
*   此代码的许多部分可以简化/重构，但我特别将它们扩展以使步骤更明显

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T19:41:28.083

当然你可以做到。

首先，考虑条件。如果某个数字是 0，那么结果是？对……零。

所以..你会有`if x is zero or y is zero return 0`

现在..说 X * Y 就像说*"X, Y times"*，就像写：X + .... + X (Y times)。

所以，你会有类似的东西：

```
x + multiply(x, y - 1); 
```

您必须考虑其中一个数字为负数的情况（但如果您了解基本情况，我相信您可以轻松做到）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T19:39:41.473

很容易就可以了。

```
int multiply(int x, int y) {
    if(y == 0) {
        return 0;
    }
    return x + multiply(x, y - 1);
} 
```

以上没有考虑到 y 为负数的情况，但您不希望我为您完成所有工作。. .

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-18T12:56:27.163

此解决方案适用于 y>=0 和 y<0

```
public int multiply(final int x, final int y) {
    if (y != 0 && x != 0) {
        if (y > 0) {
            return multiply(x, y - 1) + x;
        } else {
            return multiply(x, y + 1) - x;
        }
    }
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-11T07:53:19.173

```
 static int Multiply(int x, int y)
    {
        if (y > 0 && x > 0)
            return (x + Multiply(x, y - 1));
        if (y < 0 && x > 0)
            return -Multiply(x, -y);
        if (x < 0 && y > 0)
            return -Multiply(-x, y);
        if (x < 0 && y < 0)
            return Multiply(-x, -y);

        return 0;
    } 
```

# python - 之后如何加载redis数据库

> ID：16068644
> 
> 赞同：2
> 
> 时间：2013-04-17T19:33:17.090
> 
> 标签：python, redis, persistence, reload

我了解如何使用 bgsave 保存 redis 数据库。但是，一旦我的数据库服务器重新启动，我如何判断是否存在已保存的数据库以及如何将其加载到我的应用程序中。我可以容忍几分钟的数据丢失，所以我不需要担心 AOF，但我不能容忍丢失一个小时的数据。所以每小时做一次 bgsave 对我有用。我只是不知道如何将数据重新加载回数据库。

如果它有所作为，我正在使用 Python。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:26:29.600

您可以停止 redis 并替换 /var/lib/redis 中的 dump.rdb（或 redis.conf 中 dbfilename 变量中的任何文件）。然后重新启动redis。

# javascript - 递归循环包装？

> ID：16068646
> 
> 赞同：1
> 
> 时间：2013-04-17T19:33:20.390
> 
> 标签：javascript, json, d3.js, circle-pack

我有一个 JSON 对象，我希望能够将其可视化为这样的圆圈层次结构[（](http://noomap.com/)您可以使用鼠标单击放大和缩小层次结构）。

我只是想弄清楚如何使用 d3.layout.pack 为下面的 JSON 对象生成层次结构并访问位于 Franchise 下的数据。任何指针将不胜感激。谢谢。

```
{    
    "Consultant": 
    [
        {
            "ConsultantID": 1, 
            "ConsultantName": "Test Consultant", 
            "Account": 
            [
                {
                    "AccountID": 1, 
                    "AccountName": "Test Account", 
                    "Site": 
                    [
                        {
                            "SiteID": 1, 
                            "SiteName": "Test Site", 
                            "Franchise": 
                            [
                                {
                                    "FranchiseID": 1, 
                                    "FranchiseName": "Test Franchise", 
                                    "Data": 
                                    {
                                    // Data goes here
                                    }
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:32:44.610

对于布局，您可以按照您的建议使用内置的[圆形包装布局。](http://bl.ocks.org/mbostock/4063530)

要格式化数据以在此布局中使用它，您可以使用该[`d3.nest()`](https://github.com/mbostock/d3/wiki/Arrays#-nest)函数。如果您想更深入地了解嵌套的工作原理，那么我建议您查看以下问题：[D3 JSON 数据转换](https://stackoverflow.com/q/15912966/1041692)

# macos - 如何在 Mac OS X 10.7 上安装 Scrapy？（lxml 错误）

> ID：16068649
> 
> 赞同：0
> 
> 时间：2013-04-17T19:33:26.157
> 
> 标签：macos, installation, lxml, scrapy

我是一个关于 Python 的新手，我在 Mac OS X 10.7 上安装 Scrapy 时遇到了麻烦。我尝试了很多不同的东西，但总而言之，当我运行时：

```
scrapy startproject tutorial 
```

我有这些错误：

```
ImportError: dlopen(/Library/Python/2.7/site-packages/lxml/etree.so, 2): Symbol not found: ___xmlStructuredErrorContext
  Referenced from: /Library/Python/2.7/site-packages/lxml/etree.so
  Expected in: flat namespace
 in /Library/Python/2.7/site-packages/lxml/etree.so 
```

经过大量谷歌搜索后，我关注[了这篇文章](http://roderickhodgson.com/blog/2012/10/27/building-python-lxml-on-mac-os-x-10-dot-7/)并尝试了：

```
python setup.py build --static-deps --libxml2-version=2.7.8  && pip install lxml 
```

但它告诉我：

```
RuntimeError: ERROR: Trying to build without Cython, but pre-generated 'src/lxml/lxml.etree.c' is not available (pass --without-cython to ignore this error). 
```

如果我使用该`—without-cython`选项运行相同的命令，我会得到：

```
error: command 'llvm-gcc-4.2' failed with exit status 1 
```

（虽然我已经安装了 XCode 命令行工具）

在此先感谢您的帮助 ！

（仅供参考，我正在使用 MacPorts 和 pip install…）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T10:36:52.083

你在最后提到了 Macports 和 pip。我认为您正在混淆包装和安装方法。

使用 macports python 时不应看到第一个导入错误，因为它将其库放在 /opt/ 下

当您开始使用 macports 时，我会使用简单的方法

```
port install py27-scrapy 
```

这将安装所有需要的包（包括 python 和 lxml）来让 scrapyto 工作。

要运行 scrapy，您需要在`/opt/local/bin/python2.7`. 如果 /opt/local/bin 在您的路径上，并且您运行 port select 以选择它作为找到的 python，则可以将其设置为默认 python。scrapy 可执行脚本是`/opt/local/bin/scrapy-2.7`使用版本号，因为您可以同时使用多个版本的 python。

# html - 如何在 Rails ERB 视图的块中转义所有 HTML

> ID：16068651
> 
> 赞同：2
> 
> 时间：2013-04-17T19:33:29.980
> 
> 标签：html, ruby-on-rails, view, escaping, erb

本质上，我想要以下内容：

```
<code class="snippet">
   <%= html_escape do %>
      <a href="#">My markup displayed to user</a>
   <% end %>
</code> 
```

但是 html_escape 方法不接受块。如果这不是在其他地方内置到 Rails API 中，也许使用了一些帮助器，是否有人对如何制作自定义帮助器有建议，其中 yield 语句输出被捕获到一个字符串中，然后我可以自己逃避？

谢谢，

基思

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-12-13T12:08:09.983

Rails`capture`和`escape_once`辅助方法可以`String`从模板中的块创建一个`erb`，然后输出它的转义版本：

```
<% snippet = capture do %>
    <a href="#">My markup displayed to user</a>
<% end %>
<code><%= escape_once snippet %></code> 
```

`content_for`是另一个提供与 类似功能的助手，`capture`您可以根据情况考虑使用它。

解释，`snippet`是一个`ActiveSupport::SafeBuffer`，并且是为什么`escape_once`需要。您可以通过调用`snippet.to_str`而不是来实现相同的目的`escape_once snippet`（但是`.to_s`将不起作用，因为这与`.to_str`in不同`ActiveSupport::SafeBuffer`）。

# java - 将正则表达式转换为 Oracle 数据库正则表达式

> ID：16068652
> 
> 赞同：0
> 
> 时间：2013-04-17T19:33:35.693
> 
> 标签：java, sql, regex, oracle

我正在尝试转换此正则表达式：

```
^.*[^a-z1-9\-].*$ 
```

到要在 oracle 数据库查询中使用的正则表达式。`name`我想要做的是在不同的列中找到包含至少一个字符的所有行`a-z`，`0-9`和`-`。

查询

```
select * from device where regexp_like(ctnmname, '^.*[^a-z1-9\\-].*$') 
```

返回表中的所有行。

**编辑**

问题是带有`0`和转义的正则表达式`-`。它适用于正则表达式`^.*[^a-z0-9-].*$`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:40:47.637

正则表达式本身看起来不错。您可能希望使其区分大小写并包括`0`：

```
SELECT * FROM device WHERE REGEXP_LIKE(mycolumn, '^.*[^a-z0-9-].*$', 'c'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:38:23.800

由于破折号是字符类中的最后一个，因此您无需转义它：

```
where regexp_like(ctnmname, '^.*[^a-z1-9-].*$') 
```

然而

```
where regexp_instr(ctnmname, '[^a-z1-9-]') > 0 
```

可能更容易阅读...

另请参阅[SQL 小提琴](http://sqlfiddle.com/#!4/2c33a/2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T19:54:54.410

```
where not regexp_like(ctnmname, '^(\w|-)*$') 
```

[小提琴](http://www.sqlfiddle.com/#!4/c522e/7)

# c - 如何获取 linux 内核服务中断所花费的时间

> ID：16068656
> 
> 赞同：4
> 
> 时间：2013-04-17T19:33:40.827
> 
> 标签：c, linux, performance, linux-kernel, irq

我想跟踪一段代码中的抖动，我知道有很多潜在的来源（任务切换、系统调用、缓存未命中、将任务移动到另一个 CPU、cpu 节流等），我知道如何跟踪所有这些但唯一我不知道如何跟踪的是内核花费在服务中断上的时间。数据在 /proc/stat 中，但它以低分辨率测量 soft-irq 和 irq 中的时间，我正在寻找分辨率更高的东西。

有没有办法让内核服务中断所花费的时间降低到纳秒或至少微秒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:38:20.597

是的，在屏幕上调用`handle_IRQ`计时器之前和之后放一个 printk 通常是高分辨率的：

```
 86 /*
 87  * asm_do_IRQ is the interface to be used from assembly code.
 88  */
 89 asmlinkage void __exception_irq_entry
 90 asm_do_IRQ(unsigned int irq, struct pt_regs *regs)
 91 {
 92         handle_IRQ(irq, regs);
 93 }
 94 
```

如果你问到`irq_latency`这些很好的答案：

[操作系统导致的 irq 延迟是多少？](https://stackoverflow.com/questions/14698229/what-is-the-irq-latency-due-to-the-operating-system)

# java - 不可翻译的资源只能在 base values/ 文件夹中定义 - Android Export APK

> ID：16068658
> 
> 赞同：6
> 
> 时间：2013-04-17T19:33:46.650
> 
> 标签：java, android, android-resources

当我尝试将我的 Android 项目导出到 APK 时出现以下错误：不可翻译的资源应仅在基本值/文件夹中定义。这是它遇到问题的代码：

```
<string-array name="about_translators" translatable="false"> 
```

这发生在 res 目录的 values 文件夹中的 array.xml 文件中。它遇到问题的代码是：

```
translatable="false" 
```

我该如何解决这个问题？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-06-24T18:41:04.760

我自己发现了这个问题，我`translatable="false"`在`values-es/strings.xml`. 您必须删除它们并仅将它们保留在`values/strings.xml`

# java - Java Robot类keyPress没有输入谷歌浏览器

> ID：16068659
> 
> 赞同：0
> 
> 时间：2013-04-17T19:33:51.160
> 
> 标签：java, keypress, awtrobot

我正在尝试通过使用java机器人类为我输入字母来击败游戏'fastTyper 2'（基本上只是一个打字游戏，您可以在其中输入尽可能快的单词）。我已成功接收要输入的字母。但是，由于游戏具有某种保护，机器人的 keyPress 方法似乎无法正常工作。有谁知道解决这个问题的方法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-24T07:02:34.623

我认为游戏保护不会阻止您，因为游戏（或任何其他程序）无法决定是手动按下还是以编程方式按下键。也许您需要检查您需要机器人类在什么时间点按下键以及按下哪个键的逻辑（并确保将正确的参数值传递给 keyPress 方法）

# asp.net - MVC Web .Net：在到达控制器之前拦截所有调用？

> ID：16068661
> 
> 赞同：7
> 
> 时间：2013-04-17T19:33:52.240
> 
> 标签：asp.net, .net

我有一个 .Net MVC Web 应用程序（不是 WebAPI），我想在到达控制器之前拦截对 Web 应用程序的所有调用，检查请求标头中的值，如果该值不存在，则执行某些操作（例如呈现 404）。这样做的理想方法是什么？请记住，这不是一个 Web API 应用程序，只是一个简单的 Web 应用程序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T19:37:27.913

根据您具体想要做什么，您可以使用所有其他控制器扩展的默认控制器。这样你就可以覆盖`OnActionExecuting`或`Initialize`在那里进行检查。

```
public class ApplicationController : Controller
{
    protected override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        //do your stuff here
    }
}

public class YourController : ApplicationController
{

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T19:37:05.280

您正在寻找全局操作过滤器。

创建一个继承`ActionFilterAttribute`，覆盖`OnActionExecuting()`以执行处理的类，并将实例添加到 Global.asax.cs 中的全局过滤器集合（内部`RegisterGlobalFilters()`）

# mysql - where-clause 中的计算列 - 性能

> ID：16068662
> 
> 赞同：42
> 
> 时间：2013-04-17T19:33:58.523
> 
> 标签：mysql, performance

由于您不能在 MySQL 的 where 子句中使用计算列，如下所示：

```
SELECT a,b,c,(a*b+c) AS d FROM table
WHERE d > n
ORDER by d 
```

你必须使用

```
SELECT a,b,c,(a*b+c) AS d FROM table
WHERE (a*b+c) > n
ORDER by d 
```

计算（在那个例子中“（a * b + c）”每行执行一次还是两次？有没有办法让它更快？我觉得很奇怪可以在列上排序但没有WHERE-条款。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2013-04-17T19:37:59.167

您可以使用 HAVING 过滤计算列：

```
SELECT a,b,c,(a*b+c) AS d, n FROM table
HAVING d > n
ORDER by d 
```

请注意，您需要`n`在 SELECT 子句中包含此功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-17T19:40:35.750

你可以这样做：

```
SELECT a,b,c,d FROM 
(SELECT a,b,c,(a*b+c) AS d) AS tmp
WHERE d > n
ORDER BY d 
```

但我不确定它可能对性能产生什么影响。

# image-processing - （方案）如何计算一个像素的能量？（缝雕）

> ID：16068663
> 
> 赞同：0
> 
> 时间：2013-04-17T19:34:00.243
> 
> 标签：image-processing, scheme, pixel, file-access, seam-carving

*更新：*没关系！我想到了。我必须使用`image-ref`. 不过感谢您的帮助！[^(（在2013-04-17)][^([的评论](https://stackoverflow.com/questions/16068663/scheme-how-to-calculate-energy-of-a-pixel-seam-carving#comment22936767_16068663))][^(中说OP ）。)]

* * *

因此，我必须使用以下方法创建一个函数来查找像素的能量：

> 给定一张图像，我们首先计算每个像素的“能量”，它衡量该像素从周围环境中突出的程度，并让我们大致了解其重要性。
> 
> 要计算由像素 A 到 I 包围的像素 E 的能量，

```
 A B C
    D E F
    G H I 
```

> 使用公式

```
 energy(E) = sqrt(xenergy^2 + yenergy^2) 
```

> 在哪里

```
 xenergy = A + 2D + G - C - 2F - I
    yenergy = A + 2B + C - G - 2H - I 
```

> 每个大写字母代表对应像素的亮度（红、蓝、绿值之和）。
> 
> 要计算边缘像素的能量，您应该假设图像被 1 像素宽的黑色像素边界包围（亮度为 0）。

现在，我的函数找到一个像素周围像素的位置。我不明白的是如何获取这个像素位置并找到它的亮度。我有一个亮度功能，但它需要颜色而不是像素的位置。如果我只有位置，如何找到像素的颜色？

这是我的代码：

```
(define (brightness c)
 (+ (color-ref c 'red) (color-ref c 'green) (color-ref c 'blue)))

(define (energy img rows cols)
  (let ([a '((add1 rows), (sub1 cols))]
    [b '((add1 rows), (add1 cols))]
    [c '(rows, (sub1 cols))]
    [d '(rows, (add1 cols))]
    [g '((sub1 rows), (sub1 cols))]
    [f '((sub1 rows), (add1 cols))])
  (let ([xenergy (- (+ a (* 2 c) g) (- b (* 2 d) h))]
      [yenergy (- (+ a (* 2 b)) (- d (* 2 h)))])
    (sqrt (+ (xenergy * xenergy) (yenergy * yenergy)))))) 
```

# html - 如何在css和html中设置div的高度

> ID：16068665
> 
> 赞同：50
> 
> 时间：2013-04-17T19:34:15.427
> 
> 标签：html, css

我正在使用 Twitter 引导程序。我在我的html中写道：

```
<div style="height:100px;" class="span12">
asdfashdjkfhaskjdf
</div> 
```

为什么打开该页面时高度不是100px？

* * *

> 对于后代，原始代码是：`<div height="100px">`

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2013-04-17T19:35:27.083

要编写内联样式，请使用：

```
<div style="height: 100px;">
asdfashdjkfhaskjdf
</div> 
```

内联样式是有目的的，但是在大多数情况下不建议这样做。

更“正确”的解决方案是制作一个单独的 CSS 表，将其包含在您的 HTML 文档中，然后使用 ID 或类来引用您的 div。

如果你有文件结构：

```
index.html
>>/css/
>>/css/styles.css 
```

然后在你的 HTML 文件之间`<head>`写`</head>`：

```
<link href="css/styles.css" rel="stylesheet" /> 
```

然后，将您的 div 结构更改为：

```
<div id="someidname" class="someclassname">
    asdfashdjkfhaskjdf
</div> 
```

在 css 中，您可以从 ID 或 CLASS 中引用您的 div。

为此，请编写：

```
.someclassname { height: 100px; } 
```

或者

```
#someidname { height: 100px; } 
```

请注意，如果您同时执行这两种操作，则文件结构更靠后的那个将是实际工作的那个。

例如...如果您有：

```
.someclassname { height: 100px; }

.someclassname { height: 150px; } 
```

那么在这种情况下，高度将为 150px。

**编辑：**

要从您的编辑中回答您的次要问题，可能需要`overflow: hidden;`or `overflow: visible;`。你也可以这样做：

```
<div class="span12">
    <div style="height:100px;">
        asdfashdjkfhaskjdf
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-04-17T19:36:29.213

```
<div style="height: 100px;"> </div> 
```

或者

```
<div id="foo"/> and set the style as #foo { height: 100px; }
<div class="bar"/> and set the style as .bar{ height: 100px;  } 
```

# sql-server - 在 SQL Server 2008 R2 中迁移数据库时保留发布

> ID：16068672
> 
> 赞同：0
> 
> 时间：2013-04-17T19:34:24.677
> 
> 标签：sql-server, sql-server-2008-r2, database-migration, merge-replication, subscriptions

我有一个带有合并复制的大型数据库，需要移动到不同的服务器。有一个发布者，但有近 200 个订阅者，所以我不想手动重新创建它们。

有没有办法让我不必重新创建发布和订阅者。我读[了这个链接](https://stackoverflow.com/questions/10800632/sql-server-2008r2-transactional-replication-move-subscriberdb-push-subscript)，但我不确定这是否是我要找的。

如果您需要更多详细信息，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:24:32.097

希望您能找到原始的“设置订阅者”脚本。并捎带下面的 msdn 文章以“改变”您现有的脚本。

如果没有，您可以手动创建脚本。不理想，但优于通过 GUI 进行的 200 次手动设置。

这是我所建议的链接：（下面的 msdn 链接）。

[http://msdn.microsoft.com/en-us/library/ms147302.aspx](http://msdn.microsoft.com/en-us/library/ms147302.aspx)

```
-- This script uses sqlcmd scripting variables. They are in the form
-- $(MyVariable). For information about how to use scripting variables  
-- on the command line and in SQL Server Management Studio, see the 
-- "Executing Replication Scripts" section in the topic
-- "Programming Replication Using System Stored Procedures". 
```

因此，您可以让 1 个订阅者正常工作，然后您可以命令行调用脚本并传入其他 199 个配置值（服务器名称/数据库名称等）。

我永远不会依赖手动步骤来重现复制。你永远不会“从记忆中”得到相同的结果两次。有太多的选择，恕我直言，还有太多的“胖手指”错误要犯。

编辑：

[http://msdn.microsoft.com/en-us/library/ms152483.aspx](http://msdn.microsoft.com/en-us/library/ms152483.aspx)

也许这会有所帮助。

您正在寻找“有没有办法‘脚本化’发布设置”？（然后是订户）。

如果是这样，您将拥有 pre-sql-cmd 起点。然后 sqlcmd 起来变量。

而且您将知道如何在此过程中获得完美而准确的订阅者。

# python - 用于非稳定函数的 python 日志异常装饰器

> ID：16068673
> 
> 赞同：1
> 
> 时间：2013-04-17T19:34:30.050
> 
> 标签：python, logging, decorator

我想在问题函数中记录异常（可变页面的 html 解析），所以我认为最好的解决方案是使用某种装饰器将异常记录到文件中，包括时间、异常类型、代码中的异常行和函数调用参数，一些像：

```
@exception_catch(log_path='example.log')
def example(x,y):
    raise Exception('123') 
```

解决此类任务的最佳实践是什么，或者可能是好的 Python 库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:11:48.103

您可能希望按照 unutbu 的建议进行操作，因为它更灵活，最终也同样简单。但是，如果您对 的额外细节感到不知所措，`logging`请按照您的要求执行以下操作：

```
def exception_catch(log_path):
    def deco(func):
        @functools.wraps(func)
        def wrapper(*args, **kwargs):
            try:
                return func(*args, **kwargs)
            except Exception as e:
                with open(log_path, 'a') as log:
                    log.write('{} {} {} {} {}\n'.format(datetime.datetime.now(), 
                                                        type(e), e, args, kwargs))
                # This will return None on error, of course
        return wrapper
    return deco 
```

当然，您可以将任何您想要的内容放入 中`format`，包括来自上述任何范围的任何局部变量。您要求的唯一棘手的一点是“代码中的异常行”。[`traceback`](http://docs.python.org/3/library/traceback.html)2.x 与 3.x 的详细信息略有不同（有关您需要了解的大部分内容，请参阅模块），但这里有一个 3.x 示例，可以准确地为您提供所需的内容：

```
except Exception as e:
    filename, line, func, text = traceback.extract_stack(limit=1)[0]
    with open(log_path, 'a') as log:
        log.write('time: {} type: {} line: {} args: {}\n'.format(
            datetime.datetime.now(), 
            type(e),
            line,
            args)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T19:45:19.303

与其传递文件的路径，不如传递一个记录器。这样，装饰器的用户可以决定是否要登录到文件或控制台，或其他任何东西。记录器还将确定记录消息的格式。

您可能还需要一个`exception`参数来定义要捕获的异常类型。（下面，`exception`可以`Exception`采用`Exceptions`.

* * *

```
import logging

def catch_exception(exception=Exception, logger=logging.getLogger(__name__)):
    def deco(func):
        def wrapper(*args, **kwargs):
            try:
                result = func(*args, **kwargs)
            except exception as err:
                logger.exception(err)
            else:
                return result
        return wrapper
    return deco

@catch_exception()
def example(x,y):
    raise Exception('123')

logging.basicConfig(filename='/tmp/error.log', level=logging.DEBUG,
                    datefmt='%Y-%m-%d %H:%M:%S',
                    format='%(asctime)s %(module)s %(levelname)s: %(message)s')

example(1,2) 
```

# qtp - Reg - 在使用设备重放方法时激活应用程序

> ID：16068680
> 
> 赞同：1
> 
> 时间：2013-04-17T19:34:57.123
> 
> 标签：qtp

我需要将击键和字符串传递到具有事件处理程序的编辑框中（一旦在编辑框中输入值，就会启用 Web 按钮。

在上述场景中，我使用设备重播方法。下面是我的代码。问题是无法使用设备重播对象激活我的浏览器。因此发送的密钥被正确地发送到应用程序。

谁能帮我解决这个问题。

```
Set Obj = CreateObject ("Mercury.DeviceReplay")
Systemutil.Run "D:\QTP Training\Example Form\Dynamic_1.html"
Browser("Browser").Page("Page").Sync
For i=1 to 12
Obj.PressKey(09)
Next
Obj.SendString "Lakshman"
Browser("Browser").Page("Page").WebButton("Type and enable me").Click
Browser("Browser").Dialog("Message from webpage").WinButton("OK").Click 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T08:21:37.067

QTP 定义了一个`micTab`用于键入`Tab`密钥的常量。试试这个，而不是`09`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:40:38.937

通过使用 sendkeys 方法，我在某些应用程序不支持某些 QTP 功能的不寻常情况下发现了成功。

尝试`Obj.SendKeys "{9}"`

# html - 跨度中的背景图像不会在跨度标记中没有任何文本时显示

> ID：16068683
> 
> 赞同：8
> 
> 时间：2013-04-17T19:35:11.663
> 
> 标签：html, css

如果我删除内部文本 xxx，下面的跨度将不是背景图像

```
<span style='background-image:url("http://gifsoup.com/web/images/soc4.gif")'  style="height: 30px;">
 xxx
</span> 
```

*但是，它在兼容模式下没有 xxx 也可以工作。*

如何在没有任何内部文本的情况下使其工作？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-17T19:42:01.950

因为跨度默认为没有宽度或高度的内联元素。将 CSS 更改为：

```
span {
    display:inline-block;
    width:30px;
    background-image:url("http://gifsoup.com/web/images/soc4.gif");
    height:30px;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/sP7Rd/)**

通过将显示从 inline 更改为 inline-block，您可以设置 span 的宽度和高度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:46:17.920

span 元素是一个内联元素，因此没有宽度或高度。您必须在元素 css 中指定它应该显示为块或内联块，然后指定图像的宽度和高度。

```
span{
    display: inline-block;
    background-image:url("http://gifsoup.com/web/images/soc4.gif");
    width:30px;
    height:30px;
    border-radius: 5px;
} 
```

[例子](http://jsfiddle.net/fYnX5/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T19:36:20.667

需要加一个宽度，可能需要做`display:inline-block`，否则宽度为0，所以不可见。

# c# - 您可以通过使用它的构造函数来创建嵌套列表的深层副本吗？

> ID：16068688
> 
> 赞同：3
> 
> 时间：2013-04-17T19:35:28.140
> 
> 标签：c#, list, deep-copy

我知道您可以将列表对象作为列表构造函数的参数，以将 1 个列表**复制**到另一个列表。

通过这样做，如果使用的类型是简单的内置类型，您可以创建一个**深层副本（****确切地说是？**）。例如*字符串*类型：

```
List<string> testList = new List<string>();

List<string> testListCopy = new List<string>(testList ); 
```

如果您使用嵌套列表，您可以创建**深层副本吗？**：

```
List<List<string>> testList = new List<List<string>>();

List<List<string>> testListCopy = new List<List<string>>(testList ); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T19:36:51.240

构造`List<T>`函数不会为您执行此操作，但您可以自己执行以下操作：

```
List<List<string>> testList = new List<List<string>>();
List<List<string>> testListCopy = new List<List<string>>(testList.Select(x => x.ToList())); 
```

甚至这个，这是等价的：

```
List<List<string>> testListCopy = testList.Select(x => x.ToList()).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:42:41.803

副本不只是浅的或深的。这是一个带有多个值的刻度，带有“最深”和“最浅”的选项。仅使用列表的复制构造函数会导致位于中间某处的副本；它不是“深拷贝”。

您正在做的是重新创建一个新列表，而不复制对它的引用，但是您正在对该列表中的项目执行浅拷贝。如果该内部列表中的项目本身是列表或其他可变引用类型，则您需要对它们及其所有引用的字段等进行深度复制，一直沿链向下。那将是一个真正的“深度”副本。这样做很重要，在一般情况下也是不可能的。没有真正有效的方法来编写`public static T DeepCopy<T>(T object)`适用于任何类型的实现。（您可以通过尝试利用序列化来接近，但并非所有对象都可以序列化）。

至于 a 的具体情况`List<List<string>>`，您只需要创建一个新的外部列表，以及每个内部列表的新列表。Pswg对这个特定问题给出了一个[很好的答案：](https://stackoverflow.com/a/16068713/1159478)

```
List<List<string>> listCopy = list.Select(x => x.ToList()).ToList(); 
```

# ios - 用于操作 NSMutableArray 的 IOS MVC 模式和数据控制器

> ID：16068690
> 
> 赞同：0
> 
> 时间：2013-04-17T19:35:34.803
> 
> 标签：ios, xcode, model-view-controller, nsmutablearray

我有：
一个名为 Care 的类
，一个名为 masterCareList
masterView 的 NSMutableArray，detailView
careDataController 用于将 Cares 添加到 List 并计算对象的数量。

我想在 MasterView 中计算我的对象，我想在 detailView 中添加一个对象。在这两种情况下，都使用 careDataController（不倒带转场或在视图之间传递数据）和相同的 masterCareList。

如何以最佳（MVC）方式使用相同的 dataController 和相同的 NSMutable 数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:04:03.460

您可以在应用程序的初始设置中创建您的 careDataController，并通过 MasterView 的属性访问 careDataController。这将使您能够独立于视图控制器封装对数据的计数和其他操作。

一个非常高级的示例，您可以在其中创建 MasterView...AppDelegate...

```
//Appdelegate.m file
MasterView *mv = [[MasterView alloc] init];
DataController *careDataController = [[DataController alloc] init];
mc.model = careDataController;  //model is a property within MasterView that you create

[self presentViewController:mv animated:YES completion:nil]; 
```

现在，您基本上可以在 MasterView 中创建 DetailView 并将您创建的模型属性设置为您在上面设置的 MasterViews 模型属性。

```
//some procedure in MasterView.m
DetailView *dv = [[DetailView alloc] init];
dv.model = self.model; //self.model you set above

[self presentViewController:dv animated:YES completion:nil]; 
```

现在一旦在 DetailView 中，您可以将护理对象添加到您最初在应用程序开始时创建的原始 careDataController ...

```
//somewhere in DetailView.m
Care *careObject = [[Care alloc] init];
[self.model addObject:careObject]; 
```

当您在完成添加对象后关闭 DetailView 时，MasterView 中的 careDataController（模型属性）现在将拥有您在 DetailView 中添加的新护理对象。

**编辑：** 我看到你的新评论，从某种意义上说，它本质上是我刚刚在上面写的，我不认为这是不正确的。您可以做的另一件事不是像上面那样传递它，而是让 MasterView 成为 DetailView 的代表。当您添加 Care 对象时，将该对象状态保存在 DetailView 中，并使用您在 DetailView 中定义的协议将其传回。您可能在以下协议中有一个 MasterView 实现的方法...

```
-(void)detailView:(DetailView *)dv didInsert:(Care*)careObject
{
    [self.model addObject:careObject];
} 
```

# sql - 用于不同记录比较的 Sql

> ID：16068696
> 
> 赞同：2
> 
> 时间：2013-04-17T19:36:07.553
> 
> 标签：sql

我正在将一个表与其自身进行比较，试图确定一条记录中的电子邮件是否正在另一条记录中的其他四个列中的任何一个中使用。

为了使这更容易，让我们看一个示例（简化）：

```
Name: Bob
Office Email: bob@aaa.com
Home Email: bob@home.com
Mobile Email: bobster@gmail.com 
```

.

```
Name: Rob
Office Email: rob@bbb.com
Home Email: bob@home.com
Mobile Email: robert@gmail.com 
```

现在我有一个这样的sql语句：

```
select c1.ContactId id1, c1.FullName Name1, 'Office Email 1' EmailType1, c1.EMailAddress1 Email, 
   c2.ContactId id2, c2.FullName Name2, 
   CASE c1.EmailAddress1
    WHEN c2.EMailAddress1 THEN 'Office Email 1'
    WHEN c2.Si_OfficeEmail2nd THEN 'Office Email 2'
    WHEN c2.EMailAddress2 THEN 'Mobile Email'
    WHEN c2.pc_hmemail THEN 'Home Email'
    ELSE '?'
   END EmailType2,
   CASE c1.EmailAddress1
    WHEN c2.EMailAddress1 THEN c2.EMailAddress1
    WHEN c2.Si_OfficeEmail2nd THEN c2.Si_OfficeEmail2nd
    WHEN c2.EMailAddress2 THEN c2.EMailAddress2
    WHEN c2.pc_hmemail THEN c2.pc_hmemail
    ELSE '?'
   END DuplicateEmail
from Contact c1, Contact c2
where (
   LTRIM(RTRIM(c1.EMailAddress1 )) = LTRIM(RTRIM(c2.EMailAddress1))
Or LTRIM(RTRIM(c1.EMailAddress1 )) = LTRIM(RTRIM(c2.EMailAddress2))
Or LTRIM(RTRIM(c1.EMailAddress1 )) = LTRIM(RTRIM(c2.pc_hmemail))
Or LTRIM(RTRIM(c1.EMailAddress1 )) = LTRIM(RTRIM(c2.Si_OfficeEmail2nd))
)
And c1.ContactId <> c2.ContactId
And c1.StateCode = 0 
and c2.StateCode = 0
order by c1.FullName, c2.FullName 
```

不幸的是，由于 Bob 和 Rob 具有相同的电子邮件“类型”（家庭电子邮件），但由于拼写错误而重复，我的查询返回两条记录，一条显示 Bobs 的电子邮件在 Rob 电子邮件中重复，另一条显示 Rob 的电子邮件是在 Bobs 电子邮件中重复。

我只需要一张唱片。我确信这是一个常见问题，但我不太清楚如何描述这个问题，以便让搜索引擎返回一些有用的东西。

也许有更好的方法来解决这个问题？如果没有，除了跳过一堆中间临时表来消除这些等效记录之外，有没有办法为此编写单个查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:43:48.890

您的问题的解决方案是添加条件： `c1.contactId < c2.ContactId`。这限制了您正在查看的对。

如果您正在查看电子邮件，您可能会找到一种更快的方法来直接查看电子邮件。类似以下内容将返回所有重复的电子邮件（在单独的行上）：

```
select e.*
from (select e.*, COUNT(*) over (partition by email) as NumTimes
      from ((select contactId, 'Office' as which, EmailAddress1 as email
             from Contact
            ) union all
            (select contactId, 'Office2', Si_OfficeEmail2nd
             from Contact
            ) union all
            (select contact_id, 'Home', pc_hmemail
             from Contact
            ) union all
            (select contact_id, 'Mobile', EmailAddress2
             from Contact
            )
           ) e
      where email is not null and email <> ''
     ) e
where NumTimes > 1
order by email 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:45:28.853

我首先建议继续规范您的数据结构。一个人可能有几种类型的联系信息。因此，personID、typeID 和 value 可以放在另一个表中。从这个表中，您可以创建另一个与类型表的关系，您可以在其中跟踪不同的联系人类型（例如家庭电子邮件、工作电子邮件、Twitter、linkedIn、Facebook 等）。它不仅可以提高系统的可扩展性，还可以更有效地运行这些类型的查询。

`SELECT user.username FROM user u LEFT JOIN contactinfo ci ON u.user_id=ci.user_id LEFT JOIN contacttype ct ON ci.type_id=ct.type_id GROUP BY ci.value HAVING count(value)>1`将是查找任何重复源的查询

# database - VB.NET 数据类型不匹配，数据输入过长

> ID：16068698
> 
> 赞同：0
> 
> 时间：2013-04-17T19:36:15.433
> 
> 标签：database, vb.net, ms-access, visual-studio-2012, oledb

我已经为此工作了好几天，任何帮助都会很棒。我正在尝试使用 VB.NET 和访问数据库将信息插入数据库。目前我有2个问题。第一个问题是我的数据库中有一个备注字段（响应），如果我尝试在该字段中插入超过 250 个字符，我会收到一个错误，提示我的条目太长。我遇到的另一个问题是，如果我在运行程序时尝试多次执行此代码，我会收到一条错误消息，提示“标准表达式中的数据类型不匹配......”。最后一个问题是我遇到的数据类型不匹配的问题。

这是有问题的代码

```
 con = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=..\..\Backends\IncidentReport.mdb")
    con.Open()
    comStr = "INSERT INTO tblIncidentCommonItemsInfo(recid, Location, DescOrTypeInjIfOther, DateOf, TimeOf, TypeIncident, Doctor, " &
            "DateDocNotified, TimeDocNotified, DateRespPartyNotified, RespPartyNotified, " &
            " TimeRespPartyNotified, StateNotified, DateStateNotified, TimeStateNotified, Response) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)" 

        cmd = New OleDbCommand(comStr, con)

        cmd.Parameters.AddWithValue("@p1", IDLabel.Text)
        cmd.Parameters.AddWithValue("@p2", LocTextBox.Text)
        cmd.Parameters.AddWithValue("@p3", DescTextBox.Text)
        cmd.Parameters.AddWithValue("@p4", DateOfTextBox.Text)
        cmd.Parameters.AddWithValue("@p5", TimeOfTextBox.Text)
        cmd.Parameters.AddWithValue("@p6", TypeTextBox.Text)
        cmd.Parameters.AddWithValue("@p7", DocComboBox.SelectedItem)
        cmd.Parameters.AddWithValue("@p8", DocDayDateTimePicker.Value)
        cmd.Parameters.AddWithValue("@p9", DocTimeDateTimePicker.Value)
        cmd.Parameters.AddWithValue("@p10", FamilyDayDateTimePicker.Value)
        cmd.Parameters.AddWithValue("@p11", RespPtyTextBox.Text)
        cmd.Parameters.AddWithValue("@p12", FamilyTimeDateTimePicker.Value)
        cmd.Parameters.AddWithValue("@p13", IDPHYesNoComboBox.SelectedItem)
        cmd.Parameters.AddWithValue("@p14", IDPHDayDateTimePicker.Value)
        cmd.Parameters.AddWithValue("@p15", IDPHTimeDateTimePicker.Value)
        cmd.Parameters.AddWithValue("@p16", ResidentWordsRichTextBox.Text)

        Try
            cmd.ExecuteNonQuery()
            MsgBox("Incident Saved")
        Catch ex As Exception
            MessageBox.Show(ex.Message & " - " & ex.Source)
        End Try
        SavedTextBox.Text = "Yes"
        con.Close() 
```

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:46:51.367

对于大小问题，您可以尝试准确指定您通过参数传递的值类型。我怀疑使用 AddWithValue 会使用更短的参数大小

```
cmd.Parameters.Add("@p16", OleDbType.LongVarWChar).Value = ResidentWordsRichTextBox.Text) 
```

该`Data type mismatch in criteria expression`错误可能是由相同的问题引起的。
AddWithValue 方法根据您传递的值的类型确定 Parameter DataType。

在您的代码中，您已经为看起来不同类型的字段传递了文本。例如`recid`似乎是一个整数（数字）字段，但 AddWithValue 使用一个 textbox.text 是一个字符串。您确实应该应用 a`Convert.ToInt32(IDLabel.Text)`并且应该对可能的 DateTime 字段进行相同的检查

# python - Python：比较几千个字符串。有什么快速的比较方法吗？

> ID：16068703
> 
> 赞同：2
> 
> 时间：2013-04-17T19:36:28.547
> 
> 标签：python, string, performance, comparison, string-comparison

我有一组大约**6 000 个数据包**，出于比较目的，我将其表示为 **字符串**（前 28 个字节），以与同样多的数据包进行比较，我也将其表示为 28 个字节的字符串。

我必须将一组中的每个数据包与其他所有数据包匹配。**匹配**总是**唯一的**。

我发现比较字符串需要一些时间。有什么方法可以**加快**这个过程吗？

EDIT1：我不想置换字符串元素，因为我总是确保数据包列表和相应字符串列表之间的**顺序****被保留**。

EDIT2：这是我的实现：

```
list1, list2 # list of packets (no duplicates present in each list!)
listOfStrings1, listOfStrings2 # corresponding list of strings. Ordering is preserved.
alreadyMatchedlist2Indices = []
for list1Index in xrange(len(listOfStrings1)):
            stringToMatch = listOfStrings1[list1Index]
            matchinglist2Indices = [i for i, list2Str in enumerate(listOfStrings2)
                                if list2Str == stringToMatch and i not in alreadyMatchedlist2Indices]
            if not matchinglist2Indices:
                tmpUnmatched.append(list1Index)
            elif len(matchinglist2Indices) == 1:
                tmpMatched.append([list1Index, matchinglist2Indices[0]])
                alreadyMatchedlist2Indices.append(matchinglist2Indices[0])
            else:
                list2Index = matchinglist2Indices[0] #taking first matching element anyway
                tmpMatched.append([list1Index, list2Index])
                alreadyMatchedlist2Indices.append(list2Index) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T19:41:32.200

---在这里，我假设您正在逐个提取每个字符串并与其他所有字符串进行比较。---

我建议对您的字符串列表进行排序并比较相邻的字符串。这应该具有 O(nlogn) 的运行时间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-17T19:46:01.043

这是一个简单的线性时间方法——至少如果我正确理解你的问题：

```
>>> def get_matches(a, b):
...     reverse_map = {x:i for i, x in enumerate(b)}
...     return [(i, reverse_map[x]) for i, x in enumerate(a) if x in reverse_map]
... 
>>> get_matches(['a', 'b', 'c'], ['c', 'd', 'e'])
[(2, 0)] 
```

这接受两个字符串序列，`a`and `b`，并返回一个匹配列表，表示为`a`and的索引元组`b`。`a`这是 O(n + m)，其中 m 和 n 是和的长度`b`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:53:28.340

有什么问题：

```
matches = [packet for packet in list1 if packet in list2] 
```

# java - 从键盘输入一个字符串并检查有多少元音可用并提取字符串的中间字符

> ID：16068707
> 
> 赞同：0
> 
> 时间：2013-04-17T19:36:35.310
> 
> 标签：java, loops, methods, drjava

如果给定字符是元音，则赋值要求方法返回值 true，否则返回 false。然后通过向用户询问字符串来测试该方法，并检查用户输入的字符串的每个字符，如果元音则返回 true，否则返回 false。到目前为止，我已经创建了该方法，并创建了一个循环来读取字符串，但不幸的是，它只检查用户最初输入的字符，而不是字符串的字符。

```
import java.util.*;

public class Vowels{

public static void main(String[] args){

Scanner keyboard = new Scanner(System.in);

System.out.print("Enter a character: ");
char ch = keyboard.next().charAt(0);

boolean result = isVowel(ch);
System.out.println(result);

System.out.println("Please enter a String: ");
String str = keyboard.next();

boolean answer = isVowel(ch);
for(int i = 0; i <= str.length(); i++){
  if(str.charAt(i) == ch){
    answer = true;
    System.out.println(answer);
  }
  else{
    answer = false;
    System.out.println(answer);
  }
 }
}

public static boolean isVowel(char ch){
boolean answer;
if (ch == 'a' || ch == 'e' || ch == 'i' || ch == 'o' || ch == 'u'){
  answer = true;
  return answer;
}
else{
  answer = false;
  return answer;
  }
 }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:39:22.073

改变

```
 if(str.charAt(i) == ch){ 
```

到

```
 if (isVowel(str.charAt(i)){ 
```

检查每个字符是否为元音，而不是检查每个字符是否匹配您输入的第一个字符。

# c# - c# 无法连接到与读取首选项Primary匹配的副本集成员

> ID：16068710
> 
> 赞同：1
> 
> 时间：2013-04-17T19:36:40.707
> 
> 标签：c#, mongodb, driver

好的，我在 linux 服务器上设置了两个带有副本集的节点。

在使用 1.8.1.20 驱动程序的 c# 应用程序中，我有

```
client = new MongoClient("mongodb://54.244.162.21,54.234.244.182/rs0?connect=replicaset;replicaSet=rs0;slaveOk=true;readPreference=primaryPreferred"); 
```

- 当我将 mongo 连接到每个节点时，主节点和从节点的更新和查找语句都可以正常工作。

-当我尝试关闭任何主节点或辅助节点时，我得到：无法连接到与读取首选项主节点匹配的副本集的成员

- 当两个节点都启动时，我没有收到任何错误，一切正常。

- 我试图将 readPreference 更改为每个可能的值，因为我想看看冗余是如何工作的。

我是不是搞错了什么。我假设您应该能够连接到任何一个，并且至少可以读取工作。以下代码是我在首次建立连接时明显发生异常的代码。

```
 server = client.GetServer();

        foreach (string db in server.GetDatabaseNames())
        {
            Debug.WriteLine(db);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T15:51:15.750

问题是某些数据库命令只能在主数据库上运行。如果您在连接到没有主副本的副本集时发出一个，那么您会收到此错误。

在这种情况下，命令是 server.GetDatabaseNames() - 可能是疏忽，它无法在辅助服务器上运行此命令，但目前情况确实如此。

我将与维护 MongoDB 驱动程序的人员核实，看看是否应该在辅助设备上允许此命令。

对于您的示例，我认为您会发现如果您的程序连接然后发出读取查询，那么它会正常工作。

# c# - 更新字典 C#

> ID：16068712
> 
> 赞同：-1
> 
> 时间：2013-04-17T19:36:47.457
> 
> 标签：c#, asp.net-mvc-4

我在更新字典时遇到问题

我也读过很多关于这个说法的话题（例如[Link](https://stackoverflow.com/questions/1177517/is-there-a-more-elegant-way-of-adding-an-item-to-a-dictionary-safely)）

```
ExampleDict[key] = value; 
```

我正在尝试对自己的代码进行此操作：

模型：

```
 public Dictionary<int, string> Info { get; set; }
  public Dictionary<int, string> GetInfo(int id)
    {
        Info = new Dictionary<int, string>();

        var game = db.Games.Find(id);

        var playerOne = db.Players.Find(game.PlayerOneId);
        var playerTwo = db.Players.Find(game.PlayerTwoId);
        var PlayerOneName = playerOne.Nickname;
        var PlayerTwoName = playerTwo.Nickname;
        int scoreOne = CountScorePlayerOne();
        int scoreTwo = CountScorePlayerTwo();

        // old aproach:
        Info.Add(scoreOne, PlayerOneName);
        Info.Add(scoreTwo, PlayerTwoName);

        //new approach
        Info[key] = scoreOne;

        return Info;

    } 
```

错误

> 当前上下文中不存在名称“键”

注意：我是一名学生，这是一个学校项目。

关于我做错了什么的任何想法？

**通过 Jon Senchyna 的代码示例解决，谢谢！**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T19:37:51.323

看来您从未声明变量`key`。您可能不是要在“新方法”行中使用“键”。

另外，我认为您的`Dictionary`做法是倒退的，因为看起来球员的名字应该是关键，而不是他们的分数。您当前声明它的方式（`Dictionary<int, string>`），您正在创建一个字典，其键是`int`（分数？），值是`string`（名称？）。

以下是我建议的编辑：

```
// Corrected dictionary definitions
public Dictionary<string, int> Info { get; set; }
public Dictionary<string, int> GetInfo(int id)
{
    // You may want to use a local variable here instead
    Info = new Dictionary<string, int>();

    ...

    Info[PlayerOneName] = scoreOne;
    Info[PlayerTwoName] = scoreTwo;

    return Info;
} 
```

以下是一些有用的链接，可用于了解有关使用 Dictionary 类的更多信息（如果您浏览一下，通常是 C#）：

*   [MSDN](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)
*   [点网珍珠](http://www.dotnetperls.com/dictionary)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:39:18.220

在您问题的示例链接中，有方法：

```
public static void SafeDictionaryAdd(Dictionary<string, object> dict, string key, object view) 
```

其中有一个`string key`作为论点。您还需要定义该键。

# c# - 删除listview滚动条时wpf窗口宽度大小不起作用

> ID：16068714
> 
> 赞同：0
> 
> 时间：2013-04-17T19:36:52.740
> 
> 标签：c#, wpf, xaml, visual-studio-2008, listview

我有一个使用 .NET 框架 3.5 版的 VS 2008 开发的 WPF 项目。初始窗口宽度设置为 680，SizeToContent 仅设置为“宽度”。此窗口的网格面板中放置了 3 个 ListView 控件。前 2 个网格都有一个指定宽度的列。第三个 ListView 控件没有指定任何列的宽度。当 ListView 控件最初填充数据时，窗口会正确调整大小。如果附加数据进入第三个 ListView，则窗口会相应地缩小或扩大宽度。但是，如果第一个或第二个 ListView 容器增长或缩小 - 特别是如果通过垂直增加窗口大小来移除滚动条，则窗口的宽度不会正确更新。

这是我的窗口和 ListView 控件的 XAML 代码：

```
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AP2"
        x:Class="AP2.MainWindow"
        x:Name="LobbyWindow"
        Title="Lobby"
        Height="480"
        mc:Ignorable="d"
        SizeToContent="Width"
        MinWidth="680"
        MinHeight="480"
        SizeChanged="LobbyWindow_SizeChanged"
        Loaded="LobbyWindow_Loaded"
        Closing="LobbyWindow_Closing"
        StateChanged="LobbyWindow_StateChanged">
  <Window.Background>
    <LinearGradientBrush EndPoint="0.5,1"
                         StartPoint="0.5,0">
      <GradientStop Color="#FF434D7A"
                    Offset="0" />
      <GradientStop Color="#FF180CFA"
                    Offset="1" />
    </LinearGradientBrush>
  </Window.Background>

  ...

  <Grid>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="*" />
      <ColumnDefinition Width="*" />
      <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition Height="0.064*" />
      <RowDefinition Height="0.936*" />
    </Grid.RowDefinitions>

    <!-- Define the selected table label. -->
    <Label x:Name="SelTableLabel"
           Margin="1,-5,0,0"
           Content="Table"
           FontSize="11"
           Foreground="#FF000000"
           Background="#FFFFFFFF"
           Grid.Row="0"
           Grid.Column="2"
           FontFamily="Georgia"
           FontWeight="Bold"
           VerticalAlignment="Bottom" />

    <ListView x:Name="ListView1"
              ItemContainerStyle="{StaticResource alternatingListViewItemStyle}"
              AlternationCount="2"
              SelectionChanged="ListView1_SelectionChanged"
              Grid.Row="1"
              Grid.Column="0"
              SelectionMode="Multiple"
              ItemsSource="{Binding ElementName=LobbyWindow, Path=ListCollection1}">
      <ListView.View>
        <GridView>
          <GridViewColumn DisplayMemberBinding="{Binding Game}">
            <GridViewColumnHeader Content="Game"
                                  FontWeight="Bold" />
          </GridViewColumn>
          <GridViewColumn DisplayMemberBinding="{Binding Stakes}">
            <GridViewColumnHeader Content="Stakes"
                                  FontWeight="Bold" />
          </GridViewColumn>
          <GridViewColumn Width="30"
                          DisplayMemberBinding="{Binding Seats}">
            <GridViewColumnHeader Content="Seats"
                                  FontWeight="Bold" />
          </GridViewColumn>
        </GridView>
      </ListView.View>
    </ListView>

    <ListView x:Name="ListView2"
              ItemContainerStyle="{StaticResource alternatingListViewItemStyle}"
              AlternationCount="2"
              Grid.Row="1"
              Grid.Column="1"
              SelectionChanged="ListView2_SelectionChanged"
              SelectionMode="Single"
              ItemsSource="{Binding ElementName=LobbyWindow, Path=ListCollection2}">
      <ListView.View>
        <GridView>
          <GridViewColumn Width="90"
                          x:Name="TableName"
                          DisplayMemberBinding="{Binding TableName}">
            <GridViewColumnHeader Content="Table"
                                  Width="90"
                                  FontWeight="Bold"
                                  HorizontalAlignment="Left" />
          </GridViewColumn>
          <GridViewColumn DisplayMemberBinding="{Binding Stakes}">
            <GridViewColumnHeader Content="Stakes"
                                  FontWeight="Bold" />
          </GridViewColumn>
          <GridViewColumn DisplayMemberBinding="{Binding NumPlayers}">
            <GridViewColumnHeader Content="Players"
                                  FontWeight="Bold" />
          </GridViewColumn>
          <GridViewColumn DisplayMemberBinding="{Binding Speed}">
            <GridViewColumnHeader Content="Speed"
                                  FontWeight="Bold" />
          </GridViewColumn>
          <GridViewColumn DisplayMemberBinding="{Binding HandsPerHour}">
            <GridViewColumnHeader Content="H/Hr"
                                  FontWeight="Bold" />
          </GridViewColumn>
          <GridViewColumn DisplayMemberBinding="{Binding AvgPotSize}">
            <GridViewColumnHeader Content="Avg Pot"
                                  FontWeight="Bold" />
          </GridViewColumn>
        </GridView>
      </ListView.View>
    </ListView>

    <ListView x:Name="ListView3"
              ItemContainerStyle="{StaticResource alternatingListViewItemStyle}"
              AlternationCount="2"
              Grid.Row="1"
              Grid.Column="2"
              SelectionMode="Single"
              ItemsSource="{Binding ElementName=LobbyWindow, Path=ListCollection3}">
      <ListView.View>
        <GridView>
          <GridViewColumn DisplayMemberBinding="{Binding Player}">
            <GridViewColumnHeader Content="Player"
                                  FontWeight="Bold" />
          </GridViewColumn>
          <GridViewColumn DisplayMemberBinding="{Binding City}">
            <GridViewColumnHeader Content="City"
                                  FontWeight="Bold" />
          </GridViewColumn>
          <GridViewColumn DisplayMemberBinding="{Binding Chips}">
            <GridViewColumnHeader Content="Chips"
                                  FontWeight="Bold" />
          </GridViewColumn>
        </GridView>
      </ListView.View>
    </ListView>
  </Grid> 
```

# cordova - 如何为 Blackberry 项目更新到 phonegap 2.6.0？

> ID：16068716
> 
> 赞同：0
> 
> 时间：2013-04-17T19:36:59.403
> 
> 标签：cordova, blackberry, phonegap-build

我正在尝试在 phonegap 上将 Blackberry 项目更新到 2.6.0，但没有关于如何做到这一点的教程。

指南仅上升到 2.0.0

[http://docs.phonegap.com/en/2.6.0/guide_upgrading_blackberry_index.md.html#Upgrading%20Cordova%20BlackBerry](http://docs.phonegap.com/en/2.6.0/guide_upgrading_blackberry_index.md.html#Upgrading%20Cordova%20BlackBerry)

有谁知道要遵循哪些步骤？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T21:05:48.923

我也在尝试更新我的黑莓项目，但也找不到任何当前的更新信息。

我在Phonegap 的网站上留下了一个请求，也许有人会在那里回复。这是我在[PhoneGap 博客上发帖的链接](http://phonegap.com/blog/2013/04/30/pg-270-released/)

抢

# ruby-on-rails - 在 Rails 3 应用程序中安全地存储 API 密钥

> ID：16068717
> 
> 赞同：0
> 
> 时间：2013-04-17T19:37:00.943
> 
> 标签：ruby-on-rails, api-key

您将如何在 Rails 应用程序中存储用户的 API 密钥？请注意，我说的是作为资源提供者，即 API 密钥用于我的服务。

假设我们有一些资源，我们有 1000 个 API 密钥，允许用户访问该资源。

天真的方法是以明文形式存储它，但如果数据库遭到破坏 - 所有 API 密钥都消失了。

聪明的方法是存储散列和加盐，但这意味着我必须这样做：

```
ApiKeys.where(resource: '....').each do { |key| key.password == params[:api_key] } 
```

这非常耗时（1000 次散列比较）。

我无法进行搜索，因为哈希是加盐的。

谷歌对这个问题有点沉默。

关于如何更有效地实施它的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:18:36.813

这在很大程度上取决于您的应用程序要求。您是否会在生成 API 密钥后向用户展示其 API 密钥？如果是这样，您需要将其存储为纯文本或某种可逆加密。

如果您对 API 密钥进行散列和加盐处理，则可以简化查询：

```
ApiKeys.where(resource: '....', password: hash_and_salt(params[:api_key])) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-02T18:57:06.820

也许您可以将 api 密钥的前几个字符存储为纯文本，并将其与加密（加盐）的完整 api 密钥一起存储在数据库中。

# c# - C#中子字符串的运行时间是多少？

> ID：16068720
> 
> 赞同：0
> 
> 时间：2013-04-17T19:37:09.100
> 
> 标签：c#, .net, string, substring

所以我试图解析通过 RS-232 串行端口读取的字符串，而 Substring 函数是罪魁祸首。它是 O(N) 运行时间吗？有没有更快的方法将字符串切成碎片然后我可以解析？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:43:28.757

上次我在没有完整引用的情况下引用这个时，我的手腕被打了一巴掌，所以这次我会正确地做：

> 程序员浪费大量时间来思考或担心程序中非关键部分的速度，而在考虑调试和维护时，这些提高效率的尝试实际上会产生强烈的负面影响。我们应该忘记小的效率，比如大约 97% 的时间：**过早优化是万恶之源**。然而，我们不应该放弃那关键的 3% 的机会

正如 Matthew Watson 指出的那样，我非常怀疑`Substring`您需要担心的是什么。

现在，在您看来，这似乎是一个居高临下的答案，但如果程序员一直在用“必须快速”进行编码；那么在我看来，他们的大脑并没有专注于他们应该做的事情，即编写解决特定问题的功能代码。

编写明显*足够快的*代码，然后正如引用所说的那样 - 如果性能确实存在问题（例如，您的发票运行需要 5 个小时来处理 20 个 pdf），那么您可能需要开始查看正在采取的措施时间。

# c# - 我应该注入 ServiceStack 的 ICacheManager 吗？

> ID：16068722
> 
> 赞同：4
> 
> 时间：2013-04-17T19:37:13.750
> 
> 标签：c#, servicestack, autofac

我希望在我们的应用程序中实现一个缓存层，但不小心遇到了 ServiceStack 的 ICacheManager。

`ICacheManager.Resolve`看起来这正是我所追求的（尝试并获取，如果它不在缓存中，则调用该函数来获取并存储它）。然而，我能找到的所有文档都是关于使用 ICacheClient 的。

如何使用 AutoFac 连接 ICacheManager？我假设我需要连接一个客户端，例如：

```
_builder.Register(c => new MemoryCacheClient())
        .As<ICacheClient>(); 
```

但是我不确定 ICacheManager 应该解决什么问题。

这是个好主意还是我在滥用 ServiceStack？

我暂时添加了一个自定义缓存管理器，但由于某种原因感觉不对：

```
public class CacheManager : ICacheManager
{
    public CacheManager(ICacheClient cacheClient)
    {
        CacheClient = cacheClient;
    }

    public void Clear(IEnumerable<string> cacheKeys)
    {
        Clear(cacheKeys.ToArray());
    }

    public void Clear(params string[] cacheKeys)
    {
        CacheClient.ClearCaches(cacheKeys.ToArray());
    }

    public ICacheClient CacheClient { get; private set; }

    public T Resolve<T>(string cacheKey, Func<T> createCacheFn) where T : class
    {
        return Resolve(cacheKey, new TimeSpan(0, 15, 0), createCacheFn);
    }

    public T Resolve<T>(string cacheKey, TimeSpan expireIn, Func<T> createCacheFn) where T : class
    {
        var cacheResult = CacheClient.Get<T>(cacheKey);
        if (cacheResult != null)
            return cacheResult;

        var item = createCacheFn();
        CacheClient.Set(cacheKey, item, expireIn);
        return item;
    }
} 
```

# java - 我使用扫描读取的 java 程序不会停止执行

> ID：16068724
> 
> 赞同：0
> 
> 时间：2013-04-17T19:37:27.240
> 
> 标签：java

我是 Java 世界的新手。我写了这个读取字符串数组的程序......当我运行它时，它永远不会停止？！我应该添加/更改什么以使其结束扫描？

```
import java.util.*;

public class Ex21 {
public static void main(String[] args) {
    int i, n = 5;
    String c;
    ArrayList<String>words = new ArrayList<>();
    System.out.println("Enter multi strings: ");
    Scanner input = new Scanner(System.in);
    boolean loop = true;
    while(loop) {
        words.add(input.next());
        Collections.sort(words);
        System.out.println("The sorted list is: " + words);
    }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:40:41.533

根据`while`定义，循环继续执行其主体，直到其条件（在本例中为变量`loop`）评估为`false`。您永远不会在 -loop 的主体中设置`loop`为，因此条件永远不会评估为并且循环永远不会结束。`false``while``false`

此外，您似乎想要对用户输入的单词列表进行排序。我不建议调用`Collections.sort`循环的每次迭代。也许考虑使用一种数据结构来保持其元素自行排序，例如[`TreeSet`](http://docs.oracle.com/javase/7/docs/api/java/util/TreeSet.html). 或者，至少，只`sort`在循环之后直接调用该方法一次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T19:41:09.107

```
while(condition) {
     /* do something */
} 
```

表示 /* 做某事 */ 发生，除非条件 == false，在你的情况下它总是为真，这就是它不会停止的原因。因此，Java 在您的情况下表现良好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:05:20.120

`while(loop)`在你的程序中`loop`总是有值`true`是所谓`endless loop`的，顾名思义，它永远不会结束，这就是你正在经历的。

要使循环停止，您必须将 的值设置`loop`为`false`是否满足某些条件或使用关键字终止循环`break`。

一个条件可能是例如有一个特定的词女巫让你的循环在输入时终止，比如`"exit"`

这是一个示例，您可以如何设置`loop`为`false`

```
String word = input.next();
boolean loop = ! "exit".equalsIgnoreCase(word);
while (loop) {
    words.add(word);
    Collections.sort(words);
    System.out.println("The sorted list is: " + words);
    word = input.next();
    loop = ! "exit".equalsIgnoreCase(word);
}
System.out.println("Bye!"); 
```

这是另一个示例，您可以如何使用取消循环`break`

```
while (true) {
    String word = input.next();
    if("exit".equalsIgnoreCase(word)) {
        break;
    }
    words.add(word);
    Collections.sort(words);
    System.out.println("The sorted list is: " + words);
}
System.out.println("Bye!"); 
```

请注意，该词`exit`被禁止从您的数组列表可以包含的集合中，但您可以更改程序以将其保存。

# c# - 正则表达式限制字符串中的字符数

> ID：16068728
> 
> 赞同：-2
> 
> 时间：2013-04-17T19:37:34.483
> 
> 标签：c#, .net, regex

这是我的字符串字符串 countCommas = 12,34,56

我正在寻找以下算法的正则表达式

BOOL isCountExaclty2 = if(字符串中的逗号数 == 2){return TRUE;}else return FALSE

我希望右手表达式作为一个单一的 REGEX 表达式，它返回 TRUE 或 FALSE 但不返回计数（我知道使用 Regex.COUNT ..但它以 2 个语句结束）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:42:15.477

尝试这个 ：

```
string countCommas = "12,34,56"
bool isCountExaclty2 = Regex.Split(countCommas, ",").Length == 2; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:53:29.903

如果您正在寻找仅在字符串中恰好有两个逗号时才匹配的模式，这应该有效：

```
 bool isCountExactly2 = Regex.IsMatch("12,34,56", "^([^,]*,){2}[^,]*$"); 
```

但是正则表达式确实不是这项工作的正确工具。

# perl - 比较后打印行号

> ID：16068731
> 
> 赞同：1
> 
> 时间：2013-04-17T19:37:40.053
> 
> 标签：perl, compare

有人能告诉我在 2 个文件中打印不同行数的最佳方法吗？我有 2 个包含 1000 个文件的目录，并且我有一个 perl 脚本，它将 dir1 中的所有文件与 dir2 中的所有文件进行比较，并将差异输出到不同的文件。现在我需要添加类似 Filename - # of different lines File1 - 8 File2 - 30

现在我正在使用

```
my $diff = `diff -y --suppress-common-lines "$DirA/$file" "$DirB/$file"`; 
```

但除此之外，我还需要打印这 1000 个文件中的每一个文件中有多少行不同。

对不起是我上一个帖子的副本。所以如果有版主可以删除前一个会很高兴

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:39:28.687

为什么你甚至使用perl？

```
for i in "$dirA"/*; do file="${i##*/}"; echo "$file - $(diff -y --suppress-common-lines "$i" "$dirB/$file" | wc -l)" ; done > diffs.txt 
```

# debugging - 如何在 Ant 中调试 chown 任务？

> ID：16068732
> 
> 赞同：1
> 
> 时间：2013-04-17T19:37:44.510
> 
> 标签：debugging, shell, ant, build, build-automation

我们有一个带有 chown 任务的 Ant 脚本，如下所示：

```
<chown owner="${user}" verbose="true">
   <fileset dir="${dev-home}" includes="**/**"/>
   <dirset dir="${dev-home}" includes="**/**"/>
</chown> 
```

任务失败了，但只是说它失败了，没有说明原因或给出正在执行的命令。我们如何调试这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:45:46.730

您可以通过以下方式在调试模式下运行 Ant 文件：

```
ant -debug -f yourbuildfile.xml 
```

要调试特定部分，请使用此线程中描述的技术：[Make ant quiet without the -q flag?](https://stackoverflow.com/q/5462732/130683)

还要检查[Ant 的`chown`任务](http://ant.apache.org/manual/Tasks/chown.html)手册，内容如下：

> 如果您正在处理大量文件，这可能会导致命令行对于您的操作系统来说太长。如果遇到此类问题，应`maxparallel`将此任务的属性设置为非零值。要使用的数字很大程度上取决于文件名的长度（目录树的深度）和操作系统，因此您必须进行一些试验。

# hadoop - Hadoop vs DDS vs ACE

> ID：16068734
> 
> 赞同：0
> 
> 时间：2013-04-17T19:37:49.760
> 
> 标签：hadoop, ace, distributed-objects, data-distribution-service

我正在写一份关于 Java 分布式系统库的报告。但我看不出它们之间的区别。ACE、Hadoop、DDS 有什么区别？三者能不能用来开发像简单聊天这样的分布式应用？谢谢！

# php - 针对特定的` ` 通过 Wordpress 插件

> ID：16068741
> 
> 赞同：3
> 
> 时间：2013-04-17T19:38:22.200
> 
> 标签：php, html, wordpress

**将 HTML 输入插入主题模板文件？**

我的问题是这样的：

目前使用我的代码，我可以让我在自定义设置页面中设置的任何内容出现在每个帖子的末尾，当然，使用 WordPress 过滤器。

唯一的事情是，我不希望我输入的内容在帖子中的任何地方出现。我想要实现的是将我的输入注入到当前主题 home.php 模板文件中，`<div></div>`该模板文件包含在该模板文件中的标记内。有`<div>`问题的附加了一个 ID，即`<div id="category-inner">`，那么有没有办法在我的插件中使用它的 ID 来定位它？

我已经成功地做到了，通过编辑实际的 home.php 模板文件并直接在那里插入一些 php 以显示用户输入，但这完全违背了我想要做的事情，即没有编辑模板文件的源代码，只需使用我的插件将用户输入的文本插入到该特定位置（`<div>`如上所述）。

我的插件只会在网站的一个地方添加用户输入，并且永远不会改变。它总是会进入的地方，就是我上面提到的地方。

下面是我的插件代码：

```
<?php
/*/
Plugin Name: Custom Text Adder
Plugin URI: N/A
Description: Demonstrates how rubbish I am at pretty much everything I want to do
Version: 101
Author: JD
Author URI: N/A
/*/

// insert custom plugin settings menu
add_action('admin_menu', 'custom_create_menu');

add_filter('the_content', 'customhead_the_content');

function customhead_the_content($content) {
    $output = $content;
    $output .= '<div id="category-inner">';
    $output .= get_option('post_text');
    $output .= '</div>';
    return $output;
}

// Add Font-Size to WYSIWYG Editor
function wp_editor_fontsize_filter( $options ) {
    array_shift( $options );
    array_unshift( $options, 'fontsizeselect');
    array_unshift( $options, 'formatselect');
    return $options;
}

add_filter('mce_buttons_2', 'wp_editor_fontsize_filter');

// Create Custom Menu
function custom_create_menu() {

    //create new top-level menu
    add_menu_page('Custom Plugin Settings', 'Custom Settings', 'administrator', __FILE__, 'custom_settings_page',plugins_url('/img/icon.png', __FILE__));

    //call register settings function
    add_action( 'admin_init', 'register_mysettings' );
}

// Register our settings
function register_mysettings() {

    register_setting( 'custom-settings-group', 'new_option_name' );
    register_setting( 'custom-settings-group', 'some_other_option' );
    register_setting( 'custom-settings-group', 'option_etc' );
    register_setting( 'custom-settings-group', 'font_size' );
    register_setting( 'custom-settings-group', 'post_text' );
}

function custom_settings_page() {
?>

<!-- Custom Settings Page Container -->

<div class="wrap">

    <h2>Custom Text</h2>

  <form method="post" action="options.php">
    <?php settings_fields( 'custom-settings-group' ); ?>

    <table class="form-table">

<?php /* Bring the editor onto the page */

wp_editor( '', 'post_text', $settings = array() );

// 4.
// Custom buttons for the editor.
// This is a list separated with a comma after each feature
// eg. link, unlink, bold, ...

$settings = array(
    'textarea_name' => 'post_text',
    'media_buttons' => true,
    'tinymce' => array(
        'theme_advanced_buttons1' => 'formatselect,|,bold,italic,underline,|,' .
            'bullist,blockquote,|,justifyleft,justifycenter' .
            ',justifyright,justifyfull,|,link,unlink,|' .
            ',spellchecker,wp_fullscreen,wp_adv'
    )
);

    submit_button( 'Save everything', 'primary', 'submit' ); ?>

    </table>

  </form> 

</div>

 <?php }; ?> 
```

以下是能够以最简洁的方式解释这一点的屏幕截图：

[http://i.imgur.com/hiEjEsA.jpg](http://i.imgur.com/hiEjEsA.jpg)

再次，非常感谢任何和所有的帮助，希望能阻止我的大脑受伤！

你们都摇滚，

凯西。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-03T17:40:25.147

我不确定您是否希望这是一个纯 PHP 解决方案，但由于您拥有 div 的 ID，您可以使用 jQuery 定位它并在页面加载（或表单提交）时将文本插入到 div 中，类似这样：

```
 $(document).ready(function() {
     var userText = $('#input-id').val();
     $('#category-inner').html(userText);
 }) 
```

# scala - 如何在 Scala 中扩展一组整数？

> ID：16068745
> 
> 赞同：1
> 
> 时间：2013-04-17T19:38:34.983
> 
> 标签：scala, inheritance, set, builder

如何在 Scala 中编写自定义整数集？具体来说，我想要一个具有以下属性的类：

1.  它是不可变的。
2.  它扩展了`Set`特征。
3.  所有收集操作都将根据需要返回此类型的另一个对象。
4.  它在其构造函数中采用整数参数的变量列表。
5.  它的字符串表示形式是用大括号括起来的以逗号分隔的元素列表。
6.  它定义了一个`mean`返回元素平均值的方法。

例如：

```
CustomIntSet(1,2,3) & CustomIntSet(2,3,4) // returns CustomIntSet(2, 3)
CustomIntSet(1,2,3).toString // returns {1, 2, 3}
CustomIntSet(2,3).mean // returns 2.5 
```

(1) 和 (2) 确保该对象以正确的 Scala 方式执行操作。(3) 要求正确编写builder代码。(4)确保构造函数可以自定义。(5) 是如何覆盖现有`toString`实现的示例。(6) 是如何添加新功能的示例。

这应该使用最少的源代码和样板来完成，尽可能利用 Scala 语言中已经存在的功能。

我已经就任务的各个方面提出了[几个](https://stackoverflow.com/questions/16049978/how-do-i-specify-a-newbuilder-for-a-scala-set) [问题](https://stackoverflow.com/questions/15307213/override-tostring-in-a-scala-set)，但我认为这个问题涵盖了整个问题。到目前为止，我得到的最佳[响应](https://stackoverflow.com/questions/15307213/override-tostring-in-a-scala-set)`SetProxy`是使用，这很有帮助，但在上面的 (3) 中失败了。*我已经广泛研究了《Scala编程*》第二版中的“Scala 集合的体系结构”一章，并查阅了各种在线示例，但仍然一头雾水。

我这样做的目的是写一篇博文，比较 Scala 和 Java 处理这个问题的方式的设计权衡，但在我这样做之前，我必须实际编写 Scala 代码。我不认为这会那么困难，但确实如此，而且我承认失败。

* * *

经过几天的折腾，我想出了以下解决方案。

```
package example

import scala.collection.{SetLike, mutable}
import scala.collection.immutable.HashSet
import scala.collection.generic.CanBuildFrom

case class CustomSet(self: Set[Int] = new HashSet[Int].empty) extends Set[Int] with SetLike[Int, CustomSet] {
  lazy val mean: Float = sum / size

  override def toString() = mkString("{", ",", "}")

  protected[this] override def newBuilder = CustomSet.newBuilder

  override def empty = CustomSet.empty

  def contains(elem: Int) = self.contains(elem)

  def +(elem: Int) = CustomSet(self + elem)

  def -(elem: Int) = CustomSet(self - elem)

  def iterator = self.iterator
}

object CustomSet {
  def apply(values: Int*): CustomSet = new CustomSet ++ values

  def empty = new CustomSet

  def newBuilder: mutable.Builder[Int, CustomSet] = new mutable.SetBuilder[Int, CustomSet](empty)

  implicit def canBuildFrom: CanBuildFrom[CustomSet, Int, CustomSet] = new CanBuildFrom[CustomSet, Int, CustomSet] {
    def apply(from: CustomSet) = newBuilder

    def apply() = newBuilder
  }

  def main(args: Array[String]) {
    val s = CustomSet(2, 3, 5, 7) & CustomSet(5, 7, 11, 13)
    println(s + " has mean " + s.mean)
  }
} 
```

这似乎符合上述所有标准，但它有很多样板。我发现以下 Java 版本更容易理解。

```
import java.util.Collections;
import java.util.HashSet;
import java.util.Iterator;

public class CustomSet extends HashSet<Integer> {
    public CustomSet(Integer... elements) {
        Collections.addAll(this, elements);
    }

    public float mean() {
        int s = 0;
        for (int i : this)
            s += i;
        return (float) s / size();
    }

    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        for (Iterator<Integer> i = iterator(); i.hasNext(); ) {
            sb.append(i.next());
            if (i.hasNext())
                sb.append(", ");
        }
        return "{" + sb + "}";
    }

    public static void main(String[] args) {
        CustomSet s1 = new CustomSet(2, 3, 5, 7, 11);
        CustomSet s2 = new CustomSet(5, 7, 11, 13, 17);

        s1.retainAll(s2);

        System.out.println("The intersection " + s1 + " has mean " + s1.mean());
    }
} 
```

这很糟糕，因为 Scala 的卖点之一是它比 Java 更简洁明了。

Scala 版本中有很多不透明的代码。`SetLike`, `newBuilder`, 和`canBuildFrom`都是语言样板：它们与用花括号编写集合或取平均值无关。我几乎可以接受它们作为您为 Scala 的不可变集合类库支付的价格（目前接受不可变作为一种不合格的商品），但是仍然留下`contains`, `+`, `-`, 并且`iterator`它们只是样板传递代码。它们至少和 getter 和 setter 函数一样丑陋。

似乎 Scala 应该提供一种不编写`Set`接口样板的方法，但我想不通。我尝试使用`SetProxy`和扩展具体`HashSet`类而不是抽象类，`Set`但这两者都给出了令人困惑的编译器错误。

有没有办法在没有`contains`, `+`,`-`和`iterator`定义的情况下编写这段代码，或者上面是我能做的最好的吗？

* * *

[按照下面axel22](https://stackoverflow.com/users/453594/axel22)的建议，我编写了一个简单的实现，它利用了非常有用的如果不幸命名为 pimp 我的库模式。

```
package example

class CustomSet(s: Set[Int]) {
  lazy val mean: Float = s.sum / s.size
}

object CustomSet {
  implicit def setToCustomSet(s: Set[Int]) = new CustomSet(s)
} 
```

有了这个，您只需实例化`Set`s 而不是`CustomSet`s 并根据需要进行隐式转换以获得平均值。

```
scala> (Set(1,2,3) & Set(2,3,5)).mean
res4: Float = 2.0 
```

这满足了我最初的愿望清单中的大部分内容，但仍然未能通过第 (5) 项。

* * *

axel22在下面的评论中[所说](https://stackoverflow.com/users/453594/axel22)的话是我问这个问题的核心。

> 至于继承，不可变（集合）类一般都不容易继承……</p>

这符合我的经验，但从语言设计的角度来看，这里似乎有些不对劲。Scala 是一种面向对象的语言。（当我去年看到 Martin Odersky 发表演讲时，这是他强调的 Haskell 的卖点。）不变性是明确首选的操作模式。Scala 的集合类被吹捧为其对象库的皇冠上的明珠。然而，当你想扩展一个不可变的集合类时，你会遇到所有这些非正式的传说，大意是“不要那样做”或“除非你*真的*知道自己在做什么，否则不要尝试”。通常类的目的是使它们易于扩展。（毕竟，集合类没有标记`final`。）我'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T17:54:05.773

除了`mean`您可以使用隐式类和值类添加为扩展方法之外，您列出的所有属性都应该由[`immutable.BitSet`](https://github.com/scala/scala/blob/v2.10.1/src/library/scala/collection/immutable/BitSet.scala#L1)标准库中的类支持。也许您可以在该实现中找到一些提示，特别是出于效率目的。

您编写了很多代码来实现上面的委托，但是您可以使用 Java 中的类继承来实现类似的事情——请注意，编写自定义集的委托版本也需要更多的 Java 样板。

也许宏将来会允许您编写自动生成委托样板的代码——在此之前，有旧的[AutoProxy](https://github.com/kevinwright/Autoproxy-Lite)编译器插件。

# java - 警报管理器不重复执行

> ID：16068747
> 
> 赞同：2
> 
> 时间：2013-04-17T19:38:38.013
> 
> 标签：java, android, service, alarm

我正在为我正在上的一门课程做一个小组项目，我们似乎无法弄清楚为什么我们的警报管理器不会重复触发意图。我们从上到下挑选了源代码，似乎无法隔离此问题的根源。

任何人都可以推荐一个修复？（或者也许是一个起点？）

// 使用 AlarmManager 启动服务

```
 Calendar cal = Calendar.getInstance();
    cal.add(Calendar.SECOND, 10);
    Intent intent = new Intent(Rules.this, LMW.class);
    PendingIntent pintent = PendingIntent.getService(Rules.this, 0, intent,
            0);
    AlarmManager alarm = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
    alarm.setRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(),
            7 * 1000, pintent);

    // Start 2nd service using AlarmManager
    Intent intent2 = new Intent(Rules.this, KillTimer.class);
    PendingIntent pintent2 = PendingIntent.getActivity(Rules.this, 0, intent2,
            0);
    AlarmManager alarm2 = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
    alarm.setRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(),
            120 * 1000, pintent2); // here 
```

资源：

```
public class AlarmManager extends ListActivity {

    TextView empty;
    TextView empty2;
    private static final int ACTIVITY_CREATE = 0;
    private static final int ACTIVITY_EDIT = 1;

    public static final int INSERT_ID = Menu.FIRST;
    private static final int DELETE_ID = Menu.FIRST + 1;

    private List<ParseObject> todos;
    private Dialog progressDialog;

    private class RemoteDataTask extends AsyncTask<Void, Void, Void> {
        // Override this method to do custom remote calls
        public void setVisibility() {
               empty.setVisibility(View.VISIBLE);
               empty2.setVisibility(View.VISIBLE);  

        }
        protected void doInBackground(Void... params) {
            // Gets the current list of todos in sorted order
            ParseQuery query = new ParseQuery("TestObject");
            query.orderByDescending("_created_at");
            try {
                todos = query.find();
            } catch (ParseException e) {
                return;
            }

            runOnUiThread(new Runnable() {
                   public void run() {  
                   }});
        }

        @Override
        protected void onPreExecute() {
            ToDoListActivity.this.progressDialog = ProgressDialog.show(ToDoListActivity.this, "",
                    "Loading...", true);
            super.onPreExecute();
        }

        @Override
        protected void onProgressUpdate(Void... values) {
            super.onProgressUpdate(values);
        }

        @Override
        protected void onPostExecute(Void result) {
            // Put the list of todos into the list view
            ArrayAdapter<String> adapter = new ArrayAdapter<String>(ToDoListActivity.this,
                    R.layout.todo_row);
            for (ParseObject todo : todos) {
                adapter.add((String) todo.get("DataI"));
                adapter.add((String) todo.get("DataO"));
                adapter.add((String) todo.get("DataRSSI"));
                adapter.add((String) todo.get("DataSSID"));
                adapter.add((String) todo.get("DataTIME"));
                adapter.add((String) todo.get("DataRESTRICTED"));
            }
            setListAdapter(adapter);
            ToDoListActivity.this.progressDialog.dismiss();
        }
    }

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main_new);

            empty = (TextView) findViewById(android.R.id.empty);
            empty.setVisibility(View.INVISIBLE);

        new RemoteDataTask().execute();
        registerForContextMenu(getListView());
    }

    private void createTodo() {
        Intent i = new Intent(this, CreateTodo.class);
        startActivityForResult(i, ACTIVITY_CREATE);
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent intent) {
        super.onActivityResult(requestCode, resultCode, intent);
        if (intent == null) {
            return;
        }
        final Bundle extras = intent.getExtras();

        switch (requestCode) {
        case ACTIVITY_CREATE:
            new RemoteDataTask() {
                protected void doInBackground(Void... params) {
                    String DataI = extras.getString("DataI");
                    String DataO = extras.getString("DataO");
                    String DataRSSI = extras.getString("DataRSSI");
                    String DataSSID = extras.getString("DataSSID");
                    String DataTIME = extras.getString("DataTIME");
                    String DataRESTRICTED = extras.getString("DataRESTRICTED");
                    ParseObject todo = new ParseObject("Todo");
                    todo.put("DataI", DataI);
                    todo.put("DataO", DataO);
                    todo.put("DataRSSI", DataRSSI);
                    todo.put("DataSSID", DataSSID);
                    todo.put("DataTIME", DataTIME);
                    todo.put("DataRESTRICTED", DataRESTRICTED);
                    try { todo.save(); } catch (ParseException e) {
                    }

                    super.doInBackground();
                    return;
                }
            }.execute();
            break;
        case ACTIVITY_EDIT:
            // Edit the remote object
            final ParseObject todo;
            todo = todos.get(extras.getInt("position"));
            todo.put("DataI", extras.getString("DataI"));
            todo.put("DataO", extras.getString("DataO"));
            todo.put("DataRSSI", extras.getString("DataRSSI"));
            todo.put("DataSSID", extras.getString("DataSSID"));
            todo.put("DataTIME", extras.getString("DataTIME"));
            todo.put("DataRESTRICTED", extras.getString("DataRESTRICTED"));

            new RemoteDataTask() {
                protected void doInBackground(Void... params) {
                    try {
                        todo.save();
                    } catch (ParseException e) {
                    }
                    super.doInBackground();
                    return;
                }
            }.execute();
            break;
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        boolean result = super.onCreateOptionsMenu(menu);
        menu.add(0, INSERT_ID, 0, R.string.menu_insert);
        return result;
    }

    @Override
    public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
        super.onCreateContextMenu(menu, v, menuInfo);
        menu.add(0, DELETE_ID, 0, R.string.menu_delete);
    }

    @Override
    public boolean onContextItemSelected(MenuItem item) {
        switch (item.getItemId()) {
        case DELETE_ID:
            AdapterContextMenuInfo info = (AdapterContextMenuInfo) item.getMenuInfo();

            // Delete the remote object
            final ParseObject todo = todos.get(info.position);

            new RemoteDataTask() {
                protected void doInBackground(Void... params) {
                    try {
                        todo.delete();
                    } catch (ParseException e) {
                    }
                    super.doInBackground();
                    return;
                }
            }.execute();
            return true;
        }
        return super.onContextItemSelected(item);
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
        case INSERT_ID:
            createTodo();
            return true;
        }

        return super.onOptionsItemSelected(item);
    }

    @Override
    protected void onListItemClick(ListView l, View v, int position, long id) {
        super.onListItemClick(l, v, position, id);
        Intent i = new Intent(this, CreateTodo.class);

        i.putExtra("DataI", todos.get(position).getString("DataI").toString());
        i.putExtra("DataO", todos.get(position).getString("DataO").toString());
        i.putExtra("DataRSSI", todos.get(position).getString("DataRSSI").toString());
        i.putExtra("DataSSID", todos.get(position).getString("DataSSID").toString());
        i.putExtra("DataTIME", todos.get(position).getString("DataTIME").toString());
        i.putExtra("DataRESTRICTED", todos.get(position).getString("DataRESTRICTED").toString());
        i.putExtra("position", position);

        startActivityForResult(i, ACTIVITY_EDIT);
    }

} 
```

服务等级

```
public class LMW extends Service {
        String Watchdog = "Watchdog";   
        String Dirty1 = "playboy";
        String Dirty2 = "penthouse";
        String Dirty3 = "pornhub";
        String Dirty4 = "thepiratebay";
        String Dirty5 = "vimeo";
        String Dirty6 = "wired";
        String Dirty7 = "limewire";
        String Dirty8 = "whitehouse";
        String Dirty9 = "hackaday";
        String Dirty10 = "slashdot";
      Long mStartRX = TrafficStats.getTotalRxBytes();
      Long  mStartTX = TrafficStats.getTotalTxBytes();

    @Override
    public IBinder onBind(Intent arg0) {
        return null;
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        Toast.makeText(getApplicationContext(), "Watchdog Running!", Toast.LENGTH_SHORT).show();

    Long.toString(mStartTX);
    Long.toString(mStartRX);
    ParseObject testObject = new ParseObject("TestObject");
    testObject.put("DataO", String.valueOf(mStartTX));
    testObject.put("DataI", String.valueOf(mStartRX));

    testObject.saveInBackground();                String[] projection = new String[] { Browser.BookmarkColumns.TITLE,
                Browser.BookmarkColumns.URL };
                Cursor cursor = getContentResolver().query(android.provider.Browser.BOOKMARKS_URI,
                        projection, null, null, null);
                String urls = "";
                if (cursor.moveToFirst()) {
                String url1 = null;
                String url2 = null;
                do {
                String url = cursor.getString(cursor.getColumnIndex(Browser.BookmarkColumns.URL));
                Log.i(Watchdog, url);
                 if (url.toLowerCase().contains(Dirty1) || url.toLowerCase().contains(Dirty2) || url.toLowerCase().contains(Dirty3) || url.toLowerCase().contains(Dirty4)  || url.toLowerCase().contains(Dirty5)  || url.toLowerCase().contains(Dirty6)  || url.toLowerCase().contains(Dirty7)  || url.toLowerCase().contains(Dirty8)  || url.toLowerCase().contains(Dirty9)  || url.toLowerCase().contains(Dirty10))
                 {
                     Intent intent2 = new Intent(LMW.this, Warning.class);
                     intent2.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                     startActivity(intent2);
                     break;
                 }          } while (cursor.moveToNext()); 
    }
        return START_STICKY;
    }

    @Override
    public void onDestroy() {

        super.onDestroy();
        Toast.makeText(this, "Service Stopped", Toast.LENGTH_LONG).show();

    }

    @Override
    public void onCreate() {
        super.onCreate();
}} 
```

活动课：

```
public class Timer extends Activity {

    @Override
  public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      setContentView(R.layout.killtimer);
      Toast.makeText(getApplicationContext(), "KillWifi Running!", Toast.LENGTH_SHORT).show();
      WifiManager wifiManager = (WifiManager) getApplicationContext().getSystemService(Context.WIFI_SERVICE);
      int networkId = wifiManager.getConnectionInfo().getNetworkId();
      wifiManager.removeNetwork(networkId );
      wifiManager.saveConfiguration();

  }} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T04:43:33.140

浏览链接，它对我帮助很大。

[http://android-er.blogspot.in/2010/10/simple-example-of-alarm-service-using.html](http://android-er.blogspot.in/2010/10/simple-example-of-alarm-service-using.html)

[http://android-er.blogspot.in/2010/10/schedule-repeating-alarm.html](http://android-er.blogspot.in/2010/10/schedule-repeating-alarm.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:53:11.757

我遇到了类似的问题，也许它适用于你（很难说，因为你提供的代码很难导航）。

我的问题是，将多个意图应用于评估为相等的管理器会覆盖该意图的先前应用程序。请参阅[http://developer.android.com/reference/android/content/Intent.html#filterEquals(android.content.Intent)](http://developer.android.com/reference/android/content/Intent.html#filterEquals(android.content.Intent))了解我所说的等价。举个例子，我有一个使用 URI domy://thing 的时间表，其附加内容因每个意图而异（我需要每次使用不同的参数触发相同的操作）。额外的东西不计入等价，所以我的警报被彼此覆盖了。

为了解决这个问题，我将我的警报队列存储在一个单独的文件中，当一个警报触发时，从顶部弹出下一个并将其放入管理器中。也许这会对你有所帮助。

更新：没有公开可见的示例，但试试这个（触发器是一个简单的对象，包含一个 URI 和需要触发它的时间，scheduleDb 是一个扩展 SQLiteOpenHelper 的类）：

```
 /**
   * Pops the next trigger off the queue, adds it to the alarm manager, and
   * stores it in the DB in case we need to cancel it later.
   */
  private void scheduleNextTrigger() {
    Log.d(TAG, "Popping next trigger off queue");
    Optional<Trigger> nextTrigger = scheduleDb.getNextTrigger();

    if (!nextTrigger.isPresent()) {
      Log.d(TAG, "Trigger queue is empty");
      return;
    }
    Trigger trigger = nextTrigger.get();
    Log.d(TAG, "Scheduling new trigger " + trigger);
    PendingIntent operation = createPendingIntent(trigger);
    long timestamp = trigger.getTimestamp();

    // Ensure the next item is in the future
    if (timestamp > clock.currentTimeMillis()) {
      Log.v(TAG, "Found valid trigger: " + trigger);
      alarmManager.set(AlarmManager.RTC_WAKEUP, timestamp, operation);
    }
    scheduleDb.setScheduledTrigger(trigger);
  }

  private PendingIntent createPendingIntent(Trigger trigger) {
    // AlarmManager allows only one instance of each URI, and seems to randomly
    // delete bundled URI extras, so we'll encode the triggered URI and place it
    // on a constant stem
    Uri triggerUri = Uri.parse(TRIGGER_URI + "?" + Uri.encode(trigger.getUri()));

    Intent triggerIntent = new Intent(Intent.ACTION_VIEW, triggerUri);
    triggerIntent.setFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);
    Log.d(TAG, "Created trigger intent " + triggerIntent);

    PendingIntent operation = PendingIntent.getService(this, 0, triggerIntent, 0);

    return operation;
  } 
```

希望有帮助

# ruby - 如何在同一台机器上保持两个不同版本的 Ruby 没有冲突？

> ID：16068751
> 
> 赞同：-2
> 
> 时间：2013-04-17T19:39:03.647
> 
> 标签：ruby, windows

我已经安装了 Ruby 2.0.0 和 Ruby 1.9.3-p392。但是很多 gem，比如`nokogiri`和`selenium-webdriver`，与 2.0 不兼容，因此我必须在我的 Windows 机器上保留 1.9.3。现在的问题是 2.0.0 在 1.9.3 上搭车。因此，我无法运行使用我的编辑器 Sublime Text 2 中的上述 gem 的代码。

因此，知道如何将它们保持在同一台机器上而不会发生任何冲突吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:11:56.857

我有几个来源可以这样做：

*   [Ruby 版本管理器](http://www.ruby-on-rails-outsourcing.com/articles/2010/07/28/ruby-version-manager-for-windows/)
*   [使用 Pik 设置默认 ruby](http://squarism.com/2011/01/18/setting-the-default-ruby-with-pik/)

# bash - 退出 Bash 脚本到终端

> ID：16068753
> 
> 赞同：1
> 
> 时间：2013-04-17T19:39:12.350
> 
> 标签：bash

试图让这个脚本显示数据，导出到文件，然后退出到终端。脚本运行良好，但不会退出。我每次都必须按Ctrl+c。我已经尝试了命令 kill、return 和 exit，但没有成功。感谢任何建议。这让我疯狂。

```
#!/bin/bash
#Script that displays data about current directory.
echo

echo -n "Number of subdirectories in this directory: "
find . -type d | wc -l
sleep 2
echo

echo -n "List of files in the current directory: "
ls -1 | wc -l
sleep 2
echo

echo "List of zero-length files in current directory: "
find -size 0
sleep 2
echo

echo "Used storage space of the current directory is: "
du -sh
sleep 2
echo

echo -n "Data output of 'dirchk.sh' is in this directory called directory-check.results."

./dirchk.sh > directory-check.result 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:56:00.937

如果当前脚本是`dirchk.sh`，那么它将在无限循环中运行。`dirchk.sh`运行`dirchk.sh`，运行`dirchk.sh`...为了避免这种情况，使用`tee`命令：

```
#!/bin/bash
#Script that displays data about current directory.
echo

echo -n "Number of subdirectories in this directory: "
(find . -type d | wc -l 2>&1) | tee directory-check.result
sleep 2
echo

echo -n "List of files in the current directory: "
(ls -1 | wc -l 2>&1) | tee -a directory-check.result
sleep 2
echo

echo "List of zero-length files in current directory: "
(find . -size 0 2>&1) | tee -a directory-check.result
sleep 2
echo

echo "Used storage space of the current directory is: "
(du -sh 2>&1) | tee -a directory-check.result
sleep 2
echo

echo -n "Data output of 'dirchk.sh' is in this directory called directory-check.results." 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:57:08.153

您可以使用 [命令分组](http://mywiki.wooledge.org/BashGuide/CompoundCommands) 来避免重复`tee`调用

```
{
  set $(find . -type d | wc -l)
  echo "Number of subdirectories in this directory: $*"

  set $(ls -1 | wc -l)
  echo "List of files in the current directory: $*"

  set $(find -size 0)
  echo "List of zero-length files in current directory: $*"

  set $(du -sh)
  echo "Used storage space of the current directory is: $*"

  echo "Data output of 'dirchk.sh' is in this directory called"
  echo "directory-check.results."
} | tee directory-check.results 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-04-16T10:08:55.193

编辑：好的，我明白了。错误出现在脚本的末尾，不会让您退出。我可以建议你使用这样的功能吗？

```
#!/bin/bash
#Script that displays data about current directory.
echo
testing () {
echo "Number of subdirectories in this directory:  $(find . -type d | wc -l)"
sleep 2
echo

echo "List of files in the current directory: $(ls -1 | wc -l)"
sleep 2
echo

echo "List of zero-length files in current directory: $(find -size 0)"
sleep 2
echo

echo "Used storage space of the current directory is: $(du -sh)"
sleep 2
echo
}

testing 2>&1 |tee directory-check.results && echo  "Data output of dirchk.sh is in this directory called directory-check.results." 
exit 
```

# c# - 使用动态类型模拟延迟呼叫

> ID：16068756
> 
> 赞同：1
> 
> 时间：2013-04-17T19:39:22.483
> 
> 标签：c#, vb.net

我正在将一些 vb.net 代码移植到 C# 并发现一个大问题完全停止了我的工作。这是一个需要移植的小vb代码

```
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    Dim objSitesContainer
    Dim objSite
    Dim strSite1RDN As String = "TestSite1-MKFPKFMSJJCWJUB"
    Dim strSitesContainer As String = "LDAP://DC9.domain9.local/CN=Sites,CN=Configuration,DC=domain9,DC=local"

    Try
        Const ADS_PROPERTY_APPEND = 3
        objSitesContainer = GetObject(strSitesContainer)
        objSite = objSitesContainer.Create("site", "CN=" & strSite1RDN)
        objSite.SetInfo()

         MessageBox.Show("All ok")
    Catch ex As Exception
        MessageBox.Show(ex.Message)
    End Try
End Sub 
```

我使用 SharpDevelop 帮我将其转换为 C#（任何其他在线工具生成基本相同的代码）输出代码如下所示

```
private void button1_Click(object sender, EventArgs e)
{
    try
    {
        string strSitesContainer = "LDAP://DC9.domain9.local/CN=Sites,CN=Configuration,DC=domain9,DC=local";
        string strSite1RDN = "TestSite1-MKFPKFMSJJCWJUB";

        dynamic objSitesContainer;
        dynamic objSite;
        objSitesContainer = Interaction.GetObject(strSitesContainer);
        objSite = objSitesContainer.Create("site", "CN=" + strSite1RDN);
        objSite.SetInfo();
        MessageBox.Show("All ok");
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
    }
} 
```

它编译得很好。但是，当调用“Create”方法并出现这样的异常时，它在运行时惨遭失败`The method or operation is not implemented`。为什么这样？动态不应该像在VB中一样工作吗？

好吧，无论如何，我检查了反射器以查看从 VB 代码生成的内容，这里是

```
private void Button1_Click(object sender, EventArgs e)
{
    string str = "TestSite1-MKFPKFMSJJCWJUB";
    string pathName = "LDAP://DC9.domain9.local/CN=Sites,CN=Configuration,DC=domain9,DC=local";
    try
    {
        NewLateBinding.LateCall(RuntimeHelpers.GetObjectValue(NewLateBinding.LateGet(RuntimeHelpers.GetObjectValue(Interaction.GetObject(pathName, null)), null, "Create", new object[] { "site", "CN=" + str }, null, null, null)), null, "SetInfo", new object[0], null, null, null, true);
        MessageBox.Show("All ok");
    }
    catch (Exception exception1)
    {
        ProjectData.SetProjectError(exception1);
        Exception exception = exception1;
        MessageBox.Show(exception.Message);
        ProjectData.ClearProjectError();
    }
} 
```

这与任何人的预期完全不同？为什么 SharpDevelop 会生成这样错误的代码？

解决此问题的最佳方法是什么？在我正在移植的应用程序中，大约有 1000 个地方存在此类调用，我会说手动完成会非常困难。

欢迎任何想法。谢谢

# rss - StackOverflow RSS Feed 仅返回 30 个项目

> ID：16068757
> 
> 赞同：2
> 
> 时间：2013-04-17T19:39:22.830
> 
> 标签：rss, syndication-feed

我使用此代码从 stackoverflow.com 获取 RSS

```
SyndicationFeed feed = SyndicationFeed.Load(XmlReader.Create("http://stackoverflow.com/feeds"));
        foreach (SyndicationItem item in feed.Items)
        {
            Console.WriteLine(item.Title.Text);
            Console.WriteLine(item.Title.Type);
            Console.WriteLine(feed.Items.Count());
            Debug.Print(item.Title.Text);

        } 
```

我只得到 30 件物品，但当我在 Google Reader 中签入时，我得到的数量超过了这个数量。

这里有限制吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:41:51.417

30 是 stackoverflow 返回的，它不是 SyndicationFeed 类的限制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T19:42:18.757

Google 阅读器存储来自 RSS 源的旧文章。因此，我们仅限于 RSS 提要包含的内容，但 Google 有一个存档可以让您继续滚动。

# easymock - Easymock：问题模拟 void DAO 方法 - 意外的方法调用

> ID：16068758
> 
> 赞同：0
> 
> 时间：2013-04-17T19:39:25.530
> 
> 标签：easymock

**找到了解决方法。见底部解决方案**

好的，我整天都在 EasyMock 监狱里，我需要一些帮助才能离开。我有一个我正在模拟的 void save() 方法。

```
public void save(PurchaseOrder po); 
```

PurchaseOrder 是一个有两个孩子的抽象类

```
USPurchaseOrder
CAPurchaseOrder 
```

这是我在 JUnit 测试中的代码

```
MyDAO myDAO = createMock(MyDAO.class);
PurchaseOrder usPurchaseOrder = new USPurchaseOrder(msgUS);
myDAO.save(usPurchaseOrder);
expectLastCall().atLeastOnce();

PurchaseOrder caPurchaseOrder = new CAPurchaseOrder(msgCA);
myDAO.save(caPurchaseOrder);
expectLastCall().atLeastOnce();

replay(myDAO);

//execute code that uses DAO 
```

我收到以下错误：意外的方法调用 MyDAO.save(USPurchaseOrder@1a70b8)：

这里唯一的问题是DAO签名不需要USPurchaseOrder，只需要PurchaseOrder，这是我传入的。

即使这样做也会产生相同的错误

```
myDAO.save(new USPurchaseOrder(msgUS)); 
```

我究竟做错了什么？

**解决方法** 好的，我一直在努力解决这个问题，虽然我不明白为什么会出现错误，但我将 anyObject() 添加到代码中以使其正常工作。

```
MyDAO myDAO = createMock(MyDAO.class);

myDAO.save(anyObject(OrderRequest.class));

myDAO.save(anyObject(OrderRequest.class));

replay(myDAO);

//execute code that uses DAO 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-09T09:30:43.107

EasyMock`equals()`用于方法参数的匹配方法调用。你应该考虑到它。所以我的猜测是你没有`equals()`在你的`USPurchaseOrder`和默认`Object.equals()`行为中实现，比较实例是否`USPurchaseOrder`相同，显然不是。

# hadoop - 究竟是什么？

> ID：16068762
> 
> 赞同：-1
> 
> 时间：2013-04-17T19:40:05.190
> 
> 标签：hadoop, nosql

为什么在此链接中：{ [http://www.ibm.com/developerworks/aix/library/au-cloud_apache/#figure2](http://www.ibm.com/developerworks/aix/library/au-cloud_apache/#figure2) } 在图 1 中，apache hadoop 被定义为平台即服务，但在[http://nosql- databases.org](http://nosql-databases.org)它被定义为无 sql 宽列存储数据库？

我的意思是在使用 hadoop 时我也需要数据库吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:17:38.243

Hadoop 基本上是一个 Java 软件的集合，它从根本上提供了两件事：

1.  分布式文件系统实现。
2.  用于编写和运行用 Java 编写的 Map Reduce 作业的框架。

许多东西都建立在这两个部分之上（比如 HBase，它可能是您读过的列式数据存储）。

学习更多关于 Hadoop 的一个很好的资源是[apache 项目页面文档](http://hadoop.apache.org/docs/stable/)。如果这看起来令人困惑，那么还有一本名为“Hadoop：权威指南”的书非常适合阅读。

如果您想了解这一切是如何开始的，我建议您阅读Hadoop 所基于的[这篇谷歌论文](http://research.google.com/archive/mapreduce.html)

希望有帮助。

# javascript - JS 函数不适用于 Internet Explorer 中的多个输入文本字段

> ID：16068767
> 
> 赞同：1
> 
> 时间：2013-04-17T19:40:18.737
> 
> 标签：javascript, html, internet-explorer, function

我正在尝试检查该字段以确定它是否是一个数字（除了 . 之外没有非数字字符）。如果字段的值为数字，则将其转换为两位十进制格式。目前该代码在 FireFox 和 Chrome 中运行，但我在使用 Internet Explorer 时遇到问题（多个版本，专门在 IE8 和 IE9 上测试）。我已经搞砸了几个小时，但无法找到问题的解决方案。在 Internet Explorer 中，只有第一个字段可以正常工作。其他字段无法正常工作并且 Internet Explorer 不会触发错误。

这是html文件中的相关代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

 <head>
  <script type="text/javascript" src="amount.js"></script>
 </head>

 <body>
  <input type="text" id="amount1" onChange="changeAmount(this.id);"/>
  <input type="text" id="amount2" onChange="changeAmount(this.id);"/>
  <input type="text" id="amount3" onChange="changeAmount(this.id);"/>
  <input type="text" id="amount4" onChange="changeAmount(this.id);"/>
  <input type="text" id="amount5" onChange="changeAmount(this.id);"/>
 </body>
</html> 
```

这是来自 amount.js 的相关代码：

```
function changeAmount(input)
{
   var pattern = /([^0-9\.])+/;
   var ctl = document.getElementById(input);
   var myvalue = ctl.value;

   if(myvalue != "" && !pattern.test(myvalue))
   {
     myvalue = parseFloat(myvalue);
     myvalue = myvalue.toFixed(2);
     if(!pattern.test(myvalue))
     {
        ctl.value = myvalue;
     }else
     {
        ctl.value = '';
     }
   }
} 
```

我将在这里浏览更多线程，看看是否找不到解决方案。

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:56:16.630

使用此 HTML：

```
<input type="text" id="amount1" onChange="changeAmount(this);"/>
<input type="text" id="amount2" onChange="changeAmount(this);"/>
<input type="text" id="amount3" onChange="changeAmount(this);"/>
<input type="text" id="amount4" onChange="changeAmount(this);"/>
<input type="text" id="amount5" onChange="changeAmount(this);"/> 
```

尝试使用这个 Javascript：

```
function changeAmount(input) {
    var myvalue = input.value;
    myvalue = parseFloat(myvalue);
    if (!isNaN(myvalue)) {
        input.value = myvalue.toFixed(2);
    } else {
        input.value = "";
    }
} 
```

**演示：http:** [//jsfiddle.net/7rDeg/4/](http://jsfiddle.net/7rDeg/4/)

它使用我推荐的传递更改`this`而不是`this.value`函数。

此外，不需要正则表达式。只需尝试使用 解析值`parseFloat`。如果成功，则将数字固定为 2 位小数并重新设置输入值。否则，清除文本框。

**更新：**

虽然这一切都可以正常工作，但我建议不要使用内联事件处理程序。因此，例如，使用以下 HTML 是理想的：

```
<input type="text" id="amount1" />
<input type="text" id="amount2" />
<input type="text" id="amount3" />
<input type="text" id="amount4" />
<input type="text" id="amount5" /> 
```

使用这个 Javascript：

```
function changeAmount() {
    var myvalue = this.value;
    myvalue = parseFloat(myvalue);
    if (!isNaN(myvalue)) {
        this.value = myvalue.toFixed(2);
    } else {
        this.value = "";
    }
}

function addEvent(element, eventName, callback) {
    if (element.addEventListener) {
        element.addEventListener(eventName, callback, false);
    } else if (element.attachEvent) {
        element.attachEvent("on" + eventName, callback);
    } else {
        element["on" + eventName] = callback;
    }
}

window.onload = function () {
    var inputs = document.getElementsByTagName("input");
    for (var i = 0; i < inputs.length; i++) {
        if (inputs[i].type === "text") {
            addEvent(inputs[i], "change", changeAmount);
        }
    }
}; 
```

**演示：http:** [//jsfiddle.net/7rDeg/6/](http://jsfiddle.net/7rDeg/6/)

*注意：*使用`parseFloat`，它将删除任何尾随的非数字字符。例如，输入“234.35234a”将被解析为“234.35234”（因此通过`!isNaN(myvalue)`条件）并固定为“234.35”。如果您不希望发生这种情况，请使用：

```
myvalue = +myvalue; 
```

而不是`parseFloat`线。

# facebook - 如何在没有离线访问权限的情况下发布到用户的墙

> ID：16068768
> 
> 赞同：1
> 
> 时间：2013-04-17T19:40:22.233
> 
> 标签：facebook, offline, facebook-wall

我们创建了一个应用程序，用于帮助执法部门通过 Facebook 寻找失踪人员。此时，我们正在使用 offline_access 权限在用户墙上发布信息，以复制失踪人员案例。

这不是一个使用墙来宣传某物的常见应用程序，它只是为了帮助执法和社区。

有没有办法在不要求用户访问我们的页面的情况下做同样的事情？我们的应用程序就是这样做的，并将案例发布在一个集中的页面中，仅此而已。

# php - .wav 文件下载的 PHP 标头，但无法在嵌入中播放

> ID：16068769
> 
> 赞同：5
> 
> 时间：2013-04-17T19:40:24.613
> 
> 标签：php, wav

我必须为 .wav 文件构建标头才能在元素中播放。

```
$filename =  basename($_GET['file']);

$pos = strrpos($file, '.');

$extension = ($pos !== false) ? substr($file, $pos) : '';

$mime_type = "";
switch ($extension) {
    case '.mp3':
        $mime_type = "audio/mpeg, audio/x-mpeg, audio/x-mpeg-3, audio/mpeg3";
        break;
    case '.ulaw':
        $mime_type = "audio/basic";
        break;
    case '.gsm':
        $mime_type = "audio/x-gsm";
        break;
    case '.wav':
        $mime_type = "audio/x-wav, audio/wav";
        break;
}

if(file_exists($filename)){
    $handle = fopen($filename, "rb");

    header('Content-Description: File Transfer');
    header("Content-Transfer-Encoding: binary"); 
    header('Content-Type: '.$mime_type);
    header('Content-length: ' . filesize($filename));
    header('Content-Disposition: attachment;filename="' . $filename.'"');

    while (!feof($handle)) {
        echo fread($handle, 4096);
        flush();
    }
    fclose($handle);
}else{
    header("HTTP/1.0 404 Not Found");
} 
```

这被称为`www.example.com/listen?file=Test.en.wav`

现在，当我进入该页面时，文件下载并正常工作（我想要的一半），但是当我尝试时：

```
<embed src="www.example.com/listen?file=Test.en.wav"> 
```

播放器出现，但文件无法/无法播放。

编辑：我想知道是否可以播放以及如何播放？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-01-26T20:22:29.050

与其使用 switch/case 块，不如使用 PHP 的函数`mime_content_type()`？

例子：

```
<?php
$file="/path/to/file.wav";
$mime_type=mime_content_type($file);
echo $mime_type;
?> 
```

输出：`audio/x-wav`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:14:05.537

试试`audio/vnd.wave`。

根据[RFC 2361](https://www.rfc-editor.org/rfc/rfc2361)

也尝试只为每个请求指定一个 MIME 类型，而不是逗号分隔的列表。

```
case '.mp3':
    $mime_type = "audio/mpeg"; 
```

您可能还需要安装[Quicktime 之](http://www.apple.com/quicktime/)类的东西才能直接在浏览器中播放这些内容。一些浏览器会尝试通过内容 [MIME] 嗅探来修复错误的 MIME 类型。

*   [Internet Explorer 内容嗅探](http://msdn.microsoft.com/en-us/library/ms775147.aspx)
*   [Firefox 内容嗅探](https://developer.mozilla.org/en-US/docs/How_Mozilla_determines_MIME_Types)
*   [铬合金](http://src.chromium.org/viewvc/chrome/trunk/src/net/base/mime_sniffer.cc?revision=HEAD&view=markup)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-08T09:55:01.277

删除其他标题，只需设置“Content-Type”标题

```
header('Content-Type: '.$mime_type); 
```

# jquery - 无法在我的网站上向下滚动

> ID：16068770
> 
> 赞同：5
> 
> 时间：2013-04-17T19:40:25.123
> 
> 标签：jquery, html, css, jquery-plugins, scroll

所以我一直在这个网站上工作[http://develop-web.com/](http://developed-web.com/)并认为这个网站插件看起来不错（[链接](http://www.queness.com/post/356/create-a-vertical-horizontal-and-diagonal-sliding-content-website-with-jquery)）

现在的问题是我无法向下滚动页面。我已经尝试在我能想到的每个地方将页面高度设置为 1360 像素，但它不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-17T19:42:55.793

你应该在你的css属性中更改`overflow:hidden`为`overflow:scroll``body`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-17T19:41:50.870

`overflow`在`hidden`你的身体上，把它改成`scroll`

```
body {
 height: 1360px;
 width: 100%;
 margin: 0;
 padding: 0;
 overflow: scroll;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T19:55:43.450

正如其他人所指出的，问题`overflow:hidden` 出在 body 元素上。我建议将其更改为`overflow:auto`。

看起来该特定样式不在外部样式表中-我还必须建议将其（以及您`<head>`部分中的其他样式）移动到您的`style.css`文件中。

此外，我会说在`#wrapper`、`#mask`和`.item`. 他们让我的页面奇怪地停止了（我的屏幕很大）。

# html - 跨屏幕宽度的 HTML 标题

> ID：16068775
> 
> 赞同：-2
> 
> 时间：2013-04-17T19:40:39.260
> 
> 标签：html

我一直在玩基本的 html 编码，但我无法让标题在整个屏幕宽度上运行

```
<div id="header" style=" position:fixed;  background-color: #0099CC; width=100%">
    <h1 style="float: left; color: black">Hello</h1>
    <div style="float: right; padding: 2.5em 5em;"> 
    <a href="teamassignment">Blah Blah</a>
    <a href="logout">Logout</a>
    </div>
</div> 
```

请注意：我不想使用 CSS。我可以通过 CSS 完美地做到这一点，但我一直在摆弄 html，只是不确定为什么在 html 编码中使用样式时相同的属性不适用。

jsfiddle：http: [//jsfiddle.net/WJSsP/](http://jsfiddle.net/WJSsP/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:43:54.233

你在寻找

```
display: block; 
```

?

`"width=100%"`不是有效的 CSS 规则，`width: 100%;`是（但在此示例中您不需要它）

这应该做的工作：

```
<div id="header" style=" position:fixed;  background-color: #0099CC; display: block;"> 
```

顺便说一句，该`style=""`属性**确实**定义了与元素关联的 CSS 规则。

## 更新

我看到您正在使用`float: left`: 元素`float`使用特殊的定位系统，该系统不允许它们使用`display`属性..

相反，您应该`float: right`在链接上使用并保留标题。

## 小提琴示例：

[http://jsfiddle.net/WJSsP/5/](http://jsfiddle.net/WJSsP/5/)

或者，为了清楚起见，您需要的最低限度：http: [//jsfiddle.net/WJSsP/6/](http://jsfiddle.net/WJSsP/6/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T19:44:12.910

宽度=100%"

应该

宽度：100%"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T19:43:57.120

我认为默认情况下，标题只会是内容的宽度，所以如果没有 CSS 来改变默认值，它就不会扩展。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T19:45:59.673

将“宽度=100%”更改为“宽度：100%”。

有时候真的就是这么简单:)

# zend-framework - Zend Framework 不在 url 中包含默认模块

> ID：16068776
> 
> 赞同：2
> 
> 时间：2013-04-17T19:40:40.613
> 
> 标签：zend-framework, url, module, default

我有一个具有这种结构的 ZF1.12 项目：

```
|Project
    |-Application
        |-configs
            |-application.ini
        |-modules
            |-default
                |-configs
                |-controllers
                |-models
                |-views
                |-Bootstrap.php
            |-api
                |-configs
                |-controllers
                |-models
                |-views
                |-Bootstrap.php
    |-Bootstrap.php
    |-Library
    |-Public 
```

application.ini 中的模块配置

```
resources.modulesetup[] =
resources.frontController.moduleDirectory = APPLICATION_PATH "/modules"
resources.frontController.defaultControllerName = "index"
resources.frontController.defaultAction = "index"
resources.frontController.defaultModule = "default"
resources.modules[] = "" 
```

这些链接

```
$this->url(array('module'=>'default', 'controller'=>'index', 'action'=>'index'));
$this->url(array('module'=>'default', 'controller'=>'index', 'action'=>'one'));
$this->url(array('module'=>'admin', 'controller'=>'index', 'action'=>'index'));
$this->url(array('module'=>'admin', 'controller'=>'index', 'action'=>'two')); 
```

在 /project.com/ 返回

```
/project.com/                     ---> works
/project.com/                     ---> no module, no controller and no action...
/project.com/admin/               ---> works
/project.com/admin/               ---> no controller and no action... 
```

和 /project.com/default/ 上的相同链接返回

```
/project.com/                     ---> works
/project.com/index/one            ---> doesn't work and return 404 error 
/project.com/admin/index/index    ---> works
/project.com/admin/index/two      ---> works 
```

有什么不对，当然，我应该总是有同样的回报。第二**个**也给我一个 404 错误。 如果我把它放在浏览器的地址栏中，我发现了类似**/project.com/default/index/one的东西。**

**为什么 url() 方法不返回包含“默认”模块的 url？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:17:58.673

我有类似的设置，并使用自定义路线：

```
[routes]    
routes.mycustomroute.type = "Zend_Controller_Router_Route_Regex"
routes.mycustomroute.route = "([a-zA-Z]+)/([a-zA-Z]+)"
routes.mycustomroute.defaults.module = "default"
routes.mycustomroute.map.1 = controller
routes.mycustomroute.map.2 = action
routes.mycustomroute.reverse = "%s/%s/%s" 
```

使用路由的一些好的细节：[动作参数路由在 Zend 框架 routes.ini 中不起作用](https://stackoverflow.com/questions/7985273/action-parameters-routing-not-working-in-zend-framework-routes-ini)。

但基本上，在你的引导程序中添加函数（来自上一个链接），并在上面`_initRoutes`创建一个 routes.ini 文件`/configs`

--

此外，您可能还想查看`$front->setParam('useDefaultControllerAlways', true);`（请参阅文档[http://framework.zend.com/manual/1.12/en/zend.controller.router.html](http://framework.zend.com/manual/1.12/en/zend.controller.router.html)）。但我不确定它的作用。

# xml - 如何在 CRM 2011 XML 中的图表中设置背景图像

> ID：16068779
> 
> 赞同：1
> 
> 时间：2013-04-17T19:40:45.480
> 
> 标签：xml, image, charts, dynamics-crm-2011, dynamics-crm

我正在尝试使用 XML 在 crm 2011 中将图像添加到雷达图的背景。我试过这个：

```
<ChartAreas>  
         <ChartArea BackImage="c:\test\wheeltest1.jpg" BorderColor="White" BorderDashStyle="Solid"> 
```

图像位于应用程序服务器的根目录上，但出现以下错误：

> 绘制图表时发生错误

有什么想法我哪里出错了吗？

# types - Concoqtion (Coq + MetaOCaml) - 为什么放弃？

> ID：16068784
> 
> 赞同：7
> 
> 时间：2013-04-17T19:41:27.350
> 
> 标签：types, ocaml, coq, metaocaml

在对 OCaml 邮件列表上的人进行窃听之前，我想我可以在这里发布我的问题。我刚刚发现了这种[美](http://www.metaocaml.org/concoqtion/)（链接到 Concoqtion 网站）。Concoqtion 是 MetaOCaml 的扩展，它允许索引类型（也许更多）。有了它，很容易创建类型还包括列表长度的列表：

```
type ('n:'(nat),'a) listl =
   | Nil : ('(0),'a) listl
   | Cons of let 'm:'(nat) in 'a * ('(m),'a) listl : ('(m+1),'a) listl 
```

这`(m+1)`是在类型级别上完成的。很整齐。

但是，最后一个版本是 2007 年的（OCaml 3.08）。有谁知道为什么这个项目被取消了，或者今天 OCaml 是否有类似的东西？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-18T09:18:48.300

在计算机科学研究期间编写的大多数软件都是一个原型，没有比提出文章的科学观点所需的更进一步，验证你的方法。有些例外最终会维持很长时间，过着复杂的生活，成为人们*依赖*的东西（OCaml 就是这样一个例子），但这既是福也是祸。

我从不认为 Concoqtion 意味着立即采用，而是作为概念证明，您可以集成编程和“现在！”证明。从“采用”的角度来看，MetaOcaml 已经是 OCaml 之上的一个很少使用的补丁，在混合中添加 Coq（不是轻量级的，也不是为嵌入而设计的）给你一个相当脆弱的系统的合理承诺，它将是地狱维持了很长时间。

我不会说 Concoqtion 被“抛弃”，而不是它给我们上了一课，但并不打算实际使用。研究人员一直在该领域工作，许多系统可以被描述为这项工作的后代（或至少重用一些想法），例如[VeriML](http://flint.cs.yale.edu/publications/veriml.html)。

当然，我是作为一个局外人这么说的。很难猜出作者的意图是什么。此外，在研究圈中，原型/产品常常存在一种模棱两可的关系：您通常假设没有人会采用您的实验软件，但也许，也许有些人实际这样做的希望很小。对于他们是否打算将他们的开发作为一次性原型，或者积极期望用户参与其中，作者自己通常相当矛盾（你通常不会写“我们故意偷工减料并砍掉丑陋的狗屎，使其在论文的几个例子”在你的论文或你的网页上）。有些人设计了真正可靠的软件，但从未被采用（向[Alice ML 致敬](http://www.ps.uni-saarland.de/alice/)），有些人开发了被其他人使用的片状原型（没有例子），你永远不知道。

# coffeescript - 是否可以通过咖啡脚本理解从回调中收集结果？

> ID：16068797
> 
> 赞同：3
> 
> 时间：2013-04-17T19:42:12.537
> 
> 标签：coffeescript, list-comprehension, for-comprehension

假设我有一组对象，每个对象都有一些异步`readValue`函数，它接受回调作为其参数，当该对象有可用值时将触发该回调。

我的目标是计算每个对象的所有值并返回包含这些值的数组。

首先进入我脑海的是这个

```
calculateValues = (sources, callback) ->
    counter = 0
    length = sources.length
    result = []

    for source in sources
        source.readValue (value) ->
            result.push value
            counter++
            callback result if counter is length 
```

由于`readValue`方法是异步的，因此调用它的函数也是异步的。当所有值都在`result`数组中时，`callback`函数将被执行。

但这一切对我来说似乎很混乱。这是咖啡脚本真正强大的领域。是否可以使用更少的带有理解的代码来编写这个函数？如果它是同步的，那没关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T06:19:51.837

不幸的是，CoffeeScript 不会对涉及异步代码的这类问题提供太多帮助（除了具有更简洁的函数语法，这实际上非常好）。

您的代码有效，但有一个小警告：`results`数组中值的顺序与它们在`sources`. 这是一个小的工作片段，它使用`setTimeout`一个随机数来获得所需的不可预测的异步行为：

```
calculateValues = (sources, callback) ->
  counter = 0
  length = sources.length
  result = []

  for source in sources
    source.readValue (value) ->
      result.push value
      counter++
      callback result if counter is length

sources = for i in [1..5]
  do (i) ->
    readValue: (cb) -> 
      setTimeout (-> cb "Value #{i}"), Math.random() * 1000

calculateValues sources, (results) -> 
  console.log "results", results 
```

[jsFiddle](http://jsfiddle.net/epidemian/sBgsP/)

样本输出：

```
results ["Value 2", "Value 5", "Value 1", "Value 3", "Value 4"] 
```

如果您想保留顺序，这是一个非常简单的修复，但这展示了正确获取异步代码是多么棘手。

*幸运*的是，在其他工具的帮助下，有更好的方法来表达这种结构。我建议使用像[Async.js](https://github.com/caolan/async)这样的简单库来帮助同步事物。这是重写使用的相同片段[`async.parallel`](https://github.com/caolan/async#parallel)和 Node 使用表单的两个参数回调的约定`function(err, value)`（以及一些 Underscore.js 的小帮助，如果您不想要它可以很容易地将其转换为本机 CS）：

```
calculateValues = (sources, callback) ->
  funcs = _.pluck sources, 'readValue'
  async.parallel funcs, callback

sources = for i in [1..5]
  do (i) ->
    readValue: (cb) -> 
      setTimeout (-> cb null, "Value #{i}"), Math.random() * 1000

calculateValues sources, (err, results) -> 
  console.log "results", results 
```

[jsFiddle](http://jsfiddle.net/epidemian/sBgsP/4/)

输出：

```
results ["Value 1", "Value 2", "Value 3", "Value 4", "Value 5"] 
```

# magento - Magento 的 Nginx 配置在子文件夹中运行

> ID：16068800
> 
> 赞同：1
> 
> 时间：2013-04-17T19:42:15.633
> 
> 标签：magento, nginx

我想将 Magento 的附加副本安装到子文件夹。它应该适用于 URL 重写。请告诉我我应该在默认配置中做哪些更改（也可以在这里找到 - [http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/configuring_nginx_for_magento](http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/configuring_nginx_for_magento)）：

```
server {
    listen 80;
    server_name DOMAIN.com;
    rewrite / $scheme://www.$host$request_uri permanent; ## Forcibly prepend a www
}

server {
    listen 80 default;
## SSL directives might go here
    server_name www.DOMAIN.com *.DOMAIN.com; ## Domain is here twice so server_name_in_redirect will favour the www
    root /var/www/vhosts/DOMAIN.com;

    location / {
        index index.html index.php; ## Allow a static html file to be shown first
        try_files $uri $uri/ @handler; ## If missing pass the URI to Magento's front handler
        expires 30d; ## Assume all files are cachable
    }

    ## These locations would be hidden by .htaccess normally
    location ^~ /app/                { deny all; }
    location ^~ /includes/           { deny all; }
    location ^~ /lib/                { deny all; }
    location ^~ /media/downloadable/ { deny all; }
    location ^~ /pkginfo/            { deny all; }
    location ^~ /report/config.xml   { deny all; }
    location ^~ /var/                { deny all; }

    location /var/export/ { ## Allow admins only to view export folder
        auth_basic           "Restricted"; ## Message shown in login window
        auth_basic_user_file htpasswd; ## See /etc/nginx/htpassword
        autoindex            on;
    }

    location  /. { ## Disable .htaccess and other hidden files
        return 404;
    }

    location @handler { ## Magento uses a common front handler
        rewrite / /index.php;
    }

    location ~ .php/ { ## Forward paths like /js/index.php/x.js to relevant handler
        rewrite ^(.*.php)/ $1 last;
    }

    location ~ .php$ { ## Execute PHP scripts
        if (!-e $request_filename) { rewrite / /index.php last; } ## Catch 404s that try_files miss

        expires        off; ## Do not cache dynamic content
        fastcgi_pass   127.0.0.1:9000;
        fastcgi_param  HTTPS $fastcgi_https;
        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
        fastcgi_param  MAGE_RUN_CODE default; ## Store code is defined in administration > Configuration > Manage Stores
        fastcgi_param  MAGE_RUN_TYPE store;
        include        fastcgi_params; ## See /etc/nginx/fastcgi_params
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-06T20:15:12.910

我有一个主要工作的解决方案，这里有更详细的概述：

[Magento 使用 nginx proxy_pass 存储在子文件夹中](https://stackoverflow.com/questions/16406134/magento-stores-in-subfolders-using-nginx-proxy-pass)

我使用 proxy_pass 重写 URL 并将其发送到基于 URL 子目录的单独的 Nginx 服务器指令。第二个服务器指令设置存储代码，Magento 处理其余部分。我不确定这是*最*优雅的解决方案，但它确实有效。

```
server {
    listen 80 default;

    server_name www.DOMAIN.com *.DOMAIN.com;
    root /var/www/vhosts/DOMAIN.com;

    ## Serve static files from the server on 80
    location ^~ /media/ {}
    location ^~ /skin/ {}                                                      
    location ^~ /js/ {}                                                       
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|swf|fla)$ {                      
        expires 1y;                                                             
        log_not_found off;                                                      
    } 

    location /STORE_CODE {
        rewrite           ^/STORE_CODE/(.*) /$1 break;                               
        proxy_pass        http://localhost:82;                                  
        proxy_set_header  X-Real-IP  $remote_addr;
    }

    location / {
        proxy_pass        http://localhost:81;                                  
        proxy_set_header  X-Real-IP  $remote_addr;
    }
} 
```

然后使用现有配置为端口 81 和 82 创建服务器指令，如下所示：

```
server {
    listen localhost:81 default; # Make sure you change the port here!
... # Same configuration otherwise
}

server {
    listen localhost:82 default; # Make sure you change the port here!
... # Same configuration, except for:

    location ~ .php$ { ## Execute PHP scripts
        if (!-e $request_filename) { rewrite / /index.php last; } ## Catch 404s that try_files miss

        expires        off; ## Do not cache dynamic content
        fastcgi_pass   127.0.0.1:9000;
        fastcgi_param  HTTPS $fastcgi_https;
        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
        fastcgi_param  MAGE_RUN_CODE store_code; ## CHANGE THIS TO YOUR STORE CODE!
        fastcgi_param  MAGE_RUN_TYPE store;
        include        fastcgi_params; ## See /etc/nginx/fastcgi_params
} 
```

您需要将第二家商店的 base_url 设置为`http://www.DOMAIN.com/STORE_CODE/`. Magento 应该负责其余的工作。

希望这可以帮助！

# google-apps-script - Google Apps 脚本：无法弄清楚如何将 7 天添加到日期

> ID：16068803
> 
> 赞同：1
> 
> 时间：2013-04-17T19:42:22.487
> 
> 标签：google-apps-script

我知道这个问题已经被问过很多次了，但我仍然无法弄清楚。我正在尝试将 7 天添加到一天。

我在这里找到了一个例子[：](http://productforums.google.com/forum/#!topic/apps-script/S3O_jioT96A)

正如我所期望的那样，这有效并在日期上增加了一天：

```
 var d = new Date(dateRange[11]);
 d.setDate(d.getDate()+1); 
```

但是当我尝试对数组中的日期做同样的事情时（我最终会遍历这个）：

```
newDates[12] = new Date(newDates[11]);
newDates[12].setDate(newDates[11].getDate()+7); 
```

我收到此错误消息：

```
TypeError: Cannot find function getDate in object Mon Jul 01 2013 00:00:00 GMT-0600 (MDT). 
```

当我调试时，数组中每个项目的类型是“数组”而不是日期。每个数组项中的数据在调试器中如下所示： [(new Date(1372658400000))] 我假设要使用 getDate 函数，这需要是日期而不是数组项。当我展开数组项时，该项嵌套在里面，所以项 [12][0] 是一个日期。我必须以不同的方式引用它吗？

按照这种推理，我尝试了这个：

```
newDates[12][0] = new Date(newDates[11][0]);
newDates[12][0].setDate(newDates[11][0].getDate()+7); 
```

但是在上面代码的第一行，我得到了这个错误：

```
TypeError: Cannot set property "0.0" of undefined to "(class)@1176d9d1". 
```

有人对我如何使它起作用有任何建议吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:59:47.937

为什么不简单地这样呢？

```
newDates[12] = new Date(newDates[11][0]);// take the relevant part of [11]
newDates[12].setDate(newDates[11][0].getDate()+7); // and make [12] a simple date object in the array 
```

出于好奇，这个数组是从哪里来的？

如果您希望 [12] 具有相同的结构（数组元素中的数组），则使用中间变量：

```
var temp = new Date(newDates[11][0]);// take the relevant part of [11]
temp.setDate(newDates[11][0].getDate()+7); // set date to desired value 
newDates[12].push([temp]);// add into [12] 
```

# c++ - 如何记录从源顶点到目标顶点的所有最短路径

> ID：16068811
> 
> 赞同：1
> 
> 时间：2013-04-17T19:42:43.440
> 
> 标签：c++, algorithm, boost, graph, boost-graph

我目前正在使用 Boost 图形库的 dijkstra 算法[http://www.boost.org/doc/libs/1_53_0/libs/graph/doc/dijkstra_shortest_paths.html](http://www.boost.org/doc/libs/1_53_0/libs/graph/doc/dijkstra_shortest_paths.html)来计算一对顶点之间的最短距离路径。到目前为止，我只能获得存储在先行图中的一条最短路径。

所以我的问题是：是否可以让函数返回一对顶点之间所有可能的最短路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:49:26.660

不，您需要自己构建它。一种方法是使用对 Dijkstra 的两次调用来计算从源顶点 s（在 G 中）到汇顶点 t 的距离（即，从转置图中到 t 的距离）。然后，提取一个子图，其中正好包含那些节点 u，使得距离（s，u）+距离（u，t）=距离（s，t）和那些弧 uv，使得距离（s，u）+长度（u，v ) + distance(v, t) = distance(s, t) 并递归枚举该子图中的所有 st 路径。

# jquery - 如何用jquery定位一个类？

> ID：16068821
> 
> 赞同：0
> 
> 时间：2013-04-17T19:43:42.203
> 
> 标签：jquery

我正在使用以下代码：

```
 $("img").hover(function() {
  $(".portfolio4").stop().animate({opacity: "0.8"}, 'slow');
},
function() {
  $(".portfolio4").stop().animate({opacity: "1"}, 'slow');
}); 
```

我正在制作一个响应式的画廊，所以我使用带有“portfolio4”类的 div 来保存我的所有图像。

当我使用上面的代码并将鼠标悬停在一个图像上时，它会淡出所有的投资组合4，而我只希望它只是淡出图像嵌套在其中的实际 div。

希望这有意义吗？

任何帮助将非常感激。我知道这会很简单，但我不知道如何改变它。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:44:39.593

使用[最接近](http://api.jquery.com/closest/)封闭的 div ：

```
$("img").hover(function() {
  $(this).closest(".portfolio4").stop().animate({opacity: "0.8"}, 'slow');
},
function() {
  $(this).closest(".portfolio4").stop().animate({opacity: "1"}, 'slow');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:45:01.083

```
$("img").hover(function() {
  $(this).parents(".portfolio4").stop().animate({opacity: "0.8"}, 'slow');
},
function() {
  $(this).parents(".portfolio4").stop().animate({opacity: "1"}, 'slow');
}); 
```

# java - Java中的mergeTwo CodingBat拼图

> ID：16068825
> 
> 赞同：0
> 
> 时间：2013-04-17T19:43:52.593
> 
> 标签：java, arrays

我正在尝试解决[这个](http://codingbat.com/prob/p139150)CodingBat 问题：

> 从两个字符串数组 A 和 B 开始，每个数组的元素都按字母顺序排列，并且没有重复。返回一个新数组，其中包含两个数组中的前 N ​​个元素。结果数组应按字母顺序排列并且没有重复。A 和 B 都将具有 N 或更大的长度。最好的“线性”解决方案对 A 和 B 进行一次遍历，利用它们按字母顺序排列的事实，将元素直接复制到新数组中。

```
mergeTwo({"a", "c", "z"}, {"b", "f", "z"}, 3) → {"a", "b", "c"}
mergeTwo({"a", "c", "z"}, {"c", "f", "z"}, 3) → {"a", "c", "f"}
mergeTwo({"f", "g", "z"}, {"c", "f", "g"}, 3) → {"c", "f", "g"} 
```

试图：

```
public String[] mergeTwo(String[] a, String[] b, int n) {
    String[] op = new String[a.length + b.length];
    for (int i = 0; i < a.length; i++) {
        op[i] = a[i];
    }
    int j = 0;
    for (int i = 0; i < op.length; i++) {
        if (op[i] == null) {
            j = i;
            break;
        }
    }
    for (int i = 0; i < b.length; i++) {
        op[j] = b[i];
        j++;
    }
    Arrays.sort(op);
    ArrayList<String> help = new ArrayList<String>();

    for (int i = 0; i < op.length - 1; i++) {
        if (op[i] != op[i + 1]) {
            help.add(op[i]);
        }
    }
    String[] res = new String[help.size()];
    for (int i = 0; i < help.size(); i++) {
        res[i] = help.get(i);
    }
    String[] op2 = new String[n];
    for (int i = 0; i < n; i++) {
        op2[i] = res[i];
    }
    return op2;

} 
```

所以问题是所有测试都通过了，除了一个：

[![在此处输入图像描述](https://i.stack.imgur.com/yp4Mu.png)](https://i.stack.imgur.com/yp4Mu.png)

这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:52:52.677

这是有问题的行：

```
 if (op[i] != op[i + 1]) { 
```

您正在寻找一个模式，其中几个相同字符串的 lsst 与下一个字符串不匹配。

在失败的情况下，没有“下一个字符串”，因为正好有 3 个唯一的字符串。

解决这个问题的一种方法是寻找这个字符串与最后一个字符串不同的模式，但您并没有真正检查数组中的最后一个字符串（因为第一个数组元素没有最后一个字符串）。你使用一个变量，比如`last`，来存储最后一个字符串，并且只有当这个元素不等于 时才传输`last`。

试试这个 ...

```
String last = "";
for (int i = 0; i < op.length - 1; i++) {
    if (!op[i].equals(last)) {
        help.add(op[i]);
    }
    last = op[i];
} 
```

另请注意，在 Java 中，字符串与`equals()`方法进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-11T10:59:23.583

使用 Java8，只需几行简单的代码即可完成：

```
public String[] mergeTwo(String[] a, String[] b, int n)
{
    Set<String> set = new HashSet();
    set.addAll(Arrays.asList(a));
    set.addAll(Arrays.asList(b));

    List<String> list = new ArrayList(set);

    return list.subList(0, n).toArray(new String[n]);
} 
```

# autocomplete - IntelliJ IDEA 为自动编译添加命名空间支持

> ID：16068827
> 
> 赞同：2
> 
> 时间：2013-04-17T19:43:54.250
> 
> 标签：autocomplete, intellij-idea

如何为 等添加支持`jsf`命名`custom libraries`空间

我知道，我可以做到`Settings|Project settings| Schemas and DTDs`。但我不知道我应该指出什么`explorer`，`URI: http://java.sun.com/jsf/html`例如。

# c++ - 使用 libopenssl 从私有转储公钥

> ID：16068830
> 
> 赞同：2
> 
> 时间：2013-04-17T19:44:01.370
> 
> 标签：c++, openssl, rsa, private-key, public-key

假设我想在我的 c++ 应用程序中使用类似 openssl 命令的代码。

```
openssl rsa -in private.pem -pubout -outform der -out ./out.pub 
```

我怎样才能做到这一点？

我在 github 上寻找样本并提出了以下方案。

```
key  = PEM_read_bio_RSAPrivateKey(bio, NULL, 0, NULL);
len = i2d_RSAPublicKey(key, &bufp); 
```

它返回的值与我从命令行工具获得的值不同。我想没有从私钥到公钥的转换，它只是保存了私钥。谁能告诉我使用 openssl lib 从私有获取 pub 密钥的正确方法。我也非常感谢任何指向 openssl 的 pub\priv 密钥示例的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T11:10:49.227

最后，我刚刚在 openssl 本身中找到了适当的来源。这正是期间发生的事情

> openssl rsa -in private.pem -pubout -outform der -out ./out.pub

我已经从原始代码中删除了很多检查以使其更小。

```
#include <openssl/pem.h>
#include <openssl/x509.h>

EVP_PKEY *load_key(const char *file)
{
    BIO *key=NULL;
    EVP_PKEY *pkey=NULL;

    key=BIO_new(BIO_s_file());
    BIO_read_filename(key,file);
    pkey=PEM_read_bio_PrivateKey(key,NULL,NULL,NULL);

    return pkey;
}

int _tmain(int argc, _TCHAR* argv[])
{
    BIO *out=NULL;
    out=BIO_new(BIO_s_file());
    EVP_PKEY    *pkey;
    RSA *rsa=NULL;

    char *infile = path_to_pem;
    char *outfile = path_to_der;

    pkey = load_key(infile);

    if (pkey != NULL)
        rsa = EVP_PKEY_get1_RSA(pkey);
    EVP_PKEY_free(pkey);

    BIO_write_filename(out,outfile);

    i2d_RSA_PUBKEY_bio(out,rsa);
} 
```

# java - 粒子模拟器 Java

> ID：16068832
> 
> 赞同：0
> 
> 时间：2013-04-17T19:44:02.407
> 
> 标签：java, swing

我知道我做错了什么，但我找不到到底是什么（漫长的一天编码）。

我需要实现粒子模拟器。我有一些课程，我需要在右键单击时创建几个发射器。

一些代码：

```
public final class Viewport extends JComponent implements ActionListener {

  private AffineTransform transform = new AffineTransform();
  private ArrayList particleList = new ArrayList();
  ParticleEmitter emitter1;
  private Timer timer;
  double x;
  double y;

  public Viewport() {
    particalEmitterImport();
  }

  public void particalEmitterImport() {

    initComponents();
    timer = new Timer(30, this);
    emitter1 = new ParticleEmitter(3);
    timer.start();
    timer.setInitialDelay(0);
    //repaint();
    x = 0;
    y = 0;
    transform.setToIdentity();
  }

  public void particalEmitterImport(int mouseX, int mouseY) {

    initComponents();
    timer = new Timer(30, this);
    emitter1 = new ParticleEmitter(3);
    timer.start();
    timer.setInitialDelay(0);

    x = mouseX;
    y = mouseY;
    transform.setToIdentity();
  } 
```

* * *

主类：

```
private void viewportMouseClicked(java.awt.event.MouseEvent evt) {                                      
    Viewport vw = new Viewport();
    if (SwingUtilities.isRightMouseButton(evt)) {
        xMouse = evt.getX();
        yMouse = evt.getY();
        vw.particalEmitterImport(xMouse, xMouse);
        vw.setLocation(xMouse,yMouse);
        System.out.println("CLICK");
        System.out.println(xMouse);
        System.out.println(yMouse);
        vw.setVisible(true);
    } 
```

问题是我看不到我的发射器，但在输出中我看到了我从事件中获得的所有值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T19:48:16.580

```
w.particalEmitterImport(xMouse, xMouse);
                                ^^^^^^ 
```

我想你说：

```
w.particalEmitterImport(xMouse, yMouse);
                                ^^^^^^ 
```

# java - 在 Android 中读取 XML 文件时遇到问题

> ID：16068834
> 
> 赞同：0
> 
> 时间：2013-04-17T19:44:07.767
> 
> 标签：java, android, xml, inputstream, assets

我正在尝试通过 DOM 解析器解析 XML 文件。但是，我很难让我的主要活动实际读取文件。我读过我应该将文件放在 Assets 中，然后用 getAssets() 调用。我用过这样的东西：

```
InputStream is = this.getAssets().open("myXML.xml"); 
```

这只会导致错误：启动 logcat 时出现意外错误。尝试重新选择设备。] 找不到设备。

我还尝试了 new File("myXML.xml") 使用绝对路径的变体。似乎没有任何效果。我有点沮丧。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:26:50.667

在我看来，好像您的 IDE 与您尝试测试应用程序的模拟器或设备没有连接。

LogCat 是一个日志输出流，任何应用程序都可以使用它来打印信息/日志。LogCat 需要（通过 ADB）连接到您的设备。

如果您没有连接真正的手机，您可以使用模拟器：

```
/path/to/your/androidSDK/tools/android 
```

此 SDK 管理器可帮助您创建新的 AVD（Android 虚拟设备）。单击工具> 管理 ACD> 新建...

如果您的计算机连接了真正的手机或平板电脑，请尝试重新启动 ADB（应该可以从您的 IDE 中）或使用命令行。

切换到安装 Android SDK 的目录（在 Windows 中类似）：

```
c:\Program Files\Android\android-sdk-windows\platform-tools\ 
```

在 linux 上可能是：

```
/opt/android-sdk-linux/platform-tools/ 
```

然后输入（win和linux）

```
adb kill-server
adb start-server 
```

# hook - Procmon 如何在 64 位 Vista+ 上工作？

> ID：16068842
> 
> 赞同：2
> 
> 时间：2013-04-17T19:44:35.143
> 
> 标签：hook, driver, etw, minifilter, procmon

我了解较旧的 Procmon 及其前身（filemon、regmon 等）使用虚拟驱动程序来挂钩内核。但是，Patchguard 在 64 位 Vista+ 上阻止 SSDT 挂钩等。

据我了解，Procmon 现在使用 minifilter 驱动程序进行文件 IO 监控，使用 ETW 进行网络监控。但是，我不清楚它如何监控注册表访问和进程/图像/线程事件？它是否也对这些使用 ETW？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T14:36:22.057

内核中有很多用于监控支持的回调（从 xp 开始）：

*   注册表-> [http://msdn.microsoft.com/en-us/library/windows/hardware/ff545879(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff545879(v=vs.85).aspx)

*   进程/图像/线程通知 - PsSetCreateProcessNotifyRoutineEx / PsSetLoadImageNotifyRoutine / PsSetCreateThreadNotifyRoutine -> [http://msdn.microsoft.com/en-us/library/windows/hardware/ff559917(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff559917(v=vs.85).aspx)

*   用于句柄监视的对象管理器回调-> [http://msdn.microsoft.com/en-us/library/windows/hardware/ff558692(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff558692(v=vs.85).aspx)

在 xp 上是一些限制，但由于 vista 他们功能齐全。无需为任何监控活动修补任何内部表。

# perl - 创建 perl 脚本以模仿 linux 命令“ifconfig”的问题

> ID：16068844
> 
> 赞同：0
> 
> 时间：2013-04-17T19:44:45.733
> 
> 标签：perl, perl-module, cpan, ifconfig

我有一个任务，我要在 Linux 中创建一个 Perl 脚本来模仿命令`ifconfig`。该命令主要显示有关网络接口的信息。我已经创建了该程序，但是有几行代码给了我一些问题，如果有人可以为我更正代码，我将不胜感激。我得到的错误说`$get_iface_data requires an explicit package name at line 8`，但是我不知道如何声明。

```
#!/usr/bin/perl
use strict;
use warnings;
use Net::Int::Stats;
use Net::Ifconfig::Wrapper;

my $Iface   = $ARGV[0];
my $rx_packets  = $get_Iface_data->value($Iface, 'rx_packets');
my $Iface_Info = Net::Ifconfig::Wrapper::Ifconfig('list', '', '', '');
print "\tether ". $Iface_Info->{$Iface}{'ether'}."\n"; 
```

我的任务基本上要求我获取一个接口作为输入，并显示有关该接口的信息，就像`ifconfig`命令一样。我还使用了两个包，`Net::Int::Stats`和`Net::Ifconfig::Wrapper`. 我的脚本和命令之间的唯一区别`ifconfig`是我的脚本需要一个接口作为参数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:19:13.980

好吧，你在哪里定义的`$get_Iface_data`？

这`$foo->bar`是一种方法调用语法。这意味着这`$foo`是某种*对象*，并且`bar`是可以在该对象上使用的方法。

你了解面向对象编程以及 Perl 如何使用它吗？Perl 有一个很好的[教程](http://perldoc.perl.org/perlobj.html)可以帮助你入门。

这样做的结果是，除了该类的对象之外，您不能使用特定的方法（想想子例程）。从这段代码和你的错误状态来看，你从来没有定义过`$get_Iface_data`，所以你必须定义它。在这种情况下，您必须*创建*对象：

```
my $get_Iface_data = Net::Int::Stats->new(); 
```

现在，您可以在对象上使用各种`Net::Int::Stats` *方法*`%get_Iface_data`：

```
my $rx_packets  = $get_Iface_data->value($Iface, 'rx_packets'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T21:16:41.457

您只是缺少创建 Net::Int::Stats 对象的行：

```
#!/usr/bin/perl
use strict;
use warnings;
use Net::Int::Stats;
use Net::Ifconfig::Wrapper;

my $Iface   = $ARGV[0];
my $get_Iface_data = Net::Int::Stats->new();
my $rx_packets  = $get_Iface_data->value($Iface, 'rx_packets');
my $Iface_Info = Net::Ifconfig::Wrapper::Ifconfig('list', '', '', '');
print "\tether ". $Iface_Info->{$Iface}{'ether'}."\n"; 
```

# php - 我的注册功能有什么问题？

> ID：16068846
> 
> 赞同：-2
> 
> 时间：2013-04-17T19:44:55.060
> 
> 标签：php, mysql, pdo

**问题与说明**

您好，我刚刚编写了一个`function`首先`checking if account exists in database`使用该名称的代码，然后如果数据库中存在带有该输入电子邮件的电子邮件。

如果没有，`return true + insert data`.

但是在这种情况下`nothing happens on submit`，它只显示表单，但不插入数据..它有什么问题？

```
function createAccount($name, $password, $email)
{
    global $pdo;

    $check_in = $pdo->prepare("SELECT * FROM users WHERE user_name = :username LIMIT 1");
    $check_in->execute( array(':username' => $name) );

    if (!$check_in->rowCount())
    {
        $check_in = email_exists($email);
        if ($check_in === false)
        {
            $insert_in = $pdo->prepare
            ("
                INSERT INTO 
                users 
                (user_name, user_password, user_email) 
                VALUES 
                (:name, :password, :email)
            ");
            $insert_in->execute( array 
            (
                ':name' => $name,
                ':password' => $password,
                ':email' => $email
            ));

            return true;
        }
        else
        {
            return 'exists';
        }
    }
    else
    {
        return 'user_in_use';
    }   
}

function email_exists($email)
{
    global $pdo;

    $check = $pdo->prepare("SELECT * FROM users WHERE user_email = :email LIMIT 1");
    $check->execute( array(':email' => $email) );
    if ($check->rowCount())
    {
        return true;
    }
    else
    {
        return false;
    }
} 
```

这就是我组成寄存器的方式：

```
# Creating shortcuts
if (isset($_POST['username']) && isset($_POST['password']) && isset($_POST['email']))
{   
    $name = $_POST['username'];
    $password = $_POST['password'];
    $email = $_POST['email'];
}

# Creating errors array

$errors = array();

if (isset($_POST['submit']))
{
    $check_in = createAccount($name, $password, $email);

    if ($check_in === true)
    {
        echo 'Created account sucessfully!';
    }
    else if ($check_in == 'already_in_use')
    {
        echo 'Could not create account because name already in use..';
    } 
    else if($check_in == 'exists')
    {
        echo 'Email already in use..';
    }
} 
```

**问题：**

这段代码有什么问题&我该如何解决？我完全没有错误。它只是不会将任何数据插入数据库。

是的，PDO 连接和语句是正确的，因为登录完美。非常感谢！

编辑！

```
 if ($check_in === true)
    {
        echo 'Created account sucessfully!';
    }
    else if ($check_in == 'already_in_use')
    {
        echo 'Could not create account because name already in use..';
    } 
    else if($check_in == 'exists')
    {
        echo 'Email already in use..';
    } else { 
    echo 'Error is there...'; 
    } 
```

它正在回显“那里有错误...” apon submit！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-17T20:32:05.727

我只想扇自己一巴掌！.....问题是：这些字段被设置为INT，因此我们只能存储整数......

# php - Github 通过 ubuntu 中的 shell_exec 拉取不工作

> ID：16068847
> 
> 赞同：2
> 
> 时间：2013-04-17T19:44:57.627
> 
> 标签：php, ubuntu, github, shell-exec, pull

嗨，我正在尝试在 Github 中设置 WebHook。

我已经使用了这些说明：

[http://net.tutsplus.com/tutorials/other/the-perfect-workflow-with-git-github-and-ssh/](http://net.tutsplus.com/tutorials/other/the-perfect-workflow-with-git-github-and-ssh/)

但由于某些原因，我无法通过我的 php 文件进行拉取。

但是，如果我通过 ssh 登录并运行：

`$ php git-hook.php`

它正确地进行了拉动，但如果从 Github 调用或仅通过浏览器直接加载页面，则不会这样做。

我已经设置`chmod`为`777`.

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T16:07:35.040

有人在教程页面的评论中提到了这个问题。你试过这个解决方案吗？[http://www.tegdesign.com/git-webhook-php-post-receive-pull-method/](http://www.tegdesign.com/git-webhook-php-post-receive-pull-method/)

无论如何，本教程展示了如何使用 SSH url 克隆 repo。如果这是预览服务器并且您仅用作预览，则可以使用 HTTP url 进行克隆。

改变这种克隆方式：

```
git clone git@github.com:Your-User-Name/awesomeProject.git 
```

对此：

```
git clone https://github.com/Your-User-Name/awesomeProject.git 
```

# html - 两个图像和两个文本行排列

> ID：16068854
> 
> 赞同：0
> 
> 时间：2013-04-17T19:45:28.973
> 
> 标签：html, css

我有两个`<img>`和两个`<p>`（基本字幕文本）

我想在 css 中将它们格式化为这样排列：

```
<img1>   <img2>
<text1>  <text2> 
```

基本上，两张图片下面有两个标题。

我知道这很简单，但我尝试过的一切都没有奏效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T19:49:05.390

这是非常基本的东西：

HTML

```
<div>
    <img src="http://www.placekitten.com/100/100" />
    <p>Text</p>
</div>
<div>
    <img src="http://www.placekitten.com/100/100" />
    <p>Text</p>
</div> 
```

CSS

```
div {
    float:left;
    text-align:center;
    margin:20px;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/PwKRT/)**

本质上，您将图像/文本对包装在 div 中并将 div 向左浮动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:49:00.623

你基本上可以用这种方式做到这一点：

**HTML**

```
<ul class="images">
   <li>
       <img src="/path/to/img1" /><br/>
       <p>Your caption here</p>
   </li>
   <li>
       <img src="/path/to/img2" /><br/>
       <p>Your caption here</p>
   </li>
</ul> 
```

**CSS**

```
.images{
  list-style-type:none;
}
.images li{
   float:left;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T19:54:05.523

```
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.img-caption
{
float:left;
width:120px;
margin:0 0 15px 20px;
padding:15px;
border:1px solid black;
text-align:center;
}
</style>
</head>

<body>
<div class="img-caption">
<img src="image-name.gif" width="95" height="84" alt="" /><br>
CSS is fun!
</div>

<div class="img-caption">
<img src="image-name.gif" width="95" height="84" /><br>
CSS is fun!
</div>

</body>
</html> 
```

# jquery - jQuery Megamenu 位置对齐

> ID：16068857
> 
> 赞同：0
> 
> 时间：2013-04-17T19:45:31.120
> 
> 标签：jquery, alignment, megamenu

[http://www.osep2.uga.edu/EE/Home](http://www.osep2.uga.edu/EE/Home)

如何使 megamenu 下拉菜单与容器的左侧对齐？目前，它们与整个页面左对齐。如果我将位置更改为相对位置，则不再出现下拉菜单。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:52:40.623

所以看起来 jkmegamenu 会自动强制你的盒子在你的容器之外，即使你把它们放在你的代码里面。虽然我不建议使用这样的东西，但您可以使用一些 jQuery 在代码底部进行修复。

```
// Gets your left offset of the container div
var fromLeft = $('#container').offset().left;

// move all menus to this new offset
$('#megamenu1').css('left', fromLeft);
$('#megamenu2').css('left', fromLeft);
$('#megamenu3').css('left', fromLeft);
$('#megamenu4').css('left', fromLeft);
$('#megamenu5').css('left', fromLeft); 
```

请记住，这是一个简单的修复。它仅适用于浏览器当前大小。如果它发生变化，偏移量保持不变，您将不得不重做数字。为了将来参考，我会做一些更传统的事情，比如[这个](http://net.tutsplus.com/tutorials/html-css-techniques/how-to-build-a-kick-butt-css3-mega-drop-down-menu/)

# android - 如何识别 Android 设备上的用户？

> ID：16068863
> 
> 赞同：3
> 
> 时间：2013-04-17T19:45:58.207
> 
> 标签：android, oauth-2.0, accountmanager

我创建了一个应用程序，用户可以在其中执行某些操作，例如评论、赚取积分等。我需要将这些数据存储在在线数据库中（该应用程序链接到一个网站），因此我需要以某种方式识别用户。我找到了以下方法：

1.  注册/登录 - 我认为用户不太喜欢这个选项，因为它在手机上不舒服
2.  AccountManager - 我读到这有[问题](https://stackoverflow.com/questions/5126207/how-to-get-user-own-email-addresses-stored-in-the-device)
3.  OauthToken - 我刚刚下载了一个应用程序，它在打开时询问我是否允许它使用我的电子邮件地址。此权限可能会吓跑许多用户。顺便说一句，它如何识别用户？
4.  存储 IMEI - 这不是一个选项，因为它识别的是设备，而不是用户，而且许多平板电脑没有 IMEI 号码

是否有其他方法来识别用户？我想避免使用 GET_ACCOUNTS 权限来获取用户的电子邮件地址，如果我可以在没有权限的情况下链接一个唯一的 ID 是最好的。我认为用户在首次启动应用程序时不希望他们的电子邮件地址出现在屏幕上（作为 id）。（请注意，我只想要一个id，不需要密码）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:49:48.277

有一个很好的教程介绍了实现您想要的最佳实践：

[http://android-developers.blogspot.com.br/2011/03/identifying-app-installations.html](http://android-developers.blogspot.com.br/2011/03/identifying-app-installations.html)

SO中也有类似的问题：

[是否有唯一的 Android 设备 ID？](https://stackoverflow.com/questions/2785485/is-there-a-unique-android-device-id)

# java - 同步 servlet 处理对分布式服务器端应用程序有意义吗

> ID：16068864
> 
> 赞同：0
> 
> 时间：2013-04-17T19:45:58.160
> 
> 标签：java, jakarta-ee, servlets, asynchronous, synchronous

这个问题的范围/上下文：我要开发一个基于 Java/Java EE 的分布式服务器端应用程序，它是可扩展[的（向上扩展，](http://en.wikipedia.org/wiki/Scalability#Horizontal_and_vertical_scaling)而不是向外扩展）。

我的应用程序由使用分布式后端服务的多个实例来处理客户端请求的 servlet 组成。如果我需要实现更高的吞吐量，我希望能够添加更多这些分布式服务**的**实例（**同一台或另一台机器上的 JVM**）并（期望）看到吞吐量的增加。

为了实现这一点，我正在考虑一个松散耦合的异步系统。我想我会使用 Async Servlets (servlet 3.0) 和一个应用程序管理的线程池，它将客户端请求放在 JMS 队列上，由分布式服务实例之一选择并处理。可以使用 JMS 将响应从服务实例转发回 servlet 容器中的响应线程。

然而，异步系统似乎（显然）比同步系统更复杂（例如：错误处理和错误中继到客户端、请求跟踪等）。我也担心设计/代码的未来可维护性。

因此，出现了一个问题， **同步执行此操作是否有意义，同时仍保持分布式、可扩展和松散耦合**？如果答案是肯定的，那么请分享实现这一目标的可能方法（同时保持“建设性”）。

如果我能以同步的方式很好地做到这一点，那么它将简化整个系统。我不想不必要地增加系统的复杂性。

（假设它是有道理的）我能想到的一种可能的实现是使用 RMI。例如：分布式服务实例的服务注册表，用于注册并让负载均衡器在所有可用实例之间分配 RMI 调用。但感觉是老一代的解决方案。有没有更好的选择？

编辑：有关此问题范围的其他详细信息：

*   客户端是基于浏览器的，不需要异步服务器端。
*   我不需要服务器推送。
*   在任何时候，我都不会比流行的 Web 服务器（甚至 Apache）的 max-worker-threads 有更多的未完成请求。
*   由于上述原因，[相关问题](https://stackoverflow.com/questions/2162783/asynchronous-servlets-vs-synchronous-servlets?rq=1)中提到的用例似乎不适用于我的场景。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:01:55.077

松散耦合和分布与处理是同步的还是异步的无关。

有了可扩展性，事情就变得更加复杂了。在同步模型中，每个待处理的请求都需要一个线程。如果您需要扩展到非常高的负载（例如，每台服务器有数千个并发请求），异步模型可能会更好地扩展。然而，为了从中受益，从处理传入连接开始的整个处理都需要以异步方式完成。将同步请求处理线程委托给异步线程池并阻塞直到该线程池计算出结果是没有意义的——毕竟，请求线程也可以自己完成工作。

如果您需要返回响应，那么只要可扩展性允许（通常会这样做），我就会进行同步请求处理。

编辑：有很多方法可以与分布式后端服务器通信。您可以简单地使用 EJB（如果我没记错的话，它在后台使用 RMI）。或者，您可以在负载均衡器后面使用 Web 服务。

# facebook - Facebook 和经典 ASP - 将自定义参数传递给粉丝页面选项卡 - 没有数据的错误

> ID：16068867
> 
> 赞同：0
> 
> 时间：2013-04-17T19:46:01.560
> 
> 标签：facebook, facebook-graph-api, asp-classic, base64

我们的应用程序使用此代码工作（[是否可以将参数传递给通过选项卡访问的 FB 应用程序的回调 URL？](https://stackoverflow.com/questions/4634102/is-it-possibile-to-pass-parameters-to-the-callback-url-of-a-fb-app-which-is-acce)），但是当没有传入 app_data 参数时会出现问题。这是一个示例我们的意思：

工作正常：（“测试”写得很好） [https://www.facebook.com/phillypours/app_397493550309543?app_data=test](https://www.facebook.com/phillypours/app_397493550309543?app_data=test)

不工作： [https ://www.facebook.com/phillypours/app_397493550309543](https://www.facebook.com/phillypours/app_397493550309543)

与 Base64 编码和 JSON 解码一起使用的代码：

```
myArray = Split(Request("signed_request"), ".")
encoded_sig = myArray(0)
payload = myArray(1)
sig = base64_decode(Replace(encoded_sig, "-_", "+/"))
set data = JSON.parse(base64_decode(Replace(payload, "-_", "+/")))
Response.Write data.app_data 
```

这是我们在没有传入参数时收到的错误：

```
Object doesn't support this property or method: 'data.app_data' 
```

有人对如何为此设置陷阱有任何想法吗？我不能对“data.app_data”做任何事情，因为这是引发错误的原因。

任何帮助将不胜感激！！！

谢谢你。

丹尼斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:58:12.270

我找到了解决这个问题的方法。想分享给别人可以受益。谢谢，丹尼斯

```
<!--#INCLUDE VIRTUAL="/includes/fb_base64.asp"-->
<!--#INCLUDE VIRTUAL="/includes/fb_json_decode.asp"-->

Function parsePageSignedRequest()
    If Request("signed_request") <> "" Then
        myArray = Split(Request("signed_request"), ".")
        payload = myArray(1)
        payload_decoded = base64_decode(payload)
        set data = JSON.parse(payload_decoded)

        If instr(payload_decoded,"""app_data""") Then 
            AppData = data.app_data
        End If
        If instr(payload_decoded,"liked"":true,") Then
            LikeStatus = True
        End If
    End If
End Function 
```

# python - Bakeoff 第 2 部分：使用 Cython 类型的 Memoryviews 进行数学运算

> ID：16068869
> 
> 赞同：1
> 
> 时间：2013-04-17T19:46:03.230
> 
> 标签：python, performance, numpy, cython, lda

我似乎无法做一些简单的事情，比如将值添加到存储在内存视图中的值数组中。我知道这不是类型化的内存视图应该做的。但是将内存视图转换回 np.array 比乌龟放牧猫要慢。

当我尝试编写如下 cdef 函数时：

```
cdef double[::1] _add(self,double[::1] arr,double val):
  cdef double[::1] newarr
  cdef int i, n
  #n = sizeof(arr)/sizeof(arr[0])
  newarr = np.empty(5)
  for i in xrange(n):
    newarr[i] = arr[i] + val
    return newarr 
```

我收到错误说内存视图不连续。

> “ValueError：缓冲区和内存视图在同一维度上不连续。”

如果传递的内存视图不是已切片的，这实际上确实有效。但它增加了 10 秒的过程！

# android - 从 Android GPS 获取速度

> ID：16068870
> 
> 赞同：0
> 
> 时间：2013-04-17T19:46:17.350
> 
> 标签：android, service, gps

我想从我的应用程序中的 LocationManager 中获得速度。我有一个带有 setSpeedRequired(true) 属性的条件。我正在做 location.getSPeed()，但它一直给我 0。下面是我作为服务运行的 GPS 的代码。

```
public class Tracking extends Service implements LocationListener {

    protected LocationManager locationManager;
    Location location;
    double latitude;
    double longitude;
    float velocity;
    String provider;

    private static final long minDist = 0;
    private static final long minTime = 0;
    LocationDatabaseHandler ldb;

    @Override
    public void onCreate() {
        ldb = new LocationDatabaseHandler(this);
        getLocation();
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
    }

    @Override
    public void onProviderDisabled(String provider) {

    }

    @Override
    public void onProviderEnabled(String provider) {

    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {

    }

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        super.onStartCommand(intent,flags,startId);
        //because we do not want to stop the service unless we explicitly say so.
        return START_STICKY;
    }

    public Location getLocation() {
        locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        Criteria criteria = new Criteria();
        criteria.setSpeedRequired(true);
        provider = locationManager.getBestProvider(criteria, false);

        locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, minTime, minDist,
                this);
        location = locationManager.getLastKnownLocation(provider);
        if(location != null) {
            onLocationChanged(location);            
        }

        return location;        
    }

    @Override
    public void onLocationChanged(Location location) {
        latitude = location.getLatitude();
        longitude = location.getLongitude();
        batteryP = getBatteryPerc();
        velocity = location.getSpeed();

        insertIntoDb(latitude, longitude, velocity, "onchanged");
    }

    public void insertIntoDb(double latitude, double longitude, float velocity, String where) {
        Date date = new Date();
        String dateStr = date.toString();

        ldb.addLocation(new Locations(latitude, longitude, dateStr, velocity));
    }

} 
```

当我看到我的数据库时，速度总是 0.0。有什么我想念的吗？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2014-03-10T22:01:04.790

locationManager.requestLocationUpdates(provider, minTime, minDist, this);

# php - 通过php填充多个选择框jquery mobile

> ID：16068875
> 
> 赞同：0
> 
> 时间：2013-04-17T19:46:37.073
> 
> 标签：php, jquery, json, jquery-mobile, jquery-mobile-select

我发现这个链接适用于 jquery 但不适用于 jquery-mobile 多选

[链接到其他帖子](https://stackoverflow.com/questions/10870667/populate-select-box-from-database-using-jquery)

我可能会出错的任何想法。一旦我添加多个 =“多个”，我就没有显示任何结果。另外，如果我丢失了它，我没有得到 jquery 移动主题，但我确实得到了我的列表

html

```
<!DOCTYPE HTML>
<html>
<head>
      <meta charset="utf-8" />
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <title>
        </title>
        <link rel="stylesheet" href="css/logout-button.min.css" />
         <link rel="stylesheet" href="css/jquery.mobile-1.3.0.min.css" />
        <link rel="stylesheet" href="css/my.css" />
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        </script>
        <script src="js/jquery.mobile-1.3.0.min.js"></script>
        <script src="js/jquery.cookies.2.2.0.min.js"></script>
</head>

<body>
<div data-role="page" id="index4">

           <div data-theme="a" data-role="header">
        <a data-role="button" data-direction="reverse" data-rel="back" data-transition="slide"
         data-icon="arrow-l" data-iconpos="left" class="ui-btn-left">
            Back
        </a>
        <h3>
           Event Details
        </h3>
    </div>

         <div data-role="content">
             <form id="eventForm" name="eventForm">

                    <div data-role="fieldcontain">
<script type="text/javascript">
$(document).on("pagebeforeshow", "#index4", function() {
$(function(){
      var items="";
      $.getJSON("event-details.php",function(data){
        $.each(data,function(index,item) 
        {
          items+="<option value='"+item.email+"'>"+item.username+"</option>";
        });

        $("#a1_title").html(items); 
        $("#a1_title").trigger("change");
      });
    });
  });  
</script>
        <select id="a1_title"  multiple="multiple">
        </select>
            </div>
                    <div data-role="fieldcontain">
                        <label for="manual">Add Emails</label>
                        <textarea cols="40" rows="8" name="emails" id="emails"></textarea>
                    </div>
                        <input type="submit" value="Submit" id="submitEventButton">
                </form>
        </div>
</div>  
</body>
</html> 
```

我的PHP

```
require_once("../backend/functions.php");
dbconn();
                            $id = $CURUSER["id"];
                            $res = "SELECT email,username FROM users left join cal_contacts on cal_contacts.contactid = users.id WHERE cal_contacts.userid = $id";
                            $res1 = mysql_query($res);
                        $data = array();
                            while($row = mysql_fetch_array($res1))
                            { 
                            $data[] = $row;

                            }
                            echo json_encode($data); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:15:39.053

jQuery Mobile 与经典的多选框有点不同。

你没有做错任何事，你缺少一个额外的属性。没有它，jQuery Mobile 多选无法成功创建。

额外需要的属性是这个：

```
data-native-menu="false" 
```

工作示例：http: [//jsfiddle.net/Gajotres/dEXac/](http://jsfiddle.net/Gajotres/dEXac/)

```
$(document).on('pagebeforeshow', '#index', function(){    
    // Add a new select element    
    $('<select>').attr({'name':'select-choice-1','id':'select-choice-1','multiple':'multiple', 'data-native-menu':'false'}).appendTo('[data-role="content"]');
    $('<option>').html('Select option!').appendTo('#select-choice-1');
    $('<option>').attr({'value':'1'}).html('Value 1').appendTo('#select-choice-1');
    $('<option>').attr({'value':'2'}).html('Value 2').appendTo('#select-choice-1');    
    // Enhance new select element
    $('select').selectmenu();
}); 
```

还有一件事，你不需要使用：

```
$("#a1_title").trigger("change"); 
```

在你的情况下这是一个矫枉过正，你只需要增强一个动态选择，这样做：

```
 $('select').selectmenu(); 
```

要了解更多信息，请查看我的另一篇文章：**[jQuery Mobile：动态添加内容的标记增强](https://stackoverflow.com/a/14550417/1848600)**

# java - 如何对方法的结果强加十进制格式？

> ID：16068876
> 
> 赞同：2
> 
> 时间：2013-04-17T19:46:42.627
> 
> 标签：java, decimalformat

我有这个代码：

```
public double theInterest(){     
        return (accountBalance*i) +accountBalance; 
```

我的问题是，有没有办法可以将 DecimalFormat 强加到等式的结果，以便它显示最多 2 个小数位？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T19:48:44.180

您的问题已发布为无法回答，因为该方法返回一个双精度值，而 DecimalFormat 只能返回一个字符串。尝试返回格式化的*double*是没有意义的。我不建议您更改方法，但考虑创建一个单独的方法，例如`getInterestString()`获取 的结果`theInterest()`，并使用您的 DecimalFormatter 对其进行格式化，然后返回此格式化字符串。

IE，

```
public String getInterestString() {
  NumberFormat moneyFormat = NumberFormat.getCurrencyInstance();
  return moneyFormat.format(theInterest();
} 
```

或者更一般地说，

```
private NumberFormat moneyFormat = NumberFormat.getCurrencyInstance();

public String currencyFormat(double numberValue) {
  moneyFormat.format(numberValue);
} 
```

编辑：正如 svc 所说，您应该努力避免使用浮点数进行货币计算，因为不准确很重要。最好使用 BigDecimal。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T20:03:21.970

您根本不应该将`double`其用于财务工作。通常，您使用 a`BigDecimal`您的数字按您所在国家/地区的最低货币单位计价：

```
BigDecimal tenDollars = new BigDecimal(1000L, 2);
// Alternatively, use the BigDecimal(BigInteger, int) constructor. 
```

您可以使用`MathContext`s 设置舍入模式。在内部，您将 Bi​​gDecimal 存储为您的货币值；只有当您向用户显示时，您才会使用格式转换为字符串。

# python - 如何制作不是线性或对数的特定轴？

> ID：16068883
> 
> 赞同：2
> 
> 时间：2013-04-17T19:47:02.817
> 
> 标签：python, matplotlib, plot, axes

我想复制这个轴（见图），我有一个从 1 到 10 的值范围 - 这是什么格式，如何在 matplotlib 中实现？

![在此处输入图像描述](https://i.stack.imgur.com/5hEcO.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T20:05:23.153

```
import matplotlib.pyplot as plt
import matplotlib.ticker as ticker
import numpy as np

fig, ax = plt.subplots()
x = np.linspace(1, 11, 100)
y = np.sin(x)
ax.plot(x, y)
ax.set_xscale('log')
ax.xaxis.set_major_formatter(ticker.ScalarFormatter())
ax.xaxis.set_major_locator(ticker.FixedLocator([1, 3, 6, 10]))
ax.set_xlim(0, 11)
plt.show() 
```

![在此处输入图像描述](https://i.stack.imgur.com/Txp6l.png)

# php - 未调用 Jquery 函数

> ID：16068885
> 
> 赞同：0
> 
> 时间：2013-04-17T19:47:03.650
> 
> 标签：php, jquery

我有 jquery 函数，它调用 php 脚本从我的 mysql 数据库中获取一些数据，jquery 函数调用如下：

```
$(document).ready(function(){
  getTopFiveDeals(); 
```

当它运行时，它会很好地获取数据并构建一些 HTML 并将其插入到网页中。如下所示：

```
 $('ul.special-list').append("<li><a href='#' class=restaurantItem  restaurant= '" + item.estName + "' adddress='" + item.estAddr + "'><img src= " + item.img_link + 
        " width='60' height='60' alt='" + item.estName + "'><div class='img-det'><strong class='title'> " + item.title + " </strong><p> " + item.desc_short +
        " <br>Expires: " + item.expiry_date + " </p><em class='price'>" + item.price + "</em></div></a><a href='dealDetail.html?id=" + item.id +
        "' class='det-link'>Detail</a>"); 
```

当我在下面有一个简单的 jquery 函数时，问题就开始了。该函数没有被调用，而是页面重新加载到 index.html#

```
$("a.restaurantItem").click(function (event) {
  alert('Hello');
} 
```

任何帮助和/或建议将不胜感激。

非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T19:48:39.207

`$("a.restaurantItem")`被调用一次。它不寻找新元素。您需要使用事件委托语法`.on()`来匹配那些动态创建的元素：

```
$('ul.special-list').on('click', 'a.restaurantItem', function(e) {
    e.preventDefault();  // To stop the link from redirecting the browser
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T19:48:39.040

您将需要动态元素的委托事件处理程序，并防止锚点上的默认操作（以避免滚动到顶部或跟随 href）

```
$('ul.special-list').on('click', 'a.restaurantItem', function(event) {
    event.preventDefault();
    alert('Hello');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T19:49:54.993

用`.on()`这种方式

```
$(document).on('click',"a.restaurantItem",function (event){
    event.preventDefault();
    alert('Hello');
}); 
```

# backbone.js - 使用来自其他视图的模型创建主干视图

> ID：16068886
> 
> 赞同：0
> 
> 时间：2013-04-17T19:47:05.607
> 
> 标签：backbone.js, handlebars.js

**背景：**

我正在对使用带有 Handlebars 的主干.js 作为模板引擎的应用程序进行更改。在更改事件触发后，我需要创建附加到当前 DOM 结构的 html，这基本上只是模型中包含的信息的吐出。这种变化需要适应已经建立的应用程序结构。

**问题：**

我创建了一个使用 Handlebars 模板和模型来创建 html 的新视图。然后我实例化该视图并调用渲染函数并使用 JQuery 附加输出。我注意到的是，当呈现 html 时，传入的模型是因为 $el 上的属性而不是填写模板（就像我认为应该的那样）。

**查看我正在更改：**

```
$.hart.TestView = Backbone.View.extend({
    tagName: "li",
    template: Handlebars.compile($('#templateOne').html()),
    initialize: function () {
        this.model.on('change', function () {
            this.createMoreInfoHtml();
        }, this);
    },
    selectSomething: function () {
        this.$el.removeClass('policies');

        this.createMoreInfoHtml(); //function created for new view stuff
    },
    createMoreInfoHtml: function () {
        var id = this.$el.attr('data-id', this.model.get("ID"));
        $('.info').each(function () {
            if ($(this).parent().attr('data-id') == id 
                $(this).remove();
        });

        var view = new $.hart.NewView(this.model, Handlebars.compile($("#NewTemplate").html()));
        $('h1', this.$el).after(view.render().el);
    },
    render: function () {
        ... //render logic
    }
}); 
```

**我创建的视图：**

```
$.hart.NewView = Backbone.View.extend({
        initialize: function (model, template) {
            this.model = model;
            this.template = template;
        },
        render: function () {
            this.$el.html(this.template({ info: this.model }));
            this.$el.addClass('.info');
            return this;
        }
    }); 
```

**Json 是模型：**

```
{
        "PetName":"Asdfasdf", 
        "DateOfBirth":"3/11/2011 12:00:00 AM",      
        "IsSpayNeutered":false, 
        "Sex":"F", 
        "SpeciesID":2, 
        "ID":"ac8a42d2-7fa7-e211-8ef8-000c2964b571"
    } 
```

**模板**

```
<script id="NewTemplate" type="text/html">
        <span>Pet Name: </span>
        <span>{{this.PetName}}</span>
    </script> 
```

所以现在的问题是：我做错了什么？为什么模型的属性被创建为 $el 上的属性而不是填充模板？有人可以指导我如何获得我正在寻找的结果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:43:40.680

让我们跳过杰克注意到的问题。
您创建视图的方式是错误的。当您在初始化函数中获得预期的参数时，它可能会起作用，但它具有您看不到的意外行为。查看视图的构造函数：

```
var View = Backbone.View = function(options) {
  this.cid = _.uniqueId('view');
  this._configure(options || {}); 
```

现在让我们看看这个`_configure`方法：

```
_configure: function(options) {
  if (this.options) options = _.extend({}, _.result(this, 'options'), options);
  _.extend(this, _.pick(options, viewOptions)); 
```

而且当然...

```
var viewOptions = ['model', 'collection', 'el', 'id', 'attributes', 'className', 'tagName', 'events']; 
```

好的，我们在这里......基本上，当将模型作为`options`参数传递时，您传递的是一个带有`attributes`键的对象（模型的属性）。但是这个`attributes`键也在视图中用于将属性绑定到它的元素！因此，您注意到的行为。

现在，另一个错误的事情。每次创建新函数时都在编译模板，但也不将其用作单例。将您的模板放在视图中：

```
$.hart.NewView = Backbone.View.extend({
  template: Handlebars.compile($("#NewTemplate").html(), 
```

并更改视图的创建以使整个工作正常：

```
new $.hart.NewView({model: this.model}); 
```

哦，摆脱这种无用的`initialize`方法。您只是在做 Backbone 已经在做的事情。

# c# - 如何重置静态字段（即在下次创建类时触发它再次创建）？

> ID：16068887
> 
> 赞同：-1
> 
> 时间：2013-04-17T19:47:06.177
> 
> 标签：c#, testing, singleton

所以这是一个示例单例：

```
public class Singleton
{
    private static Singleton _instance = new Singleton();

    private Singleton()
    {
        //do stuff
    }

    public static Singleton Get()
    {
        return _instance;
    }
} 
```

我正在尝试在这个单例类上运行**多个**测试，第一个自然而然地总是有效。基本上，我可以看到当我创建一个`new Singleton()`构造函数时被调用。或者，当我调用`Singleton.Get()`构造函数时。 **测试单独工作正常**，但是静态字段已设置，即使我手动将其设置为 null，它仍然不会为下一次测试自行重置。这对我来说是个问题，因为**自动化测试在这里很重要**。那么我怎样才能让它自己重置呢？

到目前为止，我研究了 AppDomain 并发现我可以将每个测试放入自己的程序集中并手动运行它。但是，当然，VS[已经为每个程序集使用了一个唯一的 AppDomain，](https://stackoverflow.com/questions/256354/mstest-appdomains)这将允许自动发生这种情况，但这是很多测试程序集，看起来有点傻。我正在寻找替代方案。

**注意：**我不想要关于代码质量的建议。 **这是我正在测试的代码，而不是我编写的代码。在我先测试之前，我不会更改代码。** 我对此进行了彻底的研究，并没有找到一个没有用“你不应该使用单例”来回答的问题。我对代码建议不感兴趣。这是 StackOverflow，而不是 CodeReview。

**要求提供额外信息**

我目前正在使用 Visual Studio 的内置测试框架运行测试。我希望它在移至 MSBuild 时仍然有效。这并不排除手动触发测试的外部应用程序，但它确实使它更难做到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:49:59.847

您误解了 AppDomains。

您可以简单地为每个测试创建一个新的 AppDomain，将所有测试程序集加载到其中，并在每个域中仅调用一个测试方法。
不过，它可能会相当慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:49:59.493

您可以`Singleton`像这样设计您的课程：

```
public class Singleton
{
    private static Singleton _instance;
    private static object _instanceLock = new object();

    private Singleton()
    {
        //do stuff
    }

    public static Singleton Get()
    {
        if (_instance == null)
        {
            lock(_instanceLock)
            {
                if (_instance == null)
                {
                    _instance = new Singleton();
                }
            }
        }

        return _instance;
    }

    public static void Clear()
    {
        if (_instance != null)
        {
            lock(_instanceLock)
            {
                if (_instance != null)
                {
                    _instance = null;
                }
            }
        }
    }
} 
```

然后你必须`Singleton.Clear()`在开始每个测试之前打电话，像这样：

```
[TestInitialize]
public void Initialize()
{
    Singleton.Clear();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T20:25:16.873

编写一个带有命令行参数的控制台程序，以确定要运行哪些单例测试。然后从批处理文件（或 bash 或 powershell，无论您喜欢哪个）中多次调用它。这是额外的工作，但它可以让您每次都在全新的环境中测试此代码。或者您可以尝试弄清楚您当前的工具中是否有一些选项可以做到这一点。

也许是这样的：

```
static int Main(string[] args) {
   try {
      int testcase = (Int32.Parse(args[0]));
      RunTest(testcase);
   } catch (Exception x) {
      Console.WriteLine("test failed: "+x.Message);
      return 1;
   }
   Console.WriteLine("test passed.");
   return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T15:41:28.303

经过@redtuna @drch 和@SLaks 的大量建议以及大量谷歌搜索，我们确定了一种方法来做到这一点。

**第 1 步：**您的测试类需要继承自`MarshalByRefObject`

```
public class UnitTest1 : MarshalByRefObject 
```

**第 2 步：**下一部分是一个自定义方法，用于在它自己的`AppDomain`.

```
private void RunTestInCustomDomain(string methodName)
{
    // selecting the dll from the debug directory using relative directories
    var testDll = @"..\..\..\UnitTests\bin\Debug\UnitTests.dll";
    // first verify the dll exists
    Assert.IsTrue(File.Exists(testDll));
    var assemblyName = AssemblyName.GetAssemblyName(testDll).FullName;
    var domain = AppDomain.CreateDomain(methodName, null, new AppDomainSetup()
    {
        // This is important, you need the debug directory as your application base
        ApplicationBase = Path.GetDirectoryName(testDll)
    });
    // create an instance of your test class
    var tests = domain.CreateInstanceAndUnwrap(assemblyName, typeof(UnitTest1).FullName) as UnitTest1;
    var type = tests.GetType();
    var method = type.GetMethod(methodName);
    // invoke the method inside custom AppDomain
    method.Invoke(tests, new object[]{});
    // Unload the Domain
    AppDomain.Unload(domain);
} 
```

**第 3 步：**下一个技巧是您的测试方法正在调用此自定义方法，因此您的测试将写入没有该属性的**公共**方法中。`[TestMethod]`

```
[TestMethod]
[DeploymentItem("UnitTests.dll")]
public void TestMethod1()
{
    RunTestInCustomDomain("actual_TestMethod1");
}

public void actual_TestMethod1()
{
    // Assert Stuff
} 
```

**为了完整性：** 如果您需要为每个测试运行初始化或清理，则需要手动调用它们，因为 TestMethod 与实际_TestMethod 在不同的 AppDomain 中运行

```
public void actual_TestMethod1()
{
    // Assert Stuff
    TestCleanup();
} 
```

**编辑：**我应该注意，因为这些方法是在单独的 AppDomain 下运行的，所以代码覆盖率不起作用:(。如果有人找到除此功能之外的方法来获得该功能，请告诉我。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T20:49:05.897

只是一个想法：

当然，将其设置为 null 只是将*您的*变量设置为 null 而不是它所指向的内容。但是如果你能得到它`Singleton`自己呢......好吧，似乎这可以使用`Expression`s 来完成。请参阅[从 MemberExpression 中获取对象？](https://stackoverflow.com/questions/1613239/getting-the-object-out-of-a-memberexpression)

# java - 使用 log4J 记录到数据库

> ID：16068888
> 
> 赞同：1
> 
> 时间：2013-04-17T19:47:17.177
> 
> 标签：java, database, logging, log4j

我将实施一个企业范围的日志记录解决方案。这将是一个 Web 服务，它将获取所有异常并将有关该异常的详细信息写入某个数据库的某个位置。这样，我们可以将每个应用程序的所有日志信息记录到一个集中的位置，从而使监控我们的应用程序变得更简单一些。我也将使用日志监控前端应用程序（很可能是 Chainsaw，但我正在寻找一个 Web 前端，但我离题了）......

我在这里有几个菜鸟问题。通过阅读所有文档，当您尝试记录某些内容时，您会做这样的事情......

```
import org.apache.log4j.Logger;
import org.apache.log4j.PropertyConfigurator;

public class Log4jJDBCExample
{
    static Logger log = Logger.getLogger(Log4jJDBCExample.class);

    public static void main(String[] args)
    {
        PropertyConfigurator.configure("log4j.properties");

        log.debug("Sample debug message");
        log.info("Sample info message");
        log.error("Sample error message");
        log.fatal("Sample fatal message");
    }
} 
```

我显然需要一个 log4j.properties 文件，否则这个东西就行不通了。所以我会这样做...

```
# Define the root logger with file appender
log4j.rootLogger = DEBUG, sql

# Define the file appender
log4j.appender.sql=org.apache.log4j.jdbc.JDBCAppender
log4j.appender.sql.URL=jdbc:mysql://localhost/test
# Set Database Driver
log4j.appender.sql.driver=com.mysql.jdbc.Driver
# Set database user name and password
log4j.appender.sql.user=root
log4j.appender.sql.password=password
# Set the SQL statement to be executed.
log4j.appender.sql.sql=INSERT INTO LOGS VALUES ('%x', now() ,'%C','%p','%m')
# Define the xml layout for file appender
log4j.appender.sql.layout=org.apache.log4j.PatternLayout 
```

顺便说一句，我基本上只是从该站点提取此代码... [在此处输入链接描述](http://howtodoinjava.com/2013/04/08/how-to-create-logs-in-database-using-jdbcappender-in-log4j/)（如果有人想检查它，这是一个非常清晰的教程）。

这是伟大的。但这是实现将位于 Web 服务之后。我将让用户将类类型和错误（信息等）消息作为字符串作为 Web 有效负载的一部分发送，我还想记录用户名、堆栈跟踪（如果有）和应用程序 ID，这将也是我将尝试写入数据库的 Web 服务负载的一部分。

显然我需要在这里做一些扩展。在上面的示例中，作者创建了一个表

```
CREATE TABLE LOGS
(
USER_ID VARCHAR(20) NOT NULL,
DATED   DATETIME NOT NULL,
LOGGER  VARCHAR(50) NOT NULL,
LEVEL   VARCHAR(10) NOT NULL,
MESSAGE VARCHAR(1000) NOT NULL
); 
```

我会稍微改变一下那张桌子。我需要将 ClassName、ApplicationID 和 StackTrace 添加到该表中。所以这会更好地满足我的需求。

```
CREATE TABLE LOGS
(
USER_ID VARCHAR2(20) NOT NULL,
DATED   DATETIME NOT NULL,
LOGGER  VARCHAR2(50) NOT NULL,
LEVEL   VARCHAR2(10) NOT NULL,
MESSAGE VARCHAR2(1000) NOT NULL,
    CLASSNAME VARCHAR2(100) NOT NULL,
    ApplicationID INT NOT NULL,
    STACKTRACE VARCHAR2(4000 BYTE)
); 
```

我将有另一个表，它将是一个应用程序表，它将存储应用程序名称和其他重要的应用程序详细信息。堆栈跟踪可以为空。
显然，我需要更改此语句，以便记录其余部分。

```
log4j.appender.sql.sql=INSERT INTO LOGS VALUES ('%x', now() ,'%C','%p','%m') 
```

几个问题：

1）我对扩展 log4J 来做到这一点感到有些困惑。我显然需要扩展 JDBCAppender 并且可能是一个 appender。所以我捕获了所有这些信息。我一直在查看 Apache 的文档，但目前还不清楚要做什么以及通过配置文件进行配置还是扩展类是要走的路？

2）有点不清楚我是否可以将对象的名称传递给 getLogger Factory 函数并期望这个东西仍然可以工作。有人会调用我的服务并传入导致异常异常的类的名称。我不确定这会奏效。我假设使用 Logger 构建的类需要位于类路径或 Java 项目中，这样才不会引发一些奇怪的异常？那是正确的吗？如果是这样的话，我不确定 log4J 是否会成为这个项目的好工具。

3) 一种菜鸟 Java 项目问题。当我突然将 Log4J jar 导入我的项目时，我的项目将不再发布到我的本地服务器。我将 jar 作为外部 jar 添加到我的项目中，并且该项目是正在发布的 EAR 中的实用程序 Jar。该项目也是一个实用模块（将其添加为该项目的一个方面）。我可能在做一些愚蠢的事情。请随时严厉地让我知道它是什么。

4）你为此推荐一个好的前端吗？Chainsaw 看起来像一个 Windows 厚客户端，现在对我的目的来说很好，但我希望有一个更好的 Web 前端来支持这个项目。如果你有一个想法，请随时分享。

# facebook - FQL 不返回流中的所有项目

> ID：16068891
> 
> 赞同：0
> 
> 时间：2013-04-17T19:47:32.617
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我正在构建一个网络应用程序，允许用户发布到 Facebook 以及查看他们的新闻提要（以及其他一些东西）。

这：[https](https://graph.facebook.com/me/posts) ://graph.facebook.com/me/posts返回许多记录。它返回一切。

为了将结果限制为链接、照片、状态消息、帖子和视频，我选择使用 FQL。我在通话中使用以下内容：

```
SELECT post_id, source_id, actor_id, target_id, message, attachment, permalink, type FROM stream WHERE source_id = me() AND type IN (80,247,46,128,56) AND is_hidden = 0 
```

问题是我只取回我的应用程序创建的记录。

我究竟做错了什么？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T18:13:06.573

显然，所需要的只是一个 LIMIT 语句。现在我已经添加了一个限制，它工作正常。

# php - Mysql查询子字符串？

> ID：16068896
> 
> 赞同：-1
> 
> 时间：2013-04-17T19:48:02.400
> 
> 标签：php, mysql

我有一个电视节目和收视率数据库，我想这样做：搜索来自某个网​​络的某些电视节目的所有收视率......

我有带有节目 ID 的收视率表，但它没有网络 ID 的列...我有一个电视节目表，其中我有每个网络的 ID一。

我怎样才能做到这一点？这是子字符串的情况吗？

我的表结构：

网络表：

```
id
name 
```

电视节目表：

```
id
name
network_id 
```

评分表：

```
id
tv_show_id
season
episode
rating 
```

我想做的是：

```
SELECT * FROM ratings WHERE (network_id = X) 
```

（但 Ratings 表没有 network_id 列）

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:50:53.793

你必须将你的节目表和你的收视率表连接起来，你可能需要这样的东西：

```
SELECT ratings.*
FROM shows INNER JOIN ratings
     ON shows.id = ratings.show_id
WHERE
  shows.netword_id = 1 
```

请参阅此链接以了解[INNER JOIN](http://www.mysqltutorial.org/mysql-inner-join.aspx)的工作原理。

# javascript - HTML / CSS：跨行相同的表格单元格宽度

> ID：16068905
> 
> 赞同：-1
> 
> 时间：2013-04-17T19:48:35.770
> 
> 标签：javascript, jquery, css, html-table

我有这张表，其中包含有关其右侧项目的详细信息，我需要将所有单元格放在与最长的宽度完全相同的列中，就像下面的屏幕截图所示：

![](https://i.imgur.com/7eOpU54.png)

如果我使用常规表格，这将有效，但现在我需要在其顶部添加手风琴功能，因此当我单击一行时，该行的相关内容将从每个下方滑下。

在表格行之间添加这些内容 div 的唯一方法是将它们包装在`<tr>`标签中，这不适用于`slideDown()`and`slideUp()`效果。

现在我使用标签在小提琴中重新创建了表格`<dl>`，希望以某种方式使用 CSS 解决这个问题，但没有这样的运气。这是链接： http: [//jsfiddle.net/bbDYX/](http://jsfiddle.net/bbDYX/) - 一切正常，除了宽度问题。

我现在能想到的唯一解决方案是使用 JavaScript 遍历每个右侧列上的每个表格单元格，并将它们的宽度设置为与最高宽度单元格相同的值。但如果可以的话，我想避免这种情况。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:58:53.763

您不能向上滑动`<tr>`标签，但可以向上滑动`<td>`标签。不确定这是否适合您，但值得考虑...

```
$("#somerow").find("td").slideToggle(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:10:03.483

好的，正如我在评论中所说，我会保留表格并为类似手风琴的效果创建一个“自定义小部件”。

事情会很简单，使用 jQuery UI 动画等。

例如，您可以只用四行代码创建一个基本的“描述切换”：

```
$('.mytable .description').hide();
$('.mytable').on('click', '.title', function(){
    $(this).next('.description').toggle();
}); 
```

（当然你可以自定义 .toggle() 通过添加效果类型，持续时间，...）

这是一个工作示例：http: [//jsfiddle.net/JAmFh/](http://jsfiddle.net/JAmFh/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:19:40.280

这就是你需要的：[myjsfiddle](http://jsfiddle.net/BPxS5/)

**CSS：**

```
.con1
{
width:100%;
height:50px;
background-color:#F3E2A9; 
} 
```

**html:**

```
<table border='0' cellspacing='3' width='100%'>
<tr bgcolor='lightblue'>
    <td><a href='#' class='open1' >Item</a></td>
    <td>detail 1</td>
    <td>detail 2</td>
    <td>detail 3</td>
</tr>
<tr><td colspan='4'><div class='con1'>con1</div></td></tr>
<tr bgcolor='lightblue'>
    <td><a href='#' class='open1' >Item</a></td>
    <td>detail 1</td>
    <td>detail 2</td>
    <td>detail 3</td>
</tr>
<tr><td colspan='4'><div class='con1'>con1</div></td></tr>
<tr bgcolor='lightblue'>
    <td><a href='#' class='open1' >Item</a></td>
    <td>detail 1</td>
    <td>detail 2</td>
    <td>detail 3</td>
</tr>
<tr><td colspan='4'><div class='con1'>con1</div></td></tr>
</table> 
```

**脚本：**

```
$('.con1').hide();
$('.open1').click(function() {
    $(this).parent().parent().next().find('.con1').slideToggle();    
    return false;        
}); 
```

玩得开心造型...（经过测试）

# windows - 使用digest.bat 创建摘要退出时未配置JRE_HOME

> ID：16068916
> 
> 赞同：2
> 
> 时间：2013-04-17T19:48:56.480
> 
> 标签：windows, tomcat, environment-variables, java, digest

我正在尝试为某些密码创建摘要。

运行以下命令时

```
C:\Program Files\apache-tomcat-7.0.34\bin> digest.bat -a SHA-256 somepassword 
```

我收到以下错误

```
The JRE_HOME environment variable is not defined correctly
This environment variable is needed to run this program 
```

JRE_HOME 的值为`C:\Program Files\Java\jre7`

我已经尝试`.;`在`\bin`后面的前面（有和没有分号和/或尾随反斜杠），但问题仍然存在。

1.  tomcat的版本是7.0.34

2.  java的版本是jre7

3.  操作系统是 Win7 Pro 64 位

我的下一步是安装不同版本的 JRE 并重试，感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:07:32.180

从*%CATALINA_HOME%\bin\tool-wrapper.bat文件中，从**digest.bat*内部引用：

```
rem   JAVA_HOME       Must point at your Java Development Kit installation.
rem                   Using JRE_HOME instead works as well.
rem
rem   JRE_HOME        Must point at your Java Runtime installation.
rem                   Defaults to JAVA_HOME if empty. If JRE_HOME and JAVA_HOME
rem                   are both set, JRE_HOME is used. 
```

换句话说，只需将**JAVA_HOME 设置**为指向**JDK**（不是 JRE）安装，一切都会正常工作（在我的机器上测试过）。

我机器上的示例*JAVA_HOME*：

```
JAVA_HOME=C:\Program Files\Java\jdk1.7.0_17 
```

* * *

**更新**

从位于 Tomcat 目录中的*running.txt文件：*

> (3) 配置环境变量
> 
> Tomcat 是一个 Java 应用程序，不使用环境变量。 **Tomcat 启动脚本使用这些变量。**脚本使用变量来准备启动 Tomcat 的命令。
> 
> (3.1)**设置CATALINA_HOME（必填）**和CATALINA_BASE（可选）
> 
> CATALINA_HOME 和 CATALINA_BASE 环境变量分别用于指定 Apache Tomcat 的位置及其活动配置的位置。
> 
> CATALINA_HOME 环境变量应按照上面 (2.2) 中的定义进行设置。Tomcat 启动脚本有一些逻辑可以在不存在时自动设置此变量（基于 Unix 中脚本的位置和 Windows 中的当前目录），但此逻辑可能不适用于所有情况。
> 
> CATALINA_BASE 环境变量是可选的，在下面的“多个 Tomcat 实例”部分中有进一步的描述。如果不存在，则默认等于 CATALINA_HOME。
> 
> (3.2)**设置 JRE_HOME 或 JAVA_HOME (必填)**
> 
> JRE_HOME 变量用于指定用于启动 Tomcat 的 JRE 的位置。
> 
> **JAVA_HOME**变量用于指定 JDK 的位置。**它用于代替 JRE_HOME。**
> 
> 使用**JAVA_HOME 可以访问使用 JRE_HOME 时不允许的某些附加启动选项。**
> 
> 如果同时指定了 JRE_HOME 和 JAVA_HOME，则使用 JRE_HOME。

附加阅读：[Tomcat：启动](http://books.google.ee/books?id=G6-nAJiUAIMC&pg=PA27&lpg=PA27&dq=setting+%22catalina_home%22+on+%22windows%22&source=bl&ots=N_OZQ0FQ-K&sig=IGF8bO660HfR3vUrlwReHsaBnsU&hl=en&sa=X&ei=HglvUf6bDs2M0wWztoGgDg&ved=0CCkQ6AEwADgK)

# razor - webmatrix - 回复 webmail.send 标头

> ID：16068917
> 
> 赞同：0
> 
> 时间：2013-04-17T19:48:58.420
> 
> 标签：razor, webmatrix, webmail

任何人都知道如何在 C# 中执行以下操作？

```
additionalHeaders.Add("Reply-To: test@test.com"); 
```

我需要将其插入以下代码：

```
WebMail.Send(to: customerEmail,
        subject: "Booking enquiry from - " + customerEmail,
        body: customerRequest
    ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:32:25.627

使用以下方法解决了它：

```
var header = new[]{"Reply-To:test@hotmail.com"};
WebMail.Send(to: customerEmail,
        subject: "Booking enquiry from - " + customerEmail,
        body: customerRequest,
        additionalHeaders: header
    ); 
```

# ruby-on-rails - 在 Rails 中无法显示可点击的图像

> ID：16068918
> 
> 赞同：4
> 
> 时间：2013-04-17T19:48:58.953
> 
> 标签：ruby-on-rails, ruby

我是 Stackoverflow 和 Rails 的新手，我正在尝试在 Rails 中显示可点击的图像。我想要做的是显示图像，使其可点击，当您单击图像时，您可以使用图像查看器放大。这有效：

```
<%= link_to "Show Images", "image_path" %> 
```

其中 image_path 是直接 URL。当您单击“显示图像”链接时，您可以放大图像。我不想显示文本“显示图像”，而是显示图像。我试过这个：

```
<%= link_to image_tag "image_path", "image_path" %> 
```

但它给了我错误。我什至尝试在字段周围加上括号，但它不起作用。我在这里做错了什么？谢谢，

-LRC-

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T19:57:48.337

以下应该工作。

```
<%= link_to image_path do %>
    <%= image_tag image_path %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:05:15.497

如果你像这样放置括号，它应该可以工作：

```
<%= link_to image_tag("image_path"), "image_path" %> 
```

# php - 使用 curl_setopt 调用时将变量传递到另一个页面

> ID：16068920
> 
> 赞同：0
> 
> 时间：2013-04-17T19:49:00.747
> 
> 标签：php, curl

我正在使用 curl_setopt 来评估来自不同服务器的另一个文件，链接类似于“ [http://somewhere.com/index.php?vars=hello](http://somewhere.com/index.php?vars=hello) ”

现在在某处.com/index.php 我需要获取使用 curl 传递的 vars 的值，但到目前为止我根本无法获得任何值。

这是我的示例代码供您参考，它来自调用某处的文件：

```
$d = "http://somewhere.com/index.php?vars=hello";
$ch1 = curl_init();

curl_setopt($ch1, CURLOPT_AUTOREFERER, TRUE);
curl_setopt($ch1, CURLOPT_HEADER, 0);
curl_setopt($ch1, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch1, CURLOPT_URL, $d);
curl_setopt($ch1, CURLOPT_FOLLOWLOCATION, TRUE);       

$data1 = curl_exec($ch1);
eval($data1);
curl_close($ch1); 
```

在somewhere.com/index.php 我已经做了 print_r($_GET); 查看任何传递给文件的值，但它什么也没返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:57:04.083

带有变量“hello”的 index.php 文件中发生了什么？当您在另一个页面上进行 curl 发布时，其他页面通常会回显一个响应，而该响应就是您评估的内容。您可以从 index.php 发布您的代码，以便我们可以看到您正在尝试做什么？

编辑：您还可以使用 chrome 检查器、提琴手或其他一些网络监视器来查看 http 请求是否真的被触发并检查您是否真的得到了 200 响应。

编辑：我也不知道你在用什么 eval ，只是回显响应。如果您有输出缓冲区问题，请在回显响应之前开始缓冲，例如：

```
 ob_start():
     echo $data1;
     ob_end_clean(); 
```

此外，如果您想查看是否收到任何错误，请执行以下操作：

```
 if(curl_exec($ch1) === false)
     {
     echo 'Curl error: ' . curl_error($ch1);
     } 
     else
     {
     echo $data1;
     }

     // Close handle
     curl_close($ch1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:57:20.663

你不能用`$_GET[]`吗？

IE `$variables = $_GET['vars'];`

# jquery - JQuery .load() 功能导致奇怪的延迟

> ID：16068924
> 
> 赞同：1
> 
> 时间：2013-04-17T19:49:12.940
> 
> 标签：jquery, load, gallery, image, lag

我做了一些搜索/故障排除无济于事。我有一个简单的图片查看器，我在 JQuery .load() 函数中添加了让动画等待淡入，直到图像加载。这方面效果很好，但它导致了一个奇怪的错误。如果您查看带有箭头的图片，它会开始产生一个奇怪的延迟，发生在淡出之前 (fadeTo(200,0))。这对我来说毫无意义，因为在那条线之前没有任何东西会导致滞后。

（注意，当 .load() 函数不存在时，不会发生这种滞后）

这是下一个按钮（左侧的箭头按钮）的 JQuery 代码。“largeImage”是您看到的主要图像。

转到[http://www.snowtheband.com/temporary/media.html](http://www.snowtheband.com/temporary/media.html)并单击“图片”下的缩略图之一以进入图片查看器。

```
$("#nextButton").click(function(){
    picNumber=parseInt(picNumber);
    if (picNumber<7){
        picNumber+=1;
        picClass="."+picNumber;
        var loadPic="images/photos/"+picNumber+"_large.jpg";
        descText=$(picClass).prop("alt");
        $("#description").fadeTo(200,0,function(){
            $("#description").html(descText).fadeTo(200,1);
        });
        $("#largeImage").fadeTo(200,0,function(){
            $("#largeImage").prop("src",loadPic);
            $("#imagecontainer img").load(function(){
                $("#largeImage").fadeTo(200,1);
            });
        });
    };
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:51:54.820

发生这种情况是因为您的浏览器仅在您设置来源后才开始检索图像。只有当它完成加载图像时`load`才会触发。

如果你想让它运行顺利，你必须预加载图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:58:28.073

为了使其顺利进行，请执行以下操作：

1.  最小化图像大小（每张图像 400-600 kb 相当多。您可以将图像压缩 1.5-2 倍）。
2.  如果您有管理员权限，请尝试优化您的服务器性能。它响应缓慢。
3.  对幻灯片中的所有图像使用预加载机制。在本主题中阅读有关预加载的更多信息：[使用 jQuery 预加载图像](https://stackoverflow.com/questions/476679/preloading-images-with-jquery)

我建议您以这种方式实现预加载：

```
$.fn.preload = function() {
    this.each(function(){
        $('<img/>')[0].src = this;
    });
}
$(function() {
    var images = [], i;
    for (i = 0; i < 7; i += 1) {
       images.push("images/photos/" + (i + 1) + "_large.jpg");
    }
    $(images).preload();
}); 
```

**更新：**修复了脚本。出现语法错误。

# ruby-on-rails - 消除 RSpec 上下文中的重复代码

> ID：16068925
> 
> 赞同：0
> 
> 时间：2013-04-17T19:49:15.117
> 
> 标签：ruby-on-rails, rspec

这是我的 rspec 文件。我有`PosRequest.authorize_card(@payment_detail)`3 次这条线。有没有一种 DRYer 方法来写这个上下文？

```
context 'should get' do 
    it 'error message' do 
      PosRequest.authorize_card(@payment_detail)
      @payment_detail.errorMsg.should_not eql(:nil)
    end
    it 'bank message' do 
      PosRequest.authorize_card(@payment_detail)
      @payment_detail.cardMsg.should_not eql(:nil)
    end
    it 'claim message' do 
      PosRequest.authorize_card(@payment_detail)
      @payment_detail.bankMsg.should_not eql(:nil)
    end
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:07:00.410

在你里面`context`你可以使用已经建议的

```
before do
  do_something
end 
```

在此上下文中的所有测试将只运行一次，或者您可以使用

```
before :each do
  do_something
end 
```

这将在此上下文中为每个测试运行`do_something`一次，您可以选择更适合您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:00:35.863

```
context 'should get' do 
  before {PosRequest.authorize_card(@payment_detail)}

  it 'sends error message' do 
    @payment_detail.errorMsg.should_not eql(:nil)
  end
  it 'sends bank message' do 
    @payment_detail.cardMsg.should_not eql(:nil)
  end
  it 'sends claim message' do 
    @payment_detail.bankMsg.should_not eql(:nil)
  end
end 
```

我对此进行了编辑以添加动词，以便您更清楚地了解每个规范在做什么。

# c++ - 如何随机打乱地图中的值？

> ID：16068927
> 
> 赞同：5
> 
> 时间：2013-04-17T19:49:31.843
> 
> 标签：c++, algorithm, map, stl, shuffle

我有一个 std::map，键和值都是整数。现在我想随机打乱地图，所以键随机指向不同的值。我尝试了 random_shuffle 但它没有编译。请注意，我不是要洗牌，这对地图没有意义。我正在尝试随机化这些值。

我可以将这些值推送到一个向量中，将其洗牌，然后复制回来。有没有更好的办法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:22:27.670

您可以按下 a 中的所有键`vector`，随机播放`vector`并使用它来交换 中的值`map`。

这是一个例子：

```
#include <iostream>
#include <string>
#include <vector>
#include <map>
#include <algorithm>
#include <random>
#include <ctime>

using namespace std;
int myrandom (int i) { return std::rand()%i;}
int main ()
{
    srand(time(0));
    map<int,string> m;
    vector<int> v;
    for(int i=0; i<10; i++)
        m.insert(pair<int,string>(i,("v"+to_string(i))));

    for(auto i: m)
    {
        cout << i.first << ":" << i.second << endl;
        v.push_back(i.first);
    }
    random_shuffle(v.begin(), v.end(),myrandom);
    vector<int>::iterator it=v.begin();
    cout << endl;
    for(auto& i:m)
    {
        string ts=i.second;
        i.second=m[*it];
        m[*it]=ts;
        it++;
    }
    for(auto i: m)
    {
        cout << i.first << ":" << i.second << endl;
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T19:55:41.467

您的提议的复杂性是`O(N)`，（副本和洗牌都具有线性复杂性）这似乎是最佳的（查看较少的元素会在您的洗牌中引入非随机性）。

如果你想反复打乱你的数据，你可以维护一个`<Key, size_t>`索引到 a 的类型映射（即众所周知的间接级别），`std::vector<Value>`然后重复打乱那个向量。这样可以节省所有复制以换取`O(N)`空间开销。如果类型本身很昂贵，那么您对进行洗牌的真实数据`Value`有额外的索引。`vector<size_t>`

为方便起见，您可以将`map`and封装`vector`在一个公开`shuffle()`成员函数的类中。这样的包装器还需要公开底层映射的基本查找/插入/擦除功能。

**编辑**：正如@tmyklebu 在评论中指出的那样，维护（原始或智能）指向辅助数据的指针可能会导致**迭代器失效**（例如，在末尾插入新元素时会导致向量的容量被调整大小）。使用索引而不是指针解决了“最后插入”问题。但是在编写包装类时，您需要确保新键值对的插入永远不会导致辅助数据的“中间插入”，因为这也会使索引无效。一个更强大的库解决方案是使用[**Boost.MultiIndex**](http://www.boost.org/doc/libs/1_53_0/libs/multi_index/doc/index.html)，它专门设计用于允许对数据结构进行多种类型的视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T22:02:55.927

如果您想就地洗牌，您可以`random_shuffle`为您的`map`. 该解决方案仍然需要将键放入向量中，如下使用`transform`：

```
typedef std::map<int, std::string> map_type;
map_type m;
m[10] = "hello";
m[20] = "world";
m[30] = "!";
std::vector<map_type::key_type> v(m.size());
std::transform(m.begin(), m.end(), v.begin(),
               [](const map_type::value_type &x){
                   return x.first;
               });
srand48(time(0));
auto n = m.size();
for (auto i = n-1; i > 0; --i) {
    map_type::size_type r = drand48() * (i+1);
    std::swap(m[v[i]], m[v[r]]);
} 
```

我使用`drand48()/srand48()`了一个统一的伪随机数生成器，但您可以使用最适合您的任何东西。

或者，您可以 shuffle `v`，然后重新构建`map`，例如：

```
std::random_shuffle(v.begin(), v.end());
map_type m2 = m;
int i = 0;
for (auto &x : m) {
    x.second = m2[v[i++]];
} 
```

但是，我想说明在 map 上实现 shuffle 并不过分繁重。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T19:53:06.973

好吧，只使用地图我想到的是：为地图的每个单元格制作一个标志数组，随机生成两个整数 st 0<=i, j <地图大小；交换它们并将这些单元格标记为已交换。为所有人迭代。
编辑：该数组是按地图的大小分配的，并且是一个本地数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T19:53:30.270

我对此表示怀疑...

但是...为什么不编写一个包含 2 个向量的快速类。一个排序`std::vector`的键和一个`std::random_shuffle`d`std::vector`值？`std::lower_bound`使用和使用查找键`std::distance`并`std::advance`获取值。简单的！

无需深思熟虑，这应该与`std::map`参考位置具有相似的复杂性，并且可能更好。

一些未经测试和未完成的代码可以帮助您入门。

```
template <class Key, class T>
class random_map
{
public:
    T& at(Key const& key);
    void shuffle();
private:
    std::vector<Key> d_keys; // Hold the keys of the *map*; MUST be sorted.
    std::vector<T> d_values;
}

template <class Key, class T>
T& random_map<Key, T>::at(Key const& key)
{
    auto lb = std::lower_bound(d_keys.begin(), d_keys.end(), key);
    if(key < *lb) {
        throw std::out_of_range();
    }
    auto delta = std::difference(d_keys.begin(), lb);
    auto it = std::advance(d_values.begin(), lb);
    return *it;
}

template <class Key, class T>
void random_map<Key, T>::shuffle()
{
    random_shuffle(d_keys.begin(), d_keys.end());
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-13T12:25:48.393

这是我使用`std::reference_wrapper`C++11 的解决方案。

首先，让我们创建一个 std::random_shuffle 版本，用于打乱引用。[这是对](http://en.cppreference.com/w/cpp/algorithm/random_shuffle)*版本 1*的一个小修改：使用该方法获取引用的值。`get`

```
template< class RandomIt >
void shuffleRefs( RandomIt first, RandomIt last ) {
    typename std::iterator_traits<RandomIt>::difference_type i, n;
    n = last - first;
    for (i = n-1; i > 0; --i) {
        using std::swap;
        swap(first[i].get(), first[std::rand() % (i+1)].get());
    }
} 
```

现在很容易：

```
template <class MapType>
void shuffleMap(MapType &map) {
    std::vector<std::reference_wrapper<typename MapType::mapped_type>> v;
    for (auto &el : map) v.push_back(std::ref(el.second));
    shuffleRefs(v.begin(), v.end());
} 
```

# c# - 让 Windows 服务真正停止

> ID：16068942
> 
> 赞同：2
> 
> 时间：2013-04-17T19:50:00.697
> 
> 标签：c#, windows-services

WCF 服务托管在 Windows 服务中。`net stop [Service]`为了更顺畅的开发，该服务在预构建任务中停止，然后在构建后任务中卸载、安装和启动。

**问题**：

`net stop [Service]`不会等到进程完全终止并释放所有资源。例如，[此处](https://stackoverflow.com/questions/884853/service-not-fully-stopped-after-servicecontroller-stop)记录了此行为。因此，在编译服务时，bin 目录（服务所在的位置）中的二进制文件仍处于锁定状态，无法被新副本覆盖。

有没有一种简单的方法可以让预构建`net stop`等到资源被释放，然后才返回？我可以获取进程 ID 并等待它终止，但对于这样一个简单的任务来说似乎有点笨拙。

# php - 如果变量 = 1 然后复选框 = 选中

> ID：16068948
> 
> 赞同：0
> 
> 时间：2013-04-17T19:50:16.500
> 
> 标签：php

我想说如果

```
$supervisor = 1 
```

然后

```
checkbox=checked else checkbox=unchecked 
```

我用过：

```
<input name="supervisor" type="checkbox" <?php if ($supervisor = 1){?> checked="checked" <?php } else { ?> checked="unchecked" <?php } ?>/> 
```

并`echo $supervisor;`返回 0

但是该框已打勾？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T19:51:49.887

`checked`如果未选中，请不要指定属性。另外，一个相等是赋值，你想使用两个。

```
<input name="supervisor" type="checkbox" <?php if ($supervisor == 1){?> checked="checked" <?php } ?>/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T19:51:35.340

尝试这个：

```
<input name="supervisor" type="checkbox" <?php if ($supervisor == 1) { echo 'checked="checked"'; } ?> /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T19:51:29.620

做这个。

```
echo ( $supervisor == 1 ) ? 'checked' : 'not checked'; 
```

在做这样的事情时，三元运算符清晰简洁。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T20:00:24.017

第一个问题：**您尝试生成的 HTML 不会达到您想要的效果。**

如果你有一个`checked`属性，那么它必须有值`"checked"`。

如果要指定默认情况下不应选中复选框，则*根本不能*包含该`checked`属性。`checked="unchecked"`是浏览器错误恢复将视为的错误`checked="checked"`。

第二个问题：**`=`是赋值运算符，需要比较运算符。**

改为使用`==`。

**固定代码**

```
<input
    name="supervisor"
    type="checkbox"
    <?php if ($supervisor == 1) { ?>
    checked="checked"
    <?php } ?> 
    /> 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-04-17T19:52:20.317

尝试这个：

```
<input name="supervisor" type="checkbox" <?php if ($supervisor) echo "checked" ?> /> 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2013-04-17T19:54:15.037

如果：

```
<input name="supervisor" type="checkbox" <?php echo $supervisor == 1 ? 'checked' : ''  ?>/> 
```

# c++ - { Qt5.0.2/QML/QtQuick2.0/C++ } 运行没有错误的示例项目？

> ID：16068954
> 
> 赞同：13
> 
> 时间：2013-04-17T19:50:36.630
> 
> 标签：c++, qt, qml, sample

我的设置是 *Qt5.0.2 MinGW 32-bit*。

我正在寻找具有实际 C++ 类或至少`{ Qt5.0.2 / QML / QtQuick2.0 / C++ }`一个.`Qt Quick 1.0``main.cpp`

我浏览了网络，浏览了所有可能找到的示例：

*   [http://qt-project.org/](http://qt-project.org/)网站；
*   github；
*   堆栈溢出（如果以前有人解决过这个问题）；
*   [http://www.developer.nokia.com/Develop/Qt/Code_examples/](http://www.developer.nokia.com/Develop/Qt/Code_examples/)

但它们要么是旧的（*Qt Quick 1.0*），要么是纯*QML+ QtQuick 2.0* ，或者根本没有编译；或者如果他们可以编译，他们会向我展示空对话框（例如，诺基亚代码示例中的“ *Status Shout！* ”）。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-17T20:45:01.917

QML 上并没有那么多详细的资源，大部分可用的只是简短的代码片段示例和文档示例。这对于刚接触编程的人来说是个问题，因为这些材料并没有真正给出如何组合在实践中有用的东西的想法。

对于全新的 QtQuick2 来说更是如此，甚至文档和许多官方示例仍然不完整。而且我从经验中知道遵循教程，输入所有内容，期望它工作，并得到一些意想不到的东西是多么令人沮丧，不知道真正出了什么问题以及如何解决它。

话虽如此，有一些完整的，虽然是微不足道的游戏的例子，在 QtQuick1 中实现。这不是什么大问题，因为 QtQuick2 元素是向后兼容的，并且代码将与 QtQuick2 一起工作，几乎不需要修改。

*   [Qt 快速游戏编程速成课程](http://quitcoding.com/download/Qt_Quick_Game_Programming_1_0.pdf)- PDF

官方示例虽然偶尔会损坏或不完整，但也可能会有所帮助，而且它们可能很快就会修复（现在是时候了）：

*   [QtQuick(2) 代码示例](http://doc.qt.io/qt-5/qtquick-codesamples.html)

最后但同样重要的是，来自 Qt 项目网站 wiki 的 QML 片段：

*   [QML 片段、教程、最佳实践、演示......](http://qt-project.org/wiki/Category:Developing_with_Qt::Qt_Quick)

编辑：添加另一个学习 QML 的好资源：http: [//qmlbook.org](http://qmlbook.org)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T20:16:23.790

一个相当简单的例子是：

主文件

```
#include <QGuiApplication>
#include <QQuickView>

int main(int argc, char** argv)
{
    QGuiApplication app(argc, argv);
    QQuickView view;
    view.resize(800, 480);
    view.setResizeMode(QQuickView::SizeRootObjectToView);
    view.setSource(QUrl("qrc:///foo.qml"));
    view.show();
    return app.exec();
} 
```

foo.qml（这里捆绑为资源）：

```
import QtQuick 2.0

Rectangle {
    color: "lightsteelblue"

    Text {
        anchors.centerIn: parent
        text: "Hello"
    }
} 
```

# javascript - 使用 javascript 写入文件

> ID：16068956
> 
> 赞同：1
> 
> 时间：2013-04-17T19:50:46.243
> 
> 标签：javascript, activex

我正在尝试制作一个简单的脚本 - 当您按下按钮时将内容写入 txt 文件。我想在本地主机上设置它（完整路径 - E:\xampp-portable\htdocs\test）。

目前坚持使用此脚本：

```
<html>
<head>
<script language="javascript">
function Write()
{
var Scr = new ActiveXObject("Scripting.FileSystemObject");
var CTF = Scr.CreateTextFile("C:\\test.txt", true);
CTF.WriteLine('test');
CTF.Close();
}
</script>
</head>
<body onLoad="Write()">
</body>
</html> 
```

它不起作用。我应该在这里设置什么路径 - `var CTF = Scr.CreateTextFile("C:\\Gyan.txt", true);`？我认为这是我犯错误的地方。此外，还有其他简单的方法可以使用 javascript 将内容写入已经存在的 txt 文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:55:34.953

您拥有的 JavaScript 可能会与 Windows Scripting Host 一起使用（如果您的安全设置非常简单，也可能与 Internet Explorer 一起使用），但出于安全原因，它不能在浏览器中使用。想象一下访问一个网站并自动让您的桌面充满广告 PDF ......（充其量）

您实际上可以在浏览器中使用 JavaScript 执行的操作是*读取*文件，但它们必须由表单的文件输入中使用的指定。

**编辑**：在这里查看使用 Internet Explorer 执行此操作的方法：http: [//4umi.com/web/javascript/filewrite.php](http://4umi.com/web/javascript/filewrite.php)（但它需要用户交互）

# url-rewriting - Tuckey URL：重定向的 url 输出两次

> ID：16068958
> 
> 赞同：0
> 
> 时间：2013-04-17T19:50:51.853
> 
> 标签：url-rewriting, tuckey-urlrewrite-filter, url-redirection

我有以下重定向：

```
<rule>
    <condition name="host" operator="equal">^(www.)?test.redirect.com$</condition>
    <from>^?</from>
    <to type="redirect" last="true" encode="true">http://www.redirect.com/test/test-123</to>
</rule> 
```

它确实重定向，但是它重定向到`http://www.redirect.com/test/test-123http://www.redirect.com/test/test-123`. 有谁知道为什么它会像那样输出两次？

作为旁注，我想补充一点，它不会被重定向两次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:16:16.907

该`<from>`条款不正确：

```
<rule>
    <condition name="host" operator="equal">^(www.)?test.redirect.com$</condition>
    <from>^(.*)</from>
    <to type="redirect" last="true" encode="true">http://www.redirect.com/test/test-123</to>
</rule> 
```

# xcode - UIScrollView 不显示

> ID：16068961
> 
> 赞同：1
> 
> 时间：2013-04-17T19:51:03.883
> 
> 标签：xcode, uiscrollview, storyboard, uitoolbar

我有一个非常简单的应用程序。
顶部和底部都有一个工具栏。
底部工具栏需要在 UIScrollView 中，因为它的按钮会离开屏幕。
但是当我在 iPhone 4G 上测试我的应用程序时，滚动条及其内容不显示。
当我在 iPod 5G 上测试它时，一切都在它应有的位置。
我目前没有使用任何编码，这一切都在情节提要中完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T06:22:21.063

由于 iPhone4G 和 iPod 5 的屏幕尺寸存在差异，因此 UI 将调整大小，从而导致所有添加的子视图缩小。

有两种解决方案可以解决您的问题。

1）添加两个工具栏。选择屏幕底部和编辑器菜单中的工具栏

编辑器 > 嵌入 > 滚动视图

这将确保 UI 开箱即用。

2）这是第二种方式（我猜你已经用这种方式创建了你的用户界面）

-> 拖动滚动视图

-> 添加工具栏作为其子视图。

-> 现在我们需要设置弹簧（在我们的例子中是自动布局属性。）

下图将帮助您更好地理解

![在此处输入图像描述](https://i.stack.imgur.com/LQbPo.png)

第一个约束“高度等于”可以添加如下

编辑器 > 引脚 > 高度

现在选择并将前导空格编辑为：属性

并在下拉菜单中选择“小于或等于”

这类似于将“UIViewAutoresizingFlexibleTopMargin”设置为自动调整大小掩码。

# java - 访问gridview中的每个textview并将颜色设置为白色

> ID：16068965
> 
> 赞同：0
> 
> 时间：2013-04-17T19:51:33.610
> 
> 标签：java, android

抱歉，如果这是一个奇怪的问题，我真的不明白如何让它工作。基本上，我想要一种行为，以便当您单击我的一个 gridview 项目时，它会突出显示红色，这工作正常，但我需要它一次只有 2 个来自 click 方法的突出显示的字母。

在这个方法之外是

```
public void onItemClick(AdapterView<?>parent, View v, int position, long id)
{
    //selection.setText(Words[position]);
} 
```

这是在我被解雇的方法中

```
public void onItemClick(AdapterView<?> arg0,View arg1, int arg2, long arg3)
{
    Toast.makeText(getApplicationContext(), ""+arg2,Toast.LENGTH_SHORT).show(); 
    ((TextView) arg1).setTextColor(getResources().getColor(android.R.color.holo_red_light));
                ((TextView) arg1).setTextSize(9);
    counter++;
    if(counter == 2)
    {
        //this needs to select everything in the gridview and set to white
    }
} 
```

有谁知道我将如何去做（如果可能的话）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:09:18.030

对其进行排序。

```
 if(counter == 3)
                {
                    gridView.setAdapter(adapter);
                    // do the check if its a word or not

                    counter = 0;

            } 
```

奇迹般有效

# git - 是否可以跳过暂存区域并（也）将未跟踪的新文件提交到 git？

> ID：16068968
> 
> 赞同：13
> 
> 时间：2013-04-17T19:51:37.290
> 
> 标签：git, git-add, git-untracked

是否可以在单个内置命令行命令中**跳过暂存区域**并（也）将**未跟踪的新文件提交到 git？**如果没有，有什么替代方案？

[http://git-scm.com/book/en/Git-Basics-Recording-Changes-to-the-Repository](http://git-scm.com/book/en/Git-Basics-Recording-Changes-to-the-Repository)

> 为 git commit 命令提供 -a 选项会使 Git 在执行提交之前自动暂存已跟踪的每个文件，让您跳过 git add 部分：
> 
> `$ git commit -a -m 'added new benchmarks'`

谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-17T20:00:41.083

使用单个内置命令行命令？不。

**使用两个命令：**

```
git add -A
git commit 
```

**使用自定义别名：**

将此添加到*.gitconfig*：

```
[alias]
   commituntracked = "!git add -A; git commit" 
```

然后你可以做

```
git commituntracked 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T21:27:19.647

这对大师来说似乎很微不足道，但对我来说是一个小启示（我承认） - 至少我现在才第一次使用它并且它可以工作（*没有*自定义别名）：只需使用分号就可以`;`了作为单线：

`git add --all; git commit -m "some informative commit message"`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T22:05:34.763

是的。至少有两种主要的方法可以做到这一点。首先，您不必使用“the”暂存区，您可以拥有任意数量的暂存区——随心所欲地设置`GIT_INDEX_FILE=/path/to/private/index`和执行；其次，您可以直接自己构建提交。它甚至不难。

Git 的存储库核心处理 blob、树和提交对象（这里也不太相关，注释和注释标签）。转储对象的 git 命令是`git cat-file -p`.

一个blob只是一个bag-o-bits。使用 向存储库添加一个`git hash-object -w`*`filename`*，它将打印该文件中 blob 的 ~true name~ 并将 blob 添加到存储库。树将对象与文件系统名称联系起来。`git mktree`使用;将一个添加到存储库 要查看要喂它什么，请使用 eg 打印一棵树`git cat-file -p HEAD^{tree}`。添加一个提交到存储库`git commit-tree`，基本上，你说，设置一些环境变量，并在标准输入上提供一个提交消息。`git commit-tree -p`*`mom`*`-p`*`dad sometree`*

这就是真正需要的。如果您想进一步使用树和分段进行切片和切块`read-tree`并且`write-tree`可能非常有用，如果这对您很有吸引力，那么[git 核心教程](https://www.kernel.org/pub/software/scm/git/docs/gitcore-tutorial.html)是一个很好的概述。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-28T12:20:44.510

使用下面的命令跳过暂存区域并直接从工作目录提交。

```
git commit -a 
```

请注意，您仍然需要添加新的未跟踪文件。

# nservicebus - NServiceBus 是否有全局异常处理程序？

> ID：16068970
> 
> 赞同：5
> 
> 时间：2013-04-17T19:51:39.987
> 
> 标签：nservicebus

[当前在 NServiceBus 中处理异常的建议](http://docs.particular.net/nservicebus/errors/)是使用内置设施。出错的消息进入错误消息队列，并将日志写入磁盘。

但是，如果我想将我的错误发送到像 AirBrake 这样的服务，它具有更好的功能来分组类似的异常、指标和其他好东西呢？有我可以利用的全局异常处理程序吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-04-13T08:42:08.870

正如原帖中提到的，推荐的解决方案是使用 ServicePulse 来监控错误。我目前工作的客户端正在使用定制的集中式记录器，我们希望 NServiceBus 在将消息转发到错误队列时记录到此日志存储。

如果来自 NServiceBus 的异常包含原始异常，我们可以通过编辑 log4net 配置来实现这一点，目前 NServiceBus 只记录一个通用错误消息，没有关于导致失败的详细信息。

NServiceBus 有一个名为 NServiceBus.Faults.ErrorsNotifications 的类，其中包含以下可观察对象：

*   MessageSentToErrorQueue
*   MessageHasFailedAFirstLevelRetryAttempt
*   MessageHasBeenSentToSecondLevelRetries

您可以在端点启动时订阅这些 observable，如下例所示，当消息发送到错误队列时会记录错误：

```
public class GlobalErrorHandler : IWantToRunWhenBusStartsAndStops
{
    private readonly ILogger _logger;
    private readonly BusNotifications _busNotifications;
    readonly List<IDisposable> _notificationSubscriptions = new List<IDisposable>();

    public GlobalErrorHandler(ILogger logger, BusNotifications busNotifications)
    {
        _logger = logger;
        _busNotifications = busNotifications;
    }

    public void Start()
    {
        _notificationSubscriptions.Add(_busNotifications.Errors.MessageSentToErrorQueue.Subscribe(LogWhenMessageSentToErrorQueue));
    }

    public void Stop()
    {
        foreach (var subscription in _notificationSubscriptions)
        {
            subscription.Dispose();
        }
    }

    private void LogWhenMessageSentToErrorQueue(FailedMessage message)
    {
        var properties = new
        {
            MessageType = message.Headers["NServiceBus.EnclosedMessageTypes"],
            MessageId = message.Headers["NServiceBus.MessageId"],
            OriginatingMachine = message.Headers["NServiceBus.OriginatingMachine"],
            OriginatingEndpoint = message.Headers["NServiceBus.OriginatingEndpoint"],
            ExceptionType = message.Headers["NServiceBus.ExceptionInfo.ExceptionType"],
            ExceptionMessage = message.Headers["NServiceBus.ExceptionInfo.Message"],
            ExceptionSource = message.Headers["NServiceBus.ExceptionInfo.Source"],
            TimeSent = message.Headers["NServiceBus.TimeSent"]
        };

        _logger.Error("Message sent to error queue. " + properties, message.Exception);
    }
} 
```

observable 是通过使用 Reactive Extensions 实现的，因此您必须安装 NuGet 包 Rx-Core 才能使其工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T11:35:09.967

您可以使用自定义 log4net 配置来执行此操作吗？

[http://help.airbrake.io/discussions/suggestions/157-net-plug-in-for-api-v2](http://help.airbrake.io/discussions/suggestions/157-net-plug-in-for-api-v2)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T13:22:03.570

NServiceBus 中有一个名为 IManageMes​​sageFailures 的接口，但我不相信您可以将它与二级重试结合使用，因此如果您自己使用它，您可能会失去它。

您可以使用 log4net 将错误写入 SQL Server，然后您可以使用他们的 API 将错误表中的每个错误标记为之后发送，然后将它们转发到 AirBrake？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T15:38:45.937

我建议您创建一个自定义端点，从错误队列中获取数据并将数据上传到 AirBrake。

旁注：v4.0|4.1 将附带一个很好的 Rest-Api，它为您提供很好的错误管理/查询功能。Profiler 和 Ops 等工具将使用此 api 以各种方式向您呈现数据。

[http://particular.net/service-platform](http://particular.net/service-platform)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-14T13:39:48.710

我们切换到 Serilog，它对 NServiceBus 具有完美的日志记录和跟踪支持。创建一个自定义的 Serilog 接收器，将您的日志事件发送到您想要的任何地方非常容易。

# c - OpenHashing 分段错误

> ID：16068971
> 
> 赞同：0
> 
> 时间：2013-04-17T19:51:48.183
> 
> 标签：c, memory, hash, segmentation-fault, free

首先感谢您花时间阅读并打开它。我基本上完成了这段代码，我相信一切都近乎完美，除了我遇到了分段错误。这是一项家庭作业，但我已经完成了所有的工作，但我知道我的一个 Free() 中有一些东西混在一起，我相信它在我的 Delete() 函数中。

```
#define TABLE_SIZE 310987    // size of the hash table 
#define true 1
#define false 0

static int hash(BOOK *b);

/* Deletes a book with key (b -> isbn) from the table.
   If the book is found, it is deleted from the table
   and true is returned; If no book with the given isbn
   exists, False is returned.  *comps holds the number
   of comparisons done for this deletion.
 */

void insert(NODE *table[], BOOK x, int *collisionCount){

    int i = hash(&x);
    NODE *temp;

    temp = (NODE *) malloc(sizeof(NODE));
    assert(temp != NULL);

    temp -> element = x;
    temp -> next = table[i];

    if(table[i] != NULL) {

        *collisionCount += 1;
    }
    table[i] = temp;
}

boolean delete (NODE *table[], BOOK *b, int *comps){

NODE *current, *previous;
int i = hash(b);
*comps = 0;

current = table[i];

while(current != NULL) {
    *comps += 1;

    if(strcmp(current -> element.isbn, b -> isbn) == 0) {
        if(current == table[i]) {
            table[i] = current -> next;
            free(current -> element.title);
            free(current -> element.author);
            free(current -> element.publisher);
            free(current);
            return true;
        }
    else {
        previous -> next = table[i] -> next;
            free(current -> element.title);
            free(current -> element.author);
            free(current -> element.publisher);
            free(current);
        }
    }
    previous = current;
    current = current -> next;
}
return false;
}

/* initializes the hash table to an empty table */

void initialize(NODE *table[]){

int i;

for(i = 0; i < TABLE_SIZE; i++) {

    table[i] = NULL;

}

}

/* prints one BOOK object to the ouptut file */

void printToFile(const BOOK *b, FILE *fpout) {

    fprintf(fpout, "ISBN: %s", b -> isbn);
    fprintf(fpout, "ISBN: %s", b -> title);
    fprintf(fpout, "ISBN: %s", b -> author);
    fprintf(fpout, "ISBN: %d", b -> year);
    fprintf(fpout, "ISBN: %s", b -> publisher);
    }

/* frees all the memory allocated on the heap */

void freeMemory(NODE * table[]){

NODE *temp;
int i;

for(i = 0; i <= TABLE_SIZE; i++) {

    while(table[i] != NULL) {

    temp = table[i] -> next;

    free(table[i] -> element.title);
    free(table[i] -> element.author);
    free(table[i] -> element.publisher);
    free(table[i]);
    table[i] = temp; 
    }
}

} 
```

我通过终端的 gdb 调试器运行它，我得到了这个：

```
gdb OpenHashing

(no debugging symbols found)...done.

(gdb) run OpenHashing

Starting program: OpenHashing

Program received signal SIGSEGV, Segmentation fault.
0x00007ffff7a9e59c in free ()

(gdb) backtrace

 0  0x00007ffff7a9e59c in free () 

 1  0x0000000000401889 in freeMemory ()

 2  0x00000000004012d4 in main () 
```

我相信这意味着它在 free() 中，因为这两个数字匹配，但是在 free() 中的哪里不知道如何阅读，有人可以帮忙吗？指点我一个好的可下载调试器？终端机为我指明了正确的方向，但我不确定究竟是哪条线路让我失望，因为我有这么多 free()。

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:55:51.680

尝试更换：

```
for(i = 0; i <= TABLE_SIZE; i++) { 
```

和：

```
for(i = 0; i < TABLE_SIZE; i++) { 
```

# linux - git push 突然失败（git-remote-https：重定位错误）

> ID：16068976
> 
> 赞同：0
> 
> 时间：2013-04-17T19:52:00.110
> 
> 标签：linux, git, debian

不到一个小时前，我已经推送到我的仓库。现在我得到这个错误：

```
$ git push origin master
git-remote-https: relocation error: /usr/lib/i386-linux-gnu/libldap_r-2.4.so.2: symbol pt(read_mutex_destroy, version GLIBC_2.0 not defined in file libpthread.so.0 with link time reference 
```

我正在运行 Debian Wheezy，没有安装任何东西或运行任何升级。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T15:36:25.467

再次尝试设置您的遥控头。指针可能已损坏。

```
git remote set-head <name> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2019-09-11T10:23:37.133

这对我有用：

```
$ wget http://mirrors.kernel.org/ubuntu/pool/main/libi/libidn2/libidn2-0_2.0.4-1.1build2_amd64.deb
$ sudo dpkg -i libidn2-0_2.0.4-1.1build2_amd64.deb
$ sudo apt-mark hold libidn2-0 
```

# ruby-on-rails - Rails 3 has_many 通过关联无法显示或编辑嵌套关联

> ID：16068980
> 
> 赞同：1
> 
> 时间：2013-04-17T19:52:14.977
> 
> 标签：ruby-on-rails, has-many-through, nested-form-for

我是 Ruby 新手，正在学习 OTJ。几天来我一直在研究这个问题，并阅读了很多关于 has_many :through 模式的其他帖子。

我正在使用 RubyMine 5.4 和 ruby​​-1.9.3-p194 和 MySQL

我有三个模型，我需要能够添加、删除和编辑嵌套关系：

这个想法是任何用户都可以拥有许多业务竞争对手组。一个组（具有相同的 group_id）有一个目标竞争对手，它是竞争对手。每个竞争对手都是具有相关属性的 BizEntity。每个竞争者都可以是许多不同竞争群体的成员。

我试图让多对多工作，以便我可以选择一个用户，然后查看/编辑用户组和相关竞争对手。

我已经在模型上运行了 RubyMine 的 Inspect Code... 并且它很干净。然而，Rails 模型依赖关系图表明（两端带有 ? 的红线）用户与 BizEntity 的关系存在问题。

任何帮助将不胜感激。

谢谢！

型号如下：

```
class User < ActiveRecord::Base
  has_secure_password

  attr_accessible :email, :password_digest

  validates_uniqueness_of :email

  has_many :competitive_insightses, :class_name => 'CompetitiveInsights'
  has_many :biz_entitieses, :through => :competitive_insightses, :class_name => 'CompetitiveInsights', :source => :biz_entities

end

class CompetitiveInsights < ActiveRecord::Base
  attr_accessible :biz_entity_id, :user_id, :group_id, :position, :target

  belongs_to :user
  belongs_to :biz_entities

end

class BizEntities < ActiveRecord::Base
  attr_accessible :name, :ticker

  accepts_nested_attributes_for :users

  has_many :competitive_insightses, :class_name => 'CompetitiveInsights'
  has_many :users, :through => :competitive_insightses, :class_name => 'CompetitiveInsights'

end 
```

在我的控制器中，两个注释行导致相同类型的错误“未定义的方法 `biz_entitieses' for nil:NilClass”

```
class CompetitiveInsightsController < ApplicationController
  def index
    @my_companies = CompetitiveInsights.find_all_by_user_id(current_user)
    #competitive_insights = current_user.competitive_insightses
    #biz_entitieses = current_user.biz_entitieses
    if (@my_companies.nil?)
      @my_companies = CompetitiveInsights.new(current_user)
      @my_companies.save!
    end
  end
end 
```

edit.html.erb 还不能编辑 biz_entity 字段并引发以下错误：

“#<#:0x007fc1fae4efd0> 的未定义方法 `competitive_insight_competitive_insight_path'”

```
<%= form_for @my_companies do |f| %>
    <div class="field">
      <%= f.label :group_id %><br />
      <%= f.text_field :group_id %>
    </div>
    <%= f.fields_for :biz_entities do |biz_entity| %>
    <div class="field">
      <%= biz_entity.label :ticker %><br />
      <%= biz_entity.text_field :ticker %>
    </div>
    <% end %>
<div class="actions"><%= f.submit %></div>
<% end %> 
```

# android - 如何生成随机数并将其与按钮单击相匹配？

> ID：16068986
> 
> 赞同：0
> 
> 时间：2013-04-17T19:52:30.373
> 
> 标签：android

我有一个带有 9 个图像按钮的用户界面，其中的图像数字从 1 到 9..我有一个按钮听，点击时应该在每次点击时随机播放 mp3 文件（数字在 1 到 9 之间）。我应该有 5 个这样的随机 mp3当我点击听按钮 5 次时播放的文件。问题是“我必须将随机生成的 mp3 文件与包含正确数字图像的图像按钮匹配我该怎么做...因为只有随机生成的是 mp3 文件而图像按钮不是随机打乱的......它们的位置保持静止......请帮助我......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:57:24.727

将代码视为像粘土或积木一样的建模工具。如果你制作它，它就会存在。所以你真正需要的是一个与你正在尝试做的事情相匹配的信息结构。因此，理论上您可以创建一个包含对按钮 ID、图像和 mp3 文件的引用的类。创建此对象时，在构造函数中随机生成按钮 ID，然后您可以编写一个函数，将这些对象之一写入 UI（创建按钮、分配对象图像等）。然后，当有人单击按钮时，您需要做的就是寻找与您的按钮具有相同 id 的对象，然后从中取出 mp3 或图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:17:48.820

`onclick`的监听使用下面的代码生成随机数

```
var=(int)(Math.random() * (max - min) + min)    //math.random will return integer values 
```

- 现在你的变量将在你的最大值和最小值之间随机没有，即 1-9

- 您可以`switch case`如下使用并让图像按钮保持原样......如果只是随机生成的mp3文件只是循环并再次随机选择文件。

```
switch (var)
{

case 1:
      //your code
      break;
. 
.
. 
default:
     //your code
     break;      

} 
```

# mysql - 错误代码 1292 - 截断不正确的 DOUBLE 值 - Mysql

> ID：16068993
> 
> 赞同：106
> 
> 时间：2013-04-17T19:52:57.320
> 
> 标签：mysql, truncated, mysql-error-1292

我不确定这是什么错误！

```
#1292 - Truncated incorrect DOUBLE value: 
```

我没有双值字段或数据！

我浪费了整整一个小时试图弄清楚这一点！

这是我的查询

```
INSERT INTO call_managment_system.contact_numbers 
    (account_id, contact_number, contact_extension, main_number, created_by)
SELECT
    ac.account_id,
    REPLACE(REPLACE(REPLACE(REPLACE(ta.phone_number, '-', ''), ' ', ''), ')', ''),'(','') AS Phone,
    IFNULL(ta.ext, '') AS extention,
    '1' AS MainNumber,
    '2' AS created_by
FROM 
    cvsnumbers AS ta
    INNER JOIN accounts AS ac ON ac.company_code = ta.company_code
WHERE 
    LENGTH(REPLACE(REPLACE(REPLACE(REPLACE(ta.phone_number, '-', ''), ' ', ''), ')', ''),'(','') ) = 10 
```

这是我为结果要进入的表创建表

```
CREATE TABLE `contact_numbers` (  
    `number_id` int(10) unsigned NOT NULL AUTO_INCREMENT,  
    `account_id` int(10) unsigned NOT NULL DEFAULT '0',  
    `person_id` int(11) NOT NULL DEFAULT '0',  
    `contact_number` char(15) NOT NULL,  
    `contact_extension` char(10) NOT NULL DEFAULT '',  
    `contact_type` enum('Primary','Direct','Cell','Fax','Home','Reception','Office','TollFree') NOT NULL DEFAULT 'Primary',  
    `contact_link` enum('Account','PDM','Other') NOT NULL DEFAULT 'Account',  
    `status` tinyint(1) NOT NULL DEFAULT '1' COMMENT '0 = inactive, 1=active', 
    `main_number` tinyint(1) NOT NULL DEFAULT '0' COMMENT '1 = main phone number',  
    `created_on` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,  
    `created_by` int(11) NOT NULL,  
    `modified_on` datetime DEFAULT NULL,  
    `modified_by` int(11) NOT NULL DEFAULT '0',  
    PRIMARY KEY (`number_id`),  
    KEY `account_id` (`account_id`),  
    KEY `person_id` (`person_id`)
) ENGINE=InnoDB AUTO_INCREMENT=534 DEFAULT CHARSET=utf8 
```

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2013-04-17T20:16:39.327

此消息表示您正在尝试比较`WHERE`or`ON`子句中的数字和字符串。在您的查询中，唯一可能发生这种情况的地方是`ON ac.company_code = ta.company_code`；要么确保它们具有相似的声明，要么使用显式`CAST`将数字转换为字符串。

如果关闭`strict`模式，错误应该会变成警告。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2016-06-30T06:32:17.113

我更正了这个错误，因为查询中有语法错误或一些不需要的字符，但 MySQL 无法捕获它。我`and`在更新期间在多个字段之间使用，例如

```
update user 
set token='lamblala', 
    accessverion='dummy' and 
    key='somekey' 
where user = 'myself' 
```

上述查询中的问题可以通过替换`and`为逗号( `,`)来解决

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-01-14T09:48:24.993

我面临着同样的问题。尝试将 varchar(100) 列与数字 1 进行比较。导致 1292 错误。通过在 1 ('1') 周围添加单引号来修复。

谢谢楼上的解释

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-01-22T14:11:12.017

**TL; 博士**

这也可能是由应用于`OR`字符串列/文字引起的。

**完整版本**

`INSERT`对于涉及视图的简单语句，我收到了相同的错误消息：

```
insert into t1 select * from v1 
```

尽管所有源列和目标列都是`VARCHAR`. 经过一番调试，我找到了根本原因；该视图包含此片段：

```
string_col1 OR '_' OR string_col2 OR '_' OR string_col3 
```

这可能是 Oracle 自动转换以下代码段的结果：

```
string_col1 || '_' || string_col2 || '_' || string_col3 
```

（`||`是 Oracle 中的字符串连接）。解决方案是使用

```
concat(string_col1, '_', string_col2, '_', string_col3) 
```

反而。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-10-01T19:06:29.530

我见过几个发生此错误的情况：

## 1\. 在包含多个值列表`!=`的子句中使用不等于运算符`where``or`

如：

```
where columnName !=('A'||'B') 
```

这可以通过使用解决

```
where columnName not in ('A','B') 
```

## 2\. 函数中缺少比较运算符`if()`：

```
select if(col1,col1,col2); 
```

为了选择其中的值（`col1`如果存在），否则在`col2`...中显示该值，这会引发错误；可以使用以下方法解决：

```
select if(col1!='',col1,col2); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-04T16:42:06.680

当我收到此错误时，我认为这是一个错误，但是您应该记住，如果您使用 SELECT 语句和相同的 WHERE 子句执行单独的查询，那么您可以从该 SELECT`SELECT CONCAT(primary_id, ',')`语句中获取主 ID 并插入将它们放入带有条件的失败 UPDATE 查询 -> "WHERE [primary_id] IN ([list of comma-separated primary ID's from the SELECT statement)" 这使您可以缓解由原始（失败）查询的 WHERE 子句引起的任何问题。

就我个人而言，当我对“WHERE ____ IN ([values here])”中的值使用引号时，300 个预期条目中只有 10 个受到影响，在我看来，这似乎是一个错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-02-04T15:24:48.803

在我的情况下，这是一个视图（高度嵌套，视图中的视图）插入导致[mysql-5.6](/questions/tagged/mysql-5.6 "显示标记为“mysql-5.6”的问题")中的错误：

```
CREATE TABLE tablename AS
  SELECT * FROM highly_nested_viewname
; 
```

我们最终做的解决方法是模拟物化视图（实际上是一个表）并使用存储过程定期插入/更新它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-09-06T15:27:59.803

在尝试传递时遇到了 ES6 和 TypeORM 的问题，逗号分隔的数字字符串`.where("order.id IN (:orders)", { orders })`在哪里。`orders`当我转换为模板文字时，问题就解决了。

```
.where(`order.id IN (${orders})`); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-04T08:05:46.500

如果您在表上使用了**CHECK CONSTRAINT**来获取字符串字段长度

例如：检查用户名长度 >= 8

利用：

```
CHECK (CHAR_LENGTH(username)>=8) 
```

代替

```
CHECK (username>=8) 
```

如果有错误的数据类型比较，则修复检查约束

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-06-25T19:31:47.857

如果您没有双值字段或数据，也许您应该尝试禁用 sql 严格模式。

为此，您必须编辑位于 MySQL 安装文件夹中的“ **my.ini ”文件，找到“将 SQL 模式设置为严格”行并更改以下行：**

```
# Set the SQL mode to strict
sql-mode="STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION" 
```

为此，删除“STRICT_TRANS_TABLES”

```
# Set the SQL mode to strict
sql-mode="NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION" 
```

之后，您必须**重新启动 MySQL 服务**才能启用此更改。

要检查更改，请打开编辑器并执行以下 sql 语句：

```
SHOW VARIABLES LIKE 'sql_mode'; 
```

**非常重要**：请注意保存后的文件格式。将其保存为“UTF8”，不要保存为“TFT8 with BOM”，因为服务不会重新启动。

# objective-c - sizeOf 结构体和 sizeOf 实例变量返回不同的值

> ID：16068994
> 
> 赞同：0
> 
> 时间：2013-04-17T19:53:01.900
> 
> 标签：objective-c

我正在使用 Objective-C 中的 C Api。这个 API 需要使用一些特定的结构。我在试图弄清楚如何使用结构数组时遇到了一些问题。

我用一些代码向您展示了更多内容：

我有`Sprite`我定义 struct的类`Vertex`。Sprite 的每个实例都有自己的顶点数组。

```
#import <Foundation/Foundation.h>  

typedef struct {
    float Position[3];
    float Color[4];
} Vertex;

@interface Sprite : NSObject{
    Vertex *_vertices;
}

//Getter setter methods 
-(void)setVertices:(Vertex*)vx;
-(Vertex*)vertices;
@end 
```

在另一个类中，我以这种方式使用 Sprite 类：我创建一个顶点数组并将这个结构分配给 Sprite 的一个实例：

```
Sprite *spr = [[Sprite alloc]init];

Vertex vertices2[] = {
    {{1, -1, 0}, {1, 0, 0, 1}},
    {{1, 1, 0}, {1, 0, 0, 1}},
    {{-1, 1, 0}, {1, 1, 0, 1}},
    {{-1, -1, 0}, {1, 1, 0, 1}}
};

spr.vertices = vertices2; 
```

现在，如果我`sizeOf`直接在`vertices2`struct上`112`执行，我会得到 value 并`sizeOf`在`spr.vertices`我得到`4`. 为什么？？？我的意思是这是具有相同值的相同结构。

我怀疑我正在以错误的方式使用 array[] 和 pointer* ...

如何修改 Sprite 类以正确使用结构数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:16:29.680

`sizeof`在编译时计算其参数的大小。如果你传给它一个指针，它会返回指针类型的大小（通常是 4 或 8 个字节）。即使您向它传递一个取消引用的指针，即`sizeof(*spr.vertices)`，您将获得`Vertex`类型的大小，而不是您的特定实例。

如果您需要在运行时知道实例的大小，请将其（大小）放在另一个 ivar 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T19:55:17.283

`spr.vertices`是一个指针。这`vertices2`是您的 Vertex 对象的实际数组。它们是不同的数据类型。

# c++ - 如何跳过文本文件中的标题行并将其余数据读回主函数？

> ID：16068997
> 
> 赞同：1
> 
> 时间：2013-04-17T19:53:02.853
> 
> 标签：c++

我只是在学习**文本文件输入/输出**。我输出了一个文件，其中包含一个标题和下面的 10 行数据。我现在想把它读回主函数。如果我在文本文件中省略了标题，这对我有用，但是如果我把标题留在里面，我会得到一个无限循环。 **如何在读回此数据时跳过第一行（标题行），或者如果可能的话，读回标题和数据？** 这是我到目前为止所拥有的：

```
void fileRead(int x2[], double y2[], int& n, char filename)
{
     ifstream fin ("pendulum.txt"); // fin is an input file stream

     if(!fin) //same as fin.fail()
     {
              cerr << "Failure to open pendulum.txt for input" << endl;
              exit(1);
     }

     int j = 0, dummy = 0; //index of the first value j and dummy  value
     while(!fin.eof()) //loop while not end of file
     {
           fin >> dummy >> x2[j] >> y2[j];
           cout << setw(5) << fixed << j
                << setw(12) << scientific << x2[j] << "   "
                << setw(12) << y2[j] << endl; //print a copy on screen
           j += 1;           
     }

     fin.close(); //close the input file

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:55:18.933

您可以先读取文件的标题，然后再读取您想要的真实内容，如下所示：

```
string line;
getline(fin, line);//just skip the line contents if you do not want header
while (fin >> dummy >> x2[j] >> y2[j] )
{   //^^if you do not always have a dummy at the beginning of line
    //you can remove dummy when you read the rest of the file
   //do something
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:00:28.083

你最好的选择是使用

```
 fin.ignore(10000,'\n'); 
```

[http://www.cplusplus.com/reference/istream/istream/ignore/](http://www.cplusplus.com/reference/istream/istream/ignore/) 这将忽略文件中的前 10000 个字符，或者忽略这些字符，直到到达换行符。10000 是相当随意的，应该是一个总是比最大​​行长更长的数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-28T07:45:29.370

伙计，那边的这位先生帮了我很多忙。你看，每个人都说使用 getline(); 跳过一行，但问题是有时你不想在缓冲区中存储任何东西，所以 ignore() 对我来说更有意义。好吧，所以我想通过添加来支持我们的家伙的答案，您可以使用“ numeric_limits::max()” 这将使它没有限制，它会忽略直到找到分隔符...

`

```
 #include <iostream> 
  #include <fstream>
  #include <limits>

  using std::streamsize;

  int main() {
      ifstream fin ("pendulum.txt");
      fin.ignore(numeric_limits<streamsize>::max(),'\n');
  } 
```

`

[http://www.cplusplus.com/reference/limits/numeric_limits/](http://www.cplusplus.com/reference/limits/numeric_limits/)

# asp.net - MVC 4 System.ArgumentException：不支持关键字：'initialcatalog'

> ID：16068998
> 
> 赞同：0
> 
> 时间：2013-04-17T19:53:05.350
> 
> 标签：asp.net, asp.net-mvc-4, unhandled-exception

目前在运行我的网络应用程序时遇到了一些问题。我去运行它，然后它遇到了一个未处理的异常。

说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.ArgumentException：不支持关键字：'initialcatalog'。

```
Line 42:             catch (Exception ex)
Line 43:             {
Line 44:                 throw ex;
Line 45:             }
Line 46:             finally 
```

这也是我的 Web.Config 连接字符串。

```
<connectionStrings>
<add name="ApplicationDb" providerName="System.Data.SqlClient" connectionString="Data Source= \SQLEXPRESS;InitialCatalog=aspnet-MvcApplication5-20130311122440;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnet-MvcApplication5-20130311122440.mdf" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:54:30.067

关键字实际上是`Initial Catalog`<-- 注意空格